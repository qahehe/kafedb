20/04/11 03:56:59 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 11470ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 11 03:57:02 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 11 03:57:03 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 11 03:57:03 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 11 03:57:04 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 11 03:57:04 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 11 03:57:08 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 11 03:57:12 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 11 03:57:12 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 03:57:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:57:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2083L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 03:57:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:57:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:57:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:57:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:57:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:57:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:57:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:57:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:57:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:57:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:57:14 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/11 03:57:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2083L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#2085 AS rid_0#2092, cpfk_region_nation#2086 AS cpfk_region_nation_0#2093, cfpk_nation_region#2087 AS cfpk_nation_region_0#2094, cval_nation_n_name#2088 AS cval_nation_n_name_0#2095, cval_nation_n_comment#2089 AS cval_nation_n_comment_0#2096, cn_name#2090 AS cn_name_0#2097, cn_comment#2091 AS cn_comment_0#2098]
            :     :     :  :  :  :  :  +- Relation[rid#2085,cpfk_region_nation#2086,cfpk_nation_region#2087,cval_nation_n_name#2088,cval_nation_n_comment#2089,cn_name#2090,cn_comment#2091] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#2125 AS rid_0#2132, cpfk_region_nation#2126 AS cpfk_region_nation_0#2133, cfpk_nation_region#2127 AS cfpk_nation_region_0#2134, cval_nation_n_name#2128 AS cval_nation_n_name_0#2135, cval_nation_n_comment#2129 AS cval_nation_n_comment_0#2136, cn_name#2130 AS cn_name_0#2137, cn_comment#2131 AS cn_comment_0#2138]
            :     :     :  :  :  :     :  +- Relation[rid#2125,cpfk_region_nation#2126,cfpk_nation_region#2127,cval_nation_n_name#2128,cval_nation_n_comment#2129,cn_name#2130,cn_comment#2131] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#2139 AS rid_1#2152, cpfk_nation_supplier#2140 AS cpfk_nation_supplier_1#2153, cfpk_supplier_nation#2141 AS cfpk_supplier_nation_1#2154, cval_supplier_s_name#2142 AS cval_supplier_s_name_1#2155, cval_supplier_s_address#2143 AS cval_supplier_s_address_1#2156, cval_supplier_s_phone#2144 AS cval_supplier_s_phone_1#2157, cval_supplier_s_acctbal#2145 AS cval_supplier_s_acctbal_1#2158, cval_supplier_s_comment#2146 AS cval_supplier_s_comment_1#2159, cs_name#2147 AS cs_name_1#2160, cs_address#2148 AS cs_address_1#2161, cs_phone#2149 AS cs_phone_1#2162, cs_acctbal#2150 AS cs_acctbal_1#2163, cs_comment#2151 AS cs_comment_1#2164]
            :     :     :  :  :  :        +- Relation[rid#2139,cpfk_nation_supplier#2140,cfpk_supplier_nation#2141,cval_supplier_s_name#2142,cval_supplier_s_address#2143,cval_supplier_s_phone#2144,cval_supplier_s_acctbal#2145,cval_supplier_s_comment#2146,cs_name#2147,cs_address#2148,cs_phone#2149,cs_acctbal#2150,cs_comment#2151] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#2099 AS rid_1#2112, cpfk_nation_supplier#2100 AS cpfk_nation_supplier_1#2113, cfpk_supplier_nation#2101 AS cfpk_supplier_nation_1#2114, cval_supplier_s_name#2102 AS cval_supplier_s_name_1#2115, cval_supplier_s_address#2103 AS cval_supplier_s_address_1#2116, cval_supplier_s_phone#2104 AS cval_supplier_s_phone_1#2117, cval_supplier_s_acctbal#2105 AS cval_supplier_s_acctbal_1#2118, cval_supplier_s_comment#2106 AS cval_supplier_s_comment_1#2119, cs_name#2107 AS cs_name_1#2120, cs_address#2108 AS cs_address_1#2121, cs_phone#2109 AS cs_phone_1#2122, cs_acctbal#2110 AS cs_acctbal_1#2123, cs_comment#2111 AS cs_comment_1#2124]
            :     :     :  :  :     +- Relation[rid#2099,cpfk_nation_supplier#2100,cfpk_supplier_nation#2101,cval_supplier_s_name#2102,cval_supplier_s_address#2103,cval_supplier_s_phone#2104,cval_supplier_s_acctbal#2105,cval_supplier_s_comment#2106,cs_name#2107,cs_address#2108,cs_phone#2109,cs_acctbal#2110,cs_comment#2111] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#2231 AS rid_1#2244, cpfk_nation_supplier#2232 AS cpfk_nation_supplier_1#2245, cfpk_supplier_nation#2233 AS cfpk_supplier_nation_1#2246, cval_supplier_s_name#2234 AS cval_supplier_s_name_1#2247, cval_supplier_s_address#2235 AS cval_supplier_s_address_1#2248, cval_supplier_s_phone#2236 AS cval_supplier_s_phone_1#2249, cval_supplier_s_acctbal#2237 AS cval_supplier_s_acctbal_1#2250, cval_supplier_s_comment#2238 AS cval_supplier_s_comment_1#2251, cs_name#2239 AS cs_name_1#2252, cs_address#2240 AS cs_address_1#2253, cs_phone#2241 AS cs_phone_1#2254, cs_acctbal#2242 AS cs_acctbal_1#2255, cs_comment#2243 AS cs_comment_1#2256]
            :     :     :  :     :  +- Relation[rid#2231,cpfk_nation_supplier#2232,cfpk_supplier_nation#2233,cval_supplier_s_name#2234,cval_supplier_s_address#2235,cval_supplier_s_phone#2236,cval_supplier_s_acctbal#2237,cval_supplier_s_comment#2238,cs_name#2239,cs_address#2240,cs_phone#2241,cs_acctbal#2242,cs_comment#2243] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#2257 AS rid_2#2290, cpfk_orders_lineitem#2258 AS cpfk_orders_lineitem_2#2291, cpfk_supplier_lineitem#2259 AS cpfk_supplier_lineitem_2#2292, cfpk_lineitem_supplier#2260 AS cfpk_lineitem_supplier_2#2293, cfpk_lineitem_partsupp#2261 AS cfpk_lineitem_partsupp_2#2294, cpfk_part_lineitem#2262 AS cpfk_part_lineitem_2#2295, cfpk_lineitem_part#2263 AS cfpk_lineitem_part_2#2296, cpfk_partsupp_lineitem#2264 AS cpfk_partsupp_lineitem_2#2297, cfpk_lineitem_orders#2265 AS cfpk_lineitem_orders_2#2298, cval_lineitem_l_quantity#2266 AS cval_lineitem_l_quantity_2#2299, cval_lineitem_l_extendedprice#2267 AS cval_lineitem_l_extendedprice_2#2300, cval_lineitem_l_discount#2268 AS cval_lineitem_l_discount_2#2301, cval_lineitem_l_tax#2269 AS cval_lineitem_l_tax_2#2302, cval_lineitem_l_returnflag#2270 AS cval_lineitem_l_returnflag_2#2303, cval_lineitem_l_linestatus#2271 AS cval_lineitem_l_linestatus_2#2304, cval_lineitem_l_commitdate#2272 AS cval_lineitem_l_commitdate_2#2305, cval_lineitem_l_receiptdate#2273 AS cval_lineitem_l_receiptdate_2#2306, cval_lineitem_l_shipinstruct#2274 AS cval_lineitem_l_shipinstruct_2#2307, cval_lineitem_l_shipmode#2275 AS cval_lineitem_l_shipmode_2#2308, cval_lineitem_l_comment#2276 AS cval_lineitem_l_comment_2#2309, cval_lineitem_l_shipdate#2277 AS cval_lineitem_l_shipdate_2#2310, cl_quantity#2278 AS cl_quantity_2#2311, cl_extendedprice#2279 AS cl_extendedprice_2#2312, cl_discount#2280 AS cl_discount_2#2313, ... 9 more fields]
            :     :     :  :        +- Relation[rid#2257,cpfk_orders_lineitem#2258,cpfk_supplier_lineitem#2259,cfpk_lineitem_supplier#2260,cfpk_lineitem_partsupp#2261,cpfk_part_lineitem#2262,cfpk_lineitem_part#2263,cpfk_partsupp_lineitem#2264,cfpk_lineitem_orders#2265,cval_lineitem_l_quantity#2266,cval_lineitem_l_extendedprice#2267,cval_lineitem_l_discount#2268,cval_lineitem_l_tax#2269,cval_lineitem_l_returnflag#2270,cval_lineitem_l_linestatus#2271,cval_lineitem_l_commitdate#2272,cval_lineitem_l_receiptdate#2273,cval_lineitem_l_shipinstruct#2274,cval_lineitem_l_shipmode#2275,cval_lineitem_l_comment#2276,cval_lineitem_l_shipdate#2277,cl_quantity#2278,cl_extendedprice#2279,cl_discount#2280,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#2165 AS rid_2#2198, cpfk_orders_lineitem#2166 AS cpfk_orders_lineitem_2#2199, cpfk_supplier_lineitem#2167 AS cpfk_supplier_lineitem_2#2200, cfpk_lineitem_supplier#2168 AS cfpk_lineitem_supplier_2#2201, cfpk_lineitem_partsupp#2169 AS cfpk_lineitem_partsupp_2#2202, cpfk_part_lineitem#2170 AS cpfk_part_lineitem_2#2203, cfpk_lineitem_part#2171 AS cfpk_lineitem_part_2#2204, cpfk_partsupp_lineitem#2172 AS cpfk_partsupp_lineitem_2#2205, cfpk_lineitem_orders#2173 AS cfpk_lineitem_orders_2#2206, cval_lineitem_l_quantity#2174 AS cval_lineitem_l_quantity_2#2207, cval_lineitem_l_extendedprice#2175 AS cval_lineitem_l_extendedprice_2#2208, cval_lineitem_l_discount#2176 AS cval_lineitem_l_discount_2#2209, cval_lineitem_l_tax#2177 AS cval_lineitem_l_tax_2#2210, cval_lineitem_l_returnflag#2178 AS cval_lineitem_l_returnflag_2#2211, cval_lineitem_l_linestatus#2179 AS cval_lineitem_l_linestatus_2#2212, cval_lineitem_l_commitdate#2180 AS cval_lineitem_l_commitdate_2#2213, cval_lineitem_l_receiptdate#2181 AS cval_lineitem_l_receiptdate_2#2214, cval_lineitem_l_shipinstruct#2182 AS cval_lineitem_l_shipinstruct_2#2215, cval_lineitem_l_shipmode#2183 AS cval_lineitem_l_shipmode_2#2216, cval_lineitem_l_comment#2184 AS cval_lineitem_l_comment_2#2217, cval_lineitem_l_shipdate#2185 AS cval_lineitem_l_shipdate_2#2218, cl_quantity#2186 AS cl_quantity_2#2219, cl_extendedprice#2187 AS cl_extendedprice_2#2220, cl_discount#2188 AS cl_discount_2#2221, ... 9 more fields]
            :     :     :     +- Relation[rid#2165,cpfk_orders_lineitem#2166,cpfk_supplier_lineitem#2167,cfpk_lineitem_supplier#2168,cfpk_lineitem_partsupp#2169,cpfk_part_lineitem#2170,cfpk_lineitem_part#2171,cpfk_partsupp_lineitem#2172,cfpk_lineitem_orders#2173,cval_lineitem_l_quantity#2174,cval_lineitem_l_extendedprice#2175,cval_lineitem_l_discount#2176,cval_lineitem_l_tax#2177,cval_lineitem_l_returnflag#2178,cval_lineitem_l_linestatus#2179,cval_lineitem_l_commitdate#2180,cval_lineitem_l_receiptdate#2181,cval_lineitem_l_shipinstruct#2182,cval_lineitem_l_shipmode#2183,cval_lineitem_l_comment#2184,cval_lineitem_l_shipdate#2185,cl_quantity#2186,cl_extendedprice#2187,cl_discount#2188,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#2323 AS rid_3#2340, cval_part_p_name#2324 AS cval_part_p_name_3#2341, cval_part_p_mfgr#2325 AS cval_part_p_mfgr_3#2342, cval_part_p_type#2326 AS cval_part_p_type_3#2343, cval_part_p_size#2327 AS cval_part_p_size_3#2344, cval_part_p_container#2328 AS cval_part_p_container_3#2345, cval_part_p_retailprice#2329 AS cval_part_p_retailprice_3#2346, cval_part_p_comment#2330 AS cval_part_p_comment_3#2347, cval_part_p_brand#2331 AS cval_part_p_brand_3#2348, cp_name#2332 AS cp_name_3#2349, cp_mfgr#2333 AS cp_mfgr_3#2350, cp_type#2334 AS cp_type_3#2351, cp_size#2335 AS cp_size_3#2352, cp_container#2336 AS cp_container_3#2353, cp_retailprice#2337 AS cp_retailprice_3#2354, cp_comment#2338 AS cp_comment_3#2355, cp_brand#2339 AS cp_brand_3#2356]
            :     :        +- Relation[rid#2323,cval_part_p_name#2324,cval_part_p_mfgr#2325,cval_part_p_type#2326,cval_part_p_size#2327,cval_part_p_container#2328,cval_part_p_retailprice#2329,cval_part_p_comment#2330,cval_part_p_brand#2331,cp_name#2332,cp_mfgr#2333,cp_type#2334,cp_size#2335,cp_container#2336,cp_retailprice#2337,cp_comment#2338,cp_brand#2339] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#2357 AS rid_4#2368, cpfk_part_partsupp#2358 AS cpfk_part_partsupp_4#2369, cfpk_partsupp_part#2359 AS cfpk_partsupp_part_4#2370, cpfk_supplier_partsupp#2360 AS cpfk_supplier_partsupp_4#2371, cfpk_partsupp_supplier#2361 AS cfpk_partsupp_supplier_4#2372, cval_partsupp_ps_availqty#2362 AS cval_partsupp_ps_availqty_4#2373, cval_partsupp_ps_supplycost#2363 AS cval_partsupp_ps_supplycost_4#2374, cval_partsupp_ps_comment#2364 AS cval_partsupp_ps_comment_4#2375, cps_availqty#2365 AS cps_availqty_4#2376, cps_supplycost#2366 AS cps_supplycost_4#2377, cps_comment#2367 AS cps_comment_4#2378]
            :        +- Relation[rid#2357,cpfk_part_partsupp#2358,cfpk_partsupp_part#2359,cpfk_supplier_partsupp#2360,cfpk_partsupp_supplier#2361,cval_partsupp_ps_availqty#2362,cval_partsupp_ps_supplycost#2363,cval_partsupp_ps_comment#2364,cps_availqty#2365,cps_supplycost#2366,cps_comment#2367] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#2379 AS rid_5#2396, cpfk_customer_orders#2380 AS cpfk_customer_orders_5#2397, cfpk_orders_customer#2381 AS cfpk_orders_customer_5#2398, cval_orders_o_orderstatus#2382 AS cval_orders_o_orderstatus_5#2399, cval_orders_o_totalprice#2383 AS cval_orders_o_totalprice_5#2400, cval_orders_o_orderpriority#2384 AS cval_orders_o_orderpriority_5#2401, cval_orders_o_clerk#2385 AS cval_orders_o_clerk_5#2402, cval_orders_o_shippriority#2386 AS cval_orders_o_shippriority_5#2403, cval_orders_o_comment#2387 AS cval_orders_o_comment_5#2404, cval_orders_o_orderdate#2388 AS cval_orders_o_orderdate_5#2405, co_orderstatus#2389 AS co_orderstatus_5#2406, co_totalprice#2390 AS co_totalprice_5#2407, co_orderpriority#2391 AS co_orderpriority_5#2408, co_clerk#2392 AS co_clerk_5#2409, co_shippriority#2393 AS co_shippriority_5#2410, co_comment#2394 AS co_comment_5#2411, co_orderdate#2395 AS co_orderdate_5#2412]
               +- Relation[rid#2379,cpfk_customer_orders#2380,cfpk_orders_customer#2381,cval_orders_o_orderstatus#2382,cval_orders_o_totalprice#2383,cval_orders_o_orderpriority#2384,cval_orders_o_clerk#2385,cval_orders_o_shippriority#2386,cval_orders_o_comment#2387,cval_orders_o_orderdate#2388,co_orderstatus#2389,co_totalprice#2390,co_orderpriority#2391,co_clerk#2392,co_shippriority#2393,co_comment#2394,co_orderdate#2395] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 246645ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/11 04:01:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:01:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2515L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 04:01:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:01:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:01:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:01:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:01:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:01:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:01:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:01:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2515L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#2517 AS rid_0#2550, cpfk_orders_lineitem#2518 AS cpfk_orders_lineitem_0#2551, cpfk_supplier_lineitem#2519 AS cpfk_supplier_lineitem_0#2552, cfpk_lineitem_supplier#2520 AS cfpk_lineitem_supplier_0#2553, cfpk_lineitem_partsupp#2521 AS cfpk_lineitem_partsupp_0#2554, cpfk_part_lineitem#2522 AS cpfk_part_lineitem_0#2555, cfpk_lineitem_part#2523 AS cfpk_lineitem_part_0#2556, cpfk_partsupp_lineitem#2524 AS cpfk_partsupp_lineitem_0#2557, cfpk_lineitem_orders#2525 AS cfpk_lineitem_orders_0#2558, cval_lineitem_l_quantity#2526 AS cval_lineitem_l_quantity_0#2559, cval_lineitem_l_extendedprice#2527 AS cval_lineitem_l_extendedprice_0#2560, cval_lineitem_l_discount#2528 AS cval_lineitem_l_discount_0#2561, cval_lineitem_l_tax#2529 AS cval_lineitem_l_tax_0#2562, cval_lineitem_l_returnflag#2530 AS cval_lineitem_l_returnflag_0#2563, cval_lineitem_l_linestatus#2531 AS cval_lineitem_l_linestatus_0#2564, cval_lineitem_l_commitdate#2532 AS cval_lineitem_l_commitdate_0#2565, cval_lineitem_l_receiptdate#2533 AS cval_lineitem_l_receiptdate_0#2566, cval_lineitem_l_shipinstruct#2534 AS cval_lineitem_l_shipinstruct_0#2567, cval_lineitem_l_shipmode#2535 AS cval_lineitem_l_shipmode_0#2568, cval_lineitem_l_comment#2536 AS cval_lineitem_l_comment_0#2569, cval_lineitem_l_shipdate#2537 AS cval_lineitem_l_shipdate_0#2570, cl_quantity#2538 AS cl_quantity_0#2571, cl_extendedprice#2539 AS cl_extendedprice_0#2572, cl_discount#2540 AS cl_discount_0#2573, ... 9 more fields]
            :  +- Relation[rid#2517,cpfk_orders_lineitem#2518,cpfk_supplier_lineitem#2519,cfpk_lineitem_supplier#2520,cfpk_lineitem_partsupp#2521,cpfk_part_lineitem#2522,cfpk_lineitem_part#2523,cpfk_partsupp_lineitem#2524,cfpk_lineitem_orders#2525,cval_lineitem_l_quantity#2526,cval_lineitem_l_extendedprice#2527,cval_lineitem_l_discount#2528,cval_lineitem_l_tax#2529,cval_lineitem_l_returnflag#2530,cval_lineitem_l_linestatus#2531,cval_lineitem_l_commitdate#2532,cval_lineitem_l_receiptdate#2533,cval_lineitem_l_shipinstruct#2534,cval_lineitem_l_shipmode#2535,cval_lineitem_l_comment#2536,cval_lineitem_l_shipdate#2537,cl_quantity#2538,cl_extendedprice#2539,cl_discount#2540,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#2583 AS rid_1#2600, cpfk_customer_orders#2584 AS cpfk_customer_orders_1#2601, cfpk_orders_customer#2585 AS cfpk_orders_customer_1#2602, cval_orders_o_orderstatus#2586 AS cval_orders_o_orderstatus_1#2603, cval_orders_o_totalprice#2587 AS cval_orders_o_totalprice_1#2604, cval_orders_o_orderpriority#2588 AS cval_orders_o_orderpriority_1#2605, cval_orders_o_clerk#2589 AS cval_orders_o_clerk_1#2606, cval_orders_o_shippriority#2590 AS cval_orders_o_shippriority_1#2607, cval_orders_o_comment#2591 AS cval_orders_o_comment_1#2608, cval_orders_o_orderdate#2592 AS cval_orders_o_orderdate_1#2609, co_orderstatus#2593 AS co_orderstatus_1#2610, co_totalprice#2594 AS co_totalprice_1#2611, co_orderpriority#2595 AS co_orderpriority_1#2612, co_clerk#2596 AS co_clerk_1#2613, co_shippriority#2597 AS co_shippriority_1#2614, co_comment#2598 AS co_comment_1#2615, co_orderdate#2599 AS co_orderdate_1#2616]
                  :     :  :  :  :  +- Relation[rid#2583,cpfk_customer_orders#2584,cfpk_orders_customer#2585,cval_orders_o_orderstatus#2586,cval_orders_o_totalprice#2587,cval_orders_o_orderpriority#2588,cval_orders_o_clerk#2589,cval_orders_o_shippriority#2590,cval_orders_o_comment#2591,cval_orders_o_orderdate#2592,co_orderstatus#2593,co_totalprice#2594,co_orderpriority#2595,co_clerk#2596,co_shippriority#2597,co_comment#2598,co_orderdate#2599] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#2617 AS rid_1#2634, cpfk_customer_orders#2618 AS cpfk_customer_orders_1#2635, cfpk_orders_customer#2619 AS cfpk_orders_customer_1#2636, cval_orders_o_orderstatus#2620 AS cval_orders_o_orderstatus_1#2637, cval_orders_o_totalprice#2621 AS cval_orders_o_totalprice_1#2638, cval_orders_o_orderpriority#2622 AS cval_orders_o_orderpriority_1#2639, cval_orders_o_clerk#2623 AS cval_orders_o_clerk_1#2640, cval_orders_o_shippriority#2624 AS cval_orders_o_shippriority_1#2641, cval_orders_o_comment#2625 AS cval_orders_o_comment_1#2642, cval_orders_o_orderdate#2626 AS cval_orders_o_orderdate_1#2643, co_orderstatus#2627 AS co_orderstatus_1#2644, co_totalprice#2628 AS co_totalprice_1#2645, co_orderpriority#2629 AS co_orderpriority_1#2646, co_clerk#2630 AS co_clerk_1#2647, co_shippriority#2631 AS co_shippriority_1#2648, co_comment#2632 AS co_comment_1#2649, co_orderdate#2633 AS co_orderdate_1#2650]
                  :     :  :  :        +- Relation[rid#2617,cpfk_customer_orders#2618,cfpk_orders_customer#2619,cval_orders_o_orderstatus#2620,cval_orders_o_totalprice#2621,cval_orders_o_orderpriority#2622,cval_orders_o_clerk#2623,cval_orders_o_shippriority#2624,cval_orders_o_comment#2625,cval_orders_o_orderdate#2626,co_orderstatus#2627,co_totalprice#2628,co_orderpriority#2629,co_clerk#2630,co_shippriority#2631,co_comment#2632,co_orderdate#2633] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :     :- Project [rid#2717 AS rid_1#2734, cpfk_customer_orders#2718 AS cpfk_customer_orders_1#2735, cfpk_orders_customer#2719 AS cfpk_orders_customer_1#2736, cval_orders_o_orderstatus#2720 AS cval_orders_o_orderstatus_1#2737, cval_orders_o_totalprice#2721 AS cval_orders_o_totalprice_1#2738, cval_orders_o_orderpriority#2722 AS cval_orders_o_orderpriority_1#2739, cval_orders_o_clerk#2723 AS cval_orders_o_clerk_1#2740, cval_orders_o_shippriority#2724 AS cval_orders_o_shippriority_1#2741, cval_orders_o_comment#2725 AS cval_orders_o_comment_1#2742, cval_orders_o_orderdate#2726 AS cval_orders_o_orderdate_1#2743, co_orderstatus#2727 AS co_orderstatus_1#2744, co_totalprice#2728 AS co_totalprice_1#2745, co_orderpriority#2729 AS co_orderpriority_1#2746, co_clerk#2730 AS co_clerk_1#2747, co_shippriority#2731 AS co_shippriority_1#2748, co_comment#2732 AS co_comment_1#2749, co_orderdate#2733 AS co_orderdate_1#2750]
                  :     :  :     :  +- Relation[rid#2717,cpfk_customer_orders#2718,cfpk_orders_customer#2719,cval_orders_o_orderstatus#2720,cval_orders_o_totalprice#2721,cval_orders_o_orderpriority#2722,cval_orders_o_clerk#2723,cval_orders_o_shippriority#2724,cval_orders_o_comment#2725,cval_orders_o_orderdate#2726,co_orderstatus#2727,co_totalprice#2728,co_orderpriority#2729,co_clerk#2730,co_shippriority#2731,co_comment#2732,co_orderdate#2733] JDBCRelation(torders) [numPartitions=1]
                  :     :  :     +- Project [rid#2751 AS rid_2#2784, cpfk_orders_lineitem#2752 AS cpfk_orders_lineitem_2#2785, cpfk_supplier_lineitem#2753 AS cpfk_supplier_lineitem_2#2786, cfpk_lineitem_supplier#2754 AS cfpk_lineitem_supplier_2#2787, cfpk_lineitem_partsupp#2755 AS cfpk_lineitem_partsupp_2#2788, cpfk_part_lineitem#2756 AS cpfk_part_lineitem_2#2789, cfpk_lineitem_part#2757 AS cfpk_lineitem_part_2#2790, cpfk_partsupp_lineitem#2758 AS cpfk_partsupp_lineitem_2#2791, cfpk_lineitem_orders#2759 AS cfpk_lineitem_orders_2#2792, cval_lineitem_l_quantity#2760 AS cval_lineitem_l_quantity_2#2793, cval_lineitem_l_extendedprice#2761 AS cval_lineitem_l_extendedprice_2#2794, cval_lineitem_l_discount#2762 AS cval_lineitem_l_discount_2#2795, cval_lineitem_l_tax#2763 AS cval_lineitem_l_tax_2#2796, cval_lineitem_l_returnflag#2764 AS cval_lineitem_l_returnflag_2#2797, cval_lineitem_l_linestatus#2765 AS cval_lineitem_l_linestatus_2#2798, cval_lineitem_l_commitdate#2766 AS cval_lineitem_l_commitdate_2#2799, cval_lineitem_l_receiptdate#2767 AS cval_lineitem_l_receiptdate_2#2800, cval_lineitem_l_shipinstruct#2768 AS cval_lineitem_l_shipinstruct_2#2801, cval_lineitem_l_shipmode#2769 AS cval_lineitem_l_shipmode_2#2802, cval_lineitem_l_comment#2770 AS cval_lineitem_l_comment_2#2803, cval_lineitem_l_shipdate#2771 AS cval_lineitem_l_shipdate_2#2804, cl_quantity#2772 AS cl_quantity_2#2805, cl_extendedprice#2773 AS cl_extendedprice_2#2806, cl_discount#2774 AS cl_discount_2#2807, ... 9 more fields]
                  :     :  :        +- Relation[rid#2751,cpfk_orders_lineitem#2752,cpfk_supplier_lineitem#2753,cfpk_lineitem_supplier#2754,cfpk_lineitem_partsupp#2755,cpfk_part_lineitem#2756,cfpk_lineitem_part#2757,cpfk_partsupp_lineitem#2758,cfpk_lineitem_orders#2759,cval_lineitem_l_quantity#2760,cval_lineitem_l_extendedprice#2761,cval_lineitem_l_discount#2762,cval_lineitem_l_tax#2763,cval_lineitem_l_returnflag#2764,cval_lineitem_l_linestatus#2765,cval_lineitem_l_commitdate#2766,cval_lineitem_l_receiptdate#2767,cval_lineitem_l_shipinstruct#2768,cval_lineitem_l_shipmode#2769,cval_lineitem_l_comment#2770,cval_lineitem_l_shipdate#2771,cl_quantity#2772,cl_extendedprice#2773,cl_discount#2774,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#2651 AS rid_2#2684, cpfk_orders_lineitem#2652 AS cpfk_orders_lineitem_2#2685, cpfk_supplier_lineitem#2653 AS cpfk_supplier_lineitem_2#2686, cfpk_lineitem_supplier#2654 AS cfpk_lineitem_supplier_2#2687, cfpk_lineitem_partsupp#2655 AS cfpk_lineitem_partsupp_2#2688, cpfk_part_lineitem#2656 AS cpfk_part_lineitem_2#2689, cfpk_lineitem_part#2657 AS cfpk_lineitem_part_2#2690, cpfk_partsupp_lineitem#2658 AS cpfk_partsupp_lineitem_2#2691, cfpk_lineitem_orders#2659 AS cfpk_lineitem_orders_2#2692, cval_lineitem_l_quantity#2660 AS cval_lineitem_l_quantity_2#2693, cval_lineitem_l_extendedprice#2661 AS cval_lineitem_l_extendedprice_2#2694, cval_lineitem_l_discount#2662 AS cval_lineitem_l_discount_2#2695, cval_lineitem_l_tax#2663 AS cval_lineitem_l_tax_2#2696, cval_lineitem_l_returnflag#2664 AS cval_lineitem_l_returnflag_2#2697, cval_lineitem_l_linestatus#2665 AS cval_lineitem_l_linestatus_2#2698, cval_lineitem_l_commitdate#2666 AS cval_lineitem_l_commitdate_2#2699, cval_lineitem_l_receiptdate#2667 AS cval_lineitem_l_receiptdate_2#2700, cval_lineitem_l_shipinstruct#2668 AS cval_lineitem_l_shipinstruct_2#2701, cval_lineitem_l_shipmode#2669 AS cval_lineitem_l_shipmode_2#2702, cval_lineitem_l_comment#2670 AS cval_lineitem_l_comment_2#2703, cval_lineitem_l_shipdate#2671 AS cval_lineitem_l_shipdate_2#2704, cl_quantity#2672 AS cl_quantity_2#2705, cl_extendedprice#2673 AS cl_extendedprice_2#2706, cl_discount#2674 AS cl_discount_2#2707, ... 9 more fields]
                  :     :     +- Relation[rid#2651,cpfk_orders_lineitem#2652,cpfk_supplier_lineitem#2653,cfpk_lineitem_supplier#2654,cfpk_lineitem_partsupp#2655,cpfk_part_lineitem#2656,cfpk_lineitem_part#2657,cpfk_partsupp_lineitem#2658,cfpk_lineitem_orders#2659,cval_lineitem_l_quantity#2660,cval_lineitem_l_extendedprice#2661,cval_lineitem_l_discount#2662,cval_lineitem_l_tax#2663,cval_lineitem_l_returnflag#2664,cval_lineitem_l_linestatus#2665,cval_lineitem_l_commitdate#2666,cval_lineitem_l_receiptdate#2667,cval_lineitem_l_shipinstruct#2668,cval_lineitem_l_shipmode#2669,cval_lineitem_l_comment#2670,cval_lineitem_l_shipdate#2671,cl_quantity#2672,cl_extendedprice#2673,cl_discount#2674,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#2817 AS rid_3#2830, cpfk_nation_supplier#2818 AS cpfk_nation_supplier_3#2831, cfpk_supplier_nation#2819 AS cfpk_supplier_nation_3#2832, cval_supplier_s_name#2820 AS cval_supplier_s_name_3#2833, cval_supplier_s_address#2821 AS cval_supplier_s_address_3#2834, cval_supplier_s_phone#2822 AS cval_supplier_s_phone_3#2835, cval_supplier_s_acctbal#2823 AS cval_supplier_s_acctbal_3#2836, cval_supplier_s_comment#2824 AS cval_supplier_s_comment_3#2837, cs_name#2825 AS cs_name_3#2838, cs_address#2826 AS cs_address_3#2839, cs_phone#2827 AS cs_phone_3#2840, cs_acctbal#2828 AS cs_acctbal_3#2841, cs_comment#2829 AS cs_comment_3#2842]
                  :        +- Relation[rid#2817,cpfk_nation_supplier#2818,cfpk_supplier_nation#2819,cval_supplier_s_name#2820,cval_supplier_s_address#2821,cval_supplier_s_phone#2822,cval_supplier_s_acctbal#2823,cval_supplier_s_comment#2824,cs_name#2825,cs_address#2826,cs_phone#2827,cs_acctbal#2828,cs_comment#2829] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#2843 AS rid_4#2850, cpfk_region_nation#2844 AS cpfk_region_nation_4#2851, cfpk_nation_region#2845 AS cfpk_nation_region_4#2852, cval_nation_n_name#2846 AS cval_nation_n_name_4#2853, cval_nation_n_comment#2847 AS cval_nation_n_comment_4#2854, cn_name#2848 AS cn_name_4#2855, cn_comment#2849 AS cn_comment_4#2856]
                     :  +- Relation[rid#2843,cpfk_region_nation#2844,cfpk_nation_region#2845,cval_nation_n_name#2846,cval_nation_n_comment#2847,cn_name#2848,cn_comment#2849] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#2857 AS rid_4#2864, cpfk_region_nation#2858 AS cpfk_region_nation_4#2865, cfpk_nation_region#2859 AS cfpk_nation_region_4#2866, cval_nation_n_name#2860 AS cval_nation_n_name_4#2867, cval_nation_n_comment#2861 AS cval_nation_n_comment_4#2868, cn_name#2862 AS cn_name_4#2869, cn_comment#2863 AS cn_comment_4#2870]
                           +- Relation[rid#2857,cpfk_region_nation#2858,cfpk_nation_region#2859,cval_nation_n_name#2860,cval_nation_n_comment#2861,cn_name#2862,cn_comment#2863] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 248056ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/11 04:05:28 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:05:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2981L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 04:05:28 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:05:28 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:05:28 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:05:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2981L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#2983 AS rid_0#3000, cval_part_p_name#2984 AS cval_part_p_name_0#3001, cval_part_p_mfgr#2985 AS cval_part_p_mfgr_0#3002, cval_part_p_type#2986 AS cval_part_p_type_0#3003, cval_part_p_size#2987 AS cval_part_p_size_0#3004, cval_part_p_container#2988 AS cval_part_p_container_0#3005, cval_part_p_retailprice#2989 AS cval_part_p_retailprice_0#3006, cval_part_p_comment#2990 AS cval_part_p_comment_0#3007, cval_part_p_brand#2991 AS cval_part_p_brand_0#3008, cp_name#2992 AS cp_name_0#3009, cp_mfgr#2993 AS cp_mfgr_0#3010, cp_type#2994 AS cp_type_0#3011, cp_size#2995 AS cp_size_0#3012, cp_container#2996 AS cp_container_0#3013, cp_retailprice#2997 AS cp_retailprice_0#3014, cp_comment#2998 AS cp_comment_0#3015, cp_brand#2999 AS cp_brand_0#3016]
         :  :  :  +- Relation[rid#2983,cval_part_p_name#2984,cval_part_p_mfgr#2985,cval_part_p_type#2986,cval_part_p_size#2987,cval_part_p_container#2988,cval_part_p_retailprice#2989,cval_part_p_comment#2990,cval_part_p_brand#2991,cp_name#2992,cp_mfgr#2993,cp_type#2994,cp_size#2995,cp_container#2996,cp_retailprice#2997,cp_comment#2998,cp_brand#2999] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#3017 AS rid_0#3034, cval_part_p_name#3018 AS cval_part_p_name_0#3035, cval_part_p_mfgr#3019 AS cval_part_p_mfgr_0#3036, cval_part_p_type#3020 AS cval_part_p_type_0#3037, cval_part_p_size#3021 AS cval_part_p_size_0#3038, cval_part_p_container#3022 AS cval_part_p_container_0#3039, cval_part_p_retailprice#3023 AS cval_part_p_retailprice_0#3040, cval_part_p_comment#3024 AS cval_part_p_comment_0#3041, cval_part_p_brand#3025 AS cval_part_p_brand_0#3042, cp_name#3026 AS cp_name_0#3043, cp_mfgr#3027 AS cp_mfgr_0#3044, cp_type#3028 AS cp_type_0#3045, cp_size#3029 AS cp_size_0#3046, cp_container#3030 AS cp_container_0#3047, cp_retailprice#3031 AS cp_retailprice_0#3048, cp_comment#3032 AS cp_comment_0#3049, cp_brand#3033 AS cp_brand_0#3050]
         :  :        +- Relation[rid#3017,cval_part_p_name#3018,cval_part_p_mfgr#3019,cval_part_p_type#3020,cval_part_p_size#3021,cval_part_p_container#3022,cval_part_p_retailprice#3023,cval_part_p_comment#3024,cval_part_p_brand#3025,cp_name#3026,cp_mfgr#3027,cp_type#3028,cp_size#3029,cp_container#3030,cp_retailprice#3031,cp_comment#3032,cp_brand#3033] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :     :- Project [rid#3073 AS rid_0#3090, cval_part_p_name#3074 AS cval_part_p_name_0#3091, cval_part_p_mfgr#3075 AS cval_part_p_mfgr_0#3092, cval_part_p_type#3076 AS cval_part_p_type_0#3093, cval_part_p_size#3077 AS cval_part_p_size_0#3094, cval_part_p_container#3078 AS cval_part_p_container_0#3095, cval_part_p_retailprice#3079 AS cval_part_p_retailprice_0#3096, cval_part_p_comment#3080 AS cval_part_p_comment_0#3097, cval_part_p_brand#3081 AS cval_part_p_brand_0#3098, cp_name#3082 AS cp_name_0#3099, cp_mfgr#3083 AS cp_mfgr_0#3100, cp_type#3084 AS cp_type_0#3101, cp_size#3085 AS cp_size_0#3102, cp_container#3086 AS cp_container_0#3103, cp_retailprice#3087 AS cp_retailprice_0#3104, cp_comment#3088 AS cp_comment_0#3105, cp_brand#3089 AS cp_brand_0#3106]
         :     :  +- Relation[rid#3073,cval_part_p_name#3074,cval_part_p_mfgr#3075,cval_part_p_type#3076,cval_part_p_size#3077,cval_part_p_container#3078,cval_part_p_retailprice#3079,cval_part_p_comment#3080,cval_part_p_brand#3081,cp_name#3082,cp_mfgr#3083,cp_type#3084,cp_size#3085,cp_container#3086,cp_retailprice#3087,cp_comment#3088,cp_brand#3089] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#3107 AS rid_1#3118, cpfk_part_partsupp#3108 AS cpfk_part_partsupp_1#3119, cfpk_partsupp_part#3109 AS cfpk_partsupp_part_1#3120, cpfk_supplier_partsupp#3110 AS cpfk_supplier_partsupp_1#3121, cfpk_partsupp_supplier#3111 AS cfpk_partsupp_supplier_1#3122, cval_partsupp_ps_availqty#3112 AS cval_partsupp_ps_availqty_1#3123, cval_partsupp_ps_supplycost#3113 AS cval_partsupp_ps_supplycost_1#3124, cval_partsupp_ps_comment#3114 AS cval_partsupp_ps_comment_1#3125, cps_availqty#3115 AS cps_availqty_1#3126, cps_supplycost#3116 AS cps_supplycost_1#3127, cps_comment#3117 AS cps_comment_1#3128]
         :        +- Relation[rid#3107,cpfk_part_partsupp#3108,cfpk_partsupp_part#3109,cpfk_supplier_partsupp#3110,cfpk_partsupp_supplier#3111,cval_partsupp_ps_availqty#3112,cval_partsupp_ps_supplycost#3113,cval_partsupp_ps_comment#3114,cps_availqty#3115,cps_supplycost#3116,cps_comment#3117] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#3051 AS rid_1#3062, cpfk_part_partsupp#3052 AS cpfk_part_partsupp_1#3063, cfpk_partsupp_part#3053 AS cfpk_partsupp_part_1#3064, cpfk_supplier_partsupp#3054 AS cpfk_supplier_partsupp_1#3065, cfpk_partsupp_supplier#3055 AS cfpk_partsupp_supplier_1#3066, cval_partsupp_ps_availqty#3056 AS cval_partsupp_ps_availqty_1#3067, cval_partsupp_ps_supplycost#3057 AS cval_partsupp_ps_supplycost_1#3068, cval_partsupp_ps_comment#3058 AS cval_partsupp_ps_comment_1#3069, cps_availqty#3059 AS cps_availqty_1#3070, cps_supplycost#3060 AS cps_supplycost_1#3071, cps_comment#3061 AS cps_comment_1#3072]
            +- Relation[rid#3051,cpfk_part_partsupp#3052,cfpk_partsupp_part#3053,cpfk_supplier_partsupp#3054,cfpk_partsupp_supplier#3055,cval_partsupp_ps_availqty#3056,cval_partsupp_ps_supplycost#3057,cval_partsupp_ps_comment#3058,cps_availqty#3059,cps_supplycost#3060,cps_comment#3061] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 11397ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/11 04:05:40 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:05:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3163L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 04:05:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:05:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:05:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:05:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:05:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:05:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:05:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:05:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:05:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:05:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:05:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:05:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:05:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:05:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3163L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#3165 AS rid_0#3172, cpfk_region_nation#3166 AS cpfk_region_nation_0#3173, cfpk_nation_region#3167 AS cfpk_nation_region_0#3174, cval_nation_n_name#3168 AS cval_nation_n_name_0#3175, cval_nation_n_comment#3169 AS cval_nation_n_comment_0#3176, cn_name#3170 AS cn_name_0#3177, cn_comment#3171 AS cn_comment_0#3178]
         :  :  :  :  :  +- Relation[rid#3165,cpfk_region_nation#3166,cfpk_nation_region#3167,cval_nation_n_name#3168,cval_nation_n_comment#3169,cn_name#3170,cn_comment#3171] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#3179 AS rid_0#3186, cpfk_region_nation#3180 AS cpfk_region_nation_0#3187, cfpk_nation_region#3181 AS cfpk_nation_region_0#3188, cval_nation_n_name#3182 AS cval_nation_n_name_0#3189, cval_nation_n_comment#3183 AS cval_nation_n_comment_0#3190, cn_name#3184 AS cn_name_0#3191, cn_comment#3185 AS cn_comment_0#3192]
         :  :  :  :        +- Relation[rid#3179,cpfk_region_nation#3180,cfpk_nation_region#3181,cval_nation_n_name#3182,cval_nation_n_comment#3183,cn_name#3184,cn_comment#3185] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :     :- Project [rid#3219 AS rid_0#3226, cpfk_region_nation#3220 AS cpfk_region_nation_0#3227, cfpk_nation_region#3221 AS cfpk_nation_region_0#3228, cval_nation_n_name#3222 AS cval_nation_n_name_0#3229, cval_nation_n_comment#3223 AS cval_nation_n_comment_0#3230, cn_name#3224 AS cn_name_0#3231, cn_comment#3225 AS cn_comment_0#3232]
         :  :  :     :  +- Relation[rid#3219,cpfk_region_nation#3220,cfpk_nation_region#3221,cval_nation_n_name#3222,cval_nation_n_comment#3223,cn_name#3224,cn_comment#3225] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#3233 AS rid_1#3246, cpfk_nation_supplier#3234 AS cpfk_nation_supplier_1#3247, cfpk_supplier_nation#3235 AS cfpk_supplier_nation_1#3248, cval_supplier_s_name#3236 AS cval_supplier_s_name_1#3249, cval_supplier_s_address#3237 AS cval_supplier_s_address_1#3250, cval_supplier_s_phone#3238 AS cval_supplier_s_phone_1#3251, cval_supplier_s_acctbal#3239 AS cval_supplier_s_acctbal_1#3252, cval_supplier_s_comment#3240 AS cval_supplier_s_comment_1#3253, cs_name#3241 AS cs_name_1#3254, cs_address#3242 AS cs_address_1#3255, cs_phone#3243 AS cs_phone_1#3256, cs_acctbal#3244 AS cs_acctbal_1#3257, cs_comment#3245 AS cs_comment_1#3258]
         :  :  :        +- Relation[rid#3233,cpfk_nation_supplier#3234,cfpk_supplier_nation#3235,cval_supplier_s_name#3236,cval_supplier_s_address#3237,cval_supplier_s_phone#3238,cval_supplier_s_acctbal#3239,cval_supplier_s_comment#3240,cs_name#3241,cs_address#3242,cs_phone#3243,cs_acctbal#3244,cs_comment#3245] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#3193 AS rid_1#3206, cpfk_nation_supplier#3194 AS cpfk_nation_supplier_1#3207, cfpk_supplier_nation#3195 AS cfpk_supplier_nation_1#3208, cval_supplier_s_name#3196 AS cval_supplier_s_name_1#3209, cval_supplier_s_address#3197 AS cval_supplier_s_address_1#3210, cval_supplier_s_phone#3198 AS cval_supplier_s_phone_1#3211, cval_supplier_s_acctbal#3199 AS cval_supplier_s_acctbal_1#3212, cval_supplier_s_comment#3200 AS cval_supplier_s_comment_1#3213, cs_name#3201 AS cs_name_1#3214, cs_address#3202 AS cs_address_1#3215, cs_phone#3203 AS cs_phone_1#3216, cs_acctbal#3204 AS cs_acctbal_1#3217, cs_comment#3205 AS cs_comment_1#3218]
         :  :     +- Relation[rid#3193,cpfk_nation_supplier#3194,cfpk_supplier_nation#3195,cval_supplier_s_name#3196,cval_supplier_s_address#3197,cval_supplier_s_phone#3198,cval_supplier_s_acctbal#3199,cval_supplier_s_comment#3200,cs_name#3201,cs_address#3202,cs_phone#3203,cs_acctbal#3204,cs_comment#3205] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :     :- Project [rid#3281 AS rid_1#3294, cpfk_nation_supplier#3282 AS cpfk_nation_supplier_1#3295, cfpk_supplier_nation#3283 AS cfpk_supplier_nation_1#3296, cval_supplier_s_name#3284 AS cval_supplier_s_name_1#3297, cval_supplier_s_address#3285 AS cval_supplier_s_address_1#3298, cval_supplier_s_phone#3286 AS cval_supplier_s_phone_1#3299, cval_supplier_s_acctbal#3287 AS cval_supplier_s_acctbal_1#3300, cval_supplier_s_comment#3288 AS cval_supplier_s_comment_1#3301, cs_name#3289 AS cs_name_1#3302, cs_address#3290 AS cs_address_1#3303, cs_phone#3291 AS cs_phone_1#3304, cs_acctbal#3292 AS cs_acctbal_1#3305, cs_comment#3293 AS cs_comment_1#3306]
         :     :  +- Relation[rid#3281,cpfk_nation_supplier#3282,cfpk_supplier_nation#3283,cval_supplier_s_name#3284,cval_supplier_s_address#3285,cval_supplier_s_phone#3286,cval_supplier_s_acctbal#3287,cval_supplier_s_comment#3288,cs_name#3289,cs_address#3290,cs_phone#3291,cs_acctbal#3292,cs_comment#3293] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#3307 AS rid_2#3318, cpfk_part_partsupp#3308 AS cpfk_part_partsupp_2#3319, cfpk_partsupp_part#3309 AS cfpk_partsupp_part_2#3320, cpfk_supplier_partsupp#3310 AS cpfk_supplier_partsupp_2#3321, cfpk_partsupp_supplier#3311 AS cfpk_partsupp_supplier_2#3322, cval_partsupp_ps_availqty#3312 AS cval_partsupp_ps_availqty_2#3323, cval_partsupp_ps_supplycost#3313 AS cval_partsupp_ps_supplycost_2#3324, cval_partsupp_ps_comment#3314 AS cval_partsupp_ps_comment_2#3325, cps_availqty#3315 AS cps_availqty_2#3326, cps_supplycost#3316 AS cps_supplycost_2#3327, cps_comment#3317 AS cps_comment_2#3328]
         :        +- Relation[rid#3307,cpfk_part_partsupp#3308,cfpk_partsupp_part#3309,cpfk_supplier_partsupp#3310,cfpk_partsupp_supplier#3311,cval_partsupp_ps_availqty#3312,cval_partsupp_ps_supplycost#3313,cval_partsupp_ps_comment#3314,cps_availqty#3315,cps_supplycost#3316,cps_comment#3317] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#3259 AS rid_2#3270, cpfk_part_partsupp#3260 AS cpfk_part_partsupp_2#3271, cfpk_partsupp_part#3261 AS cfpk_partsupp_part_2#3272, cpfk_supplier_partsupp#3262 AS cpfk_supplier_partsupp_2#3273, cfpk_partsupp_supplier#3263 AS cfpk_partsupp_supplier_2#3274, cval_partsupp_ps_availqty#3264 AS cval_partsupp_ps_availqty_2#3275, cval_partsupp_ps_supplycost#3265 AS cval_partsupp_ps_supplycost_2#3276, cval_partsupp_ps_comment#3266 AS cval_partsupp_ps_comment_2#3277, cps_availqty#3267 AS cps_availqty_2#3278, cps_supplycost#3268 AS cps_supplycost_2#3279, cps_comment#3269 AS cps_comment_2#3280]
            +- Relation[rid#3259,cpfk_part_partsupp#3260,cfpk_partsupp_part#3261,cpfk_supplier_partsupp#3262,cfpk_partsupp_supplier#3263,cval_partsupp_ps_availqty#3264,cval_partsupp_ps_supplycost#3265,cval_partsupp_ps_comment#3266,cps_availqty#3267,cps_supplycost#3268,cps_comment#3269] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 10318ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/11 04:05:50 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:05:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3366L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 04:05:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3366L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#3368 AS rid_0#3385, cval_part_p_name#3369 AS cval_part_p_name_0#3386, cval_part_p_mfgr#3370 AS cval_part_p_mfgr_0#3387, cval_part_p_type#3371 AS cval_part_p_type_0#3388, cval_part_p_size#3372 AS cval_part_p_size_0#3389, cval_part_p_container#3373 AS cval_part_p_container_0#3390, cval_part_p_retailprice#3374 AS cval_part_p_retailprice_0#3391, cval_part_p_comment#3375 AS cval_part_p_comment_0#3392, cval_part_p_brand#3376 AS cval_part_p_brand_0#3393, cp_name#3377 AS cp_name_0#3394, cp_mfgr#3378 AS cp_mfgr_0#3395, cp_type#3379 AS cp_type_0#3396, cp_size#3380 AS cp_size_0#3397, cp_container#3381 AS cp_container_0#3398, cp_retailprice#3382 AS cp_retailprice_0#3399, cp_comment#3383 AS cp_comment_0#3400, cp_brand#3384 AS cp_brand_0#3401]
         :  :  +- Relation[rid#3368,cval_part_p_name#3369,cval_part_p_mfgr#3370,cval_part_p_type#3371,cval_part_p_size#3372,cval_part_p_container#3373,cval_part_p_retailprice#3374,cval_part_p_comment#3375,cval_part_p_brand#3376,cp_name#3377,cp_mfgr#3378,cp_type#3379,cp_size#3380,cp_container#3381,cp_retailprice#3382,cp_comment#3383,cp_brand#3384] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#3468 AS rid_0#3485, cval_part_p_name#3469 AS cval_part_p_name_0#3486, cval_part_p_mfgr#3470 AS cval_part_p_mfgr_0#3487, cval_part_p_type#3471 AS cval_part_p_type_0#3488, cval_part_p_size#3472 AS cval_part_p_size_0#3489, cval_part_p_container#3473 AS cval_part_p_container_0#3490, cval_part_p_retailprice#3474 AS cval_part_p_retailprice_0#3491, cval_part_p_comment#3475 AS cval_part_p_comment_0#3492, cval_part_p_brand#3476 AS cval_part_p_brand_0#3493, cp_name#3477 AS cp_name_0#3494, cp_mfgr#3478 AS cp_mfgr_0#3495, cp_type#3479 AS cp_type_0#3496, cp_size#3480 AS cp_size_0#3497, cp_container#3481 AS cp_container_0#3498, cp_retailprice#3482 AS cp_retailprice_0#3499, cp_comment#3483 AS cp_comment_0#3500, cp_brand#3484 AS cp_brand_0#3501]
         :     :  +- Relation[rid#3468,cval_part_p_name#3469,cval_part_p_mfgr#3470,cval_part_p_type#3471,cval_part_p_size#3472,cval_part_p_container#3473,cval_part_p_retailprice#3474,cval_part_p_comment#3475,cval_part_p_brand#3476,cp_name#3477,cp_mfgr#3478,cp_type#3479,cp_size#3480,cp_container#3481,cp_retailprice#3482,cp_comment#3483,cp_brand#3484] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#3502 AS rid_1#3535, cpfk_orders_lineitem#3503 AS cpfk_orders_lineitem_1#3536, cpfk_supplier_lineitem#3504 AS cpfk_supplier_lineitem_1#3537, cfpk_lineitem_supplier#3505 AS cfpk_lineitem_supplier_1#3538, cfpk_lineitem_partsupp#3506 AS cfpk_lineitem_partsupp_1#3539, cpfk_part_lineitem#3507 AS cpfk_part_lineitem_1#3540, cfpk_lineitem_part#3508 AS cfpk_lineitem_part_1#3541, cpfk_partsupp_lineitem#3509 AS cpfk_partsupp_lineitem_1#3542, cfpk_lineitem_orders#3510 AS cfpk_lineitem_orders_1#3543, cval_lineitem_l_quantity#3511 AS cval_lineitem_l_quantity_1#3544, cval_lineitem_l_extendedprice#3512 AS cval_lineitem_l_extendedprice_1#3545, cval_lineitem_l_discount#3513 AS cval_lineitem_l_discount_1#3546, cval_lineitem_l_tax#3514 AS cval_lineitem_l_tax_1#3547, cval_lineitem_l_returnflag#3515 AS cval_lineitem_l_returnflag_1#3548, cval_lineitem_l_linestatus#3516 AS cval_lineitem_l_linestatus_1#3549, cval_lineitem_l_commitdate#3517 AS cval_lineitem_l_commitdate_1#3550, cval_lineitem_l_receiptdate#3518 AS cval_lineitem_l_receiptdate_1#3551, cval_lineitem_l_shipinstruct#3519 AS cval_lineitem_l_shipinstruct_1#3552, cval_lineitem_l_shipmode#3520 AS cval_lineitem_l_shipmode_1#3553, cval_lineitem_l_comment#3521 AS cval_lineitem_l_comment_1#3554, cval_lineitem_l_shipdate#3522 AS cval_lineitem_l_shipdate_1#3555, cl_quantity#3523 AS cl_quantity_1#3556, cl_extendedprice#3524 AS cl_extendedprice_1#3557, cl_discount#3525 AS cl_discount_1#3558, ... 9 more fields]
         :        +- Relation[rid#3502,cpfk_orders_lineitem#3503,cpfk_supplier_lineitem#3504,cfpk_lineitem_supplier#3505,cfpk_lineitem_partsupp#3506,cpfk_part_lineitem#3507,cfpk_lineitem_part#3508,cpfk_partsupp_lineitem#3509,cfpk_lineitem_orders#3510,cval_lineitem_l_quantity#3511,cval_lineitem_l_extendedprice#3512,cval_lineitem_l_discount#3513,cval_lineitem_l_tax#3514,cval_lineitem_l_returnflag#3515,cval_lineitem_l_linestatus#3516,cval_lineitem_l_commitdate#3517,cval_lineitem_l_receiptdate#3518,cval_lineitem_l_shipinstruct#3519,cval_lineitem_l_shipmode#3520,cval_lineitem_l_comment#3521,cval_lineitem_l_shipdate#3522,cl_quantity#3523,cl_extendedprice#3524,cl_discount#3525,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#3402 AS rid_1#3435, cpfk_orders_lineitem#3403 AS cpfk_orders_lineitem_1#3436, cpfk_supplier_lineitem#3404 AS cpfk_supplier_lineitem_1#3437, cfpk_lineitem_supplier#3405 AS cfpk_lineitem_supplier_1#3438, cfpk_lineitem_partsupp#3406 AS cfpk_lineitem_partsupp_1#3439, cpfk_part_lineitem#3407 AS cpfk_part_lineitem_1#3440, cfpk_lineitem_part#3408 AS cfpk_lineitem_part_1#3441, cpfk_partsupp_lineitem#3409 AS cpfk_partsupp_lineitem_1#3442, cfpk_lineitem_orders#3410 AS cfpk_lineitem_orders_1#3443, cval_lineitem_l_quantity#3411 AS cval_lineitem_l_quantity_1#3444, cval_lineitem_l_extendedprice#3412 AS cval_lineitem_l_extendedprice_1#3445, cval_lineitem_l_discount#3413 AS cval_lineitem_l_discount_1#3446, cval_lineitem_l_tax#3414 AS cval_lineitem_l_tax_1#3447, cval_lineitem_l_returnflag#3415 AS cval_lineitem_l_returnflag_1#3448, cval_lineitem_l_linestatus#3416 AS cval_lineitem_l_linestatus_1#3449, cval_lineitem_l_commitdate#3417 AS cval_lineitem_l_commitdate_1#3450, cval_lineitem_l_receiptdate#3418 AS cval_lineitem_l_receiptdate_1#3451, cval_lineitem_l_shipinstruct#3419 AS cval_lineitem_l_shipinstruct_1#3452, cval_lineitem_l_shipmode#3420 AS cval_lineitem_l_shipmode_1#3453, cval_lineitem_l_comment#3421 AS cval_lineitem_l_comment_1#3454, cval_lineitem_l_shipdate#3422 AS cval_lineitem_l_shipdate_1#3455, cl_quantity#3423 AS cl_quantity_1#3456, cl_extendedprice#3424 AS cl_extendedprice_1#3457, cl_discount#3425 AS cl_discount_1#3458, ... 9 more fields]
            +- Relation[rid#3402,cpfk_orders_lineitem#3403,cpfk_supplier_lineitem#3404,cfpk_lineitem_supplier#3405,cfpk_lineitem_partsupp#3406,cpfk_part_lineitem#3407,cfpk_lineitem_part#3408,cpfk_partsupp_lineitem#3409,cfpk_lineitem_orders#3410,cval_lineitem_l_quantity#3411,cval_lineitem_l_extendedprice#3412,cval_lineitem_l_discount#3413,cval_lineitem_l_tax#3414,cval_lineitem_l_returnflag#3415,cval_lineitem_l_linestatus#3416,cval_lineitem_l_commitdate#3417,cval_lineitem_l_receiptdate#3418,cval_lineitem_l_shipinstruct#3419,cval_lineitem_l_shipmode#3420,cval_lineitem_l_comment#3421,cval_lineitem_l_shipdate#3422,cl_quantity#3423,cl_extendedprice#3424,cl_discount#3425,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 82481ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/11 04:07:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:07:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3624L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 04:07:13 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:07:13 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:07:13 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:07:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:07:13 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:07:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:07:13 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:07:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:07:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:07:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:07:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:07:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:07:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:07:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:07:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:07:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:07:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3624L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#3626 AS rid_0#3631, cval_region_r_name#3627 AS cval_region_r_name_0#3632, cval_region_r_comment#3628 AS cval_region_r_comment_0#3633, cr_name#3629 AS cr_name_0#3634, cr_comment#3630 AS cr_comment_0#3635]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#3626,cval_region_r_name#3627,cval_region_r_comment#3628,cr_name#3629,cr_comment#3630] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#3636 AS rid_0#3641, cval_region_r_name#3637 AS cval_region_r_name_0#3642, cval_region_r_comment#3638 AS cval_region_r_comment_0#3643, cr_name#3639 AS cr_name_0#3644, cr_comment#3640 AS cr_comment_0#3645]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#3636,cval_region_r_name#3637,cval_region_r_comment#3638,cr_name#3639,cr_comment#3640] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :     :- Project [rid#3660 AS rid_0#3665, cval_region_r_name#3661 AS cval_region_r_name_0#3666, cval_region_r_comment#3662 AS cval_region_r_comment_0#3667, cr_name#3663 AS cr_name_0#3668, cr_comment#3664 AS cr_comment_0#3669]
         :     :  :  :  :  :  :  :  :     :  +- Relation[rid#3660,cval_region_r_name#3661,cval_region_r_comment#3662,cr_name#3663,cr_comment#3664] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :     +- Project [rid#3670 AS rid_1#3677, cpfk_region_nation#3671 AS cpfk_region_nation_1#3678, cfpk_nation_region#3672 AS cfpk_nation_region_1#3679, cval_nation_n_name#3673 AS cval_nation_n_name_1#3680, cval_nation_n_comment#3674 AS cval_nation_n_comment_1#3681, cn_name#3675 AS cn_name_1#3682, cn_comment#3676 AS cn_comment_1#3683]
         :     :  :  :  :  :  :  :  :        +- Relation[rid#3670,cpfk_region_nation#3671,cfpk_nation_region#3672,cval_nation_n_name#3673,cval_nation_n_comment#3674,cn_name#3675,cn_comment#3676] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#3646 AS rid_1#3653, cpfk_region_nation#3647 AS cpfk_region_nation_1#3654, cfpk_nation_region#3648 AS cfpk_nation_region_1#3655, cval_nation_n_name#3649 AS cval_nation_n_name_1#3656, cval_nation_n_comment#3650 AS cval_nation_n_comment_1#3657, cn_name#3651 AS cn_name_1#3658, cn_comment#3652 AS cn_comment_1#3659]
         :     :  :  :  :  :  :  :     +- Relation[rid#3646,cpfk_region_nation#3647,cfpk_nation_region#3648,cval_nation_n_name#3649,cval_nation_n_comment#3650,cn_name#3651,cn_comment#3652] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :     :- Project [rid#3714 AS rid_1#3721, cpfk_region_nation#3715 AS cpfk_region_nation_1#3722, cfpk_nation_region#3716 AS cfpk_nation_region_1#3723, cval_nation_n_name#3717 AS cval_nation_n_name_1#3724, cval_nation_n_comment#3718 AS cval_nation_n_comment_1#3725, cn_name#3719 AS cn_name_1#3726, cn_comment#3720 AS cn_comment_1#3727]
         :     :  :  :  :  :  :     :  +- Relation[rid#3714,cpfk_region_nation#3715,cfpk_nation_region#3716,cval_nation_n_name#3717,cval_nation_n_comment#3718,cn_name#3719,cn_comment#3720] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :     +- Project [rid#3728 AS rid_2#3743, cpfk_nation_customer#3729 AS cpfk_nation_customer_2#3744, cfpk_customer_nation#3730 AS cfpk_customer_nation_2#3745, cval_customer_c_name#3731 AS cval_customer_c_name_2#3746, cval_customer_c_address#3732 AS cval_customer_c_address_2#3747, cval_customer_c_phone#3733 AS cval_customer_c_phone_2#3748, cval_customer_c_acctbal#3734 AS cval_customer_c_acctbal_2#3749, cval_customer_c_comment#3735 AS cval_customer_c_comment_2#3750, cval_customer_c_mktsegment#3736 AS cval_customer_c_mktsegment_2#3751, cc_name#3737 AS cc_name_2#3752, cc_address#3738 AS cc_address_2#3753, cc_phone#3739 AS cc_phone_2#3754, cc_acctbal#3740 AS cc_acctbal_2#3755, cc_comment#3741 AS cc_comment_2#3756, cc_mktsegment#3742 AS cc_mktsegment_2#3757]
         :     :  :  :  :  :  :        +- Relation[rid#3728,cpfk_nation_customer#3729,cfpk_customer_nation#3730,cval_customer_c_name#3731,cval_customer_c_address#3732,cval_customer_c_phone#3733,cval_customer_c_acctbal#3734,cval_customer_c_comment#3735,cval_customer_c_mktsegment#3736,cc_name#3737,cc_address#3738,cc_phone#3739,cc_acctbal#3740,cc_comment#3741,cc_mktsegment#3742] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#3684 AS rid_2#3699, cpfk_nation_customer#3685 AS cpfk_nation_customer_2#3700, cfpk_customer_nation#3686 AS cfpk_customer_nation_2#3701, cval_customer_c_name#3687 AS cval_customer_c_name_2#3702, cval_customer_c_address#3688 AS cval_customer_c_address_2#3703, cval_customer_c_phone#3689 AS cval_customer_c_phone_2#3704, cval_customer_c_acctbal#3690 AS cval_customer_c_acctbal_2#3705, cval_customer_c_comment#3691 AS cval_customer_c_comment_2#3706, cval_customer_c_mktsegment#3692 AS cval_customer_c_mktsegment_2#3707, cc_name#3693 AS cc_name_2#3708, cc_address#3694 AS cc_address_2#3709, cc_phone#3695 AS cc_phone_2#3710, cc_acctbal#3696 AS cc_acctbal_2#3711, cc_comment#3697 AS cc_comment_2#3712, cc_mktsegment#3698 AS cc_mktsegment_2#3713]
         :     :  :  :  :  :     +- Relation[rid#3684,cpfk_nation_customer#3685,cfpk_customer_nation#3686,cval_customer_c_name#3687,cval_customer_c_address#3688,cval_customer_c_phone#3689,cval_customer_c_acctbal#3690,cval_customer_c_comment#3691,cval_customer_c_mktsegment#3692,cc_name#3693,cc_address#3694,cc_phone#3695,cc_acctbal#3696,cc_comment#3697,cc_mktsegment#3698] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :     :- Project [rid#3792 AS rid_2#3807, cpfk_nation_customer#3793 AS cpfk_nation_customer_2#3808, cfpk_customer_nation#3794 AS cfpk_customer_nation_2#3809, cval_customer_c_name#3795 AS cval_customer_c_name_2#3810, cval_customer_c_address#3796 AS cval_customer_c_address_2#3811, cval_customer_c_phone#3797 AS cval_customer_c_phone_2#3812, cval_customer_c_acctbal#3798 AS cval_customer_c_acctbal_2#3813, cval_customer_c_comment#3799 AS cval_customer_c_comment_2#3814, cval_customer_c_mktsegment#3800 AS cval_customer_c_mktsegment_2#3815, cc_name#3801 AS cc_name_2#3816, cc_address#3802 AS cc_address_2#3817, cc_phone#3803 AS cc_phone_2#3818, cc_acctbal#3804 AS cc_acctbal_2#3819, cc_comment#3805 AS cc_comment_2#3820, cc_mktsegment#3806 AS cc_mktsegment_2#3821]
         :     :  :  :  :     :  +- Relation[rid#3792,cpfk_nation_customer#3793,cfpk_customer_nation#3794,cval_customer_c_name#3795,cval_customer_c_address#3796,cval_customer_c_phone#3797,cval_customer_c_acctbal#3798,cval_customer_c_comment#3799,cval_customer_c_mktsegment#3800,cc_name#3801,cc_address#3802,cc_phone#3803,cc_acctbal#3804,cc_comment#3805,cc_mktsegment#3806] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :     +- Project [rid#3822 AS rid_3#3839, cpfk_customer_orders#3823 AS cpfk_customer_orders_3#3840, cfpk_orders_customer#3824 AS cfpk_orders_customer_3#3841, cval_orders_o_orderstatus#3825 AS cval_orders_o_orderstatus_3#3842, cval_orders_o_totalprice#3826 AS cval_orders_o_totalprice_3#3843, cval_orders_o_orderpriority#3827 AS cval_orders_o_orderpriority_3#3844, cval_orders_o_clerk#3828 AS cval_orders_o_clerk_3#3845, cval_orders_o_shippriority#3829 AS cval_orders_o_shippriority_3#3846, cval_orders_o_comment#3830 AS cval_orders_o_comment_3#3847, cval_orders_o_orderdate#3831 AS cval_orders_o_orderdate_3#3848, co_orderstatus#3832 AS co_orderstatus_3#3849, co_totalprice#3833 AS co_totalprice_3#3850, co_orderpriority#3834 AS co_orderpriority_3#3851, co_clerk#3835 AS co_clerk_3#3852, co_shippriority#3836 AS co_shippriority_3#3853, co_comment#3837 AS co_comment_3#3854, co_orderdate#3838 AS co_orderdate_3#3855]
         :     :  :  :  :        +- Relation[rid#3822,cpfk_customer_orders#3823,cfpk_orders_customer#3824,cval_orders_o_orderstatus#3825,cval_orders_o_totalprice#3826,cval_orders_o_orderpriority#3827,cval_orders_o_clerk#3828,cval_orders_o_shippriority#3829,cval_orders_o_comment#3830,cval_orders_o_orderdate#3831,co_orderstatus#3832,co_totalprice#3833,co_orderpriority#3834,co_clerk#3835,co_shippriority#3836,co_comment#3837,co_orderdate#3838] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#3758 AS rid_3#3775, cpfk_customer_orders#3759 AS cpfk_customer_orders_3#3776, cfpk_orders_customer#3760 AS cfpk_orders_customer_3#3777, cval_orders_o_orderstatus#3761 AS cval_orders_o_orderstatus_3#3778, cval_orders_o_totalprice#3762 AS cval_orders_o_totalprice_3#3779, cval_orders_o_orderpriority#3763 AS cval_orders_o_orderpriority_3#3780, cval_orders_o_clerk#3764 AS cval_orders_o_clerk_3#3781, cval_orders_o_shippriority#3765 AS cval_orders_o_shippriority_3#3782, cval_orders_o_comment#3766 AS cval_orders_o_comment_3#3783, cval_orders_o_orderdate#3767 AS cval_orders_o_orderdate_3#3784, co_orderstatus#3768 AS co_orderstatus_3#3785, co_totalprice#3769 AS co_totalprice_3#3786, co_orderpriority#3770 AS co_orderpriority_3#3787, co_clerk#3771 AS co_clerk_3#3788, co_shippriority#3772 AS co_shippriority_3#3789, co_comment#3773 AS co_comment_3#3790, co_orderdate#3774 AS co_orderdate_3#3791]
         :     :  :  :     +- Relation[rid#3758,cpfk_customer_orders#3759,cfpk_orders_customer#3760,cval_orders_o_orderstatus#3761,cval_orders_o_totalprice#3762,cval_orders_o_orderpriority#3763,cval_orders_o_clerk#3764,cval_orders_o_shippriority#3765,cval_orders_o_comment#3766,cval_orders_o_orderdate#3767,co_orderstatus#3768,co_totalprice#3769,co_orderpriority#3770,co_clerk#3771,co_shippriority#3772,co_comment#3773,co_orderdate#3774] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :     :- Project [rid#3922 AS rid_3#3939, cpfk_customer_orders#3923 AS cpfk_customer_orders_3#3940, cfpk_orders_customer#3924 AS cfpk_orders_customer_3#3941, cval_orders_o_orderstatus#3925 AS cval_orders_o_orderstatus_3#3942, cval_orders_o_totalprice#3926 AS cval_orders_o_totalprice_3#3943, cval_orders_o_orderpriority#3927 AS cval_orders_o_orderpriority_3#3944, cval_orders_o_clerk#3928 AS cval_orders_o_clerk_3#3945, cval_orders_o_shippriority#3929 AS cval_orders_o_shippriority_3#3946, cval_orders_o_comment#3930 AS cval_orders_o_comment_3#3947, cval_orders_o_orderdate#3931 AS cval_orders_o_orderdate_3#3948, co_orderstatus#3932 AS co_orderstatus_3#3949, co_totalprice#3933 AS co_totalprice_3#3950, co_orderpriority#3934 AS co_orderpriority_3#3951, co_clerk#3935 AS co_clerk_3#3952, co_shippriority#3936 AS co_shippriority_3#3953, co_comment#3937 AS co_comment_3#3954, co_orderdate#3938 AS co_orderdate_3#3955]
         :     :  :     :  +- Relation[rid#3922,cpfk_customer_orders#3923,cfpk_orders_customer#3924,cval_orders_o_orderstatus#3925,cval_orders_o_totalprice#3926,cval_orders_o_orderpriority#3927,cval_orders_o_clerk#3928,cval_orders_o_shippriority#3929,cval_orders_o_comment#3930,cval_orders_o_orderdate#3931,co_orderstatus#3932,co_totalprice#3933,co_orderpriority#3934,co_clerk#3935,co_shippriority#3936,co_comment#3937,co_orderdate#3938] JDBCRelation(torders) [numPartitions=1]
         :     :  :     +- Project [rid#3956 AS rid_4#3989, cpfk_orders_lineitem#3957 AS cpfk_orders_lineitem_4#3990, cpfk_supplier_lineitem#3958 AS cpfk_supplier_lineitem_4#3991, cfpk_lineitem_supplier#3959 AS cfpk_lineitem_supplier_4#3992, cfpk_lineitem_partsupp#3960 AS cfpk_lineitem_partsupp_4#3993, cpfk_part_lineitem#3961 AS cpfk_part_lineitem_4#3994, cfpk_lineitem_part#3962 AS cfpk_lineitem_part_4#3995, cpfk_partsupp_lineitem#3963 AS cpfk_partsupp_lineitem_4#3996, cfpk_lineitem_orders#3964 AS cfpk_lineitem_orders_4#3997, cval_lineitem_l_quantity#3965 AS cval_lineitem_l_quantity_4#3998, cval_lineitem_l_extendedprice#3966 AS cval_lineitem_l_extendedprice_4#3999, cval_lineitem_l_discount#3967 AS cval_lineitem_l_discount_4#4000, cval_lineitem_l_tax#3968 AS cval_lineitem_l_tax_4#4001, cval_lineitem_l_returnflag#3969 AS cval_lineitem_l_returnflag_4#4002, cval_lineitem_l_linestatus#3970 AS cval_lineitem_l_linestatus_4#4003, cval_lineitem_l_commitdate#3971 AS cval_lineitem_l_commitdate_4#4004, cval_lineitem_l_receiptdate#3972 AS cval_lineitem_l_receiptdate_4#4005, cval_lineitem_l_shipinstruct#3973 AS cval_lineitem_l_shipinstruct_4#4006, cval_lineitem_l_shipmode#3974 AS cval_lineitem_l_shipmode_4#4007, cval_lineitem_l_comment#3975 AS cval_lineitem_l_comment_4#4008, cval_lineitem_l_shipdate#3976 AS cval_lineitem_l_shipdate_4#4009, cl_quantity#3977 AS cl_quantity_4#4010, cl_extendedprice#3978 AS cl_extendedprice_4#4011, cl_discount#3979 AS cl_discount_4#4012, ... 9 more fields]
         :     :  :        +- Relation[rid#3956,cpfk_orders_lineitem#3957,cpfk_supplier_lineitem#3958,cfpk_lineitem_supplier#3959,cfpk_lineitem_partsupp#3960,cpfk_part_lineitem#3961,cfpk_lineitem_part#3962,cpfk_partsupp_lineitem#3963,cfpk_lineitem_orders#3964,cval_lineitem_l_quantity#3965,cval_lineitem_l_extendedprice#3966,cval_lineitem_l_discount#3967,cval_lineitem_l_tax#3968,cval_lineitem_l_returnflag#3969,cval_lineitem_l_linestatus#3970,cval_lineitem_l_commitdate#3971,cval_lineitem_l_receiptdate#3972,cval_lineitem_l_shipinstruct#3973,cval_lineitem_l_shipmode#3974,cval_lineitem_l_comment#3975,cval_lineitem_l_shipdate#3976,cl_quantity#3977,cl_extendedprice#3978,cl_discount#3979,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#3856 AS rid_4#3889, cpfk_orders_lineitem#3857 AS cpfk_orders_lineitem_4#3890, cpfk_supplier_lineitem#3858 AS cpfk_supplier_lineitem_4#3891, cfpk_lineitem_supplier#3859 AS cfpk_lineitem_supplier_4#3892, cfpk_lineitem_partsupp#3860 AS cfpk_lineitem_partsupp_4#3893, cpfk_part_lineitem#3861 AS cpfk_part_lineitem_4#3894, cfpk_lineitem_part#3862 AS cfpk_lineitem_part_4#3895, cpfk_partsupp_lineitem#3863 AS cpfk_partsupp_lineitem_4#3896, cfpk_lineitem_orders#3864 AS cfpk_lineitem_orders_4#3897, cval_lineitem_l_quantity#3865 AS cval_lineitem_l_quantity_4#3898, cval_lineitem_l_extendedprice#3866 AS cval_lineitem_l_extendedprice_4#3899, cval_lineitem_l_discount#3867 AS cval_lineitem_l_discount_4#3900, cval_lineitem_l_tax#3868 AS cval_lineitem_l_tax_4#3901, cval_lineitem_l_returnflag#3869 AS cval_lineitem_l_returnflag_4#3902, cval_lineitem_l_linestatus#3870 AS cval_lineitem_l_linestatus_4#3903, cval_lineitem_l_commitdate#3871 AS cval_lineitem_l_commitdate_4#3904, cval_lineitem_l_receiptdate#3872 AS cval_lineitem_l_receiptdate_4#3905, cval_lineitem_l_shipinstruct#3873 AS cval_lineitem_l_shipinstruct_4#3906, cval_lineitem_l_shipmode#3874 AS cval_lineitem_l_shipmode_4#3907, cval_lineitem_l_comment#3875 AS cval_lineitem_l_comment_4#3908, cval_lineitem_l_shipdate#3876 AS cval_lineitem_l_shipdate_4#3909, cl_quantity#3877 AS cl_quantity_4#3910, cl_extendedprice#3878 AS cl_extendedprice_4#3911, cl_discount#3879 AS cl_discount_4#3912, ... 9 more fields]
         :     :     +- Relation[rid#3856,cpfk_orders_lineitem#3857,cpfk_supplier_lineitem#3858,cfpk_lineitem_supplier#3859,cfpk_lineitem_partsupp#3860,cpfk_part_lineitem#3861,cfpk_lineitem_part#3862,cpfk_partsupp_lineitem#3863,cfpk_lineitem_orders#3864,cval_lineitem_l_quantity#3865,cval_lineitem_l_extendedprice#3866,cval_lineitem_l_discount#3867,cval_lineitem_l_tax#3868,cval_lineitem_l_returnflag#3869,cval_lineitem_l_linestatus#3870,cval_lineitem_l_commitdate#3871,cval_lineitem_l_receiptdate#3872,cval_lineitem_l_shipinstruct#3873,cval_lineitem_l_shipmode#3874,cval_lineitem_l_comment#3875,cval_lineitem_l_shipdate#3876,cl_quantity#3877,cl_extendedprice#3878,cl_discount#3879,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#4022 AS rid_5#4035, cpfk_nation_supplier#4023 AS cpfk_nation_supplier_5#4036, cfpk_supplier_nation#4024 AS cfpk_supplier_nation_5#4037, cval_supplier_s_name#4025 AS cval_supplier_s_name_5#4038, cval_supplier_s_address#4026 AS cval_supplier_s_address_5#4039, cval_supplier_s_phone#4027 AS cval_supplier_s_phone_5#4040, cval_supplier_s_acctbal#4028 AS cval_supplier_s_acctbal_5#4041, cval_supplier_s_comment#4029 AS cval_supplier_s_comment_5#4042, cs_name#4030 AS cs_name_5#4043, cs_address#4031 AS cs_address_5#4044, cs_phone#4032 AS cs_phone_5#4045, cs_acctbal#4033 AS cs_acctbal_5#4046, cs_comment#4034 AS cs_comment_5#4047]
         :        +- Relation[rid#4022,cpfk_nation_supplier#4023,cfpk_supplier_nation#4024,cval_supplier_s_name#4025,cval_supplier_s_address#4026,cval_supplier_s_phone#4027,cval_supplier_s_acctbal#4028,cval_supplier_s_comment#4029,cs_name#4030,cs_address#4031,cs_phone#4032,cs_acctbal#4033,cs_comment#4034] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#4048 AS rid_1#4055, cpfk_region_nation#4049 AS cpfk_region_nation_1#4056, cfpk_nation_region#4050 AS cfpk_nation_region_1#4057, cval_nation_n_name#4051 AS cval_nation_n_name_1#4058, cval_nation_n_comment#4052 AS cval_nation_n_comment_1#4059, cn_name#4053 AS cn_name_1#4060, cn_comment#4054 AS cn_comment_1#4061]
            :  +- Relation[rid#4048,cpfk_region_nation#4049,cfpk_nation_region#4050,cval_nation_n_name#4051,cval_nation_n_comment#4052,cn_name#4053,cn_comment#4054] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#4062 AS rid_5#4075, cpfk_nation_supplier#4063 AS cpfk_nation_supplier_5#4076, cfpk_supplier_nation#4064 AS cfpk_supplier_nation_5#4077, cval_supplier_s_name#4065 AS cval_supplier_s_name_5#4078, cval_supplier_s_address#4066 AS cval_supplier_s_address_5#4079, cval_supplier_s_phone#4067 AS cval_supplier_s_phone_5#4080, cval_supplier_s_acctbal#4068 AS cval_supplier_s_acctbal_5#4081, cval_supplier_s_comment#4069 AS cval_supplier_s_comment_5#4082, cs_name#4070 AS cs_name_5#4083, cs_address#4071 AS cs_address_5#4084, cs_phone#4072 AS cs_phone_5#4085, cs_acctbal#4073 AS cs_acctbal_5#4086, cs_comment#4074 AS cs_comment_5#4087]
               +- Relation[rid#4062,cpfk_nation_supplier#4063,cfpk_supplier_nation#4064,cval_supplier_s_name#4065,cval_supplier_s_address#4066,cval_supplier_s_phone#4067,cval_supplier_s_acctbal#4068,cval_supplier_s_comment#4069,cs_name#4070,cs_address#4071,cs_phone#4072,cs_acctbal#4073,cs_comment#4074] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1206514
Elapsed time: 165427ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/11 04:09:58 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:09:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4206L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 04:09:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4206L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#4208 AS rid_0#4241, cpfk_orders_lineitem#4209 AS cpfk_orders_lineitem_0#4242, cpfk_supplier_lineitem#4210 AS cpfk_supplier_lineitem_0#4243, cfpk_lineitem_supplier#4211 AS cfpk_lineitem_supplier_0#4244, cfpk_lineitem_partsupp#4212 AS cfpk_lineitem_partsupp_0#4245, cpfk_part_lineitem#4213 AS cpfk_part_lineitem_0#4246, cfpk_lineitem_part#4214 AS cfpk_lineitem_part_0#4247, cpfk_partsupp_lineitem#4215 AS cpfk_partsupp_lineitem_0#4248, cfpk_lineitem_orders#4216 AS cfpk_lineitem_orders_0#4249, cval_lineitem_l_quantity#4217 AS cval_lineitem_l_quantity_0#4250, cval_lineitem_l_extendedprice#4218 AS cval_lineitem_l_extendedprice_0#4251, cval_lineitem_l_discount#4219 AS cval_lineitem_l_discount_0#4252, cval_lineitem_l_tax#4220 AS cval_lineitem_l_tax_0#4253, cval_lineitem_l_returnflag#4221 AS cval_lineitem_l_returnflag_0#4254, cval_lineitem_l_linestatus#4222 AS cval_lineitem_l_linestatus_0#4255, cval_lineitem_l_commitdate#4223 AS cval_lineitem_l_commitdate_0#4256, cval_lineitem_l_receiptdate#4224 AS cval_lineitem_l_receiptdate_0#4257, cval_lineitem_l_shipinstruct#4225 AS cval_lineitem_l_shipinstruct_0#4258, cval_lineitem_l_shipmode#4226 AS cval_lineitem_l_shipmode_0#4259, cval_lineitem_l_comment#4227 AS cval_lineitem_l_comment_0#4260, cval_lineitem_l_shipdate#4228 AS cval_lineitem_l_shipdate_0#4261, cl_quantity#4229 AS cl_quantity_0#4262, cl_extendedprice#4230 AS cl_extendedprice_0#4263, cl_discount#4231 AS cl_discount_0#4264, ... 9 more fields]
            :  +- Relation[rid#4208,cpfk_orders_lineitem#4209,cpfk_supplier_lineitem#4210,cfpk_lineitem_supplier#4211,cfpk_lineitem_partsupp#4212,cpfk_part_lineitem#4213,cfpk_lineitem_part#4214,cpfk_partsupp_lineitem#4215,cfpk_lineitem_orders#4216,cval_lineitem_l_quantity#4217,cval_lineitem_l_extendedprice#4218,cval_lineitem_l_discount#4219,cval_lineitem_l_tax#4220,cval_lineitem_l_returnflag#4221,cval_lineitem_l_linestatus#4222,cval_lineitem_l_commitdate#4223,cval_lineitem_l_receiptdate#4224,cval_lineitem_l_shipinstruct#4225,cval_lineitem_l_shipmode#4226,cval_lineitem_l_comment#4227,cval_lineitem_l_shipdate#4228,cl_quantity#4229,cl_extendedprice#4230,cl_discount#4231,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#4274 AS rid_1#4291, cpfk_customer_orders#4275 AS cpfk_customer_orders_1#4292, cfpk_orders_customer#4276 AS cfpk_orders_customer_1#4293, cval_orders_o_orderstatus#4277 AS cval_orders_o_orderstatus_1#4294, cval_orders_o_totalprice#4278 AS cval_orders_o_totalprice_1#4295, cval_orders_o_orderpriority#4279 AS cval_orders_o_orderpriority_1#4296, cval_orders_o_clerk#4280 AS cval_orders_o_clerk_1#4297, cval_orders_o_shippriority#4281 AS cval_orders_o_shippriority_1#4298, cval_orders_o_comment#4282 AS cval_orders_o_comment_1#4299, cval_orders_o_orderdate#4283 AS cval_orders_o_orderdate_1#4300, co_orderstatus#4284 AS co_orderstatus_1#4301, co_totalprice#4285 AS co_totalprice_1#4302, co_orderpriority#4286 AS co_orderpriority_1#4303, co_clerk#4287 AS co_clerk_1#4304, co_shippriority#4288 AS co_shippriority_1#4305, co_comment#4289 AS co_comment_1#4306, co_orderdate#4290 AS co_orderdate_1#4307]
               +- Relation[rid#4274,cpfk_customer_orders#4275,cfpk_orders_customer#4276,cval_orders_o_orderstatus#4277,cval_orders_o_totalprice#4278,cval_orders_o_orderpriority#4279,cval_orders_o_clerk#4280,cval_orders_o_shippriority#4281,cval_orders_o_comment#4282,cval_orders_o_orderdate#4283,co_orderstatus#4284,co_totalprice#4285,co_orderpriority#4286,co_clerk#4287,co_shippriority#4288,co_comment#4289,co_orderdate#4290] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 52731ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/11 04:10:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:10:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4370L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 04:10:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:10:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:10:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4370L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#4372 AS rid_0#4405, cpfk_orders_lineitem#4373 AS cpfk_orders_lineitem_0#4406, cpfk_supplier_lineitem#4374 AS cpfk_supplier_lineitem_0#4407, cfpk_lineitem_supplier#4375 AS cfpk_lineitem_supplier_0#4408, cfpk_lineitem_partsupp#4376 AS cfpk_lineitem_partsupp_0#4409, cpfk_part_lineitem#4377 AS cpfk_part_lineitem_0#4410, cfpk_lineitem_part#4378 AS cfpk_lineitem_part_0#4411, cpfk_partsupp_lineitem#4379 AS cpfk_partsupp_lineitem_0#4412, cfpk_lineitem_orders#4380 AS cfpk_lineitem_orders_0#4413, cval_lineitem_l_quantity#4381 AS cval_lineitem_l_quantity_0#4414, cval_lineitem_l_extendedprice#4382 AS cval_lineitem_l_extendedprice_0#4415, cval_lineitem_l_discount#4383 AS cval_lineitem_l_discount_0#4416, cval_lineitem_l_tax#4384 AS cval_lineitem_l_tax_0#4417, cval_lineitem_l_returnflag#4385 AS cval_lineitem_l_returnflag_0#4418, cval_lineitem_l_linestatus#4386 AS cval_lineitem_l_linestatus_0#4419, cval_lineitem_l_commitdate#4387 AS cval_lineitem_l_commitdate_0#4420, cval_lineitem_l_receiptdate#4388 AS cval_lineitem_l_receiptdate_0#4421, cval_lineitem_l_shipinstruct#4389 AS cval_lineitem_l_shipinstruct_0#4422, cval_lineitem_l_shipmode#4390 AS cval_lineitem_l_shipmode_0#4423, cval_lineitem_l_comment#4391 AS cval_lineitem_l_comment_0#4424, cval_lineitem_l_shipdate#4392 AS cval_lineitem_l_shipdate_0#4425, cl_quantity#4393 AS cl_quantity_0#4426, cl_extendedprice#4394 AS cl_extendedprice_0#4427, cl_discount#4395 AS cl_discount_0#4428, ... 9 more fields]
            :     :     :  :  +- Relation[rid#4372,cpfk_orders_lineitem#4373,cpfk_supplier_lineitem#4374,cfpk_lineitem_supplier#4375,cfpk_lineitem_partsupp#4376,cpfk_part_lineitem#4377,cfpk_lineitem_part#4378,cpfk_partsupp_lineitem#4379,cfpk_lineitem_orders#4380,cval_lineitem_l_quantity#4381,cval_lineitem_l_extendedprice#4382,cval_lineitem_l_discount#4383,cval_lineitem_l_tax#4384,cval_lineitem_l_returnflag#4385,cval_lineitem_l_linestatus#4386,cval_lineitem_l_commitdate#4387,cval_lineitem_l_receiptdate#4388,cval_lineitem_l_shipinstruct#4389,cval_lineitem_l_shipmode#4390,cval_lineitem_l_comment#4391,cval_lineitem_l_shipdate#4392,cl_quantity#4393,cl_extendedprice#4394,cl_discount#4395,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#4438 AS rid_0#4471, cpfk_orders_lineitem#4439 AS cpfk_orders_lineitem_0#4472, cpfk_supplier_lineitem#4440 AS cpfk_supplier_lineitem_0#4473, cfpk_lineitem_supplier#4441 AS cfpk_lineitem_supplier_0#4474, cfpk_lineitem_partsupp#4442 AS cfpk_lineitem_partsupp_0#4475, cpfk_part_lineitem#4443 AS cpfk_part_lineitem_0#4476, cfpk_lineitem_part#4444 AS cfpk_lineitem_part_0#4477, cpfk_partsupp_lineitem#4445 AS cpfk_partsupp_lineitem_0#4478, cfpk_lineitem_orders#4446 AS cfpk_lineitem_orders_0#4479, cval_lineitem_l_quantity#4447 AS cval_lineitem_l_quantity_0#4480, cval_lineitem_l_extendedprice#4448 AS cval_lineitem_l_extendedprice_0#4481, cval_lineitem_l_discount#4449 AS cval_lineitem_l_discount_0#4482, cval_lineitem_l_tax#4450 AS cval_lineitem_l_tax_0#4483, cval_lineitem_l_returnflag#4451 AS cval_lineitem_l_returnflag_0#4484, cval_lineitem_l_linestatus#4452 AS cval_lineitem_l_linestatus_0#4485, cval_lineitem_l_commitdate#4453 AS cval_lineitem_l_commitdate_0#4486, cval_lineitem_l_receiptdate#4454 AS cval_lineitem_l_receiptdate_0#4487, cval_lineitem_l_shipinstruct#4455 AS cval_lineitem_l_shipinstruct_0#4488, cval_lineitem_l_shipmode#4456 AS cval_lineitem_l_shipmode_0#4489, cval_lineitem_l_comment#4457 AS cval_lineitem_l_comment_0#4490, cval_lineitem_l_shipdate#4458 AS cval_lineitem_l_shipdate_0#4491, cl_quantity#4459 AS cl_quantity_0#4492, cl_extendedprice#4460 AS cl_extendedprice_0#4493, cl_discount#4461 AS cl_discount_0#4494, ... 9 more fields]
            :     :     :        +- Relation[rid#4438,cpfk_orders_lineitem#4439,cpfk_supplier_lineitem#4440,cfpk_lineitem_supplier#4441,cfpk_lineitem_partsupp#4442,cpfk_part_lineitem#4443,cfpk_lineitem_part#4444,cpfk_partsupp_lineitem#4445,cfpk_lineitem_orders#4446,cval_lineitem_l_quantity#4447,cval_lineitem_l_extendedprice#4448,cval_lineitem_l_discount#4449,cval_lineitem_l_tax#4450,cval_lineitem_l_returnflag#4451,cval_lineitem_l_linestatus#4452,cval_lineitem_l_commitdate#4453,cval_lineitem_l_receiptdate#4454,cval_lineitem_l_shipinstruct#4455,cval_lineitem_l_shipmode#4456,cval_lineitem_l_comment#4457,cval_lineitem_l_shipdate#4458,cl_quantity#4459,cl_extendedprice#4460,cl_discount#4461,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#4504 AS rid_1#4521, cpfk_customer_orders#4505 AS cpfk_customer_orders_1#4522, cfpk_orders_customer#4506 AS cfpk_orders_customer_1#4523, cval_orders_o_orderstatus#4507 AS cval_orders_o_orderstatus_1#4524, cval_orders_o_totalprice#4508 AS cval_orders_o_totalprice_1#4525, cval_orders_o_orderpriority#4509 AS cval_orders_o_orderpriority_1#4526, cval_orders_o_clerk#4510 AS cval_orders_o_clerk_1#4527, cval_orders_o_shippriority#4511 AS cval_orders_o_shippriority_1#4528, cval_orders_o_comment#4512 AS cval_orders_o_comment_1#4529, cval_orders_o_orderdate#4513 AS cval_orders_o_orderdate_1#4530, co_orderstatus#4514 AS co_orderstatus_1#4531, co_totalprice#4515 AS co_totalprice_1#4532, co_orderpriority#4516 AS co_orderpriority_1#4533, co_clerk#4517 AS co_clerk_1#4534, co_shippriority#4518 AS co_shippriority_1#4535, co_comment#4519 AS co_comment_1#4536, co_orderdate#4520 AS co_orderdate_1#4537]
            :     :        +- Relation[rid#4504,cpfk_customer_orders#4505,cfpk_orders_customer#4506,cval_orders_o_orderstatus#4507,cval_orders_o_totalprice#4508,cval_orders_o_orderpriority#4509,cval_orders_o_clerk#4510,cval_orders_o_shippriority#4511,cval_orders_o_comment#4512,cval_orders_o_orderdate#4513,co_orderstatus#4514,co_totalprice#4515,co_orderpriority#4516,co_clerk#4517,co_shippriority#4518,co_comment#4519,co_orderdate#4520] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#4538 AS rid_2#4553, cpfk_nation_customer#4539 AS cpfk_nation_customer_2#4554, cfpk_customer_nation#4540 AS cfpk_customer_nation_2#4555, cval_customer_c_name#4541 AS cval_customer_c_name_2#4556, cval_customer_c_address#4542 AS cval_customer_c_address_2#4557, cval_customer_c_phone#4543 AS cval_customer_c_phone_2#4558, cval_customer_c_acctbal#4544 AS cval_customer_c_acctbal_2#4559, cval_customer_c_comment#4545 AS cval_customer_c_comment_2#4560, cval_customer_c_mktsegment#4546 AS cval_customer_c_mktsegment_2#4561, cc_name#4547 AS cc_name_2#4562, cc_address#4548 AS cc_address_2#4563, cc_phone#4549 AS cc_phone_2#4564, cc_acctbal#4550 AS cc_acctbal_2#4565, cc_comment#4551 AS cc_comment_2#4566, cc_mktsegment#4552 AS cc_mktsegment_2#4567]
            :        +- Relation[rid#4538,cpfk_nation_customer#4539,cfpk_customer_nation#4540,cval_customer_c_name#4541,cval_customer_c_address#4542,cval_customer_c_phone#4543,cval_customer_c_acctbal#4544,cval_customer_c_comment#4545,cval_customer_c_mktsegment#4546,cc_name#4547,cc_address#4548,cc_phone#4549,cc_acctbal#4550,cc_comment#4551,cc_mktsegment#4552] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#4568 AS rid_3#4575, cpfk_region_nation#4569 AS cpfk_region_nation_3#4576, cfpk_nation_region#4570 AS cfpk_nation_region_3#4577, cval_nation_n_name#4571 AS cval_nation_n_name_3#4578, cval_nation_n_comment#4572 AS cval_nation_n_comment_3#4579, cn_name#4573 AS cn_name_3#4580, cn_comment#4574 AS cn_comment_3#4581]
               +- Relation[rid#4568,cpfk_region_nation#4569,cfpk_nation_region#4570,cval_nation_n_name#4571,cval_nation_n_comment#4572,cn_name#4573,cn_comment#4574] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 59770ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/11 04:11:50 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:11:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4661L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 04:11:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:11:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:11:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:11:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4661L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#4663 AS rid_0#4676, cpfk_nation_supplier#4664 AS cpfk_nation_supplier_0#4677, cfpk_supplier_nation#4665 AS cfpk_supplier_nation_0#4678, cval_supplier_s_name#4666 AS cval_supplier_s_name_0#4679, cval_supplier_s_address#4667 AS cval_supplier_s_address_0#4680, cval_supplier_s_phone#4668 AS cval_supplier_s_phone_0#4681, cval_supplier_s_acctbal#4669 AS cval_supplier_s_acctbal_0#4682, cval_supplier_s_comment#4670 AS cval_supplier_s_comment_0#4683, cs_name#4671 AS cs_name_0#4684, cs_address#4672 AS cs_address_0#4685, cs_phone#4673 AS cs_phone_0#4686, cs_acctbal#4674 AS cs_acctbal_0#4687, cs_comment#4675 AS cs_comment_0#4688]
         :  :  +- Relation[rid#4663,cpfk_nation_supplier#4664,cfpk_supplier_nation#4665,cval_supplier_s_name#4666,cval_supplier_s_address#4667,cval_supplier_s_phone#4668,cval_supplier_s_acctbal#4669,cval_supplier_s_comment#4670,cs_name#4671,cs_address#4672,cs_phone#4673,cs_acctbal#4674,cs_comment#4675] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#4755 AS rid_0#4768, cpfk_nation_supplier#4756 AS cpfk_nation_supplier_0#4769, cfpk_supplier_nation#4757 AS cfpk_supplier_nation_0#4770, cval_supplier_s_name#4758 AS cval_supplier_s_name_0#4771, cval_supplier_s_address#4759 AS cval_supplier_s_address_0#4772, cval_supplier_s_phone#4760 AS cval_supplier_s_phone_0#4773, cval_supplier_s_acctbal#4761 AS cval_supplier_s_acctbal_0#4774, cval_supplier_s_comment#4762 AS cval_supplier_s_comment_0#4775, cs_name#4763 AS cs_name_0#4776, cs_address#4764 AS cs_address_0#4777, cs_phone#4765 AS cs_phone_0#4778, cs_acctbal#4766 AS cs_acctbal_0#4779, cs_comment#4767 AS cs_comment_0#4780]
         :     :  +- Relation[rid#4755,cpfk_nation_supplier#4756,cfpk_supplier_nation#4757,cval_supplier_s_name#4758,cval_supplier_s_address#4759,cval_supplier_s_phone#4760,cval_supplier_s_acctbal#4761,cval_supplier_s_comment#4762,cs_name#4763,cs_address#4764,cs_phone#4765,cs_acctbal#4766,cs_comment#4767] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#4781 AS rid_1#4814, cpfk_orders_lineitem#4782 AS cpfk_orders_lineitem_1#4815, cpfk_supplier_lineitem#4783 AS cpfk_supplier_lineitem_1#4816, cfpk_lineitem_supplier#4784 AS cfpk_lineitem_supplier_1#4817, cfpk_lineitem_partsupp#4785 AS cfpk_lineitem_partsupp_1#4818, cpfk_part_lineitem#4786 AS cpfk_part_lineitem_1#4819, cfpk_lineitem_part#4787 AS cfpk_lineitem_part_1#4820, cpfk_partsupp_lineitem#4788 AS cpfk_partsupp_lineitem_1#4821, cfpk_lineitem_orders#4789 AS cfpk_lineitem_orders_1#4822, cval_lineitem_l_quantity#4790 AS cval_lineitem_l_quantity_1#4823, cval_lineitem_l_extendedprice#4791 AS cval_lineitem_l_extendedprice_1#4824, cval_lineitem_l_discount#4792 AS cval_lineitem_l_discount_1#4825, cval_lineitem_l_tax#4793 AS cval_lineitem_l_tax_1#4826, cval_lineitem_l_returnflag#4794 AS cval_lineitem_l_returnflag_1#4827, cval_lineitem_l_linestatus#4795 AS cval_lineitem_l_linestatus_1#4828, cval_lineitem_l_commitdate#4796 AS cval_lineitem_l_commitdate_1#4829, cval_lineitem_l_receiptdate#4797 AS cval_lineitem_l_receiptdate_1#4830, cval_lineitem_l_shipinstruct#4798 AS cval_lineitem_l_shipinstruct_1#4831, cval_lineitem_l_shipmode#4799 AS cval_lineitem_l_shipmode_1#4832, cval_lineitem_l_comment#4800 AS cval_lineitem_l_comment_1#4833, cval_lineitem_l_shipdate#4801 AS cval_lineitem_l_shipdate_1#4834, cl_quantity#4802 AS cl_quantity_1#4835, cl_extendedprice#4803 AS cl_extendedprice_1#4836, cl_discount#4804 AS cl_discount_1#4837, ... 9 more fields]
         :        +- Relation[rid#4781,cpfk_orders_lineitem#4782,cpfk_supplier_lineitem#4783,cfpk_lineitem_supplier#4784,cfpk_lineitem_partsupp#4785,cpfk_part_lineitem#4786,cfpk_lineitem_part#4787,cpfk_partsupp_lineitem#4788,cfpk_lineitem_orders#4789,cval_lineitem_l_quantity#4790,cval_lineitem_l_extendedprice#4791,cval_lineitem_l_discount#4792,cval_lineitem_l_tax#4793,cval_lineitem_l_returnflag#4794,cval_lineitem_l_linestatus#4795,cval_lineitem_l_commitdate#4796,cval_lineitem_l_receiptdate#4797,cval_lineitem_l_shipinstruct#4798,cval_lineitem_l_shipmode#4799,cval_lineitem_l_comment#4800,cval_lineitem_l_shipdate#4801,cl_quantity#4802,cl_extendedprice#4803,cl_discount#4804,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4689 AS rid_1#4722, cpfk_orders_lineitem#4690 AS cpfk_orders_lineitem_1#4723, cpfk_supplier_lineitem#4691 AS cpfk_supplier_lineitem_1#4724, cfpk_lineitem_supplier#4692 AS cfpk_lineitem_supplier_1#4725, cfpk_lineitem_partsupp#4693 AS cfpk_lineitem_partsupp_1#4726, cpfk_part_lineitem#4694 AS cpfk_part_lineitem_1#4727, cfpk_lineitem_part#4695 AS cfpk_lineitem_part_1#4728, cpfk_partsupp_lineitem#4696 AS cpfk_partsupp_lineitem_1#4729, cfpk_lineitem_orders#4697 AS cfpk_lineitem_orders_1#4730, cval_lineitem_l_quantity#4698 AS cval_lineitem_l_quantity_1#4731, cval_lineitem_l_extendedprice#4699 AS cval_lineitem_l_extendedprice_1#4732, cval_lineitem_l_discount#4700 AS cval_lineitem_l_discount_1#4733, cval_lineitem_l_tax#4701 AS cval_lineitem_l_tax_1#4734, cval_lineitem_l_returnflag#4702 AS cval_lineitem_l_returnflag_1#4735, cval_lineitem_l_linestatus#4703 AS cval_lineitem_l_linestatus_1#4736, cval_lineitem_l_commitdate#4704 AS cval_lineitem_l_commitdate_1#4737, cval_lineitem_l_receiptdate#4705 AS cval_lineitem_l_receiptdate_1#4738, cval_lineitem_l_shipinstruct#4706 AS cval_lineitem_l_shipinstruct_1#4739, cval_lineitem_l_shipmode#4707 AS cval_lineitem_l_shipmode_1#4740, cval_lineitem_l_comment#4708 AS cval_lineitem_l_comment_1#4741, cval_lineitem_l_shipdate#4709 AS cval_lineitem_l_shipdate_1#4742, cl_quantity#4710 AS cl_quantity_1#4743, cl_extendedprice#4711 AS cl_extendedprice_1#4744, cl_discount#4712 AS cl_discount_1#4745, ... 9 more fields]
            +- Relation[rid#4689,cpfk_orders_lineitem#4690,cpfk_supplier_lineitem#4691,cfpk_lineitem_supplier#4692,cfpk_lineitem_partsupp#4693,cpfk_part_lineitem#4694,cfpk_lineitem_part#4695,cpfk_partsupp_lineitem#4696,cfpk_lineitem_orders#4697,cval_lineitem_l_quantity#4698,cval_lineitem_l_extendedprice#4699,cval_lineitem_l_discount#4700,cval_lineitem_l_tax#4701,cval_lineitem_l_returnflag#4702,cval_lineitem_l_linestatus#4703,cval_lineitem_l_commitdate#4704,cval_lineitem_l_receiptdate#4705,cval_lineitem_l_shipinstruct#4706,cval_lineitem_l_shipmode#4707,cval_lineitem_l_comment#4708,cval_lineitem_l_shipdate#4709,cl_quantity#4710,cl_extendedprice#4711,cl_discount#4712,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 76799ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/11 04:13:07 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:13:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4897L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 04:13:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4897L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#4899 AS rid_0#4916, cpfk_customer_orders#4900 AS cpfk_customer_orders_0#4917, cfpk_orders_customer#4901 AS cfpk_orders_customer_0#4918, cval_orders_o_orderstatus#4902 AS cval_orders_o_orderstatus_0#4919, cval_orders_o_totalprice#4903 AS cval_orders_o_totalprice_0#4920, cval_orders_o_orderpriority#4904 AS cval_orders_o_orderpriority_0#4921, cval_orders_o_clerk#4905 AS cval_orders_o_clerk_0#4922, cval_orders_o_shippriority#4906 AS cval_orders_o_shippriority_0#4923, cval_orders_o_comment#4907 AS cval_orders_o_comment_0#4924, cval_orders_o_orderdate#4908 AS cval_orders_o_orderdate_0#4925, co_orderstatus#4909 AS co_orderstatus_0#4926, co_totalprice#4910 AS co_totalprice_0#4927, co_orderpriority#4911 AS co_orderpriority_0#4928, co_clerk#4912 AS co_clerk_0#4929, co_shippriority#4913 AS co_shippriority_0#4930, co_comment#4914 AS co_comment_0#4931, co_orderdate#4915 AS co_orderdate_0#4932]
            :  +- Relation[rid#4899,cpfk_customer_orders#4900,cfpk_orders_customer#4901,cval_orders_o_orderstatus#4902,cval_orders_o_totalprice#4903,cval_orders_o_orderpriority#4904,cval_orders_o_clerk#4905,cval_orders_o_shippriority#4906,cval_orders_o_comment#4907,cval_orders_o_orderdate#4908,co_orderstatus#4909,co_totalprice#4910,co_orderpriority#4911,co_clerk#4912,co_shippriority#4913,co_comment#4914,co_orderdate#4915] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#4933 AS rid_1#4948, cpfk_nation_customer#4934 AS cpfk_nation_customer_1#4949, cfpk_customer_nation#4935 AS cfpk_customer_nation_1#4950, cval_customer_c_name#4936 AS cval_customer_c_name_1#4951, cval_customer_c_address#4937 AS cval_customer_c_address_1#4952, cval_customer_c_phone#4938 AS cval_customer_c_phone_1#4953, cval_customer_c_acctbal#4939 AS cval_customer_c_acctbal_1#4954, cval_customer_c_comment#4940 AS cval_customer_c_comment_1#4955, cval_customer_c_mktsegment#4941 AS cval_customer_c_mktsegment_1#4956, cc_name#4942 AS cc_name_1#4957, cc_address#4943 AS cc_address_1#4958, cc_phone#4944 AS cc_phone_1#4959, cc_acctbal#4945 AS cc_acctbal_1#4960, cc_comment#4946 AS cc_comment_1#4961, cc_mktsegment#4947 AS cc_mktsegment_1#4962]
               +- Relation[rid#4933,cpfk_nation_customer#4934,cfpk_customer_nation#4935,cval_customer_c_name#4936,cval_customer_c_address#4937,cval_customer_c_phone#4938,cval_customer_c_acctbal#4939,cval_customer_c_comment#4940,cval_customer_c_mktsegment#4941,cc_name#4942,cc_address#4943,cc_phone#4944,cc_acctbal#4945,cc_comment#4946,cc_mktsegment#4947] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13024ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/11 04:13:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:13:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5000L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 04:13:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#5000L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#5002 AS rid_0#5035, cpfk_orders_lineitem#5003 AS cpfk_orders_lineitem_0#5036, cpfk_supplier_lineitem#5004 AS cpfk_supplier_lineitem_0#5037, cfpk_lineitem_supplier#5005 AS cfpk_lineitem_supplier_0#5038, cfpk_lineitem_partsupp#5006 AS cfpk_lineitem_partsupp_0#5039, cpfk_part_lineitem#5007 AS cpfk_part_lineitem_0#5040, cfpk_lineitem_part#5008 AS cfpk_lineitem_part_0#5041, cpfk_partsupp_lineitem#5009 AS cpfk_partsupp_lineitem_0#5042, cfpk_lineitem_orders#5010 AS cfpk_lineitem_orders_0#5043, cval_lineitem_l_quantity#5011 AS cval_lineitem_l_quantity_0#5044, cval_lineitem_l_extendedprice#5012 AS cval_lineitem_l_extendedprice_0#5045, cval_lineitem_l_discount#5013 AS cval_lineitem_l_discount_0#5046, cval_lineitem_l_tax#5014 AS cval_lineitem_l_tax_0#5047, cval_lineitem_l_returnflag#5015 AS cval_lineitem_l_returnflag_0#5048, cval_lineitem_l_linestatus#5016 AS cval_lineitem_l_linestatus_0#5049, cval_lineitem_l_commitdate#5017 AS cval_lineitem_l_commitdate_0#5050, cval_lineitem_l_receiptdate#5018 AS cval_lineitem_l_receiptdate_0#5051, cval_lineitem_l_shipinstruct#5019 AS cval_lineitem_l_shipinstruct_0#5052, cval_lineitem_l_shipmode#5020 AS cval_lineitem_l_shipmode_0#5053, cval_lineitem_l_comment#5021 AS cval_lineitem_l_comment_0#5054, cval_lineitem_l_shipdate#5022 AS cval_lineitem_l_shipdate_0#5055, cl_quantity#5023 AS cl_quantity_0#5056, cl_extendedprice#5024 AS cl_extendedprice_0#5057, cl_discount#5025 AS cl_discount_0#5058, ... 9 more fields]
         +- Relation[rid#5002,cpfk_orders_lineitem#5003,cpfk_supplier_lineitem#5004,cfpk_lineitem_supplier#5005,cfpk_lineitem_partsupp#5006,cpfk_part_lineitem#5007,cfpk_lineitem_part#5008,cpfk_partsupp_lineitem#5009,cfpk_lineitem_orders#5010,cval_lineitem_l_quantity#5011,cval_lineitem_l_extendedprice#5012,cval_lineitem_l_discount#5013,cval_lineitem_l_tax#5014,cval_lineitem_l_returnflag#5015,cval_lineitem_l_linestatus#5016,cval_lineitem_l_commitdate#5017,cval_lineitem_l_receiptdate#5018,cval_lineitem_l_shipinstruct#5019,cval_lineitem_l_shipmode#5020,cval_lineitem_l_comment#5021,cval_lineitem_l_shipdate#5022,cl_quantity#5023,cl_extendedprice#5024,cl_discount#5025,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2957ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/11 04:13:23 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:13:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5106L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 04:13:23 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:13:23 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:13:23 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:13:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:13:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:13:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:13:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:13:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:13:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:13:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:13:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:13:23 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:13:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:13:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5106L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#5108 AS rid_0#5125, cval_part_p_name#5109 AS cval_part_p_name_0#5126, cval_part_p_mfgr#5110 AS cval_part_p_mfgr_0#5127, cval_part_p_type#5111 AS cval_part_p_type_0#5128, cval_part_p_size#5112 AS cval_part_p_size_0#5129, cval_part_p_container#5113 AS cval_part_p_container_0#5130, cval_part_p_retailprice#5114 AS cval_part_p_retailprice_0#5131, cval_part_p_comment#5115 AS cval_part_p_comment_0#5132, cval_part_p_brand#5116 AS cval_part_p_brand_0#5133, cp_name#5117 AS cp_name_0#5134, cp_mfgr#5118 AS cp_mfgr_0#5135, cp_type#5119 AS cp_type_0#5136, cp_size#5120 AS cp_size_0#5137, cp_container#5121 AS cp_container_0#5138, cp_retailprice#5122 AS cp_retailprice_0#5139, cp_comment#5123 AS cp_comment_0#5140, cp_brand#5124 AS cp_brand_0#5141]
            :  :  :  :  +- Relation[rid#5108,cval_part_p_name#5109,cval_part_p_mfgr#5110,cval_part_p_type#5111,cval_part_p_size#5112,cval_part_p_container#5113,cval_part_p_retailprice#5114,cval_part_p_comment#5115,cval_part_p_brand#5116,cp_name#5117,cp_mfgr#5118,cp_type#5119,cp_size#5120,cp_container#5121,cp_retailprice#5122,cp_comment#5123,cp_brand#5124] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#5142 AS rid_0#5159, cval_part_p_name#5143 AS cval_part_p_name_0#5160, cval_part_p_mfgr#5144 AS cval_part_p_mfgr_0#5161, cval_part_p_type#5145 AS cval_part_p_type_0#5162, cval_part_p_size#5146 AS cval_part_p_size_0#5163, cval_part_p_container#5147 AS cval_part_p_container_0#5164, cval_part_p_retailprice#5148 AS cval_part_p_retailprice_0#5165, cval_part_p_comment#5149 AS cval_part_p_comment_0#5166, cval_part_p_brand#5150 AS cval_part_p_brand_0#5167, cp_name#5151 AS cp_name_0#5168, cp_mfgr#5152 AS cp_mfgr_0#5169, cp_type#5153 AS cp_type_0#5170, cp_size#5154 AS cp_size_0#5171, cp_container#5155 AS cp_container_0#5172, cp_retailprice#5156 AS cp_retailprice_0#5173, cp_comment#5157 AS cp_comment_0#5174, cp_brand#5158 AS cp_brand_0#5175]
            :  :  :        +- Relation[rid#5142,cval_part_p_name#5143,cval_part_p_mfgr#5144,cval_part_p_type#5145,cval_part_p_size#5146,cval_part_p_container#5147,cval_part_p_retailprice#5148,cval_part_p_comment#5149,cval_part_p_brand#5150,cp_name#5151,cp_mfgr#5152,cp_type#5153,cp_size#5154,cp_container#5155,cp_retailprice#5156,cp_comment#5157,cp_brand#5158] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :     :- Project [rid#5198 AS rid_0#5215, cval_part_p_name#5199 AS cval_part_p_name_0#5216, cval_part_p_mfgr#5200 AS cval_part_p_mfgr_0#5217, cval_part_p_type#5201 AS cval_part_p_type_0#5218, cval_part_p_size#5202 AS cval_part_p_size_0#5219, cval_part_p_container#5203 AS cval_part_p_container_0#5220, cval_part_p_retailprice#5204 AS cval_part_p_retailprice_0#5221, cval_part_p_comment#5205 AS cval_part_p_comment_0#5222, cval_part_p_brand#5206 AS cval_part_p_brand_0#5223, cp_name#5207 AS cp_name_0#5224, cp_mfgr#5208 AS cp_mfgr_0#5225, cp_type#5209 AS cp_type_0#5226, cp_size#5210 AS cp_size_0#5227, cp_container#5211 AS cp_container_0#5228, cp_retailprice#5212 AS cp_retailprice_0#5229, cp_comment#5213 AS cp_comment_0#5230, cp_brand#5214 AS cp_brand_0#5231]
            :  :     :  +- Relation[rid#5198,cval_part_p_name#5199,cval_part_p_mfgr#5200,cval_part_p_type#5201,cval_part_p_size#5202,cval_part_p_container#5203,cval_part_p_retailprice#5204,cval_part_p_comment#5205,cval_part_p_brand#5206,cp_name#5207,cp_mfgr#5208,cp_type#5209,cp_size#5210,cp_container#5211,cp_retailprice#5212,cp_comment#5213,cp_brand#5214] JDBCRelation(tpart) [numPartitions=1]
            :  :     +- Project [rid#5232 AS rid_1#5243, cpfk_part_partsupp#5233 AS cpfk_part_partsupp_1#5244, cfpk_partsupp_part#5234 AS cfpk_partsupp_part_1#5245, cpfk_supplier_partsupp#5235 AS cpfk_supplier_partsupp_1#5246, cfpk_partsupp_supplier#5236 AS cfpk_partsupp_supplier_1#5247, cval_partsupp_ps_availqty#5237 AS cval_partsupp_ps_availqty_1#5248, cval_partsupp_ps_supplycost#5238 AS cval_partsupp_ps_supplycost_1#5249, cval_partsupp_ps_comment#5239 AS cval_partsupp_ps_comment_1#5250, cps_availqty#5240 AS cps_availqty_1#5251, cps_supplycost#5241 AS cps_supplycost_1#5252, cps_comment#5242 AS cps_comment_1#5253]
            :  :        +- Relation[rid#5232,cpfk_part_partsupp#5233,cfpk_partsupp_part#5234,cpfk_supplier_partsupp#5235,cfpk_partsupp_supplier#5236,cval_partsupp_ps_availqty#5237,cval_partsupp_ps_supplycost#5238,cval_partsupp_ps_comment#5239,cps_availqty#5240,cps_supplycost#5241,cps_comment#5242] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#5176 AS rid_1#5187, cpfk_part_partsupp#5177 AS cpfk_part_partsupp_1#5188, cfpk_partsupp_part#5178 AS cfpk_partsupp_part_1#5189, cpfk_supplier_partsupp#5179 AS cpfk_supplier_partsupp_1#5190, cfpk_partsupp_supplier#5180 AS cfpk_partsupp_supplier_1#5191, cval_partsupp_ps_availqty#5181 AS cval_partsupp_ps_availqty_1#5192, cval_partsupp_ps_supplycost#5182 AS cval_partsupp_ps_supplycost_1#5193, cval_partsupp_ps_comment#5183 AS cval_partsupp_ps_comment_1#5194, cps_availqty#5184 AS cps_availqty_1#5195, cps_supplycost#5185 AS cps_supplycost_1#5196, cps_comment#5186 AS cps_comment_1#5197]
            :     +- Relation[rid#5176,cpfk_part_partsupp#5177,cfpk_partsupp_part#5178,cpfk_supplier_partsupp#5179,cfpk_partsupp_supplier#5180,cval_partsupp_ps_availqty#5181,cval_partsupp_ps_supplycost#5182,cval_partsupp_ps_comment#5183,cps_availqty#5184,cps_supplycost#5185,cps_comment#5186] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#5254 AS rid_2#5261, cpfk_region_nation#5255 AS cpfk_region_nation_2#5262, cfpk_nation_region#5256 AS cfpk_nation_region_2#5263, cval_nation_n_name#5257 AS cval_nation_n_name_2#5264, cval_nation_n_comment#5258 AS cval_nation_n_comment_2#5265, cn_name#5259 AS cn_name_2#5266, cn_comment#5260 AS cn_comment_2#5267]
               :  :  :  +- Relation[rid#5254,cpfk_region_nation#5255,cfpk_nation_region#5256,cval_nation_n_name#5257,cval_nation_n_comment#5258,cn_name#5259,cn_comment#5260] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#5268 AS rid_2#5275, cpfk_region_nation#5269 AS cpfk_region_nation_2#5276, cfpk_nation_region#5270 AS cfpk_nation_region_2#5277, cval_nation_n_name#5271 AS cval_nation_n_name_2#5278, cval_nation_n_comment#5272 AS cval_nation_n_comment_2#5279, cn_name#5273 AS cn_name_2#5280, cn_comment#5274 AS cn_comment_2#5281]
               :  :        +- Relation[rid#5268,cpfk_region_nation#5269,cfpk_nation_region#5270,cval_nation_n_name#5271,cval_nation_n_comment#5272,cn_name#5273,cn_comment#5274] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :     :- Project [rid#5308 AS rid_2#5315, cpfk_region_nation#5309 AS cpfk_region_nation_2#5316, cfpk_nation_region#5310 AS cfpk_nation_region_2#5317, cval_nation_n_name#5311 AS cval_nation_n_name_2#5318, cval_nation_n_comment#5312 AS cval_nation_n_comment_2#5319, cn_name#5313 AS cn_name_2#5320, cn_comment#5314 AS cn_comment_2#5321]
               :     :  +- Relation[rid#5308,cpfk_region_nation#5309,cfpk_nation_region#5310,cval_nation_n_name#5311,cval_nation_n_comment#5312,cn_name#5313,cn_comment#5314] JDBCRelation(tnation) [numPartitions=1]
               :     +- Project [rid#5322 AS rid_3#5335, cpfk_nation_supplier#5323 AS cpfk_nation_supplier_3#5336, cfpk_supplier_nation#5324 AS cfpk_supplier_nation_3#5337, cval_supplier_s_name#5325 AS cval_supplier_s_name_3#5338, cval_supplier_s_address#5326 AS cval_supplier_s_address_3#5339, cval_supplier_s_phone#5327 AS cval_supplier_s_phone_3#5340, cval_supplier_s_acctbal#5328 AS cval_supplier_s_acctbal_3#5341, cval_supplier_s_comment#5329 AS cval_supplier_s_comment_3#5342, cs_name#5330 AS cs_name_3#5343, cs_address#5331 AS cs_address_3#5344, cs_phone#5332 AS cs_phone_3#5345, cs_acctbal#5333 AS cs_acctbal_3#5346, cs_comment#5334 AS cs_comment_3#5347]
               :        +- Relation[rid#5322,cpfk_nation_supplier#5323,cfpk_supplier_nation#5324,cval_supplier_s_name#5325,cval_supplier_s_address#5326,cval_supplier_s_phone#5327,cval_supplier_s_acctbal#5328,cval_supplier_s_comment#5329,cs_name#5330,cs_address#5331,cs_phone#5332,cs_acctbal#5333,cs_comment#5334] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#5282 AS rid_3#5295, cpfk_nation_supplier#5283 AS cpfk_nation_supplier_3#5296, cfpk_supplier_nation#5284 AS cfpk_supplier_nation_3#5297, cval_supplier_s_name#5285 AS cval_supplier_s_name_3#5298, cval_supplier_s_address#5286 AS cval_supplier_s_address_3#5299, cval_supplier_s_phone#5287 AS cval_supplier_s_phone_3#5300, cval_supplier_s_acctbal#5288 AS cval_supplier_s_acctbal_3#5301, cval_supplier_s_comment#5289 AS cval_supplier_s_comment_3#5302, cs_name#5290 AS cs_name_3#5303, cs_address#5291 AS cs_address_3#5304, cs_phone#5292 AS cs_phone_3#5305, cs_acctbal#5293 AS cs_acctbal_3#5306, cs_comment#5294 AS cs_comment_3#5307]
                  +- Relation[rid#5282,cpfk_nation_supplier#5283,cfpk_supplier_nation#5284,cval_supplier_s_name#5285,cval_supplier_s_address#5286,cval_supplier_s_phone#5287,cval_supplier_s_acctbal#5288,cval_supplier_s_comment#5289,cs_name#5290,cs_address#5291,cs_phone#5292,cs_acctbal#5293,cs_comment#5294] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 11424ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/11 04:13:35 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:13:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5400L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 04:13:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5400L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#5402 AS rid_0#5435, cpfk_orders_lineitem#5403 AS cpfk_orders_lineitem_0#5436, cpfk_supplier_lineitem#5404 AS cpfk_supplier_lineitem_0#5437, cfpk_lineitem_supplier#5405 AS cfpk_lineitem_supplier_0#5438, cfpk_lineitem_partsupp#5406 AS cfpk_lineitem_partsupp_0#5439, cpfk_part_lineitem#5407 AS cpfk_part_lineitem_0#5440, cfpk_lineitem_part#5408 AS cfpk_lineitem_part_0#5441, cpfk_partsupp_lineitem#5409 AS cpfk_partsupp_lineitem_0#5442, cfpk_lineitem_orders#5410 AS cfpk_lineitem_orders_0#5443, cval_lineitem_l_quantity#5411 AS cval_lineitem_l_quantity_0#5444, cval_lineitem_l_extendedprice#5412 AS cval_lineitem_l_extendedprice_0#5445, cval_lineitem_l_discount#5413 AS cval_lineitem_l_discount_0#5446, cval_lineitem_l_tax#5414 AS cval_lineitem_l_tax_0#5447, cval_lineitem_l_returnflag#5415 AS cval_lineitem_l_returnflag_0#5448, cval_lineitem_l_linestatus#5416 AS cval_lineitem_l_linestatus_0#5449, cval_lineitem_l_commitdate#5417 AS cval_lineitem_l_commitdate_0#5450, cval_lineitem_l_receiptdate#5418 AS cval_lineitem_l_receiptdate_0#5451, cval_lineitem_l_shipinstruct#5419 AS cval_lineitem_l_shipinstruct_0#5452, cval_lineitem_l_shipmode#5420 AS cval_lineitem_l_shipmode_0#5453, cval_lineitem_l_comment#5421 AS cval_lineitem_l_comment_0#5454, cval_lineitem_l_shipdate#5422 AS cval_lineitem_l_shipdate_0#5455, cl_quantity#5423 AS cl_quantity_0#5456, cl_extendedprice#5424 AS cl_extendedprice_0#5457, cl_discount#5425 AS cl_discount_0#5458, ... 9 more fields]
            :  :  +- Relation[rid#5402,cpfk_orders_lineitem#5403,cpfk_supplier_lineitem#5404,cfpk_lineitem_supplier#5405,cfpk_lineitem_partsupp#5406,cpfk_part_lineitem#5407,cfpk_lineitem_part#5408,cpfk_partsupp_lineitem#5409,cfpk_lineitem_orders#5410,cval_lineitem_l_quantity#5411,cval_lineitem_l_extendedprice#5412,cval_lineitem_l_discount#5413,cval_lineitem_l_tax#5414,cval_lineitem_l_returnflag#5415,cval_lineitem_l_linestatus#5416,cval_lineitem_l_commitdate#5417,cval_lineitem_l_receiptdate#5418,cval_lineitem_l_shipinstruct#5419,cval_lineitem_l_shipmode#5420,cval_lineitem_l_comment#5421,cval_lineitem_l_shipdate#5422,cl_quantity#5423,cl_extendedprice#5424,cl_discount#5425,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#5468 AS rid_0#5501, cpfk_orders_lineitem#5469 AS cpfk_orders_lineitem_0#5502, cpfk_supplier_lineitem#5470 AS cpfk_supplier_lineitem_0#5503, cfpk_lineitem_supplier#5471 AS cfpk_lineitem_supplier_0#5504, cfpk_lineitem_partsupp#5472 AS cfpk_lineitem_partsupp_0#5505, cpfk_part_lineitem#5473 AS cpfk_part_lineitem_0#5506, cfpk_lineitem_part#5474 AS cfpk_lineitem_part_0#5507, cpfk_partsupp_lineitem#5475 AS cpfk_partsupp_lineitem_0#5508, cfpk_lineitem_orders#5476 AS cfpk_lineitem_orders_0#5509, cval_lineitem_l_quantity#5477 AS cval_lineitem_l_quantity_0#5510, cval_lineitem_l_extendedprice#5478 AS cval_lineitem_l_extendedprice_0#5511, cval_lineitem_l_discount#5479 AS cval_lineitem_l_discount_0#5512, cval_lineitem_l_tax#5480 AS cval_lineitem_l_tax_0#5513, cval_lineitem_l_returnflag#5481 AS cval_lineitem_l_returnflag_0#5514, cval_lineitem_l_linestatus#5482 AS cval_lineitem_l_linestatus_0#5515, cval_lineitem_l_commitdate#5483 AS cval_lineitem_l_commitdate_0#5516, cval_lineitem_l_receiptdate#5484 AS cval_lineitem_l_receiptdate_0#5517, cval_lineitem_l_shipinstruct#5485 AS cval_lineitem_l_shipinstruct_0#5518, cval_lineitem_l_shipmode#5486 AS cval_lineitem_l_shipmode_0#5519, cval_lineitem_l_comment#5487 AS cval_lineitem_l_comment_0#5520, cval_lineitem_l_shipdate#5488 AS cval_lineitem_l_shipdate_0#5521, cl_quantity#5489 AS cl_quantity_0#5522, cl_extendedprice#5490 AS cl_extendedprice_0#5523, cl_discount#5491 AS cl_discount_0#5524, ... 9 more fields]
            :        +- Relation[rid#5468,cpfk_orders_lineitem#5469,cpfk_supplier_lineitem#5470,cfpk_lineitem_supplier#5471,cfpk_lineitem_partsupp#5472,cpfk_part_lineitem#5473,cfpk_lineitem_part#5474,cpfk_partsupp_lineitem#5475,cfpk_lineitem_orders#5476,cval_lineitem_l_quantity#5477,cval_lineitem_l_extendedprice#5478,cval_lineitem_l_discount#5479,cval_lineitem_l_tax#5480,cval_lineitem_l_returnflag#5481,cval_lineitem_l_linestatus#5482,cval_lineitem_l_commitdate#5483,cval_lineitem_l_receiptdate#5484,cval_lineitem_l_shipinstruct#5485,cval_lineitem_l_shipmode#5486,cval_lineitem_l_comment#5487,cval_lineitem_l_shipdate#5488,cl_quantity#5489,cl_extendedprice#5490,cl_discount#5491,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#5534 AS rid_1#5551, cpfk_customer_orders#5535 AS cpfk_customer_orders_1#5552, cfpk_orders_customer#5536 AS cfpk_orders_customer_1#5553, cval_orders_o_orderstatus#5537 AS cval_orders_o_orderstatus_1#5554, cval_orders_o_totalprice#5538 AS cval_orders_o_totalprice_1#5555, cval_orders_o_orderpriority#5539 AS cval_orders_o_orderpriority_1#5556, cval_orders_o_clerk#5540 AS cval_orders_o_clerk_1#5557, cval_orders_o_shippriority#5541 AS cval_orders_o_shippriority_1#5558, cval_orders_o_comment#5542 AS cval_orders_o_comment_1#5559, cval_orders_o_orderdate#5543 AS cval_orders_o_orderdate_1#5560, co_orderstatus#5544 AS co_orderstatus_1#5561, co_totalprice#5545 AS co_totalprice_1#5562, co_orderpriority#5546 AS co_orderpriority_1#5563, co_clerk#5547 AS co_clerk_1#5564, co_shippriority#5548 AS co_shippriority_1#5565, co_comment#5549 AS co_comment_1#5566, co_orderdate#5550 AS co_orderdate_1#5567]
               +- Relation[rid#5534,cpfk_customer_orders#5535,cfpk_orders_customer#5536,cval_orders_o_orderstatus#5537,cval_orders_o_totalprice#5538,cval_orders_o_orderpriority#5539,cval_orders_o_clerk#5540,cval_orders_o_shippriority#5541,cval_orders_o_comment#5542,cval_orders_o_orderdate#5543,co_orderstatus#5544,co_totalprice#5545,co_orderpriority#5546,co_clerk#5547,co_shippriority#5548,co_comment#5549,co_orderdate#5550] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 21504ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/11 04:13:56 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:13:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5622L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 04:13:56 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:13:56 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:13:56 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:13:56 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:13:56 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:13:56 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:13:56 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:13:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5622L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#5624 AS rid_0#5641, cval_part_p_name#5625 AS cval_part_p_name_0#5642, cval_part_p_mfgr#5626 AS cval_part_p_mfgr_0#5643, cval_part_p_type#5627 AS cval_part_p_type_0#5644, cval_part_p_size#5628 AS cval_part_p_size_0#5645, cval_part_p_container#5629 AS cval_part_p_container_0#5646, cval_part_p_retailprice#5630 AS cval_part_p_retailprice_0#5647, cval_part_p_comment#5631 AS cval_part_p_comment_0#5648, cval_part_p_brand#5632 AS cval_part_p_brand_0#5649, cp_name#5633 AS cp_name_0#5650, cp_mfgr#5634 AS cp_mfgr_0#5651, cp_type#5635 AS cp_type_0#5652, cp_size#5636 AS cp_size_0#5653, cp_container#5637 AS cp_container_0#5654, cp_retailprice#5638 AS cp_retailprice_0#5655, cp_comment#5639 AS cp_comment_0#5656, cp_brand#5640 AS cp_brand_0#5657]
         :  :  :  :  +- Relation[rid#5624,cval_part_p_name#5625,cval_part_p_mfgr#5626,cval_part_p_type#5627,cval_part_p_size#5628,cval_part_p_container#5629,cval_part_p_retailprice#5630,cval_part_p_comment#5631,cval_part_p_brand#5632,cp_name#5633,cp_mfgr#5634,cp_type#5635,cp_size#5636,cp_container#5637,cp_retailprice#5638,cp_comment#5639,cp_brand#5640] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#5658 AS rid_0#5675, cval_part_p_name#5659 AS cval_part_p_name_0#5676, cval_part_p_mfgr#5660 AS cval_part_p_mfgr_0#5677, cval_part_p_type#5661 AS cval_part_p_type_0#5678, cval_part_p_size#5662 AS cval_part_p_size_0#5679, cval_part_p_container#5663 AS cval_part_p_container_0#5680, cval_part_p_retailprice#5664 AS cval_part_p_retailprice_0#5681, cval_part_p_comment#5665 AS cval_part_p_comment_0#5682, cval_part_p_brand#5666 AS cval_part_p_brand_0#5683, cp_name#5667 AS cp_name_0#5684, cp_mfgr#5668 AS cp_mfgr_0#5685, cp_type#5669 AS cp_type_0#5686, cp_size#5670 AS cp_size_0#5687, cp_container#5671 AS cp_container_0#5688, cp_retailprice#5672 AS cp_retailprice_0#5689, cp_comment#5673 AS cp_comment_0#5690, cp_brand#5674 AS cp_brand_0#5691]
         :  :  :        +- Relation[rid#5658,cval_part_p_name#5659,cval_part_p_mfgr#5660,cval_part_p_type#5661,cval_part_p_size#5662,cval_part_p_container#5663,cval_part_p_retailprice#5664,cval_part_p_comment#5665,cval_part_p_brand#5666,cp_name#5667,cp_mfgr#5668,cp_type#5669,cp_size#5670,cp_container#5671,cp_retailprice#5672,cp_comment#5673,cp_brand#5674] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#5692 AS rid_0#5709, cval_part_p_name#5693 AS cval_part_p_name_0#5710, cval_part_p_mfgr#5694 AS cval_part_p_mfgr_0#5711, cval_part_p_type#5695 AS cval_part_p_type_0#5712, cval_part_p_size#5696 AS cval_part_p_size_0#5713, cval_part_p_container#5697 AS cval_part_p_container_0#5714, cval_part_p_retailprice#5698 AS cval_part_p_retailprice_0#5715, cval_part_p_comment#5699 AS cval_part_p_comment_0#5716, cval_part_p_brand#5700 AS cval_part_p_brand_0#5717, cp_name#5701 AS cp_name_0#5718, cp_mfgr#5702 AS cp_mfgr_0#5719, cp_type#5703 AS cp_type_0#5720, cp_size#5704 AS cp_size_0#5721, cp_container#5705 AS cp_container_0#5722, cp_retailprice#5706 AS cp_retailprice_0#5723, cp_comment#5707 AS cp_comment_0#5724, cp_brand#5708 AS cp_brand_0#5725]
         :  :        +- Relation[rid#5692,cval_part_p_name#5693,cval_part_p_mfgr#5694,cval_part_p_type#5695,cval_part_p_size#5696,cval_part_p_container#5697,cval_part_p_retailprice#5698,cval_part_p_comment#5699,cval_part_p_brand#5700,cp_name#5701,cp_mfgr#5702,cp_type#5703,cp_size#5704,cp_container#5705,cp_retailprice#5706,cp_comment#5707,cp_brand#5708] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#5792 AS rid_0#5809, cval_part_p_name#5793 AS cval_part_p_name_0#5810, cval_part_p_mfgr#5794 AS cval_part_p_mfgr_0#5811, cval_part_p_type#5795 AS cval_part_p_type_0#5812, cval_part_p_size#5796 AS cval_part_p_size_0#5813, cval_part_p_container#5797 AS cval_part_p_container_0#5814, cval_part_p_retailprice#5798 AS cval_part_p_retailprice_0#5815, cval_part_p_comment#5799 AS cval_part_p_comment_0#5816, cval_part_p_brand#5800 AS cval_part_p_brand_0#5817, cp_name#5801 AS cp_name_0#5818, cp_mfgr#5802 AS cp_mfgr_0#5819, cp_type#5803 AS cp_type_0#5820, cp_size#5804 AS cp_size_0#5821, cp_container#5805 AS cp_container_0#5822, cp_retailprice#5806 AS cp_retailprice_0#5823, cp_comment#5807 AS cp_comment_0#5824, cp_brand#5808 AS cp_brand_0#5825]
         :     :  +- Relation[rid#5792,cval_part_p_name#5793,cval_part_p_mfgr#5794,cval_part_p_type#5795,cval_part_p_size#5796,cval_part_p_container#5797,cval_part_p_retailprice#5798,cval_part_p_comment#5799,cval_part_p_brand#5800,cp_name#5801,cp_mfgr#5802,cp_type#5803,cp_size#5804,cp_container#5805,cp_retailprice#5806,cp_comment#5807,cp_brand#5808] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#5826 AS rid_1#5859, cpfk_orders_lineitem#5827 AS cpfk_orders_lineitem_1#5860, cpfk_supplier_lineitem#5828 AS cpfk_supplier_lineitem_1#5861, cfpk_lineitem_supplier#5829 AS cfpk_lineitem_supplier_1#5862, cfpk_lineitem_partsupp#5830 AS cfpk_lineitem_partsupp_1#5863, cpfk_part_lineitem#5831 AS cpfk_part_lineitem_1#5864, cfpk_lineitem_part#5832 AS cfpk_lineitem_part_1#5865, cpfk_partsupp_lineitem#5833 AS cpfk_partsupp_lineitem_1#5866, cfpk_lineitem_orders#5834 AS cfpk_lineitem_orders_1#5867, cval_lineitem_l_quantity#5835 AS cval_lineitem_l_quantity_1#5868, cval_lineitem_l_extendedprice#5836 AS cval_lineitem_l_extendedprice_1#5869, cval_lineitem_l_discount#5837 AS cval_lineitem_l_discount_1#5870, cval_lineitem_l_tax#5838 AS cval_lineitem_l_tax_1#5871, cval_lineitem_l_returnflag#5839 AS cval_lineitem_l_returnflag_1#5872, cval_lineitem_l_linestatus#5840 AS cval_lineitem_l_linestatus_1#5873, cval_lineitem_l_commitdate#5841 AS cval_lineitem_l_commitdate_1#5874, cval_lineitem_l_receiptdate#5842 AS cval_lineitem_l_receiptdate_1#5875, cval_lineitem_l_shipinstruct#5843 AS cval_lineitem_l_shipinstruct_1#5876, cval_lineitem_l_shipmode#5844 AS cval_lineitem_l_shipmode_1#5877, cval_lineitem_l_comment#5845 AS cval_lineitem_l_comment_1#5878, cval_lineitem_l_shipdate#5846 AS cval_lineitem_l_shipdate_1#5879, cl_quantity#5847 AS cl_quantity_1#5880, cl_extendedprice#5848 AS cl_extendedprice_1#5881, cl_discount#5849 AS cl_discount_1#5882, ... 9 more fields]
         :        +- Relation[rid#5826,cpfk_orders_lineitem#5827,cpfk_supplier_lineitem#5828,cfpk_lineitem_supplier#5829,cfpk_lineitem_partsupp#5830,cpfk_part_lineitem#5831,cfpk_lineitem_part#5832,cpfk_partsupp_lineitem#5833,cfpk_lineitem_orders#5834,cval_lineitem_l_quantity#5835,cval_lineitem_l_extendedprice#5836,cval_lineitem_l_discount#5837,cval_lineitem_l_tax#5838,cval_lineitem_l_returnflag#5839,cval_lineitem_l_linestatus#5840,cval_lineitem_l_commitdate#5841,cval_lineitem_l_receiptdate#5842,cval_lineitem_l_shipinstruct#5843,cval_lineitem_l_shipmode#5844,cval_lineitem_l_comment#5845,cval_lineitem_l_shipdate#5846,cl_quantity#5847,cl_extendedprice#5848,cl_discount#5849,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5726 AS rid_1#5759, cpfk_orders_lineitem#5727 AS cpfk_orders_lineitem_1#5760, cpfk_supplier_lineitem#5728 AS cpfk_supplier_lineitem_1#5761, cfpk_lineitem_supplier#5729 AS cfpk_lineitem_supplier_1#5762, cfpk_lineitem_partsupp#5730 AS cfpk_lineitem_partsupp_1#5763, cpfk_part_lineitem#5731 AS cpfk_part_lineitem_1#5764, cfpk_lineitem_part#5732 AS cfpk_lineitem_part_1#5765, cpfk_partsupp_lineitem#5733 AS cpfk_partsupp_lineitem_1#5766, cfpk_lineitem_orders#5734 AS cfpk_lineitem_orders_1#5767, cval_lineitem_l_quantity#5735 AS cval_lineitem_l_quantity_1#5768, cval_lineitem_l_extendedprice#5736 AS cval_lineitem_l_extendedprice_1#5769, cval_lineitem_l_discount#5737 AS cval_lineitem_l_discount_1#5770, cval_lineitem_l_tax#5738 AS cval_lineitem_l_tax_1#5771, cval_lineitem_l_returnflag#5739 AS cval_lineitem_l_returnflag_1#5772, cval_lineitem_l_linestatus#5740 AS cval_lineitem_l_linestatus_1#5773, cval_lineitem_l_commitdate#5741 AS cval_lineitem_l_commitdate_1#5774, cval_lineitem_l_receiptdate#5742 AS cval_lineitem_l_receiptdate_1#5775, cval_lineitem_l_shipinstruct#5743 AS cval_lineitem_l_shipinstruct_1#5776, cval_lineitem_l_shipmode#5744 AS cval_lineitem_l_shipmode_1#5777, cval_lineitem_l_comment#5745 AS cval_lineitem_l_comment_1#5778, cval_lineitem_l_shipdate#5746 AS cval_lineitem_l_shipdate_1#5779, cl_quantity#5747 AS cl_quantity_1#5780, cl_extendedprice#5748 AS cl_extendedprice_1#5781, cl_discount#5749 AS cl_discount_1#5782, ... 9 more fields]
            +- Relation[rid#5726,cpfk_orders_lineitem#5727,cpfk_supplier_lineitem#5728,cfpk_lineitem_supplier#5729,cfpk_lineitem_partsupp#5730,cpfk_part_lineitem#5731,cfpk_lineitem_part#5732,cpfk_partsupp_lineitem#5733,cfpk_lineitem_orders#5734,cval_lineitem_l_quantity#5735,cval_lineitem_l_extendedprice#5736,cval_lineitem_l_discount#5737,cval_lineitem_l_tax#5738,cval_lineitem_l_returnflag#5739,cval_lineitem_l_linestatus#5740,cval_lineitem_l_commitdate#5741,cval_lineitem_l_receiptdate#5742,cval_lineitem_l_shipinstruct#5743,cval_lineitem_l_shipmode#5744,cval_lineitem_l_comment#5745,cval_lineitem_l_shipdate#5746,cl_quantity#5747,cl_extendedprice#5748,cl_discount#5749,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 71693ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/11 04:15:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:15:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5946L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:15:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:15:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5946L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#5948 AS rid_0#5953, cval_region_r_name#5949 AS cval_region_r_name_0#5954, cval_region_r_comment#5950 AS cval_region_r_comment_0#5955, cr_name#5951 AS cr_name_0#5956, cr_comment#5952 AS cr_comment_0#5957]
         :  :  :  :  :  :  :  +- Relation[rid#5948,cval_region_r_name#5949,cval_region_r_comment#5950,cr_name#5951,cr_comment#5952] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#5958 AS rid_0#5963, cval_region_r_name#5959 AS cval_region_r_name_0#5964, cval_region_r_comment#5960 AS cval_region_r_comment_0#5965, cr_name#5961 AS cr_name_0#5966, cr_comment#5962 AS cr_comment_0#5967]
         :  :  :  :  :  :        +- Relation[rid#5958,cval_region_r_name#5959,cval_region_r_comment#5960,cr_name#5961,cr_comment#5962] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :     :- Project [rid#5982 AS rid_0#5987, cval_region_r_name#5983 AS cval_region_r_name_0#5988, cval_region_r_comment#5984 AS cval_region_r_comment_0#5989, cr_name#5985 AS cr_name_0#5990, cr_comment#5986 AS cr_comment_0#5991]
         :  :  :  :  :     :  +- Relation[rid#5982,cval_region_r_name#5983,cval_region_r_comment#5984,cr_name#5985,cr_comment#5986] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :     +- Project [rid#5992 AS rid_1#5999, cpfk_region_nation#5993 AS cpfk_region_nation_1#6000, cfpk_nation_region#5994 AS cfpk_nation_region_1#6001, cval_nation_n_name#5995 AS cval_nation_n_name_1#6002, cval_nation_n_comment#5996 AS cval_nation_n_comment_1#6003, cn_name#5997 AS cn_name_1#6004, cn_comment#5998 AS cn_comment_1#6005]
         :  :  :  :  :        +- Relation[rid#5992,cpfk_region_nation#5993,cfpk_nation_region#5994,cval_nation_n_name#5995,cval_nation_n_comment#5996,cn_name#5997,cn_comment#5998] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#5968 AS rid_1#5975, cpfk_region_nation#5969 AS cpfk_region_nation_1#5976, cfpk_nation_region#5970 AS cfpk_nation_region_1#5977, cval_nation_n_name#5971 AS cval_nation_n_name_1#5978, cval_nation_n_comment#5972 AS cval_nation_n_comment_1#5979, cn_name#5973 AS cn_name_1#5980, cn_comment#5974 AS cn_comment_1#5981]
         :  :  :  :     +- Relation[rid#5968,cpfk_region_nation#5969,cfpk_nation_region#5970,cval_nation_n_name#5971,cval_nation_n_comment#5972,cn_name#5973,cn_comment#5974] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :     :- Project [rid#6032 AS rid_1#6039, cpfk_region_nation#6033 AS cpfk_region_nation_1#6040, cfpk_nation_region#6034 AS cfpk_nation_region_1#6041, cval_nation_n_name#6035 AS cval_nation_n_name_1#6042, cval_nation_n_comment#6036 AS cval_nation_n_comment_1#6043, cn_name#6037 AS cn_name_1#6044, cn_comment#6038 AS cn_comment_1#6045]
         :  :  :     :  +- Relation[rid#6032,cpfk_region_nation#6033,cfpk_nation_region#6034,cval_nation_n_name#6035,cval_nation_n_comment#6036,cn_name#6037,cn_comment#6038] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#6046 AS rid_2#6059, cpfk_nation_supplier#6047 AS cpfk_nation_supplier_2#6060, cfpk_supplier_nation#6048 AS cfpk_supplier_nation_2#6061, cval_supplier_s_name#6049 AS cval_supplier_s_name_2#6062, cval_supplier_s_address#6050 AS cval_supplier_s_address_2#6063, cval_supplier_s_phone#6051 AS cval_supplier_s_phone_2#6064, cval_supplier_s_acctbal#6052 AS cval_supplier_s_acctbal_2#6065, cval_supplier_s_comment#6053 AS cval_supplier_s_comment_2#6066, cs_name#6054 AS cs_name_2#6067, cs_address#6055 AS cs_address_2#6068, cs_phone#6056 AS cs_phone_2#6069, cs_acctbal#6057 AS cs_acctbal_2#6070, cs_comment#6058 AS cs_comment_2#6071]
         :  :  :        +- Relation[rid#6046,cpfk_nation_supplier#6047,cfpk_supplier_nation#6048,cval_supplier_s_name#6049,cval_supplier_s_address#6050,cval_supplier_s_phone#6051,cval_supplier_s_acctbal#6052,cval_supplier_s_comment#6053,cs_name#6054,cs_address#6055,cs_phone#6056,cs_acctbal#6057,cs_comment#6058] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#6006 AS rid_2#6019, cpfk_nation_supplier#6007 AS cpfk_nation_supplier_2#6020, cfpk_supplier_nation#6008 AS cfpk_supplier_nation_2#6021, cval_supplier_s_name#6009 AS cval_supplier_s_name_2#6022, cval_supplier_s_address#6010 AS cval_supplier_s_address_2#6023, cval_supplier_s_phone#6011 AS cval_supplier_s_phone_2#6024, cval_supplier_s_acctbal#6012 AS cval_supplier_s_acctbal_2#6025, cval_supplier_s_comment#6013 AS cval_supplier_s_comment_2#6026, cs_name#6014 AS cs_name_2#6027, cs_address#6015 AS cs_address_2#6028, cs_phone#6016 AS cs_phone_2#6029, cs_acctbal#6017 AS cs_acctbal_2#6030, cs_comment#6018 AS cs_comment_2#6031]
         :  :     +- Relation[rid#6006,cpfk_nation_supplier#6007,cfpk_supplier_nation#6008,cval_supplier_s_name#6009,cval_supplier_s_address#6010,cval_supplier_s_phone#6011,cval_supplier_s_acctbal#6012,cval_supplier_s_comment#6013,cs_name#6014,cs_address#6015,cs_phone#6016,cs_acctbal#6017,cs_comment#6018] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :     :- Project [rid#6218 AS rid_2#6231, cpfk_nation_supplier#6219 AS cpfk_nation_supplier_2#6232, cfpk_supplier_nation#6220 AS cfpk_supplier_nation_2#6233, cval_supplier_s_name#6221 AS cval_supplier_s_name_2#6234, cval_supplier_s_address#6222 AS cval_supplier_s_address_2#6235, cval_supplier_s_phone#6223 AS cval_supplier_s_phone_2#6236, cval_supplier_s_acctbal#6224 AS cval_supplier_s_acctbal_2#6237, cval_supplier_s_comment#6225 AS cval_supplier_s_comment_2#6238, cs_name#6226 AS cs_name_2#6239, cs_address#6227 AS cs_address_2#6240, cs_phone#6228 AS cs_phone_2#6241, cs_acctbal#6229 AS cs_acctbal_2#6242, cs_comment#6230 AS cs_comment_2#6243]
         :     :  +- Relation[rid#6218,cpfk_nation_supplier#6219,cfpk_supplier_nation#6220,cval_supplier_s_name#6221,cval_supplier_s_address#6222,cval_supplier_s_phone#6223,cval_supplier_s_acctbal#6224,cval_supplier_s_comment#6225,cs_name#6226,cs_address#6227,cs_phone#6228,cs_acctbal#6229,cs_comment#6230] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#6244 AS rid_4#6255, cpfk_part_partsupp#6245 AS cpfk_part_partsupp_4#6256, cfpk_partsupp_part#6246 AS cfpk_partsupp_part_4#6257, cpfk_supplier_partsupp#6247 AS cpfk_supplier_partsupp_4#6258, cfpk_partsupp_supplier#6248 AS cfpk_partsupp_supplier_4#6259, cval_partsupp_ps_availqty#6249 AS cval_partsupp_ps_availqty_4#6260, cval_partsupp_ps_supplycost#6250 AS cval_partsupp_ps_supplycost_4#6261, cval_partsupp_ps_comment#6251 AS cval_partsupp_ps_comment_4#6262, cps_availqty#6252 AS cps_availqty_4#6263, cps_supplycost#6253 AS cps_supplycost_4#6264, cps_comment#6254 AS cps_comment_4#6265]
         :        +- Relation[rid#6244,cpfk_part_partsupp#6245,cfpk_partsupp_part#6246,cpfk_supplier_partsupp#6247,cfpk_partsupp_supplier#6248,cval_partsupp_ps_availqty#6249,cval_partsupp_ps_supplycost#6250,cval_partsupp_ps_comment#6251,cps_availqty#6252,cps_supplycost#6253,cps_comment#6254] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'Join UsingJoin(Inner,List(rid_3))
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#6072 AS rid_3#6089, cval_part_p_name#6073 AS cval_part_p_name_3#6090, cval_part_p_mfgr#6074 AS cval_part_p_mfgr_3#6091, cval_part_p_type#6075 AS cval_part_p_type_3#6092, cval_part_p_size#6076 AS cval_part_p_size_3#6093, cval_part_p_container#6077 AS cval_part_p_container_3#6094, cval_part_p_retailprice#6078 AS cval_part_p_retailprice_3#6095, cval_part_p_comment#6079 AS cval_part_p_comment_3#6096, cval_part_p_brand#6080 AS cval_part_p_brand_3#6097, cp_name#6081 AS cp_name_3#6098, cp_mfgr#6082 AS cp_mfgr_3#6099, cp_type#6083 AS cp_type_3#6100, cp_size#6084 AS cp_size_3#6101, cp_container#6085 AS cp_container_3#6102, cp_retailprice#6086 AS cp_retailprice_3#6103, cp_comment#6087 AS cp_comment_3#6104, cp_brand#6088 AS cp_brand_3#6105]
            :  :  :  +- Relation[rid#6072,cval_part_p_name#6073,cval_part_p_mfgr#6074,cval_part_p_type#6075,cval_part_p_size#6076,cval_part_p_container#6077,cval_part_p_retailprice#6078,cval_part_p_comment#6079,cval_part_p_brand#6080,cp_name#6081,cp_mfgr#6082,cp_type#6083,cp_size#6084,cp_container#6085,cp_retailprice#6086,cp_comment#6087,cp_brand#6088] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#6106 AS rid_3#6123, cval_part_p_name#6107 AS cval_part_p_name_3#6124, cval_part_p_mfgr#6108 AS cval_part_p_mfgr_3#6125, cval_part_p_type#6109 AS cval_part_p_type_3#6126, cval_part_p_size#6110 AS cval_part_p_size_3#6127, cval_part_p_container#6111 AS cval_part_p_container_3#6128, cval_part_p_retailprice#6112 AS cval_part_p_retailprice_3#6129, cval_part_p_comment#6113 AS cval_part_p_comment_3#6130, cval_part_p_brand#6114 AS cval_part_p_brand_3#6131, cp_name#6115 AS cp_name_3#6132, cp_mfgr#6116 AS cp_mfgr_3#6133, cp_type#6117 AS cp_type_3#6134, cp_size#6118 AS cp_size_3#6135, cp_container#6119 AS cp_container_3#6136, cp_retailprice#6120 AS cp_retailprice_3#6137, cp_comment#6121 AS cp_comment_3#6138, cp_brand#6122 AS cp_brand_3#6139]
            :  :        +- Relation[rid#6106,cval_part_p_name#6107,cval_part_p_mfgr#6108,cval_part_p_type#6109,cval_part_p_size#6110,cval_part_p_container#6111,cval_part_p_retailprice#6112,cval_part_p_comment#6113,cval_part_p_brand#6114,cp_name#6115,cp_mfgr#6116,cp_type#6117,cp_size#6118,cp_container#6119,cp_retailprice#6120,cp_comment#6121,cp_brand#6122] JDBCRelation(tpart) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :     :- Project [rid#6162 AS rid_3#6179, cval_part_p_name#6163 AS cval_part_p_name_3#6180, cval_part_p_mfgr#6164 AS cval_part_p_mfgr_3#6181, cval_part_p_type#6165 AS cval_part_p_type_3#6182, cval_part_p_size#6166 AS cval_part_p_size_3#6183, cval_part_p_container#6167 AS cval_part_p_container_3#6184, cval_part_p_retailprice#6168 AS cval_part_p_retailprice_3#6185, cval_part_p_comment#6169 AS cval_part_p_comment_3#6186, cval_part_p_brand#6170 AS cval_part_p_brand_3#6187, cp_name#6171 AS cp_name_3#6188, cp_mfgr#6172 AS cp_mfgr_3#6189, cp_type#6173 AS cp_type_3#6190, cp_size#6174 AS cp_size_3#6191, cp_container#6175 AS cp_container_3#6192, cp_retailprice#6176 AS cp_retailprice_3#6193, cp_comment#6177 AS cp_comment_3#6194, cp_brand#6178 AS cp_brand_3#6195]
            :     :  +- Relation[rid#6162,cval_part_p_name#6163,cval_part_p_mfgr#6164,cval_part_p_type#6165,cval_part_p_size#6166,cval_part_p_container#6167,cval_part_p_retailprice#6168,cval_part_p_comment#6169,cval_part_p_brand#6170,cp_name#6171,cp_mfgr#6172,cp_type#6173,cp_size#6174,cp_container#6175,cp_retailprice#6176,cp_comment#6177,cp_brand#6178] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#6196 AS rid_4#6207, cpfk_part_partsupp#6197 AS cpfk_part_partsupp_4#6208, cfpk_partsupp_part#6198 AS cfpk_partsupp_part_4#6209, cpfk_supplier_partsupp#6199 AS cpfk_supplier_partsupp_4#6210, cfpk_partsupp_supplier#6200 AS cfpk_partsupp_supplier_4#6211, cval_partsupp_ps_availqty#6201 AS cval_partsupp_ps_availqty_4#6212, cval_partsupp_ps_supplycost#6202 AS cval_partsupp_ps_supplycost_4#6213, cval_partsupp_ps_comment#6203 AS cval_partsupp_ps_comment_4#6214, cps_availqty#6204 AS cps_availqty_4#6215, cps_supplycost#6205 AS cps_supplycost_4#6216, cps_comment#6206 AS cps_comment_4#6217]
            :        +- Relation[rid#6196,cpfk_part_partsupp#6197,cfpk_partsupp_part#6198,cpfk_supplier_partsupp#6199,cfpk_partsupp_supplier#6200,cval_partsupp_ps_availqty#6201,cval_partsupp_ps_supplycost#6202,cval_partsupp_ps_comment#6203,cps_availqty#6204,cps_supplycost#6205,cps_comment#6206] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#6140 AS rid_4#6151, cpfk_part_partsupp#6141 AS cpfk_part_partsupp_4#6152, cfpk_partsupp_part#6142 AS cfpk_partsupp_part_4#6153, cpfk_supplier_partsupp#6143 AS cpfk_supplier_partsupp_4#6154, cfpk_partsupp_supplier#6144 AS cfpk_partsupp_supplier_4#6155, cval_partsupp_ps_availqty#6145 AS cval_partsupp_ps_availqty_4#6156, cval_partsupp_ps_supplycost#6146 AS cval_partsupp_ps_supplycost_4#6157, cval_partsupp_ps_comment#6147 AS cval_partsupp_ps_comment_4#6158, cps_availqty#6148 AS cps_availqty_4#6159, cps_supplycost#6149 AS cps_supplycost_4#6160, cps_comment#6150 AS cps_comment_4#6161]
               +- Relation[rid#6140,cpfk_part_partsupp#6141,cfpk_partsupp_part#6142,cpfk_supplier_partsupp#6143,cfpk_partsupp_supplier#6144,cval_partsupp_ps_availqty#6145,cval_partsupp_ps_supplycost#6146,cval_partsupp_ps_comment#6147,cps_availqty#6148,cps_supplycost#6149,cps_comment#6150] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 20628ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/11 04:15:28 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:15:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6324L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 04:15:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6324L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#6326 AS rid_0#6343, cpfk_customer_orders#6327 AS cpfk_customer_orders_0#6344, cfpk_orders_customer#6328 AS cfpk_orders_customer_0#6345, cval_orders_o_orderstatus#6329 AS cval_orders_o_orderstatus_0#6346, cval_orders_o_totalprice#6330 AS cval_orders_o_totalprice_0#6347, cval_orders_o_orderpriority#6331 AS cval_orders_o_orderpriority_0#6348, cval_orders_o_clerk#6332 AS cval_orders_o_clerk_0#6349, cval_orders_o_shippriority#6333 AS cval_orders_o_shippriority_0#6350, cval_orders_o_comment#6334 AS cval_orders_o_comment_0#6351, cval_orders_o_orderdate#6335 AS cval_orders_o_orderdate_0#6352, co_orderstatus#6336 AS co_orderstatus_0#6353, co_totalprice#6337 AS co_totalprice_0#6354, co_orderpriority#6338 AS co_orderpriority_0#6355, co_clerk#6339 AS co_clerk_0#6356, co_shippriority#6340 AS co_shippriority_0#6357, co_comment#6341 AS co_comment_0#6358, co_orderdate#6342 AS co_orderdate_0#6359]
            :  +- Relation[rid#6326,cpfk_customer_orders#6327,cfpk_orders_customer#6328,cval_orders_o_orderstatus#6329,cval_orders_o_totalprice#6330,cval_orders_o_orderpriority#6331,cval_orders_o_clerk#6332,cval_orders_o_shippriority#6333,cval_orders_o_comment#6334,cval_orders_o_orderdate#6335,co_orderstatus#6336,co_totalprice#6337,co_orderpriority#6338,co_clerk#6339,co_shippriority#6340,co_comment#6341,co_orderdate#6342] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#6360 AS rid_1#6375, cpfk_nation_customer#6361 AS cpfk_nation_customer_1#6376, cfpk_customer_nation#6362 AS cfpk_customer_nation_1#6377, cval_customer_c_name#6363 AS cval_customer_c_name_1#6378, cval_customer_c_address#6364 AS cval_customer_c_address_1#6379, cval_customer_c_phone#6365 AS cval_customer_c_phone_1#6380, cval_customer_c_acctbal#6366 AS cval_customer_c_acctbal_1#6381, cval_customer_c_comment#6367 AS cval_customer_c_comment_1#6382, cval_customer_c_mktsegment#6368 AS cval_customer_c_mktsegment_1#6383, cc_name#6369 AS cc_name_1#6384, cc_address#6370 AS cc_address_1#6385, cc_phone#6371 AS cc_phone_1#6386, cc_acctbal#6372 AS cc_acctbal_1#6387, cc_comment#6373 AS cc_comment_1#6388, cc_mktsegment#6374 AS cc_mktsegment_1#6389]
               +- Relation[rid#6360,cpfk_nation_customer#6361,cfpk_customer_nation#6362,cval_customer_c_name#6363,cval_customer_c_address#6364,cval_customer_c_phone#6365,cval_customer_c_acctbal#6366,cval_customer_c_comment#6367,cval_customer_c_mktsegment#6368,cc_name#6369,cc_address#6370,cc_phone#6371,cc_acctbal#6372,cc_comment#6373,cc_mktsegment#6374] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 12862ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/11 04:15:41 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:15:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6427L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 04:15:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#6427L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#6429 AS rid_0#6462, cpfk_orders_lineitem#6430 AS cpfk_orders_lineitem_0#6463, cpfk_supplier_lineitem#6431 AS cpfk_supplier_lineitem_0#6464, cfpk_lineitem_supplier#6432 AS cfpk_lineitem_supplier_0#6465, cfpk_lineitem_partsupp#6433 AS cfpk_lineitem_partsupp_0#6466, cpfk_part_lineitem#6434 AS cpfk_part_lineitem_0#6467, cfpk_lineitem_part#6435 AS cfpk_lineitem_part_0#6468, cpfk_partsupp_lineitem#6436 AS cpfk_partsupp_lineitem_0#6469, cfpk_lineitem_orders#6437 AS cfpk_lineitem_orders_0#6470, cval_lineitem_l_quantity#6438 AS cval_lineitem_l_quantity_0#6471, cval_lineitem_l_extendedprice#6439 AS cval_lineitem_l_extendedprice_0#6472, cval_lineitem_l_discount#6440 AS cval_lineitem_l_discount_0#6473, cval_lineitem_l_tax#6441 AS cval_lineitem_l_tax_0#6474, cval_lineitem_l_returnflag#6442 AS cval_lineitem_l_returnflag_0#6475, cval_lineitem_l_linestatus#6443 AS cval_lineitem_l_linestatus_0#6476, cval_lineitem_l_commitdate#6444 AS cval_lineitem_l_commitdate_0#6477, cval_lineitem_l_receiptdate#6445 AS cval_lineitem_l_receiptdate_0#6478, cval_lineitem_l_shipinstruct#6446 AS cval_lineitem_l_shipinstruct_0#6479, cval_lineitem_l_shipmode#6447 AS cval_lineitem_l_shipmode_0#6480, cval_lineitem_l_comment#6448 AS cval_lineitem_l_comment_0#6481, cval_lineitem_l_shipdate#6449 AS cval_lineitem_l_shipdate_0#6482, cl_quantity#6450 AS cl_quantity_0#6483, cl_extendedprice#6451 AS cl_extendedprice_0#6484, cl_discount#6452 AS cl_discount_0#6485, ... 9 more fields]
         +- Relation[rid#6429,cpfk_orders_lineitem#6430,cpfk_supplier_lineitem#6431,cfpk_lineitem_supplier#6432,cfpk_lineitem_partsupp#6433,cpfk_part_lineitem#6434,cfpk_lineitem_part#6435,cpfk_partsupp_lineitem#6436,cfpk_lineitem_orders#6437,cval_lineitem_l_quantity#6438,cval_lineitem_l_extendedprice#6439,cval_lineitem_l_discount#6440,cval_lineitem_l_tax#6441,cval_lineitem_l_returnflag#6442,cval_lineitem_l_linestatus#6443,cval_lineitem_l_commitdate#6444,cval_lineitem_l_receiptdate#6445,cval_lineitem_l_shipinstruct#6446,cval_lineitem_l_shipmode#6447,cval_lineitem_l_comment#6448,cval_lineitem_l_shipdate#6449,cl_quantity#6450,cl_extendedprice#6451,cl_discount#6452,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 3586ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/11 04:15:45 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:15:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6537L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 04:15:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6537L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#6539 AS rid_0#6554, cpfk_nation_customer#6540 AS cpfk_nation_customer_0#6555, cfpk_customer_nation#6541 AS cfpk_customer_nation_0#6556, cval_customer_c_name#6542 AS cval_customer_c_name_0#6557, cval_customer_c_address#6543 AS cval_customer_c_address_0#6558, cval_customer_c_phone#6544 AS cval_customer_c_phone_0#6559, cval_customer_c_acctbal#6545 AS cval_customer_c_acctbal_0#6560, cval_customer_c_comment#6546 AS cval_customer_c_comment_0#6561, cval_customer_c_mktsegment#6547 AS cval_customer_c_mktsegment_0#6562, cc_name#6548 AS cc_name_0#6563, cc_address#6549 AS cc_address_0#6564, cc_phone#6550 AS cc_phone_0#6565, cc_acctbal#6551 AS cc_acctbal_0#6566, cc_comment#6552 AS cc_comment_0#6567, cc_mktsegment#6553 AS cc_mktsegment_0#6568]
         :  :  :  :  +- Relation[rid#6539,cpfk_nation_customer#6540,cfpk_customer_nation#6541,cval_customer_c_name#6542,cval_customer_c_address#6543,cval_customer_c_phone#6544,cval_customer_c_acctbal#6545,cval_customer_c_comment#6546,cval_customer_c_mktsegment#6547,cc_name#6548,cc_address#6549,cc_phone#6550,cc_acctbal#6551,cc_comment#6552,cc_mktsegment#6553] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#6603 AS rid_0#6618, cpfk_nation_customer#6604 AS cpfk_nation_customer_0#6619, cfpk_customer_nation#6605 AS cfpk_customer_nation_0#6620, cval_customer_c_name#6606 AS cval_customer_c_name_0#6621, cval_customer_c_address#6607 AS cval_customer_c_address_0#6622, cval_customer_c_phone#6608 AS cval_customer_c_phone_0#6623, cval_customer_c_acctbal#6609 AS cval_customer_c_acctbal_0#6624, cval_customer_c_comment#6610 AS cval_customer_c_comment_0#6625, cval_customer_c_mktsegment#6611 AS cval_customer_c_mktsegment_0#6626, cc_name#6612 AS cc_name_0#6627, cc_address#6613 AS cc_address_0#6628, cc_phone#6614 AS cc_phone_0#6629, cc_acctbal#6615 AS cc_acctbal_0#6630, cc_comment#6616 AS cc_comment_0#6631, cc_mktsegment#6617 AS cc_mktsegment_0#6632]
         :  :  :     :  +- Relation[rid#6603,cpfk_nation_customer#6604,cfpk_customer_nation#6605,cval_customer_c_name#6606,cval_customer_c_address#6607,cval_customer_c_phone#6608,cval_customer_c_acctbal#6609,cval_customer_c_comment#6610,cval_customer_c_mktsegment#6611,cc_name#6612,cc_address#6613,cc_phone#6614,cc_acctbal#6615,cc_comment#6616,cc_mktsegment#6617] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#6633 AS rid_1#6650, cpfk_customer_orders#6634 AS cpfk_customer_orders_1#6651, cfpk_orders_customer#6635 AS cfpk_orders_customer_1#6652, cval_orders_o_orderstatus#6636 AS cval_orders_o_orderstatus_1#6653, cval_orders_o_totalprice#6637 AS cval_orders_o_totalprice_1#6654, cval_orders_o_orderpriority#6638 AS cval_orders_o_orderpriority_1#6655, cval_orders_o_clerk#6639 AS cval_orders_o_clerk_1#6656, cval_orders_o_shippriority#6640 AS cval_orders_o_shippriority_1#6657, cval_orders_o_comment#6641 AS cval_orders_o_comment_1#6658, cval_orders_o_orderdate#6642 AS cval_orders_o_orderdate_1#6659, co_orderstatus#6643 AS co_orderstatus_1#6660, co_totalprice#6644 AS co_totalprice_1#6661, co_orderpriority#6645 AS co_orderpriority_1#6662, co_clerk#6646 AS co_clerk_1#6663, co_shippriority#6647 AS co_shippriority_1#6664, co_comment#6648 AS co_comment_1#6665, co_orderdate#6649 AS co_orderdate_1#6666]
         :  :  :        +- Relation[rid#6633,cpfk_customer_orders#6634,cfpk_orders_customer#6635,cval_orders_o_orderstatus#6636,cval_orders_o_totalprice#6637,cval_orders_o_orderpriority#6638,cval_orders_o_clerk#6639,cval_orders_o_shippriority#6640,cval_orders_o_comment#6641,cval_orders_o_orderdate#6642,co_orderstatus#6643,co_totalprice#6644,co_orderpriority#6645,co_clerk#6646,co_shippriority#6647,co_comment#6648,co_orderdate#6649] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#6569 AS rid_1#6586, cpfk_customer_orders#6570 AS cpfk_customer_orders_1#6587, cfpk_orders_customer#6571 AS cfpk_orders_customer_1#6588, cval_orders_o_orderstatus#6572 AS cval_orders_o_orderstatus_1#6589, cval_orders_o_totalprice#6573 AS cval_orders_o_totalprice_1#6590, cval_orders_o_orderpriority#6574 AS cval_orders_o_orderpriority_1#6591, cval_orders_o_clerk#6575 AS cval_orders_o_clerk_1#6592, cval_orders_o_shippriority#6576 AS cval_orders_o_shippriority_1#6593, cval_orders_o_comment#6577 AS cval_orders_o_comment_1#6594, cval_orders_o_orderdate#6578 AS cval_orders_o_orderdate_1#6595, co_orderstatus#6579 AS co_orderstatus_1#6596, co_totalprice#6580 AS co_totalprice_1#6597, co_orderpriority#6581 AS co_orderpriority_1#6598, co_clerk#6582 AS co_clerk_1#6599, co_shippriority#6583 AS co_shippriority_1#6600, co_comment#6584 AS co_comment_1#6601, co_orderdate#6585 AS co_orderdate_1#6602]
         :  :     +- Relation[rid#6569,cpfk_customer_orders#6570,cfpk_orders_customer#6571,cval_orders_o_orderstatus#6572,cval_orders_o_totalprice#6573,cval_orders_o_orderpriority#6574,cval_orders_o_clerk#6575,cval_orders_o_shippriority#6576,cval_orders_o_comment#6577,cval_orders_o_orderdate#6578,co_orderstatus#6579,co_totalprice#6580,co_orderpriority#6581,co_clerk#6582,co_shippriority#6583,co_comment#6584,co_orderdate#6585] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#6733 AS rid_1#6750, cpfk_customer_orders#6734 AS cpfk_customer_orders_1#6751, cfpk_orders_customer#6735 AS cfpk_orders_customer_1#6752, cval_orders_o_orderstatus#6736 AS cval_orders_o_orderstatus_1#6753, cval_orders_o_totalprice#6737 AS cval_orders_o_totalprice_1#6754, cval_orders_o_orderpriority#6738 AS cval_orders_o_orderpriority_1#6755, cval_orders_o_clerk#6739 AS cval_orders_o_clerk_1#6756, cval_orders_o_shippriority#6740 AS cval_orders_o_shippriority_1#6757, cval_orders_o_comment#6741 AS cval_orders_o_comment_1#6758, cval_orders_o_orderdate#6742 AS cval_orders_o_orderdate_1#6759, co_orderstatus#6743 AS co_orderstatus_1#6760, co_totalprice#6744 AS co_totalprice_1#6761, co_orderpriority#6745 AS co_orderpriority_1#6762, co_clerk#6746 AS co_clerk_1#6763, co_shippriority#6747 AS co_shippriority_1#6764, co_comment#6748 AS co_comment_1#6765, co_orderdate#6749 AS co_orderdate_1#6766]
         :     :  +- Relation[rid#6733,cpfk_customer_orders#6734,cfpk_orders_customer#6735,cval_orders_o_orderstatus#6736,cval_orders_o_totalprice#6737,cval_orders_o_orderpriority#6738,cval_orders_o_clerk#6739,cval_orders_o_shippriority#6740,cval_orders_o_comment#6741,cval_orders_o_orderdate#6742,co_orderstatus#6743,co_totalprice#6744,co_orderpriority#6745,co_clerk#6746,co_shippriority#6747,co_comment#6748,co_orderdate#6749] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#6767 AS rid_2#6800, cpfk_orders_lineitem#6768 AS cpfk_orders_lineitem_2#6801, cpfk_supplier_lineitem#6769 AS cpfk_supplier_lineitem_2#6802, cfpk_lineitem_supplier#6770 AS cfpk_lineitem_supplier_2#6803, cfpk_lineitem_partsupp#6771 AS cfpk_lineitem_partsupp_2#6804, cpfk_part_lineitem#6772 AS cpfk_part_lineitem_2#6805, cfpk_lineitem_part#6773 AS cfpk_lineitem_part_2#6806, cpfk_partsupp_lineitem#6774 AS cpfk_partsupp_lineitem_2#6807, cfpk_lineitem_orders#6775 AS cfpk_lineitem_orders_2#6808, cval_lineitem_l_quantity#6776 AS cval_lineitem_l_quantity_2#6809, cval_lineitem_l_extendedprice#6777 AS cval_lineitem_l_extendedprice_2#6810, cval_lineitem_l_discount#6778 AS cval_lineitem_l_discount_2#6811, cval_lineitem_l_tax#6779 AS cval_lineitem_l_tax_2#6812, cval_lineitem_l_returnflag#6780 AS cval_lineitem_l_returnflag_2#6813, cval_lineitem_l_linestatus#6781 AS cval_lineitem_l_linestatus_2#6814, cval_lineitem_l_commitdate#6782 AS cval_lineitem_l_commitdate_2#6815, cval_lineitem_l_receiptdate#6783 AS cval_lineitem_l_receiptdate_2#6816, cval_lineitem_l_shipinstruct#6784 AS cval_lineitem_l_shipinstruct_2#6817, cval_lineitem_l_shipmode#6785 AS cval_lineitem_l_shipmode_2#6818, cval_lineitem_l_comment#6786 AS cval_lineitem_l_comment_2#6819, cval_lineitem_l_shipdate#6787 AS cval_lineitem_l_shipdate_2#6820, cl_quantity#6788 AS cl_quantity_2#6821, cl_extendedprice#6789 AS cl_extendedprice_2#6822, cl_discount#6790 AS cl_discount_2#6823, ... 9 more fields]
         :        +- Relation[rid#6767,cpfk_orders_lineitem#6768,cpfk_supplier_lineitem#6769,cfpk_lineitem_supplier#6770,cfpk_lineitem_partsupp#6771,cpfk_part_lineitem#6772,cfpk_lineitem_part#6773,cpfk_partsupp_lineitem#6774,cfpk_lineitem_orders#6775,cval_lineitem_l_quantity#6776,cval_lineitem_l_extendedprice#6777,cval_lineitem_l_discount#6778,cval_lineitem_l_tax#6779,cval_lineitem_l_returnflag#6780,cval_lineitem_l_linestatus#6781,cval_lineitem_l_commitdate#6782,cval_lineitem_l_receiptdate#6783,cval_lineitem_l_shipinstruct#6784,cval_lineitem_l_shipmode#6785,cval_lineitem_l_comment#6786,cval_lineitem_l_shipdate#6787,cl_quantity#6788,cl_extendedprice#6789,cl_discount#6790,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6667 AS rid_2#6700, cpfk_orders_lineitem#6668 AS cpfk_orders_lineitem_2#6701, cpfk_supplier_lineitem#6669 AS cpfk_supplier_lineitem_2#6702, cfpk_lineitem_supplier#6670 AS cfpk_lineitem_supplier_2#6703, cfpk_lineitem_partsupp#6671 AS cfpk_lineitem_partsupp_2#6704, cpfk_part_lineitem#6672 AS cpfk_part_lineitem_2#6705, cfpk_lineitem_part#6673 AS cfpk_lineitem_part_2#6706, cpfk_partsupp_lineitem#6674 AS cpfk_partsupp_lineitem_2#6707, cfpk_lineitem_orders#6675 AS cfpk_lineitem_orders_2#6708, cval_lineitem_l_quantity#6676 AS cval_lineitem_l_quantity_2#6709, cval_lineitem_l_extendedprice#6677 AS cval_lineitem_l_extendedprice_2#6710, cval_lineitem_l_discount#6678 AS cval_lineitem_l_discount_2#6711, cval_lineitem_l_tax#6679 AS cval_lineitem_l_tax_2#6712, cval_lineitem_l_returnflag#6680 AS cval_lineitem_l_returnflag_2#6713, cval_lineitem_l_linestatus#6681 AS cval_lineitem_l_linestatus_2#6714, cval_lineitem_l_commitdate#6682 AS cval_lineitem_l_commitdate_2#6715, cval_lineitem_l_receiptdate#6683 AS cval_lineitem_l_receiptdate_2#6716, cval_lineitem_l_shipinstruct#6684 AS cval_lineitem_l_shipinstruct_2#6717, cval_lineitem_l_shipmode#6685 AS cval_lineitem_l_shipmode_2#6718, cval_lineitem_l_comment#6686 AS cval_lineitem_l_comment_2#6719, cval_lineitem_l_shipdate#6687 AS cval_lineitem_l_shipdate_2#6720, cl_quantity#6688 AS cl_quantity_2#6721, cl_extendedprice#6689 AS cl_extendedprice_2#6722, cl_discount#6690 AS cl_discount_2#6723, ... 9 more fields]
            +- Relation[rid#6667,cpfk_orders_lineitem#6668,cpfk_supplier_lineitem#6669,cfpk_lineitem_supplier#6670,cfpk_lineitem_partsupp#6671,cpfk_part_lineitem#6672,cfpk_lineitem_part#6673,cpfk_partsupp_lineitem#6674,cfpk_lineitem_orders#6675,cval_lineitem_l_quantity#6676,cval_lineitem_l_extendedprice#6677,cval_lineitem_l_discount#6678,cval_lineitem_l_tax#6679,cval_lineitem_l_returnflag#6680,cval_lineitem_l_linestatus#6681,cval_lineitem_l_commitdate#6682,cval_lineitem_l_receiptdate#6683,cval_lineitem_l_shipinstruct#6684,cval_lineitem_l_shipmode#6685,cval_lineitem_l_comment#6686,cval_lineitem_l_shipdate#6687,cl_quantity#6688,cl_extendedprice#6689,cl_discount#6690,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 117797ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 04:17:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:17:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6907L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 04:17:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:17:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:17:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:17:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:17:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:17:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:17:43 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:17:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:17:43 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:17:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:17:43 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:17:43 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:17:43 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:17:43 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:17:43 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:17:43 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:17:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6907L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#6909 AS rid_0#6916, cpfk_region_nation#6910 AS cpfk_region_nation_0#6917, cfpk_nation_region#6911 AS cfpk_nation_region_0#6918, cval_nation_n_name#6912 AS cval_nation_n_name_0#6919, cval_nation_n_comment#6913 AS cval_nation_n_comment_0#6920, cn_name#6914 AS cn_name_0#6921, cn_comment#6915 AS cn_comment_0#6922]
            :  :  :     :  :  :  :  :  +- Relation[rid#6909,cpfk_region_nation#6910,cfpk_nation_region#6911,cval_nation_n_name#6912,cval_nation_n_comment#6913,cn_name#6914,cn_comment#6915] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#6949 AS rid_0#6956, cpfk_region_nation#6950 AS cpfk_region_nation_0#6957, cfpk_nation_region#6951 AS cfpk_nation_region_0#6958, cval_nation_n_name#6952 AS cval_nation_n_name_0#6959, cval_nation_n_comment#6953 AS cval_nation_n_comment_0#6960, cn_name#6954 AS cn_name_0#6961, cn_comment#6955 AS cn_comment_0#6962]
            :  :  :     :  :  :  :     :  +- Relation[rid#6949,cpfk_region_nation#6950,cfpk_nation_region#6951,cval_nation_n_name#6952,cval_nation_n_comment#6953,cn_name#6954,cn_comment#6955] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#6963 AS rid_1#6976, cpfk_nation_supplier#6964 AS cpfk_nation_supplier_1#6977, cfpk_supplier_nation#6965 AS cfpk_supplier_nation_1#6978, cval_supplier_s_name#6966 AS cval_supplier_s_name_1#6979, cval_supplier_s_address#6967 AS cval_supplier_s_address_1#6980, cval_supplier_s_phone#6968 AS cval_supplier_s_phone_1#6981, cval_supplier_s_acctbal#6969 AS cval_supplier_s_acctbal_1#6982, cval_supplier_s_comment#6970 AS cval_supplier_s_comment_1#6983, cs_name#6971 AS cs_name_1#6984, cs_address#6972 AS cs_address_1#6985, cs_phone#6973 AS cs_phone_1#6986, cs_acctbal#6974 AS cs_acctbal_1#6987, cs_comment#6975 AS cs_comment_1#6988]
            :  :  :     :  :  :  :        +- Relation[rid#6963,cpfk_nation_supplier#6964,cfpk_supplier_nation#6965,cval_supplier_s_name#6966,cval_supplier_s_address#6967,cval_supplier_s_phone#6968,cval_supplier_s_acctbal#6969,cval_supplier_s_comment#6970,cs_name#6971,cs_address#6972,cs_phone#6973,cs_acctbal#6974,cs_comment#6975] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#6923 AS rid_1#6936, cpfk_nation_supplier#6924 AS cpfk_nation_supplier_1#6937, cfpk_supplier_nation#6925 AS cfpk_supplier_nation_1#6938, cval_supplier_s_name#6926 AS cval_supplier_s_name_1#6939, cval_supplier_s_address#6927 AS cval_supplier_s_address_1#6940, cval_supplier_s_phone#6928 AS cval_supplier_s_phone_1#6941, cval_supplier_s_acctbal#6929 AS cval_supplier_s_acctbal_1#6942, cval_supplier_s_comment#6930 AS cval_supplier_s_comment_1#6943, cs_name#6931 AS cs_name_1#6944, cs_address#6932 AS cs_address_1#6945, cs_phone#6933 AS cs_phone_1#6946, cs_acctbal#6934 AS cs_acctbal_1#6947, cs_comment#6935 AS cs_comment_1#6948]
            :  :  :     :  :  :     +- Relation[rid#6923,cpfk_nation_supplier#6924,cfpk_supplier_nation#6925,cval_supplier_s_name#6926,cval_supplier_s_address#6927,cval_supplier_s_phone#6928,cval_supplier_s_acctbal#6929,cval_supplier_s_comment#6930,cs_name#6931,cs_address#6932,cs_phone#6933,cs_acctbal#6934,cs_comment#6935] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#7011 AS rid_1#7024, cpfk_nation_supplier#7012 AS cpfk_nation_supplier_1#7025, cfpk_supplier_nation#7013 AS cfpk_supplier_nation_1#7026, cval_supplier_s_name#7014 AS cval_supplier_s_name_1#7027, cval_supplier_s_address#7015 AS cval_supplier_s_address_1#7028, cval_supplier_s_phone#7016 AS cval_supplier_s_phone_1#7029, cval_supplier_s_acctbal#7017 AS cval_supplier_s_acctbal_1#7030, cval_supplier_s_comment#7018 AS cval_supplier_s_comment_1#7031, cs_name#7019 AS cs_name_1#7032, cs_address#7020 AS cs_address_1#7033, cs_phone#7021 AS cs_phone_1#7034, cs_acctbal#7022 AS cs_acctbal_1#7035, cs_comment#7023 AS cs_comment_1#7036]
            :  :  :     :  :     :  +- Relation[rid#7011,cpfk_nation_supplier#7012,cfpk_supplier_nation#7013,cval_supplier_s_name#7014,cval_supplier_s_address#7015,cval_supplier_s_phone#7016,cval_supplier_s_acctbal#7017,cval_supplier_s_comment#7018,cs_name#7019,cs_address#7020,cs_phone#7021,cs_acctbal#7022,cs_comment#7023] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#7037 AS rid_2#7048, cpfk_part_partsupp#7038 AS cpfk_part_partsupp_2#7049, cfpk_partsupp_part#7039 AS cfpk_partsupp_part_2#7050, cpfk_supplier_partsupp#7040 AS cpfk_supplier_partsupp_2#7051, cfpk_partsupp_supplier#7041 AS cfpk_partsupp_supplier_2#7052, cval_partsupp_ps_availqty#7042 AS cval_partsupp_ps_availqty_2#7053, cval_partsupp_ps_supplycost#7043 AS cval_partsupp_ps_supplycost_2#7054, cval_partsupp_ps_comment#7044 AS cval_partsupp_ps_comment_2#7055, cps_availqty#7045 AS cps_availqty_2#7056, cps_supplycost#7046 AS cps_supplycost_2#7057, cps_comment#7047 AS cps_comment_2#7058]
            :  :  :     :  :        +- Relation[rid#7037,cpfk_part_partsupp#7038,cfpk_partsupp_part#7039,cpfk_supplier_partsupp#7040,cfpk_partsupp_supplier#7041,cval_partsupp_ps_availqty#7042,cval_partsupp_ps_supplycost#7043,cval_partsupp_ps_comment#7044,cps_availqty#7045,cps_supplycost#7046,cps_comment#7047] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#6989 AS rid_2#7000, cpfk_part_partsupp#6990 AS cpfk_part_partsupp_2#7001, cfpk_partsupp_part#6991 AS cfpk_partsupp_part_2#7002, cpfk_supplier_partsupp#6992 AS cpfk_supplier_partsupp_2#7003, cfpk_partsupp_supplier#6993 AS cfpk_partsupp_supplier_2#7004, cval_partsupp_ps_availqty#6994 AS cval_partsupp_ps_availqty_2#7005, cval_partsupp_ps_supplycost#6995 AS cval_partsupp_ps_supplycost_2#7006, cval_partsupp_ps_comment#6996 AS cval_partsupp_ps_comment_2#7007, cps_availqty#6997 AS cps_availqty_2#7008, cps_supplycost#6998 AS cps_supplycost_2#7009, cps_comment#6999 AS cps_comment_2#7010]
            :  :  :     :     +- Relation[rid#6989,cpfk_part_partsupp#6990,cfpk_partsupp_part#6991,cpfk_supplier_partsupp#6992,cfpk_partsupp_supplier#6993,cval_partsupp_ps_availqty#6994,cval_partsupp_ps_supplycost#6995,cval_partsupp_ps_comment#6996,cps_availqty#6997,cps_supplycost#6998,cps_comment#6999] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#7059 AS rid_3#7076, cval_part_p_name#7060 AS cval_part_p_name_3#7077, cval_part_p_mfgr#7061 AS cval_part_p_mfgr_3#7078, cval_part_p_type#7062 AS cval_part_p_type_3#7079, cval_part_p_size#7063 AS cval_part_p_size_3#7080, cval_part_p_container#7064 AS cval_part_p_container_3#7081, cval_part_p_retailprice#7065 AS cval_part_p_retailprice_3#7082, cval_part_p_comment#7066 AS cval_part_p_comment_3#7083, cval_part_p_brand#7067 AS cval_part_p_brand_3#7084, cp_name#7068 AS cp_name_3#7085, cp_mfgr#7069 AS cp_mfgr_3#7086, cp_type#7070 AS cp_type_3#7087, cp_size#7071 AS cp_size_3#7088, cp_container#7072 AS cp_container_3#7089, cp_retailprice#7073 AS cp_retailprice_3#7090, cp_comment#7074 AS cp_comment_3#7091, cp_brand#7075 AS cp_brand_3#7092]
            :  :  :        +- Relation[rid#7059,cval_part_p_name#7060,cval_part_p_mfgr#7061,cval_part_p_type#7062,cval_part_p_size#7063,cval_part_p_container#7064,cval_part_p_retailprice#7065,cval_part_p_comment#7066,cval_part_p_brand#7067,cp_name#7068,cp_mfgr#7069,cp_type#7070,cp_size#7071,cp_container#7072,cp_retailprice#7073,cp_comment#7074,cp_brand#7075] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#7159 AS rid_2#7170, cpfk_part_partsupp#7160 AS cpfk_part_partsupp_2#7171, cfpk_partsupp_part#7161 AS cfpk_partsupp_part_2#7172, cpfk_supplier_partsupp#7162 AS cpfk_supplier_partsupp_2#7173, cfpk_partsupp_supplier#7163 AS cfpk_partsupp_supplier_2#7174, cval_partsupp_ps_availqty#7164 AS cval_partsupp_ps_availqty_2#7175, cval_partsupp_ps_supplycost#7165 AS cval_partsupp_ps_supplycost_2#7176, cval_partsupp_ps_comment#7166 AS cval_partsupp_ps_comment_2#7177, cps_availqty#7167 AS cps_availqty_2#7178, cps_supplycost#7168 AS cps_supplycost_2#7179, cps_comment#7169 AS cps_comment_2#7180]
            :  :     :  +- Relation[rid#7159,cpfk_part_partsupp#7160,cfpk_partsupp_part#7161,cpfk_supplier_partsupp#7162,cfpk_partsupp_supplier#7163,cval_partsupp_ps_availqty#7164,cval_partsupp_ps_supplycost#7165,cval_partsupp_ps_comment#7166,cps_availqty#7167,cps_supplycost#7168,cps_comment#7169] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#7181 AS rid_4#7214, cpfk_orders_lineitem#7182 AS cpfk_orders_lineitem_4#7215, cpfk_supplier_lineitem#7183 AS cpfk_supplier_lineitem_4#7216, cfpk_lineitem_supplier#7184 AS cfpk_lineitem_supplier_4#7217, cfpk_lineitem_partsupp#7185 AS cfpk_lineitem_partsupp_4#7218, cpfk_part_lineitem#7186 AS cpfk_part_lineitem_4#7219, cfpk_lineitem_part#7187 AS cfpk_lineitem_part_4#7220, cpfk_partsupp_lineitem#7188 AS cpfk_partsupp_lineitem_4#7221, cfpk_lineitem_orders#7189 AS cfpk_lineitem_orders_4#7222, cval_lineitem_l_quantity#7190 AS cval_lineitem_l_quantity_4#7223, cval_lineitem_l_extendedprice#7191 AS cval_lineitem_l_extendedprice_4#7224, cval_lineitem_l_discount#7192 AS cval_lineitem_l_discount_4#7225, cval_lineitem_l_tax#7193 AS cval_lineitem_l_tax_4#7226, cval_lineitem_l_returnflag#7194 AS cval_lineitem_l_returnflag_4#7227, cval_lineitem_l_linestatus#7195 AS cval_lineitem_l_linestatus_4#7228, cval_lineitem_l_commitdate#7196 AS cval_lineitem_l_commitdate_4#7229, cval_lineitem_l_receiptdate#7197 AS cval_lineitem_l_receiptdate_4#7230, cval_lineitem_l_shipinstruct#7198 AS cval_lineitem_l_shipinstruct_4#7231, cval_lineitem_l_shipmode#7199 AS cval_lineitem_l_shipmode_4#7232, cval_lineitem_l_comment#7200 AS cval_lineitem_l_comment_4#7233, cval_lineitem_l_shipdate#7201 AS cval_lineitem_l_shipdate_4#7234, cl_quantity#7202 AS cl_quantity_4#7235, cl_extendedprice#7203 AS cl_extendedprice_4#7236, cl_discount#7204 AS cl_discount_4#7237, ... 9 more fields]
            :  :        +- Relation[rid#7181,cpfk_orders_lineitem#7182,cpfk_supplier_lineitem#7183,cfpk_lineitem_supplier#7184,cfpk_lineitem_partsupp#7185,cpfk_part_lineitem#7186,cfpk_lineitem_part#7187,cpfk_partsupp_lineitem#7188,cfpk_lineitem_orders#7189,cval_lineitem_l_quantity#7190,cval_lineitem_l_extendedprice#7191,cval_lineitem_l_discount#7192,cval_lineitem_l_tax#7193,cval_lineitem_l_returnflag#7194,cval_lineitem_l_linestatus#7195,cval_lineitem_l_commitdate#7196,cval_lineitem_l_receiptdate#7197,cval_lineitem_l_shipinstruct#7198,cval_lineitem_l_shipmode#7199,cval_lineitem_l_comment#7200,cval_lineitem_l_shipdate#7201,cl_quantity#7202,cl_extendedprice#7203,cl_discount#7204,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#7093 AS rid_4#7126, cpfk_orders_lineitem#7094 AS cpfk_orders_lineitem_4#7127, cpfk_supplier_lineitem#7095 AS cpfk_supplier_lineitem_4#7128, cfpk_lineitem_supplier#7096 AS cfpk_lineitem_supplier_4#7129, cfpk_lineitem_partsupp#7097 AS cfpk_lineitem_partsupp_4#7130, cpfk_part_lineitem#7098 AS cpfk_part_lineitem_4#7131, cfpk_lineitem_part#7099 AS cfpk_lineitem_part_4#7132, cpfk_partsupp_lineitem#7100 AS cpfk_partsupp_lineitem_4#7133, cfpk_lineitem_orders#7101 AS cfpk_lineitem_orders_4#7134, cval_lineitem_l_quantity#7102 AS cval_lineitem_l_quantity_4#7135, cval_lineitem_l_extendedprice#7103 AS cval_lineitem_l_extendedprice_4#7136, cval_lineitem_l_discount#7104 AS cval_lineitem_l_discount_4#7137, cval_lineitem_l_tax#7105 AS cval_lineitem_l_tax_4#7138, cval_lineitem_l_returnflag#7106 AS cval_lineitem_l_returnflag_4#7139, cval_lineitem_l_linestatus#7107 AS cval_lineitem_l_linestatus_4#7140, cval_lineitem_l_commitdate#7108 AS cval_lineitem_l_commitdate_4#7141, cval_lineitem_l_receiptdate#7109 AS cval_lineitem_l_receiptdate_4#7142, cval_lineitem_l_shipinstruct#7110 AS cval_lineitem_l_shipinstruct_4#7143, cval_lineitem_l_shipmode#7111 AS cval_lineitem_l_shipmode_4#7144, cval_lineitem_l_comment#7112 AS cval_lineitem_l_comment_4#7145, cval_lineitem_l_shipdate#7113 AS cval_lineitem_l_shipdate_4#7146, cl_quantity#7114 AS cl_quantity_4#7147, cl_extendedprice#7115 AS cl_extendedprice_4#7148, cl_discount#7116 AS cl_discount_4#7149, ... 9 more fields]
            :     +- Relation[rid#7093,cpfk_orders_lineitem#7094,cpfk_supplier_lineitem#7095,cfpk_lineitem_supplier#7096,cfpk_lineitem_partsupp#7097,cpfk_part_lineitem#7098,cfpk_lineitem_part#7099,cpfk_partsupp_lineitem#7100,cfpk_lineitem_orders#7101,cval_lineitem_l_quantity#7102,cval_lineitem_l_extendedprice#7103,cval_lineitem_l_discount#7104,cval_lineitem_l_tax#7105,cval_lineitem_l_returnflag#7106,cval_lineitem_l_linestatus#7107,cval_lineitem_l_commitdate#7108,cval_lineitem_l_receiptdate#7109,cval_lineitem_l_shipinstruct#7110,cval_lineitem_l_shipmode#7111,cval_lineitem_l_comment#7112,cval_lineitem_l_shipdate#7113,cl_quantity#7114,cl_extendedprice#7115,cl_discount#7116,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#7247 AS rid_5#7264, cpfk_customer_orders#7248 AS cpfk_customer_orders_5#7265, cfpk_orders_customer#7249 AS cfpk_orders_customer_5#7266, cval_orders_o_orderstatus#7250 AS cval_orders_o_orderstatus_5#7267, cval_orders_o_totalprice#7251 AS cval_orders_o_totalprice_5#7268, cval_orders_o_orderpriority#7252 AS cval_orders_o_orderpriority_5#7269, cval_orders_o_clerk#7253 AS cval_orders_o_clerk_5#7270, cval_orders_o_shippriority#7254 AS cval_orders_o_shippriority_5#7271, cval_orders_o_comment#7255 AS cval_orders_o_comment_5#7272, cval_orders_o_orderdate#7256 AS cval_orders_o_orderdate_5#7273, co_orderstatus#7257 AS co_orderstatus_5#7274, co_totalprice#7258 AS co_totalprice_5#7275, co_orderpriority#7259 AS co_orderpriority_5#7276, co_clerk#7260 AS co_clerk_5#7277, co_shippriority#7261 AS co_shippriority_5#7278, co_comment#7262 AS co_comment_5#7279, co_orderdate#7263 AS co_orderdate_5#7280]
               +- Relation[rid#7247,cpfk_customer_orders#7248,cfpk_orders_customer#7249,cval_orders_o_orderstatus#7250,cval_orders_o_totalprice#7251,cval_orders_o_orderpriority#7252,cval_orders_o_clerk#7253,cval_orders_o_shippriority#7254,cval_orders_o_comment#7255,cval_orders_o_orderdate#7256,co_orderstatus#7257,co_totalprice#7258,co_orderpriority#7259,co_clerk#7260,co_shippriority#7261,co_comment#7262,co_orderdate#7263] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 161648ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/11 04:20:24 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:20:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7386L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 04:20:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:20:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:20:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:20:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:20:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:20:24 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:20:24 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:20:24 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:20:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:20:25 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:20:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:20:25 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:20:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:20:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:20:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:20:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7386L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#7388 AS rid_0#7405, cval_part_p_name#7389 AS cval_part_p_name_0#7406, cval_part_p_mfgr#7390 AS cval_part_p_mfgr_0#7407, cval_part_p_type#7391 AS cval_part_p_type_0#7408, cval_part_p_size#7392 AS cval_part_p_size_0#7409, cval_part_p_container#7393 AS cval_part_p_container_0#7410, cval_part_p_retailprice#7394 AS cval_part_p_retailprice_0#7411, cval_part_p_comment#7395 AS cval_part_p_comment_0#7412, cval_part_p_brand#7396 AS cval_part_p_brand_0#7413, cp_name#7397 AS cp_name_0#7414, cp_mfgr#7398 AS cp_mfgr_0#7415, cp_type#7399 AS cp_type_0#7416, cp_size#7400 AS cp_size_0#7417, cp_container#7401 AS cp_container_0#7418, cp_retailprice#7402 AS cp_retailprice_0#7419, cp_comment#7403 AS cp_comment_0#7420, cp_brand#7404 AS cp_brand_0#7421]
            :     :     :  :  :  :  +- Relation[rid#7388,cval_part_p_name#7389,cval_part_p_mfgr#7390,cval_part_p_type#7391,cval_part_p_size#7392,cval_part_p_container#7393,cval_part_p_retailprice#7394,cval_part_p_comment#7395,cval_part_p_brand#7396,cp_name#7397,cp_mfgr#7398,cp_type#7399,cp_size#7400,cp_container#7401,cp_retailprice#7402,cp_comment#7403,cp_brand#7404] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#7422 AS rid_0#7439, cval_part_p_name#7423 AS cval_part_p_name_0#7440, cval_part_p_mfgr#7424 AS cval_part_p_mfgr_0#7441, cval_part_p_type#7425 AS cval_part_p_type_0#7442, cval_part_p_size#7426 AS cval_part_p_size_0#7443, cval_part_p_container#7427 AS cval_part_p_container_0#7444, cval_part_p_retailprice#7428 AS cval_part_p_retailprice_0#7445, cval_part_p_comment#7429 AS cval_part_p_comment_0#7446, cval_part_p_brand#7430 AS cval_part_p_brand_0#7447, cp_name#7431 AS cp_name_0#7448, cp_mfgr#7432 AS cp_mfgr_0#7449, cp_type#7433 AS cp_type_0#7450, cp_size#7434 AS cp_size_0#7451, cp_container#7435 AS cp_container_0#7452, cp_retailprice#7436 AS cp_retailprice_0#7453, cp_comment#7437 AS cp_comment_0#7454, cp_brand#7438 AS cp_brand_0#7455]
            :     :     :  :  :        +- Relation[rid#7422,cval_part_p_name#7423,cval_part_p_mfgr#7424,cval_part_p_type#7425,cval_part_p_size#7426,cval_part_p_container#7427,cval_part_p_retailprice#7428,cval_part_p_comment#7429,cval_part_p_brand#7430,cp_name#7431,cp_mfgr#7432,cp_type#7433,cp_size#7434,cp_container#7435,cp_retailprice#7436,cp_comment#7437,cp_brand#7438] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :     :- Project [rid#7522 AS rid_0#7539, cval_part_p_name#7523 AS cval_part_p_name_0#7540, cval_part_p_mfgr#7524 AS cval_part_p_mfgr_0#7541, cval_part_p_type#7525 AS cval_part_p_type_0#7542, cval_part_p_size#7526 AS cval_part_p_size_0#7543, cval_part_p_container#7527 AS cval_part_p_container_0#7544, cval_part_p_retailprice#7528 AS cval_part_p_retailprice_0#7545, cval_part_p_comment#7529 AS cval_part_p_comment_0#7546, cval_part_p_brand#7530 AS cval_part_p_brand_0#7547, cp_name#7531 AS cp_name_0#7548, cp_mfgr#7532 AS cp_mfgr_0#7549, cp_type#7533 AS cp_type_0#7550, cp_size#7534 AS cp_size_0#7551, cp_container#7535 AS cp_container_0#7552, cp_retailprice#7536 AS cp_retailprice_0#7553, cp_comment#7537 AS cp_comment_0#7554, cp_brand#7538 AS cp_brand_0#7555]
            :     :     :  :     :  +- Relation[rid#7522,cval_part_p_name#7523,cval_part_p_mfgr#7524,cval_part_p_type#7525,cval_part_p_size#7526,cval_part_p_container#7527,cval_part_p_retailprice#7528,cval_part_p_comment#7529,cval_part_p_brand#7530,cp_name#7531,cp_mfgr#7532,cp_type#7533,cp_size#7534,cp_container#7535,cp_retailprice#7536,cp_comment#7537,cp_brand#7538] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :     +- Project [rid#7556 AS rid_1#7589, cpfk_orders_lineitem#7557 AS cpfk_orders_lineitem_1#7590, cpfk_supplier_lineitem#7558 AS cpfk_supplier_lineitem_1#7591, cfpk_lineitem_supplier#7559 AS cfpk_lineitem_supplier_1#7592, cfpk_lineitem_partsupp#7560 AS cfpk_lineitem_partsupp_1#7593, cpfk_part_lineitem#7561 AS cpfk_part_lineitem_1#7594, cfpk_lineitem_part#7562 AS cfpk_lineitem_part_1#7595, cpfk_partsupp_lineitem#7563 AS cpfk_partsupp_lineitem_1#7596, cfpk_lineitem_orders#7564 AS cfpk_lineitem_orders_1#7597, cval_lineitem_l_quantity#7565 AS cval_lineitem_l_quantity_1#7598, cval_lineitem_l_extendedprice#7566 AS cval_lineitem_l_extendedprice_1#7599, cval_lineitem_l_discount#7567 AS cval_lineitem_l_discount_1#7600, cval_lineitem_l_tax#7568 AS cval_lineitem_l_tax_1#7601, cval_lineitem_l_returnflag#7569 AS cval_lineitem_l_returnflag_1#7602, cval_lineitem_l_linestatus#7570 AS cval_lineitem_l_linestatus_1#7603, cval_lineitem_l_commitdate#7571 AS cval_lineitem_l_commitdate_1#7604, cval_lineitem_l_receiptdate#7572 AS cval_lineitem_l_receiptdate_1#7605, cval_lineitem_l_shipinstruct#7573 AS cval_lineitem_l_shipinstruct_1#7606, cval_lineitem_l_shipmode#7574 AS cval_lineitem_l_shipmode_1#7607, cval_lineitem_l_comment#7575 AS cval_lineitem_l_comment_1#7608, cval_lineitem_l_shipdate#7576 AS cval_lineitem_l_shipdate_1#7609, cl_quantity#7577 AS cl_quantity_1#7610, cl_extendedprice#7578 AS cl_extendedprice_1#7611, cl_discount#7579 AS cl_discount_1#7612, ... 9 more fields]
            :     :     :  :        +- Relation[rid#7556,cpfk_orders_lineitem#7557,cpfk_supplier_lineitem#7558,cfpk_lineitem_supplier#7559,cfpk_lineitem_partsupp#7560,cpfk_part_lineitem#7561,cfpk_lineitem_part#7562,cpfk_partsupp_lineitem#7563,cfpk_lineitem_orders#7564,cval_lineitem_l_quantity#7565,cval_lineitem_l_extendedprice#7566,cval_lineitem_l_discount#7567,cval_lineitem_l_tax#7568,cval_lineitem_l_returnflag#7569,cval_lineitem_l_linestatus#7570,cval_lineitem_l_commitdate#7571,cval_lineitem_l_receiptdate#7572,cval_lineitem_l_shipinstruct#7573,cval_lineitem_l_shipmode#7574,cval_lineitem_l_comment#7575,cval_lineitem_l_shipdate#7576,cl_quantity#7577,cl_extendedprice#7578,cl_discount#7579,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#7456 AS rid_1#7489, cpfk_orders_lineitem#7457 AS cpfk_orders_lineitem_1#7490, cpfk_supplier_lineitem#7458 AS cpfk_supplier_lineitem_1#7491, cfpk_lineitem_supplier#7459 AS cfpk_lineitem_supplier_1#7492, cfpk_lineitem_partsupp#7460 AS cfpk_lineitem_partsupp_1#7493, cpfk_part_lineitem#7461 AS cpfk_part_lineitem_1#7494, cfpk_lineitem_part#7462 AS cfpk_lineitem_part_1#7495, cpfk_partsupp_lineitem#7463 AS cpfk_partsupp_lineitem_1#7496, cfpk_lineitem_orders#7464 AS cfpk_lineitem_orders_1#7497, cval_lineitem_l_quantity#7465 AS cval_lineitem_l_quantity_1#7498, cval_lineitem_l_extendedprice#7466 AS cval_lineitem_l_extendedprice_1#7499, cval_lineitem_l_discount#7467 AS cval_lineitem_l_discount_1#7500, cval_lineitem_l_tax#7468 AS cval_lineitem_l_tax_1#7501, cval_lineitem_l_returnflag#7469 AS cval_lineitem_l_returnflag_1#7502, cval_lineitem_l_linestatus#7470 AS cval_lineitem_l_linestatus_1#7503, cval_lineitem_l_commitdate#7471 AS cval_lineitem_l_commitdate_1#7504, cval_lineitem_l_receiptdate#7472 AS cval_lineitem_l_receiptdate_1#7505, cval_lineitem_l_shipinstruct#7473 AS cval_lineitem_l_shipinstruct_1#7506, cval_lineitem_l_shipmode#7474 AS cval_lineitem_l_shipmode_1#7507, cval_lineitem_l_comment#7475 AS cval_lineitem_l_comment_1#7508, cval_lineitem_l_shipdate#7476 AS cval_lineitem_l_shipdate_1#7509, cl_quantity#7477 AS cl_quantity_1#7510, cl_extendedprice#7478 AS cl_extendedprice_1#7511, cl_discount#7479 AS cl_discount_1#7512, ... 9 more fields]
            :     :     :     +- Relation[rid#7456,cpfk_orders_lineitem#7457,cpfk_supplier_lineitem#7458,cfpk_lineitem_supplier#7459,cfpk_lineitem_partsupp#7460,cpfk_part_lineitem#7461,cfpk_lineitem_part#7462,cpfk_partsupp_lineitem#7463,cfpk_lineitem_orders#7464,cval_lineitem_l_quantity#7465,cval_lineitem_l_extendedprice#7466,cval_lineitem_l_discount#7467,cval_lineitem_l_tax#7468,cval_lineitem_l_returnflag#7469,cval_lineitem_l_linestatus#7470,cval_lineitem_l_commitdate#7471,cval_lineitem_l_receiptdate#7472,cval_lineitem_l_shipinstruct#7473,cval_lineitem_l_shipmode#7474,cval_lineitem_l_comment#7475,cval_lineitem_l_shipdate#7476,cl_quantity#7477,cl_extendedprice#7478,cl_discount#7479,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#7622 AS rid_2#7635, cpfk_nation_supplier#7623 AS cpfk_nation_supplier_2#7636, cfpk_supplier_nation#7624 AS cfpk_supplier_nation_2#7637, cval_supplier_s_name#7625 AS cval_supplier_s_name_2#7638, cval_supplier_s_address#7626 AS cval_supplier_s_address_2#7639, cval_supplier_s_phone#7627 AS cval_supplier_s_phone_2#7640, cval_supplier_s_acctbal#7628 AS cval_supplier_s_acctbal_2#7641, cval_supplier_s_comment#7629 AS cval_supplier_s_comment_2#7642, cs_name#7630 AS cs_name_2#7643, cs_address#7631 AS cs_address_2#7644, cs_phone#7632 AS cs_phone_2#7645, cs_acctbal#7633 AS cs_acctbal_2#7646, cs_comment#7634 AS cs_comment_2#7647]
            :     :        +- Relation[rid#7622,cpfk_nation_supplier#7623,cfpk_supplier_nation#7624,cval_supplier_s_name#7625,cval_supplier_s_address#7626,cval_supplier_s_phone#7627,cval_supplier_s_acctbal#7628,cval_supplier_s_comment#7629,cs_name#7630,cs_address#7631,cs_phone#7632,cs_acctbal#7633,cs_comment#7634] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#7648 AS rid_3#7655, cpfk_region_nation#7649 AS cpfk_region_nation_3#7656, cfpk_nation_region#7650 AS cfpk_nation_region_3#7657, cval_nation_n_name#7651 AS cval_nation_n_name_3#7658, cval_nation_n_comment#7652 AS cval_nation_n_comment_3#7659, cn_name#7653 AS cn_name_3#7660, cn_comment#7654 AS cn_comment_3#7661]
            :        +- Relation[rid#7648,cpfk_region_nation#7649,cfpk_nation_region#7650,cval_nation_n_name#7651,cval_nation_n_comment#7652,cn_name#7653,cn_comment#7654] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'Join UsingJoin(Inner,List(rid_6))
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#7662 AS rid_4#7667, cval_region_r_name#7663 AS cval_region_r_name_4#7668, cval_region_r_comment#7664 AS cval_region_r_comment_4#7669, cr_name#7665 AS cr_name_4#7670, cr_comment#7666 AS cr_comment_4#7671]
               :  :  :  :  :  :  :  +- Relation[rid#7662,cval_region_r_name#7663,cval_region_r_comment#7664,cr_name#7665,cr_comment#7666] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#7672 AS rid_4#7677, cval_region_r_name#7673 AS cval_region_r_name_4#7678, cval_region_r_comment#7674 AS cval_region_r_comment_4#7679, cr_name#7675 AS cr_name_4#7680, cr_comment#7676 AS cr_comment_4#7681]
               :  :  :  :  :  :        +- Relation[rid#7672,cval_region_r_name#7673,cval_region_r_comment#7674,cr_name#7675,cr_comment#7676] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :     :- Project [rid#7696 AS rid_4#7701, cval_region_r_name#7697 AS cval_region_r_name_4#7702, cval_region_r_comment#7698 AS cval_region_r_comment_4#7703, cr_name#7699 AS cr_name_4#7704, cr_comment#7700 AS cr_comment_4#7705]
               :  :  :  :  :     :  +- Relation[rid#7696,cval_region_r_name#7697,cval_region_r_comment#7698,cr_name#7699,cr_comment#7700] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :     +- Project [rid#7706 AS rid_5#7713, cpfk_region_nation#7707 AS cpfk_region_nation_5#7714, cfpk_nation_region#7708 AS cfpk_nation_region_5#7715, cval_nation_n_name#7709 AS cval_nation_n_name_5#7716, cval_nation_n_comment#7710 AS cval_nation_n_comment_5#7717, cn_name#7711 AS cn_name_5#7718, cn_comment#7712 AS cn_comment_5#7719]
               :  :  :  :  :        +- Relation[rid#7706,cpfk_region_nation#7707,cfpk_nation_region#7708,cval_nation_n_name#7709,cval_nation_n_comment#7710,cn_name#7711,cn_comment#7712] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#7682 AS rid_5#7689, cpfk_region_nation#7683 AS cpfk_region_nation_5#7690, cfpk_nation_region#7684 AS cfpk_nation_region_5#7691, cval_nation_n_name#7685 AS cval_nation_n_name_5#7692, cval_nation_n_comment#7686 AS cval_nation_n_comment_5#7693, cn_name#7687 AS cn_name_5#7694, cn_comment#7688 AS cn_comment_5#7695]
               :  :  :  :     +- Relation[rid#7682,cpfk_region_nation#7683,cfpk_nation_region#7684,cval_nation_n_name#7685,cval_nation_n_comment#7686,cn_name#7687,cn_comment#7688] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :     :- Project [rid#7750 AS rid_5#7757, cpfk_region_nation#7751 AS cpfk_region_nation_5#7758, cfpk_nation_region#7752 AS cfpk_nation_region_5#7759, cval_nation_n_name#7753 AS cval_nation_n_name_5#7760, cval_nation_n_comment#7754 AS cval_nation_n_comment_5#7761, cn_name#7755 AS cn_name_5#7762, cn_comment#7756 AS cn_comment_5#7763]
               :  :  :     :  +- Relation[rid#7750,cpfk_region_nation#7751,cfpk_nation_region#7752,cval_nation_n_name#7753,cval_nation_n_comment#7754,cn_name#7755,cn_comment#7756] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#7764 AS rid_6#7779, cpfk_nation_customer#7765 AS cpfk_nation_customer_6#7780, cfpk_customer_nation#7766 AS cfpk_customer_nation_6#7781, cval_customer_c_name#7767 AS cval_customer_c_name_6#7782, cval_customer_c_address#7768 AS cval_customer_c_address_6#7783, cval_customer_c_phone#7769 AS cval_customer_c_phone_6#7784, cval_customer_c_acctbal#7770 AS cval_customer_c_acctbal_6#7785, cval_customer_c_comment#7771 AS cval_customer_c_comment_6#7786, cval_customer_c_mktsegment#7772 AS cval_customer_c_mktsegment_6#7787, cc_name#7773 AS cc_name_6#7788, cc_address#7774 AS cc_address_6#7789, cc_phone#7775 AS cc_phone_6#7790, cc_acctbal#7776 AS cc_acctbal_6#7791, cc_comment#7777 AS cc_comment_6#7792, cc_mktsegment#7778 AS cc_mktsegment_6#7793]
               :  :  :        +- Relation[rid#7764,cpfk_nation_customer#7765,cfpk_customer_nation#7766,cval_customer_c_name#7767,cval_customer_c_address#7768,cval_customer_c_phone#7769,cval_customer_c_acctbal#7770,cval_customer_c_comment#7771,cval_customer_c_mktsegment#7772,cc_name#7773,cc_address#7774,cc_phone#7775,cc_acctbal#7776,cc_comment#7777,cc_mktsegment#7778] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#7720 AS rid_6#7735, cpfk_nation_customer#7721 AS cpfk_nation_customer_6#7736, cfpk_customer_nation#7722 AS cfpk_customer_nation_6#7737, cval_customer_c_name#7723 AS cval_customer_c_name_6#7738, cval_customer_c_address#7724 AS cval_customer_c_address_6#7739, cval_customer_c_phone#7725 AS cval_customer_c_phone_6#7740, cval_customer_c_acctbal#7726 AS cval_customer_c_acctbal_6#7741, cval_customer_c_comment#7727 AS cval_customer_c_comment_6#7742, cval_customer_c_mktsegment#7728 AS cval_customer_c_mktsegment_6#7743, cc_name#7729 AS cc_name_6#7744, cc_address#7730 AS cc_address_6#7745, cc_phone#7731 AS cc_phone_6#7746, cc_acctbal#7732 AS cc_acctbal_6#7747, cc_comment#7733 AS cc_comment_6#7748, cc_mktsegment#7734 AS cc_mktsegment_6#7749]
               :  :     +- Relation[rid#7720,cpfk_nation_customer#7721,cfpk_customer_nation#7722,cval_customer_c_name#7723,cval_customer_c_address#7724,cval_customer_c_phone#7725,cval_customer_c_acctbal#7726,cval_customer_c_comment#7727,cval_customer_c_mktsegment#7728,cc_name#7729,cc_address#7730,cc_phone#7731,cc_acctbal#7732,cc_comment#7733,cc_mktsegment#7734] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :     :- Project [rid#7828 AS rid_6#7843, cpfk_nation_customer#7829 AS cpfk_nation_customer_6#7844, cfpk_customer_nation#7830 AS cfpk_customer_nation_6#7845, cval_customer_c_name#7831 AS cval_customer_c_name_6#7846, cval_customer_c_address#7832 AS cval_customer_c_address_6#7847, cval_customer_c_phone#7833 AS cval_customer_c_phone_6#7848, cval_customer_c_acctbal#7834 AS cval_customer_c_acctbal_6#7849, cval_customer_c_comment#7835 AS cval_customer_c_comment_6#7850, cval_customer_c_mktsegment#7836 AS cval_customer_c_mktsegment_6#7851, cc_name#7837 AS cc_name_6#7852, cc_address#7838 AS cc_address_6#7853, cc_phone#7839 AS cc_phone_6#7854, cc_acctbal#7840 AS cc_acctbal_6#7855, cc_comment#7841 AS cc_comment_6#7856, cc_mktsegment#7842 AS cc_mktsegment_6#7857]
               :     :  +- Relation[rid#7828,cpfk_nation_customer#7829,cfpk_customer_nation#7830,cval_customer_c_name#7831,cval_customer_c_address#7832,cval_customer_c_phone#7833,cval_customer_c_acctbal#7834,cval_customer_c_comment#7835,cval_customer_c_mktsegment#7836,cc_name#7837,cc_address#7838,cc_phone#7839,cc_acctbal#7840,cc_comment#7841,cc_mktsegment#7842] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#7858 AS rid_7#7875, cpfk_customer_orders#7859 AS cpfk_customer_orders_7#7876, cfpk_orders_customer#7860 AS cfpk_orders_customer_7#7877, cval_orders_o_orderstatus#7861 AS cval_orders_o_orderstatus_7#7878, cval_orders_o_totalprice#7862 AS cval_orders_o_totalprice_7#7879, cval_orders_o_orderpriority#7863 AS cval_orders_o_orderpriority_7#7880, cval_orders_o_clerk#7864 AS cval_orders_o_clerk_7#7881, cval_orders_o_shippriority#7865 AS cval_orders_o_shippriority_7#7882, cval_orders_o_comment#7866 AS cval_orders_o_comment_7#7883, cval_orders_o_orderdate#7867 AS cval_orders_o_orderdate_7#7884, co_orderstatus#7868 AS co_orderstatus_7#7885, co_totalprice#7869 AS co_totalprice_7#7886, co_orderpriority#7870 AS co_orderpriority_7#7887, co_clerk#7871 AS co_clerk_7#7888, co_shippriority#7872 AS co_shippriority_7#7889, co_comment#7873 AS co_comment_7#7890, co_orderdate#7874 AS co_orderdate_7#7891]
               :        +- Relation[rid#7858,cpfk_customer_orders#7859,cfpk_orders_customer#7860,cval_orders_o_orderstatus#7861,cval_orders_o_totalprice#7862,cval_orders_o_orderpriority#7863,cval_orders_o_clerk#7864,cval_orders_o_shippriority#7865,cval_orders_o_comment#7866,cval_orders_o_orderdate#7867,co_orderstatus#7868,co_totalprice#7869,co_orderpriority#7870,co_clerk#7871,co_shippriority#7872,co_comment#7873,co_orderdate#7874] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#7794 AS rid_7#7811, cpfk_customer_orders#7795 AS cpfk_customer_orders_7#7812, cfpk_orders_customer#7796 AS cfpk_orders_customer_7#7813, cval_orders_o_orderstatus#7797 AS cval_orders_o_orderstatus_7#7814, cval_orders_o_totalprice#7798 AS cval_orders_o_totalprice_7#7815, cval_orders_o_orderpriority#7799 AS cval_orders_o_orderpriority_7#7816, cval_orders_o_clerk#7800 AS cval_orders_o_clerk_7#7817, cval_orders_o_shippriority#7801 AS cval_orders_o_shippriority_7#7818, cval_orders_o_comment#7802 AS cval_orders_o_comment_7#7819, cval_orders_o_orderdate#7803 AS cval_orders_o_orderdate_7#7820, co_orderstatus#7804 AS co_orderstatus_7#7821, co_totalprice#7805 AS co_totalprice_7#7822, co_orderpriority#7806 AS co_orderpriority_7#7823, co_clerk#7807 AS co_clerk_7#7824, co_shippriority#7808 AS co_shippriority_7#7825, co_comment#7809 AS co_comment_7#7826, co_orderdate#7810 AS co_orderdate_7#7827]
                  +- Relation[rid#7794,cpfk_customer_orders#7795,cfpk_orders_customer#7796,cval_orders_o_orderstatus#7797,cval_orders_o_totalprice#7798,cval_orders_o_orderpriority#7799,cval_orders_o_clerk#7800,cval_orders_o_shippriority#7801,cval_orders_o_comment#7802,cval_orders_o_orderdate#7803,co_orderstatus#7804,co_totalprice#7805,co_orderpriority#7806,co_clerk#7807,co_shippriority#7808,co_comment#7809,co_orderdate#7810] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 95121ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/11 04:21:59 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:21:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8011L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 04:21:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:21:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:21:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:22:00 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:22:00 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:22:00 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:22:00 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:22:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8011L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#8013 AS rid_0#8030, cval_part_p_name#8014 AS cval_part_p_name_0#8031, cval_part_p_mfgr#8015 AS cval_part_p_mfgr_0#8032, cval_part_p_type#8016 AS cval_part_p_type_0#8033, cval_part_p_size#8017 AS cval_part_p_size_0#8034, cval_part_p_container#8018 AS cval_part_p_container_0#8035, cval_part_p_retailprice#8019 AS cval_part_p_retailprice_0#8036, cval_part_p_comment#8020 AS cval_part_p_comment_0#8037, cval_part_p_brand#8021 AS cval_part_p_brand_0#8038, cp_name#8022 AS cp_name_0#8039, cp_mfgr#8023 AS cp_mfgr_0#8040, cp_type#8024 AS cp_type_0#8041, cp_size#8025 AS cp_size_0#8042, cp_container#8026 AS cp_container_0#8043, cp_retailprice#8027 AS cp_retailprice_0#8044, cp_comment#8028 AS cp_comment_0#8045, cp_brand#8029 AS cp_brand_0#8046]
         :  :  :  :  +- Relation[rid#8013,cval_part_p_name#8014,cval_part_p_mfgr#8015,cval_part_p_type#8016,cval_part_p_size#8017,cval_part_p_container#8018,cval_part_p_retailprice#8019,cval_part_p_comment#8020,cval_part_p_brand#8021,cp_name#8022,cp_mfgr#8023,cp_type#8024,cp_size#8025,cp_container#8026,cp_retailprice#8027,cp_comment#8028,cp_brand#8029] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#8047 AS rid_0#8064, cval_part_p_name#8048 AS cval_part_p_name_0#8065, cval_part_p_mfgr#8049 AS cval_part_p_mfgr_0#8066, cval_part_p_type#8050 AS cval_part_p_type_0#8067, cval_part_p_size#8051 AS cval_part_p_size_0#8068, cval_part_p_container#8052 AS cval_part_p_container_0#8069, cval_part_p_retailprice#8053 AS cval_part_p_retailprice_0#8070, cval_part_p_comment#8054 AS cval_part_p_comment_0#8071, cval_part_p_brand#8055 AS cval_part_p_brand_0#8072, cp_name#8056 AS cp_name_0#8073, cp_mfgr#8057 AS cp_mfgr_0#8074, cp_type#8058 AS cp_type_0#8075, cp_size#8059 AS cp_size_0#8076, cp_container#8060 AS cp_container_0#8077, cp_retailprice#8061 AS cp_retailprice_0#8078, cp_comment#8062 AS cp_comment_0#8079, cp_brand#8063 AS cp_brand_0#8080]
         :  :  :        +- Relation[rid#8047,cval_part_p_name#8048,cval_part_p_mfgr#8049,cval_part_p_type#8050,cval_part_p_size#8051,cval_part_p_container#8052,cval_part_p_retailprice#8053,cval_part_p_comment#8054,cval_part_p_brand#8055,cp_name#8056,cp_mfgr#8057,cp_type#8058,cp_size#8059,cp_container#8060,cp_retailprice#8061,cp_comment#8062,cp_brand#8063] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#8081 AS rid_0#8098, cval_part_p_name#8082 AS cval_part_p_name_0#8099, cval_part_p_mfgr#8083 AS cval_part_p_mfgr_0#8100, cval_part_p_type#8084 AS cval_part_p_type_0#8101, cval_part_p_size#8085 AS cval_part_p_size_0#8102, cval_part_p_container#8086 AS cval_part_p_container_0#8103, cval_part_p_retailprice#8087 AS cval_part_p_retailprice_0#8104, cval_part_p_comment#8088 AS cval_part_p_comment_0#8105, cval_part_p_brand#8089 AS cval_part_p_brand_0#8106, cp_name#8090 AS cp_name_0#8107, cp_mfgr#8091 AS cp_mfgr_0#8108, cp_type#8092 AS cp_type_0#8109, cp_size#8093 AS cp_size_0#8110, cp_container#8094 AS cp_container_0#8111, cp_retailprice#8095 AS cp_retailprice_0#8112, cp_comment#8096 AS cp_comment_0#8113, cp_brand#8097 AS cp_brand_0#8114]
         :  :        +- Relation[rid#8081,cval_part_p_name#8082,cval_part_p_mfgr#8083,cval_part_p_type#8084,cval_part_p_size#8085,cval_part_p_container#8086,cval_part_p_retailprice#8087,cval_part_p_comment#8088,cval_part_p_brand#8089,cp_name#8090,cp_mfgr#8091,cp_type#8092,cp_size#8093,cp_container#8094,cp_retailprice#8095,cp_comment#8096,cp_brand#8097] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#8313 AS rid_0#8330, cval_part_p_name#8314 AS cval_part_p_name_0#8331, cval_part_p_mfgr#8315 AS cval_part_p_mfgr_0#8332, cval_part_p_type#8316 AS cval_part_p_type_0#8333, cval_part_p_size#8317 AS cval_part_p_size_0#8334, cval_part_p_container#8318 AS cval_part_p_container_0#8335, cval_part_p_retailprice#8319 AS cval_part_p_retailprice_0#8336, cval_part_p_comment#8320 AS cval_part_p_comment_0#8337, cval_part_p_brand#8321 AS cval_part_p_brand_0#8338, cp_name#8322 AS cp_name_0#8339, cp_mfgr#8323 AS cp_mfgr_0#8340, cp_type#8324 AS cp_type_0#8341, cp_size#8325 AS cp_size_0#8342, cp_container#8326 AS cp_container_0#8343, cp_retailprice#8327 AS cp_retailprice_0#8344, cp_comment#8328 AS cp_comment_0#8345, cp_brand#8329 AS cp_brand_0#8346]
         :     :  +- Relation[rid#8313,cval_part_p_name#8314,cval_part_p_mfgr#8315,cval_part_p_type#8316,cval_part_p_size#8317,cval_part_p_container#8318,cval_part_p_retailprice#8319,cval_part_p_comment#8320,cval_part_p_brand#8321,cp_name#8322,cp_mfgr#8323,cp_type#8324,cp_size#8325,cp_container#8326,cp_retailprice#8327,cp_comment#8328,cp_brand#8329] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#8347 AS rid_1#8380, cpfk_orders_lineitem#8348 AS cpfk_orders_lineitem_1#8381, cpfk_supplier_lineitem#8349 AS cpfk_supplier_lineitem_1#8382, cfpk_lineitem_supplier#8350 AS cfpk_lineitem_supplier_1#8383, cfpk_lineitem_partsupp#8351 AS cfpk_lineitem_partsupp_1#8384, cpfk_part_lineitem#8352 AS cpfk_part_lineitem_1#8385, cfpk_lineitem_part#8353 AS cfpk_lineitem_part_1#8386, cpfk_partsupp_lineitem#8354 AS cpfk_partsupp_lineitem_1#8387, cfpk_lineitem_orders#8355 AS cfpk_lineitem_orders_1#8388, cval_lineitem_l_quantity#8356 AS cval_lineitem_l_quantity_1#8389, cval_lineitem_l_extendedprice#8357 AS cval_lineitem_l_extendedprice_1#8390, cval_lineitem_l_discount#8358 AS cval_lineitem_l_discount_1#8391, cval_lineitem_l_tax#8359 AS cval_lineitem_l_tax_1#8392, cval_lineitem_l_returnflag#8360 AS cval_lineitem_l_returnflag_1#8393, cval_lineitem_l_linestatus#8361 AS cval_lineitem_l_linestatus_1#8394, cval_lineitem_l_commitdate#8362 AS cval_lineitem_l_commitdate_1#8395, cval_lineitem_l_receiptdate#8363 AS cval_lineitem_l_receiptdate_1#8396, cval_lineitem_l_shipinstruct#8364 AS cval_lineitem_l_shipinstruct_1#8397, cval_lineitem_l_shipmode#8365 AS cval_lineitem_l_shipmode_1#8398, cval_lineitem_l_comment#8366 AS cval_lineitem_l_comment_1#8399, cval_lineitem_l_shipdate#8367 AS cval_lineitem_l_shipdate_1#8400, cl_quantity#8368 AS cl_quantity_1#8401, cl_extendedprice#8369 AS cl_extendedprice_1#8402, cl_discount#8370 AS cl_discount_1#8403, ... 9 more fields]
         :        +- Relation[rid#8347,cpfk_orders_lineitem#8348,cpfk_supplier_lineitem#8349,cfpk_lineitem_supplier#8350,cfpk_lineitem_partsupp#8351,cpfk_part_lineitem#8352,cfpk_lineitem_part#8353,cpfk_partsupp_lineitem#8354,cfpk_lineitem_orders#8355,cval_lineitem_l_quantity#8356,cval_lineitem_l_extendedprice#8357,cval_lineitem_l_discount#8358,cval_lineitem_l_tax#8359,cval_lineitem_l_returnflag#8360,cval_lineitem_l_linestatus#8361,cval_lineitem_l_commitdate#8362,cval_lineitem_l_receiptdate#8363,cval_lineitem_l_shipinstruct#8364,cval_lineitem_l_shipmode#8365,cval_lineitem_l_comment#8366,cval_lineitem_l_shipdate#8367,cl_quantity#8368,cl_extendedprice#8369,cl_discount#8370,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#8115 AS rid_1#8148, cpfk_orders_lineitem#8116 AS cpfk_orders_lineitem_1#8149, cpfk_supplier_lineitem#8117 AS cpfk_supplier_lineitem_1#8150, cfpk_lineitem_supplier#8118 AS cfpk_lineitem_supplier_1#8151, cfpk_lineitem_partsupp#8119 AS cfpk_lineitem_partsupp_1#8152, cpfk_part_lineitem#8120 AS cpfk_part_lineitem_1#8153, cfpk_lineitem_part#8121 AS cfpk_lineitem_part_1#8154, cpfk_partsupp_lineitem#8122 AS cpfk_partsupp_lineitem_1#8155, cfpk_lineitem_orders#8123 AS cfpk_lineitem_orders_1#8156, cval_lineitem_l_quantity#8124 AS cval_lineitem_l_quantity_1#8157, cval_lineitem_l_extendedprice#8125 AS cval_lineitem_l_extendedprice_1#8158, cval_lineitem_l_discount#8126 AS cval_lineitem_l_discount_1#8159, cval_lineitem_l_tax#8127 AS cval_lineitem_l_tax_1#8160, cval_lineitem_l_returnflag#8128 AS cval_lineitem_l_returnflag_1#8161, cval_lineitem_l_linestatus#8129 AS cval_lineitem_l_linestatus_1#8162, cval_lineitem_l_commitdate#8130 AS cval_lineitem_l_commitdate_1#8163, cval_lineitem_l_receiptdate#8131 AS cval_lineitem_l_receiptdate_1#8164, cval_lineitem_l_shipinstruct#8132 AS cval_lineitem_l_shipinstruct_1#8165, cval_lineitem_l_shipmode#8133 AS cval_lineitem_l_shipmode_1#8166, cval_lineitem_l_comment#8134 AS cval_lineitem_l_comment_1#8167, cval_lineitem_l_shipdate#8135 AS cval_lineitem_l_shipdate_1#8168, cl_quantity#8136 AS cl_quantity_1#8169, cl_extendedprice#8137 AS cl_extendedprice_1#8170, cl_discount#8138 AS cl_discount_1#8171, ... 9 more fields]
            :  :  +- Relation[rid#8115,cpfk_orders_lineitem#8116,cpfk_supplier_lineitem#8117,cfpk_lineitem_supplier#8118,cfpk_lineitem_partsupp#8119,cpfk_part_lineitem#8120,cfpk_lineitem_part#8121,cpfk_partsupp_lineitem#8122,cfpk_lineitem_orders#8123,cval_lineitem_l_quantity#8124,cval_lineitem_l_extendedprice#8125,cval_lineitem_l_discount#8126,cval_lineitem_l_tax#8127,cval_lineitem_l_returnflag#8128,cval_lineitem_l_linestatus#8129,cval_lineitem_l_commitdate#8130,cval_lineitem_l_receiptdate#8131,cval_lineitem_l_shipinstruct#8132,cval_lineitem_l_shipmode#8133,cval_lineitem_l_comment#8134,cval_lineitem_l_shipdate#8135,cl_quantity#8136,cl_extendedprice#8137,cl_discount#8138,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#8181 AS rid_1#8214, cpfk_orders_lineitem#8182 AS cpfk_orders_lineitem_1#8215, cpfk_supplier_lineitem#8183 AS cpfk_supplier_lineitem_1#8216, cfpk_lineitem_supplier#8184 AS cfpk_lineitem_supplier_1#8217, cfpk_lineitem_partsupp#8185 AS cfpk_lineitem_partsupp_1#8218, cpfk_part_lineitem#8186 AS cpfk_part_lineitem_1#8219, cfpk_lineitem_part#8187 AS cfpk_lineitem_part_1#8220, cpfk_partsupp_lineitem#8188 AS cpfk_partsupp_lineitem_1#8221, cfpk_lineitem_orders#8189 AS cfpk_lineitem_orders_1#8222, cval_lineitem_l_quantity#8190 AS cval_lineitem_l_quantity_1#8223, cval_lineitem_l_extendedprice#8191 AS cval_lineitem_l_extendedprice_1#8224, cval_lineitem_l_discount#8192 AS cval_lineitem_l_discount_1#8225, cval_lineitem_l_tax#8193 AS cval_lineitem_l_tax_1#8226, cval_lineitem_l_returnflag#8194 AS cval_lineitem_l_returnflag_1#8227, cval_lineitem_l_linestatus#8195 AS cval_lineitem_l_linestatus_1#8228, cval_lineitem_l_commitdate#8196 AS cval_lineitem_l_commitdate_1#8229, cval_lineitem_l_receiptdate#8197 AS cval_lineitem_l_receiptdate_1#8230, cval_lineitem_l_shipinstruct#8198 AS cval_lineitem_l_shipinstruct_1#8231, cval_lineitem_l_shipmode#8199 AS cval_lineitem_l_shipmode_1#8232, cval_lineitem_l_comment#8200 AS cval_lineitem_l_comment_1#8233, cval_lineitem_l_shipdate#8201 AS cval_lineitem_l_shipdate_1#8234, cl_quantity#8202 AS cl_quantity_1#8235, cl_extendedprice#8203 AS cl_extendedprice_1#8236, cl_discount#8204 AS cl_discount_1#8237, ... 9 more fields]
            :        +- Relation[rid#8181,cpfk_orders_lineitem#8182,cpfk_supplier_lineitem#8183,cfpk_lineitem_supplier#8184,cfpk_lineitem_partsupp#8185,cpfk_part_lineitem#8186,cfpk_lineitem_part#8187,cpfk_partsupp_lineitem#8188,cfpk_lineitem_orders#8189,cval_lineitem_l_quantity#8190,cval_lineitem_l_extendedprice#8191,cval_lineitem_l_discount#8192,cval_lineitem_l_tax#8193,cval_lineitem_l_returnflag#8194,cval_lineitem_l_linestatus#8195,cval_lineitem_l_commitdate#8196,cval_lineitem_l_receiptdate#8197,cval_lineitem_l_shipinstruct#8198,cval_lineitem_l_shipmode#8199,cval_lineitem_l_comment#8200,cval_lineitem_l_shipdate#8201,cl_quantity#8202,cl_extendedprice#8203,cl_discount#8204,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#8247 AS rid_1#8280, cpfk_orders_lineitem#8248 AS cpfk_orders_lineitem_1#8281, cpfk_supplier_lineitem#8249 AS cpfk_supplier_lineitem_1#8282, cfpk_lineitem_supplier#8250 AS cfpk_lineitem_supplier_1#8283, cfpk_lineitem_partsupp#8251 AS cfpk_lineitem_partsupp_1#8284, cpfk_part_lineitem#8252 AS cpfk_part_lineitem_1#8285, cfpk_lineitem_part#8253 AS cfpk_lineitem_part_1#8286, cpfk_partsupp_lineitem#8254 AS cpfk_partsupp_lineitem_1#8287, cfpk_lineitem_orders#8255 AS cfpk_lineitem_orders_1#8288, cval_lineitem_l_quantity#8256 AS cval_lineitem_l_quantity_1#8289, cval_lineitem_l_extendedprice#8257 AS cval_lineitem_l_extendedprice_1#8290, cval_lineitem_l_discount#8258 AS cval_lineitem_l_discount_1#8291, cval_lineitem_l_tax#8259 AS cval_lineitem_l_tax_1#8292, cval_lineitem_l_returnflag#8260 AS cval_lineitem_l_returnflag_1#8293, cval_lineitem_l_linestatus#8261 AS cval_lineitem_l_linestatus_1#8294, cval_lineitem_l_commitdate#8262 AS cval_lineitem_l_commitdate_1#8295, cval_lineitem_l_receiptdate#8263 AS cval_lineitem_l_receiptdate_1#8296, cval_lineitem_l_shipinstruct#8264 AS cval_lineitem_l_shipinstruct_1#8297, cval_lineitem_l_shipmode#8265 AS cval_lineitem_l_shipmode_1#8298, cval_lineitem_l_comment#8266 AS cval_lineitem_l_comment_1#8299, cval_lineitem_l_shipdate#8267 AS cval_lineitem_l_shipdate_1#8300, cl_quantity#8268 AS cl_quantity_1#8301, cl_extendedprice#8269 AS cl_extendedprice_1#8302, cl_discount#8270 AS cl_discount_1#8303, ... 9 more fields]
                  +- Relation[rid#8247,cpfk_orders_lineitem#8248,cpfk_supplier_lineitem#8249,cfpk_lineitem_supplier#8250,cfpk_lineitem_partsupp#8251,cpfk_part_lineitem#8252,cfpk_lineitem_part#8253,cpfk_partsupp_lineitem#8254,cfpk_lineitem_orders#8255,cval_lineitem_l_quantity#8256,cval_lineitem_l_extendedprice#8257,cval_lineitem_l_discount#8258,cval_lineitem_l_tax#8259,cval_lineitem_l_returnflag#8260,cval_lineitem_l_linestatus#8261,cval_lineitem_l_commitdate#8262,cval_lineitem_l_receiptdate#8263,cval_lineitem_l_shipinstruct#8264,cval_lineitem_l_shipmode#8265,cval_lineitem_l_comment#8266,cval_lineitem_l_shipdate#8267,cl_quantity#8268,cl_extendedprice#8269,cl_discount#8270,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 361277ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/11 04:28:01 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:28:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8471L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 04:28:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:28:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:28:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:28:01 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:28:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:28:01 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:28:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:28:01 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:28:01 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:28:01 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:28:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:28:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:28:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:28:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:28:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:28:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8471L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#8473 AS rid_0#8480, cpfk_region_nation#8474 AS cpfk_region_nation_0#8481, cfpk_nation_region#8475 AS cfpk_nation_region_0#8482, cval_nation_n_name#8476 AS cval_nation_n_name_0#8483, cval_nation_n_comment#8477 AS cval_nation_n_comment_0#8484, cn_name#8478 AS cn_name_0#8485, cn_comment#8479 AS cn_comment_0#8486]
            :  :  :  :  :  :  +- Relation[rid#8473,cpfk_region_nation#8474,cfpk_nation_region#8475,cval_nation_n_name#8476,cval_nation_n_comment#8477,cn_name#8478,cn_comment#8479] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#8487 AS rid_0#8494, cpfk_region_nation#8488 AS cpfk_region_nation_0#8495, cfpk_nation_region#8489 AS cfpk_nation_region_0#8496, cval_nation_n_name#8490 AS cval_nation_n_name_0#8497, cval_nation_n_comment#8491 AS cval_nation_n_comment_0#8498, cn_name#8492 AS cn_name_0#8499, cn_comment#8493 AS cn_comment_0#8500]
            :  :  :  :  :        +- Relation[rid#8487,cpfk_region_nation#8488,cfpk_nation_region#8489,cval_nation_n_name#8490,cval_nation_n_comment#8491,cn_name#8492,cn_comment#8493] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :     :- Project [rid#8527 AS rid_0#8534, cpfk_region_nation#8528 AS cpfk_region_nation_0#8535, cfpk_nation_region#8529 AS cfpk_nation_region_0#8536, cval_nation_n_name#8530 AS cval_nation_n_name_0#8537, cval_nation_n_comment#8531 AS cval_nation_n_comment_0#8538, cn_name#8532 AS cn_name_0#8539, cn_comment#8533 AS cn_comment_0#8540]
            :  :  :  :     :  +- Relation[rid#8527,cpfk_region_nation#8528,cfpk_nation_region#8529,cval_nation_n_name#8530,cval_nation_n_comment#8531,cn_name#8532,cn_comment#8533] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :     +- Project [rid#8541 AS rid_1#8554, cpfk_nation_supplier#8542 AS cpfk_nation_supplier_1#8555, cfpk_supplier_nation#8543 AS cfpk_supplier_nation_1#8556, cval_supplier_s_name#8544 AS cval_supplier_s_name_1#8557, cval_supplier_s_address#8545 AS cval_supplier_s_address_1#8558, cval_supplier_s_phone#8546 AS cval_supplier_s_phone_1#8559, cval_supplier_s_acctbal#8547 AS cval_supplier_s_acctbal_1#8560, cval_supplier_s_comment#8548 AS cval_supplier_s_comment_1#8561, cs_name#8549 AS cs_name_1#8562, cs_address#8550 AS cs_address_1#8563, cs_phone#8551 AS cs_phone_1#8564, cs_acctbal#8552 AS cs_acctbal_1#8565, cs_comment#8553 AS cs_comment_1#8566]
            :  :  :  :        +- Relation[rid#8541,cpfk_nation_supplier#8542,cfpk_supplier_nation#8543,cval_supplier_s_name#8544,cval_supplier_s_address#8545,cval_supplier_s_phone#8546,cval_supplier_s_acctbal#8547,cval_supplier_s_comment#8548,cs_name#8549,cs_address#8550,cs_phone#8551,cs_acctbal#8552,cs_comment#8553] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#8501 AS rid_1#8514, cpfk_nation_supplier#8502 AS cpfk_nation_supplier_1#8515, cfpk_supplier_nation#8503 AS cfpk_supplier_nation_1#8516, cval_supplier_s_name#8504 AS cval_supplier_s_name_1#8517, cval_supplier_s_address#8505 AS cval_supplier_s_address_1#8518, cval_supplier_s_phone#8506 AS cval_supplier_s_phone_1#8519, cval_supplier_s_acctbal#8507 AS cval_supplier_s_acctbal_1#8520, cval_supplier_s_comment#8508 AS cval_supplier_s_comment_1#8521, cs_name#8509 AS cs_name_1#8522, cs_address#8510 AS cs_address_1#8523, cs_phone#8511 AS cs_phone_1#8524, cs_acctbal#8512 AS cs_acctbal_1#8525, cs_comment#8513 AS cs_comment_1#8526]
            :  :  :     +- Relation[rid#8501,cpfk_nation_supplier#8502,cfpk_supplier_nation#8503,cval_supplier_s_name#8504,cval_supplier_s_address#8505,cval_supplier_s_phone#8506,cval_supplier_s_acctbal#8507,cval_supplier_s_comment#8508,cs_name#8509,cs_address#8510,cs_phone#8511,cs_acctbal#8512,cs_comment#8513] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :     :- Project [rid#8633 AS rid_1#8646, cpfk_nation_supplier#8634 AS cpfk_nation_supplier_1#8647, cfpk_supplier_nation#8635 AS cfpk_supplier_nation_1#8648, cval_supplier_s_name#8636 AS cval_supplier_s_name_1#8649, cval_supplier_s_address#8637 AS cval_supplier_s_address_1#8650, cval_supplier_s_phone#8638 AS cval_supplier_s_phone_1#8651, cval_supplier_s_acctbal#8639 AS cval_supplier_s_acctbal_1#8652, cval_supplier_s_comment#8640 AS cval_supplier_s_comment_1#8653, cs_name#8641 AS cs_name_1#8654, cs_address#8642 AS cs_address_1#8655, cs_phone#8643 AS cs_phone_1#8656, cs_acctbal#8644 AS cs_acctbal_1#8657, cs_comment#8645 AS cs_comment_1#8658]
            :  :     :  +- Relation[rid#8633,cpfk_nation_supplier#8634,cfpk_supplier_nation#8635,cval_supplier_s_name#8636,cval_supplier_s_address#8637,cval_supplier_s_phone#8638,cval_supplier_s_acctbal#8639,cval_supplier_s_comment#8640,cs_name#8641,cs_address#8642,cs_phone#8643,cs_acctbal#8644,cs_comment#8645] JDBCRelation(tsupplier) [numPartitions=1]
            :  :     +- Project [rid#8659 AS rid_2#8692, cpfk_orders_lineitem#8660 AS cpfk_orders_lineitem_2#8693, cpfk_supplier_lineitem#8661 AS cpfk_supplier_lineitem_2#8694, cfpk_lineitem_supplier#8662 AS cfpk_lineitem_supplier_2#8695, cfpk_lineitem_partsupp#8663 AS cfpk_lineitem_partsupp_2#8696, cpfk_part_lineitem#8664 AS cpfk_part_lineitem_2#8697, cfpk_lineitem_part#8665 AS cfpk_lineitem_part_2#8698, cpfk_partsupp_lineitem#8666 AS cpfk_partsupp_lineitem_2#8699, cfpk_lineitem_orders#8667 AS cfpk_lineitem_orders_2#8700, cval_lineitem_l_quantity#8668 AS cval_lineitem_l_quantity_2#8701, cval_lineitem_l_extendedprice#8669 AS cval_lineitem_l_extendedprice_2#8702, cval_lineitem_l_discount#8670 AS cval_lineitem_l_discount_2#8703, cval_lineitem_l_tax#8671 AS cval_lineitem_l_tax_2#8704, cval_lineitem_l_returnflag#8672 AS cval_lineitem_l_returnflag_2#8705, cval_lineitem_l_linestatus#8673 AS cval_lineitem_l_linestatus_2#8706, cval_lineitem_l_commitdate#8674 AS cval_lineitem_l_commitdate_2#8707, cval_lineitem_l_receiptdate#8675 AS cval_lineitem_l_receiptdate_2#8708, cval_lineitem_l_shipinstruct#8676 AS cval_lineitem_l_shipinstruct_2#8709, cval_lineitem_l_shipmode#8677 AS cval_lineitem_l_shipmode_2#8710, cval_lineitem_l_comment#8678 AS cval_lineitem_l_comment_2#8711, cval_lineitem_l_shipdate#8679 AS cval_lineitem_l_shipdate_2#8712, cl_quantity#8680 AS cl_quantity_2#8713, cl_extendedprice#8681 AS cl_extendedprice_2#8714, cl_discount#8682 AS cl_discount_2#8715, ... 9 more fields]
            :  :        +- Relation[rid#8659,cpfk_orders_lineitem#8660,cpfk_supplier_lineitem#8661,cfpk_lineitem_supplier#8662,cfpk_lineitem_partsupp#8663,cpfk_part_lineitem#8664,cfpk_lineitem_part#8665,cpfk_partsupp_lineitem#8666,cfpk_lineitem_orders#8667,cval_lineitem_l_quantity#8668,cval_lineitem_l_extendedprice#8669,cval_lineitem_l_discount#8670,cval_lineitem_l_tax#8671,cval_lineitem_l_returnflag#8672,cval_lineitem_l_linestatus#8673,cval_lineitem_l_commitdate#8674,cval_lineitem_l_receiptdate#8675,cval_lineitem_l_shipinstruct#8676,cval_lineitem_l_shipmode#8677,cval_lineitem_l_comment#8678,cval_lineitem_l_shipdate#8679,cl_quantity#8680,cl_extendedprice#8681,cl_discount#8682,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#8567 AS rid_2#8600, cpfk_orders_lineitem#8568 AS cpfk_orders_lineitem_2#8601, cpfk_supplier_lineitem#8569 AS cpfk_supplier_lineitem_2#8602, cfpk_lineitem_supplier#8570 AS cfpk_lineitem_supplier_2#8603, cfpk_lineitem_partsupp#8571 AS cfpk_lineitem_partsupp_2#8604, cpfk_part_lineitem#8572 AS cpfk_part_lineitem_2#8605, cfpk_lineitem_part#8573 AS cfpk_lineitem_part_2#8606, cpfk_partsupp_lineitem#8574 AS cpfk_partsupp_lineitem_2#8607, cfpk_lineitem_orders#8575 AS cfpk_lineitem_orders_2#8608, cval_lineitem_l_quantity#8576 AS cval_lineitem_l_quantity_2#8609, cval_lineitem_l_extendedprice#8577 AS cval_lineitem_l_extendedprice_2#8610, cval_lineitem_l_discount#8578 AS cval_lineitem_l_discount_2#8611, cval_lineitem_l_tax#8579 AS cval_lineitem_l_tax_2#8612, cval_lineitem_l_returnflag#8580 AS cval_lineitem_l_returnflag_2#8613, cval_lineitem_l_linestatus#8581 AS cval_lineitem_l_linestatus_2#8614, cval_lineitem_l_commitdate#8582 AS cval_lineitem_l_commitdate_2#8615, cval_lineitem_l_receiptdate#8583 AS cval_lineitem_l_receiptdate_2#8616, cval_lineitem_l_shipinstruct#8584 AS cval_lineitem_l_shipinstruct_2#8617, cval_lineitem_l_shipmode#8585 AS cval_lineitem_l_shipmode_2#8618, cval_lineitem_l_comment#8586 AS cval_lineitem_l_comment_2#8619, cval_lineitem_l_shipdate#8587 AS cval_lineitem_l_shipdate_2#8620, cl_quantity#8588 AS cl_quantity_2#8621, cl_extendedprice#8589 AS cl_extendedprice_2#8622, cl_discount#8590 AS cl_discount_2#8623, ... 9 more fields]
            :     +- Relation[rid#8567,cpfk_orders_lineitem#8568,cpfk_supplier_lineitem#8569,cfpk_lineitem_supplier#8570,cfpk_lineitem_partsupp#8571,cpfk_part_lineitem#8572,cfpk_lineitem_part#8573,cpfk_partsupp_lineitem#8574,cfpk_lineitem_orders#8575,cval_lineitem_l_quantity#8576,cval_lineitem_l_extendedprice#8577,cval_lineitem_l_discount#8578,cval_lineitem_l_tax#8579,cval_lineitem_l_returnflag#8580,cval_lineitem_l_linestatus#8581,cval_lineitem_l_commitdate#8582,cval_lineitem_l_receiptdate#8583,cval_lineitem_l_shipinstruct#8584,cval_lineitem_l_shipmode#8585,cval_lineitem_l_comment#8586,cval_lineitem_l_shipdate#8587,cl_quantity#8588,cl_extendedprice#8589,cl_discount#8590,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'Join UsingJoin(Inner,List(rid_4))
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'Join UsingJoin(Inner,List(rid_3))
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#8725 AS rid_3#8732, cpfk_region_nation#8726 AS cpfk_region_nation_3#8733, cfpk_nation_region#8727 AS cfpk_nation_region_3#8734, cval_nation_n_name#8728 AS cval_nation_n_name_3#8735, cval_nation_n_comment#8729 AS cval_nation_n_comment_3#8736, cn_name#8730 AS cn_name_3#8737, cn_comment#8731 AS cn_comment_3#8738]
               :  :  :  :  :  +- Relation[rid#8725,cpfk_region_nation#8726,cfpk_nation_region#8727,cval_nation_n_name#8728,cval_nation_n_comment#8729,cn_name#8730,cn_comment#8731] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#8739 AS rid_3#8746, cpfk_region_nation#8740 AS cpfk_region_nation_3#8747, cfpk_nation_region#8741 AS cfpk_nation_region_3#8748, cval_nation_n_name#8742 AS cval_nation_n_name_3#8749, cval_nation_n_comment#8743 AS cval_nation_n_comment_3#8750, cn_name#8744 AS cn_name_3#8751, cn_comment#8745 AS cn_comment_3#8752]
               :  :  :  :        +- Relation[rid#8739,cpfk_region_nation#8740,cfpk_nation_region#8741,cval_nation_n_name#8742,cval_nation_n_comment#8743,cn_name#8744,cn_comment#8745] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :     :- Project [rid#8783 AS rid_3#8790, cpfk_region_nation#8784 AS cpfk_region_nation_3#8791, cfpk_nation_region#8785 AS cfpk_nation_region_3#8792, cval_nation_n_name#8786 AS cval_nation_n_name_3#8793, cval_nation_n_comment#8787 AS cval_nation_n_comment_3#8794, cn_name#8788 AS cn_name_3#8795, cn_comment#8789 AS cn_comment_3#8796]
               :  :  :     :  +- Relation[rid#8783,cpfk_region_nation#8784,cfpk_nation_region#8785,cval_nation_n_name#8786,cval_nation_n_comment#8787,cn_name#8788,cn_comment#8789] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#8797 AS rid_4#8812, cpfk_nation_customer#8798 AS cpfk_nation_customer_4#8813, cfpk_customer_nation#8799 AS cfpk_customer_nation_4#8814, cval_customer_c_name#8800 AS cval_customer_c_name_4#8815, cval_customer_c_address#8801 AS cval_customer_c_address_4#8816, cval_customer_c_phone#8802 AS cval_customer_c_phone_4#8817, cval_customer_c_acctbal#8803 AS cval_customer_c_acctbal_4#8818, cval_customer_c_comment#8804 AS cval_customer_c_comment_4#8819, cval_customer_c_mktsegment#8805 AS cval_customer_c_mktsegment_4#8820, cc_name#8806 AS cc_name_4#8821, cc_address#8807 AS cc_address_4#8822, cc_phone#8808 AS cc_phone_4#8823, cc_acctbal#8809 AS cc_acctbal_4#8824, cc_comment#8810 AS cc_comment_4#8825, cc_mktsegment#8811 AS cc_mktsegment_4#8826]
               :  :  :        +- Relation[rid#8797,cpfk_nation_customer#8798,cfpk_customer_nation#8799,cval_customer_c_name#8800,cval_customer_c_address#8801,cval_customer_c_phone#8802,cval_customer_c_acctbal#8803,cval_customer_c_comment#8804,cval_customer_c_mktsegment#8805,cc_name#8806,cc_address#8807,cc_phone#8808,cc_acctbal#8809,cc_comment#8810,cc_mktsegment#8811] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#8753 AS rid_4#8768, cpfk_nation_customer#8754 AS cpfk_nation_customer_4#8769, cfpk_customer_nation#8755 AS cfpk_customer_nation_4#8770, cval_customer_c_name#8756 AS cval_customer_c_name_4#8771, cval_customer_c_address#8757 AS cval_customer_c_address_4#8772, cval_customer_c_phone#8758 AS cval_customer_c_phone_4#8773, cval_customer_c_acctbal#8759 AS cval_customer_c_acctbal_4#8774, cval_customer_c_comment#8760 AS cval_customer_c_comment_4#8775, cval_customer_c_mktsegment#8761 AS cval_customer_c_mktsegment_4#8776, cc_name#8762 AS cc_name_4#8777, cc_address#8763 AS cc_address_4#8778, cc_phone#8764 AS cc_phone_4#8779, cc_acctbal#8765 AS cc_acctbal_4#8780, cc_comment#8766 AS cc_comment_4#8781, cc_mktsegment#8767 AS cc_mktsegment_4#8782]
               :  :     +- Relation[rid#8753,cpfk_nation_customer#8754,cfpk_customer_nation#8755,cval_customer_c_name#8756,cval_customer_c_address#8757,cval_customer_c_phone#8758,cval_customer_c_acctbal#8759,cval_customer_c_comment#8760,cval_customer_c_mktsegment#8761,cc_name#8762,cc_address#8763,cc_phone#8764,cc_acctbal#8765,cc_comment#8766,cc_mktsegment#8767] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :     :- Project [rid#8861 AS rid_4#8876, cpfk_nation_customer#8862 AS cpfk_nation_customer_4#8877, cfpk_customer_nation#8863 AS cfpk_customer_nation_4#8878, cval_customer_c_name#8864 AS cval_customer_c_name_4#8879, cval_customer_c_address#8865 AS cval_customer_c_address_4#8880, cval_customer_c_phone#8866 AS cval_customer_c_phone_4#8881, cval_customer_c_acctbal#8867 AS cval_customer_c_acctbal_4#8882, cval_customer_c_comment#8868 AS cval_customer_c_comment_4#8883, cval_customer_c_mktsegment#8869 AS cval_customer_c_mktsegment_4#8884, cc_name#8870 AS cc_name_4#8885, cc_address#8871 AS cc_address_4#8886, cc_phone#8872 AS cc_phone_4#8887, cc_acctbal#8873 AS cc_acctbal_4#8888, cc_comment#8874 AS cc_comment_4#8889, cc_mktsegment#8875 AS cc_mktsegment_4#8890]
               :     :  +- Relation[rid#8861,cpfk_nation_customer#8862,cfpk_customer_nation#8863,cval_customer_c_name#8864,cval_customer_c_address#8865,cval_customer_c_phone#8866,cval_customer_c_acctbal#8867,cval_customer_c_comment#8868,cval_customer_c_mktsegment#8869,cc_name#8870,cc_address#8871,cc_phone#8872,cc_acctbal#8873,cc_comment#8874,cc_mktsegment#8875] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#8891 AS rid_5#8908, cpfk_customer_orders#8892 AS cpfk_customer_orders_5#8909, cfpk_orders_customer#8893 AS cfpk_orders_customer_5#8910, cval_orders_o_orderstatus#8894 AS cval_orders_o_orderstatus_5#8911, cval_orders_o_totalprice#8895 AS cval_orders_o_totalprice_5#8912, cval_orders_o_orderpriority#8896 AS cval_orders_o_orderpriority_5#8913, cval_orders_o_clerk#8897 AS cval_orders_o_clerk_5#8914, cval_orders_o_shippriority#8898 AS cval_orders_o_shippriority_5#8915, cval_orders_o_comment#8899 AS cval_orders_o_comment_5#8916, cval_orders_o_orderdate#8900 AS cval_orders_o_orderdate_5#8917, co_orderstatus#8901 AS co_orderstatus_5#8918, co_totalprice#8902 AS co_totalprice_5#8919, co_orderpriority#8903 AS co_orderpriority_5#8920, co_clerk#8904 AS co_clerk_5#8921, co_shippriority#8905 AS co_shippriority_5#8922, co_comment#8906 AS co_comment_5#8923, co_orderdate#8907 AS co_orderdate_5#8924]
               :        +- Relation[rid#8891,cpfk_customer_orders#8892,cfpk_orders_customer#8893,cval_orders_o_orderstatus#8894,cval_orders_o_totalprice#8895,cval_orders_o_orderpriority#8896,cval_orders_o_clerk#8897,cval_orders_o_shippriority#8898,cval_orders_o_comment#8899,cval_orders_o_orderdate#8900,co_orderstatus#8901,co_totalprice#8902,co_orderpriority#8903,co_clerk#8904,co_shippriority#8905,co_comment#8906,co_orderdate#8907] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#8827 AS rid_5#8844, cpfk_customer_orders#8828 AS cpfk_customer_orders_5#8845, cfpk_orders_customer#8829 AS cfpk_orders_customer_5#8846, cval_orders_o_orderstatus#8830 AS cval_orders_o_orderstatus_5#8847, cval_orders_o_totalprice#8831 AS cval_orders_o_totalprice_5#8848, cval_orders_o_orderpriority#8832 AS cval_orders_o_orderpriority_5#8849, cval_orders_o_clerk#8833 AS cval_orders_o_clerk_5#8850, cval_orders_o_shippriority#8834 AS cval_orders_o_shippriority_5#8851, cval_orders_o_comment#8835 AS cval_orders_o_comment_5#8852, cval_orders_o_orderdate#8836 AS cval_orders_o_orderdate_5#8853, co_orderstatus#8837 AS co_orderstatus_5#8854, co_totalprice#8838 AS co_totalprice_5#8855, co_orderpriority#8839 AS co_orderpriority_5#8856, co_clerk#8840 AS co_clerk_5#8857, co_shippriority#8841 AS co_shippriority_5#8858, co_comment#8842 AS co_comment_5#8859, co_orderdate#8843 AS co_orderdate_5#8860]
                  +- Relation[rid#8827,cpfk_customer_orders#8828,cfpk_orders_customer#8829,cval_orders_o_orderstatus#8830,cval_orders_o_totalprice#8831,cval_orders_o_orderpriority#8832,cval_orders_o_clerk#8833,cval_orders_o_shippriority#8834,cval_orders_o_comment#8835,cval_orders_o_orderdate#8836,co_orderstatus#8837,co_totalprice#8838,co_orderpriority#8839,co_clerk#8840,co_shippriority#8841,co_comment#8842,co_orderdate#8843] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 102600ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/11 04:29:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:29:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9025L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 04:29:43 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 04:29:43 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 04:29:43 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 04:29:43 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 04:29:43 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 04:29:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9025L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#9027 AS rid_0#9042, cpfk_nation_customer#9028 AS cpfk_nation_customer_0#9043, cfpk_customer_nation#9029 AS cfpk_customer_nation_0#9044, cval_customer_c_name#9030 AS cval_customer_c_name_0#9045, cval_customer_c_address#9031 AS cval_customer_c_address_0#9046, cval_customer_c_phone#9032 AS cval_customer_c_phone_0#9047, cval_customer_c_acctbal#9033 AS cval_customer_c_acctbal_0#9048, cval_customer_c_comment#9034 AS cval_customer_c_comment_0#9049, cval_customer_c_mktsegment#9035 AS cval_customer_c_mktsegment_0#9050, cc_name#9036 AS cc_name_0#9051, cc_address#9037 AS cc_address_0#9052, cc_phone#9038 AS cc_phone_0#9053, cc_acctbal#9039 AS cc_acctbal_0#9054, cc_comment#9040 AS cc_comment_0#9055, cc_mktsegment#9041 AS cc_mktsegment_0#9056]
         :  :  :  :  :  +- Relation[rid#9027,cpfk_nation_customer#9028,cfpk_customer_nation#9029,cval_customer_c_name#9030,cval_customer_c_address#9031,cval_customer_c_phone#9032,cval_customer_c_acctbal#9033,cval_customer_c_comment#9034,cval_customer_c_mktsegment#9035,cc_name#9036,cc_address#9037,cc_phone#9038,cc_acctbal#9039,cc_comment#9040,cc_mktsegment#9041] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#9057 AS rid_0#9072, cpfk_nation_customer#9058 AS cpfk_nation_customer_0#9073, cfpk_customer_nation#9059 AS cfpk_customer_nation_0#9074, cval_customer_c_name#9060 AS cval_customer_c_name_0#9075, cval_customer_c_address#9061 AS cval_customer_c_address_0#9076, cval_customer_c_phone#9062 AS cval_customer_c_phone_0#9077, cval_customer_c_acctbal#9063 AS cval_customer_c_acctbal_0#9078, cval_customer_c_comment#9064 AS cval_customer_c_comment_0#9079, cval_customer_c_mktsegment#9065 AS cval_customer_c_mktsegment_0#9080, cc_name#9066 AS cc_name_0#9081, cc_address#9067 AS cc_address_0#9082, cc_phone#9068 AS cc_phone_0#9083, cc_acctbal#9069 AS cc_acctbal_0#9084, cc_comment#9070 AS cc_comment_0#9085, cc_mktsegment#9071 AS cc_mktsegment_0#9086]
         :  :  :  :        +- Relation[rid#9057,cpfk_nation_customer#9058,cfpk_customer_nation#9059,cval_customer_c_name#9060,cval_customer_c_address#9061,cval_customer_c_phone#9062,cval_customer_c_acctbal#9063,cval_customer_c_comment#9064,cval_customer_c_mktsegment#9065,cc_name#9066,cc_address#9067,cc_phone#9068,cc_acctbal#9069,cc_comment#9070,cc_mktsegment#9071] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#9121 AS rid_0#9136, cpfk_nation_customer#9122 AS cpfk_nation_customer_0#9137, cfpk_customer_nation#9123 AS cfpk_customer_nation_0#9138, cval_customer_c_name#9124 AS cval_customer_c_name_0#9139, cval_customer_c_address#9125 AS cval_customer_c_address_0#9140, cval_customer_c_phone#9126 AS cval_customer_c_phone_0#9141, cval_customer_c_acctbal#9127 AS cval_customer_c_acctbal_0#9142, cval_customer_c_comment#9128 AS cval_customer_c_comment_0#9143, cval_customer_c_mktsegment#9129 AS cval_customer_c_mktsegment_0#9144, cc_name#9130 AS cc_name_0#9145, cc_address#9131 AS cc_address_0#9146, cc_phone#9132 AS cc_phone_0#9147, cc_acctbal#9133 AS cc_acctbal_0#9148, cc_comment#9134 AS cc_comment_0#9149, cc_mktsegment#9135 AS cc_mktsegment_0#9150]
         :  :  :     :  +- Relation[rid#9121,cpfk_nation_customer#9122,cfpk_customer_nation#9123,cval_customer_c_name#9124,cval_customer_c_address#9125,cval_customer_c_phone#9126,cval_customer_c_acctbal#9127,cval_customer_c_comment#9128,cval_customer_c_mktsegment#9129,cc_name#9130,cc_address#9131,cc_phone#9132,cc_acctbal#9133,cc_comment#9134,cc_mktsegment#9135] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#9151 AS rid_1#9168, cpfk_customer_orders#9152 AS cpfk_customer_orders_1#9169, cfpk_orders_customer#9153 AS cfpk_orders_customer_1#9170, cval_orders_o_orderstatus#9154 AS cval_orders_o_orderstatus_1#9171, cval_orders_o_totalprice#9155 AS cval_orders_o_totalprice_1#9172, cval_orders_o_orderpriority#9156 AS cval_orders_o_orderpriority_1#9173, cval_orders_o_clerk#9157 AS cval_orders_o_clerk_1#9174, cval_orders_o_shippriority#9158 AS cval_orders_o_shippriority_1#9175, cval_orders_o_comment#9159 AS cval_orders_o_comment_1#9176, cval_orders_o_orderdate#9160 AS cval_orders_o_orderdate_1#9177, co_orderstatus#9161 AS co_orderstatus_1#9178, co_totalprice#9162 AS co_totalprice_1#9179, co_orderpriority#9163 AS co_orderpriority_1#9180, co_clerk#9164 AS co_clerk_1#9181, co_shippriority#9165 AS co_shippriority_1#9182, co_comment#9166 AS co_comment_1#9183, co_orderdate#9167 AS co_orderdate_1#9184]
         :  :  :        +- Relation[rid#9151,cpfk_customer_orders#9152,cfpk_orders_customer#9153,cval_orders_o_orderstatus#9154,cval_orders_o_totalprice#9155,cval_orders_o_orderpriority#9156,cval_orders_o_clerk#9157,cval_orders_o_shippriority#9158,cval_orders_o_comment#9159,cval_orders_o_orderdate#9160,co_orderstatus#9161,co_totalprice#9162,co_orderpriority#9163,co_clerk#9164,co_shippriority#9165,co_comment#9166,co_orderdate#9167] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#9087 AS rid_1#9104, cpfk_customer_orders#9088 AS cpfk_customer_orders_1#9105, cfpk_orders_customer#9089 AS cfpk_orders_customer_1#9106, cval_orders_o_orderstatus#9090 AS cval_orders_o_orderstatus_1#9107, cval_orders_o_totalprice#9091 AS cval_orders_o_totalprice_1#9108, cval_orders_o_orderpriority#9092 AS cval_orders_o_orderpriority_1#9109, cval_orders_o_clerk#9093 AS cval_orders_o_clerk_1#9110, cval_orders_o_shippriority#9094 AS cval_orders_o_shippriority_1#9111, cval_orders_o_comment#9095 AS cval_orders_o_comment_1#9112, cval_orders_o_orderdate#9096 AS cval_orders_o_orderdate_1#9113, co_orderstatus#9097 AS co_orderstatus_1#9114, co_totalprice#9098 AS co_totalprice_1#9115, co_orderpriority#9099 AS co_orderpriority_1#9116, co_clerk#9100 AS co_clerk_1#9117, co_shippriority#9101 AS co_shippriority_1#9118, co_comment#9102 AS co_comment_1#9119, co_orderdate#9103 AS co_orderdate_1#9120]
         :  :     +- Relation[rid#9087,cpfk_customer_orders#9088,cfpk_orders_customer#9089,cval_orders_o_orderstatus#9090,cval_orders_o_totalprice#9091,cval_orders_o_orderpriority#9092,cval_orders_o_clerk#9093,cval_orders_o_shippriority#9094,cval_orders_o_comment#9095,cval_orders_o_orderdate#9096,co_orderstatus#9097,co_totalprice#9098,co_orderpriority#9099,co_clerk#9100,co_shippriority#9101,co_comment#9102,co_orderdate#9103] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#9251 AS rid_1#9268, cpfk_customer_orders#9252 AS cpfk_customer_orders_1#9269, cfpk_orders_customer#9253 AS cfpk_orders_customer_1#9270, cval_orders_o_orderstatus#9254 AS cval_orders_o_orderstatus_1#9271, cval_orders_o_totalprice#9255 AS cval_orders_o_totalprice_1#9272, cval_orders_o_orderpriority#9256 AS cval_orders_o_orderpriority_1#9273, cval_orders_o_clerk#9257 AS cval_orders_o_clerk_1#9274, cval_orders_o_shippriority#9258 AS cval_orders_o_shippriority_1#9275, cval_orders_o_comment#9259 AS cval_orders_o_comment_1#9276, cval_orders_o_orderdate#9260 AS cval_orders_o_orderdate_1#9277, co_orderstatus#9261 AS co_orderstatus_1#9278, co_totalprice#9262 AS co_totalprice_1#9279, co_orderpriority#9263 AS co_orderpriority_1#9280, co_clerk#9264 AS co_clerk_1#9281, co_shippriority#9265 AS co_shippriority_1#9282, co_comment#9266 AS co_comment_1#9283, co_orderdate#9267 AS co_orderdate_1#9284]
         :     :  +- Relation[rid#9251,cpfk_customer_orders#9252,cfpk_orders_customer#9253,cval_orders_o_orderstatus#9254,cval_orders_o_totalprice#9255,cval_orders_o_orderpriority#9256,cval_orders_o_clerk#9257,cval_orders_o_shippriority#9258,cval_orders_o_comment#9259,cval_orders_o_orderdate#9260,co_orderstatus#9261,co_totalprice#9262,co_orderpriority#9263,co_clerk#9264,co_shippriority#9265,co_comment#9266,co_orderdate#9267] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#9285 AS rid_2#9318, cpfk_orders_lineitem#9286 AS cpfk_orders_lineitem_2#9319, cpfk_supplier_lineitem#9287 AS cpfk_supplier_lineitem_2#9320, cfpk_lineitem_supplier#9288 AS cfpk_lineitem_supplier_2#9321, cfpk_lineitem_partsupp#9289 AS cfpk_lineitem_partsupp_2#9322, cpfk_part_lineitem#9290 AS cpfk_part_lineitem_2#9323, cfpk_lineitem_part#9291 AS cfpk_lineitem_part_2#9324, cpfk_partsupp_lineitem#9292 AS cpfk_partsupp_lineitem_2#9325, cfpk_lineitem_orders#9293 AS cfpk_lineitem_orders_2#9326, cval_lineitem_l_quantity#9294 AS cval_lineitem_l_quantity_2#9327, cval_lineitem_l_extendedprice#9295 AS cval_lineitem_l_extendedprice_2#9328, cval_lineitem_l_discount#9296 AS cval_lineitem_l_discount_2#9329, cval_lineitem_l_tax#9297 AS cval_lineitem_l_tax_2#9330, cval_lineitem_l_returnflag#9298 AS cval_lineitem_l_returnflag_2#9331, cval_lineitem_l_linestatus#9299 AS cval_lineitem_l_linestatus_2#9332, cval_lineitem_l_commitdate#9300 AS cval_lineitem_l_commitdate_2#9333, cval_lineitem_l_receiptdate#9301 AS cval_lineitem_l_receiptdate_2#9334, cval_lineitem_l_shipinstruct#9302 AS cval_lineitem_l_shipinstruct_2#9335, cval_lineitem_l_shipmode#9303 AS cval_lineitem_l_shipmode_2#9336, cval_lineitem_l_comment#9304 AS cval_lineitem_l_comment_2#9337, cval_lineitem_l_shipdate#9305 AS cval_lineitem_l_shipdate_2#9338, cl_quantity#9306 AS cl_quantity_2#9339, cl_extendedprice#9307 AS cl_extendedprice_2#9340, cl_discount#9308 AS cl_discount_2#9341, ... 9 more fields]
         :        +- Relation[rid#9285,cpfk_orders_lineitem#9286,cpfk_supplier_lineitem#9287,cfpk_lineitem_supplier#9288,cfpk_lineitem_partsupp#9289,cpfk_part_lineitem#9290,cfpk_lineitem_part#9291,cpfk_partsupp_lineitem#9292,cfpk_lineitem_orders#9293,cval_lineitem_l_quantity#9294,cval_lineitem_l_extendedprice#9295,cval_lineitem_l_discount#9296,cval_lineitem_l_tax#9297,cval_lineitem_l_returnflag#9298,cval_lineitem_l_linestatus#9299,cval_lineitem_l_commitdate#9300,cval_lineitem_l_receiptdate#9301,cval_lineitem_l_shipinstruct#9302,cval_lineitem_l_shipmode#9303,cval_lineitem_l_comment#9304,cval_lineitem_l_shipdate#9305,cl_quantity#9306,cl_extendedprice#9307,cl_discount#9308,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#9185 AS rid_2#9218, cpfk_orders_lineitem#9186 AS cpfk_orders_lineitem_2#9219, cpfk_supplier_lineitem#9187 AS cpfk_supplier_lineitem_2#9220, cfpk_lineitem_supplier#9188 AS cfpk_lineitem_supplier_2#9221, cfpk_lineitem_partsupp#9189 AS cfpk_lineitem_partsupp_2#9222, cpfk_part_lineitem#9190 AS cpfk_part_lineitem_2#9223, cfpk_lineitem_part#9191 AS cfpk_lineitem_part_2#9224, cpfk_partsupp_lineitem#9192 AS cpfk_partsupp_lineitem_2#9225, cfpk_lineitem_orders#9193 AS cfpk_lineitem_orders_2#9226, cval_lineitem_l_quantity#9194 AS cval_lineitem_l_quantity_2#9227, cval_lineitem_l_extendedprice#9195 AS cval_lineitem_l_extendedprice_2#9228, cval_lineitem_l_discount#9196 AS cval_lineitem_l_discount_2#9229, cval_lineitem_l_tax#9197 AS cval_lineitem_l_tax_2#9230, cval_lineitem_l_returnflag#9198 AS cval_lineitem_l_returnflag_2#9231, cval_lineitem_l_linestatus#9199 AS cval_lineitem_l_linestatus_2#9232, cval_lineitem_l_commitdate#9200 AS cval_lineitem_l_commitdate_2#9233, cval_lineitem_l_receiptdate#9201 AS cval_lineitem_l_receiptdate_2#9234, cval_lineitem_l_shipinstruct#9202 AS cval_lineitem_l_shipinstruct_2#9235, cval_lineitem_l_shipmode#9203 AS cval_lineitem_l_shipmode_2#9236, cval_lineitem_l_comment#9204 AS cval_lineitem_l_comment_2#9237, cval_lineitem_l_shipdate#9205 AS cval_lineitem_l_shipdate_2#9238, cl_quantity#9206 AS cl_quantity_2#9239, cl_extendedprice#9207 AS cl_extendedprice_2#9240, cl_discount#9208 AS cl_discount_2#9241, ... 9 more fields]
            +- Relation[rid#9185,cpfk_orders_lineitem#9186,cpfk_supplier_lineitem#9187,cfpk_lineitem_supplier#9188,cfpk_lineitem_partsupp#9189,cpfk_part_lineitem#9190,cfpk_lineitem_part#9191,cpfk_partsupp_lineitem#9192,cfpk_lineitem_orders#9193,cval_lineitem_l_quantity#9194,cval_lineitem_l_extendedprice#9195,cval_lineitem_l_discount#9196,cval_lineitem_l_tax#9197,cval_lineitem_l_returnflag#9198,cval_lineitem_l_linestatus#9199,cval_lineitem_l_commitdate#9200,cval_lineitem_l_receiptdate#9201,cval_lineitem_l_shipinstruct#9202,cval_lineitem_l_shipmode#9203,cval_lineitem_l_comment#9204,cval_lineitem_l_shipdate#9205,cl_quantity#9206,cl_extendedprice#9207,cl_discount#9208,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 115124ms
query=q1, count=6001215, duration=3586
query=q10, count=1478870, duration=59770
query=q11, count=31680, duration=10318
query=q12, count=857401, duration=21504
query=q13, count=1500000, duration=13024
query=q14, count=6001215, duration=82481
query=q15, count=6001215, duration=76799
query=q16, count=15780, duration=11397
query=q17, count=6088, duration=71693
query=q18, count=6001215, duration=117797
query=q19, count=205, duration=361277
query=q2, count=3162, duration=20628
query=q20, count=632, duration=11424
query=q21a, count=597422, duration=248056
query=q22, count=1500000, duration=12862
query=q3, count=1214743, duration=115124
query=q4, count=6001215, duration=52731
query=q5, count=1206514, duration=165427
query=q6, count=6001215, duration=2957
query=q7, count=9735, duration=102600
query=q8, count=8716, duration=95121
query=q9a, count=6001215, duration=246645
query=q9b, count=6001215, duration=161648
