20/04/11 08:00:33 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 12388ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 11 08:00:36 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 11 08:00:38 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 11 08:00:38 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 11 08:00:38 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 11 08:00:38 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 11 08:00:43 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 11 08:00:47 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 11 08:00:47 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/11 08:00:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:00:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2078L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 08:00:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2078L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#2080 AS rid_0#2097, cpfk_customer_orders#2081 AS cpfk_customer_orders_0#2098, cfpk_orders_customer#2082 AS cfpk_orders_customer_0#2099, cval_orders_o_orderstatus#2083 AS cval_orders_o_orderstatus_0#2100, cval_orders_o_totalprice#2084 AS cval_orders_o_totalprice_0#2101, cval_orders_o_orderpriority#2085 AS cval_orders_o_orderpriority_0#2102, cval_orders_o_clerk#2086 AS cval_orders_o_clerk_0#2103, cval_orders_o_shippriority#2087 AS cval_orders_o_shippriority_0#2104, cval_orders_o_comment#2088 AS cval_orders_o_comment_0#2105, cval_orders_o_orderdate#2089 AS cval_orders_o_orderdate_0#2106, co_orderstatus#2090 AS co_orderstatus_0#2107, co_totalprice#2091 AS co_totalprice_0#2108, co_orderpriority#2092 AS co_orderpriority_0#2109, co_clerk#2093 AS co_clerk_0#2110, co_shippriority#2094 AS co_shippriority_0#2111, co_comment#2095 AS co_comment_0#2112, co_orderdate#2096 AS co_orderdate_0#2113]
            :  +- Relation[rid#2080,cpfk_customer_orders#2081,cfpk_orders_customer#2082,cval_orders_o_orderstatus#2083,cval_orders_o_totalprice#2084,cval_orders_o_orderpriority#2085,cval_orders_o_clerk#2086,cval_orders_o_shippriority#2087,cval_orders_o_comment#2088,cval_orders_o_orderdate#2089,co_orderstatus#2090,co_totalprice#2091,co_orderpriority#2092,co_clerk#2093,co_shippriority#2094,co_comment#2095,co_orderdate#2096] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#2114 AS rid_1#2129, cpfk_nation_customer#2115 AS cpfk_nation_customer_1#2130, cfpk_customer_nation#2116 AS cfpk_customer_nation_1#2131, cval_customer_c_name#2117 AS cval_customer_c_name_1#2132, cval_customer_c_address#2118 AS cval_customer_c_address_1#2133, cval_customer_c_phone#2119 AS cval_customer_c_phone_1#2134, cval_customer_c_acctbal#2120 AS cval_customer_c_acctbal_1#2135, cval_customer_c_comment#2121 AS cval_customer_c_comment_1#2136, cval_customer_c_mktsegment#2122 AS cval_customer_c_mktsegment_1#2137, cc_name#2123 AS cc_name_1#2138, cc_address#2124 AS cc_address_1#2139, cc_phone#2125 AS cc_phone_1#2140, cc_acctbal#2126 AS cc_acctbal_1#2141, cc_comment#2127 AS cc_comment_1#2142, cc_mktsegment#2128 AS cc_mktsegment_1#2143]
               +- Relation[rid#2114,cpfk_nation_customer#2115,cfpk_customer_nation#2116,cval_customer_c_name#2117,cval_customer_c_address#2118,cval_customer_c_phone#2119,cval_customer_c_acctbal#2120,cval_customer_c_comment#2121,cval_customer_c_mktsegment#2122,cc_name#2123,cc_address#2124,cc_phone#2125,cc_acctbal#2126,cc_comment#2127,cc_mktsegment#2128] JDBCRelation(tcustomer) [numPartitions=1]

20/04/11 08:00:49 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexPkFk$ result size=1500000
Elapsed time: 13289ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/11 08:01:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:01:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2188L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 08:01:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:01:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:01:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2188L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#2190 AS rid_0#2223, cpfk_orders_lineitem#2191 AS cpfk_orders_lineitem_0#2224, cpfk_supplier_lineitem#2192 AS cpfk_supplier_lineitem_0#2225, cfpk_lineitem_supplier#2193 AS cfpk_lineitem_supplier_0#2226, cfpk_lineitem_partsupp#2194 AS cfpk_lineitem_partsupp_0#2227, cpfk_part_lineitem#2195 AS cpfk_part_lineitem_0#2228, cfpk_lineitem_part#2196 AS cfpk_lineitem_part_0#2229, cpfk_partsupp_lineitem#2197 AS cpfk_partsupp_lineitem_0#2230, cfpk_lineitem_orders#2198 AS cfpk_lineitem_orders_0#2231, cval_lineitem_l_quantity#2199 AS cval_lineitem_l_quantity_0#2232, cval_lineitem_l_extendedprice#2200 AS cval_lineitem_l_extendedprice_0#2233, cval_lineitem_l_discount#2201 AS cval_lineitem_l_discount_0#2234, cval_lineitem_l_tax#2202 AS cval_lineitem_l_tax_0#2235, cval_lineitem_l_returnflag#2203 AS cval_lineitem_l_returnflag_0#2236, cval_lineitem_l_linestatus#2204 AS cval_lineitem_l_linestatus_0#2237, cval_lineitem_l_commitdate#2205 AS cval_lineitem_l_commitdate_0#2238, cval_lineitem_l_receiptdate#2206 AS cval_lineitem_l_receiptdate_0#2239, cval_lineitem_l_shipinstruct#2207 AS cval_lineitem_l_shipinstruct_0#2240, cval_lineitem_l_shipmode#2208 AS cval_lineitem_l_shipmode_0#2241, cval_lineitem_l_comment#2209 AS cval_lineitem_l_comment_0#2242, cval_lineitem_l_shipdate#2210 AS cval_lineitem_l_shipdate_0#2243, cl_quantity#2211 AS cl_quantity_0#2244, cl_extendedprice#2212 AS cl_extendedprice_0#2245, cl_discount#2213 AS cl_discount_0#2246, ... 9 more fields]
            :     :     :  :  +- Relation[rid#2190,cpfk_orders_lineitem#2191,cpfk_supplier_lineitem#2192,cfpk_lineitem_supplier#2193,cfpk_lineitem_partsupp#2194,cpfk_part_lineitem#2195,cfpk_lineitem_part#2196,cpfk_partsupp_lineitem#2197,cfpk_lineitem_orders#2198,cval_lineitem_l_quantity#2199,cval_lineitem_l_extendedprice#2200,cval_lineitem_l_discount#2201,cval_lineitem_l_tax#2202,cval_lineitem_l_returnflag#2203,cval_lineitem_l_linestatus#2204,cval_lineitem_l_commitdate#2205,cval_lineitem_l_receiptdate#2206,cval_lineitem_l_shipinstruct#2207,cval_lineitem_l_shipmode#2208,cval_lineitem_l_comment#2209,cval_lineitem_l_shipdate#2210,cl_quantity#2211,cl_extendedprice#2212,cl_discount#2213,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#2256 AS rid_0#2289, cpfk_orders_lineitem#2257 AS cpfk_orders_lineitem_0#2290, cpfk_supplier_lineitem#2258 AS cpfk_supplier_lineitem_0#2291, cfpk_lineitem_supplier#2259 AS cfpk_lineitem_supplier_0#2292, cfpk_lineitem_partsupp#2260 AS cfpk_lineitem_partsupp_0#2293, cpfk_part_lineitem#2261 AS cpfk_part_lineitem_0#2294, cfpk_lineitem_part#2262 AS cfpk_lineitem_part_0#2295, cpfk_partsupp_lineitem#2263 AS cpfk_partsupp_lineitem_0#2296, cfpk_lineitem_orders#2264 AS cfpk_lineitem_orders_0#2297, cval_lineitem_l_quantity#2265 AS cval_lineitem_l_quantity_0#2298, cval_lineitem_l_extendedprice#2266 AS cval_lineitem_l_extendedprice_0#2299, cval_lineitem_l_discount#2267 AS cval_lineitem_l_discount_0#2300, cval_lineitem_l_tax#2268 AS cval_lineitem_l_tax_0#2301, cval_lineitem_l_returnflag#2269 AS cval_lineitem_l_returnflag_0#2302, cval_lineitem_l_linestatus#2270 AS cval_lineitem_l_linestatus_0#2303, cval_lineitem_l_commitdate#2271 AS cval_lineitem_l_commitdate_0#2304, cval_lineitem_l_receiptdate#2272 AS cval_lineitem_l_receiptdate_0#2305, cval_lineitem_l_shipinstruct#2273 AS cval_lineitem_l_shipinstruct_0#2306, cval_lineitem_l_shipmode#2274 AS cval_lineitem_l_shipmode_0#2307, cval_lineitem_l_comment#2275 AS cval_lineitem_l_comment_0#2308, cval_lineitem_l_shipdate#2276 AS cval_lineitem_l_shipdate_0#2309, cl_quantity#2277 AS cl_quantity_0#2310, cl_extendedprice#2278 AS cl_extendedprice_0#2311, cl_discount#2279 AS cl_discount_0#2312, ... 9 more fields]
            :     :     :        +- Relation[rid#2256,cpfk_orders_lineitem#2257,cpfk_supplier_lineitem#2258,cfpk_lineitem_supplier#2259,cfpk_lineitem_partsupp#2260,cpfk_part_lineitem#2261,cfpk_lineitem_part#2262,cpfk_partsupp_lineitem#2263,cfpk_lineitem_orders#2264,cval_lineitem_l_quantity#2265,cval_lineitem_l_extendedprice#2266,cval_lineitem_l_discount#2267,cval_lineitem_l_tax#2268,cval_lineitem_l_returnflag#2269,cval_lineitem_l_linestatus#2270,cval_lineitem_l_commitdate#2271,cval_lineitem_l_receiptdate#2272,cval_lineitem_l_shipinstruct#2273,cval_lineitem_l_shipmode#2274,cval_lineitem_l_comment#2275,cval_lineitem_l_shipdate#2276,cl_quantity#2277,cl_extendedprice#2278,cl_discount#2279,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#2322 AS rid_1#2339, cpfk_customer_orders#2323 AS cpfk_customer_orders_1#2340, cfpk_orders_customer#2324 AS cfpk_orders_customer_1#2341, cval_orders_o_orderstatus#2325 AS cval_orders_o_orderstatus_1#2342, cval_orders_o_totalprice#2326 AS cval_orders_o_totalprice_1#2343, cval_orders_o_orderpriority#2327 AS cval_orders_o_orderpriority_1#2344, cval_orders_o_clerk#2328 AS cval_orders_o_clerk_1#2345, cval_orders_o_shippriority#2329 AS cval_orders_o_shippriority_1#2346, cval_orders_o_comment#2330 AS cval_orders_o_comment_1#2347, cval_orders_o_orderdate#2331 AS cval_orders_o_orderdate_1#2348, co_orderstatus#2332 AS co_orderstatus_1#2349, co_totalprice#2333 AS co_totalprice_1#2350, co_orderpriority#2334 AS co_orderpriority_1#2351, co_clerk#2335 AS co_clerk_1#2352, co_shippriority#2336 AS co_shippriority_1#2353, co_comment#2337 AS co_comment_1#2354, co_orderdate#2338 AS co_orderdate_1#2355]
            :     :        +- Relation[rid#2322,cpfk_customer_orders#2323,cfpk_orders_customer#2324,cval_orders_o_orderstatus#2325,cval_orders_o_totalprice#2326,cval_orders_o_orderpriority#2327,cval_orders_o_clerk#2328,cval_orders_o_shippriority#2329,cval_orders_o_comment#2330,cval_orders_o_orderdate#2331,co_orderstatus#2332,co_totalprice#2333,co_orderpriority#2334,co_clerk#2335,co_shippriority#2336,co_comment#2337,co_orderdate#2338] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#2356 AS rid_2#2371, cpfk_nation_customer#2357 AS cpfk_nation_customer_2#2372, cfpk_customer_nation#2358 AS cfpk_customer_nation_2#2373, cval_customer_c_name#2359 AS cval_customer_c_name_2#2374, cval_customer_c_address#2360 AS cval_customer_c_address_2#2375, cval_customer_c_phone#2361 AS cval_customer_c_phone_2#2376, cval_customer_c_acctbal#2362 AS cval_customer_c_acctbal_2#2377, cval_customer_c_comment#2363 AS cval_customer_c_comment_2#2378, cval_customer_c_mktsegment#2364 AS cval_customer_c_mktsegment_2#2379, cc_name#2365 AS cc_name_2#2380, cc_address#2366 AS cc_address_2#2381, cc_phone#2367 AS cc_phone_2#2382, cc_acctbal#2368 AS cc_acctbal_2#2383, cc_comment#2369 AS cc_comment_2#2384, cc_mktsegment#2370 AS cc_mktsegment_2#2385]
            :        +- Relation[rid#2356,cpfk_nation_customer#2357,cfpk_customer_nation#2358,cval_customer_c_name#2359,cval_customer_c_address#2360,cval_customer_c_phone#2361,cval_customer_c_acctbal#2362,cval_customer_c_comment#2363,cval_customer_c_mktsegment#2364,cc_name#2365,cc_address#2366,cc_phone#2367,cc_acctbal#2368,cc_comment#2369,cc_mktsegment#2370] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#2386 AS rid_3#2393, cpfk_region_nation#2387 AS cpfk_region_nation_3#2394, cfpk_nation_region#2388 AS cfpk_nation_region_3#2395, cval_nation_n_name#2389 AS cval_nation_n_name_3#2396, cval_nation_n_comment#2390 AS cval_nation_n_comment_3#2397, cn_name#2391 AS cn_name_3#2398, cn_comment#2392 AS cn_comment_3#2399]
               +- Relation[rid#2386,cpfk_region_nation#2387,cfpk_nation_region#2388,cval_nation_n_name#2389,cval_nation_n_comment#2390,cn_name#2391,cn_comment#2392] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 60444ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/11 08:02:03 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:02:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2480L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 08:02:03 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 08:02:03 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 08:02:03 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 08:02:03 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 08:02:03 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 08:02:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2480L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#2482 AS rid_0#2497, cpfk_nation_customer#2483 AS cpfk_nation_customer_0#2498, cfpk_customer_nation#2484 AS cfpk_customer_nation_0#2499, cval_customer_c_name#2485 AS cval_customer_c_name_0#2500, cval_customer_c_address#2486 AS cval_customer_c_address_0#2501, cval_customer_c_phone#2487 AS cval_customer_c_phone_0#2502, cval_customer_c_acctbal#2488 AS cval_customer_c_acctbal_0#2503, cval_customer_c_comment#2489 AS cval_customer_c_comment_0#2504, cval_customer_c_mktsegment#2490 AS cval_customer_c_mktsegment_0#2505, cc_name#2491 AS cc_name_0#2506, cc_address#2492 AS cc_address_0#2507, cc_phone#2493 AS cc_phone_0#2508, cc_acctbal#2494 AS cc_acctbal_0#2509, cc_comment#2495 AS cc_comment_0#2510, cc_mktsegment#2496 AS cc_mktsegment_0#2511]
         :  :  :  :  :  +- Relation[rid#2482,cpfk_nation_customer#2483,cfpk_customer_nation#2484,cval_customer_c_name#2485,cval_customer_c_address#2486,cval_customer_c_phone#2487,cval_customer_c_acctbal#2488,cval_customer_c_comment#2489,cval_customer_c_mktsegment#2490,cc_name#2491,cc_address#2492,cc_phone#2493,cc_acctbal#2494,cc_comment#2495,cc_mktsegment#2496] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#2512 AS rid_0#2527, cpfk_nation_customer#2513 AS cpfk_nation_customer_0#2528, cfpk_customer_nation#2514 AS cfpk_customer_nation_0#2529, cval_customer_c_name#2515 AS cval_customer_c_name_0#2530, cval_customer_c_address#2516 AS cval_customer_c_address_0#2531, cval_customer_c_phone#2517 AS cval_customer_c_phone_0#2532, cval_customer_c_acctbal#2518 AS cval_customer_c_acctbal_0#2533, cval_customer_c_comment#2519 AS cval_customer_c_comment_0#2534, cval_customer_c_mktsegment#2520 AS cval_customer_c_mktsegment_0#2535, cc_name#2521 AS cc_name_0#2536, cc_address#2522 AS cc_address_0#2537, cc_phone#2523 AS cc_phone_0#2538, cc_acctbal#2524 AS cc_acctbal_0#2539, cc_comment#2525 AS cc_comment_0#2540, cc_mktsegment#2526 AS cc_mktsegment_0#2541]
         :  :  :  :        +- Relation[rid#2512,cpfk_nation_customer#2513,cfpk_customer_nation#2514,cval_customer_c_name#2515,cval_customer_c_address#2516,cval_customer_c_phone#2517,cval_customer_c_acctbal#2518,cval_customer_c_comment#2519,cval_customer_c_mktsegment#2520,cc_name#2521,cc_address#2522,cc_phone#2523,cc_acctbal#2524,cc_comment#2525,cc_mktsegment#2526] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#2576 AS rid_0#2591, cpfk_nation_customer#2577 AS cpfk_nation_customer_0#2592, cfpk_customer_nation#2578 AS cfpk_customer_nation_0#2593, cval_customer_c_name#2579 AS cval_customer_c_name_0#2594, cval_customer_c_address#2580 AS cval_customer_c_address_0#2595, cval_customer_c_phone#2581 AS cval_customer_c_phone_0#2596, cval_customer_c_acctbal#2582 AS cval_customer_c_acctbal_0#2597, cval_customer_c_comment#2583 AS cval_customer_c_comment_0#2598, cval_customer_c_mktsegment#2584 AS cval_customer_c_mktsegment_0#2599, cc_name#2585 AS cc_name_0#2600, cc_address#2586 AS cc_address_0#2601, cc_phone#2587 AS cc_phone_0#2602, cc_acctbal#2588 AS cc_acctbal_0#2603, cc_comment#2589 AS cc_comment_0#2604, cc_mktsegment#2590 AS cc_mktsegment_0#2605]
         :  :  :     :  +- Relation[rid#2576,cpfk_nation_customer#2577,cfpk_customer_nation#2578,cval_customer_c_name#2579,cval_customer_c_address#2580,cval_customer_c_phone#2581,cval_customer_c_acctbal#2582,cval_customer_c_comment#2583,cval_customer_c_mktsegment#2584,cc_name#2585,cc_address#2586,cc_phone#2587,cc_acctbal#2588,cc_comment#2589,cc_mktsegment#2590] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#2606 AS rid_1#2623, cpfk_customer_orders#2607 AS cpfk_customer_orders_1#2624, cfpk_orders_customer#2608 AS cfpk_orders_customer_1#2625, cval_orders_o_orderstatus#2609 AS cval_orders_o_orderstatus_1#2626, cval_orders_o_totalprice#2610 AS cval_orders_o_totalprice_1#2627, cval_orders_o_orderpriority#2611 AS cval_orders_o_orderpriority_1#2628, cval_orders_o_clerk#2612 AS cval_orders_o_clerk_1#2629, cval_orders_o_shippriority#2613 AS cval_orders_o_shippriority_1#2630, cval_orders_o_comment#2614 AS cval_orders_o_comment_1#2631, cval_orders_o_orderdate#2615 AS cval_orders_o_orderdate_1#2632, co_orderstatus#2616 AS co_orderstatus_1#2633, co_totalprice#2617 AS co_totalprice_1#2634, co_orderpriority#2618 AS co_orderpriority_1#2635, co_clerk#2619 AS co_clerk_1#2636, co_shippriority#2620 AS co_shippriority_1#2637, co_comment#2621 AS co_comment_1#2638, co_orderdate#2622 AS co_orderdate_1#2639]
         :  :  :        +- Relation[rid#2606,cpfk_customer_orders#2607,cfpk_orders_customer#2608,cval_orders_o_orderstatus#2609,cval_orders_o_totalprice#2610,cval_orders_o_orderpriority#2611,cval_orders_o_clerk#2612,cval_orders_o_shippriority#2613,cval_orders_o_comment#2614,cval_orders_o_orderdate#2615,co_orderstatus#2616,co_totalprice#2617,co_orderpriority#2618,co_clerk#2619,co_shippriority#2620,co_comment#2621,co_orderdate#2622] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#2542 AS rid_1#2559, cpfk_customer_orders#2543 AS cpfk_customer_orders_1#2560, cfpk_orders_customer#2544 AS cfpk_orders_customer_1#2561, cval_orders_o_orderstatus#2545 AS cval_orders_o_orderstatus_1#2562, cval_orders_o_totalprice#2546 AS cval_orders_o_totalprice_1#2563, cval_orders_o_orderpriority#2547 AS cval_orders_o_orderpriority_1#2564, cval_orders_o_clerk#2548 AS cval_orders_o_clerk_1#2565, cval_orders_o_shippriority#2549 AS cval_orders_o_shippriority_1#2566, cval_orders_o_comment#2550 AS cval_orders_o_comment_1#2567, cval_orders_o_orderdate#2551 AS cval_orders_o_orderdate_1#2568, co_orderstatus#2552 AS co_orderstatus_1#2569, co_totalprice#2553 AS co_totalprice_1#2570, co_orderpriority#2554 AS co_orderpriority_1#2571, co_clerk#2555 AS co_clerk_1#2572, co_shippriority#2556 AS co_shippriority_1#2573, co_comment#2557 AS co_comment_1#2574, co_orderdate#2558 AS co_orderdate_1#2575]
         :  :     +- Relation[rid#2542,cpfk_customer_orders#2543,cfpk_orders_customer#2544,cval_orders_o_orderstatus#2545,cval_orders_o_totalprice#2546,cval_orders_o_orderpriority#2547,cval_orders_o_clerk#2548,cval_orders_o_shippriority#2549,cval_orders_o_comment#2550,cval_orders_o_orderdate#2551,co_orderstatus#2552,co_totalprice#2553,co_orderpriority#2554,co_clerk#2555,co_shippriority#2556,co_comment#2557,co_orderdate#2558] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#2706 AS rid_1#2723, cpfk_customer_orders#2707 AS cpfk_customer_orders_1#2724, cfpk_orders_customer#2708 AS cfpk_orders_customer_1#2725, cval_orders_o_orderstatus#2709 AS cval_orders_o_orderstatus_1#2726, cval_orders_o_totalprice#2710 AS cval_orders_o_totalprice_1#2727, cval_orders_o_orderpriority#2711 AS cval_orders_o_orderpriority_1#2728, cval_orders_o_clerk#2712 AS cval_orders_o_clerk_1#2729, cval_orders_o_shippriority#2713 AS cval_orders_o_shippriority_1#2730, cval_orders_o_comment#2714 AS cval_orders_o_comment_1#2731, cval_orders_o_orderdate#2715 AS cval_orders_o_orderdate_1#2732, co_orderstatus#2716 AS co_orderstatus_1#2733, co_totalprice#2717 AS co_totalprice_1#2734, co_orderpriority#2718 AS co_orderpriority_1#2735, co_clerk#2719 AS co_clerk_1#2736, co_shippriority#2720 AS co_shippriority_1#2737, co_comment#2721 AS co_comment_1#2738, co_orderdate#2722 AS co_orderdate_1#2739]
         :     :  +- Relation[rid#2706,cpfk_customer_orders#2707,cfpk_orders_customer#2708,cval_orders_o_orderstatus#2709,cval_orders_o_totalprice#2710,cval_orders_o_orderpriority#2711,cval_orders_o_clerk#2712,cval_orders_o_shippriority#2713,cval_orders_o_comment#2714,cval_orders_o_orderdate#2715,co_orderstatus#2716,co_totalprice#2717,co_orderpriority#2718,co_clerk#2719,co_shippriority#2720,co_comment#2721,co_orderdate#2722] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#2740 AS rid_2#2773, cpfk_orders_lineitem#2741 AS cpfk_orders_lineitem_2#2774, cpfk_supplier_lineitem#2742 AS cpfk_supplier_lineitem_2#2775, cfpk_lineitem_supplier#2743 AS cfpk_lineitem_supplier_2#2776, cfpk_lineitem_partsupp#2744 AS cfpk_lineitem_partsupp_2#2777, cpfk_part_lineitem#2745 AS cpfk_part_lineitem_2#2778, cfpk_lineitem_part#2746 AS cfpk_lineitem_part_2#2779, cpfk_partsupp_lineitem#2747 AS cpfk_partsupp_lineitem_2#2780, cfpk_lineitem_orders#2748 AS cfpk_lineitem_orders_2#2781, cval_lineitem_l_quantity#2749 AS cval_lineitem_l_quantity_2#2782, cval_lineitem_l_extendedprice#2750 AS cval_lineitem_l_extendedprice_2#2783, cval_lineitem_l_discount#2751 AS cval_lineitem_l_discount_2#2784, cval_lineitem_l_tax#2752 AS cval_lineitem_l_tax_2#2785, cval_lineitem_l_returnflag#2753 AS cval_lineitem_l_returnflag_2#2786, cval_lineitem_l_linestatus#2754 AS cval_lineitem_l_linestatus_2#2787, cval_lineitem_l_commitdate#2755 AS cval_lineitem_l_commitdate_2#2788, cval_lineitem_l_receiptdate#2756 AS cval_lineitem_l_receiptdate_2#2789, cval_lineitem_l_shipinstruct#2757 AS cval_lineitem_l_shipinstruct_2#2790, cval_lineitem_l_shipmode#2758 AS cval_lineitem_l_shipmode_2#2791, cval_lineitem_l_comment#2759 AS cval_lineitem_l_comment_2#2792, cval_lineitem_l_shipdate#2760 AS cval_lineitem_l_shipdate_2#2793, cl_quantity#2761 AS cl_quantity_2#2794, cl_extendedprice#2762 AS cl_extendedprice_2#2795, cl_discount#2763 AS cl_discount_2#2796, ... 9 more fields]
         :        +- Relation[rid#2740,cpfk_orders_lineitem#2741,cpfk_supplier_lineitem#2742,cfpk_lineitem_supplier#2743,cfpk_lineitem_partsupp#2744,cpfk_part_lineitem#2745,cfpk_lineitem_part#2746,cpfk_partsupp_lineitem#2747,cfpk_lineitem_orders#2748,cval_lineitem_l_quantity#2749,cval_lineitem_l_extendedprice#2750,cval_lineitem_l_discount#2751,cval_lineitem_l_tax#2752,cval_lineitem_l_returnflag#2753,cval_lineitem_l_linestatus#2754,cval_lineitem_l_commitdate#2755,cval_lineitem_l_receiptdate#2756,cval_lineitem_l_shipinstruct#2757,cval_lineitem_l_shipmode#2758,cval_lineitem_l_comment#2759,cval_lineitem_l_shipdate#2760,cl_quantity#2761,cl_extendedprice#2762,cl_discount#2763,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2640 AS rid_2#2673, cpfk_orders_lineitem#2641 AS cpfk_orders_lineitem_2#2674, cpfk_supplier_lineitem#2642 AS cpfk_supplier_lineitem_2#2675, cfpk_lineitem_supplier#2643 AS cfpk_lineitem_supplier_2#2676, cfpk_lineitem_partsupp#2644 AS cfpk_lineitem_partsupp_2#2677, cpfk_part_lineitem#2645 AS cpfk_part_lineitem_2#2678, cfpk_lineitem_part#2646 AS cfpk_lineitem_part_2#2679, cpfk_partsupp_lineitem#2647 AS cpfk_partsupp_lineitem_2#2680, cfpk_lineitem_orders#2648 AS cfpk_lineitem_orders_2#2681, cval_lineitem_l_quantity#2649 AS cval_lineitem_l_quantity_2#2682, cval_lineitem_l_extendedprice#2650 AS cval_lineitem_l_extendedprice_2#2683, cval_lineitem_l_discount#2651 AS cval_lineitem_l_discount_2#2684, cval_lineitem_l_tax#2652 AS cval_lineitem_l_tax_2#2685, cval_lineitem_l_returnflag#2653 AS cval_lineitem_l_returnflag_2#2686, cval_lineitem_l_linestatus#2654 AS cval_lineitem_l_linestatus_2#2687, cval_lineitem_l_commitdate#2655 AS cval_lineitem_l_commitdate_2#2688, cval_lineitem_l_receiptdate#2656 AS cval_lineitem_l_receiptdate_2#2689, cval_lineitem_l_shipinstruct#2657 AS cval_lineitem_l_shipinstruct_2#2690, cval_lineitem_l_shipmode#2658 AS cval_lineitem_l_shipmode_2#2691, cval_lineitem_l_comment#2659 AS cval_lineitem_l_comment_2#2692, cval_lineitem_l_shipdate#2660 AS cval_lineitem_l_shipdate_2#2693, cl_quantity#2661 AS cl_quantity_2#2694, cl_extendedprice#2662 AS cl_extendedprice_2#2695, cl_discount#2663 AS cl_discount_2#2696, ... 9 more fields]
            +- Relation[rid#2640,cpfk_orders_lineitem#2641,cpfk_supplier_lineitem#2642,cfpk_lineitem_supplier#2643,cfpk_lineitem_partsupp#2644,cpfk_part_lineitem#2645,cfpk_lineitem_part#2646,cpfk_partsupp_lineitem#2647,cfpk_lineitem_orders#2648,cval_lineitem_l_quantity#2649,cval_lineitem_l_extendedprice#2650,cval_lineitem_l_discount#2651,cval_lineitem_l_tax#2652,cval_lineitem_l_returnflag#2653,cval_lineitem_l_linestatus#2654,cval_lineitem_l_commitdate#2655,cval_lineitem_l_receiptdate#2656,cval_lineitem_l_shipinstruct#2657,cval_lineitem_l_shipmode#2658,cval_lineitem_l_comment#2659,cval_lineitem_l_shipdate#2660,cl_quantity#2661,cl_extendedprice#2662,cl_discount#2663,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 115678ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/11 08:03:58 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:03:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2879L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 08:03:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:03:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:03:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:03:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:03:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:03:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:03:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:03:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:03:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:03:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:03:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:03:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:03:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:03:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:03:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:03:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2879L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#2881 AS rid_0#2888, cpfk_region_nation#2882 AS cpfk_region_nation_0#2889, cfpk_nation_region#2883 AS cfpk_nation_region_0#2890, cval_nation_n_name#2884 AS cval_nation_n_name_0#2891, cval_nation_n_comment#2885 AS cval_nation_n_comment_0#2892, cn_name#2886 AS cn_name_0#2893, cn_comment#2887 AS cn_comment_0#2894]
            :  :  :  :  :  :  +- Relation[rid#2881,cpfk_region_nation#2882,cfpk_nation_region#2883,cval_nation_n_name#2884,cval_nation_n_comment#2885,cn_name#2886,cn_comment#2887] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#2895 AS rid_0#2902, cpfk_region_nation#2896 AS cpfk_region_nation_0#2903, cfpk_nation_region#2897 AS cfpk_nation_region_0#2904, cval_nation_n_name#2898 AS cval_nation_n_name_0#2905, cval_nation_n_comment#2899 AS cval_nation_n_comment_0#2906, cn_name#2900 AS cn_name_0#2907, cn_comment#2901 AS cn_comment_0#2908]
            :  :  :  :  :        +- Relation[rid#2895,cpfk_region_nation#2896,cfpk_nation_region#2897,cval_nation_n_name#2898,cval_nation_n_comment#2899,cn_name#2900,cn_comment#2901] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :     :- Project [rid#2935 AS rid_0#2942, cpfk_region_nation#2936 AS cpfk_region_nation_0#2943, cfpk_nation_region#2937 AS cfpk_nation_region_0#2944, cval_nation_n_name#2938 AS cval_nation_n_name_0#2945, cval_nation_n_comment#2939 AS cval_nation_n_comment_0#2946, cn_name#2940 AS cn_name_0#2947, cn_comment#2941 AS cn_comment_0#2948]
            :  :  :  :     :  +- Relation[rid#2935,cpfk_region_nation#2936,cfpk_nation_region#2937,cval_nation_n_name#2938,cval_nation_n_comment#2939,cn_name#2940,cn_comment#2941] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :     +- Project [rid#2949 AS rid_1#2962, cpfk_nation_supplier#2950 AS cpfk_nation_supplier_1#2963, cfpk_supplier_nation#2951 AS cfpk_supplier_nation_1#2964, cval_supplier_s_name#2952 AS cval_supplier_s_name_1#2965, cval_supplier_s_address#2953 AS cval_supplier_s_address_1#2966, cval_supplier_s_phone#2954 AS cval_supplier_s_phone_1#2967, cval_supplier_s_acctbal#2955 AS cval_supplier_s_acctbal_1#2968, cval_supplier_s_comment#2956 AS cval_supplier_s_comment_1#2969, cs_name#2957 AS cs_name_1#2970, cs_address#2958 AS cs_address_1#2971, cs_phone#2959 AS cs_phone_1#2972, cs_acctbal#2960 AS cs_acctbal_1#2973, cs_comment#2961 AS cs_comment_1#2974]
            :  :  :  :        +- Relation[rid#2949,cpfk_nation_supplier#2950,cfpk_supplier_nation#2951,cval_supplier_s_name#2952,cval_supplier_s_address#2953,cval_supplier_s_phone#2954,cval_supplier_s_acctbal#2955,cval_supplier_s_comment#2956,cs_name#2957,cs_address#2958,cs_phone#2959,cs_acctbal#2960,cs_comment#2961] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#2909 AS rid_1#2922, cpfk_nation_supplier#2910 AS cpfk_nation_supplier_1#2923, cfpk_supplier_nation#2911 AS cfpk_supplier_nation_1#2924, cval_supplier_s_name#2912 AS cval_supplier_s_name_1#2925, cval_supplier_s_address#2913 AS cval_supplier_s_address_1#2926, cval_supplier_s_phone#2914 AS cval_supplier_s_phone_1#2927, cval_supplier_s_acctbal#2915 AS cval_supplier_s_acctbal_1#2928, cval_supplier_s_comment#2916 AS cval_supplier_s_comment_1#2929, cs_name#2917 AS cs_name_1#2930, cs_address#2918 AS cs_address_1#2931, cs_phone#2919 AS cs_phone_1#2932, cs_acctbal#2920 AS cs_acctbal_1#2933, cs_comment#2921 AS cs_comment_1#2934]
            :  :  :     +- Relation[rid#2909,cpfk_nation_supplier#2910,cfpk_supplier_nation#2911,cval_supplier_s_name#2912,cval_supplier_s_address#2913,cval_supplier_s_phone#2914,cval_supplier_s_acctbal#2915,cval_supplier_s_comment#2916,cs_name#2917,cs_address#2918,cs_phone#2919,cs_acctbal#2920,cs_comment#2921] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :     :- Project [rid#3041 AS rid_1#3054, cpfk_nation_supplier#3042 AS cpfk_nation_supplier_1#3055, cfpk_supplier_nation#3043 AS cfpk_supplier_nation_1#3056, cval_supplier_s_name#3044 AS cval_supplier_s_name_1#3057, cval_supplier_s_address#3045 AS cval_supplier_s_address_1#3058, cval_supplier_s_phone#3046 AS cval_supplier_s_phone_1#3059, cval_supplier_s_acctbal#3047 AS cval_supplier_s_acctbal_1#3060, cval_supplier_s_comment#3048 AS cval_supplier_s_comment_1#3061, cs_name#3049 AS cs_name_1#3062, cs_address#3050 AS cs_address_1#3063, cs_phone#3051 AS cs_phone_1#3064, cs_acctbal#3052 AS cs_acctbal_1#3065, cs_comment#3053 AS cs_comment_1#3066]
            :  :     :  +- Relation[rid#3041,cpfk_nation_supplier#3042,cfpk_supplier_nation#3043,cval_supplier_s_name#3044,cval_supplier_s_address#3045,cval_supplier_s_phone#3046,cval_supplier_s_acctbal#3047,cval_supplier_s_comment#3048,cs_name#3049,cs_address#3050,cs_phone#3051,cs_acctbal#3052,cs_comment#3053] JDBCRelation(tsupplier) [numPartitions=1]
            :  :     +- Project [rid#3067 AS rid_2#3100, cpfk_orders_lineitem#3068 AS cpfk_orders_lineitem_2#3101, cpfk_supplier_lineitem#3069 AS cpfk_supplier_lineitem_2#3102, cfpk_lineitem_supplier#3070 AS cfpk_lineitem_supplier_2#3103, cfpk_lineitem_partsupp#3071 AS cfpk_lineitem_partsupp_2#3104, cpfk_part_lineitem#3072 AS cpfk_part_lineitem_2#3105, cfpk_lineitem_part#3073 AS cfpk_lineitem_part_2#3106, cpfk_partsupp_lineitem#3074 AS cpfk_partsupp_lineitem_2#3107, cfpk_lineitem_orders#3075 AS cfpk_lineitem_orders_2#3108, cval_lineitem_l_quantity#3076 AS cval_lineitem_l_quantity_2#3109, cval_lineitem_l_extendedprice#3077 AS cval_lineitem_l_extendedprice_2#3110, cval_lineitem_l_discount#3078 AS cval_lineitem_l_discount_2#3111, cval_lineitem_l_tax#3079 AS cval_lineitem_l_tax_2#3112, cval_lineitem_l_returnflag#3080 AS cval_lineitem_l_returnflag_2#3113, cval_lineitem_l_linestatus#3081 AS cval_lineitem_l_linestatus_2#3114, cval_lineitem_l_commitdate#3082 AS cval_lineitem_l_commitdate_2#3115, cval_lineitem_l_receiptdate#3083 AS cval_lineitem_l_receiptdate_2#3116, cval_lineitem_l_shipinstruct#3084 AS cval_lineitem_l_shipinstruct_2#3117, cval_lineitem_l_shipmode#3085 AS cval_lineitem_l_shipmode_2#3118, cval_lineitem_l_comment#3086 AS cval_lineitem_l_comment_2#3119, cval_lineitem_l_shipdate#3087 AS cval_lineitem_l_shipdate_2#3120, cl_quantity#3088 AS cl_quantity_2#3121, cl_extendedprice#3089 AS cl_extendedprice_2#3122, cl_discount#3090 AS cl_discount_2#3123, ... 9 more fields]
            :  :        +- Relation[rid#3067,cpfk_orders_lineitem#3068,cpfk_supplier_lineitem#3069,cfpk_lineitem_supplier#3070,cfpk_lineitem_partsupp#3071,cpfk_part_lineitem#3072,cfpk_lineitem_part#3073,cpfk_partsupp_lineitem#3074,cfpk_lineitem_orders#3075,cval_lineitem_l_quantity#3076,cval_lineitem_l_extendedprice#3077,cval_lineitem_l_discount#3078,cval_lineitem_l_tax#3079,cval_lineitem_l_returnflag#3080,cval_lineitem_l_linestatus#3081,cval_lineitem_l_commitdate#3082,cval_lineitem_l_receiptdate#3083,cval_lineitem_l_shipinstruct#3084,cval_lineitem_l_shipmode#3085,cval_lineitem_l_comment#3086,cval_lineitem_l_shipdate#3087,cl_quantity#3088,cl_extendedprice#3089,cl_discount#3090,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#2975 AS rid_2#3008, cpfk_orders_lineitem#2976 AS cpfk_orders_lineitem_2#3009, cpfk_supplier_lineitem#2977 AS cpfk_supplier_lineitem_2#3010, cfpk_lineitem_supplier#2978 AS cfpk_lineitem_supplier_2#3011, cfpk_lineitem_partsupp#2979 AS cfpk_lineitem_partsupp_2#3012, cpfk_part_lineitem#2980 AS cpfk_part_lineitem_2#3013, cfpk_lineitem_part#2981 AS cfpk_lineitem_part_2#3014, cpfk_partsupp_lineitem#2982 AS cpfk_partsupp_lineitem_2#3015, cfpk_lineitem_orders#2983 AS cfpk_lineitem_orders_2#3016, cval_lineitem_l_quantity#2984 AS cval_lineitem_l_quantity_2#3017, cval_lineitem_l_extendedprice#2985 AS cval_lineitem_l_extendedprice_2#3018, cval_lineitem_l_discount#2986 AS cval_lineitem_l_discount_2#3019, cval_lineitem_l_tax#2987 AS cval_lineitem_l_tax_2#3020, cval_lineitem_l_returnflag#2988 AS cval_lineitem_l_returnflag_2#3021, cval_lineitem_l_linestatus#2989 AS cval_lineitem_l_linestatus_2#3022, cval_lineitem_l_commitdate#2990 AS cval_lineitem_l_commitdate_2#3023, cval_lineitem_l_receiptdate#2991 AS cval_lineitem_l_receiptdate_2#3024, cval_lineitem_l_shipinstruct#2992 AS cval_lineitem_l_shipinstruct_2#3025, cval_lineitem_l_shipmode#2993 AS cval_lineitem_l_shipmode_2#3026, cval_lineitem_l_comment#2994 AS cval_lineitem_l_comment_2#3027, cval_lineitem_l_shipdate#2995 AS cval_lineitem_l_shipdate_2#3028, cl_quantity#2996 AS cl_quantity_2#3029, cl_extendedprice#2997 AS cl_extendedprice_2#3030, cl_discount#2998 AS cl_discount_2#3031, ... 9 more fields]
            :     +- Relation[rid#2975,cpfk_orders_lineitem#2976,cpfk_supplier_lineitem#2977,cfpk_lineitem_supplier#2978,cfpk_lineitem_partsupp#2979,cpfk_part_lineitem#2980,cfpk_lineitem_part#2981,cpfk_partsupp_lineitem#2982,cfpk_lineitem_orders#2983,cval_lineitem_l_quantity#2984,cval_lineitem_l_extendedprice#2985,cval_lineitem_l_discount#2986,cval_lineitem_l_tax#2987,cval_lineitem_l_returnflag#2988,cval_lineitem_l_linestatus#2989,cval_lineitem_l_commitdate#2990,cval_lineitem_l_receiptdate#2991,cval_lineitem_l_shipinstruct#2992,cval_lineitem_l_shipmode#2993,cval_lineitem_l_comment#2994,cval_lineitem_l_shipdate#2995,cl_quantity#2996,cl_extendedprice#2997,cl_discount#2998,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'Join UsingJoin(Inner,List(rid_4))
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'Join UsingJoin(Inner,List(rid_3))
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#3133 AS rid_3#3140, cpfk_region_nation#3134 AS cpfk_region_nation_3#3141, cfpk_nation_region#3135 AS cfpk_nation_region_3#3142, cval_nation_n_name#3136 AS cval_nation_n_name_3#3143, cval_nation_n_comment#3137 AS cval_nation_n_comment_3#3144, cn_name#3138 AS cn_name_3#3145, cn_comment#3139 AS cn_comment_3#3146]
               :  :  :  :  :  +- Relation[rid#3133,cpfk_region_nation#3134,cfpk_nation_region#3135,cval_nation_n_name#3136,cval_nation_n_comment#3137,cn_name#3138,cn_comment#3139] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#3147 AS rid_3#3154, cpfk_region_nation#3148 AS cpfk_region_nation_3#3155, cfpk_nation_region#3149 AS cfpk_nation_region_3#3156, cval_nation_n_name#3150 AS cval_nation_n_name_3#3157, cval_nation_n_comment#3151 AS cval_nation_n_comment_3#3158, cn_name#3152 AS cn_name_3#3159, cn_comment#3153 AS cn_comment_3#3160]
               :  :  :  :        +- Relation[rid#3147,cpfk_region_nation#3148,cfpk_nation_region#3149,cval_nation_n_name#3150,cval_nation_n_comment#3151,cn_name#3152,cn_comment#3153] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :     :- Project [rid#3191 AS rid_3#3198, cpfk_region_nation#3192 AS cpfk_region_nation_3#3199, cfpk_nation_region#3193 AS cfpk_nation_region_3#3200, cval_nation_n_name#3194 AS cval_nation_n_name_3#3201, cval_nation_n_comment#3195 AS cval_nation_n_comment_3#3202, cn_name#3196 AS cn_name_3#3203, cn_comment#3197 AS cn_comment_3#3204]
               :  :  :     :  +- Relation[rid#3191,cpfk_region_nation#3192,cfpk_nation_region#3193,cval_nation_n_name#3194,cval_nation_n_comment#3195,cn_name#3196,cn_comment#3197] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#3205 AS rid_4#3220, cpfk_nation_customer#3206 AS cpfk_nation_customer_4#3221, cfpk_customer_nation#3207 AS cfpk_customer_nation_4#3222, cval_customer_c_name#3208 AS cval_customer_c_name_4#3223, cval_customer_c_address#3209 AS cval_customer_c_address_4#3224, cval_customer_c_phone#3210 AS cval_customer_c_phone_4#3225, cval_customer_c_acctbal#3211 AS cval_customer_c_acctbal_4#3226, cval_customer_c_comment#3212 AS cval_customer_c_comment_4#3227, cval_customer_c_mktsegment#3213 AS cval_customer_c_mktsegment_4#3228, cc_name#3214 AS cc_name_4#3229, cc_address#3215 AS cc_address_4#3230, cc_phone#3216 AS cc_phone_4#3231, cc_acctbal#3217 AS cc_acctbal_4#3232, cc_comment#3218 AS cc_comment_4#3233, cc_mktsegment#3219 AS cc_mktsegment_4#3234]
               :  :  :        +- Relation[rid#3205,cpfk_nation_customer#3206,cfpk_customer_nation#3207,cval_customer_c_name#3208,cval_customer_c_address#3209,cval_customer_c_phone#3210,cval_customer_c_acctbal#3211,cval_customer_c_comment#3212,cval_customer_c_mktsegment#3213,cc_name#3214,cc_address#3215,cc_phone#3216,cc_acctbal#3217,cc_comment#3218,cc_mktsegment#3219] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#3161 AS rid_4#3176, cpfk_nation_customer#3162 AS cpfk_nation_customer_4#3177, cfpk_customer_nation#3163 AS cfpk_customer_nation_4#3178, cval_customer_c_name#3164 AS cval_customer_c_name_4#3179, cval_customer_c_address#3165 AS cval_customer_c_address_4#3180, cval_customer_c_phone#3166 AS cval_customer_c_phone_4#3181, cval_customer_c_acctbal#3167 AS cval_customer_c_acctbal_4#3182, cval_customer_c_comment#3168 AS cval_customer_c_comment_4#3183, cval_customer_c_mktsegment#3169 AS cval_customer_c_mktsegment_4#3184, cc_name#3170 AS cc_name_4#3185, cc_address#3171 AS cc_address_4#3186, cc_phone#3172 AS cc_phone_4#3187, cc_acctbal#3173 AS cc_acctbal_4#3188, cc_comment#3174 AS cc_comment_4#3189, cc_mktsegment#3175 AS cc_mktsegment_4#3190]
               :  :     +- Relation[rid#3161,cpfk_nation_customer#3162,cfpk_customer_nation#3163,cval_customer_c_name#3164,cval_customer_c_address#3165,cval_customer_c_phone#3166,cval_customer_c_acctbal#3167,cval_customer_c_comment#3168,cval_customer_c_mktsegment#3169,cc_name#3170,cc_address#3171,cc_phone#3172,cc_acctbal#3173,cc_comment#3174,cc_mktsegment#3175] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :     :- Project [rid#3269 AS rid_4#3284, cpfk_nation_customer#3270 AS cpfk_nation_customer_4#3285, cfpk_customer_nation#3271 AS cfpk_customer_nation_4#3286, cval_customer_c_name#3272 AS cval_customer_c_name_4#3287, cval_customer_c_address#3273 AS cval_customer_c_address_4#3288, cval_customer_c_phone#3274 AS cval_customer_c_phone_4#3289, cval_customer_c_acctbal#3275 AS cval_customer_c_acctbal_4#3290, cval_customer_c_comment#3276 AS cval_customer_c_comment_4#3291, cval_customer_c_mktsegment#3277 AS cval_customer_c_mktsegment_4#3292, cc_name#3278 AS cc_name_4#3293, cc_address#3279 AS cc_address_4#3294, cc_phone#3280 AS cc_phone_4#3295, cc_acctbal#3281 AS cc_acctbal_4#3296, cc_comment#3282 AS cc_comment_4#3297, cc_mktsegment#3283 AS cc_mktsegment_4#3298]
               :     :  +- Relation[rid#3269,cpfk_nation_customer#3270,cfpk_customer_nation#3271,cval_customer_c_name#3272,cval_customer_c_address#3273,cval_customer_c_phone#3274,cval_customer_c_acctbal#3275,cval_customer_c_comment#3276,cval_customer_c_mktsegment#3277,cc_name#3278,cc_address#3279,cc_phone#3280,cc_acctbal#3281,cc_comment#3282,cc_mktsegment#3283] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#3299 AS rid_5#3316, cpfk_customer_orders#3300 AS cpfk_customer_orders_5#3317, cfpk_orders_customer#3301 AS cfpk_orders_customer_5#3318, cval_orders_o_orderstatus#3302 AS cval_orders_o_orderstatus_5#3319, cval_orders_o_totalprice#3303 AS cval_orders_o_totalprice_5#3320, cval_orders_o_orderpriority#3304 AS cval_orders_o_orderpriority_5#3321, cval_orders_o_clerk#3305 AS cval_orders_o_clerk_5#3322, cval_orders_o_shippriority#3306 AS cval_orders_o_shippriority_5#3323, cval_orders_o_comment#3307 AS cval_orders_o_comment_5#3324, cval_orders_o_orderdate#3308 AS cval_orders_o_orderdate_5#3325, co_orderstatus#3309 AS co_orderstatus_5#3326, co_totalprice#3310 AS co_totalprice_5#3327, co_orderpriority#3311 AS co_orderpriority_5#3328, co_clerk#3312 AS co_clerk_5#3329, co_shippriority#3313 AS co_shippriority_5#3330, co_comment#3314 AS co_comment_5#3331, co_orderdate#3315 AS co_orderdate_5#3332]
               :        +- Relation[rid#3299,cpfk_customer_orders#3300,cfpk_orders_customer#3301,cval_orders_o_orderstatus#3302,cval_orders_o_totalprice#3303,cval_orders_o_orderpriority#3304,cval_orders_o_clerk#3305,cval_orders_o_shippriority#3306,cval_orders_o_comment#3307,cval_orders_o_orderdate#3308,co_orderstatus#3309,co_totalprice#3310,co_orderpriority#3311,co_clerk#3312,co_shippriority#3313,co_comment#3314,co_orderdate#3315] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#3235 AS rid_5#3252, cpfk_customer_orders#3236 AS cpfk_customer_orders_5#3253, cfpk_orders_customer#3237 AS cfpk_orders_customer_5#3254, cval_orders_o_orderstatus#3238 AS cval_orders_o_orderstatus_5#3255, cval_orders_o_totalprice#3239 AS cval_orders_o_totalprice_5#3256, cval_orders_o_orderpriority#3240 AS cval_orders_o_orderpriority_5#3257, cval_orders_o_clerk#3241 AS cval_orders_o_clerk_5#3258, cval_orders_o_shippriority#3242 AS cval_orders_o_shippriority_5#3259, cval_orders_o_comment#3243 AS cval_orders_o_comment_5#3260, cval_orders_o_orderdate#3244 AS cval_orders_o_orderdate_5#3261, co_orderstatus#3245 AS co_orderstatus_5#3262, co_totalprice#3246 AS co_totalprice_5#3263, co_orderpriority#3247 AS co_orderpriority_5#3264, co_clerk#3248 AS co_clerk_5#3265, co_shippriority#3249 AS co_shippriority_5#3266, co_comment#3250 AS co_comment_5#3267, co_orderdate#3251 AS co_orderdate_5#3268]
                  +- Relation[rid#3235,cpfk_customer_orders#3236,cfpk_orders_customer#3237,cval_orders_o_orderstatus#3238,cval_orders_o_totalprice#3239,cval_orders_o_orderpriority#3240,cval_orders_o_clerk#3241,cval_orders_o_shippriority#3242,cval_orders_o_comment#3243,cval_orders_o_orderdate#3244,co_orderstatus#3245,co_totalprice#3246,co_orderpriority#3247,co_clerk#3248,co_shippriority#3249,co_comment#3250,co_orderdate#3251] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 104517ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/11 08:05:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:05:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3453L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 08:05:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3453L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#3455 AS rid_0#3488, cpfk_orders_lineitem#3456 AS cpfk_orders_lineitem_0#3489, cpfk_supplier_lineitem#3457 AS cpfk_supplier_lineitem_0#3490, cfpk_lineitem_supplier#3458 AS cfpk_lineitem_supplier_0#3491, cfpk_lineitem_partsupp#3459 AS cfpk_lineitem_partsupp_0#3492, cpfk_part_lineitem#3460 AS cpfk_part_lineitem_0#3493, cfpk_lineitem_part#3461 AS cfpk_lineitem_part_0#3494, cpfk_partsupp_lineitem#3462 AS cpfk_partsupp_lineitem_0#3495, cfpk_lineitem_orders#3463 AS cfpk_lineitem_orders_0#3496, cval_lineitem_l_quantity#3464 AS cval_lineitem_l_quantity_0#3497, cval_lineitem_l_extendedprice#3465 AS cval_lineitem_l_extendedprice_0#3498, cval_lineitem_l_discount#3466 AS cval_lineitem_l_discount_0#3499, cval_lineitem_l_tax#3467 AS cval_lineitem_l_tax_0#3500, cval_lineitem_l_returnflag#3468 AS cval_lineitem_l_returnflag_0#3501, cval_lineitem_l_linestatus#3469 AS cval_lineitem_l_linestatus_0#3502, cval_lineitem_l_commitdate#3470 AS cval_lineitem_l_commitdate_0#3503, cval_lineitem_l_receiptdate#3471 AS cval_lineitem_l_receiptdate_0#3504, cval_lineitem_l_shipinstruct#3472 AS cval_lineitem_l_shipinstruct_0#3505, cval_lineitem_l_shipmode#3473 AS cval_lineitem_l_shipmode_0#3506, cval_lineitem_l_comment#3474 AS cval_lineitem_l_comment_0#3507, cval_lineitem_l_shipdate#3475 AS cval_lineitem_l_shipdate_0#3508, cl_quantity#3476 AS cl_quantity_0#3509, cl_extendedprice#3477 AS cl_extendedprice_0#3510, cl_discount#3478 AS cl_discount_0#3511, ... 9 more fields]
            :  +- Relation[rid#3455,cpfk_orders_lineitem#3456,cpfk_supplier_lineitem#3457,cfpk_lineitem_supplier#3458,cfpk_lineitem_partsupp#3459,cpfk_part_lineitem#3460,cfpk_lineitem_part#3461,cpfk_partsupp_lineitem#3462,cfpk_lineitem_orders#3463,cval_lineitem_l_quantity#3464,cval_lineitem_l_extendedprice#3465,cval_lineitem_l_discount#3466,cval_lineitem_l_tax#3467,cval_lineitem_l_returnflag#3468,cval_lineitem_l_linestatus#3469,cval_lineitem_l_commitdate#3470,cval_lineitem_l_receiptdate#3471,cval_lineitem_l_shipinstruct#3472,cval_lineitem_l_shipmode#3473,cval_lineitem_l_comment#3474,cval_lineitem_l_shipdate#3475,cl_quantity#3476,cl_extendedprice#3477,cl_discount#3478,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#3521 AS rid_1#3538, cpfk_customer_orders#3522 AS cpfk_customer_orders_1#3539, cfpk_orders_customer#3523 AS cfpk_orders_customer_1#3540, cval_orders_o_orderstatus#3524 AS cval_orders_o_orderstatus_1#3541, cval_orders_o_totalprice#3525 AS cval_orders_o_totalprice_1#3542, cval_orders_o_orderpriority#3526 AS cval_orders_o_orderpriority_1#3543, cval_orders_o_clerk#3527 AS cval_orders_o_clerk_1#3544, cval_orders_o_shippriority#3528 AS cval_orders_o_shippriority_1#3545, cval_orders_o_comment#3529 AS cval_orders_o_comment_1#3546, cval_orders_o_orderdate#3530 AS cval_orders_o_orderdate_1#3547, co_orderstatus#3531 AS co_orderstatus_1#3548, co_totalprice#3532 AS co_totalprice_1#3549, co_orderpriority#3533 AS co_orderpriority_1#3550, co_clerk#3534 AS co_clerk_1#3551, co_shippriority#3535 AS co_shippriority_1#3552, co_comment#3536 AS co_comment_1#3553, co_orderdate#3537 AS co_orderdate_1#3554]
               +- Relation[rid#3521,cpfk_customer_orders#3522,cfpk_orders_customer#3523,cval_orders_o_orderstatus#3524,cval_orders_o_totalprice#3525,cval_orders_o_orderpriority#3526,cval_orders_o_clerk#3527,cval_orders_o_shippriority#3528,cval_orders_o_comment#3529,cval_orders_o_orderdate#3530,co_orderstatus#3531,co_totalprice#3532,co_orderpriority#3533,co_clerk#3534,co_shippriority#3535,co_comment#3536,co_orderdate#3537] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 52601ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/11 08:06:35 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:06:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3610L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 08:06:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#3610L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#3612 AS rid_0#3645, cpfk_orders_lineitem#3613 AS cpfk_orders_lineitem_0#3646, cpfk_supplier_lineitem#3614 AS cpfk_supplier_lineitem_0#3647, cfpk_lineitem_supplier#3615 AS cfpk_lineitem_supplier_0#3648, cfpk_lineitem_partsupp#3616 AS cfpk_lineitem_partsupp_0#3649, cpfk_part_lineitem#3617 AS cpfk_part_lineitem_0#3650, cfpk_lineitem_part#3618 AS cfpk_lineitem_part_0#3651, cpfk_partsupp_lineitem#3619 AS cpfk_partsupp_lineitem_0#3652, cfpk_lineitem_orders#3620 AS cfpk_lineitem_orders_0#3653, cval_lineitem_l_quantity#3621 AS cval_lineitem_l_quantity_0#3654, cval_lineitem_l_extendedprice#3622 AS cval_lineitem_l_extendedprice_0#3655, cval_lineitem_l_discount#3623 AS cval_lineitem_l_discount_0#3656, cval_lineitem_l_tax#3624 AS cval_lineitem_l_tax_0#3657, cval_lineitem_l_returnflag#3625 AS cval_lineitem_l_returnflag_0#3658, cval_lineitem_l_linestatus#3626 AS cval_lineitem_l_linestatus_0#3659, cval_lineitem_l_commitdate#3627 AS cval_lineitem_l_commitdate_0#3660, cval_lineitem_l_receiptdate#3628 AS cval_lineitem_l_receiptdate_0#3661, cval_lineitem_l_shipinstruct#3629 AS cval_lineitem_l_shipinstruct_0#3662, cval_lineitem_l_shipmode#3630 AS cval_lineitem_l_shipmode_0#3663, cval_lineitem_l_comment#3631 AS cval_lineitem_l_comment_0#3664, cval_lineitem_l_shipdate#3632 AS cval_lineitem_l_shipdate_0#3665, cl_quantity#3633 AS cl_quantity_0#3666, cl_extendedprice#3634 AS cl_extendedprice_0#3667, cl_discount#3635 AS cl_discount_0#3668, ... 9 more fields]
         +- Relation[rid#3612,cpfk_orders_lineitem#3613,cpfk_supplier_lineitem#3614,cfpk_lineitem_supplier#3615,cfpk_lineitem_partsupp#3616,cpfk_part_lineitem#3617,cfpk_lineitem_part#3618,cpfk_partsupp_lineitem#3619,cfpk_lineitem_orders#3620,cval_lineitem_l_quantity#3621,cval_lineitem_l_extendedprice#3622,cval_lineitem_l_discount#3623,cval_lineitem_l_tax#3624,cval_lineitem_l_returnflag#3625,cval_lineitem_l_linestatus#3626,cval_lineitem_l_commitdate#3627,cval_lineitem_l_receiptdate#3628,cval_lineitem_l_shipinstruct#3629,cval_lineitem_l_shipmode#3630,cval_lineitem_l_comment#3631,cval_lineitem_l_shipdate#3632,cl_quantity#3633,cl_extendedprice#3634,cl_discount#3635,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2973ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/11 08:06:38 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:06:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3718L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 08:06:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:06:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:06:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:06:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3718L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#3720 AS rid_0#3733, cpfk_nation_supplier#3721 AS cpfk_nation_supplier_0#3734, cfpk_supplier_nation#3722 AS cfpk_supplier_nation_0#3735, cval_supplier_s_name#3723 AS cval_supplier_s_name_0#3736, cval_supplier_s_address#3724 AS cval_supplier_s_address_0#3737, cval_supplier_s_phone#3725 AS cval_supplier_s_phone_0#3738, cval_supplier_s_acctbal#3726 AS cval_supplier_s_acctbal_0#3739, cval_supplier_s_comment#3727 AS cval_supplier_s_comment_0#3740, cs_name#3728 AS cs_name_0#3741, cs_address#3729 AS cs_address_0#3742, cs_phone#3730 AS cs_phone_0#3743, cs_acctbal#3731 AS cs_acctbal_0#3744, cs_comment#3732 AS cs_comment_0#3745]
         :  :  +- Relation[rid#3720,cpfk_nation_supplier#3721,cfpk_supplier_nation#3722,cval_supplier_s_name#3723,cval_supplier_s_address#3724,cval_supplier_s_phone#3725,cval_supplier_s_acctbal#3726,cval_supplier_s_comment#3727,cs_name#3728,cs_address#3729,cs_phone#3730,cs_acctbal#3731,cs_comment#3732] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#3812 AS rid_0#3825, cpfk_nation_supplier#3813 AS cpfk_nation_supplier_0#3826, cfpk_supplier_nation#3814 AS cfpk_supplier_nation_0#3827, cval_supplier_s_name#3815 AS cval_supplier_s_name_0#3828, cval_supplier_s_address#3816 AS cval_supplier_s_address_0#3829, cval_supplier_s_phone#3817 AS cval_supplier_s_phone_0#3830, cval_supplier_s_acctbal#3818 AS cval_supplier_s_acctbal_0#3831, cval_supplier_s_comment#3819 AS cval_supplier_s_comment_0#3832, cs_name#3820 AS cs_name_0#3833, cs_address#3821 AS cs_address_0#3834, cs_phone#3822 AS cs_phone_0#3835, cs_acctbal#3823 AS cs_acctbal_0#3836, cs_comment#3824 AS cs_comment_0#3837]
         :     :  +- Relation[rid#3812,cpfk_nation_supplier#3813,cfpk_supplier_nation#3814,cval_supplier_s_name#3815,cval_supplier_s_address#3816,cval_supplier_s_phone#3817,cval_supplier_s_acctbal#3818,cval_supplier_s_comment#3819,cs_name#3820,cs_address#3821,cs_phone#3822,cs_acctbal#3823,cs_comment#3824] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#3838 AS rid_1#3871, cpfk_orders_lineitem#3839 AS cpfk_orders_lineitem_1#3872, cpfk_supplier_lineitem#3840 AS cpfk_supplier_lineitem_1#3873, cfpk_lineitem_supplier#3841 AS cfpk_lineitem_supplier_1#3874, cfpk_lineitem_partsupp#3842 AS cfpk_lineitem_partsupp_1#3875, cpfk_part_lineitem#3843 AS cpfk_part_lineitem_1#3876, cfpk_lineitem_part#3844 AS cfpk_lineitem_part_1#3877, cpfk_partsupp_lineitem#3845 AS cpfk_partsupp_lineitem_1#3878, cfpk_lineitem_orders#3846 AS cfpk_lineitem_orders_1#3879, cval_lineitem_l_quantity#3847 AS cval_lineitem_l_quantity_1#3880, cval_lineitem_l_extendedprice#3848 AS cval_lineitem_l_extendedprice_1#3881, cval_lineitem_l_discount#3849 AS cval_lineitem_l_discount_1#3882, cval_lineitem_l_tax#3850 AS cval_lineitem_l_tax_1#3883, cval_lineitem_l_returnflag#3851 AS cval_lineitem_l_returnflag_1#3884, cval_lineitem_l_linestatus#3852 AS cval_lineitem_l_linestatus_1#3885, cval_lineitem_l_commitdate#3853 AS cval_lineitem_l_commitdate_1#3886, cval_lineitem_l_receiptdate#3854 AS cval_lineitem_l_receiptdate_1#3887, cval_lineitem_l_shipinstruct#3855 AS cval_lineitem_l_shipinstruct_1#3888, cval_lineitem_l_shipmode#3856 AS cval_lineitem_l_shipmode_1#3889, cval_lineitem_l_comment#3857 AS cval_lineitem_l_comment_1#3890, cval_lineitem_l_shipdate#3858 AS cval_lineitem_l_shipdate_1#3891, cl_quantity#3859 AS cl_quantity_1#3892, cl_extendedprice#3860 AS cl_extendedprice_1#3893, cl_discount#3861 AS cl_discount_1#3894, ... 9 more fields]
         :        +- Relation[rid#3838,cpfk_orders_lineitem#3839,cpfk_supplier_lineitem#3840,cfpk_lineitem_supplier#3841,cfpk_lineitem_partsupp#3842,cpfk_part_lineitem#3843,cfpk_lineitem_part#3844,cpfk_partsupp_lineitem#3845,cfpk_lineitem_orders#3846,cval_lineitem_l_quantity#3847,cval_lineitem_l_extendedprice#3848,cval_lineitem_l_discount#3849,cval_lineitem_l_tax#3850,cval_lineitem_l_returnflag#3851,cval_lineitem_l_linestatus#3852,cval_lineitem_l_commitdate#3853,cval_lineitem_l_receiptdate#3854,cval_lineitem_l_shipinstruct#3855,cval_lineitem_l_shipmode#3856,cval_lineitem_l_comment#3857,cval_lineitem_l_shipdate#3858,cl_quantity#3859,cl_extendedprice#3860,cl_discount#3861,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#3746 AS rid_1#3779, cpfk_orders_lineitem#3747 AS cpfk_orders_lineitem_1#3780, cpfk_supplier_lineitem#3748 AS cpfk_supplier_lineitem_1#3781, cfpk_lineitem_supplier#3749 AS cfpk_lineitem_supplier_1#3782, cfpk_lineitem_partsupp#3750 AS cfpk_lineitem_partsupp_1#3783, cpfk_part_lineitem#3751 AS cpfk_part_lineitem_1#3784, cfpk_lineitem_part#3752 AS cfpk_lineitem_part_1#3785, cpfk_partsupp_lineitem#3753 AS cpfk_partsupp_lineitem_1#3786, cfpk_lineitem_orders#3754 AS cfpk_lineitem_orders_1#3787, cval_lineitem_l_quantity#3755 AS cval_lineitem_l_quantity_1#3788, cval_lineitem_l_extendedprice#3756 AS cval_lineitem_l_extendedprice_1#3789, cval_lineitem_l_discount#3757 AS cval_lineitem_l_discount_1#3790, cval_lineitem_l_tax#3758 AS cval_lineitem_l_tax_1#3791, cval_lineitem_l_returnflag#3759 AS cval_lineitem_l_returnflag_1#3792, cval_lineitem_l_linestatus#3760 AS cval_lineitem_l_linestatus_1#3793, cval_lineitem_l_commitdate#3761 AS cval_lineitem_l_commitdate_1#3794, cval_lineitem_l_receiptdate#3762 AS cval_lineitem_l_receiptdate_1#3795, cval_lineitem_l_shipinstruct#3763 AS cval_lineitem_l_shipinstruct_1#3796, cval_lineitem_l_shipmode#3764 AS cval_lineitem_l_shipmode_1#3797, cval_lineitem_l_comment#3765 AS cval_lineitem_l_comment_1#3798, cval_lineitem_l_shipdate#3766 AS cval_lineitem_l_shipdate_1#3799, cl_quantity#3767 AS cl_quantity_1#3800, cl_extendedprice#3768 AS cl_extendedprice_1#3801, cl_discount#3769 AS cl_discount_1#3802, ... 9 more fields]
            +- Relation[rid#3746,cpfk_orders_lineitem#3747,cpfk_supplier_lineitem#3748,cfpk_lineitem_supplier#3749,cfpk_lineitem_partsupp#3750,cpfk_part_lineitem#3751,cfpk_lineitem_part#3752,cpfk_partsupp_lineitem#3753,cfpk_lineitem_orders#3754,cval_lineitem_l_quantity#3755,cval_lineitem_l_extendedprice#3756,cval_lineitem_l_discount#3757,cval_lineitem_l_tax#3758,cval_lineitem_l_returnflag#3759,cval_lineitem_l_linestatus#3760,cval_lineitem_l_commitdate#3761,cval_lineitem_l_receiptdate#3762,cval_lineitem_l_shipinstruct#3763,cval_lineitem_l_shipmode#3764,cval_lineitem_l_comment#3765,cval_lineitem_l_shipdate#3766,cl_quantity#3767,cl_extendedprice#3768,cl_discount#3769,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 77940ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/11 08:07:56 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:07:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3955L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 08:07:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3955L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#3957 AS rid_0#3974, cpfk_customer_orders#3958 AS cpfk_customer_orders_0#3975, cfpk_orders_customer#3959 AS cfpk_orders_customer_0#3976, cval_orders_o_orderstatus#3960 AS cval_orders_o_orderstatus_0#3977, cval_orders_o_totalprice#3961 AS cval_orders_o_totalprice_0#3978, cval_orders_o_orderpriority#3962 AS cval_orders_o_orderpriority_0#3979, cval_orders_o_clerk#3963 AS cval_orders_o_clerk_0#3980, cval_orders_o_shippriority#3964 AS cval_orders_o_shippriority_0#3981, cval_orders_o_comment#3965 AS cval_orders_o_comment_0#3982, cval_orders_o_orderdate#3966 AS cval_orders_o_orderdate_0#3983, co_orderstatus#3967 AS co_orderstatus_0#3984, co_totalprice#3968 AS co_totalprice_0#3985, co_orderpriority#3969 AS co_orderpriority_0#3986, co_clerk#3970 AS co_clerk_0#3987, co_shippriority#3971 AS co_shippriority_0#3988, co_comment#3972 AS co_comment_0#3989, co_orderdate#3973 AS co_orderdate_0#3990]
            :  +- Relation[rid#3957,cpfk_customer_orders#3958,cfpk_orders_customer#3959,cval_orders_o_orderstatus#3960,cval_orders_o_totalprice#3961,cval_orders_o_orderpriority#3962,cval_orders_o_clerk#3963,cval_orders_o_shippriority#3964,cval_orders_o_comment#3965,cval_orders_o_orderdate#3966,co_orderstatus#3967,co_totalprice#3968,co_orderpriority#3969,co_clerk#3970,co_shippriority#3971,co_comment#3972,co_orderdate#3973] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#3991 AS rid_1#4006, cpfk_nation_customer#3992 AS cpfk_nation_customer_1#4007, cfpk_customer_nation#3993 AS cfpk_customer_nation_1#4008, cval_customer_c_name#3994 AS cval_customer_c_name_1#4009, cval_customer_c_address#3995 AS cval_customer_c_address_1#4010, cval_customer_c_phone#3996 AS cval_customer_c_phone_1#4011, cval_customer_c_acctbal#3997 AS cval_customer_c_acctbal_1#4012, cval_customer_c_comment#3998 AS cval_customer_c_comment_1#4013, cval_customer_c_mktsegment#3999 AS cval_customer_c_mktsegment_1#4014, cc_name#4000 AS cc_name_1#4015, cc_address#4001 AS cc_address_1#4016, cc_phone#4002 AS cc_phone_1#4017, cc_acctbal#4003 AS cc_acctbal_1#4018, cc_comment#4004 AS cc_comment_1#4019, cc_mktsegment#4005 AS cc_mktsegment_1#4020]
               +- Relation[rid#3991,cpfk_nation_customer#3992,cfpk_customer_nation#3993,cval_customer_c_name#3994,cval_customer_c_address#3995,cval_customer_c_phone#3996,cval_customer_c_acctbal#3997,cval_customer_c_comment#3998,cval_customer_c_mktsegment#3999,cc_name#4000,cc_address#4001,cc_phone#4002,cc_acctbal#4003,cc_comment#4004,cc_mktsegment#4005] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 12741ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/11 08:08:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:08:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4057L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 08:08:09 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 08:08:09 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 08:08:09 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 08:08:09 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 08:08:09 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 08:08:09 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 08:08:09 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 08:08:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4057L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#4059 AS rid_0#4076, cval_part_p_name#4060 AS cval_part_p_name_0#4077, cval_part_p_mfgr#4061 AS cval_part_p_mfgr_0#4078, cval_part_p_type#4062 AS cval_part_p_type_0#4079, cval_part_p_size#4063 AS cval_part_p_size_0#4080, cval_part_p_container#4064 AS cval_part_p_container_0#4081, cval_part_p_retailprice#4065 AS cval_part_p_retailprice_0#4082, cval_part_p_comment#4066 AS cval_part_p_comment_0#4083, cval_part_p_brand#4067 AS cval_part_p_brand_0#4084, cp_name#4068 AS cp_name_0#4085, cp_mfgr#4069 AS cp_mfgr_0#4086, cp_type#4070 AS cp_type_0#4087, cp_size#4071 AS cp_size_0#4088, cp_container#4072 AS cp_container_0#4089, cp_retailprice#4073 AS cp_retailprice_0#4090, cp_comment#4074 AS cp_comment_0#4091, cp_brand#4075 AS cp_brand_0#4092]
         :  :  :  :  +- Relation[rid#4059,cval_part_p_name#4060,cval_part_p_mfgr#4061,cval_part_p_type#4062,cval_part_p_size#4063,cval_part_p_container#4064,cval_part_p_retailprice#4065,cval_part_p_comment#4066,cval_part_p_brand#4067,cp_name#4068,cp_mfgr#4069,cp_type#4070,cp_size#4071,cp_container#4072,cp_retailprice#4073,cp_comment#4074,cp_brand#4075] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#4093 AS rid_0#4110, cval_part_p_name#4094 AS cval_part_p_name_0#4111, cval_part_p_mfgr#4095 AS cval_part_p_mfgr_0#4112, cval_part_p_type#4096 AS cval_part_p_type_0#4113, cval_part_p_size#4097 AS cval_part_p_size_0#4114, cval_part_p_container#4098 AS cval_part_p_container_0#4115, cval_part_p_retailprice#4099 AS cval_part_p_retailprice_0#4116, cval_part_p_comment#4100 AS cval_part_p_comment_0#4117, cval_part_p_brand#4101 AS cval_part_p_brand_0#4118, cp_name#4102 AS cp_name_0#4119, cp_mfgr#4103 AS cp_mfgr_0#4120, cp_type#4104 AS cp_type_0#4121, cp_size#4105 AS cp_size_0#4122, cp_container#4106 AS cp_container_0#4123, cp_retailprice#4107 AS cp_retailprice_0#4124, cp_comment#4108 AS cp_comment_0#4125, cp_brand#4109 AS cp_brand_0#4126]
         :  :  :        +- Relation[rid#4093,cval_part_p_name#4094,cval_part_p_mfgr#4095,cval_part_p_type#4096,cval_part_p_size#4097,cval_part_p_container#4098,cval_part_p_retailprice#4099,cval_part_p_comment#4100,cval_part_p_brand#4101,cp_name#4102,cp_mfgr#4103,cp_type#4104,cp_size#4105,cp_container#4106,cp_retailprice#4107,cp_comment#4108,cp_brand#4109] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#4127 AS rid_0#4144, cval_part_p_name#4128 AS cval_part_p_name_0#4145, cval_part_p_mfgr#4129 AS cval_part_p_mfgr_0#4146, cval_part_p_type#4130 AS cval_part_p_type_0#4147, cval_part_p_size#4131 AS cval_part_p_size_0#4148, cval_part_p_container#4132 AS cval_part_p_container_0#4149, cval_part_p_retailprice#4133 AS cval_part_p_retailprice_0#4150, cval_part_p_comment#4134 AS cval_part_p_comment_0#4151, cval_part_p_brand#4135 AS cval_part_p_brand_0#4152, cp_name#4136 AS cp_name_0#4153, cp_mfgr#4137 AS cp_mfgr_0#4154, cp_type#4138 AS cp_type_0#4155, cp_size#4139 AS cp_size_0#4156, cp_container#4140 AS cp_container_0#4157, cp_retailprice#4141 AS cp_retailprice_0#4158, cp_comment#4142 AS cp_comment_0#4159, cp_brand#4143 AS cp_brand_0#4160]
         :  :        +- Relation[rid#4127,cval_part_p_name#4128,cval_part_p_mfgr#4129,cval_part_p_type#4130,cval_part_p_size#4131,cval_part_p_container#4132,cval_part_p_retailprice#4133,cval_part_p_comment#4134,cval_part_p_brand#4135,cp_name#4136,cp_mfgr#4137,cp_type#4138,cp_size#4139,cp_container#4140,cp_retailprice#4141,cp_comment#4142,cp_brand#4143] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#4227 AS rid_0#4244, cval_part_p_name#4228 AS cval_part_p_name_0#4245, cval_part_p_mfgr#4229 AS cval_part_p_mfgr_0#4246, cval_part_p_type#4230 AS cval_part_p_type_0#4247, cval_part_p_size#4231 AS cval_part_p_size_0#4248, cval_part_p_container#4232 AS cval_part_p_container_0#4249, cval_part_p_retailprice#4233 AS cval_part_p_retailprice_0#4250, cval_part_p_comment#4234 AS cval_part_p_comment_0#4251, cval_part_p_brand#4235 AS cval_part_p_brand_0#4252, cp_name#4236 AS cp_name_0#4253, cp_mfgr#4237 AS cp_mfgr_0#4254, cp_type#4238 AS cp_type_0#4255, cp_size#4239 AS cp_size_0#4256, cp_container#4240 AS cp_container_0#4257, cp_retailprice#4241 AS cp_retailprice_0#4258, cp_comment#4242 AS cp_comment_0#4259, cp_brand#4243 AS cp_brand_0#4260]
         :     :  +- Relation[rid#4227,cval_part_p_name#4228,cval_part_p_mfgr#4229,cval_part_p_type#4230,cval_part_p_size#4231,cval_part_p_container#4232,cval_part_p_retailprice#4233,cval_part_p_comment#4234,cval_part_p_brand#4235,cp_name#4236,cp_mfgr#4237,cp_type#4238,cp_size#4239,cp_container#4240,cp_retailprice#4241,cp_comment#4242,cp_brand#4243] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#4261 AS rid_1#4294, cpfk_orders_lineitem#4262 AS cpfk_orders_lineitem_1#4295, cpfk_supplier_lineitem#4263 AS cpfk_supplier_lineitem_1#4296, cfpk_lineitem_supplier#4264 AS cfpk_lineitem_supplier_1#4297, cfpk_lineitem_partsupp#4265 AS cfpk_lineitem_partsupp_1#4298, cpfk_part_lineitem#4266 AS cpfk_part_lineitem_1#4299, cfpk_lineitem_part#4267 AS cfpk_lineitem_part_1#4300, cpfk_partsupp_lineitem#4268 AS cpfk_partsupp_lineitem_1#4301, cfpk_lineitem_orders#4269 AS cfpk_lineitem_orders_1#4302, cval_lineitem_l_quantity#4270 AS cval_lineitem_l_quantity_1#4303, cval_lineitem_l_extendedprice#4271 AS cval_lineitem_l_extendedprice_1#4304, cval_lineitem_l_discount#4272 AS cval_lineitem_l_discount_1#4305, cval_lineitem_l_tax#4273 AS cval_lineitem_l_tax_1#4306, cval_lineitem_l_returnflag#4274 AS cval_lineitem_l_returnflag_1#4307, cval_lineitem_l_linestatus#4275 AS cval_lineitem_l_linestatus_1#4308, cval_lineitem_l_commitdate#4276 AS cval_lineitem_l_commitdate_1#4309, cval_lineitem_l_receiptdate#4277 AS cval_lineitem_l_receiptdate_1#4310, cval_lineitem_l_shipinstruct#4278 AS cval_lineitem_l_shipinstruct_1#4311, cval_lineitem_l_shipmode#4279 AS cval_lineitem_l_shipmode_1#4312, cval_lineitem_l_comment#4280 AS cval_lineitem_l_comment_1#4313, cval_lineitem_l_shipdate#4281 AS cval_lineitem_l_shipdate_1#4314, cl_quantity#4282 AS cl_quantity_1#4315, cl_extendedprice#4283 AS cl_extendedprice_1#4316, cl_discount#4284 AS cl_discount_1#4317, ... 9 more fields]
         :        +- Relation[rid#4261,cpfk_orders_lineitem#4262,cpfk_supplier_lineitem#4263,cfpk_lineitem_supplier#4264,cfpk_lineitem_partsupp#4265,cpfk_part_lineitem#4266,cfpk_lineitem_part#4267,cpfk_partsupp_lineitem#4268,cfpk_lineitem_orders#4269,cval_lineitem_l_quantity#4270,cval_lineitem_l_extendedprice#4271,cval_lineitem_l_discount#4272,cval_lineitem_l_tax#4273,cval_lineitem_l_returnflag#4274,cval_lineitem_l_linestatus#4275,cval_lineitem_l_commitdate#4276,cval_lineitem_l_receiptdate#4277,cval_lineitem_l_shipinstruct#4278,cval_lineitem_l_shipmode#4279,cval_lineitem_l_comment#4280,cval_lineitem_l_shipdate#4281,cl_quantity#4282,cl_extendedprice#4283,cl_discount#4284,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4161 AS rid_1#4194, cpfk_orders_lineitem#4162 AS cpfk_orders_lineitem_1#4195, cpfk_supplier_lineitem#4163 AS cpfk_supplier_lineitem_1#4196, cfpk_lineitem_supplier#4164 AS cfpk_lineitem_supplier_1#4197, cfpk_lineitem_partsupp#4165 AS cfpk_lineitem_partsupp_1#4198, cpfk_part_lineitem#4166 AS cpfk_part_lineitem_1#4199, cfpk_lineitem_part#4167 AS cfpk_lineitem_part_1#4200, cpfk_partsupp_lineitem#4168 AS cpfk_partsupp_lineitem_1#4201, cfpk_lineitem_orders#4169 AS cfpk_lineitem_orders_1#4202, cval_lineitem_l_quantity#4170 AS cval_lineitem_l_quantity_1#4203, cval_lineitem_l_extendedprice#4171 AS cval_lineitem_l_extendedprice_1#4204, cval_lineitem_l_discount#4172 AS cval_lineitem_l_discount_1#4205, cval_lineitem_l_tax#4173 AS cval_lineitem_l_tax_1#4206, cval_lineitem_l_returnflag#4174 AS cval_lineitem_l_returnflag_1#4207, cval_lineitem_l_linestatus#4175 AS cval_lineitem_l_linestatus_1#4208, cval_lineitem_l_commitdate#4176 AS cval_lineitem_l_commitdate_1#4209, cval_lineitem_l_receiptdate#4177 AS cval_lineitem_l_receiptdate_1#4210, cval_lineitem_l_shipinstruct#4178 AS cval_lineitem_l_shipinstruct_1#4211, cval_lineitem_l_shipmode#4179 AS cval_lineitem_l_shipmode_1#4212, cval_lineitem_l_comment#4180 AS cval_lineitem_l_comment_1#4213, cval_lineitem_l_shipdate#4181 AS cval_lineitem_l_shipdate_1#4214, cl_quantity#4182 AS cl_quantity_1#4215, cl_extendedprice#4183 AS cl_extendedprice_1#4216, cl_discount#4184 AS cl_discount_1#4217, ... 9 more fields]
            +- Relation[rid#4161,cpfk_orders_lineitem#4162,cpfk_supplier_lineitem#4163,cfpk_lineitem_supplier#4164,cfpk_lineitem_partsupp#4165,cpfk_part_lineitem#4166,cfpk_lineitem_part#4167,cpfk_partsupp_lineitem#4168,cfpk_lineitem_orders#4169,cval_lineitem_l_quantity#4170,cval_lineitem_l_extendedprice#4171,cval_lineitem_l_discount#4172,cval_lineitem_l_tax#4173,cval_lineitem_l_returnflag#4174,cval_lineitem_l_linestatus#4175,cval_lineitem_l_commitdate#4176,cval_lineitem_l_receiptdate#4177,cval_lineitem_l_shipinstruct#4178,cval_lineitem_l_shipmode#4179,cval_lineitem_l_comment#4180,cval_lineitem_l_shipdate#4181,cl_quantity#4182,cl_extendedprice#4183,cl_discount#4184,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 71817ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/11 08:09:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:09:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4382L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 08:09:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:09:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:09:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:09:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:09:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:09:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:09:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:09:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:09:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:09:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:09:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:09:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:09:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:09:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4382L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#4384 AS rid_0#4401, cval_part_p_name#4385 AS cval_part_p_name_0#4402, cval_part_p_mfgr#4386 AS cval_part_p_mfgr_0#4403, cval_part_p_type#4387 AS cval_part_p_type_0#4404, cval_part_p_size#4388 AS cval_part_p_size_0#4405, cval_part_p_container#4389 AS cval_part_p_container_0#4406, cval_part_p_retailprice#4390 AS cval_part_p_retailprice_0#4407, cval_part_p_comment#4391 AS cval_part_p_comment_0#4408, cval_part_p_brand#4392 AS cval_part_p_brand_0#4409, cp_name#4393 AS cp_name_0#4410, cp_mfgr#4394 AS cp_mfgr_0#4411, cp_type#4395 AS cp_type_0#4412, cp_size#4396 AS cp_size_0#4413, cp_container#4397 AS cp_container_0#4414, cp_retailprice#4398 AS cp_retailprice_0#4415, cp_comment#4399 AS cp_comment_0#4416, cp_brand#4400 AS cp_brand_0#4417]
            :  :  :  :  +- Relation[rid#4384,cval_part_p_name#4385,cval_part_p_mfgr#4386,cval_part_p_type#4387,cval_part_p_size#4388,cval_part_p_container#4389,cval_part_p_retailprice#4390,cval_part_p_comment#4391,cval_part_p_brand#4392,cp_name#4393,cp_mfgr#4394,cp_type#4395,cp_size#4396,cp_container#4397,cp_retailprice#4398,cp_comment#4399,cp_brand#4400] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#4418 AS rid_0#4435, cval_part_p_name#4419 AS cval_part_p_name_0#4436, cval_part_p_mfgr#4420 AS cval_part_p_mfgr_0#4437, cval_part_p_type#4421 AS cval_part_p_type_0#4438, cval_part_p_size#4422 AS cval_part_p_size_0#4439, cval_part_p_container#4423 AS cval_part_p_container_0#4440, cval_part_p_retailprice#4424 AS cval_part_p_retailprice_0#4441, cval_part_p_comment#4425 AS cval_part_p_comment_0#4442, cval_part_p_brand#4426 AS cval_part_p_brand_0#4443, cp_name#4427 AS cp_name_0#4444, cp_mfgr#4428 AS cp_mfgr_0#4445, cp_type#4429 AS cp_type_0#4446, cp_size#4430 AS cp_size_0#4447, cp_container#4431 AS cp_container_0#4448, cp_retailprice#4432 AS cp_retailprice_0#4449, cp_comment#4433 AS cp_comment_0#4450, cp_brand#4434 AS cp_brand_0#4451]
            :  :  :        +- Relation[rid#4418,cval_part_p_name#4419,cval_part_p_mfgr#4420,cval_part_p_type#4421,cval_part_p_size#4422,cval_part_p_container#4423,cval_part_p_retailprice#4424,cval_part_p_comment#4425,cval_part_p_brand#4426,cp_name#4427,cp_mfgr#4428,cp_type#4429,cp_size#4430,cp_container#4431,cp_retailprice#4432,cp_comment#4433,cp_brand#4434] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :     :- Project [rid#4474 AS rid_0#4491, cval_part_p_name#4475 AS cval_part_p_name_0#4492, cval_part_p_mfgr#4476 AS cval_part_p_mfgr_0#4493, cval_part_p_type#4477 AS cval_part_p_type_0#4494, cval_part_p_size#4478 AS cval_part_p_size_0#4495, cval_part_p_container#4479 AS cval_part_p_container_0#4496, cval_part_p_retailprice#4480 AS cval_part_p_retailprice_0#4497, cval_part_p_comment#4481 AS cval_part_p_comment_0#4498, cval_part_p_brand#4482 AS cval_part_p_brand_0#4499, cp_name#4483 AS cp_name_0#4500, cp_mfgr#4484 AS cp_mfgr_0#4501, cp_type#4485 AS cp_type_0#4502, cp_size#4486 AS cp_size_0#4503, cp_container#4487 AS cp_container_0#4504, cp_retailprice#4488 AS cp_retailprice_0#4505, cp_comment#4489 AS cp_comment_0#4506, cp_brand#4490 AS cp_brand_0#4507]
            :  :     :  +- Relation[rid#4474,cval_part_p_name#4475,cval_part_p_mfgr#4476,cval_part_p_type#4477,cval_part_p_size#4478,cval_part_p_container#4479,cval_part_p_retailprice#4480,cval_part_p_comment#4481,cval_part_p_brand#4482,cp_name#4483,cp_mfgr#4484,cp_type#4485,cp_size#4486,cp_container#4487,cp_retailprice#4488,cp_comment#4489,cp_brand#4490] JDBCRelation(tpart) [numPartitions=1]
            :  :     +- Project [rid#4508 AS rid_1#4519, cpfk_part_partsupp#4509 AS cpfk_part_partsupp_1#4520, cfpk_partsupp_part#4510 AS cfpk_partsupp_part_1#4521, cpfk_supplier_partsupp#4511 AS cpfk_supplier_partsupp_1#4522, cfpk_partsupp_supplier#4512 AS cfpk_partsupp_supplier_1#4523, cval_partsupp_ps_availqty#4513 AS cval_partsupp_ps_availqty_1#4524, cval_partsupp_ps_supplycost#4514 AS cval_partsupp_ps_supplycost_1#4525, cval_partsupp_ps_comment#4515 AS cval_partsupp_ps_comment_1#4526, cps_availqty#4516 AS cps_availqty_1#4527, cps_supplycost#4517 AS cps_supplycost_1#4528, cps_comment#4518 AS cps_comment_1#4529]
            :  :        +- Relation[rid#4508,cpfk_part_partsupp#4509,cfpk_partsupp_part#4510,cpfk_supplier_partsupp#4511,cfpk_partsupp_supplier#4512,cval_partsupp_ps_availqty#4513,cval_partsupp_ps_supplycost#4514,cval_partsupp_ps_comment#4515,cps_availqty#4516,cps_supplycost#4517,cps_comment#4518] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#4452 AS rid_1#4463, cpfk_part_partsupp#4453 AS cpfk_part_partsupp_1#4464, cfpk_partsupp_part#4454 AS cfpk_partsupp_part_1#4465, cpfk_supplier_partsupp#4455 AS cpfk_supplier_partsupp_1#4466, cfpk_partsupp_supplier#4456 AS cfpk_partsupp_supplier_1#4467, cval_partsupp_ps_availqty#4457 AS cval_partsupp_ps_availqty_1#4468, cval_partsupp_ps_supplycost#4458 AS cval_partsupp_ps_supplycost_1#4469, cval_partsupp_ps_comment#4459 AS cval_partsupp_ps_comment_1#4470, cps_availqty#4460 AS cps_availqty_1#4471, cps_supplycost#4461 AS cps_supplycost_1#4472, cps_comment#4462 AS cps_comment_1#4473]
            :     +- Relation[rid#4452,cpfk_part_partsupp#4453,cfpk_partsupp_part#4454,cpfk_supplier_partsupp#4455,cfpk_partsupp_supplier#4456,cval_partsupp_ps_availqty#4457,cval_partsupp_ps_supplycost#4458,cval_partsupp_ps_comment#4459,cps_availqty#4460,cps_supplycost#4461,cps_comment#4462] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#4530 AS rid_2#4537, cpfk_region_nation#4531 AS cpfk_region_nation_2#4538, cfpk_nation_region#4532 AS cfpk_nation_region_2#4539, cval_nation_n_name#4533 AS cval_nation_n_name_2#4540, cval_nation_n_comment#4534 AS cval_nation_n_comment_2#4541, cn_name#4535 AS cn_name_2#4542, cn_comment#4536 AS cn_comment_2#4543]
               :  :  :  +- Relation[rid#4530,cpfk_region_nation#4531,cfpk_nation_region#4532,cval_nation_n_name#4533,cval_nation_n_comment#4534,cn_name#4535,cn_comment#4536] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#4544 AS rid_2#4551, cpfk_region_nation#4545 AS cpfk_region_nation_2#4552, cfpk_nation_region#4546 AS cfpk_nation_region_2#4553, cval_nation_n_name#4547 AS cval_nation_n_name_2#4554, cval_nation_n_comment#4548 AS cval_nation_n_comment_2#4555, cn_name#4549 AS cn_name_2#4556, cn_comment#4550 AS cn_comment_2#4557]
               :  :        +- Relation[rid#4544,cpfk_region_nation#4545,cfpk_nation_region#4546,cval_nation_n_name#4547,cval_nation_n_comment#4548,cn_name#4549,cn_comment#4550] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :     :- Project [rid#4584 AS rid_2#4591, cpfk_region_nation#4585 AS cpfk_region_nation_2#4592, cfpk_nation_region#4586 AS cfpk_nation_region_2#4593, cval_nation_n_name#4587 AS cval_nation_n_name_2#4594, cval_nation_n_comment#4588 AS cval_nation_n_comment_2#4595, cn_name#4589 AS cn_name_2#4596, cn_comment#4590 AS cn_comment_2#4597]
               :     :  +- Relation[rid#4584,cpfk_region_nation#4585,cfpk_nation_region#4586,cval_nation_n_name#4587,cval_nation_n_comment#4588,cn_name#4589,cn_comment#4590] JDBCRelation(tnation) [numPartitions=1]
               :     +- Project [rid#4598 AS rid_3#4611, cpfk_nation_supplier#4599 AS cpfk_nation_supplier_3#4612, cfpk_supplier_nation#4600 AS cfpk_supplier_nation_3#4613, cval_supplier_s_name#4601 AS cval_supplier_s_name_3#4614, cval_supplier_s_address#4602 AS cval_supplier_s_address_3#4615, cval_supplier_s_phone#4603 AS cval_supplier_s_phone_3#4616, cval_supplier_s_acctbal#4604 AS cval_supplier_s_acctbal_3#4617, cval_supplier_s_comment#4605 AS cval_supplier_s_comment_3#4618, cs_name#4606 AS cs_name_3#4619, cs_address#4607 AS cs_address_3#4620, cs_phone#4608 AS cs_phone_3#4621, cs_acctbal#4609 AS cs_acctbal_3#4622, cs_comment#4610 AS cs_comment_3#4623]
               :        +- Relation[rid#4598,cpfk_nation_supplier#4599,cfpk_supplier_nation#4600,cval_supplier_s_name#4601,cval_supplier_s_address#4602,cval_supplier_s_phone#4603,cval_supplier_s_acctbal#4604,cval_supplier_s_comment#4605,cs_name#4606,cs_address#4607,cs_phone#4608,cs_acctbal#4609,cs_comment#4610] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#4558 AS rid_3#4571, cpfk_nation_supplier#4559 AS cpfk_nation_supplier_3#4572, cfpk_supplier_nation#4560 AS cfpk_supplier_nation_3#4573, cval_supplier_s_name#4561 AS cval_supplier_s_name_3#4574, cval_supplier_s_address#4562 AS cval_supplier_s_address_3#4575, cval_supplier_s_phone#4563 AS cval_supplier_s_phone_3#4576, cval_supplier_s_acctbal#4564 AS cval_supplier_s_acctbal_3#4577, cval_supplier_s_comment#4565 AS cval_supplier_s_comment_3#4578, cs_name#4566 AS cs_name_3#4579, cs_address#4567 AS cs_address_3#4580, cs_phone#4568 AS cs_phone_3#4581, cs_acctbal#4569 AS cs_acctbal_3#4582, cs_comment#4570 AS cs_comment_3#4583]
                  +- Relation[rid#4558,cpfk_nation_supplier#4559,cfpk_supplier_nation#4560,cval_supplier_s_name#4561,cval_supplier_s_address#4562,cval_supplier_s_phone#4563,cval_supplier_s_acctbal#4564,cval_supplier_s_comment#4565,cs_name#4566,cs_address#4567,cs_phone#4568,cs_acctbal#4569,cs_comment#4570] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 11409ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/11 08:09:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:09:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4677L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 08:09:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#4677L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#4679 AS rid_0#4712, cpfk_orders_lineitem#4680 AS cpfk_orders_lineitem_0#4713, cpfk_supplier_lineitem#4681 AS cpfk_supplier_lineitem_0#4714, cfpk_lineitem_supplier#4682 AS cfpk_lineitem_supplier_0#4715, cfpk_lineitem_partsupp#4683 AS cfpk_lineitem_partsupp_0#4716, cpfk_part_lineitem#4684 AS cpfk_part_lineitem_0#4717, cfpk_lineitem_part#4685 AS cfpk_lineitem_part_0#4718, cpfk_partsupp_lineitem#4686 AS cpfk_partsupp_lineitem_0#4719, cfpk_lineitem_orders#4687 AS cfpk_lineitem_orders_0#4720, cval_lineitem_l_quantity#4688 AS cval_lineitem_l_quantity_0#4721, cval_lineitem_l_extendedprice#4689 AS cval_lineitem_l_extendedprice_0#4722, cval_lineitem_l_discount#4690 AS cval_lineitem_l_discount_0#4723, cval_lineitem_l_tax#4691 AS cval_lineitem_l_tax_0#4724, cval_lineitem_l_returnflag#4692 AS cval_lineitem_l_returnflag_0#4725, cval_lineitem_l_linestatus#4693 AS cval_lineitem_l_linestatus_0#4726, cval_lineitem_l_commitdate#4694 AS cval_lineitem_l_commitdate_0#4727, cval_lineitem_l_receiptdate#4695 AS cval_lineitem_l_receiptdate_0#4728, cval_lineitem_l_shipinstruct#4696 AS cval_lineitem_l_shipinstruct_0#4729, cval_lineitem_l_shipmode#4697 AS cval_lineitem_l_shipmode_0#4730, cval_lineitem_l_comment#4698 AS cval_lineitem_l_comment_0#4731, cval_lineitem_l_shipdate#4699 AS cval_lineitem_l_shipdate_0#4732, cl_quantity#4700 AS cl_quantity_0#4733, cl_extendedprice#4701 AS cl_extendedprice_0#4734, cl_discount#4702 AS cl_discount_0#4735, ... 9 more fields]
         +- Relation[rid#4679,cpfk_orders_lineitem#4680,cpfk_supplier_lineitem#4681,cfpk_lineitem_supplier#4682,cfpk_lineitem_partsupp#4683,cpfk_part_lineitem#4684,cfpk_lineitem_part#4685,cpfk_partsupp_lineitem#4686,cfpk_lineitem_orders#4687,cval_lineitem_l_quantity#4688,cval_lineitem_l_extendedprice#4689,cval_lineitem_l_discount#4690,cval_lineitem_l_tax#4691,cval_lineitem_l_returnflag#4692,cval_lineitem_l_linestatus#4693,cval_lineitem_l_commitdate#4694,cval_lineitem_l_receiptdate#4695,cval_lineitem_l_shipinstruct#4696,cval_lineitem_l_shipmode#4697,cval_lineitem_l_comment#4698,cval_lineitem_l_shipdate#4699,cl_quantity#4700,cl_extendedprice#4701,cl_discount#4702,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2933ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 08:09:35 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:09:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4787L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 08:09:35 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:09:35 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:09:35 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:09:35 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:09:35 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:09:35 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:09:35 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:09:35 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:09:35 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:09:35 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:09:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4787L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#4789 AS rid_0#4796, cpfk_region_nation#4790 AS cpfk_region_nation_0#4797, cfpk_nation_region#4791 AS cfpk_nation_region_0#4798, cval_nation_n_name#4792 AS cval_nation_n_name_0#4799, cval_nation_n_comment#4793 AS cval_nation_n_comment_0#4800, cn_name#4794 AS cn_name_0#4801, cn_comment#4795 AS cn_comment_0#4802]
            :     :     :  :  :  :  :  +- Relation[rid#4789,cpfk_region_nation#4790,cfpk_nation_region#4791,cval_nation_n_name#4792,cval_nation_n_comment#4793,cn_name#4794,cn_comment#4795] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#4829 AS rid_0#4836, cpfk_region_nation#4830 AS cpfk_region_nation_0#4837, cfpk_nation_region#4831 AS cfpk_nation_region_0#4838, cval_nation_n_name#4832 AS cval_nation_n_name_0#4839, cval_nation_n_comment#4833 AS cval_nation_n_comment_0#4840, cn_name#4834 AS cn_name_0#4841, cn_comment#4835 AS cn_comment_0#4842]
            :     :     :  :  :  :     :  +- Relation[rid#4829,cpfk_region_nation#4830,cfpk_nation_region#4831,cval_nation_n_name#4832,cval_nation_n_comment#4833,cn_name#4834,cn_comment#4835] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#4843 AS rid_1#4856, cpfk_nation_supplier#4844 AS cpfk_nation_supplier_1#4857, cfpk_supplier_nation#4845 AS cfpk_supplier_nation_1#4858, cval_supplier_s_name#4846 AS cval_supplier_s_name_1#4859, cval_supplier_s_address#4847 AS cval_supplier_s_address_1#4860, cval_supplier_s_phone#4848 AS cval_supplier_s_phone_1#4861, cval_supplier_s_acctbal#4849 AS cval_supplier_s_acctbal_1#4862, cval_supplier_s_comment#4850 AS cval_supplier_s_comment_1#4863, cs_name#4851 AS cs_name_1#4864, cs_address#4852 AS cs_address_1#4865, cs_phone#4853 AS cs_phone_1#4866, cs_acctbal#4854 AS cs_acctbal_1#4867, cs_comment#4855 AS cs_comment_1#4868]
            :     :     :  :  :  :        +- Relation[rid#4843,cpfk_nation_supplier#4844,cfpk_supplier_nation#4845,cval_supplier_s_name#4846,cval_supplier_s_address#4847,cval_supplier_s_phone#4848,cval_supplier_s_acctbal#4849,cval_supplier_s_comment#4850,cs_name#4851,cs_address#4852,cs_phone#4853,cs_acctbal#4854,cs_comment#4855] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#4803 AS rid_1#4816, cpfk_nation_supplier#4804 AS cpfk_nation_supplier_1#4817, cfpk_supplier_nation#4805 AS cfpk_supplier_nation_1#4818, cval_supplier_s_name#4806 AS cval_supplier_s_name_1#4819, cval_supplier_s_address#4807 AS cval_supplier_s_address_1#4820, cval_supplier_s_phone#4808 AS cval_supplier_s_phone_1#4821, cval_supplier_s_acctbal#4809 AS cval_supplier_s_acctbal_1#4822, cval_supplier_s_comment#4810 AS cval_supplier_s_comment_1#4823, cs_name#4811 AS cs_name_1#4824, cs_address#4812 AS cs_address_1#4825, cs_phone#4813 AS cs_phone_1#4826, cs_acctbal#4814 AS cs_acctbal_1#4827, cs_comment#4815 AS cs_comment_1#4828]
            :     :     :  :  :     +- Relation[rid#4803,cpfk_nation_supplier#4804,cfpk_supplier_nation#4805,cval_supplier_s_name#4806,cval_supplier_s_address#4807,cval_supplier_s_phone#4808,cval_supplier_s_acctbal#4809,cval_supplier_s_comment#4810,cs_name#4811,cs_address#4812,cs_phone#4813,cs_acctbal#4814,cs_comment#4815] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#4935 AS rid_1#4948, cpfk_nation_supplier#4936 AS cpfk_nation_supplier_1#4949, cfpk_supplier_nation#4937 AS cfpk_supplier_nation_1#4950, cval_supplier_s_name#4938 AS cval_supplier_s_name_1#4951, cval_supplier_s_address#4939 AS cval_supplier_s_address_1#4952, cval_supplier_s_phone#4940 AS cval_supplier_s_phone_1#4953, cval_supplier_s_acctbal#4941 AS cval_supplier_s_acctbal_1#4954, cval_supplier_s_comment#4942 AS cval_supplier_s_comment_1#4955, cs_name#4943 AS cs_name_1#4956, cs_address#4944 AS cs_address_1#4957, cs_phone#4945 AS cs_phone_1#4958, cs_acctbal#4946 AS cs_acctbal_1#4959, cs_comment#4947 AS cs_comment_1#4960]
            :     :     :  :     :  +- Relation[rid#4935,cpfk_nation_supplier#4936,cfpk_supplier_nation#4937,cval_supplier_s_name#4938,cval_supplier_s_address#4939,cval_supplier_s_phone#4940,cval_supplier_s_acctbal#4941,cval_supplier_s_comment#4942,cs_name#4943,cs_address#4944,cs_phone#4945,cs_acctbal#4946,cs_comment#4947] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#4961 AS rid_2#4994, cpfk_orders_lineitem#4962 AS cpfk_orders_lineitem_2#4995, cpfk_supplier_lineitem#4963 AS cpfk_supplier_lineitem_2#4996, cfpk_lineitem_supplier#4964 AS cfpk_lineitem_supplier_2#4997, cfpk_lineitem_partsupp#4965 AS cfpk_lineitem_partsupp_2#4998, cpfk_part_lineitem#4966 AS cpfk_part_lineitem_2#4999, cfpk_lineitem_part#4967 AS cfpk_lineitem_part_2#5000, cpfk_partsupp_lineitem#4968 AS cpfk_partsupp_lineitem_2#5001, cfpk_lineitem_orders#4969 AS cfpk_lineitem_orders_2#5002, cval_lineitem_l_quantity#4970 AS cval_lineitem_l_quantity_2#5003, cval_lineitem_l_extendedprice#4971 AS cval_lineitem_l_extendedprice_2#5004, cval_lineitem_l_discount#4972 AS cval_lineitem_l_discount_2#5005, cval_lineitem_l_tax#4973 AS cval_lineitem_l_tax_2#5006, cval_lineitem_l_returnflag#4974 AS cval_lineitem_l_returnflag_2#5007, cval_lineitem_l_linestatus#4975 AS cval_lineitem_l_linestatus_2#5008, cval_lineitem_l_commitdate#4976 AS cval_lineitem_l_commitdate_2#5009, cval_lineitem_l_receiptdate#4977 AS cval_lineitem_l_receiptdate_2#5010, cval_lineitem_l_shipinstruct#4978 AS cval_lineitem_l_shipinstruct_2#5011, cval_lineitem_l_shipmode#4979 AS cval_lineitem_l_shipmode_2#5012, cval_lineitem_l_comment#4980 AS cval_lineitem_l_comment_2#5013, cval_lineitem_l_shipdate#4981 AS cval_lineitem_l_shipdate_2#5014, cl_quantity#4982 AS cl_quantity_2#5015, cl_extendedprice#4983 AS cl_extendedprice_2#5016, cl_discount#4984 AS cl_discount_2#5017, ... 9 more fields]
            :     :     :  :        +- Relation[rid#4961,cpfk_orders_lineitem#4962,cpfk_supplier_lineitem#4963,cfpk_lineitem_supplier#4964,cfpk_lineitem_partsupp#4965,cpfk_part_lineitem#4966,cfpk_lineitem_part#4967,cpfk_partsupp_lineitem#4968,cfpk_lineitem_orders#4969,cval_lineitem_l_quantity#4970,cval_lineitem_l_extendedprice#4971,cval_lineitem_l_discount#4972,cval_lineitem_l_tax#4973,cval_lineitem_l_returnflag#4974,cval_lineitem_l_linestatus#4975,cval_lineitem_l_commitdate#4976,cval_lineitem_l_receiptdate#4977,cval_lineitem_l_shipinstruct#4978,cval_lineitem_l_shipmode#4979,cval_lineitem_l_comment#4980,cval_lineitem_l_shipdate#4981,cl_quantity#4982,cl_extendedprice#4983,cl_discount#4984,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#4869 AS rid_2#4902, cpfk_orders_lineitem#4870 AS cpfk_orders_lineitem_2#4903, cpfk_supplier_lineitem#4871 AS cpfk_supplier_lineitem_2#4904, cfpk_lineitem_supplier#4872 AS cfpk_lineitem_supplier_2#4905, cfpk_lineitem_partsupp#4873 AS cfpk_lineitem_partsupp_2#4906, cpfk_part_lineitem#4874 AS cpfk_part_lineitem_2#4907, cfpk_lineitem_part#4875 AS cfpk_lineitem_part_2#4908, cpfk_partsupp_lineitem#4876 AS cpfk_partsupp_lineitem_2#4909, cfpk_lineitem_orders#4877 AS cfpk_lineitem_orders_2#4910, cval_lineitem_l_quantity#4878 AS cval_lineitem_l_quantity_2#4911, cval_lineitem_l_extendedprice#4879 AS cval_lineitem_l_extendedprice_2#4912, cval_lineitem_l_discount#4880 AS cval_lineitem_l_discount_2#4913, cval_lineitem_l_tax#4881 AS cval_lineitem_l_tax_2#4914, cval_lineitem_l_returnflag#4882 AS cval_lineitem_l_returnflag_2#4915, cval_lineitem_l_linestatus#4883 AS cval_lineitem_l_linestatus_2#4916, cval_lineitem_l_commitdate#4884 AS cval_lineitem_l_commitdate_2#4917, cval_lineitem_l_receiptdate#4885 AS cval_lineitem_l_receiptdate_2#4918, cval_lineitem_l_shipinstruct#4886 AS cval_lineitem_l_shipinstruct_2#4919, cval_lineitem_l_shipmode#4887 AS cval_lineitem_l_shipmode_2#4920, cval_lineitem_l_comment#4888 AS cval_lineitem_l_comment_2#4921, cval_lineitem_l_shipdate#4889 AS cval_lineitem_l_shipdate_2#4922, cl_quantity#4890 AS cl_quantity_2#4923, cl_extendedprice#4891 AS cl_extendedprice_2#4924, cl_discount#4892 AS cl_discount_2#4925, ... 9 more fields]
            :     :     :     +- Relation[rid#4869,cpfk_orders_lineitem#4870,cpfk_supplier_lineitem#4871,cfpk_lineitem_supplier#4872,cfpk_lineitem_partsupp#4873,cpfk_part_lineitem#4874,cfpk_lineitem_part#4875,cpfk_partsupp_lineitem#4876,cfpk_lineitem_orders#4877,cval_lineitem_l_quantity#4878,cval_lineitem_l_extendedprice#4879,cval_lineitem_l_discount#4880,cval_lineitem_l_tax#4881,cval_lineitem_l_returnflag#4882,cval_lineitem_l_linestatus#4883,cval_lineitem_l_commitdate#4884,cval_lineitem_l_receiptdate#4885,cval_lineitem_l_shipinstruct#4886,cval_lineitem_l_shipmode#4887,cval_lineitem_l_comment#4888,cval_lineitem_l_shipdate#4889,cl_quantity#4890,cl_extendedprice#4891,cl_discount#4892,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#5027 AS rid_3#5044, cval_part_p_name#5028 AS cval_part_p_name_3#5045, cval_part_p_mfgr#5029 AS cval_part_p_mfgr_3#5046, cval_part_p_type#5030 AS cval_part_p_type_3#5047, cval_part_p_size#5031 AS cval_part_p_size_3#5048, cval_part_p_container#5032 AS cval_part_p_container_3#5049, cval_part_p_retailprice#5033 AS cval_part_p_retailprice_3#5050, cval_part_p_comment#5034 AS cval_part_p_comment_3#5051, cval_part_p_brand#5035 AS cval_part_p_brand_3#5052, cp_name#5036 AS cp_name_3#5053, cp_mfgr#5037 AS cp_mfgr_3#5054, cp_type#5038 AS cp_type_3#5055, cp_size#5039 AS cp_size_3#5056, cp_container#5040 AS cp_container_3#5057, cp_retailprice#5041 AS cp_retailprice_3#5058, cp_comment#5042 AS cp_comment_3#5059, cp_brand#5043 AS cp_brand_3#5060]
            :     :        +- Relation[rid#5027,cval_part_p_name#5028,cval_part_p_mfgr#5029,cval_part_p_type#5030,cval_part_p_size#5031,cval_part_p_container#5032,cval_part_p_retailprice#5033,cval_part_p_comment#5034,cval_part_p_brand#5035,cp_name#5036,cp_mfgr#5037,cp_type#5038,cp_size#5039,cp_container#5040,cp_retailprice#5041,cp_comment#5042,cp_brand#5043] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#5061 AS rid_4#5072, cpfk_part_partsupp#5062 AS cpfk_part_partsupp_4#5073, cfpk_partsupp_part#5063 AS cfpk_partsupp_part_4#5074, cpfk_supplier_partsupp#5064 AS cpfk_supplier_partsupp_4#5075, cfpk_partsupp_supplier#5065 AS cfpk_partsupp_supplier_4#5076, cval_partsupp_ps_availqty#5066 AS cval_partsupp_ps_availqty_4#5077, cval_partsupp_ps_supplycost#5067 AS cval_partsupp_ps_supplycost_4#5078, cval_partsupp_ps_comment#5068 AS cval_partsupp_ps_comment_4#5079, cps_availqty#5069 AS cps_availqty_4#5080, cps_supplycost#5070 AS cps_supplycost_4#5081, cps_comment#5071 AS cps_comment_4#5082]
            :        +- Relation[rid#5061,cpfk_part_partsupp#5062,cfpk_partsupp_part#5063,cpfk_supplier_partsupp#5064,cfpk_partsupp_supplier#5065,cval_partsupp_ps_availqty#5066,cval_partsupp_ps_supplycost#5067,cval_partsupp_ps_comment#5068,cps_availqty#5069,cps_supplycost#5070,cps_comment#5071] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#5083 AS rid_5#5100, cpfk_customer_orders#5084 AS cpfk_customer_orders_5#5101, cfpk_orders_customer#5085 AS cfpk_orders_customer_5#5102, cval_orders_o_orderstatus#5086 AS cval_orders_o_orderstatus_5#5103, cval_orders_o_totalprice#5087 AS cval_orders_o_totalprice_5#5104, cval_orders_o_orderpriority#5088 AS cval_orders_o_orderpriority_5#5105, cval_orders_o_clerk#5089 AS cval_orders_o_clerk_5#5106, cval_orders_o_shippriority#5090 AS cval_orders_o_shippriority_5#5107, cval_orders_o_comment#5091 AS cval_orders_o_comment_5#5108, cval_orders_o_orderdate#5092 AS cval_orders_o_orderdate_5#5109, co_orderstatus#5093 AS co_orderstatus_5#5110, co_totalprice#5094 AS co_totalprice_5#5111, co_orderpriority#5095 AS co_orderpriority_5#5112, co_clerk#5096 AS co_clerk_5#5113, co_shippriority#5097 AS co_shippriority_5#5114, co_comment#5098 AS co_comment_5#5115, co_orderdate#5099 AS co_orderdate_5#5116]
               +- Relation[rid#5083,cpfk_customer_orders#5084,cfpk_orders_customer#5085,cval_orders_o_orderstatus#5086,cval_orders_o_totalprice#5087,cval_orders_o_orderpriority#5088,cval_orders_o_clerk#5089,cval_orders_o_shippriority#5090,cval_orders_o_comment#5091,cval_orders_o_orderdate#5092,co_orderstatus#5093,co_totalprice#5094,co_orderpriority#5095,co_clerk#5096,co_shippriority#5097,co_comment#5098,co_orderdate#5099] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 245012ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/11 08:13:40 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:13:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5221L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 08:13:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:13:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:13:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:13:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:13:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:13:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:13:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:13:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:13:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:13:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:13:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:13:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:13:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:13:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5221L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#5223 AS rid_0#5230, cpfk_region_nation#5224 AS cpfk_region_nation_0#5231, cfpk_nation_region#5225 AS cfpk_nation_region_0#5232, cval_nation_n_name#5226 AS cval_nation_n_name_0#5233, cval_nation_n_comment#5227 AS cval_nation_n_comment_0#5234, cn_name#5228 AS cn_name_0#5235, cn_comment#5229 AS cn_comment_0#5236]
         :  :  :  :  :  +- Relation[rid#5223,cpfk_region_nation#5224,cfpk_nation_region#5225,cval_nation_n_name#5226,cval_nation_n_comment#5227,cn_name#5228,cn_comment#5229] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#5237 AS rid_0#5244, cpfk_region_nation#5238 AS cpfk_region_nation_0#5245, cfpk_nation_region#5239 AS cfpk_nation_region_0#5246, cval_nation_n_name#5240 AS cval_nation_n_name_0#5247, cval_nation_n_comment#5241 AS cval_nation_n_comment_0#5248, cn_name#5242 AS cn_name_0#5249, cn_comment#5243 AS cn_comment_0#5250]
         :  :  :  :        +- Relation[rid#5237,cpfk_region_nation#5238,cfpk_nation_region#5239,cval_nation_n_name#5240,cval_nation_n_comment#5241,cn_name#5242,cn_comment#5243] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :     :- Project [rid#5277 AS rid_0#5284, cpfk_region_nation#5278 AS cpfk_region_nation_0#5285, cfpk_nation_region#5279 AS cfpk_nation_region_0#5286, cval_nation_n_name#5280 AS cval_nation_n_name_0#5287, cval_nation_n_comment#5281 AS cval_nation_n_comment_0#5288, cn_name#5282 AS cn_name_0#5289, cn_comment#5283 AS cn_comment_0#5290]
         :  :  :     :  +- Relation[rid#5277,cpfk_region_nation#5278,cfpk_nation_region#5279,cval_nation_n_name#5280,cval_nation_n_comment#5281,cn_name#5282,cn_comment#5283] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#5291 AS rid_1#5304, cpfk_nation_supplier#5292 AS cpfk_nation_supplier_1#5305, cfpk_supplier_nation#5293 AS cfpk_supplier_nation_1#5306, cval_supplier_s_name#5294 AS cval_supplier_s_name_1#5307, cval_supplier_s_address#5295 AS cval_supplier_s_address_1#5308, cval_supplier_s_phone#5296 AS cval_supplier_s_phone_1#5309, cval_supplier_s_acctbal#5297 AS cval_supplier_s_acctbal_1#5310, cval_supplier_s_comment#5298 AS cval_supplier_s_comment_1#5311, cs_name#5299 AS cs_name_1#5312, cs_address#5300 AS cs_address_1#5313, cs_phone#5301 AS cs_phone_1#5314, cs_acctbal#5302 AS cs_acctbal_1#5315, cs_comment#5303 AS cs_comment_1#5316]
         :  :  :        +- Relation[rid#5291,cpfk_nation_supplier#5292,cfpk_supplier_nation#5293,cval_supplier_s_name#5294,cval_supplier_s_address#5295,cval_supplier_s_phone#5296,cval_supplier_s_acctbal#5297,cval_supplier_s_comment#5298,cs_name#5299,cs_address#5300,cs_phone#5301,cs_acctbal#5302,cs_comment#5303] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#5251 AS rid_1#5264, cpfk_nation_supplier#5252 AS cpfk_nation_supplier_1#5265, cfpk_supplier_nation#5253 AS cfpk_supplier_nation_1#5266, cval_supplier_s_name#5254 AS cval_supplier_s_name_1#5267, cval_supplier_s_address#5255 AS cval_supplier_s_address_1#5268, cval_supplier_s_phone#5256 AS cval_supplier_s_phone_1#5269, cval_supplier_s_acctbal#5257 AS cval_supplier_s_acctbal_1#5270, cval_supplier_s_comment#5258 AS cval_supplier_s_comment_1#5271, cs_name#5259 AS cs_name_1#5272, cs_address#5260 AS cs_address_1#5273, cs_phone#5261 AS cs_phone_1#5274, cs_acctbal#5262 AS cs_acctbal_1#5275, cs_comment#5263 AS cs_comment_1#5276]
         :  :     +- Relation[rid#5251,cpfk_nation_supplier#5252,cfpk_supplier_nation#5253,cval_supplier_s_name#5254,cval_supplier_s_address#5255,cval_supplier_s_phone#5256,cval_supplier_s_acctbal#5257,cval_supplier_s_comment#5258,cs_name#5259,cs_address#5260,cs_phone#5261,cs_acctbal#5262,cs_comment#5263] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :     :- Project [rid#5339 AS rid_1#5352, cpfk_nation_supplier#5340 AS cpfk_nation_supplier_1#5353, cfpk_supplier_nation#5341 AS cfpk_supplier_nation_1#5354, cval_supplier_s_name#5342 AS cval_supplier_s_name_1#5355, cval_supplier_s_address#5343 AS cval_supplier_s_address_1#5356, cval_supplier_s_phone#5344 AS cval_supplier_s_phone_1#5357, cval_supplier_s_acctbal#5345 AS cval_supplier_s_acctbal_1#5358, cval_supplier_s_comment#5346 AS cval_supplier_s_comment_1#5359, cs_name#5347 AS cs_name_1#5360, cs_address#5348 AS cs_address_1#5361, cs_phone#5349 AS cs_phone_1#5362, cs_acctbal#5350 AS cs_acctbal_1#5363, cs_comment#5351 AS cs_comment_1#5364]
         :     :  +- Relation[rid#5339,cpfk_nation_supplier#5340,cfpk_supplier_nation#5341,cval_supplier_s_name#5342,cval_supplier_s_address#5343,cval_supplier_s_phone#5344,cval_supplier_s_acctbal#5345,cval_supplier_s_comment#5346,cs_name#5347,cs_address#5348,cs_phone#5349,cs_acctbal#5350,cs_comment#5351] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#5365 AS rid_2#5376, cpfk_part_partsupp#5366 AS cpfk_part_partsupp_2#5377, cfpk_partsupp_part#5367 AS cfpk_partsupp_part_2#5378, cpfk_supplier_partsupp#5368 AS cpfk_supplier_partsupp_2#5379, cfpk_partsupp_supplier#5369 AS cfpk_partsupp_supplier_2#5380, cval_partsupp_ps_availqty#5370 AS cval_partsupp_ps_availqty_2#5381, cval_partsupp_ps_supplycost#5371 AS cval_partsupp_ps_supplycost_2#5382, cval_partsupp_ps_comment#5372 AS cval_partsupp_ps_comment_2#5383, cps_availqty#5373 AS cps_availqty_2#5384, cps_supplycost#5374 AS cps_supplycost_2#5385, cps_comment#5375 AS cps_comment_2#5386]
         :        +- Relation[rid#5365,cpfk_part_partsupp#5366,cfpk_partsupp_part#5367,cpfk_supplier_partsupp#5368,cfpk_partsupp_supplier#5369,cval_partsupp_ps_availqty#5370,cval_partsupp_ps_supplycost#5371,cval_partsupp_ps_comment#5372,cps_availqty#5373,cps_supplycost#5374,cps_comment#5375] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#5317 AS rid_2#5328, cpfk_part_partsupp#5318 AS cpfk_part_partsupp_2#5329, cfpk_partsupp_part#5319 AS cfpk_partsupp_part_2#5330, cpfk_supplier_partsupp#5320 AS cpfk_supplier_partsupp_2#5331, cfpk_partsupp_supplier#5321 AS cfpk_partsupp_supplier_2#5332, cval_partsupp_ps_availqty#5322 AS cval_partsupp_ps_availqty_2#5333, cval_partsupp_ps_supplycost#5323 AS cval_partsupp_ps_supplycost_2#5334, cval_partsupp_ps_comment#5324 AS cval_partsupp_ps_comment_2#5335, cps_availqty#5325 AS cps_availqty_2#5336, cps_supplycost#5326 AS cps_supplycost_2#5337, cps_comment#5327 AS cps_comment_2#5338]
            +- Relation[rid#5317,cpfk_part_partsupp#5318,cfpk_partsupp_part#5319,cpfk_supplier_partsupp#5320,cfpk_partsupp_supplier#5321,cval_partsupp_ps_availqty#5322,cval_partsupp_ps_supplycost#5323,cval_partsupp_ps_comment#5324,cps_availqty#5325,cps_supplycost#5326,cps_comment#5327] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 10301ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/11 08:13:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:13:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5422L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:13:51 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:13:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5422L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#5424 AS rid_0#5429, cval_region_r_name#5425 AS cval_region_r_name_0#5430, cval_region_r_comment#5426 AS cval_region_r_comment_0#5431, cr_name#5427 AS cr_name_0#5432, cr_comment#5428 AS cr_comment_0#5433]
         :  :  :  :  :  :  :  +- Relation[rid#5424,cval_region_r_name#5425,cval_region_r_comment#5426,cr_name#5427,cr_comment#5428] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#5434 AS rid_0#5439, cval_region_r_name#5435 AS cval_region_r_name_0#5440, cval_region_r_comment#5436 AS cval_region_r_comment_0#5441, cr_name#5437 AS cr_name_0#5442, cr_comment#5438 AS cr_comment_0#5443]
         :  :  :  :  :  :        +- Relation[rid#5434,cval_region_r_name#5435,cval_region_r_comment#5436,cr_name#5437,cr_comment#5438] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :     :- Project [rid#5458 AS rid_0#5463, cval_region_r_name#5459 AS cval_region_r_name_0#5464, cval_region_r_comment#5460 AS cval_region_r_comment_0#5465, cr_name#5461 AS cr_name_0#5466, cr_comment#5462 AS cr_comment_0#5467]
         :  :  :  :  :     :  +- Relation[rid#5458,cval_region_r_name#5459,cval_region_r_comment#5460,cr_name#5461,cr_comment#5462] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :     +- Project [rid#5468 AS rid_1#5475, cpfk_region_nation#5469 AS cpfk_region_nation_1#5476, cfpk_nation_region#5470 AS cfpk_nation_region_1#5477, cval_nation_n_name#5471 AS cval_nation_n_name_1#5478, cval_nation_n_comment#5472 AS cval_nation_n_comment_1#5479, cn_name#5473 AS cn_name_1#5480, cn_comment#5474 AS cn_comment_1#5481]
         :  :  :  :  :        +- Relation[rid#5468,cpfk_region_nation#5469,cfpk_nation_region#5470,cval_nation_n_name#5471,cval_nation_n_comment#5472,cn_name#5473,cn_comment#5474] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#5444 AS rid_1#5451, cpfk_region_nation#5445 AS cpfk_region_nation_1#5452, cfpk_nation_region#5446 AS cfpk_nation_region_1#5453, cval_nation_n_name#5447 AS cval_nation_n_name_1#5454, cval_nation_n_comment#5448 AS cval_nation_n_comment_1#5455, cn_name#5449 AS cn_name_1#5456, cn_comment#5450 AS cn_comment_1#5457]
         :  :  :  :     +- Relation[rid#5444,cpfk_region_nation#5445,cfpk_nation_region#5446,cval_nation_n_name#5447,cval_nation_n_comment#5448,cn_name#5449,cn_comment#5450] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :     :- Project [rid#5508 AS rid_1#5515, cpfk_region_nation#5509 AS cpfk_region_nation_1#5516, cfpk_nation_region#5510 AS cfpk_nation_region_1#5517, cval_nation_n_name#5511 AS cval_nation_n_name_1#5518, cval_nation_n_comment#5512 AS cval_nation_n_comment_1#5519, cn_name#5513 AS cn_name_1#5520, cn_comment#5514 AS cn_comment_1#5521]
         :  :  :     :  +- Relation[rid#5508,cpfk_region_nation#5509,cfpk_nation_region#5510,cval_nation_n_name#5511,cval_nation_n_comment#5512,cn_name#5513,cn_comment#5514] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#5522 AS rid_2#5535, cpfk_nation_supplier#5523 AS cpfk_nation_supplier_2#5536, cfpk_supplier_nation#5524 AS cfpk_supplier_nation_2#5537, cval_supplier_s_name#5525 AS cval_supplier_s_name_2#5538, cval_supplier_s_address#5526 AS cval_supplier_s_address_2#5539, cval_supplier_s_phone#5527 AS cval_supplier_s_phone_2#5540, cval_supplier_s_acctbal#5528 AS cval_supplier_s_acctbal_2#5541, cval_supplier_s_comment#5529 AS cval_supplier_s_comment_2#5542, cs_name#5530 AS cs_name_2#5543, cs_address#5531 AS cs_address_2#5544, cs_phone#5532 AS cs_phone_2#5545, cs_acctbal#5533 AS cs_acctbal_2#5546, cs_comment#5534 AS cs_comment_2#5547]
         :  :  :        +- Relation[rid#5522,cpfk_nation_supplier#5523,cfpk_supplier_nation#5524,cval_supplier_s_name#5525,cval_supplier_s_address#5526,cval_supplier_s_phone#5527,cval_supplier_s_acctbal#5528,cval_supplier_s_comment#5529,cs_name#5530,cs_address#5531,cs_phone#5532,cs_acctbal#5533,cs_comment#5534] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#5482 AS rid_2#5495, cpfk_nation_supplier#5483 AS cpfk_nation_supplier_2#5496, cfpk_supplier_nation#5484 AS cfpk_supplier_nation_2#5497, cval_supplier_s_name#5485 AS cval_supplier_s_name_2#5498, cval_supplier_s_address#5486 AS cval_supplier_s_address_2#5499, cval_supplier_s_phone#5487 AS cval_supplier_s_phone_2#5500, cval_supplier_s_acctbal#5488 AS cval_supplier_s_acctbal_2#5501, cval_supplier_s_comment#5489 AS cval_supplier_s_comment_2#5502, cs_name#5490 AS cs_name_2#5503, cs_address#5491 AS cs_address_2#5504, cs_phone#5492 AS cs_phone_2#5505, cs_acctbal#5493 AS cs_acctbal_2#5506, cs_comment#5494 AS cs_comment_2#5507]
         :  :     +- Relation[rid#5482,cpfk_nation_supplier#5483,cfpk_supplier_nation#5484,cval_supplier_s_name#5485,cval_supplier_s_address#5486,cval_supplier_s_phone#5487,cval_supplier_s_acctbal#5488,cval_supplier_s_comment#5489,cs_name#5490,cs_address#5491,cs_phone#5492,cs_acctbal#5493,cs_comment#5494] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :     :- Project [rid#5694 AS rid_2#5707, cpfk_nation_supplier#5695 AS cpfk_nation_supplier_2#5708, cfpk_supplier_nation#5696 AS cfpk_supplier_nation_2#5709, cval_supplier_s_name#5697 AS cval_supplier_s_name_2#5710, cval_supplier_s_address#5698 AS cval_supplier_s_address_2#5711, cval_supplier_s_phone#5699 AS cval_supplier_s_phone_2#5712, cval_supplier_s_acctbal#5700 AS cval_supplier_s_acctbal_2#5713, cval_supplier_s_comment#5701 AS cval_supplier_s_comment_2#5714, cs_name#5702 AS cs_name_2#5715, cs_address#5703 AS cs_address_2#5716, cs_phone#5704 AS cs_phone_2#5717, cs_acctbal#5705 AS cs_acctbal_2#5718, cs_comment#5706 AS cs_comment_2#5719]
         :     :  +- Relation[rid#5694,cpfk_nation_supplier#5695,cfpk_supplier_nation#5696,cval_supplier_s_name#5697,cval_supplier_s_address#5698,cval_supplier_s_phone#5699,cval_supplier_s_acctbal#5700,cval_supplier_s_comment#5701,cs_name#5702,cs_address#5703,cs_phone#5704,cs_acctbal#5705,cs_comment#5706] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#5720 AS rid_4#5731, cpfk_part_partsupp#5721 AS cpfk_part_partsupp_4#5732, cfpk_partsupp_part#5722 AS cfpk_partsupp_part_4#5733, cpfk_supplier_partsupp#5723 AS cpfk_supplier_partsupp_4#5734, cfpk_partsupp_supplier#5724 AS cfpk_partsupp_supplier_4#5735, cval_partsupp_ps_availqty#5725 AS cval_partsupp_ps_availqty_4#5736, cval_partsupp_ps_supplycost#5726 AS cval_partsupp_ps_supplycost_4#5737, cval_partsupp_ps_comment#5727 AS cval_partsupp_ps_comment_4#5738, cps_availqty#5728 AS cps_availqty_4#5739, cps_supplycost#5729 AS cps_supplycost_4#5740, cps_comment#5730 AS cps_comment_4#5741]
         :        +- Relation[rid#5720,cpfk_part_partsupp#5721,cfpk_partsupp_part#5722,cpfk_supplier_partsupp#5723,cfpk_partsupp_supplier#5724,cval_partsupp_ps_availqty#5725,cval_partsupp_ps_supplycost#5726,cval_partsupp_ps_comment#5727,cps_availqty#5728,cps_supplycost#5729,cps_comment#5730] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'Join UsingJoin(Inner,List(rid_3))
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#5548 AS rid_3#5565, cval_part_p_name#5549 AS cval_part_p_name_3#5566, cval_part_p_mfgr#5550 AS cval_part_p_mfgr_3#5567, cval_part_p_type#5551 AS cval_part_p_type_3#5568, cval_part_p_size#5552 AS cval_part_p_size_3#5569, cval_part_p_container#5553 AS cval_part_p_container_3#5570, cval_part_p_retailprice#5554 AS cval_part_p_retailprice_3#5571, cval_part_p_comment#5555 AS cval_part_p_comment_3#5572, cval_part_p_brand#5556 AS cval_part_p_brand_3#5573, cp_name#5557 AS cp_name_3#5574, cp_mfgr#5558 AS cp_mfgr_3#5575, cp_type#5559 AS cp_type_3#5576, cp_size#5560 AS cp_size_3#5577, cp_container#5561 AS cp_container_3#5578, cp_retailprice#5562 AS cp_retailprice_3#5579, cp_comment#5563 AS cp_comment_3#5580, cp_brand#5564 AS cp_brand_3#5581]
            :  :  :  +- Relation[rid#5548,cval_part_p_name#5549,cval_part_p_mfgr#5550,cval_part_p_type#5551,cval_part_p_size#5552,cval_part_p_container#5553,cval_part_p_retailprice#5554,cval_part_p_comment#5555,cval_part_p_brand#5556,cp_name#5557,cp_mfgr#5558,cp_type#5559,cp_size#5560,cp_container#5561,cp_retailprice#5562,cp_comment#5563,cp_brand#5564] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#5582 AS rid_3#5599, cval_part_p_name#5583 AS cval_part_p_name_3#5600, cval_part_p_mfgr#5584 AS cval_part_p_mfgr_3#5601, cval_part_p_type#5585 AS cval_part_p_type_3#5602, cval_part_p_size#5586 AS cval_part_p_size_3#5603, cval_part_p_container#5587 AS cval_part_p_container_3#5604, cval_part_p_retailprice#5588 AS cval_part_p_retailprice_3#5605, cval_part_p_comment#5589 AS cval_part_p_comment_3#5606, cval_part_p_brand#5590 AS cval_part_p_brand_3#5607, cp_name#5591 AS cp_name_3#5608, cp_mfgr#5592 AS cp_mfgr_3#5609, cp_type#5593 AS cp_type_3#5610, cp_size#5594 AS cp_size_3#5611, cp_container#5595 AS cp_container_3#5612, cp_retailprice#5596 AS cp_retailprice_3#5613, cp_comment#5597 AS cp_comment_3#5614, cp_brand#5598 AS cp_brand_3#5615]
            :  :        +- Relation[rid#5582,cval_part_p_name#5583,cval_part_p_mfgr#5584,cval_part_p_type#5585,cval_part_p_size#5586,cval_part_p_container#5587,cval_part_p_retailprice#5588,cval_part_p_comment#5589,cval_part_p_brand#5590,cp_name#5591,cp_mfgr#5592,cp_type#5593,cp_size#5594,cp_container#5595,cp_retailprice#5596,cp_comment#5597,cp_brand#5598] JDBCRelation(tpart) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :     :- Project [rid#5638 AS rid_3#5655, cval_part_p_name#5639 AS cval_part_p_name_3#5656, cval_part_p_mfgr#5640 AS cval_part_p_mfgr_3#5657, cval_part_p_type#5641 AS cval_part_p_type_3#5658, cval_part_p_size#5642 AS cval_part_p_size_3#5659, cval_part_p_container#5643 AS cval_part_p_container_3#5660, cval_part_p_retailprice#5644 AS cval_part_p_retailprice_3#5661, cval_part_p_comment#5645 AS cval_part_p_comment_3#5662, cval_part_p_brand#5646 AS cval_part_p_brand_3#5663, cp_name#5647 AS cp_name_3#5664, cp_mfgr#5648 AS cp_mfgr_3#5665, cp_type#5649 AS cp_type_3#5666, cp_size#5650 AS cp_size_3#5667, cp_container#5651 AS cp_container_3#5668, cp_retailprice#5652 AS cp_retailprice_3#5669, cp_comment#5653 AS cp_comment_3#5670, cp_brand#5654 AS cp_brand_3#5671]
            :     :  +- Relation[rid#5638,cval_part_p_name#5639,cval_part_p_mfgr#5640,cval_part_p_type#5641,cval_part_p_size#5642,cval_part_p_container#5643,cval_part_p_retailprice#5644,cval_part_p_comment#5645,cval_part_p_brand#5646,cp_name#5647,cp_mfgr#5648,cp_type#5649,cp_size#5650,cp_container#5651,cp_retailprice#5652,cp_comment#5653,cp_brand#5654] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#5672 AS rid_4#5683, cpfk_part_partsupp#5673 AS cpfk_part_partsupp_4#5684, cfpk_partsupp_part#5674 AS cfpk_partsupp_part_4#5685, cpfk_supplier_partsupp#5675 AS cpfk_supplier_partsupp_4#5686, cfpk_partsupp_supplier#5676 AS cfpk_partsupp_supplier_4#5687, cval_partsupp_ps_availqty#5677 AS cval_partsupp_ps_availqty_4#5688, cval_partsupp_ps_supplycost#5678 AS cval_partsupp_ps_supplycost_4#5689, cval_partsupp_ps_comment#5679 AS cval_partsupp_ps_comment_4#5690, cps_availqty#5680 AS cps_availqty_4#5691, cps_supplycost#5681 AS cps_supplycost_4#5692, cps_comment#5682 AS cps_comment_4#5693]
            :        +- Relation[rid#5672,cpfk_part_partsupp#5673,cfpk_partsupp_part#5674,cpfk_supplier_partsupp#5675,cfpk_partsupp_supplier#5676,cval_partsupp_ps_availqty#5677,cval_partsupp_ps_supplycost#5678,cval_partsupp_ps_comment#5679,cps_availqty#5680,cps_supplycost#5681,cps_comment#5682] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#5616 AS rid_4#5627, cpfk_part_partsupp#5617 AS cpfk_part_partsupp_4#5628, cfpk_partsupp_part#5618 AS cfpk_partsupp_part_4#5629, cpfk_supplier_partsupp#5619 AS cpfk_supplier_partsupp_4#5630, cfpk_partsupp_supplier#5620 AS cfpk_partsupp_supplier_4#5631, cval_partsupp_ps_availqty#5621 AS cval_partsupp_ps_availqty_4#5632, cval_partsupp_ps_supplycost#5622 AS cval_partsupp_ps_supplycost_4#5633, cval_partsupp_ps_comment#5623 AS cval_partsupp_ps_comment_4#5634, cps_availqty#5624 AS cps_availqty_4#5635, cps_supplycost#5625 AS cps_supplycost_4#5636, cps_comment#5626 AS cps_comment_4#5637]
               +- Relation[rid#5616,cpfk_part_partsupp#5617,cfpk_partsupp_part#5618,cpfk_supplier_partsupp#5619,cfpk_partsupp_supplier#5620,cval_partsupp_ps_availqty#5621,cval_partsupp_ps_supplycost#5622,cval_partsupp_ps_comment#5623,cps_availqty#5624,cps_supplycost#5625,cps_comment#5626] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 20282ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/11 08:14:11 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:14:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5799L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 08:14:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:14:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:14:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:14:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:14:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:14:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:14:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:14:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5799L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#5801 AS rid_0#5834, cpfk_orders_lineitem#5802 AS cpfk_orders_lineitem_0#5835, cpfk_supplier_lineitem#5803 AS cpfk_supplier_lineitem_0#5836, cfpk_lineitem_supplier#5804 AS cfpk_lineitem_supplier_0#5837, cfpk_lineitem_partsupp#5805 AS cfpk_lineitem_partsupp_0#5838, cpfk_part_lineitem#5806 AS cpfk_part_lineitem_0#5839, cfpk_lineitem_part#5807 AS cfpk_lineitem_part_0#5840, cpfk_partsupp_lineitem#5808 AS cpfk_partsupp_lineitem_0#5841, cfpk_lineitem_orders#5809 AS cfpk_lineitem_orders_0#5842, cval_lineitem_l_quantity#5810 AS cval_lineitem_l_quantity_0#5843, cval_lineitem_l_extendedprice#5811 AS cval_lineitem_l_extendedprice_0#5844, cval_lineitem_l_discount#5812 AS cval_lineitem_l_discount_0#5845, cval_lineitem_l_tax#5813 AS cval_lineitem_l_tax_0#5846, cval_lineitem_l_returnflag#5814 AS cval_lineitem_l_returnflag_0#5847, cval_lineitem_l_linestatus#5815 AS cval_lineitem_l_linestatus_0#5848, cval_lineitem_l_commitdate#5816 AS cval_lineitem_l_commitdate_0#5849, cval_lineitem_l_receiptdate#5817 AS cval_lineitem_l_receiptdate_0#5850, cval_lineitem_l_shipinstruct#5818 AS cval_lineitem_l_shipinstruct_0#5851, cval_lineitem_l_shipmode#5819 AS cval_lineitem_l_shipmode_0#5852, cval_lineitem_l_comment#5820 AS cval_lineitem_l_comment_0#5853, cval_lineitem_l_shipdate#5821 AS cval_lineitem_l_shipdate_0#5854, cl_quantity#5822 AS cl_quantity_0#5855, cl_extendedprice#5823 AS cl_extendedprice_0#5856, cl_discount#5824 AS cl_discount_0#5857, ... 9 more fields]
            :  +- Relation[rid#5801,cpfk_orders_lineitem#5802,cpfk_supplier_lineitem#5803,cfpk_lineitem_supplier#5804,cfpk_lineitem_partsupp#5805,cpfk_part_lineitem#5806,cfpk_lineitem_part#5807,cpfk_partsupp_lineitem#5808,cfpk_lineitem_orders#5809,cval_lineitem_l_quantity#5810,cval_lineitem_l_extendedprice#5811,cval_lineitem_l_discount#5812,cval_lineitem_l_tax#5813,cval_lineitem_l_returnflag#5814,cval_lineitem_l_linestatus#5815,cval_lineitem_l_commitdate#5816,cval_lineitem_l_receiptdate#5817,cval_lineitem_l_shipinstruct#5818,cval_lineitem_l_shipmode#5819,cval_lineitem_l_comment#5820,cval_lineitem_l_shipdate#5821,cl_quantity#5822,cl_extendedprice#5823,cl_discount#5824,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#5867 AS rid_1#5884, cpfk_customer_orders#5868 AS cpfk_customer_orders_1#5885, cfpk_orders_customer#5869 AS cfpk_orders_customer_1#5886, cval_orders_o_orderstatus#5870 AS cval_orders_o_orderstatus_1#5887, cval_orders_o_totalprice#5871 AS cval_orders_o_totalprice_1#5888, cval_orders_o_orderpriority#5872 AS cval_orders_o_orderpriority_1#5889, cval_orders_o_clerk#5873 AS cval_orders_o_clerk_1#5890, cval_orders_o_shippriority#5874 AS cval_orders_o_shippriority_1#5891, cval_orders_o_comment#5875 AS cval_orders_o_comment_1#5892, cval_orders_o_orderdate#5876 AS cval_orders_o_orderdate_1#5893, co_orderstatus#5877 AS co_orderstatus_1#5894, co_totalprice#5878 AS co_totalprice_1#5895, co_orderpriority#5879 AS co_orderpriority_1#5896, co_clerk#5880 AS co_clerk_1#5897, co_shippriority#5881 AS co_shippriority_1#5898, co_comment#5882 AS co_comment_1#5899, co_orderdate#5883 AS co_orderdate_1#5900]
                  :     :  :  :  :  +- Relation[rid#5867,cpfk_customer_orders#5868,cfpk_orders_customer#5869,cval_orders_o_orderstatus#5870,cval_orders_o_totalprice#5871,cval_orders_o_orderpriority#5872,cval_orders_o_clerk#5873,cval_orders_o_shippriority#5874,cval_orders_o_comment#5875,cval_orders_o_orderdate#5876,co_orderstatus#5877,co_totalprice#5878,co_orderpriority#5879,co_clerk#5880,co_shippriority#5881,co_comment#5882,co_orderdate#5883] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#5901 AS rid_1#5918, cpfk_customer_orders#5902 AS cpfk_customer_orders_1#5919, cfpk_orders_customer#5903 AS cfpk_orders_customer_1#5920, cval_orders_o_orderstatus#5904 AS cval_orders_o_orderstatus_1#5921, cval_orders_o_totalprice#5905 AS cval_orders_o_totalprice_1#5922, cval_orders_o_orderpriority#5906 AS cval_orders_o_orderpriority_1#5923, cval_orders_o_clerk#5907 AS cval_orders_o_clerk_1#5924, cval_orders_o_shippriority#5908 AS cval_orders_o_shippriority_1#5925, cval_orders_o_comment#5909 AS cval_orders_o_comment_1#5926, cval_orders_o_orderdate#5910 AS cval_orders_o_orderdate_1#5927, co_orderstatus#5911 AS co_orderstatus_1#5928, co_totalprice#5912 AS co_totalprice_1#5929, co_orderpriority#5913 AS co_orderpriority_1#5930, co_clerk#5914 AS co_clerk_1#5931, co_shippriority#5915 AS co_shippriority_1#5932, co_comment#5916 AS co_comment_1#5933, co_orderdate#5917 AS co_orderdate_1#5934]
                  :     :  :  :        +- Relation[rid#5901,cpfk_customer_orders#5902,cfpk_orders_customer#5903,cval_orders_o_orderstatus#5904,cval_orders_o_totalprice#5905,cval_orders_o_orderpriority#5906,cval_orders_o_clerk#5907,cval_orders_o_shippriority#5908,cval_orders_o_comment#5909,cval_orders_o_orderdate#5910,co_orderstatus#5911,co_totalprice#5912,co_orderpriority#5913,co_clerk#5914,co_shippriority#5915,co_comment#5916,co_orderdate#5917] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :     :- Project [rid#6001 AS rid_1#6018, cpfk_customer_orders#6002 AS cpfk_customer_orders_1#6019, cfpk_orders_customer#6003 AS cfpk_orders_customer_1#6020, cval_orders_o_orderstatus#6004 AS cval_orders_o_orderstatus_1#6021, cval_orders_o_totalprice#6005 AS cval_orders_o_totalprice_1#6022, cval_orders_o_orderpriority#6006 AS cval_orders_o_orderpriority_1#6023, cval_orders_o_clerk#6007 AS cval_orders_o_clerk_1#6024, cval_orders_o_shippriority#6008 AS cval_orders_o_shippriority_1#6025, cval_orders_o_comment#6009 AS cval_orders_o_comment_1#6026, cval_orders_o_orderdate#6010 AS cval_orders_o_orderdate_1#6027, co_orderstatus#6011 AS co_orderstatus_1#6028, co_totalprice#6012 AS co_totalprice_1#6029, co_orderpriority#6013 AS co_orderpriority_1#6030, co_clerk#6014 AS co_clerk_1#6031, co_shippriority#6015 AS co_shippriority_1#6032, co_comment#6016 AS co_comment_1#6033, co_orderdate#6017 AS co_orderdate_1#6034]
                  :     :  :     :  +- Relation[rid#6001,cpfk_customer_orders#6002,cfpk_orders_customer#6003,cval_orders_o_orderstatus#6004,cval_orders_o_totalprice#6005,cval_orders_o_orderpriority#6006,cval_orders_o_clerk#6007,cval_orders_o_shippriority#6008,cval_orders_o_comment#6009,cval_orders_o_orderdate#6010,co_orderstatus#6011,co_totalprice#6012,co_orderpriority#6013,co_clerk#6014,co_shippriority#6015,co_comment#6016,co_orderdate#6017] JDBCRelation(torders) [numPartitions=1]
                  :     :  :     +- Project [rid#6035 AS rid_2#6068, cpfk_orders_lineitem#6036 AS cpfk_orders_lineitem_2#6069, cpfk_supplier_lineitem#6037 AS cpfk_supplier_lineitem_2#6070, cfpk_lineitem_supplier#6038 AS cfpk_lineitem_supplier_2#6071, cfpk_lineitem_partsupp#6039 AS cfpk_lineitem_partsupp_2#6072, cpfk_part_lineitem#6040 AS cpfk_part_lineitem_2#6073, cfpk_lineitem_part#6041 AS cfpk_lineitem_part_2#6074, cpfk_partsupp_lineitem#6042 AS cpfk_partsupp_lineitem_2#6075, cfpk_lineitem_orders#6043 AS cfpk_lineitem_orders_2#6076, cval_lineitem_l_quantity#6044 AS cval_lineitem_l_quantity_2#6077, cval_lineitem_l_extendedprice#6045 AS cval_lineitem_l_extendedprice_2#6078, cval_lineitem_l_discount#6046 AS cval_lineitem_l_discount_2#6079, cval_lineitem_l_tax#6047 AS cval_lineitem_l_tax_2#6080, cval_lineitem_l_returnflag#6048 AS cval_lineitem_l_returnflag_2#6081, cval_lineitem_l_linestatus#6049 AS cval_lineitem_l_linestatus_2#6082, cval_lineitem_l_commitdate#6050 AS cval_lineitem_l_commitdate_2#6083, cval_lineitem_l_receiptdate#6051 AS cval_lineitem_l_receiptdate_2#6084, cval_lineitem_l_shipinstruct#6052 AS cval_lineitem_l_shipinstruct_2#6085, cval_lineitem_l_shipmode#6053 AS cval_lineitem_l_shipmode_2#6086, cval_lineitem_l_comment#6054 AS cval_lineitem_l_comment_2#6087, cval_lineitem_l_shipdate#6055 AS cval_lineitem_l_shipdate_2#6088, cl_quantity#6056 AS cl_quantity_2#6089, cl_extendedprice#6057 AS cl_extendedprice_2#6090, cl_discount#6058 AS cl_discount_2#6091, ... 9 more fields]
                  :     :  :        +- Relation[rid#6035,cpfk_orders_lineitem#6036,cpfk_supplier_lineitem#6037,cfpk_lineitem_supplier#6038,cfpk_lineitem_partsupp#6039,cpfk_part_lineitem#6040,cfpk_lineitem_part#6041,cpfk_partsupp_lineitem#6042,cfpk_lineitem_orders#6043,cval_lineitem_l_quantity#6044,cval_lineitem_l_extendedprice#6045,cval_lineitem_l_discount#6046,cval_lineitem_l_tax#6047,cval_lineitem_l_returnflag#6048,cval_lineitem_l_linestatus#6049,cval_lineitem_l_commitdate#6050,cval_lineitem_l_receiptdate#6051,cval_lineitem_l_shipinstruct#6052,cval_lineitem_l_shipmode#6053,cval_lineitem_l_comment#6054,cval_lineitem_l_shipdate#6055,cl_quantity#6056,cl_extendedprice#6057,cl_discount#6058,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#5935 AS rid_2#5968, cpfk_orders_lineitem#5936 AS cpfk_orders_lineitem_2#5969, cpfk_supplier_lineitem#5937 AS cpfk_supplier_lineitem_2#5970, cfpk_lineitem_supplier#5938 AS cfpk_lineitem_supplier_2#5971, cfpk_lineitem_partsupp#5939 AS cfpk_lineitem_partsupp_2#5972, cpfk_part_lineitem#5940 AS cpfk_part_lineitem_2#5973, cfpk_lineitem_part#5941 AS cfpk_lineitem_part_2#5974, cpfk_partsupp_lineitem#5942 AS cpfk_partsupp_lineitem_2#5975, cfpk_lineitem_orders#5943 AS cfpk_lineitem_orders_2#5976, cval_lineitem_l_quantity#5944 AS cval_lineitem_l_quantity_2#5977, cval_lineitem_l_extendedprice#5945 AS cval_lineitem_l_extendedprice_2#5978, cval_lineitem_l_discount#5946 AS cval_lineitem_l_discount_2#5979, cval_lineitem_l_tax#5947 AS cval_lineitem_l_tax_2#5980, cval_lineitem_l_returnflag#5948 AS cval_lineitem_l_returnflag_2#5981, cval_lineitem_l_linestatus#5949 AS cval_lineitem_l_linestatus_2#5982, cval_lineitem_l_commitdate#5950 AS cval_lineitem_l_commitdate_2#5983, cval_lineitem_l_receiptdate#5951 AS cval_lineitem_l_receiptdate_2#5984, cval_lineitem_l_shipinstruct#5952 AS cval_lineitem_l_shipinstruct_2#5985, cval_lineitem_l_shipmode#5953 AS cval_lineitem_l_shipmode_2#5986, cval_lineitem_l_comment#5954 AS cval_lineitem_l_comment_2#5987, cval_lineitem_l_shipdate#5955 AS cval_lineitem_l_shipdate_2#5988, cl_quantity#5956 AS cl_quantity_2#5989, cl_extendedprice#5957 AS cl_extendedprice_2#5990, cl_discount#5958 AS cl_discount_2#5991, ... 9 more fields]
                  :     :     +- Relation[rid#5935,cpfk_orders_lineitem#5936,cpfk_supplier_lineitem#5937,cfpk_lineitem_supplier#5938,cfpk_lineitem_partsupp#5939,cpfk_part_lineitem#5940,cfpk_lineitem_part#5941,cpfk_partsupp_lineitem#5942,cfpk_lineitem_orders#5943,cval_lineitem_l_quantity#5944,cval_lineitem_l_extendedprice#5945,cval_lineitem_l_discount#5946,cval_lineitem_l_tax#5947,cval_lineitem_l_returnflag#5948,cval_lineitem_l_linestatus#5949,cval_lineitem_l_commitdate#5950,cval_lineitem_l_receiptdate#5951,cval_lineitem_l_shipinstruct#5952,cval_lineitem_l_shipmode#5953,cval_lineitem_l_comment#5954,cval_lineitem_l_shipdate#5955,cl_quantity#5956,cl_extendedprice#5957,cl_discount#5958,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#6101 AS rid_3#6114, cpfk_nation_supplier#6102 AS cpfk_nation_supplier_3#6115, cfpk_supplier_nation#6103 AS cfpk_supplier_nation_3#6116, cval_supplier_s_name#6104 AS cval_supplier_s_name_3#6117, cval_supplier_s_address#6105 AS cval_supplier_s_address_3#6118, cval_supplier_s_phone#6106 AS cval_supplier_s_phone_3#6119, cval_supplier_s_acctbal#6107 AS cval_supplier_s_acctbal_3#6120, cval_supplier_s_comment#6108 AS cval_supplier_s_comment_3#6121, cs_name#6109 AS cs_name_3#6122, cs_address#6110 AS cs_address_3#6123, cs_phone#6111 AS cs_phone_3#6124, cs_acctbal#6112 AS cs_acctbal_3#6125, cs_comment#6113 AS cs_comment_3#6126]
                  :        +- Relation[rid#6101,cpfk_nation_supplier#6102,cfpk_supplier_nation#6103,cval_supplier_s_name#6104,cval_supplier_s_address#6105,cval_supplier_s_phone#6106,cval_supplier_s_acctbal#6107,cval_supplier_s_comment#6108,cs_name#6109,cs_address#6110,cs_phone#6111,cs_acctbal#6112,cs_comment#6113] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#6127 AS rid_4#6134, cpfk_region_nation#6128 AS cpfk_region_nation_4#6135, cfpk_nation_region#6129 AS cfpk_nation_region_4#6136, cval_nation_n_name#6130 AS cval_nation_n_name_4#6137, cval_nation_n_comment#6131 AS cval_nation_n_comment_4#6138, cn_name#6132 AS cn_name_4#6139, cn_comment#6133 AS cn_comment_4#6140]
                     :  +- Relation[rid#6127,cpfk_region_nation#6128,cfpk_nation_region#6129,cval_nation_n_name#6130,cval_nation_n_comment#6131,cn_name#6132,cn_comment#6133] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#6141 AS rid_4#6148, cpfk_region_nation#6142 AS cpfk_region_nation_4#6149, cfpk_nation_region#6143 AS cfpk_nation_region_4#6150, cval_nation_n_name#6144 AS cval_nation_n_name_4#6151, cval_nation_n_comment#6145 AS cval_nation_n_comment_4#6152, cn_name#6146 AS cn_name_4#6153, cn_comment#6147 AS cn_comment_4#6154]
                           +- Relation[rid#6141,cpfk_region_nation#6142,cfpk_nation_region#6143,cval_nation_n_name#6144,cval_nation_n_comment#6145,cn_name#6146,cn_comment#6147] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 247246ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/11 08:18:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:18:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6265L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 08:18:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:18:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:18:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:18:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6265L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#6267 AS rid_0#6284, cval_part_p_name#6268 AS cval_part_p_name_0#6285, cval_part_p_mfgr#6269 AS cval_part_p_mfgr_0#6286, cval_part_p_type#6270 AS cval_part_p_type_0#6287, cval_part_p_size#6271 AS cval_part_p_size_0#6288, cval_part_p_container#6272 AS cval_part_p_container_0#6289, cval_part_p_retailprice#6273 AS cval_part_p_retailprice_0#6290, cval_part_p_comment#6274 AS cval_part_p_comment_0#6291, cval_part_p_brand#6275 AS cval_part_p_brand_0#6292, cp_name#6276 AS cp_name_0#6293, cp_mfgr#6277 AS cp_mfgr_0#6294, cp_type#6278 AS cp_type_0#6295, cp_size#6279 AS cp_size_0#6296, cp_container#6280 AS cp_container_0#6297, cp_retailprice#6281 AS cp_retailprice_0#6298, cp_comment#6282 AS cp_comment_0#6299, cp_brand#6283 AS cp_brand_0#6300]
         :  :  :  +- Relation[rid#6267,cval_part_p_name#6268,cval_part_p_mfgr#6269,cval_part_p_type#6270,cval_part_p_size#6271,cval_part_p_container#6272,cval_part_p_retailprice#6273,cval_part_p_comment#6274,cval_part_p_brand#6275,cp_name#6276,cp_mfgr#6277,cp_type#6278,cp_size#6279,cp_container#6280,cp_retailprice#6281,cp_comment#6282,cp_brand#6283] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#6301 AS rid_0#6318, cval_part_p_name#6302 AS cval_part_p_name_0#6319, cval_part_p_mfgr#6303 AS cval_part_p_mfgr_0#6320, cval_part_p_type#6304 AS cval_part_p_type_0#6321, cval_part_p_size#6305 AS cval_part_p_size_0#6322, cval_part_p_container#6306 AS cval_part_p_container_0#6323, cval_part_p_retailprice#6307 AS cval_part_p_retailprice_0#6324, cval_part_p_comment#6308 AS cval_part_p_comment_0#6325, cval_part_p_brand#6309 AS cval_part_p_brand_0#6326, cp_name#6310 AS cp_name_0#6327, cp_mfgr#6311 AS cp_mfgr_0#6328, cp_type#6312 AS cp_type_0#6329, cp_size#6313 AS cp_size_0#6330, cp_container#6314 AS cp_container_0#6331, cp_retailprice#6315 AS cp_retailprice_0#6332, cp_comment#6316 AS cp_comment_0#6333, cp_brand#6317 AS cp_brand_0#6334]
         :  :        +- Relation[rid#6301,cval_part_p_name#6302,cval_part_p_mfgr#6303,cval_part_p_type#6304,cval_part_p_size#6305,cval_part_p_container#6306,cval_part_p_retailprice#6307,cval_part_p_comment#6308,cval_part_p_brand#6309,cp_name#6310,cp_mfgr#6311,cp_type#6312,cp_size#6313,cp_container#6314,cp_retailprice#6315,cp_comment#6316,cp_brand#6317] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :     :- Project [rid#6357 AS rid_0#6374, cval_part_p_name#6358 AS cval_part_p_name_0#6375, cval_part_p_mfgr#6359 AS cval_part_p_mfgr_0#6376, cval_part_p_type#6360 AS cval_part_p_type_0#6377, cval_part_p_size#6361 AS cval_part_p_size_0#6378, cval_part_p_container#6362 AS cval_part_p_container_0#6379, cval_part_p_retailprice#6363 AS cval_part_p_retailprice_0#6380, cval_part_p_comment#6364 AS cval_part_p_comment_0#6381, cval_part_p_brand#6365 AS cval_part_p_brand_0#6382, cp_name#6366 AS cp_name_0#6383, cp_mfgr#6367 AS cp_mfgr_0#6384, cp_type#6368 AS cp_type_0#6385, cp_size#6369 AS cp_size_0#6386, cp_container#6370 AS cp_container_0#6387, cp_retailprice#6371 AS cp_retailprice_0#6388, cp_comment#6372 AS cp_comment_0#6389, cp_brand#6373 AS cp_brand_0#6390]
         :     :  +- Relation[rid#6357,cval_part_p_name#6358,cval_part_p_mfgr#6359,cval_part_p_type#6360,cval_part_p_size#6361,cval_part_p_container#6362,cval_part_p_retailprice#6363,cval_part_p_comment#6364,cval_part_p_brand#6365,cp_name#6366,cp_mfgr#6367,cp_type#6368,cp_size#6369,cp_container#6370,cp_retailprice#6371,cp_comment#6372,cp_brand#6373] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#6391 AS rid_1#6402, cpfk_part_partsupp#6392 AS cpfk_part_partsupp_1#6403, cfpk_partsupp_part#6393 AS cfpk_partsupp_part_1#6404, cpfk_supplier_partsupp#6394 AS cpfk_supplier_partsupp_1#6405, cfpk_partsupp_supplier#6395 AS cfpk_partsupp_supplier_1#6406, cval_partsupp_ps_availqty#6396 AS cval_partsupp_ps_availqty_1#6407, cval_partsupp_ps_supplycost#6397 AS cval_partsupp_ps_supplycost_1#6408, cval_partsupp_ps_comment#6398 AS cval_partsupp_ps_comment_1#6409, cps_availqty#6399 AS cps_availqty_1#6410, cps_supplycost#6400 AS cps_supplycost_1#6411, cps_comment#6401 AS cps_comment_1#6412]
         :        +- Relation[rid#6391,cpfk_part_partsupp#6392,cfpk_partsupp_part#6393,cpfk_supplier_partsupp#6394,cfpk_partsupp_supplier#6395,cval_partsupp_ps_availqty#6396,cval_partsupp_ps_supplycost#6397,cval_partsupp_ps_comment#6398,cps_availqty#6399,cps_supplycost#6400,cps_comment#6401] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#6335 AS rid_1#6346, cpfk_part_partsupp#6336 AS cpfk_part_partsupp_1#6347, cfpk_partsupp_part#6337 AS cfpk_partsupp_part_1#6348, cpfk_supplier_partsupp#6338 AS cpfk_supplier_partsupp_1#6349, cfpk_partsupp_supplier#6339 AS cfpk_partsupp_supplier_1#6350, cval_partsupp_ps_availqty#6340 AS cval_partsupp_ps_availqty_1#6351, cval_partsupp_ps_supplycost#6341 AS cval_partsupp_ps_supplycost_1#6352, cval_partsupp_ps_comment#6342 AS cval_partsupp_ps_comment_1#6353, cps_availqty#6343 AS cps_availqty_1#6354, cps_supplycost#6344 AS cps_supplycost_1#6355, cps_comment#6345 AS cps_comment_1#6356]
            +- Relation[rid#6335,cpfk_part_partsupp#6336,cfpk_partsupp_part#6337,cpfk_supplier_partsupp#6338,cfpk_partsupp_supplier#6339,cval_partsupp_ps_availqty#6340,cval_partsupp_ps_supplycost#6341,cval_partsupp_ps_comment#6342,cps_availqty#6343,cps_supplycost#6344,cps_comment#6345] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 11106ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/11 08:18:29 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:18:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6447L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 08:18:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6447L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#6449 AS rid_0#6466, cval_part_p_name#6450 AS cval_part_p_name_0#6467, cval_part_p_mfgr#6451 AS cval_part_p_mfgr_0#6468, cval_part_p_type#6452 AS cval_part_p_type_0#6469, cval_part_p_size#6453 AS cval_part_p_size_0#6470, cval_part_p_container#6454 AS cval_part_p_container_0#6471, cval_part_p_retailprice#6455 AS cval_part_p_retailprice_0#6472, cval_part_p_comment#6456 AS cval_part_p_comment_0#6473, cval_part_p_brand#6457 AS cval_part_p_brand_0#6474, cp_name#6458 AS cp_name_0#6475, cp_mfgr#6459 AS cp_mfgr_0#6476, cp_type#6460 AS cp_type_0#6477, cp_size#6461 AS cp_size_0#6478, cp_container#6462 AS cp_container_0#6479, cp_retailprice#6463 AS cp_retailprice_0#6480, cp_comment#6464 AS cp_comment_0#6481, cp_brand#6465 AS cp_brand_0#6482]
         :  :  +- Relation[rid#6449,cval_part_p_name#6450,cval_part_p_mfgr#6451,cval_part_p_type#6452,cval_part_p_size#6453,cval_part_p_container#6454,cval_part_p_retailprice#6455,cval_part_p_comment#6456,cval_part_p_brand#6457,cp_name#6458,cp_mfgr#6459,cp_type#6460,cp_size#6461,cp_container#6462,cp_retailprice#6463,cp_comment#6464,cp_brand#6465] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#6549 AS rid_0#6566, cval_part_p_name#6550 AS cval_part_p_name_0#6567, cval_part_p_mfgr#6551 AS cval_part_p_mfgr_0#6568, cval_part_p_type#6552 AS cval_part_p_type_0#6569, cval_part_p_size#6553 AS cval_part_p_size_0#6570, cval_part_p_container#6554 AS cval_part_p_container_0#6571, cval_part_p_retailprice#6555 AS cval_part_p_retailprice_0#6572, cval_part_p_comment#6556 AS cval_part_p_comment_0#6573, cval_part_p_brand#6557 AS cval_part_p_brand_0#6574, cp_name#6558 AS cp_name_0#6575, cp_mfgr#6559 AS cp_mfgr_0#6576, cp_type#6560 AS cp_type_0#6577, cp_size#6561 AS cp_size_0#6578, cp_container#6562 AS cp_container_0#6579, cp_retailprice#6563 AS cp_retailprice_0#6580, cp_comment#6564 AS cp_comment_0#6581, cp_brand#6565 AS cp_brand_0#6582]
         :     :  +- Relation[rid#6549,cval_part_p_name#6550,cval_part_p_mfgr#6551,cval_part_p_type#6552,cval_part_p_size#6553,cval_part_p_container#6554,cval_part_p_retailprice#6555,cval_part_p_comment#6556,cval_part_p_brand#6557,cp_name#6558,cp_mfgr#6559,cp_type#6560,cp_size#6561,cp_container#6562,cp_retailprice#6563,cp_comment#6564,cp_brand#6565] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#6583 AS rid_1#6616, cpfk_orders_lineitem#6584 AS cpfk_orders_lineitem_1#6617, cpfk_supplier_lineitem#6585 AS cpfk_supplier_lineitem_1#6618, cfpk_lineitem_supplier#6586 AS cfpk_lineitem_supplier_1#6619, cfpk_lineitem_partsupp#6587 AS cfpk_lineitem_partsupp_1#6620, cpfk_part_lineitem#6588 AS cpfk_part_lineitem_1#6621, cfpk_lineitem_part#6589 AS cfpk_lineitem_part_1#6622, cpfk_partsupp_lineitem#6590 AS cpfk_partsupp_lineitem_1#6623, cfpk_lineitem_orders#6591 AS cfpk_lineitem_orders_1#6624, cval_lineitem_l_quantity#6592 AS cval_lineitem_l_quantity_1#6625, cval_lineitem_l_extendedprice#6593 AS cval_lineitem_l_extendedprice_1#6626, cval_lineitem_l_discount#6594 AS cval_lineitem_l_discount_1#6627, cval_lineitem_l_tax#6595 AS cval_lineitem_l_tax_1#6628, cval_lineitem_l_returnflag#6596 AS cval_lineitem_l_returnflag_1#6629, cval_lineitem_l_linestatus#6597 AS cval_lineitem_l_linestatus_1#6630, cval_lineitem_l_commitdate#6598 AS cval_lineitem_l_commitdate_1#6631, cval_lineitem_l_receiptdate#6599 AS cval_lineitem_l_receiptdate_1#6632, cval_lineitem_l_shipinstruct#6600 AS cval_lineitem_l_shipinstruct_1#6633, cval_lineitem_l_shipmode#6601 AS cval_lineitem_l_shipmode_1#6634, cval_lineitem_l_comment#6602 AS cval_lineitem_l_comment_1#6635, cval_lineitem_l_shipdate#6603 AS cval_lineitem_l_shipdate_1#6636, cl_quantity#6604 AS cl_quantity_1#6637, cl_extendedprice#6605 AS cl_extendedprice_1#6638, cl_discount#6606 AS cl_discount_1#6639, ... 9 more fields]
         :        +- Relation[rid#6583,cpfk_orders_lineitem#6584,cpfk_supplier_lineitem#6585,cfpk_lineitem_supplier#6586,cfpk_lineitem_partsupp#6587,cpfk_part_lineitem#6588,cfpk_lineitem_part#6589,cpfk_partsupp_lineitem#6590,cfpk_lineitem_orders#6591,cval_lineitem_l_quantity#6592,cval_lineitem_l_extendedprice#6593,cval_lineitem_l_discount#6594,cval_lineitem_l_tax#6595,cval_lineitem_l_returnflag#6596,cval_lineitem_l_linestatus#6597,cval_lineitem_l_commitdate#6598,cval_lineitem_l_receiptdate#6599,cval_lineitem_l_shipinstruct#6600,cval_lineitem_l_shipmode#6601,cval_lineitem_l_comment#6602,cval_lineitem_l_shipdate#6603,cl_quantity#6604,cl_extendedprice#6605,cl_discount#6606,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6483 AS rid_1#6516, cpfk_orders_lineitem#6484 AS cpfk_orders_lineitem_1#6517, cpfk_supplier_lineitem#6485 AS cpfk_supplier_lineitem_1#6518, cfpk_lineitem_supplier#6486 AS cfpk_lineitem_supplier_1#6519, cfpk_lineitem_partsupp#6487 AS cfpk_lineitem_partsupp_1#6520, cpfk_part_lineitem#6488 AS cpfk_part_lineitem_1#6521, cfpk_lineitem_part#6489 AS cfpk_lineitem_part_1#6522, cpfk_partsupp_lineitem#6490 AS cpfk_partsupp_lineitem_1#6523, cfpk_lineitem_orders#6491 AS cfpk_lineitem_orders_1#6524, cval_lineitem_l_quantity#6492 AS cval_lineitem_l_quantity_1#6525, cval_lineitem_l_extendedprice#6493 AS cval_lineitem_l_extendedprice_1#6526, cval_lineitem_l_discount#6494 AS cval_lineitem_l_discount_1#6527, cval_lineitem_l_tax#6495 AS cval_lineitem_l_tax_1#6528, cval_lineitem_l_returnflag#6496 AS cval_lineitem_l_returnflag_1#6529, cval_lineitem_l_linestatus#6497 AS cval_lineitem_l_linestatus_1#6530, cval_lineitem_l_commitdate#6498 AS cval_lineitem_l_commitdate_1#6531, cval_lineitem_l_receiptdate#6499 AS cval_lineitem_l_receiptdate_1#6532, cval_lineitem_l_shipinstruct#6500 AS cval_lineitem_l_shipinstruct_1#6533, cval_lineitem_l_shipmode#6501 AS cval_lineitem_l_shipmode_1#6534, cval_lineitem_l_comment#6502 AS cval_lineitem_l_comment_1#6535, cval_lineitem_l_shipdate#6503 AS cval_lineitem_l_shipdate_1#6536, cl_quantity#6504 AS cl_quantity_1#6537, cl_extendedprice#6505 AS cl_extendedprice_1#6538, cl_discount#6506 AS cl_discount_1#6539, ... 9 more fields]
            +- Relation[rid#6483,cpfk_orders_lineitem#6484,cpfk_supplier_lineitem#6485,cfpk_lineitem_supplier#6486,cfpk_lineitem_partsupp#6487,cpfk_part_lineitem#6488,cfpk_lineitem_part#6489,cpfk_partsupp_lineitem#6490,cfpk_lineitem_orders#6491,cval_lineitem_l_quantity#6492,cval_lineitem_l_extendedprice#6493,cval_lineitem_l_discount#6494,cval_lineitem_l_tax#6495,cval_lineitem_l_returnflag#6496,cval_lineitem_l_linestatus#6497,cval_lineitem_l_commitdate#6498,cval_lineitem_l_receiptdate#6499,cval_lineitem_l_shipinstruct#6500,cval_lineitem_l_shipmode#6501,cval_lineitem_l_comment#6502,cval_lineitem_l_shipdate#6503,cl_quantity#6504,cl_extendedprice#6505,cl_discount#6506,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 82464ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/11 08:19:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:19:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6706L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 08:19:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:19:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:19:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:19:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:19:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:19:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 08:19:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 08:19:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 08:19:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:19:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 08:19:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:19:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 08:19:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:19:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:19:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:19:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6706L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#6708 AS rid_0#6725, cval_part_p_name#6709 AS cval_part_p_name_0#6726, cval_part_p_mfgr#6710 AS cval_part_p_mfgr_0#6727, cval_part_p_type#6711 AS cval_part_p_type_0#6728, cval_part_p_size#6712 AS cval_part_p_size_0#6729, cval_part_p_container#6713 AS cval_part_p_container_0#6730, cval_part_p_retailprice#6714 AS cval_part_p_retailprice_0#6731, cval_part_p_comment#6715 AS cval_part_p_comment_0#6732, cval_part_p_brand#6716 AS cval_part_p_brand_0#6733, cp_name#6717 AS cp_name_0#6734, cp_mfgr#6718 AS cp_mfgr_0#6735, cp_type#6719 AS cp_type_0#6736, cp_size#6720 AS cp_size_0#6737, cp_container#6721 AS cp_container_0#6738, cp_retailprice#6722 AS cp_retailprice_0#6739, cp_comment#6723 AS cp_comment_0#6740, cp_brand#6724 AS cp_brand_0#6741]
            :     :     :  :  :  :  +- Relation[rid#6708,cval_part_p_name#6709,cval_part_p_mfgr#6710,cval_part_p_type#6711,cval_part_p_size#6712,cval_part_p_container#6713,cval_part_p_retailprice#6714,cval_part_p_comment#6715,cval_part_p_brand#6716,cp_name#6717,cp_mfgr#6718,cp_type#6719,cp_size#6720,cp_container#6721,cp_retailprice#6722,cp_comment#6723,cp_brand#6724] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#6742 AS rid_0#6759, cval_part_p_name#6743 AS cval_part_p_name_0#6760, cval_part_p_mfgr#6744 AS cval_part_p_mfgr_0#6761, cval_part_p_type#6745 AS cval_part_p_type_0#6762, cval_part_p_size#6746 AS cval_part_p_size_0#6763, cval_part_p_container#6747 AS cval_part_p_container_0#6764, cval_part_p_retailprice#6748 AS cval_part_p_retailprice_0#6765, cval_part_p_comment#6749 AS cval_part_p_comment_0#6766, cval_part_p_brand#6750 AS cval_part_p_brand_0#6767, cp_name#6751 AS cp_name_0#6768, cp_mfgr#6752 AS cp_mfgr_0#6769, cp_type#6753 AS cp_type_0#6770, cp_size#6754 AS cp_size_0#6771, cp_container#6755 AS cp_container_0#6772, cp_retailprice#6756 AS cp_retailprice_0#6773, cp_comment#6757 AS cp_comment_0#6774, cp_brand#6758 AS cp_brand_0#6775]
            :     :     :  :  :        +- Relation[rid#6742,cval_part_p_name#6743,cval_part_p_mfgr#6744,cval_part_p_type#6745,cval_part_p_size#6746,cval_part_p_container#6747,cval_part_p_retailprice#6748,cval_part_p_comment#6749,cval_part_p_brand#6750,cp_name#6751,cp_mfgr#6752,cp_type#6753,cp_size#6754,cp_container#6755,cp_retailprice#6756,cp_comment#6757,cp_brand#6758] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :     :- Project [rid#6842 AS rid_0#6859, cval_part_p_name#6843 AS cval_part_p_name_0#6860, cval_part_p_mfgr#6844 AS cval_part_p_mfgr_0#6861, cval_part_p_type#6845 AS cval_part_p_type_0#6862, cval_part_p_size#6846 AS cval_part_p_size_0#6863, cval_part_p_container#6847 AS cval_part_p_container_0#6864, cval_part_p_retailprice#6848 AS cval_part_p_retailprice_0#6865, cval_part_p_comment#6849 AS cval_part_p_comment_0#6866, cval_part_p_brand#6850 AS cval_part_p_brand_0#6867, cp_name#6851 AS cp_name_0#6868, cp_mfgr#6852 AS cp_mfgr_0#6869, cp_type#6853 AS cp_type_0#6870, cp_size#6854 AS cp_size_0#6871, cp_container#6855 AS cp_container_0#6872, cp_retailprice#6856 AS cp_retailprice_0#6873, cp_comment#6857 AS cp_comment_0#6874, cp_brand#6858 AS cp_brand_0#6875]
            :     :     :  :     :  +- Relation[rid#6842,cval_part_p_name#6843,cval_part_p_mfgr#6844,cval_part_p_type#6845,cval_part_p_size#6846,cval_part_p_container#6847,cval_part_p_retailprice#6848,cval_part_p_comment#6849,cval_part_p_brand#6850,cp_name#6851,cp_mfgr#6852,cp_type#6853,cp_size#6854,cp_container#6855,cp_retailprice#6856,cp_comment#6857,cp_brand#6858] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :     +- Project [rid#6876 AS rid_1#6909, cpfk_orders_lineitem#6877 AS cpfk_orders_lineitem_1#6910, cpfk_supplier_lineitem#6878 AS cpfk_supplier_lineitem_1#6911, cfpk_lineitem_supplier#6879 AS cfpk_lineitem_supplier_1#6912, cfpk_lineitem_partsupp#6880 AS cfpk_lineitem_partsupp_1#6913, cpfk_part_lineitem#6881 AS cpfk_part_lineitem_1#6914, cfpk_lineitem_part#6882 AS cfpk_lineitem_part_1#6915, cpfk_partsupp_lineitem#6883 AS cpfk_partsupp_lineitem_1#6916, cfpk_lineitem_orders#6884 AS cfpk_lineitem_orders_1#6917, cval_lineitem_l_quantity#6885 AS cval_lineitem_l_quantity_1#6918, cval_lineitem_l_extendedprice#6886 AS cval_lineitem_l_extendedprice_1#6919, cval_lineitem_l_discount#6887 AS cval_lineitem_l_discount_1#6920, cval_lineitem_l_tax#6888 AS cval_lineitem_l_tax_1#6921, cval_lineitem_l_returnflag#6889 AS cval_lineitem_l_returnflag_1#6922, cval_lineitem_l_linestatus#6890 AS cval_lineitem_l_linestatus_1#6923, cval_lineitem_l_commitdate#6891 AS cval_lineitem_l_commitdate_1#6924, cval_lineitem_l_receiptdate#6892 AS cval_lineitem_l_receiptdate_1#6925, cval_lineitem_l_shipinstruct#6893 AS cval_lineitem_l_shipinstruct_1#6926, cval_lineitem_l_shipmode#6894 AS cval_lineitem_l_shipmode_1#6927, cval_lineitem_l_comment#6895 AS cval_lineitem_l_comment_1#6928, cval_lineitem_l_shipdate#6896 AS cval_lineitem_l_shipdate_1#6929, cl_quantity#6897 AS cl_quantity_1#6930, cl_extendedprice#6898 AS cl_extendedprice_1#6931, cl_discount#6899 AS cl_discount_1#6932, ... 9 more fields]
            :     :     :  :        +- Relation[rid#6876,cpfk_orders_lineitem#6877,cpfk_supplier_lineitem#6878,cfpk_lineitem_supplier#6879,cfpk_lineitem_partsupp#6880,cpfk_part_lineitem#6881,cfpk_lineitem_part#6882,cpfk_partsupp_lineitem#6883,cfpk_lineitem_orders#6884,cval_lineitem_l_quantity#6885,cval_lineitem_l_extendedprice#6886,cval_lineitem_l_discount#6887,cval_lineitem_l_tax#6888,cval_lineitem_l_returnflag#6889,cval_lineitem_l_linestatus#6890,cval_lineitem_l_commitdate#6891,cval_lineitem_l_receiptdate#6892,cval_lineitem_l_shipinstruct#6893,cval_lineitem_l_shipmode#6894,cval_lineitem_l_comment#6895,cval_lineitem_l_shipdate#6896,cl_quantity#6897,cl_extendedprice#6898,cl_discount#6899,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#6776 AS rid_1#6809, cpfk_orders_lineitem#6777 AS cpfk_orders_lineitem_1#6810, cpfk_supplier_lineitem#6778 AS cpfk_supplier_lineitem_1#6811, cfpk_lineitem_supplier#6779 AS cfpk_lineitem_supplier_1#6812, cfpk_lineitem_partsupp#6780 AS cfpk_lineitem_partsupp_1#6813, cpfk_part_lineitem#6781 AS cpfk_part_lineitem_1#6814, cfpk_lineitem_part#6782 AS cfpk_lineitem_part_1#6815, cpfk_partsupp_lineitem#6783 AS cpfk_partsupp_lineitem_1#6816, cfpk_lineitem_orders#6784 AS cfpk_lineitem_orders_1#6817, cval_lineitem_l_quantity#6785 AS cval_lineitem_l_quantity_1#6818, cval_lineitem_l_extendedprice#6786 AS cval_lineitem_l_extendedprice_1#6819, cval_lineitem_l_discount#6787 AS cval_lineitem_l_discount_1#6820, cval_lineitem_l_tax#6788 AS cval_lineitem_l_tax_1#6821, cval_lineitem_l_returnflag#6789 AS cval_lineitem_l_returnflag_1#6822, cval_lineitem_l_linestatus#6790 AS cval_lineitem_l_linestatus_1#6823, cval_lineitem_l_commitdate#6791 AS cval_lineitem_l_commitdate_1#6824, cval_lineitem_l_receiptdate#6792 AS cval_lineitem_l_receiptdate_1#6825, cval_lineitem_l_shipinstruct#6793 AS cval_lineitem_l_shipinstruct_1#6826, cval_lineitem_l_shipmode#6794 AS cval_lineitem_l_shipmode_1#6827, cval_lineitem_l_comment#6795 AS cval_lineitem_l_comment_1#6828, cval_lineitem_l_shipdate#6796 AS cval_lineitem_l_shipdate_1#6829, cl_quantity#6797 AS cl_quantity_1#6830, cl_extendedprice#6798 AS cl_extendedprice_1#6831, cl_discount#6799 AS cl_discount_1#6832, ... 9 more fields]
            :     :     :     +- Relation[rid#6776,cpfk_orders_lineitem#6777,cpfk_supplier_lineitem#6778,cfpk_lineitem_supplier#6779,cfpk_lineitem_partsupp#6780,cpfk_part_lineitem#6781,cfpk_lineitem_part#6782,cpfk_partsupp_lineitem#6783,cfpk_lineitem_orders#6784,cval_lineitem_l_quantity#6785,cval_lineitem_l_extendedprice#6786,cval_lineitem_l_discount#6787,cval_lineitem_l_tax#6788,cval_lineitem_l_returnflag#6789,cval_lineitem_l_linestatus#6790,cval_lineitem_l_commitdate#6791,cval_lineitem_l_receiptdate#6792,cval_lineitem_l_shipinstruct#6793,cval_lineitem_l_shipmode#6794,cval_lineitem_l_comment#6795,cval_lineitem_l_shipdate#6796,cl_quantity#6797,cl_extendedprice#6798,cl_discount#6799,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#6942 AS rid_2#6955, cpfk_nation_supplier#6943 AS cpfk_nation_supplier_2#6956, cfpk_supplier_nation#6944 AS cfpk_supplier_nation_2#6957, cval_supplier_s_name#6945 AS cval_supplier_s_name_2#6958, cval_supplier_s_address#6946 AS cval_supplier_s_address_2#6959, cval_supplier_s_phone#6947 AS cval_supplier_s_phone_2#6960, cval_supplier_s_acctbal#6948 AS cval_supplier_s_acctbal_2#6961, cval_supplier_s_comment#6949 AS cval_supplier_s_comment_2#6962, cs_name#6950 AS cs_name_2#6963, cs_address#6951 AS cs_address_2#6964, cs_phone#6952 AS cs_phone_2#6965, cs_acctbal#6953 AS cs_acctbal_2#6966, cs_comment#6954 AS cs_comment_2#6967]
            :     :        +- Relation[rid#6942,cpfk_nation_supplier#6943,cfpk_supplier_nation#6944,cval_supplier_s_name#6945,cval_supplier_s_address#6946,cval_supplier_s_phone#6947,cval_supplier_s_acctbal#6948,cval_supplier_s_comment#6949,cs_name#6950,cs_address#6951,cs_phone#6952,cs_acctbal#6953,cs_comment#6954] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#6968 AS rid_3#6975, cpfk_region_nation#6969 AS cpfk_region_nation_3#6976, cfpk_nation_region#6970 AS cfpk_nation_region_3#6977, cval_nation_n_name#6971 AS cval_nation_n_name_3#6978, cval_nation_n_comment#6972 AS cval_nation_n_comment_3#6979, cn_name#6973 AS cn_name_3#6980, cn_comment#6974 AS cn_comment_3#6981]
            :        +- Relation[rid#6968,cpfk_region_nation#6969,cfpk_nation_region#6970,cval_nation_n_name#6971,cval_nation_n_comment#6972,cn_name#6973,cn_comment#6974] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'Join UsingJoin(Inner,List(rid_6))
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#6982 AS rid_4#6987, cval_region_r_name#6983 AS cval_region_r_name_4#6988, cval_region_r_comment#6984 AS cval_region_r_comment_4#6989, cr_name#6985 AS cr_name_4#6990, cr_comment#6986 AS cr_comment_4#6991]
               :  :  :  :  :  :  :  +- Relation[rid#6982,cval_region_r_name#6983,cval_region_r_comment#6984,cr_name#6985,cr_comment#6986] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#6992 AS rid_4#6997, cval_region_r_name#6993 AS cval_region_r_name_4#6998, cval_region_r_comment#6994 AS cval_region_r_comment_4#6999, cr_name#6995 AS cr_name_4#7000, cr_comment#6996 AS cr_comment_4#7001]
               :  :  :  :  :  :        +- Relation[rid#6992,cval_region_r_name#6993,cval_region_r_comment#6994,cr_name#6995,cr_comment#6996] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :     :- Project [rid#7016 AS rid_4#7021, cval_region_r_name#7017 AS cval_region_r_name_4#7022, cval_region_r_comment#7018 AS cval_region_r_comment_4#7023, cr_name#7019 AS cr_name_4#7024, cr_comment#7020 AS cr_comment_4#7025]
               :  :  :  :  :     :  +- Relation[rid#7016,cval_region_r_name#7017,cval_region_r_comment#7018,cr_name#7019,cr_comment#7020] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :     +- Project [rid#7026 AS rid_5#7033, cpfk_region_nation#7027 AS cpfk_region_nation_5#7034, cfpk_nation_region#7028 AS cfpk_nation_region_5#7035, cval_nation_n_name#7029 AS cval_nation_n_name_5#7036, cval_nation_n_comment#7030 AS cval_nation_n_comment_5#7037, cn_name#7031 AS cn_name_5#7038, cn_comment#7032 AS cn_comment_5#7039]
               :  :  :  :  :        +- Relation[rid#7026,cpfk_region_nation#7027,cfpk_nation_region#7028,cval_nation_n_name#7029,cval_nation_n_comment#7030,cn_name#7031,cn_comment#7032] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#7002 AS rid_5#7009, cpfk_region_nation#7003 AS cpfk_region_nation_5#7010, cfpk_nation_region#7004 AS cfpk_nation_region_5#7011, cval_nation_n_name#7005 AS cval_nation_n_name_5#7012, cval_nation_n_comment#7006 AS cval_nation_n_comment_5#7013, cn_name#7007 AS cn_name_5#7014, cn_comment#7008 AS cn_comment_5#7015]
               :  :  :  :     +- Relation[rid#7002,cpfk_region_nation#7003,cfpk_nation_region#7004,cval_nation_n_name#7005,cval_nation_n_comment#7006,cn_name#7007,cn_comment#7008] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :     :- Project [rid#7070 AS rid_5#7077, cpfk_region_nation#7071 AS cpfk_region_nation_5#7078, cfpk_nation_region#7072 AS cfpk_nation_region_5#7079, cval_nation_n_name#7073 AS cval_nation_n_name_5#7080, cval_nation_n_comment#7074 AS cval_nation_n_comment_5#7081, cn_name#7075 AS cn_name_5#7082, cn_comment#7076 AS cn_comment_5#7083]
               :  :  :     :  +- Relation[rid#7070,cpfk_region_nation#7071,cfpk_nation_region#7072,cval_nation_n_name#7073,cval_nation_n_comment#7074,cn_name#7075,cn_comment#7076] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#7084 AS rid_6#7099, cpfk_nation_customer#7085 AS cpfk_nation_customer_6#7100, cfpk_customer_nation#7086 AS cfpk_customer_nation_6#7101, cval_customer_c_name#7087 AS cval_customer_c_name_6#7102, cval_customer_c_address#7088 AS cval_customer_c_address_6#7103, cval_customer_c_phone#7089 AS cval_customer_c_phone_6#7104, cval_customer_c_acctbal#7090 AS cval_customer_c_acctbal_6#7105, cval_customer_c_comment#7091 AS cval_customer_c_comment_6#7106, cval_customer_c_mktsegment#7092 AS cval_customer_c_mktsegment_6#7107, cc_name#7093 AS cc_name_6#7108, cc_address#7094 AS cc_address_6#7109, cc_phone#7095 AS cc_phone_6#7110, cc_acctbal#7096 AS cc_acctbal_6#7111, cc_comment#7097 AS cc_comment_6#7112, cc_mktsegment#7098 AS cc_mktsegment_6#7113]
               :  :  :        +- Relation[rid#7084,cpfk_nation_customer#7085,cfpk_customer_nation#7086,cval_customer_c_name#7087,cval_customer_c_address#7088,cval_customer_c_phone#7089,cval_customer_c_acctbal#7090,cval_customer_c_comment#7091,cval_customer_c_mktsegment#7092,cc_name#7093,cc_address#7094,cc_phone#7095,cc_acctbal#7096,cc_comment#7097,cc_mktsegment#7098] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#7040 AS rid_6#7055, cpfk_nation_customer#7041 AS cpfk_nation_customer_6#7056, cfpk_customer_nation#7042 AS cfpk_customer_nation_6#7057, cval_customer_c_name#7043 AS cval_customer_c_name_6#7058, cval_customer_c_address#7044 AS cval_customer_c_address_6#7059, cval_customer_c_phone#7045 AS cval_customer_c_phone_6#7060, cval_customer_c_acctbal#7046 AS cval_customer_c_acctbal_6#7061, cval_customer_c_comment#7047 AS cval_customer_c_comment_6#7062, cval_customer_c_mktsegment#7048 AS cval_customer_c_mktsegment_6#7063, cc_name#7049 AS cc_name_6#7064, cc_address#7050 AS cc_address_6#7065, cc_phone#7051 AS cc_phone_6#7066, cc_acctbal#7052 AS cc_acctbal_6#7067, cc_comment#7053 AS cc_comment_6#7068, cc_mktsegment#7054 AS cc_mktsegment_6#7069]
               :  :     +- Relation[rid#7040,cpfk_nation_customer#7041,cfpk_customer_nation#7042,cval_customer_c_name#7043,cval_customer_c_address#7044,cval_customer_c_phone#7045,cval_customer_c_acctbal#7046,cval_customer_c_comment#7047,cval_customer_c_mktsegment#7048,cc_name#7049,cc_address#7050,cc_phone#7051,cc_acctbal#7052,cc_comment#7053,cc_mktsegment#7054] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :     :- Project [rid#7148 AS rid_6#7163, cpfk_nation_customer#7149 AS cpfk_nation_customer_6#7164, cfpk_customer_nation#7150 AS cfpk_customer_nation_6#7165, cval_customer_c_name#7151 AS cval_customer_c_name_6#7166, cval_customer_c_address#7152 AS cval_customer_c_address_6#7167, cval_customer_c_phone#7153 AS cval_customer_c_phone_6#7168, cval_customer_c_acctbal#7154 AS cval_customer_c_acctbal_6#7169, cval_customer_c_comment#7155 AS cval_customer_c_comment_6#7170, cval_customer_c_mktsegment#7156 AS cval_customer_c_mktsegment_6#7171, cc_name#7157 AS cc_name_6#7172, cc_address#7158 AS cc_address_6#7173, cc_phone#7159 AS cc_phone_6#7174, cc_acctbal#7160 AS cc_acctbal_6#7175, cc_comment#7161 AS cc_comment_6#7176, cc_mktsegment#7162 AS cc_mktsegment_6#7177]
               :     :  +- Relation[rid#7148,cpfk_nation_customer#7149,cfpk_customer_nation#7150,cval_customer_c_name#7151,cval_customer_c_address#7152,cval_customer_c_phone#7153,cval_customer_c_acctbal#7154,cval_customer_c_comment#7155,cval_customer_c_mktsegment#7156,cc_name#7157,cc_address#7158,cc_phone#7159,cc_acctbal#7160,cc_comment#7161,cc_mktsegment#7162] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#7178 AS rid_7#7195, cpfk_customer_orders#7179 AS cpfk_customer_orders_7#7196, cfpk_orders_customer#7180 AS cfpk_orders_customer_7#7197, cval_orders_o_orderstatus#7181 AS cval_orders_o_orderstatus_7#7198, cval_orders_o_totalprice#7182 AS cval_orders_o_totalprice_7#7199, cval_orders_o_orderpriority#7183 AS cval_orders_o_orderpriority_7#7200, cval_orders_o_clerk#7184 AS cval_orders_o_clerk_7#7201, cval_orders_o_shippriority#7185 AS cval_orders_o_shippriority_7#7202, cval_orders_o_comment#7186 AS cval_orders_o_comment_7#7203, cval_orders_o_orderdate#7187 AS cval_orders_o_orderdate_7#7204, co_orderstatus#7188 AS co_orderstatus_7#7205, co_totalprice#7189 AS co_totalprice_7#7206, co_orderpriority#7190 AS co_orderpriority_7#7207, co_clerk#7191 AS co_clerk_7#7208, co_shippriority#7192 AS co_shippriority_7#7209, co_comment#7193 AS co_comment_7#7210, co_orderdate#7194 AS co_orderdate_7#7211]
               :        +- Relation[rid#7178,cpfk_customer_orders#7179,cfpk_orders_customer#7180,cval_orders_o_orderstatus#7181,cval_orders_o_totalprice#7182,cval_orders_o_orderpriority#7183,cval_orders_o_clerk#7184,cval_orders_o_shippriority#7185,cval_orders_o_comment#7186,cval_orders_o_orderdate#7187,co_orderstatus#7188,co_totalprice#7189,co_orderpriority#7190,co_clerk#7191,co_shippriority#7192,co_comment#7193,co_orderdate#7194] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#7114 AS rid_7#7131, cpfk_customer_orders#7115 AS cpfk_customer_orders_7#7132, cfpk_orders_customer#7116 AS cfpk_orders_customer_7#7133, cval_orders_o_orderstatus#7117 AS cval_orders_o_orderstatus_7#7134, cval_orders_o_totalprice#7118 AS cval_orders_o_totalprice_7#7135, cval_orders_o_orderpriority#7119 AS cval_orders_o_orderpriority_7#7136, cval_orders_o_clerk#7120 AS cval_orders_o_clerk_7#7137, cval_orders_o_shippriority#7121 AS cval_orders_o_shippriority_7#7138, cval_orders_o_comment#7122 AS cval_orders_o_comment_7#7139, cval_orders_o_orderdate#7123 AS cval_orders_o_orderdate_7#7140, co_orderstatus#7124 AS co_orderstatus_7#7141, co_totalprice#7125 AS co_totalprice_7#7142, co_orderpriority#7126 AS co_orderpriority_7#7143, co_clerk#7127 AS co_clerk_7#7144, co_shippriority#7128 AS co_shippriority_7#7145, co_comment#7129 AS co_comment_7#7146, co_orderdate#7130 AS co_orderdate_7#7147]
                  +- Relation[rid#7114,cpfk_customer_orders#7115,cfpk_orders_customer#7116,cval_orders_o_orderstatus#7117,cval_orders_o_totalprice#7118,cval_orders_o_orderpriority#7119,cval_orders_o_clerk#7120,cval_orders_o_shippriority#7121,cval_orders_o_comment#7122,cval_orders_o_orderdate#7123,co_orderstatus#7124,co_totalprice#7125,co_orderpriority#7126,co_clerk#7127,co_shippriority#7128,co_comment#7129,co_orderdate#7130] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 95602ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/11 08:21:27 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:21:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7330L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 08:21:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7330L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#7332 AS rid_0#7365, cpfk_orders_lineitem#7333 AS cpfk_orders_lineitem_0#7366, cpfk_supplier_lineitem#7334 AS cpfk_supplier_lineitem_0#7367, cfpk_lineitem_supplier#7335 AS cfpk_lineitem_supplier_0#7368, cfpk_lineitem_partsupp#7336 AS cfpk_lineitem_partsupp_0#7369, cpfk_part_lineitem#7337 AS cpfk_part_lineitem_0#7370, cfpk_lineitem_part#7338 AS cfpk_lineitem_part_0#7371, cpfk_partsupp_lineitem#7339 AS cpfk_partsupp_lineitem_0#7372, cfpk_lineitem_orders#7340 AS cfpk_lineitem_orders_0#7373, cval_lineitem_l_quantity#7341 AS cval_lineitem_l_quantity_0#7374, cval_lineitem_l_extendedprice#7342 AS cval_lineitem_l_extendedprice_0#7375, cval_lineitem_l_discount#7343 AS cval_lineitem_l_discount_0#7376, cval_lineitem_l_tax#7344 AS cval_lineitem_l_tax_0#7377, cval_lineitem_l_returnflag#7345 AS cval_lineitem_l_returnflag_0#7378, cval_lineitem_l_linestatus#7346 AS cval_lineitem_l_linestatus_0#7379, cval_lineitem_l_commitdate#7347 AS cval_lineitem_l_commitdate_0#7380, cval_lineitem_l_receiptdate#7348 AS cval_lineitem_l_receiptdate_0#7381, cval_lineitem_l_shipinstruct#7349 AS cval_lineitem_l_shipinstruct_0#7382, cval_lineitem_l_shipmode#7350 AS cval_lineitem_l_shipmode_0#7383, cval_lineitem_l_comment#7351 AS cval_lineitem_l_comment_0#7384, cval_lineitem_l_shipdate#7352 AS cval_lineitem_l_shipdate_0#7385, cl_quantity#7353 AS cl_quantity_0#7386, cl_extendedprice#7354 AS cl_extendedprice_0#7387, cl_discount#7355 AS cl_discount_0#7388, ... 9 more fields]
            :  :  +- Relation[rid#7332,cpfk_orders_lineitem#7333,cpfk_supplier_lineitem#7334,cfpk_lineitem_supplier#7335,cfpk_lineitem_partsupp#7336,cpfk_part_lineitem#7337,cfpk_lineitem_part#7338,cpfk_partsupp_lineitem#7339,cfpk_lineitem_orders#7340,cval_lineitem_l_quantity#7341,cval_lineitem_l_extendedprice#7342,cval_lineitem_l_discount#7343,cval_lineitem_l_tax#7344,cval_lineitem_l_returnflag#7345,cval_lineitem_l_linestatus#7346,cval_lineitem_l_commitdate#7347,cval_lineitem_l_receiptdate#7348,cval_lineitem_l_shipinstruct#7349,cval_lineitem_l_shipmode#7350,cval_lineitem_l_comment#7351,cval_lineitem_l_shipdate#7352,cl_quantity#7353,cl_extendedprice#7354,cl_discount#7355,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#7398 AS rid_0#7431, cpfk_orders_lineitem#7399 AS cpfk_orders_lineitem_0#7432, cpfk_supplier_lineitem#7400 AS cpfk_supplier_lineitem_0#7433, cfpk_lineitem_supplier#7401 AS cfpk_lineitem_supplier_0#7434, cfpk_lineitem_partsupp#7402 AS cfpk_lineitem_partsupp_0#7435, cpfk_part_lineitem#7403 AS cpfk_part_lineitem_0#7436, cfpk_lineitem_part#7404 AS cfpk_lineitem_part_0#7437, cpfk_partsupp_lineitem#7405 AS cpfk_partsupp_lineitem_0#7438, cfpk_lineitem_orders#7406 AS cfpk_lineitem_orders_0#7439, cval_lineitem_l_quantity#7407 AS cval_lineitem_l_quantity_0#7440, cval_lineitem_l_extendedprice#7408 AS cval_lineitem_l_extendedprice_0#7441, cval_lineitem_l_discount#7409 AS cval_lineitem_l_discount_0#7442, cval_lineitem_l_tax#7410 AS cval_lineitem_l_tax_0#7443, cval_lineitem_l_returnflag#7411 AS cval_lineitem_l_returnflag_0#7444, cval_lineitem_l_linestatus#7412 AS cval_lineitem_l_linestatus_0#7445, cval_lineitem_l_commitdate#7413 AS cval_lineitem_l_commitdate_0#7446, cval_lineitem_l_receiptdate#7414 AS cval_lineitem_l_receiptdate_0#7447, cval_lineitem_l_shipinstruct#7415 AS cval_lineitem_l_shipinstruct_0#7448, cval_lineitem_l_shipmode#7416 AS cval_lineitem_l_shipmode_0#7449, cval_lineitem_l_comment#7417 AS cval_lineitem_l_comment_0#7450, cval_lineitem_l_shipdate#7418 AS cval_lineitem_l_shipdate_0#7451, cl_quantity#7419 AS cl_quantity_0#7452, cl_extendedprice#7420 AS cl_extendedprice_0#7453, cl_discount#7421 AS cl_discount_0#7454, ... 9 more fields]
            :        +- Relation[rid#7398,cpfk_orders_lineitem#7399,cpfk_supplier_lineitem#7400,cfpk_lineitem_supplier#7401,cfpk_lineitem_partsupp#7402,cpfk_part_lineitem#7403,cfpk_lineitem_part#7404,cpfk_partsupp_lineitem#7405,cfpk_lineitem_orders#7406,cval_lineitem_l_quantity#7407,cval_lineitem_l_extendedprice#7408,cval_lineitem_l_discount#7409,cval_lineitem_l_tax#7410,cval_lineitem_l_returnflag#7411,cval_lineitem_l_linestatus#7412,cval_lineitem_l_commitdate#7413,cval_lineitem_l_receiptdate#7414,cval_lineitem_l_shipinstruct#7415,cval_lineitem_l_shipmode#7416,cval_lineitem_l_comment#7417,cval_lineitem_l_shipdate#7418,cl_quantity#7419,cl_extendedprice#7420,cl_discount#7421,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#7464 AS rid_1#7481, cpfk_customer_orders#7465 AS cpfk_customer_orders_1#7482, cfpk_orders_customer#7466 AS cfpk_orders_customer_1#7483, cval_orders_o_orderstatus#7467 AS cval_orders_o_orderstatus_1#7484, cval_orders_o_totalprice#7468 AS cval_orders_o_totalprice_1#7485, cval_orders_o_orderpriority#7469 AS cval_orders_o_orderpriority_1#7486, cval_orders_o_clerk#7470 AS cval_orders_o_clerk_1#7487, cval_orders_o_shippriority#7471 AS cval_orders_o_shippriority_1#7488, cval_orders_o_comment#7472 AS cval_orders_o_comment_1#7489, cval_orders_o_orderdate#7473 AS cval_orders_o_orderdate_1#7490, co_orderstatus#7474 AS co_orderstatus_1#7491, co_totalprice#7475 AS co_totalprice_1#7492, co_orderpriority#7476 AS co_orderpriority_1#7493, co_clerk#7477 AS co_clerk_1#7494, co_shippriority#7478 AS co_shippriority_1#7495, co_comment#7479 AS co_comment_1#7496, co_orderdate#7480 AS co_orderdate_1#7497]
               +- Relation[rid#7464,cpfk_customer_orders#7465,cfpk_orders_customer#7466,cval_orders_o_orderstatus#7467,cval_orders_o_totalprice#7468,cval_orders_o_orderpriority#7469,cval_orders_o_clerk#7470,cval_orders_o_shippriority#7471,cval_orders_o_comment#7472,cval_orders_o_orderdate#7473,co_orderstatus#7474,co_totalprice#7475,co_orderpriority#7476,co_clerk#7477,co_shippriority#7478,co_comment#7479,co_orderdate#7480] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 21258ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 08:21:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:21:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7557L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 08:21:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:21:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:21:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:21:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:21:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:21:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:21:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:21:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:21:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:21:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:21:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:21:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:21:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:21:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:21:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:21:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 08:21:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7557L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#7559 AS rid_0#7566, cpfk_region_nation#7560 AS cpfk_region_nation_0#7567, cfpk_nation_region#7561 AS cfpk_nation_region_0#7568, cval_nation_n_name#7562 AS cval_nation_n_name_0#7569, cval_nation_n_comment#7563 AS cval_nation_n_comment_0#7570, cn_name#7564 AS cn_name_0#7571, cn_comment#7565 AS cn_comment_0#7572]
            :  :  :     :  :  :  :  :  +- Relation[rid#7559,cpfk_region_nation#7560,cfpk_nation_region#7561,cval_nation_n_name#7562,cval_nation_n_comment#7563,cn_name#7564,cn_comment#7565] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#7599 AS rid_0#7606, cpfk_region_nation#7600 AS cpfk_region_nation_0#7607, cfpk_nation_region#7601 AS cfpk_nation_region_0#7608, cval_nation_n_name#7602 AS cval_nation_n_name_0#7609, cval_nation_n_comment#7603 AS cval_nation_n_comment_0#7610, cn_name#7604 AS cn_name_0#7611, cn_comment#7605 AS cn_comment_0#7612]
            :  :  :     :  :  :  :     :  +- Relation[rid#7599,cpfk_region_nation#7600,cfpk_nation_region#7601,cval_nation_n_name#7602,cval_nation_n_comment#7603,cn_name#7604,cn_comment#7605] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#7613 AS rid_1#7626, cpfk_nation_supplier#7614 AS cpfk_nation_supplier_1#7627, cfpk_supplier_nation#7615 AS cfpk_supplier_nation_1#7628, cval_supplier_s_name#7616 AS cval_supplier_s_name_1#7629, cval_supplier_s_address#7617 AS cval_supplier_s_address_1#7630, cval_supplier_s_phone#7618 AS cval_supplier_s_phone_1#7631, cval_supplier_s_acctbal#7619 AS cval_supplier_s_acctbal_1#7632, cval_supplier_s_comment#7620 AS cval_supplier_s_comment_1#7633, cs_name#7621 AS cs_name_1#7634, cs_address#7622 AS cs_address_1#7635, cs_phone#7623 AS cs_phone_1#7636, cs_acctbal#7624 AS cs_acctbal_1#7637, cs_comment#7625 AS cs_comment_1#7638]
            :  :  :     :  :  :  :        +- Relation[rid#7613,cpfk_nation_supplier#7614,cfpk_supplier_nation#7615,cval_supplier_s_name#7616,cval_supplier_s_address#7617,cval_supplier_s_phone#7618,cval_supplier_s_acctbal#7619,cval_supplier_s_comment#7620,cs_name#7621,cs_address#7622,cs_phone#7623,cs_acctbal#7624,cs_comment#7625] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#7573 AS rid_1#7586, cpfk_nation_supplier#7574 AS cpfk_nation_supplier_1#7587, cfpk_supplier_nation#7575 AS cfpk_supplier_nation_1#7588, cval_supplier_s_name#7576 AS cval_supplier_s_name_1#7589, cval_supplier_s_address#7577 AS cval_supplier_s_address_1#7590, cval_supplier_s_phone#7578 AS cval_supplier_s_phone_1#7591, cval_supplier_s_acctbal#7579 AS cval_supplier_s_acctbal_1#7592, cval_supplier_s_comment#7580 AS cval_supplier_s_comment_1#7593, cs_name#7581 AS cs_name_1#7594, cs_address#7582 AS cs_address_1#7595, cs_phone#7583 AS cs_phone_1#7596, cs_acctbal#7584 AS cs_acctbal_1#7597, cs_comment#7585 AS cs_comment_1#7598]
            :  :  :     :  :  :     +- Relation[rid#7573,cpfk_nation_supplier#7574,cfpk_supplier_nation#7575,cval_supplier_s_name#7576,cval_supplier_s_address#7577,cval_supplier_s_phone#7578,cval_supplier_s_acctbal#7579,cval_supplier_s_comment#7580,cs_name#7581,cs_address#7582,cs_phone#7583,cs_acctbal#7584,cs_comment#7585] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#7661 AS rid_1#7674, cpfk_nation_supplier#7662 AS cpfk_nation_supplier_1#7675, cfpk_supplier_nation#7663 AS cfpk_supplier_nation_1#7676, cval_supplier_s_name#7664 AS cval_supplier_s_name_1#7677, cval_supplier_s_address#7665 AS cval_supplier_s_address_1#7678, cval_supplier_s_phone#7666 AS cval_supplier_s_phone_1#7679, cval_supplier_s_acctbal#7667 AS cval_supplier_s_acctbal_1#7680, cval_supplier_s_comment#7668 AS cval_supplier_s_comment_1#7681, cs_name#7669 AS cs_name_1#7682, cs_address#7670 AS cs_address_1#7683, cs_phone#7671 AS cs_phone_1#7684, cs_acctbal#7672 AS cs_acctbal_1#7685, cs_comment#7673 AS cs_comment_1#7686]
            :  :  :     :  :     :  +- Relation[rid#7661,cpfk_nation_supplier#7662,cfpk_supplier_nation#7663,cval_supplier_s_name#7664,cval_supplier_s_address#7665,cval_supplier_s_phone#7666,cval_supplier_s_acctbal#7667,cval_supplier_s_comment#7668,cs_name#7669,cs_address#7670,cs_phone#7671,cs_acctbal#7672,cs_comment#7673] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#7687 AS rid_2#7698, cpfk_part_partsupp#7688 AS cpfk_part_partsupp_2#7699, cfpk_partsupp_part#7689 AS cfpk_partsupp_part_2#7700, cpfk_supplier_partsupp#7690 AS cpfk_supplier_partsupp_2#7701, cfpk_partsupp_supplier#7691 AS cfpk_partsupp_supplier_2#7702, cval_partsupp_ps_availqty#7692 AS cval_partsupp_ps_availqty_2#7703, cval_partsupp_ps_supplycost#7693 AS cval_partsupp_ps_supplycost_2#7704, cval_partsupp_ps_comment#7694 AS cval_partsupp_ps_comment_2#7705, cps_availqty#7695 AS cps_availqty_2#7706, cps_supplycost#7696 AS cps_supplycost_2#7707, cps_comment#7697 AS cps_comment_2#7708]
            :  :  :     :  :        +- Relation[rid#7687,cpfk_part_partsupp#7688,cfpk_partsupp_part#7689,cpfk_supplier_partsupp#7690,cfpk_partsupp_supplier#7691,cval_partsupp_ps_availqty#7692,cval_partsupp_ps_supplycost#7693,cval_partsupp_ps_comment#7694,cps_availqty#7695,cps_supplycost#7696,cps_comment#7697] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#7639 AS rid_2#7650, cpfk_part_partsupp#7640 AS cpfk_part_partsupp_2#7651, cfpk_partsupp_part#7641 AS cfpk_partsupp_part_2#7652, cpfk_supplier_partsupp#7642 AS cpfk_supplier_partsupp_2#7653, cfpk_partsupp_supplier#7643 AS cfpk_partsupp_supplier_2#7654, cval_partsupp_ps_availqty#7644 AS cval_partsupp_ps_availqty_2#7655, cval_partsupp_ps_supplycost#7645 AS cval_partsupp_ps_supplycost_2#7656, cval_partsupp_ps_comment#7646 AS cval_partsupp_ps_comment_2#7657, cps_availqty#7647 AS cps_availqty_2#7658, cps_supplycost#7648 AS cps_supplycost_2#7659, cps_comment#7649 AS cps_comment_2#7660]
            :  :  :     :     +- Relation[rid#7639,cpfk_part_partsupp#7640,cfpk_partsupp_part#7641,cpfk_supplier_partsupp#7642,cfpk_partsupp_supplier#7643,cval_partsupp_ps_availqty#7644,cval_partsupp_ps_supplycost#7645,cval_partsupp_ps_comment#7646,cps_availqty#7647,cps_supplycost#7648,cps_comment#7649] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#7709 AS rid_3#7726, cval_part_p_name#7710 AS cval_part_p_name_3#7727, cval_part_p_mfgr#7711 AS cval_part_p_mfgr_3#7728, cval_part_p_type#7712 AS cval_part_p_type_3#7729, cval_part_p_size#7713 AS cval_part_p_size_3#7730, cval_part_p_container#7714 AS cval_part_p_container_3#7731, cval_part_p_retailprice#7715 AS cval_part_p_retailprice_3#7732, cval_part_p_comment#7716 AS cval_part_p_comment_3#7733, cval_part_p_brand#7717 AS cval_part_p_brand_3#7734, cp_name#7718 AS cp_name_3#7735, cp_mfgr#7719 AS cp_mfgr_3#7736, cp_type#7720 AS cp_type_3#7737, cp_size#7721 AS cp_size_3#7738, cp_container#7722 AS cp_container_3#7739, cp_retailprice#7723 AS cp_retailprice_3#7740, cp_comment#7724 AS cp_comment_3#7741, cp_brand#7725 AS cp_brand_3#7742]
            :  :  :        +- Relation[rid#7709,cval_part_p_name#7710,cval_part_p_mfgr#7711,cval_part_p_type#7712,cval_part_p_size#7713,cval_part_p_container#7714,cval_part_p_retailprice#7715,cval_part_p_comment#7716,cval_part_p_brand#7717,cp_name#7718,cp_mfgr#7719,cp_type#7720,cp_size#7721,cp_container#7722,cp_retailprice#7723,cp_comment#7724,cp_brand#7725] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#7809 AS rid_2#7820, cpfk_part_partsupp#7810 AS cpfk_part_partsupp_2#7821, cfpk_partsupp_part#7811 AS cfpk_partsupp_part_2#7822, cpfk_supplier_partsupp#7812 AS cpfk_supplier_partsupp_2#7823, cfpk_partsupp_supplier#7813 AS cfpk_partsupp_supplier_2#7824, cval_partsupp_ps_availqty#7814 AS cval_partsupp_ps_availqty_2#7825, cval_partsupp_ps_supplycost#7815 AS cval_partsupp_ps_supplycost_2#7826, cval_partsupp_ps_comment#7816 AS cval_partsupp_ps_comment_2#7827, cps_availqty#7817 AS cps_availqty_2#7828, cps_supplycost#7818 AS cps_supplycost_2#7829, cps_comment#7819 AS cps_comment_2#7830]
            :  :     :  +- Relation[rid#7809,cpfk_part_partsupp#7810,cfpk_partsupp_part#7811,cpfk_supplier_partsupp#7812,cfpk_partsupp_supplier#7813,cval_partsupp_ps_availqty#7814,cval_partsupp_ps_supplycost#7815,cval_partsupp_ps_comment#7816,cps_availqty#7817,cps_supplycost#7818,cps_comment#7819] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#7831 AS rid_4#7864, cpfk_orders_lineitem#7832 AS cpfk_orders_lineitem_4#7865, cpfk_supplier_lineitem#7833 AS cpfk_supplier_lineitem_4#7866, cfpk_lineitem_supplier#7834 AS cfpk_lineitem_supplier_4#7867, cfpk_lineitem_partsupp#7835 AS cfpk_lineitem_partsupp_4#7868, cpfk_part_lineitem#7836 AS cpfk_part_lineitem_4#7869, cfpk_lineitem_part#7837 AS cfpk_lineitem_part_4#7870, cpfk_partsupp_lineitem#7838 AS cpfk_partsupp_lineitem_4#7871, cfpk_lineitem_orders#7839 AS cfpk_lineitem_orders_4#7872, cval_lineitem_l_quantity#7840 AS cval_lineitem_l_quantity_4#7873, cval_lineitem_l_extendedprice#7841 AS cval_lineitem_l_extendedprice_4#7874, cval_lineitem_l_discount#7842 AS cval_lineitem_l_discount_4#7875, cval_lineitem_l_tax#7843 AS cval_lineitem_l_tax_4#7876, cval_lineitem_l_returnflag#7844 AS cval_lineitem_l_returnflag_4#7877, cval_lineitem_l_linestatus#7845 AS cval_lineitem_l_linestatus_4#7878, cval_lineitem_l_commitdate#7846 AS cval_lineitem_l_commitdate_4#7879, cval_lineitem_l_receiptdate#7847 AS cval_lineitem_l_receiptdate_4#7880, cval_lineitem_l_shipinstruct#7848 AS cval_lineitem_l_shipinstruct_4#7881, cval_lineitem_l_shipmode#7849 AS cval_lineitem_l_shipmode_4#7882, cval_lineitem_l_comment#7850 AS cval_lineitem_l_comment_4#7883, cval_lineitem_l_shipdate#7851 AS cval_lineitem_l_shipdate_4#7884, cl_quantity#7852 AS cl_quantity_4#7885, cl_extendedprice#7853 AS cl_extendedprice_4#7886, cl_discount#7854 AS cl_discount_4#7887, ... 9 more fields]
            :  :        +- Relation[rid#7831,cpfk_orders_lineitem#7832,cpfk_supplier_lineitem#7833,cfpk_lineitem_supplier#7834,cfpk_lineitem_partsupp#7835,cpfk_part_lineitem#7836,cfpk_lineitem_part#7837,cpfk_partsupp_lineitem#7838,cfpk_lineitem_orders#7839,cval_lineitem_l_quantity#7840,cval_lineitem_l_extendedprice#7841,cval_lineitem_l_discount#7842,cval_lineitem_l_tax#7843,cval_lineitem_l_returnflag#7844,cval_lineitem_l_linestatus#7845,cval_lineitem_l_commitdate#7846,cval_lineitem_l_receiptdate#7847,cval_lineitem_l_shipinstruct#7848,cval_lineitem_l_shipmode#7849,cval_lineitem_l_comment#7850,cval_lineitem_l_shipdate#7851,cl_quantity#7852,cl_extendedprice#7853,cl_discount#7854,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#7743 AS rid_4#7776, cpfk_orders_lineitem#7744 AS cpfk_orders_lineitem_4#7777, cpfk_supplier_lineitem#7745 AS cpfk_supplier_lineitem_4#7778, cfpk_lineitem_supplier#7746 AS cfpk_lineitem_supplier_4#7779, cfpk_lineitem_partsupp#7747 AS cfpk_lineitem_partsupp_4#7780, cpfk_part_lineitem#7748 AS cpfk_part_lineitem_4#7781, cfpk_lineitem_part#7749 AS cfpk_lineitem_part_4#7782, cpfk_partsupp_lineitem#7750 AS cpfk_partsupp_lineitem_4#7783, cfpk_lineitem_orders#7751 AS cfpk_lineitem_orders_4#7784, cval_lineitem_l_quantity#7752 AS cval_lineitem_l_quantity_4#7785, cval_lineitem_l_extendedprice#7753 AS cval_lineitem_l_extendedprice_4#7786, cval_lineitem_l_discount#7754 AS cval_lineitem_l_discount_4#7787, cval_lineitem_l_tax#7755 AS cval_lineitem_l_tax_4#7788, cval_lineitem_l_returnflag#7756 AS cval_lineitem_l_returnflag_4#7789, cval_lineitem_l_linestatus#7757 AS cval_lineitem_l_linestatus_4#7790, cval_lineitem_l_commitdate#7758 AS cval_lineitem_l_commitdate_4#7791, cval_lineitem_l_receiptdate#7759 AS cval_lineitem_l_receiptdate_4#7792, cval_lineitem_l_shipinstruct#7760 AS cval_lineitem_l_shipinstruct_4#7793, cval_lineitem_l_shipmode#7761 AS cval_lineitem_l_shipmode_4#7794, cval_lineitem_l_comment#7762 AS cval_lineitem_l_comment_4#7795, cval_lineitem_l_shipdate#7763 AS cval_lineitem_l_shipdate_4#7796, cl_quantity#7764 AS cl_quantity_4#7797, cl_extendedprice#7765 AS cl_extendedprice_4#7798, cl_discount#7766 AS cl_discount_4#7799, ... 9 more fields]
            :     +- Relation[rid#7743,cpfk_orders_lineitem#7744,cpfk_supplier_lineitem#7745,cfpk_lineitem_supplier#7746,cfpk_lineitem_partsupp#7747,cpfk_part_lineitem#7748,cfpk_lineitem_part#7749,cpfk_partsupp_lineitem#7750,cfpk_lineitem_orders#7751,cval_lineitem_l_quantity#7752,cval_lineitem_l_extendedprice#7753,cval_lineitem_l_discount#7754,cval_lineitem_l_tax#7755,cval_lineitem_l_returnflag#7756,cval_lineitem_l_linestatus#7757,cval_lineitem_l_commitdate#7758,cval_lineitem_l_receiptdate#7759,cval_lineitem_l_shipinstruct#7760,cval_lineitem_l_shipmode#7761,cval_lineitem_l_comment#7762,cval_lineitem_l_shipdate#7763,cl_quantity#7764,cl_extendedprice#7765,cl_discount#7766,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#7897 AS rid_5#7914, cpfk_customer_orders#7898 AS cpfk_customer_orders_5#7915, cfpk_orders_customer#7899 AS cfpk_orders_customer_5#7916, cval_orders_o_orderstatus#7900 AS cval_orders_o_orderstatus_5#7917, cval_orders_o_totalprice#7901 AS cval_orders_o_totalprice_5#7918, cval_orders_o_orderpriority#7902 AS cval_orders_o_orderpriority_5#7919, cval_orders_o_clerk#7903 AS cval_orders_o_clerk_5#7920, cval_orders_o_shippriority#7904 AS cval_orders_o_shippriority_5#7921, cval_orders_o_comment#7905 AS cval_orders_o_comment_5#7922, cval_orders_o_orderdate#7906 AS cval_orders_o_orderdate_5#7923, co_orderstatus#7907 AS co_orderstatus_5#7924, co_totalprice#7908 AS co_totalprice_5#7925, co_orderpriority#7909 AS co_orderpriority_5#7926, co_clerk#7910 AS co_clerk_5#7927, co_shippriority#7911 AS co_shippriority_5#7928, co_comment#7912 AS co_comment_5#7929, co_orderdate#7913 AS co_orderdate_5#7930]
               +- Relation[rid#7897,cpfk_customer_orders#7898,cfpk_orders_customer#7899,cval_orders_o_orderstatus#7900,cval_orders_o_totalprice#7901,cval_orders_o_orderpriority#7902,cval_orders_o_clerk#7903,cval_orders_o_shippriority#7904,cval_orders_o_comment#7905,cval_orders_o_orderdate#7906,co_orderstatus#7907,co_totalprice#7908,co_orderpriority#7909,co_clerk#7910,co_shippriority#7911,co_comment#7912,co_orderdate#7913] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 163875ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/11 08:24:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:24:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8034L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 08:24:32 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 08:24:32 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 08:24:32 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 08:24:32 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 08:24:32 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 08:24:32 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 08:24:33 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 08:24:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8034L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#8036 AS rid_0#8053, cval_part_p_name#8037 AS cval_part_p_name_0#8054, cval_part_p_mfgr#8038 AS cval_part_p_mfgr_0#8055, cval_part_p_type#8039 AS cval_part_p_type_0#8056, cval_part_p_size#8040 AS cval_part_p_size_0#8057, cval_part_p_container#8041 AS cval_part_p_container_0#8058, cval_part_p_retailprice#8042 AS cval_part_p_retailprice_0#8059, cval_part_p_comment#8043 AS cval_part_p_comment_0#8060, cval_part_p_brand#8044 AS cval_part_p_brand_0#8061, cp_name#8045 AS cp_name_0#8062, cp_mfgr#8046 AS cp_mfgr_0#8063, cp_type#8047 AS cp_type_0#8064, cp_size#8048 AS cp_size_0#8065, cp_container#8049 AS cp_container_0#8066, cp_retailprice#8050 AS cp_retailprice_0#8067, cp_comment#8051 AS cp_comment_0#8068, cp_brand#8052 AS cp_brand_0#8069]
         :  :  :  :  +- Relation[rid#8036,cval_part_p_name#8037,cval_part_p_mfgr#8038,cval_part_p_type#8039,cval_part_p_size#8040,cval_part_p_container#8041,cval_part_p_retailprice#8042,cval_part_p_comment#8043,cval_part_p_brand#8044,cp_name#8045,cp_mfgr#8046,cp_type#8047,cp_size#8048,cp_container#8049,cp_retailprice#8050,cp_comment#8051,cp_brand#8052] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#8070 AS rid_0#8087, cval_part_p_name#8071 AS cval_part_p_name_0#8088, cval_part_p_mfgr#8072 AS cval_part_p_mfgr_0#8089, cval_part_p_type#8073 AS cval_part_p_type_0#8090, cval_part_p_size#8074 AS cval_part_p_size_0#8091, cval_part_p_container#8075 AS cval_part_p_container_0#8092, cval_part_p_retailprice#8076 AS cval_part_p_retailprice_0#8093, cval_part_p_comment#8077 AS cval_part_p_comment_0#8094, cval_part_p_brand#8078 AS cval_part_p_brand_0#8095, cp_name#8079 AS cp_name_0#8096, cp_mfgr#8080 AS cp_mfgr_0#8097, cp_type#8081 AS cp_type_0#8098, cp_size#8082 AS cp_size_0#8099, cp_container#8083 AS cp_container_0#8100, cp_retailprice#8084 AS cp_retailprice_0#8101, cp_comment#8085 AS cp_comment_0#8102, cp_brand#8086 AS cp_brand_0#8103]
         :  :  :        +- Relation[rid#8070,cval_part_p_name#8071,cval_part_p_mfgr#8072,cval_part_p_type#8073,cval_part_p_size#8074,cval_part_p_container#8075,cval_part_p_retailprice#8076,cval_part_p_comment#8077,cval_part_p_brand#8078,cp_name#8079,cp_mfgr#8080,cp_type#8081,cp_size#8082,cp_container#8083,cp_retailprice#8084,cp_comment#8085,cp_brand#8086] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#8104 AS rid_0#8121, cval_part_p_name#8105 AS cval_part_p_name_0#8122, cval_part_p_mfgr#8106 AS cval_part_p_mfgr_0#8123, cval_part_p_type#8107 AS cval_part_p_type_0#8124, cval_part_p_size#8108 AS cval_part_p_size_0#8125, cval_part_p_container#8109 AS cval_part_p_container_0#8126, cval_part_p_retailprice#8110 AS cval_part_p_retailprice_0#8127, cval_part_p_comment#8111 AS cval_part_p_comment_0#8128, cval_part_p_brand#8112 AS cval_part_p_brand_0#8129, cp_name#8113 AS cp_name_0#8130, cp_mfgr#8114 AS cp_mfgr_0#8131, cp_type#8115 AS cp_type_0#8132, cp_size#8116 AS cp_size_0#8133, cp_container#8117 AS cp_container_0#8134, cp_retailprice#8118 AS cp_retailprice_0#8135, cp_comment#8119 AS cp_comment_0#8136, cp_brand#8120 AS cp_brand_0#8137]
         :  :        +- Relation[rid#8104,cval_part_p_name#8105,cval_part_p_mfgr#8106,cval_part_p_type#8107,cval_part_p_size#8108,cval_part_p_container#8109,cval_part_p_retailprice#8110,cval_part_p_comment#8111,cval_part_p_brand#8112,cp_name#8113,cp_mfgr#8114,cp_type#8115,cp_size#8116,cp_container#8117,cp_retailprice#8118,cp_comment#8119,cp_brand#8120] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#8336 AS rid_0#8353, cval_part_p_name#8337 AS cval_part_p_name_0#8354, cval_part_p_mfgr#8338 AS cval_part_p_mfgr_0#8355, cval_part_p_type#8339 AS cval_part_p_type_0#8356, cval_part_p_size#8340 AS cval_part_p_size_0#8357, cval_part_p_container#8341 AS cval_part_p_container_0#8358, cval_part_p_retailprice#8342 AS cval_part_p_retailprice_0#8359, cval_part_p_comment#8343 AS cval_part_p_comment_0#8360, cval_part_p_brand#8344 AS cval_part_p_brand_0#8361, cp_name#8345 AS cp_name_0#8362, cp_mfgr#8346 AS cp_mfgr_0#8363, cp_type#8347 AS cp_type_0#8364, cp_size#8348 AS cp_size_0#8365, cp_container#8349 AS cp_container_0#8366, cp_retailprice#8350 AS cp_retailprice_0#8367, cp_comment#8351 AS cp_comment_0#8368, cp_brand#8352 AS cp_brand_0#8369]
         :     :  +- Relation[rid#8336,cval_part_p_name#8337,cval_part_p_mfgr#8338,cval_part_p_type#8339,cval_part_p_size#8340,cval_part_p_container#8341,cval_part_p_retailprice#8342,cval_part_p_comment#8343,cval_part_p_brand#8344,cp_name#8345,cp_mfgr#8346,cp_type#8347,cp_size#8348,cp_container#8349,cp_retailprice#8350,cp_comment#8351,cp_brand#8352] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#8370 AS rid_1#8403, cpfk_orders_lineitem#8371 AS cpfk_orders_lineitem_1#8404, cpfk_supplier_lineitem#8372 AS cpfk_supplier_lineitem_1#8405, cfpk_lineitem_supplier#8373 AS cfpk_lineitem_supplier_1#8406, cfpk_lineitem_partsupp#8374 AS cfpk_lineitem_partsupp_1#8407, cpfk_part_lineitem#8375 AS cpfk_part_lineitem_1#8408, cfpk_lineitem_part#8376 AS cfpk_lineitem_part_1#8409, cpfk_partsupp_lineitem#8377 AS cpfk_partsupp_lineitem_1#8410, cfpk_lineitem_orders#8378 AS cfpk_lineitem_orders_1#8411, cval_lineitem_l_quantity#8379 AS cval_lineitem_l_quantity_1#8412, cval_lineitem_l_extendedprice#8380 AS cval_lineitem_l_extendedprice_1#8413, cval_lineitem_l_discount#8381 AS cval_lineitem_l_discount_1#8414, cval_lineitem_l_tax#8382 AS cval_lineitem_l_tax_1#8415, cval_lineitem_l_returnflag#8383 AS cval_lineitem_l_returnflag_1#8416, cval_lineitem_l_linestatus#8384 AS cval_lineitem_l_linestatus_1#8417, cval_lineitem_l_commitdate#8385 AS cval_lineitem_l_commitdate_1#8418, cval_lineitem_l_receiptdate#8386 AS cval_lineitem_l_receiptdate_1#8419, cval_lineitem_l_shipinstruct#8387 AS cval_lineitem_l_shipinstruct_1#8420, cval_lineitem_l_shipmode#8388 AS cval_lineitem_l_shipmode_1#8421, cval_lineitem_l_comment#8389 AS cval_lineitem_l_comment_1#8422, cval_lineitem_l_shipdate#8390 AS cval_lineitem_l_shipdate_1#8423, cl_quantity#8391 AS cl_quantity_1#8424, cl_extendedprice#8392 AS cl_extendedprice_1#8425, cl_discount#8393 AS cl_discount_1#8426, ... 9 more fields]
         :        +- Relation[rid#8370,cpfk_orders_lineitem#8371,cpfk_supplier_lineitem#8372,cfpk_lineitem_supplier#8373,cfpk_lineitem_partsupp#8374,cpfk_part_lineitem#8375,cfpk_lineitem_part#8376,cpfk_partsupp_lineitem#8377,cfpk_lineitem_orders#8378,cval_lineitem_l_quantity#8379,cval_lineitem_l_extendedprice#8380,cval_lineitem_l_discount#8381,cval_lineitem_l_tax#8382,cval_lineitem_l_returnflag#8383,cval_lineitem_l_linestatus#8384,cval_lineitem_l_commitdate#8385,cval_lineitem_l_receiptdate#8386,cval_lineitem_l_shipinstruct#8387,cval_lineitem_l_shipmode#8388,cval_lineitem_l_comment#8389,cval_lineitem_l_shipdate#8390,cl_quantity#8391,cl_extendedprice#8392,cl_discount#8393,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#8138 AS rid_1#8171, cpfk_orders_lineitem#8139 AS cpfk_orders_lineitem_1#8172, cpfk_supplier_lineitem#8140 AS cpfk_supplier_lineitem_1#8173, cfpk_lineitem_supplier#8141 AS cfpk_lineitem_supplier_1#8174, cfpk_lineitem_partsupp#8142 AS cfpk_lineitem_partsupp_1#8175, cpfk_part_lineitem#8143 AS cpfk_part_lineitem_1#8176, cfpk_lineitem_part#8144 AS cfpk_lineitem_part_1#8177, cpfk_partsupp_lineitem#8145 AS cpfk_partsupp_lineitem_1#8178, cfpk_lineitem_orders#8146 AS cfpk_lineitem_orders_1#8179, cval_lineitem_l_quantity#8147 AS cval_lineitem_l_quantity_1#8180, cval_lineitem_l_extendedprice#8148 AS cval_lineitem_l_extendedprice_1#8181, cval_lineitem_l_discount#8149 AS cval_lineitem_l_discount_1#8182, cval_lineitem_l_tax#8150 AS cval_lineitem_l_tax_1#8183, cval_lineitem_l_returnflag#8151 AS cval_lineitem_l_returnflag_1#8184, cval_lineitem_l_linestatus#8152 AS cval_lineitem_l_linestatus_1#8185, cval_lineitem_l_commitdate#8153 AS cval_lineitem_l_commitdate_1#8186, cval_lineitem_l_receiptdate#8154 AS cval_lineitem_l_receiptdate_1#8187, cval_lineitem_l_shipinstruct#8155 AS cval_lineitem_l_shipinstruct_1#8188, cval_lineitem_l_shipmode#8156 AS cval_lineitem_l_shipmode_1#8189, cval_lineitem_l_comment#8157 AS cval_lineitem_l_comment_1#8190, cval_lineitem_l_shipdate#8158 AS cval_lineitem_l_shipdate_1#8191, cl_quantity#8159 AS cl_quantity_1#8192, cl_extendedprice#8160 AS cl_extendedprice_1#8193, cl_discount#8161 AS cl_discount_1#8194, ... 9 more fields]
            :  :  +- Relation[rid#8138,cpfk_orders_lineitem#8139,cpfk_supplier_lineitem#8140,cfpk_lineitem_supplier#8141,cfpk_lineitem_partsupp#8142,cpfk_part_lineitem#8143,cfpk_lineitem_part#8144,cpfk_partsupp_lineitem#8145,cfpk_lineitem_orders#8146,cval_lineitem_l_quantity#8147,cval_lineitem_l_extendedprice#8148,cval_lineitem_l_discount#8149,cval_lineitem_l_tax#8150,cval_lineitem_l_returnflag#8151,cval_lineitem_l_linestatus#8152,cval_lineitem_l_commitdate#8153,cval_lineitem_l_receiptdate#8154,cval_lineitem_l_shipinstruct#8155,cval_lineitem_l_shipmode#8156,cval_lineitem_l_comment#8157,cval_lineitem_l_shipdate#8158,cl_quantity#8159,cl_extendedprice#8160,cl_discount#8161,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#8204 AS rid_1#8237, cpfk_orders_lineitem#8205 AS cpfk_orders_lineitem_1#8238, cpfk_supplier_lineitem#8206 AS cpfk_supplier_lineitem_1#8239, cfpk_lineitem_supplier#8207 AS cfpk_lineitem_supplier_1#8240, cfpk_lineitem_partsupp#8208 AS cfpk_lineitem_partsupp_1#8241, cpfk_part_lineitem#8209 AS cpfk_part_lineitem_1#8242, cfpk_lineitem_part#8210 AS cfpk_lineitem_part_1#8243, cpfk_partsupp_lineitem#8211 AS cpfk_partsupp_lineitem_1#8244, cfpk_lineitem_orders#8212 AS cfpk_lineitem_orders_1#8245, cval_lineitem_l_quantity#8213 AS cval_lineitem_l_quantity_1#8246, cval_lineitem_l_extendedprice#8214 AS cval_lineitem_l_extendedprice_1#8247, cval_lineitem_l_discount#8215 AS cval_lineitem_l_discount_1#8248, cval_lineitem_l_tax#8216 AS cval_lineitem_l_tax_1#8249, cval_lineitem_l_returnflag#8217 AS cval_lineitem_l_returnflag_1#8250, cval_lineitem_l_linestatus#8218 AS cval_lineitem_l_linestatus_1#8251, cval_lineitem_l_commitdate#8219 AS cval_lineitem_l_commitdate_1#8252, cval_lineitem_l_receiptdate#8220 AS cval_lineitem_l_receiptdate_1#8253, cval_lineitem_l_shipinstruct#8221 AS cval_lineitem_l_shipinstruct_1#8254, cval_lineitem_l_shipmode#8222 AS cval_lineitem_l_shipmode_1#8255, cval_lineitem_l_comment#8223 AS cval_lineitem_l_comment_1#8256, cval_lineitem_l_shipdate#8224 AS cval_lineitem_l_shipdate_1#8257, cl_quantity#8225 AS cl_quantity_1#8258, cl_extendedprice#8226 AS cl_extendedprice_1#8259, cl_discount#8227 AS cl_discount_1#8260, ... 9 more fields]
            :        +- Relation[rid#8204,cpfk_orders_lineitem#8205,cpfk_supplier_lineitem#8206,cfpk_lineitem_supplier#8207,cfpk_lineitem_partsupp#8208,cpfk_part_lineitem#8209,cfpk_lineitem_part#8210,cpfk_partsupp_lineitem#8211,cfpk_lineitem_orders#8212,cval_lineitem_l_quantity#8213,cval_lineitem_l_extendedprice#8214,cval_lineitem_l_discount#8215,cval_lineitem_l_tax#8216,cval_lineitem_l_returnflag#8217,cval_lineitem_l_linestatus#8218,cval_lineitem_l_commitdate#8219,cval_lineitem_l_receiptdate#8220,cval_lineitem_l_shipinstruct#8221,cval_lineitem_l_shipmode#8222,cval_lineitem_l_comment#8223,cval_lineitem_l_shipdate#8224,cl_quantity#8225,cl_extendedprice#8226,cl_discount#8227,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#8270 AS rid_1#8303, cpfk_orders_lineitem#8271 AS cpfk_orders_lineitem_1#8304, cpfk_supplier_lineitem#8272 AS cpfk_supplier_lineitem_1#8305, cfpk_lineitem_supplier#8273 AS cfpk_lineitem_supplier_1#8306, cfpk_lineitem_partsupp#8274 AS cfpk_lineitem_partsupp_1#8307, cpfk_part_lineitem#8275 AS cpfk_part_lineitem_1#8308, cfpk_lineitem_part#8276 AS cfpk_lineitem_part_1#8309, cpfk_partsupp_lineitem#8277 AS cpfk_partsupp_lineitem_1#8310, cfpk_lineitem_orders#8278 AS cfpk_lineitem_orders_1#8311, cval_lineitem_l_quantity#8279 AS cval_lineitem_l_quantity_1#8312, cval_lineitem_l_extendedprice#8280 AS cval_lineitem_l_extendedprice_1#8313, cval_lineitem_l_discount#8281 AS cval_lineitem_l_discount_1#8314, cval_lineitem_l_tax#8282 AS cval_lineitem_l_tax_1#8315, cval_lineitem_l_returnflag#8283 AS cval_lineitem_l_returnflag_1#8316, cval_lineitem_l_linestatus#8284 AS cval_lineitem_l_linestatus_1#8317, cval_lineitem_l_commitdate#8285 AS cval_lineitem_l_commitdate_1#8318, cval_lineitem_l_receiptdate#8286 AS cval_lineitem_l_receiptdate_1#8319, cval_lineitem_l_shipinstruct#8287 AS cval_lineitem_l_shipinstruct_1#8320, cval_lineitem_l_shipmode#8288 AS cval_lineitem_l_shipmode_1#8321, cval_lineitem_l_comment#8289 AS cval_lineitem_l_comment_1#8322, cval_lineitem_l_shipdate#8290 AS cval_lineitem_l_shipdate_1#8323, cl_quantity#8291 AS cl_quantity_1#8324, cl_extendedprice#8292 AS cl_extendedprice_1#8325, cl_discount#8293 AS cl_discount_1#8326, ... 9 more fields]
                  +- Relation[rid#8270,cpfk_orders_lineitem#8271,cpfk_supplier_lineitem#8272,cfpk_lineitem_supplier#8273,cfpk_lineitem_partsupp#8274,cpfk_part_lineitem#8275,cfpk_lineitem_part#8276,cpfk_partsupp_lineitem#8277,cfpk_lineitem_orders#8278,cval_lineitem_l_quantity#8279,cval_lineitem_l_extendedprice#8280,cval_lineitem_l_discount#8281,cval_lineitem_l_tax#8282,cval_lineitem_l_returnflag#8283,cval_lineitem_l_linestatus#8284,cval_lineitem_l_commitdate#8285,cval_lineitem_l_receiptdate#8286,cval_lineitem_l_shipinstruct#8287,cval_lineitem_l_shipmode#8288,cval_lineitem_l_comment#8289,cval_lineitem_l_shipdate#8290,cl_quantity#8291,cl_extendedprice#8292,cl_discount#8293,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 363500ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/11 08:30:36 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:30:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8492L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 08:30:36 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 08:30:36 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 08:30:36 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 08:30:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:30:36 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 08:30:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:30:36 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 08:30:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:30:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:30:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:30:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:30:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:30:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:30:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:30:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 08:30:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 08:30:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8492L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#8494 AS rid_0#8499, cval_region_r_name#8495 AS cval_region_r_name_0#8500, cval_region_r_comment#8496 AS cval_region_r_comment_0#8501, cr_name#8497 AS cr_name_0#8502, cr_comment#8498 AS cr_comment_0#8503]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#8494,cval_region_r_name#8495,cval_region_r_comment#8496,cr_name#8497,cr_comment#8498] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#8504 AS rid_0#8509, cval_region_r_name#8505 AS cval_region_r_name_0#8510, cval_region_r_comment#8506 AS cval_region_r_comment_0#8511, cr_name#8507 AS cr_name_0#8512, cr_comment#8508 AS cr_comment_0#8513]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#8504,cval_region_r_name#8505,cval_region_r_comment#8506,cr_name#8507,cr_comment#8508] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :     :- Project [rid#8528 AS rid_0#8533, cval_region_r_name#8529 AS cval_region_r_name_0#8534, cval_region_r_comment#8530 AS cval_region_r_comment_0#8535, cr_name#8531 AS cr_name_0#8536, cr_comment#8532 AS cr_comment_0#8537]
         :     :  :  :  :  :  :  :  :     :  +- Relation[rid#8528,cval_region_r_name#8529,cval_region_r_comment#8530,cr_name#8531,cr_comment#8532] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :     +- Project [rid#8538 AS rid_1#8545, cpfk_region_nation#8539 AS cpfk_region_nation_1#8546, cfpk_nation_region#8540 AS cfpk_nation_region_1#8547, cval_nation_n_name#8541 AS cval_nation_n_name_1#8548, cval_nation_n_comment#8542 AS cval_nation_n_comment_1#8549, cn_name#8543 AS cn_name_1#8550, cn_comment#8544 AS cn_comment_1#8551]
         :     :  :  :  :  :  :  :  :        +- Relation[rid#8538,cpfk_region_nation#8539,cfpk_nation_region#8540,cval_nation_n_name#8541,cval_nation_n_comment#8542,cn_name#8543,cn_comment#8544] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#8514 AS rid_1#8521, cpfk_region_nation#8515 AS cpfk_region_nation_1#8522, cfpk_nation_region#8516 AS cfpk_nation_region_1#8523, cval_nation_n_name#8517 AS cval_nation_n_name_1#8524, cval_nation_n_comment#8518 AS cval_nation_n_comment_1#8525, cn_name#8519 AS cn_name_1#8526, cn_comment#8520 AS cn_comment_1#8527]
         :     :  :  :  :  :  :  :     +- Relation[rid#8514,cpfk_region_nation#8515,cfpk_nation_region#8516,cval_nation_n_name#8517,cval_nation_n_comment#8518,cn_name#8519,cn_comment#8520] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :     :- Project [rid#8582 AS rid_1#8589, cpfk_region_nation#8583 AS cpfk_region_nation_1#8590, cfpk_nation_region#8584 AS cfpk_nation_region_1#8591, cval_nation_n_name#8585 AS cval_nation_n_name_1#8592, cval_nation_n_comment#8586 AS cval_nation_n_comment_1#8593, cn_name#8587 AS cn_name_1#8594, cn_comment#8588 AS cn_comment_1#8595]
         :     :  :  :  :  :  :     :  +- Relation[rid#8582,cpfk_region_nation#8583,cfpk_nation_region#8584,cval_nation_n_name#8585,cval_nation_n_comment#8586,cn_name#8587,cn_comment#8588] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :     +- Project [rid#8596 AS rid_2#8611, cpfk_nation_customer#8597 AS cpfk_nation_customer_2#8612, cfpk_customer_nation#8598 AS cfpk_customer_nation_2#8613, cval_customer_c_name#8599 AS cval_customer_c_name_2#8614, cval_customer_c_address#8600 AS cval_customer_c_address_2#8615, cval_customer_c_phone#8601 AS cval_customer_c_phone_2#8616, cval_customer_c_acctbal#8602 AS cval_customer_c_acctbal_2#8617, cval_customer_c_comment#8603 AS cval_customer_c_comment_2#8618, cval_customer_c_mktsegment#8604 AS cval_customer_c_mktsegment_2#8619, cc_name#8605 AS cc_name_2#8620, cc_address#8606 AS cc_address_2#8621, cc_phone#8607 AS cc_phone_2#8622, cc_acctbal#8608 AS cc_acctbal_2#8623, cc_comment#8609 AS cc_comment_2#8624, cc_mktsegment#8610 AS cc_mktsegment_2#8625]
         :     :  :  :  :  :  :        +- Relation[rid#8596,cpfk_nation_customer#8597,cfpk_customer_nation#8598,cval_customer_c_name#8599,cval_customer_c_address#8600,cval_customer_c_phone#8601,cval_customer_c_acctbal#8602,cval_customer_c_comment#8603,cval_customer_c_mktsegment#8604,cc_name#8605,cc_address#8606,cc_phone#8607,cc_acctbal#8608,cc_comment#8609,cc_mktsegment#8610] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#8552 AS rid_2#8567, cpfk_nation_customer#8553 AS cpfk_nation_customer_2#8568, cfpk_customer_nation#8554 AS cfpk_customer_nation_2#8569, cval_customer_c_name#8555 AS cval_customer_c_name_2#8570, cval_customer_c_address#8556 AS cval_customer_c_address_2#8571, cval_customer_c_phone#8557 AS cval_customer_c_phone_2#8572, cval_customer_c_acctbal#8558 AS cval_customer_c_acctbal_2#8573, cval_customer_c_comment#8559 AS cval_customer_c_comment_2#8574, cval_customer_c_mktsegment#8560 AS cval_customer_c_mktsegment_2#8575, cc_name#8561 AS cc_name_2#8576, cc_address#8562 AS cc_address_2#8577, cc_phone#8563 AS cc_phone_2#8578, cc_acctbal#8564 AS cc_acctbal_2#8579, cc_comment#8565 AS cc_comment_2#8580, cc_mktsegment#8566 AS cc_mktsegment_2#8581]
         :     :  :  :  :  :     +- Relation[rid#8552,cpfk_nation_customer#8553,cfpk_customer_nation#8554,cval_customer_c_name#8555,cval_customer_c_address#8556,cval_customer_c_phone#8557,cval_customer_c_acctbal#8558,cval_customer_c_comment#8559,cval_customer_c_mktsegment#8560,cc_name#8561,cc_address#8562,cc_phone#8563,cc_acctbal#8564,cc_comment#8565,cc_mktsegment#8566] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :     :- Project [rid#8660 AS rid_2#8675, cpfk_nation_customer#8661 AS cpfk_nation_customer_2#8676, cfpk_customer_nation#8662 AS cfpk_customer_nation_2#8677, cval_customer_c_name#8663 AS cval_customer_c_name_2#8678, cval_customer_c_address#8664 AS cval_customer_c_address_2#8679, cval_customer_c_phone#8665 AS cval_customer_c_phone_2#8680, cval_customer_c_acctbal#8666 AS cval_customer_c_acctbal_2#8681, cval_customer_c_comment#8667 AS cval_customer_c_comment_2#8682, cval_customer_c_mktsegment#8668 AS cval_customer_c_mktsegment_2#8683, cc_name#8669 AS cc_name_2#8684, cc_address#8670 AS cc_address_2#8685, cc_phone#8671 AS cc_phone_2#8686, cc_acctbal#8672 AS cc_acctbal_2#8687, cc_comment#8673 AS cc_comment_2#8688, cc_mktsegment#8674 AS cc_mktsegment_2#8689]
         :     :  :  :  :     :  +- Relation[rid#8660,cpfk_nation_customer#8661,cfpk_customer_nation#8662,cval_customer_c_name#8663,cval_customer_c_address#8664,cval_customer_c_phone#8665,cval_customer_c_acctbal#8666,cval_customer_c_comment#8667,cval_customer_c_mktsegment#8668,cc_name#8669,cc_address#8670,cc_phone#8671,cc_acctbal#8672,cc_comment#8673,cc_mktsegment#8674] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :     +- Project [rid#8690 AS rid_3#8707, cpfk_customer_orders#8691 AS cpfk_customer_orders_3#8708, cfpk_orders_customer#8692 AS cfpk_orders_customer_3#8709, cval_orders_o_orderstatus#8693 AS cval_orders_o_orderstatus_3#8710, cval_orders_o_totalprice#8694 AS cval_orders_o_totalprice_3#8711, cval_orders_o_orderpriority#8695 AS cval_orders_o_orderpriority_3#8712, cval_orders_o_clerk#8696 AS cval_orders_o_clerk_3#8713, cval_orders_o_shippriority#8697 AS cval_orders_o_shippriority_3#8714, cval_orders_o_comment#8698 AS cval_orders_o_comment_3#8715, cval_orders_o_orderdate#8699 AS cval_orders_o_orderdate_3#8716, co_orderstatus#8700 AS co_orderstatus_3#8717, co_totalprice#8701 AS co_totalprice_3#8718, co_orderpriority#8702 AS co_orderpriority_3#8719, co_clerk#8703 AS co_clerk_3#8720, co_shippriority#8704 AS co_shippriority_3#8721, co_comment#8705 AS co_comment_3#8722, co_orderdate#8706 AS co_orderdate_3#8723]
         :     :  :  :  :        +- Relation[rid#8690,cpfk_customer_orders#8691,cfpk_orders_customer#8692,cval_orders_o_orderstatus#8693,cval_orders_o_totalprice#8694,cval_orders_o_orderpriority#8695,cval_orders_o_clerk#8696,cval_orders_o_shippriority#8697,cval_orders_o_comment#8698,cval_orders_o_orderdate#8699,co_orderstatus#8700,co_totalprice#8701,co_orderpriority#8702,co_clerk#8703,co_shippriority#8704,co_comment#8705,co_orderdate#8706] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#8626 AS rid_3#8643, cpfk_customer_orders#8627 AS cpfk_customer_orders_3#8644, cfpk_orders_customer#8628 AS cfpk_orders_customer_3#8645, cval_orders_o_orderstatus#8629 AS cval_orders_o_orderstatus_3#8646, cval_orders_o_totalprice#8630 AS cval_orders_o_totalprice_3#8647, cval_orders_o_orderpriority#8631 AS cval_orders_o_orderpriority_3#8648, cval_orders_o_clerk#8632 AS cval_orders_o_clerk_3#8649, cval_orders_o_shippriority#8633 AS cval_orders_o_shippriority_3#8650, cval_orders_o_comment#8634 AS cval_orders_o_comment_3#8651, cval_orders_o_orderdate#8635 AS cval_orders_o_orderdate_3#8652, co_orderstatus#8636 AS co_orderstatus_3#8653, co_totalprice#8637 AS co_totalprice_3#8654, co_orderpriority#8638 AS co_orderpriority_3#8655, co_clerk#8639 AS co_clerk_3#8656, co_shippriority#8640 AS co_shippriority_3#8657, co_comment#8641 AS co_comment_3#8658, co_orderdate#8642 AS co_orderdate_3#8659]
         :     :  :  :     +- Relation[rid#8626,cpfk_customer_orders#8627,cfpk_orders_customer#8628,cval_orders_o_orderstatus#8629,cval_orders_o_totalprice#8630,cval_orders_o_orderpriority#8631,cval_orders_o_clerk#8632,cval_orders_o_shippriority#8633,cval_orders_o_comment#8634,cval_orders_o_orderdate#8635,co_orderstatus#8636,co_totalprice#8637,co_orderpriority#8638,co_clerk#8639,co_shippriority#8640,co_comment#8641,co_orderdate#8642] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :     :- Project [rid#8790 AS rid_3#8807, cpfk_customer_orders#8791 AS cpfk_customer_orders_3#8808, cfpk_orders_customer#8792 AS cfpk_orders_customer_3#8809, cval_orders_o_orderstatus#8793 AS cval_orders_o_orderstatus_3#8810, cval_orders_o_totalprice#8794 AS cval_orders_o_totalprice_3#8811, cval_orders_o_orderpriority#8795 AS cval_orders_o_orderpriority_3#8812, cval_orders_o_clerk#8796 AS cval_orders_o_clerk_3#8813, cval_orders_o_shippriority#8797 AS cval_orders_o_shippriority_3#8814, cval_orders_o_comment#8798 AS cval_orders_o_comment_3#8815, cval_orders_o_orderdate#8799 AS cval_orders_o_orderdate_3#8816, co_orderstatus#8800 AS co_orderstatus_3#8817, co_totalprice#8801 AS co_totalprice_3#8818, co_orderpriority#8802 AS co_orderpriority_3#8819, co_clerk#8803 AS co_clerk_3#8820, co_shippriority#8804 AS co_shippriority_3#8821, co_comment#8805 AS co_comment_3#8822, co_orderdate#8806 AS co_orderdate_3#8823]
         :     :  :     :  +- Relation[rid#8790,cpfk_customer_orders#8791,cfpk_orders_customer#8792,cval_orders_o_orderstatus#8793,cval_orders_o_totalprice#8794,cval_orders_o_orderpriority#8795,cval_orders_o_clerk#8796,cval_orders_o_shippriority#8797,cval_orders_o_comment#8798,cval_orders_o_orderdate#8799,co_orderstatus#8800,co_totalprice#8801,co_orderpriority#8802,co_clerk#8803,co_shippriority#8804,co_comment#8805,co_orderdate#8806] JDBCRelation(torders) [numPartitions=1]
         :     :  :     +- Project [rid#8824 AS rid_4#8857, cpfk_orders_lineitem#8825 AS cpfk_orders_lineitem_4#8858, cpfk_supplier_lineitem#8826 AS cpfk_supplier_lineitem_4#8859, cfpk_lineitem_supplier#8827 AS cfpk_lineitem_supplier_4#8860, cfpk_lineitem_partsupp#8828 AS cfpk_lineitem_partsupp_4#8861, cpfk_part_lineitem#8829 AS cpfk_part_lineitem_4#8862, cfpk_lineitem_part#8830 AS cfpk_lineitem_part_4#8863, cpfk_partsupp_lineitem#8831 AS cpfk_partsupp_lineitem_4#8864, cfpk_lineitem_orders#8832 AS cfpk_lineitem_orders_4#8865, cval_lineitem_l_quantity#8833 AS cval_lineitem_l_quantity_4#8866, cval_lineitem_l_extendedprice#8834 AS cval_lineitem_l_extendedprice_4#8867, cval_lineitem_l_discount#8835 AS cval_lineitem_l_discount_4#8868, cval_lineitem_l_tax#8836 AS cval_lineitem_l_tax_4#8869, cval_lineitem_l_returnflag#8837 AS cval_lineitem_l_returnflag_4#8870, cval_lineitem_l_linestatus#8838 AS cval_lineitem_l_linestatus_4#8871, cval_lineitem_l_commitdate#8839 AS cval_lineitem_l_commitdate_4#8872, cval_lineitem_l_receiptdate#8840 AS cval_lineitem_l_receiptdate_4#8873, cval_lineitem_l_shipinstruct#8841 AS cval_lineitem_l_shipinstruct_4#8874, cval_lineitem_l_shipmode#8842 AS cval_lineitem_l_shipmode_4#8875, cval_lineitem_l_comment#8843 AS cval_lineitem_l_comment_4#8876, cval_lineitem_l_shipdate#8844 AS cval_lineitem_l_shipdate_4#8877, cl_quantity#8845 AS cl_quantity_4#8878, cl_extendedprice#8846 AS cl_extendedprice_4#8879, cl_discount#8847 AS cl_discount_4#8880, ... 9 more fields]
         :     :  :        +- Relation[rid#8824,cpfk_orders_lineitem#8825,cpfk_supplier_lineitem#8826,cfpk_lineitem_supplier#8827,cfpk_lineitem_partsupp#8828,cpfk_part_lineitem#8829,cfpk_lineitem_part#8830,cpfk_partsupp_lineitem#8831,cfpk_lineitem_orders#8832,cval_lineitem_l_quantity#8833,cval_lineitem_l_extendedprice#8834,cval_lineitem_l_discount#8835,cval_lineitem_l_tax#8836,cval_lineitem_l_returnflag#8837,cval_lineitem_l_linestatus#8838,cval_lineitem_l_commitdate#8839,cval_lineitem_l_receiptdate#8840,cval_lineitem_l_shipinstruct#8841,cval_lineitem_l_shipmode#8842,cval_lineitem_l_comment#8843,cval_lineitem_l_shipdate#8844,cl_quantity#8845,cl_extendedprice#8846,cl_discount#8847,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#8724 AS rid_4#8757, cpfk_orders_lineitem#8725 AS cpfk_orders_lineitem_4#8758, cpfk_supplier_lineitem#8726 AS cpfk_supplier_lineitem_4#8759, cfpk_lineitem_supplier#8727 AS cfpk_lineitem_supplier_4#8760, cfpk_lineitem_partsupp#8728 AS cfpk_lineitem_partsupp_4#8761, cpfk_part_lineitem#8729 AS cpfk_part_lineitem_4#8762, cfpk_lineitem_part#8730 AS cfpk_lineitem_part_4#8763, cpfk_partsupp_lineitem#8731 AS cpfk_partsupp_lineitem_4#8764, cfpk_lineitem_orders#8732 AS cfpk_lineitem_orders_4#8765, cval_lineitem_l_quantity#8733 AS cval_lineitem_l_quantity_4#8766, cval_lineitem_l_extendedprice#8734 AS cval_lineitem_l_extendedprice_4#8767, cval_lineitem_l_discount#8735 AS cval_lineitem_l_discount_4#8768, cval_lineitem_l_tax#8736 AS cval_lineitem_l_tax_4#8769, cval_lineitem_l_returnflag#8737 AS cval_lineitem_l_returnflag_4#8770, cval_lineitem_l_linestatus#8738 AS cval_lineitem_l_linestatus_4#8771, cval_lineitem_l_commitdate#8739 AS cval_lineitem_l_commitdate_4#8772, cval_lineitem_l_receiptdate#8740 AS cval_lineitem_l_receiptdate_4#8773, cval_lineitem_l_shipinstruct#8741 AS cval_lineitem_l_shipinstruct_4#8774, cval_lineitem_l_shipmode#8742 AS cval_lineitem_l_shipmode_4#8775, cval_lineitem_l_comment#8743 AS cval_lineitem_l_comment_4#8776, cval_lineitem_l_shipdate#8744 AS cval_lineitem_l_shipdate_4#8777, cl_quantity#8745 AS cl_quantity_4#8778, cl_extendedprice#8746 AS cl_extendedprice_4#8779, cl_discount#8747 AS cl_discount_4#8780, ... 9 more fields]
         :     :     +- Relation[rid#8724,cpfk_orders_lineitem#8725,cpfk_supplier_lineitem#8726,cfpk_lineitem_supplier#8727,cfpk_lineitem_partsupp#8728,cpfk_part_lineitem#8729,cfpk_lineitem_part#8730,cpfk_partsupp_lineitem#8731,cfpk_lineitem_orders#8732,cval_lineitem_l_quantity#8733,cval_lineitem_l_extendedprice#8734,cval_lineitem_l_discount#8735,cval_lineitem_l_tax#8736,cval_lineitem_l_returnflag#8737,cval_lineitem_l_linestatus#8738,cval_lineitem_l_commitdate#8739,cval_lineitem_l_receiptdate#8740,cval_lineitem_l_shipinstruct#8741,cval_lineitem_l_shipmode#8742,cval_lineitem_l_comment#8743,cval_lineitem_l_shipdate#8744,cl_quantity#8745,cl_extendedprice#8746,cl_discount#8747,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#8890 AS rid_5#8903, cpfk_nation_supplier#8891 AS cpfk_nation_supplier_5#8904, cfpk_supplier_nation#8892 AS cfpk_supplier_nation_5#8905, cval_supplier_s_name#8893 AS cval_supplier_s_name_5#8906, cval_supplier_s_address#8894 AS cval_supplier_s_address_5#8907, cval_supplier_s_phone#8895 AS cval_supplier_s_phone_5#8908, cval_supplier_s_acctbal#8896 AS cval_supplier_s_acctbal_5#8909, cval_supplier_s_comment#8897 AS cval_supplier_s_comment_5#8910, cs_name#8898 AS cs_name_5#8911, cs_address#8899 AS cs_address_5#8912, cs_phone#8900 AS cs_phone_5#8913, cs_acctbal#8901 AS cs_acctbal_5#8914, cs_comment#8902 AS cs_comment_5#8915]
         :        +- Relation[rid#8890,cpfk_nation_supplier#8891,cfpk_supplier_nation#8892,cval_supplier_s_name#8893,cval_supplier_s_address#8894,cval_supplier_s_phone#8895,cval_supplier_s_acctbal#8896,cval_supplier_s_comment#8897,cs_name#8898,cs_address#8899,cs_phone#8900,cs_acctbal#8901,cs_comment#8902] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#8916 AS rid_1#8923, cpfk_region_nation#8917 AS cpfk_region_nation_1#8924, cfpk_nation_region#8918 AS cfpk_nation_region_1#8925, cval_nation_n_name#8919 AS cval_nation_n_name_1#8926, cval_nation_n_comment#8920 AS cval_nation_n_comment_1#8927, cn_name#8921 AS cn_name_1#8928, cn_comment#8922 AS cn_comment_1#8929]
            :  +- Relation[rid#8916,cpfk_region_nation#8917,cfpk_nation_region#8918,cval_nation_n_name#8919,cval_nation_n_comment#8920,cn_name#8921,cn_comment#8922] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#8930 AS rid_5#8943, cpfk_nation_supplier#8931 AS cpfk_nation_supplier_5#8944, cfpk_supplier_nation#8932 AS cfpk_supplier_nation_5#8945, cval_supplier_s_name#8933 AS cval_supplier_s_name_5#8946, cval_supplier_s_address#8934 AS cval_supplier_s_address_5#8947, cval_supplier_s_phone#8935 AS cval_supplier_s_phone_5#8948, cval_supplier_s_acctbal#8936 AS cval_supplier_s_acctbal_5#8949, cval_supplier_s_comment#8937 AS cval_supplier_s_comment_5#8950, cs_name#8938 AS cs_name_5#8951, cs_address#8939 AS cs_address_5#8952, cs_phone#8940 AS cs_phone_5#8953, cs_acctbal#8941 AS cs_acctbal_5#8954, cs_comment#8942 AS cs_comment_5#8955]
               +- Relation[rid#8930,cpfk_nation_supplier#8931,cfpk_supplier_nation#8932,cval_supplier_s_name#8933,cval_supplier_s_address#8934,cval_supplier_s_phone#8935,cval_supplier_s_acctbal#8936,cval_supplier_s_comment#8937,cs_name#8938,cs_address#8939,cs_phone#8940,cs_acctbal#8941,cs_comment#8942] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1206514
Elapsed time: 165554ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/11 08:33:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 08:33:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9055L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 08:33:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9055L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#9057 AS rid_0#9072, cpfk_nation_customer#9058 AS cpfk_nation_customer_0#9073, cfpk_customer_nation#9059 AS cfpk_customer_nation_0#9074, cval_customer_c_name#9060 AS cval_customer_c_name_0#9075, cval_customer_c_address#9061 AS cval_customer_c_address_0#9076, cval_customer_c_phone#9062 AS cval_customer_c_phone_0#9077, cval_customer_c_acctbal#9063 AS cval_customer_c_acctbal_0#9078, cval_customer_c_comment#9064 AS cval_customer_c_comment_0#9079, cval_customer_c_mktsegment#9065 AS cval_customer_c_mktsegment_0#9080, cc_name#9066 AS cc_name_0#9081, cc_address#9067 AS cc_address_0#9082, cc_phone#9068 AS cc_phone_0#9083, cc_acctbal#9069 AS cc_acctbal_0#9084, cc_comment#9070 AS cc_comment_0#9085, cc_mktsegment#9071 AS cc_mktsegment_0#9086]
         :  :  :  :  +- Relation[rid#9057,cpfk_nation_customer#9058,cfpk_customer_nation#9059,cval_customer_c_name#9060,cval_customer_c_address#9061,cval_customer_c_phone#9062,cval_customer_c_acctbal#9063,cval_customer_c_comment#9064,cval_customer_c_mktsegment#9065,cc_name#9066,cc_address#9067,cc_phone#9068,cc_acctbal#9069,cc_comment#9070,cc_mktsegment#9071] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#9121 AS rid_0#9136, cpfk_nation_customer#9122 AS cpfk_nation_customer_0#9137, cfpk_customer_nation#9123 AS cfpk_customer_nation_0#9138, cval_customer_c_name#9124 AS cval_customer_c_name_0#9139, cval_customer_c_address#9125 AS cval_customer_c_address_0#9140, cval_customer_c_phone#9126 AS cval_customer_c_phone_0#9141, cval_customer_c_acctbal#9127 AS cval_customer_c_acctbal_0#9142, cval_customer_c_comment#9128 AS cval_customer_c_comment_0#9143, cval_customer_c_mktsegment#9129 AS cval_customer_c_mktsegment_0#9144, cc_name#9130 AS cc_name_0#9145, cc_address#9131 AS cc_address_0#9146, cc_phone#9132 AS cc_phone_0#9147, cc_acctbal#9133 AS cc_acctbal_0#9148, cc_comment#9134 AS cc_comment_0#9149, cc_mktsegment#9135 AS cc_mktsegment_0#9150]
         :  :  :     :  +- Relation[rid#9121,cpfk_nation_customer#9122,cfpk_customer_nation#9123,cval_customer_c_name#9124,cval_customer_c_address#9125,cval_customer_c_phone#9126,cval_customer_c_acctbal#9127,cval_customer_c_comment#9128,cval_customer_c_mktsegment#9129,cc_name#9130,cc_address#9131,cc_phone#9132,cc_acctbal#9133,cc_comment#9134,cc_mktsegment#9135] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#9151 AS rid_1#9168, cpfk_customer_orders#9152 AS cpfk_customer_orders_1#9169, cfpk_orders_customer#9153 AS cfpk_orders_customer_1#9170, cval_orders_o_orderstatus#9154 AS cval_orders_o_orderstatus_1#9171, cval_orders_o_totalprice#9155 AS cval_orders_o_totalprice_1#9172, cval_orders_o_orderpriority#9156 AS cval_orders_o_orderpriority_1#9173, cval_orders_o_clerk#9157 AS cval_orders_o_clerk_1#9174, cval_orders_o_shippriority#9158 AS cval_orders_o_shippriority_1#9175, cval_orders_o_comment#9159 AS cval_orders_o_comment_1#9176, cval_orders_o_orderdate#9160 AS cval_orders_o_orderdate_1#9177, co_orderstatus#9161 AS co_orderstatus_1#9178, co_totalprice#9162 AS co_totalprice_1#9179, co_orderpriority#9163 AS co_orderpriority_1#9180, co_clerk#9164 AS co_clerk_1#9181, co_shippriority#9165 AS co_shippriority_1#9182, co_comment#9166 AS co_comment_1#9183, co_orderdate#9167 AS co_orderdate_1#9184]
         :  :  :        +- Relation[rid#9151,cpfk_customer_orders#9152,cfpk_orders_customer#9153,cval_orders_o_orderstatus#9154,cval_orders_o_totalprice#9155,cval_orders_o_orderpriority#9156,cval_orders_o_clerk#9157,cval_orders_o_shippriority#9158,cval_orders_o_comment#9159,cval_orders_o_orderdate#9160,co_orderstatus#9161,co_totalprice#9162,co_orderpriority#9163,co_clerk#9164,co_shippriority#9165,co_comment#9166,co_orderdate#9167] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#9087 AS rid_1#9104, cpfk_customer_orders#9088 AS cpfk_customer_orders_1#9105, cfpk_orders_customer#9089 AS cfpk_orders_customer_1#9106, cval_orders_o_orderstatus#9090 AS cval_orders_o_orderstatus_1#9107, cval_orders_o_totalprice#9091 AS cval_orders_o_totalprice_1#9108, cval_orders_o_orderpriority#9092 AS cval_orders_o_orderpriority_1#9109, cval_orders_o_clerk#9093 AS cval_orders_o_clerk_1#9110, cval_orders_o_shippriority#9094 AS cval_orders_o_shippriority_1#9111, cval_orders_o_comment#9095 AS cval_orders_o_comment_1#9112, cval_orders_o_orderdate#9096 AS cval_orders_o_orderdate_1#9113, co_orderstatus#9097 AS co_orderstatus_1#9114, co_totalprice#9098 AS co_totalprice_1#9115, co_orderpriority#9099 AS co_orderpriority_1#9116, co_clerk#9100 AS co_clerk_1#9117, co_shippriority#9101 AS co_shippriority_1#9118, co_comment#9102 AS co_comment_1#9119, co_orderdate#9103 AS co_orderdate_1#9120]
         :  :     +- Relation[rid#9087,cpfk_customer_orders#9088,cfpk_orders_customer#9089,cval_orders_o_orderstatus#9090,cval_orders_o_totalprice#9091,cval_orders_o_orderpriority#9092,cval_orders_o_clerk#9093,cval_orders_o_shippriority#9094,cval_orders_o_comment#9095,cval_orders_o_orderdate#9096,co_orderstatus#9097,co_totalprice#9098,co_orderpriority#9099,co_clerk#9100,co_shippriority#9101,co_comment#9102,co_orderdate#9103] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#9251 AS rid_1#9268, cpfk_customer_orders#9252 AS cpfk_customer_orders_1#9269, cfpk_orders_customer#9253 AS cfpk_orders_customer_1#9270, cval_orders_o_orderstatus#9254 AS cval_orders_o_orderstatus_1#9271, cval_orders_o_totalprice#9255 AS cval_orders_o_totalprice_1#9272, cval_orders_o_orderpriority#9256 AS cval_orders_o_orderpriority_1#9273, cval_orders_o_clerk#9257 AS cval_orders_o_clerk_1#9274, cval_orders_o_shippriority#9258 AS cval_orders_o_shippriority_1#9275, cval_orders_o_comment#9259 AS cval_orders_o_comment_1#9276, cval_orders_o_orderdate#9260 AS cval_orders_o_orderdate_1#9277, co_orderstatus#9261 AS co_orderstatus_1#9278, co_totalprice#9262 AS co_totalprice_1#9279, co_orderpriority#9263 AS co_orderpriority_1#9280, co_clerk#9264 AS co_clerk_1#9281, co_shippriority#9265 AS co_shippriority_1#9282, co_comment#9266 AS co_comment_1#9283, co_orderdate#9267 AS co_orderdate_1#9284]
         :     :  +- Relation[rid#9251,cpfk_customer_orders#9252,cfpk_orders_customer#9253,cval_orders_o_orderstatus#9254,cval_orders_o_totalprice#9255,cval_orders_o_orderpriority#9256,cval_orders_o_clerk#9257,cval_orders_o_shippriority#9258,cval_orders_o_comment#9259,cval_orders_o_orderdate#9260,co_orderstatus#9261,co_totalprice#9262,co_orderpriority#9263,co_clerk#9264,co_shippriority#9265,co_comment#9266,co_orderdate#9267] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#9285 AS rid_2#9318, cpfk_orders_lineitem#9286 AS cpfk_orders_lineitem_2#9319, cpfk_supplier_lineitem#9287 AS cpfk_supplier_lineitem_2#9320, cfpk_lineitem_supplier#9288 AS cfpk_lineitem_supplier_2#9321, cfpk_lineitem_partsupp#9289 AS cfpk_lineitem_partsupp_2#9322, cpfk_part_lineitem#9290 AS cpfk_part_lineitem_2#9323, cfpk_lineitem_part#9291 AS cfpk_lineitem_part_2#9324, cpfk_partsupp_lineitem#9292 AS cpfk_partsupp_lineitem_2#9325, cfpk_lineitem_orders#9293 AS cfpk_lineitem_orders_2#9326, cval_lineitem_l_quantity#9294 AS cval_lineitem_l_quantity_2#9327, cval_lineitem_l_extendedprice#9295 AS cval_lineitem_l_extendedprice_2#9328, cval_lineitem_l_discount#9296 AS cval_lineitem_l_discount_2#9329, cval_lineitem_l_tax#9297 AS cval_lineitem_l_tax_2#9330, cval_lineitem_l_returnflag#9298 AS cval_lineitem_l_returnflag_2#9331, cval_lineitem_l_linestatus#9299 AS cval_lineitem_l_linestatus_2#9332, cval_lineitem_l_commitdate#9300 AS cval_lineitem_l_commitdate_2#9333, cval_lineitem_l_receiptdate#9301 AS cval_lineitem_l_receiptdate_2#9334, cval_lineitem_l_shipinstruct#9302 AS cval_lineitem_l_shipinstruct_2#9335, cval_lineitem_l_shipmode#9303 AS cval_lineitem_l_shipmode_2#9336, cval_lineitem_l_comment#9304 AS cval_lineitem_l_comment_2#9337, cval_lineitem_l_shipdate#9305 AS cval_lineitem_l_shipdate_2#9338, cl_quantity#9306 AS cl_quantity_2#9339, cl_extendedprice#9307 AS cl_extendedprice_2#9340, cl_discount#9308 AS cl_discount_2#9341, ... 9 more fields]
         :        +- Relation[rid#9285,cpfk_orders_lineitem#9286,cpfk_supplier_lineitem#9287,cfpk_lineitem_supplier#9288,cfpk_lineitem_partsupp#9289,cpfk_part_lineitem#9290,cfpk_lineitem_part#9291,cpfk_partsupp_lineitem#9292,cfpk_lineitem_orders#9293,cval_lineitem_l_quantity#9294,cval_lineitem_l_extendedprice#9295,cval_lineitem_l_discount#9296,cval_lineitem_l_tax#9297,cval_lineitem_l_returnflag#9298,cval_lineitem_l_linestatus#9299,cval_lineitem_l_commitdate#9300,cval_lineitem_l_receiptdate#9301,cval_lineitem_l_shipinstruct#9302,cval_lineitem_l_shipmode#9303,cval_lineitem_l_comment#9304,cval_lineitem_l_shipdate#9305,cl_quantity#9306,cl_extendedprice#9307,cl_discount#9308,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#9185 AS rid_2#9218, cpfk_orders_lineitem#9186 AS cpfk_orders_lineitem_2#9219, cpfk_supplier_lineitem#9187 AS cpfk_supplier_lineitem_2#9220, cfpk_lineitem_supplier#9188 AS cfpk_lineitem_supplier_2#9221, cfpk_lineitem_partsupp#9189 AS cfpk_lineitem_partsupp_2#9222, cpfk_part_lineitem#9190 AS cpfk_part_lineitem_2#9223, cfpk_lineitem_part#9191 AS cfpk_lineitem_part_2#9224, cpfk_partsupp_lineitem#9192 AS cpfk_partsupp_lineitem_2#9225, cfpk_lineitem_orders#9193 AS cfpk_lineitem_orders_2#9226, cval_lineitem_l_quantity#9194 AS cval_lineitem_l_quantity_2#9227, cval_lineitem_l_extendedprice#9195 AS cval_lineitem_l_extendedprice_2#9228, cval_lineitem_l_discount#9196 AS cval_lineitem_l_discount_2#9229, cval_lineitem_l_tax#9197 AS cval_lineitem_l_tax_2#9230, cval_lineitem_l_returnflag#9198 AS cval_lineitem_l_returnflag_2#9231, cval_lineitem_l_linestatus#9199 AS cval_lineitem_l_linestatus_2#9232, cval_lineitem_l_commitdate#9200 AS cval_lineitem_l_commitdate_2#9233, cval_lineitem_l_receiptdate#9201 AS cval_lineitem_l_receiptdate_2#9234, cval_lineitem_l_shipinstruct#9202 AS cval_lineitem_l_shipinstruct_2#9235, cval_lineitem_l_shipmode#9203 AS cval_lineitem_l_shipmode_2#9236, cval_lineitem_l_comment#9204 AS cval_lineitem_l_comment_2#9237, cval_lineitem_l_shipdate#9205 AS cval_lineitem_l_shipdate_2#9238, cl_quantity#9206 AS cl_quantity_2#9239, cl_extendedprice#9207 AS cl_extendedprice_2#9240, cl_discount#9208 AS cl_discount_2#9241, ... 9 more fields]
            +- Relation[rid#9185,cpfk_orders_lineitem#9186,cpfk_supplier_lineitem#9187,cfpk_lineitem_supplier#9188,cfpk_lineitem_partsupp#9189,cpfk_part_lineitem#9190,cfpk_lineitem_part#9191,cpfk_partsupp_lineitem#9192,cfpk_lineitem_orders#9193,cval_lineitem_l_quantity#9194,cval_lineitem_l_extendedprice#9195,cval_lineitem_l_discount#9196,cval_lineitem_l_tax#9197,cval_lineitem_l_returnflag#9198,cval_lineitem_l_linestatus#9199,cval_lineitem_l_commitdate#9200,cval_lineitem_l_receiptdate#9201,cval_lineitem_l_shipinstruct#9202,cval_lineitem_l_shipmode#9203,cval_lineitem_l_comment#9204,cval_lineitem_l_shipdate#9205,cl_quantity#9206,cl_extendedprice#9207,cl_discount#9208,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 118068ms
query=q1, count=6001215, duration=2933
query=q10, count=1478870, duration=60444
query=q11, count=31680, duration=10301
query=q12, count=857401, duration=21258
query=q13, count=1500000, duration=13289
query=q14, count=6001215, duration=82464
query=q15, count=6001215, duration=77940
query=q16, count=15780, duration=11106
query=q17, count=6088, duration=71817
query=q18, count=6001215, duration=118068
query=q19, count=205, duration=363500
query=q2, count=3162, duration=20282
query=q20, count=632, duration=11409
query=q21a, count=597422, duration=247246
query=q22, count=1500000, duration=12741
query=q3, count=1214743, duration=115678
query=q4, count=6001215, duration=52601
query=q5, count=1206514, duration=165554
query=q6, count=6001215, duration=2973
query=q7, count=9735, duration=104517
query=q8, count=8716, duration=95602
query=q9a, count=6001215, duration=245012
query=q9b, count=6001215, duration=163875
