20/04/11 05:06:20 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 11450ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 11 05:06:24 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 11 05:06:25 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 11 05:06:25 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 11 05:06:25 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 11 05:06:25 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 11 05:06:30 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 11 05:06:33 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 11 05:06:33 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/11 05:06:35 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:06:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2078L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 05:06:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:06:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:06:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:06:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:06:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:06:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:06:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:06:36 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/11 05:06:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2078L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#2080 AS rid_0#2113, cpfk_orders_lineitem#2081 AS cpfk_orders_lineitem_0#2114, cpfk_supplier_lineitem#2082 AS cpfk_supplier_lineitem_0#2115, cfpk_lineitem_supplier#2083 AS cfpk_lineitem_supplier_0#2116, cfpk_lineitem_partsupp#2084 AS cfpk_lineitem_partsupp_0#2117, cpfk_part_lineitem#2085 AS cpfk_part_lineitem_0#2118, cfpk_lineitem_part#2086 AS cfpk_lineitem_part_0#2119, cpfk_partsupp_lineitem#2087 AS cpfk_partsupp_lineitem_0#2120, cfpk_lineitem_orders#2088 AS cfpk_lineitem_orders_0#2121, cval_lineitem_l_quantity#2089 AS cval_lineitem_l_quantity_0#2122, cval_lineitem_l_extendedprice#2090 AS cval_lineitem_l_extendedprice_0#2123, cval_lineitem_l_discount#2091 AS cval_lineitem_l_discount_0#2124, cval_lineitem_l_tax#2092 AS cval_lineitem_l_tax_0#2125, cval_lineitem_l_returnflag#2093 AS cval_lineitem_l_returnflag_0#2126, cval_lineitem_l_linestatus#2094 AS cval_lineitem_l_linestatus_0#2127, cval_lineitem_l_commitdate#2095 AS cval_lineitem_l_commitdate_0#2128, cval_lineitem_l_receiptdate#2096 AS cval_lineitem_l_receiptdate_0#2129, cval_lineitem_l_shipinstruct#2097 AS cval_lineitem_l_shipinstruct_0#2130, cval_lineitem_l_shipmode#2098 AS cval_lineitem_l_shipmode_0#2131, cval_lineitem_l_comment#2099 AS cval_lineitem_l_comment_0#2132, cval_lineitem_l_shipdate#2100 AS cval_lineitem_l_shipdate_0#2133, cl_quantity#2101 AS cl_quantity_0#2134, cl_extendedprice#2102 AS cl_extendedprice_0#2135, cl_discount#2103 AS cl_discount_0#2136, ... 9 more fields]
            :  +- Relation[rid#2080,cpfk_orders_lineitem#2081,cpfk_supplier_lineitem#2082,cfpk_lineitem_supplier#2083,cfpk_lineitem_partsupp#2084,cpfk_part_lineitem#2085,cfpk_lineitem_part#2086,cpfk_partsupp_lineitem#2087,cfpk_lineitem_orders#2088,cval_lineitem_l_quantity#2089,cval_lineitem_l_extendedprice#2090,cval_lineitem_l_discount#2091,cval_lineitem_l_tax#2092,cval_lineitem_l_returnflag#2093,cval_lineitem_l_linestatus#2094,cval_lineitem_l_commitdate#2095,cval_lineitem_l_receiptdate#2096,cval_lineitem_l_shipinstruct#2097,cval_lineitem_l_shipmode#2098,cval_lineitem_l_comment#2099,cval_lineitem_l_shipdate#2100,cl_quantity#2101,cl_extendedprice#2102,cl_discount#2103,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#2146 AS rid_1#2163, cpfk_customer_orders#2147 AS cpfk_customer_orders_1#2164, cfpk_orders_customer#2148 AS cfpk_orders_customer_1#2165, cval_orders_o_orderstatus#2149 AS cval_orders_o_orderstatus_1#2166, cval_orders_o_totalprice#2150 AS cval_orders_o_totalprice_1#2167, cval_orders_o_orderpriority#2151 AS cval_orders_o_orderpriority_1#2168, cval_orders_o_clerk#2152 AS cval_orders_o_clerk_1#2169, cval_orders_o_shippriority#2153 AS cval_orders_o_shippriority_1#2170, cval_orders_o_comment#2154 AS cval_orders_o_comment_1#2171, cval_orders_o_orderdate#2155 AS cval_orders_o_orderdate_1#2172, co_orderstatus#2156 AS co_orderstatus_1#2173, co_totalprice#2157 AS co_totalprice_1#2174, co_orderpriority#2158 AS co_orderpriority_1#2175, co_clerk#2159 AS co_clerk_1#2176, co_shippriority#2160 AS co_shippriority_1#2177, co_comment#2161 AS co_comment_1#2178, co_orderdate#2162 AS co_orderdate_1#2179]
                  :     :  :  :  :  +- Relation[rid#2146,cpfk_customer_orders#2147,cfpk_orders_customer#2148,cval_orders_o_orderstatus#2149,cval_orders_o_totalprice#2150,cval_orders_o_orderpriority#2151,cval_orders_o_clerk#2152,cval_orders_o_shippriority#2153,cval_orders_o_comment#2154,cval_orders_o_orderdate#2155,co_orderstatus#2156,co_totalprice#2157,co_orderpriority#2158,co_clerk#2159,co_shippriority#2160,co_comment#2161,co_orderdate#2162] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#2180 AS rid_1#2197, cpfk_customer_orders#2181 AS cpfk_customer_orders_1#2198, cfpk_orders_customer#2182 AS cfpk_orders_customer_1#2199, cval_orders_o_orderstatus#2183 AS cval_orders_o_orderstatus_1#2200, cval_orders_o_totalprice#2184 AS cval_orders_o_totalprice_1#2201, cval_orders_o_orderpriority#2185 AS cval_orders_o_orderpriority_1#2202, cval_orders_o_clerk#2186 AS cval_orders_o_clerk_1#2203, cval_orders_o_shippriority#2187 AS cval_orders_o_shippriority_1#2204, cval_orders_o_comment#2188 AS cval_orders_o_comment_1#2205, cval_orders_o_orderdate#2189 AS cval_orders_o_orderdate_1#2206, co_orderstatus#2190 AS co_orderstatus_1#2207, co_totalprice#2191 AS co_totalprice_1#2208, co_orderpriority#2192 AS co_orderpriority_1#2209, co_clerk#2193 AS co_clerk_1#2210, co_shippriority#2194 AS co_shippriority_1#2211, co_comment#2195 AS co_comment_1#2212, co_orderdate#2196 AS co_orderdate_1#2213]
                  :     :  :  :        +- Relation[rid#2180,cpfk_customer_orders#2181,cfpk_orders_customer#2182,cval_orders_o_orderstatus#2183,cval_orders_o_totalprice#2184,cval_orders_o_orderpriority#2185,cval_orders_o_clerk#2186,cval_orders_o_shippriority#2187,cval_orders_o_comment#2188,cval_orders_o_orderdate#2189,co_orderstatus#2190,co_totalprice#2191,co_orderpriority#2192,co_clerk#2193,co_shippriority#2194,co_comment#2195,co_orderdate#2196] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :     :- Project [rid#2280 AS rid_1#2297, cpfk_customer_orders#2281 AS cpfk_customer_orders_1#2298, cfpk_orders_customer#2282 AS cfpk_orders_customer_1#2299, cval_orders_o_orderstatus#2283 AS cval_orders_o_orderstatus_1#2300, cval_orders_o_totalprice#2284 AS cval_orders_o_totalprice_1#2301, cval_orders_o_orderpriority#2285 AS cval_orders_o_orderpriority_1#2302, cval_orders_o_clerk#2286 AS cval_orders_o_clerk_1#2303, cval_orders_o_shippriority#2287 AS cval_orders_o_shippriority_1#2304, cval_orders_o_comment#2288 AS cval_orders_o_comment_1#2305, cval_orders_o_orderdate#2289 AS cval_orders_o_orderdate_1#2306, co_orderstatus#2290 AS co_orderstatus_1#2307, co_totalprice#2291 AS co_totalprice_1#2308, co_orderpriority#2292 AS co_orderpriority_1#2309, co_clerk#2293 AS co_clerk_1#2310, co_shippriority#2294 AS co_shippriority_1#2311, co_comment#2295 AS co_comment_1#2312, co_orderdate#2296 AS co_orderdate_1#2313]
                  :     :  :     :  +- Relation[rid#2280,cpfk_customer_orders#2281,cfpk_orders_customer#2282,cval_orders_o_orderstatus#2283,cval_orders_o_totalprice#2284,cval_orders_o_orderpriority#2285,cval_orders_o_clerk#2286,cval_orders_o_shippriority#2287,cval_orders_o_comment#2288,cval_orders_o_orderdate#2289,co_orderstatus#2290,co_totalprice#2291,co_orderpriority#2292,co_clerk#2293,co_shippriority#2294,co_comment#2295,co_orderdate#2296] JDBCRelation(torders) [numPartitions=1]
                  :     :  :     +- Project [rid#2314 AS rid_2#2347, cpfk_orders_lineitem#2315 AS cpfk_orders_lineitem_2#2348, cpfk_supplier_lineitem#2316 AS cpfk_supplier_lineitem_2#2349, cfpk_lineitem_supplier#2317 AS cfpk_lineitem_supplier_2#2350, cfpk_lineitem_partsupp#2318 AS cfpk_lineitem_partsupp_2#2351, cpfk_part_lineitem#2319 AS cpfk_part_lineitem_2#2352, cfpk_lineitem_part#2320 AS cfpk_lineitem_part_2#2353, cpfk_partsupp_lineitem#2321 AS cpfk_partsupp_lineitem_2#2354, cfpk_lineitem_orders#2322 AS cfpk_lineitem_orders_2#2355, cval_lineitem_l_quantity#2323 AS cval_lineitem_l_quantity_2#2356, cval_lineitem_l_extendedprice#2324 AS cval_lineitem_l_extendedprice_2#2357, cval_lineitem_l_discount#2325 AS cval_lineitem_l_discount_2#2358, cval_lineitem_l_tax#2326 AS cval_lineitem_l_tax_2#2359, cval_lineitem_l_returnflag#2327 AS cval_lineitem_l_returnflag_2#2360, cval_lineitem_l_linestatus#2328 AS cval_lineitem_l_linestatus_2#2361, cval_lineitem_l_commitdate#2329 AS cval_lineitem_l_commitdate_2#2362, cval_lineitem_l_receiptdate#2330 AS cval_lineitem_l_receiptdate_2#2363, cval_lineitem_l_shipinstruct#2331 AS cval_lineitem_l_shipinstruct_2#2364, cval_lineitem_l_shipmode#2332 AS cval_lineitem_l_shipmode_2#2365, cval_lineitem_l_comment#2333 AS cval_lineitem_l_comment_2#2366, cval_lineitem_l_shipdate#2334 AS cval_lineitem_l_shipdate_2#2367, cl_quantity#2335 AS cl_quantity_2#2368, cl_extendedprice#2336 AS cl_extendedprice_2#2369, cl_discount#2337 AS cl_discount_2#2370, ... 9 more fields]
                  :     :  :        +- Relation[rid#2314,cpfk_orders_lineitem#2315,cpfk_supplier_lineitem#2316,cfpk_lineitem_supplier#2317,cfpk_lineitem_partsupp#2318,cpfk_part_lineitem#2319,cfpk_lineitem_part#2320,cpfk_partsupp_lineitem#2321,cfpk_lineitem_orders#2322,cval_lineitem_l_quantity#2323,cval_lineitem_l_extendedprice#2324,cval_lineitem_l_discount#2325,cval_lineitem_l_tax#2326,cval_lineitem_l_returnflag#2327,cval_lineitem_l_linestatus#2328,cval_lineitem_l_commitdate#2329,cval_lineitem_l_receiptdate#2330,cval_lineitem_l_shipinstruct#2331,cval_lineitem_l_shipmode#2332,cval_lineitem_l_comment#2333,cval_lineitem_l_shipdate#2334,cl_quantity#2335,cl_extendedprice#2336,cl_discount#2337,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#2214 AS rid_2#2247, cpfk_orders_lineitem#2215 AS cpfk_orders_lineitem_2#2248, cpfk_supplier_lineitem#2216 AS cpfk_supplier_lineitem_2#2249, cfpk_lineitem_supplier#2217 AS cfpk_lineitem_supplier_2#2250, cfpk_lineitem_partsupp#2218 AS cfpk_lineitem_partsupp_2#2251, cpfk_part_lineitem#2219 AS cpfk_part_lineitem_2#2252, cfpk_lineitem_part#2220 AS cfpk_lineitem_part_2#2253, cpfk_partsupp_lineitem#2221 AS cpfk_partsupp_lineitem_2#2254, cfpk_lineitem_orders#2222 AS cfpk_lineitem_orders_2#2255, cval_lineitem_l_quantity#2223 AS cval_lineitem_l_quantity_2#2256, cval_lineitem_l_extendedprice#2224 AS cval_lineitem_l_extendedprice_2#2257, cval_lineitem_l_discount#2225 AS cval_lineitem_l_discount_2#2258, cval_lineitem_l_tax#2226 AS cval_lineitem_l_tax_2#2259, cval_lineitem_l_returnflag#2227 AS cval_lineitem_l_returnflag_2#2260, cval_lineitem_l_linestatus#2228 AS cval_lineitem_l_linestatus_2#2261, cval_lineitem_l_commitdate#2229 AS cval_lineitem_l_commitdate_2#2262, cval_lineitem_l_receiptdate#2230 AS cval_lineitem_l_receiptdate_2#2263, cval_lineitem_l_shipinstruct#2231 AS cval_lineitem_l_shipinstruct_2#2264, cval_lineitem_l_shipmode#2232 AS cval_lineitem_l_shipmode_2#2265, cval_lineitem_l_comment#2233 AS cval_lineitem_l_comment_2#2266, cval_lineitem_l_shipdate#2234 AS cval_lineitem_l_shipdate_2#2267, cl_quantity#2235 AS cl_quantity_2#2268, cl_extendedprice#2236 AS cl_extendedprice_2#2269, cl_discount#2237 AS cl_discount_2#2270, ... 9 more fields]
                  :     :     +- Relation[rid#2214,cpfk_orders_lineitem#2215,cpfk_supplier_lineitem#2216,cfpk_lineitem_supplier#2217,cfpk_lineitem_partsupp#2218,cpfk_part_lineitem#2219,cfpk_lineitem_part#2220,cpfk_partsupp_lineitem#2221,cfpk_lineitem_orders#2222,cval_lineitem_l_quantity#2223,cval_lineitem_l_extendedprice#2224,cval_lineitem_l_discount#2225,cval_lineitem_l_tax#2226,cval_lineitem_l_returnflag#2227,cval_lineitem_l_linestatus#2228,cval_lineitem_l_commitdate#2229,cval_lineitem_l_receiptdate#2230,cval_lineitem_l_shipinstruct#2231,cval_lineitem_l_shipmode#2232,cval_lineitem_l_comment#2233,cval_lineitem_l_shipdate#2234,cl_quantity#2235,cl_extendedprice#2236,cl_discount#2237,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#2380 AS rid_3#2393, cpfk_nation_supplier#2381 AS cpfk_nation_supplier_3#2394, cfpk_supplier_nation#2382 AS cfpk_supplier_nation_3#2395, cval_supplier_s_name#2383 AS cval_supplier_s_name_3#2396, cval_supplier_s_address#2384 AS cval_supplier_s_address_3#2397, cval_supplier_s_phone#2385 AS cval_supplier_s_phone_3#2398, cval_supplier_s_acctbal#2386 AS cval_supplier_s_acctbal_3#2399, cval_supplier_s_comment#2387 AS cval_supplier_s_comment_3#2400, cs_name#2388 AS cs_name_3#2401, cs_address#2389 AS cs_address_3#2402, cs_phone#2390 AS cs_phone_3#2403, cs_acctbal#2391 AS cs_acctbal_3#2404, cs_comment#2392 AS cs_comment_3#2405]
                  :        +- Relation[rid#2380,cpfk_nation_supplier#2381,cfpk_supplier_nation#2382,cval_supplier_s_name#2383,cval_supplier_s_address#2384,cval_supplier_s_phone#2385,cval_supplier_s_acctbal#2386,cval_supplier_s_comment#2387,cs_name#2388,cs_address#2389,cs_phone#2390,cs_acctbal#2391,cs_comment#2392] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#2406 AS rid_4#2413, cpfk_region_nation#2407 AS cpfk_region_nation_4#2414, cfpk_nation_region#2408 AS cfpk_nation_region_4#2415, cval_nation_n_name#2409 AS cval_nation_n_name_4#2416, cval_nation_n_comment#2410 AS cval_nation_n_comment_4#2417, cn_name#2411 AS cn_name_4#2418, cn_comment#2412 AS cn_comment_4#2419]
                     :  +- Relation[rid#2406,cpfk_region_nation#2407,cfpk_nation_region#2408,cval_nation_n_name#2409,cval_nation_n_comment#2410,cn_name#2411,cn_comment#2412] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#2420 AS rid_4#2427, cpfk_region_nation#2421 AS cpfk_region_nation_4#2428, cfpk_nation_region#2422 AS cfpk_nation_region_4#2429, cval_nation_n_name#2423 AS cval_nation_n_name_4#2430, cval_nation_n_comment#2424 AS cval_nation_n_comment_4#2431, cn_name#2425 AS cn_name_4#2432, cn_comment#2426 AS cn_comment_4#2433]
                           +- Relation[rid#2420,cpfk_region_nation#2421,cfpk_nation_region#2422,cval_nation_n_name#2423,cval_nation_n_comment#2424,cn_name#2425,cn_comment#2426] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 246327ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/11 05:10:41 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:10:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2545L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 05:10:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:10:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:10:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:10:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:10:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:10:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:10:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:10:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:10:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:10:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:10:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:10:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:10:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:10:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:10:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:10:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2545L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#2547 AS rid_0#2554, cpfk_region_nation#2548 AS cpfk_region_nation_0#2555, cfpk_nation_region#2549 AS cfpk_nation_region_0#2556, cval_nation_n_name#2550 AS cval_nation_n_name_0#2557, cval_nation_n_comment#2551 AS cval_nation_n_comment_0#2558, cn_name#2552 AS cn_name_0#2559, cn_comment#2553 AS cn_comment_0#2560]
            :  :  :  :  :  :  +- Relation[rid#2547,cpfk_region_nation#2548,cfpk_nation_region#2549,cval_nation_n_name#2550,cval_nation_n_comment#2551,cn_name#2552,cn_comment#2553] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#2561 AS rid_0#2568, cpfk_region_nation#2562 AS cpfk_region_nation_0#2569, cfpk_nation_region#2563 AS cfpk_nation_region_0#2570, cval_nation_n_name#2564 AS cval_nation_n_name_0#2571, cval_nation_n_comment#2565 AS cval_nation_n_comment_0#2572, cn_name#2566 AS cn_name_0#2573, cn_comment#2567 AS cn_comment_0#2574]
            :  :  :  :  :        +- Relation[rid#2561,cpfk_region_nation#2562,cfpk_nation_region#2563,cval_nation_n_name#2564,cval_nation_n_comment#2565,cn_name#2566,cn_comment#2567] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :     :- Project [rid#2601 AS rid_0#2608, cpfk_region_nation#2602 AS cpfk_region_nation_0#2609, cfpk_nation_region#2603 AS cfpk_nation_region_0#2610, cval_nation_n_name#2604 AS cval_nation_n_name_0#2611, cval_nation_n_comment#2605 AS cval_nation_n_comment_0#2612, cn_name#2606 AS cn_name_0#2613, cn_comment#2607 AS cn_comment_0#2614]
            :  :  :  :     :  +- Relation[rid#2601,cpfk_region_nation#2602,cfpk_nation_region#2603,cval_nation_n_name#2604,cval_nation_n_comment#2605,cn_name#2606,cn_comment#2607] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :     +- Project [rid#2615 AS rid_1#2628, cpfk_nation_supplier#2616 AS cpfk_nation_supplier_1#2629, cfpk_supplier_nation#2617 AS cfpk_supplier_nation_1#2630, cval_supplier_s_name#2618 AS cval_supplier_s_name_1#2631, cval_supplier_s_address#2619 AS cval_supplier_s_address_1#2632, cval_supplier_s_phone#2620 AS cval_supplier_s_phone_1#2633, cval_supplier_s_acctbal#2621 AS cval_supplier_s_acctbal_1#2634, cval_supplier_s_comment#2622 AS cval_supplier_s_comment_1#2635, cs_name#2623 AS cs_name_1#2636, cs_address#2624 AS cs_address_1#2637, cs_phone#2625 AS cs_phone_1#2638, cs_acctbal#2626 AS cs_acctbal_1#2639, cs_comment#2627 AS cs_comment_1#2640]
            :  :  :  :        +- Relation[rid#2615,cpfk_nation_supplier#2616,cfpk_supplier_nation#2617,cval_supplier_s_name#2618,cval_supplier_s_address#2619,cval_supplier_s_phone#2620,cval_supplier_s_acctbal#2621,cval_supplier_s_comment#2622,cs_name#2623,cs_address#2624,cs_phone#2625,cs_acctbal#2626,cs_comment#2627] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#2575 AS rid_1#2588, cpfk_nation_supplier#2576 AS cpfk_nation_supplier_1#2589, cfpk_supplier_nation#2577 AS cfpk_supplier_nation_1#2590, cval_supplier_s_name#2578 AS cval_supplier_s_name_1#2591, cval_supplier_s_address#2579 AS cval_supplier_s_address_1#2592, cval_supplier_s_phone#2580 AS cval_supplier_s_phone_1#2593, cval_supplier_s_acctbal#2581 AS cval_supplier_s_acctbal_1#2594, cval_supplier_s_comment#2582 AS cval_supplier_s_comment_1#2595, cs_name#2583 AS cs_name_1#2596, cs_address#2584 AS cs_address_1#2597, cs_phone#2585 AS cs_phone_1#2598, cs_acctbal#2586 AS cs_acctbal_1#2599, cs_comment#2587 AS cs_comment_1#2600]
            :  :  :     +- Relation[rid#2575,cpfk_nation_supplier#2576,cfpk_supplier_nation#2577,cval_supplier_s_name#2578,cval_supplier_s_address#2579,cval_supplier_s_phone#2580,cval_supplier_s_acctbal#2581,cval_supplier_s_comment#2582,cs_name#2583,cs_address#2584,cs_phone#2585,cs_acctbal#2586,cs_comment#2587] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :     :- Project [rid#2707 AS rid_1#2720, cpfk_nation_supplier#2708 AS cpfk_nation_supplier_1#2721, cfpk_supplier_nation#2709 AS cfpk_supplier_nation_1#2722, cval_supplier_s_name#2710 AS cval_supplier_s_name_1#2723, cval_supplier_s_address#2711 AS cval_supplier_s_address_1#2724, cval_supplier_s_phone#2712 AS cval_supplier_s_phone_1#2725, cval_supplier_s_acctbal#2713 AS cval_supplier_s_acctbal_1#2726, cval_supplier_s_comment#2714 AS cval_supplier_s_comment_1#2727, cs_name#2715 AS cs_name_1#2728, cs_address#2716 AS cs_address_1#2729, cs_phone#2717 AS cs_phone_1#2730, cs_acctbal#2718 AS cs_acctbal_1#2731, cs_comment#2719 AS cs_comment_1#2732]
            :  :     :  +- Relation[rid#2707,cpfk_nation_supplier#2708,cfpk_supplier_nation#2709,cval_supplier_s_name#2710,cval_supplier_s_address#2711,cval_supplier_s_phone#2712,cval_supplier_s_acctbal#2713,cval_supplier_s_comment#2714,cs_name#2715,cs_address#2716,cs_phone#2717,cs_acctbal#2718,cs_comment#2719] JDBCRelation(tsupplier) [numPartitions=1]
            :  :     +- Project [rid#2733 AS rid_2#2766, cpfk_orders_lineitem#2734 AS cpfk_orders_lineitem_2#2767, cpfk_supplier_lineitem#2735 AS cpfk_supplier_lineitem_2#2768, cfpk_lineitem_supplier#2736 AS cfpk_lineitem_supplier_2#2769, cfpk_lineitem_partsupp#2737 AS cfpk_lineitem_partsupp_2#2770, cpfk_part_lineitem#2738 AS cpfk_part_lineitem_2#2771, cfpk_lineitem_part#2739 AS cfpk_lineitem_part_2#2772, cpfk_partsupp_lineitem#2740 AS cpfk_partsupp_lineitem_2#2773, cfpk_lineitem_orders#2741 AS cfpk_lineitem_orders_2#2774, cval_lineitem_l_quantity#2742 AS cval_lineitem_l_quantity_2#2775, cval_lineitem_l_extendedprice#2743 AS cval_lineitem_l_extendedprice_2#2776, cval_lineitem_l_discount#2744 AS cval_lineitem_l_discount_2#2777, cval_lineitem_l_tax#2745 AS cval_lineitem_l_tax_2#2778, cval_lineitem_l_returnflag#2746 AS cval_lineitem_l_returnflag_2#2779, cval_lineitem_l_linestatus#2747 AS cval_lineitem_l_linestatus_2#2780, cval_lineitem_l_commitdate#2748 AS cval_lineitem_l_commitdate_2#2781, cval_lineitem_l_receiptdate#2749 AS cval_lineitem_l_receiptdate_2#2782, cval_lineitem_l_shipinstruct#2750 AS cval_lineitem_l_shipinstruct_2#2783, cval_lineitem_l_shipmode#2751 AS cval_lineitem_l_shipmode_2#2784, cval_lineitem_l_comment#2752 AS cval_lineitem_l_comment_2#2785, cval_lineitem_l_shipdate#2753 AS cval_lineitem_l_shipdate_2#2786, cl_quantity#2754 AS cl_quantity_2#2787, cl_extendedprice#2755 AS cl_extendedprice_2#2788, cl_discount#2756 AS cl_discount_2#2789, ... 9 more fields]
            :  :        +- Relation[rid#2733,cpfk_orders_lineitem#2734,cpfk_supplier_lineitem#2735,cfpk_lineitem_supplier#2736,cfpk_lineitem_partsupp#2737,cpfk_part_lineitem#2738,cfpk_lineitem_part#2739,cpfk_partsupp_lineitem#2740,cfpk_lineitem_orders#2741,cval_lineitem_l_quantity#2742,cval_lineitem_l_extendedprice#2743,cval_lineitem_l_discount#2744,cval_lineitem_l_tax#2745,cval_lineitem_l_returnflag#2746,cval_lineitem_l_linestatus#2747,cval_lineitem_l_commitdate#2748,cval_lineitem_l_receiptdate#2749,cval_lineitem_l_shipinstruct#2750,cval_lineitem_l_shipmode#2751,cval_lineitem_l_comment#2752,cval_lineitem_l_shipdate#2753,cl_quantity#2754,cl_extendedprice#2755,cl_discount#2756,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#2641 AS rid_2#2674, cpfk_orders_lineitem#2642 AS cpfk_orders_lineitem_2#2675, cpfk_supplier_lineitem#2643 AS cpfk_supplier_lineitem_2#2676, cfpk_lineitem_supplier#2644 AS cfpk_lineitem_supplier_2#2677, cfpk_lineitem_partsupp#2645 AS cfpk_lineitem_partsupp_2#2678, cpfk_part_lineitem#2646 AS cpfk_part_lineitem_2#2679, cfpk_lineitem_part#2647 AS cfpk_lineitem_part_2#2680, cpfk_partsupp_lineitem#2648 AS cpfk_partsupp_lineitem_2#2681, cfpk_lineitem_orders#2649 AS cfpk_lineitem_orders_2#2682, cval_lineitem_l_quantity#2650 AS cval_lineitem_l_quantity_2#2683, cval_lineitem_l_extendedprice#2651 AS cval_lineitem_l_extendedprice_2#2684, cval_lineitem_l_discount#2652 AS cval_lineitem_l_discount_2#2685, cval_lineitem_l_tax#2653 AS cval_lineitem_l_tax_2#2686, cval_lineitem_l_returnflag#2654 AS cval_lineitem_l_returnflag_2#2687, cval_lineitem_l_linestatus#2655 AS cval_lineitem_l_linestatus_2#2688, cval_lineitem_l_commitdate#2656 AS cval_lineitem_l_commitdate_2#2689, cval_lineitem_l_receiptdate#2657 AS cval_lineitem_l_receiptdate_2#2690, cval_lineitem_l_shipinstruct#2658 AS cval_lineitem_l_shipinstruct_2#2691, cval_lineitem_l_shipmode#2659 AS cval_lineitem_l_shipmode_2#2692, cval_lineitem_l_comment#2660 AS cval_lineitem_l_comment_2#2693, cval_lineitem_l_shipdate#2661 AS cval_lineitem_l_shipdate_2#2694, cl_quantity#2662 AS cl_quantity_2#2695, cl_extendedprice#2663 AS cl_extendedprice_2#2696, cl_discount#2664 AS cl_discount_2#2697, ... 9 more fields]
            :     +- Relation[rid#2641,cpfk_orders_lineitem#2642,cpfk_supplier_lineitem#2643,cfpk_lineitem_supplier#2644,cfpk_lineitem_partsupp#2645,cpfk_part_lineitem#2646,cfpk_lineitem_part#2647,cpfk_partsupp_lineitem#2648,cfpk_lineitem_orders#2649,cval_lineitem_l_quantity#2650,cval_lineitem_l_extendedprice#2651,cval_lineitem_l_discount#2652,cval_lineitem_l_tax#2653,cval_lineitem_l_returnflag#2654,cval_lineitem_l_linestatus#2655,cval_lineitem_l_commitdate#2656,cval_lineitem_l_receiptdate#2657,cval_lineitem_l_shipinstruct#2658,cval_lineitem_l_shipmode#2659,cval_lineitem_l_comment#2660,cval_lineitem_l_shipdate#2661,cl_quantity#2662,cl_extendedprice#2663,cl_discount#2664,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'Join UsingJoin(Inner,List(rid_4))
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'Join UsingJoin(Inner,List(rid_3))
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#2799 AS rid_3#2806, cpfk_region_nation#2800 AS cpfk_region_nation_3#2807, cfpk_nation_region#2801 AS cfpk_nation_region_3#2808, cval_nation_n_name#2802 AS cval_nation_n_name_3#2809, cval_nation_n_comment#2803 AS cval_nation_n_comment_3#2810, cn_name#2804 AS cn_name_3#2811, cn_comment#2805 AS cn_comment_3#2812]
               :  :  :  :  :  +- Relation[rid#2799,cpfk_region_nation#2800,cfpk_nation_region#2801,cval_nation_n_name#2802,cval_nation_n_comment#2803,cn_name#2804,cn_comment#2805] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#2813 AS rid_3#2820, cpfk_region_nation#2814 AS cpfk_region_nation_3#2821, cfpk_nation_region#2815 AS cfpk_nation_region_3#2822, cval_nation_n_name#2816 AS cval_nation_n_name_3#2823, cval_nation_n_comment#2817 AS cval_nation_n_comment_3#2824, cn_name#2818 AS cn_name_3#2825, cn_comment#2819 AS cn_comment_3#2826]
               :  :  :  :        +- Relation[rid#2813,cpfk_region_nation#2814,cfpk_nation_region#2815,cval_nation_n_name#2816,cval_nation_n_comment#2817,cn_name#2818,cn_comment#2819] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :     :- Project [rid#2857 AS rid_3#2864, cpfk_region_nation#2858 AS cpfk_region_nation_3#2865, cfpk_nation_region#2859 AS cfpk_nation_region_3#2866, cval_nation_n_name#2860 AS cval_nation_n_name_3#2867, cval_nation_n_comment#2861 AS cval_nation_n_comment_3#2868, cn_name#2862 AS cn_name_3#2869, cn_comment#2863 AS cn_comment_3#2870]
               :  :  :     :  +- Relation[rid#2857,cpfk_region_nation#2858,cfpk_nation_region#2859,cval_nation_n_name#2860,cval_nation_n_comment#2861,cn_name#2862,cn_comment#2863] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#2871 AS rid_4#2886, cpfk_nation_customer#2872 AS cpfk_nation_customer_4#2887, cfpk_customer_nation#2873 AS cfpk_customer_nation_4#2888, cval_customer_c_name#2874 AS cval_customer_c_name_4#2889, cval_customer_c_address#2875 AS cval_customer_c_address_4#2890, cval_customer_c_phone#2876 AS cval_customer_c_phone_4#2891, cval_customer_c_acctbal#2877 AS cval_customer_c_acctbal_4#2892, cval_customer_c_comment#2878 AS cval_customer_c_comment_4#2893, cval_customer_c_mktsegment#2879 AS cval_customer_c_mktsegment_4#2894, cc_name#2880 AS cc_name_4#2895, cc_address#2881 AS cc_address_4#2896, cc_phone#2882 AS cc_phone_4#2897, cc_acctbal#2883 AS cc_acctbal_4#2898, cc_comment#2884 AS cc_comment_4#2899, cc_mktsegment#2885 AS cc_mktsegment_4#2900]
               :  :  :        +- Relation[rid#2871,cpfk_nation_customer#2872,cfpk_customer_nation#2873,cval_customer_c_name#2874,cval_customer_c_address#2875,cval_customer_c_phone#2876,cval_customer_c_acctbal#2877,cval_customer_c_comment#2878,cval_customer_c_mktsegment#2879,cc_name#2880,cc_address#2881,cc_phone#2882,cc_acctbal#2883,cc_comment#2884,cc_mktsegment#2885] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#2827 AS rid_4#2842, cpfk_nation_customer#2828 AS cpfk_nation_customer_4#2843, cfpk_customer_nation#2829 AS cfpk_customer_nation_4#2844, cval_customer_c_name#2830 AS cval_customer_c_name_4#2845, cval_customer_c_address#2831 AS cval_customer_c_address_4#2846, cval_customer_c_phone#2832 AS cval_customer_c_phone_4#2847, cval_customer_c_acctbal#2833 AS cval_customer_c_acctbal_4#2848, cval_customer_c_comment#2834 AS cval_customer_c_comment_4#2849, cval_customer_c_mktsegment#2835 AS cval_customer_c_mktsegment_4#2850, cc_name#2836 AS cc_name_4#2851, cc_address#2837 AS cc_address_4#2852, cc_phone#2838 AS cc_phone_4#2853, cc_acctbal#2839 AS cc_acctbal_4#2854, cc_comment#2840 AS cc_comment_4#2855, cc_mktsegment#2841 AS cc_mktsegment_4#2856]
               :  :     +- Relation[rid#2827,cpfk_nation_customer#2828,cfpk_customer_nation#2829,cval_customer_c_name#2830,cval_customer_c_address#2831,cval_customer_c_phone#2832,cval_customer_c_acctbal#2833,cval_customer_c_comment#2834,cval_customer_c_mktsegment#2835,cc_name#2836,cc_address#2837,cc_phone#2838,cc_acctbal#2839,cc_comment#2840,cc_mktsegment#2841] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :     :- Project [rid#2935 AS rid_4#2950, cpfk_nation_customer#2936 AS cpfk_nation_customer_4#2951, cfpk_customer_nation#2937 AS cfpk_customer_nation_4#2952, cval_customer_c_name#2938 AS cval_customer_c_name_4#2953, cval_customer_c_address#2939 AS cval_customer_c_address_4#2954, cval_customer_c_phone#2940 AS cval_customer_c_phone_4#2955, cval_customer_c_acctbal#2941 AS cval_customer_c_acctbal_4#2956, cval_customer_c_comment#2942 AS cval_customer_c_comment_4#2957, cval_customer_c_mktsegment#2943 AS cval_customer_c_mktsegment_4#2958, cc_name#2944 AS cc_name_4#2959, cc_address#2945 AS cc_address_4#2960, cc_phone#2946 AS cc_phone_4#2961, cc_acctbal#2947 AS cc_acctbal_4#2962, cc_comment#2948 AS cc_comment_4#2963, cc_mktsegment#2949 AS cc_mktsegment_4#2964]
               :     :  +- Relation[rid#2935,cpfk_nation_customer#2936,cfpk_customer_nation#2937,cval_customer_c_name#2938,cval_customer_c_address#2939,cval_customer_c_phone#2940,cval_customer_c_acctbal#2941,cval_customer_c_comment#2942,cval_customer_c_mktsegment#2943,cc_name#2944,cc_address#2945,cc_phone#2946,cc_acctbal#2947,cc_comment#2948,cc_mktsegment#2949] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#2965 AS rid_5#2982, cpfk_customer_orders#2966 AS cpfk_customer_orders_5#2983, cfpk_orders_customer#2967 AS cfpk_orders_customer_5#2984, cval_orders_o_orderstatus#2968 AS cval_orders_o_orderstatus_5#2985, cval_orders_o_totalprice#2969 AS cval_orders_o_totalprice_5#2986, cval_orders_o_orderpriority#2970 AS cval_orders_o_orderpriority_5#2987, cval_orders_o_clerk#2971 AS cval_orders_o_clerk_5#2988, cval_orders_o_shippriority#2972 AS cval_orders_o_shippriority_5#2989, cval_orders_o_comment#2973 AS cval_orders_o_comment_5#2990, cval_orders_o_orderdate#2974 AS cval_orders_o_orderdate_5#2991, co_orderstatus#2975 AS co_orderstatus_5#2992, co_totalprice#2976 AS co_totalprice_5#2993, co_orderpriority#2977 AS co_orderpriority_5#2994, co_clerk#2978 AS co_clerk_5#2995, co_shippriority#2979 AS co_shippriority_5#2996, co_comment#2980 AS co_comment_5#2997, co_orderdate#2981 AS co_orderdate_5#2998]
               :        +- Relation[rid#2965,cpfk_customer_orders#2966,cfpk_orders_customer#2967,cval_orders_o_orderstatus#2968,cval_orders_o_totalprice#2969,cval_orders_o_orderpriority#2970,cval_orders_o_clerk#2971,cval_orders_o_shippriority#2972,cval_orders_o_comment#2973,cval_orders_o_orderdate#2974,co_orderstatus#2975,co_totalprice#2976,co_orderpriority#2977,co_clerk#2978,co_shippriority#2979,co_comment#2980,co_orderdate#2981] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#2901 AS rid_5#2918, cpfk_customer_orders#2902 AS cpfk_customer_orders_5#2919, cfpk_orders_customer#2903 AS cfpk_orders_customer_5#2920, cval_orders_o_orderstatus#2904 AS cval_orders_o_orderstatus_5#2921, cval_orders_o_totalprice#2905 AS cval_orders_o_totalprice_5#2922, cval_orders_o_orderpriority#2906 AS cval_orders_o_orderpriority_5#2923, cval_orders_o_clerk#2907 AS cval_orders_o_clerk_5#2924, cval_orders_o_shippriority#2908 AS cval_orders_o_shippriority_5#2925, cval_orders_o_comment#2909 AS cval_orders_o_comment_5#2926, cval_orders_o_orderdate#2910 AS cval_orders_o_orderdate_5#2927, co_orderstatus#2911 AS co_orderstatus_5#2928, co_totalprice#2912 AS co_totalprice_5#2929, co_orderpriority#2913 AS co_orderpriority_5#2930, co_clerk#2914 AS co_clerk_5#2931, co_shippriority#2915 AS co_shippriority_5#2932, co_comment#2916 AS co_comment_5#2933, co_orderdate#2917 AS co_orderdate_5#2934]
                  +- Relation[rid#2901,cpfk_customer_orders#2902,cfpk_orders_customer#2903,cval_orders_o_orderstatus#2904,cval_orders_o_totalprice#2905,cval_orders_o_orderpriority#2906,cval_orders_o_clerk#2907,cval_orders_o_shippriority#2908,cval_orders_o_comment#2909,cval_orders_o_orderdate#2910,co_orderstatus#2911,co_totalprice#2912,co_orderpriority#2913,co_clerk#2914,co_shippriority#2915,co_comment#2916,co_orderdate#2917] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 101779ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/11 05:12:23 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:12:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3095L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:12:23 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:12:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3095L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#3097 AS rid_0#3102, cval_region_r_name#3098 AS cval_region_r_name_0#3103, cval_region_r_comment#3099 AS cval_region_r_comment_0#3104, cr_name#3100 AS cr_name_0#3105, cr_comment#3101 AS cr_comment_0#3106]
         :  :  :  :  :  :  :  +- Relation[rid#3097,cval_region_r_name#3098,cval_region_r_comment#3099,cr_name#3100,cr_comment#3101] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#3107 AS rid_0#3112, cval_region_r_name#3108 AS cval_region_r_name_0#3113, cval_region_r_comment#3109 AS cval_region_r_comment_0#3114, cr_name#3110 AS cr_name_0#3115, cr_comment#3111 AS cr_comment_0#3116]
         :  :  :  :  :  :        +- Relation[rid#3107,cval_region_r_name#3108,cval_region_r_comment#3109,cr_name#3110,cr_comment#3111] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :     :- Project [rid#3131 AS rid_0#3136, cval_region_r_name#3132 AS cval_region_r_name_0#3137, cval_region_r_comment#3133 AS cval_region_r_comment_0#3138, cr_name#3134 AS cr_name_0#3139, cr_comment#3135 AS cr_comment_0#3140]
         :  :  :  :  :     :  +- Relation[rid#3131,cval_region_r_name#3132,cval_region_r_comment#3133,cr_name#3134,cr_comment#3135] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :     +- Project [rid#3141 AS rid_1#3148, cpfk_region_nation#3142 AS cpfk_region_nation_1#3149, cfpk_nation_region#3143 AS cfpk_nation_region_1#3150, cval_nation_n_name#3144 AS cval_nation_n_name_1#3151, cval_nation_n_comment#3145 AS cval_nation_n_comment_1#3152, cn_name#3146 AS cn_name_1#3153, cn_comment#3147 AS cn_comment_1#3154]
         :  :  :  :  :        +- Relation[rid#3141,cpfk_region_nation#3142,cfpk_nation_region#3143,cval_nation_n_name#3144,cval_nation_n_comment#3145,cn_name#3146,cn_comment#3147] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#3117 AS rid_1#3124, cpfk_region_nation#3118 AS cpfk_region_nation_1#3125, cfpk_nation_region#3119 AS cfpk_nation_region_1#3126, cval_nation_n_name#3120 AS cval_nation_n_name_1#3127, cval_nation_n_comment#3121 AS cval_nation_n_comment_1#3128, cn_name#3122 AS cn_name_1#3129, cn_comment#3123 AS cn_comment_1#3130]
         :  :  :  :     +- Relation[rid#3117,cpfk_region_nation#3118,cfpk_nation_region#3119,cval_nation_n_name#3120,cval_nation_n_comment#3121,cn_name#3122,cn_comment#3123] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :     :- Project [rid#3181 AS rid_1#3188, cpfk_region_nation#3182 AS cpfk_region_nation_1#3189, cfpk_nation_region#3183 AS cfpk_nation_region_1#3190, cval_nation_n_name#3184 AS cval_nation_n_name_1#3191, cval_nation_n_comment#3185 AS cval_nation_n_comment_1#3192, cn_name#3186 AS cn_name_1#3193, cn_comment#3187 AS cn_comment_1#3194]
         :  :  :     :  +- Relation[rid#3181,cpfk_region_nation#3182,cfpk_nation_region#3183,cval_nation_n_name#3184,cval_nation_n_comment#3185,cn_name#3186,cn_comment#3187] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#3195 AS rid_2#3208, cpfk_nation_supplier#3196 AS cpfk_nation_supplier_2#3209, cfpk_supplier_nation#3197 AS cfpk_supplier_nation_2#3210, cval_supplier_s_name#3198 AS cval_supplier_s_name_2#3211, cval_supplier_s_address#3199 AS cval_supplier_s_address_2#3212, cval_supplier_s_phone#3200 AS cval_supplier_s_phone_2#3213, cval_supplier_s_acctbal#3201 AS cval_supplier_s_acctbal_2#3214, cval_supplier_s_comment#3202 AS cval_supplier_s_comment_2#3215, cs_name#3203 AS cs_name_2#3216, cs_address#3204 AS cs_address_2#3217, cs_phone#3205 AS cs_phone_2#3218, cs_acctbal#3206 AS cs_acctbal_2#3219, cs_comment#3207 AS cs_comment_2#3220]
         :  :  :        +- Relation[rid#3195,cpfk_nation_supplier#3196,cfpk_supplier_nation#3197,cval_supplier_s_name#3198,cval_supplier_s_address#3199,cval_supplier_s_phone#3200,cval_supplier_s_acctbal#3201,cval_supplier_s_comment#3202,cs_name#3203,cs_address#3204,cs_phone#3205,cs_acctbal#3206,cs_comment#3207] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#3155 AS rid_2#3168, cpfk_nation_supplier#3156 AS cpfk_nation_supplier_2#3169, cfpk_supplier_nation#3157 AS cfpk_supplier_nation_2#3170, cval_supplier_s_name#3158 AS cval_supplier_s_name_2#3171, cval_supplier_s_address#3159 AS cval_supplier_s_address_2#3172, cval_supplier_s_phone#3160 AS cval_supplier_s_phone_2#3173, cval_supplier_s_acctbal#3161 AS cval_supplier_s_acctbal_2#3174, cval_supplier_s_comment#3162 AS cval_supplier_s_comment_2#3175, cs_name#3163 AS cs_name_2#3176, cs_address#3164 AS cs_address_2#3177, cs_phone#3165 AS cs_phone_2#3178, cs_acctbal#3166 AS cs_acctbal_2#3179, cs_comment#3167 AS cs_comment_2#3180]
         :  :     +- Relation[rid#3155,cpfk_nation_supplier#3156,cfpk_supplier_nation#3157,cval_supplier_s_name#3158,cval_supplier_s_address#3159,cval_supplier_s_phone#3160,cval_supplier_s_acctbal#3161,cval_supplier_s_comment#3162,cs_name#3163,cs_address#3164,cs_phone#3165,cs_acctbal#3166,cs_comment#3167] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :     :- Project [rid#3367 AS rid_2#3380, cpfk_nation_supplier#3368 AS cpfk_nation_supplier_2#3381, cfpk_supplier_nation#3369 AS cfpk_supplier_nation_2#3382, cval_supplier_s_name#3370 AS cval_supplier_s_name_2#3383, cval_supplier_s_address#3371 AS cval_supplier_s_address_2#3384, cval_supplier_s_phone#3372 AS cval_supplier_s_phone_2#3385, cval_supplier_s_acctbal#3373 AS cval_supplier_s_acctbal_2#3386, cval_supplier_s_comment#3374 AS cval_supplier_s_comment_2#3387, cs_name#3375 AS cs_name_2#3388, cs_address#3376 AS cs_address_2#3389, cs_phone#3377 AS cs_phone_2#3390, cs_acctbal#3378 AS cs_acctbal_2#3391, cs_comment#3379 AS cs_comment_2#3392]
         :     :  +- Relation[rid#3367,cpfk_nation_supplier#3368,cfpk_supplier_nation#3369,cval_supplier_s_name#3370,cval_supplier_s_address#3371,cval_supplier_s_phone#3372,cval_supplier_s_acctbal#3373,cval_supplier_s_comment#3374,cs_name#3375,cs_address#3376,cs_phone#3377,cs_acctbal#3378,cs_comment#3379] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#3393 AS rid_4#3404, cpfk_part_partsupp#3394 AS cpfk_part_partsupp_4#3405, cfpk_partsupp_part#3395 AS cfpk_partsupp_part_4#3406, cpfk_supplier_partsupp#3396 AS cpfk_supplier_partsupp_4#3407, cfpk_partsupp_supplier#3397 AS cfpk_partsupp_supplier_4#3408, cval_partsupp_ps_availqty#3398 AS cval_partsupp_ps_availqty_4#3409, cval_partsupp_ps_supplycost#3399 AS cval_partsupp_ps_supplycost_4#3410, cval_partsupp_ps_comment#3400 AS cval_partsupp_ps_comment_4#3411, cps_availqty#3401 AS cps_availqty_4#3412, cps_supplycost#3402 AS cps_supplycost_4#3413, cps_comment#3403 AS cps_comment_4#3414]
         :        +- Relation[rid#3393,cpfk_part_partsupp#3394,cfpk_partsupp_part#3395,cpfk_supplier_partsupp#3396,cfpk_partsupp_supplier#3397,cval_partsupp_ps_availqty#3398,cval_partsupp_ps_supplycost#3399,cval_partsupp_ps_comment#3400,cps_availqty#3401,cps_supplycost#3402,cps_comment#3403] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'Join UsingJoin(Inner,List(rid_3))
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#3221 AS rid_3#3238, cval_part_p_name#3222 AS cval_part_p_name_3#3239, cval_part_p_mfgr#3223 AS cval_part_p_mfgr_3#3240, cval_part_p_type#3224 AS cval_part_p_type_3#3241, cval_part_p_size#3225 AS cval_part_p_size_3#3242, cval_part_p_container#3226 AS cval_part_p_container_3#3243, cval_part_p_retailprice#3227 AS cval_part_p_retailprice_3#3244, cval_part_p_comment#3228 AS cval_part_p_comment_3#3245, cval_part_p_brand#3229 AS cval_part_p_brand_3#3246, cp_name#3230 AS cp_name_3#3247, cp_mfgr#3231 AS cp_mfgr_3#3248, cp_type#3232 AS cp_type_3#3249, cp_size#3233 AS cp_size_3#3250, cp_container#3234 AS cp_container_3#3251, cp_retailprice#3235 AS cp_retailprice_3#3252, cp_comment#3236 AS cp_comment_3#3253, cp_brand#3237 AS cp_brand_3#3254]
            :  :  :  +- Relation[rid#3221,cval_part_p_name#3222,cval_part_p_mfgr#3223,cval_part_p_type#3224,cval_part_p_size#3225,cval_part_p_container#3226,cval_part_p_retailprice#3227,cval_part_p_comment#3228,cval_part_p_brand#3229,cp_name#3230,cp_mfgr#3231,cp_type#3232,cp_size#3233,cp_container#3234,cp_retailprice#3235,cp_comment#3236,cp_brand#3237] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#3255 AS rid_3#3272, cval_part_p_name#3256 AS cval_part_p_name_3#3273, cval_part_p_mfgr#3257 AS cval_part_p_mfgr_3#3274, cval_part_p_type#3258 AS cval_part_p_type_3#3275, cval_part_p_size#3259 AS cval_part_p_size_3#3276, cval_part_p_container#3260 AS cval_part_p_container_3#3277, cval_part_p_retailprice#3261 AS cval_part_p_retailprice_3#3278, cval_part_p_comment#3262 AS cval_part_p_comment_3#3279, cval_part_p_brand#3263 AS cval_part_p_brand_3#3280, cp_name#3264 AS cp_name_3#3281, cp_mfgr#3265 AS cp_mfgr_3#3282, cp_type#3266 AS cp_type_3#3283, cp_size#3267 AS cp_size_3#3284, cp_container#3268 AS cp_container_3#3285, cp_retailprice#3269 AS cp_retailprice_3#3286, cp_comment#3270 AS cp_comment_3#3287, cp_brand#3271 AS cp_brand_3#3288]
            :  :        +- Relation[rid#3255,cval_part_p_name#3256,cval_part_p_mfgr#3257,cval_part_p_type#3258,cval_part_p_size#3259,cval_part_p_container#3260,cval_part_p_retailprice#3261,cval_part_p_comment#3262,cval_part_p_brand#3263,cp_name#3264,cp_mfgr#3265,cp_type#3266,cp_size#3267,cp_container#3268,cp_retailprice#3269,cp_comment#3270,cp_brand#3271] JDBCRelation(tpart) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :     :- Project [rid#3311 AS rid_3#3328, cval_part_p_name#3312 AS cval_part_p_name_3#3329, cval_part_p_mfgr#3313 AS cval_part_p_mfgr_3#3330, cval_part_p_type#3314 AS cval_part_p_type_3#3331, cval_part_p_size#3315 AS cval_part_p_size_3#3332, cval_part_p_container#3316 AS cval_part_p_container_3#3333, cval_part_p_retailprice#3317 AS cval_part_p_retailprice_3#3334, cval_part_p_comment#3318 AS cval_part_p_comment_3#3335, cval_part_p_brand#3319 AS cval_part_p_brand_3#3336, cp_name#3320 AS cp_name_3#3337, cp_mfgr#3321 AS cp_mfgr_3#3338, cp_type#3322 AS cp_type_3#3339, cp_size#3323 AS cp_size_3#3340, cp_container#3324 AS cp_container_3#3341, cp_retailprice#3325 AS cp_retailprice_3#3342, cp_comment#3326 AS cp_comment_3#3343, cp_brand#3327 AS cp_brand_3#3344]
            :     :  +- Relation[rid#3311,cval_part_p_name#3312,cval_part_p_mfgr#3313,cval_part_p_type#3314,cval_part_p_size#3315,cval_part_p_container#3316,cval_part_p_retailprice#3317,cval_part_p_comment#3318,cval_part_p_brand#3319,cp_name#3320,cp_mfgr#3321,cp_type#3322,cp_size#3323,cp_container#3324,cp_retailprice#3325,cp_comment#3326,cp_brand#3327] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#3345 AS rid_4#3356, cpfk_part_partsupp#3346 AS cpfk_part_partsupp_4#3357, cfpk_partsupp_part#3347 AS cfpk_partsupp_part_4#3358, cpfk_supplier_partsupp#3348 AS cpfk_supplier_partsupp_4#3359, cfpk_partsupp_supplier#3349 AS cfpk_partsupp_supplier_4#3360, cval_partsupp_ps_availqty#3350 AS cval_partsupp_ps_availqty_4#3361, cval_partsupp_ps_supplycost#3351 AS cval_partsupp_ps_supplycost_4#3362, cval_partsupp_ps_comment#3352 AS cval_partsupp_ps_comment_4#3363, cps_availqty#3353 AS cps_availqty_4#3364, cps_supplycost#3354 AS cps_supplycost_4#3365, cps_comment#3355 AS cps_comment_4#3366]
            :        +- Relation[rid#3345,cpfk_part_partsupp#3346,cfpk_partsupp_part#3347,cpfk_supplier_partsupp#3348,cfpk_partsupp_supplier#3349,cval_partsupp_ps_availqty#3350,cval_partsupp_ps_supplycost#3351,cval_partsupp_ps_comment#3352,cps_availqty#3353,cps_supplycost#3354,cps_comment#3355] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#3289 AS rid_4#3300, cpfk_part_partsupp#3290 AS cpfk_part_partsupp_4#3301, cfpk_partsupp_part#3291 AS cfpk_partsupp_part_4#3302, cpfk_supplier_partsupp#3292 AS cpfk_supplier_partsupp_4#3303, cfpk_partsupp_supplier#3293 AS cfpk_partsupp_supplier_4#3304, cval_partsupp_ps_availqty#3294 AS cval_partsupp_ps_availqty_4#3305, cval_partsupp_ps_supplycost#3295 AS cval_partsupp_ps_supplycost_4#3306, cval_partsupp_ps_comment#3296 AS cval_partsupp_ps_comment_4#3307, cps_availqty#3297 AS cps_availqty_4#3308, cps_supplycost#3298 AS cps_supplycost_4#3309, cps_comment#3299 AS cps_comment_4#3310]
               +- Relation[rid#3289,cpfk_part_partsupp#3290,cfpk_partsupp_part#3291,cpfk_supplier_partsupp#3292,cfpk_partsupp_supplier#3293,cval_partsupp_ps_availqty#3294,cval_partsupp_ps_supplycost#3295,cval_partsupp_ps_comment#3296,cps_availqty#3297,cps_supplycost#3298,cps_comment#3299] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 20543ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/11 05:12:44 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:12:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3473L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 05:12:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:12:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:12:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:12:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:12:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:12:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:12:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:12:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:12:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:12:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:12:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:12:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:12:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:12:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3473L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#3475 AS rid_0#3492, cval_part_p_name#3476 AS cval_part_p_name_0#3493, cval_part_p_mfgr#3477 AS cval_part_p_mfgr_0#3494, cval_part_p_type#3478 AS cval_part_p_type_0#3495, cval_part_p_size#3479 AS cval_part_p_size_0#3496, cval_part_p_container#3480 AS cval_part_p_container_0#3497, cval_part_p_retailprice#3481 AS cval_part_p_retailprice_0#3498, cval_part_p_comment#3482 AS cval_part_p_comment_0#3499, cval_part_p_brand#3483 AS cval_part_p_brand_0#3500, cp_name#3484 AS cp_name_0#3501, cp_mfgr#3485 AS cp_mfgr_0#3502, cp_type#3486 AS cp_type_0#3503, cp_size#3487 AS cp_size_0#3504, cp_container#3488 AS cp_container_0#3505, cp_retailprice#3489 AS cp_retailprice_0#3506, cp_comment#3490 AS cp_comment_0#3507, cp_brand#3491 AS cp_brand_0#3508]
            :  :  :  :  +- Relation[rid#3475,cval_part_p_name#3476,cval_part_p_mfgr#3477,cval_part_p_type#3478,cval_part_p_size#3479,cval_part_p_container#3480,cval_part_p_retailprice#3481,cval_part_p_comment#3482,cval_part_p_brand#3483,cp_name#3484,cp_mfgr#3485,cp_type#3486,cp_size#3487,cp_container#3488,cp_retailprice#3489,cp_comment#3490,cp_brand#3491] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#3509 AS rid_0#3526, cval_part_p_name#3510 AS cval_part_p_name_0#3527, cval_part_p_mfgr#3511 AS cval_part_p_mfgr_0#3528, cval_part_p_type#3512 AS cval_part_p_type_0#3529, cval_part_p_size#3513 AS cval_part_p_size_0#3530, cval_part_p_container#3514 AS cval_part_p_container_0#3531, cval_part_p_retailprice#3515 AS cval_part_p_retailprice_0#3532, cval_part_p_comment#3516 AS cval_part_p_comment_0#3533, cval_part_p_brand#3517 AS cval_part_p_brand_0#3534, cp_name#3518 AS cp_name_0#3535, cp_mfgr#3519 AS cp_mfgr_0#3536, cp_type#3520 AS cp_type_0#3537, cp_size#3521 AS cp_size_0#3538, cp_container#3522 AS cp_container_0#3539, cp_retailprice#3523 AS cp_retailprice_0#3540, cp_comment#3524 AS cp_comment_0#3541, cp_brand#3525 AS cp_brand_0#3542]
            :  :  :        +- Relation[rid#3509,cval_part_p_name#3510,cval_part_p_mfgr#3511,cval_part_p_type#3512,cval_part_p_size#3513,cval_part_p_container#3514,cval_part_p_retailprice#3515,cval_part_p_comment#3516,cval_part_p_brand#3517,cp_name#3518,cp_mfgr#3519,cp_type#3520,cp_size#3521,cp_container#3522,cp_retailprice#3523,cp_comment#3524,cp_brand#3525] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :     :- Project [rid#3565 AS rid_0#3582, cval_part_p_name#3566 AS cval_part_p_name_0#3583, cval_part_p_mfgr#3567 AS cval_part_p_mfgr_0#3584, cval_part_p_type#3568 AS cval_part_p_type_0#3585, cval_part_p_size#3569 AS cval_part_p_size_0#3586, cval_part_p_container#3570 AS cval_part_p_container_0#3587, cval_part_p_retailprice#3571 AS cval_part_p_retailprice_0#3588, cval_part_p_comment#3572 AS cval_part_p_comment_0#3589, cval_part_p_brand#3573 AS cval_part_p_brand_0#3590, cp_name#3574 AS cp_name_0#3591, cp_mfgr#3575 AS cp_mfgr_0#3592, cp_type#3576 AS cp_type_0#3593, cp_size#3577 AS cp_size_0#3594, cp_container#3578 AS cp_container_0#3595, cp_retailprice#3579 AS cp_retailprice_0#3596, cp_comment#3580 AS cp_comment_0#3597, cp_brand#3581 AS cp_brand_0#3598]
            :  :     :  +- Relation[rid#3565,cval_part_p_name#3566,cval_part_p_mfgr#3567,cval_part_p_type#3568,cval_part_p_size#3569,cval_part_p_container#3570,cval_part_p_retailprice#3571,cval_part_p_comment#3572,cval_part_p_brand#3573,cp_name#3574,cp_mfgr#3575,cp_type#3576,cp_size#3577,cp_container#3578,cp_retailprice#3579,cp_comment#3580,cp_brand#3581] JDBCRelation(tpart) [numPartitions=1]
            :  :     +- Project [rid#3599 AS rid_1#3610, cpfk_part_partsupp#3600 AS cpfk_part_partsupp_1#3611, cfpk_partsupp_part#3601 AS cfpk_partsupp_part_1#3612, cpfk_supplier_partsupp#3602 AS cpfk_supplier_partsupp_1#3613, cfpk_partsupp_supplier#3603 AS cfpk_partsupp_supplier_1#3614, cval_partsupp_ps_availqty#3604 AS cval_partsupp_ps_availqty_1#3615, cval_partsupp_ps_supplycost#3605 AS cval_partsupp_ps_supplycost_1#3616, cval_partsupp_ps_comment#3606 AS cval_partsupp_ps_comment_1#3617, cps_availqty#3607 AS cps_availqty_1#3618, cps_supplycost#3608 AS cps_supplycost_1#3619, cps_comment#3609 AS cps_comment_1#3620]
            :  :        +- Relation[rid#3599,cpfk_part_partsupp#3600,cfpk_partsupp_part#3601,cpfk_supplier_partsupp#3602,cfpk_partsupp_supplier#3603,cval_partsupp_ps_availqty#3604,cval_partsupp_ps_supplycost#3605,cval_partsupp_ps_comment#3606,cps_availqty#3607,cps_supplycost#3608,cps_comment#3609] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#3543 AS rid_1#3554, cpfk_part_partsupp#3544 AS cpfk_part_partsupp_1#3555, cfpk_partsupp_part#3545 AS cfpk_partsupp_part_1#3556, cpfk_supplier_partsupp#3546 AS cpfk_supplier_partsupp_1#3557, cfpk_partsupp_supplier#3547 AS cfpk_partsupp_supplier_1#3558, cval_partsupp_ps_availqty#3548 AS cval_partsupp_ps_availqty_1#3559, cval_partsupp_ps_supplycost#3549 AS cval_partsupp_ps_supplycost_1#3560, cval_partsupp_ps_comment#3550 AS cval_partsupp_ps_comment_1#3561, cps_availqty#3551 AS cps_availqty_1#3562, cps_supplycost#3552 AS cps_supplycost_1#3563, cps_comment#3553 AS cps_comment_1#3564]
            :     +- Relation[rid#3543,cpfk_part_partsupp#3544,cfpk_partsupp_part#3545,cpfk_supplier_partsupp#3546,cfpk_partsupp_supplier#3547,cval_partsupp_ps_availqty#3548,cval_partsupp_ps_supplycost#3549,cval_partsupp_ps_comment#3550,cps_availqty#3551,cps_supplycost#3552,cps_comment#3553] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#3621 AS rid_2#3628, cpfk_region_nation#3622 AS cpfk_region_nation_2#3629, cfpk_nation_region#3623 AS cfpk_nation_region_2#3630, cval_nation_n_name#3624 AS cval_nation_n_name_2#3631, cval_nation_n_comment#3625 AS cval_nation_n_comment_2#3632, cn_name#3626 AS cn_name_2#3633, cn_comment#3627 AS cn_comment_2#3634]
               :  :  :  +- Relation[rid#3621,cpfk_region_nation#3622,cfpk_nation_region#3623,cval_nation_n_name#3624,cval_nation_n_comment#3625,cn_name#3626,cn_comment#3627] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#3635 AS rid_2#3642, cpfk_region_nation#3636 AS cpfk_region_nation_2#3643, cfpk_nation_region#3637 AS cfpk_nation_region_2#3644, cval_nation_n_name#3638 AS cval_nation_n_name_2#3645, cval_nation_n_comment#3639 AS cval_nation_n_comment_2#3646, cn_name#3640 AS cn_name_2#3647, cn_comment#3641 AS cn_comment_2#3648]
               :  :        +- Relation[rid#3635,cpfk_region_nation#3636,cfpk_nation_region#3637,cval_nation_n_name#3638,cval_nation_n_comment#3639,cn_name#3640,cn_comment#3641] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :     :- Project [rid#3675 AS rid_2#3682, cpfk_region_nation#3676 AS cpfk_region_nation_2#3683, cfpk_nation_region#3677 AS cfpk_nation_region_2#3684, cval_nation_n_name#3678 AS cval_nation_n_name_2#3685, cval_nation_n_comment#3679 AS cval_nation_n_comment_2#3686, cn_name#3680 AS cn_name_2#3687, cn_comment#3681 AS cn_comment_2#3688]
               :     :  +- Relation[rid#3675,cpfk_region_nation#3676,cfpk_nation_region#3677,cval_nation_n_name#3678,cval_nation_n_comment#3679,cn_name#3680,cn_comment#3681] JDBCRelation(tnation) [numPartitions=1]
               :     +- Project [rid#3689 AS rid_3#3702, cpfk_nation_supplier#3690 AS cpfk_nation_supplier_3#3703, cfpk_supplier_nation#3691 AS cfpk_supplier_nation_3#3704, cval_supplier_s_name#3692 AS cval_supplier_s_name_3#3705, cval_supplier_s_address#3693 AS cval_supplier_s_address_3#3706, cval_supplier_s_phone#3694 AS cval_supplier_s_phone_3#3707, cval_supplier_s_acctbal#3695 AS cval_supplier_s_acctbal_3#3708, cval_supplier_s_comment#3696 AS cval_supplier_s_comment_3#3709, cs_name#3697 AS cs_name_3#3710, cs_address#3698 AS cs_address_3#3711, cs_phone#3699 AS cs_phone_3#3712, cs_acctbal#3700 AS cs_acctbal_3#3713, cs_comment#3701 AS cs_comment_3#3714]
               :        +- Relation[rid#3689,cpfk_nation_supplier#3690,cfpk_supplier_nation#3691,cval_supplier_s_name#3692,cval_supplier_s_address#3693,cval_supplier_s_phone#3694,cval_supplier_s_acctbal#3695,cval_supplier_s_comment#3696,cs_name#3697,cs_address#3698,cs_phone#3699,cs_acctbal#3700,cs_comment#3701] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#3649 AS rid_3#3662, cpfk_nation_supplier#3650 AS cpfk_nation_supplier_3#3663, cfpk_supplier_nation#3651 AS cfpk_supplier_nation_3#3664, cval_supplier_s_name#3652 AS cval_supplier_s_name_3#3665, cval_supplier_s_address#3653 AS cval_supplier_s_address_3#3666, cval_supplier_s_phone#3654 AS cval_supplier_s_phone_3#3667, cval_supplier_s_acctbal#3655 AS cval_supplier_s_acctbal_3#3668, cval_supplier_s_comment#3656 AS cval_supplier_s_comment_3#3669, cs_name#3657 AS cs_name_3#3670, cs_address#3658 AS cs_address_3#3671, cs_phone#3659 AS cs_phone_3#3672, cs_acctbal#3660 AS cs_acctbal_3#3673, cs_comment#3661 AS cs_comment_3#3674]
                  +- Relation[rid#3649,cpfk_nation_supplier#3650,cfpk_supplier_nation#3651,cval_supplier_s_name#3652,cval_supplier_s_address#3653,cval_supplier_s_phone#3654,cval_supplier_s_acctbal#3655,cval_supplier_s_comment#3656,cs_name#3657,cs_address#3658,cs_phone#3659,cs_acctbal#3660,cs_comment#3661] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 11037ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/11 05:12:55 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:12:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3772L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 05:12:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3772L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#3774 AS rid_0#3789, cpfk_nation_customer#3775 AS cpfk_nation_customer_0#3790, cfpk_customer_nation#3776 AS cfpk_customer_nation_0#3791, cval_customer_c_name#3777 AS cval_customer_c_name_0#3792, cval_customer_c_address#3778 AS cval_customer_c_address_0#3793, cval_customer_c_phone#3779 AS cval_customer_c_phone_0#3794, cval_customer_c_acctbal#3780 AS cval_customer_c_acctbal_0#3795, cval_customer_c_comment#3781 AS cval_customer_c_comment_0#3796, cval_customer_c_mktsegment#3782 AS cval_customer_c_mktsegment_0#3797, cc_name#3783 AS cc_name_0#3798, cc_address#3784 AS cc_address_0#3799, cc_phone#3785 AS cc_phone_0#3800, cc_acctbal#3786 AS cc_acctbal_0#3801, cc_comment#3787 AS cc_comment_0#3802, cc_mktsegment#3788 AS cc_mktsegment_0#3803]
         :  :  :  :  +- Relation[rid#3774,cpfk_nation_customer#3775,cfpk_customer_nation#3776,cval_customer_c_name#3777,cval_customer_c_address#3778,cval_customer_c_phone#3779,cval_customer_c_acctbal#3780,cval_customer_c_comment#3781,cval_customer_c_mktsegment#3782,cc_name#3783,cc_address#3784,cc_phone#3785,cc_acctbal#3786,cc_comment#3787,cc_mktsegment#3788] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#3838 AS rid_0#3853, cpfk_nation_customer#3839 AS cpfk_nation_customer_0#3854, cfpk_customer_nation#3840 AS cfpk_customer_nation_0#3855, cval_customer_c_name#3841 AS cval_customer_c_name_0#3856, cval_customer_c_address#3842 AS cval_customer_c_address_0#3857, cval_customer_c_phone#3843 AS cval_customer_c_phone_0#3858, cval_customer_c_acctbal#3844 AS cval_customer_c_acctbal_0#3859, cval_customer_c_comment#3845 AS cval_customer_c_comment_0#3860, cval_customer_c_mktsegment#3846 AS cval_customer_c_mktsegment_0#3861, cc_name#3847 AS cc_name_0#3862, cc_address#3848 AS cc_address_0#3863, cc_phone#3849 AS cc_phone_0#3864, cc_acctbal#3850 AS cc_acctbal_0#3865, cc_comment#3851 AS cc_comment_0#3866, cc_mktsegment#3852 AS cc_mktsegment_0#3867]
         :  :  :     :  +- Relation[rid#3838,cpfk_nation_customer#3839,cfpk_customer_nation#3840,cval_customer_c_name#3841,cval_customer_c_address#3842,cval_customer_c_phone#3843,cval_customer_c_acctbal#3844,cval_customer_c_comment#3845,cval_customer_c_mktsegment#3846,cc_name#3847,cc_address#3848,cc_phone#3849,cc_acctbal#3850,cc_comment#3851,cc_mktsegment#3852] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#3868 AS rid_1#3885, cpfk_customer_orders#3869 AS cpfk_customer_orders_1#3886, cfpk_orders_customer#3870 AS cfpk_orders_customer_1#3887, cval_orders_o_orderstatus#3871 AS cval_orders_o_orderstatus_1#3888, cval_orders_o_totalprice#3872 AS cval_orders_o_totalprice_1#3889, cval_orders_o_orderpriority#3873 AS cval_orders_o_orderpriority_1#3890, cval_orders_o_clerk#3874 AS cval_orders_o_clerk_1#3891, cval_orders_o_shippriority#3875 AS cval_orders_o_shippriority_1#3892, cval_orders_o_comment#3876 AS cval_orders_o_comment_1#3893, cval_orders_o_orderdate#3877 AS cval_orders_o_orderdate_1#3894, co_orderstatus#3878 AS co_orderstatus_1#3895, co_totalprice#3879 AS co_totalprice_1#3896, co_orderpriority#3880 AS co_orderpriority_1#3897, co_clerk#3881 AS co_clerk_1#3898, co_shippriority#3882 AS co_shippriority_1#3899, co_comment#3883 AS co_comment_1#3900, co_orderdate#3884 AS co_orderdate_1#3901]
         :  :  :        +- Relation[rid#3868,cpfk_customer_orders#3869,cfpk_orders_customer#3870,cval_orders_o_orderstatus#3871,cval_orders_o_totalprice#3872,cval_orders_o_orderpriority#3873,cval_orders_o_clerk#3874,cval_orders_o_shippriority#3875,cval_orders_o_comment#3876,cval_orders_o_orderdate#3877,co_orderstatus#3878,co_totalprice#3879,co_orderpriority#3880,co_clerk#3881,co_shippriority#3882,co_comment#3883,co_orderdate#3884] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#3804 AS rid_1#3821, cpfk_customer_orders#3805 AS cpfk_customer_orders_1#3822, cfpk_orders_customer#3806 AS cfpk_orders_customer_1#3823, cval_orders_o_orderstatus#3807 AS cval_orders_o_orderstatus_1#3824, cval_orders_o_totalprice#3808 AS cval_orders_o_totalprice_1#3825, cval_orders_o_orderpriority#3809 AS cval_orders_o_orderpriority_1#3826, cval_orders_o_clerk#3810 AS cval_orders_o_clerk_1#3827, cval_orders_o_shippriority#3811 AS cval_orders_o_shippriority_1#3828, cval_orders_o_comment#3812 AS cval_orders_o_comment_1#3829, cval_orders_o_orderdate#3813 AS cval_orders_o_orderdate_1#3830, co_orderstatus#3814 AS co_orderstatus_1#3831, co_totalprice#3815 AS co_totalprice_1#3832, co_orderpriority#3816 AS co_orderpriority_1#3833, co_clerk#3817 AS co_clerk_1#3834, co_shippriority#3818 AS co_shippriority_1#3835, co_comment#3819 AS co_comment_1#3836, co_orderdate#3820 AS co_orderdate_1#3837]
         :  :     +- Relation[rid#3804,cpfk_customer_orders#3805,cfpk_orders_customer#3806,cval_orders_o_orderstatus#3807,cval_orders_o_totalprice#3808,cval_orders_o_orderpriority#3809,cval_orders_o_clerk#3810,cval_orders_o_shippriority#3811,cval_orders_o_comment#3812,cval_orders_o_orderdate#3813,co_orderstatus#3814,co_totalprice#3815,co_orderpriority#3816,co_clerk#3817,co_shippriority#3818,co_comment#3819,co_orderdate#3820] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#3968 AS rid_1#3985, cpfk_customer_orders#3969 AS cpfk_customer_orders_1#3986, cfpk_orders_customer#3970 AS cfpk_orders_customer_1#3987, cval_orders_o_orderstatus#3971 AS cval_orders_o_orderstatus_1#3988, cval_orders_o_totalprice#3972 AS cval_orders_o_totalprice_1#3989, cval_orders_o_orderpriority#3973 AS cval_orders_o_orderpriority_1#3990, cval_orders_o_clerk#3974 AS cval_orders_o_clerk_1#3991, cval_orders_o_shippriority#3975 AS cval_orders_o_shippriority_1#3992, cval_orders_o_comment#3976 AS cval_orders_o_comment_1#3993, cval_orders_o_orderdate#3977 AS cval_orders_o_orderdate_1#3994, co_orderstatus#3978 AS co_orderstatus_1#3995, co_totalprice#3979 AS co_totalprice_1#3996, co_orderpriority#3980 AS co_orderpriority_1#3997, co_clerk#3981 AS co_clerk_1#3998, co_shippriority#3982 AS co_shippriority_1#3999, co_comment#3983 AS co_comment_1#4000, co_orderdate#3984 AS co_orderdate_1#4001]
         :     :  +- Relation[rid#3968,cpfk_customer_orders#3969,cfpk_orders_customer#3970,cval_orders_o_orderstatus#3971,cval_orders_o_totalprice#3972,cval_orders_o_orderpriority#3973,cval_orders_o_clerk#3974,cval_orders_o_shippriority#3975,cval_orders_o_comment#3976,cval_orders_o_orderdate#3977,co_orderstatus#3978,co_totalprice#3979,co_orderpriority#3980,co_clerk#3981,co_shippriority#3982,co_comment#3983,co_orderdate#3984] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#4002 AS rid_2#4035, cpfk_orders_lineitem#4003 AS cpfk_orders_lineitem_2#4036, cpfk_supplier_lineitem#4004 AS cpfk_supplier_lineitem_2#4037, cfpk_lineitem_supplier#4005 AS cfpk_lineitem_supplier_2#4038, cfpk_lineitem_partsupp#4006 AS cfpk_lineitem_partsupp_2#4039, cpfk_part_lineitem#4007 AS cpfk_part_lineitem_2#4040, cfpk_lineitem_part#4008 AS cfpk_lineitem_part_2#4041, cpfk_partsupp_lineitem#4009 AS cpfk_partsupp_lineitem_2#4042, cfpk_lineitem_orders#4010 AS cfpk_lineitem_orders_2#4043, cval_lineitem_l_quantity#4011 AS cval_lineitem_l_quantity_2#4044, cval_lineitem_l_extendedprice#4012 AS cval_lineitem_l_extendedprice_2#4045, cval_lineitem_l_discount#4013 AS cval_lineitem_l_discount_2#4046, cval_lineitem_l_tax#4014 AS cval_lineitem_l_tax_2#4047, cval_lineitem_l_returnflag#4015 AS cval_lineitem_l_returnflag_2#4048, cval_lineitem_l_linestatus#4016 AS cval_lineitem_l_linestatus_2#4049, cval_lineitem_l_commitdate#4017 AS cval_lineitem_l_commitdate_2#4050, cval_lineitem_l_receiptdate#4018 AS cval_lineitem_l_receiptdate_2#4051, cval_lineitem_l_shipinstruct#4019 AS cval_lineitem_l_shipinstruct_2#4052, cval_lineitem_l_shipmode#4020 AS cval_lineitem_l_shipmode_2#4053, cval_lineitem_l_comment#4021 AS cval_lineitem_l_comment_2#4054, cval_lineitem_l_shipdate#4022 AS cval_lineitem_l_shipdate_2#4055, cl_quantity#4023 AS cl_quantity_2#4056, cl_extendedprice#4024 AS cl_extendedprice_2#4057, cl_discount#4025 AS cl_discount_2#4058, ... 9 more fields]
         :        +- Relation[rid#4002,cpfk_orders_lineitem#4003,cpfk_supplier_lineitem#4004,cfpk_lineitem_supplier#4005,cfpk_lineitem_partsupp#4006,cpfk_part_lineitem#4007,cfpk_lineitem_part#4008,cpfk_partsupp_lineitem#4009,cfpk_lineitem_orders#4010,cval_lineitem_l_quantity#4011,cval_lineitem_l_extendedprice#4012,cval_lineitem_l_discount#4013,cval_lineitem_l_tax#4014,cval_lineitem_l_returnflag#4015,cval_lineitem_l_linestatus#4016,cval_lineitem_l_commitdate#4017,cval_lineitem_l_receiptdate#4018,cval_lineitem_l_shipinstruct#4019,cval_lineitem_l_shipmode#4020,cval_lineitem_l_comment#4021,cval_lineitem_l_shipdate#4022,cl_quantity#4023,cl_extendedprice#4024,cl_discount#4025,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#3902 AS rid_2#3935, cpfk_orders_lineitem#3903 AS cpfk_orders_lineitem_2#3936, cpfk_supplier_lineitem#3904 AS cpfk_supplier_lineitem_2#3937, cfpk_lineitem_supplier#3905 AS cfpk_lineitem_supplier_2#3938, cfpk_lineitem_partsupp#3906 AS cfpk_lineitem_partsupp_2#3939, cpfk_part_lineitem#3907 AS cpfk_part_lineitem_2#3940, cfpk_lineitem_part#3908 AS cfpk_lineitem_part_2#3941, cpfk_partsupp_lineitem#3909 AS cpfk_partsupp_lineitem_2#3942, cfpk_lineitem_orders#3910 AS cfpk_lineitem_orders_2#3943, cval_lineitem_l_quantity#3911 AS cval_lineitem_l_quantity_2#3944, cval_lineitem_l_extendedprice#3912 AS cval_lineitem_l_extendedprice_2#3945, cval_lineitem_l_discount#3913 AS cval_lineitem_l_discount_2#3946, cval_lineitem_l_tax#3914 AS cval_lineitem_l_tax_2#3947, cval_lineitem_l_returnflag#3915 AS cval_lineitem_l_returnflag_2#3948, cval_lineitem_l_linestatus#3916 AS cval_lineitem_l_linestatus_2#3949, cval_lineitem_l_commitdate#3917 AS cval_lineitem_l_commitdate_2#3950, cval_lineitem_l_receiptdate#3918 AS cval_lineitem_l_receiptdate_2#3951, cval_lineitem_l_shipinstruct#3919 AS cval_lineitem_l_shipinstruct_2#3952, cval_lineitem_l_shipmode#3920 AS cval_lineitem_l_shipmode_2#3953, cval_lineitem_l_comment#3921 AS cval_lineitem_l_comment_2#3954, cval_lineitem_l_shipdate#3922 AS cval_lineitem_l_shipdate_2#3955, cl_quantity#3923 AS cl_quantity_2#3956, cl_extendedprice#3924 AS cl_extendedprice_2#3957, cl_discount#3925 AS cl_discount_2#3958, ... 9 more fields]
            +- Relation[rid#3902,cpfk_orders_lineitem#3903,cpfk_supplier_lineitem#3904,cfpk_lineitem_supplier#3905,cfpk_lineitem_partsupp#3906,cpfk_part_lineitem#3907,cfpk_lineitem_part#3908,cpfk_partsupp_lineitem#3909,cfpk_lineitem_orders#3910,cval_lineitem_l_quantity#3911,cval_lineitem_l_extendedprice#3912,cval_lineitem_l_discount#3913,cval_lineitem_l_tax#3914,cval_lineitem_l_returnflag#3915,cval_lineitem_l_linestatus#3916,cval_lineitem_l_commitdate#3917,cval_lineitem_l_receiptdate#3918,cval_lineitem_l_shipinstruct#3919,cval_lineitem_l_shipmode#3920,cval_lineitem_l_comment#3921,cval_lineitem_l_shipdate#3922,cl_quantity#3923,cl_extendedprice#3924,cl_discount#3925,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 117306ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/11 05:14:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:14:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4139L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 05:14:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4139L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#4141 AS rid_0#4158, cval_part_p_name#4142 AS cval_part_p_name_0#4159, cval_part_p_mfgr#4143 AS cval_part_p_mfgr_0#4160, cval_part_p_type#4144 AS cval_part_p_type_0#4161, cval_part_p_size#4145 AS cval_part_p_size_0#4162, cval_part_p_container#4146 AS cval_part_p_container_0#4163, cval_part_p_retailprice#4147 AS cval_part_p_retailprice_0#4164, cval_part_p_comment#4148 AS cval_part_p_comment_0#4165, cval_part_p_brand#4149 AS cval_part_p_brand_0#4166, cp_name#4150 AS cp_name_0#4167, cp_mfgr#4151 AS cp_mfgr_0#4168, cp_type#4152 AS cp_type_0#4169, cp_size#4153 AS cp_size_0#4170, cp_container#4154 AS cp_container_0#4171, cp_retailprice#4155 AS cp_retailprice_0#4172, cp_comment#4156 AS cp_comment_0#4173, cp_brand#4157 AS cp_brand_0#4174]
         :  :  +- Relation[rid#4141,cval_part_p_name#4142,cval_part_p_mfgr#4143,cval_part_p_type#4144,cval_part_p_size#4145,cval_part_p_container#4146,cval_part_p_retailprice#4147,cval_part_p_comment#4148,cval_part_p_brand#4149,cp_name#4150,cp_mfgr#4151,cp_type#4152,cp_size#4153,cp_container#4154,cp_retailprice#4155,cp_comment#4156,cp_brand#4157] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#4241 AS rid_0#4258, cval_part_p_name#4242 AS cval_part_p_name_0#4259, cval_part_p_mfgr#4243 AS cval_part_p_mfgr_0#4260, cval_part_p_type#4244 AS cval_part_p_type_0#4261, cval_part_p_size#4245 AS cval_part_p_size_0#4262, cval_part_p_container#4246 AS cval_part_p_container_0#4263, cval_part_p_retailprice#4247 AS cval_part_p_retailprice_0#4264, cval_part_p_comment#4248 AS cval_part_p_comment_0#4265, cval_part_p_brand#4249 AS cval_part_p_brand_0#4266, cp_name#4250 AS cp_name_0#4267, cp_mfgr#4251 AS cp_mfgr_0#4268, cp_type#4252 AS cp_type_0#4269, cp_size#4253 AS cp_size_0#4270, cp_container#4254 AS cp_container_0#4271, cp_retailprice#4255 AS cp_retailprice_0#4272, cp_comment#4256 AS cp_comment_0#4273, cp_brand#4257 AS cp_brand_0#4274]
         :     :  +- Relation[rid#4241,cval_part_p_name#4242,cval_part_p_mfgr#4243,cval_part_p_type#4244,cval_part_p_size#4245,cval_part_p_container#4246,cval_part_p_retailprice#4247,cval_part_p_comment#4248,cval_part_p_brand#4249,cp_name#4250,cp_mfgr#4251,cp_type#4252,cp_size#4253,cp_container#4254,cp_retailprice#4255,cp_comment#4256,cp_brand#4257] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#4275 AS rid_1#4308, cpfk_orders_lineitem#4276 AS cpfk_orders_lineitem_1#4309, cpfk_supplier_lineitem#4277 AS cpfk_supplier_lineitem_1#4310, cfpk_lineitem_supplier#4278 AS cfpk_lineitem_supplier_1#4311, cfpk_lineitem_partsupp#4279 AS cfpk_lineitem_partsupp_1#4312, cpfk_part_lineitem#4280 AS cpfk_part_lineitem_1#4313, cfpk_lineitem_part#4281 AS cfpk_lineitem_part_1#4314, cpfk_partsupp_lineitem#4282 AS cpfk_partsupp_lineitem_1#4315, cfpk_lineitem_orders#4283 AS cfpk_lineitem_orders_1#4316, cval_lineitem_l_quantity#4284 AS cval_lineitem_l_quantity_1#4317, cval_lineitem_l_extendedprice#4285 AS cval_lineitem_l_extendedprice_1#4318, cval_lineitem_l_discount#4286 AS cval_lineitem_l_discount_1#4319, cval_lineitem_l_tax#4287 AS cval_lineitem_l_tax_1#4320, cval_lineitem_l_returnflag#4288 AS cval_lineitem_l_returnflag_1#4321, cval_lineitem_l_linestatus#4289 AS cval_lineitem_l_linestatus_1#4322, cval_lineitem_l_commitdate#4290 AS cval_lineitem_l_commitdate_1#4323, cval_lineitem_l_receiptdate#4291 AS cval_lineitem_l_receiptdate_1#4324, cval_lineitem_l_shipinstruct#4292 AS cval_lineitem_l_shipinstruct_1#4325, cval_lineitem_l_shipmode#4293 AS cval_lineitem_l_shipmode_1#4326, cval_lineitem_l_comment#4294 AS cval_lineitem_l_comment_1#4327, cval_lineitem_l_shipdate#4295 AS cval_lineitem_l_shipdate_1#4328, cl_quantity#4296 AS cl_quantity_1#4329, cl_extendedprice#4297 AS cl_extendedprice_1#4330, cl_discount#4298 AS cl_discount_1#4331, ... 9 more fields]
         :        +- Relation[rid#4275,cpfk_orders_lineitem#4276,cpfk_supplier_lineitem#4277,cfpk_lineitem_supplier#4278,cfpk_lineitem_partsupp#4279,cpfk_part_lineitem#4280,cfpk_lineitem_part#4281,cpfk_partsupp_lineitem#4282,cfpk_lineitem_orders#4283,cval_lineitem_l_quantity#4284,cval_lineitem_l_extendedprice#4285,cval_lineitem_l_discount#4286,cval_lineitem_l_tax#4287,cval_lineitem_l_returnflag#4288,cval_lineitem_l_linestatus#4289,cval_lineitem_l_commitdate#4290,cval_lineitem_l_receiptdate#4291,cval_lineitem_l_shipinstruct#4292,cval_lineitem_l_shipmode#4293,cval_lineitem_l_comment#4294,cval_lineitem_l_shipdate#4295,cl_quantity#4296,cl_extendedprice#4297,cl_discount#4298,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4175 AS rid_1#4208, cpfk_orders_lineitem#4176 AS cpfk_orders_lineitem_1#4209, cpfk_supplier_lineitem#4177 AS cpfk_supplier_lineitem_1#4210, cfpk_lineitem_supplier#4178 AS cfpk_lineitem_supplier_1#4211, cfpk_lineitem_partsupp#4179 AS cfpk_lineitem_partsupp_1#4212, cpfk_part_lineitem#4180 AS cpfk_part_lineitem_1#4213, cfpk_lineitem_part#4181 AS cfpk_lineitem_part_1#4214, cpfk_partsupp_lineitem#4182 AS cpfk_partsupp_lineitem_1#4215, cfpk_lineitem_orders#4183 AS cfpk_lineitem_orders_1#4216, cval_lineitem_l_quantity#4184 AS cval_lineitem_l_quantity_1#4217, cval_lineitem_l_extendedprice#4185 AS cval_lineitem_l_extendedprice_1#4218, cval_lineitem_l_discount#4186 AS cval_lineitem_l_discount_1#4219, cval_lineitem_l_tax#4187 AS cval_lineitem_l_tax_1#4220, cval_lineitem_l_returnflag#4188 AS cval_lineitem_l_returnflag_1#4221, cval_lineitem_l_linestatus#4189 AS cval_lineitem_l_linestatus_1#4222, cval_lineitem_l_commitdate#4190 AS cval_lineitem_l_commitdate_1#4223, cval_lineitem_l_receiptdate#4191 AS cval_lineitem_l_receiptdate_1#4224, cval_lineitem_l_shipinstruct#4192 AS cval_lineitem_l_shipinstruct_1#4225, cval_lineitem_l_shipmode#4193 AS cval_lineitem_l_shipmode_1#4226, cval_lineitem_l_comment#4194 AS cval_lineitem_l_comment_1#4227, cval_lineitem_l_shipdate#4195 AS cval_lineitem_l_shipdate_1#4228, cl_quantity#4196 AS cl_quantity_1#4229, cl_extendedprice#4197 AS cl_extendedprice_1#4230, cl_discount#4198 AS cl_discount_1#4231, ... 9 more fields]
            +- Relation[rid#4175,cpfk_orders_lineitem#4176,cpfk_supplier_lineitem#4177,cfpk_lineitem_supplier#4178,cfpk_lineitem_partsupp#4179,cpfk_part_lineitem#4180,cfpk_lineitem_part#4181,cpfk_partsupp_lineitem#4182,cfpk_lineitem_orders#4183,cval_lineitem_l_quantity#4184,cval_lineitem_l_extendedprice#4185,cval_lineitem_l_discount#4186,cval_lineitem_l_tax#4187,cval_lineitem_l_returnflag#4188,cval_lineitem_l_linestatus#4189,cval_lineitem_l_commitdate#4190,cval_lineitem_l_receiptdate#4191,cval_lineitem_l_shipinstruct#4192,cval_lineitem_l_shipmode#4193,cval_lineitem_l_comment#4194,cval_lineitem_l_shipdate#4195,cl_quantity#4196,cl_extendedprice#4197,cl_discount#4198,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 83398ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/11 05:16:15 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:16:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4397L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 05:16:15 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:16:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:16:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:16:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:16:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:16:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:16:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:16:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:16:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:16:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:16:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:16:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:16:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:16:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:16:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:16:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:16:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4397L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#4399 AS rid_0#4404, cval_region_r_name#4400 AS cval_region_r_name_0#4405, cval_region_r_comment#4401 AS cval_region_r_comment_0#4406, cr_name#4402 AS cr_name_0#4407, cr_comment#4403 AS cr_comment_0#4408]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#4399,cval_region_r_name#4400,cval_region_r_comment#4401,cr_name#4402,cr_comment#4403] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#4409 AS rid_0#4414, cval_region_r_name#4410 AS cval_region_r_name_0#4415, cval_region_r_comment#4411 AS cval_region_r_comment_0#4416, cr_name#4412 AS cr_name_0#4417, cr_comment#4413 AS cr_comment_0#4418]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#4409,cval_region_r_name#4410,cval_region_r_comment#4411,cr_name#4412,cr_comment#4413] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :     :- Project [rid#4433 AS rid_0#4438, cval_region_r_name#4434 AS cval_region_r_name_0#4439, cval_region_r_comment#4435 AS cval_region_r_comment_0#4440, cr_name#4436 AS cr_name_0#4441, cr_comment#4437 AS cr_comment_0#4442]
         :     :  :  :  :  :  :  :  :     :  +- Relation[rid#4433,cval_region_r_name#4434,cval_region_r_comment#4435,cr_name#4436,cr_comment#4437] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :     +- Project [rid#4443 AS rid_1#4450, cpfk_region_nation#4444 AS cpfk_region_nation_1#4451, cfpk_nation_region#4445 AS cfpk_nation_region_1#4452, cval_nation_n_name#4446 AS cval_nation_n_name_1#4453, cval_nation_n_comment#4447 AS cval_nation_n_comment_1#4454, cn_name#4448 AS cn_name_1#4455, cn_comment#4449 AS cn_comment_1#4456]
         :     :  :  :  :  :  :  :  :        +- Relation[rid#4443,cpfk_region_nation#4444,cfpk_nation_region#4445,cval_nation_n_name#4446,cval_nation_n_comment#4447,cn_name#4448,cn_comment#4449] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#4419 AS rid_1#4426, cpfk_region_nation#4420 AS cpfk_region_nation_1#4427, cfpk_nation_region#4421 AS cfpk_nation_region_1#4428, cval_nation_n_name#4422 AS cval_nation_n_name_1#4429, cval_nation_n_comment#4423 AS cval_nation_n_comment_1#4430, cn_name#4424 AS cn_name_1#4431, cn_comment#4425 AS cn_comment_1#4432]
         :     :  :  :  :  :  :  :     +- Relation[rid#4419,cpfk_region_nation#4420,cfpk_nation_region#4421,cval_nation_n_name#4422,cval_nation_n_comment#4423,cn_name#4424,cn_comment#4425] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :     :- Project [rid#4487 AS rid_1#4494, cpfk_region_nation#4488 AS cpfk_region_nation_1#4495, cfpk_nation_region#4489 AS cfpk_nation_region_1#4496, cval_nation_n_name#4490 AS cval_nation_n_name_1#4497, cval_nation_n_comment#4491 AS cval_nation_n_comment_1#4498, cn_name#4492 AS cn_name_1#4499, cn_comment#4493 AS cn_comment_1#4500]
         :     :  :  :  :  :  :     :  +- Relation[rid#4487,cpfk_region_nation#4488,cfpk_nation_region#4489,cval_nation_n_name#4490,cval_nation_n_comment#4491,cn_name#4492,cn_comment#4493] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :     +- Project [rid#4501 AS rid_2#4516, cpfk_nation_customer#4502 AS cpfk_nation_customer_2#4517, cfpk_customer_nation#4503 AS cfpk_customer_nation_2#4518, cval_customer_c_name#4504 AS cval_customer_c_name_2#4519, cval_customer_c_address#4505 AS cval_customer_c_address_2#4520, cval_customer_c_phone#4506 AS cval_customer_c_phone_2#4521, cval_customer_c_acctbal#4507 AS cval_customer_c_acctbal_2#4522, cval_customer_c_comment#4508 AS cval_customer_c_comment_2#4523, cval_customer_c_mktsegment#4509 AS cval_customer_c_mktsegment_2#4524, cc_name#4510 AS cc_name_2#4525, cc_address#4511 AS cc_address_2#4526, cc_phone#4512 AS cc_phone_2#4527, cc_acctbal#4513 AS cc_acctbal_2#4528, cc_comment#4514 AS cc_comment_2#4529, cc_mktsegment#4515 AS cc_mktsegment_2#4530]
         :     :  :  :  :  :  :        +- Relation[rid#4501,cpfk_nation_customer#4502,cfpk_customer_nation#4503,cval_customer_c_name#4504,cval_customer_c_address#4505,cval_customer_c_phone#4506,cval_customer_c_acctbal#4507,cval_customer_c_comment#4508,cval_customer_c_mktsegment#4509,cc_name#4510,cc_address#4511,cc_phone#4512,cc_acctbal#4513,cc_comment#4514,cc_mktsegment#4515] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#4457 AS rid_2#4472, cpfk_nation_customer#4458 AS cpfk_nation_customer_2#4473, cfpk_customer_nation#4459 AS cfpk_customer_nation_2#4474, cval_customer_c_name#4460 AS cval_customer_c_name_2#4475, cval_customer_c_address#4461 AS cval_customer_c_address_2#4476, cval_customer_c_phone#4462 AS cval_customer_c_phone_2#4477, cval_customer_c_acctbal#4463 AS cval_customer_c_acctbal_2#4478, cval_customer_c_comment#4464 AS cval_customer_c_comment_2#4479, cval_customer_c_mktsegment#4465 AS cval_customer_c_mktsegment_2#4480, cc_name#4466 AS cc_name_2#4481, cc_address#4467 AS cc_address_2#4482, cc_phone#4468 AS cc_phone_2#4483, cc_acctbal#4469 AS cc_acctbal_2#4484, cc_comment#4470 AS cc_comment_2#4485, cc_mktsegment#4471 AS cc_mktsegment_2#4486]
         :     :  :  :  :  :     +- Relation[rid#4457,cpfk_nation_customer#4458,cfpk_customer_nation#4459,cval_customer_c_name#4460,cval_customer_c_address#4461,cval_customer_c_phone#4462,cval_customer_c_acctbal#4463,cval_customer_c_comment#4464,cval_customer_c_mktsegment#4465,cc_name#4466,cc_address#4467,cc_phone#4468,cc_acctbal#4469,cc_comment#4470,cc_mktsegment#4471] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :     :- Project [rid#4565 AS rid_2#4580, cpfk_nation_customer#4566 AS cpfk_nation_customer_2#4581, cfpk_customer_nation#4567 AS cfpk_customer_nation_2#4582, cval_customer_c_name#4568 AS cval_customer_c_name_2#4583, cval_customer_c_address#4569 AS cval_customer_c_address_2#4584, cval_customer_c_phone#4570 AS cval_customer_c_phone_2#4585, cval_customer_c_acctbal#4571 AS cval_customer_c_acctbal_2#4586, cval_customer_c_comment#4572 AS cval_customer_c_comment_2#4587, cval_customer_c_mktsegment#4573 AS cval_customer_c_mktsegment_2#4588, cc_name#4574 AS cc_name_2#4589, cc_address#4575 AS cc_address_2#4590, cc_phone#4576 AS cc_phone_2#4591, cc_acctbal#4577 AS cc_acctbal_2#4592, cc_comment#4578 AS cc_comment_2#4593, cc_mktsegment#4579 AS cc_mktsegment_2#4594]
         :     :  :  :  :     :  +- Relation[rid#4565,cpfk_nation_customer#4566,cfpk_customer_nation#4567,cval_customer_c_name#4568,cval_customer_c_address#4569,cval_customer_c_phone#4570,cval_customer_c_acctbal#4571,cval_customer_c_comment#4572,cval_customer_c_mktsegment#4573,cc_name#4574,cc_address#4575,cc_phone#4576,cc_acctbal#4577,cc_comment#4578,cc_mktsegment#4579] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :     +- Project [rid#4595 AS rid_3#4612, cpfk_customer_orders#4596 AS cpfk_customer_orders_3#4613, cfpk_orders_customer#4597 AS cfpk_orders_customer_3#4614, cval_orders_o_orderstatus#4598 AS cval_orders_o_orderstatus_3#4615, cval_orders_o_totalprice#4599 AS cval_orders_o_totalprice_3#4616, cval_orders_o_orderpriority#4600 AS cval_orders_o_orderpriority_3#4617, cval_orders_o_clerk#4601 AS cval_orders_o_clerk_3#4618, cval_orders_o_shippriority#4602 AS cval_orders_o_shippriority_3#4619, cval_orders_o_comment#4603 AS cval_orders_o_comment_3#4620, cval_orders_o_orderdate#4604 AS cval_orders_o_orderdate_3#4621, co_orderstatus#4605 AS co_orderstatus_3#4622, co_totalprice#4606 AS co_totalprice_3#4623, co_orderpriority#4607 AS co_orderpriority_3#4624, co_clerk#4608 AS co_clerk_3#4625, co_shippriority#4609 AS co_shippriority_3#4626, co_comment#4610 AS co_comment_3#4627, co_orderdate#4611 AS co_orderdate_3#4628]
         :     :  :  :  :        +- Relation[rid#4595,cpfk_customer_orders#4596,cfpk_orders_customer#4597,cval_orders_o_orderstatus#4598,cval_orders_o_totalprice#4599,cval_orders_o_orderpriority#4600,cval_orders_o_clerk#4601,cval_orders_o_shippriority#4602,cval_orders_o_comment#4603,cval_orders_o_orderdate#4604,co_orderstatus#4605,co_totalprice#4606,co_orderpriority#4607,co_clerk#4608,co_shippriority#4609,co_comment#4610,co_orderdate#4611] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#4531 AS rid_3#4548, cpfk_customer_orders#4532 AS cpfk_customer_orders_3#4549, cfpk_orders_customer#4533 AS cfpk_orders_customer_3#4550, cval_orders_o_orderstatus#4534 AS cval_orders_o_orderstatus_3#4551, cval_orders_o_totalprice#4535 AS cval_orders_o_totalprice_3#4552, cval_orders_o_orderpriority#4536 AS cval_orders_o_orderpriority_3#4553, cval_orders_o_clerk#4537 AS cval_orders_o_clerk_3#4554, cval_orders_o_shippriority#4538 AS cval_orders_o_shippriority_3#4555, cval_orders_o_comment#4539 AS cval_orders_o_comment_3#4556, cval_orders_o_orderdate#4540 AS cval_orders_o_orderdate_3#4557, co_orderstatus#4541 AS co_orderstatus_3#4558, co_totalprice#4542 AS co_totalprice_3#4559, co_orderpriority#4543 AS co_orderpriority_3#4560, co_clerk#4544 AS co_clerk_3#4561, co_shippriority#4545 AS co_shippriority_3#4562, co_comment#4546 AS co_comment_3#4563, co_orderdate#4547 AS co_orderdate_3#4564]
         :     :  :  :     +- Relation[rid#4531,cpfk_customer_orders#4532,cfpk_orders_customer#4533,cval_orders_o_orderstatus#4534,cval_orders_o_totalprice#4535,cval_orders_o_orderpriority#4536,cval_orders_o_clerk#4537,cval_orders_o_shippriority#4538,cval_orders_o_comment#4539,cval_orders_o_orderdate#4540,co_orderstatus#4541,co_totalprice#4542,co_orderpriority#4543,co_clerk#4544,co_shippriority#4545,co_comment#4546,co_orderdate#4547] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :     :- Project [rid#4695 AS rid_3#4712, cpfk_customer_orders#4696 AS cpfk_customer_orders_3#4713, cfpk_orders_customer#4697 AS cfpk_orders_customer_3#4714, cval_orders_o_orderstatus#4698 AS cval_orders_o_orderstatus_3#4715, cval_orders_o_totalprice#4699 AS cval_orders_o_totalprice_3#4716, cval_orders_o_orderpriority#4700 AS cval_orders_o_orderpriority_3#4717, cval_orders_o_clerk#4701 AS cval_orders_o_clerk_3#4718, cval_orders_o_shippriority#4702 AS cval_orders_o_shippriority_3#4719, cval_orders_o_comment#4703 AS cval_orders_o_comment_3#4720, cval_orders_o_orderdate#4704 AS cval_orders_o_orderdate_3#4721, co_orderstatus#4705 AS co_orderstatus_3#4722, co_totalprice#4706 AS co_totalprice_3#4723, co_orderpriority#4707 AS co_orderpriority_3#4724, co_clerk#4708 AS co_clerk_3#4725, co_shippriority#4709 AS co_shippriority_3#4726, co_comment#4710 AS co_comment_3#4727, co_orderdate#4711 AS co_orderdate_3#4728]
         :     :  :     :  +- Relation[rid#4695,cpfk_customer_orders#4696,cfpk_orders_customer#4697,cval_orders_o_orderstatus#4698,cval_orders_o_totalprice#4699,cval_orders_o_orderpriority#4700,cval_orders_o_clerk#4701,cval_orders_o_shippriority#4702,cval_orders_o_comment#4703,cval_orders_o_orderdate#4704,co_orderstatus#4705,co_totalprice#4706,co_orderpriority#4707,co_clerk#4708,co_shippriority#4709,co_comment#4710,co_orderdate#4711] JDBCRelation(torders) [numPartitions=1]
         :     :  :     +- Project [rid#4729 AS rid_4#4762, cpfk_orders_lineitem#4730 AS cpfk_orders_lineitem_4#4763, cpfk_supplier_lineitem#4731 AS cpfk_supplier_lineitem_4#4764, cfpk_lineitem_supplier#4732 AS cfpk_lineitem_supplier_4#4765, cfpk_lineitem_partsupp#4733 AS cfpk_lineitem_partsupp_4#4766, cpfk_part_lineitem#4734 AS cpfk_part_lineitem_4#4767, cfpk_lineitem_part#4735 AS cfpk_lineitem_part_4#4768, cpfk_partsupp_lineitem#4736 AS cpfk_partsupp_lineitem_4#4769, cfpk_lineitem_orders#4737 AS cfpk_lineitem_orders_4#4770, cval_lineitem_l_quantity#4738 AS cval_lineitem_l_quantity_4#4771, cval_lineitem_l_extendedprice#4739 AS cval_lineitem_l_extendedprice_4#4772, cval_lineitem_l_discount#4740 AS cval_lineitem_l_discount_4#4773, cval_lineitem_l_tax#4741 AS cval_lineitem_l_tax_4#4774, cval_lineitem_l_returnflag#4742 AS cval_lineitem_l_returnflag_4#4775, cval_lineitem_l_linestatus#4743 AS cval_lineitem_l_linestatus_4#4776, cval_lineitem_l_commitdate#4744 AS cval_lineitem_l_commitdate_4#4777, cval_lineitem_l_receiptdate#4745 AS cval_lineitem_l_receiptdate_4#4778, cval_lineitem_l_shipinstruct#4746 AS cval_lineitem_l_shipinstruct_4#4779, cval_lineitem_l_shipmode#4747 AS cval_lineitem_l_shipmode_4#4780, cval_lineitem_l_comment#4748 AS cval_lineitem_l_comment_4#4781, cval_lineitem_l_shipdate#4749 AS cval_lineitem_l_shipdate_4#4782, cl_quantity#4750 AS cl_quantity_4#4783, cl_extendedprice#4751 AS cl_extendedprice_4#4784, cl_discount#4752 AS cl_discount_4#4785, ... 9 more fields]
         :     :  :        +- Relation[rid#4729,cpfk_orders_lineitem#4730,cpfk_supplier_lineitem#4731,cfpk_lineitem_supplier#4732,cfpk_lineitem_partsupp#4733,cpfk_part_lineitem#4734,cfpk_lineitem_part#4735,cpfk_partsupp_lineitem#4736,cfpk_lineitem_orders#4737,cval_lineitem_l_quantity#4738,cval_lineitem_l_extendedprice#4739,cval_lineitem_l_discount#4740,cval_lineitem_l_tax#4741,cval_lineitem_l_returnflag#4742,cval_lineitem_l_linestatus#4743,cval_lineitem_l_commitdate#4744,cval_lineitem_l_receiptdate#4745,cval_lineitem_l_shipinstruct#4746,cval_lineitem_l_shipmode#4747,cval_lineitem_l_comment#4748,cval_lineitem_l_shipdate#4749,cl_quantity#4750,cl_extendedprice#4751,cl_discount#4752,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#4629 AS rid_4#4662, cpfk_orders_lineitem#4630 AS cpfk_orders_lineitem_4#4663, cpfk_supplier_lineitem#4631 AS cpfk_supplier_lineitem_4#4664, cfpk_lineitem_supplier#4632 AS cfpk_lineitem_supplier_4#4665, cfpk_lineitem_partsupp#4633 AS cfpk_lineitem_partsupp_4#4666, cpfk_part_lineitem#4634 AS cpfk_part_lineitem_4#4667, cfpk_lineitem_part#4635 AS cfpk_lineitem_part_4#4668, cpfk_partsupp_lineitem#4636 AS cpfk_partsupp_lineitem_4#4669, cfpk_lineitem_orders#4637 AS cfpk_lineitem_orders_4#4670, cval_lineitem_l_quantity#4638 AS cval_lineitem_l_quantity_4#4671, cval_lineitem_l_extendedprice#4639 AS cval_lineitem_l_extendedprice_4#4672, cval_lineitem_l_discount#4640 AS cval_lineitem_l_discount_4#4673, cval_lineitem_l_tax#4641 AS cval_lineitem_l_tax_4#4674, cval_lineitem_l_returnflag#4642 AS cval_lineitem_l_returnflag_4#4675, cval_lineitem_l_linestatus#4643 AS cval_lineitem_l_linestatus_4#4676, cval_lineitem_l_commitdate#4644 AS cval_lineitem_l_commitdate_4#4677, cval_lineitem_l_receiptdate#4645 AS cval_lineitem_l_receiptdate_4#4678, cval_lineitem_l_shipinstruct#4646 AS cval_lineitem_l_shipinstruct_4#4679, cval_lineitem_l_shipmode#4647 AS cval_lineitem_l_shipmode_4#4680, cval_lineitem_l_comment#4648 AS cval_lineitem_l_comment_4#4681, cval_lineitem_l_shipdate#4649 AS cval_lineitem_l_shipdate_4#4682, cl_quantity#4650 AS cl_quantity_4#4683, cl_extendedprice#4651 AS cl_extendedprice_4#4684, cl_discount#4652 AS cl_discount_4#4685, ... 9 more fields]
         :     :     +- Relation[rid#4629,cpfk_orders_lineitem#4630,cpfk_supplier_lineitem#4631,cfpk_lineitem_supplier#4632,cfpk_lineitem_partsupp#4633,cpfk_part_lineitem#4634,cfpk_lineitem_part#4635,cpfk_partsupp_lineitem#4636,cfpk_lineitem_orders#4637,cval_lineitem_l_quantity#4638,cval_lineitem_l_extendedprice#4639,cval_lineitem_l_discount#4640,cval_lineitem_l_tax#4641,cval_lineitem_l_returnflag#4642,cval_lineitem_l_linestatus#4643,cval_lineitem_l_commitdate#4644,cval_lineitem_l_receiptdate#4645,cval_lineitem_l_shipinstruct#4646,cval_lineitem_l_shipmode#4647,cval_lineitem_l_comment#4648,cval_lineitem_l_shipdate#4649,cl_quantity#4650,cl_extendedprice#4651,cl_discount#4652,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#4795 AS rid_5#4808, cpfk_nation_supplier#4796 AS cpfk_nation_supplier_5#4809, cfpk_supplier_nation#4797 AS cfpk_supplier_nation_5#4810, cval_supplier_s_name#4798 AS cval_supplier_s_name_5#4811, cval_supplier_s_address#4799 AS cval_supplier_s_address_5#4812, cval_supplier_s_phone#4800 AS cval_supplier_s_phone_5#4813, cval_supplier_s_acctbal#4801 AS cval_supplier_s_acctbal_5#4814, cval_supplier_s_comment#4802 AS cval_supplier_s_comment_5#4815, cs_name#4803 AS cs_name_5#4816, cs_address#4804 AS cs_address_5#4817, cs_phone#4805 AS cs_phone_5#4818, cs_acctbal#4806 AS cs_acctbal_5#4819, cs_comment#4807 AS cs_comment_5#4820]
         :        +- Relation[rid#4795,cpfk_nation_supplier#4796,cfpk_supplier_nation#4797,cval_supplier_s_name#4798,cval_supplier_s_address#4799,cval_supplier_s_phone#4800,cval_supplier_s_acctbal#4801,cval_supplier_s_comment#4802,cs_name#4803,cs_address#4804,cs_phone#4805,cs_acctbal#4806,cs_comment#4807] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#4821 AS rid_1#4828, cpfk_region_nation#4822 AS cpfk_region_nation_1#4829, cfpk_nation_region#4823 AS cfpk_nation_region_1#4830, cval_nation_n_name#4824 AS cval_nation_n_name_1#4831, cval_nation_n_comment#4825 AS cval_nation_n_comment_1#4832, cn_name#4826 AS cn_name_1#4833, cn_comment#4827 AS cn_comment_1#4834]
            :  +- Relation[rid#4821,cpfk_region_nation#4822,cfpk_nation_region#4823,cval_nation_n_name#4824,cval_nation_n_comment#4825,cn_name#4826,cn_comment#4827] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#4835 AS rid_5#4848, cpfk_nation_supplier#4836 AS cpfk_nation_supplier_5#4849, cfpk_supplier_nation#4837 AS cfpk_supplier_nation_5#4850, cval_supplier_s_name#4838 AS cval_supplier_s_name_5#4851, cval_supplier_s_address#4839 AS cval_supplier_s_address_5#4852, cval_supplier_s_phone#4840 AS cval_supplier_s_phone_5#4853, cval_supplier_s_acctbal#4841 AS cval_supplier_s_acctbal_5#4854, cval_supplier_s_comment#4842 AS cval_supplier_s_comment_5#4855, cs_name#4843 AS cs_name_5#4856, cs_address#4844 AS cs_address_5#4857, cs_phone#4845 AS cs_phone_5#4858, cs_acctbal#4846 AS cs_acctbal_5#4859, cs_comment#4847 AS cs_comment_5#4860]
               +- Relation[rid#4835,cpfk_nation_supplier#4836,cfpk_supplier_nation#4837,cval_supplier_s_name#4838,cval_supplier_s_address#4839,cval_supplier_s_phone#4840,cval_supplier_s_acctbal#4841,cval_supplier_s_comment#4842,cs_name#4843,cs_address#4844,cs_phone#4845,cs_acctbal#4846,cs_comment#4847] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1206514
Elapsed time: 163486ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/11 05:18:59 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:18:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4956L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 05:18:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#4956L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#4958 AS rid_0#4991, cpfk_orders_lineitem#4959 AS cpfk_orders_lineitem_0#4992, cpfk_supplier_lineitem#4960 AS cpfk_supplier_lineitem_0#4993, cfpk_lineitem_supplier#4961 AS cfpk_lineitem_supplier_0#4994, cfpk_lineitem_partsupp#4962 AS cfpk_lineitem_partsupp_0#4995, cpfk_part_lineitem#4963 AS cpfk_part_lineitem_0#4996, cfpk_lineitem_part#4964 AS cfpk_lineitem_part_0#4997, cpfk_partsupp_lineitem#4965 AS cpfk_partsupp_lineitem_0#4998, cfpk_lineitem_orders#4966 AS cfpk_lineitem_orders_0#4999, cval_lineitem_l_quantity#4967 AS cval_lineitem_l_quantity_0#5000, cval_lineitem_l_extendedprice#4968 AS cval_lineitem_l_extendedprice_0#5001, cval_lineitem_l_discount#4969 AS cval_lineitem_l_discount_0#5002, cval_lineitem_l_tax#4970 AS cval_lineitem_l_tax_0#5003, cval_lineitem_l_returnflag#4971 AS cval_lineitem_l_returnflag_0#5004, cval_lineitem_l_linestatus#4972 AS cval_lineitem_l_linestatus_0#5005, cval_lineitem_l_commitdate#4973 AS cval_lineitem_l_commitdate_0#5006, cval_lineitem_l_receiptdate#4974 AS cval_lineitem_l_receiptdate_0#5007, cval_lineitem_l_shipinstruct#4975 AS cval_lineitem_l_shipinstruct_0#5008, cval_lineitem_l_shipmode#4976 AS cval_lineitem_l_shipmode_0#5009, cval_lineitem_l_comment#4977 AS cval_lineitem_l_comment_0#5010, cval_lineitem_l_shipdate#4978 AS cval_lineitem_l_shipdate_0#5011, cl_quantity#4979 AS cl_quantity_0#5012, cl_extendedprice#4980 AS cl_extendedprice_0#5013, cl_discount#4981 AS cl_discount_0#5014, ... 9 more fields]
         +- Relation[rid#4958,cpfk_orders_lineitem#4959,cpfk_supplier_lineitem#4960,cfpk_lineitem_supplier#4961,cfpk_lineitem_partsupp#4962,cpfk_part_lineitem#4963,cfpk_lineitem_part#4964,cpfk_partsupp_lineitem#4965,cfpk_lineitem_orders#4966,cval_lineitem_l_quantity#4967,cval_lineitem_l_extendedprice#4968,cval_lineitem_l_discount#4969,cval_lineitem_l_tax#4970,cval_lineitem_l_returnflag#4971,cval_lineitem_l_linestatus#4972,cval_lineitem_l_commitdate#4973,cval_lineitem_l_receiptdate#4974,cval_lineitem_l_shipinstruct#4975,cval_lineitem_l_shipmode#4976,cval_lineitem_l_comment#4977,cval_lineitem_l_shipdate#4978,cl_quantity#4979,cl_extendedprice#4980,cl_discount#4981,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 3114ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 05:19:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:19:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5066L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 05:19:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:19:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:19:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:19:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:19:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:19:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:19:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:19:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:19:02 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:19:02 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:19:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5066L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#5068 AS rid_0#5075, cpfk_region_nation#5069 AS cpfk_region_nation_0#5076, cfpk_nation_region#5070 AS cfpk_nation_region_0#5077, cval_nation_n_name#5071 AS cval_nation_n_name_0#5078, cval_nation_n_comment#5072 AS cval_nation_n_comment_0#5079, cn_name#5073 AS cn_name_0#5080, cn_comment#5074 AS cn_comment_0#5081]
            :     :     :  :  :  :  :  +- Relation[rid#5068,cpfk_region_nation#5069,cfpk_nation_region#5070,cval_nation_n_name#5071,cval_nation_n_comment#5072,cn_name#5073,cn_comment#5074] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#5108 AS rid_0#5115, cpfk_region_nation#5109 AS cpfk_region_nation_0#5116, cfpk_nation_region#5110 AS cfpk_nation_region_0#5117, cval_nation_n_name#5111 AS cval_nation_n_name_0#5118, cval_nation_n_comment#5112 AS cval_nation_n_comment_0#5119, cn_name#5113 AS cn_name_0#5120, cn_comment#5114 AS cn_comment_0#5121]
            :     :     :  :  :  :     :  +- Relation[rid#5108,cpfk_region_nation#5109,cfpk_nation_region#5110,cval_nation_n_name#5111,cval_nation_n_comment#5112,cn_name#5113,cn_comment#5114] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#5122 AS rid_1#5135, cpfk_nation_supplier#5123 AS cpfk_nation_supplier_1#5136, cfpk_supplier_nation#5124 AS cfpk_supplier_nation_1#5137, cval_supplier_s_name#5125 AS cval_supplier_s_name_1#5138, cval_supplier_s_address#5126 AS cval_supplier_s_address_1#5139, cval_supplier_s_phone#5127 AS cval_supplier_s_phone_1#5140, cval_supplier_s_acctbal#5128 AS cval_supplier_s_acctbal_1#5141, cval_supplier_s_comment#5129 AS cval_supplier_s_comment_1#5142, cs_name#5130 AS cs_name_1#5143, cs_address#5131 AS cs_address_1#5144, cs_phone#5132 AS cs_phone_1#5145, cs_acctbal#5133 AS cs_acctbal_1#5146, cs_comment#5134 AS cs_comment_1#5147]
            :     :     :  :  :  :        +- Relation[rid#5122,cpfk_nation_supplier#5123,cfpk_supplier_nation#5124,cval_supplier_s_name#5125,cval_supplier_s_address#5126,cval_supplier_s_phone#5127,cval_supplier_s_acctbal#5128,cval_supplier_s_comment#5129,cs_name#5130,cs_address#5131,cs_phone#5132,cs_acctbal#5133,cs_comment#5134] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#5082 AS rid_1#5095, cpfk_nation_supplier#5083 AS cpfk_nation_supplier_1#5096, cfpk_supplier_nation#5084 AS cfpk_supplier_nation_1#5097, cval_supplier_s_name#5085 AS cval_supplier_s_name_1#5098, cval_supplier_s_address#5086 AS cval_supplier_s_address_1#5099, cval_supplier_s_phone#5087 AS cval_supplier_s_phone_1#5100, cval_supplier_s_acctbal#5088 AS cval_supplier_s_acctbal_1#5101, cval_supplier_s_comment#5089 AS cval_supplier_s_comment_1#5102, cs_name#5090 AS cs_name_1#5103, cs_address#5091 AS cs_address_1#5104, cs_phone#5092 AS cs_phone_1#5105, cs_acctbal#5093 AS cs_acctbal_1#5106, cs_comment#5094 AS cs_comment_1#5107]
            :     :     :  :  :     +- Relation[rid#5082,cpfk_nation_supplier#5083,cfpk_supplier_nation#5084,cval_supplier_s_name#5085,cval_supplier_s_address#5086,cval_supplier_s_phone#5087,cval_supplier_s_acctbal#5088,cval_supplier_s_comment#5089,cs_name#5090,cs_address#5091,cs_phone#5092,cs_acctbal#5093,cs_comment#5094] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#5214 AS rid_1#5227, cpfk_nation_supplier#5215 AS cpfk_nation_supplier_1#5228, cfpk_supplier_nation#5216 AS cfpk_supplier_nation_1#5229, cval_supplier_s_name#5217 AS cval_supplier_s_name_1#5230, cval_supplier_s_address#5218 AS cval_supplier_s_address_1#5231, cval_supplier_s_phone#5219 AS cval_supplier_s_phone_1#5232, cval_supplier_s_acctbal#5220 AS cval_supplier_s_acctbal_1#5233, cval_supplier_s_comment#5221 AS cval_supplier_s_comment_1#5234, cs_name#5222 AS cs_name_1#5235, cs_address#5223 AS cs_address_1#5236, cs_phone#5224 AS cs_phone_1#5237, cs_acctbal#5225 AS cs_acctbal_1#5238, cs_comment#5226 AS cs_comment_1#5239]
            :     :     :  :     :  +- Relation[rid#5214,cpfk_nation_supplier#5215,cfpk_supplier_nation#5216,cval_supplier_s_name#5217,cval_supplier_s_address#5218,cval_supplier_s_phone#5219,cval_supplier_s_acctbal#5220,cval_supplier_s_comment#5221,cs_name#5222,cs_address#5223,cs_phone#5224,cs_acctbal#5225,cs_comment#5226] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#5240 AS rid_2#5273, cpfk_orders_lineitem#5241 AS cpfk_orders_lineitem_2#5274, cpfk_supplier_lineitem#5242 AS cpfk_supplier_lineitem_2#5275, cfpk_lineitem_supplier#5243 AS cfpk_lineitem_supplier_2#5276, cfpk_lineitem_partsupp#5244 AS cfpk_lineitem_partsupp_2#5277, cpfk_part_lineitem#5245 AS cpfk_part_lineitem_2#5278, cfpk_lineitem_part#5246 AS cfpk_lineitem_part_2#5279, cpfk_partsupp_lineitem#5247 AS cpfk_partsupp_lineitem_2#5280, cfpk_lineitem_orders#5248 AS cfpk_lineitem_orders_2#5281, cval_lineitem_l_quantity#5249 AS cval_lineitem_l_quantity_2#5282, cval_lineitem_l_extendedprice#5250 AS cval_lineitem_l_extendedprice_2#5283, cval_lineitem_l_discount#5251 AS cval_lineitem_l_discount_2#5284, cval_lineitem_l_tax#5252 AS cval_lineitem_l_tax_2#5285, cval_lineitem_l_returnflag#5253 AS cval_lineitem_l_returnflag_2#5286, cval_lineitem_l_linestatus#5254 AS cval_lineitem_l_linestatus_2#5287, cval_lineitem_l_commitdate#5255 AS cval_lineitem_l_commitdate_2#5288, cval_lineitem_l_receiptdate#5256 AS cval_lineitem_l_receiptdate_2#5289, cval_lineitem_l_shipinstruct#5257 AS cval_lineitem_l_shipinstruct_2#5290, cval_lineitem_l_shipmode#5258 AS cval_lineitem_l_shipmode_2#5291, cval_lineitem_l_comment#5259 AS cval_lineitem_l_comment_2#5292, cval_lineitem_l_shipdate#5260 AS cval_lineitem_l_shipdate_2#5293, cl_quantity#5261 AS cl_quantity_2#5294, cl_extendedprice#5262 AS cl_extendedprice_2#5295, cl_discount#5263 AS cl_discount_2#5296, ... 9 more fields]
            :     :     :  :        +- Relation[rid#5240,cpfk_orders_lineitem#5241,cpfk_supplier_lineitem#5242,cfpk_lineitem_supplier#5243,cfpk_lineitem_partsupp#5244,cpfk_part_lineitem#5245,cfpk_lineitem_part#5246,cpfk_partsupp_lineitem#5247,cfpk_lineitem_orders#5248,cval_lineitem_l_quantity#5249,cval_lineitem_l_extendedprice#5250,cval_lineitem_l_discount#5251,cval_lineitem_l_tax#5252,cval_lineitem_l_returnflag#5253,cval_lineitem_l_linestatus#5254,cval_lineitem_l_commitdate#5255,cval_lineitem_l_receiptdate#5256,cval_lineitem_l_shipinstruct#5257,cval_lineitem_l_shipmode#5258,cval_lineitem_l_comment#5259,cval_lineitem_l_shipdate#5260,cl_quantity#5261,cl_extendedprice#5262,cl_discount#5263,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#5148 AS rid_2#5181, cpfk_orders_lineitem#5149 AS cpfk_orders_lineitem_2#5182, cpfk_supplier_lineitem#5150 AS cpfk_supplier_lineitem_2#5183, cfpk_lineitem_supplier#5151 AS cfpk_lineitem_supplier_2#5184, cfpk_lineitem_partsupp#5152 AS cfpk_lineitem_partsupp_2#5185, cpfk_part_lineitem#5153 AS cpfk_part_lineitem_2#5186, cfpk_lineitem_part#5154 AS cfpk_lineitem_part_2#5187, cpfk_partsupp_lineitem#5155 AS cpfk_partsupp_lineitem_2#5188, cfpk_lineitem_orders#5156 AS cfpk_lineitem_orders_2#5189, cval_lineitem_l_quantity#5157 AS cval_lineitem_l_quantity_2#5190, cval_lineitem_l_extendedprice#5158 AS cval_lineitem_l_extendedprice_2#5191, cval_lineitem_l_discount#5159 AS cval_lineitem_l_discount_2#5192, cval_lineitem_l_tax#5160 AS cval_lineitem_l_tax_2#5193, cval_lineitem_l_returnflag#5161 AS cval_lineitem_l_returnflag_2#5194, cval_lineitem_l_linestatus#5162 AS cval_lineitem_l_linestatus_2#5195, cval_lineitem_l_commitdate#5163 AS cval_lineitem_l_commitdate_2#5196, cval_lineitem_l_receiptdate#5164 AS cval_lineitem_l_receiptdate_2#5197, cval_lineitem_l_shipinstruct#5165 AS cval_lineitem_l_shipinstruct_2#5198, cval_lineitem_l_shipmode#5166 AS cval_lineitem_l_shipmode_2#5199, cval_lineitem_l_comment#5167 AS cval_lineitem_l_comment_2#5200, cval_lineitem_l_shipdate#5168 AS cval_lineitem_l_shipdate_2#5201, cl_quantity#5169 AS cl_quantity_2#5202, cl_extendedprice#5170 AS cl_extendedprice_2#5203, cl_discount#5171 AS cl_discount_2#5204, ... 9 more fields]
            :     :     :     +- Relation[rid#5148,cpfk_orders_lineitem#5149,cpfk_supplier_lineitem#5150,cfpk_lineitem_supplier#5151,cfpk_lineitem_partsupp#5152,cpfk_part_lineitem#5153,cfpk_lineitem_part#5154,cpfk_partsupp_lineitem#5155,cfpk_lineitem_orders#5156,cval_lineitem_l_quantity#5157,cval_lineitem_l_extendedprice#5158,cval_lineitem_l_discount#5159,cval_lineitem_l_tax#5160,cval_lineitem_l_returnflag#5161,cval_lineitem_l_linestatus#5162,cval_lineitem_l_commitdate#5163,cval_lineitem_l_receiptdate#5164,cval_lineitem_l_shipinstruct#5165,cval_lineitem_l_shipmode#5166,cval_lineitem_l_comment#5167,cval_lineitem_l_shipdate#5168,cl_quantity#5169,cl_extendedprice#5170,cl_discount#5171,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#5306 AS rid_3#5323, cval_part_p_name#5307 AS cval_part_p_name_3#5324, cval_part_p_mfgr#5308 AS cval_part_p_mfgr_3#5325, cval_part_p_type#5309 AS cval_part_p_type_3#5326, cval_part_p_size#5310 AS cval_part_p_size_3#5327, cval_part_p_container#5311 AS cval_part_p_container_3#5328, cval_part_p_retailprice#5312 AS cval_part_p_retailprice_3#5329, cval_part_p_comment#5313 AS cval_part_p_comment_3#5330, cval_part_p_brand#5314 AS cval_part_p_brand_3#5331, cp_name#5315 AS cp_name_3#5332, cp_mfgr#5316 AS cp_mfgr_3#5333, cp_type#5317 AS cp_type_3#5334, cp_size#5318 AS cp_size_3#5335, cp_container#5319 AS cp_container_3#5336, cp_retailprice#5320 AS cp_retailprice_3#5337, cp_comment#5321 AS cp_comment_3#5338, cp_brand#5322 AS cp_brand_3#5339]
            :     :        +- Relation[rid#5306,cval_part_p_name#5307,cval_part_p_mfgr#5308,cval_part_p_type#5309,cval_part_p_size#5310,cval_part_p_container#5311,cval_part_p_retailprice#5312,cval_part_p_comment#5313,cval_part_p_brand#5314,cp_name#5315,cp_mfgr#5316,cp_type#5317,cp_size#5318,cp_container#5319,cp_retailprice#5320,cp_comment#5321,cp_brand#5322] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#5340 AS rid_4#5351, cpfk_part_partsupp#5341 AS cpfk_part_partsupp_4#5352, cfpk_partsupp_part#5342 AS cfpk_partsupp_part_4#5353, cpfk_supplier_partsupp#5343 AS cpfk_supplier_partsupp_4#5354, cfpk_partsupp_supplier#5344 AS cfpk_partsupp_supplier_4#5355, cval_partsupp_ps_availqty#5345 AS cval_partsupp_ps_availqty_4#5356, cval_partsupp_ps_supplycost#5346 AS cval_partsupp_ps_supplycost_4#5357, cval_partsupp_ps_comment#5347 AS cval_partsupp_ps_comment_4#5358, cps_availqty#5348 AS cps_availqty_4#5359, cps_supplycost#5349 AS cps_supplycost_4#5360, cps_comment#5350 AS cps_comment_4#5361]
            :        +- Relation[rid#5340,cpfk_part_partsupp#5341,cfpk_partsupp_part#5342,cpfk_supplier_partsupp#5343,cfpk_partsupp_supplier#5344,cval_partsupp_ps_availqty#5345,cval_partsupp_ps_supplycost#5346,cval_partsupp_ps_comment#5347,cps_availqty#5348,cps_supplycost#5349,cps_comment#5350] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#5362 AS rid_5#5379, cpfk_customer_orders#5363 AS cpfk_customer_orders_5#5380, cfpk_orders_customer#5364 AS cfpk_orders_customer_5#5381, cval_orders_o_orderstatus#5365 AS cval_orders_o_orderstatus_5#5382, cval_orders_o_totalprice#5366 AS cval_orders_o_totalprice_5#5383, cval_orders_o_orderpriority#5367 AS cval_orders_o_orderpriority_5#5384, cval_orders_o_clerk#5368 AS cval_orders_o_clerk_5#5385, cval_orders_o_shippriority#5369 AS cval_orders_o_shippriority_5#5386, cval_orders_o_comment#5370 AS cval_orders_o_comment_5#5387, cval_orders_o_orderdate#5371 AS cval_orders_o_orderdate_5#5388, co_orderstatus#5372 AS co_orderstatus_5#5389, co_totalprice#5373 AS co_totalprice_5#5390, co_orderpriority#5374 AS co_orderpriority_5#5391, co_clerk#5375 AS co_clerk_5#5392, co_shippriority#5376 AS co_shippriority_5#5393, co_comment#5377 AS co_comment_5#5394, co_orderdate#5378 AS co_orderdate_5#5395]
               +- Relation[rid#5362,cpfk_customer_orders#5363,cfpk_orders_customer#5364,cval_orders_o_orderstatus#5365,cval_orders_o_totalprice#5366,cval_orders_o_orderpriority#5367,cval_orders_o_clerk#5368,cval_orders_o_shippriority#5369,cval_orders_o_comment#5370,cval_orders_o_orderdate#5371,co_orderstatus#5372,co_totalprice#5373,co_orderpriority#5374,co_clerk#5375,co_shippriority#5376,co_comment#5377,co_orderdate#5378] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 240711ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/11 05:23:03 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:23:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5500L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 05:23:03 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:23:03 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:23:03 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:23:03 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:23:03 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:23:03 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:23:03 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:23:03 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:23:03 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:23:03 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:23:03 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:23:03 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:23:03 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:23:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5500L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#5502 AS rid_0#5509, cpfk_region_nation#5503 AS cpfk_region_nation_0#5510, cfpk_nation_region#5504 AS cfpk_nation_region_0#5511, cval_nation_n_name#5505 AS cval_nation_n_name_0#5512, cval_nation_n_comment#5506 AS cval_nation_n_comment_0#5513, cn_name#5507 AS cn_name_0#5514, cn_comment#5508 AS cn_comment_0#5515]
         :  :  :  :  :  +- Relation[rid#5502,cpfk_region_nation#5503,cfpk_nation_region#5504,cval_nation_n_name#5505,cval_nation_n_comment#5506,cn_name#5507,cn_comment#5508] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#5516 AS rid_0#5523, cpfk_region_nation#5517 AS cpfk_region_nation_0#5524, cfpk_nation_region#5518 AS cfpk_nation_region_0#5525, cval_nation_n_name#5519 AS cval_nation_n_name_0#5526, cval_nation_n_comment#5520 AS cval_nation_n_comment_0#5527, cn_name#5521 AS cn_name_0#5528, cn_comment#5522 AS cn_comment_0#5529]
         :  :  :  :        +- Relation[rid#5516,cpfk_region_nation#5517,cfpk_nation_region#5518,cval_nation_n_name#5519,cval_nation_n_comment#5520,cn_name#5521,cn_comment#5522] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :     :- Project [rid#5556 AS rid_0#5563, cpfk_region_nation#5557 AS cpfk_region_nation_0#5564, cfpk_nation_region#5558 AS cfpk_nation_region_0#5565, cval_nation_n_name#5559 AS cval_nation_n_name_0#5566, cval_nation_n_comment#5560 AS cval_nation_n_comment_0#5567, cn_name#5561 AS cn_name_0#5568, cn_comment#5562 AS cn_comment_0#5569]
         :  :  :     :  +- Relation[rid#5556,cpfk_region_nation#5557,cfpk_nation_region#5558,cval_nation_n_name#5559,cval_nation_n_comment#5560,cn_name#5561,cn_comment#5562] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#5570 AS rid_1#5583, cpfk_nation_supplier#5571 AS cpfk_nation_supplier_1#5584, cfpk_supplier_nation#5572 AS cfpk_supplier_nation_1#5585, cval_supplier_s_name#5573 AS cval_supplier_s_name_1#5586, cval_supplier_s_address#5574 AS cval_supplier_s_address_1#5587, cval_supplier_s_phone#5575 AS cval_supplier_s_phone_1#5588, cval_supplier_s_acctbal#5576 AS cval_supplier_s_acctbal_1#5589, cval_supplier_s_comment#5577 AS cval_supplier_s_comment_1#5590, cs_name#5578 AS cs_name_1#5591, cs_address#5579 AS cs_address_1#5592, cs_phone#5580 AS cs_phone_1#5593, cs_acctbal#5581 AS cs_acctbal_1#5594, cs_comment#5582 AS cs_comment_1#5595]
         :  :  :        +- Relation[rid#5570,cpfk_nation_supplier#5571,cfpk_supplier_nation#5572,cval_supplier_s_name#5573,cval_supplier_s_address#5574,cval_supplier_s_phone#5575,cval_supplier_s_acctbal#5576,cval_supplier_s_comment#5577,cs_name#5578,cs_address#5579,cs_phone#5580,cs_acctbal#5581,cs_comment#5582] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#5530 AS rid_1#5543, cpfk_nation_supplier#5531 AS cpfk_nation_supplier_1#5544, cfpk_supplier_nation#5532 AS cfpk_supplier_nation_1#5545, cval_supplier_s_name#5533 AS cval_supplier_s_name_1#5546, cval_supplier_s_address#5534 AS cval_supplier_s_address_1#5547, cval_supplier_s_phone#5535 AS cval_supplier_s_phone_1#5548, cval_supplier_s_acctbal#5536 AS cval_supplier_s_acctbal_1#5549, cval_supplier_s_comment#5537 AS cval_supplier_s_comment_1#5550, cs_name#5538 AS cs_name_1#5551, cs_address#5539 AS cs_address_1#5552, cs_phone#5540 AS cs_phone_1#5553, cs_acctbal#5541 AS cs_acctbal_1#5554, cs_comment#5542 AS cs_comment_1#5555]
         :  :     +- Relation[rid#5530,cpfk_nation_supplier#5531,cfpk_supplier_nation#5532,cval_supplier_s_name#5533,cval_supplier_s_address#5534,cval_supplier_s_phone#5535,cval_supplier_s_acctbal#5536,cval_supplier_s_comment#5537,cs_name#5538,cs_address#5539,cs_phone#5540,cs_acctbal#5541,cs_comment#5542] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :     :- Project [rid#5618 AS rid_1#5631, cpfk_nation_supplier#5619 AS cpfk_nation_supplier_1#5632, cfpk_supplier_nation#5620 AS cfpk_supplier_nation_1#5633, cval_supplier_s_name#5621 AS cval_supplier_s_name_1#5634, cval_supplier_s_address#5622 AS cval_supplier_s_address_1#5635, cval_supplier_s_phone#5623 AS cval_supplier_s_phone_1#5636, cval_supplier_s_acctbal#5624 AS cval_supplier_s_acctbal_1#5637, cval_supplier_s_comment#5625 AS cval_supplier_s_comment_1#5638, cs_name#5626 AS cs_name_1#5639, cs_address#5627 AS cs_address_1#5640, cs_phone#5628 AS cs_phone_1#5641, cs_acctbal#5629 AS cs_acctbal_1#5642, cs_comment#5630 AS cs_comment_1#5643]
         :     :  +- Relation[rid#5618,cpfk_nation_supplier#5619,cfpk_supplier_nation#5620,cval_supplier_s_name#5621,cval_supplier_s_address#5622,cval_supplier_s_phone#5623,cval_supplier_s_acctbal#5624,cval_supplier_s_comment#5625,cs_name#5626,cs_address#5627,cs_phone#5628,cs_acctbal#5629,cs_comment#5630] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#5644 AS rid_2#5655, cpfk_part_partsupp#5645 AS cpfk_part_partsupp_2#5656, cfpk_partsupp_part#5646 AS cfpk_partsupp_part_2#5657, cpfk_supplier_partsupp#5647 AS cpfk_supplier_partsupp_2#5658, cfpk_partsupp_supplier#5648 AS cfpk_partsupp_supplier_2#5659, cval_partsupp_ps_availqty#5649 AS cval_partsupp_ps_availqty_2#5660, cval_partsupp_ps_supplycost#5650 AS cval_partsupp_ps_supplycost_2#5661, cval_partsupp_ps_comment#5651 AS cval_partsupp_ps_comment_2#5662, cps_availqty#5652 AS cps_availqty_2#5663, cps_supplycost#5653 AS cps_supplycost_2#5664, cps_comment#5654 AS cps_comment_2#5665]
         :        +- Relation[rid#5644,cpfk_part_partsupp#5645,cfpk_partsupp_part#5646,cpfk_supplier_partsupp#5647,cfpk_partsupp_supplier#5648,cval_partsupp_ps_availqty#5649,cval_partsupp_ps_supplycost#5650,cval_partsupp_ps_comment#5651,cps_availqty#5652,cps_supplycost#5653,cps_comment#5654] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#5596 AS rid_2#5607, cpfk_part_partsupp#5597 AS cpfk_part_partsupp_2#5608, cfpk_partsupp_part#5598 AS cfpk_partsupp_part_2#5609, cpfk_supplier_partsupp#5599 AS cpfk_supplier_partsupp_2#5610, cfpk_partsupp_supplier#5600 AS cfpk_partsupp_supplier_2#5611, cval_partsupp_ps_availqty#5601 AS cval_partsupp_ps_availqty_2#5612, cval_partsupp_ps_supplycost#5602 AS cval_partsupp_ps_supplycost_2#5613, cval_partsupp_ps_comment#5603 AS cval_partsupp_ps_comment_2#5614, cps_availqty#5604 AS cps_availqty_2#5615, cps_supplycost#5605 AS cps_supplycost_2#5616, cps_comment#5606 AS cps_comment_2#5617]
            +- Relation[rid#5596,cpfk_part_partsupp#5597,cfpk_partsupp_part#5598,cpfk_supplier_partsupp#5599,cfpk_partsupp_supplier#5600,cval_partsupp_ps_availqty#5601,cval_partsupp_ps_supplycost#5602,cval_partsupp_ps_comment#5603,cps_availqty#5604,cps_supplycost#5605,cps_comment#5606] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 10566ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/11 05:23:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:23:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5705L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 05:23:13 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 05:23:13 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 05:23:13 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 05:23:13 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 05:23:13 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 05:23:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5705L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#5707 AS rid_0#5722, cpfk_nation_customer#5708 AS cpfk_nation_customer_0#5723, cfpk_customer_nation#5709 AS cfpk_customer_nation_0#5724, cval_customer_c_name#5710 AS cval_customer_c_name_0#5725, cval_customer_c_address#5711 AS cval_customer_c_address_0#5726, cval_customer_c_phone#5712 AS cval_customer_c_phone_0#5727, cval_customer_c_acctbal#5713 AS cval_customer_c_acctbal_0#5728, cval_customer_c_comment#5714 AS cval_customer_c_comment_0#5729, cval_customer_c_mktsegment#5715 AS cval_customer_c_mktsegment_0#5730, cc_name#5716 AS cc_name_0#5731, cc_address#5717 AS cc_address_0#5732, cc_phone#5718 AS cc_phone_0#5733, cc_acctbal#5719 AS cc_acctbal_0#5734, cc_comment#5720 AS cc_comment_0#5735, cc_mktsegment#5721 AS cc_mktsegment_0#5736]
         :  :  :  :  :  +- Relation[rid#5707,cpfk_nation_customer#5708,cfpk_customer_nation#5709,cval_customer_c_name#5710,cval_customer_c_address#5711,cval_customer_c_phone#5712,cval_customer_c_acctbal#5713,cval_customer_c_comment#5714,cval_customer_c_mktsegment#5715,cc_name#5716,cc_address#5717,cc_phone#5718,cc_acctbal#5719,cc_comment#5720,cc_mktsegment#5721] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#5737 AS rid_0#5752, cpfk_nation_customer#5738 AS cpfk_nation_customer_0#5753, cfpk_customer_nation#5739 AS cfpk_customer_nation_0#5754, cval_customer_c_name#5740 AS cval_customer_c_name_0#5755, cval_customer_c_address#5741 AS cval_customer_c_address_0#5756, cval_customer_c_phone#5742 AS cval_customer_c_phone_0#5757, cval_customer_c_acctbal#5743 AS cval_customer_c_acctbal_0#5758, cval_customer_c_comment#5744 AS cval_customer_c_comment_0#5759, cval_customer_c_mktsegment#5745 AS cval_customer_c_mktsegment_0#5760, cc_name#5746 AS cc_name_0#5761, cc_address#5747 AS cc_address_0#5762, cc_phone#5748 AS cc_phone_0#5763, cc_acctbal#5749 AS cc_acctbal_0#5764, cc_comment#5750 AS cc_comment_0#5765, cc_mktsegment#5751 AS cc_mktsegment_0#5766]
         :  :  :  :        +- Relation[rid#5737,cpfk_nation_customer#5738,cfpk_customer_nation#5739,cval_customer_c_name#5740,cval_customer_c_address#5741,cval_customer_c_phone#5742,cval_customer_c_acctbal#5743,cval_customer_c_comment#5744,cval_customer_c_mktsegment#5745,cc_name#5746,cc_address#5747,cc_phone#5748,cc_acctbal#5749,cc_comment#5750,cc_mktsegment#5751] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#5801 AS rid_0#5816, cpfk_nation_customer#5802 AS cpfk_nation_customer_0#5817, cfpk_customer_nation#5803 AS cfpk_customer_nation_0#5818, cval_customer_c_name#5804 AS cval_customer_c_name_0#5819, cval_customer_c_address#5805 AS cval_customer_c_address_0#5820, cval_customer_c_phone#5806 AS cval_customer_c_phone_0#5821, cval_customer_c_acctbal#5807 AS cval_customer_c_acctbal_0#5822, cval_customer_c_comment#5808 AS cval_customer_c_comment_0#5823, cval_customer_c_mktsegment#5809 AS cval_customer_c_mktsegment_0#5824, cc_name#5810 AS cc_name_0#5825, cc_address#5811 AS cc_address_0#5826, cc_phone#5812 AS cc_phone_0#5827, cc_acctbal#5813 AS cc_acctbal_0#5828, cc_comment#5814 AS cc_comment_0#5829, cc_mktsegment#5815 AS cc_mktsegment_0#5830]
         :  :  :     :  +- Relation[rid#5801,cpfk_nation_customer#5802,cfpk_customer_nation#5803,cval_customer_c_name#5804,cval_customer_c_address#5805,cval_customer_c_phone#5806,cval_customer_c_acctbal#5807,cval_customer_c_comment#5808,cval_customer_c_mktsegment#5809,cc_name#5810,cc_address#5811,cc_phone#5812,cc_acctbal#5813,cc_comment#5814,cc_mktsegment#5815] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#5831 AS rid_1#5848, cpfk_customer_orders#5832 AS cpfk_customer_orders_1#5849, cfpk_orders_customer#5833 AS cfpk_orders_customer_1#5850, cval_orders_o_orderstatus#5834 AS cval_orders_o_orderstatus_1#5851, cval_orders_o_totalprice#5835 AS cval_orders_o_totalprice_1#5852, cval_orders_o_orderpriority#5836 AS cval_orders_o_orderpriority_1#5853, cval_orders_o_clerk#5837 AS cval_orders_o_clerk_1#5854, cval_orders_o_shippriority#5838 AS cval_orders_o_shippriority_1#5855, cval_orders_o_comment#5839 AS cval_orders_o_comment_1#5856, cval_orders_o_orderdate#5840 AS cval_orders_o_orderdate_1#5857, co_orderstatus#5841 AS co_orderstatus_1#5858, co_totalprice#5842 AS co_totalprice_1#5859, co_orderpriority#5843 AS co_orderpriority_1#5860, co_clerk#5844 AS co_clerk_1#5861, co_shippriority#5845 AS co_shippriority_1#5862, co_comment#5846 AS co_comment_1#5863, co_orderdate#5847 AS co_orderdate_1#5864]
         :  :  :        +- Relation[rid#5831,cpfk_customer_orders#5832,cfpk_orders_customer#5833,cval_orders_o_orderstatus#5834,cval_orders_o_totalprice#5835,cval_orders_o_orderpriority#5836,cval_orders_o_clerk#5837,cval_orders_o_shippriority#5838,cval_orders_o_comment#5839,cval_orders_o_orderdate#5840,co_orderstatus#5841,co_totalprice#5842,co_orderpriority#5843,co_clerk#5844,co_shippriority#5845,co_comment#5846,co_orderdate#5847] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#5767 AS rid_1#5784, cpfk_customer_orders#5768 AS cpfk_customer_orders_1#5785, cfpk_orders_customer#5769 AS cfpk_orders_customer_1#5786, cval_orders_o_orderstatus#5770 AS cval_orders_o_orderstatus_1#5787, cval_orders_o_totalprice#5771 AS cval_orders_o_totalprice_1#5788, cval_orders_o_orderpriority#5772 AS cval_orders_o_orderpriority_1#5789, cval_orders_o_clerk#5773 AS cval_orders_o_clerk_1#5790, cval_orders_o_shippriority#5774 AS cval_orders_o_shippriority_1#5791, cval_orders_o_comment#5775 AS cval_orders_o_comment_1#5792, cval_orders_o_orderdate#5776 AS cval_orders_o_orderdate_1#5793, co_orderstatus#5777 AS co_orderstatus_1#5794, co_totalprice#5778 AS co_totalprice_1#5795, co_orderpriority#5779 AS co_orderpriority_1#5796, co_clerk#5780 AS co_clerk_1#5797, co_shippriority#5781 AS co_shippriority_1#5798, co_comment#5782 AS co_comment_1#5799, co_orderdate#5783 AS co_orderdate_1#5800]
         :  :     +- Relation[rid#5767,cpfk_customer_orders#5768,cfpk_orders_customer#5769,cval_orders_o_orderstatus#5770,cval_orders_o_totalprice#5771,cval_orders_o_orderpriority#5772,cval_orders_o_clerk#5773,cval_orders_o_shippriority#5774,cval_orders_o_comment#5775,cval_orders_o_orderdate#5776,co_orderstatus#5777,co_totalprice#5778,co_orderpriority#5779,co_clerk#5780,co_shippriority#5781,co_comment#5782,co_orderdate#5783] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#5931 AS rid_1#5948, cpfk_customer_orders#5932 AS cpfk_customer_orders_1#5949, cfpk_orders_customer#5933 AS cfpk_orders_customer_1#5950, cval_orders_o_orderstatus#5934 AS cval_orders_o_orderstatus_1#5951, cval_orders_o_totalprice#5935 AS cval_orders_o_totalprice_1#5952, cval_orders_o_orderpriority#5936 AS cval_orders_o_orderpriority_1#5953, cval_orders_o_clerk#5937 AS cval_orders_o_clerk_1#5954, cval_orders_o_shippriority#5938 AS cval_orders_o_shippriority_1#5955, cval_orders_o_comment#5939 AS cval_orders_o_comment_1#5956, cval_orders_o_orderdate#5940 AS cval_orders_o_orderdate_1#5957, co_orderstatus#5941 AS co_orderstatus_1#5958, co_totalprice#5942 AS co_totalprice_1#5959, co_orderpriority#5943 AS co_orderpriority_1#5960, co_clerk#5944 AS co_clerk_1#5961, co_shippriority#5945 AS co_shippriority_1#5962, co_comment#5946 AS co_comment_1#5963, co_orderdate#5947 AS co_orderdate_1#5964]
         :     :  +- Relation[rid#5931,cpfk_customer_orders#5932,cfpk_orders_customer#5933,cval_orders_o_orderstatus#5934,cval_orders_o_totalprice#5935,cval_orders_o_orderpriority#5936,cval_orders_o_clerk#5937,cval_orders_o_shippriority#5938,cval_orders_o_comment#5939,cval_orders_o_orderdate#5940,co_orderstatus#5941,co_totalprice#5942,co_orderpriority#5943,co_clerk#5944,co_shippriority#5945,co_comment#5946,co_orderdate#5947] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#5965 AS rid_2#5998, cpfk_orders_lineitem#5966 AS cpfk_orders_lineitem_2#5999, cpfk_supplier_lineitem#5967 AS cpfk_supplier_lineitem_2#6000, cfpk_lineitem_supplier#5968 AS cfpk_lineitem_supplier_2#6001, cfpk_lineitem_partsupp#5969 AS cfpk_lineitem_partsupp_2#6002, cpfk_part_lineitem#5970 AS cpfk_part_lineitem_2#6003, cfpk_lineitem_part#5971 AS cfpk_lineitem_part_2#6004, cpfk_partsupp_lineitem#5972 AS cpfk_partsupp_lineitem_2#6005, cfpk_lineitem_orders#5973 AS cfpk_lineitem_orders_2#6006, cval_lineitem_l_quantity#5974 AS cval_lineitem_l_quantity_2#6007, cval_lineitem_l_extendedprice#5975 AS cval_lineitem_l_extendedprice_2#6008, cval_lineitem_l_discount#5976 AS cval_lineitem_l_discount_2#6009, cval_lineitem_l_tax#5977 AS cval_lineitem_l_tax_2#6010, cval_lineitem_l_returnflag#5978 AS cval_lineitem_l_returnflag_2#6011, cval_lineitem_l_linestatus#5979 AS cval_lineitem_l_linestatus_2#6012, cval_lineitem_l_commitdate#5980 AS cval_lineitem_l_commitdate_2#6013, cval_lineitem_l_receiptdate#5981 AS cval_lineitem_l_receiptdate_2#6014, cval_lineitem_l_shipinstruct#5982 AS cval_lineitem_l_shipinstruct_2#6015, cval_lineitem_l_shipmode#5983 AS cval_lineitem_l_shipmode_2#6016, cval_lineitem_l_comment#5984 AS cval_lineitem_l_comment_2#6017, cval_lineitem_l_shipdate#5985 AS cval_lineitem_l_shipdate_2#6018, cl_quantity#5986 AS cl_quantity_2#6019, cl_extendedprice#5987 AS cl_extendedprice_2#6020, cl_discount#5988 AS cl_discount_2#6021, ... 9 more fields]
         :        +- Relation[rid#5965,cpfk_orders_lineitem#5966,cpfk_supplier_lineitem#5967,cfpk_lineitem_supplier#5968,cfpk_lineitem_partsupp#5969,cpfk_part_lineitem#5970,cfpk_lineitem_part#5971,cpfk_partsupp_lineitem#5972,cfpk_lineitem_orders#5973,cval_lineitem_l_quantity#5974,cval_lineitem_l_extendedprice#5975,cval_lineitem_l_discount#5976,cval_lineitem_l_tax#5977,cval_lineitem_l_returnflag#5978,cval_lineitem_l_linestatus#5979,cval_lineitem_l_commitdate#5980,cval_lineitem_l_receiptdate#5981,cval_lineitem_l_shipinstruct#5982,cval_lineitem_l_shipmode#5983,cval_lineitem_l_comment#5984,cval_lineitem_l_shipdate#5985,cl_quantity#5986,cl_extendedprice#5987,cl_discount#5988,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5865 AS rid_2#5898, cpfk_orders_lineitem#5866 AS cpfk_orders_lineitem_2#5899, cpfk_supplier_lineitem#5867 AS cpfk_supplier_lineitem_2#5900, cfpk_lineitem_supplier#5868 AS cfpk_lineitem_supplier_2#5901, cfpk_lineitem_partsupp#5869 AS cfpk_lineitem_partsupp_2#5902, cpfk_part_lineitem#5870 AS cpfk_part_lineitem_2#5903, cfpk_lineitem_part#5871 AS cfpk_lineitem_part_2#5904, cpfk_partsupp_lineitem#5872 AS cpfk_partsupp_lineitem_2#5905, cfpk_lineitem_orders#5873 AS cfpk_lineitem_orders_2#5906, cval_lineitem_l_quantity#5874 AS cval_lineitem_l_quantity_2#5907, cval_lineitem_l_extendedprice#5875 AS cval_lineitem_l_extendedprice_2#5908, cval_lineitem_l_discount#5876 AS cval_lineitem_l_discount_2#5909, cval_lineitem_l_tax#5877 AS cval_lineitem_l_tax_2#5910, cval_lineitem_l_returnflag#5878 AS cval_lineitem_l_returnflag_2#5911, cval_lineitem_l_linestatus#5879 AS cval_lineitem_l_linestatus_2#5912, cval_lineitem_l_commitdate#5880 AS cval_lineitem_l_commitdate_2#5913, cval_lineitem_l_receiptdate#5881 AS cval_lineitem_l_receiptdate_2#5914, cval_lineitem_l_shipinstruct#5882 AS cval_lineitem_l_shipinstruct_2#5915, cval_lineitem_l_shipmode#5883 AS cval_lineitem_l_shipmode_2#5916, cval_lineitem_l_comment#5884 AS cval_lineitem_l_comment_2#5917, cval_lineitem_l_shipdate#5885 AS cval_lineitem_l_shipdate_2#5918, cl_quantity#5886 AS cl_quantity_2#5919, cl_extendedprice#5887 AS cl_extendedprice_2#5920, cl_discount#5888 AS cl_discount_2#5921, ... 9 more fields]
            +- Relation[rid#5865,cpfk_orders_lineitem#5866,cpfk_supplier_lineitem#5867,cfpk_lineitem_supplier#5868,cfpk_lineitem_partsupp#5869,cpfk_part_lineitem#5870,cfpk_lineitem_part#5871,cpfk_partsupp_lineitem#5872,cfpk_lineitem_orders#5873,cval_lineitem_l_quantity#5874,cval_lineitem_l_extendedprice#5875,cval_lineitem_l_discount#5876,cval_lineitem_l_tax#5877,cval_lineitem_l_returnflag#5878,cval_lineitem_l_linestatus#5879,cval_lineitem_l_commitdate#5880,cval_lineitem_l_receiptdate#5881,cval_lineitem_l_shipinstruct#5882,cval_lineitem_l_shipmode#5883,cval_lineitem_l_comment#5884,cval_lineitem_l_shipdate#5885,cl_quantity#5886,cl_extendedprice#5887,cl_discount#5888,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 117138ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/11 05:25:10 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:25:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6108L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 05:25:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:25:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:25:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6108L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#6110 AS rid_0#6143, cpfk_orders_lineitem#6111 AS cpfk_orders_lineitem_0#6144, cpfk_supplier_lineitem#6112 AS cpfk_supplier_lineitem_0#6145, cfpk_lineitem_supplier#6113 AS cfpk_lineitem_supplier_0#6146, cfpk_lineitem_partsupp#6114 AS cfpk_lineitem_partsupp_0#6147, cpfk_part_lineitem#6115 AS cpfk_part_lineitem_0#6148, cfpk_lineitem_part#6116 AS cfpk_lineitem_part_0#6149, cpfk_partsupp_lineitem#6117 AS cpfk_partsupp_lineitem_0#6150, cfpk_lineitem_orders#6118 AS cfpk_lineitem_orders_0#6151, cval_lineitem_l_quantity#6119 AS cval_lineitem_l_quantity_0#6152, cval_lineitem_l_extendedprice#6120 AS cval_lineitem_l_extendedprice_0#6153, cval_lineitem_l_discount#6121 AS cval_lineitem_l_discount_0#6154, cval_lineitem_l_tax#6122 AS cval_lineitem_l_tax_0#6155, cval_lineitem_l_returnflag#6123 AS cval_lineitem_l_returnflag_0#6156, cval_lineitem_l_linestatus#6124 AS cval_lineitem_l_linestatus_0#6157, cval_lineitem_l_commitdate#6125 AS cval_lineitem_l_commitdate_0#6158, cval_lineitem_l_receiptdate#6126 AS cval_lineitem_l_receiptdate_0#6159, cval_lineitem_l_shipinstruct#6127 AS cval_lineitem_l_shipinstruct_0#6160, cval_lineitem_l_shipmode#6128 AS cval_lineitem_l_shipmode_0#6161, cval_lineitem_l_comment#6129 AS cval_lineitem_l_comment_0#6162, cval_lineitem_l_shipdate#6130 AS cval_lineitem_l_shipdate_0#6163, cl_quantity#6131 AS cl_quantity_0#6164, cl_extendedprice#6132 AS cl_extendedprice_0#6165, cl_discount#6133 AS cl_discount_0#6166, ... 9 more fields]
            :     :     :  :  +- Relation[rid#6110,cpfk_orders_lineitem#6111,cpfk_supplier_lineitem#6112,cfpk_lineitem_supplier#6113,cfpk_lineitem_partsupp#6114,cpfk_part_lineitem#6115,cfpk_lineitem_part#6116,cpfk_partsupp_lineitem#6117,cfpk_lineitem_orders#6118,cval_lineitem_l_quantity#6119,cval_lineitem_l_extendedprice#6120,cval_lineitem_l_discount#6121,cval_lineitem_l_tax#6122,cval_lineitem_l_returnflag#6123,cval_lineitem_l_linestatus#6124,cval_lineitem_l_commitdate#6125,cval_lineitem_l_receiptdate#6126,cval_lineitem_l_shipinstruct#6127,cval_lineitem_l_shipmode#6128,cval_lineitem_l_comment#6129,cval_lineitem_l_shipdate#6130,cl_quantity#6131,cl_extendedprice#6132,cl_discount#6133,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#6176 AS rid_0#6209, cpfk_orders_lineitem#6177 AS cpfk_orders_lineitem_0#6210, cpfk_supplier_lineitem#6178 AS cpfk_supplier_lineitem_0#6211, cfpk_lineitem_supplier#6179 AS cfpk_lineitem_supplier_0#6212, cfpk_lineitem_partsupp#6180 AS cfpk_lineitem_partsupp_0#6213, cpfk_part_lineitem#6181 AS cpfk_part_lineitem_0#6214, cfpk_lineitem_part#6182 AS cfpk_lineitem_part_0#6215, cpfk_partsupp_lineitem#6183 AS cpfk_partsupp_lineitem_0#6216, cfpk_lineitem_orders#6184 AS cfpk_lineitem_orders_0#6217, cval_lineitem_l_quantity#6185 AS cval_lineitem_l_quantity_0#6218, cval_lineitem_l_extendedprice#6186 AS cval_lineitem_l_extendedprice_0#6219, cval_lineitem_l_discount#6187 AS cval_lineitem_l_discount_0#6220, cval_lineitem_l_tax#6188 AS cval_lineitem_l_tax_0#6221, cval_lineitem_l_returnflag#6189 AS cval_lineitem_l_returnflag_0#6222, cval_lineitem_l_linestatus#6190 AS cval_lineitem_l_linestatus_0#6223, cval_lineitem_l_commitdate#6191 AS cval_lineitem_l_commitdate_0#6224, cval_lineitem_l_receiptdate#6192 AS cval_lineitem_l_receiptdate_0#6225, cval_lineitem_l_shipinstruct#6193 AS cval_lineitem_l_shipinstruct_0#6226, cval_lineitem_l_shipmode#6194 AS cval_lineitem_l_shipmode_0#6227, cval_lineitem_l_comment#6195 AS cval_lineitem_l_comment_0#6228, cval_lineitem_l_shipdate#6196 AS cval_lineitem_l_shipdate_0#6229, cl_quantity#6197 AS cl_quantity_0#6230, cl_extendedprice#6198 AS cl_extendedprice_0#6231, cl_discount#6199 AS cl_discount_0#6232, ... 9 more fields]
            :     :     :        +- Relation[rid#6176,cpfk_orders_lineitem#6177,cpfk_supplier_lineitem#6178,cfpk_lineitem_supplier#6179,cfpk_lineitem_partsupp#6180,cpfk_part_lineitem#6181,cfpk_lineitem_part#6182,cpfk_partsupp_lineitem#6183,cfpk_lineitem_orders#6184,cval_lineitem_l_quantity#6185,cval_lineitem_l_extendedprice#6186,cval_lineitem_l_discount#6187,cval_lineitem_l_tax#6188,cval_lineitem_l_returnflag#6189,cval_lineitem_l_linestatus#6190,cval_lineitem_l_commitdate#6191,cval_lineitem_l_receiptdate#6192,cval_lineitem_l_shipinstruct#6193,cval_lineitem_l_shipmode#6194,cval_lineitem_l_comment#6195,cval_lineitem_l_shipdate#6196,cl_quantity#6197,cl_extendedprice#6198,cl_discount#6199,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#6242 AS rid_1#6259, cpfk_customer_orders#6243 AS cpfk_customer_orders_1#6260, cfpk_orders_customer#6244 AS cfpk_orders_customer_1#6261, cval_orders_o_orderstatus#6245 AS cval_orders_o_orderstatus_1#6262, cval_orders_o_totalprice#6246 AS cval_orders_o_totalprice_1#6263, cval_orders_o_orderpriority#6247 AS cval_orders_o_orderpriority_1#6264, cval_orders_o_clerk#6248 AS cval_orders_o_clerk_1#6265, cval_orders_o_shippriority#6249 AS cval_orders_o_shippriority_1#6266, cval_orders_o_comment#6250 AS cval_orders_o_comment_1#6267, cval_orders_o_orderdate#6251 AS cval_orders_o_orderdate_1#6268, co_orderstatus#6252 AS co_orderstatus_1#6269, co_totalprice#6253 AS co_totalprice_1#6270, co_orderpriority#6254 AS co_orderpriority_1#6271, co_clerk#6255 AS co_clerk_1#6272, co_shippriority#6256 AS co_shippriority_1#6273, co_comment#6257 AS co_comment_1#6274, co_orderdate#6258 AS co_orderdate_1#6275]
            :     :        +- Relation[rid#6242,cpfk_customer_orders#6243,cfpk_orders_customer#6244,cval_orders_o_orderstatus#6245,cval_orders_o_totalprice#6246,cval_orders_o_orderpriority#6247,cval_orders_o_clerk#6248,cval_orders_o_shippriority#6249,cval_orders_o_comment#6250,cval_orders_o_orderdate#6251,co_orderstatus#6252,co_totalprice#6253,co_orderpriority#6254,co_clerk#6255,co_shippriority#6256,co_comment#6257,co_orderdate#6258] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#6276 AS rid_2#6291, cpfk_nation_customer#6277 AS cpfk_nation_customer_2#6292, cfpk_customer_nation#6278 AS cfpk_customer_nation_2#6293, cval_customer_c_name#6279 AS cval_customer_c_name_2#6294, cval_customer_c_address#6280 AS cval_customer_c_address_2#6295, cval_customer_c_phone#6281 AS cval_customer_c_phone_2#6296, cval_customer_c_acctbal#6282 AS cval_customer_c_acctbal_2#6297, cval_customer_c_comment#6283 AS cval_customer_c_comment_2#6298, cval_customer_c_mktsegment#6284 AS cval_customer_c_mktsegment_2#6299, cc_name#6285 AS cc_name_2#6300, cc_address#6286 AS cc_address_2#6301, cc_phone#6287 AS cc_phone_2#6302, cc_acctbal#6288 AS cc_acctbal_2#6303, cc_comment#6289 AS cc_comment_2#6304, cc_mktsegment#6290 AS cc_mktsegment_2#6305]
            :        +- Relation[rid#6276,cpfk_nation_customer#6277,cfpk_customer_nation#6278,cval_customer_c_name#6279,cval_customer_c_address#6280,cval_customer_c_phone#6281,cval_customer_c_acctbal#6282,cval_customer_c_comment#6283,cval_customer_c_mktsegment#6284,cc_name#6285,cc_address#6286,cc_phone#6287,cc_acctbal#6288,cc_comment#6289,cc_mktsegment#6290] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#6306 AS rid_3#6313, cpfk_region_nation#6307 AS cpfk_region_nation_3#6314, cfpk_nation_region#6308 AS cfpk_nation_region_3#6315, cval_nation_n_name#6309 AS cval_nation_n_name_3#6316, cval_nation_n_comment#6310 AS cval_nation_n_comment_3#6317, cn_name#6311 AS cn_name_3#6318, cn_comment#6312 AS cn_comment_3#6319]
               +- Relation[rid#6306,cpfk_region_nation#6307,cfpk_nation_region#6308,cval_nation_n_name#6309,cval_nation_n_comment#6310,cn_name#6311,cn_comment#6312] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 63533ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/11 05:26:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:26:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6399L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 05:26:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:26:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:26:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:26:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6399L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#6401 AS rid_0#6414, cpfk_nation_supplier#6402 AS cpfk_nation_supplier_0#6415, cfpk_supplier_nation#6403 AS cfpk_supplier_nation_0#6416, cval_supplier_s_name#6404 AS cval_supplier_s_name_0#6417, cval_supplier_s_address#6405 AS cval_supplier_s_address_0#6418, cval_supplier_s_phone#6406 AS cval_supplier_s_phone_0#6419, cval_supplier_s_acctbal#6407 AS cval_supplier_s_acctbal_0#6420, cval_supplier_s_comment#6408 AS cval_supplier_s_comment_0#6421, cs_name#6409 AS cs_name_0#6422, cs_address#6410 AS cs_address_0#6423, cs_phone#6411 AS cs_phone_0#6424, cs_acctbal#6412 AS cs_acctbal_0#6425, cs_comment#6413 AS cs_comment_0#6426]
         :  :  +- Relation[rid#6401,cpfk_nation_supplier#6402,cfpk_supplier_nation#6403,cval_supplier_s_name#6404,cval_supplier_s_address#6405,cval_supplier_s_phone#6406,cval_supplier_s_acctbal#6407,cval_supplier_s_comment#6408,cs_name#6409,cs_address#6410,cs_phone#6411,cs_acctbal#6412,cs_comment#6413] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#6493 AS rid_0#6506, cpfk_nation_supplier#6494 AS cpfk_nation_supplier_0#6507, cfpk_supplier_nation#6495 AS cfpk_supplier_nation_0#6508, cval_supplier_s_name#6496 AS cval_supplier_s_name_0#6509, cval_supplier_s_address#6497 AS cval_supplier_s_address_0#6510, cval_supplier_s_phone#6498 AS cval_supplier_s_phone_0#6511, cval_supplier_s_acctbal#6499 AS cval_supplier_s_acctbal_0#6512, cval_supplier_s_comment#6500 AS cval_supplier_s_comment_0#6513, cs_name#6501 AS cs_name_0#6514, cs_address#6502 AS cs_address_0#6515, cs_phone#6503 AS cs_phone_0#6516, cs_acctbal#6504 AS cs_acctbal_0#6517, cs_comment#6505 AS cs_comment_0#6518]
         :     :  +- Relation[rid#6493,cpfk_nation_supplier#6494,cfpk_supplier_nation#6495,cval_supplier_s_name#6496,cval_supplier_s_address#6497,cval_supplier_s_phone#6498,cval_supplier_s_acctbal#6499,cval_supplier_s_comment#6500,cs_name#6501,cs_address#6502,cs_phone#6503,cs_acctbal#6504,cs_comment#6505] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#6519 AS rid_1#6552, cpfk_orders_lineitem#6520 AS cpfk_orders_lineitem_1#6553, cpfk_supplier_lineitem#6521 AS cpfk_supplier_lineitem_1#6554, cfpk_lineitem_supplier#6522 AS cfpk_lineitem_supplier_1#6555, cfpk_lineitem_partsupp#6523 AS cfpk_lineitem_partsupp_1#6556, cpfk_part_lineitem#6524 AS cpfk_part_lineitem_1#6557, cfpk_lineitem_part#6525 AS cfpk_lineitem_part_1#6558, cpfk_partsupp_lineitem#6526 AS cpfk_partsupp_lineitem_1#6559, cfpk_lineitem_orders#6527 AS cfpk_lineitem_orders_1#6560, cval_lineitem_l_quantity#6528 AS cval_lineitem_l_quantity_1#6561, cval_lineitem_l_extendedprice#6529 AS cval_lineitem_l_extendedprice_1#6562, cval_lineitem_l_discount#6530 AS cval_lineitem_l_discount_1#6563, cval_lineitem_l_tax#6531 AS cval_lineitem_l_tax_1#6564, cval_lineitem_l_returnflag#6532 AS cval_lineitem_l_returnflag_1#6565, cval_lineitem_l_linestatus#6533 AS cval_lineitem_l_linestatus_1#6566, cval_lineitem_l_commitdate#6534 AS cval_lineitem_l_commitdate_1#6567, cval_lineitem_l_receiptdate#6535 AS cval_lineitem_l_receiptdate_1#6568, cval_lineitem_l_shipinstruct#6536 AS cval_lineitem_l_shipinstruct_1#6569, cval_lineitem_l_shipmode#6537 AS cval_lineitem_l_shipmode_1#6570, cval_lineitem_l_comment#6538 AS cval_lineitem_l_comment_1#6571, cval_lineitem_l_shipdate#6539 AS cval_lineitem_l_shipdate_1#6572, cl_quantity#6540 AS cl_quantity_1#6573, cl_extendedprice#6541 AS cl_extendedprice_1#6574, cl_discount#6542 AS cl_discount_1#6575, ... 9 more fields]
         :        +- Relation[rid#6519,cpfk_orders_lineitem#6520,cpfk_supplier_lineitem#6521,cfpk_lineitem_supplier#6522,cfpk_lineitem_partsupp#6523,cpfk_part_lineitem#6524,cfpk_lineitem_part#6525,cpfk_partsupp_lineitem#6526,cfpk_lineitem_orders#6527,cval_lineitem_l_quantity#6528,cval_lineitem_l_extendedprice#6529,cval_lineitem_l_discount#6530,cval_lineitem_l_tax#6531,cval_lineitem_l_returnflag#6532,cval_lineitem_l_linestatus#6533,cval_lineitem_l_commitdate#6534,cval_lineitem_l_receiptdate#6535,cval_lineitem_l_shipinstruct#6536,cval_lineitem_l_shipmode#6537,cval_lineitem_l_comment#6538,cval_lineitem_l_shipdate#6539,cl_quantity#6540,cl_extendedprice#6541,cl_discount#6542,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6427 AS rid_1#6460, cpfk_orders_lineitem#6428 AS cpfk_orders_lineitem_1#6461, cpfk_supplier_lineitem#6429 AS cpfk_supplier_lineitem_1#6462, cfpk_lineitem_supplier#6430 AS cfpk_lineitem_supplier_1#6463, cfpk_lineitem_partsupp#6431 AS cfpk_lineitem_partsupp_1#6464, cpfk_part_lineitem#6432 AS cpfk_part_lineitem_1#6465, cfpk_lineitem_part#6433 AS cfpk_lineitem_part_1#6466, cpfk_partsupp_lineitem#6434 AS cpfk_partsupp_lineitem_1#6467, cfpk_lineitem_orders#6435 AS cfpk_lineitem_orders_1#6468, cval_lineitem_l_quantity#6436 AS cval_lineitem_l_quantity_1#6469, cval_lineitem_l_extendedprice#6437 AS cval_lineitem_l_extendedprice_1#6470, cval_lineitem_l_discount#6438 AS cval_lineitem_l_discount_1#6471, cval_lineitem_l_tax#6439 AS cval_lineitem_l_tax_1#6472, cval_lineitem_l_returnflag#6440 AS cval_lineitem_l_returnflag_1#6473, cval_lineitem_l_linestatus#6441 AS cval_lineitem_l_linestatus_1#6474, cval_lineitem_l_commitdate#6442 AS cval_lineitem_l_commitdate_1#6475, cval_lineitem_l_receiptdate#6443 AS cval_lineitem_l_receiptdate_1#6476, cval_lineitem_l_shipinstruct#6444 AS cval_lineitem_l_shipinstruct_1#6477, cval_lineitem_l_shipmode#6445 AS cval_lineitem_l_shipmode_1#6478, cval_lineitem_l_comment#6446 AS cval_lineitem_l_comment_1#6479, cval_lineitem_l_shipdate#6447 AS cval_lineitem_l_shipdate_1#6480, cl_quantity#6448 AS cl_quantity_1#6481, cl_extendedprice#6449 AS cl_extendedprice_1#6482, cl_discount#6450 AS cl_discount_1#6483, ... 9 more fields]
            +- Relation[rid#6427,cpfk_orders_lineitem#6428,cpfk_supplier_lineitem#6429,cfpk_lineitem_supplier#6430,cfpk_lineitem_partsupp#6431,cpfk_part_lineitem#6432,cfpk_lineitem_part#6433,cpfk_partsupp_lineitem#6434,cfpk_lineitem_orders#6435,cval_lineitem_l_quantity#6436,cval_lineitem_l_extendedprice#6437,cval_lineitem_l_discount#6438,cval_lineitem_l_tax#6439,cval_lineitem_l_returnflag#6440,cval_lineitem_l_linestatus#6441,cval_lineitem_l_commitdate#6442,cval_lineitem_l_receiptdate#6443,cval_lineitem_l_shipinstruct#6444,cval_lineitem_l_shipmode#6445,cval_lineitem_l_comment#6446,cval_lineitem_l_shipdate#6447,cl_quantity#6448,cl_extendedprice#6449,cl_discount#6450,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 78829ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/11 05:27:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:27:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6659L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 05:27:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6659L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#6661 AS rid_0#6694, cpfk_orders_lineitem#6662 AS cpfk_orders_lineitem_0#6695, cpfk_supplier_lineitem#6663 AS cpfk_supplier_lineitem_0#6696, cfpk_lineitem_supplier#6664 AS cfpk_lineitem_supplier_0#6697, cfpk_lineitem_partsupp#6665 AS cfpk_lineitem_partsupp_0#6698, cpfk_part_lineitem#6666 AS cpfk_part_lineitem_0#6699, cfpk_lineitem_part#6667 AS cfpk_lineitem_part_0#6700, cpfk_partsupp_lineitem#6668 AS cpfk_partsupp_lineitem_0#6701, cfpk_lineitem_orders#6669 AS cfpk_lineitem_orders_0#6702, cval_lineitem_l_quantity#6670 AS cval_lineitem_l_quantity_0#6703, cval_lineitem_l_extendedprice#6671 AS cval_lineitem_l_extendedprice_0#6704, cval_lineitem_l_discount#6672 AS cval_lineitem_l_discount_0#6705, cval_lineitem_l_tax#6673 AS cval_lineitem_l_tax_0#6706, cval_lineitem_l_returnflag#6674 AS cval_lineitem_l_returnflag_0#6707, cval_lineitem_l_linestatus#6675 AS cval_lineitem_l_linestatus_0#6708, cval_lineitem_l_commitdate#6676 AS cval_lineitem_l_commitdate_0#6709, cval_lineitem_l_receiptdate#6677 AS cval_lineitem_l_receiptdate_0#6710, cval_lineitem_l_shipinstruct#6678 AS cval_lineitem_l_shipinstruct_0#6711, cval_lineitem_l_shipmode#6679 AS cval_lineitem_l_shipmode_0#6712, cval_lineitem_l_comment#6680 AS cval_lineitem_l_comment_0#6713, cval_lineitem_l_shipdate#6681 AS cval_lineitem_l_shipdate_0#6714, cl_quantity#6682 AS cl_quantity_0#6715, cl_extendedprice#6683 AS cl_extendedprice_0#6716, cl_discount#6684 AS cl_discount_0#6717, ... 9 more fields]
            :  +- Relation[rid#6661,cpfk_orders_lineitem#6662,cpfk_supplier_lineitem#6663,cfpk_lineitem_supplier#6664,cfpk_lineitem_partsupp#6665,cpfk_part_lineitem#6666,cfpk_lineitem_part#6667,cpfk_partsupp_lineitem#6668,cfpk_lineitem_orders#6669,cval_lineitem_l_quantity#6670,cval_lineitem_l_extendedprice#6671,cval_lineitem_l_discount#6672,cval_lineitem_l_tax#6673,cval_lineitem_l_returnflag#6674,cval_lineitem_l_linestatus#6675,cval_lineitem_l_commitdate#6676,cval_lineitem_l_receiptdate#6677,cval_lineitem_l_shipinstruct#6678,cval_lineitem_l_shipmode#6679,cval_lineitem_l_comment#6680,cval_lineitem_l_shipdate#6681,cl_quantity#6682,cl_extendedprice#6683,cl_discount#6684,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#6727 AS rid_1#6744, cpfk_customer_orders#6728 AS cpfk_customer_orders_1#6745, cfpk_orders_customer#6729 AS cfpk_orders_customer_1#6746, cval_orders_o_orderstatus#6730 AS cval_orders_o_orderstatus_1#6747, cval_orders_o_totalprice#6731 AS cval_orders_o_totalprice_1#6748, cval_orders_o_orderpriority#6732 AS cval_orders_o_orderpriority_1#6749, cval_orders_o_clerk#6733 AS cval_orders_o_clerk_1#6750, cval_orders_o_shippriority#6734 AS cval_orders_o_shippriority_1#6751, cval_orders_o_comment#6735 AS cval_orders_o_comment_1#6752, cval_orders_o_orderdate#6736 AS cval_orders_o_orderdate_1#6753, co_orderstatus#6737 AS co_orderstatus_1#6754, co_totalprice#6738 AS co_totalprice_1#6755, co_orderpriority#6739 AS co_orderpriority_1#6756, co_clerk#6740 AS co_clerk_1#6757, co_shippriority#6741 AS co_shippriority_1#6758, co_comment#6742 AS co_comment_1#6759, co_orderdate#6743 AS co_orderdate_1#6760]
               +- Relation[rid#6727,cpfk_customer_orders#6728,cfpk_orders_customer#6729,cval_orders_o_orderstatus#6730,cval_orders_o_totalprice#6731,cval_orders_o_orderpriority#6732,cval_orders_o_clerk#6733,cval_orders_o_shippriority#6734,cval_orders_o_comment#6735,cval_orders_o_orderdate#6736,co_orderstatus#6737,co_totalprice#6738,co_orderpriority#6739,co_clerk#6740,co_shippriority#6741,co_comment#6742,co_orderdate#6743] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 53270ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/11 05:28:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:28:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6818L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 05:28:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:28:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:28:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:28:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:28:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:28:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:28:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:28:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:28:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:28:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:28:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:28:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:28:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:28:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:28:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:28:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6818L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#6820 AS rid_0#6837, cval_part_p_name#6821 AS cval_part_p_name_0#6838, cval_part_p_mfgr#6822 AS cval_part_p_mfgr_0#6839, cval_part_p_type#6823 AS cval_part_p_type_0#6840, cval_part_p_size#6824 AS cval_part_p_size_0#6841, cval_part_p_container#6825 AS cval_part_p_container_0#6842, cval_part_p_retailprice#6826 AS cval_part_p_retailprice_0#6843, cval_part_p_comment#6827 AS cval_part_p_comment_0#6844, cval_part_p_brand#6828 AS cval_part_p_brand_0#6845, cp_name#6829 AS cp_name_0#6846, cp_mfgr#6830 AS cp_mfgr_0#6847, cp_type#6831 AS cp_type_0#6848, cp_size#6832 AS cp_size_0#6849, cp_container#6833 AS cp_container_0#6850, cp_retailprice#6834 AS cp_retailprice_0#6851, cp_comment#6835 AS cp_comment_0#6852, cp_brand#6836 AS cp_brand_0#6853]
            :     :     :  :  :  :  +- Relation[rid#6820,cval_part_p_name#6821,cval_part_p_mfgr#6822,cval_part_p_type#6823,cval_part_p_size#6824,cval_part_p_container#6825,cval_part_p_retailprice#6826,cval_part_p_comment#6827,cval_part_p_brand#6828,cp_name#6829,cp_mfgr#6830,cp_type#6831,cp_size#6832,cp_container#6833,cp_retailprice#6834,cp_comment#6835,cp_brand#6836] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#6854 AS rid_0#6871, cval_part_p_name#6855 AS cval_part_p_name_0#6872, cval_part_p_mfgr#6856 AS cval_part_p_mfgr_0#6873, cval_part_p_type#6857 AS cval_part_p_type_0#6874, cval_part_p_size#6858 AS cval_part_p_size_0#6875, cval_part_p_container#6859 AS cval_part_p_container_0#6876, cval_part_p_retailprice#6860 AS cval_part_p_retailprice_0#6877, cval_part_p_comment#6861 AS cval_part_p_comment_0#6878, cval_part_p_brand#6862 AS cval_part_p_brand_0#6879, cp_name#6863 AS cp_name_0#6880, cp_mfgr#6864 AS cp_mfgr_0#6881, cp_type#6865 AS cp_type_0#6882, cp_size#6866 AS cp_size_0#6883, cp_container#6867 AS cp_container_0#6884, cp_retailprice#6868 AS cp_retailprice_0#6885, cp_comment#6869 AS cp_comment_0#6886, cp_brand#6870 AS cp_brand_0#6887]
            :     :     :  :  :        +- Relation[rid#6854,cval_part_p_name#6855,cval_part_p_mfgr#6856,cval_part_p_type#6857,cval_part_p_size#6858,cval_part_p_container#6859,cval_part_p_retailprice#6860,cval_part_p_comment#6861,cval_part_p_brand#6862,cp_name#6863,cp_mfgr#6864,cp_type#6865,cp_size#6866,cp_container#6867,cp_retailprice#6868,cp_comment#6869,cp_brand#6870] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :     :- Project [rid#6954 AS rid_0#6971, cval_part_p_name#6955 AS cval_part_p_name_0#6972, cval_part_p_mfgr#6956 AS cval_part_p_mfgr_0#6973, cval_part_p_type#6957 AS cval_part_p_type_0#6974, cval_part_p_size#6958 AS cval_part_p_size_0#6975, cval_part_p_container#6959 AS cval_part_p_container_0#6976, cval_part_p_retailprice#6960 AS cval_part_p_retailprice_0#6977, cval_part_p_comment#6961 AS cval_part_p_comment_0#6978, cval_part_p_brand#6962 AS cval_part_p_brand_0#6979, cp_name#6963 AS cp_name_0#6980, cp_mfgr#6964 AS cp_mfgr_0#6981, cp_type#6965 AS cp_type_0#6982, cp_size#6966 AS cp_size_0#6983, cp_container#6967 AS cp_container_0#6984, cp_retailprice#6968 AS cp_retailprice_0#6985, cp_comment#6969 AS cp_comment_0#6986, cp_brand#6970 AS cp_brand_0#6987]
            :     :     :  :     :  +- Relation[rid#6954,cval_part_p_name#6955,cval_part_p_mfgr#6956,cval_part_p_type#6957,cval_part_p_size#6958,cval_part_p_container#6959,cval_part_p_retailprice#6960,cval_part_p_comment#6961,cval_part_p_brand#6962,cp_name#6963,cp_mfgr#6964,cp_type#6965,cp_size#6966,cp_container#6967,cp_retailprice#6968,cp_comment#6969,cp_brand#6970] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :     +- Project [rid#6988 AS rid_1#7021, cpfk_orders_lineitem#6989 AS cpfk_orders_lineitem_1#7022, cpfk_supplier_lineitem#6990 AS cpfk_supplier_lineitem_1#7023, cfpk_lineitem_supplier#6991 AS cfpk_lineitem_supplier_1#7024, cfpk_lineitem_partsupp#6992 AS cfpk_lineitem_partsupp_1#7025, cpfk_part_lineitem#6993 AS cpfk_part_lineitem_1#7026, cfpk_lineitem_part#6994 AS cfpk_lineitem_part_1#7027, cpfk_partsupp_lineitem#6995 AS cpfk_partsupp_lineitem_1#7028, cfpk_lineitem_orders#6996 AS cfpk_lineitem_orders_1#7029, cval_lineitem_l_quantity#6997 AS cval_lineitem_l_quantity_1#7030, cval_lineitem_l_extendedprice#6998 AS cval_lineitem_l_extendedprice_1#7031, cval_lineitem_l_discount#6999 AS cval_lineitem_l_discount_1#7032, cval_lineitem_l_tax#7000 AS cval_lineitem_l_tax_1#7033, cval_lineitem_l_returnflag#7001 AS cval_lineitem_l_returnflag_1#7034, cval_lineitem_l_linestatus#7002 AS cval_lineitem_l_linestatus_1#7035, cval_lineitem_l_commitdate#7003 AS cval_lineitem_l_commitdate_1#7036, cval_lineitem_l_receiptdate#7004 AS cval_lineitem_l_receiptdate_1#7037, cval_lineitem_l_shipinstruct#7005 AS cval_lineitem_l_shipinstruct_1#7038, cval_lineitem_l_shipmode#7006 AS cval_lineitem_l_shipmode_1#7039, cval_lineitem_l_comment#7007 AS cval_lineitem_l_comment_1#7040, cval_lineitem_l_shipdate#7008 AS cval_lineitem_l_shipdate_1#7041, cl_quantity#7009 AS cl_quantity_1#7042, cl_extendedprice#7010 AS cl_extendedprice_1#7043, cl_discount#7011 AS cl_discount_1#7044, ... 9 more fields]
            :     :     :  :        +- Relation[rid#6988,cpfk_orders_lineitem#6989,cpfk_supplier_lineitem#6990,cfpk_lineitem_supplier#6991,cfpk_lineitem_partsupp#6992,cpfk_part_lineitem#6993,cfpk_lineitem_part#6994,cpfk_partsupp_lineitem#6995,cfpk_lineitem_orders#6996,cval_lineitem_l_quantity#6997,cval_lineitem_l_extendedprice#6998,cval_lineitem_l_discount#6999,cval_lineitem_l_tax#7000,cval_lineitem_l_returnflag#7001,cval_lineitem_l_linestatus#7002,cval_lineitem_l_commitdate#7003,cval_lineitem_l_receiptdate#7004,cval_lineitem_l_shipinstruct#7005,cval_lineitem_l_shipmode#7006,cval_lineitem_l_comment#7007,cval_lineitem_l_shipdate#7008,cl_quantity#7009,cl_extendedprice#7010,cl_discount#7011,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#6888 AS rid_1#6921, cpfk_orders_lineitem#6889 AS cpfk_orders_lineitem_1#6922, cpfk_supplier_lineitem#6890 AS cpfk_supplier_lineitem_1#6923, cfpk_lineitem_supplier#6891 AS cfpk_lineitem_supplier_1#6924, cfpk_lineitem_partsupp#6892 AS cfpk_lineitem_partsupp_1#6925, cpfk_part_lineitem#6893 AS cpfk_part_lineitem_1#6926, cfpk_lineitem_part#6894 AS cfpk_lineitem_part_1#6927, cpfk_partsupp_lineitem#6895 AS cpfk_partsupp_lineitem_1#6928, cfpk_lineitem_orders#6896 AS cfpk_lineitem_orders_1#6929, cval_lineitem_l_quantity#6897 AS cval_lineitem_l_quantity_1#6930, cval_lineitem_l_extendedprice#6898 AS cval_lineitem_l_extendedprice_1#6931, cval_lineitem_l_discount#6899 AS cval_lineitem_l_discount_1#6932, cval_lineitem_l_tax#6900 AS cval_lineitem_l_tax_1#6933, cval_lineitem_l_returnflag#6901 AS cval_lineitem_l_returnflag_1#6934, cval_lineitem_l_linestatus#6902 AS cval_lineitem_l_linestatus_1#6935, cval_lineitem_l_commitdate#6903 AS cval_lineitem_l_commitdate_1#6936, cval_lineitem_l_receiptdate#6904 AS cval_lineitem_l_receiptdate_1#6937, cval_lineitem_l_shipinstruct#6905 AS cval_lineitem_l_shipinstruct_1#6938, cval_lineitem_l_shipmode#6906 AS cval_lineitem_l_shipmode_1#6939, cval_lineitem_l_comment#6907 AS cval_lineitem_l_comment_1#6940, cval_lineitem_l_shipdate#6908 AS cval_lineitem_l_shipdate_1#6941, cl_quantity#6909 AS cl_quantity_1#6942, cl_extendedprice#6910 AS cl_extendedprice_1#6943, cl_discount#6911 AS cl_discount_1#6944, ... 9 more fields]
            :     :     :     +- Relation[rid#6888,cpfk_orders_lineitem#6889,cpfk_supplier_lineitem#6890,cfpk_lineitem_supplier#6891,cfpk_lineitem_partsupp#6892,cpfk_part_lineitem#6893,cfpk_lineitem_part#6894,cpfk_partsupp_lineitem#6895,cfpk_lineitem_orders#6896,cval_lineitem_l_quantity#6897,cval_lineitem_l_extendedprice#6898,cval_lineitem_l_discount#6899,cval_lineitem_l_tax#6900,cval_lineitem_l_returnflag#6901,cval_lineitem_l_linestatus#6902,cval_lineitem_l_commitdate#6903,cval_lineitem_l_receiptdate#6904,cval_lineitem_l_shipinstruct#6905,cval_lineitem_l_shipmode#6906,cval_lineitem_l_comment#6907,cval_lineitem_l_shipdate#6908,cl_quantity#6909,cl_extendedprice#6910,cl_discount#6911,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#7054 AS rid_2#7067, cpfk_nation_supplier#7055 AS cpfk_nation_supplier_2#7068, cfpk_supplier_nation#7056 AS cfpk_supplier_nation_2#7069, cval_supplier_s_name#7057 AS cval_supplier_s_name_2#7070, cval_supplier_s_address#7058 AS cval_supplier_s_address_2#7071, cval_supplier_s_phone#7059 AS cval_supplier_s_phone_2#7072, cval_supplier_s_acctbal#7060 AS cval_supplier_s_acctbal_2#7073, cval_supplier_s_comment#7061 AS cval_supplier_s_comment_2#7074, cs_name#7062 AS cs_name_2#7075, cs_address#7063 AS cs_address_2#7076, cs_phone#7064 AS cs_phone_2#7077, cs_acctbal#7065 AS cs_acctbal_2#7078, cs_comment#7066 AS cs_comment_2#7079]
            :     :        +- Relation[rid#7054,cpfk_nation_supplier#7055,cfpk_supplier_nation#7056,cval_supplier_s_name#7057,cval_supplier_s_address#7058,cval_supplier_s_phone#7059,cval_supplier_s_acctbal#7060,cval_supplier_s_comment#7061,cs_name#7062,cs_address#7063,cs_phone#7064,cs_acctbal#7065,cs_comment#7066] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#7080 AS rid_3#7087, cpfk_region_nation#7081 AS cpfk_region_nation_3#7088, cfpk_nation_region#7082 AS cfpk_nation_region_3#7089, cval_nation_n_name#7083 AS cval_nation_n_name_3#7090, cval_nation_n_comment#7084 AS cval_nation_n_comment_3#7091, cn_name#7085 AS cn_name_3#7092, cn_comment#7086 AS cn_comment_3#7093]
            :        +- Relation[rid#7080,cpfk_region_nation#7081,cfpk_nation_region#7082,cval_nation_n_name#7083,cval_nation_n_comment#7084,cn_name#7085,cn_comment#7086] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'Join UsingJoin(Inner,List(rid_6))
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#7094 AS rid_4#7099, cval_region_r_name#7095 AS cval_region_r_name_4#7100, cval_region_r_comment#7096 AS cval_region_r_comment_4#7101, cr_name#7097 AS cr_name_4#7102, cr_comment#7098 AS cr_comment_4#7103]
               :  :  :  :  :  :  :  +- Relation[rid#7094,cval_region_r_name#7095,cval_region_r_comment#7096,cr_name#7097,cr_comment#7098] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#7104 AS rid_4#7109, cval_region_r_name#7105 AS cval_region_r_name_4#7110, cval_region_r_comment#7106 AS cval_region_r_comment_4#7111, cr_name#7107 AS cr_name_4#7112, cr_comment#7108 AS cr_comment_4#7113]
               :  :  :  :  :  :        +- Relation[rid#7104,cval_region_r_name#7105,cval_region_r_comment#7106,cr_name#7107,cr_comment#7108] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :     :- Project [rid#7128 AS rid_4#7133, cval_region_r_name#7129 AS cval_region_r_name_4#7134, cval_region_r_comment#7130 AS cval_region_r_comment_4#7135, cr_name#7131 AS cr_name_4#7136, cr_comment#7132 AS cr_comment_4#7137]
               :  :  :  :  :     :  +- Relation[rid#7128,cval_region_r_name#7129,cval_region_r_comment#7130,cr_name#7131,cr_comment#7132] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :     +- Project [rid#7138 AS rid_5#7145, cpfk_region_nation#7139 AS cpfk_region_nation_5#7146, cfpk_nation_region#7140 AS cfpk_nation_region_5#7147, cval_nation_n_name#7141 AS cval_nation_n_name_5#7148, cval_nation_n_comment#7142 AS cval_nation_n_comment_5#7149, cn_name#7143 AS cn_name_5#7150, cn_comment#7144 AS cn_comment_5#7151]
               :  :  :  :  :        +- Relation[rid#7138,cpfk_region_nation#7139,cfpk_nation_region#7140,cval_nation_n_name#7141,cval_nation_n_comment#7142,cn_name#7143,cn_comment#7144] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#7114 AS rid_5#7121, cpfk_region_nation#7115 AS cpfk_region_nation_5#7122, cfpk_nation_region#7116 AS cfpk_nation_region_5#7123, cval_nation_n_name#7117 AS cval_nation_n_name_5#7124, cval_nation_n_comment#7118 AS cval_nation_n_comment_5#7125, cn_name#7119 AS cn_name_5#7126, cn_comment#7120 AS cn_comment_5#7127]
               :  :  :  :     +- Relation[rid#7114,cpfk_region_nation#7115,cfpk_nation_region#7116,cval_nation_n_name#7117,cval_nation_n_comment#7118,cn_name#7119,cn_comment#7120] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :     :- Project [rid#7182 AS rid_5#7189, cpfk_region_nation#7183 AS cpfk_region_nation_5#7190, cfpk_nation_region#7184 AS cfpk_nation_region_5#7191, cval_nation_n_name#7185 AS cval_nation_n_name_5#7192, cval_nation_n_comment#7186 AS cval_nation_n_comment_5#7193, cn_name#7187 AS cn_name_5#7194, cn_comment#7188 AS cn_comment_5#7195]
               :  :  :     :  +- Relation[rid#7182,cpfk_region_nation#7183,cfpk_nation_region#7184,cval_nation_n_name#7185,cval_nation_n_comment#7186,cn_name#7187,cn_comment#7188] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#7196 AS rid_6#7211, cpfk_nation_customer#7197 AS cpfk_nation_customer_6#7212, cfpk_customer_nation#7198 AS cfpk_customer_nation_6#7213, cval_customer_c_name#7199 AS cval_customer_c_name_6#7214, cval_customer_c_address#7200 AS cval_customer_c_address_6#7215, cval_customer_c_phone#7201 AS cval_customer_c_phone_6#7216, cval_customer_c_acctbal#7202 AS cval_customer_c_acctbal_6#7217, cval_customer_c_comment#7203 AS cval_customer_c_comment_6#7218, cval_customer_c_mktsegment#7204 AS cval_customer_c_mktsegment_6#7219, cc_name#7205 AS cc_name_6#7220, cc_address#7206 AS cc_address_6#7221, cc_phone#7207 AS cc_phone_6#7222, cc_acctbal#7208 AS cc_acctbal_6#7223, cc_comment#7209 AS cc_comment_6#7224, cc_mktsegment#7210 AS cc_mktsegment_6#7225]
               :  :  :        +- Relation[rid#7196,cpfk_nation_customer#7197,cfpk_customer_nation#7198,cval_customer_c_name#7199,cval_customer_c_address#7200,cval_customer_c_phone#7201,cval_customer_c_acctbal#7202,cval_customer_c_comment#7203,cval_customer_c_mktsegment#7204,cc_name#7205,cc_address#7206,cc_phone#7207,cc_acctbal#7208,cc_comment#7209,cc_mktsegment#7210] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#7152 AS rid_6#7167, cpfk_nation_customer#7153 AS cpfk_nation_customer_6#7168, cfpk_customer_nation#7154 AS cfpk_customer_nation_6#7169, cval_customer_c_name#7155 AS cval_customer_c_name_6#7170, cval_customer_c_address#7156 AS cval_customer_c_address_6#7171, cval_customer_c_phone#7157 AS cval_customer_c_phone_6#7172, cval_customer_c_acctbal#7158 AS cval_customer_c_acctbal_6#7173, cval_customer_c_comment#7159 AS cval_customer_c_comment_6#7174, cval_customer_c_mktsegment#7160 AS cval_customer_c_mktsegment_6#7175, cc_name#7161 AS cc_name_6#7176, cc_address#7162 AS cc_address_6#7177, cc_phone#7163 AS cc_phone_6#7178, cc_acctbal#7164 AS cc_acctbal_6#7179, cc_comment#7165 AS cc_comment_6#7180, cc_mktsegment#7166 AS cc_mktsegment_6#7181]
               :  :     +- Relation[rid#7152,cpfk_nation_customer#7153,cfpk_customer_nation#7154,cval_customer_c_name#7155,cval_customer_c_address#7156,cval_customer_c_phone#7157,cval_customer_c_acctbal#7158,cval_customer_c_comment#7159,cval_customer_c_mktsegment#7160,cc_name#7161,cc_address#7162,cc_phone#7163,cc_acctbal#7164,cc_comment#7165,cc_mktsegment#7166] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :     :- Project [rid#7260 AS rid_6#7275, cpfk_nation_customer#7261 AS cpfk_nation_customer_6#7276, cfpk_customer_nation#7262 AS cfpk_customer_nation_6#7277, cval_customer_c_name#7263 AS cval_customer_c_name_6#7278, cval_customer_c_address#7264 AS cval_customer_c_address_6#7279, cval_customer_c_phone#7265 AS cval_customer_c_phone_6#7280, cval_customer_c_acctbal#7266 AS cval_customer_c_acctbal_6#7281, cval_customer_c_comment#7267 AS cval_customer_c_comment_6#7282, cval_customer_c_mktsegment#7268 AS cval_customer_c_mktsegment_6#7283, cc_name#7269 AS cc_name_6#7284, cc_address#7270 AS cc_address_6#7285, cc_phone#7271 AS cc_phone_6#7286, cc_acctbal#7272 AS cc_acctbal_6#7287, cc_comment#7273 AS cc_comment_6#7288, cc_mktsegment#7274 AS cc_mktsegment_6#7289]
               :     :  +- Relation[rid#7260,cpfk_nation_customer#7261,cfpk_customer_nation#7262,cval_customer_c_name#7263,cval_customer_c_address#7264,cval_customer_c_phone#7265,cval_customer_c_acctbal#7266,cval_customer_c_comment#7267,cval_customer_c_mktsegment#7268,cc_name#7269,cc_address#7270,cc_phone#7271,cc_acctbal#7272,cc_comment#7273,cc_mktsegment#7274] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#7290 AS rid_7#7307, cpfk_customer_orders#7291 AS cpfk_customer_orders_7#7308, cfpk_orders_customer#7292 AS cfpk_orders_customer_7#7309, cval_orders_o_orderstatus#7293 AS cval_orders_o_orderstatus_7#7310, cval_orders_o_totalprice#7294 AS cval_orders_o_totalprice_7#7311, cval_orders_o_orderpriority#7295 AS cval_orders_o_orderpriority_7#7312, cval_orders_o_clerk#7296 AS cval_orders_o_clerk_7#7313, cval_orders_o_shippriority#7297 AS cval_orders_o_shippriority_7#7314, cval_orders_o_comment#7298 AS cval_orders_o_comment_7#7315, cval_orders_o_orderdate#7299 AS cval_orders_o_orderdate_7#7316, co_orderstatus#7300 AS co_orderstatus_7#7317, co_totalprice#7301 AS co_totalprice_7#7318, co_orderpriority#7302 AS co_orderpriority_7#7319, co_clerk#7303 AS co_clerk_7#7320, co_shippriority#7304 AS co_shippriority_7#7321, co_comment#7305 AS co_comment_7#7322, co_orderdate#7306 AS co_orderdate_7#7323]
               :        +- Relation[rid#7290,cpfk_customer_orders#7291,cfpk_orders_customer#7292,cval_orders_o_orderstatus#7293,cval_orders_o_totalprice#7294,cval_orders_o_orderpriority#7295,cval_orders_o_clerk#7296,cval_orders_o_shippriority#7297,cval_orders_o_comment#7298,cval_orders_o_orderdate#7299,co_orderstatus#7300,co_totalprice#7301,co_orderpriority#7302,co_clerk#7303,co_shippriority#7304,co_comment#7305,co_orderdate#7306] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#7226 AS rid_7#7243, cpfk_customer_orders#7227 AS cpfk_customer_orders_7#7244, cfpk_orders_customer#7228 AS cfpk_orders_customer_7#7245, cval_orders_o_orderstatus#7229 AS cval_orders_o_orderstatus_7#7246, cval_orders_o_totalprice#7230 AS cval_orders_o_totalprice_7#7247, cval_orders_o_orderpriority#7231 AS cval_orders_o_orderpriority_7#7248, cval_orders_o_clerk#7232 AS cval_orders_o_clerk_7#7249, cval_orders_o_shippriority#7233 AS cval_orders_o_shippriority_7#7250, cval_orders_o_comment#7234 AS cval_orders_o_comment_7#7251, cval_orders_o_orderdate#7235 AS cval_orders_o_orderdate_7#7252, co_orderstatus#7236 AS co_orderstatus_7#7253, co_totalprice#7237 AS co_totalprice_7#7254, co_orderpriority#7238 AS co_orderpriority_7#7255, co_clerk#7239 AS co_clerk_7#7256, co_shippriority#7240 AS co_shippriority_7#7257, co_comment#7241 AS co_comment_7#7258, co_orderdate#7242 AS co_orderdate_7#7259]
                  +- Relation[rid#7226,cpfk_customer_orders#7227,cfpk_orders_customer#7228,cval_orders_o_orderstatus#7229,cval_orders_o_totalprice#7230,cval_orders_o_orderpriority#7231,cval_orders_o_clerk#7232,cval_orders_o_shippriority#7233,cval_orders_o_comment#7234,cval_orders_o_orderdate#7235,co_orderstatus#7236,co_totalprice#7237,co_orderpriority#7238,co_clerk#7239,co_shippriority#7240,co_comment#7241,co_orderdate#7242] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 96275ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/11 05:30:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:30:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7443L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 05:30:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#7443L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#7445 AS rid_0#7478, cpfk_orders_lineitem#7446 AS cpfk_orders_lineitem_0#7479, cpfk_supplier_lineitem#7447 AS cpfk_supplier_lineitem_0#7480, cfpk_lineitem_supplier#7448 AS cfpk_lineitem_supplier_0#7481, cfpk_lineitem_partsupp#7449 AS cfpk_lineitem_partsupp_0#7482, cpfk_part_lineitem#7450 AS cpfk_part_lineitem_0#7483, cfpk_lineitem_part#7451 AS cfpk_lineitem_part_0#7484, cpfk_partsupp_lineitem#7452 AS cpfk_partsupp_lineitem_0#7485, cfpk_lineitem_orders#7453 AS cfpk_lineitem_orders_0#7486, cval_lineitem_l_quantity#7454 AS cval_lineitem_l_quantity_0#7487, cval_lineitem_l_extendedprice#7455 AS cval_lineitem_l_extendedprice_0#7488, cval_lineitem_l_discount#7456 AS cval_lineitem_l_discount_0#7489, cval_lineitem_l_tax#7457 AS cval_lineitem_l_tax_0#7490, cval_lineitem_l_returnflag#7458 AS cval_lineitem_l_returnflag_0#7491, cval_lineitem_l_linestatus#7459 AS cval_lineitem_l_linestatus_0#7492, cval_lineitem_l_commitdate#7460 AS cval_lineitem_l_commitdate_0#7493, cval_lineitem_l_receiptdate#7461 AS cval_lineitem_l_receiptdate_0#7494, cval_lineitem_l_shipinstruct#7462 AS cval_lineitem_l_shipinstruct_0#7495, cval_lineitem_l_shipmode#7463 AS cval_lineitem_l_shipmode_0#7496, cval_lineitem_l_comment#7464 AS cval_lineitem_l_comment_0#7497, cval_lineitem_l_shipdate#7465 AS cval_lineitem_l_shipdate_0#7498, cl_quantity#7466 AS cl_quantity_0#7499, cl_extendedprice#7467 AS cl_extendedprice_0#7500, cl_discount#7468 AS cl_discount_0#7501, ... 9 more fields]
         +- Relation[rid#7445,cpfk_orders_lineitem#7446,cpfk_supplier_lineitem#7447,cfpk_lineitem_supplier#7448,cfpk_lineitem_partsupp#7449,cpfk_part_lineitem#7450,cfpk_lineitem_part#7451,cpfk_partsupp_lineitem#7452,cfpk_lineitem_orders#7453,cval_lineitem_l_quantity#7454,cval_lineitem_l_extendedprice#7455,cval_lineitem_l_discount#7456,cval_lineitem_l_tax#7457,cval_lineitem_l_returnflag#7458,cval_lineitem_l_linestatus#7459,cval_lineitem_l_commitdate#7460,cval_lineitem_l_receiptdate#7461,cval_lineitem_l_shipinstruct#7462,cval_lineitem_l_shipmode#7463,cval_lineitem_l_comment#7464,cval_lineitem_l_shipdate#7465,cl_quantity#7466,cl_extendedprice#7467,cl_discount#7468,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 3081ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/11 05:30:05 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:30:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7551L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 05:30:05 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:30:05 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:30:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:30:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7551L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#7553 AS rid_0#7570, cval_part_p_name#7554 AS cval_part_p_name_0#7571, cval_part_p_mfgr#7555 AS cval_part_p_mfgr_0#7572, cval_part_p_type#7556 AS cval_part_p_type_0#7573, cval_part_p_size#7557 AS cval_part_p_size_0#7574, cval_part_p_container#7558 AS cval_part_p_container_0#7575, cval_part_p_retailprice#7559 AS cval_part_p_retailprice_0#7576, cval_part_p_comment#7560 AS cval_part_p_comment_0#7577, cval_part_p_brand#7561 AS cval_part_p_brand_0#7578, cp_name#7562 AS cp_name_0#7579, cp_mfgr#7563 AS cp_mfgr_0#7580, cp_type#7564 AS cp_type_0#7581, cp_size#7565 AS cp_size_0#7582, cp_container#7566 AS cp_container_0#7583, cp_retailprice#7567 AS cp_retailprice_0#7584, cp_comment#7568 AS cp_comment_0#7585, cp_brand#7569 AS cp_brand_0#7586]
         :  :  :  +- Relation[rid#7553,cval_part_p_name#7554,cval_part_p_mfgr#7555,cval_part_p_type#7556,cval_part_p_size#7557,cval_part_p_container#7558,cval_part_p_retailprice#7559,cval_part_p_comment#7560,cval_part_p_brand#7561,cp_name#7562,cp_mfgr#7563,cp_type#7564,cp_size#7565,cp_container#7566,cp_retailprice#7567,cp_comment#7568,cp_brand#7569] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#7587 AS rid_0#7604, cval_part_p_name#7588 AS cval_part_p_name_0#7605, cval_part_p_mfgr#7589 AS cval_part_p_mfgr_0#7606, cval_part_p_type#7590 AS cval_part_p_type_0#7607, cval_part_p_size#7591 AS cval_part_p_size_0#7608, cval_part_p_container#7592 AS cval_part_p_container_0#7609, cval_part_p_retailprice#7593 AS cval_part_p_retailprice_0#7610, cval_part_p_comment#7594 AS cval_part_p_comment_0#7611, cval_part_p_brand#7595 AS cval_part_p_brand_0#7612, cp_name#7596 AS cp_name_0#7613, cp_mfgr#7597 AS cp_mfgr_0#7614, cp_type#7598 AS cp_type_0#7615, cp_size#7599 AS cp_size_0#7616, cp_container#7600 AS cp_container_0#7617, cp_retailprice#7601 AS cp_retailprice_0#7618, cp_comment#7602 AS cp_comment_0#7619, cp_brand#7603 AS cp_brand_0#7620]
         :  :        +- Relation[rid#7587,cval_part_p_name#7588,cval_part_p_mfgr#7589,cval_part_p_type#7590,cval_part_p_size#7591,cval_part_p_container#7592,cval_part_p_retailprice#7593,cval_part_p_comment#7594,cval_part_p_brand#7595,cp_name#7596,cp_mfgr#7597,cp_type#7598,cp_size#7599,cp_container#7600,cp_retailprice#7601,cp_comment#7602,cp_brand#7603] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :     :- Project [rid#7643 AS rid_0#7660, cval_part_p_name#7644 AS cval_part_p_name_0#7661, cval_part_p_mfgr#7645 AS cval_part_p_mfgr_0#7662, cval_part_p_type#7646 AS cval_part_p_type_0#7663, cval_part_p_size#7647 AS cval_part_p_size_0#7664, cval_part_p_container#7648 AS cval_part_p_container_0#7665, cval_part_p_retailprice#7649 AS cval_part_p_retailprice_0#7666, cval_part_p_comment#7650 AS cval_part_p_comment_0#7667, cval_part_p_brand#7651 AS cval_part_p_brand_0#7668, cp_name#7652 AS cp_name_0#7669, cp_mfgr#7653 AS cp_mfgr_0#7670, cp_type#7654 AS cp_type_0#7671, cp_size#7655 AS cp_size_0#7672, cp_container#7656 AS cp_container_0#7673, cp_retailprice#7657 AS cp_retailprice_0#7674, cp_comment#7658 AS cp_comment_0#7675, cp_brand#7659 AS cp_brand_0#7676]
         :     :  +- Relation[rid#7643,cval_part_p_name#7644,cval_part_p_mfgr#7645,cval_part_p_type#7646,cval_part_p_size#7647,cval_part_p_container#7648,cval_part_p_retailprice#7649,cval_part_p_comment#7650,cval_part_p_brand#7651,cp_name#7652,cp_mfgr#7653,cp_type#7654,cp_size#7655,cp_container#7656,cp_retailprice#7657,cp_comment#7658,cp_brand#7659] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#7677 AS rid_1#7688, cpfk_part_partsupp#7678 AS cpfk_part_partsupp_1#7689, cfpk_partsupp_part#7679 AS cfpk_partsupp_part_1#7690, cpfk_supplier_partsupp#7680 AS cpfk_supplier_partsupp_1#7691, cfpk_partsupp_supplier#7681 AS cfpk_partsupp_supplier_1#7692, cval_partsupp_ps_availqty#7682 AS cval_partsupp_ps_availqty_1#7693, cval_partsupp_ps_supplycost#7683 AS cval_partsupp_ps_supplycost_1#7694, cval_partsupp_ps_comment#7684 AS cval_partsupp_ps_comment_1#7695, cps_availqty#7685 AS cps_availqty_1#7696, cps_supplycost#7686 AS cps_supplycost_1#7697, cps_comment#7687 AS cps_comment_1#7698]
         :        +- Relation[rid#7677,cpfk_part_partsupp#7678,cfpk_partsupp_part#7679,cpfk_supplier_partsupp#7680,cfpk_partsupp_supplier#7681,cval_partsupp_ps_availqty#7682,cval_partsupp_ps_supplycost#7683,cval_partsupp_ps_comment#7684,cps_availqty#7685,cps_supplycost#7686,cps_comment#7687] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#7621 AS rid_1#7632, cpfk_part_partsupp#7622 AS cpfk_part_partsupp_1#7633, cfpk_partsupp_part#7623 AS cfpk_partsupp_part_1#7634, cpfk_supplier_partsupp#7624 AS cpfk_supplier_partsupp_1#7635, cfpk_partsupp_supplier#7625 AS cfpk_partsupp_supplier_1#7636, cval_partsupp_ps_availqty#7626 AS cval_partsupp_ps_availqty_1#7637, cval_partsupp_ps_supplycost#7627 AS cval_partsupp_ps_supplycost_1#7638, cval_partsupp_ps_comment#7628 AS cval_partsupp_ps_comment_1#7639, cps_availqty#7629 AS cps_availqty_1#7640, cps_supplycost#7630 AS cps_supplycost_1#7641, cps_comment#7631 AS cps_comment_1#7642]
            +- Relation[rid#7621,cpfk_part_partsupp#7622,cfpk_partsupp_part#7623,cpfk_supplier_partsupp#7624,cfpk_partsupp_supplier#7625,cval_partsupp_ps_availqty#7626,cval_partsupp_ps_supplycost#7627,cval_partsupp_ps_comment#7628,cps_availqty#7629,cps_supplycost#7630,cps_comment#7631] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 11325ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 05:30:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:30:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7736L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 05:30:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:30:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:30:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:30:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:30:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:30:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:30:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:30:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:30:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:30:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:30:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:30:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:30:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:30:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:30:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:30:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:30:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7736L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#7738 AS rid_0#7745, cpfk_region_nation#7739 AS cpfk_region_nation_0#7746, cfpk_nation_region#7740 AS cfpk_nation_region_0#7747, cval_nation_n_name#7741 AS cval_nation_n_name_0#7748, cval_nation_n_comment#7742 AS cval_nation_n_comment_0#7749, cn_name#7743 AS cn_name_0#7750, cn_comment#7744 AS cn_comment_0#7751]
            :  :  :     :  :  :  :  :  +- Relation[rid#7738,cpfk_region_nation#7739,cfpk_nation_region#7740,cval_nation_n_name#7741,cval_nation_n_comment#7742,cn_name#7743,cn_comment#7744] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#7778 AS rid_0#7785, cpfk_region_nation#7779 AS cpfk_region_nation_0#7786, cfpk_nation_region#7780 AS cfpk_nation_region_0#7787, cval_nation_n_name#7781 AS cval_nation_n_name_0#7788, cval_nation_n_comment#7782 AS cval_nation_n_comment_0#7789, cn_name#7783 AS cn_name_0#7790, cn_comment#7784 AS cn_comment_0#7791]
            :  :  :     :  :  :  :     :  +- Relation[rid#7778,cpfk_region_nation#7779,cfpk_nation_region#7780,cval_nation_n_name#7781,cval_nation_n_comment#7782,cn_name#7783,cn_comment#7784] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#7792 AS rid_1#7805, cpfk_nation_supplier#7793 AS cpfk_nation_supplier_1#7806, cfpk_supplier_nation#7794 AS cfpk_supplier_nation_1#7807, cval_supplier_s_name#7795 AS cval_supplier_s_name_1#7808, cval_supplier_s_address#7796 AS cval_supplier_s_address_1#7809, cval_supplier_s_phone#7797 AS cval_supplier_s_phone_1#7810, cval_supplier_s_acctbal#7798 AS cval_supplier_s_acctbal_1#7811, cval_supplier_s_comment#7799 AS cval_supplier_s_comment_1#7812, cs_name#7800 AS cs_name_1#7813, cs_address#7801 AS cs_address_1#7814, cs_phone#7802 AS cs_phone_1#7815, cs_acctbal#7803 AS cs_acctbal_1#7816, cs_comment#7804 AS cs_comment_1#7817]
            :  :  :     :  :  :  :        +- Relation[rid#7792,cpfk_nation_supplier#7793,cfpk_supplier_nation#7794,cval_supplier_s_name#7795,cval_supplier_s_address#7796,cval_supplier_s_phone#7797,cval_supplier_s_acctbal#7798,cval_supplier_s_comment#7799,cs_name#7800,cs_address#7801,cs_phone#7802,cs_acctbal#7803,cs_comment#7804] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#7752 AS rid_1#7765, cpfk_nation_supplier#7753 AS cpfk_nation_supplier_1#7766, cfpk_supplier_nation#7754 AS cfpk_supplier_nation_1#7767, cval_supplier_s_name#7755 AS cval_supplier_s_name_1#7768, cval_supplier_s_address#7756 AS cval_supplier_s_address_1#7769, cval_supplier_s_phone#7757 AS cval_supplier_s_phone_1#7770, cval_supplier_s_acctbal#7758 AS cval_supplier_s_acctbal_1#7771, cval_supplier_s_comment#7759 AS cval_supplier_s_comment_1#7772, cs_name#7760 AS cs_name_1#7773, cs_address#7761 AS cs_address_1#7774, cs_phone#7762 AS cs_phone_1#7775, cs_acctbal#7763 AS cs_acctbal_1#7776, cs_comment#7764 AS cs_comment_1#7777]
            :  :  :     :  :  :     +- Relation[rid#7752,cpfk_nation_supplier#7753,cfpk_supplier_nation#7754,cval_supplier_s_name#7755,cval_supplier_s_address#7756,cval_supplier_s_phone#7757,cval_supplier_s_acctbal#7758,cval_supplier_s_comment#7759,cs_name#7760,cs_address#7761,cs_phone#7762,cs_acctbal#7763,cs_comment#7764] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#7840 AS rid_1#7853, cpfk_nation_supplier#7841 AS cpfk_nation_supplier_1#7854, cfpk_supplier_nation#7842 AS cfpk_supplier_nation_1#7855, cval_supplier_s_name#7843 AS cval_supplier_s_name_1#7856, cval_supplier_s_address#7844 AS cval_supplier_s_address_1#7857, cval_supplier_s_phone#7845 AS cval_supplier_s_phone_1#7858, cval_supplier_s_acctbal#7846 AS cval_supplier_s_acctbal_1#7859, cval_supplier_s_comment#7847 AS cval_supplier_s_comment_1#7860, cs_name#7848 AS cs_name_1#7861, cs_address#7849 AS cs_address_1#7862, cs_phone#7850 AS cs_phone_1#7863, cs_acctbal#7851 AS cs_acctbal_1#7864, cs_comment#7852 AS cs_comment_1#7865]
            :  :  :     :  :     :  +- Relation[rid#7840,cpfk_nation_supplier#7841,cfpk_supplier_nation#7842,cval_supplier_s_name#7843,cval_supplier_s_address#7844,cval_supplier_s_phone#7845,cval_supplier_s_acctbal#7846,cval_supplier_s_comment#7847,cs_name#7848,cs_address#7849,cs_phone#7850,cs_acctbal#7851,cs_comment#7852] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#7866 AS rid_2#7877, cpfk_part_partsupp#7867 AS cpfk_part_partsupp_2#7878, cfpk_partsupp_part#7868 AS cfpk_partsupp_part_2#7879, cpfk_supplier_partsupp#7869 AS cpfk_supplier_partsupp_2#7880, cfpk_partsupp_supplier#7870 AS cfpk_partsupp_supplier_2#7881, cval_partsupp_ps_availqty#7871 AS cval_partsupp_ps_availqty_2#7882, cval_partsupp_ps_supplycost#7872 AS cval_partsupp_ps_supplycost_2#7883, cval_partsupp_ps_comment#7873 AS cval_partsupp_ps_comment_2#7884, cps_availqty#7874 AS cps_availqty_2#7885, cps_supplycost#7875 AS cps_supplycost_2#7886, cps_comment#7876 AS cps_comment_2#7887]
            :  :  :     :  :        +- Relation[rid#7866,cpfk_part_partsupp#7867,cfpk_partsupp_part#7868,cpfk_supplier_partsupp#7869,cfpk_partsupp_supplier#7870,cval_partsupp_ps_availqty#7871,cval_partsupp_ps_supplycost#7872,cval_partsupp_ps_comment#7873,cps_availqty#7874,cps_supplycost#7875,cps_comment#7876] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#7818 AS rid_2#7829, cpfk_part_partsupp#7819 AS cpfk_part_partsupp_2#7830, cfpk_partsupp_part#7820 AS cfpk_partsupp_part_2#7831, cpfk_supplier_partsupp#7821 AS cpfk_supplier_partsupp_2#7832, cfpk_partsupp_supplier#7822 AS cfpk_partsupp_supplier_2#7833, cval_partsupp_ps_availqty#7823 AS cval_partsupp_ps_availqty_2#7834, cval_partsupp_ps_supplycost#7824 AS cval_partsupp_ps_supplycost_2#7835, cval_partsupp_ps_comment#7825 AS cval_partsupp_ps_comment_2#7836, cps_availqty#7826 AS cps_availqty_2#7837, cps_supplycost#7827 AS cps_supplycost_2#7838, cps_comment#7828 AS cps_comment_2#7839]
            :  :  :     :     +- Relation[rid#7818,cpfk_part_partsupp#7819,cfpk_partsupp_part#7820,cpfk_supplier_partsupp#7821,cfpk_partsupp_supplier#7822,cval_partsupp_ps_availqty#7823,cval_partsupp_ps_supplycost#7824,cval_partsupp_ps_comment#7825,cps_availqty#7826,cps_supplycost#7827,cps_comment#7828] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#7888 AS rid_3#7905, cval_part_p_name#7889 AS cval_part_p_name_3#7906, cval_part_p_mfgr#7890 AS cval_part_p_mfgr_3#7907, cval_part_p_type#7891 AS cval_part_p_type_3#7908, cval_part_p_size#7892 AS cval_part_p_size_3#7909, cval_part_p_container#7893 AS cval_part_p_container_3#7910, cval_part_p_retailprice#7894 AS cval_part_p_retailprice_3#7911, cval_part_p_comment#7895 AS cval_part_p_comment_3#7912, cval_part_p_brand#7896 AS cval_part_p_brand_3#7913, cp_name#7897 AS cp_name_3#7914, cp_mfgr#7898 AS cp_mfgr_3#7915, cp_type#7899 AS cp_type_3#7916, cp_size#7900 AS cp_size_3#7917, cp_container#7901 AS cp_container_3#7918, cp_retailprice#7902 AS cp_retailprice_3#7919, cp_comment#7903 AS cp_comment_3#7920, cp_brand#7904 AS cp_brand_3#7921]
            :  :  :        +- Relation[rid#7888,cval_part_p_name#7889,cval_part_p_mfgr#7890,cval_part_p_type#7891,cval_part_p_size#7892,cval_part_p_container#7893,cval_part_p_retailprice#7894,cval_part_p_comment#7895,cval_part_p_brand#7896,cp_name#7897,cp_mfgr#7898,cp_type#7899,cp_size#7900,cp_container#7901,cp_retailprice#7902,cp_comment#7903,cp_brand#7904] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#7988 AS rid_2#7999, cpfk_part_partsupp#7989 AS cpfk_part_partsupp_2#8000, cfpk_partsupp_part#7990 AS cfpk_partsupp_part_2#8001, cpfk_supplier_partsupp#7991 AS cpfk_supplier_partsupp_2#8002, cfpk_partsupp_supplier#7992 AS cfpk_partsupp_supplier_2#8003, cval_partsupp_ps_availqty#7993 AS cval_partsupp_ps_availqty_2#8004, cval_partsupp_ps_supplycost#7994 AS cval_partsupp_ps_supplycost_2#8005, cval_partsupp_ps_comment#7995 AS cval_partsupp_ps_comment_2#8006, cps_availqty#7996 AS cps_availqty_2#8007, cps_supplycost#7997 AS cps_supplycost_2#8008, cps_comment#7998 AS cps_comment_2#8009]
            :  :     :  +- Relation[rid#7988,cpfk_part_partsupp#7989,cfpk_partsupp_part#7990,cpfk_supplier_partsupp#7991,cfpk_partsupp_supplier#7992,cval_partsupp_ps_availqty#7993,cval_partsupp_ps_supplycost#7994,cval_partsupp_ps_comment#7995,cps_availqty#7996,cps_supplycost#7997,cps_comment#7998] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#8010 AS rid_4#8043, cpfk_orders_lineitem#8011 AS cpfk_orders_lineitem_4#8044, cpfk_supplier_lineitem#8012 AS cpfk_supplier_lineitem_4#8045, cfpk_lineitem_supplier#8013 AS cfpk_lineitem_supplier_4#8046, cfpk_lineitem_partsupp#8014 AS cfpk_lineitem_partsupp_4#8047, cpfk_part_lineitem#8015 AS cpfk_part_lineitem_4#8048, cfpk_lineitem_part#8016 AS cfpk_lineitem_part_4#8049, cpfk_partsupp_lineitem#8017 AS cpfk_partsupp_lineitem_4#8050, cfpk_lineitem_orders#8018 AS cfpk_lineitem_orders_4#8051, cval_lineitem_l_quantity#8019 AS cval_lineitem_l_quantity_4#8052, cval_lineitem_l_extendedprice#8020 AS cval_lineitem_l_extendedprice_4#8053, cval_lineitem_l_discount#8021 AS cval_lineitem_l_discount_4#8054, cval_lineitem_l_tax#8022 AS cval_lineitem_l_tax_4#8055, cval_lineitem_l_returnflag#8023 AS cval_lineitem_l_returnflag_4#8056, cval_lineitem_l_linestatus#8024 AS cval_lineitem_l_linestatus_4#8057, cval_lineitem_l_commitdate#8025 AS cval_lineitem_l_commitdate_4#8058, cval_lineitem_l_receiptdate#8026 AS cval_lineitem_l_receiptdate_4#8059, cval_lineitem_l_shipinstruct#8027 AS cval_lineitem_l_shipinstruct_4#8060, cval_lineitem_l_shipmode#8028 AS cval_lineitem_l_shipmode_4#8061, cval_lineitem_l_comment#8029 AS cval_lineitem_l_comment_4#8062, cval_lineitem_l_shipdate#8030 AS cval_lineitem_l_shipdate_4#8063, cl_quantity#8031 AS cl_quantity_4#8064, cl_extendedprice#8032 AS cl_extendedprice_4#8065, cl_discount#8033 AS cl_discount_4#8066, ... 9 more fields]
            :  :        +- Relation[rid#8010,cpfk_orders_lineitem#8011,cpfk_supplier_lineitem#8012,cfpk_lineitem_supplier#8013,cfpk_lineitem_partsupp#8014,cpfk_part_lineitem#8015,cfpk_lineitem_part#8016,cpfk_partsupp_lineitem#8017,cfpk_lineitem_orders#8018,cval_lineitem_l_quantity#8019,cval_lineitem_l_extendedprice#8020,cval_lineitem_l_discount#8021,cval_lineitem_l_tax#8022,cval_lineitem_l_returnflag#8023,cval_lineitem_l_linestatus#8024,cval_lineitem_l_commitdate#8025,cval_lineitem_l_receiptdate#8026,cval_lineitem_l_shipinstruct#8027,cval_lineitem_l_shipmode#8028,cval_lineitem_l_comment#8029,cval_lineitem_l_shipdate#8030,cl_quantity#8031,cl_extendedprice#8032,cl_discount#8033,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#7922 AS rid_4#7955, cpfk_orders_lineitem#7923 AS cpfk_orders_lineitem_4#7956, cpfk_supplier_lineitem#7924 AS cpfk_supplier_lineitem_4#7957, cfpk_lineitem_supplier#7925 AS cfpk_lineitem_supplier_4#7958, cfpk_lineitem_partsupp#7926 AS cfpk_lineitem_partsupp_4#7959, cpfk_part_lineitem#7927 AS cpfk_part_lineitem_4#7960, cfpk_lineitem_part#7928 AS cfpk_lineitem_part_4#7961, cpfk_partsupp_lineitem#7929 AS cpfk_partsupp_lineitem_4#7962, cfpk_lineitem_orders#7930 AS cfpk_lineitem_orders_4#7963, cval_lineitem_l_quantity#7931 AS cval_lineitem_l_quantity_4#7964, cval_lineitem_l_extendedprice#7932 AS cval_lineitem_l_extendedprice_4#7965, cval_lineitem_l_discount#7933 AS cval_lineitem_l_discount_4#7966, cval_lineitem_l_tax#7934 AS cval_lineitem_l_tax_4#7967, cval_lineitem_l_returnflag#7935 AS cval_lineitem_l_returnflag_4#7968, cval_lineitem_l_linestatus#7936 AS cval_lineitem_l_linestatus_4#7969, cval_lineitem_l_commitdate#7937 AS cval_lineitem_l_commitdate_4#7970, cval_lineitem_l_receiptdate#7938 AS cval_lineitem_l_receiptdate_4#7971, cval_lineitem_l_shipinstruct#7939 AS cval_lineitem_l_shipinstruct_4#7972, cval_lineitem_l_shipmode#7940 AS cval_lineitem_l_shipmode_4#7973, cval_lineitem_l_comment#7941 AS cval_lineitem_l_comment_4#7974, cval_lineitem_l_shipdate#7942 AS cval_lineitem_l_shipdate_4#7975, cl_quantity#7943 AS cl_quantity_4#7976, cl_extendedprice#7944 AS cl_extendedprice_4#7977, cl_discount#7945 AS cl_discount_4#7978, ... 9 more fields]
            :     +- Relation[rid#7922,cpfk_orders_lineitem#7923,cpfk_supplier_lineitem#7924,cfpk_lineitem_supplier#7925,cfpk_lineitem_partsupp#7926,cpfk_part_lineitem#7927,cfpk_lineitem_part#7928,cpfk_partsupp_lineitem#7929,cfpk_lineitem_orders#7930,cval_lineitem_l_quantity#7931,cval_lineitem_l_extendedprice#7932,cval_lineitem_l_discount#7933,cval_lineitem_l_tax#7934,cval_lineitem_l_returnflag#7935,cval_lineitem_l_linestatus#7936,cval_lineitem_l_commitdate#7937,cval_lineitem_l_receiptdate#7938,cval_lineitem_l_shipinstruct#7939,cval_lineitem_l_shipmode#7940,cval_lineitem_l_comment#7941,cval_lineitem_l_shipdate#7942,cl_quantity#7943,cl_extendedprice#7944,cl_discount#7945,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#8076 AS rid_5#8093, cpfk_customer_orders#8077 AS cpfk_customer_orders_5#8094, cfpk_orders_customer#8078 AS cfpk_orders_customer_5#8095, cval_orders_o_orderstatus#8079 AS cval_orders_o_orderstatus_5#8096, cval_orders_o_totalprice#8080 AS cval_orders_o_totalprice_5#8097, cval_orders_o_orderpriority#8081 AS cval_orders_o_orderpriority_5#8098, cval_orders_o_clerk#8082 AS cval_orders_o_clerk_5#8099, cval_orders_o_shippriority#8083 AS cval_orders_o_shippriority_5#8100, cval_orders_o_comment#8084 AS cval_orders_o_comment_5#8101, cval_orders_o_orderdate#8085 AS cval_orders_o_orderdate_5#8102, co_orderstatus#8086 AS co_orderstatus_5#8103, co_totalprice#8087 AS co_totalprice_5#8104, co_orderpriority#8088 AS co_orderpriority_5#8105, co_clerk#8089 AS co_clerk_5#8106, co_shippriority#8090 AS co_shippriority_5#8107, co_comment#8091 AS co_comment_5#8108, co_orderdate#8092 AS co_orderdate_5#8109]
               +- Relation[rid#8076,cpfk_customer_orders#8077,cfpk_orders_customer#8078,cval_orders_o_orderstatus#8079,cval_orders_o_totalprice#8080,cval_orders_o_orderpriority#8081,cval_orders_o_clerk#8082,cval_orders_o_shippriority#8083,cval_orders_o_comment#8084,cval_orders_o_orderdate#8085,co_orderstatus#8086,co_totalprice#8087,co_orderpriority#8088,co_clerk#8089,co_shippriority#8090,co_comment#8091,co_orderdate#8092] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 164065ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/11 05:33:01 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:33:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8212L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 05:33:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8212L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#8214 AS rid_0#8231, cpfk_customer_orders#8215 AS cpfk_customer_orders_0#8232, cfpk_orders_customer#8216 AS cfpk_orders_customer_0#8233, cval_orders_o_orderstatus#8217 AS cval_orders_o_orderstatus_0#8234, cval_orders_o_totalprice#8218 AS cval_orders_o_totalprice_0#8235, cval_orders_o_orderpriority#8219 AS cval_orders_o_orderpriority_0#8236, cval_orders_o_clerk#8220 AS cval_orders_o_clerk_0#8237, cval_orders_o_shippriority#8221 AS cval_orders_o_shippriority_0#8238, cval_orders_o_comment#8222 AS cval_orders_o_comment_0#8239, cval_orders_o_orderdate#8223 AS cval_orders_o_orderdate_0#8240, co_orderstatus#8224 AS co_orderstatus_0#8241, co_totalprice#8225 AS co_totalprice_0#8242, co_orderpriority#8226 AS co_orderpriority_0#8243, co_clerk#8227 AS co_clerk_0#8244, co_shippriority#8228 AS co_shippriority_0#8245, co_comment#8229 AS co_comment_0#8246, co_orderdate#8230 AS co_orderdate_0#8247]
            :  +- Relation[rid#8214,cpfk_customer_orders#8215,cfpk_orders_customer#8216,cval_orders_o_orderstatus#8217,cval_orders_o_totalprice#8218,cval_orders_o_orderpriority#8219,cval_orders_o_clerk#8220,cval_orders_o_shippriority#8221,cval_orders_o_comment#8222,cval_orders_o_orderdate#8223,co_orderstatus#8224,co_totalprice#8225,co_orderpriority#8226,co_clerk#8227,co_shippriority#8228,co_comment#8229,co_orderdate#8230] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#8248 AS rid_1#8263, cpfk_nation_customer#8249 AS cpfk_nation_customer_1#8264, cfpk_customer_nation#8250 AS cfpk_customer_nation_1#8265, cval_customer_c_name#8251 AS cval_customer_c_name_1#8266, cval_customer_c_address#8252 AS cval_customer_c_address_1#8267, cval_customer_c_phone#8253 AS cval_customer_c_phone_1#8268, cval_customer_c_acctbal#8254 AS cval_customer_c_acctbal_1#8269, cval_customer_c_comment#8255 AS cval_customer_c_comment_1#8270, cval_customer_c_mktsegment#8256 AS cval_customer_c_mktsegment_1#8271, cc_name#8257 AS cc_name_1#8272, cc_address#8258 AS cc_address_1#8273, cc_phone#8259 AS cc_phone_1#8274, cc_acctbal#8260 AS cc_acctbal_1#8275, cc_comment#8261 AS cc_comment_1#8276, cc_mktsegment#8262 AS cc_mktsegment_1#8277]
               +- Relation[rid#8248,cpfk_nation_customer#8249,cfpk_customer_nation#8250,cval_customer_c_name#8251,cval_customer_c_address#8252,cval_customer_c_phone#8253,cval_customer_c_acctbal#8254,cval_customer_c_comment#8255,cval_customer_c_mktsegment#8256,cc_name#8257,cc_address#8258,cc_phone#8259,cc_acctbal#8260,cc_comment#8261,cc_mktsegment#8262] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 12748ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/11 05:33:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:33:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8314L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 05:33:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8314L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#8316 AS rid_0#8349, cpfk_orders_lineitem#8317 AS cpfk_orders_lineitem_0#8350, cpfk_supplier_lineitem#8318 AS cpfk_supplier_lineitem_0#8351, cfpk_lineitem_supplier#8319 AS cfpk_lineitem_supplier_0#8352, cfpk_lineitem_partsupp#8320 AS cfpk_lineitem_partsupp_0#8353, cpfk_part_lineitem#8321 AS cpfk_part_lineitem_0#8354, cfpk_lineitem_part#8322 AS cfpk_lineitem_part_0#8355, cpfk_partsupp_lineitem#8323 AS cpfk_partsupp_lineitem_0#8356, cfpk_lineitem_orders#8324 AS cfpk_lineitem_orders_0#8357, cval_lineitem_l_quantity#8325 AS cval_lineitem_l_quantity_0#8358, cval_lineitem_l_extendedprice#8326 AS cval_lineitem_l_extendedprice_0#8359, cval_lineitem_l_discount#8327 AS cval_lineitem_l_discount_0#8360, cval_lineitem_l_tax#8328 AS cval_lineitem_l_tax_0#8361, cval_lineitem_l_returnflag#8329 AS cval_lineitem_l_returnflag_0#8362, cval_lineitem_l_linestatus#8330 AS cval_lineitem_l_linestatus_0#8363, cval_lineitem_l_commitdate#8331 AS cval_lineitem_l_commitdate_0#8364, cval_lineitem_l_receiptdate#8332 AS cval_lineitem_l_receiptdate_0#8365, cval_lineitem_l_shipinstruct#8333 AS cval_lineitem_l_shipinstruct_0#8366, cval_lineitem_l_shipmode#8334 AS cval_lineitem_l_shipmode_0#8367, cval_lineitem_l_comment#8335 AS cval_lineitem_l_comment_0#8368, cval_lineitem_l_shipdate#8336 AS cval_lineitem_l_shipdate_0#8369, cl_quantity#8337 AS cl_quantity_0#8370, cl_extendedprice#8338 AS cl_extendedprice_0#8371, cl_discount#8339 AS cl_discount_0#8372, ... 9 more fields]
            :  :  +- Relation[rid#8316,cpfk_orders_lineitem#8317,cpfk_supplier_lineitem#8318,cfpk_lineitem_supplier#8319,cfpk_lineitem_partsupp#8320,cpfk_part_lineitem#8321,cfpk_lineitem_part#8322,cpfk_partsupp_lineitem#8323,cfpk_lineitem_orders#8324,cval_lineitem_l_quantity#8325,cval_lineitem_l_extendedprice#8326,cval_lineitem_l_discount#8327,cval_lineitem_l_tax#8328,cval_lineitem_l_returnflag#8329,cval_lineitem_l_linestatus#8330,cval_lineitem_l_commitdate#8331,cval_lineitem_l_receiptdate#8332,cval_lineitem_l_shipinstruct#8333,cval_lineitem_l_shipmode#8334,cval_lineitem_l_comment#8335,cval_lineitem_l_shipdate#8336,cl_quantity#8337,cl_extendedprice#8338,cl_discount#8339,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#8382 AS rid_0#8415, cpfk_orders_lineitem#8383 AS cpfk_orders_lineitem_0#8416, cpfk_supplier_lineitem#8384 AS cpfk_supplier_lineitem_0#8417, cfpk_lineitem_supplier#8385 AS cfpk_lineitem_supplier_0#8418, cfpk_lineitem_partsupp#8386 AS cfpk_lineitem_partsupp_0#8419, cpfk_part_lineitem#8387 AS cpfk_part_lineitem_0#8420, cfpk_lineitem_part#8388 AS cfpk_lineitem_part_0#8421, cpfk_partsupp_lineitem#8389 AS cpfk_partsupp_lineitem_0#8422, cfpk_lineitem_orders#8390 AS cfpk_lineitem_orders_0#8423, cval_lineitem_l_quantity#8391 AS cval_lineitem_l_quantity_0#8424, cval_lineitem_l_extendedprice#8392 AS cval_lineitem_l_extendedprice_0#8425, cval_lineitem_l_discount#8393 AS cval_lineitem_l_discount_0#8426, cval_lineitem_l_tax#8394 AS cval_lineitem_l_tax_0#8427, cval_lineitem_l_returnflag#8395 AS cval_lineitem_l_returnflag_0#8428, cval_lineitem_l_linestatus#8396 AS cval_lineitem_l_linestatus_0#8429, cval_lineitem_l_commitdate#8397 AS cval_lineitem_l_commitdate_0#8430, cval_lineitem_l_receiptdate#8398 AS cval_lineitem_l_receiptdate_0#8431, cval_lineitem_l_shipinstruct#8399 AS cval_lineitem_l_shipinstruct_0#8432, cval_lineitem_l_shipmode#8400 AS cval_lineitem_l_shipmode_0#8433, cval_lineitem_l_comment#8401 AS cval_lineitem_l_comment_0#8434, cval_lineitem_l_shipdate#8402 AS cval_lineitem_l_shipdate_0#8435, cl_quantity#8403 AS cl_quantity_0#8436, cl_extendedprice#8404 AS cl_extendedprice_0#8437, cl_discount#8405 AS cl_discount_0#8438, ... 9 more fields]
            :        +- Relation[rid#8382,cpfk_orders_lineitem#8383,cpfk_supplier_lineitem#8384,cfpk_lineitem_supplier#8385,cfpk_lineitem_partsupp#8386,cpfk_part_lineitem#8387,cfpk_lineitem_part#8388,cpfk_partsupp_lineitem#8389,cfpk_lineitem_orders#8390,cval_lineitem_l_quantity#8391,cval_lineitem_l_extendedprice#8392,cval_lineitem_l_discount#8393,cval_lineitem_l_tax#8394,cval_lineitem_l_returnflag#8395,cval_lineitem_l_linestatus#8396,cval_lineitem_l_commitdate#8397,cval_lineitem_l_receiptdate#8398,cval_lineitem_l_shipinstruct#8399,cval_lineitem_l_shipmode#8400,cval_lineitem_l_comment#8401,cval_lineitem_l_shipdate#8402,cl_quantity#8403,cl_extendedprice#8404,cl_discount#8405,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#8448 AS rid_1#8465, cpfk_customer_orders#8449 AS cpfk_customer_orders_1#8466, cfpk_orders_customer#8450 AS cfpk_orders_customer_1#8467, cval_orders_o_orderstatus#8451 AS cval_orders_o_orderstatus_1#8468, cval_orders_o_totalprice#8452 AS cval_orders_o_totalprice_1#8469, cval_orders_o_orderpriority#8453 AS cval_orders_o_orderpriority_1#8470, cval_orders_o_clerk#8454 AS cval_orders_o_clerk_1#8471, cval_orders_o_shippriority#8455 AS cval_orders_o_shippriority_1#8472, cval_orders_o_comment#8456 AS cval_orders_o_comment_1#8473, cval_orders_o_orderdate#8457 AS cval_orders_o_orderdate_1#8474, co_orderstatus#8458 AS co_orderstatus_1#8475, co_totalprice#8459 AS co_totalprice_1#8476, co_orderpriority#8460 AS co_orderpriority_1#8477, co_clerk#8461 AS co_clerk_1#8478, co_shippriority#8462 AS co_shippriority_1#8479, co_comment#8463 AS co_comment_1#8480, co_orderdate#8464 AS co_orderdate_1#8481]
               +- Relation[rid#8448,cpfk_customer_orders#8449,cfpk_orders_customer#8450,cval_orders_o_orderstatus#8451,cval_orders_o_totalprice#8452,cval_orders_o_orderpriority#8453,cval_orders_o_clerk#8454,cval_orders_o_shippriority#8455,cval_orders_o_comment#8456,cval_orders_o_orderdate#8457,co_orderstatus#8458,co_totalprice#8459,co_orderpriority#8460,co_clerk#8461,co_shippriority#8462,co_comment#8463,co_orderdate#8464] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 21578ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/11 05:33:35 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:33:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8537L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 05:33:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8537L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#8539 AS rid_0#8556, cpfk_customer_orders#8540 AS cpfk_customer_orders_0#8557, cfpk_orders_customer#8541 AS cfpk_orders_customer_0#8558, cval_orders_o_orderstatus#8542 AS cval_orders_o_orderstatus_0#8559, cval_orders_o_totalprice#8543 AS cval_orders_o_totalprice_0#8560, cval_orders_o_orderpriority#8544 AS cval_orders_o_orderpriority_0#8561, cval_orders_o_clerk#8545 AS cval_orders_o_clerk_0#8562, cval_orders_o_shippriority#8546 AS cval_orders_o_shippriority_0#8563, cval_orders_o_comment#8547 AS cval_orders_o_comment_0#8564, cval_orders_o_orderdate#8548 AS cval_orders_o_orderdate_0#8565, co_orderstatus#8549 AS co_orderstatus_0#8566, co_totalprice#8550 AS co_totalprice_0#8567, co_orderpriority#8551 AS co_orderpriority_0#8568, co_clerk#8552 AS co_clerk_0#8569, co_shippriority#8553 AS co_shippriority_0#8570, co_comment#8554 AS co_comment_0#8571, co_orderdate#8555 AS co_orderdate_0#8572]
            :  +- Relation[rid#8539,cpfk_customer_orders#8540,cfpk_orders_customer#8541,cval_orders_o_orderstatus#8542,cval_orders_o_totalprice#8543,cval_orders_o_orderpriority#8544,cval_orders_o_clerk#8545,cval_orders_o_shippriority#8546,cval_orders_o_comment#8547,cval_orders_o_orderdate#8548,co_orderstatus#8549,co_totalprice#8550,co_orderpriority#8551,co_clerk#8552,co_shippriority#8553,co_comment#8554,co_orderdate#8555] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#8573 AS rid_1#8588, cpfk_nation_customer#8574 AS cpfk_nation_customer_1#8589, cfpk_customer_nation#8575 AS cfpk_customer_nation_1#8590, cval_customer_c_name#8576 AS cval_customer_c_name_1#8591, cval_customer_c_address#8577 AS cval_customer_c_address_1#8592, cval_customer_c_phone#8578 AS cval_customer_c_phone_1#8593, cval_customer_c_acctbal#8579 AS cval_customer_c_acctbal_1#8594, cval_customer_c_comment#8580 AS cval_customer_c_comment_1#8595, cval_customer_c_mktsegment#8581 AS cval_customer_c_mktsegment_1#8596, cc_name#8582 AS cc_name_1#8597, cc_address#8583 AS cc_address_1#8598, cc_phone#8584 AS cc_phone_1#8599, cc_acctbal#8585 AS cc_acctbal_1#8600, cc_comment#8586 AS cc_comment_1#8601, cc_mktsegment#8587 AS cc_mktsegment_1#8602]
               +- Relation[rid#8573,cpfk_nation_customer#8574,cfpk_customer_nation#8575,cval_customer_c_name#8576,cval_customer_c_address#8577,cval_customer_c_phone#8578,cval_customer_c_acctbal#8579,cval_customer_c_comment#8580,cval_customer_c_mktsegment#8581,cc_name#8582,cc_address#8583,cc_phone#8584,cc_acctbal#8585,cc_comment#8586,cc_mktsegment#8587] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 12810ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/11 05:33:48 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:33:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8639L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 05:33:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:33:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:33:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:33:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:33:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:33:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:33:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:33:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8639L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#8641 AS rid_0#8658, cval_part_p_name#8642 AS cval_part_p_name_0#8659, cval_part_p_mfgr#8643 AS cval_part_p_mfgr_0#8660, cval_part_p_type#8644 AS cval_part_p_type_0#8661, cval_part_p_size#8645 AS cval_part_p_size_0#8662, cval_part_p_container#8646 AS cval_part_p_container_0#8663, cval_part_p_retailprice#8647 AS cval_part_p_retailprice_0#8664, cval_part_p_comment#8648 AS cval_part_p_comment_0#8665, cval_part_p_brand#8649 AS cval_part_p_brand_0#8666, cp_name#8650 AS cp_name_0#8667, cp_mfgr#8651 AS cp_mfgr_0#8668, cp_type#8652 AS cp_type_0#8669, cp_size#8653 AS cp_size_0#8670, cp_container#8654 AS cp_container_0#8671, cp_retailprice#8655 AS cp_retailprice_0#8672, cp_comment#8656 AS cp_comment_0#8673, cp_brand#8657 AS cp_brand_0#8674]
         :  :  :  :  +- Relation[rid#8641,cval_part_p_name#8642,cval_part_p_mfgr#8643,cval_part_p_type#8644,cval_part_p_size#8645,cval_part_p_container#8646,cval_part_p_retailprice#8647,cval_part_p_comment#8648,cval_part_p_brand#8649,cp_name#8650,cp_mfgr#8651,cp_type#8652,cp_size#8653,cp_container#8654,cp_retailprice#8655,cp_comment#8656,cp_brand#8657] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#8675 AS rid_0#8692, cval_part_p_name#8676 AS cval_part_p_name_0#8693, cval_part_p_mfgr#8677 AS cval_part_p_mfgr_0#8694, cval_part_p_type#8678 AS cval_part_p_type_0#8695, cval_part_p_size#8679 AS cval_part_p_size_0#8696, cval_part_p_container#8680 AS cval_part_p_container_0#8697, cval_part_p_retailprice#8681 AS cval_part_p_retailprice_0#8698, cval_part_p_comment#8682 AS cval_part_p_comment_0#8699, cval_part_p_brand#8683 AS cval_part_p_brand_0#8700, cp_name#8684 AS cp_name_0#8701, cp_mfgr#8685 AS cp_mfgr_0#8702, cp_type#8686 AS cp_type_0#8703, cp_size#8687 AS cp_size_0#8704, cp_container#8688 AS cp_container_0#8705, cp_retailprice#8689 AS cp_retailprice_0#8706, cp_comment#8690 AS cp_comment_0#8707, cp_brand#8691 AS cp_brand_0#8708]
         :  :  :        +- Relation[rid#8675,cval_part_p_name#8676,cval_part_p_mfgr#8677,cval_part_p_type#8678,cval_part_p_size#8679,cval_part_p_container#8680,cval_part_p_retailprice#8681,cval_part_p_comment#8682,cval_part_p_brand#8683,cp_name#8684,cp_mfgr#8685,cp_type#8686,cp_size#8687,cp_container#8688,cp_retailprice#8689,cp_comment#8690,cp_brand#8691] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#8709 AS rid_0#8726, cval_part_p_name#8710 AS cval_part_p_name_0#8727, cval_part_p_mfgr#8711 AS cval_part_p_mfgr_0#8728, cval_part_p_type#8712 AS cval_part_p_type_0#8729, cval_part_p_size#8713 AS cval_part_p_size_0#8730, cval_part_p_container#8714 AS cval_part_p_container_0#8731, cval_part_p_retailprice#8715 AS cval_part_p_retailprice_0#8732, cval_part_p_comment#8716 AS cval_part_p_comment_0#8733, cval_part_p_brand#8717 AS cval_part_p_brand_0#8734, cp_name#8718 AS cp_name_0#8735, cp_mfgr#8719 AS cp_mfgr_0#8736, cp_type#8720 AS cp_type_0#8737, cp_size#8721 AS cp_size_0#8738, cp_container#8722 AS cp_container_0#8739, cp_retailprice#8723 AS cp_retailprice_0#8740, cp_comment#8724 AS cp_comment_0#8741, cp_brand#8725 AS cp_brand_0#8742]
         :  :        +- Relation[rid#8709,cval_part_p_name#8710,cval_part_p_mfgr#8711,cval_part_p_type#8712,cval_part_p_size#8713,cval_part_p_container#8714,cval_part_p_retailprice#8715,cval_part_p_comment#8716,cval_part_p_brand#8717,cp_name#8718,cp_mfgr#8719,cp_type#8720,cp_size#8721,cp_container#8722,cp_retailprice#8723,cp_comment#8724,cp_brand#8725] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#8809 AS rid_0#8826, cval_part_p_name#8810 AS cval_part_p_name_0#8827, cval_part_p_mfgr#8811 AS cval_part_p_mfgr_0#8828, cval_part_p_type#8812 AS cval_part_p_type_0#8829, cval_part_p_size#8813 AS cval_part_p_size_0#8830, cval_part_p_container#8814 AS cval_part_p_container_0#8831, cval_part_p_retailprice#8815 AS cval_part_p_retailprice_0#8832, cval_part_p_comment#8816 AS cval_part_p_comment_0#8833, cval_part_p_brand#8817 AS cval_part_p_brand_0#8834, cp_name#8818 AS cp_name_0#8835, cp_mfgr#8819 AS cp_mfgr_0#8836, cp_type#8820 AS cp_type_0#8837, cp_size#8821 AS cp_size_0#8838, cp_container#8822 AS cp_container_0#8839, cp_retailprice#8823 AS cp_retailprice_0#8840, cp_comment#8824 AS cp_comment_0#8841, cp_brand#8825 AS cp_brand_0#8842]
         :     :  +- Relation[rid#8809,cval_part_p_name#8810,cval_part_p_mfgr#8811,cval_part_p_type#8812,cval_part_p_size#8813,cval_part_p_container#8814,cval_part_p_retailprice#8815,cval_part_p_comment#8816,cval_part_p_brand#8817,cp_name#8818,cp_mfgr#8819,cp_type#8820,cp_size#8821,cp_container#8822,cp_retailprice#8823,cp_comment#8824,cp_brand#8825] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#8843 AS rid_1#8876, cpfk_orders_lineitem#8844 AS cpfk_orders_lineitem_1#8877, cpfk_supplier_lineitem#8845 AS cpfk_supplier_lineitem_1#8878, cfpk_lineitem_supplier#8846 AS cfpk_lineitem_supplier_1#8879, cfpk_lineitem_partsupp#8847 AS cfpk_lineitem_partsupp_1#8880, cpfk_part_lineitem#8848 AS cpfk_part_lineitem_1#8881, cfpk_lineitem_part#8849 AS cfpk_lineitem_part_1#8882, cpfk_partsupp_lineitem#8850 AS cpfk_partsupp_lineitem_1#8883, cfpk_lineitem_orders#8851 AS cfpk_lineitem_orders_1#8884, cval_lineitem_l_quantity#8852 AS cval_lineitem_l_quantity_1#8885, cval_lineitem_l_extendedprice#8853 AS cval_lineitem_l_extendedprice_1#8886, cval_lineitem_l_discount#8854 AS cval_lineitem_l_discount_1#8887, cval_lineitem_l_tax#8855 AS cval_lineitem_l_tax_1#8888, cval_lineitem_l_returnflag#8856 AS cval_lineitem_l_returnflag_1#8889, cval_lineitem_l_linestatus#8857 AS cval_lineitem_l_linestatus_1#8890, cval_lineitem_l_commitdate#8858 AS cval_lineitem_l_commitdate_1#8891, cval_lineitem_l_receiptdate#8859 AS cval_lineitem_l_receiptdate_1#8892, cval_lineitem_l_shipinstruct#8860 AS cval_lineitem_l_shipinstruct_1#8893, cval_lineitem_l_shipmode#8861 AS cval_lineitem_l_shipmode_1#8894, cval_lineitem_l_comment#8862 AS cval_lineitem_l_comment_1#8895, cval_lineitem_l_shipdate#8863 AS cval_lineitem_l_shipdate_1#8896, cl_quantity#8864 AS cl_quantity_1#8897, cl_extendedprice#8865 AS cl_extendedprice_1#8898, cl_discount#8866 AS cl_discount_1#8899, ... 9 more fields]
         :        +- Relation[rid#8843,cpfk_orders_lineitem#8844,cpfk_supplier_lineitem#8845,cfpk_lineitem_supplier#8846,cfpk_lineitem_partsupp#8847,cpfk_part_lineitem#8848,cfpk_lineitem_part#8849,cpfk_partsupp_lineitem#8850,cfpk_lineitem_orders#8851,cval_lineitem_l_quantity#8852,cval_lineitem_l_extendedprice#8853,cval_lineitem_l_discount#8854,cval_lineitem_l_tax#8855,cval_lineitem_l_returnflag#8856,cval_lineitem_l_linestatus#8857,cval_lineitem_l_commitdate#8858,cval_lineitem_l_receiptdate#8859,cval_lineitem_l_shipinstruct#8860,cval_lineitem_l_shipmode#8861,cval_lineitem_l_comment#8862,cval_lineitem_l_shipdate#8863,cl_quantity#8864,cl_extendedprice#8865,cl_discount#8866,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8743 AS rid_1#8776, cpfk_orders_lineitem#8744 AS cpfk_orders_lineitem_1#8777, cpfk_supplier_lineitem#8745 AS cpfk_supplier_lineitem_1#8778, cfpk_lineitem_supplier#8746 AS cfpk_lineitem_supplier_1#8779, cfpk_lineitem_partsupp#8747 AS cfpk_lineitem_partsupp_1#8780, cpfk_part_lineitem#8748 AS cpfk_part_lineitem_1#8781, cfpk_lineitem_part#8749 AS cfpk_lineitem_part_1#8782, cpfk_partsupp_lineitem#8750 AS cpfk_partsupp_lineitem_1#8783, cfpk_lineitem_orders#8751 AS cfpk_lineitem_orders_1#8784, cval_lineitem_l_quantity#8752 AS cval_lineitem_l_quantity_1#8785, cval_lineitem_l_extendedprice#8753 AS cval_lineitem_l_extendedprice_1#8786, cval_lineitem_l_discount#8754 AS cval_lineitem_l_discount_1#8787, cval_lineitem_l_tax#8755 AS cval_lineitem_l_tax_1#8788, cval_lineitem_l_returnflag#8756 AS cval_lineitem_l_returnflag_1#8789, cval_lineitem_l_linestatus#8757 AS cval_lineitem_l_linestatus_1#8790, cval_lineitem_l_commitdate#8758 AS cval_lineitem_l_commitdate_1#8791, cval_lineitem_l_receiptdate#8759 AS cval_lineitem_l_receiptdate_1#8792, cval_lineitem_l_shipinstruct#8760 AS cval_lineitem_l_shipinstruct_1#8793, cval_lineitem_l_shipmode#8761 AS cval_lineitem_l_shipmode_1#8794, cval_lineitem_l_comment#8762 AS cval_lineitem_l_comment_1#8795, cval_lineitem_l_shipdate#8763 AS cval_lineitem_l_shipdate_1#8796, cl_quantity#8764 AS cl_quantity_1#8797, cl_extendedprice#8765 AS cl_extendedprice_1#8798, cl_discount#8766 AS cl_discount_1#8799, ... 9 more fields]
            +- Relation[rid#8743,cpfk_orders_lineitem#8744,cpfk_supplier_lineitem#8745,cfpk_lineitem_supplier#8746,cfpk_lineitem_partsupp#8747,cpfk_part_lineitem#8748,cfpk_lineitem_part#8749,cpfk_partsupp_lineitem#8750,cfpk_lineitem_orders#8751,cval_lineitem_l_quantity#8752,cval_lineitem_l_extendedprice#8753,cval_lineitem_l_discount#8754,cval_lineitem_l_tax#8755,cval_lineitem_l_returnflag#8756,cval_lineitem_l_linestatus#8757,cval_lineitem_l_commitdate#8758,cval_lineitem_l_receiptdate#8759,cval_lineitem_l_shipinstruct#8760,cval_lineitem_l_shipmode#8761,cval_lineitem_l_comment#8762,cval_lineitem_l_shipdate#8763,cl_quantity#8764,cl_extendedprice#8765,cl_discount#8766,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 72196ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/11 05:35:00 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:35:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8964L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 05:35:00 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:35:00 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:35:00 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:35:00 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:35:00 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:35:00 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:35:00 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:35:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8964L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#8966 AS rid_0#8983, cval_part_p_name#8967 AS cval_part_p_name_0#8984, cval_part_p_mfgr#8968 AS cval_part_p_mfgr_0#8985, cval_part_p_type#8969 AS cval_part_p_type_0#8986, cval_part_p_size#8970 AS cval_part_p_size_0#8987, cval_part_p_container#8971 AS cval_part_p_container_0#8988, cval_part_p_retailprice#8972 AS cval_part_p_retailprice_0#8989, cval_part_p_comment#8973 AS cval_part_p_comment_0#8990, cval_part_p_brand#8974 AS cval_part_p_brand_0#8991, cp_name#8975 AS cp_name_0#8992, cp_mfgr#8976 AS cp_mfgr_0#8993, cp_type#8977 AS cp_type_0#8994, cp_size#8978 AS cp_size_0#8995, cp_container#8979 AS cp_container_0#8996, cp_retailprice#8980 AS cp_retailprice_0#8997, cp_comment#8981 AS cp_comment_0#8998, cp_brand#8982 AS cp_brand_0#8999]
         :  :  :  :  +- Relation[rid#8966,cval_part_p_name#8967,cval_part_p_mfgr#8968,cval_part_p_type#8969,cval_part_p_size#8970,cval_part_p_container#8971,cval_part_p_retailprice#8972,cval_part_p_comment#8973,cval_part_p_brand#8974,cp_name#8975,cp_mfgr#8976,cp_type#8977,cp_size#8978,cp_container#8979,cp_retailprice#8980,cp_comment#8981,cp_brand#8982] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#9000 AS rid_0#9017, cval_part_p_name#9001 AS cval_part_p_name_0#9018, cval_part_p_mfgr#9002 AS cval_part_p_mfgr_0#9019, cval_part_p_type#9003 AS cval_part_p_type_0#9020, cval_part_p_size#9004 AS cval_part_p_size_0#9021, cval_part_p_container#9005 AS cval_part_p_container_0#9022, cval_part_p_retailprice#9006 AS cval_part_p_retailprice_0#9023, cval_part_p_comment#9007 AS cval_part_p_comment_0#9024, cval_part_p_brand#9008 AS cval_part_p_brand_0#9025, cp_name#9009 AS cp_name_0#9026, cp_mfgr#9010 AS cp_mfgr_0#9027, cp_type#9011 AS cp_type_0#9028, cp_size#9012 AS cp_size_0#9029, cp_container#9013 AS cp_container_0#9030, cp_retailprice#9014 AS cp_retailprice_0#9031, cp_comment#9015 AS cp_comment_0#9032, cp_brand#9016 AS cp_brand_0#9033]
         :  :  :        +- Relation[rid#9000,cval_part_p_name#9001,cval_part_p_mfgr#9002,cval_part_p_type#9003,cval_part_p_size#9004,cval_part_p_container#9005,cval_part_p_retailprice#9006,cval_part_p_comment#9007,cval_part_p_brand#9008,cp_name#9009,cp_mfgr#9010,cp_type#9011,cp_size#9012,cp_container#9013,cp_retailprice#9014,cp_comment#9015,cp_brand#9016] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#9034 AS rid_0#9051, cval_part_p_name#9035 AS cval_part_p_name_0#9052, cval_part_p_mfgr#9036 AS cval_part_p_mfgr_0#9053, cval_part_p_type#9037 AS cval_part_p_type_0#9054, cval_part_p_size#9038 AS cval_part_p_size_0#9055, cval_part_p_container#9039 AS cval_part_p_container_0#9056, cval_part_p_retailprice#9040 AS cval_part_p_retailprice_0#9057, cval_part_p_comment#9041 AS cval_part_p_comment_0#9058, cval_part_p_brand#9042 AS cval_part_p_brand_0#9059, cp_name#9043 AS cp_name_0#9060, cp_mfgr#9044 AS cp_mfgr_0#9061, cp_type#9045 AS cp_type_0#9062, cp_size#9046 AS cp_size_0#9063, cp_container#9047 AS cp_container_0#9064, cp_retailprice#9048 AS cp_retailprice_0#9065, cp_comment#9049 AS cp_comment_0#9066, cp_brand#9050 AS cp_brand_0#9067]
         :  :        +- Relation[rid#9034,cval_part_p_name#9035,cval_part_p_mfgr#9036,cval_part_p_type#9037,cval_part_p_size#9038,cval_part_p_container#9039,cval_part_p_retailprice#9040,cval_part_p_comment#9041,cval_part_p_brand#9042,cp_name#9043,cp_mfgr#9044,cp_type#9045,cp_size#9046,cp_container#9047,cp_retailprice#9048,cp_comment#9049,cp_brand#9050] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#9266 AS rid_0#9283, cval_part_p_name#9267 AS cval_part_p_name_0#9284, cval_part_p_mfgr#9268 AS cval_part_p_mfgr_0#9285, cval_part_p_type#9269 AS cval_part_p_type_0#9286, cval_part_p_size#9270 AS cval_part_p_size_0#9287, cval_part_p_container#9271 AS cval_part_p_container_0#9288, cval_part_p_retailprice#9272 AS cval_part_p_retailprice_0#9289, cval_part_p_comment#9273 AS cval_part_p_comment_0#9290, cval_part_p_brand#9274 AS cval_part_p_brand_0#9291, cp_name#9275 AS cp_name_0#9292, cp_mfgr#9276 AS cp_mfgr_0#9293, cp_type#9277 AS cp_type_0#9294, cp_size#9278 AS cp_size_0#9295, cp_container#9279 AS cp_container_0#9296, cp_retailprice#9280 AS cp_retailprice_0#9297, cp_comment#9281 AS cp_comment_0#9298, cp_brand#9282 AS cp_brand_0#9299]
         :     :  +- Relation[rid#9266,cval_part_p_name#9267,cval_part_p_mfgr#9268,cval_part_p_type#9269,cval_part_p_size#9270,cval_part_p_container#9271,cval_part_p_retailprice#9272,cval_part_p_comment#9273,cval_part_p_brand#9274,cp_name#9275,cp_mfgr#9276,cp_type#9277,cp_size#9278,cp_container#9279,cp_retailprice#9280,cp_comment#9281,cp_brand#9282] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#9300 AS rid_1#9333, cpfk_orders_lineitem#9301 AS cpfk_orders_lineitem_1#9334, cpfk_supplier_lineitem#9302 AS cpfk_supplier_lineitem_1#9335, cfpk_lineitem_supplier#9303 AS cfpk_lineitem_supplier_1#9336, cfpk_lineitem_partsupp#9304 AS cfpk_lineitem_partsupp_1#9337, cpfk_part_lineitem#9305 AS cpfk_part_lineitem_1#9338, cfpk_lineitem_part#9306 AS cfpk_lineitem_part_1#9339, cpfk_partsupp_lineitem#9307 AS cpfk_partsupp_lineitem_1#9340, cfpk_lineitem_orders#9308 AS cfpk_lineitem_orders_1#9341, cval_lineitem_l_quantity#9309 AS cval_lineitem_l_quantity_1#9342, cval_lineitem_l_extendedprice#9310 AS cval_lineitem_l_extendedprice_1#9343, cval_lineitem_l_discount#9311 AS cval_lineitem_l_discount_1#9344, cval_lineitem_l_tax#9312 AS cval_lineitem_l_tax_1#9345, cval_lineitem_l_returnflag#9313 AS cval_lineitem_l_returnflag_1#9346, cval_lineitem_l_linestatus#9314 AS cval_lineitem_l_linestatus_1#9347, cval_lineitem_l_commitdate#9315 AS cval_lineitem_l_commitdate_1#9348, cval_lineitem_l_receiptdate#9316 AS cval_lineitem_l_receiptdate_1#9349, cval_lineitem_l_shipinstruct#9317 AS cval_lineitem_l_shipinstruct_1#9350, cval_lineitem_l_shipmode#9318 AS cval_lineitem_l_shipmode_1#9351, cval_lineitem_l_comment#9319 AS cval_lineitem_l_comment_1#9352, cval_lineitem_l_shipdate#9320 AS cval_lineitem_l_shipdate_1#9353, cl_quantity#9321 AS cl_quantity_1#9354, cl_extendedprice#9322 AS cl_extendedprice_1#9355, cl_discount#9323 AS cl_discount_1#9356, ... 9 more fields]
         :        +- Relation[rid#9300,cpfk_orders_lineitem#9301,cpfk_supplier_lineitem#9302,cfpk_lineitem_supplier#9303,cfpk_lineitem_partsupp#9304,cpfk_part_lineitem#9305,cfpk_lineitem_part#9306,cpfk_partsupp_lineitem#9307,cfpk_lineitem_orders#9308,cval_lineitem_l_quantity#9309,cval_lineitem_l_extendedprice#9310,cval_lineitem_l_discount#9311,cval_lineitem_l_tax#9312,cval_lineitem_l_returnflag#9313,cval_lineitem_l_linestatus#9314,cval_lineitem_l_commitdate#9315,cval_lineitem_l_receiptdate#9316,cval_lineitem_l_shipinstruct#9317,cval_lineitem_l_shipmode#9318,cval_lineitem_l_comment#9319,cval_lineitem_l_shipdate#9320,cl_quantity#9321,cl_extendedprice#9322,cl_discount#9323,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#9068 AS rid_1#9101, cpfk_orders_lineitem#9069 AS cpfk_orders_lineitem_1#9102, cpfk_supplier_lineitem#9070 AS cpfk_supplier_lineitem_1#9103, cfpk_lineitem_supplier#9071 AS cfpk_lineitem_supplier_1#9104, cfpk_lineitem_partsupp#9072 AS cfpk_lineitem_partsupp_1#9105, cpfk_part_lineitem#9073 AS cpfk_part_lineitem_1#9106, cfpk_lineitem_part#9074 AS cfpk_lineitem_part_1#9107, cpfk_partsupp_lineitem#9075 AS cpfk_partsupp_lineitem_1#9108, cfpk_lineitem_orders#9076 AS cfpk_lineitem_orders_1#9109, cval_lineitem_l_quantity#9077 AS cval_lineitem_l_quantity_1#9110, cval_lineitem_l_extendedprice#9078 AS cval_lineitem_l_extendedprice_1#9111, cval_lineitem_l_discount#9079 AS cval_lineitem_l_discount_1#9112, cval_lineitem_l_tax#9080 AS cval_lineitem_l_tax_1#9113, cval_lineitem_l_returnflag#9081 AS cval_lineitem_l_returnflag_1#9114, cval_lineitem_l_linestatus#9082 AS cval_lineitem_l_linestatus_1#9115, cval_lineitem_l_commitdate#9083 AS cval_lineitem_l_commitdate_1#9116, cval_lineitem_l_receiptdate#9084 AS cval_lineitem_l_receiptdate_1#9117, cval_lineitem_l_shipinstruct#9085 AS cval_lineitem_l_shipinstruct_1#9118, cval_lineitem_l_shipmode#9086 AS cval_lineitem_l_shipmode_1#9119, cval_lineitem_l_comment#9087 AS cval_lineitem_l_comment_1#9120, cval_lineitem_l_shipdate#9088 AS cval_lineitem_l_shipdate_1#9121, cl_quantity#9089 AS cl_quantity_1#9122, cl_extendedprice#9090 AS cl_extendedprice_1#9123, cl_discount#9091 AS cl_discount_1#9124, ... 9 more fields]
            :  :  +- Relation[rid#9068,cpfk_orders_lineitem#9069,cpfk_supplier_lineitem#9070,cfpk_lineitem_supplier#9071,cfpk_lineitem_partsupp#9072,cpfk_part_lineitem#9073,cfpk_lineitem_part#9074,cpfk_partsupp_lineitem#9075,cfpk_lineitem_orders#9076,cval_lineitem_l_quantity#9077,cval_lineitem_l_extendedprice#9078,cval_lineitem_l_discount#9079,cval_lineitem_l_tax#9080,cval_lineitem_l_returnflag#9081,cval_lineitem_l_linestatus#9082,cval_lineitem_l_commitdate#9083,cval_lineitem_l_receiptdate#9084,cval_lineitem_l_shipinstruct#9085,cval_lineitem_l_shipmode#9086,cval_lineitem_l_comment#9087,cval_lineitem_l_shipdate#9088,cl_quantity#9089,cl_extendedprice#9090,cl_discount#9091,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#9134 AS rid_1#9167, cpfk_orders_lineitem#9135 AS cpfk_orders_lineitem_1#9168, cpfk_supplier_lineitem#9136 AS cpfk_supplier_lineitem_1#9169, cfpk_lineitem_supplier#9137 AS cfpk_lineitem_supplier_1#9170, cfpk_lineitem_partsupp#9138 AS cfpk_lineitem_partsupp_1#9171, cpfk_part_lineitem#9139 AS cpfk_part_lineitem_1#9172, cfpk_lineitem_part#9140 AS cfpk_lineitem_part_1#9173, cpfk_partsupp_lineitem#9141 AS cpfk_partsupp_lineitem_1#9174, cfpk_lineitem_orders#9142 AS cfpk_lineitem_orders_1#9175, cval_lineitem_l_quantity#9143 AS cval_lineitem_l_quantity_1#9176, cval_lineitem_l_extendedprice#9144 AS cval_lineitem_l_extendedprice_1#9177, cval_lineitem_l_discount#9145 AS cval_lineitem_l_discount_1#9178, cval_lineitem_l_tax#9146 AS cval_lineitem_l_tax_1#9179, cval_lineitem_l_returnflag#9147 AS cval_lineitem_l_returnflag_1#9180, cval_lineitem_l_linestatus#9148 AS cval_lineitem_l_linestatus_1#9181, cval_lineitem_l_commitdate#9149 AS cval_lineitem_l_commitdate_1#9182, cval_lineitem_l_receiptdate#9150 AS cval_lineitem_l_receiptdate_1#9183, cval_lineitem_l_shipinstruct#9151 AS cval_lineitem_l_shipinstruct_1#9184, cval_lineitem_l_shipmode#9152 AS cval_lineitem_l_shipmode_1#9185, cval_lineitem_l_comment#9153 AS cval_lineitem_l_comment_1#9186, cval_lineitem_l_shipdate#9154 AS cval_lineitem_l_shipdate_1#9187, cl_quantity#9155 AS cl_quantity_1#9188, cl_extendedprice#9156 AS cl_extendedprice_1#9189, cl_discount#9157 AS cl_discount_1#9190, ... 9 more fields]
            :        +- Relation[rid#9134,cpfk_orders_lineitem#9135,cpfk_supplier_lineitem#9136,cfpk_lineitem_supplier#9137,cfpk_lineitem_partsupp#9138,cpfk_part_lineitem#9139,cfpk_lineitem_part#9140,cpfk_partsupp_lineitem#9141,cfpk_lineitem_orders#9142,cval_lineitem_l_quantity#9143,cval_lineitem_l_extendedprice#9144,cval_lineitem_l_discount#9145,cval_lineitem_l_tax#9146,cval_lineitem_l_returnflag#9147,cval_lineitem_l_linestatus#9148,cval_lineitem_l_commitdate#9149,cval_lineitem_l_receiptdate#9150,cval_lineitem_l_shipinstruct#9151,cval_lineitem_l_shipmode#9152,cval_lineitem_l_comment#9153,cval_lineitem_l_shipdate#9154,cl_quantity#9155,cl_extendedprice#9156,cl_discount#9157,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#9200 AS rid_1#9233, cpfk_orders_lineitem#9201 AS cpfk_orders_lineitem_1#9234, cpfk_supplier_lineitem#9202 AS cpfk_supplier_lineitem_1#9235, cfpk_lineitem_supplier#9203 AS cfpk_lineitem_supplier_1#9236, cfpk_lineitem_partsupp#9204 AS cfpk_lineitem_partsupp_1#9237, cpfk_part_lineitem#9205 AS cpfk_part_lineitem_1#9238, cfpk_lineitem_part#9206 AS cfpk_lineitem_part_1#9239, cpfk_partsupp_lineitem#9207 AS cpfk_partsupp_lineitem_1#9240, cfpk_lineitem_orders#9208 AS cfpk_lineitem_orders_1#9241, cval_lineitem_l_quantity#9209 AS cval_lineitem_l_quantity_1#9242, cval_lineitem_l_extendedprice#9210 AS cval_lineitem_l_extendedprice_1#9243, cval_lineitem_l_discount#9211 AS cval_lineitem_l_discount_1#9244, cval_lineitem_l_tax#9212 AS cval_lineitem_l_tax_1#9245, cval_lineitem_l_returnflag#9213 AS cval_lineitem_l_returnflag_1#9246, cval_lineitem_l_linestatus#9214 AS cval_lineitem_l_linestatus_1#9247, cval_lineitem_l_commitdate#9215 AS cval_lineitem_l_commitdate_1#9248, cval_lineitem_l_receiptdate#9216 AS cval_lineitem_l_receiptdate_1#9249, cval_lineitem_l_shipinstruct#9217 AS cval_lineitem_l_shipinstruct_1#9250, cval_lineitem_l_shipmode#9218 AS cval_lineitem_l_shipmode_1#9251, cval_lineitem_l_comment#9219 AS cval_lineitem_l_comment_1#9252, cval_lineitem_l_shipdate#9220 AS cval_lineitem_l_shipdate_1#9253, cl_quantity#9221 AS cl_quantity_1#9254, cl_extendedprice#9222 AS cl_extendedprice_1#9255, cl_discount#9223 AS cl_discount_1#9256, ... 9 more fields]
                  +- Relation[rid#9200,cpfk_orders_lineitem#9201,cpfk_supplier_lineitem#9202,cfpk_lineitem_supplier#9203,cfpk_lineitem_partsupp#9204,cpfk_part_lineitem#9205,cfpk_lineitem_part#9206,cpfk_partsupp_lineitem#9207,cfpk_lineitem_orders#9208,cval_lineitem_l_quantity#9209,cval_lineitem_l_extendedprice#9210,cval_lineitem_l_discount#9211,cval_lineitem_l_tax#9212,cval_lineitem_l_returnflag#9213,cval_lineitem_l_linestatus#9214,cval_lineitem_l_commitdate#9215,cval_lineitem_l_receiptdate#9216,cval_lineitem_l_shipinstruct#9217,cval_lineitem_l_shipmode#9218,cval_lineitem_l_comment#9219,cval_lineitem_l_shipdate#9220,cl_quantity#9221,cl_extendedprice#9222,cl_discount#9223,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 366567ms
query=q1, count=6001215, duration=3081
query=q10, count=1478870, duration=63533
query=q11, count=31680, duration=10566
query=q12, count=857401, duration=21578
query=q13, count=1500000, duration=12748
query=q14, count=6001215, duration=83398
query=q15, count=6001215, duration=78829
query=q16, count=15780, duration=11325
query=q17, count=6088, duration=72196
query=q18, count=6001215, duration=117306
query=q19, count=205, duration=366567
query=q2, count=3162, duration=20543
query=q20, count=632, duration=11037
query=q21a, count=597422, duration=246327
query=q22, count=1500000, duration=12810
query=q3, count=1214743, duration=117138
query=q4, count=6001215, duration=53270
query=q5, count=1206514, duration=163486
query=q6, count=6001215, duration=3114
query=q7, count=9735, duration=101779
query=q8, count=8716, duration=96275
query=q9a, count=6001215, duration=240711
query=q9b, count=6001215, duration=164065
