20/04/11 02:47:43 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 11126ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 11 02:47:47 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 11 02:47:48 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 11 02:47:48 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 11 02:47:48 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 11 02:47:48 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 11 02:47:53 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 11 02:47:56 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 11 02:47:56 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/11 02:47:58 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 02:47:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2081L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 02:47:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 02:47:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 02:47:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 02:47:58 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/11 02:47:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2081L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#2083 AS rid_0#2096, cpfk_nation_supplier#2084 AS cpfk_nation_supplier_0#2097, cfpk_supplier_nation#2085 AS cfpk_supplier_nation_0#2098, cval_supplier_s_name#2086 AS cval_supplier_s_name_0#2099, cval_supplier_s_address#2087 AS cval_supplier_s_address_0#2100, cval_supplier_s_phone#2088 AS cval_supplier_s_phone_0#2101, cval_supplier_s_acctbal#2089 AS cval_supplier_s_acctbal_0#2102, cval_supplier_s_comment#2090 AS cval_supplier_s_comment_0#2103, cs_name#2091 AS cs_name_0#2104, cs_address#2092 AS cs_address_0#2105, cs_phone#2093 AS cs_phone_0#2106, cs_acctbal#2094 AS cs_acctbal_0#2107, cs_comment#2095 AS cs_comment_0#2108]
         :  :  +- Relation[rid#2083,cpfk_nation_supplier#2084,cfpk_supplier_nation#2085,cval_supplier_s_name#2086,cval_supplier_s_address#2087,cval_supplier_s_phone#2088,cval_supplier_s_acctbal#2089,cval_supplier_s_comment#2090,cs_name#2091,cs_address#2092,cs_phone#2093,cs_acctbal#2094,cs_comment#2095] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#2175 AS rid_0#2188, cpfk_nation_supplier#2176 AS cpfk_nation_supplier_0#2189, cfpk_supplier_nation#2177 AS cfpk_supplier_nation_0#2190, cval_supplier_s_name#2178 AS cval_supplier_s_name_0#2191, cval_supplier_s_address#2179 AS cval_supplier_s_address_0#2192, cval_supplier_s_phone#2180 AS cval_supplier_s_phone_0#2193, cval_supplier_s_acctbal#2181 AS cval_supplier_s_acctbal_0#2194, cval_supplier_s_comment#2182 AS cval_supplier_s_comment_0#2195, cs_name#2183 AS cs_name_0#2196, cs_address#2184 AS cs_address_0#2197, cs_phone#2185 AS cs_phone_0#2198, cs_acctbal#2186 AS cs_acctbal_0#2199, cs_comment#2187 AS cs_comment_0#2200]
         :     :  +- Relation[rid#2175,cpfk_nation_supplier#2176,cfpk_supplier_nation#2177,cval_supplier_s_name#2178,cval_supplier_s_address#2179,cval_supplier_s_phone#2180,cval_supplier_s_acctbal#2181,cval_supplier_s_comment#2182,cs_name#2183,cs_address#2184,cs_phone#2185,cs_acctbal#2186,cs_comment#2187] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#2201 AS rid_1#2234, cpfk_orders_lineitem#2202 AS cpfk_orders_lineitem_1#2235, cpfk_supplier_lineitem#2203 AS cpfk_supplier_lineitem_1#2236, cfpk_lineitem_supplier#2204 AS cfpk_lineitem_supplier_1#2237, cfpk_lineitem_partsupp#2205 AS cfpk_lineitem_partsupp_1#2238, cpfk_part_lineitem#2206 AS cpfk_part_lineitem_1#2239, cfpk_lineitem_part#2207 AS cfpk_lineitem_part_1#2240, cpfk_partsupp_lineitem#2208 AS cpfk_partsupp_lineitem_1#2241, cfpk_lineitem_orders#2209 AS cfpk_lineitem_orders_1#2242, cval_lineitem_l_quantity#2210 AS cval_lineitem_l_quantity_1#2243, cval_lineitem_l_extendedprice#2211 AS cval_lineitem_l_extendedprice_1#2244, cval_lineitem_l_discount#2212 AS cval_lineitem_l_discount_1#2245, cval_lineitem_l_tax#2213 AS cval_lineitem_l_tax_1#2246, cval_lineitem_l_returnflag#2214 AS cval_lineitem_l_returnflag_1#2247, cval_lineitem_l_linestatus#2215 AS cval_lineitem_l_linestatus_1#2248, cval_lineitem_l_commitdate#2216 AS cval_lineitem_l_commitdate_1#2249, cval_lineitem_l_receiptdate#2217 AS cval_lineitem_l_receiptdate_1#2250, cval_lineitem_l_shipinstruct#2218 AS cval_lineitem_l_shipinstruct_1#2251, cval_lineitem_l_shipmode#2219 AS cval_lineitem_l_shipmode_1#2252, cval_lineitem_l_comment#2220 AS cval_lineitem_l_comment_1#2253, cval_lineitem_l_shipdate#2221 AS cval_lineitem_l_shipdate_1#2254, cl_quantity#2222 AS cl_quantity_1#2255, cl_extendedprice#2223 AS cl_extendedprice_1#2256, cl_discount#2224 AS cl_discount_1#2257, ... 9 more fields]
         :        +- Relation[rid#2201,cpfk_orders_lineitem#2202,cpfk_supplier_lineitem#2203,cfpk_lineitem_supplier#2204,cfpk_lineitem_partsupp#2205,cpfk_part_lineitem#2206,cfpk_lineitem_part#2207,cpfk_partsupp_lineitem#2208,cfpk_lineitem_orders#2209,cval_lineitem_l_quantity#2210,cval_lineitem_l_extendedprice#2211,cval_lineitem_l_discount#2212,cval_lineitem_l_tax#2213,cval_lineitem_l_returnflag#2214,cval_lineitem_l_linestatus#2215,cval_lineitem_l_commitdate#2216,cval_lineitem_l_receiptdate#2217,cval_lineitem_l_shipinstruct#2218,cval_lineitem_l_shipmode#2219,cval_lineitem_l_comment#2220,cval_lineitem_l_shipdate#2221,cl_quantity#2222,cl_extendedprice#2223,cl_discount#2224,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2109 AS rid_1#2142, cpfk_orders_lineitem#2110 AS cpfk_orders_lineitem_1#2143, cpfk_supplier_lineitem#2111 AS cpfk_supplier_lineitem_1#2144, cfpk_lineitem_supplier#2112 AS cfpk_lineitem_supplier_1#2145, cfpk_lineitem_partsupp#2113 AS cfpk_lineitem_partsupp_1#2146, cpfk_part_lineitem#2114 AS cpfk_part_lineitem_1#2147, cfpk_lineitem_part#2115 AS cfpk_lineitem_part_1#2148, cpfk_partsupp_lineitem#2116 AS cpfk_partsupp_lineitem_1#2149, cfpk_lineitem_orders#2117 AS cfpk_lineitem_orders_1#2150, cval_lineitem_l_quantity#2118 AS cval_lineitem_l_quantity_1#2151, cval_lineitem_l_extendedprice#2119 AS cval_lineitem_l_extendedprice_1#2152, cval_lineitem_l_discount#2120 AS cval_lineitem_l_discount_1#2153, cval_lineitem_l_tax#2121 AS cval_lineitem_l_tax_1#2154, cval_lineitem_l_returnflag#2122 AS cval_lineitem_l_returnflag_1#2155, cval_lineitem_l_linestatus#2123 AS cval_lineitem_l_linestatus_1#2156, cval_lineitem_l_commitdate#2124 AS cval_lineitem_l_commitdate_1#2157, cval_lineitem_l_receiptdate#2125 AS cval_lineitem_l_receiptdate_1#2158, cval_lineitem_l_shipinstruct#2126 AS cval_lineitem_l_shipinstruct_1#2159, cval_lineitem_l_shipmode#2127 AS cval_lineitem_l_shipmode_1#2160, cval_lineitem_l_comment#2128 AS cval_lineitem_l_comment_1#2161, cval_lineitem_l_shipdate#2129 AS cval_lineitem_l_shipdate_1#2162, cl_quantity#2130 AS cl_quantity_1#2163, cl_extendedprice#2131 AS cl_extendedprice_1#2164, cl_discount#2132 AS cl_discount_1#2165, ... 9 more fields]
            +- Relation[rid#2109,cpfk_orders_lineitem#2110,cpfk_supplier_lineitem#2111,cfpk_lineitem_supplier#2112,cfpk_lineitem_partsupp#2113,cpfk_part_lineitem#2114,cfpk_lineitem_part#2115,cpfk_partsupp_lineitem#2116,cfpk_lineitem_orders#2117,cval_lineitem_l_quantity#2118,cval_lineitem_l_extendedprice#2119,cval_lineitem_l_discount#2120,cval_lineitem_l_tax#2121,cval_lineitem_l_returnflag#2122,cval_lineitem_l_linestatus#2123,cval_lineitem_l_commitdate#2124,cval_lineitem_l_receiptdate#2125,cval_lineitem_l_shipinstruct#2126,cval_lineitem_l_shipmode#2127,cval_lineitem_l_comment#2128,cval_lineitem_l_shipdate#2129,cl_quantity#2130,cl_extendedprice#2131,cl_discount#2132,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 77604ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 02:49:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 02:49:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2322L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 02:49:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 02:49:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 02:49:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 02:49:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 02:49:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 02:49:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 02:49:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 02:49:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 02:49:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 02:49:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 02:49:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 02:49:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 02:49:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 02:49:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 02:49:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 02:49:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 02:49:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2322L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#2324 AS rid_0#2331, cpfk_region_nation#2325 AS cpfk_region_nation_0#2332, cfpk_nation_region#2326 AS cfpk_nation_region_0#2333, cval_nation_n_name#2327 AS cval_nation_n_name_0#2334, cval_nation_n_comment#2328 AS cval_nation_n_comment_0#2335, cn_name#2329 AS cn_name_0#2336, cn_comment#2330 AS cn_comment_0#2337]
            :  :  :     :  :  :  :  :  +- Relation[rid#2324,cpfk_region_nation#2325,cfpk_nation_region#2326,cval_nation_n_name#2327,cval_nation_n_comment#2328,cn_name#2329,cn_comment#2330] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#2364 AS rid_0#2371, cpfk_region_nation#2365 AS cpfk_region_nation_0#2372, cfpk_nation_region#2366 AS cfpk_nation_region_0#2373, cval_nation_n_name#2367 AS cval_nation_n_name_0#2374, cval_nation_n_comment#2368 AS cval_nation_n_comment_0#2375, cn_name#2369 AS cn_name_0#2376, cn_comment#2370 AS cn_comment_0#2377]
            :  :  :     :  :  :  :     :  +- Relation[rid#2364,cpfk_region_nation#2365,cfpk_nation_region#2366,cval_nation_n_name#2367,cval_nation_n_comment#2368,cn_name#2369,cn_comment#2370] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#2378 AS rid_1#2391, cpfk_nation_supplier#2379 AS cpfk_nation_supplier_1#2392, cfpk_supplier_nation#2380 AS cfpk_supplier_nation_1#2393, cval_supplier_s_name#2381 AS cval_supplier_s_name_1#2394, cval_supplier_s_address#2382 AS cval_supplier_s_address_1#2395, cval_supplier_s_phone#2383 AS cval_supplier_s_phone_1#2396, cval_supplier_s_acctbal#2384 AS cval_supplier_s_acctbal_1#2397, cval_supplier_s_comment#2385 AS cval_supplier_s_comment_1#2398, cs_name#2386 AS cs_name_1#2399, cs_address#2387 AS cs_address_1#2400, cs_phone#2388 AS cs_phone_1#2401, cs_acctbal#2389 AS cs_acctbal_1#2402, cs_comment#2390 AS cs_comment_1#2403]
            :  :  :     :  :  :  :        +- Relation[rid#2378,cpfk_nation_supplier#2379,cfpk_supplier_nation#2380,cval_supplier_s_name#2381,cval_supplier_s_address#2382,cval_supplier_s_phone#2383,cval_supplier_s_acctbal#2384,cval_supplier_s_comment#2385,cs_name#2386,cs_address#2387,cs_phone#2388,cs_acctbal#2389,cs_comment#2390] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#2338 AS rid_1#2351, cpfk_nation_supplier#2339 AS cpfk_nation_supplier_1#2352, cfpk_supplier_nation#2340 AS cfpk_supplier_nation_1#2353, cval_supplier_s_name#2341 AS cval_supplier_s_name_1#2354, cval_supplier_s_address#2342 AS cval_supplier_s_address_1#2355, cval_supplier_s_phone#2343 AS cval_supplier_s_phone_1#2356, cval_supplier_s_acctbal#2344 AS cval_supplier_s_acctbal_1#2357, cval_supplier_s_comment#2345 AS cval_supplier_s_comment_1#2358, cs_name#2346 AS cs_name_1#2359, cs_address#2347 AS cs_address_1#2360, cs_phone#2348 AS cs_phone_1#2361, cs_acctbal#2349 AS cs_acctbal_1#2362, cs_comment#2350 AS cs_comment_1#2363]
            :  :  :     :  :  :     +- Relation[rid#2338,cpfk_nation_supplier#2339,cfpk_supplier_nation#2340,cval_supplier_s_name#2341,cval_supplier_s_address#2342,cval_supplier_s_phone#2343,cval_supplier_s_acctbal#2344,cval_supplier_s_comment#2345,cs_name#2346,cs_address#2347,cs_phone#2348,cs_acctbal#2349,cs_comment#2350] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#2426 AS rid_1#2439, cpfk_nation_supplier#2427 AS cpfk_nation_supplier_1#2440, cfpk_supplier_nation#2428 AS cfpk_supplier_nation_1#2441, cval_supplier_s_name#2429 AS cval_supplier_s_name_1#2442, cval_supplier_s_address#2430 AS cval_supplier_s_address_1#2443, cval_supplier_s_phone#2431 AS cval_supplier_s_phone_1#2444, cval_supplier_s_acctbal#2432 AS cval_supplier_s_acctbal_1#2445, cval_supplier_s_comment#2433 AS cval_supplier_s_comment_1#2446, cs_name#2434 AS cs_name_1#2447, cs_address#2435 AS cs_address_1#2448, cs_phone#2436 AS cs_phone_1#2449, cs_acctbal#2437 AS cs_acctbal_1#2450, cs_comment#2438 AS cs_comment_1#2451]
            :  :  :     :  :     :  +- Relation[rid#2426,cpfk_nation_supplier#2427,cfpk_supplier_nation#2428,cval_supplier_s_name#2429,cval_supplier_s_address#2430,cval_supplier_s_phone#2431,cval_supplier_s_acctbal#2432,cval_supplier_s_comment#2433,cs_name#2434,cs_address#2435,cs_phone#2436,cs_acctbal#2437,cs_comment#2438] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#2452 AS rid_2#2463, cpfk_part_partsupp#2453 AS cpfk_part_partsupp_2#2464, cfpk_partsupp_part#2454 AS cfpk_partsupp_part_2#2465, cpfk_supplier_partsupp#2455 AS cpfk_supplier_partsupp_2#2466, cfpk_partsupp_supplier#2456 AS cfpk_partsupp_supplier_2#2467, cval_partsupp_ps_availqty#2457 AS cval_partsupp_ps_availqty_2#2468, cval_partsupp_ps_supplycost#2458 AS cval_partsupp_ps_supplycost_2#2469, cval_partsupp_ps_comment#2459 AS cval_partsupp_ps_comment_2#2470, cps_availqty#2460 AS cps_availqty_2#2471, cps_supplycost#2461 AS cps_supplycost_2#2472, cps_comment#2462 AS cps_comment_2#2473]
            :  :  :     :  :        +- Relation[rid#2452,cpfk_part_partsupp#2453,cfpk_partsupp_part#2454,cpfk_supplier_partsupp#2455,cfpk_partsupp_supplier#2456,cval_partsupp_ps_availqty#2457,cval_partsupp_ps_supplycost#2458,cval_partsupp_ps_comment#2459,cps_availqty#2460,cps_supplycost#2461,cps_comment#2462] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#2404 AS rid_2#2415, cpfk_part_partsupp#2405 AS cpfk_part_partsupp_2#2416, cfpk_partsupp_part#2406 AS cfpk_partsupp_part_2#2417, cpfk_supplier_partsupp#2407 AS cpfk_supplier_partsupp_2#2418, cfpk_partsupp_supplier#2408 AS cfpk_partsupp_supplier_2#2419, cval_partsupp_ps_availqty#2409 AS cval_partsupp_ps_availqty_2#2420, cval_partsupp_ps_supplycost#2410 AS cval_partsupp_ps_supplycost_2#2421, cval_partsupp_ps_comment#2411 AS cval_partsupp_ps_comment_2#2422, cps_availqty#2412 AS cps_availqty_2#2423, cps_supplycost#2413 AS cps_supplycost_2#2424, cps_comment#2414 AS cps_comment_2#2425]
            :  :  :     :     +- Relation[rid#2404,cpfk_part_partsupp#2405,cfpk_partsupp_part#2406,cpfk_supplier_partsupp#2407,cfpk_partsupp_supplier#2408,cval_partsupp_ps_availqty#2409,cval_partsupp_ps_supplycost#2410,cval_partsupp_ps_comment#2411,cps_availqty#2412,cps_supplycost#2413,cps_comment#2414] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#2474 AS rid_3#2491, cval_part_p_name#2475 AS cval_part_p_name_3#2492, cval_part_p_mfgr#2476 AS cval_part_p_mfgr_3#2493, cval_part_p_type#2477 AS cval_part_p_type_3#2494, cval_part_p_size#2478 AS cval_part_p_size_3#2495, cval_part_p_container#2479 AS cval_part_p_container_3#2496, cval_part_p_retailprice#2480 AS cval_part_p_retailprice_3#2497, cval_part_p_comment#2481 AS cval_part_p_comment_3#2498, cval_part_p_brand#2482 AS cval_part_p_brand_3#2499, cp_name#2483 AS cp_name_3#2500, cp_mfgr#2484 AS cp_mfgr_3#2501, cp_type#2485 AS cp_type_3#2502, cp_size#2486 AS cp_size_3#2503, cp_container#2487 AS cp_container_3#2504, cp_retailprice#2488 AS cp_retailprice_3#2505, cp_comment#2489 AS cp_comment_3#2506, cp_brand#2490 AS cp_brand_3#2507]
            :  :  :        +- Relation[rid#2474,cval_part_p_name#2475,cval_part_p_mfgr#2476,cval_part_p_type#2477,cval_part_p_size#2478,cval_part_p_container#2479,cval_part_p_retailprice#2480,cval_part_p_comment#2481,cval_part_p_brand#2482,cp_name#2483,cp_mfgr#2484,cp_type#2485,cp_size#2486,cp_container#2487,cp_retailprice#2488,cp_comment#2489,cp_brand#2490] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#2574 AS rid_2#2585, cpfk_part_partsupp#2575 AS cpfk_part_partsupp_2#2586, cfpk_partsupp_part#2576 AS cfpk_partsupp_part_2#2587, cpfk_supplier_partsupp#2577 AS cpfk_supplier_partsupp_2#2588, cfpk_partsupp_supplier#2578 AS cfpk_partsupp_supplier_2#2589, cval_partsupp_ps_availqty#2579 AS cval_partsupp_ps_availqty_2#2590, cval_partsupp_ps_supplycost#2580 AS cval_partsupp_ps_supplycost_2#2591, cval_partsupp_ps_comment#2581 AS cval_partsupp_ps_comment_2#2592, cps_availqty#2582 AS cps_availqty_2#2593, cps_supplycost#2583 AS cps_supplycost_2#2594, cps_comment#2584 AS cps_comment_2#2595]
            :  :     :  +- Relation[rid#2574,cpfk_part_partsupp#2575,cfpk_partsupp_part#2576,cpfk_supplier_partsupp#2577,cfpk_partsupp_supplier#2578,cval_partsupp_ps_availqty#2579,cval_partsupp_ps_supplycost#2580,cval_partsupp_ps_comment#2581,cps_availqty#2582,cps_supplycost#2583,cps_comment#2584] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#2596 AS rid_4#2629, cpfk_orders_lineitem#2597 AS cpfk_orders_lineitem_4#2630, cpfk_supplier_lineitem#2598 AS cpfk_supplier_lineitem_4#2631, cfpk_lineitem_supplier#2599 AS cfpk_lineitem_supplier_4#2632, cfpk_lineitem_partsupp#2600 AS cfpk_lineitem_partsupp_4#2633, cpfk_part_lineitem#2601 AS cpfk_part_lineitem_4#2634, cfpk_lineitem_part#2602 AS cfpk_lineitem_part_4#2635, cpfk_partsupp_lineitem#2603 AS cpfk_partsupp_lineitem_4#2636, cfpk_lineitem_orders#2604 AS cfpk_lineitem_orders_4#2637, cval_lineitem_l_quantity#2605 AS cval_lineitem_l_quantity_4#2638, cval_lineitem_l_extendedprice#2606 AS cval_lineitem_l_extendedprice_4#2639, cval_lineitem_l_discount#2607 AS cval_lineitem_l_discount_4#2640, cval_lineitem_l_tax#2608 AS cval_lineitem_l_tax_4#2641, cval_lineitem_l_returnflag#2609 AS cval_lineitem_l_returnflag_4#2642, cval_lineitem_l_linestatus#2610 AS cval_lineitem_l_linestatus_4#2643, cval_lineitem_l_commitdate#2611 AS cval_lineitem_l_commitdate_4#2644, cval_lineitem_l_receiptdate#2612 AS cval_lineitem_l_receiptdate_4#2645, cval_lineitem_l_shipinstruct#2613 AS cval_lineitem_l_shipinstruct_4#2646, cval_lineitem_l_shipmode#2614 AS cval_lineitem_l_shipmode_4#2647, cval_lineitem_l_comment#2615 AS cval_lineitem_l_comment_4#2648, cval_lineitem_l_shipdate#2616 AS cval_lineitem_l_shipdate_4#2649, cl_quantity#2617 AS cl_quantity_4#2650, cl_extendedprice#2618 AS cl_extendedprice_4#2651, cl_discount#2619 AS cl_discount_4#2652, ... 9 more fields]
            :  :        +- Relation[rid#2596,cpfk_orders_lineitem#2597,cpfk_supplier_lineitem#2598,cfpk_lineitem_supplier#2599,cfpk_lineitem_partsupp#2600,cpfk_part_lineitem#2601,cfpk_lineitem_part#2602,cpfk_partsupp_lineitem#2603,cfpk_lineitem_orders#2604,cval_lineitem_l_quantity#2605,cval_lineitem_l_extendedprice#2606,cval_lineitem_l_discount#2607,cval_lineitem_l_tax#2608,cval_lineitem_l_returnflag#2609,cval_lineitem_l_linestatus#2610,cval_lineitem_l_commitdate#2611,cval_lineitem_l_receiptdate#2612,cval_lineitem_l_shipinstruct#2613,cval_lineitem_l_shipmode#2614,cval_lineitem_l_comment#2615,cval_lineitem_l_shipdate#2616,cl_quantity#2617,cl_extendedprice#2618,cl_discount#2619,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#2508 AS rid_4#2541, cpfk_orders_lineitem#2509 AS cpfk_orders_lineitem_4#2542, cpfk_supplier_lineitem#2510 AS cpfk_supplier_lineitem_4#2543, cfpk_lineitem_supplier#2511 AS cfpk_lineitem_supplier_4#2544, cfpk_lineitem_partsupp#2512 AS cfpk_lineitem_partsupp_4#2545, cpfk_part_lineitem#2513 AS cpfk_part_lineitem_4#2546, cfpk_lineitem_part#2514 AS cfpk_lineitem_part_4#2547, cpfk_partsupp_lineitem#2515 AS cpfk_partsupp_lineitem_4#2548, cfpk_lineitem_orders#2516 AS cfpk_lineitem_orders_4#2549, cval_lineitem_l_quantity#2517 AS cval_lineitem_l_quantity_4#2550, cval_lineitem_l_extendedprice#2518 AS cval_lineitem_l_extendedprice_4#2551, cval_lineitem_l_discount#2519 AS cval_lineitem_l_discount_4#2552, cval_lineitem_l_tax#2520 AS cval_lineitem_l_tax_4#2553, cval_lineitem_l_returnflag#2521 AS cval_lineitem_l_returnflag_4#2554, cval_lineitem_l_linestatus#2522 AS cval_lineitem_l_linestatus_4#2555, cval_lineitem_l_commitdate#2523 AS cval_lineitem_l_commitdate_4#2556, cval_lineitem_l_receiptdate#2524 AS cval_lineitem_l_receiptdate_4#2557, cval_lineitem_l_shipinstruct#2525 AS cval_lineitem_l_shipinstruct_4#2558, cval_lineitem_l_shipmode#2526 AS cval_lineitem_l_shipmode_4#2559, cval_lineitem_l_comment#2527 AS cval_lineitem_l_comment_4#2560, cval_lineitem_l_shipdate#2528 AS cval_lineitem_l_shipdate_4#2561, cl_quantity#2529 AS cl_quantity_4#2562, cl_extendedprice#2530 AS cl_extendedprice_4#2563, cl_discount#2531 AS cl_discount_4#2564, ... 9 more fields]
            :     +- Relation[rid#2508,cpfk_orders_lineitem#2509,cpfk_supplier_lineitem#2510,cfpk_lineitem_supplier#2511,cfpk_lineitem_partsupp#2512,cpfk_part_lineitem#2513,cfpk_lineitem_part#2514,cpfk_partsupp_lineitem#2515,cfpk_lineitem_orders#2516,cval_lineitem_l_quantity#2517,cval_lineitem_l_extendedprice#2518,cval_lineitem_l_discount#2519,cval_lineitem_l_tax#2520,cval_lineitem_l_returnflag#2521,cval_lineitem_l_linestatus#2522,cval_lineitem_l_commitdate#2523,cval_lineitem_l_receiptdate#2524,cval_lineitem_l_shipinstruct#2525,cval_lineitem_l_shipmode#2526,cval_lineitem_l_comment#2527,cval_lineitem_l_shipdate#2528,cl_quantity#2529,cl_extendedprice#2530,cl_discount#2531,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#2662 AS rid_5#2679, cpfk_customer_orders#2663 AS cpfk_customer_orders_5#2680, cfpk_orders_customer#2664 AS cfpk_orders_customer_5#2681, cval_orders_o_orderstatus#2665 AS cval_orders_o_orderstatus_5#2682, cval_orders_o_totalprice#2666 AS cval_orders_o_totalprice_5#2683, cval_orders_o_orderpriority#2667 AS cval_orders_o_orderpriority_5#2684, cval_orders_o_clerk#2668 AS cval_orders_o_clerk_5#2685, cval_orders_o_shippriority#2669 AS cval_orders_o_shippriority_5#2686, cval_orders_o_comment#2670 AS cval_orders_o_comment_5#2687, cval_orders_o_orderdate#2671 AS cval_orders_o_orderdate_5#2688, co_orderstatus#2672 AS co_orderstatus_5#2689, co_totalprice#2673 AS co_totalprice_5#2690, co_orderpriority#2674 AS co_orderpriority_5#2691, co_clerk#2675 AS co_clerk_5#2692, co_shippriority#2676 AS co_shippriority_5#2693, co_comment#2677 AS co_comment_5#2694, co_orderdate#2678 AS co_orderdate_5#2695]
               +- Relation[rid#2662,cpfk_customer_orders#2663,cfpk_orders_customer#2664,cval_orders_o_orderstatus#2665,cval_orders_o_totalprice#2666,cval_orders_o_orderpriority#2667,cval_orders_o_clerk#2668,cval_orders_o_shippriority#2669,cval_orders_o_comment#2670,cval_orders_o_orderdate#2671,co_orderstatus#2672,co_totalprice#2673,co_orderpriority#2674,co_clerk#2675,co_shippriority#2676,co_comment#2677,co_orderdate#2678] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 163067ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/11 02:51:59 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 02:51:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2806L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 02:51:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 02:51:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 02:51:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2806L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#2808 AS rid_0#2841, cpfk_orders_lineitem#2809 AS cpfk_orders_lineitem_0#2842, cpfk_supplier_lineitem#2810 AS cpfk_supplier_lineitem_0#2843, cfpk_lineitem_supplier#2811 AS cfpk_lineitem_supplier_0#2844, cfpk_lineitem_partsupp#2812 AS cfpk_lineitem_partsupp_0#2845, cpfk_part_lineitem#2813 AS cpfk_part_lineitem_0#2846, cfpk_lineitem_part#2814 AS cfpk_lineitem_part_0#2847, cpfk_partsupp_lineitem#2815 AS cpfk_partsupp_lineitem_0#2848, cfpk_lineitem_orders#2816 AS cfpk_lineitem_orders_0#2849, cval_lineitem_l_quantity#2817 AS cval_lineitem_l_quantity_0#2850, cval_lineitem_l_extendedprice#2818 AS cval_lineitem_l_extendedprice_0#2851, cval_lineitem_l_discount#2819 AS cval_lineitem_l_discount_0#2852, cval_lineitem_l_tax#2820 AS cval_lineitem_l_tax_0#2853, cval_lineitem_l_returnflag#2821 AS cval_lineitem_l_returnflag_0#2854, cval_lineitem_l_linestatus#2822 AS cval_lineitem_l_linestatus_0#2855, cval_lineitem_l_commitdate#2823 AS cval_lineitem_l_commitdate_0#2856, cval_lineitem_l_receiptdate#2824 AS cval_lineitem_l_receiptdate_0#2857, cval_lineitem_l_shipinstruct#2825 AS cval_lineitem_l_shipinstruct_0#2858, cval_lineitem_l_shipmode#2826 AS cval_lineitem_l_shipmode_0#2859, cval_lineitem_l_comment#2827 AS cval_lineitem_l_comment_0#2860, cval_lineitem_l_shipdate#2828 AS cval_lineitem_l_shipdate_0#2861, cl_quantity#2829 AS cl_quantity_0#2862, cl_extendedprice#2830 AS cl_extendedprice_0#2863, cl_discount#2831 AS cl_discount_0#2864, ... 9 more fields]
            :     :     :  :  +- Relation[rid#2808,cpfk_orders_lineitem#2809,cpfk_supplier_lineitem#2810,cfpk_lineitem_supplier#2811,cfpk_lineitem_partsupp#2812,cpfk_part_lineitem#2813,cfpk_lineitem_part#2814,cpfk_partsupp_lineitem#2815,cfpk_lineitem_orders#2816,cval_lineitem_l_quantity#2817,cval_lineitem_l_extendedprice#2818,cval_lineitem_l_discount#2819,cval_lineitem_l_tax#2820,cval_lineitem_l_returnflag#2821,cval_lineitem_l_linestatus#2822,cval_lineitem_l_commitdate#2823,cval_lineitem_l_receiptdate#2824,cval_lineitem_l_shipinstruct#2825,cval_lineitem_l_shipmode#2826,cval_lineitem_l_comment#2827,cval_lineitem_l_shipdate#2828,cl_quantity#2829,cl_extendedprice#2830,cl_discount#2831,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#2874 AS rid_0#2907, cpfk_orders_lineitem#2875 AS cpfk_orders_lineitem_0#2908, cpfk_supplier_lineitem#2876 AS cpfk_supplier_lineitem_0#2909, cfpk_lineitem_supplier#2877 AS cfpk_lineitem_supplier_0#2910, cfpk_lineitem_partsupp#2878 AS cfpk_lineitem_partsupp_0#2911, cpfk_part_lineitem#2879 AS cpfk_part_lineitem_0#2912, cfpk_lineitem_part#2880 AS cfpk_lineitem_part_0#2913, cpfk_partsupp_lineitem#2881 AS cpfk_partsupp_lineitem_0#2914, cfpk_lineitem_orders#2882 AS cfpk_lineitem_orders_0#2915, cval_lineitem_l_quantity#2883 AS cval_lineitem_l_quantity_0#2916, cval_lineitem_l_extendedprice#2884 AS cval_lineitem_l_extendedprice_0#2917, cval_lineitem_l_discount#2885 AS cval_lineitem_l_discount_0#2918, cval_lineitem_l_tax#2886 AS cval_lineitem_l_tax_0#2919, cval_lineitem_l_returnflag#2887 AS cval_lineitem_l_returnflag_0#2920, cval_lineitem_l_linestatus#2888 AS cval_lineitem_l_linestatus_0#2921, cval_lineitem_l_commitdate#2889 AS cval_lineitem_l_commitdate_0#2922, cval_lineitem_l_receiptdate#2890 AS cval_lineitem_l_receiptdate_0#2923, cval_lineitem_l_shipinstruct#2891 AS cval_lineitem_l_shipinstruct_0#2924, cval_lineitem_l_shipmode#2892 AS cval_lineitem_l_shipmode_0#2925, cval_lineitem_l_comment#2893 AS cval_lineitem_l_comment_0#2926, cval_lineitem_l_shipdate#2894 AS cval_lineitem_l_shipdate_0#2927, cl_quantity#2895 AS cl_quantity_0#2928, cl_extendedprice#2896 AS cl_extendedprice_0#2929, cl_discount#2897 AS cl_discount_0#2930, ... 9 more fields]
            :     :     :        +- Relation[rid#2874,cpfk_orders_lineitem#2875,cpfk_supplier_lineitem#2876,cfpk_lineitem_supplier#2877,cfpk_lineitem_partsupp#2878,cpfk_part_lineitem#2879,cfpk_lineitem_part#2880,cpfk_partsupp_lineitem#2881,cfpk_lineitem_orders#2882,cval_lineitem_l_quantity#2883,cval_lineitem_l_extendedprice#2884,cval_lineitem_l_discount#2885,cval_lineitem_l_tax#2886,cval_lineitem_l_returnflag#2887,cval_lineitem_l_linestatus#2888,cval_lineitem_l_commitdate#2889,cval_lineitem_l_receiptdate#2890,cval_lineitem_l_shipinstruct#2891,cval_lineitem_l_shipmode#2892,cval_lineitem_l_comment#2893,cval_lineitem_l_shipdate#2894,cl_quantity#2895,cl_extendedprice#2896,cl_discount#2897,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#2940 AS rid_1#2957, cpfk_customer_orders#2941 AS cpfk_customer_orders_1#2958, cfpk_orders_customer#2942 AS cfpk_orders_customer_1#2959, cval_orders_o_orderstatus#2943 AS cval_orders_o_orderstatus_1#2960, cval_orders_o_totalprice#2944 AS cval_orders_o_totalprice_1#2961, cval_orders_o_orderpriority#2945 AS cval_orders_o_orderpriority_1#2962, cval_orders_o_clerk#2946 AS cval_orders_o_clerk_1#2963, cval_orders_o_shippriority#2947 AS cval_orders_o_shippriority_1#2964, cval_orders_o_comment#2948 AS cval_orders_o_comment_1#2965, cval_orders_o_orderdate#2949 AS cval_orders_o_orderdate_1#2966, co_orderstatus#2950 AS co_orderstatus_1#2967, co_totalprice#2951 AS co_totalprice_1#2968, co_orderpriority#2952 AS co_orderpriority_1#2969, co_clerk#2953 AS co_clerk_1#2970, co_shippriority#2954 AS co_shippriority_1#2971, co_comment#2955 AS co_comment_1#2972, co_orderdate#2956 AS co_orderdate_1#2973]
            :     :        +- Relation[rid#2940,cpfk_customer_orders#2941,cfpk_orders_customer#2942,cval_orders_o_orderstatus#2943,cval_orders_o_totalprice#2944,cval_orders_o_orderpriority#2945,cval_orders_o_clerk#2946,cval_orders_o_shippriority#2947,cval_orders_o_comment#2948,cval_orders_o_orderdate#2949,co_orderstatus#2950,co_totalprice#2951,co_orderpriority#2952,co_clerk#2953,co_shippriority#2954,co_comment#2955,co_orderdate#2956] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#2974 AS rid_2#2989, cpfk_nation_customer#2975 AS cpfk_nation_customer_2#2990, cfpk_customer_nation#2976 AS cfpk_customer_nation_2#2991, cval_customer_c_name#2977 AS cval_customer_c_name_2#2992, cval_customer_c_address#2978 AS cval_customer_c_address_2#2993, cval_customer_c_phone#2979 AS cval_customer_c_phone_2#2994, cval_customer_c_acctbal#2980 AS cval_customer_c_acctbal_2#2995, cval_customer_c_comment#2981 AS cval_customer_c_comment_2#2996, cval_customer_c_mktsegment#2982 AS cval_customer_c_mktsegment_2#2997, cc_name#2983 AS cc_name_2#2998, cc_address#2984 AS cc_address_2#2999, cc_phone#2985 AS cc_phone_2#3000, cc_acctbal#2986 AS cc_acctbal_2#3001, cc_comment#2987 AS cc_comment_2#3002, cc_mktsegment#2988 AS cc_mktsegment_2#3003]
            :        +- Relation[rid#2974,cpfk_nation_customer#2975,cfpk_customer_nation#2976,cval_customer_c_name#2977,cval_customer_c_address#2978,cval_customer_c_phone#2979,cval_customer_c_acctbal#2980,cval_customer_c_comment#2981,cval_customer_c_mktsegment#2982,cc_name#2983,cc_address#2984,cc_phone#2985,cc_acctbal#2986,cc_comment#2987,cc_mktsegment#2988] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#3004 AS rid_3#3011, cpfk_region_nation#3005 AS cpfk_region_nation_3#3012, cfpk_nation_region#3006 AS cfpk_nation_region_3#3013, cval_nation_n_name#3007 AS cval_nation_n_name_3#3014, cval_nation_n_comment#3008 AS cval_nation_n_comment_3#3015, cn_name#3009 AS cn_name_3#3016, cn_comment#3010 AS cn_comment_3#3017]
               +- Relation[rid#3004,cpfk_region_nation#3005,cfpk_nation_region#3006,cval_nation_n_name#3007,cval_nation_n_comment#3008,cn_name#3009,cn_comment#3010] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 61294ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/11 02:53:00 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 02:53:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3096L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 02:53:00 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 02:53:00 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 02:53:00 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 02:53:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 02:53:00 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 02:53:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 02:53:00 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 02:53:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 02:53:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 02:53:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 02:53:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 02:53:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 02:53:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 02:53:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 02:53:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 02:53:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 02:53:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3096L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#3098 AS rid_0#3103, cval_region_r_name#3099 AS cval_region_r_name_0#3104, cval_region_r_comment#3100 AS cval_region_r_comment_0#3105, cr_name#3101 AS cr_name_0#3106, cr_comment#3102 AS cr_comment_0#3107]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#3098,cval_region_r_name#3099,cval_region_r_comment#3100,cr_name#3101,cr_comment#3102] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#3108 AS rid_0#3113, cval_region_r_name#3109 AS cval_region_r_name_0#3114, cval_region_r_comment#3110 AS cval_region_r_comment_0#3115, cr_name#3111 AS cr_name_0#3116, cr_comment#3112 AS cr_comment_0#3117]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#3108,cval_region_r_name#3109,cval_region_r_comment#3110,cr_name#3111,cr_comment#3112] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :     :- Project [rid#3132 AS rid_0#3137, cval_region_r_name#3133 AS cval_region_r_name_0#3138, cval_region_r_comment#3134 AS cval_region_r_comment_0#3139, cr_name#3135 AS cr_name_0#3140, cr_comment#3136 AS cr_comment_0#3141]
         :     :  :  :  :  :  :  :  :     :  +- Relation[rid#3132,cval_region_r_name#3133,cval_region_r_comment#3134,cr_name#3135,cr_comment#3136] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :     +- Project [rid#3142 AS rid_1#3149, cpfk_region_nation#3143 AS cpfk_region_nation_1#3150, cfpk_nation_region#3144 AS cfpk_nation_region_1#3151, cval_nation_n_name#3145 AS cval_nation_n_name_1#3152, cval_nation_n_comment#3146 AS cval_nation_n_comment_1#3153, cn_name#3147 AS cn_name_1#3154, cn_comment#3148 AS cn_comment_1#3155]
         :     :  :  :  :  :  :  :  :        +- Relation[rid#3142,cpfk_region_nation#3143,cfpk_nation_region#3144,cval_nation_n_name#3145,cval_nation_n_comment#3146,cn_name#3147,cn_comment#3148] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#3118 AS rid_1#3125, cpfk_region_nation#3119 AS cpfk_region_nation_1#3126, cfpk_nation_region#3120 AS cfpk_nation_region_1#3127, cval_nation_n_name#3121 AS cval_nation_n_name_1#3128, cval_nation_n_comment#3122 AS cval_nation_n_comment_1#3129, cn_name#3123 AS cn_name_1#3130, cn_comment#3124 AS cn_comment_1#3131]
         :     :  :  :  :  :  :  :     +- Relation[rid#3118,cpfk_region_nation#3119,cfpk_nation_region#3120,cval_nation_n_name#3121,cval_nation_n_comment#3122,cn_name#3123,cn_comment#3124] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :     :- Project [rid#3186 AS rid_1#3193, cpfk_region_nation#3187 AS cpfk_region_nation_1#3194, cfpk_nation_region#3188 AS cfpk_nation_region_1#3195, cval_nation_n_name#3189 AS cval_nation_n_name_1#3196, cval_nation_n_comment#3190 AS cval_nation_n_comment_1#3197, cn_name#3191 AS cn_name_1#3198, cn_comment#3192 AS cn_comment_1#3199]
         :     :  :  :  :  :  :     :  +- Relation[rid#3186,cpfk_region_nation#3187,cfpk_nation_region#3188,cval_nation_n_name#3189,cval_nation_n_comment#3190,cn_name#3191,cn_comment#3192] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :     +- Project [rid#3200 AS rid_2#3215, cpfk_nation_customer#3201 AS cpfk_nation_customer_2#3216, cfpk_customer_nation#3202 AS cfpk_customer_nation_2#3217, cval_customer_c_name#3203 AS cval_customer_c_name_2#3218, cval_customer_c_address#3204 AS cval_customer_c_address_2#3219, cval_customer_c_phone#3205 AS cval_customer_c_phone_2#3220, cval_customer_c_acctbal#3206 AS cval_customer_c_acctbal_2#3221, cval_customer_c_comment#3207 AS cval_customer_c_comment_2#3222, cval_customer_c_mktsegment#3208 AS cval_customer_c_mktsegment_2#3223, cc_name#3209 AS cc_name_2#3224, cc_address#3210 AS cc_address_2#3225, cc_phone#3211 AS cc_phone_2#3226, cc_acctbal#3212 AS cc_acctbal_2#3227, cc_comment#3213 AS cc_comment_2#3228, cc_mktsegment#3214 AS cc_mktsegment_2#3229]
         :     :  :  :  :  :  :        +- Relation[rid#3200,cpfk_nation_customer#3201,cfpk_customer_nation#3202,cval_customer_c_name#3203,cval_customer_c_address#3204,cval_customer_c_phone#3205,cval_customer_c_acctbal#3206,cval_customer_c_comment#3207,cval_customer_c_mktsegment#3208,cc_name#3209,cc_address#3210,cc_phone#3211,cc_acctbal#3212,cc_comment#3213,cc_mktsegment#3214] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#3156 AS rid_2#3171, cpfk_nation_customer#3157 AS cpfk_nation_customer_2#3172, cfpk_customer_nation#3158 AS cfpk_customer_nation_2#3173, cval_customer_c_name#3159 AS cval_customer_c_name_2#3174, cval_customer_c_address#3160 AS cval_customer_c_address_2#3175, cval_customer_c_phone#3161 AS cval_customer_c_phone_2#3176, cval_customer_c_acctbal#3162 AS cval_customer_c_acctbal_2#3177, cval_customer_c_comment#3163 AS cval_customer_c_comment_2#3178, cval_customer_c_mktsegment#3164 AS cval_customer_c_mktsegment_2#3179, cc_name#3165 AS cc_name_2#3180, cc_address#3166 AS cc_address_2#3181, cc_phone#3167 AS cc_phone_2#3182, cc_acctbal#3168 AS cc_acctbal_2#3183, cc_comment#3169 AS cc_comment_2#3184, cc_mktsegment#3170 AS cc_mktsegment_2#3185]
         :     :  :  :  :  :     +- Relation[rid#3156,cpfk_nation_customer#3157,cfpk_customer_nation#3158,cval_customer_c_name#3159,cval_customer_c_address#3160,cval_customer_c_phone#3161,cval_customer_c_acctbal#3162,cval_customer_c_comment#3163,cval_customer_c_mktsegment#3164,cc_name#3165,cc_address#3166,cc_phone#3167,cc_acctbal#3168,cc_comment#3169,cc_mktsegment#3170] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :     :- Project [rid#3264 AS rid_2#3279, cpfk_nation_customer#3265 AS cpfk_nation_customer_2#3280, cfpk_customer_nation#3266 AS cfpk_customer_nation_2#3281, cval_customer_c_name#3267 AS cval_customer_c_name_2#3282, cval_customer_c_address#3268 AS cval_customer_c_address_2#3283, cval_customer_c_phone#3269 AS cval_customer_c_phone_2#3284, cval_customer_c_acctbal#3270 AS cval_customer_c_acctbal_2#3285, cval_customer_c_comment#3271 AS cval_customer_c_comment_2#3286, cval_customer_c_mktsegment#3272 AS cval_customer_c_mktsegment_2#3287, cc_name#3273 AS cc_name_2#3288, cc_address#3274 AS cc_address_2#3289, cc_phone#3275 AS cc_phone_2#3290, cc_acctbal#3276 AS cc_acctbal_2#3291, cc_comment#3277 AS cc_comment_2#3292, cc_mktsegment#3278 AS cc_mktsegment_2#3293]
         :     :  :  :  :     :  +- Relation[rid#3264,cpfk_nation_customer#3265,cfpk_customer_nation#3266,cval_customer_c_name#3267,cval_customer_c_address#3268,cval_customer_c_phone#3269,cval_customer_c_acctbal#3270,cval_customer_c_comment#3271,cval_customer_c_mktsegment#3272,cc_name#3273,cc_address#3274,cc_phone#3275,cc_acctbal#3276,cc_comment#3277,cc_mktsegment#3278] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :     +- Project [rid#3294 AS rid_3#3311, cpfk_customer_orders#3295 AS cpfk_customer_orders_3#3312, cfpk_orders_customer#3296 AS cfpk_orders_customer_3#3313, cval_orders_o_orderstatus#3297 AS cval_orders_o_orderstatus_3#3314, cval_orders_o_totalprice#3298 AS cval_orders_o_totalprice_3#3315, cval_orders_o_orderpriority#3299 AS cval_orders_o_orderpriority_3#3316, cval_orders_o_clerk#3300 AS cval_orders_o_clerk_3#3317, cval_orders_o_shippriority#3301 AS cval_orders_o_shippriority_3#3318, cval_orders_o_comment#3302 AS cval_orders_o_comment_3#3319, cval_orders_o_orderdate#3303 AS cval_orders_o_orderdate_3#3320, co_orderstatus#3304 AS co_orderstatus_3#3321, co_totalprice#3305 AS co_totalprice_3#3322, co_orderpriority#3306 AS co_orderpriority_3#3323, co_clerk#3307 AS co_clerk_3#3324, co_shippriority#3308 AS co_shippriority_3#3325, co_comment#3309 AS co_comment_3#3326, co_orderdate#3310 AS co_orderdate_3#3327]
         :     :  :  :  :        +- Relation[rid#3294,cpfk_customer_orders#3295,cfpk_orders_customer#3296,cval_orders_o_orderstatus#3297,cval_orders_o_totalprice#3298,cval_orders_o_orderpriority#3299,cval_orders_o_clerk#3300,cval_orders_o_shippriority#3301,cval_orders_o_comment#3302,cval_orders_o_orderdate#3303,co_orderstatus#3304,co_totalprice#3305,co_orderpriority#3306,co_clerk#3307,co_shippriority#3308,co_comment#3309,co_orderdate#3310] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#3230 AS rid_3#3247, cpfk_customer_orders#3231 AS cpfk_customer_orders_3#3248, cfpk_orders_customer#3232 AS cfpk_orders_customer_3#3249, cval_orders_o_orderstatus#3233 AS cval_orders_o_orderstatus_3#3250, cval_orders_o_totalprice#3234 AS cval_orders_o_totalprice_3#3251, cval_orders_o_orderpriority#3235 AS cval_orders_o_orderpriority_3#3252, cval_orders_o_clerk#3236 AS cval_orders_o_clerk_3#3253, cval_orders_o_shippriority#3237 AS cval_orders_o_shippriority_3#3254, cval_orders_o_comment#3238 AS cval_orders_o_comment_3#3255, cval_orders_o_orderdate#3239 AS cval_orders_o_orderdate_3#3256, co_orderstatus#3240 AS co_orderstatus_3#3257, co_totalprice#3241 AS co_totalprice_3#3258, co_orderpriority#3242 AS co_orderpriority_3#3259, co_clerk#3243 AS co_clerk_3#3260, co_shippriority#3244 AS co_shippriority_3#3261, co_comment#3245 AS co_comment_3#3262, co_orderdate#3246 AS co_orderdate_3#3263]
         :     :  :  :     +- Relation[rid#3230,cpfk_customer_orders#3231,cfpk_orders_customer#3232,cval_orders_o_orderstatus#3233,cval_orders_o_totalprice#3234,cval_orders_o_orderpriority#3235,cval_orders_o_clerk#3236,cval_orders_o_shippriority#3237,cval_orders_o_comment#3238,cval_orders_o_orderdate#3239,co_orderstatus#3240,co_totalprice#3241,co_orderpriority#3242,co_clerk#3243,co_shippriority#3244,co_comment#3245,co_orderdate#3246] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :     :- Project [rid#3394 AS rid_3#3411, cpfk_customer_orders#3395 AS cpfk_customer_orders_3#3412, cfpk_orders_customer#3396 AS cfpk_orders_customer_3#3413, cval_orders_o_orderstatus#3397 AS cval_orders_o_orderstatus_3#3414, cval_orders_o_totalprice#3398 AS cval_orders_o_totalprice_3#3415, cval_orders_o_orderpriority#3399 AS cval_orders_o_orderpriority_3#3416, cval_orders_o_clerk#3400 AS cval_orders_o_clerk_3#3417, cval_orders_o_shippriority#3401 AS cval_orders_o_shippriority_3#3418, cval_orders_o_comment#3402 AS cval_orders_o_comment_3#3419, cval_orders_o_orderdate#3403 AS cval_orders_o_orderdate_3#3420, co_orderstatus#3404 AS co_orderstatus_3#3421, co_totalprice#3405 AS co_totalprice_3#3422, co_orderpriority#3406 AS co_orderpriority_3#3423, co_clerk#3407 AS co_clerk_3#3424, co_shippriority#3408 AS co_shippriority_3#3425, co_comment#3409 AS co_comment_3#3426, co_orderdate#3410 AS co_orderdate_3#3427]
         :     :  :     :  +- Relation[rid#3394,cpfk_customer_orders#3395,cfpk_orders_customer#3396,cval_orders_o_orderstatus#3397,cval_orders_o_totalprice#3398,cval_orders_o_orderpriority#3399,cval_orders_o_clerk#3400,cval_orders_o_shippriority#3401,cval_orders_o_comment#3402,cval_orders_o_orderdate#3403,co_orderstatus#3404,co_totalprice#3405,co_orderpriority#3406,co_clerk#3407,co_shippriority#3408,co_comment#3409,co_orderdate#3410] JDBCRelation(torders) [numPartitions=1]
         :     :  :     +- Project [rid#3428 AS rid_4#3461, cpfk_orders_lineitem#3429 AS cpfk_orders_lineitem_4#3462, cpfk_supplier_lineitem#3430 AS cpfk_supplier_lineitem_4#3463, cfpk_lineitem_supplier#3431 AS cfpk_lineitem_supplier_4#3464, cfpk_lineitem_partsupp#3432 AS cfpk_lineitem_partsupp_4#3465, cpfk_part_lineitem#3433 AS cpfk_part_lineitem_4#3466, cfpk_lineitem_part#3434 AS cfpk_lineitem_part_4#3467, cpfk_partsupp_lineitem#3435 AS cpfk_partsupp_lineitem_4#3468, cfpk_lineitem_orders#3436 AS cfpk_lineitem_orders_4#3469, cval_lineitem_l_quantity#3437 AS cval_lineitem_l_quantity_4#3470, cval_lineitem_l_extendedprice#3438 AS cval_lineitem_l_extendedprice_4#3471, cval_lineitem_l_discount#3439 AS cval_lineitem_l_discount_4#3472, cval_lineitem_l_tax#3440 AS cval_lineitem_l_tax_4#3473, cval_lineitem_l_returnflag#3441 AS cval_lineitem_l_returnflag_4#3474, cval_lineitem_l_linestatus#3442 AS cval_lineitem_l_linestatus_4#3475, cval_lineitem_l_commitdate#3443 AS cval_lineitem_l_commitdate_4#3476, cval_lineitem_l_receiptdate#3444 AS cval_lineitem_l_receiptdate_4#3477, cval_lineitem_l_shipinstruct#3445 AS cval_lineitem_l_shipinstruct_4#3478, cval_lineitem_l_shipmode#3446 AS cval_lineitem_l_shipmode_4#3479, cval_lineitem_l_comment#3447 AS cval_lineitem_l_comment_4#3480, cval_lineitem_l_shipdate#3448 AS cval_lineitem_l_shipdate_4#3481, cl_quantity#3449 AS cl_quantity_4#3482, cl_extendedprice#3450 AS cl_extendedprice_4#3483, cl_discount#3451 AS cl_discount_4#3484, ... 9 more fields]
         :     :  :        +- Relation[rid#3428,cpfk_orders_lineitem#3429,cpfk_supplier_lineitem#3430,cfpk_lineitem_supplier#3431,cfpk_lineitem_partsupp#3432,cpfk_part_lineitem#3433,cfpk_lineitem_part#3434,cpfk_partsupp_lineitem#3435,cfpk_lineitem_orders#3436,cval_lineitem_l_quantity#3437,cval_lineitem_l_extendedprice#3438,cval_lineitem_l_discount#3439,cval_lineitem_l_tax#3440,cval_lineitem_l_returnflag#3441,cval_lineitem_l_linestatus#3442,cval_lineitem_l_commitdate#3443,cval_lineitem_l_receiptdate#3444,cval_lineitem_l_shipinstruct#3445,cval_lineitem_l_shipmode#3446,cval_lineitem_l_comment#3447,cval_lineitem_l_shipdate#3448,cl_quantity#3449,cl_extendedprice#3450,cl_discount#3451,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#3328 AS rid_4#3361, cpfk_orders_lineitem#3329 AS cpfk_orders_lineitem_4#3362, cpfk_supplier_lineitem#3330 AS cpfk_supplier_lineitem_4#3363, cfpk_lineitem_supplier#3331 AS cfpk_lineitem_supplier_4#3364, cfpk_lineitem_partsupp#3332 AS cfpk_lineitem_partsupp_4#3365, cpfk_part_lineitem#3333 AS cpfk_part_lineitem_4#3366, cfpk_lineitem_part#3334 AS cfpk_lineitem_part_4#3367, cpfk_partsupp_lineitem#3335 AS cpfk_partsupp_lineitem_4#3368, cfpk_lineitem_orders#3336 AS cfpk_lineitem_orders_4#3369, cval_lineitem_l_quantity#3337 AS cval_lineitem_l_quantity_4#3370, cval_lineitem_l_extendedprice#3338 AS cval_lineitem_l_extendedprice_4#3371, cval_lineitem_l_discount#3339 AS cval_lineitem_l_discount_4#3372, cval_lineitem_l_tax#3340 AS cval_lineitem_l_tax_4#3373, cval_lineitem_l_returnflag#3341 AS cval_lineitem_l_returnflag_4#3374, cval_lineitem_l_linestatus#3342 AS cval_lineitem_l_linestatus_4#3375, cval_lineitem_l_commitdate#3343 AS cval_lineitem_l_commitdate_4#3376, cval_lineitem_l_receiptdate#3344 AS cval_lineitem_l_receiptdate_4#3377, cval_lineitem_l_shipinstruct#3345 AS cval_lineitem_l_shipinstruct_4#3378, cval_lineitem_l_shipmode#3346 AS cval_lineitem_l_shipmode_4#3379, cval_lineitem_l_comment#3347 AS cval_lineitem_l_comment_4#3380, cval_lineitem_l_shipdate#3348 AS cval_lineitem_l_shipdate_4#3381, cl_quantity#3349 AS cl_quantity_4#3382, cl_extendedprice#3350 AS cl_extendedprice_4#3383, cl_discount#3351 AS cl_discount_4#3384, ... 9 more fields]
         :     :     +- Relation[rid#3328,cpfk_orders_lineitem#3329,cpfk_supplier_lineitem#3330,cfpk_lineitem_supplier#3331,cfpk_lineitem_partsupp#3332,cpfk_part_lineitem#3333,cfpk_lineitem_part#3334,cpfk_partsupp_lineitem#3335,cfpk_lineitem_orders#3336,cval_lineitem_l_quantity#3337,cval_lineitem_l_extendedprice#3338,cval_lineitem_l_discount#3339,cval_lineitem_l_tax#3340,cval_lineitem_l_returnflag#3341,cval_lineitem_l_linestatus#3342,cval_lineitem_l_commitdate#3343,cval_lineitem_l_receiptdate#3344,cval_lineitem_l_shipinstruct#3345,cval_lineitem_l_shipmode#3346,cval_lineitem_l_comment#3347,cval_lineitem_l_shipdate#3348,cl_quantity#3349,cl_extendedprice#3350,cl_discount#3351,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#3494 AS rid_5#3507, cpfk_nation_supplier#3495 AS cpfk_nation_supplier_5#3508, cfpk_supplier_nation#3496 AS cfpk_supplier_nation_5#3509, cval_supplier_s_name#3497 AS cval_supplier_s_name_5#3510, cval_supplier_s_address#3498 AS cval_supplier_s_address_5#3511, cval_supplier_s_phone#3499 AS cval_supplier_s_phone_5#3512, cval_supplier_s_acctbal#3500 AS cval_supplier_s_acctbal_5#3513, cval_supplier_s_comment#3501 AS cval_supplier_s_comment_5#3514, cs_name#3502 AS cs_name_5#3515, cs_address#3503 AS cs_address_5#3516, cs_phone#3504 AS cs_phone_5#3517, cs_acctbal#3505 AS cs_acctbal_5#3518, cs_comment#3506 AS cs_comment_5#3519]
         :        +- Relation[rid#3494,cpfk_nation_supplier#3495,cfpk_supplier_nation#3496,cval_supplier_s_name#3497,cval_supplier_s_address#3498,cval_supplier_s_phone#3499,cval_supplier_s_acctbal#3500,cval_supplier_s_comment#3501,cs_name#3502,cs_address#3503,cs_phone#3504,cs_acctbal#3505,cs_comment#3506] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#3520 AS rid_1#3527, cpfk_region_nation#3521 AS cpfk_region_nation_1#3528, cfpk_nation_region#3522 AS cfpk_nation_region_1#3529, cval_nation_n_name#3523 AS cval_nation_n_name_1#3530, cval_nation_n_comment#3524 AS cval_nation_n_comment_1#3531, cn_name#3525 AS cn_name_1#3532, cn_comment#3526 AS cn_comment_1#3533]
            :  +- Relation[rid#3520,cpfk_region_nation#3521,cfpk_nation_region#3522,cval_nation_n_name#3523,cval_nation_n_comment#3524,cn_name#3525,cn_comment#3526] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#3534 AS rid_5#3547, cpfk_nation_supplier#3535 AS cpfk_nation_supplier_5#3548, cfpk_supplier_nation#3536 AS cfpk_supplier_nation_5#3549, cval_supplier_s_name#3537 AS cval_supplier_s_name_5#3550, cval_supplier_s_address#3538 AS cval_supplier_s_address_5#3551, cval_supplier_s_phone#3539 AS cval_supplier_s_phone_5#3552, cval_supplier_s_acctbal#3540 AS cval_supplier_s_acctbal_5#3553, cval_supplier_s_comment#3541 AS cval_supplier_s_comment_5#3554, cs_name#3542 AS cs_name_5#3555, cs_address#3543 AS cs_address_5#3556, cs_phone#3544 AS cs_phone_5#3557, cs_acctbal#3545 AS cs_acctbal_5#3558, cs_comment#3546 AS cs_comment_5#3559]
               +- Relation[rid#3534,cpfk_nation_supplier#3535,cfpk_supplier_nation#3536,cval_supplier_s_name#3537,cval_supplier_s_address#3538,cval_supplier_s_phone#3539,cval_supplier_s_acctbal#3540,cval_supplier_s_comment#3541,cs_name#3542,cs_address#3543,cs_phone#3544,cs_acctbal#3545,cs_comment#3546] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1206514
Elapsed time: 163616ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/11 02:55:44 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 02:55:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3656L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 02:55:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3656L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#3658 AS rid_0#3675, cval_part_p_name#3659 AS cval_part_p_name_0#3676, cval_part_p_mfgr#3660 AS cval_part_p_mfgr_0#3677, cval_part_p_type#3661 AS cval_part_p_type_0#3678, cval_part_p_size#3662 AS cval_part_p_size_0#3679, cval_part_p_container#3663 AS cval_part_p_container_0#3680, cval_part_p_retailprice#3664 AS cval_part_p_retailprice_0#3681, cval_part_p_comment#3665 AS cval_part_p_comment_0#3682, cval_part_p_brand#3666 AS cval_part_p_brand_0#3683, cp_name#3667 AS cp_name_0#3684, cp_mfgr#3668 AS cp_mfgr_0#3685, cp_type#3669 AS cp_type_0#3686, cp_size#3670 AS cp_size_0#3687, cp_container#3671 AS cp_container_0#3688, cp_retailprice#3672 AS cp_retailprice_0#3689, cp_comment#3673 AS cp_comment_0#3690, cp_brand#3674 AS cp_brand_0#3691]
         :  :  +- Relation[rid#3658,cval_part_p_name#3659,cval_part_p_mfgr#3660,cval_part_p_type#3661,cval_part_p_size#3662,cval_part_p_container#3663,cval_part_p_retailprice#3664,cval_part_p_comment#3665,cval_part_p_brand#3666,cp_name#3667,cp_mfgr#3668,cp_type#3669,cp_size#3670,cp_container#3671,cp_retailprice#3672,cp_comment#3673,cp_brand#3674] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#3758 AS rid_0#3775, cval_part_p_name#3759 AS cval_part_p_name_0#3776, cval_part_p_mfgr#3760 AS cval_part_p_mfgr_0#3777, cval_part_p_type#3761 AS cval_part_p_type_0#3778, cval_part_p_size#3762 AS cval_part_p_size_0#3779, cval_part_p_container#3763 AS cval_part_p_container_0#3780, cval_part_p_retailprice#3764 AS cval_part_p_retailprice_0#3781, cval_part_p_comment#3765 AS cval_part_p_comment_0#3782, cval_part_p_brand#3766 AS cval_part_p_brand_0#3783, cp_name#3767 AS cp_name_0#3784, cp_mfgr#3768 AS cp_mfgr_0#3785, cp_type#3769 AS cp_type_0#3786, cp_size#3770 AS cp_size_0#3787, cp_container#3771 AS cp_container_0#3788, cp_retailprice#3772 AS cp_retailprice_0#3789, cp_comment#3773 AS cp_comment_0#3790, cp_brand#3774 AS cp_brand_0#3791]
         :     :  +- Relation[rid#3758,cval_part_p_name#3759,cval_part_p_mfgr#3760,cval_part_p_type#3761,cval_part_p_size#3762,cval_part_p_container#3763,cval_part_p_retailprice#3764,cval_part_p_comment#3765,cval_part_p_brand#3766,cp_name#3767,cp_mfgr#3768,cp_type#3769,cp_size#3770,cp_container#3771,cp_retailprice#3772,cp_comment#3773,cp_brand#3774] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#3792 AS rid_1#3825, cpfk_orders_lineitem#3793 AS cpfk_orders_lineitem_1#3826, cpfk_supplier_lineitem#3794 AS cpfk_supplier_lineitem_1#3827, cfpk_lineitem_supplier#3795 AS cfpk_lineitem_supplier_1#3828, cfpk_lineitem_partsupp#3796 AS cfpk_lineitem_partsupp_1#3829, cpfk_part_lineitem#3797 AS cpfk_part_lineitem_1#3830, cfpk_lineitem_part#3798 AS cfpk_lineitem_part_1#3831, cpfk_partsupp_lineitem#3799 AS cpfk_partsupp_lineitem_1#3832, cfpk_lineitem_orders#3800 AS cfpk_lineitem_orders_1#3833, cval_lineitem_l_quantity#3801 AS cval_lineitem_l_quantity_1#3834, cval_lineitem_l_extendedprice#3802 AS cval_lineitem_l_extendedprice_1#3835, cval_lineitem_l_discount#3803 AS cval_lineitem_l_discount_1#3836, cval_lineitem_l_tax#3804 AS cval_lineitem_l_tax_1#3837, cval_lineitem_l_returnflag#3805 AS cval_lineitem_l_returnflag_1#3838, cval_lineitem_l_linestatus#3806 AS cval_lineitem_l_linestatus_1#3839, cval_lineitem_l_commitdate#3807 AS cval_lineitem_l_commitdate_1#3840, cval_lineitem_l_receiptdate#3808 AS cval_lineitem_l_receiptdate_1#3841, cval_lineitem_l_shipinstruct#3809 AS cval_lineitem_l_shipinstruct_1#3842, cval_lineitem_l_shipmode#3810 AS cval_lineitem_l_shipmode_1#3843, cval_lineitem_l_comment#3811 AS cval_lineitem_l_comment_1#3844, cval_lineitem_l_shipdate#3812 AS cval_lineitem_l_shipdate_1#3845, cl_quantity#3813 AS cl_quantity_1#3846, cl_extendedprice#3814 AS cl_extendedprice_1#3847, cl_discount#3815 AS cl_discount_1#3848, ... 9 more fields]
         :        +- Relation[rid#3792,cpfk_orders_lineitem#3793,cpfk_supplier_lineitem#3794,cfpk_lineitem_supplier#3795,cfpk_lineitem_partsupp#3796,cpfk_part_lineitem#3797,cfpk_lineitem_part#3798,cpfk_partsupp_lineitem#3799,cfpk_lineitem_orders#3800,cval_lineitem_l_quantity#3801,cval_lineitem_l_extendedprice#3802,cval_lineitem_l_discount#3803,cval_lineitem_l_tax#3804,cval_lineitem_l_returnflag#3805,cval_lineitem_l_linestatus#3806,cval_lineitem_l_commitdate#3807,cval_lineitem_l_receiptdate#3808,cval_lineitem_l_shipinstruct#3809,cval_lineitem_l_shipmode#3810,cval_lineitem_l_comment#3811,cval_lineitem_l_shipdate#3812,cl_quantity#3813,cl_extendedprice#3814,cl_discount#3815,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#3692 AS rid_1#3725, cpfk_orders_lineitem#3693 AS cpfk_orders_lineitem_1#3726, cpfk_supplier_lineitem#3694 AS cpfk_supplier_lineitem_1#3727, cfpk_lineitem_supplier#3695 AS cfpk_lineitem_supplier_1#3728, cfpk_lineitem_partsupp#3696 AS cfpk_lineitem_partsupp_1#3729, cpfk_part_lineitem#3697 AS cpfk_part_lineitem_1#3730, cfpk_lineitem_part#3698 AS cfpk_lineitem_part_1#3731, cpfk_partsupp_lineitem#3699 AS cpfk_partsupp_lineitem_1#3732, cfpk_lineitem_orders#3700 AS cfpk_lineitem_orders_1#3733, cval_lineitem_l_quantity#3701 AS cval_lineitem_l_quantity_1#3734, cval_lineitem_l_extendedprice#3702 AS cval_lineitem_l_extendedprice_1#3735, cval_lineitem_l_discount#3703 AS cval_lineitem_l_discount_1#3736, cval_lineitem_l_tax#3704 AS cval_lineitem_l_tax_1#3737, cval_lineitem_l_returnflag#3705 AS cval_lineitem_l_returnflag_1#3738, cval_lineitem_l_linestatus#3706 AS cval_lineitem_l_linestatus_1#3739, cval_lineitem_l_commitdate#3707 AS cval_lineitem_l_commitdate_1#3740, cval_lineitem_l_receiptdate#3708 AS cval_lineitem_l_receiptdate_1#3741, cval_lineitem_l_shipinstruct#3709 AS cval_lineitem_l_shipinstruct_1#3742, cval_lineitem_l_shipmode#3710 AS cval_lineitem_l_shipmode_1#3743, cval_lineitem_l_comment#3711 AS cval_lineitem_l_comment_1#3744, cval_lineitem_l_shipdate#3712 AS cval_lineitem_l_shipdate_1#3745, cl_quantity#3713 AS cl_quantity_1#3746, cl_extendedprice#3714 AS cl_extendedprice_1#3747, cl_discount#3715 AS cl_discount_1#3748, ... 9 more fields]
            +- Relation[rid#3692,cpfk_orders_lineitem#3693,cpfk_supplier_lineitem#3694,cfpk_lineitem_supplier#3695,cfpk_lineitem_partsupp#3696,cpfk_part_lineitem#3697,cfpk_lineitem_part#3698,cpfk_partsupp_lineitem#3699,cfpk_lineitem_orders#3700,cval_lineitem_l_quantity#3701,cval_lineitem_l_extendedprice#3702,cval_lineitem_l_discount#3703,cval_lineitem_l_tax#3704,cval_lineitem_l_returnflag#3705,cval_lineitem_l_linestatus#3706,cval_lineitem_l_commitdate#3707,cval_lineitem_l_receiptdate#3708,cval_lineitem_l_shipinstruct#3709,cval_lineitem_l_shipmode#3710,cval_lineitem_l_comment#3711,cval_lineitem_l_shipdate#3712,cl_quantity#3713,cl_extendedprice#3714,cl_discount#3715,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 85413ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/11 02:57:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 02:57:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3936L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 02:57:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3936L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#3938 AS rid_0#3971, cpfk_orders_lineitem#3939 AS cpfk_orders_lineitem_0#3972, cpfk_supplier_lineitem#3940 AS cpfk_supplier_lineitem_0#3973, cfpk_lineitem_supplier#3941 AS cfpk_lineitem_supplier_0#3974, cfpk_lineitem_partsupp#3942 AS cfpk_lineitem_partsupp_0#3975, cpfk_part_lineitem#3943 AS cpfk_part_lineitem_0#3976, cfpk_lineitem_part#3944 AS cfpk_lineitem_part_0#3977, cpfk_partsupp_lineitem#3945 AS cpfk_partsupp_lineitem_0#3978, cfpk_lineitem_orders#3946 AS cfpk_lineitem_orders_0#3979, cval_lineitem_l_quantity#3947 AS cval_lineitem_l_quantity_0#3980, cval_lineitem_l_extendedprice#3948 AS cval_lineitem_l_extendedprice_0#3981, cval_lineitem_l_discount#3949 AS cval_lineitem_l_discount_0#3982, cval_lineitem_l_tax#3950 AS cval_lineitem_l_tax_0#3983, cval_lineitem_l_returnflag#3951 AS cval_lineitem_l_returnflag_0#3984, cval_lineitem_l_linestatus#3952 AS cval_lineitem_l_linestatus_0#3985, cval_lineitem_l_commitdate#3953 AS cval_lineitem_l_commitdate_0#3986, cval_lineitem_l_receiptdate#3954 AS cval_lineitem_l_receiptdate_0#3987, cval_lineitem_l_shipinstruct#3955 AS cval_lineitem_l_shipinstruct_0#3988, cval_lineitem_l_shipmode#3956 AS cval_lineitem_l_shipmode_0#3989, cval_lineitem_l_comment#3957 AS cval_lineitem_l_comment_0#3990, cval_lineitem_l_shipdate#3958 AS cval_lineitem_l_shipdate_0#3991, cl_quantity#3959 AS cl_quantity_0#3992, cl_extendedprice#3960 AS cl_extendedprice_0#3993, cl_discount#3961 AS cl_discount_0#3994, ... 9 more fields]
            :  +- Relation[rid#3938,cpfk_orders_lineitem#3939,cpfk_supplier_lineitem#3940,cfpk_lineitem_supplier#3941,cfpk_lineitem_partsupp#3942,cpfk_part_lineitem#3943,cfpk_lineitem_part#3944,cpfk_partsupp_lineitem#3945,cfpk_lineitem_orders#3946,cval_lineitem_l_quantity#3947,cval_lineitem_l_extendedprice#3948,cval_lineitem_l_discount#3949,cval_lineitem_l_tax#3950,cval_lineitem_l_returnflag#3951,cval_lineitem_l_linestatus#3952,cval_lineitem_l_commitdate#3953,cval_lineitem_l_receiptdate#3954,cval_lineitem_l_shipinstruct#3955,cval_lineitem_l_shipmode#3956,cval_lineitem_l_comment#3957,cval_lineitem_l_shipdate#3958,cl_quantity#3959,cl_extendedprice#3960,cl_discount#3961,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#4004 AS rid_1#4021, cpfk_customer_orders#4005 AS cpfk_customer_orders_1#4022, cfpk_orders_customer#4006 AS cfpk_orders_customer_1#4023, cval_orders_o_orderstatus#4007 AS cval_orders_o_orderstatus_1#4024, cval_orders_o_totalprice#4008 AS cval_orders_o_totalprice_1#4025, cval_orders_o_orderpriority#4009 AS cval_orders_o_orderpriority_1#4026, cval_orders_o_clerk#4010 AS cval_orders_o_clerk_1#4027, cval_orders_o_shippriority#4011 AS cval_orders_o_shippriority_1#4028, cval_orders_o_comment#4012 AS cval_orders_o_comment_1#4029, cval_orders_o_orderdate#4013 AS cval_orders_o_orderdate_1#4030, co_orderstatus#4014 AS co_orderstatus_1#4031, co_totalprice#4015 AS co_totalprice_1#4032, co_orderpriority#4016 AS co_orderpriority_1#4033, co_clerk#4017 AS co_clerk_1#4034, co_shippriority#4018 AS co_shippriority_1#4035, co_comment#4019 AS co_comment_1#4036, co_orderdate#4020 AS co_orderdate_1#4037]
               +- Relation[rid#4004,cpfk_customer_orders#4005,cfpk_orders_customer#4006,cval_orders_o_orderstatus#4007,cval_orders_o_totalprice#4008,cval_orders_o_orderpriority#4009,cval_orders_o_clerk#4010,cval_orders_o_shippriority#4011,cval_orders_o_comment#4012,cval_orders_o_orderdate#4013,co_orderstatus#4014,co_totalprice#4015,co_orderpriority#4016,co_clerk#4017,co_shippriority#4018,co_comment#4019,co_orderdate#4020] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 52453ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/11 02:58:01 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 02:58:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4093L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 02:58:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#4093L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#4095 AS rid_0#4128, cpfk_orders_lineitem#4096 AS cpfk_orders_lineitem_0#4129, cpfk_supplier_lineitem#4097 AS cpfk_supplier_lineitem_0#4130, cfpk_lineitem_supplier#4098 AS cfpk_lineitem_supplier_0#4131, cfpk_lineitem_partsupp#4099 AS cfpk_lineitem_partsupp_0#4132, cpfk_part_lineitem#4100 AS cpfk_part_lineitem_0#4133, cfpk_lineitem_part#4101 AS cfpk_lineitem_part_0#4134, cpfk_partsupp_lineitem#4102 AS cpfk_partsupp_lineitem_0#4135, cfpk_lineitem_orders#4103 AS cfpk_lineitem_orders_0#4136, cval_lineitem_l_quantity#4104 AS cval_lineitem_l_quantity_0#4137, cval_lineitem_l_extendedprice#4105 AS cval_lineitem_l_extendedprice_0#4138, cval_lineitem_l_discount#4106 AS cval_lineitem_l_discount_0#4139, cval_lineitem_l_tax#4107 AS cval_lineitem_l_tax_0#4140, cval_lineitem_l_returnflag#4108 AS cval_lineitem_l_returnflag_0#4141, cval_lineitem_l_linestatus#4109 AS cval_lineitem_l_linestatus_0#4142, cval_lineitem_l_commitdate#4110 AS cval_lineitem_l_commitdate_0#4143, cval_lineitem_l_receiptdate#4111 AS cval_lineitem_l_receiptdate_0#4144, cval_lineitem_l_shipinstruct#4112 AS cval_lineitem_l_shipinstruct_0#4145, cval_lineitem_l_shipmode#4113 AS cval_lineitem_l_shipmode_0#4146, cval_lineitem_l_comment#4114 AS cval_lineitem_l_comment_0#4147, cval_lineitem_l_shipdate#4115 AS cval_lineitem_l_shipdate_0#4148, cl_quantity#4116 AS cl_quantity_0#4149, cl_extendedprice#4117 AS cl_extendedprice_0#4150, cl_discount#4118 AS cl_discount_0#4151, ... 9 more fields]
         +- Relation[rid#4095,cpfk_orders_lineitem#4096,cpfk_supplier_lineitem#4097,cfpk_lineitem_supplier#4098,cfpk_lineitem_partsupp#4099,cpfk_part_lineitem#4100,cfpk_lineitem_part#4101,cpfk_partsupp_lineitem#4102,cfpk_lineitem_orders#4103,cval_lineitem_l_quantity#4104,cval_lineitem_l_extendedprice#4105,cval_lineitem_l_discount#4106,cval_lineitem_l_tax#4107,cval_lineitem_l_returnflag#4108,cval_lineitem_l_linestatus#4109,cval_lineitem_l_commitdate#4110,cval_lineitem_l_receiptdate#4111,cval_lineitem_l_shipinstruct#4112,cval_lineitem_l_shipmode#4113,cval_lineitem_l_comment#4114,cval_lineitem_l_shipdate#4115,cl_quantity#4116,cl_extendedprice#4117,cl_discount#4118,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 3021ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/11 02:58:05 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 02:58:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4198L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 02:58:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 02:58:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 02:58:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 02:58:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 02:58:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 02:58:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 02:58:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 02:58:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4198L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#4200 AS rid_0#4233, cpfk_orders_lineitem#4201 AS cpfk_orders_lineitem_0#4234, cpfk_supplier_lineitem#4202 AS cpfk_supplier_lineitem_0#4235, cfpk_lineitem_supplier#4203 AS cfpk_lineitem_supplier_0#4236, cfpk_lineitem_partsupp#4204 AS cfpk_lineitem_partsupp_0#4237, cpfk_part_lineitem#4205 AS cpfk_part_lineitem_0#4238, cfpk_lineitem_part#4206 AS cfpk_lineitem_part_0#4239, cpfk_partsupp_lineitem#4207 AS cpfk_partsupp_lineitem_0#4240, cfpk_lineitem_orders#4208 AS cfpk_lineitem_orders_0#4241, cval_lineitem_l_quantity#4209 AS cval_lineitem_l_quantity_0#4242, cval_lineitem_l_extendedprice#4210 AS cval_lineitem_l_extendedprice_0#4243, cval_lineitem_l_discount#4211 AS cval_lineitem_l_discount_0#4244, cval_lineitem_l_tax#4212 AS cval_lineitem_l_tax_0#4245, cval_lineitem_l_returnflag#4213 AS cval_lineitem_l_returnflag_0#4246, cval_lineitem_l_linestatus#4214 AS cval_lineitem_l_linestatus_0#4247, cval_lineitem_l_commitdate#4215 AS cval_lineitem_l_commitdate_0#4248, cval_lineitem_l_receiptdate#4216 AS cval_lineitem_l_receiptdate_0#4249, cval_lineitem_l_shipinstruct#4217 AS cval_lineitem_l_shipinstruct_0#4250, cval_lineitem_l_shipmode#4218 AS cval_lineitem_l_shipmode_0#4251, cval_lineitem_l_comment#4219 AS cval_lineitem_l_comment_0#4252, cval_lineitem_l_shipdate#4220 AS cval_lineitem_l_shipdate_0#4253, cl_quantity#4221 AS cl_quantity_0#4254, cl_extendedprice#4222 AS cl_extendedprice_0#4255, cl_discount#4223 AS cl_discount_0#4256, ... 9 more fields]
            :  +- Relation[rid#4200,cpfk_orders_lineitem#4201,cpfk_supplier_lineitem#4202,cfpk_lineitem_supplier#4203,cfpk_lineitem_partsupp#4204,cpfk_part_lineitem#4205,cfpk_lineitem_part#4206,cpfk_partsupp_lineitem#4207,cfpk_lineitem_orders#4208,cval_lineitem_l_quantity#4209,cval_lineitem_l_extendedprice#4210,cval_lineitem_l_discount#4211,cval_lineitem_l_tax#4212,cval_lineitem_l_returnflag#4213,cval_lineitem_l_linestatus#4214,cval_lineitem_l_commitdate#4215,cval_lineitem_l_receiptdate#4216,cval_lineitem_l_shipinstruct#4217,cval_lineitem_l_shipmode#4218,cval_lineitem_l_comment#4219,cval_lineitem_l_shipdate#4220,cl_quantity#4221,cl_extendedprice#4222,cl_discount#4223,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#4266 AS rid_1#4283, cpfk_customer_orders#4267 AS cpfk_customer_orders_1#4284, cfpk_orders_customer#4268 AS cfpk_orders_customer_1#4285, cval_orders_o_orderstatus#4269 AS cval_orders_o_orderstatus_1#4286, cval_orders_o_totalprice#4270 AS cval_orders_o_totalprice_1#4287, cval_orders_o_orderpriority#4271 AS cval_orders_o_orderpriority_1#4288, cval_orders_o_clerk#4272 AS cval_orders_o_clerk_1#4289, cval_orders_o_shippriority#4273 AS cval_orders_o_shippriority_1#4290, cval_orders_o_comment#4274 AS cval_orders_o_comment_1#4291, cval_orders_o_orderdate#4275 AS cval_orders_o_orderdate_1#4292, co_orderstatus#4276 AS co_orderstatus_1#4293, co_totalprice#4277 AS co_totalprice_1#4294, co_orderpriority#4278 AS co_orderpriority_1#4295, co_clerk#4279 AS co_clerk_1#4296, co_shippriority#4280 AS co_shippriority_1#4297, co_comment#4281 AS co_comment_1#4298, co_orderdate#4282 AS co_orderdate_1#4299]
                  :     :  :  :  :  +- Relation[rid#4266,cpfk_customer_orders#4267,cfpk_orders_customer#4268,cval_orders_o_orderstatus#4269,cval_orders_o_totalprice#4270,cval_orders_o_orderpriority#4271,cval_orders_o_clerk#4272,cval_orders_o_shippriority#4273,cval_orders_o_comment#4274,cval_orders_o_orderdate#4275,co_orderstatus#4276,co_totalprice#4277,co_orderpriority#4278,co_clerk#4279,co_shippriority#4280,co_comment#4281,co_orderdate#4282] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#4300 AS rid_1#4317, cpfk_customer_orders#4301 AS cpfk_customer_orders_1#4318, cfpk_orders_customer#4302 AS cfpk_orders_customer_1#4319, cval_orders_o_orderstatus#4303 AS cval_orders_o_orderstatus_1#4320, cval_orders_o_totalprice#4304 AS cval_orders_o_totalprice_1#4321, cval_orders_o_orderpriority#4305 AS cval_orders_o_orderpriority_1#4322, cval_orders_o_clerk#4306 AS cval_orders_o_clerk_1#4323, cval_orders_o_shippriority#4307 AS cval_orders_o_shippriority_1#4324, cval_orders_o_comment#4308 AS cval_orders_o_comment_1#4325, cval_orders_o_orderdate#4309 AS cval_orders_o_orderdate_1#4326, co_orderstatus#4310 AS co_orderstatus_1#4327, co_totalprice#4311 AS co_totalprice_1#4328, co_orderpriority#4312 AS co_orderpriority_1#4329, co_clerk#4313 AS co_clerk_1#4330, co_shippriority#4314 AS co_shippriority_1#4331, co_comment#4315 AS co_comment_1#4332, co_orderdate#4316 AS co_orderdate_1#4333]
                  :     :  :  :        +- Relation[rid#4300,cpfk_customer_orders#4301,cfpk_orders_customer#4302,cval_orders_o_orderstatus#4303,cval_orders_o_totalprice#4304,cval_orders_o_orderpriority#4305,cval_orders_o_clerk#4306,cval_orders_o_shippriority#4307,cval_orders_o_comment#4308,cval_orders_o_orderdate#4309,co_orderstatus#4310,co_totalprice#4311,co_orderpriority#4312,co_clerk#4313,co_shippriority#4314,co_comment#4315,co_orderdate#4316] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :     :- Project [rid#4400 AS rid_1#4417, cpfk_customer_orders#4401 AS cpfk_customer_orders_1#4418, cfpk_orders_customer#4402 AS cfpk_orders_customer_1#4419, cval_orders_o_orderstatus#4403 AS cval_orders_o_orderstatus_1#4420, cval_orders_o_totalprice#4404 AS cval_orders_o_totalprice_1#4421, cval_orders_o_orderpriority#4405 AS cval_orders_o_orderpriority_1#4422, cval_orders_o_clerk#4406 AS cval_orders_o_clerk_1#4423, cval_orders_o_shippriority#4407 AS cval_orders_o_shippriority_1#4424, cval_orders_o_comment#4408 AS cval_orders_o_comment_1#4425, cval_orders_o_orderdate#4409 AS cval_orders_o_orderdate_1#4426, co_orderstatus#4410 AS co_orderstatus_1#4427, co_totalprice#4411 AS co_totalprice_1#4428, co_orderpriority#4412 AS co_orderpriority_1#4429, co_clerk#4413 AS co_clerk_1#4430, co_shippriority#4414 AS co_shippriority_1#4431, co_comment#4415 AS co_comment_1#4432, co_orderdate#4416 AS co_orderdate_1#4433]
                  :     :  :     :  +- Relation[rid#4400,cpfk_customer_orders#4401,cfpk_orders_customer#4402,cval_orders_o_orderstatus#4403,cval_orders_o_totalprice#4404,cval_orders_o_orderpriority#4405,cval_orders_o_clerk#4406,cval_orders_o_shippriority#4407,cval_orders_o_comment#4408,cval_orders_o_orderdate#4409,co_orderstatus#4410,co_totalprice#4411,co_orderpriority#4412,co_clerk#4413,co_shippriority#4414,co_comment#4415,co_orderdate#4416] JDBCRelation(torders) [numPartitions=1]
                  :     :  :     +- Project [rid#4434 AS rid_2#4467, cpfk_orders_lineitem#4435 AS cpfk_orders_lineitem_2#4468, cpfk_supplier_lineitem#4436 AS cpfk_supplier_lineitem_2#4469, cfpk_lineitem_supplier#4437 AS cfpk_lineitem_supplier_2#4470, cfpk_lineitem_partsupp#4438 AS cfpk_lineitem_partsupp_2#4471, cpfk_part_lineitem#4439 AS cpfk_part_lineitem_2#4472, cfpk_lineitem_part#4440 AS cfpk_lineitem_part_2#4473, cpfk_partsupp_lineitem#4441 AS cpfk_partsupp_lineitem_2#4474, cfpk_lineitem_orders#4442 AS cfpk_lineitem_orders_2#4475, cval_lineitem_l_quantity#4443 AS cval_lineitem_l_quantity_2#4476, cval_lineitem_l_extendedprice#4444 AS cval_lineitem_l_extendedprice_2#4477, cval_lineitem_l_discount#4445 AS cval_lineitem_l_discount_2#4478, cval_lineitem_l_tax#4446 AS cval_lineitem_l_tax_2#4479, cval_lineitem_l_returnflag#4447 AS cval_lineitem_l_returnflag_2#4480, cval_lineitem_l_linestatus#4448 AS cval_lineitem_l_linestatus_2#4481, cval_lineitem_l_commitdate#4449 AS cval_lineitem_l_commitdate_2#4482, cval_lineitem_l_receiptdate#4450 AS cval_lineitem_l_receiptdate_2#4483, cval_lineitem_l_shipinstruct#4451 AS cval_lineitem_l_shipinstruct_2#4484, cval_lineitem_l_shipmode#4452 AS cval_lineitem_l_shipmode_2#4485, cval_lineitem_l_comment#4453 AS cval_lineitem_l_comment_2#4486, cval_lineitem_l_shipdate#4454 AS cval_lineitem_l_shipdate_2#4487, cl_quantity#4455 AS cl_quantity_2#4488, cl_extendedprice#4456 AS cl_extendedprice_2#4489, cl_discount#4457 AS cl_discount_2#4490, ... 9 more fields]
                  :     :  :        +- Relation[rid#4434,cpfk_orders_lineitem#4435,cpfk_supplier_lineitem#4436,cfpk_lineitem_supplier#4437,cfpk_lineitem_partsupp#4438,cpfk_part_lineitem#4439,cfpk_lineitem_part#4440,cpfk_partsupp_lineitem#4441,cfpk_lineitem_orders#4442,cval_lineitem_l_quantity#4443,cval_lineitem_l_extendedprice#4444,cval_lineitem_l_discount#4445,cval_lineitem_l_tax#4446,cval_lineitem_l_returnflag#4447,cval_lineitem_l_linestatus#4448,cval_lineitem_l_commitdate#4449,cval_lineitem_l_receiptdate#4450,cval_lineitem_l_shipinstruct#4451,cval_lineitem_l_shipmode#4452,cval_lineitem_l_comment#4453,cval_lineitem_l_shipdate#4454,cl_quantity#4455,cl_extendedprice#4456,cl_discount#4457,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#4334 AS rid_2#4367, cpfk_orders_lineitem#4335 AS cpfk_orders_lineitem_2#4368, cpfk_supplier_lineitem#4336 AS cpfk_supplier_lineitem_2#4369, cfpk_lineitem_supplier#4337 AS cfpk_lineitem_supplier_2#4370, cfpk_lineitem_partsupp#4338 AS cfpk_lineitem_partsupp_2#4371, cpfk_part_lineitem#4339 AS cpfk_part_lineitem_2#4372, cfpk_lineitem_part#4340 AS cfpk_lineitem_part_2#4373, cpfk_partsupp_lineitem#4341 AS cpfk_partsupp_lineitem_2#4374, cfpk_lineitem_orders#4342 AS cfpk_lineitem_orders_2#4375, cval_lineitem_l_quantity#4343 AS cval_lineitem_l_quantity_2#4376, cval_lineitem_l_extendedprice#4344 AS cval_lineitem_l_extendedprice_2#4377, cval_lineitem_l_discount#4345 AS cval_lineitem_l_discount_2#4378, cval_lineitem_l_tax#4346 AS cval_lineitem_l_tax_2#4379, cval_lineitem_l_returnflag#4347 AS cval_lineitem_l_returnflag_2#4380, cval_lineitem_l_linestatus#4348 AS cval_lineitem_l_linestatus_2#4381, cval_lineitem_l_commitdate#4349 AS cval_lineitem_l_commitdate_2#4382, cval_lineitem_l_receiptdate#4350 AS cval_lineitem_l_receiptdate_2#4383, cval_lineitem_l_shipinstruct#4351 AS cval_lineitem_l_shipinstruct_2#4384, cval_lineitem_l_shipmode#4352 AS cval_lineitem_l_shipmode_2#4385, cval_lineitem_l_comment#4353 AS cval_lineitem_l_comment_2#4386, cval_lineitem_l_shipdate#4354 AS cval_lineitem_l_shipdate_2#4387, cl_quantity#4355 AS cl_quantity_2#4388, cl_extendedprice#4356 AS cl_extendedprice_2#4389, cl_discount#4357 AS cl_discount_2#4390, ... 9 more fields]
                  :     :     +- Relation[rid#4334,cpfk_orders_lineitem#4335,cpfk_supplier_lineitem#4336,cfpk_lineitem_supplier#4337,cfpk_lineitem_partsupp#4338,cpfk_part_lineitem#4339,cfpk_lineitem_part#4340,cpfk_partsupp_lineitem#4341,cfpk_lineitem_orders#4342,cval_lineitem_l_quantity#4343,cval_lineitem_l_extendedprice#4344,cval_lineitem_l_discount#4345,cval_lineitem_l_tax#4346,cval_lineitem_l_returnflag#4347,cval_lineitem_l_linestatus#4348,cval_lineitem_l_commitdate#4349,cval_lineitem_l_receiptdate#4350,cval_lineitem_l_shipinstruct#4351,cval_lineitem_l_shipmode#4352,cval_lineitem_l_comment#4353,cval_lineitem_l_shipdate#4354,cl_quantity#4355,cl_extendedprice#4356,cl_discount#4357,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#4500 AS rid_3#4513, cpfk_nation_supplier#4501 AS cpfk_nation_supplier_3#4514, cfpk_supplier_nation#4502 AS cfpk_supplier_nation_3#4515, cval_supplier_s_name#4503 AS cval_supplier_s_name_3#4516, cval_supplier_s_address#4504 AS cval_supplier_s_address_3#4517, cval_supplier_s_phone#4505 AS cval_supplier_s_phone_3#4518, cval_supplier_s_acctbal#4506 AS cval_supplier_s_acctbal_3#4519, cval_supplier_s_comment#4507 AS cval_supplier_s_comment_3#4520, cs_name#4508 AS cs_name_3#4521, cs_address#4509 AS cs_address_3#4522, cs_phone#4510 AS cs_phone_3#4523, cs_acctbal#4511 AS cs_acctbal_3#4524, cs_comment#4512 AS cs_comment_3#4525]
                  :        +- Relation[rid#4500,cpfk_nation_supplier#4501,cfpk_supplier_nation#4502,cval_supplier_s_name#4503,cval_supplier_s_address#4504,cval_supplier_s_phone#4505,cval_supplier_s_acctbal#4506,cval_supplier_s_comment#4507,cs_name#4508,cs_address#4509,cs_phone#4510,cs_acctbal#4511,cs_comment#4512] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#4526 AS rid_4#4533, cpfk_region_nation#4527 AS cpfk_region_nation_4#4534, cfpk_nation_region#4528 AS cfpk_nation_region_4#4535, cval_nation_n_name#4529 AS cval_nation_n_name_4#4536, cval_nation_n_comment#4530 AS cval_nation_n_comment_4#4537, cn_name#4531 AS cn_name_4#4538, cn_comment#4532 AS cn_comment_4#4539]
                     :  +- Relation[rid#4526,cpfk_region_nation#4527,cfpk_nation_region#4528,cval_nation_n_name#4529,cval_nation_n_comment#4530,cn_name#4531,cn_comment#4532] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#4540 AS rid_4#4547, cpfk_region_nation#4541 AS cpfk_region_nation_4#4548, cfpk_nation_region#4542 AS cfpk_nation_region_4#4549, cval_nation_n_name#4543 AS cval_nation_n_name_4#4550, cval_nation_n_comment#4544 AS cval_nation_n_comment_4#4551, cn_name#4545 AS cn_name_4#4552, cn_comment#4546 AS cn_comment_4#4553]
                           +- Relation[rid#4540,cpfk_region_nation#4541,cfpk_nation_region#4542,cval_nation_n_name#4543,cval_nation_n_comment#4544,cn_name#4545,cn_comment#4546] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 246421ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/11 03:02:11 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:02:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4661L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 03:02:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4661L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#4663 AS rid_0#4680, cpfk_customer_orders#4664 AS cpfk_customer_orders_0#4681, cfpk_orders_customer#4665 AS cfpk_orders_customer_0#4682, cval_orders_o_orderstatus#4666 AS cval_orders_o_orderstatus_0#4683, cval_orders_o_totalprice#4667 AS cval_orders_o_totalprice_0#4684, cval_orders_o_orderpriority#4668 AS cval_orders_o_orderpriority_0#4685, cval_orders_o_clerk#4669 AS cval_orders_o_clerk_0#4686, cval_orders_o_shippriority#4670 AS cval_orders_o_shippriority_0#4687, cval_orders_o_comment#4671 AS cval_orders_o_comment_0#4688, cval_orders_o_orderdate#4672 AS cval_orders_o_orderdate_0#4689, co_orderstatus#4673 AS co_orderstatus_0#4690, co_totalprice#4674 AS co_totalprice_0#4691, co_orderpriority#4675 AS co_orderpriority_0#4692, co_clerk#4676 AS co_clerk_0#4693, co_shippriority#4677 AS co_shippriority_0#4694, co_comment#4678 AS co_comment_0#4695, co_orderdate#4679 AS co_orderdate_0#4696]
            :  +- Relation[rid#4663,cpfk_customer_orders#4664,cfpk_orders_customer#4665,cval_orders_o_orderstatus#4666,cval_orders_o_totalprice#4667,cval_orders_o_orderpriority#4668,cval_orders_o_clerk#4669,cval_orders_o_shippriority#4670,cval_orders_o_comment#4671,cval_orders_o_orderdate#4672,co_orderstatus#4673,co_totalprice#4674,co_orderpriority#4675,co_clerk#4676,co_shippriority#4677,co_comment#4678,co_orderdate#4679] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#4697 AS rid_1#4712, cpfk_nation_customer#4698 AS cpfk_nation_customer_1#4713, cfpk_customer_nation#4699 AS cfpk_customer_nation_1#4714, cval_customer_c_name#4700 AS cval_customer_c_name_1#4715, cval_customer_c_address#4701 AS cval_customer_c_address_1#4716, cval_customer_c_phone#4702 AS cval_customer_c_phone_1#4717, cval_customer_c_acctbal#4703 AS cval_customer_c_acctbal_1#4718, cval_customer_c_comment#4704 AS cval_customer_c_comment_1#4719, cval_customer_c_mktsegment#4705 AS cval_customer_c_mktsegment_1#4720, cc_name#4706 AS cc_name_1#4721, cc_address#4707 AS cc_address_1#4722, cc_phone#4708 AS cc_phone_1#4723, cc_acctbal#4709 AS cc_acctbal_1#4724, cc_comment#4710 AS cc_comment_1#4725, cc_mktsegment#4711 AS cc_mktsegment_1#4726]
               +- Relation[rid#4697,cpfk_nation_customer#4698,cfpk_customer_nation#4699,cval_customer_c_name#4700,cval_customer_c_address#4701,cval_customer_c_phone#4702,cval_customer_c_acctbal#4703,cval_customer_c_comment#4704,cval_customer_c_mktsegment#4705,cc_name#4706,cc_address#4707,cc_phone#4708,cc_acctbal#4709,cc_comment#4710,cc_mktsegment#4711] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 12812ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/11 03:02:24 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:02:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4768L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 03:02:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4768L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#4770 AS rid_0#4785, cpfk_nation_customer#4771 AS cpfk_nation_customer_0#4786, cfpk_customer_nation#4772 AS cfpk_customer_nation_0#4787, cval_customer_c_name#4773 AS cval_customer_c_name_0#4788, cval_customer_c_address#4774 AS cval_customer_c_address_0#4789, cval_customer_c_phone#4775 AS cval_customer_c_phone_0#4790, cval_customer_c_acctbal#4776 AS cval_customer_c_acctbal_0#4791, cval_customer_c_comment#4777 AS cval_customer_c_comment_0#4792, cval_customer_c_mktsegment#4778 AS cval_customer_c_mktsegment_0#4793, cc_name#4779 AS cc_name_0#4794, cc_address#4780 AS cc_address_0#4795, cc_phone#4781 AS cc_phone_0#4796, cc_acctbal#4782 AS cc_acctbal_0#4797, cc_comment#4783 AS cc_comment_0#4798, cc_mktsegment#4784 AS cc_mktsegment_0#4799]
         :  :  :  :  +- Relation[rid#4770,cpfk_nation_customer#4771,cfpk_customer_nation#4772,cval_customer_c_name#4773,cval_customer_c_address#4774,cval_customer_c_phone#4775,cval_customer_c_acctbal#4776,cval_customer_c_comment#4777,cval_customer_c_mktsegment#4778,cc_name#4779,cc_address#4780,cc_phone#4781,cc_acctbal#4782,cc_comment#4783,cc_mktsegment#4784] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#4834 AS rid_0#4849, cpfk_nation_customer#4835 AS cpfk_nation_customer_0#4850, cfpk_customer_nation#4836 AS cfpk_customer_nation_0#4851, cval_customer_c_name#4837 AS cval_customer_c_name_0#4852, cval_customer_c_address#4838 AS cval_customer_c_address_0#4853, cval_customer_c_phone#4839 AS cval_customer_c_phone_0#4854, cval_customer_c_acctbal#4840 AS cval_customer_c_acctbal_0#4855, cval_customer_c_comment#4841 AS cval_customer_c_comment_0#4856, cval_customer_c_mktsegment#4842 AS cval_customer_c_mktsegment_0#4857, cc_name#4843 AS cc_name_0#4858, cc_address#4844 AS cc_address_0#4859, cc_phone#4845 AS cc_phone_0#4860, cc_acctbal#4846 AS cc_acctbal_0#4861, cc_comment#4847 AS cc_comment_0#4862, cc_mktsegment#4848 AS cc_mktsegment_0#4863]
         :  :  :     :  +- Relation[rid#4834,cpfk_nation_customer#4835,cfpk_customer_nation#4836,cval_customer_c_name#4837,cval_customer_c_address#4838,cval_customer_c_phone#4839,cval_customer_c_acctbal#4840,cval_customer_c_comment#4841,cval_customer_c_mktsegment#4842,cc_name#4843,cc_address#4844,cc_phone#4845,cc_acctbal#4846,cc_comment#4847,cc_mktsegment#4848] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#4864 AS rid_1#4881, cpfk_customer_orders#4865 AS cpfk_customer_orders_1#4882, cfpk_orders_customer#4866 AS cfpk_orders_customer_1#4883, cval_orders_o_orderstatus#4867 AS cval_orders_o_orderstatus_1#4884, cval_orders_o_totalprice#4868 AS cval_orders_o_totalprice_1#4885, cval_orders_o_orderpriority#4869 AS cval_orders_o_orderpriority_1#4886, cval_orders_o_clerk#4870 AS cval_orders_o_clerk_1#4887, cval_orders_o_shippriority#4871 AS cval_orders_o_shippriority_1#4888, cval_orders_o_comment#4872 AS cval_orders_o_comment_1#4889, cval_orders_o_orderdate#4873 AS cval_orders_o_orderdate_1#4890, co_orderstatus#4874 AS co_orderstatus_1#4891, co_totalprice#4875 AS co_totalprice_1#4892, co_orderpriority#4876 AS co_orderpriority_1#4893, co_clerk#4877 AS co_clerk_1#4894, co_shippriority#4878 AS co_shippriority_1#4895, co_comment#4879 AS co_comment_1#4896, co_orderdate#4880 AS co_orderdate_1#4897]
         :  :  :        +- Relation[rid#4864,cpfk_customer_orders#4865,cfpk_orders_customer#4866,cval_orders_o_orderstatus#4867,cval_orders_o_totalprice#4868,cval_orders_o_orderpriority#4869,cval_orders_o_clerk#4870,cval_orders_o_shippriority#4871,cval_orders_o_comment#4872,cval_orders_o_orderdate#4873,co_orderstatus#4874,co_totalprice#4875,co_orderpriority#4876,co_clerk#4877,co_shippriority#4878,co_comment#4879,co_orderdate#4880] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#4800 AS rid_1#4817, cpfk_customer_orders#4801 AS cpfk_customer_orders_1#4818, cfpk_orders_customer#4802 AS cfpk_orders_customer_1#4819, cval_orders_o_orderstatus#4803 AS cval_orders_o_orderstatus_1#4820, cval_orders_o_totalprice#4804 AS cval_orders_o_totalprice_1#4821, cval_orders_o_orderpriority#4805 AS cval_orders_o_orderpriority_1#4822, cval_orders_o_clerk#4806 AS cval_orders_o_clerk_1#4823, cval_orders_o_shippriority#4807 AS cval_orders_o_shippriority_1#4824, cval_orders_o_comment#4808 AS cval_orders_o_comment_1#4825, cval_orders_o_orderdate#4809 AS cval_orders_o_orderdate_1#4826, co_orderstatus#4810 AS co_orderstatus_1#4827, co_totalprice#4811 AS co_totalprice_1#4828, co_orderpriority#4812 AS co_orderpriority_1#4829, co_clerk#4813 AS co_clerk_1#4830, co_shippriority#4814 AS co_shippriority_1#4831, co_comment#4815 AS co_comment_1#4832, co_orderdate#4816 AS co_orderdate_1#4833]
         :  :     +- Relation[rid#4800,cpfk_customer_orders#4801,cfpk_orders_customer#4802,cval_orders_o_orderstatus#4803,cval_orders_o_totalprice#4804,cval_orders_o_orderpriority#4805,cval_orders_o_clerk#4806,cval_orders_o_shippriority#4807,cval_orders_o_comment#4808,cval_orders_o_orderdate#4809,co_orderstatus#4810,co_totalprice#4811,co_orderpriority#4812,co_clerk#4813,co_shippriority#4814,co_comment#4815,co_orderdate#4816] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#4964 AS rid_1#4981, cpfk_customer_orders#4965 AS cpfk_customer_orders_1#4982, cfpk_orders_customer#4966 AS cfpk_orders_customer_1#4983, cval_orders_o_orderstatus#4967 AS cval_orders_o_orderstatus_1#4984, cval_orders_o_totalprice#4968 AS cval_orders_o_totalprice_1#4985, cval_orders_o_orderpriority#4969 AS cval_orders_o_orderpriority_1#4986, cval_orders_o_clerk#4970 AS cval_orders_o_clerk_1#4987, cval_orders_o_shippriority#4971 AS cval_orders_o_shippriority_1#4988, cval_orders_o_comment#4972 AS cval_orders_o_comment_1#4989, cval_orders_o_orderdate#4973 AS cval_orders_o_orderdate_1#4990, co_orderstatus#4974 AS co_orderstatus_1#4991, co_totalprice#4975 AS co_totalprice_1#4992, co_orderpriority#4976 AS co_orderpriority_1#4993, co_clerk#4977 AS co_clerk_1#4994, co_shippriority#4978 AS co_shippriority_1#4995, co_comment#4979 AS co_comment_1#4996, co_orderdate#4980 AS co_orderdate_1#4997]
         :     :  +- Relation[rid#4964,cpfk_customer_orders#4965,cfpk_orders_customer#4966,cval_orders_o_orderstatus#4967,cval_orders_o_totalprice#4968,cval_orders_o_orderpriority#4969,cval_orders_o_clerk#4970,cval_orders_o_shippriority#4971,cval_orders_o_comment#4972,cval_orders_o_orderdate#4973,co_orderstatus#4974,co_totalprice#4975,co_orderpriority#4976,co_clerk#4977,co_shippriority#4978,co_comment#4979,co_orderdate#4980] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#4998 AS rid_2#5031, cpfk_orders_lineitem#4999 AS cpfk_orders_lineitem_2#5032, cpfk_supplier_lineitem#5000 AS cpfk_supplier_lineitem_2#5033, cfpk_lineitem_supplier#5001 AS cfpk_lineitem_supplier_2#5034, cfpk_lineitem_partsupp#5002 AS cfpk_lineitem_partsupp_2#5035, cpfk_part_lineitem#5003 AS cpfk_part_lineitem_2#5036, cfpk_lineitem_part#5004 AS cfpk_lineitem_part_2#5037, cpfk_partsupp_lineitem#5005 AS cpfk_partsupp_lineitem_2#5038, cfpk_lineitem_orders#5006 AS cfpk_lineitem_orders_2#5039, cval_lineitem_l_quantity#5007 AS cval_lineitem_l_quantity_2#5040, cval_lineitem_l_extendedprice#5008 AS cval_lineitem_l_extendedprice_2#5041, cval_lineitem_l_discount#5009 AS cval_lineitem_l_discount_2#5042, cval_lineitem_l_tax#5010 AS cval_lineitem_l_tax_2#5043, cval_lineitem_l_returnflag#5011 AS cval_lineitem_l_returnflag_2#5044, cval_lineitem_l_linestatus#5012 AS cval_lineitem_l_linestatus_2#5045, cval_lineitem_l_commitdate#5013 AS cval_lineitem_l_commitdate_2#5046, cval_lineitem_l_receiptdate#5014 AS cval_lineitem_l_receiptdate_2#5047, cval_lineitem_l_shipinstruct#5015 AS cval_lineitem_l_shipinstruct_2#5048, cval_lineitem_l_shipmode#5016 AS cval_lineitem_l_shipmode_2#5049, cval_lineitem_l_comment#5017 AS cval_lineitem_l_comment_2#5050, cval_lineitem_l_shipdate#5018 AS cval_lineitem_l_shipdate_2#5051, cl_quantity#5019 AS cl_quantity_2#5052, cl_extendedprice#5020 AS cl_extendedprice_2#5053, cl_discount#5021 AS cl_discount_2#5054, ... 9 more fields]
         :        +- Relation[rid#4998,cpfk_orders_lineitem#4999,cpfk_supplier_lineitem#5000,cfpk_lineitem_supplier#5001,cfpk_lineitem_partsupp#5002,cpfk_part_lineitem#5003,cfpk_lineitem_part#5004,cpfk_partsupp_lineitem#5005,cfpk_lineitem_orders#5006,cval_lineitem_l_quantity#5007,cval_lineitem_l_extendedprice#5008,cval_lineitem_l_discount#5009,cval_lineitem_l_tax#5010,cval_lineitem_l_returnflag#5011,cval_lineitem_l_linestatus#5012,cval_lineitem_l_commitdate#5013,cval_lineitem_l_receiptdate#5014,cval_lineitem_l_shipinstruct#5015,cval_lineitem_l_shipmode#5016,cval_lineitem_l_comment#5017,cval_lineitem_l_shipdate#5018,cl_quantity#5019,cl_extendedprice#5020,cl_discount#5021,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4898 AS rid_2#4931, cpfk_orders_lineitem#4899 AS cpfk_orders_lineitem_2#4932, cpfk_supplier_lineitem#4900 AS cpfk_supplier_lineitem_2#4933, cfpk_lineitem_supplier#4901 AS cfpk_lineitem_supplier_2#4934, cfpk_lineitem_partsupp#4902 AS cfpk_lineitem_partsupp_2#4935, cpfk_part_lineitem#4903 AS cpfk_part_lineitem_2#4936, cfpk_lineitem_part#4904 AS cfpk_lineitem_part_2#4937, cpfk_partsupp_lineitem#4905 AS cpfk_partsupp_lineitem_2#4938, cfpk_lineitem_orders#4906 AS cfpk_lineitem_orders_2#4939, cval_lineitem_l_quantity#4907 AS cval_lineitem_l_quantity_2#4940, cval_lineitem_l_extendedprice#4908 AS cval_lineitem_l_extendedprice_2#4941, cval_lineitem_l_discount#4909 AS cval_lineitem_l_discount_2#4942, cval_lineitem_l_tax#4910 AS cval_lineitem_l_tax_2#4943, cval_lineitem_l_returnflag#4911 AS cval_lineitem_l_returnflag_2#4944, cval_lineitem_l_linestatus#4912 AS cval_lineitem_l_linestatus_2#4945, cval_lineitem_l_commitdate#4913 AS cval_lineitem_l_commitdate_2#4946, cval_lineitem_l_receiptdate#4914 AS cval_lineitem_l_receiptdate_2#4947, cval_lineitem_l_shipinstruct#4915 AS cval_lineitem_l_shipinstruct_2#4948, cval_lineitem_l_shipmode#4916 AS cval_lineitem_l_shipmode_2#4949, cval_lineitem_l_comment#4917 AS cval_lineitem_l_comment_2#4950, cval_lineitem_l_shipdate#4918 AS cval_lineitem_l_shipdate_2#4951, cl_quantity#4919 AS cl_quantity_2#4952, cl_extendedprice#4920 AS cl_extendedprice_2#4953, cl_discount#4921 AS cl_discount_2#4954, ... 9 more fields]
            +- Relation[rid#4898,cpfk_orders_lineitem#4899,cpfk_supplier_lineitem#4900,cfpk_lineitem_supplier#4901,cfpk_lineitem_partsupp#4902,cpfk_part_lineitem#4903,cfpk_lineitem_part#4904,cpfk_partsupp_lineitem#4905,cfpk_lineitem_orders#4906,cval_lineitem_l_quantity#4907,cval_lineitem_l_extendedprice#4908,cval_lineitem_l_discount#4909,cval_lineitem_l_tax#4910,cval_lineitem_l_returnflag#4911,cval_lineitem_l_linestatus#4912,cval_lineitem_l_commitdate#4913,cval_lineitem_l_receiptdate#4914,cval_lineitem_l_shipinstruct#4915,cval_lineitem_l_shipmode#4916,cval_lineitem_l_comment#4917,cval_lineitem_l_shipdate#4918,cl_quantity#4919,cl_extendedprice#4920,cl_discount#4921,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 116968ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/11 03:04:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:04:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5134L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 03:04:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#5134L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#5136 AS rid_0#5169, cpfk_orders_lineitem#5137 AS cpfk_orders_lineitem_0#5170, cpfk_supplier_lineitem#5138 AS cpfk_supplier_lineitem_0#5171, cfpk_lineitem_supplier#5139 AS cfpk_lineitem_supplier_0#5172, cfpk_lineitem_partsupp#5140 AS cfpk_lineitem_partsupp_0#5173, cpfk_part_lineitem#5141 AS cpfk_part_lineitem_0#5174, cfpk_lineitem_part#5142 AS cfpk_lineitem_part_0#5175, cpfk_partsupp_lineitem#5143 AS cpfk_partsupp_lineitem_0#5176, cfpk_lineitem_orders#5144 AS cfpk_lineitem_orders_0#5177, cval_lineitem_l_quantity#5145 AS cval_lineitem_l_quantity_0#5178, cval_lineitem_l_extendedprice#5146 AS cval_lineitem_l_extendedprice_0#5179, cval_lineitem_l_discount#5147 AS cval_lineitem_l_discount_0#5180, cval_lineitem_l_tax#5148 AS cval_lineitem_l_tax_0#5181, cval_lineitem_l_returnflag#5149 AS cval_lineitem_l_returnflag_0#5182, cval_lineitem_l_linestatus#5150 AS cval_lineitem_l_linestatus_0#5183, cval_lineitem_l_commitdate#5151 AS cval_lineitem_l_commitdate_0#5184, cval_lineitem_l_receiptdate#5152 AS cval_lineitem_l_receiptdate_0#5185, cval_lineitem_l_shipinstruct#5153 AS cval_lineitem_l_shipinstruct_0#5186, cval_lineitem_l_shipmode#5154 AS cval_lineitem_l_shipmode_0#5187, cval_lineitem_l_comment#5155 AS cval_lineitem_l_comment_0#5188, cval_lineitem_l_shipdate#5156 AS cval_lineitem_l_shipdate_0#5189, cl_quantity#5157 AS cl_quantity_0#5190, cl_extendedprice#5158 AS cl_extendedprice_0#5191, cl_discount#5159 AS cl_discount_0#5192, ... 9 more fields]
         +- Relation[rid#5136,cpfk_orders_lineitem#5137,cpfk_supplier_lineitem#5138,cfpk_lineitem_supplier#5139,cfpk_lineitem_partsupp#5140,cpfk_part_lineitem#5141,cfpk_lineitem_part#5142,cpfk_partsupp_lineitem#5143,cfpk_lineitem_orders#5144,cval_lineitem_l_quantity#5145,cval_lineitem_l_extendedprice#5146,cval_lineitem_l_discount#5147,cval_lineitem_l_tax#5148,cval_lineitem_l_returnflag#5149,cval_lineitem_l_linestatus#5150,cval_lineitem_l_commitdate#5151,cval_lineitem_l_receiptdate#5152,cval_lineitem_l_shipinstruct#5153,cval_lineitem_l_shipmode#5154,cval_lineitem_l_comment#5155,cval_lineitem_l_shipdate#5156,cl_quantity#5157,cl_extendedprice#5158,cl_discount#5159,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 3005ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/11 03:04:24 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:04:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5242L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 03:04:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:04:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:04:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:04:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:04:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:04:24 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:04:24 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:04:24 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:04:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:04:24 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:04:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:04:24 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:04:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:04:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:04:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:04:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5242L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#5244 AS rid_0#5261, cval_part_p_name#5245 AS cval_part_p_name_0#5262, cval_part_p_mfgr#5246 AS cval_part_p_mfgr_0#5263, cval_part_p_type#5247 AS cval_part_p_type_0#5264, cval_part_p_size#5248 AS cval_part_p_size_0#5265, cval_part_p_container#5249 AS cval_part_p_container_0#5266, cval_part_p_retailprice#5250 AS cval_part_p_retailprice_0#5267, cval_part_p_comment#5251 AS cval_part_p_comment_0#5268, cval_part_p_brand#5252 AS cval_part_p_brand_0#5269, cp_name#5253 AS cp_name_0#5270, cp_mfgr#5254 AS cp_mfgr_0#5271, cp_type#5255 AS cp_type_0#5272, cp_size#5256 AS cp_size_0#5273, cp_container#5257 AS cp_container_0#5274, cp_retailprice#5258 AS cp_retailprice_0#5275, cp_comment#5259 AS cp_comment_0#5276, cp_brand#5260 AS cp_brand_0#5277]
            :     :     :  :  :  :  +- Relation[rid#5244,cval_part_p_name#5245,cval_part_p_mfgr#5246,cval_part_p_type#5247,cval_part_p_size#5248,cval_part_p_container#5249,cval_part_p_retailprice#5250,cval_part_p_comment#5251,cval_part_p_brand#5252,cp_name#5253,cp_mfgr#5254,cp_type#5255,cp_size#5256,cp_container#5257,cp_retailprice#5258,cp_comment#5259,cp_brand#5260] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#5278 AS rid_0#5295, cval_part_p_name#5279 AS cval_part_p_name_0#5296, cval_part_p_mfgr#5280 AS cval_part_p_mfgr_0#5297, cval_part_p_type#5281 AS cval_part_p_type_0#5298, cval_part_p_size#5282 AS cval_part_p_size_0#5299, cval_part_p_container#5283 AS cval_part_p_container_0#5300, cval_part_p_retailprice#5284 AS cval_part_p_retailprice_0#5301, cval_part_p_comment#5285 AS cval_part_p_comment_0#5302, cval_part_p_brand#5286 AS cval_part_p_brand_0#5303, cp_name#5287 AS cp_name_0#5304, cp_mfgr#5288 AS cp_mfgr_0#5305, cp_type#5289 AS cp_type_0#5306, cp_size#5290 AS cp_size_0#5307, cp_container#5291 AS cp_container_0#5308, cp_retailprice#5292 AS cp_retailprice_0#5309, cp_comment#5293 AS cp_comment_0#5310, cp_brand#5294 AS cp_brand_0#5311]
            :     :     :  :  :        +- Relation[rid#5278,cval_part_p_name#5279,cval_part_p_mfgr#5280,cval_part_p_type#5281,cval_part_p_size#5282,cval_part_p_container#5283,cval_part_p_retailprice#5284,cval_part_p_comment#5285,cval_part_p_brand#5286,cp_name#5287,cp_mfgr#5288,cp_type#5289,cp_size#5290,cp_container#5291,cp_retailprice#5292,cp_comment#5293,cp_brand#5294] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :     :- Project [rid#5378 AS rid_0#5395, cval_part_p_name#5379 AS cval_part_p_name_0#5396, cval_part_p_mfgr#5380 AS cval_part_p_mfgr_0#5397, cval_part_p_type#5381 AS cval_part_p_type_0#5398, cval_part_p_size#5382 AS cval_part_p_size_0#5399, cval_part_p_container#5383 AS cval_part_p_container_0#5400, cval_part_p_retailprice#5384 AS cval_part_p_retailprice_0#5401, cval_part_p_comment#5385 AS cval_part_p_comment_0#5402, cval_part_p_brand#5386 AS cval_part_p_brand_0#5403, cp_name#5387 AS cp_name_0#5404, cp_mfgr#5388 AS cp_mfgr_0#5405, cp_type#5389 AS cp_type_0#5406, cp_size#5390 AS cp_size_0#5407, cp_container#5391 AS cp_container_0#5408, cp_retailprice#5392 AS cp_retailprice_0#5409, cp_comment#5393 AS cp_comment_0#5410, cp_brand#5394 AS cp_brand_0#5411]
            :     :     :  :     :  +- Relation[rid#5378,cval_part_p_name#5379,cval_part_p_mfgr#5380,cval_part_p_type#5381,cval_part_p_size#5382,cval_part_p_container#5383,cval_part_p_retailprice#5384,cval_part_p_comment#5385,cval_part_p_brand#5386,cp_name#5387,cp_mfgr#5388,cp_type#5389,cp_size#5390,cp_container#5391,cp_retailprice#5392,cp_comment#5393,cp_brand#5394] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :     +- Project [rid#5412 AS rid_1#5445, cpfk_orders_lineitem#5413 AS cpfk_orders_lineitem_1#5446, cpfk_supplier_lineitem#5414 AS cpfk_supplier_lineitem_1#5447, cfpk_lineitem_supplier#5415 AS cfpk_lineitem_supplier_1#5448, cfpk_lineitem_partsupp#5416 AS cfpk_lineitem_partsupp_1#5449, cpfk_part_lineitem#5417 AS cpfk_part_lineitem_1#5450, cfpk_lineitem_part#5418 AS cfpk_lineitem_part_1#5451, cpfk_partsupp_lineitem#5419 AS cpfk_partsupp_lineitem_1#5452, cfpk_lineitem_orders#5420 AS cfpk_lineitem_orders_1#5453, cval_lineitem_l_quantity#5421 AS cval_lineitem_l_quantity_1#5454, cval_lineitem_l_extendedprice#5422 AS cval_lineitem_l_extendedprice_1#5455, cval_lineitem_l_discount#5423 AS cval_lineitem_l_discount_1#5456, cval_lineitem_l_tax#5424 AS cval_lineitem_l_tax_1#5457, cval_lineitem_l_returnflag#5425 AS cval_lineitem_l_returnflag_1#5458, cval_lineitem_l_linestatus#5426 AS cval_lineitem_l_linestatus_1#5459, cval_lineitem_l_commitdate#5427 AS cval_lineitem_l_commitdate_1#5460, cval_lineitem_l_receiptdate#5428 AS cval_lineitem_l_receiptdate_1#5461, cval_lineitem_l_shipinstruct#5429 AS cval_lineitem_l_shipinstruct_1#5462, cval_lineitem_l_shipmode#5430 AS cval_lineitem_l_shipmode_1#5463, cval_lineitem_l_comment#5431 AS cval_lineitem_l_comment_1#5464, cval_lineitem_l_shipdate#5432 AS cval_lineitem_l_shipdate_1#5465, cl_quantity#5433 AS cl_quantity_1#5466, cl_extendedprice#5434 AS cl_extendedprice_1#5467, cl_discount#5435 AS cl_discount_1#5468, ... 9 more fields]
            :     :     :  :        +- Relation[rid#5412,cpfk_orders_lineitem#5413,cpfk_supplier_lineitem#5414,cfpk_lineitem_supplier#5415,cfpk_lineitem_partsupp#5416,cpfk_part_lineitem#5417,cfpk_lineitem_part#5418,cpfk_partsupp_lineitem#5419,cfpk_lineitem_orders#5420,cval_lineitem_l_quantity#5421,cval_lineitem_l_extendedprice#5422,cval_lineitem_l_discount#5423,cval_lineitem_l_tax#5424,cval_lineitem_l_returnflag#5425,cval_lineitem_l_linestatus#5426,cval_lineitem_l_commitdate#5427,cval_lineitem_l_receiptdate#5428,cval_lineitem_l_shipinstruct#5429,cval_lineitem_l_shipmode#5430,cval_lineitem_l_comment#5431,cval_lineitem_l_shipdate#5432,cl_quantity#5433,cl_extendedprice#5434,cl_discount#5435,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#5312 AS rid_1#5345, cpfk_orders_lineitem#5313 AS cpfk_orders_lineitem_1#5346, cpfk_supplier_lineitem#5314 AS cpfk_supplier_lineitem_1#5347, cfpk_lineitem_supplier#5315 AS cfpk_lineitem_supplier_1#5348, cfpk_lineitem_partsupp#5316 AS cfpk_lineitem_partsupp_1#5349, cpfk_part_lineitem#5317 AS cpfk_part_lineitem_1#5350, cfpk_lineitem_part#5318 AS cfpk_lineitem_part_1#5351, cpfk_partsupp_lineitem#5319 AS cpfk_partsupp_lineitem_1#5352, cfpk_lineitem_orders#5320 AS cfpk_lineitem_orders_1#5353, cval_lineitem_l_quantity#5321 AS cval_lineitem_l_quantity_1#5354, cval_lineitem_l_extendedprice#5322 AS cval_lineitem_l_extendedprice_1#5355, cval_lineitem_l_discount#5323 AS cval_lineitem_l_discount_1#5356, cval_lineitem_l_tax#5324 AS cval_lineitem_l_tax_1#5357, cval_lineitem_l_returnflag#5325 AS cval_lineitem_l_returnflag_1#5358, cval_lineitem_l_linestatus#5326 AS cval_lineitem_l_linestatus_1#5359, cval_lineitem_l_commitdate#5327 AS cval_lineitem_l_commitdate_1#5360, cval_lineitem_l_receiptdate#5328 AS cval_lineitem_l_receiptdate_1#5361, cval_lineitem_l_shipinstruct#5329 AS cval_lineitem_l_shipinstruct_1#5362, cval_lineitem_l_shipmode#5330 AS cval_lineitem_l_shipmode_1#5363, cval_lineitem_l_comment#5331 AS cval_lineitem_l_comment_1#5364, cval_lineitem_l_shipdate#5332 AS cval_lineitem_l_shipdate_1#5365, cl_quantity#5333 AS cl_quantity_1#5366, cl_extendedprice#5334 AS cl_extendedprice_1#5367, cl_discount#5335 AS cl_discount_1#5368, ... 9 more fields]
            :     :     :     +- Relation[rid#5312,cpfk_orders_lineitem#5313,cpfk_supplier_lineitem#5314,cfpk_lineitem_supplier#5315,cfpk_lineitem_partsupp#5316,cpfk_part_lineitem#5317,cfpk_lineitem_part#5318,cpfk_partsupp_lineitem#5319,cfpk_lineitem_orders#5320,cval_lineitem_l_quantity#5321,cval_lineitem_l_extendedprice#5322,cval_lineitem_l_discount#5323,cval_lineitem_l_tax#5324,cval_lineitem_l_returnflag#5325,cval_lineitem_l_linestatus#5326,cval_lineitem_l_commitdate#5327,cval_lineitem_l_receiptdate#5328,cval_lineitem_l_shipinstruct#5329,cval_lineitem_l_shipmode#5330,cval_lineitem_l_comment#5331,cval_lineitem_l_shipdate#5332,cl_quantity#5333,cl_extendedprice#5334,cl_discount#5335,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#5478 AS rid_2#5491, cpfk_nation_supplier#5479 AS cpfk_nation_supplier_2#5492, cfpk_supplier_nation#5480 AS cfpk_supplier_nation_2#5493, cval_supplier_s_name#5481 AS cval_supplier_s_name_2#5494, cval_supplier_s_address#5482 AS cval_supplier_s_address_2#5495, cval_supplier_s_phone#5483 AS cval_supplier_s_phone_2#5496, cval_supplier_s_acctbal#5484 AS cval_supplier_s_acctbal_2#5497, cval_supplier_s_comment#5485 AS cval_supplier_s_comment_2#5498, cs_name#5486 AS cs_name_2#5499, cs_address#5487 AS cs_address_2#5500, cs_phone#5488 AS cs_phone_2#5501, cs_acctbal#5489 AS cs_acctbal_2#5502, cs_comment#5490 AS cs_comment_2#5503]
            :     :        +- Relation[rid#5478,cpfk_nation_supplier#5479,cfpk_supplier_nation#5480,cval_supplier_s_name#5481,cval_supplier_s_address#5482,cval_supplier_s_phone#5483,cval_supplier_s_acctbal#5484,cval_supplier_s_comment#5485,cs_name#5486,cs_address#5487,cs_phone#5488,cs_acctbal#5489,cs_comment#5490] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#5504 AS rid_3#5511, cpfk_region_nation#5505 AS cpfk_region_nation_3#5512, cfpk_nation_region#5506 AS cfpk_nation_region_3#5513, cval_nation_n_name#5507 AS cval_nation_n_name_3#5514, cval_nation_n_comment#5508 AS cval_nation_n_comment_3#5515, cn_name#5509 AS cn_name_3#5516, cn_comment#5510 AS cn_comment_3#5517]
            :        +- Relation[rid#5504,cpfk_region_nation#5505,cfpk_nation_region#5506,cval_nation_n_name#5507,cval_nation_n_comment#5508,cn_name#5509,cn_comment#5510] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'Join UsingJoin(Inner,List(rid_6))
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#5518 AS rid_4#5523, cval_region_r_name#5519 AS cval_region_r_name_4#5524, cval_region_r_comment#5520 AS cval_region_r_comment_4#5525, cr_name#5521 AS cr_name_4#5526, cr_comment#5522 AS cr_comment_4#5527]
               :  :  :  :  :  :  :  +- Relation[rid#5518,cval_region_r_name#5519,cval_region_r_comment#5520,cr_name#5521,cr_comment#5522] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#5528 AS rid_4#5533, cval_region_r_name#5529 AS cval_region_r_name_4#5534, cval_region_r_comment#5530 AS cval_region_r_comment_4#5535, cr_name#5531 AS cr_name_4#5536, cr_comment#5532 AS cr_comment_4#5537]
               :  :  :  :  :  :        +- Relation[rid#5528,cval_region_r_name#5529,cval_region_r_comment#5530,cr_name#5531,cr_comment#5532] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :     :- Project [rid#5552 AS rid_4#5557, cval_region_r_name#5553 AS cval_region_r_name_4#5558, cval_region_r_comment#5554 AS cval_region_r_comment_4#5559, cr_name#5555 AS cr_name_4#5560, cr_comment#5556 AS cr_comment_4#5561]
               :  :  :  :  :     :  +- Relation[rid#5552,cval_region_r_name#5553,cval_region_r_comment#5554,cr_name#5555,cr_comment#5556] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :     +- Project [rid#5562 AS rid_5#5569, cpfk_region_nation#5563 AS cpfk_region_nation_5#5570, cfpk_nation_region#5564 AS cfpk_nation_region_5#5571, cval_nation_n_name#5565 AS cval_nation_n_name_5#5572, cval_nation_n_comment#5566 AS cval_nation_n_comment_5#5573, cn_name#5567 AS cn_name_5#5574, cn_comment#5568 AS cn_comment_5#5575]
               :  :  :  :  :        +- Relation[rid#5562,cpfk_region_nation#5563,cfpk_nation_region#5564,cval_nation_n_name#5565,cval_nation_n_comment#5566,cn_name#5567,cn_comment#5568] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#5538 AS rid_5#5545, cpfk_region_nation#5539 AS cpfk_region_nation_5#5546, cfpk_nation_region#5540 AS cfpk_nation_region_5#5547, cval_nation_n_name#5541 AS cval_nation_n_name_5#5548, cval_nation_n_comment#5542 AS cval_nation_n_comment_5#5549, cn_name#5543 AS cn_name_5#5550, cn_comment#5544 AS cn_comment_5#5551]
               :  :  :  :     +- Relation[rid#5538,cpfk_region_nation#5539,cfpk_nation_region#5540,cval_nation_n_name#5541,cval_nation_n_comment#5542,cn_name#5543,cn_comment#5544] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :     :- Project [rid#5606 AS rid_5#5613, cpfk_region_nation#5607 AS cpfk_region_nation_5#5614, cfpk_nation_region#5608 AS cfpk_nation_region_5#5615, cval_nation_n_name#5609 AS cval_nation_n_name_5#5616, cval_nation_n_comment#5610 AS cval_nation_n_comment_5#5617, cn_name#5611 AS cn_name_5#5618, cn_comment#5612 AS cn_comment_5#5619]
               :  :  :     :  +- Relation[rid#5606,cpfk_region_nation#5607,cfpk_nation_region#5608,cval_nation_n_name#5609,cval_nation_n_comment#5610,cn_name#5611,cn_comment#5612] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#5620 AS rid_6#5635, cpfk_nation_customer#5621 AS cpfk_nation_customer_6#5636, cfpk_customer_nation#5622 AS cfpk_customer_nation_6#5637, cval_customer_c_name#5623 AS cval_customer_c_name_6#5638, cval_customer_c_address#5624 AS cval_customer_c_address_6#5639, cval_customer_c_phone#5625 AS cval_customer_c_phone_6#5640, cval_customer_c_acctbal#5626 AS cval_customer_c_acctbal_6#5641, cval_customer_c_comment#5627 AS cval_customer_c_comment_6#5642, cval_customer_c_mktsegment#5628 AS cval_customer_c_mktsegment_6#5643, cc_name#5629 AS cc_name_6#5644, cc_address#5630 AS cc_address_6#5645, cc_phone#5631 AS cc_phone_6#5646, cc_acctbal#5632 AS cc_acctbal_6#5647, cc_comment#5633 AS cc_comment_6#5648, cc_mktsegment#5634 AS cc_mktsegment_6#5649]
               :  :  :        +- Relation[rid#5620,cpfk_nation_customer#5621,cfpk_customer_nation#5622,cval_customer_c_name#5623,cval_customer_c_address#5624,cval_customer_c_phone#5625,cval_customer_c_acctbal#5626,cval_customer_c_comment#5627,cval_customer_c_mktsegment#5628,cc_name#5629,cc_address#5630,cc_phone#5631,cc_acctbal#5632,cc_comment#5633,cc_mktsegment#5634] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#5576 AS rid_6#5591, cpfk_nation_customer#5577 AS cpfk_nation_customer_6#5592, cfpk_customer_nation#5578 AS cfpk_customer_nation_6#5593, cval_customer_c_name#5579 AS cval_customer_c_name_6#5594, cval_customer_c_address#5580 AS cval_customer_c_address_6#5595, cval_customer_c_phone#5581 AS cval_customer_c_phone_6#5596, cval_customer_c_acctbal#5582 AS cval_customer_c_acctbal_6#5597, cval_customer_c_comment#5583 AS cval_customer_c_comment_6#5598, cval_customer_c_mktsegment#5584 AS cval_customer_c_mktsegment_6#5599, cc_name#5585 AS cc_name_6#5600, cc_address#5586 AS cc_address_6#5601, cc_phone#5587 AS cc_phone_6#5602, cc_acctbal#5588 AS cc_acctbal_6#5603, cc_comment#5589 AS cc_comment_6#5604, cc_mktsegment#5590 AS cc_mktsegment_6#5605]
               :  :     +- Relation[rid#5576,cpfk_nation_customer#5577,cfpk_customer_nation#5578,cval_customer_c_name#5579,cval_customer_c_address#5580,cval_customer_c_phone#5581,cval_customer_c_acctbal#5582,cval_customer_c_comment#5583,cval_customer_c_mktsegment#5584,cc_name#5585,cc_address#5586,cc_phone#5587,cc_acctbal#5588,cc_comment#5589,cc_mktsegment#5590] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :     :- Project [rid#5684 AS rid_6#5699, cpfk_nation_customer#5685 AS cpfk_nation_customer_6#5700, cfpk_customer_nation#5686 AS cfpk_customer_nation_6#5701, cval_customer_c_name#5687 AS cval_customer_c_name_6#5702, cval_customer_c_address#5688 AS cval_customer_c_address_6#5703, cval_customer_c_phone#5689 AS cval_customer_c_phone_6#5704, cval_customer_c_acctbal#5690 AS cval_customer_c_acctbal_6#5705, cval_customer_c_comment#5691 AS cval_customer_c_comment_6#5706, cval_customer_c_mktsegment#5692 AS cval_customer_c_mktsegment_6#5707, cc_name#5693 AS cc_name_6#5708, cc_address#5694 AS cc_address_6#5709, cc_phone#5695 AS cc_phone_6#5710, cc_acctbal#5696 AS cc_acctbal_6#5711, cc_comment#5697 AS cc_comment_6#5712, cc_mktsegment#5698 AS cc_mktsegment_6#5713]
               :     :  +- Relation[rid#5684,cpfk_nation_customer#5685,cfpk_customer_nation#5686,cval_customer_c_name#5687,cval_customer_c_address#5688,cval_customer_c_phone#5689,cval_customer_c_acctbal#5690,cval_customer_c_comment#5691,cval_customer_c_mktsegment#5692,cc_name#5693,cc_address#5694,cc_phone#5695,cc_acctbal#5696,cc_comment#5697,cc_mktsegment#5698] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#5714 AS rid_7#5731, cpfk_customer_orders#5715 AS cpfk_customer_orders_7#5732, cfpk_orders_customer#5716 AS cfpk_orders_customer_7#5733, cval_orders_o_orderstatus#5717 AS cval_orders_o_orderstatus_7#5734, cval_orders_o_totalprice#5718 AS cval_orders_o_totalprice_7#5735, cval_orders_o_orderpriority#5719 AS cval_orders_o_orderpriority_7#5736, cval_orders_o_clerk#5720 AS cval_orders_o_clerk_7#5737, cval_orders_o_shippriority#5721 AS cval_orders_o_shippriority_7#5738, cval_orders_o_comment#5722 AS cval_orders_o_comment_7#5739, cval_orders_o_orderdate#5723 AS cval_orders_o_orderdate_7#5740, co_orderstatus#5724 AS co_orderstatus_7#5741, co_totalprice#5725 AS co_totalprice_7#5742, co_orderpriority#5726 AS co_orderpriority_7#5743, co_clerk#5727 AS co_clerk_7#5744, co_shippriority#5728 AS co_shippriority_7#5745, co_comment#5729 AS co_comment_7#5746, co_orderdate#5730 AS co_orderdate_7#5747]
               :        +- Relation[rid#5714,cpfk_customer_orders#5715,cfpk_orders_customer#5716,cval_orders_o_orderstatus#5717,cval_orders_o_totalprice#5718,cval_orders_o_orderpriority#5719,cval_orders_o_clerk#5720,cval_orders_o_shippriority#5721,cval_orders_o_comment#5722,cval_orders_o_orderdate#5723,co_orderstatus#5724,co_totalprice#5725,co_orderpriority#5726,co_clerk#5727,co_shippriority#5728,co_comment#5729,co_orderdate#5730] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#5650 AS rid_7#5667, cpfk_customer_orders#5651 AS cpfk_customer_orders_7#5668, cfpk_orders_customer#5652 AS cfpk_orders_customer_7#5669, cval_orders_o_orderstatus#5653 AS cval_orders_o_orderstatus_7#5670, cval_orders_o_totalprice#5654 AS cval_orders_o_totalprice_7#5671, cval_orders_o_orderpriority#5655 AS cval_orders_o_orderpriority_7#5672, cval_orders_o_clerk#5656 AS cval_orders_o_clerk_7#5673, cval_orders_o_shippriority#5657 AS cval_orders_o_shippriority_7#5674, cval_orders_o_comment#5658 AS cval_orders_o_comment_7#5675, cval_orders_o_orderdate#5659 AS cval_orders_o_orderdate_7#5676, co_orderstatus#5660 AS co_orderstatus_7#5677, co_totalprice#5661 AS co_totalprice_7#5678, co_orderpriority#5662 AS co_orderpriority_7#5679, co_clerk#5663 AS co_clerk_7#5680, co_shippriority#5664 AS co_shippriority_7#5681, co_comment#5665 AS co_comment_7#5682, co_orderdate#5666 AS co_orderdate_7#5683]
                  +- Relation[rid#5650,cpfk_customer_orders#5651,cfpk_orders_customer#5652,cval_orders_o_orderstatus#5653,cval_orders_o_totalprice#5654,cval_orders_o_orderpriority#5655,cval_orders_o_clerk#5656,cval_orders_o_shippriority#5657,cval_orders_o_comment#5658,cval_orders_o_orderdate#5659,co_orderstatus#5660,co_totalprice#5661,co_orderpriority#5662,co_clerk#5663,co_shippriority#5664,co_comment#5665,co_orderdate#5666] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 94384ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/11 03:05:58 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:05:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5870L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 03:05:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:05:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:05:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:05:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:05:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:05:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:05:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:05:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:05:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:05:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:05:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:05:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:05:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:05:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:05:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:05:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5870L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#5872 AS rid_0#5879, cpfk_region_nation#5873 AS cpfk_region_nation_0#5880, cfpk_nation_region#5874 AS cfpk_nation_region_0#5881, cval_nation_n_name#5875 AS cval_nation_n_name_0#5882, cval_nation_n_comment#5876 AS cval_nation_n_comment_0#5883, cn_name#5877 AS cn_name_0#5884, cn_comment#5878 AS cn_comment_0#5885]
            :  :  :  :  :  :  +- Relation[rid#5872,cpfk_region_nation#5873,cfpk_nation_region#5874,cval_nation_n_name#5875,cval_nation_n_comment#5876,cn_name#5877,cn_comment#5878] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#5886 AS rid_0#5893, cpfk_region_nation#5887 AS cpfk_region_nation_0#5894, cfpk_nation_region#5888 AS cfpk_nation_region_0#5895, cval_nation_n_name#5889 AS cval_nation_n_name_0#5896, cval_nation_n_comment#5890 AS cval_nation_n_comment_0#5897, cn_name#5891 AS cn_name_0#5898, cn_comment#5892 AS cn_comment_0#5899]
            :  :  :  :  :        +- Relation[rid#5886,cpfk_region_nation#5887,cfpk_nation_region#5888,cval_nation_n_name#5889,cval_nation_n_comment#5890,cn_name#5891,cn_comment#5892] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :     :- Project [rid#5926 AS rid_0#5933, cpfk_region_nation#5927 AS cpfk_region_nation_0#5934, cfpk_nation_region#5928 AS cfpk_nation_region_0#5935, cval_nation_n_name#5929 AS cval_nation_n_name_0#5936, cval_nation_n_comment#5930 AS cval_nation_n_comment_0#5937, cn_name#5931 AS cn_name_0#5938, cn_comment#5932 AS cn_comment_0#5939]
            :  :  :  :     :  +- Relation[rid#5926,cpfk_region_nation#5927,cfpk_nation_region#5928,cval_nation_n_name#5929,cval_nation_n_comment#5930,cn_name#5931,cn_comment#5932] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :     +- Project [rid#5940 AS rid_1#5953, cpfk_nation_supplier#5941 AS cpfk_nation_supplier_1#5954, cfpk_supplier_nation#5942 AS cfpk_supplier_nation_1#5955, cval_supplier_s_name#5943 AS cval_supplier_s_name_1#5956, cval_supplier_s_address#5944 AS cval_supplier_s_address_1#5957, cval_supplier_s_phone#5945 AS cval_supplier_s_phone_1#5958, cval_supplier_s_acctbal#5946 AS cval_supplier_s_acctbal_1#5959, cval_supplier_s_comment#5947 AS cval_supplier_s_comment_1#5960, cs_name#5948 AS cs_name_1#5961, cs_address#5949 AS cs_address_1#5962, cs_phone#5950 AS cs_phone_1#5963, cs_acctbal#5951 AS cs_acctbal_1#5964, cs_comment#5952 AS cs_comment_1#5965]
            :  :  :  :        +- Relation[rid#5940,cpfk_nation_supplier#5941,cfpk_supplier_nation#5942,cval_supplier_s_name#5943,cval_supplier_s_address#5944,cval_supplier_s_phone#5945,cval_supplier_s_acctbal#5946,cval_supplier_s_comment#5947,cs_name#5948,cs_address#5949,cs_phone#5950,cs_acctbal#5951,cs_comment#5952] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#5900 AS rid_1#5913, cpfk_nation_supplier#5901 AS cpfk_nation_supplier_1#5914, cfpk_supplier_nation#5902 AS cfpk_supplier_nation_1#5915, cval_supplier_s_name#5903 AS cval_supplier_s_name_1#5916, cval_supplier_s_address#5904 AS cval_supplier_s_address_1#5917, cval_supplier_s_phone#5905 AS cval_supplier_s_phone_1#5918, cval_supplier_s_acctbal#5906 AS cval_supplier_s_acctbal_1#5919, cval_supplier_s_comment#5907 AS cval_supplier_s_comment_1#5920, cs_name#5908 AS cs_name_1#5921, cs_address#5909 AS cs_address_1#5922, cs_phone#5910 AS cs_phone_1#5923, cs_acctbal#5911 AS cs_acctbal_1#5924, cs_comment#5912 AS cs_comment_1#5925]
            :  :  :     +- Relation[rid#5900,cpfk_nation_supplier#5901,cfpk_supplier_nation#5902,cval_supplier_s_name#5903,cval_supplier_s_address#5904,cval_supplier_s_phone#5905,cval_supplier_s_acctbal#5906,cval_supplier_s_comment#5907,cs_name#5908,cs_address#5909,cs_phone#5910,cs_acctbal#5911,cs_comment#5912] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :     :- Project [rid#6032 AS rid_1#6045, cpfk_nation_supplier#6033 AS cpfk_nation_supplier_1#6046, cfpk_supplier_nation#6034 AS cfpk_supplier_nation_1#6047, cval_supplier_s_name#6035 AS cval_supplier_s_name_1#6048, cval_supplier_s_address#6036 AS cval_supplier_s_address_1#6049, cval_supplier_s_phone#6037 AS cval_supplier_s_phone_1#6050, cval_supplier_s_acctbal#6038 AS cval_supplier_s_acctbal_1#6051, cval_supplier_s_comment#6039 AS cval_supplier_s_comment_1#6052, cs_name#6040 AS cs_name_1#6053, cs_address#6041 AS cs_address_1#6054, cs_phone#6042 AS cs_phone_1#6055, cs_acctbal#6043 AS cs_acctbal_1#6056, cs_comment#6044 AS cs_comment_1#6057]
            :  :     :  +- Relation[rid#6032,cpfk_nation_supplier#6033,cfpk_supplier_nation#6034,cval_supplier_s_name#6035,cval_supplier_s_address#6036,cval_supplier_s_phone#6037,cval_supplier_s_acctbal#6038,cval_supplier_s_comment#6039,cs_name#6040,cs_address#6041,cs_phone#6042,cs_acctbal#6043,cs_comment#6044] JDBCRelation(tsupplier) [numPartitions=1]
            :  :     +- Project [rid#6058 AS rid_2#6091, cpfk_orders_lineitem#6059 AS cpfk_orders_lineitem_2#6092, cpfk_supplier_lineitem#6060 AS cpfk_supplier_lineitem_2#6093, cfpk_lineitem_supplier#6061 AS cfpk_lineitem_supplier_2#6094, cfpk_lineitem_partsupp#6062 AS cfpk_lineitem_partsupp_2#6095, cpfk_part_lineitem#6063 AS cpfk_part_lineitem_2#6096, cfpk_lineitem_part#6064 AS cfpk_lineitem_part_2#6097, cpfk_partsupp_lineitem#6065 AS cpfk_partsupp_lineitem_2#6098, cfpk_lineitem_orders#6066 AS cfpk_lineitem_orders_2#6099, cval_lineitem_l_quantity#6067 AS cval_lineitem_l_quantity_2#6100, cval_lineitem_l_extendedprice#6068 AS cval_lineitem_l_extendedprice_2#6101, cval_lineitem_l_discount#6069 AS cval_lineitem_l_discount_2#6102, cval_lineitem_l_tax#6070 AS cval_lineitem_l_tax_2#6103, cval_lineitem_l_returnflag#6071 AS cval_lineitem_l_returnflag_2#6104, cval_lineitem_l_linestatus#6072 AS cval_lineitem_l_linestatus_2#6105, cval_lineitem_l_commitdate#6073 AS cval_lineitem_l_commitdate_2#6106, cval_lineitem_l_receiptdate#6074 AS cval_lineitem_l_receiptdate_2#6107, cval_lineitem_l_shipinstruct#6075 AS cval_lineitem_l_shipinstruct_2#6108, cval_lineitem_l_shipmode#6076 AS cval_lineitem_l_shipmode_2#6109, cval_lineitem_l_comment#6077 AS cval_lineitem_l_comment_2#6110, cval_lineitem_l_shipdate#6078 AS cval_lineitem_l_shipdate_2#6111, cl_quantity#6079 AS cl_quantity_2#6112, cl_extendedprice#6080 AS cl_extendedprice_2#6113, cl_discount#6081 AS cl_discount_2#6114, ... 9 more fields]
            :  :        +- Relation[rid#6058,cpfk_orders_lineitem#6059,cpfk_supplier_lineitem#6060,cfpk_lineitem_supplier#6061,cfpk_lineitem_partsupp#6062,cpfk_part_lineitem#6063,cfpk_lineitem_part#6064,cpfk_partsupp_lineitem#6065,cfpk_lineitem_orders#6066,cval_lineitem_l_quantity#6067,cval_lineitem_l_extendedprice#6068,cval_lineitem_l_discount#6069,cval_lineitem_l_tax#6070,cval_lineitem_l_returnflag#6071,cval_lineitem_l_linestatus#6072,cval_lineitem_l_commitdate#6073,cval_lineitem_l_receiptdate#6074,cval_lineitem_l_shipinstruct#6075,cval_lineitem_l_shipmode#6076,cval_lineitem_l_comment#6077,cval_lineitem_l_shipdate#6078,cl_quantity#6079,cl_extendedprice#6080,cl_discount#6081,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#5966 AS rid_2#5999, cpfk_orders_lineitem#5967 AS cpfk_orders_lineitem_2#6000, cpfk_supplier_lineitem#5968 AS cpfk_supplier_lineitem_2#6001, cfpk_lineitem_supplier#5969 AS cfpk_lineitem_supplier_2#6002, cfpk_lineitem_partsupp#5970 AS cfpk_lineitem_partsupp_2#6003, cpfk_part_lineitem#5971 AS cpfk_part_lineitem_2#6004, cfpk_lineitem_part#5972 AS cfpk_lineitem_part_2#6005, cpfk_partsupp_lineitem#5973 AS cpfk_partsupp_lineitem_2#6006, cfpk_lineitem_orders#5974 AS cfpk_lineitem_orders_2#6007, cval_lineitem_l_quantity#5975 AS cval_lineitem_l_quantity_2#6008, cval_lineitem_l_extendedprice#5976 AS cval_lineitem_l_extendedprice_2#6009, cval_lineitem_l_discount#5977 AS cval_lineitem_l_discount_2#6010, cval_lineitem_l_tax#5978 AS cval_lineitem_l_tax_2#6011, cval_lineitem_l_returnflag#5979 AS cval_lineitem_l_returnflag_2#6012, cval_lineitem_l_linestatus#5980 AS cval_lineitem_l_linestatus_2#6013, cval_lineitem_l_commitdate#5981 AS cval_lineitem_l_commitdate_2#6014, cval_lineitem_l_receiptdate#5982 AS cval_lineitem_l_receiptdate_2#6015, cval_lineitem_l_shipinstruct#5983 AS cval_lineitem_l_shipinstruct_2#6016, cval_lineitem_l_shipmode#5984 AS cval_lineitem_l_shipmode_2#6017, cval_lineitem_l_comment#5985 AS cval_lineitem_l_comment_2#6018, cval_lineitem_l_shipdate#5986 AS cval_lineitem_l_shipdate_2#6019, cl_quantity#5987 AS cl_quantity_2#6020, cl_extendedprice#5988 AS cl_extendedprice_2#6021, cl_discount#5989 AS cl_discount_2#6022, ... 9 more fields]
            :     +- Relation[rid#5966,cpfk_orders_lineitem#5967,cpfk_supplier_lineitem#5968,cfpk_lineitem_supplier#5969,cfpk_lineitem_partsupp#5970,cpfk_part_lineitem#5971,cfpk_lineitem_part#5972,cpfk_partsupp_lineitem#5973,cfpk_lineitem_orders#5974,cval_lineitem_l_quantity#5975,cval_lineitem_l_extendedprice#5976,cval_lineitem_l_discount#5977,cval_lineitem_l_tax#5978,cval_lineitem_l_returnflag#5979,cval_lineitem_l_linestatus#5980,cval_lineitem_l_commitdate#5981,cval_lineitem_l_receiptdate#5982,cval_lineitem_l_shipinstruct#5983,cval_lineitem_l_shipmode#5984,cval_lineitem_l_comment#5985,cval_lineitem_l_shipdate#5986,cl_quantity#5987,cl_extendedprice#5988,cl_discount#5989,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'Join UsingJoin(Inner,List(rid_4))
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'Join UsingJoin(Inner,List(rid_3))
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#6124 AS rid_3#6131, cpfk_region_nation#6125 AS cpfk_region_nation_3#6132, cfpk_nation_region#6126 AS cfpk_nation_region_3#6133, cval_nation_n_name#6127 AS cval_nation_n_name_3#6134, cval_nation_n_comment#6128 AS cval_nation_n_comment_3#6135, cn_name#6129 AS cn_name_3#6136, cn_comment#6130 AS cn_comment_3#6137]
               :  :  :  :  :  +- Relation[rid#6124,cpfk_region_nation#6125,cfpk_nation_region#6126,cval_nation_n_name#6127,cval_nation_n_comment#6128,cn_name#6129,cn_comment#6130] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#6138 AS rid_3#6145, cpfk_region_nation#6139 AS cpfk_region_nation_3#6146, cfpk_nation_region#6140 AS cfpk_nation_region_3#6147, cval_nation_n_name#6141 AS cval_nation_n_name_3#6148, cval_nation_n_comment#6142 AS cval_nation_n_comment_3#6149, cn_name#6143 AS cn_name_3#6150, cn_comment#6144 AS cn_comment_3#6151]
               :  :  :  :        +- Relation[rid#6138,cpfk_region_nation#6139,cfpk_nation_region#6140,cval_nation_n_name#6141,cval_nation_n_comment#6142,cn_name#6143,cn_comment#6144] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :     :- Project [rid#6182 AS rid_3#6189, cpfk_region_nation#6183 AS cpfk_region_nation_3#6190, cfpk_nation_region#6184 AS cfpk_nation_region_3#6191, cval_nation_n_name#6185 AS cval_nation_n_name_3#6192, cval_nation_n_comment#6186 AS cval_nation_n_comment_3#6193, cn_name#6187 AS cn_name_3#6194, cn_comment#6188 AS cn_comment_3#6195]
               :  :  :     :  +- Relation[rid#6182,cpfk_region_nation#6183,cfpk_nation_region#6184,cval_nation_n_name#6185,cval_nation_n_comment#6186,cn_name#6187,cn_comment#6188] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#6196 AS rid_4#6211, cpfk_nation_customer#6197 AS cpfk_nation_customer_4#6212, cfpk_customer_nation#6198 AS cfpk_customer_nation_4#6213, cval_customer_c_name#6199 AS cval_customer_c_name_4#6214, cval_customer_c_address#6200 AS cval_customer_c_address_4#6215, cval_customer_c_phone#6201 AS cval_customer_c_phone_4#6216, cval_customer_c_acctbal#6202 AS cval_customer_c_acctbal_4#6217, cval_customer_c_comment#6203 AS cval_customer_c_comment_4#6218, cval_customer_c_mktsegment#6204 AS cval_customer_c_mktsegment_4#6219, cc_name#6205 AS cc_name_4#6220, cc_address#6206 AS cc_address_4#6221, cc_phone#6207 AS cc_phone_4#6222, cc_acctbal#6208 AS cc_acctbal_4#6223, cc_comment#6209 AS cc_comment_4#6224, cc_mktsegment#6210 AS cc_mktsegment_4#6225]
               :  :  :        +- Relation[rid#6196,cpfk_nation_customer#6197,cfpk_customer_nation#6198,cval_customer_c_name#6199,cval_customer_c_address#6200,cval_customer_c_phone#6201,cval_customer_c_acctbal#6202,cval_customer_c_comment#6203,cval_customer_c_mktsegment#6204,cc_name#6205,cc_address#6206,cc_phone#6207,cc_acctbal#6208,cc_comment#6209,cc_mktsegment#6210] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#6152 AS rid_4#6167, cpfk_nation_customer#6153 AS cpfk_nation_customer_4#6168, cfpk_customer_nation#6154 AS cfpk_customer_nation_4#6169, cval_customer_c_name#6155 AS cval_customer_c_name_4#6170, cval_customer_c_address#6156 AS cval_customer_c_address_4#6171, cval_customer_c_phone#6157 AS cval_customer_c_phone_4#6172, cval_customer_c_acctbal#6158 AS cval_customer_c_acctbal_4#6173, cval_customer_c_comment#6159 AS cval_customer_c_comment_4#6174, cval_customer_c_mktsegment#6160 AS cval_customer_c_mktsegment_4#6175, cc_name#6161 AS cc_name_4#6176, cc_address#6162 AS cc_address_4#6177, cc_phone#6163 AS cc_phone_4#6178, cc_acctbal#6164 AS cc_acctbal_4#6179, cc_comment#6165 AS cc_comment_4#6180, cc_mktsegment#6166 AS cc_mktsegment_4#6181]
               :  :     +- Relation[rid#6152,cpfk_nation_customer#6153,cfpk_customer_nation#6154,cval_customer_c_name#6155,cval_customer_c_address#6156,cval_customer_c_phone#6157,cval_customer_c_acctbal#6158,cval_customer_c_comment#6159,cval_customer_c_mktsegment#6160,cc_name#6161,cc_address#6162,cc_phone#6163,cc_acctbal#6164,cc_comment#6165,cc_mktsegment#6166] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :     :- Project [rid#6260 AS rid_4#6275, cpfk_nation_customer#6261 AS cpfk_nation_customer_4#6276, cfpk_customer_nation#6262 AS cfpk_customer_nation_4#6277, cval_customer_c_name#6263 AS cval_customer_c_name_4#6278, cval_customer_c_address#6264 AS cval_customer_c_address_4#6279, cval_customer_c_phone#6265 AS cval_customer_c_phone_4#6280, cval_customer_c_acctbal#6266 AS cval_customer_c_acctbal_4#6281, cval_customer_c_comment#6267 AS cval_customer_c_comment_4#6282, cval_customer_c_mktsegment#6268 AS cval_customer_c_mktsegment_4#6283, cc_name#6269 AS cc_name_4#6284, cc_address#6270 AS cc_address_4#6285, cc_phone#6271 AS cc_phone_4#6286, cc_acctbal#6272 AS cc_acctbal_4#6287, cc_comment#6273 AS cc_comment_4#6288, cc_mktsegment#6274 AS cc_mktsegment_4#6289]
               :     :  +- Relation[rid#6260,cpfk_nation_customer#6261,cfpk_customer_nation#6262,cval_customer_c_name#6263,cval_customer_c_address#6264,cval_customer_c_phone#6265,cval_customer_c_acctbal#6266,cval_customer_c_comment#6267,cval_customer_c_mktsegment#6268,cc_name#6269,cc_address#6270,cc_phone#6271,cc_acctbal#6272,cc_comment#6273,cc_mktsegment#6274] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#6290 AS rid_5#6307, cpfk_customer_orders#6291 AS cpfk_customer_orders_5#6308, cfpk_orders_customer#6292 AS cfpk_orders_customer_5#6309, cval_orders_o_orderstatus#6293 AS cval_orders_o_orderstatus_5#6310, cval_orders_o_totalprice#6294 AS cval_orders_o_totalprice_5#6311, cval_orders_o_orderpriority#6295 AS cval_orders_o_orderpriority_5#6312, cval_orders_o_clerk#6296 AS cval_orders_o_clerk_5#6313, cval_orders_o_shippriority#6297 AS cval_orders_o_shippriority_5#6314, cval_orders_o_comment#6298 AS cval_orders_o_comment_5#6315, cval_orders_o_orderdate#6299 AS cval_orders_o_orderdate_5#6316, co_orderstatus#6300 AS co_orderstatus_5#6317, co_totalprice#6301 AS co_totalprice_5#6318, co_orderpriority#6302 AS co_orderpriority_5#6319, co_clerk#6303 AS co_clerk_5#6320, co_shippriority#6304 AS co_shippriority_5#6321, co_comment#6305 AS co_comment_5#6322, co_orderdate#6306 AS co_orderdate_5#6323]
               :        +- Relation[rid#6290,cpfk_customer_orders#6291,cfpk_orders_customer#6292,cval_orders_o_orderstatus#6293,cval_orders_o_totalprice#6294,cval_orders_o_orderpriority#6295,cval_orders_o_clerk#6296,cval_orders_o_shippriority#6297,cval_orders_o_comment#6298,cval_orders_o_orderdate#6299,co_orderstatus#6300,co_totalprice#6301,co_orderpriority#6302,co_clerk#6303,co_shippriority#6304,co_comment#6305,co_orderdate#6306] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#6226 AS rid_5#6243, cpfk_customer_orders#6227 AS cpfk_customer_orders_5#6244, cfpk_orders_customer#6228 AS cfpk_orders_customer_5#6245, cval_orders_o_orderstatus#6229 AS cval_orders_o_orderstatus_5#6246, cval_orders_o_totalprice#6230 AS cval_orders_o_totalprice_5#6247, cval_orders_o_orderpriority#6231 AS cval_orders_o_orderpriority_5#6248, cval_orders_o_clerk#6232 AS cval_orders_o_clerk_5#6249, cval_orders_o_shippriority#6233 AS cval_orders_o_shippriority_5#6250, cval_orders_o_comment#6234 AS cval_orders_o_comment_5#6251, cval_orders_o_orderdate#6235 AS cval_orders_o_orderdate_5#6252, co_orderstatus#6236 AS co_orderstatus_5#6253, co_totalprice#6237 AS co_totalprice_5#6254, co_orderpriority#6238 AS co_orderpriority_5#6255, co_clerk#6239 AS co_clerk_5#6256, co_shippriority#6240 AS co_shippriority_5#6257, co_comment#6241 AS co_comment_5#6258, co_orderdate#6242 AS co_orderdate_5#6259]
                  +- Relation[rid#6226,cpfk_customer_orders#6227,cfpk_orders_customer#6228,cval_orders_o_orderstatus#6229,cval_orders_o_totalprice#6230,cval_orders_o_orderpriority#6231,cval_orders_o_clerk#6232,cval_orders_o_shippriority#6233,cval_orders_o_comment#6234,cval_orders_o_orderdate#6235,co_orderstatus#6236,co_totalprice#6237,co_orderpriority#6238,co_clerk#6239,co_shippriority#6240,co_comment#6241,co_orderdate#6242] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 102481ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/11 03:07:41 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:07:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6420L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 03:07:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:07:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:07:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:07:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:07:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:07:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:07:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:07:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6420L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#6422 AS rid_0#6439, cval_part_p_name#6423 AS cval_part_p_name_0#6440, cval_part_p_mfgr#6424 AS cval_part_p_mfgr_0#6441, cval_part_p_type#6425 AS cval_part_p_type_0#6442, cval_part_p_size#6426 AS cval_part_p_size_0#6443, cval_part_p_container#6427 AS cval_part_p_container_0#6444, cval_part_p_retailprice#6428 AS cval_part_p_retailprice_0#6445, cval_part_p_comment#6429 AS cval_part_p_comment_0#6446, cval_part_p_brand#6430 AS cval_part_p_brand_0#6447, cp_name#6431 AS cp_name_0#6448, cp_mfgr#6432 AS cp_mfgr_0#6449, cp_type#6433 AS cp_type_0#6450, cp_size#6434 AS cp_size_0#6451, cp_container#6435 AS cp_container_0#6452, cp_retailprice#6436 AS cp_retailprice_0#6453, cp_comment#6437 AS cp_comment_0#6454, cp_brand#6438 AS cp_brand_0#6455]
         :  :  :  :  +- Relation[rid#6422,cval_part_p_name#6423,cval_part_p_mfgr#6424,cval_part_p_type#6425,cval_part_p_size#6426,cval_part_p_container#6427,cval_part_p_retailprice#6428,cval_part_p_comment#6429,cval_part_p_brand#6430,cp_name#6431,cp_mfgr#6432,cp_type#6433,cp_size#6434,cp_container#6435,cp_retailprice#6436,cp_comment#6437,cp_brand#6438] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#6456 AS rid_0#6473, cval_part_p_name#6457 AS cval_part_p_name_0#6474, cval_part_p_mfgr#6458 AS cval_part_p_mfgr_0#6475, cval_part_p_type#6459 AS cval_part_p_type_0#6476, cval_part_p_size#6460 AS cval_part_p_size_0#6477, cval_part_p_container#6461 AS cval_part_p_container_0#6478, cval_part_p_retailprice#6462 AS cval_part_p_retailprice_0#6479, cval_part_p_comment#6463 AS cval_part_p_comment_0#6480, cval_part_p_brand#6464 AS cval_part_p_brand_0#6481, cp_name#6465 AS cp_name_0#6482, cp_mfgr#6466 AS cp_mfgr_0#6483, cp_type#6467 AS cp_type_0#6484, cp_size#6468 AS cp_size_0#6485, cp_container#6469 AS cp_container_0#6486, cp_retailprice#6470 AS cp_retailprice_0#6487, cp_comment#6471 AS cp_comment_0#6488, cp_brand#6472 AS cp_brand_0#6489]
         :  :  :        +- Relation[rid#6456,cval_part_p_name#6457,cval_part_p_mfgr#6458,cval_part_p_type#6459,cval_part_p_size#6460,cval_part_p_container#6461,cval_part_p_retailprice#6462,cval_part_p_comment#6463,cval_part_p_brand#6464,cp_name#6465,cp_mfgr#6466,cp_type#6467,cp_size#6468,cp_container#6469,cp_retailprice#6470,cp_comment#6471,cp_brand#6472] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#6490 AS rid_0#6507, cval_part_p_name#6491 AS cval_part_p_name_0#6508, cval_part_p_mfgr#6492 AS cval_part_p_mfgr_0#6509, cval_part_p_type#6493 AS cval_part_p_type_0#6510, cval_part_p_size#6494 AS cval_part_p_size_0#6511, cval_part_p_container#6495 AS cval_part_p_container_0#6512, cval_part_p_retailprice#6496 AS cval_part_p_retailprice_0#6513, cval_part_p_comment#6497 AS cval_part_p_comment_0#6514, cval_part_p_brand#6498 AS cval_part_p_brand_0#6515, cp_name#6499 AS cp_name_0#6516, cp_mfgr#6500 AS cp_mfgr_0#6517, cp_type#6501 AS cp_type_0#6518, cp_size#6502 AS cp_size_0#6519, cp_container#6503 AS cp_container_0#6520, cp_retailprice#6504 AS cp_retailprice_0#6521, cp_comment#6505 AS cp_comment_0#6522, cp_brand#6506 AS cp_brand_0#6523]
         :  :        +- Relation[rid#6490,cval_part_p_name#6491,cval_part_p_mfgr#6492,cval_part_p_type#6493,cval_part_p_size#6494,cval_part_p_container#6495,cval_part_p_retailprice#6496,cval_part_p_comment#6497,cval_part_p_brand#6498,cp_name#6499,cp_mfgr#6500,cp_type#6501,cp_size#6502,cp_container#6503,cp_retailprice#6504,cp_comment#6505,cp_brand#6506] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#6590 AS rid_0#6607, cval_part_p_name#6591 AS cval_part_p_name_0#6608, cval_part_p_mfgr#6592 AS cval_part_p_mfgr_0#6609, cval_part_p_type#6593 AS cval_part_p_type_0#6610, cval_part_p_size#6594 AS cval_part_p_size_0#6611, cval_part_p_container#6595 AS cval_part_p_container_0#6612, cval_part_p_retailprice#6596 AS cval_part_p_retailprice_0#6613, cval_part_p_comment#6597 AS cval_part_p_comment_0#6614, cval_part_p_brand#6598 AS cval_part_p_brand_0#6615, cp_name#6599 AS cp_name_0#6616, cp_mfgr#6600 AS cp_mfgr_0#6617, cp_type#6601 AS cp_type_0#6618, cp_size#6602 AS cp_size_0#6619, cp_container#6603 AS cp_container_0#6620, cp_retailprice#6604 AS cp_retailprice_0#6621, cp_comment#6605 AS cp_comment_0#6622, cp_brand#6606 AS cp_brand_0#6623]
         :     :  +- Relation[rid#6590,cval_part_p_name#6591,cval_part_p_mfgr#6592,cval_part_p_type#6593,cval_part_p_size#6594,cval_part_p_container#6595,cval_part_p_retailprice#6596,cval_part_p_comment#6597,cval_part_p_brand#6598,cp_name#6599,cp_mfgr#6600,cp_type#6601,cp_size#6602,cp_container#6603,cp_retailprice#6604,cp_comment#6605,cp_brand#6606] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#6624 AS rid_1#6657, cpfk_orders_lineitem#6625 AS cpfk_orders_lineitem_1#6658, cpfk_supplier_lineitem#6626 AS cpfk_supplier_lineitem_1#6659, cfpk_lineitem_supplier#6627 AS cfpk_lineitem_supplier_1#6660, cfpk_lineitem_partsupp#6628 AS cfpk_lineitem_partsupp_1#6661, cpfk_part_lineitem#6629 AS cpfk_part_lineitem_1#6662, cfpk_lineitem_part#6630 AS cfpk_lineitem_part_1#6663, cpfk_partsupp_lineitem#6631 AS cpfk_partsupp_lineitem_1#6664, cfpk_lineitem_orders#6632 AS cfpk_lineitem_orders_1#6665, cval_lineitem_l_quantity#6633 AS cval_lineitem_l_quantity_1#6666, cval_lineitem_l_extendedprice#6634 AS cval_lineitem_l_extendedprice_1#6667, cval_lineitem_l_discount#6635 AS cval_lineitem_l_discount_1#6668, cval_lineitem_l_tax#6636 AS cval_lineitem_l_tax_1#6669, cval_lineitem_l_returnflag#6637 AS cval_lineitem_l_returnflag_1#6670, cval_lineitem_l_linestatus#6638 AS cval_lineitem_l_linestatus_1#6671, cval_lineitem_l_commitdate#6639 AS cval_lineitem_l_commitdate_1#6672, cval_lineitem_l_receiptdate#6640 AS cval_lineitem_l_receiptdate_1#6673, cval_lineitem_l_shipinstruct#6641 AS cval_lineitem_l_shipinstruct_1#6674, cval_lineitem_l_shipmode#6642 AS cval_lineitem_l_shipmode_1#6675, cval_lineitem_l_comment#6643 AS cval_lineitem_l_comment_1#6676, cval_lineitem_l_shipdate#6644 AS cval_lineitem_l_shipdate_1#6677, cl_quantity#6645 AS cl_quantity_1#6678, cl_extendedprice#6646 AS cl_extendedprice_1#6679, cl_discount#6647 AS cl_discount_1#6680, ... 9 more fields]
         :        +- Relation[rid#6624,cpfk_orders_lineitem#6625,cpfk_supplier_lineitem#6626,cfpk_lineitem_supplier#6627,cfpk_lineitem_partsupp#6628,cpfk_part_lineitem#6629,cfpk_lineitem_part#6630,cpfk_partsupp_lineitem#6631,cfpk_lineitem_orders#6632,cval_lineitem_l_quantity#6633,cval_lineitem_l_extendedprice#6634,cval_lineitem_l_discount#6635,cval_lineitem_l_tax#6636,cval_lineitem_l_returnflag#6637,cval_lineitem_l_linestatus#6638,cval_lineitem_l_commitdate#6639,cval_lineitem_l_receiptdate#6640,cval_lineitem_l_shipinstruct#6641,cval_lineitem_l_shipmode#6642,cval_lineitem_l_comment#6643,cval_lineitem_l_shipdate#6644,cl_quantity#6645,cl_extendedprice#6646,cl_discount#6647,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6524 AS rid_1#6557, cpfk_orders_lineitem#6525 AS cpfk_orders_lineitem_1#6558, cpfk_supplier_lineitem#6526 AS cpfk_supplier_lineitem_1#6559, cfpk_lineitem_supplier#6527 AS cfpk_lineitem_supplier_1#6560, cfpk_lineitem_partsupp#6528 AS cfpk_lineitem_partsupp_1#6561, cpfk_part_lineitem#6529 AS cpfk_part_lineitem_1#6562, cfpk_lineitem_part#6530 AS cfpk_lineitem_part_1#6563, cpfk_partsupp_lineitem#6531 AS cpfk_partsupp_lineitem_1#6564, cfpk_lineitem_orders#6532 AS cfpk_lineitem_orders_1#6565, cval_lineitem_l_quantity#6533 AS cval_lineitem_l_quantity_1#6566, cval_lineitem_l_extendedprice#6534 AS cval_lineitem_l_extendedprice_1#6567, cval_lineitem_l_discount#6535 AS cval_lineitem_l_discount_1#6568, cval_lineitem_l_tax#6536 AS cval_lineitem_l_tax_1#6569, cval_lineitem_l_returnflag#6537 AS cval_lineitem_l_returnflag_1#6570, cval_lineitem_l_linestatus#6538 AS cval_lineitem_l_linestatus_1#6571, cval_lineitem_l_commitdate#6539 AS cval_lineitem_l_commitdate_1#6572, cval_lineitem_l_receiptdate#6540 AS cval_lineitem_l_receiptdate_1#6573, cval_lineitem_l_shipinstruct#6541 AS cval_lineitem_l_shipinstruct_1#6574, cval_lineitem_l_shipmode#6542 AS cval_lineitem_l_shipmode_1#6575, cval_lineitem_l_comment#6543 AS cval_lineitem_l_comment_1#6576, cval_lineitem_l_shipdate#6544 AS cval_lineitem_l_shipdate_1#6577, cl_quantity#6545 AS cl_quantity_1#6578, cl_extendedprice#6546 AS cl_extendedprice_1#6579, cl_discount#6547 AS cl_discount_1#6580, ... 9 more fields]
            +- Relation[rid#6524,cpfk_orders_lineitem#6525,cpfk_supplier_lineitem#6526,cfpk_lineitem_supplier#6527,cfpk_lineitem_partsupp#6528,cpfk_part_lineitem#6529,cfpk_lineitem_part#6530,cpfk_partsupp_lineitem#6531,cfpk_lineitem_orders#6532,cval_lineitem_l_quantity#6533,cval_lineitem_l_extendedprice#6534,cval_lineitem_l_discount#6535,cval_lineitem_l_tax#6536,cval_lineitem_l_returnflag#6537,cval_lineitem_l_linestatus#6538,cval_lineitem_l_commitdate#6539,cval_lineitem_l_receiptdate#6540,cval_lineitem_l_shipinstruct#6541,cval_lineitem_l_shipmode#6542,cval_lineitem_l_comment#6543,cval_lineitem_l_shipdate#6544,cl_quantity#6545,cl_extendedprice#6546,cl_discount#6547,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 71625ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/11 03:08:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:08:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6744L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 03:08:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6744L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#6746 AS rid_0#6779, cpfk_orders_lineitem#6747 AS cpfk_orders_lineitem_0#6780, cpfk_supplier_lineitem#6748 AS cpfk_supplier_lineitem_0#6781, cfpk_lineitem_supplier#6749 AS cfpk_lineitem_supplier_0#6782, cfpk_lineitem_partsupp#6750 AS cfpk_lineitem_partsupp_0#6783, cpfk_part_lineitem#6751 AS cpfk_part_lineitem_0#6784, cfpk_lineitem_part#6752 AS cfpk_lineitem_part_0#6785, cpfk_partsupp_lineitem#6753 AS cpfk_partsupp_lineitem_0#6786, cfpk_lineitem_orders#6754 AS cfpk_lineitem_orders_0#6787, cval_lineitem_l_quantity#6755 AS cval_lineitem_l_quantity_0#6788, cval_lineitem_l_extendedprice#6756 AS cval_lineitem_l_extendedprice_0#6789, cval_lineitem_l_discount#6757 AS cval_lineitem_l_discount_0#6790, cval_lineitem_l_tax#6758 AS cval_lineitem_l_tax_0#6791, cval_lineitem_l_returnflag#6759 AS cval_lineitem_l_returnflag_0#6792, cval_lineitem_l_linestatus#6760 AS cval_lineitem_l_linestatus_0#6793, cval_lineitem_l_commitdate#6761 AS cval_lineitem_l_commitdate_0#6794, cval_lineitem_l_receiptdate#6762 AS cval_lineitem_l_receiptdate_0#6795, cval_lineitem_l_shipinstruct#6763 AS cval_lineitem_l_shipinstruct_0#6796, cval_lineitem_l_shipmode#6764 AS cval_lineitem_l_shipmode_0#6797, cval_lineitem_l_comment#6765 AS cval_lineitem_l_comment_0#6798, cval_lineitem_l_shipdate#6766 AS cval_lineitem_l_shipdate_0#6799, cl_quantity#6767 AS cl_quantity_0#6800, cl_extendedprice#6768 AS cl_extendedprice_0#6801, cl_discount#6769 AS cl_discount_0#6802, ... 9 more fields]
            :  :  +- Relation[rid#6746,cpfk_orders_lineitem#6747,cpfk_supplier_lineitem#6748,cfpk_lineitem_supplier#6749,cfpk_lineitem_partsupp#6750,cpfk_part_lineitem#6751,cfpk_lineitem_part#6752,cpfk_partsupp_lineitem#6753,cfpk_lineitem_orders#6754,cval_lineitem_l_quantity#6755,cval_lineitem_l_extendedprice#6756,cval_lineitem_l_discount#6757,cval_lineitem_l_tax#6758,cval_lineitem_l_returnflag#6759,cval_lineitem_l_linestatus#6760,cval_lineitem_l_commitdate#6761,cval_lineitem_l_receiptdate#6762,cval_lineitem_l_shipinstruct#6763,cval_lineitem_l_shipmode#6764,cval_lineitem_l_comment#6765,cval_lineitem_l_shipdate#6766,cl_quantity#6767,cl_extendedprice#6768,cl_discount#6769,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#6812 AS rid_0#6845, cpfk_orders_lineitem#6813 AS cpfk_orders_lineitem_0#6846, cpfk_supplier_lineitem#6814 AS cpfk_supplier_lineitem_0#6847, cfpk_lineitem_supplier#6815 AS cfpk_lineitem_supplier_0#6848, cfpk_lineitem_partsupp#6816 AS cfpk_lineitem_partsupp_0#6849, cpfk_part_lineitem#6817 AS cpfk_part_lineitem_0#6850, cfpk_lineitem_part#6818 AS cfpk_lineitem_part_0#6851, cpfk_partsupp_lineitem#6819 AS cpfk_partsupp_lineitem_0#6852, cfpk_lineitem_orders#6820 AS cfpk_lineitem_orders_0#6853, cval_lineitem_l_quantity#6821 AS cval_lineitem_l_quantity_0#6854, cval_lineitem_l_extendedprice#6822 AS cval_lineitem_l_extendedprice_0#6855, cval_lineitem_l_discount#6823 AS cval_lineitem_l_discount_0#6856, cval_lineitem_l_tax#6824 AS cval_lineitem_l_tax_0#6857, cval_lineitem_l_returnflag#6825 AS cval_lineitem_l_returnflag_0#6858, cval_lineitem_l_linestatus#6826 AS cval_lineitem_l_linestatus_0#6859, cval_lineitem_l_commitdate#6827 AS cval_lineitem_l_commitdate_0#6860, cval_lineitem_l_receiptdate#6828 AS cval_lineitem_l_receiptdate_0#6861, cval_lineitem_l_shipinstruct#6829 AS cval_lineitem_l_shipinstruct_0#6862, cval_lineitem_l_shipmode#6830 AS cval_lineitem_l_shipmode_0#6863, cval_lineitem_l_comment#6831 AS cval_lineitem_l_comment_0#6864, cval_lineitem_l_shipdate#6832 AS cval_lineitem_l_shipdate_0#6865, cl_quantity#6833 AS cl_quantity_0#6866, cl_extendedprice#6834 AS cl_extendedprice_0#6867, cl_discount#6835 AS cl_discount_0#6868, ... 9 more fields]
            :        +- Relation[rid#6812,cpfk_orders_lineitem#6813,cpfk_supplier_lineitem#6814,cfpk_lineitem_supplier#6815,cfpk_lineitem_partsupp#6816,cpfk_part_lineitem#6817,cfpk_lineitem_part#6818,cpfk_partsupp_lineitem#6819,cfpk_lineitem_orders#6820,cval_lineitem_l_quantity#6821,cval_lineitem_l_extendedprice#6822,cval_lineitem_l_discount#6823,cval_lineitem_l_tax#6824,cval_lineitem_l_returnflag#6825,cval_lineitem_l_linestatus#6826,cval_lineitem_l_commitdate#6827,cval_lineitem_l_receiptdate#6828,cval_lineitem_l_shipinstruct#6829,cval_lineitem_l_shipmode#6830,cval_lineitem_l_comment#6831,cval_lineitem_l_shipdate#6832,cl_quantity#6833,cl_extendedprice#6834,cl_discount#6835,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#6878 AS rid_1#6895, cpfk_customer_orders#6879 AS cpfk_customer_orders_1#6896, cfpk_orders_customer#6880 AS cfpk_orders_customer_1#6897, cval_orders_o_orderstatus#6881 AS cval_orders_o_orderstatus_1#6898, cval_orders_o_totalprice#6882 AS cval_orders_o_totalprice_1#6899, cval_orders_o_orderpriority#6883 AS cval_orders_o_orderpriority_1#6900, cval_orders_o_clerk#6884 AS cval_orders_o_clerk_1#6901, cval_orders_o_shippriority#6885 AS cval_orders_o_shippriority_1#6902, cval_orders_o_comment#6886 AS cval_orders_o_comment_1#6903, cval_orders_o_orderdate#6887 AS cval_orders_o_orderdate_1#6904, co_orderstatus#6888 AS co_orderstatus_1#6905, co_totalprice#6889 AS co_totalprice_1#6906, co_orderpriority#6890 AS co_orderpriority_1#6907, co_clerk#6891 AS co_clerk_1#6908, co_shippriority#6892 AS co_shippriority_1#6909, co_comment#6893 AS co_comment_1#6910, co_orderdate#6894 AS co_orderdate_1#6911]
               +- Relation[rid#6878,cpfk_customer_orders#6879,cfpk_orders_customer#6880,cval_orders_o_orderstatus#6881,cval_orders_o_totalprice#6882,cval_orders_o_orderpriority#6883,cval_orders_o_clerk#6884,cval_orders_o_shippriority#6885,cval_orders_o_comment#6886,cval_orders_o_orderdate#6887,co_orderstatus#6888,co_totalprice#6889,co_orderpriority#6890,co_clerk#6891,co_shippriority#6892,co_comment#6893,co_orderdate#6894] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 21695ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/11 03:09:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:09:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6970L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 03:09:14 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 03:09:14 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 03:09:14 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 03:09:14 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 03:09:14 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 03:09:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6970L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#6972 AS rid_0#6987, cpfk_nation_customer#6973 AS cpfk_nation_customer_0#6988, cfpk_customer_nation#6974 AS cfpk_customer_nation_0#6989, cval_customer_c_name#6975 AS cval_customer_c_name_0#6990, cval_customer_c_address#6976 AS cval_customer_c_address_0#6991, cval_customer_c_phone#6977 AS cval_customer_c_phone_0#6992, cval_customer_c_acctbal#6978 AS cval_customer_c_acctbal_0#6993, cval_customer_c_comment#6979 AS cval_customer_c_comment_0#6994, cval_customer_c_mktsegment#6980 AS cval_customer_c_mktsegment_0#6995, cc_name#6981 AS cc_name_0#6996, cc_address#6982 AS cc_address_0#6997, cc_phone#6983 AS cc_phone_0#6998, cc_acctbal#6984 AS cc_acctbal_0#6999, cc_comment#6985 AS cc_comment_0#7000, cc_mktsegment#6986 AS cc_mktsegment_0#7001]
         :  :  :  :  :  +- Relation[rid#6972,cpfk_nation_customer#6973,cfpk_customer_nation#6974,cval_customer_c_name#6975,cval_customer_c_address#6976,cval_customer_c_phone#6977,cval_customer_c_acctbal#6978,cval_customer_c_comment#6979,cval_customer_c_mktsegment#6980,cc_name#6981,cc_address#6982,cc_phone#6983,cc_acctbal#6984,cc_comment#6985,cc_mktsegment#6986] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#7002 AS rid_0#7017, cpfk_nation_customer#7003 AS cpfk_nation_customer_0#7018, cfpk_customer_nation#7004 AS cfpk_customer_nation_0#7019, cval_customer_c_name#7005 AS cval_customer_c_name_0#7020, cval_customer_c_address#7006 AS cval_customer_c_address_0#7021, cval_customer_c_phone#7007 AS cval_customer_c_phone_0#7022, cval_customer_c_acctbal#7008 AS cval_customer_c_acctbal_0#7023, cval_customer_c_comment#7009 AS cval_customer_c_comment_0#7024, cval_customer_c_mktsegment#7010 AS cval_customer_c_mktsegment_0#7025, cc_name#7011 AS cc_name_0#7026, cc_address#7012 AS cc_address_0#7027, cc_phone#7013 AS cc_phone_0#7028, cc_acctbal#7014 AS cc_acctbal_0#7029, cc_comment#7015 AS cc_comment_0#7030, cc_mktsegment#7016 AS cc_mktsegment_0#7031]
         :  :  :  :        +- Relation[rid#7002,cpfk_nation_customer#7003,cfpk_customer_nation#7004,cval_customer_c_name#7005,cval_customer_c_address#7006,cval_customer_c_phone#7007,cval_customer_c_acctbal#7008,cval_customer_c_comment#7009,cval_customer_c_mktsegment#7010,cc_name#7011,cc_address#7012,cc_phone#7013,cc_acctbal#7014,cc_comment#7015,cc_mktsegment#7016] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#7066 AS rid_0#7081, cpfk_nation_customer#7067 AS cpfk_nation_customer_0#7082, cfpk_customer_nation#7068 AS cfpk_customer_nation_0#7083, cval_customer_c_name#7069 AS cval_customer_c_name_0#7084, cval_customer_c_address#7070 AS cval_customer_c_address_0#7085, cval_customer_c_phone#7071 AS cval_customer_c_phone_0#7086, cval_customer_c_acctbal#7072 AS cval_customer_c_acctbal_0#7087, cval_customer_c_comment#7073 AS cval_customer_c_comment_0#7088, cval_customer_c_mktsegment#7074 AS cval_customer_c_mktsegment_0#7089, cc_name#7075 AS cc_name_0#7090, cc_address#7076 AS cc_address_0#7091, cc_phone#7077 AS cc_phone_0#7092, cc_acctbal#7078 AS cc_acctbal_0#7093, cc_comment#7079 AS cc_comment_0#7094, cc_mktsegment#7080 AS cc_mktsegment_0#7095]
         :  :  :     :  +- Relation[rid#7066,cpfk_nation_customer#7067,cfpk_customer_nation#7068,cval_customer_c_name#7069,cval_customer_c_address#7070,cval_customer_c_phone#7071,cval_customer_c_acctbal#7072,cval_customer_c_comment#7073,cval_customer_c_mktsegment#7074,cc_name#7075,cc_address#7076,cc_phone#7077,cc_acctbal#7078,cc_comment#7079,cc_mktsegment#7080] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#7096 AS rid_1#7113, cpfk_customer_orders#7097 AS cpfk_customer_orders_1#7114, cfpk_orders_customer#7098 AS cfpk_orders_customer_1#7115, cval_orders_o_orderstatus#7099 AS cval_orders_o_orderstatus_1#7116, cval_orders_o_totalprice#7100 AS cval_orders_o_totalprice_1#7117, cval_orders_o_orderpriority#7101 AS cval_orders_o_orderpriority_1#7118, cval_orders_o_clerk#7102 AS cval_orders_o_clerk_1#7119, cval_orders_o_shippriority#7103 AS cval_orders_o_shippriority_1#7120, cval_orders_o_comment#7104 AS cval_orders_o_comment_1#7121, cval_orders_o_orderdate#7105 AS cval_orders_o_orderdate_1#7122, co_orderstatus#7106 AS co_orderstatus_1#7123, co_totalprice#7107 AS co_totalprice_1#7124, co_orderpriority#7108 AS co_orderpriority_1#7125, co_clerk#7109 AS co_clerk_1#7126, co_shippriority#7110 AS co_shippriority_1#7127, co_comment#7111 AS co_comment_1#7128, co_orderdate#7112 AS co_orderdate_1#7129]
         :  :  :        +- Relation[rid#7096,cpfk_customer_orders#7097,cfpk_orders_customer#7098,cval_orders_o_orderstatus#7099,cval_orders_o_totalprice#7100,cval_orders_o_orderpriority#7101,cval_orders_o_clerk#7102,cval_orders_o_shippriority#7103,cval_orders_o_comment#7104,cval_orders_o_orderdate#7105,co_orderstatus#7106,co_totalprice#7107,co_orderpriority#7108,co_clerk#7109,co_shippriority#7110,co_comment#7111,co_orderdate#7112] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#7032 AS rid_1#7049, cpfk_customer_orders#7033 AS cpfk_customer_orders_1#7050, cfpk_orders_customer#7034 AS cfpk_orders_customer_1#7051, cval_orders_o_orderstatus#7035 AS cval_orders_o_orderstatus_1#7052, cval_orders_o_totalprice#7036 AS cval_orders_o_totalprice_1#7053, cval_orders_o_orderpriority#7037 AS cval_orders_o_orderpriority_1#7054, cval_orders_o_clerk#7038 AS cval_orders_o_clerk_1#7055, cval_orders_o_shippriority#7039 AS cval_orders_o_shippriority_1#7056, cval_orders_o_comment#7040 AS cval_orders_o_comment_1#7057, cval_orders_o_orderdate#7041 AS cval_orders_o_orderdate_1#7058, co_orderstatus#7042 AS co_orderstatus_1#7059, co_totalprice#7043 AS co_totalprice_1#7060, co_orderpriority#7044 AS co_orderpriority_1#7061, co_clerk#7045 AS co_clerk_1#7062, co_shippriority#7046 AS co_shippriority_1#7063, co_comment#7047 AS co_comment_1#7064, co_orderdate#7048 AS co_orderdate_1#7065]
         :  :     +- Relation[rid#7032,cpfk_customer_orders#7033,cfpk_orders_customer#7034,cval_orders_o_orderstatus#7035,cval_orders_o_totalprice#7036,cval_orders_o_orderpriority#7037,cval_orders_o_clerk#7038,cval_orders_o_shippriority#7039,cval_orders_o_comment#7040,cval_orders_o_orderdate#7041,co_orderstatus#7042,co_totalprice#7043,co_orderpriority#7044,co_clerk#7045,co_shippriority#7046,co_comment#7047,co_orderdate#7048] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#7196 AS rid_1#7213, cpfk_customer_orders#7197 AS cpfk_customer_orders_1#7214, cfpk_orders_customer#7198 AS cfpk_orders_customer_1#7215, cval_orders_o_orderstatus#7199 AS cval_orders_o_orderstatus_1#7216, cval_orders_o_totalprice#7200 AS cval_orders_o_totalprice_1#7217, cval_orders_o_orderpriority#7201 AS cval_orders_o_orderpriority_1#7218, cval_orders_o_clerk#7202 AS cval_orders_o_clerk_1#7219, cval_orders_o_shippriority#7203 AS cval_orders_o_shippriority_1#7220, cval_orders_o_comment#7204 AS cval_orders_o_comment_1#7221, cval_orders_o_orderdate#7205 AS cval_orders_o_orderdate_1#7222, co_orderstatus#7206 AS co_orderstatus_1#7223, co_totalprice#7207 AS co_totalprice_1#7224, co_orderpriority#7208 AS co_orderpriority_1#7225, co_clerk#7209 AS co_clerk_1#7226, co_shippriority#7210 AS co_shippriority_1#7227, co_comment#7211 AS co_comment_1#7228, co_orderdate#7212 AS co_orderdate_1#7229]
         :     :  +- Relation[rid#7196,cpfk_customer_orders#7197,cfpk_orders_customer#7198,cval_orders_o_orderstatus#7199,cval_orders_o_totalprice#7200,cval_orders_o_orderpriority#7201,cval_orders_o_clerk#7202,cval_orders_o_shippriority#7203,cval_orders_o_comment#7204,cval_orders_o_orderdate#7205,co_orderstatus#7206,co_totalprice#7207,co_orderpriority#7208,co_clerk#7209,co_shippriority#7210,co_comment#7211,co_orderdate#7212] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#7230 AS rid_2#7263, cpfk_orders_lineitem#7231 AS cpfk_orders_lineitem_2#7264, cpfk_supplier_lineitem#7232 AS cpfk_supplier_lineitem_2#7265, cfpk_lineitem_supplier#7233 AS cfpk_lineitem_supplier_2#7266, cfpk_lineitem_partsupp#7234 AS cfpk_lineitem_partsupp_2#7267, cpfk_part_lineitem#7235 AS cpfk_part_lineitem_2#7268, cfpk_lineitem_part#7236 AS cfpk_lineitem_part_2#7269, cpfk_partsupp_lineitem#7237 AS cpfk_partsupp_lineitem_2#7270, cfpk_lineitem_orders#7238 AS cfpk_lineitem_orders_2#7271, cval_lineitem_l_quantity#7239 AS cval_lineitem_l_quantity_2#7272, cval_lineitem_l_extendedprice#7240 AS cval_lineitem_l_extendedprice_2#7273, cval_lineitem_l_discount#7241 AS cval_lineitem_l_discount_2#7274, cval_lineitem_l_tax#7242 AS cval_lineitem_l_tax_2#7275, cval_lineitem_l_returnflag#7243 AS cval_lineitem_l_returnflag_2#7276, cval_lineitem_l_linestatus#7244 AS cval_lineitem_l_linestatus_2#7277, cval_lineitem_l_commitdate#7245 AS cval_lineitem_l_commitdate_2#7278, cval_lineitem_l_receiptdate#7246 AS cval_lineitem_l_receiptdate_2#7279, cval_lineitem_l_shipinstruct#7247 AS cval_lineitem_l_shipinstruct_2#7280, cval_lineitem_l_shipmode#7248 AS cval_lineitem_l_shipmode_2#7281, cval_lineitem_l_comment#7249 AS cval_lineitem_l_comment_2#7282, cval_lineitem_l_shipdate#7250 AS cval_lineitem_l_shipdate_2#7283, cl_quantity#7251 AS cl_quantity_2#7284, cl_extendedprice#7252 AS cl_extendedprice_2#7285, cl_discount#7253 AS cl_discount_2#7286, ... 9 more fields]
         :        +- Relation[rid#7230,cpfk_orders_lineitem#7231,cpfk_supplier_lineitem#7232,cfpk_lineitem_supplier#7233,cfpk_lineitem_partsupp#7234,cpfk_part_lineitem#7235,cfpk_lineitem_part#7236,cpfk_partsupp_lineitem#7237,cfpk_lineitem_orders#7238,cval_lineitem_l_quantity#7239,cval_lineitem_l_extendedprice#7240,cval_lineitem_l_discount#7241,cval_lineitem_l_tax#7242,cval_lineitem_l_returnflag#7243,cval_lineitem_l_linestatus#7244,cval_lineitem_l_commitdate#7245,cval_lineitem_l_receiptdate#7246,cval_lineitem_l_shipinstruct#7247,cval_lineitem_l_shipmode#7248,cval_lineitem_l_comment#7249,cval_lineitem_l_shipdate#7250,cl_quantity#7251,cl_extendedprice#7252,cl_discount#7253,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7130 AS rid_2#7163, cpfk_orders_lineitem#7131 AS cpfk_orders_lineitem_2#7164, cpfk_supplier_lineitem#7132 AS cpfk_supplier_lineitem_2#7165, cfpk_lineitem_supplier#7133 AS cfpk_lineitem_supplier_2#7166, cfpk_lineitem_partsupp#7134 AS cfpk_lineitem_partsupp_2#7167, cpfk_part_lineitem#7135 AS cpfk_part_lineitem_2#7168, cfpk_lineitem_part#7136 AS cfpk_lineitem_part_2#7169, cpfk_partsupp_lineitem#7137 AS cpfk_partsupp_lineitem_2#7170, cfpk_lineitem_orders#7138 AS cfpk_lineitem_orders_2#7171, cval_lineitem_l_quantity#7139 AS cval_lineitem_l_quantity_2#7172, cval_lineitem_l_extendedprice#7140 AS cval_lineitem_l_extendedprice_2#7173, cval_lineitem_l_discount#7141 AS cval_lineitem_l_discount_2#7174, cval_lineitem_l_tax#7142 AS cval_lineitem_l_tax_2#7175, cval_lineitem_l_returnflag#7143 AS cval_lineitem_l_returnflag_2#7176, cval_lineitem_l_linestatus#7144 AS cval_lineitem_l_linestatus_2#7177, cval_lineitem_l_commitdate#7145 AS cval_lineitem_l_commitdate_2#7178, cval_lineitem_l_receiptdate#7146 AS cval_lineitem_l_receiptdate_2#7179, cval_lineitem_l_shipinstruct#7147 AS cval_lineitem_l_shipinstruct_2#7180, cval_lineitem_l_shipmode#7148 AS cval_lineitem_l_shipmode_2#7181, cval_lineitem_l_comment#7149 AS cval_lineitem_l_comment_2#7182, cval_lineitem_l_shipdate#7150 AS cval_lineitem_l_shipdate_2#7183, cl_quantity#7151 AS cl_quantity_2#7184, cl_extendedprice#7152 AS cl_extendedprice_2#7185, cl_discount#7153 AS cl_discount_2#7186, ... 9 more fields]
            +- Relation[rid#7130,cpfk_orders_lineitem#7131,cpfk_supplier_lineitem#7132,cfpk_lineitem_supplier#7133,cfpk_lineitem_partsupp#7134,cpfk_part_lineitem#7135,cfpk_lineitem_part#7136,cpfk_partsupp_lineitem#7137,cfpk_lineitem_orders#7138,cval_lineitem_l_quantity#7139,cval_lineitem_l_extendedprice#7140,cval_lineitem_l_discount#7141,cval_lineitem_l_tax#7142,cval_lineitem_l_returnflag#7143,cval_lineitem_l_linestatus#7144,cval_lineitem_l_commitdate#7145,cval_lineitem_l_receiptdate#7146,cval_lineitem_l_shipinstruct#7147,cval_lineitem_l_shipmode#7148,cval_lineitem_l_comment#7149,cval_lineitem_l_shipdate#7150,cl_quantity#7151,cl_extendedprice#7152,cl_discount#7153,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 115326ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/11 03:11:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:11:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7366L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 03:11:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7366L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#7368 AS rid_0#7385, cpfk_customer_orders#7369 AS cpfk_customer_orders_0#7386, cfpk_orders_customer#7370 AS cfpk_orders_customer_0#7387, cval_orders_o_orderstatus#7371 AS cval_orders_o_orderstatus_0#7388, cval_orders_o_totalprice#7372 AS cval_orders_o_totalprice_0#7389, cval_orders_o_orderpriority#7373 AS cval_orders_o_orderpriority_0#7390, cval_orders_o_clerk#7374 AS cval_orders_o_clerk_0#7391, cval_orders_o_shippriority#7375 AS cval_orders_o_shippriority_0#7392, cval_orders_o_comment#7376 AS cval_orders_o_comment_0#7393, cval_orders_o_orderdate#7377 AS cval_orders_o_orderdate_0#7394, co_orderstatus#7378 AS co_orderstatus_0#7395, co_totalprice#7379 AS co_totalprice_0#7396, co_orderpriority#7380 AS co_orderpriority_0#7397, co_clerk#7381 AS co_clerk_0#7398, co_shippriority#7382 AS co_shippriority_0#7399, co_comment#7383 AS co_comment_0#7400, co_orderdate#7384 AS co_orderdate_0#7401]
            :  +- Relation[rid#7368,cpfk_customer_orders#7369,cfpk_orders_customer#7370,cval_orders_o_orderstatus#7371,cval_orders_o_totalprice#7372,cval_orders_o_orderpriority#7373,cval_orders_o_clerk#7374,cval_orders_o_shippriority#7375,cval_orders_o_comment#7376,cval_orders_o_orderdate#7377,co_orderstatus#7378,co_totalprice#7379,co_orderpriority#7380,co_clerk#7381,co_shippriority#7382,co_comment#7383,co_orderdate#7384] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#7402 AS rid_1#7417, cpfk_nation_customer#7403 AS cpfk_nation_customer_1#7418, cfpk_customer_nation#7404 AS cfpk_customer_nation_1#7419, cval_customer_c_name#7405 AS cval_customer_c_name_1#7420, cval_customer_c_address#7406 AS cval_customer_c_address_1#7421, cval_customer_c_phone#7407 AS cval_customer_c_phone_1#7422, cval_customer_c_acctbal#7408 AS cval_customer_c_acctbal_1#7423, cval_customer_c_comment#7409 AS cval_customer_c_comment_1#7424, cval_customer_c_mktsegment#7410 AS cval_customer_c_mktsegment_1#7425, cc_name#7411 AS cc_name_1#7426, cc_address#7412 AS cc_address_1#7427, cc_phone#7413 AS cc_phone_1#7428, cc_acctbal#7414 AS cc_acctbal_1#7429, cc_comment#7415 AS cc_comment_1#7430, cc_mktsegment#7416 AS cc_mktsegment_1#7431]
               +- Relation[rid#7402,cpfk_nation_customer#7403,cfpk_customer_nation#7404,cval_customer_c_name#7405,cval_customer_c_address#7406,cval_customer_c_phone#7407,cval_customer_c_acctbal#7408,cval_customer_c_comment#7409,cval_customer_c_mktsegment#7410,cc_name#7411,cc_address#7412,cc_phone#7413,cc_acctbal#7414,cc_comment#7415,cc_mktsegment#7416] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 12768ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/11 03:11:22 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:11:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7470L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 03:11:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:11:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:11:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:11:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:11:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:11:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:11:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:11:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:11:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:11:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:11:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:11:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:11:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:11:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7470L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#7472 AS rid_0#7479, cpfk_region_nation#7473 AS cpfk_region_nation_0#7480, cfpk_nation_region#7474 AS cfpk_nation_region_0#7481, cval_nation_n_name#7475 AS cval_nation_n_name_0#7482, cval_nation_n_comment#7476 AS cval_nation_n_comment_0#7483, cn_name#7477 AS cn_name_0#7484, cn_comment#7478 AS cn_comment_0#7485]
         :  :  :  :  :  +- Relation[rid#7472,cpfk_region_nation#7473,cfpk_nation_region#7474,cval_nation_n_name#7475,cval_nation_n_comment#7476,cn_name#7477,cn_comment#7478] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#7486 AS rid_0#7493, cpfk_region_nation#7487 AS cpfk_region_nation_0#7494, cfpk_nation_region#7488 AS cfpk_nation_region_0#7495, cval_nation_n_name#7489 AS cval_nation_n_name_0#7496, cval_nation_n_comment#7490 AS cval_nation_n_comment_0#7497, cn_name#7491 AS cn_name_0#7498, cn_comment#7492 AS cn_comment_0#7499]
         :  :  :  :        +- Relation[rid#7486,cpfk_region_nation#7487,cfpk_nation_region#7488,cval_nation_n_name#7489,cval_nation_n_comment#7490,cn_name#7491,cn_comment#7492] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :     :- Project [rid#7526 AS rid_0#7533, cpfk_region_nation#7527 AS cpfk_region_nation_0#7534, cfpk_nation_region#7528 AS cfpk_nation_region_0#7535, cval_nation_n_name#7529 AS cval_nation_n_name_0#7536, cval_nation_n_comment#7530 AS cval_nation_n_comment_0#7537, cn_name#7531 AS cn_name_0#7538, cn_comment#7532 AS cn_comment_0#7539]
         :  :  :     :  +- Relation[rid#7526,cpfk_region_nation#7527,cfpk_nation_region#7528,cval_nation_n_name#7529,cval_nation_n_comment#7530,cn_name#7531,cn_comment#7532] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#7540 AS rid_1#7553, cpfk_nation_supplier#7541 AS cpfk_nation_supplier_1#7554, cfpk_supplier_nation#7542 AS cfpk_supplier_nation_1#7555, cval_supplier_s_name#7543 AS cval_supplier_s_name_1#7556, cval_supplier_s_address#7544 AS cval_supplier_s_address_1#7557, cval_supplier_s_phone#7545 AS cval_supplier_s_phone_1#7558, cval_supplier_s_acctbal#7546 AS cval_supplier_s_acctbal_1#7559, cval_supplier_s_comment#7547 AS cval_supplier_s_comment_1#7560, cs_name#7548 AS cs_name_1#7561, cs_address#7549 AS cs_address_1#7562, cs_phone#7550 AS cs_phone_1#7563, cs_acctbal#7551 AS cs_acctbal_1#7564, cs_comment#7552 AS cs_comment_1#7565]
         :  :  :        +- Relation[rid#7540,cpfk_nation_supplier#7541,cfpk_supplier_nation#7542,cval_supplier_s_name#7543,cval_supplier_s_address#7544,cval_supplier_s_phone#7545,cval_supplier_s_acctbal#7546,cval_supplier_s_comment#7547,cs_name#7548,cs_address#7549,cs_phone#7550,cs_acctbal#7551,cs_comment#7552] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#7500 AS rid_1#7513, cpfk_nation_supplier#7501 AS cpfk_nation_supplier_1#7514, cfpk_supplier_nation#7502 AS cfpk_supplier_nation_1#7515, cval_supplier_s_name#7503 AS cval_supplier_s_name_1#7516, cval_supplier_s_address#7504 AS cval_supplier_s_address_1#7517, cval_supplier_s_phone#7505 AS cval_supplier_s_phone_1#7518, cval_supplier_s_acctbal#7506 AS cval_supplier_s_acctbal_1#7519, cval_supplier_s_comment#7507 AS cval_supplier_s_comment_1#7520, cs_name#7508 AS cs_name_1#7521, cs_address#7509 AS cs_address_1#7522, cs_phone#7510 AS cs_phone_1#7523, cs_acctbal#7511 AS cs_acctbal_1#7524, cs_comment#7512 AS cs_comment_1#7525]
         :  :     +- Relation[rid#7500,cpfk_nation_supplier#7501,cfpk_supplier_nation#7502,cval_supplier_s_name#7503,cval_supplier_s_address#7504,cval_supplier_s_phone#7505,cval_supplier_s_acctbal#7506,cval_supplier_s_comment#7507,cs_name#7508,cs_address#7509,cs_phone#7510,cs_acctbal#7511,cs_comment#7512] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :     :- Project [rid#7588 AS rid_1#7601, cpfk_nation_supplier#7589 AS cpfk_nation_supplier_1#7602, cfpk_supplier_nation#7590 AS cfpk_supplier_nation_1#7603, cval_supplier_s_name#7591 AS cval_supplier_s_name_1#7604, cval_supplier_s_address#7592 AS cval_supplier_s_address_1#7605, cval_supplier_s_phone#7593 AS cval_supplier_s_phone_1#7606, cval_supplier_s_acctbal#7594 AS cval_supplier_s_acctbal_1#7607, cval_supplier_s_comment#7595 AS cval_supplier_s_comment_1#7608, cs_name#7596 AS cs_name_1#7609, cs_address#7597 AS cs_address_1#7610, cs_phone#7598 AS cs_phone_1#7611, cs_acctbal#7599 AS cs_acctbal_1#7612, cs_comment#7600 AS cs_comment_1#7613]
         :     :  +- Relation[rid#7588,cpfk_nation_supplier#7589,cfpk_supplier_nation#7590,cval_supplier_s_name#7591,cval_supplier_s_address#7592,cval_supplier_s_phone#7593,cval_supplier_s_acctbal#7594,cval_supplier_s_comment#7595,cs_name#7596,cs_address#7597,cs_phone#7598,cs_acctbal#7599,cs_comment#7600] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#7614 AS rid_2#7625, cpfk_part_partsupp#7615 AS cpfk_part_partsupp_2#7626, cfpk_partsupp_part#7616 AS cfpk_partsupp_part_2#7627, cpfk_supplier_partsupp#7617 AS cpfk_supplier_partsupp_2#7628, cfpk_partsupp_supplier#7618 AS cfpk_partsupp_supplier_2#7629, cval_partsupp_ps_availqty#7619 AS cval_partsupp_ps_availqty_2#7630, cval_partsupp_ps_supplycost#7620 AS cval_partsupp_ps_supplycost_2#7631, cval_partsupp_ps_comment#7621 AS cval_partsupp_ps_comment_2#7632, cps_availqty#7622 AS cps_availqty_2#7633, cps_supplycost#7623 AS cps_supplycost_2#7634, cps_comment#7624 AS cps_comment_2#7635]
         :        +- Relation[rid#7614,cpfk_part_partsupp#7615,cfpk_partsupp_part#7616,cpfk_supplier_partsupp#7617,cfpk_partsupp_supplier#7618,cval_partsupp_ps_availqty#7619,cval_partsupp_ps_supplycost#7620,cval_partsupp_ps_comment#7621,cps_availqty#7622,cps_supplycost#7623,cps_comment#7624] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#7566 AS rid_2#7577, cpfk_part_partsupp#7567 AS cpfk_part_partsupp_2#7578, cfpk_partsupp_part#7568 AS cfpk_partsupp_part_2#7579, cpfk_supplier_partsupp#7569 AS cpfk_supplier_partsupp_2#7580, cfpk_partsupp_supplier#7570 AS cfpk_partsupp_supplier_2#7581, cval_partsupp_ps_availqty#7571 AS cval_partsupp_ps_availqty_2#7582, cval_partsupp_ps_supplycost#7572 AS cval_partsupp_ps_supplycost_2#7583, cval_partsupp_ps_comment#7573 AS cval_partsupp_ps_comment_2#7584, cps_availqty#7574 AS cps_availqty_2#7585, cps_supplycost#7575 AS cps_supplycost_2#7586, cps_comment#7576 AS cps_comment_2#7587]
            +- Relation[rid#7566,cpfk_part_partsupp#7567,cfpk_partsupp_part#7568,cpfk_supplier_partsupp#7569,cfpk_partsupp_supplier#7570,cval_partsupp_ps_availqty#7571,cval_partsupp_ps_supplycost#7572,cval_partsupp_ps_comment#7573,cps_availqty#7574,cps_supplycost#7575,cps_comment#7576] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 10507ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 03:11:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:11:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7676L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 03:11:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:11:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:11:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:11:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:11:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:11:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:11:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:11:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:11:33 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:11:33 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:11:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7676L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#7678 AS rid_0#7685, cpfk_region_nation#7679 AS cpfk_region_nation_0#7686, cfpk_nation_region#7680 AS cfpk_nation_region_0#7687, cval_nation_n_name#7681 AS cval_nation_n_name_0#7688, cval_nation_n_comment#7682 AS cval_nation_n_comment_0#7689, cn_name#7683 AS cn_name_0#7690, cn_comment#7684 AS cn_comment_0#7691]
            :     :     :  :  :  :  :  +- Relation[rid#7678,cpfk_region_nation#7679,cfpk_nation_region#7680,cval_nation_n_name#7681,cval_nation_n_comment#7682,cn_name#7683,cn_comment#7684] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#7718 AS rid_0#7725, cpfk_region_nation#7719 AS cpfk_region_nation_0#7726, cfpk_nation_region#7720 AS cfpk_nation_region_0#7727, cval_nation_n_name#7721 AS cval_nation_n_name_0#7728, cval_nation_n_comment#7722 AS cval_nation_n_comment_0#7729, cn_name#7723 AS cn_name_0#7730, cn_comment#7724 AS cn_comment_0#7731]
            :     :     :  :  :  :     :  +- Relation[rid#7718,cpfk_region_nation#7719,cfpk_nation_region#7720,cval_nation_n_name#7721,cval_nation_n_comment#7722,cn_name#7723,cn_comment#7724] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#7732 AS rid_1#7745, cpfk_nation_supplier#7733 AS cpfk_nation_supplier_1#7746, cfpk_supplier_nation#7734 AS cfpk_supplier_nation_1#7747, cval_supplier_s_name#7735 AS cval_supplier_s_name_1#7748, cval_supplier_s_address#7736 AS cval_supplier_s_address_1#7749, cval_supplier_s_phone#7737 AS cval_supplier_s_phone_1#7750, cval_supplier_s_acctbal#7738 AS cval_supplier_s_acctbal_1#7751, cval_supplier_s_comment#7739 AS cval_supplier_s_comment_1#7752, cs_name#7740 AS cs_name_1#7753, cs_address#7741 AS cs_address_1#7754, cs_phone#7742 AS cs_phone_1#7755, cs_acctbal#7743 AS cs_acctbal_1#7756, cs_comment#7744 AS cs_comment_1#7757]
            :     :     :  :  :  :        +- Relation[rid#7732,cpfk_nation_supplier#7733,cfpk_supplier_nation#7734,cval_supplier_s_name#7735,cval_supplier_s_address#7736,cval_supplier_s_phone#7737,cval_supplier_s_acctbal#7738,cval_supplier_s_comment#7739,cs_name#7740,cs_address#7741,cs_phone#7742,cs_acctbal#7743,cs_comment#7744] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#7692 AS rid_1#7705, cpfk_nation_supplier#7693 AS cpfk_nation_supplier_1#7706, cfpk_supplier_nation#7694 AS cfpk_supplier_nation_1#7707, cval_supplier_s_name#7695 AS cval_supplier_s_name_1#7708, cval_supplier_s_address#7696 AS cval_supplier_s_address_1#7709, cval_supplier_s_phone#7697 AS cval_supplier_s_phone_1#7710, cval_supplier_s_acctbal#7698 AS cval_supplier_s_acctbal_1#7711, cval_supplier_s_comment#7699 AS cval_supplier_s_comment_1#7712, cs_name#7700 AS cs_name_1#7713, cs_address#7701 AS cs_address_1#7714, cs_phone#7702 AS cs_phone_1#7715, cs_acctbal#7703 AS cs_acctbal_1#7716, cs_comment#7704 AS cs_comment_1#7717]
            :     :     :  :  :     +- Relation[rid#7692,cpfk_nation_supplier#7693,cfpk_supplier_nation#7694,cval_supplier_s_name#7695,cval_supplier_s_address#7696,cval_supplier_s_phone#7697,cval_supplier_s_acctbal#7698,cval_supplier_s_comment#7699,cs_name#7700,cs_address#7701,cs_phone#7702,cs_acctbal#7703,cs_comment#7704] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#7824 AS rid_1#7837, cpfk_nation_supplier#7825 AS cpfk_nation_supplier_1#7838, cfpk_supplier_nation#7826 AS cfpk_supplier_nation_1#7839, cval_supplier_s_name#7827 AS cval_supplier_s_name_1#7840, cval_supplier_s_address#7828 AS cval_supplier_s_address_1#7841, cval_supplier_s_phone#7829 AS cval_supplier_s_phone_1#7842, cval_supplier_s_acctbal#7830 AS cval_supplier_s_acctbal_1#7843, cval_supplier_s_comment#7831 AS cval_supplier_s_comment_1#7844, cs_name#7832 AS cs_name_1#7845, cs_address#7833 AS cs_address_1#7846, cs_phone#7834 AS cs_phone_1#7847, cs_acctbal#7835 AS cs_acctbal_1#7848, cs_comment#7836 AS cs_comment_1#7849]
            :     :     :  :     :  +- Relation[rid#7824,cpfk_nation_supplier#7825,cfpk_supplier_nation#7826,cval_supplier_s_name#7827,cval_supplier_s_address#7828,cval_supplier_s_phone#7829,cval_supplier_s_acctbal#7830,cval_supplier_s_comment#7831,cs_name#7832,cs_address#7833,cs_phone#7834,cs_acctbal#7835,cs_comment#7836] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#7850 AS rid_2#7883, cpfk_orders_lineitem#7851 AS cpfk_orders_lineitem_2#7884, cpfk_supplier_lineitem#7852 AS cpfk_supplier_lineitem_2#7885, cfpk_lineitem_supplier#7853 AS cfpk_lineitem_supplier_2#7886, cfpk_lineitem_partsupp#7854 AS cfpk_lineitem_partsupp_2#7887, cpfk_part_lineitem#7855 AS cpfk_part_lineitem_2#7888, cfpk_lineitem_part#7856 AS cfpk_lineitem_part_2#7889, cpfk_partsupp_lineitem#7857 AS cpfk_partsupp_lineitem_2#7890, cfpk_lineitem_orders#7858 AS cfpk_lineitem_orders_2#7891, cval_lineitem_l_quantity#7859 AS cval_lineitem_l_quantity_2#7892, cval_lineitem_l_extendedprice#7860 AS cval_lineitem_l_extendedprice_2#7893, cval_lineitem_l_discount#7861 AS cval_lineitem_l_discount_2#7894, cval_lineitem_l_tax#7862 AS cval_lineitem_l_tax_2#7895, cval_lineitem_l_returnflag#7863 AS cval_lineitem_l_returnflag_2#7896, cval_lineitem_l_linestatus#7864 AS cval_lineitem_l_linestatus_2#7897, cval_lineitem_l_commitdate#7865 AS cval_lineitem_l_commitdate_2#7898, cval_lineitem_l_receiptdate#7866 AS cval_lineitem_l_receiptdate_2#7899, cval_lineitem_l_shipinstruct#7867 AS cval_lineitem_l_shipinstruct_2#7900, cval_lineitem_l_shipmode#7868 AS cval_lineitem_l_shipmode_2#7901, cval_lineitem_l_comment#7869 AS cval_lineitem_l_comment_2#7902, cval_lineitem_l_shipdate#7870 AS cval_lineitem_l_shipdate_2#7903, cl_quantity#7871 AS cl_quantity_2#7904, cl_extendedprice#7872 AS cl_extendedprice_2#7905, cl_discount#7873 AS cl_discount_2#7906, ... 9 more fields]
            :     :     :  :        +- Relation[rid#7850,cpfk_orders_lineitem#7851,cpfk_supplier_lineitem#7852,cfpk_lineitem_supplier#7853,cfpk_lineitem_partsupp#7854,cpfk_part_lineitem#7855,cfpk_lineitem_part#7856,cpfk_partsupp_lineitem#7857,cfpk_lineitem_orders#7858,cval_lineitem_l_quantity#7859,cval_lineitem_l_extendedprice#7860,cval_lineitem_l_discount#7861,cval_lineitem_l_tax#7862,cval_lineitem_l_returnflag#7863,cval_lineitem_l_linestatus#7864,cval_lineitem_l_commitdate#7865,cval_lineitem_l_receiptdate#7866,cval_lineitem_l_shipinstruct#7867,cval_lineitem_l_shipmode#7868,cval_lineitem_l_comment#7869,cval_lineitem_l_shipdate#7870,cl_quantity#7871,cl_extendedprice#7872,cl_discount#7873,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#7758 AS rid_2#7791, cpfk_orders_lineitem#7759 AS cpfk_orders_lineitem_2#7792, cpfk_supplier_lineitem#7760 AS cpfk_supplier_lineitem_2#7793, cfpk_lineitem_supplier#7761 AS cfpk_lineitem_supplier_2#7794, cfpk_lineitem_partsupp#7762 AS cfpk_lineitem_partsupp_2#7795, cpfk_part_lineitem#7763 AS cpfk_part_lineitem_2#7796, cfpk_lineitem_part#7764 AS cfpk_lineitem_part_2#7797, cpfk_partsupp_lineitem#7765 AS cpfk_partsupp_lineitem_2#7798, cfpk_lineitem_orders#7766 AS cfpk_lineitem_orders_2#7799, cval_lineitem_l_quantity#7767 AS cval_lineitem_l_quantity_2#7800, cval_lineitem_l_extendedprice#7768 AS cval_lineitem_l_extendedprice_2#7801, cval_lineitem_l_discount#7769 AS cval_lineitem_l_discount_2#7802, cval_lineitem_l_tax#7770 AS cval_lineitem_l_tax_2#7803, cval_lineitem_l_returnflag#7771 AS cval_lineitem_l_returnflag_2#7804, cval_lineitem_l_linestatus#7772 AS cval_lineitem_l_linestatus_2#7805, cval_lineitem_l_commitdate#7773 AS cval_lineitem_l_commitdate_2#7806, cval_lineitem_l_receiptdate#7774 AS cval_lineitem_l_receiptdate_2#7807, cval_lineitem_l_shipinstruct#7775 AS cval_lineitem_l_shipinstruct_2#7808, cval_lineitem_l_shipmode#7776 AS cval_lineitem_l_shipmode_2#7809, cval_lineitem_l_comment#7777 AS cval_lineitem_l_comment_2#7810, cval_lineitem_l_shipdate#7778 AS cval_lineitem_l_shipdate_2#7811, cl_quantity#7779 AS cl_quantity_2#7812, cl_extendedprice#7780 AS cl_extendedprice_2#7813, cl_discount#7781 AS cl_discount_2#7814, ... 9 more fields]
            :     :     :     +- Relation[rid#7758,cpfk_orders_lineitem#7759,cpfk_supplier_lineitem#7760,cfpk_lineitem_supplier#7761,cfpk_lineitem_partsupp#7762,cpfk_part_lineitem#7763,cfpk_lineitem_part#7764,cpfk_partsupp_lineitem#7765,cfpk_lineitem_orders#7766,cval_lineitem_l_quantity#7767,cval_lineitem_l_extendedprice#7768,cval_lineitem_l_discount#7769,cval_lineitem_l_tax#7770,cval_lineitem_l_returnflag#7771,cval_lineitem_l_linestatus#7772,cval_lineitem_l_commitdate#7773,cval_lineitem_l_receiptdate#7774,cval_lineitem_l_shipinstruct#7775,cval_lineitem_l_shipmode#7776,cval_lineitem_l_comment#7777,cval_lineitem_l_shipdate#7778,cl_quantity#7779,cl_extendedprice#7780,cl_discount#7781,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#7916 AS rid_3#7933, cval_part_p_name#7917 AS cval_part_p_name_3#7934, cval_part_p_mfgr#7918 AS cval_part_p_mfgr_3#7935, cval_part_p_type#7919 AS cval_part_p_type_3#7936, cval_part_p_size#7920 AS cval_part_p_size_3#7937, cval_part_p_container#7921 AS cval_part_p_container_3#7938, cval_part_p_retailprice#7922 AS cval_part_p_retailprice_3#7939, cval_part_p_comment#7923 AS cval_part_p_comment_3#7940, cval_part_p_brand#7924 AS cval_part_p_brand_3#7941, cp_name#7925 AS cp_name_3#7942, cp_mfgr#7926 AS cp_mfgr_3#7943, cp_type#7927 AS cp_type_3#7944, cp_size#7928 AS cp_size_3#7945, cp_container#7929 AS cp_container_3#7946, cp_retailprice#7930 AS cp_retailprice_3#7947, cp_comment#7931 AS cp_comment_3#7948, cp_brand#7932 AS cp_brand_3#7949]
            :     :        +- Relation[rid#7916,cval_part_p_name#7917,cval_part_p_mfgr#7918,cval_part_p_type#7919,cval_part_p_size#7920,cval_part_p_container#7921,cval_part_p_retailprice#7922,cval_part_p_comment#7923,cval_part_p_brand#7924,cp_name#7925,cp_mfgr#7926,cp_type#7927,cp_size#7928,cp_container#7929,cp_retailprice#7930,cp_comment#7931,cp_brand#7932] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#7950 AS rid_4#7961, cpfk_part_partsupp#7951 AS cpfk_part_partsupp_4#7962, cfpk_partsupp_part#7952 AS cfpk_partsupp_part_4#7963, cpfk_supplier_partsupp#7953 AS cpfk_supplier_partsupp_4#7964, cfpk_partsupp_supplier#7954 AS cfpk_partsupp_supplier_4#7965, cval_partsupp_ps_availqty#7955 AS cval_partsupp_ps_availqty_4#7966, cval_partsupp_ps_supplycost#7956 AS cval_partsupp_ps_supplycost_4#7967, cval_partsupp_ps_comment#7957 AS cval_partsupp_ps_comment_4#7968, cps_availqty#7958 AS cps_availqty_4#7969, cps_supplycost#7959 AS cps_supplycost_4#7970, cps_comment#7960 AS cps_comment_4#7971]
            :        +- Relation[rid#7950,cpfk_part_partsupp#7951,cfpk_partsupp_part#7952,cpfk_supplier_partsupp#7953,cfpk_partsupp_supplier#7954,cval_partsupp_ps_availqty#7955,cval_partsupp_ps_supplycost#7956,cval_partsupp_ps_comment#7957,cps_availqty#7958,cps_supplycost#7959,cps_comment#7960] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#7972 AS rid_5#7989, cpfk_customer_orders#7973 AS cpfk_customer_orders_5#7990, cfpk_orders_customer#7974 AS cfpk_orders_customer_5#7991, cval_orders_o_orderstatus#7975 AS cval_orders_o_orderstatus_5#7992, cval_orders_o_totalprice#7976 AS cval_orders_o_totalprice_5#7993, cval_orders_o_orderpriority#7977 AS cval_orders_o_orderpriority_5#7994, cval_orders_o_clerk#7978 AS cval_orders_o_clerk_5#7995, cval_orders_o_shippriority#7979 AS cval_orders_o_shippriority_5#7996, cval_orders_o_comment#7980 AS cval_orders_o_comment_5#7997, cval_orders_o_orderdate#7981 AS cval_orders_o_orderdate_5#7998, co_orderstatus#7982 AS co_orderstatus_5#7999, co_totalprice#7983 AS co_totalprice_5#8000, co_orderpriority#7984 AS co_orderpriority_5#8001, co_clerk#7985 AS co_clerk_5#8002, co_shippriority#7986 AS co_shippriority_5#8003, co_comment#7987 AS co_comment_5#8004, co_orderdate#7988 AS co_orderdate_5#8005]
               +- Relation[rid#7972,cpfk_customer_orders#7973,cfpk_orders_customer#7974,cval_orders_o_orderstatus#7975,cval_orders_o_totalprice#7976,cval_orders_o_orderpriority#7977,cval_orders_o_clerk#7978,cval_orders_o_shippriority#7979,cval_orders_o_comment#7980,cval_orders_o_orderdate#7981,co_orderstatus#7982,co_totalprice#7983,co_orderpriority#7984,co_clerk#7985,co_shippriority#7986,co_comment#7987,co_orderdate#7988] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 242044ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/11 03:15:35 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:15:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8111L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 03:15:35 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:15:35 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:15:35 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:15:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8111L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#8113 AS rid_0#8130, cval_part_p_name#8114 AS cval_part_p_name_0#8131, cval_part_p_mfgr#8115 AS cval_part_p_mfgr_0#8132, cval_part_p_type#8116 AS cval_part_p_type_0#8133, cval_part_p_size#8117 AS cval_part_p_size_0#8134, cval_part_p_container#8118 AS cval_part_p_container_0#8135, cval_part_p_retailprice#8119 AS cval_part_p_retailprice_0#8136, cval_part_p_comment#8120 AS cval_part_p_comment_0#8137, cval_part_p_brand#8121 AS cval_part_p_brand_0#8138, cp_name#8122 AS cp_name_0#8139, cp_mfgr#8123 AS cp_mfgr_0#8140, cp_type#8124 AS cp_type_0#8141, cp_size#8125 AS cp_size_0#8142, cp_container#8126 AS cp_container_0#8143, cp_retailprice#8127 AS cp_retailprice_0#8144, cp_comment#8128 AS cp_comment_0#8145, cp_brand#8129 AS cp_brand_0#8146]
         :  :  :  +- Relation[rid#8113,cval_part_p_name#8114,cval_part_p_mfgr#8115,cval_part_p_type#8116,cval_part_p_size#8117,cval_part_p_container#8118,cval_part_p_retailprice#8119,cval_part_p_comment#8120,cval_part_p_brand#8121,cp_name#8122,cp_mfgr#8123,cp_type#8124,cp_size#8125,cp_container#8126,cp_retailprice#8127,cp_comment#8128,cp_brand#8129] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#8147 AS rid_0#8164, cval_part_p_name#8148 AS cval_part_p_name_0#8165, cval_part_p_mfgr#8149 AS cval_part_p_mfgr_0#8166, cval_part_p_type#8150 AS cval_part_p_type_0#8167, cval_part_p_size#8151 AS cval_part_p_size_0#8168, cval_part_p_container#8152 AS cval_part_p_container_0#8169, cval_part_p_retailprice#8153 AS cval_part_p_retailprice_0#8170, cval_part_p_comment#8154 AS cval_part_p_comment_0#8171, cval_part_p_brand#8155 AS cval_part_p_brand_0#8172, cp_name#8156 AS cp_name_0#8173, cp_mfgr#8157 AS cp_mfgr_0#8174, cp_type#8158 AS cp_type_0#8175, cp_size#8159 AS cp_size_0#8176, cp_container#8160 AS cp_container_0#8177, cp_retailprice#8161 AS cp_retailprice_0#8178, cp_comment#8162 AS cp_comment_0#8179, cp_brand#8163 AS cp_brand_0#8180]
         :  :        +- Relation[rid#8147,cval_part_p_name#8148,cval_part_p_mfgr#8149,cval_part_p_type#8150,cval_part_p_size#8151,cval_part_p_container#8152,cval_part_p_retailprice#8153,cval_part_p_comment#8154,cval_part_p_brand#8155,cp_name#8156,cp_mfgr#8157,cp_type#8158,cp_size#8159,cp_container#8160,cp_retailprice#8161,cp_comment#8162,cp_brand#8163] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :     :- Project [rid#8203 AS rid_0#8220, cval_part_p_name#8204 AS cval_part_p_name_0#8221, cval_part_p_mfgr#8205 AS cval_part_p_mfgr_0#8222, cval_part_p_type#8206 AS cval_part_p_type_0#8223, cval_part_p_size#8207 AS cval_part_p_size_0#8224, cval_part_p_container#8208 AS cval_part_p_container_0#8225, cval_part_p_retailprice#8209 AS cval_part_p_retailprice_0#8226, cval_part_p_comment#8210 AS cval_part_p_comment_0#8227, cval_part_p_brand#8211 AS cval_part_p_brand_0#8228, cp_name#8212 AS cp_name_0#8229, cp_mfgr#8213 AS cp_mfgr_0#8230, cp_type#8214 AS cp_type_0#8231, cp_size#8215 AS cp_size_0#8232, cp_container#8216 AS cp_container_0#8233, cp_retailprice#8217 AS cp_retailprice_0#8234, cp_comment#8218 AS cp_comment_0#8235, cp_brand#8219 AS cp_brand_0#8236]
         :     :  +- Relation[rid#8203,cval_part_p_name#8204,cval_part_p_mfgr#8205,cval_part_p_type#8206,cval_part_p_size#8207,cval_part_p_container#8208,cval_part_p_retailprice#8209,cval_part_p_comment#8210,cval_part_p_brand#8211,cp_name#8212,cp_mfgr#8213,cp_type#8214,cp_size#8215,cp_container#8216,cp_retailprice#8217,cp_comment#8218,cp_brand#8219] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#8237 AS rid_1#8248, cpfk_part_partsupp#8238 AS cpfk_part_partsupp_1#8249, cfpk_partsupp_part#8239 AS cfpk_partsupp_part_1#8250, cpfk_supplier_partsupp#8240 AS cpfk_supplier_partsupp_1#8251, cfpk_partsupp_supplier#8241 AS cfpk_partsupp_supplier_1#8252, cval_partsupp_ps_availqty#8242 AS cval_partsupp_ps_availqty_1#8253, cval_partsupp_ps_supplycost#8243 AS cval_partsupp_ps_supplycost_1#8254, cval_partsupp_ps_comment#8244 AS cval_partsupp_ps_comment_1#8255, cps_availqty#8245 AS cps_availqty_1#8256, cps_supplycost#8246 AS cps_supplycost_1#8257, cps_comment#8247 AS cps_comment_1#8258]
         :        +- Relation[rid#8237,cpfk_part_partsupp#8238,cfpk_partsupp_part#8239,cpfk_supplier_partsupp#8240,cfpk_partsupp_supplier#8241,cval_partsupp_ps_availqty#8242,cval_partsupp_ps_supplycost#8243,cval_partsupp_ps_comment#8244,cps_availqty#8245,cps_supplycost#8246,cps_comment#8247] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#8181 AS rid_1#8192, cpfk_part_partsupp#8182 AS cpfk_part_partsupp_1#8193, cfpk_partsupp_part#8183 AS cfpk_partsupp_part_1#8194, cpfk_supplier_partsupp#8184 AS cpfk_supplier_partsupp_1#8195, cfpk_partsupp_supplier#8185 AS cfpk_partsupp_supplier_1#8196, cval_partsupp_ps_availqty#8186 AS cval_partsupp_ps_availqty_1#8197, cval_partsupp_ps_supplycost#8187 AS cval_partsupp_ps_supplycost_1#8198, cval_partsupp_ps_comment#8188 AS cval_partsupp_ps_comment_1#8199, cps_availqty#8189 AS cps_availqty_1#8200, cps_supplycost#8190 AS cps_supplycost_1#8201, cps_comment#8191 AS cps_comment_1#8202]
            +- Relation[rid#8181,cpfk_part_partsupp#8182,cfpk_partsupp_part#8183,cpfk_supplier_partsupp#8184,cfpk_partsupp_supplier#8185,cval_partsupp_ps_availqty#8186,cval_partsupp_ps_supplycost#8187,cval_partsupp_ps_comment#8188,cps_availqty#8189,cps_supplycost#8190,cps_comment#8191] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 10966ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/11 03:15:46 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:15:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8291L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:15:46 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:15:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8291L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#8293 AS rid_0#8298, cval_region_r_name#8294 AS cval_region_r_name_0#8299, cval_region_r_comment#8295 AS cval_region_r_comment_0#8300, cr_name#8296 AS cr_name_0#8301, cr_comment#8297 AS cr_comment_0#8302]
         :  :  :  :  :  :  :  +- Relation[rid#8293,cval_region_r_name#8294,cval_region_r_comment#8295,cr_name#8296,cr_comment#8297] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#8303 AS rid_0#8308, cval_region_r_name#8304 AS cval_region_r_name_0#8309, cval_region_r_comment#8305 AS cval_region_r_comment_0#8310, cr_name#8306 AS cr_name_0#8311, cr_comment#8307 AS cr_comment_0#8312]
         :  :  :  :  :  :        +- Relation[rid#8303,cval_region_r_name#8304,cval_region_r_comment#8305,cr_name#8306,cr_comment#8307] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :     :- Project [rid#8327 AS rid_0#8332, cval_region_r_name#8328 AS cval_region_r_name_0#8333, cval_region_r_comment#8329 AS cval_region_r_comment_0#8334, cr_name#8330 AS cr_name_0#8335, cr_comment#8331 AS cr_comment_0#8336]
         :  :  :  :  :     :  +- Relation[rid#8327,cval_region_r_name#8328,cval_region_r_comment#8329,cr_name#8330,cr_comment#8331] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :     +- Project [rid#8337 AS rid_1#8344, cpfk_region_nation#8338 AS cpfk_region_nation_1#8345, cfpk_nation_region#8339 AS cfpk_nation_region_1#8346, cval_nation_n_name#8340 AS cval_nation_n_name_1#8347, cval_nation_n_comment#8341 AS cval_nation_n_comment_1#8348, cn_name#8342 AS cn_name_1#8349, cn_comment#8343 AS cn_comment_1#8350]
         :  :  :  :  :        +- Relation[rid#8337,cpfk_region_nation#8338,cfpk_nation_region#8339,cval_nation_n_name#8340,cval_nation_n_comment#8341,cn_name#8342,cn_comment#8343] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#8313 AS rid_1#8320, cpfk_region_nation#8314 AS cpfk_region_nation_1#8321, cfpk_nation_region#8315 AS cfpk_nation_region_1#8322, cval_nation_n_name#8316 AS cval_nation_n_name_1#8323, cval_nation_n_comment#8317 AS cval_nation_n_comment_1#8324, cn_name#8318 AS cn_name_1#8325, cn_comment#8319 AS cn_comment_1#8326]
         :  :  :  :     +- Relation[rid#8313,cpfk_region_nation#8314,cfpk_nation_region#8315,cval_nation_n_name#8316,cval_nation_n_comment#8317,cn_name#8318,cn_comment#8319] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :     :- Project [rid#8377 AS rid_1#8384, cpfk_region_nation#8378 AS cpfk_region_nation_1#8385, cfpk_nation_region#8379 AS cfpk_nation_region_1#8386, cval_nation_n_name#8380 AS cval_nation_n_name_1#8387, cval_nation_n_comment#8381 AS cval_nation_n_comment_1#8388, cn_name#8382 AS cn_name_1#8389, cn_comment#8383 AS cn_comment_1#8390]
         :  :  :     :  +- Relation[rid#8377,cpfk_region_nation#8378,cfpk_nation_region#8379,cval_nation_n_name#8380,cval_nation_n_comment#8381,cn_name#8382,cn_comment#8383] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#8391 AS rid_2#8404, cpfk_nation_supplier#8392 AS cpfk_nation_supplier_2#8405, cfpk_supplier_nation#8393 AS cfpk_supplier_nation_2#8406, cval_supplier_s_name#8394 AS cval_supplier_s_name_2#8407, cval_supplier_s_address#8395 AS cval_supplier_s_address_2#8408, cval_supplier_s_phone#8396 AS cval_supplier_s_phone_2#8409, cval_supplier_s_acctbal#8397 AS cval_supplier_s_acctbal_2#8410, cval_supplier_s_comment#8398 AS cval_supplier_s_comment_2#8411, cs_name#8399 AS cs_name_2#8412, cs_address#8400 AS cs_address_2#8413, cs_phone#8401 AS cs_phone_2#8414, cs_acctbal#8402 AS cs_acctbal_2#8415, cs_comment#8403 AS cs_comment_2#8416]
         :  :  :        +- Relation[rid#8391,cpfk_nation_supplier#8392,cfpk_supplier_nation#8393,cval_supplier_s_name#8394,cval_supplier_s_address#8395,cval_supplier_s_phone#8396,cval_supplier_s_acctbal#8397,cval_supplier_s_comment#8398,cs_name#8399,cs_address#8400,cs_phone#8401,cs_acctbal#8402,cs_comment#8403] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#8351 AS rid_2#8364, cpfk_nation_supplier#8352 AS cpfk_nation_supplier_2#8365, cfpk_supplier_nation#8353 AS cfpk_supplier_nation_2#8366, cval_supplier_s_name#8354 AS cval_supplier_s_name_2#8367, cval_supplier_s_address#8355 AS cval_supplier_s_address_2#8368, cval_supplier_s_phone#8356 AS cval_supplier_s_phone_2#8369, cval_supplier_s_acctbal#8357 AS cval_supplier_s_acctbal_2#8370, cval_supplier_s_comment#8358 AS cval_supplier_s_comment_2#8371, cs_name#8359 AS cs_name_2#8372, cs_address#8360 AS cs_address_2#8373, cs_phone#8361 AS cs_phone_2#8374, cs_acctbal#8362 AS cs_acctbal_2#8375, cs_comment#8363 AS cs_comment_2#8376]
         :  :     +- Relation[rid#8351,cpfk_nation_supplier#8352,cfpk_supplier_nation#8353,cval_supplier_s_name#8354,cval_supplier_s_address#8355,cval_supplier_s_phone#8356,cval_supplier_s_acctbal#8357,cval_supplier_s_comment#8358,cs_name#8359,cs_address#8360,cs_phone#8361,cs_acctbal#8362,cs_comment#8363] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :     :- Project [rid#8563 AS rid_2#8576, cpfk_nation_supplier#8564 AS cpfk_nation_supplier_2#8577, cfpk_supplier_nation#8565 AS cfpk_supplier_nation_2#8578, cval_supplier_s_name#8566 AS cval_supplier_s_name_2#8579, cval_supplier_s_address#8567 AS cval_supplier_s_address_2#8580, cval_supplier_s_phone#8568 AS cval_supplier_s_phone_2#8581, cval_supplier_s_acctbal#8569 AS cval_supplier_s_acctbal_2#8582, cval_supplier_s_comment#8570 AS cval_supplier_s_comment_2#8583, cs_name#8571 AS cs_name_2#8584, cs_address#8572 AS cs_address_2#8585, cs_phone#8573 AS cs_phone_2#8586, cs_acctbal#8574 AS cs_acctbal_2#8587, cs_comment#8575 AS cs_comment_2#8588]
         :     :  +- Relation[rid#8563,cpfk_nation_supplier#8564,cfpk_supplier_nation#8565,cval_supplier_s_name#8566,cval_supplier_s_address#8567,cval_supplier_s_phone#8568,cval_supplier_s_acctbal#8569,cval_supplier_s_comment#8570,cs_name#8571,cs_address#8572,cs_phone#8573,cs_acctbal#8574,cs_comment#8575] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#8589 AS rid_4#8600, cpfk_part_partsupp#8590 AS cpfk_part_partsupp_4#8601, cfpk_partsupp_part#8591 AS cfpk_partsupp_part_4#8602, cpfk_supplier_partsupp#8592 AS cpfk_supplier_partsupp_4#8603, cfpk_partsupp_supplier#8593 AS cfpk_partsupp_supplier_4#8604, cval_partsupp_ps_availqty#8594 AS cval_partsupp_ps_availqty_4#8605, cval_partsupp_ps_supplycost#8595 AS cval_partsupp_ps_supplycost_4#8606, cval_partsupp_ps_comment#8596 AS cval_partsupp_ps_comment_4#8607, cps_availqty#8597 AS cps_availqty_4#8608, cps_supplycost#8598 AS cps_supplycost_4#8609, cps_comment#8599 AS cps_comment_4#8610]
         :        +- Relation[rid#8589,cpfk_part_partsupp#8590,cfpk_partsupp_part#8591,cpfk_supplier_partsupp#8592,cfpk_partsupp_supplier#8593,cval_partsupp_ps_availqty#8594,cval_partsupp_ps_supplycost#8595,cval_partsupp_ps_comment#8596,cps_availqty#8597,cps_supplycost#8598,cps_comment#8599] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'Join UsingJoin(Inner,List(rid_3))
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#8417 AS rid_3#8434, cval_part_p_name#8418 AS cval_part_p_name_3#8435, cval_part_p_mfgr#8419 AS cval_part_p_mfgr_3#8436, cval_part_p_type#8420 AS cval_part_p_type_3#8437, cval_part_p_size#8421 AS cval_part_p_size_3#8438, cval_part_p_container#8422 AS cval_part_p_container_3#8439, cval_part_p_retailprice#8423 AS cval_part_p_retailprice_3#8440, cval_part_p_comment#8424 AS cval_part_p_comment_3#8441, cval_part_p_brand#8425 AS cval_part_p_brand_3#8442, cp_name#8426 AS cp_name_3#8443, cp_mfgr#8427 AS cp_mfgr_3#8444, cp_type#8428 AS cp_type_3#8445, cp_size#8429 AS cp_size_3#8446, cp_container#8430 AS cp_container_3#8447, cp_retailprice#8431 AS cp_retailprice_3#8448, cp_comment#8432 AS cp_comment_3#8449, cp_brand#8433 AS cp_brand_3#8450]
            :  :  :  +- Relation[rid#8417,cval_part_p_name#8418,cval_part_p_mfgr#8419,cval_part_p_type#8420,cval_part_p_size#8421,cval_part_p_container#8422,cval_part_p_retailprice#8423,cval_part_p_comment#8424,cval_part_p_brand#8425,cp_name#8426,cp_mfgr#8427,cp_type#8428,cp_size#8429,cp_container#8430,cp_retailprice#8431,cp_comment#8432,cp_brand#8433] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#8451 AS rid_3#8468, cval_part_p_name#8452 AS cval_part_p_name_3#8469, cval_part_p_mfgr#8453 AS cval_part_p_mfgr_3#8470, cval_part_p_type#8454 AS cval_part_p_type_3#8471, cval_part_p_size#8455 AS cval_part_p_size_3#8472, cval_part_p_container#8456 AS cval_part_p_container_3#8473, cval_part_p_retailprice#8457 AS cval_part_p_retailprice_3#8474, cval_part_p_comment#8458 AS cval_part_p_comment_3#8475, cval_part_p_brand#8459 AS cval_part_p_brand_3#8476, cp_name#8460 AS cp_name_3#8477, cp_mfgr#8461 AS cp_mfgr_3#8478, cp_type#8462 AS cp_type_3#8479, cp_size#8463 AS cp_size_3#8480, cp_container#8464 AS cp_container_3#8481, cp_retailprice#8465 AS cp_retailprice_3#8482, cp_comment#8466 AS cp_comment_3#8483, cp_brand#8467 AS cp_brand_3#8484]
            :  :        +- Relation[rid#8451,cval_part_p_name#8452,cval_part_p_mfgr#8453,cval_part_p_type#8454,cval_part_p_size#8455,cval_part_p_container#8456,cval_part_p_retailprice#8457,cval_part_p_comment#8458,cval_part_p_brand#8459,cp_name#8460,cp_mfgr#8461,cp_type#8462,cp_size#8463,cp_container#8464,cp_retailprice#8465,cp_comment#8466,cp_brand#8467] JDBCRelation(tpart) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :     :- Project [rid#8507 AS rid_3#8524, cval_part_p_name#8508 AS cval_part_p_name_3#8525, cval_part_p_mfgr#8509 AS cval_part_p_mfgr_3#8526, cval_part_p_type#8510 AS cval_part_p_type_3#8527, cval_part_p_size#8511 AS cval_part_p_size_3#8528, cval_part_p_container#8512 AS cval_part_p_container_3#8529, cval_part_p_retailprice#8513 AS cval_part_p_retailprice_3#8530, cval_part_p_comment#8514 AS cval_part_p_comment_3#8531, cval_part_p_brand#8515 AS cval_part_p_brand_3#8532, cp_name#8516 AS cp_name_3#8533, cp_mfgr#8517 AS cp_mfgr_3#8534, cp_type#8518 AS cp_type_3#8535, cp_size#8519 AS cp_size_3#8536, cp_container#8520 AS cp_container_3#8537, cp_retailprice#8521 AS cp_retailprice_3#8538, cp_comment#8522 AS cp_comment_3#8539, cp_brand#8523 AS cp_brand_3#8540]
            :     :  +- Relation[rid#8507,cval_part_p_name#8508,cval_part_p_mfgr#8509,cval_part_p_type#8510,cval_part_p_size#8511,cval_part_p_container#8512,cval_part_p_retailprice#8513,cval_part_p_comment#8514,cval_part_p_brand#8515,cp_name#8516,cp_mfgr#8517,cp_type#8518,cp_size#8519,cp_container#8520,cp_retailprice#8521,cp_comment#8522,cp_brand#8523] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#8541 AS rid_4#8552, cpfk_part_partsupp#8542 AS cpfk_part_partsupp_4#8553, cfpk_partsupp_part#8543 AS cfpk_partsupp_part_4#8554, cpfk_supplier_partsupp#8544 AS cpfk_supplier_partsupp_4#8555, cfpk_partsupp_supplier#8545 AS cfpk_partsupp_supplier_4#8556, cval_partsupp_ps_availqty#8546 AS cval_partsupp_ps_availqty_4#8557, cval_partsupp_ps_supplycost#8547 AS cval_partsupp_ps_supplycost_4#8558, cval_partsupp_ps_comment#8548 AS cval_partsupp_ps_comment_4#8559, cps_availqty#8549 AS cps_availqty_4#8560, cps_supplycost#8550 AS cps_supplycost_4#8561, cps_comment#8551 AS cps_comment_4#8562]
            :        +- Relation[rid#8541,cpfk_part_partsupp#8542,cfpk_partsupp_part#8543,cpfk_supplier_partsupp#8544,cfpk_partsupp_supplier#8545,cval_partsupp_ps_availqty#8546,cval_partsupp_ps_supplycost#8547,cval_partsupp_ps_comment#8548,cps_availqty#8549,cps_supplycost#8550,cps_comment#8551] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#8485 AS rid_4#8496, cpfk_part_partsupp#8486 AS cpfk_part_partsupp_4#8497, cfpk_partsupp_part#8487 AS cfpk_partsupp_part_4#8498, cpfk_supplier_partsupp#8488 AS cpfk_supplier_partsupp_4#8499, cfpk_partsupp_supplier#8489 AS cfpk_partsupp_supplier_4#8500, cval_partsupp_ps_availqty#8490 AS cval_partsupp_ps_availqty_4#8501, cval_partsupp_ps_supplycost#8491 AS cval_partsupp_ps_supplycost_4#8502, cval_partsupp_ps_comment#8492 AS cval_partsupp_ps_comment_4#8503, cps_availqty#8493 AS cps_availqty_4#8504, cps_supplycost#8494 AS cps_supplycost_4#8505, cps_comment#8495 AS cps_comment_4#8506]
               +- Relation[rid#8485,cpfk_part_partsupp#8486,cfpk_partsupp_part#8487,cpfk_supplier_partsupp#8488,cfpk_partsupp_supplier#8489,cval_partsupp_ps_availqty#8490,cval_partsupp_ps_supplycost#8491,cval_partsupp_ps_comment#8492,cps_availqty#8493,cps_supplycost#8494,cps_comment#8495] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 20232ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/11 03:16:06 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:16:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8669L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 03:16:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:16:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:16:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:16:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:16:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:16:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:16:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:16:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:16:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:16:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:16:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:16:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:16:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:16:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8669L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#8671 AS rid_0#8688, cval_part_p_name#8672 AS cval_part_p_name_0#8689, cval_part_p_mfgr#8673 AS cval_part_p_mfgr_0#8690, cval_part_p_type#8674 AS cval_part_p_type_0#8691, cval_part_p_size#8675 AS cval_part_p_size_0#8692, cval_part_p_container#8676 AS cval_part_p_container_0#8693, cval_part_p_retailprice#8677 AS cval_part_p_retailprice_0#8694, cval_part_p_comment#8678 AS cval_part_p_comment_0#8695, cval_part_p_brand#8679 AS cval_part_p_brand_0#8696, cp_name#8680 AS cp_name_0#8697, cp_mfgr#8681 AS cp_mfgr_0#8698, cp_type#8682 AS cp_type_0#8699, cp_size#8683 AS cp_size_0#8700, cp_container#8684 AS cp_container_0#8701, cp_retailprice#8685 AS cp_retailprice_0#8702, cp_comment#8686 AS cp_comment_0#8703, cp_brand#8687 AS cp_brand_0#8704]
            :  :  :  :  +- Relation[rid#8671,cval_part_p_name#8672,cval_part_p_mfgr#8673,cval_part_p_type#8674,cval_part_p_size#8675,cval_part_p_container#8676,cval_part_p_retailprice#8677,cval_part_p_comment#8678,cval_part_p_brand#8679,cp_name#8680,cp_mfgr#8681,cp_type#8682,cp_size#8683,cp_container#8684,cp_retailprice#8685,cp_comment#8686,cp_brand#8687] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#8705 AS rid_0#8722, cval_part_p_name#8706 AS cval_part_p_name_0#8723, cval_part_p_mfgr#8707 AS cval_part_p_mfgr_0#8724, cval_part_p_type#8708 AS cval_part_p_type_0#8725, cval_part_p_size#8709 AS cval_part_p_size_0#8726, cval_part_p_container#8710 AS cval_part_p_container_0#8727, cval_part_p_retailprice#8711 AS cval_part_p_retailprice_0#8728, cval_part_p_comment#8712 AS cval_part_p_comment_0#8729, cval_part_p_brand#8713 AS cval_part_p_brand_0#8730, cp_name#8714 AS cp_name_0#8731, cp_mfgr#8715 AS cp_mfgr_0#8732, cp_type#8716 AS cp_type_0#8733, cp_size#8717 AS cp_size_0#8734, cp_container#8718 AS cp_container_0#8735, cp_retailprice#8719 AS cp_retailprice_0#8736, cp_comment#8720 AS cp_comment_0#8737, cp_brand#8721 AS cp_brand_0#8738]
            :  :  :        +- Relation[rid#8705,cval_part_p_name#8706,cval_part_p_mfgr#8707,cval_part_p_type#8708,cval_part_p_size#8709,cval_part_p_container#8710,cval_part_p_retailprice#8711,cval_part_p_comment#8712,cval_part_p_brand#8713,cp_name#8714,cp_mfgr#8715,cp_type#8716,cp_size#8717,cp_container#8718,cp_retailprice#8719,cp_comment#8720,cp_brand#8721] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :     :- Project [rid#8761 AS rid_0#8778, cval_part_p_name#8762 AS cval_part_p_name_0#8779, cval_part_p_mfgr#8763 AS cval_part_p_mfgr_0#8780, cval_part_p_type#8764 AS cval_part_p_type_0#8781, cval_part_p_size#8765 AS cval_part_p_size_0#8782, cval_part_p_container#8766 AS cval_part_p_container_0#8783, cval_part_p_retailprice#8767 AS cval_part_p_retailprice_0#8784, cval_part_p_comment#8768 AS cval_part_p_comment_0#8785, cval_part_p_brand#8769 AS cval_part_p_brand_0#8786, cp_name#8770 AS cp_name_0#8787, cp_mfgr#8771 AS cp_mfgr_0#8788, cp_type#8772 AS cp_type_0#8789, cp_size#8773 AS cp_size_0#8790, cp_container#8774 AS cp_container_0#8791, cp_retailprice#8775 AS cp_retailprice_0#8792, cp_comment#8776 AS cp_comment_0#8793, cp_brand#8777 AS cp_brand_0#8794]
            :  :     :  +- Relation[rid#8761,cval_part_p_name#8762,cval_part_p_mfgr#8763,cval_part_p_type#8764,cval_part_p_size#8765,cval_part_p_container#8766,cval_part_p_retailprice#8767,cval_part_p_comment#8768,cval_part_p_brand#8769,cp_name#8770,cp_mfgr#8771,cp_type#8772,cp_size#8773,cp_container#8774,cp_retailprice#8775,cp_comment#8776,cp_brand#8777] JDBCRelation(tpart) [numPartitions=1]
            :  :     +- Project [rid#8795 AS rid_1#8806, cpfk_part_partsupp#8796 AS cpfk_part_partsupp_1#8807, cfpk_partsupp_part#8797 AS cfpk_partsupp_part_1#8808, cpfk_supplier_partsupp#8798 AS cpfk_supplier_partsupp_1#8809, cfpk_partsupp_supplier#8799 AS cfpk_partsupp_supplier_1#8810, cval_partsupp_ps_availqty#8800 AS cval_partsupp_ps_availqty_1#8811, cval_partsupp_ps_supplycost#8801 AS cval_partsupp_ps_supplycost_1#8812, cval_partsupp_ps_comment#8802 AS cval_partsupp_ps_comment_1#8813, cps_availqty#8803 AS cps_availqty_1#8814, cps_supplycost#8804 AS cps_supplycost_1#8815, cps_comment#8805 AS cps_comment_1#8816]
            :  :        +- Relation[rid#8795,cpfk_part_partsupp#8796,cfpk_partsupp_part#8797,cpfk_supplier_partsupp#8798,cfpk_partsupp_supplier#8799,cval_partsupp_ps_availqty#8800,cval_partsupp_ps_supplycost#8801,cval_partsupp_ps_comment#8802,cps_availqty#8803,cps_supplycost#8804,cps_comment#8805] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#8739 AS rid_1#8750, cpfk_part_partsupp#8740 AS cpfk_part_partsupp_1#8751, cfpk_partsupp_part#8741 AS cfpk_partsupp_part_1#8752, cpfk_supplier_partsupp#8742 AS cpfk_supplier_partsupp_1#8753, cfpk_partsupp_supplier#8743 AS cfpk_partsupp_supplier_1#8754, cval_partsupp_ps_availqty#8744 AS cval_partsupp_ps_availqty_1#8755, cval_partsupp_ps_supplycost#8745 AS cval_partsupp_ps_supplycost_1#8756, cval_partsupp_ps_comment#8746 AS cval_partsupp_ps_comment_1#8757, cps_availqty#8747 AS cps_availqty_1#8758, cps_supplycost#8748 AS cps_supplycost_1#8759, cps_comment#8749 AS cps_comment_1#8760]
            :     +- Relation[rid#8739,cpfk_part_partsupp#8740,cfpk_partsupp_part#8741,cpfk_supplier_partsupp#8742,cfpk_partsupp_supplier#8743,cval_partsupp_ps_availqty#8744,cval_partsupp_ps_supplycost#8745,cval_partsupp_ps_comment#8746,cps_availqty#8747,cps_supplycost#8748,cps_comment#8749] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#8817 AS rid_2#8824, cpfk_region_nation#8818 AS cpfk_region_nation_2#8825, cfpk_nation_region#8819 AS cfpk_nation_region_2#8826, cval_nation_n_name#8820 AS cval_nation_n_name_2#8827, cval_nation_n_comment#8821 AS cval_nation_n_comment_2#8828, cn_name#8822 AS cn_name_2#8829, cn_comment#8823 AS cn_comment_2#8830]
               :  :  :  +- Relation[rid#8817,cpfk_region_nation#8818,cfpk_nation_region#8819,cval_nation_n_name#8820,cval_nation_n_comment#8821,cn_name#8822,cn_comment#8823] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#8831 AS rid_2#8838, cpfk_region_nation#8832 AS cpfk_region_nation_2#8839, cfpk_nation_region#8833 AS cfpk_nation_region_2#8840, cval_nation_n_name#8834 AS cval_nation_n_name_2#8841, cval_nation_n_comment#8835 AS cval_nation_n_comment_2#8842, cn_name#8836 AS cn_name_2#8843, cn_comment#8837 AS cn_comment_2#8844]
               :  :        +- Relation[rid#8831,cpfk_region_nation#8832,cfpk_nation_region#8833,cval_nation_n_name#8834,cval_nation_n_comment#8835,cn_name#8836,cn_comment#8837] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :     :- Project [rid#8871 AS rid_2#8878, cpfk_region_nation#8872 AS cpfk_region_nation_2#8879, cfpk_nation_region#8873 AS cfpk_nation_region_2#8880, cval_nation_n_name#8874 AS cval_nation_n_name_2#8881, cval_nation_n_comment#8875 AS cval_nation_n_comment_2#8882, cn_name#8876 AS cn_name_2#8883, cn_comment#8877 AS cn_comment_2#8884]
               :     :  +- Relation[rid#8871,cpfk_region_nation#8872,cfpk_nation_region#8873,cval_nation_n_name#8874,cval_nation_n_comment#8875,cn_name#8876,cn_comment#8877] JDBCRelation(tnation) [numPartitions=1]
               :     +- Project [rid#8885 AS rid_3#8898, cpfk_nation_supplier#8886 AS cpfk_nation_supplier_3#8899, cfpk_supplier_nation#8887 AS cfpk_supplier_nation_3#8900, cval_supplier_s_name#8888 AS cval_supplier_s_name_3#8901, cval_supplier_s_address#8889 AS cval_supplier_s_address_3#8902, cval_supplier_s_phone#8890 AS cval_supplier_s_phone_3#8903, cval_supplier_s_acctbal#8891 AS cval_supplier_s_acctbal_3#8904, cval_supplier_s_comment#8892 AS cval_supplier_s_comment_3#8905, cs_name#8893 AS cs_name_3#8906, cs_address#8894 AS cs_address_3#8907, cs_phone#8895 AS cs_phone_3#8908, cs_acctbal#8896 AS cs_acctbal_3#8909, cs_comment#8897 AS cs_comment_3#8910]
               :        +- Relation[rid#8885,cpfk_nation_supplier#8886,cfpk_supplier_nation#8887,cval_supplier_s_name#8888,cval_supplier_s_address#8889,cval_supplier_s_phone#8890,cval_supplier_s_acctbal#8891,cval_supplier_s_comment#8892,cs_name#8893,cs_address#8894,cs_phone#8895,cs_acctbal#8896,cs_comment#8897] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#8845 AS rid_3#8858, cpfk_nation_supplier#8846 AS cpfk_nation_supplier_3#8859, cfpk_supplier_nation#8847 AS cfpk_supplier_nation_3#8860, cval_supplier_s_name#8848 AS cval_supplier_s_name_3#8861, cval_supplier_s_address#8849 AS cval_supplier_s_address_3#8862, cval_supplier_s_phone#8850 AS cval_supplier_s_phone_3#8863, cval_supplier_s_acctbal#8851 AS cval_supplier_s_acctbal_3#8864, cval_supplier_s_comment#8852 AS cval_supplier_s_comment_3#8865, cs_name#8853 AS cs_name_3#8866, cs_address#8854 AS cs_address_3#8867, cs_phone#8855 AS cs_phone_3#8868, cs_acctbal#8856 AS cs_acctbal_3#8869, cs_comment#8857 AS cs_comment_3#8870]
                  +- Relation[rid#8845,cpfk_nation_supplier#8846,cfpk_supplier_nation#8847,cval_supplier_s_name#8848,cval_supplier_s_address#8849,cval_supplier_s_phone#8850,cval_supplier_s_acctbal#8851,cval_supplier_s_comment#8852,cs_name#8853,cs_address#8854,cs_phone#8855,cs_acctbal#8856,cs_comment#8857] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 11024ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/11 03:16:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:16:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8964L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 03:16:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:16:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:16:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:16:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:16:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:16:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:16:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:16:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8964L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#8966 AS rid_0#8983, cval_part_p_name#8967 AS cval_part_p_name_0#8984, cval_part_p_mfgr#8968 AS cval_part_p_mfgr_0#8985, cval_part_p_type#8969 AS cval_part_p_type_0#8986, cval_part_p_size#8970 AS cval_part_p_size_0#8987, cval_part_p_container#8971 AS cval_part_p_container_0#8988, cval_part_p_retailprice#8972 AS cval_part_p_retailprice_0#8989, cval_part_p_comment#8973 AS cval_part_p_comment_0#8990, cval_part_p_brand#8974 AS cval_part_p_brand_0#8991, cp_name#8975 AS cp_name_0#8992, cp_mfgr#8976 AS cp_mfgr_0#8993, cp_type#8977 AS cp_type_0#8994, cp_size#8978 AS cp_size_0#8995, cp_container#8979 AS cp_container_0#8996, cp_retailprice#8980 AS cp_retailprice_0#8997, cp_comment#8981 AS cp_comment_0#8998, cp_brand#8982 AS cp_brand_0#8999]
         :  :  :  :  +- Relation[rid#8966,cval_part_p_name#8967,cval_part_p_mfgr#8968,cval_part_p_type#8969,cval_part_p_size#8970,cval_part_p_container#8971,cval_part_p_retailprice#8972,cval_part_p_comment#8973,cval_part_p_brand#8974,cp_name#8975,cp_mfgr#8976,cp_type#8977,cp_size#8978,cp_container#8979,cp_retailprice#8980,cp_comment#8981,cp_brand#8982] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#9000 AS rid_0#9017, cval_part_p_name#9001 AS cval_part_p_name_0#9018, cval_part_p_mfgr#9002 AS cval_part_p_mfgr_0#9019, cval_part_p_type#9003 AS cval_part_p_type_0#9020, cval_part_p_size#9004 AS cval_part_p_size_0#9021, cval_part_p_container#9005 AS cval_part_p_container_0#9022, cval_part_p_retailprice#9006 AS cval_part_p_retailprice_0#9023, cval_part_p_comment#9007 AS cval_part_p_comment_0#9024, cval_part_p_brand#9008 AS cval_part_p_brand_0#9025, cp_name#9009 AS cp_name_0#9026, cp_mfgr#9010 AS cp_mfgr_0#9027, cp_type#9011 AS cp_type_0#9028, cp_size#9012 AS cp_size_0#9029, cp_container#9013 AS cp_container_0#9030, cp_retailprice#9014 AS cp_retailprice_0#9031, cp_comment#9015 AS cp_comment_0#9032, cp_brand#9016 AS cp_brand_0#9033]
         :  :  :        +- Relation[rid#9000,cval_part_p_name#9001,cval_part_p_mfgr#9002,cval_part_p_type#9003,cval_part_p_size#9004,cval_part_p_container#9005,cval_part_p_retailprice#9006,cval_part_p_comment#9007,cval_part_p_brand#9008,cp_name#9009,cp_mfgr#9010,cp_type#9011,cp_size#9012,cp_container#9013,cp_retailprice#9014,cp_comment#9015,cp_brand#9016] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#9034 AS rid_0#9051, cval_part_p_name#9035 AS cval_part_p_name_0#9052, cval_part_p_mfgr#9036 AS cval_part_p_mfgr_0#9053, cval_part_p_type#9037 AS cval_part_p_type_0#9054, cval_part_p_size#9038 AS cval_part_p_size_0#9055, cval_part_p_container#9039 AS cval_part_p_container_0#9056, cval_part_p_retailprice#9040 AS cval_part_p_retailprice_0#9057, cval_part_p_comment#9041 AS cval_part_p_comment_0#9058, cval_part_p_brand#9042 AS cval_part_p_brand_0#9059, cp_name#9043 AS cp_name_0#9060, cp_mfgr#9044 AS cp_mfgr_0#9061, cp_type#9045 AS cp_type_0#9062, cp_size#9046 AS cp_size_0#9063, cp_container#9047 AS cp_container_0#9064, cp_retailprice#9048 AS cp_retailprice_0#9065, cp_comment#9049 AS cp_comment_0#9066, cp_brand#9050 AS cp_brand_0#9067]
         :  :        +- Relation[rid#9034,cval_part_p_name#9035,cval_part_p_mfgr#9036,cval_part_p_type#9037,cval_part_p_size#9038,cval_part_p_container#9039,cval_part_p_retailprice#9040,cval_part_p_comment#9041,cval_part_p_brand#9042,cp_name#9043,cp_mfgr#9044,cp_type#9045,cp_size#9046,cp_container#9047,cp_retailprice#9048,cp_comment#9049,cp_brand#9050] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#9266 AS rid_0#9283, cval_part_p_name#9267 AS cval_part_p_name_0#9284, cval_part_p_mfgr#9268 AS cval_part_p_mfgr_0#9285, cval_part_p_type#9269 AS cval_part_p_type_0#9286, cval_part_p_size#9270 AS cval_part_p_size_0#9287, cval_part_p_container#9271 AS cval_part_p_container_0#9288, cval_part_p_retailprice#9272 AS cval_part_p_retailprice_0#9289, cval_part_p_comment#9273 AS cval_part_p_comment_0#9290, cval_part_p_brand#9274 AS cval_part_p_brand_0#9291, cp_name#9275 AS cp_name_0#9292, cp_mfgr#9276 AS cp_mfgr_0#9293, cp_type#9277 AS cp_type_0#9294, cp_size#9278 AS cp_size_0#9295, cp_container#9279 AS cp_container_0#9296, cp_retailprice#9280 AS cp_retailprice_0#9297, cp_comment#9281 AS cp_comment_0#9298, cp_brand#9282 AS cp_brand_0#9299]
         :     :  +- Relation[rid#9266,cval_part_p_name#9267,cval_part_p_mfgr#9268,cval_part_p_type#9269,cval_part_p_size#9270,cval_part_p_container#9271,cval_part_p_retailprice#9272,cval_part_p_comment#9273,cval_part_p_brand#9274,cp_name#9275,cp_mfgr#9276,cp_type#9277,cp_size#9278,cp_container#9279,cp_retailprice#9280,cp_comment#9281,cp_brand#9282] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#9300 AS rid_1#9333, cpfk_orders_lineitem#9301 AS cpfk_orders_lineitem_1#9334, cpfk_supplier_lineitem#9302 AS cpfk_supplier_lineitem_1#9335, cfpk_lineitem_supplier#9303 AS cfpk_lineitem_supplier_1#9336, cfpk_lineitem_partsupp#9304 AS cfpk_lineitem_partsupp_1#9337, cpfk_part_lineitem#9305 AS cpfk_part_lineitem_1#9338, cfpk_lineitem_part#9306 AS cfpk_lineitem_part_1#9339, cpfk_partsupp_lineitem#9307 AS cpfk_partsupp_lineitem_1#9340, cfpk_lineitem_orders#9308 AS cfpk_lineitem_orders_1#9341, cval_lineitem_l_quantity#9309 AS cval_lineitem_l_quantity_1#9342, cval_lineitem_l_extendedprice#9310 AS cval_lineitem_l_extendedprice_1#9343, cval_lineitem_l_discount#9311 AS cval_lineitem_l_discount_1#9344, cval_lineitem_l_tax#9312 AS cval_lineitem_l_tax_1#9345, cval_lineitem_l_returnflag#9313 AS cval_lineitem_l_returnflag_1#9346, cval_lineitem_l_linestatus#9314 AS cval_lineitem_l_linestatus_1#9347, cval_lineitem_l_commitdate#9315 AS cval_lineitem_l_commitdate_1#9348, cval_lineitem_l_receiptdate#9316 AS cval_lineitem_l_receiptdate_1#9349, cval_lineitem_l_shipinstruct#9317 AS cval_lineitem_l_shipinstruct_1#9350, cval_lineitem_l_shipmode#9318 AS cval_lineitem_l_shipmode_1#9351, cval_lineitem_l_comment#9319 AS cval_lineitem_l_comment_1#9352, cval_lineitem_l_shipdate#9320 AS cval_lineitem_l_shipdate_1#9353, cl_quantity#9321 AS cl_quantity_1#9354, cl_extendedprice#9322 AS cl_extendedprice_1#9355, cl_discount#9323 AS cl_discount_1#9356, ... 9 more fields]
         :        +- Relation[rid#9300,cpfk_orders_lineitem#9301,cpfk_supplier_lineitem#9302,cfpk_lineitem_supplier#9303,cfpk_lineitem_partsupp#9304,cpfk_part_lineitem#9305,cfpk_lineitem_part#9306,cpfk_partsupp_lineitem#9307,cfpk_lineitem_orders#9308,cval_lineitem_l_quantity#9309,cval_lineitem_l_extendedprice#9310,cval_lineitem_l_discount#9311,cval_lineitem_l_tax#9312,cval_lineitem_l_returnflag#9313,cval_lineitem_l_linestatus#9314,cval_lineitem_l_commitdate#9315,cval_lineitem_l_receiptdate#9316,cval_lineitem_l_shipinstruct#9317,cval_lineitem_l_shipmode#9318,cval_lineitem_l_comment#9319,cval_lineitem_l_shipdate#9320,cl_quantity#9321,cl_extendedprice#9322,cl_discount#9323,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#9068 AS rid_1#9101, cpfk_orders_lineitem#9069 AS cpfk_orders_lineitem_1#9102, cpfk_supplier_lineitem#9070 AS cpfk_supplier_lineitem_1#9103, cfpk_lineitem_supplier#9071 AS cfpk_lineitem_supplier_1#9104, cfpk_lineitem_partsupp#9072 AS cfpk_lineitem_partsupp_1#9105, cpfk_part_lineitem#9073 AS cpfk_part_lineitem_1#9106, cfpk_lineitem_part#9074 AS cfpk_lineitem_part_1#9107, cpfk_partsupp_lineitem#9075 AS cpfk_partsupp_lineitem_1#9108, cfpk_lineitem_orders#9076 AS cfpk_lineitem_orders_1#9109, cval_lineitem_l_quantity#9077 AS cval_lineitem_l_quantity_1#9110, cval_lineitem_l_extendedprice#9078 AS cval_lineitem_l_extendedprice_1#9111, cval_lineitem_l_discount#9079 AS cval_lineitem_l_discount_1#9112, cval_lineitem_l_tax#9080 AS cval_lineitem_l_tax_1#9113, cval_lineitem_l_returnflag#9081 AS cval_lineitem_l_returnflag_1#9114, cval_lineitem_l_linestatus#9082 AS cval_lineitem_l_linestatus_1#9115, cval_lineitem_l_commitdate#9083 AS cval_lineitem_l_commitdate_1#9116, cval_lineitem_l_receiptdate#9084 AS cval_lineitem_l_receiptdate_1#9117, cval_lineitem_l_shipinstruct#9085 AS cval_lineitem_l_shipinstruct_1#9118, cval_lineitem_l_shipmode#9086 AS cval_lineitem_l_shipmode_1#9119, cval_lineitem_l_comment#9087 AS cval_lineitem_l_comment_1#9120, cval_lineitem_l_shipdate#9088 AS cval_lineitem_l_shipdate_1#9121, cl_quantity#9089 AS cl_quantity_1#9122, cl_extendedprice#9090 AS cl_extendedprice_1#9123, cl_discount#9091 AS cl_discount_1#9124, ... 9 more fields]
            :  :  +- Relation[rid#9068,cpfk_orders_lineitem#9069,cpfk_supplier_lineitem#9070,cfpk_lineitem_supplier#9071,cfpk_lineitem_partsupp#9072,cpfk_part_lineitem#9073,cfpk_lineitem_part#9074,cpfk_partsupp_lineitem#9075,cfpk_lineitem_orders#9076,cval_lineitem_l_quantity#9077,cval_lineitem_l_extendedprice#9078,cval_lineitem_l_discount#9079,cval_lineitem_l_tax#9080,cval_lineitem_l_returnflag#9081,cval_lineitem_l_linestatus#9082,cval_lineitem_l_commitdate#9083,cval_lineitem_l_receiptdate#9084,cval_lineitem_l_shipinstruct#9085,cval_lineitem_l_shipmode#9086,cval_lineitem_l_comment#9087,cval_lineitem_l_shipdate#9088,cl_quantity#9089,cl_extendedprice#9090,cl_discount#9091,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#9134 AS rid_1#9167, cpfk_orders_lineitem#9135 AS cpfk_orders_lineitem_1#9168, cpfk_supplier_lineitem#9136 AS cpfk_supplier_lineitem_1#9169, cfpk_lineitem_supplier#9137 AS cfpk_lineitem_supplier_1#9170, cfpk_lineitem_partsupp#9138 AS cfpk_lineitem_partsupp_1#9171, cpfk_part_lineitem#9139 AS cpfk_part_lineitem_1#9172, cfpk_lineitem_part#9140 AS cfpk_lineitem_part_1#9173, cpfk_partsupp_lineitem#9141 AS cpfk_partsupp_lineitem_1#9174, cfpk_lineitem_orders#9142 AS cfpk_lineitem_orders_1#9175, cval_lineitem_l_quantity#9143 AS cval_lineitem_l_quantity_1#9176, cval_lineitem_l_extendedprice#9144 AS cval_lineitem_l_extendedprice_1#9177, cval_lineitem_l_discount#9145 AS cval_lineitem_l_discount_1#9178, cval_lineitem_l_tax#9146 AS cval_lineitem_l_tax_1#9179, cval_lineitem_l_returnflag#9147 AS cval_lineitem_l_returnflag_1#9180, cval_lineitem_l_linestatus#9148 AS cval_lineitem_l_linestatus_1#9181, cval_lineitem_l_commitdate#9149 AS cval_lineitem_l_commitdate_1#9182, cval_lineitem_l_receiptdate#9150 AS cval_lineitem_l_receiptdate_1#9183, cval_lineitem_l_shipinstruct#9151 AS cval_lineitem_l_shipinstruct_1#9184, cval_lineitem_l_shipmode#9152 AS cval_lineitem_l_shipmode_1#9185, cval_lineitem_l_comment#9153 AS cval_lineitem_l_comment_1#9186, cval_lineitem_l_shipdate#9154 AS cval_lineitem_l_shipdate_1#9187, cl_quantity#9155 AS cl_quantity_1#9188, cl_extendedprice#9156 AS cl_extendedprice_1#9189, cl_discount#9157 AS cl_discount_1#9190, ... 9 more fields]
            :        +- Relation[rid#9134,cpfk_orders_lineitem#9135,cpfk_supplier_lineitem#9136,cfpk_lineitem_supplier#9137,cfpk_lineitem_partsupp#9138,cpfk_part_lineitem#9139,cfpk_lineitem_part#9140,cpfk_partsupp_lineitem#9141,cfpk_lineitem_orders#9142,cval_lineitem_l_quantity#9143,cval_lineitem_l_extendedprice#9144,cval_lineitem_l_discount#9145,cval_lineitem_l_tax#9146,cval_lineitem_l_returnflag#9147,cval_lineitem_l_linestatus#9148,cval_lineitem_l_commitdate#9149,cval_lineitem_l_receiptdate#9150,cval_lineitem_l_shipinstruct#9151,cval_lineitem_l_shipmode#9152,cval_lineitem_l_comment#9153,cval_lineitem_l_shipdate#9154,cl_quantity#9155,cl_extendedprice#9156,cl_discount#9157,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#9200 AS rid_1#9233, cpfk_orders_lineitem#9201 AS cpfk_orders_lineitem_1#9234, cpfk_supplier_lineitem#9202 AS cpfk_supplier_lineitem_1#9235, cfpk_lineitem_supplier#9203 AS cfpk_lineitem_supplier_1#9236, cfpk_lineitem_partsupp#9204 AS cfpk_lineitem_partsupp_1#9237, cpfk_part_lineitem#9205 AS cpfk_part_lineitem_1#9238, cfpk_lineitem_part#9206 AS cfpk_lineitem_part_1#9239, cpfk_partsupp_lineitem#9207 AS cpfk_partsupp_lineitem_1#9240, cfpk_lineitem_orders#9208 AS cfpk_lineitem_orders_1#9241, cval_lineitem_l_quantity#9209 AS cval_lineitem_l_quantity_1#9242, cval_lineitem_l_extendedprice#9210 AS cval_lineitem_l_extendedprice_1#9243, cval_lineitem_l_discount#9211 AS cval_lineitem_l_discount_1#9244, cval_lineitem_l_tax#9212 AS cval_lineitem_l_tax_1#9245, cval_lineitem_l_returnflag#9213 AS cval_lineitem_l_returnflag_1#9246, cval_lineitem_l_linestatus#9214 AS cval_lineitem_l_linestatus_1#9247, cval_lineitem_l_commitdate#9215 AS cval_lineitem_l_commitdate_1#9248, cval_lineitem_l_receiptdate#9216 AS cval_lineitem_l_receiptdate_1#9249, cval_lineitem_l_shipinstruct#9217 AS cval_lineitem_l_shipinstruct_1#9250, cval_lineitem_l_shipmode#9218 AS cval_lineitem_l_shipmode_1#9251, cval_lineitem_l_comment#9219 AS cval_lineitem_l_comment_1#9252, cval_lineitem_l_shipdate#9220 AS cval_lineitem_l_shipdate_1#9253, cl_quantity#9221 AS cl_quantity_1#9254, cl_extendedprice#9222 AS cl_extendedprice_1#9255, cl_discount#9223 AS cl_discount_1#9256, ... 9 more fields]
                  +- Relation[rid#9200,cpfk_orders_lineitem#9201,cpfk_supplier_lineitem#9202,cfpk_lineitem_supplier#9203,cfpk_lineitem_partsupp#9204,cpfk_part_lineitem#9205,cfpk_lineitem_part#9206,cpfk_partsupp_lineitem#9207,cfpk_lineitem_orders#9208,cval_lineitem_l_quantity#9209,cval_lineitem_l_extendedprice#9210,cval_lineitem_l_discount#9211,cval_lineitem_l_tax#9212,cval_lineitem_l_returnflag#9213,cval_lineitem_l_linestatus#9214,cval_lineitem_l_commitdate#9215,cval_lineitem_l_receiptdate#9216,cval_lineitem_l_shipinstruct#9217,cval_lineitem_l_shipmode#9218,cval_lineitem_l_comment#9219,cval_lineitem_l_shipdate#9220,cl_quantity#9221,cl_extendedprice#9222,cl_discount#9223,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 361018ms
query=q1, count=6001215, duration=3021
query=q10, count=1478870, duration=61294
query=q11, count=31680, duration=10507
query=q12, count=857401, duration=21695
query=q13, count=1500000, duration=12812
query=q14, count=6001215, duration=85413
query=q15, count=6001215, duration=77604
query=q16, count=15780, duration=10966
query=q17, count=6088, duration=71625
query=q18, count=6001215, duration=116968
query=q19, count=205, duration=361018
query=q2, count=3162, duration=20232
query=q20, count=632, duration=11024
query=q21a, count=597422, duration=246421
query=q22, count=1500000, duration=12768
query=q3, count=1214743, duration=115326
query=q4, count=6001215, duration=52453
query=q5, count=1206514, duration=163616
query=q6, count=6001215, duration=3005
query=q7, count=9735, duration=102481
query=q8, count=8716, duration=94384
query=q9a, count=6001215, duration=242044
query=q9b, count=6001215, duration=163067
