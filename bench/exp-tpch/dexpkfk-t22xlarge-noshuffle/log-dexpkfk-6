20/04/11 05:41:08 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 11492ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 11 05:41:11 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 11 05:41:13 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 11 05:41:13 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 11 05:41:13 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 11 05:41:13 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 11 05:41:17 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 11 05:41:21 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 11 05:41:21 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/11 05:41:23 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:41:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2082L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 05:41:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:41:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:41:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:41:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:41:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:41:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:41:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:41:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:41:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:41:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:41:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:41:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:41:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:41:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:41:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:41:24 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/11 05:41:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2082L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#2084 AS rid_0#2091, cpfk_region_nation#2085 AS cpfk_region_nation_0#2092, cfpk_nation_region#2086 AS cfpk_nation_region_0#2093, cval_nation_n_name#2087 AS cval_nation_n_name_0#2094, cval_nation_n_comment#2088 AS cval_nation_n_comment_0#2095, cn_name#2089 AS cn_name_0#2096, cn_comment#2090 AS cn_comment_0#2097]
            :  :  :  :  :  :  +- Relation[rid#2084,cpfk_region_nation#2085,cfpk_nation_region#2086,cval_nation_n_name#2087,cval_nation_n_comment#2088,cn_name#2089,cn_comment#2090] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#2098 AS rid_0#2105, cpfk_region_nation#2099 AS cpfk_region_nation_0#2106, cfpk_nation_region#2100 AS cfpk_nation_region_0#2107, cval_nation_n_name#2101 AS cval_nation_n_name_0#2108, cval_nation_n_comment#2102 AS cval_nation_n_comment_0#2109, cn_name#2103 AS cn_name_0#2110, cn_comment#2104 AS cn_comment_0#2111]
            :  :  :  :  :        +- Relation[rid#2098,cpfk_region_nation#2099,cfpk_nation_region#2100,cval_nation_n_name#2101,cval_nation_n_comment#2102,cn_name#2103,cn_comment#2104] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :     :- Project [rid#2138 AS rid_0#2145, cpfk_region_nation#2139 AS cpfk_region_nation_0#2146, cfpk_nation_region#2140 AS cfpk_nation_region_0#2147, cval_nation_n_name#2141 AS cval_nation_n_name_0#2148, cval_nation_n_comment#2142 AS cval_nation_n_comment_0#2149, cn_name#2143 AS cn_name_0#2150, cn_comment#2144 AS cn_comment_0#2151]
            :  :  :  :     :  +- Relation[rid#2138,cpfk_region_nation#2139,cfpk_nation_region#2140,cval_nation_n_name#2141,cval_nation_n_comment#2142,cn_name#2143,cn_comment#2144] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :     +- Project [rid#2152 AS rid_1#2165, cpfk_nation_supplier#2153 AS cpfk_nation_supplier_1#2166, cfpk_supplier_nation#2154 AS cfpk_supplier_nation_1#2167, cval_supplier_s_name#2155 AS cval_supplier_s_name_1#2168, cval_supplier_s_address#2156 AS cval_supplier_s_address_1#2169, cval_supplier_s_phone#2157 AS cval_supplier_s_phone_1#2170, cval_supplier_s_acctbal#2158 AS cval_supplier_s_acctbal_1#2171, cval_supplier_s_comment#2159 AS cval_supplier_s_comment_1#2172, cs_name#2160 AS cs_name_1#2173, cs_address#2161 AS cs_address_1#2174, cs_phone#2162 AS cs_phone_1#2175, cs_acctbal#2163 AS cs_acctbal_1#2176, cs_comment#2164 AS cs_comment_1#2177]
            :  :  :  :        +- Relation[rid#2152,cpfk_nation_supplier#2153,cfpk_supplier_nation#2154,cval_supplier_s_name#2155,cval_supplier_s_address#2156,cval_supplier_s_phone#2157,cval_supplier_s_acctbal#2158,cval_supplier_s_comment#2159,cs_name#2160,cs_address#2161,cs_phone#2162,cs_acctbal#2163,cs_comment#2164] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#2112 AS rid_1#2125, cpfk_nation_supplier#2113 AS cpfk_nation_supplier_1#2126, cfpk_supplier_nation#2114 AS cfpk_supplier_nation_1#2127, cval_supplier_s_name#2115 AS cval_supplier_s_name_1#2128, cval_supplier_s_address#2116 AS cval_supplier_s_address_1#2129, cval_supplier_s_phone#2117 AS cval_supplier_s_phone_1#2130, cval_supplier_s_acctbal#2118 AS cval_supplier_s_acctbal_1#2131, cval_supplier_s_comment#2119 AS cval_supplier_s_comment_1#2132, cs_name#2120 AS cs_name_1#2133, cs_address#2121 AS cs_address_1#2134, cs_phone#2122 AS cs_phone_1#2135, cs_acctbal#2123 AS cs_acctbal_1#2136, cs_comment#2124 AS cs_comment_1#2137]
            :  :  :     +- Relation[rid#2112,cpfk_nation_supplier#2113,cfpk_supplier_nation#2114,cval_supplier_s_name#2115,cval_supplier_s_address#2116,cval_supplier_s_phone#2117,cval_supplier_s_acctbal#2118,cval_supplier_s_comment#2119,cs_name#2120,cs_address#2121,cs_phone#2122,cs_acctbal#2123,cs_comment#2124] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :     :- Project [rid#2244 AS rid_1#2257, cpfk_nation_supplier#2245 AS cpfk_nation_supplier_1#2258, cfpk_supplier_nation#2246 AS cfpk_supplier_nation_1#2259, cval_supplier_s_name#2247 AS cval_supplier_s_name_1#2260, cval_supplier_s_address#2248 AS cval_supplier_s_address_1#2261, cval_supplier_s_phone#2249 AS cval_supplier_s_phone_1#2262, cval_supplier_s_acctbal#2250 AS cval_supplier_s_acctbal_1#2263, cval_supplier_s_comment#2251 AS cval_supplier_s_comment_1#2264, cs_name#2252 AS cs_name_1#2265, cs_address#2253 AS cs_address_1#2266, cs_phone#2254 AS cs_phone_1#2267, cs_acctbal#2255 AS cs_acctbal_1#2268, cs_comment#2256 AS cs_comment_1#2269]
            :  :     :  +- Relation[rid#2244,cpfk_nation_supplier#2245,cfpk_supplier_nation#2246,cval_supplier_s_name#2247,cval_supplier_s_address#2248,cval_supplier_s_phone#2249,cval_supplier_s_acctbal#2250,cval_supplier_s_comment#2251,cs_name#2252,cs_address#2253,cs_phone#2254,cs_acctbal#2255,cs_comment#2256] JDBCRelation(tsupplier) [numPartitions=1]
            :  :     +- Project [rid#2270 AS rid_2#2303, cpfk_orders_lineitem#2271 AS cpfk_orders_lineitem_2#2304, cpfk_supplier_lineitem#2272 AS cpfk_supplier_lineitem_2#2305, cfpk_lineitem_supplier#2273 AS cfpk_lineitem_supplier_2#2306, cfpk_lineitem_partsupp#2274 AS cfpk_lineitem_partsupp_2#2307, cpfk_part_lineitem#2275 AS cpfk_part_lineitem_2#2308, cfpk_lineitem_part#2276 AS cfpk_lineitem_part_2#2309, cpfk_partsupp_lineitem#2277 AS cpfk_partsupp_lineitem_2#2310, cfpk_lineitem_orders#2278 AS cfpk_lineitem_orders_2#2311, cval_lineitem_l_quantity#2279 AS cval_lineitem_l_quantity_2#2312, cval_lineitem_l_extendedprice#2280 AS cval_lineitem_l_extendedprice_2#2313, cval_lineitem_l_discount#2281 AS cval_lineitem_l_discount_2#2314, cval_lineitem_l_tax#2282 AS cval_lineitem_l_tax_2#2315, cval_lineitem_l_returnflag#2283 AS cval_lineitem_l_returnflag_2#2316, cval_lineitem_l_linestatus#2284 AS cval_lineitem_l_linestatus_2#2317, cval_lineitem_l_commitdate#2285 AS cval_lineitem_l_commitdate_2#2318, cval_lineitem_l_receiptdate#2286 AS cval_lineitem_l_receiptdate_2#2319, cval_lineitem_l_shipinstruct#2287 AS cval_lineitem_l_shipinstruct_2#2320, cval_lineitem_l_shipmode#2288 AS cval_lineitem_l_shipmode_2#2321, cval_lineitem_l_comment#2289 AS cval_lineitem_l_comment_2#2322, cval_lineitem_l_shipdate#2290 AS cval_lineitem_l_shipdate_2#2323, cl_quantity#2291 AS cl_quantity_2#2324, cl_extendedprice#2292 AS cl_extendedprice_2#2325, cl_discount#2293 AS cl_discount_2#2326, ... 9 more fields]
            :  :        +- Relation[rid#2270,cpfk_orders_lineitem#2271,cpfk_supplier_lineitem#2272,cfpk_lineitem_supplier#2273,cfpk_lineitem_partsupp#2274,cpfk_part_lineitem#2275,cfpk_lineitem_part#2276,cpfk_partsupp_lineitem#2277,cfpk_lineitem_orders#2278,cval_lineitem_l_quantity#2279,cval_lineitem_l_extendedprice#2280,cval_lineitem_l_discount#2281,cval_lineitem_l_tax#2282,cval_lineitem_l_returnflag#2283,cval_lineitem_l_linestatus#2284,cval_lineitem_l_commitdate#2285,cval_lineitem_l_receiptdate#2286,cval_lineitem_l_shipinstruct#2287,cval_lineitem_l_shipmode#2288,cval_lineitem_l_comment#2289,cval_lineitem_l_shipdate#2290,cl_quantity#2291,cl_extendedprice#2292,cl_discount#2293,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#2178 AS rid_2#2211, cpfk_orders_lineitem#2179 AS cpfk_orders_lineitem_2#2212, cpfk_supplier_lineitem#2180 AS cpfk_supplier_lineitem_2#2213, cfpk_lineitem_supplier#2181 AS cfpk_lineitem_supplier_2#2214, cfpk_lineitem_partsupp#2182 AS cfpk_lineitem_partsupp_2#2215, cpfk_part_lineitem#2183 AS cpfk_part_lineitem_2#2216, cfpk_lineitem_part#2184 AS cfpk_lineitem_part_2#2217, cpfk_partsupp_lineitem#2185 AS cpfk_partsupp_lineitem_2#2218, cfpk_lineitem_orders#2186 AS cfpk_lineitem_orders_2#2219, cval_lineitem_l_quantity#2187 AS cval_lineitem_l_quantity_2#2220, cval_lineitem_l_extendedprice#2188 AS cval_lineitem_l_extendedprice_2#2221, cval_lineitem_l_discount#2189 AS cval_lineitem_l_discount_2#2222, cval_lineitem_l_tax#2190 AS cval_lineitem_l_tax_2#2223, cval_lineitem_l_returnflag#2191 AS cval_lineitem_l_returnflag_2#2224, cval_lineitem_l_linestatus#2192 AS cval_lineitem_l_linestatus_2#2225, cval_lineitem_l_commitdate#2193 AS cval_lineitem_l_commitdate_2#2226, cval_lineitem_l_receiptdate#2194 AS cval_lineitem_l_receiptdate_2#2227, cval_lineitem_l_shipinstruct#2195 AS cval_lineitem_l_shipinstruct_2#2228, cval_lineitem_l_shipmode#2196 AS cval_lineitem_l_shipmode_2#2229, cval_lineitem_l_comment#2197 AS cval_lineitem_l_comment_2#2230, cval_lineitem_l_shipdate#2198 AS cval_lineitem_l_shipdate_2#2231, cl_quantity#2199 AS cl_quantity_2#2232, cl_extendedprice#2200 AS cl_extendedprice_2#2233, cl_discount#2201 AS cl_discount_2#2234, ... 9 more fields]
            :     +- Relation[rid#2178,cpfk_orders_lineitem#2179,cpfk_supplier_lineitem#2180,cfpk_lineitem_supplier#2181,cfpk_lineitem_partsupp#2182,cpfk_part_lineitem#2183,cfpk_lineitem_part#2184,cpfk_partsupp_lineitem#2185,cfpk_lineitem_orders#2186,cval_lineitem_l_quantity#2187,cval_lineitem_l_extendedprice#2188,cval_lineitem_l_discount#2189,cval_lineitem_l_tax#2190,cval_lineitem_l_returnflag#2191,cval_lineitem_l_linestatus#2192,cval_lineitem_l_commitdate#2193,cval_lineitem_l_receiptdate#2194,cval_lineitem_l_shipinstruct#2195,cval_lineitem_l_shipmode#2196,cval_lineitem_l_comment#2197,cval_lineitem_l_shipdate#2198,cl_quantity#2199,cl_extendedprice#2200,cl_discount#2201,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'Join UsingJoin(Inner,List(rid_4))
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'Join UsingJoin(Inner,List(rid_3))
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#2336 AS rid_3#2343, cpfk_region_nation#2337 AS cpfk_region_nation_3#2344, cfpk_nation_region#2338 AS cfpk_nation_region_3#2345, cval_nation_n_name#2339 AS cval_nation_n_name_3#2346, cval_nation_n_comment#2340 AS cval_nation_n_comment_3#2347, cn_name#2341 AS cn_name_3#2348, cn_comment#2342 AS cn_comment_3#2349]
               :  :  :  :  :  +- Relation[rid#2336,cpfk_region_nation#2337,cfpk_nation_region#2338,cval_nation_n_name#2339,cval_nation_n_comment#2340,cn_name#2341,cn_comment#2342] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#2350 AS rid_3#2357, cpfk_region_nation#2351 AS cpfk_region_nation_3#2358, cfpk_nation_region#2352 AS cfpk_nation_region_3#2359, cval_nation_n_name#2353 AS cval_nation_n_name_3#2360, cval_nation_n_comment#2354 AS cval_nation_n_comment_3#2361, cn_name#2355 AS cn_name_3#2362, cn_comment#2356 AS cn_comment_3#2363]
               :  :  :  :        +- Relation[rid#2350,cpfk_region_nation#2351,cfpk_nation_region#2352,cval_nation_n_name#2353,cval_nation_n_comment#2354,cn_name#2355,cn_comment#2356] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :     :- Project [rid#2394 AS rid_3#2401, cpfk_region_nation#2395 AS cpfk_region_nation_3#2402, cfpk_nation_region#2396 AS cfpk_nation_region_3#2403, cval_nation_n_name#2397 AS cval_nation_n_name_3#2404, cval_nation_n_comment#2398 AS cval_nation_n_comment_3#2405, cn_name#2399 AS cn_name_3#2406, cn_comment#2400 AS cn_comment_3#2407]
               :  :  :     :  +- Relation[rid#2394,cpfk_region_nation#2395,cfpk_nation_region#2396,cval_nation_n_name#2397,cval_nation_n_comment#2398,cn_name#2399,cn_comment#2400] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#2408 AS rid_4#2423, cpfk_nation_customer#2409 AS cpfk_nation_customer_4#2424, cfpk_customer_nation#2410 AS cfpk_customer_nation_4#2425, cval_customer_c_name#2411 AS cval_customer_c_name_4#2426, cval_customer_c_address#2412 AS cval_customer_c_address_4#2427, cval_customer_c_phone#2413 AS cval_customer_c_phone_4#2428, cval_customer_c_acctbal#2414 AS cval_customer_c_acctbal_4#2429, cval_customer_c_comment#2415 AS cval_customer_c_comment_4#2430, cval_customer_c_mktsegment#2416 AS cval_customer_c_mktsegment_4#2431, cc_name#2417 AS cc_name_4#2432, cc_address#2418 AS cc_address_4#2433, cc_phone#2419 AS cc_phone_4#2434, cc_acctbal#2420 AS cc_acctbal_4#2435, cc_comment#2421 AS cc_comment_4#2436, cc_mktsegment#2422 AS cc_mktsegment_4#2437]
               :  :  :        +- Relation[rid#2408,cpfk_nation_customer#2409,cfpk_customer_nation#2410,cval_customer_c_name#2411,cval_customer_c_address#2412,cval_customer_c_phone#2413,cval_customer_c_acctbal#2414,cval_customer_c_comment#2415,cval_customer_c_mktsegment#2416,cc_name#2417,cc_address#2418,cc_phone#2419,cc_acctbal#2420,cc_comment#2421,cc_mktsegment#2422] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#2364 AS rid_4#2379, cpfk_nation_customer#2365 AS cpfk_nation_customer_4#2380, cfpk_customer_nation#2366 AS cfpk_customer_nation_4#2381, cval_customer_c_name#2367 AS cval_customer_c_name_4#2382, cval_customer_c_address#2368 AS cval_customer_c_address_4#2383, cval_customer_c_phone#2369 AS cval_customer_c_phone_4#2384, cval_customer_c_acctbal#2370 AS cval_customer_c_acctbal_4#2385, cval_customer_c_comment#2371 AS cval_customer_c_comment_4#2386, cval_customer_c_mktsegment#2372 AS cval_customer_c_mktsegment_4#2387, cc_name#2373 AS cc_name_4#2388, cc_address#2374 AS cc_address_4#2389, cc_phone#2375 AS cc_phone_4#2390, cc_acctbal#2376 AS cc_acctbal_4#2391, cc_comment#2377 AS cc_comment_4#2392, cc_mktsegment#2378 AS cc_mktsegment_4#2393]
               :  :     +- Relation[rid#2364,cpfk_nation_customer#2365,cfpk_customer_nation#2366,cval_customer_c_name#2367,cval_customer_c_address#2368,cval_customer_c_phone#2369,cval_customer_c_acctbal#2370,cval_customer_c_comment#2371,cval_customer_c_mktsegment#2372,cc_name#2373,cc_address#2374,cc_phone#2375,cc_acctbal#2376,cc_comment#2377,cc_mktsegment#2378] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :     :- Project [rid#2472 AS rid_4#2487, cpfk_nation_customer#2473 AS cpfk_nation_customer_4#2488, cfpk_customer_nation#2474 AS cfpk_customer_nation_4#2489, cval_customer_c_name#2475 AS cval_customer_c_name_4#2490, cval_customer_c_address#2476 AS cval_customer_c_address_4#2491, cval_customer_c_phone#2477 AS cval_customer_c_phone_4#2492, cval_customer_c_acctbal#2478 AS cval_customer_c_acctbal_4#2493, cval_customer_c_comment#2479 AS cval_customer_c_comment_4#2494, cval_customer_c_mktsegment#2480 AS cval_customer_c_mktsegment_4#2495, cc_name#2481 AS cc_name_4#2496, cc_address#2482 AS cc_address_4#2497, cc_phone#2483 AS cc_phone_4#2498, cc_acctbal#2484 AS cc_acctbal_4#2499, cc_comment#2485 AS cc_comment_4#2500, cc_mktsegment#2486 AS cc_mktsegment_4#2501]
               :     :  +- Relation[rid#2472,cpfk_nation_customer#2473,cfpk_customer_nation#2474,cval_customer_c_name#2475,cval_customer_c_address#2476,cval_customer_c_phone#2477,cval_customer_c_acctbal#2478,cval_customer_c_comment#2479,cval_customer_c_mktsegment#2480,cc_name#2481,cc_address#2482,cc_phone#2483,cc_acctbal#2484,cc_comment#2485,cc_mktsegment#2486] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#2502 AS rid_5#2519, cpfk_customer_orders#2503 AS cpfk_customer_orders_5#2520, cfpk_orders_customer#2504 AS cfpk_orders_customer_5#2521, cval_orders_o_orderstatus#2505 AS cval_orders_o_orderstatus_5#2522, cval_orders_o_totalprice#2506 AS cval_orders_o_totalprice_5#2523, cval_orders_o_orderpriority#2507 AS cval_orders_o_orderpriority_5#2524, cval_orders_o_clerk#2508 AS cval_orders_o_clerk_5#2525, cval_orders_o_shippriority#2509 AS cval_orders_o_shippriority_5#2526, cval_orders_o_comment#2510 AS cval_orders_o_comment_5#2527, cval_orders_o_orderdate#2511 AS cval_orders_o_orderdate_5#2528, co_orderstatus#2512 AS co_orderstatus_5#2529, co_totalprice#2513 AS co_totalprice_5#2530, co_orderpriority#2514 AS co_orderpriority_5#2531, co_clerk#2515 AS co_clerk_5#2532, co_shippriority#2516 AS co_shippriority_5#2533, co_comment#2517 AS co_comment_5#2534, co_orderdate#2518 AS co_orderdate_5#2535]
               :        +- Relation[rid#2502,cpfk_customer_orders#2503,cfpk_orders_customer#2504,cval_orders_o_orderstatus#2505,cval_orders_o_totalprice#2506,cval_orders_o_orderpriority#2507,cval_orders_o_clerk#2508,cval_orders_o_shippriority#2509,cval_orders_o_comment#2510,cval_orders_o_orderdate#2511,co_orderstatus#2512,co_totalprice#2513,co_orderpriority#2514,co_clerk#2515,co_shippriority#2516,co_comment#2517,co_orderdate#2518] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#2438 AS rid_5#2455, cpfk_customer_orders#2439 AS cpfk_customer_orders_5#2456, cfpk_orders_customer#2440 AS cfpk_orders_customer_5#2457, cval_orders_o_orderstatus#2441 AS cval_orders_o_orderstatus_5#2458, cval_orders_o_totalprice#2442 AS cval_orders_o_totalprice_5#2459, cval_orders_o_orderpriority#2443 AS cval_orders_o_orderpriority_5#2460, cval_orders_o_clerk#2444 AS cval_orders_o_clerk_5#2461, cval_orders_o_shippriority#2445 AS cval_orders_o_shippriority_5#2462, cval_orders_o_comment#2446 AS cval_orders_o_comment_5#2463, cval_orders_o_orderdate#2447 AS cval_orders_o_orderdate_5#2464, co_orderstatus#2448 AS co_orderstatus_5#2465, co_totalprice#2449 AS co_totalprice_5#2466, co_orderpriority#2450 AS co_orderpriority_5#2467, co_clerk#2451 AS co_clerk_5#2468, co_shippriority#2452 AS co_shippriority_5#2469, co_comment#2453 AS co_comment_5#2470, co_orderdate#2454 AS co_orderdate_5#2471]
                  +- Relation[rid#2438,cpfk_customer_orders#2439,cfpk_orders_customer#2440,cval_orders_o_orderstatus#2441,cval_orders_o_totalprice#2442,cval_orders_o_orderpriority#2443,cval_orders_o_clerk#2444,cval_orders_o_shippriority#2445,cval_orders_o_comment#2446,cval_orders_o_orderdate#2447,co_orderstatus#2448,co_totalprice#2449,co_orderpriority#2450,co_clerk#2451,co_shippriority#2452,co_comment#2453,co_orderdate#2454] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 104340ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/11 05:43:07 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:43:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2632L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 05:43:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2632L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#2634 AS rid_0#2651, cpfk_customer_orders#2635 AS cpfk_customer_orders_0#2652, cfpk_orders_customer#2636 AS cfpk_orders_customer_0#2653, cval_orders_o_orderstatus#2637 AS cval_orders_o_orderstatus_0#2654, cval_orders_o_totalprice#2638 AS cval_orders_o_totalprice_0#2655, cval_orders_o_orderpriority#2639 AS cval_orders_o_orderpriority_0#2656, cval_orders_o_clerk#2640 AS cval_orders_o_clerk_0#2657, cval_orders_o_shippriority#2641 AS cval_orders_o_shippriority_0#2658, cval_orders_o_comment#2642 AS cval_orders_o_comment_0#2659, cval_orders_o_orderdate#2643 AS cval_orders_o_orderdate_0#2660, co_orderstatus#2644 AS co_orderstatus_0#2661, co_totalprice#2645 AS co_totalprice_0#2662, co_orderpriority#2646 AS co_orderpriority_0#2663, co_clerk#2647 AS co_clerk_0#2664, co_shippriority#2648 AS co_shippriority_0#2665, co_comment#2649 AS co_comment_0#2666, co_orderdate#2650 AS co_orderdate_0#2667]
            :  +- Relation[rid#2634,cpfk_customer_orders#2635,cfpk_orders_customer#2636,cval_orders_o_orderstatus#2637,cval_orders_o_totalprice#2638,cval_orders_o_orderpriority#2639,cval_orders_o_clerk#2640,cval_orders_o_shippriority#2641,cval_orders_o_comment#2642,cval_orders_o_orderdate#2643,co_orderstatus#2644,co_totalprice#2645,co_orderpriority#2646,co_clerk#2647,co_shippriority#2648,co_comment#2649,co_orderdate#2650] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#2668 AS rid_1#2683, cpfk_nation_customer#2669 AS cpfk_nation_customer_1#2684, cfpk_customer_nation#2670 AS cfpk_customer_nation_1#2685, cval_customer_c_name#2671 AS cval_customer_c_name_1#2686, cval_customer_c_address#2672 AS cval_customer_c_address_1#2687, cval_customer_c_phone#2673 AS cval_customer_c_phone_1#2688, cval_customer_c_acctbal#2674 AS cval_customer_c_acctbal_1#2689, cval_customer_c_comment#2675 AS cval_customer_c_comment_1#2690, cval_customer_c_mktsegment#2676 AS cval_customer_c_mktsegment_1#2691, cc_name#2677 AS cc_name_1#2692, cc_address#2678 AS cc_address_1#2693, cc_phone#2679 AS cc_phone_1#2694, cc_acctbal#2680 AS cc_acctbal_1#2695, cc_comment#2681 AS cc_comment_1#2696, cc_mktsegment#2682 AS cc_mktsegment_1#2697]
               +- Relation[rid#2668,cpfk_nation_customer#2669,cfpk_customer_nation#2670,cval_customer_c_name#2671,cval_customer_c_address#2672,cval_customer_c_phone#2673,cval_customer_c_acctbal#2674,cval_customer_c_comment#2675,cval_customer_c_mktsegment#2676,cc_name#2677,cc_address#2678,cc_phone#2679,cc_acctbal#2680,cc_comment#2681,cc_mktsegment#2682] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 12849ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/11 05:43:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:43:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2735L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 05:43:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2735L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#2737 AS rid_0#2754, cpfk_customer_orders#2738 AS cpfk_customer_orders_0#2755, cfpk_orders_customer#2739 AS cfpk_orders_customer_0#2756, cval_orders_o_orderstatus#2740 AS cval_orders_o_orderstatus_0#2757, cval_orders_o_totalprice#2741 AS cval_orders_o_totalprice_0#2758, cval_orders_o_orderpriority#2742 AS cval_orders_o_orderpriority_0#2759, cval_orders_o_clerk#2743 AS cval_orders_o_clerk_0#2760, cval_orders_o_shippriority#2744 AS cval_orders_o_shippriority_0#2761, cval_orders_o_comment#2745 AS cval_orders_o_comment_0#2762, cval_orders_o_orderdate#2746 AS cval_orders_o_orderdate_0#2763, co_orderstatus#2747 AS co_orderstatus_0#2764, co_totalprice#2748 AS co_totalprice_0#2765, co_orderpriority#2749 AS co_orderpriority_0#2766, co_clerk#2750 AS co_clerk_0#2767, co_shippriority#2751 AS co_shippriority_0#2768, co_comment#2752 AS co_comment_0#2769, co_orderdate#2753 AS co_orderdate_0#2770]
            :  +- Relation[rid#2737,cpfk_customer_orders#2738,cfpk_orders_customer#2739,cval_orders_o_orderstatus#2740,cval_orders_o_totalprice#2741,cval_orders_o_orderpriority#2742,cval_orders_o_clerk#2743,cval_orders_o_shippriority#2744,cval_orders_o_comment#2745,cval_orders_o_orderdate#2746,co_orderstatus#2747,co_totalprice#2748,co_orderpriority#2749,co_clerk#2750,co_shippriority#2751,co_comment#2752,co_orderdate#2753] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#2771 AS rid_1#2786, cpfk_nation_customer#2772 AS cpfk_nation_customer_1#2787, cfpk_customer_nation#2773 AS cfpk_customer_nation_1#2788, cval_customer_c_name#2774 AS cval_customer_c_name_1#2789, cval_customer_c_address#2775 AS cval_customer_c_address_1#2790, cval_customer_c_phone#2776 AS cval_customer_c_phone_1#2791, cval_customer_c_acctbal#2777 AS cval_customer_c_acctbal_1#2792, cval_customer_c_comment#2778 AS cval_customer_c_comment_1#2793, cval_customer_c_mktsegment#2779 AS cval_customer_c_mktsegment_1#2794, cc_name#2780 AS cc_name_1#2795, cc_address#2781 AS cc_address_1#2796, cc_phone#2782 AS cc_phone_1#2797, cc_acctbal#2783 AS cc_acctbal_1#2798, cc_comment#2784 AS cc_comment_1#2799, cc_mktsegment#2785 AS cc_mktsegment_1#2800]
               +- Relation[rid#2771,cpfk_nation_customer#2772,cfpk_customer_nation#2773,cval_customer_c_name#2774,cval_customer_c_address#2775,cval_customer_c_phone#2776,cval_customer_c_acctbal#2777,cval_customer_c_comment#2778,cval_customer_c_mktsegment#2779,cc_name#2780,cc_address#2781,cc_phone#2782,cc_acctbal#2783,cc_comment#2784,cc_mktsegment#2785] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 12887ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/11 05:43:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:43:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2837L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 05:43:33 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:43:33 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:43:33 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:43:33 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:43:33 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:43:33 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:43:33 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 05:43:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2837L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#2839 AS rid_0#2856, cval_part_p_name#2840 AS cval_part_p_name_0#2857, cval_part_p_mfgr#2841 AS cval_part_p_mfgr_0#2858, cval_part_p_type#2842 AS cval_part_p_type_0#2859, cval_part_p_size#2843 AS cval_part_p_size_0#2860, cval_part_p_container#2844 AS cval_part_p_container_0#2861, cval_part_p_retailprice#2845 AS cval_part_p_retailprice_0#2862, cval_part_p_comment#2846 AS cval_part_p_comment_0#2863, cval_part_p_brand#2847 AS cval_part_p_brand_0#2864, cp_name#2848 AS cp_name_0#2865, cp_mfgr#2849 AS cp_mfgr_0#2866, cp_type#2850 AS cp_type_0#2867, cp_size#2851 AS cp_size_0#2868, cp_container#2852 AS cp_container_0#2869, cp_retailprice#2853 AS cp_retailprice_0#2870, cp_comment#2854 AS cp_comment_0#2871, cp_brand#2855 AS cp_brand_0#2872]
         :  :  :  :  +- Relation[rid#2839,cval_part_p_name#2840,cval_part_p_mfgr#2841,cval_part_p_type#2842,cval_part_p_size#2843,cval_part_p_container#2844,cval_part_p_retailprice#2845,cval_part_p_comment#2846,cval_part_p_brand#2847,cp_name#2848,cp_mfgr#2849,cp_type#2850,cp_size#2851,cp_container#2852,cp_retailprice#2853,cp_comment#2854,cp_brand#2855] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#2873 AS rid_0#2890, cval_part_p_name#2874 AS cval_part_p_name_0#2891, cval_part_p_mfgr#2875 AS cval_part_p_mfgr_0#2892, cval_part_p_type#2876 AS cval_part_p_type_0#2893, cval_part_p_size#2877 AS cval_part_p_size_0#2894, cval_part_p_container#2878 AS cval_part_p_container_0#2895, cval_part_p_retailprice#2879 AS cval_part_p_retailprice_0#2896, cval_part_p_comment#2880 AS cval_part_p_comment_0#2897, cval_part_p_brand#2881 AS cval_part_p_brand_0#2898, cp_name#2882 AS cp_name_0#2899, cp_mfgr#2883 AS cp_mfgr_0#2900, cp_type#2884 AS cp_type_0#2901, cp_size#2885 AS cp_size_0#2902, cp_container#2886 AS cp_container_0#2903, cp_retailprice#2887 AS cp_retailprice_0#2904, cp_comment#2888 AS cp_comment_0#2905, cp_brand#2889 AS cp_brand_0#2906]
         :  :  :        +- Relation[rid#2873,cval_part_p_name#2874,cval_part_p_mfgr#2875,cval_part_p_type#2876,cval_part_p_size#2877,cval_part_p_container#2878,cval_part_p_retailprice#2879,cval_part_p_comment#2880,cval_part_p_brand#2881,cp_name#2882,cp_mfgr#2883,cp_type#2884,cp_size#2885,cp_container#2886,cp_retailprice#2887,cp_comment#2888,cp_brand#2889] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#2907 AS rid_0#2924, cval_part_p_name#2908 AS cval_part_p_name_0#2925, cval_part_p_mfgr#2909 AS cval_part_p_mfgr_0#2926, cval_part_p_type#2910 AS cval_part_p_type_0#2927, cval_part_p_size#2911 AS cval_part_p_size_0#2928, cval_part_p_container#2912 AS cval_part_p_container_0#2929, cval_part_p_retailprice#2913 AS cval_part_p_retailprice_0#2930, cval_part_p_comment#2914 AS cval_part_p_comment_0#2931, cval_part_p_brand#2915 AS cval_part_p_brand_0#2932, cp_name#2916 AS cp_name_0#2933, cp_mfgr#2917 AS cp_mfgr_0#2934, cp_type#2918 AS cp_type_0#2935, cp_size#2919 AS cp_size_0#2936, cp_container#2920 AS cp_container_0#2937, cp_retailprice#2921 AS cp_retailprice_0#2938, cp_comment#2922 AS cp_comment_0#2939, cp_brand#2923 AS cp_brand_0#2940]
         :  :        +- Relation[rid#2907,cval_part_p_name#2908,cval_part_p_mfgr#2909,cval_part_p_type#2910,cval_part_p_size#2911,cval_part_p_container#2912,cval_part_p_retailprice#2913,cval_part_p_comment#2914,cval_part_p_brand#2915,cp_name#2916,cp_mfgr#2917,cp_type#2918,cp_size#2919,cp_container#2920,cp_retailprice#2921,cp_comment#2922,cp_brand#2923] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#3007 AS rid_0#3024, cval_part_p_name#3008 AS cval_part_p_name_0#3025, cval_part_p_mfgr#3009 AS cval_part_p_mfgr_0#3026, cval_part_p_type#3010 AS cval_part_p_type_0#3027, cval_part_p_size#3011 AS cval_part_p_size_0#3028, cval_part_p_container#3012 AS cval_part_p_container_0#3029, cval_part_p_retailprice#3013 AS cval_part_p_retailprice_0#3030, cval_part_p_comment#3014 AS cval_part_p_comment_0#3031, cval_part_p_brand#3015 AS cval_part_p_brand_0#3032, cp_name#3016 AS cp_name_0#3033, cp_mfgr#3017 AS cp_mfgr_0#3034, cp_type#3018 AS cp_type_0#3035, cp_size#3019 AS cp_size_0#3036, cp_container#3020 AS cp_container_0#3037, cp_retailprice#3021 AS cp_retailprice_0#3038, cp_comment#3022 AS cp_comment_0#3039, cp_brand#3023 AS cp_brand_0#3040]
         :     :  +- Relation[rid#3007,cval_part_p_name#3008,cval_part_p_mfgr#3009,cval_part_p_type#3010,cval_part_p_size#3011,cval_part_p_container#3012,cval_part_p_retailprice#3013,cval_part_p_comment#3014,cval_part_p_brand#3015,cp_name#3016,cp_mfgr#3017,cp_type#3018,cp_size#3019,cp_container#3020,cp_retailprice#3021,cp_comment#3022,cp_brand#3023] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#3041 AS rid_1#3074, cpfk_orders_lineitem#3042 AS cpfk_orders_lineitem_1#3075, cpfk_supplier_lineitem#3043 AS cpfk_supplier_lineitem_1#3076, cfpk_lineitem_supplier#3044 AS cfpk_lineitem_supplier_1#3077, cfpk_lineitem_partsupp#3045 AS cfpk_lineitem_partsupp_1#3078, cpfk_part_lineitem#3046 AS cpfk_part_lineitem_1#3079, cfpk_lineitem_part#3047 AS cfpk_lineitem_part_1#3080, cpfk_partsupp_lineitem#3048 AS cpfk_partsupp_lineitem_1#3081, cfpk_lineitem_orders#3049 AS cfpk_lineitem_orders_1#3082, cval_lineitem_l_quantity#3050 AS cval_lineitem_l_quantity_1#3083, cval_lineitem_l_extendedprice#3051 AS cval_lineitem_l_extendedprice_1#3084, cval_lineitem_l_discount#3052 AS cval_lineitem_l_discount_1#3085, cval_lineitem_l_tax#3053 AS cval_lineitem_l_tax_1#3086, cval_lineitem_l_returnflag#3054 AS cval_lineitem_l_returnflag_1#3087, cval_lineitem_l_linestatus#3055 AS cval_lineitem_l_linestatus_1#3088, cval_lineitem_l_commitdate#3056 AS cval_lineitem_l_commitdate_1#3089, cval_lineitem_l_receiptdate#3057 AS cval_lineitem_l_receiptdate_1#3090, cval_lineitem_l_shipinstruct#3058 AS cval_lineitem_l_shipinstruct_1#3091, cval_lineitem_l_shipmode#3059 AS cval_lineitem_l_shipmode_1#3092, cval_lineitem_l_comment#3060 AS cval_lineitem_l_comment_1#3093, cval_lineitem_l_shipdate#3061 AS cval_lineitem_l_shipdate_1#3094, cl_quantity#3062 AS cl_quantity_1#3095, cl_extendedprice#3063 AS cl_extendedprice_1#3096, cl_discount#3064 AS cl_discount_1#3097, ... 9 more fields]
         :        +- Relation[rid#3041,cpfk_orders_lineitem#3042,cpfk_supplier_lineitem#3043,cfpk_lineitem_supplier#3044,cfpk_lineitem_partsupp#3045,cpfk_part_lineitem#3046,cfpk_lineitem_part#3047,cpfk_partsupp_lineitem#3048,cfpk_lineitem_orders#3049,cval_lineitem_l_quantity#3050,cval_lineitem_l_extendedprice#3051,cval_lineitem_l_discount#3052,cval_lineitem_l_tax#3053,cval_lineitem_l_returnflag#3054,cval_lineitem_l_linestatus#3055,cval_lineitem_l_commitdate#3056,cval_lineitem_l_receiptdate#3057,cval_lineitem_l_shipinstruct#3058,cval_lineitem_l_shipmode#3059,cval_lineitem_l_comment#3060,cval_lineitem_l_shipdate#3061,cl_quantity#3062,cl_extendedprice#3063,cl_discount#3064,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2941 AS rid_1#2974, cpfk_orders_lineitem#2942 AS cpfk_orders_lineitem_1#2975, cpfk_supplier_lineitem#2943 AS cpfk_supplier_lineitem_1#2976, cfpk_lineitem_supplier#2944 AS cfpk_lineitem_supplier_1#2977, cfpk_lineitem_partsupp#2945 AS cfpk_lineitem_partsupp_1#2978, cpfk_part_lineitem#2946 AS cpfk_part_lineitem_1#2979, cfpk_lineitem_part#2947 AS cfpk_lineitem_part_1#2980, cpfk_partsupp_lineitem#2948 AS cpfk_partsupp_lineitem_1#2981, cfpk_lineitem_orders#2949 AS cfpk_lineitem_orders_1#2982, cval_lineitem_l_quantity#2950 AS cval_lineitem_l_quantity_1#2983, cval_lineitem_l_extendedprice#2951 AS cval_lineitem_l_extendedprice_1#2984, cval_lineitem_l_discount#2952 AS cval_lineitem_l_discount_1#2985, cval_lineitem_l_tax#2953 AS cval_lineitem_l_tax_1#2986, cval_lineitem_l_returnflag#2954 AS cval_lineitem_l_returnflag_1#2987, cval_lineitem_l_linestatus#2955 AS cval_lineitem_l_linestatus_1#2988, cval_lineitem_l_commitdate#2956 AS cval_lineitem_l_commitdate_1#2989, cval_lineitem_l_receiptdate#2957 AS cval_lineitem_l_receiptdate_1#2990, cval_lineitem_l_shipinstruct#2958 AS cval_lineitem_l_shipinstruct_1#2991, cval_lineitem_l_shipmode#2959 AS cval_lineitem_l_shipmode_1#2992, cval_lineitem_l_comment#2960 AS cval_lineitem_l_comment_1#2993, cval_lineitem_l_shipdate#2961 AS cval_lineitem_l_shipdate_1#2994, cl_quantity#2962 AS cl_quantity_1#2995, cl_extendedprice#2963 AS cl_extendedprice_1#2996, cl_discount#2964 AS cl_discount_1#2997, ... 9 more fields]
            +- Relation[rid#2941,cpfk_orders_lineitem#2942,cpfk_supplier_lineitem#2943,cfpk_lineitem_supplier#2944,cfpk_lineitem_partsupp#2945,cpfk_part_lineitem#2946,cfpk_lineitem_part#2947,cpfk_partsupp_lineitem#2948,cfpk_lineitem_orders#2949,cval_lineitem_l_quantity#2950,cval_lineitem_l_extendedprice#2951,cval_lineitem_l_discount#2952,cval_lineitem_l_tax#2953,cval_lineitem_l_returnflag#2954,cval_lineitem_l_linestatus#2955,cval_lineitem_l_commitdate#2956,cval_lineitem_l_receiptdate#2957,cval_lineitem_l_shipinstruct#2958,cval_lineitem_l_shipmode#2959,cval_lineitem_l_comment#2960,cval_lineitem_l_shipdate#2961,cl_quantity#2962,cl_extendedprice#2963,cl_discount#2964,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 72470ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/11 05:44:46 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:44:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3162L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 05:44:46 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:44:46 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:44:46 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:44:46 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:44:46 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:44:46 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:44:46 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:44:46 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:44:46 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:44:46 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:44:46 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:44:46 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:44:46 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:44:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3162L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#3164 AS rid_0#3181, cval_part_p_name#3165 AS cval_part_p_name_0#3182, cval_part_p_mfgr#3166 AS cval_part_p_mfgr_0#3183, cval_part_p_type#3167 AS cval_part_p_type_0#3184, cval_part_p_size#3168 AS cval_part_p_size_0#3185, cval_part_p_container#3169 AS cval_part_p_container_0#3186, cval_part_p_retailprice#3170 AS cval_part_p_retailprice_0#3187, cval_part_p_comment#3171 AS cval_part_p_comment_0#3188, cval_part_p_brand#3172 AS cval_part_p_brand_0#3189, cp_name#3173 AS cp_name_0#3190, cp_mfgr#3174 AS cp_mfgr_0#3191, cp_type#3175 AS cp_type_0#3192, cp_size#3176 AS cp_size_0#3193, cp_container#3177 AS cp_container_0#3194, cp_retailprice#3178 AS cp_retailprice_0#3195, cp_comment#3179 AS cp_comment_0#3196, cp_brand#3180 AS cp_brand_0#3197]
            :  :  :  :  +- Relation[rid#3164,cval_part_p_name#3165,cval_part_p_mfgr#3166,cval_part_p_type#3167,cval_part_p_size#3168,cval_part_p_container#3169,cval_part_p_retailprice#3170,cval_part_p_comment#3171,cval_part_p_brand#3172,cp_name#3173,cp_mfgr#3174,cp_type#3175,cp_size#3176,cp_container#3177,cp_retailprice#3178,cp_comment#3179,cp_brand#3180] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#3198 AS rid_0#3215, cval_part_p_name#3199 AS cval_part_p_name_0#3216, cval_part_p_mfgr#3200 AS cval_part_p_mfgr_0#3217, cval_part_p_type#3201 AS cval_part_p_type_0#3218, cval_part_p_size#3202 AS cval_part_p_size_0#3219, cval_part_p_container#3203 AS cval_part_p_container_0#3220, cval_part_p_retailprice#3204 AS cval_part_p_retailprice_0#3221, cval_part_p_comment#3205 AS cval_part_p_comment_0#3222, cval_part_p_brand#3206 AS cval_part_p_brand_0#3223, cp_name#3207 AS cp_name_0#3224, cp_mfgr#3208 AS cp_mfgr_0#3225, cp_type#3209 AS cp_type_0#3226, cp_size#3210 AS cp_size_0#3227, cp_container#3211 AS cp_container_0#3228, cp_retailprice#3212 AS cp_retailprice_0#3229, cp_comment#3213 AS cp_comment_0#3230, cp_brand#3214 AS cp_brand_0#3231]
            :  :  :        +- Relation[rid#3198,cval_part_p_name#3199,cval_part_p_mfgr#3200,cval_part_p_type#3201,cval_part_p_size#3202,cval_part_p_container#3203,cval_part_p_retailprice#3204,cval_part_p_comment#3205,cval_part_p_brand#3206,cp_name#3207,cp_mfgr#3208,cp_type#3209,cp_size#3210,cp_container#3211,cp_retailprice#3212,cp_comment#3213,cp_brand#3214] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :     :- Project [rid#3254 AS rid_0#3271, cval_part_p_name#3255 AS cval_part_p_name_0#3272, cval_part_p_mfgr#3256 AS cval_part_p_mfgr_0#3273, cval_part_p_type#3257 AS cval_part_p_type_0#3274, cval_part_p_size#3258 AS cval_part_p_size_0#3275, cval_part_p_container#3259 AS cval_part_p_container_0#3276, cval_part_p_retailprice#3260 AS cval_part_p_retailprice_0#3277, cval_part_p_comment#3261 AS cval_part_p_comment_0#3278, cval_part_p_brand#3262 AS cval_part_p_brand_0#3279, cp_name#3263 AS cp_name_0#3280, cp_mfgr#3264 AS cp_mfgr_0#3281, cp_type#3265 AS cp_type_0#3282, cp_size#3266 AS cp_size_0#3283, cp_container#3267 AS cp_container_0#3284, cp_retailprice#3268 AS cp_retailprice_0#3285, cp_comment#3269 AS cp_comment_0#3286, cp_brand#3270 AS cp_brand_0#3287]
            :  :     :  +- Relation[rid#3254,cval_part_p_name#3255,cval_part_p_mfgr#3256,cval_part_p_type#3257,cval_part_p_size#3258,cval_part_p_container#3259,cval_part_p_retailprice#3260,cval_part_p_comment#3261,cval_part_p_brand#3262,cp_name#3263,cp_mfgr#3264,cp_type#3265,cp_size#3266,cp_container#3267,cp_retailprice#3268,cp_comment#3269,cp_brand#3270] JDBCRelation(tpart) [numPartitions=1]
            :  :     +- Project [rid#3288 AS rid_1#3299, cpfk_part_partsupp#3289 AS cpfk_part_partsupp_1#3300, cfpk_partsupp_part#3290 AS cfpk_partsupp_part_1#3301, cpfk_supplier_partsupp#3291 AS cpfk_supplier_partsupp_1#3302, cfpk_partsupp_supplier#3292 AS cfpk_partsupp_supplier_1#3303, cval_partsupp_ps_availqty#3293 AS cval_partsupp_ps_availqty_1#3304, cval_partsupp_ps_supplycost#3294 AS cval_partsupp_ps_supplycost_1#3305, cval_partsupp_ps_comment#3295 AS cval_partsupp_ps_comment_1#3306, cps_availqty#3296 AS cps_availqty_1#3307, cps_supplycost#3297 AS cps_supplycost_1#3308, cps_comment#3298 AS cps_comment_1#3309]
            :  :        +- Relation[rid#3288,cpfk_part_partsupp#3289,cfpk_partsupp_part#3290,cpfk_supplier_partsupp#3291,cfpk_partsupp_supplier#3292,cval_partsupp_ps_availqty#3293,cval_partsupp_ps_supplycost#3294,cval_partsupp_ps_comment#3295,cps_availqty#3296,cps_supplycost#3297,cps_comment#3298] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#3232 AS rid_1#3243, cpfk_part_partsupp#3233 AS cpfk_part_partsupp_1#3244, cfpk_partsupp_part#3234 AS cfpk_partsupp_part_1#3245, cpfk_supplier_partsupp#3235 AS cpfk_supplier_partsupp_1#3246, cfpk_partsupp_supplier#3236 AS cfpk_partsupp_supplier_1#3247, cval_partsupp_ps_availqty#3237 AS cval_partsupp_ps_availqty_1#3248, cval_partsupp_ps_supplycost#3238 AS cval_partsupp_ps_supplycost_1#3249, cval_partsupp_ps_comment#3239 AS cval_partsupp_ps_comment_1#3250, cps_availqty#3240 AS cps_availqty_1#3251, cps_supplycost#3241 AS cps_supplycost_1#3252, cps_comment#3242 AS cps_comment_1#3253]
            :     +- Relation[rid#3232,cpfk_part_partsupp#3233,cfpk_partsupp_part#3234,cpfk_supplier_partsupp#3235,cfpk_partsupp_supplier#3236,cval_partsupp_ps_availqty#3237,cval_partsupp_ps_supplycost#3238,cval_partsupp_ps_comment#3239,cps_availqty#3240,cps_supplycost#3241,cps_comment#3242] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#3310 AS rid_2#3317, cpfk_region_nation#3311 AS cpfk_region_nation_2#3318, cfpk_nation_region#3312 AS cfpk_nation_region_2#3319, cval_nation_n_name#3313 AS cval_nation_n_name_2#3320, cval_nation_n_comment#3314 AS cval_nation_n_comment_2#3321, cn_name#3315 AS cn_name_2#3322, cn_comment#3316 AS cn_comment_2#3323]
               :  :  :  +- Relation[rid#3310,cpfk_region_nation#3311,cfpk_nation_region#3312,cval_nation_n_name#3313,cval_nation_n_comment#3314,cn_name#3315,cn_comment#3316] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#3324 AS rid_2#3331, cpfk_region_nation#3325 AS cpfk_region_nation_2#3332, cfpk_nation_region#3326 AS cfpk_nation_region_2#3333, cval_nation_n_name#3327 AS cval_nation_n_name_2#3334, cval_nation_n_comment#3328 AS cval_nation_n_comment_2#3335, cn_name#3329 AS cn_name_2#3336, cn_comment#3330 AS cn_comment_2#3337]
               :  :        +- Relation[rid#3324,cpfk_region_nation#3325,cfpk_nation_region#3326,cval_nation_n_name#3327,cval_nation_n_comment#3328,cn_name#3329,cn_comment#3330] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :     :- Project [rid#3364 AS rid_2#3371, cpfk_region_nation#3365 AS cpfk_region_nation_2#3372, cfpk_nation_region#3366 AS cfpk_nation_region_2#3373, cval_nation_n_name#3367 AS cval_nation_n_name_2#3374, cval_nation_n_comment#3368 AS cval_nation_n_comment_2#3375, cn_name#3369 AS cn_name_2#3376, cn_comment#3370 AS cn_comment_2#3377]
               :     :  +- Relation[rid#3364,cpfk_region_nation#3365,cfpk_nation_region#3366,cval_nation_n_name#3367,cval_nation_n_comment#3368,cn_name#3369,cn_comment#3370] JDBCRelation(tnation) [numPartitions=1]
               :     +- Project [rid#3378 AS rid_3#3391, cpfk_nation_supplier#3379 AS cpfk_nation_supplier_3#3392, cfpk_supplier_nation#3380 AS cfpk_supplier_nation_3#3393, cval_supplier_s_name#3381 AS cval_supplier_s_name_3#3394, cval_supplier_s_address#3382 AS cval_supplier_s_address_3#3395, cval_supplier_s_phone#3383 AS cval_supplier_s_phone_3#3396, cval_supplier_s_acctbal#3384 AS cval_supplier_s_acctbal_3#3397, cval_supplier_s_comment#3385 AS cval_supplier_s_comment_3#3398, cs_name#3386 AS cs_name_3#3399, cs_address#3387 AS cs_address_3#3400, cs_phone#3388 AS cs_phone_3#3401, cs_acctbal#3389 AS cs_acctbal_3#3402, cs_comment#3390 AS cs_comment_3#3403]
               :        +- Relation[rid#3378,cpfk_nation_supplier#3379,cfpk_supplier_nation#3380,cval_supplier_s_name#3381,cval_supplier_s_address#3382,cval_supplier_s_phone#3383,cval_supplier_s_acctbal#3384,cval_supplier_s_comment#3385,cs_name#3386,cs_address#3387,cs_phone#3388,cs_acctbal#3389,cs_comment#3390] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#3338 AS rid_3#3351, cpfk_nation_supplier#3339 AS cpfk_nation_supplier_3#3352, cfpk_supplier_nation#3340 AS cfpk_supplier_nation_3#3353, cval_supplier_s_name#3341 AS cval_supplier_s_name_3#3354, cval_supplier_s_address#3342 AS cval_supplier_s_address_3#3355, cval_supplier_s_phone#3343 AS cval_supplier_s_phone_3#3356, cval_supplier_s_acctbal#3344 AS cval_supplier_s_acctbal_3#3357, cval_supplier_s_comment#3345 AS cval_supplier_s_comment_3#3358, cs_name#3346 AS cs_name_3#3359, cs_address#3347 AS cs_address_3#3360, cs_phone#3348 AS cs_phone_3#3361, cs_acctbal#3349 AS cs_acctbal_3#3362, cs_comment#3350 AS cs_comment_3#3363]
                  +- Relation[rid#3338,cpfk_nation_supplier#3339,cfpk_supplier_nation#3340,cval_supplier_s_name#3341,cval_supplier_s_address#3342,cval_supplier_s_phone#3343,cval_supplier_s_acctbal#3344,cval_supplier_s_comment#3345,cs_name#3346,cs_address#3347,cs_phone#3348,cs_acctbal#3349,cs_comment#3350] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 11537ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/11 05:44:57 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:44:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3458L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 05:44:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:44:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:44:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:44:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:44:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:44:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:44:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 05:44:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:44:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:44:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:44:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:44:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:44:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:44:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:44:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:44:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:44:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3458L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#3460 AS rid_0#3465, cval_region_r_name#3461 AS cval_region_r_name_0#3466, cval_region_r_comment#3462 AS cval_region_r_comment_0#3467, cr_name#3463 AS cr_name_0#3468, cr_comment#3464 AS cr_comment_0#3469]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#3460,cval_region_r_name#3461,cval_region_r_comment#3462,cr_name#3463,cr_comment#3464] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#3470 AS rid_0#3475, cval_region_r_name#3471 AS cval_region_r_name_0#3476, cval_region_r_comment#3472 AS cval_region_r_comment_0#3477, cr_name#3473 AS cr_name_0#3478, cr_comment#3474 AS cr_comment_0#3479]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#3470,cval_region_r_name#3471,cval_region_r_comment#3472,cr_name#3473,cr_comment#3474] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :     :- Project [rid#3494 AS rid_0#3499, cval_region_r_name#3495 AS cval_region_r_name_0#3500, cval_region_r_comment#3496 AS cval_region_r_comment_0#3501, cr_name#3497 AS cr_name_0#3502, cr_comment#3498 AS cr_comment_0#3503]
         :     :  :  :  :  :  :  :  :     :  +- Relation[rid#3494,cval_region_r_name#3495,cval_region_r_comment#3496,cr_name#3497,cr_comment#3498] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :     +- Project [rid#3504 AS rid_1#3511, cpfk_region_nation#3505 AS cpfk_region_nation_1#3512, cfpk_nation_region#3506 AS cfpk_nation_region_1#3513, cval_nation_n_name#3507 AS cval_nation_n_name_1#3514, cval_nation_n_comment#3508 AS cval_nation_n_comment_1#3515, cn_name#3509 AS cn_name_1#3516, cn_comment#3510 AS cn_comment_1#3517]
         :     :  :  :  :  :  :  :  :        +- Relation[rid#3504,cpfk_region_nation#3505,cfpk_nation_region#3506,cval_nation_n_name#3507,cval_nation_n_comment#3508,cn_name#3509,cn_comment#3510] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#3480 AS rid_1#3487, cpfk_region_nation#3481 AS cpfk_region_nation_1#3488, cfpk_nation_region#3482 AS cfpk_nation_region_1#3489, cval_nation_n_name#3483 AS cval_nation_n_name_1#3490, cval_nation_n_comment#3484 AS cval_nation_n_comment_1#3491, cn_name#3485 AS cn_name_1#3492, cn_comment#3486 AS cn_comment_1#3493]
         :     :  :  :  :  :  :  :     +- Relation[rid#3480,cpfk_region_nation#3481,cfpk_nation_region#3482,cval_nation_n_name#3483,cval_nation_n_comment#3484,cn_name#3485,cn_comment#3486] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :     :- Project [rid#3548 AS rid_1#3555, cpfk_region_nation#3549 AS cpfk_region_nation_1#3556, cfpk_nation_region#3550 AS cfpk_nation_region_1#3557, cval_nation_n_name#3551 AS cval_nation_n_name_1#3558, cval_nation_n_comment#3552 AS cval_nation_n_comment_1#3559, cn_name#3553 AS cn_name_1#3560, cn_comment#3554 AS cn_comment_1#3561]
         :     :  :  :  :  :  :     :  +- Relation[rid#3548,cpfk_region_nation#3549,cfpk_nation_region#3550,cval_nation_n_name#3551,cval_nation_n_comment#3552,cn_name#3553,cn_comment#3554] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :     +- Project [rid#3562 AS rid_2#3577, cpfk_nation_customer#3563 AS cpfk_nation_customer_2#3578, cfpk_customer_nation#3564 AS cfpk_customer_nation_2#3579, cval_customer_c_name#3565 AS cval_customer_c_name_2#3580, cval_customer_c_address#3566 AS cval_customer_c_address_2#3581, cval_customer_c_phone#3567 AS cval_customer_c_phone_2#3582, cval_customer_c_acctbal#3568 AS cval_customer_c_acctbal_2#3583, cval_customer_c_comment#3569 AS cval_customer_c_comment_2#3584, cval_customer_c_mktsegment#3570 AS cval_customer_c_mktsegment_2#3585, cc_name#3571 AS cc_name_2#3586, cc_address#3572 AS cc_address_2#3587, cc_phone#3573 AS cc_phone_2#3588, cc_acctbal#3574 AS cc_acctbal_2#3589, cc_comment#3575 AS cc_comment_2#3590, cc_mktsegment#3576 AS cc_mktsegment_2#3591]
         :     :  :  :  :  :  :        +- Relation[rid#3562,cpfk_nation_customer#3563,cfpk_customer_nation#3564,cval_customer_c_name#3565,cval_customer_c_address#3566,cval_customer_c_phone#3567,cval_customer_c_acctbal#3568,cval_customer_c_comment#3569,cval_customer_c_mktsegment#3570,cc_name#3571,cc_address#3572,cc_phone#3573,cc_acctbal#3574,cc_comment#3575,cc_mktsegment#3576] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#3518 AS rid_2#3533, cpfk_nation_customer#3519 AS cpfk_nation_customer_2#3534, cfpk_customer_nation#3520 AS cfpk_customer_nation_2#3535, cval_customer_c_name#3521 AS cval_customer_c_name_2#3536, cval_customer_c_address#3522 AS cval_customer_c_address_2#3537, cval_customer_c_phone#3523 AS cval_customer_c_phone_2#3538, cval_customer_c_acctbal#3524 AS cval_customer_c_acctbal_2#3539, cval_customer_c_comment#3525 AS cval_customer_c_comment_2#3540, cval_customer_c_mktsegment#3526 AS cval_customer_c_mktsegment_2#3541, cc_name#3527 AS cc_name_2#3542, cc_address#3528 AS cc_address_2#3543, cc_phone#3529 AS cc_phone_2#3544, cc_acctbal#3530 AS cc_acctbal_2#3545, cc_comment#3531 AS cc_comment_2#3546, cc_mktsegment#3532 AS cc_mktsegment_2#3547]
         :     :  :  :  :  :     +- Relation[rid#3518,cpfk_nation_customer#3519,cfpk_customer_nation#3520,cval_customer_c_name#3521,cval_customer_c_address#3522,cval_customer_c_phone#3523,cval_customer_c_acctbal#3524,cval_customer_c_comment#3525,cval_customer_c_mktsegment#3526,cc_name#3527,cc_address#3528,cc_phone#3529,cc_acctbal#3530,cc_comment#3531,cc_mktsegment#3532] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :     :- Project [rid#3626 AS rid_2#3641, cpfk_nation_customer#3627 AS cpfk_nation_customer_2#3642, cfpk_customer_nation#3628 AS cfpk_customer_nation_2#3643, cval_customer_c_name#3629 AS cval_customer_c_name_2#3644, cval_customer_c_address#3630 AS cval_customer_c_address_2#3645, cval_customer_c_phone#3631 AS cval_customer_c_phone_2#3646, cval_customer_c_acctbal#3632 AS cval_customer_c_acctbal_2#3647, cval_customer_c_comment#3633 AS cval_customer_c_comment_2#3648, cval_customer_c_mktsegment#3634 AS cval_customer_c_mktsegment_2#3649, cc_name#3635 AS cc_name_2#3650, cc_address#3636 AS cc_address_2#3651, cc_phone#3637 AS cc_phone_2#3652, cc_acctbal#3638 AS cc_acctbal_2#3653, cc_comment#3639 AS cc_comment_2#3654, cc_mktsegment#3640 AS cc_mktsegment_2#3655]
         :     :  :  :  :     :  +- Relation[rid#3626,cpfk_nation_customer#3627,cfpk_customer_nation#3628,cval_customer_c_name#3629,cval_customer_c_address#3630,cval_customer_c_phone#3631,cval_customer_c_acctbal#3632,cval_customer_c_comment#3633,cval_customer_c_mktsegment#3634,cc_name#3635,cc_address#3636,cc_phone#3637,cc_acctbal#3638,cc_comment#3639,cc_mktsegment#3640] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :     +- Project [rid#3656 AS rid_3#3673, cpfk_customer_orders#3657 AS cpfk_customer_orders_3#3674, cfpk_orders_customer#3658 AS cfpk_orders_customer_3#3675, cval_orders_o_orderstatus#3659 AS cval_orders_o_orderstatus_3#3676, cval_orders_o_totalprice#3660 AS cval_orders_o_totalprice_3#3677, cval_orders_o_orderpriority#3661 AS cval_orders_o_orderpriority_3#3678, cval_orders_o_clerk#3662 AS cval_orders_o_clerk_3#3679, cval_orders_o_shippriority#3663 AS cval_orders_o_shippriority_3#3680, cval_orders_o_comment#3664 AS cval_orders_o_comment_3#3681, cval_orders_o_orderdate#3665 AS cval_orders_o_orderdate_3#3682, co_orderstatus#3666 AS co_orderstatus_3#3683, co_totalprice#3667 AS co_totalprice_3#3684, co_orderpriority#3668 AS co_orderpriority_3#3685, co_clerk#3669 AS co_clerk_3#3686, co_shippriority#3670 AS co_shippriority_3#3687, co_comment#3671 AS co_comment_3#3688, co_orderdate#3672 AS co_orderdate_3#3689]
         :     :  :  :  :        +- Relation[rid#3656,cpfk_customer_orders#3657,cfpk_orders_customer#3658,cval_orders_o_orderstatus#3659,cval_orders_o_totalprice#3660,cval_orders_o_orderpriority#3661,cval_orders_o_clerk#3662,cval_orders_o_shippriority#3663,cval_orders_o_comment#3664,cval_orders_o_orderdate#3665,co_orderstatus#3666,co_totalprice#3667,co_orderpriority#3668,co_clerk#3669,co_shippriority#3670,co_comment#3671,co_orderdate#3672] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#3592 AS rid_3#3609, cpfk_customer_orders#3593 AS cpfk_customer_orders_3#3610, cfpk_orders_customer#3594 AS cfpk_orders_customer_3#3611, cval_orders_o_orderstatus#3595 AS cval_orders_o_orderstatus_3#3612, cval_orders_o_totalprice#3596 AS cval_orders_o_totalprice_3#3613, cval_orders_o_orderpriority#3597 AS cval_orders_o_orderpriority_3#3614, cval_orders_o_clerk#3598 AS cval_orders_o_clerk_3#3615, cval_orders_o_shippriority#3599 AS cval_orders_o_shippriority_3#3616, cval_orders_o_comment#3600 AS cval_orders_o_comment_3#3617, cval_orders_o_orderdate#3601 AS cval_orders_o_orderdate_3#3618, co_orderstatus#3602 AS co_orderstatus_3#3619, co_totalprice#3603 AS co_totalprice_3#3620, co_orderpriority#3604 AS co_orderpriority_3#3621, co_clerk#3605 AS co_clerk_3#3622, co_shippriority#3606 AS co_shippriority_3#3623, co_comment#3607 AS co_comment_3#3624, co_orderdate#3608 AS co_orderdate_3#3625]
         :     :  :  :     +- Relation[rid#3592,cpfk_customer_orders#3593,cfpk_orders_customer#3594,cval_orders_o_orderstatus#3595,cval_orders_o_totalprice#3596,cval_orders_o_orderpriority#3597,cval_orders_o_clerk#3598,cval_orders_o_shippriority#3599,cval_orders_o_comment#3600,cval_orders_o_orderdate#3601,co_orderstatus#3602,co_totalprice#3603,co_orderpriority#3604,co_clerk#3605,co_shippriority#3606,co_comment#3607,co_orderdate#3608] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :     :- Project [rid#3756 AS rid_3#3773, cpfk_customer_orders#3757 AS cpfk_customer_orders_3#3774, cfpk_orders_customer#3758 AS cfpk_orders_customer_3#3775, cval_orders_o_orderstatus#3759 AS cval_orders_o_orderstatus_3#3776, cval_orders_o_totalprice#3760 AS cval_orders_o_totalprice_3#3777, cval_orders_o_orderpriority#3761 AS cval_orders_o_orderpriority_3#3778, cval_orders_o_clerk#3762 AS cval_orders_o_clerk_3#3779, cval_orders_o_shippriority#3763 AS cval_orders_o_shippriority_3#3780, cval_orders_o_comment#3764 AS cval_orders_o_comment_3#3781, cval_orders_o_orderdate#3765 AS cval_orders_o_orderdate_3#3782, co_orderstatus#3766 AS co_orderstatus_3#3783, co_totalprice#3767 AS co_totalprice_3#3784, co_orderpriority#3768 AS co_orderpriority_3#3785, co_clerk#3769 AS co_clerk_3#3786, co_shippriority#3770 AS co_shippriority_3#3787, co_comment#3771 AS co_comment_3#3788, co_orderdate#3772 AS co_orderdate_3#3789]
         :     :  :     :  +- Relation[rid#3756,cpfk_customer_orders#3757,cfpk_orders_customer#3758,cval_orders_o_orderstatus#3759,cval_orders_o_totalprice#3760,cval_orders_o_orderpriority#3761,cval_orders_o_clerk#3762,cval_orders_o_shippriority#3763,cval_orders_o_comment#3764,cval_orders_o_orderdate#3765,co_orderstatus#3766,co_totalprice#3767,co_orderpriority#3768,co_clerk#3769,co_shippriority#3770,co_comment#3771,co_orderdate#3772] JDBCRelation(torders) [numPartitions=1]
         :     :  :     +- Project [rid#3790 AS rid_4#3823, cpfk_orders_lineitem#3791 AS cpfk_orders_lineitem_4#3824, cpfk_supplier_lineitem#3792 AS cpfk_supplier_lineitem_4#3825, cfpk_lineitem_supplier#3793 AS cfpk_lineitem_supplier_4#3826, cfpk_lineitem_partsupp#3794 AS cfpk_lineitem_partsupp_4#3827, cpfk_part_lineitem#3795 AS cpfk_part_lineitem_4#3828, cfpk_lineitem_part#3796 AS cfpk_lineitem_part_4#3829, cpfk_partsupp_lineitem#3797 AS cpfk_partsupp_lineitem_4#3830, cfpk_lineitem_orders#3798 AS cfpk_lineitem_orders_4#3831, cval_lineitem_l_quantity#3799 AS cval_lineitem_l_quantity_4#3832, cval_lineitem_l_extendedprice#3800 AS cval_lineitem_l_extendedprice_4#3833, cval_lineitem_l_discount#3801 AS cval_lineitem_l_discount_4#3834, cval_lineitem_l_tax#3802 AS cval_lineitem_l_tax_4#3835, cval_lineitem_l_returnflag#3803 AS cval_lineitem_l_returnflag_4#3836, cval_lineitem_l_linestatus#3804 AS cval_lineitem_l_linestatus_4#3837, cval_lineitem_l_commitdate#3805 AS cval_lineitem_l_commitdate_4#3838, cval_lineitem_l_receiptdate#3806 AS cval_lineitem_l_receiptdate_4#3839, cval_lineitem_l_shipinstruct#3807 AS cval_lineitem_l_shipinstruct_4#3840, cval_lineitem_l_shipmode#3808 AS cval_lineitem_l_shipmode_4#3841, cval_lineitem_l_comment#3809 AS cval_lineitem_l_comment_4#3842, cval_lineitem_l_shipdate#3810 AS cval_lineitem_l_shipdate_4#3843, cl_quantity#3811 AS cl_quantity_4#3844, cl_extendedprice#3812 AS cl_extendedprice_4#3845, cl_discount#3813 AS cl_discount_4#3846, ... 9 more fields]
         :     :  :        +- Relation[rid#3790,cpfk_orders_lineitem#3791,cpfk_supplier_lineitem#3792,cfpk_lineitem_supplier#3793,cfpk_lineitem_partsupp#3794,cpfk_part_lineitem#3795,cfpk_lineitem_part#3796,cpfk_partsupp_lineitem#3797,cfpk_lineitem_orders#3798,cval_lineitem_l_quantity#3799,cval_lineitem_l_extendedprice#3800,cval_lineitem_l_discount#3801,cval_lineitem_l_tax#3802,cval_lineitem_l_returnflag#3803,cval_lineitem_l_linestatus#3804,cval_lineitem_l_commitdate#3805,cval_lineitem_l_receiptdate#3806,cval_lineitem_l_shipinstruct#3807,cval_lineitem_l_shipmode#3808,cval_lineitem_l_comment#3809,cval_lineitem_l_shipdate#3810,cl_quantity#3811,cl_extendedprice#3812,cl_discount#3813,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#3690 AS rid_4#3723, cpfk_orders_lineitem#3691 AS cpfk_orders_lineitem_4#3724, cpfk_supplier_lineitem#3692 AS cpfk_supplier_lineitem_4#3725, cfpk_lineitem_supplier#3693 AS cfpk_lineitem_supplier_4#3726, cfpk_lineitem_partsupp#3694 AS cfpk_lineitem_partsupp_4#3727, cpfk_part_lineitem#3695 AS cpfk_part_lineitem_4#3728, cfpk_lineitem_part#3696 AS cfpk_lineitem_part_4#3729, cpfk_partsupp_lineitem#3697 AS cpfk_partsupp_lineitem_4#3730, cfpk_lineitem_orders#3698 AS cfpk_lineitem_orders_4#3731, cval_lineitem_l_quantity#3699 AS cval_lineitem_l_quantity_4#3732, cval_lineitem_l_extendedprice#3700 AS cval_lineitem_l_extendedprice_4#3733, cval_lineitem_l_discount#3701 AS cval_lineitem_l_discount_4#3734, cval_lineitem_l_tax#3702 AS cval_lineitem_l_tax_4#3735, cval_lineitem_l_returnflag#3703 AS cval_lineitem_l_returnflag_4#3736, cval_lineitem_l_linestatus#3704 AS cval_lineitem_l_linestatus_4#3737, cval_lineitem_l_commitdate#3705 AS cval_lineitem_l_commitdate_4#3738, cval_lineitem_l_receiptdate#3706 AS cval_lineitem_l_receiptdate_4#3739, cval_lineitem_l_shipinstruct#3707 AS cval_lineitem_l_shipinstruct_4#3740, cval_lineitem_l_shipmode#3708 AS cval_lineitem_l_shipmode_4#3741, cval_lineitem_l_comment#3709 AS cval_lineitem_l_comment_4#3742, cval_lineitem_l_shipdate#3710 AS cval_lineitem_l_shipdate_4#3743, cl_quantity#3711 AS cl_quantity_4#3744, cl_extendedprice#3712 AS cl_extendedprice_4#3745, cl_discount#3713 AS cl_discount_4#3746, ... 9 more fields]
         :     :     +- Relation[rid#3690,cpfk_orders_lineitem#3691,cpfk_supplier_lineitem#3692,cfpk_lineitem_supplier#3693,cfpk_lineitem_partsupp#3694,cpfk_part_lineitem#3695,cfpk_lineitem_part#3696,cpfk_partsupp_lineitem#3697,cfpk_lineitem_orders#3698,cval_lineitem_l_quantity#3699,cval_lineitem_l_extendedprice#3700,cval_lineitem_l_discount#3701,cval_lineitem_l_tax#3702,cval_lineitem_l_returnflag#3703,cval_lineitem_l_linestatus#3704,cval_lineitem_l_commitdate#3705,cval_lineitem_l_receiptdate#3706,cval_lineitem_l_shipinstruct#3707,cval_lineitem_l_shipmode#3708,cval_lineitem_l_comment#3709,cval_lineitem_l_shipdate#3710,cl_quantity#3711,cl_extendedprice#3712,cl_discount#3713,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#3856 AS rid_5#3869, cpfk_nation_supplier#3857 AS cpfk_nation_supplier_5#3870, cfpk_supplier_nation#3858 AS cfpk_supplier_nation_5#3871, cval_supplier_s_name#3859 AS cval_supplier_s_name_5#3872, cval_supplier_s_address#3860 AS cval_supplier_s_address_5#3873, cval_supplier_s_phone#3861 AS cval_supplier_s_phone_5#3874, cval_supplier_s_acctbal#3862 AS cval_supplier_s_acctbal_5#3875, cval_supplier_s_comment#3863 AS cval_supplier_s_comment_5#3876, cs_name#3864 AS cs_name_5#3877, cs_address#3865 AS cs_address_5#3878, cs_phone#3866 AS cs_phone_5#3879, cs_acctbal#3867 AS cs_acctbal_5#3880, cs_comment#3868 AS cs_comment_5#3881]
         :        +- Relation[rid#3856,cpfk_nation_supplier#3857,cfpk_supplier_nation#3858,cval_supplier_s_name#3859,cval_supplier_s_address#3860,cval_supplier_s_phone#3861,cval_supplier_s_acctbal#3862,cval_supplier_s_comment#3863,cs_name#3864,cs_address#3865,cs_phone#3866,cs_acctbal#3867,cs_comment#3868] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#3882 AS rid_1#3889, cpfk_region_nation#3883 AS cpfk_region_nation_1#3890, cfpk_nation_region#3884 AS cfpk_nation_region_1#3891, cval_nation_n_name#3885 AS cval_nation_n_name_1#3892, cval_nation_n_comment#3886 AS cval_nation_n_comment_1#3893, cn_name#3887 AS cn_name_1#3894, cn_comment#3888 AS cn_comment_1#3895]
            :  +- Relation[rid#3882,cpfk_region_nation#3883,cfpk_nation_region#3884,cval_nation_n_name#3885,cval_nation_n_comment#3886,cn_name#3887,cn_comment#3888] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#3896 AS rid_5#3909, cpfk_nation_supplier#3897 AS cpfk_nation_supplier_5#3910, cfpk_supplier_nation#3898 AS cfpk_supplier_nation_5#3911, cval_supplier_s_name#3899 AS cval_supplier_s_name_5#3912, cval_supplier_s_address#3900 AS cval_supplier_s_address_5#3913, cval_supplier_s_phone#3901 AS cval_supplier_s_phone_5#3914, cval_supplier_s_acctbal#3902 AS cval_supplier_s_acctbal_5#3915, cval_supplier_s_comment#3903 AS cval_supplier_s_comment_5#3916, cs_name#3904 AS cs_name_5#3917, cs_address#3905 AS cs_address_5#3918, cs_phone#3906 AS cs_phone_5#3919, cs_acctbal#3907 AS cs_acctbal_5#3920, cs_comment#3908 AS cs_comment_5#3921]
               +- Relation[rid#3896,cpfk_nation_supplier#3897,cfpk_supplier_nation#3898,cval_supplier_s_name#3899,cval_supplier_s_address#3900,cval_supplier_s_phone#3901,cval_supplier_s_acctbal#3902,cval_supplier_s_comment#3903,cs_name#3904,cs_address#3905,cs_phone#3906,cs_acctbal#3907,cs_comment#3908] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1206514
Elapsed time: 165720ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/11 05:47:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:47:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4024L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 05:47:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:47:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:47:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4024L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#4026 AS rid_0#4059, cpfk_orders_lineitem#4027 AS cpfk_orders_lineitem_0#4060, cpfk_supplier_lineitem#4028 AS cpfk_supplier_lineitem_0#4061, cfpk_lineitem_supplier#4029 AS cfpk_lineitem_supplier_0#4062, cfpk_lineitem_partsupp#4030 AS cfpk_lineitem_partsupp_0#4063, cpfk_part_lineitem#4031 AS cpfk_part_lineitem_0#4064, cfpk_lineitem_part#4032 AS cfpk_lineitem_part_0#4065, cpfk_partsupp_lineitem#4033 AS cpfk_partsupp_lineitem_0#4066, cfpk_lineitem_orders#4034 AS cfpk_lineitem_orders_0#4067, cval_lineitem_l_quantity#4035 AS cval_lineitem_l_quantity_0#4068, cval_lineitem_l_extendedprice#4036 AS cval_lineitem_l_extendedprice_0#4069, cval_lineitem_l_discount#4037 AS cval_lineitem_l_discount_0#4070, cval_lineitem_l_tax#4038 AS cval_lineitem_l_tax_0#4071, cval_lineitem_l_returnflag#4039 AS cval_lineitem_l_returnflag_0#4072, cval_lineitem_l_linestatus#4040 AS cval_lineitem_l_linestatus_0#4073, cval_lineitem_l_commitdate#4041 AS cval_lineitem_l_commitdate_0#4074, cval_lineitem_l_receiptdate#4042 AS cval_lineitem_l_receiptdate_0#4075, cval_lineitem_l_shipinstruct#4043 AS cval_lineitem_l_shipinstruct_0#4076, cval_lineitem_l_shipmode#4044 AS cval_lineitem_l_shipmode_0#4077, cval_lineitem_l_comment#4045 AS cval_lineitem_l_comment_0#4078, cval_lineitem_l_shipdate#4046 AS cval_lineitem_l_shipdate_0#4079, cl_quantity#4047 AS cl_quantity_0#4080, cl_extendedprice#4048 AS cl_extendedprice_0#4081, cl_discount#4049 AS cl_discount_0#4082, ... 9 more fields]
            :     :     :  :  +- Relation[rid#4026,cpfk_orders_lineitem#4027,cpfk_supplier_lineitem#4028,cfpk_lineitem_supplier#4029,cfpk_lineitem_partsupp#4030,cpfk_part_lineitem#4031,cfpk_lineitem_part#4032,cpfk_partsupp_lineitem#4033,cfpk_lineitem_orders#4034,cval_lineitem_l_quantity#4035,cval_lineitem_l_extendedprice#4036,cval_lineitem_l_discount#4037,cval_lineitem_l_tax#4038,cval_lineitem_l_returnflag#4039,cval_lineitem_l_linestatus#4040,cval_lineitem_l_commitdate#4041,cval_lineitem_l_receiptdate#4042,cval_lineitem_l_shipinstruct#4043,cval_lineitem_l_shipmode#4044,cval_lineitem_l_comment#4045,cval_lineitem_l_shipdate#4046,cl_quantity#4047,cl_extendedprice#4048,cl_discount#4049,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#4092 AS rid_0#4125, cpfk_orders_lineitem#4093 AS cpfk_orders_lineitem_0#4126, cpfk_supplier_lineitem#4094 AS cpfk_supplier_lineitem_0#4127, cfpk_lineitem_supplier#4095 AS cfpk_lineitem_supplier_0#4128, cfpk_lineitem_partsupp#4096 AS cfpk_lineitem_partsupp_0#4129, cpfk_part_lineitem#4097 AS cpfk_part_lineitem_0#4130, cfpk_lineitem_part#4098 AS cfpk_lineitem_part_0#4131, cpfk_partsupp_lineitem#4099 AS cpfk_partsupp_lineitem_0#4132, cfpk_lineitem_orders#4100 AS cfpk_lineitem_orders_0#4133, cval_lineitem_l_quantity#4101 AS cval_lineitem_l_quantity_0#4134, cval_lineitem_l_extendedprice#4102 AS cval_lineitem_l_extendedprice_0#4135, cval_lineitem_l_discount#4103 AS cval_lineitem_l_discount_0#4136, cval_lineitem_l_tax#4104 AS cval_lineitem_l_tax_0#4137, cval_lineitem_l_returnflag#4105 AS cval_lineitem_l_returnflag_0#4138, cval_lineitem_l_linestatus#4106 AS cval_lineitem_l_linestatus_0#4139, cval_lineitem_l_commitdate#4107 AS cval_lineitem_l_commitdate_0#4140, cval_lineitem_l_receiptdate#4108 AS cval_lineitem_l_receiptdate_0#4141, cval_lineitem_l_shipinstruct#4109 AS cval_lineitem_l_shipinstruct_0#4142, cval_lineitem_l_shipmode#4110 AS cval_lineitem_l_shipmode_0#4143, cval_lineitem_l_comment#4111 AS cval_lineitem_l_comment_0#4144, cval_lineitem_l_shipdate#4112 AS cval_lineitem_l_shipdate_0#4145, cl_quantity#4113 AS cl_quantity_0#4146, cl_extendedprice#4114 AS cl_extendedprice_0#4147, cl_discount#4115 AS cl_discount_0#4148, ... 9 more fields]
            :     :     :        +- Relation[rid#4092,cpfk_orders_lineitem#4093,cpfk_supplier_lineitem#4094,cfpk_lineitem_supplier#4095,cfpk_lineitem_partsupp#4096,cpfk_part_lineitem#4097,cfpk_lineitem_part#4098,cpfk_partsupp_lineitem#4099,cfpk_lineitem_orders#4100,cval_lineitem_l_quantity#4101,cval_lineitem_l_extendedprice#4102,cval_lineitem_l_discount#4103,cval_lineitem_l_tax#4104,cval_lineitem_l_returnflag#4105,cval_lineitem_l_linestatus#4106,cval_lineitem_l_commitdate#4107,cval_lineitem_l_receiptdate#4108,cval_lineitem_l_shipinstruct#4109,cval_lineitem_l_shipmode#4110,cval_lineitem_l_comment#4111,cval_lineitem_l_shipdate#4112,cl_quantity#4113,cl_extendedprice#4114,cl_discount#4115,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#4158 AS rid_1#4175, cpfk_customer_orders#4159 AS cpfk_customer_orders_1#4176, cfpk_orders_customer#4160 AS cfpk_orders_customer_1#4177, cval_orders_o_orderstatus#4161 AS cval_orders_o_orderstatus_1#4178, cval_orders_o_totalprice#4162 AS cval_orders_o_totalprice_1#4179, cval_orders_o_orderpriority#4163 AS cval_orders_o_orderpriority_1#4180, cval_orders_o_clerk#4164 AS cval_orders_o_clerk_1#4181, cval_orders_o_shippriority#4165 AS cval_orders_o_shippriority_1#4182, cval_orders_o_comment#4166 AS cval_orders_o_comment_1#4183, cval_orders_o_orderdate#4167 AS cval_orders_o_orderdate_1#4184, co_orderstatus#4168 AS co_orderstatus_1#4185, co_totalprice#4169 AS co_totalprice_1#4186, co_orderpriority#4170 AS co_orderpriority_1#4187, co_clerk#4171 AS co_clerk_1#4188, co_shippriority#4172 AS co_shippriority_1#4189, co_comment#4173 AS co_comment_1#4190, co_orderdate#4174 AS co_orderdate_1#4191]
            :     :        +- Relation[rid#4158,cpfk_customer_orders#4159,cfpk_orders_customer#4160,cval_orders_o_orderstatus#4161,cval_orders_o_totalprice#4162,cval_orders_o_orderpriority#4163,cval_orders_o_clerk#4164,cval_orders_o_shippriority#4165,cval_orders_o_comment#4166,cval_orders_o_orderdate#4167,co_orderstatus#4168,co_totalprice#4169,co_orderpriority#4170,co_clerk#4171,co_shippriority#4172,co_comment#4173,co_orderdate#4174] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#4192 AS rid_2#4207, cpfk_nation_customer#4193 AS cpfk_nation_customer_2#4208, cfpk_customer_nation#4194 AS cfpk_customer_nation_2#4209, cval_customer_c_name#4195 AS cval_customer_c_name_2#4210, cval_customer_c_address#4196 AS cval_customer_c_address_2#4211, cval_customer_c_phone#4197 AS cval_customer_c_phone_2#4212, cval_customer_c_acctbal#4198 AS cval_customer_c_acctbal_2#4213, cval_customer_c_comment#4199 AS cval_customer_c_comment_2#4214, cval_customer_c_mktsegment#4200 AS cval_customer_c_mktsegment_2#4215, cc_name#4201 AS cc_name_2#4216, cc_address#4202 AS cc_address_2#4217, cc_phone#4203 AS cc_phone_2#4218, cc_acctbal#4204 AS cc_acctbal_2#4219, cc_comment#4205 AS cc_comment_2#4220, cc_mktsegment#4206 AS cc_mktsegment_2#4221]
            :        +- Relation[rid#4192,cpfk_nation_customer#4193,cfpk_customer_nation#4194,cval_customer_c_name#4195,cval_customer_c_address#4196,cval_customer_c_phone#4197,cval_customer_c_acctbal#4198,cval_customer_c_comment#4199,cval_customer_c_mktsegment#4200,cc_name#4201,cc_address#4202,cc_phone#4203,cc_acctbal#4204,cc_comment#4205,cc_mktsegment#4206] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#4222 AS rid_3#4229, cpfk_region_nation#4223 AS cpfk_region_nation_3#4230, cfpk_nation_region#4224 AS cfpk_nation_region_3#4231, cval_nation_n_name#4225 AS cval_nation_n_name_3#4232, cval_nation_n_comment#4226 AS cval_nation_n_comment_3#4233, cn_name#4227 AS cn_name_3#4234, cn_comment#4228 AS cn_comment_3#4235]
               +- Relation[rid#4222,cpfk_region_nation#4223,cfpk_nation_region#4224,cval_nation_n_name#4225,cval_nation_n_comment#4226,cn_name#4227,cn_comment#4228] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 61492ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/11 05:48:44 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:48:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4314L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 05:48:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4314L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#4316 AS rid_0#4333, cval_part_p_name#4317 AS cval_part_p_name_0#4334, cval_part_p_mfgr#4318 AS cval_part_p_mfgr_0#4335, cval_part_p_type#4319 AS cval_part_p_type_0#4336, cval_part_p_size#4320 AS cval_part_p_size_0#4337, cval_part_p_container#4321 AS cval_part_p_container_0#4338, cval_part_p_retailprice#4322 AS cval_part_p_retailprice_0#4339, cval_part_p_comment#4323 AS cval_part_p_comment_0#4340, cval_part_p_brand#4324 AS cval_part_p_brand_0#4341, cp_name#4325 AS cp_name_0#4342, cp_mfgr#4326 AS cp_mfgr_0#4343, cp_type#4327 AS cp_type_0#4344, cp_size#4328 AS cp_size_0#4345, cp_container#4329 AS cp_container_0#4346, cp_retailprice#4330 AS cp_retailprice_0#4347, cp_comment#4331 AS cp_comment_0#4348, cp_brand#4332 AS cp_brand_0#4349]
         :  :  +- Relation[rid#4316,cval_part_p_name#4317,cval_part_p_mfgr#4318,cval_part_p_type#4319,cval_part_p_size#4320,cval_part_p_container#4321,cval_part_p_retailprice#4322,cval_part_p_comment#4323,cval_part_p_brand#4324,cp_name#4325,cp_mfgr#4326,cp_type#4327,cp_size#4328,cp_container#4329,cp_retailprice#4330,cp_comment#4331,cp_brand#4332] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#4416 AS rid_0#4433, cval_part_p_name#4417 AS cval_part_p_name_0#4434, cval_part_p_mfgr#4418 AS cval_part_p_mfgr_0#4435, cval_part_p_type#4419 AS cval_part_p_type_0#4436, cval_part_p_size#4420 AS cval_part_p_size_0#4437, cval_part_p_container#4421 AS cval_part_p_container_0#4438, cval_part_p_retailprice#4422 AS cval_part_p_retailprice_0#4439, cval_part_p_comment#4423 AS cval_part_p_comment_0#4440, cval_part_p_brand#4424 AS cval_part_p_brand_0#4441, cp_name#4425 AS cp_name_0#4442, cp_mfgr#4426 AS cp_mfgr_0#4443, cp_type#4427 AS cp_type_0#4444, cp_size#4428 AS cp_size_0#4445, cp_container#4429 AS cp_container_0#4446, cp_retailprice#4430 AS cp_retailprice_0#4447, cp_comment#4431 AS cp_comment_0#4448, cp_brand#4432 AS cp_brand_0#4449]
         :     :  +- Relation[rid#4416,cval_part_p_name#4417,cval_part_p_mfgr#4418,cval_part_p_type#4419,cval_part_p_size#4420,cval_part_p_container#4421,cval_part_p_retailprice#4422,cval_part_p_comment#4423,cval_part_p_brand#4424,cp_name#4425,cp_mfgr#4426,cp_type#4427,cp_size#4428,cp_container#4429,cp_retailprice#4430,cp_comment#4431,cp_brand#4432] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#4450 AS rid_1#4483, cpfk_orders_lineitem#4451 AS cpfk_orders_lineitem_1#4484, cpfk_supplier_lineitem#4452 AS cpfk_supplier_lineitem_1#4485, cfpk_lineitem_supplier#4453 AS cfpk_lineitem_supplier_1#4486, cfpk_lineitem_partsupp#4454 AS cfpk_lineitem_partsupp_1#4487, cpfk_part_lineitem#4455 AS cpfk_part_lineitem_1#4488, cfpk_lineitem_part#4456 AS cfpk_lineitem_part_1#4489, cpfk_partsupp_lineitem#4457 AS cpfk_partsupp_lineitem_1#4490, cfpk_lineitem_orders#4458 AS cfpk_lineitem_orders_1#4491, cval_lineitem_l_quantity#4459 AS cval_lineitem_l_quantity_1#4492, cval_lineitem_l_extendedprice#4460 AS cval_lineitem_l_extendedprice_1#4493, cval_lineitem_l_discount#4461 AS cval_lineitem_l_discount_1#4494, cval_lineitem_l_tax#4462 AS cval_lineitem_l_tax_1#4495, cval_lineitem_l_returnflag#4463 AS cval_lineitem_l_returnflag_1#4496, cval_lineitem_l_linestatus#4464 AS cval_lineitem_l_linestatus_1#4497, cval_lineitem_l_commitdate#4465 AS cval_lineitem_l_commitdate_1#4498, cval_lineitem_l_receiptdate#4466 AS cval_lineitem_l_receiptdate_1#4499, cval_lineitem_l_shipinstruct#4467 AS cval_lineitem_l_shipinstruct_1#4500, cval_lineitem_l_shipmode#4468 AS cval_lineitem_l_shipmode_1#4501, cval_lineitem_l_comment#4469 AS cval_lineitem_l_comment_1#4502, cval_lineitem_l_shipdate#4470 AS cval_lineitem_l_shipdate_1#4503, cl_quantity#4471 AS cl_quantity_1#4504, cl_extendedprice#4472 AS cl_extendedprice_1#4505, cl_discount#4473 AS cl_discount_1#4506, ... 9 more fields]
         :        +- Relation[rid#4450,cpfk_orders_lineitem#4451,cpfk_supplier_lineitem#4452,cfpk_lineitem_supplier#4453,cfpk_lineitem_partsupp#4454,cpfk_part_lineitem#4455,cfpk_lineitem_part#4456,cpfk_partsupp_lineitem#4457,cfpk_lineitem_orders#4458,cval_lineitem_l_quantity#4459,cval_lineitem_l_extendedprice#4460,cval_lineitem_l_discount#4461,cval_lineitem_l_tax#4462,cval_lineitem_l_returnflag#4463,cval_lineitem_l_linestatus#4464,cval_lineitem_l_commitdate#4465,cval_lineitem_l_receiptdate#4466,cval_lineitem_l_shipinstruct#4467,cval_lineitem_l_shipmode#4468,cval_lineitem_l_comment#4469,cval_lineitem_l_shipdate#4470,cl_quantity#4471,cl_extendedprice#4472,cl_discount#4473,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4350 AS rid_1#4383, cpfk_orders_lineitem#4351 AS cpfk_orders_lineitem_1#4384, cpfk_supplier_lineitem#4352 AS cpfk_supplier_lineitem_1#4385, cfpk_lineitem_supplier#4353 AS cfpk_lineitem_supplier_1#4386, cfpk_lineitem_partsupp#4354 AS cfpk_lineitem_partsupp_1#4387, cpfk_part_lineitem#4355 AS cpfk_part_lineitem_1#4388, cfpk_lineitem_part#4356 AS cfpk_lineitem_part_1#4389, cpfk_partsupp_lineitem#4357 AS cpfk_partsupp_lineitem_1#4390, cfpk_lineitem_orders#4358 AS cfpk_lineitem_orders_1#4391, cval_lineitem_l_quantity#4359 AS cval_lineitem_l_quantity_1#4392, cval_lineitem_l_extendedprice#4360 AS cval_lineitem_l_extendedprice_1#4393, cval_lineitem_l_discount#4361 AS cval_lineitem_l_discount_1#4394, cval_lineitem_l_tax#4362 AS cval_lineitem_l_tax_1#4395, cval_lineitem_l_returnflag#4363 AS cval_lineitem_l_returnflag_1#4396, cval_lineitem_l_linestatus#4364 AS cval_lineitem_l_linestatus_1#4397, cval_lineitem_l_commitdate#4365 AS cval_lineitem_l_commitdate_1#4398, cval_lineitem_l_receiptdate#4366 AS cval_lineitem_l_receiptdate_1#4399, cval_lineitem_l_shipinstruct#4367 AS cval_lineitem_l_shipinstruct_1#4400, cval_lineitem_l_shipmode#4368 AS cval_lineitem_l_shipmode_1#4401, cval_lineitem_l_comment#4369 AS cval_lineitem_l_comment_1#4402, cval_lineitem_l_shipdate#4370 AS cval_lineitem_l_shipdate_1#4403, cl_quantity#4371 AS cl_quantity_1#4404, cl_extendedprice#4372 AS cl_extendedprice_1#4405, cl_discount#4373 AS cl_discount_1#4406, ... 9 more fields]
            +- Relation[rid#4350,cpfk_orders_lineitem#4351,cpfk_supplier_lineitem#4352,cfpk_lineitem_supplier#4353,cfpk_lineitem_partsupp#4354,cpfk_part_lineitem#4355,cfpk_lineitem_part#4356,cpfk_partsupp_lineitem#4357,cfpk_lineitem_orders#4358,cval_lineitem_l_quantity#4359,cval_lineitem_l_extendedprice#4360,cval_lineitem_l_discount#4361,cval_lineitem_l_tax#4362,cval_lineitem_l_returnflag#4363,cval_lineitem_l_linestatus#4364,cval_lineitem_l_commitdate#4365,cval_lineitem_l_receiptdate#4366,cval_lineitem_l_shipinstruct#4367,cval_lineitem_l_shipmode#4368,cval_lineitem_l_comment#4369,cval_lineitem_l_shipdate#4370,cl_quantity#4371,cl_extendedprice#4372,cl_discount#4373,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 83544ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/11 05:50:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:50:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4570L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 05:50:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4570L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#4572 AS rid_0#4605, cpfk_orders_lineitem#4573 AS cpfk_orders_lineitem_0#4606, cpfk_supplier_lineitem#4574 AS cpfk_supplier_lineitem_0#4607, cfpk_lineitem_supplier#4575 AS cfpk_lineitem_supplier_0#4608, cfpk_lineitem_partsupp#4576 AS cfpk_lineitem_partsupp_0#4609, cpfk_part_lineitem#4577 AS cpfk_part_lineitem_0#4610, cfpk_lineitem_part#4578 AS cfpk_lineitem_part_0#4611, cpfk_partsupp_lineitem#4579 AS cpfk_partsupp_lineitem_0#4612, cfpk_lineitem_orders#4580 AS cfpk_lineitem_orders_0#4613, cval_lineitem_l_quantity#4581 AS cval_lineitem_l_quantity_0#4614, cval_lineitem_l_extendedprice#4582 AS cval_lineitem_l_extendedprice_0#4615, cval_lineitem_l_discount#4583 AS cval_lineitem_l_discount_0#4616, cval_lineitem_l_tax#4584 AS cval_lineitem_l_tax_0#4617, cval_lineitem_l_returnflag#4585 AS cval_lineitem_l_returnflag_0#4618, cval_lineitem_l_linestatus#4586 AS cval_lineitem_l_linestatus_0#4619, cval_lineitem_l_commitdate#4587 AS cval_lineitem_l_commitdate_0#4620, cval_lineitem_l_receiptdate#4588 AS cval_lineitem_l_receiptdate_0#4621, cval_lineitem_l_shipinstruct#4589 AS cval_lineitem_l_shipinstruct_0#4622, cval_lineitem_l_shipmode#4590 AS cval_lineitem_l_shipmode_0#4623, cval_lineitem_l_comment#4591 AS cval_lineitem_l_comment_0#4624, cval_lineitem_l_shipdate#4592 AS cval_lineitem_l_shipdate_0#4625, cl_quantity#4593 AS cl_quantity_0#4626, cl_extendedprice#4594 AS cl_extendedprice_0#4627, cl_discount#4595 AS cl_discount_0#4628, ... 9 more fields]
            :  :  +- Relation[rid#4572,cpfk_orders_lineitem#4573,cpfk_supplier_lineitem#4574,cfpk_lineitem_supplier#4575,cfpk_lineitem_partsupp#4576,cpfk_part_lineitem#4577,cfpk_lineitem_part#4578,cpfk_partsupp_lineitem#4579,cfpk_lineitem_orders#4580,cval_lineitem_l_quantity#4581,cval_lineitem_l_extendedprice#4582,cval_lineitem_l_discount#4583,cval_lineitem_l_tax#4584,cval_lineitem_l_returnflag#4585,cval_lineitem_l_linestatus#4586,cval_lineitem_l_commitdate#4587,cval_lineitem_l_receiptdate#4588,cval_lineitem_l_shipinstruct#4589,cval_lineitem_l_shipmode#4590,cval_lineitem_l_comment#4591,cval_lineitem_l_shipdate#4592,cl_quantity#4593,cl_extendedprice#4594,cl_discount#4595,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#4638 AS rid_0#4671, cpfk_orders_lineitem#4639 AS cpfk_orders_lineitem_0#4672, cpfk_supplier_lineitem#4640 AS cpfk_supplier_lineitem_0#4673, cfpk_lineitem_supplier#4641 AS cfpk_lineitem_supplier_0#4674, cfpk_lineitem_partsupp#4642 AS cfpk_lineitem_partsupp_0#4675, cpfk_part_lineitem#4643 AS cpfk_part_lineitem_0#4676, cfpk_lineitem_part#4644 AS cfpk_lineitem_part_0#4677, cpfk_partsupp_lineitem#4645 AS cpfk_partsupp_lineitem_0#4678, cfpk_lineitem_orders#4646 AS cfpk_lineitem_orders_0#4679, cval_lineitem_l_quantity#4647 AS cval_lineitem_l_quantity_0#4680, cval_lineitem_l_extendedprice#4648 AS cval_lineitem_l_extendedprice_0#4681, cval_lineitem_l_discount#4649 AS cval_lineitem_l_discount_0#4682, cval_lineitem_l_tax#4650 AS cval_lineitem_l_tax_0#4683, cval_lineitem_l_returnflag#4651 AS cval_lineitem_l_returnflag_0#4684, cval_lineitem_l_linestatus#4652 AS cval_lineitem_l_linestatus_0#4685, cval_lineitem_l_commitdate#4653 AS cval_lineitem_l_commitdate_0#4686, cval_lineitem_l_receiptdate#4654 AS cval_lineitem_l_receiptdate_0#4687, cval_lineitem_l_shipinstruct#4655 AS cval_lineitem_l_shipinstruct_0#4688, cval_lineitem_l_shipmode#4656 AS cval_lineitem_l_shipmode_0#4689, cval_lineitem_l_comment#4657 AS cval_lineitem_l_comment_0#4690, cval_lineitem_l_shipdate#4658 AS cval_lineitem_l_shipdate_0#4691, cl_quantity#4659 AS cl_quantity_0#4692, cl_extendedprice#4660 AS cl_extendedprice_0#4693, cl_discount#4661 AS cl_discount_0#4694, ... 9 more fields]
            :        +- Relation[rid#4638,cpfk_orders_lineitem#4639,cpfk_supplier_lineitem#4640,cfpk_lineitem_supplier#4641,cfpk_lineitem_partsupp#4642,cpfk_part_lineitem#4643,cfpk_lineitem_part#4644,cpfk_partsupp_lineitem#4645,cfpk_lineitem_orders#4646,cval_lineitem_l_quantity#4647,cval_lineitem_l_extendedprice#4648,cval_lineitem_l_discount#4649,cval_lineitem_l_tax#4650,cval_lineitem_l_returnflag#4651,cval_lineitem_l_linestatus#4652,cval_lineitem_l_commitdate#4653,cval_lineitem_l_receiptdate#4654,cval_lineitem_l_shipinstruct#4655,cval_lineitem_l_shipmode#4656,cval_lineitem_l_comment#4657,cval_lineitem_l_shipdate#4658,cl_quantity#4659,cl_extendedprice#4660,cl_discount#4661,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#4704 AS rid_1#4721, cpfk_customer_orders#4705 AS cpfk_customer_orders_1#4722, cfpk_orders_customer#4706 AS cfpk_orders_customer_1#4723, cval_orders_o_orderstatus#4707 AS cval_orders_o_orderstatus_1#4724, cval_orders_o_totalprice#4708 AS cval_orders_o_totalprice_1#4725, cval_orders_o_orderpriority#4709 AS cval_orders_o_orderpriority_1#4726, cval_orders_o_clerk#4710 AS cval_orders_o_clerk_1#4727, cval_orders_o_shippriority#4711 AS cval_orders_o_shippriority_1#4728, cval_orders_o_comment#4712 AS cval_orders_o_comment_1#4729, cval_orders_o_orderdate#4713 AS cval_orders_o_orderdate_1#4730, co_orderstatus#4714 AS co_orderstatus_1#4731, co_totalprice#4715 AS co_totalprice_1#4732, co_orderpriority#4716 AS co_orderpriority_1#4733, co_clerk#4717 AS co_clerk_1#4734, co_shippriority#4718 AS co_shippriority_1#4735, co_comment#4719 AS co_comment_1#4736, co_orderdate#4720 AS co_orderdate_1#4737]
               +- Relation[rid#4704,cpfk_customer_orders#4705,cfpk_orders_customer#4706,cval_orders_o_orderstatus#4707,cval_orders_o_totalprice#4708,cval_orders_o_orderpriority#4709,cval_orders_o_clerk#4710,cval_orders_o_shippriority#4711,cval_orders_o_comment#4712,cval_orders_o_orderdate#4713,co_orderstatus#4714,co_totalprice#4715,co_orderpriority#4716,co_clerk#4717,co_shippriority#4718,co_comment#4719,co_orderdate#4720] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 22806ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/11 05:50:31 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:50:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4794L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 05:50:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:50:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:50:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:50:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:50:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:50:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:50:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:50:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:50:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:50:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:50:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:50:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:50:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:50:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4794L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#4796 AS rid_0#4803, cpfk_region_nation#4797 AS cpfk_region_nation_0#4804, cfpk_nation_region#4798 AS cfpk_nation_region_0#4805, cval_nation_n_name#4799 AS cval_nation_n_name_0#4806, cval_nation_n_comment#4800 AS cval_nation_n_comment_0#4807, cn_name#4801 AS cn_name_0#4808, cn_comment#4802 AS cn_comment_0#4809]
         :  :  :  :  :  +- Relation[rid#4796,cpfk_region_nation#4797,cfpk_nation_region#4798,cval_nation_n_name#4799,cval_nation_n_comment#4800,cn_name#4801,cn_comment#4802] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#4810 AS rid_0#4817, cpfk_region_nation#4811 AS cpfk_region_nation_0#4818, cfpk_nation_region#4812 AS cfpk_nation_region_0#4819, cval_nation_n_name#4813 AS cval_nation_n_name_0#4820, cval_nation_n_comment#4814 AS cval_nation_n_comment_0#4821, cn_name#4815 AS cn_name_0#4822, cn_comment#4816 AS cn_comment_0#4823]
         :  :  :  :        +- Relation[rid#4810,cpfk_region_nation#4811,cfpk_nation_region#4812,cval_nation_n_name#4813,cval_nation_n_comment#4814,cn_name#4815,cn_comment#4816] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :     :- Project [rid#4850 AS rid_0#4857, cpfk_region_nation#4851 AS cpfk_region_nation_0#4858, cfpk_nation_region#4852 AS cfpk_nation_region_0#4859, cval_nation_n_name#4853 AS cval_nation_n_name_0#4860, cval_nation_n_comment#4854 AS cval_nation_n_comment_0#4861, cn_name#4855 AS cn_name_0#4862, cn_comment#4856 AS cn_comment_0#4863]
         :  :  :     :  +- Relation[rid#4850,cpfk_region_nation#4851,cfpk_nation_region#4852,cval_nation_n_name#4853,cval_nation_n_comment#4854,cn_name#4855,cn_comment#4856] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#4864 AS rid_1#4877, cpfk_nation_supplier#4865 AS cpfk_nation_supplier_1#4878, cfpk_supplier_nation#4866 AS cfpk_supplier_nation_1#4879, cval_supplier_s_name#4867 AS cval_supplier_s_name_1#4880, cval_supplier_s_address#4868 AS cval_supplier_s_address_1#4881, cval_supplier_s_phone#4869 AS cval_supplier_s_phone_1#4882, cval_supplier_s_acctbal#4870 AS cval_supplier_s_acctbal_1#4883, cval_supplier_s_comment#4871 AS cval_supplier_s_comment_1#4884, cs_name#4872 AS cs_name_1#4885, cs_address#4873 AS cs_address_1#4886, cs_phone#4874 AS cs_phone_1#4887, cs_acctbal#4875 AS cs_acctbal_1#4888, cs_comment#4876 AS cs_comment_1#4889]
         :  :  :        +- Relation[rid#4864,cpfk_nation_supplier#4865,cfpk_supplier_nation#4866,cval_supplier_s_name#4867,cval_supplier_s_address#4868,cval_supplier_s_phone#4869,cval_supplier_s_acctbal#4870,cval_supplier_s_comment#4871,cs_name#4872,cs_address#4873,cs_phone#4874,cs_acctbal#4875,cs_comment#4876] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#4824 AS rid_1#4837, cpfk_nation_supplier#4825 AS cpfk_nation_supplier_1#4838, cfpk_supplier_nation#4826 AS cfpk_supplier_nation_1#4839, cval_supplier_s_name#4827 AS cval_supplier_s_name_1#4840, cval_supplier_s_address#4828 AS cval_supplier_s_address_1#4841, cval_supplier_s_phone#4829 AS cval_supplier_s_phone_1#4842, cval_supplier_s_acctbal#4830 AS cval_supplier_s_acctbal_1#4843, cval_supplier_s_comment#4831 AS cval_supplier_s_comment_1#4844, cs_name#4832 AS cs_name_1#4845, cs_address#4833 AS cs_address_1#4846, cs_phone#4834 AS cs_phone_1#4847, cs_acctbal#4835 AS cs_acctbal_1#4848, cs_comment#4836 AS cs_comment_1#4849]
         :  :     +- Relation[rid#4824,cpfk_nation_supplier#4825,cfpk_supplier_nation#4826,cval_supplier_s_name#4827,cval_supplier_s_address#4828,cval_supplier_s_phone#4829,cval_supplier_s_acctbal#4830,cval_supplier_s_comment#4831,cs_name#4832,cs_address#4833,cs_phone#4834,cs_acctbal#4835,cs_comment#4836] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :     :- Project [rid#4912 AS rid_1#4925, cpfk_nation_supplier#4913 AS cpfk_nation_supplier_1#4926, cfpk_supplier_nation#4914 AS cfpk_supplier_nation_1#4927, cval_supplier_s_name#4915 AS cval_supplier_s_name_1#4928, cval_supplier_s_address#4916 AS cval_supplier_s_address_1#4929, cval_supplier_s_phone#4917 AS cval_supplier_s_phone_1#4930, cval_supplier_s_acctbal#4918 AS cval_supplier_s_acctbal_1#4931, cval_supplier_s_comment#4919 AS cval_supplier_s_comment_1#4932, cs_name#4920 AS cs_name_1#4933, cs_address#4921 AS cs_address_1#4934, cs_phone#4922 AS cs_phone_1#4935, cs_acctbal#4923 AS cs_acctbal_1#4936, cs_comment#4924 AS cs_comment_1#4937]
         :     :  +- Relation[rid#4912,cpfk_nation_supplier#4913,cfpk_supplier_nation#4914,cval_supplier_s_name#4915,cval_supplier_s_address#4916,cval_supplier_s_phone#4917,cval_supplier_s_acctbal#4918,cval_supplier_s_comment#4919,cs_name#4920,cs_address#4921,cs_phone#4922,cs_acctbal#4923,cs_comment#4924] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#4938 AS rid_2#4949, cpfk_part_partsupp#4939 AS cpfk_part_partsupp_2#4950, cfpk_partsupp_part#4940 AS cfpk_partsupp_part_2#4951, cpfk_supplier_partsupp#4941 AS cpfk_supplier_partsupp_2#4952, cfpk_partsupp_supplier#4942 AS cfpk_partsupp_supplier_2#4953, cval_partsupp_ps_availqty#4943 AS cval_partsupp_ps_availqty_2#4954, cval_partsupp_ps_supplycost#4944 AS cval_partsupp_ps_supplycost_2#4955, cval_partsupp_ps_comment#4945 AS cval_partsupp_ps_comment_2#4956, cps_availqty#4946 AS cps_availqty_2#4957, cps_supplycost#4947 AS cps_supplycost_2#4958, cps_comment#4948 AS cps_comment_2#4959]
         :        +- Relation[rid#4938,cpfk_part_partsupp#4939,cfpk_partsupp_part#4940,cpfk_supplier_partsupp#4941,cfpk_partsupp_supplier#4942,cval_partsupp_ps_availqty#4943,cval_partsupp_ps_supplycost#4944,cval_partsupp_ps_comment#4945,cps_availqty#4946,cps_supplycost#4947,cps_comment#4948] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#4890 AS rid_2#4901, cpfk_part_partsupp#4891 AS cpfk_part_partsupp_2#4902, cfpk_partsupp_part#4892 AS cfpk_partsupp_part_2#4903, cpfk_supplier_partsupp#4893 AS cpfk_supplier_partsupp_2#4904, cfpk_partsupp_supplier#4894 AS cfpk_partsupp_supplier_2#4905, cval_partsupp_ps_availqty#4895 AS cval_partsupp_ps_availqty_2#4906, cval_partsupp_ps_supplycost#4896 AS cval_partsupp_ps_supplycost_2#4907, cval_partsupp_ps_comment#4897 AS cval_partsupp_ps_comment_2#4908, cps_availqty#4898 AS cps_availqty_2#4909, cps_supplycost#4899 AS cps_supplycost_2#4910, cps_comment#4900 AS cps_comment_2#4911]
            +- Relation[rid#4890,cpfk_part_partsupp#4891,cfpk_partsupp_part#4892,cpfk_supplier_partsupp#4893,cfpk_partsupp_supplier#4894,cval_partsupp_ps_availqty#4895,cval_partsupp_ps_supplycost#4896,cval_partsupp_ps_comment#4897,cps_availqty#4898,cps_supplycost#4899,cps_comment#4900] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 10895ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/11 05:50:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:50:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4998L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 05:50:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:50:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:50:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:50:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4998L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#5000 AS rid_0#5017, cval_part_p_name#5001 AS cval_part_p_name_0#5018, cval_part_p_mfgr#5002 AS cval_part_p_mfgr_0#5019, cval_part_p_type#5003 AS cval_part_p_type_0#5020, cval_part_p_size#5004 AS cval_part_p_size_0#5021, cval_part_p_container#5005 AS cval_part_p_container_0#5022, cval_part_p_retailprice#5006 AS cval_part_p_retailprice_0#5023, cval_part_p_comment#5007 AS cval_part_p_comment_0#5024, cval_part_p_brand#5008 AS cval_part_p_brand_0#5025, cp_name#5009 AS cp_name_0#5026, cp_mfgr#5010 AS cp_mfgr_0#5027, cp_type#5011 AS cp_type_0#5028, cp_size#5012 AS cp_size_0#5029, cp_container#5013 AS cp_container_0#5030, cp_retailprice#5014 AS cp_retailprice_0#5031, cp_comment#5015 AS cp_comment_0#5032, cp_brand#5016 AS cp_brand_0#5033]
         :  :  :  +- Relation[rid#5000,cval_part_p_name#5001,cval_part_p_mfgr#5002,cval_part_p_type#5003,cval_part_p_size#5004,cval_part_p_container#5005,cval_part_p_retailprice#5006,cval_part_p_comment#5007,cval_part_p_brand#5008,cp_name#5009,cp_mfgr#5010,cp_type#5011,cp_size#5012,cp_container#5013,cp_retailprice#5014,cp_comment#5015,cp_brand#5016] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#5034 AS rid_0#5051, cval_part_p_name#5035 AS cval_part_p_name_0#5052, cval_part_p_mfgr#5036 AS cval_part_p_mfgr_0#5053, cval_part_p_type#5037 AS cval_part_p_type_0#5054, cval_part_p_size#5038 AS cval_part_p_size_0#5055, cval_part_p_container#5039 AS cval_part_p_container_0#5056, cval_part_p_retailprice#5040 AS cval_part_p_retailprice_0#5057, cval_part_p_comment#5041 AS cval_part_p_comment_0#5058, cval_part_p_brand#5042 AS cval_part_p_brand_0#5059, cp_name#5043 AS cp_name_0#5060, cp_mfgr#5044 AS cp_mfgr_0#5061, cp_type#5045 AS cp_type_0#5062, cp_size#5046 AS cp_size_0#5063, cp_container#5047 AS cp_container_0#5064, cp_retailprice#5048 AS cp_retailprice_0#5065, cp_comment#5049 AS cp_comment_0#5066, cp_brand#5050 AS cp_brand_0#5067]
         :  :        +- Relation[rid#5034,cval_part_p_name#5035,cval_part_p_mfgr#5036,cval_part_p_type#5037,cval_part_p_size#5038,cval_part_p_container#5039,cval_part_p_retailprice#5040,cval_part_p_comment#5041,cval_part_p_brand#5042,cp_name#5043,cp_mfgr#5044,cp_type#5045,cp_size#5046,cp_container#5047,cp_retailprice#5048,cp_comment#5049,cp_brand#5050] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :     :- Project [rid#5090 AS rid_0#5107, cval_part_p_name#5091 AS cval_part_p_name_0#5108, cval_part_p_mfgr#5092 AS cval_part_p_mfgr_0#5109, cval_part_p_type#5093 AS cval_part_p_type_0#5110, cval_part_p_size#5094 AS cval_part_p_size_0#5111, cval_part_p_container#5095 AS cval_part_p_container_0#5112, cval_part_p_retailprice#5096 AS cval_part_p_retailprice_0#5113, cval_part_p_comment#5097 AS cval_part_p_comment_0#5114, cval_part_p_brand#5098 AS cval_part_p_brand_0#5115, cp_name#5099 AS cp_name_0#5116, cp_mfgr#5100 AS cp_mfgr_0#5117, cp_type#5101 AS cp_type_0#5118, cp_size#5102 AS cp_size_0#5119, cp_container#5103 AS cp_container_0#5120, cp_retailprice#5104 AS cp_retailprice_0#5121, cp_comment#5105 AS cp_comment_0#5122, cp_brand#5106 AS cp_brand_0#5123]
         :     :  +- Relation[rid#5090,cval_part_p_name#5091,cval_part_p_mfgr#5092,cval_part_p_type#5093,cval_part_p_size#5094,cval_part_p_container#5095,cval_part_p_retailprice#5096,cval_part_p_comment#5097,cval_part_p_brand#5098,cp_name#5099,cp_mfgr#5100,cp_type#5101,cp_size#5102,cp_container#5103,cp_retailprice#5104,cp_comment#5105,cp_brand#5106] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#5124 AS rid_1#5135, cpfk_part_partsupp#5125 AS cpfk_part_partsupp_1#5136, cfpk_partsupp_part#5126 AS cfpk_partsupp_part_1#5137, cpfk_supplier_partsupp#5127 AS cpfk_supplier_partsupp_1#5138, cfpk_partsupp_supplier#5128 AS cfpk_partsupp_supplier_1#5139, cval_partsupp_ps_availqty#5129 AS cval_partsupp_ps_availqty_1#5140, cval_partsupp_ps_supplycost#5130 AS cval_partsupp_ps_supplycost_1#5141, cval_partsupp_ps_comment#5131 AS cval_partsupp_ps_comment_1#5142, cps_availqty#5132 AS cps_availqty_1#5143, cps_supplycost#5133 AS cps_supplycost_1#5144, cps_comment#5134 AS cps_comment_1#5145]
         :        +- Relation[rid#5124,cpfk_part_partsupp#5125,cfpk_partsupp_part#5126,cpfk_supplier_partsupp#5127,cfpk_partsupp_supplier#5128,cval_partsupp_ps_availqty#5129,cval_partsupp_ps_supplycost#5130,cval_partsupp_ps_comment#5131,cps_availqty#5132,cps_supplycost#5133,cps_comment#5134] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#5068 AS rid_1#5079, cpfk_part_partsupp#5069 AS cpfk_part_partsupp_1#5080, cfpk_partsupp_part#5070 AS cfpk_partsupp_part_1#5081, cpfk_supplier_partsupp#5071 AS cpfk_supplier_partsupp_1#5082, cfpk_partsupp_supplier#5072 AS cfpk_partsupp_supplier_1#5083, cval_partsupp_ps_availqty#5073 AS cval_partsupp_ps_availqty_1#5084, cval_partsupp_ps_supplycost#5074 AS cval_partsupp_ps_supplycost_1#5085, cval_partsupp_ps_comment#5075 AS cval_partsupp_ps_comment_1#5086, cps_availqty#5076 AS cps_availqty_1#5087, cps_supplycost#5077 AS cps_supplycost_1#5088, cps_comment#5078 AS cps_comment_1#5089]
            +- Relation[rid#5068,cpfk_part_partsupp#5069,cfpk_partsupp_part#5070,cpfk_supplier_partsupp#5071,cfpk_partsupp_supplier#5072,cval_partsupp_ps_availqty#5073,cval_partsupp_ps_supplycost#5074,cval_partsupp_ps_comment#5075,cps_availqty#5076,cps_supplycost#5077,cps_comment#5078] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 11235ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/11 05:50:53 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:50:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5178L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 05:50:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:50:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:50:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:50:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:50:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:50:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:50:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:50:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5178L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#5180 AS rid_0#5213, cpfk_orders_lineitem#5181 AS cpfk_orders_lineitem_0#5214, cpfk_supplier_lineitem#5182 AS cpfk_supplier_lineitem_0#5215, cfpk_lineitem_supplier#5183 AS cfpk_lineitem_supplier_0#5216, cfpk_lineitem_partsupp#5184 AS cfpk_lineitem_partsupp_0#5217, cpfk_part_lineitem#5185 AS cpfk_part_lineitem_0#5218, cfpk_lineitem_part#5186 AS cfpk_lineitem_part_0#5219, cpfk_partsupp_lineitem#5187 AS cpfk_partsupp_lineitem_0#5220, cfpk_lineitem_orders#5188 AS cfpk_lineitem_orders_0#5221, cval_lineitem_l_quantity#5189 AS cval_lineitem_l_quantity_0#5222, cval_lineitem_l_extendedprice#5190 AS cval_lineitem_l_extendedprice_0#5223, cval_lineitem_l_discount#5191 AS cval_lineitem_l_discount_0#5224, cval_lineitem_l_tax#5192 AS cval_lineitem_l_tax_0#5225, cval_lineitem_l_returnflag#5193 AS cval_lineitem_l_returnflag_0#5226, cval_lineitem_l_linestatus#5194 AS cval_lineitem_l_linestatus_0#5227, cval_lineitem_l_commitdate#5195 AS cval_lineitem_l_commitdate_0#5228, cval_lineitem_l_receiptdate#5196 AS cval_lineitem_l_receiptdate_0#5229, cval_lineitem_l_shipinstruct#5197 AS cval_lineitem_l_shipinstruct_0#5230, cval_lineitem_l_shipmode#5198 AS cval_lineitem_l_shipmode_0#5231, cval_lineitem_l_comment#5199 AS cval_lineitem_l_comment_0#5232, cval_lineitem_l_shipdate#5200 AS cval_lineitem_l_shipdate_0#5233, cl_quantity#5201 AS cl_quantity_0#5234, cl_extendedprice#5202 AS cl_extendedprice_0#5235, cl_discount#5203 AS cl_discount_0#5236, ... 9 more fields]
            :  +- Relation[rid#5180,cpfk_orders_lineitem#5181,cpfk_supplier_lineitem#5182,cfpk_lineitem_supplier#5183,cfpk_lineitem_partsupp#5184,cpfk_part_lineitem#5185,cfpk_lineitem_part#5186,cpfk_partsupp_lineitem#5187,cfpk_lineitem_orders#5188,cval_lineitem_l_quantity#5189,cval_lineitem_l_extendedprice#5190,cval_lineitem_l_discount#5191,cval_lineitem_l_tax#5192,cval_lineitem_l_returnflag#5193,cval_lineitem_l_linestatus#5194,cval_lineitem_l_commitdate#5195,cval_lineitem_l_receiptdate#5196,cval_lineitem_l_shipinstruct#5197,cval_lineitem_l_shipmode#5198,cval_lineitem_l_comment#5199,cval_lineitem_l_shipdate#5200,cl_quantity#5201,cl_extendedprice#5202,cl_discount#5203,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#5246 AS rid_1#5263, cpfk_customer_orders#5247 AS cpfk_customer_orders_1#5264, cfpk_orders_customer#5248 AS cfpk_orders_customer_1#5265, cval_orders_o_orderstatus#5249 AS cval_orders_o_orderstatus_1#5266, cval_orders_o_totalprice#5250 AS cval_orders_o_totalprice_1#5267, cval_orders_o_orderpriority#5251 AS cval_orders_o_orderpriority_1#5268, cval_orders_o_clerk#5252 AS cval_orders_o_clerk_1#5269, cval_orders_o_shippriority#5253 AS cval_orders_o_shippriority_1#5270, cval_orders_o_comment#5254 AS cval_orders_o_comment_1#5271, cval_orders_o_orderdate#5255 AS cval_orders_o_orderdate_1#5272, co_orderstatus#5256 AS co_orderstatus_1#5273, co_totalprice#5257 AS co_totalprice_1#5274, co_orderpriority#5258 AS co_orderpriority_1#5275, co_clerk#5259 AS co_clerk_1#5276, co_shippriority#5260 AS co_shippriority_1#5277, co_comment#5261 AS co_comment_1#5278, co_orderdate#5262 AS co_orderdate_1#5279]
                  :     :  :  :  :  +- Relation[rid#5246,cpfk_customer_orders#5247,cfpk_orders_customer#5248,cval_orders_o_orderstatus#5249,cval_orders_o_totalprice#5250,cval_orders_o_orderpriority#5251,cval_orders_o_clerk#5252,cval_orders_o_shippriority#5253,cval_orders_o_comment#5254,cval_orders_o_orderdate#5255,co_orderstatus#5256,co_totalprice#5257,co_orderpriority#5258,co_clerk#5259,co_shippriority#5260,co_comment#5261,co_orderdate#5262] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#5280 AS rid_1#5297, cpfk_customer_orders#5281 AS cpfk_customer_orders_1#5298, cfpk_orders_customer#5282 AS cfpk_orders_customer_1#5299, cval_orders_o_orderstatus#5283 AS cval_orders_o_orderstatus_1#5300, cval_orders_o_totalprice#5284 AS cval_orders_o_totalprice_1#5301, cval_orders_o_orderpriority#5285 AS cval_orders_o_orderpriority_1#5302, cval_orders_o_clerk#5286 AS cval_orders_o_clerk_1#5303, cval_orders_o_shippriority#5287 AS cval_orders_o_shippriority_1#5304, cval_orders_o_comment#5288 AS cval_orders_o_comment_1#5305, cval_orders_o_orderdate#5289 AS cval_orders_o_orderdate_1#5306, co_orderstatus#5290 AS co_orderstatus_1#5307, co_totalprice#5291 AS co_totalprice_1#5308, co_orderpriority#5292 AS co_orderpriority_1#5309, co_clerk#5293 AS co_clerk_1#5310, co_shippriority#5294 AS co_shippriority_1#5311, co_comment#5295 AS co_comment_1#5312, co_orderdate#5296 AS co_orderdate_1#5313]
                  :     :  :  :        +- Relation[rid#5280,cpfk_customer_orders#5281,cfpk_orders_customer#5282,cval_orders_o_orderstatus#5283,cval_orders_o_totalprice#5284,cval_orders_o_orderpriority#5285,cval_orders_o_clerk#5286,cval_orders_o_shippriority#5287,cval_orders_o_comment#5288,cval_orders_o_orderdate#5289,co_orderstatus#5290,co_totalprice#5291,co_orderpriority#5292,co_clerk#5293,co_shippriority#5294,co_comment#5295,co_orderdate#5296] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :     :- Project [rid#5380 AS rid_1#5397, cpfk_customer_orders#5381 AS cpfk_customer_orders_1#5398, cfpk_orders_customer#5382 AS cfpk_orders_customer_1#5399, cval_orders_o_orderstatus#5383 AS cval_orders_o_orderstatus_1#5400, cval_orders_o_totalprice#5384 AS cval_orders_o_totalprice_1#5401, cval_orders_o_orderpriority#5385 AS cval_orders_o_orderpriority_1#5402, cval_orders_o_clerk#5386 AS cval_orders_o_clerk_1#5403, cval_orders_o_shippriority#5387 AS cval_orders_o_shippriority_1#5404, cval_orders_o_comment#5388 AS cval_orders_o_comment_1#5405, cval_orders_o_orderdate#5389 AS cval_orders_o_orderdate_1#5406, co_orderstatus#5390 AS co_orderstatus_1#5407, co_totalprice#5391 AS co_totalprice_1#5408, co_orderpriority#5392 AS co_orderpriority_1#5409, co_clerk#5393 AS co_clerk_1#5410, co_shippriority#5394 AS co_shippriority_1#5411, co_comment#5395 AS co_comment_1#5412, co_orderdate#5396 AS co_orderdate_1#5413]
                  :     :  :     :  +- Relation[rid#5380,cpfk_customer_orders#5381,cfpk_orders_customer#5382,cval_orders_o_orderstatus#5383,cval_orders_o_totalprice#5384,cval_orders_o_orderpriority#5385,cval_orders_o_clerk#5386,cval_orders_o_shippriority#5387,cval_orders_o_comment#5388,cval_orders_o_orderdate#5389,co_orderstatus#5390,co_totalprice#5391,co_orderpriority#5392,co_clerk#5393,co_shippriority#5394,co_comment#5395,co_orderdate#5396] JDBCRelation(torders) [numPartitions=1]
                  :     :  :     +- Project [rid#5414 AS rid_2#5447, cpfk_orders_lineitem#5415 AS cpfk_orders_lineitem_2#5448, cpfk_supplier_lineitem#5416 AS cpfk_supplier_lineitem_2#5449, cfpk_lineitem_supplier#5417 AS cfpk_lineitem_supplier_2#5450, cfpk_lineitem_partsupp#5418 AS cfpk_lineitem_partsupp_2#5451, cpfk_part_lineitem#5419 AS cpfk_part_lineitem_2#5452, cfpk_lineitem_part#5420 AS cfpk_lineitem_part_2#5453, cpfk_partsupp_lineitem#5421 AS cpfk_partsupp_lineitem_2#5454, cfpk_lineitem_orders#5422 AS cfpk_lineitem_orders_2#5455, cval_lineitem_l_quantity#5423 AS cval_lineitem_l_quantity_2#5456, cval_lineitem_l_extendedprice#5424 AS cval_lineitem_l_extendedprice_2#5457, cval_lineitem_l_discount#5425 AS cval_lineitem_l_discount_2#5458, cval_lineitem_l_tax#5426 AS cval_lineitem_l_tax_2#5459, cval_lineitem_l_returnflag#5427 AS cval_lineitem_l_returnflag_2#5460, cval_lineitem_l_linestatus#5428 AS cval_lineitem_l_linestatus_2#5461, cval_lineitem_l_commitdate#5429 AS cval_lineitem_l_commitdate_2#5462, cval_lineitem_l_receiptdate#5430 AS cval_lineitem_l_receiptdate_2#5463, cval_lineitem_l_shipinstruct#5431 AS cval_lineitem_l_shipinstruct_2#5464, cval_lineitem_l_shipmode#5432 AS cval_lineitem_l_shipmode_2#5465, cval_lineitem_l_comment#5433 AS cval_lineitem_l_comment_2#5466, cval_lineitem_l_shipdate#5434 AS cval_lineitem_l_shipdate_2#5467, cl_quantity#5435 AS cl_quantity_2#5468, cl_extendedprice#5436 AS cl_extendedprice_2#5469, cl_discount#5437 AS cl_discount_2#5470, ... 9 more fields]
                  :     :  :        +- Relation[rid#5414,cpfk_orders_lineitem#5415,cpfk_supplier_lineitem#5416,cfpk_lineitem_supplier#5417,cfpk_lineitem_partsupp#5418,cpfk_part_lineitem#5419,cfpk_lineitem_part#5420,cpfk_partsupp_lineitem#5421,cfpk_lineitem_orders#5422,cval_lineitem_l_quantity#5423,cval_lineitem_l_extendedprice#5424,cval_lineitem_l_discount#5425,cval_lineitem_l_tax#5426,cval_lineitem_l_returnflag#5427,cval_lineitem_l_linestatus#5428,cval_lineitem_l_commitdate#5429,cval_lineitem_l_receiptdate#5430,cval_lineitem_l_shipinstruct#5431,cval_lineitem_l_shipmode#5432,cval_lineitem_l_comment#5433,cval_lineitem_l_shipdate#5434,cl_quantity#5435,cl_extendedprice#5436,cl_discount#5437,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#5314 AS rid_2#5347, cpfk_orders_lineitem#5315 AS cpfk_orders_lineitem_2#5348, cpfk_supplier_lineitem#5316 AS cpfk_supplier_lineitem_2#5349, cfpk_lineitem_supplier#5317 AS cfpk_lineitem_supplier_2#5350, cfpk_lineitem_partsupp#5318 AS cfpk_lineitem_partsupp_2#5351, cpfk_part_lineitem#5319 AS cpfk_part_lineitem_2#5352, cfpk_lineitem_part#5320 AS cfpk_lineitem_part_2#5353, cpfk_partsupp_lineitem#5321 AS cpfk_partsupp_lineitem_2#5354, cfpk_lineitem_orders#5322 AS cfpk_lineitem_orders_2#5355, cval_lineitem_l_quantity#5323 AS cval_lineitem_l_quantity_2#5356, cval_lineitem_l_extendedprice#5324 AS cval_lineitem_l_extendedprice_2#5357, cval_lineitem_l_discount#5325 AS cval_lineitem_l_discount_2#5358, cval_lineitem_l_tax#5326 AS cval_lineitem_l_tax_2#5359, cval_lineitem_l_returnflag#5327 AS cval_lineitem_l_returnflag_2#5360, cval_lineitem_l_linestatus#5328 AS cval_lineitem_l_linestatus_2#5361, cval_lineitem_l_commitdate#5329 AS cval_lineitem_l_commitdate_2#5362, cval_lineitem_l_receiptdate#5330 AS cval_lineitem_l_receiptdate_2#5363, cval_lineitem_l_shipinstruct#5331 AS cval_lineitem_l_shipinstruct_2#5364, cval_lineitem_l_shipmode#5332 AS cval_lineitem_l_shipmode_2#5365, cval_lineitem_l_comment#5333 AS cval_lineitem_l_comment_2#5366, cval_lineitem_l_shipdate#5334 AS cval_lineitem_l_shipdate_2#5367, cl_quantity#5335 AS cl_quantity_2#5368, cl_extendedprice#5336 AS cl_extendedprice_2#5369, cl_discount#5337 AS cl_discount_2#5370, ... 9 more fields]
                  :     :     +- Relation[rid#5314,cpfk_orders_lineitem#5315,cpfk_supplier_lineitem#5316,cfpk_lineitem_supplier#5317,cfpk_lineitem_partsupp#5318,cpfk_part_lineitem#5319,cfpk_lineitem_part#5320,cpfk_partsupp_lineitem#5321,cfpk_lineitem_orders#5322,cval_lineitem_l_quantity#5323,cval_lineitem_l_extendedprice#5324,cval_lineitem_l_discount#5325,cval_lineitem_l_tax#5326,cval_lineitem_l_returnflag#5327,cval_lineitem_l_linestatus#5328,cval_lineitem_l_commitdate#5329,cval_lineitem_l_receiptdate#5330,cval_lineitem_l_shipinstruct#5331,cval_lineitem_l_shipmode#5332,cval_lineitem_l_comment#5333,cval_lineitem_l_shipdate#5334,cl_quantity#5335,cl_extendedprice#5336,cl_discount#5337,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#5480 AS rid_3#5493, cpfk_nation_supplier#5481 AS cpfk_nation_supplier_3#5494, cfpk_supplier_nation#5482 AS cfpk_supplier_nation_3#5495, cval_supplier_s_name#5483 AS cval_supplier_s_name_3#5496, cval_supplier_s_address#5484 AS cval_supplier_s_address_3#5497, cval_supplier_s_phone#5485 AS cval_supplier_s_phone_3#5498, cval_supplier_s_acctbal#5486 AS cval_supplier_s_acctbal_3#5499, cval_supplier_s_comment#5487 AS cval_supplier_s_comment_3#5500, cs_name#5488 AS cs_name_3#5501, cs_address#5489 AS cs_address_3#5502, cs_phone#5490 AS cs_phone_3#5503, cs_acctbal#5491 AS cs_acctbal_3#5504, cs_comment#5492 AS cs_comment_3#5505]
                  :        +- Relation[rid#5480,cpfk_nation_supplier#5481,cfpk_supplier_nation#5482,cval_supplier_s_name#5483,cval_supplier_s_address#5484,cval_supplier_s_phone#5485,cval_supplier_s_acctbal#5486,cval_supplier_s_comment#5487,cs_name#5488,cs_address#5489,cs_phone#5490,cs_acctbal#5491,cs_comment#5492] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#5506 AS rid_4#5513, cpfk_region_nation#5507 AS cpfk_region_nation_4#5514, cfpk_nation_region#5508 AS cfpk_nation_region_4#5515, cval_nation_n_name#5509 AS cval_nation_n_name_4#5516, cval_nation_n_comment#5510 AS cval_nation_n_comment_4#5517, cn_name#5511 AS cn_name_4#5518, cn_comment#5512 AS cn_comment_4#5519]
                     :  +- Relation[rid#5506,cpfk_region_nation#5507,cfpk_nation_region#5508,cval_nation_n_name#5509,cval_nation_n_comment#5510,cn_name#5511,cn_comment#5512] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#5520 AS rid_4#5527, cpfk_region_nation#5521 AS cpfk_region_nation_4#5528, cfpk_nation_region#5522 AS cfpk_nation_region_4#5529, cval_nation_n_name#5523 AS cval_nation_n_name_4#5530, cval_nation_n_comment#5524 AS cval_nation_n_comment_4#5531, cn_name#5525 AS cn_name_4#5532, cn_comment#5526 AS cn_comment_4#5533]
                           +- Relation[rid#5520,cpfk_region_nation#5521,cfpk_nation_region#5522,cval_nation_n_name#5523,cval_nation_n_comment#5524,cn_name#5525,cn_comment#5526] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 248411ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/11 05:55:01 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:55:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5642L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 05:55:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#5642L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#5644 AS rid_0#5677, cpfk_orders_lineitem#5645 AS cpfk_orders_lineitem_0#5678, cpfk_supplier_lineitem#5646 AS cpfk_supplier_lineitem_0#5679, cfpk_lineitem_supplier#5647 AS cfpk_lineitem_supplier_0#5680, cfpk_lineitem_partsupp#5648 AS cfpk_lineitem_partsupp_0#5681, cpfk_part_lineitem#5649 AS cpfk_part_lineitem_0#5682, cfpk_lineitem_part#5650 AS cfpk_lineitem_part_0#5683, cpfk_partsupp_lineitem#5651 AS cpfk_partsupp_lineitem_0#5684, cfpk_lineitem_orders#5652 AS cfpk_lineitem_orders_0#5685, cval_lineitem_l_quantity#5653 AS cval_lineitem_l_quantity_0#5686, cval_lineitem_l_extendedprice#5654 AS cval_lineitem_l_extendedprice_0#5687, cval_lineitem_l_discount#5655 AS cval_lineitem_l_discount_0#5688, cval_lineitem_l_tax#5656 AS cval_lineitem_l_tax_0#5689, cval_lineitem_l_returnflag#5657 AS cval_lineitem_l_returnflag_0#5690, cval_lineitem_l_linestatus#5658 AS cval_lineitem_l_linestatus_0#5691, cval_lineitem_l_commitdate#5659 AS cval_lineitem_l_commitdate_0#5692, cval_lineitem_l_receiptdate#5660 AS cval_lineitem_l_receiptdate_0#5693, cval_lineitem_l_shipinstruct#5661 AS cval_lineitem_l_shipinstruct_0#5694, cval_lineitem_l_shipmode#5662 AS cval_lineitem_l_shipmode_0#5695, cval_lineitem_l_comment#5663 AS cval_lineitem_l_comment_0#5696, cval_lineitem_l_shipdate#5664 AS cval_lineitem_l_shipdate_0#5697, cl_quantity#5665 AS cl_quantity_0#5698, cl_extendedprice#5666 AS cl_extendedprice_0#5699, cl_discount#5667 AS cl_discount_0#5700, ... 9 more fields]
         +- Relation[rid#5644,cpfk_orders_lineitem#5645,cpfk_supplier_lineitem#5646,cfpk_lineitem_supplier#5647,cfpk_lineitem_partsupp#5648,cpfk_part_lineitem#5649,cfpk_lineitem_part#5650,cpfk_partsupp_lineitem#5651,cfpk_lineitem_orders#5652,cval_lineitem_l_quantity#5653,cval_lineitem_l_extendedprice#5654,cval_lineitem_l_discount#5655,cval_lineitem_l_tax#5656,cval_lineitem_l_returnflag#5657,cval_lineitem_l_linestatus#5658,cval_lineitem_l_commitdate#5659,cval_lineitem_l_receiptdate#5660,cval_lineitem_l_shipinstruct#5661,cval_lineitem_l_shipmode#5662,cval_lineitem_l_comment#5663,cval_lineitem_l_shipdate#5664,cl_quantity#5665,cl_extendedprice#5666,cl_discount#5667,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 6705ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 05:55:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:55:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5752L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 05:55:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:55:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:55:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:55:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:55:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:55:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:55:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:55:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:55:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:55:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:55:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5752L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#5754 AS rid_0#5761, cpfk_region_nation#5755 AS cpfk_region_nation_0#5762, cfpk_nation_region#5756 AS cfpk_nation_region_0#5763, cval_nation_n_name#5757 AS cval_nation_n_name_0#5764, cval_nation_n_comment#5758 AS cval_nation_n_comment_0#5765, cn_name#5759 AS cn_name_0#5766, cn_comment#5760 AS cn_comment_0#5767]
            :     :     :  :  :  :  :  +- Relation[rid#5754,cpfk_region_nation#5755,cfpk_nation_region#5756,cval_nation_n_name#5757,cval_nation_n_comment#5758,cn_name#5759,cn_comment#5760] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#5794 AS rid_0#5801, cpfk_region_nation#5795 AS cpfk_region_nation_0#5802, cfpk_nation_region#5796 AS cfpk_nation_region_0#5803, cval_nation_n_name#5797 AS cval_nation_n_name_0#5804, cval_nation_n_comment#5798 AS cval_nation_n_comment_0#5805, cn_name#5799 AS cn_name_0#5806, cn_comment#5800 AS cn_comment_0#5807]
            :     :     :  :  :  :     :  +- Relation[rid#5794,cpfk_region_nation#5795,cfpk_nation_region#5796,cval_nation_n_name#5797,cval_nation_n_comment#5798,cn_name#5799,cn_comment#5800] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#5808 AS rid_1#5821, cpfk_nation_supplier#5809 AS cpfk_nation_supplier_1#5822, cfpk_supplier_nation#5810 AS cfpk_supplier_nation_1#5823, cval_supplier_s_name#5811 AS cval_supplier_s_name_1#5824, cval_supplier_s_address#5812 AS cval_supplier_s_address_1#5825, cval_supplier_s_phone#5813 AS cval_supplier_s_phone_1#5826, cval_supplier_s_acctbal#5814 AS cval_supplier_s_acctbal_1#5827, cval_supplier_s_comment#5815 AS cval_supplier_s_comment_1#5828, cs_name#5816 AS cs_name_1#5829, cs_address#5817 AS cs_address_1#5830, cs_phone#5818 AS cs_phone_1#5831, cs_acctbal#5819 AS cs_acctbal_1#5832, cs_comment#5820 AS cs_comment_1#5833]
            :     :     :  :  :  :        +- Relation[rid#5808,cpfk_nation_supplier#5809,cfpk_supplier_nation#5810,cval_supplier_s_name#5811,cval_supplier_s_address#5812,cval_supplier_s_phone#5813,cval_supplier_s_acctbal#5814,cval_supplier_s_comment#5815,cs_name#5816,cs_address#5817,cs_phone#5818,cs_acctbal#5819,cs_comment#5820] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#5768 AS rid_1#5781, cpfk_nation_supplier#5769 AS cpfk_nation_supplier_1#5782, cfpk_supplier_nation#5770 AS cfpk_supplier_nation_1#5783, cval_supplier_s_name#5771 AS cval_supplier_s_name_1#5784, cval_supplier_s_address#5772 AS cval_supplier_s_address_1#5785, cval_supplier_s_phone#5773 AS cval_supplier_s_phone_1#5786, cval_supplier_s_acctbal#5774 AS cval_supplier_s_acctbal_1#5787, cval_supplier_s_comment#5775 AS cval_supplier_s_comment_1#5788, cs_name#5776 AS cs_name_1#5789, cs_address#5777 AS cs_address_1#5790, cs_phone#5778 AS cs_phone_1#5791, cs_acctbal#5779 AS cs_acctbal_1#5792, cs_comment#5780 AS cs_comment_1#5793]
            :     :     :  :  :     +- Relation[rid#5768,cpfk_nation_supplier#5769,cfpk_supplier_nation#5770,cval_supplier_s_name#5771,cval_supplier_s_address#5772,cval_supplier_s_phone#5773,cval_supplier_s_acctbal#5774,cval_supplier_s_comment#5775,cs_name#5776,cs_address#5777,cs_phone#5778,cs_acctbal#5779,cs_comment#5780] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#5900 AS rid_1#5913, cpfk_nation_supplier#5901 AS cpfk_nation_supplier_1#5914, cfpk_supplier_nation#5902 AS cfpk_supplier_nation_1#5915, cval_supplier_s_name#5903 AS cval_supplier_s_name_1#5916, cval_supplier_s_address#5904 AS cval_supplier_s_address_1#5917, cval_supplier_s_phone#5905 AS cval_supplier_s_phone_1#5918, cval_supplier_s_acctbal#5906 AS cval_supplier_s_acctbal_1#5919, cval_supplier_s_comment#5907 AS cval_supplier_s_comment_1#5920, cs_name#5908 AS cs_name_1#5921, cs_address#5909 AS cs_address_1#5922, cs_phone#5910 AS cs_phone_1#5923, cs_acctbal#5911 AS cs_acctbal_1#5924, cs_comment#5912 AS cs_comment_1#5925]
            :     :     :  :     :  +- Relation[rid#5900,cpfk_nation_supplier#5901,cfpk_supplier_nation#5902,cval_supplier_s_name#5903,cval_supplier_s_address#5904,cval_supplier_s_phone#5905,cval_supplier_s_acctbal#5906,cval_supplier_s_comment#5907,cs_name#5908,cs_address#5909,cs_phone#5910,cs_acctbal#5911,cs_comment#5912] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#5926 AS rid_2#5959, cpfk_orders_lineitem#5927 AS cpfk_orders_lineitem_2#5960, cpfk_supplier_lineitem#5928 AS cpfk_supplier_lineitem_2#5961, cfpk_lineitem_supplier#5929 AS cfpk_lineitem_supplier_2#5962, cfpk_lineitem_partsupp#5930 AS cfpk_lineitem_partsupp_2#5963, cpfk_part_lineitem#5931 AS cpfk_part_lineitem_2#5964, cfpk_lineitem_part#5932 AS cfpk_lineitem_part_2#5965, cpfk_partsupp_lineitem#5933 AS cpfk_partsupp_lineitem_2#5966, cfpk_lineitem_orders#5934 AS cfpk_lineitem_orders_2#5967, cval_lineitem_l_quantity#5935 AS cval_lineitem_l_quantity_2#5968, cval_lineitem_l_extendedprice#5936 AS cval_lineitem_l_extendedprice_2#5969, cval_lineitem_l_discount#5937 AS cval_lineitem_l_discount_2#5970, cval_lineitem_l_tax#5938 AS cval_lineitem_l_tax_2#5971, cval_lineitem_l_returnflag#5939 AS cval_lineitem_l_returnflag_2#5972, cval_lineitem_l_linestatus#5940 AS cval_lineitem_l_linestatus_2#5973, cval_lineitem_l_commitdate#5941 AS cval_lineitem_l_commitdate_2#5974, cval_lineitem_l_receiptdate#5942 AS cval_lineitem_l_receiptdate_2#5975, cval_lineitem_l_shipinstruct#5943 AS cval_lineitem_l_shipinstruct_2#5976, cval_lineitem_l_shipmode#5944 AS cval_lineitem_l_shipmode_2#5977, cval_lineitem_l_comment#5945 AS cval_lineitem_l_comment_2#5978, cval_lineitem_l_shipdate#5946 AS cval_lineitem_l_shipdate_2#5979, cl_quantity#5947 AS cl_quantity_2#5980, cl_extendedprice#5948 AS cl_extendedprice_2#5981, cl_discount#5949 AS cl_discount_2#5982, ... 9 more fields]
            :     :     :  :        +- Relation[rid#5926,cpfk_orders_lineitem#5927,cpfk_supplier_lineitem#5928,cfpk_lineitem_supplier#5929,cfpk_lineitem_partsupp#5930,cpfk_part_lineitem#5931,cfpk_lineitem_part#5932,cpfk_partsupp_lineitem#5933,cfpk_lineitem_orders#5934,cval_lineitem_l_quantity#5935,cval_lineitem_l_extendedprice#5936,cval_lineitem_l_discount#5937,cval_lineitem_l_tax#5938,cval_lineitem_l_returnflag#5939,cval_lineitem_l_linestatus#5940,cval_lineitem_l_commitdate#5941,cval_lineitem_l_receiptdate#5942,cval_lineitem_l_shipinstruct#5943,cval_lineitem_l_shipmode#5944,cval_lineitem_l_comment#5945,cval_lineitem_l_shipdate#5946,cl_quantity#5947,cl_extendedprice#5948,cl_discount#5949,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#5834 AS rid_2#5867, cpfk_orders_lineitem#5835 AS cpfk_orders_lineitem_2#5868, cpfk_supplier_lineitem#5836 AS cpfk_supplier_lineitem_2#5869, cfpk_lineitem_supplier#5837 AS cfpk_lineitem_supplier_2#5870, cfpk_lineitem_partsupp#5838 AS cfpk_lineitem_partsupp_2#5871, cpfk_part_lineitem#5839 AS cpfk_part_lineitem_2#5872, cfpk_lineitem_part#5840 AS cfpk_lineitem_part_2#5873, cpfk_partsupp_lineitem#5841 AS cpfk_partsupp_lineitem_2#5874, cfpk_lineitem_orders#5842 AS cfpk_lineitem_orders_2#5875, cval_lineitem_l_quantity#5843 AS cval_lineitem_l_quantity_2#5876, cval_lineitem_l_extendedprice#5844 AS cval_lineitem_l_extendedprice_2#5877, cval_lineitem_l_discount#5845 AS cval_lineitem_l_discount_2#5878, cval_lineitem_l_tax#5846 AS cval_lineitem_l_tax_2#5879, cval_lineitem_l_returnflag#5847 AS cval_lineitem_l_returnflag_2#5880, cval_lineitem_l_linestatus#5848 AS cval_lineitem_l_linestatus_2#5881, cval_lineitem_l_commitdate#5849 AS cval_lineitem_l_commitdate_2#5882, cval_lineitem_l_receiptdate#5850 AS cval_lineitem_l_receiptdate_2#5883, cval_lineitem_l_shipinstruct#5851 AS cval_lineitem_l_shipinstruct_2#5884, cval_lineitem_l_shipmode#5852 AS cval_lineitem_l_shipmode_2#5885, cval_lineitem_l_comment#5853 AS cval_lineitem_l_comment_2#5886, cval_lineitem_l_shipdate#5854 AS cval_lineitem_l_shipdate_2#5887, cl_quantity#5855 AS cl_quantity_2#5888, cl_extendedprice#5856 AS cl_extendedprice_2#5889, cl_discount#5857 AS cl_discount_2#5890, ... 9 more fields]
            :     :     :     +- Relation[rid#5834,cpfk_orders_lineitem#5835,cpfk_supplier_lineitem#5836,cfpk_lineitem_supplier#5837,cfpk_lineitem_partsupp#5838,cpfk_part_lineitem#5839,cfpk_lineitem_part#5840,cpfk_partsupp_lineitem#5841,cfpk_lineitem_orders#5842,cval_lineitem_l_quantity#5843,cval_lineitem_l_extendedprice#5844,cval_lineitem_l_discount#5845,cval_lineitem_l_tax#5846,cval_lineitem_l_returnflag#5847,cval_lineitem_l_linestatus#5848,cval_lineitem_l_commitdate#5849,cval_lineitem_l_receiptdate#5850,cval_lineitem_l_shipinstruct#5851,cval_lineitem_l_shipmode#5852,cval_lineitem_l_comment#5853,cval_lineitem_l_shipdate#5854,cl_quantity#5855,cl_extendedprice#5856,cl_discount#5857,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#5992 AS rid_3#6009, cval_part_p_name#5993 AS cval_part_p_name_3#6010, cval_part_p_mfgr#5994 AS cval_part_p_mfgr_3#6011, cval_part_p_type#5995 AS cval_part_p_type_3#6012, cval_part_p_size#5996 AS cval_part_p_size_3#6013, cval_part_p_container#5997 AS cval_part_p_container_3#6014, cval_part_p_retailprice#5998 AS cval_part_p_retailprice_3#6015, cval_part_p_comment#5999 AS cval_part_p_comment_3#6016, cval_part_p_brand#6000 AS cval_part_p_brand_3#6017, cp_name#6001 AS cp_name_3#6018, cp_mfgr#6002 AS cp_mfgr_3#6019, cp_type#6003 AS cp_type_3#6020, cp_size#6004 AS cp_size_3#6021, cp_container#6005 AS cp_container_3#6022, cp_retailprice#6006 AS cp_retailprice_3#6023, cp_comment#6007 AS cp_comment_3#6024, cp_brand#6008 AS cp_brand_3#6025]
            :     :        +- Relation[rid#5992,cval_part_p_name#5993,cval_part_p_mfgr#5994,cval_part_p_type#5995,cval_part_p_size#5996,cval_part_p_container#5997,cval_part_p_retailprice#5998,cval_part_p_comment#5999,cval_part_p_brand#6000,cp_name#6001,cp_mfgr#6002,cp_type#6003,cp_size#6004,cp_container#6005,cp_retailprice#6006,cp_comment#6007,cp_brand#6008] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#6026 AS rid_4#6037, cpfk_part_partsupp#6027 AS cpfk_part_partsupp_4#6038, cfpk_partsupp_part#6028 AS cfpk_partsupp_part_4#6039, cpfk_supplier_partsupp#6029 AS cpfk_supplier_partsupp_4#6040, cfpk_partsupp_supplier#6030 AS cfpk_partsupp_supplier_4#6041, cval_partsupp_ps_availqty#6031 AS cval_partsupp_ps_availqty_4#6042, cval_partsupp_ps_supplycost#6032 AS cval_partsupp_ps_supplycost_4#6043, cval_partsupp_ps_comment#6033 AS cval_partsupp_ps_comment_4#6044, cps_availqty#6034 AS cps_availqty_4#6045, cps_supplycost#6035 AS cps_supplycost_4#6046, cps_comment#6036 AS cps_comment_4#6047]
            :        +- Relation[rid#6026,cpfk_part_partsupp#6027,cfpk_partsupp_part#6028,cpfk_supplier_partsupp#6029,cfpk_partsupp_supplier#6030,cval_partsupp_ps_availqty#6031,cval_partsupp_ps_supplycost#6032,cval_partsupp_ps_comment#6033,cps_availqty#6034,cps_supplycost#6035,cps_comment#6036] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#6048 AS rid_5#6065, cpfk_customer_orders#6049 AS cpfk_customer_orders_5#6066, cfpk_orders_customer#6050 AS cfpk_orders_customer_5#6067, cval_orders_o_orderstatus#6051 AS cval_orders_o_orderstatus_5#6068, cval_orders_o_totalprice#6052 AS cval_orders_o_totalprice_5#6069, cval_orders_o_orderpriority#6053 AS cval_orders_o_orderpriority_5#6070, cval_orders_o_clerk#6054 AS cval_orders_o_clerk_5#6071, cval_orders_o_shippriority#6055 AS cval_orders_o_shippriority_5#6072, cval_orders_o_comment#6056 AS cval_orders_o_comment_5#6073, cval_orders_o_orderdate#6057 AS cval_orders_o_orderdate_5#6074, co_orderstatus#6058 AS co_orderstatus_5#6075, co_totalprice#6059 AS co_totalprice_5#6076, co_orderpriority#6060 AS co_orderpriority_5#6077, co_clerk#6061 AS co_clerk_5#6078, co_shippriority#6062 AS co_shippriority_5#6079, co_comment#6063 AS co_comment_5#6080, co_orderdate#6064 AS co_orderdate_5#6081]
               +- Relation[rid#6048,cpfk_customer_orders#6049,cfpk_orders_customer#6050,cval_orders_o_orderstatus#6051,cval_orders_o_totalprice#6052,cval_orders_o_orderpriority#6053,cval_orders_o_clerk#6054,cval_orders_o_shippriority#6055,cval_orders_o_comment#6056,cval_orders_o_orderdate#6057,co_orderstatus#6058,co_totalprice#6059,co_orderpriority#6060,co_clerk#6061,co_shippriority#6062,co_comment#6063,co_orderdate#6064] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 247364ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/11 05:59:15 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:59:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6188L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 05:59:15 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 05:59:15 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 05:59:15 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 05:59:15 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 05:59:15 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 05:59:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6188L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#6190 AS rid_0#6205, cpfk_nation_customer#6191 AS cpfk_nation_customer_0#6206, cfpk_customer_nation#6192 AS cfpk_customer_nation_0#6207, cval_customer_c_name#6193 AS cval_customer_c_name_0#6208, cval_customer_c_address#6194 AS cval_customer_c_address_0#6209, cval_customer_c_phone#6195 AS cval_customer_c_phone_0#6210, cval_customer_c_acctbal#6196 AS cval_customer_c_acctbal_0#6211, cval_customer_c_comment#6197 AS cval_customer_c_comment_0#6212, cval_customer_c_mktsegment#6198 AS cval_customer_c_mktsegment_0#6213, cc_name#6199 AS cc_name_0#6214, cc_address#6200 AS cc_address_0#6215, cc_phone#6201 AS cc_phone_0#6216, cc_acctbal#6202 AS cc_acctbal_0#6217, cc_comment#6203 AS cc_comment_0#6218, cc_mktsegment#6204 AS cc_mktsegment_0#6219]
         :  :  :  :  :  +- Relation[rid#6190,cpfk_nation_customer#6191,cfpk_customer_nation#6192,cval_customer_c_name#6193,cval_customer_c_address#6194,cval_customer_c_phone#6195,cval_customer_c_acctbal#6196,cval_customer_c_comment#6197,cval_customer_c_mktsegment#6198,cc_name#6199,cc_address#6200,cc_phone#6201,cc_acctbal#6202,cc_comment#6203,cc_mktsegment#6204] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#6220 AS rid_0#6235, cpfk_nation_customer#6221 AS cpfk_nation_customer_0#6236, cfpk_customer_nation#6222 AS cfpk_customer_nation_0#6237, cval_customer_c_name#6223 AS cval_customer_c_name_0#6238, cval_customer_c_address#6224 AS cval_customer_c_address_0#6239, cval_customer_c_phone#6225 AS cval_customer_c_phone_0#6240, cval_customer_c_acctbal#6226 AS cval_customer_c_acctbal_0#6241, cval_customer_c_comment#6227 AS cval_customer_c_comment_0#6242, cval_customer_c_mktsegment#6228 AS cval_customer_c_mktsegment_0#6243, cc_name#6229 AS cc_name_0#6244, cc_address#6230 AS cc_address_0#6245, cc_phone#6231 AS cc_phone_0#6246, cc_acctbal#6232 AS cc_acctbal_0#6247, cc_comment#6233 AS cc_comment_0#6248, cc_mktsegment#6234 AS cc_mktsegment_0#6249]
         :  :  :  :        +- Relation[rid#6220,cpfk_nation_customer#6221,cfpk_customer_nation#6222,cval_customer_c_name#6223,cval_customer_c_address#6224,cval_customer_c_phone#6225,cval_customer_c_acctbal#6226,cval_customer_c_comment#6227,cval_customer_c_mktsegment#6228,cc_name#6229,cc_address#6230,cc_phone#6231,cc_acctbal#6232,cc_comment#6233,cc_mktsegment#6234] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#6284 AS rid_0#6299, cpfk_nation_customer#6285 AS cpfk_nation_customer_0#6300, cfpk_customer_nation#6286 AS cfpk_customer_nation_0#6301, cval_customer_c_name#6287 AS cval_customer_c_name_0#6302, cval_customer_c_address#6288 AS cval_customer_c_address_0#6303, cval_customer_c_phone#6289 AS cval_customer_c_phone_0#6304, cval_customer_c_acctbal#6290 AS cval_customer_c_acctbal_0#6305, cval_customer_c_comment#6291 AS cval_customer_c_comment_0#6306, cval_customer_c_mktsegment#6292 AS cval_customer_c_mktsegment_0#6307, cc_name#6293 AS cc_name_0#6308, cc_address#6294 AS cc_address_0#6309, cc_phone#6295 AS cc_phone_0#6310, cc_acctbal#6296 AS cc_acctbal_0#6311, cc_comment#6297 AS cc_comment_0#6312, cc_mktsegment#6298 AS cc_mktsegment_0#6313]
         :  :  :     :  +- Relation[rid#6284,cpfk_nation_customer#6285,cfpk_customer_nation#6286,cval_customer_c_name#6287,cval_customer_c_address#6288,cval_customer_c_phone#6289,cval_customer_c_acctbal#6290,cval_customer_c_comment#6291,cval_customer_c_mktsegment#6292,cc_name#6293,cc_address#6294,cc_phone#6295,cc_acctbal#6296,cc_comment#6297,cc_mktsegment#6298] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#6314 AS rid_1#6331, cpfk_customer_orders#6315 AS cpfk_customer_orders_1#6332, cfpk_orders_customer#6316 AS cfpk_orders_customer_1#6333, cval_orders_o_orderstatus#6317 AS cval_orders_o_orderstatus_1#6334, cval_orders_o_totalprice#6318 AS cval_orders_o_totalprice_1#6335, cval_orders_o_orderpriority#6319 AS cval_orders_o_orderpriority_1#6336, cval_orders_o_clerk#6320 AS cval_orders_o_clerk_1#6337, cval_orders_o_shippriority#6321 AS cval_orders_o_shippriority_1#6338, cval_orders_o_comment#6322 AS cval_orders_o_comment_1#6339, cval_orders_o_orderdate#6323 AS cval_orders_o_orderdate_1#6340, co_orderstatus#6324 AS co_orderstatus_1#6341, co_totalprice#6325 AS co_totalprice_1#6342, co_orderpriority#6326 AS co_orderpriority_1#6343, co_clerk#6327 AS co_clerk_1#6344, co_shippriority#6328 AS co_shippriority_1#6345, co_comment#6329 AS co_comment_1#6346, co_orderdate#6330 AS co_orderdate_1#6347]
         :  :  :        +- Relation[rid#6314,cpfk_customer_orders#6315,cfpk_orders_customer#6316,cval_orders_o_orderstatus#6317,cval_orders_o_totalprice#6318,cval_orders_o_orderpriority#6319,cval_orders_o_clerk#6320,cval_orders_o_shippriority#6321,cval_orders_o_comment#6322,cval_orders_o_orderdate#6323,co_orderstatus#6324,co_totalprice#6325,co_orderpriority#6326,co_clerk#6327,co_shippriority#6328,co_comment#6329,co_orderdate#6330] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#6250 AS rid_1#6267, cpfk_customer_orders#6251 AS cpfk_customer_orders_1#6268, cfpk_orders_customer#6252 AS cfpk_orders_customer_1#6269, cval_orders_o_orderstatus#6253 AS cval_orders_o_orderstatus_1#6270, cval_orders_o_totalprice#6254 AS cval_orders_o_totalprice_1#6271, cval_orders_o_orderpriority#6255 AS cval_orders_o_orderpriority_1#6272, cval_orders_o_clerk#6256 AS cval_orders_o_clerk_1#6273, cval_orders_o_shippriority#6257 AS cval_orders_o_shippriority_1#6274, cval_orders_o_comment#6258 AS cval_orders_o_comment_1#6275, cval_orders_o_orderdate#6259 AS cval_orders_o_orderdate_1#6276, co_orderstatus#6260 AS co_orderstatus_1#6277, co_totalprice#6261 AS co_totalprice_1#6278, co_orderpriority#6262 AS co_orderpriority_1#6279, co_clerk#6263 AS co_clerk_1#6280, co_shippriority#6264 AS co_shippriority_1#6281, co_comment#6265 AS co_comment_1#6282, co_orderdate#6266 AS co_orderdate_1#6283]
         :  :     +- Relation[rid#6250,cpfk_customer_orders#6251,cfpk_orders_customer#6252,cval_orders_o_orderstatus#6253,cval_orders_o_totalprice#6254,cval_orders_o_orderpriority#6255,cval_orders_o_clerk#6256,cval_orders_o_shippriority#6257,cval_orders_o_comment#6258,cval_orders_o_orderdate#6259,co_orderstatus#6260,co_totalprice#6261,co_orderpriority#6262,co_clerk#6263,co_shippriority#6264,co_comment#6265,co_orderdate#6266] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#6414 AS rid_1#6431, cpfk_customer_orders#6415 AS cpfk_customer_orders_1#6432, cfpk_orders_customer#6416 AS cfpk_orders_customer_1#6433, cval_orders_o_orderstatus#6417 AS cval_orders_o_orderstatus_1#6434, cval_orders_o_totalprice#6418 AS cval_orders_o_totalprice_1#6435, cval_orders_o_orderpriority#6419 AS cval_orders_o_orderpriority_1#6436, cval_orders_o_clerk#6420 AS cval_orders_o_clerk_1#6437, cval_orders_o_shippriority#6421 AS cval_orders_o_shippriority_1#6438, cval_orders_o_comment#6422 AS cval_orders_o_comment_1#6439, cval_orders_o_orderdate#6423 AS cval_orders_o_orderdate_1#6440, co_orderstatus#6424 AS co_orderstatus_1#6441, co_totalprice#6425 AS co_totalprice_1#6442, co_orderpriority#6426 AS co_orderpriority_1#6443, co_clerk#6427 AS co_clerk_1#6444, co_shippriority#6428 AS co_shippriority_1#6445, co_comment#6429 AS co_comment_1#6446, co_orderdate#6430 AS co_orderdate_1#6447]
         :     :  +- Relation[rid#6414,cpfk_customer_orders#6415,cfpk_orders_customer#6416,cval_orders_o_orderstatus#6417,cval_orders_o_totalprice#6418,cval_orders_o_orderpriority#6419,cval_orders_o_clerk#6420,cval_orders_o_shippriority#6421,cval_orders_o_comment#6422,cval_orders_o_orderdate#6423,co_orderstatus#6424,co_totalprice#6425,co_orderpriority#6426,co_clerk#6427,co_shippriority#6428,co_comment#6429,co_orderdate#6430] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#6448 AS rid_2#6481, cpfk_orders_lineitem#6449 AS cpfk_orders_lineitem_2#6482, cpfk_supplier_lineitem#6450 AS cpfk_supplier_lineitem_2#6483, cfpk_lineitem_supplier#6451 AS cfpk_lineitem_supplier_2#6484, cfpk_lineitem_partsupp#6452 AS cfpk_lineitem_partsupp_2#6485, cpfk_part_lineitem#6453 AS cpfk_part_lineitem_2#6486, cfpk_lineitem_part#6454 AS cfpk_lineitem_part_2#6487, cpfk_partsupp_lineitem#6455 AS cpfk_partsupp_lineitem_2#6488, cfpk_lineitem_orders#6456 AS cfpk_lineitem_orders_2#6489, cval_lineitem_l_quantity#6457 AS cval_lineitem_l_quantity_2#6490, cval_lineitem_l_extendedprice#6458 AS cval_lineitem_l_extendedprice_2#6491, cval_lineitem_l_discount#6459 AS cval_lineitem_l_discount_2#6492, cval_lineitem_l_tax#6460 AS cval_lineitem_l_tax_2#6493, cval_lineitem_l_returnflag#6461 AS cval_lineitem_l_returnflag_2#6494, cval_lineitem_l_linestatus#6462 AS cval_lineitem_l_linestatus_2#6495, cval_lineitem_l_commitdate#6463 AS cval_lineitem_l_commitdate_2#6496, cval_lineitem_l_receiptdate#6464 AS cval_lineitem_l_receiptdate_2#6497, cval_lineitem_l_shipinstruct#6465 AS cval_lineitem_l_shipinstruct_2#6498, cval_lineitem_l_shipmode#6466 AS cval_lineitem_l_shipmode_2#6499, cval_lineitem_l_comment#6467 AS cval_lineitem_l_comment_2#6500, cval_lineitem_l_shipdate#6468 AS cval_lineitem_l_shipdate_2#6501, cl_quantity#6469 AS cl_quantity_2#6502, cl_extendedprice#6470 AS cl_extendedprice_2#6503, cl_discount#6471 AS cl_discount_2#6504, ... 9 more fields]
         :        +- Relation[rid#6448,cpfk_orders_lineitem#6449,cpfk_supplier_lineitem#6450,cfpk_lineitem_supplier#6451,cfpk_lineitem_partsupp#6452,cpfk_part_lineitem#6453,cfpk_lineitem_part#6454,cpfk_partsupp_lineitem#6455,cfpk_lineitem_orders#6456,cval_lineitem_l_quantity#6457,cval_lineitem_l_extendedprice#6458,cval_lineitem_l_discount#6459,cval_lineitem_l_tax#6460,cval_lineitem_l_returnflag#6461,cval_lineitem_l_linestatus#6462,cval_lineitem_l_commitdate#6463,cval_lineitem_l_receiptdate#6464,cval_lineitem_l_shipinstruct#6465,cval_lineitem_l_shipmode#6466,cval_lineitem_l_comment#6467,cval_lineitem_l_shipdate#6468,cl_quantity#6469,cl_extendedprice#6470,cl_discount#6471,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6348 AS rid_2#6381, cpfk_orders_lineitem#6349 AS cpfk_orders_lineitem_2#6382, cpfk_supplier_lineitem#6350 AS cpfk_supplier_lineitem_2#6383, cfpk_lineitem_supplier#6351 AS cfpk_lineitem_supplier_2#6384, cfpk_lineitem_partsupp#6352 AS cfpk_lineitem_partsupp_2#6385, cpfk_part_lineitem#6353 AS cpfk_part_lineitem_2#6386, cfpk_lineitem_part#6354 AS cfpk_lineitem_part_2#6387, cpfk_partsupp_lineitem#6355 AS cpfk_partsupp_lineitem_2#6388, cfpk_lineitem_orders#6356 AS cfpk_lineitem_orders_2#6389, cval_lineitem_l_quantity#6357 AS cval_lineitem_l_quantity_2#6390, cval_lineitem_l_extendedprice#6358 AS cval_lineitem_l_extendedprice_2#6391, cval_lineitem_l_discount#6359 AS cval_lineitem_l_discount_2#6392, cval_lineitem_l_tax#6360 AS cval_lineitem_l_tax_2#6393, cval_lineitem_l_returnflag#6361 AS cval_lineitem_l_returnflag_2#6394, cval_lineitem_l_linestatus#6362 AS cval_lineitem_l_linestatus_2#6395, cval_lineitem_l_commitdate#6363 AS cval_lineitem_l_commitdate_2#6396, cval_lineitem_l_receiptdate#6364 AS cval_lineitem_l_receiptdate_2#6397, cval_lineitem_l_shipinstruct#6365 AS cval_lineitem_l_shipinstruct_2#6398, cval_lineitem_l_shipmode#6366 AS cval_lineitem_l_shipmode_2#6399, cval_lineitem_l_comment#6367 AS cval_lineitem_l_comment_2#6400, cval_lineitem_l_shipdate#6368 AS cval_lineitem_l_shipdate_2#6401, cl_quantity#6369 AS cl_quantity_2#6402, cl_extendedprice#6370 AS cl_extendedprice_2#6403, cl_discount#6371 AS cl_discount_2#6404, ... 9 more fields]
            +- Relation[rid#6348,cpfk_orders_lineitem#6349,cpfk_supplier_lineitem#6350,cfpk_lineitem_supplier#6351,cfpk_lineitem_partsupp#6352,cpfk_part_lineitem#6353,cfpk_lineitem_part#6354,cpfk_partsupp_lineitem#6355,cfpk_lineitem_orders#6356,cval_lineitem_l_quantity#6357,cval_lineitem_l_extendedprice#6358,cval_lineitem_l_discount#6359,cval_lineitem_l_tax#6360,cval_lineitem_l_returnflag#6361,cval_lineitem_l_linestatus#6362,cval_lineitem_l_commitdate#6363,cval_lineitem_l_receiptdate#6364,cval_lineitem_l_shipinstruct#6365,cval_lineitem_l_shipmode#6366,cval_lineitem_l_comment#6367,cval_lineitem_l_shipdate#6368,cl_quantity#6369,cl_extendedprice#6370,cl_discount#6371,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 117364ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/11 06:01:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:01:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6588L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 06:01:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6588L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#6590 AS rid_0#6605, cpfk_nation_customer#6591 AS cpfk_nation_customer_0#6606, cfpk_customer_nation#6592 AS cfpk_customer_nation_0#6607, cval_customer_c_name#6593 AS cval_customer_c_name_0#6608, cval_customer_c_address#6594 AS cval_customer_c_address_0#6609, cval_customer_c_phone#6595 AS cval_customer_c_phone_0#6610, cval_customer_c_acctbal#6596 AS cval_customer_c_acctbal_0#6611, cval_customer_c_comment#6597 AS cval_customer_c_comment_0#6612, cval_customer_c_mktsegment#6598 AS cval_customer_c_mktsegment_0#6613, cc_name#6599 AS cc_name_0#6614, cc_address#6600 AS cc_address_0#6615, cc_phone#6601 AS cc_phone_0#6616, cc_acctbal#6602 AS cc_acctbal_0#6617, cc_comment#6603 AS cc_comment_0#6618, cc_mktsegment#6604 AS cc_mktsegment_0#6619]
         :  :  :  :  +- Relation[rid#6590,cpfk_nation_customer#6591,cfpk_customer_nation#6592,cval_customer_c_name#6593,cval_customer_c_address#6594,cval_customer_c_phone#6595,cval_customer_c_acctbal#6596,cval_customer_c_comment#6597,cval_customer_c_mktsegment#6598,cc_name#6599,cc_address#6600,cc_phone#6601,cc_acctbal#6602,cc_comment#6603,cc_mktsegment#6604] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#6654 AS rid_0#6669, cpfk_nation_customer#6655 AS cpfk_nation_customer_0#6670, cfpk_customer_nation#6656 AS cfpk_customer_nation_0#6671, cval_customer_c_name#6657 AS cval_customer_c_name_0#6672, cval_customer_c_address#6658 AS cval_customer_c_address_0#6673, cval_customer_c_phone#6659 AS cval_customer_c_phone_0#6674, cval_customer_c_acctbal#6660 AS cval_customer_c_acctbal_0#6675, cval_customer_c_comment#6661 AS cval_customer_c_comment_0#6676, cval_customer_c_mktsegment#6662 AS cval_customer_c_mktsegment_0#6677, cc_name#6663 AS cc_name_0#6678, cc_address#6664 AS cc_address_0#6679, cc_phone#6665 AS cc_phone_0#6680, cc_acctbal#6666 AS cc_acctbal_0#6681, cc_comment#6667 AS cc_comment_0#6682, cc_mktsegment#6668 AS cc_mktsegment_0#6683]
         :  :  :     :  +- Relation[rid#6654,cpfk_nation_customer#6655,cfpk_customer_nation#6656,cval_customer_c_name#6657,cval_customer_c_address#6658,cval_customer_c_phone#6659,cval_customer_c_acctbal#6660,cval_customer_c_comment#6661,cval_customer_c_mktsegment#6662,cc_name#6663,cc_address#6664,cc_phone#6665,cc_acctbal#6666,cc_comment#6667,cc_mktsegment#6668] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#6684 AS rid_1#6701, cpfk_customer_orders#6685 AS cpfk_customer_orders_1#6702, cfpk_orders_customer#6686 AS cfpk_orders_customer_1#6703, cval_orders_o_orderstatus#6687 AS cval_orders_o_orderstatus_1#6704, cval_orders_o_totalprice#6688 AS cval_orders_o_totalprice_1#6705, cval_orders_o_orderpriority#6689 AS cval_orders_o_orderpriority_1#6706, cval_orders_o_clerk#6690 AS cval_orders_o_clerk_1#6707, cval_orders_o_shippriority#6691 AS cval_orders_o_shippriority_1#6708, cval_orders_o_comment#6692 AS cval_orders_o_comment_1#6709, cval_orders_o_orderdate#6693 AS cval_orders_o_orderdate_1#6710, co_orderstatus#6694 AS co_orderstatus_1#6711, co_totalprice#6695 AS co_totalprice_1#6712, co_orderpriority#6696 AS co_orderpriority_1#6713, co_clerk#6697 AS co_clerk_1#6714, co_shippriority#6698 AS co_shippriority_1#6715, co_comment#6699 AS co_comment_1#6716, co_orderdate#6700 AS co_orderdate_1#6717]
         :  :  :        +- Relation[rid#6684,cpfk_customer_orders#6685,cfpk_orders_customer#6686,cval_orders_o_orderstatus#6687,cval_orders_o_totalprice#6688,cval_orders_o_orderpriority#6689,cval_orders_o_clerk#6690,cval_orders_o_shippriority#6691,cval_orders_o_comment#6692,cval_orders_o_orderdate#6693,co_orderstatus#6694,co_totalprice#6695,co_orderpriority#6696,co_clerk#6697,co_shippriority#6698,co_comment#6699,co_orderdate#6700] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#6620 AS rid_1#6637, cpfk_customer_orders#6621 AS cpfk_customer_orders_1#6638, cfpk_orders_customer#6622 AS cfpk_orders_customer_1#6639, cval_orders_o_orderstatus#6623 AS cval_orders_o_orderstatus_1#6640, cval_orders_o_totalprice#6624 AS cval_orders_o_totalprice_1#6641, cval_orders_o_orderpriority#6625 AS cval_orders_o_orderpriority_1#6642, cval_orders_o_clerk#6626 AS cval_orders_o_clerk_1#6643, cval_orders_o_shippriority#6627 AS cval_orders_o_shippriority_1#6644, cval_orders_o_comment#6628 AS cval_orders_o_comment_1#6645, cval_orders_o_orderdate#6629 AS cval_orders_o_orderdate_1#6646, co_orderstatus#6630 AS co_orderstatus_1#6647, co_totalprice#6631 AS co_totalprice_1#6648, co_orderpriority#6632 AS co_orderpriority_1#6649, co_clerk#6633 AS co_clerk_1#6650, co_shippriority#6634 AS co_shippriority_1#6651, co_comment#6635 AS co_comment_1#6652, co_orderdate#6636 AS co_orderdate_1#6653]
         :  :     +- Relation[rid#6620,cpfk_customer_orders#6621,cfpk_orders_customer#6622,cval_orders_o_orderstatus#6623,cval_orders_o_totalprice#6624,cval_orders_o_orderpriority#6625,cval_orders_o_clerk#6626,cval_orders_o_shippriority#6627,cval_orders_o_comment#6628,cval_orders_o_orderdate#6629,co_orderstatus#6630,co_totalprice#6631,co_orderpriority#6632,co_clerk#6633,co_shippriority#6634,co_comment#6635,co_orderdate#6636] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#6784 AS rid_1#6801, cpfk_customer_orders#6785 AS cpfk_customer_orders_1#6802, cfpk_orders_customer#6786 AS cfpk_orders_customer_1#6803, cval_orders_o_orderstatus#6787 AS cval_orders_o_orderstatus_1#6804, cval_orders_o_totalprice#6788 AS cval_orders_o_totalprice_1#6805, cval_orders_o_orderpriority#6789 AS cval_orders_o_orderpriority_1#6806, cval_orders_o_clerk#6790 AS cval_orders_o_clerk_1#6807, cval_orders_o_shippriority#6791 AS cval_orders_o_shippriority_1#6808, cval_orders_o_comment#6792 AS cval_orders_o_comment_1#6809, cval_orders_o_orderdate#6793 AS cval_orders_o_orderdate_1#6810, co_orderstatus#6794 AS co_orderstatus_1#6811, co_totalprice#6795 AS co_totalprice_1#6812, co_orderpriority#6796 AS co_orderpriority_1#6813, co_clerk#6797 AS co_clerk_1#6814, co_shippriority#6798 AS co_shippriority_1#6815, co_comment#6799 AS co_comment_1#6816, co_orderdate#6800 AS co_orderdate_1#6817]
         :     :  +- Relation[rid#6784,cpfk_customer_orders#6785,cfpk_orders_customer#6786,cval_orders_o_orderstatus#6787,cval_orders_o_totalprice#6788,cval_orders_o_orderpriority#6789,cval_orders_o_clerk#6790,cval_orders_o_shippriority#6791,cval_orders_o_comment#6792,cval_orders_o_orderdate#6793,co_orderstatus#6794,co_totalprice#6795,co_orderpriority#6796,co_clerk#6797,co_shippriority#6798,co_comment#6799,co_orderdate#6800] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#6818 AS rid_2#6851, cpfk_orders_lineitem#6819 AS cpfk_orders_lineitem_2#6852, cpfk_supplier_lineitem#6820 AS cpfk_supplier_lineitem_2#6853, cfpk_lineitem_supplier#6821 AS cfpk_lineitem_supplier_2#6854, cfpk_lineitem_partsupp#6822 AS cfpk_lineitem_partsupp_2#6855, cpfk_part_lineitem#6823 AS cpfk_part_lineitem_2#6856, cfpk_lineitem_part#6824 AS cfpk_lineitem_part_2#6857, cpfk_partsupp_lineitem#6825 AS cpfk_partsupp_lineitem_2#6858, cfpk_lineitem_orders#6826 AS cfpk_lineitem_orders_2#6859, cval_lineitem_l_quantity#6827 AS cval_lineitem_l_quantity_2#6860, cval_lineitem_l_extendedprice#6828 AS cval_lineitem_l_extendedprice_2#6861, cval_lineitem_l_discount#6829 AS cval_lineitem_l_discount_2#6862, cval_lineitem_l_tax#6830 AS cval_lineitem_l_tax_2#6863, cval_lineitem_l_returnflag#6831 AS cval_lineitem_l_returnflag_2#6864, cval_lineitem_l_linestatus#6832 AS cval_lineitem_l_linestatus_2#6865, cval_lineitem_l_commitdate#6833 AS cval_lineitem_l_commitdate_2#6866, cval_lineitem_l_receiptdate#6834 AS cval_lineitem_l_receiptdate_2#6867, cval_lineitem_l_shipinstruct#6835 AS cval_lineitem_l_shipinstruct_2#6868, cval_lineitem_l_shipmode#6836 AS cval_lineitem_l_shipmode_2#6869, cval_lineitem_l_comment#6837 AS cval_lineitem_l_comment_2#6870, cval_lineitem_l_shipdate#6838 AS cval_lineitem_l_shipdate_2#6871, cl_quantity#6839 AS cl_quantity_2#6872, cl_extendedprice#6840 AS cl_extendedprice_2#6873, cl_discount#6841 AS cl_discount_2#6874, ... 9 more fields]
         :        +- Relation[rid#6818,cpfk_orders_lineitem#6819,cpfk_supplier_lineitem#6820,cfpk_lineitem_supplier#6821,cfpk_lineitem_partsupp#6822,cpfk_part_lineitem#6823,cfpk_lineitem_part#6824,cpfk_partsupp_lineitem#6825,cfpk_lineitem_orders#6826,cval_lineitem_l_quantity#6827,cval_lineitem_l_extendedprice#6828,cval_lineitem_l_discount#6829,cval_lineitem_l_tax#6830,cval_lineitem_l_returnflag#6831,cval_lineitem_l_linestatus#6832,cval_lineitem_l_commitdate#6833,cval_lineitem_l_receiptdate#6834,cval_lineitem_l_shipinstruct#6835,cval_lineitem_l_shipmode#6836,cval_lineitem_l_comment#6837,cval_lineitem_l_shipdate#6838,cl_quantity#6839,cl_extendedprice#6840,cl_discount#6841,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6718 AS rid_2#6751, cpfk_orders_lineitem#6719 AS cpfk_orders_lineitem_2#6752, cpfk_supplier_lineitem#6720 AS cpfk_supplier_lineitem_2#6753, cfpk_lineitem_supplier#6721 AS cfpk_lineitem_supplier_2#6754, cfpk_lineitem_partsupp#6722 AS cfpk_lineitem_partsupp_2#6755, cpfk_part_lineitem#6723 AS cpfk_part_lineitem_2#6756, cfpk_lineitem_part#6724 AS cfpk_lineitem_part_2#6757, cpfk_partsupp_lineitem#6725 AS cpfk_partsupp_lineitem_2#6758, cfpk_lineitem_orders#6726 AS cfpk_lineitem_orders_2#6759, cval_lineitem_l_quantity#6727 AS cval_lineitem_l_quantity_2#6760, cval_lineitem_l_extendedprice#6728 AS cval_lineitem_l_extendedprice_2#6761, cval_lineitem_l_discount#6729 AS cval_lineitem_l_discount_2#6762, cval_lineitem_l_tax#6730 AS cval_lineitem_l_tax_2#6763, cval_lineitem_l_returnflag#6731 AS cval_lineitem_l_returnflag_2#6764, cval_lineitem_l_linestatus#6732 AS cval_lineitem_l_linestatus_2#6765, cval_lineitem_l_commitdate#6733 AS cval_lineitem_l_commitdate_2#6766, cval_lineitem_l_receiptdate#6734 AS cval_lineitem_l_receiptdate_2#6767, cval_lineitem_l_shipinstruct#6735 AS cval_lineitem_l_shipinstruct_2#6768, cval_lineitem_l_shipmode#6736 AS cval_lineitem_l_shipmode_2#6769, cval_lineitem_l_comment#6737 AS cval_lineitem_l_comment_2#6770, cval_lineitem_l_shipdate#6738 AS cval_lineitem_l_shipdate_2#6771, cl_quantity#6739 AS cl_quantity_2#6772, cl_extendedprice#6740 AS cl_extendedprice_2#6773, cl_discount#6741 AS cl_discount_2#6774, ... 9 more fields]
            +- Relation[rid#6718,cpfk_orders_lineitem#6719,cpfk_supplier_lineitem#6720,cfpk_lineitem_supplier#6721,cfpk_lineitem_partsupp#6722,cpfk_part_lineitem#6723,cfpk_lineitem_part#6724,cpfk_partsupp_lineitem#6725,cfpk_lineitem_orders#6726,cval_lineitem_l_quantity#6727,cval_lineitem_l_extendedprice#6728,cval_lineitem_l_discount#6729,cval_lineitem_l_tax#6730,cval_lineitem_l_returnflag#6731,cval_lineitem_l_linestatus#6732,cval_lineitem_l_commitdate#6733,cval_lineitem_l_receiptdate#6734,cval_lineitem_l_shipinstruct#6735,cval_lineitem_l_shipmode#6736,cval_lineitem_l_comment#6737,cval_lineitem_l_shipdate#6738,cl_quantity#6739,cl_extendedprice#6740,cl_discount#6741,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 118432ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/11 06:03:11 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:03:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6956L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 06:03:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:03:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:03:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:03:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6956L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#6958 AS rid_0#6971, cpfk_nation_supplier#6959 AS cpfk_nation_supplier_0#6972, cfpk_supplier_nation#6960 AS cfpk_supplier_nation_0#6973, cval_supplier_s_name#6961 AS cval_supplier_s_name_0#6974, cval_supplier_s_address#6962 AS cval_supplier_s_address_0#6975, cval_supplier_s_phone#6963 AS cval_supplier_s_phone_0#6976, cval_supplier_s_acctbal#6964 AS cval_supplier_s_acctbal_0#6977, cval_supplier_s_comment#6965 AS cval_supplier_s_comment_0#6978, cs_name#6966 AS cs_name_0#6979, cs_address#6967 AS cs_address_0#6980, cs_phone#6968 AS cs_phone_0#6981, cs_acctbal#6969 AS cs_acctbal_0#6982, cs_comment#6970 AS cs_comment_0#6983]
         :  :  +- Relation[rid#6958,cpfk_nation_supplier#6959,cfpk_supplier_nation#6960,cval_supplier_s_name#6961,cval_supplier_s_address#6962,cval_supplier_s_phone#6963,cval_supplier_s_acctbal#6964,cval_supplier_s_comment#6965,cs_name#6966,cs_address#6967,cs_phone#6968,cs_acctbal#6969,cs_comment#6970] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#7050 AS rid_0#7063, cpfk_nation_supplier#7051 AS cpfk_nation_supplier_0#7064, cfpk_supplier_nation#7052 AS cfpk_supplier_nation_0#7065, cval_supplier_s_name#7053 AS cval_supplier_s_name_0#7066, cval_supplier_s_address#7054 AS cval_supplier_s_address_0#7067, cval_supplier_s_phone#7055 AS cval_supplier_s_phone_0#7068, cval_supplier_s_acctbal#7056 AS cval_supplier_s_acctbal_0#7069, cval_supplier_s_comment#7057 AS cval_supplier_s_comment_0#7070, cs_name#7058 AS cs_name_0#7071, cs_address#7059 AS cs_address_0#7072, cs_phone#7060 AS cs_phone_0#7073, cs_acctbal#7061 AS cs_acctbal_0#7074, cs_comment#7062 AS cs_comment_0#7075]
         :     :  +- Relation[rid#7050,cpfk_nation_supplier#7051,cfpk_supplier_nation#7052,cval_supplier_s_name#7053,cval_supplier_s_address#7054,cval_supplier_s_phone#7055,cval_supplier_s_acctbal#7056,cval_supplier_s_comment#7057,cs_name#7058,cs_address#7059,cs_phone#7060,cs_acctbal#7061,cs_comment#7062] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#7076 AS rid_1#7109, cpfk_orders_lineitem#7077 AS cpfk_orders_lineitem_1#7110, cpfk_supplier_lineitem#7078 AS cpfk_supplier_lineitem_1#7111, cfpk_lineitem_supplier#7079 AS cfpk_lineitem_supplier_1#7112, cfpk_lineitem_partsupp#7080 AS cfpk_lineitem_partsupp_1#7113, cpfk_part_lineitem#7081 AS cpfk_part_lineitem_1#7114, cfpk_lineitem_part#7082 AS cfpk_lineitem_part_1#7115, cpfk_partsupp_lineitem#7083 AS cpfk_partsupp_lineitem_1#7116, cfpk_lineitem_orders#7084 AS cfpk_lineitem_orders_1#7117, cval_lineitem_l_quantity#7085 AS cval_lineitem_l_quantity_1#7118, cval_lineitem_l_extendedprice#7086 AS cval_lineitem_l_extendedprice_1#7119, cval_lineitem_l_discount#7087 AS cval_lineitem_l_discount_1#7120, cval_lineitem_l_tax#7088 AS cval_lineitem_l_tax_1#7121, cval_lineitem_l_returnflag#7089 AS cval_lineitem_l_returnflag_1#7122, cval_lineitem_l_linestatus#7090 AS cval_lineitem_l_linestatus_1#7123, cval_lineitem_l_commitdate#7091 AS cval_lineitem_l_commitdate_1#7124, cval_lineitem_l_receiptdate#7092 AS cval_lineitem_l_receiptdate_1#7125, cval_lineitem_l_shipinstruct#7093 AS cval_lineitem_l_shipinstruct_1#7126, cval_lineitem_l_shipmode#7094 AS cval_lineitem_l_shipmode_1#7127, cval_lineitem_l_comment#7095 AS cval_lineitem_l_comment_1#7128, cval_lineitem_l_shipdate#7096 AS cval_lineitem_l_shipdate_1#7129, cl_quantity#7097 AS cl_quantity_1#7130, cl_extendedprice#7098 AS cl_extendedprice_1#7131, cl_discount#7099 AS cl_discount_1#7132, ... 9 more fields]
         :        +- Relation[rid#7076,cpfk_orders_lineitem#7077,cpfk_supplier_lineitem#7078,cfpk_lineitem_supplier#7079,cfpk_lineitem_partsupp#7080,cpfk_part_lineitem#7081,cfpk_lineitem_part#7082,cpfk_partsupp_lineitem#7083,cfpk_lineitem_orders#7084,cval_lineitem_l_quantity#7085,cval_lineitem_l_extendedprice#7086,cval_lineitem_l_discount#7087,cval_lineitem_l_tax#7088,cval_lineitem_l_returnflag#7089,cval_lineitem_l_linestatus#7090,cval_lineitem_l_commitdate#7091,cval_lineitem_l_receiptdate#7092,cval_lineitem_l_shipinstruct#7093,cval_lineitem_l_shipmode#7094,cval_lineitem_l_comment#7095,cval_lineitem_l_shipdate#7096,cl_quantity#7097,cl_extendedprice#7098,cl_discount#7099,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6984 AS rid_1#7017, cpfk_orders_lineitem#6985 AS cpfk_orders_lineitem_1#7018, cpfk_supplier_lineitem#6986 AS cpfk_supplier_lineitem_1#7019, cfpk_lineitem_supplier#6987 AS cfpk_lineitem_supplier_1#7020, cfpk_lineitem_partsupp#6988 AS cfpk_lineitem_partsupp_1#7021, cpfk_part_lineitem#6989 AS cpfk_part_lineitem_1#7022, cfpk_lineitem_part#6990 AS cfpk_lineitem_part_1#7023, cpfk_partsupp_lineitem#6991 AS cpfk_partsupp_lineitem_1#7024, cfpk_lineitem_orders#6992 AS cfpk_lineitem_orders_1#7025, cval_lineitem_l_quantity#6993 AS cval_lineitem_l_quantity_1#7026, cval_lineitem_l_extendedprice#6994 AS cval_lineitem_l_extendedprice_1#7027, cval_lineitem_l_discount#6995 AS cval_lineitem_l_discount_1#7028, cval_lineitem_l_tax#6996 AS cval_lineitem_l_tax_1#7029, cval_lineitem_l_returnflag#6997 AS cval_lineitem_l_returnflag_1#7030, cval_lineitem_l_linestatus#6998 AS cval_lineitem_l_linestatus_1#7031, cval_lineitem_l_commitdate#6999 AS cval_lineitem_l_commitdate_1#7032, cval_lineitem_l_receiptdate#7000 AS cval_lineitem_l_receiptdate_1#7033, cval_lineitem_l_shipinstruct#7001 AS cval_lineitem_l_shipinstruct_1#7034, cval_lineitem_l_shipmode#7002 AS cval_lineitem_l_shipmode_1#7035, cval_lineitem_l_comment#7003 AS cval_lineitem_l_comment_1#7036, cval_lineitem_l_shipdate#7004 AS cval_lineitem_l_shipdate_1#7037, cl_quantity#7005 AS cl_quantity_1#7038, cl_extendedprice#7006 AS cl_extendedprice_1#7039, cl_discount#7007 AS cl_discount_1#7040, ... 9 more fields]
            +- Relation[rid#6984,cpfk_orders_lineitem#6985,cpfk_supplier_lineitem#6986,cfpk_lineitem_supplier#6987,cfpk_lineitem_partsupp#6988,cpfk_part_lineitem#6989,cfpk_lineitem_part#6990,cpfk_partsupp_lineitem#6991,cfpk_lineitem_orders#6992,cval_lineitem_l_quantity#6993,cval_lineitem_l_extendedprice#6994,cval_lineitem_l_discount#6995,cval_lineitem_l_tax#6996,cval_lineitem_l_returnflag#6997,cval_lineitem_l_linestatus#6998,cval_lineitem_l_commitdate#6999,cval_lineitem_l_receiptdate#7000,cval_lineitem_l_shipinstruct#7001,cval_lineitem_l_shipmode#7002,cval_lineitem_l_comment#7003,cval_lineitem_l_shipdate#7004,cl_quantity#7005,cl_extendedprice#7006,cl_discount#7007,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 77616ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/11 06:04:29 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:04:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7193L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 06:04:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:04:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:04:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:04:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:04:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:04:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:04:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:04:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7193L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#7195 AS rid_0#7212, cval_part_p_name#7196 AS cval_part_p_name_0#7213, cval_part_p_mfgr#7197 AS cval_part_p_mfgr_0#7214, cval_part_p_type#7198 AS cval_part_p_type_0#7215, cval_part_p_size#7199 AS cval_part_p_size_0#7216, cval_part_p_container#7200 AS cval_part_p_container_0#7217, cval_part_p_retailprice#7201 AS cval_part_p_retailprice_0#7218, cval_part_p_comment#7202 AS cval_part_p_comment_0#7219, cval_part_p_brand#7203 AS cval_part_p_brand_0#7220, cp_name#7204 AS cp_name_0#7221, cp_mfgr#7205 AS cp_mfgr_0#7222, cp_type#7206 AS cp_type_0#7223, cp_size#7207 AS cp_size_0#7224, cp_container#7208 AS cp_container_0#7225, cp_retailprice#7209 AS cp_retailprice_0#7226, cp_comment#7210 AS cp_comment_0#7227, cp_brand#7211 AS cp_brand_0#7228]
         :  :  :  :  +- Relation[rid#7195,cval_part_p_name#7196,cval_part_p_mfgr#7197,cval_part_p_type#7198,cval_part_p_size#7199,cval_part_p_container#7200,cval_part_p_retailprice#7201,cval_part_p_comment#7202,cval_part_p_brand#7203,cp_name#7204,cp_mfgr#7205,cp_type#7206,cp_size#7207,cp_container#7208,cp_retailprice#7209,cp_comment#7210,cp_brand#7211] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#7229 AS rid_0#7246, cval_part_p_name#7230 AS cval_part_p_name_0#7247, cval_part_p_mfgr#7231 AS cval_part_p_mfgr_0#7248, cval_part_p_type#7232 AS cval_part_p_type_0#7249, cval_part_p_size#7233 AS cval_part_p_size_0#7250, cval_part_p_container#7234 AS cval_part_p_container_0#7251, cval_part_p_retailprice#7235 AS cval_part_p_retailprice_0#7252, cval_part_p_comment#7236 AS cval_part_p_comment_0#7253, cval_part_p_brand#7237 AS cval_part_p_brand_0#7254, cp_name#7238 AS cp_name_0#7255, cp_mfgr#7239 AS cp_mfgr_0#7256, cp_type#7240 AS cp_type_0#7257, cp_size#7241 AS cp_size_0#7258, cp_container#7242 AS cp_container_0#7259, cp_retailprice#7243 AS cp_retailprice_0#7260, cp_comment#7244 AS cp_comment_0#7261, cp_brand#7245 AS cp_brand_0#7262]
         :  :  :        +- Relation[rid#7229,cval_part_p_name#7230,cval_part_p_mfgr#7231,cval_part_p_type#7232,cval_part_p_size#7233,cval_part_p_container#7234,cval_part_p_retailprice#7235,cval_part_p_comment#7236,cval_part_p_brand#7237,cp_name#7238,cp_mfgr#7239,cp_type#7240,cp_size#7241,cp_container#7242,cp_retailprice#7243,cp_comment#7244,cp_brand#7245] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#7263 AS rid_0#7280, cval_part_p_name#7264 AS cval_part_p_name_0#7281, cval_part_p_mfgr#7265 AS cval_part_p_mfgr_0#7282, cval_part_p_type#7266 AS cval_part_p_type_0#7283, cval_part_p_size#7267 AS cval_part_p_size_0#7284, cval_part_p_container#7268 AS cval_part_p_container_0#7285, cval_part_p_retailprice#7269 AS cval_part_p_retailprice_0#7286, cval_part_p_comment#7270 AS cval_part_p_comment_0#7287, cval_part_p_brand#7271 AS cval_part_p_brand_0#7288, cp_name#7272 AS cp_name_0#7289, cp_mfgr#7273 AS cp_mfgr_0#7290, cp_type#7274 AS cp_type_0#7291, cp_size#7275 AS cp_size_0#7292, cp_container#7276 AS cp_container_0#7293, cp_retailprice#7277 AS cp_retailprice_0#7294, cp_comment#7278 AS cp_comment_0#7295, cp_brand#7279 AS cp_brand_0#7296]
         :  :        +- Relation[rid#7263,cval_part_p_name#7264,cval_part_p_mfgr#7265,cval_part_p_type#7266,cval_part_p_size#7267,cval_part_p_container#7268,cval_part_p_retailprice#7269,cval_part_p_comment#7270,cval_part_p_brand#7271,cp_name#7272,cp_mfgr#7273,cp_type#7274,cp_size#7275,cp_container#7276,cp_retailprice#7277,cp_comment#7278,cp_brand#7279] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#7495 AS rid_0#7512, cval_part_p_name#7496 AS cval_part_p_name_0#7513, cval_part_p_mfgr#7497 AS cval_part_p_mfgr_0#7514, cval_part_p_type#7498 AS cval_part_p_type_0#7515, cval_part_p_size#7499 AS cval_part_p_size_0#7516, cval_part_p_container#7500 AS cval_part_p_container_0#7517, cval_part_p_retailprice#7501 AS cval_part_p_retailprice_0#7518, cval_part_p_comment#7502 AS cval_part_p_comment_0#7519, cval_part_p_brand#7503 AS cval_part_p_brand_0#7520, cp_name#7504 AS cp_name_0#7521, cp_mfgr#7505 AS cp_mfgr_0#7522, cp_type#7506 AS cp_type_0#7523, cp_size#7507 AS cp_size_0#7524, cp_container#7508 AS cp_container_0#7525, cp_retailprice#7509 AS cp_retailprice_0#7526, cp_comment#7510 AS cp_comment_0#7527, cp_brand#7511 AS cp_brand_0#7528]
         :     :  +- Relation[rid#7495,cval_part_p_name#7496,cval_part_p_mfgr#7497,cval_part_p_type#7498,cval_part_p_size#7499,cval_part_p_container#7500,cval_part_p_retailprice#7501,cval_part_p_comment#7502,cval_part_p_brand#7503,cp_name#7504,cp_mfgr#7505,cp_type#7506,cp_size#7507,cp_container#7508,cp_retailprice#7509,cp_comment#7510,cp_brand#7511] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#7529 AS rid_1#7562, cpfk_orders_lineitem#7530 AS cpfk_orders_lineitem_1#7563, cpfk_supplier_lineitem#7531 AS cpfk_supplier_lineitem_1#7564, cfpk_lineitem_supplier#7532 AS cfpk_lineitem_supplier_1#7565, cfpk_lineitem_partsupp#7533 AS cfpk_lineitem_partsupp_1#7566, cpfk_part_lineitem#7534 AS cpfk_part_lineitem_1#7567, cfpk_lineitem_part#7535 AS cfpk_lineitem_part_1#7568, cpfk_partsupp_lineitem#7536 AS cpfk_partsupp_lineitem_1#7569, cfpk_lineitem_orders#7537 AS cfpk_lineitem_orders_1#7570, cval_lineitem_l_quantity#7538 AS cval_lineitem_l_quantity_1#7571, cval_lineitem_l_extendedprice#7539 AS cval_lineitem_l_extendedprice_1#7572, cval_lineitem_l_discount#7540 AS cval_lineitem_l_discount_1#7573, cval_lineitem_l_tax#7541 AS cval_lineitem_l_tax_1#7574, cval_lineitem_l_returnflag#7542 AS cval_lineitem_l_returnflag_1#7575, cval_lineitem_l_linestatus#7543 AS cval_lineitem_l_linestatus_1#7576, cval_lineitem_l_commitdate#7544 AS cval_lineitem_l_commitdate_1#7577, cval_lineitem_l_receiptdate#7545 AS cval_lineitem_l_receiptdate_1#7578, cval_lineitem_l_shipinstruct#7546 AS cval_lineitem_l_shipinstruct_1#7579, cval_lineitem_l_shipmode#7547 AS cval_lineitem_l_shipmode_1#7580, cval_lineitem_l_comment#7548 AS cval_lineitem_l_comment_1#7581, cval_lineitem_l_shipdate#7549 AS cval_lineitem_l_shipdate_1#7582, cl_quantity#7550 AS cl_quantity_1#7583, cl_extendedprice#7551 AS cl_extendedprice_1#7584, cl_discount#7552 AS cl_discount_1#7585, ... 9 more fields]
         :        +- Relation[rid#7529,cpfk_orders_lineitem#7530,cpfk_supplier_lineitem#7531,cfpk_lineitem_supplier#7532,cfpk_lineitem_partsupp#7533,cpfk_part_lineitem#7534,cfpk_lineitem_part#7535,cpfk_partsupp_lineitem#7536,cfpk_lineitem_orders#7537,cval_lineitem_l_quantity#7538,cval_lineitem_l_extendedprice#7539,cval_lineitem_l_discount#7540,cval_lineitem_l_tax#7541,cval_lineitem_l_returnflag#7542,cval_lineitem_l_linestatus#7543,cval_lineitem_l_commitdate#7544,cval_lineitem_l_receiptdate#7545,cval_lineitem_l_shipinstruct#7546,cval_lineitem_l_shipmode#7547,cval_lineitem_l_comment#7548,cval_lineitem_l_shipdate#7549,cl_quantity#7550,cl_extendedprice#7551,cl_discount#7552,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#7297 AS rid_1#7330, cpfk_orders_lineitem#7298 AS cpfk_orders_lineitem_1#7331, cpfk_supplier_lineitem#7299 AS cpfk_supplier_lineitem_1#7332, cfpk_lineitem_supplier#7300 AS cfpk_lineitem_supplier_1#7333, cfpk_lineitem_partsupp#7301 AS cfpk_lineitem_partsupp_1#7334, cpfk_part_lineitem#7302 AS cpfk_part_lineitem_1#7335, cfpk_lineitem_part#7303 AS cfpk_lineitem_part_1#7336, cpfk_partsupp_lineitem#7304 AS cpfk_partsupp_lineitem_1#7337, cfpk_lineitem_orders#7305 AS cfpk_lineitem_orders_1#7338, cval_lineitem_l_quantity#7306 AS cval_lineitem_l_quantity_1#7339, cval_lineitem_l_extendedprice#7307 AS cval_lineitem_l_extendedprice_1#7340, cval_lineitem_l_discount#7308 AS cval_lineitem_l_discount_1#7341, cval_lineitem_l_tax#7309 AS cval_lineitem_l_tax_1#7342, cval_lineitem_l_returnflag#7310 AS cval_lineitem_l_returnflag_1#7343, cval_lineitem_l_linestatus#7311 AS cval_lineitem_l_linestatus_1#7344, cval_lineitem_l_commitdate#7312 AS cval_lineitem_l_commitdate_1#7345, cval_lineitem_l_receiptdate#7313 AS cval_lineitem_l_receiptdate_1#7346, cval_lineitem_l_shipinstruct#7314 AS cval_lineitem_l_shipinstruct_1#7347, cval_lineitem_l_shipmode#7315 AS cval_lineitem_l_shipmode_1#7348, cval_lineitem_l_comment#7316 AS cval_lineitem_l_comment_1#7349, cval_lineitem_l_shipdate#7317 AS cval_lineitem_l_shipdate_1#7350, cl_quantity#7318 AS cl_quantity_1#7351, cl_extendedprice#7319 AS cl_extendedprice_1#7352, cl_discount#7320 AS cl_discount_1#7353, ... 9 more fields]
            :  :  +- Relation[rid#7297,cpfk_orders_lineitem#7298,cpfk_supplier_lineitem#7299,cfpk_lineitem_supplier#7300,cfpk_lineitem_partsupp#7301,cpfk_part_lineitem#7302,cfpk_lineitem_part#7303,cpfk_partsupp_lineitem#7304,cfpk_lineitem_orders#7305,cval_lineitem_l_quantity#7306,cval_lineitem_l_extendedprice#7307,cval_lineitem_l_discount#7308,cval_lineitem_l_tax#7309,cval_lineitem_l_returnflag#7310,cval_lineitem_l_linestatus#7311,cval_lineitem_l_commitdate#7312,cval_lineitem_l_receiptdate#7313,cval_lineitem_l_shipinstruct#7314,cval_lineitem_l_shipmode#7315,cval_lineitem_l_comment#7316,cval_lineitem_l_shipdate#7317,cl_quantity#7318,cl_extendedprice#7319,cl_discount#7320,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#7363 AS rid_1#7396, cpfk_orders_lineitem#7364 AS cpfk_orders_lineitem_1#7397, cpfk_supplier_lineitem#7365 AS cpfk_supplier_lineitem_1#7398, cfpk_lineitem_supplier#7366 AS cfpk_lineitem_supplier_1#7399, cfpk_lineitem_partsupp#7367 AS cfpk_lineitem_partsupp_1#7400, cpfk_part_lineitem#7368 AS cpfk_part_lineitem_1#7401, cfpk_lineitem_part#7369 AS cfpk_lineitem_part_1#7402, cpfk_partsupp_lineitem#7370 AS cpfk_partsupp_lineitem_1#7403, cfpk_lineitem_orders#7371 AS cfpk_lineitem_orders_1#7404, cval_lineitem_l_quantity#7372 AS cval_lineitem_l_quantity_1#7405, cval_lineitem_l_extendedprice#7373 AS cval_lineitem_l_extendedprice_1#7406, cval_lineitem_l_discount#7374 AS cval_lineitem_l_discount_1#7407, cval_lineitem_l_tax#7375 AS cval_lineitem_l_tax_1#7408, cval_lineitem_l_returnflag#7376 AS cval_lineitem_l_returnflag_1#7409, cval_lineitem_l_linestatus#7377 AS cval_lineitem_l_linestatus_1#7410, cval_lineitem_l_commitdate#7378 AS cval_lineitem_l_commitdate_1#7411, cval_lineitem_l_receiptdate#7379 AS cval_lineitem_l_receiptdate_1#7412, cval_lineitem_l_shipinstruct#7380 AS cval_lineitem_l_shipinstruct_1#7413, cval_lineitem_l_shipmode#7381 AS cval_lineitem_l_shipmode_1#7414, cval_lineitem_l_comment#7382 AS cval_lineitem_l_comment_1#7415, cval_lineitem_l_shipdate#7383 AS cval_lineitem_l_shipdate_1#7416, cl_quantity#7384 AS cl_quantity_1#7417, cl_extendedprice#7385 AS cl_extendedprice_1#7418, cl_discount#7386 AS cl_discount_1#7419, ... 9 more fields]
            :        +- Relation[rid#7363,cpfk_orders_lineitem#7364,cpfk_supplier_lineitem#7365,cfpk_lineitem_supplier#7366,cfpk_lineitem_partsupp#7367,cpfk_part_lineitem#7368,cfpk_lineitem_part#7369,cpfk_partsupp_lineitem#7370,cfpk_lineitem_orders#7371,cval_lineitem_l_quantity#7372,cval_lineitem_l_extendedprice#7373,cval_lineitem_l_discount#7374,cval_lineitem_l_tax#7375,cval_lineitem_l_returnflag#7376,cval_lineitem_l_linestatus#7377,cval_lineitem_l_commitdate#7378,cval_lineitem_l_receiptdate#7379,cval_lineitem_l_shipinstruct#7380,cval_lineitem_l_shipmode#7381,cval_lineitem_l_comment#7382,cval_lineitem_l_shipdate#7383,cl_quantity#7384,cl_extendedprice#7385,cl_discount#7386,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#7429 AS rid_1#7462, cpfk_orders_lineitem#7430 AS cpfk_orders_lineitem_1#7463, cpfk_supplier_lineitem#7431 AS cpfk_supplier_lineitem_1#7464, cfpk_lineitem_supplier#7432 AS cfpk_lineitem_supplier_1#7465, cfpk_lineitem_partsupp#7433 AS cfpk_lineitem_partsupp_1#7466, cpfk_part_lineitem#7434 AS cpfk_part_lineitem_1#7467, cfpk_lineitem_part#7435 AS cfpk_lineitem_part_1#7468, cpfk_partsupp_lineitem#7436 AS cpfk_partsupp_lineitem_1#7469, cfpk_lineitem_orders#7437 AS cfpk_lineitem_orders_1#7470, cval_lineitem_l_quantity#7438 AS cval_lineitem_l_quantity_1#7471, cval_lineitem_l_extendedprice#7439 AS cval_lineitem_l_extendedprice_1#7472, cval_lineitem_l_discount#7440 AS cval_lineitem_l_discount_1#7473, cval_lineitem_l_tax#7441 AS cval_lineitem_l_tax_1#7474, cval_lineitem_l_returnflag#7442 AS cval_lineitem_l_returnflag_1#7475, cval_lineitem_l_linestatus#7443 AS cval_lineitem_l_linestatus_1#7476, cval_lineitem_l_commitdate#7444 AS cval_lineitem_l_commitdate_1#7477, cval_lineitem_l_receiptdate#7445 AS cval_lineitem_l_receiptdate_1#7478, cval_lineitem_l_shipinstruct#7446 AS cval_lineitem_l_shipinstruct_1#7479, cval_lineitem_l_shipmode#7447 AS cval_lineitem_l_shipmode_1#7480, cval_lineitem_l_comment#7448 AS cval_lineitem_l_comment_1#7481, cval_lineitem_l_shipdate#7449 AS cval_lineitem_l_shipdate_1#7482, cl_quantity#7450 AS cl_quantity_1#7483, cl_extendedprice#7451 AS cl_extendedprice_1#7484, cl_discount#7452 AS cl_discount_1#7485, ... 9 more fields]
                  +- Relation[rid#7429,cpfk_orders_lineitem#7430,cpfk_supplier_lineitem#7431,cfpk_lineitem_supplier#7432,cfpk_lineitem_partsupp#7433,cpfk_part_lineitem#7434,cfpk_lineitem_part#7435,cpfk_partsupp_lineitem#7436,cfpk_lineitem_orders#7437,cval_lineitem_l_quantity#7438,cval_lineitem_l_extendedprice#7439,cval_lineitem_l_discount#7440,cval_lineitem_l_tax#7441,cval_lineitem_l_returnflag#7442,cval_lineitem_l_linestatus#7443,cval_lineitem_l_commitdate#7444,cval_lineitem_l_receiptdate#7445,cval_lineitem_l_shipinstruct#7446,cval_lineitem_l_shipmode#7447,cval_lineitem_l_comment#7448,cval_lineitem_l_shipdate#7449,cl_quantity#7450,cl_extendedprice#7451,cl_discount#7452,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 365542ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/11 06:10:34 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:10:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7652L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 06:10:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:10:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:10:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:10:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:10:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:10:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:10:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:10:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:10:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:10:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:10:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:10:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:10:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:10:35 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:10:35 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:10:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7652L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#7654 AS rid_0#7671, cval_part_p_name#7655 AS cval_part_p_name_0#7672, cval_part_p_mfgr#7656 AS cval_part_p_mfgr_0#7673, cval_part_p_type#7657 AS cval_part_p_type_0#7674, cval_part_p_size#7658 AS cval_part_p_size_0#7675, cval_part_p_container#7659 AS cval_part_p_container_0#7676, cval_part_p_retailprice#7660 AS cval_part_p_retailprice_0#7677, cval_part_p_comment#7661 AS cval_part_p_comment_0#7678, cval_part_p_brand#7662 AS cval_part_p_brand_0#7679, cp_name#7663 AS cp_name_0#7680, cp_mfgr#7664 AS cp_mfgr_0#7681, cp_type#7665 AS cp_type_0#7682, cp_size#7666 AS cp_size_0#7683, cp_container#7667 AS cp_container_0#7684, cp_retailprice#7668 AS cp_retailprice_0#7685, cp_comment#7669 AS cp_comment_0#7686, cp_brand#7670 AS cp_brand_0#7687]
            :     :     :  :  :  :  +- Relation[rid#7654,cval_part_p_name#7655,cval_part_p_mfgr#7656,cval_part_p_type#7657,cval_part_p_size#7658,cval_part_p_container#7659,cval_part_p_retailprice#7660,cval_part_p_comment#7661,cval_part_p_brand#7662,cp_name#7663,cp_mfgr#7664,cp_type#7665,cp_size#7666,cp_container#7667,cp_retailprice#7668,cp_comment#7669,cp_brand#7670] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#7688 AS rid_0#7705, cval_part_p_name#7689 AS cval_part_p_name_0#7706, cval_part_p_mfgr#7690 AS cval_part_p_mfgr_0#7707, cval_part_p_type#7691 AS cval_part_p_type_0#7708, cval_part_p_size#7692 AS cval_part_p_size_0#7709, cval_part_p_container#7693 AS cval_part_p_container_0#7710, cval_part_p_retailprice#7694 AS cval_part_p_retailprice_0#7711, cval_part_p_comment#7695 AS cval_part_p_comment_0#7712, cval_part_p_brand#7696 AS cval_part_p_brand_0#7713, cp_name#7697 AS cp_name_0#7714, cp_mfgr#7698 AS cp_mfgr_0#7715, cp_type#7699 AS cp_type_0#7716, cp_size#7700 AS cp_size_0#7717, cp_container#7701 AS cp_container_0#7718, cp_retailprice#7702 AS cp_retailprice_0#7719, cp_comment#7703 AS cp_comment_0#7720, cp_brand#7704 AS cp_brand_0#7721]
            :     :     :  :  :        +- Relation[rid#7688,cval_part_p_name#7689,cval_part_p_mfgr#7690,cval_part_p_type#7691,cval_part_p_size#7692,cval_part_p_container#7693,cval_part_p_retailprice#7694,cval_part_p_comment#7695,cval_part_p_brand#7696,cp_name#7697,cp_mfgr#7698,cp_type#7699,cp_size#7700,cp_container#7701,cp_retailprice#7702,cp_comment#7703,cp_brand#7704] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :     :- Project [rid#7788 AS rid_0#7805, cval_part_p_name#7789 AS cval_part_p_name_0#7806, cval_part_p_mfgr#7790 AS cval_part_p_mfgr_0#7807, cval_part_p_type#7791 AS cval_part_p_type_0#7808, cval_part_p_size#7792 AS cval_part_p_size_0#7809, cval_part_p_container#7793 AS cval_part_p_container_0#7810, cval_part_p_retailprice#7794 AS cval_part_p_retailprice_0#7811, cval_part_p_comment#7795 AS cval_part_p_comment_0#7812, cval_part_p_brand#7796 AS cval_part_p_brand_0#7813, cp_name#7797 AS cp_name_0#7814, cp_mfgr#7798 AS cp_mfgr_0#7815, cp_type#7799 AS cp_type_0#7816, cp_size#7800 AS cp_size_0#7817, cp_container#7801 AS cp_container_0#7818, cp_retailprice#7802 AS cp_retailprice_0#7819, cp_comment#7803 AS cp_comment_0#7820, cp_brand#7804 AS cp_brand_0#7821]
            :     :     :  :     :  +- Relation[rid#7788,cval_part_p_name#7789,cval_part_p_mfgr#7790,cval_part_p_type#7791,cval_part_p_size#7792,cval_part_p_container#7793,cval_part_p_retailprice#7794,cval_part_p_comment#7795,cval_part_p_brand#7796,cp_name#7797,cp_mfgr#7798,cp_type#7799,cp_size#7800,cp_container#7801,cp_retailprice#7802,cp_comment#7803,cp_brand#7804] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :     +- Project [rid#7822 AS rid_1#7855, cpfk_orders_lineitem#7823 AS cpfk_orders_lineitem_1#7856, cpfk_supplier_lineitem#7824 AS cpfk_supplier_lineitem_1#7857, cfpk_lineitem_supplier#7825 AS cfpk_lineitem_supplier_1#7858, cfpk_lineitem_partsupp#7826 AS cfpk_lineitem_partsupp_1#7859, cpfk_part_lineitem#7827 AS cpfk_part_lineitem_1#7860, cfpk_lineitem_part#7828 AS cfpk_lineitem_part_1#7861, cpfk_partsupp_lineitem#7829 AS cpfk_partsupp_lineitem_1#7862, cfpk_lineitem_orders#7830 AS cfpk_lineitem_orders_1#7863, cval_lineitem_l_quantity#7831 AS cval_lineitem_l_quantity_1#7864, cval_lineitem_l_extendedprice#7832 AS cval_lineitem_l_extendedprice_1#7865, cval_lineitem_l_discount#7833 AS cval_lineitem_l_discount_1#7866, cval_lineitem_l_tax#7834 AS cval_lineitem_l_tax_1#7867, cval_lineitem_l_returnflag#7835 AS cval_lineitem_l_returnflag_1#7868, cval_lineitem_l_linestatus#7836 AS cval_lineitem_l_linestatus_1#7869, cval_lineitem_l_commitdate#7837 AS cval_lineitem_l_commitdate_1#7870, cval_lineitem_l_receiptdate#7838 AS cval_lineitem_l_receiptdate_1#7871, cval_lineitem_l_shipinstruct#7839 AS cval_lineitem_l_shipinstruct_1#7872, cval_lineitem_l_shipmode#7840 AS cval_lineitem_l_shipmode_1#7873, cval_lineitem_l_comment#7841 AS cval_lineitem_l_comment_1#7874, cval_lineitem_l_shipdate#7842 AS cval_lineitem_l_shipdate_1#7875, cl_quantity#7843 AS cl_quantity_1#7876, cl_extendedprice#7844 AS cl_extendedprice_1#7877, cl_discount#7845 AS cl_discount_1#7878, ... 9 more fields]
            :     :     :  :        +- Relation[rid#7822,cpfk_orders_lineitem#7823,cpfk_supplier_lineitem#7824,cfpk_lineitem_supplier#7825,cfpk_lineitem_partsupp#7826,cpfk_part_lineitem#7827,cfpk_lineitem_part#7828,cpfk_partsupp_lineitem#7829,cfpk_lineitem_orders#7830,cval_lineitem_l_quantity#7831,cval_lineitem_l_extendedprice#7832,cval_lineitem_l_discount#7833,cval_lineitem_l_tax#7834,cval_lineitem_l_returnflag#7835,cval_lineitem_l_linestatus#7836,cval_lineitem_l_commitdate#7837,cval_lineitem_l_receiptdate#7838,cval_lineitem_l_shipinstruct#7839,cval_lineitem_l_shipmode#7840,cval_lineitem_l_comment#7841,cval_lineitem_l_shipdate#7842,cl_quantity#7843,cl_extendedprice#7844,cl_discount#7845,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#7722 AS rid_1#7755, cpfk_orders_lineitem#7723 AS cpfk_orders_lineitem_1#7756, cpfk_supplier_lineitem#7724 AS cpfk_supplier_lineitem_1#7757, cfpk_lineitem_supplier#7725 AS cfpk_lineitem_supplier_1#7758, cfpk_lineitem_partsupp#7726 AS cfpk_lineitem_partsupp_1#7759, cpfk_part_lineitem#7727 AS cpfk_part_lineitem_1#7760, cfpk_lineitem_part#7728 AS cfpk_lineitem_part_1#7761, cpfk_partsupp_lineitem#7729 AS cpfk_partsupp_lineitem_1#7762, cfpk_lineitem_orders#7730 AS cfpk_lineitem_orders_1#7763, cval_lineitem_l_quantity#7731 AS cval_lineitem_l_quantity_1#7764, cval_lineitem_l_extendedprice#7732 AS cval_lineitem_l_extendedprice_1#7765, cval_lineitem_l_discount#7733 AS cval_lineitem_l_discount_1#7766, cval_lineitem_l_tax#7734 AS cval_lineitem_l_tax_1#7767, cval_lineitem_l_returnflag#7735 AS cval_lineitem_l_returnflag_1#7768, cval_lineitem_l_linestatus#7736 AS cval_lineitem_l_linestatus_1#7769, cval_lineitem_l_commitdate#7737 AS cval_lineitem_l_commitdate_1#7770, cval_lineitem_l_receiptdate#7738 AS cval_lineitem_l_receiptdate_1#7771, cval_lineitem_l_shipinstruct#7739 AS cval_lineitem_l_shipinstruct_1#7772, cval_lineitem_l_shipmode#7740 AS cval_lineitem_l_shipmode_1#7773, cval_lineitem_l_comment#7741 AS cval_lineitem_l_comment_1#7774, cval_lineitem_l_shipdate#7742 AS cval_lineitem_l_shipdate_1#7775, cl_quantity#7743 AS cl_quantity_1#7776, cl_extendedprice#7744 AS cl_extendedprice_1#7777, cl_discount#7745 AS cl_discount_1#7778, ... 9 more fields]
            :     :     :     +- Relation[rid#7722,cpfk_orders_lineitem#7723,cpfk_supplier_lineitem#7724,cfpk_lineitem_supplier#7725,cfpk_lineitem_partsupp#7726,cpfk_part_lineitem#7727,cfpk_lineitem_part#7728,cpfk_partsupp_lineitem#7729,cfpk_lineitem_orders#7730,cval_lineitem_l_quantity#7731,cval_lineitem_l_extendedprice#7732,cval_lineitem_l_discount#7733,cval_lineitem_l_tax#7734,cval_lineitem_l_returnflag#7735,cval_lineitem_l_linestatus#7736,cval_lineitem_l_commitdate#7737,cval_lineitem_l_receiptdate#7738,cval_lineitem_l_shipinstruct#7739,cval_lineitem_l_shipmode#7740,cval_lineitem_l_comment#7741,cval_lineitem_l_shipdate#7742,cl_quantity#7743,cl_extendedprice#7744,cl_discount#7745,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#7888 AS rid_2#7901, cpfk_nation_supplier#7889 AS cpfk_nation_supplier_2#7902, cfpk_supplier_nation#7890 AS cfpk_supplier_nation_2#7903, cval_supplier_s_name#7891 AS cval_supplier_s_name_2#7904, cval_supplier_s_address#7892 AS cval_supplier_s_address_2#7905, cval_supplier_s_phone#7893 AS cval_supplier_s_phone_2#7906, cval_supplier_s_acctbal#7894 AS cval_supplier_s_acctbal_2#7907, cval_supplier_s_comment#7895 AS cval_supplier_s_comment_2#7908, cs_name#7896 AS cs_name_2#7909, cs_address#7897 AS cs_address_2#7910, cs_phone#7898 AS cs_phone_2#7911, cs_acctbal#7899 AS cs_acctbal_2#7912, cs_comment#7900 AS cs_comment_2#7913]
            :     :        +- Relation[rid#7888,cpfk_nation_supplier#7889,cfpk_supplier_nation#7890,cval_supplier_s_name#7891,cval_supplier_s_address#7892,cval_supplier_s_phone#7893,cval_supplier_s_acctbal#7894,cval_supplier_s_comment#7895,cs_name#7896,cs_address#7897,cs_phone#7898,cs_acctbal#7899,cs_comment#7900] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#7914 AS rid_3#7921, cpfk_region_nation#7915 AS cpfk_region_nation_3#7922, cfpk_nation_region#7916 AS cfpk_nation_region_3#7923, cval_nation_n_name#7917 AS cval_nation_n_name_3#7924, cval_nation_n_comment#7918 AS cval_nation_n_comment_3#7925, cn_name#7919 AS cn_name_3#7926, cn_comment#7920 AS cn_comment_3#7927]
            :        +- Relation[rid#7914,cpfk_region_nation#7915,cfpk_nation_region#7916,cval_nation_n_name#7917,cval_nation_n_comment#7918,cn_name#7919,cn_comment#7920] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'Join UsingJoin(Inner,List(rid_6))
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#7928 AS rid_4#7933, cval_region_r_name#7929 AS cval_region_r_name_4#7934, cval_region_r_comment#7930 AS cval_region_r_comment_4#7935, cr_name#7931 AS cr_name_4#7936, cr_comment#7932 AS cr_comment_4#7937]
               :  :  :  :  :  :  :  +- Relation[rid#7928,cval_region_r_name#7929,cval_region_r_comment#7930,cr_name#7931,cr_comment#7932] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#7938 AS rid_4#7943, cval_region_r_name#7939 AS cval_region_r_name_4#7944, cval_region_r_comment#7940 AS cval_region_r_comment_4#7945, cr_name#7941 AS cr_name_4#7946, cr_comment#7942 AS cr_comment_4#7947]
               :  :  :  :  :  :        +- Relation[rid#7938,cval_region_r_name#7939,cval_region_r_comment#7940,cr_name#7941,cr_comment#7942] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :     :- Project [rid#7962 AS rid_4#7967, cval_region_r_name#7963 AS cval_region_r_name_4#7968, cval_region_r_comment#7964 AS cval_region_r_comment_4#7969, cr_name#7965 AS cr_name_4#7970, cr_comment#7966 AS cr_comment_4#7971]
               :  :  :  :  :     :  +- Relation[rid#7962,cval_region_r_name#7963,cval_region_r_comment#7964,cr_name#7965,cr_comment#7966] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :     +- Project [rid#7972 AS rid_5#7979, cpfk_region_nation#7973 AS cpfk_region_nation_5#7980, cfpk_nation_region#7974 AS cfpk_nation_region_5#7981, cval_nation_n_name#7975 AS cval_nation_n_name_5#7982, cval_nation_n_comment#7976 AS cval_nation_n_comment_5#7983, cn_name#7977 AS cn_name_5#7984, cn_comment#7978 AS cn_comment_5#7985]
               :  :  :  :  :        +- Relation[rid#7972,cpfk_region_nation#7973,cfpk_nation_region#7974,cval_nation_n_name#7975,cval_nation_n_comment#7976,cn_name#7977,cn_comment#7978] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#7948 AS rid_5#7955, cpfk_region_nation#7949 AS cpfk_region_nation_5#7956, cfpk_nation_region#7950 AS cfpk_nation_region_5#7957, cval_nation_n_name#7951 AS cval_nation_n_name_5#7958, cval_nation_n_comment#7952 AS cval_nation_n_comment_5#7959, cn_name#7953 AS cn_name_5#7960, cn_comment#7954 AS cn_comment_5#7961]
               :  :  :  :     +- Relation[rid#7948,cpfk_region_nation#7949,cfpk_nation_region#7950,cval_nation_n_name#7951,cval_nation_n_comment#7952,cn_name#7953,cn_comment#7954] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :     :- Project [rid#8016 AS rid_5#8023, cpfk_region_nation#8017 AS cpfk_region_nation_5#8024, cfpk_nation_region#8018 AS cfpk_nation_region_5#8025, cval_nation_n_name#8019 AS cval_nation_n_name_5#8026, cval_nation_n_comment#8020 AS cval_nation_n_comment_5#8027, cn_name#8021 AS cn_name_5#8028, cn_comment#8022 AS cn_comment_5#8029]
               :  :  :     :  +- Relation[rid#8016,cpfk_region_nation#8017,cfpk_nation_region#8018,cval_nation_n_name#8019,cval_nation_n_comment#8020,cn_name#8021,cn_comment#8022] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#8030 AS rid_6#8045, cpfk_nation_customer#8031 AS cpfk_nation_customer_6#8046, cfpk_customer_nation#8032 AS cfpk_customer_nation_6#8047, cval_customer_c_name#8033 AS cval_customer_c_name_6#8048, cval_customer_c_address#8034 AS cval_customer_c_address_6#8049, cval_customer_c_phone#8035 AS cval_customer_c_phone_6#8050, cval_customer_c_acctbal#8036 AS cval_customer_c_acctbal_6#8051, cval_customer_c_comment#8037 AS cval_customer_c_comment_6#8052, cval_customer_c_mktsegment#8038 AS cval_customer_c_mktsegment_6#8053, cc_name#8039 AS cc_name_6#8054, cc_address#8040 AS cc_address_6#8055, cc_phone#8041 AS cc_phone_6#8056, cc_acctbal#8042 AS cc_acctbal_6#8057, cc_comment#8043 AS cc_comment_6#8058, cc_mktsegment#8044 AS cc_mktsegment_6#8059]
               :  :  :        +- Relation[rid#8030,cpfk_nation_customer#8031,cfpk_customer_nation#8032,cval_customer_c_name#8033,cval_customer_c_address#8034,cval_customer_c_phone#8035,cval_customer_c_acctbal#8036,cval_customer_c_comment#8037,cval_customer_c_mktsegment#8038,cc_name#8039,cc_address#8040,cc_phone#8041,cc_acctbal#8042,cc_comment#8043,cc_mktsegment#8044] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#7986 AS rid_6#8001, cpfk_nation_customer#7987 AS cpfk_nation_customer_6#8002, cfpk_customer_nation#7988 AS cfpk_customer_nation_6#8003, cval_customer_c_name#7989 AS cval_customer_c_name_6#8004, cval_customer_c_address#7990 AS cval_customer_c_address_6#8005, cval_customer_c_phone#7991 AS cval_customer_c_phone_6#8006, cval_customer_c_acctbal#7992 AS cval_customer_c_acctbal_6#8007, cval_customer_c_comment#7993 AS cval_customer_c_comment_6#8008, cval_customer_c_mktsegment#7994 AS cval_customer_c_mktsegment_6#8009, cc_name#7995 AS cc_name_6#8010, cc_address#7996 AS cc_address_6#8011, cc_phone#7997 AS cc_phone_6#8012, cc_acctbal#7998 AS cc_acctbal_6#8013, cc_comment#7999 AS cc_comment_6#8014, cc_mktsegment#8000 AS cc_mktsegment_6#8015]
               :  :     +- Relation[rid#7986,cpfk_nation_customer#7987,cfpk_customer_nation#7988,cval_customer_c_name#7989,cval_customer_c_address#7990,cval_customer_c_phone#7991,cval_customer_c_acctbal#7992,cval_customer_c_comment#7993,cval_customer_c_mktsegment#7994,cc_name#7995,cc_address#7996,cc_phone#7997,cc_acctbal#7998,cc_comment#7999,cc_mktsegment#8000] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :     :- Project [rid#8094 AS rid_6#8109, cpfk_nation_customer#8095 AS cpfk_nation_customer_6#8110, cfpk_customer_nation#8096 AS cfpk_customer_nation_6#8111, cval_customer_c_name#8097 AS cval_customer_c_name_6#8112, cval_customer_c_address#8098 AS cval_customer_c_address_6#8113, cval_customer_c_phone#8099 AS cval_customer_c_phone_6#8114, cval_customer_c_acctbal#8100 AS cval_customer_c_acctbal_6#8115, cval_customer_c_comment#8101 AS cval_customer_c_comment_6#8116, cval_customer_c_mktsegment#8102 AS cval_customer_c_mktsegment_6#8117, cc_name#8103 AS cc_name_6#8118, cc_address#8104 AS cc_address_6#8119, cc_phone#8105 AS cc_phone_6#8120, cc_acctbal#8106 AS cc_acctbal_6#8121, cc_comment#8107 AS cc_comment_6#8122, cc_mktsegment#8108 AS cc_mktsegment_6#8123]
               :     :  +- Relation[rid#8094,cpfk_nation_customer#8095,cfpk_customer_nation#8096,cval_customer_c_name#8097,cval_customer_c_address#8098,cval_customer_c_phone#8099,cval_customer_c_acctbal#8100,cval_customer_c_comment#8101,cval_customer_c_mktsegment#8102,cc_name#8103,cc_address#8104,cc_phone#8105,cc_acctbal#8106,cc_comment#8107,cc_mktsegment#8108] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#8124 AS rid_7#8141, cpfk_customer_orders#8125 AS cpfk_customer_orders_7#8142, cfpk_orders_customer#8126 AS cfpk_orders_customer_7#8143, cval_orders_o_orderstatus#8127 AS cval_orders_o_orderstatus_7#8144, cval_orders_o_totalprice#8128 AS cval_orders_o_totalprice_7#8145, cval_orders_o_orderpriority#8129 AS cval_orders_o_orderpriority_7#8146, cval_orders_o_clerk#8130 AS cval_orders_o_clerk_7#8147, cval_orders_o_shippriority#8131 AS cval_orders_o_shippriority_7#8148, cval_orders_o_comment#8132 AS cval_orders_o_comment_7#8149, cval_orders_o_orderdate#8133 AS cval_orders_o_orderdate_7#8150, co_orderstatus#8134 AS co_orderstatus_7#8151, co_totalprice#8135 AS co_totalprice_7#8152, co_orderpriority#8136 AS co_orderpriority_7#8153, co_clerk#8137 AS co_clerk_7#8154, co_shippriority#8138 AS co_shippriority_7#8155, co_comment#8139 AS co_comment_7#8156, co_orderdate#8140 AS co_orderdate_7#8157]
               :        +- Relation[rid#8124,cpfk_customer_orders#8125,cfpk_orders_customer#8126,cval_orders_o_orderstatus#8127,cval_orders_o_totalprice#8128,cval_orders_o_orderpriority#8129,cval_orders_o_clerk#8130,cval_orders_o_shippriority#8131,cval_orders_o_comment#8132,cval_orders_o_orderdate#8133,co_orderstatus#8134,co_totalprice#8135,co_orderpriority#8136,co_clerk#8137,co_shippriority#8138,co_comment#8139,co_orderdate#8140] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#8060 AS rid_7#8077, cpfk_customer_orders#8061 AS cpfk_customer_orders_7#8078, cfpk_orders_customer#8062 AS cfpk_orders_customer_7#8079, cval_orders_o_orderstatus#8063 AS cval_orders_o_orderstatus_7#8080, cval_orders_o_totalprice#8064 AS cval_orders_o_totalprice_7#8081, cval_orders_o_orderpriority#8065 AS cval_orders_o_orderpriority_7#8082, cval_orders_o_clerk#8066 AS cval_orders_o_clerk_7#8083, cval_orders_o_shippriority#8067 AS cval_orders_o_shippriority_7#8084, cval_orders_o_comment#8068 AS cval_orders_o_comment_7#8085, cval_orders_o_orderdate#8069 AS cval_orders_o_orderdate_7#8086, co_orderstatus#8070 AS co_orderstatus_7#8087, co_totalprice#8071 AS co_totalprice_7#8088, co_orderpriority#8072 AS co_orderpriority_7#8089, co_clerk#8073 AS co_clerk_7#8090, co_shippriority#8074 AS co_shippriority_7#8091, co_comment#8075 AS co_comment_7#8092, co_orderdate#8076 AS co_orderdate_7#8093]
                  +- Relation[rid#8060,cpfk_customer_orders#8061,cfpk_orders_customer#8062,cval_orders_o_orderstatus#8063,cval_orders_o_totalprice#8064,cval_orders_o_orderpriority#8065,cval_orders_o_clerk#8066,cval_orders_o_shippriority#8067,cval_orders_o_comment#8068,cval_orders_o_orderdate#8069,co_orderstatus#8070,co_totalprice#8071,co_orderpriority#8072,co_clerk#8073,co_shippriority#8074,co_comment#8075,co_orderdate#8076] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 96570ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/11 06:12:11 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:12:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8276L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:12:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:12:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8276L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#8278 AS rid_0#8283, cval_region_r_name#8279 AS cval_region_r_name_0#8284, cval_region_r_comment#8280 AS cval_region_r_comment_0#8285, cr_name#8281 AS cr_name_0#8286, cr_comment#8282 AS cr_comment_0#8287]
         :  :  :  :  :  :  :  +- Relation[rid#8278,cval_region_r_name#8279,cval_region_r_comment#8280,cr_name#8281,cr_comment#8282] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#8288 AS rid_0#8293, cval_region_r_name#8289 AS cval_region_r_name_0#8294, cval_region_r_comment#8290 AS cval_region_r_comment_0#8295, cr_name#8291 AS cr_name_0#8296, cr_comment#8292 AS cr_comment_0#8297]
         :  :  :  :  :  :        +- Relation[rid#8288,cval_region_r_name#8289,cval_region_r_comment#8290,cr_name#8291,cr_comment#8292] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :     :- Project [rid#8312 AS rid_0#8317, cval_region_r_name#8313 AS cval_region_r_name_0#8318, cval_region_r_comment#8314 AS cval_region_r_comment_0#8319, cr_name#8315 AS cr_name_0#8320, cr_comment#8316 AS cr_comment_0#8321]
         :  :  :  :  :     :  +- Relation[rid#8312,cval_region_r_name#8313,cval_region_r_comment#8314,cr_name#8315,cr_comment#8316] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :     +- Project [rid#8322 AS rid_1#8329, cpfk_region_nation#8323 AS cpfk_region_nation_1#8330, cfpk_nation_region#8324 AS cfpk_nation_region_1#8331, cval_nation_n_name#8325 AS cval_nation_n_name_1#8332, cval_nation_n_comment#8326 AS cval_nation_n_comment_1#8333, cn_name#8327 AS cn_name_1#8334, cn_comment#8328 AS cn_comment_1#8335]
         :  :  :  :  :        +- Relation[rid#8322,cpfk_region_nation#8323,cfpk_nation_region#8324,cval_nation_n_name#8325,cval_nation_n_comment#8326,cn_name#8327,cn_comment#8328] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#8298 AS rid_1#8305, cpfk_region_nation#8299 AS cpfk_region_nation_1#8306, cfpk_nation_region#8300 AS cfpk_nation_region_1#8307, cval_nation_n_name#8301 AS cval_nation_n_name_1#8308, cval_nation_n_comment#8302 AS cval_nation_n_comment_1#8309, cn_name#8303 AS cn_name_1#8310, cn_comment#8304 AS cn_comment_1#8311]
         :  :  :  :     +- Relation[rid#8298,cpfk_region_nation#8299,cfpk_nation_region#8300,cval_nation_n_name#8301,cval_nation_n_comment#8302,cn_name#8303,cn_comment#8304] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :     :- Project [rid#8362 AS rid_1#8369, cpfk_region_nation#8363 AS cpfk_region_nation_1#8370, cfpk_nation_region#8364 AS cfpk_nation_region_1#8371, cval_nation_n_name#8365 AS cval_nation_n_name_1#8372, cval_nation_n_comment#8366 AS cval_nation_n_comment_1#8373, cn_name#8367 AS cn_name_1#8374, cn_comment#8368 AS cn_comment_1#8375]
         :  :  :     :  +- Relation[rid#8362,cpfk_region_nation#8363,cfpk_nation_region#8364,cval_nation_n_name#8365,cval_nation_n_comment#8366,cn_name#8367,cn_comment#8368] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#8376 AS rid_2#8389, cpfk_nation_supplier#8377 AS cpfk_nation_supplier_2#8390, cfpk_supplier_nation#8378 AS cfpk_supplier_nation_2#8391, cval_supplier_s_name#8379 AS cval_supplier_s_name_2#8392, cval_supplier_s_address#8380 AS cval_supplier_s_address_2#8393, cval_supplier_s_phone#8381 AS cval_supplier_s_phone_2#8394, cval_supplier_s_acctbal#8382 AS cval_supplier_s_acctbal_2#8395, cval_supplier_s_comment#8383 AS cval_supplier_s_comment_2#8396, cs_name#8384 AS cs_name_2#8397, cs_address#8385 AS cs_address_2#8398, cs_phone#8386 AS cs_phone_2#8399, cs_acctbal#8387 AS cs_acctbal_2#8400, cs_comment#8388 AS cs_comment_2#8401]
         :  :  :        +- Relation[rid#8376,cpfk_nation_supplier#8377,cfpk_supplier_nation#8378,cval_supplier_s_name#8379,cval_supplier_s_address#8380,cval_supplier_s_phone#8381,cval_supplier_s_acctbal#8382,cval_supplier_s_comment#8383,cs_name#8384,cs_address#8385,cs_phone#8386,cs_acctbal#8387,cs_comment#8388] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#8336 AS rid_2#8349, cpfk_nation_supplier#8337 AS cpfk_nation_supplier_2#8350, cfpk_supplier_nation#8338 AS cfpk_supplier_nation_2#8351, cval_supplier_s_name#8339 AS cval_supplier_s_name_2#8352, cval_supplier_s_address#8340 AS cval_supplier_s_address_2#8353, cval_supplier_s_phone#8341 AS cval_supplier_s_phone_2#8354, cval_supplier_s_acctbal#8342 AS cval_supplier_s_acctbal_2#8355, cval_supplier_s_comment#8343 AS cval_supplier_s_comment_2#8356, cs_name#8344 AS cs_name_2#8357, cs_address#8345 AS cs_address_2#8358, cs_phone#8346 AS cs_phone_2#8359, cs_acctbal#8347 AS cs_acctbal_2#8360, cs_comment#8348 AS cs_comment_2#8361]
         :  :     +- Relation[rid#8336,cpfk_nation_supplier#8337,cfpk_supplier_nation#8338,cval_supplier_s_name#8339,cval_supplier_s_address#8340,cval_supplier_s_phone#8341,cval_supplier_s_acctbal#8342,cval_supplier_s_comment#8343,cs_name#8344,cs_address#8345,cs_phone#8346,cs_acctbal#8347,cs_comment#8348] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :     :- Project [rid#8548 AS rid_2#8561, cpfk_nation_supplier#8549 AS cpfk_nation_supplier_2#8562, cfpk_supplier_nation#8550 AS cfpk_supplier_nation_2#8563, cval_supplier_s_name#8551 AS cval_supplier_s_name_2#8564, cval_supplier_s_address#8552 AS cval_supplier_s_address_2#8565, cval_supplier_s_phone#8553 AS cval_supplier_s_phone_2#8566, cval_supplier_s_acctbal#8554 AS cval_supplier_s_acctbal_2#8567, cval_supplier_s_comment#8555 AS cval_supplier_s_comment_2#8568, cs_name#8556 AS cs_name_2#8569, cs_address#8557 AS cs_address_2#8570, cs_phone#8558 AS cs_phone_2#8571, cs_acctbal#8559 AS cs_acctbal_2#8572, cs_comment#8560 AS cs_comment_2#8573]
         :     :  +- Relation[rid#8548,cpfk_nation_supplier#8549,cfpk_supplier_nation#8550,cval_supplier_s_name#8551,cval_supplier_s_address#8552,cval_supplier_s_phone#8553,cval_supplier_s_acctbal#8554,cval_supplier_s_comment#8555,cs_name#8556,cs_address#8557,cs_phone#8558,cs_acctbal#8559,cs_comment#8560] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#8574 AS rid_4#8585, cpfk_part_partsupp#8575 AS cpfk_part_partsupp_4#8586, cfpk_partsupp_part#8576 AS cfpk_partsupp_part_4#8587, cpfk_supplier_partsupp#8577 AS cpfk_supplier_partsupp_4#8588, cfpk_partsupp_supplier#8578 AS cfpk_partsupp_supplier_4#8589, cval_partsupp_ps_availqty#8579 AS cval_partsupp_ps_availqty_4#8590, cval_partsupp_ps_supplycost#8580 AS cval_partsupp_ps_supplycost_4#8591, cval_partsupp_ps_comment#8581 AS cval_partsupp_ps_comment_4#8592, cps_availqty#8582 AS cps_availqty_4#8593, cps_supplycost#8583 AS cps_supplycost_4#8594, cps_comment#8584 AS cps_comment_4#8595]
         :        +- Relation[rid#8574,cpfk_part_partsupp#8575,cfpk_partsupp_part#8576,cpfk_supplier_partsupp#8577,cfpk_partsupp_supplier#8578,cval_partsupp_ps_availqty#8579,cval_partsupp_ps_supplycost#8580,cval_partsupp_ps_comment#8581,cps_availqty#8582,cps_supplycost#8583,cps_comment#8584] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'Join UsingJoin(Inner,List(rid_3))
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#8402 AS rid_3#8419, cval_part_p_name#8403 AS cval_part_p_name_3#8420, cval_part_p_mfgr#8404 AS cval_part_p_mfgr_3#8421, cval_part_p_type#8405 AS cval_part_p_type_3#8422, cval_part_p_size#8406 AS cval_part_p_size_3#8423, cval_part_p_container#8407 AS cval_part_p_container_3#8424, cval_part_p_retailprice#8408 AS cval_part_p_retailprice_3#8425, cval_part_p_comment#8409 AS cval_part_p_comment_3#8426, cval_part_p_brand#8410 AS cval_part_p_brand_3#8427, cp_name#8411 AS cp_name_3#8428, cp_mfgr#8412 AS cp_mfgr_3#8429, cp_type#8413 AS cp_type_3#8430, cp_size#8414 AS cp_size_3#8431, cp_container#8415 AS cp_container_3#8432, cp_retailprice#8416 AS cp_retailprice_3#8433, cp_comment#8417 AS cp_comment_3#8434, cp_brand#8418 AS cp_brand_3#8435]
            :  :  :  +- Relation[rid#8402,cval_part_p_name#8403,cval_part_p_mfgr#8404,cval_part_p_type#8405,cval_part_p_size#8406,cval_part_p_container#8407,cval_part_p_retailprice#8408,cval_part_p_comment#8409,cval_part_p_brand#8410,cp_name#8411,cp_mfgr#8412,cp_type#8413,cp_size#8414,cp_container#8415,cp_retailprice#8416,cp_comment#8417,cp_brand#8418] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#8436 AS rid_3#8453, cval_part_p_name#8437 AS cval_part_p_name_3#8454, cval_part_p_mfgr#8438 AS cval_part_p_mfgr_3#8455, cval_part_p_type#8439 AS cval_part_p_type_3#8456, cval_part_p_size#8440 AS cval_part_p_size_3#8457, cval_part_p_container#8441 AS cval_part_p_container_3#8458, cval_part_p_retailprice#8442 AS cval_part_p_retailprice_3#8459, cval_part_p_comment#8443 AS cval_part_p_comment_3#8460, cval_part_p_brand#8444 AS cval_part_p_brand_3#8461, cp_name#8445 AS cp_name_3#8462, cp_mfgr#8446 AS cp_mfgr_3#8463, cp_type#8447 AS cp_type_3#8464, cp_size#8448 AS cp_size_3#8465, cp_container#8449 AS cp_container_3#8466, cp_retailprice#8450 AS cp_retailprice_3#8467, cp_comment#8451 AS cp_comment_3#8468, cp_brand#8452 AS cp_brand_3#8469]
            :  :        +- Relation[rid#8436,cval_part_p_name#8437,cval_part_p_mfgr#8438,cval_part_p_type#8439,cval_part_p_size#8440,cval_part_p_container#8441,cval_part_p_retailprice#8442,cval_part_p_comment#8443,cval_part_p_brand#8444,cp_name#8445,cp_mfgr#8446,cp_type#8447,cp_size#8448,cp_container#8449,cp_retailprice#8450,cp_comment#8451,cp_brand#8452] JDBCRelation(tpart) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :     :- Project [rid#8492 AS rid_3#8509, cval_part_p_name#8493 AS cval_part_p_name_3#8510, cval_part_p_mfgr#8494 AS cval_part_p_mfgr_3#8511, cval_part_p_type#8495 AS cval_part_p_type_3#8512, cval_part_p_size#8496 AS cval_part_p_size_3#8513, cval_part_p_container#8497 AS cval_part_p_container_3#8514, cval_part_p_retailprice#8498 AS cval_part_p_retailprice_3#8515, cval_part_p_comment#8499 AS cval_part_p_comment_3#8516, cval_part_p_brand#8500 AS cval_part_p_brand_3#8517, cp_name#8501 AS cp_name_3#8518, cp_mfgr#8502 AS cp_mfgr_3#8519, cp_type#8503 AS cp_type_3#8520, cp_size#8504 AS cp_size_3#8521, cp_container#8505 AS cp_container_3#8522, cp_retailprice#8506 AS cp_retailprice_3#8523, cp_comment#8507 AS cp_comment_3#8524, cp_brand#8508 AS cp_brand_3#8525]
            :     :  +- Relation[rid#8492,cval_part_p_name#8493,cval_part_p_mfgr#8494,cval_part_p_type#8495,cval_part_p_size#8496,cval_part_p_container#8497,cval_part_p_retailprice#8498,cval_part_p_comment#8499,cval_part_p_brand#8500,cp_name#8501,cp_mfgr#8502,cp_type#8503,cp_size#8504,cp_container#8505,cp_retailprice#8506,cp_comment#8507,cp_brand#8508] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#8526 AS rid_4#8537, cpfk_part_partsupp#8527 AS cpfk_part_partsupp_4#8538, cfpk_partsupp_part#8528 AS cfpk_partsupp_part_4#8539, cpfk_supplier_partsupp#8529 AS cpfk_supplier_partsupp_4#8540, cfpk_partsupp_supplier#8530 AS cfpk_partsupp_supplier_4#8541, cval_partsupp_ps_availqty#8531 AS cval_partsupp_ps_availqty_4#8542, cval_partsupp_ps_supplycost#8532 AS cval_partsupp_ps_supplycost_4#8543, cval_partsupp_ps_comment#8533 AS cval_partsupp_ps_comment_4#8544, cps_availqty#8534 AS cps_availqty_4#8545, cps_supplycost#8535 AS cps_supplycost_4#8546, cps_comment#8536 AS cps_comment_4#8547]
            :        +- Relation[rid#8526,cpfk_part_partsupp#8527,cfpk_partsupp_part#8528,cpfk_supplier_partsupp#8529,cfpk_partsupp_supplier#8530,cval_partsupp_ps_availqty#8531,cval_partsupp_ps_supplycost#8532,cval_partsupp_ps_comment#8533,cps_availqty#8534,cps_supplycost#8535,cps_comment#8536] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#8470 AS rid_4#8481, cpfk_part_partsupp#8471 AS cpfk_part_partsupp_4#8482, cfpk_partsupp_part#8472 AS cfpk_partsupp_part_4#8483, cpfk_supplier_partsupp#8473 AS cpfk_supplier_partsupp_4#8484, cfpk_partsupp_supplier#8474 AS cfpk_partsupp_supplier_4#8485, cval_partsupp_ps_availqty#8475 AS cval_partsupp_ps_availqty_4#8486, cval_partsupp_ps_supplycost#8476 AS cval_partsupp_ps_supplycost_4#8487, cval_partsupp_ps_comment#8477 AS cval_partsupp_ps_comment_4#8488, cps_availqty#8478 AS cps_availqty_4#8489, cps_supplycost#8479 AS cps_supplycost_4#8490, cps_comment#8480 AS cps_comment_4#8491]
               +- Relation[rid#8470,cpfk_part_partsupp#8471,cfpk_partsupp_part#8472,cpfk_supplier_partsupp#8473,cfpk_partsupp_supplier#8474,cval_partsupp_ps_availqty#8475,cval_partsupp_ps_supplycost#8476,cval_partsupp_ps_comment#8477,cps_availqty#8478,cps_supplycost#8479,cps_comment#8480] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 20731ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 06:12:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:12:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8658L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 06:12:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:12:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:12:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:12:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:12:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:12:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:12:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:12:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:12:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:12:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:12:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:12:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:12:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:12:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:12:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:12:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:12:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8658L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#8660 AS rid_0#8667, cpfk_region_nation#8661 AS cpfk_region_nation_0#8668, cfpk_nation_region#8662 AS cfpk_nation_region_0#8669, cval_nation_n_name#8663 AS cval_nation_n_name_0#8670, cval_nation_n_comment#8664 AS cval_nation_n_comment_0#8671, cn_name#8665 AS cn_name_0#8672, cn_comment#8666 AS cn_comment_0#8673]
            :  :  :     :  :  :  :  :  +- Relation[rid#8660,cpfk_region_nation#8661,cfpk_nation_region#8662,cval_nation_n_name#8663,cval_nation_n_comment#8664,cn_name#8665,cn_comment#8666] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#8700 AS rid_0#8707, cpfk_region_nation#8701 AS cpfk_region_nation_0#8708, cfpk_nation_region#8702 AS cfpk_nation_region_0#8709, cval_nation_n_name#8703 AS cval_nation_n_name_0#8710, cval_nation_n_comment#8704 AS cval_nation_n_comment_0#8711, cn_name#8705 AS cn_name_0#8712, cn_comment#8706 AS cn_comment_0#8713]
            :  :  :     :  :  :  :     :  +- Relation[rid#8700,cpfk_region_nation#8701,cfpk_nation_region#8702,cval_nation_n_name#8703,cval_nation_n_comment#8704,cn_name#8705,cn_comment#8706] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#8714 AS rid_1#8727, cpfk_nation_supplier#8715 AS cpfk_nation_supplier_1#8728, cfpk_supplier_nation#8716 AS cfpk_supplier_nation_1#8729, cval_supplier_s_name#8717 AS cval_supplier_s_name_1#8730, cval_supplier_s_address#8718 AS cval_supplier_s_address_1#8731, cval_supplier_s_phone#8719 AS cval_supplier_s_phone_1#8732, cval_supplier_s_acctbal#8720 AS cval_supplier_s_acctbal_1#8733, cval_supplier_s_comment#8721 AS cval_supplier_s_comment_1#8734, cs_name#8722 AS cs_name_1#8735, cs_address#8723 AS cs_address_1#8736, cs_phone#8724 AS cs_phone_1#8737, cs_acctbal#8725 AS cs_acctbal_1#8738, cs_comment#8726 AS cs_comment_1#8739]
            :  :  :     :  :  :  :        +- Relation[rid#8714,cpfk_nation_supplier#8715,cfpk_supplier_nation#8716,cval_supplier_s_name#8717,cval_supplier_s_address#8718,cval_supplier_s_phone#8719,cval_supplier_s_acctbal#8720,cval_supplier_s_comment#8721,cs_name#8722,cs_address#8723,cs_phone#8724,cs_acctbal#8725,cs_comment#8726] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#8674 AS rid_1#8687, cpfk_nation_supplier#8675 AS cpfk_nation_supplier_1#8688, cfpk_supplier_nation#8676 AS cfpk_supplier_nation_1#8689, cval_supplier_s_name#8677 AS cval_supplier_s_name_1#8690, cval_supplier_s_address#8678 AS cval_supplier_s_address_1#8691, cval_supplier_s_phone#8679 AS cval_supplier_s_phone_1#8692, cval_supplier_s_acctbal#8680 AS cval_supplier_s_acctbal_1#8693, cval_supplier_s_comment#8681 AS cval_supplier_s_comment_1#8694, cs_name#8682 AS cs_name_1#8695, cs_address#8683 AS cs_address_1#8696, cs_phone#8684 AS cs_phone_1#8697, cs_acctbal#8685 AS cs_acctbal_1#8698, cs_comment#8686 AS cs_comment_1#8699]
            :  :  :     :  :  :     +- Relation[rid#8674,cpfk_nation_supplier#8675,cfpk_supplier_nation#8676,cval_supplier_s_name#8677,cval_supplier_s_address#8678,cval_supplier_s_phone#8679,cval_supplier_s_acctbal#8680,cval_supplier_s_comment#8681,cs_name#8682,cs_address#8683,cs_phone#8684,cs_acctbal#8685,cs_comment#8686] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#8762 AS rid_1#8775, cpfk_nation_supplier#8763 AS cpfk_nation_supplier_1#8776, cfpk_supplier_nation#8764 AS cfpk_supplier_nation_1#8777, cval_supplier_s_name#8765 AS cval_supplier_s_name_1#8778, cval_supplier_s_address#8766 AS cval_supplier_s_address_1#8779, cval_supplier_s_phone#8767 AS cval_supplier_s_phone_1#8780, cval_supplier_s_acctbal#8768 AS cval_supplier_s_acctbal_1#8781, cval_supplier_s_comment#8769 AS cval_supplier_s_comment_1#8782, cs_name#8770 AS cs_name_1#8783, cs_address#8771 AS cs_address_1#8784, cs_phone#8772 AS cs_phone_1#8785, cs_acctbal#8773 AS cs_acctbal_1#8786, cs_comment#8774 AS cs_comment_1#8787]
            :  :  :     :  :     :  +- Relation[rid#8762,cpfk_nation_supplier#8763,cfpk_supplier_nation#8764,cval_supplier_s_name#8765,cval_supplier_s_address#8766,cval_supplier_s_phone#8767,cval_supplier_s_acctbal#8768,cval_supplier_s_comment#8769,cs_name#8770,cs_address#8771,cs_phone#8772,cs_acctbal#8773,cs_comment#8774] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#8788 AS rid_2#8799, cpfk_part_partsupp#8789 AS cpfk_part_partsupp_2#8800, cfpk_partsupp_part#8790 AS cfpk_partsupp_part_2#8801, cpfk_supplier_partsupp#8791 AS cpfk_supplier_partsupp_2#8802, cfpk_partsupp_supplier#8792 AS cfpk_partsupp_supplier_2#8803, cval_partsupp_ps_availqty#8793 AS cval_partsupp_ps_availqty_2#8804, cval_partsupp_ps_supplycost#8794 AS cval_partsupp_ps_supplycost_2#8805, cval_partsupp_ps_comment#8795 AS cval_partsupp_ps_comment_2#8806, cps_availqty#8796 AS cps_availqty_2#8807, cps_supplycost#8797 AS cps_supplycost_2#8808, cps_comment#8798 AS cps_comment_2#8809]
            :  :  :     :  :        +- Relation[rid#8788,cpfk_part_partsupp#8789,cfpk_partsupp_part#8790,cpfk_supplier_partsupp#8791,cfpk_partsupp_supplier#8792,cval_partsupp_ps_availqty#8793,cval_partsupp_ps_supplycost#8794,cval_partsupp_ps_comment#8795,cps_availqty#8796,cps_supplycost#8797,cps_comment#8798] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#8740 AS rid_2#8751, cpfk_part_partsupp#8741 AS cpfk_part_partsupp_2#8752, cfpk_partsupp_part#8742 AS cfpk_partsupp_part_2#8753, cpfk_supplier_partsupp#8743 AS cpfk_supplier_partsupp_2#8754, cfpk_partsupp_supplier#8744 AS cfpk_partsupp_supplier_2#8755, cval_partsupp_ps_availqty#8745 AS cval_partsupp_ps_availqty_2#8756, cval_partsupp_ps_supplycost#8746 AS cval_partsupp_ps_supplycost_2#8757, cval_partsupp_ps_comment#8747 AS cval_partsupp_ps_comment_2#8758, cps_availqty#8748 AS cps_availqty_2#8759, cps_supplycost#8749 AS cps_supplycost_2#8760, cps_comment#8750 AS cps_comment_2#8761]
            :  :  :     :     +- Relation[rid#8740,cpfk_part_partsupp#8741,cfpk_partsupp_part#8742,cpfk_supplier_partsupp#8743,cfpk_partsupp_supplier#8744,cval_partsupp_ps_availqty#8745,cval_partsupp_ps_supplycost#8746,cval_partsupp_ps_comment#8747,cps_availqty#8748,cps_supplycost#8749,cps_comment#8750] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#8810 AS rid_3#8827, cval_part_p_name#8811 AS cval_part_p_name_3#8828, cval_part_p_mfgr#8812 AS cval_part_p_mfgr_3#8829, cval_part_p_type#8813 AS cval_part_p_type_3#8830, cval_part_p_size#8814 AS cval_part_p_size_3#8831, cval_part_p_container#8815 AS cval_part_p_container_3#8832, cval_part_p_retailprice#8816 AS cval_part_p_retailprice_3#8833, cval_part_p_comment#8817 AS cval_part_p_comment_3#8834, cval_part_p_brand#8818 AS cval_part_p_brand_3#8835, cp_name#8819 AS cp_name_3#8836, cp_mfgr#8820 AS cp_mfgr_3#8837, cp_type#8821 AS cp_type_3#8838, cp_size#8822 AS cp_size_3#8839, cp_container#8823 AS cp_container_3#8840, cp_retailprice#8824 AS cp_retailprice_3#8841, cp_comment#8825 AS cp_comment_3#8842, cp_brand#8826 AS cp_brand_3#8843]
            :  :  :        +- Relation[rid#8810,cval_part_p_name#8811,cval_part_p_mfgr#8812,cval_part_p_type#8813,cval_part_p_size#8814,cval_part_p_container#8815,cval_part_p_retailprice#8816,cval_part_p_comment#8817,cval_part_p_brand#8818,cp_name#8819,cp_mfgr#8820,cp_type#8821,cp_size#8822,cp_container#8823,cp_retailprice#8824,cp_comment#8825,cp_brand#8826] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#8910 AS rid_2#8921, cpfk_part_partsupp#8911 AS cpfk_part_partsupp_2#8922, cfpk_partsupp_part#8912 AS cfpk_partsupp_part_2#8923, cpfk_supplier_partsupp#8913 AS cpfk_supplier_partsupp_2#8924, cfpk_partsupp_supplier#8914 AS cfpk_partsupp_supplier_2#8925, cval_partsupp_ps_availqty#8915 AS cval_partsupp_ps_availqty_2#8926, cval_partsupp_ps_supplycost#8916 AS cval_partsupp_ps_supplycost_2#8927, cval_partsupp_ps_comment#8917 AS cval_partsupp_ps_comment_2#8928, cps_availqty#8918 AS cps_availqty_2#8929, cps_supplycost#8919 AS cps_supplycost_2#8930, cps_comment#8920 AS cps_comment_2#8931]
            :  :     :  +- Relation[rid#8910,cpfk_part_partsupp#8911,cfpk_partsupp_part#8912,cpfk_supplier_partsupp#8913,cfpk_partsupp_supplier#8914,cval_partsupp_ps_availqty#8915,cval_partsupp_ps_supplycost#8916,cval_partsupp_ps_comment#8917,cps_availqty#8918,cps_supplycost#8919,cps_comment#8920] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#8932 AS rid_4#8965, cpfk_orders_lineitem#8933 AS cpfk_orders_lineitem_4#8966, cpfk_supplier_lineitem#8934 AS cpfk_supplier_lineitem_4#8967, cfpk_lineitem_supplier#8935 AS cfpk_lineitem_supplier_4#8968, cfpk_lineitem_partsupp#8936 AS cfpk_lineitem_partsupp_4#8969, cpfk_part_lineitem#8937 AS cpfk_part_lineitem_4#8970, cfpk_lineitem_part#8938 AS cfpk_lineitem_part_4#8971, cpfk_partsupp_lineitem#8939 AS cpfk_partsupp_lineitem_4#8972, cfpk_lineitem_orders#8940 AS cfpk_lineitem_orders_4#8973, cval_lineitem_l_quantity#8941 AS cval_lineitem_l_quantity_4#8974, cval_lineitem_l_extendedprice#8942 AS cval_lineitem_l_extendedprice_4#8975, cval_lineitem_l_discount#8943 AS cval_lineitem_l_discount_4#8976, cval_lineitem_l_tax#8944 AS cval_lineitem_l_tax_4#8977, cval_lineitem_l_returnflag#8945 AS cval_lineitem_l_returnflag_4#8978, cval_lineitem_l_linestatus#8946 AS cval_lineitem_l_linestatus_4#8979, cval_lineitem_l_commitdate#8947 AS cval_lineitem_l_commitdate_4#8980, cval_lineitem_l_receiptdate#8948 AS cval_lineitem_l_receiptdate_4#8981, cval_lineitem_l_shipinstruct#8949 AS cval_lineitem_l_shipinstruct_4#8982, cval_lineitem_l_shipmode#8950 AS cval_lineitem_l_shipmode_4#8983, cval_lineitem_l_comment#8951 AS cval_lineitem_l_comment_4#8984, cval_lineitem_l_shipdate#8952 AS cval_lineitem_l_shipdate_4#8985, cl_quantity#8953 AS cl_quantity_4#8986, cl_extendedprice#8954 AS cl_extendedprice_4#8987, cl_discount#8955 AS cl_discount_4#8988, ... 9 more fields]
            :  :        +- Relation[rid#8932,cpfk_orders_lineitem#8933,cpfk_supplier_lineitem#8934,cfpk_lineitem_supplier#8935,cfpk_lineitem_partsupp#8936,cpfk_part_lineitem#8937,cfpk_lineitem_part#8938,cpfk_partsupp_lineitem#8939,cfpk_lineitem_orders#8940,cval_lineitem_l_quantity#8941,cval_lineitem_l_extendedprice#8942,cval_lineitem_l_discount#8943,cval_lineitem_l_tax#8944,cval_lineitem_l_returnflag#8945,cval_lineitem_l_linestatus#8946,cval_lineitem_l_commitdate#8947,cval_lineitem_l_receiptdate#8948,cval_lineitem_l_shipinstruct#8949,cval_lineitem_l_shipmode#8950,cval_lineitem_l_comment#8951,cval_lineitem_l_shipdate#8952,cl_quantity#8953,cl_extendedprice#8954,cl_discount#8955,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#8844 AS rid_4#8877, cpfk_orders_lineitem#8845 AS cpfk_orders_lineitem_4#8878, cpfk_supplier_lineitem#8846 AS cpfk_supplier_lineitem_4#8879, cfpk_lineitem_supplier#8847 AS cfpk_lineitem_supplier_4#8880, cfpk_lineitem_partsupp#8848 AS cfpk_lineitem_partsupp_4#8881, cpfk_part_lineitem#8849 AS cpfk_part_lineitem_4#8882, cfpk_lineitem_part#8850 AS cfpk_lineitem_part_4#8883, cpfk_partsupp_lineitem#8851 AS cpfk_partsupp_lineitem_4#8884, cfpk_lineitem_orders#8852 AS cfpk_lineitem_orders_4#8885, cval_lineitem_l_quantity#8853 AS cval_lineitem_l_quantity_4#8886, cval_lineitem_l_extendedprice#8854 AS cval_lineitem_l_extendedprice_4#8887, cval_lineitem_l_discount#8855 AS cval_lineitem_l_discount_4#8888, cval_lineitem_l_tax#8856 AS cval_lineitem_l_tax_4#8889, cval_lineitem_l_returnflag#8857 AS cval_lineitem_l_returnflag_4#8890, cval_lineitem_l_linestatus#8858 AS cval_lineitem_l_linestatus_4#8891, cval_lineitem_l_commitdate#8859 AS cval_lineitem_l_commitdate_4#8892, cval_lineitem_l_receiptdate#8860 AS cval_lineitem_l_receiptdate_4#8893, cval_lineitem_l_shipinstruct#8861 AS cval_lineitem_l_shipinstruct_4#8894, cval_lineitem_l_shipmode#8862 AS cval_lineitem_l_shipmode_4#8895, cval_lineitem_l_comment#8863 AS cval_lineitem_l_comment_4#8896, cval_lineitem_l_shipdate#8864 AS cval_lineitem_l_shipdate_4#8897, cl_quantity#8865 AS cl_quantity_4#8898, cl_extendedprice#8866 AS cl_extendedprice_4#8899, cl_discount#8867 AS cl_discount_4#8900, ... 9 more fields]
            :     +- Relation[rid#8844,cpfk_orders_lineitem#8845,cpfk_supplier_lineitem#8846,cfpk_lineitem_supplier#8847,cfpk_lineitem_partsupp#8848,cpfk_part_lineitem#8849,cfpk_lineitem_part#8850,cpfk_partsupp_lineitem#8851,cfpk_lineitem_orders#8852,cval_lineitem_l_quantity#8853,cval_lineitem_l_extendedprice#8854,cval_lineitem_l_discount#8855,cval_lineitem_l_tax#8856,cval_lineitem_l_returnflag#8857,cval_lineitem_l_linestatus#8858,cval_lineitem_l_commitdate#8859,cval_lineitem_l_receiptdate#8860,cval_lineitem_l_shipinstruct#8861,cval_lineitem_l_shipmode#8862,cval_lineitem_l_comment#8863,cval_lineitem_l_shipdate#8864,cl_quantity#8865,cl_extendedprice#8866,cl_discount#8867,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#8998 AS rid_5#9015, cpfk_customer_orders#8999 AS cpfk_customer_orders_5#9016, cfpk_orders_customer#9000 AS cfpk_orders_customer_5#9017, cval_orders_o_orderstatus#9001 AS cval_orders_o_orderstatus_5#9018, cval_orders_o_totalprice#9002 AS cval_orders_o_totalprice_5#9019, cval_orders_o_orderpriority#9003 AS cval_orders_o_orderpriority_5#9020, cval_orders_o_clerk#9004 AS cval_orders_o_clerk_5#9021, cval_orders_o_shippriority#9005 AS cval_orders_o_shippriority_5#9022, cval_orders_o_comment#9006 AS cval_orders_o_comment_5#9023, cval_orders_o_orderdate#9007 AS cval_orders_o_orderdate_5#9024, co_orderstatus#9008 AS co_orderstatus_5#9025, co_totalprice#9009 AS co_totalprice_5#9026, co_orderpriority#9010 AS co_orderpriority_5#9027, co_clerk#9011 AS co_clerk_5#9028, co_shippriority#9012 AS co_shippriority_5#9029, co_comment#9013 AS co_comment_5#9030, co_orderdate#9014 AS co_orderdate_5#9031]
               +- Relation[rid#8998,cpfk_customer_orders#8999,cfpk_orders_customer#9000,cval_orders_o_orderstatus#9001,cval_orders_o_totalprice#9002,cval_orders_o_orderpriority#9003,cval_orders_o_clerk#9004,cval_orders_o_shippriority#9005,cval_orders_o_comment#9006,cval_orders_o_orderdate#9007,co_orderstatus#9008,co_totalprice#9009,co_orderpriority#9010,co_clerk#9011,co_shippriority#9012,co_comment#9013,co_orderdate#9014] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 163362ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/11 06:15:15 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:15:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9158L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 06:15:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9158L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#9160 AS rid_0#9193, cpfk_orders_lineitem#9161 AS cpfk_orders_lineitem_0#9194, cpfk_supplier_lineitem#9162 AS cpfk_supplier_lineitem_0#9195, cfpk_lineitem_supplier#9163 AS cfpk_lineitem_supplier_0#9196, cfpk_lineitem_partsupp#9164 AS cfpk_lineitem_partsupp_0#9197, cpfk_part_lineitem#9165 AS cpfk_part_lineitem_0#9198, cfpk_lineitem_part#9166 AS cfpk_lineitem_part_0#9199, cpfk_partsupp_lineitem#9167 AS cpfk_partsupp_lineitem_0#9200, cfpk_lineitem_orders#9168 AS cfpk_lineitem_orders_0#9201, cval_lineitem_l_quantity#9169 AS cval_lineitem_l_quantity_0#9202, cval_lineitem_l_extendedprice#9170 AS cval_lineitem_l_extendedprice_0#9203, cval_lineitem_l_discount#9171 AS cval_lineitem_l_discount_0#9204, cval_lineitem_l_tax#9172 AS cval_lineitem_l_tax_0#9205, cval_lineitem_l_returnflag#9173 AS cval_lineitem_l_returnflag_0#9206, cval_lineitem_l_linestatus#9174 AS cval_lineitem_l_linestatus_0#9207, cval_lineitem_l_commitdate#9175 AS cval_lineitem_l_commitdate_0#9208, cval_lineitem_l_receiptdate#9176 AS cval_lineitem_l_receiptdate_0#9209, cval_lineitem_l_shipinstruct#9177 AS cval_lineitem_l_shipinstruct_0#9210, cval_lineitem_l_shipmode#9178 AS cval_lineitem_l_shipmode_0#9211, cval_lineitem_l_comment#9179 AS cval_lineitem_l_comment_0#9212, cval_lineitem_l_shipdate#9180 AS cval_lineitem_l_shipdate_0#9213, cl_quantity#9181 AS cl_quantity_0#9214, cl_extendedprice#9182 AS cl_extendedprice_0#9215, cl_discount#9183 AS cl_discount_0#9216, ... 9 more fields]
            :  +- Relation[rid#9160,cpfk_orders_lineitem#9161,cpfk_supplier_lineitem#9162,cfpk_lineitem_supplier#9163,cfpk_lineitem_partsupp#9164,cpfk_part_lineitem#9165,cfpk_lineitem_part#9166,cpfk_partsupp_lineitem#9167,cfpk_lineitem_orders#9168,cval_lineitem_l_quantity#9169,cval_lineitem_l_extendedprice#9170,cval_lineitem_l_discount#9171,cval_lineitem_l_tax#9172,cval_lineitem_l_returnflag#9173,cval_lineitem_l_linestatus#9174,cval_lineitem_l_commitdate#9175,cval_lineitem_l_receiptdate#9176,cval_lineitem_l_shipinstruct#9177,cval_lineitem_l_shipmode#9178,cval_lineitem_l_comment#9179,cval_lineitem_l_shipdate#9180,cl_quantity#9181,cl_extendedprice#9182,cl_discount#9183,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#9226 AS rid_1#9243, cpfk_customer_orders#9227 AS cpfk_customer_orders_1#9244, cfpk_orders_customer#9228 AS cfpk_orders_customer_1#9245, cval_orders_o_orderstatus#9229 AS cval_orders_o_orderstatus_1#9246, cval_orders_o_totalprice#9230 AS cval_orders_o_totalprice_1#9247, cval_orders_o_orderpriority#9231 AS cval_orders_o_orderpriority_1#9248, cval_orders_o_clerk#9232 AS cval_orders_o_clerk_1#9249, cval_orders_o_shippriority#9233 AS cval_orders_o_shippriority_1#9250, cval_orders_o_comment#9234 AS cval_orders_o_comment_1#9251, cval_orders_o_orderdate#9235 AS cval_orders_o_orderdate_1#9252, co_orderstatus#9236 AS co_orderstatus_1#9253, co_totalprice#9237 AS co_totalprice_1#9254, co_orderpriority#9238 AS co_orderpriority_1#9255, co_clerk#9239 AS co_clerk_1#9256, co_shippriority#9240 AS co_shippriority_1#9257, co_comment#9241 AS co_comment_1#9258, co_orderdate#9242 AS co_orderdate_1#9259]
               +- Relation[rid#9226,cpfk_customer_orders#9227,cfpk_orders_customer#9228,cval_orders_o_orderstatus#9229,cval_orders_o_totalprice#9230,cval_orders_o_orderpriority#9231,cval_orders_o_clerk#9232,cval_orders_o_shippriority#9233,cval_orders_o_comment#9234,cval_orders_o_orderdate#9235,co_orderstatus#9236,co_totalprice#9237,co_orderpriority#9238,co_clerk#9239,co_shippriority#9240,co_comment#9241,co_orderdate#9242] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 54181ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/11 06:16:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:16:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9315L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 06:16:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#9315L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#9317 AS rid_0#9350, cpfk_orders_lineitem#9318 AS cpfk_orders_lineitem_0#9351, cpfk_supplier_lineitem#9319 AS cpfk_supplier_lineitem_0#9352, cfpk_lineitem_supplier#9320 AS cfpk_lineitem_supplier_0#9353, cfpk_lineitem_partsupp#9321 AS cfpk_lineitem_partsupp_0#9354, cpfk_part_lineitem#9322 AS cpfk_part_lineitem_0#9355, cfpk_lineitem_part#9323 AS cfpk_lineitem_part_0#9356, cpfk_partsupp_lineitem#9324 AS cpfk_partsupp_lineitem_0#9357, cfpk_lineitem_orders#9325 AS cfpk_lineitem_orders_0#9358, cval_lineitem_l_quantity#9326 AS cval_lineitem_l_quantity_0#9359, cval_lineitem_l_extendedprice#9327 AS cval_lineitem_l_extendedprice_0#9360, cval_lineitem_l_discount#9328 AS cval_lineitem_l_discount_0#9361, cval_lineitem_l_tax#9329 AS cval_lineitem_l_tax_0#9362, cval_lineitem_l_returnflag#9330 AS cval_lineitem_l_returnflag_0#9363, cval_lineitem_l_linestatus#9331 AS cval_lineitem_l_linestatus_0#9364, cval_lineitem_l_commitdate#9332 AS cval_lineitem_l_commitdate_0#9365, cval_lineitem_l_receiptdate#9333 AS cval_lineitem_l_receiptdate_0#9366, cval_lineitem_l_shipinstruct#9334 AS cval_lineitem_l_shipinstruct_0#9367, cval_lineitem_l_shipmode#9335 AS cval_lineitem_l_shipmode_0#9368, cval_lineitem_l_comment#9336 AS cval_lineitem_l_comment_0#9369, cval_lineitem_l_shipdate#9337 AS cval_lineitem_l_shipdate_0#9370, cl_quantity#9338 AS cl_quantity_0#9371, cl_extendedprice#9339 AS cl_extendedprice_0#9372, cl_discount#9340 AS cl_discount_0#9373, ... 9 more fields]
         +- Relation[rid#9317,cpfk_orders_lineitem#9318,cpfk_supplier_lineitem#9319,cfpk_lineitem_supplier#9320,cfpk_lineitem_partsupp#9321,cpfk_part_lineitem#9322,cfpk_lineitem_part#9323,cpfk_partsupp_lineitem#9324,cfpk_lineitem_orders#9325,cval_lineitem_l_quantity#9326,cval_lineitem_l_extendedprice#9327,cval_lineitem_l_discount#9328,cval_lineitem_l_tax#9329,cval_lineitem_l_returnflag#9330,cval_lineitem_l_linestatus#9331,cval_lineitem_l_commitdate#9332,cval_lineitem_l_receiptdate#9333,cval_lineitem_l_shipinstruct#9334,cval_lineitem_l_shipmode#9335,cval_lineitem_l_comment#9336,cval_lineitem_l_shipdate#9337,cl_quantity#9338,cl_extendedprice#9339,cl_discount#9340,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 3435ms
query=q1, count=6001215, duration=6705
query=q10, count=1478870, duration=61492
query=q11, count=31680, duration=10895
query=q12, count=857401, duration=22806
query=q13, count=1500000, duration=12849
query=q14, count=6001215, duration=83544
query=q15, count=6001215, duration=77616
query=q16, count=15780, duration=11235
query=q17, count=6088, duration=72470
query=q18, count=6001215, duration=118432
query=q19, count=205, duration=365542
query=q2, count=3162, duration=20731
query=q20, count=632, duration=11537
query=q21a, count=597422, duration=248411
query=q22, count=1500000, duration=12887
query=q3, count=1214743, duration=117364
query=q4, count=6001215, duration=54181
query=q5, count=1206514, duration=165720
query=q6, count=6001215, duration=3435
query=q7, count=9735, duration=104340
query=q8, count=8716, duration=96570
query=q9a, count=6001215, duration=247364
query=q9b, count=6001215, duration=163362
