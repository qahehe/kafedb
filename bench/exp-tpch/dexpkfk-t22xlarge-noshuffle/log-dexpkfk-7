20/04/11 06:16:14 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 11962ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 11 06:16:17 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 11 06:16:19 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 11 06:16:19 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 11 06:16:19 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 11 06:16:19 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 11 06:16:24 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 11 06:16:28 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 11 06:16:28 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/11 06:16:30 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:16:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2081L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 06:16:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:16:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:16:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:16:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:16:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:16:30 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:16:30 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:16:30 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:16:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:16:30 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:16:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:16:30 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:16:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:16:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:16:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:16:30 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/11 06:16:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2081L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#2083 AS rid_0#2100, cval_part_p_name#2084 AS cval_part_p_name_0#2101, cval_part_p_mfgr#2085 AS cval_part_p_mfgr_0#2102, cval_part_p_type#2086 AS cval_part_p_type_0#2103, cval_part_p_size#2087 AS cval_part_p_size_0#2104, cval_part_p_container#2088 AS cval_part_p_container_0#2105, cval_part_p_retailprice#2089 AS cval_part_p_retailprice_0#2106, cval_part_p_comment#2090 AS cval_part_p_comment_0#2107, cval_part_p_brand#2091 AS cval_part_p_brand_0#2108, cp_name#2092 AS cp_name_0#2109, cp_mfgr#2093 AS cp_mfgr_0#2110, cp_type#2094 AS cp_type_0#2111, cp_size#2095 AS cp_size_0#2112, cp_container#2096 AS cp_container_0#2113, cp_retailprice#2097 AS cp_retailprice_0#2114, cp_comment#2098 AS cp_comment_0#2115, cp_brand#2099 AS cp_brand_0#2116]
            :     :     :  :  :  :  +- Relation[rid#2083,cval_part_p_name#2084,cval_part_p_mfgr#2085,cval_part_p_type#2086,cval_part_p_size#2087,cval_part_p_container#2088,cval_part_p_retailprice#2089,cval_part_p_comment#2090,cval_part_p_brand#2091,cp_name#2092,cp_mfgr#2093,cp_type#2094,cp_size#2095,cp_container#2096,cp_retailprice#2097,cp_comment#2098,cp_brand#2099] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#2117 AS rid_0#2134, cval_part_p_name#2118 AS cval_part_p_name_0#2135, cval_part_p_mfgr#2119 AS cval_part_p_mfgr_0#2136, cval_part_p_type#2120 AS cval_part_p_type_0#2137, cval_part_p_size#2121 AS cval_part_p_size_0#2138, cval_part_p_container#2122 AS cval_part_p_container_0#2139, cval_part_p_retailprice#2123 AS cval_part_p_retailprice_0#2140, cval_part_p_comment#2124 AS cval_part_p_comment_0#2141, cval_part_p_brand#2125 AS cval_part_p_brand_0#2142, cp_name#2126 AS cp_name_0#2143, cp_mfgr#2127 AS cp_mfgr_0#2144, cp_type#2128 AS cp_type_0#2145, cp_size#2129 AS cp_size_0#2146, cp_container#2130 AS cp_container_0#2147, cp_retailprice#2131 AS cp_retailprice_0#2148, cp_comment#2132 AS cp_comment_0#2149, cp_brand#2133 AS cp_brand_0#2150]
            :     :     :  :  :        +- Relation[rid#2117,cval_part_p_name#2118,cval_part_p_mfgr#2119,cval_part_p_type#2120,cval_part_p_size#2121,cval_part_p_container#2122,cval_part_p_retailprice#2123,cval_part_p_comment#2124,cval_part_p_brand#2125,cp_name#2126,cp_mfgr#2127,cp_type#2128,cp_size#2129,cp_container#2130,cp_retailprice#2131,cp_comment#2132,cp_brand#2133] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :     :- Project [rid#2217 AS rid_0#2234, cval_part_p_name#2218 AS cval_part_p_name_0#2235, cval_part_p_mfgr#2219 AS cval_part_p_mfgr_0#2236, cval_part_p_type#2220 AS cval_part_p_type_0#2237, cval_part_p_size#2221 AS cval_part_p_size_0#2238, cval_part_p_container#2222 AS cval_part_p_container_0#2239, cval_part_p_retailprice#2223 AS cval_part_p_retailprice_0#2240, cval_part_p_comment#2224 AS cval_part_p_comment_0#2241, cval_part_p_brand#2225 AS cval_part_p_brand_0#2242, cp_name#2226 AS cp_name_0#2243, cp_mfgr#2227 AS cp_mfgr_0#2244, cp_type#2228 AS cp_type_0#2245, cp_size#2229 AS cp_size_0#2246, cp_container#2230 AS cp_container_0#2247, cp_retailprice#2231 AS cp_retailprice_0#2248, cp_comment#2232 AS cp_comment_0#2249, cp_brand#2233 AS cp_brand_0#2250]
            :     :     :  :     :  +- Relation[rid#2217,cval_part_p_name#2218,cval_part_p_mfgr#2219,cval_part_p_type#2220,cval_part_p_size#2221,cval_part_p_container#2222,cval_part_p_retailprice#2223,cval_part_p_comment#2224,cval_part_p_brand#2225,cp_name#2226,cp_mfgr#2227,cp_type#2228,cp_size#2229,cp_container#2230,cp_retailprice#2231,cp_comment#2232,cp_brand#2233] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :     +- Project [rid#2251 AS rid_1#2284, cpfk_orders_lineitem#2252 AS cpfk_orders_lineitem_1#2285, cpfk_supplier_lineitem#2253 AS cpfk_supplier_lineitem_1#2286, cfpk_lineitem_supplier#2254 AS cfpk_lineitem_supplier_1#2287, cfpk_lineitem_partsupp#2255 AS cfpk_lineitem_partsupp_1#2288, cpfk_part_lineitem#2256 AS cpfk_part_lineitem_1#2289, cfpk_lineitem_part#2257 AS cfpk_lineitem_part_1#2290, cpfk_partsupp_lineitem#2258 AS cpfk_partsupp_lineitem_1#2291, cfpk_lineitem_orders#2259 AS cfpk_lineitem_orders_1#2292, cval_lineitem_l_quantity#2260 AS cval_lineitem_l_quantity_1#2293, cval_lineitem_l_extendedprice#2261 AS cval_lineitem_l_extendedprice_1#2294, cval_lineitem_l_discount#2262 AS cval_lineitem_l_discount_1#2295, cval_lineitem_l_tax#2263 AS cval_lineitem_l_tax_1#2296, cval_lineitem_l_returnflag#2264 AS cval_lineitem_l_returnflag_1#2297, cval_lineitem_l_linestatus#2265 AS cval_lineitem_l_linestatus_1#2298, cval_lineitem_l_commitdate#2266 AS cval_lineitem_l_commitdate_1#2299, cval_lineitem_l_receiptdate#2267 AS cval_lineitem_l_receiptdate_1#2300, cval_lineitem_l_shipinstruct#2268 AS cval_lineitem_l_shipinstruct_1#2301, cval_lineitem_l_shipmode#2269 AS cval_lineitem_l_shipmode_1#2302, cval_lineitem_l_comment#2270 AS cval_lineitem_l_comment_1#2303, cval_lineitem_l_shipdate#2271 AS cval_lineitem_l_shipdate_1#2304, cl_quantity#2272 AS cl_quantity_1#2305, cl_extendedprice#2273 AS cl_extendedprice_1#2306, cl_discount#2274 AS cl_discount_1#2307, ... 9 more fields]
            :     :     :  :        +- Relation[rid#2251,cpfk_orders_lineitem#2252,cpfk_supplier_lineitem#2253,cfpk_lineitem_supplier#2254,cfpk_lineitem_partsupp#2255,cpfk_part_lineitem#2256,cfpk_lineitem_part#2257,cpfk_partsupp_lineitem#2258,cfpk_lineitem_orders#2259,cval_lineitem_l_quantity#2260,cval_lineitem_l_extendedprice#2261,cval_lineitem_l_discount#2262,cval_lineitem_l_tax#2263,cval_lineitem_l_returnflag#2264,cval_lineitem_l_linestatus#2265,cval_lineitem_l_commitdate#2266,cval_lineitem_l_receiptdate#2267,cval_lineitem_l_shipinstruct#2268,cval_lineitem_l_shipmode#2269,cval_lineitem_l_comment#2270,cval_lineitem_l_shipdate#2271,cl_quantity#2272,cl_extendedprice#2273,cl_discount#2274,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#2151 AS rid_1#2184, cpfk_orders_lineitem#2152 AS cpfk_orders_lineitem_1#2185, cpfk_supplier_lineitem#2153 AS cpfk_supplier_lineitem_1#2186, cfpk_lineitem_supplier#2154 AS cfpk_lineitem_supplier_1#2187, cfpk_lineitem_partsupp#2155 AS cfpk_lineitem_partsupp_1#2188, cpfk_part_lineitem#2156 AS cpfk_part_lineitem_1#2189, cfpk_lineitem_part#2157 AS cfpk_lineitem_part_1#2190, cpfk_partsupp_lineitem#2158 AS cpfk_partsupp_lineitem_1#2191, cfpk_lineitem_orders#2159 AS cfpk_lineitem_orders_1#2192, cval_lineitem_l_quantity#2160 AS cval_lineitem_l_quantity_1#2193, cval_lineitem_l_extendedprice#2161 AS cval_lineitem_l_extendedprice_1#2194, cval_lineitem_l_discount#2162 AS cval_lineitem_l_discount_1#2195, cval_lineitem_l_tax#2163 AS cval_lineitem_l_tax_1#2196, cval_lineitem_l_returnflag#2164 AS cval_lineitem_l_returnflag_1#2197, cval_lineitem_l_linestatus#2165 AS cval_lineitem_l_linestatus_1#2198, cval_lineitem_l_commitdate#2166 AS cval_lineitem_l_commitdate_1#2199, cval_lineitem_l_receiptdate#2167 AS cval_lineitem_l_receiptdate_1#2200, cval_lineitem_l_shipinstruct#2168 AS cval_lineitem_l_shipinstruct_1#2201, cval_lineitem_l_shipmode#2169 AS cval_lineitem_l_shipmode_1#2202, cval_lineitem_l_comment#2170 AS cval_lineitem_l_comment_1#2203, cval_lineitem_l_shipdate#2171 AS cval_lineitem_l_shipdate_1#2204, cl_quantity#2172 AS cl_quantity_1#2205, cl_extendedprice#2173 AS cl_extendedprice_1#2206, cl_discount#2174 AS cl_discount_1#2207, ... 9 more fields]
            :     :     :     +- Relation[rid#2151,cpfk_orders_lineitem#2152,cpfk_supplier_lineitem#2153,cfpk_lineitem_supplier#2154,cfpk_lineitem_partsupp#2155,cpfk_part_lineitem#2156,cfpk_lineitem_part#2157,cpfk_partsupp_lineitem#2158,cfpk_lineitem_orders#2159,cval_lineitem_l_quantity#2160,cval_lineitem_l_extendedprice#2161,cval_lineitem_l_discount#2162,cval_lineitem_l_tax#2163,cval_lineitem_l_returnflag#2164,cval_lineitem_l_linestatus#2165,cval_lineitem_l_commitdate#2166,cval_lineitem_l_receiptdate#2167,cval_lineitem_l_shipinstruct#2168,cval_lineitem_l_shipmode#2169,cval_lineitem_l_comment#2170,cval_lineitem_l_shipdate#2171,cl_quantity#2172,cl_extendedprice#2173,cl_discount#2174,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#2317 AS rid_2#2330, cpfk_nation_supplier#2318 AS cpfk_nation_supplier_2#2331, cfpk_supplier_nation#2319 AS cfpk_supplier_nation_2#2332, cval_supplier_s_name#2320 AS cval_supplier_s_name_2#2333, cval_supplier_s_address#2321 AS cval_supplier_s_address_2#2334, cval_supplier_s_phone#2322 AS cval_supplier_s_phone_2#2335, cval_supplier_s_acctbal#2323 AS cval_supplier_s_acctbal_2#2336, cval_supplier_s_comment#2324 AS cval_supplier_s_comment_2#2337, cs_name#2325 AS cs_name_2#2338, cs_address#2326 AS cs_address_2#2339, cs_phone#2327 AS cs_phone_2#2340, cs_acctbal#2328 AS cs_acctbal_2#2341, cs_comment#2329 AS cs_comment_2#2342]
            :     :        +- Relation[rid#2317,cpfk_nation_supplier#2318,cfpk_supplier_nation#2319,cval_supplier_s_name#2320,cval_supplier_s_address#2321,cval_supplier_s_phone#2322,cval_supplier_s_acctbal#2323,cval_supplier_s_comment#2324,cs_name#2325,cs_address#2326,cs_phone#2327,cs_acctbal#2328,cs_comment#2329] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#2343 AS rid_3#2350, cpfk_region_nation#2344 AS cpfk_region_nation_3#2351, cfpk_nation_region#2345 AS cfpk_nation_region_3#2352, cval_nation_n_name#2346 AS cval_nation_n_name_3#2353, cval_nation_n_comment#2347 AS cval_nation_n_comment_3#2354, cn_name#2348 AS cn_name_3#2355, cn_comment#2349 AS cn_comment_3#2356]
            :        +- Relation[rid#2343,cpfk_region_nation#2344,cfpk_nation_region#2345,cval_nation_n_name#2346,cval_nation_n_comment#2347,cn_name#2348,cn_comment#2349] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'Join UsingJoin(Inner,List(rid_6))
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#2357 AS rid_4#2362, cval_region_r_name#2358 AS cval_region_r_name_4#2363, cval_region_r_comment#2359 AS cval_region_r_comment_4#2364, cr_name#2360 AS cr_name_4#2365, cr_comment#2361 AS cr_comment_4#2366]
               :  :  :  :  :  :  :  +- Relation[rid#2357,cval_region_r_name#2358,cval_region_r_comment#2359,cr_name#2360,cr_comment#2361] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#2367 AS rid_4#2372, cval_region_r_name#2368 AS cval_region_r_name_4#2373, cval_region_r_comment#2369 AS cval_region_r_comment_4#2374, cr_name#2370 AS cr_name_4#2375, cr_comment#2371 AS cr_comment_4#2376]
               :  :  :  :  :  :        +- Relation[rid#2367,cval_region_r_name#2368,cval_region_r_comment#2369,cr_name#2370,cr_comment#2371] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :     :- Project [rid#2391 AS rid_4#2396, cval_region_r_name#2392 AS cval_region_r_name_4#2397, cval_region_r_comment#2393 AS cval_region_r_comment_4#2398, cr_name#2394 AS cr_name_4#2399, cr_comment#2395 AS cr_comment_4#2400]
               :  :  :  :  :     :  +- Relation[rid#2391,cval_region_r_name#2392,cval_region_r_comment#2393,cr_name#2394,cr_comment#2395] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :     +- Project [rid#2401 AS rid_5#2408, cpfk_region_nation#2402 AS cpfk_region_nation_5#2409, cfpk_nation_region#2403 AS cfpk_nation_region_5#2410, cval_nation_n_name#2404 AS cval_nation_n_name_5#2411, cval_nation_n_comment#2405 AS cval_nation_n_comment_5#2412, cn_name#2406 AS cn_name_5#2413, cn_comment#2407 AS cn_comment_5#2414]
               :  :  :  :  :        +- Relation[rid#2401,cpfk_region_nation#2402,cfpk_nation_region#2403,cval_nation_n_name#2404,cval_nation_n_comment#2405,cn_name#2406,cn_comment#2407] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#2377 AS rid_5#2384, cpfk_region_nation#2378 AS cpfk_region_nation_5#2385, cfpk_nation_region#2379 AS cfpk_nation_region_5#2386, cval_nation_n_name#2380 AS cval_nation_n_name_5#2387, cval_nation_n_comment#2381 AS cval_nation_n_comment_5#2388, cn_name#2382 AS cn_name_5#2389, cn_comment#2383 AS cn_comment_5#2390]
               :  :  :  :     +- Relation[rid#2377,cpfk_region_nation#2378,cfpk_nation_region#2379,cval_nation_n_name#2380,cval_nation_n_comment#2381,cn_name#2382,cn_comment#2383] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :     :- Project [rid#2445 AS rid_5#2452, cpfk_region_nation#2446 AS cpfk_region_nation_5#2453, cfpk_nation_region#2447 AS cfpk_nation_region_5#2454, cval_nation_n_name#2448 AS cval_nation_n_name_5#2455, cval_nation_n_comment#2449 AS cval_nation_n_comment_5#2456, cn_name#2450 AS cn_name_5#2457, cn_comment#2451 AS cn_comment_5#2458]
               :  :  :     :  +- Relation[rid#2445,cpfk_region_nation#2446,cfpk_nation_region#2447,cval_nation_n_name#2448,cval_nation_n_comment#2449,cn_name#2450,cn_comment#2451] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#2459 AS rid_6#2474, cpfk_nation_customer#2460 AS cpfk_nation_customer_6#2475, cfpk_customer_nation#2461 AS cfpk_customer_nation_6#2476, cval_customer_c_name#2462 AS cval_customer_c_name_6#2477, cval_customer_c_address#2463 AS cval_customer_c_address_6#2478, cval_customer_c_phone#2464 AS cval_customer_c_phone_6#2479, cval_customer_c_acctbal#2465 AS cval_customer_c_acctbal_6#2480, cval_customer_c_comment#2466 AS cval_customer_c_comment_6#2481, cval_customer_c_mktsegment#2467 AS cval_customer_c_mktsegment_6#2482, cc_name#2468 AS cc_name_6#2483, cc_address#2469 AS cc_address_6#2484, cc_phone#2470 AS cc_phone_6#2485, cc_acctbal#2471 AS cc_acctbal_6#2486, cc_comment#2472 AS cc_comment_6#2487, cc_mktsegment#2473 AS cc_mktsegment_6#2488]
               :  :  :        +- Relation[rid#2459,cpfk_nation_customer#2460,cfpk_customer_nation#2461,cval_customer_c_name#2462,cval_customer_c_address#2463,cval_customer_c_phone#2464,cval_customer_c_acctbal#2465,cval_customer_c_comment#2466,cval_customer_c_mktsegment#2467,cc_name#2468,cc_address#2469,cc_phone#2470,cc_acctbal#2471,cc_comment#2472,cc_mktsegment#2473] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#2415 AS rid_6#2430, cpfk_nation_customer#2416 AS cpfk_nation_customer_6#2431, cfpk_customer_nation#2417 AS cfpk_customer_nation_6#2432, cval_customer_c_name#2418 AS cval_customer_c_name_6#2433, cval_customer_c_address#2419 AS cval_customer_c_address_6#2434, cval_customer_c_phone#2420 AS cval_customer_c_phone_6#2435, cval_customer_c_acctbal#2421 AS cval_customer_c_acctbal_6#2436, cval_customer_c_comment#2422 AS cval_customer_c_comment_6#2437, cval_customer_c_mktsegment#2423 AS cval_customer_c_mktsegment_6#2438, cc_name#2424 AS cc_name_6#2439, cc_address#2425 AS cc_address_6#2440, cc_phone#2426 AS cc_phone_6#2441, cc_acctbal#2427 AS cc_acctbal_6#2442, cc_comment#2428 AS cc_comment_6#2443, cc_mktsegment#2429 AS cc_mktsegment_6#2444]
               :  :     +- Relation[rid#2415,cpfk_nation_customer#2416,cfpk_customer_nation#2417,cval_customer_c_name#2418,cval_customer_c_address#2419,cval_customer_c_phone#2420,cval_customer_c_acctbal#2421,cval_customer_c_comment#2422,cval_customer_c_mktsegment#2423,cc_name#2424,cc_address#2425,cc_phone#2426,cc_acctbal#2427,cc_comment#2428,cc_mktsegment#2429] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :     :- Project [rid#2523 AS rid_6#2538, cpfk_nation_customer#2524 AS cpfk_nation_customer_6#2539, cfpk_customer_nation#2525 AS cfpk_customer_nation_6#2540, cval_customer_c_name#2526 AS cval_customer_c_name_6#2541, cval_customer_c_address#2527 AS cval_customer_c_address_6#2542, cval_customer_c_phone#2528 AS cval_customer_c_phone_6#2543, cval_customer_c_acctbal#2529 AS cval_customer_c_acctbal_6#2544, cval_customer_c_comment#2530 AS cval_customer_c_comment_6#2545, cval_customer_c_mktsegment#2531 AS cval_customer_c_mktsegment_6#2546, cc_name#2532 AS cc_name_6#2547, cc_address#2533 AS cc_address_6#2548, cc_phone#2534 AS cc_phone_6#2549, cc_acctbal#2535 AS cc_acctbal_6#2550, cc_comment#2536 AS cc_comment_6#2551, cc_mktsegment#2537 AS cc_mktsegment_6#2552]
               :     :  +- Relation[rid#2523,cpfk_nation_customer#2524,cfpk_customer_nation#2525,cval_customer_c_name#2526,cval_customer_c_address#2527,cval_customer_c_phone#2528,cval_customer_c_acctbal#2529,cval_customer_c_comment#2530,cval_customer_c_mktsegment#2531,cc_name#2532,cc_address#2533,cc_phone#2534,cc_acctbal#2535,cc_comment#2536,cc_mktsegment#2537] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#2553 AS rid_7#2570, cpfk_customer_orders#2554 AS cpfk_customer_orders_7#2571, cfpk_orders_customer#2555 AS cfpk_orders_customer_7#2572, cval_orders_o_orderstatus#2556 AS cval_orders_o_orderstatus_7#2573, cval_orders_o_totalprice#2557 AS cval_orders_o_totalprice_7#2574, cval_orders_o_orderpriority#2558 AS cval_orders_o_orderpriority_7#2575, cval_orders_o_clerk#2559 AS cval_orders_o_clerk_7#2576, cval_orders_o_shippriority#2560 AS cval_orders_o_shippriority_7#2577, cval_orders_o_comment#2561 AS cval_orders_o_comment_7#2578, cval_orders_o_orderdate#2562 AS cval_orders_o_orderdate_7#2579, co_orderstatus#2563 AS co_orderstatus_7#2580, co_totalprice#2564 AS co_totalprice_7#2581, co_orderpriority#2565 AS co_orderpriority_7#2582, co_clerk#2566 AS co_clerk_7#2583, co_shippriority#2567 AS co_shippriority_7#2584, co_comment#2568 AS co_comment_7#2585, co_orderdate#2569 AS co_orderdate_7#2586]
               :        +- Relation[rid#2553,cpfk_customer_orders#2554,cfpk_orders_customer#2555,cval_orders_o_orderstatus#2556,cval_orders_o_totalprice#2557,cval_orders_o_orderpriority#2558,cval_orders_o_clerk#2559,cval_orders_o_shippriority#2560,cval_orders_o_comment#2561,cval_orders_o_orderdate#2562,co_orderstatus#2563,co_totalprice#2564,co_orderpriority#2565,co_clerk#2566,co_shippriority#2567,co_comment#2568,co_orderdate#2569] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#2489 AS rid_7#2506, cpfk_customer_orders#2490 AS cpfk_customer_orders_7#2507, cfpk_orders_customer#2491 AS cfpk_orders_customer_7#2508, cval_orders_o_orderstatus#2492 AS cval_orders_o_orderstatus_7#2509, cval_orders_o_totalprice#2493 AS cval_orders_o_totalprice_7#2510, cval_orders_o_orderpriority#2494 AS cval_orders_o_orderpriority_7#2511, cval_orders_o_clerk#2495 AS cval_orders_o_clerk_7#2512, cval_orders_o_shippriority#2496 AS cval_orders_o_shippriority_7#2513, cval_orders_o_comment#2497 AS cval_orders_o_comment_7#2514, cval_orders_o_orderdate#2498 AS cval_orders_o_orderdate_7#2515, co_orderstatus#2499 AS co_orderstatus_7#2516, co_totalprice#2500 AS co_totalprice_7#2517, co_orderpriority#2501 AS co_orderpriority_7#2518, co_clerk#2502 AS co_clerk_7#2519, co_shippriority#2503 AS co_shippriority_7#2520, co_comment#2504 AS co_comment_7#2521, co_orderdate#2505 AS co_orderdate_7#2522]
                  +- Relation[rid#2489,cpfk_customer_orders#2490,cfpk_orders_customer#2491,cval_orders_o_orderstatus#2492,cval_orders_o_totalprice#2493,cval_orders_o_orderpriority#2494,cval_orders_o_clerk#2495,cval_orders_o_shippriority#2496,cval_orders_o_comment#2497,cval_orders_o_orderdate#2498,co_orderstatus#2499,co_totalprice#2500,co_orderpriority#2501,co_clerk#2502,co_shippriority#2503,co_comment#2504,co_orderdate#2505] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 95889ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/11 06:18:05 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:18:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2705L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 06:18:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2705L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#2707 AS rid_0#2724, cpfk_customer_orders#2708 AS cpfk_customer_orders_0#2725, cfpk_orders_customer#2709 AS cfpk_orders_customer_0#2726, cval_orders_o_orderstatus#2710 AS cval_orders_o_orderstatus_0#2727, cval_orders_o_totalprice#2711 AS cval_orders_o_totalprice_0#2728, cval_orders_o_orderpriority#2712 AS cval_orders_o_orderpriority_0#2729, cval_orders_o_clerk#2713 AS cval_orders_o_clerk_0#2730, cval_orders_o_shippriority#2714 AS cval_orders_o_shippriority_0#2731, cval_orders_o_comment#2715 AS cval_orders_o_comment_0#2732, cval_orders_o_orderdate#2716 AS cval_orders_o_orderdate_0#2733, co_orderstatus#2717 AS co_orderstatus_0#2734, co_totalprice#2718 AS co_totalprice_0#2735, co_orderpriority#2719 AS co_orderpriority_0#2736, co_clerk#2720 AS co_clerk_0#2737, co_shippriority#2721 AS co_shippriority_0#2738, co_comment#2722 AS co_comment_0#2739, co_orderdate#2723 AS co_orderdate_0#2740]
            :  +- Relation[rid#2707,cpfk_customer_orders#2708,cfpk_orders_customer#2709,cval_orders_o_orderstatus#2710,cval_orders_o_totalprice#2711,cval_orders_o_orderpriority#2712,cval_orders_o_clerk#2713,cval_orders_o_shippriority#2714,cval_orders_o_comment#2715,cval_orders_o_orderdate#2716,co_orderstatus#2717,co_totalprice#2718,co_orderpriority#2719,co_clerk#2720,co_shippriority#2721,co_comment#2722,co_orderdate#2723] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#2741 AS rid_1#2756, cpfk_nation_customer#2742 AS cpfk_nation_customer_1#2757, cfpk_customer_nation#2743 AS cfpk_customer_nation_1#2758, cval_customer_c_name#2744 AS cval_customer_c_name_1#2759, cval_customer_c_address#2745 AS cval_customer_c_address_1#2760, cval_customer_c_phone#2746 AS cval_customer_c_phone_1#2761, cval_customer_c_acctbal#2747 AS cval_customer_c_acctbal_1#2762, cval_customer_c_comment#2748 AS cval_customer_c_comment_1#2763, cval_customer_c_mktsegment#2749 AS cval_customer_c_mktsegment_1#2764, cc_name#2750 AS cc_name_1#2765, cc_address#2751 AS cc_address_1#2766, cc_phone#2752 AS cc_phone_1#2767, cc_acctbal#2753 AS cc_acctbal_1#2768, cc_comment#2754 AS cc_comment_1#2769, cc_mktsegment#2755 AS cc_mktsegment_1#2770]
               +- Relation[rid#2741,cpfk_nation_customer#2742,cfpk_customer_nation#2743,cval_customer_c_name#2744,cval_customer_c_address#2745,cval_customer_c_phone#2746,cval_customer_c_acctbal#2747,cval_customer_c_comment#2748,cval_customer_c_mktsegment#2749,cc_name#2750,cc_address#2751,cc_phone#2752,cc_acctbal#2753,cc_comment#2754,cc_mktsegment#2755] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 12839ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/11 06:18:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:18:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2809L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 06:18:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:18:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:18:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:18:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:18:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:18:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:18:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:18:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:18:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:18:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:18:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:18:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:18:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:18:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2809L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#2811 AS rid_0#2818, cpfk_region_nation#2812 AS cpfk_region_nation_0#2819, cfpk_nation_region#2813 AS cfpk_nation_region_0#2820, cval_nation_n_name#2814 AS cval_nation_n_name_0#2821, cval_nation_n_comment#2815 AS cval_nation_n_comment_0#2822, cn_name#2816 AS cn_name_0#2823, cn_comment#2817 AS cn_comment_0#2824]
         :  :  :  :  :  +- Relation[rid#2811,cpfk_region_nation#2812,cfpk_nation_region#2813,cval_nation_n_name#2814,cval_nation_n_comment#2815,cn_name#2816,cn_comment#2817] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#2825 AS rid_0#2832, cpfk_region_nation#2826 AS cpfk_region_nation_0#2833, cfpk_nation_region#2827 AS cfpk_nation_region_0#2834, cval_nation_n_name#2828 AS cval_nation_n_name_0#2835, cval_nation_n_comment#2829 AS cval_nation_n_comment_0#2836, cn_name#2830 AS cn_name_0#2837, cn_comment#2831 AS cn_comment_0#2838]
         :  :  :  :        +- Relation[rid#2825,cpfk_region_nation#2826,cfpk_nation_region#2827,cval_nation_n_name#2828,cval_nation_n_comment#2829,cn_name#2830,cn_comment#2831] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :     :- Project [rid#2865 AS rid_0#2872, cpfk_region_nation#2866 AS cpfk_region_nation_0#2873, cfpk_nation_region#2867 AS cfpk_nation_region_0#2874, cval_nation_n_name#2868 AS cval_nation_n_name_0#2875, cval_nation_n_comment#2869 AS cval_nation_n_comment_0#2876, cn_name#2870 AS cn_name_0#2877, cn_comment#2871 AS cn_comment_0#2878]
         :  :  :     :  +- Relation[rid#2865,cpfk_region_nation#2866,cfpk_nation_region#2867,cval_nation_n_name#2868,cval_nation_n_comment#2869,cn_name#2870,cn_comment#2871] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#2879 AS rid_1#2892, cpfk_nation_supplier#2880 AS cpfk_nation_supplier_1#2893, cfpk_supplier_nation#2881 AS cfpk_supplier_nation_1#2894, cval_supplier_s_name#2882 AS cval_supplier_s_name_1#2895, cval_supplier_s_address#2883 AS cval_supplier_s_address_1#2896, cval_supplier_s_phone#2884 AS cval_supplier_s_phone_1#2897, cval_supplier_s_acctbal#2885 AS cval_supplier_s_acctbal_1#2898, cval_supplier_s_comment#2886 AS cval_supplier_s_comment_1#2899, cs_name#2887 AS cs_name_1#2900, cs_address#2888 AS cs_address_1#2901, cs_phone#2889 AS cs_phone_1#2902, cs_acctbal#2890 AS cs_acctbal_1#2903, cs_comment#2891 AS cs_comment_1#2904]
         :  :  :        +- Relation[rid#2879,cpfk_nation_supplier#2880,cfpk_supplier_nation#2881,cval_supplier_s_name#2882,cval_supplier_s_address#2883,cval_supplier_s_phone#2884,cval_supplier_s_acctbal#2885,cval_supplier_s_comment#2886,cs_name#2887,cs_address#2888,cs_phone#2889,cs_acctbal#2890,cs_comment#2891] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#2839 AS rid_1#2852, cpfk_nation_supplier#2840 AS cpfk_nation_supplier_1#2853, cfpk_supplier_nation#2841 AS cfpk_supplier_nation_1#2854, cval_supplier_s_name#2842 AS cval_supplier_s_name_1#2855, cval_supplier_s_address#2843 AS cval_supplier_s_address_1#2856, cval_supplier_s_phone#2844 AS cval_supplier_s_phone_1#2857, cval_supplier_s_acctbal#2845 AS cval_supplier_s_acctbal_1#2858, cval_supplier_s_comment#2846 AS cval_supplier_s_comment_1#2859, cs_name#2847 AS cs_name_1#2860, cs_address#2848 AS cs_address_1#2861, cs_phone#2849 AS cs_phone_1#2862, cs_acctbal#2850 AS cs_acctbal_1#2863, cs_comment#2851 AS cs_comment_1#2864]
         :  :     +- Relation[rid#2839,cpfk_nation_supplier#2840,cfpk_supplier_nation#2841,cval_supplier_s_name#2842,cval_supplier_s_address#2843,cval_supplier_s_phone#2844,cval_supplier_s_acctbal#2845,cval_supplier_s_comment#2846,cs_name#2847,cs_address#2848,cs_phone#2849,cs_acctbal#2850,cs_comment#2851] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :     :- Project [rid#2927 AS rid_1#2940, cpfk_nation_supplier#2928 AS cpfk_nation_supplier_1#2941, cfpk_supplier_nation#2929 AS cfpk_supplier_nation_1#2942, cval_supplier_s_name#2930 AS cval_supplier_s_name_1#2943, cval_supplier_s_address#2931 AS cval_supplier_s_address_1#2944, cval_supplier_s_phone#2932 AS cval_supplier_s_phone_1#2945, cval_supplier_s_acctbal#2933 AS cval_supplier_s_acctbal_1#2946, cval_supplier_s_comment#2934 AS cval_supplier_s_comment_1#2947, cs_name#2935 AS cs_name_1#2948, cs_address#2936 AS cs_address_1#2949, cs_phone#2937 AS cs_phone_1#2950, cs_acctbal#2938 AS cs_acctbal_1#2951, cs_comment#2939 AS cs_comment_1#2952]
         :     :  +- Relation[rid#2927,cpfk_nation_supplier#2928,cfpk_supplier_nation#2929,cval_supplier_s_name#2930,cval_supplier_s_address#2931,cval_supplier_s_phone#2932,cval_supplier_s_acctbal#2933,cval_supplier_s_comment#2934,cs_name#2935,cs_address#2936,cs_phone#2937,cs_acctbal#2938,cs_comment#2939] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#2953 AS rid_2#2964, cpfk_part_partsupp#2954 AS cpfk_part_partsupp_2#2965, cfpk_partsupp_part#2955 AS cfpk_partsupp_part_2#2966, cpfk_supplier_partsupp#2956 AS cpfk_supplier_partsupp_2#2967, cfpk_partsupp_supplier#2957 AS cfpk_partsupp_supplier_2#2968, cval_partsupp_ps_availqty#2958 AS cval_partsupp_ps_availqty_2#2969, cval_partsupp_ps_supplycost#2959 AS cval_partsupp_ps_supplycost_2#2970, cval_partsupp_ps_comment#2960 AS cval_partsupp_ps_comment_2#2971, cps_availqty#2961 AS cps_availqty_2#2972, cps_supplycost#2962 AS cps_supplycost_2#2973, cps_comment#2963 AS cps_comment_2#2974]
         :        +- Relation[rid#2953,cpfk_part_partsupp#2954,cfpk_partsupp_part#2955,cpfk_supplier_partsupp#2956,cfpk_partsupp_supplier#2957,cval_partsupp_ps_availqty#2958,cval_partsupp_ps_supplycost#2959,cval_partsupp_ps_comment#2960,cps_availqty#2961,cps_supplycost#2962,cps_comment#2963] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#2905 AS rid_2#2916, cpfk_part_partsupp#2906 AS cpfk_part_partsupp_2#2917, cfpk_partsupp_part#2907 AS cfpk_partsupp_part_2#2918, cpfk_supplier_partsupp#2908 AS cpfk_supplier_partsupp_2#2919, cfpk_partsupp_supplier#2909 AS cfpk_partsupp_supplier_2#2920, cval_partsupp_ps_availqty#2910 AS cval_partsupp_ps_availqty_2#2921, cval_partsupp_ps_supplycost#2911 AS cval_partsupp_ps_supplycost_2#2922, cval_partsupp_ps_comment#2912 AS cval_partsupp_ps_comment_2#2923, cps_availqty#2913 AS cps_availqty_2#2924, cps_supplycost#2914 AS cps_supplycost_2#2925, cps_comment#2915 AS cps_comment_2#2926]
            +- Relation[rid#2905,cpfk_part_partsupp#2906,cfpk_partsupp_part#2907,cpfk_supplier_partsupp#2908,cfpk_partsupp_supplier#2909,cval_partsupp_ps_availqty#2910,cval_partsupp_ps_supplycost#2911,cval_partsupp_ps_comment#2912,cps_availqty#2913,cps_supplycost#2914,cps_comment#2915] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 10334ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/11 06:18:29 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:18:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3015L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 06:18:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3015L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#3017 AS rid_0#3032, cpfk_nation_customer#3018 AS cpfk_nation_customer_0#3033, cfpk_customer_nation#3019 AS cfpk_customer_nation_0#3034, cval_customer_c_name#3020 AS cval_customer_c_name_0#3035, cval_customer_c_address#3021 AS cval_customer_c_address_0#3036, cval_customer_c_phone#3022 AS cval_customer_c_phone_0#3037, cval_customer_c_acctbal#3023 AS cval_customer_c_acctbal_0#3038, cval_customer_c_comment#3024 AS cval_customer_c_comment_0#3039, cval_customer_c_mktsegment#3025 AS cval_customer_c_mktsegment_0#3040, cc_name#3026 AS cc_name_0#3041, cc_address#3027 AS cc_address_0#3042, cc_phone#3028 AS cc_phone_0#3043, cc_acctbal#3029 AS cc_acctbal_0#3044, cc_comment#3030 AS cc_comment_0#3045, cc_mktsegment#3031 AS cc_mktsegment_0#3046]
         :  :  :  :  +- Relation[rid#3017,cpfk_nation_customer#3018,cfpk_customer_nation#3019,cval_customer_c_name#3020,cval_customer_c_address#3021,cval_customer_c_phone#3022,cval_customer_c_acctbal#3023,cval_customer_c_comment#3024,cval_customer_c_mktsegment#3025,cc_name#3026,cc_address#3027,cc_phone#3028,cc_acctbal#3029,cc_comment#3030,cc_mktsegment#3031] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#3081 AS rid_0#3096, cpfk_nation_customer#3082 AS cpfk_nation_customer_0#3097, cfpk_customer_nation#3083 AS cfpk_customer_nation_0#3098, cval_customer_c_name#3084 AS cval_customer_c_name_0#3099, cval_customer_c_address#3085 AS cval_customer_c_address_0#3100, cval_customer_c_phone#3086 AS cval_customer_c_phone_0#3101, cval_customer_c_acctbal#3087 AS cval_customer_c_acctbal_0#3102, cval_customer_c_comment#3088 AS cval_customer_c_comment_0#3103, cval_customer_c_mktsegment#3089 AS cval_customer_c_mktsegment_0#3104, cc_name#3090 AS cc_name_0#3105, cc_address#3091 AS cc_address_0#3106, cc_phone#3092 AS cc_phone_0#3107, cc_acctbal#3093 AS cc_acctbal_0#3108, cc_comment#3094 AS cc_comment_0#3109, cc_mktsegment#3095 AS cc_mktsegment_0#3110]
         :  :  :     :  +- Relation[rid#3081,cpfk_nation_customer#3082,cfpk_customer_nation#3083,cval_customer_c_name#3084,cval_customer_c_address#3085,cval_customer_c_phone#3086,cval_customer_c_acctbal#3087,cval_customer_c_comment#3088,cval_customer_c_mktsegment#3089,cc_name#3090,cc_address#3091,cc_phone#3092,cc_acctbal#3093,cc_comment#3094,cc_mktsegment#3095] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#3111 AS rid_1#3128, cpfk_customer_orders#3112 AS cpfk_customer_orders_1#3129, cfpk_orders_customer#3113 AS cfpk_orders_customer_1#3130, cval_orders_o_orderstatus#3114 AS cval_orders_o_orderstatus_1#3131, cval_orders_o_totalprice#3115 AS cval_orders_o_totalprice_1#3132, cval_orders_o_orderpriority#3116 AS cval_orders_o_orderpriority_1#3133, cval_orders_o_clerk#3117 AS cval_orders_o_clerk_1#3134, cval_orders_o_shippriority#3118 AS cval_orders_o_shippriority_1#3135, cval_orders_o_comment#3119 AS cval_orders_o_comment_1#3136, cval_orders_o_orderdate#3120 AS cval_orders_o_orderdate_1#3137, co_orderstatus#3121 AS co_orderstatus_1#3138, co_totalprice#3122 AS co_totalprice_1#3139, co_orderpriority#3123 AS co_orderpriority_1#3140, co_clerk#3124 AS co_clerk_1#3141, co_shippriority#3125 AS co_shippriority_1#3142, co_comment#3126 AS co_comment_1#3143, co_orderdate#3127 AS co_orderdate_1#3144]
         :  :  :        +- Relation[rid#3111,cpfk_customer_orders#3112,cfpk_orders_customer#3113,cval_orders_o_orderstatus#3114,cval_orders_o_totalprice#3115,cval_orders_o_orderpriority#3116,cval_orders_o_clerk#3117,cval_orders_o_shippriority#3118,cval_orders_o_comment#3119,cval_orders_o_orderdate#3120,co_orderstatus#3121,co_totalprice#3122,co_orderpriority#3123,co_clerk#3124,co_shippriority#3125,co_comment#3126,co_orderdate#3127] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#3047 AS rid_1#3064, cpfk_customer_orders#3048 AS cpfk_customer_orders_1#3065, cfpk_orders_customer#3049 AS cfpk_orders_customer_1#3066, cval_orders_o_orderstatus#3050 AS cval_orders_o_orderstatus_1#3067, cval_orders_o_totalprice#3051 AS cval_orders_o_totalprice_1#3068, cval_orders_o_orderpriority#3052 AS cval_orders_o_orderpriority_1#3069, cval_orders_o_clerk#3053 AS cval_orders_o_clerk_1#3070, cval_orders_o_shippriority#3054 AS cval_orders_o_shippriority_1#3071, cval_orders_o_comment#3055 AS cval_orders_o_comment_1#3072, cval_orders_o_orderdate#3056 AS cval_orders_o_orderdate_1#3073, co_orderstatus#3057 AS co_orderstatus_1#3074, co_totalprice#3058 AS co_totalprice_1#3075, co_orderpriority#3059 AS co_orderpriority_1#3076, co_clerk#3060 AS co_clerk_1#3077, co_shippriority#3061 AS co_shippriority_1#3078, co_comment#3062 AS co_comment_1#3079, co_orderdate#3063 AS co_orderdate_1#3080]
         :  :     +- Relation[rid#3047,cpfk_customer_orders#3048,cfpk_orders_customer#3049,cval_orders_o_orderstatus#3050,cval_orders_o_totalprice#3051,cval_orders_o_orderpriority#3052,cval_orders_o_clerk#3053,cval_orders_o_shippriority#3054,cval_orders_o_comment#3055,cval_orders_o_orderdate#3056,co_orderstatus#3057,co_totalprice#3058,co_orderpriority#3059,co_clerk#3060,co_shippriority#3061,co_comment#3062,co_orderdate#3063] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#3211 AS rid_1#3228, cpfk_customer_orders#3212 AS cpfk_customer_orders_1#3229, cfpk_orders_customer#3213 AS cfpk_orders_customer_1#3230, cval_orders_o_orderstatus#3214 AS cval_orders_o_orderstatus_1#3231, cval_orders_o_totalprice#3215 AS cval_orders_o_totalprice_1#3232, cval_orders_o_orderpriority#3216 AS cval_orders_o_orderpriority_1#3233, cval_orders_o_clerk#3217 AS cval_orders_o_clerk_1#3234, cval_orders_o_shippriority#3218 AS cval_orders_o_shippriority_1#3235, cval_orders_o_comment#3219 AS cval_orders_o_comment_1#3236, cval_orders_o_orderdate#3220 AS cval_orders_o_orderdate_1#3237, co_orderstatus#3221 AS co_orderstatus_1#3238, co_totalprice#3222 AS co_totalprice_1#3239, co_orderpriority#3223 AS co_orderpriority_1#3240, co_clerk#3224 AS co_clerk_1#3241, co_shippriority#3225 AS co_shippriority_1#3242, co_comment#3226 AS co_comment_1#3243, co_orderdate#3227 AS co_orderdate_1#3244]
         :     :  +- Relation[rid#3211,cpfk_customer_orders#3212,cfpk_orders_customer#3213,cval_orders_o_orderstatus#3214,cval_orders_o_totalprice#3215,cval_orders_o_orderpriority#3216,cval_orders_o_clerk#3217,cval_orders_o_shippriority#3218,cval_orders_o_comment#3219,cval_orders_o_orderdate#3220,co_orderstatus#3221,co_totalprice#3222,co_orderpriority#3223,co_clerk#3224,co_shippriority#3225,co_comment#3226,co_orderdate#3227] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#3245 AS rid_2#3278, cpfk_orders_lineitem#3246 AS cpfk_orders_lineitem_2#3279, cpfk_supplier_lineitem#3247 AS cpfk_supplier_lineitem_2#3280, cfpk_lineitem_supplier#3248 AS cfpk_lineitem_supplier_2#3281, cfpk_lineitem_partsupp#3249 AS cfpk_lineitem_partsupp_2#3282, cpfk_part_lineitem#3250 AS cpfk_part_lineitem_2#3283, cfpk_lineitem_part#3251 AS cfpk_lineitem_part_2#3284, cpfk_partsupp_lineitem#3252 AS cpfk_partsupp_lineitem_2#3285, cfpk_lineitem_orders#3253 AS cfpk_lineitem_orders_2#3286, cval_lineitem_l_quantity#3254 AS cval_lineitem_l_quantity_2#3287, cval_lineitem_l_extendedprice#3255 AS cval_lineitem_l_extendedprice_2#3288, cval_lineitem_l_discount#3256 AS cval_lineitem_l_discount_2#3289, cval_lineitem_l_tax#3257 AS cval_lineitem_l_tax_2#3290, cval_lineitem_l_returnflag#3258 AS cval_lineitem_l_returnflag_2#3291, cval_lineitem_l_linestatus#3259 AS cval_lineitem_l_linestatus_2#3292, cval_lineitem_l_commitdate#3260 AS cval_lineitem_l_commitdate_2#3293, cval_lineitem_l_receiptdate#3261 AS cval_lineitem_l_receiptdate_2#3294, cval_lineitem_l_shipinstruct#3262 AS cval_lineitem_l_shipinstruct_2#3295, cval_lineitem_l_shipmode#3263 AS cval_lineitem_l_shipmode_2#3296, cval_lineitem_l_comment#3264 AS cval_lineitem_l_comment_2#3297, cval_lineitem_l_shipdate#3265 AS cval_lineitem_l_shipdate_2#3298, cl_quantity#3266 AS cl_quantity_2#3299, cl_extendedprice#3267 AS cl_extendedprice_2#3300, cl_discount#3268 AS cl_discount_2#3301, ... 9 more fields]
         :        +- Relation[rid#3245,cpfk_orders_lineitem#3246,cpfk_supplier_lineitem#3247,cfpk_lineitem_supplier#3248,cfpk_lineitem_partsupp#3249,cpfk_part_lineitem#3250,cfpk_lineitem_part#3251,cpfk_partsupp_lineitem#3252,cfpk_lineitem_orders#3253,cval_lineitem_l_quantity#3254,cval_lineitem_l_extendedprice#3255,cval_lineitem_l_discount#3256,cval_lineitem_l_tax#3257,cval_lineitem_l_returnflag#3258,cval_lineitem_l_linestatus#3259,cval_lineitem_l_commitdate#3260,cval_lineitem_l_receiptdate#3261,cval_lineitem_l_shipinstruct#3262,cval_lineitem_l_shipmode#3263,cval_lineitem_l_comment#3264,cval_lineitem_l_shipdate#3265,cl_quantity#3266,cl_extendedprice#3267,cl_discount#3268,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#3145 AS rid_2#3178, cpfk_orders_lineitem#3146 AS cpfk_orders_lineitem_2#3179, cpfk_supplier_lineitem#3147 AS cpfk_supplier_lineitem_2#3180, cfpk_lineitem_supplier#3148 AS cfpk_lineitem_supplier_2#3181, cfpk_lineitem_partsupp#3149 AS cfpk_lineitem_partsupp_2#3182, cpfk_part_lineitem#3150 AS cpfk_part_lineitem_2#3183, cfpk_lineitem_part#3151 AS cfpk_lineitem_part_2#3184, cpfk_partsupp_lineitem#3152 AS cpfk_partsupp_lineitem_2#3185, cfpk_lineitem_orders#3153 AS cfpk_lineitem_orders_2#3186, cval_lineitem_l_quantity#3154 AS cval_lineitem_l_quantity_2#3187, cval_lineitem_l_extendedprice#3155 AS cval_lineitem_l_extendedprice_2#3188, cval_lineitem_l_discount#3156 AS cval_lineitem_l_discount_2#3189, cval_lineitem_l_tax#3157 AS cval_lineitem_l_tax_2#3190, cval_lineitem_l_returnflag#3158 AS cval_lineitem_l_returnflag_2#3191, cval_lineitem_l_linestatus#3159 AS cval_lineitem_l_linestatus_2#3192, cval_lineitem_l_commitdate#3160 AS cval_lineitem_l_commitdate_2#3193, cval_lineitem_l_receiptdate#3161 AS cval_lineitem_l_receiptdate_2#3194, cval_lineitem_l_shipinstruct#3162 AS cval_lineitem_l_shipinstruct_2#3195, cval_lineitem_l_shipmode#3163 AS cval_lineitem_l_shipmode_2#3196, cval_lineitem_l_comment#3164 AS cval_lineitem_l_comment_2#3197, cval_lineitem_l_shipdate#3165 AS cval_lineitem_l_shipdate_2#3198, cl_quantity#3166 AS cl_quantity_2#3199, cl_extendedprice#3167 AS cl_extendedprice_2#3200, cl_discount#3168 AS cl_discount_2#3201, ... 9 more fields]
            +- Relation[rid#3145,cpfk_orders_lineitem#3146,cpfk_supplier_lineitem#3147,cfpk_lineitem_supplier#3148,cfpk_lineitem_partsupp#3149,cpfk_part_lineitem#3150,cfpk_lineitem_part#3151,cpfk_partsupp_lineitem#3152,cfpk_lineitem_orders#3153,cval_lineitem_l_quantity#3154,cval_lineitem_l_extendedprice#3155,cval_lineitem_l_discount#3156,cval_lineitem_l_tax#3157,cval_lineitem_l_returnflag#3158,cval_lineitem_l_linestatus#3159,cval_lineitem_l_commitdate#3160,cval_lineitem_l_receiptdate#3161,cval_lineitem_l_shipinstruct#3162,cval_lineitem_l_shipmode#3163,cval_lineitem_l_comment#3164,cval_lineitem_l_shipdate#3165,cl_quantity#3166,cl_extendedprice#3167,cl_discount#3168,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 120103ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/11 06:20:29 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:20:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3384L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 06:20:29 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:20:29 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:20:29 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:20:29 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:20:29 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:20:29 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:20:29 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:20:29 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:20:29 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:20:29 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:20:29 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:20:29 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:20:29 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:20:29 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:20:29 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:20:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3384L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#3386 AS rid_0#3393, cpfk_region_nation#3387 AS cpfk_region_nation_0#3394, cfpk_nation_region#3388 AS cfpk_nation_region_0#3395, cval_nation_n_name#3389 AS cval_nation_n_name_0#3396, cval_nation_n_comment#3390 AS cval_nation_n_comment_0#3397, cn_name#3391 AS cn_name_0#3398, cn_comment#3392 AS cn_comment_0#3399]
            :  :  :  :  :  :  +- Relation[rid#3386,cpfk_region_nation#3387,cfpk_nation_region#3388,cval_nation_n_name#3389,cval_nation_n_comment#3390,cn_name#3391,cn_comment#3392] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#3400 AS rid_0#3407, cpfk_region_nation#3401 AS cpfk_region_nation_0#3408, cfpk_nation_region#3402 AS cfpk_nation_region_0#3409, cval_nation_n_name#3403 AS cval_nation_n_name_0#3410, cval_nation_n_comment#3404 AS cval_nation_n_comment_0#3411, cn_name#3405 AS cn_name_0#3412, cn_comment#3406 AS cn_comment_0#3413]
            :  :  :  :  :        +- Relation[rid#3400,cpfk_region_nation#3401,cfpk_nation_region#3402,cval_nation_n_name#3403,cval_nation_n_comment#3404,cn_name#3405,cn_comment#3406] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :     :- Project [rid#3440 AS rid_0#3447, cpfk_region_nation#3441 AS cpfk_region_nation_0#3448, cfpk_nation_region#3442 AS cfpk_nation_region_0#3449, cval_nation_n_name#3443 AS cval_nation_n_name_0#3450, cval_nation_n_comment#3444 AS cval_nation_n_comment_0#3451, cn_name#3445 AS cn_name_0#3452, cn_comment#3446 AS cn_comment_0#3453]
            :  :  :  :     :  +- Relation[rid#3440,cpfk_region_nation#3441,cfpk_nation_region#3442,cval_nation_n_name#3443,cval_nation_n_comment#3444,cn_name#3445,cn_comment#3446] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :     +- Project [rid#3454 AS rid_1#3467, cpfk_nation_supplier#3455 AS cpfk_nation_supplier_1#3468, cfpk_supplier_nation#3456 AS cfpk_supplier_nation_1#3469, cval_supplier_s_name#3457 AS cval_supplier_s_name_1#3470, cval_supplier_s_address#3458 AS cval_supplier_s_address_1#3471, cval_supplier_s_phone#3459 AS cval_supplier_s_phone_1#3472, cval_supplier_s_acctbal#3460 AS cval_supplier_s_acctbal_1#3473, cval_supplier_s_comment#3461 AS cval_supplier_s_comment_1#3474, cs_name#3462 AS cs_name_1#3475, cs_address#3463 AS cs_address_1#3476, cs_phone#3464 AS cs_phone_1#3477, cs_acctbal#3465 AS cs_acctbal_1#3478, cs_comment#3466 AS cs_comment_1#3479]
            :  :  :  :        +- Relation[rid#3454,cpfk_nation_supplier#3455,cfpk_supplier_nation#3456,cval_supplier_s_name#3457,cval_supplier_s_address#3458,cval_supplier_s_phone#3459,cval_supplier_s_acctbal#3460,cval_supplier_s_comment#3461,cs_name#3462,cs_address#3463,cs_phone#3464,cs_acctbal#3465,cs_comment#3466] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#3414 AS rid_1#3427, cpfk_nation_supplier#3415 AS cpfk_nation_supplier_1#3428, cfpk_supplier_nation#3416 AS cfpk_supplier_nation_1#3429, cval_supplier_s_name#3417 AS cval_supplier_s_name_1#3430, cval_supplier_s_address#3418 AS cval_supplier_s_address_1#3431, cval_supplier_s_phone#3419 AS cval_supplier_s_phone_1#3432, cval_supplier_s_acctbal#3420 AS cval_supplier_s_acctbal_1#3433, cval_supplier_s_comment#3421 AS cval_supplier_s_comment_1#3434, cs_name#3422 AS cs_name_1#3435, cs_address#3423 AS cs_address_1#3436, cs_phone#3424 AS cs_phone_1#3437, cs_acctbal#3425 AS cs_acctbal_1#3438, cs_comment#3426 AS cs_comment_1#3439]
            :  :  :     +- Relation[rid#3414,cpfk_nation_supplier#3415,cfpk_supplier_nation#3416,cval_supplier_s_name#3417,cval_supplier_s_address#3418,cval_supplier_s_phone#3419,cval_supplier_s_acctbal#3420,cval_supplier_s_comment#3421,cs_name#3422,cs_address#3423,cs_phone#3424,cs_acctbal#3425,cs_comment#3426] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :     :- Project [rid#3546 AS rid_1#3559, cpfk_nation_supplier#3547 AS cpfk_nation_supplier_1#3560, cfpk_supplier_nation#3548 AS cfpk_supplier_nation_1#3561, cval_supplier_s_name#3549 AS cval_supplier_s_name_1#3562, cval_supplier_s_address#3550 AS cval_supplier_s_address_1#3563, cval_supplier_s_phone#3551 AS cval_supplier_s_phone_1#3564, cval_supplier_s_acctbal#3552 AS cval_supplier_s_acctbal_1#3565, cval_supplier_s_comment#3553 AS cval_supplier_s_comment_1#3566, cs_name#3554 AS cs_name_1#3567, cs_address#3555 AS cs_address_1#3568, cs_phone#3556 AS cs_phone_1#3569, cs_acctbal#3557 AS cs_acctbal_1#3570, cs_comment#3558 AS cs_comment_1#3571]
            :  :     :  +- Relation[rid#3546,cpfk_nation_supplier#3547,cfpk_supplier_nation#3548,cval_supplier_s_name#3549,cval_supplier_s_address#3550,cval_supplier_s_phone#3551,cval_supplier_s_acctbal#3552,cval_supplier_s_comment#3553,cs_name#3554,cs_address#3555,cs_phone#3556,cs_acctbal#3557,cs_comment#3558] JDBCRelation(tsupplier) [numPartitions=1]
            :  :     +- Project [rid#3572 AS rid_2#3605, cpfk_orders_lineitem#3573 AS cpfk_orders_lineitem_2#3606, cpfk_supplier_lineitem#3574 AS cpfk_supplier_lineitem_2#3607, cfpk_lineitem_supplier#3575 AS cfpk_lineitem_supplier_2#3608, cfpk_lineitem_partsupp#3576 AS cfpk_lineitem_partsupp_2#3609, cpfk_part_lineitem#3577 AS cpfk_part_lineitem_2#3610, cfpk_lineitem_part#3578 AS cfpk_lineitem_part_2#3611, cpfk_partsupp_lineitem#3579 AS cpfk_partsupp_lineitem_2#3612, cfpk_lineitem_orders#3580 AS cfpk_lineitem_orders_2#3613, cval_lineitem_l_quantity#3581 AS cval_lineitem_l_quantity_2#3614, cval_lineitem_l_extendedprice#3582 AS cval_lineitem_l_extendedprice_2#3615, cval_lineitem_l_discount#3583 AS cval_lineitem_l_discount_2#3616, cval_lineitem_l_tax#3584 AS cval_lineitem_l_tax_2#3617, cval_lineitem_l_returnflag#3585 AS cval_lineitem_l_returnflag_2#3618, cval_lineitem_l_linestatus#3586 AS cval_lineitem_l_linestatus_2#3619, cval_lineitem_l_commitdate#3587 AS cval_lineitem_l_commitdate_2#3620, cval_lineitem_l_receiptdate#3588 AS cval_lineitem_l_receiptdate_2#3621, cval_lineitem_l_shipinstruct#3589 AS cval_lineitem_l_shipinstruct_2#3622, cval_lineitem_l_shipmode#3590 AS cval_lineitem_l_shipmode_2#3623, cval_lineitem_l_comment#3591 AS cval_lineitem_l_comment_2#3624, cval_lineitem_l_shipdate#3592 AS cval_lineitem_l_shipdate_2#3625, cl_quantity#3593 AS cl_quantity_2#3626, cl_extendedprice#3594 AS cl_extendedprice_2#3627, cl_discount#3595 AS cl_discount_2#3628, ... 9 more fields]
            :  :        +- Relation[rid#3572,cpfk_orders_lineitem#3573,cpfk_supplier_lineitem#3574,cfpk_lineitem_supplier#3575,cfpk_lineitem_partsupp#3576,cpfk_part_lineitem#3577,cfpk_lineitem_part#3578,cpfk_partsupp_lineitem#3579,cfpk_lineitem_orders#3580,cval_lineitem_l_quantity#3581,cval_lineitem_l_extendedprice#3582,cval_lineitem_l_discount#3583,cval_lineitem_l_tax#3584,cval_lineitem_l_returnflag#3585,cval_lineitem_l_linestatus#3586,cval_lineitem_l_commitdate#3587,cval_lineitem_l_receiptdate#3588,cval_lineitem_l_shipinstruct#3589,cval_lineitem_l_shipmode#3590,cval_lineitem_l_comment#3591,cval_lineitem_l_shipdate#3592,cl_quantity#3593,cl_extendedprice#3594,cl_discount#3595,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#3480 AS rid_2#3513, cpfk_orders_lineitem#3481 AS cpfk_orders_lineitem_2#3514, cpfk_supplier_lineitem#3482 AS cpfk_supplier_lineitem_2#3515, cfpk_lineitem_supplier#3483 AS cfpk_lineitem_supplier_2#3516, cfpk_lineitem_partsupp#3484 AS cfpk_lineitem_partsupp_2#3517, cpfk_part_lineitem#3485 AS cpfk_part_lineitem_2#3518, cfpk_lineitem_part#3486 AS cfpk_lineitem_part_2#3519, cpfk_partsupp_lineitem#3487 AS cpfk_partsupp_lineitem_2#3520, cfpk_lineitem_orders#3488 AS cfpk_lineitem_orders_2#3521, cval_lineitem_l_quantity#3489 AS cval_lineitem_l_quantity_2#3522, cval_lineitem_l_extendedprice#3490 AS cval_lineitem_l_extendedprice_2#3523, cval_lineitem_l_discount#3491 AS cval_lineitem_l_discount_2#3524, cval_lineitem_l_tax#3492 AS cval_lineitem_l_tax_2#3525, cval_lineitem_l_returnflag#3493 AS cval_lineitem_l_returnflag_2#3526, cval_lineitem_l_linestatus#3494 AS cval_lineitem_l_linestatus_2#3527, cval_lineitem_l_commitdate#3495 AS cval_lineitem_l_commitdate_2#3528, cval_lineitem_l_receiptdate#3496 AS cval_lineitem_l_receiptdate_2#3529, cval_lineitem_l_shipinstruct#3497 AS cval_lineitem_l_shipinstruct_2#3530, cval_lineitem_l_shipmode#3498 AS cval_lineitem_l_shipmode_2#3531, cval_lineitem_l_comment#3499 AS cval_lineitem_l_comment_2#3532, cval_lineitem_l_shipdate#3500 AS cval_lineitem_l_shipdate_2#3533, cl_quantity#3501 AS cl_quantity_2#3534, cl_extendedprice#3502 AS cl_extendedprice_2#3535, cl_discount#3503 AS cl_discount_2#3536, ... 9 more fields]
            :     +- Relation[rid#3480,cpfk_orders_lineitem#3481,cpfk_supplier_lineitem#3482,cfpk_lineitem_supplier#3483,cfpk_lineitem_partsupp#3484,cpfk_part_lineitem#3485,cfpk_lineitem_part#3486,cpfk_partsupp_lineitem#3487,cfpk_lineitem_orders#3488,cval_lineitem_l_quantity#3489,cval_lineitem_l_extendedprice#3490,cval_lineitem_l_discount#3491,cval_lineitem_l_tax#3492,cval_lineitem_l_returnflag#3493,cval_lineitem_l_linestatus#3494,cval_lineitem_l_commitdate#3495,cval_lineitem_l_receiptdate#3496,cval_lineitem_l_shipinstruct#3497,cval_lineitem_l_shipmode#3498,cval_lineitem_l_comment#3499,cval_lineitem_l_shipdate#3500,cl_quantity#3501,cl_extendedprice#3502,cl_discount#3503,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'Join UsingJoin(Inner,List(rid_4))
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'Join UsingJoin(Inner,List(rid_3))
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#3638 AS rid_3#3645, cpfk_region_nation#3639 AS cpfk_region_nation_3#3646, cfpk_nation_region#3640 AS cfpk_nation_region_3#3647, cval_nation_n_name#3641 AS cval_nation_n_name_3#3648, cval_nation_n_comment#3642 AS cval_nation_n_comment_3#3649, cn_name#3643 AS cn_name_3#3650, cn_comment#3644 AS cn_comment_3#3651]
               :  :  :  :  :  +- Relation[rid#3638,cpfk_region_nation#3639,cfpk_nation_region#3640,cval_nation_n_name#3641,cval_nation_n_comment#3642,cn_name#3643,cn_comment#3644] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#3652 AS rid_3#3659, cpfk_region_nation#3653 AS cpfk_region_nation_3#3660, cfpk_nation_region#3654 AS cfpk_nation_region_3#3661, cval_nation_n_name#3655 AS cval_nation_n_name_3#3662, cval_nation_n_comment#3656 AS cval_nation_n_comment_3#3663, cn_name#3657 AS cn_name_3#3664, cn_comment#3658 AS cn_comment_3#3665]
               :  :  :  :        +- Relation[rid#3652,cpfk_region_nation#3653,cfpk_nation_region#3654,cval_nation_n_name#3655,cval_nation_n_comment#3656,cn_name#3657,cn_comment#3658] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :     :- Project [rid#3696 AS rid_3#3703, cpfk_region_nation#3697 AS cpfk_region_nation_3#3704, cfpk_nation_region#3698 AS cfpk_nation_region_3#3705, cval_nation_n_name#3699 AS cval_nation_n_name_3#3706, cval_nation_n_comment#3700 AS cval_nation_n_comment_3#3707, cn_name#3701 AS cn_name_3#3708, cn_comment#3702 AS cn_comment_3#3709]
               :  :  :     :  +- Relation[rid#3696,cpfk_region_nation#3697,cfpk_nation_region#3698,cval_nation_n_name#3699,cval_nation_n_comment#3700,cn_name#3701,cn_comment#3702] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#3710 AS rid_4#3725, cpfk_nation_customer#3711 AS cpfk_nation_customer_4#3726, cfpk_customer_nation#3712 AS cfpk_customer_nation_4#3727, cval_customer_c_name#3713 AS cval_customer_c_name_4#3728, cval_customer_c_address#3714 AS cval_customer_c_address_4#3729, cval_customer_c_phone#3715 AS cval_customer_c_phone_4#3730, cval_customer_c_acctbal#3716 AS cval_customer_c_acctbal_4#3731, cval_customer_c_comment#3717 AS cval_customer_c_comment_4#3732, cval_customer_c_mktsegment#3718 AS cval_customer_c_mktsegment_4#3733, cc_name#3719 AS cc_name_4#3734, cc_address#3720 AS cc_address_4#3735, cc_phone#3721 AS cc_phone_4#3736, cc_acctbal#3722 AS cc_acctbal_4#3737, cc_comment#3723 AS cc_comment_4#3738, cc_mktsegment#3724 AS cc_mktsegment_4#3739]
               :  :  :        +- Relation[rid#3710,cpfk_nation_customer#3711,cfpk_customer_nation#3712,cval_customer_c_name#3713,cval_customer_c_address#3714,cval_customer_c_phone#3715,cval_customer_c_acctbal#3716,cval_customer_c_comment#3717,cval_customer_c_mktsegment#3718,cc_name#3719,cc_address#3720,cc_phone#3721,cc_acctbal#3722,cc_comment#3723,cc_mktsegment#3724] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#3666 AS rid_4#3681, cpfk_nation_customer#3667 AS cpfk_nation_customer_4#3682, cfpk_customer_nation#3668 AS cfpk_customer_nation_4#3683, cval_customer_c_name#3669 AS cval_customer_c_name_4#3684, cval_customer_c_address#3670 AS cval_customer_c_address_4#3685, cval_customer_c_phone#3671 AS cval_customer_c_phone_4#3686, cval_customer_c_acctbal#3672 AS cval_customer_c_acctbal_4#3687, cval_customer_c_comment#3673 AS cval_customer_c_comment_4#3688, cval_customer_c_mktsegment#3674 AS cval_customer_c_mktsegment_4#3689, cc_name#3675 AS cc_name_4#3690, cc_address#3676 AS cc_address_4#3691, cc_phone#3677 AS cc_phone_4#3692, cc_acctbal#3678 AS cc_acctbal_4#3693, cc_comment#3679 AS cc_comment_4#3694, cc_mktsegment#3680 AS cc_mktsegment_4#3695]
               :  :     +- Relation[rid#3666,cpfk_nation_customer#3667,cfpk_customer_nation#3668,cval_customer_c_name#3669,cval_customer_c_address#3670,cval_customer_c_phone#3671,cval_customer_c_acctbal#3672,cval_customer_c_comment#3673,cval_customer_c_mktsegment#3674,cc_name#3675,cc_address#3676,cc_phone#3677,cc_acctbal#3678,cc_comment#3679,cc_mktsegment#3680] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :     :- Project [rid#3774 AS rid_4#3789, cpfk_nation_customer#3775 AS cpfk_nation_customer_4#3790, cfpk_customer_nation#3776 AS cfpk_customer_nation_4#3791, cval_customer_c_name#3777 AS cval_customer_c_name_4#3792, cval_customer_c_address#3778 AS cval_customer_c_address_4#3793, cval_customer_c_phone#3779 AS cval_customer_c_phone_4#3794, cval_customer_c_acctbal#3780 AS cval_customer_c_acctbal_4#3795, cval_customer_c_comment#3781 AS cval_customer_c_comment_4#3796, cval_customer_c_mktsegment#3782 AS cval_customer_c_mktsegment_4#3797, cc_name#3783 AS cc_name_4#3798, cc_address#3784 AS cc_address_4#3799, cc_phone#3785 AS cc_phone_4#3800, cc_acctbal#3786 AS cc_acctbal_4#3801, cc_comment#3787 AS cc_comment_4#3802, cc_mktsegment#3788 AS cc_mktsegment_4#3803]
               :     :  +- Relation[rid#3774,cpfk_nation_customer#3775,cfpk_customer_nation#3776,cval_customer_c_name#3777,cval_customer_c_address#3778,cval_customer_c_phone#3779,cval_customer_c_acctbal#3780,cval_customer_c_comment#3781,cval_customer_c_mktsegment#3782,cc_name#3783,cc_address#3784,cc_phone#3785,cc_acctbal#3786,cc_comment#3787,cc_mktsegment#3788] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#3804 AS rid_5#3821, cpfk_customer_orders#3805 AS cpfk_customer_orders_5#3822, cfpk_orders_customer#3806 AS cfpk_orders_customer_5#3823, cval_orders_o_orderstatus#3807 AS cval_orders_o_orderstatus_5#3824, cval_orders_o_totalprice#3808 AS cval_orders_o_totalprice_5#3825, cval_orders_o_orderpriority#3809 AS cval_orders_o_orderpriority_5#3826, cval_orders_o_clerk#3810 AS cval_orders_o_clerk_5#3827, cval_orders_o_shippriority#3811 AS cval_orders_o_shippriority_5#3828, cval_orders_o_comment#3812 AS cval_orders_o_comment_5#3829, cval_orders_o_orderdate#3813 AS cval_orders_o_orderdate_5#3830, co_orderstatus#3814 AS co_orderstatus_5#3831, co_totalprice#3815 AS co_totalprice_5#3832, co_orderpriority#3816 AS co_orderpriority_5#3833, co_clerk#3817 AS co_clerk_5#3834, co_shippriority#3818 AS co_shippriority_5#3835, co_comment#3819 AS co_comment_5#3836, co_orderdate#3820 AS co_orderdate_5#3837]
               :        +- Relation[rid#3804,cpfk_customer_orders#3805,cfpk_orders_customer#3806,cval_orders_o_orderstatus#3807,cval_orders_o_totalprice#3808,cval_orders_o_orderpriority#3809,cval_orders_o_clerk#3810,cval_orders_o_shippriority#3811,cval_orders_o_comment#3812,cval_orders_o_orderdate#3813,co_orderstatus#3814,co_totalprice#3815,co_orderpriority#3816,co_clerk#3817,co_shippriority#3818,co_comment#3819,co_orderdate#3820] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#3740 AS rid_5#3757, cpfk_customer_orders#3741 AS cpfk_customer_orders_5#3758, cfpk_orders_customer#3742 AS cfpk_orders_customer_5#3759, cval_orders_o_orderstatus#3743 AS cval_orders_o_orderstatus_5#3760, cval_orders_o_totalprice#3744 AS cval_orders_o_totalprice_5#3761, cval_orders_o_orderpriority#3745 AS cval_orders_o_orderpriority_5#3762, cval_orders_o_clerk#3746 AS cval_orders_o_clerk_5#3763, cval_orders_o_shippriority#3747 AS cval_orders_o_shippriority_5#3764, cval_orders_o_comment#3748 AS cval_orders_o_comment_5#3765, cval_orders_o_orderdate#3749 AS cval_orders_o_orderdate_5#3766, co_orderstatus#3750 AS co_orderstatus_5#3767, co_totalprice#3751 AS co_totalprice_5#3768, co_orderpriority#3752 AS co_orderpriority_5#3769, co_clerk#3753 AS co_clerk_5#3770, co_shippriority#3754 AS co_shippriority_5#3771, co_comment#3755 AS co_comment_5#3772, co_orderdate#3756 AS co_orderdate_5#3773]
                  +- Relation[rid#3740,cpfk_customer_orders#3741,cfpk_orders_customer#3742,cval_orders_o_orderstatus#3743,cval_orders_o_totalprice#3744,cval_orders_o_orderpriority#3745,cval_orders_o_clerk#3746,cval_orders_o_shippriority#3747,cval_orders_o_comment#3748,cval_orders_o_orderdate#3749,co_orderstatus#3750,co_totalprice#3751,co_orderpriority#3752,co_clerk#3753,co_shippriority#3754,co_comment#3755,co_orderdate#3756] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 107618ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/11 06:22:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:22:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3935L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 06:22:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#3935L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#3937 AS rid_0#3970, cpfk_orders_lineitem#3938 AS cpfk_orders_lineitem_0#3971, cpfk_supplier_lineitem#3939 AS cpfk_supplier_lineitem_0#3972, cfpk_lineitem_supplier#3940 AS cfpk_lineitem_supplier_0#3973, cfpk_lineitem_partsupp#3941 AS cfpk_lineitem_partsupp_0#3974, cpfk_part_lineitem#3942 AS cpfk_part_lineitem_0#3975, cfpk_lineitem_part#3943 AS cfpk_lineitem_part_0#3976, cpfk_partsupp_lineitem#3944 AS cpfk_partsupp_lineitem_0#3977, cfpk_lineitem_orders#3945 AS cfpk_lineitem_orders_0#3978, cval_lineitem_l_quantity#3946 AS cval_lineitem_l_quantity_0#3979, cval_lineitem_l_extendedprice#3947 AS cval_lineitem_l_extendedprice_0#3980, cval_lineitem_l_discount#3948 AS cval_lineitem_l_discount_0#3981, cval_lineitem_l_tax#3949 AS cval_lineitem_l_tax_0#3982, cval_lineitem_l_returnflag#3950 AS cval_lineitem_l_returnflag_0#3983, cval_lineitem_l_linestatus#3951 AS cval_lineitem_l_linestatus_0#3984, cval_lineitem_l_commitdate#3952 AS cval_lineitem_l_commitdate_0#3985, cval_lineitem_l_receiptdate#3953 AS cval_lineitem_l_receiptdate_0#3986, cval_lineitem_l_shipinstruct#3954 AS cval_lineitem_l_shipinstruct_0#3987, cval_lineitem_l_shipmode#3955 AS cval_lineitem_l_shipmode_0#3988, cval_lineitem_l_comment#3956 AS cval_lineitem_l_comment_0#3989, cval_lineitem_l_shipdate#3957 AS cval_lineitem_l_shipdate_0#3990, cl_quantity#3958 AS cl_quantity_0#3991, cl_extendedprice#3959 AS cl_extendedprice_0#3992, cl_discount#3960 AS cl_discount_0#3993, ... 9 more fields]
         +- Relation[rid#3937,cpfk_orders_lineitem#3938,cpfk_supplier_lineitem#3939,cfpk_lineitem_supplier#3940,cfpk_lineitem_partsupp#3941,cpfk_part_lineitem#3942,cfpk_lineitem_part#3943,cpfk_partsupp_lineitem#3944,cfpk_lineitem_orders#3945,cval_lineitem_l_quantity#3946,cval_lineitem_l_extendedprice#3947,cval_lineitem_l_discount#3948,cval_lineitem_l_tax#3949,cval_lineitem_l_returnflag#3950,cval_lineitem_l_linestatus#3951,cval_lineitem_l_commitdate#3952,cval_lineitem_l_receiptdate#3953,cval_lineitem_l_shipinstruct#3954,cval_lineitem_l_shipmode#3955,cval_lineitem_l_comment#3956,cval_lineitem_l_shipdate#3957,cl_quantity#3958,cl_extendedprice#3959,cl_discount#3960,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 3021ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/11 06:22:19 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:22:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4042L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 06:22:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:22:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:22:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:22:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:22:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:22:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:22:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:22:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:22:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:22:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:22:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:22:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:22:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:22:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:22:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:22:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:22:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4042L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#4044 AS rid_0#4049, cval_region_r_name#4045 AS cval_region_r_name_0#4050, cval_region_r_comment#4046 AS cval_region_r_comment_0#4051, cr_name#4047 AS cr_name_0#4052, cr_comment#4048 AS cr_comment_0#4053]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#4044,cval_region_r_name#4045,cval_region_r_comment#4046,cr_name#4047,cr_comment#4048] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#4054 AS rid_0#4059, cval_region_r_name#4055 AS cval_region_r_name_0#4060, cval_region_r_comment#4056 AS cval_region_r_comment_0#4061, cr_name#4057 AS cr_name_0#4062, cr_comment#4058 AS cr_comment_0#4063]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#4054,cval_region_r_name#4055,cval_region_r_comment#4056,cr_name#4057,cr_comment#4058] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :     :- Project [rid#4078 AS rid_0#4083, cval_region_r_name#4079 AS cval_region_r_name_0#4084, cval_region_r_comment#4080 AS cval_region_r_comment_0#4085, cr_name#4081 AS cr_name_0#4086, cr_comment#4082 AS cr_comment_0#4087]
         :     :  :  :  :  :  :  :  :     :  +- Relation[rid#4078,cval_region_r_name#4079,cval_region_r_comment#4080,cr_name#4081,cr_comment#4082] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :     +- Project [rid#4088 AS rid_1#4095, cpfk_region_nation#4089 AS cpfk_region_nation_1#4096, cfpk_nation_region#4090 AS cfpk_nation_region_1#4097, cval_nation_n_name#4091 AS cval_nation_n_name_1#4098, cval_nation_n_comment#4092 AS cval_nation_n_comment_1#4099, cn_name#4093 AS cn_name_1#4100, cn_comment#4094 AS cn_comment_1#4101]
         :     :  :  :  :  :  :  :  :        +- Relation[rid#4088,cpfk_region_nation#4089,cfpk_nation_region#4090,cval_nation_n_name#4091,cval_nation_n_comment#4092,cn_name#4093,cn_comment#4094] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#4064 AS rid_1#4071, cpfk_region_nation#4065 AS cpfk_region_nation_1#4072, cfpk_nation_region#4066 AS cfpk_nation_region_1#4073, cval_nation_n_name#4067 AS cval_nation_n_name_1#4074, cval_nation_n_comment#4068 AS cval_nation_n_comment_1#4075, cn_name#4069 AS cn_name_1#4076, cn_comment#4070 AS cn_comment_1#4077]
         :     :  :  :  :  :  :  :     +- Relation[rid#4064,cpfk_region_nation#4065,cfpk_nation_region#4066,cval_nation_n_name#4067,cval_nation_n_comment#4068,cn_name#4069,cn_comment#4070] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :     :- Project [rid#4132 AS rid_1#4139, cpfk_region_nation#4133 AS cpfk_region_nation_1#4140, cfpk_nation_region#4134 AS cfpk_nation_region_1#4141, cval_nation_n_name#4135 AS cval_nation_n_name_1#4142, cval_nation_n_comment#4136 AS cval_nation_n_comment_1#4143, cn_name#4137 AS cn_name_1#4144, cn_comment#4138 AS cn_comment_1#4145]
         :     :  :  :  :  :  :     :  +- Relation[rid#4132,cpfk_region_nation#4133,cfpk_nation_region#4134,cval_nation_n_name#4135,cval_nation_n_comment#4136,cn_name#4137,cn_comment#4138] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :     +- Project [rid#4146 AS rid_2#4161, cpfk_nation_customer#4147 AS cpfk_nation_customer_2#4162, cfpk_customer_nation#4148 AS cfpk_customer_nation_2#4163, cval_customer_c_name#4149 AS cval_customer_c_name_2#4164, cval_customer_c_address#4150 AS cval_customer_c_address_2#4165, cval_customer_c_phone#4151 AS cval_customer_c_phone_2#4166, cval_customer_c_acctbal#4152 AS cval_customer_c_acctbal_2#4167, cval_customer_c_comment#4153 AS cval_customer_c_comment_2#4168, cval_customer_c_mktsegment#4154 AS cval_customer_c_mktsegment_2#4169, cc_name#4155 AS cc_name_2#4170, cc_address#4156 AS cc_address_2#4171, cc_phone#4157 AS cc_phone_2#4172, cc_acctbal#4158 AS cc_acctbal_2#4173, cc_comment#4159 AS cc_comment_2#4174, cc_mktsegment#4160 AS cc_mktsegment_2#4175]
         :     :  :  :  :  :  :        +- Relation[rid#4146,cpfk_nation_customer#4147,cfpk_customer_nation#4148,cval_customer_c_name#4149,cval_customer_c_address#4150,cval_customer_c_phone#4151,cval_customer_c_acctbal#4152,cval_customer_c_comment#4153,cval_customer_c_mktsegment#4154,cc_name#4155,cc_address#4156,cc_phone#4157,cc_acctbal#4158,cc_comment#4159,cc_mktsegment#4160] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#4102 AS rid_2#4117, cpfk_nation_customer#4103 AS cpfk_nation_customer_2#4118, cfpk_customer_nation#4104 AS cfpk_customer_nation_2#4119, cval_customer_c_name#4105 AS cval_customer_c_name_2#4120, cval_customer_c_address#4106 AS cval_customer_c_address_2#4121, cval_customer_c_phone#4107 AS cval_customer_c_phone_2#4122, cval_customer_c_acctbal#4108 AS cval_customer_c_acctbal_2#4123, cval_customer_c_comment#4109 AS cval_customer_c_comment_2#4124, cval_customer_c_mktsegment#4110 AS cval_customer_c_mktsegment_2#4125, cc_name#4111 AS cc_name_2#4126, cc_address#4112 AS cc_address_2#4127, cc_phone#4113 AS cc_phone_2#4128, cc_acctbal#4114 AS cc_acctbal_2#4129, cc_comment#4115 AS cc_comment_2#4130, cc_mktsegment#4116 AS cc_mktsegment_2#4131]
         :     :  :  :  :  :     +- Relation[rid#4102,cpfk_nation_customer#4103,cfpk_customer_nation#4104,cval_customer_c_name#4105,cval_customer_c_address#4106,cval_customer_c_phone#4107,cval_customer_c_acctbal#4108,cval_customer_c_comment#4109,cval_customer_c_mktsegment#4110,cc_name#4111,cc_address#4112,cc_phone#4113,cc_acctbal#4114,cc_comment#4115,cc_mktsegment#4116] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :     :- Project [rid#4210 AS rid_2#4225, cpfk_nation_customer#4211 AS cpfk_nation_customer_2#4226, cfpk_customer_nation#4212 AS cfpk_customer_nation_2#4227, cval_customer_c_name#4213 AS cval_customer_c_name_2#4228, cval_customer_c_address#4214 AS cval_customer_c_address_2#4229, cval_customer_c_phone#4215 AS cval_customer_c_phone_2#4230, cval_customer_c_acctbal#4216 AS cval_customer_c_acctbal_2#4231, cval_customer_c_comment#4217 AS cval_customer_c_comment_2#4232, cval_customer_c_mktsegment#4218 AS cval_customer_c_mktsegment_2#4233, cc_name#4219 AS cc_name_2#4234, cc_address#4220 AS cc_address_2#4235, cc_phone#4221 AS cc_phone_2#4236, cc_acctbal#4222 AS cc_acctbal_2#4237, cc_comment#4223 AS cc_comment_2#4238, cc_mktsegment#4224 AS cc_mktsegment_2#4239]
         :     :  :  :  :     :  +- Relation[rid#4210,cpfk_nation_customer#4211,cfpk_customer_nation#4212,cval_customer_c_name#4213,cval_customer_c_address#4214,cval_customer_c_phone#4215,cval_customer_c_acctbal#4216,cval_customer_c_comment#4217,cval_customer_c_mktsegment#4218,cc_name#4219,cc_address#4220,cc_phone#4221,cc_acctbal#4222,cc_comment#4223,cc_mktsegment#4224] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :     +- Project [rid#4240 AS rid_3#4257, cpfk_customer_orders#4241 AS cpfk_customer_orders_3#4258, cfpk_orders_customer#4242 AS cfpk_orders_customer_3#4259, cval_orders_o_orderstatus#4243 AS cval_orders_o_orderstatus_3#4260, cval_orders_o_totalprice#4244 AS cval_orders_o_totalprice_3#4261, cval_orders_o_orderpriority#4245 AS cval_orders_o_orderpriority_3#4262, cval_orders_o_clerk#4246 AS cval_orders_o_clerk_3#4263, cval_orders_o_shippriority#4247 AS cval_orders_o_shippriority_3#4264, cval_orders_o_comment#4248 AS cval_orders_o_comment_3#4265, cval_orders_o_orderdate#4249 AS cval_orders_o_orderdate_3#4266, co_orderstatus#4250 AS co_orderstatus_3#4267, co_totalprice#4251 AS co_totalprice_3#4268, co_orderpriority#4252 AS co_orderpriority_3#4269, co_clerk#4253 AS co_clerk_3#4270, co_shippriority#4254 AS co_shippriority_3#4271, co_comment#4255 AS co_comment_3#4272, co_orderdate#4256 AS co_orderdate_3#4273]
         :     :  :  :  :        +- Relation[rid#4240,cpfk_customer_orders#4241,cfpk_orders_customer#4242,cval_orders_o_orderstatus#4243,cval_orders_o_totalprice#4244,cval_orders_o_orderpriority#4245,cval_orders_o_clerk#4246,cval_orders_o_shippriority#4247,cval_orders_o_comment#4248,cval_orders_o_orderdate#4249,co_orderstatus#4250,co_totalprice#4251,co_orderpriority#4252,co_clerk#4253,co_shippriority#4254,co_comment#4255,co_orderdate#4256] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#4176 AS rid_3#4193, cpfk_customer_orders#4177 AS cpfk_customer_orders_3#4194, cfpk_orders_customer#4178 AS cfpk_orders_customer_3#4195, cval_orders_o_orderstatus#4179 AS cval_orders_o_orderstatus_3#4196, cval_orders_o_totalprice#4180 AS cval_orders_o_totalprice_3#4197, cval_orders_o_orderpriority#4181 AS cval_orders_o_orderpriority_3#4198, cval_orders_o_clerk#4182 AS cval_orders_o_clerk_3#4199, cval_orders_o_shippriority#4183 AS cval_orders_o_shippriority_3#4200, cval_orders_o_comment#4184 AS cval_orders_o_comment_3#4201, cval_orders_o_orderdate#4185 AS cval_orders_o_orderdate_3#4202, co_orderstatus#4186 AS co_orderstatus_3#4203, co_totalprice#4187 AS co_totalprice_3#4204, co_orderpriority#4188 AS co_orderpriority_3#4205, co_clerk#4189 AS co_clerk_3#4206, co_shippriority#4190 AS co_shippriority_3#4207, co_comment#4191 AS co_comment_3#4208, co_orderdate#4192 AS co_orderdate_3#4209]
         :     :  :  :     +- Relation[rid#4176,cpfk_customer_orders#4177,cfpk_orders_customer#4178,cval_orders_o_orderstatus#4179,cval_orders_o_totalprice#4180,cval_orders_o_orderpriority#4181,cval_orders_o_clerk#4182,cval_orders_o_shippriority#4183,cval_orders_o_comment#4184,cval_orders_o_orderdate#4185,co_orderstatus#4186,co_totalprice#4187,co_orderpriority#4188,co_clerk#4189,co_shippriority#4190,co_comment#4191,co_orderdate#4192] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :     :- Project [rid#4340 AS rid_3#4357, cpfk_customer_orders#4341 AS cpfk_customer_orders_3#4358, cfpk_orders_customer#4342 AS cfpk_orders_customer_3#4359, cval_orders_o_orderstatus#4343 AS cval_orders_o_orderstatus_3#4360, cval_orders_o_totalprice#4344 AS cval_orders_o_totalprice_3#4361, cval_orders_o_orderpriority#4345 AS cval_orders_o_orderpriority_3#4362, cval_orders_o_clerk#4346 AS cval_orders_o_clerk_3#4363, cval_orders_o_shippriority#4347 AS cval_orders_o_shippriority_3#4364, cval_orders_o_comment#4348 AS cval_orders_o_comment_3#4365, cval_orders_o_orderdate#4349 AS cval_orders_o_orderdate_3#4366, co_orderstatus#4350 AS co_orderstatus_3#4367, co_totalprice#4351 AS co_totalprice_3#4368, co_orderpriority#4352 AS co_orderpriority_3#4369, co_clerk#4353 AS co_clerk_3#4370, co_shippriority#4354 AS co_shippriority_3#4371, co_comment#4355 AS co_comment_3#4372, co_orderdate#4356 AS co_orderdate_3#4373]
         :     :  :     :  +- Relation[rid#4340,cpfk_customer_orders#4341,cfpk_orders_customer#4342,cval_orders_o_orderstatus#4343,cval_orders_o_totalprice#4344,cval_orders_o_orderpriority#4345,cval_orders_o_clerk#4346,cval_orders_o_shippriority#4347,cval_orders_o_comment#4348,cval_orders_o_orderdate#4349,co_orderstatus#4350,co_totalprice#4351,co_orderpriority#4352,co_clerk#4353,co_shippriority#4354,co_comment#4355,co_orderdate#4356] JDBCRelation(torders) [numPartitions=1]
         :     :  :     +- Project [rid#4374 AS rid_4#4407, cpfk_orders_lineitem#4375 AS cpfk_orders_lineitem_4#4408, cpfk_supplier_lineitem#4376 AS cpfk_supplier_lineitem_4#4409, cfpk_lineitem_supplier#4377 AS cfpk_lineitem_supplier_4#4410, cfpk_lineitem_partsupp#4378 AS cfpk_lineitem_partsupp_4#4411, cpfk_part_lineitem#4379 AS cpfk_part_lineitem_4#4412, cfpk_lineitem_part#4380 AS cfpk_lineitem_part_4#4413, cpfk_partsupp_lineitem#4381 AS cpfk_partsupp_lineitem_4#4414, cfpk_lineitem_orders#4382 AS cfpk_lineitem_orders_4#4415, cval_lineitem_l_quantity#4383 AS cval_lineitem_l_quantity_4#4416, cval_lineitem_l_extendedprice#4384 AS cval_lineitem_l_extendedprice_4#4417, cval_lineitem_l_discount#4385 AS cval_lineitem_l_discount_4#4418, cval_lineitem_l_tax#4386 AS cval_lineitem_l_tax_4#4419, cval_lineitem_l_returnflag#4387 AS cval_lineitem_l_returnflag_4#4420, cval_lineitem_l_linestatus#4388 AS cval_lineitem_l_linestatus_4#4421, cval_lineitem_l_commitdate#4389 AS cval_lineitem_l_commitdate_4#4422, cval_lineitem_l_receiptdate#4390 AS cval_lineitem_l_receiptdate_4#4423, cval_lineitem_l_shipinstruct#4391 AS cval_lineitem_l_shipinstruct_4#4424, cval_lineitem_l_shipmode#4392 AS cval_lineitem_l_shipmode_4#4425, cval_lineitem_l_comment#4393 AS cval_lineitem_l_comment_4#4426, cval_lineitem_l_shipdate#4394 AS cval_lineitem_l_shipdate_4#4427, cl_quantity#4395 AS cl_quantity_4#4428, cl_extendedprice#4396 AS cl_extendedprice_4#4429, cl_discount#4397 AS cl_discount_4#4430, ... 9 more fields]
         :     :  :        +- Relation[rid#4374,cpfk_orders_lineitem#4375,cpfk_supplier_lineitem#4376,cfpk_lineitem_supplier#4377,cfpk_lineitem_partsupp#4378,cpfk_part_lineitem#4379,cfpk_lineitem_part#4380,cpfk_partsupp_lineitem#4381,cfpk_lineitem_orders#4382,cval_lineitem_l_quantity#4383,cval_lineitem_l_extendedprice#4384,cval_lineitem_l_discount#4385,cval_lineitem_l_tax#4386,cval_lineitem_l_returnflag#4387,cval_lineitem_l_linestatus#4388,cval_lineitem_l_commitdate#4389,cval_lineitem_l_receiptdate#4390,cval_lineitem_l_shipinstruct#4391,cval_lineitem_l_shipmode#4392,cval_lineitem_l_comment#4393,cval_lineitem_l_shipdate#4394,cl_quantity#4395,cl_extendedprice#4396,cl_discount#4397,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#4274 AS rid_4#4307, cpfk_orders_lineitem#4275 AS cpfk_orders_lineitem_4#4308, cpfk_supplier_lineitem#4276 AS cpfk_supplier_lineitem_4#4309, cfpk_lineitem_supplier#4277 AS cfpk_lineitem_supplier_4#4310, cfpk_lineitem_partsupp#4278 AS cfpk_lineitem_partsupp_4#4311, cpfk_part_lineitem#4279 AS cpfk_part_lineitem_4#4312, cfpk_lineitem_part#4280 AS cfpk_lineitem_part_4#4313, cpfk_partsupp_lineitem#4281 AS cpfk_partsupp_lineitem_4#4314, cfpk_lineitem_orders#4282 AS cfpk_lineitem_orders_4#4315, cval_lineitem_l_quantity#4283 AS cval_lineitem_l_quantity_4#4316, cval_lineitem_l_extendedprice#4284 AS cval_lineitem_l_extendedprice_4#4317, cval_lineitem_l_discount#4285 AS cval_lineitem_l_discount_4#4318, cval_lineitem_l_tax#4286 AS cval_lineitem_l_tax_4#4319, cval_lineitem_l_returnflag#4287 AS cval_lineitem_l_returnflag_4#4320, cval_lineitem_l_linestatus#4288 AS cval_lineitem_l_linestatus_4#4321, cval_lineitem_l_commitdate#4289 AS cval_lineitem_l_commitdate_4#4322, cval_lineitem_l_receiptdate#4290 AS cval_lineitem_l_receiptdate_4#4323, cval_lineitem_l_shipinstruct#4291 AS cval_lineitem_l_shipinstruct_4#4324, cval_lineitem_l_shipmode#4292 AS cval_lineitem_l_shipmode_4#4325, cval_lineitem_l_comment#4293 AS cval_lineitem_l_comment_4#4326, cval_lineitem_l_shipdate#4294 AS cval_lineitem_l_shipdate_4#4327, cl_quantity#4295 AS cl_quantity_4#4328, cl_extendedprice#4296 AS cl_extendedprice_4#4329, cl_discount#4297 AS cl_discount_4#4330, ... 9 more fields]
         :     :     +- Relation[rid#4274,cpfk_orders_lineitem#4275,cpfk_supplier_lineitem#4276,cfpk_lineitem_supplier#4277,cfpk_lineitem_partsupp#4278,cpfk_part_lineitem#4279,cfpk_lineitem_part#4280,cpfk_partsupp_lineitem#4281,cfpk_lineitem_orders#4282,cval_lineitem_l_quantity#4283,cval_lineitem_l_extendedprice#4284,cval_lineitem_l_discount#4285,cval_lineitem_l_tax#4286,cval_lineitem_l_returnflag#4287,cval_lineitem_l_linestatus#4288,cval_lineitem_l_commitdate#4289,cval_lineitem_l_receiptdate#4290,cval_lineitem_l_shipinstruct#4291,cval_lineitem_l_shipmode#4292,cval_lineitem_l_comment#4293,cval_lineitem_l_shipdate#4294,cl_quantity#4295,cl_extendedprice#4296,cl_discount#4297,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#4440 AS rid_5#4453, cpfk_nation_supplier#4441 AS cpfk_nation_supplier_5#4454, cfpk_supplier_nation#4442 AS cfpk_supplier_nation_5#4455, cval_supplier_s_name#4443 AS cval_supplier_s_name_5#4456, cval_supplier_s_address#4444 AS cval_supplier_s_address_5#4457, cval_supplier_s_phone#4445 AS cval_supplier_s_phone_5#4458, cval_supplier_s_acctbal#4446 AS cval_supplier_s_acctbal_5#4459, cval_supplier_s_comment#4447 AS cval_supplier_s_comment_5#4460, cs_name#4448 AS cs_name_5#4461, cs_address#4449 AS cs_address_5#4462, cs_phone#4450 AS cs_phone_5#4463, cs_acctbal#4451 AS cs_acctbal_5#4464, cs_comment#4452 AS cs_comment_5#4465]
         :        +- Relation[rid#4440,cpfk_nation_supplier#4441,cfpk_supplier_nation#4442,cval_supplier_s_name#4443,cval_supplier_s_address#4444,cval_supplier_s_phone#4445,cval_supplier_s_acctbal#4446,cval_supplier_s_comment#4447,cs_name#4448,cs_address#4449,cs_phone#4450,cs_acctbal#4451,cs_comment#4452] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#4466 AS rid_1#4473, cpfk_region_nation#4467 AS cpfk_region_nation_1#4474, cfpk_nation_region#4468 AS cfpk_nation_region_1#4475, cval_nation_n_name#4469 AS cval_nation_n_name_1#4476, cval_nation_n_comment#4470 AS cval_nation_n_comment_1#4477, cn_name#4471 AS cn_name_1#4478, cn_comment#4472 AS cn_comment_1#4479]
            :  +- Relation[rid#4466,cpfk_region_nation#4467,cfpk_nation_region#4468,cval_nation_n_name#4469,cval_nation_n_comment#4470,cn_name#4471,cn_comment#4472] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#4480 AS rid_5#4493, cpfk_nation_supplier#4481 AS cpfk_nation_supplier_5#4494, cfpk_supplier_nation#4482 AS cfpk_supplier_nation_5#4495, cval_supplier_s_name#4483 AS cval_supplier_s_name_5#4496, cval_supplier_s_address#4484 AS cval_supplier_s_address_5#4497, cval_supplier_s_phone#4485 AS cval_supplier_s_phone_5#4498, cval_supplier_s_acctbal#4486 AS cval_supplier_s_acctbal_5#4499, cval_supplier_s_comment#4487 AS cval_supplier_s_comment_5#4500, cs_name#4488 AS cs_name_5#4501, cs_address#4489 AS cs_address_5#4502, cs_phone#4490 AS cs_phone_5#4503, cs_acctbal#4491 AS cs_acctbal_5#4504, cs_comment#4492 AS cs_comment_5#4505]
               +- Relation[rid#4480,cpfk_nation_supplier#4481,cfpk_supplier_nation#4482,cval_supplier_s_name#4483,cval_supplier_s_address#4484,cval_supplier_s_phone#4485,cval_supplier_s_acctbal#4486,cval_supplier_s_comment#4487,cs_name#4488,cs_address#4489,cs_phone#4490,cs_acctbal#4491,cs_comment#4492] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1206514
Elapsed time: 164570ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/11 06:25:04 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:25:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4600L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 06:25:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:25:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:25:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:25:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:25:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:25:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:25:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:25:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4600L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#4602 AS rid_0#4635, cpfk_orders_lineitem#4603 AS cpfk_orders_lineitem_0#4636, cpfk_supplier_lineitem#4604 AS cpfk_supplier_lineitem_0#4637, cfpk_lineitem_supplier#4605 AS cfpk_lineitem_supplier_0#4638, cfpk_lineitem_partsupp#4606 AS cfpk_lineitem_partsupp_0#4639, cpfk_part_lineitem#4607 AS cpfk_part_lineitem_0#4640, cfpk_lineitem_part#4608 AS cfpk_lineitem_part_0#4641, cpfk_partsupp_lineitem#4609 AS cpfk_partsupp_lineitem_0#4642, cfpk_lineitem_orders#4610 AS cfpk_lineitem_orders_0#4643, cval_lineitem_l_quantity#4611 AS cval_lineitem_l_quantity_0#4644, cval_lineitem_l_extendedprice#4612 AS cval_lineitem_l_extendedprice_0#4645, cval_lineitem_l_discount#4613 AS cval_lineitem_l_discount_0#4646, cval_lineitem_l_tax#4614 AS cval_lineitem_l_tax_0#4647, cval_lineitem_l_returnflag#4615 AS cval_lineitem_l_returnflag_0#4648, cval_lineitem_l_linestatus#4616 AS cval_lineitem_l_linestatus_0#4649, cval_lineitem_l_commitdate#4617 AS cval_lineitem_l_commitdate_0#4650, cval_lineitem_l_receiptdate#4618 AS cval_lineitem_l_receiptdate_0#4651, cval_lineitem_l_shipinstruct#4619 AS cval_lineitem_l_shipinstruct_0#4652, cval_lineitem_l_shipmode#4620 AS cval_lineitem_l_shipmode_0#4653, cval_lineitem_l_comment#4621 AS cval_lineitem_l_comment_0#4654, cval_lineitem_l_shipdate#4622 AS cval_lineitem_l_shipdate_0#4655, cl_quantity#4623 AS cl_quantity_0#4656, cl_extendedprice#4624 AS cl_extendedprice_0#4657, cl_discount#4625 AS cl_discount_0#4658, ... 9 more fields]
            :  +- Relation[rid#4602,cpfk_orders_lineitem#4603,cpfk_supplier_lineitem#4604,cfpk_lineitem_supplier#4605,cfpk_lineitem_partsupp#4606,cpfk_part_lineitem#4607,cfpk_lineitem_part#4608,cpfk_partsupp_lineitem#4609,cfpk_lineitem_orders#4610,cval_lineitem_l_quantity#4611,cval_lineitem_l_extendedprice#4612,cval_lineitem_l_discount#4613,cval_lineitem_l_tax#4614,cval_lineitem_l_returnflag#4615,cval_lineitem_l_linestatus#4616,cval_lineitem_l_commitdate#4617,cval_lineitem_l_receiptdate#4618,cval_lineitem_l_shipinstruct#4619,cval_lineitem_l_shipmode#4620,cval_lineitem_l_comment#4621,cval_lineitem_l_shipdate#4622,cl_quantity#4623,cl_extendedprice#4624,cl_discount#4625,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#4668 AS rid_1#4685, cpfk_customer_orders#4669 AS cpfk_customer_orders_1#4686, cfpk_orders_customer#4670 AS cfpk_orders_customer_1#4687, cval_orders_o_orderstatus#4671 AS cval_orders_o_orderstatus_1#4688, cval_orders_o_totalprice#4672 AS cval_orders_o_totalprice_1#4689, cval_orders_o_orderpriority#4673 AS cval_orders_o_orderpriority_1#4690, cval_orders_o_clerk#4674 AS cval_orders_o_clerk_1#4691, cval_orders_o_shippriority#4675 AS cval_orders_o_shippriority_1#4692, cval_orders_o_comment#4676 AS cval_orders_o_comment_1#4693, cval_orders_o_orderdate#4677 AS cval_orders_o_orderdate_1#4694, co_orderstatus#4678 AS co_orderstatus_1#4695, co_totalprice#4679 AS co_totalprice_1#4696, co_orderpriority#4680 AS co_orderpriority_1#4697, co_clerk#4681 AS co_clerk_1#4698, co_shippriority#4682 AS co_shippriority_1#4699, co_comment#4683 AS co_comment_1#4700, co_orderdate#4684 AS co_orderdate_1#4701]
                  :     :  :  :  :  +- Relation[rid#4668,cpfk_customer_orders#4669,cfpk_orders_customer#4670,cval_orders_o_orderstatus#4671,cval_orders_o_totalprice#4672,cval_orders_o_orderpriority#4673,cval_orders_o_clerk#4674,cval_orders_o_shippriority#4675,cval_orders_o_comment#4676,cval_orders_o_orderdate#4677,co_orderstatus#4678,co_totalprice#4679,co_orderpriority#4680,co_clerk#4681,co_shippriority#4682,co_comment#4683,co_orderdate#4684] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#4702 AS rid_1#4719, cpfk_customer_orders#4703 AS cpfk_customer_orders_1#4720, cfpk_orders_customer#4704 AS cfpk_orders_customer_1#4721, cval_orders_o_orderstatus#4705 AS cval_orders_o_orderstatus_1#4722, cval_orders_o_totalprice#4706 AS cval_orders_o_totalprice_1#4723, cval_orders_o_orderpriority#4707 AS cval_orders_o_orderpriority_1#4724, cval_orders_o_clerk#4708 AS cval_orders_o_clerk_1#4725, cval_orders_o_shippriority#4709 AS cval_orders_o_shippriority_1#4726, cval_orders_o_comment#4710 AS cval_orders_o_comment_1#4727, cval_orders_o_orderdate#4711 AS cval_orders_o_orderdate_1#4728, co_orderstatus#4712 AS co_orderstatus_1#4729, co_totalprice#4713 AS co_totalprice_1#4730, co_orderpriority#4714 AS co_orderpriority_1#4731, co_clerk#4715 AS co_clerk_1#4732, co_shippriority#4716 AS co_shippriority_1#4733, co_comment#4717 AS co_comment_1#4734, co_orderdate#4718 AS co_orderdate_1#4735]
                  :     :  :  :        +- Relation[rid#4702,cpfk_customer_orders#4703,cfpk_orders_customer#4704,cval_orders_o_orderstatus#4705,cval_orders_o_totalprice#4706,cval_orders_o_orderpriority#4707,cval_orders_o_clerk#4708,cval_orders_o_shippriority#4709,cval_orders_o_comment#4710,cval_orders_o_orderdate#4711,co_orderstatus#4712,co_totalprice#4713,co_orderpriority#4714,co_clerk#4715,co_shippriority#4716,co_comment#4717,co_orderdate#4718] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :     :- Project [rid#4802 AS rid_1#4819, cpfk_customer_orders#4803 AS cpfk_customer_orders_1#4820, cfpk_orders_customer#4804 AS cfpk_orders_customer_1#4821, cval_orders_o_orderstatus#4805 AS cval_orders_o_orderstatus_1#4822, cval_orders_o_totalprice#4806 AS cval_orders_o_totalprice_1#4823, cval_orders_o_orderpriority#4807 AS cval_orders_o_orderpriority_1#4824, cval_orders_o_clerk#4808 AS cval_orders_o_clerk_1#4825, cval_orders_o_shippriority#4809 AS cval_orders_o_shippriority_1#4826, cval_orders_o_comment#4810 AS cval_orders_o_comment_1#4827, cval_orders_o_orderdate#4811 AS cval_orders_o_orderdate_1#4828, co_orderstatus#4812 AS co_orderstatus_1#4829, co_totalprice#4813 AS co_totalprice_1#4830, co_orderpriority#4814 AS co_orderpriority_1#4831, co_clerk#4815 AS co_clerk_1#4832, co_shippriority#4816 AS co_shippriority_1#4833, co_comment#4817 AS co_comment_1#4834, co_orderdate#4818 AS co_orderdate_1#4835]
                  :     :  :     :  +- Relation[rid#4802,cpfk_customer_orders#4803,cfpk_orders_customer#4804,cval_orders_o_orderstatus#4805,cval_orders_o_totalprice#4806,cval_orders_o_orderpriority#4807,cval_orders_o_clerk#4808,cval_orders_o_shippriority#4809,cval_orders_o_comment#4810,cval_orders_o_orderdate#4811,co_orderstatus#4812,co_totalprice#4813,co_orderpriority#4814,co_clerk#4815,co_shippriority#4816,co_comment#4817,co_orderdate#4818] JDBCRelation(torders) [numPartitions=1]
                  :     :  :     +- Project [rid#4836 AS rid_2#4869, cpfk_orders_lineitem#4837 AS cpfk_orders_lineitem_2#4870, cpfk_supplier_lineitem#4838 AS cpfk_supplier_lineitem_2#4871, cfpk_lineitem_supplier#4839 AS cfpk_lineitem_supplier_2#4872, cfpk_lineitem_partsupp#4840 AS cfpk_lineitem_partsupp_2#4873, cpfk_part_lineitem#4841 AS cpfk_part_lineitem_2#4874, cfpk_lineitem_part#4842 AS cfpk_lineitem_part_2#4875, cpfk_partsupp_lineitem#4843 AS cpfk_partsupp_lineitem_2#4876, cfpk_lineitem_orders#4844 AS cfpk_lineitem_orders_2#4877, cval_lineitem_l_quantity#4845 AS cval_lineitem_l_quantity_2#4878, cval_lineitem_l_extendedprice#4846 AS cval_lineitem_l_extendedprice_2#4879, cval_lineitem_l_discount#4847 AS cval_lineitem_l_discount_2#4880, cval_lineitem_l_tax#4848 AS cval_lineitem_l_tax_2#4881, cval_lineitem_l_returnflag#4849 AS cval_lineitem_l_returnflag_2#4882, cval_lineitem_l_linestatus#4850 AS cval_lineitem_l_linestatus_2#4883, cval_lineitem_l_commitdate#4851 AS cval_lineitem_l_commitdate_2#4884, cval_lineitem_l_receiptdate#4852 AS cval_lineitem_l_receiptdate_2#4885, cval_lineitem_l_shipinstruct#4853 AS cval_lineitem_l_shipinstruct_2#4886, cval_lineitem_l_shipmode#4854 AS cval_lineitem_l_shipmode_2#4887, cval_lineitem_l_comment#4855 AS cval_lineitem_l_comment_2#4888, cval_lineitem_l_shipdate#4856 AS cval_lineitem_l_shipdate_2#4889, cl_quantity#4857 AS cl_quantity_2#4890, cl_extendedprice#4858 AS cl_extendedprice_2#4891, cl_discount#4859 AS cl_discount_2#4892, ... 9 more fields]
                  :     :  :        +- Relation[rid#4836,cpfk_orders_lineitem#4837,cpfk_supplier_lineitem#4838,cfpk_lineitem_supplier#4839,cfpk_lineitem_partsupp#4840,cpfk_part_lineitem#4841,cfpk_lineitem_part#4842,cpfk_partsupp_lineitem#4843,cfpk_lineitem_orders#4844,cval_lineitem_l_quantity#4845,cval_lineitem_l_extendedprice#4846,cval_lineitem_l_discount#4847,cval_lineitem_l_tax#4848,cval_lineitem_l_returnflag#4849,cval_lineitem_l_linestatus#4850,cval_lineitem_l_commitdate#4851,cval_lineitem_l_receiptdate#4852,cval_lineitem_l_shipinstruct#4853,cval_lineitem_l_shipmode#4854,cval_lineitem_l_comment#4855,cval_lineitem_l_shipdate#4856,cl_quantity#4857,cl_extendedprice#4858,cl_discount#4859,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#4736 AS rid_2#4769, cpfk_orders_lineitem#4737 AS cpfk_orders_lineitem_2#4770, cpfk_supplier_lineitem#4738 AS cpfk_supplier_lineitem_2#4771, cfpk_lineitem_supplier#4739 AS cfpk_lineitem_supplier_2#4772, cfpk_lineitem_partsupp#4740 AS cfpk_lineitem_partsupp_2#4773, cpfk_part_lineitem#4741 AS cpfk_part_lineitem_2#4774, cfpk_lineitem_part#4742 AS cfpk_lineitem_part_2#4775, cpfk_partsupp_lineitem#4743 AS cpfk_partsupp_lineitem_2#4776, cfpk_lineitem_orders#4744 AS cfpk_lineitem_orders_2#4777, cval_lineitem_l_quantity#4745 AS cval_lineitem_l_quantity_2#4778, cval_lineitem_l_extendedprice#4746 AS cval_lineitem_l_extendedprice_2#4779, cval_lineitem_l_discount#4747 AS cval_lineitem_l_discount_2#4780, cval_lineitem_l_tax#4748 AS cval_lineitem_l_tax_2#4781, cval_lineitem_l_returnflag#4749 AS cval_lineitem_l_returnflag_2#4782, cval_lineitem_l_linestatus#4750 AS cval_lineitem_l_linestatus_2#4783, cval_lineitem_l_commitdate#4751 AS cval_lineitem_l_commitdate_2#4784, cval_lineitem_l_receiptdate#4752 AS cval_lineitem_l_receiptdate_2#4785, cval_lineitem_l_shipinstruct#4753 AS cval_lineitem_l_shipinstruct_2#4786, cval_lineitem_l_shipmode#4754 AS cval_lineitem_l_shipmode_2#4787, cval_lineitem_l_comment#4755 AS cval_lineitem_l_comment_2#4788, cval_lineitem_l_shipdate#4756 AS cval_lineitem_l_shipdate_2#4789, cl_quantity#4757 AS cl_quantity_2#4790, cl_extendedprice#4758 AS cl_extendedprice_2#4791, cl_discount#4759 AS cl_discount_2#4792, ... 9 more fields]
                  :     :     +- Relation[rid#4736,cpfk_orders_lineitem#4737,cpfk_supplier_lineitem#4738,cfpk_lineitem_supplier#4739,cfpk_lineitem_partsupp#4740,cpfk_part_lineitem#4741,cfpk_lineitem_part#4742,cpfk_partsupp_lineitem#4743,cfpk_lineitem_orders#4744,cval_lineitem_l_quantity#4745,cval_lineitem_l_extendedprice#4746,cval_lineitem_l_discount#4747,cval_lineitem_l_tax#4748,cval_lineitem_l_returnflag#4749,cval_lineitem_l_linestatus#4750,cval_lineitem_l_commitdate#4751,cval_lineitem_l_receiptdate#4752,cval_lineitem_l_shipinstruct#4753,cval_lineitem_l_shipmode#4754,cval_lineitem_l_comment#4755,cval_lineitem_l_shipdate#4756,cl_quantity#4757,cl_extendedprice#4758,cl_discount#4759,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#4902 AS rid_3#4915, cpfk_nation_supplier#4903 AS cpfk_nation_supplier_3#4916, cfpk_supplier_nation#4904 AS cfpk_supplier_nation_3#4917, cval_supplier_s_name#4905 AS cval_supplier_s_name_3#4918, cval_supplier_s_address#4906 AS cval_supplier_s_address_3#4919, cval_supplier_s_phone#4907 AS cval_supplier_s_phone_3#4920, cval_supplier_s_acctbal#4908 AS cval_supplier_s_acctbal_3#4921, cval_supplier_s_comment#4909 AS cval_supplier_s_comment_3#4922, cs_name#4910 AS cs_name_3#4923, cs_address#4911 AS cs_address_3#4924, cs_phone#4912 AS cs_phone_3#4925, cs_acctbal#4913 AS cs_acctbal_3#4926, cs_comment#4914 AS cs_comment_3#4927]
                  :        +- Relation[rid#4902,cpfk_nation_supplier#4903,cfpk_supplier_nation#4904,cval_supplier_s_name#4905,cval_supplier_s_address#4906,cval_supplier_s_phone#4907,cval_supplier_s_acctbal#4908,cval_supplier_s_comment#4909,cs_name#4910,cs_address#4911,cs_phone#4912,cs_acctbal#4913,cs_comment#4914] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#4928 AS rid_4#4935, cpfk_region_nation#4929 AS cpfk_region_nation_4#4936, cfpk_nation_region#4930 AS cfpk_nation_region_4#4937, cval_nation_n_name#4931 AS cval_nation_n_name_4#4938, cval_nation_n_comment#4932 AS cval_nation_n_comment_4#4939, cn_name#4933 AS cn_name_4#4940, cn_comment#4934 AS cn_comment_4#4941]
                     :  +- Relation[rid#4928,cpfk_region_nation#4929,cfpk_nation_region#4930,cval_nation_n_name#4931,cval_nation_n_comment#4932,cn_name#4933,cn_comment#4934] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#4942 AS rid_4#4949, cpfk_region_nation#4943 AS cpfk_region_nation_4#4950, cfpk_nation_region#4944 AS cfpk_nation_region_4#4951, cval_nation_n_name#4945 AS cval_nation_n_name_4#4952, cval_nation_n_comment#4946 AS cval_nation_n_comment_4#4953, cn_name#4947 AS cn_name_4#4954, cn_comment#4948 AS cn_comment_4#4955]
                           +- Relation[rid#4942,cpfk_region_nation#4943,cfpk_nation_region#4944,cval_nation_n_name#4945,cval_nation_n_comment#4946,cn_name#4947,cn_comment#4948] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 251704ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/11 06:29:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:29:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5067L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 06:29:16 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 06:29:16 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 06:29:16 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 06:29:16 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 06:29:16 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 06:29:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5067L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#5069 AS rid_0#5084, cpfk_nation_customer#5070 AS cpfk_nation_customer_0#5085, cfpk_customer_nation#5071 AS cfpk_customer_nation_0#5086, cval_customer_c_name#5072 AS cval_customer_c_name_0#5087, cval_customer_c_address#5073 AS cval_customer_c_address_0#5088, cval_customer_c_phone#5074 AS cval_customer_c_phone_0#5089, cval_customer_c_acctbal#5075 AS cval_customer_c_acctbal_0#5090, cval_customer_c_comment#5076 AS cval_customer_c_comment_0#5091, cval_customer_c_mktsegment#5077 AS cval_customer_c_mktsegment_0#5092, cc_name#5078 AS cc_name_0#5093, cc_address#5079 AS cc_address_0#5094, cc_phone#5080 AS cc_phone_0#5095, cc_acctbal#5081 AS cc_acctbal_0#5096, cc_comment#5082 AS cc_comment_0#5097, cc_mktsegment#5083 AS cc_mktsegment_0#5098]
         :  :  :  :  :  +- Relation[rid#5069,cpfk_nation_customer#5070,cfpk_customer_nation#5071,cval_customer_c_name#5072,cval_customer_c_address#5073,cval_customer_c_phone#5074,cval_customer_c_acctbal#5075,cval_customer_c_comment#5076,cval_customer_c_mktsegment#5077,cc_name#5078,cc_address#5079,cc_phone#5080,cc_acctbal#5081,cc_comment#5082,cc_mktsegment#5083] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#5099 AS rid_0#5114, cpfk_nation_customer#5100 AS cpfk_nation_customer_0#5115, cfpk_customer_nation#5101 AS cfpk_customer_nation_0#5116, cval_customer_c_name#5102 AS cval_customer_c_name_0#5117, cval_customer_c_address#5103 AS cval_customer_c_address_0#5118, cval_customer_c_phone#5104 AS cval_customer_c_phone_0#5119, cval_customer_c_acctbal#5105 AS cval_customer_c_acctbal_0#5120, cval_customer_c_comment#5106 AS cval_customer_c_comment_0#5121, cval_customer_c_mktsegment#5107 AS cval_customer_c_mktsegment_0#5122, cc_name#5108 AS cc_name_0#5123, cc_address#5109 AS cc_address_0#5124, cc_phone#5110 AS cc_phone_0#5125, cc_acctbal#5111 AS cc_acctbal_0#5126, cc_comment#5112 AS cc_comment_0#5127, cc_mktsegment#5113 AS cc_mktsegment_0#5128]
         :  :  :  :        +- Relation[rid#5099,cpfk_nation_customer#5100,cfpk_customer_nation#5101,cval_customer_c_name#5102,cval_customer_c_address#5103,cval_customer_c_phone#5104,cval_customer_c_acctbal#5105,cval_customer_c_comment#5106,cval_customer_c_mktsegment#5107,cc_name#5108,cc_address#5109,cc_phone#5110,cc_acctbal#5111,cc_comment#5112,cc_mktsegment#5113] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#5163 AS rid_0#5178, cpfk_nation_customer#5164 AS cpfk_nation_customer_0#5179, cfpk_customer_nation#5165 AS cfpk_customer_nation_0#5180, cval_customer_c_name#5166 AS cval_customer_c_name_0#5181, cval_customer_c_address#5167 AS cval_customer_c_address_0#5182, cval_customer_c_phone#5168 AS cval_customer_c_phone_0#5183, cval_customer_c_acctbal#5169 AS cval_customer_c_acctbal_0#5184, cval_customer_c_comment#5170 AS cval_customer_c_comment_0#5185, cval_customer_c_mktsegment#5171 AS cval_customer_c_mktsegment_0#5186, cc_name#5172 AS cc_name_0#5187, cc_address#5173 AS cc_address_0#5188, cc_phone#5174 AS cc_phone_0#5189, cc_acctbal#5175 AS cc_acctbal_0#5190, cc_comment#5176 AS cc_comment_0#5191, cc_mktsegment#5177 AS cc_mktsegment_0#5192]
         :  :  :     :  +- Relation[rid#5163,cpfk_nation_customer#5164,cfpk_customer_nation#5165,cval_customer_c_name#5166,cval_customer_c_address#5167,cval_customer_c_phone#5168,cval_customer_c_acctbal#5169,cval_customer_c_comment#5170,cval_customer_c_mktsegment#5171,cc_name#5172,cc_address#5173,cc_phone#5174,cc_acctbal#5175,cc_comment#5176,cc_mktsegment#5177] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#5193 AS rid_1#5210, cpfk_customer_orders#5194 AS cpfk_customer_orders_1#5211, cfpk_orders_customer#5195 AS cfpk_orders_customer_1#5212, cval_orders_o_orderstatus#5196 AS cval_orders_o_orderstatus_1#5213, cval_orders_o_totalprice#5197 AS cval_orders_o_totalprice_1#5214, cval_orders_o_orderpriority#5198 AS cval_orders_o_orderpriority_1#5215, cval_orders_o_clerk#5199 AS cval_orders_o_clerk_1#5216, cval_orders_o_shippriority#5200 AS cval_orders_o_shippriority_1#5217, cval_orders_o_comment#5201 AS cval_orders_o_comment_1#5218, cval_orders_o_orderdate#5202 AS cval_orders_o_orderdate_1#5219, co_orderstatus#5203 AS co_orderstatus_1#5220, co_totalprice#5204 AS co_totalprice_1#5221, co_orderpriority#5205 AS co_orderpriority_1#5222, co_clerk#5206 AS co_clerk_1#5223, co_shippriority#5207 AS co_shippriority_1#5224, co_comment#5208 AS co_comment_1#5225, co_orderdate#5209 AS co_orderdate_1#5226]
         :  :  :        +- Relation[rid#5193,cpfk_customer_orders#5194,cfpk_orders_customer#5195,cval_orders_o_orderstatus#5196,cval_orders_o_totalprice#5197,cval_orders_o_orderpriority#5198,cval_orders_o_clerk#5199,cval_orders_o_shippriority#5200,cval_orders_o_comment#5201,cval_orders_o_orderdate#5202,co_orderstatus#5203,co_totalprice#5204,co_orderpriority#5205,co_clerk#5206,co_shippriority#5207,co_comment#5208,co_orderdate#5209] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#5129 AS rid_1#5146, cpfk_customer_orders#5130 AS cpfk_customer_orders_1#5147, cfpk_orders_customer#5131 AS cfpk_orders_customer_1#5148, cval_orders_o_orderstatus#5132 AS cval_orders_o_orderstatus_1#5149, cval_orders_o_totalprice#5133 AS cval_orders_o_totalprice_1#5150, cval_orders_o_orderpriority#5134 AS cval_orders_o_orderpriority_1#5151, cval_orders_o_clerk#5135 AS cval_orders_o_clerk_1#5152, cval_orders_o_shippriority#5136 AS cval_orders_o_shippriority_1#5153, cval_orders_o_comment#5137 AS cval_orders_o_comment_1#5154, cval_orders_o_orderdate#5138 AS cval_orders_o_orderdate_1#5155, co_orderstatus#5139 AS co_orderstatus_1#5156, co_totalprice#5140 AS co_totalprice_1#5157, co_orderpriority#5141 AS co_orderpriority_1#5158, co_clerk#5142 AS co_clerk_1#5159, co_shippriority#5143 AS co_shippriority_1#5160, co_comment#5144 AS co_comment_1#5161, co_orderdate#5145 AS co_orderdate_1#5162]
         :  :     +- Relation[rid#5129,cpfk_customer_orders#5130,cfpk_orders_customer#5131,cval_orders_o_orderstatus#5132,cval_orders_o_totalprice#5133,cval_orders_o_orderpriority#5134,cval_orders_o_clerk#5135,cval_orders_o_shippriority#5136,cval_orders_o_comment#5137,cval_orders_o_orderdate#5138,co_orderstatus#5139,co_totalprice#5140,co_orderpriority#5141,co_clerk#5142,co_shippriority#5143,co_comment#5144,co_orderdate#5145] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#5293 AS rid_1#5310, cpfk_customer_orders#5294 AS cpfk_customer_orders_1#5311, cfpk_orders_customer#5295 AS cfpk_orders_customer_1#5312, cval_orders_o_orderstatus#5296 AS cval_orders_o_orderstatus_1#5313, cval_orders_o_totalprice#5297 AS cval_orders_o_totalprice_1#5314, cval_orders_o_orderpriority#5298 AS cval_orders_o_orderpriority_1#5315, cval_orders_o_clerk#5299 AS cval_orders_o_clerk_1#5316, cval_orders_o_shippriority#5300 AS cval_orders_o_shippriority_1#5317, cval_orders_o_comment#5301 AS cval_orders_o_comment_1#5318, cval_orders_o_orderdate#5302 AS cval_orders_o_orderdate_1#5319, co_orderstatus#5303 AS co_orderstatus_1#5320, co_totalprice#5304 AS co_totalprice_1#5321, co_orderpriority#5305 AS co_orderpriority_1#5322, co_clerk#5306 AS co_clerk_1#5323, co_shippriority#5307 AS co_shippriority_1#5324, co_comment#5308 AS co_comment_1#5325, co_orderdate#5309 AS co_orderdate_1#5326]
         :     :  +- Relation[rid#5293,cpfk_customer_orders#5294,cfpk_orders_customer#5295,cval_orders_o_orderstatus#5296,cval_orders_o_totalprice#5297,cval_orders_o_orderpriority#5298,cval_orders_o_clerk#5299,cval_orders_o_shippriority#5300,cval_orders_o_comment#5301,cval_orders_o_orderdate#5302,co_orderstatus#5303,co_totalprice#5304,co_orderpriority#5305,co_clerk#5306,co_shippriority#5307,co_comment#5308,co_orderdate#5309] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#5327 AS rid_2#5360, cpfk_orders_lineitem#5328 AS cpfk_orders_lineitem_2#5361, cpfk_supplier_lineitem#5329 AS cpfk_supplier_lineitem_2#5362, cfpk_lineitem_supplier#5330 AS cfpk_lineitem_supplier_2#5363, cfpk_lineitem_partsupp#5331 AS cfpk_lineitem_partsupp_2#5364, cpfk_part_lineitem#5332 AS cpfk_part_lineitem_2#5365, cfpk_lineitem_part#5333 AS cfpk_lineitem_part_2#5366, cpfk_partsupp_lineitem#5334 AS cpfk_partsupp_lineitem_2#5367, cfpk_lineitem_orders#5335 AS cfpk_lineitem_orders_2#5368, cval_lineitem_l_quantity#5336 AS cval_lineitem_l_quantity_2#5369, cval_lineitem_l_extendedprice#5337 AS cval_lineitem_l_extendedprice_2#5370, cval_lineitem_l_discount#5338 AS cval_lineitem_l_discount_2#5371, cval_lineitem_l_tax#5339 AS cval_lineitem_l_tax_2#5372, cval_lineitem_l_returnflag#5340 AS cval_lineitem_l_returnflag_2#5373, cval_lineitem_l_linestatus#5341 AS cval_lineitem_l_linestatus_2#5374, cval_lineitem_l_commitdate#5342 AS cval_lineitem_l_commitdate_2#5375, cval_lineitem_l_receiptdate#5343 AS cval_lineitem_l_receiptdate_2#5376, cval_lineitem_l_shipinstruct#5344 AS cval_lineitem_l_shipinstruct_2#5377, cval_lineitem_l_shipmode#5345 AS cval_lineitem_l_shipmode_2#5378, cval_lineitem_l_comment#5346 AS cval_lineitem_l_comment_2#5379, cval_lineitem_l_shipdate#5347 AS cval_lineitem_l_shipdate_2#5380, cl_quantity#5348 AS cl_quantity_2#5381, cl_extendedprice#5349 AS cl_extendedprice_2#5382, cl_discount#5350 AS cl_discount_2#5383, ... 9 more fields]
         :        +- Relation[rid#5327,cpfk_orders_lineitem#5328,cpfk_supplier_lineitem#5329,cfpk_lineitem_supplier#5330,cfpk_lineitem_partsupp#5331,cpfk_part_lineitem#5332,cfpk_lineitem_part#5333,cpfk_partsupp_lineitem#5334,cfpk_lineitem_orders#5335,cval_lineitem_l_quantity#5336,cval_lineitem_l_extendedprice#5337,cval_lineitem_l_discount#5338,cval_lineitem_l_tax#5339,cval_lineitem_l_returnflag#5340,cval_lineitem_l_linestatus#5341,cval_lineitem_l_commitdate#5342,cval_lineitem_l_receiptdate#5343,cval_lineitem_l_shipinstruct#5344,cval_lineitem_l_shipmode#5345,cval_lineitem_l_comment#5346,cval_lineitem_l_shipdate#5347,cl_quantity#5348,cl_extendedprice#5349,cl_discount#5350,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5227 AS rid_2#5260, cpfk_orders_lineitem#5228 AS cpfk_orders_lineitem_2#5261, cpfk_supplier_lineitem#5229 AS cpfk_supplier_lineitem_2#5262, cfpk_lineitem_supplier#5230 AS cfpk_lineitem_supplier_2#5263, cfpk_lineitem_partsupp#5231 AS cfpk_lineitem_partsupp_2#5264, cpfk_part_lineitem#5232 AS cpfk_part_lineitem_2#5265, cfpk_lineitem_part#5233 AS cfpk_lineitem_part_2#5266, cpfk_partsupp_lineitem#5234 AS cpfk_partsupp_lineitem_2#5267, cfpk_lineitem_orders#5235 AS cfpk_lineitem_orders_2#5268, cval_lineitem_l_quantity#5236 AS cval_lineitem_l_quantity_2#5269, cval_lineitem_l_extendedprice#5237 AS cval_lineitem_l_extendedprice_2#5270, cval_lineitem_l_discount#5238 AS cval_lineitem_l_discount_2#5271, cval_lineitem_l_tax#5239 AS cval_lineitem_l_tax_2#5272, cval_lineitem_l_returnflag#5240 AS cval_lineitem_l_returnflag_2#5273, cval_lineitem_l_linestatus#5241 AS cval_lineitem_l_linestatus_2#5274, cval_lineitem_l_commitdate#5242 AS cval_lineitem_l_commitdate_2#5275, cval_lineitem_l_receiptdate#5243 AS cval_lineitem_l_receiptdate_2#5276, cval_lineitem_l_shipinstruct#5244 AS cval_lineitem_l_shipinstruct_2#5277, cval_lineitem_l_shipmode#5245 AS cval_lineitem_l_shipmode_2#5278, cval_lineitem_l_comment#5246 AS cval_lineitem_l_comment_2#5279, cval_lineitem_l_shipdate#5247 AS cval_lineitem_l_shipdate_2#5280, cl_quantity#5248 AS cl_quantity_2#5281, cl_extendedprice#5249 AS cl_extendedprice_2#5282, cl_discount#5250 AS cl_discount_2#5283, ... 9 more fields]
            +- Relation[rid#5227,cpfk_orders_lineitem#5228,cpfk_supplier_lineitem#5229,cfpk_lineitem_supplier#5230,cfpk_lineitem_partsupp#5231,cpfk_part_lineitem#5232,cfpk_lineitem_part#5233,cpfk_partsupp_lineitem#5234,cfpk_lineitem_orders#5235,cval_lineitem_l_quantity#5236,cval_lineitem_l_extendedprice#5237,cval_lineitem_l_discount#5238,cval_lineitem_l_tax#5239,cval_lineitem_l_returnflag#5240,cval_lineitem_l_linestatus#5241,cval_lineitem_l_commitdate#5242,cval_lineitem_l_receiptdate#5243,cval_lineitem_l_shipinstruct#5244,cval_lineitem_l_shipmode#5245,cval_lineitem_l_comment#5246,cval_lineitem_l_shipdate#5247,cl_quantity#5248,cl_extendedprice#5249,cl_discount#5250,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 117101ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/11 06:31:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:31:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5463L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 06:31:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5463L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#5465 AS rid_0#5482, cpfk_customer_orders#5466 AS cpfk_customer_orders_0#5483, cfpk_orders_customer#5467 AS cfpk_orders_customer_0#5484, cval_orders_o_orderstatus#5468 AS cval_orders_o_orderstatus_0#5485, cval_orders_o_totalprice#5469 AS cval_orders_o_totalprice_0#5486, cval_orders_o_orderpriority#5470 AS cval_orders_o_orderpriority_0#5487, cval_orders_o_clerk#5471 AS cval_orders_o_clerk_0#5488, cval_orders_o_shippriority#5472 AS cval_orders_o_shippriority_0#5489, cval_orders_o_comment#5473 AS cval_orders_o_comment_0#5490, cval_orders_o_orderdate#5474 AS cval_orders_o_orderdate_0#5491, co_orderstatus#5475 AS co_orderstatus_0#5492, co_totalprice#5476 AS co_totalprice_0#5493, co_orderpriority#5477 AS co_orderpriority_0#5494, co_clerk#5478 AS co_clerk_0#5495, co_shippriority#5479 AS co_shippriority_0#5496, co_comment#5480 AS co_comment_0#5497, co_orderdate#5481 AS co_orderdate_0#5498]
            :  +- Relation[rid#5465,cpfk_customer_orders#5466,cfpk_orders_customer#5467,cval_orders_o_orderstatus#5468,cval_orders_o_totalprice#5469,cval_orders_o_orderpriority#5470,cval_orders_o_clerk#5471,cval_orders_o_shippriority#5472,cval_orders_o_comment#5473,cval_orders_o_orderdate#5474,co_orderstatus#5475,co_totalprice#5476,co_orderpriority#5477,co_clerk#5478,co_shippriority#5479,co_comment#5480,co_orderdate#5481] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#5499 AS rid_1#5514, cpfk_nation_customer#5500 AS cpfk_nation_customer_1#5515, cfpk_customer_nation#5501 AS cfpk_customer_nation_1#5516, cval_customer_c_name#5502 AS cval_customer_c_name_1#5517, cval_customer_c_address#5503 AS cval_customer_c_address_1#5518, cval_customer_c_phone#5504 AS cval_customer_c_phone_1#5519, cval_customer_c_acctbal#5505 AS cval_customer_c_acctbal_1#5520, cval_customer_c_comment#5506 AS cval_customer_c_comment_1#5521, cval_customer_c_mktsegment#5507 AS cval_customer_c_mktsegment_1#5522, cc_name#5508 AS cc_name_1#5523, cc_address#5509 AS cc_address_1#5524, cc_phone#5510 AS cc_phone_1#5525, cc_acctbal#5511 AS cc_acctbal_1#5526, cc_comment#5512 AS cc_comment_1#5527, cc_mktsegment#5513 AS cc_mktsegment_1#5528]
               +- Relation[rid#5499,cpfk_nation_customer#5500,cfpk_customer_nation#5501,cval_customer_c_name#5502,cval_customer_c_address#5503,cval_customer_c_phone#5504,cval_customer_c_acctbal#5505,cval_customer_c_comment#5506,cval_customer_c_mktsegment#5507,cc_name#5508,cc_address#5509,cc_phone#5510,cc_acctbal#5511,cc_comment#5512,cc_mktsegment#5513] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 12735ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/11 06:31:25 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:31:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5565L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 06:31:25 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:31:25 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:31:25 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:31:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:31:25 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:31:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:31:25 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:31:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:31:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:31:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:31:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:31:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:31:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:31:26 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:31:26 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:31:26 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:31:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:31:26 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:31:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:31:26 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:31:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5565L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#5567 AS rid_0#5572, cval_region_r_name#5568 AS cval_region_r_name_0#5573, cval_region_r_comment#5569 AS cval_region_r_comment_0#5574, cr_name#5570 AS cr_name_0#5575, cr_comment#5571 AS cr_comment_0#5576]
         :  :  :  :  :  :  :  +- Relation[rid#5567,cval_region_r_name#5568,cval_region_r_comment#5569,cr_name#5570,cr_comment#5571] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#5577 AS rid_0#5582, cval_region_r_name#5578 AS cval_region_r_name_0#5583, cval_region_r_comment#5579 AS cval_region_r_comment_0#5584, cr_name#5580 AS cr_name_0#5585, cr_comment#5581 AS cr_comment_0#5586]
         :  :  :  :  :  :        +- Relation[rid#5577,cval_region_r_name#5578,cval_region_r_comment#5579,cr_name#5580,cr_comment#5581] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :     :- Project [rid#5601 AS rid_0#5606, cval_region_r_name#5602 AS cval_region_r_name_0#5607, cval_region_r_comment#5603 AS cval_region_r_comment_0#5608, cr_name#5604 AS cr_name_0#5609, cr_comment#5605 AS cr_comment_0#5610]
         :  :  :  :  :     :  +- Relation[rid#5601,cval_region_r_name#5602,cval_region_r_comment#5603,cr_name#5604,cr_comment#5605] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :     +- Project [rid#5611 AS rid_1#5618, cpfk_region_nation#5612 AS cpfk_region_nation_1#5619, cfpk_nation_region#5613 AS cfpk_nation_region_1#5620, cval_nation_n_name#5614 AS cval_nation_n_name_1#5621, cval_nation_n_comment#5615 AS cval_nation_n_comment_1#5622, cn_name#5616 AS cn_name_1#5623, cn_comment#5617 AS cn_comment_1#5624]
         :  :  :  :  :        +- Relation[rid#5611,cpfk_region_nation#5612,cfpk_nation_region#5613,cval_nation_n_name#5614,cval_nation_n_comment#5615,cn_name#5616,cn_comment#5617] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#5587 AS rid_1#5594, cpfk_region_nation#5588 AS cpfk_region_nation_1#5595, cfpk_nation_region#5589 AS cfpk_nation_region_1#5596, cval_nation_n_name#5590 AS cval_nation_n_name_1#5597, cval_nation_n_comment#5591 AS cval_nation_n_comment_1#5598, cn_name#5592 AS cn_name_1#5599, cn_comment#5593 AS cn_comment_1#5600]
         :  :  :  :     +- Relation[rid#5587,cpfk_region_nation#5588,cfpk_nation_region#5589,cval_nation_n_name#5590,cval_nation_n_comment#5591,cn_name#5592,cn_comment#5593] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :     :- Project [rid#5651 AS rid_1#5658, cpfk_region_nation#5652 AS cpfk_region_nation_1#5659, cfpk_nation_region#5653 AS cfpk_nation_region_1#5660, cval_nation_n_name#5654 AS cval_nation_n_name_1#5661, cval_nation_n_comment#5655 AS cval_nation_n_comment_1#5662, cn_name#5656 AS cn_name_1#5663, cn_comment#5657 AS cn_comment_1#5664]
         :  :  :     :  +- Relation[rid#5651,cpfk_region_nation#5652,cfpk_nation_region#5653,cval_nation_n_name#5654,cval_nation_n_comment#5655,cn_name#5656,cn_comment#5657] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#5665 AS rid_2#5678, cpfk_nation_supplier#5666 AS cpfk_nation_supplier_2#5679, cfpk_supplier_nation#5667 AS cfpk_supplier_nation_2#5680, cval_supplier_s_name#5668 AS cval_supplier_s_name_2#5681, cval_supplier_s_address#5669 AS cval_supplier_s_address_2#5682, cval_supplier_s_phone#5670 AS cval_supplier_s_phone_2#5683, cval_supplier_s_acctbal#5671 AS cval_supplier_s_acctbal_2#5684, cval_supplier_s_comment#5672 AS cval_supplier_s_comment_2#5685, cs_name#5673 AS cs_name_2#5686, cs_address#5674 AS cs_address_2#5687, cs_phone#5675 AS cs_phone_2#5688, cs_acctbal#5676 AS cs_acctbal_2#5689, cs_comment#5677 AS cs_comment_2#5690]
         :  :  :        +- Relation[rid#5665,cpfk_nation_supplier#5666,cfpk_supplier_nation#5667,cval_supplier_s_name#5668,cval_supplier_s_address#5669,cval_supplier_s_phone#5670,cval_supplier_s_acctbal#5671,cval_supplier_s_comment#5672,cs_name#5673,cs_address#5674,cs_phone#5675,cs_acctbal#5676,cs_comment#5677] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#5625 AS rid_2#5638, cpfk_nation_supplier#5626 AS cpfk_nation_supplier_2#5639, cfpk_supplier_nation#5627 AS cfpk_supplier_nation_2#5640, cval_supplier_s_name#5628 AS cval_supplier_s_name_2#5641, cval_supplier_s_address#5629 AS cval_supplier_s_address_2#5642, cval_supplier_s_phone#5630 AS cval_supplier_s_phone_2#5643, cval_supplier_s_acctbal#5631 AS cval_supplier_s_acctbal_2#5644, cval_supplier_s_comment#5632 AS cval_supplier_s_comment_2#5645, cs_name#5633 AS cs_name_2#5646, cs_address#5634 AS cs_address_2#5647, cs_phone#5635 AS cs_phone_2#5648, cs_acctbal#5636 AS cs_acctbal_2#5649, cs_comment#5637 AS cs_comment_2#5650]
         :  :     +- Relation[rid#5625,cpfk_nation_supplier#5626,cfpk_supplier_nation#5627,cval_supplier_s_name#5628,cval_supplier_s_address#5629,cval_supplier_s_phone#5630,cval_supplier_s_acctbal#5631,cval_supplier_s_comment#5632,cs_name#5633,cs_address#5634,cs_phone#5635,cs_acctbal#5636,cs_comment#5637] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :     :- Project [rid#5837 AS rid_2#5850, cpfk_nation_supplier#5838 AS cpfk_nation_supplier_2#5851, cfpk_supplier_nation#5839 AS cfpk_supplier_nation_2#5852, cval_supplier_s_name#5840 AS cval_supplier_s_name_2#5853, cval_supplier_s_address#5841 AS cval_supplier_s_address_2#5854, cval_supplier_s_phone#5842 AS cval_supplier_s_phone_2#5855, cval_supplier_s_acctbal#5843 AS cval_supplier_s_acctbal_2#5856, cval_supplier_s_comment#5844 AS cval_supplier_s_comment_2#5857, cs_name#5845 AS cs_name_2#5858, cs_address#5846 AS cs_address_2#5859, cs_phone#5847 AS cs_phone_2#5860, cs_acctbal#5848 AS cs_acctbal_2#5861, cs_comment#5849 AS cs_comment_2#5862]
         :     :  +- Relation[rid#5837,cpfk_nation_supplier#5838,cfpk_supplier_nation#5839,cval_supplier_s_name#5840,cval_supplier_s_address#5841,cval_supplier_s_phone#5842,cval_supplier_s_acctbal#5843,cval_supplier_s_comment#5844,cs_name#5845,cs_address#5846,cs_phone#5847,cs_acctbal#5848,cs_comment#5849] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#5863 AS rid_4#5874, cpfk_part_partsupp#5864 AS cpfk_part_partsupp_4#5875, cfpk_partsupp_part#5865 AS cfpk_partsupp_part_4#5876, cpfk_supplier_partsupp#5866 AS cpfk_supplier_partsupp_4#5877, cfpk_partsupp_supplier#5867 AS cfpk_partsupp_supplier_4#5878, cval_partsupp_ps_availqty#5868 AS cval_partsupp_ps_availqty_4#5879, cval_partsupp_ps_supplycost#5869 AS cval_partsupp_ps_supplycost_4#5880, cval_partsupp_ps_comment#5870 AS cval_partsupp_ps_comment_4#5881, cps_availqty#5871 AS cps_availqty_4#5882, cps_supplycost#5872 AS cps_supplycost_4#5883, cps_comment#5873 AS cps_comment_4#5884]
         :        +- Relation[rid#5863,cpfk_part_partsupp#5864,cfpk_partsupp_part#5865,cpfk_supplier_partsupp#5866,cfpk_partsupp_supplier#5867,cval_partsupp_ps_availqty#5868,cval_partsupp_ps_supplycost#5869,cval_partsupp_ps_comment#5870,cps_availqty#5871,cps_supplycost#5872,cps_comment#5873] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'Join UsingJoin(Inner,List(rid_3))
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#5691 AS rid_3#5708, cval_part_p_name#5692 AS cval_part_p_name_3#5709, cval_part_p_mfgr#5693 AS cval_part_p_mfgr_3#5710, cval_part_p_type#5694 AS cval_part_p_type_3#5711, cval_part_p_size#5695 AS cval_part_p_size_3#5712, cval_part_p_container#5696 AS cval_part_p_container_3#5713, cval_part_p_retailprice#5697 AS cval_part_p_retailprice_3#5714, cval_part_p_comment#5698 AS cval_part_p_comment_3#5715, cval_part_p_brand#5699 AS cval_part_p_brand_3#5716, cp_name#5700 AS cp_name_3#5717, cp_mfgr#5701 AS cp_mfgr_3#5718, cp_type#5702 AS cp_type_3#5719, cp_size#5703 AS cp_size_3#5720, cp_container#5704 AS cp_container_3#5721, cp_retailprice#5705 AS cp_retailprice_3#5722, cp_comment#5706 AS cp_comment_3#5723, cp_brand#5707 AS cp_brand_3#5724]
            :  :  :  +- Relation[rid#5691,cval_part_p_name#5692,cval_part_p_mfgr#5693,cval_part_p_type#5694,cval_part_p_size#5695,cval_part_p_container#5696,cval_part_p_retailprice#5697,cval_part_p_comment#5698,cval_part_p_brand#5699,cp_name#5700,cp_mfgr#5701,cp_type#5702,cp_size#5703,cp_container#5704,cp_retailprice#5705,cp_comment#5706,cp_brand#5707] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#5725 AS rid_3#5742, cval_part_p_name#5726 AS cval_part_p_name_3#5743, cval_part_p_mfgr#5727 AS cval_part_p_mfgr_3#5744, cval_part_p_type#5728 AS cval_part_p_type_3#5745, cval_part_p_size#5729 AS cval_part_p_size_3#5746, cval_part_p_container#5730 AS cval_part_p_container_3#5747, cval_part_p_retailprice#5731 AS cval_part_p_retailprice_3#5748, cval_part_p_comment#5732 AS cval_part_p_comment_3#5749, cval_part_p_brand#5733 AS cval_part_p_brand_3#5750, cp_name#5734 AS cp_name_3#5751, cp_mfgr#5735 AS cp_mfgr_3#5752, cp_type#5736 AS cp_type_3#5753, cp_size#5737 AS cp_size_3#5754, cp_container#5738 AS cp_container_3#5755, cp_retailprice#5739 AS cp_retailprice_3#5756, cp_comment#5740 AS cp_comment_3#5757, cp_brand#5741 AS cp_brand_3#5758]
            :  :        +- Relation[rid#5725,cval_part_p_name#5726,cval_part_p_mfgr#5727,cval_part_p_type#5728,cval_part_p_size#5729,cval_part_p_container#5730,cval_part_p_retailprice#5731,cval_part_p_comment#5732,cval_part_p_brand#5733,cp_name#5734,cp_mfgr#5735,cp_type#5736,cp_size#5737,cp_container#5738,cp_retailprice#5739,cp_comment#5740,cp_brand#5741] JDBCRelation(tpart) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :     :- Project [rid#5781 AS rid_3#5798, cval_part_p_name#5782 AS cval_part_p_name_3#5799, cval_part_p_mfgr#5783 AS cval_part_p_mfgr_3#5800, cval_part_p_type#5784 AS cval_part_p_type_3#5801, cval_part_p_size#5785 AS cval_part_p_size_3#5802, cval_part_p_container#5786 AS cval_part_p_container_3#5803, cval_part_p_retailprice#5787 AS cval_part_p_retailprice_3#5804, cval_part_p_comment#5788 AS cval_part_p_comment_3#5805, cval_part_p_brand#5789 AS cval_part_p_brand_3#5806, cp_name#5790 AS cp_name_3#5807, cp_mfgr#5791 AS cp_mfgr_3#5808, cp_type#5792 AS cp_type_3#5809, cp_size#5793 AS cp_size_3#5810, cp_container#5794 AS cp_container_3#5811, cp_retailprice#5795 AS cp_retailprice_3#5812, cp_comment#5796 AS cp_comment_3#5813, cp_brand#5797 AS cp_brand_3#5814]
            :     :  +- Relation[rid#5781,cval_part_p_name#5782,cval_part_p_mfgr#5783,cval_part_p_type#5784,cval_part_p_size#5785,cval_part_p_container#5786,cval_part_p_retailprice#5787,cval_part_p_comment#5788,cval_part_p_brand#5789,cp_name#5790,cp_mfgr#5791,cp_type#5792,cp_size#5793,cp_container#5794,cp_retailprice#5795,cp_comment#5796,cp_brand#5797] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#5815 AS rid_4#5826, cpfk_part_partsupp#5816 AS cpfk_part_partsupp_4#5827, cfpk_partsupp_part#5817 AS cfpk_partsupp_part_4#5828, cpfk_supplier_partsupp#5818 AS cpfk_supplier_partsupp_4#5829, cfpk_partsupp_supplier#5819 AS cfpk_partsupp_supplier_4#5830, cval_partsupp_ps_availqty#5820 AS cval_partsupp_ps_availqty_4#5831, cval_partsupp_ps_supplycost#5821 AS cval_partsupp_ps_supplycost_4#5832, cval_partsupp_ps_comment#5822 AS cval_partsupp_ps_comment_4#5833, cps_availqty#5823 AS cps_availqty_4#5834, cps_supplycost#5824 AS cps_supplycost_4#5835, cps_comment#5825 AS cps_comment_4#5836]
            :        +- Relation[rid#5815,cpfk_part_partsupp#5816,cfpk_partsupp_part#5817,cpfk_supplier_partsupp#5818,cfpk_partsupp_supplier#5819,cval_partsupp_ps_availqty#5820,cval_partsupp_ps_supplycost#5821,cval_partsupp_ps_comment#5822,cps_availqty#5823,cps_supplycost#5824,cps_comment#5825] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#5759 AS rid_4#5770, cpfk_part_partsupp#5760 AS cpfk_part_partsupp_4#5771, cfpk_partsupp_part#5761 AS cfpk_partsupp_part_4#5772, cpfk_supplier_partsupp#5762 AS cpfk_supplier_partsupp_4#5773, cfpk_partsupp_supplier#5763 AS cfpk_partsupp_supplier_4#5774, cval_partsupp_ps_availqty#5764 AS cval_partsupp_ps_availqty_4#5775, cval_partsupp_ps_supplycost#5765 AS cval_partsupp_ps_supplycost_4#5776, cval_partsupp_ps_comment#5766 AS cval_partsupp_ps_comment_4#5777, cps_availqty#5767 AS cps_availqty_4#5778, cps_supplycost#5768 AS cps_supplycost_4#5779, cps_comment#5769 AS cps_comment_4#5780]
               +- Relation[rid#5759,cpfk_part_partsupp#5760,cfpk_partsupp_part#5761,cpfk_supplier_partsupp#5762,cfpk_partsupp_supplier#5763,cval_partsupp_ps_availqty#5764,cval_partsupp_ps_supplycost#5765,cval_partsupp_ps_comment#5766,cps_availqty#5767,cps_supplycost#5768,cps_comment#5769] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 20974ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/11 06:31:46 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:31:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5942L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 06:31:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:31:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:31:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:31:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:31:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:31:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:31:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:31:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5942L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#5944 AS rid_0#5961, cval_part_p_name#5945 AS cval_part_p_name_0#5962, cval_part_p_mfgr#5946 AS cval_part_p_mfgr_0#5963, cval_part_p_type#5947 AS cval_part_p_type_0#5964, cval_part_p_size#5948 AS cval_part_p_size_0#5965, cval_part_p_container#5949 AS cval_part_p_container_0#5966, cval_part_p_retailprice#5950 AS cval_part_p_retailprice_0#5967, cval_part_p_comment#5951 AS cval_part_p_comment_0#5968, cval_part_p_brand#5952 AS cval_part_p_brand_0#5969, cp_name#5953 AS cp_name_0#5970, cp_mfgr#5954 AS cp_mfgr_0#5971, cp_type#5955 AS cp_type_0#5972, cp_size#5956 AS cp_size_0#5973, cp_container#5957 AS cp_container_0#5974, cp_retailprice#5958 AS cp_retailprice_0#5975, cp_comment#5959 AS cp_comment_0#5976, cp_brand#5960 AS cp_brand_0#5977]
         :  :  :  :  +- Relation[rid#5944,cval_part_p_name#5945,cval_part_p_mfgr#5946,cval_part_p_type#5947,cval_part_p_size#5948,cval_part_p_container#5949,cval_part_p_retailprice#5950,cval_part_p_comment#5951,cval_part_p_brand#5952,cp_name#5953,cp_mfgr#5954,cp_type#5955,cp_size#5956,cp_container#5957,cp_retailprice#5958,cp_comment#5959,cp_brand#5960] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#5978 AS rid_0#5995, cval_part_p_name#5979 AS cval_part_p_name_0#5996, cval_part_p_mfgr#5980 AS cval_part_p_mfgr_0#5997, cval_part_p_type#5981 AS cval_part_p_type_0#5998, cval_part_p_size#5982 AS cval_part_p_size_0#5999, cval_part_p_container#5983 AS cval_part_p_container_0#6000, cval_part_p_retailprice#5984 AS cval_part_p_retailprice_0#6001, cval_part_p_comment#5985 AS cval_part_p_comment_0#6002, cval_part_p_brand#5986 AS cval_part_p_brand_0#6003, cp_name#5987 AS cp_name_0#6004, cp_mfgr#5988 AS cp_mfgr_0#6005, cp_type#5989 AS cp_type_0#6006, cp_size#5990 AS cp_size_0#6007, cp_container#5991 AS cp_container_0#6008, cp_retailprice#5992 AS cp_retailprice_0#6009, cp_comment#5993 AS cp_comment_0#6010, cp_brand#5994 AS cp_brand_0#6011]
         :  :  :        +- Relation[rid#5978,cval_part_p_name#5979,cval_part_p_mfgr#5980,cval_part_p_type#5981,cval_part_p_size#5982,cval_part_p_container#5983,cval_part_p_retailprice#5984,cval_part_p_comment#5985,cval_part_p_brand#5986,cp_name#5987,cp_mfgr#5988,cp_type#5989,cp_size#5990,cp_container#5991,cp_retailprice#5992,cp_comment#5993,cp_brand#5994] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#6012 AS rid_0#6029, cval_part_p_name#6013 AS cval_part_p_name_0#6030, cval_part_p_mfgr#6014 AS cval_part_p_mfgr_0#6031, cval_part_p_type#6015 AS cval_part_p_type_0#6032, cval_part_p_size#6016 AS cval_part_p_size_0#6033, cval_part_p_container#6017 AS cval_part_p_container_0#6034, cval_part_p_retailprice#6018 AS cval_part_p_retailprice_0#6035, cval_part_p_comment#6019 AS cval_part_p_comment_0#6036, cval_part_p_brand#6020 AS cval_part_p_brand_0#6037, cp_name#6021 AS cp_name_0#6038, cp_mfgr#6022 AS cp_mfgr_0#6039, cp_type#6023 AS cp_type_0#6040, cp_size#6024 AS cp_size_0#6041, cp_container#6025 AS cp_container_0#6042, cp_retailprice#6026 AS cp_retailprice_0#6043, cp_comment#6027 AS cp_comment_0#6044, cp_brand#6028 AS cp_brand_0#6045]
         :  :        +- Relation[rid#6012,cval_part_p_name#6013,cval_part_p_mfgr#6014,cval_part_p_type#6015,cval_part_p_size#6016,cval_part_p_container#6017,cval_part_p_retailprice#6018,cval_part_p_comment#6019,cval_part_p_brand#6020,cp_name#6021,cp_mfgr#6022,cp_type#6023,cp_size#6024,cp_container#6025,cp_retailprice#6026,cp_comment#6027,cp_brand#6028] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#6112 AS rid_0#6129, cval_part_p_name#6113 AS cval_part_p_name_0#6130, cval_part_p_mfgr#6114 AS cval_part_p_mfgr_0#6131, cval_part_p_type#6115 AS cval_part_p_type_0#6132, cval_part_p_size#6116 AS cval_part_p_size_0#6133, cval_part_p_container#6117 AS cval_part_p_container_0#6134, cval_part_p_retailprice#6118 AS cval_part_p_retailprice_0#6135, cval_part_p_comment#6119 AS cval_part_p_comment_0#6136, cval_part_p_brand#6120 AS cval_part_p_brand_0#6137, cp_name#6121 AS cp_name_0#6138, cp_mfgr#6122 AS cp_mfgr_0#6139, cp_type#6123 AS cp_type_0#6140, cp_size#6124 AS cp_size_0#6141, cp_container#6125 AS cp_container_0#6142, cp_retailprice#6126 AS cp_retailprice_0#6143, cp_comment#6127 AS cp_comment_0#6144, cp_brand#6128 AS cp_brand_0#6145]
         :     :  +- Relation[rid#6112,cval_part_p_name#6113,cval_part_p_mfgr#6114,cval_part_p_type#6115,cval_part_p_size#6116,cval_part_p_container#6117,cval_part_p_retailprice#6118,cval_part_p_comment#6119,cval_part_p_brand#6120,cp_name#6121,cp_mfgr#6122,cp_type#6123,cp_size#6124,cp_container#6125,cp_retailprice#6126,cp_comment#6127,cp_brand#6128] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#6146 AS rid_1#6179, cpfk_orders_lineitem#6147 AS cpfk_orders_lineitem_1#6180, cpfk_supplier_lineitem#6148 AS cpfk_supplier_lineitem_1#6181, cfpk_lineitem_supplier#6149 AS cfpk_lineitem_supplier_1#6182, cfpk_lineitem_partsupp#6150 AS cfpk_lineitem_partsupp_1#6183, cpfk_part_lineitem#6151 AS cpfk_part_lineitem_1#6184, cfpk_lineitem_part#6152 AS cfpk_lineitem_part_1#6185, cpfk_partsupp_lineitem#6153 AS cpfk_partsupp_lineitem_1#6186, cfpk_lineitem_orders#6154 AS cfpk_lineitem_orders_1#6187, cval_lineitem_l_quantity#6155 AS cval_lineitem_l_quantity_1#6188, cval_lineitem_l_extendedprice#6156 AS cval_lineitem_l_extendedprice_1#6189, cval_lineitem_l_discount#6157 AS cval_lineitem_l_discount_1#6190, cval_lineitem_l_tax#6158 AS cval_lineitem_l_tax_1#6191, cval_lineitem_l_returnflag#6159 AS cval_lineitem_l_returnflag_1#6192, cval_lineitem_l_linestatus#6160 AS cval_lineitem_l_linestatus_1#6193, cval_lineitem_l_commitdate#6161 AS cval_lineitem_l_commitdate_1#6194, cval_lineitem_l_receiptdate#6162 AS cval_lineitem_l_receiptdate_1#6195, cval_lineitem_l_shipinstruct#6163 AS cval_lineitem_l_shipinstruct_1#6196, cval_lineitem_l_shipmode#6164 AS cval_lineitem_l_shipmode_1#6197, cval_lineitem_l_comment#6165 AS cval_lineitem_l_comment_1#6198, cval_lineitem_l_shipdate#6166 AS cval_lineitem_l_shipdate_1#6199, cl_quantity#6167 AS cl_quantity_1#6200, cl_extendedprice#6168 AS cl_extendedprice_1#6201, cl_discount#6169 AS cl_discount_1#6202, ... 9 more fields]
         :        +- Relation[rid#6146,cpfk_orders_lineitem#6147,cpfk_supplier_lineitem#6148,cfpk_lineitem_supplier#6149,cfpk_lineitem_partsupp#6150,cpfk_part_lineitem#6151,cfpk_lineitem_part#6152,cpfk_partsupp_lineitem#6153,cfpk_lineitem_orders#6154,cval_lineitem_l_quantity#6155,cval_lineitem_l_extendedprice#6156,cval_lineitem_l_discount#6157,cval_lineitem_l_tax#6158,cval_lineitem_l_returnflag#6159,cval_lineitem_l_linestatus#6160,cval_lineitem_l_commitdate#6161,cval_lineitem_l_receiptdate#6162,cval_lineitem_l_shipinstruct#6163,cval_lineitem_l_shipmode#6164,cval_lineitem_l_comment#6165,cval_lineitem_l_shipdate#6166,cl_quantity#6167,cl_extendedprice#6168,cl_discount#6169,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6046 AS rid_1#6079, cpfk_orders_lineitem#6047 AS cpfk_orders_lineitem_1#6080, cpfk_supplier_lineitem#6048 AS cpfk_supplier_lineitem_1#6081, cfpk_lineitem_supplier#6049 AS cfpk_lineitem_supplier_1#6082, cfpk_lineitem_partsupp#6050 AS cfpk_lineitem_partsupp_1#6083, cpfk_part_lineitem#6051 AS cpfk_part_lineitem_1#6084, cfpk_lineitem_part#6052 AS cfpk_lineitem_part_1#6085, cpfk_partsupp_lineitem#6053 AS cpfk_partsupp_lineitem_1#6086, cfpk_lineitem_orders#6054 AS cfpk_lineitem_orders_1#6087, cval_lineitem_l_quantity#6055 AS cval_lineitem_l_quantity_1#6088, cval_lineitem_l_extendedprice#6056 AS cval_lineitem_l_extendedprice_1#6089, cval_lineitem_l_discount#6057 AS cval_lineitem_l_discount_1#6090, cval_lineitem_l_tax#6058 AS cval_lineitem_l_tax_1#6091, cval_lineitem_l_returnflag#6059 AS cval_lineitem_l_returnflag_1#6092, cval_lineitem_l_linestatus#6060 AS cval_lineitem_l_linestatus_1#6093, cval_lineitem_l_commitdate#6061 AS cval_lineitem_l_commitdate_1#6094, cval_lineitem_l_receiptdate#6062 AS cval_lineitem_l_receiptdate_1#6095, cval_lineitem_l_shipinstruct#6063 AS cval_lineitem_l_shipinstruct_1#6096, cval_lineitem_l_shipmode#6064 AS cval_lineitem_l_shipmode_1#6097, cval_lineitem_l_comment#6065 AS cval_lineitem_l_comment_1#6098, cval_lineitem_l_shipdate#6066 AS cval_lineitem_l_shipdate_1#6099, cl_quantity#6067 AS cl_quantity_1#6100, cl_extendedprice#6068 AS cl_extendedprice_1#6101, cl_discount#6069 AS cl_discount_1#6102, ... 9 more fields]
            +- Relation[rid#6046,cpfk_orders_lineitem#6047,cpfk_supplier_lineitem#6048,cfpk_lineitem_supplier#6049,cfpk_lineitem_partsupp#6050,cpfk_part_lineitem#6051,cfpk_lineitem_part#6052,cpfk_partsupp_lineitem#6053,cfpk_lineitem_orders#6054,cval_lineitem_l_quantity#6055,cval_lineitem_l_extendedprice#6056,cval_lineitem_l_discount#6057,cval_lineitem_l_tax#6058,cval_lineitem_l_returnflag#6059,cval_lineitem_l_linestatus#6060,cval_lineitem_l_commitdate#6061,cval_lineitem_l_receiptdate#6062,cval_lineitem_l_shipinstruct#6063,cval_lineitem_l_shipmode#6064,cval_lineitem_l_comment#6065,cval_lineitem_l_shipdate#6066,cl_quantity#6067,cl_extendedprice#6068,cl_discount#6069,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 71958ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/11 06:32:58 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:32:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6267L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 06:32:58 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:32:58 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:32:58 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:32:58 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:32:58 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:32:58 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:32:58 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:32:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6267L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#6269 AS rid_0#6286, cval_part_p_name#6270 AS cval_part_p_name_0#6287, cval_part_p_mfgr#6271 AS cval_part_p_mfgr_0#6288, cval_part_p_type#6272 AS cval_part_p_type_0#6289, cval_part_p_size#6273 AS cval_part_p_size_0#6290, cval_part_p_container#6274 AS cval_part_p_container_0#6291, cval_part_p_retailprice#6275 AS cval_part_p_retailprice_0#6292, cval_part_p_comment#6276 AS cval_part_p_comment_0#6293, cval_part_p_brand#6277 AS cval_part_p_brand_0#6294, cp_name#6278 AS cp_name_0#6295, cp_mfgr#6279 AS cp_mfgr_0#6296, cp_type#6280 AS cp_type_0#6297, cp_size#6281 AS cp_size_0#6298, cp_container#6282 AS cp_container_0#6299, cp_retailprice#6283 AS cp_retailprice_0#6300, cp_comment#6284 AS cp_comment_0#6301, cp_brand#6285 AS cp_brand_0#6302]
         :  :  :  :  +- Relation[rid#6269,cval_part_p_name#6270,cval_part_p_mfgr#6271,cval_part_p_type#6272,cval_part_p_size#6273,cval_part_p_container#6274,cval_part_p_retailprice#6275,cval_part_p_comment#6276,cval_part_p_brand#6277,cp_name#6278,cp_mfgr#6279,cp_type#6280,cp_size#6281,cp_container#6282,cp_retailprice#6283,cp_comment#6284,cp_brand#6285] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#6303 AS rid_0#6320, cval_part_p_name#6304 AS cval_part_p_name_0#6321, cval_part_p_mfgr#6305 AS cval_part_p_mfgr_0#6322, cval_part_p_type#6306 AS cval_part_p_type_0#6323, cval_part_p_size#6307 AS cval_part_p_size_0#6324, cval_part_p_container#6308 AS cval_part_p_container_0#6325, cval_part_p_retailprice#6309 AS cval_part_p_retailprice_0#6326, cval_part_p_comment#6310 AS cval_part_p_comment_0#6327, cval_part_p_brand#6311 AS cval_part_p_brand_0#6328, cp_name#6312 AS cp_name_0#6329, cp_mfgr#6313 AS cp_mfgr_0#6330, cp_type#6314 AS cp_type_0#6331, cp_size#6315 AS cp_size_0#6332, cp_container#6316 AS cp_container_0#6333, cp_retailprice#6317 AS cp_retailprice_0#6334, cp_comment#6318 AS cp_comment_0#6335, cp_brand#6319 AS cp_brand_0#6336]
         :  :  :        +- Relation[rid#6303,cval_part_p_name#6304,cval_part_p_mfgr#6305,cval_part_p_type#6306,cval_part_p_size#6307,cval_part_p_container#6308,cval_part_p_retailprice#6309,cval_part_p_comment#6310,cval_part_p_brand#6311,cp_name#6312,cp_mfgr#6313,cp_type#6314,cp_size#6315,cp_container#6316,cp_retailprice#6317,cp_comment#6318,cp_brand#6319] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#6337 AS rid_0#6354, cval_part_p_name#6338 AS cval_part_p_name_0#6355, cval_part_p_mfgr#6339 AS cval_part_p_mfgr_0#6356, cval_part_p_type#6340 AS cval_part_p_type_0#6357, cval_part_p_size#6341 AS cval_part_p_size_0#6358, cval_part_p_container#6342 AS cval_part_p_container_0#6359, cval_part_p_retailprice#6343 AS cval_part_p_retailprice_0#6360, cval_part_p_comment#6344 AS cval_part_p_comment_0#6361, cval_part_p_brand#6345 AS cval_part_p_brand_0#6362, cp_name#6346 AS cp_name_0#6363, cp_mfgr#6347 AS cp_mfgr_0#6364, cp_type#6348 AS cp_type_0#6365, cp_size#6349 AS cp_size_0#6366, cp_container#6350 AS cp_container_0#6367, cp_retailprice#6351 AS cp_retailprice_0#6368, cp_comment#6352 AS cp_comment_0#6369, cp_brand#6353 AS cp_brand_0#6370]
         :  :        +- Relation[rid#6337,cval_part_p_name#6338,cval_part_p_mfgr#6339,cval_part_p_type#6340,cval_part_p_size#6341,cval_part_p_container#6342,cval_part_p_retailprice#6343,cval_part_p_comment#6344,cval_part_p_brand#6345,cp_name#6346,cp_mfgr#6347,cp_type#6348,cp_size#6349,cp_container#6350,cp_retailprice#6351,cp_comment#6352,cp_brand#6353] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#6569 AS rid_0#6586, cval_part_p_name#6570 AS cval_part_p_name_0#6587, cval_part_p_mfgr#6571 AS cval_part_p_mfgr_0#6588, cval_part_p_type#6572 AS cval_part_p_type_0#6589, cval_part_p_size#6573 AS cval_part_p_size_0#6590, cval_part_p_container#6574 AS cval_part_p_container_0#6591, cval_part_p_retailprice#6575 AS cval_part_p_retailprice_0#6592, cval_part_p_comment#6576 AS cval_part_p_comment_0#6593, cval_part_p_brand#6577 AS cval_part_p_brand_0#6594, cp_name#6578 AS cp_name_0#6595, cp_mfgr#6579 AS cp_mfgr_0#6596, cp_type#6580 AS cp_type_0#6597, cp_size#6581 AS cp_size_0#6598, cp_container#6582 AS cp_container_0#6599, cp_retailprice#6583 AS cp_retailprice_0#6600, cp_comment#6584 AS cp_comment_0#6601, cp_brand#6585 AS cp_brand_0#6602]
         :     :  +- Relation[rid#6569,cval_part_p_name#6570,cval_part_p_mfgr#6571,cval_part_p_type#6572,cval_part_p_size#6573,cval_part_p_container#6574,cval_part_p_retailprice#6575,cval_part_p_comment#6576,cval_part_p_brand#6577,cp_name#6578,cp_mfgr#6579,cp_type#6580,cp_size#6581,cp_container#6582,cp_retailprice#6583,cp_comment#6584,cp_brand#6585] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#6603 AS rid_1#6636, cpfk_orders_lineitem#6604 AS cpfk_orders_lineitem_1#6637, cpfk_supplier_lineitem#6605 AS cpfk_supplier_lineitem_1#6638, cfpk_lineitem_supplier#6606 AS cfpk_lineitem_supplier_1#6639, cfpk_lineitem_partsupp#6607 AS cfpk_lineitem_partsupp_1#6640, cpfk_part_lineitem#6608 AS cpfk_part_lineitem_1#6641, cfpk_lineitem_part#6609 AS cfpk_lineitem_part_1#6642, cpfk_partsupp_lineitem#6610 AS cpfk_partsupp_lineitem_1#6643, cfpk_lineitem_orders#6611 AS cfpk_lineitem_orders_1#6644, cval_lineitem_l_quantity#6612 AS cval_lineitem_l_quantity_1#6645, cval_lineitem_l_extendedprice#6613 AS cval_lineitem_l_extendedprice_1#6646, cval_lineitem_l_discount#6614 AS cval_lineitem_l_discount_1#6647, cval_lineitem_l_tax#6615 AS cval_lineitem_l_tax_1#6648, cval_lineitem_l_returnflag#6616 AS cval_lineitem_l_returnflag_1#6649, cval_lineitem_l_linestatus#6617 AS cval_lineitem_l_linestatus_1#6650, cval_lineitem_l_commitdate#6618 AS cval_lineitem_l_commitdate_1#6651, cval_lineitem_l_receiptdate#6619 AS cval_lineitem_l_receiptdate_1#6652, cval_lineitem_l_shipinstruct#6620 AS cval_lineitem_l_shipinstruct_1#6653, cval_lineitem_l_shipmode#6621 AS cval_lineitem_l_shipmode_1#6654, cval_lineitem_l_comment#6622 AS cval_lineitem_l_comment_1#6655, cval_lineitem_l_shipdate#6623 AS cval_lineitem_l_shipdate_1#6656, cl_quantity#6624 AS cl_quantity_1#6657, cl_extendedprice#6625 AS cl_extendedprice_1#6658, cl_discount#6626 AS cl_discount_1#6659, ... 9 more fields]
         :        +- Relation[rid#6603,cpfk_orders_lineitem#6604,cpfk_supplier_lineitem#6605,cfpk_lineitem_supplier#6606,cfpk_lineitem_partsupp#6607,cpfk_part_lineitem#6608,cfpk_lineitem_part#6609,cpfk_partsupp_lineitem#6610,cfpk_lineitem_orders#6611,cval_lineitem_l_quantity#6612,cval_lineitem_l_extendedprice#6613,cval_lineitem_l_discount#6614,cval_lineitem_l_tax#6615,cval_lineitem_l_returnflag#6616,cval_lineitem_l_linestatus#6617,cval_lineitem_l_commitdate#6618,cval_lineitem_l_receiptdate#6619,cval_lineitem_l_shipinstruct#6620,cval_lineitem_l_shipmode#6621,cval_lineitem_l_comment#6622,cval_lineitem_l_shipdate#6623,cl_quantity#6624,cl_extendedprice#6625,cl_discount#6626,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#6371 AS rid_1#6404, cpfk_orders_lineitem#6372 AS cpfk_orders_lineitem_1#6405, cpfk_supplier_lineitem#6373 AS cpfk_supplier_lineitem_1#6406, cfpk_lineitem_supplier#6374 AS cfpk_lineitem_supplier_1#6407, cfpk_lineitem_partsupp#6375 AS cfpk_lineitem_partsupp_1#6408, cpfk_part_lineitem#6376 AS cpfk_part_lineitem_1#6409, cfpk_lineitem_part#6377 AS cfpk_lineitem_part_1#6410, cpfk_partsupp_lineitem#6378 AS cpfk_partsupp_lineitem_1#6411, cfpk_lineitem_orders#6379 AS cfpk_lineitem_orders_1#6412, cval_lineitem_l_quantity#6380 AS cval_lineitem_l_quantity_1#6413, cval_lineitem_l_extendedprice#6381 AS cval_lineitem_l_extendedprice_1#6414, cval_lineitem_l_discount#6382 AS cval_lineitem_l_discount_1#6415, cval_lineitem_l_tax#6383 AS cval_lineitem_l_tax_1#6416, cval_lineitem_l_returnflag#6384 AS cval_lineitem_l_returnflag_1#6417, cval_lineitem_l_linestatus#6385 AS cval_lineitem_l_linestatus_1#6418, cval_lineitem_l_commitdate#6386 AS cval_lineitem_l_commitdate_1#6419, cval_lineitem_l_receiptdate#6387 AS cval_lineitem_l_receiptdate_1#6420, cval_lineitem_l_shipinstruct#6388 AS cval_lineitem_l_shipinstruct_1#6421, cval_lineitem_l_shipmode#6389 AS cval_lineitem_l_shipmode_1#6422, cval_lineitem_l_comment#6390 AS cval_lineitem_l_comment_1#6423, cval_lineitem_l_shipdate#6391 AS cval_lineitem_l_shipdate_1#6424, cl_quantity#6392 AS cl_quantity_1#6425, cl_extendedprice#6393 AS cl_extendedprice_1#6426, cl_discount#6394 AS cl_discount_1#6427, ... 9 more fields]
            :  :  +- Relation[rid#6371,cpfk_orders_lineitem#6372,cpfk_supplier_lineitem#6373,cfpk_lineitem_supplier#6374,cfpk_lineitem_partsupp#6375,cpfk_part_lineitem#6376,cfpk_lineitem_part#6377,cpfk_partsupp_lineitem#6378,cfpk_lineitem_orders#6379,cval_lineitem_l_quantity#6380,cval_lineitem_l_extendedprice#6381,cval_lineitem_l_discount#6382,cval_lineitem_l_tax#6383,cval_lineitem_l_returnflag#6384,cval_lineitem_l_linestatus#6385,cval_lineitem_l_commitdate#6386,cval_lineitem_l_receiptdate#6387,cval_lineitem_l_shipinstruct#6388,cval_lineitem_l_shipmode#6389,cval_lineitem_l_comment#6390,cval_lineitem_l_shipdate#6391,cl_quantity#6392,cl_extendedprice#6393,cl_discount#6394,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#6437 AS rid_1#6470, cpfk_orders_lineitem#6438 AS cpfk_orders_lineitem_1#6471, cpfk_supplier_lineitem#6439 AS cpfk_supplier_lineitem_1#6472, cfpk_lineitem_supplier#6440 AS cfpk_lineitem_supplier_1#6473, cfpk_lineitem_partsupp#6441 AS cfpk_lineitem_partsupp_1#6474, cpfk_part_lineitem#6442 AS cpfk_part_lineitem_1#6475, cfpk_lineitem_part#6443 AS cfpk_lineitem_part_1#6476, cpfk_partsupp_lineitem#6444 AS cpfk_partsupp_lineitem_1#6477, cfpk_lineitem_orders#6445 AS cfpk_lineitem_orders_1#6478, cval_lineitem_l_quantity#6446 AS cval_lineitem_l_quantity_1#6479, cval_lineitem_l_extendedprice#6447 AS cval_lineitem_l_extendedprice_1#6480, cval_lineitem_l_discount#6448 AS cval_lineitem_l_discount_1#6481, cval_lineitem_l_tax#6449 AS cval_lineitem_l_tax_1#6482, cval_lineitem_l_returnflag#6450 AS cval_lineitem_l_returnflag_1#6483, cval_lineitem_l_linestatus#6451 AS cval_lineitem_l_linestatus_1#6484, cval_lineitem_l_commitdate#6452 AS cval_lineitem_l_commitdate_1#6485, cval_lineitem_l_receiptdate#6453 AS cval_lineitem_l_receiptdate_1#6486, cval_lineitem_l_shipinstruct#6454 AS cval_lineitem_l_shipinstruct_1#6487, cval_lineitem_l_shipmode#6455 AS cval_lineitem_l_shipmode_1#6488, cval_lineitem_l_comment#6456 AS cval_lineitem_l_comment_1#6489, cval_lineitem_l_shipdate#6457 AS cval_lineitem_l_shipdate_1#6490, cl_quantity#6458 AS cl_quantity_1#6491, cl_extendedprice#6459 AS cl_extendedprice_1#6492, cl_discount#6460 AS cl_discount_1#6493, ... 9 more fields]
            :        +- Relation[rid#6437,cpfk_orders_lineitem#6438,cpfk_supplier_lineitem#6439,cfpk_lineitem_supplier#6440,cfpk_lineitem_partsupp#6441,cpfk_part_lineitem#6442,cfpk_lineitem_part#6443,cpfk_partsupp_lineitem#6444,cfpk_lineitem_orders#6445,cval_lineitem_l_quantity#6446,cval_lineitem_l_extendedprice#6447,cval_lineitem_l_discount#6448,cval_lineitem_l_tax#6449,cval_lineitem_l_returnflag#6450,cval_lineitem_l_linestatus#6451,cval_lineitem_l_commitdate#6452,cval_lineitem_l_receiptdate#6453,cval_lineitem_l_shipinstruct#6454,cval_lineitem_l_shipmode#6455,cval_lineitem_l_comment#6456,cval_lineitem_l_shipdate#6457,cl_quantity#6458,cl_extendedprice#6459,cl_discount#6460,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#6503 AS rid_1#6536, cpfk_orders_lineitem#6504 AS cpfk_orders_lineitem_1#6537, cpfk_supplier_lineitem#6505 AS cpfk_supplier_lineitem_1#6538, cfpk_lineitem_supplier#6506 AS cfpk_lineitem_supplier_1#6539, cfpk_lineitem_partsupp#6507 AS cfpk_lineitem_partsupp_1#6540, cpfk_part_lineitem#6508 AS cpfk_part_lineitem_1#6541, cfpk_lineitem_part#6509 AS cfpk_lineitem_part_1#6542, cpfk_partsupp_lineitem#6510 AS cpfk_partsupp_lineitem_1#6543, cfpk_lineitem_orders#6511 AS cfpk_lineitem_orders_1#6544, cval_lineitem_l_quantity#6512 AS cval_lineitem_l_quantity_1#6545, cval_lineitem_l_extendedprice#6513 AS cval_lineitem_l_extendedprice_1#6546, cval_lineitem_l_discount#6514 AS cval_lineitem_l_discount_1#6547, cval_lineitem_l_tax#6515 AS cval_lineitem_l_tax_1#6548, cval_lineitem_l_returnflag#6516 AS cval_lineitem_l_returnflag_1#6549, cval_lineitem_l_linestatus#6517 AS cval_lineitem_l_linestatus_1#6550, cval_lineitem_l_commitdate#6518 AS cval_lineitem_l_commitdate_1#6551, cval_lineitem_l_receiptdate#6519 AS cval_lineitem_l_receiptdate_1#6552, cval_lineitem_l_shipinstruct#6520 AS cval_lineitem_l_shipinstruct_1#6553, cval_lineitem_l_shipmode#6521 AS cval_lineitem_l_shipmode_1#6554, cval_lineitem_l_comment#6522 AS cval_lineitem_l_comment_1#6555, cval_lineitem_l_shipdate#6523 AS cval_lineitem_l_shipdate_1#6556, cl_quantity#6524 AS cl_quantity_1#6557, cl_extendedprice#6525 AS cl_extendedprice_1#6558, cl_discount#6526 AS cl_discount_1#6559, ... 9 more fields]
                  +- Relation[rid#6503,cpfk_orders_lineitem#6504,cpfk_supplier_lineitem#6505,cfpk_lineitem_supplier#6506,cfpk_lineitem_partsupp#6507,cpfk_part_lineitem#6508,cfpk_lineitem_part#6509,cpfk_partsupp_lineitem#6510,cfpk_lineitem_orders#6511,cval_lineitem_l_quantity#6512,cval_lineitem_l_extendedprice#6513,cval_lineitem_l_discount#6514,cval_lineitem_l_tax#6515,cval_lineitem_l_returnflag#6516,cval_lineitem_l_linestatus#6517,cval_lineitem_l_commitdate#6518,cval_lineitem_l_receiptdate#6519,cval_lineitem_l_shipinstruct#6520,cval_lineitem_l_shipmode#6521,cval_lineitem_l_comment#6522,cval_lineitem_l_shipdate#6523,cl_quantity#6524,cl_extendedprice#6525,cl_discount#6526,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 362466ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/11 06:39:01 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:39:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6723L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 06:39:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6723L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#6725 AS rid_0#6758, cpfk_orders_lineitem#6726 AS cpfk_orders_lineitem_0#6759, cpfk_supplier_lineitem#6727 AS cpfk_supplier_lineitem_0#6760, cfpk_lineitem_supplier#6728 AS cfpk_lineitem_supplier_0#6761, cfpk_lineitem_partsupp#6729 AS cfpk_lineitem_partsupp_0#6762, cpfk_part_lineitem#6730 AS cpfk_part_lineitem_0#6763, cfpk_lineitem_part#6731 AS cfpk_lineitem_part_0#6764, cpfk_partsupp_lineitem#6732 AS cpfk_partsupp_lineitem_0#6765, cfpk_lineitem_orders#6733 AS cfpk_lineitem_orders_0#6766, cval_lineitem_l_quantity#6734 AS cval_lineitem_l_quantity_0#6767, cval_lineitem_l_extendedprice#6735 AS cval_lineitem_l_extendedprice_0#6768, cval_lineitem_l_discount#6736 AS cval_lineitem_l_discount_0#6769, cval_lineitem_l_tax#6737 AS cval_lineitem_l_tax_0#6770, cval_lineitem_l_returnflag#6738 AS cval_lineitem_l_returnflag_0#6771, cval_lineitem_l_linestatus#6739 AS cval_lineitem_l_linestatus_0#6772, cval_lineitem_l_commitdate#6740 AS cval_lineitem_l_commitdate_0#6773, cval_lineitem_l_receiptdate#6741 AS cval_lineitem_l_receiptdate_0#6774, cval_lineitem_l_shipinstruct#6742 AS cval_lineitem_l_shipinstruct_0#6775, cval_lineitem_l_shipmode#6743 AS cval_lineitem_l_shipmode_0#6776, cval_lineitem_l_comment#6744 AS cval_lineitem_l_comment_0#6777, cval_lineitem_l_shipdate#6745 AS cval_lineitem_l_shipdate_0#6778, cl_quantity#6746 AS cl_quantity_0#6779, cl_extendedprice#6747 AS cl_extendedprice_0#6780, cl_discount#6748 AS cl_discount_0#6781, ... 9 more fields]
            :  :  +- Relation[rid#6725,cpfk_orders_lineitem#6726,cpfk_supplier_lineitem#6727,cfpk_lineitem_supplier#6728,cfpk_lineitem_partsupp#6729,cpfk_part_lineitem#6730,cfpk_lineitem_part#6731,cpfk_partsupp_lineitem#6732,cfpk_lineitem_orders#6733,cval_lineitem_l_quantity#6734,cval_lineitem_l_extendedprice#6735,cval_lineitem_l_discount#6736,cval_lineitem_l_tax#6737,cval_lineitem_l_returnflag#6738,cval_lineitem_l_linestatus#6739,cval_lineitem_l_commitdate#6740,cval_lineitem_l_receiptdate#6741,cval_lineitem_l_shipinstruct#6742,cval_lineitem_l_shipmode#6743,cval_lineitem_l_comment#6744,cval_lineitem_l_shipdate#6745,cl_quantity#6746,cl_extendedprice#6747,cl_discount#6748,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#6791 AS rid_0#6824, cpfk_orders_lineitem#6792 AS cpfk_orders_lineitem_0#6825, cpfk_supplier_lineitem#6793 AS cpfk_supplier_lineitem_0#6826, cfpk_lineitem_supplier#6794 AS cfpk_lineitem_supplier_0#6827, cfpk_lineitem_partsupp#6795 AS cfpk_lineitem_partsupp_0#6828, cpfk_part_lineitem#6796 AS cpfk_part_lineitem_0#6829, cfpk_lineitem_part#6797 AS cfpk_lineitem_part_0#6830, cpfk_partsupp_lineitem#6798 AS cpfk_partsupp_lineitem_0#6831, cfpk_lineitem_orders#6799 AS cfpk_lineitem_orders_0#6832, cval_lineitem_l_quantity#6800 AS cval_lineitem_l_quantity_0#6833, cval_lineitem_l_extendedprice#6801 AS cval_lineitem_l_extendedprice_0#6834, cval_lineitem_l_discount#6802 AS cval_lineitem_l_discount_0#6835, cval_lineitem_l_tax#6803 AS cval_lineitem_l_tax_0#6836, cval_lineitem_l_returnflag#6804 AS cval_lineitem_l_returnflag_0#6837, cval_lineitem_l_linestatus#6805 AS cval_lineitem_l_linestatus_0#6838, cval_lineitem_l_commitdate#6806 AS cval_lineitem_l_commitdate_0#6839, cval_lineitem_l_receiptdate#6807 AS cval_lineitem_l_receiptdate_0#6840, cval_lineitem_l_shipinstruct#6808 AS cval_lineitem_l_shipinstruct_0#6841, cval_lineitem_l_shipmode#6809 AS cval_lineitem_l_shipmode_0#6842, cval_lineitem_l_comment#6810 AS cval_lineitem_l_comment_0#6843, cval_lineitem_l_shipdate#6811 AS cval_lineitem_l_shipdate_0#6844, cl_quantity#6812 AS cl_quantity_0#6845, cl_extendedprice#6813 AS cl_extendedprice_0#6846, cl_discount#6814 AS cl_discount_0#6847, ... 9 more fields]
            :        +- Relation[rid#6791,cpfk_orders_lineitem#6792,cpfk_supplier_lineitem#6793,cfpk_lineitem_supplier#6794,cfpk_lineitem_partsupp#6795,cpfk_part_lineitem#6796,cfpk_lineitem_part#6797,cpfk_partsupp_lineitem#6798,cfpk_lineitem_orders#6799,cval_lineitem_l_quantity#6800,cval_lineitem_l_extendedprice#6801,cval_lineitem_l_discount#6802,cval_lineitem_l_tax#6803,cval_lineitem_l_returnflag#6804,cval_lineitem_l_linestatus#6805,cval_lineitem_l_commitdate#6806,cval_lineitem_l_receiptdate#6807,cval_lineitem_l_shipinstruct#6808,cval_lineitem_l_shipmode#6809,cval_lineitem_l_comment#6810,cval_lineitem_l_shipdate#6811,cl_quantity#6812,cl_extendedprice#6813,cl_discount#6814,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#6857 AS rid_1#6874, cpfk_customer_orders#6858 AS cpfk_customer_orders_1#6875, cfpk_orders_customer#6859 AS cfpk_orders_customer_1#6876, cval_orders_o_orderstatus#6860 AS cval_orders_o_orderstatus_1#6877, cval_orders_o_totalprice#6861 AS cval_orders_o_totalprice_1#6878, cval_orders_o_orderpriority#6862 AS cval_orders_o_orderpriority_1#6879, cval_orders_o_clerk#6863 AS cval_orders_o_clerk_1#6880, cval_orders_o_shippriority#6864 AS cval_orders_o_shippriority_1#6881, cval_orders_o_comment#6865 AS cval_orders_o_comment_1#6882, cval_orders_o_orderdate#6866 AS cval_orders_o_orderdate_1#6883, co_orderstatus#6867 AS co_orderstatus_1#6884, co_totalprice#6868 AS co_totalprice_1#6885, co_orderpriority#6869 AS co_orderpriority_1#6886, co_clerk#6870 AS co_clerk_1#6887, co_shippriority#6871 AS co_shippriority_1#6888, co_comment#6872 AS co_comment_1#6889, co_orderdate#6873 AS co_orderdate_1#6890]
               +- Relation[rid#6857,cpfk_customer_orders#6858,cfpk_orders_customer#6859,cval_orders_o_orderstatus#6860,cval_orders_o_totalprice#6861,cval_orders_o_orderpriority#6862,cval_orders_o_clerk#6863,cval_orders_o_shippriority#6864,cval_orders_o_comment#6865,cval_orders_o_orderdate#6866,co_orderstatus#6867,co_totalprice#6868,co_orderpriority#6869,co_clerk#6870,co_shippriority#6871,co_comment#6872,co_orderdate#6873] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 21442ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/11 06:39:22 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:39:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6946L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 06:39:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#6946L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#6948 AS rid_0#6981, cpfk_orders_lineitem#6949 AS cpfk_orders_lineitem_0#6982, cpfk_supplier_lineitem#6950 AS cpfk_supplier_lineitem_0#6983, cfpk_lineitem_supplier#6951 AS cfpk_lineitem_supplier_0#6984, cfpk_lineitem_partsupp#6952 AS cfpk_lineitem_partsupp_0#6985, cpfk_part_lineitem#6953 AS cpfk_part_lineitem_0#6986, cfpk_lineitem_part#6954 AS cfpk_lineitem_part_0#6987, cpfk_partsupp_lineitem#6955 AS cpfk_partsupp_lineitem_0#6988, cfpk_lineitem_orders#6956 AS cfpk_lineitem_orders_0#6989, cval_lineitem_l_quantity#6957 AS cval_lineitem_l_quantity_0#6990, cval_lineitem_l_extendedprice#6958 AS cval_lineitem_l_extendedprice_0#6991, cval_lineitem_l_discount#6959 AS cval_lineitem_l_discount_0#6992, cval_lineitem_l_tax#6960 AS cval_lineitem_l_tax_0#6993, cval_lineitem_l_returnflag#6961 AS cval_lineitem_l_returnflag_0#6994, cval_lineitem_l_linestatus#6962 AS cval_lineitem_l_linestatus_0#6995, cval_lineitem_l_commitdate#6963 AS cval_lineitem_l_commitdate_0#6996, cval_lineitem_l_receiptdate#6964 AS cval_lineitem_l_receiptdate_0#6997, cval_lineitem_l_shipinstruct#6965 AS cval_lineitem_l_shipinstruct_0#6998, cval_lineitem_l_shipmode#6966 AS cval_lineitem_l_shipmode_0#6999, cval_lineitem_l_comment#6967 AS cval_lineitem_l_comment_0#7000, cval_lineitem_l_shipdate#6968 AS cval_lineitem_l_shipdate_0#7001, cl_quantity#6969 AS cl_quantity_0#7002, cl_extendedprice#6970 AS cl_extendedprice_0#7003, cl_discount#6971 AS cl_discount_0#7004, ... 9 more fields]
         +- Relation[rid#6948,cpfk_orders_lineitem#6949,cpfk_supplier_lineitem#6950,cfpk_lineitem_supplier#6951,cfpk_lineitem_partsupp#6952,cpfk_part_lineitem#6953,cfpk_lineitem_part#6954,cpfk_partsupp_lineitem#6955,cfpk_lineitem_orders#6956,cval_lineitem_l_quantity#6957,cval_lineitem_l_extendedprice#6958,cval_lineitem_l_discount#6959,cval_lineitem_l_tax#6960,cval_lineitem_l_returnflag#6961,cval_lineitem_l_linestatus#6962,cval_lineitem_l_commitdate#6963,cval_lineitem_l_receiptdate#6964,cval_lineitem_l_shipinstruct#6965,cval_lineitem_l_shipmode#6966,cval_lineitem_l_comment#6967,cval_lineitem_l_shipdate#6968,cl_quantity#6969,cl_extendedprice#6970,cl_discount#6971,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 3163ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/11 06:39:25 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:39:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7052L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 06:39:25 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:39:25 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:39:26 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:39:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:39:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:39:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:39:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:39:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:39:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:39:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:39:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:39:26 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:39:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:39:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7052L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#7054 AS rid_0#7071, cval_part_p_name#7055 AS cval_part_p_name_0#7072, cval_part_p_mfgr#7056 AS cval_part_p_mfgr_0#7073, cval_part_p_type#7057 AS cval_part_p_type_0#7074, cval_part_p_size#7058 AS cval_part_p_size_0#7075, cval_part_p_container#7059 AS cval_part_p_container_0#7076, cval_part_p_retailprice#7060 AS cval_part_p_retailprice_0#7077, cval_part_p_comment#7061 AS cval_part_p_comment_0#7078, cval_part_p_brand#7062 AS cval_part_p_brand_0#7079, cp_name#7063 AS cp_name_0#7080, cp_mfgr#7064 AS cp_mfgr_0#7081, cp_type#7065 AS cp_type_0#7082, cp_size#7066 AS cp_size_0#7083, cp_container#7067 AS cp_container_0#7084, cp_retailprice#7068 AS cp_retailprice_0#7085, cp_comment#7069 AS cp_comment_0#7086, cp_brand#7070 AS cp_brand_0#7087]
            :  :  :  :  +- Relation[rid#7054,cval_part_p_name#7055,cval_part_p_mfgr#7056,cval_part_p_type#7057,cval_part_p_size#7058,cval_part_p_container#7059,cval_part_p_retailprice#7060,cval_part_p_comment#7061,cval_part_p_brand#7062,cp_name#7063,cp_mfgr#7064,cp_type#7065,cp_size#7066,cp_container#7067,cp_retailprice#7068,cp_comment#7069,cp_brand#7070] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#7088 AS rid_0#7105, cval_part_p_name#7089 AS cval_part_p_name_0#7106, cval_part_p_mfgr#7090 AS cval_part_p_mfgr_0#7107, cval_part_p_type#7091 AS cval_part_p_type_0#7108, cval_part_p_size#7092 AS cval_part_p_size_0#7109, cval_part_p_container#7093 AS cval_part_p_container_0#7110, cval_part_p_retailprice#7094 AS cval_part_p_retailprice_0#7111, cval_part_p_comment#7095 AS cval_part_p_comment_0#7112, cval_part_p_brand#7096 AS cval_part_p_brand_0#7113, cp_name#7097 AS cp_name_0#7114, cp_mfgr#7098 AS cp_mfgr_0#7115, cp_type#7099 AS cp_type_0#7116, cp_size#7100 AS cp_size_0#7117, cp_container#7101 AS cp_container_0#7118, cp_retailprice#7102 AS cp_retailprice_0#7119, cp_comment#7103 AS cp_comment_0#7120, cp_brand#7104 AS cp_brand_0#7121]
            :  :  :        +- Relation[rid#7088,cval_part_p_name#7089,cval_part_p_mfgr#7090,cval_part_p_type#7091,cval_part_p_size#7092,cval_part_p_container#7093,cval_part_p_retailprice#7094,cval_part_p_comment#7095,cval_part_p_brand#7096,cp_name#7097,cp_mfgr#7098,cp_type#7099,cp_size#7100,cp_container#7101,cp_retailprice#7102,cp_comment#7103,cp_brand#7104] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :     :- Project [rid#7144 AS rid_0#7161, cval_part_p_name#7145 AS cval_part_p_name_0#7162, cval_part_p_mfgr#7146 AS cval_part_p_mfgr_0#7163, cval_part_p_type#7147 AS cval_part_p_type_0#7164, cval_part_p_size#7148 AS cval_part_p_size_0#7165, cval_part_p_container#7149 AS cval_part_p_container_0#7166, cval_part_p_retailprice#7150 AS cval_part_p_retailprice_0#7167, cval_part_p_comment#7151 AS cval_part_p_comment_0#7168, cval_part_p_brand#7152 AS cval_part_p_brand_0#7169, cp_name#7153 AS cp_name_0#7170, cp_mfgr#7154 AS cp_mfgr_0#7171, cp_type#7155 AS cp_type_0#7172, cp_size#7156 AS cp_size_0#7173, cp_container#7157 AS cp_container_0#7174, cp_retailprice#7158 AS cp_retailprice_0#7175, cp_comment#7159 AS cp_comment_0#7176, cp_brand#7160 AS cp_brand_0#7177]
            :  :     :  +- Relation[rid#7144,cval_part_p_name#7145,cval_part_p_mfgr#7146,cval_part_p_type#7147,cval_part_p_size#7148,cval_part_p_container#7149,cval_part_p_retailprice#7150,cval_part_p_comment#7151,cval_part_p_brand#7152,cp_name#7153,cp_mfgr#7154,cp_type#7155,cp_size#7156,cp_container#7157,cp_retailprice#7158,cp_comment#7159,cp_brand#7160] JDBCRelation(tpart) [numPartitions=1]
            :  :     +- Project [rid#7178 AS rid_1#7189, cpfk_part_partsupp#7179 AS cpfk_part_partsupp_1#7190, cfpk_partsupp_part#7180 AS cfpk_partsupp_part_1#7191, cpfk_supplier_partsupp#7181 AS cpfk_supplier_partsupp_1#7192, cfpk_partsupp_supplier#7182 AS cfpk_partsupp_supplier_1#7193, cval_partsupp_ps_availqty#7183 AS cval_partsupp_ps_availqty_1#7194, cval_partsupp_ps_supplycost#7184 AS cval_partsupp_ps_supplycost_1#7195, cval_partsupp_ps_comment#7185 AS cval_partsupp_ps_comment_1#7196, cps_availqty#7186 AS cps_availqty_1#7197, cps_supplycost#7187 AS cps_supplycost_1#7198, cps_comment#7188 AS cps_comment_1#7199]
            :  :        +- Relation[rid#7178,cpfk_part_partsupp#7179,cfpk_partsupp_part#7180,cpfk_supplier_partsupp#7181,cfpk_partsupp_supplier#7182,cval_partsupp_ps_availqty#7183,cval_partsupp_ps_supplycost#7184,cval_partsupp_ps_comment#7185,cps_availqty#7186,cps_supplycost#7187,cps_comment#7188] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#7122 AS rid_1#7133, cpfk_part_partsupp#7123 AS cpfk_part_partsupp_1#7134, cfpk_partsupp_part#7124 AS cfpk_partsupp_part_1#7135, cpfk_supplier_partsupp#7125 AS cpfk_supplier_partsupp_1#7136, cfpk_partsupp_supplier#7126 AS cfpk_partsupp_supplier_1#7137, cval_partsupp_ps_availqty#7127 AS cval_partsupp_ps_availqty_1#7138, cval_partsupp_ps_supplycost#7128 AS cval_partsupp_ps_supplycost_1#7139, cval_partsupp_ps_comment#7129 AS cval_partsupp_ps_comment_1#7140, cps_availqty#7130 AS cps_availqty_1#7141, cps_supplycost#7131 AS cps_supplycost_1#7142, cps_comment#7132 AS cps_comment_1#7143]
            :     +- Relation[rid#7122,cpfk_part_partsupp#7123,cfpk_partsupp_part#7124,cpfk_supplier_partsupp#7125,cfpk_partsupp_supplier#7126,cval_partsupp_ps_availqty#7127,cval_partsupp_ps_supplycost#7128,cval_partsupp_ps_comment#7129,cps_availqty#7130,cps_supplycost#7131,cps_comment#7132] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#7200 AS rid_2#7207, cpfk_region_nation#7201 AS cpfk_region_nation_2#7208, cfpk_nation_region#7202 AS cfpk_nation_region_2#7209, cval_nation_n_name#7203 AS cval_nation_n_name_2#7210, cval_nation_n_comment#7204 AS cval_nation_n_comment_2#7211, cn_name#7205 AS cn_name_2#7212, cn_comment#7206 AS cn_comment_2#7213]
               :  :  :  +- Relation[rid#7200,cpfk_region_nation#7201,cfpk_nation_region#7202,cval_nation_n_name#7203,cval_nation_n_comment#7204,cn_name#7205,cn_comment#7206] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#7214 AS rid_2#7221, cpfk_region_nation#7215 AS cpfk_region_nation_2#7222, cfpk_nation_region#7216 AS cfpk_nation_region_2#7223, cval_nation_n_name#7217 AS cval_nation_n_name_2#7224, cval_nation_n_comment#7218 AS cval_nation_n_comment_2#7225, cn_name#7219 AS cn_name_2#7226, cn_comment#7220 AS cn_comment_2#7227]
               :  :        +- Relation[rid#7214,cpfk_region_nation#7215,cfpk_nation_region#7216,cval_nation_n_name#7217,cval_nation_n_comment#7218,cn_name#7219,cn_comment#7220] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :     :- Project [rid#7254 AS rid_2#7261, cpfk_region_nation#7255 AS cpfk_region_nation_2#7262, cfpk_nation_region#7256 AS cfpk_nation_region_2#7263, cval_nation_n_name#7257 AS cval_nation_n_name_2#7264, cval_nation_n_comment#7258 AS cval_nation_n_comment_2#7265, cn_name#7259 AS cn_name_2#7266, cn_comment#7260 AS cn_comment_2#7267]
               :     :  +- Relation[rid#7254,cpfk_region_nation#7255,cfpk_nation_region#7256,cval_nation_n_name#7257,cval_nation_n_comment#7258,cn_name#7259,cn_comment#7260] JDBCRelation(tnation) [numPartitions=1]
               :     +- Project [rid#7268 AS rid_3#7281, cpfk_nation_supplier#7269 AS cpfk_nation_supplier_3#7282, cfpk_supplier_nation#7270 AS cfpk_supplier_nation_3#7283, cval_supplier_s_name#7271 AS cval_supplier_s_name_3#7284, cval_supplier_s_address#7272 AS cval_supplier_s_address_3#7285, cval_supplier_s_phone#7273 AS cval_supplier_s_phone_3#7286, cval_supplier_s_acctbal#7274 AS cval_supplier_s_acctbal_3#7287, cval_supplier_s_comment#7275 AS cval_supplier_s_comment_3#7288, cs_name#7276 AS cs_name_3#7289, cs_address#7277 AS cs_address_3#7290, cs_phone#7278 AS cs_phone_3#7291, cs_acctbal#7279 AS cs_acctbal_3#7292, cs_comment#7280 AS cs_comment_3#7293]
               :        +- Relation[rid#7268,cpfk_nation_supplier#7269,cfpk_supplier_nation#7270,cval_supplier_s_name#7271,cval_supplier_s_address#7272,cval_supplier_s_phone#7273,cval_supplier_s_acctbal#7274,cval_supplier_s_comment#7275,cs_name#7276,cs_address#7277,cs_phone#7278,cs_acctbal#7279,cs_comment#7280] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#7228 AS rid_3#7241, cpfk_nation_supplier#7229 AS cpfk_nation_supplier_3#7242, cfpk_supplier_nation#7230 AS cfpk_supplier_nation_3#7243, cval_supplier_s_name#7231 AS cval_supplier_s_name_3#7244, cval_supplier_s_address#7232 AS cval_supplier_s_address_3#7245, cval_supplier_s_phone#7233 AS cval_supplier_s_phone_3#7246, cval_supplier_s_acctbal#7234 AS cval_supplier_s_acctbal_3#7247, cval_supplier_s_comment#7235 AS cval_supplier_s_comment_3#7248, cs_name#7236 AS cs_name_3#7249, cs_address#7237 AS cs_address_3#7250, cs_phone#7238 AS cs_phone_3#7251, cs_acctbal#7239 AS cs_acctbal_3#7252, cs_comment#7240 AS cs_comment_3#7253]
                  +- Relation[rid#7228,cpfk_nation_supplier#7229,cfpk_supplier_nation#7230,cval_supplier_s_name#7231,cval_supplier_s_address#7232,cval_supplier_s_phone#7233,cval_supplier_s_acctbal#7234,cval_supplier_s_comment#7235,cs_name#7236,cs_address#7237,cs_phone#7238,cs_acctbal#7239,cs_comment#7240] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 11456ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/11 06:39:37 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:39:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7349L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 06:39:37 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:39:37 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:39:37 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:39:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7349L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#7351 AS rid_0#7368, cval_part_p_name#7352 AS cval_part_p_name_0#7369, cval_part_p_mfgr#7353 AS cval_part_p_mfgr_0#7370, cval_part_p_type#7354 AS cval_part_p_type_0#7371, cval_part_p_size#7355 AS cval_part_p_size_0#7372, cval_part_p_container#7356 AS cval_part_p_container_0#7373, cval_part_p_retailprice#7357 AS cval_part_p_retailprice_0#7374, cval_part_p_comment#7358 AS cval_part_p_comment_0#7375, cval_part_p_brand#7359 AS cval_part_p_brand_0#7376, cp_name#7360 AS cp_name_0#7377, cp_mfgr#7361 AS cp_mfgr_0#7378, cp_type#7362 AS cp_type_0#7379, cp_size#7363 AS cp_size_0#7380, cp_container#7364 AS cp_container_0#7381, cp_retailprice#7365 AS cp_retailprice_0#7382, cp_comment#7366 AS cp_comment_0#7383, cp_brand#7367 AS cp_brand_0#7384]
         :  :  :  +- Relation[rid#7351,cval_part_p_name#7352,cval_part_p_mfgr#7353,cval_part_p_type#7354,cval_part_p_size#7355,cval_part_p_container#7356,cval_part_p_retailprice#7357,cval_part_p_comment#7358,cval_part_p_brand#7359,cp_name#7360,cp_mfgr#7361,cp_type#7362,cp_size#7363,cp_container#7364,cp_retailprice#7365,cp_comment#7366,cp_brand#7367] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#7385 AS rid_0#7402, cval_part_p_name#7386 AS cval_part_p_name_0#7403, cval_part_p_mfgr#7387 AS cval_part_p_mfgr_0#7404, cval_part_p_type#7388 AS cval_part_p_type_0#7405, cval_part_p_size#7389 AS cval_part_p_size_0#7406, cval_part_p_container#7390 AS cval_part_p_container_0#7407, cval_part_p_retailprice#7391 AS cval_part_p_retailprice_0#7408, cval_part_p_comment#7392 AS cval_part_p_comment_0#7409, cval_part_p_brand#7393 AS cval_part_p_brand_0#7410, cp_name#7394 AS cp_name_0#7411, cp_mfgr#7395 AS cp_mfgr_0#7412, cp_type#7396 AS cp_type_0#7413, cp_size#7397 AS cp_size_0#7414, cp_container#7398 AS cp_container_0#7415, cp_retailprice#7399 AS cp_retailprice_0#7416, cp_comment#7400 AS cp_comment_0#7417, cp_brand#7401 AS cp_brand_0#7418]
         :  :        +- Relation[rid#7385,cval_part_p_name#7386,cval_part_p_mfgr#7387,cval_part_p_type#7388,cval_part_p_size#7389,cval_part_p_container#7390,cval_part_p_retailprice#7391,cval_part_p_comment#7392,cval_part_p_brand#7393,cp_name#7394,cp_mfgr#7395,cp_type#7396,cp_size#7397,cp_container#7398,cp_retailprice#7399,cp_comment#7400,cp_brand#7401] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :     :- Project [rid#7441 AS rid_0#7458, cval_part_p_name#7442 AS cval_part_p_name_0#7459, cval_part_p_mfgr#7443 AS cval_part_p_mfgr_0#7460, cval_part_p_type#7444 AS cval_part_p_type_0#7461, cval_part_p_size#7445 AS cval_part_p_size_0#7462, cval_part_p_container#7446 AS cval_part_p_container_0#7463, cval_part_p_retailprice#7447 AS cval_part_p_retailprice_0#7464, cval_part_p_comment#7448 AS cval_part_p_comment_0#7465, cval_part_p_brand#7449 AS cval_part_p_brand_0#7466, cp_name#7450 AS cp_name_0#7467, cp_mfgr#7451 AS cp_mfgr_0#7468, cp_type#7452 AS cp_type_0#7469, cp_size#7453 AS cp_size_0#7470, cp_container#7454 AS cp_container_0#7471, cp_retailprice#7455 AS cp_retailprice_0#7472, cp_comment#7456 AS cp_comment_0#7473, cp_brand#7457 AS cp_brand_0#7474]
         :     :  +- Relation[rid#7441,cval_part_p_name#7442,cval_part_p_mfgr#7443,cval_part_p_type#7444,cval_part_p_size#7445,cval_part_p_container#7446,cval_part_p_retailprice#7447,cval_part_p_comment#7448,cval_part_p_brand#7449,cp_name#7450,cp_mfgr#7451,cp_type#7452,cp_size#7453,cp_container#7454,cp_retailprice#7455,cp_comment#7456,cp_brand#7457] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#7475 AS rid_1#7486, cpfk_part_partsupp#7476 AS cpfk_part_partsupp_1#7487, cfpk_partsupp_part#7477 AS cfpk_partsupp_part_1#7488, cpfk_supplier_partsupp#7478 AS cpfk_supplier_partsupp_1#7489, cfpk_partsupp_supplier#7479 AS cfpk_partsupp_supplier_1#7490, cval_partsupp_ps_availqty#7480 AS cval_partsupp_ps_availqty_1#7491, cval_partsupp_ps_supplycost#7481 AS cval_partsupp_ps_supplycost_1#7492, cval_partsupp_ps_comment#7482 AS cval_partsupp_ps_comment_1#7493, cps_availqty#7483 AS cps_availqty_1#7494, cps_supplycost#7484 AS cps_supplycost_1#7495, cps_comment#7485 AS cps_comment_1#7496]
         :        +- Relation[rid#7475,cpfk_part_partsupp#7476,cfpk_partsupp_part#7477,cpfk_supplier_partsupp#7478,cfpk_partsupp_supplier#7479,cval_partsupp_ps_availqty#7480,cval_partsupp_ps_supplycost#7481,cval_partsupp_ps_comment#7482,cps_availqty#7483,cps_supplycost#7484,cps_comment#7485] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#7419 AS rid_1#7430, cpfk_part_partsupp#7420 AS cpfk_part_partsupp_1#7431, cfpk_partsupp_part#7421 AS cfpk_partsupp_part_1#7432, cpfk_supplier_partsupp#7422 AS cpfk_supplier_partsupp_1#7433, cfpk_partsupp_supplier#7423 AS cfpk_partsupp_supplier_1#7434, cval_partsupp_ps_availqty#7424 AS cval_partsupp_ps_availqty_1#7435, cval_partsupp_ps_supplycost#7425 AS cval_partsupp_ps_supplycost_1#7436, cval_partsupp_ps_comment#7426 AS cval_partsupp_ps_comment_1#7437, cps_availqty#7427 AS cps_availqty_1#7438, cps_supplycost#7428 AS cps_supplycost_1#7439, cps_comment#7429 AS cps_comment_1#7440]
            +- Relation[rid#7419,cpfk_part_partsupp#7420,cfpk_partsupp_part#7421,cpfk_supplier_partsupp#7422,cfpk_partsupp_supplier#7423,cval_partsupp_ps_availqty#7424,cval_partsupp_ps_supplycost#7425,cval_partsupp_ps_comment#7426,cps_availqty#7427,cps_supplycost#7428,cps_comment#7429] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 10703ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/11 06:39:48 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:39:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7531L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 06:39:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7531L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#7533 AS rid_0#7550, cval_part_p_name#7534 AS cval_part_p_name_0#7551, cval_part_p_mfgr#7535 AS cval_part_p_mfgr_0#7552, cval_part_p_type#7536 AS cval_part_p_type_0#7553, cval_part_p_size#7537 AS cval_part_p_size_0#7554, cval_part_p_container#7538 AS cval_part_p_container_0#7555, cval_part_p_retailprice#7539 AS cval_part_p_retailprice_0#7556, cval_part_p_comment#7540 AS cval_part_p_comment_0#7557, cval_part_p_brand#7541 AS cval_part_p_brand_0#7558, cp_name#7542 AS cp_name_0#7559, cp_mfgr#7543 AS cp_mfgr_0#7560, cp_type#7544 AS cp_type_0#7561, cp_size#7545 AS cp_size_0#7562, cp_container#7546 AS cp_container_0#7563, cp_retailprice#7547 AS cp_retailprice_0#7564, cp_comment#7548 AS cp_comment_0#7565, cp_brand#7549 AS cp_brand_0#7566]
         :  :  +- Relation[rid#7533,cval_part_p_name#7534,cval_part_p_mfgr#7535,cval_part_p_type#7536,cval_part_p_size#7537,cval_part_p_container#7538,cval_part_p_retailprice#7539,cval_part_p_comment#7540,cval_part_p_brand#7541,cp_name#7542,cp_mfgr#7543,cp_type#7544,cp_size#7545,cp_container#7546,cp_retailprice#7547,cp_comment#7548,cp_brand#7549] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#7633 AS rid_0#7650, cval_part_p_name#7634 AS cval_part_p_name_0#7651, cval_part_p_mfgr#7635 AS cval_part_p_mfgr_0#7652, cval_part_p_type#7636 AS cval_part_p_type_0#7653, cval_part_p_size#7637 AS cval_part_p_size_0#7654, cval_part_p_container#7638 AS cval_part_p_container_0#7655, cval_part_p_retailprice#7639 AS cval_part_p_retailprice_0#7656, cval_part_p_comment#7640 AS cval_part_p_comment_0#7657, cval_part_p_brand#7641 AS cval_part_p_brand_0#7658, cp_name#7642 AS cp_name_0#7659, cp_mfgr#7643 AS cp_mfgr_0#7660, cp_type#7644 AS cp_type_0#7661, cp_size#7645 AS cp_size_0#7662, cp_container#7646 AS cp_container_0#7663, cp_retailprice#7647 AS cp_retailprice_0#7664, cp_comment#7648 AS cp_comment_0#7665, cp_brand#7649 AS cp_brand_0#7666]
         :     :  +- Relation[rid#7633,cval_part_p_name#7634,cval_part_p_mfgr#7635,cval_part_p_type#7636,cval_part_p_size#7637,cval_part_p_container#7638,cval_part_p_retailprice#7639,cval_part_p_comment#7640,cval_part_p_brand#7641,cp_name#7642,cp_mfgr#7643,cp_type#7644,cp_size#7645,cp_container#7646,cp_retailprice#7647,cp_comment#7648,cp_brand#7649] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#7667 AS rid_1#7700, cpfk_orders_lineitem#7668 AS cpfk_orders_lineitem_1#7701, cpfk_supplier_lineitem#7669 AS cpfk_supplier_lineitem_1#7702, cfpk_lineitem_supplier#7670 AS cfpk_lineitem_supplier_1#7703, cfpk_lineitem_partsupp#7671 AS cfpk_lineitem_partsupp_1#7704, cpfk_part_lineitem#7672 AS cpfk_part_lineitem_1#7705, cfpk_lineitem_part#7673 AS cfpk_lineitem_part_1#7706, cpfk_partsupp_lineitem#7674 AS cpfk_partsupp_lineitem_1#7707, cfpk_lineitem_orders#7675 AS cfpk_lineitem_orders_1#7708, cval_lineitem_l_quantity#7676 AS cval_lineitem_l_quantity_1#7709, cval_lineitem_l_extendedprice#7677 AS cval_lineitem_l_extendedprice_1#7710, cval_lineitem_l_discount#7678 AS cval_lineitem_l_discount_1#7711, cval_lineitem_l_tax#7679 AS cval_lineitem_l_tax_1#7712, cval_lineitem_l_returnflag#7680 AS cval_lineitem_l_returnflag_1#7713, cval_lineitem_l_linestatus#7681 AS cval_lineitem_l_linestatus_1#7714, cval_lineitem_l_commitdate#7682 AS cval_lineitem_l_commitdate_1#7715, cval_lineitem_l_receiptdate#7683 AS cval_lineitem_l_receiptdate_1#7716, cval_lineitem_l_shipinstruct#7684 AS cval_lineitem_l_shipinstruct_1#7717, cval_lineitem_l_shipmode#7685 AS cval_lineitem_l_shipmode_1#7718, cval_lineitem_l_comment#7686 AS cval_lineitem_l_comment_1#7719, cval_lineitem_l_shipdate#7687 AS cval_lineitem_l_shipdate_1#7720, cl_quantity#7688 AS cl_quantity_1#7721, cl_extendedprice#7689 AS cl_extendedprice_1#7722, cl_discount#7690 AS cl_discount_1#7723, ... 9 more fields]
         :        +- Relation[rid#7667,cpfk_orders_lineitem#7668,cpfk_supplier_lineitem#7669,cfpk_lineitem_supplier#7670,cfpk_lineitem_partsupp#7671,cpfk_part_lineitem#7672,cfpk_lineitem_part#7673,cpfk_partsupp_lineitem#7674,cfpk_lineitem_orders#7675,cval_lineitem_l_quantity#7676,cval_lineitem_l_extendedprice#7677,cval_lineitem_l_discount#7678,cval_lineitem_l_tax#7679,cval_lineitem_l_returnflag#7680,cval_lineitem_l_linestatus#7681,cval_lineitem_l_commitdate#7682,cval_lineitem_l_receiptdate#7683,cval_lineitem_l_shipinstruct#7684,cval_lineitem_l_shipmode#7685,cval_lineitem_l_comment#7686,cval_lineitem_l_shipdate#7687,cl_quantity#7688,cl_extendedprice#7689,cl_discount#7690,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7567 AS rid_1#7600, cpfk_orders_lineitem#7568 AS cpfk_orders_lineitem_1#7601, cpfk_supplier_lineitem#7569 AS cpfk_supplier_lineitem_1#7602, cfpk_lineitem_supplier#7570 AS cfpk_lineitem_supplier_1#7603, cfpk_lineitem_partsupp#7571 AS cfpk_lineitem_partsupp_1#7604, cpfk_part_lineitem#7572 AS cpfk_part_lineitem_1#7605, cfpk_lineitem_part#7573 AS cfpk_lineitem_part_1#7606, cpfk_partsupp_lineitem#7574 AS cpfk_partsupp_lineitem_1#7607, cfpk_lineitem_orders#7575 AS cfpk_lineitem_orders_1#7608, cval_lineitem_l_quantity#7576 AS cval_lineitem_l_quantity_1#7609, cval_lineitem_l_extendedprice#7577 AS cval_lineitem_l_extendedprice_1#7610, cval_lineitem_l_discount#7578 AS cval_lineitem_l_discount_1#7611, cval_lineitem_l_tax#7579 AS cval_lineitem_l_tax_1#7612, cval_lineitem_l_returnflag#7580 AS cval_lineitem_l_returnflag_1#7613, cval_lineitem_l_linestatus#7581 AS cval_lineitem_l_linestatus_1#7614, cval_lineitem_l_commitdate#7582 AS cval_lineitem_l_commitdate_1#7615, cval_lineitem_l_receiptdate#7583 AS cval_lineitem_l_receiptdate_1#7616, cval_lineitem_l_shipinstruct#7584 AS cval_lineitem_l_shipinstruct_1#7617, cval_lineitem_l_shipmode#7585 AS cval_lineitem_l_shipmode_1#7618, cval_lineitem_l_comment#7586 AS cval_lineitem_l_comment_1#7619, cval_lineitem_l_shipdate#7587 AS cval_lineitem_l_shipdate_1#7620, cl_quantity#7588 AS cl_quantity_1#7621, cl_extendedprice#7589 AS cl_extendedprice_1#7622, cl_discount#7590 AS cl_discount_1#7623, ... 9 more fields]
            +- Relation[rid#7567,cpfk_orders_lineitem#7568,cpfk_supplier_lineitem#7569,cfpk_lineitem_supplier#7570,cfpk_lineitem_partsupp#7571,cpfk_part_lineitem#7572,cfpk_lineitem_part#7573,cpfk_partsupp_lineitem#7574,cfpk_lineitem_orders#7575,cval_lineitem_l_quantity#7576,cval_lineitem_l_extendedprice#7577,cval_lineitem_l_discount#7578,cval_lineitem_l_tax#7579,cval_lineitem_l_returnflag#7580,cval_lineitem_l_linestatus#7581,cval_lineitem_l_commitdate#7582,cval_lineitem_l_receiptdate#7583,cval_lineitem_l_shipinstruct#7584,cval_lineitem_l_shipmode#7585,cval_lineitem_l_comment#7586,cval_lineitem_l_shipdate#7587,cl_quantity#7588,cl_extendedprice#7589,cl_discount#7590,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 82893ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 06:41:11 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:41:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7792L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 06:41:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:41:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:41:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:41:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:41:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:41:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:41:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:41:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:41:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:41:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:41:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7792L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#7794 AS rid_0#7801, cpfk_region_nation#7795 AS cpfk_region_nation_0#7802, cfpk_nation_region#7796 AS cfpk_nation_region_0#7803, cval_nation_n_name#7797 AS cval_nation_n_name_0#7804, cval_nation_n_comment#7798 AS cval_nation_n_comment_0#7805, cn_name#7799 AS cn_name_0#7806, cn_comment#7800 AS cn_comment_0#7807]
            :     :     :  :  :  :  :  +- Relation[rid#7794,cpfk_region_nation#7795,cfpk_nation_region#7796,cval_nation_n_name#7797,cval_nation_n_comment#7798,cn_name#7799,cn_comment#7800] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#7834 AS rid_0#7841, cpfk_region_nation#7835 AS cpfk_region_nation_0#7842, cfpk_nation_region#7836 AS cfpk_nation_region_0#7843, cval_nation_n_name#7837 AS cval_nation_n_name_0#7844, cval_nation_n_comment#7838 AS cval_nation_n_comment_0#7845, cn_name#7839 AS cn_name_0#7846, cn_comment#7840 AS cn_comment_0#7847]
            :     :     :  :  :  :     :  +- Relation[rid#7834,cpfk_region_nation#7835,cfpk_nation_region#7836,cval_nation_n_name#7837,cval_nation_n_comment#7838,cn_name#7839,cn_comment#7840] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#7848 AS rid_1#7861, cpfk_nation_supplier#7849 AS cpfk_nation_supplier_1#7862, cfpk_supplier_nation#7850 AS cfpk_supplier_nation_1#7863, cval_supplier_s_name#7851 AS cval_supplier_s_name_1#7864, cval_supplier_s_address#7852 AS cval_supplier_s_address_1#7865, cval_supplier_s_phone#7853 AS cval_supplier_s_phone_1#7866, cval_supplier_s_acctbal#7854 AS cval_supplier_s_acctbal_1#7867, cval_supplier_s_comment#7855 AS cval_supplier_s_comment_1#7868, cs_name#7856 AS cs_name_1#7869, cs_address#7857 AS cs_address_1#7870, cs_phone#7858 AS cs_phone_1#7871, cs_acctbal#7859 AS cs_acctbal_1#7872, cs_comment#7860 AS cs_comment_1#7873]
            :     :     :  :  :  :        +- Relation[rid#7848,cpfk_nation_supplier#7849,cfpk_supplier_nation#7850,cval_supplier_s_name#7851,cval_supplier_s_address#7852,cval_supplier_s_phone#7853,cval_supplier_s_acctbal#7854,cval_supplier_s_comment#7855,cs_name#7856,cs_address#7857,cs_phone#7858,cs_acctbal#7859,cs_comment#7860] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#7808 AS rid_1#7821, cpfk_nation_supplier#7809 AS cpfk_nation_supplier_1#7822, cfpk_supplier_nation#7810 AS cfpk_supplier_nation_1#7823, cval_supplier_s_name#7811 AS cval_supplier_s_name_1#7824, cval_supplier_s_address#7812 AS cval_supplier_s_address_1#7825, cval_supplier_s_phone#7813 AS cval_supplier_s_phone_1#7826, cval_supplier_s_acctbal#7814 AS cval_supplier_s_acctbal_1#7827, cval_supplier_s_comment#7815 AS cval_supplier_s_comment_1#7828, cs_name#7816 AS cs_name_1#7829, cs_address#7817 AS cs_address_1#7830, cs_phone#7818 AS cs_phone_1#7831, cs_acctbal#7819 AS cs_acctbal_1#7832, cs_comment#7820 AS cs_comment_1#7833]
            :     :     :  :  :     +- Relation[rid#7808,cpfk_nation_supplier#7809,cfpk_supplier_nation#7810,cval_supplier_s_name#7811,cval_supplier_s_address#7812,cval_supplier_s_phone#7813,cval_supplier_s_acctbal#7814,cval_supplier_s_comment#7815,cs_name#7816,cs_address#7817,cs_phone#7818,cs_acctbal#7819,cs_comment#7820] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#7940 AS rid_1#7953, cpfk_nation_supplier#7941 AS cpfk_nation_supplier_1#7954, cfpk_supplier_nation#7942 AS cfpk_supplier_nation_1#7955, cval_supplier_s_name#7943 AS cval_supplier_s_name_1#7956, cval_supplier_s_address#7944 AS cval_supplier_s_address_1#7957, cval_supplier_s_phone#7945 AS cval_supplier_s_phone_1#7958, cval_supplier_s_acctbal#7946 AS cval_supplier_s_acctbal_1#7959, cval_supplier_s_comment#7947 AS cval_supplier_s_comment_1#7960, cs_name#7948 AS cs_name_1#7961, cs_address#7949 AS cs_address_1#7962, cs_phone#7950 AS cs_phone_1#7963, cs_acctbal#7951 AS cs_acctbal_1#7964, cs_comment#7952 AS cs_comment_1#7965]
            :     :     :  :     :  +- Relation[rid#7940,cpfk_nation_supplier#7941,cfpk_supplier_nation#7942,cval_supplier_s_name#7943,cval_supplier_s_address#7944,cval_supplier_s_phone#7945,cval_supplier_s_acctbal#7946,cval_supplier_s_comment#7947,cs_name#7948,cs_address#7949,cs_phone#7950,cs_acctbal#7951,cs_comment#7952] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#7966 AS rid_2#7999, cpfk_orders_lineitem#7967 AS cpfk_orders_lineitem_2#8000, cpfk_supplier_lineitem#7968 AS cpfk_supplier_lineitem_2#8001, cfpk_lineitem_supplier#7969 AS cfpk_lineitem_supplier_2#8002, cfpk_lineitem_partsupp#7970 AS cfpk_lineitem_partsupp_2#8003, cpfk_part_lineitem#7971 AS cpfk_part_lineitem_2#8004, cfpk_lineitem_part#7972 AS cfpk_lineitem_part_2#8005, cpfk_partsupp_lineitem#7973 AS cpfk_partsupp_lineitem_2#8006, cfpk_lineitem_orders#7974 AS cfpk_lineitem_orders_2#8007, cval_lineitem_l_quantity#7975 AS cval_lineitem_l_quantity_2#8008, cval_lineitem_l_extendedprice#7976 AS cval_lineitem_l_extendedprice_2#8009, cval_lineitem_l_discount#7977 AS cval_lineitem_l_discount_2#8010, cval_lineitem_l_tax#7978 AS cval_lineitem_l_tax_2#8011, cval_lineitem_l_returnflag#7979 AS cval_lineitem_l_returnflag_2#8012, cval_lineitem_l_linestatus#7980 AS cval_lineitem_l_linestatus_2#8013, cval_lineitem_l_commitdate#7981 AS cval_lineitem_l_commitdate_2#8014, cval_lineitem_l_receiptdate#7982 AS cval_lineitem_l_receiptdate_2#8015, cval_lineitem_l_shipinstruct#7983 AS cval_lineitem_l_shipinstruct_2#8016, cval_lineitem_l_shipmode#7984 AS cval_lineitem_l_shipmode_2#8017, cval_lineitem_l_comment#7985 AS cval_lineitem_l_comment_2#8018, cval_lineitem_l_shipdate#7986 AS cval_lineitem_l_shipdate_2#8019, cl_quantity#7987 AS cl_quantity_2#8020, cl_extendedprice#7988 AS cl_extendedprice_2#8021, cl_discount#7989 AS cl_discount_2#8022, ... 9 more fields]
            :     :     :  :        +- Relation[rid#7966,cpfk_orders_lineitem#7967,cpfk_supplier_lineitem#7968,cfpk_lineitem_supplier#7969,cfpk_lineitem_partsupp#7970,cpfk_part_lineitem#7971,cfpk_lineitem_part#7972,cpfk_partsupp_lineitem#7973,cfpk_lineitem_orders#7974,cval_lineitem_l_quantity#7975,cval_lineitem_l_extendedprice#7976,cval_lineitem_l_discount#7977,cval_lineitem_l_tax#7978,cval_lineitem_l_returnflag#7979,cval_lineitem_l_linestatus#7980,cval_lineitem_l_commitdate#7981,cval_lineitem_l_receiptdate#7982,cval_lineitem_l_shipinstruct#7983,cval_lineitem_l_shipmode#7984,cval_lineitem_l_comment#7985,cval_lineitem_l_shipdate#7986,cl_quantity#7987,cl_extendedprice#7988,cl_discount#7989,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#7874 AS rid_2#7907, cpfk_orders_lineitem#7875 AS cpfk_orders_lineitem_2#7908, cpfk_supplier_lineitem#7876 AS cpfk_supplier_lineitem_2#7909, cfpk_lineitem_supplier#7877 AS cfpk_lineitem_supplier_2#7910, cfpk_lineitem_partsupp#7878 AS cfpk_lineitem_partsupp_2#7911, cpfk_part_lineitem#7879 AS cpfk_part_lineitem_2#7912, cfpk_lineitem_part#7880 AS cfpk_lineitem_part_2#7913, cpfk_partsupp_lineitem#7881 AS cpfk_partsupp_lineitem_2#7914, cfpk_lineitem_orders#7882 AS cfpk_lineitem_orders_2#7915, cval_lineitem_l_quantity#7883 AS cval_lineitem_l_quantity_2#7916, cval_lineitem_l_extendedprice#7884 AS cval_lineitem_l_extendedprice_2#7917, cval_lineitem_l_discount#7885 AS cval_lineitem_l_discount_2#7918, cval_lineitem_l_tax#7886 AS cval_lineitem_l_tax_2#7919, cval_lineitem_l_returnflag#7887 AS cval_lineitem_l_returnflag_2#7920, cval_lineitem_l_linestatus#7888 AS cval_lineitem_l_linestatus_2#7921, cval_lineitem_l_commitdate#7889 AS cval_lineitem_l_commitdate_2#7922, cval_lineitem_l_receiptdate#7890 AS cval_lineitem_l_receiptdate_2#7923, cval_lineitem_l_shipinstruct#7891 AS cval_lineitem_l_shipinstruct_2#7924, cval_lineitem_l_shipmode#7892 AS cval_lineitem_l_shipmode_2#7925, cval_lineitem_l_comment#7893 AS cval_lineitem_l_comment_2#7926, cval_lineitem_l_shipdate#7894 AS cval_lineitem_l_shipdate_2#7927, cl_quantity#7895 AS cl_quantity_2#7928, cl_extendedprice#7896 AS cl_extendedprice_2#7929, cl_discount#7897 AS cl_discount_2#7930, ... 9 more fields]
            :     :     :     +- Relation[rid#7874,cpfk_orders_lineitem#7875,cpfk_supplier_lineitem#7876,cfpk_lineitem_supplier#7877,cfpk_lineitem_partsupp#7878,cpfk_part_lineitem#7879,cfpk_lineitem_part#7880,cpfk_partsupp_lineitem#7881,cfpk_lineitem_orders#7882,cval_lineitem_l_quantity#7883,cval_lineitem_l_extendedprice#7884,cval_lineitem_l_discount#7885,cval_lineitem_l_tax#7886,cval_lineitem_l_returnflag#7887,cval_lineitem_l_linestatus#7888,cval_lineitem_l_commitdate#7889,cval_lineitem_l_receiptdate#7890,cval_lineitem_l_shipinstruct#7891,cval_lineitem_l_shipmode#7892,cval_lineitem_l_comment#7893,cval_lineitem_l_shipdate#7894,cl_quantity#7895,cl_extendedprice#7896,cl_discount#7897,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#8032 AS rid_3#8049, cval_part_p_name#8033 AS cval_part_p_name_3#8050, cval_part_p_mfgr#8034 AS cval_part_p_mfgr_3#8051, cval_part_p_type#8035 AS cval_part_p_type_3#8052, cval_part_p_size#8036 AS cval_part_p_size_3#8053, cval_part_p_container#8037 AS cval_part_p_container_3#8054, cval_part_p_retailprice#8038 AS cval_part_p_retailprice_3#8055, cval_part_p_comment#8039 AS cval_part_p_comment_3#8056, cval_part_p_brand#8040 AS cval_part_p_brand_3#8057, cp_name#8041 AS cp_name_3#8058, cp_mfgr#8042 AS cp_mfgr_3#8059, cp_type#8043 AS cp_type_3#8060, cp_size#8044 AS cp_size_3#8061, cp_container#8045 AS cp_container_3#8062, cp_retailprice#8046 AS cp_retailprice_3#8063, cp_comment#8047 AS cp_comment_3#8064, cp_brand#8048 AS cp_brand_3#8065]
            :     :        +- Relation[rid#8032,cval_part_p_name#8033,cval_part_p_mfgr#8034,cval_part_p_type#8035,cval_part_p_size#8036,cval_part_p_container#8037,cval_part_p_retailprice#8038,cval_part_p_comment#8039,cval_part_p_brand#8040,cp_name#8041,cp_mfgr#8042,cp_type#8043,cp_size#8044,cp_container#8045,cp_retailprice#8046,cp_comment#8047,cp_brand#8048] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#8066 AS rid_4#8077, cpfk_part_partsupp#8067 AS cpfk_part_partsupp_4#8078, cfpk_partsupp_part#8068 AS cfpk_partsupp_part_4#8079, cpfk_supplier_partsupp#8069 AS cpfk_supplier_partsupp_4#8080, cfpk_partsupp_supplier#8070 AS cfpk_partsupp_supplier_4#8081, cval_partsupp_ps_availqty#8071 AS cval_partsupp_ps_availqty_4#8082, cval_partsupp_ps_supplycost#8072 AS cval_partsupp_ps_supplycost_4#8083, cval_partsupp_ps_comment#8073 AS cval_partsupp_ps_comment_4#8084, cps_availqty#8074 AS cps_availqty_4#8085, cps_supplycost#8075 AS cps_supplycost_4#8086, cps_comment#8076 AS cps_comment_4#8087]
            :        +- Relation[rid#8066,cpfk_part_partsupp#8067,cfpk_partsupp_part#8068,cpfk_supplier_partsupp#8069,cfpk_partsupp_supplier#8070,cval_partsupp_ps_availqty#8071,cval_partsupp_ps_supplycost#8072,cval_partsupp_ps_comment#8073,cps_availqty#8074,cps_supplycost#8075,cps_comment#8076] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#8088 AS rid_5#8105, cpfk_customer_orders#8089 AS cpfk_customer_orders_5#8106, cfpk_orders_customer#8090 AS cfpk_orders_customer_5#8107, cval_orders_o_orderstatus#8091 AS cval_orders_o_orderstatus_5#8108, cval_orders_o_totalprice#8092 AS cval_orders_o_totalprice_5#8109, cval_orders_o_orderpriority#8093 AS cval_orders_o_orderpriority_5#8110, cval_orders_o_clerk#8094 AS cval_orders_o_clerk_5#8111, cval_orders_o_shippriority#8095 AS cval_orders_o_shippriority_5#8112, cval_orders_o_comment#8096 AS cval_orders_o_comment_5#8113, cval_orders_o_orderdate#8097 AS cval_orders_o_orderdate_5#8114, co_orderstatus#8098 AS co_orderstatus_5#8115, co_totalprice#8099 AS co_totalprice_5#8116, co_orderpriority#8100 AS co_orderpriority_5#8117, co_clerk#8101 AS co_clerk_5#8118, co_shippriority#8102 AS co_shippriority_5#8119, co_comment#8103 AS co_comment_5#8120, co_orderdate#8104 AS co_orderdate_5#8121]
               +- Relation[rid#8088,cpfk_customer_orders#8089,cfpk_orders_customer#8090,cval_orders_o_orderstatus#8091,cval_orders_o_totalprice#8092,cval_orders_o_orderpriority#8093,cval_orders_o_clerk#8094,cval_orders_o_shippriority#8095,cval_orders_o_comment#8096,cval_orders_o_orderdate#8097,co_orderstatus#8098,co_totalprice#8099,co_orderpriority#8100,co_clerk#8101,co_shippriority#8102,co_comment#8103,co_orderdate#8104] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 240872ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/11 06:45:11 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:45:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8248L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 06:45:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8248L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#8250 AS rid_0#8283, cpfk_orders_lineitem#8251 AS cpfk_orders_lineitem_0#8284, cpfk_supplier_lineitem#8252 AS cpfk_supplier_lineitem_0#8285, cfpk_lineitem_supplier#8253 AS cfpk_lineitem_supplier_0#8286, cfpk_lineitem_partsupp#8254 AS cfpk_lineitem_partsupp_0#8287, cpfk_part_lineitem#8255 AS cpfk_part_lineitem_0#8288, cfpk_lineitem_part#8256 AS cfpk_lineitem_part_0#8289, cpfk_partsupp_lineitem#8257 AS cpfk_partsupp_lineitem_0#8290, cfpk_lineitem_orders#8258 AS cfpk_lineitem_orders_0#8291, cval_lineitem_l_quantity#8259 AS cval_lineitem_l_quantity_0#8292, cval_lineitem_l_extendedprice#8260 AS cval_lineitem_l_extendedprice_0#8293, cval_lineitem_l_discount#8261 AS cval_lineitem_l_discount_0#8294, cval_lineitem_l_tax#8262 AS cval_lineitem_l_tax_0#8295, cval_lineitem_l_returnflag#8263 AS cval_lineitem_l_returnflag_0#8296, cval_lineitem_l_linestatus#8264 AS cval_lineitem_l_linestatus_0#8297, cval_lineitem_l_commitdate#8265 AS cval_lineitem_l_commitdate_0#8298, cval_lineitem_l_receiptdate#8266 AS cval_lineitem_l_receiptdate_0#8299, cval_lineitem_l_shipinstruct#8267 AS cval_lineitem_l_shipinstruct_0#8300, cval_lineitem_l_shipmode#8268 AS cval_lineitem_l_shipmode_0#8301, cval_lineitem_l_comment#8269 AS cval_lineitem_l_comment_0#8302, cval_lineitem_l_shipdate#8270 AS cval_lineitem_l_shipdate_0#8303, cl_quantity#8271 AS cl_quantity_0#8304, cl_extendedprice#8272 AS cl_extendedprice_0#8305, cl_discount#8273 AS cl_discount_0#8306, ... 9 more fields]
            :  +- Relation[rid#8250,cpfk_orders_lineitem#8251,cpfk_supplier_lineitem#8252,cfpk_lineitem_supplier#8253,cfpk_lineitem_partsupp#8254,cpfk_part_lineitem#8255,cfpk_lineitem_part#8256,cpfk_partsupp_lineitem#8257,cfpk_lineitem_orders#8258,cval_lineitem_l_quantity#8259,cval_lineitem_l_extendedprice#8260,cval_lineitem_l_discount#8261,cval_lineitem_l_tax#8262,cval_lineitem_l_returnflag#8263,cval_lineitem_l_linestatus#8264,cval_lineitem_l_commitdate#8265,cval_lineitem_l_receiptdate#8266,cval_lineitem_l_shipinstruct#8267,cval_lineitem_l_shipmode#8268,cval_lineitem_l_comment#8269,cval_lineitem_l_shipdate#8270,cl_quantity#8271,cl_extendedprice#8272,cl_discount#8273,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#8316 AS rid_1#8333, cpfk_customer_orders#8317 AS cpfk_customer_orders_1#8334, cfpk_orders_customer#8318 AS cfpk_orders_customer_1#8335, cval_orders_o_orderstatus#8319 AS cval_orders_o_orderstatus_1#8336, cval_orders_o_totalprice#8320 AS cval_orders_o_totalprice_1#8337, cval_orders_o_orderpriority#8321 AS cval_orders_o_orderpriority_1#8338, cval_orders_o_clerk#8322 AS cval_orders_o_clerk_1#8339, cval_orders_o_shippriority#8323 AS cval_orders_o_shippriority_1#8340, cval_orders_o_comment#8324 AS cval_orders_o_comment_1#8341, cval_orders_o_orderdate#8325 AS cval_orders_o_orderdate_1#8342, co_orderstatus#8326 AS co_orderstatus_1#8343, co_totalprice#8327 AS co_totalprice_1#8344, co_orderpriority#8328 AS co_orderpriority_1#8345, co_clerk#8329 AS co_clerk_1#8346, co_shippriority#8330 AS co_shippriority_1#8347, co_comment#8331 AS co_comment_1#8348, co_orderdate#8332 AS co_orderdate_1#8349]
               +- Relation[rid#8316,cpfk_customer_orders#8317,cfpk_orders_customer#8318,cval_orders_o_orderstatus#8319,cval_orders_o_totalprice#8320,cval_orders_o_orderpriority#8321,cval_orders_o_clerk#8322,cval_orders_o_shippriority#8323,cval_orders_o_comment#8324,cval_orders_o_orderdate#8325,co_orderstatus#8326,co_totalprice#8327,co_orderpriority#8328,co_clerk#8329,co_shippriority#8330,co_comment#8331,co_orderdate#8332] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 53279ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/11 06:46:05 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:46:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8412L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 06:46:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:46:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:46:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8412L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#8414 AS rid_0#8447, cpfk_orders_lineitem#8415 AS cpfk_orders_lineitem_0#8448, cpfk_supplier_lineitem#8416 AS cpfk_supplier_lineitem_0#8449, cfpk_lineitem_supplier#8417 AS cfpk_lineitem_supplier_0#8450, cfpk_lineitem_partsupp#8418 AS cfpk_lineitem_partsupp_0#8451, cpfk_part_lineitem#8419 AS cpfk_part_lineitem_0#8452, cfpk_lineitem_part#8420 AS cfpk_lineitem_part_0#8453, cpfk_partsupp_lineitem#8421 AS cpfk_partsupp_lineitem_0#8454, cfpk_lineitem_orders#8422 AS cfpk_lineitem_orders_0#8455, cval_lineitem_l_quantity#8423 AS cval_lineitem_l_quantity_0#8456, cval_lineitem_l_extendedprice#8424 AS cval_lineitem_l_extendedprice_0#8457, cval_lineitem_l_discount#8425 AS cval_lineitem_l_discount_0#8458, cval_lineitem_l_tax#8426 AS cval_lineitem_l_tax_0#8459, cval_lineitem_l_returnflag#8427 AS cval_lineitem_l_returnflag_0#8460, cval_lineitem_l_linestatus#8428 AS cval_lineitem_l_linestatus_0#8461, cval_lineitem_l_commitdate#8429 AS cval_lineitem_l_commitdate_0#8462, cval_lineitem_l_receiptdate#8430 AS cval_lineitem_l_receiptdate_0#8463, cval_lineitem_l_shipinstruct#8431 AS cval_lineitem_l_shipinstruct_0#8464, cval_lineitem_l_shipmode#8432 AS cval_lineitem_l_shipmode_0#8465, cval_lineitem_l_comment#8433 AS cval_lineitem_l_comment_0#8466, cval_lineitem_l_shipdate#8434 AS cval_lineitem_l_shipdate_0#8467, cl_quantity#8435 AS cl_quantity_0#8468, cl_extendedprice#8436 AS cl_extendedprice_0#8469, cl_discount#8437 AS cl_discount_0#8470, ... 9 more fields]
            :     :     :  :  +- Relation[rid#8414,cpfk_orders_lineitem#8415,cpfk_supplier_lineitem#8416,cfpk_lineitem_supplier#8417,cfpk_lineitem_partsupp#8418,cpfk_part_lineitem#8419,cfpk_lineitem_part#8420,cpfk_partsupp_lineitem#8421,cfpk_lineitem_orders#8422,cval_lineitem_l_quantity#8423,cval_lineitem_l_extendedprice#8424,cval_lineitem_l_discount#8425,cval_lineitem_l_tax#8426,cval_lineitem_l_returnflag#8427,cval_lineitem_l_linestatus#8428,cval_lineitem_l_commitdate#8429,cval_lineitem_l_receiptdate#8430,cval_lineitem_l_shipinstruct#8431,cval_lineitem_l_shipmode#8432,cval_lineitem_l_comment#8433,cval_lineitem_l_shipdate#8434,cl_quantity#8435,cl_extendedprice#8436,cl_discount#8437,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#8480 AS rid_0#8513, cpfk_orders_lineitem#8481 AS cpfk_orders_lineitem_0#8514, cpfk_supplier_lineitem#8482 AS cpfk_supplier_lineitem_0#8515, cfpk_lineitem_supplier#8483 AS cfpk_lineitem_supplier_0#8516, cfpk_lineitem_partsupp#8484 AS cfpk_lineitem_partsupp_0#8517, cpfk_part_lineitem#8485 AS cpfk_part_lineitem_0#8518, cfpk_lineitem_part#8486 AS cfpk_lineitem_part_0#8519, cpfk_partsupp_lineitem#8487 AS cpfk_partsupp_lineitem_0#8520, cfpk_lineitem_orders#8488 AS cfpk_lineitem_orders_0#8521, cval_lineitem_l_quantity#8489 AS cval_lineitem_l_quantity_0#8522, cval_lineitem_l_extendedprice#8490 AS cval_lineitem_l_extendedprice_0#8523, cval_lineitem_l_discount#8491 AS cval_lineitem_l_discount_0#8524, cval_lineitem_l_tax#8492 AS cval_lineitem_l_tax_0#8525, cval_lineitem_l_returnflag#8493 AS cval_lineitem_l_returnflag_0#8526, cval_lineitem_l_linestatus#8494 AS cval_lineitem_l_linestatus_0#8527, cval_lineitem_l_commitdate#8495 AS cval_lineitem_l_commitdate_0#8528, cval_lineitem_l_receiptdate#8496 AS cval_lineitem_l_receiptdate_0#8529, cval_lineitem_l_shipinstruct#8497 AS cval_lineitem_l_shipinstruct_0#8530, cval_lineitem_l_shipmode#8498 AS cval_lineitem_l_shipmode_0#8531, cval_lineitem_l_comment#8499 AS cval_lineitem_l_comment_0#8532, cval_lineitem_l_shipdate#8500 AS cval_lineitem_l_shipdate_0#8533, cl_quantity#8501 AS cl_quantity_0#8534, cl_extendedprice#8502 AS cl_extendedprice_0#8535, cl_discount#8503 AS cl_discount_0#8536, ... 9 more fields]
            :     :     :        +- Relation[rid#8480,cpfk_orders_lineitem#8481,cpfk_supplier_lineitem#8482,cfpk_lineitem_supplier#8483,cfpk_lineitem_partsupp#8484,cpfk_part_lineitem#8485,cfpk_lineitem_part#8486,cpfk_partsupp_lineitem#8487,cfpk_lineitem_orders#8488,cval_lineitem_l_quantity#8489,cval_lineitem_l_extendedprice#8490,cval_lineitem_l_discount#8491,cval_lineitem_l_tax#8492,cval_lineitem_l_returnflag#8493,cval_lineitem_l_linestatus#8494,cval_lineitem_l_commitdate#8495,cval_lineitem_l_receiptdate#8496,cval_lineitem_l_shipinstruct#8497,cval_lineitem_l_shipmode#8498,cval_lineitem_l_comment#8499,cval_lineitem_l_shipdate#8500,cl_quantity#8501,cl_extendedprice#8502,cl_discount#8503,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#8546 AS rid_1#8563, cpfk_customer_orders#8547 AS cpfk_customer_orders_1#8564, cfpk_orders_customer#8548 AS cfpk_orders_customer_1#8565, cval_orders_o_orderstatus#8549 AS cval_orders_o_orderstatus_1#8566, cval_orders_o_totalprice#8550 AS cval_orders_o_totalprice_1#8567, cval_orders_o_orderpriority#8551 AS cval_orders_o_orderpriority_1#8568, cval_orders_o_clerk#8552 AS cval_orders_o_clerk_1#8569, cval_orders_o_shippriority#8553 AS cval_orders_o_shippriority_1#8570, cval_orders_o_comment#8554 AS cval_orders_o_comment_1#8571, cval_orders_o_orderdate#8555 AS cval_orders_o_orderdate_1#8572, co_orderstatus#8556 AS co_orderstatus_1#8573, co_totalprice#8557 AS co_totalprice_1#8574, co_orderpriority#8558 AS co_orderpriority_1#8575, co_clerk#8559 AS co_clerk_1#8576, co_shippriority#8560 AS co_shippriority_1#8577, co_comment#8561 AS co_comment_1#8578, co_orderdate#8562 AS co_orderdate_1#8579]
            :     :        +- Relation[rid#8546,cpfk_customer_orders#8547,cfpk_orders_customer#8548,cval_orders_o_orderstatus#8549,cval_orders_o_totalprice#8550,cval_orders_o_orderpriority#8551,cval_orders_o_clerk#8552,cval_orders_o_shippriority#8553,cval_orders_o_comment#8554,cval_orders_o_orderdate#8555,co_orderstatus#8556,co_totalprice#8557,co_orderpriority#8558,co_clerk#8559,co_shippriority#8560,co_comment#8561,co_orderdate#8562] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#8580 AS rid_2#8595, cpfk_nation_customer#8581 AS cpfk_nation_customer_2#8596, cfpk_customer_nation#8582 AS cfpk_customer_nation_2#8597, cval_customer_c_name#8583 AS cval_customer_c_name_2#8598, cval_customer_c_address#8584 AS cval_customer_c_address_2#8599, cval_customer_c_phone#8585 AS cval_customer_c_phone_2#8600, cval_customer_c_acctbal#8586 AS cval_customer_c_acctbal_2#8601, cval_customer_c_comment#8587 AS cval_customer_c_comment_2#8602, cval_customer_c_mktsegment#8588 AS cval_customer_c_mktsegment_2#8603, cc_name#8589 AS cc_name_2#8604, cc_address#8590 AS cc_address_2#8605, cc_phone#8591 AS cc_phone_2#8606, cc_acctbal#8592 AS cc_acctbal_2#8607, cc_comment#8593 AS cc_comment_2#8608, cc_mktsegment#8594 AS cc_mktsegment_2#8609]
            :        +- Relation[rid#8580,cpfk_nation_customer#8581,cfpk_customer_nation#8582,cval_customer_c_name#8583,cval_customer_c_address#8584,cval_customer_c_phone#8585,cval_customer_c_acctbal#8586,cval_customer_c_comment#8587,cval_customer_c_mktsegment#8588,cc_name#8589,cc_address#8590,cc_phone#8591,cc_acctbal#8592,cc_comment#8593,cc_mktsegment#8594] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#8610 AS rid_3#8617, cpfk_region_nation#8611 AS cpfk_region_nation_3#8618, cfpk_nation_region#8612 AS cfpk_nation_region_3#8619, cval_nation_n_name#8613 AS cval_nation_n_name_3#8620, cval_nation_n_comment#8614 AS cval_nation_n_comment_3#8621, cn_name#8615 AS cn_name_3#8622, cn_comment#8616 AS cn_comment_3#8623]
               +- Relation[rid#8610,cpfk_region_nation#8611,cfpk_nation_region#8612,cval_nation_n_name#8613,cval_nation_n_comment#8614,cn_name#8615,cn_comment#8616] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 60490ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/11 06:47:05 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:47:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8703L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 06:47:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:47:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:47:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:47:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8703L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#8705 AS rid_0#8718, cpfk_nation_supplier#8706 AS cpfk_nation_supplier_0#8719, cfpk_supplier_nation#8707 AS cfpk_supplier_nation_0#8720, cval_supplier_s_name#8708 AS cval_supplier_s_name_0#8721, cval_supplier_s_address#8709 AS cval_supplier_s_address_0#8722, cval_supplier_s_phone#8710 AS cval_supplier_s_phone_0#8723, cval_supplier_s_acctbal#8711 AS cval_supplier_s_acctbal_0#8724, cval_supplier_s_comment#8712 AS cval_supplier_s_comment_0#8725, cs_name#8713 AS cs_name_0#8726, cs_address#8714 AS cs_address_0#8727, cs_phone#8715 AS cs_phone_0#8728, cs_acctbal#8716 AS cs_acctbal_0#8729, cs_comment#8717 AS cs_comment_0#8730]
         :  :  +- Relation[rid#8705,cpfk_nation_supplier#8706,cfpk_supplier_nation#8707,cval_supplier_s_name#8708,cval_supplier_s_address#8709,cval_supplier_s_phone#8710,cval_supplier_s_acctbal#8711,cval_supplier_s_comment#8712,cs_name#8713,cs_address#8714,cs_phone#8715,cs_acctbal#8716,cs_comment#8717] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#8797 AS rid_0#8810, cpfk_nation_supplier#8798 AS cpfk_nation_supplier_0#8811, cfpk_supplier_nation#8799 AS cfpk_supplier_nation_0#8812, cval_supplier_s_name#8800 AS cval_supplier_s_name_0#8813, cval_supplier_s_address#8801 AS cval_supplier_s_address_0#8814, cval_supplier_s_phone#8802 AS cval_supplier_s_phone_0#8815, cval_supplier_s_acctbal#8803 AS cval_supplier_s_acctbal_0#8816, cval_supplier_s_comment#8804 AS cval_supplier_s_comment_0#8817, cs_name#8805 AS cs_name_0#8818, cs_address#8806 AS cs_address_0#8819, cs_phone#8807 AS cs_phone_0#8820, cs_acctbal#8808 AS cs_acctbal_0#8821, cs_comment#8809 AS cs_comment_0#8822]
         :     :  +- Relation[rid#8797,cpfk_nation_supplier#8798,cfpk_supplier_nation#8799,cval_supplier_s_name#8800,cval_supplier_s_address#8801,cval_supplier_s_phone#8802,cval_supplier_s_acctbal#8803,cval_supplier_s_comment#8804,cs_name#8805,cs_address#8806,cs_phone#8807,cs_acctbal#8808,cs_comment#8809] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#8823 AS rid_1#8856, cpfk_orders_lineitem#8824 AS cpfk_orders_lineitem_1#8857, cpfk_supplier_lineitem#8825 AS cpfk_supplier_lineitem_1#8858, cfpk_lineitem_supplier#8826 AS cfpk_lineitem_supplier_1#8859, cfpk_lineitem_partsupp#8827 AS cfpk_lineitem_partsupp_1#8860, cpfk_part_lineitem#8828 AS cpfk_part_lineitem_1#8861, cfpk_lineitem_part#8829 AS cfpk_lineitem_part_1#8862, cpfk_partsupp_lineitem#8830 AS cpfk_partsupp_lineitem_1#8863, cfpk_lineitem_orders#8831 AS cfpk_lineitem_orders_1#8864, cval_lineitem_l_quantity#8832 AS cval_lineitem_l_quantity_1#8865, cval_lineitem_l_extendedprice#8833 AS cval_lineitem_l_extendedprice_1#8866, cval_lineitem_l_discount#8834 AS cval_lineitem_l_discount_1#8867, cval_lineitem_l_tax#8835 AS cval_lineitem_l_tax_1#8868, cval_lineitem_l_returnflag#8836 AS cval_lineitem_l_returnflag_1#8869, cval_lineitem_l_linestatus#8837 AS cval_lineitem_l_linestatus_1#8870, cval_lineitem_l_commitdate#8838 AS cval_lineitem_l_commitdate_1#8871, cval_lineitem_l_receiptdate#8839 AS cval_lineitem_l_receiptdate_1#8872, cval_lineitem_l_shipinstruct#8840 AS cval_lineitem_l_shipinstruct_1#8873, cval_lineitem_l_shipmode#8841 AS cval_lineitem_l_shipmode_1#8874, cval_lineitem_l_comment#8842 AS cval_lineitem_l_comment_1#8875, cval_lineitem_l_shipdate#8843 AS cval_lineitem_l_shipdate_1#8876, cl_quantity#8844 AS cl_quantity_1#8877, cl_extendedprice#8845 AS cl_extendedprice_1#8878, cl_discount#8846 AS cl_discount_1#8879, ... 9 more fields]
         :        +- Relation[rid#8823,cpfk_orders_lineitem#8824,cpfk_supplier_lineitem#8825,cfpk_lineitem_supplier#8826,cfpk_lineitem_partsupp#8827,cpfk_part_lineitem#8828,cfpk_lineitem_part#8829,cpfk_partsupp_lineitem#8830,cfpk_lineitem_orders#8831,cval_lineitem_l_quantity#8832,cval_lineitem_l_extendedprice#8833,cval_lineitem_l_discount#8834,cval_lineitem_l_tax#8835,cval_lineitem_l_returnflag#8836,cval_lineitem_l_linestatus#8837,cval_lineitem_l_commitdate#8838,cval_lineitem_l_receiptdate#8839,cval_lineitem_l_shipinstruct#8840,cval_lineitem_l_shipmode#8841,cval_lineitem_l_comment#8842,cval_lineitem_l_shipdate#8843,cl_quantity#8844,cl_extendedprice#8845,cl_discount#8846,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8731 AS rid_1#8764, cpfk_orders_lineitem#8732 AS cpfk_orders_lineitem_1#8765, cpfk_supplier_lineitem#8733 AS cpfk_supplier_lineitem_1#8766, cfpk_lineitem_supplier#8734 AS cfpk_lineitem_supplier_1#8767, cfpk_lineitem_partsupp#8735 AS cfpk_lineitem_partsupp_1#8768, cpfk_part_lineitem#8736 AS cpfk_part_lineitem_1#8769, cfpk_lineitem_part#8737 AS cfpk_lineitem_part_1#8770, cpfk_partsupp_lineitem#8738 AS cpfk_partsupp_lineitem_1#8771, cfpk_lineitem_orders#8739 AS cfpk_lineitem_orders_1#8772, cval_lineitem_l_quantity#8740 AS cval_lineitem_l_quantity_1#8773, cval_lineitem_l_extendedprice#8741 AS cval_lineitem_l_extendedprice_1#8774, cval_lineitem_l_discount#8742 AS cval_lineitem_l_discount_1#8775, cval_lineitem_l_tax#8743 AS cval_lineitem_l_tax_1#8776, cval_lineitem_l_returnflag#8744 AS cval_lineitem_l_returnflag_1#8777, cval_lineitem_l_linestatus#8745 AS cval_lineitem_l_linestatus_1#8778, cval_lineitem_l_commitdate#8746 AS cval_lineitem_l_commitdate_1#8779, cval_lineitem_l_receiptdate#8747 AS cval_lineitem_l_receiptdate_1#8780, cval_lineitem_l_shipinstruct#8748 AS cval_lineitem_l_shipinstruct_1#8781, cval_lineitem_l_shipmode#8749 AS cval_lineitem_l_shipmode_1#8782, cval_lineitem_l_comment#8750 AS cval_lineitem_l_comment_1#8783, cval_lineitem_l_shipdate#8751 AS cval_lineitem_l_shipdate_1#8784, cl_quantity#8752 AS cl_quantity_1#8785, cl_extendedprice#8753 AS cl_extendedprice_1#8786, cl_discount#8754 AS cl_discount_1#8787, ... 9 more fields]
            +- Relation[rid#8731,cpfk_orders_lineitem#8732,cpfk_supplier_lineitem#8733,cfpk_lineitem_supplier#8734,cfpk_lineitem_partsupp#8735,cpfk_part_lineitem#8736,cfpk_lineitem_part#8737,cpfk_partsupp_lineitem#8738,cfpk_lineitem_orders#8739,cval_lineitem_l_quantity#8740,cval_lineitem_l_extendedprice#8741,cval_lineitem_l_discount#8742,cval_lineitem_l_tax#8743,cval_lineitem_l_returnflag#8744,cval_lineitem_l_linestatus#8745,cval_lineitem_l_commitdate#8746,cval_lineitem_l_receiptdate#8747,cval_lineitem_l_shipinstruct#8748,cval_lineitem_l_shipmode#8749,cval_lineitem_l_comment#8750,cval_lineitem_l_shipdate#8751,cl_quantity#8752,cl_extendedprice#8753,cl_discount#8754,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 75422ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 06:48:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:48:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8944L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 06:48:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:48:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:48:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:48:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:48:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:48:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:48:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:48:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:48:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:48:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:48:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:48:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:48:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:48:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:48:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:48:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 06:48:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8944L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#8946 AS rid_0#8953, cpfk_region_nation#8947 AS cpfk_region_nation_0#8954, cfpk_nation_region#8948 AS cfpk_nation_region_0#8955, cval_nation_n_name#8949 AS cval_nation_n_name_0#8956, cval_nation_n_comment#8950 AS cval_nation_n_comment_0#8957, cn_name#8951 AS cn_name_0#8958, cn_comment#8952 AS cn_comment_0#8959]
            :  :  :     :  :  :  :  :  +- Relation[rid#8946,cpfk_region_nation#8947,cfpk_nation_region#8948,cval_nation_n_name#8949,cval_nation_n_comment#8950,cn_name#8951,cn_comment#8952] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#8986 AS rid_0#8993, cpfk_region_nation#8987 AS cpfk_region_nation_0#8994, cfpk_nation_region#8988 AS cfpk_nation_region_0#8995, cval_nation_n_name#8989 AS cval_nation_n_name_0#8996, cval_nation_n_comment#8990 AS cval_nation_n_comment_0#8997, cn_name#8991 AS cn_name_0#8998, cn_comment#8992 AS cn_comment_0#8999]
            :  :  :     :  :  :  :     :  +- Relation[rid#8986,cpfk_region_nation#8987,cfpk_nation_region#8988,cval_nation_n_name#8989,cval_nation_n_comment#8990,cn_name#8991,cn_comment#8992] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#9000 AS rid_1#9013, cpfk_nation_supplier#9001 AS cpfk_nation_supplier_1#9014, cfpk_supplier_nation#9002 AS cfpk_supplier_nation_1#9015, cval_supplier_s_name#9003 AS cval_supplier_s_name_1#9016, cval_supplier_s_address#9004 AS cval_supplier_s_address_1#9017, cval_supplier_s_phone#9005 AS cval_supplier_s_phone_1#9018, cval_supplier_s_acctbal#9006 AS cval_supplier_s_acctbal_1#9019, cval_supplier_s_comment#9007 AS cval_supplier_s_comment_1#9020, cs_name#9008 AS cs_name_1#9021, cs_address#9009 AS cs_address_1#9022, cs_phone#9010 AS cs_phone_1#9023, cs_acctbal#9011 AS cs_acctbal_1#9024, cs_comment#9012 AS cs_comment_1#9025]
            :  :  :     :  :  :  :        +- Relation[rid#9000,cpfk_nation_supplier#9001,cfpk_supplier_nation#9002,cval_supplier_s_name#9003,cval_supplier_s_address#9004,cval_supplier_s_phone#9005,cval_supplier_s_acctbal#9006,cval_supplier_s_comment#9007,cs_name#9008,cs_address#9009,cs_phone#9010,cs_acctbal#9011,cs_comment#9012] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#8960 AS rid_1#8973, cpfk_nation_supplier#8961 AS cpfk_nation_supplier_1#8974, cfpk_supplier_nation#8962 AS cfpk_supplier_nation_1#8975, cval_supplier_s_name#8963 AS cval_supplier_s_name_1#8976, cval_supplier_s_address#8964 AS cval_supplier_s_address_1#8977, cval_supplier_s_phone#8965 AS cval_supplier_s_phone_1#8978, cval_supplier_s_acctbal#8966 AS cval_supplier_s_acctbal_1#8979, cval_supplier_s_comment#8967 AS cval_supplier_s_comment_1#8980, cs_name#8968 AS cs_name_1#8981, cs_address#8969 AS cs_address_1#8982, cs_phone#8970 AS cs_phone_1#8983, cs_acctbal#8971 AS cs_acctbal_1#8984, cs_comment#8972 AS cs_comment_1#8985]
            :  :  :     :  :  :     +- Relation[rid#8960,cpfk_nation_supplier#8961,cfpk_supplier_nation#8962,cval_supplier_s_name#8963,cval_supplier_s_address#8964,cval_supplier_s_phone#8965,cval_supplier_s_acctbal#8966,cval_supplier_s_comment#8967,cs_name#8968,cs_address#8969,cs_phone#8970,cs_acctbal#8971,cs_comment#8972] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#9048 AS rid_1#9061, cpfk_nation_supplier#9049 AS cpfk_nation_supplier_1#9062, cfpk_supplier_nation#9050 AS cfpk_supplier_nation_1#9063, cval_supplier_s_name#9051 AS cval_supplier_s_name_1#9064, cval_supplier_s_address#9052 AS cval_supplier_s_address_1#9065, cval_supplier_s_phone#9053 AS cval_supplier_s_phone_1#9066, cval_supplier_s_acctbal#9054 AS cval_supplier_s_acctbal_1#9067, cval_supplier_s_comment#9055 AS cval_supplier_s_comment_1#9068, cs_name#9056 AS cs_name_1#9069, cs_address#9057 AS cs_address_1#9070, cs_phone#9058 AS cs_phone_1#9071, cs_acctbal#9059 AS cs_acctbal_1#9072, cs_comment#9060 AS cs_comment_1#9073]
            :  :  :     :  :     :  +- Relation[rid#9048,cpfk_nation_supplier#9049,cfpk_supplier_nation#9050,cval_supplier_s_name#9051,cval_supplier_s_address#9052,cval_supplier_s_phone#9053,cval_supplier_s_acctbal#9054,cval_supplier_s_comment#9055,cs_name#9056,cs_address#9057,cs_phone#9058,cs_acctbal#9059,cs_comment#9060] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#9074 AS rid_2#9085, cpfk_part_partsupp#9075 AS cpfk_part_partsupp_2#9086, cfpk_partsupp_part#9076 AS cfpk_partsupp_part_2#9087, cpfk_supplier_partsupp#9077 AS cpfk_supplier_partsupp_2#9088, cfpk_partsupp_supplier#9078 AS cfpk_partsupp_supplier_2#9089, cval_partsupp_ps_availqty#9079 AS cval_partsupp_ps_availqty_2#9090, cval_partsupp_ps_supplycost#9080 AS cval_partsupp_ps_supplycost_2#9091, cval_partsupp_ps_comment#9081 AS cval_partsupp_ps_comment_2#9092, cps_availqty#9082 AS cps_availqty_2#9093, cps_supplycost#9083 AS cps_supplycost_2#9094, cps_comment#9084 AS cps_comment_2#9095]
            :  :  :     :  :        +- Relation[rid#9074,cpfk_part_partsupp#9075,cfpk_partsupp_part#9076,cpfk_supplier_partsupp#9077,cfpk_partsupp_supplier#9078,cval_partsupp_ps_availqty#9079,cval_partsupp_ps_supplycost#9080,cval_partsupp_ps_comment#9081,cps_availqty#9082,cps_supplycost#9083,cps_comment#9084] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#9026 AS rid_2#9037, cpfk_part_partsupp#9027 AS cpfk_part_partsupp_2#9038, cfpk_partsupp_part#9028 AS cfpk_partsupp_part_2#9039, cpfk_supplier_partsupp#9029 AS cpfk_supplier_partsupp_2#9040, cfpk_partsupp_supplier#9030 AS cfpk_partsupp_supplier_2#9041, cval_partsupp_ps_availqty#9031 AS cval_partsupp_ps_availqty_2#9042, cval_partsupp_ps_supplycost#9032 AS cval_partsupp_ps_supplycost_2#9043, cval_partsupp_ps_comment#9033 AS cval_partsupp_ps_comment_2#9044, cps_availqty#9034 AS cps_availqty_2#9045, cps_supplycost#9035 AS cps_supplycost_2#9046, cps_comment#9036 AS cps_comment_2#9047]
            :  :  :     :     +- Relation[rid#9026,cpfk_part_partsupp#9027,cfpk_partsupp_part#9028,cpfk_supplier_partsupp#9029,cfpk_partsupp_supplier#9030,cval_partsupp_ps_availqty#9031,cval_partsupp_ps_supplycost#9032,cval_partsupp_ps_comment#9033,cps_availqty#9034,cps_supplycost#9035,cps_comment#9036] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#9096 AS rid_3#9113, cval_part_p_name#9097 AS cval_part_p_name_3#9114, cval_part_p_mfgr#9098 AS cval_part_p_mfgr_3#9115, cval_part_p_type#9099 AS cval_part_p_type_3#9116, cval_part_p_size#9100 AS cval_part_p_size_3#9117, cval_part_p_container#9101 AS cval_part_p_container_3#9118, cval_part_p_retailprice#9102 AS cval_part_p_retailprice_3#9119, cval_part_p_comment#9103 AS cval_part_p_comment_3#9120, cval_part_p_brand#9104 AS cval_part_p_brand_3#9121, cp_name#9105 AS cp_name_3#9122, cp_mfgr#9106 AS cp_mfgr_3#9123, cp_type#9107 AS cp_type_3#9124, cp_size#9108 AS cp_size_3#9125, cp_container#9109 AS cp_container_3#9126, cp_retailprice#9110 AS cp_retailprice_3#9127, cp_comment#9111 AS cp_comment_3#9128, cp_brand#9112 AS cp_brand_3#9129]
            :  :  :        +- Relation[rid#9096,cval_part_p_name#9097,cval_part_p_mfgr#9098,cval_part_p_type#9099,cval_part_p_size#9100,cval_part_p_container#9101,cval_part_p_retailprice#9102,cval_part_p_comment#9103,cval_part_p_brand#9104,cp_name#9105,cp_mfgr#9106,cp_type#9107,cp_size#9108,cp_container#9109,cp_retailprice#9110,cp_comment#9111,cp_brand#9112] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#9196 AS rid_2#9207, cpfk_part_partsupp#9197 AS cpfk_part_partsupp_2#9208, cfpk_partsupp_part#9198 AS cfpk_partsupp_part_2#9209, cpfk_supplier_partsupp#9199 AS cpfk_supplier_partsupp_2#9210, cfpk_partsupp_supplier#9200 AS cfpk_partsupp_supplier_2#9211, cval_partsupp_ps_availqty#9201 AS cval_partsupp_ps_availqty_2#9212, cval_partsupp_ps_supplycost#9202 AS cval_partsupp_ps_supplycost_2#9213, cval_partsupp_ps_comment#9203 AS cval_partsupp_ps_comment_2#9214, cps_availqty#9204 AS cps_availqty_2#9215, cps_supplycost#9205 AS cps_supplycost_2#9216, cps_comment#9206 AS cps_comment_2#9217]
            :  :     :  +- Relation[rid#9196,cpfk_part_partsupp#9197,cfpk_partsupp_part#9198,cpfk_supplier_partsupp#9199,cfpk_partsupp_supplier#9200,cval_partsupp_ps_availqty#9201,cval_partsupp_ps_supplycost#9202,cval_partsupp_ps_comment#9203,cps_availqty#9204,cps_supplycost#9205,cps_comment#9206] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#9218 AS rid_4#9251, cpfk_orders_lineitem#9219 AS cpfk_orders_lineitem_4#9252, cpfk_supplier_lineitem#9220 AS cpfk_supplier_lineitem_4#9253, cfpk_lineitem_supplier#9221 AS cfpk_lineitem_supplier_4#9254, cfpk_lineitem_partsupp#9222 AS cfpk_lineitem_partsupp_4#9255, cpfk_part_lineitem#9223 AS cpfk_part_lineitem_4#9256, cfpk_lineitem_part#9224 AS cfpk_lineitem_part_4#9257, cpfk_partsupp_lineitem#9225 AS cpfk_partsupp_lineitem_4#9258, cfpk_lineitem_orders#9226 AS cfpk_lineitem_orders_4#9259, cval_lineitem_l_quantity#9227 AS cval_lineitem_l_quantity_4#9260, cval_lineitem_l_extendedprice#9228 AS cval_lineitem_l_extendedprice_4#9261, cval_lineitem_l_discount#9229 AS cval_lineitem_l_discount_4#9262, cval_lineitem_l_tax#9230 AS cval_lineitem_l_tax_4#9263, cval_lineitem_l_returnflag#9231 AS cval_lineitem_l_returnflag_4#9264, cval_lineitem_l_linestatus#9232 AS cval_lineitem_l_linestatus_4#9265, cval_lineitem_l_commitdate#9233 AS cval_lineitem_l_commitdate_4#9266, cval_lineitem_l_receiptdate#9234 AS cval_lineitem_l_receiptdate_4#9267, cval_lineitem_l_shipinstruct#9235 AS cval_lineitem_l_shipinstruct_4#9268, cval_lineitem_l_shipmode#9236 AS cval_lineitem_l_shipmode_4#9269, cval_lineitem_l_comment#9237 AS cval_lineitem_l_comment_4#9270, cval_lineitem_l_shipdate#9238 AS cval_lineitem_l_shipdate_4#9271, cl_quantity#9239 AS cl_quantity_4#9272, cl_extendedprice#9240 AS cl_extendedprice_4#9273, cl_discount#9241 AS cl_discount_4#9274, ... 9 more fields]
            :  :        +- Relation[rid#9218,cpfk_orders_lineitem#9219,cpfk_supplier_lineitem#9220,cfpk_lineitem_supplier#9221,cfpk_lineitem_partsupp#9222,cpfk_part_lineitem#9223,cfpk_lineitem_part#9224,cpfk_partsupp_lineitem#9225,cfpk_lineitem_orders#9226,cval_lineitem_l_quantity#9227,cval_lineitem_l_extendedprice#9228,cval_lineitem_l_discount#9229,cval_lineitem_l_tax#9230,cval_lineitem_l_returnflag#9231,cval_lineitem_l_linestatus#9232,cval_lineitem_l_commitdate#9233,cval_lineitem_l_receiptdate#9234,cval_lineitem_l_shipinstruct#9235,cval_lineitem_l_shipmode#9236,cval_lineitem_l_comment#9237,cval_lineitem_l_shipdate#9238,cl_quantity#9239,cl_extendedprice#9240,cl_discount#9241,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#9130 AS rid_4#9163, cpfk_orders_lineitem#9131 AS cpfk_orders_lineitem_4#9164, cpfk_supplier_lineitem#9132 AS cpfk_supplier_lineitem_4#9165, cfpk_lineitem_supplier#9133 AS cfpk_lineitem_supplier_4#9166, cfpk_lineitem_partsupp#9134 AS cfpk_lineitem_partsupp_4#9167, cpfk_part_lineitem#9135 AS cpfk_part_lineitem_4#9168, cfpk_lineitem_part#9136 AS cfpk_lineitem_part_4#9169, cpfk_partsupp_lineitem#9137 AS cpfk_partsupp_lineitem_4#9170, cfpk_lineitem_orders#9138 AS cfpk_lineitem_orders_4#9171, cval_lineitem_l_quantity#9139 AS cval_lineitem_l_quantity_4#9172, cval_lineitem_l_extendedprice#9140 AS cval_lineitem_l_extendedprice_4#9173, cval_lineitem_l_discount#9141 AS cval_lineitem_l_discount_4#9174, cval_lineitem_l_tax#9142 AS cval_lineitem_l_tax_4#9175, cval_lineitem_l_returnflag#9143 AS cval_lineitem_l_returnflag_4#9176, cval_lineitem_l_linestatus#9144 AS cval_lineitem_l_linestatus_4#9177, cval_lineitem_l_commitdate#9145 AS cval_lineitem_l_commitdate_4#9178, cval_lineitem_l_receiptdate#9146 AS cval_lineitem_l_receiptdate_4#9179, cval_lineitem_l_shipinstruct#9147 AS cval_lineitem_l_shipinstruct_4#9180, cval_lineitem_l_shipmode#9148 AS cval_lineitem_l_shipmode_4#9181, cval_lineitem_l_comment#9149 AS cval_lineitem_l_comment_4#9182, cval_lineitem_l_shipdate#9150 AS cval_lineitem_l_shipdate_4#9183, cl_quantity#9151 AS cl_quantity_4#9184, cl_extendedprice#9152 AS cl_extendedprice_4#9185, cl_discount#9153 AS cl_discount_4#9186, ... 9 more fields]
            :     +- Relation[rid#9130,cpfk_orders_lineitem#9131,cpfk_supplier_lineitem#9132,cfpk_lineitem_supplier#9133,cfpk_lineitem_partsupp#9134,cpfk_part_lineitem#9135,cfpk_lineitem_part#9136,cpfk_partsupp_lineitem#9137,cfpk_lineitem_orders#9138,cval_lineitem_l_quantity#9139,cval_lineitem_l_extendedprice#9140,cval_lineitem_l_discount#9141,cval_lineitem_l_tax#9142,cval_lineitem_l_returnflag#9143,cval_lineitem_l_linestatus#9144,cval_lineitem_l_commitdate#9145,cval_lineitem_l_receiptdate#9146,cval_lineitem_l_shipinstruct#9147,cval_lineitem_l_shipmode#9148,cval_lineitem_l_comment#9149,cval_lineitem_l_shipdate#9150,cl_quantity#9151,cl_extendedprice#9152,cl_discount#9153,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#9284 AS rid_5#9301, cpfk_customer_orders#9285 AS cpfk_customer_orders_5#9302, cfpk_orders_customer#9286 AS cfpk_orders_customer_5#9303, cval_orders_o_orderstatus#9287 AS cval_orders_o_orderstatus_5#9304, cval_orders_o_totalprice#9288 AS cval_orders_o_totalprice_5#9305, cval_orders_o_orderpriority#9289 AS cval_orders_o_orderpriority_5#9306, cval_orders_o_clerk#9290 AS cval_orders_o_clerk_5#9307, cval_orders_o_shippriority#9291 AS cval_orders_o_shippriority_5#9308, cval_orders_o_comment#9292 AS cval_orders_o_comment_5#9309, cval_orders_o_orderdate#9293 AS cval_orders_o_orderdate_5#9310, co_orderstatus#9294 AS co_orderstatus_5#9311, co_totalprice#9295 AS co_totalprice_5#9312, co_orderpriority#9296 AS co_orderpriority_5#9313, co_clerk#9297 AS co_clerk_5#9314, co_shippriority#9298 AS co_shippriority_5#9315, co_comment#9299 AS co_comment_5#9316, co_orderdate#9300 AS co_orderdate_5#9317]
               +- Relation[rid#9284,cpfk_customer_orders#9285,cfpk_orders_customer#9286,cval_orders_o_orderstatus#9287,cval_orders_o_totalprice#9288,cval_orders_o_orderpriority#9289,cval_orders_o_clerk#9290,cval_orders_o_shippriority#9291,cval_orders_o_comment#9292,cval_orders_o_orderdate#9293,co_orderstatus#9294,co_totalprice#9295,co_orderpriority#9296,co_clerk#9297,co_shippriority#9298,co_comment#9299,co_orderdate#9300] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 162479ms
query=q1, count=6001215, duration=3021
query=q10, count=1478870, duration=60490
query=q11, count=31680, duration=10334
query=q12, count=857401, duration=21442
query=q13, count=1500000, duration=12839
query=q14, count=6001215, duration=82893
query=q15, count=6001215, duration=75422
query=q16, count=15780, duration=10703
query=q17, count=6088, duration=71958
query=q18, count=6001215, duration=120103
query=q19, count=205, duration=362466
query=q2, count=3162, duration=20974
query=q20, count=632, duration=11456
query=q21a, count=597422, duration=251704
query=q22, count=1500000, duration=12735
query=q3, count=1214743, duration=117101
query=q4, count=6001215, duration=53279
query=q5, count=1206514, duration=164570
query=q6, count=6001215, duration=3163
query=q7, count=9735, duration=107618
query=q8, count=8716, duration=95889
query=q9a, count=6001215, duration=240872
query=q9b, count=6001215, duration=162479
