20/04/25 23:18:19 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10750ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 25 23:18:22 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 25 23:18:24 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 25 23:18:24 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 25 23:18:24 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 25 23:18:24 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 25 23:18:28 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 25 23:18:32 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 25 23:18:32 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/25 23:18:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:18:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2078L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 23:18:33 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:18:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:18:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:18:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:18:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:18:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:18:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:18:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:18:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:18:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:18:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:18:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:18:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:18:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2078L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_part_4) = 'rid_3)
         :  :- Project [rid#2262 AS rid_4#2276, cpfk_part_partsupp#2263 AS cpfk_part_partsupp_4#2277, cfpk_partsupp_part#2264 AS cfpk_partsupp_part_4#2278, cpfk_supplier_partsupp#2265 AS cpfk_supplier_partsupp_4#2279, cfpk_partsupp_supplier#2266 AS cfpk_partsupp_supplier_4#2280, cval_partsupp_ps_availqty#2267 AS cval_partsupp_ps_availqty_4#2281, cval_partsupp_ps_supplycost#2268 AS cval_partsupp_ps_supplycost_4#2282, cval_partsupp_ps_comment#2269 AS cval_partsupp_ps_comment_4#2283, cdepval_partsupp_ps_availqty#2270 AS cdepval_partsupp_ps_availqty_4#2284, cdepval_partsupp_ps_supplycost#2271 AS cdepval_partsupp_ps_supplycost_4#2285, cdepval_partsupp_ps_comment#2272 AS cdepval_partsupp_ps_comment_4#2286, cps_availqty#2273 AS cps_availqty_4#2287, cps_supplycost#2274 AS cps_supplycost_4#2288, cps_comment#2275 AS cps_comment_4#2289]
         :  :  +- Relation[rid#2262,cpfk_part_partsupp#2263,cfpk_partsupp_part#2264,cpfk_supplier_partsupp#2265,cfpk_partsupp_supplier#2266,cval_partsupp_ps_availqty#2267,cval_partsupp_ps_supplycost#2268,cval_partsupp_ps_comment#2269,cdepval_partsupp_ps_availqty#2270,cdepval_partsupp_ps_supplycost#2271,cdepval_partsupp_ps_comment#2272,cps_availqty#2273,cps_supplycost#2274,cps_comment#2275] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :     +- Project [rid#2162 AS rid_3#2187, cval_part_p_name#2163 AS cval_part_p_name_3#2188, cval_part_p_mfgr#2164 AS cval_part_p_mfgr_3#2189, cval_part_p_type#2165 AS cval_part_p_type_3#2190, cval_part_p_size#2166 AS cval_part_p_size_3#2191, cval_part_p_container#2167 AS cval_part_p_container_3#2192, cval_part_p_retailprice#2168 AS cval_part_p_retailprice_3#2193, cval_part_p_comment#2169 AS cval_part_p_comment_3#2194, cval_part_p_brand#2170 AS cval_part_p_brand_3#2195, cdepval_part_p_name#2171 AS cdepval_part_p_name_3#2196, cdepval_part_p_mfgr#2172 AS cdepval_part_p_mfgr_3#2197, cdepval_part_p_type#2173 AS cdepval_part_p_type_3#2198, cdepval_part_p_size#2174 AS cdepval_part_p_size_3#2199, cdepval_part_p_container#2175 AS cdepval_part_p_container_3#2200, cdepval_part_p_retailprice#2176 AS cdepval_part_p_retailprice_3#2201, cdepval_part_p_comment#2177 AS cdepval_part_p_comment_3#2202, cdepval_part_p_brand#2178 AS cdepval_part_p_brand_3#2203, cp_name#2179 AS cp_name_3#2204, cp_mfgr#2180 AS cp_mfgr_3#2205, cp_type#2181 AS cp_type_3#2206, cp_size#2182 AS cp_size_3#2207, cp_container#2183 AS cp_container_3#2208, cp_retailprice#2184 AS cp_retailprice_3#2209, cp_comment#2185 AS cp_comment_3#2210, cp_brand#2186 AS cp_brand_3#2211]
         :        +- Relation[rid#2162,cval_part_p_name#2163,cval_part_p_mfgr#2164,cval_part_p_type#2165,cval_part_p_size#2166,cval_part_p_container#2167,cval_part_p_retailprice#2168,cval_part_p_comment#2169,cval_part_p_brand#2170,cdepval_part_p_name#2171,cdepval_part_p_mfgr#2172,cdepval_part_p_type#2173,cdepval_part_p_size#2174,cdepval_part_p_container#2175,cdepval_part_p_retailprice#2176,cdepval_part_p_comment#2177,cdepval_part_p_brand#2178,cp_name#2179,cp_mfgr#2180,cp_type#2181,cp_size#2182,cp_container#2183,cp_retailprice#2184,cp_comment#2185,cp_brand#2186] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#2126 AS rid_2#2144, cpfk_nation_supplier#2127 AS cpfk_nation_supplier_2#2145, cfpk_supplier_nation#2128 AS cfpk_supplier_nation_2#2146, cval_supplier_s_name#2129 AS cval_supplier_s_name_2#2147, cval_supplier_s_address#2130 AS cval_supplier_s_address_2#2148, cval_supplier_s_phone#2131 AS cval_supplier_s_phone_2#2149, cval_supplier_s_acctbal#2132 AS cval_supplier_s_acctbal_2#2150, cval_supplier_s_comment#2133 AS cval_supplier_s_comment_2#2151, cdepval_supplier_s_name#2134 AS cdepval_supplier_s_name_2#2152, cdepval_supplier_s_address#2135 AS cdepval_supplier_s_address_2#2153, cdepval_supplier_s_phone#2136 AS cdepval_supplier_s_phone_2#2154, cdepval_supplier_s_acctbal#2137 AS cdepval_supplier_s_acctbal_2#2155, cdepval_supplier_s_comment#2138 AS cdepval_supplier_s_comment_2#2156, cs_name#2139 AS cs_name_2#2157, cs_address#2140 AS cs_address_2#2158, cs_phone#2141 AS cs_phone_2#2159, cs_acctbal#2142 AS cs_acctbal_2#2160, cs_comment#2143 AS cs_comment_2#2161]
            :  +- Relation[rid#2126,cpfk_nation_supplier#2127,cfpk_supplier_nation#2128,cval_supplier_s_name#2129,cval_supplier_s_address#2130,cval_supplier_s_phone#2131,cval_supplier_s_acctbal#2132,cval_supplier_s_comment#2133,cdepval_supplier_s_name#2134,cdepval_supplier_s_address#2135,cdepval_supplier_s_phone#2136,cdepval_supplier_s_acctbal#2137,cdepval_supplier_s_comment#2138,cs_name#2139,cs_address#2140,cs_phone#2141,cs_acctbal#2142,cs_comment#2143] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
               :- Project [rid#2108 AS rid_1#2117, cpfk_region_nation#2109 AS cpfk_region_nation_1#2118, cfpk_nation_region#2110 AS cfpk_nation_region_1#2119, cval_nation_n_name#2111 AS cval_nation_n_name_1#2120, cval_nation_n_comment#2112 AS cval_nation_n_comment_1#2121, cdepval_nation_n_name#2113 AS cdepval_nation_n_name_1#2122, cdepval_nation_n_comment#2114 AS cdepval_nation_n_comment_1#2123, cn_name#2115 AS cn_name_1#2124, cn_comment#2116 AS cn_comment_1#2125]
               :  +- Relation[rid#2108,cpfk_region_nation#2109,cfpk_nation_region#2110,cval_nation_n_name#2111,cval_nation_n_comment#2112,cdepval_nation_n_name#2113,cdepval_nation_n_comment#2114,cn_name#2115,cn_comment#2116] JDBCRelation(tnation) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
                  +- Project [rid#2080 AS rid_0#2087, cval_region_r_name#2081 AS cval_region_r_name_0#2088, cval_region_r_comment#2082 AS cval_region_r_comment_0#2089, cdepval_region_r_name#2083 AS cdepval_region_r_name_0#2090, cdepval_region_r_comment#2084 AS cdepval_region_r_comment_0#2091, cr_name#2085 AS cr_name_0#2092, cr_comment#2086 AS cr_comment_0#2093]
                     +- Relation[rid#2080,cval_region_r_name#2081,cval_region_r_comment#2082,cdepval_region_r_name#2083,cdepval_region_r_comment#2084,cr_name#2085,cr_comment#2086] JDBCRelation(tregion) [numPartitions=1]

20/04/25 23:18:34 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexPkFk$ result size=3162
Elapsed time: 4066ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/25 23:18:37 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:18:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2391L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:18:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2391L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#2393 AS rid_0#2438, cpfk_orders_lineitem#2394 AS cpfk_orders_lineitem_0#2439, cpfk_supplier_lineitem#2395 AS cpfk_supplier_lineitem_0#2440, cfpk_lineitem_supplier#2396 AS cfpk_lineitem_supplier_0#2441, cfpk_lineitem_partsupp#2397 AS cfpk_lineitem_partsupp_0#2442, cpfk_part_lineitem#2398 AS cpfk_part_lineitem_0#2443, cfpk_lineitem_part#2399 AS cfpk_lineitem_part_0#2444, cpfk_partsupp_lineitem#2400 AS cpfk_partsupp_lineitem_0#2445, cfpk_lineitem_orders#2401 AS cfpk_lineitem_orders_0#2446, cval_lineitem_l_quantity#2402 AS cval_lineitem_l_quantity_0#2447, cval_lineitem_l_extendedprice#2403 AS cval_lineitem_l_extendedprice_0#2448, cval_lineitem_l_discount#2404 AS cval_lineitem_l_discount_0#2449, cval_lineitem_l_tax#2405 AS cval_lineitem_l_tax_0#2450, cval_lineitem_l_returnflag#2406 AS cval_lineitem_l_returnflag_0#2451, cval_lineitem_l_linestatus#2407 AS cval_lineitem_l_linestatus_0#2452, cval_lineitem_l_commitdate#2408 AS cval_lineitem_l_commitdate_0#2453, cval_lineitem_l_receiptdate#2409 AS cval_lineitem_l_receiptdate_0#2454, cval_lineitem_l_shipinstruct#2410 AS cval_lineitem_l_shipinstruct_0#2455, cval_lineitem_l_shipmode#2411 AS cval_lineitem_l_shipmode_0#2456, cval_lineitem_l_comment#2412 AS cval_lineitem_l_comment_0#2457, cval_lineitem_l_shipdate#2413 AS cval_lineitem_l_shipdate_0#2458, cdepval_lineitem_l_quantity#2414 AS cdepval_lineitem_l_quantity_0#2459, cdepval_lineitem_l_extendedprice#2415 AS cdepval_lineitem_l_extendedprice_0#2460, cdepval_lineitem_l_discount#2416 AS cdepval_lineitem_l_discount_0#2461, ... 21 more fields]
         :  +- Relation[rid#2393,cpfk_orders_lineitem#2394,cpfk_supplier_lineitem#2395,cfpk_lineitem_supplier#2396,cfpk_lineitem_partsupp#2397,cpfk_part_lineitem#2398,cfpk_lineitem_part#2399,cpfk_partsupp_lineitem#2400,cfpk_lineitem_orders#2401,cval_lineitem_l_quantity#2402,cval_lineitem_l_extendedprice#2403,cval_lineitem_l_discount#2404,cval_lineitem_l_tax#2405,cval_lineitem_l_returnflag#2406,cval_lineitem_l_linestatus#2407,cval_lineitem_l_commitdate#2408,cval_lineitem_l_receiptdate#2409,cval_lineitem_l_shipinstruct#2410,cval_lineitem_l_shipmode#2411,cval_lineitem_l_comment#2412,cval_lineitem_l_shipdate#2413,cdepval_lineitem_l_quantity#2414,cdepval_lineitem_l_extendedprice#2415,cdepval_lineitem_l_discount#2416,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2483 AS rid_1#2507, cpfk_customer_orders#2484 AS cpfk_customer_orders_1#2508, cfpk_orders_customer#2485 AS cfpk_orders_customer_1#2509, cval_orders_o_orderstatus#2486 AS cval_orders_o_orderstatus_1#2510, cval_orders_o_totalprice#2487 AS cval_orders_o_totalprice_1#2511, cval_orders_o_orderpriority#2488 AS cval_orders_o_orderpriority_1#2512, cval_orders_o_clerk#2489 AS cval_orders_o_clerk_1#2513, cval_orders_o_shippriority#2490 AS cval_orders_o_shippriority_1#2514, cval_orders_o_comment#2491 AS cval_orders_o_comment_1#2515, cval_orders_o_orderdate#2492 AS cval_orders_o_orderdate_1#2516, cdepval_orders_o_orderstatus#2493 AS cdepval_orders_o_orderstatus_1#2517, cdepval_orders_o_totalprice#2494 AS cdepval_orders_o_totalprice_1#2518, cdepval_orders_o_orderpriority#2495 AS cdepval_orders_o_orderpriority_1#2519, cdepval_orders_o_clerk#2496 AS cdepval_orders_o_clerk_1#2520, cdepval_orders_o_shippriority#2497 AS cdepval_orders_o_shippriority_1#2521, cdepval_orders_o_comment#2498 AS cdepval_orders_o_comment_1#2522, cdepval_orders_o_orderdate#2499 AS cdepval_orders_o_orderdate_1#2523, co_orderstatus#2500 AS co_orderstatus_1#2524, co_totalprice#2501 AS co_totalprice_1#2525, co_orderpriority#2502 AS co_orderpriority_1#2526, co_clerk#2503 AS co_clerk_1#2527, co_shippriority#2504 AS co_shippriority_1#2528, co_comment#2505 AS co_comment_1#2529, co_orderdate#2506 AS co_orderdate_1#2530]
            +- Relation[rid#2483,cpfk_customer_orders#2484,cfpk_orders_customer#2485,cval_orders_o_orderstatus#2486,cval_orders_o_totalprice#2487,cval_orders_o_orderpriority#2488,cval_orders_o_clerk#2489,cval_orders_o_shippriority#2490,cval_orders_o_comment#2491,cval_orders_o_orderdate#2492,cdepval_orders_o_orderstatus#2493,cdepval_orders_o_totalprice#2494,cdepval_orders_o_orderpriority#2495,cdepval_orders_o_clerk#2496,cdepval_orders_o_shippriority#2497,cdepval_orders_o_comment#2498,cdepval_orders_o_orderdate#2499,co_orderstatus#2500,co_totalprice#2501,co_orderpriority#2502,co_clerk#2503,co_shippriority#2504,co_comment#2505,co_orderdate#2506] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18624ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/25 23:18:56 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:18:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2604L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 23:18:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:18:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:18:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:18:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:18:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:18:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:18:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:18:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2604L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#2606 AS rid_0#2651, cpfk_orders_lineitem#2607 AS cpfk_orders_lineitem_0#2652, cpfk_supplier_lineitem#2608 AS cpfk_supplier_lineitem_0#2653, cfpk_lineitem_supplier#2609 AS cfpk_lineitem_supplier_0#2654, cfpk_lineitem_partsupp#2610 AS cfpk_lineitem_partsupp_0#2655, cpfk_part_lineitem#2611 AS cpfk_part_lineitem_0#2656, cfpk_lineitem_part#2612 AS cfpk_lineitem_part_0#2657, cpfk_partsupp_lineitem#2613 AS cpfk_partsupp_lineitem_0#2658, cfpk_lineitem_orders#2614 AS cfpk_lineitem_orders_0#2659, cval_lineitem_l_quantity#2615 AS cval_lineitem_l_quantity_0#2660, cval_lineitem_l_extendedprice#2616 AS cval_lineitem_l_extendedprice_0#2661, cval_lineitem_l_discount#2617 AS cval_lineitem_l_discount_0#2662, cval_lineitem_l_tax#2618 AS cval_lineitem_l_tax_0#2663, cval_lineitem_l_returnflag#2619 AS cval_lineitem_l_returnflag_0#2664, cval_lineitem_l_linestatus#2620 AS cval_lineitem_l_linestatus_0#2665, cval_lineitem_l_commitdate#2621 AS cval_lineitem_l_commitdate_0#2666, cval_lineitem_l_receiptdate#2622 AS cval_lineitem_l_receiptdate_0#2667, cval_lineitem_l_shipinstruct#2623 AS cval_lineitem_l_shipinstruct_0#2668, cval_lineitem_l_shipmode#2624 AS cval_lineitem_l_shipmode_0#2669, cval_lineitem_l_comment#2625 AS cval_lineitem_l_comment_0#2670, cval_lineitem_l_shipdate#2626 AS cval_lineitem_l_shipdate_0#2671, cdepval_lineitem_l_quantity#2627 AS cdepval_lineitem_l_quantity_0#2672, cdepval_lineitem_l_extendedprice#2628 AS cdepval_lineitem_l_extendedprice_0#2673, cdepval_lineitem_l_discount#2629 AS cdepval_lineitem_l_discount_0#2674, ... 21 more fields]
         :  +- Relation[rid#2606,cpfk_orders_lineitem#2607,cpfk_supplier_lineitem#2608,cfpk_lineitem_supplier#2609,cfpk_lineitem_partsupp#2610,cpfk_part_lineitem#2611,cfpk_lineitem_part#2612,cpfk_partsupp_lineitem#2613,cfpk_lineitem_orders#2614,cval_lineitem_l_quantity#2615,cval_lineitem_l_extendedprice#2616,cval_lineitem_l_discount#2617,cval_lineitem_l_tax#2618,cval_lineitem_l_returnflag#2619,cval_lineitem_l_linestatus#2620,cval_lineitem_l_commitdate#2621,cval_lineitem_l_receiptdate#2622,cval_lineitem_l_shipinstruct#2623,cval_lineitem_l_shipmode#2624,cval_lineitem_l_comment#2625,cval_lineitem_l_shipdate#2626,cdepval_lineitem_l_quantity#2627,cdepval_lineitem_l_extendedprice#2628,cdepval_lineitem_l_discount#2629,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
            :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
            :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
            :  :  :- Project [rid#2792 AS rid_2#2837, cpfk_orders_lineitem#2793 AS cpfk_orders_lineitem_2#2838, cpfk_supplier_lineitem#2794 AS cpfk_supplier_lineitem_2#2839, cfpk_lineitem_supplier#2795 AS cfpk_lineitem_supplier_2#2840, cfpk_lineitem_partsupp#2796 AS cfpk_lineitem_partsupp_2#2841, cpfk_part_lineitem#2797 AS cpfk_part_lineitem_2#2842, cfpk_lineitem_part#2798 AS cfpk_lineitem_part_2#2843, cpfk_partsupp_lineitem#2799 AS cpfk_partsupp_lineitem_2#2844, cfpk_lineitem_orders#2800 AS cfpk_lineitem_orders_2#2845, cval_lineitem_l_quantity#2801 AS cval_lineitem_l_quantity_2#2846, cval_lineitem_l_extendedprice#2802 AS cval_lineitem_l_extendedprice_2#2847, cval_lineitem_l_discount#2803 AS cval_lineitem_l_discount_2#2848, cval_lineitem_l_tax#2804 AS cval_lineitem_l_tax_2#2849, cval_lineitem_l_returnflag#2805 AS cval_lineitem_l_returnflag_2#2850, cval_lineitem_l_linestatus#2806 AS cval_lineitem_l_linestatus_2#2851, cval_lineitem_l_commitdate#2807 AS cval_lineitem_l_commitdate_2#2852, cval_lineitem_l_receiptdate#2808 AS cval_lineitem_l_receiptdate_2#2853, cval_lineitem_l_shipinstruct#2809 AS cval_lineitem_l_shipinstruct_2#2854, cval_lineitem_l_shipmode#2810 AS cval_lineitem_l_shipmode_2#2855, cval_lineitem_l_comment#2811 AS cval_lineitem_l_comment_2#2856, cval_lineitem_l_shipdate#2812 AS cval_lineitem_l_shipdate_2#2857, cdepval_lineitem_l_quantity#2813 AS cdepval_lineitem_l_quantity_2#2858, cdepval_lineitem_l_extendedprice#2814 AS cdepval_lineitem_l_extendedprice_2#2859, cdepval_lineitem_l_discount#2815 AS cdepval_lineitem_l_discount_2#2860, ... 21 more fields]
            :  :  :  +- Relation[rid#2792,cpfk_orders_lineitem#2793,cpfk_supplier_lineitem#2794,cfpk_lineitem_supplier#2795,cfpk_lineitem_partsupp#2796,cpfk_part_lineitem#2797,cfpk_lineitem_part#2798,cpfk_partsupp_lineitem#2799,cfpk_lineitem_orders#2800,cval_lineitem_l_quantity#2801,cval_lineitem_l_extendedprice#2802,cval_lineitem_l_discount#2803,cval_lineitem_l_tax#2804,cval_lineitem_l_returnflag#2805,cval_lineitem_l_linestatus#2806,cval_lineitem_l_commitdate#2807,cval_lineitem_l_receiptdate#2808,cval_lineitem_l_shipinstruct#2809,cval_lineitem_l_shipmode#2810,cval_lineitem_l_comment#2811,cval_lineitem_l_shipdate#2812,cdepval_lineitem_l_quantity#2813,cdepval_lineitem_l_extendedprice#2814,cdepval_lineitem_l_discount#2815,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
            :  :     +- Project [rid#2696 AS rid_1#2720, cpfk_customer_orders#2697 AS cpfk_customer_orders_1#2721, cfpk_orders_customer#2698 AS cfpk_orders_customer_1#2722, cval_orders_o_orderstatus#2699 AS cval_orders_o_orderstatus_1#2723, cval_orders_o_totalprice#2700 AS cval_orders_o_totalprice_1#2724, cval_orders_o_orderpriority#2701 AS cval_orders_o_orderpriority_1#2725, cval_orders_o_clerk#2702 AS cval_orders_o_clerk_1#2726, cval_orders_o_shippriority#2703 AS cval_orders_o_shippriority_1#2727, cval_orders_o_comment#2704 AS cval_orders_o_comment_1#2728, cval_orders_o_orderdate#2705 AS cval_orders_o_orderdate_1#2729, cdepval_orders_o_orderstatus#2706 AS cdepval_orders_o_orderstatus_1#2730, cdepval_orders_o_totalprice#2707 AS cdepval_orders_o_totalprice_1#2731, cdepval_orders_o_orderpriority#2708 AS cdepval_orders_o_orderpriority_1#2732, cdepval_orders_o_clerk#2709 AS cdepval_orders_o_clerk_1#2733, cdepval_orders_o_shippriority#2710 AS cdepval_orders_o_shippriority_1#2734, cdepval_orders_o_comment#2711 AS cdepval_orders_o_comment_1#2735, cdepval_orders_o_orderdate#2712 AS cdepval_orders_o_orderdate_1#2736, co_orderstatus#2713 AS co_orderstatus_1#2737, co_totalprice#2714 AS co_totalprice_1#2738, co_orderpriority#2715 AS co_orderpriority_1#2739, co_clerk#2716 AS co_clerk_1#2740, co_shippriority#2717 AS co_shippriority_1#2741, co_comment#2718 AS co_comment_1#2742, co_orderdate#2719 AS co_orderdate_1#2743]
            :  :        +- Relation[rid#2696,cpfk_customer_orders#2697,cfpk_orders_customer#2698,cval_orders_o_orderstatus#2699,cval_orders_o_totalprice#2700,cval_orders_o_orderpriority#2701,cval_orders_o_clerk#2702,cval_orders_o_shippriority#2703,cval_orders_o_comment#2704,cval_orders_o_orderdate#2705,cdepval_orders_o_orderstatus#2706,cdepval_orders_o_totalprice#2707,cdepval_orders_o_orderpriority#2708,cdepval_orders_o_clerk#2709,cdepval_orders_o_shippriority#2710,cdepval_orders_o_comment#2711,cdepval_orders_o_orderdate#2712,co_orderstatus#2713,co_totalprice#2714,co_orderpriority#2715,co_clerk#2716,co_shippriority#2717,co_comment#2718,co_orderdate#2719] JDBCRelation(torders) [numPartitions=1]
            :  +- Project [rid#2882 AS rid_3#2900, cpfk_nation_supplier#2883 AS cpfk_nation_supplier_3#2901, cfpk_supplier_nation#2884 AS cfpk_supplier_nation_3#2902, cval_supplier_s_name#2885 AS cval_supplier_s_name_3#2903, cval_supplier_s_address#2886 AS cval_supplier_s_address_3#2904, cval_supplier_s_phone#2887 AS cval_supplier_s_phone_3#2905, cval_supplier_s_acctbal#2888 AS cval_supplier_s_acctbal_3#2906, cval_supplier_s_comment#2889 AS cval_supplier_s_comment_3#2907, cdepval_supplier_s_name#2890 AS cdepval_supplier_s_name_3#2908, cdepval_supplier_s_address#2891 AS cdepval_supplier_s_address_3#2909, cdepval_supplier_s_phone#2892 AS cdepval_supplier_s_phone_3#2910, cdepval_supplier_s_acctbal#2893 AS cdepval_supplier_s_acctbal_3#2911, cdepval_supplier_s_comment#2894 AS cdepval_supplier_s_comment_3#2912, cs_name#2895 AS cs_name_3#2913, cs_address#2896 AS cs_address_3#2914, cs_phone#2897 AS cs_phone_3#2915, cs_acctbal#2898 AS cs_acctbal_3#2916, cs_comment#2899 AS cs_comment_3#2917]
            :     +- Relation[rid#2882,cpfk_nation_supplier#2883,cfpk_supplier_nation#2884,cval_supplier_s_name#2885,cval_supplier_s_address#2886,cval_supplier_s_phone#2887,cval_supplier_s_acctbal#2888,cval_supplier_s_comment#2889,cdepval_supplier_s_name#2890,cdepval_supplier_s_address#2891,cdepval_supplier_s_phone#2892,cdepval_supplier_s_acctbal#2893,cdepval_supplier_s_comment#2894,cs_name#2895,cs_address#2896,cs_phone#2897,cs_acctbal#2898,cs_comment#2899] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
               +- Project [rid#2918 AS rid_4#2927, cpfk_region_nation#2919 AS cpfk_region_nation_4#2928, cfpk_nation_region#2920 AS cfpk_nation_region_4#2929, cval_nation_n_name#2921 AS cval_nation_n_name_4#2930, cval_nation_n_comment#2922 AS cval_nation_n_comment_4#2931, cdepval_nation_n_name#2923 AS cdepval_nation_n_name_4#2932, cdepval_nation_n_comment#2924 AS cdepval_nation_n_comment_4#2933, cn_name#2925 AS cn_name_4#2934, cn_comment#2926 AS cn_comment_4#2935]
                  +- Relation[rid#2918,cpfk_region_nation#2919,cfpk_nation_region#2920,cval_nation_n_name#2921,cval_nation_n_comment#2922,cdepval_nation_n_name#2923,cdepval_nation_n_comment#2924,cn_name#2925,cn_comment#2926] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 75690ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 23:20:12 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:20:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3104L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:20:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:20:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:20:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:20:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:20:12 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:20:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:20:12 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:20:12 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:20:12 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:20:12 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:20:12 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:20:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3104L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#3238 AS rid_4#3283, cpfk_orders_lineitem#3239 AS cpfk_orders_lineitem_4#3284, cpfk_supplier_lineitem#3240 AS cpfk_supplier_lineitem_4#3285, cfpk_lineitem_supplier#3241 AS cfpk_lineitem_supplier_4#3286, cfpk_lineitem_partsupp#3242 AS cfpk_lineitem_partsupp_4#3287, cpfk_part_lineitem#3243 AS cpfk_part_lineitem_4#3288, cfpk_lineitem_part#3244 AS cfpk_lineitem_part_4#3289, cpfk_partsupp_lineitem#3245 AS cpfk_partsupp_lineitem_4#3290, cfpk_lineitem_orders#3246 AS cfpk_lineitem_orders_4#3291, cval_lineitem_l_quantity#3247 AS cval_lineitem_l_quantity_4#3292, cval_lineitem_l_extendedprice#3248 AS cval_lineitem_l_extendedprice_4#3293, cval_lineitem_l_discount#3249 AS cval_lineitem_l_discount_4#3294, cval_lineitem_l_tax#3250 AS cval_lineitem_l_tax_4#3295, cval_lineitem_l_returnflag#3251 AS cval_lineitem_l_returnflag_4#3296, cval_lineitem_l_linestatus#3252 AS cval_lineitem_l_linestatus_4#3297, cval_lineitem_l_commitdate#3253 AS cval_lineitem_l_commitdate_4#3298, cval_lineitem_l_receiptdate#3254 AS cval_lineitem_l_receiptdate_4#3299, cval_lineitem_l_shipinstruct#3255 AS cval_lineitem_l_shipinstruct_4#3300, cval_lineitem_l_shipmode#3256 AS cval_lineitem_l_shipmode_4#3301, cval_lineitem_l_comment#3257 AS cval_lineitem_l_comment_4#3302, cval_lineitem_l_shipdate#3258 AS cval_lineitem_l_shipdate_4#3303, cdepval_lineitem_l_quantity#3259 AS cdepval_lineitem_l_quantity_4#3304, cdepval_lineitem_l_extendedprice#3260 AS cdepval_lineitem_l_extendedprice_4#3305, cdepval_lineitem_l_discount#3261 AS cdepval_lineitem_l_discount_4#3306, ... 21 more fields]
         :  :  +- Relation[rid#3238,cpfk_orders_lineitem#3239,cpfk_supplier_lineitem#3240,cfpk_lineitem_supplier#3241,cfpk_lineitem_partsupp#3242,cpfk_part_lineitem#3243,cfpk_lineitem_part#3244,cpfk_partsupp_lineitem#3245,cfpk_lineitem_orders#3246,cval_lineitem_l_quantity#3247,cval_lineitem_l_extendedprice#3248,cval_lineitem_l_discount#3249,cval_lineitem_l_tax#3250,cval_lineitem_l_returnflag#3251,cval_lineitem_l_linestatus#3252,cval_lineitem_l_commitdate#3253,cval_lineitem_l_receiptdate#3254,cval_lineitem_l_shipinstruct#3255,cval_lineitem_l_shipmode#3256,cval_lineitem_l_comment#3257,cval_lineitem_l_shipdate#3258,cdepval_lineitem_l_quantity#3259,cdepval_lineitem_l_extendedprice#3260,cdepval_lineitem_l_discount#3261,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#3160 AS rid_2#3174, cpfk_part_partsupp#3161 AS cpfk_part_partsupp_2#3175, cfpk_partsupp_part#3162 AS cfpk_partsupp_part_2#3176, cpfk_supplier_partsupp#3163 AS cpfk_supplier_partsupp_2#3177, cfpk_partsupp_supplier#3164 AS cfpk_partsupp_supplier_2#3178, cval_partsupp_ps_availqty#3165 AS cval_partsupp_ps_availqty_2#3179, cval_partsupp_ps_supplycost#3166 AS cval_partsupp_ps_supplycost_2#3180, cval_partsupp_ps_comment#3167 AS cval_partsupp_ps_comment_2#3181, cdepval_partsupp_ps_availqty#3168 AS cdepval_partsupp_ps_availqty_2#3182, cdepval_partsupp_ps_supplycost#3169 AS cdepval_partsupp_ps_supplycost_2#3183, cdepval_partsupp_ps_comment#3170 AS cdepval_partsupp_ps_comment_2#3184, cps_availqty#3171 AS cps_availqty_2#3185, cps_supplycost#3172 AS cps_supplycost_2#3186, cps_comment#3173 AS cps_comment_2#3187]
         :     :  :  +- Relation[rid#3160,cpfk_part_partsupp#3161,cfpk_partsupp_part#3162,cpfk_supplier_partsupp#3163,cfpk_partsupp_supplier#3164,cval_partsupp_ps_availqty#3165,cval_partsupp_ps_supplycost#3166,cval_partsupp_ps_comment#3167,cdepval_partsupp_ps_availqty#3168,cdepval_partsupp_ps_supplycost#3169,cdepval_partsupp_ps_comment#3170,cps_availqty#3171,cps_supplycost#3172,cps_comment#3173] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#3124 AS rid_1#3142, cpfk_nation_supplier#3125 AS cpfk_nation_supplier_1#3143, cfpk_supplier_nation#3126 AS cfpk_supplier_nation_1#3144, cval_supplier_s_name#3127 AS cval_supplier_s_name_1#3145, cval_supplier_s_address#3128 AS cval_supplier_s_address_1#3146, cval_supplier_s_phone#3129 AS cval_supplier_s_phone_1#3147, cval_supplier_s_acctbal#3130 AS cval_supplier_s_acctbal_1#3148, cval_supplier_s_comment#3131 AS cval_supplier_s_comment_1#3149, cdepval_supplier_s_name#3132 AS cdepval_supplier_s_name_1#3150, cdepval_supplier_s_address#3133 AS cdepval_supplier_s_address_1#3151, cdepval_supplier_s_phone#3134 AS cdepval_supplier_s_phone_1#3152, cdepval_supplier_s_acctbal#3135 AS cdepval_supplier_s_acctbal_1#3153, cdepval_supplier_s_comment#3136 AS cdepval_supplier_s_comment_1#3154, cs_name#3137 AS cs_name_1#3155, cs_address#3138 AS cs_address_1#3156, cs_phone#3139 AS cs_phone_1#3157, cs_acctbal#3140 AS cs_acctbal_1#3158, cs_comment#3141 AS cs_comment_1#3159]
         :     :     :  +- Relation[rid#3124,cpfk_nation_supplier#3125,cfpk_supplier_nation#3126,cval_supplier_s_name#3127,cval_supplier_s_address#3128,cval_supplier_s_phone#3129,cval_supplier_s_acctbal#3130,cval_supplier_s_comment#3131,cdepval_supplier_s_name#3132,cdepval_supplier_s_address#3133,cdepval_supplier_s_phone#3134,cdepval_supplier_s_acctbal#3135,cdepval_supplier_s_comment#3136,cs_name#3137,cs_address#3138,cs_phone#3139,cs_acctbal#3140,cs_comment#3141] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#3106 AS rid_0#3115, cpfk_region_nation#3107 AS cpfk_region_nation_0#3116, cfpk_nation_region#3108 AS cfpk_nation_region_0#3117, cval_nation_n_name#3109 AS cval_nation_n_name_0#3118, cval_nation_n_comment#3110 AS cval_nation_n_comment_0#3119, cdepval_nation_n_name#3111 AS cdepval_nation_n_name_0#3120, cdepval_nation_n_comment#3112 AS cdepval_nation_n_comment_0#3121, cn_name#3113 AS cn_name_0#3122, cn_comment#3114 AS cn_comment_0#3123]
         :     :        +- Relation[rid#3106,cpfk_region_nation#3107,cfpk_nation_region#3108,cval_nation_n_name#3109,cval_nation_n_comment#3110,cdepval_nation_n_name#3111,cdepval_nation_n_comment#3112,cn_name#3113,cn_comment#3114] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#3188 AS rid_3#3213, cval_part_p_name#3189 AS cval_part_p_name_3#3214, cval_part_p_mfgr#3190 AS cval_part_p_mfgr_3#3215, cval_part_p_type#3191 AS cval_part_p_type_3#3216, cval_part_p_size#3192 AS cval_part_p_size_3#3217, cval_part_p_container#3193 AS cval_part_p_container_3#3218, cval_part_p_retailprice#3194 AS cval_part_p_retailprice_3#3219, cval_part_p_comment#3195 AS cval_part_p_comment_3#3220, cval_part_p_brand#3196 AS cval_part_p_brand_3#3221, cdepval_part_p_name#3197 AS cdepval_part_p_name_3#3222, cdepval_part_p_mfgr#3198 AS cdepval_part_p_mfgr_3#3223, cdepval_part_p_type#3199 AS cdepval_part_p_type_3#3224, cdepval_part_p_size#3200 AS cdepval_part_p_size_3#3225, cdepval_part_p_container#3201 AS cdepval_part_p_container_3#3226, cdepval_part_p_retailprice#3202 AS cdepval_part_p_retailprice_3#3227, cdepval_part_p_comment#3203 AS cdepval_part_p_comment_3#3228, cdepval_part_p_brand#3204 AS cdepval_part_p_brand_3#3229, cp_name#3205 AS cp_name_3#3230, cp_mfgr#3206 AS cp_mfgr_3#3231, cp_type#3207 AS cp_type_3#3232, cp_size#3208 AS cp_size_3#3233, cp_container#3209 AS cp_container_3#3234, cp_retailprice#3210 AS cp_retailprice_3#3235, cp_comment#3211 AS cp_comment_3#3236, cp_brand#3212 AS cp_brand_3#3237]
         :        +- Relation[rid#3188,cval_part_p_name#3189,cval_part_p_mfgr#3190,cval_part_p_type#3191,cval_part_p_size#3192,cval_part_p_container#3193,cval_part_p_retailprice#3194,cval_part_p_comment#3195,cval_part_p_brand#3196,cdepval_part_p_name#3197,cdepval_part_p_mfgr#3198,cdepval_part_p_type#3199,cdepval_part_p_size#3200,cdepval_part_p_container#3201,cdepval_part_p_retailprice#3202,cdepval_part_p_comment#3203,cdepval_part_p_brand#3204,cp_name#3205,cp_mfgr#3206,cp_type#3207,cp_size#3208,cp_container#3209,cp_retailprice#3210,cp_comment#3211,cp_brand#3212] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#3328 AS rid_5#3352, cpfk_customer_orders#3329 AS cpfk_customer_orders_5#3353, cfpk_orders_customer#3330 AS cfpk_orders_customer_5#3354, cval_orders_o_orderstatus#3331 AS cval_orders_o_orderstatus_5#3355, cval_orders_o_totalprice#3332 AS cval_orders_o_totalprice_5#3356, cval_orders_o_orderpriority#3333 AS cval_orders_o_orderpriority_5#3357, cval_orders_o_clerk#3334 AS cval_orders_o_clerk_5#3358, cval_orders_o_shippriority#3335 AS cval_orders_o_shippriority_5#3359, cval_orders_o_comment#3336 AS cval_orders_o_comment_5#3360, cval_orders_o_orderdate#3337 AS cval_orders_o_orderdate_5#3361, cdepval_orders_o_orderstatus#3338 AS cdepval_orders_o_orderstatus_5#3362, cdepval_orders_o_totalprice#3339 AS cdepval_orders_o_totalprice_5#3363, cdepval_orders_o_orderpriority#3340 AS cdepval_orders_o_orderpriority_5#3364, cdepval_orders_o_clerk#3341 AS cdepval_orders_o_clerk_5#3365, cdepval_orders_o_shippriority#3342 AS cdepval_orders_o_shippriority_5#3366, cdepval_orders_o_comment#3343 AS cdepval_orders_o_comment_5#3367, cdepval_orders_o_orderdate#3344 AS cdepval_orders_o_orderdate_5#3368, co_orderstatus#3345 AS co_orderstatus_5#3369, co_totalprice#3346 AS co_totalprice_5#3370, co_orderpriority#3347 AS co_orderpriority_5#3371, co_clerk#3348 AS co_clerk_5#3372, co_shippriority#3349 AS co_shippriority_5#3373, co_comment#3350 AS co_comment_5#3374, co_orderdate#3351 AS co_orderdate_5#3375]
            +- Relation[rid#3328,cpfk_customer_orders#3329,cfpk_orders_customer#3330,cval_orders_o_orderstatus#3331,cval_orders_o_totalprice#3332,cval_orders_o_orderpriority#3333,cval_orders_o_clerk#3334,cval_orders_o_shippriority#3335,cval_orders_o_comment#3336,cval_orders_o_orderdate#3337,cdepval_orders_o_orderstatus#3338,cdepval_orders_o_totalprice#3339,cdepval_orders_o_orderpriority#3340,cdepval_orders_o_clerk#3341,cdepval_orders_o_shippriority#3342,cdepval_orders_o_comment#3343,cdepval_orders_o_orderdate#3344,co_orderstatus#3345,co_totalprice#3346,co_orderpriority#3347,co_clerk#3348,co_shippriority#3349,co_comment#3350,co_orderdate#3351] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 38000ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/25 23:20:50 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:20:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3519L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:20:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:20:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:20:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:20:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:20:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:20:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:20:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:20:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:20:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:20:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:20:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:20:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3519L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#3593 AS rid_2#3638, cpfk_orders_lineitem#3594 AS cpfk_orders_lineitem_2#3639, cpfk_supplier_lineitem#3595 AS cpfk_supplier_lineitem_2#3640, cfpk_lineitem_supplier#3596 AS cfpk_lineitem_supplier_2#3641, cfpk_lineitem_partsupp#3597 AS cfpk_lineitem_partsupp_2#3642, cpfk_part_lineitem#3598 AS cpfk_part_lineitem_2#3643, cfpk_lineitem_part#3599 AS cfpk_lineitem_part_2#3644, cpfk_partsupp_lineitem#3600 AS cpfk_partsupp_lineitem_2#3645, cfpk_lineitem_orders#3601 AS cfpk_lineitem_orders_2#3646, cval_lineitem_l_quantity#3602 AS cval_lineitem_l_quantity_2#3647, cval_lineitem_l_extendedprice#3603 AS cval_lineitem_l_extendedprice_2#3648, cval_lineitem_l_discount#3604 AS cval_lineitem_l_discount_2#3649, cval_lineitem_l_tax#3605 AS cval_lineitem_l_tax_2#3650, cval_lineitem_l_returnflag#3606 AS cval_lineitem_l_returnflag_2#3651, cval_lineitem_l_linestatus#3607 AS cval_lineitem_l_linestatus_2#3652, cval_lineitem_l_commitdate#3608 AS cval_lineitem_l_commitdate_2#3653, cval_lineitem_l_receiptdate#3609 AS cval_lineitem_l_receiptdate_2#3654, cval_lineitem_l_shipinstruct#3610 AS cval_lineitem_l_shipinstruct_2#3655, cval_lineitem_l_shipmode#3611 AS cval_lineitem_l_shipmode_2#3656, cval_lineitem_l_comment#3612 AS cval_lineitem_l_comment_2#3657, cval_lineitem_l_shipdate#3613 AS cval_lineitem_l_shipdate_2#3658, cdepval_lineitem_l_quantity#3614 AS cdepval_lineitem_l_quantity_2#3659, cdepval_lineitem_l_extendedprice#3615 AS cdepval_lineitem_l_extendedprice_2#3660, cdepval_lineitem_l_discount#3616 AS cdepval_lineitem_l_discount_2#3661, ... 21 more fields]
         :  :  +- Relation[rid#3593,cpfk_orders_lineitem#3594,cpfk_supplier_lineitem#3595,cfpk_lineitem_supplier#3596,cfpk_lineitem_partsupp#3597,cpfk_part_lineitem#3598,cfpk_lineitem_part#3599,cpfk_partsupp_lineitem#3600,cfpk_lineitem_orders#3601,cval_lineitem_l_quantity#3602,cval_lineitem_l_extendedprice#3603,cval_lineitem_l_discount#3604,cval_lineitem_l_tax#3605,cval_lineitem_l_returnflag#3606,cval_lineitem_l_linestatus#3607,cval_lineitem_l_commitdate#3608,cval_lineitem_l_receiptdate#3609,cval_lineitem_l_shipinstruct#3610,cval_lineitem_l_shipmode#3611,cval_lineitem_l_comment#3612,cval_lineitem_l_shipdate#3613,cdepval_lineitem_l_quantity#3614,cdepval_lineitem_l_extendedprice#3615,cdepval_lineitem_l_discount#3616,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :- Project [rid#3557 AS rid_1#3575, cpfk_nation_supplier#3558 AS cpfk_nation_supplier_1#3576, cfpk_supplier_nation#3559 AS cfpk_supplier_nation_1#3577, cval_supplier_s_name#3560 AS cval_supplier_s_name_1#3578, cval_supplier_s_address#3561 AS cval_supplier_s_address_1#3579, cval_supplier_s_phone#3562 AS cval_supplier_s_phone_1#3580, cval_supplier_s_acctbal#3563 AS cval_supplier_s_acctbal_1#3581, cval_supplier_s_comment#3564 AS cval_supplier_s_comment_1#3582, cdepval_supplier_s_name#3565 AS cdepval_supplier_s_name_1#3583, cdepval_supplier_s_address#3566 AS cdepval_supplier_s_address_1#3584, cdepval_supplier_s_phone#3567 AS cdepval_supplier_s_phone_1#3585, cdepval_supplier_s_acctbal#3568 AS cdepval_supplier_s_acctbal_1#3586, cdepval_supplier_s_comment#3569 AS cdepval_supplier_s_comment_1#3587, cs_name#3570 AS cs_name_1#3588, cs_address#3571 AS cs_address_1#3589, cs_phone#3572 AS cs_phone_1#3590, cs_acctbal#3573 AS cs_acctbal_1#3591, cs_comment#3574 AS cs_comment_1#3592]
         :     :  +- Relation[rid#3557,cpfk_nation_supplier#3558,cfpk_supplier_nation#3559,cval_supplier_s_name#3560,cval_supplier_s_address#3561,cval_supplier_s_phone#3562,cval_supplier_s_acctbal#3563,cval_supplier_s_comment#3564,cdepval_supplier_s_name#3565,cdepval_supplier_s_address#3566,cdepval_supplier_s_phone#3567,cdepval_supplier_s_acctbal#3568,cdepval_supplier_s_comment#3569,cs_name#3570,cs_address#3571,cs_phone#3572,cs_acctbal#3573,cs_comment#3574] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :        +- Project [rid#3521 AS rid_0#3530, cpfk_region_nation#3522 AS cpfk_region_nation_0#3531, cfpk_nation_region#3523 AS cfpk_nation_region_0#3532, cval_nation_n_name#3524 AS cval_nation_n_name_0#3533, cval_nation_n_comment#3525 AS cval_nation_n_comment_0#3534, cdepval_nation_n_name#3526 AS cdepval_nation_n_name_0#3535, cdepval_nation_n_comment#3527 AS cdepval_nation_n_comment_0#3536, cn_name#3528 AS cn_name_0#3537, cn_comment#3529 AS cn_comment_0#3538]
         :           +- Relation[rid#3521,cpfk_region_nation#3522,cfpk_nation_region#3523,cval_nation_n_name#3524,cval_nation_n_comment#3525,cdepval_nation_n_name#3526,cdepval_nation_n_comment#3527,cn_name#3528,cn_comment#3529] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#3761 AS rid_5#3785, cpfk_customer_orders#3762 AS cpfk_customer_orders_5#3786, cfpk_orders_customer#3763 AS cfpk_orders_customer_5#3787, cval_orders_o_orderstatus#3764 AS cval_orders_o_orderstatus_5#3788, cval_orders_o_totalprice#3765 AS cval_orders_o_totalprice_5#3789, cval_orders_o_orderpriority#3766 AS cval_orders_o_orderpriority_5#3790, cval_orders_o_clerk#3767 AS cval_orders_o_clerk_5#3791, cval_orders_o_shippriority#3768 AS cval_orders_o_shippriority_5#3792, cval_orders_o_comment#3769 AS cval_orders_o_comment_5#3793, cval_orders_o_orderdate#3770 AS cval_orders_o_orderdate_5#3794, cdepval_orders_o_orderstatus#3771 AS cdepval_orders_o_orderstatus_5#3795, cdepval_orders_o_totalprice#3772 AS cdepval_orders_o_totalprice_5#3796, cdepval_orders_o_orderpriority#3773 AS cdepval_orders_o_orderpriority_5#3797, cdepval_orders_o_clerk#3774 AS cdepval_orders_o_clerk_5#3798, cdepval_orders_o_shippriority#3775 AS cdepval_orders_o_shippriority_5#3799, cdepval_orders_o_comment#3776 AS cdepval_orders_o_comment_5#3800, cdepval_orders_o_orderdate#3777 AS cdepval_orders_o_orderdate_5#3801, co_orderstatus#3778 AS co_orderstatus_5#3802, co_totalprice#3779 AS co_totalprice_5#3803, co_orderpriority#3780 AS co_orderpriority_5#3804, co_clerk#3781 AS co_clerk_5#3805, co_shippriority#3782 AS co_shippriority_5#3806, co_comment#3783 AS co_comment_5#3807, co_orderdate#3784 AS co_orderdate_5#3808]
            :  +- Relation[rid#3761,cpfk_customer_orders#3762,cfpk_orders_customer#3763,cval_orders_o_orderstatus#3764,cval_orders_o_totalprice#3765,cval_orders_o_orderpriority#3766,cval_orders_o_clerk#3767,cval_orders_o_shippriority#3768,cval_orders_o_comment#3769,cval_orders_o_orderdate#3770,cdepval_orders_o_orderstatus#3771,cdepval_orders_o_totalprice#3772,cdepval_orders_o_orderpriority#3773,cdepval_orders_o_clerk#3774,cdepval_orders_o_shippriority#3775,cdepval_orders_o_comment#3776,cdepval_orders_o_orderdate#3777,co_orderstatus#3778,co_totalprice#3779,co_orderpriority#3780,co_clerk#3781,co_shippriority#3782,co_comment#3783,co_orderdate#3784] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_4, BinaryType)), 'cfpk_customer_nation_4) = 'rid_3)
               :- Project [rid#3719 AS rid_4#3740, cpfk_nation_customer#3720 AS cpfk_nation_customer_4#3741, cfpk_customer_nation#3721 AS cfpk_customer_nation_4#3742, cval_customer_c_name#3722 AS cval_customer_c_name_4#3743, cval_customer_c_address#3723 AS cval_customer_c_address_4#3744, cval_customer_c_phone#3724 AS cval_customer_c_phone_4#3745, cval_customer_c_acctbal#3725 AS cval_customer_c_acctbal_4#3746, cval_customer_c_comment#3726 AS cval_customer_c_comment_4#3747, cval_customer_c_mktsegment#3727 AS cval_customer_c_mktsegment_4#3748, cdepval_customer_c_name#3728 AS cdepval_customer_c_name_4#3749, cdepval_customer_c_address#3729 AS cdepval_customer_c_address_4#3750, cdepval_customer_c_phone#3730 AS cdepval_customer_c_phone_4#3751, cdepval_customer_c_acctbal#3731 AS cdepval_customer_c_acctbal_4#3752, cdepval_customer_c_comment#3732 AS cdepval_customer_c_comment_4#3753, cdepval_customer_c_mktsegment#3733 AS cdepval_customer_c_mktsegment_4#3754, cc_name#3734 AS cc_name_4#3755, cc_address#3735 AS cc_address_4#3756, cc_phone#3736 AS cc_phone_4#3757, cc_acctbal#3737 AS cc_acctbal_4#3758, cc_comment#3738 AS cc_comment_4#3759, cc_mktsegment#3739 AS cc_mktsegment_4#3760]
               :  +- Relation[rid#3719,cpfk_nation_customer#3720,cfpk_customer_nation#3721,cval_customer_c_name#3722,cval_customer_c_address#3723,cval_customer_c_phone#3724,cval_customer_c_acctbal#3725,cval_customer_c_comment#3726,cval_customer_c_mktsegment#3727,cdepval_customer_c_name#3728,cdepval_customer_c_address#3729,cdepval_customer_c_phone#3730,cdepval_customer_c_acctbal#3731,cdepval_customer_c_comment#3732,cdepval_customer_c_mktsegment#3733,cc_name#3734,cc_address#3735,cc_phone#3736,cc_acctbal#3737,cc_comment#3738,cc_mktsegment#3739] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
                  +- Project [rid#3683 AS rid_3#3692, cpfk_region_nation#3684 AS cpfk_region_nation_3#3693, cfpk_nation_region#3685 AS cfpk_nation_region_3#3694, cval_nation_n_name#3686 AS cval_nation_n_name_3#3695, cval_nation_n_comment#3687 AS cval_nation_n_comment_3#3696, cdepval_nation_n_name#3688 AS cdepval_nation_n_name_3#3697, cdepval_nation_n_comment#3689 AS cdepval_nation_n_comment_3#3698, cn_name#3690 AS cn_name_3#3699, cn_comment#3691 AS cn_comment_3#3700]
                     +- Relation[rid#3683,cpfk_region_nation#3684,cfpk_nation_region#3685,cval_nation_n_name#3686,cval_nation_n_comment#3687,cdepval_nation_n_name#3688,cdepval_nation_n_comment#3689,cn_name#3690,cn_comment#3691] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 34957ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 23:21:25 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:21:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3944L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:21:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:21:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:21:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:21:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:21:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:21:25 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:21:25 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:21:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3944L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#4000 AS rid_2#4045, cpfk_orders_lineitem#4001 AS cpfk_orders_lineitem_2#4046, cpfk_supplier_lineitem#4002 AS cpfk_supplier_lineitem_2#4047, cfpk_lineitem_supplier#4003 AS cfpk_lineitem_supplier_2#4048, cfpk_lineitem_partsupp#4004 AS cfpk_lineitem_partsupp_2#4049, cpfk_part_lineitem#4005 AS cpfk_part_lineitem_2#4050, cfpk_lineitem_part#4006 AS cfpk_lineitem_part_2#4051, cpfk_partsupp_lineitem#4007 AS cpfk_partsupp_lineitem_2#4052, cfpk_lineitem_orders#4008 AS cfpk_lineitem_orders_2#4053, cval_lineitem_l_quantity#4009 AS cval_lineitem_l_quantity_2#4054, cval_lineitem_l_extendedprice#4010 AS cval_lineitem_l_extendedprice_2#4055, cval_lineitem_l_discount#4011 AS cval_lineitem_l_discount_2#4056, cval_lineitem_l_tax#4012 AS cval_lineitem_l_tax_2#4057, cval_lineitem_l_returnflag#4013 AS cval_lineitem_l_returnflag_2#4058, cval_lineitem_l_linestatus#4014 AS cval_lineitem_l_linestatus_2#4059, cval_lineitem_l_commitdate#4015 AS cval_lineitem_l_commitdate_2#4060, cval_lineitem_l_receiptdate#4016 AS cval_lineitem_l_receiptdate_2#4061, cval_lineitem_l_shipinstruct#4017 AS cval_lineitem_l_shipinstruct_2#4062, cval_lineitem_l_shipmode#4018 AS cval_lineitem_l_shipmode_2#4063, cval_lineitem_l_comment#4019 AS cval_lineitem_l_comment_2#4064, cval_lineitem_l_shipdate#4020 AS cval_lineitem_l_shipdate_2#4065, cdepval_lineitem_l_quantity#4021 AS cdepval_lineitem_l_quantity_2#4066, cdepval_lineitem_l_extendedprice#4022 AS cdepval_lineitem_l_extendedprice_2#4067, cdepval_lineitem_l_discount#4023 AS cdepval_lineitem_l_discount_2#4068, ... 21 more fields]
         :  :  :  :  +- Relation[rid#4000,cpfk_orders_lineitem#4001,cpfk_supplier_lineitem#4002,cfpk_lineitem_supplier#4003,cfpk_lineitem_partsupp#4004,cpfk_part_lineitem#4005,cfpk_lineitem_part#4006,cpfk_partsupp_lineitem#4007,cfpk_lineitem_orders#4008,cval_lineitem_l_quantity#4009,cval_lineitem_l_extendedprice#4010,cval_lineitem_l_discount#4011,cval_lineitem_l_tax#4012,cval_lineitem_l_returnflag#4013,cval_lineitem_l_linestatus#4014,cval_lineitem_l_commitdate#4015,cval_lineitem_l_receiptdate#4016,cval_lineitem_l_shipinstruct#4017,cval_lineitem_l_shipmode#4018,cval_lineitem_l_comment#4019,cval_lineitem_l_shipdate#4020,cdepval_lineitem_l_quantity#4021,cdepval_lineitem_l_extendedprice#4022,cdepval_lineitem_l_discount#4023,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#3964 AS rid_1#3982, cpfk_nation_supplier#3965 AS cpfk_nation_supplier_1#3983, cfpk_supplier_nation#3966 AS cfpk_supplier_nation_1#3984, cval_supplier_s_name#3967 AS cval_supplier_s_name_1#3985, cval_supplier_s_address#3968 AS cval_supplier_s_address_1#3986, cval_supplier_s_phone#3969 AS cval_supplier_s_phone_1#3987, cval_supplier_s_acctbal#3970 AS cval_supplier_s_acctbal_1#3988, cval_supplier_s_comment#3971 AS cval_supplier_s_comment_1#3989, cdepval_supplier_s_name#3972 AS cdepval_supplier_s_name_1#3990, cdepval_supplier_s_address#3973 AS cdepval_supplier_s_address_1#3991, cdepval_supplier_s_phone#3974 AS cdepval_supplier_s_phone_1#3992, cdepval_supplier_s_acctbal#3975 AS cdepval_supplier_s_acctbal_1#3993, cdepval_supplier_s_comment#3976 AS cdepval_supplier_s_comment_1#3994, cs_name#3977 AS cs_name_1#3995, cs_address#3978 AS cs_address_1#3996, cs_phone#3979 AS cs_phone_1#3997, cs_acctbal#3980 AS cs_acctbal_1#3998, cs_comment#3981 AS cs_comment_1#3999]
         :  :  :     :  +- Relation[rid#3964,cpfk_nation_supplier#3965,cfpk_supplier_nation#3966,cval_supplier_s_name#3967,cval_supplier_s_address#3968,cval_supplier_s_phone#3969,cval_supplier_s_acctbal#3970,cval_supplier_s_comment#3971,cdepval_supplier_s_name#3972,cdepval_supplier_s_address#3973,cdepval_supplier_s_phone#3974,cdepval_supplier_s_acctbal#3975,cdepval_supplier_s_comment#3976,cs_name#3977,cs_address#3978,cs_phone#3979,cs_acctbal#3980,cs_comment#3981] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#3946 AS rid_0#3955, cpfk_region_nation#3947 AS cpfk_region_nation_0#3956, cfpk_nation_region#3948 AS cfpk_nation_region_0#3957, cval_nation_n_name#3949 AS cval_nation_n_name_0#3958, cval_nation_n_comment#3950 AS cval_nation_n_comment_0#3959, cdepval_nation_n_name#3951 AS cdepval_nation_n_name_0#3960, cdepval_nation_n_comment#3952 AS cdepval_nation_n_comment_0#3961, cn_name#3953 AS cn_name_0#3962, cn_comment#3954 AS cn_comment_0#3963]
         :  :  :        +- Relation[rid#3946,cpfk_region_nation#3947,cfpk_nation_region#3948,cval_nation_n_name#3949,cval_nation_n_comment#3950,cdepval_nation_n_name#3951,cdepval_nation_n_comment#3952,cn_name#3953,cn_comment#3954] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#4090 AS rid_3#4115, cval_part_p_name#4091 AS cval_part_p_name_3#4116, cval_part_p_mfgr#4092 AS cval_part_p_mfgr_3#4117, cval_part_p_type#4093 AS cval_part_p_type_3#4118, cval_part_p_size#4094 AS cval_part_p_size_3#4119, cval_part_p_container#4095 AS cval_part_p_container_3#4120, cval_part_p_retailprice#4096 AS cval_part_p_retailprice_3#4121, cval_part_p_comment#4097 AS cval_part_p_comment_3#4122, cval_part_p_brand#4098 AS cval_part_p_brand_3#4123, cdepval_part_p_name#4099 AS cdepval_part_p_name_3#4124, cdepval_part_p_mfgr#4100 AS cdepval_part_p_mfgr_3#4125, cdepval_part_p_type#4101 AS cdepval_part_p_type_3#4126, cdepval_part_p_size#4102 AS cdepval_part_p_size_3#4127, cdepval_part_p_container#4103 AS cdepval_part_p_container_3#4128, cdepval_part_p_retailprice#4104 AS cdepval_part_p_retailprice_3#4129, cdepval_part_p_comment#4105 AS cdepval_part_p_comment_3#4130, cdepval_part_p_brand#4106 AS cdepval_part_p_brand_3#4131, cp_name#4107 AS cp_name_3#4132, cp_mfgr#4108 AS cp_mfgr_3#4133, cp_type#4109 AS cp_type_3#4134, cp_size#4110 AS cp_size_3#4135, cp_container#4111 AS cp_container_3#4136, cp_retailprice#4112 AS cp_retailprice_3#4137, cp_comment#4113 AS cp_comment_3#4138, cp_brand#4114 AS cp_brand_3#4139]
         :  :     +- Relation[rid#4090,cval_part_p_name#4091,cval_part_p_mfgr#4092,cval_part_p_type#4093,cval_part_p_size#4094,cval_part_p_container#4095,cval_part_p_retailprice#4096,cval_part_p_comment#4097,cval_part_p_brand#4098,cdepval_part_p_name#4099,cdepval_part_p_mfgr#4100,cdepval_part_p_type#4101,cdepval_part_p_size#4102,cdepval_part_p_container#4103,cdepval_part_p_retailprice#4104,cdepval_part_p_comment#4105,cdepval_part_p_brand#4106,cp_name#4107,cp_mfgr#4108,cp_type#4109,cp_size#4110,cp_container#4111,cp_retailprice#4112,cp_comment#4113,cp_brand#4114] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#4140 AS rid_4#4154, cpfk_part_partsupp#4141 AS cpfk_part_partsupp_4#4155, cfpk_partsupp_part#4142 AS cfpk_partsupp_part_4#4156, cpfk_supplier_partsupp#4143 AS cpfk_supplier_partsupp_4#4157, cfpk_partsupp_supplier#4144 AS cfpk_partsupp_supplier_4#4158, cval_partsupp_ps_availqty#4145 AS cval_partsupp_ps_availqty_4#4159, cval_partsupp_ps_supplycost#4146 AS cval_partsupp_ps_supplycost_4#4160, cval_partsupp_ps_comment#4147 AS cval_partsupp_ps_comment_4#4161, cdepval_partsupp_ps_availqty#4148 AS cdepval_partsupp_ps_availqty_4#4162, cdepval_partsupp_ps_supplycost#4149 AS cdepval_partsupp_ps_supplycost_4#4163, cdepval_partsupp_ps_comment#4150 AS cdepval_partsupp_ps_comment_4#4164, cps_availqty#4151 AS cps_availqty_4#4165, cps_supplycost#4152 AS cps_supplycost_4#4166, cps_comment#4153 AS cps_comment_4#4167]
         :     +- Relation[rid#4140,cpfk_part_partsupp#4141,cfpk_partsupp_part#4142,cpfk_supplier_partsupp#4143,cfpk_partsupp_supplier#4144,cval_partsupp_ps_availqty#4145,cval_partsupp_ps_supplycost#4146,cval_partsupp_ps_comment#4147,cdepval_partsupp_ps_availqty#4148,cdepval_partsupp_ps_supplycost#4149,cdepval_partsupp_ps_comment#4150,cps_availqty#4151,cps_supplycost#4152,cps_comment#4153] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#4168 AS rid_5#4192, cpfk_customer_orders#4169 AS cpfk_customer_orders_5#4193, cfpk_orders_customer#4170 AS cfpk_orders_customer_5#4194, cval_orders_o_orderstatus#4171 AS cval_orders_o_orderstatus_5#4195, cval_orders_o_totalprice#4172 AS cval_orders_o_totalprice_5#4196, cval_orders_o_orderpriority#4173 AS cval_orders_o_orderpriority_5#4197, cval_orders_o_clerk#4174 AS cval_orders_o_clerk_5#4198, cval_orders_o_shippriority#4175 AS cval_orders_o_shippriority_5#4199, cval_orders_o_comment#4176 AS cval_orders_o_comment_5#4200, cval_orders_o_orderdate#4177 AS cval_orders_o_orderdate_5#4201, cdepval_orders_o_orderstatus#4178 AS cdepval_orders_o_orderstatus_5#4202, cdepval_orders_o_totalprice#4179 AS cdepval_orders_o_totalprice_5#4203, cdepval_orders_o_orderpriority#4180 AS cdepval_orders_o_orderpriority_5#4204, cdepval_orders_o_clerk#4181 AS cdepval_orders_o_clerk_5#4205, cdepval_orders_o_shippriority#4182 AS cdepval_orders_o_shippriority_5#4206, cdepval_orders_o_comment#4183 AS cdepval_orders_o_comment_5#4207, cdepval_orders_o_orderdate#4184 AS cdepval_orders_o_orderdate_5#4208, co_orderstatus#4185 AS co_orderstatus_5#4209, co_totalprice#4186 AS co_totalprice_5#4210, co_orderpriority#4187 AS co_orderpriority_5#4211, co_clerk#4188 AS co_clerk_5#4212, co_shippriority#4189 AS co_shippriority_5#4213, co_comment#4190 AS co_comment_5#4214, co_orderdate#4191 AS co_orderdate_5#4215]
            +- Relation[rid#4168,cpfk_customer_orders#4169,cfpk_orders_customer#4170,cval_orders_o_orderstatus#4171,cval_orders_o_totalprice#4172,cval_orders_o_orderpriority#4173,cval_orders_o_clerk#4174,cval_orders_o_shippriority#4175,cval_orders_o_comment#4176,cval_orders_o_orderdate#4177,cdepval_orders_o_orderstatus#4178,cdepval_orders_o_totalprice#4179,cdepval_orders_o_orderpriority#4180,cdepval_orders_o_clerk#4181,cdepval_orders_o_shippriority#4182,cdepval_orders_o_comment#4183,cdepval_orders_o_orderdate#4184,co_orderstatus#4185,co_totalprice#4186,co_orderpriority#4187,co_clerk#4188,co_shippriority#4189,co_comment#4190,co_orderdate#4191] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 63921ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/25 23:22:28 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:22:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4359L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:22:29 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 23:22:29 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 23:22:29 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 23:22:29 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 23:22:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4359L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#4493 AS rid_2#4538, cpfk_orders_lineitem#4494 AS cpfk_orders_lineitem_2#4539, cpfk_supplier_lineitem#4495 AS cpfk_supplier_lineitem_2#4540, cfpk_lineitem_supplier#4496 AS cfpk_lineitem_supplier_2#4541, cfpk_lineitem_partsupp#4497 AS cfpk_lineitem_partsupp_2#4542, cpfk_part_lineitem#4498 AS cpfk_part_lineitem_2#4543, cfpk_lineitem_part#4499 AS cfpk_lineitem_part_2#4544, cpfk_partsupp_lineitem#4500 AS cpfk_partsupp_lineitem_2#4545, cfpk_lineitem_orders#4501 AS cfpk_lineitem_orders_2#4546, cval_lineitem_l_quantity#4502 AS cval_lineitem_l_quantity_2#4547, cval_lineitem_l_extendedprice#4503 AS cval_lineitem_l_extendedprice_2#4548, cval_lineitem_l_discount#4504 AS cval_lineitem_l_discount_2#4549, cval_lineitem_l_tax#4505 AS cval_lineitem_l_tax_2#4550, cval_lineitem_l_returnflag#4506 AS cval_lineitem_l_returnflag_2#4551, cval_lineitem_l_linestatus#4507 AS cval_lineitem_l_linestatus_2#4552, cval_lineitem_l_commitdate#4508 AS cval_lineitem_l_commitdate_2#4553, cval_lineitem_l_receiptdate#4509 AS cval_lineitem_l_receiptdate_2#4554, cval_lineitem_l_shipinstruct#4510 AS cval_lineitem_l_shipinstruct_2#4555, cval_lineitem_l_shipmode#4511 AS cval_lineitem_l_shipmode_2#4556, cval_lineitem_l_comment#4512 AS cval_lineitem_l_comment_2#4557, cval_lineitem_l_shipdate#4513 AS cval_lineitem_l_shipdate_2#4558, cdepval_lineitem_l_quantity#4514 AS cdepval_lineitem_l_quantity_2#4559, cdepval_lineitem_l_extendedprice#4515 AS cdepval_lineitem_l_extendedprice_2#4560, cdepval_lineitem_l_discount#4516 AS cdepval_lineitem_l_discount_2#4561, ... 21 more fields]
         :  +- Relation[rid#4493,cpfk_orders_lineitem#4494,cpfk_supplier_lineitem#4495,cfpk_lineitem_supplier#4496,cfpk_lineitem_partsupp#4497,cpfk_part_lineitem#4498,cfpk_lineitem_part#4499,cpfk_partsupp_lineitem#4500,cfpk_lineitem_orders#4501,cval_lineitem_l_quantity#4502,cval_lineitem_l_extendedprice#4503,cval_lineitem_l_discount#4504,cval_lineitem_l_tax#4505,cval_lineitem_l_returnflag#4506,cval_lineitem_l_linestatus#4507,cval_lineitem_l_commitdate#4508,cval_lineitem_l_receiptdate#4509,cval_lineitem_l_shipinstruct#4510,cval_lineitem_l_shipmode#4511,cval_lineitem_l_comment#4512,cval_lineitem_l_shipdate#4513,cdepval_lineitem_l_quantity#4514,cdepval_lineitem_l_extendedprice#4515,cdepval_lineitem_l_discount#4516,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#4445 AS rid_1#4469, cpfk_customer_orders#4446 AS cpfk_customer_orders_1#4470, cfpk_orders_customer#4447 AS cfpk_orders_customer_1#4471, cval_orders_o_orderstatus#4448 AS cval_orders_o_orderstatus_1#4472, cval_orders_o_totalprice#4449 AS cval_orders_o_totalprice_1#4473, cval_orders_o_orderpriority#4450 AS cval_orders_o_orderpriority_1#4474, cval_orders_o_clerk#4451 AS cval_orders_o_clerk_1#4475, cval_orders_o_shippriority#4452 AS cval_orders_o_shippriority_1#4476, cval_orders_o_comment#4453 AS cval_orders_o_comment_1#4477, cval_orders_o_orderdate#4454 AS cval_orders_o_orderdate_1#4478, cdepval_orders_o_orderstatus#4455 AS cdepval_orders_o_orderstatus_1#4479, cdepval_orders_o_totalprice#4456 AS cdepval_orders_o_totalprice_1#4480, cdepval_orders_o_orderpriority#4457 AS cdepval_orders_o_orderpriority_1#4481, cdepval_orders_o_clerk#4458 AS cdepval_orders_o_clerk_1#4482, cdepval_orders_o_shippriority#4459 AS cdepval_orders_o_shippriority_1#4483, cdepval_orders_o_comment#4460 AS cdepval_orders_o_comment_1#4484, cdepval_orders_o_orderdate#4461 AS cdepval_orders_o_orderdate_1#4485, co_orderstatus#4462 AS co_orderstatus_1#4486, co_totalprice#4463 AS co_totalprice_1#4487, co_orderpriority#4464 AS co_orderpriority_1#4488, co_clerk#4465 AS co_clerk_1#4489, co_shippriority#4466 AS co_shippriority_1#4490, co_comment#4467 AS co_comment_1#4491, co_orderdate#4468 AS co_orderdate_1#4492]
            :  +- Relation[rid#4445,cpfk_customer_orders#4446,cfpk_orders_customer#4447,cval_orders_o_orderstatus#4448,cval_orders_o_totalprice#4449,cval_orders_o_orderpriority#4450,cval_orders_o_clerk#4451,cval_orders_o_shippriority#4452,cval_orders_o_comment#4453,cval_orders_o_orderdate#4454,cdepval_orders_o_orderstatus#4455,cdepval_orders_o_totalprice#4456,cdepval_orders_o_orderpriority#4457,cdepval_orders_o_clerk#4458,cdepval_orders_o_shippriority#4459,cdepval_orders_o_comment#4460,cdepval_orders_o_orderdate#4461,co_orderstatus#4462,co_totalprice#4463,co_orderpriority#4464,co_clerk#4465,co_shippriority#4466,co_comment#4467,co_orderdate#4468] JDBCRelation(torders) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
               +- Project [rid#4361 AS rid_0#4382, cpfk_nation_customer#4362 AS cpfk_nation_customer_0#4383, cfpk_customer_nation#4363 AS cfpk_customer_nation_0#4384, cval_customer_c_name#4364 AS cval_customer_c_name_0#4385, cval_customer_c_address#4365 AS cval_customer_c_address_0#4386, cval_customer_c_phone#4366 AS cval_customer_c_phone_0#4387, cval_customer_c_acctbal#4367 AS cval_customer_c_acctbal_0#4388, cval_customer_c_comment#4368 AS cval_customer_c_comment_0#4389, cval_customer_c_mktsegment#4369 AS cval_customer_c_mktsegment_0#4390, cdepval_customer_c_name#4370 AS cdepval_customer_c_name_0#4391, cdepval_customer_c_address#4371 AS cdepval_customer_c_address_0#4392, cdepval_customer_c_phone#4372 AS cdepval_customer_c_phone_0#4393, cdepval_customer_c_acctbal#4373 AS cdepval_customer_c_acctbal_0#4394, cdepval_customer_c_comment#4374 AS cdepval_customer_c_comment_0#4395, cdepval_customer_c_mktsegment#4375 AS cdepval_customer_c_mktsegment_0#4396, cc_name#4376 AS cc_name_0#4397, cc_address#4377 AS cc_address_0#4398, cc_phone#4378 AS cc_phone_0#4399, cc_acctbal#4379 AS cc_acctbal_0#4400, cc_comment#4380 AS cc_comment_0#4401, cc_mktsegment#4381 AS cc_mktsegment_0#4402]
                  +- Relation[rid#4361,cpfk_nation_customer#4362,cfpk_customer_nation#4363,cval_customer_c_name#4364,cval_customer_c_address#4365,cval_customer_c_phone#4366,cval_customer_c_acctbal#4367,cval_customer_c_comment#4368,cval_customer_c_mktsegment#4369,cdepval_customer_c_name#4370,cdepval_customer_c_address#4371,cdepval_customer_c_phone#4372,cdepval_customer_c_acctbal#4373,cdepval_customer_c_comment#4374,cdepval_customer_c_mktsegment#4375,cc_name#4376,cc_address#4377,cc_phone#4378,cc_acctbal#4379,cc_comment#4380,cc_mktsegment#4381] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 39519ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/25 23:23:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:23:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4678L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:23:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#4678L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#4680 AS rid_0#4725, cpfk_orders_lineitem#4681 AS cpfk_orders_lineitem_0#4726, cpfk_supplier_lineitem#4682 AS cpfk_supplier_lineitem_0#4727, cfpk_lineitem_supplier#4683 AS cfpk_lineitem_supplier_0#4728, cfpk_lineitem_partsupp#4684 AS cfpk_lineitem_partsupp_0#4729, cpfk_part_lineitem#4685 AS cpfk_part_lineitem_0#4730, cfpk_lineitem_part#4686 AS cfpk_lineitem_part_0#4731, cpfk_partsupp_lineitem#4687 AS cpfk_partsupp_lineitem_0#4732, cfpk_lineitem_orders#4688 AS cfpk_lineitem_orders_0#4733, cval_lineitem_l_quantity#4689 AS cval_lineitem_l_quantity_0#4734, cval_lineitem_l_extendedprice#4690 AS cval_lineitem_l_extendedprice_0#4735, cval_lineitem_l_discount#4691 AS cval_lineitem_l_discount_0#4736, cval_lineitem_l_tax#4692 AS cval_lineitem_l_tax_0#4737, cval_lineitem_l_returnflag#4693 AS cval_lineitem_l_returnflag_0#4738, cval_lineitem_l_linestatus#4694 AS cval_lineitem_l_linestatus_0#4739, cval_lineitem_l_commitdate#4695 AS cval_lineitem_l_commitdate_0#4740, cval_lineitem_l_receiptdate#4696 AS cval_lineitem_l_receiptdate_0#4741, cval_lineitem_l_shipinstruct#4697 AS cval_lineitem_l_shipinstruct_0#4742, cval_lineitem_l_shipmode#4698 AS cval_lineitem_l_shipmode_0#4743, cval_lineitem_l_comment#4699 AS cval_lineitem_l_comment_0#4744, cval_lineitem_l_shipdate#4700 AS cval_lineitem_l_shipdate_0#4745, cdepval_lineitem_l_quantity#4701 AS cdepval_lineitem_l_quantity_0#4746, cdepval_lineitem_l_extendedprice#4702 AS cdepval_lineitem_l_extendedprice_0#4747, cdepval_lineitem_l_discount#4703 AS cdepval_lineitem_l_discount_0#4748, ... 21 more fields]
         +- Relation[rid#4680,cpfk_orders_lineitem#4681,cpfk_supplier_lineitem#4682,cfpk_lineitem_supplier#4683,cfpk_lineitem_partsupp#4684,cpfk_part_lineitem#4685,cfpk_lineitem_part#4686,cpfk_partsupp_lineitem#4687,cfpk_lineitem_orders#4688,cval_lineitem_l_quantity#4689,cval_lineitem_l_extendedprice#4690,cval_lineitem_l_discount#4691,cval_lineitem_l_tax#4692,cval_lineitem_l_returnflag#4693,cval_lineitem_l_linestatus#4694,cval_lineitem_l_commitdate#4695,cval_lineitem_l_receiptdate#4696,cval_lineitem_l_shipinstruct#4697,cval_lineitem_l_shipmode#4698,cval_lineitem_l_comment#4699,cval_lineitem_l_shipdate#4700,cdepval_lineitem_l_quantity#4701,cdepval_lineitem_l_extendedprice#4702,cdepval_lineitem_l_discount#4703,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2460ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/25 23:23:10 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:23:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4820L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 23:23:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:23:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:23:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:23:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:23:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:23:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:23:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:23:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:23:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:23:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:23:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4820L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :  :- Project [rid#4922 AS rid_1#4936, cpfk_part_partsupp#4923 AS cpfk_part_partsupp_1#4937, cfpk_partsupp_part#4924 AS cfpk_partsupp_part_1#4938, cpfk_supplier_partsupp#4925 AS cpfk_supplier_partsupp_1#4939, cfpk_partsupp_supplier#4926 AS cfpk_partsupp_supplier_1#4940, cval_partsupp_ps_availqty#4927 AS cval_partsupp_ps_availqty_1#4941, cval_partsupp_ps_supplycost#4928 AS cval_partsupp_ps_supplycost_1#4942, cval_partsupp_ps_comment#4929 AS cval_partsupp_ps_comment_1#4943, cdepval_partsupp_ps_availqty#4930 AS cdepval_partsupp_ps_availqty_1#4944, cdepval_partsupp_ps_supplycost#4931 AS cdepval_partsupp_ps_supplycost_1#4945, cdepval_partsupp_ps_comment#4932 AS cdepval_partsupp_ps_comment_1#4946, cps_availqty#4933 AS cps_availqty_1#4947, cps_supplycost#4934 AS cps_supplycost_1#4948, cps_comment#4935 AS cps_comment_1#4949]
         :  :  +- Relation[rid#4922,cpfk_part_partsupp#4923,cfpk_partsupp_part#4924,cpfk_supplier_partsupp#4925,cfpk_partsupp_supplier#4926,cval_partsupp_ps_availqty#4927,cval_partsupp_ps_supplycost#4928,cval_partsupp_ps_comment#4929,cdepval_partsupp_ps_availqty#4930,cdepval_partsupp_ps_supplycost#4931,cdepval_partsupp_ps_comment#4932,cps_availqty#4933,cps_supplycost#4934,cps_comment#4935] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :     +- Project [rid#4822 AS rid_0#4847, cval_part_p_name#4823 AS cval_part_p_name_0#4848, cval_part_p_mfgr#4824 AS cval_part_p_mfgr_0#4849, cval_part_p_type#4825 AS cval_part_p_type_0#4850, cval_part_p_size#4826 AS cval_part_p_size_0#4851, cval_part_p_container#4827 AS cval_part_p_container_0#4852, cval_part_p_retailprice#4828 AS cval_part_p_retailprice_0#4853, cval_part_p_comment#4829 AS cval_part_p_comment_0#4854, cval_part_p_brand#4830 AS cval_part_p_brand_0#4855, cdepval_part_p_name#4831 AS cdepval_part_p_name_0#4856, cdepval_part_p_mfgr#4832 AS cdepval_part_p_mfgr_0#4857, cdepval_part_p_type#4833 AS cdepval_part_p_type_0#4858, cdepval_part_p_size#4834 AS cdepval_part_p_size_0#4859, cdepval_part_p_container#4835 AS cdepval_part_p_container_0#4860, cdepval_part_p_retailprice#4836 AS cdepval_part_p_retailprice_0#4861, cdepval_part_p_comment#4837 AS cdepval_part_p_comment_0#4862, cdepval_part_p_brand#4838 AS cdepval_part_p_brand_0#4863, cp_name#4839 AS cp_name_0#4864, cp_mfgr#4840 AS cp_mfgr_0#4865, cp_type#4841 AS cp_type_0#4866, cp_size#4842 AS cp_size_0#4867, cp_container#4843 AS cp_container_0#4868, cp_retailprice#4844 AS cp_retailprice_0#4869, cp_comment#4845 AS cp_comment_0#4870, cp_brand#4846 AS cp_brand_0#4871]
         :        +- Relation[rid#4822,cval_part_p_name#4823,cval_part_p_mfgr#4824,cval_part_p_type#4825,cval_part_p_size#4826,cval_part_p_container#4827,cval_part_p_retailprice#4828,cval_part_p_comment#4829,cval_part_p_brand#4830,cdepval_part_p_name#4831,cdepval_part_p_mfgr#4832,cdepval_part_p_type#4833,cdepval_part_p_size#4834,cdepval_part_p_container#4835,cdepval_part_p_retailprice#4836,cdepval_part_p_comment#4837,cdepval_part_p_brand#4838,cp_name#4839,cp_mfgr#4840,cp_type#4841,cp_size#4842,cp_container#4843,cp_retailprice#4844,cp_comment#4845,cp_brand#4846] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_2)
            :- Project [rid#4986 AS rid_3#5004, cpfk_nation_supplier#4987 AS cpfk_nation_supplier_3#5005, cfpk_supplier_nation#4988 AS cfpk_supplier_nation_3#5006, cval_supplier_s_name#4989 AS cval_supplier_s_name_3#5007, cval_supplier_s_address#4990 AS cval_supplier_s_address_3#5008, cval_supplier_s_phone#4991 AS cval_supplier_s_phone_3#5009, cval_supplier_s_acctbal#4992 AS cval_supplier_s_acctbal_3#5010, cval_supplier_s_comment#4993 AS cval_supplier_s_comment_3#5011, cdepval_supplier_s_name#4994 AS cdepval_supplier_s_name_3#5012, cdepval_supplier_s_address#4995 AS cdepval_supplier_s_address_3#5013, cdepval_supplier_s_phone#4996 AS cdepval_supplier_s_phone_3#5014, cdepval_supplier_s_acctbal#4997 AS cdepval_supplier_s_acctbal_3#5015, cdepval_supplier_s_comment#4998 AS cdepval_supplier_s_comment_3#5016, cs_name#4999 AS cs_name_3#5017, cs_address#5000 AS cs_address_3#5018, cs_phone#5001 AS cs_phone_3#5019, cs_acctbal#5002 AS cs_acctbal_3#5020, cs_comment#5003 AS cs_comment_3#5021]
            :  +- Relation[rid#4986,cpfk_nation_supplier#4987,cfpk_supplier_nation#4988,cval_supplier_s_name#4989,cval_supplier_s_address#4990,cval_supplier_s_phone#4991,cval_supplier_s_acctbal#4992,cval_supplier_s_comment#4993,cdepval_supplier_s_name#4994,cdepval_supplier_s_address#4995,cdepval_supplier_s_phone#4996,cdepval_supplier_s_acctbal#4997,cdepval_supplier_s_comment#4998,cs_name#4999,cs_address#5000,cs_phone#5001,cs_acctbal#5002,cs_comment#5003] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
               +- Project [rid#4950 AS rid_2#4959, cpfk_region_nation#4951 AS cpfk_region_nation_2#4960, cfpk_nation_region#4952 AS cfpk_nation_region_2#4961, cval_nation_n_name#4953 AS cval_nation_n_name_2#4962, cval_nation_n_comment#4954 AS cval_nation_n_comment_2#4963, cdepval_nation_n_name#4955 AS cdepval_nation_n_name_2#4964, cdepval_nation_n_comment#4956 AS cdepval_nation_n_comment_2#4965, cn_name#4957 AS cn_name_2#4966, cn_comment#4958 AS cn_comment_2#4967]
                  +- Relation[rid#4950,cpfk_region_nation#4951,cfpk_nation_region#4952,cval_nation_n_name#4953,cval_nation_n_comment#4954,cdepval_nation_n_name#4955,cdepval_nation_n_comment#4956,cn_name#4957,cn_comment#4958] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 3552ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/25 23:23:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:23:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5095L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 23:23:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:23:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:23:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5095L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :- Project [rid#5197 AS rid_1#5211, cpfk_part_partsupp#5198 AS cpfk_part_partsupp_1#5212, cfpk_partsupp_part#5199 AS cfpk_partsupp_part_1#5213, cpfk_supplier_partsupp#5200 AS cpfk_supplier_partsupp_1#5214, cfpk_partsupp_supplier#5201 AS cfpk_partsupp_supplier_1#5215, cval_partsupp_ps_availqty#5202 AS cval_partsupp_ps_availqty_1#5216, cval_partsupp_ps_supplycost#5203 AS cval_partsupp_ps_supplycost_1#5217, cval_partsupp_ps_comment#5204 AS cval_partsupp_ps_comment_1#5218, cdepval_partsupp_ps_availqty#5205 AS cdepval_partsupp_ps_availqty_1#5219, cdepval_partsupp_ps_supplycost#5206 AS cdepval_partsupp_ps_supplycost_1#5220, cdepval_partsupp_ps_comment#5207 AS cdepval_partsupp_ps_comment_1#5221, cps_availqty#5208 AS cps_availqty_1#5222, cps_supplycost#5209 AS cps_supplycost_1#5223, cps_comment#5210 AS cps_comment_1#5224]
         :  +- Relation[rid#5197,cpfk_part_partsupp#5198,cfpk_partsupp_part#5199,cpfk_supplier_partsupp#5200,cfpk_partsupp_supplier#5201,cval_partsupp_ps_availqty#5202,cval_partsupp_ps_supplycost#5203,cval_partsupp_ps_comment#5204,cdepval_partsupp_ps_availqty#5205,cdepval_partsupp_ps_supplycost#5206,cdepval_partsupp_ps_comment#5207,cps_availqty#5208,cps_supplycost#5209,cps_comment#5210] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
            +- Project [rid#5097 AS rid_0#5122, cval_part_p_name#5098 AS cval_part_p_name_0#5123, cval_part_p_mfgr#5099 AS cval_part_p_mfgr_0#5124, cval_part_p_type#5100 AS cval_part_p_type_0#5125, cval_part_p_size#5101 AS cval_part_p_size_0#5126, cval_part_p_container#5102 AS cval_part_p_container_0#5127, cval_part_p_retailprice#5103 AS cval_part_p_retailprice_0#5128, cval_part_p_comment#5104 AS cval_part_p_comment_0#5129, cval_part_p_brand#5105 AS cval_part_p_brand_0#5130, cdepval_part_p_name#5106 AS cdepval_part_p_name_0#5131, cdepval_part_p_mfgr#5107 AS cdepval_part_p_mfgr_0#5132, cdepval_part_p_type#5108 AS cdepval_part_p_type_0#5133, cdepval_part_p_size#5109 AS cdepval_part_p_size_0#5134, cdepval_part_p_container#5110 AS cdepval_part_p_container_0#5135, cdepval_part_p_retailprice#5111 AS cdepval_part_p_retailprice_0#5136, cdepval_part_p_comment#5112 AS cdepval_part_p_comment_0#5137, cdepval_part_p_brand#5113 AS cdepval_part_p_brand_0#5138, cp_name#5114 AS cp_name_0#5139, cp_mfgr#5115 AS cp_mfgr_0#5140, cp_type#5116 AS cp_type_0#5141, cp_size#5117 AS cp_size_0#5142, cp_container#5118 AS cp_container_0#5143, cp_retailprice#5119 AS cp_retailprice_0#5144, cp_comment#5120 AS cp_comment_0#5145, cp_brand#5121 AS cp_brand_0#5146]
               +- Relation[rid#5097,cval_part_p_name#5098,cval_part_p_mfgr#5099,cval_part_p_type#5100,cval_part_p_size#5101,cval_part_p_container#5102,cval_part_p_retailprice#5103,cval_part_p_comment#5104,cval_part_p_brand#5105,cdepval_part_p_name#5106,cdepval_part_p_mfgr#5107,cdepval_part_p_type#5108,cdepval_part_p_size#5109,cdepval_part_p_container#5110,cdepval_part_p_retailprice#5111,cdepval_part_p_comment#5112,cdepval_part_p_brand#5113,cp_name#5114,cp_mfgr#5115,cp_type#5116,cp_size#5117,cp_container#5118,cp_retailprice#5119,cp_comment#5120,cp_brand#5121] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 3360ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/25 23:23:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:23:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5270L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 23:23:17 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:23:17 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:23:17 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:23:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:23:17 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:23:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:23:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:23:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:23:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:23:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:23:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:23:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5270L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#5408 AS rid_4#5453, cpfk_orders_lineitem#5409 AS cpfk_orders_lineitem_4#5454, cpfk_supplier_lineitem#5410 AS cpfk_supplier_lineitem_4#5455, cfpk_lineitem_supplier#5411 AS cfpk_lineitem_supplier_4#5456, cfpk_lineitem_partsupp#5412 AS cfpk_lineitem_partsupp_4#5457, cpfk_part_lineitem#5413 AS cpfk_part_lineitem_4#5458, cfpk_lineitem_part#5414 AS cfpk_lineitem_part_4#5459, cpfk_partsupp_lineitem#5415 AS cpfk_partsupp_lineitem_4#5460, cfpk_lineitem_orders#5416 AS cfpk_lineitem_orders_4#5461, cval_lineitem_l_quantity#5417 AS cval_lineitem_l_quantity_4#5462, cval_lineitem_l_extendedprice#5418 AS cval_lineitem_l_extendedprice_4#5463, cval_lineitem_l_discount#5419 AS cval_lineitem_l_discount_4#5464, cval_lineitem_l_tax#5420 AS cval_lineitem_l_tax_4#5465, cval_lineitem_l_returnflag#5421 AS cval_lineitem_l_returnflag_4#5466, cval_lineitem_l_linestatus#5422 AS cval_lineitem_l_linestatus_4#5467, cval_lineitem_l_commitdate#5423 AS cval_lineitem_l_commitdate_4#5468, cval_lineitem_l_receiptdate#5424 AS cval_lineitem_l_receiptdate_4#5469, cval_lineitem_l_shipinstruct#5425 AS cval_lineitem_l_shipinstruct_4#5470, cval_lineitem_l_shipmode#5426 AS cval_lineitem_l_shipmode_4#5471, cval_lineitem_l_comment#5427 AS cval_lineitem_l_comment_4#5472, cval_lineitem_l_shipdate#5428 AS cval_lineitem_l_shipdate_4#5473, cdepval_lineitem_l_quantity#5429 AS cdepval_lineitem_l_quantity_4#5474, cdepval_lineitem_l_extendedprice#5430 AS cdepval_lineitem_l_extendedprice_4#5475, cdepval_lineitem_l_discount#5431 AS cdepval_lineitem_l_discount_4#5476, ... 21 more fields]
            :  :  +- Relation[rid#5408,cpfk_orders_lineitem#5409,cpfk_supplier_lineitem#5410,cfpk_lineitem_supplier#5411,cfpk_lineitem_partsupp#5412,cpfk_part_lineitem#5413,cfpk_lineitem_part#5414,cpfk_partsupp_lineitem#5415,cfpk_lineitem_orders#5416,cval_lineitem_l_quantity#5417,cval_lineitem_l_extendedprice#5418,cval_lineitem_l_discount#5419,cval_lineitem_l_tax#5420,cval_lineitem_l_returnflag#5421,cval_lineitem_l_linestatus#5422,cval_lineitem_l_commitdate#5423,cval_lineitem_l_receiptdate#5424,cval_lineitem_l_shipinstruct#5425,cval_lineitem_l_shipmode#5426,cval_lineitem_l_comment#5427,cval_lineitem_l_shipdate#5428,cdepval_lineitem_l_quantity#5429,cdepval_lineitem_l_extendedprice#5430,cdepval_lineitem_l_discount#5431,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#5360 AS rid_3#5384, cpfk_customer_orders#5361 AS cpfk_customer_orders_3#5385, cfpk_orders_customer#5362 AS cfpk_orders_customer_3#5386, cval_orders_o_orderstatus#5363 AS cval_orders_o_orderstatus_3#5387, cval_orders_o_totalprice#5364 AS cval_orders_o_totalprice_3#5388, cval_orders_o_orderpriority#5365 AS cval_orders_o_orderpriority_3#5389, cval_orders_o_clerk#5366 AS cval_orders_o_clerk_3#5390, cval_orders_o_shippriority#5367 AS cval_orders_o_shippriority_3#5391, cval_orders_o_comment#5368 AS cval_orders_o_comment_3#5392, cval_orders_o_orderdate#5369 AS cval_orders_o_orderdate_3#5393, cdepval_orders_o_orderstatus#5370 AS cdepval_orders_o_orderstatus_3#5394, cdepval_orders_o_totalprice#5371 AS cdepval_orders_o_totalprice_3#5395, cdepval_orders_o_orderpriority#5372 AS cdepval_orders_o_orderpriority_3#5396, cdepval_orders_o_clerk#5373 AS cdepval_orders_o_clerk_3#5397, cdepval_orders_o_shippriority#5374 AS cdepval_orders_o_shippriority_3#5398, cdepval_orders_o_comment#5375 AS cdepval_orders_o_comment_3#5399, cdepval_orders_o_orderdate#5376 AS cdepval_orders_o_orderdate_3#5400, co_orderstatus#5377 AS co_orderstatus_3#5401, co_totalprice#5378 AS co_totalprice_3#5402, co_orderpriority#5379 AS co_orderpriority_3#5403, co_clerk#5380 AS co_clerk_3#5404, co_shippriority#5381 AS co_shippriority_3#5405, co_comment#5382 AS co_comment_3#5406, co_orderdate#5383 AS co_orderdate_3#5407]
            :     :  +- Relation[rid#5360,cpfk_customer_orders#5361,cfpk_orders_customer#5362,cval_orders_o_orderstatus#5363,cval_orders_o_totalprice#5364,cval_orders_o_orderpriority#5365,cval_orders_o_clerk#5366,cval_orders_o_shippriority#5367,cval_orders_o_comment#5368,cval_orders_o_orderdate#5369,cdepval_orders_o_orderstatus#5370,cdepval_orders_o_totalprice#5371,cdepval_orders_o_orderpriority#5372,cdepval_orders_o_clerk#5373,cdepval_orders_o_shippriority#5374,cdepval_orders_o_comment#5375,cdepval_orders_o_orderdate#5376,co_orderstatus#5377,co_totalprice#5378,co_orderpriority#5379,co_clerk#5380,co_shippriority#5381,co_comment#5382,co_orderdate#5383] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#5318 AS rid_2#5339, cpfk_nation_customer#5319 AS cpfk_nation_customer_2#5340, cfpk_customer_nation#5320 AS cfpk_customer_nation_2#5341, cval_customer_c_name#5321 AS cval_customer_c_name_2#5342, cval_customer_c_address#5322 AS cval_customer_c_address_2#5343, cval_customer_c_phone#5323 AS cval_customer_c_phone_2#5344, cval_customer_c_acctbal#5324 AS cval_customer_c_acctbal_2#5345, cval_customer_c_comment#5325 AS cval_customer_c_comment_2#5346, cval_customer_c_mktsegment#5326 AS cval_customer_c_mktsegment_2#5347, cdepval_customer_c_name#5327 AS cdepval_customer_c_name_2#5348, cdepval_customer_c_address#5328 AS cdepval_customer_c_address_2#5349, cdepval_customer_c_phone#5329 AS cdepval_customer_c_phone_2#5350, cdepval_customer_c_acctbal#5330 AS cdepval_customer_c_acctbal_2#5351, cdepval_customer_c_comment#5331 AS cdepval_customer_c_comment_2#5352, cdepval_customer_c_mktsegment#5332 AS cdepval_customer_c_mktsegment_2#5353, cc_name#5333 AS cc_name_2#5354, cc_address#5334 AS cc_address_2#5355, cc_phone#5335 AS cc_phone_2#5356, cc_acctbal#5336 AS cc_acctbal_2#5357, cc_comment#5337 AS cc_comment_2#5358, cc_mktsegment#5338 AS cc_mktsegment_2#5359]
            :        :  +- Relation[rid#5318,cpfk_nation_customer#5319,cfpk_customer_nation#5320,cval_customer_c_name#5321,cval_customer_c_address#5322,cval_customer_c_phone#5323,cval_customer_c_acctbal#5324,cval_customer_c_comment#5325,cval_customer_c_mktsegment#5326,cdepval_customer_c_name#5327,cdepval_customer_c_address#5328,cdepval_customer_c_phone#5329,cdepval_customer_c_acctbal#5330,cdepval_customer_c_comment#5331,cdepval_customer_c_mktsegment#5332,cc_name#5333,cc_address#5334,cc_phone#5335,cc_acctbal#5336,cc_comment#5337,cc_mktsegment#5338] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
            :           :- Project [rid#5300 AS rid_1#5309, cpfk_region_nation#5301 AS cpfk_region_nation_1#5310, cfpk_nation_region#5302 AS cfpk_nation_region_1#5311, cval_nation_n_name#5303 AS cval_nation_n_name_1#5312, cval_nation_n_comment#5304 AS cval_nation_n_comment_1#5313, cdepval_nation_n_name#5305 AS cdepval_nation_n_name_1#5314, cdepval_nation_n_comment#5306 AS cdepval_nation_n_comment_1#5315, cn_name#5307 AS cn_name_1#5316, cn_comment#5308 AS cn_comment_1#5317]
            :           :  +- Relation[rid#5300,cpfk_region_nation#5301,cfpk_nation_region#5302,cval_nation_n_name#5303,cval_nation_n_comment#5304,cdepval_nation_n_name#5305,cdepval_nation_n_comment#5306,cn_name#5307,cn_comment#5308] JDBCRelation(tnation) [numPartitions=1]
            :           +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :              +- Project [rid#5272 AS rid_0#5279, cval_region_r_name#5273 AS cval_region_r_name_0#5280, cval_region_r_comment#5274 AS cval_region_r_comment_0#5281, cdepval_region_r_name#5275 AS cdepval_region_r_name_0#5282, cdepval_region_r_comment#5276 AS cdepval_region_r_comment_0#5283, cr_name#5277 AS cr_name_0#5284, cr_comment#5278 AS cr_comment_0#5285]
            :                 +- Relation[rid#5272,cval_region_r_name#5273,cval_region_r_comment#5274,cdepval_region_r_name#5275,cdepval_region_r_comment#5276,cr_name#5277,cr_comment#5278] JDBCRelation(tregion) [numPartitions=1]
            +- Project [rid#5498 AS rid_5#5516, cpfk_nation_supplier#5499 AS cpfk_nation_supplier_5#5517, cfpk_supplier_nation#5500 AS cfpk_supplier_nation_5#5518, cval_supplier_s_name#5501 AS cval_supplier_s_name_5#5519, cval_supplier_s_address#5502 AS cval_supplier_s_address_5#5520, cval_supplier_s_phone#5503 AS cval_supplier_s_phone_5#5521, cval_supplier_s_acctbal#5504 AS cval_supplier_s_acctbal_5#5522, cval_supplier_s_comment#5505 AS cval_supplier_s_comment_5#5523, cdepval_supplier_s_name#5506 AS cdepval_supplier_s_name_5#5524, cdepval_supplier_s_address#5507 AS cdepval_supplier_s_address_5#5525, cdepval_supplier_s_phone#5508 AS cdepval_supplier_s_phone_5#5526, cdepval_supplier_s_acctbal#5509 AS cdepval_supplier_s_acctbal_5#5527, cdepval_supplier_s_comment#5510 AS cdepval_supplier_s_comment_5#5528, cs_name#5511 AS cs_name_5#5529, cs_address#5512 AS cs_address_5#5530, cs_phone#5513 AS cs_phone_5#5531, cs_acctbal#5514 AS cs_acctbal_5#5532, cs_comment#5515 AS cs_comment_5#5533]
               +- Relation[rid#5498,cpfk_nation_supplier#5499,cfpk_supplier_nation#5500,cval_supplier_s_name#5501,cval_supplier_s_address#5502,cval_supplier_s_phone#5503,cval_supplier_s_acctbal#5504,cval_supplier_s_comment#5505,cdepval_supplier_s_name#5506,cdepval_supplier_s_address#5507,cdepval_supplier_s_phone#5508,cdepval_supplier_s_acctbal#5509,cdepval_supplier_s_comment#5510,cs_name#5511,cs_address#5512,cs_phone#5513,cs_acctbal#5514,cs_comment#5515] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 30617ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/25 23:23:48 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:23:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5662L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:23:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:23:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:23:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:23:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:23:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:23:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:23:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5662L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#5814 AS rid_1#5859, cpfk_orders_lineitem#5815 AS cpfk_orders_lineitem_1#5860, cpfk_supplier_lineitem#5816 AS cpfk_supplier_lineitem_1#5861, cfpk_lineitem_supplier#5817 AS cfpk_lineitem_supplier_1#5862, cfpk_lineitem_partsupp#5818 AS cfpk_lineitem_partsupp_1#5863, cpfk_part_lineitem#5819 AS cpfk_part_lineitem_1#5864, cfpk_lineitem_part#5820 AS cfpk_lineitem_part_1#5865, cpfk_partsupp_lineitem#5821 AS cpfk_partsupp_lineitem_1#5866, cfpk_lineitem_orders#5822 AS cfpk_lineitem_orders_1#5867, cval_lineitem_l_quantity#5823 AS cval_lineitem_l_quantity_1#5868, cval_lineitem_l_extendedprice#5824 AS cval_lineitem_l_extendedprice_1#5869, cval_lineitem_l_discount#5825 AS cval_lineitem_l_discount_1#5870, cval_lineitem_l_tax#5826 AS cval_lineitem_l_tax_1#5871, cval_lineitem_l_returnflag#5827 AS cval_lineitem_l_returnflag_1#5872, cval_lineitem_l_linestatus#5828 AS cval_lineitem_l_linestatus_1#5873, cval_lineitem_l_commitdate#5829 AS cval_lineitem_l_commitdate_1#5874, cval_lineitem_l_receiptdate#5830 AS cval_lineitem_l_receiptdate_1#5875, cval_lineitem_l_shipinstruct#5831 AS cval_lineitem_l_shipinstruct_1#5876, cval_lineitem_l_shipmode#5832 AS cval_lineitem_l_shipmode_1#5877, cval_lineitem_l_comment#5833 AS cval_lineitem_l_comment_1#5878, cval_lineitem_l_shipdate#5834 AS cval_lineitem_l_shipdate_1#5879, cdepval_lineitem_l_quantity#5835 AS cdepval_lineitem_l_quantity_1#5880, cdepval_lineitem_l_extendedprice#5836 AS cdepval_lineitem_l_extendedprice_1#5881, cdepval_lineitem_l_discount#5837 AS cdepval_lineitem_l_discount_1#5882, ... 21 more fields]
         :  +- Relation[rid#5814,cpfk_orders_lineitem#5815,cpfk_supplier_lineitem#5816,cfpk_lineitem_supplier#5817,cfpk_lineitem_partsupp#5818,cpfk_part_lineitem#5819,cfpk_lineitem_part#5820,cpfk_partsupp_lineitem#5821,cfpk_lineitem_orders#5822,cval_lineitem_l_quantity#5823,cval_lineitem_l_extendedprice#5824,cval_lineitem_l_discount#5825,cval_lineitem_l_tax#5826,cval_lineitem_l_returnflag#5827,cval_lineitem_l_linestatus#5828,cval_lineitem_l_commitdate#5829,cval_lineitem_l_receiptdate#5830,cval_lineitem_l_shipinstruct#5831,cval_lineitem_l_shipmode#5832,cval_lineitem_l_comment#5833,cval_lineitem_l_shipdate#5834,cdepval_lineitem_l_quantity#5835,cdepval_lineitem_l_extendedprice#5836,cdepval_lineitem_l_discount#5837,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
               +- Project [rid#5664 AS rid_0#5689, cval_part_p_name#5665 AS cval_part_p_name_0#5690, cval_part_p_mfgr#5666 AS cval_part_p_mfgr_0#5691, cval_part_p_type#5667 AS cval_part_p_type_0#5692, cval_part_p_size#5668 AS cval_part_p_size_0#5693, cval_part_p_container#5669 AS cval_part_p_container_0#5694, cval_part_p_retailprice#5670 AS cval_part_p_retailprice_0#5695, cval_part_p_comment#5671 AS cval_part_p_comment_0#5696, cval_part_p_brand#5672 AS cval_part_p_brand_0#5697, cdepval_part_p_name#5673 AS cdepval_part_p_name_0#5698, cdepval_part_p_mfgr#5674 AS cdepval_part_p_mfgr_0#5699, cdepval_part_p_type#5675 AS cdepval_part_p_type_0#5700, cdepval_part_p_size#5676 AS cdepval_part_p_size_0#5701, cdepval_part_p_container#5677 AS cdepval_part_p_container_0#5702, cdepval_part_p_retailprice#5678 AS cdepval_part_p_retailprice_0#5703, cdepval_part_p_comment#5679 AS cdepval_part_p_comment_0#5704, cdepval_part_p_brand#5680 AS cdepval_part_p_brand_0#5705, cp_name#5681 AS cp_name_0#5706, cp_mfgr#5682 AS cp_mfgr_0#5707, cp_type#5683 AS cp_type_0#5708, cp_size#5684 AS cp_size_0#5709, cp_container#5685 AS cp_container_0#5710, cp_retailprice#5686 AS cp_retailprice_0#5711, cp_comment#5687 AS cp_comment_0#5712, cp_brand#5688 AS cp_brand_0#5713]
                  +- Relation[rid#5664,cval_part_p_name#5665,cval_part_p_mfgr#5666,cval_part_p_type#5667,cval_part_p_size#5668,cval_part_p_container#5669,cval_part_p_retailprice#5670,cval_part_p_comment#5671,cval_part_p_brand#5672,cdepval_part_p_name#5673,cdepval_part_p_mfgr#5674,cdepval_part_p_type#5675,cdepval_part_p_size#5676,cdepval_part_p_container#5677,cdepval_part_p_retailprice#5678,cdepval_part_p_comment#5679,cdepval_part_p_brand#5680,cp_name#5681,cp_mfgr#5682,cp_type#5683,cp_size#5684,cp_container#5685,cp_retailprice#5686,cp_comment#5687,cp_brand#5688] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 26208ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/25 23:24:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:24:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5980L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:24:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5980L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#6032 AS rid_1#6077, cpfk_orders_lineitem#6033 AS cpfk_orders_lineitem_1#6078, cpfk_supplier_lineitem#6034 AS cpfk_supplier_lineitem_1#6079, cfpk_lineitem_supplier#6035 AS cfpk_lineitem_supplier_1#6080, cfpk_lineitem_partsupp#6036 AS cfpk_lineitem_partsupp_1#6081, cpfk_part_lineitem#6037 AS cpfk_part_lineitem_1#6082, cfpk_lineitem_part#6038 AS cfpk_lineitem_part_1#6083, cpfk_partsupp_lineitem#6039 AS cpfk_partsupp_lineitem_1#6084, cfpk_lineitem_orders#6040 AS cfpk_lineitem_orders_1#6085, cval_lineitem_l_quantity#6041 AS cval_lineitem_l_quantity_1#6086, cval_lineitem_l_extendedprice#6042 AS cval_lineitem_l_extendedprice_1#6087, cval_lineitem_l_discount#6043 AS cval_lineitem_l_discount_1#6088, cval_lineitem_l_tax#6044 AS cval_lineitem_l_tax_1#6089, cval_lineitem_l_returnflag#6045 AS cval_lineitem_l_returnflag_1#6090, cval_lineitem_l_linestatus#6046 AS cval_lineitem_l_linestatus_1#6091, cval_lineitem_l_commitdate#6047 AS cval_lineitem_l_commitdate_1#6092, cval_lineitem_l_receiptdate#6048 AS cval_lineitem_l_receiptdate_1#6093, cval_lineitem_l_shipinstruct#6049 AS cval_lineitem_l_shipinstruct_1#6094, cval_lineitem_l_shipmode#6050 AS cval_lineitem_l_shipmode_1#6095, cval_lineitem_l_comment#6051 AS cval_lineitem_l_comment_1#6096, cval_lineitem_l_shipdate#6052 AS cval_lineitem_l_shipdate_1#6097, cdepval_lineitem_l_quantity#6053 AS cdepval_lineitem_l_quantity_1#6098, cdepval_lineitem_l_extendedprice#6054 AS cdepval_lineitem_l_extendedprice_1#6099, cdepval_lineitem_l_discount#6055 AS cdepval_lineitem_l_discount_1#6100, ... 21 more fields]
         :  +- Relation[rid#6032,cpfk_orders_lineitem#6033,cpfk_supplier_lineitem#6034,cfpk_lineitem_supplier#6035,cfpk_lineitem_partsupp#6036,cpfk_part_lineitem#6037,cfpk_lineitem_part#6038,cpfk_partsupp_lineitem#6039,cfpk_lineitem_orders#6040,cval_lineitem_l_quantity#6041,cval_lineitem_l_extendedprice#6042,cval_lineitem_l_discount#6043,cval_lineitem_l_tax#6044,cval_lineitem_l_returnflag#6045,cval_lineitem_l_linestatus#6046,cval_lineitem_l_commitdate#6047,cval_lineitem_l_receiptdate#6048,cval_lineitem_l_shipinstruct#6049,cval_lineitem_l_shipmode#6050,cval_lineitem_l_comment#6051,cval_lineitem_l_shipdate#6052,cdepval_lineitem_l_quantity#6053,cdepval_lineitem_l_extendedprice#6054,cdepval_lineitem_l_discount#6055,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5982 AS rid_0#6007, cval_part_p_name#5983 AS cval_part_p_name_0#6008, cval_part_p_mfgr#5984 AS cval_part_p_mfgr_0#6009, cval_part_p_type#5985 AS cval_part_p_type_0#6010, cval_part_p_size#5986 AS cval_part_p_size_0#6011, cval_part_p_container#5987 AS cval_part_p_container_0#6012, cval_part_p_retailprice#5988 AS cval_part_p_retailprice_0#6013, cval_part_p_comment#5989 AS cval_part_p_comment_0#6014, cval_part_p_brand#5990 AS cval_part_p_brand_0#6015, cdepval_part_p_name#5991 AS cdepval_part_p_name_0#6016, cdepval_part_p_mfgr#5992 AS cdepval_part_p_mfgr_0#6017, cdepval_part_p_type#5993 AS cdepval_part_p_type_0#6018, cdepval_part_p_size#5994 AS cdepval_part_p_size_0#6019, cdepval_part_p_container#5995 AS cdepval_part_p_container_0#6020, cdepval_part_p_retailprice#5996 AS cdepval_part_p_retailprice_0#6021, cdepval_part_p_comment#5997 AS cdepval_part_p_comment_0#6022, cdepval_part_p_brand#5998 AS cdepval_part_p_brand_0#6023, cp_name#5999 AS cp_name_0#6024, cp_mfgr#6000 AS cp_mfgr_0#6025, cp_type#6001 AS cp_type_0#6026, cp_size#6002 AS cp_size_0#6027, cp_container#6003 AS cp_container_0#6028, cp_retailprice#6004 AS cp_retailprice_0#6029, cp_comment#6005 AS cp_comment_0#6030, cp_brand#6006 AS cp_brand_0#6031]
            +- Relation[rid#5982,cval_part_p_name#5983,cval_part_p_mfgr#5984,cval_part_p_type#5985,cval_part_p_size#5986,cval_part_p_container#5987,cval_part_p_retailprice#5988,cval_part_p_comment#5989,cval_part_p_brand#5990,cdepval_part_p_name#5991,cdepval_part_p_mfgr#5992,cdepval_part_p_type#5993,cdepval_part_p_size#5994,cdepval_part_p_container#5995,cdepval_part_p_retailprice#5996,cdepval_part_p_comment#5997,cdepval_part_p_brand#5998,cp_name#5999,cp_mfgr#6000,cp_type#6001,cp_size#6002,cp_container#6003,cp_retailprice#6004,cp_comment#6005,cp_brand#6006] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18002ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/25 23:24:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:24:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6199L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:24:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:24:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:24:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6199L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#6237 AS rid_1#6282, cpfk_orders_lineitem#6238 AS cpfk_orders_lineitem_1#6283, cpfk_supplier_lineitem#6239 AS cpfk_supplier_lineitem_1#6284, cfpk_lineitem_supplier#6240 AS cfpk_lineitem_supplier_1#6285, cfpk_lineitem_partsupp#6241 AS cfpk_lineitem_partsupp_1#6286, cpfk_part_lineitem#6242 AS cpfk_part_lineitem_1#6287, cfpk_lineitem_part#6243 AS cfpk_lineitem_part_1#6288, cpfk_partsupp_lineitem#6244 AS cpfk_partsupp_lineitem_1#6289, cfpk_lineitem_orders#6245 AS cfpk_lineitem_orders_1#6290, cval_lineitem_l_quantity#6246 AS cval_lineitem_l_quantity_1#6291, cval_lineitem_l_extendedprice#6247 AS cval_lineitem_l_extendedprice_1#6292, cval_lineitem_l_discount#6248 AS cval_lineitem_l_discount_1#6293, cval_lineitem_l_tax#6249 AS cval_lineitem_l_tax_1#6294, cval_lineitem_l_returnflag#6250 AS cval_lineitem_l_returnflag_1#6295, cval_lineitem_l_linestatus#6251 AS cval_lineitem_l_linestatus_1#6296, cval_lineitem_l_commitdate#6252 AS cval_lineitem_l_commitdate_1#6297, cval_lineitem_l_receiptdate#6253 AS cval_lineitem_l_receiptdate_1#6298, cval_lineitem_l_shipinstruct#6254 AS cval_lineitem_l_shipinstruct_1#6299, cval_lineitem_l_shipmode#6255 AS cval_lineitem_l_shipmode_1#6300, cval_lineitem_l_comment#6256 AS cval_lineitem_l_comment_1#6301, cval_lineitem_l_shipdate#6257 AS cval_lineitem_l_shipdate_1#6302, cdepval_lineitem_l_quantity#6258 AS cdepval_lineitem_l_quantity_1#6303, cdepval_lineitem_l_extendedprice#6259 AS cdepval_lineitem_l_extendedprice_1#6304, cdepval_lineitem_l_discount#6260 AS cdepval_lineitem_l_discount_1#6305, ... 21 more fields]
         :  +- Relation[rid#6237,cpfk_orders_lineitem#6238,cpfk_supplier_lineitem#6239,cfpk_lineitem_supplier#6240,cfpk_lineitem_partsupp#6241,cpfk_part_lineitem#6242,cfpk_lineitem_part#6243,cpfk_partsupp_lineitem#6244,cfpk_lineitem_orders#6245,cval_lineitem_l_quantity#6246,cval_lineitem_l_extendedprice#6247,cval_lineitem_l_discount#6248,cval_lineitem_l_tax#6249,cval_lineitem_l_returnflag#6250,cval_lineitem_l_linestatus#6251,cval_lineitem_l_commitdate#6252,cval_lineitem_l_receiptdate#6253,cval_lineitem_l_shipinstruct#6254,cval_lineitem_l_shipmode#6255,cval_lineitem_l_comment#6256,cval_lineitem_l_shipdate#6257,cdepval_lineitem_l_quantity#6258,cdepval_lineitem_l_extendedprice#6259,cdepval_lineitem_l_discount#6260,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6201 AS rid_0#6219, cpfk_nation_supplier#6202 AS cpfk_nation_supplier_0#6220, cfpk_supplier_nation#6203 AS cfpk_supplier_nation_0#6221, cval_supplier_s_name#6204 AS cval_supplier_s_name_0#6222, cval_supplier_s_address#6205 AS cval_supplier_s_address_0#6223, cval_supplier_s_phone#6206 AS cval_supplier_s_phone_0#6224, cval_supplier_s_acctbal#6207 AS cval_supplier_s_acctbal_0#6225, cval_supplier_s_comment#6208 AS cval_supplier_s_comment_0#6226, cdepval_supplier_s_name#6209 AS cdepval_supplier_s_name_0#6227, cdepval_supplier_s_address#6210 AS cdepval_supplier_s_address_0#6228, cdepval_supplier_s_phone#6211 AS cdepval_supplier_s_phone_0#6229, cdepval_supplier_s_acctbal#6212 AS cdepval_supplier_s_acctbal_0#6230, cdepval_supplier_s_comment#6213 AS cdepval_supplier_s_comment_0#6231, cs_name#6214 AS cs_name_0#6232, cs_address#6215 AS cs_address_0#6233, cs_phone#6216 AS cs_phone_0#6234, cs_acctbal#6217 AS cs_acctbal_0#6235, cs_comment#6218 AS cs_comment_0#6236]
            +- Relation[rid#6201,cpfk_nation_supplier#6202,cfpk_supplier_nation#6203,cval_supplier_s_name#6204,cval_supplier_s_address#6205,cval_supplier_s_phone#6206,cval_supplier_s_acctbal#6207,cval_supplier_s_comment#6208,cdepval_supplier_s_name#6209,cdepval_supplier_s_address#6210,cdepval_supplier_s_phone#6211,cdepval_supplier_s_acctbal#6212,cdepval_supplier_s_comment#6213,cs_name#6214,cs_address#6215,cs_phone#6216,cs_acctbal#6217,cs_comment#6218] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17211ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/25 23:24:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:24:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6395L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:24:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#6395L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#6397 AS rid_0#6442, cpfk_orders_lineitem#6398 AS cpfk_orders_lineitem_0#6443, cpfk_supplier_lineitem#6399 AS cpfk_supplier_lineitem_0#6444, cfpk_lineitem_supplier#6400 AS cfpk_lineitem_supplier_0#6445, cfpk_lineitem_partsupp#6401 AS cfpk_lineitem_partsupp_0#6446, cpfk_part_lineitem#6402 AS cpfk_part_lineitem_0#6447, cfpk_lineitem_part#6403 AS cfpk_lineitem_part_0#6448, cpfk_partsupp_lineitem#6404 AS cpfk_partsupp_lineitem_0#6449, cfpk_lineitem_orders#6405 AS cfpk_lineitem_orders_0#6450, cval_lineitem_l_quantity#6406 AS cval_lineitem_l_quantity_0#6451, cval_lineitem_l_extendedprice#6407 AS cval_lineitem_l_extendedprice_0#6452, cval_lineitem_l_discount#6408 AS cval_lineitem_l_discount_0#6453, cval_lineitem_l_tax#6409 AS cval_lineitem_l_tax_0#6454, cval_lineitem_l_returnflag#6410 AS cval_lineitem_l_returnflag_0#6455, cval_lineitem_l_linestatus#6411 AS cval_lineitem_l_linestatus_0#6456, cval_lineitem_l_commitdate#6412 AS cval_lineitem_l_commitdate_0#6457, cval_lineitem_l_receiptdate#6413 AS cval_lineitem_l_receiptdate_0#6458, cval_lineitem_l_shipinstruct#6414 AS cval_lineitem_l_shipinstruct_0#6459, cval_lineitem_l_shipmode#6415 AS cval_lineitem_l_shipmode_0#6460, cval_lineitem_l_comment#6416 AS cval_lineitem_l_comment_0#6461, cval_lineitem_l_shipdate#6417 AS cval_lineitem_l_shipdate_0#6462, cdepval_lineitem_l_quantity#6418 AS cdepval_lineitem_l_quantity_0#6463, cdepval_lineitem_l_extendedprice#6419 AS cdepval_lineitem_l_extendedprice_0#6464, cdepval_lineitem_l_discount#6420 AS cdepval_lineitem_l_discount_0#6465, ... 21 more fields]
         +- Relation[rid#6397,cpfk_orders_lineitem#6398,cpfk_supplier_lineitem#6399,cfpk_lineitem_supplier#6400,cfpk_lineitem_partsupp#6401,cpfk_part_lineitem#6402,cfpk_lineitem_part#6403,cpfk_partsupp_lineitem#6404,cfpk_lineitem_orders#6405,cval_lineitem_l_quantity#6406,cval_lineitem_l_extendedprice#6407,cval_lineitem_l_discount#6408,cval_lineitem_l_tax#6409,cval_lineitem_l_returnflag#6410,cval_lineitem_l_linestatus#6411,cval_lineitem_l_commitdate#6412,cval_lineitem_l_receiptdate#6413,cval_lineitem_l_shipinstruct#6414,cval_lineitem_l_shipmode#6415,cval_lineitem_l_comment#6416,cval_lineitem_l_shipdate#6417,cdepval_lineitem_l_quantity#6418,cdepval_lineitem_l_extendedprice#6419,cdepval_lineitem_l_discount#6420,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2342ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/25 23:24:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:24:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6544L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 23:24:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:24:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:24:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6544L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#6546 AS rid_0#6591, cpfk_orders_lineitem#6547 AS cpfk_orders_lineitem_0#6592, cpfk_supplier_lineitem#6548 AS cpfk_supplier_lineitem_0#6593, cfpk_lineitem_supplier#6549 AS cfpk_lineitem_supplier_0#6594, cfpk_lineitem_partsupp#6550 AS cfpk_lineitem_partsupp_0#6595, cpfk_part_lineitem#6551 AS cpfk_part_lineitem_0#6596, cfpk_lineitem_part#6552 AS cfpk_lineitem_part_0#6597, cpfk_partsupp_lineitem#6553 AS cpfk_partsupp_lineitem_0#6598, cfpk_lineitem_orders#6554 AS cfpk_lineitem_orders_0#6599, cval_lineitem_l_quantity#6555 AS cval_lineitem_l_quantity_0#6600, cval_lineitem_l_extendedprice#6556 AS cval_lineitem_l_extendedprice_0#6601, cval_lineitem_l_discount#6557 AS cval_lineitem_l_discount_0#6602, cval_lineitem_l_tax#6558 AS cval_lineitem_l_tax_0#6603, cval_lineitem_l_returnflag#6559 AS cval_lineitem_l_returnflag_0#6604, cval_lineitem_l_linestatus#6560 AS cval_lineitem_l_linestatus_0#6605, cval_lineitem_l_commitdate#6561 AS cval_lineitem_l_commitdate_0#6606, cval_lineitem_l_receiptdate#6562 AS cval_lineitem_l_receiptdate_0#6607, cval_lineitem_l_shipinstruct#6563 AS cval_lineitem_l_shipinstruct_0#6608, cval_lineitem_l_shipmode#6564 AS cval_lineitem_l_shipmode_0#6609, cval_lineitem_l_comment#6565 AS cval_lineitem_l_comment_0#6610, cval_lineitem_l_shipdate#6566 AS cval_lineitem_l_shipdate_0#6611, cdepval_lineitem_l_quantity#6567 AS cdepval_lineitem_l_quantity_0#6612, cdepval_lineitem_l_extendedprice#6568 AS cdepval_lineitem_l_extendedprice_0#6613, cdepval_lineitem_l_discount#6569 AS cdepval_lineitem_l_discount_0#6614, ... 21 more fields]
         :  :  :     +- Relation[rid#6546,cpfk_orders_lineitem#6547,cpfk_supplier_lineitem#6548,cfpk_lineitem_supplier#6549,cfpk_lineitem_partsupp#6550,cpfk_part_lineitem#6551,cfpk_lineitem_part#6552,cpfk_partsupp_lineitem#6553,cfpk_lineitem_orders#6554,cval_lineitem_l_quantity#6555,cval_lineitem_l_extendedprice#6556,cval_lineitem_l_discount#6557,cval_lineitem_l_tax#6558,cval_lineitem_l_returnflag#6559,cval_lineitem_l_linestatus#6560,cval_lineitem_l_commitdate#6561,cval_lineitem_l_receiptdate#6562,cval_lineitem_l_shipinstruct#6563,cval_lineitem_l_shipmode#6564,cval_lineitem_l_comment#6565,cval_lineitem_l_shipdate#6566,cdepval_lineitem_l_quantity#6567,cdepval_lineitem_l_extendedprice#6568,cdepval_lineitem_l_discount#6569,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#6726 AS rid_1#6750, cpfk_customer_orders#6727 AS cpfk_customer_orders_1#6751, cfpk_orders_customer#6728 AS cfpk_orders_customer_1#6752, cval_orders_o_orderstatus#6729 AS cval_orders_o_orderstatus_1#6753, cval_orders_o_totalprice#6730 AS cval_orders_o_totalprice_1#6754, cval_orders_o_orderpriority#6731 AS cval_orders_o_orderpriority_1#6755, cval_orders_o_clerk#6732 AS cval_orders_o_clerk_1#6756, cval_orders_o_shippriority#6733 AS cval_orders_o_shippriority_1#6757, cval_orders_o_comment#6734 AS cval_orders_o_comment_1#6758, cval_orders_o_orderdate#6735 AS cval_orders_o_orderdate_1#6759, cdepval_orders_o_orderstatus#6736 AS cdepval_orders_o_orderstatus_1#6760, cdepval_orders_o_totalprice#6737 AS cdepval_orders_o_totalprice_1#6761, cdepval_orders_o_orderpriority#6738 AS cdepval_orders_o_orderpriority_1#6762, cdepval_orders_o_clerk#6739 AS cdepval_orders_o_clerk_1#6763, cdepval_orders_o_shippriority#6740 AS cdepval_orders_o_shippriority_1#6764, cdepval_orders_o_comment#6741 AS cdepval_orders_o_comment_1#6765, cdepval_orders_o_orderdate#6742 AS cdepval_orders_o_orderdate_1#6766, co_orderstatus#6743 AS co_orderstatus_1#6767, co_totalprice#6744 AS co_totalprice_1#6768, co_orderpriority#6745 AS co_orderpriority_1#6769, co_clerk#6746 AS co_clerk_1#6770, co_shippriority#6747 AS co_shippriority_1#6771, co_comment#6748 AS co_comment_1#6772, co_orderdate#6749 AS co_orderdate_1#6773]
         :  :     +- Relation[rid#6726,cpfk_customer_orders#6727,cfpk_orders_customer#6728,cval_orders_o_orderstatus#6729,cval_orders_o_totalprice#6730,cval_orders_o_orderpriority#6731,cval_orders_o_clerk#6732,cval_orders_o_shippriority#6733,cval_orders_o_comment#6734,cval_orders_o_orderdate#6735,cdepval_orders_o_orderstatus#6736,cdepval_orders_o_totalprice#6737,cdepval_orders_o_orderpriority#6738,cdepval_orders_o_clerk#6739,cdepval_orders_o_shippriority#6740,cdepval_orders_o_comment#6741,cdepval_orders_o_orderdate#6742,co_orderstatus#6743,co_totalprice#6744,co_orderpriority#6745,co_clerk#6746,co_shippriority#6747,co_comment#6748,co_orderdate#6749] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#6774 AS rid_2#6795, cpfk_nation_customer#6775 AS cpfk_nation_customer_2#6796, cfpk_customer_nation#6776 AS cfpk_customer_nation_2#6797, cval_customer_c_name#6777 AS cval_customer_c_name_2#6798, cval_customer_c_address#6778 AS cval_customer_c_address_2#6799, cval_customer_c_phone#6779 AS cval_customer_c_phone_2#6800, cval_customer_c_acctbal#6780 AS cval_customer_c_acctbal_2#6801, cval_customer_c_comment#6781 AS cval_customer_c_comment_2#6802, cval_customer_c_mktsegment#6782 AS cval_customer_c_mktsegment_2#6803, cdepval_customer_c_name#6783 AS cdepval_customer_c_name_2#6804, cdepval_customer_c_address#6784 AS cdepval_customer_c_address_2#6805, cdepval_customer_c_phone#6785 AS cdepval_customer_c_phone_2#6806, cdepval_customer_c_acctbal#6786 AS cdepval_customer_c_acctbal_2#6807, cdepval_customer_c_comment#6787 AS cdepval_customer_c_comment_2#6808, cdepval_customer_c_mktsegment#6788 AS cdepval_customer_c_mktsegment_2#6809, cc_name#6789 AS cc_name_2#6810, cc_address#6790 AS cc_address_2#6811, cc_phone#6791 AS cc_phone_2#6812, cc_acctbal#6792 AS cc_acctbal_2#6813, cc_comment#6793 AS cc_comment_2#6814, cc_mktsegment#6794 AS cc_mktsegment_2#6815]
         :     +- Relation[rid#6774,cpfk_nation_customer#6775,cfpk_customer_nation#6776,cval_customer_c_name#6777,cval_customer_c_address#6778,cval_customer_c_phone#6779,cval_customer_c_acctbal#6780,cval_customer_c_comment#6781,cval_customer_c_mktsegment#6782,cdepval_customer_c_name#6783,cdepval_customer_c_address#6784,cdepval_customer_c_phone#6785,cdepval_customer_c_acctbal#6786,cdepval_customer_c_comment#6787,cdepval_customer_c_mktsegment#6788,cc_name#6789,cc_address#6790,cc_phone#6791,cc_acctbal#6792,cc_comment#6793,cc_mktsegment#6794] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#6816 AS rid_3#6825, cpfk_region_nation#6817 AS cpfk_region_nation_3#6826, cfpk_nation_region#6818 AS cfpk_nation_region_3#6827, cval_nation_n_name#6819 AS cval_nation_n_name_3#6828, cval_nation_n_comment#6820 AS cval_nation_n_comment_3#6829, cdepval_nation_n_name#6821 AS cdepval_nation_n_name_3#6830, cdepval_nation_n_comment#6822 AS cdepval_nation_n_comment_3#6831, cn_name#6823 AS cn_name_3#6832, cn_comment#6824 AS cn_comment_3#6833]
            +- Relation[rid#6816,cpfk_region_nation#6817,cfpk_nation_region#6818,cval_nation_n_name#6819,cval_nation_n_comment#6820,cdepval_nation_n_name#6821,cdepval_nation_n_comment#6822,cn_name#6823,cn_comment#6824] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 60311ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/25 23:25:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:25:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6940L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:25:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:25:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:25:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:25:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:25:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:25:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:25:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:25:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:25:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:25:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:25:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:25:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:25:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6940L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :  :  :  :- Project [rid#7042 AS rid_1#7087, cpfk_orders_lineitem#7043 AS cpfk_orders_lineitem_1#7088, cpfk_supplier_lineitem#7044 AS cpfk_supplier_lineitem_1#7089, cfpk_lineitem_supplier#7045 AS cfpk_lineitem_supplier_1#7090, cfpk_lineitem_partsupp#7046 AS cfpk_lineitem_partsupp_1#7091, cpfk_part_lineitem#7047 AS cpfk_part_lineitem_1#7092, cfpk_lineitem_part#7048 AS cfpk_lineitem_part_1#7093, cpfk_partsupp_lineitem#7049 AS cpfk_partsupp_lineitem_1#7094, cfpk_lineitem_orders#7050 AS cfpk_lineitem_orders_1#7095, cval_lineitem_l_quantity#7051 AS cval_lineitem_l_quantity_1#7096, cval_lineitem_l_extendedprice#7052 AS cval_lineitem_l_extendedprice_1#7097, cval_lineitem_l_discount#7053 AS cval_lineitem_l_discount_1#7098, cval_lineitem_l_tax#7054 AS cval_lineitem_l_tax_1#7099, cval_lineitem_l_returnflag#7055 AS cval_lineitem_l_returnflag_1#7100, cval_lineitem_l_linestatus#7056 AS cval_lineitem_l_linestatus_1#7101, cval_lineitem_l_commitdate#7057 AS cval_lineitem_l_commitdate_1#7102, cval_lineitem_l_receiptdate#7058 AS cval_lineitem_l_receiptdate_1#7103, cval_lineitem_l_shipinstruct#7059 AS cval_lineitem_l_shipinstruct_1#7104, cval_lineitem_l_shipmode#7060 AS cval_lineitem_l_shipmode_1#7105, cval_lineitem_l_comment#7061 AS cval_lineitem_l_comment_1#7106, cval_lineitem_l_shipdate#7062 AS cval_lineitem_l_shipdate_1#7107, cdepval_lineitem_l_quantity#7063 AS cdepval_lineitem_l_quantity_1#7108, cdepval_lineitem_l_extendedprice#7064 AS cdepval_lineitem_l_extendedprice_1#7109, cdepval_lineitem_l_discount#7065 AS cdepval_lineitem_l_discount_1#7110, ... 21 more fields]
         :  :  :  :  +- Relation[rid#7042,cpfk_orders_lineitem#7043,cpfk_supplier_lineitem#7044,cfpk_lineitem_supplier#7045,cfpk_lineitem_partsupp#7046,cpfk_part_lineitem#7047,cfpk_lineitem_part#7048,cpfk_partsupp_lineitem#7049,cfpk_lineitem_orders#7050,cval_lineitem_l_quantity#7051,cval_lineitem_l_extendedprice#7052,cval_lineitem_l_discount#7053,cval_lineitem_l_tax#7054,cval_lineitem_l_returnflag#7055,cval_lineitem_l_linestatus#7056,cval_lineitem_l_commitdate#7057,cval_lineitem_l_receiptdate#7058,cval_lineitem_l_shipinstruct#7059,cval_lineitem_l_shipmode#7060,cval_lineitem_l_comment#7061,cval_lineitem_l_shipdate#7062,cdepval_lineitem_l_quantity#7063,cdepval_lineitem_l_extendedprice#7064,cdepval_lineitem_l_discount#7065,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :     +- Project [rid#6942 AS rid_0#6967, cval_part_p_name#6943 AS cval_part_p_name_0#6968, cval_part_p_mfgr#6944 AS cval_part_p_mfgr_0#6969, cval_part_p_type#6945 AS cval_part_p_type_0#6970, cval_part_p_size#6946 AS cval_part_p_size_0#6971, cval_part_p_container#6947 AS cval_part_p_container_0#6972, cval_part_p_retailprice#6948 AS cval_part_p_retailprice_0#6973, cval_part_p_comment#6949 AS cval_part_p_comment_0#6974, cval_part_p_brand#6950 AS cval_part_p_brand_0#6975, cdepval_part_p_name#6951 AS cdepval_part_p_name_0#6976, cdepval_part_p_mfgr#6952 AS cdepval_part_p_mfgr_0#6977, cdepval_part_p_type#6953 AS cdepval_part_p_type_0#6978, cdepval_part_p_size#6954 AS cdepval_part_p_size_0#6979, cdepval_part_p_container#6955 AS cdepval_part_p_container_0#6980, cdepval_part_p_retailprice#6956 AS cdepval_part_p_retailprice_0#6981, cdepval_part_p_comment#6957 AS cdepval_part_p_comment_0#6982, cdepval_part_p_brand#6958 AS cdepval_part_p_brand_0#6983, cp_name#6959 AS cp_name_0#6984, cp_mfgr#6960 AS cp_mfgr_0#6985, cp_type#6961 AS cp_type_0#6986, cp_size#6962 AS cp_size_0#6987, cp_container#6963 AS cp_container_0#6988, cp_retailprice#6964 AS cp_retailprice_0#6989, cp_comment#6965 AS cp_comment_0#6990, cp_brand#6966 AS cp_brand_0#6991]
         :  :  :        +- Relation[rid#6942,cval_part_p_name#6943,cval_part_p_mfgr#6944,cval_part_p_type#6945,cval_part_p_size#6946,cval_part_p_container#6947,cval_part_p_retailprice#6948,cval_part_p_comment#6949,cval_part_p_brand#6950,cdepval_part_p_name#6951,cdepval_part_p_mfgr#6952,cdepval_part_p_type#6953,cdepval_part_p_size#6954,cdepval_part_p_container#6955,cdepval_part_p_retailprice#6956,cdepval_part_p_comment#6957,cdepval_part_p_brand#6958,cp_name#6959,cp_mfgr#6960,cp_type#6961,cp_size#6962,cp_container#6963,cp_retailprice#6964,cp_comment#6965,cp_brand#6966] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- Project [rid#7132 AS rid_2#7150, cpfk_nation_supplier#7133 AS cpfk_nation_supplier_2#7151, cfpk_supplier_nation#7134 AS cfpk_supplier_nation_2#7152, cval_supplier_s_name#7135 AS cval_supplier_s_name_2#7153, cval_supplier_s_address#7136 AS cval_supplier_s_address_2#7154, cval_supplier_s_phone#7137 AS cval_supplier_s_phone_2#7155, cval_supplier_s_acctbal#7138 AS cval_supplier_s_acctbal_2#7156, cval_supplier_s_comment#7139 AS cval_supplier_s_comment_2#7157, cdepval_supplier_s_name#7140 AS cdepval_supplier_s_name_2#7158, cdepval_supplier_s_address#7141 AS cdepval_supplier_s_address_2#7159, cdepval_supplier_s_phone#7142 AS cdepval_supplier_s_phone_2#7160, cdepval_supplier_s_acctbal#7143 AS cdepval_supplier_s_acctbal_2#7161, cdepval_supplier_s_comment#7144 AS cdepval_supplier_s_comment_2#7162, cs_name#7145 AS cs_name_2#7163, cs_address#7146 AS cs_address_2#7164, cs_phone#7147 AS cs_phone_2#7165, cs_acctbal#7148 AS cs_acctbal_2#7166, cs_comment#7149 AS cs_comment_2#7167]
         :  :     +- Relation[rid#7132,cpfk_nation_supplier#7133,cfpk_supplier_nation#7134,cval_supplier_s_name#7135,cval_supplier_s_address#7136,cval_supplier_s_phone#7137,cval_supplier_s_acctbal#7138,cval_supplier_s_comment#7139,cdepval_supplier_s_name#7140,cdepval_supplier_s_address#7141,cdepval_supplier_s_phone#7142,cdepval_supplier_s_acctbal#7143,cdepval_supplier_s_comment#7144,cs_name#7145,cs_address#7146,cs_phone#7147,cs_acctbal#7148,cs_comment#7149] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#7168 AS rid_3#7177, cpfk_region_nation#7169 AS cpfk_region_nation_3#7178, cfpk_nation_region#7170 AS cfpk_nation_region_3#7179, cval_nation_n_name#7171 AS cval_nation_n_name_3#7180, cval_nation_n_comment#7172 AS cval_nation_n_comment_3#7181, cdepval_nation_n_name#7173 AS cdepval_nation_n_name_3#7182, cdepval_nation_n_comment#7174 AS cdepval_nation_n_comment_3#7183, cn_name#7175 AS cn_name_3#7184, cn_comment#7176 AS cn_comment_3#7185]
         :     +- Relation[rid#7168,cpfk_region_nation#7169,cfpk_nation_region#7170,cval_nation_n_name#7171,cval_nation_n_comment#7172,cdepval_nation_n_name#7173,cdepval_nation_n_comment#7174,cn_name#7175,cn_comment#7176] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#7274 AS rid_7#7298, cpfk_customer_orders#7275 AS cpfk_customer_orders_7#7299, cfpk_orders_customer#7276 AS cfpk_orders_customer_7#7300, cval_orders_o_orderstatus#7277 AS cval_orders_o_orderstatus_7#7301, cval_orders_o_totalprice#7278 AS cval_orders_o_totalprice_7#7302, cval_orders_o_orderpriority#7279 AS cval_orders_o_orderpriority_7#7303, cval_orders_o_clerk#7280 AS cval_orders_o_clerk_7#7304, cval_orders_o_shippriority#7281 AS cval_orders_o_shippriority_7#7305, cval_orders_o_comment#7282 AS cval_orders_o_comment_7#7306, cval_orders_o_orderdate#7283 AS cval_orders_o_orderdate_7#7307, cdepval_orders_o_orderstatus#7284 AS cdepval_orders_o_orderstatus_7#7308, cdepval_orders_o_totalprice#7285 AS cdepval_orders_o_totalprice_7#7309, cdepval_orders_o_orderpriority#7286 AS cdepval_orders_o_orderpriority_7#7310, cdepval_orders_o_clerk#7287 AS cdepval_orders_o_clerk_7#7311, cdepval_orders_o_shippriority#7288 AS cdepval_orders_o_shippriority_7#7312, cdepval_orders_o_comment#7289 AS cdepval_orders_o_comment_7#7313, cdepval_orders_o_orderdate#7290 AS cdepval_orders_o_orderdate_7#7314, co_orderstatus#7291 AS co_orderstatus_7#7315, co_totalprice#7292 AS co_totalprice_7#7316, co_orderpriority#7293 AS co_orderpriority_7#7317, co_clerk#7294 AS co_clerk_7#7318, co_shippriority#7295 AS co_shippriority_7#7319, co_comment#7296 AS co_comment_7#7320, co_orderdate#7297 AS co_orderdate_7#7321]
            :  +- Relation[rid#7274,cpfk_customer_orders#7275,cfpk_orders_customer#7276,cval_orders_o_orderstatus#7277,cval_orders_o_totalprice#7278,cval_orders_o_orderpriority#7279,cval_orders_o_clerk#7280,cval_orders_o_shippriority#7281,cval_orders_o_comment#7282,cval_orders_o_orderdate#7283,cdepval_orders_o_orderstatus#7284,cdepval_orders_o_totalprice#7285,cdepval_orders_o_orderpriority#7286,cdepval_orders_o_clerk#7287,cdepval_orders_o_shippriority#7288,cdepval_orders_o_comment#7289,cdepval_orders_o_orderdate#7290,co_orderstatus#7291,co_totalprice#7292,co_orderpriority#7293,co_clerk#7294,co_shippriority#7295,co_comment#7296,co_orderdate#7297] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#7232 AS rid_6#7253, cpfk_nation_customer#7233 AS cpfk_nation_customer_6#7254, cfpk_customer_nation#7234 AS cfpk_customer_nation_6#7255, cval_customer_c_name#7235 AS cval_customer_c_name_6#7256, cval_customer_c_address#7236 AS cval_customer_c_address_6#7257, cval_customer_c_phone#7237 AS cval_customer_c_phone_6#7258, cval_customer_c_acctbal#7238 AS cval_customer_c_acctbal_6#7259, cval_customer_c_comment#7239 AS cval_customer_c_comment_6#7260, cval_customer_c_mktsegment#7240 AS cval_customer_c_mktsegment_6#7261, cdepval_customer_c_name#7241 AS cdepval_customer_c_name_6#7262, cdepval_customer_c_address#7242 AS cdepval_customer_c_address_6#7263, cdepval_customer_c_phone#7243 AS cdepval_customer_c_phone_6#7264, cdepval_customer_c_acctbal#7244 AS cdepval_customer_c_acctbal_6#7265, cdepval_customer_c_comment#7245 AS cdepval_customer_c_comment_6#7266, cdepval_customer_c_mktsegment#7246 AS cdepval_customer_c_mktsegment_6#7267, cc_name#7247 AS cc_name_6#7268, cc_address#7248 AS cc_address_6#7269, cc_phone#7249 AS cc_phone_6#7270, cc_acctbal#7250 AS cc_acctbal_6#7271, cc_comment#7251 AS cc_comment_6#7272, cc_mktsegment#7252 AS cc_mktsegment_6#7273]
               :  +- Relation[rid#7232,cpfk_nation_customer#7233,cfpk_customer_nation#7234,cval_customer_c_name#7235,cval_customer_c_address#7236,cval_customer_c_phone#7237,cval_customer_c_acctbal#7238,cval_customer_c_comment#7239,cval_customer_c_mktsegment#7240,cdepval_customer_c_name#7241,cdepval_customer_c_address#7242,cdepval_customer_c_phone#7243,cdepval_customer_c_acctbal#7244,cdepval_customer_c_comment#7245,cdepval_customer_c_mktsegment#7246,cc_name#7247,cc_address#7248,cc_phone#7249,cc_acctbal#7250,cc_comment#7251,cc_mktsegment#7252] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_5, BinaryType)), 'cfpk_nation_region_5) = 'rid_4)
                  :- Project [rid#7214 AS rid_5#7223, cpfk_region_nation#7215 AS cpfk_region_nation_5#7224, cfpk_nation_region#7216 AS cfpk_nation_region_5#7225, cval_nation_n_name#7217 AS cval_nation_n_name_5#7226, cval_nation_n_comment#7218 AS cval_nation_n_comment_5#7227, cdepval_nation_n_name#7219 AS cdepval_nation_n_name_5#7228, cdepval_nation_n_comment#7220 AS cdepval_nation_n_comment_5#7229, cn_name#7221 AS cn_name_5#7230, cn_comment#7222 AS cn_comment_5#7231]
                  :  +- Relation[rid#7214,cpfk_region_nation#7215,cfpk_nation_region#7216,cval_nation_n_name#7217,cval_nation_n_comment#7218,cdepval_nation_n_name#7219,cdepval_nation_n_comment#7220,cn_name#7221,cn_comment#7222] JDBCRelation(tnation) [numPartitions=1]
                  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                     +- Project [rid#7186 AS rid_4#7193, cval_region_r_name#7187 AS cval_region_r_name_4#7194, cval_region_r_comment#7188 AS cval_region_r_comment_4#7195, cdepval_region_r_name#7189 AS cdepval_region_r_name_4#7196, cdepval_region_r_comment#7190 AS cdepval_region_r_comment_4#7197, cr_name#7191 AS cr_name_4#7198, cr_comment#7192 AS cr_comment_4#7199]
                        +- Relation[rid#7186,cval_region_r_name#7187,cval_region_r_comment#7188,cdepval_region_r_name#7189,cdepval_region_r_comment#7190,cr_name#7191,cr_comment#7192] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 44728ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/25 23:26:37 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:26:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7489L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:26:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7489L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#7581 AS rid_2#7626, cpfk_orders_lineitem#7582 AS cpfk_orders_lineitem_2#7627, cpfk_supplier_lineitem#7583 AS cpfk_supplier_lineitem_2#7628, cfpk_lineitem_supplier#7584 AS cfpk_lineitem_supplier_2#7629, cfpk_lineitem_partsupp#7585 AS cfpk_lineitem_partsupp_2#7630, cpfk_part_lineitem#7586 AS cpfk_part_lineitem_2#7631, cfpk_lineitem_part#7587 AS cfpk_lineitem_part_2#7632, cpfk_partsupp_lineitem#7588 AS cpfk_partsupp_lineitem_2#7633, cfpk_lineitem_orders#7589 AS cfpk_lineitem_orders_2#7634, cval_lineitem_l_quantity#7590 AS cval_lineitem_l_quantity_2#7635, cval_lineitem_l_extendedprice#7591 AS cval_lineitem_l_extendedprice_2#7636, cval_lineitem_l_discount#7592 AS cval_lineitem_l_discount_2#7637, cval_lineitem_l_tax#7593 AS cval_lineitem_l_tax_2#7638, cval_lineitem_l_returnflag#7594 AS cval_lineitem_l_returnflag_2#7639, cval_lineitem_l_linestatus#7595 AS cval_lineitem_l_linestatus_2#7640, cval_lineitem_l_commitdate#7596 AS cval_lineitem_l_commitdate_2#7641, cval_lineitem_l_receiptdate#7597 AS cval_lineitem_l_receiptdate_2#7642, cval_lineitem_l_shipinstruct#7598 AS cval_lineitem_l_shipinstruct_2#7643, cval_lineitem_l_shipmode#7599 AS cval_lineitem_l_shipmode_2#7644, cval_lineitem_l_comment#7600 AS cval_lineitem_l_comment_2#7645, cval_lineitem_l_shipdate#7601 AS cval_lineitem_l_shipdate_2#7646, cdepval_lineitem_l_quantity#7602 AS cdepval_lineitem_l_quantity_2#7647, cdepval_lineitem_l_extendedprice#7603 AS cdepval_lineitem_l_extendedprice_2#7648, cdepval_lineitem_l_discount#7604 AS cdepval_lineitem_l_discount_2#7649, ... 21 more fields]
         :  +- Relation[rid#7581,cpfk_orders_lineitem#7582,cpfk_supplier_lineitem#7583,cfpk_lineitem_supplier#7584,cfpk_lineitem_partsupp#7585,cpfk_part_lineitem#7586,cfpk_lineitem_part#7587,cpfk_partsupp_lineitem#7588,cfpk_lineitem_orders#7589,cval_lineitem_l_quantity#7590,cval_lineitem_l_extendedprice#7591,cval_lineitem_l_discount#7592,cval_lineitem_l_tax#7593,cval_lineitem_l_returnflag#7594,cval_lineitem_l_linestatus#7595,cval_lineitem_l_commitdate#7596,cval_lineitem_l_receiptdate#7597,cval_lineitem_l_shipinstruct#7598,cval_lineitem_l_shipmode#7599,cval_lineitem_l_comment#7600,cval_lineitem_l_shipdate#7601,cdepval_lineitem_l_quantity#7602,cdepval_lineitem_l_extendedprice#7603,cdepval_lineitem_l_discount#7604,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#7533 AS rid_1#7557, cpfk_customer_orders#7534 AS cpfk_customer_orders_1#7558, cfpk_orders_customer#7535 AS cfpk_orders_customer_1#7559, cval_orders_o_orderstatus#7536 AS cval_orders_o_orderstatus_1#7560, cval_orders_o_totalprice#7537 AS cval_orders_o_totalprice_1#7561, cval_orders_o_orderpriority#7538 AS cval_orders_o_orderpriority_1#7562, cval_orders_o_clerk#7539 AS cval_orders_o_clerk_1#7563, cval_orders_o_shippriority#7540 AS cval_orders_o_shippriority_1#7564, cval_orders_o_comment#7541 AS cval_orders_o_comment_1#7565, cval_orders_o_orderdate#7542 AS cval_orders_o_orderdate_1#7566, cdepval_orders_o_orderstatus#7543 AS cdepval_orders_o_orderstatus_1#7567, cdepval_orders_o_totalprice#7544 AS cdepval_orders_o_totalprice_1#7568, cdepval_orders_o_orderpriority#7545 AS cdepval_orders_o_orderpriority_1#7569, cdepval_orders_o_clerk#7546 AS cdepval_orders_o_clerk_1#7570, cdepval_orders_o_shippriority#7547 AS cdepval_orders_o_shippriority_1#7571, cdepval_orders_o_comment#7548 AS cdepval_orders_o_comment_1#7572, cdepval_orders_o_orderdate#7549 AS cdepval_orders_o_orderdate_1#7573, co_orderstatus#7550 AS co_orderstatus_1#7574, co_totalprice#7551 AS co_totalprice_1#7575, co_orderpriority#7552 AS co_orderpriority_1#7576, co_clerk#7553 AS co_clerk_1#7577, co_shippriority#7554 AS co_shippriority_1#7578, co_comment#7555 AS co_comment_1#7579, co_orderdate#7556 AS co_orderdate_1#7580]
            :  +- Relation[rid#7533,cpfk_customer_orders#7534,cfpk_orders_customer#7535,cval_orders_o_orderstatus#7536,cval_orders_o_totalprice#7537,cval_orders_o_orderpriority#7538,cval_orders_o_clerk#7539,cval_orders_o_shippriority#7540,cval_orders_o_comment#7541,cval_orders_o_orderdate#7542,cdepval_orders_o_orderstatus#7543,cdepval_orders_o_totalprice#7544,cdepval_orders_o_orderpriority#7545,cdepval_orders_o_clerk#7546,cdepval_orders_o_shippriority#7547,cdepval_orders_o_comment#7548,cdepval_orders_o_orderdate#7549,co_orderstatus#7550,co_totalprice#7551,co_orderpriority#7552,co_clerk#7553,co_shippriority#7554,co_comment#7555,co_orderdate#7556] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#7491 AS rid_0#7512, cpfk_nation_customer#7492 AS cpfk_nation_customer_0#7513, cfpk_customer_nation#7493 AS cfpk_customer_nation_0#7514, cval_customer_c_name#7494 AS cval_customer_c_name_0#7515, cval_customer_c_address#7495 AS cval_customer_c_address_0#7516, cval_customer_c_phone#7496 AS cval_customer_c_phone_0#7517, cval_customer_c_acctbal#7497 AS cval_customer_c_acctbal_0#7518, cval_customer_c_comment#7498 AS cval_customer_c_comment_0#7519, cval_customer_c_mktsegment#7499 AS cval_customer_c_mktsegment_0#7520, cdepval_customer_c_name#7500 AS cdepval_customer_c_name_0#7521, cdepval_customer_c_address#7501 AS cdepval_customer_c_address_0#7522, cdepval_customer_c_phone#7502 AS cdepval_customer_c_phone_0#7523, cdepval_customer_c_acctbal#7503 AS cdepval_customer_c_acctbal_0#7524, cdepval_customer_c_comment#7504 AS cdepval_customer_c_comment_0#7525, cdepval_customer_c_mktsegment#7505 AS cdepval_customer_c_mktsegment_0#7526, cc_name#7506 AS cc_name_0#7527, cc_address#7507 AS cc_address_0#7528, cc_phone#7508 AS cc_phone_0#7529, cc_acctbal#7509 AS cc_acctbal_0#7530, cc_comment#7510 AS cc_comment_0#7531, cc_mktsegment#7511 AS cc_mktsegment_0#7532]
               +- Relation[rid#7491,cpfk_nation_customer#7492,cfpk_customer_nation#7493,cval_customer_c_name#7494,cval_customer_c_address#7495,cval_customer_c_phone#7496,cval_customer_c_acctbal#7497,cval_customer_c_comment#7498,cval_customer_c_mktsegment#7499,cdepval_customer_c_name#7500,cdepval_customer_c_address#7501,cdepval_customer_c_phone#7502,cdepval_customer_c_acctbal#7503,cdepval_customer_c_comment#7504,cdepval_customer_c_mktsegment#7505,cc_name#7506,cc_address#7507,cc_phone#7508,cc_acctbal#7509,cc_comment#7510,cc_mktsegment#7511] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 22000ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/25 23:26:59 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:26:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7765L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:26:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7765L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#7767 AS rid_0#7812, cpfk_orders_lineitem#7768 AS cpfk_orders_lineitem_0#7813, cpfk_supplier_lineitem#7769 AS cpfk_supplier_lineitem_0#7814, cfpk_lineitem_supplier#7770 AS cfpk_lineitem_supplier_0#7815, cfpk_lineitem_partsupp#7771 AS cfpk_lineitem_partsupp_0#7816, cpfk_part_lineitem#7772 AS cpfk_part_lineitem_0#7817, cfpk_lineitem_part#7773 AS cfpk_lineitem_part_0#7818, cpfk_partsupp_lineitem#7774 AS cpfk_partsupp_lineitem_0#7819, cfpk_lineitem_orders#7775 AS cfpk_lineitem_orders_0#7820, cval_lineitem_l_quantity#7776 AS cval_lineitem_l_quantity_0#7821, cval_lineitem_l_extendedprice#7777 AS cval_lineitem_l_extendedprice_0#7822, cval_lineitem_l_discount#7778 AS cval_lineitem_l_discount_0#7823, cval_lineitem_l_tax#7779 AS cval_lineitem_l_tax_0#7824, cval_lineitem_l_returnflag#7780 AS cval_lineitem_l_returnflag_0#7825, cval_lineitem_l_linestatus#7781 AS cval_lineitem_l_linestatus_0#7826, cval_lineitem_l_commitdate#7782 AS cval_lineitem_l_commitdate_0#7827, cval_lineitem_l_receiptdate#7783 AS cval_lineitem_l_receiptdate_0#7828, cval_lineitem_l_shipinstruct#7784 AS cval_lineitem_l_shipinstruct_0#7829, cval_lineitem_l_shipmode#7785 AS cval_lineitem_l_shipmode_0#7830, cval_lineitem_l_comment#7786 AS cval_lineitem_l_comment_0#7831, cval_lineitem_l_shipdate#7787 AS cval_lineitem_l_shipdate_0#7832, cdepval_lineitem_l_quantity#7788 AS cdepval_lineitem_l_quantity_0#7833, cdepval_lineitem_l_extendedprice#7789 AS cdepval_lineitem_l_extendedprice_0#7834, cdepval_lineitem_l_discount#7790 AS cdepval_lineitem_l_discount_0#7835, ... 21 more fields]
         :     +- Relation[rid#7767,cpfk_orders_lineitem#7768,cpfk_supplier_lineitem#7769,cfpk_lineitem_supplier#7770,cfpk_lineitem_partsupp#7771,cpfk_part_lineitem#7772,cfpk_lineitem_part#7773,cpfk_partsupp_lineitem#7774,cfpk_lineitem_orders#7775,cval_lineitem_l_quantity#7776,cval_lineitem_l_extendedprice#7777,cval_lineitem_l_discount#7778,cval_lineitem_l_tax#7779,cval_lineitem_l_returnflag#7780,cval_lineitem_l_linestatus#7781,cval_lineitem_l_commitdate#7782,cval_lineitem_l_receiptdate#7783,cval_lineitem_l_shipinstruct#7784,cval_lineitem_l_shipmode#7785,cval_lineitem_l_comment#7786,cval_lineitem_l_shipdate#7787,cdepval_lineitem_l_quantity#7788,cdepval_lineitem_l_extendedprice#7789,cdepval_lineitem_l_discount#7790,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7947 AS rid_1#7971, cpfk_customer_orders#7948 AS cpfk_customer_orders_1#7972, cfpk_orders_customer#7949 AS cfpk_orders_customer_1#7973, cval_orders_o_orderstatus#7950 AS cval_orders_o_orderstatus_1#7974, cval_orders_o_totalprice#7951 AS cval_orders_o_totalprice_1#7975, cval_orders_o_orderpriority#7952 AS cval_orders_o_orderpriority_1#7976, cval_orders_o_clerk#7953 AS cval_orders_o_clerk_1#7977, cval_orders_o_shippriority#7954 AS cval_orders_o_shippriority_1#7978, cval_orders_o_comment#7955 AS cval_orders_o_comment_1#7979, cval_orders_o_orderdate#7956 AS cval_orders_o_orderdate_1#7980, cdepval_orders_o_orderstatus#7957 AS cdepval_orders_o_orderstatus_1#7981, cdepval_orders_o_totalprice#7958 AS cdepval_orders_o_totalprice_1#7982, cdepval_orders_o_orderpriority#7959 AS cdepval_orders_o_orderpriority_1#7983, cdepval_orders_o_clerk#7960 AS cdepval_orders_o_clerk_1#7984, cdepval_orders_o_shippriority#7961 AS cdepval_orders_o_shippriority_1#7985, cdepval_orders_o_comment#7962 AS cdepval_orders_o_comment_1#7986, cdepval_orders_o_orderdate#7963 AS cdepval_orders_o_orderdate_1#7987, co_orderstatus#7964 AS co_orderstatus_1#7988, co_totalprice#7965 AS co_totalprice_1#7989, co_orderpriority#7966 AS co_orderpriority_1#7990, co_clerk#7967 AS co_clerk_1#7991, co_shippriority#7968 AS co_shippriority_1#7992, co_comment#7969 AS co_comment_1#7993, co_orderdate#7970 AS co_orderdate_1#7994]
            +- Relation[rid#7947,cpfk_customer_orders#7948,cfpk_orders_customer#7949,cval_orders_o_orderstatus#7950,cval_orders_o_totalprice#7951,cval_orders_o_orderpriority#7952,cval_orders_o_clerk#7953,cval_orders_o_shippriority#7954,cval_orders_o_comment#7955,cval_orders_o_orderdate#7956,cdepval_orders_o_orderstatus#7957,cdepval_orders_o_totalprice#7958,cdepval_orders_o_orderpriority#7959,cdepval_orders_o_clerk#7960,cdepval_orders_o_shippriority#7961,cdepval_orders_o_comment#7962,cdepval_orders_o_orderdate#7963,co_orderstatus#7964,co_totalprice#7965,co_orderpriority#7966,co_clerk#7967,co_shippriority#7968,co_comment#7969,co_orderdate#7970] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 22426ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/25 23:27:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:27:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8069L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 23:27:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8069L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#8071 AS rid_0#8095, cpfk_customer_orders#8072 AS cpfk_customer_orders_0#8096, cfpk_orders_customer#8073 AS cfpk_orders_customer_0#8097, cval_orders_o_orderstatus#8074 AS cval_orders_o_orderstatus_0#8098, cval_orders_o_totalprice#8075 AS cval_orders_o_totalprice_0#8099, cval_orders_o_orderpriority#8076 AS cval_orders_o_orderpriority_0#8100, cval_orders_o_clerk#8077 AS cval_orders_o_clerk_0#8101, cval_orders_o_shippriority#8078 AS cval_orders_o_shippriority_0#8102, cval_orders_o_comment#8079 AS cval_orders_o_comment_0#8103, cval_orders_o_orderdate#8080 AS cval_orders_o_orderdate_0#8104, cdepval_orders_o_orderstatus#8081 AS cdepval_orders_o_orderstatus_0#8105, cdepval_orders_o_totalprice#8082 AS cdepval_orders_o_totalprice_0#8106, cdepval_orders_o_orderpriority#8083 AS cdepval_orders_o_orderpriority_0#8107, cdepval_orders_o_clerk#8084 AS cdepval_orders_o_clerk_0#8108, cdepval_orders_o_shippriority#8085 AS cdepval_orders_o_shippriority_0#8109, cdepval_orders_o_comment#8086 AS cdepval_orders_o_comment_0#8110, cdepval_orders_o_orderdate#8087 AS cdepval_orders_o_orderdate_0#8111, co_orderstatus#8088 AS co_orderstatus_0#8112, co_totalprice#8089 AS co_totalprice_0#8113, co_orderpriority#8090 AS co_orderpriority_0#8114, co_clerk#8091 AS co_clerk_0#8115, co_shippriority#8092 AS co_shippriority_0#8116, co_comment#8093 AS co_comment_0#8117, co_orderdate#8094 AS co_orderdate_0#8118]
         :  +- Relation[rid#8071,cpfk_customer_orders#8072,cfpk_orders_customer#8073,cval_orders_o_orderstatus#8074,cval_orders_o_totalprice#8075,cval_orders_o_orderpriority#8076,cval_orders_o_clerk#8077,cval_orders_o_shippriority#8078,cval_orders_o_comment#8079,cval_orders_o_orderdate#8080,cdepval_orders_o_orderstatus#8081,cdepval_orders_o_totalprice#8082,cdepval_orders_o_orderpriority#8083,cdepval_orders_o_clerk#8084,cdepval_orders_o_shippriority#8085,cdepval_orders_o_comment#8086,cdepval_orders_o_orderdate#8087,co_orderstatus#8088,co_totalprice#8089,co_orderpriority#8090,co_clerk#8091,co_shippriority#8092,co_comment#8093,co_orderdate#8094] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#8119 AS rid_1#8140, cpfk_nation_customer#8120 AS cpfk_nation_customer_1#8141, cfpk_customer_nation#8121 AS cfpk_customer_nation_1#8142, cval_customer_c_name#8122 AS cval_customer_c_name_1#8143, cval_customer_c_address#8123 AS cval_customer_c_address_1#8144, cval_customer_c_phone#8124 AS cval_customer_c_phone_1#8145, cval_customer_c_acctbal#8125 AS cval_customer_c_acctbal_1#8146, cval_customer_c_comment#8126 AS cval_customer_c_comment_1#8147, cval_customer_c_mktsegment#8127 AS cval_customer_c_mktsegment_1#8148, cdepval_customer_c_name#8128 AS cdepval_customer_c_name_1#8149, cdepval_customer_c_address#8129 AS cdepval_customer_c_address_1#8150, cdepval_customer_c_phone#8130 AS cdepval_customer_c_phone_1#8151, cdepval_customer_c_acctbal#8131 AS cdepval_customer_c_acctbal_1#8152, cdepval_customer_c_comment#8132 AS cdepval_customer_c_comment_1#8153, cdepval_customer_c_mktsegment#8133 AS cdepval_customer_c_mktsegment_1#8154, cc_name#8134 AS cc_name_1#8155, cc_address#8135 AS cc_address_1#8156, cc_phone#8136 AS cc_phone_1#8157, cc_acctbal#8137 AS cc_acctbal_1#8158, cc_comment#8138 AS cc_comment_1#8159, cc_mktsegment#8139 AS cc_mktsegment_1#8160]
            +- Relation[rid#8119,cpfk_nation_customer#8120,cfpk_customer_nation#8121,cval_customer_c_name#8122,cval_customer_c_address#8123,cval_customer_c_phone#8124,cval_customer_c_acctbal#8125,cval_customer_c_comment#8126,cval_customer_c_mktsegment#8127,cdepval_customer_c_name#8128,cdepval_customer_c_address#8129,cdepval_customer_c_phone#8130,cdepval_customer_c_acctbal#8131,cdepval_customer_c_comment#8132,cdepval_customer_c_mktsegment#8133,cc_name#8134,cc_address#8135,cc_phone#8136,cc_acctbal#8137,cc_comment#8138,cc_mktsegment#8139] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4429ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/25 23:27:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:27:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8210L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 23:27:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8210L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#8212 AS rid_0#8236, cpfk_customer_orders#8213 AS cpfk_customer_orders_0#8237, cfpk_orders_customer#8214 AS cfpk_orders_customer_0#8238, cval_orders_o_orderstatus#8215 AS cval_orders_o_orderstatus_0#8239, cval_orders_o_totalprice#8216 AS cval_orders_o_totalprice_0#8240, cval_orders_o_orderpriority#8217 AS cval_orders_o_orderpriority_0#8241, cval_orders_o_clerk#8218 AS cval_orders_o_clerk_0#8242, cval_orders_o_shippriority#8219 AS cval_orders_o_shippriority_0#8243, cval_orders_o_comment#8220 AS cval_orders_o_comment_0#8244, cval_orders_o_orderdate#8221 AS cval_orders_o_orderdate_0#8245, cdepval_orders_o_orderstatus#8222 AS cdepval_orders_o_orderstatus_0#8246, cdepval_orders_o_totalprice#8223 AS cdepval_orders_o_totalprice_0#8247, cdepval_orders_o_orderpriority#8224 AS cdepval_orders_o_orderpriority_0#8248, cdepval_orders_o_clerk#8225 AS cdepval_orders_o_clerk_0#8249, cdepval_orders_o_shippriority#8226 AS cdepval_orders_o_shippriority_0#8250, cdepval_orders_o_comment#8227 AS cdepval_orders_o_comment_0#8251, cdepval_orders_o_orderdate#8228 AS cdepval_orders_o_orderdate_0#8252, co_orderstatus#8229 AS co_orderstatus_0#8253, co_totalprice#8230 AS co_totalprice_0#8254, co_orderpriority#8231 AS co_orderpriority_0#8255, co_clerk#8232 AS co_clerk_0#8256, co_shippriority#8233 AS co_shippriority_0#8257, co_comment#8234 AS co_comment_0#8258, co_orderdate#8235 AS co_orderdate_0#8259]
         :  +- Relation[rid#8212,cpfk_customer_orders#8213,cfpk_orders_customer#8214,cval_orders_o_orderstatus#8215,cval_orders_o_totalprice#8216,cval_orders_o_orderpriority#8217,cval_orders_o_clerk#8218,cval_orders_o_shippriority#8219,cval_orders_o_comment#8220,cval_orders_o_orderdate#8221,cdepval_orders_o_orderstatus#8222,cdepval_orders_o_totalprice#8223,cdepval_orders_o_orderpriority#8224,cdepval_orders_o_clerk#8225,cdepval_orders_o_shippriority#8226,cdepval_orders_o_comment#8227,cdepval_orders_o_orderdate#8228,co_orderstatus#8229,co_totalprice#8230,co_orderpriority#8231,co_clerk#8232,co_shippriority#8233,co_comment#8234,co_orderdate#8235] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#8260 AS rid_1#8281, cpfk_nation_customer#8261 AS cpfk_nation_customer_1#8282, cfpk_customer_nation#8262 AS cfpk_customer_nation_1#8283, cval_customer_c_name#8263 AS cval_customer_c_name_1#8284, cval_customer_c_address#8264 AS cval_customer_c_address_1#8285, cval_customer_c_phone#8265 AS cval_customer_c_phone_1#8286, cval_customer_c_acctbal#8266 AS cval_customer_c_acctbal_1#8287, cval_customer_c_comment#8267 AS cval_customer_c_comment_1#8288, cval_customer_c_mktsegment#8268 AS cval_customer_c_mktsegment_1#8289, cdepval_customer_c_name#8269 AS cdepval_customer_c_name_1#8290, cdepval_customer_c_address#8270 AS cdepval_customer_c_address_1#8291, cdepval_customer_c_phone#8271 AS cdepval_customer_c_phone_1#8292, cdepval_customer_c_acctbal#8272 AS cdepval_customer_c_acctbal_1#8293, cdepval_customer_c_comment#8273 AS cdepval_customer_c_comment_1#8294, cdepval_customer_c_mktsegment#8274 AS cdepval_customer_c_mktsegment_1#8295, cc_name#8275 AS cc_name_1#8296, cc_address#8276 AS cc_address_1#8297, cc_phone#8277 AS cc_phone_1#8298, cc_acctbal#8278 AS cc_acctbal_1#8299, cc_comment#8279 AS cc_comment_1#8300, cc_mktsegment#8280 AS cc_mktsegment_1#8301]
            +- Relation[rid#8260,cpfk_nation_customer#8261,cfpk_customer_nation#8262,cval_customer_c_name#8263,cval_customer_c_address#8264,cval_customer_c_phone#8265,cval_customer_c_acctbal#8266,cval_customer_c_comment#8267,cval_customer_c_mktsegment#8268,cdepval_customer_c_name#8269,cdepval_customer_c_address#8270,cdepval_customer_c_phone#8271,cdepval_customer_c_acctbal#8272,cdepval_customer_c_comment#8273,cdepval_customer_c_mktsegment#8274,cc_name#8275,cc_address#8276,cc_phone#8277,cc_acctbal#8278,cc_comment#8279,cc_mktsegment#8280] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4446ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/25 23:27:30 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:27:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8353L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 23:27:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:27:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:27:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:27:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:27:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:27:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:27:30 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:27:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:27:30 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:27:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8353L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#8427 AS rid_2#8441, cpfk_part_partsupp#8428 AS cpfk_part_partsupp_2#8442, cfpk_partsupp_part#8429 AS cfpk_partsupp_part_2#8443, cpfk_supplier_partsupp#8430 AS cpfk_supplier_partsupp_2#8444, cfpk_partsupp_supplier#8431 AS cfpk_partsupp_supplier_2#8445, cval_partsupp_ps_availqty#8432 AS cval_partsupp_ps_availqty_2#8446, cval_partsupp_ps_supplycost#8433 AS cval_partsupp_ps_supplycost_2#8447, cval_partsupp_ps_comment#8434 AS cval_partsupp_ps_comment_2#8448, cdepval_partsupp_ps_availqty#8435 AS cdepval_partsupp_ps_availqty_2#8449, cdepval_partsupp_ps_supplycost#8436 AS cdepval_partsupp_ps_supplycost_2#8450, cdepval_partsupp_ps_comment#8437 AS cdepval_partsupp_ps_comment_2#8451, cps_availqty#8438 AS cps_availqty_2#8452, cps_supplycost#8439 AS cps_supplycost_2#8453, cps_comment#8440 AS cps_comment_2#8454]
         :  +- Relation[rid#8427,cpfk_part_partsupp#8428,cfpk_partsupp_part#8429,cpfk_supplier_partsupp#8430,cfpk_partsupp_supplier#8431,cval_partsupp_ps_availqty#8432,cval_partsupp_ps_supplycost#8433,cval_partsupp_ps_comment#8434,cdepval_partsupp_ps_availqty#8435,cdepval_partsupp_ps_supplycost#8436,cdepval_partsupp_ps_comment#8437,cps_availqty#8438,cps_supplycost#8439,cps_comment#8440] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
            :- Project [rid#8391 AS rid_1#8409, cpfk_nation_supplier#8392 AS cpfk_nation_supplier_1#8410, cfpk_supplier_nation#8393 AS cfpk_supplier_nation_1#8411, cval_supplier_s_name#8394 AS cval_supplier_s_name_1#8412, cval_supplier_s_address#8395 AS cval_supplier_s_address_1#8413, cval_supplier_s_phone#8396 AS cval_supplier_s_phone_1#8414, cval_supplier_s_acctbal#8397 AS cval_supplier_s_acctbal_1#8415, cval_supplier_s_comment#8398 AS cval_supplier_s_comment_1#8416, cdepval_supplier_s_name#8399 AS cdepval_supplier_s_name_1#8417, cdepval_supplier_s_address#8400 AS cdepval_supplier_s_address_1#8418, cdepval_supplier_s_phone#8401 AS cdepval_supplier_s_phone_1#8419, cdepval_supplier_s_acctbal#8402 AS cdepval_supplier_s_acctbal_1#8420, cdepval_supplier_s_comment#8403 AS cdepval_supplier_s_comment_1#8421, cs_name#8404 AS cs_name_1#8422, cs_address#8405 AS cs_address_1#8423, cs_phone#8406 AS cs_phone_1#8424, cs_acctbal#8407 AS cs_acctbal_1#8425, cs_comment#8408 AS cs_comment_1#8426]
            :  +- Relation[rid#8391,cpfk_nation_supplier#8392,cfpk_supplier_nation#8393,cval_supplier_s_name#8394,cval_supplier_s_address#8395,cval_supplier_s_phone#8396,cval_supplier_s_acctbal#8397,cval_supplier_s_comment#8398,cdepval_supplier_s_name#8399,cdepval_supplier_s_address#8400,cdepval_supplier_s_phone#8401,cdepval_supplier_s_acctbal#8402,cdepval_supplier_s_comment#8403,cs_name#8404,cs_address#8405,cs_phone#8406,cs_acctbal#8407,cs_comment#8408] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
               +- Project [rid#8355 AS rid_0#8364, cpfk_region_nation#8356 AS cpfk_region_nation_0#8365, cfpk_nation_region#8357 AS cfpk_nation_region_0#8366, cval_nation_n_name#8358 AS cval_nation_n_name_0#8367, cval_nation_n_comment#8359 AS cval_nation_n_comment_0#8368, cdepval_nation_n_name#8360 AS cdepval_nation_n_name_0#8369, cdepval_nation_n_comment#8361 AS cdepval_nation_n_comment_0#8370, cn_name#8362 AS cn_name_0#8371, cn_comment#8363 AS cn_comment_0#8372]
                  +- Relation[rid#8355,cpfk_region_nation#8356,cfpk_nation_region#8357,cval_nation_n_name#8358,cval_nation_n_comment#8359,cdepval_nation_n_name#8360,cdepval_nation_n_comment#8361,cn_name#8362,cn_comment#8363] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 3688ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/25 23:27:34 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:27:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8501L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:27:34 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:27:34 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:27:34 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:27:34 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:27:34 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:27:34 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:27:34 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:27:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8501L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#8528, cval_part_p_name_0#8529, cval_part_p_mfgr_0#8530, cval_part_p_type_0#8531, cval_part_p_size_0#8532, cval_part_p_container_0#8533, cval_part_p_retailprice_0#8534, cval_part_p_comment_0#8535, cval_part_p_brand_0#8536, cdepval_part_p_name_0#8537, cdepval_part_p_mfgr_0#8538, cdepval_part_p_type_0#8539, cdepval_part_p_size_0#8540, cdepval_part_p_container_0#8541, cdepval_part_p_retailprice_0#8542, cdepval_part_p_comment_0#8543, cdepval_part_p_brand_0#8544, cp_name_0#8545, cp_mfgr_0#8546, cp_type_0#8547, cp_size_0#8548, cp_container_0#8549, cp_retailprice_0#8550, cp_comment_0#8551, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#8503 AS rid_0#8528, cval_part_p_name#8504 AS cval_part_p_name_0#8529, cval_part_p_mfgr#8505 AS cval_part_p_mfgr_0#8530, cval_part_p_type#8506 AS cval_part_p_type_0#8531, cval_part_p_size#8507 AS cval_part_p_size_0#8532, cval_part_p_container#8508 AS cval_part_p_container_0#8533, cval_part_p_retailprice#8509 AS cval_part_p_retailprice_0#8534, cval_part_p_comment#8510 AS cval_part_p_comment_0#8535, cval_part_p_brand#8511 AS cval_part_p_brand_0#8536, cdepval_part_p_name#8512 AS cdepval_part_p_name_0#8537, cdepval_part_p_mfgr#8513 AS cdepval_part_p_mfgr_0#8538, cdepval_part_p_type#8514 AS cdepval_part_p_type_0#8539, cdepval_part_p_size#8515 AS cdepval_part_p_size_0#8540, cdepval_part_p_container#8516 AS cdepval_part_p_container_0#8541, cdepval_part_p_retailprice#8517 AS cdepval_part_p_retailprice_0#8542, cdepval_part_p_comment#8518 AS cdepval_part_p_comment_0#8543, cdepval_part_p_brand#8519 AS cdepval_part_p_brand_0#8544, cp_name#8520 AS cp_name_0#8545, cp_mfgr#8521 AS cp_mfgr_0#8546, cp_type#8522 AS cp_type_0#8547, cp_size#8523 AS cp_size_0#8548, cp_container#8524 AS cp_container_0#8549, cp_retailprice#8525 AS cp_retailprice_0#8550, cp_comment#8526 AS cp_comment_0#8551, cp_brand#8527 AS cp_brand_0#8552]
         :  :        +- Relation[rid#8503,cval_part_p_name#8504,cval_part_p_mfgr#8505,cval_part_p_type#8506,cval_part_p_size#8507,cval_part_p_container#8508,cval_part_p_retailprice#8509,cval_part_p_comment#8510,cval_part_p_brand#8511,cdepval_part_p_name#8512,cdepval_part_p_mfgr#8513,cdepval_part_p_type#8514,cdepval_part_p_size#8515,cdepval_part_p_container#8516,cdepval_part_p_retailprice#8517,cdepval_part_p_comment#8518,cdepval_part_p_brand#8519,cp_name#8520,cp_mfgr#8521,cp_type#8522,cp_size#8523,cp_container#8524,cp_retailprice#8525,cp_comment#8526,cp_brand#8527] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#8973 AS rid_1#9018, cpfk_orders_lineitem#8974 AS cpfk_orders_lineitem_1#9019, cpfk_supplier_lineitem#8975 AS cpfk_supplier_lineitem_1#9020, cfpk_lineitem_supplier#8976 AS cfpk_lineitem_supplier_1#9021, cfpk_lineitem_partsupp#8977 AS cfpk_lineitem_partsupp_1#9022, cpfk_part_lineitem#8978 AS cpfk_part_lineitem_1#9023, cfpk_lineitem_part#8979 AS cfpk_lineitem_part_1#9024, cpfk_partsupp_lineitem#8980 AS cpfk_partsupp_lineitem_1#9025, cfpk_lineitem_orders#8981 AS cfpk_lineitem_orders_1#9026, cval_lineitem_l_quantity#8982 AS cval_lineitem_l_quantity_1#9027, cval_lineitem_l_extendedprice#8983 AS cval_lineitem_l_extendedprice_1#9028, cval_lineitem_l_discount#8984 AS cval_lineitem_l_discount_1#9029, cval_lineitem_l_tax#8985 AS cval_lineitem_l_tax_1#9030, cval_lineitem_l_returnflag#8986 AS cval_lineitem_l_returnflag_1#9031, cval_lineitem_l_linestatus#8987 AS cval_lineitem_l_linestatus_1#9032, cval_lineitem_l_commitdate#8988 AS cval_lineitem_l_commitdate_1#9033, cval_lineitem_l_receiptdate#8989 AS cval_lineitem_l_receiptdate_1#9034, cval_lineitem_l_shipinstruct#8990 AS cval_lineitem_l_shipinstruct_1#9035, cval_lineitem_l_shipmode#8991 AS cval_lineitem_l_shipmode_1#9036, cval_lineitem_l_comment#8992 AS cval_lineitem_l_comment_1#9037, cval_lineitem_l_shipdate#8993 AS cval_lineitem_l_shipdate_1#9038, cdepval_lineitem_l_quantity#8994 AS cdepval_lineitem_l_quantity_1#9039, cdepval_lineitem_l_extendedprice#8995 AS cdepval_lineitem_l_extendedprice_1#9040, cdepval_lineitem_l_discount#8996 AS cdepval_lineitem_l_discount_1#9041, ... 21 more fields]
         :        +- Relation[rid#8973,cpfk_orders_lineitem#8974,cpfk_supplier_lineitem#8975,cfpk_lineitem_supplier#8976,cfpk_lineitem_partsupp#8977,cpfk_part_lineitem#8978,cfpk_lineitem_part#8979,cpfk_partsupp_lineitem#8980,cfpk_lineitem_orders#8981,cval_lineitem_l_quantity#8982,cval_lineitem_l_extendedprice#8983,cval_lineitem_l_discount#8984,cval_lineitem_l_tax#8985,cval_lineitem_l_returnflag#8986,cval_lineitem_l_linestatus#8987,cval_lineitem_l_commitdate#8988,cval_lineitem_l_receiptdate#8989,cval_lineitem_l_shipinstruct#8990,cval_lineitem_l_shipmode#8991,cval_lineitem_l_comment#8992,cval_lineitem_l_shipdate#8993,cdepval_lineitem_l_quantity#8994,cdepval_lineitem_l_extendedprice#8995,cdepval_lineitem_l_discount#8996,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#8653 AS rid_1#8698, cpfk_orders_lineitem#8654 AS cpfk_orders_lineitem_1#8699, cpfk_supplier_lineitem#8655 AS cpfk_supplier_lineitem_1#8700, cfpk_lineitem_supplier#8656 AS cfpk_lineitem_supplier_1#8701, cfpk_lineitem_partsupp#8657 AS cfpk_lineitem_partsupp_1#8702, cpfk_part_lineitem#8658 AS cpfk_part_lineitem_1#8703, cfpk_lineitem_part#8659 AS cfpk_lineitem_part_1#8704, cpfk_partsupp_lineitem#8660 AS cpfk_partsupp_lineitem_1#8705, cfpk_lineitem_orders#8661 AS cfpk_lineitem_orders_1#8706, cval_lineitem_l_quantity#8662 AS cval_lineitem_l_quantity_1#8707, cval_lineitem_l_extendedprice#8663 AS cval_lineitem_l_extendedprice_1#8708, cval_lineitem_l_discount#8664 AS cval_lineitem_l_discount_1#8709, cval_lineitem_l_tax#8665 AS cval_lineitem_l_tax_1#8710, cval_lineitem_l_returnflag#8666 AS cval_lineitem_l_returnflag_1#8711, cval_lineitem_l_linestatus#8667 AS cval_lineitem_l_linestatus_1#8712, cval_lineitem_l_commitdate#8668 AS cval_lineitem_l_commitdate_1#8713, cval_lineitem_l_receiptdate#8669 AS cval_lineitem_l_receiptdate_1#8714, cval_lineitem_l_shipinstruct#8670 AS cval_lineitem_l_shipinstruct_1#8715, cval_lineitem_l_shipmode#8671 AS cval_lineitem_l_shipmode_1#8716, cval_lineitem_l_comment#8672 AS cval_lineitem_l_comment_1#8717, cval_lineitem_l_shipdate#8673 AS cval_lineitem_l_shipdate_1#8718, cdepval_lineitem_l_quantity#8674 AS cdepval_lineitem_l_quantity_1#8719, cdepval_lineitem_l_extendedprice#8675 AS cdepval_lineitem_l_extendedprice_1#8720, cdepval_lineitem_l_discount#8676 AS cdepval_lineitem_l_discount_1#8721, ... 21 more fields]
                  +- Relation[rid#8653,cpfk_orders_lineitem#8654,cpfk_supplier_lineitem#8655,cfpk_lineitem_supplier#8656,cfpk_lineitem_partsupp#8657,cpfk_part_lineitem#8658,cfpk_lineitem_part#8659,cpfk_partsupp_lineitem#8660,cfpk_lineitem_orders#8661,cval_lineitem_l_quantity#8662,cval_lineitem_l_extendedprice#8663,cval_lineitem_l_discount#8664,cval_lineitem_l_tax#8665,cval_lineitem_l_returnflag#8666,cval_lineitem_l_linestatus#8667,cval_lineitem_l_commitdate#8668,cval_lineitem_l_receiptdate#8669,cval_lineitem_l_shipinstruct#8670,cval_lineitem_l_shipmode#8671,cval_lineitem_l_comment#8672,cval_lineitem_l_shipdate#8673,cdepval_lineitem_l_quantity#8674,cdepval_lineitem_l_extendedprice#8675,cdepval_lineitem_l_discount#8676,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 16821ms
query=q1, count=6001215, duration=2460
query=q10, count=1478870, duration=60311
query=q11, count=31680, duration=3688
query=q12, count=857401, duration=22426
query=q13, count=1500000, duration=4446
query=q14, count=6001215, duration=18002
query=q15, count=6001215, duration=17211
query=q16, count=15780, duration=3360
query=q17, count=6088, duration=26208
query=q18, count=6001215, duration=22000
query=q19, count=205, duration=16821
query=q2, count=3162, duration=4066
query=q20, count=632, duration=3552
query=q21a, count=597422, duration=75690
query=q22, count=1500000, duration=4429
query=q3, count=1214743, duration=39519
query=q4, count=6001215, duration=18624
query=q5, count=48089, duration=30617
query=q6, count=6001215, duration=2342
query=q7, count=9735, duration=34957
query=q8, count=8716, duration=44728
query=q9a, count=6001215, duration=63921
query=q9b, count=6001215, duration=38000
