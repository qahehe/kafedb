20/04/25 22:11:32 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10806ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 25 22:11:35 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 25 22:11:36 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 25 22:11:37 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 25 22:11:37 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 25 22:11:37 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 25 22:11:41 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 25 22:11:44 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 25 22:11:44 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/25 22:11:46 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:11:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2080L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:11:46 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/25 22:11:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2080L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#2132 AS rid_1#2177, cpfk_orders_lineitem#2133 AS cpfk_orders_lineitem_1#2178, cpfk_supplier_lineitem#2134 AS cpfk_supplier_lineitem_1#2179, cfpk_lineitem_supplier#2135 AS cfpk_lineitem_supplier_1#2180, cfpk_lineitem_partsupp#2136 AS cfpk_lineitem_partsupp_1#2181, cpfk_part_lineitem#2137 AS cpfk_part_lineitem_1#2182, cfpk_lineitem_part#2138 AS cfpk_lineitem_part_1#2183, cpfk_partsupp_lineitem#2139 AS cpfk_partsupp_lineitem_1#2184, cfpk_lineitem_orders#2140 AS cfpk_lineitem_orders_1#2185, cval_lineitem_l_quantity#2141 AS cval_lineitem_l_quantity_1#2186, cval_lineitem_l_extendedprice#2142 AS cval_lineitem_l_extendedprice_1#2187, cval_lineitem_l_discount#2143 AS cval_lineitem_l_discount_1#2188, cval_lineitem_l_tax#2144 AS cval_lineitem_l_tax_1#2189, cval_lineitem_l_returnflag#2145 AS cval_lineitem_l_returnflag_1#2190, cval_lineitem_l_linestatus#2146 AS cval_lineitem_l_linestatus_1#2191, cval_lineitem_l_commitdate#2147 AS cval_lineitem_l_commitdate_1#2192, cval_lineitem_l_receiptdate#2148 AS cval_lineitem_l_receiptdate_1#2193, cval_lineitem_l_shipinstruct#2149 AS cval_lineitem_l_shipinstruct_1#2194, cval_lineitem_l_shipmode#2150 AS cval_lineitem_l_shipmode_1#2195, cval_lineitem_l_comment#2151 AS cval_lineitem_l_comment_1#2196, cval_lineitem_l_shipdate#2152 AS cval_lineitem_l_shipdate_1#2197, cdepval_lineitem_l_quantity#2153 AS cdepval_lineitem_l_quantity_1#2198, cdepval_lineitem_l_extendedprice#2154 AS cdepval_lineitem_l_extendedprice_1#2199, cdepval_lineitem_l_discount#2155 AS cdepval_lineitem_l_discount_1#2200, ... 21 more fields]
         :  +- Relation[rid#2132,cpfk_orders_lineitem#2133,cpfk_supplier_lineitem#2134,cfpk_lineitem_supplier#2135,cfpk_lineitem_partsupp#2136,cpfk_part_lineitem#2137,cfpk_lineitem_part#2138,cpfk_partsupp_lineitem#2139,cfpk_lineitem_orders#2140,cval_lineitem_l_quantity#2141,cval_lineitem_l_extendedprice#2142,cval_lineitem_l_discount#2143,cval_lineitem_l_tax#2144,cval_lineitem_l_returnflag#2145,cval_lineitem_l_linestatus#2146,cval_lineitem_l_commitdate#2147,cval_lineitem_l_receiptdate#2148,cval_lineitem_l_shipinstruct#2149,cval_lineitem_l_shipmode#2150,cval_lineitem_l_comment#2151,cval_lineitem_l_shipdate#2152,cdepval_lineitem_l_quantity#2153,cdepval_lineitem_l_extendedprice#2154,cdepval_lineitem_l_discount#2155,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2082 AS rid_0#2107, cval_part_p_name#2083 AS cval_part_p_name_0#2108, cval_part_p_mfgr#2084 AS cval_part_p_mfgr_0#2109, cval_part_p_type#2085 AS cval_part_p_type_0#2110, cval_part_p_size#2086 AS cval_part_p_size_0#2111, cval_part_p_container#2087 AS cval_part_p_container_0#2112, cval_part_p_retailprice#2088 AS cval_part_p_retailprice_0#2113, cval_part_p_comment#2089 AS cval_part_p_comment_0#2114, cval_part_p_brand#2090 AS cval_part_p_brand_0#2115, cdepval_part_p_name#2091 AS cdepval_part_p_name_0#2116, cdepval_part_p_mfgr#2092 AS cdepval_part_p_mfgr_0#2117, cdepval_part_p_type#2093 AS cdepval_part_p_type_0#2118, cdepval_part_p_size#2094 AS cdepval_part_p_size_0#2119, cdepval_part_p_container#2095 AS cdepval_part_p_container_0#2120, cdepval_part_p_retailprice#2096 AS cdepval_part_p_retailprice_0#2121, cdepval_part_p_comment#2097 AS cdepval_part_p_comment_0#2122, cdepval_part_p_brand#2098 AS cdepval_part_p_brand_0#2123, cp_name#2099 AS cp_name_0#2124, cp_mfgr#2100 AS cp_mfgr_0#2125, cp_type#2101 AS cp_type_0#2126, cp_size#2102 AS cp_size_0#2127, cp_container#2103 AS cp_container_0#2128, cp_retailprice#2104 AS cp_retailprice_0#2129, cp_comment#2105 AS cp_comment_0#2130, cp_brand#2106 AS cp_brand_0#2131]
            +- Relation[rid#2082,cval_part_p_name#2083,cval_part_p_mfgr#2084,cval_part_p_type#2085,cval_part_p_size#2086,cval_part_p_container#2087,cval_part_p_retailprice#2088,cval_part_p_comment#2089,cval_part_p_brand#2090,cdepval_part_p_name#2091,cdepval_part_p_mfgr#2092,cdepval_part_p_type#2093,cdepval_part_p_size#2094,cdepval_part_p_container#2095,cdepval_part_p_retailprice#2096,cdepval_part_p_comment#2097,cdepval_part_p_brand#2098,cp_name#2099,cp_mfgr#2100,cp_type#2101,cp_size#2102,cp_container#2103,cp_retailprice#2104,cp_comment#2105,cp_brand#2106] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18280ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/25 22:12:04 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:12:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2298L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 22:12:04 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:12:04 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:12:04 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:12:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:12:04 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:12:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:12:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:12:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:12:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:12:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:12:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:12:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2298L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#2436 AS rid_4#2481, cpfk_orders_lineitem#2437 AS cpfk_orders_lineitem_4#2482, cpfk_supplier_lineitem#2438 AS cpfk_supplier_lineitem_4#2483, cfpk_lineitem_supplier#2439 AS cfpk_lineitem_supplier_4#2484, cfpk_lineitem_partsupp#2440 AS cfpk_lineitem_partsupp_4#2485, cpfk_part_lineitem#2441 AS cpfk_part_lineitem_4#2486, cfpk_lineitem_part#2442 AS cfpk_lineitem_part_4#2487, cpfk_partsupp_lineitem#2443 AS cpfk_partsupp_lineitem_4#2488, cfpk_lineitem_orders#2444 AS cfpk_lineitem_orders_4#2489, cval_lineitem_l_quantity#2445 AS cval_lineitem_l_quantity_4#2490, cval_lineitem_l_extendedprice#2446 AS cval_lineitem_l_extendedprice_4#2491, cval_lineitem_l_discount#2447 AS cval_lineitem_l_discount_4#2492, cval_lineitem_l_tax#2448 AS cval_lineitem_l_tax_4#2493, cval_lineitem_l_returnflag#2449 AS cval_lineitem_l_returnflag_4#2494, cval_lineitem_l_linestatus#2450 AS cval_lineitem_l_linestatus_4#2495, cval_lineitem_l_commitdate#2451 AS cval_lineitem_l_commitdate_4#2496, cval_lineitem_l_receiptdate#2452 AS cval_lineitem_l_receiptdate_4#2497, cval_lineitem_l_shipinstruct#2453 AS cval_lineitem_l_shipinstruct_4#2498, cval_lineitem_l_shipmode#2454 AS cval_lineitem_l_shipmode_4#2499, cval_lineitem_l_comment#2455 AS cval_lineitem_l_comment_4#2500, cval_lineitem_l_shipdate#2456 AS cval_lineitem_l_shipdate_4#2501, cdepval_lineitem_l_quantity#2457 AS cdepval_lineitem_l_quantity_4#2502, cdepval_lineitem_l_extendedprice#2458 AS cdepval_lineitem_l_extendedprice_4#2503, cdepval_lineitem_l_discount#2459 AS cdepval_lineitem_l_discount_4#2504, ... 21 more fields]
            :  :  +- Relation[rid#2436,cpfk_orders_lineitem#2437,cpfk_supplier_lineitem#2438,cfpk_lineitem_supplier#2439,cfpk_lineitem_partsupp#2440,cpfk_part_lineitem#2441,cfpk_lineitem_part#2442,cpfk_partsupp_lineitem#2443,cfpk_lineitem_orders#2444,cval_lineitem_l_quantity#2445,cval_lineitem_l_extendedprice#2446,cval_lineitem_l_discount#2447,cval_lineitem_l_tax#2448,cval_lineitem_l_returnflag#2449,cval_lineitem_l_linestatus#2450,cval_lineitem_l_commitdate#2451,cval_lineitem_l_receiptdate#2452,cval_lineitem_l_shipinstruct#2453,cval_lineitem_l_shipmode#2454,cval_lineitem_l_comment#2455,cval_lineitem_l_shipdate#2456,cdepval_lineitem_l_quantity#2457,cdepval_lineitem_l_extendedprice#2458,cdepval_lineitem_l_discount#2459,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#2388 AS rid_3#2412, cpfk_customer_orders#2389 AS cpfk_customer_orders_3#2413, cfpk_orders_customer#2390 AS cfpk_orders_customer_3#2414, cval_orders_o_orderstatus#2391 AS cval_orders_o_orderstatus_3#2415, cval_orders_o_totalprice#2392 AS cval_orders_o_totalprice_3#2416, cval_orders_o_orderpriority#2393 AS cval_orders_o_orderpriority_3#2417, cval_orders_o_clerk#2394 AS cval_orders_o_clerk_3#2418, cval_orders_o_shippriority#2395 AS cval_orders_o_shippriority_3#2419, cval_orders_o_comment#2396 AS cval_orders_o_comment_3#2420, cval_orders_o_orderdate#2397 AS cval_orders_o_orderdate_3#2421, cdepval_orders_o_orderstatus#2398 AS cdepval_orders_o_orderstatus_3#2422, cdepval_orders_o_totalprice#2399 AS cdepval_orders_o_totalprice_3#2423, cdepval_orders_o_orderpriority#2400 AS cdepval_orders_o_orderpriority_3#2424, cdepval_orders_o_clerk#2401 AS cdepval_orders_o_clerk_3#2425, cdepval_orders_o_shippriority#2402 AS cdepval_orders_o_shippriority_3#2426, cdepval_orders_o_comment#2403 AS cdepval_orders_o_comment_3#2427, cdepval_orders_o_orderdate#2404 AS cdepval_orders_o_orderdate_3#2428, co_orderstatus#2405 AS co_orderstatus_3#2429, co_totalprice#2406 AS co_totalprice_3#2430, co_orderpriority#2407 AS co_orderpriority_3#2431, co_clerk#2408 AS co_clerk_3#2432, co_shippriority#2409 AS co_shippriority_3#2433, co_comment#2410 AS co_comment_3#2434, co_orderdate#2411 AS co_orderdate_3#2435]
            :     :  +- Relation[rid#2388,cpfk_customer_orders#2389,cfpk_orders_customer#2390,cval_orders_o_orderstatus#2391,cval_orders_o_totalprice#2392,cval_orders_o_orderpriority#2393,cval_orders_o_clerk#2394,cval_orders_o_shippriority#2395,cval_orders_o_comment#2396,cval_orders_o_orderdate#2397,cdepval_orders_o_orderstatus#2398,cdepval_orders_o_totalprice#2399,cdepval_orders_o_orderpriority#2400,cdepval_orders_o_clerk#2401,cdepval_orders_o_shippriority#2402,cdepval_orders_o_comment#2403,cdepval_orders_o_orderdate#2404,co_orderstatus#2405,co_totalprice#2406,co_orderpriority#2407,co_clerk#2408,co_shippriority#2409,co_comment#2410,co_orderdate#2411] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#2346 AS rid_2#2367, cpfk_nation_customer#2347 AS cpfk_nation_customer_2#2368, cfpk_customer_nation#2348 AS cfpk_customer_nation_2#2369, cval_customer_c_name#2349 AS cval_customer_c_name_2#2370, cval_customer_c_address#2350 AS cval_customer_c_address_2#2371, cval_customer_c_phone#2351 AS cval_customer_c_phone_2#2372, cval_customer_c_acctbal#2352 AS cval_customer_c_acctbal_2#2373, cval_customer_c_comment#2353 AS cval_customer_c_comment_2#2374, cval_customer_c_mktsegment#2354 AS cval_customer_c_mktsegment_2#2375, cdepval_customer_c_name#2355 AS cdepval_customer_c_name_2#2376, cdepval_customer_c_address#2356 AS cdepval_customer_c_address_2#2377, cdepval_customer_c_phone#2357 AS cdepval_customer_c_phone_2#2378, cdepval_customer_c_acctbal#2358 AS cdepval_customer_c_acctbal_2#2379, cdepval_customer_c_comment#2359 AS cdepval_customer_c_comment_2#2380, cdepval_customer_c_mktsegment#2360 AS cdepval_customer_c_mktsegment_2#2381, cc_name#2361 AS cc_name_2#2382, cc_address#2362 AS cc_address_2#2383, cc_phone#2363 AS cc_phone_2#2384, cc_acctbal#2364 AS cc_acctbal_2#2385, cc_comment#2365 AS cc_comment_2#2386, cc_mktsegment#2366 AS cc_mktsegment_2#2387]
            :        :  +- Relation[rid#2346,cpfk_nation_customer#2347,cfpk_customer_nation#2348,cval_customer_c_name#2349,cval_customer_c_address#2350,cval_customer_c_phone#2351,cval_customer_c_acctbal#2352,cval_customer_c_comment#2353,cval_customer_c_mktsegment#2354,cdepval_customer_c_name#2355,cdepval_customer_c_address#2356,cdepval_customer_c_phone#2357,cdepval_customer_c_acctbal#2358,cdepval_customer_c_comment#2359,cdepval_customer_c_mktsegment#2360,cc_name#2361,cc_address#2362,cc_phone#2363,cc_acctbal#2364,cc_comment#2365,cc_mktsegment#2366] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
            :           :- Project [rid#2328 AS rid_1#2337, cpfk_region_nation#2329 AS cpfk_region_nation_1#2338, cfpk_nation_region#2330 AS cfpk_nation_region_1#2339, cval_nation_n_name#2331 AS cval_nation_n_name_1#2340, cval_nation_n_comment#2332 AS cval_nation_n_comment_1#2341, cdepval_nation_n_name#2333 AS cdepval_nation_n_name_1#2342, cdepval_nation_n_comment#2334 AS cdepval_nation_n_comment_1#2343, cn_name#2335 AS cn_name_1#2344, cn_comment#2336 AS cn_comment_1#2345]
            :           :  +- Relation[rid#2328,cpfk_region_nation#2329,cfpk_nation_region#2330,cval_nation_n_name#2331,cval_nation_n_comment#2332,cdepval_nation_n_name#2333,cdepval_nation_n_comment#2334,cn_name#2335,cn_comment#2336] JDBCRelation(tnation) [numPartitions=1]
            :           +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :              +- Project [rid#2300 AS rid_0#2307, cval_region_r_name#2301 AS cval_region_r_name_0#2308, cval_region_r_comment#2302 AS cval_region_r_comment_0#2309, cdepval_region_r_name#2303 AS cdepval_region_r_name_0#2310, cdepval_region_r_comment#2304 AS cdepval_region_r_comment_0#2311, cr_name#2305 AS cr_name_0#2312, cr_comment#2306 AS cr_comment_0#2313]
            :                 +- Relation[rid#2300,cval_region_r_name#2301,cval_region_r_comment#2302,cdepval_region_r_name#2303,cdepval_region_r_comment#2304,cr_name#2305,cr_comment#2306] JDBCRelation(tregion) [numPartitions=1]
            +- Project [rid#2526 AS rid_5#2544, cpfk_nation_supplier#2527 AS cpfk_nation_supplier_5#2545, cfpk_supplier_nation#2528 AS cfpk_supplier_nation_5#2546, cval_supplier_s_name#2529 AS cval_supplier_s_name_5#2547, cval_supplier_s_address#2530 AS cval_supplier_s_address_5#2548, cval_supplier_s_phone#2531 AS cval_supplier_s_phone_5#2549, cval_supplier_s_acctbal#2532 AS cval_supplier_s_acctbal_5#2550, cval_supplier_s_comment#2533 AS cval_supplier_s_comment_5#2551, cdepval_supplier_s_name#2534 AS cdepval_supplier_s_name_5#2552, cdepval_supplier_s_address#2535 AS cdepval_supplier_s_address_5#2553, cdepval_supplier_s_phone#2536 AS cdepval_supplier_s_phone_5#2554, cdepval_supplier_s_acctbal#2537 AS cdepval_supplier_s_acctbal_5#2555, cdepval_supplier_s_comment#2538 AS cdepval_supplier_s_comment_5#2556, cs_name#2539 AS cs_name_5#2557, cs_address#2540 AS cs_address_5#2558, cs_phone#2541 AS cs_phone_5#2559, cs_acctbal#2542 AS cs_acctbal_5#2560, cs_comment#2543 AS cs_comment_5#2561]
               +- Relation[rid#2526,cpfk_nation_supplier#2527,cfpk_supplier_nation#2528,cval_supplier_s_name#2529,cval_supplier_s_address#2530,cval_supplier_s_phone#2531,cval_supplier_s_acctbal#2532,cval_supplier_s_comment#2533,cdepval_supplier_s_name#2534,cdepval_supplier_s_address#2535,cdepval_supplier_s_phone#2536,cdepval_supplier_s_acctbal#2537,cdepval_supplier_s_comment#2538,cs_name#2539,cs_address#2540,cs_phone#2541,cs_acctbal#2542,cs_comment#2543] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 30716ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/25 22:12:35 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:12:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2694L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:12:35 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:12:35 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:12:35 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:12:35 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:12:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2694L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#2828 AS rid_2#2873, cpfk_orders_lineitem#2829 AS cpfk_orders_lineitem_2#2874, cpfk_supplier_lineitem#2830 AS cpfk_supplier_lineitem_2#2875, cfpk_lineitem_supplier#2831 AS cfpk_lineitem_supplier_2#2876, cfpk_lineitem_partsupp#2832 AS cfpk_lineitem_partsupp_2#2877, cpfk_part_lineitem#2833 AS cpfk_part_lineitem_2#2878, cfpk_lineitem_part#2834 AS cfpk_lineitem_part_2#2879, cpfk_partsupp_lineitem#2835 AS cpfk_partsupp_lineitem_2#2880, cfpk_lineitem_orders#2836 AS cfpk_lineitem_orders_2#2881, cval_lineitem_l_quantity#2837 AS cval_lineitem_l_quantity_2#2882, cval_lineitem_l_extendedprice#2838 AS cval_lineitem_l_extendedprice_2#2883, cval_lineitem_l_discount#2839 AS cval_lineitem_l_discount_2#2884, cval_lineitem_l_tax#2840 AS cval_lineitem_l_tax_2#2885, cval_lineitem_l_returnflag#2841 AS cval_lineitem_l_returnflag_2#2886, cval_lineitem_l_linestatus#2842 AS cval_lineitem_l_linestatus_2#2887, cval_lineitem_l_commitdate#2843 AS cval_lineitem_l_commitdate_2#2888, cval_lineitem_l_receiptdate#2844 AS cval_lineitem_l_receiptdate_2#2889, cval_lineitem_l_shipinstruct#2845 AS cval_lineitem_l_shipinstruct_2#2890, cval_lineitem_l_shipmode#2846 AS cval_lineitem_l_shipmode_2#2891, cval_lineitem_l_comment#2847 AS cval_lineitem_l_comment_2#2892, cval_lineitem_l_shipdate#2848 AS cval_lineitem_l_shipdate_2#2893, cdepval_lineitem_l_quantity#2849 AS cdepval_lineitem_l_quantity_2#2894, cdepval_lineitem_l_extendedprice#2850 AS cdepval_lineitem_l_extendedprice_2#2895, cdepval_lineitem_l_discount#2851 AS cdepval_lineitem_l_discount_2#2896, ... 21 more fields]
         :  +- Relation[rid#2828,cpfk_orders_lineitem#2829,cpfk_supplier_lineitem#2830,cfpk_lineitem_supplier#2831,cfpk_lineitem_partsupp#2832,cpfk_part_lineitem#2833,cfpk_lineitem_part#2834,cpfk_partsupp_lineitem#2835,cfpk_lineitem_orders#2836,cval_lineitem_l_quantity#2837,cval_lineitem_l_extendedprice#2838,cval_lineitem_l_discount#2839,cval_lineitem_l_tax#2840,cval_lineitem_l_returnflag#2841,cval_lineitem_l_linestatus#2842,cval_lineitem_l_commitdate#2843,cval_lineitem_l_receiptdate#2844,cval_lineitem_l_shipinstruct#2845,cval_lineitem_l_shipmode#2846,cval_lineitem_l_comment#2847,cval_lineitem_l_shipdate#2848,cdepval_lineitem_l_quantity#2849,cdepval_lineitem_l_extendedprice#2850,cdepval_lineitem_l_discount#2851,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#2780 AS rid_1#2804, cpfk_customer_orders#2781 AS cpfk_customer_orders_1#2805, cfpk_orders_customer#2782 AS cfpk_orders_customer_1#2806, cval_orders_o_orderstatus#2783 AS cval_orders_o_orderstatus_1#2807, cval_orders_o_totalprice#2784 AS cval_orders_o_totalprice_1#2808, cval_orders_o_orderpriority#2785 AS cval_orders_o_orderpriority_1#2809, cval_orders_o_clerk#2786 AS cval_orders_o_clerk_1#2810, cval_orders_o_shippriority#2787 AS cval_orders_o_shippriority_1#2811, cval_orders_o_comment#2788 AS cval_orders_o_comment_1#2812, cval_orders_o_orderdate#2789 AS cval_orders_o_orderdate_1#2813, cdepval_orders_o_orderstatus#2790 AS cdepval_orders_o_orderstatus_1#2814, cdepval_orders_o_totalprice#2791 AS cdepval_orders_o_totalprice_1#2815, cdepval_orders_o_orderpriority#2792 AS cdepval_orders_o_orderpriority_1#2816, cdepval_orders_o_clerk#2793 AS cdepval_orders_o_clerk_1#2817, cdepval_orders_o_shippriority#2794 AS cdepval_orders_o_shippriority_1#2818, cdepval_orders_o_comment#2795 AS cdepval_orders_o_comment_1#2819, cdepval_orders_o_orderdate#2796 AS cdepval_orders_o_orderdate_1#2820, co_orderstatus#2797 AS co_orderstatus_1#2821, co_totalprice#2798 AS co_totalprice_1#2822, co_orderpriority#2799 AS co_orderpriority_1#2823, co_clerk#2800 AS co_clerk_1#2824, co_shippriority#2801 AS co_shippriority_1#2825, co_comment#2802 AS co_comment_1#2826, co_orderdate#2803 AS co_orderdate_1#2827]
            :  +- Relation[rid#2780,cpfk_customer_orders#2781,cfpk_orders_customer#2782,cval_orders_o_orderstatus#2783,cval_orders_o_totalprice#2784,cval_orders_o_orderpriority#2785,cval_orders_o_clerk#2786,cval_orders_o_shippriority#2787,cval_orders_o_comment#2788,cval_orders_o_orderdate#2789,cdepval_orders_o_orderstatus#2790,cdepval_orders_o_totalprice#2791,cdepval_orders_o_orderpriority#2792,cdepval_orders_o_clerk#2793,cdepval_orders_o_shippriority#2794,cdepval_orders_o_comment#2795,cdepval_orders_o_orderdate#2796,co_orderstatus#2797,co_totalprice#2798,co_orderpriority#2799,co_clerk#2800,co_shippriority#2801,co_comment#2802,co_orderdate#2803] JDBCRelation(torders) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
               +- Project [rid#2696 AS rid_0#2717, cpfk_nation_customer#2697 AS cpfk_nation_customer_0#2718, cfpk_customer_nation#2698 AS cfpk_customer_nation_0#2719, cval_customer_c_name#2699 AS cval_customer_c_name_0#2720, cval_customer_c_address#2700 AS cval_customer_c_address_0#2721, cval_customer_c_phone#2701 AS cval_customer_c_phone_0#2722, cval_customer_c_acctbal#2702 AS cval_customer_c_acctbal_0#2723, cval_customer_c_comment#2703 AS cval_customer_c_comment_0#2724, cval_customer_c_mktsegment#2704 AS cval_customer_c_mktsegment_0#2725, cdepval_customer_c_name#2705 AS cdepval_customer_c_name_0#2726, cdepval_customer_c_address#2706 AS cdepval_customer_c_address_0#2727, cdepval_customer_c_phone#2707 AS cdepval_customer_c_phone_0#2728, cdepval_customer_c_acctbal#2708 AS cdepval_customer_c_acctbal_0#2729, cdepval_customer_c_comment#2709 AS cdepval_customer_c_comment_0#2730, cdepval_customer_c_mktsegment#2710 AS cdepval_customer_c_mktsegment_0#2731, cc_name#2711 AS cc_name_0#2732, cc_address#2712 AS cc_address_0#2733, cc_phone#2713 AS cc_phone_0#2734, cc_acctbal#2714 AS cc_acctbal_0#2735, cc_comment#2715 AS cc_comment_0#2736, cc_mktsegment#2716 AS cc_mktsegment_0#2737]
                  +- Relation[rid#2696,cpfk_nation_customer#2697,cfpk_customer_nation#2698,cval_customer_c_name#2699,cval_customer_c_address#2700,cval_customer_c_phone#2701,cval_customer_c_acctbal#2702,cval_customer_c_comment#2703,cval_customer_c_mktsegment#2704,cdepval_customer_c_name#2705,cdepval_customer_c_address#2706,cdepval_customer_c_phone#2707,cdepval_customer_c_acctbal#2708,cdepval_customer_c_comment#2709,cdepval_customer_c_mktsegment#2710,cc_name#2711,cc_address#2712,cc_phone#2713,cc_acctbal#2714,cc_comment#2715,cc_mktsegment#2716] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 39237ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 22:13:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:13:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3017L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:13:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:13:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:13:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:13:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:13:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:13:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:13:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:13:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:13:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:13:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:13:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:13:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3017L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#3151 AS rid_4#3196, cpfk_orders_lineitem#3152 AS cpfk_orders_lineitem_4#3197, cpfk_supplier_lineitem#3153 AS cpfk_supplier_lineitem_4#3198, cfpk_lineitem_supplier#3154 AS cfpk_lineitem_supplier_4#3199, cfpk_lineitem_partsupp#3155 AS cfpk_lineitem_partsupp_4#3200, cpfk_part_lineitem#3156 AS cpfk_part_lineitem_4#3201, cfpk_lineitem_part#3157 AS cfpk_lineitem_part_4#3202, cpfk_partsupp_lineitem#3158 AS cpfk_partsupp_lineitem_4#3203, cfpk_lineitem_orders#3159 AS cfpk_lineitem_orders_4#3204, cval_lineitem_l_quantity#3160 AS cval_lineitem_l_quantity_4#3205, cval_lineitem_l_extendedprice#3161 AS cval_lineitem_l_extendedprice_4#3206, cval_lineitem_l_discount#3162 AS cval_lineitem_l_discount_4#3207, cval_lineitem_l_tax#3163 AS cval_lineitem_l_tax_4#3208, cval_lineitem_l_returnflag#3164 AS cval_lineitem_l_returnflag_4#3209, cval_lineitem_l_linestatus#3165 AS cval_lineitem_l_linestatus_4#3210, cval_lineitem_l_commitdate#3166 AS cval_lineitem_l_commitdate_4#3211, cval_lineitem_l_receiptdate#3167 AS cval_lineitem_l_receiptdate_4#3212, cval_lineitem_l_shipinstruct#3168 AS cval_lineitem_l_shipinstruct_4#3213, cval_lineitem_l_shipmode#3169 AS cval_lineitem_l_shipmode_4#3214, cval_lineitem_l_comment#3170 AS cval_lineitem_l_comment_4#3215, cval_lineitem_l_shipdate#3171 AS cval_lineitem_l_shipdate_4#3216, cdepval_lineitem_l_quantity#3172 AS cdepval_lineitem_l_quantity_4#3217, cdepval_lineitem_l_extendedprice#3173 AS cdepval_lineitem_l_extendedprice_4#3218, cdepval_lineitem_l_discount#3174 AS cdepval_lineitem_l_discount_4#3219, ... 21 more fields]
         :  :  +- Relation[rid#3151,cpfk_orders_lineitem#3152,cpfk_supplier_lineitem#3153,cfpk_lineitem_supplier#3154,cfpk_lineitem_partsupp#3155,cpfk_part_lineitem#3156,cfpk_lineitem_part#3157,cpfk_partsupp_lineitem#3158,cfpk_lineitem_orders#3159,cval_lineitem_l_quantity#3160,cval_lineitem_l_extendedprice#3161,cval_lineitem_l_discount#3162,cval_lineitem_l_tax#3163,cval_lineitem_l_returnflag#3164,cval_lineitem_l_linestatus#3165,cval_lineitem_l_commitdate#3166,cval_lineitem_l_receiptdate#3167,cval_lineitem_l_shipinstruct#3168,cval_lineitem_l_shipmode#3169,cval_lineitem_l_comment#3170,cval_lineitem_l_shipdate#3171,cdepval_lineitem_l_quantity#3172,cdepval_lineitem_l_extendedprice#3173,cdepval_lineitem_l_discount#3174,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#3073 AS rid_2#3087, cpfk_part_partsupp#3074 AS cpfk_part_partsupp_2#3088, cfpk_partsupp_part#3075 AS cfpk_partsupp_part_2#3089, cpfk_supplier_partsupp#3076 AS cpfk_supplier_partsupp_2#3090, cfpk_partsupp_supplier#3077 AS cfpk_partsupp_supplier_2#3091, cval_partsupp_ps_availqty#3078 AS cval_partsupp_ps_availqty_2#3092, cval_partsupp_ps_supplycost#3079 AS cval_partsupp_ps_supplycost_2#3093, cval_partsupp_ps_comment#3080 AS cval_partsupp_ps_comment_2#3094, cdepval_partsupp_ps_availqty#3081 AS cdepval_partsupp_ps_availqty_2#3095, cdepval_partsupp_ps_supplycost#3082 AS cdepval_partsupp_ps_supplycost_2#3096, cdepval_partsupp_ps_comment#3083 AS cdepval_partsupp_ps_comment_2#3097, cps_availqty#3084 AS cps_availqty_2#3098, cps_supplycost#3085 AS cps_supplycost_2#3099, cps_comment#3086 AS cps_comment_2#3100]
         :     :  :  +- Relation[rid#3073,cpfk_part_partsupp#3074,cfpk_partsupp_part#3075,cpfk_supplier_partsupp#3076,cfpk_partsupp_supplier#3077,cval_partsupp_ps_availqty#3078,cval_partsupp_ps_supplycost#3079,cval_partsupp_ps_comment#3080,cdepval_partsupp_ps_availqty#3081,cdepval_partsupp_ps_supplycost#3082,cdepval_partsupp_ps_comment#3083,cps_availqty#3084,cps_supplycost#3085,cps_comment#3086] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#3037 AS rid_1#3055, cpfk_nation_supplier#3038 AS cpfk_nation_supplier_1#3056, cfpk_supplier_nation#3039 AS cfpk_supplier_nation_1#3057, cval_supplier_s_name#3040 AS cval_supplier_s_name_1#3058, cval_supplier_s_address#3041 AS cval_supplier_s_address_1#3059, cval_supplier_s_phone#3042 AS cval_supplier_s_phone_1#3060, cval_supplier_s_acctbal#3043 AS cval_supplier_s_acctbal_1#3061, cval_supplier_s_comment#3044 AS cval_supplier_s_comment_1#3062, cdepval_supplier_s_name#3045 AS cdepval_supplier_s_name_1#3063, cdepval_supplier_s_address#3046 AS cdepval_supplier_s_address_1#3064, cdepval_supplier_s_phone#3047 AS cdepval_supplier_s_phone_1#3065, cdepval_supplier_s_acctbal#3048 AS cdepval_supplier_s_acctbal_1#3066, cdepval_supplier_s_comment#3049 AS cdepval_supplier_s_comment_1#3067, cs_name#3050 AS cs_name_1#3068, cs_address#3051 AS cs_address_1#3069, cs_phone#3052 AS cs_phone_1#3070, cs_acctbal#3053 AS cs_acctbal_1#3071, cs_comment#3054 AS cs_comment_1#3072]
         :     :     :  +- Relation[rid#3037,cpfk_nation_supplier#3038,cfpk_supplier_nation#3039,cval_supplier_s_name#3040,cval_supplier_s_address#3041,cval_supplier_s_phone#3042,cval_supplier_s_acctbal#3043,cval_supplier_s_comment#3044,cdepval_supplier_s_name#3045,cdepval_supplier_s_address#3046,cdepval_supplier_s_phone#3047,cdepval_supplier_s_acctbal#3048,cdepval_supplier_s_comment#3049,cs_name#3050,cs_address#3051,cs_phone#3052,cs_acctbal#3053,cs_comment#3054] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#3019 AS rid_0#3028, cpfk_region_nation#3020 AS cpfk_region_nation_0#3029, cfpk_nation_region#3021 AS cfpk_nation_region_0#3030, cval_nation_n_name#3022 AS cval_nation_n_name_0#3031, cval_nation_n_comment#3023 AS cval_nation_n_comment_0#3032, cdepval_nation_n_name#3024 AS cdepval_nation_n_name_0#3033, cdepval_nation_n_comment#3025 AS cdepval_nation_n_comment_0#3034, cn_name#3026 AS cn_name_0#3035, cn_comment#3027 AS cn_comment_0#3036]
         :     :        +- Relation[rid#3019,cpfk_region_nation#3020,cfpk_nation_region#3021,cval_nation_n_name#3022,cval_nation_n_comment#3023,cdepval_nation_n_name#3024,cdepval_nation_n_comment#3025,cn_name#3026,cn_comment#3027] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#3101 AS rid_3#3126, cval_part_p_name#3102 AS cval_part_p_name_3#3127, cval_part_p_mfgr#3103 AS cval_part_p_mfgr_3#3128, cval_part_p_type#3104 AS cval_part_p_type_3#3129, cval_part_p_size#3105 AS cval_part_p_size_3#3130, cval_part_p_container#3106 AS cval_part_p_container_3#3131, cval_part_p_retailprice#3107 AS cval_part_p_retailprice_3#3132, cval_part_p_comment#3108 AS cval_part_p_comment_3#3133, cval_part_p_brand#3109 AS cval_part_p_brand_3#3134, cdepval_part_p_name#3110 AS cdepval_part_p_name_3#3135, cdepval_part_p_mfgr#3111 AS cdepval_part_p_mfgr_3#3136, cdepval_part_p_type#3112 AS cdepval_part_p_type_3#3137, cdepval_part_p_size#3113 AS cdepval_part_p_size_3#3138, cdepval_part_p_container#3114 AS cdepval_part_p_container_3#3139, cdepval_part_p_retailprice#3115 AS cdepval_part_p_retailprice_3#3140, cdepval_part_p_comment#3116 AS cdepval_part_p_comment_3#3141, cdepval_part_p_brand#3117 AS cdepval_part_p_brand_3#3142, cp_name#3118 AS cp_name_3#3143, cp_mfgr#3119 AS cp_mfgr_3#3144, cp_type#3120 AS cp_type_3#3145, cp_size#3121 AS cp_size_3#3146, cp_container#3122 AS cp_container_3#3147, cp_retailprice#3123 AS cp_retailprice_3#3148, cp_comment#3124 AS cp_comment_3#3149, cp_brand#3125 AS cp_brand_3#3150]
         :        +- Relation[rid#3101,cval_part_p_name#3102,cval_part_p_mfgr#3103,cval_part_p_type#3104,cval_part_p_size#3105,cval_part_p_container#3106,cval_part_p_retailprice#3107,cval_part_p_comment#3108,cval_part_p_brand#3109,cdepval_part_p_name#3110,cdepval_part_p_mfgr#3111,cdepval_part_p_type#3112,cdepval_part_p_size#3113,cdepval_part_p_container#3114,cdepval_part_p_retailprice#3115,cdepval_part_p_comment#3116,cdepval_part_p_brand#3117,cp_name#3118,cp_mfgr#3119,cp_type#3120,cp_size#3121,cp_container#3122,cp_retailprice#3123,cp_comment#3124,cp_brand#3125] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#3241 AS rid_5#3265, cpfk_customer_orders#3242 AS cpfk_customer_orders_5#3266, cfpk_orders_customer#3243 AS cfpk_orders_customer_5#3267, cval_orders_o_orderstatus#3244 AS cval_orders_o_orderstatus_5#3268, cval_orders_o_totalprice#3245 AS cval_orders_o_totalprice_5#3269, cval_orders_o_orderpriority#3246 AS cval_orders_o_orderpriority_5#3270, cval_orders_o_clerk#3247 AS cval_orders_o_clerk_5#3271, cval_orders_o_shippriority#3248 AS cval_orders_o_shippriority_5#3272, cval_orders_o_comment#3249 AS cval_orders_o_comment_5#3273, cval_orders_o_orderdate#3250 AS cval_orders_o_orderdate_5#3274, cdepval_orders_o_orderstatus#3251 AS cdepval_orders_o_orderstatus_5#3275, cdepval_orders_o_totalprice#3252 AS cdepval_orders_o_totalprice_5#3276, cdepval_orders_o_orderpriority#3253 AS cdepval_orders_o_orderpriority_5#3277, cdepval_orders_o_clerk#3254 AS cdepval_orders_o_clerk_5#3278, cdepval_orders_o_shippriority#3255 AS cdepval_orders_o_shippriority_5#3279, cdepval_orders_o_comment#3256 AS cdepval_orders_o_comment_5#3280, cdepval_orders_o_orderdate#3257 AS cdepval_orders_o_orderdate_5#3281, co_orderstatus#3258 AS co_orderstatus_5#3282, co_totalprice#3259 AS co_totalprice_5#3283, co_orderpriority#3260 AS co_orderpriority_5#3284, co_clerk#3261 AS co_clerk_5#3285, co_shippriority#3262 AS co_shippriority_5#3286, co_comment#3263 AS co_comment_5#3287, co_orderdate#3264 AS co_orderdate_5#3288]
            +- Relation[rid#3241,cpfk_customer_orders#3242,cfpk_orders_customer#3243,cval_orders_o_orderstatus#3244,cval_orders_o_totalprice#3245,cval_orders_o_orderpriority#3246,cval_orders_o_clerk#3247,cval_orders_o_shippriority#3248,cval_orders_o_comment#3249,cval_orders_o_orderdate#3250,cdepval_orders_o_orderstatus#3251,cdepval_orders_o_totalprice#3252,cdepval_orders_o_orderpriority#3253,cdepval_orders_o_clerk#3254,cdepval_orders_o_shippriority#3255,cdepval_orders_o_comment#3256,cdepval_orders_o_orderdate#3257,co_orderstatus#3258,co_totalprice#3259,co_orderpriority#3260,co_clerk#3261,co_shippriority#3262,co_comment#3263,co_orderdate#3264] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 37972ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/25 22:13:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:13:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3429L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:13:52 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:13:52 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:13:52 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:13:52 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:13:52 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:13:52 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:13:52 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:13:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3429L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#3456, cval_part_p_name_0#3457, cval_part_p_mfgr_0#3458, cval_part_p_type_0#3459, cval_part_p_size_0#3460, cval_part_p_container_0#3461, cval_part_p_retailprice_0#3462, cval_part_p_comment_0#3463, cval_part_p_brand_0#3464, cdepval_part_p_name_0#3465, cdepval_part_p_mfgr_0#3466, cdepval_part_p_type_0#3467, cdepval_part_p_size_0#3468, cdepval_part_p_container_0#3469, cdepval_part_p_retailprice_0#3470, cdepval_part_p_comment_0#3471, cdepval_part_p_brand_0#3472, cp_name_0#3473, cp_mfgr_0#3474, cp_type_0#3475, cp_size_0#3476, cp_container_0#3477, cp_retailprice_0#3478, cp_comment_0#3479, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#3431 AS rid_0#3456, cval_part_p_name#3432 AS cval_part_p_name_0#3457, cval_part_p_mfgr#3433 AS cval_part_p_mfgr_0#3458, cval_part_p_type#3434 AS cval_part_p_type_0#3459, cval_part_p_size#3435 AS cval_part_p_size_0#3460, cval_part_p_container#3436 AS cval_part_p_container_0#3461, cval_part_p_retailprice#3437 AS cval_part_p_retailprice_0#3462, cval_part_p_comment#3438 AS cval_part_p_comment_0#3463, cval_part_p_brand#3439 AS cval_part_p_brand_0#3464, cdepval_part_p_name#3440 AS cdepval_part_p_name_0#3465, cdepval_part_p_mfgr#3441 AS cdepval_part_p_mfgr_0#3466, cdepval_part_p_type#3442 AS cdepval_part_p_type_0#3467, cdepval_part_p_size#3443 AS cdepval_part_p_size_0#3468, cdepval_part_p_container#3444 AS cdepval_part_p_container_0#3469, cdepval_part_p_retailprice#3445 AS cdepval_part_p_retailprice_0#3470, cdepval_part_p_comment#3446 AS cdepval_part_p_comment_0#3471, cdepval_part_p_brand#3447 AS cdepval_part_p_brand_0#3472, cp_name#3448 AS cp_name_0#3473, cp_mfgr#3449 AS cp_mfgr_0#3474, cp_type#3450 AS cp_type_0#3475, cp_size#3451 AS cp_size_0#3476, cp_container#3452 AS cp_container_0#3477, cp_retailprice#3453 AS cp_retailprice_0#3478, cp_comment#3454 AS cp_comment_0#3479, cp_brand#3455 AS cp_brand_0#3480]
         :  :        +- Relation[rid#3431,cval_part_p_name#3432,cval_part_p_mfgr#3433,cval_part_p_type#3434,cval_part_p_size#3435,cval_part_p_container#3436,cval_part_p_retailprice#3437,cval_part_p_comment#3438,cval_part_p_brand#3439,cdepval_part_p_name#3440,cdepval_part_p_mfgr#3441,cdepval_part_p_type#3442,cdepval_part_p_size#3443,cdepval_part_p_container#3444,cdepval_part_p_retailprice#3445,cdepval_part_p_comment#3446,cdepval_part_p_brand#3447,cp_name#3448,cp_mfgr#3449,cp_type#3450,cp_size#3451,cp_container#3452,cp_retailprice#3453,cp_comment#3454,cp_brand#3455] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#3901 AS rid_1#3946, cpfk_orders_lineitem#3902 AS cpfk_orders_lineitem_1#3947, cpfk_supplier_lineitem#3903 AS cpfk_supplier_lineitem_1#3948, cfpk_lineitem_supplier#3904 AS cfpk_lineitem_supplier_1#3949, cfpk_lineitem_partsupp#3905 AS cfpk_lineitem_partsupp_1#3950, cpfk_part_lineitem#3906 AS cpfk_part_lineitem_1#3951, cfpk_lineitem_part#3907 AS cfpk_lineitem_part_1#3952, cpfk_partsupp_lineitem#3908 AS cpfk_partsupp_lineitem_1#3953, cfpk_lineitem_orders#3909 AS cfpk_lineitem_orders_1#3954, cval_lineitem_l_quantity#3910 AS cval_lineitem_l_quantity_1#3955, cval_lineitem_l_extendedprice#3911 AS cval_lineitem_l_extendedprice_1#3956, cval_lineitem_l_discount#3912 AS cval_lineitem_l_discount_1#3957, cval_lineitem_l_tax#3913 AS cval_lineitem_l_tax_1#3958, cval_lineitem_l_returnflag#3914 AS cval_lineitem_l_returnflag_1#3959, cval_lineitem_l_linestatus#3915 AS cval_lineitem_l_linestatus_1#3960, cval_lineitem_l_commitdate#3916 AS cval_lineitem_l_commitdate_1#3961, cval_lineitem_l_receiptdate#3917 AS cval_lineitem_l_receiptdate_1#3962, cval_lineitem_l_shipinstruct#3918 AS cval_lineitem_l_shipinstruct_1#3963, cval_lineitem_l_shipmode#3919 AS cval_lineitem_l_shipmode_1#3964, cval_lineitem_l_comment#3920 AS cval_lineitem_l_comment_1#3965, cval_lineitem_l_shipdate#3921 AS cval_lineitem_l_shipdate_1#3966, cdepval_lineitem_l_quantity#3922 AS cdepval_lineitem_l_quantity_1#3967, cdepval_lineitem_l_extendedprice#3923 AS cdepval_lineitem_l_extendedprice_1#3968, cdepval_lineitem_l_discount#3924 AS cdepval_lineitem_l_discount_1#3969, ... 21 more fields]
         :        +- Relation[rid#3901,cpfk_orders_lineitem#3902,cpfk_supplier_lineitem#3903,cfpk_lineitem_supplier#3904,cfpk_lineitem_partsupp#3905,cpfk_part_lineitem#3906,cfpk_lineitem_part#3907,cpfk_partsupp_lineitem#3908,cfpk_lineitem_orders#3909,cval_lineitem_l_quantity#3910,cval_lineitem_l_extendedprice#3911,cval_lineitem_l_discount#3912,cval_lineitem_l_tax#3913,cval_lineitem_l_returnflag#3914,cval_lineitem_l_linestatus#3915,cval_lineitem_l_commitdate#3916,cval_lineitem_l_receiptdate#3917,cval_lineitem_l_shipinstruct#3918,cval_lineitem_l_shipmode#3919,cval_lineitem_l_comment#3920,cval_lineitem_l_shipdate#3921,cdepval_lineitem_l_quantity#3922,cdepval_lineitem_l_extendedprice#3923,cdepval_lineitem_l_discount#3924,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#3581 AS rid_1#3626, cpfk_orders_lineitem#3582 AS cpfk_orders_lineitem_1#3627, cpfk_supplier_lineitem#3583 AS cpfk_supplier_lineitem_1#3628, cfpk_lineitem_supplier#3584 AS cfpk_lineitem_supplier_1#3629, cfpk_lineitem_partsupp#3585 AS cfpk_lineitem_partsupp_1#3630, cpfk_part_lineitem#3586 AS cpfk_part_lineitem_1#3631, cfpk_lineitem_part#3587 AS cfpk_lineitem_part_1#3632, cpfk_partsupp_lineitem#3588 AS cpfk_partsupp_lineitem_1#3633, cfpk_lineitem_orders#3589 AS cfpk_lineitem_orders_1#3634, cval_lineitem_l_quantity#3590 AS cval_lineitem_l_quantity_1#3635, cval_lineitem_l_extendedprice#3591 AS cval_lineitem_l_extendedprice_1#3636, cval_lineitem_l_discount#3592 AS cval_lineitem_l_discount_1#3637, cval_lineitem_l_tax#3593 AS cval_lineitem_l_tax_1#3638, cval_lineitem_l_returnflag#3594 AS cval_lineitem_l_returnflag_1#3639, cval_lineitem_l_linestatus#3595 AS cval_lineitem_l_linestatus_1#3640, cval_lineitem_l_commitdate#3596 AS cval_lineitem_l_commitdate_1#3641, cval_lineitem_l_receiptdate#3597 AS cval_lineitem_l_receiptdate_1#3642, cval_lineitem_l_shipinstruct#3598 AS cval_lineitem_l_shipinstruct_1#3643, cval_lineitem_l_shipmode#3599 AS cval_lineitem_l_shipmode_1#3644, cval_lineitem_l_comment#3600 AS cval_lineitem_l_comment_1#3645, cval_lineitem_l_shipdate#3601 AS cval_lineitem_l_shipdate_1#3646, cdepval_lineitem_l_quantity#3602 AS cdepval_lineitem_l_quantity_1#3647, cdepval_lineitem_l_extendedprice#3603 AS cdepval_lineitem_l_extendedprice_1#3648, cdepval_lineitem_l_discount#3604 AS cdepval_lineitem_l_discount_1#3649, ... 21 more fields]
                  +- Relation[rid#3581,cpfk_orders_lineitem#3582,cpfk_supplier_lineitem#3583,cfpk_lineitem_supplier#3584,cfpk_lineitem_partsupp#3585,cpfk_part_lineitem#3586,cfpk_lineitem_part#3587,cpfk_partsupp_lineitem#3588,cfpk_lineitem_orders#3589,cval_lineitem_l_quantity#3590,cval_lineitem_l_extendedprice#3591,cval_lineitem_l_discount#3592,cval_lineitem_l_tax#3593,cval_lineitem_l_returnflag#3594,cval_lineitem_l_linestatus#3595,cval_lineitem_l_commitdate#3596,cval_lineitem_l_receiptdate#3597,cval_lineitem_l_shipinstruct#3598,cval_lineitem_l_shipmode#3599,cval_lineitem_l_comment#3600,cval_lineitem_l_shipdate#3601,cdepval_lineitem_l_quantity#3602,cdepval_lineitem_l_extendedprice#3603,cdepval_lineitem_l_discount#3604,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 16749ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/25 22:14:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:14:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4066L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:14:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#4066L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#4068 AS rid_0#4113, cpfk_orders_lineitem#4069 AS cpfk_orders_lineitem_0#4114, cpfk_supplier_lineitem#4070 AS cpfk_supplier_lineitem_0#4115, cfpk_lineitem_supplier#4071 AS cfpk_lineitem_supplier_0#4116, cfpk_lineitem_partsupp#4072 AS cfpk_lineitem_partsupp_0#4117, cpfk_part_lineitem#4073 AS cpfk_part_lineitem_0#4118, cfpk_lineitem_part#4074 AS cfpk_lineitem_part_0#4119, cpfk_partsupp_lineitem#4075 AS cpfk_partsupp_lineitem_0#4120, cfpk_lineitem_orders#4076 AS cfpk_lineitem_orders_0#4121, cval_lineitem_l_quantity#4077 AS cval_lineitem_l_quantity_0#4122, cval_lineitem_l_extendedprice#4078 AS cval_lineitem_l_extendedprice_0#4123, cval_lineitem_l_discount#4079 AS cval_lineitem_l_discount_0#4124, cval_lineitem_l_tax#4080 AS cval_lineitem_l_tax_0#4125, cval_lineitem_l_returnflag#4081 AS cval_lineitem_l_returnflag_0#4126, cval_lineitem_l_linestatus#4082 AS cval_lineitem_l_linestatus_0#4127, cval_lineitem_l_commitdate#4083 AS cval_lineitem_l_commitdate_0#4128, cval_lineitem_l_receiptdate#4084 AS cval_lineitem_l_receiptdate_0#4129, cval_lineitem_l_shipinstruct#4085 AS cval_lineitem_l_shipinstruct_0#4130, cval_lineitem_l_shipmode#4086 AS cval_lineitem_l_shipmode_0#4131, cval_lineitem_l_comment#4087 AS cval_lineitem_l_comment_0#4132, cval_lineitem_l_shipdate#4088 AS cval_lineitem_l_shipdate_0#4133, cdepval_lineitem_l_quantity#4089 AS cdepval_lineitem_l_quantity_0#4134, cdepval_lineitem_l_extendedprice#4090 AS cdepval_lineitem_l_extendedprice_0#4135, cdepval_lineitem_l_discount#4091 AS cdepval_lineitem_l_discount_0#4136, ... 21 more fields]
         +- Relation[rid#4068,cpfk_orders_lineitem#4069,cpfk_supplier_lineitem#4070,cfpk_lineitem_supplier#4071,cfpk_lineitem_partsupp#4072,cpfk_part_lineitem#4073,cfpk_lineitem_part#4074,cpfk_partsupp_lineitem#4075,cfpk_lineitem_orders#4076,cval_lineitem_l_quantity#4077,cval_lineitem_l_extendedprice#4078,cval_lineitem_l_discount#4079,cval_lineitem_l_tax#4080,cval_lineitem_l_returnflag#4081,cval_lineitem_l_linestatus#4082,cval_lineitem_l_commitdate#4083,cval_lineitem_l_receiptdate#4084,cval_lineitem_l_shipinstruct#4085,cval_lineitem_l_shipmode#4086,cval_lineitem_l_comment#4087,cval_lineitem_l_shipdate#4088,cdepval_lineitem_l_quantity#4089,cdepval_lineitem_l_extendedprice#4090,cdepval_lineitem_l_discount#4091,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2472ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/25 22:14:12 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:14:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4215L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 22:14:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:14:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:14:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4215L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#4217 AS rid_0#4262, cpfk_orders_lineitem#4218 AS cpfk_orders_lineitem_0#4263, cpfk_supplier_lineitem#4219 AS cpfk_supplier_lineitem_0#4264, cfpk_lineitem_supplier#4220 AS cfpk_lineitem_supplier_0#4265, cfpk_lineitem_partsupp#4221 AS cfpk_lineitem_partsupp_0#4266, cpfk_part_lineitem#4222 AS cpfk_part_lineitem_0#4267, cfpk_lineitem_part#4223 AS cfpk_lineitem_part_0#4268, cpfk_partsupp_lineitem#4224 AS cpfk_partsupp_lineitem_0#4269, cfpk_lineitem_orders#4225 AS cfpk_lineitem_orders_0#4270, cval_lineitem_l_quantity#4226 AS cval_lineitem_l_quantity_0#4271, cval_lineitem_l_extendedprice#4227 AS cval_lineitem_l_extendedprice_0#4272, cval_lineitem_l_discount#4228 AS cval_lineitem_l_discount_0#4273, cval_lineitem_l_tax#4229 AS cval_lineitem_l_tax_0#4274, cval_lineitem_l_returnflag#4230 AS cval_lineitem_l_returnflag_0#4275, cval_lineitem_l_linestatus#4231 AS cval_lineitem_l_linestatus_0#4276, cval_lineitem_l_commitdate#4232 AS cval_lineitem_l_commitdate_0#4277, cval_lineitem_l_receiptdate#4233 AS cval_lineitem_l_receiptdate_0#4278, cval_lineitem_l_shipinstruct#4234 AS cval_lineitem_l_shipinstruct_0#4279, cval_lineitem_l_shipmode#4235 AS cval_lineitem_l_shipmode_0#4280, cval_lineitem_l_comment#4236 AS cval_lineitem_l_comment_0#4281, cval_lineitem_l_shipdate#4237 AS cval_lineitem_l_shipdate_0#4282, cdepval_lineitem_l_quantity#4238 AS cdepval_lineitem_l_quantity_0#4283, cdepval_lineitem_l_extendedprice#4239 AS cdepval_lineitem_l_extendedprice_0#4284, cdepval_lineitem_l_discount#4240 AS cdepval_lineitem_l_discount_0#4285, ... 21 more fields]
         :  :  :     +- Relation[rid#4217,cpfk_orders_lineitem#4218,cpfk_supplier_lineitem#4219,cfpk_lineitem_supplier#4220,cfpk_lineitem_partsupp#4221,cpfk_part_lineitem#4222,cfpk_lineitem_part#4223,cpfk_partsupp_lineitem#4224,cfpk_lineitem_orders#4225,cval_lineitem_l_quantity#4226,cval_lineitem_l_extendedprice#4227,cval_lineitem_l_discount#4228,cval_lineitem_l_tax#4229,cval_lineitem_l_returnflag#4230,cval_lineitem_l_linestatus#4231,cval_lineitem_l_commitdate#4232,cval_lineitem_l_receiptdate#4233,cval_lineitem_l_shipinstruct#4234,cval_lineitem_l_shipmode#4235,cval_lineitem_l_comment#4236,cval_lineitem_l_shipdate#4237,cdepval_lineitem_l_quantity#4238,cdepval_lineitem_l_extendedprice#4239,cdepval_lineitem_l_discount#4240,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#4397 AS rid_1#4421, cpfk_customer_orders#4398 AS cpfk_customer_orders_1#4422, cfpk_orders_customer#4399 AS cfpk_orders_customer_1#4423, cval_orders_o_orderstatus#4400 AS cval_orders_o_orderstatus_1#4424, cval_orders_o_totalprice#4401 AS cval_orders_o_totalprice_1#4425, cval_orders_o_orderpriority#4402 AS cval_orders_o_orderpriority_1#4426, cval_orders_o_clerk#4403 AS cval_orders_o_clerk_1#4427, cval_orders_o_shippriority#4404 AS cval_orders_o_shippriority_1#4428, cval_orders_o_comment#4405 AS cval_orders_o_comment_1#4429, cval_orders_o_orderdate#4406 AS cval_orders_o_orderdate_1#4430, cdepval_orders_o_orderstatus#4407 AS cdepval_orders_o_orderstatus_1#4431, cdepval_orders_o_totalprice#4408 AS cdepval_orders_o_totalprice_1#4432, cdepval_orders_o_orderpriority#4409 AS cdepval_orders_o_orderpriority_1#4433, cdepval_orders_o_clerk#4410 AS cdepval_orders_o_clerk_1#4434, cdepval_orders_o_shippriority#4411 AS cdepval_orders_o_shippriority_1#4435, cdepval_orders_o_comment#4412 AS cdepval_orders_o_comment_1#4436, cdepval_orders_o_orderdate#4413 AS cdepval_orders_o_orderdate_1#4437, co_orderstatus#4414 AS co_orderstatus_1#4438, co_totalprice#4415 AS co_totalprice_1#4439, co_orderpriority#4416 AS co_orderpriority_1#4440, co_clerk#4417 AS co_clerk_1#4441, co_shippriority#4418 AS co_shippriority_1#4442, co_comment#4419 AS co_comment_1#4443, co_orderdate#4420 AS co_orderdate_1#4444]
         :  :     +- Relation[rid#4397,cpfk_customer_orders#4398,cfpk_orders_customer#4399,cval_orders_o_orderstatus#4400,cval_orders_o_totalprice#4401,cval_orders_o_orderpriority#4402,cval_orders_o_clerk#4403,cval_orders_o_shippriority#4404,cval_orders_o_comment#4405,cval_orders_o_orderdate#4406,cdepval_orders_o_orderstatus#4407,cdepval_orders_o_totalprice#4408,cdepval_orders_o_orderpriority#4409,cdepval_orders_o_clerk#4410,cdepval_orders_o_shippriority#4411,cdepval_orders_o_comment#4412,cdepval_orders_o_orderdate#4413,co_orderstatus#4414,co_totalprice#4415,co_orderpriority#4416,co_clerk#4417,co_shippriority#4418,co_comment#4419,co_orderdate#4420] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#4445 AS rid_2#4466, cpfk_nation_customer#4446 AS cpfk_nation_customer_2#4467, cfpk_customer_nation#4447 AS cfpk_customer_nation_2#4468, cval_customer_c_name#4448 AS cval_customer_c_name_2#4469, cval_customer_c_address#4449 AS cval_customer_c_address_2#4470, cval_customer_c_phone#4450 AS cval_customer_c_phone_2#4471, cval_customer_c_acctbal#4451 AS cval_customer_c_acctbal_2#4472, cval_customer_c_comment#4452 AS cval_customer_c_comment_2#4473, cval_customer_c_mktsegment#4453 AS cval_customer_c_mktsegment_2#4474, cdepval_customer_c_name#4454 AS cdepval_customer_c_name_2#4475, cdepval_customer_c_address#4455 AS cdepval_customer_c_address_2#4476, cdepval_customer_c_phone#4456 AS cdepval_customer_c_phone_2#4477, cdepval_customer_c_acctbal#4457 AS cdepval_customer_c_acctbal_2#4478, cdepval_customer_c_comment#4458 AS cdepval_customer_c_comment_2#4479, cdepval_customer_c_mktsegment#4459 AS cdepval_customer_c_mktsegment_2#4480, cc_name#4460 AS cc_name_2#4481, cc_address#4461 AS cc_address_2#4482, cc_phone#4462 AS cc_phone_2#4483, cc_acctbal#4463 AS cc_acctbal_2#4484, cc_comment#4464 AS cc_comment_2#4485, cc_mktsegment#4465 AS cc_mktsegment_2#4486]
         :     +- Relation[rid#4445,cpfk_nation_customer#4446,cfpk_customer_nation#4447,cval_customer_c_name#4448,cval_customer_c_address#4449,cval_customer_c_phone#4450,cval_customer_c_acctbal#4451,cval_customer_c_comment#4452,cval_customer_c_mktsegment#4453,cdepval_customer_c_name#4454,cdepval_customer_c_address#4455,cdepval_customer_c_phone#4456,cdepval_customer_c_acctbal#4457,cdepval_customer_c_comment#4458,cdepval_customer_c_mktsegment#4459,cc_name#4460,cc_address#4461,cc_phone#4462,cc_acctbal#4463,cc_comment#4464,cc_mktsegment#4465] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#4487 AS rid_3#4496, cpfk_region_nation#4488 AS cpfk_region_nation_3#4497, cfpk_nation_region#4489 AS cfpk_nation_region_3#4498, cval_nation_n_name#4490 AS cval_nation_n_name_3#4499, cval_nation_n_comment#4491 AS cval_nation_n_comment_3#4500, cdepval_nation_n_name#4492 AS cdepval_nation_n_name_3#4501, cdepval_nation_n_comment#4493 AS cdepval_nation_n_comment_3#4502, cn_name#4494 AS cn_name_3#4503, cn_comment#4495 AS cn_comment_3#4504]
            +- Relation[rid#4487,cpfk_region_nation#4488,cfpk_nation_region#4489,cval_nation_n_name#4490,cval_nation_n_comment#4491,cdepval_nation_n_name#4492,cdepval_nation_n_comment#4493,cn_name#4494,cn_comment#4495] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 60509ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/25 22:15:12 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:15:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4612L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:15:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:15:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:15:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:15:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:15:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:15:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:15:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:15:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:15:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:15:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:15:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:15:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4612L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#4686 AS rid_2#4731, cpfk_orders_lineitem#4687 AS cpfk_orders_lineitem_2#4732, cpfk_supplier_lineitem#4688 AS cpfk_supplier_lineitem_2#4733, cfpk_lineitem_supplier#4689 AS cfpk_lineitem_supplier_2#4734, cfpk_lineitem_partsupp#4690 AS cfpk_lineitem_partsupp_2#4735, cpfk_part_lineitem#4691 AS cpfk_part_lineitem_2#4736, cfpk_lineitem_part#4692 AS cfpk_lineitem_part_2#4737, cpfk_partsupp_lineitem#4693 AS cpfk_partsupp_lineitem_2#4738, cfpk_lineitem_orders#4694 AS cfpk_lineitem_orders_2#4739, cval_lineitem_l_quantity#4695 AS cval_lineitem_l_quantity_2#4740, cval_lineitem_l_extendedprice#4696 AS cval_lineitem_l_extendedprice_2#4741, cval_lineitem_l_discount#4697 AS cval_lineitem_l_discount_2#4742, cval_lineitem_l_tax#4698 AS cval_lineitem_l_tax_2#4743, cval_lineitem_l_returnflag#4699 AS cval_lineitem_l_returnflag_2#4744, cval_lineitem_l_linestatus#4700 AS cval_lineitem_l_linestatus_2#4745, cval_lineitem_l_commitdate#4701 AS cval_lineitem_l_commitdate_2#4746, cval_lineitem_l_receiptdate#4702 AS cval_lineitem_l_receiptdate_2#4747, cval_lineitem_l_shipinstruct#4703 AS cval_lineitem_l_shipinstruct_2#4748, cval_lineitem_l_shipmode#4704 AS cval_lineitem_l_shipmode_2#4749, cval_lineitem_l_comment#4705 AS cval_lineitem_l_comment_2#4750, cval_lineitem_l_shipdate#4706 AS cval_lineitem_l_shipdate_2#4751, cdepval_lineitem_l_quantity#4707 AS cdepval_lineitem_l_quantity_2#4752, cdepval_lineitem_l_extendedprice#4708 AS cdepval_lineitem_l_extendedprice_2#4753, cdepval_lineitem_l_discount#4709 AS cdepval_lineitem_l_discount_2#4754, ... 21 more fields]
         :  :  +- Relation[rid#4686,cpfk_orders_lineitem#4687,cpfk_supplier_lineitem#4688,cfpk_lineitem_supplier#4689,cfpk_lineitem_partsupp#4690,cpfk_part_lineitem#4691,cfpk_lineitem_part#4692,cpfk_partsupp_lineitem#4693,cfpk_lineitem_orders#4694,cval_lineitem_l_quantity#4695,cval_lineitem_l_extendedprice#4696,cval_lineitem_l_discount#4697,cval_lineitem_l_tax#4698,cval_lineitem_l_returnflag#4699,cval_lineitem_l_linestatus#4700,cval_lineitem_l_commitdate#4701,cval_lineitem_l_receiptdate#4702,cval_lineitem_l_shipinstruct#4703,cval_lineitem_l_shipmode#4704,cval_lineitem_l_comment#4705,cval_lineitem_l_shipdate#4706,cdepval_lineitem_l_quantity#4707,cdepval_lineitem_l_extendedprice#4708,cdepval_lineitem_l_discount#4709,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :- Project [rid#4650 AS rid_1#4668, cpfk_nation_supplier#4651 AS cpfk_nation_supplier_1#4669, cfpk_supplier_nation#4652 AS cfpk_supplier_nation_1#4670, cval_supplier_s_name#4653 AS cval_supplier_s_name_1#4671, cval_supplier_s_address#4654 AS cval_supplier_s_address_1#4672, cval_supplier_s_phone#4655 AS cval_supplier_s_phone_1#4673, cval_supplier_s_acctbal#4656 AS cval_supplier_s_acctbal_1#4674, cval_supplier_s_comment#4657 AS cval_supplier_s_comment_1#4675, cdepval_supplier_s_name#4658 AS cdepval_supplier_s_name_1#4676, cdepval_supplier_s_address#4659 AS cdepval_supplier_s_address_1#4677, cdepval_supplier_s_phone#4660 AS cdepval_supplier_s_phone_1#4678, cdepval_supplier_s_acctbal#4661 AS cdepval_supplier_s_acctbal_1#4679, cdepval_supplier_s_comment#4662 AS cdepval_supplier_s_comment_1#4680, cs_name#4663 AS cs_name_1#4681, cs_address#4664 AS cs_address_1#4682, cs_phone#4665 AS cs_phone_1#4683, cs_acctbal#4666 AS cs_acctbal_1#4684, cs_comment#4667 AS cs_comment_1#4685]
         :     :  +- Relation[rid#4650,cpfk_nation_supplier#4651,cfpk_supplier_nation#4652,cval_supplier_s_name#4653,cval_supplier_s_address#4654,cval_supplier_s_phone#4655,cval_supplier_s_acctbal#4656,cval_supplier_s_comment#4657,cdepval_supplier_s_name#4658,cdepval_supplier_s_address#4659,cdepval_supplier_s_phone#4660,cdepval_supplier_s_acctbal#4661,cdepval_supplier_s_comment#4662,cs_name#4663,cs_address#4664,cs_phone#4665,cs_acctbal#4666,cs_comment#4667] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :        +- Project [rid#4614 AS rid_0#4623, cpfk_region_nation#4615 AS cpfk_region_nation_0#4624, cfpk_nation_region#4616 AS cfpk_nation_region_0#4625, cval_nation_n_name#4617 AS cval_nation_n_name_0#4626, cval_nation_n_comment#4618 AS cval_nation_n_comment_0#4627, cdepval_nation_n_name#4619 AS cdepval_nation_n_name_0#4628, cdepval_nation_n_comment#4620 AS cdepval_nation_n_comment_0#4629, cn_name#4621 AS cn_name_0#4630, cn_comment#4622 AS cn_comment_0#4631]
         :           +- Relation[rid#4614,cpfk_region_nation#4615,cfpk_nation_region#4616,cval_nation_n_name#4617,cval_nation_n_comment#4618,cdepval_nation_n_name#4619,cdepval_nation_n_comment#4620,cn_name#4621,cn_comment#4622] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#4854 AS rid_5#4878, cpfk_customer_orders#4855 AS cpfk_customer_orders_5#4879, cfpk_orders_customer#4856 AS cfpk_orders_customer_5#4880, cval_orders_o_orderstatus#4857 AS cval_orders_o_orderstatus_5#4881, cval_orders_o_totalprice#4858 AS cval_orders_o_totalprice_5#4882, cval_orders_o_orderpriority#4859 AS cval_orders_o_orderpriority_5#4883, cval_orders_o_clerk#4860 AS cval_orders_o_clerk_5#4884, cval_orders_o_shippriority#4861 AS cval_orders_o_shippriority_5#4885, cval_orders_o_comment#4862 AS cval_orders_o_comment_5#4886, cval_orders_o_orderdate#4863 AS cval_orders_o_orderdate_5#4887, cdepval_orders_o_orderstatus#4864 AS cdepval_orders_o_orderstatus_5#4888, cdepval_orders_o_totalprice#4865 AS cdepval_orders_o_totalprice_5#4889, cdepval_orders_o_orderpriority#4866 AS cdepval_orders_o_orderpriority_5#4890, cdepval_orders_o_clerk#4867 AS cdepval_orders_o_clerk_5#4891, cdepval_orders_o_shippriority#4868 AS cdepval_orders_o_shippriority_5#4892, cdepval_orders_o_comment#4869 AS cdepval_orders_o_comment_5#4893, cdepval_orders_o_orderdate#4870 AS cdepval_orders_o_orderdate_5#4894, co_orderstatus#4871 AS co_orderstatus_5#4895, co_totalprice#4872 AS co_totalprice_5#4896, co_orderpriority#4873 AS co_orderpriority_5#4897, co_clerk#4874 AS co_clerk_5#4898, co_shippriority#4875 AS co_shippriority_5#4899, co_comment#4876 AS co_comment_5#4900, co_orderdate#4877 AS co_orderdate_5#4901]
            :  +- Relation[rid#4854,cpfk_customer_orders#4855,cfpk_orders_customer#4856,cval_orders_o_orderstatus#4857,cval_orders_o_totalprice#4858,cval_orders_o_orderpriority#4859,cval_orders_o_clerk#4860,cval_orders_o_shippriority#4861,cval_orders_o_comment#4862,cval_orders_o_orderdate#4863,cdepval_orders_o_orderstatus#4864,cdepval_orders_o_totalprice#4865,cdepval_orders_o_orderpriority#4866,cdepval_orders_o_clerk#4867,cdepval_orders_o_shippriority#4868,cdepval_orders_o_comment#4869,cdepval_orders_o_orderdate#4870,co_orderstatus#4871,co_totalprice#4872,co_orderpriority#4873,co_clerk#4874,co_shippriority#4875,co_comment#4876,co_orderdate#4877] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_4, BinaryType)), 'cfpk_customer_nation_4) = 'rid_3)
               :- Project [rid#4812 AS rid_4#4833, cpfk_nation_customer#4813 AS cpfk_nation_customer_4#4834, cfpk_customer_nation#4814 AS cfpk_customer_nation_4#4835, cval_customer_c_name#4815 AS cval_customer_c_name_4#4836, cval_customer_c_address#4816 AS cval_customer_c_address_4#4837, cval_customer_c_phone#4817 AS cval_customer_c_phone_4#4838, cval_customer_c_acctbal#4818 AS cval_customer_c_acctbal_4#4839, cval_customer_c_comment#4819 AS cval_customer_c_comment_4#4840, cval_customer_c_mktsegment#4820 AS cval_customer_c_mktsegment_4#4841, cdepval_customer_c_name#4821 AS cdepval_customer_c_name_4#4842, cdepval_customer_c_address#4822 AS cdepval_customer_c_address_4#4843, cdepval_customer_c_phone#4823 AS cdepval_customer_c_phone_4#4844, cdepval_customer_c_acctbal#4824 AS cdepval_customer_c_acctbal_4#4845, cdepval_customer_c_comment#4825 AS cdepval_customer_c_comment_4#4846, cdepval_customer_c_mktsegment#4826 AS cdepval_customer_c_mktsegment_4#4847, cc_name#4827 AS cc_name_4#4848, cc_address#4828 AS cc_address_4#4849, cc_phone#4829 AS cc_phone_4#4850, cc_acctbal#4830 AS cc_acctbal_4#4851, cc_comment#4831 AS cc_comment_4#4852, cc_mktsegment#4832 AS cc_mktsegment_4#4853]
               :  +- Relation[rid#4812,cpfk_nation_customer#4813,cfpk_customer_nation#4814,cval_customer_c_name#4815,cval_customer_c_address#4816,cval_customer_c_phone#4817,cval_customer_c_acctbal#4818,cval_customer_c_comment#4819,cval_customer_c_mktsegment#4820,cdepval_customer_c_name#4821,cdepval_customer_c_address#4822,cdepval_customer_c_phone#4823,cdepval_customer_c_acctbal#4824,cdepval_customer_c_comment#4825,cdepval_customer_c_mktsegment#4826,cc_name#4827,cc_address#4828,cc_phone#4829,cc_acctbal#4830,cc_comment#4831,cc_mktsegment#4832] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
                  +- Project [rid#4776 AS rid_3#4785, cpfk_region_nation#4777 AS cpfk_region_nation_3#4786, cfpk_nation_region#4778 AS cfpk_nation_region_3#4787, cval_nation_n_name#4779 AS cval_nation_n_name_3#4788, cval_nation_n_comment#4780 AS cval_nation_n_comment_3#4789, cdepval_nation_n_name#4781 AS cdepval_nation_n_name_3#4790, cdepval_nation_n_comment#4782 AS cdepval_nation_n_comment_3#4791, cn_name#4783 AS cn_name_3#4792, cn_comment#4784 AS cn_comment_3#4793]
                     +- Relation[rid#4776,cpfk_region_nation#4777,cfpk_nation_region#4778,cval_nation_n_name#4779,cval_nation_n_comment#4780,cdepval_nation_n_name#4781,cdepval_nation_n_comment#4782,cn_name#4783,cn_comment#4784] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 34748ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/25 22:15:47 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:15:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5033L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 22:15:47 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:15:47 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:15:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:15:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:15:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:15:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:15:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:15:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:15:47 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:15:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:15:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5033L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :  :- Project [rid#5135 AS rid_1#5149, cpfk_part_partsupp#5136 AS cpfk_part_partsupp_1#5150, cfpk_partsupp_part#5137 AS cfpk_partsupp_part_1#5151, cpfk_supplier_partsupp#5138 AS cpfk_supplier_partsupp_1#5152, cfpk_partsupp_supplier#5139 AS cfpk_partsupp_supplier_1#5153, cval_partsupp_ps_availqty#5140 AS cval_partsupp_ps_availqty_1#5154, cval_partsupp_ps_supplycost#5141 AS cval_partsupp_ps_supplycost_1#5155, cval_partsupp_ps_comment#5142 AS cval_partsupp_ps_comment_1#5156, cdepval_partsupp_ps_availqty#5143 AS cdepval_partsupp_ps_availqty_1#5157, cdepval_partsupp_ps_supplycost#5144 AS cdepval_partsupp_ps_supplycost_1#5158, cdepval_partsupp_ps_comment#5145 AS cdepval_partsupp_ps_comment_1#5159, cps_availqty#5146 AS cps_availqty_1#5160, cps_supplycost#5147 AS cps_supplycost_1#5161, cps_comment#5148 AS cps_comment_1#5162]
         :  :  +- Relation[rid#5135,cpfk_part_partsupp#5136,cfpk_partsupp_part#5137,cpfk_supplier_partsupp#5138,cfpk_partsupp_supplier#5139,cval_partsupp_ps_availqty#5140,cval_partsupp_ps_supplycost#5141,cval_partsupp_ps_comment#5142,cdepval_partsupp_ps_availqty#5143,cdepval_partsupp_ps_supplycost#5144,cdepval_partsupp_ps_comment#5145,cps_availqty#5146,cps_supplycost#5147,cps_comment#5148] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :     +- Project [rid#5035 AS rid_0#5060, cval_part_p_name#5036 AS cval_part_p_name_0#5061, cval_part_p_mfgr#5037 AS cval_part_p_mfgr_0#5062, cval_part_p_type#5038 AS cval_part_p_type_0#5063, cval_part_p_size#5039 AS cval_part_p_size_0#5064, cval_part_p_container#5040 AS cval_part_p_container_0#5065, cval_part_p_retailprice#5041 AS cval_part_p_retailprice_0#5066, cval_part_p_comment#5042 AS cval_part_p_comment_0#5067, cval_part_p_brand#5043 AS cval_part_p_brand_0#5068, cdepval_part_p_name#5044 AS cdepval_part_p_name_0#5069, cdepval_part_p_mfgr#5045 AS cdepval_part_p_mfgr_0#5070, cdepval_part_p_type#5046 AS cdepval_part_p_type_0#5071, cdepval_part_p_size#5047 AS cdepval_part_p_size_0#5072, cdepval_part_p_container#5048 AS cdepval_part_p_container_0#5073, cdepval_part_p_retailprice#5049 AS cdepval_part_p_retailprice_0#5074, cdepval_part_p_comment#5050 AS cdepval_part_p_comment_0#5075, cdepval_part_p_brand#5051 AS cdepval_part_p_brand_0#5076, cp_name#5052 AS cp_name_0#5077, cp_mfgr#5053 AS cp_mfgr_0#5078, cp_type#5054 AS cp_type_0#5079, cp_size#5055 AS cp_size_0#5080, cp_container#5056 AS cp_container_0#5081, cp_retailprice#5057 AS cp_retailprice_0#5082, cp_comment#5058 AS cp_comment_0#5083, cp_brand#5059 AS cp_brand_0#5084]
         :        +- Relation[rid#5035,cval_part_p_name#5036,cval_part_p_mfgr#5037,cval_part_p_type#5038,cval_part_p_size#5039,cval_part_p_container#5040,cval_part_p_retailprice#5041,cval_part_p_comment#5042,cval_part_p_brand#5043,cdepval_part_p_name#5044,cdepval_part_p_mfgr#5045,cdepval_part_p_type#5046,cdepval_part_p_size#5047,cdepval_part_p_container#5048,cdepval_part_p_retailprice#5049,cdepval_part_p_comment#5050,cdepval_part_p_brand#5051,cp_name#5052,cp_mfgr#5053,cp_type#5054,cp_size#5055,cp_container#5056,cp_retailprice#5057,cp_comment#5058,cp_brand#5059] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_2)
            :- Project [rid#5199 AS rid_3#5217, cpfk_nation_supplier#5200 AS cpfk_nation_supplier_3#5218, cfpk_supplier_nation#5201 AS cfpk_supplier_nation_3#5219, cval_supplier_s_name#5202 AS cval_supplier_s_name_3#5220, cval_supplier_s_address#5203 AS cval_supplier_s_address_3#5221, cval_supplier_s_phone#5204 AS cval_supplier_s_phone_3#5222, cval_supplier_s_acctbal#5205 AS cval_supplier_s_acctbal_3#5223, cval_supplier_s_comment#5206 AS cval_supplier_s_comment_3#5224, cdepval_supplier_s_name#5207 AS cdepval_supplier_s_name_3#5225, cdepval_supplier_s_address#5208 AS cdepval_supplier_s_address_3#5226, cdepval_supplier_s_phone#5209 AS cdepval_supplier_s_phone_3#5227, cdepval_supplier_s_acctbal#5210 AS cdepval_supplier_s_acctbal_3#5228, cdepval_supplier_s_comment#5211 AS cdepval_supplier_s_comment_3#5229, cs_name#5212 AS cs_name_3#5230, cs_address#5213 AS cs_address_3#5231, cs_phone#5214 AS cs_phone_3#5232, cs_acctbal#5215 AS cs_acctbal_3#5233, cs_comment#5216 AS cs_comment_3#5234]
            :  +- Relation[rid#5199,cpfk_nation_supplier#5200,cfpk_supplier_nation#5201,cval_supplier_s_name#5202,cval_supplier_s_address#5203,cval_supplier_s_phone#5204,cval_supplier_s_acctbal#5205,cval_supplier_s_comment#5206,cdepval_supplier_s_name#5207,cdepval_supplier_s_address#5208,cdepval_supplier_s_phone#5209,cdepval_supplier_s_acctbal#5210,cdepval_supplier_s_comment#5211,cs_name#5212,cs_address#5213,cs_phone#5214,cs_acctbal#5215,cs_comment#5216] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
               +- Project [rid#5163 AS rid_2#5172, cpfk_region_nation#5164 AS cpfk_region_nation_2#5173, cfpk_nation_region#5165 AS cfpk_nation_region_2#5174, cval_nation_n_name#5166 AS cval_nation_n_name_2#5175, cval_nation_n_comment#5167 AS cval_nation_n_comment_2#5176, cdepval_nation_n_name#5168 AS cdepval_nation_n_name_2#5177, cdepval_nation_n_comment#5169 AS cdepval_nation_n_comment_2#5178, cn_name#5170 AS cn_name_2#5179, cn_comment#5171 AS cn_comment_2#5180]
                  +- Relation[rid#5163,cpfk_region_nation#5164,cfpk_nation_region#5165,cval_nation_n_name#5166,cval_nation_n_comment#5167,cdepval_nation_n_name#5168,cdepval_nation_n_comment#5169,cn_name#5170,cn_comment#5171] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 3865ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/25 22:15:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:15:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5305L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:15:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5305L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#5307 AS rid_0#5352, cpfk_orders_lineitem#5308 AS cpfk_orders_lineitem_0#5353, cpfk_supplier_lineitem#5309 AS cpfk_supplier_lineitem_0#5354, cfpk_lineitem_supplier#5310 AS cfpk_lineitem_supplier_0#5355, cfpk_lineitem_partsupp#5311 AS cfpk_lineitem_partsupp_0#5356, cpfk_part_lineitem#5312 AS cpfk_part_lineitem_0#5357, cfpk_lineitem_part#5313 AS cfpk_lineitem_part_0#5358, cpfk_partsupp_lineitem#5314 AS cpfk_partsupp_lineitem_0#5359, cfpk_lineitem_orders#5315 AS cfpk_lineitem_orders_0#5360, cval_lineitem_l_quantity#5316 AS cval_lineitem_l_quantity_0#5361, cval_lineitem_l_extendedprice#5317 AS cval_lineitem_l_extendedprice_0#5362, cval_lineitem_l_discount#5318 AS cval_lineitem_l_discount_0#5363, cval_lineitem_l_tax#5319 AS cval_lineitem_l_tax_0#5364, cval_lineitem_l_returnflag#5320 AS cval_lineitem_l_returnflag_0#5365, cval_lineitem_l_linestatus#5321 AS cval_lineitem_l_linestatus_0#5366, cval_lineitem_l_commitdate#5322 AS cval_lineitem_l_commitdate_0#5367, cval_lineitem_l_receiptdate#5323 AS cval_lineitem_l_receiptdate_0#5368, cval_lineitem_l_shipinstruct#5324 AS cval_lineitem_l_shipinstruct_0#5369, cval_lineitem_l_shipmode#5325 AS cval_lineitem_l_shipmode_0#5370, cval_lineitem_l_comment#5326 AS cval_lineitem_l_comment_0#5371, cval_lineitem_l_shipdate#5327 AS cval_lineitem_l_shipdate_0#5372, cdepval_lineitem_l_quantity#5328 AS cdepval_lineitem_l_quantity_0#5373, cdepval_lineitem_l_extendedprice#5329 AS cdepval_lineitem_l_extendedprice_0#5374, cdepval_lineitem_l_discount#5330 AS cdepval_lineitem_l_discount_0#5375, ... 21 more fields]
         :     +- Relation[rid#5307,cpfk_orders_lineitem#5308,cpfk_supplier_lineitem#5309,cfpk_lineitem_supplier#5310,cfpk_lineitem_partsupp#5311,cpfk_part_lineitem#5312,cfpk_lineitem_part#5313,cpfk_partsupp_lineitem#5314,cfpk_lineitem_orders#5315,cval_lineitem_l_quantity#5316,cval_lineitem_l_extendedprice#5317,cval_lineitem_l_discount#5318,cval_lineitem_l_tax#5319,cval_lineitem_l_returnflag#5320,cval_lineitem_l_linestatus#5321,cval_lineitem_l_commitdate#5322,cval_lineitem_l_receiptdate#5323,cval_lineitem_l_shipinstruct#5324,cval_lineitem_l_shipmode#5325,cval_lineitem_l_comment#5326,cval_lineitem_l_shipdate#5327,cdepval_lineitem_l_quantity#5328,cdepval_lineitem_l_extendedprice#5329,cdepval_lineitem_l_discount#5330,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5487 AS rid_1#5511, cpfk_customer_orders#5488 AS cpfk_customer_orders_1#5512, cfpk_orders_customer#5489 AS cfpk_orders_customer_1#5513, cval_orders_o_orderstatus#5490 AS cval_orders_o_orderstatus_1#5514, cval_orders_o_totalprice#5491 AS cval_orders_o_totalprice_1#5515, cval_orders_o_orderpriority#5492 AS cval_orders_o_orderpriority_1#5516, cval_orders_o_clerk#5493 AS cval_orders_o_clerk_1#5517, cval_orders_o_shippriority#5494 AS cval_orders_o_shippriority_1#5518, cval_orders_o_comment#5495 AS cval_orders_o_comment_1#5519, cval_orders_o_orderdate#5496 AS cval_orders_o_orderdate_1#5520, cdepval_orders_o_orderstatus#5497 AS cdepval_orders_o_orderstatus_1#5521, cdepval_orders_o_totalprice#5498 AS cdepval_orders_o_totalprice_1#5522, cdepval_orders_o_orderpriority#5499 AS cdepval_orders_o_orderpriority_1#5523, cdepval_orders_o_clerk#5500 AS cdepval_orders_o_clerk_1#5524, cdepval_orders_o_shippriority#5501 AS cdepval_orders_o_shippriority_1#5525, cdepval_orders_o_comment#5502 AS cdepval_orders_o_comment_1#5526, cdepval_orders_o_orderdate#5503 AS cdepval_orders_o_orderdate_1#5527, co_orderstatus#5504 AS co_orderstatus_1#5528, co_totalprice#5505 AS co_totalprice_1#5529, co_orderpriority#5506 AS co_orderpriority_1#5530, co_clerk#5507 AS co_clerk_1#5531, co_shippriority#5508 AS co_shippriority_1#5532, co_comment#5509 AS co_comment_1#5533, co_orderdate#5510 AS co_orderdate_1#5534]
            +- Relation[rid#5487,cpfk_customer_orders#5488,cfpk_orders_customer#5489,cval_orders_o_orderstatus#5490,cval_orders_o_totalprice#5491,cval_orders_o_orderpriority#5492,cval_orders_o_clerk#5493,cval_orders_o_shippriority#5494,cval_orders_o_comment#5495,cval_orders_o_orderdate#5496,cdepval_orders_o_orderstatus#5497,cdepval_orders_o_totalprice#5498,cdepval_orders_o_orderpriority#5499,cdepval_orders_o_clerk#5500,cdepval_orders_o_shippriority#5501,cdepval_orders_o_comment#5502,cdepval_orders_o_orderdate#5503,co_orderstatus#5504,co_totalprice#5505,co_orderpriority#5506,co_clerk#5507,co_shippriority#5508,co_comment#5509,co_orderdate#5510] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 22084ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/25 22:16:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:16:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5610L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:16:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:16:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:16:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:16:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:16:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:16:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:16:13 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:16:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:16:13 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:16:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5610L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#5684 AS rid_2#5698, cpfk_part_partsupp#5685 AS cpfk_part_partsupp_2#5699, cfpk_partsupp_part#5686 AS cfpk_partsupp_part_2#5700, cpfk_supplier_partsupp#5687 AS cpfk_supplier_partsupp_2#5701, cfpk_partsupp_supplier#5688 AS cfpk_partsupp_supplier_2#5702, cval_partsupp_ps_availqty#5689 AS cval_partsupp_ps_availqty_2#5703, cval_partsupp_ps_supplycost#5690 AS cval_partsupp_ps_supplycost_2#5704, cval_partsupp_ps_comment#5691 AS cval_partsupp_ps_comment_2#5705, cdepval_partsupp_ps_availqty#5692 AS cdepval_partsupp_ps_availqty_2#5706, cdepval_partsupp_ps_supplycost#5693 AS cdepval_partsupp_ps_supplycost_2#5707, cdepval_partsupp_ps_comment#5694 AS cdepval_partsupp_ps_comment_2#5708, cps_availqty#5695 AS cps_availqty_2#5709, cps_supplycost#5696 AS cps_supplycost_2#5710, cps_comment#5697 AS cps_comment_2#5711]
         :  +- Relation[rid#5684,cpfk_part_partsupp#5685,cfpk_partsupp_part#5686,cpfk_supplier_partsupp#5687,cfpk_partsupp_supplier#5688,cval_partsupp_ps_availqty#5689,cval_partsupp_ps_supplycost#5690,cval_partsupp_ps_comment#5691,cdepval_partsupp_ps_availqty#5692,cdepval_partsupp_ps_supplycost#5693,cdepval_partsupp_ps_comment#5694,cps_availqty#5695,cps_supplycost#5696,cps_comment#5697] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
            :- Project [rid#5648 AS rid_1#5666, cpfk_nation_supplier#5649 AS cpfk_nation_supplier_1#5667, cfpk_supplier_nation#5650 AS cfpk_supplier_nation_1#5668, cval_supplier_s_name#5651 AS cval_supplier_s_name_1#5669, cval_supplier_s_address#5652 AS cval_supplier_s_address_1#5670, cval_supplier_s_phone#5653 AS cval_supplier_s_phone_1#5671, cval_supplier_s_acctbal#5654 AS cval_supplier_s_acctbal_1#5672, cval_supplier_s_comment#5655 AS cval_supplier_s_comment_1#5673, cdepval_supplier_s_name#5656 AS cdepval_supplier_s_name_1#5674, cdepval_supplier_s_address#5657 AS cdepval_supplier_s_address_1#5675, cdepval_supplier_s_phone#5658 AS cdepval_supplier_s_phone_1#5676, cdepval_supplier_s_acctbal#5659 AS cdepval_supplier_s_acctbal_1#5677, cdepval_supplier_s_comment#5660 AS cdepval_supplier_s_comment_1#5678, cs_name#5661 AS cs_name_1#5679, cs_address#5662 AS cs_address_1#5680, cs_phone#5663 AS cs_phone_1#5681, cs_acctbal#5664 AS cs_acctbal_1#5682, cs_comment#5665 AS cs_comment_1#5683]
            :  +- Relation[rid#5648,cpfk_nation_supplier#5649,cfpk_supplier_nation#5650,cval_supplier_s_name#5651,cval_supplier_s_address#5652,cval_supplier_s_phone#5653,cval_supplier_s_acctbal#5654,cval_supplier_s_comment#5655,cdepval_supplier_s_name#5656,cdepval_supplier_s_address#5657,cdepval_supplier_s_phone#5658,cdepval_supplier_s_acctbal#5659,cdepval_supplier_s_comment#5660,cs_name#5661,cs_address#5662,cs_phone#5663,cs_acctbal#5664,cs_comment#5665] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
               +- Project [rid#5612 AS rid_0#5621, cpfk_region_nation#5613 AS cpfk_region_nation_0#5622, cfpk_nation_region#5614 AS cfpk_nation_region_0#5623, cval_nation_n_name#5615 AS cval_nation_n_name_0#5624, cval_nation_n_comment#5616 AS cval_nation_n_comment_0#5625, cdepval_nation_n_name#5617 AS cdepval_nation_n_name_0#5626, cdepval_nation_n_comment#5618 AS cdepval_nation_n_comment_0#5627, cn_name#5619 AS cn_name_0#5628, cn_comment#5620 AS cn_comment_0#5629]
                  +- Relation[rid#5612,cpfk_region_nation#5613,cfpk_nation_region#5614,cval_nation_n_name#5615,cval_nation_n_comment#5616,cdepval_nation_n_name#5617,cdepval_nation_n_comment#5618,cn_name#5619,cn_comment#5620] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 3528ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/25 22:16:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:16:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5757L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:16:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:16:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:16:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:16:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:16:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:16:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:16:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:16:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:16:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:16:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:16:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:16:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:16:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:16:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5757L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_part_4) = 'rid_3)
         :  :- Project [rid#5941 AS rid_4#5955, cpfk_part_partsupp#5942 AS cpfk_part_partsupp_4#5956, cfpk_partsupp_part#5943 AS cfpk_partsupp_part_4#5957, cpfk_supplier_partsupp#5944 AS cpfk_supplier_partsupp_4#5958, cfpk_partsupp_supplier#5945 AS cfpk_partsupp_supplier_4#5959, cval_partsupp_ps_availqty#5946 AS cval_partsupp_ps_availqty_4#5960, cval_partsupp_ps_supplycost#5947 AS cval_partsupp_ps_supplycost_4#5961, cval_partsupp_ps_comment#5948 AS cval_partsupp_ps_comment_4#5962, cdepval_partsupp_ps_availqty#5949 AS cdepval_partsupp_ps_availqty_4#5963, cdepval_partsupp_ps_supplycost#5950 AS cdepval_partsupp_ps_supplycost_4#5964, cdepval_partsupp_ps_comment#5951 AS cdepval_partsupp_ps_comment_4#5965, cps_availqty#5952 AS cps_availqty_4#5966, cps_supplycost#5953 AS cps_supplycost_4#5967, cps_comment#5954 AS cps_comment_4#5968]
         :  :  +- Relation[rid#5941,cpfk_part_partsupp#5942,cfpk_partsupp_part#5943,cpfk_supplier_partsupp#5944,cfpk_partsupp_supplier#5945,cval_partsupp_ps_availqty#5946,cval_partsupp_ps_supplycost#5947,cval_partsupp_ps_comment#5948,cdepval_partsupp_ps_availqty#5949,cdepval_partsupp_ps_supplycost#5950,cdepval_partsupp_ps_comment#5951,cps_availqty#5952,cps_supplycost#5953,cps_comment#5954] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :     +- Project [rid#5841 AS rid_3#5866, cval_part_p_name#5842 AS cval_part_p_name_3#5867, cval_part_p_mfgr#5843 AS cval_part_p_mfgr_3#5868, cval_part_p_type#5844 AS cval_part_p_type_3#5869, cval_part_p_size#5845 AS cval_part_p_size_3#5870, cval_part_p_container#5846 AS cval_part_p_container_3#5871, cval_part_p_retailprice#5847 AS cval_part_p_retailprice_3#5872, cval_part_p_comment#5848 AS cval_part_p_comment_3#5873, cval_part_p_brand#5849 AS cval_part_p_brand_3#5874, cdepval_part_p_name#5850 AS cdepval_part_p_name_3#5875, cdepval_part_p_mfgr#5851 AS cdepval_part_p_mfgr_3#5876, cdepval_part_p_type#5852 AS cdepval_part_p_type_3#5877, cdepval_part_p_size#5853 AS cdepval_part_p_size_3#5878, cdepval_part_p_container#5854 AS cdepval_part_p_container_3#5879, cdepval_part_p_retailprice#5855 AS cdepval_part_p_retailprice_3#5880, cdepval_part_p_comment#5856 AS cdepval_part_p_comment_3#5881, cdepval_part_p_brand#5857 AS cdepval_part_p_brand_3#5882, cp_name#5858 AS cp_name_3#5883, cp_mfgr#5859 AS cp_mfgr_3#5884, cp_type#5860 AS cp_type_3#5885, cp_size#5861 AS cp_size_3#5886, cp_container#5862 AS cp_container_3#5887, cp_retailprice#5863 AS cp_retailprice_3#5888, cp_comment#5864 AS cp_comment_3#5889, cp_brand#5865 AS cp_brand_3#5890]
         :        +- Relation[rid#5841,cval_part_p_name#5842,cval_part_p_mfgr#5843,cval_part_p_type#5844,cval_part_p_size#5845,cval_part_p_container#5846,cval_part_p_retailprice#5847,cval_part_p_comment#5848,cval_part_p_brand#5849,cdepval_part_p_name#5850,cdepval_part_p_mfgr#5851,cdepval_part_p_type#5852,cdepval_part_p_size#5853,cdepval_part_p_container#5854,cdepval_part_p_retailprice#5855,cdepval_part_p_comment#5856,cdepval_part_p_brand#5857,cp_name#5858,cp_mfgr#5859,cp_type#5860,cp_size#5861,cp_container#5862,cp_retailprice#5863,cp_comment#5864,cp_brand#5865] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#5805 AS rid_2#5823, cpfk_nation_supplier#5806 AS cpfk_nation_supplier_2#5824, cfpk_supplier_nation#5807 AS cfpk_supplier_nation_2#5825, cval_supplier_s_name#5808 AS cval_supplier_s_name_2#5826, cval_supplier_s_address#5809 AS cval_supplier_s_address_2#5827, cval_supplier_s_phone#5810 AS cval_supplier_s_phone_2#5828, cval_supplier_s_acctbal#5811 AS cval_supplier_s_acctbal_2#5829, cval_supplier_s_comment#5812 AS cval_supplier_s_comment_2#5830, cdepval_supplier_s_name#5813 AS cdepval_supplier_s_name_2#5831, cdepval_supplier_s_address#5814 AS cdepval_supplier_s_address_2#5832, cdepval_supplier_s_phone#5815 AS cdepval_supplier_s_phone_2#5833, cdepval_supplier_s_acctbal#5816 AS cdepval_supplier_s_acctbal_2#5834, cdepval_supplier_s_comment#5817 AS cdepval_supplier_s_comment_2#5835, cs_name#5818 AS cs_name_2#5836, cs_address#5819 AS cs_address_2#5837, cs_phone#5820 AS cs_phone_2#5838, cs_acctbal#5821 AS cs_acctbal_2#5839, cs_comment#5822 AS cs_comment_2#5840]
            :  +- Relation[rid#5805,cpfk_nation_supplier#5806,cfpk_supplier_nation#5807,cval_supplier_s_name#5808,cval_supplier_s_address#5809,cval_supplier_s_phone#5810,cval_supplier_s_acctbal#5811,cval_supplier_s_comment#5812,cdepval_supplier_s_name#5813,cdepval_supplier_s_address#5814,cdepval_supplier_s_phone#5815,cdepval_supplier_s_acctbal#5816,cdepval_supplier_s_comment#5817,cs_name#5818,cs_address#5819,cs_phone#5820,cs_acctbal#5821,cs_comment#5822] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
               :- Project [rid#5787 AS rid_1#5796, cpfk_region_nation#5788 AS cpfk_region_nation_1#5797, cfpk_nation_region#5789 AS cfpk_nation_region_1#5798, cval_nation_n_name#5790 AS cval_nation_n_name_1#5799, cval_nation_n_comment#5791 AS cval_nation_n_comment_1#5800, cdepval_nation_n_name#5792 AS cdepval_nation_n_name_1#5801, cdepval_nation_n_comment#5793 AS cdepval_nation_n_comment_1#5802, cn_name#5794 AS cn_name_1#5803, cn_comment#5795 AS cn_comment_1#5804]
               :  +- Relation[rid#5787,cpfk_region_nation#5788,cfpk_nation_region#5789,cval_nation_n_name#5790,cval_nation_n_comment#5791,cdepval_nation_n_name#5792,cdepval_nation_n_comment#5793,cn_name#5794,cn_comment#5795] JDBCRelation(tnation) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
                  +- Project [rid#5759 AS rid_0#5766, cval_region_r_name#5760 AS cval_region_r_name_0#5767, cval_region_r_comment#5761 AS cval_region_r_comment_0#5768, cdepval_region_r_name#5762 AS cdepval_region_r_name_0#5769, cdepval_region_r_comment#5763 AS cdepval_region_r_comment_0#5770, cr_name#5764 AS cr_name_0#5771, cr_comment#5765 AS cr_comment_0#5772]
                     +- Relation[rid#5759,cval_region_r_name#5760,cval_region_r_comment#5761,cdepval_region_r_name#5762,cdepval_region_r_comment#5763,cr_name#5764,cr_comment#5765] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 3587ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/25 22:16:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:16:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6049L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:16:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:16:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:16:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:16:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:16:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:16:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:16:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:16:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:16:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:16:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:16:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:16:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:16:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6049L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :  :  :  :- Project [rid#6151 AS rid_1#6196, cpfk_orders_lineitem#6152 AS cpfk_orders_lineitem_1#6197, cpfk_supplier_lineitem#6153 AS cpfk_supplier_lineitem_1#6198, cfpk_lineitem_supplier#6154 AS cfpk_lineitem_supplier_1#6199, cfpk_lineitem_partsupp#6155 AS cfpk_lineitem_partsupp_1#6200, cpfk_part_lineitem#6156 AS cpfk_part_lineitem_1#6201, cfpk_lineitem_part#6157 AS cfpk_lineitem_part_1#6202, cpfk_partsupp_lineitem#6158 AS cpfk_partsupp_lineitem_1#6203, cfpk_lineitem_orders#6159 AS cfpk_lineitem_orders_1#6204, cval_lineitem_l_quantity#6160 AS cval_lineitem_l_quantity_1#6205, cval_lineitem_l_extendedprice#6161 AS cval_lineitem_l_extendedprice_1#6206, cval_lineitem_l_discount#6162 AS cval_lineitem_l_discount_1#6207, cval_lineitem_l_tax#6163 AS cval_lineitem_l_tax_1#6208, cval_lineitem_l_returnflag#6164 AS cval_lineitem_l_returnflag_1#6209, cval_lineitem_l_linestatus#6165 AS cval_lineitem_l_linestatus_1#6210, cval_lineitem_l_commitdate#6166 AS cval_lineitem_l_commitdate_1#6211, cval_lineitem_l_receiptdate#6167 AS cval_lineitem_l_receiptdate_1#6212, cval_lineitem_l_shipinstruct#6168 AS cval_lineitem_l_shipinstruct_1#6213, cval_lineitem_l_shipmode#6169 AS cval_lineitem_l_shipmode_1#6214, cval_lineitem_l_comment#6170 AS cval_lineitem_l_comment_1#6215, cval_lineitem_l_shipdate#6171 AS cval_lineitem_l_shipdate_1#6216, cdepval_lineitem_l_quantity#6172 AS cdepval_lineitem_l_quantity_1#6217, cdepval_lineitem_l_extendedprice#6173 AS cdepval_lineitem_l_extendedprice_1#6218, cdepval_lineitem_l_discount#6174 AS cdepval_lineitem_l_discount_1#6219, ... 21 more fields]
         :  :  :  :  +- Relation[rid#6151,cpfk_orders_lineitem#6152,cpfk_supplier_lineitem#6153,cfpk_lineitem_supplier#6154,cfpk_lineitem_partsupp#6155,cpfk_part_lineitem#6156,cfpk_lineitem_part#6157,cpfk_partsupp_lineitem#6158,cfpk_lineitem_orders#6159,cval_lineitem_l_quantity#6160,cval_lineitem_l_extendedprice#6161,cval_lineitem_l_discount#6162,cval_lineitem_l_tax#6163,cval_lineitem_l_returnflag#6164,cval_lineitem_l_linestatus#6165,cval_lineitem_l_commitdate#6166,cval_lineitem_l_receiptdate#6167,cval_lineitem_l_shipinstruct#6168,cval_lineitem_l_shipmode#6169,cval_lineitem_l_comment#6170,cval_lineitem_l_shipdate#6171,cdepval_lineitem_l_quantity#6172,cdepval_lineitem_l_extendedprice#6173,cdepval_lineitem_l_discount#6174,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :     +- Project [rid#6051 AS rid_0#6076, cval_part_p_name#6052 AS cval_part_p_name_0#6077, cval_part_p_mfgr#6053 AS cval_part_p_mfgr_0#6078, cval_part_p_type#6054 AS cval_part_p_type_0#6079, cval_part_p_size#6055 AS cval_part_p_size_0#6080, cval_part_p_container#6056 AS cval_part_p_container_0#6081, cval_part_p_retailprice#6057 AS cval_part_p_retailprice_0#6082, cval_part_p_comment#6058 AS cval_part_p_comment_0#6083, cval_part_p_brand#6059 AS cval_part_p_brand_0#6084, cdepval_part_p_name#6060 AS cdepval_part_p_name_0#6085, cdepval_part_p_mfgr#6061 AS cdepval_part_p_mfgr_0#6086, cdepval_part_p_type#6062 AS cdepval_part_p_type_0#6087, cdepval_part_p_size#6063 AS cdepval_part_p_size_0#6088, cdepval_part_p_container#6064 AS cdepval_part_p_container_0#6089, cdepval_part_p_retailprice#6065 AS cdepval_part_p_retailprice_0#6090, cdepval_part_p_comment#6066 AS cdepval_part_p_comment_0#6091, cdepval_part_p_brand#6067 AS cdepval_part_p_brand_0#6092, cp_name#6068 AS cp_name_0#6093, cp_mfgr#6069 AS cp_mfgr_0#6094, cp_type#6070 AS cp_type_0#6095, cp_size#6071 AS cp_size_0#6096, cp_container#6072 AS cp_container_0#6097, cp_retailprice#6073 AS cp_retailprice_0#6098, cp_comment#6074 AS cp_comment_0#6099, cp_brand#6075 AS cp_brand_0#6100]
         :  :  :        +- Relation[rid#6051,cval_part_p_name#6052,cval_part_p_mfgr#6053,cval_part_p_type#6054,cval_part_p_size#6055,cval_part_p_container#6056,cval_part_p_retailprice#6057,cval_part_p_comment#6058,cval_part_p_brand#6059,cdepval_part_p_name#6060,cdepval_part_p_mfgr#6061,cdepval_part_p_type#6062,cdepval_part_p_size#6063,cdepval_part_p_container#6064,cdepval_part_p_retailprice#6065,cdepval_part_p_comment#6066,cdepval_part_p_brand#6067,cp_name#6068,cp_mfgr#6069,cp_type#6070,cp_size#6071,cp_container#6072,cp_retailprice#6073,cp_comment#6074,cp_brand#6075] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- Project [rid#6241 AS rid_2#6259, cpfk_nation_supplier#6242 AS cpfk_nation_supplier_2#6260, cfpk_supplier_nation#6243 AS cfpk_supplier_nation_2#6261, cval_supplier_s_name#6244 AS cval_supplier_s_name_2#6262, cval_supplier_s_address#6245 AS cval_supplier_s_address_2#6263, cval_supplier_s_phone#6246 AS cval_supplier_s_phone_2#6264, cval_supplier_s_acctbal#6247 AS cval_supplier_s_acctbal_2#6265, cval_supplier_s_comment#6248 AS cval_supplier_s_comment_2#6266, cdepval_supplier_s_name#6249 AS cdepval_supplier_s_name_2#6267, cdepval_supplier_s_address#6250 AS cdepval_supplier_s_address_2#6268, cdepval_supplier_s_phone#6251 AS cdepval_supplier_s_phone_2#6269, cdepval_supplier_s_acctbal#6252 AS cdepval_supplier_s_acctbal_2#6270, cdepval_supplier_s_comment#6253 AS cdepval_supplier_s_comment_2#6271, cs_name#6254 AS cs_name_2#6272, cs_address#6255 AS cs_address_2#6273, cs_phone#6256 AS cs_phone_2#6274, cs_acctbal#6257 AS cs_acctbal_2#6275, cs_comment#6258 AS cs_comment_2#6276]
         :  :     +- Relation[rid#6241,cpfk_nation_supplier#6242,cfpk_supplier_nation#6243,cval_supplier_s_name#6244,cval_supplier_s_address#6245,cval_supplier_s_phone#6246,cval_supplier_s_acctbal#6247,cval_supplier_s_comment#6248,cdepval_supplier_s_name#6249,cdepval_supplier_s_address#6250,cdepval_supplier_s_phone#6251,cdepval_supplier_s_acctbal#6252,cdepval_supplier_s_comment#6253,cs_name#6254,cs_address#6255,cs_phone#6256,cs_acctbal#6257,cs_comment#6258] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#6277 AS rid_3#6286, cpfk_region_nation#6278 AS cpfk_region_nation_3#6287, cfpk_nation_region#6279 AS cfpk_nation_region_3#6288, cval_nation_n_name#6280 AS cval_nation_n_name_3#6289, cval_nation_n_comment#6281 AS cval_nation_n_comment_3#6290, cdepval_nation_n_name#6282 AS cdepval_nation_n_name_3#6291, cdepval_nation_n_comment#6283 AS cdepval_nation_n_comment_3#6292, cn_name#6284 AS cn_name_3#6293, cn_comment#6285 AS cn_comment_3#6294]
         :     +- Relation[rid#6277,cpfk_region_nation#6278,cfpk_nation_region#6279,cval_nation_n_name#6280,cval_nation_n_comment#6281,cdepval_nation_n_name#6282,cdepval_nation_n_comment#6283,cn_name#6284,cn_comment#6285] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#6383 AS rid_7#6407, cpfk_customer_orders#6384 AS cpfk_customer_orders_7#6408, cfpk_orders_customer#6385 AS cfpk_orders_customer_7#6409, cval_orders_o_orderstatus#6386 AS cval_orders_o_orderstatus_7#6410, cval_orders_o_totalprice#6387 AS cval_orders_o_totalprice_7#6411, cval_orders_o_orderpriority#6388 AS cval_orders_o_orderpriority_7#6412, cval_orders_o_clerk#6389 AS cval_orders_o_clerk_7#6413, cval_orders_o_shippriority#6390 AS cval_orders_o_shippriority_7#6414, cval_orders_o_comment#6391 AS cval_orders_o_comment_7#6415, cval_orders_o_orderdate#6392 AS cval_orders_o_orderdate_7#6416, cdepval_orders_o_orderstatus#6393 AS cdepval_orders_o_orderstatus_7#6417, cdepval_orders_o_totalprice#6394 AS cdepval_orders_o_totalprice_7#6418, cdepval_orders_o_orderpriority#6395 AS cdepval_orders_o_orderpriority_7#6419, cdepval_orders_o_clerk#6396 AS cdepval_orders_o_clerk_7#6420, cdepval_orders_o_shippriority#6397 AS cdepval_orders_o_shippriority_7#6421, cdepval_orders_o_comment#6398 AS cdepval_orders_o_comment_7#6422, cdepval_orders_o_orderdate#6399 AS cdepval_orders_o_orderdate_7#6423, co_orderstatus#6400 AS co_orderstatus_7#6424, co_totalprice#6401 AS co_totalprice_7#6425, co_orderpriority#6402 AS co_orderpriority_7#6426, co_clerk#6403 AS co_clerk_7#6427, co_shippriority#6404 AS co_shippriority_7#6428, co_comment#6405 AS co_comment_7#6429, co_orderdate#6406 AS co_orderdate_7#6430]
            :  +- Relation[rid#6383,cpfk_customer_orders#6384,cfpk_orders_customer#6385,cval_orders_o_orderstatus#6386,cval_orders_o_totalprice#6387,cval_orders_o_orderpriority#6388,cval_orders_o_clerk#6389,cval_orders_o_shippriority#6390,cval_orders_o_comment#6391,cval_orders_o_orderdate#6392,cdepval_orders_o_orderstatus#6393,cdepval_orders_o_totalprice#6394,cdepval_orders_o_orderpriority#6395,cdepval_orders_o_clerk#6396,cdepval_orders_o_shippriority#6397,cdepval_orders_o_comment#6398,cdepval_orders_o_orderdate#6399,co_orderstatus#6400,co_totalprice#6401,co_orderpriority#6402,co_clerk#6403,co_shippriority#6404,co_comment#6405,co_orderdate#6406] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#6341 AS rid_6#6362, cpfk_nation_customer#6342 AS cpfk_nation_customer_6#6363, cfpk_customer_nation#6343 AS cfpk_customer_nation_6#6364, cval_customer_c_name#6344 AS cval_customer_c_name_6#6365, cval_customer_c_address#6345 AS cval_customer_c_address_6#6366, cval_customer_c_phone#6346 AS cval_customer_c_phone_6#6367, cval_customer_c_acctbal#6347 AS cval_customer_c_acctbal_6#6368, cval_customer_c_comment#6348 AS cval_customer_c_comment_6#6369, cval_customer_c_mktsegment#6349 AS cval_customer_c_mktsegment_6#6370, cdepval_customer_c_name#6350 AS cdepval_customer_c_name_6#6371, cdepval_customer_c_address#6351 AS cdepval_customer_c_address_6#6372, cdepval_customer_c_phone#6352 AS cdepval_customer_c_phone_6#6373, cdepval_customer_c_acctbal#6353 AS cdepval_customer_c_acctbal_6#6374, cdepval_customer_c_comment#6354 AS cdepval_customer_c_comment_6#6375, cdepval_customer_c_mktsegment#6355 AS cdepval_customer_c_mktsegment_6#6376, cc_name#6356 AS cc_name_6#6377, cc_address#6357 AS cc_address_6#6378, cc_phone#6358 AS cc_phone_6#6379, cc_acctbal#6359 AS cc_acctbal_6#6380, cc_comment#6360 AS cc_comment_6#6381, cc_mktsegment#6361 AS cc_mktsegment_6#6382]
               :  +- Relation[rid#6341,cpfk_nation_customer#6342,cfpk_customer_nation#6343,cval_customer_c_name#6344,cval_customer_c_address#6345,cval_customer_c_phone#6346,cval_customer_c_acctbal#6347,cval_customer_c_comment#6348,cval_customer_c_mktsegment#6349,cdepval_customer_c_name#6350,cdepval_customer_c_address#6351,cdepval_customer_c_phone#6352,cdepval_customer_c_acctbal#6353,cdepval_customer_c_comment#6354,cdepval_customer_c_mktsegment#6355,cc_name#6356,cc_address#6357,cc_phone#6358,cc_acctbal#6359,cc_comment#6360,cc_mktsegment#6361] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_5, BinaryType)), 'cfpk_nation_region_5) = 'rid_4)
                  :- Project [rid#6323 AS rid_5#6332, cpfk_region_nation#6324 AS cpfk_region_nation_5#6333, cfpk_nation_region#6325 AS cfpk_nation_region_5#6334, cval_nation_n_name#6326 AS cval_nation_n_name_5#6335, cval_nation_n_comment#6327 AS cval_nation_n_comment_5#6336, cdepval_nation_n_name#6328 AS cdepval_nation_n_name_5#6337, cdepval_nation_n_comment#6329 AS cdepval_nation_n_comment_5#6338, cn_name#6330 AS cn_name_5#6339, cn_comment#6331 AS cn_comment_5#6340]
                  :  +- Relation[rid#6323,cpfk_region_nation#6324,cfpk_nation_region#6325,cval_nation_n_name#6326,cval_nation_n_comment#6327,cdepval_nation_n_name#6328,cdepval_nation_n_comment#6329,cn_name#6330,cn_comment#6331] JDBCRelation(tnation) [numPartitions=1]
                  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                     +- Project [rid#6295 AS rid_4#6302, cval_region_r_name#6296 AS cval_region_r_name_4#6303, cval_region_r_comment#6297 AS cval_region_r_comment_4#6304, cdepval_region_r_name#6298 AS cdepval_region_r_name_4#6305, cdepval_region_r_comment#6299 AS cdepval_region_r_comment_4#6306, cr_name#6300 AS cr_name_4#6307, cr_comment#6301 AS cr_comment_4#6308]
                        +- Relation[rid#6295,cval_region_r_name#6296,cval_region_r_comment#6297,cdepval_region_r_name#6298,cdepval_region_r_comment#6299,cr_name#6300,cr_comment#6301] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 44841ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/25 22:17:05 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:17:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6593L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:17:05 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:17:05 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:17:05 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:17:05 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:17:05 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:17:05 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:17:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6593L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#6745 AS rid_1#6790, cpfk_orders_lineitem#6746 AS cpfk_orders_lineitem_1#6791, cpfk_supplier_lineitem#6747 AS cpfk_supplier_lineitem_1#6792, cfpk_lineitem_supplier#6748 AS cfpk_lineitem_supplier_1#6793, cfpk_lineitem_partsupp#6749 AS cfpk_lineitem_partsupp_1#6794, cpfk_part_lineitem#6750 AS cpfk_part_lineitem_1#6795, cfpk_lineitem_part#6751 AS cfpk_lineitem_part_1#6796, cpfk_partsupp_lineitem#6752 AS cpfk_partsupp_lineitem_1#6797, cfpk_lineitem_orders#6753 AS cfpk_lineitem_orders_1#6798, cval_lineitem_l_quantity#6754 AS cval_lineitem_l_quantity_1#6799, cval_lineitem_l_extendedprice#6755 AS cval_lineitem_l_extendedprice_1#6800, cval_lineitem_l_discount#6756 AS cval_lineitem_l_discount_1#6801, cval_lineitem_l_tax#6757 AS cval_lineitem_l_tax_1#6802, cval_lineitem_l_returnflag#6758 AS cval_lineitem_l_returnflag_1#6803, cval_lineitem_l_linestatus#6759 AS cval_lineitem_l_linestatus_1#6804, cval_lineitem_l_commitdate#6760 AS cval_lineitem_l_commitdate_1#6805, cval_lineitem_l_receiptdate#6761 AS cval_lineitem_l_receiptdate_1#6806, cval_lineitem_l_shipinstruct#6762 AS cval_lineitem_l_shipinstruct_1#6807, cval_lineitem_l_shipmode#6763 AS cval_lineitem_l_shipmode_1#6808, cval_lineitem_l_comment#6764 AS cval_lineitem_l_comment_1#6809, cval_lineitem_l_shipdate#6765 AS cval_lineitem_l_shipdate_1#6810, cdepval_lineitem_l_quantity#6766 AS cdepval_lineitem_l_quantity_1#6811, cdepval_lineitem_l_extendedprice#6767 AS cdepval_lineitem_l_extendedprice_1#6812, cdepval_lineitem_l_discount#6768 AS cdepval_lineitem_l_discount_1#6813, ... 21 more fields]
         :  +- Relation[rid#6745,cpfk_orders_lineitem#6746,cpfk_supplier_lineitem#6747,cfpk_lineitem_supplier#6748,cfpk_lineitem_partsupp#6749,cpfk_part_lineitem#6750,cfpk_lineitem_part#6751,cpfk_partsupp_lineitem#6752,cfpk_lineitem_orders#6753,cval_lineitem_l_quantity#6754,cval_lineitem_l_extendedprice#6755,cval_lineitem_l_discount#6756,cval_lineitem_l_tax#6757,cval_lineitem_l_returnflag#6758,cval_lineitem_l_linestatus#6759,cval_lineitem_l_commitdate#6760,cval_lineitem_l_receiptdate#6761,cval_lineitem_l_shipinstruct#6762,cval_lineitem_l_shipmode#6763,cval_lineitem_l_comment#6764,cval_lineitem_l_shipdate#6765,cdepval_lineitem_l_quantity#6766,cdepval_lineitem_l_extendedprice#6767,cdepval_lineitem_l_discount#6768,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
               +- Project [rid#6595 AS rid_0#6620, cval_part_p_name#6596 AS cval_part_p_name_0#6621, cval_part_p_mfgr#6597 AS cval_part_p_mfgr_0#6622, cval_part_p_type#6598 AS cval_part_p_type_0#6623, cval_part_p_size#6599 AS cval_part_p_size_0#6624, cval_part_p_container#6600 AS cval_part_p_container_0#6625, cval_part_p_retailprice#6601 AS cval_part_p_retailprice_0#6626, cval_part_p_comment#6602 AS cval_part_p_comment_0#6627, cval_part_p_brand#6603 AS cval_part_p_brand_0#6628, cdepval_part_p_name#6604 AS cdepval_part_p_name_0#6629, cdepval_part_p_mfgr#6605 AS cdepval_part_p_mfgr_0#6630, cdepval_part_p_type#6606 AS cdepval_part_p_type_0#6631, cdepval_part_p_size#6607 AS cdepval_part_p_size_0#6632, cdepval_part_p_container#6608 AS cdepval_part_p_container_0#6633, cdepval_part_p_retailprice#6609 AS cdepval_part_p_retailprice_0#6634, cdepval_part_p_comment#6610 AS cdepval_part_p_comment_0#6635, cdepval_part_p_brand#6611 AS cdepval_part_p_brand_0#6636, cp_name#6612 AS cp_name_0#6637, cp_mfgr#6613 AS cp_mfgr_0#6638, cp_type#6614 AS cp_type_0#6639, cp_size#6615 AS cp_size_0#6640, cp_container#6616 AS cp_container_0#6641, cp_retailprice#6617 AS cp_retailprice_0#6642, cp_comment#6618 AS cp_comment_0#6643, cp_brand#6619 AS cp_brand_0#6644]
                  +- Relation[rid#6595,cval_part_p_name#6596,cval_part_p_mfgr#6597,cval_part_p_type#6598,cval_part_p_size#6599,cval_part_p_container#6600,cval_part_p_retailprice#6601,cval_part_p_comment#6602,cval_part_p_brand#6603,cdepval_part_p_name#6604,cdepval_part_p_mfgr#6605,cdepval_part_p_type#6606,cdepval_part_p_size#6607,cdepval_part_p_container#6608,cdepval_part_p_retailprice#6609,cdepval_part_p_comment#6610,cdepval_part_p_brand#6611,cp_name#6612,cp_mfgr#6613,cp_type#6614,cp_size#6615,cp_container#6616,cp_retailprice#6617,cp_comment#6618,cp_brand#6619] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 26006ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/25 22:17:31 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:17:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6912L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:17:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:17:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:17:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6912L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :- Project [rid#7014 AS rid_1#7028, cpfk_part_partsupp#7015 AS cpfk_part_partsupp_1#7029, cfpk_partsupp_part#7016 AS cfpk_partsupp_part_1#7030, cpfk_supplier_partsupp#7017 AS cpfk_supplier_partsupp_1#7031, cfpk_partsupp_supplier#7018 AS cfpk_partsupp_supplier_1#7032, cval_partsupp_ps_availqty#7019 AS cval_partsupp_ps_availqty_1#7033, cval_partsupp_ps_supplycost#7020 AS cval_partsupp_ps_supplycost_1#7034, cval_partsupp_ps_comment#7021 AS cval_partsupp_ps_comment_1#7035, cdepval_partsupp_ps_availqty#7022 AS cdepval_partsupp_ps_availqty_1#7036, cdepval_partsupp_ps_supplycost#7023 AS cdepval_partsupp_ps_supplycost_1#7037, cdepval_partsupp_ps_comment#7024 AS cdepval_partsupp_ps_comment_1#7038, cps_availqty#7025 AS cps_availqty_1#7039, cps_supplycost#7026 AS cps_supplycost_1#7040, cps_comment#7027 AS cps_comment_1#7041]
         :  +- Relation[rid#7014,cpfk_part_partsupp#7015,cfpk_partsupp_part#7016,cpfk_supplier_partsupp#7017,cfpk_partsupp_supplier#7018,cval_partsupp_ps_availqty#7019,cval_partsupp_ps_supplycost#7020,cval_partsupp_ps_comment#7021,cdepval_partsupp_ps_availqty#7022,cdepval_partsupp_ps_supplycost#7023,cdepval_partsupp_ps_comment#7024,cps_availqty#7025,cps_supplycost#7026,cps_comment#7027] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
            +- Project [rid#6914 AS rid_0#6939, cval_part_p_name#6915 AS cval_part_p_name_0#6940, cval_part_p_mfgr#6916 AS cval_part_p_mfgr_0#6941, cval_part_p_type#6917 AS cval_part_p_type_0#6942, cval_part_p_size#6918 AS cval_part_p_size_0#6943, cval_part_p_container#6919 AS cval_part_p_container_0#6944, cval_part_p_retailprice#6920 AS cval_part_p_retailprice_0#6945, cval_part_p_comment#6921 AS cval_part_p_comment_0#6946, cval_part_p_brand#6922 AS cval_part_p_brand_0#6947, cdepval_part_p_name#6923 AS cdepval_part_p_name_0#6948, cdepval_part_p_mfgr#6924 AS cdepval_part_p_mfgr_0#6949, cdepval_part_p_type#6925 AS cdepval_part_p_type_0#6950, cdepval_part_p_size#6926 AS cdepval_part_p_size_0#6951, cdepval_part_p_container#6927 AS cdepval_part_p_container_0#6952, cdepval_part_p_retailprice#6928 AS cdepval_part_p_retailprice_0#6953, cdepval_part_p_comment#6929 AS cdepval_part_p_comment_0#6954, cdepval_part_p_brand#6930 AS cdepval_part_p_brand_0#6955, cp_name#6931 AS cp_name_0#6956, cp_mfgr#6932 AS cp_mfgr_0#6957, cp_type#6933 AS cp_type_0#6958, cp_size#6934 AS cp_size_0#6959, cp_container#6935 AS cp_container_0#6960, cp_retailprice#6936 AS cp_retailprice_0#6961, cp_comment#6937 AS cp_comment_0#6962, cp_brand#6938 AS cp_brand_0#6963]
               +- Relation[rid#6914,cval_part_p_name#6915,cval_part_p_mfgr#6916,cval_part_p_type#6917,cval_part_p_size#6918,cval_part_p_container#6919,cval_part_p_retailprice#6920,cval_part_p_comment#6921,cval_part_p_brand#6922,cdepval_part_p_name#6923,cdepval_part_p_mfgr#6924,cdepval_part_p_type#6925,cdepval_part_p_size#6926,cdepval_part_p_container#6927,cdepval_part_p_retailprice#6928,cdepval_part_p_comment#6929,cdepval_part_p_brand#6930,cp_name#6931,cp_mfgr#6932,cp_type#6933,cp_size#6934,cp_container#6935,cp_retailprice#6936,cp_comment#6937,cp_brand#6938] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 3405ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/25 22:17:34 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:17:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7088L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:17:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:17:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:17:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7088L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#7126 AS rid_1#7171, cpfk_orders_lineitem#7127 AS cpfk_orders_lineitem_1#7172, cpfk_supplier_lineitem#7128 AS cpfk_supplier_lineitem_1#7173, cfpk_lineitem_supplier#7129 AS cfpk_lineitem_supplier_1#7174, cfpk_lineitem_partsupp#7130 AS cfpk_lineitem_partsupp_1#7175, cpfk_part_lineitem#7131 AS cpfk_part_lineitem_1#7176, cfpk_lineitem_part#7132 AS cfpk_lineitem_part_1#7177, cpfk_partsupp_lineitem#7133 AS cpfk_partsupp_lineitem_1#7178, cfpk_lineitem_orders#7134 AS cfpk_lineitem_orders_1#7179, cval_lineitem_l_quantity#7135 AS cval_lineitem_l_quantity_1#7180, cval_lineitem_l_extendedprice#7136 AS cval_lineitem_l_extendedprice_1#7181, cval_lineitem_l_discount#7137 AS cval_lineitem_l_discount_1#7182, cval_lineitem_l_tax#7138 AS cval_lineitem_l_tax_1#7183, cval_lineitem_l_returnflag#7139 AS cval_lineitem_l_returnflag_1#7184, cval_lineitem_l_linestatus#7140 AS cval_lineitem_l_linestatus_1#7185, cval_lineitem_l_commitdate#7141 AS cval_lineitem_l_commitdate_1#7186, cval_lineitem_l_receiptdate#7142 AS cval_lineitem_l_receiptdate_1#7187, cval_lineitem_l_shipinstruct#7143 AS cval_lineitem_l_shipinstruct_1#7188, cval_lineitem_l_shipmode#7144 AS cval_lineitem_l_shipmode_1#7189, cval_lineitem_l_comment#7145 AS cval_lineitem_l_comment_1#7190, cval_lineitem_l_shipdate#7146 AS cval_lineitem_l_shipdate_1#7191, cdepval_lineitem_l_quantity#7147 AS cdepval_lineitem_l_quantity_1#7192, cdepval_lineitem_l_extendedprice#7148 AS cdepval_lineitem_l_extendedprice_1#7193, cdepval_lineitem_l_discount#7149 AS cdepval_lineitem_l_discount_1#7194, ... 21 more fields]
         :  +- Relation[rid#7126,cpfk_orders_lineitem#7127,cpfk_supplier_lineitem#7128,cfpk_lineitem_supplier#7129,cfpk_lineitem_partsupp#7130,cpfk_part_lineitem#7131,cfpk_lineitem_part#7132,cpfk_partsupp_lineitem#7133,cfpk_lineitem_orders#7134,cval_lineitem_l_quantity#7135,cval_lineitem_l_extendedprice#7136,cval_lineitem_l_discount#7137,cval_lineitem_l_tax#7138,cval_lineitem_l_returnflag#7139,cval_lineitem_l_linestatus#7140,cval_lineitem_l_commitdate#7141,cval_lineitem_l_receiptdate#7142,cval_lineitem_l_shipinstruct#7143,cval_lineitem_l_shipmode#7144,cval_lineitem_l_comment#7145,cval_lineitem_l_shipdate#7146,cdepval_lineitem_l_quantity#7147,cdepval_lineitem_l_extendedprice#7148,cdepval_lineitem_l_discount#7149,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7090 AS rid_0#7108, cpfk_nation_supplier#7091 AS cpfk_nation_supplier_0#7109, cfpk_supplier_nation#7092 AS cfpk_supplier_nation_0#7110, cval_supplier_s_name#7093 AS cval_supplier_s_name_0#7111, cval_supplier_s_address#7094 AS cval_supplier_s_address_0#7112, cval_supplier_s_phone#7095 AS cval_supplier_s_phone_0#7113, cval_supplier_s_acctbal#7096 AS cval_supplier_s_acctbal_0#7114, cval_supplier_s_comment#7097 AS cval_supplier_s_comment_0#7115, cdepval_supplier_s_name#7098 AS cdepval_supplier_s_name_0#7116, cdepval_supplier_s_address#7099 AS cdepval_supplier_s_address_0#7117, cdepval_supplier_s_phone#7100 AS cdepval_supplier_s_phone_0#7118, cdepval_supplier_s_acctbal#7101 AS cdepval_supplier_s_acctbal_0#7119, cdepval_supplier_s_comment#7102 AS cdepval_supplier_s_comment_0#7120, cs_name#7103 AS cs_name_0#7121, cs_address#7104 AS cs_address_0#7122, cs_phone#7105 AS cs_phone_0#7123, cs_acctbal#7106 AS cs_acctbal_0#7124, cs_comment#7107 AS cs_comment_0#7125]
            +- Relation[rid#7090,cpfk_nation_supplier#7091,cfpk_supplier_nation#7092,cval_supplier_s_name#7093,cval_supplier_s_address#7094,cval_supplier_s_phone#7095,cval_supplier_s_acctbal#7096,cval_supplier_s_comment#7097,cdepval_supplier_s_name#7098,cdepval_supplier_s_address#7099,cdepval_supplier_s_phone#7100,cdepval_supplier_s_acctbal#7101,cdepval_supplier_s_comment#7102,cs_name#7103,cs_address#7104,cs_phone#7105,cs_acctbal#7106,cs_comment#7107] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17156ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/25 22:17:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:17:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7283L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 22:17:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7283L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#7285 AS rid_0#7309, cpfk_customer_orders#7286 AS cpfk_customer_orders_0#7310, cfpk_orders_customer#7287 AS cfpk_orders_customer_0#7311, cval_orders_o_orderstatus#7288 AS cval_orders_o_orderstatus_0#7312, cval_orders_o_totalprice#7289 AS cval_orders_o_totalprice_0#7313, cval_orders_o_orderpriority#7290 AS cval_orders_o_orderpriority_0#7314, cval_orders_o_clerk#7291 AS cval_orders_o_clerk_0#7315, cval_orders_o_shippriority#7292 AS cval_orders_o_shippriority_0#7316, cval_orders_o_comment#7293 AS cval_orders_o_comment_0#7317, cval_orders_o_orderdate#7294 AS cval_orders_o_orderdate_0#7318, cdepval_orders_o_orderstatus#7295 AS cdepval_orders_o_orderstatus_0#7319, cdepval_orders_o_totalprice#7296 AS cdepval_orders_o_totalprice_0#7320, cdepval_orders_o_orderpriority#7297 AS cdepval_orders_o_orderpriority_0#7321, cdepval_orders_o_clerk#7298 AS cdepval_orders_o_clerk_0#7322, cdepval_orders_o_shippriority#7299 AS cdepval_orders_o_shippriority_0#7323, cdepval_orders_o_comment#7300 AS cdepval_orders_o_comment_0#7324, cdepval_orders_o_orderdate#7301 AS cdepval_orders_o_orderdate_0#7325, co_orderstatus#7302 AS co_orderstatus_0#7326, co_totalprice#7303 AS co_totalprice_0#7327, co_orderpriority#7304 AS co_orderpriority_0#7328, co_clerk#7305 AS co_clerk_0#7329, co_shippriority#7306 AS co_shippriority_0#7330, co_comment#7307 AS co_comment_0#7331, co_orderdate#7308 AS co_orderdate_0#7332]
         :  +- Relation[rid#7285,cpfk_customer_orders#7286,cfpk_orders_customer#7287,cval_orders_o_orderstatus#7288,cval_orders_o_totalprice#7289,cval_orders_o_orderpriority#7290,cval_orders_o_clerk#7291,cval_orders_o_shippriority#7292,cval_orders_o_comment#7293,cval_orders_o_orderdate#7294,cdepval_orders_o_orderstatus#7295,cdepval_orders_o_totalprice#7296,cdepval_orders_o_orderpriority#7297,cdepval_orders_o_clerk#7298,cdepval_orders_o_shippriority#7299,cdepval_orders_o_comment#7300,cdepval_orders_o_orderdate#7301,co_orderstatus#7302,co_totalprice#7303,co_orderpriority#7304,co_clerk#7305,co_shippriority#7306,co_comment#7307,co_orderdate#7308] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#7333 AS rid_1#7354, cpfk_nation_customer#7334 AS cpfk_nation_customer_1#7355, cfpk_customer_nation#7335 AS cfpk_customer_nation_1#7356, cval_customer_c_name#7336 AS cval_customer_c_name_1#7357, cval_customer_c_address#7337 AS cval_customer_c_address_1#7358, cval_customer_c_phone#7338 AS cval_customer_c_phone_1#7359, cval_customer_c_acctbal#7339 AS cval_customer_c_acctbal_1#7360, cval_customer_c_comment#7340 AS cval_customer_c_comment_1#7361, cval_customer_c_mktsegment#7341 AS cval_customer_c_mktsegment_1#7362, cdepval_customer_c_name#7342 AS cdepval_customer_c_name_1#7363, cdepval_customer_c_address#7343 AS cdepval_customer_c_address_1#7364, cdepval_customer_c_phone#7344 AS cdepval_customer_c_phone_1#7365, cdepval_customer_c_acctbal#7345 AS cdepval_customer_c_acctbal_1#7366, cdepval_customer_c_comment#7346 AS cdepval_customer_c_comment_1#7367, cdepval_customer_c_mktsegment#7347 AS cdepval_customer_c_mktsegment_1#7368, cc_name#7348 AS cc_name_1#7369, cc_address#7349 AS cc_address_1#7370, cc_phone#7350 AS cc_phone_1#7371, cc_acctbal#7351 AS cc_acctbal_1#7372, cc_comment#7352 AS cc_comment_1#7373, cc_mktsegment#7353 AS cc_mktsegment_1#7374]
            +- Relation[rid#7333,cpfk_nation_customer#7334,cfpk_customer_nation#7335,cval_customer_c_name#7336,cval_customer_c_address#7337,cval_customer_c_phone#7338,cval_customer_c_acctbal#7339,cval_customer_c_comment#7340,cval_customer_c_mktsegment#7341,cdepval_customer_c_name#7342,cdepval_customer_c_address#7343,cdepval_customer_c_phone#7344,cdepval_customer_c_acctbal#7345,cdepval_customer_c_comment#7346,cdepval_customer_c_mktsegment#7347,cc_name#7348,cc_address#7349,cc_phone#7350,cc_acctbal#7351,cc_comment#7352,cc_mktsegment#7353] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4390ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/25 22:17:56 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:17:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7448L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:17:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7448L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#7450 AS rid_0#7495, cpfk_orders_lineitem#7451 AS cpfk_orders_lineitem_0#7496, cpfk_supplier_lineitem#7452 AS cpfk_supplier_lineitem_0#7497, cfpk_lineitem_supplier#7453 AS cfpk_lineitem_supplier_0#7498, cfpk_lineitem_partsupp#7454 AS cfpk_lineitem_partsupp_0#7499, cpfk_part_lineitem#7455 AS cpfk_part_lineitem_0#7500, cfpk_lineitem_part#7456 AS cfpk_lineitem_part_0#7501, cpfk_partsupp_lineitem#7457 AS cpfk_partsupp_lineitem_0#7502, cfpk_lineitem_orders#7458 AS cfpk_lineitem_orders_0#7503, cval_lineitem_l_quantity#7459 AS cval_lineitem_l_quantity_0#7504, cval_lineitem_l_extendedprice#7460 AS cval_lineitem_l_extendedprice_0#7505, cval_lineitem_l_discount#7461 AS cval_lineitem_l_discount_0#7506, cval_lineitem_l_tax#7462 AS cval_lineitem_l_tax_0#7507, cval_lineitem_l_returnflag#7463 AS cval_lineitem_l_returnflag_0#7508, cval_lineitem_l_linestatus#7464 AS cval_lineitem_l_linestatus_0#7509, cval_lineitem_l_commitdate#7465 AS cval_lineitem_l_commitdate_0#7510, cval_lineitem_l_receiptdate#7466 AS cval_lineitem_l_receiptdate_0#7511, cval_lineitem_l_shipinstruct#7467 AS cval_lineitem_l_shipinstruct_0#7512, cval_lineitem_l_shipmode#7468 AS cval_lineitem_l_shipmode_0#7513, cval_lineitem_l_comment#7469 AS cval_lineitem_l_comment_0#7514, cval_lineitem_l_shipdate#7470 AS cval_lineitem_l_shipdate_0#7515, cdepval_lineitem_l_quantity#7471 AS cdepval_lineitem_l_quantity_0#7516, cdepval_lineitem_l_extendedprice#7472 AS cdepval_lineitem_l_extendedprice_0#7517, cdepval_lineitem_l_discount#7473 AS cdepval_lineitem_l_discount_0#7518, ... 21 more fields]
         :  +- Relation[rid#7450,cpfk_orders_lineitem#7451,cpfk_supplier_lineitem#7452,cfpk_lineitem_supplier#7453,cfpk_lineitem_partsupp#7454,cpfk_part_lineitem#7455,cfpk_lineitem_part#7456,cpfk_partsupp_lineitem#7457,cfpk_lineitem_orders#7458,cval_lineitem_l_quantity#7459,cval_lineitem_l_extendedprice#7460,cval_lineitem_l_discount#7461,cval_lineitem_l_tax#7462,cval_lineitem_l_returnflag#7463,cval_lineitem_l_linestatus#7464,cval_lineitem_l_commitdate#7465,cval_lineitem_l_receiptdate#7466,cval_lineitem_l_shipinstruct#7467,cval_lineitem_l_shipmode#7468,cval_lineitem_l_comment#7469,cval_lineitem_l_shipdate#7470,cdepval_lineitem_l_quantity#7471,cdepval_lineitem_l_extendedprice#7472,cdepval_lineitem_l_discount#7473,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7540 AS rid_1#7564, cpfk_customer_orders#7541 AS cpfk_customer_orders_1#7565, cfpk_orders_customer#7542 AS cfpk_orders_customer_1#7566, cval_orders_o_orderstatus#7543 AS cval_orders_o_orderstatus_1#7567, cval_orders_o_totalprice#7544 AS cval_orders_o_totalprice_1#7568, cval_orders_o_orderpriority#7545 AS cval_orders_o_orderpriority_1#7569, cval_orders_o_clerk#7546 AS cval_orders_o_clerk_1#7570, cval_orders_o_shippriority#7547 AS cval_orders_o_shippriority_1#7571, cval_orders_o_comment#7548 AS cval_orders_o_comment_1#7572, cval_orders_o_orderdate#7549 AS cval_orders_o_orderdate_1#7573, cdepval_orders_o_orderstatus#7550 AS cdepval_orders_o_orderstatus_1#7574, cdepval_orders_o_totalprice#7551 AS cdepval_orders_o_totalprice_1#7575, cdepval_orders_o_orderpriority#7552 AS cdepval_orders_o_orderpriority_1#7576, cdepval_orders_o_clerk#7553 AS cdepval_orders_o_clerk_1#7577, cdepval_orders_o_shippriority#7554 AS cdepval_orders_o_shippriority_1#7578, cdepval_orders_o_comment#7555 AS cdepval_orders_o_comment_1#7579, cdepval_orders_o_orderdate#7556 AS cdepval_orders_o_orderdate_1#7580, co_orderstatus#7557 AS co_orderstatus_1#7581, co_totalprice#7558 AS co_totalprice_1#7582, co_orderpriority#7559 AS co_orderpriority_1#7583, co_clerk#7560 AS co_clerk_1#7584, co_shippriority#7561 AS co_shippriority_1#7585, co_comment#7562 AS co_comment_1#7586, co_orderdate#7563 AS co_orderdate_1#7587]
            +- Relation[rid#7540,cpfk_customer_orders#7541,cfpk_orders_customer#7542,cval_orders_o_orderstatus#7543,cval_orders_o_totalprice#7544,cval_orders_o_orderpriority#7545,cval_orders_o_clerk#7546,cval_orders_o_shippriority#7547,cval_orders_o_comment#7548,cval_orders_o_orderdate#7549,cdepval_orders_o_orderstatus#7550,cdepval_orders_o_totalprice#7551,cdepval_orders_o_orderpriority#7552,cdepval_orders_o_clerk#7553,cdepval_orders_o_shippriority#7554,cdepval_orders_o_comment#7555,cdepval_orders_o_orderdate#7556,co_orderstatus#7557,co_totalprice#7558,co_orderpriority#7559,co_clerk#7560,co_shippriority#7561,co_comment#7562,co_orderdate#7563] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18513ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/25 22:18:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:18:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7661L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 22:18:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:18:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:18:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:18:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:18:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:18:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:18:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:18:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7661L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#7663 AS rid_0#7708, cpfk_orders_lineitem#7664 AS cpfk_orders_lineitem_0#7709, cpfk_supplier_lineitem#7665 AS cpfk_supplier_lineitem_0#7710, cfpk_lineitem_supplier#7666 AS cfpk_lineitem_supplier_0#7711, cfpk_lineitem_partsupp#7667 AS cfpk_lineitem_partsupp_0#7712, cpfk_part_lineitem#7668 AS cpfk_part_lineitem_0#7713, cfpk_lineitem_part#7669 AS cfpk_lineitem_part_0#7714, cpfk_partsupp_lineitem#7670 AS cpfk_partsupp_lineitem_0#7715, cfpk_lineitem_orders#7671 AS cfpk_lineitem_orders_0#7716, cval_lineitem_l_quantity#7672 AS cval_lineitem_l_quantity_0#7717, cval_lineitem_l_extendedprice#7673 AS cval_lineitem_l_extendedprice_0#7718, cval_lineitem_l_discount#7674 AS cval_lineitem_l_discount_0#7719, cval_lineitem_l_tax#7675 AS cval_lineitem_l_tax_0#7720, cval_lineitem_l_returnflag#7676 AS cval_lineitem_l_returnflag_0#7721, cval_lineitem_l_linestatus#7677 AS cval_lineitem_l_linestatus_0#7722, cval_lineitem_l_commitdate#7678 AS cval_lineitem_l_commitdate_0#7723, cval_lineitem_l_receiptdate#7679 AS cval_lineitem_l_receiptdate_0#7724, cval_lineitem_l_shipinstruct#7680 AS cval_lineitem_l_shipinstruct_0#7725, cval_lineitem_l_shipmode#7681 AS cval_lineitem_l_shipmode_0#7726, cval_lineitem_l_comment#7682 AS cval_lineitem_l_comment_0#7727, cval_lineitem_l_shipdate#7683 AS cval_lineitem_l_shipdate_0#7728, cdepval_lineitem_l_quantity#7684 AS cdepval_lineitem_l_quantity_0#7729, cdepval_lineitem_l_extendedprice#7685 AS cdepval_lineitem_l_extendedprice_0#7730, cdepval_lineitem_l_discount#7686 AS cdepval_lineitem_l_discount_0#7731, ... 21 more fields]
         :  +- Relation[rid#7663,cpfk_orders_lineitem#7664,cpfk_supplier_lineitem#7665,cfpk_lineitem_supplier#7666,cfpk_lineitem_partsupp#7667,cpfk_part_lineitem#7668,cfpk_lineitem_part#7669,cpfk_partsupp_lineitem#7670,cfpk_lineitem_orders#7671,cval_lineitem_l_quantity#7672,cval_lineitem_l_extendedprice#7673,cval_lineitem_l_discount#7674,cval_lineitem_l_tax#7675,cval_lineitem_l_returnflag#7676,cval_lineitem_l_linestatus#7677,cval_lineitem_l_commitdate#7678,cval_lineitem_l_receiptdate#7679,cval_lineitem_l_shipinstruct#7680,cval_lineitem_l_shipmode#7681,cval_lineitem_l_comment#7682,cval_lineitem_l_shipdate#7683,cdepval_lineitem_l_quantity#7684,cdepval_lineitem_l_extendedprice#7685,cdepval_lineitem_l_discount#7686,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
            :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
            :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
            :  :  :- Project [rid#7849 AS rid_2#7894, cpfk_orders_lineitem#7850 AS cpfk_orders_lineitem_2#7895, cpfk_supplier_lineitem#7851 AS cpfk_supplier_lineitem_2#7896, cfpk_lineitem_supplier#7852 AS cfpk_lineitem_supplier_2#7897, cfpk_lineitem_partsupp#7853 AS cfpk_lineitem_partsupp_2#7898, cpfk_part_lineitem#7854 AS cpfk_part_lineitem_2#7899, cfpk_lineitem_part#7855 AS cfpk_lineitem_part_2#7900, cpfk_partsupp_lineitem#7856 AS cpfk_partsupp_lineitem_2#7901, cfpk_lineitem_orders#7857 AS cfpk_lineitem_orders_2#7902, cval_lineitem_l_quantity#7858 AS cval_lineitem_l_quantity_2#7903, cval_lineitem_l_extendedprice#7859 AS cval_lineitem_l_extendedprice_2#7904, cval_lineitem_l_discount#7860 AS cval_lineitem_l_discount_2#7905, cval_lineitem_l_tax#7861 AS cval_lineitem_l_tax_2#7906, cval_lineitem_l_returnflag#7862 AS cval_lineitem_l_returnflag_2#7907, cval_lineitem_l_linestatus#7863 AS cval_lineitem_l_linestatus_2#7908, cval_lineitem_l_commitdate#7864 AS cval_lineitem_l_commitdate_2#7909, cval_lineitem_l_receiptdate#7865 AS cval_lineitem_l_receiptdate_2#7910, cval_lineitem_l_shipinstruct#7866 AS cval_lineitem_l_shipinstruct_2#7911, cval_lineitem_l_shipmode#7867 AS cval_lineitem_l_shipmode_2#7912, cval_lineitem_l_comment#7868 AS cval_lineitem_l_comment_2#7913, cval_lineitem_l_shipdate#7869 AS cval_lineitem_l_shipdate_2#7914, cdepval_lineitem_l_quantity#7870 AS cdepval_lineitem_l_quantity_2#7915, cdepval_lineitem_l_extendedprice#7871 AS cdepval_lineitem_l_extendedprice_2#7916, cdepval_lineitem_l_discount#7872 AS cdepval_lineitem_l_discount_2#7917, ... 21 more fields]
            :  :  :  +- Relation[rid#7849,cpfk_orders_lineitem#7850,cpfk_supplier_lineitem#7851,cfpk_lineitem_supplier#7852,cfpk_lineitem_partsupp#7853,cpfk_part_lineitem#7854,cfpk_lineitem_part#7855,cpfk_partsupp_lineitem#7856,cfpk_lineitem_orders#7857,cval_lineitem_l_quantity#7858,cval_lineitem_l_extendedprice#7859,cval_lineitem_l_discount#7860,cval_lineitem_l_tax#7861,cval_lineitem_l_returnflag#7862,cval_lineitem_l_linestatus#7863,cval_lineitem_l_commitdate#7864,cval_lineitem_l_receiptdate#7865,cval_lineitem_l_shipinstruct#7866,cval_lineitem_l_shipmode#7867,cval_lineitem_l_comment#7868,cval_lineitem_l_shipdate#7869,cdepval_lineitem_l_quantity#7870,cdepval_lineitem_l_extendedprice#7871,cdepval_lineitem_l_discount#7872,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
            :  :     +- Project [rid#7753 AS rid_1#7777, cpfk_customer_orders#7754 AS cpfk_customer_orders_1#7778, cfpk_orders_customer#7755 AS cfpk_orders_customer_1#7779, cval_orders_o_orderstatus#7756 AS cval_orders_o_orderstatus_1#7780, cval_orders_o_totalprice#7757 AS cval_orders_o_totalprice_1#7781, cval_orders_o_orderpriority#7758 AS cval_orders_o_orderpriority_1#7782, cval_orders_o_clerk#7759 AS cval_orders_o_clerk_1#7783, cval_orders_o_shippriority#7760 AS cval_orders_o_shippriority_1#7784, cval_orders_o_comment#7761 AS cval_orders_o_comment_1#7785, cval_orders_o_orderdate#7762 AS cval_orders_o_orderdate_1#7786, cdepval_orders_o_orderstatus#7763 AS cdepval_orders_o_orderstatus_1#7787, cdepval_orders_o_totalprice#7764 AS cdepval_orders_o_totalprice_1#7788, cdepval_orders_o_orderpriority#7765 AS cdepval_orders_o_orderpriority_1#7789, cdepval_orders_o_clerk#7766 AS cdepval_orders_o_clerk_1#7790, cdepval_orders_o_shippriority#7767 AS cdepval_orders_o_shippriority_1#7791, cdepval_orders_o_comment#7768 AS cdepval_orders_o_comment_1#7792, cdepval_orders_o_orderdate#7769 AS cdepval_orders_o_orderdate_1#7793, co_orderstatus#7770 AS co_orderstatus_1#7794, co_totalprice#7771 AS co_totalprice_1#7795, co_orderpriority#7772 AS co_orderpriority_1#7796, co_clerk#7773 AS co_clerk_1#7797, co_shippriority#7774 AS co_shippriority_1#7798, co_comment#7775 AS co_comment_1#7799, co_orderdate#7776 AS co_orderdate_1#7800]
            :  :        +- Relation[rid#7753,cpfk_customer_orders#7754,cfpk_orders_customer#7755,cval_orders_o_orderstatus#7756,cval_orders_o_totalprice#7757,cval_orders_o_orderpriority#7758,cval_orders_o_clerk#7759,cval_orders_o_shippriority#7760,cval_orders_o_comment#7761,cval_orders_o_orderdate#7762,cdepval_orders_o_orderstatus#7763,cdepval_orders_o_totalprice#7764,cdepval_orders_o_orderpriority#7765,cdepval_orders_o_clerk#7766,cdepval_orders_o_shippriority#7767,cdepval_orders_o_comment#7768,cdepval_orders_o_orderdate#7769,co_orderstatus#7770,co_totalprice#7771,co_orderpriority#7772,co_clerk#7773,co_shippriority#7774,co_comment#7775,co_orderdate#7776] JDBCRelation(torders) [numPartitions=1]
            :  +- Project [rid#7939 AS rid_3#7957, cpfk_nation_supplier#7940 AS cpfk_nation_supplier_3#7958, cfpk_supplier_nation#7941 AS cfpk_supplier_nation_3#7959, cval_supplier_s_name#7942 AS cval_supplier_s_name_3#7960, cval_supplier_s_address#7943 AS cval_supplier_s_address_3#7961, cval_supplier_s_phone#7944 AS cval_supplier_s_phone_3#7962, cval_supplier_s_acctbal#7945 AS cval_supplier_s_acctbal_3#7963, cval_supplier_s_comment#7946 AS cval_supplier_s_comment_3#7964, cdepval_supplier_s_name#7947 AS cdepval_supplier_s_name_3#7965, cdepval_supplier_s_address#7948 AS cdepval_supplier_s_address_3#7966, cdepval_supplier_s_phone#7949 AS cdepval_supplier_s_phone_3#7967, cdepval_supplier_s_acctbal#7950 AS cdepval_supplier_s_acctbal_3#7968, cdepval_supplier_s_comment#7951 AS cdepval_supplier_s_comment_3#7969, cs_name#7952 AS cs_name_3#7970, cs_address#7953 AS cs_address_3#7971, cs_phone#7954 AS cs_phone_3#7972, cs_acctbal#7955 AS cs_acctbal_3#7973, cs_comment#7956 AS cs_comment_3#7974]
            :     +- Relation[rid#7939,cpfk_nation_supplier#7940,cfpk_supplier_nation#7941,cval_supplier_s_name#7942,cval_supplier_s_address#7943,cval_supplier_s_phone#7944,cval_supplier_s_acctbal#7945,cval_supplier_s_comment#7946,cdepval_supplier_s_name#7947,cdepval_supplier_s_address#7948,cdepval_supplier_s_phone#7949,cdepval_supplier_s_acctbal#7950,cdepval_supplier_s_comment#7951,cs_name#7952,cs_address#7953,cs_phone#7954,cs_acctbal#7955,cs_comment#7956] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
               +- Project [rid#7975 AS rid_4#7984, cpfk_region_nation#7976 AS cpfk_region_nation_4#7985, cfpk_nation_region#7977 AS cfpk_nation_region_4#7986, cval_nation_n_name#7978 AS cval_nation_n_name_4#7987, cval_nation_n_comment#7979 AS cval_nation_n_comment_4#7988, cdepval_nation_n_name#7980 AS cdepval_nation_n_name_4#7989, cdepval_nation_n_comment#7981 AS cdepval_nation_n_comment_4#7990, cn_name#7982 AS cn_name_4#7991, cn_comment#7983 AS cn_comment_4#7992]
                  +- Relation[rid#7975,cpfk_region_nation#7976,cfpk_nation_region#7977,cval_nation_n_name#7978,cval_nation_n_comment#7979,cdepval_nation_n_name#7980,cdepval_nation_n_comment#7981,cn_name#7982,cn_comment#7983] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 76128ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/25 22:19:30 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:19:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8161L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:19:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8161L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#8253 AS rid_2#8298, cpfk_orders_lineitem#8254 AS cpfk_orders_lineitem_2#8299, cpfk_supplier_lineitem#8255 AS cpfk_supplier_lineitem_2#8300, cfpk_lineitem_supplier#8256 AS cfpk_lineitem_supplier_2#8301, cfpk_lineitem_partsupp#8257 AS cfpk_lineitem_partsupp_2#8302, cpfk_part_lineitem#8258 AS cpfk_part_lineitem_2#8303, cfpk_lineitem_part#8259 AS cfpk_lineitem_part_2#8304, cpfk_partsupp_lineitem#8260 AS cpfk_partsupp_lineitem_2#8305, cfpk_lineitem_orders#8261 AS cfpk_lineitem_orders_2#8306, cval_lineitem_l_quantity#8262 AS cval_lineitem_l_quantity_2#8307, cval_lineitem_l_extendedprice#8263 AS cval_lineitem_l_extendedprice_2#8308, cval_lineitem_l_discount#8264 AS cval_lineitem_l_discount_2#8309, cval_lineitem_l_tax#8265 AS cval_lineitem_l_tax_2#8310, cval_lineitem_l_returnflag#8266 AS cval_lineitem_l_returnflag_2#8311, cval_lineitem_l_linestatus#8267 AS cval_lineitem_l_linestatus_2#8312, cval_lineitem_l_commitdate#8268 AS cval_lineitem_l_commitdate_2#8313, cval_lineitem_l_receiptdate#8269 AS cval_lineitem_l_receiptdate_2#8314, cval_lineitem_l_shipinstruct#8270 AS cval_lineitem_l_shipinstruct_2#8315, cval_lineitem_l_shipmode#8271 AS cval_lineitem_l_shipmode_2#8316, cval_lineitem_l_comment#8272 AS cval_lineitem_l_comment_2#8317, cval_lineitem_l_shipdate#8273 AS cval_lineitem_l_shipdate_2#8318, cdepval_lineitem_l_quantity#8274 AS cdepval_lineitem_l_quantity_2#8319, cdepval_lineitem_l_extendedprice#8275 AS cdepval_lineitem_l_extendedprice_2#8320, cdepval_lineitem_l_discount#8276 AS cdepval_lineitem_l_discount_2#8321, ... 21 more fields]
         :  +- Relation[rid#8253,cpfk_orders_lineitem#8254,cpfk_supplier_lineitem#8255,cfpk_lineitem_supplier#8256,cfpk_lineitem_partsupp#8257,cpfk_part_lineitem#8258,cfpk_lineitem_part#8259,cpfk_partsupp_lineitem#8260,cfpk_lineitem_orders#8261,cval_lineitem_l_quantity#8262,cval_lineitem_l_extendedprice#8263,cval_lineitem_l_discount#8264,cval_lineitem_l_tax#8265,cval_lineitem_l_returnflag#8266,cval_lineitem_l_linestatus#8267,cval_lineitem_l_commitdate#8268,cval_lineitem_l_receiptdate#8269,cval_lineitem_l_shipinstruct#8270,cval_lineitem_l_shipmode#8271,cval_lineitem_l_comment#8272,cval_lineitem_l_shipdate#8273,cdepval_lineitem_l_quantity#8274,cdepval_lineitem_l_extendedprice#8275,cdepval_lineitem_l_discount#8276,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#8205 AS rid_1#8229, cpfk_customer_orders#8206 AS cpfk_customer_orders_1#8230, cfpk_orders_customer#8207 AS cfpk_orders_customer_1#8231, cval_orders_o_orderstatus#8208 AS cval_orders_o_orderstatus_1#8232, cval_orders_o_totalprice#8209 AS cval_orders_o_totalprice_1#8233, cval_orders_o_orderpriority#8210 AS cval_orders_o_orderpriority_1#8234, cval_orders_o_clerk#8211 AS cval_orders_o_clerk_1#8235, cval_orders_o_shippriority#8212 AS cval_orders_o_shippriority_1#8236, cval_orders_o_comment#8213 AS cval_orders_o_comment_1#8237, cval_orders_o_orderdate#8214 AS cval_orders_o_orderdate_1#8238, cdepval_orders_o_orderstatus#8215 AS cdepval_orders_o_orderstatus_1#8239, cdepval_orders_o_totalprice#8216 AS cdepval_orders_o_totalprice_1#8240, cdepval_orders_o_orderpriority#8217 AS cdepval_orders_o_orderpriority_1#8241, cdepval_orders_o_clerk#8218 AS cdepval_orders_o_clerk_1#8242, cdepval_orders_o_shippriority#8219 AS cdepval_orders_o_shippriority_1#8243, cdepval_orders_o_comment#8220 AS cdepval_orders_o_comment_1#8244, cdepval_orders_o_orderdate#8221 AS cdepval_orders_o_orderdate_1#8245, co_orderstatus#8222 AS co_orderstatus_1#8246, co_totalprice#8223 AS co_totalprice_1#8247, co_orderpriority#8224 AS co_orderpriority_1#8248, co_clerk#8225 AS co_clerk_1#8249, co_shippriority#8226 AS co_shippriority_1#8250, co_comment#8227 AS co_comment_1#8251, co_orderdate#8228 AS co_orderdate_1#8252]
            :  +- Relation[rid#8205,cpfk_customer_orders#8206,cfpk_orders_customer#8207,cval_orders_o_orderstatus#8208,cval_orders_o_totalprice#8209,cval_orders_o_orderpriority#8210,cval_orders_o_clerk#8211,cval_orders_o_shippriority#8212,cval_orders_o_comment#8213,cval_orders_o_orderdate#8214,cdepval_orders_o_orderstatus#8215,cdepval_orders_o_totalprice#8216,cdepval_orders_o_orderpriority#8217,cdepval_orders_o_clerk#8218,cdepval_orders_o_shippriority#8219,cdepval_orders_o_comment#8220,cdepval_orders_o_orderdate#8221,co_orderstatus#8222,co_totalprice#8223,co_orderpriority#8224,co_clerk#8225,co_shippriority#8226,co_comment#8227,co_orderdate#8228] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#8163 AS rid_0#8184, cpfk_nation_customer#8164 AS cpfk_nation_customer_0#8185, cfpk_customer_nation#8165 AS cfpk_customer_nation_0#8186, cval_customer_c_name#8166 AS cval_customer_c_name_0#8187, cval_customer_c_address#8167 AS cval_customer_c_address_0#8188, cval_customer_c_phone#8168 AS cval_customer_c_phone_0#8189, cval_customer_c_acctbal#8169 AS cval_customer_c_acctbal_0#8190, cval_customer_c_comment#8170 AS cval_customer_c_comment_0#8191, cval_customer_c_mktsegment#8171 AS cval_customer_c_mktsegment_0#8192, cdepval_customer_c_name#8172 AS cdepval_customer_c_name_0#8193, cdepval_customer_c_address#8173 AS cdepval_customer_c_address_0#8194, cdepval_customer_c_phone#8174 AS cdepval_customer_c_phone_0#8195, cdepval_customer_c_acctbal#8175 AS cdepval_customer_c_acctbal_0#8196, cdepval_customer_c_comment#8176 AS cdepval_customer_c_comment_0#8197, cdepval_customer_c_mktsegment#8177 AS cdepval_customer_c_mktsegment_0#8198, cc_name#8178 AS cc_name_0#8199, cc_address#8179 AS cc_address_0#8200, cc_phone#8180 AS cc_phone_0#8201, cc_acctbal#8181 AS cc_acctbal_0#8202, cc_comment#8182 AS cc_comment_0#8203, cc_mktsegment#8183 AS cc_mktsegment_0#8204]
               +- Relation[rid#8163,cpfk_nation_customer#8164,cfpk_customer_nation#8165,cval_customer_c_name#8166,cval_customer_c_address#8167,cval_customer_c_phone#8168,cval_customer_c_acctbal#8169,cval_customer_c_comment#8170,cval_customer_c_mktsegment#8171,cdepval_customer_c_name#8172,cdepval_customer_c_address#8173,cdepval_customer_c_phone#8174,cdepval_customer_c_acctbal#8175,cdepval_customer_c_comment#8176,cdepval_customer_c_mktsegment#8177,cc_name#8178,cc_address#8179,cc_phone#8180,cc_acctbal#8181,cc_comment#8182,cc_mktsegment#8183] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 21978ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 22:19:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:19:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8442L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:19:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:19:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:19:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:19:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:19:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:19:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:19:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:19:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8442L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#8498 AS rid_2#8543, cpfk_orders_lineitem#8499 AS cpfk_orders_lineitem_2#8544, cpfk_supplier_lineitem#8500 AS cpfk_supplier_lineitem_2#8545, cfpk_lineitem_supplier#8501 AS cfpk_lineitem_supplier_2#8546, cfpk_lineitem_partsupp#8502 AS cfpk_lineitem_partsupp_2#8547, cpfk_part_lineitem#8503 AS cpfk_part_lineitem_2#8548, cfpk_lineitem_part#8504 AS cfpk_lineitem_part_2#8549, cpfk_partsupp_lineitem#8505 AS cpfk_partsupp_lineitem_2#8550, cfpk_lineitem_orders#8506 AS cfpk_lineitem_orders_2#8551, cval_lineitem_l_quantity#8507 AS cval_lineitem_l_quantity_2#8552, cval_lineitem_l_extendedprice#8508 AS cval_lineitem_l_extendedprice_2#8553, cval_lineitem_l_discount#8509 AS cval_lineitem_l_discount_2#8554, cval_lineitem_l_tax#8510 AS cval_lineitem_l_tax_2#8555, cval_lineitem_l_returnflag#8511 AS cval_lineitem_l_returnflag_2#8556, cval_lineitem_l_linestatus#8512 AS cval_lineitem_l_linestatus_2#8557, cval_lineitem_l_commitdate#8513 AS cval_lineitem_l_commitdate_2#8558, cval_lineitem_l_receiptdate#8514 AS cval_lineitem_l_receiptdate_2#8559, cval_lineitem_l_shipinstruct#8515 AS cval_lineitem_l_shipinstruct_2#8560, cval_lineitem_l_shipmode#8516 AS cval_lineitem_l_shipmode_2#8561, cval_lineitem_l_comment#8517 AS cval_lineitem_l_comment_2#8562, cval_lineitem_l_shipdate#8518 AS cval_lineitem_l_shipdate_2#8563, cdepval_lineitem_l_quantity#8519 AS cdepval_lineitem_l_quantity_2#8564, cdepval_lineitem_l_extendedprice#8520 AS cdepval_lineitem_l_extendedprice_2#8565, cdepval_lineitem_l_discount#8521 AS cdepval_lineitem_l_discount_2#8566, ... 21 more fields]
         :  :  :  :  +- Relation[rid#8498,cpfk_orders_lineitem#8499,cpfk_supplier_lineitem#8500,cfpk_lineitem_supplier#8501,cfpk_lineitem_partsupp#8502,cpfk_part_lineitem#8503,cfpk_lineitem_part#8504,cpfk_partsupp_lineitem#8505,cfpk_lineitem_orders#8506,cval_lineitem_l_quantity#8507,cval_lineitem_l_extendedprice#8508,cval_lineitem_l_discount#8509,cval_lineitem_l_tax#8510,cval_lineitem_l_returnflag#8511,cval_lineitem_l_linestatus#8512,cval_lineitem_l_commitdate#8513,cval_lineitem_l_receiptdate#8514,cval_lineitem_l_shipinstruct#8515,cval_lineitem_l_shipmode#8516,cval_lineitem_l_comment#8517,cval_lineitem_l_shipdate#8518,cdepval_lineitem_l_quantity#8519,cdepval_lineitem_l_extendedprice#8520,cdepval_lineitem_l_discount#8521,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#8462 AS rid_1#8480, cpfk_nation_supplier#8463 AS cpfk_nation_supplier_1#8481, cfpk_supplier_nation#8464 AS cfpk_supplier_nation_1#8482, cval_supplier_s_name#8465 AS cval_supplier_s_name_1#8483, cval_supplier_s_address#8466 AS cval_supplier_s_address_1#8484, cval_supplier_s_phone#8467 AS cval_supplier_s_phone_1#8485, cval_supplier_s_acctbal#8468 AS cval_supplier_s_acctbal_1#8486, cval_supplier_s_comment#8469 AS cval_supplier_s_comment_1#8487, cdepval_supplier_s_name#8470 AS cdepval_supplier_s_name_1#8488, cdepval_supplier_s_address#8471 AS cdepval_supplier_s_address_1#8489, cdepval_supplier_s_phone#8472 AS cdepval_supplier_s_phone_1#8490, cdepval_supplier_s_acctbal#8473 AS cdepval_supplier_s_acctbal_1#8491, cdepval_supplier_s_comment#8474 AS cdepval_supplier_s_comment_1#8492, cs_name#8475 AS cs_name_1#8493, cs_address#8476 AS cs_address_1#8494, cs_phone#8477 AS cs_phone_1#8495, cs_acctbal#8478 AS cs_acctbal_1#8496, cs_comment#8479 AS cs_comment_1#8497]
         :  :  :     :  +- Relation[rid#8462,cpfk_nation_supplier#8463,cfpk_supplier_nation#8464,cval_supplier_s_name#8465,cval_supplier_s_address#8466,cval_supplier_s_phone#8467,cval_supplier_s_acctbal#8468,cval_supplier_s_comment#8469,cdepval_supplier_s_name#8470,cdepval_supplier_s_address#8471,cdepval_supplier_s_phone#8472,cdepval_supplier_s_acctbal#8473,cdepval_supplier_s_comment#8474,cs_name#8475,cs_address#8476,cs_phone#8477,cs_acctbal#8478,cs_comment#8479] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#8444 AS rid_0#8453, cpfk_region_nation#8445 AS cpfk_region_nation_0#8454, cfpk_nation_region#8446 AS cfpk_nation_region_0#8455, cval_nation_n_name#8447 AS cval_nation_n_name_0#8456, cval_nation_n_comment#8448 AS cval_nation_n_comment_0#8457, cdepval_nation_n_name#8449 AS cdepval_nation_n_name_0#8458, cdepval_nation_n_comment#8450 AS cdepval_nation_n_comment_0#8459, cn_name#8451 AS cn_name_0#8460, cn_comment#8452 AS cn_comment_0#8461]
         :  :  :        +- Relation[rid#8444,cpfk_region_nation#8445,cfpk_nation_region#8446,cval_nation_n_name#8447,cval_nation_n_comment#8448,cdepval_nation_n_name#8449,cdepval_nation_n_comment#8450,cn_name#8451,cn_comment#8452] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#8588 AS rid_3#8613, cval_part_p_name#8589 AS cval_part_p_name_3#8614, cval_part_p_mfgr#8590 AS cval_part_p_mfgr_3#8615, cval_part_p_type#8591 AS cval_part_p_type_3#8616, cval_part_p_size#8592 AS cval_part_p_size_3#8617, cval_part_p_container#8593 AS cval_part_p_container_3#8618, cval_part_p_retailprice#8594 AS cval_part_p_retailprice_3#8619, cval_part_p_comment#8595 AS cval_part_p_comment_3#8620, cval_part_p_brand#8596 AS cval_part_p_brand_3#8621, cdepval_part_p_name#8597 AS cdepval_part_p_name_3#8622, cdepval_part_p_mfgr#8598 AS cdepval_part_p_mfgr_3#8623, cdepval_part_p_type#8599 AS cdepval_part_p_type_3#8624, cdepval_part_p_size#8600 AS cdepval_part_p_size_3#8625, cdepval_part_p_container#8601 AS cdepval_part_p_container_3#8626, cdepval_part_p_retailprice#8602 AS cdepval_part_p_retailprice_3#8627, cdepval_part_p_comment#8603 AS cdepval_part_p_comment_3#8628, cdepval_part_p_brand#8604 AS cdepval_part_p_brand_3#8629, cp_name#8605 AS cp_name_3#8630, cp_mfgr#8606 AS cp_mfgr_3#8631, cp_type#8607 AS cp_type_3#8632, cp_size#8608 AS cp_size_3#8633, cp_container#8609 AS cp_container_3#8634, cp_retailprice#8610 AS cp_retailprice_3#8635, cp_comment#8611 AS cp_comment_3#8636, cp_brand#8612 AS cp_brand_3#8637]
         :  :     +- Relation[rid#8588,cval_part_p_name#8589,cval_part_p_mfgr#8590,cval_part_p_type#8591,cval_part_p_size#8592,cval_part_p_container#8593,cval_part_p_retailprice#8594,cval_part_p_comment#8595,cval_part_p_brand#8596,cdepval_part_p_name#8597,cdepval_part_p_mfgr#8598,cdepval_part_p_type#8599,cdepval_part_p_size#8600,cdepval_part_p_container#8601,cdepval_part_p_retailprice#8602,cdepval_part_p_comment#8603,cdepval_part_p_brand#8604,cp_name#8605,cp_mfgr#8606,cp_type#8607,cp_size#8608,cp_container#8609,cp_retailprice#8610,cp_comment#8611,cp_brand#8612] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#8638 AS rid_4#8652, cpfk_part_partsupp#8639 AS cpfk_part_partsupp_4#8653, cfpk_partsupp_part#8640 AS cfpk_partsupp_part_4#8654, cpfk_supplier_partsupp#8641 AS cpfk_supplier_partsupp_4#8655, cfpk_partsupp_supplier#8642 AS cfpk_partsupp_supplier_4#8656, cval_partsupp_ps_availqty#8643 AS cval_partsupp_ps_availqty_4#8657, cval_partsupp_ps_supplycost#8644 AS cval_partsupp_ps_supplycost_4#8658, cval_partsupp_ps_comment#8645 AS cval_partsupp_ps_comment_4#8659, cdepval_partsupp_ps_availqty#8646 AS cdepval_partsupp_ps_availqty_4#8660, cdepval_partsupp_ps_supplycost#8647 AS cdepval_partsupp_ps_supplycost_4#8661, cdepval_partsupp_ps_comment#8648 AS cdepval_partsupp_ps_comment_4#8662, cps_availqty#8649 AS cps_availqty_4#8663, cps_supplycost#8650 AS cps_supplycost_4#8664, cps_comment#8651 AS cps_comment_4#8665]
         :     +- Relation[rid#8638,cpfk_part_partsupp#8639,cfpk_partsupp_part#8640,cpfk_supplier_partsupp#8641,cfpk_partsupp_supplier#8642,cval_partsupp_ps_availqty#8643,cval_partsupp_ps_supplycost#8644,cval_partsupp_ps_comment#8645,cdepval_partsupp_ps_availqty#8646,cdepval_partsupp_ps_supplycost#8647,cdepval_partsupp_ps_comment#8648,cps_availqty#8649,cps_supplycost#8650,cps_comment#8651] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#8666 AS rid_5#8690, cpfk_customer_orders#8667 AS cpfk_customer_orders_5#8691, cfpk_orders_customer#8668 AS cfpk_orders_customer_5#8692, cval_orders_o_orderstatus#8669 AS cval_orders_o_orderstatus_5#8693, cval_orders_o_totalprice#8670 AS cval_orders_o_totalprice_5#8694, cval_orders_o_orderpriority#8671 AS cval_orders_o_orderpriority_5#8695, cval_orders_o_clerk#8672 AS cval_orders_o_clerk_5#8696, cval_orders_o_shippriority#8673 AS cval_orders_o_shippriority_5#8697, cval_orders_o_comment#8674 AS cval_orders_o_comment_5#8698, cval_orders_o_orderdate#8675 AS cval_orders_o_orderdate_5#8699, cdepval_orders_o_orderstatus#8676 AS cdepval_orders_o_orderstatus_5#8700, cdepval_orders_o_totalprice#8677 AS cdepval_orders_o_totalprice_5#8701, cdepval_orders_o_orderpriority#8678 AS cdepval_orders_o_orderpriority_5#8702, cdepval_orders_o_clerk#8679 AS cdepval_orders_o_clerk_5#8703, cdepval_orders_o_shippriority#8680 AS cdepval_orders_o_shippriority_5#8704, cdepval_orders_o_comment#8681 AS cdepval_orders_o_comment_5#8705, cdepval_orders_o_orderdate#8682 AS cdepval_orders_o_orderdate_5#8706, co_orderstatus#8683 AS co_orderstatus_5#8707, co_totalprice#8684 AS co_totalprice_5#8708, co_orderpriority#8685 AS co_orderpriority_5#8709, co_clerk#8686 AS co_clerk_5#8710, co_shippriority#8687 AS co_shippriority_5#8711, co_comment#8688 AS co_comment_5#8712, co_orderdate#8689 AS co_orderdate_5#8713]
            +- Relation[rid#8666,cpfk_customer_orders#8667,cfpk_orders_customer#8668,cval_orders_o_orderstatus#8669,cval_orders_o_totalprice#8670,cval_orders_o_orderpriority#8671,cval_orders_o_clerk#8672,cval_orders_o_shippriority#8673,cval_orders_o_comment#8674,cval_orders_o_orderdate#8675,cdepval_orders_o_orderstatus#8676,cdepval_orders_o_totalprice#8677,cdepval_orders_o_orderpriority#8678,cdepval_orders_o_clerk#8679,cdepval_orders_o_shippriority#8680,cdepval_orders_o_comment#8681,cdepval_orders_o_orderdate#8682,co_orderstatus#8683,co_totalprice#8684,co_orderpriority#8685,co_clerk#8686,co_shippriority#8687,co_comment#8688,co_orderdate#8689] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 64548ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/25 22:20:57 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:20:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8854L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 22:20:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8854L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#8856 AS rid_0#8880, cpfk_customer_orders#8857 AS cpfk_customer_orders_0#8881, cfpk_orders_customer#8858 AS cfpk_orders_customer_0#8882, cval_orders_o_orderstatus#8859 AS cval_orders_o_orderstatus_0#8883, cval_orders_o_totalprice#8860 AS cval_orders_o_totalprice_0#8884, cval_orders_o_orderpriority#8861 AS cval_orders_o_orderpriority_0#8885, cval_orders_o_clerk#8862 AS cval_orders_o_clerk_0#8886, cval_orders_o_shippriority#8863 AS cval_orders_o_shippriority_0#8887, cval_orders_o_comment#8864 AS cval_orders_o_comment_0#8888, cval_orders_o_orderdate#8865 AS cval_orders_o_orderdate_0#8889, cdepval_orders_o_orderstatus#8866 AS cdepval_orders_o_orderstatus_0#8890, cdepval_orders_o_totalprice#8867 AS cdepval_orders_o_totalprice_0#8891, cdepval_orders_o_orderpriority#8868 AS cdepval_orders_o_orderpriority_0#8892, cdepval_orders_o_clerk#8869 AS cdepval_orders_o_clerk_0#8893, cdepval_orders_o_shippriority#8870 AS cdepval_orders_o_shippriority_0#8894, cdepval_orders_o_comment#8871 AS cdepval_orders_o_comment_0#8895, cdepval_orders_o_orderdate#8872 AS cdepval_orders_o_orderdate_0#8896, co_orderstatus#8873 AS co_orderstatus_0#8897, co_totalprice#8874 AS co_totalprice_0#8898, co_orderpriority#8875 AS co_orderpriority_0#8899, co_clerk#8876 AS co_clerk_0#8900, co_shippriority#8877 AS co_shippriority_0#8901, co_comment#8878 AS co_comment_0#8902, co_orderdate#8879 AS co_orderdate_0#8903]
         :  +- Relation[rid#8856,cpfk_customer_orders#8857,cfpk_orders_customer#8858,cval_orders_o_orderstatus#8859,cval_orders_o_totalprice#8860,cval_orders_o_orderpriority#8861,cval_orders_o_clerk#8862,cval_orders_o_shippriority#8863,cval_orders_o_comment#8864,cval_orders_o_orderdate#8865,cdepval_orders_o_orderstatus#8866,cdepval_orders_o_totalprice#8867,cdepval_orders_o_orderpriority#8868,cdepval_orders_o_clerk#8869,cdepval_orders_o_shippriority#8870,cdepval_orders_o_comment#8871,cdepval_orders_o_orderdate#8872,co_orderstatus#8873,co_totalprice#8874,co_orderpriority#8875,co_clerk#8876,co_shippriority#8877,co_comment#8878,co_orderdate#8879] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#8904 AS rid_1#8925, cpfk_nation_customer#8905 AS cpfk_nation_customer_1#8926, cfpk_customer_nation#8906 AS cfpk_customer_nation_1#8927, cval_customer_c_name#8907 AS cval_customer_c_name_1#8928, cval_customer_c_address#8908 AS cval_customer_c_address_1#8929, cval_customer_c_phone#8909 AS cval_customer_c_phone_1#8930, cval_customer_c_acctbal#8910 AS cval_customer_c_acctbal_1#8931, cval_customer_c_comment#8911 AS cval_customer_c_comment_1#8932, cval_customer_c_mktsegment#8912 AS cval_customer_c_mktsegment_1#8933, cdepval_customer_c_name#8913 AS cdepval_customer_c_name_1#8934, cdepval_customer_c_address#8914 AS cdepval_customer_c_address_1#8935, cdepval_customer_c_phone#8915 AS cdepval_customer_c_phone_1#8936, cdepval_customer_c_acctbal#8916 AS cdepval_customer_c_acctbal_1#8937, cdepval_customer_c_comment#8917 AS cdepval_customer_c_comment_1#8938, cdepval_customer_c_mktsegment#8918 AS cdepval_customer_c_mktsegment_1#8939, cc_name#8919 AS cc_name_1#8940, cc_address#8920 AS cc_address_1#8941, cc_phone#8921 AS cc_phone_1#8942, cc_acctbal#8922 AS cc_acctbal_1#8943, cc_comment#8923 AS cc_comment_1#8944, cc_mktsegment#8924 AS cc_mktsegment_1#8945]
            +- Relation[rid#8904,cpfk_nation_customer#8905,cfpk_customer_nation#8906,cval_customer_c_name#8907,cval_customer_c_address#8908,cval_customer_c_phone#8909,cval_customer_c_acctbal#8910,cval_customer_c_comment#8911,cval_customer_c_mktsegment#8912,cdepval_customer_c_name#8913,cdepval_customer_c_address#8914,cdepval_customer_c_phone#8915,cdepval_customer_c_acctbal#8916,cdepval_customer_c_comment#8917,cdepval_customer_c_mktsegment#8918,cc_name#8919,cc_address#8920,cc_phone#8921,cc_acctbal#8922,cc_comment#8923,cc_mktsegment#8924] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4398ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/25 22:21:01 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:21:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8996L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:21:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#8996L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#8998 AS rid_0#9043, cpfk_orders_lineitem#8999 AS cpfk_orders_lineitem_0#9044, cpfk_supplier_lineitem#9000 AS cpfk_supplier_lineitem_0#9045, cfpk_lineitem_supplier#9001 AS cfpk_lineitem_supplier_0#9046, cfpk_lineitem_partsupp#9002 AS cfpk_lineitem_partsupp_0#9047, cpfk_part_lineitem#9003 AS cpfk_part_lineitem_0#9048, cfpk_lineitem_part#9004 AS cfpk_lineitem_part_0#9049, cpfk_partsupp_lineitem#9005 AS cpfk_partsupp_lineitem_0#9050, cfpk_lineitem_orders#9006 AS cfpk_lineitem_orders_0#9051, cval_lineitem_l_quantity#9007 AS cval_lineitem_l_quantity_0#9052, cval_lineitem_l_extendedprice#9008 AS cval_lineitem_l_extendedprice_0#9053, cval_lineitem_l_discount#9009 AS cval_lineitem_l_discount_0#9054, cval_lineitem_l_tax#9010 AS cval_lineitem_l_tax_0#9055, cval_lineitem_l_returnflag#9011 AS cval_lineitem_l_returnflag_0#9056, cval_lineitem_l_linestatus#9012 AS cval_lineitem_l_linestatus_0#9057, cval_lineitem_l_commitdate#9013 AS cval_lineitem_l_commitdate_0#9058, cval_lineitem_l_receiptdate#9014 AS cval_lineitem_l_receiptdate_0#9059, cval_lineitem_l_shipinstruct#9015 AS cval_lineitem_l_shipinstruct_0#9060, cval_lineitem_l_shipmode#9016 AS cval_lineitem_l_shipmode_0#9061, cval_lineitem_l_comment#9017 AS cval_lineitem_l_comment_0#9062, cval_lineitem_l_shipdate#9018 AS cval_lineitem_l_shipdate_0#9063, cdepval_lineitem_l_quantity#9019 AS cdepval_lineitem_l_quantity_0#9064, cdepval_lineitem_l_extendedprice#9020 AS cdepval_lineitem_l_extendedprice_0#9065, cdepval_lineitem_l_discount#9021 AS cdepval_lineitem_l_discount_0#9066, ... 21 more fields]
         +- Relation[rid#8998,cpfk_orders_lineitem#8999,cpfk_supplier_lineitem#9000,cfpk_lineitem_supplier#9001,cfpk_lineitem_partsupp#9002,cpfk_part_lineitem#9003,cfpk_lineitem_part#9004,cpfk_partsupp_lineitem#9005,cfpk_lineitem_orders#9006,cval_lineitem_l_quantity#9007,cval_lineitem_l_extendedprice#9008,cval_lineitem_l_discount#9009,cval_lineitem_l_tax#9010,cval_lineitem_l_returnflag#9011,cval_lineitem_l_linestatus#9012,cval_lineitem_l_commitdate#9013,cval_lineitem_l_receiptdate#9014,cval_lineitem_l_shipinstruct#9015,cval_lineitem_l_shipmode#9016,cval_lineitem_l_comment#9017,cval_lineitem_l_shipdate#9018,cdepval_lineitem_l_quantity#9019,cdepval_lineitem_l_extendedprice#9020,cdepval_lineitem_l_discount#9021,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2430ms
query=q1, count=6001215, duration=2430
query=q10, count=1478870, duration=60509
query=q11, count=31680, duration=3528
query=q12, count=857401, duration=22084
query=q13, count=1500000, duration=4390
query=q14, count=6001215, duration=18280
query=q15, count=6001215, duration=17156
query=q16, count=15780, duration=3405
query=q17, count=6088, duration=26006
query=q18, count=6001215, duration=21978
query=q19, count=205, duration=16749
query=q2, count=3162, duration=3587
query=q20, count=632, duration=3865
query=q21a, count=597422, duration=76128
query=q22, count=1500000, duration=4398
query=q3, count=1214743, duration=39237
query=q4, count=6001215, duration=18513
query=q5, count=48089, duration=30716
query=q6, count=6001215, duration=2472
query=q7, count=9735, duration=34748
query=q8, count=8716, duration=44841
query=q9a, count=6001215, duration=64548
query=q9b, count=6001215, duration=37972
