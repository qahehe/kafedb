20/04/25 22:40:07 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10797ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 25 22:40:10 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 25 22:40:11 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 25 22:40:11 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 25 22:40:12 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 25 22:40:12 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 25 22:40:16 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 25 22:40:19 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 25 22:40:19 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/25 22:40:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:40:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2079L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 22:40:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2079L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#2081 AS rid_0#2105, cpfk_customer_orders#2082 AS cpfk_customer_orders_0#2106, cfpk_orders_customer#2083 AS cfpk_orders_customer_0#2107, cval_orders_o_orderstatus#2084 AS cval_orders_o_orderstatus_0#2108, cval_orders_o_totalprice#2085 AS cval_orders_o_totalprice_0#2109, cval_orders_o_orderpriority#2086 AS cval_orders_o_orderpriority_0#2110, cval_orders_o_clerk#2087 AS cval_orders_o_clerk_0#2111, cval_orders_o_shippriority#2088 AS cval_orders_o_shippriority_0#2112, cval_orders_o_comment#2089 AS cval_orders_o_comment_0#2113, cval_orders_o_orderdate#2090 AS cval_orders_o_orderdate_0#2114, cdepval_orders_o_orderstatus#2091 AS cdepval_orders_o_orderstatus_0#2115, cdepval_orders_o_totalprice#2092 AS cdepval_orders_o_totalprice_0#2116, cdepval_orders_o_orderpriority#2093 AS cdepval_orders_o_orderpriority_0#2117, cdepval_orders_o_clerk#2094 AS cdepval_orders_o_clerk_0#2118, cdepval_orders_o_shippriority#2095 AS cdepval_orders_o_shippriority_0#2119, cdepval_orders_o_comment#2096 AS cdepval_orders_o_comment_0#2120, cdepval_orders_o_orderdate#2097 AS cdepval_orders_o_orderdate_0#2121, co_orderstatus#2098 AS co_orderstatus_0#2122, co_totalprice#2099 AS co_totalprice_0#2123, co_orderpriority#2100 AS co_orderpriority_0#2124, co_clerk#2101 AS co_clerk_0#2125, co_shippriority#2102 AS co_shippriority_0#2126, co_comment#2103 AS co_comment_0#2127, co_orderdate#2104 AS co_orderdate_0#2128]
         :  +- Relation[rid#2081,cpfk_customer_orders#2082,cfpk_orders_customer#2083,cval_orders_o_orderstatus#2084,cval_orders_o_totalprice#2085,cval_orders_o_orderpriority#2086,cval_orders_o_clerk#2087,cval_orders_o_shippriority#2088,cval_orders_o_comment#2089,cval_orders_o_orderdate#2090,cdepval_orders_o_orderstatus#2091,cdepval_orders_o_totalprice#2092,cdepval_orders_o_orderpriority#2093,cdepval_orders_o_clerk#2094,cdepval_orders_o_shippriority#2095,cdepval_orders_o_comment#2096,cdepval_orders_o_orderdate#2097,co_orderstatus#2098,co_totalprice#2099,co_orderpriority#2100,co_clerk#2101,co_shippriority#2102,co_comment#2103,co_orderdate#2104] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#2129 AS rid_1#2150, cpfk_nation_customer#2130 AS cpfk_nation_customer_1#2151, cfpk_customer_nation#2131 AS cfpk_customer_nation_1#2152, cval_customer_c_name#2132 AS cval_customer_c_name_1#2153, cval_customer_c_address#2133 AS cval_customer_c_address_1#2154, cval_customer_c_phone#2134 AS cval_customer_c_phone_1#2155, cval_customer_c_acctbal#2135 AS cval_customer_c_acctbal_1#2156, cval_customer_c_comment#2136 AS cval_customer_c_comment_1#2157, cval_customer_c_mktsegment#2137 AS cval_customer_c_mktsegment_1#2158, cdepval_customer_c_name#2138 AS cdepval_customer_c_name_1#2159, cdepval_customer_c_address#2139 AS cdepval_customer_c_address_1#2160, cdepval_customer_c_phone#2140 AS cdepval_customer_c_phone_1#2161, cdepval_customer_c_acctbal#2141 AS cdepval_customer_c_acctbal_1#2162, cdepval_customer_c_comment#2142 AS cdepval_customer_c_comment_1#2163, cdepval_customer_c_mktsegment#2143 AS cdepval_customer_c_mktsegment_1#2164, cc_name#2144 AS cc_name_1#2165, cc_address#2145 AS cc_address_1#2166, cc_phone#2146 AS cc_phone_1#2167, cc_acctbal#2147 AS cc_acctbal_1#2168, cc_comment#2148 AS cc_comment_1#2169, cc_mktsegment#2149 AS cc_mktsegment_1#2170]
            +- Relation[rid#2129,cpfk_nation_customer#2130,cfpk_customer_nation#2131,cval_customer_c_name#2132,cval_customer_c_address#2133,cval_customer_c_phone#2134,cval_customer_c_acctbal#2135,cval_customer_c_comment#2136,cval_customer_c_mktsegment#2137,cdepval_customer_c_name#2138,cdepval_customer_c_address#2139,cdepval_customer_c_phone#2140,cdepval_customer_c_acctbal#2141,cdepval_customer_c_comment#2142,cdepval_customer_c_mktsegment#2143,cc_name#2144,cc_address#2145,cc_phone#2146,cc_acctbal#2147,cc_comment#2148,cc_mktsegment#2149] JDBCRelation(tcustomer) [numPartitions=1]

20/04/25 22:40:22 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexPkFk$ result size=1500000
Elapsed time: 4873ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/25 22:40:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:40:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2221L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:40:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#2221L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#2223 AS rid_0#2268, cpfk_orders_lineitem#2224 AS cpfk_orders_lineitem_0#2269, cpfk_supplier_lineitem#2225 AS cpfk_supplier_lineitem_0#2270, cfpk_lineitem_supplier#2226 AS cfpk_lineitem_supplier_0#2271, cfpk_lineitem_partsupp#2227 AS cfpk_lineitem_partsupp_0#2272, cpfk_part_lineitem#2228 AS cpfk_part_lineitem_0#2273, cfpk_lineitem_part#2229 AS cfpk_lineitem_part_0#2274, cpfk_partsupp_lineitem#2230 AS cpfk_partsupp_lineitem_0#2275, cfpk_lineitem_orders#2231 AS cfpk_lineitem_orders_0#2276, cval_lineitem_l_quantity#2232 AS cval_lineitem_l_quantity_0#2277, cval_lineitem_l_extendedprice#2233 AS cval_lineitem_l_extendedprice_0#2278, cval_lineitem_l_discount#2234 AS cval_lineitem_l_discount_0#2279, cval_lineitem_l_tax#2235 AS cval_lineitem_l_tax_0#2280, cval_lineitem_l_returnflag#2236 AS cval_lineitem_l_returnflag_0#2281, cval_lineitem_l_linestatus#2237 AS cval_lineitem_l_linestatus_0#2282, cval_lineitem_l_commitdate#2238 AS cval_lineitem_l_commitdate_0#2283, cval_lineitem_l_receiptdate#2239 AS cval_lineitem_l_receiptdate_0#2284, cval_lineitem_l_shipinstruct#2240 AS cval_lineitem_l_shipinstruct_0#2285, cval_lineitem_l_shipmode#2241 AS cval_lineitem_l_shipmode_0#2286, cval_lineitem_l_comment#2242 AS cval_lineitem_l_comment_0#2287, cval_lineitem_l_shipdate#2243 AS cval_lineitem_l_shipdate_0#2288, cdepval_lineitem_l_quantity#2244 AS cdepval_lineitem_l_quantity_0#2289, cdepval_lineitem_l_extendedprice#2245 AS cdepval_lineitem_l_extendedprice_0#2290, cdepval_lineitem_l_discount#2246 AS cdepval_lineitem_l_discount_0#2291, ... 21 more fields]
         +- Relation[rid#2223,cpfk_orders_lineitem#2224,cpfk_supplier_lineitem#2225,cfpk_lineitem_supplier#2226,cfpk_lineitem_partsupp#2227,cpfk_part_lineitem#2228,cfpk_lineitem_part#2229,cpfk_partsupp_lineitem#2230,cfpk_lineitem_orders#2231,cval_lineitem_l_quantity#2232,cval_lineitem_l_extendedprice#2233,cval_lineitem_l_discount#2234,cval_lineitem_l_tax#2235,cval_lineitem_l_returnflag#2236,cval_lineitem_l_linestatus#2237,cval_lineitem_l_commitdate#2238,cval_lineitem_l_receiptdate#2239,cval_lineitem_l_shipinstruct#2240,cval_lineitem_l_shipmode#2241,cval_lineitem_l_comment#2242,cval_lineitem_l_shipdate#2243,cdepval_lineitem_l_quantity#2244,cdepval_lineitem_l_extendedprice#2245,cdepval_lineitem_l_discount#2246,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2348ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/25 22:40:28 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:40:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2366L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:40:28 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:40:28 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:40:28 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:40:28 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:40:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2366L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#2500 AS rid_2#2545, cpfk_orders_lineitem#2501 AS cpfk_orders_lineitem_2#2546, cpfk_supplier_lineitem#2502 AS cpfk_supplier_lineitem_2#2547, cfpk_lineitem_supplier#2503 AS cfpk_lineitem_supplier_2#2548, cfpk_lineitem_partsupp#2504 AS cfpk_lineitem_partsupp_2#2549, cpfk_part_lineitem#2505 AS cpfk_part_lineitem_2#2550, cfpk_lineitem_part#2506 AS cfpk_lineitem_part_2#2551, cpfk_partsupp_lineitem#2507 AS cpfk_partsupp_lineitem_2#2552, cfpk_lineitem_orders#2508 AS cfpk_lineitem_orders_2#2553, cval_lineitem_l_quantity#2509 AS cval_lineitem_l_quantity_2#2554, cval_lineitem_l_extendedprice#2510 AS cval_lineitem_l_extendedprice_2#2555, cval_lineitem_l_discount#2511 AS cval_lineitem_l_discount_2#2556, cval_lineitem_l_tax#2512 AS cval_lineitem_l_tax_2#2557, cval_lineitem_l_returnflag#2513 AS cval_lineitem_l_returnflag_2#2558, cval_lineitem_l_linestatus#2514 AS cval_lineitem_l_linestatus_2#2559, cval_lineitem_l_commitdate#2515 AS cval_lineitem_l_commitdate_2#2560, cval_lineitem_l_receiptdate#2516 AS cval_lineitem_l_receiptdate_2#2561, cval_lineitem_l_shipinstruct#2517 AS cval_lineitem_l_shipinstruct_2#2562, cval_lineitem_l_shipmode#2518 AS cval_lineitem_l_shipmode_2#2563, cval_lineitem_l_comment#2519 AS cval_lineitem_l_comment_2#2564, cval_lineitem_l_shipdate#2520 AS cval_lineitem_l_shipdate_2#2565, cdepval_lineitem_l_quantity#2521 AS cdepval_lineitem_l_quantity_2#2566, cdepval_lineitem_l_extendedprice#2522 AS cdepval_lineitem_l_extendedprice_2#2567, cdepval_lineitem_l_discount#2523 AS cdepval_lineitem_l_discount_2#2568, ... 21 more fields]
         :  +- Relation[rid#2500,cpfk_orders_lineitem#2501,cpfk_supplier_lineitem#2502,cfpk_lineitem_supplier#2503,cfpk_lineitem_partsupp#2504,cpfk_part_lineitem#2505,cfpk_lineitem_part#2506,cpfk_partsupp_lineitem#2507,cfpk_lineitem_orders#2508,cval_lineitem_l_quantity#2509,cval_lineitem_l_extendedprice#2510,cval_lineitem_l_discount#2511,cval_lineitem_l_tax#2512,cval_lineitem_l_returnflag#2513,cval_lineitem_l_linestatus#2514,cval_lineitem_l_commitdate#2515,cval_lineitem_l_receiptdate#2516,cval_lineitem_l_shipinstruct#2517,cval_lineitem_l_shipmode#2518,cval_lineitem_l_comment#2519,cval_lineitem_l_shipdate#2520,cdepval_lineitem_l_quantity#2521,cdepval_lineitem_l_extendedprice#2522,cdepval_lineitem_l_discount#2523,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#2452 AS rid_1#2476, cpfk_customer_orders#2453 AS cpfk_customer_orders_1#2477, cfpk_orders_customer#2454 AS cfpk_orders_customer_1#2478, cval_orders_o_orderstatus#2455 AS cval_orders_o_orderstatus_1#2479, cval_orders_o_totalprice#2456 AS cval_orders_o_totalprice_1#2480, cval_orders_o_orderpriority#2457 AS cval_orders_o_orderpriority_1#2481, cval_orders_o_clerk#2458 AS cval_orders_o_clerk_1#2482, cval_orders_o_shippriority#2459 AS cval_orders_o_shippriority_1#2483, cval_orders_o_comment#2460 AS cval_orders_o_comment_1#2484, cval_orders_o_orderdate#2461 AS cval_orders_o_orderdate_1#2485, cdepval_orders_o_orderstatus#2462 AS cdepval_orders_o_orderstatus_1#2486, cdepval_orders_o_totalprice#2463 AS cdepval_orders_o_totalprice_1#2487, cdepval_orders_o_orderpriority#2464 AS cdepval_orders_o_orderpriority_1#2488, cdepval_orders_o_clerk#2465 AS cdepval_orders_o_clerk_1#2489, cdepval_orders_o_shippriority#2466 AS cdepval_orders_o_shippriority_1#2490, cdepval_orders_o_comment#2467 AS cdepval_orders_o_comment_1#2491, cdepval_orders_o_orderdate#2468 AS cdepval_orders_o_orderdate_1#2492, co_orderstatus#2469 AS co_orderstatus_1#2493, co_totalprice#2470 AS co_totalprice_1#2494, co_orderpriority#2471 AS co_orderpriority_1#2495, co_clerk#2472 AS co_clerk_1#2496, co_shippriority#2473 AS co_shippriority_1#2497, co_comment#2474 AS co_comment_1#2498, co_orderdate#2475 AS co_orderdate_1#2499]
            :  +- Relation[rid#2452,cpfk_customer_orders#2453,cfpk_orders_customer#2454,cval_orders_o_orderstatus#2455,cval_orders_o_totalprice#2456,cval_orders_o_orderpriority#2457,cval_orders_o_clerk#2458,cval_orders_o_shippriority#2459,cval_orders_o_comment#2460,cval_orders_o_orderdate#2461,cdepval_orders_o_orderstatus#2462,cdepval_orders_o_totalprice#2463,cdepval_orders_o_orderpriority#2464,cdepval_orders_o_clerk#2465,cdepval_orders_o_shippriority#2466,cdepval_orders_o_comment#2467,cdepval_orders_o_orderdate#2468,co_orderstatus#2469,co_totalprice#2470,co_orderpriority#2471,co_clerk#2472,co_shippriority#2473,co_comment#2474,co_orderdate#2475] JDBCRelation(torders) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
               +- Project [rid#2368 AS rid_0#2389, cpfk_nation_customer#2369 AS cpfk_nation_customer_0#2390, cfpk_customer_nation#2370 AS cfpk_customer_nation_0#2391, cval_customer_c_name#2371 AS cval_customer_c_name_0#2392, cval_customer_c_address#2372 AS cval_customer_c_address_0#2393, cval_customer_c_phone#2373 AS cval_customer_c_phone_0#2394, cval_customer_c_acctbal#2374 AS cval_customer_c_acctbal_0#2395, cval_customer_c_comment#2375 AS cval_customer_c_comment_0#2396, cval_customer_c_mktsegment#2376 AS cval_customer_c_mktsegment_0#2397, cdepval_customer_c_name#2377 AS cdepval_customer_c_name_0#2398, cdepval_customer_c_address#2378 AS cdepval_customer_c_address_0#2399, cdepval_customer_c_phone#2379 AS cdepval_customer_c_phone_0#2400, cdepval_customer_c_acctbal#2380 AS cdepval_customer_c_acctbal_0#2401, cdepval_customer_c_comment#2381 AS cdepval_customer_c_comment_0#2402, cdepval_customer_c_mktsegment#2382 AS cdepval_customer_c_mktsegment_0#2403, cc_name#2383 AS cc_name_0#2404, cc_address#2384 AS cc_address_0#2405, cc_phone#2385 AS cc_phone_0#2406, cc_acctbal#2386 AS cc_acctbal_0#2407, cc_comment#2387 AS cc_comment_0#2408, cc_mktsegment#2388 AS cc_mktsegment_0#2409]
                  +- Relation[rid#2368,cpfk_nation_customer#2369,cfpk_customer_nation#2370,cval_customer_c_name#2371,cval_customer_c_address#2372,cval_customer_c_phone#2373,cval_customer_c_acctbal#2374,cval_customer_c_comment#2375,cval_customer_c_mktsegment#2376,cdepval_customer_c_name#2377,cdepval_customer_c_address#2378,cdepval_customer_c_phone#2379,cdepval_customer_c_acctbal#2380,cdepval_customer_c_comment#2381,cdepval_customer_c_mktsegment#2382,cc_name#2383,cc_address#2384,cc_phone#2385,cc_acctbal#2386,cc_comment#2387,cc_mktsegment#2388] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 38655ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/25 22:41:07 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:41:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2686L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:41:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:41:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:41:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:41:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:41:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:41:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:41:07 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:41:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:41:07 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:41:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2686L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#2760 AS rid_2#2774, cpfk_part_partsupp#2761 AS cpfk_part_partsupp_2#2775, cfpk_partsupp_part#2762 AS cfpk_partsupp_part_2#2776, cpfk_supplier_partsupp#2763 AS cpfk_supplier_partsupp_2#2777, cfpk_partsupp_supplier#2764 AS cfpk_partsupp_supplier_2#2778, cval_partsupp_ps_availqty#2765 AS cval_partsupp_ps_availqty_2#2779, cval_partsupp_ps_supplycost#2766 AS cval_partsupp_ps_supplycost_2#2780, cval_partsupp_ps_comment#2767 AS cval_partsupp_ps_comment_2#2781, cdepval_partsupp_ps_availqty#2768 AS cdepval_partsupp_ps_availqty_2#2782, cdepval_partsupp_ps_supplycost#2769 AS cdepval_partsupp_ps_supplycost_2#2783, cdepval_partsupp_ps_comment#2770 AS cdepval_partsupp_ps_comment_2#2784, cps_availqty#2771 AS cps_availqty_2#2785, cps_supplycost#2772 AS cps_supplycost_2#2786, cps_comment#2773 AS cps_comment_2#2787]
         :  +- Relation[rid#2760,cpfk_part_partsupp#2761,cfpk_partsupp_part#2762,cpfk_supplier_partsupp#2763,cfpk_partsupp_supplier#2764,cval_partsupp_ps_availqty#2765,cval_partsupp_ps_supplycost#2766,cval_partsupp_ps_comment#2767,cdepval_partsupp_ps_availqty#2768,cdepval_partsupp_ps_supplycost#2769,cdepval_partsupp_ps_comment#2770,cps_availqty#2771,cps_supplycost#2772,cps_comment#2773] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
            :- Project [rid#2724 AS rid_1#2742, cpfk_nation_supplier#2725 AS cpfk_nation_supplier_1#2743, cfpk_supplier_nation#2726 AS cfpk_supplier_nation_1#2744, cval_supplier_s_name#2727 AS cval_supplier_s_name_1#2745, cval_supplier_s_address#2728 AS cval_supplier_s_address_1#2746, cval_supplier_s_phone#2729 AS cval_supplier_s_phone_1#2747, cval_supplier_s_acctbal#2730 AS cval_supplier_s_acctbal_1#2748, cval_supplier_s_comment#2731 AS cval_supplier_s_comment_1#2749, cdepval_supplier_s_name#2732 AS cdepval_supplier_s_name_1#2750, cdepval_supplier_s_address#2733 AS cdepval_supplier_s_address_1#2751, cdepval_supplier_s_phone#2734 AS cdepval_supplier_s_phone_1#2752, cdepval_supplier_s_acctbal#2735 AS cdepval_supplier_s_acctbal_1#2753, cdepval_supplier_s_comment#2736 AS cdepval_supplier_s_comment_1#2754, cs_name#2737 AS cs_name_1#2755, cs_address#2738 AS cs_address_1#2756, cs_phone#2739 AS cs_phone_1#2757, cs_acctbal#2740 AS cs_acctbal_1#2758, cs_comment#2741 AS cs_comment_1#2759]
            :  +- Relation[rid#2724,cpfk_nation_supplier#2725,cfpk_supplier_nation#2726,cval_supplier_s_name#2727,cval_supplier_s_address#2728,cval_supplier_s_phone#2729,cval_supplier_s_acctbal#2730,cval_supplier_s_comment#2731,cdepval_supplier_s_name#2732,cdepval_supplier_s_address#2733,cdepval_supplier_s_phone#2734,cdepval_supplier_s_acctbal#2735,cdepval_supplier_s_comment#2736,cs_name#2737,cs_address#2738,cs_phone#2739,cs_acctbal#2740,cs_comment#2741] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
               +- Project [rid#2688 AS rid_0#2697, cpfk_region_nation#2689 AS cpfk_region_nation_0#2698, cfpk_nation_region#2690 AS cfpk_nation_region_0#2699, cval_nation_n_name#2691 AS cval_nation_n_name_0#2700, cval_nation_n_comment#2692 AS cval_nation_n_comment_0#2701, cdepval_nation_n_name#2693 AS cdepval_nation_n_name_0#2702, cdepval_nation_n_comment#2694 AS cdepval_nation_n_comment_0#2703, cn_name#2695 AS cn_name_0#2704, cn_comment#2696 AS cn_comment_0#2705]
                  +- Relation[rid#2688,cpfk_region_nation#2689,cfpk_nation_region#2690,cval_nation_n_name#2691,cval_nation_n_comment#2692,cdepval_nation_n_name#2693,cdepval_nation_n_comment#2694,cn_name#2695,cn_comment#2696] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 3456ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/25 22:41:10 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:41:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2836L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:41:10 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:41:10 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:41:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2836L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :- Project [rid#2938 AS rid_1#2952, cpfk_part_partsupp#2939 AS cpfk_part_partsupp_1#2953, cfpk_partsupp_part#2940 AS cfpk_partsupp_part_1#2954, cpfk_supplier_partsupp#2941 AS cpfk_supplier_partsupp_1#2955, cfpk_partsupp_supplier#2942 AS cfpk_partsupp_supplier_1#2956, cval_partsupp_ps_availqty#2943 AS cval_partsupp_ps_availqty_1#2957, cval_partsupp_ps_supplycost#2944 AS cval_partsupp_ps_supplycost_1#2958, cval_partsupp_ps_comment#2945 AS cval_partsupp_ps_comment_1#2959, cdepval_partsupp_ps_availqty#2946 AS cdepval_partsupp_ps_availqty_1#2960, cdepval_partsupp_ps_supplycost#2947 AS cdepval_partsupp_ps_supplycost_1#2961, cdepval_partsupp_ps_comment#2948 AS cdepval_partsupp_ps_comment_1#2962, cps_availqty#2949 AS cps_availqty_1#2963, cps_supplycost#2950 AS cps_supplycost_1#2964, cps_comment#2951 AS cps_comment_1#2965]
         :  +- Relation[rid#2938,cpfk_part_partsupp#2939,cfpk_partsupp_part#2940,cpfk_supplier_partsupp#2941,cfpk_partsupp_supplier#2942,cval_partsupp_ps_availqty#2943,cval_partsupp_ps_supplycost#2944,cval_partsupp_ps_comment#2945,cdepval_partsupp_ps_availqty#2946,cdepval_partsupp_ps_supplycost#2947,cdepval_partsupp_ps_comment#2948,cps_availqty#2949,cps_supplycost#2950,cps_comment#2951] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
            +- Project [rid#2838 AS rid_0#2863, cval_part_p_name#2839 AS cval_part_p_name_0#2864, cval_part_p_mfgr#2840 AS cval_part_p_mfgr_0#2865, cval_part_p_type#2841 AS cval_part_p_type_0#2866, cval_part_p_size#2842 AS cval_part_p_size_0#2867, cval_part_p_container#2843 AS cval_part_p_container_0#2868, cval_part_p_retailprice#2844 AS cval_part_p_retailprice_0#2869, cval_part_p_comment#2845 AS cval_part_p_comment_0#2870, cval_part_p_brand#2846 AS cval_part_p_brand_0#2871, cdepval_part_p_name#2847 AS cdepval_part_p_name_0#2872, cdepval_part_p_mfgr#2848 AS cdepval_part_p_mfgr_0#2873, cdepval_part_p_type#2849 AS cdepval_part_p_type_0#2874, cdepval_part_p_size#2850 AS cdepval_part_p_size_0#2875, cdepval_part_p_container#2851 AS cdepval_part_p_container_0#2876, cdepval_part_p_retailprice#2852 AS cdepval_part_p_retailprice_0#2877, cdepval_part_p_comment#2853 AS cdepval_part_p_comment_0#2878, cdepval_part_p_brand#2854 AS cdepval_part_p_brand_0#2879, cp_name#2855 AS cp_name_0#2880, cp_mfgr#2856 AS cp_mfgr_0#2881, cp_type#2857 AS cp_type_0#2882, cp_size#2858 AS cp_size_0#2883, cp_container#2859 AS cp_container_0#2884, cp_retailprice#2860 AS cp_retailprice_0#2885, cp_comment#2861 AS cp_comment_0#2886, cp_brand#2862 AS cp_brand_0#2887]
               +- Relation[rid#2838,cval_part_p_name#2839,cval_part_p_mfgr#2840,cval_part_p_type#2841,cval_part_p_size#2842,cval_part_p_container#2843,cval_part_p_retailprice#2844,cval_part_p_comment#2845,cval_part_p_brand#2846,cdepval_part_p_name#2847,cdepval_part_p_mfgr#2848,cdepval_part_p_type#2849,cdepval_part_p_size#2850,cdepval_part_p_container#2851,cdepval_part_p_retailprice#2852,cdepval_part_p_comment#2853,cdepval_part_p_brand#2854,cp_name#2855,cp_mfgr#2856,cp_type#2857,cp_size#2858,cp_container#2859,cp_retailprice#2860,cp_comment#2861,cp_brand#2862] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 3348ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/25 22:41:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:41:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3010L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:41:14 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:41:14 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:41:14 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:41:14 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:41:14 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:41:14 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:41:14 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:41:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3010L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#3037, cval_part_p_name_0#3038, cval_part_p_mfgr_0#3039, cval_part_p_type_0#3040, cval_part_p_size_0#3041, cval_part_p_container_0#3042, cval_part_p_retailprice_0#3043, cval_part_p_comment_0#3044, cval_part_p_brand_0#3045, cdepval_part_p_name_0#3046, cdepval_part_p_mfgr_0#3047, cdepval_part_p_type_0#3048, cdepval_part_p_size_0#3049, cdepval_part_p_container_0#3050, cdepval_part_p_retailprice_0#3051, cdepval_part_p_comment_0#3052, cdepval_part_p_brand_0#3053, cp_name_0#3054, cp_mfgr_0#3055, cp_type_0#3056, cp_size_0#3057, cp_container_0#3058, cp_retailprice_0#3059, cp_comment_0#3060, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#3012 AS rid_0#3037, cval_part_p_name#3013 AS cval_part_p_name_0#3038, cval_part_p_mfgr#3014 AS cval_part_p_mfgr_0#3039, cval_part_p_type#3015 AS cval_part_p_type_0#3040, cval_part_p_size#3016 AS cval_part_p_size_0#3041, cval_part_p_container#3017 AS cval_part_p_container_0#3042, cval_part_p_retailprice#3018 AS cval_part_p_retailprice_0#3043, cval_part_p_comment#3019 AS cval_part_p_comment_0#3044, cval_part_p_brand#3020 AS cval_part_p_brand_0#3045, cdepval_part_p_name#3021 AS cdepval_part_p_name_0#3046, cdepval_part_p_mfgr#3022 AS cdepval_part_p_mfgr_0#3047, cdepval_part_p_type#3023 AS cdepval_part_p_type_0#3048, cdepval_part_p_size#3024 AS cdepval_part_p_size_0#3049, cdepval_part_p_container#3025 AS cdepval_part_p_container_0#3050, cdepval_part_p_retailprice#3026 AS cdepval_part_p_retailprice_0#3051, cdepval_part_p_comment#3027 AS cdepval_part_p_comment_0#3052, cdepval_part_p_brand#3028 AS cdepval_part_p_brand_0#3053, cp_name#3029 AS cp_name_0#3054, cp_mfgr#3030 AS cp_mfgr_0#3055, cp_type#3031 AS cp_type_0#3056, cp_size#3032 AS cp_size_0#3057, cp_container#3033 AS cp_container_0#3058, cp_retailprice#3034 AS cp_retailprice_0#3059, cp_comment#3035 AS cp_comment_0#3060, cp_brand#3036 AS cp_brand_0#3061]
         :  :        +- Relation[rid#3012,cval_part_p_name#3013,cval_part_p_mfgr#3014,cval_part_p_type#3015,cval_part_p_size#3016,cval_part_p_container#3017,cval_part_p_retailprice#3018,cval_part_p_comment#3019,cval_part_p_brand#3020,cdepval_part_p_name#3021,cdepval_part_p_mfgr#3022,cdepval_part_p_type#3023,cdepval_part_p_size#3024,cdepval_part_p_container#3025,cdepval_part_p_retailprice#3026,cdepval_part_p_comment#3027,cdepval_part_p_brand#3028,cp_name#3029,cp_mfgr#3030,cp_type#3031,cp_size#3032,cp_container#3033,cp_retailprice#3034,cp_comment#3035,cp_brand#3036] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#3482 AS rid_1#3527, cpfk_orders_lineitem#3483 AS cpfk_orders_lineitem_1#3528, cpfk_supplier_lineitem#3484 AS cpfk_supplier_lineitem_1#3529, cfpk_lineitem_supplier#3485 AS cfpk_lineitem_supplier_1#3530, cfpk_lineitem_partsupp#3486 AS cfpk_lineitem_partsupp_1#3531, cpfk_part_lineitem#3487 AS cpfk_part_lineitem_1#3532, cfpk_lineitem_part#3488 AS cfpk_lineitem_part_1#3533, cpfk_partsupp_lineitem#3489 AS cpfk_partsupp_lineitem_1#3534, cfpk_lineitem_orders#3490 AS cfpk_lineitem_orders_1#3535, cval_lineitem_l_quantity#3491 AS cval_lineitem_l_quantity_1#3536, cval_lineitem_l_extendedprice#3492 AS cval_lineitem_l_extendedprice_1#3537, cval_lineitem_l_discount#3493 AS cval_lineitem_l_discount_1#3538, cval_lineitem_l_tax#3494 AS cval_lineitem_l_tax_1#3539, cval_lineitem_l_returnflag#3495 AS cval_lineitem_l_returnflag_1#3540, cval_lineitem_l_linestatus#3496 AS cval_lineitem_l_linestatus_1#3541, cval_lineitem_l_commitdate#3497 AS cval_lineitem_l_commitdate_1#3542, cval_lineitem_l_receiptdate#3498 AS cval_lineitem_l_receiptdate_1#3543, cval_lineitem_l_shipinstruct#3499 AS cval_lineitem_l_shipinstruct_1#3544, cval_lineitem_l_shipmode#3500 AS cval_lineitem_l_shipmode_1#3545, cval_lineitem_l_comment#3501 AS cval_lineitem_l_comment_1#3546, cval_lineitem_l_shipdate#3502 AS cval_lineitem_l_shipdate_1#3547, cdepval_lineitem_l_quantity#3503 AS cdepval_lineitem_l_quantity_1#3548, cdepval_lineitem_l_extendedprice#3504 AS cdepval_lineitem_l_extendedprice_1#3549, cdepval_lineitem_l_discount#3505 AS cdepval_lineitem_l_discount_1#3550, ... 21 more fields]
         :        +- Relation[rid#3482,cpfk_orders_lineitem#3483,cpfk_supplier_lineitem#3484,cfpk_lineitem_supplier#3485,cfpk_lineitem_partsupp#3486,cpfk_part_lineitem#3487,cfpk_lineitem_part#3488,cpfk_partsupp_lineitem#3489,cfpk_lineitem_orders#3490,cval_lineitem_l_quantity#3491,cval_lineitem_l_extendedprice#3492,cval_lineitem_l_discount#3493,cval_lineitem_l_tax#3494,cval_lineitem_l_returnflag#3495,cval_lineitem_l_linestatus#3496,cval_lineitem_l_commitdate#3497,cval_lineitem_l_receiptdate#3498,cval_lineitem_l_shipinstruct#3499,cval_lineitem_l_shipmode#3500,cval_lineitem_l_comment#3501,cval_lineitem_l_shipdate#3502,cdepval_lineitem_l_quantity#3503,cdepval_lineitem_l_extendedprice#3504,cdepval_lineitem_l_discount#3505,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#3162 AS rid_1#3207, cpfk_orders_lineitem#3163 AS cpfk_orders_lineitem_1#3208, cpfk_supplier_lineitem#3164 AS cpfk_supplier_lineitem_1#3209, cfpk_lineitem_supplier#3165 AS cfpk_lineitem_supplier_1#3210, cfpk_lineitem_partsupp#3166 AS cfpk_lineitem_partsupp_1#3211, cpfk_part_lineitem#3167 AS cpfk_part_lineitem_1#3212, cfpk_lineitem_part#3168 AS cfpk_lineitem_part_1#3213, cpfk_partsupp_lineitem#3169 AS cpfk_partsupp_lineitem_1#3214, cfpk_lineitem_orders#3170 AS cfpk_lineitem_orders_1#3215, cval_lineitem_l_quantity#3171 AS cval_lineitem_l_quantity_1#3216, cval_lineitem_l_extendedprice#3172 AS cval_lineitem_l_extendedprice_1#3217, cval_lineitem_l_discount#3173 AS cval_lineitem_l_discount_1#3218, cval_lineitem_l_tax#3174 AS cval_lineitem_l_tax_1#3219, cval_lineitem_l_returnflag#3175 AS cval_lineitem_l_returnflag_1#3220, cval_lineitem_l_linestatus#3176 AS cval_lineitem_l_linestatus_1#3221, cval_lineitem_l_commitdate#3177 AS cval_lineitem_l_commitdate_1#3222, cval_lineitem_l_receiptdate#3178 AS cval_lineitem_l_receiptdate_1#3223, cval_lineitem_l_shipinstruct#3179 AS cval_lineitem_l_shipinstruct_1#3224, cval_lineitem_l_shipmode#3180 AS cval_lineitem_l_shipmode_1#3225, cval_lineitem_l_comment#3181 AS cval_lineitem_l_comment_1#3226, cval_lineitem_l_shipdate#3182 AS cval_lineitem_l_shipdate_1#3227, cdepval_lineitem_l_quantity#3183 AS cdepval_lineitem_l_quantity_1#3228, cdepval_lineitem_l_extendedprice#3184 AS cdepval_lineitem_l_extendedprice_1#3229, cdepval_lineitem_l_discount#3185 AS cdepval_lineitem_l_discount_1#3230, ... 21 more fields]
                  +- Relation[rid#3162,cpfk_orders_lineitem#3163,cpfk_supplier_lineitem#3164,cfpk_lineitem_supplier#3165,cfpk_lineitem_partsupp#3166,cpfk_part_lineitem#3167,cfpk_lineitem_part#3168,cpfk_partsupp_lineitem#3169,cfpk_lineitem_orders#3170,cval_lineitem_l_quantity#3171,cval_lineitem_l_extendedprice#3172,cval_lineitem_l_discount#3173,cval_lineitem_l_tax#3174,cval_lineitem_l_returnflag#3175,cval_lineitem_l_linestatus#3176,cval_lineitem_l_commitdate#3177,cval_lineitem_l_receiptdate#3178,cval_lineitem_l_shipinstruct#3179,cval_lineitem_l_shipmode#3180,cval_lineitem_l_comment#3181,cval_lineitem_l_shipdate#3182,cdepval_lineitem_l_quantity#3183,cdepval_lineitem_l_extendedprice#3184,cdepval_lineitem_l_discount#3185,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 16441ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/25 22:41:30 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:41:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3646L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:41:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3646L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#3648 AS rid_0#3693, cpfk_orders_lineitem#3649 AS cpfk_orders_lineitem_0#3694, cpfk_supplier_lineitem#3650 AS cpfk_supplier_lineitem_0#3695, cfpk_lineitem_supplier#3651 AS cfpk_lineitem_supplier_0#3696, cfpk_lineitem_partsupp#3652 AS cfpk_lineitem_partsupp_0#3697, cpfk_part_lineitem#3653 AS cpfk_part_lineitem_0#3698, cfpk_lineitem_part#3654 AS cfpk_lineitem_part_0#3699, cpfk_partsupp_lineitem#3655 AS cpfk_partsupp_lineitem_0#3700, cfpk_lineitem_orders#3656 AS cfpk_lineitem_orders_0#3701, cval_lineitem_l_quantity#3657 AS cval_lineitem_l_quantity_0#3702, cval_lineitem_l_extendedprice#3658 AS cval_lineitem_l_extendedprice_0#3703, cval_lineitem_l_discount#3659 AS cval_lineitem_l_discount_0#3704, cval_lineitem_l_tax#3660 AS cval_lineitem_l_tax_0#3705, cval_lineitem_l_returnflag#3661 AS cval_lineitem_l_returnflag_0#3706, cval_lineitem_l_linestatus#3662 AS cval_lineitem_l_linestatus_0#3707, cval_lineitem_l_commitdate#3663 AS cval_lineitem_l_commitdate_0#3708, cval_lineitem_l_receiptdate#3664 AS cval_lineitem_l_receiptdate_0#3709, cval_lineitem_l_shipinstruct#3665 AS cval_lineitem_l_shipinstruct_0#3710, cval_lineitem_l_shipmode#3666 AS cval_lineitem_l_shipmode_0#3711, cval_lineitem_l_comment#3667 AS cval_lineitem_l_comment_0#3712, cval_lineitem_l_shipdate#3668 AS cval_lineitem_l_shipdate_0#3713, cdepval_lineitem_l_quantity#3669 AS cdepval_lineitem_l_quantity_0#3714, cdepval_lineitem_l_extendedprice#3670 AS cdepval_lineitem_l_extendedprice_0#3715, cdepval_lineitem_l_discount#3671 AS cdepval_lineitem_l_discount_0#3716, ... 21 more fields]
         :     +- Relation[rid#3648,cpfk_orders_lineitem#3649,cpfk_supplier_lineitem#3650,cfpk_lineitem_supplier#3651,cfpk_lineitem_partsupp#3652,cpfk_part_lineitem#3653,cfpk_lineitem_part#3654,cpfk_partsupp_lineitem#3655,cfpk_lineitem_orders#3656,cval_lineitem_l_quantity#3657,cval_lineitem_l_extendedprice#3658,cval_lineitem_l_discount#3659,cval_lineitem_l_tax#3660,cval_lineitem_l_returnflag#3661,cval_lineitem_l_linestatus#3662,cval_lineitem_l_commitdate#3663,cval_lineitem_l_receiptdate#3664,cval_lineitem_l_shipinstruct#3665,cval_lineitem_l_shipmode#3666,cval_lineitem_l_comment#3667,cval_lineitem_l_shipdate#3668,cdepval_lineitem_l_quantity#3669,cdepval_lineitem_l_extendedprice#3670,cdepval_lineitem_l_discount#3671,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#3828 AS rid_1#3852, cpfk_customer_orders#3829 AS cpfk_customer_orders_1#3853, cfpk_orders_customer#3830 AS cfpk_orders_customer_1#3854, cval_orders_o_orderstatus#3831 AS cval_orders_o_orderstatus_1#3855, cval_orders_o_totalprice#3832 AS cval_orders_o_totalprice_1#3856, cval_orders_o_orderpriority#3833 AS cval_orders_o_orderpriority_1#3857, cval_orders_o_clerk#3834 AS cval_orders_o_clerk_1#3858, cval_orders_o_shippriority#3835 AS cval_orders_o_shippriority_1#3859, cval_orders_o_comment#3836 AS cval_orders_o_comment_1#3860, cval_orders_o_orderdate#3837 AS cval_orders_o_orderdate_1#3861, cdepval_orders_o_orderstatus#3838 AS cdepval_orders_o_orderstatus_1#3862, cdepval_orders_o_totalprice#3839 AS cdepval_orders_o_totalprice_1#3863, cdepval_orders_o_orderpriority#3840 AS cdepval_orders_o_orderpriority_1#3864, cdepval_orders_o_clerk#3841 AS cdepval_orders_o_clerk_1#3865, cdepval_orders_o_shippriority#3842 AS cdepval_orders_o_shippriority_1#3866, cdepval_orders_o_comment#3843 AS cdepval_orders_o_comment_1#3867, cdepval_orders_o_orderdate#3844 AS cdepval_orders_o_orderdate_1#3868, co_orderstatus#3845 AS co_orderstatus_1#3869, co_totalprice#3846 AS co_totalprice_1#3870, co_orderpriority#3847 AS co_orderpriority_1#3871, co_clerk#3848 AS co_clerk_1#3872, co_shippriority#3849 AS co_shippriority_1#3873, co_comment#3850 AS co_comment_1#3874, co_orderdate#3851 AS co_orderdate_1#3875]
            +- Relation[rid#3828,cpfk_customer_orders#3829,cfpk_orders_customer#3830,cval_orders_o_orderstatus#3831,cval_orders_o_totalprice#3832,cval_orders_o_orderpriority#3833,cval_orders_o_clerk#3834,cval_orders_o_shippriority#3835,cval_orders_o_comment#3836,cval_orders_o_orderdate#3837,cdepval_orders_o_orderstatus#3838,cdepval_orders_o_totalprice#3839,cdepval_orders_o_orderpriority#3840,cdepval_orders_o_clerk#3841,cdepval_orders_o_shippriority#3842,cdepval_orders_o_comment#3843,cdepval_orders_o_orderdate#3844,co_orderstatus#3845,co_totalprice#3846,co_orderpriority#3847,co_clerk#3848,co_shippriority#3849,co_comment#3850,co_orderdate#3851] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 22553ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/25 22:41:53 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:41:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3954L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:41:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3954L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#4046 AS rid_2#4091, cpfk_orders_lineitem#4047 AS cpfk_orders_lineitem_2#4092, cpfk_supplier_lineitem#4048 AS cpfk_supplier_lineitem_2#4093, cfpk_lineitem_supplier#4049 AS cfpk_lineitem_supplier_2#4094, cfpk_lineitem_partsupp#4050 AS cfpk_lineitem_partsupp_2#4095, cpfk_part_lineitem#4051 AS cpfk_part_lineitem_2#4096, cfpk_lineitem_part#4052 AS cfpk_lineitem_part_2#4097, cpfk_partsupp_lineitem#4053 AS cpfk_partsupp_lineitem_2#4098, cfpk_lineitem_orders#4054 AS cfpk_lineitem_orders_2#4099, cval_lineitem_l_quantity#4055 AS cval_lineitem_l_quantity_2#4100, cval_lineitem_l_extendedprice#4056 AS cval_lineitem_l_extendedprice_2#4101, cval_lineitem_l_discount#4057 AS cval_lineitem_l_discount_2#4102, cval_lineitem_l_tax#4058 AS cval_lineitem_l_tax_2#4103, cval_lineitem_l_returnflag#4059 AS cval_lineitem_l_returnflag_2#4104, cval_lineitem_l_linestatus#4060 AS cval_lineitem_l_linestatus_2#4105, cval_lineitem_l_commitdate#4061 AS cval_lineitem_l_commitdate_2#4106, cval_lineitem_l_receiptdate#4062 AS cval_lineitem_l_receiptdate_2#4107, cval_lineitem_l_shipinstruct#4063 AS cval_lineitem_l_shipinstruct_2#4108, cval_lineitem_l_shipmode#4064 AS cval_lineitem_l_shipmode_2#4109, cval_lineitem_l_comment#4065 AS cval_lineitem_l_comment_2#4110, cval_lineitem_l_shipdate#4066 AS cval_lineitem_l_shipdate_2#4111, cdepval_lineitem_l_quantity#4067 AS cdepval_lineitem_l_quantity_2#4112, cdepval_lineitem_l_extendedprice#4068 AS cdepval_lineitem_l_extendedprice_2#4113, cdepval_lineitem_l_discount#4069 AS cdepval_lineitem_l_discount_2#4114, ... 21 more fields]
         :  +- Relation[rid#4046,cpfk_orders_lineitem#4047,cpfk_supplier_lineitem#4048,cfpk_lineitem_supplier#4049,cfpk_lineitem_partsupp#4050,cpfk_part_lineitem#4051,cfpk_lineitem_part#4052,cpfk_partsupp_lineitem#4053,cfpk_lineitem_orders#4054,cval_lineitem_l_quantity#4055,cval_lineitem_l_extendedprice#4056,cval_lineitem_l_discount#4057,cval_lineitem_l_tax#4058,cval_lineitem_l_returnflag#4059,cval_lineitem_l_linestatus#4060,cval_lineitem_l_commitdate#4061,cval_lineitem_l_receiptdate#4062,cval_lineitem_l_shipinstruct#4063,cval_lineitem_l_shipmode#4064,cval_lineitem_l_comment#4065,cval_lineitem_l_shipdate#4066,cdepval_lineitem_l_quantity#4067,cdepval_lineitem_l_extendedprice#4068,cdepval_lineitem_l_discount#4069,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#3998 AS rid_1#4022, cpfk_customer_orders#3999 AS cpfk_customer_orders_1#4023, cfpk_orders_customer#4000 AS cfpk_orders_customer_1#4024, cval_orders_o_orderstatus#4001 AS cval_orders_o_orderstatus_1#4025, cval_orders_o_totalprice#4002 AS cval_orders_o_totalprice_1#4026, cval_orders_o_orderpriority#4003 AS cval_orders_o_orderpriority_1#4027, cval_orders_o_clerk#4004 AS cval_orders_o_clerk_1#4028, cval_orders_o_shippriority#4005 AS cval_orders_o_shippriority_1#4029, cval_orders_o_comment#4006 AS cval_orders_o_comment_1#4030, cval_orders_o_orderdate#4007 AS cval_orders_o_orderdate_1#4031, cdepval_orders_o_orderstatus#4008 AS cdepval_orders_o_orderstatus_1#4032, cdepval_orders_o_totalprice#4009 AS cdepval_orders_o_totalprice_1#4033, cdepval_orders_o_orderpriority#4010 AS cdepval_orders_o_orderpriority_1#4034, cdepval_orders_o_clerk#4011 AS cdepval_orders_o_clerk_1#4035, cdepval_orders_o_shippriority#4012 AS cdepval_orders_o_shippriority_1#4036, cdepval_orders_o_comment#4013 AS cdepval_orders_o_comment_1#4037, cdepval_orders_o_orderdate#4014 AS cdepval_orders_o_orderdate_1#4038, co_orderstatus#4015 AS co_orderstatus_1#4039, co_totalprice#4016 AS co_totalprice_1#4040, co_orderpriority#4017 AS co_orderpriority_1#4041, co_clerk#4018 AS co_clerk_1#4042, co_shippriority#4019 AS co_shippriority_1#4043, co_comment#4020 AS co_comment_1#4044, co_orderdate#4021 AS co_orderdate_1#4045]
            :  +- Relation[rid#3998,cpfk_customer_orders#3999,cfpk_orders_customer#4000,cval_orders_o_orderstatus#4001,cval_orders_o_totalprice#4002,cval_orders_o_orderpriority#4003,cval_orders_o_clerk#4004,cval_orders_o_shippriority#4005,cval_orders_o_comment#4006,cval_orders_o_orderdate#4007,cdepval_orders_o_orderstatus#4008,cdepval_orders_o_totalprice#4009,cdepval_orders_o_orderpriority#4010,cdepval_orders_o_clerk#4011,cdepval_orders_o_shippriority#4012,cdepval_orders_o_comment#4013,cdepval_orders_o_orderdate#4014,co_orderstatus#4015,co_totalprice#4016,co_orderpriority#4017,co_clerk#4018,co_shippriority#4019,co_comment#4020,co_orderdate#4021] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#3956 AS rid_0#3977, cpfk_nation_customer#3957 AS cpfk_nation_customer_0#3978, cfpk_customer_nation#3958 AS cfpk_customer_nation_0#3979, cval_customer_c_name#3959 AS cval_customer_c_name_0#3980, cval_customer_c_address#3960 AS cval_customer_c_address_0#3981, cval_customer_c_phone#3961 AS cval_customer_c_phone_0#3982, cval_customer_c_acctbal#3962 AS cval_customer_c_acctbal_0#3983, cval_customer_c_comment#3963 AS cval_customer_c_comment_0#3984, cval_customer_c_mktsegment#3964 AS cval_customer_c_mktsegment_0#3985, cdepval_customer_c_name#3965 AS cdepval_customer_c_name_0#3986, cdepval_customer_c_address#3966 AS cdepval_customer_c_address_0#3987, cdepval_customer_c_phone#3967 AS cdepval_customer_c_phone_0#3988, cdepval_customer_c_acctbal#3968 AS cdepval_customer_c_acctbal_0#3989, cdepval_customer_c_comment#3969 AS cdepval_customer_c_comment_0#3990, cdepval_customer_c_mktsegment#3970 AS cdepval_customer_c_mktsegment_0#3991, cc_name#3971 AS cc_name_0#3992, cc_address#3972 AS cc_address_0#3993, cc_phone#3973 AS cc_phone_0#3994, cc_acctbal#3974 AS cc_acctbal_0#3995, cc_comment#3975 AS cc_comment_0#3996, cc_mktsegment#3976 AS cc_mktsegment_0#3997]
               +- Relation[rid#3956,cpfk_nation_customer#3957,cfpk_customer_nation#3958,cval_customer_c_name#3959,cval_customer_c_address#3960,cval_customer_c_phone#3961,cval_customer_c_acctbal#3962,cval_customer_c_comment#3963,cval_customer_c_mktsegment#3964,cdepval_customer_c_name#3965,cdepval_customer_c_address#3966,cdepval_customer_c_phone#3967,cdepval_customer_c_acctbal#3968,cdepval_customer_c_comment#3969,cdepval_customer_c_mktsegment#3970,cc_name#3971,cc_address#3972,cc_phone#3973,cc_acctbal#3974,cc_comment#3975,cc_mktsegment#3976] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 22322ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/25 22:42:15 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:42:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4233L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:42:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:42:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:42:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:42:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:42:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:42:15 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:42:15 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:42:15 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:42:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:42:15 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:42:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:42:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:42:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4233L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :  :  :  :- Project [rid#4335 AS rid_1#4380, cpfk_orders_lineitem#4336 AS cpfk_orders_lineitem_1#4381, cpfk_supplier_lineitem#4337 AS cpfk_supplier_lineitem_1#4382, cfpk_lineitem_supplier#4338 AS cfpk_lineitem_supplier_1#4383, cfpk_lineitem_partsupp#4339 AS cfpk_lineitem_partsupp_1#4384, cpfk_part_lineitem#4340 AS cpfk_part_lineitem_1#4385, cfpk_lineitem_part#4341 AS cfpk_lineitem_part_1#4386, cpfk_partsupp_lineitem#4342 AS cpfk_partsupp_lineitem_1#4387, cfpk_lineitem_orders#4343 AS cfpk_lineitem_orders_1#4388, cval_lineitem_l_quantity#4344 AS cval_lineitem_l_quantity_1#4389, cval_lineitem_l_extendedprice#4345 AS cval_lineitem_l_extendedprice_1#4390, cval_lineitem_l_discount#4346 AS cval_lineitem_l_discount_1#4391, cval_lineitem_l_tax#4347 AS cval_lineitem_l_tax_1#4392, cval_lineitem_l_returnflag#4348 AS cval_lineitem_l_returnflag_1#4393, cval_lineitem_l_linestatus#4349 AS cval_lineitem_l_linestatus_1#4394, cval_lineitem_l_commitdate#4350 AS cval_lineitem_l_commitdate_1#4395, cval_lineitem_l_receiptdate#4351 AS cval_lineitem_l_receiptdate_1#4396, cval_lineitem_l_shipinstruct#4352 AS cval_lineitem_l_shipinstruct_1#4397, cval_lineitem_l_shipmode#4353 AS cval_lineitem_l_shipmode_1#4398, cval_lineitem_l_comment#4354 AS cval_lineitem_l_comment_1#4399, cval_lineitem_l_shipdate#4355 AS cval_lineitem_l_shipdate_1#4400, cdepval_lineitem_l_quantity#4356 AS cdepval_lineitem_l_quantity_1#4401, cdepval_lineitem_l_extendedprice#4357 AS cdepval_lineitem_l_extendedprice_1#4402, cdepval_lineitem_l_discount#4358 AS cdepval_lineitem_l_discount_1#4403, ... 21 more fields]
         :  :  :  :  +- Relation[rid#4335,cpfk_orders_lineitem#4336,cpfk_supplier_lineitem#4337,cfpk_lineitem_supplier#4338,cfpk_lineitem_partsupp#4339,cpfk_part_lineitem#4340,cfpk_lineitem_part#4341,cpfk_partsupp_lineitem#4342,cfpk_lineitem_orders#4343,cval_lineitem_l_quantity#4344,cval_lineitem_l_extendedprice#4345,cval_lineitem_l_discount#4346,cval_lineitem_l_tax#4347,cval_lineitem_l_returnflag#4348,cval_lineitem_l_linestatus#4349,cval_lineitem_l_commitdate#4350,cval_lineitem_l_receiptdate#4351,cval_lineitem_l_shipinstruct#4352,cval_lineitem_l_shipmode#4353,cval_lineitem_l_comment#4354,cval_lineitem_l_shipdate#4355,cdepval_lineitem_l_quantity#4356,cdepval_lineitem_l_extendedprice#4357,cdepval_lineitem_l_discount#4358,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :     +- Project [rid#4235 AS rid_0#4260, cval_part_p_name#4236 AS cval_part_p_name_0#4261, cval_part_p_mfgr#4237 AS cval_part_p_mfgr_0#4262, cval_part_p_type#4238 AS cval_part_p_type_0#4263, cval_part_p_size#4239 AS cval_part_p_size_0#4264, cval_part_p_container#4240 AS cval_part_p_container_0#4265, cval_part_p_retailprice#4241 AS cval_part_p_retailprice_0#4266, cval_part_p_comment#4242 AS cval_part_p_comment_0#4267, cval_part_p_brand#4243 AS cval_part_p_brand_0#4268, cdepval_part_p_name#4244 AS cdepval_part_p_name_0#4269, cdepval_part_p_mfgr#4245 AS cdepval_part_p_mfgr_0#4270, cdepval_part_p_type#4246 AS cdepval_part_p_type_0#4271, cdepval_part_p_size#4247 AS cdepval_part_p_size_0#4272, cdepval_part_p_container#4248 AS cdepval_part_p_container_0#4273, cdepval_part_p_retailprice#4249 AS cdepval_part_p_retailprice_0#4274, cdepval_part_p_comment#4250 AS cdepval_part_p_comment_0#4275, cdepval_part_p_brand#4251 AS cdepval_part_p_brand_0#4276, cp_name#4252 AS cp_name_0#4277, cp_mfgr#4253 AS cp_mfgr_0#4278, cp_type#4254 AS cp_type_0#4279, cp_size#4255 AS cp_size_0#4280, cp_container#4256 AS cp_container_0#4281, cp_retailprice#4257 AS cp_retailprice_0#4282, cp_comment#4258 AS cp_comment_0#4283, cp_brand#4259 AS cp_brand_0#4284]
         :  :  :        +- Relation[rid#4235,cval_part_p_name#4236,cval_part_p_mfgr#4237,cval_part_p_type#4238,cval_part_p_size#4239,cval_part_p_container#4240,cval_part_p_retailprice#4241,cval_part_p_comment#4242,cval_part_p_brand#4243,cdepval_part_p_name#4244,cdepval_part_p_mfgr#4245,cdepval_part_p_type#4246,cdepval_part_p_size#4247,cdepval_part_p_container#4248,cdepval_part_p_retailprice#4249,cdepval_part_p_comment#4250,cdepval_part_p_brand#4251,cp_name#4252,cp_mfgr#4253,cp_type#4254,cp_size#4255,cp_container#4256,cp_retailprice#4257,cp_comment#4258,cp_brand#4259] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- Project [rid#4425 AS rid_2#4443, cpfk_nation_supplier#4426 AS cpfk_nation_supplier_2#4444, cfpk_supplier_nation#4427 AS cfpk_supplier_nation_2#4445, cval_supplier_s_name#4428 AS cval_supplier_s_name_2#4446, cval_supplier_s_address#4429 AS cval_supplier_s_address_2#4447, cval_supplier_s_phone#4430 AS cval_supplier_s_phone_2#4448, cval_supplier_s_acctbal#4431 AS cval_supplier_s_acctbal_2#4449, cval_supplier_s_comment#4432 AS cval_supplier_s_comment_2#4450, cdepval_supplier_s_name#4433 AS cdepval_supplier_s_name_2#4451, cdepval_supplier_s_address#4434 AS cdepval_supplier_s_address_2#4452, cdepval_supplier_s_phone#4435 AS cdepval_supplier_s_phone_2#4453, cdepval_supplier_s_acctbal#4436 AS cdepval_supplier_s_acctbal_2#4454, cdepval_supplier_s_comment#4437 AS cdepval_supplier_s_comment_2#4455, cs_name#4438 AS cs_name_2#4456, cs_address#4439 AS cs_address_2#4457, cs_phone#4440 AS cs_phone_2#4458, cs_acctbal#4441 AS cs_acctbal_2#4459, cs_comment#4442 AS cs_comment_2#4460]
         :  :     +- Relation[rid#4425,cpfk_nation_supplier#4426,cfpk_supplier_nation#4427,cval_supplier_s_name#4428,cval_supplier_s_address#4429,cval_supplier_s_phone#4430,cval_supplier_s_acctbal#4431,cval_supplier_s_comment#4432,cdepval_supplier_s_name#4433,cdepval_supplier_s_address#4434,cdepval_supplier_s_phone#4435,cdepval_supplier_s_acctbal#4436,cdepval_supplier_s_comment#4437,cs_name#4438,cs_address#4439,cs_phone#4440,cs_acctbal#4441,cs_comment#4442] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#4461 AS rid_3#4470, cpfk_region_nation#4462 AS cpfk_region_nation_3#4471, cfpk_nation_region#4463 AS cfpk_nation_region_3#4472, cval_nation_n_name#4464 AS cval_nation_n_name_3#4473, cval_nation_n_comment#4465 AS cval_nation_n_comment_3#4474, cdepval_nation_n_name#4466 AS cdepval_nation_n_name_3#4475, cdepval_nation_n_comment#4467 AS cdepval_nation_n_comment_3#4476, cn_name#4468 AS cn_name_3#4477, cn_comment#4469 AS cn_comment_3#4478]
         :     +- Relation[rid#4461,cpfk_region_nation#4462,cfpk_nation_region#4463,cval_nation_n_name#4464,cval_nation_n_comment#4465,cdepval_nation_n_name#4466,cdepval_nation_n_comment#4467,cn_name#4468,cn_comment#4469] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#4567 AS rid_7#4591, cpfk_customer_orders#4568 AS cpfk_customer_orders_7#4592, cfpk_orders_customer#4569 AS cfpk_orders_customer_7#4593, cval_orders_o_orderstatus#4570 AS cval_orders_o_orderstatus_7#4594, cval_orders_o_totalprice#4571 AS cval_orders_o_totalprice_7#4595, cval_orders_o_orderpriority#4572 AS cval_orders_o_orderpriority_7#4596, cval_orders_o_clerk#4573 AS cval_orders_o_clerk_7#4597, cval_orders_o_shippriority#4574 AS cval_orders_o_shippriority_7#4598, cval_orders_o_comment#4575 AS cval_orders_o_comment_7#4599, cval_orders_o_orderdate#4576 AS cval_orders_o_orderdate_7#4600, cdepval_orders_o_orderstatus#4577 AS cdepval_orders_o_orderstatus_7#4601, cdepval_orders_o_totalprice#4578 AS cdepval_orders_o_totalprice_7#4602, cdepval_orders_o_orderpriority#4579 AS cdepval_orders_o_orderpriority_7#4603, cdepval_orders_o_clerk#4580 AS cdepval_orders_o_clerk_7#4604, cdepval_orders_o_shippriority#4581 AS cdepval_orders_o_shippriority_7#4605, cdepval_orders_o_comment#4582 AS cdepval_orders_o_comment_7#4606, cdepval_orders_o_orderdate#4583 AS cdepval_orders_o_orderdate_7#4607, co_orderstatus#4584 AS co_orderstatus_7#4608, co_totalprice#4585 AS co_totalprice_7#4609, co_orderpriority#4586 AS co_orderpriority_7#4610, co_clerk#4587 AS co_clerk_7#4611, co_shippriority#4588 AS co_shippriority_7#4612, co_comment#4589 AS co_comment_7#4613, co_orderdate#4590 AS co_orderdate_7#4614]
            :  +- Relation[rid#4567,cpfk_customer_orders#4568,cfpk_orders_customer#4569,cval_orders_o_orderstatus#4570,cval_orders_o_totalprice#4571,cval_orders_o_orderpriority#4572,cval_orders_o_clerk#4573,cval_orders_o_shippriority#4574,cval_orders_o_comment#4575,cval_orders_o_orderdate#4576,cdepval_orders_o_orderstatus#4577,cdepval_orders_o_totalprice#4578,cdepval_orders_o_orderpriority#4579,cdepval_orders_o_clerk#4580,cdepval_orders_o_shippriority#4581,cdepval_orders_o_comment#4582,cdepval_orders_o_orderdate#4583,co_orderstatus#4584,co_totalprice#4585,co_orderpriority#4586,co_clerk#4587,co_shippriority#4588,co_comment#4589,co_orderdate#4590] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#4525 AS rid_6#4546, cpfk_nation_customer#4526 AS cpfk_nation_customer_6#4547, cfpk_customer_nation#4527 AS cfpk_customer_nation_6#4548, cval_customer_c_name#4528 AS cval_customer_c_name_6#4549, cval_customer_c_address#4529 AS cval_customer_c_address_6#4550, cval_customer_c_phone#4530 AS cval_customer_c_phone_6#4551, cval_customer_c_acctbal#4531 AS cval_customer_c_acctbal_6#4552, cval_customer_c_comment#4532 AS cval_customer_c_comment_6#4553, cval_customer_c_mktsegment#4533 AS cval_customer_c_mktsegment_6#4554, cdepval_customer_c_name#4534 AS cdepval_customer_c_name_6#4555, cdepval_customer_c_address#4535 AS cdepval_customer_c_address_6#4556, cdepval_customer_c_phone#4536 AS cdepval_customer_c_phone_6#4557, cdepval_customer_c_acctbal#4537 AS cdepval_customer_c_acctbal_6#4558, cdepval_customer_c_comment#4538 AS cdepval_customer_c_comment_6#4559, cdepval_customer_c_mktsegment#4539 AS cdepval_customer_c_mktsegment_6#4560, cc_name#4540 AS cc_name_6#4561, cc_address#4541 AS cc_address_6#4562, cc_phone#4542 AS cc_phone_6#4563, cc_acctbal#4543 AS cc_acctbal_6#4564, cc_comment#4544 AS cc_comment_6#4565, cc_mktsegment#4545 AS cc_mktsegment_6#4566]
               :  +- Relation[rid#4525,cpfk_nation_customer#4526,cfpk_customer_nation#4527,cval_customer_c_name#4528,cval_customer_c_address#4529,cval_customer_c_phone#4530,cval_customer_c_acctbal#4531,cval_customer_c_comment#4532,cval_customer_c_mktsegment#4533,cdepval_customer_c_name#4534,cdepval_customer_c_address#4535,cdepval_customer_c_phone#4536,cdepval_customer_c_acctbal#4537,cdepval_customer_c_comment#4538,cdepval_customer_c_mktsegment#4539,cc_name#4540,cc_address#4541,cc_phone#4542,cc_acctbal#4543,cc_comment#4544,cc_mktsegment#4545] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_5, BinaryType)), 'cfpk_nation_region_5) = 'rid_4)
                  :- Project [rid#4507 AS rid_5#4516, cpfk_region_nation#4508 AS cpfk_region_nation_5#4517, cfpk_nation_region#4509 AS cfpk_nation_region_5#4518, cval_nation_n_name#4510 AS cval_nation_n_name_5#4519, cval_nation_n_comment#4511 AS cval_nation_n_comment_5#4520, cdepval_nation_n_name#4512 AS cdepval_nation_n_name_5#4521, cdepval_nation_n_comment#4513 AS cdepval_nation_n_comment_5#4522, cn_name#4514 AS cn_name_5#4523, cn_comment#4515 AS cn_comment_5#4524]
                  :  +- Relation[rid#4507,cpfk_region_nation#4508,cfpk_nation_region#4509,cval_nation_n_name#4510,cval_nation_n_comment#4511,cdepval_nation_n_name#4512,cdepval_nation_n_comment#4513,cn_name#4514,cn_comment#4515] JDBCRelation(tnation) [numPartitions=1]
                  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                     +- Project [rid#4479 AS rid_4#4486, cval_region_r_name#4480 AS cval_region_r_name_4#4487, cval_region_r_comment#4481 AS cval_region_r_comment_4#4488, cdepval_region_r_name#4482 AS cdepval_region_r_name_4#4489, cdepval_region_r_comment#4483 AS cdepval_region_r_comment_4#4490, cr_name#4484 AS cr_name_4#4491, cr_comment#4485 AS cr_comment_4#4492]
                        +- Relation[rid#4479,cval_region_r_name#4480,cval_region_r_comment#4481,cdepval_region_r_name#4482,cdepval_region_r_comment#4483,cr_name#4484,cr_comment#4485] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 44918ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/25 22:43:00 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:43:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4777L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:43:00 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:43:00 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:43:00 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:43:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:43:00 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:43:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:43:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:43:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:43:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:43:00 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:43:00 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:43:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:43:00 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:43:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4777L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_part_4) = 'rid_3)
         :  :- Project [rid#4961 AS rid_4#4975, cpfk_part_partsupp#4962 AS cpfk_part_partsupp_4#4976, cfpk_partsupp_part#4963 AS cfpk_partsupp_part_4#4977, cpfk_supplier_partsupp#4964 AS cpfk_supplier_partsupp_4#4978, cfpk_partsupp_supplier#4965 AS cfpk_partsupp_supplier_4#4979, cval_partsupp_ps_availqty#4966 AS cval_partsupp_ps_availqty_4#4980, cval_partsupp_ps_supplycost#4967 AS cval_partsupp_ps_supplycost_4#4981, cval_partsupp_ps_comment#4968 AS cval_partsupp_ps_comment_4#4982, cdepval_partsupp_ps_availqty#4969 AS cdepval_partsupp_ps_availqty_4#4983, cdepval_partsupp_ps_supplycost#4970 AS cdepval_partsupp_ps_supplycost_4#4984, cdepval_partsupp_ps_comment#4971 AS cdepval_partsupp_ps_comment_4#4985, cps_availqty#4972 AS cps_availqty_4#4986, cps_supplycost#4973 AS cps_supplycost_4#4987, cps_comment#4974 AS cps_comment_4#4988]
         :  :  +- Relation[rid#4961,cpfk_part_partsupp#4962,cfpk_partsupp_part#4963,cpfk_supplier_partsupp#4964,cfpk_partsupp_supplier#4965,cval_partsupp_ps_availqty#4966,cval_partsupp_ps_supplycost#4967,cval_partsupp_ps_comment#4968,cdepval_partsupp_ps_availqty#4969,cdepval_partsupp_ps_supplycost#4970,cdepval_partsupp_ps_comment#4971,cps_availqty#4972,cps_supplycost#4973,cps_comment#4974] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :     +- Project [rid#4861 AS rid_3#4886, cval_part_p_name#4862 AS cval_part_p_name_3#4887, cval_part_p_mfgr#4863 AS cval_part_p_mfgr_3#4888, cval_part_p_type#4864 AS cval_part_p_type_3#4889, cval_part_p_size#4865 AS cval_part_p_size_3#4890, cval_part_p_container#4866 AS cval_part_p_container_3#4891, cval_part_p_retailprice#4867 AS cval_part_p_retailprice_3#4892, cval_part_p_comment#4868 AS cval_part_p_comment_3#4893, cval_part_p_brand#4869 AS cval_part_p_brand_3#4894, cdepval_part_p_name#4870 AS cdepval_part_p_name_3#4895, cdepval_part_p_mfgr#4871 AS cdepval_part_p_mfgr_3#4896, cdepval_part_p_type#4872 AS cdepval_part_p_type_3#4897, cdepval_part_p_size#4873 AS cdepval_part_p_size_3#4898, cdepval_part_p_container#4874 AS cdepval_part_p_container_3#4899, cdepval_part_p_retailprice#4875 AS cdepval_part_p_retailprice_3#4900, cdepval_part_p_comment#4876 AS cdepval_part_p_comment_3#4901, cdepval_part_p_brand#4877 AS cdepval_part_p_brand_3#4902, cp_name#4878 AS cp_name_3#4903, cp_mfgr#4879 AS cp_mfgr_3#4904, cp_type#4880 AS cp_type_3#4905, cp_size#4881 AS cp_size_3#4906, cp_container#4882 AS cp_container_3#4907, cp_retailprice#4883 AS cp_retailprice_3#4908, cp_comment#4884 AS cp_comment_3#4909, cp_brand#4885 AS cp_brand_3#4910]
         :        +- Relation[rid#4861,cval_part_p_name#4862,cval_part_p_mfgr#4863,cval_part_p_type#4864,cval_part_p_size#4865,cval_part_p_container#4866,cval_part_p_retailprice#4867,cval_part_p_comment#4868,cval_part_p_brand#4869,cdepval_part_p_name#4870,cdepval_part_p_mfgr#4871,cdepval_part_p_type#4872,cdepval_part_p_size#4873,cdepval_part_p_container#4874,cdepval_part_p_retailprice#4875,cdepval_part_p_comment#4876,cdepval_part_p_brand#4877,cp_name#4878,cp_mfgr#4879,cp_type#4880,cp_size#4881,cp_container#4882,cp_retailprice#4883,cp_comment#4884,cp_brand#4885] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#4825 AS rid_2#4843, cpfk_nation_supplier#4826 AS cpfk_nation_supplier_2#4844, cfpk_supplier_nation#4827 AS cfpk_supplier_nation_2#4845, cval_supplier_s_name#4828 AS cval_supplier_s_name_2#4846, cval_supplier_s_address#4829 AS cval_supplier_s_address_2#4847, cval_supplier_s_phone#4830 AS cval_supplier_s_phone_2#4848, cval_supplier_s_acctbal#4831 AS cval_supplier_s_acctbal_2#4849, cval_supplier_s_comment#4832 AS cval_supplier_s_comment_2#4850, cdepval_supplier_s_name#4833 AS cdepval_supplier_s_name_2#4851, cdepval_supplier_s_address#4834 AS cdepval_supplier_s_address_2#4852, cdepval_supplier_s_phone#4835 AS cdepval_supplier_s_phone_2#4853, cdepval_supplier_s_acctbal#4836 AS cdepval_supplier_s_acctbal_2#4854, cdepval_supplier_s_comment#4837 AS cdepval_supplier_s_comment_2#4855, cs_name#4838 AS cs_name_2#4856, cs_address#4839 AS cs_address_2#4857, cs_phone#4840 AS cs_phone_2#4858, cs_acctbal#4841 AS cs_acctbal_2#4859, cs_comment#4842 AS cs_comment_2#4860]
            :  +- Relation[rid#4825,cpfk_nation_supplier#4826,cfpk_supplier_nation#4827,cval_supplier_s_name#4828,cval_supplier_s_address#4829,cval_supplier_s_phone#4830,cval_supplier_s_acctbal#4831,cval_supplier_s_comment#4832,cdepval_supplier_s_name#4833,cdepval_supplier_s_address#4834,cdepval_supplier_s_phone#4835,cdepval_supplier_s_acctbal#4836,cdepval_supplier_s_comment#4837,cs_name#4838,cs_address#4839,cs_phone#4840,cs_acctbal#4841,cs_comment#4842] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
               :- Project [rid#4807 AS rid_1#4816, cpfk_region_nation#4808 AS cpfk_region_nation_1#4817, cfpk_nation_region#4809 AS cfpk_nation_region_1#4818, cval_nation_n_name#4810 AS cval_nation_n_name_1#4819, cval_nation_n_comment#4811 AS cval_nation_n_comment_1#4820, cdepval_nation_n_name#4812 AS cdepval_nation_n_name_1#4821, cdepval_nation_n_comment#4813 AS cdepval_nation_n_comment_1#4822, cn_name#4814 AS cn_name_1#4823, cn_comment#4815 AS cn_comment_1#4824]
               :  +- Relation[rid#4807,cpfk_region_nation#4808,cfpk_nation_region#4809,cval_nation_n_name#4810,cval_nation_n_comment#4811,cdepval_nation_n_name#4812,cdepval_nation_n_comment#4813,cn_name#4814,cn_comment#4815] JDBCRelation(tnation) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
                  +- Project [rid#4779 AS rid_0#4786, cval_region_r_name#4780 AS cval_region_r_name_0#4787, cval_region_r_comment#4781 AS cval_region_r_comment_0#4788, cdepval_region_r_name#4782 AS cdepval_region_r_name_0#4789, cdepval_region_r_comment#4783 AS cdepval_region_r_comment_0#4790, cr_name#4784 AS cr_name_0#4791, cr_comment#4785 AS cr_comment_0#4792]
                     +- Relation[rid#4779,cval_region_r_name#4780,cval_region_r_comment#4781,cdepval_region_r_name#4782,cdepval_region_r_comment#4783,cr_name#4784,cr_comment#4785] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 3755ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 22:43:04 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:43:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5071L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:43:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:43:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:43:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:43:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:43:04 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:43:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:43:04 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:43:04 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:43:04 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:43:04 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:43:04 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:43:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5071L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#5205 AS rid_4#5250, cpfk_orders_lineitem#5206 AS cpfk_orders_lineitem_4#5251, cpfk_supplier_lineitem#5207 AS cpfk_supplier_lineitem_4#5252, cfpk_lineitem_supplier#5208 AS cfpk_lineitem_supplier_4#5253, cfpk_lineitem_partsupp#5209 AS cfpk_lineitem_partsupp_4#5254, cpfk_part_lineitem#5210 AS cpfk_part_lineitem_4#5255, cfpk_lineitem_part#5211 AS cfpk_lineitem_part_4#5256, cpfk_partsupp_lineitem#5212 AS cpfk_partsupp_lineitem_4#5257, cfpk_lineitem_orders#5213 AS cfpk_lineitem_orders_4#5258, cval_lineitem_l_quantity#5214 AS cval_lineitem_l_quantity_4#5259, cval_lineitem_l_extendedprice#5215 AS cval_lineitem_l_extendedprice_4#5260, cval_lineitem_l_discount#5216 AS cval_lineitem_l_discount_4#5261, cval_lineitem_l_tax#5217 AS cval_lineitem_l_tax_4#5262, cval_lineitem_l_returnflag#5218 AS cval_lineitem_l_returnflag_4#5263, cval_lineitem_l_linestatus#5219 AS cval_lineitem_l_linestatus_4#5264, cval_lineitem_l_commitdate#5220 AS cval_lineitem_l_commitdate_4#5265, cval_lineitem_l_receiptdate#5221 AS cval_lineitem_l_receiptdate_4#5266, cval_lineitem_l_shipinstruct#5222 AS cval_lineitem_l_shipinstruct_4#5267, cval_lineitem_l_shipmode#5223 AS cval_lineitem_l_shipmode_4#5268, cval_lineitem_l_comment#5224 AS cval_lineitem_l_comment_4#5269, cval_lineitem_l_shipdate#5225 AS cval_lineitem_l_shipdate_4#5270, cdepval_lineitem_l_quantity#5226 AS cdepval_lineitem_l_quantity_4#5271, cdepval_lineitem_l_extendedprice#5227 AS cdepval_lineitem_l_extendedprice_4#5272, cdepval_lineitem_l_discount#5228 AS cdepval_lineitem_l_discount_4#5273, ... 21 more fields]
         :  :  +- Relation[rid#5205,cpfk_orders_lineitem#5206,cpfk_supplier_lineitem#5207,cfpk_lineitem_supplier#5208,cfpk_lineitem_partsupp#5209,cpfk_part_lineitem#5210,cfpk_lineitem_part#5211,cpfk_partsupp_lineitem#5212,cfpk_lineitem_orders#5213,cval_lineitem_l_quantity#5214,cval_lineitem_l_extendedprice#5215,cval_lineitem_l_discount#5216,cval_lineitem_l_tax#5217,cval_lineitem_l_returnflag#5218,cval_lineitem_l_linestatus#5219,cval_lineitem_l_commitdate#5220,cval_lineitem_l_receiptdate#5221,cval_lineitem_l_shipinstruct#5222,cval_lineitem_l_shipmode#5223,cval_lineitem_l_comment#5224,cval_lineitem_l_shipdate#5225,cdepval_lineitem_l_quantity#5226,cdepval_lineitem_l_extendedprice#5227,cdepval_lineitem_l_discount#5228,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#5127 AS rid_2#5141, cpfk_part_partsupp#5128 AS cpfk_part_partsupp_2#5142, cfpk_partsupp_part#5129 AS cfpk_partsupp_part_2#5143, cpfk_supplier_partsupp#5130 AS cpfk_supplier_partsupp_2#5144, cfpk_partsupp_supplier#5131 AS cfpk_partsupp_supplier_2#5145, cval_partsupp_ps_availqty#5132 AS cval_partsupp_ps_availqty_2#5146, cval_partsupp_ps_supplycost#5133 AS cval_partsupp_ps_supplycost_2#5147, cval_partsupp_ps_comment#5134 AS cval_partsupp_ps_comment_2#5148, cdepval_partsupp_ps_availqty#5135 AS cdepval_partsupp_ps_availqty_2#5149, cdepval_partsupp_ps_supplycost#5136 AS cdepval_partsupp_ps_supplycost_2#5150, cdepval_partsupp_ps_comment#5137 AS cdepval_partsupp_ps_comment_2#5151, cps_availqty#5138 AS cps_availqty_2#5152, cps_supplycost#5139 AS cps_supplycost_2#5153, cps_comment#5140 AS cps_comment_2#5154]
         :     :  :  +- Relation[rid#5127,cpfk_part_partsupp#5128,cfpk_partsupp_part#5129,cpfk_supplier_partsupp#5130,cfpk_partsupp_supplier#5131,cval_partsupp_ps_availqty#5132,cval_partsupp_ps_supplycost#5133,cval_partsupp_ps_comment#5134,cdepval_partsupp_ps_availqty#5135,cdepval_partsupp_ps_supplycost#5136,cdepval_partsupp_ps_comment#5137,cps_availqty#5138,cps_supplycost#5139,cps_comment#5140] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#5091 AS rid_1#5109, cpfk_nation_supplier#5092 AS cpfk_nation_supplier_1#5110, cfpk_supplier_nation#5093 AS cfpk_supplier_nation_1#5111, cval_supplier_s_name#5094 AS cval_supplier_s_name_1#5112, cval_supplier_s_address#5095 AS cval_supplier_s_address_1#5113, cval_supplier_s_phone#5096 AS cval_supplier_s_phone_1#5114, cval_supplier_s_acctbal#5097 AS cval_supplier_s_acctbal_1#5115, cval_supplier_s_comment#5098 AS cval_supplier_s_comment_1#5116, cdepval_supplier_s_name#5099 AS cdepval_supplier_s_name_1#5117, cdepval_supplier_s_address#5100 AS cdepval_supplier_s_address_1#5118, cdepval_supplier_s_phone#5101 AS cdepval_supplier_s_phone_1#5119, cdepval_supplier_s_acctbal#5102 AS cdepval_supplier_s_acctbal_1#5120, cdepval_supplier_s_comment#5103 AS cdepval_supplier_s_comment_1#5121, cs_name#5104 AS cs_name_1#5122, cs_address#5105 AS cs_address_1#5123, cs_phone#5106 AS cs_phone_1#5124, cs_acctbal#5107 AS cs_acctbal_1#5125, cs_comment#5108 AS cs_comment_1#5126]
         :     :     :  +- Relation[rid#5091,cpfk_nation_supplier#5092,cfpk_supplier_nation#5093,cval_supplier_s_name#5094,cval_supplier_s_address#5095,cval_supplier_s_phone#5096,cval_supplier_s_acctbal#5097,cval_supplier_s_comment#5098,cdepval_supplier_s_name#5099,cdepval_supplier_s_address#5100,cdepval_supplier_s_phone#5101,cdepval_supplier_s_acctbal#5102,cdepval_supplier_s_comment#5103,cs_name#5104,cs_address#5105,cs_phone#5106,cs_acctbal#5107,cs_comment#5108] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#5073 AS rid_0#5082, cpfk_region_nation#5074 AS cpfk_region_nation_0#5083, cfpk_nation_region#5075 AS cfpk_nation_region_0#5084, cval_nation_n_name#5076 AS cval_nation_n_name_0#5085, cval_nation_n_comment#5077 AS cval_nation_n_comment_0#5086, cdepval_nation_n_name#5078 AS cdepval_nation_n_name_0#5087, cdepval_nation_n_comment#5079 AS cdepval_nation_n_comment_0#5088, cn_name#5080 AS cn_name_0#5089, cn_comment#5081 AS cn_comment_0#5090]
         :     :        +- Relation[rid#5073,cpfk_region_nation#5074,cfpk_nation_region#5075,cval_nation_n_name#5076,cval_nation_n_comment#5077,cdepval_nation_n_name#5078,cdepval_nation_n_comment#5079,cn_name#5080,cn_comment#5081] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#5155 AS rid_3#5180, cval_part_p_name#5156 AS cval_part_p_name_3#5181, cval_part_p_mfgr#5157 AS cval_part_p_mfgr_3#5182, cval_part_p_type#5158 AS cval_part_p_type_3#5183, cval_part_p_size#5159 AS cval_part_p_size_3#5184, cval_part_p_container#5160 AS cval_part_p_container_3#5185, cval_part_p_retailprice#5161 AS cval_part_p_retailprice_3#5186, cval_part_p_comment#5162 AS cval_part_p_comment_3#5187, cval_part_p_brand#5163 AS cval_part_p_brand_3#5188, cdepval_part_p_name#5164 AS cdepval_part_p_name_3#5189, cdepval_part_p_mfgr#5165 AS cdepval_part_p_mfgr_3#5190, cdepval_part_p_type#5166 AS cdepval_part_p_type_3#5191, cdepval_part_p_size#5167 AS cdepval_part_p_size_3#5192, cdepval_part_p_container#5168 AS cdepval_part_p_container_3#5193, cdepval_part_p_retailprice#5169 AS cdepval_part_p_retailprice_3#5194, cdepval_part_p_comment#5170 AS cdepval_part_p_comment_3#5195, cdepval_part_p_brand#5171 AS cdepval_part_p_brand_3#5196, cp_name#5172 AS cp_name_3#5197, cp_mfgr#5173 AS cp_mfgr_3#5198, cp_type#5174 AS cp_type_3#5199, cp_size#5175 AS cp_size_3#5200, cp_container#5176 AS cp_container_3#5201, cp_retailprice#5177 AS cp_retailprice_3#5202, cp_comment#5178 AS cp_comment_3#5203, cp_brand#5179 AS cp_brand_3#5204]
         :        +- Relation[rid#5155,cval_part_p_name#5156,cval_part_p_mfgr#5157,cval_part_p_type#5158,cval_part_p_size#5159,cval_part_p_container#5160,cval_part_p_retailprice#5161,cval_part_p_comment#5162,cval_part_p_brand#5163,cdepval_part_p_name#5164,cdepval_part_p_mfgr#5165,cdepval_part_p_type#5166,cdepval_part_p_size#5167,cdepval_part_p_container#5168,cdepval_part_p_retailprice#5169,cdepval_part_p_comment#5170,cdepval_part_p_brand#5171,cp_name#5172,cp_mfgr#5173,cp_type#5174,cp_size#5175,cp_container#5176,cp_retailprice#5177,cp_comment#5178,cp_brand#5179] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#5295 AS rid_5#5319, cpfk_customer_orders#5296 AS cpfk_customer_orders_5#5320, cfpk_orders_customer#5297 AS cfpk_orders_customer_5#5321, cval_orders_o_orderstatus#5298 AS cval_orders_o_orderstatus_5#5322, cval_orders_o_totalprice#5299 AS cval_orders_o_totalprice_5#5323, cval_orders_o_orderpriority#5300 AS cval_orders_o_orderpriority_5#5324, cval_orders_o_clerk#5301 AS cval_orders_o_clerk_5#5325, cval_orders_o_shippriority#5302 AS cval_orders_o_shippriority_5#5326, cval_orders_o_comment#5303 AS cval_orders_o_comment_5#5327, cval_orders_o_orderdate#5304 AS cval_orders_o_orderdate_5#5328, cdepval_orders_o_orderstatus#5305 AS cdepval_orders_o_orderstatus_5#5329, cdepval_orders_o_totalprice#5306 AS cdepval_orders_o_totalprice_5#5330, cdepval_orders_o_orderpriority#5307 AS cdepval_orders_o_orderpriority_5#5331, cdepval_orders_o_clerk#5308 AS cdepval_orders_o_clerk_5#5332, cdepval_orders_o_shippriority#5309 AS cdepval_orders_o_shippriority_5#5333, cdepval_orders_o_comment#5310 AS cdepval_orders_o_comment_5#5334, cdepval_orders_o_orderdate#5311 AS cdepval_orders_o_orderdate_5#5335, co_orderstatus#5312 AS co_orderstatus_5#5336, co_totalprice#5313 AS co_totalprice_5#5337, co_orderpriority#5314 AS co_orderpriority_5#5338, co_clerk#5315 AS co_clerk_5#5339, co_shippriority#5316 AS co_shippriority_5#5340, co_comment#5317 AS co_comment_5#5341, co_orderdate#5318 AS co_orderdate_5#5342]
            +- Relation[rid#5295,cpfk_customer_orders#5296,cfpk_orders_customer#5297,cval_orders_o_orderstatus#5298,cval_orders_o_totalprice#5299,cval_orders_o_orderpriority#5300,cval_orders_o_clerk#5301,cval_orders_o_shippriority#5302,cval_orders_o_comment#5303,cval_orders_o_orderdate#5304,cdepval_orders_o_orderstatus#5305,cdepval_orders_o_totalprice#5306,cdepval_orders_o_orderpriority#5307,cdepval_orders_o_clerk#5308,cdepval_orders_o_shippriority#5309,cdepval_orders_o_comment#5310,cdepval_orders_o_orderdate#5311,co_orderstatus#5312,co_totalprice#5313,co_orderpriority#5314,co_clerk#5315,co_shippriority#5316,co_comment#5317,co_orderdate#5318] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 37962ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/25 22:43:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:43:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5490L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 22:43:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:43:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:43:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5490L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#5492 AS rid_0#5537, cpfk_orders_lineitem#5493 AS cpfk_orders_lineitem_0#5538, cpfk_supplier_lineitem#5494 AS cpfk_supplier_lineitem_0#5539, cfpk_lineitem_supplier#5495 AS cfpk_lineitem_supplier_0#5540, cfpk_lineitem_partsupp#5496 AS cfpk_lineitem_partsupp_0#5541, cpfk_part_lineitem#5497 AS cpfk_part_lineitem_0#5542, cfpk_lineitem_part#5498 AS cfpk_lineitem_part_0#5543, cpfk_partsupp_lineitem#5499 AS cpfk_partsupp_lineitem_0#5544, cfpk_lineitem_orders#5500 AS cfpk_lineitem_orders_0#5545, cval_lineitem_l_quantity#5501 AS cval_lineitem_l_quantity_0#5546, cval_lineitem_l_extendedprice#5502 AS cval_lineitem_l_extendedprice_0#5547, cval_lineitem_l_discount#5503 AS cval_lineitem_l_discount_0#5548, cval_lineitem_l_tax#5504 AS cval_lineitem_l_tax_0#5549, cval_lineitem_l_returnflag#5505 AS cval_lineitem_l_returnflag_0#5550, cval_lineitem_l_linestatus#5506 AS cval_lineitem_l_linestatus_0#5551, cval_lineitem_l_commitdate#5507 AS cval_lineitem_l_commitdate_0#5552, cval_lineitem_l_receiptdate#5508 AS cval_lineitem_l_receiptdate_0#5553, cval_lineitem_l_shipinstruct#5509 AS cval_lineitem_l_shipinstruct_0#5554, cval_lineitem_l_shipmode#5510 AS cval_lineitem_l_shipmode_0#5555, cval_lineitem_l_comment#5511 AS cval_lineitem_l_comment_0#5556, cval_lineitem_l_shipdate#5512 AS cval_lineitem_l_shipdate_0#5557, cdepval_lineitem_l_quantity#5513 AS cdepval_lineitem_l_quantity_0#5558, cdepval_lineitem_l_extendedprice#5514 AS cdepval_lineitem_l_extendedprice_0#5559, cdepval_lineitem_l_discount#5515 AS cdepval_lineitem_l_discount_0#5560, ... 21 more fields]
         :  :  :     +- Relation[rid#5492,cpfk_orders_lineitem#5493,cpfk_supplier_lineitem#5494,cfpk_lineitem_supplier#5495,cfpk_lineitem_partsupp#5496,cpfk_part_lineitem#5497,cfpk_lineitem_part#5498,cpfk_partsupp_lineitem#5499,cfpk_lineitem_orders#5500,cval_lineitem_l_quantity#5501,cval_lineitem_l_extendedprice#5502,cval_lineitem_l_discount#5503,cval_lineitem_l_tax#5504,cval_lineitem_l_returnflag#5505,cval_lineitem_l_linestatus#5506,cval_lineitem_l_commitdate#5507,cval_lineitem_l_receiptdate#5508,cval_lineitem_l_shipinstruct#5509,cval_lineitem_l_shipmode#5510,cval_lineitem_l_comment#5511,cval_lineitem_l_shipdate#5512,cdepval_lineitem_l_quantity#5513,cdepval_lineitem_l_extendedprice#5514,cdepval_lineitem_l_discount#5515,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#5672 AS rid_1#5696, cpfk_customer_orders#5673 AS cpfk_customer_orders_1#5697, cfpk_orders_customer#5674 AS cfpk_orders_customer_1#5698, cval_orders_o_orderstatus#5675 AS cval_orders_o_orderstatus_1#5699, cval_orders_o_totalprice#5676 AS cval_orders_o_totalprice_1#5700, cval_orders_o_orderpriority#5677 AS cval_orders_o_orderpriority_1#5701, cval_orders_o_clerk#5678 AS cval_orders_o_clerk_1#5702, cval_orders_o_shippriority#5679 AS cval_orders_o_shippriority_1#5703, cval_orders_o_comment#5680 AS cval_orders_o_comment_1#5704, cval_orders_o_orderdate#5681 AS cval_orders_o_orderdate_1#5705, cdepval_orders_o_orderstatus#5682 AS cdepval_orders_o_orderstatus_1#5706, cdepval_orders_o_totalprice#5683 AS cdepval_orders_o_totalprice_1#5707, cdepval_orders_o_orderpriority#5684 AS cdepval_orders_o_orderpriority_1#5708, cdepval_orders_o_clerk#5685 AS cdepval_orders_o_clerk_1#5709, cdepval_orders_o_shippriority#5686 AS cdepval_orders_o_shippriority_1#5710, cdepval_orders_o_comment#5687 AS cdepval_orders_o_comment_1#5711, cdepval_orders_o_orderdate#5688 AS cdepval_orders_o_orderdate_1#5712, co_orderstatus#5689 AS co_orderstatus_1#5713, co_totalprice#5690 AS co_totalprice_1#5714, co_orderpriority#5691 AS co_orderpriority_1#5715, co_clerk#5692 AS co_clerk_1#5716, co_shippriority#5693 AS co_shippriority_1#5717, co_comment#5694 AS co_comment_1#5718, co_orderdate#5695 AS co_orderdate_1#5719]
         :  :     +- Relation[rid#5672,cpfk_customer_orders#5673,cfpk_orders_customer#5674,cval_orders_o_orderstatus#5675,cval_orders_o_totalprice#5676,cval_orders_o_orderpriority#5677,cval_orders_o_clerk#5678,cval_orders_o_shippriority#5679,cval_orders_o_comment#5680,cval_orders_o_orderdate#5681,cdepval_orders_o_orderstatus#5682,cdepval_orders_o_totalprice#5683,cdepval_orders_o_orderpriority#5684,cdepval_orders_o_clerk#5685,cdepval_orders_o_shippriority#5686,cdepval_orders_o_comment#5687,cdepval_orders_o_orderdate#5688,co_orderstatus#5689,co_totalprice#5690,co_orderpriority#5691,co_clerk#5692,co_shippriority#5693,co_comment#5694,co_orderdate#5695] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#5720 AS rid_2#5741, cpfk_nation_customer#5721 AS cpfk_nation_customer_2#5742, cfpk_customer_nation#5722 AS cfpk_customer_nation_2#5743, cval_customer_c_name#5723 AS cval_customer_c_name_2#5744, cval_customer_c_address#5724 AS cval_customer_c_address_2#5745, cval_customer_c_phone#5725 AS cval_customer_c_phone_2#5746, cval_customer_c_acctbal#5726 AS cval_customer_c_acctbal_2#5747, cval_customer_c_comment#5727 AS cval_customer_c_comment_2#5748, cval_customer_c_mktsegment#5728 AS cval_customer_c_mktsegment_2#5749, cdepval_customer_c_name#5729 AS cdepval_customer_c_name_2#5750, cdepval_customer_c_address#5730 AS cdepval_customer_c_address_2#5751, cdepval_customer_c_phone#5731 AS cdepval_customer_c_phone_2#5752, cdepval_customer_c_acctbal#5732 AS cdepval_customer_c_acctbal_2#5753, cdepval_customer_c_comment#5733 AS cdepval_customer_c_comment_2#5754, cdepval_customer_c_mktsegment#5734 AS cdepval_customer_c_mktsegment_2#5755, cc_name#5735 AS cc_name_2#5756, cc_address#5736 AS cc_address_2#5757, cc_phone#5737 AS cc_phone_2#5758, cc_acctbal#5738 AS cc_acctbal_2#5759, cc_comment#5739 AS cc_comment_2#5760, cc_mktsegment#5740 AS cc_mktsegment_2#5761]
         :     +- Relation[rid#5720,cpfk_nation_customer#5721,cfpk_customer_nation#5722,cval_customer_c_name#5723,cval_customer_c_address#5724,cval_customer_c_phone#5725,cval_customer_c_acctbal#5726,cval_customer_c_comment#5727,cval_customer_c_mktsegment#5728,cdepval_customer_c_name#5729,cdepval_customer_c_address#5730,cdepval_customer_c_phone#5731,cdepval_customer_c_acctbal#5732,cdepval_customer_c_comment#5733,cdepval_customer_c_mktsegment#5734,cc_name#5735,cc_address#5736,cc_phone#5737,cc_acctbal#5738,cc_comment#5739,cc_mktsegment#5740] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#5762 AS rid_3#5771, cpfk_region_nation#5763 AS cpfk_region_nation_3#5772, cfpk_nation_region#5764 AS cfpk_nation_region_3#5773, cval_nation_n_name#5765 AS cval_nation_n_name_3#5774, cval_nation_n_comment#5766 AS cval_nation_n_comment_3#5775, cdepval_nation_n_name#5767 AS cdepval_nation_n_name_3#5776, cdepval_nation_n_comment#5768 AS cdepval_nation_n_comment_3#5777, cn_name#5769 AS cn_name_3#5778, cn_comment#5770 AS cn_comment_3#5779]
            +- Relation[rid#5762,cpfk_region_nation#5763,cfpk_nation_region#5764,cval_nation_n_name#5765,cval_nation_n_comment#5766,cdepval_nation_n_name#5767,cdepval_nation_n_comment#5768,cn_name#5769,cn_comment#5770] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 60641ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/25 22:44:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:44:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5883L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 22:44:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5883L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#5885 AS rid_0#5909, cpfk_customer_orders#5886 AS cpfk_customer_orders_0#5910, cfpk_orders_customer#5887 AS cfpk_orders_customer_0#5911, cval_orders_o_orderstatus#5888 AS cval_orders_o_orderstatus_0#5912, cval_orders_o_totalprice#5889 AS cval_orders_o_totalprice_0#5913, cval_orders_o_orderpriority#5890 AS cval_orders_o_orderpriority_0#5914, cval_orders_o_clerk#5891 AS cval_orders_o_clerk_0#5915, cval_orders_o_shippriority#5892 AS cval_orders_o_shippriority_0#5916, cval_orders_o_comment#5893 AS cval_orders_o_comment_0#5917, cval_orders_o_orderdate#5894 AS cval_orders_o_orderdate_0#5918, cdepval_orders_o_orderstatus#5895 AS cdepval_orders_o_orderstatus_0#5919, cdepval_orders_o_totalprice#5896 AS cdepval_orders_o_totalprice_0#5920, cdepval_orders_o_orderpriority#5897 AS cdepval_orders_o_orderpriority_0#5921, cdepval_orders_o_clerk#5898 AS cdepval_orders_o_clerk_0#5922, cdepval_orders_o_shippriority#5899 AS cdepval_orders_o_shippriority_0#5923, cdepval_orders_o_comment#5900 AS cdepval_orders_o_comment_0#5924, cdepval_orders_o_orderdate#5901 AS cdepval_orders_o_orderdate_0#5925, co_orderstatus#5902 AS co_orderstatus_0#5926, co_totalprice#5903 AS co_totalprice_0#5927, co_orderpriority#5904 AS co_orderpriority_0#5928, co_clerk#5905 AS co_clerk_0#5929, co_shippriority#5906 AS co_shippriority_0#5930, co_comment#5907 AS co_comment_0#5931, co_orderdate#5908 AS co_orderdate_0#5932]
         :  +- Relation[rid#5885,cpfk_customer_orders#5886,cfpk_orders_customer#5887,cval_orders_o_orderstatus#5888,cval_orders_o_totalprice#5889,cval_orders_o_orderpriority#5890,cval_orders_o_clerk#5891,cval_orders_o_shippriority#5892,cval_orders_o_comment#5893,cval_orders_o_orderdate#5894,cdepval_orders_o_orderstatus#5895,cdepval_orders_o_totalprice#5896,cdepval_orders_o_orderpriority#5897,cdepval_orders_o_clerk#5898,cdepval_orders_o_shippriority#5899,cdepval_orders_o_comment#5900,cdepval_orders_o_orderdate#5901,co_orderstatus#5902,co_totalprice#5903,co_orderpriority#5904,co_clerk#5905,co_shippriority#5906,co_comment#5907,co_orderdate#5908] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#5933 AS rid_1#5954, cpfk_nation_customer#5934 AS cpfk_nation_customer_1#5955, cfpk_customer_nation#5935 AS cfpk_customer_nation_1#5956, cval_customer_c_name#5936 AS cval_customer_c_name_1#5957, cval_customer_c_address#5937 AS cval_customer_c_address_1#5958, cval_customer_c_phone#5938 AS cval_customer_c_phone_1#5959, cval_customer_c_acctbal#5939 AS cval_customer_c_acctbal_1#5960, cval_customer_c_comment#5940 AS cval_customer_c_comment_1#5961, cval_customer_c_mktsegment#5941 AS cval_customer_c_mktsegment_1#5962, cdepval_customer_c_name#5942 AS cdepval_customer_c_name_1#5963, cdepval_customer_c_address#5943 AS cdepval_customer_c_address_1#5964, cdepval_customer_c_phone#5944 AS cdepval_customer_c_phone_1#5965, cdepval_customer_c_acctbal#5945 AS cdepval_customer_c_acctbal_1#5966, cdepval_customer_c_comment#5946 AS cdepval_customer_c_comment_1#5967, cdepval_customer_c_mktsegment#5947 AS cdepval_customer_c_mktsegment_1#5968, cc_name#5948 AS cc_name_1#5969, cc_address#5949 AS cc_address_1#5970, cc_phone#5950 AS cc_phone_1#5971, cc_acctbal#5951 AS cc_acctbal_1#5972, cc_comment#5952 AS cc_comment_1#5973, cc_mktsegment#5953 AS cc_mktsegment_1#5974]
            +- Relation[rid#5933,cpfk_nation_customer#5934,cfpk_customer_nation#5935,cval_customer_c_name#5936,cval_customer_c_address#5937,cval_customer_c_phone#5938,cval_customer_c_acctbal#5939,cval_customer_c_comment#5940,cval_customer_c_mktsegment#5941,cdepval_customer_c_name#5942,cdepval_customer_c_address#5943,cdepval_customer_c_phone#5944,cdepval_customer_c_acctbal#5945,cdepval_customer_c_comment#5946,cdepval_customer_c_mktsegment#5947,cc_name#5948,cc_address#5949,cc_phone#5950,cc_acctbal#5951,cc_comment#5952,cc_mktsegment#5953] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4526ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/25 22:44:47 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:44:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6025L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:44:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#6025L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#6027 AS rid_0#6072, cpfk_orders_lineitem#6028 AS cpfk_orders_lineitem_0#6073, cpfk_supplier_lineitem#6029 AS cpfk_supplier_lineitem_0#6074, cfpk_lineitem_supplier#6030 AS cfpk_lineitem_supplier_0#6075, cfpk_lineitem_partsupp#6031 AS cfpk_lineitem_partsupp_0#6076, cpfk_part_lineitem#6032 AS cpfk_part_lineitem_0#6077, cfpk_lineitem_part#6033 AS cfpk_lineitem_part_0#6078, cpfk_partsupp_lineitem#6034 AS cpfk_partsupp_lineitem_0#6079, cfpk_lineitem_orders#6035 AS cfpk_lineitem_orders_0#6080, cval_lineitem_l_quantity#6036 AS cval_lineitem_l_quantity_0#6081, cval_lineitem_l_extendedprice#6037 AS cval_lineitem_l_extendedprice_0#6082, cval_lineitem_l_discount#6038 AS cval_lineitem_l_discount_0#6083, cval_lineitem_l_tax#6039 AS cval_lineitem_l_tax_0#6084, cval_lineitem_l_returnflag#6040 AS cval_lineitem_l_returnflag_0#6085, cval_lineitem_l_linestatus#6041 AS cval_lineitem_l_linestatus_0#6086, cval_lineitem_l_commitdate#6042 AS cval_lineitem_l_commitdate_0#6087, cval_lineitem_l_receiptdate#6043 AS cval_lineitem_l_receiptdate_0#6088, cval_lineitem_l_shipinstruct#6044 AS cval_lineitem_l_shipinstruct_0#6089, cval_lineitem_l_shipmode#6045 AS cval_lineitem_l_shipmode_0#6090, cval_lineitem_l_comment#6046 AS cval_lineitem_l_comment_0#6091, cval_lineitem_l_shipdate#6047 AS cval_lineitem_l_shipdate_0#6092, cdepval_lineitem_l_quantity#6048 AS cdepval_lineitem_l_quantity_0#6093, cdepval_lineitem_l_extendedprice#6049 AS cdepval_lineitem_l_extendedprice_0#6094, cdepval_lineitem_l_discount#6050 AS cdepval_lineitem_l_discount_0#6095, ... 21 more fields]
         +- Relation[rid#6027,cpfk_orders_lineitem#6028,cpfk_supplier_lineitem#6029,cfpk_lineitem_supplier#6030,cfpk_lineitem_partsupp#6031,cpfk_part_lineitem#6032,cfpk_lineitem_part#6033,cpfk_partsupp_lineitem#6034,cfpk_lineitem_orders#6035,cval_lineitem_l_quantity#6036,cval_lineitem_l_extendedprice#6037,cval_lineitem_l_discount#6038,cval_lineitem_l_tax#6039,cval_lineitem_l_returnflag#6040,cval_lineitem_l_linestatus#6041,cval_lineitem_l_commitdate#6042,cval_lineitem_l_receiptdate#6043,cval_lineitem_l_shipinstruct#6044,cval_lineitem_l_shipmode#6045,cval_lineitem_l_comment#6046,cval_lineitem_l_shipdate#6047,cdepval_lineitem_l_quantity#6048,cdepval_lineitem_l_extendedprice#6049,cdepval_lineitem_l_discount#6050,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2431ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/25 22:44:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:44:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6168L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 22:44:49 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:44:49 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:44:49 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:44:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:44:49 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:44:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:44:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:44:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:44:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:44:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:44:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:44:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6168L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#6306 AS rid_4#6351, cpfk_orders_lineitem#6307 AS cpfk_orders_lineitem_4#6352, cpfk_supplier_lineitem#6308 AS cpfk_supplier_lineitem_4#6353, cfpk_lineitem_supplier#6309 AS cfpk_lineitem_supplier_4#6354, cfpk_lineitem_partsupp#6310 AS cfpk_lineitem_partsupp_4#6355, cpfk_part_lineitem#6311 AS cpfk_part_lineitem_4#6356, cfpk_lineitem_part#6312 AS cfpk_lineitem_part_4#6357, cpfk_partsupp_lineitem#6313 AS cpfk_partsupp_lineitem_4#6358, cfpk_lineitem_orders#6314 AS cfpk_lineitem_orders_4#6359, cval_lineitem_l_quantity#6315 AS cval_lineitem_l_quantity_4#6360, cval_lineitem_l_extendedprice#6316 AS cval_lineitem_l_extendedprice_4#6361, cval_lineitem_l_discount#6317 AS cval_lineitem_l_discount_4#6362, cval_lineitem_l_tax#6318 AS cval_lineitem_l_tax_4#6363, cval_lineitem_l_returnflag#6319 AS cval_lineitem_l_returnflag_4#6364, cval_lineitem_l_linestatus#6320 AS cval_lineitem_l_linestatus_4#6365, cval_lineitem_l_commitdate#6321 AS cval_lineitem_l_commitdate_4#6366, cval_lineitem_l_receiptdate#6322 AS cval_lineitem_l_receiptdate_4#6367, cval_lineitem_l_shipinstruct#6323 AS cval_lineitem_l_shipinstruct_4#6368, cval_lineitem_l_shipmode#6324 AS cval_lineitem_l_shipmode_4#6369, cval_lineitem_l_comment#6325 AS cval_lineitem_l_comment_4#6370, cval_lineitem_l_shipdate#6326 AS cval_lineitem_l_shipdate_4#6371, cdepval_lineitem_l_quantity#6327 AS cdepval_lineitem_l_quantity_4#6372, cdepval_lineitem_l_extendedprice#6328 AS cdepval_lineitem_l_extendedprice_4#6373, cdepval_lineitem_l_discount#6329 AS cdepval_lineitem_l_discount_4#6374, ... 21 more fields]
            :  :  +- Relation[rid#6306,cpfk_orders_lineitem#6307,cpfk_supplier_lineitem#6308,cfpk_lineitem_supplier#6309,cfpk_lineitem_partsupp#6310,cpfk_part_lineitem#6311,cfpk_lineitem_part#6312,cpfk_partsupp_lineitem#6313,cfpk_lineitem_orders#6314,cval_lineitem_l_quantity#6315,cval_lineitem_l_extendedprice#6316,cval_lineitem_l_discount#6317,cval_lineitem_l_tax#6318,cval_lineitem_l_returnflag#6319,cval_lineitem_l_linestatus#6320,cval_lineitem_l_commitdate#6321,cval_lineitem_l_receiptdate#6322,cval_lineitem_l_shipinstruct#6323,cval_lineitem_l_shipmode#6324,cval_lineitem_l_comment#6325,cval_lineitem_l_shipdate#6326,cdepval_lineitem_l_quantity#6327,cdepval_lineitem_l_extendedprice#6328,cdepval_lineitem_l_discount#6329,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#6258 AS rid_3#6282, cpfk_customer_orders#6259 AS cpfk_customer_orders_3#6283, cfpk_orders_customer#6260 AS cfpk_orders_customer_3#6284, cval_orders_o_orderstatus#6261 AS cval_orders_o_orderstatus_3#6285, cval_orders_o_totalprice#6262 AS cval_orders_o_totalprice_3#6286, cval_orders_o_orderpriority#6263 AS cval_orders_o_orderpriority_3#6287, cval_orders_o_clerk#6264 AS cval_orders_o_clerk_3#6288, cval_orders_o_shippriority#6265 AS cval_orders_o_shippriority_3#6289, cval_orders_o_comment#6266 AS cval_orders_o_comment_3#6290, cval_orders_o_orderdate#6267 AS cval_orders_o_orderdate_3#6291, cdepval_orders_o_orderstatus#6268 AS cdepval_orders_o_orderstatus_3#6292, cdepval_orders_o_totalprice#6269 AS cdepval_orders_o_totalprice_3#6293, cdepval_orders_o_orderpriority#6270 AS cdepval_orders_o_orderpriority_3#6294, cdepval_orders_o_clerk#6271 AS cdepval_orders_o_clerk_3#6295, cdepval_orders_o_shippriority#6272 AS cdepval_orders_o_shippriority_3#6296, cdepval_orders_o_comment#6273 AS cdepval_orders_o_comment_3#6297, cdepval_orders_o_orderdate#6274 AS cdepval_orders_o_orderdate_3#6298, co_orderstatus#6275 AS co_orderstatus_3#6299, co_totalprice#6276 AS co_totalprice_3#6300, co_orderpriority#6277 AS co_orderpriority_3#6301, co_clerk#6278 AS co_clerk_3#6302, co_shippriority#6279 AS co_shippriority_3#6303, co_comment#6280 AS co_comment_3#6304, co_orderdate#6281 AS co_orderdate_3#6305]
            :     :  +- Relation[rid#6258,cpfk_customer_orders#6259,cfpk_orders_customer#6260,cval_orders_o_orderstatus#6261,cval_orders_o_totalprice#6262,cval_orders_o_orderpriority#6263,cval_orders_o_clerk#6264,cval_orders_o_shippriority#6265,cval_orders_o_comment#6266,cval_orders_o_orderdate#6267,cdepval_orders_o_orderstatus#6268,cdepval_orders_o_totalprice#6269,cdepval_orders_o_orderpriority#6270,cdepval_orders_o_clerk#6271,cdepval_orders_o_shippriority#6272,cdepval_orders_o_comment#6273,cdepval_orders_o_orderdate#6274,co_orderstatus#6275,co_totalprice#6276,co_orderpriority#6277,co_clerk#6278,co_shippriority#6279,co_comment#6280,co_orderdate#6281] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#6216 AS rid_2#6237, cpfk_nation_customer#6217 AS cpfk_nation_customer_2#6238, cfpk_customer_nation#6218 AS cfpk_customer_nation_2#6239, cval_customer_c_name#6219 AS cval_customer_c_name_2#6240, cval_customer_c_address#6220 AS cval_customer_c_address_2#6241, cval_customer_c_phone#6221 AS cval_customer_c_phone_2#6242, cval_customer_c_acctbal#6222 AS cval_customer_c_acctbal_2#6243, cval_customer_c_comment#6223 AS cval_customer_c_comment_2#6244, cval_customer_c_mktsegment#6224 AS cval_customer_c_mktsegment_2#6245, cdepval_customer_c_name#6225 AS cdepval_customer_c_name_2#6246, cdepval_customer_c_address#6226 AS cdepval_customer_c_address_2#6247, cdepval_customer_c_phone#6227 AS cdepval_customer_c_phone_2#6248, cdepval_customer_c_acctbal#6228 AS cdepval_customer_c_acctbal_2#6249, cdepval_customer_c_comment#6229 AS cdepval_customer_c_comment_2#6250, cdepval_customer_c_mktsegment#6230 AS cdepval_customer_c_mktsegment_2#6251, cc_name#6231 AS cc_name_2#6252, cc_address#6232 AS cc_address_2#6253, cc_phone#6233 AS cc_phone_2#6254, cc_acctbal#6234 AS cc_acctbal_2#6255, cc_comment#6235 AS cc_comment_2#6256, cc_mktsegment#6236 AS cc_mktsegment_2#6257]
            :        :  +- Relation[rid#6216,cpfk_nation_customer#6217,cfpk_customer_nation#6218,cval_customer_c_name#6219,cval_customer_c_address#6220,cval_customer_c_phone#6221,cval_customer_c_acctbal#6222,cval_customer_c_comment#6223,cval_customer_c_mktsegment#6224,cdepval_customer_c_name#6225,cdepval_customer_c_address#6226,cdepval_customer_c_phone#6227,cdepval_customer_c_acctbal#6228,cdepval_customer_c_comment#6229,cdepval_customer_c_mktsegment#6230,cc_name#6231,cc_address#6232,cc_phone#6233,cc_acctbal#6234,cc_comment#6235,cc_mktsegment#6236] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
            :           :- Project [rid#6198 AS rid_1#6207, cpfk_region_nation#6199 AS cpfk_region_nation_1#6208, cfpk_nation_region#6200 AS cfpk_nation_region_1#6209, cval_nation_n_name#6201 AS cval_nation_n_name_1#6210, cval_nation_n_comment#6202 AS cval_nation_n_comment_1#6211, cdepval_nation_n_name#6203 AS cdepval_nation_n_name_1#6212, cdepval_nation_n_comment#6204 AS cdepval_nation_n_comment_1#6213, cn_name#6205 AS cn_name_1#6214, cn_comment#6206 AS cn_comment_1#6215]
            :           :  +- Relation[rid#6198,cpfk_region_nation#6199,cfpk_nation_region#6200,cval_nation_n_name#6201,cval_nation_n_comment#6202,cdepval_nation_n_name#6203,cdepval_nation_n_comment#6204,cn_name#6205,cn_comment#6206] JDBCRelation(tnation) [numPartitions=1]
            :           +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :              +- Project [rid#6170 AS rid_0#6177, cval_region_r_name#6171 AS cval_region_r_name_0#6178, cval_region_r_comment#6172 AS cval_region_r_comment_0#6179, cdepval_region_r_name#6173 AS cdepval_region_r_name_0#6180, cdepval_region_r_comment#6174 AS cdepval_region_r_comment_0#6181, cr_name#6175 AS cr_name_0#6182, cr_comment#6176 AS cr_comment_0#6183]
            :                 +- Relation[rid#6170,cval_region_r_name#6171,cval_region_r_comment#6172,cdepval_region_r_name#6173,cdepval_region_r_comment#6174,cr_name#6175,cr_comment#6176] JDBCRelation(tregion) [numPartitions=1]
            +- Project [rid#6396 AS rid_5#6414, cpfk_nation_supplier#6397 AS cpfk_nation_supplier_5#6415, cfpk_supplier_nation#6398 AS cfpk_supplier_nation_5#6416, cval_supplier_s_name#6399 AS cval_supplier_s_name_5#6417, cval_supplier_s_address#6400 AS cval_supplier_s_address_5#6418, cval_supplier_s_phone#6401 AS cval_supplier_s_phone_5#6419, cval_supplier_s_acctbal#6402 AS cval_supplier_s_acctbal_5#6420, cval_supplier_s_comment#6403 AS cval_supplier_s_comment_5#6421, cdepval_supplier_s_name#6404 AS cdepval_supplier_s_name_5#6422, cdepval_supplier_s_address#6405 AS cdepval_supplier_s_address_5#6423, cdepval_supplier_s_phone#6406 AS cdepval_supplier_s_phone_5#6424, cdepval_supplier_s_acctbal#6407 AS cdepval_supplier_s_acctbal_5#6425, cdepval_supplier_s_comment#6408 AS cdepval_supplier_s_comment_5#6426, cs_name#6409 AS cs_name_5#6427, cs_address#6410 AS cs_address_5#6428, cs_phone#6411 AS cs_phone_5#6429, cs_acctbal#6412 AS cs_acctbal_5#6430, cs_comment#6413 AS cs_comment_5#6431]
               +- Relation[rid#6396,cpfk_nation_supplier#6397,cfpk_supplier_nation#6398,cval_supplier_s_name#6399,cval_supplier_s_address#6400,cval_supplier_s_phone#6401,cval_supplier_s_acctbal#6402,cval_supplier_s_comment#6403,cdepval_supplier_s_name#6404,cdepval_supplier_s_address#6405,cdepval_supplier_s_phone#6406,cdepval_supplier_s_acctbal#6407,cdepval_supplier_s_comment#6408,cs_name#6409,cs_address#6410,cs_phone#6411,cs_acctbal#6412,cs_comment#6413] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 30610ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/25 22:45:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:45:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6564L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:45:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:45:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:45:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:45:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:45:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:45:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:45:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:45:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:45:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:45:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:45:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:45:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6564L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#6638 AS rid_2#6683, cpfk_orders_lineitem#6639 AS cpfk_orders_lineitem_2#6684, cpfk_supplier_lineitem#6640 AS cpfk_supplier_lineitem_2#6685, cfpk_lineitem_supplier#6641 AS cfpk_lineitem_supplier_2#6686, cfpk_lineitem_partsupp#6642 AS cfpk_lineitem_partsupp_2#6687, cpfk_part_lineitem#6643 AS cpfk_part_lineitem_2#6688, cfpk_lineitem_part#6644 AS cfpk_lineitem_part_2#6689, cpfk_partsupp_lineitem#6645 AS cpfk_partsupp_lineitem_2#6690, cfpk_lineitem_orders#6646 AS cfpk_lineitem_orders_2#6691, cval_lineitem_l_quantity#6647 AS cval_lineitem_l_quantity_2#6692, cval_lineitem_l_extendedprice#6648 AS cval_lineitem_l_extendedprice_2#6693, cval_lineitem_l_discount#6649 AS cval_lineitem_l_discount_2#6694, cval_lineitem_l_tax#6650 AS cval_lineitem_l_tax_2#6695, cval_lineitem_l_returnflag#6651 AS cval_lineitem_l_returnflag_2#6696, cval_lineitem_l_linestatus#6652 AS cval_lineitem_l_linestatus_2#6697, cval_lineitem_l_commitdate#6653 AS cval_lineitem_l_commitdate_2#6698, cval_lineitem_l_receiptdate#6654 AS cval_lineitem_l_receiptdate_2#6699, cval_lineitem_l_shipinstruct#6655 AS cval_lineitem_l_shipinstruct_2#6700, cval_lineitem_l_shipmode#6656 AS cval_lineitem_l_shipmode_2#6701, cval_lineitem_l_comment#6657 AS cval_lineitem_l_comment_2#6702, cval_lineitem_l_shipdate#6658 AS cval_lineitem_l_shipdate_2#6703, cdepval_lineitem_l_quantity#6659 AS cdepval_lineitem_l_quantity_2#6704, cdepval_lineitem_l_extendedprice#6660 AS cdepval_lineitem_l_extendedprice_2#6705, cdepval_lineitem_l_discount#6661 AS cdepval_lineitem_l_discount_2#6706, ... 21 more fields]
         :  :  +- Relation[rid#6638,cpfk_orders_lineitem#6639,cpfk_supplier_lineitem#6640,cfpk_lineitem_supplier#6641,cfpk_lineitem_partsupp#6642,cpfk_part_lineitem#6643,cfpk_lineitem_part#6644,cpfk_partsupp_lineitem#6645,cfpk_lineitem_orders#6646,cval_lineitem_l_quantity#6647,cval_lineitem_l_extendedprice#6648,cval_lineitem_l_discount#6649,cval_lineitem_l_tax#6650,cval_lineitem_l_returnflag#6651,cval_lineitem_l_linestatus#6652,cval_lineitem_l_commitdate#6653,cval_lineitem_l_receiptdate#6654,cval_lineitem_l_shipinstruct#6655,cval_lineitem_l_shipmode#6656,cval_lineitem_l_comment#6657,cval_lineitem_l_shipdate#6658,cdepval_lineitem_l_quantity#6659,cdepval_lineitem_l_extendedprice#6660,cdepval_lineitem_l_discount#6661,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :- Project [rid#6602 AS rid_1#6620, cpfk_nation_supplier#6603 AS cpfk_nation_supplier_1#6621, cfpk_supplier_nation#6604 AS cfpk_supplier_nation_1#6622, cval_supplier_s_name#6605 AS cval_supplier_s_name_1#6623, cval_supplier_s_address#6606 AS cval_supplier_s_address_1#6624, cval_supplier_s_phone#6607 AS cval_supplier_s_phone_1#6625, cval_supplier_s_acctbal#6608 AS cval_supplier_s_acctbal_1#6626, cval_supplier_s_comment#6609 AS cval_supplier_s_comment_1#6627, cdepval_supplier_s_name#6610 AS cdepval_supplier_s_name_1#6628, cdepval_supplier_s_address#6611 AS cdepval_supplier_s_address_1#6629, cdepval_supplier_s_phone#6612 AS cdepval_supplier_s_phone_1#6630, cdepval_supplier_s_acctbal#6613 AS cdepval_supplier_s_acctbal_1#6631, cdepval_supplier_s_comment#6614 AS cdepval_supplier_s_comment_1#6632, cs_name#6615 AS cs_name_1#6633, cs_address#6616 AS cs_address_1#6634, cs_phone#6617 AS cs_phone_1#6635, cs_acctbal#6618 AS cs_acctbal_1#6636, cs_comment#6619 AS cs_comment_1#6637]
         :     :  +- Relation[rid#6602,cpfk_nation_supplier#6603,cfpk_supplier_nation#6604,cval_supplier_s_name#6605,cval_supplier_s_address#6606,cval_supplier_s_phone#6607,cval_supplier_s_acctbal#6608,cval_supplier_s_comment#6609,cdepval_supplier_s_name#6610,cdepval_supplier_s_address#6611,cdepval_supplier_s_phone#6612,cdepval_supplier_s_acctbal#6613,cdepval_supplier_s_comment#6614,cs_name#6615,cs_address#6616,cs_phone#6617,cs_acctbal#6618,cs_comment#6619] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :        +- Project [rid#6566 AS rid_0#6575, cpfk_region_nation#6567 AS cpfk_region_nation_0#6576, cfpk_nation_region#6568 AS cfpk_nation_region_0#6577, cval_nation_n_name#6569 AS cval_nation_n_name_0#6578, cval_nation_n_comment#6570 AS cval_nation_n_comment_0#6579, cdepval_nation_n_name#6571 AS cdepval_nation_n_name_0#6580, cdepval_nation_n_comment#6572 AS cdepval_nation_n_comment_0#6581, cn_name#6573 AS cn_name_0#6582, cn_comment#6574 AS cn_comment_0#6583]
         :           +- Relation[rid#6566,cpfk_region_nation#6567,cfpk_nation_region#6568,cval_nation_n_name#6569,cval_nation_n_comment#6570,cdepval_nation_n_name#6571,cdepval_nation_n_comment#6572,cn_name#6573,cn_comment#6574] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#6806 AS rid_5#6830, cpfk_customer_orders#6807 AS cpfk_customer_orders_5#6831, cfpk_orders_customer#6808 AS cfpk_orders_customer_5#6832, cval_orders_o_orderstatus#6809 AS cval_orders_o_orderstatus_5#6833, cval_orders_o_totalprice#6810 AS cval_orders_o_totalprice_5#6834, cval_orders_o_orderpriority#6811 AS cval_orders_o_orderpriority_5#6835, cval_orders_o_clerk#6812 AS cval_orders_o_clerk_5#6836, cval_orders_o_shippriority#6813 AS cval_orders_o_shippriority_5#6837, cval_orders_o_comment#6814 AS cval_orders_o_comment_5#6838, cval_orders_o_orderdate#6815 AS cval_orders_o_orderdate_5#6839, cdepval_orders_o_orderstatus#6816 AS cdepval_orders_o_orderstatus_5#6840, cdepval_orders_o_totalprice#6817 AS cdepval_orders_o_totalprice_5#6841, cdepval_orders_o_orderpriority#6818 AS cdepval_orders_o_orderpriority_5#6842, cdepval_orders_o_clerk#6819 AS cdepval_orders_o_clerk_5#6843, cdepval_orders_o_shippriority#6820 AS cdepval_orders_o_shippriority_5#6844, cdepval_orders_o_comment#6821 AS cdepval_orders_o_comment_5#6845, cdepval_orders_o_orderdate#6822 AS cdepval_orders_o_orderdate_5#6846, co_orderstatus#6823 AS co_orderstatus_5#6847, co_totalprice#6824 AS co_totalprice_5#6848, co_orderpriority#6825 AS co_orderpriority_5#6849, co_clerk#6826 AS co_clerk_5#6850, co_shippriority#6827 AS co_shippriority_5#6851, co_comment#6828 AS co_comment_5#6852, co_orderdate#6829 AS co_orderdate_5#6853]
            :  +- Relation[rid#6806,cpfk_customer_orders#6807,cfpk_orders_customer#6808,cval_orders_o_orderstatus#6809,cval_orders_o_totalprice#6810,cval_orders_o_orderpriority#6811,cval_orders_o_clerk#6812,cval_orders_o_shippriority#6813,cval_orders_o_comment#6814,cval_orders_o_orderdate#6815,cdepval_orders_o_orderstatus#6816,cdepval_orders_o_totalprice#6817,cdepval_orders_o_orderpriority#6818,cdepval_orders_o_clerk#6819,cdepval_orders_o_shippriority#6820,cdepval_orders_o_comment#6821,cdepval_orders_o_orderdate#6822,co_orderstatus#6823,co_totalprice#6824,co_orderpriority#6825,co_clerk#6826,co_shippriority#6827,co_comment#6828,co_orderdate#6829] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_4, BinaryType)), 'cfpk_customer_nation_4) = 'rid_3)
               :- Project [rid#6764 AS rid_4#6785, cpfk_nation_customer#6765 AS cpfk_nation_customer_4#6786, cfpk_customer_nation#6766 AS cfpk_customer_nation_4#6787, cval_customer_c_name#6767 AS cval_customer_c_name_4#6788, cval_customer_c_address#6768 AS cval_customer_c_address_4#6789, cval_customer_c_phone#6769 AS cval_customer_c_phone_4#6790, cval_customer_c_acctbal#6770 AS cval_customer_c_acctbal_4#6791, cval_customer_c_comment#6771 AS cval_customer_c_comment_4#6792, cval_customer_c_mktsegment#6772 AS cval_customer_c_mktsegment_4#6793, cdepval_customer_c_name#6773 AS cdepval_customer_c_name_4#6794, cdepval_customer_c_address#6774 AS cdepval_customer_c_address_4#6795, cdepval_customer_c_phone#6775 AS cdepval_customer_c_phone_4#6796, cdepval_customer_c_acctbal#6776 AS cdepval_customer_c_acctbal_4#6797, cdepval_customer_c_comment#6777 AS cdepval_customer_c_comment_4#6798, cdepval_customer_c_mktsegment#6778 AS cdepval_customer_c_mktsegment_4#6799, cc_name#6779 AS cc_name_4#6800, cc_address#6780 AS cc_address_4#6801, cc_phone#6781 AS cc_phone_4#6802, cc_acctbal#6782 AS cc_acctbal_4#6803, cc_comment#6783 AS cc_comment_4#6804, cc_mktsegment#6784 AS cc_mktsegment_4#6805]
               :  +- Relation[rid#6764,cpfk_nation_customer#6765,cfpk_customer_nation#6766,cval_customer_c_name#6767,cval_customer_c_address#6768,cval_customer_c_phone#6769,cval_customer_c_acctbal#6770,cval_customer_c_comment#6771,cval_customer_c_mktsegment#6772,cdepval_customer_c_name#6773,cdepval_customer_c_address#6774,cdepval_customer_c_phone#6775,cdepval_customer_c_acctbal#6776,cdepval_customer_c_comment#6777,cdepval_customer_c_mktsegment#6778,cc_name#6779,cc_address#6780,cc_phone#6781,cc_acctbal#6782,cc_comment#6783,cc_mktsegment#6784] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
                  +- Project [rid#6728 AS rid_3#6737, cpfk_region_nation#6729 AS cpfk_region_nation_3#6738, cfpk_nation_region#6730 AS cfpk_nation_region_3#6739, cval_nation_n_name#6731 AS cval_nation_n_name_3#6740, cval_nation_n_comment#6732 AS cval_nation_n_comment_3#6741, cdepval_nation_n_name#6733 AS cdepval_nation_n_name_3#6742, cdepval_nation_n_comment#6734 AS cdepval_nation_n_comment_3#6743, cn_name#6735 AS cn_name_3#6744, cn_comment#6736 AS cn_comment_3#6745]
                     +- Relation[rid#6728,cpfk_region_nation#6729,cfpk_nation_region#6730,cval_nation_n_name#6731,cval_nation_n_comment#6732,cdepval_nation_n_name#6733,cdepval_nation_n_comment#6734,cn_name#6735,cn_comment#6736] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 34913ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/25 22:45:55 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:45:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7008L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:45:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7008L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#7010 AS rid_0#7055, cpfk_orders_lineitem#7011 AS cpfk_orders_lineitem_0#7056, cpfk_supplier_lineitem#7012 AS cpfk_supplier_lineitem_0#7057, cfpk_lineitem_supplier#7013 AS cfpk_lineitem_supplier_0#7058, cfpk_lineitem_partsupp#7014 AS cfpk_lineitem_partsupp_0#7059, cpfk_part_lineitem#7015 AS cpfk_part_lineitem_0#7060, cfpk_lineitem_part#7016 AS cfpk_lineitem_part_0#7061, cpfk_partsupp_lineitem#7017 AS cpfk_partsupp_lineitem_0#7062, cfpk_lineitem_orders#7018 AS cfpk_lineitem_orders_0#7063, cval_lineitem_l_quantity#7019 AS cval_lineitem_l_quantity_0#7064, cval_lineitem_l_extendedprice#7020 AS cval_lineitem_l_extendedprice_0#7065, cval_lineitem_l_discount#7021 AS cval_lineitem_l_discount_0#7066, cval_lineitem_l_tax#7022 AS cval_lineitem_l_tax_0#7067, cval_lineitem_l_returnflag#7023 AS cval_lineitem_l_returnflag_0#7068, cval_lineitem_l_linestatus#7024 AS cval_lineitem_l_linestatus_0#7069, cval_lineitem_l_commitdate#7025 AS cval_lineitem_l_commitdate_0#7070, cval_lineitem_l_receiptdate#7026 AS cval_lineitem_l_receiptdate_0#7071, cval_lineitem_l_shipinstruct#7027 AS cval_lineitem_l_shipinstruct_0#7072, cval_lineitem_l_shipmode#7028 AS cval_lineitem_l_shipmode_0#7073, cval_lineitem_l_comment#7029 AS cval_lineitem_l_comment_0#7074, cval_lineitem_l_shipdate#7030 AS cval_lineitem_l_shipdate_0#7075, cdepval_lineitem_l_quantity#7031 AS cdepval_lineitem_l_quantity_0#7076, cdepval_lineitem_l_extendedprice#7032 AS cdepval_lineitem_l_extendedprice_0#7077, cdepval_lineitem_l_discount#7033 AS cdepval_lineitem_l_discount_0#7078, ... 21 more fields]
         :  +- Relation[rid#7010,cpfk_orders_lineitem#7011,cpfk_supplier_lineitem#7012,cfpk_lineitem_supplier#7013,cfpk_lineitem_partsupp#7014,cpfk_part_lineitem#7015,cfpk_lineitem_part#7016,cpfk_partsupp_lineitem#7017,cfpk_lineitem_orders#7018,cval_lineitem_l_quantity#7019,cval_lineitem_l_extendedprice#7020,cval_lineitem_l_discount#7021,cval_lineitem_l_tax#7022,cval_lineitem_l_returnflag#7023,cval_lineitem_l_linestatus#7024,cval_lineitem_l_commitdate#7025,cval_lineitem_l_receiptdate#7026,cval_lineitem_l_shipinstruct#7027,cval_lineitem_l_shipmode#7028,cval_lineitem_l_comment#7029,cval_lineitem_l_shipdate#7030,cdepval_lineitem_l_quantity#7031,cdepval_lineitem_l_extendedprice#7032,cdepval_lineitem_l_discount#7033,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7100 AS rid_1#7124, cpfk_customer_orders#7101 AS cpfk_customer_orders_1#7125, cfpk_orders_customer#7102 AS cfpk_orders_customer_1#7126, cval_orders_o_orderstatus#7103 AS cval_orders_o_orderstatus_1#7127, cval_orders_o_totalprice#7104 AS cval_orders_o_totalprice_1#7128, cval_orders_o_orderpriority#7105 AS cval_orders_o_orderpriority_1#7129, cval_orders_o_clerk#7106 AS cval_orders_o_clerk_1#7130, cval_orders_o_shippriority#7107 AS cval_orders_o_shippriority_1#7131, cval_orders_o_comment#7108 AS cval_orders_o_comment_1#7132, cval_orders_o_orderdate#7109 AS cval_orders_o_orderdate_1#7133, cdepval_orders_o_orderstatus#7110 AS cdepval_orders_o_orderstatus_1#7134, cdepval_orders_o_totalprice#7111 AS cdepval_orders_o_totalprice_1#7135, cdepval_orders_o_orderpriority#7112 AS cdepval_orders_o_orderpriority_1#7136, cdepval_orders_o_clerk#7113 AS cdepval_orders_o_clerk_1#7137, cdepval_orders_o_shippriority#7114 AS cdepval_orders_o_shippriority_1#7138, cdepval_orders_o_comment#7115 AS cdepval_orders_o_comment_1#7139, cdepval_orders_o_orderdate#7116 AS cdepval_orders_o_orderdate_1#7140, co_orderstatus#7117 AS co_orderstatus_1#7141, co_totalprice#7118 AS co_totalprice_1#7142, co_orderpriority#7119 AS co_orderpriority_1#7143, co_clerk#7120 AS co_clerk_1#7144, co_shippriority#7121 AS co_shippriority_1#7145, co_comment#7122 AS co_comment_1#7146, co_orderdate#7123 AS co_orderdate_1#7147]
            +- Relation[rid#7100,cpfk_customer_orders#7101,cfpk_orders_customer#7102,cval_orders_o_orderstatus#7103,cval_orders_o_totalprice#7104,cval_orders_o_orderpriority#7105,cval_orders_o_clerk#7106,cval_orders_o_shippriority#7107,cval_orders_o_comment#7108,cval_orders_o_orderdate#7109,cdepval_orders_o_orderstatus#7110,cdepval_orders_o_totalprice#7111,cdepval_orders_o_orderpriority#7112,cdepval_orders_o_clerk#7113,cdepval_orders_o_shippriority#7114,cdepval_orders_o_comment#7115,cdepval_orders_o_orderdate#7116,co_orderstatus#7117,co_totalprice#7118,co_orderpriority#7119,co_clerk#7120,co_shippriority#7121,co_comment#7122,co_orderdate#7123] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18255ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/25 22:46:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:46:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7222L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 22:46:13 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:46:13 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:46:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:46:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:46:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:46:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:46:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:46:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:46:13 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:46:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:46:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7222L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :  :- Project [rid#7324 AS rid_1#7338, cpfk_part_partsupp#7325 AS cpfk_part_partsupp_1#7339, cfpk_partsupp_part#7326 AS cfpk_partsupp_part_1#7340, cpfk_supplier_partsupp#7327 AS cpfk_supplier_partsupp_1#7341, cfpk_partsupp_supplier#7328 AS cfpk_partsupp_supplier_1#7342, cval_partsupp_ps_availqty#7329 AS cval_partsupp_ps_availqty_1#7343, cval_partsupp_ps_supplycost#7330 AS cval_partsupp_ps_supplycost_1#7344, cval_partsupp_ps_comment#7331 AS cval_partsupp_ps_comment_1#7345, cdepval_partsupp_ps_availqty#7332 AS cdepval_partsupp_ps_availqty_1#7346, cdepval_partsupp_ps_supplycost#7333 AS cdepval_partsupp_ps_supplycost_1#7347, cdepval_partsupp_ps_comment#7334 AS cdepval_partsupp_ps_comment_1#7348, cps_availqty#7335 AS cps_availqty_1#7349, cps_supplycost#7336 AS cps_supplycost_1#7350, cps_comment#7337 AS cps_comment_1#7351]
         :  :  +- Relation[rid#7324,cpfk_part_partsupp#7325,cfpk_partsupp_part#7326,cpfk_supplier_partsupp#7327,cfpk_partsupp_supplier#7328,cval_partsupp_ps_availqty#7329,cval_partsupp_ps_supplycost#7330,cval_partsupp_ps_comment#7331,cdepval_partsupp_ps_availqty#7332,cdepval_partsupp_ps_supplycost#7333,cdepval_partsupp_ps_comment#7334,cps_availqty#7335,cps_supplycost#7336,cps_comment#7337] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :     +- Project [rid#7224 AS rid_0#7249, cval_part_p_name#7225 AS cval_part_p_name_0#7250, cval_part_p_mfgr#7226 AS cval_part_p_mfgr_0#7251, cval_part_p_type#7227 AS cval_part_p_type_0#7252, cval_part_p_size#7228 AS cval_part_p_size_0#7253, cval_part_p_container#7229 AS cval_part_p_container_0#7254, cval_part_p_retailprice#7230 AS cval_part_p_retailprice_0#7255, cval_part_p_comment#7231 AS cval_part_p_comment_0#7256, cval_part_p_brand#7232 AS cval_part_p_brand_0#7257, cdepval_part_p_name#7233 AS cdepval_part_p_name_0#7258, cdepval_part_p_mfgr#7234 AS cdepval_part_p_mfgr_0#7259, cdepval_part_p_type#7235 AS cdepval_part_p_type_0#7260, cdepval_part_p_size#7236 AS cdepval_part_p_size_0#7261, cdepval_part_p_container#7237 AS cdepval_part_p_container_0#7262, cdepval_part_p_retailprice#7238 AS cdepval_part_p_retailprice_0#7263, cdepval_part_p_comment#7239 AS cdepval_part_p_comment_0#7264, cdepval_part_p_brand#7240 AS cdepval_part_p_brand_0#7265, cp_name#7241 AS cp_name_0#7266, cp_mfgr#7242 AS cp_mfgr_0#7267, cp_type#7243 AS cp_type_0#7268, cp_size#7244 AS cp_size_0#7269, cp_container#7245 AS cp_container_0#7270, cp_retailprice#7246 AS cp_retailprice_0#7271, cp_comment#7247 AS cp_comment_0#7272, cp_brand#7248 AS cp_brand_0#7273]
         :        +- Relation[rid#7224,cval_part_p_name#7225,cval_part_p_mfgr#7226,cval_part_p_type#7227,cval_part_p_size#7228,cval_part_p_container#7229,cval_part_p_retailprice#7230,cval_part_p_comment#7231,cval_part_p_brand#7232,cdepval_part_p_name#7233,cdepval_part_p_mfgr#7234,cdepval_part_p_type#7235,cdepval_part_p_size#7236,cdepval_part_p_container#7237,cdepval_part_p_retailprice#7238,cdepval_part_p_comment#7239,cdepval_part_p_brand#7240,cp_name#7241,cp_mfgr#7242,cp_type#7243,cp_size#7244,cp_container#7245,cp_retailprice#7246,cp_comment#7247,cp_brand#7248] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_2)
            :- Project [rid#7388 AS rid_3#7406, cpfk_nation_supplier#7389 AS cpfk_nation_supplier_3#7407, cfpk_supplier_nation#7390 AS cfpk_supplier_nation_3#7408, cval_supplier_s_name#7391 AS cval_supplier_s_name_3#7409, cval_supplier_s_address#7392 AS cval_supplier_s_address_3#7410, cval_supplier_s_phone#7393 AS cval_supplier_s_phone_3#7411, cval_supplier_s_acctbal#7394 AS cval_supplier_s_acctbal_3#7412, cval_supplier_s_comment#7395 AS cval_supplier_s_comment_3#7413, cdepval_supplier_s_name#7396 AS cdepval_supplier_s_name_3#7414, cdepval_supplier_s_address#7397 AS cdepval_supplier_s_address_3#7415, cdepval_supplier_s_phone#7398 AS cdepval_supplier_s_phone_3#7416, cdepval_supplier_s_acctbal#7399 AS cdepval_supplier_s_acctbal_3#7417, cdepval_supplier_s_comment#7400 AS cdepval_supplier_s_comment_3#7418, cs_name#7401 AS cs_name_3#7419, cs_address#7402 AS cs_address_3#7420, cs_phone#7403 AS cs_phone_3#7421, cs_acctbal#7404 AS cs_acctbal_3#7422, cs_comment#7405 AS cs_comment_3#7423]
            :  +- Relation[rid#7388,cpfk_nation_supplier#7389,cfpk_supplier_nation#7390,cval_supplier_s_name#7391,cval_supplier_s_address#7392,cval_supplier_s_phone#7393,cval_supplier_s_acctbal#7394,cval_supplier_s_comment#7395,cdepval_supplier_s_name#7396,cdepval_supplier_s_address#7397,cdepval_supplier_s_phone#7398,cdepval_supplier_s_acctbal#7399,cdepval_supplier_s_comment#7400,cs_name#7401,cs_address#7402,cs_phone#7403,cs_acctbal#7404,cs_comment#7405] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
               +- Project [rid#7352 AS rid_2#7361, cpfk_region_nation#7353 AS cpfk_region_nation_2#7362, cfpk_nation_region#7354 AS cfpk_nation_region_2#7363, cval_nation_n_name#7355 AS cval_nation_n_name_2#7364, cval_nation_n_comment#7356 AS cval_nation_n_comment_2#7365, cdepval_nation_n_name#7357 AS cdepval_nation_n_name_2#7366, cdepval_nation_n_comment#7358 AS cdepval_nation_n_comment_2#7367, cn_name#7359 AS cn_name_2#7368, cn_comment#7360 AS cn_comment_2#7369]
                  +- Relation[rid#7352,cpfk_region_nation#7353,cfpk_nation_region#7354,cval_nation_n_name#7355,cval_nation_n_comment#7356,cdepval_nation_n_name#7357,cdepval_nation_n_comment#7358,cn_name#7359,cn_comment#7360] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 3660ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 22:46:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:46:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7499L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:46:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:46:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:46:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:46:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:46:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:46:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:46:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:46:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7499L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#7555 AS rid_2#7600, cpfk_orders_lineitem#7556 AS cpfk_orders_lineitem_2#7601, cpfk_supplier_lineitem#7557 AS cpfk_supplier_lineitem_2#7602, cfpk_lineitem_supplier#7558 AS cfpk_lineitem_supplier_2#7603, cfpk_lineitem_partsupp#7559 AS cfpk_lineitem_partsupp_2#7604, cpfk_part_lineitem#7560 AS cpfk_part_lineitem_2#7605, cfpk_lineitem_part#7561 AS cfpk_lineitem_part_2#7606, cpfk_partsupp_lineitem#7562 AS cpfk_partsupp_lineitem_2#7607, cfpk_lineitem_orders#7563 AS cfpk_lineitem_orders_2#7608, cval_lineitem_l_quantity#7564 AS cval_lineitem_l_quantity_2#7609, cval_lineitem_l_extendedprice#7565 AS cval_lineitem_l_extendedprice_2#7610, cval_lineitem_l_discount#7566 AS cval_lineitem_l_discount_2#7611, cval_lineitem_l_tax#7567 AS cval_lineitem_l_tax_2#7612, cval_lineitem_l_returnflag#7568 AS cval_lineitem_l_returnflag_2#7613, cval_lineitem_l_linestatus#7569 AS cval_lineitem_l_linestatus_2#7614, cval_lineitem_l_commitdate#7570 AS cval_lineitem_l_commitdate_2#7615, cval_lineitem_l_receiptdate#7571 AS cval_lineitem_l_receiptdate_2#7616, cval_lineitem_l_shipinstruct#7572 AS cval_lineitem_l_shipinstruct_2#7617, cval_lineitem_l_shipmode#7573 AS cval_lineitem_l_shipmode_2#7618, cval_lineitem_l_comment#7574 AS cval_lineitem_l_comment_2#7619, cval_lineitem_l_shipdate#7575 AS cval_lineitem_l_shipdate_2#7620, cdepval_lineitem_l_quantity#7576 AS cdepval_lineitem_l_quantity_2#7621, cdepval_lineitem_l_extendedprice#7577 AS cdepval_lineitem_l_extendedprice_2#7622, cdepval_lineitem_l_discount#7578 AS cdepval_lineitem_l_discount_2#7623, ... 21 more fields]
         :  :  :  :  +- Relation[rid#7555,cpfk_orders_lineitem#7556,cpfk_supplier_lineitem#7557,cfpk_lineitem_supplier#7558,cfpk_lineitem_partsupp#7559,cpfk_part_lineitem#7560,cfpk_lineitem_part#7561,cpfk_partsupp_lineitem#7562,cfpk_lineitem_orders#7563,cval_lineitem_l_quantity#7564,cval_lineitem_l_extendedprice#7565,cval_lineitem_l_discount#7566,cval_lineitem_l_tax#7567,cval_lineitem_l_returnflag#7568,cval_lineitem_l_linestatus#7569,cval_lineitem_l_commitdate#7570,cval_lineitem_l_receiptdate#7571,cval_lineitem_l_shipinstruct#7572,cval_lineitem_l_shipmode#7573,cval_lineitem_l_comment#7574,cval_lineitem_l_shipdate#7575,cdepval_lineitem_l_quantity#7576,cdepval_lineitem_l_extendedprice#7577,cdepval_lineitem_l_discount#7578,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#7519 AS rid_1#7537, cpfk_nation_supplier#7520 AS cpfk_nation_supplier_1#7538, cfpk_supplier_nation#7521 AS cfpk_supplier_nation_1#7539, cval_supplier_s_name#7522 AS cval_supplier_s_name_1#7540, cval_supplier_s_address#7523 AS cval_supplier_s_address_1#7541, cval_supplier_s_phone#7524 AS cval_supplier_s_phone_1#7542, cval_supplier_s_acctbal#7525 AS cval_supplier_s_acctbal_1#7543, cval_supplier_s_comment#7526 AS cval_supplier_s_comment_1#7544, cdepval_supplier_s_name#7527 AS cdepval_supplier_s_name_1#7545, cdepval_supplier_s_address#7528 AS cdepval_supplier_s_address_1#7546, cdepval_supplier_s_phone#7529 AS cdepval_supplier_s_phone_1#7547, cdepval_supplier_s_acctbal#7530 AS cdepval_supplier_s_acctbal_1#7548, cdepval_supplier_s_comment#7531 AS cdepval_supplier_s_comment_1#7549, cs_name#7532 AS cs_name_1#7550, cs_address#7533 AS cs_address_1#7551, cs_phone#7534 AS cs_phone_1#7552, cs_acctbal#7535 AS cs_acctbal_1#7553, cs_comment#7536 AS cs_comment_1#7554]
         :  :  :     :  +- Relation[rid#7519,cpfk_nation_supplier#7520,cfpk_supplier_nation#7521,cval_supplier_s_name#7522,cval_supplier_s_address#7523,cval_supplier_s_phone#7524,cval_supplier_s_acctbal#7525,cval_supplier_s_comment#7526,cdepval_supplier_s_name#7527,cdepval_supplier_s_address#7528,cdepval_supplier_s_phone#7529,cdepval_supplier_s_acctbal#7530,cdepval_supplier_s_comment#7531,cs_name#7532,cs_address#7533,cs_phone#7534,cs_acctbal#7535,cs_comment#7536] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#7501 AS rid_0#7510, cpfk_region_nation#7502 AS cpfk_region_nation_0#7511, cfpk_nation_region#7503 AS cfpk_nation_region_0#7512, cval_nation_n_name#7504 AS cval_nation_n_name_0#7513, cval_nation_n_comment#7505 AS cval_nation_n_comment_0#7514, cdepval_nation_n_name#7506 AS cdepval_nation_n_name_0#7515, cdepval_nation_n_comment#7507 AS cdepval_nation_n_comment_0#7516, cn_name#7508 AS cn_name_0#7517, cn_comment#7509 AS cn_comment_0#7518]
         :  :  :        +- Relation[rid#7501,cpfk_region_nation#7502,cfpk_nation_region#7503,cval_nation_n_name#7504,cval_nation_n_comment#7505,cdepval_nation_n_name#7506,cdepval_nation_n_comment#7507,cn_name#7508,cn_comment#7509] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#7645 AS rid_3#7670, cval_part_p_name#7646 AS cval_part_p_name_3#7671, cval_part_p_mfgr#7647 AS cval_part_p_mfgr_3#7672, cval_part_p_type#7648 AS cval_part_p_type_3#7673, cval_part_p_size#7649 AS cval_part_p_size_3#7674, cval_part_p_container#7650 AS cval_part_p_container_3#7675, cval_part_p_retailprice#7651 AS cval_part_p_retailprice_3#7676, cval_part_p_comment#7652 AS cval_part_p_comment_3#7677, cval_part_p_brand#7653 AS cval_part_p_brand_3#7678, cdepval_part_p_name#7654 AS cdepval_part_p_name_3#7679, cdepval_part_p_mfgr#7655 AS cdepval_part_p_mfgr_3#7680, cdepval_part_p_type#7656 AS cdepval_part_p_type_3#7681, cdepval_part_p_size#7657 AS cdepval_part_p_size_3#7682, cdepval_part_p_container#7658 AS cdepval_part_p_container_3#7683, cdepval_part_p_retailprice#7659 AS cdepval_part_p_retailprice_3#7684, cdepval_part_p_comment#7660 AS cdepval_part_p_comment_3#7685, cdepval_part_p_brand#7661 AS cdepval_part_p_brand_3#7686, cp_name#7662 AS cp_name_3#7687, cp_mfgr#7663 AS cp_mfgr_3#7688, cp_type#7664 AS cp_type_3#7689, cp_size#7665 AS cp_size_3#7690, cp_container#7666 AS cp_container_3#7691, cp_retailprice#7667 AS cp_retailprice_3#7692, cp_comment#7668 AS cp_comment_3#7693, cp_brand#7669 AS cp_brand_3#7694]
         :  :     +- Relation[rid#7645,cval_part_p_name#7646,cval_part_p_mfgr#7647,cval_part_p_type#7648,cval_part_p_size#7649,cval_part_p_container#7650,cval_part_p_retailprice#7651,cval_part_p_comment#7652,cval_part_p_brand#7653,cdepval_part_p_name#7654,cdepval_part_p_mfgr#7655,cdepval_part_p_type#7656,cdepval_part_p_size#7657,cdepval_part_p_container#7658,cdepval_part_p_retailprice#7659,cdepval_part_p_comment#7660,cdepval_part_p_brand#7661,cp_name#7662,cp_mfgr#7663,cp_type#7664,cp_size#7665,cp_container#7666,cp_retailprice#7667,cp_comment#7668,cp_brand#7669] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#7695 AS rid_4#7709, cpfk_part_partsupp#7696 AS cpfk_part_partsupp_4#7710, cfpk_partsupp_part#7697 AS cfpk_partsupp_part_4#7711, cpfk_supplier_partsupp#7698 AS cpfk_supplier_partsupp_4#7712, cfpk_partsupp_supplier#7699 AS cfpk_partsupp_supplier_4#7713, cval_partsupp_ps_availqty#7700 AS cval_partsupp_ps_availqty_4#7714, cval_partsupp_ps_supplycost#7701 AS cval_partsupp_ps_supplycost_4#7715, cval_partsupp_ps_comment#7702 AS cval_partsupp_ps_comment_4#7716, cdepval_partsupp_ps_availqty#7703 AS cdepval_partsupp_ps_availqty_4#7717, cdepval_partsupp_ps_supplycost#7704 AS cdepval_partsupp_ps_supplycost_4#7718, cdepval_partsupp_ps_comment#7705 AS cdepval_partsupp_ps_comment_4#7719, cps_availqty#7706 AS cps_availqty_4#7720, cps_supplycost#7707 AS cps_supplycost_4#7721, cps_comment#7708 AS cps_comment_4#7722]
         :     +- Relation[rid#7695,cpfk_part_partsupp#7696,cfpk_partsupp_part#7697,cpfk_supplier_partsupp#7698,cfpk_partsupp_supplier#7699,cval_partsupp_ps_availqty#7700,cval_partsupp_ps_supplycost#7701,cval_partsupp_ps_comment#7702,cdepval_partsupp_ps_availqty#7703,cdepval_partsupp_ps_supplycost#7704,cdepval_partsupp_ps_comment#7705,cps_availqty#7706,cps_supplycost#7707,cps_comment#7708] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#7723 AS rid_5#7747, cpfk_customer_orders#7724 AS cpfk_customer_orders_5#7748, cfpk_orders_customer#7725 AS cfpk_orders_customer_5#7749, cval_orders_o_orderstatus#7726 AS cval_orders_o_orderstatus_5#7750, cval_orders_o_totalprice#7727 AS cval_orders_o_totalprice_5#7751, cval_orders_o_orderpriority#7728 AS cval_orders_o_orderpriority_5#7752, cval_orders_o_clerk#7729 AS cval_orders_o_clerk_5#7753, cval_orders_o_shippriority#7730 AS cval_orders_o_shippriority_5#7754, cval_orders_o_comment#7731 AS cval_orders_o_comment_5#7755, cval_orders_o_orderdate#7732 AS cval_orders_o_orderdate_5#7756, cdepval_orders_o_orderstatus#7733 AS cdepval_orders_o_orderstatus_5#7757, cdepval_orders_o_totalprice#7734 AS cdepval_orders_o_totalprice_5#7758, cdepval_orders_o_orderpriority#7735 AS cdepval_orders_o_orderpriority_5#7759, cdepval_orders_o_clerk#7736 AS cdepval_orders_o_clerk_5#7760, cdepval_orders_o_shippriority#7737 AS cdepval_orders_o_shippriority_5#7761, cdepval_orders_o_comment#7738 AS cdepval_orders_o_comment_5#7762, cdepval_orders_o_orderdate#7739 AS cdepval_orders_o_orderdate_5#7763, co_orderstatus#7740 AS co_orderstatus_5#7764, co_totalprice#7741 AS co_totalprice_5#7765, co_orderpriority#7742 AS co_orderpriority_5#7766, co_clerk#7743 AS co_clerk_5#7767, co_shippriority#7744 AS co_shippriority_5#7768, co_comment#7745 AS co_comment_5#7769, co_orderdate#7746 AS co_orderdate_5#7770]
            +- Relation[rid#7723,cpfk_customer_orders#7724,cfpk_orders_customer#7725,cval_orders_o_orderstatus#7726,cval_orders_o_totalprice#7727,cval_orders_o_orderpriority#7728,cval_orders_o_clerk#7729,cval_orders_o_shippriority#7730,cval_orders_o_comment#7731,cval_orders_o_orderdate#7732,cdepval_orders_o_orderstatus#7733,cdepval_orders_o_totalprice#7734,cdepval_orders_o_orderpriority#7735,cdepval_orders_o_clerk#7736,cdepval_orders_o_shippriority#7737,cdepval_orders_o_comment#7738,cdepval_orders_o_orderdate#7739,co_orderstatus#7740,co_totalprice#7741,co_orderpriority#7742,co_clerk#7743,co_shippriority#7744,co_comment#7745,co_orderdate#7746] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 64038ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/25 22:47:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:47:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7910L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:47:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:47:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:47:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:47:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:47:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:47:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:47:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7910L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#8062 AS rid_1#8107, cpfk_orders_lineitem#8063 AS cpfk_orders_lineitem_1#8108, cpfk_supplier_lineitem#8064 AS cpfk_supplier_lineitem_1#8109, cfpk_lineitem_supplier#8065 AS cfpk_lineitem_supplier_1#8110, cfpk_lineitem_partsupp#8066 AS cfpk_lineitem_partsupp_1#8111, cpfk_part_lineitem#8067 AS cpfk_part_lineitem_1#8112, cfpk_lineitem_part#8068 AS cfpk_lineitem_part_1#8113, cpfk_partsupp_lineitem#8069 AS cpfk_partsupp_lineitem_1#8114, cfpk_lineitem_orders#8070 AS cfpk_lineitem_orders_1#8115, cval_lineitem_l_quantity#8071 AS cval_lineitem_l_quantity_1#8116, cval_lineitem_l_extendedprice#8072 AS cval_lineitem_l_extendedprice_1#8117, cval_lineitem_l_discount#8073 AS cval_lineitem_l_discount_1#8118, cval_lineitem_l_tax#8074 AS cval_lineitem_l_tax_1#8119, cval_lineitem_l_returnflag#8075 AS cval_lineitem_l_returnflag_1#8120, cval_lineitem_l_linestatus#8076 AS cval_lineitem_l_linestatus_1#8121, cval_lineitem_l_commitdate#8077 AS cval_lineitem_l_commitdate_1#8122, cval_lineitem_l_receiptdate#8078 AS cval_lineitem_l_receiptdate_1#8123, cval_lineitem_l_shipinstruct#8079 AS cval_lineitem_l_shipinstruct_1#8124, cval_lineitem_l_shipmode#8080 AS cval_lineitem_l_shipmode_1#8125, cval_lineitem_l_comment#8081 AS cval_lineitem_l_comment_1#8126, cval_lineitem_l_shipdate#8082 AS cval_lineitem_l_shipdate_1#8127, cdepval_lineitem_l_quantity#8083 AS cdepval_lineitem_l_quantity_1#8128, cdepval_lineitem_l_extendedprice#8084 AS cdepval_lineitem_l_extendedprice_1#8129, cdepval_lineitem_l_discount#8085 AS cdepval_lineitem_l_discount_1#8130, ... 21 more fields]
         :  +- Relation[rid#8062,cpfk_orders_lineitem#8063,cpfk_supplier_lineitem#8064,cfpk_lineitem_supplier#8065,cfpk_lineitem_partsupp#8066,cpfk_part_lineitem#8067,cfpk_lineitem_part#8068,cpfk_partsupp_lineitem#8069,cfpk_lineitem_orders#8070,cval_lineitem_l_quantity#8071,cval_lineitem_l_extendedprice#8072,cval_lineitem_l_discount#8073,cval_lineitem_l_tax#8074,cval_lineitem_l_returnflag#8075,cval_lineitem_l_linestatus#8076,cval_lineitem_l_commitdate#8077,cval_lineitem_l_receiptdate#8078,cval_lineitem_l_shipinstruct#8079,cval_lineitem_l_shipmode#8080,cval_lineitem_l_comment#8081,cval_lineitem_l_shipdate#8082,cdepval_lineitem_l_quantity#8083,cdepval_lineitem_l_extendedprice#8084,cdepval_lineitem_l_discount#8085,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
               +- Project [rid#7912 AS rid_0#7937, cval_part_p_name#7913 AS cval_part_p_name_0#7938, cval_part_p_mfgr#7914 AS cval_part_p_mfgr_0#7939, cval_part_p_type#7915 AS cval_part_p_type_0#7940, cval_part_p_size#7916 AS cval_part_p_size_0#7941, cval_part_p_container#7917 AS cval_part_p_container_0#7942, cval_part_p_retailprice#7918 AS cval_part_p_retailprice_0#7943, cval_part_p_comment#7919 AS cval_part_p_comment_0#7944, cval_part_p_brand#7920 AS cval_part_p_brand_0#7945, cdepval_part_p_name#7921 AS cdepval_part_p_name_0#7946, cdepval_part_p_mfgr#7922 AS cdepval_part_p_mfgr_0#7947, cdepval_part_p_type#7923 AS cdepval_part_p_type_0#7948, cdepval_part_p_size#7924 AS cdepval_part_p_size_0#7949, cdepval_part_p_container#7925 AS cdepval_part_p_container_0#7950, cdepval_part_p_retailprice#7926 AS cdepval_part_p_retailprice_0#7951, cdepval_part_p_comment#7927 AS cdepval_part_p_comment_0#7952, cdepval_part_p_brand#7928 AS cdepval_part_p_brand_0#7953, cp_name#7929 AS cp_name_0#7954, cp_mfgr#7930 AS cp_mfgr_0#7955, cp_type#7931 AS cp_type_0#7956, cp_size#7932 AS cp_size_0#7957, cp_container#7933 AS cp_container_0#7958, cp_retailprice#7934 AS cp_retailprice_0#7959, cp_comment#7935 AS cp_comment_0#7960, cp_brand#7936 AS cp_brand_0#7961]
                  +- Relation[rid#7912,cval_part_p_name#7913,cval_part_p_mfgr#7914,cval_part_p_type#7915,cval_part_p_size#7916,cval_part_p_container#7917,cval_part_p_retailprice#7918,cval_part_p_comment#7919,cval_part_p_brand#7920,cdepval_part_p_name#7921,cdepval_part_p_mfgr#7922,cdepval_part_p_type#7923,cdepval_part_p_size#7924,cdepval_part_p_container#7925,cdepval_part_p_retailprice#7926,cdepval_part_p_comment#7927,cdepval_part_p_brand#7928,cp_name#7929,cp_mfgr#7930,cp_type#7931,cp_size#7932,cp_container#7933,cp_retailprice#7934,cp_comment#7935,cp_brand#7936] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 25981ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/25 22:47:47 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:47:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8226L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 22:47:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:47:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:47:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:47:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:47:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:47:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:47:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:47:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8226L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#8228 AS rid_0#8273, cpfk_orders_lineitem#8229 AS cpfk_orders_lineitem_0#8274, cpfk_supplier_lineitem#8230 AS cpfk_supplier_lineitem_0#8275, cfpk_lineitem_supplier#8231 AS cfpk_lineitem_supplier_0#8276, cfpk_lineitem_partsupp#8232 AS cfpk_lineitem_partsupp_0#8277, cpfk_part_lineitem#8233 AS cpfk_part_lineitem_0#8278, cfpk_lineitem_part#8234 AS cfpk_lineitem_part_0#8279, cpfk_partsupp_lineitem#8235 AS cpfk_partsupp_lineitem_0#8280, cfpk_lineitem_orders#8236 AS cfpk_lineitem_orders_0#8281, cval_lineitem_l_quantity#8237 AS cval_lineitem_l_quantity_0#8282, cval_lineitem_l_extendedprice#8238 AS cval_lineitem_l_extendedprice_0#8283, cval_lineitem_l_discount#8239 AS cval_lineitem_l_discount_0#8284, cval_lineitem_l_tax#8240 AS cval_lineitem_l_tax_0#8285, cval_lineitem_l_returnflag#8241 AS cval_lineitem_l_returnflag_0#8286, cval_lineitem_l_linestatus#8242 AS cval_lineitem_l_linestatus_0#8287, cval_lineitem_l_commitdate#8243 AS cval_lineitem_l_commitdate_0#8288, cval_lineitem_l_receiptdate#8244 AS cval_lineitem_l_receiptdate_0#8289, cval_lineitem_l_shipinstruct#8245 AS cval_lineitem_l_shipinstruct_0#8290, cval_lineitem_l_shipmode#8246 AS cval_lineitem_l_shipmode_0#8291, cval_lineitem_l_comment#8247 AS cval_lineitem_l_comment_0#8292, cval_lineitem_l_shipdate#8248 AS cval_lineitem_l_shipdate_0#8293, cdepval_lineitem_l_quantity#8249 AS cdepval_lineitem_l_quantity_0#8294, cdepval_lineitem_l_extendedprice#8250 AS cdepval_lineitem_l_extendedprice_0#8295, cdepval_lineitem_l_discount#8251 AS cdepval_lineitem_l_discount_0#8296, ... 21 more fields]
         :  +- Relation[rid#8228,cpfk_orders_lineitem#8229,cpfk_supplier_lineitem#8230,cfpk_lineitem_supplier#8231,cfpk_lineitem_partsupp#8232,cpfk_part_lineitem#8233,cfpk_lineitem_part#8234,cpfk_partsupp_lineitem#8235,cfpk_lineitem_orders#8236,cval_lineitem_l_quantity#8237,cval_lineitem_l_extendedprice#8238,cval_lineitem_l_discount#8239,cval_lineitem_l_tax#8240,cval_lineitem_l_returnflag#8241,cval_lineitem_l_linestatus#8242,cval_lineitem_l_commitdate#8243,cval_lineitem_l_receiptdate#8244,cval_lineitem_l_shipinstruct#8245,cval_lineitem_l_shipmode#8246,cval_lineitem_l_comment#8247,cval_lineitem_l_shipdate#8248,cdepval_lineitem_l_quantity#8249,cdepval_lineitem_l_extendedprice#8250,cdepval_lineitem_l_discount#8251,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
            :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
            :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
            :  :  :- Project [rid#8414 AS rid_2#8459, cpfk_orders_lineitem#8415 AS cpfk_orders_lineitem_2#8460, cpfk_supplier_lineitem#8416 AS cpfk_supplier_lineitem_2#8461, cfpk_lineitem_supplier#8417 AS cfpk_lineitem_supplier_2#8462, cfpk_lineitem_partsupp#8418 AS cfpk_lineitem_partsupp_2#8463, cpfk_part_lineitem#8419 AS cpfk_part_lineitem_2#8464, cfpk_lineitem_part#8420 AS cfpk_lineitem_part_2#8465, cpfk_partsupp_lineitem#8421 AS cpfk_partsupp_lineitem_2#8466, cfpk_lineitem_orders#8422 AS cfpk_lineitem_orders_2#8467, cval_lineitem_l_quantity#8423 AS cval_lineitem_l_quantity_2#8468, cval_lineitem_l_extendedprice#8424 AS cval_lineitem_l_extendedprice_2#8469, cval_lineitem_l_discount#8425 AS cval_lineitem_l_discount_2#8470, cval_lineitem_l_tax#8426 AS cval_lineitem_l_tax_2#8471, cval_lineitem_l_returnflag#8427 AS cval_lineitem_l_returnflag_2#8472, cval_lineitem_l_linestatus#8428 AS cval_lineitem_l_linestatus_2#8473, cval_lineitem_l_commitdate#8429 AS cval_lineitem_l_commitdate_2#8474, cval_lineitem_l_receiptdate#8430 AS cval_lineitem_l_receiptdate_2#8475, cval_lineitem_l_shipinstruct#8431 AS cval_lineitem_l_shipinstruct_2#8476, cval_lineitem_l_shipmode#8432 AS cval_lineitem_l_shipmode_2#8477, cval_lineitem_l_comment#8433 AS cval_lineitem_l_comment_2#8478, cval_lineitem_l_shipdate#8434 AS cval_lineitem_l_shipdate_2#8479, cdepval_lineitem_l_quantity#8435 AS cdepval_lineitem_l_quantity_2#8480, cdepval_lineitem_l_extendedprice#8436 AS cdepval_lineitem_l_extendedprice_2#8481, cdepval_lineitem_l_discount#8437 AS cdepval_lineitem_l_discount_2#8482, ... 21 more fields]
            :  :  :  +- Relation[rid#8414,cpfk_orders_lineitem#8415,cpfk_supplier_lineitem#8416,cfpk_lineitem_supplier#8417,cfpk_lineitem_partsupp#8418,cpfk_part_lineitem#8419,cfpk_lineitem_part#8420,cpfk_partsupp_lineitem#8421,cfpk_lineitem_orders#8422,cval_lineitem_l_quantity#8423,cval_lineitem_l_extendedprice#8424,cval_lineitem_l_discount#8425,cval_lineitem_l_tax#8426,cval_lineitem_l_returnflag#8427,cval_lineitem_l_linestatus#8428,cval_lineitem_l_commitdate#8429,cval_lineitem_l_receiptdate#8430,cval_lineitem_l_shipinstruct#8431,cval_lineitem_l_shipmode#8432,cval_lineitem_l_comment#8433,cval_lineitem_l_shipdate#8434,cdepval_lineitem_l_quantity#8435,cdepval_lineitem_l_extendedprice#8436,cdepval_lineitem_l_discount#8437,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
            :  :     +- Project [rid#8318 AS rid_1#8342, cpfk_customer_orders#8319 AS cpfk_customer_orders_1#8343, cfpk_orders_customer#8320 AS cfpk_orders_customer_1#8344, cval_orders_o_orderstatus#8321 AS cval_orders_o_orderstatus_1#8345, cval_orders_o_totalprice#8322 AS cval_orders_o_totalprice_1#8346, cval_orders_o_orderpriority#8323 AS cval_orders_o_orderpriority_1#8347, cval_orders_o_clerk#8324 AS cval_orders_o_clerk_1#8348, cval_orders_o_shippriority#8325 AS cval_orders_o_shippriority_1#8349, cval_orders_o_comment#8326 AS cval_orders_o_comment_1#8350, cval_orders_o_orderdate#8327 AS cval_orders_o_orderdate_1#8351, cdepval_orders_o_orderstatus#8328 AS cdepval_orders_o_orderstatus_1#8352, cdepval_orders_o_totalprice#8329 AS cdepval_orders_o_totalprice_1#8353, cdepval_orders_o_orderpriority#8330 AS cdepval_orders_o_orderpriority_1#8354, cdepval_orders_o_clerk#8331 AS cdepval_orders_o_clerk_1#8355, cdepval_orders_o_shippriority#8332 AS cdepval_orders_o_shippriority_1#8356, cdepval_orders_o_comment#8333 AS cdepval_orders_o_comment_1#8357, cdepval_orders_o_orderdate#8334 AS cdepval_orders_o_orderdate_1#8358, co_orderstatus#8335 AS co_orderstatus_1#8359, co_totalprice#8336 AS co_totalprice_1#8360, co_orderpriority#8337 AS co_orderpriority_1#8361, co_clerk#8338 AS co_clerk_1#8362, co_shippriority#8339 AS co_shippriority_1#8363, co_comment#8340 AS co_comment_1#8364, co_orderdate#8341 AS co_orderdate_1#8365]
            :  :        +- Relation[rid#8318,cpfk_customer_orders#8319,cfpk_orders_customer#8320,cval_orders_o_orderstatus#8321,cval_orders_o_totalprice#8322,cval_orders_o_orderpriority#8323,cval_orders_o_clerk#8324,cval_orders_o_shippriority#8325,cval_orders_o_comment#8326,cval_orders_o_orderdate#8327,cdepval_orders_o_orderstatus#8328,cdepval_orders_o_totalprice#8329,cdepval_orders_o_orderpriority#8330,cdepval_orders_o_clerk#8331,cdepval_orders_o_shippriority#8332,cdepval_orders_o_comment#8333,cdepval_orders_o_orderdate#8334,co_orderstatus#8335,co_totalprice#8336,co_orderpriority#8337,co_clerk#8338,co_shippriority#8339,co_comment#8340,co_orderdate#8341] JDBCRelation(torders) [numPartitions=1]
            :  +- Project [rid#8504 AS rid_3#8522, cpfk_nation_supplier#8505 AS cpfk_nation_supplier_3#8523, cfpk_supplier_nation#8506 AS cfpk_supplier_nation_3#8524, cval_supplier_s_name#8507 AS cval_supplier_s_name_3#8525, cval_supplier_s_address#8508 AS cval_supplier_s_address_3#8526, cval_supplier_s_phone#8509 AS cval_supplier_s_phone_3#8527, cval_supplier_s_acctbal#8510 AS cval_supplier_s_acctbal_3#8528, cval_supplier_s_comment#8511 AS cval_supplier_s_comment_3#8529, cdepval_supplier_s_name#8512 AS cdepval_supplier_s_name_3#8530, cdepval_supplier_s_address#8513 AS cdepval_supplier_s_address_3#8531, cdepval_supplier_s_phone#8514 AS cdepval_supplier_s_phone_3#8532, cdepval_supplier_s_acctbal#8515 AS cdepval_supplier_s_acctbal_3#8533, cdepval_supplier_s_comment#8516 AS cdepval_supplier_s_comment_3#8534, cs_name#8517 AS cs_name_3#8535, cs_address#8518 AS cs_address_3#8536, cs_phone#8519 AS cs_phone_3#8537, cs_acctbal#8520 AS cs_acctbal_3#8538, cs_comment#8521 AS cs_comment_3#8539]
            :     +- Relation[rid#8504,cpfk_nation_supplier#8505,cfpk_supplier_nation#8506,cval_supplier_s_name#8507,cval_supplier_s_address#8508,cval_supplier_s_phone#8509,cval_supplier_s_acctbal#8510,cval_supplier_s_comment#8511,cdepval_supplier_s_name#8512,cdepval_supplier_s_address#8513,cdepval_supplier_s_phone#8514,cdepval_supplier_s_acctbal#8515,cdepval_supplier_s_comment#8516,cs_name#8517,cs_address#8518,cs_phone#8519,cs_acctbal#8520,cs_comment#8521] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
               +- Project [rid#8540 AS rid_4#8549, cpfk_region_nation#8541 AS cpfk_region_nation_4#8550, cfpk_nation_region#8542 AS cfpk_nation_region_4#8551, cval_nation_n_name#8543 AS cval_nation_n_name_4#8552, cval_nation_n_comment#8544 AS cval_nation_n_comment_4#8553, cdepval_nation_n_name#8545 AS cdepval_nation_n_name_4#8554, cdepval_nation_n_comment#8546 AS cdepval_nation_n_comment_4#8555, cn_name#8547 AS cn_name_4#8556, cn_comment#8548 AS cn_comment_4#8557]
                  +- Relation[rid#8540,cpfk_region_nation#8541,cfpk_nation_region#8542,cval_nation_n_name#8543,cval_nation_n_comment#8544,cdepval_nation_n_name#8545,cdepval_nation_n_comment#8546,cn_name#8547,cn_comment#8548] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 76662ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/25 22:49:03 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:49:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8723L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:49:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8723L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#8775 AS rid_1#8820, cpfk_orders_lineitem#8776 AS cpfk_orders_lineitem_1#8821, cpfk_supplier_lineitem#8777 AS cpfk_supplier_lineitem_1#8822, cfpk_lineitem_supplier#8778 AS cfpk_lineitem_supplier_1#8823, cfpk_lineitem_partsupp#8779 AS cfpk_lineitem_partsupp_1#8824, cpfk_part_lineitem#8780 AS cpfk_part_lineitem_1#8825, cfpk_lineitem_part#8781 AS cfpk_lineitem_part_1#8826, cpfk_partsupp_lineitem#8782 AS cpfk_partsupp_lineitem_1#8827, cfpk_lineitem_orders#8783 AS cfpk_lineitem_orders_1#8828, cval_lineitem_l_quantity#8784 AS cval_lineitem_l_quantity_1#8829, cval_lineitem_l_extendedprice#8785 AS cval_lineitem_l_extendedprice_1#8830, cval_lineitem_l_discount#8786 AS cval_lineitem_l_discount_1#8831, cval_lineitem_l_tax#8787 AS cval_lineitem_l_tax_1#8832, cval_lineitem_l_returnflag#8788 AS cval_lineitem_l_returnflag_1#8833, cval_lineitem_l_linestatus#8789 AS cval_lineitem_l_linestatus_1#8834, cval_lineitem_l_commitdate#8790 AS cval_lineitem_l_commitdate_1#8835, cval_lineitem_l_receiptdate#8791 AS cval_lineitem_l_receiptdate_1#8836, cval_lineitem_l_shipinstruct#8792 AS cval_lineitem_l_shipinstruct_1#8837, cval_lineitem_l_shipmode#8793 AS cval_lineitem_l_shipmode_1#8838, cval_lineitem_l_comment#8794 AS cval_lineitem_l_comment_1#8839, cval_lineitem_l_shipdate#8795 AS cval_lineitem_l_shipdate_1#8840, cdepval_lineitem_l_quantity#8796 AS cdepval_lineitem_l_quantity_1#8841, cdepval_lineitem_l_extendedprice#8797 AS cdepval_lineitem_l_extendedprice_1#8842, cdepval_lineitem_l_discount#8798 AS cdepval_lineitem_l_discount_1#8843, ... 21 more fields]
         :  +- Relation[rid#8775,cpfk_orders_lineitem#8776,cpfk_supplier_lineitem#8777,cfpk_lineitem_supplier#8778,cfpk_lineitem_partsupp#8779,cpfk_part_lineitem#8780,cfpk_lineitem_part#8781,cpfk_partsupp_lineitem#8782,cfpk_lineitem_orders#8783,cval_lineitem_l_quantity#8784,cval_lineitem_l_extendedprice#8785,cval_lineitem_l_discount#8786,cval_lineitem_l_tax#8787,cval_lineitem_l_returnflag#8788,cval_lineitem_l_linestatus#8789,cval_lineitem_l_commitdate#8790,cval_lineitem_l_receiptdate#8791,cval_lineitem_l_shipinstruct#8792,cval_lineitem_l_shipmode#8793,cval_lineitem_l_comment#8794,cval_lineitem_l_shipdate#8795,cdepval_lineitem_l_quantity#8796,cdepval_lineitem_l_extendedprice#8797,cdepval_lineitem_l_discount#8798,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8725 AS rid_0#8750, cval_part_p_name#8726 AS cval_part_p_name_0#8751, cval_part_p_mfgr#8727 AS cval_part_p_mfgr_0#8752, cval_part_p_type#8728 AS cval_part_p_type_0#8753, cval_part_p_size#8729 AS cval_part_p_size_0#8754, cval_part_p_container#8730 AS cval_part_p_container_0#8755, cval_part_p_retailprice#8731 AS cval_part_p_retailprice_0#8756, cval_part_p_comment#8732 AS cval_part_p_comment_0#8757, cval_part_p_brand#8733 AS cval_part_p_brand_0#8758, cdepval_part_p_name#8734 AS cdepval_part_p_name_0#8759, cdepval_part_p_mfgr#8735 AS cdepval_part_p_mfgr_0#8760, cdepval_part_p_type#8736 AS cdepval_part_p_type_0#8761, cdepval_part_p_size#8737 AS cdepval_part_p_size_0#8762, cdepval_part_p_container#8738 AS cdepval_part_p_container_0#8763, cdepval_part_p_retailprice#8739 AS cdepval_part_p_retailprice_0#8764, cdepval_part_p_comment#8740 AS cdepval_part_p_comment_0#8765, cdepval_part_p_brand#8741 AS cdepval_part_p_brand_0#8766, cp_name#8742 AS cp_name_0#8767, cp_mfgr#8743 AS cp_mfgr_0#8768, cp_type#8744 AS cp_type_0#8769, cp_size#8745 AS cp_size_0#8770, cp_container#8746 AS cp_container_0#8771, cp_retailprice#8747 AS cp_retailprice_0#8772, cp_comment#8748 AS cp_comment_0#8773, cp_brand#8749 AS cp_brand_0#8774]
            +- Relation[rid#8725,cval_part_p_name#8726,cval_part_p_mfgr#8727,cval_part_p_type#8728,cval_part_p_size#8729,cval_part_p_container#8730,cval_part_p_retailprice#8731,cval_part_p_comment#8732,cval_part_p_brand#8733,cdepval_part_p_name#8734,cdepval_part_p_mfgr#8735,cdepval_part_p_type#8736,cdepval_part_p_size#8737,cdepval_part_p_container#8738,cdepval_part_p_retailprice#8739,cdepval_part_p_comment#8740,cdepval_part_p_brand#8741,cp_name#8742,cp_mfgr#8743,cp_type#8744,cp_size#8745,cp_container#8746,cp_retailprice#8747,cp_comment#8748,cp_brand#8749] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17776ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/25 22:49:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:49:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8942L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:49:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:49:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:49:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8942L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#8980 AS rid_1#9025, cpfk_orders_lineitem#8981 AS cpfk_orders_lineitem_1#9026, cpfk_supplier_lineitem#8982 AS cpfk_supplier_lineitem_1#9027, cfpk_lineitem_supplier#8983 AS cfpk_lineitem_supplier_1#9028, cfpk_lineitem_partsupp#8984 AS cfpk_lineitem_partsupp_1#9029, cpfk_part_lineitem#8985 AS cpfk_part_lineitem_1#9030, cfpk_lineitem_part#8986 AS cfpk_lineitem_part_1#9031, cpfk_partsupp_lineitem#8987 AS cpfk_partsupp_lineitem_1#9032, cfpk_lineitem_orders#8988 AS cfpk_lineitem_orders_1#9033, cval_lineitem_l_quantity#8989 AS cval_lineitem_l_quantity_1#9034, cval_lineitem_l_extendedprice#8990 AS cval_lineitem_l_extendedprice_1#9035, cval_lineitem_l_discount#8991 AS cval_lineitem_l_discount_1#9036, cval_lineitem_l_tax#8992 AS cval_lineitem_l_tax_1#9037, cval_lineitem_l_returnflag#8993 AS cval_lineitem_l_returnflag_1#9038, cval_lineitem_l_linestatus#8994 AS cval_lineitem_l_linestatus_1#9039, cval_lineitem_l_commitdate#8995 AS cval_lineitem_l_commitdate_1#9040, cval_lineitem_l_receiptdate#8996 AS cval_lineitem_l_receiptdate_1#9041, cval_lineitem_l_shipinstruct#8997 AS cval_lineitem_l_shipinstruct_1#9042, cval_lineitem_l_shipmode#8998 AS cval_lineitem_l_shipmode_1#9043, cval_lineitem_l_comment#8999 AS cval_lineitem_l_comment_1#9044, cval_lineitem_l_shipdate#9000 AS cval_lineitem_l_shipdate_1#9045, cdepval_lineitem_l_quantity#9001 AS cdepval_lineitem_l_quantity_1#9046, cdepval_lineitem_l_extendedprice#9002 AS cdepval_lineitem_l_extendedprice_1#9047, cdepval_lineitem_l_discount#9003 AS cdepval_lineitem_l_discount_1#9048, ... 21 more fields]
         :  +- Relation[rid#8980,cpfk_orders_lineitem#8981,cpfk_supplier_lineitem#8982,cfpk_lineitem_supplier#8983,cfpk_lineitem_partsupp#8984,cpfk_part_lineitem#8985,cfpk_lineitem_part#8986,cpfk_partsupp_lineitem#8987,cfpk_lineitem_orders#8988,cval_lineitem_l_quantity#8989,cval_lineitem_l_extendedprice#8990,cval_lineitem_l_discount#8991,cval_lineitem_l_tax#8992,cval_lineitem_l_returnflag#8993,cval_lineitem_l_linestatus#8994,cval_lineitem_l_commitdate#8995,cval_lineitem_l_receiptdate#8996,cval_lineitem_l_shipinstruct#8997,cval_lineitem_l_shipmode#8998,cval_lineitem_l_comment#8999,cval_lineitem_l_shipdate#9000,cdepval_lineitem_l_quantity#9001,cdepval_lineitem_l_extendedprice#9002,cdepval_lineitem_l_discount#9003,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8944 AS rid_0#8962, cpfk_nation_supplier#8945 AS cpfk_nation_supplier_0#8963, cfpk_supplier_nation#8946 AS cfpk_supplier_nation_0#8964, cval_supplier_s_name#8947 AS cval_supplier_s_name_0#8965, cval_supplier_s_address#8948 AS cval_supplier_s_address_0#8966, cval_supplier_s_phone#8949 AS cval_supplier_s_phone_0#8967, cval_supplier_s_acctbal#8950 AS cval_supplier_s_acctbal_0#8968, cval_supplier_s_comment#8951 AS cval_supplier_s_comment_0#8969, cdepval_supplier_s_name#8952 AS cdepval_supplier_s_name_0#8970, cdepval_supplier_s_address#8953 AS cdepval_supplier_s_address_0#8971, cdepval_supplier_s_phone#8954 AS cdepval_supplier_s_phone_0#8972, cdepval_supplier_s_acctbal#8955 AS cdepval_supplier_s_acctbal_0#8973, cdepval_supplier_s_comment#8956 AS cdepval_supplier_s_comment_0#8974, cs_name#8957 AS cs_name_0#8975, cs_address#8958 AS cs_address_0#8976, cs_phone#8959 AS cs_phone_0#8977, cs_acctbal#8960 AS cs_acctbal_0#8978, cs_comment#8961 AS cs_comment_0#8979]
            +- Relation[rid#8944,cpfk_nation_supplier#8945,cfpk_supplier_nation#8946,cval_supplier_s_name#8947,cval_supplier_s_address#8948,cval_supplier_s_phone#8949,cval_supplier_s_acctbal#8950,cval_supplier_s_comment#8951,cdepval_supplier_s_name#8952,cdepval_supplier_s_address#8953,cdepval_supplier_s_phone#8954,cdepval_supplier_s_acctbal#8955,cdepval_supplier_s_comment#8956,cs_name#8957,cs_address#8958,cs_phone#8959,cs_acctbal#8960,cs_comment#8961] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17146ms
query=q1, count=6001215, duration=2431
query=q10, count=1478870, duration=60641
query=q11, count=31680, duration=3456
query=q12, count=857401, duration=22553
query=q13, count=1500000, duration=4526
query=q14, count=6001215, duration=17776
query=q15, count=6001215, duration=17146
query=q16, count=15780, duration=3348
query=q17, count=6088, duration=25981
query=q18, count=6001215, duration=22322
query=q19, count=205, duration=16441
query=q2, count=3162, duration=3755
query=q20, count=632, duration=3660
query=q21a, count=597422, duration=76662
query=q22, count=1500000, duration=4873
query=q3, count=1214743, duration=38655
query=q4, count=6001215, duration=18255
query=q5, count=48089, duration=30610
query=q6, count=6001215, duration=2348
query=q7, count=9735, duration=34913
query=q8, count=8716, duration=44918
query=q9a, count=6001215, duration=64038
query=q9b, count=6001215, duration=37962
