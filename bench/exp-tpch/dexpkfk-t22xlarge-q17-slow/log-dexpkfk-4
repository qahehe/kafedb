20/04/25 22:21:05 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10787ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 25 22:21:08 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 25 22:21:09 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 25 22:21:09 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 25 22:21:09 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 25 22:21:10 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 25 22:21:14 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 25 22:21:17 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 25 22:21:17 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/25 22:21:19 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:21:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2078L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 22:21:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2078L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#2080 AS rid_0#2104, cpfk_customer_orders#2081 AS cpfk_customer_orders_0#2105, cfpk_orders_customer#2082 AS cfpk_orders_customer_0#2106, cval_orders_o_orderstatus#2083 AS cval_orders_o_orderstatus_0#2107, cval_orders_o_totalprice#2084 AS cval_orders_o_totalprice_0#2108, cval_orders_o_orderpriority#2085 AS cval_orders_o_orderpriority_0#2109, cval_orders_o_clerk#2086 AS cval_orders_o_clerk_0#2110, cval_orders_o_shippriority#2087 AS cval_orders_o_shippriority_0#2111, cval_orders_o_comment#2088 AS cval_orders_o_comment_0#2112, cval_orders_o_orderdate#2089 AS cval_orders_o_orderdate_0#2113, cdepval_orders_o_orderstatus#2090 AS cdepval_orders_o_orderstatus_0#2114, cdepval_orders_o_totalprice#2091 AS cdepval_orders_o_totalprice_0#2115, cdepval_orders_o_orderpriority#2092 AS cdepval_orders_o_orderpriority_0#2116, cdepval_orders_o_clerk#2093 AS cdepval_orders_o_clerk_0#2117, cdepval_orders_o_shippriority#2094 AS cdepval_orders_o_shippriority_0#2118, cdepval_orders_o_comment#2095 AS cdepval_orders_o_comment_0#2119, cdepval_orders_o_orderdate#2096 AS cdepval_orders_o_orderdate_0#2120, co_orderstatus#2097 AS co_orderstatus_0#2121, co_totalprice#2098 AS co_totalprice_0#2122, co_orderpriority#2099 AS co_orderpriority_0#2123, co_clerk#2100 AS co_clerk_0#2124, co_shippriority#2101 AS co_shippriority_0#2125, co_comment#2102 AS co_comment_0#2126, co_orderdate#2103 AS co_orderdate_0#2127]
         :  +- Relation[rid#2080,cpfk_customer_orders#2081,cfpk_orders_customer#2082,cval_orders_o_orderstatus#2083,cval_orders_o_totalprice#2084,cval_orders_o_orderpriority#2085,cval_orders_o_clerk#2086,cval_orders_o_shippriority#2087,cval_orders_o_comment#2088,cval_orders_o_orderdate#2089,cdepval_orders_o_orderstatus#2090,cdepval_orders_o_totalprice#2091,cdepval_orders_o_orderpriority#2092,cdepval_orders_o_clerk#2093,cdepval_orders_o_shippriority#2094,cdepval_orders_o_comment#2095,cdepval_orders_o_orderdate#2096,co_orderstatus#2097,co_totalprice#2098,co_orderpriority#2099,co_clerk#2100,co_shippriority#2101,co_comment#2102,co_orderdate#2103] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#2128 AS rid_1#2149, cpfk_nation_customer#2129 AS cpfk_nation_customer_1#2150, cfpk_customer_nation#2130 AS cfpk_customer_nation_1#2151, cval_customer_c_name#2131 AS cval_customer_c_name_1#2152, cval_customer_c_address#2132 AS cval_customer_c_address_1#2153, cval_customer_c_phone#2133 AS cval_customer_c_phone_1#2154, cval_customer_c_acctbal#2134 AS cval_customer_c_acctbal_1#2155, cval_customer_c_comment#2135 AS cval_customer_c_comment_1#2156, cval_customer_c_mktsegment#2136 AS cval_customer_c_mktsegment_1#2157, cdepval_customer_c_name#2137 AS cdepval_customer_c_name_1#2158, cdepval_customer_c_address#2138 AS cdepval_customer_c_address_1#2159, cdepval_customer_c_phone#2139 AS cdepval_customer_c_phone_1#2160, cdepval_customer_c_acctbal#2140 AS cdepval_customer_c_acctbal_1#2161, cdepval_customer_c_comment#2141 AS cdepval_customer_c_comment_1#2162, cdepval_customer_c_mktsegment#2142 AS cdepval_customer_c_mktsegment_1#2163, cc_name#2143 AS cc_name_1#2164, cc_address#2144 AS cc_address_1#2165, cc_phone#2145 AS cc_phone_1#2166, cc_acctbal#2146 AS cc_acctbal_1#2167, cc_comment#2147 AS cc_comment_1#2168, cc_mktsegment#2148 AS cc_mktsegment_1#2169]
            +- Relation[rid#2128,cpfk_nation_customer#2129,cfpk_customer_nation#2130,cval_customer_c_name#2131,cval_customer_c_address#2132,cval_customer_c_phone#2133,cval_customer_c_acctbal#2134,cval_customer_c_comment#2135,cval_customer_c_mktsegment#2136,cdepval_customer_c_name#2137,cdepval_customer_c_address#2138,cdepval_customer_c_phone#2139,cdepval_customer_c_acctbal#2140,cdepval_customer_c_comment#2141,cdepval_customer_c_mktsegment#2142,cc_name#2143,cc_address#2144,cc_phone#2145,cc_acctbal#2146,cc_comment#2147,cc_mktsegment#2148] JDBCRelation(tcustomer) [numPartitions=1]

20/04/25 22:21:19 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexPkFk$ result size=1500000
Elapsed time: 4850ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/25 22:21:24 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:21:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2223L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:21:24 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:21:24 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:21:24 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:21:24 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:21:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2223L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#2357 AS rid_2#2402, cpfk_orders_lineitem#2358 AS cpfk_orders_lineitem_2#2403, cpfk_supplier_lineitem#2359 AS cpfk_supplier_lineitem_2#2404, cfpk_lineitem_supplier#2360 AS cfpk_lineitem_supplier_2#2405, cfpk_lineitem_partsupp#2361 AS cfpk_lineitem_partsupp_2#2406, cpfk_part_lineitem#2362 AS cpfk_part_lineitem_2#2407, cfpk_lineitem_part#2363 AS cfpk_lineitem_part_2#2408, cpfk_partsupp_lineitem#2364 AS cpfk_partsupp_lineitem_2#2409, cfpk_lineitem_orders#2365 AS cfpk_lineitem_orders_2#2410, cval_lineitem_l_quantity#2366 AS cval_lineitem_l_quantity_2#2411, cval_lineitem_l_extendedprice#2367 AS cval_lineitem_l_extendedprice_2#2412, cval_lineitem_l_discount#2368 AS cval_lineitem_l_discount_2#2413, cval_lineitem_l_tax#2369 AS cval_lineitem_l_tax_2#2414, cval_lineitem_l_returnflag#2370 AS cval_lineitem_l_returnflag_2#2415, cval_lineitem_l_linestatus#2371 AS cval_lineitem_l_linestatus_2#2416, cval_lineitem_l_commitdate#2372 AS cval_lineitem_l_commitdate_2#2417, cval_lineitem_l_receiptdate#2373 AS cval_lineitem_l_receiptdate_2#2418, cval_lineitem_l_shipinstruct#2374 AS cval_lineitem_l_shipinstruct_2#2419, cval_lineitem_l_shipmode#2375 AS cval_lineitem_l_shipmode_2#2420, cval_lineitem_l_comment#2376 AS cval_lineitem_l_comment_2#2421, cval_lineitem_l_shipdate#2377 AS cval_lineitem_l_shipdate_2#2422, cdepval_lineitem_l_quantity#2378 AS cdepval_lineitem_l_quantity_2#2423, cdepval_lineitem_l_extendedprice#2379 AS cdepval_lineitem_l_extendedprice_2#2424, cdepval_lineitem_l_discount#2380 AS cdepval_lineitem_l_discount_2#2425, ... 21 more fields]
         :  +- Relation[rid#2357,cpfk_orders_lineitem#2358,cpfk_supplier_lineitem#2359,cfpk_lineitem_supplier#2360,cfpk_lineitem_partsupp#2361,cpfk_part_lineitem#2362,cfpk_lineitem_part#2363,cpfk_partsupp_lineitem#2364,cfpk_lineitem_orders#2365,cval_lineitem_l_quantity#2366,cval_lineitem_l_extendedprice#2367,cval_lineitem_l_discount#2368,cval_lineitem_l_tax#2369,cval_lineitem_l_returnflag#2370,cval_lineitem_l_linestatus#2371,cval_lineitem_l_commitdate#2372,cval_lineitem_l_receiptdate#2373,cval_lineitem_l_shipinstruct#2374,cval_lineitem_l_shipmode#2375,cval_lineitem_l_comment#2376,cval_lineitem_l_shipdate#2377,cdepval_lineitem_l_quantity#2378,cdepval_lineitem_l_extendedprice#2379,cdepval_lineitem_l_discount#2380,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#2309 AS rid_1#2333, cpfk_customer_orders#2310 AS cpfk_customer_orders_1#2334, cfpk_orders_customer#2311 AS cfpk_orders_customer_1#2335, cval_orders_o_orderstatus#2312 AS cval_orders_o_orderstatus_1#2336, cval_orders_o_totalprice#2313 AS cval_orders_o_totalprice_1#2337, cval_orders_o_orderpriority#2314 AS cval_orders_o_orderpriority_1#2338, cval_orders_o_clerk#2315 AS cval_orders_o_clerk_1#2339, cval_orders_o_shippriority#2316 AS cval_orders_o_shippriority_1#2340, cval_orders_o_comment#2317 AS cval_orders_o_comment_1#2341, cval_orders_o_orderdate#2318 AS cval_orders_o_orderdate_1#2342, cdepval_orders_o_orderstatus#2319 AS cdepval_orders_o_orderstatus_1#2343, cdepval_orders_o_totalprice#2320 AS cdepval_orders_o_totalprice_1#2344, cdepval_orders_o_orderpriority#2321 AS cdepval_orders_o_orderpriority_1#2345, cdepval_orders_o_clerk#2322 AS cdepval_orders_o_clerk_1#2346, cdepval_orders_o_shippriority#2323 AS cdepval_orders_o_shippriority_1#2347, cdepval_orders_o_comment#2324 AS cdepval_orders_o_comment_1#2348, cdepval_orders_o_orderdate#2325 AS cdepval_orders_o_orderdate_1#2349, co_orderstatus#2326 AS co_orderstatus_1#2350, co_totalprice#2327 AS co_totalprice_1#2351, co_orderpriority#2328 AS co_orderpriority_1#2352, co_clerk#2329 AS co_clerk_1#2353, co_shippriority#2330 AS co_shippriority_1#2354, co_comment#2331 AS co_comment_1#2355, co_orderdate#2332 AS co_orderdate_1#2356]
            :  +- Relation[rid#2309,cpfk_customer_orders#2310,cfpk_orders_customer#2311,cval_orders_o_orderstatus#2312,cval_orders_o_totalprice#2313,cval_orders_o_orderpriority#2314,cval_orders_o_clerk#2315,cval_orders_o_shippriority#2316,cval_orders_o_comment#2317,cval_orders_o_orderdate#2318,cdepval_orders_o_orderstatus#2319,cdepval_orders_o_totalprice#2320,cdepval_orders_o_orderpriority#2321,cdepval_orders_o_clerk#2322,cdepval_orders_o_shippriority#2323,cdepval_orders_o_comment#2324,cdepval_orders_o_orderdate#2325,co_orderstatus#2326,co_totalprice#2327,co_orderpriority#2328,co_clerk#2329,co_shippriority#2330,co_comment#2331,co_orderdate#2332] JDBCRelation(torders) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
               +- Project [rid#2225 AS rid_0#2246, cpfk_nation_customer#2226 AS cpfk_nation_customer_0#2247, cfpk_customer_nation#2227 AS cfpk_customer_nation_0#2248, cval_customer_c_name#2228 AS cval_customer_c_name_0#2249, cval_customer_c_address#2229 AS cval_customer_c_address_0#2250, cval_customer_c_phone#2230 AS cval_customer_c_phone_0#2251, cval_customer_c_acctbal#2231 AS cval_customer_c_acctbal_0#2252, cval_customer_c_comment#2232 AS cval_customer_c_comment_0#2253, cval_customer_c_mktsegment#2233 AS cval_customer_c_mktsegment_0#2254, cdepval_customer_c_name#2234 AS cdepval_customer_c_name_0#2255, cdepval_customer_c_address#2235 AS cdepval_customer_c_address_0#2256, cdepval_customer_c_phone#2236 AS cdepval_customer_c_phone_0#2257, cdepval_customer_c_acctbal#2237 AS cdepval_customer_c_acctbal_0#2258, cdepval_customer_c_comment#2238 AS cdepval_customer_c_comment_0#2259, cdepval_customer_c_mktsegment#2239 AS cdepval_customer_c_mktsegment_0#2260, cc_name#2240 AS cc_name_0#2261, cc_address#2241 AS cc_address_0#2262, cc_phone#2242 AS cc_phone_0#2263, cc_acctbal#2243 AS cc_acctbal_0#2264, cc_comment#2244 AS cc_comment_0#2265, cc_mktsegment#2245 AS cc_mktsegment_0#2266]
                  +- Relation[rid#2225,cpfk_nation_customer#2226,cfpk_customer_nation#2227,cval_customer_c_name#2228,cval_customer_c_address#2229,cval_customer_c_phone#2230,cval_customer_c_acctbal#2231,cval_customer_c_comment#2232,cval_customer_c_mktsegment#2233,cdepval_customer_c_name#2234,cdepval_customer_c_address#2235,cdepval_customer_c_phone#2236,cdepval_customer_c_acctbal#2237,cdepval_customer_c_comment#2238,cdepval_customer_c_mktsegment#2239,cc_name#2240,cc_address#2241,cc_phone#2242,cc_acctbal#2243,cc_comment#2244,cc_mktsegment#2245] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 38730ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/25 22:22:03 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:22:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2541L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:22:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2541L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#2543 AS rid_0#2588, cpfk_orders_lineitem#2544 AS cpfk_orders_lineitem_0#2589, cpfk_supplier_lineitem#2545 AS cpfk_supplier_lineitem_0#2590, cfpk_lineitem_supplier#2546 AS cfpk_lineitem_supplier_0#2591, cfpk_lineitem_partsupp#2547 AS cfpk_lineitem_partsupp_0#2592, cpfk_part_lineitem#2548 AS cpfk_part_lineitem_0#2593, cfpk_lineitem_part#2549 AS cfpk_lineitem_part_0#2594, cpfk_partsupp_lineitem#2550 AS cpfk_partsupp_lineitem_0#2595, cfpk_lineitem_orders#2551 AS cfpk_lineitem_orders_0#2596, cval_lineitem_l_quantity#2552 AS cval_lineitem_l_quantity_0#2597, cval_lineitem_l_extendedprice#2553 AS cval_lineitem_l_extendedprice_0#2598, cval_lineitem_l_discount#2554 AS cval_lineitem_l_discount_0#2599, cval_lineitem_l_tax#2555 AS cval_lineitem_l_tax_0#2600, cval_lineitem_l_returnflag#2556 AS cval_lineitem_l_returnflag_0#2601, cval_lineitem_l_linestatus#2557 AS cval_lineitem_l_linestatus_0#2602, cval_lineitem_l_commitdate#2558 AS cval_lineitem_l_commitdate_0#2603, cval_lineitem_l_receiptdate#2559 AS cval_lineitem_l_receiptdate_0#2604, cval_lineitem_l_shipinstruct#2560 AS cval_lineitem_l_shipinstruct_0#2605, cval_lineitem_l_shipmode#2561 AS cval_lineitem_l_shipmode_0#2606, cval_lineitem_l_comment#2562 AS cval_lineitem_l_comment_0#2607, cval_lineitem_l_shipdate#2563 AS cval_lineitem_l_shipdate_0#2608, cdepval_lineitem_l_quantity#2564 AS cdepval_lineitem_l_quantity_0#2609, cdepval_lineitem_l_extendedprice#2565 AS cdepval_lineitem_l_extendedprice_0#2610, cdepval_lineitem_l_discount#2566 AS cdepval_lineitem_l_discount_0#2611, ... 21 more fields]
         :     +- Relation[rid#2543,cpfk_orders_lineitem#2544,cpfk_supplier_lineitem#2545,cfpk_lineitem_supplier#2546,cfpk_lineitem_partsupp#2547,cpfk_part_lineitem#2548,cfpk_lineitem_part#2549,cpfk_partsupp_lineitem#2550,cfpk_lineitem_orders#2551,cval_lineitem_l_quantity#2552,cval_lineitem_l_extendedprice#2553,cval_lineitem_l_discount#2554,cval_lineitem_l_tax#2555,cval_lineitem_l_returnflag#2556,cval_lineitem_l_linestatus#2557,cval_lineitem_l_commitdate#2558,cval_lineitem_l_receiptdate#2559,cval_lineitem_l_shipinstruct#2560,cval_lineitem_l_shipmode#2561,cval_lineitem_l_comment#2562,cval_lineitem_l_shipdate#2563,cdepval_lineitem_l_quantity#2564,cdepval_lineitem_l_extendedprice#2565,cdepval_lineitem_l_discount#2566,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2723 AS rid_1#2747, cpfk_customer_orders#2724 AS cpfk_customer_orders_1#2748, cfpk_orders_customer#2725 AS cfpk_orders_customer_1#2749, cval_orders_o_orderstatus#2726 AS cval_orders_o_orderstatus_1#2750, cval_orders_o_totalprice#2727 AS cval_orders_o_totalprice_1#2751, cval_orders_o_orderpriority#2728 AS cval_orders_o_orderpriority_1#2752, cval_orders_o_clerk#2729 AS cval_orders_o_clerk_1#2753, cval_orders_o_shippriority#2730 AS cval_orders_o_shippriority_1#2754, cval_orders_o_comment#2731 AS cval_orders_o_comment_1#2755, cval_orders_o_orderdate#2732 AS cval_orders_o_orderdate_1#2756, cdepval_orders_o_orderstatus#2733 AS cdepval_orders_o_orderstatus_1#2757, cdepval_orders_o_totalprice#2734 AS cdepval_orders_o_totalprice_1#2758, cdepval_orders_o_orderpriority#2735 AS cdepval_orders_o_orderpriority_1#2759, cdepval_orders_o_clerk#2736 AS cdepval_orders_o_clerk_1#2760, cdepval_orders_o_shippriority#2737 AS cdepval_orders_o_shippriority_1#2761, cdepval_orders_o_comment#2738 AS cdepval_orders_o_comment_1#2762, cdepval_orders_o_orderdate#2739 AS cdepval_orders_o_orderdate_1#2763, co_orderstatus#2740 AS co_orderstatus_1#2764, co_totalprice#2741 AS co_totalprice_1#2765, co_orderpriority#2742 AS co_orderpriority_1#2766, co_clerk#2743 AS co_clerk_1#2767, co_shippriority#2744 AS co_shippriority_1#2768, co_comment#2745 AS co_comment_1#2769, co_orderdate#2746 AS co_orderdate_1#2770]
            +- Relation[rid#2723,cpfk_customer_orders#2724,cfpk_orders_customer#2725,cval_orders_o_orderstatus#2726,cval_orders_o_totalprice#2727,cval_orders_o_orderpriority#2728,cval_orders_o_clerk#2729,cval_orders_o_shippriority#2730,cval_orders_o_comment#2731,cval_orders_o_orderdate#2732,cdepval_orders_o_orderstatus#2733,cdepval_orders_o_totalprice#2734,cdepval_orders_o_orderpriority#2735,cdepval_orders_o_clerk#2736,cdepval_orders_o_shippriority#2737,cdepval_orders_o_comment#2738,cdepval_orders_o_orderdate#2739,co_orderstatus#2740,co_totalprice#2741,co_orderpriority#2742,co_clerk#2743,co_shippriority#2744,co_comment#2745,co_orderdate#2746] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 19953ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/25 22:22:22 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:22:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2868L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:22:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2868L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#2870 AS rid_0#2915, cpfk_orders_lineitem#2871 AS cpfk_orders_lineitem_0#2916, cpfk_supplier_lineitem#2872 AS cpfk_supplier_lineitem_0#2917, cfpk_lineitem_supplier#2873 AS cfpk_lineitem_supplier_0#2918, cfpk_lineitem_partsupp#2874 AS cfpk_lineitem_partsupp_0#2919, cpfk_part_lineitem#2875 AS cpfk_part_lineitem_0#2920, cfpk_lineitem_part#2876 AS cfpk_lineitem_part_0#2921, cpfk_partsupp_lineitem#2877 AS cpfk_partsupp_lineitem_0#2922, cfpk_lineitem_orders#2878 AS cfpk_lineitem_orders_0#2923, cval_lineitem_l_quantity#2879 AS cval_lineitem_l_quantity_0#2924, cval_lineitem_l_extendedprice#2880 AS cval_lineitem_l_extendedprice_0#2925, cval_lineitem_l_discount#2881 AS cval_lineitem_l_discount_0#2926, cval_lineitem_l_tax#2882 AS cval_lineitem_l_tax_0#2927, cval_lineitem_l_returnflag#2883 AS cval_lineitem_l_returnflag_0#2928, cval_lineitem_l_linestatus#2884 AS cval_lineitem_l_linestatus_0#2929, cval_lineitem_l_commitdate#2885 AS cval_lineitem_l_commitdate_0#2930, cval_lineitem_l_receiptdate#2886 AS cval_lineitem_l_receiptdate_0#2931, cval_lineitem_l_shipinstruct#2887 AS cval_lineitem_l_shipinstruct_0#2932, cval_lineitem_l_shipmode#2888 AS cval_lineitem_l_shipmode_0#2933, cval_lineitem_l_comment#2889 AS cval_lineitem_l_comment_0#2934, cval_lineitem_l_shipdate#2890 AS cval_lineitem_l_shipdate_0#2935, cdepval_lineitem_l_quantity#2891 AS cdepval_lineitem_l_quantity_0#2936, cdepval_lineitem_l_extendedprice#2892 AS cdepval_lineitem_l_extendedprice_0#2937, cdepval_lineitem_l_discount#2893 AS cdepval_lineitem_l_discount_0#2938, ... 21 more fields]
         :  +- Relation[rid#2870,cpfk_orders_lineitem#2871,cpfk_supplier_lineitem#2872,cfpk_lineitem_supplier#2873,cfpk_lineitem_partsupp#2874,cpfk_part_lineitem#2875,cfpk_lineitem_part#2876,cpfk_partsupp_lineitem#2877,cfpk_lineitem_orders#2878,cval_lineitem_l_quantity#2879,cval_lineitem_l_extendedprice#2880,cval_lineitem_l_discount#2881,cval_lineitem_l_tax#2882,cval_lineitem_l_returnflag#2883,cval_lineitem_l_linestatus#2884,cval_lineitem_l_commitdate#2885,cval_lineitem_l_receiptdate#2886,cval_lineitem_l_shipinstruct#2887,cval_lineitem_l_shipmode#2888,cval_lineitem_l_comment#2889,cval_lineitem_l_shipdate#2890,cdepval_lineitem_l_quantity#2891,cdepval_lineitem_l_extendedprice#2892,cdepval_lineitem_l_discount#2893,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2960 AS rid_1#2984, cpfk_customer_orders#2961 AS cpfk_customer_orders_1#2985, cfpk_orders_customer#2962 AS cfpk_orders_customer_1#2986, cval_orders_o_orderstatus#2963 AS cval_orders_o_orderstatus_1#2987, cval_orders_o_totalprice#2964 AS cval_orders_o_totalprice_1#2988, cval_orders_o_orderpriority#2965 AS cval_orders_o_orderpriority_1#2989, cval_orders_o_clerk#2966 AS cval_orders_o_clerk_1#2990, cval_orders_o_shippriority#2967 AS cval_orders_o_shippriority_1#2991, cval_orders_o_comment#2968 AS cval_orders_o_comment_1#2992, cval_orders_o_orderdate#2969 AS cval_orders_o_orderdate_1#2993, cdepval_orders_o_orderstatus#2970 AS cdepval_orders_o_orderstatus_1#2994, cdepval_orders_o_totalprice#2971 AS cdepval_orders_o_totalprice_1#2995, cdepval_orders_o_orderpriority#2972 AS cdepval_orders_o_orderpriority_1#2996, cdepval_orders_o_clerk#2973 AS cdepval_orders_o_clerk_1#2997, cdepval_orders_o_shippriority#2974 AS cdepval_orders_o_shippriority_1#2998, cdepval_orders_o_comment#2975 AS cdepval_orders_o_comment_1#2999, cdepval_orders_o_orderdate#2976 AS cdepval_orders_o_orderdate_1#3000, co_orderstatus#2977 AS co_orderstatus_1#3001, co_totalprice#2978 AS co_totalprice_1#3002, co_orderpriority#2979 AS co_orderpriority_1#3003, co_clerk#2980 AS co_clerk_1#3004, co_shippriority#2981 AS co_shippriority_1#3005, co_comment#2982 AS co_comment_1#3006, co_orderdate#2983 AS co_orderdate_1#3007]
            +- Relation[rid#2960,cpfk_customer_orders#2961,cfpk_orders_customer#2962,cval_orders_o_orderstatus#2963,cval_orders_o_totalprice#2964,cval_orders_o_orderpriority#2965,cval_orders_o_clerk#2966,cval_orders_o_shippriority#2967,cval_orders_o_comment#2968,cval_orders_o_orderdate#2969,cdepval_orders_o_orderstatus#2970,cdepval_orders_o_totalprice#2971,cdepval_orders_o_orderpriority#2972,cdepval_orders_o_clerk#2973,cdepval_orders_o_shippriority#2974,cdepval_orders_o_comment#2975,cdepval_orders_o_orderdate#2976,co_orderstatus#2977,co_totalprice#2978,co_orderpriority#2979,co_clerk#2980,co_shippriority#2981,co_comment#2982,co_orderdate#2983] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18343ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/25 22:22:41 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:22:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3081L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 22:22:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:22:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:22:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:22:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:22:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:22:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:22:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:22:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3081L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#3083 AS rid_0#3128, cpfk_orders_lineitem#3084 AS cpfk_orders_lineitem_0#3129, cpfk_supplier_lineitem#3085 AS cpfk_supplier_lineitem_0#3130, cfpk_lineitem_supplier#3086 AS cfpk_lineitem_supplier_0#3131, cfpk_lineitem_partsupp#3087 AS cfpk_lineitem_partsupp_0#3132, cpfk_part_lineitem#3088 AS cpfk_part_lineitem_0#3133, cfpk_lineitem_part#3089 AS cfpk_lineitem_part_0#3134, cpfk_partsupp_lineitem#3090 AS cpfk_partsupp_lineitem_0#3135, cfpk_lineitem_orders#3091 AS cfpk_lineitem_orders_0#3136, cval_lineitem_l_quantity#3092 AS cval_lineitem_l_quantity_0#3137, cval_lineitem_l_extendedprice#3093 AS cval_lineitem_l_extendedprice_0#3138, cval_lineitem_l_discount#3094 AS cval_lineitem_l_discount_0#3139, cval_lineitem_l_tax#3095 AS cval_lineitem_l_tax_0#3140, cval_lineitem_l_returnflag#3096 AS cval_lineitem_l_returnflag_0#3141, cval_lineitem_l_linestatus#3097 AS cval_lineitem_l_linestatus_0#3142, cval_lineitem_l_commitdate#3098 AS cval_lineitem_l_commitdate_0#3143, cval_lineitem_l_receiptdate#3099 AS cval_lineitem_l_receiptdate_0#3144, cval_lineitem_l_shipinstruct#3100 AS cval_lineitem_l_shipinstruct_0#3145, cval_lineitem_l_shipmode#3101 AS cval_lineitem_l_shipmode_0#3146, cval_lineitem_l_comment#3102 AS cval_lineitem_l_comment_0#3147, cval_lineitem_l_shipdate#3103 AS cval_lineitem_l_shipdate_0#3148, cdepval_lineitem_l_quantity#3104 AS cdepval_lineitem_l_quantity_0#3149, cdepval_lineitem_l_extendedprice#3105 AS cdepval_lineitem_l_extendedprice_0#3150, cdepval_lineitem_l_discount#3106 AS cdepval_lineitem_l_discount_0#3151, ... 21 more fields]
         :  +- Relation[rid#3083,cpfk_orders_lineitem#3084,cpfk_supplier_lineitem#3085,cfpk_lineitem_supplier#3086,cfpk_lineitem_partsupp#3087,cpfk_part_lineitem#3088,cfpk_lineitem_part#3089,cpfk_partsupp_lineitem#3090,cfpk_lineitem_orders#3091,cval_lineitem_l_quantity#3092,cval_lineitem_l_extendedprice#3093,cval_lineitem_l_discount#3094,cval_lineitem_l_tax#3095,cval_lineitem_l_returnflag#3096,cval_lineitem_l_linestatus#3097,cval_lineitem_l_commitdate#3098,cval_lineitem_l_receiptdate#3099,cval_lineitem_l_shipinstruct#3100,cval_lineitem_l_shipmode#3101,cval_lineitem_l_comment#3102,cval_lineitem_l_shipdate#3103,cdepval_lineitem_l_quantity#3104,cdepval_lineitem_l_extendedprice#3105,cdepval_lineitem_l_discount#3106,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
            :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
            :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
            :  :  :- Project [rid#3269 AS rid_2#3314, cpfk_orders_lineitem#3270 AS cpfk_orders_lineitem_2#3315, cpfk_supplier_lineitem#3271 AS cpfk_supplier_lineitem_2#3316, cfpk_lineitem_supplier#3272 AS cfpk_lineitem_supplier_2#3317, cfpk_lineitem_partsupp#3273 AS cfpk_lineitem_partsupp_2#3318, cpfk_part_lineitem#3274 AS cpfk_part_lineitem_2#3319, cfpk_lineitem_part#3275 AS cfpk_lineitem_part_2#3320, cpfk_partsupp_lineitem#3276 AS cpfk_partsupp_lineitem_2#3321, cfpk_lineitem_orders#3277 AS cfpk_lineitem_orders_2#3322, cval_lineitem_l_quantity#3278 AS cval_lineitem_l_quantity_2#3323, cval_lineitem_l_extendedprice#3279 AS cval_lineitem_l_extendedprice_2#3324, cval_lineitem_l_discount#3280 AS cval_lineitem_l_discount_2#3325, cval_lineitem_l_tax#3281 AS cval_lineitem_l_tax_2#3326, cval_lineitem_l_returnflag#3282 AS cval_lineitem_l_returnflag_2#3327, cval_lineitem_l_linestatus#3283 AS cval_lineitem_l_linestatus_2#3328, cval_lineitem_l_commitdate#3284 AS cval_lineitem_l_commitdate_2#3329, cval_lineitem_l_receiptdate#3285 AS cval_lineitem_l_receiptdate_2#3330, cval_lineitem_l_shipinstruct#3286 AS cval_lineitem_l_shipinstruct_2#3331, cval_lineitem_l_shipmode#3287 AS cval_lineitem_l_shipmode_2#3332, cval_lineitem_l_comment#3288 AS cval_lineitem_l_comment_2#3333, cval_lineitem_l_shipdate#3289 AS cval_lineitem_l_shipdate_2#3334, cdepval_lineitem_l_quantity#3290 AS cdepval_lineitem_l_quantity_2#3335, cdepval_lineitem_l_extendedprice#3291 AS cdepval_lineitem_l_extendedprice_2#3336, cdepval_lineitem_l_discount#3292 AS cdepval_lineitem_l_discount_2#3337, ... 21 more fields]
            :  :  :  +- Relation[rid#3269,cpfk_orders_lineitem#3270,cpfk_supplier_lineitem#3271,cfpk_lineitem_supplier#3272,cfpk_lineitem_partsupp#3273,cpfk_part_lineitem#3274,cfpk_lineitem_part#3275,cpfk_partsupp_lineitem#3276,cfpk_lineitem_orders#3277,cval_lineitem_l_quantity#3278,cval_lineitem_l_extendedprice#3279,cval_lineitem_l_discount#3280,cval_lineitem_l_tax#3281,cval_lineitem_l_returnflag#3282,cval_lineitem_l_linestatus#3283,cval_lineitem_l_commitdate#3284,cval_lineitem_l_receiptdate#3285,cval_lineitem_l_shipinstruct#3286,cval_lineitem_l_shipmode#3287,cval_lineitem_l_comment#3288,cval_lineitem_l_shipdate#3289,cdepval_lineitem_l_quantity#3290,cdepval_lineitem_l_extendedprice#3291,cdepval_lineitem_l_discount#3292,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
            :  :     +- Project [rid#3173 AS rid_1#3197, cpfk_customer_orders#3174 AS cpfk_customer_orders_1#3198, cfpk_orders_customer#3175 AS cfpk_orders_customer_1#3199, cval_orders_o_orderstatus#3176 AS cval_orders_o_orderstatus_1#3200, cval_orders_o_totalprice#3177 AS cval_orders_o_totalprice_1#3201, cval_orders_o_orderpriority#3178 AS cval_orders_o_orderpriority_1#3202, cval_orders_o_clerk#3179 AS cval_orders_o_clerk_1#3203, cval_orders_o_shippriority#3180 AS cval_orders_o_shippriority_1#3204, cval_orders_o_comment#3181 AS cval_orders_o_comment_1#3205, cval_orders_o_orderdate#3182 AS cval_orders_o_orderdate_1#3206, cdepval_orders_o_orderstatus#3183 AS cdepval_orders_o_orderstatus_1#3207, cdepval_orders_o_totalprice#3184 AS cdepval_orders_o_totalprice_1#3208, cdepval_orders_o_orderpriority#3185 AS cdepval_orders_o_orderpriority_1#3209, cdepval_orders_o_clerk#3186 AS cdepval_orders_o_clerk_1#3210, cdepval_orders_o_shippriority#3187 AS cdepval_orders_o_shippriority_1#3211, cdepval_orders_o_comment#3188 AS cdepval_orders_o_comment_1#3212, cdepval_orders_o_orderdate#3189 AS cdepval_orders_o_orderdate_1#3213, co_orderstatus#3190 AS co_orderstatus_1#3214, co_totalprice#3191 AS co_totalprice_1#3215, co_orderpriority#3192 AS co_orderpriority_1#3216, co_clerk#3193 AS co_clerk_1#3217, co_shippriority#3194 AS co_shippriority_1#3218, co_comment#3195 AS co_comment_1#3219, co_orderdate#3196 AS co_orderdate_1#3220]
            :  :        +- Relation[rid#3173,cpfk_customer_orders#3174,cfpk_orders_customer#3175,cval_orders_o_orderstatus#3176,cval_orders_o_totalprice#3177,cval_orders_o_orderpriority#3178,cval_orders_o_clerk#3179,cval_orders_o_shippriority#3180,cval_orders_o_comment#3181,cval_orders_o_orderdate#3182,cdepval_orders_o_orderstatus#3183,cdepval_orders_o_totalprice#3184,cdepval_orders_o_orderpriority#3185,cdepval_orders_o_clerk#3186,cdepval_orders_o_shippriority#3187,cdepval_orders_o_comment#3188,cdepval_orders_o_orderdate#3189,co_orderstatus#3190,co_totalprice#3191,co_orderpriority#3192,co_clerk#3193,co_shippriority#3194,co_comment#3195,co_orderdate#3196] JDBCRelation(torders) [numPartitions=1]
            :  +- Project [rid#3359 AS rid_3#3377, cpfk_nation_supplier#3360 AS cpfk_nation_supplier_3#3378, cfpk_supplier_nation#3361 AS cfpk_supplier_nation_3#3379, cval_supplier_s_name#3362 AS cval_supplier_s_name_3#3380, cval_supplier_s_address#3363 AS cval_supplier_s_address_3#3381, cval_supplier_s_phone#3364 AS cval_supplier_s_phone_3#3382, cval_supplier_s_acctbal#3365 AS cval_supplier_s_acctbal_3#3383, cval_supplier_s_comment#3366 AS cval_supplier_s_comment_3#3384, cdepval_supplier_s_name#3367 AS cdepval_supplier_s_name_3#3385, cdepval_supplier_s_address#3368 AS cdepval_supplier_s_address_3#3386, cdepval_supplier_s_phone#3369 AS cdepval_supplier_s_phone_3#3387, cdepval_supplier_s_acctbal#3370 AS cdepval_supplier_s_acctbal_3#3388, cdepval_supplier_s_comment#3371 AS cdepval_supplier_s_comment_3#3389, cs_name#3372 AS cs_name_3#3390, cs_address#3373 AS cs_address_3#3391, cs_phone#3374 AS cs_phone_3#3392, cs_acctbal#3375 AS cs_acctbal_3#3393, cs_comment#3376 AS cs_comment_3#3394]
            :     +- Relation[rid#3359,cpfk_nation_supplier#3360,cfpk_supplier_nation#3361,cval_supplier_s_name#3362,cval_supplier_s_address#3363,cval_supplier_s_phone#3364,cval_supplier_s_acctbal#3365,cval_supplier_s_comment#3366,cdepval_supplier_s_name#3367,cdepval_supplier_s_address#3368,cdepval_supplier_s_phone#3369,cdepval_supplier_s_acctbal#3370,cdepval_supplier_s_comment#3371,cs_name#3372,cs_address#3373,cs_phone#3374,cs_acctbal#3375,cs_comment#3376] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
               +- Project [rid#3395 AS rid_4#3404, cpfk_region_nation#3396 AS cpfk_region_nation_4#3405, cfpk_nation_region#3397 AS cfpk_nation_region_4#3406, cval_nation_n_name#3398 AS cval_nation_n_name_4#3407, cval_nation_n_comment#3399 AS cval_nation_n_comment_4#3408, cdepval_nation_n_name#3400 AS cdepval_nation_n_name_4#3409, cdepval_nation_n_comment#3401 AS cdepval_nation_n_comment_4#3410, cn_name#3402 AS cn_name_4#3411, cn_comment#3403 AS cn_comment_4#3412]
                  +- Relation[rid#3395,cpfk_region_nation#3396,cfpk_nation_region#3397,cval_nation_n_name#3398,cval_nation_n_comment#3399,cdepval_nation_n_name#3400,cdepval_nation_n_comment#3401,cn_name#3402,cn_comment#3403] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 75795ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/25 22:23:57 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:23:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3576L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:23:57 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:23:57 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:23:57 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:23:57 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:23:57 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:23:57 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:23:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3576L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#3728 AS rid_1#3773, cpfk_orders_lineitem#3729 AS cpfk_orders_lineitem_1#3774, cpfk_supplier_lineitem#3730 AS cpfk_supplier_lineitem_1#3775, cfpk_lineitem_supplier#3731 AS cfpk_lineitem_supplier_1#3776, cfpk_lineitem_partsupp#3732 AS cfpk_lineitem_partsupp_1#3777, cpfk_part_lineitem#3733 AS cpfk_part_lineitem_1#3778, cfpk_lineitem_part#3734 AS cfpk_lineitem_part_1#3779, cpfk_partsupp_lineitem#3735 AS cpfk_partsupp_lineitem_1#3780, cfpk_lineitem_orders#3736 AS cfpk_lineitem_orders_1#3781, cval_lineitem_l_quantity#3737 AS cval_lineitem_l_quantity_1#3782, cval_lineitem_l_extendedprice#3738 AS cval_lineitem_l_extendedprice_1#3783, cval_lineitem_l_discount#3739 AS cval_lineitem_l_discount_1#3784, cval_lineitem_l_tax#3740 AS cval_lineitem_l_tax_1#3785, cval_lineitem_l_returnflag#3741 AS cval_lineitem_l_returnflag_1#3786, cval_lineitem_l_linestatus#3742 AS cval_lineitem_l_linestatus_1#3787, cval_lineitem_l_commitdate#3743 AS cval_lineitem_l_commitdate_1#3788, cval_lineitem_l_receiptdate#3744 AS cval_lineitem_l_receiptdate_1#3789, cval_lineitem_l_shipinstruct#3745 AS cval_lineitem_l_shipinstruct_1#3790, cval_lineitem_l_shipmode#3746 AS cval_lineitem_l_shipmode_1#3791, cval_lineitem_l_comment#3747 AS cval_lineitem_l_comment_1#3792, cval_lineitem_l_shipdate#3748 AS cval_lineitem_l_shipdate_1#3793, cdepval_lineitem_l_quantity#3749 AS cdepval_lineitem_l_quantity_1#3794, cdepval_lineitem_l_extendedprice#3750 AS cdepval_lineitem_l_extendedprice_1#3795, cdepval_lineitem_l_discount#3751 AS cdepval_lineitem_l_discount_1#3796, ... 21 more fields]
         :  +- Relation[rid#3728,cpfk_orders_lineitem#3729,cpfk_supplier_lineitem#3730,cfpk_lineitem_supplier#3731,cfpk_lineitem_partsupp#3732,cpfk_part_lineitem#3733,cfpk_lineitem_part#3734,cpfk_partsupp_lineitem#3735,cfpk_lineitem_orders#3736,cval_lineitem_l_quantity#3737,cval_lineitem_l_extendedprice#3738,cval_lineitem_l_discount#3739,cval_lineitem_l_tax#3740,cval_lineitem_l_returnflag#3741,cval_lineitem_l_linestatus#3742,cval_lineitem_l_commitdate#3743,cval_lineitem_l_receiptdate#3744,cval_lineitem_l_shipinstruct#3745,cval_lineitem_l_shipmode#3746,cval_lineitem_l_comment#3747,cval_lineitem_l_shipdate#3748,cdepval_lineitem_l_quantity#3749,cdepval_lineitem_l_extendedprice#3750,cdepval_lineitem_l_discount#3751,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
               +- Project [rid#3578 AS rid_0#3603, cval_part_p_name#3579 AS cval_part_p_name_0#3604, cval_part_p_mfgr#3580 AS cval_part_p_mfgr_0#3605, cval_part_p_type#3581 AS cval_part_p_type_0#3606, cval_part_p_size#3582 AS cval_part_p_size_0#3607, cval_part_p_container#3583 AS cval_part_p_container_0#3608, cval_part_p_retailprice#3584 AS cval_part_p_retailprice_0#3609, cval_part_p_comment#3585 AS cval_part_p_comment_0#3610, cval_part_p_brand#3586 AS cval_part_p_brand_0#3611, cdepval_part_p_name#3587 AS cdepval_part_p_name_0#3612, cdepval_part_p_mfgr#3588 AS cdepval_part_p_mfgr_0#3613, cdepval_part_p_type#3589 AS cdepval_part_p_type_0#3614, cdepval_part_p_size#3590 AS cdepval_part_p_size_0#3615, cdepval_part_p_container#3591 AS cdepval_part_p_container_0#3616, cdepval_part_p_retailprice#3592 AS cdepval_part_p_retailprice_0#3617, cdepval_part_p_comment#3593 AS cdepval_part_p_comment_0#3618, cdepval_part_p_brand#3594 AS cdepval_part_p_brand_0#3619, cp_name#3595 AS cp_name_0#3620, cp_mfgr#3596 AS cp_mfgr_0#3621, cp_type#3597 AS cp_type_0#3622, cp_size#3598 AS cp_size_0#3623, cp_container#3599 AS cp_container_0#3624, cp_retailprice#3600 AS cp_retailprice_0#3625, cp_comment#3601 AS cp_comment_0#3626, cp_brand#3602 AS cp_brand_0#3627]
                  +- Relation[rid#3578,cval_part_p_name#3579,cval_part_p_mfgr#3580,cval_part_p_type#3581,cval_part_p_size#3582,cval_part_p_container#3583,cval_part_p_retailprice#3584,cval_part_p_comment#3585,cval_part_p_brand#3586,cdepval_part_p_name#3587,cdepval_part_p_mfgr#3588,cdepval_part_p_type#3589,cdepval_part_p_size#3590,cdepval_part_p_container#3591,cdepval_part_p_retailprice#3592,cdepval_part_p_comment#3593,cdepval_part_p_brand#3594,cp_name#3595,cp_mfgr#3596,cp_type#3597,cp_size#3598,cp_container#3599,cp_retailprice#3600,cp_comment#3601,cp_brand#3602] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 25973ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/25 22:24:23 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:24:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3897L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:24:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3897L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#3989 AS rid_2#4034, cpfk_orders_lineitem#3990 AS cpfk_orders_lineitem_2#4035, cpfk_supplier_lineitem#3991 AS cpfk_supplier_lineitem_2#4036, cfpk_lineitem_supplier#3992 AS cfpk_lineitem_supplier_2#4037, cfpk_lineitem_partsupp#3993 AS cfpk_lineitem_partsupp_2#4038, cpfk_part_lineitem#3994 AS cpfk_part_lineitem_2#4039, cfpk_lineitem_part#3995 AS cfpk_lineitem_part_2#4040, cpfk_partsupp_lineitem#3996 AS cpfk_partsupp_lineitem_2#4041, cfpk_lineitem_orders#3997 AS cfpk_lineitem_orders_2#4042, cval_lineitem_l_quantity#3998 AS cval_lineitem_l_quantity_2#4043, cval_lineitem_l_extendedprice#3999 AS cval_lineitem_l_extendedprice_2#4044, cval_lineitem_l_discount#4000 AS cval_lineitem_l_discount_2#4045, cval_lineitem_l_tax#4001 AS cval_lineitem_l_tax_2#4046, cval_lineitem_l_returnflag#4002 AS cval_lineitem_l_returnflag_2#4047, cval_lineitem_l_linestatus#4003 AS cval_lineitem_l_linestatus_2#4048, cval_lineitem_l_commitdate#4004 AS cval_lineitem_l_commitdate_2#4049, cval_lineitem_l_receiptdate#4005 AS cval_lineitem_l_receiptdate_2#4050, cval_lineitem_l_shipinstruct#4006 AS cval_lineitem_l_shipinstruct_2#4051, cval_lineitem_l_shipmode#4007 AS cval_lineitem_l_shipmode_2#4052, cval_lineitem_l_comment#4008 AS cval_lineitem_l_comment_2#4053, cval_lineitem_l_shipdate#4009 AS cval_lineitem_l_shipdate_2#4054, cdepval_lineitem_l_quantity#4010 AS cdepval_lineitem_l_quantity_2#4055, cdepval_lineitem_l_extendedprice#4011 AS cdepval_lineitem_l_extendedprice_2#4056, cdepval_lineitem_l_discount#4012 AS cdepval_lineitem_l_discount_2#4057, ... 21 more fields]
         :  +- Relation[rid#3989,cpfk_orders_lineitem#3990,cpfk_supplier_lineitem#3991,cfpk_lineitem_supplier#3992,cfpk_lineitem_partsupp#3993,cpfk_part_lineitem#3994,cfpk_lineitem_part#3995,cpfk_partsupp_lineitem#3996,cfpk_lineitem_orders#3997,cval_lineitem_l_quantity#3998,cval_lineitem_l_extendedprice#3999,cval_lineitem_l_discount#4000,cval_lineitem_l_tax#4001,cval_lineitem_l_returnflag#4002,cval_lineitem_l_linestatus#4003,cval_lineitem_l_commitdate#4004,cval_lineitem_l_receiptdate#4005,cval_lineitem_l_shipinstruct#4006,cval_lineitem_l_shipmode#4007,cval_lineitem_l_comment#4008,cval_lineitem_l_shipdate#4009,cdepval_lineitem_l_quantity#4010,cdepval_lineitem_l_extendedprice#4011,cdepval_lineitem_l_discount#4012,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#3941 AS rid_1#3965, cpfk_customer_orders#3942 AS cpfk_customer_orders_1#3966, cfpk_orders_customer#3943 AS cfpk_orders_customer_1#3967, cval_orders_o_orderstatus#3944 AS cval_orders_o_orderstatus_1#3968, cval_orders_o_totalprice#3945 AS cval_orders_o_totalprice_1#3969, cval_orders_o_orderpriority#3946 AS cval_orders_o_orderpriority_1#3970, cval_orders_o_clerk#3947 AS cval_orders_o_clerk_1#3971, cval_orders_o_shippriority#3948 AS cval_orders_o_shippriority_1#3972, cval_orders_o_comment#3949 AS cval_orders_o_comment_1#3973, cval_orders_o_orderdate#3950 AS cval_orders_o_orderdate_1#3974, cdepval_orders_o_orderstatus#3951 AS cdepval_orders_o_orderstatus_1#3975, cdepval_orders_o_totalprice#3952 AS cdepval_orders_o_totalprice_1#3976, cdepval_orders_o_orderpriority#3953 AS cdepval_orders_o_orderpriority_1#3977, cdepval_orders_o_clerk#3954 AS cdepval_orders_o_clerk_1#3978, cdepval_orders_o_shippriority#3955 AS cdepval_orders_o_shippriority_1#3979, cdepval_orders_o_comment#3956 AS cdepval_orders_o_comment_1#3980, cdepval_orders_o_orderdate#3957 AS cdepval_orders_o_orderdate_1#3981, co_orderstatus#3958 AS co_orderstatus_1#3982, co_totalprice#3959 AS co_totalprice_1#3983, co_orderpriority#3960 AS co_orderpriority_1#3984, co_clerk#3961 AS co_clerk_1#3985, co_shippriority#3962 AS co_shippriority_1#3986, co_comment#3963 AS co_comment_1#3987, co_orderdate#3964 AS co_orderdate_1#3988]
            :  +- Relation[rid#3941,cpfk_customer_orders#3942,cfpk_orders_customer#3943,cval_orders_o_orderstatus#3944,cval_orders_o_totalprice#3945,cval_orders_o_orderpriority#3946,cval_orders_o_clerk#3947,cval_orders_o_shippriority#3948,cval_orders_o_comment#3949,cval_orders_o_orderdate#3950,cdepval_orders_o_orderstatus#3951,cdepval_orders_o_totalprice#3952,cdepval_orders_o_orderpriority#3953,cdepval_orders_o_clerk#3954,cdepval_orders_o_shippriority#3955,cdepval_orders_o_comment#3956,cdepval_orders_o_orderdate#3957,co_orderstatus#3958,co_totalprice#3959,co_orderpriority#3960,co_clerk#3961,co_shippriority#3962,co_comment#3963,co_orderdate#3964] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#3899 AS rid_0#3920, cpfk_nation_customer#3900 AS cpfk_nation_customer_0#3921, cfpk_customer_nation#3901 AS cfpk_customer_nation_0#3922, cval_customer_c_name#3902 AS cval_customer_c_name_0#3923, cval_customer_c_address#3903 AS cval_customer_c_address_0#3924, cval_customer_c_phone#3904 AS cval_customer_c_phone_0#3925, cval_customer_c_acctbal#3905 AS cval_customer_c_acctbal_0#3926, cval_customer_c_comment#3906 AS cval_customer_c_comment_0#3927, cval_customer_c_mktsegment#3907 AS cval_customer_c_mktsegment_0#3928, cdepval_customer_c_name#3908 AS cdepval_customer_c_name_0#3929, cdepval_customer_c_address#3909 AS cdepval_customer_c_address_0#3930, cdepval_customer_c_phone#3910 AS cdepval_customer_c_phone_0#3931, cdepval_customer_c_acctbal#3911 AS cdepval_customer_c_acctbal_0#3932, cdepval_customer_c_comment#3912 AS cdepval_customer_c_comment_0#3933, cdepval_customer_c_mktsegment#3913 AS cdepval_customer_c_mktsegment_0#3934, cc_name#3914 AS cc_name_0#3935, cc_address#3915 AS cc_address_0#3936, cc_phone#3916 AS cc_phone_0#3937, cc_acctbal#3917 AS cc_acctbal_0#3938, cc_comment#3918 AS cc_comment_0#3939, cc_mktsegment#3919 AS cc_mktsegment_0#3940]
               +- Relation[rid#3899,cpfk_nation_customer#3900,cfpk_customer_nation#3901,cval_customer_c_name#3902,cval_customer_c_address#3903,cval_customer_c_phone#3904,cval_customer_c_acctbal#3905,cval_customer_c_comment#3906,cval_customer_c_mktsegment#3907,cdepval_customer_c_name#3908,cdepval_customer_c_address#3909,cdepval_customer_c_phone#3910,cdepval_customer_c_acctbal#3911,cdepval_customer_c_comment#3912,cdepval_customer_c_mktsegment#3913,cc_name#3914,cc_address#3915,cc_phone#3916,cc_acctbal#3917,cc_comment#3918,cc_mktsegment#3919] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 22102ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/25 22:24:45 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:24:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4174L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:24:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#4174L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#4176 AS rid_0#4221, cpfk_orders_lineitem#4177 AS cpfk_orders_lineitem_0#4222, cpfk_supplier_lineitem#4178 AS cpfk_supplier_lineitem_0#4223, cfpk_lineitem_supplier#4179 AS cfpk_lineitem_supplier_0#4224, cfpk_lineitem_partsupp#4180 AS cfpk_lineitem_partsupp_0#4225, cpfk_part_lineitem#4181 AS cpfk_part_lineitem_0#4226, cfpk_lineitem_part#4182 AS cfpk_lineitem_part_0#4227, cpfk_partsupp_lineitem#4183 AS cpfk_partsupp_lineitem_0#4228, cfpk_lineitem_orders#4184 AS cfpk_lineitem_orders_0#4229, cval_lineitem_l_quantity#4185 AS cval_lineitem_l_quantity_0#4230, cval_lineitem_l_extendedprice#4186 AS cval_lineitem_l_extendedprice_0#4231, cval_lineitem_l_discount#4187 AS cval_lineitem_l_discount_0#4232, cval_lineitem_l_tax#4188 AS cval_lineitem_l_tax_0#4233, cval_lineitem_l_returnflag#4189 AS cval_lineitem_l_returnflag_0#4234, cval_lineitem_l_linestatus#4190 AS cval_lineitem_l_linestatus_0#4235, cval_lineitem_l_commitdate#4191 AS cval_lineitem_l_commitdate_0#4236, cval_lineitem_l_receiptdate#4192 AS cval_lineitem_l_receiptdate_0#4237, cval_lineitem_l_shipinstruct#4193 AS cval_lineitem_l_shipinstruct_0#4238, cval_lineitem_l_shipmode#4194 AS cval_lineitem_l_shipmode_0#4239, cval_lineitem_l_comment#4195 AS cval_lineitem_l_comment_0#4240, cval_lineitem_l_shipdate#4196 AS cval_lineitem_l_shipdate_0#4241, cdepval_lineitem_l_quantity#4197 AS cdepval_lineitem_l_quantity_0#4242, cdepval_lineitem_l_extendedprice#4198 AS cdepval_lineitem_l_extendedprice_0#4243, cdepval_lineitem_l_discount#4199 AS cdepval_lineitem_l_discount_0#4244, ... 21 more fields]
         +- Relation[rid#4176,cpfk_orders_lineitem#4177,cpfk_supplier_lineitem#4178,cfpk_lineitem_supplier#4179,cfpk_lineitem_partsupp#4180,cpfk_part_lineitem#4181,cfpk_lineitem_part#4182,cpfk_partsupp_lineitem#4183,cfpk_lineitem_orders#4184,cval_lineitem_l_quantity#4185,cval_lineitem_l_extendedprice#4186,cval_lineitem_l_discount#4187,cval_lineitem_l_tax#4188,cval_lineitem_l_returnflag#4189,cval_lineitem_l_linestatus#4190,cval_lineitem_l_commitdate#4191,cval_lineitem_l_receiptdate#4192,cval_lineitem_l_shipinstruct#4193,cval_lineitem_l_shipmode#4194,cval_lineitem_l_comment#4195,cval_lineitem_l_shipdate#4196,cdepval_lineitem_l_quantity#4197,cdepval_lineitem_l_extendedprice#4198,cdepval_lineitem_l_discount#4199,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2311ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/25 22:24:47 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:24:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4316L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:24:47 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:24:47 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:24:47 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:24:47 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:24:47 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:24:47 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:24:47 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:24:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4316L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#4343, cval_part_p_name_0#4344, cval_part_p_mfgr_0#4345, cval_part_p_type_0#4346, cval_part_p_size_0#4347, cval_part_p_container_0#4348, cval_part_p_retailprice_0#4349, cval_part_p_comment_0#4350, cval_part_p_brand_0#4351, cdepval_part_p_name_0#4352, cdepval_part_p_mfgr_0#4353, cdepval_part_p_type_0#4354, cdepval_part_p_size_0#4355, cdepval_part_p_container_0#4356, cdepval_part_p_retailprice_0#4357, cdepval_part_p_comment_0#4358, cdepval_part_p_brand_0#4359, cp_name_0#4360, cp_mfgr_0#4361, cp_type_0#4362, cp_size_0#4363, cp_container_0#4364, cp_retailprice_0#4365, cp_comment_0#4366, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#4318 AS rid_0#4343, cval_part_p_name#4319 AS cval_part_p_name_0#4344, cval_part_p_mfgr#4320 AS cval_part_p_mfgr_0#4345, cval_part_p_type#4321 AS cval_part_p_type_0#4346, cval_part_p_size#4322 AS cval_part_p_size_0#4347, cval_part_p_container#4323 AS cval_part_p_container_0#4348, cval_part_p_retailprice#4324 AS cval_part_p_retailprice_0#4349, cval_part_p_comment#4325 AS cval_part_p_comment_0#4350, cval_part_p_brand#4326 AS cval_part_p_brand_0#4351, cdepval_part_p_name#4327 AS cdepval_part_p_name_0#4352, cdepval_part_p_mfgr#4328 AS cdepval_part_p_mfgr_0#4353, cdepval_part_p_type#4329 AS cdepval_part_p_type_0#4354, cdepval_part_p_size#4330 AS cdepval_part_p_size_0#4355, cdepval_part_p_container#4331 AS cdepval_part_p_container_0#4356, cdepval_part_p_retailprice#4332 AS cdepval_part_p_retailprice_0#4357, cdepval_part_p_comment#4333 AS cdepval_part_p_comment_0#4358, cdepval_part_p_brand#4334 AS cdepval_part_p_brand_0#4359, cp_name#4335 AS cp_name_0#4360, cp_mfgr#4336 AS cp_mfgr_0#4361, cp_type#4337 AS cp_type_0#4362, cp_size#4338 AS cp_size_0#4363, cp_container#4339 AS cp_container_0#4364, cp_retailprice#4340 AS cp_retailprice_0#4365, cp_comment#4341 AS cp_comment_0#4366, cp_brand#4342 AS cp_brand_0#4367]
         :  :        +- Relation[rid#4318,cval_part_p_name#4319,cval_part_p_mfgr#4320,cval_part_p_type#4321,cval_part_p_size#4322,cval_part_p_container#4323,cval_part_p_retailprice#4324,cval_part_p_comment#4325,cval_part_p_brand#4326,cdepval_part_p_name#4327,cdepval_part_p_mfgr#4328,cdepval_part_p_type#4329,cdepval_part_p_size#4330,cdepval_part_p_container#4331,cdepval_part_p_retailprice#4332,cdepval_part_p_comment#4333,cdepval_part_p_brand#4334,cp_name#4335,cp_mfgr#4336,cp_type#4337,cp_size#4338,cp_container#4339,cp_retailprice#4340,cp_comment#4341,cp_brand#4342] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#4788 AS rid_1#4833, cpfk_orders_lineitem#4789 AS cpfk_orders_lineitem_1#4834, cpfk_supplier_lineitem#4790 AS cpfk_supplier_lineitem_1#4835, cfpk_lineitem_supplier#4791 AS cfpk_lineitem_supplier_1#4836, cfpk_lineitem_partsupp#4792 AS cfpk_lineitem_partsupp_1#4837, cpfk_part_lineitem#4793 AS cpfk_part_lineitem_1#4838, cfpk_lineitem_part#4794 AS cfpk_lineitem_part_1#4839, cpfk_partsupp_lineitem#4795 AS cpfk_partsupp_lineitem_1#4840, cfpk_lineitem_orders#4796 AS cfpk_lineitem_orders_1#4841, cval_lineitem_l_quantity#4797 AS cval_lineitem_l_quantity_1#4842, cval_lineitem_l_extendedprice#4798 AS cval_lineitem_l_extendedprice_1#4843, cval_lineitem_l_discount#4799 AS cval_lineitem_l_discount_1#4844, cval_lineitem_l_tax#4800 AS cval_lineitem_l_tax_1#4845, cval_lineitem_l_returnflag#4801 AS cval_lineitem_l_returnflag_1#4846, cval_lineitem_l_linestatus#4802 AS cval_lineitem_l_linestatus_1#4847, cval_lineitem_l_commitdate#4803 AS cval_lineitem_l_commitdate_1#4848, cval_lineitem_l_receiptdate#4804 AS cval_lineitem_l_receiptdate_1#4849, cval_lineitem_l_shipinstruct#4805 AS cval_lineitem_l_shipinstruct_1#4850, cval_lineitem_l_shipmode#4806 AS cval_lineitem_l_shipmode_1#4851, cval_lineitem_l_comment#4807 AS cval_lineitem_l_comment_1#4852, cval_lineitem_l_shipdate#4808 AS cval_lineitem_l_shipdate_1#4853, cdepval_lineitem_l_quantity#4809 AS cdepval_lineitem_l_quantity_1#4854, cdepval_lineitem_l_extendedprice#4810 AS cdepval_lineitem_l_extendedprice_1#4855, cdepval_lineitem_l_discount#4811 AS cdepval_lineitem_l_discount_1#4856, ... 21 more fields]
         :        +- Relation[rid#4788,cpfk_orders_lineitem#4789,cpfk_supplier_lineitem#4790,cfpk_lineitem_supplier#4791,cfpk_lineitem_partsupp#4792,cpfk_part_lineitem#4793,cfpk_lineitem_part#4794,cpfk_partsupp_lineitem#4795,cfpk_lineitem_orders#4796,cval_lineitem_l_quantity#4797,cval_lineitem_l_extendedprice#4798,cval_lineitem_l_discount#4799,cval_lineitem_l_tax#4800,cval_lineitem_l_returnflag#4801,cval_lineitem_l_linestatus#4802,cval_lineitem_l_commitdate#4803,cval_lineitem_l_receiptdate#4804,cval_lineitem_l_shipinstruct#4805,cval_lineitem_l_shipmode#4806,cval_lineitem_l_comment#4807,cval_lineitem_l_shipdate#4808,cdepval_lineitem_l_quantity#4809,cdepval_lineitem_l_extendedprice#4810,cdepval_lineitem_l_discount#4811,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#4468 AS rid_1#4513, cpfk_orders_lineitem#4469 AS cpfk_orders_lineitem_1#4514, cpfk_supplier_lineitem#4470 AS cpfk_supplier_lineitem_1#4515, cfpk_lineitem_supplier#4471 AS cfpk_lineitem_supplier_1#4516, cfpk_lineitem_partsupp#4472 AS cfpk_lineitem_partsupp_1#4517, cpfk_part_lineitem#4473 AS cpfk_part_lineitem_1#4518, cfpk_lineitem_part#4474 AS cfpk_lineitem_part_1#4519, cpfk_partsupp_lineitem#4475 AS cpfk_partsupp_lineitem_1#4520, cfpk_lineitem_orders#4476 AS cfpk_lineitem_orders_1#4521, cval_lineitem_l_quantity#4477 AS cval_lineitem_l_quantity_1#4522, cval_lineitem_l_extendedprice#4478 AS cval_lineitem_l_extendedprice_1#4523, cval_lineitem_l_discount#4479 AS cval_lineitem_l_discount_1#4524, cval_lineitem_l_tax#4480 AS cval_lineitem_l_tax_1#4525, cval_lineitem_l_returnflag#4481 AS cval_lineitem_l_returnflag_1#4526, cval_lineitem_l_linestatus#4482 AS cval_lineitem_l_linestatus_1#4527, cval_lineitem_l_commitdate#4483 AS cval_lineitem_l_commitdate_1#4528, cval_lineitem_l_receiptdate#4484 AS cval_lineitem_l_receiptdate_1#4529, cval_lineitem_l_shipinstruct#4485 AS cval_lineitem_l_shipinstruct_1#4530, cval_lineitem_l_shipmode#4486 AS cval_lineitem_l_shipmode_1#4531, cval_lineitem_l_comment#4487 AS cval_lineitem_l_comment_1#4532, cval_lineitem_l_shipdate#4488 AS cval_lineitem_l_shipdate_1#4533, cdepval_lineitem_l_quantity#4489 AS cdepval_lineitem_l_quantity_1#4534, cdepval_lineitem_l_extendedprice#4490 AS cdepval_lineitem_l_extendedprice_1#4535, cdepval_lineitem_l_discount#4491 AS cdepval_lineitem_l_discount_1#4536, ... 21 more fields]
                  +- Relation[rid#4468,cpfk_orders_lineitem#4469,cpfk_supplier_lineitem#4470,cfpk_lineitem_supplier#4471,cfpk_lineitem_partsupp#4472,cpfk_part_lineitem#4473,cfpk_lineitem_part#4474,cpfk_partsupp_lineitem#4475,cfpk_lineitem_orders#4476,cval_lineitem_l_quantity#4477,cval_lineitem_l_extendedprice#4478,cval_lineitem_l_discount#4479,cval_lineitem_l_tax#4480,cval_lineitem_l_returnflag#4481,cval_lineitem_l_linestatus#4482,cval_lineitem_l_commitdate#4483,cval_lineitem_l_receiptdate#4484,cval_lineitem_l_shipinstruct#4485,cval_lineitem_l_shipmode#4486,cval_lineitem_l_comment#4487,cval_lineitem_l_shipdate#4488,cdepval_lineitem_l_quantity#4489,cdepval_lineitem_l_extendedprice#4490,cdepval_lineitem_l_discount#4491,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 16638ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/25 22:25:04 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:25:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4953L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 22:25:04 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:25:04 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:25:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:25:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:25:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:25:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:25:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:25:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:25:04 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:25:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:25:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4953L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :  :- Project [rid#5055 AS rid_1#5069, cpfk_part_partsupp#5056 AS cpfk_part_partsupp_1#5070, cfpk_partsupp_part#5057 AS cfpk_partsupp_part_1#5071, cpfk_supplier_partsupp#5058 AS cpfk_supplier_partsupp_1#5072, cfpk_partsupp_supplier#5059 AS cfpk_partsupp_supplier_1#5073, cval_partsupp_ps_availqty#5060 AS cval_partsupp_ps_availqty_1#5074, cval_partsupp_ps_supplycost#5061 AS cval_partsupp_ps_supplycost_1#5075, cval_partsupp_ps_comment#5062 AS cval_partsupp_ps_comment_1#5076, cdepval_partsupp_ps_availqty#5063 AS cdepval_partsupp_ps_availqty_1#5077, cdepval_partsupp_ps_supplycost#5064 AS cdepval_partsupp_ps_supplycost_1#5078, cdepval_partsupp_ps_comment#5065 AS cdepval_partsupp_ps_comment_1#5079, cps_availqty#5066 AS cps_availqty_1#5080, cps_supplycost#5067 AS cps_supplycost_1#5081, cps_comment#5068 AS cps_comment_1#5082]
         :  :  +- Relation[rid#5055,cpfk_part_partsupp#5056,cfpk_partsupp_part#5057,cpfk_supplier_partsupp#5058,cfpk_partsupp_supplier#5059,cval_partsupp_ps_availqty#5060,cval_partsupp_ps_supplycost#5061,cval_partsupp_ps_comment#5062,cdepval_partsupp_ps_availqty#5063,cdepval_partsupp_ps_supplycost#5064,cdepval_partsupp_ps_comment#5065,cps_availqty#5066,cps_supplycost#5067,cps_comment#5068] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :     +- Project [rid#4955 AS rid_0#4980, cval_part_p_name#4956 AS cval_part_p_name_0#4981, cval_part_p_mfgr#4957 AS cval_part_p_mfgr_0#4982, cval_part_p_type#4958 AS cval_part_p_type_0#4983, cval_part_p_size#4959 AS cval_part_p_size_0#4984, cval_part_p_container#4960 AS cval_part_p_container_0#4985, cval_part_p_retailprice#4961 AS cval_part_p_retailprice_0#4986, cval_part_p_comment#4962 AS cval_part_p_comment_0#4987, cval_part_p_brand#4963 AS cval_part_p_brand_0#4988, cdepval_part_p_name#4964 AS cdepval_part_p_name_0#4989, cdepval_part_p_mfgr#4965 AS cdepval_part_p_mfgr_0#4990, cdepval_part_p_type#4966 AS cdepval_part_p_type_0#4991, cdepval_part_p_size#4967 AS cdepval_part_p_size_0#4992, cdepval_part_p_container#4968 AS cdepval_part_p_container_0#4993, cdepval_part_p_retailprice#4969 AS cdepval_part_p_retailprice_0#4994, cdepval_part_p_comment#4970 AS cdepval_part_p_comment_0#4995, cdepval_part_p_brand#4971 AS cdepval_part_p_brand_0#4996, cp_name#4972 AS cp_name_0#4997, cp_mfgr#4973 AS cp_mfgr_0#4998, cp_type#4974 AS cp_type_0#4999, cp_size#4975 AS cp_size_0#5000, cp_container#4976 AS cp_container_0#5001, cp_retailprice#4977 AS cp_retailprice_0#5002, cp_comment#4978 AS cp_comment_0#5003, cp_brand#4979 AS cp_brand_0#5004]
         :        +- Relation[rid#4955,cval_part_p_name#4956,cval_part_p_mfgr#4957,cval_part_p_type#4958,cval_part_p_size#4959,cval_part_p_container#4960,cval_part_p_retailprice#4961,cval_part_p_comment#4962,cval_part_p_brand#4963,cdepval_part_p_name#4964,cdepval_part_p_mfgr#4965,cdepval_part_p_type#4966,cdepval_part_p_size#4967,cdepval_part_p_container#4968,cdepval_part_p_retailprice#4969,cdepval_part_p_comment#4970,cdepval_part_p_brand#4971,cp_name#4972,cp_mfgr#4973,cp_type#4974,cp_size#4975,cp_container#4976,cp_retailprice#4977,cp_comment#4978,cp_brand#4979] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_2)
            :- Project [rid#5119 AS rid_3#5137, cpfk_nation_supplier#5120 AS cpfk_nation_supplier_3#5138, cfpk_supplier_nation#5121 AS cfpk_supplier_nation_3#5139, cval_supplier_s_name#5122 AS cval_supplier_s_name_3#5140, cval_supplier_s_address#5123 AS cval_supplier_s_address_3#5141, cval_supplier_s_phone#5124 AS cval_supplier_s_phone_3#5142, cval_supplier_s_acctbal#5125 AS cval_supplier_s_acctbal_3#5143, cval_supplier_s_comment#5126 AS cval_supplier_s_comment_3#5144, cdepval_supplier_s_name#5127 AS cdepval_supplier_s_name_3#5145, cdepval_supplier_s_address#5128 AS cdepval_supplier_s_address_3#5146, cdepval_supplier_s_phone#5129 AS cdepval_supplier_s_phone_3#5147, cdepval_supplier_s_acctbal#5130 AS cdepval_supplier_s_acctbal_3#5148, cdepval_supplier_s_comment#5131 AS cdepval_supplier_s_comment_3#5149, cs_name#5132 AS cs_name_3#5150, cs_address#5133 AS cs_address_3#5151, cs_phone#5134 AS cs_phone_3#5152, cs_acctbal#5135 AS cs_acctbal_3#5153, cs_comment#5136 AS cs_comment_3#5154]
            :  +- Relation[rid#5119,cpfk_nation_supplier#5120,cfpk_supplier_nation#5121,cval_supplier_s_name#5122,cval_supplier_s_address#5123,cval_supplier_s_phone#5124,cval_supplier_s_acctbal#5125,cval_supplier_s_comment#5126,cdepval_supplier_s_name#5127,cdepval_supplier_s_address#5128,cdepval_supplier_s_phone#5129,cdepval_supplier_s_acctbal#5130,cdepval_supplier_s_comment#5131,cs_name#5132,cs_address#5133,cs_phone#5134,cs_acctbal#5135,cs_comment#5136] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
               +- Project [rid#5083 AS rid_2#5092, cpfk_region_nation#5084 AS cpfk_region_nation_2#5093, cfpk_nation_region#5085 AS cfpk_nation_region_2#5094, cval_nation_n_name#5086 AS cval_nation_n_name_2#5095, cval_nation_n_comment#5087 AS cval_nation_n_comment_2#5096, cdepval_nation_n_name#5088 AS cdepval_nation_n_name_2#5097, cdepval_nation_n_comment#5089 AS cdepval_nation_n_comment_2#5098, cn_name#5090 AS cn_name_2#5099, cn_comment#5091 AS cn_comment_2#5100]
                  +- Relation[rid#5083,cpfk_region_nation#5084,cfpk_nation_region#5085,cval_nation_n_name#5086,cval_nation_n_comment#5087,cdepval_nation_n_name#5088,cdepval_nation_n_comment#5089,cn_name#5090,cn_comment#5091] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 3830ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 22:25:07 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:25:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5230L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:25:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:25:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:25:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:25:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:25:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:25:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:25:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:25:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:25:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:25:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:25:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:25:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5230L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#5364 AS rid_4#5409, cpfk_orders_lineitem#5365 AS cpfk_orders_lineitem_4#5410, cpfk_supplier_lineitem#5366 AS cpfk_supplier_lineitem_4#5411, cfpk_lineitem_supplier#5367 AS cfpk_lineitem_supplier_4#5412, cfpk_lineitem_partsupp#5368 AS cfpk_lineitem_partsupp_4#5413, cpfk_part_lineitem#5369 AS cpfk_part_lineitem_4#5414, cfpk_lineitem_part#5370 AS cfpk_lineitem_part_4#5415, cpfk_partsupp_lineitem#5371 AS cpfk_partsupp_lineitem_4#5416, cfpk_lineitem_orders#5372 AS cfpk_lineitem_orders_4#5417, cval_lineitem_l_quantity#5373 AS cval_lineitem_l_quantity_4#5418, cval_lineitem_l_extendedprice#5374 AS cval_lineitem_l_extendedprice_4#5419, cval_lineitem_l_discount#5375 AS cval_lineitem_l_discount_4#5420, cval_lineitem_l_tax#5376 AS cval_lineitem_l_tax_4#5421, cval_lineitem_l_returnflag#5377 AS cval_lineitem_l_returnflag_4#5422, cval_lineitem_l_linestatus#5378 AS cval_lineitem_l_linestatus_4#5423, cval_lineitem_l_commitdate#5379 AS cval_lineitem_l_commitdate_4#5424, cval_lineitem_l_receiptdate#5380 AS cval_lineitem_l_receiptdate_4#5425, cval_lineitem_l_shipinstruct#5381 AS cval_lineitem_l_shipinstruct_4#5426, cval_lineitem_l_shipmode#5382 AS cval_lineitem_l_shipmode_4#5427, cval_lineitem_l_comment#5383 AS cval_lineitem_l_comment_4#5428, cval_lineitem_l_shipdate#5384 AS cval_lineitem_l_shipdate_4#5429, cdepval_lineitem_l_quantity#5385 AS cdepval_lineitem_l_quantity_4#5430, cdepval_lineitem_l_extendedprice#5386 AS cdepval_lineitem_l_extendedprice_4#5431, cdepval_lineitem_l_discount#5387 AS cdepval_lineitem_l_discount_4#5432, ... 21 more fields]
         :  :  +- Relation[rid#5364,cpfk_orders_lineitem#5365,cpfk_supplier_lineitem#5366,cfpk_lineitem_supplier#5367,cfpk_lineitem_partsupp#5368,cpfk_part_lineitem#5369,cfpk_lineitem_part#5370,cpfk_partsupp_lineitem#5371,cfpk_lineitem_orders#5372,cval_lineitem_l_quantity#5373,cval_lineitem_l_extendedprice#5374,cval_lineitem_l_discount#5375,cval_lineitem_l_tax#5376,cval_lineitem_l_returnflag#5377,cval_lineitem_l_linestatus#5378,cval_lineitem_l_commitdate#5379,cval_lineitem_l_receiptdate#5380,cval_lineitem_l_shipinstruct#5381,cval_lineitem_l_shipmode#5382,cval_lineitem_l_comment#5383,cval_lineitem_l_shipdate#5384,cdepval_lineitem_l_quantity#5385,cdepval_lineitem_l_extendedprice#5386,cdepval_lineitem_l_discount#5387,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#5286 AS rid_2#5300, cpfk_part_partsupp#5287 AS cpfk_part_partsupp_2#5301, cfpk_partsupp_part#5288 AS cfpk_partsupp_part_2#5302, cpfk_supplier_partsupp#5289 AS cpfk_supplier_partsupp_2#5303, cfpk_partsupp_supplier#5290 AS cfpk_partsupp_supplier_2#5304, cval_partsupp_ps_availqty#5291 AS cval_partsupp_ps_availqty_2#5305, cval_partsupp_ps_supplycost#5292 AS cval_partsupp_ps_supplycost_2#5306, cval_partsupp_ps_comment#5293 AS cval_partsupp_ps_comment_2#5307, cdepval_partsupp_ps_availqty#5294 AS cdepval_partsupp_ps_availqty_2#5308, cdepval_partsupp_ps_supplycost#5295 AS cdepval_partsupp_ps_supplycost_2#5309, cdepval_partsupp_ps_comment#5296 AS cdepval_partsupp_ps_comment_2#5310, cps_availqty#5297 AS cps_availqty_2#5311, cps_supplycost#5298 AS cps_supplycost_2#5312, cps_comment#5299 AS cps_comment_2#5313]
         :     :  :  +- Relation[rid#5286,cpfk_part_partsupp#5287,cfpk_partsupp_part#5288,cpfk_supplier_partsupp#5289,cfpk_partsupp_supplier#5290,cval_partsupp_ps_availqty#5291,cval_partsupp_ps_supplycost#5292,cval_partsupp_ps_comment#5293,cdepval_partsupp_ps_availqty#5294,cdepval_partsupp_ps_supplycost#5295,cdepval_partsupp_ps_comment#5296,cps_availqty#5297,cps_supplycost#5298,cps_comment#5299] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#5250 AS rid_1#5268, cpfk_nation_supplier#5251 AS cpfk_nation_supplier_1#5269, cfpk_supplier_nation#5252 AS cfpk_supplier_nation_1#5270, cval_supplier_s_name#5253 AS cval_supplier_s_name_1#5271, cval_supplier_s_address#5254 AS cval_supplier_s_address_1#5272, cval_supplier_s_phone#5255 AS cval_supplier_s_phone_1#5273, cval_supplier_s_acctbal#5256 AS cval_supplier_s_acctbal_1#5274, cval_supplier_s_comment#5257 AS cval_supplier_s_comment_1#5275, cdepval_supplier_s_name#5258 AS cdepval_supplier_s_name_1#5276, cdepval_supplier_s_address#5259 AS cdepval_supplier_s_address_1#5277, cdepval_supplier_s_phone#5260 AS cdepval_supplier_s_phone_1#5278, cdepval_supplier_s_acctbal#5261 AS cdepval_supplier_s_acctbal_1#5279, cdepval_supplier_s_comment#5262 AS cdepval_supplier_s_comment_1#5280, cs_name#5263 AS cs_name_1#5281, cs_address#5264 AS cs_address_1#5282, cs_phone#5265 AS cs_phone_1#5283, cs_acctbal#5266 AS cs_acctbal_1#5284, cs_comment#5267 AS cs_comment_1#5285]
         :     :     :  +- Relation[rid#5250,cpfk_nation_supplier#5251,cfpk_supplier_nation#5252,cval_supplier_s_name#5253,cval_supplier_s_address#5254,cval_supplier_s_phone#5255,cval_supplier_s_acctbal#5256,cval_supplier_s_comment#5257,cdepval_supplier_s_name#5258,cdepval_supplier_s_address#5259,cdepval_supplier_s_phone#5260,cdepval_supplier_s_acctbal#5261,cdepval_supplier_s_comment#5262,cs_name#5263,cs_address#5264,cs_phone#5265,cs_acctbal#5266,cs_comment#5267] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#5232 AS rid_0#5241, cpfk_region_nation#5233 AS cpfk_region_nation_0#5242, cfpk_nation_region#5234 AS cfpk_nation_region_0#5243, cval_nation_n_name#5235 AS cval_nation_n_name_0#5244, cval_nation_n_comment#5236 AS cval_nation_n_comment_0#5245, cdepval_nation_n_name#5237 AS cdepval_nation_n_name_0#5246, cdepval_nation_n_comment#5238 AS cdepval_nation_n_comment_0#5247, cn_name#5239 AS cn_name_0#5248, cn_comment#5240 AS cn_comment_0#5249]
         :     :        +- Relation[rid#5232,cpfk_region_nation#5233,cfpk_nation_region#5234,cval_nation_n_name#5235,cval_nation_n_comment#5236,cdepval_nation_n_name#5237,cdepval_nation_n_comment#5238,cn_name#5239,cn_comment#5240] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#5314 AS rid_3#5339, cval_part_p_name#5315 AS cval_part_p_name_3#5340, cval_part_p_mfgr#5316 AS cval_part_p_mfgr_3#5341, cval_part_p_type#5317 AS cval_part_p_type_3#5342, cval_part_p_size#5318 AS cval_part_p_size_3#5343, cval_part_p_container#5319 AS cval_part_p_container_3#5344, cval_part_p_retailprice#5320 AS cval_part_p_retailprice_3#5345, cval_part_p_comment#5321 AS cval_part_p_comment_3#5346, cval_part_p_brand#5322 AS cval_part_p_brand_3#5347, cdepval_part_p_name#5323 AS cdepval_part_p_name_3#5348, cdepval_part_p_mfgr#5324 AS cdepval_part_p_mfgr_3#5349, cdepval_part_p_type#5325 AS cdepval_part_p_type_3#5350, cdepval_part_p_size#5326 AS cdepval_part_p_size_3#5351, cdepval_part_p_container#5327 AS cdepval_part_p_container_3#5352, cdepval_part_p_retailprice#5328 AS cdepval_part_p_retailprice_3#5353, cdepval_part_p_comment#5329 AS cdepval_part_p_comment_3#5354, cdepval_part_p_brand#5330 AS cdepval_part_p_brand_3#5355, cp_name#5331 AS cp_name_3#5356, cp_mfgr#5332 AS cp_mfgr_3#5357, cp_type#5333 AS cp_type_3#5358, cp_size#5334 AS cp_size_3#5359, cp_container#5335 AS cp_container_3#5360, cp_retailprice#5336 AS cp_retailprice_3#5361, cp_comment#5337 AS cp_comment_3#5362, cp_brand#5338 AS cp_brand_3#5363]
         :        +- Relation[rid#5314,cval_part_p_name#5315,cval_part_p_mfgr#5316,cval_part_p_type#5317,cval_part_p_size#5318,cval_part_p_container#5319,cval_part_p_retailprice#5320,cval_part_p_comment#5321,cval_part_p_brand#5322,cdepval_part_p_name#5323,cdepval_part_p_mfgr#5324,cdepval_part_p_type#5325,cdepval_part_p_size#5326,cdepval_part_p_container#5327,cdepval_part_p_retailprice#5328,cdepval_part_p_comment#5329,cdepval_part_p_brand#5330,cp_name#5331,cp_mfgr#5332,cp_type#5333,cp_size#5334,cp_container#5335,cp_retailprice#5336,cp_comment#5337,cp_brand#5338] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#5454 AS rid_5#5478, cpfk_customer_orders#5455 AS cpfk_customer_orders_5#5479, cfpk_orders_customer#5456 AS cfpk_orders_customer_5#5480, cval_orders_o_orderstatus#5457 AS cval_orders_o_orderstatus_5#5481, cval_orders_o_totalprice#5458 AS cval_orders_o_totalprice_5#5482, cval_orders_o_orderpriority#5459 AS cval_orders_o_orderpriority_5#5483, cval_orders_o_clerk#5460 AS cval_orders_o_clerk_5#5484, cval_orders_o_shippriority#5461 AS cval_orders_o_shippriority_5#5485, cval_orders_o_comment#5462 AS cval_orders_o_comment_5#5486, cval_orders_o_orderdate#5463 AS cval_orders_o_orderdate_5#5487, cdepval_orders_o_orderstatus#5464 AS cdepval_orders_o_orderstatus_5#5488, cdepval_orders_o_totalprice#5465 AS cdepval_orders_o_totalprice_5#5489, cdepval_orders_o_orderpriority#5466 AS cdepval_orders_o_orderpriority_5#5490, cdepval_orders_o_clerk#5467 AS cdepval_orders_o_clerk_5#5491, cdepval_orders_o_shippriority#5468 AS cdepval_orders_o_shippriority_5#5492, cdepval_orders_o_comment#5469 AS cdepval_orders_o_comment_5#5493, cdepval_orders_o_orderdate#5470 AS cdepval_orders_o_orderdate_5#5494, co_orderstatus#5471 AS co_orderstatus_5#5495, co_totalprice#5472 AS co_totalprice_5#5496, co_orderpriority#5473 AS co_orderpriority_5#5497, co_clerk#5474 AS co_clerk_5#5498, co_shippriority#5475 AS co_shippriority_5#5499, co_comment#5476 AS co_comment_5#5500, co_orderdate#5477 AS co_orderdate_5#5501]
            +- Relation[rid#5454,cpfk_customer_orders#5455,cfpk_orders_customer#5456,cval_orders_o_orderstatus#5457,cval_orders_o_totalprice#5458,cval_orders_o_orderpriority#5459,cval_orders_o_clerk#5460,cval_orders_o_shippriority#5461,cval_orders_o_comment#5462,cval_orders_o_orderdate#5463,cdepval_orders_o_orderstatus#5464,cdepval_orders_o_totalprice#5465,cdepval_orders_o_orderpriority#5466,cdepval_orders_o_clerk#5467,cdepval_orders_o_shippriority#5468,cdepval_orders_o_comment#5469,cdepval_orders_o_orderdate#5470,co_orderstatus#5471,co_totalprice#5472,co_orderpriority#5473,co_clerk#5474,co_shippriority#5475,co_comment#5476,co_orderdate#5477] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 37833ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/25 22:25:45 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:25:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5643L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 22:25:45 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:25:45 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:25:45 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:25:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:25:45 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:25:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:25:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:25:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:25:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:25:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:25:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:25:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5643L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#5781 AS rid_4#5826, cpfk_orders_lineitem#5782 AS cpfk_orders_lineitem_4#5827, cpfk_supplier_lineitem#5783 AS cpfk_supplier_lineitem_4#5828, cfpk_lineitem_supplier#5784 AS cfpk_lineitem_supplier_4#5829, cfpk_lineitem_partsupp#5785 AS cfpk_lineitem_partsupp_4#5830, cpfk_part_lineitem#5786 AS cpfk_part_lineitem_4#5831, cfpk_lineitem_part#5787 AS cfpk_lineitem_part_4#5832, cpfk_partsupp_lineitem#5788 AS cpfk_partsupp_lineitem_4#5833, cfpk_lineitem_orders#5789 AS cfpk_lineitem_orders_4#5834, cval_lineitem_l_quantity#5790 AS cval_lineitem_l_quantity_4#5835, cval_lineitem_l_extendedprice#5791 AS cval_lineitem_l_extendedprice_4#5836, cval_lineitem_l_discount#5792 AS cval_lineitem_l_discount_4#5837, cval_lineitem_l_tax#5793 AS cval_lineitem_l_tax_4#5838, cval_lineitem_l_returnflag#5794 AS cval_lineitem_l_returnflag_4#5839, cval_lineitem_l_linestatus#5795 AS cval_lineitem_l_linestatus_4#5840, cval_lineitem_l_commitdate#5796 AS cval_lineitem_l_commitdate_4#5841, cval_lineitem_l_receiptdate#5797 AS cval_lineitem_l_receiptdate_4#5842, cval_lineitem_l_shipinstruct#5798 AS cval_lineitem_l_shipinstruct_4#5843, cval_lineitem_l_shipmode#5799 AS cval_lineitem_l_shipmode_4#5844, cval_lineitem_l_comment#5800 AS cval_lineitem_l_comment_4#5845, cval_lineitem_l_shipdate#5801 AS cval_lineitem_l_shipdate_4#5846, cdepval_lineitem_l_quantity#5802 AS cdepval_lineitem_l_quantity_4#5847, cdepval_lineitem_l_extendedprice#5803 AS cdepval_lineitem_l_extendedprice_4#5848, cdepval_lineitem_l_discount#5804 AS cdepval_lineitem_l_discount_4#5849, ... 21 more fields]
            :  :  +- Relation[rid#5781,cpfk_orders_lineitem#5782,cpfk_supplier_lineitem#5783,cfpk_lineitem_supplier#5784,cfpk_lineitem_partsupp#5785,cpfk_part_lineitem#5786,cfpk_lineitem_part#5787,cpfk_partsupp_lineitem#5788,cfpk_lineitem_orders#5789,cval_lineitem_l_quantity#5790,cval_lineitem_l_extendedprice#5791,cval_lineitem_l_discount#5792,cval_lineitem_l_tax#5793,cval_lineitem_l_returnflag#5794,cval_lineitem_l_linestatus#5795,cval_lineitem_l_commitdate#5796,cval_lineitem_l_receiptdate#5797,cval_lineitem_l_shipinstruct#5798,cval_lineitem_l_shipmode#5799,cval_lineitem_l_comment#5800,cval_lineitem_l_shipdate#5801,cdepval_lineitem_l_quantity#5802,cdepval_lineitem_l_extendedprice#5803,cdepval_lineitem_l_discount#5804,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#5733 AS rid_3#5757, cpfk_customer_orders#5734 AS cpfk_customer_orders_3#5758, cfpk_orders_customer#5735 AS cfpk_orders_customer_3#5759, cval_orders_o_orderstatus#5736 AS cval_orders_o_orderstatus_3#5760, cval_orders_o_totalprice#5737 AS cval_orders_o_totalprice_3#5761, cval_orders_o_orderpriority#5738 AS cval_orders_o_orderpriority_3#5762, cval_orders_o_clerk#5739 AS cval_orders_o_clerk_3#5763, cval_orders_o_shippriority#5740 AS cval_orders_o_shippriority_3#5764, cval_orders_o_comment#5741 AS cval_orders_o_comment_3#5765, cval_orders_o_orderdate#5742 AS cval_orders_o_orderdate_3#5766, cdepval_orders_o_orderstatus#5743 AS cdepval_orders_o_orderstatus_3#5767, cdepval_orders_o_totalprice#5744 AS cdepval_orders_o_totalprice_3#5768, cdepval_orders_o_orderpriority#5745 AS cdepval_orders_o_orderpriority_3#5769, cdepval_orders_o_clerk#5746 AS cdepval_orders_o_clerk_3#5770, cdepval_orders_o_shippriority#5747 AS cdepval_orders_o_shippriority_3#5771, cdepval_orders_o_comment#5748 AS cdepval_orders_o_comment_3#5772, cdepval_orders_o_orderdate#5749 AS cdepval_orders_o_orderdate_3#5773, co_orderstatus#5750 AS co_orderstatus_3#5774, co_totalprice#5751 AS co_totalprice_3#5775, co_orderpriority#5752 AS co_orderpriority_3#5776, co_clerk#5753 AS co_clerk_3#5777, co_shippriority#5754 AS co_shippriority_3#5778, co_comment#5755 AS co_comment_3#5779, co_orderdate#5756 AS co_orderdate_3#5780]
            :     :  +- Relation[rid#5733,cpfk_customer_orders#5734,cfpk_orders_customer#5735,cval_orders_o_orderstatus#5736,cval_orders_o_totalprice#5737,cval_orders_o_orderpriority#5738,cval_orders_o_clerk#5739,cval_orders_o_shippriority#5740,cval_orders_o_comment#5741,cval_orders_o_orderdate#5742,cdepval_orders_o_orderstatus#5743,cdepval_orders_o_totalprice#5744,cdepval_orders_o_orderpriority#5745,cdepval_orders_o_clerk#5746,cdepval_orders_o_shippriority#5747,cdepval_orders_o_comment#5748,cdepval_orders_o_orderdate#5749,co_orderstatus#5750,co_totalprice#5751,co_orderpriority#5752,co_clerk#5753,co_shippriority#5754,co_comment#5755,co_orderdate#5756] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#5691 AS rid_2#5712, cpfk_nation_customer#5692 AS cpfk_nation_customer_2#5713, cfpk_customer_nation#5693 AS cfpk_customer_nation_2#5714, cval_customer_c_name#5694 AS cval_customer_c_name_2#5715, cval_customer_c_address#5695 AS cval_customer_c_address_2#5716, cval_customer_c_phone#5696 AS cval_customer_c_phone_2#5717, cval_customer_c_acctbal#5697 AS cval_customer_c_acctbal_2#5718, cval_customer_c_comment#5698 AS cval_customer_c_comment_2#5719, cval_customer_c_mktsegment#5699 AS cval_customer_c_mktsegment_2#5720, cdepval_customer_c_name#5700 AS cdepval_customer_c_name_2#5721, cdepval_customer_c_address#5701 AS cdepval_customer_c_address_2#5722, cdepval_customer_c_phone#5702 AS cdepval_customer_c_phone_2#5723, cdepval_customer_c_acctbal#5703 AS cdepval_customer_c_acctbal_2#5724, cdepval_customer_c_comment#5704 AS cdepval_customer_c_comment_2#5725, cdepval_customer_c_mktsegment#5705 AS cdepval_customer_c_mktsegment_2#5726, cc_name#5706 AS cc_name_2#5727, cc_address#5707 AS cc_address_2#5728, cc_phone#5708 AS cc_phone_2#5729, cc_acctbal#5709 AS cc_acctbal_2#5730, cc_comment#5710 AS cc_comment_2#5731, cc_mktsegment#5711 AS cc_mktsegment_2#5732]
            :        :  +- Relation[rid#5691,cpfk_nation_customer#5692,cfpk_customer_nation#5693,cval_customer_c_name#5694,cval_customer_c_address#5695,cval_customer_c_phone#5696,cval_customer_c_acctbal#5697,cval_customer_c_comment#5698,cval_customer_c_mktsegment#5699,cdepval_customer_c_name#5700,cdepval_customer_c_address#5701,cdepval_customer_c_phone#5702,cdepval_customer_c_acctbal#5703,cdepval_customer_c_comment#5704,cdepval_customer_c_mktsegment#5705,cc_name#5706,cc_address#5707,cc_phone#5708,cc_acctbal#5709,cc_comment#5710,cc_mktsegment#5711] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
            :           :- Project [rid#5673 AS rid_1#5682, cpfk_region_nation#5674 AS cpfk_region_nation_1#5683, cfpk_nation_region#5675 AS cfpk_nation_region_1#5684, cval_nation_n_name#5676 AS cval_nation_n_name_1#5685, cval_nation_n_comment#5677 AS cval_nation_n_comment_1#5686, cdepval_nation_n_name#5678 AS cdepval_nation_n_name_1#5687, cdepval_nation_n_comment#5679 AS cdepval_nation_n_comment_1#5688, cn_name#5680 AS cn_name_1#5689, cn_comment#5681 AS cn_comment_1#5690]
            :           :  +- Relation[rid#5673,cpfk_region_nation#5674,cfpk_nation_region#5675,cval_nation_n_name#5676,cval_nation_n_comment#5677,cdepval_nation_n_name#5678,cdepval_nation_n_comment#5679,cn_name#5680,cn_comment#5681] JDBCRelation(tnation) [numPartitions=1]
            :           +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :              +- Project [rid#5645 AS rid_0#5652, cval_region_r_name#5646 AS cval_region_r_name_0#5653, cval_region_r_comment#5647 AS cval_region_r_comment_0#5654, cdepval_region_r_name#5648 AS cdepval_region_r_name_0#5655, cdepval_region_r_comment#5649 AS cdepval_region_r_comment_0#5656, cr_name#5650 AS cr_name_0#5657, cr_comment#5651 AS cr_comment_0#5658]
            :                 +- Relation[rid#5645,cval_region_r_name#5646,cval_region_r_comment#5647,cdepval_region_r_name#5648,cdepval_region_r_comment#5649,cr_name#5650,cr_comment#5651] JDBCRelation(tregion) [numPartitions=1]
            +- Project [rid#5871 AS rid_5#5889, cpfk_nation_supplier#5872 AS cpfk_nation_supplier_5#5890, cfpk_supplier_nation#5873 AS cfpk_supplier_nation_5#5891, cval_supplier_s_name#5874 AS cval_supplier_s_name_5#5892, cval_supplier_s_address#5875 AS cval_supplier_s_address_5#5893, cval_supplier_s_phone#5876 AS cval_supplier_s_phone_5#5894, cval_supplier_s_acctbal#5877 AS cval_supplier_s_acctbal_5#5895, cval_supplier_s_comment#5878 AS cval_supplier_s_comment_5#5896, cdepval_supplier_s_name#5879 AS cdepval_supplier_s_name_5#5897, cdepval_supplier_s_address#5880 AS cdepval_supplier_s_address_5#5898, cdepval_supplier_s_phone#5881 AS cdepval_supplier_s_phone_5#5899, cdepval_supplier_s_acctbal#5882 AS cdepval_supplier_s_acctbal_5#5900, cdepval_supplier_s_comment#5883 AS cdepval_supplier_s_comment_5#5901, cs_name#5884 AS cs_name_5#5902, cs_address#5885 AS cs_address_5#5903, cs_phone#5886 AS cs_phone_5#5904, cs_acctbal#5887 AS cs_acctbal_5#5905, cs_comment#5888 AS cs_comment_5#5906]
               +- Relation[rid#5871,cpfk_nation_supplier#5872,cfpk_supplier_nation#5873,cval_supplier_s_name#5874,cval_supplier_s_address#5875,cval_supplier_s_phone#5876,cval_supplier_s_acctbal#5877,cval_supplier_s_comment#5878,cdepval_supplier_s_name#5879,cdepval_supplier_s_address#5880,cdepval_supplier_s_phone#5881,cdepval_supplier_s_acctbal#5882,cdepval_supplier_s_comment#5883,cs_name#5884,cs_address#5885,cs_phone#5886,cs_acctbal#5887,cs_comment#5888] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 30769ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/25 22:26:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:26:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6038L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:26:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:26:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:26:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6038L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :- Project [rid#6140 AS rid_1#6154, cpfk_part_partsupp#6141 AS cpfk_part_partsupp_1#6155, cfpk_partsupp_part#6142 AS cfpk_partsupp_part_1#6156, cpfk_supplier_partsupp#6143 AS cpfk_supplier_partsupp_1#6157, cfpk_partsupp_supplier#6144 AS cfpk_partsupp_supplier_1#6158, cval_partsupp_ps_availqty#6145 AS cval_partsupp_ps_availqty_1#6159, cval_partsupp_ps_supplycost#6146 AS cval_partsupp_ps_supplycost_1#6160, cval_partsupp_ps_comment#6147 AS cval_partsupp_ps_comment_1#6161, cdepval_partsupp_ps_availqty#6148 AS cdepval_partsupp_ps_availqty_1#6162, cdepval_partsupp_ps_supplycost#6149 AS cdepval_partsupp_ps_supplycost_1#6163, cdepval_partsupp_ps_comment#6150 AS cdepval_partsupp_ps_comment_1#6164, cps_availqty#6151 AS cps_availqty_1#6165, cps_supplycost#6152 AS cps_supplycost_1#6166, cps_comment#6153 AS cps_comment_1#6167]
         :  +- Relation[rid#6140,cpfk_part_partsupp#6141,cfpk_partsupp_part#6142,cpfk_supplier_partsupp#6143,cfpk_partsupp_supplier#6144,cval_partsupp_ps_availqty#6145,cval_partsupp_ps_supplycost#6146,cval_partsupp_ps_comment#6147,cdepval_partsupp_ps_availqty#6148,cdepval_partsupp_ps_supplycost#6149,cdepval_partsupp_ps_comment#6150,cps_availqty#6151,cps_supplycost#6152,cps_comment#6153] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
            +- Project [rid#6040 AS rid_0#6065, cval_part_p_name#6041 AS cval_part_p_name_0#6066, cval_part_p_mfgr#6042 AS cval_part_p_mfgr_0#6067, cval_part_p_type#6043 AS cval_part_p_type_0#6068, cval_part_p_size#6044 AS cval_part_p_size_0#6069, cval_part_p_container#6045 AS cval_part_p_container_0#6070, cval_part_p_retailprice#6046 AS cval_part_p_retailprice_0#6071, cval_part_p_comment#6047 AS cval_part_p_comment_0#6072, cval_part_p_brand#6048 AS cval_part_p_brand_0#6073, cdepval_part_p_name#6049 AS cdepval_part_p_name_0#6074, cdepval_part_p_mfgr#6050 AS cdepval_part_p_mfgr_0#6075, cdepval_part_p_type#6051 AS cdepval_part_p_type_0#6076, cdepval_part_p_size#6052 AS cdepval_part_p_size_0#6077, cdepval_part_p_container#6053 AS cdepval_part_p_container_0#6078, cdepval_part_p_retailprice#6054 AS cdepval_part_p_retailprice_0#6079, cdepval_part_p_comment#6055 AS cdepval_part_p_comment_0#6080, cdepval_part_p_brand#6056 AS cdepval_part_p_brand_0#6081, cp_name#6057 AS cp_name_0#6082, cp_mfgr#6058 AS cp_mfgr_0#6083, cp_type#6059 AS cp_type_0#6084, cp_size#6060 AS cp_size_0#6085, cp_container#6061 AS cp_container_0#6086, cp_retailprice#6062 AS cp_retailprice_0#6087, cp_comment#6063 AS cp_comment_0#6088, cp_brand#6064 AS cp_brand_0#6089]
               +- Relation[rid#6040,cval_part_p_name#6041,cval_part_p_mfgr#6042,cval_part_p_type#6043,cval_part_p_size#6044,cval_part_p_container#6045,cval_part_p_retailprice#6046,cval_part_p_comment#6047,cval_part_p_brand#6048,cdepval_part_p_name#6049,cdepval_part_p_mfgr#6050,cdepval_part_p_type#6051,cdepval_part_p_size#6052,cdepval_part_p_container#6053,cdepval_part_p_retailprice#6054,cdepval_part_p_comment#6055,cdepval_part_p_brand#6056,cp_name#6057,cp_mfgr#6058,cp_type#6059,cp_size#6060,cp_container#6061,cp_retailprice#6062,cp_comment#6063,cp_brand#6064] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 3389ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/25 22:26:19 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:26:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6214L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:26:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:26:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:26:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:26:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:26:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:26:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:26:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:26:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:26:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:26:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:26:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:26:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:26:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6214L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :  :  :  :- Project [rid#6316 AS rid_1#6361, cpfk_orders_lineitem#6317 AS cpfk_orders_lineitem_1#6362, cpfk_supplier_lineitem#6318 AS cpfk_supplier_lineitem_1#6363, cfpk_lineitem_supplier#6319 AS cfpk_lineitem_supplier_1#6364, cfpk_lineitem_partsupp#6320 AS cfpk_lineitem_partsupp_1#6365, cpfk_part_lineitem#6321 AS cpfk_part_lineitem_1#6366, cfpk_lineitem_part#6322 AS cfpk_lineitem_part_1#6367, cpfk_partsupp_lineitem#6323 AS cpfk_partsupp_lineitem_1#6368, cfpk_lineitem_orders#6324 AS cfpk_lineitem_orders_1#6369, cval_lineitem_l_quantity#6325 AS cval_lineitem_l_quantity_1#6370, cval_lineitem_l_extendedprice#6326 AS cval_lineitem_l_extendedprice_1#6371, cval_lineitem_l_discount#6327 AS cval_lineitem_l_discount_1#6372, cval_lineitem_l_tax#6328 AS cval_lineitem_l_tax_1#6373, cval_lineitem_l_returnflag#6329 AS cval_lineitem_l_returnflag_1#6374, cval_lineitem_l_linestatus#6330 AS cval_lineitem_l_linestatus_1#6375, cval_lineitem_l_commitdate#6331 AS cval_lineitem_l_commitdate_1#6376, cval_lineitem_l_receiptdate#6332 AS cval_lineitem_l_receiptdate_1#6377, cval_lineitem_l_shipinstruct#6333 AS cval_lineitem_l_shipinstruct_1#6378, cval_lineitem_l_shipmode#6334 AS cval_lineitem_l_shipmode_1#6379, cval_lineitem_l_comment#6335 AS cval_lineitem_l_comment_1#6380, cval_lineitem_l_shipdate#6336 AS cval_lineitem_l_shipdate_1#6381, cdepval_lineitem_l_quantity#6337 AS cdepval_lineitem_l_quantity_1#6382, cdepval_lineitem_l_extendedprice#6338 AS cdepval_lineitem_l_extendedprice_1#6383, cdepval_lineitem_l_discount#6339 AS cdepval_lineitem_l_discount_1#6384, ... 21 more fields]
         :  :  :  :  +- Relation[rid#6316,cpfk_orders_lineitem#6317,cpfk_supplier_lineitem#6318,cfpk_lineitem_supplier#6319,cfpk_lineitem_partsupp#6320,cpfk_part_lineitem#6321,cfpk_lineitem_part#6322,cpfk_partsupp_lineitem#6323,cfpk_lineitem_orders#6324,cval_lineitem_l_quantity#6325,cval_lineitem_l_extendedprice#6326,cval_lineitem_l_discount#6327,cval_lineitem_l_tax#6328,cval_lineitem_l_returnflag#6329,cval_lineitem_l_linestatus#6330,cval_lineitem_l_commitdate#6331,cval_lineitem_l_receiptdate#6332,cval_lineitem_l_shipinstruct#6333,cval_lineitem_l_shipmode#6334,cval_lineitem_l_comment#6335,cval_lineitem_l_shipdate#6336,cdepval_lineitem_l_quantity#6337,cdepval_lineitem_l_extendedprice#6338,cdepval_lineitem_l_discount#6339,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :     +- Project [rid#6216 AS rid_0#6241, cval_part_p_name#6217 AS cval_part_p_name_0#6242, cval_part_p_mfgr#6218 AS cval_part_p_mfgr_0#6243, cval_part_p_type#6219 AS cval_part_p_type_0#6244, cval_part_p_size#6220 AS cval_part_p_size_0#6245, cval_part_p_container#6221 AS cval_part_p_container_0#6246, cval_part_p_retailprice#6222 AS cval_part_p_retailprice_0#6247, cval_part_p_comment#6223 AS cval_part_p_comment_0#6248, cval_part_p_brand#6224 AS cval_part_p_brand_0#6249, cdepval_part_p_name#6225 AS cdepval_part_p_name_0#6250, cdepval_part_p_mfgr#6226 AS cdepval_part_p_mfgr_0#6251, cdepval_part_p_type#6227 AS cdepval_part_p_type_0#6252, cdepval_part_p_size#6228 AS cdepval_part_p_size_0#6253, cdepval_part_p_container#6229 AS cdepval_part_p_container_0#6254, cdepval_part_p_retailprice#6230 AS cdepval_part_p_retailprice_0#6255, cdepval_part_p_comment#6231 AS cdepval_part_p_comment_0#6256, cdepval_part_p_brand#6232 AS cdepval_part_p_brand_0#6257, cp_name#6233 AS cp_name_0#6258, cp_mfgr#6234 AS cp_mfgr_0#6259, cp_type#6235 AS cp_type_0#6260, cp_size#6236 AS cp_size_0#6261, cp_container#6237 AS cp_container_0#6262, cp_retailprice#6238 AS cp_retailprice_0#6263, cp_comment#6239 AS cp_comment_0#6264, cp_brand#6240 AS cp_brand_0#6265]
         :  :  :        +- Relation[rid#6216,cval_part_p_name#6217,cval_part_p_mfgr#6218,cval_part_p_type#6219,cval_part_p_size#6220,cval_part_p_container#6221,cval_part_p_retailprice#6222,cval_part_p_comment#6223,cval_part_p_brand#6224,cdepval_part_p_name#6225,cdepval_part_p_mfgr#6226,cdepval_part_p_type#6227,cdepval_part_p_size#6228,cdepval_part_p_container#6229,cdepval_part_p_retailprice#6230,cdepval_part_p_comment#6231,cdepval_part_p_brand#6232,cp_name#6233,cp_mfgr#6234,cp_type#6235,cp_size#6236,cp_container#6237,cp_retailprice#6238,cp_comment#6239,cp_brand#6240] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- Project [rid#6406 AS rid_2#6424, cpfk_nation_supplier#6407 AS cpfk_nation_supplier_2#6425, cfpk_supplier_nation#6408 AS cfpk_supplier_nation_2#6426, cval_supplier_s_name#6409 AS cval_supplier_s_name_2#6427, cval_supplier_s_address#6410 AS cval_supplier_s_address_2#6428, cval_supplier_s_phone#6411 AS cval_supplier_s_phone_2#6429, cval_supplier_s_acctbal#6412 AS cval_supplier_s_acctbal_2#6430, cval_supplier_s_comment#6413 AS cval_supplier_s_comment_2#6431, cdepval_supplier_s_name#6414 AS cdepval_supplier_s_name_2#6432, cdepval_supplier_s_address#6415 AS cdepval_supplier_s_address_2#6433, cdepval_supplier_s_phone#6416 AS cdepval_supplier_s_phone_2#6434, cdepval_supplier_s_acctbal#6417 AS cdepval_supplier_s_acctbal_2#6435, cdepval_supplier_s_comment#6418 AS cdepval_supplier_s_comment_2#6436, cs_name#6419 AS cs_name_2#6437, cs_address#6420 AS cs_address_2#6438, cs_phone#6421 AS cs_phone_2#6439, cs_acctbal#6422 AS cs_acctbal_2#6440, cs_comment#6423 AS cs_comment_2#6441]
         :  :     +- Relation[rid#6406,cpfk_nation_supplier#6407,cfpk_supplier_nation#6408,cval_supplier_s_name#6409,cval_supplier_s_address#6410,cval_supplier_s_phone#6411,cval_supplier_s_acctbal#6412,cval_supplier_s_comment#6413,cdepval_supplier_s_name#6414,cdepval_supplier_s_address#6415,cdepval_supplier_s_phone#6416,cdepval_supplier_s_acctbal#6417,cdepval_supplier_s_comment#6418,cs_name#6419,cs_address#6420,cs_phone#6421,cs_acctbal#6422,cs_comment#6423] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#6442 AS rid_3#6451, cpfk_region_nation#6443 AS cpfk_region_nation_3#6452, cfpk_nation_region#6444 AS cfpk_nation_region_3#6453, cval_nation_n_name#6445 AS cval_nation_n_name_3#6454, cval_nation_n_comment#6446 AS cval_nation_n_comment_3#6455, cdepval_nation_n_name#6447 AS cdepval_nation_n_name_3#6456, cdepval_nation_n_comment#6448 AS cdepval_nation_n_comment_3#6457, cn_name#6449 AS cn_name_3#6458, cn_comment#6450 AS cn_comment_3#6459]
         :     +- Relation[rid#6442,cpfk_region_nation#6443,cfpk_nation_region#6444,cval_nation_n_name#6445,cval_nation_n_comment#6446,cdepval_nation_n_name#6447,cdepval_nation_n_comment#6448,cn_name#6449,cn_comment#6450] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#6548 AS rid_7#6572, cpfk_customer_orders#6549 AS cpfk_customer_orders_7#6573, cfpk_orders_customer#6550 AS cfpk_orders_customer_7#6574, cval_orders_o_orderstatus#6551 AS cval_orders_o_orderstatus_7#6575, cval_orders_o_totalprice#6552 AS cval_orders_o_totalprice_7#6576, cval_orders_o_orderpriority#6553 AS cval_orders_o_orderpriority_7#6577, cval_orders_o_clerk#6554 AS cval_orders_o_clerk_7#6578, cval_orders_o_shippriority#6555 AS cval_orders_o_shippriority_7#6579, cval_orders_o_comment#6556 AS cval_orders_o_comment_7#6580, cval_orders_o_orderdate#6557 AS cval_orders_o_orderdate_7#6581, cdepval_orders_o_orderstatus#6558 AS cdepval_orders_o_orderstatus_7#6582, cdepval_orders_o_totalprice#6559 AS cdepval_orders_o_totalprice_7#6583, cdepval_orders_o_orderpriority#6560 AS cdepval_orders_o_orderpriority_7#6584, cdepval_orders_o_clerk#6561 AS cdepval_orders_o_clerk_7#6585, cdepval_orders_o_shippriority#6562 AS cdepval_orders_o_shippriority_7#6586, cdepval_orders_o_comment#6563 AS cdepval_orders_o_comment_7#6587, cdepval_orders_o_orderdate#6564 AS cdepval_orders_o_orderdate_7#6588, co_orderstatus#6565 AS co_orderstatus_7#6589, co_totalprice#6566 AS co_totalprice_7#6590, co_orderpriority#6567 AS co_orderpriority_7#6591, co_clerk#6568 AS co_clerk_7#6592, co_shippriority#6569 AS co_shippriority_7#6593, co_comment#6570 AS co_comment_7#6594, co_orderdate#6571 AS co_orderdate_7#6595]
            :  +- Relation[rid#6548,cpfk_customer_orders#6549,cfpk_orders_customer#6550,cval_orders_o_orderstatus#6551,cval_orders_o_totalprice#6552,cval_orders_o_orderpriority#6553,cval_orders_o_clerk#6554,cval_orders_o_shippriority#6555,cval_orders_o_comment#6556,cval_orders_o_orderdate#6557,cdepval_orders_o_orderstatus#6558,cdepval_orders_o_totalprice#6559,cdepval_orders_o_orderpriority#6560,cdepval_orders_o_clerk#6561,cdepval_orders_o_shippriority#6562,cdepval_orders_o_comment#6563,cdepval_orders_o_orderdate#6564,co_orderstatus#6565,co_totalprice#6566,co_orderpriority#6567,co_clerk#6568,co_shippriority#6569,co_comment#6570,co_orderdate#6571] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#6506 AS rid_6#6527, cpfk_nation_customer#6507 AS cpfk_nation_customer_6#6528, cfpk_customer_nation#6508 AS cfpk_customer_nation_6#6529, cval_customer_c_name#6509 AS cval_customer_c_name_6#6530, cval_customer_c_address#6510 AS cval_customer_c_address_6#6531, cval_customer_c_phone#6511 AS cval_customer_c_phone_6#6532, cval_customer_c_acctbal#6512 AS cval_customer_c_acctbal_6#6533, cval_customer_c_comment#6513 AS cval_customer_c_comment_6#6534, cval_customer_c_mktsegment#6514 AS cval_customer_c_mktsegment_6#6535, cdepval_customer_c_name#6515 AS cdepval_customer_c_name_6#6536, cdepval_customer_c_address#6516 AS cdepval_customer_c_address_6#6537, cdepval_customer_c_phone#6517 AS cdepval_customer_c_phone_6#6538, cdepval_customer_c_acctbal#6518 AS cdepval_customer_c_acctbal_6#6539, cdepval_customer_c_comment#6519 AS cdepval_customer_c_comment_6#6540, cdepval_customer_c_mktsegment#6520 AS cdepval_customer_c_mktsegment_6#6541, cc_name#6521 AS cc_name_6#6542, cc_address#6522 AS cc_address_6#6543, cc_phone#6523 AS cc_phone_6#6544, cc_acctbal#6524 AS cc_acctbal_6#6545, cc_comment#6525 AS cc_comment_6#6546, cc_mktsegment#6526 AS cc_mktsegment_6#6547]
               :  +- Relation[rid#6506,cpfk_nation_customer#6507,cfpk_customer_nation#6508,cval_customer_c_name#6509,cval_customer_c_address#6510,cval_customer_c_phone#6511,cval_customer_c_acctbal#6512,cval_customer_c_comment#6513,cval_customer_c_mktsegment#6514,cdepval_customer_c_name#6515,cdepval_customer_c_address#6516,cdepval_customer_c_phone#6517,cdepval_customer_c_acctbal#6518,cdepval_customer_c_comment#6519,cdepval_customer_c_mktsegment#6520,cc_name#6521,cc_address#6522,cc_phone#6523,cc_acctbal#6524,cc_comment#6525,cc_mktsegment#6526] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_5, BinaryType)), 'cfpk_nation_region_5) = 'rid_4)
                  :- Project [rid#6488 AS rid_5#6497, cpfk_region_nation#6489 AS cpfk_region_nation_5#6498, cfpk_nation_region#6490 AS cfpk_nation_region_5#6499, cval_nation_n_name#6491 AS cval_nation_n_name_5#6500, cval_nation_n_comment#6492 AS cval_nation_n_comment_5#6501, cdepval_nation_n_name#6493 AS cdepval_nation_n_name_5#6502, cdepval_nation_n_comment#6494 AS cdepval_nation_n_comment_5#6503, cn_name#6495 AS cn_name_5#6504, cn_comment#6496 AS cn_comment_5#6505]
                  :  +- Relation[rid#6488,cpfk_region_nation#6489,cfpk_nation_region#6490,cval_nation_n_name#6491,cval_nation_n_comment#6492,cdepval_nation_n_name#6493,cdepval_nation_n_comment#6494,cn_name#6495,cn_comment#6496] JDBCRelation(tnation) [numPartitions=1]
                  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                     +- Project [rid#6460 AS rid_4#6467, cval_region_r_name#6461 AS cval_region_r_name_4#6468, cval_region_r_comment#6462 AS cval_region_r_comment_4#6469, cdepval_region_r_name#6463 AS cdepval_region_r_name_4#6470, cdepval_region_r_comment#6464 AS cdepval_region_r_comment_4#6471, cr_name#6465 AS cr_name_4#6472, cr_comment#6466 AS cr_comment_4#6473]
                        +- Relation[rid#6460,cval_region_r_name#6461,cval_region_r_comment#6462,cdepval_region_r_name#6463,cdepval_region_r_comment#6464,cr_name#6465,cr_comment#6466] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 44650ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/25 22:27:04 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:27:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6760L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:27:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:27:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:27:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:27:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:27:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:27:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:27:04 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:27:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:27:04 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:27:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6760L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#6834 AS rid_2#6848, cpfk_part_partsupp#6835 AS cpfk_part_partsupp_2#6849, cfpk_partsupp_part#6836 AS cfpk_partsupp_part_2#6850, cpfk_supplier_partsupp#6837 AS cpfk_supplier_partsupp_2#6851, cfpk_partsupp_supplier#6838 AS cfpk_partsupp_supplier_2#6852, cval_partsupp_ps_availqty#6839 AS cval_partsupp_ps_availqty_2#6853, cval_partsupp_ps_supplycost#6840 AS cval_partsupp_ps_supplycost_2#6854, cval_partsupp_ps_comment#6841 AS cval_partsupp_ps_comment_2#6855, cdepval_partsupp_ps_availqty#6842 AS cdepval_partsupp_ps_availqty_2#6856, cdepval_partsupp_ps_supplycost#6843 AS cdepval_partsupp_ps_supplycost_2#6857, cdepval_partsupp_ps_comment#6844 AS cdepval_partsupp_ps_comment_2#6858, cps_availqty#6845 AS cps_availqty_2#6859, cps_supplycost#6846 AS cps_supplycost_2#6860, cps_comment#6847 AS cps_comment_2#6861]
         :  +- Relation[rid#6834,cpfk_part_partsupp#6835,cfpk_partsupp_part#6836,cpfk_supplier_partsupp#6837,cfpk_partsupp_supplier#6838,cval_partsupp_ps_availqty#6839,cval_partsupp_ps_supplycost#6840,cval_partsupp_ps_comment#6841,cdepval_partsupp_ps_availqty#6842,cdepval_partsupp_ps_supplycost#6843,cdepval_partsupp_ps_comment#6844,cps_availqty#6845,cps_supplycost#6846,cps_comment#6847] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
            :- Project [rid#6798 AS rid_1#6816, cpfk_nation_supplier#6799 AS cpfk_nation_supplier_1#6817, cfpk_supplier_nation#6800 AS cfpk_supplier_nation_1#6818, cval_supplier_s_name#6801 AS cval_supplier_s_name_1#6819, cval_supplier_s_address#6802 AS cval_supplier_s_address_1#6820, cval_supplier_s_phone#6803 AS cval_supplier_s_phone_1#6821, cval_supplier_s_acctbal#6804 AS cval_supplier_s_acctbal_1#6822, cval_supplier_s_comment#6805 AS cval_supplier_s_comment_1#6823, cdepval_supplier_s_name#6806 AS cdepval_supplier_s_name_1#6824, cdepval_supplier_s_address#6807 AS cdepval_supplier_s_address_1#6825, cdepval_supplier_s_phone#6808 AS cdepval_supplier_s_phone_1#6826, cdepval_supplier_s_acctbal#6809 AS cdepval_supplier_s_acctbal_1#6827, cdepval_supplier_s_comment#6810 AS cdepval_supplier_s_comment_1#6828, cs_name#6811 AS cs_name_1#6829, cs_address#6812 AS cs_address_1#6830, cs_phone#6813 AS cs_phone_1#6831, cs_acctbal#6814 AS cs_acctbal_1#6832, cs_comment#6815 AS cs_comment_1#6833]
            :  +- Relation[rid#6798,cpfk_nation_supplier#6799,cfpk_supplier_nation#6800,cval_supplier_s_name#6801,cval_supplier_s_address#6802,cval_supplier_s_phone#6803,cval_supplier_s_acctbal#6804,cval_supplier_s_comment#6805,cdepval_supplier_s_name#6806,cdepval_supplier_s_address#6807,cdepval_supplier_s_phone#6808,cdepval_supplier_s_acctbal#6809,cdepval_supplier_s_comment#6810,cs_name#6811,cs_address#6812,cs_phone#6813,cs_acctbal#6814,cs_comment#6815] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
               +- Project [rid#6762 AS rid_0#6771, cpfk_region_nation#6763 AS cpfk_region_nation_0#6772, cfpk_nation_region#6764 AS cfpk_nation_region_0#6773, cval_nation_n_name#6765 AS cval_nation_n_name_0#6774, cval_nation_n_comment#6766 AS cval_nation_n_comment_0#6775, cdepval_nation_n_name#6767 AS cdepval_nation_n_name_0#6776, cdepval_nation_n_comment#6768 AS cdepval_nation_n_comment_0#6777, cn_name#6769 AS cn_name_0#6778, cn_comment#6770 AS cn_comment_0#6779]
                  +- Relation[rid#6762,cpfk_region_nation#6763,cfpk_nation_region#6764,cval_nation_n_name#6765,cval_nation_n_comment#6766,cdepval_nation_n_name#6767,cdepval_nation_n_comment#6768,cn_name#6769,cn_comment#6770] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 3469ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/25 22:27:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:27:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6908L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:27:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#6908L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#6910 AS rid_0#6955, cpfk_orders_lineitem#6911 AS cpfk_orders_lineitem_0#6956, cpfk_supplier_lineitem#6912 AS cpfk_supplier_lineitem_0#6957, cfpk_lineitem_supplier#6913 AS cfpk_lineitem_supplier_0#6958, cfpk_lineitem_partsupp#6914 AS cfpk_lineitem_partsupp_0#6959, cpfk_part_lineitem#6915 AS cpfk_part_lineitem_0#6960, cfpk_lineitem_part#6916 AS cfpk_lineitem_part_0#6961, cpfk_partsupp_lineitem#6917 AS cpfk_partsupp_lineitem_0#6962, cfpk_lineitem_orders#6918 AS cfpk_lineitem_orders_0#6963, cval_lineitem_l_quantity#6919 AS cval_lineitem_l_quantity_0#6964, cval_lineitem_l_extendedprice#6920 AS cval_lineitem_l_extendedprice_0#6965, cval_lineitem_l_discount#6921 AS cval_lineitem_l_discount_0#6966, cval_lineitem_l_tax#6922 AS cval_lineitem_l_tax_0#6967, cval_lineitem_l_returnflag#6923 AS cval_lineitem_l_returnflag_0#6968, cval_lineitem_l_linestatus#6924 AS cval_lineitem_l_linestatus_0#6969, cval_lineitem_l_commitdate#6925 AS cval_lineitem_l_commitdate_0#6970, cval_lineitem_l_receiptdate#6926 AS cval_lineitem_l_receiptdate_0#6971, cval_lineitem_l_shipinstruct#6927 AS cval_lineitem_l_shipinstruct_0#6972, cval_lineitem_l_shipmode#6928 AS cval_lineitem_l_shipmode_0#6973, cval_lineitem_l_comment#6929 AS cval_lineitem_l_comment_0#6974, cval_lineitem_l_shipdate#6930 AS cval_lineitem_l_shipdate_0#6975, cdepval_lineitem_l_quantity#6931 AS cdepval_lineitem_l_quantity_0#6976, cdepval_lineitem_l_extendedprice#6932 AS cdepval_lineitem_l_extendedprice_0#6977, cdepval_lineitem_l_discount#6933 AS cdepval_lineitem_l_discount_0#6978, ... 21 more fields]
         +- Relation[rid#6910,cpfk_orders_lineitem#6911,cpfk_supplier_lineitem#6912,cfpk_lineitem_supplier#6913,cfpk_lineitem_partsupp#6914,cpfk_part_lineitem#6915,cfpk_lineitem_part#6916,cpfk_partsupp_lineitem#6917,cfpk_lineitem_orders#6918,cval_lineitem_l_quantity#6919,cval_lineitem_l_extendedprice#6920,cval_lineitem_l_discount#6921,cval_lineitem_l_tax#6922,cval_lineitem_l_returnflag#6923,cval_lineitem_l_linestatus#6924,cval_lineitem_l_commitdate#6925,cval_lineitem_l_receiptdate#6926,cval_lineitem_l_shipinstruct#6927,cval_lineitem_l_shipmode#6928,cval_lineitem_l_comment#6929,cval_lineitem_l_shipdate#6930,cdepval_lineitem_l_quantity#6931,cdepval_lineitem_l_extendedprice#6932,cdepval_lineitem_l_discount#6933,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2442ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 22:27:10 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:27:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7054L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:27:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:27:10 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:27:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:27:10 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:27:10 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:27:10 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:27:10 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:27:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7054L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#7110 AS rid_2#7155, cpfk_orders_lineitem#7111 AS cpfk_orders_lineitem_2#7156, cpfk_supplier_lineitem#7112 AS cpfk_supplier_lineitem_2#7157, cfpk_lineitem_supplier#7113 AS cfpk_lineitem_supplier_2#7158, cfpk_lineitem_partsupp#7114 AS cfpk_lineitem_partsupp_2#7159, cpfk_part_lineitem#7115 AS cpfk_part_lineitem_2#7160, cfpk_lineitem_part#7116 AS cfpk_lineitem_part_2#7161, cpfk_partsupp_lineitem#7117 AS cpfk_partsupp_lineitem_2#7162, cfpk_lineitem_orders#7118 AS cfpk_lineitem_orders_2#7163, cval_lineitem_l_quantity#7119 AS cval_lineitem_l_quantity_2#7164, cval_lineitem_l_extendedprice#7120 AS cval_lineitem_l_extendedprice_2#7165, cval_lineitem_l_discount#7121 AS cval_lineitem_l_discount_2#7166, cval_lineitem_l_tax#7122 AS cval_lineitem_l_tax_2#7167, cval_lineitem_l_returnflag#7123 AS cval_lineitem_l_returnflag_2#7168, cval_lineitem_l_linestatus#7124 AS cval_lineitem_l_linestatus_2#7169, cval_lineitem_l_commitdate#7125 AS cval_lineitem_l_commitdate_2#7170, cval_lineitem_l_receiptdate#7126 AS cval_lineitem_l_receiptdate_2#7171, cval_lineitem_l_shipinstruct#7127 AS cval_lineitem_l_shipinstruct_2#7172, cval_lineitem_l_shipmode#7128 AS cval_lineitem_l_shipmode_2#7173, cval_lineitem_l_comment#7129 AS cval_lineitem_l_comment_2#7174, cval_lineitem_l_shipdate#7130 AS cval_lineitem_l_shipdate_2#7175, cdepval_lineitem_l_quantity#7131 AS cdepval_lineitem_l_quantity_2#7176, cdepval_lineitem_l_extendedprice#7132 AS cdepval_lineitem_l_extendedprice_2#7177, cdepval_lineitem_l_discount#7133 AS cdepval_lineitem_l_discount_2#7178, ... 21 more fields]
         :  :  :  :  +- Relation[rid#7110,cpfk_orders_lineitem#7111,cpfk_supplier_lineitem#7112,cfpk_lineitem_supplier#7113,cfpk_lineitem_partsupp#7114,cpfk_part_lineitem#7115,cfpk_lineitem_part#7116,cpfk_partsupp_lineitem#7117,cfpk_lineitem_orders#7118,cval_lineitem_l_quantity#7119,cval_lineitem_l_extendedprice#7120,cval_lineitem_l_discount#7121,cval_lineitem_l_tax#7122,cval_lineitem_l_returnflag#7123,cval_lineitem_l_linestatus#7124,cval_lineitem_l_commitdate#7125,cval_lineitem_l_receiptdate#7126,cval_lineitem_l_shipinstruct#7127,cval_lineitem_l_shipmode#7128,cval_lineitem_l_comment#7129,cval_lineitem_l_shipdate#7130,cdepval_lineitem_l_quantity#7131,cdepval_lineitem_l_extendedprice#7132,cdepval_lineitem_l_discount#7133,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#7074 AS rid_1#7092, cpfk_nation_supplier#7075 AS cpfk_nation_supplier_1#7093, cfpk_supplier_nation#7076 AS cfpk_supplier_nation_1#7094, cval_supplier_s_name#7077 AS cval_supplier_s_name_1#7095, cval_supplier_s_address#7078 AS cval_supplier_s_address_1#7096, cval_supplier_s_phone#7079 AS cval_supplier_s_phone_1#7097, cval_supplier_s_acctbal#7080 AS cval_supplier_s_acctbal_1#7098, cval_supplier_s_comment#7081 AS cval_supplier_s_comment_1#7099, cdepval_supplier_s_name#7082 AS cdepval_supplier_s_name_1#7100, cdepval_supplier_s_address#7083 AS cdepval_supplier_s_address_1#7101, cdepval_supplier_s_phone#7084 AS cdepval_supplier_s_phone_1#7102, cdepval_supplier_s_acctbal#7085 AS cdepval_supplier_s_acctbal_1#7103, cdepval_supplier_s_comment#7086 AS cdepval_supplier_s_comment_1#7104, cs_name#7087 AS cs_name_1#7105, cs_address#7088 AS cs_address_1#7106, cs_phone#7089 AS cs_phone_1#7107, cs_acctbal#7090 AS cs_acctbal_1#7108, cs_comment#7091 AS cs_comment_1#7109]
         :  :  :     :  +- Relation[rid#7074,cpfk_nation_supplier#7075,cfpk_supplier_nation#7076,cval_supplier_s_name#7077,cval_supplier_s_address#7078,cval_supplier_s_phone#7079,cval_supplier_s_acctbal#7080,cval_supplier_s_comment#7081,cdepval_supplier_s_name#7082,cdepval_supplier_s_address#7083,cdepval_supplier_s_phone#7084,cdepval_supplier_s_acctbal#7085,cdepval_supplier_s_comment#7086,cs_name#7087,cs_address#7088,cs_phone#7089,cs_acctbal#7090,cs_comment#7091] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#7056 AS rid_0#7065, cpfk_region_nation#7057 AS cpfk_region_nation_0#7066, cfpk_nation_region#7058 AS cfpk_nation_region_0#7067, cval_nation_n_name#7059 AS cval_nation_n_name_0#7068, cval_nation_n_comment#7060 AS cval_nation_n_comment_0#7069, cdepval_nation_n_name#7061 AS cdepval_nation_n_name_0#7070, cdepval_nation_n_comment#7062 AS cdepval_nation_n_comment_0#7071, cn_name#7063 AS cn_name_0#7072, cn_comment#7064 AS cn_comment_0#7073]
         :  :  :        +- Relation[rid#7056,cpfk_region_nation#7057,cfpk_nation_region#7058,cval_nation_n_name#7059,cval_nation_n_comment#7060,cdepval_nation_n_name#7061,cdepval_nation_n_comment#7062,cn_name#7063,cn_comment#7064] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#7200 AS rid_3#7225, cval_part_p_name#7201 AS cval_part_p_name_3#7226, cval_part_p_mfgr#7202 AS cval_part_p_mfgr_3#7227, cval_part_p_type#7203 AS cval_part_p_type_3#7228, cval_part_p_size#7204 AS cval_part_p_size_3#7229, cval_part_p_container#7205 AS cval_part_p_container_3#7230, cval_part_p_retailprice#7206 AS cval_part_p_retailprice_3#7231, cval_part_p_comment#7207 AS cval_part_p_comment_3#7232, cval_part_p_brand#7208 AS cval_part_p_brand_3#7233, cdepval_part_p_name#7209 AS cdepval_part_p_name_3#7234, cdepval_part_p_mfgr#7210 AS cdepval_part_p_mfgr_3#7235, cdepval_part_p_type#7211 AS cdepval_part_p_type_3#7236, cdepval_part_p_size#7212 AS cdepval_part_p_size_3#7237, cdepval_part_p_container#7213 AS cdepval_part_p_container_3#7238, cdepval_part_p_retailprice#7214 AS cdepval_part_p_retailprice_3#7239, cdepval_part_p_comment#7215 AS cdepval_part_p_comment_3#7240, cdepval_part_p_brand#7216 AS cdepval_part_p_brand_3#7241, cp_name#7217 AS cp_name_3#7242, cp_mfgr#7218 AS cp_mfgr_3#7243, cp_type#7219 AS cp_type_3#7244, cp_size#7220 AS cp_size_3#7245, cp_container#7221 AS cp_container_3#7246, cp_retailprice#7222 AS cp_retailprice_3#7247, cp_comment#7223 AS cp_comment_3#7248, cp_brand#7224 AS cp_brand_3#7249]
         :  :     +- Relation[rid#7200,cval_part_p_name#7201,cval_part_p_mfgr#7202,cval_part_p_type#7203,cval_part_p_size#7204,cval_part_p_container#7205,cval_part_p_retailprice#7206,cval_part_p_comment#7207,cval_part_p_brand#7208,cdepval_part_p_name#7209,cdepval_part_p_mfgr#7210,cdepval_part_p_type#7211,cdepval_part_p_size#7212,cdepval_part_p_container#7213,cdepval_part_p_retailprice#7214,cdepval_part_p_comment#7215,cdepval_part_p_brand#7216,cp_name#7217,cp_mfgr#7218,cp_type#7219,cp_size#7220,cp_container#7221,cp_retailprice#7222,cp_comment#7223,cp_brand#7224] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#7250 AS rid_4#7264, cpfk_part_partsupp#7251 AS cpfk_part_partsupp_4#7265, cfpk_partsupp_part#7252 AS cfpk_partsupp_part_4#7266, cpfk_supplier_partsupp#7253 AS cpfk_supplier_partsupp_4#7267, cfpk_partsupp_supplier#7254 AS cfpk_partsupp_supplier_4#7268, cval_partsupp_ps_availqty#7255 AS cval_partsupp_ps_availqty_4#7269, cval_partsupp_ps_supplycost#7256 AS cval_partsupp_ps_supplycost_4#7270, cval_partsupp_ps_comment#7257 AS cval_partsupp_ps_comment_4#7271, cdepval_partsupp_ps_availqty#7258 AS cdepval_partsupp_ps_availqty_4#7272, cdepval_partsupp_ps_supplycost#7259 AS cdepval_partsupp_ps_supplycost_4#7273, cdepval_partsupp_ps_comment#7260 AS cdepval_partsupp_ps_comment_4#7274, cps_availqty#7261 AS cps_availqty_4#7275, cps_supplycost#7262 AS cps_supplycost_4#7276, cps_comment#7263 AS cps_comment_4#7277]
         :     +- Relation[rid#7250,cpfk_part_partsupp#7251,cfpk_partsupp_part#7252,cpfk_supplier_partsupp#7253,cfpk_partsupp_supplier#7254,cval_partsupp_ps_availqty#7255,cval_partsupp_ps_supplycost#7256,cval_partsupp_ps_comment#7257,cdepval_partsupp_ps_availqty#7258,cdepval_partsupp_ps_supplycost#7259,cdepval_partsupp_ps_comment#7260,cps_availqty#7261,cps_supplycost#7262,cps_comment#7263] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#7278 AS rid_5#7302, cpfk_customer_orders#7279 AS cpfk_customer_orders_5#7303, cfpk_orders_customer#7280 AS cfpk_orders_customer_5#7304, cval_orders_o_orderstatus#7281 AS cval_orders_o_orderstatus_5#7305, cval_orders_o_totalprice#7282 AS cval_orders_o_totalprice_5#7306, cval_orders_o_orderpriority#7283 AS cval_orders_o_orderpriority_5#7307, cval_orders_o_clerk#7284 AS cval_orders_o_clerk_5#7308, cval_orders_o_shippriority#7285 AS cval_orders_o_shippriority_5#7309, cval_orders_o_comment#7286 AS cval_orders_o_comment_5#7310, cval_orders_o_orderdate#7287 AS cval_orders_o_orderdate_5#7311, cdepval_orders_o_orderstatus#7288 AS cdepval_orders_o_orderstatus_5#7312, cdepval_orders_o_totalprice#7289 AS cdepval_orders_o_totalprice_5#7313, cdepval_orders_o_orderpriority#7290 AS cdepval_orders_o_orderpriority_5#7314, cdepval_orders_o_clerk#7291 AS cdepval_orders_o_clerk_5#7315, cdepval_orders_o_shippriority#7292 AS cdepval_orders_o_shippriority_5#7316, cdepval_orders_o_comment#7293 AS cdepval_orders_o_comment_5#7317, cdepval_orders_o_orderdate#7294 AS cdepval_orders_o_orderdate_5#7318, co_orderstatus#7295 AS co_orderstatus_5#7319, co_totalprice#7296 AS co_totalprice_5#7320, co_orderpriority#7297 AS co_orderpriority_5#7321, co_clerk#7298 AS co_clerk_5#7322, co_shippriority#7299 AS co_shippriority_5#7323, co_comment#7300 AS co_comment_5#7324, co_orderdate#7301 AS co_orderdate_5#7325]
            +- Relation[rid#7278,cpfk_customer_orders#7279,cfpk_orders_customer#7280,cval_orders_o_orderstatus#7281,cval_orders_o_totalprice#7282,cval_orders_o_orderpriority#7283,cval_orders_o_clerk#7284,cval_orders_o_shippriority#7285,cval_orders_o_comment#7286,cval_orders_o_orderdate#7287,cdepval_orders_o_orderstatus#7288,cdepval_orders_o_totalprice#7289,cdepval_orders_o_orderpriority#7290,cdepval_orders_o_clerk#7291,cdepval_orders_o_shippriority#7292,cdepval_orders_o_comment#7293,cdepval_orders_o_orderdate#7294,co_orderstatus#7295,co_totalprice#7296,co_orderpriority#7297,co_clerk#7298,co_shippriority#7299,co_comment#7300,co_orderdate#7301] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 63628ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/25 22:28:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:28:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7468L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:28:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:28:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:28:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7468L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#7506 AS rid_1#7551, cpfk_orders_lineitem#7507 AS cpfk_orders_lineitem_1#7552, cpfk_supplier_lineitem#7508 AS cpfk_supplier_lineitem_1#7553, cfpk_lineitem_supplier#7509 AS cfpk_lineitem_supplier_1#7554, cfpk_lineitem_partsupp#7510 AS cfpk_lineitem_partsupp_1#7555, cpfk_part_lineitem#7511 AS cpfk_part_lineitem_1#7556, cfpk_lineitem_part#7512 AS cfpk_lineitem_part_1#7557, cpfk_partsupp_lineitem#7513 AS cpfk_partsupp_lineitem_1#7558, cfpk_lineitem_orders#7514 AS cfpk_lineitem_orders_1#7559, cval_lineitem_l_quantity#7515 AS cval_lineitem_l_quantity_1#7560, cval_lineitem_l_extendedprice#7516 AS cval_lineitem_l_extendedprice_1#7561, cval_lineitem_l_discount#7517 AS cval_lineitem_l_discount_1#7562, cval_lineitem_l_tax#7518 AS cval_lineitem_l_tax_1#7563, cval_lineitem_l_returnflag#7519 AS cval_lineitem_l_returnflag_1#7564, cval_lineitem_l_linestatus#7520 AS cval_lineitem_l_linestatus_1#7565, cval_lineitem_l_commitdate#7521 AS cval_lineitem_l_commitdate_1#7566, cval_lineitem_l_receiptdate#7522 AS cval_lineitem_l_receiptdate_1#7567, cval_lineitem_l_shipinstruct#7523 AS cval_lineitem_l_shipinstruct_1#7568, cval_lineitem_l_shipmode#7524 AS cval_lineitem_l_shipmode_1#7569, cval_lineitem_l_comment#7525 AS cval_lineitem_l_comment_1#7570, cval_lineitem_l_shipdate#7526 AS cval_lineitem_l_shipdate_1#7571, cdepval_lineitem_l_quantity#7527 AS cdepval_lineitem_l_quantity_1#7572, cdepval_lineitem_l_extendedprice#7528 AS cdepval_lineitem_l_extendedprice_1#7573, cdepval_lineitem_l_discount#7529 AS cdepval_lineitem_l_discount_1#7574, ... 21 more fields]
         :  +- Relation[rid#7506,cpfk_orders_lineitem#7507,cpfk_supplier_lineitem#7508,cfpk_lineitem_supplier#7509,cfpk_lineitem_partsupp#7510,cpfk_part_lineitem#7511,cfpk_lineitem_part#7512,cpfk_partsupp_lineitem#7513,cfpk_lineitem_orders#7514,cval_lineitem_l_quantity#7515,cval_lineitem_l_extendedprice#7516,cval_lineitem_l_discount#7517,cval_lineitem_l_tax#7518,cval_lineitem_l_returnflag#7519,cval_lineitem_l_linestatus#7520,cval_lineitem_l_commitdate#7521,cval_lineitem_l_receiptdate#7522,cval_lineitem_l_shipinstruct#7523,cval_lineitem_l_shipmode#7524,cval_lineitem_l_comment#7525,cval_lineitem_l_shipdate#7526,cdepval_lineitem_l_quantity#7527,cdepval_lineitem_l_extendedprice#7528,cdepval_lineitem_l_discount#7529,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7470 AS rid_0#7488, cpfk_nation_supplier#7471 AS cpfk_nation_supplier_0#7489, cfpk_supplier_nation#7472 AS cfpk_supplier_nation_0#7490, cval_supplier_s_name#7473 AS cval_supplier_s_name_0#7491, cval_supplier_s_address#7474 AS cval_supplier_s_address_0#7492, cval_supplier_s_phone#7475 AS cval_supplier_s_phone_0#7493, cval_supplier_s_acctbal#7476 AS cval_supplier_s_acctbal_0#7494, cval_supplier_s_comment#7477 AS cval_supplier_s_comment_0#7495, cdepval_supplier_s_name#7478 AS cdepval_supplier_s_name_0#7496, cdepval_supplier_s_address#7479 AS cdepval_supplier_s_address_0#7497, cdepval_supplier_s_phone#7480 AS cdepval_supplier_s_phone_0#7498, cdepval_supplier_s_acctbal#7481 AS cdepval_supplier_s_acctbal_0#7499, cdepval_supplier_s_comment#7482 AS cdepval_supplier_s_comment_0#7500, cs_name#7483 AS cs_name_0#7501, cs_address#7484 AS cs_address_0#7502, cs_phone#7485 AS cs_phone_0#7503, cs_acctbal#7486 AS cs_acctbal_0#7504, cs_comment#7487 AS cs_comment_0#7505]
            +- Relation[rid#7470,cpfk_nation_supplier#7471,cfpk_supplier_nation#7472,cval_supplier_s_name#7473,cval_supplier_s_address#7474,cval_supplier_s_phone#7475,cval_supplier_s_acctbal#7476,cval_supplier_s_comment#7477,cdepval_supplier_s_name#7478,cdepval_supplier_s_address#7479,cdepval_supplier_s_phone#7480,cdepval_supplier_s_acctbal#7481,cdepval_supplier_s_comment#7482,cs_name#7483,cs_address#7484,cs_phone#7485,cs_acctbal#7486,cs_comment#7487] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17193ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/25 22:28:31 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:28:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7667L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:28:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:28:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:28:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:28:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:28:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:28:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:28:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:28:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:28:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:28:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:28:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:28:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7667L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#7741 AS rid_2#7786, cpfk_orders_lineitem#7742 AS cpfk_orders_lineitem_2#7787, cpfk_supplier_lineitem#7743 AS cpfk_supplier_lineitem_2#7788, cfpk_lineitem_supplier#7744 AS cfpk_lineitem_supplier_2#7789, cfpk_lineitem_partsupp#7745 AS cfpk_lineitem_partsupp_2#7790, cpfk_part_lineitem#7746 AS cpfk_part_lineitem_2#7791, cfpk_lineitem_part#7747 AS cfpk_lineitem_part_2#7792, cpfk_partsupp_lineitem#7748 AS cpfk_partsupp_lineitem_2#7793, cfpk_lineitem_orders#7749 AS cfpk_lineitem_orders_2#7794, cval_lineitem_l_quantity#7750 AS cval_lineitem_l_quantity_2#7795, cval_lineitem_l_extendedprice#7751 AS cval_lineitem_l_extendedprice_2#7796, cval_lineitem_l_discount#7752 AS cval_lineitem_l_discount_2#7797, cval_lineitem_l_tax#7753 AS cval_lineitem_l_tax_2#7798, cval_lineitem_l_returnflag#7754 AS cval_lineitem_l_returnflag_2#7799, cval_lineitem_l_linestatus#7755 AS cval_lineitem_l_linestatus_2#7800, cval_lineitem_l_commitdate#7756 AS cval_lineitem_l_commitdate_2#7801, cval_lineitem_l_receiptdate#7757 AS cval_lineitem_l_receiptdate_2#7802, cval_lineitem_l_shipinstruct#7758 AS cval_lineitem_l_shipinstruct_2#7803, cval_lineitem_l_shipmode#7759 AS cval_lineitem_l_shipmode_2#7804, cval_lineitem_l_comment#7760 AS cval_lineitem_l_comment_2#7805, cval_lineitem_l_shipdate#7761 AS cval_lineitem_l_shipdate_2#7806, cdepval_lineitem_l_quantity#7762 AS cdepval_lineitem_l_quantity_2#7807, cdepval_lineitem_l_extendedprice#7763 AS cdepval_lineitem_l_extendedprice_2#7808, cdepval_lineitem_l_discount#7764 AS cdepval_lineitem_l_discount_2#7809, ... 21 more fields]
         :  :  +- Relation[rid#7741,cpfk_orders_lineitem#7742,cpfk_supplier_lineitem#7743,cfpk_lineitem_supplier#7744,cfpk_lineitem_partsupp#7745,cpfk_part_lineitem#7746,cfpk_lineitem_part#7747,cpfk_partsupp_lineitem#7748,cfpk_lineitem_orders#7749,cval_lineitem_l_quantity#7750,cval_lineitem_l_extendedprice#7751,cval_lineitem_l_discount#7752,cval_lineitem_l_tax#7753,cval_lineitem_l_returnflag#7754,cval_lineitem_l_linestatus#7755,cval_lineitem_l_commitdate#7756,cval_lineitem_l_receiptdate#7757,cval_lineitem_l_shipinstruct#7758,cval_lineitem_l_shipmode#7759,cval_lineitem_l_comment#7760,cval_lineitem_l_shipdate#7761,cdepval_lineitem_l_quantity#7762,cdepval_lineitem_l_extendedprice#7763,cdepval_lineitem_l_discount#7764,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :- Project [rid#7705 AS rid_1#7723, cpfk_nation_supplier#7706 AS cpfk_nation_supplier_1#7724, cfpk_supplier_nation#7707 AS cfpk_supplier_nation_1#7725, cval_supplier_s_name#7708 AS cval_supplier_s_name_1#7726, cval_supplier_s_address#7709 AS cval_supplier_s_address_1#7727, cval_supplier_s_phone#7710 AS cval_supplier_s_phone_1#7728, cval_supplier_s_acctbal#7711 AS cval_supplier_s_acctbal_1#7729, cval_supplier_s_comment#7712 AS cval_supplier_s_comment_1#7730, cdepval_supplier_s_name#7713 AS cdepval_supplier_s_name_1#7731, cdepval_supplier_s_address#7714 AS cdepval_supplier_s_address_1#7732, cdepval_supplier_s_phone#7715 AS cdepval_supplier_s_phone_1#7733, cdepval_supplier_s_acctbal#7716 AS cdepval_supplier_s_acctbal_1#7734, cdepval_supplier_s_comment#7717 AS cdepval_supplier_s_comment_1#7735, cs_name#7718 AS cs_name_1#7736, cs_address#7719 AS cs_address_1#7737, cs_phone#7720 AS cs_phone_1#7738, cs_acctbal#7721 AS cs_acctbal_1#7739, cs_comment#7722 AS cs_comment_1#7740]
         :     :  +- Relation[rid#7705,cpfk_nation_supplier#7706,cfpk_supplier_nation#7707,cval_supplier_s_name#7708,cval_supplier_s_address#7709,cval_supplier_s_phone#7710,cval_supplier_s_acctbal#7711,cval_supplier_s_comment#7712,cdepval_supplier_s_name#7713,cdepval_supplier_s_address#7714,cdepval_supplier_s_phone#7715,cdepval_supplier_s_acctbal#7716,cdepval_supplier_s_comment#7717,cs_name#7718,cs_address#7719,cs_phone#7720,cs_acctbal#7721,cs_comment#7722] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :        +- Project [rid#7669 AS rid_0#7678, cpfk_region_nation#7670 AS cpfk_region_nation_0#7679, cfpk_nation_region#7671 AS cfpk_nation_region_0#7680, cval_nation_n_name#7672 AS cval_nation_n_name_0#7681, cval_nation_n_comment#7673 AS cval_nation_n_comment_0#7682, cdepval_nation_n_name#7674 AS cdepval_nation_n_name_0#7683, cdepval_nation_n_comment#7675 AS cdepval_nation_n_comment_0#7684, cn_name#7676 AS cn_name_0#7685, cn_comment#7677 AS cn_comment_0#7686]
         :           +- Relation[rid#7669,cpfk_region_nation#7670,cfpk_nation_region#7671,cval_nation_n_name#7672,cval_nation_n_comment#7673,cdepval_nation_n_name#7674,cdepval_nation_n_comment#7675,cn_name#7676,cn_comment#7677] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#7909 AS rid_5#7933, cpfk_customer_orders#7910 AS cpfk_customer_orders_5#7934, cfpk_orders_customer#7911 AS cfpk_orders_customer_5#7935, cval_orders_o_orderstatus#7912 AS cval_orders_o_orderstatus_5#7936, cval_orders_o_totalprice#7913 AS cval_orders_o_totalprice_5#7937, cval_orders_o_orderpriority#7914 AS cval_orders_o_orderpriority_5#7938, cval_orders_o_clerk#7915 AS cval_orders_o_clerk_5#7939, cval_orders_o_shippriority#7916 AS cval_orders_o_shippriority_5#7940, cval_orders_o_comment#7917 AS cval_orders_o_comment_5#7941, cval_orders_o_orderdate#7918 AS cval_orders_o_orderdate_5#7942, cdepval_orders_o_orderstatus#7919 AS cdepval_orders_o_orderstatus_5#7943, cdepval_orders_o_totalprice#7920 AS cdepval_orders_o_totalprice_5#7944, cdepval_orders_o_orderpriority#7921 AS cdepval_orders_o_orderpriority_5#7945, cdepval_orders_o_clerk#7922 AS cdepval_orders_o_clerk_5#7946, cdepval_orders_o_shippriority#7923 AS cdepval_orders_o_shippriority_5#7947, cdepval_orders_o_comment#7924 AS cdepval_orders_o_comment_5#7948, cdepval_orders_o_orderdate#7925 AS cdepval_orders_o_orderdate_5#7949, co_orderstatus#7926 AS co_orderstatus_5#7950, co_totalprice#7927 AS co_totalprice_5#7951, co_orderpriority#7928 AS co_orderpriority_5#7952, co_clerk#7929 AS co_clerk_5#7953, co_shippriority#7930 AS co_shippriority_5#7954, co_comment#7931 AS co_comment_5#7955, co_orderdate#7932 AS co_orderdate_5#7956]
            :  +- Relation[rid#7909,cpfk_customer_orders#7910,cfpk_orders_customer#7911,cval_orders_o_orderstatus#7912,cval_orders_o_totalprice#7913,cval_orders_o_orderpriority#7914,cval_orders_o_clerk#7915,cval_orders_o_shippriority#7916,cval_orders_o_comment#7917,cval_orders_o_orderdate#7918,cdepval_orders_o_orderstatus#7919,cdepval_orders_o_totalprice#7920,cdepval_orders_o_orderpriority#7921,cdepval_orders_o_clerk#7922,cdepval_orders_o_shippriority#7923,cdepval_orders_o_comment#7924,cdepval_orders_o_orderdate#7925,co_orderstatus#7926,co_totalprice#7927,co_orderpriority#7928,co_clerk#7929,co_shippriority#7930,co_comment#7931,co_orderdate#7932] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_4, BinaryType)), 'cfpk_customer_nation_4) = 'rid_3)
               :- Project [rid#7867 AS rid_4#7888, cpfk_nation_customer#7868 AS cpfk_nation_customer_4#7889, cfpk_customer_nation#7869 AS cfpk_customer_nation_4#7890, cval_customer_c_name#7870 AS cval_customer_c_name_4#7891, cval_customer_c_address#7871 AS cval_customer_c_address_4#7892, cval_customer_c_phone#7872 AS cval_customer_c_phone_4#7893, cval_customer_c_acctbal#7873 AS cval_customer_c_acctbal_4#7894, cval_customer_c_comment#7874 AS cval_customer_c_comment_4#7895, cval_customer_c_mktsegment#7875 AS cval_customer_c_mktsegment_4#7896, cdepval_customer_c_name#7876 AS cdepval_customer_c_name_4#7897, cdepval_customer_c_address#7877 AS cdepval_customer_c_address_4#7898, cdepval_customer_c_phone#7878 AS cdepval_customer_c_phone_4#7899, cdepval_customer_c_acctbal#7879 AS cdepval_customer_c_acctbal_4#7900, cdepval_customer_c_comment#7880 AS cdepval_customer_c_comment_4#7901, cdepval_customer_c_mktsegment#7881 AS cdepval_customer_c_mktsegment_4#7902, cc_name#7882 AS cc_name_4#7903, cc_address#7883 AS cc_address_4#7904, cc_phone#7884 AS cc_phone_4#7905, cc_acctbal#7885 AS cc_acctbal_4#7906, cc_comment#7886 AS cc_comment_4#7907, cc_mktsegment#7887 AS cc_mktsegment_4#7908]
               :  +- Relation[rid#7867,cpfk_nation_customer#7868,cfpk_customer_nation#7869,cval_customer_c_name#7870,cval_customer_c_address#7871,cval_customer_c_phone#7872,cval_customer_c_acctbal#7873,cval_customer_c_comment#7874,cval_customer_c_mktsegment#7875,cdepval_customer_c_name#7876,cdepval_customer_c_address#7877,cdepval_customer_c_phone#7878,cdepval_customer_c_acctbal#7879,cdepval_customer_c_comment#7880,cdepval_customer_c_mktsegment#7881,cc_name#7882,cc_address#7883,cc_phone#7884,cc_acctbal#7885,cc_comment#7886,cc_mktsegment#7887] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
                  +- Project [rid#7831 AS rid_3#7840, cpfk_region_nation#7832 AS cpfk_region_nation_3#7841, cfpk_nation_region#7833 AS cfpk_nation_region_3#7842, cval_nation_n_name#7834 AS cval_nation_n_name_3#7843, cval_nation_n_comment#7835 AS cval_nation_n_comment_3#7844, cdepval_nation_n_name#7836 AS cdepval_nation_n_name_3#7845, cdepval_nation_n_comment#7837 AS cdepval_nation_n_comment_3#7846, cn_name#7838 AS cn_name_3#7847, cn_comment#7839 AS cn_comment_3#7848]
                     +- Relation[rid#7831,cpfk_region_nation#7832,cfpk_nation_region#7833,cval_nation_n_name#7834,cval_nation_n_comment#7835,cdepval_nation_n_name#7836,cdepval_nation_n_comment#7837,cn_name#7838,cn_comment#7839] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 34800ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/25 22:29:06 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:29:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8087L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:29:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:29:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:29:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:29:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:29:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:29:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:29:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:29:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:29:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:29:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:29:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:29:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:29:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:29:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8087L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_part_4) = 'rid_3)
         :  :- Project [rid#8271 AS rid_4#8285, cpfk_part_partsupp#8272 AS cpfk_part_partsupp_4#8286, cfpk_partsupp_part#8273 AS cfpk_partsupp_part_4#8287, cpfk_supplier_partsupp#8274 AS cpfk_supplier_partsupp_4#8288, cfpk_partsupp_supplier#8275 AS cfpk_partsupp_supplier_4#8289, cval_partsupp_ps_availqty#8276 AS cval_partsupp_ps_availqty_4#8290, cval_partsupp_ps_supplycost#8277 AS cval_partsupp_ps_supplycost_4#8291, cval_partsupp_ps_comment#8278 AS cval_partsupp_ps_comment_4#8292, cdepval_partsupp_ps_availqty#8279 AS cdepval_partsupp_ps_availqty_4#8293, cdepval_partsupp_ps_supplycost#8280 AS cdepval_partsupp_ps_supplycost_4#8294, cdepval_partsupp_ps_comment#8281 AS cdepval_partsupp_ps_comment_4#8295, cps_availqty#8282 AS cps_availqty_4#8296, cps_supplycost#8283 AS cps_supplycost_4#8297, cps_comment#8284 AS cps_comment_4#8298]
         :  :  +- Relation[rid#8271,cpfk_part_partsupp#8272,cfpk_partsupp_part#8273,cpfk_supplier_partsupp#8274,cfpk_partsupp_supplier#8275,cval_partsupp_ps_availqty#8276,cval_partsupp_ps_supplycost#8277,cval_partsupp_ps_comment#8278,cdepval_partsupp_ps_availqty#8279,cdepval_partsupp_ps_supplycost#8280,cdepval_partsupp_ps_comment#8281,cps_availqty#8282,cps_supplycost#8283,cps_comment#8284] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :     +- Project [rid#8171 AS rid_3#8196, cval_part_p_name#8172 AS cval_part_p_name_3#8197, cval_part_p_mfgr#8173 AS cval_part_p_mfgr_3#8198, cval_part_p_type#8174 AS cval_part_p_type_3#8199, cval_part_p_size#8175 AS cval_part_p_size_3#8200, cval_part_p_container#8176 AS cval_part_p_container_3#8201, cval_part_p_retailprice#8177 AS cval_part_p_retailprice_3#8202, cval_part_p_comment#8178 AS cval_part_p_comment_3#8203, cval_part_p_brand#8179 AS cval_part_p_brand_3#8204, cdepval_part_p_name#8180 AS cdepval_part_p_name_3#8205, cdepval_part_p_mfgr#8181 AS cdepval_part_p_mfgr_3#8206, cdepval_part_p_type#8182 AS cdepval_part_p_type_3#8207, cdepval_part_p_size#8183 AS cdepval_part_p_size_3#8208, cdepval_part_p_container#8184 AS cdepval_part_p_container_3#8209, cdepval_part_p_retailprice#8185 AS cdepval_part_p_retailprice_3#8210, cdepval_part_p_comment#8186 AS cdepval_part_p_comment_3#8211, cdepval_part_p_brand#8187 AS cdepval_part_p_brand_3#8212, cp_name#8188 AS cp_name_3#8213, cp_mfgr#8189 AS cp_mfgr_3#8214, cp_type#8190 AS cp_type_3#8215, cp_size#8191 AS cp_size_3#8216, cp_container#8192 AS cp_container_3#8217, cp_retailprice#8193 AS cp_retailprice_3#8218, cp_comment#8194 AS cp_comment_3#8219, cp_brand#8195 AS cp_brand_3#8220]
         :        +- Relation[rid#8171,cval_part_p_name#8172,cval_part_p_mfgr#8173,cval_part_p_type#8174,cval_part_p_size#8175,cval_part_p_container#8176,cval_part_p_retailprice#8177,cval_part_p_comment#8178,cval_part_p_brand#8179,cdepval_part_p_name#8180,cdepval_part_p_mfgr#8181,cdepval_part_p_type#8182,cdepval_part_p_size#8183,cdepval_part_p_container#8184,cdepval_part_p_retailprice#8185,cdepval_part_p_comment#8186,cdepval_part_p_brand#8187,cp_name#8188,cp_mfgr#8189,cp_type#8190,cp_size#8191,cp_container#8192,cp_retailprice#8193,cp_comment#8194,cp_brand#8195] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#8135 AS rid_2#8153, cpfk_nation_supplier#8136 AS cpfk_nation_supplier_2#8154, cfpk_supplier_nation#8137 AS cfpk_supplier_nation_2#8155, cval_supplier_s_name#8138 AS cval_supplier_s_name_2#8156, cval_supplier_s_address#8139 AS cval_supplier_s_address_2#8157, cval_supplier_s_phone#8140 AS cval_supplier_s_phone_2#8158, cval_supplier_s_acctbal#8141 AS cval_supplier_s_acctbal_2#8159, cval_supplier_s_comment#8142 AS cval_supplier_s_comment_2#8160, cdepval_supplier_s_name#8143 AS cdepval_supplier_s_name_2#8161, cdepval_supplier_s_address#8144 AS cdepval_supplier_s_address_2#8162, cdepval_supplier_s_phone#8145 AS cdepval_supplier_s_phone_2#8163, cdepval_supplier_s_acctbal#8146 AS cdepval_supplier_s_acctbal_2#8164, cdepval_supplier_s_comment#8147 AS cdepval_supplier_s_comment_2#8165, cs_name#8148 AS cs_name_2#8166, cs_address#8149 AS cs_address_2#8167, cs_phone#8150 AS cs_phone_2#8168, cs_acctbal#8151 AS cs_acctbal_2#8169, cs_comment#8152 AS cs_comment_2#8170]
            :  +- Relation[rid#8135,cpfk_nation_supplier#8136,cfpk_supplier_nation#8137,cval_supplier_s_name#8138,cval_supplier_s_address#8139,cval_supplier_s_phone#8140,cval_supplier_s_acctbal#8141,cval_supplier_s_comment#8142,cdepval_supplier_s_name#8143,cdepval_supplier_s_address#8144,cdepval_supplier_s_phone#8145,cdepval_supplier_s_acctbal#8146,cdepval_supplier_s_comment#8147,cs_name#8148,cs_address#8149,cs_phone#8150,cs_acctbal#8151,cs_comment#8152] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
               :- Project [rid#8117 AS rid_1#8126, cpfk_region_nation#8118 AS cpfk_region_nation_1#8127, cfpk_nation_region#8119 AS cfpk_nation_region_1#8128, cval_nation_n_name#8120 AS cval_nation_n_name_1#8129, cval_nation_n_comment#8121 AS cval_nation_n_comment_1#8130, cdepval_nation_n_name#8122 AS cdepval_nation_n_name_1#8131, cdepval_nation_n_comment#8123 AS cdepval_nation_n_comment_1#8132, cn_name#8124 AS cn_name_1#8133, cn_comment#8125 AS cn_comment_1#8134]
               :  +- Relation[rid#8117,cpfk_region_nation#8118,cfpk_nation_region#8119,cval_nation_n_name#8120,cval_nation_n_comment#8121,cdepval_nation_n_name#8122,cdepval_nation_n_comment#8123,cn_name#8124,cn_comment#8125] JDBCRelation(tnation) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
                  +- Project [rid#8089 AS rid_0#8096, cval_region_r_name#8090 AS cval_region_r_name_0#8097, cval_region_r_comment#8091 AS cval_region_r_comment_0#8098, cdepval_region_r_name#8092 AS cdepval_region_r_name_0#8099, cdepval_region_r_comment#8093 AS cdepval_region_r_comment_0#8100, cr_name#8094 AS cr_name_0#8101, cr_comment#8095 AS cr_comment_0#8102]
                     +- Relation[rid#8089,cval_region_r_name#8090,cval_region_r_comment#8091,cdepval_region_r_name#8092,cdepval_region_r_comment#8093,cr_name#8094,cr_comment#8095] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 3642ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/25 22:29:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:29:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8378L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:29:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8378L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#8430 AS rid_1#8475, cpfk_orders_lineitem#8431 AS cpfk_orders_lineitem_1#8476, cpfk_supplier_lineitem#8432 AS cpfk_supplier_lineitem_1#8477, cfpk_lineitem_supplier#8433 AS cfpk_lineitem_supplier_1#8478, cfpk_lineitem_partsupp#8434 AS cfpk_lineitem_partsupp_1#8479, cpfk_part_lineitem#8435 AS cpfk_part_lineitem_1#8480, cfpk_lineitem_part#8436 AS cfpk_lineitem_part_1#8481, cpfk_partsupp_lineitem#8437 AS cpfk_partsupp_lineitem_1#8482, cfpk_lineitem_orders#8438 AS cfpk_lineitem_orders_1#8483, cval_lineitem_l_quantity#8439 AS cval_lineitem_l_quantity_1#8484, cval_lineitem_l_extendedprice#8440 AS cval_lineitem_l_extendedprice_1#8485, cval_lineitem_l_discount#8441 AS cval_lineitem_l_discount_1#8486, cval_lineitem_l_tax#8442 AS cval_lineitem_l_tax_1#8487, cval_lineitem_l_returnflag#8443 AS cval_lineitem_l_returnflag_1#8488, cval_lineitem_l_linestatus#8444 AS cval_lineitem_l_linestatus_1#8489, cval_lineitem_l_commitdate#8445 AS cval_lineitem_l_commitdate_1#8490, cval_lineitem_l_receiptdate#8446 AS cval_lineitem_l_receiptdate_1#8491, cval_lineitem_l_shipinstruct#8447 AS cval_lineitem_l_shipinstruct_1#8492, cval_lineitem_l_shipmode#8448 AS cval_lineitem_l_shipmode_1#8493, cval_lineitem_l_comment#8449 AS cval_lineitem_l_comment_1#8494, cval_lineitem_l_shipdate#8450 AS cval_lineitem_l_shipdate_1#8495, cdepval_lineitem_l_quantity#8451 AS cdepval_lineitem_l_quantity_1#8496, cdepval_lineitem_l_extendedprice#8452 AS cdepval_lineitem_l_extendedprice_1#8497, cdepval_lineitem_l_discount#8453 AS cdepval_lineitem_l_discount_1#8498, ... 21 more fields]
         :  +- Relation[rid#8430,cpfk_orders_lineitem#8431,cpfk_supplier_lineitem#8432,cfpk_lineitem_supplier#8433,cfpk_lineitem_partsupp#8434,cpfk_part_lineitem#8435,cfpk_lineitem_part#8436,cpfk_partsupp_lineitem#8437,cfpk_lineitem_orders#8438,cval_lineitem_l_quantity#8439,cval_lineitem_l_extendedprice#8440,cval_lineitem_l_discount#8441,cval_lineitem_l_tax#8442,cval_lineitem_l_returnflag#8443,cval_lineitem_l_linestatus#8444,cval_lineitem_l_commitdate#8445,cval_lineitem_l_receiptdate#8446,cval_lineitem_l_shipinstruct#8447,cval_lineitem_l_shipmode#8448,cval_lineitem_l_comment#8449,cval_lineitem_l_shipdate#8450,cdepval_lineitem_l_quantity#8451,cdepval_lineitem_l_extendedprice#8452,cdepval_lineitem_l_discount#8453,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8380 AS rid_0#8405, cval_part_p_name#8381 AS cval_part_p_name_0#8406, cval_part_p_mfgr#8382 AS cval_part_p_mfgr_0#8407, cval_part_p_type#8383 AS cval_part_p_type_0#8408, cval_part_p_size#8384 AS cval_part_p_size_0#8409, cval_part_p_container#8385 AS cval_part_p_container_0#8410, cval_part_p_retailprice#8386 AS cval_part_p_retailprice_0#8411, cval_part_p_comment#8387 AS cval_part_p_comment_0#8412, cval_part_p_brand#8388 AS cval_part_p_brand_0#8413, cdepval_part_p_name#8389 AS cdepval_part_p_name_0#8414, cdepval_part_p_mfgr#8390 AS cdepval_part_p_mfgr_0#8415, cdepval_part_p_type#8391 AS cdepval_part_p_type_0#8416, cdepval_part_p_size#8392 AS cdepval_part_p_size_0#8417, cdepval_part_p_container#8393 AS cdepval_part_p_container_0#8418, cdepval_part_p_retailprice#8394 AS cdepval_part_p_retailprice_0#8419, cdepval_part_p_comment#8395 AS cdepval_part_p_comment_0#8420, cdepval_part_p_brand#8396 AS cdepval_part_p_brand_0#8421, cp_name#8397 AS cp_name_0#8422, cp_mfgr#8398 AS cp_mfgr_0#8423, cp_type#8399 AS cp_type_0#8424, cp_size#8400 AS cp_size_0#8425, cp_container#8401 AS cp_container_0#8426, cp_retailprice#8402 AS cp_retailprice_0#8427, cp_comment#8403 AS cp_comment_0#8428, cp_brand#8404 AS cp_brand_0#8429]
            +- Relation[rid#8380,cval_part_p_name#8381,cval_part_p_mfgr#8382,cval_part_p_type#8383,cval_part_p_size#8384,cval_part_p_container#8385,cval_part_p_retailprice#8386,cval_part_p_comment#8387,cval_part_p_brand#8388,cdepval_part_p_name#8389,cdepval_part_p_mfgr#8390,cdepval_part_p_type#8391,cdepval_part_p_size#8392,cdepval_part_p_container#8393,cdepval_part_p_retailprice#8394,cdepval_part_p_comment#8395,cdepval_part_p_brand#8396,cp_name#8397,cp_mfgr#8398,cp_type#8399,cp_size#8400,cp_container#8401,cp_retailprice#8402,cp_comment#8403,cp_brand#8404] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17802ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/25 22:29:27 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:29:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8602L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 22:29:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:29:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:29:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8602L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#8604 AS rid_0#8649, cpfk_orders_lineitem#8605 AS cpfk_orders_lineitem_0#8650, cpfk_supplier_lineitem#8606 AS cpfk_supplier_lineitem_0#8651, cfpk_lineitem_supplier#8607 AS cfpk_lineitem_supplier_0#8652, cfpk_lineitem_partsupp#8608 AS cfpk_lineitem_partsupp_0#8653, cpfk_part_lineitem#8609 AS cpfk_part_lineitem_0#8654, cfpk_lineitem_part#8610 AS cfpk_lineitem_part_0#8655, cpfk_partsupp_lineitem#8611 AS cpfk_partsupp_lineitem_0#8656, cfpk_lineitem_orders#8612 AS cfpk_lineitem_orders_0#8657, cval_lineitem_l_quantity#8613 AS cval_lineitem_l_quantity_0#8658, cval_lineitem_l_extendedprice#8614 AS cval_lineitem_l_extendedprice_0#8659, cval_lineitem_l_discount#8615 AS cval_lineitem_l_discount_0#8660, cval_lineitem_l_tax#8616 AS cval_lineitem_l_tax_0#8661, cval_lineitem_l_returnflag#8617 AS cval_lineitem_l_returnflag_0#8662, cval_lineitem_l_linestatus#8618 AS cval_lineitem_l_linestatus_0#8663, cval_lineitem_l_commitdate#8619 AS cval_lineitem_l_commitdate_0#8664, cval_lineitem_l_receiptdate#8620 AS cval_lineitem_l_receiptdate_0#8665, cval_lineitem_l_shipinstruct#8621 AS cval_lineitem_l_shipinstruct_0#8666, cval_lineitem_l_shipmode#8622 AS cval_lineitem_l_shipmode_0#8667, cval_lineitem_l_comment#8623 AS cval_lineitem_l_comment_0#8668, cval_lineitem_l_shipdate#8624 AS cval_lineitem_l_shipdate_0#8669, cdepval_lineitem_l_quantity#8625 AS cdepval_lineitem_l_quantity_0#8670, cdepval_lineitem_l_extendedprice#8626 AS cdepval_lineitem_l_extendedprice_0#8671, cdepval_lineitem_l_discount#8627 AS cdepval_lineitem_l_discount_0#8672, ... 21 more fields]
         :  :  :     +- Relation[rid#8604,cpfk_orders_lineitem#8605,cpfk_supplier_lineitem#8606,cfpk_lineitem_supplier#8607,cfpk_lineitem_partsupp#8608,cpfk_part_lineitem#8609,cfpk_lineitem_part#8610,cpfk_partsupp_lineitem#8611,cfpk_lineitem_orders#8612,cval_lineitem_l_quantity#8613,cval_lineitem_l_extendedprice#8614,cval_lineitem_l_discount#8615,cval_lineitem_l_tax#8616,cval_lineitem_l_returnflag#8617,cval_lineitem_l_linestatus#8618,cval_lineitem_l_commitdate#8619,cval_lineitem_l_receiptdate#8620,cval_lineitem_l_shipinstruct#8621,cval_lineitem_l_shipmode#8622,cval_lineitem_l_comment#8623,cval_lineitem_l_shipdate#8624,cdepval_lineitem_l_quantity#8625,cdepval_lineitem_l_extendedprice#8626,cdepval_lineitem_l_discount#8627,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#8784 AS rid_1#8808, cpfk_customer_orders#8785 AS cpfk_customer_orders_1#8809, cfpk_orders_customer#8786 AS cfpk_orders_customer_1#8810, cval_orders_o_orderstatus#8787 AS cval_orders_o_orderstatus_1#8811, cval_orders_o_totalprice#8788 AS cval_orders_o_totalprice_1#8812, cval_orders_o_orderpriority#8789 AS cval_orders_o_orderpriority_1#8813, cval_orders_o_clerk#8790 AS cval_orders_o_clerk_1#8814, cval_orders_o_shippriority#8791 AS cval_orders_o_shippriority_1#8815, cval_orders_o_comment#8792 AS cval_orders_o_comment_1#8816, cval_orders_o_orderdate#8793 AS cval_orders_o_orderdate_1#8817, cdepval_orders_o_orderstatus#8794 AS cdepval_orders_o_orderstatus_1#8818, cdepval_orders_o_totalprice#8795 AS cdepval_orders_o_totalprice_1#8819, cdepval_orders_o_orderpriority#8796 AS cdepval_orders_o_orderpriority_1#8820, cdepval_orders_o_clerk#8797 AS cdepval_orders_o_clerk_1#8821, cdepval_orders_o_shippriority#8798 AS cdepval_orders_o_shippriority_1#8822, cdepval_orders_o_comment#8799 AS cdepval_orders_o_comment_1#8823, cdepval_orders_o_orderdate#8800 AS cdepval_orders_o_orderdate_1#8824, co_orderstatus#8801 AS co_orderstatus_1#8825, co_totalprice#8802 AS co_totalprice_1#8826, co_orderpriority#8803 AS co_orderpriority_1#8827, co_clerk#8804 AS co_clerk_1#8828, co_shippriority#8805 AS co_shippriority_1#8829, co_comment#8806 AS co_comment_1#8830, co_orderdate#8807 AS co_orderdate_1#8831]
         :  :     +- Relation[rid#8784,cpfk_customer_orders#8785,cfpk_orders_customer#8786,cval_orders_o_orderstatus#8787,cval_orders_o_totalprice#8788,cval_orders_o_orderpriority#8789,cval_orders_o_clerk#8790,cval_orders_o_shippriority#8791,cval_orders_o_comment#8792,cval_orders_o_orderdate#8793,cdepval_orders_o_orderstatus#8794,cdepval_orders_o_totalprice#8795,cdepval_orders_o_orderpriority#8796,cdepval_orders_o_clerk#8797,cdepval_orders_o_shippriority#8798,cdepval_orders_o_comment#8799,cdepval_orders_o_orderdate#8800,co_orderstatus#8801,co_totalprice#8802,co_orderpriority#8803,co_clerk#8804,co_shippriority#8805,co_comment#8806,co_orderdate#8807] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#8832 AS rid_2#8853, cpfk_nation_customer#8833 AS cpfk_nation_customer_2#8854, cfpk_customer_nation#8834 AS cfpk_customer_nation_2#8855, cval_customer_c_name#8835 AS cval_customer_c_name_2#8856, cval_customer_c_address#8836 AS cval_customer_c_address_2#8857, cval_customer_c_phone#8837 AS cval_customer_c_phone_2#8858, cval_customer_c_acctbal#8838 AS cval_customer_c_acctbal_2#8859, cval_customer_c_comment#8839 AS cval_customer_c_comment_2#8860, cval_customer_c_mktsegment#8840 AS cval_customer_c_mktsegment_2#8861, cdepval_customer_c_name#8841 AS cdepval_customer_c_name_2#8862, cdepval_customer_c_address#8842 AS cdepval_customer_c_address_2#8863, cdepval_customer_c_phone#8843 AS cdepval_customer_c_phone_2#8864, cdepval_customer_c_acctbal#8844 AS cdepval_customer_c_acctbal_2#8865, cdepval_customer_c_comment#8845 AS cdepval_customer_c_comment_2#8866, cdepval_customer_c_mktsegment#8846 AS cdepval_customer_c_mktsegment_2#8867, cc_name#8847 AS cc_name_2#8868, cc_address#8848 AS cc_address_2#8869, cc_phone#8849 AS cc_phone_2#8870, cc_acctbal#8850 AS cc_acctbal_2#8871, cc_comment#8851 AS cc_comment_2#8872, cc_mktsegment#8852 AS cc_mktsegment_2#8873]
         :     +- Relation[rid#8832,cpfk_nation_customer#8833,cfpk_customer_nation#8834,cval_customer_c_name#8835,cval_customer_c_address#8836,cval_customer_c_phone#8837,cval_customer_c_acctbal#8838,cval_customer_c_comment#8839,cval_customer_c_mktsegment#8840,cdepval_customer_c_name#8841,cdepval_customer_c_address#8842,cdepval_customer_c_phone#8843,cdepval_customer_c_acctbal#8844,cdepval_customer_c_comment#8845,cdepval_customer_c_mktsegment#8846,cc_name#8847,cc_address#8848,cc_phone#8849,cc_acctbal#8850,cc_comment#8851,cc_mktsegment#8852] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#8874 AS rid_3#8883, cpfk_region_nation#8875 AS cpfk_region_nation_3#8884, cfpk_nation_region#8876 AS cfpk_nation_region_3#8885, cval_nation_n_name#8877 AS cval_nation_n_name_3#8886, cval_nation_n_comment#8878 AS cval_nation_n_comment_3#8887, cdepval_nation_n_name#8879 AS cdepval_nation_n_name_3#8888, cdepval_nation_n_comment#8880 AS cdepval_nation_n_comment_3#8889, cn_name#8881 AS cn_name_3#8890, cn_comment#8882 AS cn_comment_3#8891]
            +- Relation[rid#8874,cpfk_region_nation#8875,cfpk_nation_region#8876,cval_nation_n_name#8877,cval_nation_n_comment#8878,cdepval_nation_n_name#8879,cdepval_nation_n_comment#8880,cn_name#8881,cn_comment#8882] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 60773ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/25 22:30:28 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:30:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8996L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 22:30:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8996L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#8998 AS rid_0#9022, cpfk_customer_orders#8999 AS cpfk_customer_orders_0#9023, cfpk_orders_customer#9000 AS cfpk_orders_customer_0#9024, cval_orders_o_orderstatus#9001 AS cval_orders_o_orderstatus_0#9025, cval_orders_o_totalprice#9002 AS cval_orders_o_totalprice_0#9026, cval_orders_o_orderpriority#9003 AS cval_orders_o_orderpriority_0#9027, cval_orders_o_clerk#9004 AS cval_orders_o_clerk_0#9028, cval_orders_o_shippriority#9005 AS cval_orders_o_shippriority_0#9029, cval_orders_o_comment#9006 AS cval_orders_o_comment_0#9030, cval_orders_o_orderdate#9007 AS cval_orders_o_orderdate_0#9031, cdepval_orders_o_orderstatus#9008 AS cdepval_orders_o_orderstatus_0#9032, cdepval_orders_o_totalprice#9009 AS cdepval_orders_o_totalprice_0#9033, cdepval_orders_o_orderpriority#9010 AS cdepval_orders_o_orderpriority_0#9034, cdepval_orders_o_clerk#9011 AS cdepval_orders_o_clerk_0#9035, cdepval_orders_o_shippriority#9012 AS cdepval_orders_o_shippriority_0#9036, cdepval_orders_o_comment#9013 AS cdepval_orders_o_comment_0#9037, cdepval_orders_o_orderdate#9014 AS cdepval_orders_o_orderdate_0#9038, co_orderstatus#9015 AS co_orderstatus_0#9039, co_totalprice#9016 AS co_totalprice_0#9040, co_orderpriority#9017 AS co_orderpriority_0#9041, co_clerk#9018 AS co_clerk_0#9042, co_shippriority#9019 AS co_shippriority_0#9043, co_comment#9020 AS co_comment_0#9044, co_orderdate#9021 AS co_orderdate_0#9045]
         :  +- Relation[rid#8998,cpfk_customer_orders#8999,cfpk_orders_customer#9000,cval_orders_o_orderstatus#9001,cval_orders_o_totalprice#9002,cval_orders_o_orderpriority#9003,cval_orders_o_clerk#9004,cval_orders_o_shippriority#9005,cval_orders_o_comment#9006,cval_orders_o_orderdate#9007,cdepval_orders_o_orderstatus#9008,cdepval_orders_o_totalprice#9009,cdepval_orders_o_orderpriority#9010,cdepval_orders_o_clerk#9011,cdepval_orders_o_shippriority#9012,cdepval_orders_o_comment#9013,cdepval_orders_o_orderdate#9014,co_orderstatus#9015,co_totalprice#9016,co_orderpriority#9017,co_clerk#9018,co_shippriority#9019,co_comment#9020,co_orderdate#9021] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#9046 AS rid_1#9067, cpfk_nation_customer#9047 AS cpfk_nation_customer_1#9068, cfpk_customer_nation#9048 AS cfpk_customer_nation_1#9069, cval_customer_c_name#9049 AS cval_customer_c_name_1#9070, cval_customer_c_address#9050 AS cval_customer_c_address_1#9071, cval_customer_c_phone#9051 AS cval_customer_c_phone_1#9072, cval_customer_c_acctbal#9052 AS cval_customer_c_acctbal_1#9073, cval_customer_c_comment#9053 AS cval_customer_c_comment_1#9074, cval_customer_c_mktsegment#9054 AS cval_customer_c_mktsegment_1#9075, cdepval_customer_c_name#9055 AS cdepval_customer_c_name_1#9076, cdepval_customer_c_address#9056 AS cdepval_customer_c_address_1#9077, cdepval_customer_c_phone#9057 AS cdepval_customer_c_phone_1#9078, cdepval_customer_c_acctbal#9058 AS cdepval_customer_c_acctbal_1#9079, cdepval_customer_c_comment#9059 AS cdepval_customer_c_comment_1#9080, cdepval_customer_c_mktsegment#9060 AS cdepval_customer_c_mktsegment_1#9081, cc_name#9061 AS cc_name_1#9082, cc_address#9062 AS cc_address_1#9083, cc_phone#9063 AS cc_phone_1#9084, cc_acctbal#9064 AS cc_acctbal_1#9085, cc_comment#9065 AS cc_comment_1#9086, cc_mktsegment#9066 AS cc_mktsegment_1#9087]
            +- Relation[rid#9046,cpfk_nation_customer#9047,cfpk_customer_nation#9048,cval_customer_c_name#9049,cval_customer_c_address#9050,cval_customer_c_phone#9051,cval_customer_c_acctbal#9052,cval_customer_c_comment#9053,cval_customer_c_mktsegment#9054,cdepval_customer_c_name#9055,cdepval_customer_c_address#9056,cdepval_customer_c_phone#9057,cdepval_customer_c_acctbal#9058,cdepval_customer_c_comment#9059,cdepval_customer_c_mktsegment#9060,cc_name#9061,cc_address#9062,cc_phone#9063,cc_acctbal#9064,cc_comment#9065,cc_mktsegment#9066] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4408ms
query=q1, count=6001215, duration=2442
query=q10, count=1478870, duration=60773
query=q11, count=31680, duration=3469
query=q12, count=857401, duration=19953
query=q13, count=1500000, duration=4850
query=q14, count=6001215, duration=17802
query=q15, count=6001215, duration=17193
query=q16, count=15780, duration=3389
query=q17, count=6088, duration=25973
query=q18, count=6001215, duration=22102
query=q19, count=205, duration=16638
query=q2, count=3162, duration=3642
query=q20, count=632, duration=3830
query=q21a, count=597422, duration=75795
query=q22, count=1500000, duration=4408
query=q3, count=1214743, duration=38730
query=q4, count=6001215, duration=18343
query=q5, count=48089, duration=30769
query=q6, count=6001215, duration=2311
query=q7, count=9735, duration=34800
query=q8, count=8716, duration=44650
query=q9a, count=6001215, duration=63628
query=q9b, count=6001215, duration=37833
