20/04/25 22:49:40 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10738ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 25 22:49:43 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 25 22:49:44 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 25 22:49:44 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 25 22:49:44 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 25 22:49:44 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 25 22:49:48 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 25 22:49:52 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 25 22:49:52 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/25 22:49:54 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:49:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2078L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:49:54 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/25 22:49:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2078L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#2080 AS rid_0#2125, cpfk_orders_lineitem#2081 AS cpfk_orders_lineitem_0#2126, cpfk_supplier_lineitem#2082 AS cpfk_supplier_lineitem_0#2127, cfpk_lineitem_supplier#2083 AS cfpk_lineitem_supplier_0#2128, cfpk_lineitem_partsupp#2084 AS cfpk_lineitem_partsupp_0#2129, cpfk_part_lineitem#2085 AS cpfk_part_lineitem_0#2130, cfpk_lineitem_part#2086 AS cfpk_lineitem_part_0#2131, cpfk_partsupp_lineitem#2087 AS cpfk_partsupp_lineitem_0#2132, cfpk_lineitem_orders#2088 AS cfpk_lineitem_orders_0#2133, cval_lineitem_l_quantity#2089 AS cval_lineitem_l_quantity_0#2134, cval_lineitem_l_extendedprice#2090 AS cval_lineitem_l_extendedprice_0#2135, cval_lineitem_l_discount#2091 AS cval_lineitem_l_discount_0#2136, cval_lineitem_l_tax#2092 AS cval_lineitem_l_tax_0#2137, cval_lineitem_l_returnflag#2093 AS cval_lineitem_l_returnflag_0#2138, cval_lineitem_l_linestatus#2094 AS cval_lineitem_l_linestatus_0#2139, cval_lineitem_l_commitdate#2095 AS cval_lineitem_l_commitdate_0#2140, cval_lineitem_l_receiptdate#2096 AS cval_lineitem_l_receiptdate_0#2141, cval_lineitem_l_shipinstruct#2097 AS cval_lineitem_l_shipinstruct_0#2142, cval_lineitem_l_shipmode#2098 AS cval_lineitem_l_shipmode_0#2143, cval_lineitem_l_comment#2099 AS cval_lineitem_l_comment_0#2144, cval_lineitem_l_shipdate#2100 AS cval_lineitem_l_shipdate_0#2145, cdepval_lineitem_l_quantity#2101 AS cdepval_lineitem_l_quantity_0#2146, cdepval_lineitem_l_extendedprice#2102 AS cdepval_lineitem_l_extendedprice_0#2147, cdepval_lineitem_l_discount#2103 AS cdepval_lineitem_l_discount_0#2148, ... 21 more fields]
         :     +- Relation[rid#2080,cpfk_orders_lineitem#2081,cpfk_supplier_lineitem#2082,cfpk_lineitem_supplier#2083,cfpk_lineitem_partsupp#2084,cpfk_part_lineitem#2085,cfpk_lineitem_part#2086,cpfk_partsupp_lineitem#2087,cfpk_lineitem_orders#2088,cval_lineitem_l_quantity#2089,cval_lineitem_l_extendedprice#2090,cval_lineitem_l_discount#2091,cval_lineitem_l_tax#2092,cval_lineitem_l_returnflag#2093,cval_lineitem_l_linestatus#2094,cval_lineitem_l_commitdate#2095,cval_lineitem_l_receiptdate#2096,cval_lineitem_l_shipinstruct#2097,cval_lineitem_l_shipmode#2098,cval_lineitem_l_comment#2099,cval_lineitem_l_shipdate#2100,cdepval_lineitem_l_quantity#2101,cdepval_lineitem_l_extendedprice#2102,cdepval_lineitem_l_discount#2103,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2260 AS rid_1#2284, cpfk_customer_orders#2261 AS cpfk_customer_orders_1#2285, cfpk_orders_customer#2262 AS cfpk_orders_customer_1#2286, cval_orders_o_orderstatus#2263 AS cval_orders_o_orderstatus_1#2287, cval_orders_o_totalprice#2264 AS cval_orders_o_totalprice_1#2288, cval_orders_o_orderpriority#2265 AS cval_orders_o_orderpriority_1#2289, cval_orders_o_clerk#2266 AS cval_orders_o_clerk_1#2290, cval_orders_o_shippriority#2267 AS cval_orders_o_shippriority_1#2291, cval_orders_o_comment#2268 AS cval_orders_o_comment_1#2292, cval_orders_o_orderdate#2269 AS cval_orders_o_orderdate_1#2293, cdepval_orders_o_orderstatus#2270 AS cdepval_orders_o_orderstatus_1#2294, cdepval_orders_o_totalprice#2271 AS cdepval_orders_o_totalprice_1#2295, cdepval_orders_o_orderpriority#2272 AS cdepval_orders_o_orderpriority_1#2296, cdepval_orders_o_clerk#2273 AS cdepval_orders_o_clerk_1#2297, cdepval_orders_o_shippriority#2274 AS cdepval_orders_o_shippriority_1#2298, cdepval_orders_o_comment#2275 AS cdepval_orders_o_comment_1#2299, cdepval_orders_o_orderdate#2276 AS cdepval_orders_o_orderdate_1#2300, co_orderstatus#2277 AS co_orderstatus_1#2301, co_totalprice#2278 AS co_totalprice_1#2302, co_orderpriority#2279 AS co_orderpriority_1#2303, co_clerk#2280 AS co_clerk_1#2304, co_shippriority#2281 AS co_shippriority_1#2305, co_comment#2282 AS co_comment_1#2306, co_orderdate#2283 AS co_orderdate_1#2307]
            +- Relation[rid#2260,cpfk_customer_orders#2261,cfpk_orders_customer#2262,cval_orders_o_orderstatus#2263,cval_orders_o_totalprice#2264,cval_orders_o_orderpriority#2265,cval_orders_o_clerk#2266,cval_orders_o_shippriority#2267,cval_orders_o_comment#2268,cval_orders_o_orderdate#2269,cdepval_orders_o_orderstatus#2270,cdepval_orders_o_totalprice#2271,cdepval_orders_o_orderpriority#2272,cdepval_orders_o_clerk#2273,cdepval_orders_o_shippriority#2274,cdepval_orders_o_comment#2275,cdepval_orders_o_orderdate#2276,co_orderstatus#2277,co_totalprice#2278,co_orderpriority#2279,co_clerk#2280,co_shippriority#2281,co_comment#2282,co_orderdate#2283] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 22737ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/25 22:50:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:50:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2381L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 22:50:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:50:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:50:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:50:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:50:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:50:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:50:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:50:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2381L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#2383 AS rid_0#2428, cpfk_orders_lineitem#2384 AS cpfk_orders_lineitem_0#2429, cpfk_supplier_lineitem#2385 AS cpfk_supplier_lineitem_0#2430, cfpk_lineitem_supplier#2386 AS cfpk_lineitem_supplier_0#2431, cfpk_lineitem_partsupp#2387 AS cfpk_lineitem_partsupp_0#2432, cpfk_part_lineitem#2388 AS cpfk_part_lineitem_0#2433, cfpk_lineitem_part#2389 AS cfpk_lineitem_part_0#2434, cpfk_partsupp_lineitem#2390 AS cpfk_partsupp_lineitem_0#2435, cfpk_lineitem_orders#2391 AS cfpk_lineitem_orders_0#2436, cval_lineitem_l_quantity#2392 AS cval_lineitem_l_quantity_0#2437, cval_lineitem_l_extendedprice#2393 AS cval_lineitem_l_extendedprice_0#2438, cval_lineitem_l_discount#2394 AS cval_lineitem_l_discount_0#2439, cval_lineitem_l_tax#2395 AS cval_lineitem_l_tax_0#2440, cval_lineitem_l_returnflag#2396 AS cval_lineitem_l_returnflag_0#2441, cval_lineitem_l_linestatus#2397 AS cval_lineitem_l_linestatus_0#2442, cval_lineitem_l_commitdate#2398 AS cval_lineitem_l_commitdate_0#2443, cval_lineitem_l_receiptdate#2399 AS cval_lineitem_l_receiptdate_0#2444, cval_lineitem_l_shipinstruct#2400 AS cval_lineitem_l_shipinstruct_0#2445, cval_lineitem_l_shipmode#2401 AS cval_lineitem_l_shipmode_0#2446, cval_lineitem_l_comment#2402 AS cval_lineitem_l_comment_0#2447, cval_lineitem_l_shipdate#2403 AS cval_lineitem_l_shipdate_0#2448, cdepval_lineitem_l_quantity#2404 AS cdepval_lineitem_l_quantity_0#2449, cdepval_lineitem_l_extendedprice#2405 AS cdepval_lineitem_l_extendedprice_0#2450, cdepval_lineitem_l_discount#2406 AS cdepval_lineitem_l_discount_0#2451, ... 21 more fields]
         :  +- Relation[rid#2383,cpfk_orders_lineitem#2384,cpfk_supplier_lineitem#2385,cfpk_lineitem_supplier#2386,cfpk_lineitem_partsupp#2387,cpfk_part_lineitem#2388,cfpk_lineitem_part#2389,cpfk_partsupp_lineitem#2390,cfpk_lineitem_orders#2391,cval_lineitem_l_quantity#2392,cval_lineitem_l_extendedprice#2393,cval_lineitem_l_discount#2394,cval_lineitem_l_tax#2395,cval_lineitem_l_returnflag#2396,cval_lineitem_l_linestatus#2397,cval_lineitem_l_commitdate#2398,cval_lineitem_l_receiptdate#2399,cval_lineitem_l_shipinstruct#2400,cval_lineitem_l_shipmode#2401,cval_lineitem_l_comment#2402,cval_lineitem_l_shipdate#2403,cdepval_lineitem_l_quantity#2404,cdepval_lineitem_l_extendedprice#2405,cdepval_lineitem_l_discount#2406,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
            :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
            :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
            :  :  :- Project [rid#2569 AS rid_2#2614, cpfk_orders_lineitem#2570 AS cpfk_orders_lineitem_2#2615, cpfk_supplier_lineitem#2571 AS cpfk_supplier_lineitem_2#2616, cfpk_lineitem_supplier#2572 AS cfpk_lineitem_supplier_2#2617, cfpk_lineitem_partsupp#2573 AS cfpk_lineitem_partsupp_2#2618, cpfk_part_lineitem#2574 AS cpfk_part_lineitem_2#2619, cfpk_lineitem_part#2575 AS cfpk_lineitem_part_2#2620, cpfk_partsupp_lineitem#2576 AS cpfk_partsupp_lineitem_2#2621, cfpk_lineitem_orders#2577 AS cfpk_lineitem_orders_2#2622, cval_lineitem_l_quantity#2578 AS cval_lineitem_l_quantity_2#2623, cval_lineitem_l_extendedprice#2579 AS cval_lineitem_l_extendedprice_2#2624, cval_lineitem_l_discount#2580 AS cval_lineitem_l_discount_2#2625, cval_lineitem_l_tax#2581 AS cval_lineitem_l_tax_2#2626, cval_lineitem_l_returnflag#2582 AS cval_lineitem_l_returnflag_2#2627, cval_lineitem_l_linestatus#2583 AS cval_lineitem_l_linestatus_2#2628, cval_lineitem_l_commitdate#2584 AS cval_lineitem_l_commitdate_2#2629, cval_lineitem_l_receiptdate#2585 AS cval_lineitem_l_receiptdate_2#2630, cval_lineitem_l_shipinstruct#2586 AS cval_lineitem_l_shipinstruct_2#2631, cval_lineitem_l_shipmode#2587 AS cval_lineitem_l_shipmode_2#2632, cval_lineitem_l_comment#2588 AS cval_lineitem_l_comment_2#2633, cval_lineitem_l_shipdate#2589 AS cval_lineitem_l_shipdate_2#2634, cdepval_lineitem_l_quantity#2590 AS cdepval_lineitem_l_quantity_2#2635, cdepval_lineitem_l_extendedprice#2591 AS cdepval_lineitem_l_extendedprice_2#2636, cdepval_lineitem_l_discount#2592 AS cdepval_lineitem_l_discount_2#2637, ... 21 more fields]
            :  :  :  +- Relation[rid#2569,cpfk_orders_lineitem#2570,cpfk_supplier_lineitem#2571,cfpk_lineitem_supplier#2572,cfpk_lineitem_partsupp#2573,cpfk_part_lineitem#2574,cfpk_lineitem_part#2575,cpfk_partsupp_lineitem#2576,cfpk_lineitem_orders#2577,cval_lineitem_l_quantity#2578,cval_lineitem_l_extendedprice#2579,cval_lineitem_l_discount#2580,cval_lineitem_l_tax#2581,cval_lineitem_l_returnflag#2582,cval_lineitem_l_linestatus#2583,cval_lineitem_l_commitdate#2584,cval_lineitem_l_receiptdate#2585,cval_lineitem_l_shipinstruct#2586,cval_lineitem_l_shipmode#2587,cval_lineitem_l_comment#2588,cval_lineitem_l_shipdate#2589,cdepval_lineitem_l_quantity#2590,cdepval_lineitem_l_extendedprice#2591,cdepval_lineitem_l_discount#2592,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
            :  :     +- Project [rid#2473 AS rid_1#2497, cpfk_customer_orders#2474 AS cpfk_customer_orders_1#2498, cfpk_orders_customer#2475 AS cfpk_orders_customer_1#2499, cval_orders_o_orderstatus#2476 AS cval_orders_o_orderstatus_1#2500, cval_orders_o_totalprice#2477 AS cval_orders_o_totalprice_1#2501, cval_orders_o_orderpriority#2478 AS cval_orders_o_orderpriority_1#2502, cval_orders_o_clerk#2479 AS cval_orders_o_clerk_1#2503, cval_orders_o_shippriority#2480 AS cval_orders_o_shippriority_1#2504, cval_orders_o_comment#2481 AS cval_orders_o_comment_1#2505, cval_orders_o_orderdate#2482 AS cval_orders_o_orderdate_1#2506, cdepval_orders_o_orderstatus#2483 AS cdepval_orders_o_orderstatus_1#2507, cdepval_orders_o_totalprice#2484 AS cdepval_orders_o_totalprice_1#2508, cdepval_orders_o_orderpriority#2485 AS cdepval_orders_o_orderpriority_1#2509, cdepval_orders_o_clerk#2486 AS cdepval_orders_o_clerk_1#2510, cdepval_orders_o_shippriority#2487 AS cdepval_orders_o_shippriority_1#2511, cdepval_orders_o_comment#2488 AS cdepval_orders_o_comment_1#2512, cdepval_orders_o_orderdate#2489 AS cdepval_orders_o_orderdate_1#2513, co_orderstatus#2490 AS co_orderstatus_1#2514, co_totalprice#2491 AS co_totalprice_1#2515, co_orderpriority#2492 AS co_orderpriority_1#2516, co_clerk#2493 AS co_clerk_1#2517, co_shippriority#2494 AS co_shippriority_1#2518, co_comment#2495 AS co_comment_1#2519, co_orderdate#2496 AS co_orderdate_1#2520]
            :  :        +- Relation[rid#2473,cpfk_customer_orders#2474,cfpk_orders_customer#2475,cval_orders_o_orderstatus#2476,cval_orders_o_totalprice#2477,cval_orders_o_orderpriority#2478,cval_orders_o_clerk#2479,cval_orders_o_shippriority#2480,cval_orders_o_comment#2481,cval_orders_o_orderdate#2482,cdepval_orders_o_orderstatus#2483,cdepval_orders_o_totalprice#2484,cdepval_orders_o_orderpriority#2485,cdepval_orders_o_clerk#2486,cdepval_orders_o_shippriority#2487,cdepval_orders_o_comment#2488,cdepval_orders_o_orderdate#2489,co_orderstatus#2490,co_totalprice#2491,co_orderpriority#2492,co_clerk#2493,co_shippriority#2494,co_comment#2495,co_orderdate#2496] JDBCRelation(torders) [numPartitions=1]
            :  +- Project [rid#2659 AS rid_3#2677, cpfk_nation_supplier#2660 AS cpfk_nation_supplier_3#2678, cfpk_supplier_nation#2661 AS cfpk_supplier_nation_3#2679, cval_supplier_s_name#2662 AS cval_supplier_s_name_3#2680, cval_supplier_s_address#2663 AS cval_supplier_s_address_3#2681, cval_supplier_s_phone#2664 AS cval_supplier_s_phone_3#2682, cval_supplier_s_acctbal#2665 AS cval_supplier_s_acctbal_3#2683, cval_supplier_s_comment#2666 AS cval_supplier_s_comment_3#2684, cdepval_supplier_s_name#2667 AS cdepval_supplier_s_name_3#2685, cdepval_supplier_s_address#2668 AS cdepval_supplier_s_address_3#2686, cdepval_supplier_s_phone#2669 AS cdepval_supplier_s_phone_3#2687, cdepval_supplier_s_acctbal#2670 AS cdepval_supplier_s_acctbal_3#2688, cdepval_supplier_s_comment#2671 AS cdepval_supplier_s_comment_3#2689, cs_name#2672 AS cs_name_3#2690, cs_address#2673 AS cs_address_3#2691, cs_phone#2674 AS cs_phone_3#2692, cs_acctbal#2675 AS cs_acctbal_3#2693, cs_comment#2676 AS cs_comment_3#2694]
            :     +- Relation[rid#2659,cpfk_nation_supplier#2660,cfpk_supplier_nation#2661,cval_supplier_s_name#2662,cval_supplier_s_address#2663,cval_supplier_s_phone#2664,cval_supplier_s_acctbal#2665,cval_supplier_s_comment#2666,cdepval_supplier_s_name#2667,cdepval_supplier_s_address#2668,cdepval_supplier_s_phone#2669,cdepval_supplier_s_acctbal#2670,cdepval_supplier_s_comment#2671,cs_name#2672,cs_address#2673,cs_phone#2674,cs_acctbal#2675,cs_comment#2676] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
               +- Project [rid#2695 AS rid_4#2704, cpfk_region_nation#2696 AS cpfk_region_nation_4#2705, cfpk_nation_region#2697 AS cfpk_nation_region_4#2706, cval_nation_n_name#2698 AS cval_nation_n_name_4#2707, cval_nation_n_comment#2699 AS cval_nation_n_comment_4#2708, cdepval_nation_n_name#2700 AS cdepval_nation_n_name_4#2709, cdepval_nation_n_comment#2701 AS cdepval_nation_n_comment_4#2710, cn_name#2702 AS cn_name_4#2711, cn_comment#2703 AS cn_comment_4#2712]
                  +- Relation[rid#2695,cpfk_region_nation#2696,cfpk_nation_region#2697,cval_nation_n_name#2698,cval_nation_n_comment#2699,cdepval_nation_n_name#2700,cdepval_nation_n_comment#2701,cn_name#2702,cn_comment#2703] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 75620ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/25 22:51:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:51:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2880L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:51:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:51:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:51:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:51:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:51:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:51:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:51:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:51:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:51:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:51:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:51:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:51:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2880L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#2954 AS rid_2#2999, cpfk_orders_lineitem#2955 AS cpfk_orders_lineitem_2#3000, cpfk_supplier_lineitem#2956 AS cpfk_supplier_lineitem_2#3001, cfpk_lineitem_supplier#2957 AS cfpk_lineitem_supplier_2#3002, cfpk_lineitem_partsupp#2958 AS cfpk_lineitem_partsupp_2#3003, cpfk_part_lineitem#2959 AS cpfk_part_lineitem_2#3004, cfpk_lineitem_part#2960 AS cfpk_lineitem_part_2#3005, cpfk_partsupp_lineitem#2961 AS cpfk_partsupp_lineitem_2#3006, cfpk_lineitem_orders#2962 AS cfpk_lineitem_orders_2#3007, cval_lineitem_l_quantity#2963 AS cval_lineitem_l_quantity_2#3008, cval_lineitem_l_extendedprice#2964 AS cval_lineitem_l_extendedprice_2#3009, cval_lineitem_l_discount#2965 AS cval_lineitem_l_discount_2#3010, cval_lineitem_l_tax#2966 AS cval_lineitem_l_tax_2#3011, cval_lineitem_l_returnflag#2967 AS cval_lineitem_l_returnflag_2#3012, cval_lineitem_l_linestatus#2968 AS cval_lineitem_l_linestatus_2#3013, cval_lineitem_l_commitdate#2969 AS cval_lineitem_l_commitdate_2#3014, cval_lineitem_l_receiptdate#2970 AS cval_lineitem_l_receiptdate_2#3015, cval_lineitem_l_shipinstruct#2971 AS cval_lineitem_l_shipinstruct_2#3016, cval_lineitem_l_shipmode#2972 AS cval_lineitem_l_shipmode_2#3017, cval_lineitem_l_comment#2973 AS cval_lineitem_l_comment_2#3018, cval_lineitem_l_shipdate#2974 AS cval_lineitem_l_shipdate_2#3019, cdepval_lineitem_l_quantity#2975 AS cdepval_lineitem_l_quantity_2#3020, cdepval_lineitem_l_extendedprice#2976 AS cdepval_lineitem_l_extendedprice_2#3021, cdepval_lineitem_l_discount#2977 AS cdepval_lineitem_l_discount_2#3022, ... 21 more fields]
         :  :  +- Relation[rid#2954,cpfk_orders_lineitem#2955,cpfk_supplier_lineitem#2956,cfpk_lineitem_supplier#2957,cfpk_lineitem_partsupp#2958,cpfk_part_lineitem#2959,cfpk_lineitem_part#2960,cpfk_partsupp_lineitem#2961,cfpk_lineitem_orders#2962,cval_lineitem_l_quantity#2963,cval_lineitem_l_extendedprice#2964,cval_lineitem_l_discount#2965,cval_lineitem_l_tax#2966,cval_lineitem_l_returnflag#2967,cval_lineitem_l_linestatus#2968,cval_lineitem_l_commitdate#2969,cval_lineitem_l_receiptdate#2970,cval_lineitem_l_shipinstruct#2971,cval_lineitem_l_shipmode#2972,cval_lineitem_l_comment#2973,cval_lineitem_l_shipdate#2974,cdepval_lineitem_l_quantity#2975,cdepval_lineitem_l_extendedprice#2976,cdepval_lineitem_l_discount#2977,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :- Project [rid#2918 AS rid_1#2936, cpfk_nation_supplier#2919 AS cpfk_nation_supplier_1#2937, cfpk_supplier_nation#2920 AS cfpk_supplier_nation_1#2938, cval_supplier_s_name#2921 AS cval_supplier_s_name_1#2939, cval_supplier_s_address#2922 AS cval_supplier_s_address_1#2940, cval_supplier_s_phone#2923 AS cval_supplier_s_phone_1#2941, cval_supplier_s_acctbal#2924 AS cval_supplier_s_acctbal_1#2942, cval_supplier_s_comment#2925 AS cval_supplier_s_comment_1#2943, cdepval_supplier_s_name#2926 AS cdepval_supplier_s_name_1#2944, cdepval_supplier_s_address#2927 AS cdepval_supplier_s_address_1#2945, cdepval_supplier_s_phone#2928 AS cdepval_supplier_s_phone_1#2946, cdepval_supplier_s_acctbal#2929 AS cdepval_supplier_s_acctbal_1#2947, cdepval_supplier_s_comment#2930 AS cdepval_supplier_s_comment_1#2948, cs_name#2931 AS cs_name_1#2949, cs_address#2932 AS cs_address_1#2950, cs_phone#2933 AS cs_phone_1#2951, cs_acctbal#2934 AS cs_acctbal_1#2952, cs_comment#2935 AS cs_comment_1#2953]
         :     :  +- Relation[rid#2918,cpfk_nation_supplier#2919,cfpk_supplier_nation#2920,cval_supplier_s_name#2921,cval_supplier_s_address#2922,cval_supplier_s_phone#2923,cval_supplier_s_acctbal#2924,cval_supplier_s_comment#2925,cdepval_supplier_s_name#2926,cdepval_supplier_s_address#2927,cdepval_supplier_s_phone#2928,cdepval_supplier_s_acctbal#2929,cdepval_supplier_s_comment#2930,cs_name#2931,cs_address#2932,cs_phone#2933,cs_acctbal#2934,cs_comment#2935] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :        +- Project [rid#2882 AS rid_0#2891, cpfk_region_nation#2883 AS cpfk_region_nation_0#2892, cfpk_nation_region#2884 AS cfpk_nation_region_0#2893, cval_nation_n_name#2885 AS cval_nation_n_name_0#2894, cval_nation_n_comment#2886 AS cval_nation_n_comment_0#2895, cdepval_nation_n_name#2887 AS cdepval_nation_n_name_0#2896, cdepval_nation_n_comment#2888 AS cdepval_nation_n_comment_0#2897, cn_name#2889 AS cn_name_0#2898, cn_comment#2890 AS cn_comment_0#2899]
         :           +- Relation[rid#2882,cpfk_region_nation#2883,cfpk_nation_region#2884,cval_nation_n_name#2885,cval_nation_n_comment#2886,cdepval_nation_n_name#2887,cdepval_nation_n_comment#2888,cn_name#2889,cn_comment#2890] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#3122 AS rid_5#3146, cpfk_customer_orders#3123 AS cpfk_customer_orders_5#3147, cfpk_orders_customer#3124 AS cfpk_orders_customer_5#3148, cval_orders_o_orderstatus#3125 AS cval_orders_o_orderstatus_5#3149, cval_orders_o_totalprice#3126 AS cval_orders_o_totalprice_5#3150, cval_orders_o_orderpriority#3127 AS cval_orders_o_orderpriority_5#3151, cval_orders_o_clerk#3128 AS cval_orders_o_clerk_5#3152, cval_orders_o_shippriority#3129 AS cval_orders_o_shippriority_5#3153, cval_orders_o_comment#3130 AS cval_orders_o_comment_5#3154, cval_orders_o_orderdate#3131 AS cval_orders_o_orderdate_5#3155, cdepval_orders_o_orderstatus#3132 AS cdepval_orders_o_orderstatus_5#3156, cdepval_orders_o_totalprice#3133 AS cdepval_orders_o_totalprice_5#3157, cdepval_orders_o_orderpriority#3134 AS cdepval_orders_o_orderpriority_5#3158, cdepval_orders_o_clerk#3135 AS cdepval_orders_o_clerk_5#3159, cdepval_orders_o_shippriority#3136 AS cdepval_orders_o_shippriority_5#3160, cdepval_orders_o_comment#3137 AS cdepval_orders_o_comment_5#3161, cdepval_orders_o_orderdate#3138 AS cdepval_orders_o_orderdate_5#3162, co_orderstatus#3139 AS co_orderstatus_5#3163, co_totalprice#3140 AS co_totalprice_5#3164, co_orderpriority#3141 AS co_orderpriority_5#3165, co_clerk#3142 AS co_clerk_5#3166, co_shippriority#3143 AS co_shippriority_5#3167, co_comment#3144 AS co_comment_5#3168, co_orderdate#3145 AS co_orderdate_5#3169]
            :  +- Relation[rid#3122,cpfk_customer_orders#3123,cfpk_orders_customer#3124,cval_orders_o_orderstatus#3125,cval_orders_o_totalprice#3126,cval_orders_o_orderpriority#3127,cval_orders_o_clerk#3128,cval_orders_o_shippriority#3129,cval_orders_o_comment#3130,cval_orders_o_orderdate#3131,cdepval_orders_o_orderstatus#3132,cdepval_orders_o_totalprice#3133,cdepval_orders_o_orderpriority#3134,cdepval_orders_o_clerk#3135,cdepval_orders_o_shippriority#3136,cdepval_orders_o_comment#3137,cdepval_orders_o_orderdate#3138,co_orderstatus#3139,co_totalprice#3140,co_orderpriority#3141,co_clerk#3142,co_shippriority#3143,co_comment#3144,co_orderdate#3145] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_4, BinaryType)), 'cfpk_customer_nation_4) = 'rid_3)
               :- Project [rid#3080 AS rid_4#3101, cpfk_nation_customer#3081 AS cpfk_nation_customer_4#3102, cfpk_customer_nation#3082 AS cfpk_customer_nation_4#3103, cval_customer_c_name#3083 AS cval_customer_c_name_4#3104, cval_customer_c_address#3084 AS cval_customer_c_address_4#3105, cval_customer_c_phone#3085 AS cval_customer_c_phone_4#3106, cval_customer_c_acctbal#3086 AS cval_customer_c_acctbal_4#3107, cval_customer_c_comment#3087 AS cval_customer_c_comment_4#3108, cval_customer_c_mktsegment#3088 AS cval_customer_c_mktsegment_4#3109, cdepval_customer_c_name#3089 AS cdepval_customer_c_name_4#3110, cdepval_customer_c_address#3090 AS cdepval_customer_c_address_4#3111, cdepval_customer_c_phone#3091 AS cdepval_customer_c_phone_4#3112, cdepval_customer_c_acctbal#3092 AS cdepval_customer_c_acctbal_4#3113, cdepval_customer_c_comment#3093 AS cdepval_customer_c_comment_4#3114, cdepval_customer_c_mktsegment#3094 AS cdepval_customer_c_mktsegment_4#3115, cc_name#3095 AS cc_name_4#3116, cc_address#3096 AS cc_address_4#3117, cc_phone#3097 AS cc_phone_4#3118, cc_acctbal#3098 AS cc_acctbal_4#3119, cc_comment#3099 AS cc_comment_4#3120, cc_mktsegment#3100 AS cc_mktsegment_4#3121]
               :  +- Relation[rid#3080,cpfk_nation_customer#3081,cfpk_customer_nation#3082,cval_customer_c_name#3083,cval_customer_c_address#3084,cval_customer_c_phone#3085,cval_customer_c_acctbal#3086,cval_customer_c_comment#3087,cval_customer_c_mktsegment#3088,cdepval_customer_c_name#3089,cdepval_customer_c_address#3090,cdepval_customer_c_phone#3091,cdepval_customer_c_acctbal#3092,cdepval_customer_c_comment#3093,cdepval_customer_c_mktsegment#3094,cc_name#3095,cc_address#3096,cc_phone#3097,cc_acctbal#3098,cc_comment#3099,cc_mktsegment#3100] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
                  +- Project [rid#3044 AS rid_3#3053, cpfk_region_nation#3045 AS cpfk_region_nation_3#3054, cfpk_nation_region#3046 AS cfpk_nation_region_3#3055, cval_nation_n_name#3047 AS cval_nation_n_name_3#3056, cval_nation_n_comment#3048 AS cval_nation_n_comment_3#3057, cdepval_nation_n_name#3049 AS cdepval_nation_n_name_3#3058, cdepval_nation_n_comment#3050 AS cdepval_nation_n_comment_3#3059, cn_name#3051 AS cn_name_3#3060, cn_comment#3052 AS cn_comment_3#3061]
                     +- Relation[rid#3044,cpfk_region_nation#3045,cfpk_nation_region#3046,cval_nation_n_name#3047,cval_nation_n_comment#3048,cdepval_nation_n_name#3049,cdepval_nation_n_comment#3050,cn_name#3051,cn_comment#3052] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 35134ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/25 22:52:07 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:52:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3301L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 22:52:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3301L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#3303 AS rid_0#3327, cpfk_customer_orders#3304 AS cpfk_customer_orders_0#3328, cfpk_orders_customer#3305 AS cfpk_orders_customer_0#3329, cval_orders_o_orderstatus#3306 AS cval_orders_o_orderstatus_0#3330, cval_orders_o_totalprice#3307 AS cval_orders_o_totalprice_0#3331, cval_orders_o_orderpriority#3308 AS cval_orders_o_orderpriority_0#3332, cval_orders_o_clerk#3309 AS cval_orders_o_clerk_0#3333, cval_orders_o_shippriority#3310 AS cval_orders_o_shippriority_0#3334, cval_orders_o_comment#3311 AS cval_orders_o_comment_0#3335, cval_orders_o_orderdate#3312 AS cval_orders_o_orderdate_0#3336, cdepval_orders_o_orderstatus#3313 AS cdepval_orders_o_orderstatus_0#3337, cdepval_orders_o_totalprice#3314 AS cdepval_orders_o_totalprice_0#3338, cdepval_orders_o_orderpriority#3315 AS cdepval_orders_o_orderpriority_0#3339, cdepval_orders_o_clerk#3316 AS cdepval_orders_o_clerk_0#3340, cdepval_orders_o_shippriority#3317 AS cdepval_orders_o_shippriority_0#3341, cdepval_orders_o_comment#3318 AS cdepval_orders_o_comment_0#3342, cdepval_orders_o_orderdate#3319 AS cdepval_orders_o_orderdate_0#3343, co_orderstatus#3320 AS co_orderstatus_0#3344, co_totalprice#3321 AS co_totalprice_0#3345, co_orderpriority#3322 AS co_orderpriority_0#3346, co_clerk#3323 AS co_clerk_0#3347, co_shippriority#3324 AS co_shippriority_0#3348, co_comment#3325 AS co_comment_0#3349, co_orderdate#3326 AS co_orderdate_0#3350]
         :  +- Relation[rid#3303,cpfk_customer_orders#3304,cfpk_orders_customer#3305,cval_orders_o_orderstatus#3306,cval_orders_o_totalprice#3307,cval_orders_o_orderpriority#3308,cval_orders_o_clerk#3309,cval_orders_o_shippriority#3310,cval_orders_o_comment#3311,cval_orders_o_orderdate#3312,cdepval_orders_o_orderstatus#3313,cdepval_orders_o_totalprice#3314,cdepval_orders_o_orderpriority#3315,cdepval_orders_o_clerk#3316,cdepval_orders_o_shippriority#3317,cdepval_orders_o_comment#3318,cdepval_orders_o_orderdate#3319,co_orderstatus#3320,co_totalprice#3321,co_orderpriority#3322,co_clerk#3323,co_shippriority#3324,co_comment#3325,co_orderdate#3326] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#3351 AS rid_1#3372, cpfk_nation_customer#3352 AS cpfk_nation_customer_1#3373, cfpk_customer_nation#3353 AS cfpk_customer_nation_1#3374, cval_customer_c_name#3354 AS cval_customer_c_name_1#3375, cval_customer_c_address#3355 AS cval_customer_c_address_1#3376, cval_customer_c_phone#3356 AS cval_customer_c_phone_1#3377, cval_customer_c_acctbal#3357 AS cval_customer_c_acctbal_1#3378, cval_customer_c_comment#3358 AS cval_customer_c_comment_1#3379, cval_customer_c_mktsegment#3359 AS cval_customer_c_mktsegment_1#3380, cdepval_customer_c_name#3360 AS cdepval_customer_c_name_1#3381, cdepval_customer_c_address#3361 AS cdepval_customer_c_address_1#3382, cdepval_customer_c_phone#3362 AS cdepval_customer_c_phone_1#3383, cdepval_customer_c_acctbal#3363 AS cdepval_customer_c_acctbal_1#3384, cdepval_customer_c_comment#3364 AS cdepval_customer_c_comment_1#3385, cdepval_customer_c_mktsegment#3365 AS cdepval_customer_c_mktsegment_1#3386, cc_name#3366 AS cc_name_1#3387, cc_address#3367 AS cc_address_1#3388, cc_phone#3368 AS cc_phone_1#3389, cc_acctbal#3369 AS cc_acctbal_1#3390, cc_comment#3370 AS cc_comment_1#3391, cc_mktsegment#3371 AS cc_mktsegment_1#3392]
            +- Relation[rid#3351,cpfk_nation_customer#3352,cfpk_customer_nation#3353,cval_customer_c_name#3354,cval_customer_c_address#3355,cval_customer_c_phone#3356,cval_customer_c_acctbal#3357,cval_customer_c_comment#3358,cval_customer_c_mktsegment#3359,cdepval_customer_c_name#3360,cdepval_customer_c_address#3361,cdepval_customer_c_phone#3362,cdepval_customer_c_acctbal#3363,cdepval_customer_c_comment#3364,cdepval_customer_c_mktsegment#3365,cc_name#3366,cc_address#3367,cc_phone#3368,cc_acctbal#3369,cc_comment#3370,cc_mktsegment#3371] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4422ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/25 22:52:12 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:52:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3444L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 22:52:12 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:52:12 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:52:12 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:52:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:52:12 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:52:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:52:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:52:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:52:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:52:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:52:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:52:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3444L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#3582 AS rid_4#3627, cpfk_orders_lineitem#3583 AS cpfk_orders_lineitem_4#3628, cpfk_supplier_lineitem#3584 AS cpfk_supplier_lineitem_4#3629, cfpk_lineitem_supplier#3585 AS cfpk_lineitem_supplier_4#3630, cfpk_lineitem_partsupp#3586 AS cfpk_lineitem_partsupp_4#3631, cpfk_part_lineitem#3587 AS cpfk_part_lineitem_4#3632, cfpk_lineitem_part#3588 AS cfpk_lineitem_part_4#3633, cpfk_partsupp_lineitem#3589 AS cpfk_partsupp_lineitem_4#3634, cfpk_lineitem_orders#3590 AS cfpk_lineitem_orders_4#3635, cval_lineitem_l_quantity#3591 AS cval_lineitem_l_quantity_4#3636, cval_lineitem_l_extendedprice#3592 AS cval_lineitem_l_extendedprice_4#3637, cval_lineitem_l_discount#3593 AS cval_lineitem_l_discount_4#3638, cval_lineitem_l_tax#3594 AS cval_lineitem_l_tax_4#3639, cval_lineitem_l_returnflag#3595 AS cval_lineitem_l_returnflag_4#3640, cval_lineitem_l_linestatus#3596 AS cval_lineitem_l_linestatus_4#3641, cval_lineitem_l_commitdate#3597 AS cval_lineitem_l_commitdate_4#3642, cval_lineitem_l_receiptdate#3598 AS cval_lineitem_l_receiptdate_4#3643, cval_lineitem_l_shipinstruct#3599 AS cval_lineitem_l_shipinstruct_4#3644, cval_lineitem_l_shipmode#3600 AS cval_lineitem_l_shipmode_4#3645, cval_lineitem_l_comment#3601 AS cval_lineitem_l_comment_4#3646, cval_lineitem_l_shipdate#3602 AS cval_lineitem_l_shipdate_4#3647, cdepval_lineitem_l_quantity#3603 AS cdepval_lineitem_l_quantity_4#3648, cdepval_lineitem_l_extendedprice#3604 AS cdepval_lineitem_l_extendedprice_4#3649, cdepval_lineitem_l_discount#3605 AS cdepval_lineitem_l_discount_4#3650, ... 21 more fields]
            :  :  +- Relation[rid#3582,cpfk_orders_lineitem#3583,cpfk_supplier_lineitem#3584,cfpk_lineitem_supplier#3585,cfpk_lineitem_partsupp#3586,cpfk_part_lineitem#3587,cfpk_lineitem_part#3588,cpfk_partsupp_lineitem#3589,cfpk_lineitem_orders#3590,cval_lineitem_l_quantity#3591,cval_lineitem_l_extendedprice#3592,cval_lineitem_l_discount#3593,cval_lineitem_l_tax#3594,cval_lineitem_l_returnflag#3595,cval_lineitem_l_linestatus#3596,cval_lineitem_l_commitdate#3597,cval_lineitem_l_receiptdate#3598,cval_lineitem_l_shipinstruct#3599,cval_lineitem_l_shipmode#3600,cval_lineitem_l_comment#3601,cval_lineitem_l_shipdate#3602,cdepval_lineitem_l_quantity#3603,cdepval_lineitem_l_extendedprice#3604,cdepval_lineitem_l_discount#3605,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#3534 AS rid_3#3558, cpfk_customer_orders#3535 AS cpfk_customer_orders_3#3559, cfpk_orders_customer#3536 AS cfpk_orders_customer_3#3560, cval_orders_o_orderstatus#3537 AS cval_orders_o_orderstatus_3#3561, cval_orders_o_totalprice#3538 AS cval_orders_o_totalprice_3#3562, cval_orders_o_orderpriority#3539 AS cval_orders_o_orderpriority_3#3563, cval_orders_o_clerk#3540 AS cval_orders_o_clerk_3#3564, cval_orders_o_shippriority#3541 AS cval_orders_o_shippriority_3#3565, cval_orders_o_comment#3542 AS cval_orders_o_comment_3#3566, cval_orders_o_orderdate#3543 AS cval_orders_o_orderdate_3#3567, cdepval_orders_o_orderstatus#3544 AS cdepval_orders_o_orderstatus_3#3568, cdepval_orders_o_totalprice#3545 AS cdepval_orders_o_totalprice_3#3569, cdepval_orders_o_orderpriority#3546 AS cdepval_orders_o_orderpriority_3#3570, cdepval_orders_o_clerk#3547 AS cdepval_orders_o_clerk_3#3571, cdepval_orders_o_shippriority#3548 AS cdepval_orders_o_shippriority_3#3572, cdepval_orders_o_comment#3549 AS cdepval_orders_o_comment_3#3573, cdepval_orders_o_orderdate#3550 AS cdepval_orders_o_orderdate_3#3574, co_orderstatus#3551 AS co_orderstatus_3#3575, co_totalprice#3552 AS co_totalprice_3#3576, co_orderpriority#3553 AS co_orderpriority_3#3577, co_clerk#3554 AS co_clerk_3#3578, co_shippriority#3555 AS co_shippriority_3#3579, co_comment#3556 AS co_comment_3#3580, co_orderdate#3557 AS co_orderdate_3#3581]
            :     :  +- Relation[rid#3534,cpfk_customer_orders#3535,cfpk_orders_customer#3536,cval_orders_o_orderstatus#3537,cval_orders_o_totalprice#3538,cval_orders_o_orderpriority#3539,cval_orders_o_clerk#3540,cval_orders_o_shippriority#3541,cval_orders_o_comment#3542,cval_orders_o_orderdate#3543,cdepval_orders_o_orderstatus#3544,cdepval_orders_o_totalprice#3545,cdepval_orders_o_orderpriority#3546,cdepval_orders_o_clerk#3547,cdepval_orders_o_shippriority#3548,cdepval_orders_o_comment#3549,cdepval_orders_o_orderdate#3550,co_orderstatus#3551,co_totalprice#3552,co_orderpriority#3553,co_clerk#3554,co_shippriority#3555,co_comment#3556,co_orderdate#3557] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#3492 AS rid_2#3513, cpfk_nation_customer#3493 AS cpfk_nation_customer_2#3514, cfpk_customer_nation#3494 AS cfpk_customer_nation_2#3515, cval_customer_c_name#3495 AS cval_customer_c_name_2#3516, cval_customer_c_address#3496 AS cval_customer_c_address_2#3517, cval_customer_c_phone#3497 AS cval_customer_c_phone_2#3518, cval_customer_c_acctbal#3498 AS cval_customer_c_acctbal_2#3519, cval_customer_c_comment#3499 AS cval_customer_c_comment_2#3520, cval_customer_c_mktsegment#3500 AS cval_customer_c_mktsegment_2#3521, cdepval_customer_c_name#3501 AS cdepval_customer_c_name_2#3522, cdepval_customer_c_address#3502 AS cdepval_customer_c_address_2#3523, cdepval_customer_c_phone#3503 AS cdepval_customer_c_phone_2#3524, cdepval_customer_c_acctbal#3504 AS cdepval_customer_c_acctbal_2#3525, cdepval_customer_c_comment#3505 AS cdepval_customer_c_comment_2#3526, cdepval_customer_c_mktsegment#3506 AS cdepval_customer_c_mktsegment_2#3527, cc_name#3507 AS cc_name_2#3528, cc_address#3508 AS cc_address_2#3529, cc_phone#3509 AS cc_phone_2#3530, cc_acctbal#3510 AS cc_acctbal_2#3531, cc_comment#3511 AS cc_comment_2#3532, cc_mktsegment#3512 AS cc_mktsegment_2#3533]
            :        :  +- Relation[rid#3492,cpfk_nation_customer#3493,cfpk_customer_nation#3494,cval_customer_c_name#3495,cval_customer_c_address#3496,cval_customer_c_phone#3497,cval_customer_c_acctbal#3498,cval_customer_c_comment#3499,cval_customer_c_mktsegment#3500,cdepval_customer_c_name#3501,cdepval_customer_c_address#3502,cdepval_customer_c_phone#3503,cdepval_customer_c_acctbal#3504,cdepval_customer_c_comment#3505,cdepval_customer_c_mktsegment#3506,cc_name#3507,cc_address#3508,cc_phone#3509,cc_acctbal#3510,cc_comment#3511,cc_mktsegment#3512] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
            :           :- Project [rid#3474 AS rid_1#3483, cpfk_region_nation#3475 AS cpfk_region_nation_1#3484, cfpk_nation_region#3476 AS cfpk_nation_region_1#3485, cval_nation_n_name#3477 AS cval_nation_n_name_1#3486, cval_nation_n_comment#3478 AS cval_nation_n_comment_1#3487, cdepval_nation_n_name#3479 AS cdepval_nation_n_name_1#3488, cdepval_nation_n_comment#3480 AS cdepval_nation_n_comment_1#3489, cn_name#3481 AS cn_name_1#3490, cn_comment#3482 AS cn_comment_1#3491]
            :           :  +- Relation[rid#3474,cpfk_region_nation#3475,cfpk_nation_region#3476,cval_nation_n_name#3477,cval_nation_n_comment#3478,cdepval_nation_n_name#3479,cdepval_nation_n_comment#3480,cn_name#3481,cn_comment#3482] JDBCRelation(tnation) [numPartitions=1]
            :           +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :              +- Project [rid#3446 AS rid_0#3453, cval_region_r_name#3447 AS cval_region_r_name_0#3454, cval_region_r_comment#3448 AS cval_region_r_comment_0#3455, cdepval_region_r_name#3449 AS cdepval_region_r_name_0#3456, cdepval_region_r_comment#3450 AS cdepval_region_r_comment_0#3457, cr_name#3451 AS cr_name_0#3458, cr_comment#3452 AS cr_comment_0#3459]
            :                 +- Relation[rid#3446,cval_region_r_name#3447,cval_region_r_comment#3448,cdepval_region_r_name#3449,cdepval_region_r_comment#3450,cr_name#3451,cr_comment#3452] JDBCRelation(tregion) [numPartitions=1]
            +- Project [rid#3672 AS rid_5#3690, cpfk_nation_supplier#3673 AS cpfk_nation_supplier_5#3691, cfpk_supplier_nation#3674 AS cfpk_supplier_nation_5#3692, cval_supplier_s_name#3675 AS cval_supplier_s_name_5#3693, cval_supplier_s_address#3676 AS cval_supplier_s_address_5#3694, cval_supplier_s_phone#3677 AS cval_supplier_s_phone_5#3695, cval_supplier_s_acctbal#3678 AS cval_supplier_s_acctbal_5#3696, cval_supplier_s_comment#3679 AS cval_supplier_s_comment_5#3697, cdepval_supplier_s_name#3680 AS cdepval_supplier_s_name_5#3698, cdepval_supplier_s_address#3681 AS cdepval_supplier_s_address_5#3699, cdepval_supplier_s_phone#3682 AS cdepval_supplier_s_phone_5#3700, cdepval_supplier_s_acctbal#3683 AS cdepval_supplier_s_acctbal_5#3701, cdepval_supplier_s_comment#3684 AS cdepval_supplier_s_comment_5#3702, cs_name#3685 AS cs_name_5#3703, cs_address#3686 AS cs_address_5#3704, cs_phone#3687 AS cs_phone_5#3705, cs_acctbal#3688 AS cs_acctbal_5#3706, cs_comment#3689 AS cs_comment_5#3707]
               +- Relation[rid#3672,cpfk_nation_supplier#3673,cfpk_supplier_nation#3674,cval_supplier_s_name#3675,cval_supplier_s_address#3676,cval_supplier_s_phone#3677,cval_supplier_s_acctbal#3678,cval_supplier_s_comment#3679,cdepval_supplier_s_name#3680,cdepval_supplier_s_address#3681,cdepval_supplier_s_phone#3682,cdepval_supplier_s_acctbal#3683,cdepval_supplier_s_comment#3684,cs_name#3685,cs_address#3686,cs_phone#3687,cs_acctbal#3688,cs_comment#3689] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 30603ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/25 22:52:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:52:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3844L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 22:52:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:52:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:52:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3844L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#3846 AS rid_0#3891, cpfk_orders_lineitem#3847 AS cpfk_orders_lineitem_0#3892, cpfk_supplier_lineitem#3848 AS cpfk_supplier_lineitem_0#3893, cfpk_lineitem_supplier#3849 AS cfpk_lineitem_supplier_0#3894, cfpk_lineitem_partsupp#3850 AS cfpk_lineitem_partsupp_0#3895, cpfk_part_lineitem#3851 AS cpfk_part_lineitem_0#3896, cfpk_lineitem_part#3852 AS cfpk_lineitem_part_0#3897, cpfk_partsupp_lineitem#3853 AS cpfk_partsupp_lineitem_0#3898, cfpk_lineitem_orders#3854 AS cfpk_lineitem_orders_0#3899, cval_lineitem_l_quantity#3855 AS cval_lineitem_l_quantity_0#3900, cval_lineitem_l_extendedprice#3856 AS cval_lineitem_l_extendedprice_0#3901, cval_lineitem_l_discount#3857 AS cval_lineitem_l_discount_0#3902, cval_lineitem_l_tax#3858 AS cval_lineitem_l_tax_0#3903, cval_lineitem_l_returnflag#3859 AS cval_lineitem_l_returnflag_0#3904, cval_lineitem_l_linestatus#3860 AS cval_lineitem_l_linestatus_0#3905, cval_lineitem_l_commitdate#3861 AS cval_lineitem_l_commitdate_0#3906, cval_lineitem_l_receiptdate#3862 AS cval_lineitem_l_receiptdate_0#3907, cval_lineitem_l_shipinstruct#3863 AS cval_lineitem_l_shipinstruct_0#3908, cval_lineitem_l_shipmode#3864 AS cval_lineitem_l_shipmode_0#3909, cval_lineitem_l_comment#3865 AS cval_lineitem_l_comment_0#3910, cval_lineitem_l_shipdate#3866 AS cval_lineitem_l_shipdate_0#3911, cdepval_lineitem_l_quantity#3867 AS cdepval_lineitem_l_quantity_0#3912, cdepval_lineitem_l_extendedprice#3868 AS cdepval_lineitem_l_extendedprice_0#3913, cdepval_lineitem_l_discount#3869 AS cdepval_lineitem_l_discount_0#3914, ... 21 more fields]
         :  :  :     +- Relation[rid#3846,cpfk_orders_lineitem#3847,cpfk_supplier_lineitem#3848,cfpk_lineitem_supplier#3849,cfpk_lineitem_partsupp#3850,cpfk_part_lineitem#3851,cfpk_lineitem_part#3852,cpfk_partsupp_lineitem#3853,cfpk_lineitem_orders#3854,cval_lineitem_l_quantity#3855,cval_lineitem_l_extendedprice#3856,cval_lineitem_l_discount#3857,cval_lineitem_l_tax#3858,cval_lineitem_l_returnflag#3859,cval_lineitem_l_linestatus#3860,cval_lineitem_l_commitdate#3861,cval_lineitem_l_receiptdate#3862,cval_lineitem_l_shipinstruct#3863,cval_lineitem_l_shipmode#3864,cval_lineitem_l_comment#3865,cval_lineitem_l_shipdate#3866,cdepval_lineitem_l_quantity#3867,cdepval_lineitem_l_extendedprice#3868,cdepval_lineitem_l_discount#3869,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#4026 AS rid_1#4050, cpfk_customer_orders#4027 AS cpfk_customer_orders_1#4051, cfpk_orders_customer#4028 AS cfpk_orders_customer_1#4052, cval_orders_o_orderstatus#4029 AS cval_orders_o_orderstatus_1#4053, cval_orders_o_totalprice#4030 AS cval_orders_o_totalprice_1#4054, cval_orders_o_orderpriority#4031 AS cval_orders_o_orderpriority_1#4055, cval_orders_o_clerk#4032 AS cval_orders_o_clerk_1#4056, cval_orders_o_shippriority#4033 AS cval_orders_o_shippriority_1#4057, cval_orders_o_comment#4034 AS cval_orders_o_comment_1#4058, cval_orders_o_orderdate#4035 AS cval_orders_o_orderdate_1#4059, cdepval_orders_o_orderstatus#4036 AS cdepval_orders_o_orderstatus_1#4060, cdepval_orders_o_totalprice#4037 AS cdepval_orders_o_totalprice_1#4061, cdepval_orders_o_orderpriority#4038 AS cdepval_orders_o_orderpriority_1#4062, cdepval_orders_o_clerk#4039 AS cdepval_orders_o_clerk_1#4063, cdepval_orders_o_shippriority#4040 AS cdepval_orders_o_shippriority_1#4064, cdepval_orders_o_comment#4041 AS cdepval_orders_o_comment_1#4065, cdepval_orders_o_orderdate#4042 AS cdepval_orders_o_orderdate_1#4066, co_orderstatus#4043 AS co_orderstatus_1#4067, co_totalprice#4044 AS co_totalprice_1#4068, co_orderpriority#4045 AS co_orderpriority_1#4069, co_clerk#4046 AS co_clerk_1#4070, co_shippriority#4047 AS co_shippriority_1#4071, co_comment#4048 AS co_comment_1#4072, co_orderdate#4049 AS co_orderdate_1#4073]
         :  :     +- Relation[rid#4026,cpfk_customer_orders#4027,cfpk_orders_customer#4028,cval_orders_o_orderstatus#4029,cval_orders_o_totalprice#4030,cval_orders_o_orderpriority#4031,cval_orders_o_clerk#4032,cval_orders_o_shippriority#4033,cval_orders_o_comment#4034,cval_orders_o_orderdate#4035,cdepval_orders_o_orderstatus#4036,cdepval_orders_o_totalprice#4037,cdepval_orders_o_orderpriority#4038,cdepval_orders_o_clerk#4039,cdepval_orders_o_shippriority#4040,cdepval_orders_o_comment#4041,cdepval_orders_o_orderdate#4042,co_orderstatus#4043,co_totalprice#4044,co_orderpriority#4045,co_clerk#4046,co_shippriority#4047,co_comment#4048,co_orderdate#4049] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#4074 AS rid_2#4095, cpfk_nation_customer#4075 AS cpfk_nation_customer_2#4096, cfpk_customer_nation#4076 AS cfpk_customer_nation_2#4097, cval_customer_c_name#4077 AS cval_customer_c_name_2#4098, cval_customer_c_address#4078 AS cval_customer_c_address_2#4099, cval_customer_c_phone#4079 AS cval_customer_c_phone_2#4100, cval_customer_c_acctbal#4080 AS cval_customer_c_acctbal_2#4101, cval_customer_c_comment#4081 AS cval_customer_c_comment_2#4102, cval_customer_c_mktsegment#4082 AS cval_customer_c_mktsegment_2#4103, cdepval_customer_c_name#4083 AS cdepval_customer_c_name_2#4104, cdepval_customer_c_address#4084 AS cdepval_customer_c_address_2#4105, cdepval_customer_c_phone#4085 AS cdepval_customer_c_phone_2#4106, cdepval_customer_c_acctbal#4086 AS cdepval_customer_c_acctbal_2#4107, cdepval_customer_c_comment#4087 AS cdepval_customer_c_comment_2#4108, cdepval_customer_c_mktsegment#4088 AS cdepval_customer_c_mktsegment_2#4109, cc_name#4089 AS cc_name_2#4110, cc_address#4090 AS cc_address_2#4111, cc_phone#4091 AS cc_phone_2#4112, cc_acctbal#4092 AS cc_acctbal_2#4113, cc_comment#4093 AS cc_comment_2#4114, cc_mktsegment#4094 AS cc_mktsegment_2#4115]
         :     +- Relation[rid#4074,cpfk_nation_customer#4075,cfpk_customer_nation#4076,cval_customer_c_name#4077,cval_customer_c_address#4078,cval_customer_c_phone#4079,cval_customer_c_acctbal#4080,cval_customer_c_comment#4081,cval_customer_c_mktsegment#4082,cdepval_customer_c_name#4083,cdepval_customer_c_address#4084,cdepval_customer_c_phone#4085,cdepval_customer_c_acctbal#4086,cdepval_customer_c_comment#4087,cdepval_customer_c_mktsegment#4088,cc_name#4089,cc_address#4090,cc_phone#4091,cc_acctbal#4092,cc_comment#4093,cc_mktsegment#4094] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#4116 AS rid_3#4125, cpfk_region_nation#4117 AS cpfk_region_nation_3#4126, cfpk_nation_region#4118 AS cfpk_nation_region_3#4127, cval_nation_n_name#4119 AS cval_nation_n_name_3#4128, cval_nation_n_comment#4120 AS cval_nation_n_comment_3#4129, cdepval_nation_n_name#4121 AS cdepval_nation_n_name_3#4130, cdepval_nation_n_comment#4122 AS cdepval_nation_n_comment_3#4131, cn_name#4123 AS cn_name_3#4132, cn_comment#4124 AS cn_comment_3#4133]
            +- Relation[rid#4116,cpfk_region_nation#4117,cfpk_nation_region#4118,cval_nation_n_name#4119,cval_nation_n_comment#4120,cdepval_nation_n_name#4121,cdepval_nation_n_comment#4122,cn_name#4123,cn_comment#4124] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 60877ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/25 22:53:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:53:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4240L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:53:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:53:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:53:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:53:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:53:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:53:43 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:53:43 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:53:43 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:53:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:53:43 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:53:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:53:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:53:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4240L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :  :  :  :- Project [rid#4342 AS rid_1#4387, cpfk_orders_lineitem#4343 AS cpfk_orders_lineitem_1#4388, cpfk_supplier_lineitem#4344 AS cpfk_supplier_lineitem_1#4389, cfpk_lineitem_supplier#4345 AS cfpk_lineitem_supplier_1#4390, cfpk_lineitem_partsupp#4346 AS cfpk_lineitem_partsupp_1#4391, cpfk_part_lineitem#4347 AS cpfk_part_lineitem_1#4392, cfpk_lineitem_part#4348 AS cfpk_lineitem_part_1#4393, cpfk_partsupp_lineitem#4349 AS cpfk_partsupp_lineitem_1#4394, cfpk_lineitem_orders#4350 AS cfpk_lineitem_orders_1#4395, cval_lineitem_l_quantity#4351 AS cval_lineitem_l_quantity_1#4396, cval_lineitem_l_extendedprice#4352 AS cval_lineitem_l_extendedprice_1#4397, cval_lineitem_l_discount#4353 AS cval_lineitem_l_discount_1#4398, cval_lineitem_l_tax#4354 AS cval_lineitem_l_tax_1#4399, cval_lineitem_l_returnflag#4355 AS cval_lineitem_l_returnflag_1#4400, cval_lineitem_l_linestatus#4356 AS cval_lineitem_l_linestatus_1#4401, cval_lineitem_l_commitdate#4357 AS cval_lineitem_l_commitdate_1#4402, cval_lineitem_l_receiptdate#4358 AS cval_lineitem_l_receiptdate_1#4403, cval_lineitem_l_shipinstruct#4359 AS cval_lineitem_l_shipinstruct_1#4404, cval_lineitem_l_shipmode#4360 AS cval_lineitem_l_shipmode_1#4405, cval_lineitem_l_comment#4361 AS cval_lineitem_l_comment_1#4406, cval_lineitem_l_shipdate#4362 AS cval_lineitem_l_shipdate_1#4407, cdepval_lineitem_l_quantity#4363 AS cdepval_lineitem_l_quantity_1#4408, cdepval_lineitem_l_extendedprice#4364 AS cdepval_lineitem_l_extendedprice_1#4409, cdepval_lineitem_l_discount#4365 AS cdepval_lineitem_l_discount_1#4410, ... 21 more fields]
         :  :  :  :  +- Relation[rid#4342,cpfk_orders_lineitem#4343,cpfk_supplier_lineitem#4344,cfpk_lineitem_supplier#4345,cfpk_lineitem_partsupp#4346,cpfk_part_lineitem#4347,cfpk_lineitem_part#4348,cpfk_partsupp_lineitem#4349,cfpk_lineitem_orders#4350,cval_lineitem_l_quantity#4351,cval_lineitem_l_extendedprice#4352,cval_lineitem_l_discount#4353,cval_lineitem_l_tax#4354,cval_lineitem_l_returnflag#4355,cval_lineitem_l_linestatus#4356,cval_lineitem_l_commitdate#4357,cval_lineitem_l_receiptdate#4358,cval_lineitem_l_shipinstruct#4359,cval_lineitem_l_shipmode#4360,cval_lineitem_l_comment#4361,cval_lineitem_l_shipdate#4362,cdepval_lineitem_l_quantity#4363,cdepval_lineitem_l_extendedprice#4364,cdepval_lineitem_l_discount#4365,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :     +- Project [rid#4242 AS rid_0#4267, cval_part_p_name#4243 AS cval_part_p_name_0#4268, cval_part_p_mfgr#4244 AS cval_part_p_mfgr_0#4269, cval_part_p_type#4245 AS cval_part_p_type_0#4270, cval_part_p_size#4246 AS cval_part_p_size_0#4271, cval_part_p_container#4247 AS cval_part_p_container_0#4272, cval_part_p_retailprice#4248 AS cval_part_p_retailprice_0#4273, cval_part_p_comment#4249 AS cval_part_p_comment_0#4274, cval_part_p_brand#4250 AS cval_part_p_brand_0#4275, cdepval_part_p_name#4251 AS cdepval_part_p_name_0#4276, cdepval_part_p_mfgr#4252 AS cdepval_part_p_mfgr_0#4277, cdepval_part_p_type#4253 AS cdepval_part_p_type_0#4278, cdepval_part_p_size#4254 AS cdepval_part_p_size_0#4279, cdepval_part_p_container#4255 AS cdepval_part_p_container_0#4280, cdepval_part_p_retailprice#4256 AS cdepval_part_p_retailprice_0#4281, cdepval_part_p_comment#4257 AS cdepval_part_p_comment_0#4282, cdepval_part_p_brand#4258 AS cdepval_part_p_brand_0#4283, cp_name#4259 AS cp_name_0#4284, cp_mfgr#4260 AS cp_mfgr_0#4285, cp_type#4261 AS cp_type_0#4286, cp_size#4262 AS cp_size_0#4287, cp_container#4263 AS cp_container_0#4288, cp_retailprice#4264 AS cp_retailprice_0#4289, cp_comment#4265 AS cp_comment_0#4290, cp_brand#4266 AS cp_brand_0#4291]
         :  :  :        +- Relation[rid#4242,cval_part_p_name#4243,cval_part_p_mfgr#4244,cval_part_p_type#4245,cval_part_p_size#4246,cval_part_p_container#4247,cval_part_p_retailprice#4248,cval_part_p_comment#4249,cval_part_p_brand#4250,cdepval_part_p_name#4251,cdepval_part_p_mfgr#4252,cdepval_part_p_type#4253,cdepval_part_p_size#4254,cdepval_part_p_container#4255,cdepval_part_p_retailprice#4256,cdepval_part_p_comment#4257,cdepval_part_p_brand#4258,cp_name#4259,cp_mfgr#4260,cp_type#4261,cp_size#4262,cp_container#4263,cp_retailprice#4264,cp_comment#4265,cp_brand#4266] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- Project [rid#4432 AS rid_2#4450, cpfk_nation_supplier#4433 AS cpfk_nation_supplier_2#4451, cfpk_supplier_nation#4434 AS cfpk_supplier_nation_2#4452, cval_supplier_s_name#4435 AS cval_supplier_s_name_2#4453, cval_supplier_s_address#4436 AS cval_supplier_s_address_2#4454, cval_supplier_s_phone#4437 AS cval_supplier_s_phone_2#4455, cval_supplier_s_acctbal#4438 AS cval_supplier_s_acctbal_2#4456, cval_supplier_s_comment#4439 AS cval_supplier_s_comment_2#4457, cdepval_supplier_s_name#4440 AS cdepval_supplier_s_name_2#4458, cdepval_supplier_s_address#4441 AS cdepval_supplier_s_address_2#4459, cdepval_supplier_s_phone#4442 AS cdepval_supplier_s_phone_2#4460, cdepval_supplier_s_acctbal#4443 AS cdepval_supplier_s_acctbal_2#4461, cdepval_supplier_s_comment#4444 AS cdepval_supplier_s_comment_2#4462, cs_name#4445 AS cs_name_2#4463, cs_address#4446 AS cs_address_2#4464, cs_phone#4447 AS cs_phone_2#4465, cs_acctbal#4448 AS cs_acctbal_2#4466, cs_comment#4449 AS cs_comment_2#4467]
         :  :     +- Relation[rid#4432,cpfk_nation_supplier#4433,cfpk_supplier_nation#4434,cval_supplier_s_name#4435,cval_supplier_s_address#4436,cval_supplier_s_phone#4437,cval_supplier_s_acctbal#4438,cval_supplier_s_comment#4439,cdepval_supplier_s_name#4440,cdepval_supplier_s_address#4441,cdepval_supplier_s_phone#4442,cdepval_supplier_s_acctbal#4443,cdepval_supplier_s_comment#4444,cs_name#4445,cs_address#4446,cs_phone#4447,cs_acctbal#4448,cs_comment#4449] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#4468 AS rid_3#4477, cpfk_region_nation#4469 AS cpfk_region_nation_3#4478, cfpk_nation_region#4470 AS cfpk_nation_region_3#4479, cval_nation_n_name#4471 AS cval_nation_n_name_3#4480, cval_nation_n_comment#4472 AS cval_nation_n_comment_3#4481, cdepval_nation_n_name#4473 AS cdepval_nation_n_name_3#4482, cdepval_nation_n_comment#4474 AS cdepval_nation_n_comment_3#4483, cn_name#4475 AS cn_name_3#4484, cn_comment#4476 AS cn_comment_3#4485]
         :     +- Relation[rid#4468,cpfk_region_nation#4469,cfpk_nation_region#4470,cval_nation_n_name#4471,cval_nation_n_comment#4472,cdepval_nation_n_name#4473,cdepval_nation_n_comment#4474,cn_name#4475,cn_comment#4476] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#4574 AS rid_7#4598, cpfk_customer_orders#4575 AS cpfk_customer_orders_7#4599, cfpk_orders_customer#4576 AS cfpk_orders_customer_7#4600, cval_orders_o_orderstatus#4577 AS cval_orders_o_orderstatus_7#4601, cval_orders_o_totalprice#4578 AS cval_orders_o_totalprice_7#4602, cval_orders_o_orderpriority#4579 AS cval_orders_o_orderpriority_7#4603, cval_orders_o_clerk#4580 AS cval_orders_o_clerk_7#4604, cval_orders_o_shippriority#4581 AS cval_orders_o_shippriority_7#4605, cval_orders_o_comment#4582 AS cval_orders_o_comment_7#4606, cval_orders_o_orderdate#4583 AS cval_orders_o_orderdate_7#4607, cdepval_orders_o_orderstatus#4584 AS cdepval_orders_o_orderstatus_7#4608, cdepval_orders_o_totalprice#4585 AS cdepval_orders_o_totalprice_7#4609, cdepval_orders_o_orderpriority#4586 AS cdepval_orders_o_orderpriority_7#4610, cdepval_orders_o_clerk#4587 AS cdepval_orders_o_clerk_7#4611, cdepval_orders_o_shippriority#4588 AS cdepval_orders_o_shippriority_7#4612, cdepval_orders_o_comment#4589 AS cdepval_orders_o_comment_7#4613, cdepval_orders_o_orderdate#4590 AS cdepval_orders_o_orderdate_7#4614, co_orderstatus#4591 AS co_orderstatus_7#4615, co_totalprice#4592 AS co_totalprice_7#4616, co_orderpriority#4593 AS co_orderpriority_7#4617, co_clerk#4594 AS co_clerk_7#4618, co_shippriority#4595 AS co_shippriority_7#4619, co_comment#4596 AS co_comment_7#4620, co_orderdate#4597 AS co_orderdate_7#4621]
            :  +- Relation[rid#4574,cpfk_customer_orders#4575,cfpk_orders_customer#4576,cval_orders_o_orderstatus#4577,cval_orders_o_totalprice#4578,cval_orders_o_orderpriority#4579,cval_orders_o_clerk#4580,cval_orders_o_shippriority#4581,cval_orders_o_comment#4582,cval_orders_o_orderdate#4583,cdepval_orders_o_orderstatus#4584,cdepval_orders_o_totalprice#4585,cdepval_orders_o_orderpriority#4586,cdepval_orders_o_clerk#4587,cdepval_orders_o_shippriority#4588,cdepval_orders_o_comment#4589,cdepval_orders_o_orderdate#4590,co_orderstatus#4591,co_totalprice#4592,co_orderpriority#4593,co_clerk#4594,co_shippriority#4595,co_comment#4596,co_orderdate#4597] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#4532 AS rid_6#4553, cpfk_nation_customer#4533 AS cpfk_nation_customer_6#4554, cfpk_customer_nation#4534 AS cfpk_customer_nation_6#4555, cval_customer_c_name#4535 AS cval_customer_c_name_6#4556, cval_customer_c_address#4536 AS cval_customer_c_address_6#4557, cval_customer_c_phone#4537 AS cval_customer_c_phone_6#4558, cval_customer_c_acctbal#4538 AS cval_customer_c_acctbal_6#4559, cval_customer_c_comment#4539 AS cval_customer_c_comment_6#4560, cval_customer_c_mktsegment#4540 AS cval_customer_c_mktsegment_6#4561, cdepval_customer_c_name#4541 AS cdepval_customer_c_name_6#4562, cdepval_customer_c_address#4542 AS cdepval_customer_c_address_6#4563, cdepval_customer_c_phone#4543 AS cdepval_customer_c_phone_6#4564, cdepval_customer_c_acctbal#4544 AS cdepval_customer_c_acctbal_6#4565, cdepval_customer_c_comment#4545 AS cdepval_customer_c_comment_6#4566, cdepval_customer_c_mktsegment#4546 AS cdepval_customer_c_mktsegment_6#4567, cc_name#4547 AS cc_name_6#4568, cc_address#4548 AS cc_address_6#4569, cc_phone#4549 AS cc_phone_6#4570, cc_acctbal#4550 AS cc_acctbal_6#4571, cc_comment#4551 AS cc_comment_6#4572, cc_mktsegment#4552 AS cc_mktsegment_6#4573]
               :  +- Relation[rid#4532,cpfk_nation_customer#4533,cfpk_customer_nation#4534,cval_customer_c_name#4535,cval_customer_c_address#4536,cval_customer_c_phone#4537,cval_customer_c_acctbal#4538,cval_customer_c_comment#4539,cval_customer_c_mktsegment#4540,cdepval_customer_c_name#4541,cdepval_customer_c_address#4542,cdepval_customer_c_phone#4543,cdepval_customer_c_acctbal#4544,cdepval_customer_c_comment#4545,cdepval_customer_c_mktsegment#4546,cc_name#4547,cc_address#4548,cc_phone#4549,cc_acctbal#4550,cc_comment#4551,cc_mktsegment#4552] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_5, BinaryType)), 'cfpk_nation_region_5) = 'rid_4)
                  :- Project [rid#4514 AS rid_5#4523, cpfk_region_nation#4515 AS cpfk_region_nation_5#4524, cfpk_nation_region#4516 AS cfpk_nation_region_5#4525, cval_nation_n_name#4517 AS cval_nation_n_name_5#4526, cval_nation_n_comment#4518 AS cval_nation_n_comment_5#4527, cdepval_nation_n_name#4519 AS cdepval_nation_n_name_5#4528, cdepval_nation_n_comment#4520 AS cdepval_nation_n_comment_5#4529, cn_name#4521 AS cn_name_5#4530, cn_comment#4522 AS cn_comment_5#4531]
                  :  +- Relation[rid#4514,cpfk_region_nation#4515,cfpk_nation_region#4516,cval_nation_n_name#4517,cval_nation_n_comment#4518,cdepval_nation_n_name#4519,cdepval_nation_n_comment#4520,cn_name#4521,cn_comment#4522] JDBCRelation(tnation) [numPartitions=1]
                  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                     +- Project [rid#4486 AS rid_4#4493, cval_region_r_name#4487 AS cval_region_r_name_4#4494, cval_region_r_comment#4488 AS cval_region_r_comment_4#4495, cdepval_region_r_name#4489 AS cdepval_region_r_name_4#4496, cdepval_region_r_comment#4490 AS cdepval_region_r_comment_4#4497, cr_name#4491 AS cr_name_4#4498, cr_comment#4492 AS cr_comment_4#4499]
                        +- Relation[rid#4486,cval_region_r_name#4487,cval_region_r_comment#4488,cdepval_region_r_name#4489,cdepval_region_r_comment#4490,cr_name#4491,cr_comment#4492] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 44742ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/25 22:54:28 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:54:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4784L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:54:28 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:54:28 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:54:28 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:54:28 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:54:28 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:54:28 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:54:28 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:54:28 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:54:28 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:54:28 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:54:28 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:54:28 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:54:28 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:54:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4784L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_part_4) = 'rid_3)
         :  :- Project [rid#4968 AS rid_4#4982, cpfk_part_partsupp#4969 AS cpfk_part_partsupp_4#4983, cfpk_partsupp_part#4970 AS cfpk_partsupp_part_4#4984, cpfk_supplier_partsupp#4971 AS cpfk_supplier_partsupp_4#4985, cfpk_partsupp_supplier#4972 AS cfpk_partsupp_supplier_4#4986, cval_partsupp_ps_availqty#4973 AS cval_partsupp_ps_availqty_4#4987, cval_partsupp_ps_supplycost#4974 AS cval_partsupp_ps_supplycost_4#4988, cval_partsupp_ps_comment#4975 AS cval_partsupp_ps_comment_4#4989, cdepval_partsupp_ps_availqty#4976 AS cdepval_partsupp_ps_availqty_4#4990, cdepval_partsupp_ps_supplycost#4977 AS cdepval_partsupp_ps_supplycost_4#4991, cdepval_partsupp_ps_comment#4978 AS cdepval_partsupp_ps_comment_4#4992, cps_availqty#4979 AS cps_availqty_4#4993, cps_supplycost#4980 AS cps_supplycost_4#4994, cps_comment#4981 AS cps_comment_4#4995]
         :  :  +- Relation[rid#4968,cpfk_part_partsupp#4969,cfpk_partsupp_part#4970,cpfk_supplier_partsupp#4971,cfpk_partsupp_supplier#4972,cval_partsupp_ps_availqty#4973,cval_partsupp_ps_supplycost#4974,cval_partsupp_ps_comment#4975,cdepval_partsupp_ps_availqty#4976,cdepval_partsupp_ps_supplycost#4977,cdepval_partsupp_ps_comment#4978,cps_availqty#4979,cps_supplycost#4980,cps_comment#4981] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :     +- Project [rid#4868 AS rid_3#4893, cval_part_p_name#4869 AS cval_part_p_name_3#4894, cval_part_p_mfgr#4870 AS cval_part_p_mfgr_3#4895, cval_part_p_type#4871 AS cval_part_p_type_3#4896, cval_part_p_size#4872 AS cval_part_p_size_3#4897, cval_part_p_container#4873 AS cval_part_p_container_3#4898, cval_part_p_retailprice#4874 AS cval_part_p_retailprice_3#4899, cval_part_p_comment#4875 AS cval_part_p_comment_3#4900, cval_part_p_brand#4876 AS cval_part_p_brand_3#4901, cdepval_part_p_name#4877 AS cdepval_part_p_name_3#4902, cdepval_part_p_mfgr#4878 AS cdepval_part_p_mfgr_3#4903, cdepval_part_p_type#4879 AS cdepval_part_p_type_3#4904, cdepval_part_p_size#4880 AS cdepval_part_p_size_3#4905, cdepval_part_p_container#4881 AS cdepval_part_p_container_3#4906, cdepval_part_p_retailprice#4882 AS cdepval_part_p_retailprice_3#4907, cdepval_part_p_comment#4883 AS cdepval_part_p_comment_3#4908, cdepval_part_p_brand#4884 AS cdepval_part_p_brand_3#4909, cp_name#4885 AS cp_name_3#4910, cp_mfgr#4886 AS cp_mfgr_3#4911, cp_type#4887 AS cp_type_3#4912, cp_size#4888 AS cp_size_3#4913, cp_container#4889 AS cp_container_3#4914, cp_retailprice#4890 AS cp_retailprice_3#4915, cp_comment#4891 AS cp_comment_3#4916, cp_brand#4892 AS cp_brand_3#4917]
         :        +- Relation[rid#4868,cval_part_p_name#4869,cval_part_p_mfgr#4870,cval_part_p_type#4871,cval_part_p_size#4872,cval_part_p_container#4873,cval_part_p_retailprice#4874,cval_part_p_comment#4875,cval_part_p_brand#4876,cdepval_part_p_name#4877,cdepval_part_p_mfgr#4878,cdepval_part_p_type#4879,cdepval_part_p_size#4880,cdepval_part_p_container#4881,cdepval_part_p_retailprice#4882,cdepval_part_p_comment#4883,cdepval_part_p_brand#4884,cp_name#4885,cp_mfgr#4886,cp_type#4887,cp_size#4888,cp_container#4889,cp_retailprice#4890,cp_comment#4891,cp_brand#4892] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#4832 AS rid_2#4850, cpfk_nation_supplier#4833 AS cpfk_nation_supplier_2#4851, cfpk_supplier_nation#4834 AS cfpk_supplier_nation_2#4852, cval_supplier_s_name#4835 AS cval_supplier_s_name_2#4853, cval_supplier_s_address#4836 AS cval_supplier_s_address_2#4854, cval_supplier_s_phone#4837 AS cval_supplier_s_phone_2#4855, cval_supplier_s_acctbal#4838 AS cval_supplier_s_acctbal_2#4856, cval_supplier_s_comment#4839 AS cval_supplier_s_comment_2#4857, cdepval_supplier_s_name#4840 AS cdepval_supplier_s_name_2#4858, cdepval_supplier_s_address#4841 AS cdepval_supplier_s_address_2#4859, cdepval_supplier_s_phone#4842 AS cdepval_supplier_s_phone_2#4860, cdepval_supplier_s_acctbal#4843 AS cdepval_supplier_s_acctbal_2#4861, cdepval_supplier_s_comment#4844 AS cdepval_supplier_s_comment_2#4862, cs_name#4845 AS cs_name_2#4863, cs_address#4846 AS cs_address_2#4864, cs_phone#4847 AS cs_phone_2#4865, cs_acctbal#4848 AS cs_acctbal_2#4866, cs_comment#4849 AS cs_comment_2#4867]
            :  +- Relation[rid#4832,cpfk_nation_supplier#4833,cfpk_supplier_nation#4834,cval_supplier_s_name#4835,cval_supplier_s_address#4836,cval_supplier_s_phone#4837,cval_supplier_s_acctbal#4838,cval_supplier_s_comment#4839,cdepval_supplier_s_name#4840,cdepval_supplier_s_address#4841,cdepval_supplier_s_phone#4842,cdepval_supplier_s_acctbal#4843,cdepval_supplier_s_comment#4844,cs_name#4845,cs_address#4846,cs_phone#4847,cs_acctbal#4848,cs_comment#4849] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
               :- Project [rid#4814 AS rid_1#4823, cpfk_region_nation#4815 AS cpfk_region_nation_1#4824, cfpk_nation_region#4816 AS cfpk_nation_region_1#4825, cval_nation_n_name#4817 AS cval_nation_n_name_1#4826, cval_nation_n_comment#4818 AS cval_nation_n_comment_1#4827, cdepval_nation_n_name#4819 AS cdepval_nation_n_name_1#4828, cdepval_nation_n_comment#4820 AS cdepval_nation_n_comment_1#4829, cn_name#4821 AS cn_name_1#4830, cn_comment#4822 AS cn_comment_1#4831]
               :  +- Relation[rid#4814,cpfk_region_nation#4815,cfpk_nation_region#4816,cval_nation_n_name#4817,cval_nation_n_comment#4818,cdepval_nation_n_name#4819,cdepval_nation_n_comment#4820,cn_name#4821,cn_comment#4822] JDBCRelation(tnation) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
                  +- Project [rid#4786 AS rid_0#4793, cval_region_r_name#4787 AS cval_region_r_name_0#4794, cval_region_r_comment#4788 AS cval_region_r_comment_0#4795, cdepval_region_r_name#4789 AS cdepval_region_r_name_0#4796, cdepval_region_r_comment#4790 AS cdepval_region_r_comment_0#4797, cr_name#4791 AS cr_name_0#4798, cr_comment#4792 AS cr_comment_0#4799]
                     +- Relation[rid#4786,cval_region_r_name#4787,cval_region_r_comment#4788,cdepval_region_r_name#4789,cdepval_region_r_comment#4790,cr_name#4791,cr_comment#4792] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 3703ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/25 22:54:31 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:54:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5075L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:54:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:54:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:54:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:54:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:54:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:54:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:54:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:54:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:54:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:54:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5075L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#5149 AS rid_2#5163, cpfk_part_partsupp#5150 AS cpfk_part_partsupp_2#5164, cfpk_partsupp_part#5151 AS cfpk_partsupp_part_2#5165, cpfk_supplier_partsupp#5152 AS cpfk_supplier_partsupp_2#5166, cfpk_partsupp_supplier#5153 AS cfpk_partsupp_supplier_2#5167, cval_partsupp_ps_availqty#5154 AS cval_partsupp_ps_availqty_2#5168, cval_partsupp_ps_supplycost#5155 AS cval_partsupp_ps_supplycost_2#5169, cval_partsupp_ps_comment#5156 AS cval_partsupp_ps_comment_2#5170, cdepval_partsupp_ps_availqty#5157 AS cdepval_partsupp_ps_availqty_2#5171, cdepval_partsupp_ps_supplycost#5158 AS cdepval_partsupp_ps_supplycost_2#5172, cdepval_partsupp_ps_comment#5159 AS cdepval_partsupp_ps_comment_2#5173, cps_availqty#5160 AS cps_availqty_2#5174, cps_supplycost#5161 AS cps_supplycost_2#5175, cps_comment#5162 AS cps_comment_2#5176]
         :  +- Relation[rid#5149,cpfk_part_partsupp#5150,cfpk_partsupp_part#5151,cpfk_supplier_partsupp#5152,cfpk_partsupp_supplier#5153,cval_partsupp_ps_availqty#5154,cval_partsupp_ps_supplycost#5155,cval_partsupp_ps_comment#5156,cdepval_partsupp_ps_availqty#5157,cdepval_partsupp_ps_supplycost#5158,cdepval_partsupp_ps_comment#5159,cps_availqty#5160,cps_supplycost#5161,cps_comment#5162] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
            :- Project [rid#5113 AS rid_1#5131, cpfk_nation_supplier#5114 AS cpfk_nation_supplier_1#5132, cfpk_supplier_nation#5115 AS cfpk_supplier_nation_1#5133, cval_supplier_s_name#5116 AS cval_supplier_s_name_1#5134, cval_supplier_s_address#5117 AS cval_supplier_s_address_1#5135, cval_supplier_s_phone#5118 AS cval_supplier_s_phone_1#5136, cval_supplier_s_acctbal#5119 AS cval_supplier_s_acctbal_1#5137, cval_supplier_s_comment#5120 AS cval_supplier_s_comment_1#5138, cdepval_supplier_s_name#5121 AS cdepval_supplier_s_name_1#5139, cdepval_supplier_s_address#5122 AS cdepval_supplier_s_address_1#5140, cdepval_supplier_s_phone#5123 AS cdepval_supplier_s_phone_1#5141, cdepval_supplier_s_acctbal#5124 AS cdepval_supplier_s_acctbal_1#5142, cdepval_supplier_s_comment#5125 AS cdepval_supplier_s_comment_1#5143, cs_name#5126 AS cs_name_1#5144, cs_address#5127 AS cs_address_1#5145, cs_phone#5128 AS cs_phone_1#5146, cs_acctbal#5129 AS cs_acctbal_1#5147, cs_comment#5130 AS cs_comment_1#5148]
            :  +- Relation[rid#5113,cpfk_nation_supplier#5114,cfpk_supplier_nation#5115,cval_supplier_s_name#5116,cval_supplier_s_address#5117,cval_supplier_s_phone#5118,cval_supplier_s_acctbal#5119,cval_supplier_s_comment#5120,cdepval_supplier_s_name#5121,cdepval_supplier_s_address#5122,cdepval_supplier_s_phone#5123,cdepval_supplier_s_acctbal#5124,cdepval_supplier_s_comment#5125,cs_name#5126,cs_address#5127,cs_phone#5128,cs_acctbal#5129,cs_comment#5130] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
               +- Project [rid#5077 AS rid_0#5086, cpfk_region_nation#5078 AS cpfk_region_nation_0#5087, cfpk_nation_region#5079 AS cfpk_nation_region_0#5088, cval_nation_n_name#5080 AS cval_nation_n_name_0#5089, cval_nation_n_comment#5081 AS cval_nation_n_comment_0#5090, cdepval_nation_n_name#5082 AS cdepval_nation_n_name_0#5091, cdepval_nation_n_comment#5083 AS cdepval_nation_n_comment_0#5092, cn_name#5084 AS cn_name_0#5093, cn_comment#5085 AS cn_comment_0#5094]
                  +- Relation[rid#5077,cpfk_region_nation#5078,cfpk_nation_region#5079,cval_nation_n_name#5080,cval_nation_n_comment#5081,cdepval_nation_n_name#5082,cdepval_nation_n_comment#5083,cn_name#5084,cn_comment#5085] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 3423ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/25 22:54:35 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:54:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5222L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 22:54:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5222L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#5224 AS rid_0#5248, cpfk_customer_orders#5225 AS cpfk_customer_orders_0#5249, cfpk_orders_customer#5226 AS cfpk_orders_customer_0#5250, cval_orders_o_orderstatus#5227 AS cval_orders_o_orderstatus_0#5251, cval_orders_o_totalprice#5228 AS cval_orders_o_totalprice_0#5252, cval_orders_o_orderpriority#5229 AS cval_orders_o_orderpriority_0#5253, cval_orders_o_clerk#5230 AS cval_orders_o_clerk_0#5254, cval_orders_o_shippriority#5231 AS cval_orders_o_shippriority_0#5255, cval_orders_o_comment#5232 AS cval_orders_o_comment_0#5256, cval_orders_o_orderdate#5233 AS cval_orders_o_orderdate_0#5257, cdepval_orders_o_orderstatus#5234 AS cdepval_orders_o_orderstatus_0#5258, cdepval_orders_o_totalprice#5235 AS cdepval_orders_o_totalprice_0#5259, cdepval_orders_o_orderpriority#5236 AS cdepval_orders_o_orderpriority_0#5260, cdepval_orders_o_clerk#5237 AS cdepval_orders_o_clerk_0#5261, cdepval_orders_o_shippriority#5238 AS cdepval_orders_o_shippriority_0#5262, cdepval_orders_o_comment#5239 AS cdepval_orders_o_comment_0#5263, cdepval_orders_o_orderdate#5240 AS cdepval_orders_o_orderdate_0#5264, co_orderstatus#5241 AS co_orderstatus_0#5265, co_totalprice#5242 AS co_totalprice_0#5266, co_orderpriority#5243 AS co_orderpriority_0#5267, co_clerk#5244 AS co_clerk_0#5268, co_shippriority#5245 AS co_shippriority_0#5269, co_comment#5246 AS co_comment_0#5270, co_orderdate#5247 AS co_orderdate_0#5271]
         :  +- Relation[rid#5224,cpfk_customer_orders#5225,cfpk_orders_customer#5226,cval_orders_o_orderstatus#5227,cval_orders_o_totalprice#5228,cval_orders_o_orderpriority#5229,cval_orders_o_clerk#5230,cval_orders_o_shippriority#5231,cval_orders_o_comment#5232,cval_orders_o_orderdate#5233,cdepval_orders_o_orderstatus#5234,cdepval_orders_o_totalprice#5235,cdepval_orders_o_orderpriority#5236,cdepval_orders_o_clerk#5237,cdepval_orders_o_shippriority#5238,cdepval_orders_o_comment#5239,cdepval_orders_o_orderdate#5240,co_orderstatus#5241,co_totalprice#5242,co_orderpriority#5243,co_clerk#5244,co_shippriority#5245,co_comment#5246,co_orderdate#5247] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#5272 AS rid_1#5293, cpfk_nation_customer#5273 AS cpfk_nation_customer_1#5294, cfpk_customer_nation#5274 AS cfpk_customer_nation_1#5295, cval_customer_c_name#5275 AS cval_customer_c_name_1#5296, cval_customer_c_address#5276 AS cval_customer_c_address_1#5297, cval_customer_c_phone#5277 AS cval_customer_c_phone_1#5298, cval_customer_c_acctbal#5278 AS cval_customer_c_acctbal_1#5299, cval_customer_c_comment#5279 AS cval_customer_c_comment_1#5300, cval_customer_c_mktsegment#5280 AS cval_customer_c_mktsegment_1#5301, cdepval_customer_c_name#5281 AS cdepval_customer_c_name_1#5302, cdepval_customer_c_address#5282 AS cdepval_customer_c_address_1#5303, cdepval_customer_c_phone#5283 AS cdepval_customer_c_phone_1#5304, cdepval_customer_c_acctbal#5284 AS cdepval_customer_c_acctbal_1#5305, cdepval_customer_c_comment#5285 AS cdepval_customer_c_comment_1#5306, cdepval_customer_c_mktsegment#5286 AS cdepval_customer_c_mktsegment_1#5307, cc_name#5287 AS cc_name_1#5308, cc_address#5288 AS cc_address_1#5309, cc_phone#5289 AS cc_phone_1#5310, cc_acctbal#5290 AS cc_acctbal_1#5311, cc_comment#5291 AS cc_comment_1#5312, cc_mktsegment#5292 AS cc_mktsegment_1#5313]
            +- Relation[rid#5272,cpfk_nation_customer#5273,cfpk_customer_nation#5274,cval_customer_c_name#5275,cval_customer_c_address#5276,cval_customer_c_phone#5277,cval_customer_c_acctbal#5278,cval_customer_c_comment#5279,cval_customer_c_mktsegment#5280,cdepval_customer_c_name#5281,cdepval_customer_c_address#5282,cdepval_customer_c_phone#5283,cdepval_customer_c_acctbal#5284,cdepval_customer_c_comment#5285,cdepval_customer_c_mktsegment#5286,cc_name#5287,cc_address#5288,cc_phone#5289,cc_acctbal#5290,cc_comment#5291,cc_mktsegment#5292] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4390ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 22:54:39 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:54:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5368L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:54:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:54:39 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:54:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:54:39 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:54:39 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:54:39 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:54:39 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:54:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5368L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#5424 AS rid_2#5469, cpfk_orders_lineitem#5425 AS cpfk_orders_lineitem_2#5470, cpfk_supplier_lineitem#5426 AS cpfk_supplier_lineitem_2#5471, cfpk_lineitem_supplier#5427 AS cfpk_lineitem_supplier_2#5472, cfpk_lineitem_partsupp#5428 AS cfpk_lineitem_partsupp_2#5473, cpfk_part_lineitem#5429 AS cpfk_part_lineitem_2#5474, cfpk_lineitem_part#5430 AS cfpk_lineitem_part_2#5475, cpfk_partsupp_lineitem#5431 AS cpfk_partsupp_lineitem_2#5476, cfpk_lineitem_orders#5432 AS cfpk_lineitem_orders_2#5477, cval_lineitem_l_quantity#5433 AS cval_lineitem_l_quantity_2#5478, cval_lineitem_l_extendedprice#5434 AS cval_lineitem_l_extendedprice_2#5479, cval_lineitem_l_discount#5435 AS cval_lineitem_l_discount_2#5480, cval_lineitem_l_tax#5436 AS cval_lineitem_l_tax_2#5481, cval_lineitem_l_returnflag#5437 AS cval_lineitem_l_returnflag_2#5482, cval_lineitem_l_linestatus#5438 AS cval_lineitem_l_linestatus_2#5483, cval_lineitem_l_commitdate#5439 AS cval_lineitem_l_commitdate_2#5484, cval_lineitem_l_receiptdate#5440 AS cval_lineitem_l_receiptdate_2#5485, cval_lineitem_l_shipinstruct#5441 AS cval_lineitem_l_shipinstruct_2#5486, cval_lineitem_l_shipmode#5442 AS cval_lineitem_l_shipmode_2#5487, cval_lineitem_l_comment#5443 AS cval_lineitem_l_comment_2#5488, cval_lineitem_l_shipdate#5444 AS cval_lineitem_l_shipdate_2#5489, cdepval_lineitem_l_quantity#5445 AS cdepval_lineitem_l_quantity_2#5490, cdepval_lineitem_l_extendedprice#5446 AS cdepval_lineitem_l_extendedprice_2#5491, cdepval_lineitem_l_discount#5447 AS cdepval_lineitem_l_discount_2#5492, ... 21 more fields]
         :  :  :  :  +- Relation[rid#5424,cpfk_orders_lineitem#5425,cpfk_supplier_lineitem#5426,cfpk_lineitem_supplier#5427,cfpk_lineitem_partsupp#5428,cpfk_part_lineitem#5429,cfpk_lineitem_part#5430,cpfk_partsupp_lineitem#5431,cfpk_lineitem_orders#5432,cval_lineitem_l_quantity#5433,cval_lineitem_l_extendedprice#5434,cval_lineitem_l_discount#5435,cval_lineitem_l_tax#5436,cval_lineitem_l_returnflag#5437,cval_lineitem_l_linestatus#5438,cval_lineitem_l_commitdate#5439,cval_lineitem_l_receiptdate#5440,cval_lineitem_l_shipinstruct#5441,cval_lineitem_l_shipmode#5442,cval_lineitem_l_comment#5443,cval_lineitem_l_shipdate#5444,cdepval_lineitem_l_quantity#5445,cdepval_lineitem_l_extendedprice#5446,cdepval_lineitem_l_discount#5447,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#5388 AS rid_1#5406, cpfk_nation_supplier#5389 AS cpfk_nation_supplier_1#5407, cfpk_supplier_nation#5390 AS cfpk_supplier_nation_1#5408, cval_supplier_s_name#5391 AS cval_supplier_s_name_1#5409, cval_supplier_s_address#5392 AS cval_supplier_s_address_1#5410, cval_supplier_s_phone#5393 AS cval_supplier_s_phone_1#5411, cval_supplier_s_acctbal#5394 AS cval_supplier_s_acctbal_1#5412, cval_supplier_s_comment#5395 AS cval_supplier_s_comment_1#5413, cdepval_supplier_s_name#5396 AS cdepval_supplier_s_name_1#5414, cdepval_supplier_s_address#5397 AS cdepval_supplier_s_address_1#5415, cdepval_supplier_s_phone#5398 AS cdepval_supplier_s_phone_1#5416, cdepval_supplier_s_acctbal#5399 AS cdepval_supplier_s_acctbal_1#5417, cdepval_supplier_s_comment#5400 AS cdepval_supplier_s_comment_1#5418, cs_name#5401 AS cs_name_1#5419, cs_address#5402 AS cs_address_1#5420, cs_phone#5403 AS cs_phone_1#5421, cs_acctbal#5404 AS cs_acctbal_1#5422, cs_comment#5405 AS cs_comment_1#5423]
         :  :  :     :  +- Relation[rid#5388,cpfk_nation_supplier#5389,cfpk_supplier_nation#5390,cval_supplier_s_name#5391,cval_supplier_s_address#5392,cval_supplier_s_phone#5393,cval_supplier_s_acctbal#5394,cval_supplier_s_comment#5395,cdepval_supplier_s_name#5396,cdepval_supplier_s_address#5397,cdepval_supplier_s_phone#5398,cdepval_supplier_s_acctbal#5399,cdepval_supplier_s_comment#5400,cs_name#5401,cs_address#5402,cs_phone#5403,cs_acctbal#5404,cs_comment#5405] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#5370 AS rid_0#5379, cpfk_region_nation#5371 AS cpfk_region_nation_0#5380, cfpk_nation_region#5372 AS cfpk_nation_region_0#5381, cval_nation_n_name#5373 AS cval_nation_n_name_0#5382, cval_nation_n_comment#5374 AS cval_nation_n_comment_0#5383, cdepval_nation_n_name#5375 AS cdepval_nation_n_name_0#5384, cdepval_nation_n_comment#5376 AS cdepval_nation_n_comment_0#5385, cn_name#5377 AS cn_name_0#5386, cn_comment#5378 AS cn_comment_0#5387]
         :  :  :        +- Relation[rid#5370,cpfk_region_nation#5371,cfpk_nation_region#5372,cval_nation_n_name#5373,cval_nation_n_comment#5374,cdepval_nation_n_name#5375,cdepval_nation_n_comment#5376,cn_name#5377,cn_comment#5378] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#5514 AS rid_3#5539, cval_part_p_name#5515 AS cval_part_p_name_3#5540, cval_part_p_mfgr#5516 AS cval_part_p_mfgr_3#5541, cval_part_p_type#5517 AS cval_part_p_type_3#5542, cval_part_p_size#5518 AS cval_part_p_size_3#5543, cval_part_p_container#5519 AS cval_part_p_container_3#5544, cval_part_p_retailprice#5520 AS cval_part_p_retailprice_3#5545, cval_part_p_comment#5521 AS cval_part_p_comment_3#5546, cval_part_p_brand#5522 AS cval_part_p_brand_3#5547, cdepval_part_p_name#5523 AS cdepval_part_p_name_3#5548, cdepval_part_p_mfgr#5524 AS cdepval_part_p_mfgr_3#5549, cdepval_part_p_type#5525 AS cdepval_part_p_type_3#5550, cdepval_part_p_size#5526 AS cdepval_part_p_size_3#5551, cdepval_part_p_container#5527 AS cdepval_part_p_container_3#5552, cdepval_part_p_retailprice#5528 AS cdepval_part_p_retailprice_3#5553, cdepval_part_p_comment#5529 AS cdepval_part_p_comment_3#5554, cdepval_part_p_brand#5530 AS cdepval_part_p_brand_3#5555, cp_name#5531 AS cp_name_3#5556, cp_mfgr#5532 AS cp_mfgr_3#5557, cp_type#5533 AS cp_type_3#5558, cp_size#5534 AS cp_size_3#5559, cp_container#5535 AS cp_container_3#5560, cp_retailprice#5536 AS cp_retailprice_3#5561, cp_comment#5537 AS cp_comment_3#5562, cp_brand#5538 AS cp_brand_3#5563]
         :  :     +- Relation[rid#5514,cval_part_p_name#5515,cval_part_p_mfgr#5516,cval_part_p_type#5517,cval_part_p_size#5518,cval_part_p_container#5519,cval_part_p_retailprice#5520,cval_part_p_comment#5521,cval_part_p_brand#5522,cdepval_part_p_name#5523,cdepval_part_p_mfgr#5524,cdepval_part_p_type#5525,cdepval_part_p_size#5526,cdepval_part_p_container#5527,cdepval_part_p_retailprice#5528,cdepval_part_p_comment#5529,cdepval_part_p_brand#5530,cp_name#5531,cp_mfgr#5532,cp_type#5533,cp_size#5534,cp_container#5535,cp_retailprice#5536,cp_comment#5537,cp_brand#5538] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#5564 AS rid_4#5578, cpfk_part_partsupp#5565 AS cpfk_part_partsupp_4#5579, cfpk_partsupp_part#5566 AS cfpk_partsupp_part_4#5580, cpfk_supplier_partsupp#5567 AS cpfk_supplier_partsupp_4#5581, cfpk_partsupp_supplier#5568 AS cfpk_partsupp_supplier_4#5582, cval_partsupp_ps_availqty#5569 AS cval_partsupp_ps_availqty_4#5583, cval_partsupp_ps_supplycost#5570 AS cval_partsupp_ps_supplycost_4#5584, cval_partsupp_ps_comment#5571 AS cval_partsupp_ps_comment_4#5585, cdepval_partsupp_ps_availqty#5572 AS cdepval_partsupp_ps_availqty_4#5586, cdepval_partsupp_ps_supplycost#5573 AS cdepval_partsupp_ps_supplycost_4#5587, cdepval_partsupp_ps_comment#5574 AS cdepval_partsupp_ps_comment_4#5588, cps_availqty#5575 AS cps_availqty_4#5589, cps_supplycost#5576 AS cps_supplycost_4#5590, cps_comment#5577 AS cps_comment_4#5591]
         :     +- Relation[rid#5564,cpfk_part_partsupp#5565,cfpk_partsupp_part#5566,cpfk_supplier_partsupp#5567,cfpk_partsupp_supplier#5568,cval_partsupp_ps_availqty#5569,cval_partsupp_ps_supplycost#5570,cval_partsupp_ps_comment#5571,cdepval_partsupp_ps_availqty#5572,cdepval_partsupp_ps_supplycost#5573,cdepval_partsupp_ps_comment#5574,cps_availqty#5575,cps_supplycost#5576,cps_comment#5577] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#5592 AS rid_5#5616, cpfk_customer_orders#5593 AS cpfk_customer_orders_5#5617, cfpk_orders_customer#5594 AS cfpk_orders_customer_5#5618, cval_orders_o_orderstatus#5595 AS cval_orders_o_orderstatus_5#5619, cval_orders_o_totalprice#5596 AS cval_orders_o_totalprice_5#5620, cval_orders_o_orderpriority#5597 AS cval_orders_o_orderpriority_5#5621, cval_orders_o_clerk#5598 AS cval_orders_o_clerk_5#5622, cval_orders_o_shippriority#5599 AS cval_orders_o_shippriority_5#5623, cval_orders_o_comment#5600 AS cval_orders_o_comment_5#5624, cval_orders_o_orderdate#5601 AS cval_orders_o_orderdate_5#5625, cdepval_orders_o_orderstatus#5602 AS cdepval_orders_o_orderstatus_5#5626, cdepval_orders_o_totalprice#5603 AS cdepval_orders_o_totalprice_5#5627, cdepval_orders_o_orderpriority#5604 AS cdepval_orders_o_orderpriority_5#5628, cdepval_orders_o_clerk#5605 AS cdepval_orders_o_clerk_5#5629, cdepval_orders_o_shippriority#5606 AS cdepval_orders_o_shippriority_5#5630, cdepval_orders_o_comment#5607 AS cdepval_orders_o_comment_5#5631, cdepval_orders_o_orderdate#5608 AS cdepval_orders_o_orderdate_5#5632, co_orderstatus#5609 AS co_orderstatus_5#5633, co_totalprice#5610 AS co_totalprice_5#5634, co_orderpriority#5611 AS co_orderpriority_5#5635, co_clerk#5612 AS co_clerk_5#5636, co_shippriority#5613 AS co_shippriority_5#5637, co_comment#5614 AS co_comment_5#5638, co_orderdate#5615 AS co_orderdate_5#5639]
            +- Relation[rid#5592,cpfk_customer_orders#5593,cfpk_orders_customer#5594,cval_orders_o_orderstatus#5595,cval_orders_o_totalprice#5596,cval_orders_o_orderpriority#5597,cval_orders_o_clerk#5598,cval_orders_o_shippriority#5599,cval_orders_o_comment#5600,cval_orders_o_orderdate#5601,cdepval_orders_o_orderstatus#5602,cdepval_orders_o_totalprice#5603,cdepval_orders_o_orderpriority#5604,cdepval_orders_o_clerk#5605,cdepval_orders_o_shippriority#5606,cdepval_orders_o_comment#5607,cdepval_orders_o_orderdate#5608,co_orderstatus#5609,co_totalprice#5610,co_orderpriority#5611,co_clerk#5612,co_shippriority#5613,co_comment#5614,co_orderdate#5615] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 63828ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/25 22:55:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:55:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5780L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:55:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:55:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:55:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:55:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:55:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:55:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:55:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:55:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5780L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#5807, cval_part_p_name_0#5808, cval_part_p_mfgr_0#5809, cval_part_p_type_0#5810, cval_part_p_size_0#5811, cval_part_p_container_0#5812, cval_part_p_retailprice_0#5813, cval_part_p_comment_0#5814, cval_part_p_brand_0#5815, cdepval_part_p_name_0#5816, cdepval_part_p_mfgr_0#5817, cdepval_part_p_type_0#5818, cdepval_part_p_size_0#5819, cdepval_part_p_container_0#5820, cdepval_part_p_retailprice_0#5821, cdepval_part_p_comment_0#5822, cdepval_part_p_brand_0#5823, cp_name_0#5824, cp_mfgr_0#5825, cp_type_0#5826, cp_size_0#5827, cp_container_0#5828, cp_retailprice_0#5829, cp_comment_0#5830, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#5782 AS rid_0#5807, cval_part_p_name#5783 AS cval_part_p_name_0#5808, cval_part_p_mfgr#5784 AS cval_part_p_mfgr_0#5809, cval_part_p_type#5785 AS cval_part_p_type_0#5810, cval_part_p_size#5786 AS cval_part_p_size_0#5811, cval_part_p_container#5787 AS cval_part_p_container_0#5812, cval_part_p_retailprice#5788 AS cval_part_p_retailprice_0#5813, cval_part_p_comment#5789 AS cval_part_p_comment_0#5814, cval_part_p_brand#5790 AS cval_part_p_brand_0#5815, cdepval_part_p_name#5791 AS cdepval_part_p_name_0#5816, cdepval_part_p_mfgr#5792 AS cdepval_part_p_mfgr_0#5817, cdepval_part_p_type#5793 AS cdepval_part_p_type_0#5818, cdepval_part_p_size#5794 AS cdepval_part_p_size_0#5819, cdepval_part_p_container#5795 AS cdepval_part_p_container_0#5820, cdepval_part_p_retailprice#5796 AS cdepval_part_p_retailprice_0#5821, cdepval_part_p_comment#5797 AS cdepval_part_p_comment_0#5822, cdepval_part_p_brand#5798 AS cdepval_part_p_brand_0#5823, cp_name#5799 AS cp_name_0#5824, cp_mfgr#5800 AS cp_mfgr_0#5825, cp_type#5801 AS cp_type_0#5826, cp_size#5802 AS cp_size_0#5827, cp_container#5803 AS cp_container_0#5828, cp_retailprice#5804 AS cp_retailprice_0#5829, cp_comment#5805 AS cp_comment_0#5830, cp_brand#5806 AS cp_brand_0#5831]
         :  :        +- Relation[rid#5782,cval_part_p_name#5783,cval_part_p_mfgr#5784,cval_part_p_type#5785,cval_part_p_size#5786,cval_part_p_container#5787,cval_part_p_retailprice#5788,cval_part_p_comment#5789,cval_part_p_brand#5790,cdepval_part_p_name#5791,cdepval_part_p_mfgr#5792,cdepval_part_p_type#5793,cdepval_part_p_size#5794,cdepval_part_p_container#5795,cdepval_part_p_retailprice#5796,cdepval_part_p_comment#5797,cdepval_part_p_brand#5798,cp_name#5799,cp_mfgr#5800,cp_type#5801,cp_size#5802,cp_container#5803,cp_retailprice#5804,cp_comment#5805,cp_brand#5806] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#6252 AS rid_1#6297, cpfk_orders_lineitem#6253 AS cpfk_orders_lineitem_1#6298, cpfk_supplier_lineitem#6254 AS cpfk_supplier_lineitem_1#6299, cfpk_lineitem_supplier#6255 AS cfpk_lineitem_supplier_1#6300, cfpk_lineitem_partsupp#6256 AS cfpk_lineitem_partsupp_1#6301, cpfk_part_lineitem#6257 AS cpfk_part_lineitem_1#6302, cfpk_lineitem_part#6258 AS cfpk_lineitem_part_1#6303, cpfk_partsupp_lineitem#6259 AS cpfk_partsupp_lineitem_1#6304, cfpk_lineitem_orders#6260 AS cfpk_lineitem_orders_1#6305, cval_lineitem_l_quantity#6261 AS cval_lineitem_l_quantity_1#6306, cval_lineitem_l_extendedprice#6262 AS cval_lineitem_l_extendedprice_1#6307, cval_lineitem_l_discount#6263 AS cval_lineitem_l_discount_1#6308, cval_lineitem_l_tax#6264 AS cval_lineitem_l_tax_1#6309, cval_lineitem_l_returnflag#6265 AS cval_lineitem_l_returnflag_1#6310, cval_lineitem_l_linestatus#6266 AS cval_lineitem_l_linestatus_1#6311, cval_lineitem_l_commitdate#6267 AS cval_lineitem_l_commitdate_1#6312, cval_lineitem_l_receiptdate#6268 AS cval_lineitem_l_receiptdate_1#6313, cval_lineitem_l_shipinstruct#6269 AS cval_lineitem_l_shipinstruct_1#6314, cval_lineitem_l_shipmode#6270 AS cval_lineitem_l_shipmode_1#6315, cval_lineitem_l_comment#6271 AS cval_lineitem_l_comment_1#6316, cval_lineitem_l_shipdate#6272 AS cval_lineitem_l_shipdate_1#6317, cdepval_lineitem_l_quantity#6273 AS cdepval_lineitem_l_quantity_1#6318, cdepval_lineitem_l_extendedprice#6274 AS cdepval_lineitem_l_extendedprice_1#6319, cdepval_lineitem_l_discount#6275 AS cdepval_lineitem_l_discount_1#6320, ... 21 more fields]
         :        +- Relation[rid#6252,cpfk_orders_lineitem#6253,cpfk_supplier_lineitem#6254,cfpk_lineitem_supplier#6255,cfpk_lineitem_partsupp#6256,cpfk_part_lineitem#6257,cfpk_lineitem_part#6258,cpfk_partsupp_lineitem#6259,cfpk_lineitem_orders#6260,cval_lineitem_l_quantity#6261,cval_lineitem_l_extendedprice#6262,cval_lineitem_l_discount#6263,cval_lineitem_l_tax#6264,cval_lineitem_l_returnflag#6265,cval_lineitem_l_linestatus#6266,cval_lineitem_l_commitdate#6267,cval_lineitem_l_receiptdate#6268,cval_lineitem_l_shipinstruct#6269,cval_lineitem_l_shipmode#6270,cval_lineitem_l_comment#6271,cval_lineitem_l_shipdate#6272,cdepval_lineitem_l_quantity#6273,cdepval_lineitem_l_extendedprice#6274,cdepval_lineitem_l_discount#6275,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#5932 AS rid_1#5977, cpfk_orders_lineitem#5933 AS cpfk_orders_lineitem_1#5978, cpfk_supplier_lineitem#5934 AS cpfk_supplier_lineitem_1#5979, cfpk_lineitem_supplier#5935 AS cfpk_lineitem_supplier_1#5980, cfpk_lineitem_partsupp#5936 AS cfpk_lineitem_partsupp_1#5981, cpfk_part_lineitem#5937 AS cpfk_part_lineitem_1#5982, cfpk_lineitem_part#5938 AS cfpk_lineitem_part_1#5983, cpfk_partsupp_lineitem#5939 AS cpfk_partsupp_lineitem_1#5984, cfpk_lineitem_orders#5940 AS cfpk_lineitem_orders_1#5985, cval_lineitem_l_quantity#5941 AS cval_lineitem_l_quantity_1#5986, cval_lineitem_l_extendedprice#5942 AS cval_lineitem_l_extendedprice_1#5987, cval_lineitem_l_discount#5943 AS cval_lineitem_l_discount_1#5988, cval_lineitem_l_tax#5944 AS cval_lineitem_l_tax_1#5989, cval_lineitem_l_returnflag#5945 AS cval_lineitem_l_returnflag_1#5990, cval_lineitem_l_linestatus#5946 AS cval_lineitem_l_linestatus_1#5991, cval_lineitem_l_commitdate#5947 AS cval_lineitem_l_commitdate_1#5992, cval_lineitem_l_receiptdate#5948 AS cval_lineitem_l_receiptdate_1#5993, cval_lineitem_l_shipinstruct#5949 AS cval_lineitem_l_shipinstruct_1#5994, cval_lineitem_l_shipmode#5950 AS cval_lineitem_l_shipmode_1#5995, cval_lineitem_l_comment#5951 AS cval_lineitem_l_comment_1#5996, cval_lineitem_l_shipdate#5952 AS cval_lineitem_l_shipdate_1#5997, cdepval_lineitem_l_quantity#5953 AS cdepval_lineitem_l_quantity_1#5998, cdepval_lineitem_l_extendedprice#5954 AS cdepval_lineitem_l_extendedprice_1#5999, cdepval_lineitem_l_discount#5955 AS cdepval_lineitem_l_discount_1#6000, ... 21 more fields]
                  +- Relation[rid#5932,cpfk_orders_lineitem#5933,cpfk_supplier_lineitem#5934,cfpk_lineitem_supplier#5935,cfpk_lineitem_partsupp#5936,cpfk_part_lineitem#5937,cfpk_lineitem_part#5938,cpfk_partsupp_lineitem#5939,cfpk_lineitem_orders#5940,cval_lineitem_l_quantity#5941,cval_lineitem_l_extendedprice#5942,cval_lineitem_l_discount#5943,cval_lineitem_l_tax#5944,cval_lineitem_l_returnflag#5945,cval_lineitem_l_linestatus#5946,cval_lineitem_l_commitdate#5947,cval_lineitem_l_receiptdate#5948,cval_lineitem_l_shipinstruct#5949,cval_lineitem_l_shipmode#5950,cval_lineitem_l_comment#5951,cval_lineitem_l_shipdate#5952,cdepval_lineitem_l_quantity#5953,cdepval_lineitem_l_extendedprice#5954,cdepval_lineitem_l_discount#5955,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 16814ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/25 22:56:00 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:56:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6417L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:56:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#6417L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#6419 AS rid_0#6464, cpfk_orders_lineitem#6420 AS cpfk_orders_lineitem_0#6465, cpfk_supplier_lineitem#6421 AS cpfk_supplier_lineitem_0#6466, cfpk_lineitem_supplier#6422 AS cfpk_lineitem_supplier_0#6467, cfpk_lineitem_partsupp#6423 AS cfpk_lineitem_partsupp_0#6468, cpfk_part_lineitem#6424 AS cpfk_part_lineitem_0#6469, cfpk_lineitem_part#6425 AS cfpk_lineitem_part_0#6470, cpfk_partsupp_lineitem#6426 AS cpfk_partsupp_lineitem_0#6471, cfpk_lineitem_orders#6427 AS cfpk_lineitem_orders_0#6472, cval_lineitem_l_quantity#6428 AS cval_lineitem_l_quantity_0#6473, cval_lineitem_l_extendedprice#6429 AS cval_lineitem_l_extendedprice_0#6474, cval_lineitem_l_discount#6430 AS cval_lineitem_l_discount_0#6475, cval_lineitem_l_tax#6431 AS cval_lineitem_l_tax_0#6476, cval_lineitem_l_returnflag#6432 AS cval_lineitem_l_returnflag_0#6477, cval_lineitem_l_linestatus#6433 AS cval_lineitem_l_linestatus_0#6478, cval_lineitem_l_commitdate#6434 AS cval_lineitem_l_commitdate_0#6479, cval_lineitem_l_receiptdate#6435 AS cval_lineitem_l_receiptdate_0#6480, cval_lineitem_l_shipinstruct#6436 AS cval_lineitem_l_shipinstruct_0#6481, cval_lineitem_l_shipmode#6437 AS cval_lineitem_l_shipmode_0#6482, cval_lineitem_l_comment#6438 AS cval_lineitem_l_comment_0#6483, cval_lineitem_l_shipdate#6439 AS cval_lineitem_l_shipdate_0#6484, cdepval_lineitem_l_quantity#6440 AS cdepval_lineitem_l_quantity_0#6485, cdepval_lineitem_l_extendedprice#6441 AS cdepval_lineitem_l_extendedprice_0#6486, cdepval_lineitem_l_discount#6442 AS cdepval_lineitem_l_discount_0#6487, ... 21 more fields]
         +- Relation[rid#6419,cpfk_orders_lineitem#6420,cpfk_supplier_lineitem#6421,cfpk_lineitem_supplier#6422,cfpk_lineitem_partsupp#6423,cpfk_part_lineitem#6424,cfpk_lineitem_part#6425,cpfk_partsupp_lineitem#6426,cfpk_lineitem_orders#6427,cval_lineitem_l_quantity#6428,cval_lineitem_l_extendedprice#6429,cval_lineitem_l_discount#6430,cval_lineitem_l_tax#6431,cval_lineitem_l_returnflag#6432,cval_lineitem_l_linestatus#6433,cval_lineitem_l_commitdate#6434,cval_lineitem_l_receiptdate#6435,cval_lineitem_l_shipinstruct#6436,cval_lineitem_l_shipmode#6437,cval_lineitem_l_comment#6438,cval_lineitem_l_shipdate#6439,cdepval_lineitem_l_quantity#6440,cdepval_lineitem_l_extendedprice#6441,cdepval_lineitem_l_discount#6442,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2466ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/25 22:56:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:56:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6562L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:56:02 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:56:02 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:56:02 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:56:02 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:56:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6562L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#6696 AS rid_2#6741, cpfk_orders_lineitem#6697 AS cpfk_orders_lineitem_2#6742, cpfk_supplier_lineitem#6698 AS cpfk_supplier_lineitem_2#6743, cfpk_lineitem_supplier#6699 AS cfpk_lineitem_supplier_2#6744, cfpk_lineitem_partsupp#6700 AS cfpk_lineitem_partsupp_2#6745, cpfk_part_lineitem#6701 AS cpfk_part_lineitem_2#6746, cfpk_lineitem_part#6702 AS cfpk_lineitem_part_2#6747, cpfk_partsupp_lineitem#6703 AS cpfk_partsupp_lineitem_2#6748, cfpk_lineitem_orders#6704 AS cfpk_lineitem_orders_2#6749, cval_lineitem_l_quantity#6705 AS cval_lineitem_l_quantity_2#6750, cval_lineitem_l_extendedprice#6706 AS cval_lineitem_l_extendedprice_2#6751, cval_lineitem_l_discount#6707 AS cval_lineitem_l_discount_2#6752, cval_lineitem_l_tax#6708 AS cval_lineitem_l_tax_2#6753, cval_lineitem_l_returnflag#6709 AS cval_lineitem_l_returnflag_2#6754, cval_lineitem_l_linestatus#6710 AS cval_lineitem_l_linestatus_2#6755, cval_lineitem_l_commitdate#6711 AS cval_lineitem_l_commitdate_2#6756, cval_lineitem_l_receiptdate#6712 AS cval_lineitem_l_receiptdate_2#6757, cval_lineitem_l_shipinstruct#6713 AS cval_lineitem_l_shipinstruct_2#6758, cval_lineitem_l_shipmode#6714 AS cval_lineitem_l_shipmode_2#6759, cval_lineitem_l_comment#6715 AS cval_lineitem_l_comment_2#6760, cval_lineitem_l_shipdate#6716 AS cval_lineitem_l_shipdate_2#6761, cdepval_lineitem_l_quantity#6717 AS cdepval_lineitem_l_quantity_2#6762, cdepval_lineitem_l_extendedprice#6718 AS cdepval_lineitem_l_extendedprice_2#6763, cdepval_lineitem_l_discount#6719 AS cdepval_lineitem_l_discount_2#6764, ... 21 more fields]
         :  +- Relation[rid#6696,cpfk_orders_lineitem#6697,cpfk_supplier_lineitem#6698,cfpk_lineitem_supplier#6699,cfpk_lineitem_partsupp#6700,cpfk_part_lineitem#6701,cfpk_lineitem_part#6702,cpfk_partsupp_lineitem#6703,cfpk_lineitem_orders#6704,cval_lineitem_l_quantity#6705,cval_lineitem_l_extendedprice#6706,cval_lineitem_l_discount#6707,cval_lineitem_l_tax#6708,cval_lineitem_l_returnflag#6709,cval_lineitem_l_linestatus#6710,cval_lineitem_l_commitdate#6711,cval_lineitem_l_receiptdate#6712,cval_lineitem_l_shipinstruct#6713,cval_lineitem_l_shipmode#6714,cval_lineitem_l_comment#6715,cval_lineitem_l_shipdate#6716,cdepval_lineitem_l_quantity#6717,cdepval_lineitem_l_extendedprice#6718,cdepval_lineitem_l_discount#6719,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#6648 AS rid_1#6672, cpfk_customer_orders#6649 AS cpfk_customer_orders_1#6673, cfpk_orders_customer#6650 AS cfpk_orders_customer_1#6674, cval_orders_o_orderstatus#6651 AS cval_orders_o_orderstatus_1#6675, cval_orders_o_totalprice#6652 AS cval_orders_o_totalprice_1#6676, cval_orders_o_orderpriority#6653 AS cval_orders_o_orderpriority_1#6677, cval_orders_o_clerk#6654 AS cval_orders_o_clerk_1#6678, cval_orders_o_shippriority#6655 AS cval_orders_o_shippriority_1#6679, cval_orders_o_comment#6656 AS cval_orders_o_comment_1#6680, cval_orders_o_orderdate#6657 AS cval_orders_o_orderdate_1#6681, cdepval_orders_o_orderstatus#6658 AS cdepval_orders_o_orderstatus_1#6682, cdepval_orders_o_totalprice#6659 AS cdepval_orders_o_totalprice_1#6683, cdepval_orders_o_orderpriority#6660 AS cdepval_orders_o_orderpriority_1#6684, cdepval_orders_o_clerk#6661 AS cdepval_orders_o_clerk_1#6685, cdepval_orders_o_shippriority#6662 AS cdepval_orders_o_shippriority_1#6686, cdepval_orders_o_comment#6663 AS cdepval_orders_o_comment_1#6687, cdepval_orders_o_orderdate#6664 AS cdepval_orders_o_orderdate_1#6688, co_orderstatus#6665 AS co_orderstatus_1#6689, co_totalprice#6666 AS co_totalprice_1#6690, co_orderpriority#6667 AS co_orderpriority_1#6691, co_clerk#6668 AS co_clerk_1#6692, co_shippriority#6669 AS co_shippriority_1#6693, co_comment#6670 AS co_comment_1#6694, co_orderdate#6671 AS co_orderdate_1#6695]
            :  +- Relation[rid#6648,cpfk_customer_orders#6649,cfpk_orders_customer#6650,cval_orders_o_orderstatus#6651,cval_orders_o_totalprice#6652,cval_orders_o_orderpriority#6653,cval_orders_o_clerk#6654,cval_orders_o_shippriority#6655,cval_orders_o_comment#6656,cval_orders_o_orderdate#6657,cdepval_orders_o_orderstatus#6658,cdepval_orders_o_totalprice#6659,cdepval_orders_o_orderpriority#6660,cdepval_orders_o_clerk#6661,cdepval_orders_o_shippriority#6662,cdepval_orders_o_comment#6663,cdepval_orders_o_orderdate#6664,co_orderstatus#6665,co_totalprice#6666,co_orderpriority#6667,co_clerk#6668,co_shippriority#6669,co_comment#6670,co_orderdate#6671] JDBCRelation(torders) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
               +- Project [rid#6564 AS rid_0#6585, cpfk_nation_customer#6565 AS cpfk_nation_customer_0#6586, cfpk_customer_nation#6566 AS cfpk_customer_nation_0#6587, cval_customer_c_name#6567 AS cval_customer_c_name_0#6588, cval_customer_c_address#6568 AS cval_customer_c_address_0#6589, cval_customer_c_phone#6569 AS cval_customer_c_phone_0#6590, cval_customer_c_acctbal#6570 AS cval_customer_c_acctbal_0#6591, cval_customer_c_comment#6571 AS cval_customer_c_comment_0#6592, cval_customer_c_mktsegment#6572 AS cval_customer_c_mktsegment_0#6593, cdepval_customer_c_name#6573 AS cdepval_customer_c_name_0#6594, cdepval_customer_c_address#6574 AS cdepval_customer_c_address_0#6595, cdepval_customer_c_phone#6575 AS cdepval_customer_c_phone_0#6596, cdepval_customer_c_acctbal#6576 AS cdepval_customer_c_acctbal_0#6597, cdepval_customer_c_comment#6577 AS cdepval_customer_c_comment_0#6598, cdepval_customer_c_mktsegment#6578 AS cdepval_customer_c_mktsegment_0#6599, cc_name#6579 AS cc_name_0#6600, cc_address#6580 AS cc_address_0#6601, cc_phone#6581 AS cc_phone_0#6602, cc_acctbal#6582 AS cc_acctbal_0#6603, cc_comment#6583 AS cc_comment_0#6604, cc_mktsegment#6584 AS cc_mktsegment_0#6605]
                  +- Relation[rid#6564,cpfk_nation_customer#6565,cfpk_customer_nation#6566,cval_customer_c_name#6567,cval_customer_c_address#6568,cval_customer_c_phone#6569,cval_customer_c_acctbal#6570,cval_customer_c_comment#6571,cval_customer_c_mktsegment#6572,cdepval_customer_c_name#6573,cdepval_customer_c_address#6574,cdepval_customer_c_phone#6575,cdepval_customer_c_acctbal#6576,cdepval_customer_c_comment#6577,cdepval_customer_c_mktsegment#6578,cc_name#6579,cc_address#6580,cc_phone#6581,cc_acctbal#6582,cc_comment#6583,cc_mktsegment#6584] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 39344ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 22:56:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:56:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6885L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:56:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:56:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:56:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:56:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:56:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:56:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:56:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:56:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:56:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:56:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:56:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:56:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6885L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#7019 AS rid_4#7064, cpfk_orders_lineitem#7020 AS cpfk_orders_lineitem_4#7065, cpfk_supplier_lineitem#7021 AS cpfk_supplier_lineitem_4#7066, cfpk_lineitem_supplier#7022 AS cfpk_lineitem_supplier_4#7067, cfpk_lineitem_partsupp#7023 AS cfpk_lineitem_partsupp_4#7068, cpfk_part_lineitem#7024 AS cpfk_part_lineitem_4#7069, cfpk_lineitem_part#7025 AS cfpk_lineitem_part_4#7070, cpfk_partsupp_lineitem#7026 AS cpfk_partsupp_lineitem_4#7071, cfpk_lineitem_orders#7027 AS cfpk_lineitem_orders_4#7072, cval_lineitem_l_quantity#7028 AS cval_lineitem_l_quantity_4#7073, cval_lineitem_l_extendedprice#7029 AS cval_lineitem_l_extendedprice_4#7074, cval_lineitem_l_discount#7030 AS cval_lineitem_l_discount_4#7075, cval_lineitem_l_tax#7031 AS cval_lineitem_l_tax_4#7076, cval_lineitem_l_returnflag#7032 AS cval_lineitem_l_returnflag_4#7077, cval_lineitem_l_linestatus#7033 AS cval_lineitem_l_linestatus_4#7078, cval_lineitem_l_commitdate#7034 AS cval_lineitem_l_commitdate_4#7079, cval_lineitem_l_receiptdate#7035 AS cval_lineitem_l_receiptdate_4#7080, cval_lineitem_l_shipinstruct#7036 AS cval_lineitem_l_shipinstruct_4#7081, cval_lineitem_l_shipmode#7037 AS cval_lineitem_l_shipmode_4#7082, cval_lineitem_l_comment#7038 AS cval_lineitem_l_comment_4#7083, cval_lineitem_l_shipdate#7039 AS cval_lineitem_l_shipdate_4#7084, cdepval_lineitem_l_quantity#7040 AS cdepval_lineitem_l_quantity_4#7085, cdepval_lineitem_l_extendedprice#7041 AS cdepval_lineitem_l_extendedprice_4#7086, cdepval_lineitem_l_discount#7042 AS cdepval_lineitem_l_discount_4#7087, ... 21 more fields]
         :  :  +- Relation[rid#7019,cpfk_orders_lineitem#7020,cpfk_supplier_lineitem#7021,cfpk_lineitem_supplier#7022,cfpk_lineitem_partsupp#7023,cpfk_part_lineitem#7024,cfpk_lineitem_part#7025,cpfk_partsupp_lineitem#7026,cfpk_lineitem_orders#7027,cval_lineitem_l_quantity#7028,cval_lineitem_l_extendedprice#7029,cval_lineitem_l_discount#7030,cval_lineitem_l_tax#7031,cval_lineitem_l_returnflag#7032,cval_lineitem_l_linestatus#7033,cval_lineitem_l_commitdate#7034,cval_lineitem_l_receiptdate#7035,cval_lineitem_l_shipinstruct#7036,cval_lineitem_l_shipmode#7037,cval_lineitem_l_comment#7038,cval_lineitem_l_shipdate#7039,cdepval_lineitem_l_quantity#7040,cdepval_lineitem_l_extendedprice#7041,cdepval_lineitem_l_discount#7042,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#6941 AS rid_2#6955, cpfk_part_partsupp#6942 AS cpfk_part_partsupp_2#6956, cfpk_partsupp_part#6943 AS cfpk_partsupp_part_2#6957, cpfk_supplier_partsupp#6944 AS cpfk_supplier_partsupp_2#6958, cfpk_partsupp_supplier#6945 AS cfpk_partsupp_supplier_2#6959, cval_partsupp_ps_availqty#6946 AS cval_partsupp_ps_availqty_2#6960, cval_partsupp_ps_supplycost#6947 AS cval_partsupp_ps_supplycost_2#6961, cval_partsupp_ps_comment#6948 AS cval_partsupp_ps_comment_2#6962, cdepval_partsupp_ps_availqty#6949 AS cdepval_partsupp_ps_availqty_2#6963, cdepval_partsupp_ps_supplycost#6950 AS cdepval_partsupp_ps_supplycost_2#6964, cdepval_partsupp_ps_comment#6951 AS cdepval_partsupp_ps_comment_2#6965, cps_availqty#6952 AS cps_availqty_2#6966, cps_supplycost#6953 AS cps_supplycost_2#6967, cps_comment#6954 AS cps_comment_2#6968]
         :     :  :  +- Relation[rid#6941,cpfk_part_partsupp#6942,cfpk_partsupp_part#6943,cpfk_supplier_partsupp#6944,cfpk_partsupp_supplier#6945,cval_partsupp_ps_availqty#6946,cval_partsupp_ps_supplycost#6947,cval_partsupp_ps_comment#6948,cdepval_partsupp_ps_availqty#6949,cdepval_partsupp_ps_supplycost#6950,cdepval_partsupp_ps_comment#6951,cps_availqty#6952,cps_supplycost#6953,cps_comment#6954] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#6905 AS rid_1#6923, cpfk_nation_supplier#6906 AS cpfk_nation_supplier_1#6924, cfpk_supplier_nation#6907 AS cfpk_supplier_nation_1#6925, cval_supplier_s_name#6908 AS cval_supplier_s_name_1#6926, cval_supplier_s_address#6909 AS cval_supplier_s_address_1#6927, cval_supplier_s_phone#6910 AS cval_supplier_s_phone_1#6928, cval_supplier_s_acctbal#6911 AS cval_supplier_s_acctbal_1#6929, cval_supplier_s_comment#6912 AS cval_supplier_s_comment_1#6930, cdepval_supplier_s_name#6913 AS cdepval_supplier_s_name_1#6931, cdepval_supplier_s_address#6914 AS cdepval_supplier_s_address_1#6932, cdepval_supplier_s_phone#6915 AS cdepval_supplier_s_phone_1#6933, cdepval_supplier_s_acctbal#6916 AS cdepval_supplier_s_acctbal_1#6934, cdepval_supplier_s_comment#6917 AS cdepval_supplier_s_comment_1#6935, cs_name#6918 AS cs_name_1#6936, cs_address#6919 AS cs_address_1#6937, cs_phone#6920 AS cs_phone_1#6938, cs_acctbal#6921 AS cs_acctbal_1#6939, cs_comment#6922 AS cs_comment_1#6940]
         :     :     :  +- Relation[rid#6905,cpfk_nation_supplier#6906,cfpk_supplier_nation#6907,cval_supplier_s_name#6908,cval_supplier_s_address#6909,cval_supplier_s_phone#6910,cval_supplier_s_acctbal#6911,cval_supplier_s_comment#6912,cdepval_supplier_s_name#6913,cdepval_supplier_s_address#6914,cdepval_supplier_s_phone#6915,cdepval_supplier_s_acctbal#6916,cdepval_supplier_s_comment#6917,cs_name#6918,cs_address#6919,cs_phone#6920,cs_acctbal#6921,cs_comment#6922] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#6887 AS rid_0#6896, cpfk_region_nation#6888 AS cpfk_region_nation_0#6897, cfpk_nation_region#6889 AS cfpk_nation_region_0#6898, cval_nation_n_name#6890 AS cval_nation_n_name_0#6899, cval_nation_n_comment#6891 AS cval_nation_n_comment_0#6900, cdepval_nation_n_name#6892 AS cdepval_nation_n_name_0#6901, cdepval_nation_n_comment#6893 AS cdepval_nation_n_comment_0#6902, cn_name#6894 AS cn_name_0#6903, cn_comment#6895 AS cn_comment_0#6904]
         :     :        +- Relation[rid#6887,cpfk_region_nation#6888,cfpk_nation_region#6889,cval_nation_n_name#6890,cval_nation_n_comment#6891,cdepval_nation_n_name#6892,cdepval_nation_n_comment#6893,cn_name#6894,cn_comment#6895] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#6969 AS rid_3#6994, cval_part_p_name#6970 AS cval_part_p_name_3#6995, cval_part_p_mfgr#6971 AS cval_part_p_mfgr_3#6996, cval_part_p_type#6972 AS cval_part_p_type_3#6997, cval_part_p_size#6973 AS cval_part_p_size_3#6998, cval_part_p_container#6974 AS cval_part_p_container_3#6999, cval_part_p_retailprice#6975 AS cval_part_p_retailprice_3#7000, cval_part_p_comment#6976 AS cval_part_p_comment_3#7001, cval_part_p_brand#6977 AS cval_part_p_brand_3#7002, cdepval_part_p_name#6978 AS cdepval_part_p_name_3#7003, cdepval_part_p_mfgr#6979 AS cdepval_part_p_mfgr_3#7004, cdepval_part_p_type#6980 AS cdepval_part_p_type_3#7005, cdepval_part_p_size#6981 AS cdepval_part_p_size_3#7006, cdepval_part_p_container#6982 AS cdepval_part_p_container_3#7007, cdepval_part_p_retailprice#6983 AS cdepval_part_p_retailprice_3#7008, cdepval_part_p_comment#6984 AS cdepval_part_p_comment_3#7009, cdepval_part_p_brand#6985 AS cdepval_part_p_brand_3#7010, cp_name#6986 AS cp_name_3#7011, cp_mfgr#6987 AS cp_mfgr_3#7012, cp_type#6988 AS cp_type_3#7013, cp_size#6989 AS cp_size_3#7014, cp_container#6990 AS cp_container_3#7015, cp_retailprice#6991 AS cp_retailprice_3#7016, cp_comment#6992 AS cp_comment_3#7017, cp_brand#6993 AS cp_brand_3#7018]
         :        +- Relation[rid#6969,cval_part_p_name#6970,cval_part_p_mfgr#6971,cval_part_p_type#6972,cval_part_p_size#6973,cval_part_p_container#6974,cval_part_p_retailprice#6975,cval_part_p_comment#6976,cval_part_p_brand#6977,cdepval_part_p_name#6978,cdepval_part_p_mfgr#6979,cdepval_part_p_type#6980,cdepval_part_p_size#6981,cdepval_part_p_container#6982,cdepval_part_p_retailprice#6983,cdepval_part_p_comment#6984,cdepval_part_p_brand#6985,cp_name#6986,cp_mfgr#6987,cp_type#6988,cp_size#6989,cp_container#6990,cp_retailprice#6991,cp_comment#6992,cp_brand#6993] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#7109 AS rid_5#7133, cpfk_customer_orders#7110 AS cpfk_customer_orders_5#7134, cfpk_orders_customer#7111 AS cfpk_orders_customer_5#7135, cval_orders_o_orderstatus#7112 AS cval_orders_o_orderstatus_5#7136, cval_orders_o_totalprice#7113 AS cval_orders_o_totalprice_5#7137, cval_orders_o_orderpriority#7114 AS cval_orders_o_orderpriority_5#7138, cval_orders_o_clerk#7115 AS cval_orders_o_clerk_5#7139, cval_orders_o_shippriority#7116 AS cval_orders_o_shippriority_5#7140, cval_orders_o_comment#7117 AS cval_orders_o_comment_5#7141, cval_orders_o_orderdate#7118 AS cval_orders_o_orderdate_5#7142, cdepval_orders_o_orderstatus#7119 AS cdepval_orders_o_orderstatus_5#7143, cdepval_orders_o_totalprice#7120 AS cdepval_orders_o_totalprice_5#7144, cdepval_orders_o_orderpriority#7121 AS cdepval_orders_o_orderpriority_5#7145, cdepval_orders_o_clerk#7122 AS cdepval_orders_o_clerk_5#7146, cdepval_orders_o_shippriority#7123 AS cdepval_orders_o_shippriority_5#7147, cdepval_orders_o_comment#7124 AS cdepval_orders_o_comment_5#7148, cdepval_orders_o_orderdate#7125 AS cdepval_orders_o_orderdate_5#7149, co_orderstatus#7126 AS co_orderstatus_5#7150, co_totalprice#7127 AS co_totalprice_5#7151, co_orderpriority#7128 AS co_orderpriority_5#7152, co_clerk#7129 AS co_clerk_5#7153, co_shippriority#7130 AS co_shippriority_5#7154, co_comment#7131 AS co_comment_5#7155, co_orderdate#7132 AS co_orderdate_5#7156]
            +- Relation[rid#7109,cpfk_customer_orders#7110,cfpk_orders_customer#7111,cval_orders_o_orderstatus#7112,cval_orders_o_totalprice#7113,cval_orders_o_orderpriority#7114,cval_orders_o_clerk#7115,cval_orders_o_shippriority#7116,cval_orders_o_comment#7117,cval_orders_o_orderdate#7118,cdepval_orders_o_orderstatus#7119,cdepval_orders_o_totalprice#7120,cdepval_orders_o_orderpriority#7121,cdepval_orders_o_clerk#7122,cdepval_orders_o_shippriority#7123,cdepval_orders_o_comment#7124,cdepval_orders_o_orderdate#7125,co_orderstatus#7126,co_totalprice#7127,co_orderpriority#7128,co_clerk#7129,co_shippriority#7130,co_comment#7131,co_orderdate#7132] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 37971ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/25 22:57:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:57:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7297L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:57:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#7297L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#7299 AS rid_0#7344, cpfk_orders_lineitem#7300 AS cpfk_orders_lineitem_0#7345, cpfk_supplier_lineitem#7301 AS cpfk_supplier_lineitem_0#7346, cfpk_lineitem_supplier#7302 AS cfpk_lineitem_supplier_0#7347, cfpk_lineitem_partsupp#7303 AS cfpk_lineitem_partsupp_0#7348, cpfk_part_lineitem#7304 AS cpfk_part_lineitem_0#7349, cfpk_lineitem_part#7305 AS cfpk_lineitem_part_0#7350, cpfk_partsupp_lineitem#7306 AS cpfk_partsupp_lineitem_0#7351, cfpk_lineitem_orders#7307 AS cfpk_lineitem_orders_0#7352, cval_lineitem_l_quantity#7308 AS cval_lineitem_l_quantity_0#7353, cval_lineitem_l_extendedprice#7309 AS cval_lineitem_l_extendedprice_0#7354, cval_lineitem_l_discount#7310 AS cval_lineitem_l_discount_0#7355, cval_lineitem_l_tax#7311 AS cval_lineitem_l_tax_0#7356, cval_lineitem_l_returnflag#7312 AS cval_lineitem_l_returnflag_0#7357, cval_lineitem_l_linestatus#7313 AS cval_lineitem_l_linestatus_0#7358, cval_lineitem_l_commitdate#7314 AS cval_lineitem_l_commitdate_0#7359, cval_lineitem_l_receiptdate#7315 AS cval_lineitem_l_receiptdate_0#7360, cval_lineitem_l_shipinstruct#7316 AS cval_lineitem_l_shipinstruct_0#7361, cval_lineitem_l_shipmode#7317 AS cval_lineitem_l_shipmode_0#7362, cval_lineitem_l_comment#7318 AS cval_lineitem_l_comment_0#7363, cval_lineitem_l_shipdate#7319 AS cval_lineitem_l_shipdate_0#7364, cdepval_lineitem_l_quantity#7320 AS cdepval_lineitem_l_quantity_0#7365, cdepval_lineitem_l_extendedprice#7321 AS cdepval_lineitem_l_extendedprice_0#7366, cdepval_lineitem_l_discount#7322 AS cdepval_lineitem_l_discount_0#7367, ... 21 more fields]
         +- Relation[rid#7299,cpfk_orders_lineitem#7300,cpfk_supplier_lineitem#7301,cfpk_lineitem_supplier#7302,cfpk_lineitem_partsupp#7303,cpfk_part_lineitem#7304,cfpk_lineitem_part#7305,cpfk_partsupp_lineitem#7306,cfpk_lineitem_orders#7307,cval_lineitem_l_quantity#7308,cval_lineitem_l_extendedprice#7309,cval_lineitem_l_discount#7310,cval_lineitem_l_tax#7311,cval_lineitem_l_returnflag#7312,cval_lineitem_l_linestatus#7313,cval_lineitem_l_commitdate#7314,cval_lineitem_l_receiptdate#7315,cval_lineitem_l_shipinstruct#7316,cval_lineitem_l_shipmode#7317,cval_lineitem_l_comment#7318,cval_lineitem_l_shipdate#7319,cdepval_lineitem_l_quantity#7320,cdepval_lineitem_l_extendedprice#7321,cdepval_lineitem_l_discount#7322,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2355ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/25 22:57:22 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:57:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7440L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:57:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7440L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#7492 AS rid_1#7537, cpfk_orders_lineitem#7493 AS cpfk_orders_lineitem_1#7538, cpfk_supplier_lineitem#7494 AS cpfk_supplier_lineitem_1#7539, cfpk_lineitem_supplier#7495 AS cfpk_lineitem_supplier_1#7540, cfpk_lineitem_partsupp#7496 AS cfpk_lineitem_partsupp_1#7541, cpfk_part_lineitem#7497 AS cpfk_part_lineitem_1#7542, cfpk_lineitem_part#7498 AS cfpk_lineitem_part_1#7543, cpfk_partsupp_lineitem#7499 AS cpfk_partsupp_lineitem_1#7544, cfpk_lineitem_orders#7500 AS cfpk_lineitem_orders_1#7545, cval_lineitem_l_quantity#7501 AS cval_lineitem_l_quantity_1#7546, cval_lineitem_l_extendedprice#7502 AS cval_lineitem_l_extendedprice_1#7547, cval_lineitem_l_discount#7503 AS cval_lineitem_l_discount_1#7548, cval_lineitem_l_tax#7504 AS cval_lineitem_l_tax_1#7549, cval_lineitem_l_returnflag#7505 AS cval_lineitem_l_returnflag_1#7550, cval_lineitem_l_linestatus#7506 AS cval_lineitem_l_linestatus_1#7551, cval_lineitem_l_commitdate#7507 AS cval_lineitem_l_commitdate_1#7552, cval_lineitem_l_receiptdate#7508 AS cval_lineitem_l_receiptdate_1#7553, cval_lineitem_l_shipinstruct#7509 AS cval_lineitem_l_shipinstruct_1#7554, cval_lineitem_l_shipmode#7510 AS cval_lineitem_l_shipmode_1#7555, cval_lineitem_l_comment#7511 AS cval_lineitem_l_comment_1#7556, cval_lineitem_l_shipdate#7512 AS cval_lineitem_l_shipdate_1#7557, cdepval_lineitem_l_quantity#7513 AS cdepval_lineitem_l_quantity_1#7558, cdepval_lineitem_l_extendedprice#7514 AS cdepval_lineitem_l_extendedprice_1#7559, cdepval_lineitem_l_discount#7515 AS cdepval_lineitem_l_discount_1#7560, ... 21 more fields]
         :  +- Relation[rid#7492,cpfk_orders_lineitem#7493,cpfk_supplier_lineitem#7494,cfpk_lineitem_supplier#7495,cfpk_lineitem_partsupp#7496,cpfk_part_lineitem#7497,cfpk_lineitem_part#7498,cpfk_partsupp_lineitem#7499,cfpk_lineitem_orders#7500,cval_lineitem_l_quantity#7501,cval_lineitem_l_extendedprice#7502,cval_lineitem_l_discount#7503,cval_lineitem_l_tax#7504,cval_lineitem_l_returnflag#7505,cval_lineitem_l_linestatus#7506,cval_lineitem_l_commitdate#7507,cval_lineitem_l_receiptdate#7508,cval_lineitem_l_shipinstruct#7509,cval_lineitem_l_shipmode#7510,cval_lineitem_l_comment#7511,cval_lineitem_l_shipdate#7512,cdepval_lineitem_l_quantity#7513,cdepval_lineitem_l_extendedprice#7514,cdepval_lineitem_l_discount#7515,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7442 AS rid_0#7467, cval_part_p_name#7443 AS cval_part_p_name_0#7468, cval_part_p_mfgr#7444 AS cval_part_p_mfgr_0#7469, cval_part_p_type#7445 AS cval_part_p_type_0#7470, cval_part_p_size#7446 AS cval_part_p_size_0#7471, cval_part_p_container#7447 AS cval_part_p_container_0#7472, cval_part_p_retailprice#7448 AS cval_part_p_retailprice_0#7473, cval_part_p_comment#7449 AS cval_part_p_comment_0#7474, cval_part_p_brand#7450 AS cval_part_p_brand_0#7475, cdepval_part_p_name#7451 AS cdepval_part_p_name_0#7476, cdepval_part_p_mfgr#7452 AS cdepval_part_p_mfgr_0#7477, cdepval_part_p_type#7453 AS cdepval_part_p_type_0#7478, cdepval_part_p_size#7454 AS cdepval_part_p_size_0#7479, cdepval_part_p_container#7455 AS cdepval_part_p_container_0#7480, cdepval_part_p_retailprice#7456 AS cdepval_part_p_retailprice_0#7481, cdepval_part_p_comment#7457 AS cdepval_part_p_comment_0#7482, cdepval_part_p_brand#7458 AS cdepval_part_p_brand_0#7483, cp_name#7459 AS cp_name_0#7484, cp_mfgr#7460 AS cp_mfgr_0#7485, cp_type#7461 AS cp_type_0#7486, cp_size#7462 AS cp_size_0#7487, cp_container#7463 AS cp_container_0#7488, cp_retailprice#7464 AS cp_retailprice_0#7489, cp_comment#7465 AS cp_comment_0#7490, cp_brand#7466 AS cp_brand_0#7491]
            +- Relation[rid#7442,cval_part_p_name#7443,cval_part_p_mfgr#7444,cval_part_p_type#7445,cval_part_p_size#7446,cval_part_p_container#7447,cval_part_p_retailprice#7448,cval_part_p_comment#7449,cval_part_p_brand#7450,cdepval_part_p_name#7451,cdepval_part_p_mfgr#7452,cdepval_part_p_type#7453,cdepval_part_p_size#7454,cdepval_part_p_container#7455,cdepval_part_p_retailprice#7456,cdepval_part_p_comment#7457,cdepval_part_p_brand#7458,cp_name#7459,cp_mfgr#7460,cp_type#7461,cp_size#7462,cp_container#7463,cp_retailprice#7464,cp_comment#7465,cp_brand#7466] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17828ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/25 22:57:40 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:57:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7657L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 22:57:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:57:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:57:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:57:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:57:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:57:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:57:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:57:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:57:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:57:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:57:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7657L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :  :- Project [rid#7759 AS rid_1#7773, cpfk_part_partsupp#7760 AS cpfk_part_partsupp_1#7774, cfpk_partsupp_part#7761 AS cfpk_partsupp_part_1#7775, cpfk_supplier_partsupp#7762 AS cpfk_supplier_partsupp_1#7776, cfpk_partsupp_supplier#7763 AS cfpk_partsupp_supplier_1#7777, cval_partsupp_ps_availqty#7764 AS cval_partsupp_ps_availqty_1#7778, cval_partsupp_ps_supplycost#7765 AS cval_partsupp_ps_supplycost_1#7779, cval_partsupp_ps_comment#7766 AS cval_partsupp_ps_comment_1#7780, cdepval_partsupp_ps_availqty#7767 AS cdepval_partsupp_ps_availqty_1#7781, cdepval_partsupp_ps_supplycost#7768 AS cdepval_partsupp_ps_supplycost_1#7782, cdepval_partsupp_ps_comment#7769 AS cdepval_partsupp_ps_comment_1#7783, cps_availqty#7770 AS cps_availqty_1#7784, cps_supplycost#7771 AS cps_supplycost_1#7785, cps_comment#7772 AS cps_comment_1#7786]
         :  :  +- Relation[rid#7759,cpfk_part_partsupp#7760,cfpk_partsupp_part#7761,cpfk_supplier_partsupp#7762,cfpk_partsupp_supplier#7763,cval_partsupp_ps_availqty#7764,cval_partsupp_ps_supplycost#7765,cval_partsupp_ps_comment#7766,cdepval_partsupp_ps_availqty#7767,cdepval_partsupp_ps_supplycost#7768,cdepval_partsupp_ps_comment#7769,cps_availqty#7770,cps_supplycost#7771,cps_comment#7772] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :     +- Project [rid#7659 AS rid_0#7684, cval_part_p_name#7660 AS cval_part_p_name_0#7685, cval_part_p_mfgr#7661 AS cval_part_p_mfgr_0#7686, cval_part_p_type#7662 AS cval_part_p_type_0#7687, cval_part_p_size#7663 AS cval_part_p_size_0#7688, cval_part_p_container#7664 AS cval_part_p_container_0#7689, cval_part_p_retailprice#7665 AS cval_part_p_retailprice_0#7690, cval_part_p_comment#7666 AS cval_part_p_comment_0#7691, cval_part_p_brand#7667 AS cval_part_p_brand_0#7692, cdepval_part_p_name#7668 AS cdepval_part_p_name_0#7693, cdepval_part_p_mfgr#7669 AS cdepval_part_p_mfgr_0#7694, cdepval_part_p_type#7670 AS cdepval_part_p_type_0#7695, cdepval_part_p_size#7671 AS cdepval_part_p_size_0#7696, cdepval_part_p_container#7672 AS cdepval_part_p_container_0#7697, cdepval_part_p_retailprice#7673 AS cdepval_part_p_retailprice_0#7698, cdepval_part_p_comment#7674 AS cdepval_part_p_comment_0#7699, cdepval_part_p_brand#7675 AS cdepval_part_p_brand_0#7700, cp_name#7676 AS cp_name_0#7701, cp_mfgr#7677 AS cp_mfgr_0#7702, cp_type#7678 AS cp_type_0#7703, cp_size#7679 AS cp_size_0#7704, cp_container#7680 AS cp_container_0#7705, cp_retailprice#7681 AS cp_retailprice_0#7706, cp_comment#7682 AS cp_comment_0#7707, cp_brand#7683 AS cp_brand_0#7708]
         :        +- Relation[rid#7659,cval_part_p_name#7660,cval_part_p_mfgr#7661,cval_part_p_type#7662,cval_part_p_size#7663,cval_part_p_container#7664,cval_part_p_retailprice#7665,cval_part_p_comment#7666,cval_part_p_brand#7667,cdepval_part_p_name#7668,cdepval_part_p_mfgr#7669,cdepval_part_p_type#7670,cdepval_part_p_size#7671,cdepval_part_p_container#7672,cdepval_part_p_retailprice#7673,cdepval_part_p_comment#7674,cdepval_part_p_brand#7675,cp_name#7676,cp_mfgr#7677,cp_type#7678,cp_size#7679,cp_container#7680,cp_retailprice#7681,cp_comment#7682,cp_brand#7683] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_2)
            :- Project [rid#7823 AS rid_3#7841, cpfk_nation_supplier#7824 AS cpfk_nation_supplier_3#7842, cfpk_supplier_nation#7825 AS cfpk_supplier_nation_3#7843, cval_supplier_s_name#7826 AS cval_supplier_s_name_3#7844, cval_supplier_s_address#7827 AS cval_supplier_s_address_3#7845, cval_supplier_s_phone#7828 AS cval_supplier_s_phone_3#7846, cval_supplier_s_acctbal#7829 AS cval_supplier_s_acctbal_3#7847, cval_supplier_s_comment#7830 AS cval_supplier_s_comment_3#7848, cdepval_supplier_s_name#7831 AS cdepval_supplier_s_name_3#7849, cdepval_supplier_s_address#7832 AS cdepval_supplier_s_address_3#7850, cdepval_supplier_s_phone#7833 AS cdepval_supplier_s_phone_3#7851, cdepval_supplier_s_acctbal#7834 AS cdepval_supplier_s_acctbal_3#7852, cdepval_supplier_s_comment#7835 AS cdepval_supplier_s_comment_3#7853, cs_name#7836 AS cs_name_3#7854, cs_address#7837 AS cs_address_3#7855, cs_phone#7838 AS cs_phone_3#7856, cs_acctbal#7839 AS cs_acctbal_3#7857, cs_comment#7840 AS cs_comment_3#7858]
            :  +- Relation[rid#7823,cpfk_nation_supplier#7824,cfpk_supplier_nation#7825,cval_supplier_s_name#7826,cval_supplier_s_address#7827,cval_supplier_s_phone#7828,cval_supplier_s_acctbal#7829,cval_supplier_s_comment#7830,cdepval_supplier_s_name#7831,cdepval_supplier_s_address#7832,cdepval_supplier_s_phone#7833,cdepval_supplier_s_acctbal#7834,cdepval_supplier_s_comment#7835,cs_name#7836,cs_address#7837,cs_phone#7838,cs_acctbal#7839,cs_comment#7840] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
               +- Project [rid#7787 AS rid_2#7796, cpfk_region_nation#7788 AS cpfk_region_nation_2#7797, cfpk_nation_region#7789 AS cfpk_nation_region_2#7798, cval_nation_n_name#7790 AS cval_nation_n_name_2#7799, cval_nation_n_comment#7791 AS cval_nation_n_comment_2#7800, cdepval_nation_n_name#7792 AS cdepval_nation_n_name_2#7801, cdepval_nation_n_comment#7793 AS cdepval_nation_n_comment_2#7802, cn_name#7794 AS cn_name_2#7803, cn_comment#7795 AS cn_comment_2#7804]
                  +- Relation[rid#7787,cpfk_region_nation#7788,cfpk_nation_region#7789,cval_nation_n_name#7790,cval_nation_n_comment#7791,cdepval_nation_n_name#7792,cdepval_nation_n_comment#7793,cn_name#7794,cn_comment#7795] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 3586ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/25 22:57:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:57:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7932L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:57:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:57:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:57:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7932L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#7970 AS rid_1#8015, cpfk_orders_lineitem#7971 AS cpfk_orders_lineitem_1#8016, cpfk_supplier_lineitem#7972 AS cpfk_supplier_lineitem_1#8017, cfpk_lineitem_supplier#7973 AS cfpk_lineitem_supplier_1#8018, cfpk_lineitem_partsupp#7974 AS cfpk_lineitem_partsupp_1#8019, cpfk_part_lineitem#7975 AS cpfk_part_lineitem_1#8020, cfpk_lineitem_part#7976 AS cfpk_lineitem_part_1#8021, cpfk_partsupp_lineitem#7977 AS cpfk_partsupp_lineitem_1#8022, cfpk_lineitem_orders#7978 AS cfpk_lineitem_orders_1#8023, cval_lineitem_l_quantity#7979 AS cval_lineitem_l_quantity_1#8024, cval_lineitem_l_extendedprice#7980 AS cval_lineitem_l_extendedprice_1#8025, cval_lineitem_l_discount#7981 AS cval_lineitem_l_discount_1#8026, cval_lineitem_l_tax#7982 AS cval_lineitem_l_tax_1#8027, cval_lineitem_l_returnflag#7983 AS cval_lineitem_l_returnflag_1#8028, cval_lineitem_l_linestatus#7984 AS cval_lineitem_l_linestatus_1#8029, cval_lineitem_l_commitdate#7985 AS cval_lineitem_l_commitdate_1#8030, cval_lineitem_l_receiptdate#7986 AS cval_lineitem_l_receiptdate_1#8031, cval_lineitem_l_shipinstruct#7987 AS cval_lineitem_l_shipinstruct_1#8032, cval_lineitem_l_shipmode#7988 AS cval_lineitem_l_shipmode_1#8033, cval_lineitem_l_comment#7989 AS cval_lineitem_l_comment_1#8034, cval_lineitem_l_shipdate#7990 AS cval_lineitem_l_shipdate_1#8035, cdepval_lineitem_l_quantity#7991 AS cdepval_lineitem_l_quantity_1#8036, cdepval_lineitem_l_extendedprice#7992 AS cdepval_lineitem_l_extendedprice_1#8037, cdepval_lineitem_l_discount#7993 AS cdepval_lineitem_l_discount_1#8038, ... 21 more fields]
         :  +- Relation[rid#7970,cpfk_orders_lineitem#7971,cpfk_supplier_lineitem#7972,cfpk_lineitem_supplier#7973,cfpk_lineitem_partsupp#7974,cpfk_part_lineitem#7975,cfpk_lineitem_part#7976,cpfk_partsupp_lineitem#7977,cfpk_lineitem_orders#7978,cval_lineitem_l_quantity#7979,cval_lineitem_l_extendedprice#7980,cval_lineitem_l_discount#7981,cval_lineitem_l_tax#7982,cval_lineitem_l_returnflag#7983,cval_lineitem_l_linestatus#7984,cval_lineitem_l_commitdate#7985,cval_lineitem_l_receiptdate#7986,cval_lineitem_l_shipinstruct#7987,cval_lineitem_l_shipmode#7988,cval_lineitem_l_comment#7989,cval_lineitem_l_shipdate#7990,cdepval_lineitem_l_quantity#7991,cdepval_lineitem_l_extendedprice#7992,cdepval_lineitem_l_discount#7993,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7934 AS rid_0#7952, cpfk_nation_supplier#7935 AS cpfk_nation_supplier_0#7953, cfpk_supplier_nation#7936 AS cfpk_supplier_nation_0#7954, cval_supplier_s_name#7937 AS cval_supplier_s_name_0#7955, cval_supplier_s_address#7938 AS cval_supplier_s_address_0#7956, cval_supplier_s_phone#7939 AS cval_supplier_s_phone_0#7957, cval_supplier_s_acctbal#7940 AS cval_supplier_s_acctbal_0#7958, cval_supplier_s_comment#7941 AS cval_supplier_s_comment_0#7959, cdepval_supplier_s_name#7942 AS cdepval_supplier_s_name_0#7960, cdepval_supplier_s_address#7943 AS cdepval_supplier_s_address_0#7961, cdepval_supplier_s_phone#7944 AS cdepval_supplier_s_phone_0#7962, cdepval_supplier_s_acctbal#7945 AS cdepval_supplier_s_acctbal_0#7963, cdepval_supplier_s_comment#7946 AS cdepval_supplier_s_comment_0#7964, cs_name#7947 AS cs_name_0#7965, cs_address#7948 AS cs_address_0#7966, cs_phone#7949 AS cs_phone_0#7967, cs_acctbal#7950 AS cs_acctbal_0#7968, cs_comment#7951 AS cs_comment_0#7969]
            +- Relation[rid#7934,cpfk_nation_supplier#7935,cfpk_supplier_nation#7936,cval_supplier_s_name#7937,cval_supplier_s_address#7938,cval_supplier_s_phone#7939,cval_supplier_s_acctbal#7940,cval_supplier_s_comment#7941,cdepval_supplier_s_name#7942,cdepval_supplier_s_address#7943,cdepval_supplier_s_phone#7944,cdepval_supplier_s_acctbal#7945,cdepval_supplier_s_comment#7946,cs_name#7947,cs_address#7948,cs_phone#7949,cs_acctbal#7950,cs_comment#7951] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18745ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/25 22:58:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:58:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8130L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:58:02 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:58:02 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:58:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8130L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :- Project [rid#8232 AS rid_1#8246, cpfk_part_partsupp#8233 AS cpfk_part_partsupp_1#8247, cfpk_partsupp_part#8234 AS cfpk_partsupp_part_1#8248, cpfk_supplier_partsupp#8235 AS cpfk_supplier_partsupp_1#8249, cfpk_partsupp_supplier#8236 AS cfpk_partsupp_supplier_1#8250, cval_partsupp_ps_availqty#8237 AS cval_partsupp_ps_availqty_1#8251, cval_partsupp_ps_supplycost#8238 AS cval_partsupp_ps_supplycost_1#8252, cval_partsupp_ps_comment#8239 AS cval_partsupp_ps_comment_1#8253, cdepval_partsupp_ps_availqty#8240 AS cdepval_partsupp_ps_availqty_1#8254, cdepval_partsupp_ps_supplycost#8241 AS cdepval_partsupp_ps_supplycost_1#8255, cdepval_partsupp_ps_comment#8242 AS cdepval_partsupp_ps_comment_1#8256, cps_availqty#8243 AS cps_availqty_1#8257, cps_supplycost#8244 AS cps_supplycost_1#8258, cps_comment#8245 AS cps_comment_1#8259]
         :  +- Relation[rid#8232,cpfk_part_partsupp#8233,cfpk_partsupp_part#8234,cpfk_supplier_partsupp#8235,cfpk_partsupp_supplier#8236,cval_partsupp_ps_availqty#8237,cval_partsupp_ps_supplycost#8238,cval_partsupp_ps_comment#8239,cdepval_partsupp_ps_availqty#8240,cdepval_partsupp_ps_supplycost#8241,cdepval_partsupp_ps_comment#8242,cps_availqty#8243,cps_supplycost#8244,cps_comment#8245] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
            +- Project [rid#8132 AS rid_0#8157, cval_part_p_name#8133 AS cval_part_p_name_0#8158, cval_part_p_mfgr#8134 AS cval_part_p_mfgr_0#8159, cval_part_p_type#8135 AS cval_part_p_type_0#8160, cval_part_p_size#8136 AS cval_part_p_size_0#8161, cval_part_p_container#8137 AS cval_part_p_container_0#8162, cval_part_p_retailprice#8138 AS cval_part_p_retailprice_0#8163, cval_part_p_comment#8139 AS cval_part_p_comment_0#8164, cval_part_p_brand#8140 AS cval_part_p_brand_0#8165, cdepval_part_p_name#8141 AS cdepval_part_p_name_0#8166, cdepval_part_p_mfgr#8142 AS cdepval_part_p_mfgr_0#8167, cdepval_part_p_type#8143 AS cdepval_part_p_type_0#8168, cdepval_part_p_size#8144 AS cdepval_part_p_size_0#8169, cdepval_part_p_container#8145 AS cdepval_part_p_container_0#8170, cdepval_part_p_retailprice#8146 AS cdepval_part_p_retailprice_0#8171, cdepval_part_p_comment#8147 AS cdepval_part_p_comment_0#8172, cdepval_part_p_brand#8148 AS cdepval_part_p_brand_0#8173, cp_name#8149 AS cp_name_0#8174, cp_mfgr#8150 AS cp_mfgr_0#8175, cp_type#8151 AS cp_type_0#8176, cp_size#8152 AS cp_size_0#8177, cp_container#8153 AS cp_container_0#8178, cp_retailprice#8154 AS cp_retailprice_0#8179, cp_comment#8155 AS cp_comment_0#8180, cp_brand#8156 AS cp_brand_0#8181]
               +- Relation[rid#8132,cval_part_p_name#8133,cval_part_p_mfgr#8134,cval_part_p_type#8135,cval_part_p_size#8136,cval_part_p_container#8137,cval_part_p_retailprice#8138,cval_part_p_comment#8139,cval_part_p_brand#8140,cdepval_part_p_name#8141,cdepval_part_p_mfgr#8142,cdepval_part_p_type#8143,cdepval_part_p_size#8144,cdepval_part_p_container#8145,cdepval_part_p_retailprice#8146,cdepval_part_p_comment#8147,cdepval_part_p_brand#8148,cp_name#8149,cp_mfgr#8150,cp_type#8151,cp_size#8152,cp_container#8153,cp_retailprice#8154,cp_comment#8155,cp_brand#8156] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 3381ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/25 22:58:06 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:58:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8327L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:58:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8327L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#8329 AS rid_0#8374, cpfk_orders_lineitem#8330 AS cpfk_orders_lineitem_0#8375, cpfk_supplier_lineitem#8331 AS cpfk_supplier_lineitem_0#8376, cfpk_lineitem_supplier#8332 AS cfpk_lineitem_supplier_0#8377, cfpk_lineitem_partsupp#8333 AS cfpk_lineitem_partsupp_0#8378, cpfk_part_lineitem#8334 AS cpfk_part_lineitem_0#8379, cfpk_lineitem_part#8335 AS cfpk_lineitem_part_0#8380, cpfk_partsupp_lineitem#8336 AS cpfk_partsupp_lineitem_0#8381, cfpk_lineitem_orders#8337 AS cfpk_lineitem_orders_0#8382, cval_lineitem_l_quantity#8338 AS cval_lineitem_l_quantity_0#8383, cval_lineitem_l_extendedprice#8339 AS cval_lineitem_l_extendedprice_0#8384, cval_lineitem_l_discount#8340 AS cval_lineitem_l_discount_0#8385, cval_lineitem_l_tax#8341 AS cval_lineitem_l_tax_0#8386, cval_lineitem_l_returnflag#8342 AS cval_lineitem_l_returnflag_0#8387, cval_lineitem_l_linestatus#8343 AS cval_lineitem_l_linestatus_0#8388, cval_lineitem_l_commitdate#8344 AS cval_lineitem_l_commitdate_0#8389, cval_lineitem_l_receiptdate#8345 AS cval_lineitem_l_receiptdate_0#8390, cval_lineitem_l_shipinstruct#8346 AS cval_lineitem_l_shipinstruct_0#8391, cval_lineitem_l_shipmode#8347 AS cval_lineitem_l_shipmode_0#8392, cval_lineitem_l_comment#8348 AS cval_lineitem_l_comment_0#8393, cval_lineitem_l_shipdate#8349 AS cval_lineitem_l_shipdate_0#8394, cdepval_lineitem_l_quantity#8350 AS cdepval_lineitem_l_quantity_0#8395, cdepval_lineitem_l_extendedprice#8351 AS cdepval_lineitem_l_extendedprice_0#8396, cdepval_lineitem_l_discount#8352 AS cdepval_lineitem_l_discount_0#8397, ... 21 more fields]
         :  +- Relation[rid#8329,cpfk_orders_lineitem#8330,cpfk_supplier_lineitem#8331,cfpk_lineitem_supplier#8332,cfpk_lineitem_partsupp#8333,cpfk_part_lineitem#8334,cfpk_lineitem_part#8335,cpfk_partsupp_lineitem#8336,cfpk_lineitem_orders#8337,cval_lineitem_l_quantity#8338,cval_lineitem_l_extendedprice#8339,cval_lineitem_l_discount#8340,cval_lineitem_l_tax#8341,cval_lineitem_l_returnflag#8342,cval_lineitem_l_linestatus#8343,cval_lineitem_l_commitdate#8344,cval_lineitem_l_receiptdate#8345,cval_lineitem_l_shipinstruct#8346,cval_lineitem_l_shipmode#8347,cval_lineitem_l_comment#8348,cval_lineitem_l_shipdate#8349,cdepval_lineitem_l_quantity#8350,cdepval_lineitem_l_extendedprice#8351,cdepval_lineitem_l_discount#8352,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8419 AS rid_1#8443, cpfk_customer_orders#8420 AS cpfk_customer_orders_1#8444, cfpk_orders_customer#8421 AS cfpk_orders_customer_1#8445, cval_orders_o_orderstatus#8422 AS cval_orders_o_orderstatus_1#8446, cval_orders_o_totalprice#8423 AS cval_orders_o_totalprice_1#8447, cval_orders_o_orderpriority#8424 AS cval_orders_o_orderpriority_1#8448, cval_orders_o_clerk#8425 AS cval_orders_o_clerk_1#8449, cval_orders_o_shippriority#8426 AS cval_orders_o_shippriority_1#8450, cval_orders_o_comment#8427 AS cval_orders_o_comment_1#8451, cval_orders_o_orderdate#8428 AS cval_orders_o_orderdate_1#8452, cdepval_orders_o_orderstatus#8429 AS cdepval_orders_o_orderstatus_1#8453, cdepval_orders_o_totalprice#8430 AS cdepval_orders_o_totalprice_1#8454, cdepval_orders_o_orderpriority#8431 AS cdepval_orders_o_orderpriority_1#8455, cdepval_orders_o_clerk#8432 AS cdepval_orders_o_clerk_1#8456, cdepval_orders_o_shippriority#8433 AS cdepval_orders_o_shippriority_1#8457, cdepval_orders_o_comment#8434 AS cdepval_orders_o_comment_1#8458, cdepval_orders_o_orderdate#8435 AS cdepval_orders_o_orderdate_1#8459, co_orderstatus#8436 AS co_orderstatus_1#8460, co_totalprice#8437 AS co_totalprice_1#8461, co_orderpriority#8438 AS co_orderpriority_1#8462, co_clerk#8439 AS co_clerk_1#8463, co_shippriority#8440 AS co_shippriority_1#8464, co_comment#8441 AS co_comment_1#8465, co_orderdate#8442 AS co_orderdate_1#8466]
            +- Relation[rid#8419,cpfk_customer_orders#8420,cfpk_orders_customer#8421,cval_orders_o_orderstatus#8422,cval_orders_o_totalprice#8423,cval_orders_o_orderpriority#8424,cval_orders_o_clerk#8425,cval_orders_o_shippriority#8426,cval_orders_o_comment#8427,cval_orders_o_orderdate#8428,cdepval_orders_o_orderstatus#8429,cdepval_orders_o_totalprice#8430,cdepval_orders_o_orderpriority#8431,cdepval_orders_o_clerk#8432,cdepval_orders_o_shippriority#8433,cdepval_orders_o_comment#8434,cdepval_orders_o_orderdate#8435,co_orderstatus#8436,co_totalprice#8437,co_orderpriority#8438,co_clerk#8439,co_shippriority#8440,co_comment#8441,co_orderdate#8442] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18334ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/25 22:58:24 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:58:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8545L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:58:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8545L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#8637 AS rid_2#8682, cpfk_orders_lineitem#8638 AS cpfk_orders_lineitem_2#8683, cpfk_supplier_lineitem#8639 AS cpfk_supplier_lineitem_2#8684, cfpk_lineitem_supplier#8640 AS cfpk_lineitem_supplier_2#8685, cfpk_lineitem_partsupp#8641 AS cfpk_lineitem_partsupp_2#8686, cpfk_part_lineitem#8642 AS cpfk_part_lineitem_2#8687, cfpk_lineitem_part#8643 AS cfpk_lineitem_part_2#8688, cpfk_partsupp_lineitem#8644 AS cpfk_partsupp_lineitem_2#8689, cfpk_lineitem_orders#8645 AS cfpk_lineitem_orders_2#8690, cval_lineitem_l_quantity#8646 AS cval_lineitem_l_quantity_2#8691, cval_lineitem_l_extendedprice#8647 AS cval_lineitem_l_extendedprice_2#8692, cval_lineitem_l_discount#8648 AS cval_lineitem_l_discount_2#8693, cval_lineitem_l_tax#8649 AS cval_lineitem_l_tax_2#8694, cval_lineitem_l_returnflag#8650 AS cval_lineitem_l_returnflag_2#8695, cval_lineitem_l_linestatus#8651 AS cval_lineitem_l_linestatus_2#8696, cval_lineitem_l_commitdate#8652 AS cval_lineitem_l_commitdate_2#8697, cval_lineitem_l_receiptdate#8653 AS cval_lineitem_l_receiptdate_2#8698, cval_lineitem_l_shipinstruct#8654 AS cval_lineitem_l_shipinstruct_2#8699, cval_lineitem_l_shipmode#8655 AS cval_lineitem_l_shipmode_2#8700, cval_lineitem_l_comment#8656 AS cval_lineitem_l_comment_2#8701, cval_lineitem_l_shipdate#8657 AS cval_lineitem_l_shipdate_2#8702, cdepval_lineitem_l_quantity#8658 AS cdepval_lineitem_l_quantity_2#8703, cdepval_lineitem_l_extendedprice#8659 AS cdepval_lineitem_l_extendedprice_2#8704, cdepval_lineitem_l_discount#8660 AS cdepval_lineitem_l_discount_2#8705, ... 21 more fields]
         :  +- Relation[rid#8637,cpfk_orders_lineitem#8638,cpfk_supplier_lineitem#8639,cfpk_lineitem_supplier#8640,cfpk_lineitem_partsupp#8641,cpfk_part_lineitem#8642,cfpk_lineitem_part#8643,cpfk_partsupp_lineitem#8644,cfpk_lineitem_orders#8645,cval_lineitem_l_quantity#8646,cval_lineitem_l_extendedprice#8647,cval_lineitem_l_discount#8648,cval_lineitem_l_tax#8649,cval_lineitem_l_returnflag#8650,cval_lineitem_l_linestatus#8651,cval_lineitem_l_commitdate#8652,cval_lineitem_l_receiptdate#8653,cval_lineitem_l_shipinstruct#8654,cval_lineitem_l_shipmode#8655,cval_lineitem_l_comment#8656,cval_lineitem_l_shipdate#8657,cdepval_lineitem_l_quantity#8658,cdepval_lineitem_l_extendedprice#8659,cdepval_lineitem_l_discount#8660,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#8589 AS rid_1#8613, cpfk_customer_orders#8590 AS cpfk_customer_orders_1#8614, cfpk_orders_customer#8591 AS cfpk_orders_customer_1#8615, cval_orders_o_orderstatus#8592 AS cval_orders_o_orderstatus_1#8616, cval_orders_o_totalprice#8593 AS cval_orders_o_totalprice_1#8617, cval_orders_o_orderpriority#8594 AS cval_orders_o_orderpriority_1#8618, cval_orders_o_clerk#8595 AS cval_orders_o_clerk_1#8619, cval_orders_o_shippriority#8596 AS cval_orders_o_shippriority_1#8620, cval_orders_o_comment#8597 AS cval_orders_o_comment_1#8621, cval_orders_o_orderdate#8598 AS cval_orders_o_orderdate_1#8622, cdepval_orders_o_orderstatus#8599 AS cdepval_orders_o_orderstatus_1#8623, cdepval_orders_o_totalprice#8600 AS cdepval_orders_o_totalprice_1#8624, cdepval_orders_o_orderpriority#8601 AS cdepval_orders_o_orderpriority_1#8625, cdepval_orders_o_clerk#8602 AS cdepval_orders_o_clerk_1#8626, cdepval_orders_o_shippriority#8603 AS cdepval_orders_o_shippriority_1#8627, cdepval_orders_o_comment#8604 AS cdepval_orders_o_comment_1#8628, cdepval_orders_o_orderdate#8605 AS cdepval_orders_o_orderdate_1#8629, co_orderstatus#8606 AS co_orderstatus_1#8630, co_totalprice#8607 AS co_totalprice_1#8631, co_orderpriority#8608 AS co_orderpriority_1#8632, co_clerk#8609 AS co_clerk_1#8633, co_shippriority#8610 AS co_shippriority_1#8634, co_comment#8611 AS co_comment_1#8635, co_orderdate#8612 AS co_orderdate_1#8636]
            :  +- Relation[rid#8589,cpfk_customer_orders#8590,cfpk_orders_customer#8591,cval_orders_o_orderstatus#8592,cval_orders_o_totalprice#8593,cval_orders_o_orderpriority#8594,cval_orders_o_clerk#8595,cval_orders_o_shippriority#8596,cval_orders_o_comment#8597,cval_orders_o_orderdate#8598,cdepval_orders_o_orderstatus#8599,cdepval_orders_o_totalprice#8600,cdepval_orders_o_orderpriority#8601,cdepval_orders_o_clerk#8602,cdepval_orders_o_shippriority#8603,cdepval_orders_o_comment#8604,cdepval_orders_o_orderdate#8605,co_orderstatus#8606,co_totalprice#8607,co_orderpriority#8608,co_clerk#8609,co_shippriority#8610,co_comment#8611,co_orderdate#8612] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#8547 AS rid_0#8568, cpfk_nation_customer#8548 AS cpfk_nation_customer_0#8569, cfpk_customer_nation#8549 AS cfpk_customer_nation_0#8570, cval_customer_c_name#8550 AS cval_customer_c_name_0#8571, cval_customer_c_address#8551 AS cval_customer_c_address_0#8572, cval_customer_c_phone#8552 AS cval_customer_c_phone_0#8573, cval_customer_c_acctbal#8553 AS cval_customer_c_acctbal_0#8574, cval_customer_c_comment#8554 AS cval_customer_c_comment_0#8575, cval_customer_c_mktsegment#8555 AS cval_customer_c_mktsegment_0#8576, cdepval_customer_c_name#8556 AS cdepval_customer_c_name_0#8577, cdepval_customer_c_address#8557 AS cdepval_customer_c_address_0#8578, cdepval_customer_c_phone#8558 AS cdepval_customer_c_phone_0#8579, cdepval_customer_c_acctbal#8559 AS cdepval_customer_c_acctbal_0#8580, cdepval_customer_c_comment#8560 AS cdepval_customer_c_comment_0#8581, cdepval_customer_c_mktsegment#8561 AS cdepval_customer_c_mktsegment_0#8582, cc_name#8562 AS cc_name_0#8583, cc_address#8563 AS cc_address_0#8584, cc_phone#8564 AS cc_phone_0#8585, cc_acctbal#8565 AS cc_acctbal_0#8586, cc_comment#8566 AS cc_comment_0#8587, cc_mktsegment#8567 AS cc_mktsegment_0#8588]
               +- Relation[rid#8547,cpfk_nation_customer#8548,cfpk_customer_nation#8549,cval_customer_c_name#8550,cval_customer_c_address#8551,cval_customer_c_phone#8552,cval_customer_c_acctbal#8553,cval_customer_c_comment#8554,cval_customer_c_mktsegment#8555,cdepval_customer_c_name#8556,cdepval_customer_c_address#8557,cdepval_customer_c_phone#8558,cdepval_customer_c_acctbal#8559,cdepval_customer_c_comment#8560,cdepval_customer_c_mktsegment#8561,cc_name#8562,cc_address#8563,cc_phone#8564,cc_acctbal#8565,cc_comment#8566,cc_mktsegment#8567] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 21966ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/25 22:58:46 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:58:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8821L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:58:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:58:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:58:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:58:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:58:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:58:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:58:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8821L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#8973 AS rid_1#9018, cpfk_orders_lineitem#8974 AS cpfk_orders_lineitem_1#9019, cpfk_supplier_lineitem#8975 AS cpfk_supplier_lineitem_1#9020, cfpk_lineitem_supplier#8976 AS cfpk_lineitem_supplier_1#9021, cfpk_lineitem_partsupp#8977 AS cfpk_lineitem_partsupp_1#9022, cpfk_part_lineitem#8978 AS cpfk_part_lineitem_1#9023, cfpk_lineitem_part#8979 AS cfpk_lineitem_part_1#9024, cpfk_partsupp_lineitem#8980 AS cpfk_partsupp_lineitem_1#9025, cfpk_lineitem_orders#8981 AS cfpk_lineitem_orders_1#9026, cval_lineitem_l_quantity#8982 AS cval_lineitem_l_quantity_1#9027, cval_lineitem_l_extendedprice#8983 AS cval_lineitem_l_extendedprice_1#9028, cval_lineitem_l_discount#8984 AS cval_lineitem_l_discount_1#9029, cval_lineitem_l_tax#8985 AS cval_lineitem_l_tax_1#9030, cval_lineitem_l_returnflag#8986 AS cval_lineitem_l_returnflag_1#9031, cval_lineitem_l_linestatus#8987 AS cval_lineitem_l_linestatus_1#9032, cval_lineitem_l_commitdate#8988 AS cval_lineitem_l_commitdate_1#9033, cval_lineitem_l_receiptdate#8989 AS cval_lineitem_l_receiptdate_1#9034, cval_lineitem_l_shipinstruct#8990 AS cval_lineitem_l_shipinstruct_1#9035, cval_lineitem_l_shipmode#8991 AS cval_lineitem_l_shipmode_1#9036, cval_lineitem_l_comment#8992 AS cval_lineitem_l_comment_1#9037, cval_lineitem_l_shipdate#8993 AS cval_lineitem_l_shipdate_1#9038, cdepval_lineitem_l_quantity#8994 AS cdepval_lineitem_l_quantity_1#9039, cdepval_lineitem_l_extendedprice#8995 AS cdepval_lineitem_l_extendedprice_1#9040, cdepval_lineitem_l_discount#8996 AS cdepval_lineitem_l_discount_1#9041, ... 21 more fields]
         :  +- Relation[rid#8973,cpfk_orders_lineitem#8974,cpfk_supplier_lineitem#8975,cfpk_lineitem_supplier#8976,cfpk_lineitem_partsupp#8977,cpfk_part_lineitem#8978,cfpk_lineitem_part#8979,cpfk_partsupp_lineitem#8980,cfpk_lineitem_orders#8981,cval_lineitem_l_quantity#8982,cval_lineitem_l_extendedprice#8983,cval_lineitem_l_discount#8984,cval_lineitem_l_tax#8985,cval_lineitem_l_returnflag#8986,cval_lineitem_l_linestatus#8987,cval_lineitem_l_commitdate#8988,cval_lineitem_l_receiptdate#8989,cval_lineitem_l_shipinstruct#8990,cval_lineitem_l_shipmode#8991,cval_lineitem_l_comment#8992,cval_lineitem_l_shipdate#8993,cdepval_lineitem_l_quantity#8994,cdepval_lineitem_l_extendedprice#8995,cdepval_lineitem_l_discount#8996,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
               +- Project [rid#8823 AS rid_0#8848, cval_part_p_name#8824 AS cval_part_p_name_0#8849, cval_part_p_mfgr#8825 AS cval_part_p_mfgr_0#8850, cval_part_p_type#8826 AS cval_part_p_type_0#8851, cval_part_p_size#8827 AS cval_part_p_size_0#8852, cval_part_p_container#8828 AS cval_part_p_container_0#8853, cval_part_p_retailprice#8829 AS cval_part_p_retailprice_0#8854, cval_part_p_comment#8830 AS cval_part_p_comment_0#8855, cval_part_p_brand#8831 AS cval_part_p_brand_0#8856, cdepval_part_p_name#8832 AS cdepval_part_p_name_0#8857, cdepval_part_p_mfgr#8833 AS cdepval_part_p_mfgr_0#8858, cdepval_part_p_type#8834 AS cdepval_part_p_type_0#8859, cdepval_part_p_size#8835 AS cdepval_part_p_size_0#8860, cdepval_part_p_container#8836 AS cdepval_part_p_container_0#8861, cdepval_part_p_retailprice#8837 AS cdepval_part_p_retailprice_0#8862, cdepval_part_p_comment#8838 AS cdepval_part_p_comment_0#8863, cdepval_part_p_brand#8839 AS cdepval_part_p_brand_0#8864, cp_name#8840 AS cp_name_0#8865, cp_mfgr#8841 AS cp_mfgr_0#8866, cp_type#8842 AS cp_type_0#8867, cp_size#8843 AS cp_size_0#8868, cp_container#8844 AS cp_container_0#8869, cp_retailprice#8845 AS cp_retailprice_0#8870, cp_comment#8846 AS cp_comment_0#8871, cp_brand#8847 AS cp_brand_0#8872]
                  +- Relation[rid#8823,cval_part_p_name#8824,cval_part_p_mfgr#8825,cval_part_p_type#8826,cval_part_p_size#8827,cval_part_p_container#8828,cval_part_p_retailprice#8829,cval_part_p_comment#8830,cval_part_p_brand#8831,cdepval_part_p_name#8832,cdepval_part_p_mfgr#8833,cdepval_part_p_type#8834,cdepval_part_p_size#8835,cdepval_part_p_container#8836,cdepval_part_p_retailprice#8837,cdepval_part_p_comment#8838,cdepval_part_p_brand#8839,cp_name#8840,cp_mfgr#8841,cp_type#8842,cp_size#8843,cp_container#8844,cp_retailprice#8845,cp_comment#8846,cp_brand#8847] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 25798ms
query=q1, count=6001215, duration=2466
query=q10, count=1478870, duration=60877
query=q11, count=31680, duration=3423
query=q12, count=857401, duration=22737
query=q13, count=1500000, duration=4390
query=q14, count=6001215, duration=17828
query=q15, count=6001215, duration=18745
query=q16, count=15780, duration=3381
query=q17, count=6088, duration=25798
query=q18, count=6001215, duration=21966
query=q19, count=205, duration=16814
query=q2, count=3162, duration=3703
query=q20, count=632, duration=3586
query=q21a, count=597422, duration=75620
query=q22, count=1500000, duration=4422
query=q3, count=1214743, duration=39344
query=q4, count=6001215, duration=18334
query=q5, count=48089, duration=30603
query=q6, count=6001215, duration=2355
query=q7, count=9735, duration=35134
query=q8, count=8716, duration=44742
query=q9a, count=6001215, duration=63828
query=q9b, count=6001215, duration=37971
