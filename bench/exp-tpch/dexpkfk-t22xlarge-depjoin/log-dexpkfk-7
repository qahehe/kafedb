20/04/15 16:35:05 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 38709ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Apr 15 16:35:10 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Apr 15 16:35:16 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Apr 15 16:35:16 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Apr 15 16:35:17 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Apr 15 16:35:17 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Apr 15 16:35:37 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Apr 15 16:35:46 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Apr 15 16:35:46 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/15 16:35:48 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:35:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2078L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:35:49 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/15 16:35:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2078L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#2080 AS rid_0#2113, cpfk_orders_lineitem#2081 AS cpfk_orders_lineitem_0#2114, cpfk_supplier_lineitem#2082 AS cpfk_supplier_lineitem_0#2115, cfpk_lineitem_supplier#2083 AS cfpk_lineitem_supplier_0#2116, cfpk_lineitem_partsupp#2084 AS cfpk_lineitem_partsupp_0#2117, cpfk_part_lineitem#2085 AS cpfk_part_lineitem_0#2118, cfpk_lineitem_part#2086 AS cfpk_lineitem_part_0#2119, cpfk_partsupp_lineitem#2087 AS cpfk_partsupp_lineitem_0#2120, cfpk_lineitem_orders#2088 AS cfpk_lineitem_orders_0#2121, cval_lineitem_l_quantity#2089 AS cval_lineitem_l_quantity_0#2122, cval_lineitem_l_extendedprice#2090 AS cval_lineitem_l_extendedprice_0#2123, cval_lineitem_l_discount#2091 AS cval_lineitem_l_discount_0#2124, cval_lineitem_l_tax#2092 AS cval_lineitem_l_tax_0#2125, cval_lineitem_l_returnflag#2093 AS cval_lineitem_l_returnflag_0#2126, cval_lineitem_l_linestatus#2094 AS cval_lineitem_l_linestatus_0#2127, cval_lineitem_l_commitdate#2095 AS cval_lineitem_l_commitdate_0#2128, cval_lineitem_l_receiptdate#2096 AS cval_lineitem_l_receiptdate_0#2129, cval_lineitem_l_shipinstruct#2097 AS cval_lineitem_l_shipinstruct_0#2130, cval_lineitem_l_shipmode#2098 AS cval_lineitem_l_shipmode_0#2131, cval_lineitem_l_comment#2099 AS cval_lineitem_l_comment_0#2132, cval_lineitem_l_shipdate#2100 AS cval_lineitem_l_shipdate_0#2133, cl_quantity#2101 AS cl_quantity_0#2134, cl_extendedprice#2102 AS cl_extendedprice_0#2135, cl_discount#2103 AS cl_discount_0#2136, ... 9 more fields]
            :  :  +- Relation[rid#2080,cpfk_orders_lineitem#2081,cpfk_supplier_lineitem#2082,cfpk_lineitem_supplier#2083,cfpk_lineitem_partsupp#2084,cpfk_part_lineitem#2085,cfpk_lineitem_part#2086,cpfk_partsupp_lineitem#2087,cfpk_lineitem_orders#2088,cval_lineitem_l_quantity#2089,cval_lineitem_l_extendedprice#2090,cval_lineitem_l_discount#2091,cval_lineitem_l_tax#2092,cval_lineitem_l_returnflag#2093,cval_lineitem_l_linestatus#2094,cval_lineitem_l_commitdate#2095,cval_lineitem_l_receiptdate#2096,cval_lineitem_l_shipinstruct#2097,cval_lineitem_l_shipmode#2098,cval_lineitem_l_comment#2099,cval_lineitem_l_shipdate#2100,cl_quantity#2101,cl_extendedprice#2102,cl_discount#2103,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#2146 AS rid_0#2179, cpfk_orders_lineitem#2147 AS cpfk_orders_lineitem_0#2180, cpfk_supplier_lineitem#2148 AS cpfk_supplier_lineitem_0#2181, cfpk_lineitem_supplier#2149 AS cfpk_lineitem_supplier_0#2182, cfpk_lineitem_partsupp#2150 AS cfpk_lineitem_partsupp_0#2183, cpfk_part_lineitem#2151 AS cpfk_part_lineitem_0#2184, cfpk_lineitem_part#2152 AS cfpk_lineitem_part_0#2185, cpfk_partsupp_lineitem#2153 AS cpfk_partsupp_lineitem_0#2186, cfpk_lineitem_orders#2154 AS cfpk_lineitem_orders_0#2187, cval_lineitem_l_quantity#2155 AS cval_lineitem_l_quantity_0#2188, cval_lineitem_l_extendedprice#2156 AS cval_lineitem_l_extendedprice_0#2189, cval_lineitem_l_discount#2157 AS cval_lineitem_l_discount_0#2190, cval_lineitem_l_tax#2158 AS cval_lineitem_l_tax_0#2191, cval_lineitem_l_returnflag#2159 AS cval_lineitem_l_returnflag_0#2192, cval_lineitem_l_linestatus#2160 AS cval_lineitem_l_linestatus_0#2193, cval_lineitem_l_commitdate#2161 AS cval_lineitem_l_commitdate_0#2194, cval_lineitem_l_receiptdate#2162 AS cval_lineitem_l_receiptdate_0#2195, cval_lineitem_l_shipinstruct#2163 AS cval_lineitem_l_shipinstruct_0#2196, cval_lineitem_l_shipmode#2164 AS cval_lineitem_l_shipmode_0#2197, cval_lineitem_l_comment#2165 AS cval_lineitem_l_comment_0#2198, cval_lineitem_l_shipdate#2166 AS cval_lineitem_l_shipdate_0#2199, cl_quantity#2167 AS cl_quantity_0#2200, cl_extendedprice#2168 AS cl_extendedprice_0#2201, cl_discount#2169 AS cl_discount_0#2202, ... 9 more fields]
            :        +- Relation[rid#2146,cpfk_orders_lineitem#2147,cpfk_supplier_lineitem#2148,cfpk_lineitem_supplier#2149,cfpk_lineitem_partsupp#2150,cpfk_part_lineitem#2151,cfpk_lineitem_part#2152,cpfk_partsupp_lineitem#2153,cfpk_lineitem_orders#2154,cval_lineitem_l_quantity#2155,cval_lineitem_l_extendedprice#2156,cval_lineitem_l_discount#2157,cval_lineitem_l_tax#2158,cval_lineitem_l_returnflag#2159,cval_lineitem_l_linestatus#2160,cval_lineitem_l_commitdate#2161,cval_lineitem_l_receiptdate#2162,cval_lineitem_l_shipinstruct#2163,cval_lineitem_l_shipmode#2164,cval_lineitem_l_comment#2165,cval_lineitem_l_shipdate#2166,cl_quantity#2167,cl_extendedprice#2168,cl_discount#2169,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#2212 AS rid_1#2229, cpfk_customer_orders#2213 AS cpfk_customer_orders_1#2230, cfpk_orders_customer#2214 AS cfpk_orders_customer_1#2231, cval_orders_o_orderstatus#2215 AS cval_orders_o_orderstatus_1#2232, cval_orders_o_totalprice#2216 AS cval_orders_o_totalprice_1#2233, cval_orders_o_orderpriority#2217 AS cval_orders_o_orderpriority_1#2234, cval_orders_o_clerk#2218 AS cval_orders_o_clerk_1#2235, cval_orders_o_shippriority#2219 AS cval_orders_o_shippriority_1#2236, cval_orders_o_comment#2220 AS cval_orders_o_comment_1#2237, cval_orders_o_orderdate#2221 AS cval_orders_o_orderdate_1#2238, co_orderstatus#2222 AS co_orderstatus_1#2239, co_totalprice#2223 AS co_totalprice_1#2240, co_orderpriority#2224 AS co_orderpriority_1#2241, co_clerk#2225 AS co_clerk_1#2242, co_shippriority#2226 AS co_shippriority_1#2243, co_comment#2227 AS co_comment_1#2244, co_orderdate#2228 AS co_orderdate_1#2245]
               +- Relation[rid#2212,cpfk_customer_orders#2213,cfpk_orders_customer#2214,cval_orders_o_orderstatus#2215,cval_orders_o_totalprice#2216,cval_orders_o_orderpriority#2217,cval_orders_o_clerk#2218,cval_orders_o_shippriority#2219,cval_orders_o_comment#2220,cval_orders_o_orderdate#2221,co_orderstatus#2222,co_totalprice#2223,co_orderpriority#2224,co_clerk#2225,co_shippriority#2226,co_comment#2227,co_orderdate#2228] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 24432ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/15 16:36:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:36:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2308L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 16:36:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:36:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:36:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2308L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#2310 AS rid_0#2343, cpfk_orders_lineitem#2311 AS cpfk_orders_lineitem_0#2344, cpfk_supplier_lineitem#2312 AS cpfk_supplier_lineitem_0#2345, cfpk_lineitem_supplier#2313 AS cfpk_lineitem_supplier_0#2346, cfpk_lineitem_partsupp#2314 AS cfpk_lineitem_partsupp_0#2347, cpfk_part_lineitem#2315 AS cpfk_part_lineitem_0#2348, cfpk_lineitem_part#2316 AS cfpk_lineitem_part_0#2349, cpfk_partsupp_lineitem#2317 AS cpfk_partsupp_lineitem_0#2350, cfpk_lineitem_orders#2318 AS cfpk_lineitem_orders_0#2351, cval_lineitem_l_quantity#2319 AS cval_lineitem_l_quantity_0#2352, cval_lineitem_l_extendedprice#2320 AS cval_lineitem_l_extendedprice_0#2353, cval_lineitem_l_discount#2321 AS cval_lineitem_l_discount_0#2354, cval_lineitem_l_tax#2322 AS cval_lineitem_l_tax_0#2355, cval_lineitem_l_returnflag#2323 AS cval_lineitem_l_returnflag_0#2356, cval_lineitem_l_linestatus#2324 AS cval_lineitem_l_linestatus_0#2357, cval_lineitem_l_commitdate#2325 AS cval_lineitem_l_commitdate_0#2358, cval_lineitem_l_receiptdate#2326 AS cval_lineitem_l_receiptdate_0#2359, cval_lineitem_l_shipinstruct#2327 AS cval_lineitem_l_shipinstruct_0#2360, cval_lineitem_l_shipmode#2328 AS cval_lineitem_l_shipmode_0#2361, cval_lineitem_l_comment#2329 AS cval_lineitem_l_comment_0#2362, cval_lineitem_l_shipdate#2330 AS cval_lineitem_l_shipdate_0#2363, cl_quantity#2331 AS cl_quantity_0#2364, cl_extendedprice#2332 AS cl_extendedprice_0#2365, cl_discount#2333 AS cl_discount_0#2366, ... 9 more fields]
            :     :     :  :  +- Relation[rid#2310,cpfk_orders_lineitem#2311,cpfk_supplier_lineitem#2312,cfpk_lineitem_supplier#2313,cfpk_lineitem_partsupp#2314,cpfk_part_lineitem#2315,cfpk_lineitem_part#2316,cpfk_partsupp_lineitem#2317,cfpk_lineitem_orders#2318,cval_lineitem_l_quantity#2319,cval_lineitem_l_extendedprice#2320,cval_lineitem_l_discount#2321,cval_lineitem_l_tax#2322,cval_lineitem_l_returnflag#2323,cval_lineitem_l_linestatus#2324,cval_lineitem_l_commitdate#2325,cval_lineitem_l_receiptdate#2326,cval_lineitem_l_shipinstruct#2327,cval_lineitem_l_shipmode#2328,cval_lineitem_l_comment#2329,cval_lineitem_l_shipdate#2330,cl_quantity#2331,cl_extendedprice#2332,cl_discount#2333,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#2376 AS rid_0#2409, cpfk_orders_lineitem#2377 AS cpfk_orders_lineitem_0#2410, cpfk_supplier_lineitem#2378 AS cpfk_supplier_lineitem_0#2411, cfpk_lineitem_supplier#2379 AS cfpk_lineitem_supplier_0#2412, cfpk_lineitem_partsupp#2380 AS cfpk_lineitem_partsupp_0#2413, cpfk_part_lineitem#2381 AS cpfk_part_lineitem_0#2414, cfpk_lineitem_part#2382 AS cfpk_lineitem_part_0#2415, cpfk_partsupp_lineitem#2383 AS cpfk_partsupp_lineitem_0#2416, cfpk_lineitem_orders#2384 AS cfpk_lineitem_orders_0#2417, cval_lineitem_l_quantity#2385 AS cval_lineitem_l_quantity_0#2418, cval_lineitem_l_extendedprice#2386 AS cval_lineitem_l_extendedprice_0#2419, cval_lineitem_l_discount#2387 AS cval_lineitem_l_discount_0#2420, cval_lineitem_l_tax#2388 AS cval_lineitem_l_tax_0#2421, cval_lineitem_l_returnflag#2389 AS cval_lineitem_l_returnflag_0#2422, cval_lineitem_l_linestatus#2390 AS cval_lineitem_l_linestatus_0#2423, cval_lineitem_l_commitdate#2391 AS cval_lineitem_l_commitdate_0#2424, cval_lineitem_l_receiptdate#2392 AS cval_lineitem_l_receiptdate_0#2425, cval_lineitem_l_shipinstruct#2393 AS cval_lineitem_l_shipinstruct_0#2426, cval_lineitem_l_shipmode#2394 AS cval_lineitem_l_shipmode_0#2427, cval_lineitem_l_comment#2395 AS cval_lineitem_l_comment_0#2428, cval_lineitem_l_shipdate#2396 AS cval_lineitem_l_shipdate_0#2429, cl_quantity#2397 AS cl_quantity_0#2430, cl_extendedprice#2398 AS cl_extendedprice_0#2431, cl_discount#2399 AS cl_discount_0#2432, ... 9 more fields]
            :     :     :        +- Relation[rid#2376,cpfk_orders_lineitem#2377,cpfk_supplier_lineitem#2378,cfpk_lineitem_supplier#2379,cfpk_lineitem_partsupp#2380,cpfk_part_lineitem#2381,cfpk_lineitem_part#2382,cpfk_partsupp_lineitem#2383,cfpk_lineitem_orders#2384,cval_lineitem_l_quantity#2385,cval_lineitem_l_extendedprice#2386,cval_lineitem_l_discount#2387,cval_lineitem_l_tax#2388,cval_lineitem_l_returnflag#2389,cval_lineitem_l_linestatus#2390,cval_lineitem_l_commitdate#2391,cval_lineitem_l_receiptdate#2392,cval_lineitem_l_shipinstruct#2393,cval_lineitem_l_shipmode#2394,cval_lineitem_l_comment#2395,cval_lineitem_l_shipdate#2396,cl_quantity#2397,cl_extendedprice#2398,cl_discount#2399,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#2442 AS rid_1#2459, cpfk_customer_orders#2443 AS cpfk_customer_orders_1#2460, cfpk_orders_customer#2444 AS cfpk_orders_customer_1#2461, cval_orders_o_orderstatus#2445 AS cval_orders_o_orderstatus_1#2462, cval_orders_o_totalprice#2446 AS cval_orders_o_totalprice_1#2463, cval_orders_o_orderpriority#2447 AS cval_orders_o_orderpriority_1#2464, cval_orders_o_clerk#2448 AS cval_orders_o_clerk_1#2465, cval_orders_o_shippriority#2449 AS cval_orders_o_shippriority_1#2466, cval_orders_o_comment#2450 AS cval_orders_o_comment_1#2467, cval_orders_o_orderdate#2451 AS cval_orders_o_orderdate_1#2468, co_orderstatus#2452 AS co_orderstatus_1#2469, co_totalprice#2453 AS co_totalprice_1#2470, co_orderpriority#2454 AS co_orderpriority_1#2471, co_clerk#2455 AS co_clerk_1#2472, co_shippriority#2456 AS co_shippriority_1#2473, co_comment#2457 AS co_comment_1#2474, co_orderdate#2458 AS co_orderdate_1#2475]
            :     :        +- Relation[rid#2442,cpfk_customer_orders#2443,cfpk_orders_customer#2444,cval_orders_o_orderstatus#2445,cval_orders_o_totalprice#2446,cval_orders_o_orderpriority#2447,cval_orders_o_clerk#2448,cval_orders_o_shippriority#2449,cval_orders_o_comment#2450,cval_orders_o_orderdate#2451,co_orderstatus#2452,co_totalprice#2453,co_orderpriority#2454,co_clerk#2455,co_shippriority#2456,co_comment#2457,co_orderdate#2458] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#2476 AS rid_2#2491, cpfk_nation_customer#2477 AS cpfk_nation_customer_2#2492, cfpk_customer_nation#2478 AS cfpk_customer_nation_2#2493, cval_customer_c_name#2479 AS cval_customer_c_name_2#2494, cval_customer_c_address#2480 AS cval_customer_c_address_2#2495, cval_customer_c_phone#2481 AS cval_customer_c_phone_2#2496, cval_customer_c_acctbal#2482 AS cval_customer_c_acctbal_2#2497, cval_customer_c_comment#2483 AS cval_customer_c_comment_2#2498, cval_customer_c_mktsegment#2484 AS cval_customer_c_mktsegment_2#2499, cc_name#2485 AS cc_name_2#2500, cc_address#2486 AS cc_address_2#2501, cc_phone#2487 AS cc_phone_2#2502, cc_acctbal#2488 AS cc_acctbal_2#2503, cc_comment#2489 AS cc_comment_2#2504, cc_mktsegment#2490 AS cc_mktsegment_2#2505]
            :        +- Relation[rid#2476,cpfk_nation_customer#2477,cfpk_customer_nation#2478,cval_customer_c_name#2479,cval_customer_c_address#2480,cval_customer_c_phone#2481,cval_customer_c_acctbal#2482,cval_customer_c_comment#2483,cval_customer_c_mktsegment#2484,cc_name#2485,cc_address#2486,cc_phone#2487,cc_acctbal#2488,cc_comment#2489,cc_mktsegment#2490] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#2506 AS rid_3#2513, cpfk_region_nation#2507 AS cpfk_region_nation_3#2514, cfpk_nation_region#2508 AS cfpk_nation_region_3#2515, cval_nation_n_name#2509 AS cval_nation_n_name_3#2516, cval_nation_n_comment#2510 AS cval_nation_n_comment_3#2517, cn_name#2511 AS cn_name_3#2518, cn_comment#2512 AS cn_comment_3#2519]
               +- Relation[rid#2506,cpfk_region_nation#2507,cfpk_nation_region#2508,cval_nation_n_name#2509,cval_nation_n_comment#2510,cn_name#2511,cn_comment#2512] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 69873ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/15 16:37:23 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:37:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2598L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 16:37:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:37:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:37:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:37:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:37:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:37:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:37:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:37:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:37:23 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:37:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:37:23 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:37:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:37:23 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:37:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2598L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#2600 AS rid_0#2607, cpfk_region_nation#2601 AS cpfk_region_nation_0#2608, cfpk_nation_region#2602 AS cfpk_nation_region_0#2609, cval_nation_n_name#2603 AS cval_nation_n_name_0#2610, cval_nation_n_comment#2604 AS cval_nation_n_comment_0#2611, cn_name#2605 AS cn_name_0#2612, cn_comment#2606 AS cn_comment_0#2613]
         :  :  :  :  :  +- Relation[rid#2600,cpfk_region_nation#2601,cfpk_nation_region#2602,cval_nation_n_name#2603,cval_nation_n_comment#2604,cn_name#2605,cn_comment#2606] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#2614 AS rid_0#2621, cpfk_region_nation#2615 AS cpfk_region_nation_0#2622, cfpk_nation_region#2616 AS cfpk_nation_region_0#2623, cval_nation_n_name#2617 AS cval_nation_n_name_0#2624, cval_nation_n_comment#2618 AS cval_nation_n_comment_0#2625, cn_name#2619 AS cn_name_0#2626, cn_comment#2620 AS cn_comment_0#2627]
         :  :  :  :        +- Relation[rid#2614,cpfk_region_nation#2615,cfpk_nation_region#2616,cval_nation_n_name#2617,cval_nation_n_comment#2618,cn_name#2619,cn_comment#2620] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#2668 AS rid_1#2681, cpfk_nation_supplier#2669 AS cpfk_nation_supplier_1#2682, cfpk_supplier_nation#2670 AS cfpk_supplier_nation_1#2683, cval_supplier_s_name#2671 AS cval_supplier_s_name_1#2684, cval_supplier_s_address#2672 AS cval_supplier_s_address_1#2685, cval_supplier_s_phone#2673 AS cval_supplier_s_phone_1#2686, cval_supplier_s_acctbal#2674 AS cval_supplier_s_acctbal_1#2687, cval_supplier_s_comment#2675 AS cval_supplier_s_comment_1#2688, cs_name#2676 AS cs_name_1#2689, cs_address#2677 AS cs_address_1#2690, cs_phone#2678 AS cs_phone_1#2691, cs_acctbal#2679 AS cs_acctbal_1#2692, cs_comment#2680 AS cs_comment_1#2693]
         :  :  :     +- Relation[rid#2668,cpfk_nation_supplier#2669,cfpk_supplier_nation#2670,cval_supplier_s_name#2671,cval_supplier_s_address#2672,cval_supplier_s_phone#2673,cval_supplier_s_acctbal#2674,cval_supplier_s_comment#2675,cs_name#2676,cs_address#2677,cs_phone#2678,cs_acctbal#2679,cs_comment#2680] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#2628 AS rid_1#2641, cpfk_nation_supplier#2629 AS cpfk_nation_supplier_1#2642, cfpk_supplier_nation#2630 AS cfpk_supplier_nation_1#2643, cval_supplier_s_name#2631 AS cval_supplier_s_name_1#2644, cval_supplier_s_address#2632 AS cval_supplier_s_address_1#2645, cval_supplier_s_phone#2633 AS cval_supplier_s_phone_1#2646, cval_supplier_s_acctbal#2634 AS cval_supplier_s_acctbal_1#2647, cval_supplier_s_comment#2635 AS cval_supplier_s_comment_1#2648, cs_name#2636 AS cs_name_1#2649, cs_address#2637 AS cs_address_1#2650, cs_phone#2638 AS cs_phone_1#2651, cs_acctbal#2639 AS cs_acctbal_1#2652, cs_comment#2640 AS cs_comment_1#2653]
         :  :     +- Relation[rid#2628,cpfk_nation_supplier#2629,cfpk_supplier_nation#2630,cval_supplier_s_name#2631,cval_supplier_s_address#2632,cval_supplier_s_phone#2633,cval_supplier_s_acctbal#2634,cval_supplier_s_comment#2635,cs_name#2636,cs_address#2637,cs_phone#2638,cs_acctbal#2639,cs_comment#2640] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#2742 AS rid_2#2753, cpfk_part_partsupp#2743 AS cpfk_part_partsupp_2#2754, cfpk_partsupp_part#2744 AS cfpk_partsupp_part_2#2755, cpfk_supplier_partsupp#2745 AS cpfk_supplier_partsupp_2#2756, cfpk_partsupp_supplier#2746 AS cfpk_partsupp_supplier_2#2757, cval_partsupp_ps_availqty#2747 AS cval_partsupp_ps_availqty_2#2758, cval_partsupp_ps_supplycost#2748 AS cval_partsupp_ps_supplycost_2#2759, cval_partsupp_ps_comment#2749 AS cval_partsupp_ps_comment_2#2760, cps_availqty#2750 AS cps_availqty_2#2761, cps_supplycost#2751 AS cps_supplycost_2#2762, cps_comment#2752 AS cps_comment_2#2763]
         :     +- Relation[rid#2742,cpfk_part_partsupp#2743,cfpk_partsupp_part#2744,cpfk_supplier_partsupp#2745,cfpk_partsupp_supplier#2746,cval_partsupp_ps_availqty#2747,cval_partsupp_ps_supplycost#2748,cval_partsupp_ps_comment#2749,cps_availqty#2750,cps_supplycost#2751,cps_comment#2752] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#2694 AS rid_2#2705, cpfk_part_partsupp#2695 AS cpfk_part_partsupp_2#2706, cfpk_partsupp_part#2696 AS cfpk_partsupp_part_2#2707, cpfk_supplier_partsupp#2697 AS cpfk_supplier_partsupp_2#2708, cfpk_partsupp_supplier#2698 AS cfpk_partsupp_supplier_2#2709, cval_partsupp_ps_availqty#2699 AS cval_partsupp_ps_availqty_2#2710, cval_partsupp_ps_supplycost#2700 AS cval_partsupp_ps_supplycost_2#2711, cval_partsupp_ps_comment#2701 AS cval_partsupp_ps_comment_2#2712, cps_availqty#2702 AS cps_availqty_2#2713, cps_supplycost#2703 AS cps_supplycost_2#2714, cps_comment#2704 AS cps_comment_2#2715]
            +- Relation[rid#2694,cpfk_part_partsupp#2695,cfpk_partsupp_part#2696,cpfk_supplier_partsupp#2697,cfpk_partsupp_supplier#2698,cval_partsupp_ps_availqty#2699,cval_partsupp_ps_supplycost#2700,cval_partsupp_ps_comment#2701,cps_availqty#2702,cps_supplycost#2703,cps_comment#2704] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=4
Elapsed time: 1305ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/15 16:37:24 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:37:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2801L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:37:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2801L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#2803 AS rid_0#2820, cval_part_p_name#2804 AS cval_part_p_name_0#2821, cval_part_p_mfgr#2805 AS cval_part_p_mfgr_0#2822, cval_part_p_type#2806 AS cval_part_p_type_0#2823, cval_part_p_size#2807 AS cval_part_p_size_0#2824, cval_part_p_container#2808 AS cval_part_p_container_0#2825, cval_part_p_retailprice#2809 AS cval_part_p_retailprice_0#2826, cval_part_p_comment#2810 AS cval_part_p_comment_0#2827, cval_part_p_brand#2811 AS cval_part_p_brand_0#2828, cp_name#2812 AS cp_name_0#2829, cp_mfgr#2813 AS cp_mfgr_0#2830, cp_type#2814 AS cp_type_0#2831, cp_size#2815 AS cp_size_0#2832, cp_container#2816 AS cp_container_0#2833, cp_retailprice#2817 AS cp_retailprice_0#2834, cp_comment#2818 AS cp_comment_0#2835, cp_brand#2819 AS cp_brand_0#2836]
         :  :  +- Relation[rid#2803,cval_part_p_name#2804,cval_part_p_mfgr#2805,cval_part_p_type#2806,cval_part_p_size#2807,cval_part_p_container#2808,cval_part_p_retailprice#2809,cval_part_p_comment#2810,cval_part_p_brand#2811,cp_name#2812,cp_mfgr#2813,cp_type#2814,cp_size#2815,cp_container#2816,cp_retailprice#2817,cp_comment#2818,cp_brand#2819] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#2903 AS rid_0#2920, cval_part_p_name#2904 AS cval_part_p_name_0#2921, cval_part_p_mfgr#2905 AS cval_part_p_mfgr_0#2922, cval_part_p_type#2906 AS cval_part_p_type_0#2923, cval_part_p_size#2907 AS cval_part_p_size_0#2924, cval_part_p_container#2908 AS cval_part_p_container_0#2925, cval_part_p_retailprice#2909 AS cval_part_p_retailprice_0#2926, cval_part_p_comment#2910 AS cval_part_p_comment_0#2927, cval_part_p_brand#2911 AS cval_part_p_brand_0#2928, cp_name#2912 AS cp_name_0#2929, cp_mfgr#2913 AS cp_mfgr_0#2930, cp_type#2914 AS cp_type_0#2931, cp_size#2915 AS cp_size_0#2932, cp_container#2916 AS cp_container_0#2933, cp_retailprice#2917 AS cp_retailprice_0#2934, cp_comment#2918 AS cp_comment_0#2935, cp_brand#2919 AS cp_brand_0#2936]
         :     :  +- Relation[rid#2903,cval_part_p_name#2904,cval_part_p_mfgr#2905,cval_part_p_type#2906,cval_part_p_size#2907,cval_part_p_container#2908,cval_part_p_retailprice#2909,cval_part_p_comment#2910,cval_part_p_brand#2911,cp_name#2912,cp_mfgr#2913,cp_type#2914,cp_size#2915,cp_container#2916,cp_retailprice#2917,cp_comment#2918,cp_brand#2919] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#2937 AS rid_1#2970, cpfk_orders_lineitem#2938 AS cpfk_orders_lineitem_1#2971, cpfk_supplier_lineitem#2939 AS cpfk_supplier_lineitem_1#2972, cfpk_lineitem_supplier#2940 AS cfpk_lineitem_supplier_1#2973, cfpk_lineitem_partsupp#2941 AS cfpk_lineitem_partsupp_1#2974, cpfk_part_lineitem#2942 AS cpfk_part_lineitem_1#2975, cfpk_lineitem_part#2943 AS cfpk_lineitem_part_1#2976, cpfk_partsupp_lineitem#2944 AS cpfk_partsupp_lineitem_1#2977, cfpk_lineitem_orders#2945 AS cfpk_lineitem_orders_1#2978, cval_lineitem_l_quantity#2946 AS cval_lineitem_l_quantity_1#2979, cval_lineitem_l_extendedprice#2947 AS cval_lineitem_l_extendedprice_1#2980, cval_lineitem_l_discount#2948 AS cval_lineitem_l_discount_1#2981, cval_lineitem_l_tax#2949 AS cval_lineitem_l_tax_1#2982, cval_lineitem_l_returnflag#2950 AS cval_lineitem_l_returnflag_1#2983, cval_lineitem_l_linestatus#2951 AS cval_lineitem_l_linestatus_1#2984, cval_lineitem_l_commitdate#2952 AS cval_lineitem_l_commitdate_1#2985, cval_lineitem_l_receiptdate#2953 AS cval_lineitem_l_receiptdate_1#2986, cval_lineitem_l_shipinstruct#2954 AS cval_lineitem_l_shipinstruct_1#2987, cval_lineitem_l_shipmode#2955 AS cval_lineitem_l_shipmode_1#2988, cval_lineitem_l_comment#2956 AS cval_lineitem_l_comment_1#2989, cval_lineitem_l_shipdate#2957 AS cval_lineitem_l_shipdate_1#2990, cl_quantity#2958 AS cl_quantity_1#2991, cl_extendedprice#2959 AS cl_extendedprice_1#2992, cl_discount#2960 AS cl_discount_1#2993, ... 9 more fields]
         :        +- Relation[rid#2937,cpfk_orders_lineitem#2938,cpfk_supplier_lineitem#2939,cfpk_lineitem_supplier#2940,cfpk_lineitem_partsupp#2941,cpfk_part_lineitem#2942,cfpk_lineitem_part#2943,cpfk_partsupp_lineitem#2944,cfpk_lineitem_orders#2945,cval_lineitem_l_quantity#2946,cval_lineitem_l_extendedprice#2947,cval_lineitem_l_discount#2948,cval_lineitem_l_tax#2949,cval_lineitem_l_returnflag#2950,cval_lineitem_l_linestatus#2951,cval_lineitem_l_commitdate#2952,cval_lineitem_l_receiptdate#2953,cval_lineitem_l_shipinstruct#2954,cval_lineitem_l_shipmode#2955,cval_lineitem_l_comment#2956,cval_lineitem_l_shipdate#2957,cl_quantity#2958,cl_extendedprice#2959,cl_discount#2960,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2837 AS rid_1#2870, cpfk_orders_lineitem#2838 AS cpfk_orders_lineitem_1#2871, cpfk_supplier_lineitem#2839 AS cpfk_supplier_lineitem_1#2872, cfpk_lineitem_supplier#2840 AS cfpk_lineitem_supplier_1#2873, cfpk_lineitem_partsupp#2841 AS cfpk_lineitem_partsupp_1#2874, cpfk_part_lineitem#2842 AS cpfk_part_lineitem_1#2875, cfpk_lineitem_part#2843 AS cfpk_lineitem_part_1#2876, cpfk_partsupp_lineitem#2844 AS cpfk_partsupp_lineitem_1#2877, cfpk_lineitem_orders#2845 AS cfpk_lineitem_orders_1#2878, cval_lineitem_l_quantity#2846 AS cval_lineitem_l_quantity_1#2879, cval_lineitem_l_extendedprice#2847 AS cval_lineitem_l_extendedprice_1#2880, cval_lineitem_l_discount#2848 AS cval_lineitem_l_discount_1#2881, cval_lineitem_l_tax#2849 AS cval_lineitem_l_tax_1#2882, cval_lineitem_l_returnflag#2850 AS cval_lineitem_l_returnflag_1#2883, cval_lineitem_l_linestatus#2851 AS cval_lineitem_l_linestatus_1#2884, cval_lineitem_l_commitdate#2852 AS cval_lineitem_l_commitdate_1#2885, cval_lineitem_l_receiptdate#2853 AS cval_lineitem_l_receiptdate_1#2886, cval_lineitem_l_shipinstruct#2854 AS cval_lineitem_l_shipinstruct_1#2887, cval_lineitem_l_shipmode#2855 AS cval_lineitem_l_shipmode_1#2888, cval_lineitem_l_comment#2856 AS cval_lineitem_l_comment_1#2889, cval_lineitem_l_shipdate#2857 AS cval_lineitem_l_shipdate_1#2890, cl_quantity#2858 AS cl_quantity_1#2891, cl_extendedprice#2859 AS cl_extendedprice_1#2892, cl_discount#2860 AS cl_discount_1#2893, ... 9 more fields]
            +- Relation[rid#2837,cpfk_orders_lineitem#2838,cpfk_supplier_lineitem#2839,cfpk_lineitem_supplier#2840,cfpk_lineitem_partsupp#2841,cpfk_part_lineitem#2842,cfpk_lineitem_part#2843,cpfk_partsupp_lineitem#2844,cfpk_lineitem_orders#2845,cval_lineitem_l_quantity#2846,cval_lineitem_l_extendedprice#2847,cval_lineitem_l_discount#2848,cval_lineitem_l_tax#2849,cval_lineitem_l_returnflag#2850,cval_lineitem_l_linestatus#2851,cval_lineitem_l_commitdate#2852,cval_lineitem_l_receiptdate#2853,cval_lineitem_l_shipinstruct#2854,cval_lineitem_l_shipmode#2855,cval_lineitem_l_comment#2856,cval_lineitem_l_shipdate#2857,cl_quantity#2858,cl_extendedprice#2859,cl_discount#2860,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 91096ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/15 16:38:55 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:38:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3058L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:38:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#3058L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#3060 AS rid_0#3093, cpfk_orders_lineitem#3061 AS cpfk_orders_lineitem_0#3094, cpfk_supplier_lineitem#3062 AS cpfk_supplier_lineitem_0#3095, cfpk_lineitem_supplier#3063 AS cfpk_lineitem_supplier_0#3096, cfpk_lineitem_partsupp#3064 AS cfpk_lineitem_partsupp_0#3097, cpfk_part_lineitem#3065 AS cpfk_part_lineitem_0#3098, cfpk_lineitem_part#3066 AS cfpk_lineitem_part_0#3099, cpfk_partsupp_lineitem#3067 AS cpfk_partsupp_lineitem_0#3100, cfpk_lineitem_orders#3068 AS cfpk_lineitem_orders_0#3101, cval_lineitem_l_quantity#3069 AS cval_lineitem_l_quantity_0#3102, cval_lineitem_l_extendedprice#3070 AS cval_lineitem_l_extendedprice_0#3103, cval_lineitem_l_discount#3071 AS cval_lineitem_l_discount_0#3104, cval_lineitem_l_tax#3072 AS cval_lineitem_l_tax_0#3105, cval_lineitem_l_returnflag#3073 AS cval_lineitem_l_returnflag_0#3106, cval_lineitem_l_linestatus#3074 AS cval_lineitem_l_linestatus_0#3107, cval_lineitem_l_commitdate#3075 AS cval_lineitem_l_commitdate_0#3108, cval_lineitem_l_receiptdate#3076 AS cval_lineitem_l_receiptdate_0#3109, cval_lineitem_l_shipinstruct#3077 AS cval_lineitem_l_shipinstruct_0#3110, cval_lineitem_l_shipmode#3078 AS cval_lineitem_l_shipmode_0#3111, cval_lineitem_l_comment#3079 AS cval_lineitem_l_comment_0#3112, cval_lineitem_l_shipdate#3080 AS cval_lineitem_l_shipdate_0#3113, cl_quantity#3081 AS cl_quantity_0#3114, cl_extendedprice#3082 AS cl_extendedprice_0#3115, cl_discount#3083 AS cl_discount_0#3116, ... 9 more fields]
         +- Relation[rid#3060,cpfk_orders_lineitem#3061,cpfk_supplier_lineitem#3062,cfpk_lineitem_supplier#3063,cfpk_lineitem_partsupp#3064,cpfk_part_lineitem#3065,cfpk_lineitem_part#3066,cpfk_partsupp_lineitem#3067,cfpk_lineitem_orders#3068,cval_lineitem_l_quantity#3069,cval_lineitem_l_extendedprice#3070,cval_lineitem_l_discount#3071,cval_lineitem_l_tax#3072,cval_lineitem_l_returnflag#3073,cval_lineitem_l_linestatus#3074,cval_lineitem_l_commitdate#3075,cval_lineitem_l_receiptdate#3076,cval_lineitem_l_shipinstruct#3077,cval_lineitem_l_shipmode#3078,cval_lineitem_l_comment#3079,cval_lineitem_l_shipdate#3080,cl_quantity#3081,cl_extendedprice#3082,cl_discount#3083,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2904ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/15 16:38:58 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:38:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3164L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 16:38:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3164L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#3166 AS rid_0#3183, cpfk_customer_orders#3167 AS cpfk_customer_orders_0#3184, cfpk_orders_customer#3168 AS cfpk_orders_customer_0#3185, cval_orders_o_orderstatus#3169 AS cval_orders_o_orderstatus_0#3186, cval_orders_o_totalprice#3170 AS cval_orders_o_totalprice_0#3187, cval_orders_o_orderpriority#3171 AS cval_orders_o_orderpriority_0#3188, cval_orders_o_clerk#3172 AS cval_orders_o_clerk_0#3189, cval_orders_o_shippriority#3173 AS cval_orders_o_shippriority_0#3190, cval_orders_o_comment#3174 AS cval_orders_o_comment_0#3191, cval_orders_o_orderdate#3175 AS cval_orders_o_orderdate_0#3192, co_orderstatus#3176 AS co_orderstatus_0#3193, co_totalprice#3177 AS co_totalprice_0#3194, co_orderpriority#3178 AS co_orderpriority_0#3195, co_clerk#3179 AS co_clerk_0#3196, co_shippriority#3180 AS co_shippriority_0#3197, co_comment#3181 AS co_comment_0#3198, co_orderdate#3182 AS co_orderdate_0#3199]
            :  +- Relation[rid#3166,cpfk_customer_orders#3167,cfpk_orders_customer#3168,cval_orders_o_orderstatus#3169,cval_orders_o_totalprice#3170,cval_orders_o_orderpriority#3171,cval_orders_o_clerk#3172,cval_orders_o_shippriority#3173,cval_orders_o_comment#3174,cval_orders_o_orderdate#3175,co_orderstatus#3176,co_totalprice#3177,co_orderpriority#3178,co_clerk#3179,co_shippriority#3180,co_comment#3181,co_orderdate#3182] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#3200 AS rid_1#3215, cpfk_nation_customer#3201 AS cpfk_nation_customer_1#3216, cfpk_customer_nation#3202 AS cfpk_customer_nation_1#3217, cval_customer_c_name#3203 AS cval_customer_c_name_1#3218, cval_customer_c_address#3204 AS cval_customer_c_address_1#3219, cval_customer_c_phone#3205 AS cval_customer_c_phone_1#3220, cval_customer_c_acctbal#3206 AS cval_customer_c_acctbal_1#3221, cval_customer_c_comment#3207 AS cval_customer_c_comment_1#3222, cval_customer_c_mktsegment#3208 AS cval_customer_c_mktsegment_1#3223, cc_name#3209 AS cc_name_1#3224, cc_address#3210 AS cc_address_1#3225, cc_phone#3211 AS cc_phone_1#3226, cc_acctbal#3212 AS cc_acctbal_1#3227, cc_comment#3213 AS cc_comment_1#3228, cc_mktsegment#3214 AS cc_mktsegment_1#3229]
               +- Relation[rid#3200,cpfk_nation_customer#3201,cfpk_customer_nation#3202,cval_customer_c_name#3203,cval_customer_c_address#3204,cval_customer_c_phone#3205,cval_customer_c_acctbal#3206,cval_customer_c_comment#3207,cval_customer_c_mktsegment#3208,cc_name#3209,cc_address#3210,cc_phone#3211,cc_acctbal#3212,cc_comment#3213,cc_mktsegment#3214] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13997ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 16:39:12 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:39:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3271L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:39:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:39:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:39:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:39:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:39:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:39:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:39:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:39:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:39:12 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:39:12 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:39:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3271L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#3273 AS rid_0#3280, cpfk_region_nation#3274 AS cpfk_region_nation_0#3281, cfpk_nation_region#3275 AS cfpk_nation_region_0#3282, cval_nation_n_name#3276 AS cval_nation_n_name_0#3283, cval_nation_n_comment#3277 AS cval_nation_n_comment_0#3284, cn_name#3278 AS cn_name_0#3285, cn_comment#3279 AS cn_comment_0#3286]
            :     :     :  :  :  :  :  +- Relation[rid#3273,cpfk_region_nation#3274,cfpk_nation_region#3275,cval_nation_n_name#3276,cval_nation_n_comment#3277,cn_name#3278,cn_comment#3279] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#3313 AS rid_0#3320, cpfk_region_nation#3314 AS cpfk_region_nation_0#3321, cfpk_nation_region#3315 AS cfpk_nation_region_0#3322, cval_nation_n_name#3316 AS cval_nation_n_name_0#3323, cval_nation_n_comment#3317 AS cval_nation_n_comment_0#3324, cn_name#3318 AS cn_name_0#3325, cn_comment#3319 AS cn_comment_0#3326]
            :     :     :  :  :  :     :  +- Relation[rid#3313,cpfk_region_nation#3314,cfpk_nation_region#3315,cval_nation_n_name#3316,cval_nation_n_comment#3317,cn_name#3318,cn_comment#3319] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#3327 AS rid_1#3340, cpfk_nation_supplier#3328 AS cpfk_nation_supplier_1#3341, cfpk_supplier_nation#3329 AS cfpk_supplier_nation_1#3342, cval_supplier_s_name#3330 AS cval_supplier_s_name_1#3343, cval_supplier_s_address#3331 AS cval_supplier_s_address_1#3344, cval_supplier_s_phone#3332 AS cval_supplier_s_phone_1#3345, cval_supplier_s_acctbal#3333 AS cval_supplier_s_acctbal_1#3346, cval_supplier_s_comment#3334 AS cval_supplier_s_comment_1#3347, cs_name#3335 AS cs_name_1#3348, cs_address#3336 AS cs_address_1#3349, cs_phone#3337 AS cs_phone_1#3350, cs_acctbal#3338 AS cs_acctbal_1#3351, cs_comment#3339 AS cs_comment_1#3352]
            :     :     :  :  :  :        +- Relation[rid#3327,cpfk_nation_supplier#3328,cfpk_supplier_nation#3329,cval_supplier_s_name#3330,cval_supplier_s_address#3331,cval_supplier_s_phone#3332,cval_supplier_s_acctbal#3333,cval_supplier_s_comment#3334,cs_name#3335,cs_address#3336,cs_phone#3337,cs_acctbal#3338,cs_comment#3339] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#3287 AS rid_1#3300, cpfk_nation_supplier#3288 AS cpfk_nation_supplier_1#3301, cfpk_supplier_nation#3289 AS cfpk_supplier_nation_1#3302, cval_supplier_s_name#3290 AS cval_supplier_s_name_1#3303, cval_supplier_s_address#3291 AS cval_supplier_s_address_1#3304, cval_supplier_s_phone#3292 AS cval_supplier_s_phone_1#3305, cval_supplier_s_acctbal#3293 AS cval_supplier_s_acctbal_1#3306, cval_supplier_s_comment#3294 AS cval_supplier_s_comment_1#3307, cs_name#3295 AS cs_name_1#3308, cs_address#3296 AS cs_address_1#3309, cs_phone#3297 AS cs_phone_1#3310, cs_acctbal#3298 AS cs_acctbal_1#3311, cs_comment#3299 AS cs_comment_1#3312]
            :     :     :  :  :     +- Relation[rid#3287,cpfk_nation_supplier#3288,cfpk_supplier_nation#3289,cval_supplier_s_name#3290,cval_supplier_s_address#3291,cval_supplier_s_phone#3292,cval_supplier_s_acctbal#3293,cval_supplier_s_comment#3294,cs_name#3295,cs_address#3296,cs_phone#3297,cs_acctbal#3298,cs_comment#3299] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#3419 AS rid_1#3432, cpfk_nation_supplier#3420 AS cpfk_nation_supplier_1#3433, cfpk_supplier_nation#3421 AS cfpk_supplier_nation_1#3434, cval_supplier_s_name#3422 AS cval_supplier_s_name_1#3435, cval_supplier_s_address#3423 AS cval_supplier_s_address_1#3436, cval_supplier_s_phone#3424 AS cval_supplier_s_phone_1#3437, cval_supplier_s_acctbal#3425 AS cval_supplier_s_acctbal_1#3438, cval_supplier_s_comment#3426 AS cval_supplier_s_comment_1#3439, cs_name#3427 AS cs_name_1#3440, cs_address#3428 AS cs_address_1#3441, cs_phone#3429 AS cs_phone_1#3442, cs_acctbal#3430 AS cs_acctbal_1#3443, cs_comment#3431 AS cs_comment_1#3444]
            :     :     :  :     :  +- Relation[rid#3419,cpfk_nation_supplier#3420,cfpk_supplier_nation#3421,cval_supplier_s_name#3422,cval_supplier_s_address#3423,cval_supplier_s_phone#3424,cval_supplier_s_acctbal#3425,cval_supplier_s_comment#3426,cs_name#3427,cs_address#3428,cs_phone#3429,cs_acctbal#3430,cs_comment#3431] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#3445 AS rid_2#3478, cpfk_orders_lineitem#3446 AS cpfk_orders_lineitem_2#3479, cpfk_supplier_lineitem#3447 AS cpfk_supplier_lineitem_2#3480, cfpk_lineitem_supplier#3448 AS cfpk_lineitem_supplier_2#3481, cfpk_lineitem_partsupp#3449 AS cfpk_lineitem_partsupp_2#3482, cpfk_part_lineitem#3450 AS cpfk_part_lineitem_2#3483, cfpk_lineitem_part#3451 AS cfpk_lineitem_part_2#3484, cpfk_partsupp_lineitem#3452 AS cpfk_partsupp_lineitem_2#3485, cfpk_lineitem_orders#3453 AS cfpk_lineitem_orders_2#3486, cval_lineitem_l_quantity#3454 AS cval_lineitem_l_quantity_2#3487, cval_lineitem_l_extendedprice#3455 AS cval_lineitem_l_extendedprice_2#3488, cval_lineitem_l_discount#3456 AS cval_lineitem_l_discount_2#3489, cval_lineitem_l_tax#3457 AS cval_lineitem_l_tax_2#3490, cval_lineitem_l_returnflag#3458 AS cval_lineitem_l_returnflag_2#3491, cval_lineitem_l_linestatus#3459 AS cval_lineitem_l_linestatus_2#3492, cval_lineitem_l_commitdate#3460 AS cval_lineitem_l_commitdate_2#3493, cval_lineitem_l_receiptdate#3461 AS cval_lineitem_l_receiptdate_2#3494, cval_lineitem_l_shipinstruct#3462 AS cval_lineitem_l_shipinstruct_2#3495, cval_lineitem_l_shipmode#3463 AS cval_lineitem_l_shipmode_2#3496, cval_lineitem_l_comment#3464 AS cval_lineitem_l_comment_2#3497, cval_lineitem_l_shipdate#3465 AS cval_lineitem_l_shipdate_2#3498, cl_quantity#3466 AS cl_quantity_2#3499, cl_extendedprice#3467 AS cl_extendedprice_2#3500, cl_discount#3468 AS cl_discount_2#3501, ... 9 more fields]
            :     :     :  :        +- Relation[rid#3445,cpfk_orders_lineitem#3446,cpfk_supplier_lineitem#3447,cfpk_lineitem_supplier#3448,cfpk_lineitem_partsupp#3449,cpfk_part_lineitem#3450,cfpk_lineitem_part#3451,cpfk_partsupp_lineitem#3452,cfpk_lineitem_orders#3453,cval_lineitem_l_quantity#3454,cval_lineitem_l_extendedprice#3455,cval_lineitem_l_discount#3456,cval_lineitem_l_tax#3457,cval_lineitem_l_returnflag#3458,cval_lineitem_l_linestatus#3459,cval_lineitem_l_commitdate#3460,cval_lineitem_l_receiptdate#3461,cval_lineitem_l_shipinstruct#3462,cval_lineitem_l_shipmode#3463,cval_lineitem_l_comment#3464,cval_lineitem_l_shipdate#3465,cl_quantity#3466,cl_extendedprice#3467,cl_discount#3468,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#3353 AS rid_2#3386, cpfk_orders_lineitem#3354 AS cpfk_orders_lineitem_2#3387, cpfk_supplier_lineitem#3355 AS cpfk_supplier_lineitem_2#3388, cfpk_lineitem_supplier#3356 AS cfpk_lineitem_supplier_2#3389, cfpk_lineitem_partsupp#3357 AS cfpk_lineitem_partsupp_2#3390, cpfk_part_lineitem#3358 AS cpfk_part_lineitem_2#3391, cfpk_lineitem_part#3359 AS cfpk_lineitem_part_2#3392, cpfk_partsupp_lineitem#3360 AS cpfk_partsupp_lineitem_2#3393, cfpk_lineitem_orders#3361 AS cfpk_lineitem_orders_2#3394, cval_lineitem_l_quantity#3362 AS cval_lineitem_l_quantity_2#3395, cval_lineitem_l_extendedprice#3363 AS cval_lineitem_l_extendedprice_2#3396, cval_lineitem_l_discount#3364 AS cval_lineitem_l_discount_2#3397, cval_lineitem_l_tax#3365 AS cval_lineitem_l_tax_2#3398, cval_lineitem_l_returnflag#3366 AS cval_lineitem_l_returnflag_2#3399, cval_lineitem_l_linestatus#3367 AS cval_lineitem_l_linestatus_2#3400, cval_lineitem_l_commitdate#3368 AS cval_lineitem_l_commitdate_2#3401, cval_lineitem_l_receiptdate#3369 AS cval_lineitem_l_receiptdate_2#3402, cval_lineitem_l_shipinstruct#3370 AS cval_lineitem_l_shipinstruct_2#3403, cval_lineitem_l_shipmode#3371 AS cval_lineitem_l_shipmode_2#3404, cval_lineitem_l_comment#3372 AS cval_lineitem_l_comment_2#3405, cval_lineitem_l_shipdate#3373 AS cval_lineitem_l_shipdate_2#3406, cl_quantity#3374 AS cl_quantity_2#3407, cl_extendedprice#3375 AS cl_extendedprice_2#3408, cl_discount#3376 AS cl_discount_2#3409, ... 9 more fields]
            :     :     :     +- Relation[rid#3353,cpfk_orders_lineitem#3354,cpfk_supplier_lineitem#3355,cfpk_lineitem_supplier#3356,cfpk_lineitem_partsupp#3357,cpfk_part_lineitem#3358,cfpk_lineitem_part#3359,cpfk_partsupp_lineitem#3360,cfpk_lineitem_orders#3361,cval_lineitem_l_quantity#3362,cval_lineitem_l_extendedprice#3363,cval_lineitem_l_discount#3364,cval_lineitem_l_tax#3365,cval_lineitem_l_returnflag#3366,cval_lineitem_l_linestatus#3367,cval_lineitem_l_commitdate#3368,cval_lineitem_l_receiptdate#3369,cval_lineitem_l_shipinstruct#3370,cval_lineitem_l_shipmode#3371,cval_lineitem_l_comment#3372,cval_lineitem_l_shipdate#3373,cl_quantity#3374,cl_extendedprice#3375,cl_discount#3376,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#3511 AS rid_3#3528, cval_part_p_name#3512 AS cval_part_p_name_3#3529, cval_part_p_mfgr#3513 AS cval_part_p_mfgr_3#3530, cval_part_p_type#3514 AS cval_part_p_type_3#3531, cval_part_p_size#3515 AS cval_part_p_size_3#3532, cval_part_p_container#3516 AS cval_part_p_container_3#3533, cval_part_p_retailprice#3517 AS cval_part_p_retailprice_3#3534, cval_part_p_comment#3518 AS cval_part_p_comment_3#3535, cval_part_p_brand#3519 AS cval_part_p_brand_3#3536, cp_name#3520 AS cp_name_3#3537, cp_mfgr#3521 AS cp_mfgr_3#3538, cp_type#3522 AS cp_type_3#3539, cp_size#3523 AS cp_size_3#3540, cp_container#3524 AS cp_container_3#3541, cp_retailprice#3525 AS cp_retailprice_3#3542, cp_comment#3526 AS cp_comment_3#3543, cp_brand#3527 AS cp_brand_3#3544]
            :     :        +- Relation[rid#3511,cval_part_p_name#3512,cval_part_p_mfgr#3513,cval_part_p_type#3514,cval_part_p_size#3515,cval_part_p_container#3516,cval_part_p_retailprice#3517,cval_part_p_comment#3518,cval_part_p_brand#3519,cp_name#3520,cp_mfgr#3521,cp_type#3522,cp_size#3523,cp_container#3524,cp_retailprice#3525,cp_comment#3526,cp_brand#3527] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#3545 AS rid_4#3556, cpfk_part_partsupp#3546 AS cpfk_part_partsupp_4#3557, cfpk_partsupp_part#3547 AS cfpk_partsupp_part_4#3558, cpfk_supplier_partsupp#3548 AS cpfk_supplier_partsupp_4#3559, cfpk_partsupp_supplier#3549 AS cfpk_partsupp_supplier_4#3560, cval_partsupp_ps_availqty#3550 AS cval_partsupp_ps_availqty_4#3561, cval_partsupp_ps_supplycost#3551 AS cval_partsupp_ps_supplycost_4#3562, cval_partsupp_ps_comment#3552 AS cval_partsupp_ps_comment_4#3563, cps_availqty#3553 AS cps_availqty_4#3564, cps_supplycost#3554 AS cps_supplycost_4#3565, cps_comment#3555 AS cps_comment_4#3566]
            :        +- Relation[rid#3545,cpfk_part_partsupp#3546,cfpk_partsupp_part#3547,cpfk_supplier_partsupp#3548,cfpk_partsupp_supplier#3549,cval_partsupp_ps_availqty#3550,cval_partsupp_ps_supplycost#3551,cval_partsupp_ps_comment#3552,cps_availqty#3553,cps_supplycost#3554,cps_comment#3555] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#3567 AS rid_5#3584, cpfk_customer_orders#3568 AS cpfk_customer_orders_5#3585, cfpk_orders_customer#3569 AS cfpk_orders_customer_5#3586, cval_orders_o_orderstatus#3570 AS cval_orders_o_orderstatus_5#3587, cval_orders_o_totalprice#3571 AS cval_orders_o_totalprice_5#3588, cval_orders_o_orderpriority#3572 AS cval_orders_o_orderpriority_5#3589, cval_orders_o_clerk#3573 AS cval_orders_o_clerk_5#3590, cval_orders_o_shippriority#3574 AS cval_orders_o_shippriority_5#3591, cval_orders_o_comment#3575 AS cval_orders_o_comment_5#3592, cval_orders_o_orderdate#3576 AS cval_orders_o_orderdate_5#3593, co_orderstatus#3577 AS co_orderstatus_5#3594, co_totalprice#3578 AS co_totalprice_5#3595, co_orderpriority#3579 AS co_orderpriority_5#3596, co_clerk#3580 AS co_clerk_5#3597, co_shippriority#3581 AS co_shippriority_5#3598, co_comment#3582 AS co_comment_5#3599, co_orderdate#3583 AS co_orderdate_5#3600]
               +- Relation[rid#3567,cpfk_customer_orders#3568,cfpk_orders_customer#3569,cval_orders_o_orderstatus#3570,cval_orders_o_totalprice#3571,cval_orders_o_orderpriority#3572,cval_orders_o_clerk#3573,cval_orders_o_shippriority#3574,cval_orders_o_comment#3575,cval_orders_o_orderdate#3576,co_orderstatus#3577,co_totalprice#3578,co_orderpriority#3579,co_clerk#3580,co_shippriority#3581,co_comment#3582,co_orderdate#3583] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 278744ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/15 16:43:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:43:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3703L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 16:43:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3703L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#3705 AS rid_0#3722, cpfk_customer_orders#3706 AS cpfk_customer_orders_0#3723, cfpk_orders_customer#3707 AS cfpk_orders_customer_0#3724, cval_orders_o_orderstatus#3708 AS cval_orders_o_orderstatus_0#3725, cval_orders_o_totalprice#3709 AS cval_orders_o_totalprice_0#3726, cval_orders_o_orderpriority#3710 AS cval_orders_o_orderpriority_0#3727, cval_orders_o_clerk#3711 AS cval_orders_o_clerk_0#3728, cval_orders_o_shippriority#3712 AS cval_orders_o_shippriority_0#3729, cval_orders_o_comment#3713 AS cval_orders_o_comment_0#3730, cval_orders_o_orderdate#3714 AS cval_orders_o_orderdate_0#3731, co_orderstatus#3715 AS co_orderstatus_0#3732, co_totalprice#3716 AS co_totalprice_0#3733, co_orderpriority#3717 AS co_orderpriority_0#3734, co_clerk#3718 AS co_clerk_0#3735, co_shippriority#3719 AS co_shippriority_0#3736, co_comment#3720 AS co_comment_0#3737, co_orderdate#3721 AS co_orderdate_0#3738]
            :  +- Relation[rid#3705,cpfk_customer_orders#3706,cfpk_orders_customer#3707,cval_orders_o_orderstatus#3708,cval_orders_o_totalprice#3709,cval_orders_o_orderpriority#3710,cval_orders_o_clerk#3711,cval_orders_o_shippriority#3712,cval_orders_o_comment#3713,cval_orders_o_orderdate#3714,co_orderstatus#3715,co_totalprice#3716,co_orderpriority#3717,co_clerk#3718,co_shippriority#3719,co_comment#3720,co_orderdate#3721] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#3739 AS rid_1#3754, cpfk_nation_customer#3740 AS cpfk_nation_customer_1#3755, cfpk_customer_nation#3741 AS cfpk_customer_nation_1#3756, cval_customer_c_name#3742 AS cval_customer_c_name_1#3757, cval_customer_c_address#3743 AS cval_customer_c_address_1#3758, cval_customer_c_phone#3744 AS cval_customer_c_phone_1#3759, cval_customer_c_acctbal#3745 AS cval_customer_c_acctbal_1#3760, cval_customer_c_comment#3746 AS cval_customer_c_comment_1#3761, cval_customer_c_mktsegment#3747 AS cval_customer_c_mktsegment_1#3762, cc_name#3748 AS cc_name_1#3763, cc_address#3749 AS cc_address_1#3764, cc_phone#3750 AS cc_phone_1#3765, cc_acctbal#3751 AS cc_acctbal_1#3766, cc_comment#3752 AS cc_comment_1#3767, cc_mktsegment#3753 AS cc_mktsegment_1#3768]
               +- Relation[rid#3739,cpfk_nation_customer#3740,cfpk_customer_nation#3741,cval_customer_c_name#3742,cval_customer_c_address#3743,cval_customer_c_phone#3744,cval_customer_c_acctbal#3745,cval_customer_c_comment#3746,cval_customer_c_mktsegment#3747,cc_name#3748,cc_address#3749,cc_phone#3750,cc_acctbal#3751,cc_comment#3752,cc_mktsegment#3753] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13945ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/15 16:44:05 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:44:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3808L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:44:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:44:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:44:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:44:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3808L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#3810 AS rid_0#3823, cpfk_nation_supplier#3811 AS cpfk_nation_supplier_0#3824, cfpk_supplier_nation#3812 AS cfpk_supplier_nation_0#3825, cval_supplier_s_name#3813 AS cval_supplier_s_name_0#3826, cval_supplier_s_address#3814 AS cval_supplier_s_address_0#3827, cval_supplier_s_phone#3815 AS cval_supplier_s_phone_0#3828, cval_supplier_s_acctbal#3816 AS cval_supplier_s_acctbal_0#3829, cval_supplier_s_comment#3817 AS cval_supplier_s_comment_0#3830, cs_name#3818 AS cs_name_0#3831, cs_address#3819 AS cs_address_0#3832, cs_phone#3820 AS cs_phone_0#3833, cs_acctbal#3821 AS cs_acctbal_0#3834, cs_comment#3822 AS cs_comment_0#3835]
         :  :  +- Relation[rid#3810,cpfk_nation_supplier#3811,cfpk_supplier_nation#3812,cval_supplier_s_name#3813,cval_supplier_s_address#3814,cval_supplier_s_phone#3815,cval_supplier_s_acctbal#3816,cval_supplier_s_comment#3817,cs_name#3818,cs_address#3819,cs_phone#3820,cs_acctbal#3821,cs_comment#3822] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#3902 AS rid_0#3915, cpfk_nation_supplier#3903 AS cpfk_nation_supplier_0#3916, cfpk_supplier_nation#3904 AS cfpk_supplier_nation_0#3917, cval_supplier_s_name#3905 AS cval_supplier_s_name_0#3918, cval_supplier_s_address#3906 AS cval_supplier_s_address_0#3919, cval_supplier_s_phone#3907 AS cval_supplier_s_phone_0#3920, cval_supplier_s_acctbal#3908 AS cval_supplier_s_acctbal_0#3921, cval_supplier_s_comment#3909 AS cval_supplier_s_comment_0#3922, cs_name#3910 AS cs_name_0#3923, cs_address#3911 AS cs_address_0#3924, cs_phone#3912 AS cs_phone_0#3925, cs_acctbal#3913 AS cs_acctbal_0#3926, cs_comment#3914 AS cs_comment_0#3927]
         :     :  +- Relation[rid#3902,cpfk_nation_supplier#3903,cfpk_supplier_nation#3904,cval_supplier_s_name#3905,cval_supplier_s_address#3906,cval_supplier_s_phone#3907,cval_supplier_s_acctbal#3908,cval_supplier_s_comment#3909,cs_name#3910,cs_address#3911,cs_phone#3912,cs_acctbal#3913,cs_comment#3914] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#3928 AS rid_1#3961, cpfk_orders_lineitem#3929 AS cpfk_orders_lineitem_1#3962, cpfk_supplier_lineitem#3930 AS cpfk_supplier_lineitem_1#3963, cfpk_lineitem_supplier#3931 AS cfpk_lineitem_supplier_1#3964, cfpk_lineitem_partsupp#3932 AS cfpk_lineitem_partsupp_1#3965, cpfk_part_lineitem#3933 AS cpfk_part_lineitem_1#3966, cfpk_lineitem_part#3934 AS cfpk_lineitem_part_1#3967, cpfk_partsupp_lineitem#3935 AS cpfk_partsupp_lineitem_1#3968, cfpk_lineitem_orders#3936 AS cfpk_lineitem_orders_1#3969, cval_lineitem_l_quantity#3937 AS cval_lineitem_l_quantity_1#3970, cval_lineitem_l_extendedprice#3938 AS cval_lineitem_l_extendedprice_1#3971, cval_lineitem_l_discount#3939 AS cval_lineitem_l_discount_1#3972, cval_lineitem_l_tax#3940 AS cval_lineitem_l_tax_1#3973, cval_lineitem_l_returnflag#3941 AS cval_lineitem_l_returnflag_1#3974, cval_lineitem_l_linestatus#3942 AS cval_lineitem_l_linestatus_1#3975, cval_lineitem_l_commitdate#3943 AS cval_lineitem_l_commitdate_1#3976, cval_lineitem_l_receiptdate#3944 AS cval_lineitem_l_receiptdate_1#3977, cval_lineitem_l_shipinstruct#3945 AS cval_lineitem_l_shipinstruct_1#3978, cval_lineitem_l_shipmode#3946 AS cval_lineitem_l_shipmode_1#3979, cval_lineitem_l_comment#3947 AS cval_lineitem_l_comment_1#3980, cval_lineitem_l_shipdate#3948 AS cval_lineitem_l_shipdate_1#3981, cl_quantity#3949 AS cl_quantity_1#3982, cl_extendedprice#3950 AS cl_extendedprice_1#3983, cl_discount#3951 AS cl_discount_1#3984, ... 9 more fields]
         :        +- Relation[rid#3928,cpfk_orders_lineitem#3929,cpfk_supplier_lineitem#3930,cfpk_lineitem_supplier#3931,cfpk_lineitem_partsupp#3932,cpfk_part_lineitem#3933,cfpk_lineitem_part#3934,cpfk_partsupp_lineitem#3935,cfpk_lineitem_orders#3936,cval_lineitem_l_quantity#3937,cval_lineitem_l_extendedprice#3938,cval_lineitem_l_discount#3939,cval_lineitem_l_tax#3940,cval_lineitem_l_returnflag#3941,cval_lineitem_l_linestatus#3942,cval_lineitem_l_commitdate#3943,cval_lineitem_l_receiptdate#3944,cval_lineitem_l_shipinstruct#3945,cval_lineitem_l_shipmode#3946,cval_lineitem_l_comment#3947,cval_lineitem_l_shipdate#3948,cl_quantity#3949,cl_extendedprice#3950,cl_discount#3951,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#3836 AS rid_1#3869, cpfk_orders_lineitem#3837 AS cpfk_orders_lineitem_1#3870, cpfk_supplier_lineitem#3838 AS cpfk_supplier_lineitem_1#3871, cfpk_lineitem_supplier#3839 AS cfpk_lineitem_supplier_1#3872, cfpk_lineitem_partsupp#3840 AS cfpk_lineitem_partsupp_1#3873, cpfk_part_lineitem#3841 AS cpfk_part_lineitem_1#3874, cfpk_lineitem_part#3842 AS cfpk_lineitem_part_1#3875, cpfk_partsupp_lineitem#3843 AS cpfk_partsupp_lineitem_1#3876, cfpk_lineitem_orders#3844 AS cfpk_lineitem_orders_1#3877, cval_lineitem_l_quantity#3845 AS cval_lineitem_l_quantity_1#3878, cval_lineitem_l_extendedprice#3846 AS cval_lineitem_l_extendedprice_1#3879, cval_lineitem_l_discount#3847 AS cval_lineitem_l_discount_1#3880, cval_lineitem_l_tax#3848 AS cval_lineitem_l_tax_1#3881, cval_lineitem_l_returnflag#3849 AS cval_lineitem_l_returnflag_1#3882, cval_lineitem_l_linestatus#3850 AS cval_lineitem_l_linestatus_1#3883, cval_lineitem_l_commitdate#3851 AS cval_lineitem_l_commitdate_1#3884, cval_lineitem_l_receiptdate#3852 AS cval_lineitem_l_receiptdate_1#3885, cval_lineitem_l_shipinstruct#3853 AS cval_lineitem_l_shipinstruct_1#3886, cval_lineitem_l_shipmode#3854 AS cval_lineitem_l_shipmode_1#3887, cval_lineitem_l_comment#3855 AS cval_lineitem_l_comment_1#3888, cval_lineitem_l_shipdate#3856 AS cval_lineitem_l_shipdate_1#3889, cl_quantity#3857 AS cl_quantity_1#3890, cl_extendedprice#3858 AS cl_extendedprice_1#3891, cl_discount#3859 AS cl_discount_1#3892, ... 9 more fields]
            +- Relation[rid#3836,cpfk_orders_lineitem#3837,cpfk_supplier_lineitem#3838,cfpk_lineitem_supplier#3839,cfpk_lineitem_partsupp#3840,cpfk_part_lineitem#3841,cfpk_lineitem_part#3842,cpfk_partsupp_lineitem#3843,cfpk_lineitem_orders#3844,cval_lineitem_l_quantity#3845,cval_lineitem_l_extendedprice#3846,cval_lineitem_l_discount#3847,cval_lineitem_l_tax#3848,cval_lineitem_l_returnflag#3849,cval_lineitem_l_linestatus#3850,cval_lineitem_l_commitdate#3851,cval_lineitem_l_receiptdate#3852,cval_lineitem_l_shipinstruct#3853,cval_lineitem_l_shipmode#3854,cval_lineitem_l_comment#3855,cval_lineitem_l_shipdate#3856,cl_quantity#3857,cl_extendedprice#3858,cl_discount#3859,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 97430ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/15 16:45:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:45:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4044L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 16:45:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:45:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:45:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:45:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:45:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:45:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:45:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:45:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4044L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#4046 AS rid_0#4079, cpfk_orders_lineitem#4047 AS cpfk_orders_lineitem_0#4080, cpfk_supplier_lineitem#4048 AS cpfk_supplier_lineitem_0#4081, cfpk_lineitem_supplier#4049 AS cfpk_lineitem_supplier_0#4082, cfpk_lineitem_partsupp#4050 AS cfpk_lineitem_partsupp_0#4083, cpfk_part_lineitem#4051 AS cpfk_part_lineitem_0#4084, cfpk_lineitem_part#4052 AS cfpk_lineitem_part_0#4085, cpfk_partsupp_lineitem#4053 AS cpfk_partsupp_lineitem_0#4086, cfpk_lineitem_orders#4054 AS cfpk_lineitem_orders_0#4087, cval_lineitem_l_quantity#4055 AS cval_lineitem_l_quantity_0#4088, cval_lineitem_l_extendedprice#4056 AS cval_lineitem_l_extendedprice_0#4089, cval_lineitem_l_discount#4057 AS cval_lineitem_l_discount_0#4090, cval_lineitem_l_tax#4058 AS cval_lineitem_l_tax_0#4091, cval_lineitem_l_returnflag#4059 AS cval_lineitem_l_returnflag_0#4092, cval_lineitem_l_linestatus#4060 AS cval_lineitem_l_linestatus_0#4093, cval_lineitem_l_commitdate#4061 AS cval_lineitem_l_commitdate_0#4094, cval_lineitem_l_receiptdate#4062 AS cval_lineitem_l_receiptdate_0#4095, cval_lineitem_l_shipinstruct#4063 AS cval_lineitem_l_shipinstruct_0#4096, cval_lineitem_l_shipmode#4064 AS cval_lineitem_l_shipmode_0#4097, cval_lineitem_l_comment#4065 AS cval_lineitem_l_comment_0#4098, cval_lineitem_l_shipdate#4066 AS cval_lineitem_l_shipdate_0#4099, cl_quantity#4067 AS cl_quantity_0#4100, cl_extendedprice#4068 AS cl_extendedprice_0#4101, cl_discount#4069 AS cl_discount_0#4102, ... 9 more fields]
            :  +- Relation[rid#4046,cpfk_orders_lineitem#4047,cpfk_supplier_lineitem#4048,cfpk_lineitem_supplier#4049,cfpk_lineitem_partsupp#4050,cpfk_part_lineitem#4051,cfpk_lineitem_part#4052,cpfk_partsupp_lineitem#4053,cfpk_lineitem_orders#4054,cval_lineitem_l_quantity#4055,cval_lineitem_l_extendedprice#4056,cval_lineitem_l_discount#4057,cval_lineitem_l_tax#4058,cval_lineitem_l_returnflag#4059,cval_lineitem_l_linestatus#4060,cval_lineitem_l_commitdate#4061,cval_lineitem_l_receiptdate#4062,cval_lineitem_l_shipinstruct#4063,cval_lineitem_l_shipmode#4064,cval_lineitem_l_comment#4065,cval_lineitem_l_shipdate#4066,cl_quantity#4067,cl_extendedprice#4068,cl_discount#4069,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#4112 AS rid_1#4129, cpfk_customer_orders#4113 AS cpfk_customer_orders_1#4130, cfpk_orders_customer#4114 AS cfpk_orders_customer_1#4131, cval_orders_o_orderstatus#4115 AS cval_orders_o_orderstatus_1#4132, cval_orders_o_totalprice#4116 AS cval_orders_o_totalprice_1#4133, cval_orders_o_orderpriority#4117 AS cval_orders_o_orderpriority_1#4134, cval_orders_o_clerk#4118 AS cval_orders_o_clerk_1#4135, cval_orders_o_shippriority#4119 AS cval_orders_o_shippriority_1#4136, cval_orders_o_comment#4120 AS cval_orders_o_comment_1#4137, cval_orders_o_orderdate#4121 AS cval_orders_o_orderdate_1#4138, co_orderstatus#4122 AS co_orderstatus_1#4139, co_totalprice#4123 AS co_totalprice_1#4140, co_orderpriority#4124 AS co_orderpriority_1#4141, co_clerk#4125 AS co_clerk_1#4142, co_shippriority#4126 AS co_shippriority_1#4143, co_comment#4127 AS co_comment_1#4144, co_orderdate#4128 AS co_orderdate_1#4145]
                  :     :  :  :  :  +- Relation[rid#4112,cpfk_customer_orders#4113,cfpk_orders_customer#4114,cval_orders_o_orderstatus#4115,cval_orders_o_totalprice#4116,cval_orders_o_orderpriority#4117,cval_orders_o_clerk#4118,cval_orders_o_shippriority#4119,cval_orders_o_comment#4120,cval_orders_o_orderdate#4121,co_orderstatus#4122,co_totalprice#4123,co_orderpriority#4124,co_clerk#4125,co_shippriority#4126,co_comment#4127,co_orderdate#4128] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#4146 AS rid_1#4163, cpfk_customer_orders#4147 AS cpfk_customer_orders_1#4164, cfpk_orders_customer#4148 AS cfpk_orders_customer_1#4165, cval_orders_o_orderstatus#4149 AS cval_orders_o_orderstatus_1#4166, cval_orders_o_totalprice#4150 AS cval_orders_o_totalprice_1#4167, cval_orders_o_orderpriority#4151 AS cval_orders_o_orderpriority_1#4168, cval_orders_o_clerk#4152 AS cval_orders_o_clerk_1#4169, cval_orders_o_shippriority#4153 AS cval_orders_o_shippriority_1#4170, cval_orders_o_comment#4154 AS cval_orders_o_comment_1#4171, cval_orders_o_orderdate#4155 AS cval_orders_o_orderdate_1#4172, co_orderstatus#4156 AS co_orderstatus_1#4173, co_totalprice#4157 AS co_totalprice_1#4174, co_orderpriority#4158 AS co_orderpriority_1#4175, co_clerk#4159 AS co_clerk_1#4176, co_shippriority#4160 AS co_shippriority_1#4177, co_comment#4161 AS co_comment_1#4178, co_orderdate#4162 AS co_orderdate_1#4179]
                  :     :  :  :        +- Relation[rid#4146,cpfk_customer_orders#4147,cfpk_orders_customer#4148,cval_orders_o_orderstatus#4149,cval_orders_o_totalprice#4150,cval_orders_o_orderpriority#4151,cval_orders_o_clerk#4152,cval_orders_o_shippriority#4153,cval_orders_o_comment#4154,cval_orders_o_orderdate#4155,co_orderstatus#4156,co_totalprice#4157,co_orderpriority#4158,co_clerk#4159,co_shippriority#4160,co_comment#4161,co_orderdate#4162] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- Project [rid#4280 AS rid_2#4313, cpfk_orders_lineitem#4281 AS cpfk_orders_lineitem_2#4314, cpfk_supplier_lineitem#4282 AS cpfk_supplier_lineitem_2#4315, cfpk_lineitem_supplier#4283 AS cfpk_lineitem_supplier_2#4316, cfpk_lineitem_partsupp#4284 AS cfpk_lineitem_partsupp_2#4317, cpfk_part_lineitem#4285 AS cpfk_part_lineitem_2#4318, cfpk_lineitem_part#4286 AS cfpk_lineitem_part_2#4319, cpfk_partsupp_lineitem#4287 AS cpfk_partsupp_lineitem_2#4320, cfpk_lineitem_orders#4288 AS cfpk_lineitem_orders_2#4321, cval_lineitem_l_quantity#4289 AS cval_lineitem_l_quantity_2#4322, cval_lineitem_l_extendedprice#4290 AS cval_lineitem_l_extendedprice_2#4323, cval_lineitem_l_discount#4291 AS cval_lineitem_l_discount_2#4324, cval_lineitem_l_tax#4292 AS cval_lineitem_l_tax_2#4325, cval_lineitem_l_returnflag#4293 AS cval_lineitem_l_returnflag_2#4326, cval_lineitem_l_linestatus#4294 AS cval_lineitem_l_linestatus_2#4327, cval_lineitem_l_commitdate#4295 AS cval_lineitem_l_commitdate_2#4328, cval_lineitem_l_receiptdate#4296 AS cval_lineitem_l_receiptdate_2#4329, cval_lineitem_l_shipinstruct#4297 AS cval_lineitem_l_shipinstruct_2#4330, cval_lineitem_l_shipmode#4298 AS cval_lineitem_l_shipmode_2#4331, cval_lineitem_l_comment#4299 AS cval_lineitem_l_comment_2#4332, cval_lineitem_l_shipdate#4300 AS cval_lineitem_l_shipdate_2#4333, cl_quantity#4301 AS cl_quantity_2#4334, cl_extendedprice#4302 AS cl_extendedprice_2#4335, cl_discount#4303 AS cl_discount_2#4336, ... 9 more fields]
                  :     :  :     +- Relation[rid#4280,cpfk_orders_lineitem#4281,cpfk_supplier_lineitem#4282,cfpk_lineitem_supplier#4283,cfpk_lineitem_partsupp#4284,cpfk_part_lineitem#4285,cfpk_lineitem_part#4286,cpfk_partsupp_lineitem#4287,cfpk_lineitem_orders#4288,cval_lineitem_l_quantity#4289,cval_lineitem_l_extendedprice#4290,cval_lineitem_l_discount#4291,cval_lineitem_l_tax#4292,cval_lineitem_l_returnflag#4293,cval_lineitem_l_linestatus#4294,cval_lineitem_l_commitdate#4295,cval_lineitem_l_receiptdate#4296,cval_lineitem_l_shipinstruct#4297,cval_lineitem_l_shipmode#4298,cval_lineitem_l_comment#4299,cval_lineitem_l_shipdate#4300,cl_quantity#4301,cl_extendedprice#4302,cl_discount#4303,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#4180 AS rid_2#4213, cpfk_orders_lineitem#4181 AS cpfk_orders_lineitem_2#4214, cpfk_supplier_lineitem#4182 AS cpfk_supplier_lineitem_2#4215, cfpk_lineitem_supplier#4183 AS cfpk_lineitem_supplier_2#4216, cfpk_lineitem_partsupp#4184 AS cfpk_lineitem_partsupp_2#4217, cpfk_part_lineitem#4185 AS cpfk_part_lineitem_2#4218, cfpk_lineitem_part#4186 AS cfpk_lineitem_part_2#4219, cpfk_partsupp_lineitem#4187 AS cpfk_partsupp_lineitem_2#4220, cfpk_lineitem_orders#4188 AS cfpk_lineitem_orders_2#4221, cval_lineitem_l_quantity#4189 AS cval_lineitem_l_quantity_2#4222, cval_lineitem_l_extendedprice#4190 AS cval_lineitem_l_extendedprice_2#4223, cval_lineitem_l_discount#4191 AS cval_lineitem_l_discount_2#4224, cval_lineitem_l_tax#4192 AS cval_lineitem_l_tax_2#4225, cval_lineitem_l_returnflag#4193 AS cval_lineitem_l_returnflag_2#4226, cval_lineitem_l_linestatus#4194 AS cval_lineitem_l_linestatus_2#4227, cval_lineitem_l_commitdate#4195 AS cval_lineitem_l_commitdate_2#4228, cval_lineitem_l_receiptdate#4196 AS cval_lineitem_l_receiptdate_2#4229, cval_lineitem_l_shipinstruct#4197 AS cval_lineitem_l_shipinstruct_2#4230, cval_lineitem_l_shipmode#4198 AS cval_lineitem_l_shipmode_2#4231, cval_lineitem_l_comment#4199 AS cval_lineitem_l_comment_2#4232, cval_lineitem_l_shipdate#4200 AS cval_lineitem_l_shipdate_2#4233, cl_quantity#4201 AS cl_quantity_2#4234, cl_extendedprice#4202 AS cl_extendedprice_2#4235, cl_discount#4203 AS cl_discount_2#4236, ... 9 more fields]
                  :     :     +- Relation[rid#4180,cpfk_orders_lineitem#4181,cpfk_supplier_lineitem#4182,cfpk_lineitem_supplier#4183,cfpk_lineitem_partsupp#4184,cpfk_part_lineitem#4185,cfpk_lineitem_part#4186,cpfk_partsupp_lineitem#4187,cfpk_lineitem_orders#4188,cval_lineitem_l_quantity#4189,cval_lineitem_l_extendedprice#4190,cval_lineitem_l_discount#4191,cval_lineitem_l_tax#4192,cval_lineitem_l_returnflag#4193,cval_lineitem_l_linestatus#4194,cval_lineitem_l_commitdate#4195,cval_lineitem_l_receiptdate#4196,cval_lineitem_l_shipinstruct#4197,cval_lineitem_l_shipmode#4198,cval_lineitem_l_comment#4199,cval_lineitem_l_shipdate#4200,cl_quantity#4201,cl_extendedprice#4202,cl_discount#4203,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#4346 AS rid_3#4359, cpfk_nation_supplier#4347 AS cpfk_nation_supplier_3#4360, cfpk_supplier_nation#4348 AS cfpk_supplier_nation_3#4361, cval_supplier_s_name#4349 AS cval_supplier_s_name_3#4362, cval_supplier_s_address#4350 AS cval_supplier_s_address_3#4363, cval_supplier_s_phone#4351 AS cval_supplier_s_phone_3#4364, cval_supplier_s_acctbal#4352 AS cval_supplier_s_acctbal_3#4365, cval_supplier_s_comment#4353 AS cval_supplier_s_comment_3#4366, cs_name#4354 AS cs_name_3#4367, cs_address#4355 AS cs_address_3#4368, cs_phone#4356 AS cs_phone_3#4369, cs_acctbal#4357 AS cs_acctbal_3#4370, cs_comment#4358 AS cs_comment_3#4371]
                  :        +- Relation[rid#4346,cpfk_nation_supplier#4347,cfpk_supplier_nation#4348,cval_supplier_s_name#4349,cval_supplier_s_address#4350,cval_supplier_s_phone#4351,cval_supplier_s_acctbal#4352,cval_supplier_s_comment#4353,cs_name#4354,cs_address#4355,cs_phone#4356,cs_acctbal#4357,cs_comment#4358] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#4372 AS rid_4#4379, cpfk_region_nation#4373 AS cpfk_region_nation_4#4380, cfpk_nation_region#4374 AS cfpk_nation_region_4#4381, cval_nation_n_name#4375 AS cval_nation_n_name_4#4382, cval_nation_n_comment#4376 AS cval_nation_n_comment_4#4383, cn_name#4377 AS cn_name_4#4384, cn_comment#4378 AS cn_comment_4#4385]
                     :  +- Relation[rid#4372,cpfk_region_nation#4373,cfpk_nation_region#4374,cval_nation_n_name#4375,cval_nation_n_comment#4376,cn_name#4377,cn_comment#4378] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#4386 AS rid_4#4393, cpfk_region_nation#4387 AS cpfk_region_nation_4#4394, cfpk_nation_region#4388 AS cfpk_nation_region_4#4395, cval_nation_n_name#4389 AS cval_nation_n_name_4#4396, cval_nation_n_comment#4390 AS cval_nation_n_comment_4#4397, cn_name#4391 AS cn_name_4#4398, cn_comment#4392 AS cn_comment_4#4399]
                           +- Relation[rid#4386,cpfk_region_nation#4387,cfpk_nation_region#4388,cval_nation_n_name#4389,cval_nation_n_comment#4390,cn_name#4391,cn_comment#4392] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=120762
Elapsed time: 93892ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/15 16:47:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:47:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4510L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:47:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:47:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:47:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:47:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:47:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:47:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:47:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:47:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:47:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4510L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#4512 AS rid_0#4529, cval_part_p_name#4513 AS cval_part_p_name_0#4530, cval_part_p_mfgr#4514 AS cval_part_p_mfgr_0#4531, cval_part_p_type#4515 AS cval_part_p_type_0#4532, cval_part_p_size#4516 AS cval_part_p_size_0#4533, cval_part_p_container#4517 AS cval_part_p_container_0#4534, cval_part_p_retailprice#4518 AS cval_part_p_retailprice_0#4535, cval_part_p_comment#4519 AS cval_part_p_comment_0#4536, cval_part_p_brand#4520 AS cval_part_p_brand_0#4537, cp_name#4521 AS cp_name_0#4538, cp_mfgr#4522 AS cp_mfgr_0#4539, cp_type#4523 AS cp_type_0#4540, cp_size#4524 AS cp_size_0#4541, cp_container#4525 AS cp_container_0#4542, cp_retailprice#4526 AS cp_retailprice_0#4543, cp_comment#4527 AS cp_comment_0#4544, cp_brand#4528 AS cp_brand_0#4545]
            :     :     :  :  :  :  +- Relation[rid#4512,cval_part_p_name#4513,cval_part_p_mfgr#4514,cval_part_p_type#4515,cval_part_p_size#4516,cval_part_p_container#4517,cval_part_p_retailprice#4518,cval_part_p_comment#4519,cval_part_p_brand#4520,cp_name#4521,cp_mfgr#4522,cp_type#4523,cp_size#4524,cp_container#4525,cp_retailprice#4526,cp_comment#4527,cp_brand#4528] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#4546 AS rid_0#4563, cval_part_p_name#4547 AS cval_part_p_name_0#4564, cval_part_p_mfgr#4548 AS cval_part_p_mfgr_0#4565, cval_part_p_type#4549 AS cval_part_p_type_0#4566, cval_part_p_size#4550 AS cval_part_p_size_0#4567, cval_part_p_container#4551 AS cval_part_p_container_0#4568, cval_part_p_retailprice#4552 AS cval_part_p_retailprice_0#4569, cval_part_p_comment#4553 AS cval_part_p_comment_0#4570, cval_part_p_brand#4554 AS cval_part_p_brand_0#4571, cp_name#4555 AS cp_name_0#4572, cp_mfgr#4556 AS cp_mfgr_0#4573, cp_type#4557 AS cp_type_0#4574, cp_size#4558 AS cp_size_0#4575, cp_container#4559 AS cp_container_0#4576, cp_retailprice#4560 AS cp_retailprice_0#4577, cp_comment#4561 AS cp_comment_0#4578, cp_brand#4562 AS cp_brand_0#4579]
            :     :     :  :  :        +- Relation[rid#4546,cval_part_p_name#4547,cval_part_p_mfgr#4548,cval_part_p_type#4549,cval_part_p_size#4550,cval_part_p_container#4551,cval_part_p_retailprice#4552,cval_part_p_comment#4553,cval_part_p_brand#4554,cp_name#4555,cp_mfgr#4556,cp_type#4557,cp_size#4558,cp_container#4559,cp_retailprice#4560,cp_comment#4561,cp_brand#4562] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- Project [rid#4680 AS rid_1#4713, cpfk_orders_lineitem#4681 AS cpfk_orders_lineitem_1#4714, cpfk_supplier_lineitem#4682 AS cpfk_supplier_lineitem_1#4715, cfpk_lineitem_supplier#4683 AS cfpk_lineitem_supplier_1#4716, cfpk_lineitem_partsupp#4684 AS cfpk_lineitem_partsupp_1#4717, cpfk_part_lineitem#4685 AS cpfk_part_lineitem_1#4718, cfpk_lineitem_part#4686 AS cfpk_lineitem_part_1#4719, cpfk_partsupp_lineitem#4687 AS cpfk_partsupp_lineitem_1#4720, cfpk_lineitem_orders#4688 AS cfpk_lineitem_orders_1#4721, cval_lineitem_l_quantity#4689 AS cval_lineitem_l_quantity_1#4722, cval_lineitem_l_extendedprice#4690 AS cval_lineitem_l_extendedprice_1#4723, cval_lineitem_l_discount#4691 AS cval_lineitem_l_discount_1#4724, cval_lineitem_l_tax#4692 AS cval_lineitem_l_tax_1#4725, cval_lineitem_l_returnflag#4693 AS cval_lineitem_l_returnflag_1#4726, cval_lineitem_l_linestatus#4694 AS cval_lineitem_l_linestatus_1#4727, cval_lineitem_l_commitdate#4695 AS cval_lineitem_l_commitdate_1#4728, cval_lineitem_l_receiptdate#4696 AS cval_lineitem_l_receiptdate_1#4729, cval_lineitem_l_shipinstruct#4697 AS cval_lineitem_l_shipinstruct_1#4730, cval_lineitem_l_shipmode#4698 AS cval_lineitem_l_shipmode_1#4731, cval_lineitem_l_comment#4699 AS cval_lineitem_l_comment_1#4732, cval_lineitem_l_shipdate#4700 AS cval_lineitem_l_shipdate_1#4733, cl_quantity#4701 AS cl_quantity_1#4734, cl_extendedprice#4702 AS cl_extendedprice_1#4735, cl_discount#4703 AS cl_discount_1#4736, ... 9 more fields]
            :     :     :  :     +- Relation[rid#4680,cpfk_orders_lineitem#4681,cpfk_supplier_lineitem#4682,cfpk_lineitem_supplier#4683,cfpk_lineitem_partsupp#4684,cpfk_part_lineitem#4685,cfpk_lineitem_part#4686,cpfk_partsupp_lineitem#4687,cfpk_lineitem_orders#4688,cval_lineitem_l_quantity#4689,cval_lineitem_l_extendedprice#4690,cval_lineitem_l_discount#4691,cval_lineitem_l_tax#4692,cval_lineitem_l_returnflag#4693,cval_lineitem_l_linestatus#4694,cval_lineitem_l_commitdate#4695,cval_lineitem_l_receiptdate#4696,cval_lineitem_l_shipinstruct#4697,cval_lineitem_l_shipmode#4698,cval_lineitem_l_comment#4699,cval_lineitem_l_shipdate#4700,cl_quantity#4701,cl_extendedprice#4702,cl_discount#4703,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#4580 AS rid_1#4613, cpfk_orders_lineitem#4581 AS cpfk_orders_lineitem_1#4614, cpfk_supplier_lineitem#4582 AS cpfk_supplier_lineitem_1#4615, cfpk_lineitem_supplier#4583 AS cfpk_lineitem_supplier_1#4616, cfpk_lineitem_partsupp#4584 AS cfpk_lineitem_partsupp_1#4617, cpfk_part_lineitem#4585 AS cpfk_part_lineitem_1#4618, cfpk_lineitem_part#4586 AS cfpk_lineitem_part_1#4619, cpfk_partsupp_lineitem#4587 AS cpfk_partsupp_lineitem_1#4620, cfpk_lineitem_orders#4588 AS cfpk_lineitem_orders_1#4621, cval_lineitem_l_quantity#4589 AS cval_lineitem_l_quantity_1#4622, cval_lineitem_l_extendedprice#4590 AS cval_lineitem_l_extendedprice_1#4623, cval_lineitem_l_discount#4591 AS cval_lineitem_l_discount_1#4624, cval_lineitem_l_tax#4592 AS cval_lineitem_l_tax_1#4625, cval_lineitem_l_returnflag#4593 AS cval_lineitem_l_returnflag_1#4626, cval_lineitem_l_linestatus#4594 AS cval_lineitem_l_linestatus_1#4627, cval_lineitem_l_commitdate#4595 AS cval_lineitem_l_commitdate_1#4628, cval_lineitem_l_receiptdate#4596 AS cval_lineitem_l_receiptdate_1#4629, cval_lineitem_l_shipinstruct#4597 AS cval_lineitem_l_shipinstruct_1#4630, cval_lineitem_l_shipmode#4598 AS cval_lineitem_l_shipmode_1#4631, cval_lineitem_l_comment#4599 AS cval_lineitem_l_comment_1#4632, cval_lineitem_l_shipdate#4600 AS cval_lineitem_l_shipdate_1#4633, cl_quantity#4601 AS cl_quantity_1#4634, cl_extendedprice#4602 AS cl_extendedprice_1#4635, cl_discount#4603 AS cl_discount_1#4636, ... 9 more fields]
            :     :     :     +- Relation[rid#4580,cpfk_orders_lineitem#4581,cpfk_supplier_lineitem#4582,cfpk_lineitem_supplier#4583,cfpk_lineitem_partsupp#4584,cpfk_part_lineitem#4585,cfpk_lineitem_part#4586,cpfk_partsupp_lineitem#4587,cfpk_lineitem_orders#4588,cval_lineitem_l_quantity#4589,cval_lineitem_l_extendedprice#4590,cval_lineitem_l_discount#4591,cval_lineitem_l_tax#4592,cval_lineitem_l_returnflag#4593,cval_lineitem_l_linestatus#4594,cval_lineitem_l_commitdate#4595,cval_lineitem_l_receiptdate#4596,cval_lineitem_l_shipinstruct#4597,cval_lineitem_l_shipmode#4598,cval_lineitem_l_comment#4599,cval_lineitem_l_shipdate#4600,cl_quantity#4601,cl_extendedprice#4602,cl_discount#4603,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#4746 AS rid_2#4759, cpfk_nation_supplier#4747 AS cpfk_nation_supplier_2#4760, cfpk_supplier_nation#4748 AS cfpk_supplier_nation_2#4761, cval_supplier_s_name#4749 AS cval_supplier_s_name_2#4762, cval_supplier_s_address#4750 AS cval_supplier_s_address_2#4763, cval_supplier_s_phone#4751 AS cval_supplier_s_phone_2#4764, cval_supplier_s_acctbal#4752 AS cval_supplier_s_acctbal_2#4765, cval_supplier_s_comment#4753 AS cval_supplier_s_comment_2#4766, cs_name#4754 AS cs_name_2#4767, cs_address#4755 AS cs_address_2#4768, cs_phone#4756 AS cs_phone_2#4769, cs_acctbal#4757 AS cs_acctbal_2#4770, cs_comment#4758 AS cs_comment_2#4771]
            :     :        +- Relation[rid#4746,cpfk_nation_supplier#4747,cfpk_supplier_nation#4748,cval_supplier_s_name#4749,cval_supplier_s_address#4750,cval_supplier_s_phone#4751,cval_supplier_s_acctbal#4752,cval_supplier_s_comment#4753,cs_name#4754,cs_address#4755,cs_phone#4756,cs_acctbal#4757,cs_comment#4758] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#4772 AS rid_3#4779, cpfk_region_nation#4773 AS cpfk_region_nation_3#4780, cfpk_nation_region#4774 AS cfpk_nation_region_3#4781, cval_nation_n_name#4775 AS cval_nation_n_name_3#4782, cval_nation_n_comment#4776 AS cval_nation_n_comment_3#4783, cn_name#4777 AS cn_name_3#4784, cn_comment#4778 AS cn_comment_3#4785]
            :        +- Relation[rid#4772,cpfk_region_nation#4773,cfpk_nation_region#4774,cval_nation_n_name#4775,cval_nation_n_comment#4776,cn_name#4777,cn_comment#4778] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#4786 AS rid_4#4791, cval_region_r_name#4787 AS cval_region_r_name_4#4792, cval_region_r_comment#4788 AS cval_region_r_comment_4#4793, cr_name#4789 AS cr_name_4#4794, cr_comment#4790 AS cr_comment_4#4795]
               :  :  :  :  :  :  :  +- Relation[rid#4786,cval_region_r_name#4787,cval_region_r_comment#4788,cr_name#4789,cr_comment#4790] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#4796 AS rid_4#4801, cval_region_r_name#4797 AS cval_region_r_name_4#4802, cval_region_r_comment#4798 AS cval_region_r_comment_4#4803, cr_name#4799 AS cr_name_4#4804, cr_comment#4800 AS cr_comment_4#4805]
               :  :  :  :  :  :        +- Relation[rid#4796,cval_region_r_name#4797,cval_region_r_comment#4798,cr_name#4799,cr_comment#4800] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- Project [rid#4830 AS rid_5#4837, cpfk_region_nation#4831 AS cpfk_region_nation_5#4838, cfpk_nation_region#4832 AS cfpk_nation_region_5#4839, cval_nation_n_name#4833 AS cval_nation_n_name_5#4840, cval_nation_n_comment#4834 AS cval_nation_n_comment_5#4841, cn_name#4835 AS cn_name_5#4842, cn_comment#4836 AS cn_comment_5#4843]
               :  :  :  :  :     +- Relation[rid#4830,cpfk_region_nation#4831,cfpk_nation_region#4832,cval_nation_n_name#4833,cval_nation_n_comment#4834,cn_name#4835,cn_comment#4836] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#4806 AS rid_5#4813, cpfk_region_nation#4807 AS cpfk_region_nation_5#4814, cfpk_nation_region#4808 AS cfpk_nation_region_5#4815, cval_nation_n_name#4809 AS cval_nation_n_name_5#4816, cval_nation_n_comment#4810 AS cval_nation_n_comment_5#4817, cn_name#4811 AS cn_name_5#4818, cn_comment#4812 AS cn_comment_5#4819]
               :  :  :  :     +- Relation[rid#4806,cpfk_region_nation#4807,cfpk_nation_region#4808,cval_nation_n_name#4809,cval_nation_n_comment#4810,cn_name#4811,cn_comment#4812] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#4888 AS rid_6#4903, cpfk_nation_customer#4889 AS cpfk_nation_customer_6#4904, cfpk_customer_nation#4890 AS cfpk_customer_nation_6#4905, cval_customer_c_name#4891 AS cval_customer_c_name_6#4906, cval_customer_c_address#4892 AS cval_customer_c_address_6#4907, cval_customer_c_phone#4893 AS cval_customer_c_phone_6#4908, cval_customer_c_acctbal#4894 AS cval_customer_c_acctbal_6#4909, cval_customer_c_comment#4895 AS cval_customer_c_comment_6#4910, cval_customer_c_mktsegment#4896 AS cval_customer_c_mktsegment_6#4911, cc_name#4897 AS cc_name_6#4912, cc_address#4898 AS cc_address_6#4913, cc_phone#4899 AS cc_phone_6#4914, cc_acctbal#4900 AS cc_acctbal_6#4915, cc_comment#4901 AS cc_comment_6#4916, cc_mktsegment#4902 AS cc_mktsegment_6#4917]
               :  :  :     +- Relation[rid#4888,cpfk_nation_customer#4889,cfpk_customer_nation#4890,cval_customer_c_name#4891,cval_customer_c_address#4892,cval_customer_c_phone#4893,cval_customer_c_acctbal#4894,cval_customer_c_comment#4895,cval_customer_c_mktsegment#4896,cc_name#4897,cc_address#4898,cc_phone#4899,cc_acctbal#4900,cc_comment#4901,cc_mktsegment#4902] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#4844 AS rid_6#4859, cpfk_nation_customer#4845 AS cpfk_nation_customer_6#4860, cfpk_customer_nation#4846 AS cfpk_customer_nation_6#4861, cval_customer_c_name#4847 AS cval_customer_c_name_6#4862, cval_customer_c_address#4848 AS cval_customer_c_address_6#4863, cval_customer_c_phone#4849 AS cval_customer_c_phone_6#4864, cval_customer_c_acctbal#4850 AS cval_customer_c_acctbal_6#4865, cval_customer_c_comment#4851 AS cval_customer_c_comment_6#4866, cval_customer_c_mktsegment#4852 AS cval_customer_c_mktsegment_6#4867, cc_name#4853 AS cc_name_6#4868, cc_address#4854 AS cc_address_6#4869, cc_phone#4855 AS cc_phone_6#4870, cc_acctbal#4856 AS cc_acctbal_6#4871, cc_comment#4857 AS cc_comment_6#4872, cc_mktsegment#4858 AS cc_mktsegment_6#4873]
               :  :     +- Relation[rid#4844,cpfk_nation_customer#4845,cfpk_customer_nation#4846,cval_customer_c_name#4847,cval_customer_c_address#4848,cval_customer_c_phone#4849,cval_customer_c_acctbal#4850,cval_customer_c_comment#4851,cval_customer_c_mktsegment#4852,cc_name#4853,cc_address#4854,cc_phone#4855,cc_acctbal#4856,cc_comment#4857,cc_mktsegment#4858] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#4982 AS rid_7#4999, cpfk_customer_orders#4983 AS cpfk_customer_orders_7#5000, cfpk_orders_customer#4984 AS cfpk_orders_customer_7#5001, cval_orders_o_orderstatus#4985 AS cval_orders_o_orderstatus_7#5002, cval_orders_o_totalprice#4986 AS cval_orders_o_totalprice_7#5003, cval_orders_o_orderpriority#4987 AS cval_orders_o_orderpriority_7#5004, cval_orders_o_clerk#4988 AS cval_orders_o_clerk_7#5005, cval_orders_o_shippriority#4989 AS cval_orders_o_shippriority_7#5006, cval_orders_o_comment#4990 AS cval_orders_o_comment_7#5007, cval_orders_o_orderdate#4991 AS cval_orders_o_orderdate_7#5008, co_orderstatus#4992 AS co_orderstatus_7#5009, co_totalprice#4993 AS co_totalprice_7#5010, co_orderpriority#4994 AS co_orderpriority_7#5011, co_clerk#4995 AS co_clerk_7#5012, co_shippriority#4996 AS co_shippriority_7#5013, co_comment#4997 AS co_comment_7#5014, co_orderdate#4998 AS co_orderdate_7#5015]
               :     +- Relation[rid#4982,cpfk_customer_orders#4983,cfpk_orders_customer#4984,cval_orders_o_orderstatus#4985,cval_orders_o_totalprice#4986,cval_orders_o_orderpriority#4987,cval_orders_o_clerk#4988,cval_orders_o_shippriority#4989,cval_orders_o_comment#4990,cval_orders_o_orderdate#4991,co_orderstatus#4992,co_totalprice#4993,co_orderpriority#4994,co_clerk#4995,co_shippriority#4996,co_comment#4997,co_orderdate#4998] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#4918 AS rid_7#4935, cpfk_customer_orders#4919 AS cpfk_customer_orders_7#4936, cfpk_orders_customer#4920 AS cfpk_orders_customer_7#4937, cval_orders_o_orderstatus#4921 AS cval_orders_o_orderstatus_7#4938, cval_orders_o_totalprice#4922 AS cval_orders_o_totalprice_7#4939, cval_orders_o_orderpriority#4923 AS cval_orders_o_orderpriority_7#4940, cval_orders_o_clerk#4924 AS cval_orders_o_clerk_7#4941, cval_orders_o_shippriority#4925 AS cval_orders_o_shippriority_7#4942, cval_orders_o_comment#4926 AS cval_orders_o_comment_7#4943, cval_orders_o_orderdate#4927 AS cval_orders_o_orderdate_7#4944, co_orderstatus#4928 AS co_orderstatus_7#4945, co_totalprice#4929 AS co_totalprice_7#4946, co_orderpriority#4930 AS co_orderpriority_7#4947, co_clerk#4931 AS co_clerk_7#4948, co_shippriority#4932 AS co_shippriority_7#4949, co_comment#4933 AS co_comment_7#4950, co_orderdate#4934 AS co_orderdate_7#4951]
                  +- Relation[rid#4918,cpfk_customer_orders#4919,cfpk_orders_customer#4920,cval_orders_o_orderstatus#4921,cval_orders_o_totalprice#4922,cval_orders_o_orderpriority#4923,cval_orders_o_clerk#4924,cval_orders_o_shippriority#4925,cval_orders_o_comment#4926,cval_orders_o_orderdate#4927,co_orderstatus#4928,co_totalprice#4929,co_orderpriority#4930,co_clerk#4931,co_shippriority#4932,co_comment#4933,co_orderdate#4934] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 2269ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/15 16:47:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:47:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5135L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:47:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#5135L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#5137 AS rid_0#5170, cpfk_orders_lineitem#5138 AS cpfk_orders_lineitem_0#5171, cpfk_supplier_lineitem#5139 AS cpfk_supplier_lineitem_0#5172, cfpk_lineitem_supplier#5140 AS cfpk_lineitem_supplier_0#5173, cfpk_lineitem_partsupp#5141 AS cfpk_lineitem_partsupp_0#5174, cpfk_part_lineitem#5142 AS cpfk_part_lineitem_0#5175, cfpk_lineitem_part#5143 AS cfpk_lineitem_part_0#5176, cpfk_partsupp_lineitem#5144 AS cpfk_partsupp_lineitem_0#5177, cfpk_lineitem_orders#5145 AS cfpk_lineitem_orders_0#5178, cval_lineitem_l_quantity#5146 AS cval_lineitem_l_quantity_0#5179, cval_lineitem_l_extendedprice#5147 AS cval_lineitem_l_extendedprice_0#5180, cval_lineitem_l_discount#5148 AS cval_lineitem_l_discount_0#5181, cval_lineitem_l_tax#5149 AS cval_lineitem_l_tax_0#5182, cval_lineitem_l_returnflag#5150 AS cval_lineitem_l_returnflag_0#5183, cval_lineitem_l_linestatus#5151 AS cval_lineitem_l_linestatus_0#5184, cval_lineitem_l_commitdate#5152 AS cval_lineitem_l_commitdate_0#5185, cval_lineitem_l_receiptdate#5153 AS cval_lineitem_l_receiptdate_0#5186, cval_lineitem_l_shipinstruct#5154 AS cval_lineitem_l_shipinstruct_0#5187, cval_lineitem_l_shipmode#5155 AS cval_lineitem_l_shipmode_0#5188, cval_lineitem_l_comment#5156 AS cval_lineitem_l_comment_0#5189, cval_lineitem_l_shipdate#5157 AS cval_lineitem_l_shipdate_0#5190, cl_quantity#5158 AS cl_quantity_0#5191, cl_extendedprice#5159 AS cl_extendedprice_0#5192, cl_discount#5160 AS cl_discount_0#5193, ... 9 more fields]
         +- Relation[rid#5137,cpfk_orders_lineitem#5138,cpfk_supplier_lineitem#5139,cfpk_lineitem_supplier#5140,cfpk_lineitem_partsupp#5141,cpfk_part_lineitem#5142,cfpk_lineitem_part#5143,cpfk_partsupp_lineitem#5144,cfpk_lineitem_orders#5145,cval_lineitem_l_quantity#5146,cval_lineitem_l_extendedprice#5147,cval_lineitem_l_discount#5148,cval_lineitem_l_tax#5149,cval_lineitem_l_returnflag#5150,cval_lineitem_l_linestatus#5151,cval_lineitem_l_commitdate#5152,cval_lineitem_l_receiptdate#5153,cval_lineitem_l_shipinstruct#5154,cval_lineitem_l_shipmode#5155,cval_lineitem_l_comment#5156,cval_lineitem_l_shipdate#5157,cl_quantity#5158,cl_extendedprice#5159,cl_discount#5160,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2847ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/15 16:47:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:47:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5242L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 16:47:21 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:47:21 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:47:21 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:47:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:21 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:47:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:21 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:47:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:47:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:47:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:47:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:47:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5242L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#5244 AS rid_0#5249, cval_region_r_name#5245 AS cval_region_r_name_0#5250, cval_region_r_comment#5246 AS cval_region_r_comment_0#5251, cr_name#5247 AS cr_name_0#5252, cr_comment#5248 AS cr_comment_0#5253]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#5244,cval_region_r_name#5245,cval_region_r_comment#5246,cr_name#5247,cr_comment#5248] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#5254 AS rid_0#5259, cval_region_r_name#5255 AS cval_region_r_name_0#5260, cval_region_r_comment#5256 AS cval_region_r_comment_0#5261, cr_name#5257 AS cr_name_0#5262, cr_comment#5258 AS cr_comment_0#5263]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#5254,cval_region_r_name#5255,cval_region_r_comment#5256,cr_name#5257,cr_comment#5258] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- Project [rid#5288 AS rid_1#5295, cpfk_region_nation#5289 AS cpfk_region_nation_1#5296, cfpk_nation_region#5290 AS cfpk_nation_region_1#5297, cval_nation_n_name#5291 AS cval_nation_n_name_1#5298, cval_nation_n_comment#5292 AS cval_nation_n_comment_1#5299, cn_name#5293 AS cn_name_1#5300, cn_comment#5294 AS cn_comment_1#5301]
         :     :  :  :  :  :  :  :  :     +- Relation[rid#5288,cpfk_region_nation#5289,cfpk_nation_region#5290,cval_nation_n_name#5291,cval_nation_n_comment#5292,cn_name#5293,cn_comment#5294] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#5264 AS rid_1#5271, cpfk_region_nation#5265 AS cpfk_region_nation_1#5272, cfpk_nation_region#5266 AS cfpk_nation_region_1#5273, cval_nation_n_name#5267 AS cval_nation_n_name_1#5274, cval_nation_n_comment#5268 AS cval_nation_n_comment_1#5275, cn_name#5269 AS cn_name_1#5276, cn_comment#5270 AS cn_comment_1#5277]
         :     :  :  :  :  :  :  :     +- Relation[rid#5264,cpfk_region_nation#5265,cfpk_nation_region#5266,cval_nation_n_name#5267,cval_nation_n_comment#5268,cn_name#5269,cn_comment#5270] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- Project [rid#5346 AS rid_2#5361, cpfk_nation_customer#5347 AS cpfk_nation_customer_2#5362, cfpk_customer_nation#5348 AS cfpk_customer_nation_2#5363, cval_customer_c_name#5349 AS cval_customer_c_name_2#5364, cval_customer_c_address#5350 AS cval_customer_c_address_2#5365, cval_customer_c_phone#5351 AS cval_customer_c_phone_2#5366, cval_customer_c_acctbal#5352 AS cval_customer_c_acctbal_2#5367, cval_customer_c_comment#5353 AS cval_customer_c_comment_2#5368, cval_customer_c_mktsegment#5354 AS cval_customer_c_mktsegment_2#5369, cc_name#5355 AS cc_name_2#5370, cc_address#5356 AS cc_address_2#5371, cc_phone#5357 AS cc_phone_2#5372, cc_acctbal#5358 AS cc_acctbal_2#5373, cc_comment#5359 AS cc_comment_2#5374, cc_mktsegment#5360 AS cc_mktsegment_2#5375]
         :     :  :  :  :  :  :     +- Relation[rid#5346,cpfk_nation_customer#5347,cfpk_customer_nation#5348,cval_customer_c_name#5349,cval_customer_c_address#5350,cval_customer_c_phone#5351,cval_customer_c_acctbal#5352,cval_customer_c_comment#5353,cval_customer_c_mktsegment#5354,cc_name#5355,cc_address#5356,cc_phone#5357,cc_acctbal#5358,cc_comment#5359,cc_mktsegment#5360] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#5302 AS rid_2#5317, cpfk_nation_customer#5303 AS cpfk_nation_customer_2#5318, cfpk_customer_nation#5304 AS cfpk_customer_nation_2#5319, cval_customer_c_name#5305 AS cval_customer_c_name_2#5320, cval_customer_c_address#5306 AS cval_customer_c_address_2#5321, cval_customer_c_phone#5307 AS cval_customer_c_phone_2#5322, cval_customer_c_acctbal#5308 AS cval_customer_c_acctbal_2#5323, cval_customer_c_comment#5309 AS cval_customer_c_comment_2#5324, cval_customer_c_mktsegment#5310 AS cval_customer_c_mktsegment_2#5325, cc_name#5311 AS cc_name_2#5326, cc_address#5312 AS cc_address_2#5327, cc_phone#5313 AS cc_phone_2#5328, cc_acctbal#5314 AS cc_acctbal_2#5329, cc_comment#5315 AS cc_comment_2#5330, cc_mktsegment#5316 AS cc_mktsegment_2#5331]
         :     :  :  :  :  :     +- Relation[rid#5302,cpfk_nation_customer#5303,cfpk_customer_nation#5304,cval_customer_c_name#5305,cval_customer_c_address#5306,cval_customer_c_phone#5307,cval_customer_c_acctbal#5308,cval_customer_c_comment#5309,cval_customer_c_mktsegment#5310,cc_name#5311,cc_address#5312,cc_phone#5313,cc_acctbal#5314,cc_comment#5315,cc_mktsegment#5316] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- Project [rid#5440 AS rid_3#5457, cpfk_customer_orders#5441 AS cpfk_customer_orders_3#5458, cfpk_orders_customer#5442 AS cfpk_orders_customer_3#5459, cval_orders_o_orderstatus#5443 AS cval_orders_o_orderstatus_3#5460, cval_orders_o_totalprice#5444 AS cval_orders_o_totalprice_3#5461, cval_orders_o_orderpriority#5445 AS cval_orders_o_orderpriority_3#5462, cval_orders_o_clerk#5446 AS cval_orders_o_clerk_3#5463, cval_orders_o_shippriority#5447 AS cval_orders_o_shippriority_3#5464, cval_orders_o_comment#5448 AS cval_orders_o_comment_3#5465, cval_orders_o_orderdate#5449 AS cval_orders_o_orderdate_3#5466, co_orderstatus#5450 AS co_orderstatus_3#5467, co_totalprice#5451 AS co_totalprice_3#5468, co_orderpriority#5452 AS co_orderpriority_3#5469, co_clerk#5453 AS co_clerk_3#5470, co_shippriority#5454 AS co_shippriority_3#5471, co_comment#5455 AS co_comment_3#5472, co_orderdate#5456 AS co_orderdate_3#5473]
         :     :  :  :  :     +- Relation[rid#5440,cpfk_customer_orders#5441,cfpk_orders_customer#5442,cval_orders_o_orderstatus#5443,cval_orders_o_totalprice#5444,cval_orders_o_orderpriority#5445,cval_orders_o_clerk#5446,cval_orders_o_shippriority#5447,cval_orders_o_comment#5448,cval_orders_o_orderdate#5449,co_orderstatus#5450,co_totalprice#5451,co_orderpriority#5452,co_clerk#5453,co_shippriority#5454,co_comment#5455,co_orderdate#5456] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#5376 AS rid_3#5393, cpfk_customer_orders#5377 AS cpfk_customer_orders_3#5394, cfpk_orders_customer#5378 AS cfpk_orders_customer_3#5395, cval_orders_o_orderstatus#5379 AS cval_orders_o_orderstatus_3#5396, cval_orders_o_totalprice#5380 AS cval_orders_o_totalprice_3#5397, cval_orders_o_orderpriority#5381 AS cval_orders_o_orderpriority_3#5398, cval_orders_o_clerk#5382 AS cval_orders_o_clerk_3#5399, cval_orders_o_shippriority#5383 AS cval_orders_o_shippriority_3#5400, cval_orders_o_comment#5384 AS cval_orders_o_comment_3#5401, cval_orders_o_orderdate#5385 AS cval_orders_o_orderdate_3#5402, co_orderstatus#5386 AS co_orderstatus_3#5403, co_totalprice#5387 AS co_totalprice_3#5404, co_orderpriority#5388 AS co_orderpriority_3#5405, co_clerk#5389 AS co_clerk_3#5406, co_shippriority#5390 AS co_shippriority_3#5407, co_comment#5391 AS co_comment_3#5408, co_orderdate#5392 AS co_orderdate_3#5409]
         :     :  :  :     +- Relation[rid#5376,cpfk_customer_orders#5377,cfpk_orders_customer#5378,cval_orders_o_orderstatus#5379,cval_orders_o_totalprice#5380,cval_orders_o_orderpriority#5381,cval_orders_o_clerk#5382,cval_orders_o_shippriority#5383,cval_orders_o_comment#5384,cval_orders_o_orderdate#5385,co_orderstatus#5386,co_totalprice#5387,co_orderpriority#5388,co_clerk#5389,co_shippriority#5390,co_comment#5391,co_orderdate#5392] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- Project [rid#5574 AS rid_4#5607, cpfk_orders_lineitem#5575 AS cpfk_orders_lineitem_4#5608, cpfk_supplier_lineitem#5576 AS cpfk_supplier_lineitem_4#5609, cfpk_lineitem_supplier#5577 AS cfpk_lineitem_supplier_4#5610, cfpk_lineitem_partsupp#5578 AS cfpk_lineitem_partsupp_4#5611, cpfk_part_lineitem#5579 AS cpfk_part_lineitem_4#5612, cfpk_lineitem_part#5580 AS cfpk_lineitem_part_4#5613, cpfk_partsupp_lineitem#5581 AS cpfk_partsupp_lineitem_4#5614, cfpk_lineitem_orders#5582 AS cfpk_lineitem_orders_4#5615, cval_lineitem_l_quantity#5583 AS cval_lineitem_l_quantity_4#5616, cval_lineitem_l_extendedprice#5584 AS cval_lineitem_l_extendedprice_4#5617, cval_lineitem_l_discount#5585 AS cval_lineitem_l_discount_4#5618, cval_lineitem_l_tax#5586 AS cval_lineitem_l_tax_4#5619, cval_lineitem_l_returnflag#5587 AS cval_lineitem_l_returnflag_4#5620, cval_lineitem_l_linestatus#5588 AS cval_lineitem_l_linestatus_4#5621, cval_lineitem_l_commitdate#5589 AS cval_lineitem_l_commitdate_4#5622, cval_lineitem_l_receiptdate#5590 AS cval_lineitem_l_receiptdate_4#5623, cval_lineitem_l_shipinstruct#5591 AS cval_lineitem_l_shipinstruct_4#5624, cval_lineitem_l_shipmode#5592 AS cval_lineitem_l_shipmode_4#5625, cval_lineitem_l_comment#5593 AS cval_lineitem_l_comment_4#5626, cval_lineitem_l_shipdate#5594 AS cval_lineitem_l_shipdate_4#5627, cl_quantity#5595 AS cl_quantity_4#5628, cl_extendedprice#5596 AS cl_extendedprice_4#5629, cl_discount#5597 AS cl_discount_4#5630, ... 9 more fields]
         :     :  :     +- Relation[rid#5574,cpfk_orders_lineitem#5575,cpfk_supplier_lineitem#5576,cfpk_lineitem_supplier#5577,cfpk_lineitem_partsupp#5578,cpfk_part_lineitem#5579,cfpk_lineitem_part#5580,cpfk_partsupp_lineitem#5581,cfpk_lineitem_orders#5582,cval_lineitem_l_quantity#5583,cval_lineitem_l_extendedprice#5584,cval_lineitem_l_discount#5585,cval_lineitem_l_tax#5586,cval_lineitem_l_returnflag#5587,cval_lineitem_l_linestatus#5588,cval_lineitem_l_commitdate#5589,cval_lineitem_l_receiptdate#5590,cval_lineitem_l_shipinstruct#5591,cval_lineitem_l_shipmode#5592,cval_lineitem_l_comment#5593,cval_lineitem_l_shipdate#5594,cl_quantity#5595,cl_extendedprice#5596,cl_discount#5597,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#5474 AS rid_4#5507, cpfk_orders_lineitem#5475 AS cpfk_orders_lineitem_4#5508, cpfk_supplier_lineitem#5476 AS cpfk_supplier_lineitem_4#5509, cfpk_lineitem_supplier#5477 AS cfpk_lineitem_supplier_4#5510, cfpk_lineitem_partsupp#5478 AS cfpk_lineitem_partsupp_4#5511, cpfk_part_lineitem#5479 AS cpfk_part_lineitem_4#5512, cfpk_lineitem_part#5480 AS cfpk_lineitem_part_4#5513, cpfk_partsupp_lineitem#5481 AS cpfk_partsupp_lineitem_4#5514, cfpk_lineitem_orders#5482 AS cfpk_lineitem_orders_4#5515, cval_lineitem_l_quantity#5483 AS cval_lineitem_l_quantity_4#5516, cval_lineitem_l_extendedprice#5484 AS cval_lineitem_l_extendedprice_4#5517, cval_lineitem_l_discount#5485 AS cval_lineitem_l_discount_4#5518, cval_lineitem_l_tax#5486 AS cval_lineitem_l_tax_4#5519, cval_lineitem_l_returnflag#5487 AS cval_lineitem_l_returnflag_4#5520, cval_lineitem_l_linestatus#5488 AS cval_lineitem_l_linestatus_4#5521, cval_lineitem_l_commitdate#5489 AS cval_lineitem_l_commitdate_4#5522, cval_lineitem_l_receiptdate#5490 AS cval_lineitem_l_receiptdate_4#5523, cval_lineitem_l_shipinstruct#5491 AS cval_lineitem_l_shipinstruct_4#5524, cval_lineitem_l_shipmode#5492 AS cval_lineitem_l_shipmode_4#5525, cval_lineitem_l_comment#5493 AS cval_lineitem_l_comment_4#5526, cval_lineitem_l_shipdate#5494 AS cval_lineitem_l_shipdate_4#5527, cl_quantity#5495 AS cl_quantity_4#5528, cl_extendedprice#5496 AS cl_extendedprice_4#5529, cl_discount#5497 AS cl_discount_4#5530, ... 9 more fields]
         :     :     +- Relation[rid#5474,cpfk_orders_lineitem#5475,cpfk_supplier_lineitem#5476,cfpk_lineitem_supplier#5477,cfpk_lineitem_partsupp#5478,cpfk_part_lineitem#5479,cfpk_lineitem_part#5480,cpfk_partsupp_lineitem#5481,cfpk_lineitem_orders#5482,cval_lineitem_l_quantity#5483,cval_lineitem_l_extendedprice#5484,cval_lineitem_l_discount#5485,cval_lineitem_l_tax#5486,cval_lineitem_l_returnflag#5487,cval_lineitem_l_linestatus#5488,cval_lineitem_l_commitdate#5489,cval_lineitem_l_receiptdate#5490,cval_lineitem_l_shipinstruct#5491,cval_lineitem_l_shipmode#5492,cval_lineitem_l_comment#5493,cval_lineitem_l_shipdate#5494,cl_quantity#5495,cl_extendedprice#5496,cl_discount#5497,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#5640 AS rid_5#5653, cpfk_nation_supplier#5641 AS cpfk_nation_supplier_5#5654, cfpk_supplier_nation#5642 AS cfpk_supplier_nation_5#5655, cval_supplier_s_name#5643 AS cval_supplier_s_name_5#5656, cval_supplier_s_address#5644 AS cval_supplier_s_address_5#5657, cval_supplier_s_phone#5645 AS cval_supplier_s_phone_5#5658, cval_supplier_s_acctbal#5646 AS cval_supplier_s_acctbal_5#5659, cval_supplier_s_comment#5647 AS cval_supplier_s_comment_5#5660, cs_name#5648 AS cs_name_5#5661, cs_address#5649 AS cs_address_5#5662, cs_phone#5650 AS cs_phone_5#5663, cs_acctbal#5651 AS cs_acctbal_5#5664, cs_comment#5652 AS cs_comment_5#5665]
         :        +- Relation[rid#5640,cpfk_nation_supplier#5641,cfpk_supplier_nation#5642,cval_supplier_s_name#5643,cval_supplier_s_address#5644,cval_supplier_s_phone#5645,cval_supplier_s_acctbal#5646,cval_supplier_s_comment#5647,cs_name#5648,cs_address#5649,cs_phone#5650,cs_acctbal#5651,cs_comment#5652] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#5666 AS rid_1#5673, cpfk_region_nation#5667 AS cpfk_region_nation_1#5674, cfpk_nation_region#5668 AS cfpk_nation_region_1#5675, cval_nation_n_name#5669 AS cval_nation_n_name_1#5676, cval_nation_n_comment#5670 AS cval_nation_n_comment_1#5677, cn_name#5671 AS cn_name_1#5678, cn_comment#5672 AS cn_comment_1#5679]
            :  +- Relation[rid#5666,cpfk_region_nation#5667,cfpk_nation_region#5668,cval_nation_n_name#5669,cval_nation_n_comment#5670,cn_name#5671,cn_comment#5672] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#5680 AS rid_5#5693, cpfk_nation_supplier#5681 AS cpfk_nation_supplier_5#5694, cfpk_supplier_nation#5682 AS cfpk_supplier_nation_5#5695, cval_supplier_s_name#5683 AS cval_supplier_s_name_5#5696, cval_supplier_s_address#5684 AS cval_supplier_s_address_5#5697, cval_supplier_s_phone#5685 AS cval_supplier_s_phone_5#5698, cval_supplier_s_acctbal#5686 AS cval_supplier_s_acctbal_5#5699, cval_supplier_s_comment#5687 AS cval_supplier_s_comment_5#5700, cs_name#5688 AS cs_name_5#5701, cs_address#5689 AS cs_address_5#5702, cs_phone#5690 AS cs_phone_5#5703, cs_acctbal#5691 AS cs_acctbal_5#5704, cs_comment#5692 AS cs_comment_5#5705]
               +- Relation[rid#5680,cpfk_nation_supplier#5681,cfpk_supplier_nation#5682,cval_supplier_s_name#5683,cval_supplier_s_address#5684,cval_supplier_s_phone#5685,cval_supplier_s_acctbal#5686,cval_supplier_s_comment#5687,cs_name#5688,cs_address#5689,cs_phone#5690,cs_acctbal#5691,cs_comment#5692] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=5
Elapsed time: 21091ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/15 16:47:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:47:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5801L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 16:47:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:47:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:47:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:47:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:47:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:47:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:47:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:47:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:47:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5801L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#5803 AS rid_0#5820, cval_part_p_name#5804 AS cval_part_p_name_0#5821, cval_part_p_mfgr#5805 AS cval_part_p_mfgr_0#5822, cval_part_p_type#5806 AS cval_part_p_type_0#5823, cval_part_p_size#5807 AS cval_part_p_size_0#5824, cval_part_p_container#5808 AS cval_part_p_container_0#5825, cval_part_p_retailprice#5809 AS cval_part_p_retailprice_0#5826, cval_part_p_comment#5810 AS cval_part_p_comment_0#5827, cval_part_p_brand#5811 AS cval_part_p_brand_0#5828, cp_name#5812 AS cp_name_0#5829, cp_mfgr#5813 AS cp_mfgr_0#5830, cp_type#5814 AS cp_type_0#5831, cp_size#5815 AS cp_size_0#5832, cp_container#5816 AS cp_container_0#5833, cp_retailprice#5817 AS cp_retailprice_0#5834, cp_comment#5818 AS cp_comment_0#5835, cp_brand#5819 AS cp_brand_0#5836]
            :  :  :  :  +- Relation[rid#5803,cval_part_p_name#5804,cval_part_p_mfgr#5805,cval_part_p_type#5806,cval_part_p_size#5807,cval_part_p_container#5808,cval_part_p_retailprice#5809,cval_part_p_comment#5810,cval_part_p_brand#5811,cp_name#5812,cp_mfgr#5813,cp_type#5814,cp_size#5815,cp_container#5816,cp_retailprice#5817,cp_comment#5818,cp_brand#5819] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#5837 AS rid_0#5854, cval_part_p_name#5838 AS cval_part_p_name_0#5855, cval_part_p_mfgr#5839 AS cval_part_p_mfgr_0#5856, cval_part_p_type#5840 AS cval_part_p_type_0#5857, cval_part_p_size#5841 AS cval_part_p_size_0#5858, cval_part_p_container#5842 AS cval_part_p_container_0#5859, cval_part_p_retailprice#5843 AS cval_part_p_retailprice_0#5860, cval_part_p_comment#5844 AS cval_part_p_comment_0#5861, cval_part_p_brand#5845 AS cval_part_p_brand_0#5862, cp_name#5846 AS cp_name_0#5863, cp_mfgr#5847 AS cp_mfgr_0#5864, cp_type#5848 AS cp_type_0#5865, cp_size#5849 AS cp_size_0#5866, cp_container#5850 AS cp_container_0#5867, cp_retailprice#5851 AS cp_retailprice_0#5868, cp_comment#5852 AS cp_comment_0#5869, cp_brand#5853 AS cp_brand_0#5870]
            :  :  :        +- Relation[rid#5837,cval_part_p_name#5838,cval_part_p_mfgr#5839,cval_part_p_type#5840,cval_part_p_size#5841,cval_part_p_container#5842,cval_part_p_retailprice#5843,cval_part_p_comment#5844,cval_part_p_brand#5845,cp_name#5846,cp_mfgr#5847,cp_type#5848,cp_size#5849,cp_container#5850,cp_retailprice#5851,cp_comment#5852,cp_brand#5853] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- Project [rid#5927 AS rid_1#5938, cpfk_part_partsupp#5928 AS cpfk_part_partsupp_1#5939, cfpk_partsupp_part#5929 AS cfpk_partsupp_part_1#5940, cpfk_supplier_partsupp#5930 AS cpfk_supplier_partsupp_1#5941, cfpk_partsupp_supplier#5931 AS cfpk_partsupp_supplier_1#5942, cval_partsupp_ps_availqty#5932 AS cval_partsupp_ps_availqty_1#5943, cval_partsupp_ps_supplycost#5933 AS cval_partsupp_ps_supplycost_1#5944, cval_partsupp_ps_comment#5934 AS cval_partsupp_ps_comment_1#5945, cps_availqty#5935 AS cps_availqty_1#5946, cps_supplycost#5936 AS cps_supplycost_1#5947, cps_comment#5937 AS cps_comment_1#5948]
            :  :     +- Relation[rid#5927,cpfk_part_partsupp#5928,cfpk_partsupp_part#5929,cpfk_supplier_partsupp#5930,cfpk_partsupp_supplier#5931,cval_partsupp_ps_availqty#5932,cval_partsupp_ps_supplycost#5933,cval_partsupp_ps_comment#5934,cps_availqty#5935,cps_supplycost#5936,cps_comment#5937] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#5871 AS rid_1#5882, cpfk_part_partsupp#5872 AS cpfk_part_partsupp_1#5883, cfpk_partsupp_part#5873 AS cfpk_partsupp_part_1#5884, cpfk_supplier_partsupp#5874 AS cpfk_supplier_partsupp_1#5885, cfpk_partsupp_supplier#5875 AS cfpk_partsupp_supplier_1#5886, cval_partsupp_ps_availqty#5876 AS cval_partsupp_ps_availqty_1#5887, cval_partsupp_ps_supplycost#5877 AS cval_partsupp_ps_supplycost_1#5888, cval_partsupp_ps_comment#5878 AS cval_partsupp_ps_comment_1#5889, cps_availqty#5879 AS cps_availqty_1#5890, cps_supplycost#5880 AS cps_supplycost_1#5891, cps_comment#5881 AS cps_comment_1#5892]
            :     +- Relation[rid#5871,cpfk_part_partsupp#5872,cfpk_partsupp_part#5873,cpfk_supplier_partsupp#5874,cfpk_partsupp_supplier#5875,cval_partsupp_ps_availqty#5876,cval_partsupp_ps_supplycost#5877,cval_partsupp_ps_comment#5878,cps_availqty#5879,cps_supplycost#5880,cps_comment#5881] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#5949 AS rid_2#5956, cpfk_region_nation#5950 AS cpfk_region_nation_2#5957, cfpk_nation_region#5951 AS cfpk_nation_region_2#5958, cval_nation_n_name#5952 AS cval_nation_n_name_2#5959, cval_nation_n_comment#5953 AS cval_nation_n_comment_2#5960, cn_name#5954 AS cn_name_2#5961, cn_comment#5955 AS cn_comment_2#5962]
               :  :  :  +- Relation[rid#5949,cpfk_region_nation#5950,cfpk_nation_region#5951,cval_nation_n_name#5952,cval_nation_n_comment#5953,cn_name#5954,cn_comment#5955] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#5963 AS rid_2#5970, cpfk_region_nation#5964 AS cpfk_region_nation_2#5971, cfpk_nation_region#5965 AS cfpk_nation_region_2#5972, cval_nation_n_name#5966 AS cval_nation_n_name_2#5973, cval_nation_n_comment#5967 AS cval_nation_n_comment_2#5974, cn_name#5968 AS cn_name_2#5975, cn_comment#5969 AS cn_comment_2#5976]
               :  :        +- Relation[rid#5963,cpfk_region_nation#5964,cfpk_nation_region#5965,cval_nation_n_name#5966,cval_nation_n_comment#5967,cn_name#5968,cn_comment#5969] JDBCRelation(tnation) [numPartitions=1]
               :  +- Project [rid#6017 AS rid_3#6030, cpfk_nation_supplier#6018 AS cpfk_nation_supplier_3#6031, cfpk_supplier_nation#6019 AS cfpk_supplier_nation_3#6032, cval_supplier_s_name#6020 AS cval_supplier_s_name_3#6033, cval_supplier_s_address#6021 AS cval_supplier_s_address_3#6034, cval_supplier_s_phone#6022 AS cval_supplier_s_phone_3#6035, cval_supplier_s_acctbal#6023 AS cval_supplier_s_acctbal_3#6036, cval_supplier_s_comment#6024 AS cval_supplier_s_comment_3#6037, cs_name#6025 AS cs_name_3#6038, cs_address#6026 AS cs_address_3#6039, cs_phone#6027 AS cs_phone_3#6040, cs_acctbal#6028 AS cs_acctbal_3#6041, cs_comment#6029 AS cs_comment_3#6042]
               :     +- Relation[rid#6017,cpfk_nation_supplier#6018,cfpk_supplier_nation#6019,cval_supplier_s_name#6020,cval_supplier_s_address#6021,cval_supplier_s_phone#6022,cval_supplier_s_acctbal#6023,cval_supplier_s_comment#6024,cs_name#6025,cs_address#6026,cs_phone#6027,cs_acctbal#6028,cs_comment#6029] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#5977 AS rid_3#5990, cpfk_nation_supplier#5978 AS cpfk_nation_supplier_3#5991, cfpk_supplier_nation#5979 AS cfpk_supplier_nation_3#5992, cval_supplier_s_name#5980 AS cval_supplier_s_name_3#5993, cval_supplier_s_address#5981 AS cval_supplier_s_address_3#5994, cval_supplier_s_phone#5982 AS cval_supplier_s_phone_3#5995, cval_supplier_s_acctbal#5983 AS cval_supplier_s_acctbal_3#5996, cval_supplier_s_comment#5984 AS cval_supplier_s_comment_3#5997, cs_name#5985 AS cs_name_3#5998, cs_address#5986 AS cs_address_3#5999, cs_phone#5987 AS cs_phone_3#6000, cs_acctbal#5988 AS cs_acctbal_3#6001, cs_comment#5989 AS cs_comment_3#6002]
                  +- Relation[rid#5977,cpfk_nation_supplier#5978,cfpk_supplier_nation#5979,cval_supplier_s_name#5980,cval_supplier_s_address#5981,cval_supplier_s_phone#5982,cval_supplier_s_acctbal#5983,cval_supplier_s_comment#5984,cs_name#5985,cs_address#5986,cs_phone#5987,cs_acctbal#5988,cs_comment#5989] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1
Elapsed time: 766ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/15 16:47:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:47:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6095L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:47:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:47:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:47:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:47:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:47:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:47:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:47:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:47:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6095L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#6097 AS rid_0#6114, cval_part_p_name#6098 AS cval_part_p_name_0#6115, cval_part_p_mfgr#6099 AS cval_part_p_mfgr_0#6116, cval_part_p_type#6100 AS cval_part_p_type_0#6117, cval_part_p_size#6101 AS cval_part_p_size_0#6118, cval_part_p_container#6102 AS cval_part_p_container_0#6119, cval_part_p_retailprice#6103 AS cval_part_p_retailprice_0#6120, cval_part_p_comment#6104 AS cval_part_p_comment_0#6121, cval_part_p_brand#6105 AS cval_part_p_brand_0#6122, cp_name#6106 AS cp_name_0#6123, cp_mfgr#6107 AS cp_mfgr_0#6124, cp_type#6108 AS cp_type_0#6125, cp_size#6109 AS cp_size_0#6126, cp_container#6110 AS cp_container_0#6127, cp_retailprice#6111 AS cp_retailprice_0#6128, cp_comment#6112 AS cp_comment_0#6129, cp_brand#6113 AS cp_brand_0#6130]
         :  :  :  :  +- Relation[rid#6097,cval_part_p_name#6098,cval_part_p_mfgr#6099,cval_part_p_type#6100,cval_part_p_size#6101,cval_part_p_container#6102,cval_part_p_retailprice#6103,cval_part_p_comment#6104,cval_part_p_brand#6105,cp_name#6106,cp_mfgr#6107,cp_type#6108,cp_size#6109,cp_container#6110,cp_retailprice#6111,cp_comment#6112,cp_brand#6113] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#6131 AS rid_0#6148, cval_part_p_name#6132 AS cval_part_p_name_0#6149, cval_part_p_mfgr#6133 AS cval_part_p_mfgr_0#6150, cval_part_p_type#6134 AS cval_part_p_type_0#6151, cval_part_p_size#6135 AS cval_part_p_size_0#6152, cval_part_p_container#6136 AS cval_part_p_container_0#6153, cval_part_p_retailprice#6137 AS cval_part_p_retailprice_0#6154, cval_part_p_comment#6138 AS cval_part_p_comment_0#6155, cval_part_p_brand#6139 AS cval_part_p_brand_0#6156, cp_name#6140 AS cp_name_0#6157, cp_mfgr#6141 AS cp_mfgr_0#6158, cp_type#6142 AS cp_type_0#6159, cp_size#6143 AS cp_size_0#6160, cp_container#6144 AS cp_container_0#6161, cp_retailprice#6145 AS cp_retailprice_0#6162, cp_comment#6146 AS cp_comment_0#6163, cp_brand#6147 AS cp_brand_0#6164]
         :  :  :        +- Relation[rid#6131,cval_part_p_name#6132,cval_part_p_mfgr#6133,cval_part_p_type#6134,cval_part_p_size#6135,cval_part_p_container#6136,cval_part_p_retailprice#6137,cval_part_p_comment#6138,cval_part_p_brand#6139,cp_name#6140,cp_mfgr#6141,cp_type#6142,cp_size#6143,cp_container#6144,cp_retailprice#6145,cp_comment#6146,cp_brand#6147] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#6165 AS rid_0#6182, cval_part_p_name#6166 AS cval_part_p_name_0#6183, cval_part_p_mfgr#6167 AS cval_part_p_mfgr_0#6184, cval_part_p_type#6168 AS cval_part_p_type_0#6185, cval_part_p_size#6169 AS cval_part_p_size_0#6186, cval_part_p_container#6170 AS cval_part_p_container_0#6187, cval_part_p_retailprice#6171 AS cval_part_p_retailprice_0#6188, cval_part_p_comment#6172 AS cval_part_p_comment_0#6189, cval_part_p_brand#6173 AS cval_part_p_brand_0#6190, cp_name#6174 AS cp_name_0#6191, cp_mfgr#6175 AS cp_mfgr_0#6192, cp_type#6176 AS cp_type_0#6193, cp_size#6177 AS cp_size_0#6194, cp_container#6178 AS cp_container_0#6195, cp_retailprice#6179 AS cp_retailprice_0#6196, cp_comment#6180 AS cp_comment_0#6197, cp_brand#6181 AS cp_brand_0#6198]
         :  :        +- Relation[rid#6165,cval_part_p_name#6166,cval_part_p_mfgr#6167,cval_part_p_type#6168,cval_part_p_size#6169,cval_part_p_container#6170,cval_part_p_retailprice#6171,cval_part_p_comment#6172,cval_part_p_brand#6173,cp_name#6174,cp_mfgr#6175,cp_type#6176,cp_size#6177,cp_container#6178,cp_retailprice#6179,cp_comment#6180,cp_brand#6181] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#6299 AS rid_1#6332, cpfk_orders_lineitem#6300 AS cpfk_orders_lineitem_1#6333, cpfk_supplier_lineitem#6301 AS cpfk_supplier_lineitem_1#6334, cfpk_lineitem_supplier#6302 AS cfpk_lineitem_supplier_1#6335, cfpk_lineitem_partsupp#6303 AS cfpk_lineitem_partsupp_1#6336, cpfk_part_lineitem#6304 AS cpfk_part_lineitem_1#6337, cfpk_lineitem_part#6305 AS cfpk_lineitem_part_1#6338, cpfk_partsupp_lineitem#6306 AS cpfk_partsupp_lineitem_1#6339, cfpk_lineitem_orders#6307 AS cfpk_lineitem_orders_1#6340, cval_lineitem_l_quantity#6308 AS cval_lineitem_l_quantity_1#6341, cval_lineitem_l_extendedprice#6309 AS cval_lineitem_l_extendedprice_1#6342, cval_lineitem_l_discount#6310 AS cval_lineitem_l_discount_1#6343, cval_lineitem_l_tax#6311 AS cval_lineitem_l_tax_1#6344, cval_lineitem_l_returnflag#6312 AS cval_lineitem_l_returnflag_1#6345, cval_lineitem_l_linestatus#6313 AS cval_lineitem_l_linestatus_1#6346, cval_lineitem_l_commitdate#6314 AS cval_lineitem_l_commitdate_1#6347, cval_lineitem_l_receiptdate#6315 AS cval_lineitem_l_receiptdate_1#6348, cval_lineitem_l_shipinstruct#6316 AS cval_lineitem_l_shipinstruct_1#6349, cval_lineitem_l_shipmode#6317 AS cval_lineitem_l_shipmode_1#6350, cval_lineitem_l_comment#6318 AS cval_lineitem_l_comment_1#6351, cval_lineitem_l_shipdate#6319 AS cval_lineitem_l_shipdate_1#6352, cl_quantity#6320 AS cl_quantity_1#6353, cl_extendedprice#6321 AS cl_extendedprice_1#6354, cl_discount#6322 AS cl_discount_1#6355, ... 9 more fields]
         :     +- Relation[rid#6299,cpfk_orders_lineitem#6300,cpfk_supplier_lineitem#6301,cfpk_lineitem_supplier#6302,cfpk_lineitem_partsupp#6303,cpfk_part_lineitem#6304,cfpk_lineitem_part#6305,cpfk_partsupp_lineitem#6306,cfpk_lineitem_orders#6307,cval_lineitem_l_quantity#6308,cval_lineitem_l_extendedprice#6309,cval_lineitem_l_discount#6310,cval_lineitem_l_tax#6311,cval_lineitem_l_returnflag#6312,cval_lineitem_l_linestatus#6313,cval_lineitem_l_commitdate#6314,cval_lineitem_l_receiptdate#6315,cval_lineitem_l_shipinstruct#6316,cval_lineitem_l_shipmode#6317,cval_lineitem_l_comment#6318,cval_lineitem_l_shipdate#6319,cl_quantity#6320,cl_extendedprice#6321,cl_discount#6322,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6199 AS rid_1#6232, cpfk_orders_lineitem#6200 AS cpfk_orders_lineitem_1#6233, cpfk_supplier_lineitem#6201 AS cpfk_supplier_lineitem_1#6234, cfpk_lineitem_supplier#6202 AS cfpk_lineitem_supplier_1#6235, cfpk_lineitem_partsupp#6203 AS cfpk_lineitem_partsupp_1#6236, cpfk_part_lineitem#6204 AS cpfk_part_lineitem_1#6237, cfpk_lineitem_part#6205 AS cfpk_lineitem_part_1#6238, cpfk_partsupp_lineitem#6206 AS cpfk_partsupp_lineitem_1#6239, cfpk_lineitem_orders#6207 AS cfpk_lineitem_orders_1#6240, cval_lineitem_l_quantity#6208 AS cval_lineitem_l_quantity_1#6241, cval_lineitem_l_extendedprice#6209 AS cval_lineitem_l_extendedprice_1#6242, cval_lineitem_l_discount#6210 AS cval_lineitem_l_discount_1#6243, cval_lineitem_l_tax#6211 AS cval_lineitem_l_tax_1#6244, cval_lineitem_l_returnflag#6212 AS cval_lineitem_l_returnflag_1#6245, cval_lineitem_l_linestatus#6213 AS cval_lineitem_l_linestatus_1#6246, cval_lineitem_l_commitdate#6214 AS cval_lineitem_l_commitdate_1#6247, cval_lineitem_l_receiptdate#6215 AS cval_lineitem_l_receiptdate_1#6248, cval_lineitem_l_shipinstruct#6216 AS cval_lineitem_l_shipinstruct_1#6249, cval_lineitem_l_shipmode#6217 AS cval_lineitem_l_shipmode_1#6250, cval_lineitem_l_comment#6218 AS cval_lineitem_l_comment_1#6251, cval_lineitem_l_shipdate#6219 AS cval_lineitem_l_shipdate_1#6252, cl_quantity#6220 AS cl_quantity_1#6253, cl_extendedprice#6221 AS cl_extendedprice_1#6254, cl_discount#6222 AS cl_discount_1#6255, ... 9 more fields]
            +- Relation[rid#6199,cpfk_orders_lineitem#6200,cpfk_supplier_lineitem#6201,cfpk_lineitem_supplier#6202,cfpk_lineitem_partsupp#6203,cpfk_part_lineitem#6204,cfpk_lineitem_part#6205,cpfk_partsupp_lineitem#6206,cfpk_lineitem_orders#6207,cval_lineitem_l_quantity#6208,cval_lineitem_l_extendedprice#6209,cval_lineitem_l_discount#6210,cval_lineitem_l_tax#6211,cval_lineitem_l_returnflag#6212,cval_lineitem_l_linestatus#6213,cval_lineitem_l_commitdate#6214,cval_lineitem_l_receiptdate#6215,cval_lineitem_l_shipinstruct#6216,cval_lineitem_l_shipmode#6217,cval_lineitem_l_comment#6218,cval_lineitem_l_shipdate#6219,cl_quantity#6220,cl_extendedprice#6221,cl_discount#6222,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=408
Elapsed time: 414ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 16:47:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:47:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6424L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:47:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:47:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:47:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:47:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:47:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:47:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:47:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:47:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:47:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:47:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:47:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:47:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:47:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:47:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:47:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6424L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#6426 AS rid_0#6433, cpfk_region_nation#6427 AS cpfk_region_nation_0#6434, cfpk_nation_region#6428 AS cfpk_nation_region_0#6435, cval_nation_n_name#6429 AS cval_nation_n_name_0#6436, cval_nation_n_comment#6430 AS cval_nation_n_comment_0#6437, cn_name#6431 AS cn_name_0#6438, cn_comment#6432 AS cn_comment_0#6439]
            :  :  :     :  :  :  :  :  +- Relation[rid#6426,cpfk_region_nation#6427,cfpk_nation_region#6428,cval_nation_n_name#6429,cval_nation_n_comment#6430,cn_name#6431,cn_comment#6432] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#6466 AS rid_0#6473, cpfk_region_nation#6467 AS cpfk_region_nation_0#6474, cfpk_nation_region#6468 AS cfpk_nation_region_0#6475, cval_nation_n_name#6469 AS cval_nation_n_name_0#6476, cval_nation_n_comment#6470 AS cval_nation_n_comment_0#6477, cn_name#6471 AS cn_name_0#6478, cn_comment#6472 AS cn_comment_0#6479]
            :  :  :     :  :  :  :     :  +- Relation[rid#6466,cpfk_region_nation#6467,cfpk_nation_region#6468,cval_nation_n_name#6469,cval_nation_n_comment#6470,cn_name#6471,cn_comment#6472] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#6480 AS rid_1#6493, cpfk_nation_supplier#6481 AS cpfk_nation_supplier_1#6494, cfpk_supplier_nation#6482 AS cfpk_supplier_nation_1#6495, cval_supplier_s_name#6483 AS cval_supplier_s_name_1#6496, cval_supplier_s_address#6484 AS cval_supplier_s_address_1#6497, cval_supplier_s_phone#6485 AS cval_supplier_s_phone_1#6498, cval_supplier_s_acctbal#6486 AS cval_supplier_s_acctbal_1#6499, cval_supplier_s_comment#6487 AS cval_supplier_s_comment_1#6500, cs_name#6488 AS cs_name_1#6501, cs_address#6489 AS cs_address_1#6502, cs_phone#6490 AS cs_phone_1#6503, cs_acctbal#6491 AS cs_acctbal_1#6504, cs_comment#6492 AS cs_comment_1#6505]
            :  :  :     :  :  :  :        +- Relation[rid#6480,cpfk_nation_supplier#6481,cfpk_supplier_nation#6482,cval_supplier_s_name#6483,cval_supplier_s_address#6484,cval_supplier_s_phone#6485,cval_supplier_s_acctbal#6486,cval_supplier_s_comment#6487,cs_name#6488,cs_address#6489,cs_phone#6490,cs_acctbal#6491,cs_comment#6492] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#6440 AS rid_1#6453, cpfk_nation_supplier#6441 AS cpfk_nation_supplier_1#6454, cfpk_supplier_nation#6442 AS cfpk_supplier_nation_1#6455, cval_supplier_s_name#6443 AS cval_supplier_s_name_1#6456, cval_supplier_s_address#6444 AS cval_supplier_s_address_1#6457, cval_supplier_s_phone#6445 AS cval_supplier_s_phone_1#6458, cval_supplier_s_acctbal#6446 AS cval_supplier_s_acctbal_1#6459, cval_supplier_s_comment#6447 AS cval_supplier_s_comment_1#6460, cs_name#6448 AS cs_name_1#6461, cs_address#6449 AS cs_address_1#6462, cs_phone#6450 AS cs_phone_1#6463, cs_acctbal#6451 AS cs_acctbal_1#6464, cs_comment#6452 AS cs_comment_1#6465]
            :  :  :     :  :  :     +- Relation[rid#6440,cpfk_nation_supplier#6441,cfpk_supplier_nation#6442,cval_supplier_s_name#6443,cval_supplier_s_address#6444,cval_supplier_s_phone#6445,cval_supplier_s_acctbal#6446,cval_supplier_s_comment#6447,cs_name#6448,cs_address#6449,cs_phone#6450,cs_acctbal#6451,cs_comment#6452] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#6528 AS rid_1#6541, cpfk_nation_supplier#6529 AS cpfk_nation_supplier_1#6542, cfpk_supplier_nation#6530 AS cfpk_supplier_nation_1#6543, cval_supplier_s_name#6531 AS cval_supplier_s_name_1#6544, cval_supplier_s_address#6532 AS cval_supplier_s_address_1#6545, cval_supplier_s_phone#6533 AS cval_supplier_s_phone_1#6546, cval_supplier_s_acctbal#6534 AS cval_supplier_s_acctbal_1#6547, cval_supplier_s_comment#6535 AS cval_supplier_s_comment_1#6548, cs_name#6536 AS cs_name_1#6549, cs_address#6537 AS cs_address_1#6550, cs_phone#6538 AS cs_phone_1#6551, cs_acctbal#6539 AS cs_acctbal_1#6552, cs_comment#6540 AS cs_comment_1#6553]
            :  :  :     :  :     :  +- Relation[rid#6528,cpfk_nation_supplier#6529,cfpk_supplier_nation#6530,cval_supplier_s_name#6531,cval_supplier_s_address#6532,cval_supplier_s_phone#6533,cval_supplier_s_acctbal#6534,cval_supplier_s_comment#6535,cs_name#6536,cs_address#6537,cs_phone#6538,cs_acctbal#6539,cs_comment#6540] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#6554 AS rid_2#6565, cpfk_part_partsupp#6555 AS cpfk_part_partsupp_2#6566, cfpk_partsupp_part#6556 AS cfpk_partsupp_part_2#6567, cpfk_supplier_partsupp#6557 AS cpfk_supplier_partsupp_2#6568, cfpk_partsupp_supplier#6558 AS cfpk_partsupp_supplier_2#6569, cval_partsupp_ps_availqty#6559 AS cval_partsupp_ps_availqty_2#6570, cval_partsupp_ps_supplycost#6560 AS cval_partsupp_ps_supplycost_2#6571, cval_partsupp_ps_comment#6561 AS cval_partsupp_ps_comment_2#6572, cps_availqty#6562 AS cps_availqty_2#6573, cps_supplycost#6563 AS cps_supplycost_2#6574, cps_comment#6564 AS cps_comment_2#6575]
            :  :  :     :  :        +- Relation[rid#6554,cpfk_part_partsupp#6555,cfpk_partsupp_part#6556,cpfk_supplier_partsupp#6557,cfpk_partsupp_supplier#6558,cval_partsupp_ps_availqty#6559,cval_partsupp_ps_supplycost#6560,cval_partsupp_ps_comment#6561,cps_availqty#6562,cps_supplycost#6563,cps_comment#6564] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#6506 AS rid_2#6517, cpfk_part_partsupp#6507 AS cpfk_part_partsupp_2#6518, cfpk_partsupp_part#6508 AS cfpk_partsupp_part_2#6519, cpfk_supplier_partsupp#6509 AS cpfk_supplier_partsupp_2#6520, cfpk_partsupp_supplier#6510 AS cfpk_partsupp_supplier_2#6521, cval_partsupp_ps_availqty#6511 AS cval_partsupp_ps_availqty_2#6522, cval_partsupp_ps_supplycost#6512 AS cval_partsupp_ps_supplycost_2#6523, cval_partsupp_ps_comment#6513 AS cval_partsupp_ps_comment_2#6524, cps_availqty#6514 AS cps_availqty_2#6525, cps_supplycost#6515 AS cps_supplycost_2#6526, cps_comment#6516 AS cps_comment_2#6527]
            :  :  :     :     +- Relation[rid#6506,cpfk_part_partsupp#6507,cfpk_partsupp_part#6508,cpfk_supplier_partsupp#6509,cfpk_partsupp_supplier#6510,cval_partsupp_ps_availqty#6511,cval_partsupp_ps_supplycost#6512,cval_partsupp_ps_comment#6513,cps_availqty#6514,cps_supplycost#6515,cps_comment#6516] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#6576 AS rid_3#6593, cval_part_p_name#6577 AS cval_part_p_name_3#6594, cval_part_p_mfgr#6578 AS cval_part_p_mfgr_3#6595, cval_part_p_type#6579 AS cval_part_p_type_3#6596, cval_part_p_size#6580 AS cval_part_p_size_3#6597, cval_part_p_container#6581 AS cval_part_p_container_3#6598, cval_part_p_retailprice#6582 AS cval_part_p_retailprice_3#6599, cval_part_p_comment#6583 AS cval_part_p_comment_3#6600, cval_part_p_brand#6584 AS cval_part_p_brand_3#6601, cp_name#6585 AS cp_name_3#6602, cp_mfgr#6586 AS cp_mfgr_3#6603, cp_type#6587 AS cp_type_3#6604, cp_size#6588 AS cp_size_3#6605, cp_container#6589 AS cp_container_3#6606, cp_retailprice#6590 AS cp_retailprice_3#6607, cp_comment#6591 AS cp_comment_3#6608, cp_brand#6592 AS cp_brand_3#6609]
            :  :  :        +- Relation[rid#6576,cval_part_p_name#6577,cval_part_p_mfgr#6578,cval_part_p_type#6579,cval_part_p_size#6580,cval_part_p_container#6581,cval_part_p_retailprice#6582,cval_part_p_comment#6583,cval_part_p_brand#6584,cp_name#6585,cp_mfgr#6586,cp_type#6587,cp_size#6588,cp_container#6589,cp_retailprice#6590,cp_comment#6591,cp_brand#6592] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#6676 AS rid_2#6687, cpfk_part_partsupp#6677 AS cpfk_part_partsupp_2#6688, cfpk_partsupp_part#6678 AS cfpk_partsupp_part_2#6689, cpfk_supplier_partsupp#6679 AS cpfk_supplier_partsupp_2#6690, cfpk_partsupp_supplier#6680 AS cfpk_partsupp_supplier_2#6691, cval_partsupp_ps_availqty#6681 AS cval_partsupp_ps_availqty_2#6692, cval_partsupp_ps_supplycost#6682 AS cval_partsupp_ps_supplycost_2#6693, cval_partsupp_ps_comment#6683 AS cval_partsupp_ps_comment_2#6694, cps_availqty#6684 AS cps_availqty_2#6695, cps_supplycost#6685 AS cps_supplycost_2#6696, cps_comment#6686 AS cps_comment_2#6697]
            :  :     :  +- Relation[rid#6676,cpfk_part_partsupp#6677,cfpk_partsupp_part#6678,cpfk_supplier_partsupp#6679,cfpk_partsupp_supplier#6680,cval_partsupp_ps_availqty#6681,cval_partsupp_ps_supplycost#6682,cval_partsupp_ps_comment#6683,cps_availqty#6684,cps_supplycost#6685,cps_comment#6686] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#6698 AS rid_4#6731, cpfk_orders_lineitem#6699 AS cpfk_orders_lineitem_4#6732, cpfk_supplier_lineitem#6700 AS cpfk_supplier_lineitem_4#6733, cfpk_lineitem_supplier#6701 AS cfpk_lineitem_supplier_4#6734, cfpk_lineitem_partsupp#6702 AS cfpk_lineitem_partsupp_4#6735, cpfk_part_lineitem#6703 AS cpfk_part_lineitem_4#6736, cfpk_lineitem_part#6704 AS cfpk_lineitem_part_4#6737, cpfk_partsupp_lineitem#6705 AS cpfk_partsupp_lineitem_4#6738, cfpk_lineitem_orders#6706 AS cfpk_lineitem_orders_4#6739, cval_lineitem_l_quantity#6707 AS cval_lineitem_l_quantity_4#6740, cval_lineitem_l_extendedprice#6708 AS cval_lineitem_l_extendedprice_4#6741, cval_lineitem_l_discount#6709 AS cval_lineitem_l_discount_4#6742, cval_lineitem_l_tax#6710 AS cval_lineitem_l_tax_4#6743, cval_lineitem_l_returnflag#6711 AS cval_lineitem_l_returnflag_4#6744, cval_lineitem_l_linestatus#6712 AS cval_lineitem_l_linestatus_4#6745, cval_lineitem_l_commitdate#6713 AS cval_lineitem_l_commitdate_4#6746, cval_lineitem_l_receiptdate#6714 AS cval_lineitem_l_receiptdate_4#6747, cval_lineitem_l_shipinstruct#6715 AS cval_lineitem_l_shipinstruct_4#6748, cval_lineitem_l_shipmode#6716 AS cval_lineitem_l_shipmode_4#6749, cval_lineitem_l_comment#6717 AS cval_lineitem_l_comment_4#6750, cval_lineitem_l_shipdate#6718 AS cval_lineitem_l_shipdate_4#6751, cl_quantity#6719 AS cl_quantity_4#6752, cl_extendedprice#6720 AS cl_extendedprice_4#6753, cl_discount#6721 AS cl_discount_4#6754, ... 9 more fields]
            :  :        +- Relation[rid#6698,cpfk_orders_lineitem#6699,cpfk_supplier_lineitem#6700,cfpk_lineitem_supplier#6701,cfpk_lineitem_partsupp#6702,cpfk_part_lineitem#6703,cfpk_lineitem_part#6704,cpfk_partsupp_lineitem#6705,cfpk_lineitem_orders#6706,cval_lineitem_l_quantity#6707,cval_lineitem_l_extendedprice#6708,cval_lineitem_l_discount#6709,cval_lineitem_l_tax#6710,cval_lineitem_l_returnflag#6711,cval_lineitem_l_linestatus#6712,cval_lineitem_l_commitdate#6713,cval_lineitem_l_receiptdate#6714,cval_lineitem_l_shipinstruct#6715,cval_lineitem_l_shipmode#6716,cval_lineitem_l_comment#6717,cval_lineitem_l_shipdate#6718,cl_quantity#6719,cl_extendedprice#6720,cl_discount#6721,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#6610 AS rid_4#6643, cpfk_orders_lineitem#6611 AS cpfk_orders_lineitem_4#6644, cpfk_supplier_lineitem#6612 AS cpfk_supplier_lineitem_4#6645, cfpk_lineitem_supplier#6613 AS cfpk_lineitem_supplier_4#6646, cfpk_lineitem_partsupp#6614 AS cfpk_lineitem_partsupp_4#6647, cpfk_part_lineitem#6615 AS cpfk_part_lineitem_4#6648, cfpk_lineitem_part#6616 AS cfpk_lineitem_part_4#6649, cpfk_partsupp_lineitem#6617 AS cpfk_partsupp_lineitem_4#6650, cfpk_lineitem_orders#6618 AS cfpk_lineitem_orders_4#6651, cval_lineitem_l_quantity#6619 AS cval_lineitem_l_quantity_4#6652, cval_lineitem_l_extendedprice#6620 AS cval_lineitem_l_extendedprice_4#6653, cval_lineitem_l_discount#6621 AS cval_lineitem_l_discount_4#6654, cval_lineitem_l_tax#6622 AS cval_lineitem_l_tax_4#6655, cval_lineitem_l_returnflag#6623 AS cval_lineitem_l_returnflag_4#6656, cval_lineitem_l_linestatus#6624 AS cval_lineitem_l_linestatus_4#6657, cval_lineitem_l_commitdate#6625 AS cval_lineitem_l_commitdate_4#6658, cval_lineitem_l_receiptdate#6626 AS cval_lineitem_l_receiptdate_4#6659, cval_lineitem_l_shipinstruct#6627 AS cval_lineitem_l_shipinstruct_4#6660, cval_lineitem_l_shipmode#6628 AS cval_lineitem_l_shipmode_4#6661, cval_lineitem_l_comment#6629 AS cval_lineitem_l_comment_4#6662, cval_lineitem_l_shipdate#6630 AS cval_lineitem_l_shipdate_4#6663, cl_quantity#6631 AS cl_quantity_4#6664, cl_extendedprice#6632 AS cl_extendedprice_4#6665, cl_discount#6633 AS cl_discount_4#6666, ... 9 more fields]
            :     +- Relation[rid#6610,cpfk_orders_lineitem#6611,cpfk_supplier_lineitem#6612,cfpk_lineitem_supplier#6613,cfpk_lineitem_partsupp#6614,cpfk_part_lineitem#6615,cfpk_lineitem_part#6616,cpfk_partsupp_lineitem#6617,cfpk_lineitem_orders#6618,cval_lineitem_l_quantity#6619,cval_lineitem_l_extendedprice#6620,cval_lineitem_l_discount#6621,cval_lineitem_l_tax#6622,cval_lineitem_l_returnflag#6623,cval_lineitem_l_linestatus#6624,cval_lineitem_l_commitdate#6625,cval_lineitem_l_receiptdate#6626,cval_lineitem_l_shipinstruct#6627,cval_lineitem_l_shipmode#6628,cval_lineitem_l_comment#6629,cval_lineitem_l_shipdate#6630,cl_quantity#6631,cl_extendedprice#6632,cl_discount#6633,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#6764 AS rid_5#6781, cpfk_customer_orders#6765 AS cpfk_customer_orders_5#6782, cfpk_orders_customer#6766 AS cfpk_orders_customer_5#6783, cval_orders_o_orderstatus#6767 AS cval_orders_o_orderstatus_5#6784, cval_orders_o_totalprice#6768 AS cval_orders_o_totalprice_5#6785, cval_orders_o_orderpriority#6769 AS cval_orders_o_orderpriority_5#6786, cval_orders_o_clerk#6770 AS cval_orders_o_clerk_5#6787, cval_orders_o_shippriority#6771 AS cval_orders_o_shippriority_5#6788, cval_orders_o_comment#6772 AS cval_orders_o_comment_5#6789, cval_orders_o_orderdate#6773 AS cval_orders_o_orderdate_5#6790, co_orderstatus#6774 AS co_orderstatus_5#6791, co_totalprice#6775 AS co_totalprice_5#6792, co_orderpriority#6776 AS co_orderpriority_5#6793, co_clerk#6777 AS co_clerk_5#6794, co_shippriority#6778 AS co_shippriority_5#6795, co_comment#6779 AS co_comment_5#6796, co_orderdate#6780 AS co_orderdate_5#6797]
               +- Relation[rid#6764,cpfk_customer_orders#6765,cfpk_orders_customer#6766,cval_orders_o_orderstatus#6767,cval_orders_o_totalprice#6768,cval_orders_o_orderpriority#6769,cval_orders_o_clerk#6770,cval_orders_o_shippriority#6771,cval_orders_o_comment#6772,cval_orders_o_orderdate#6773,co_orderstatus#6774,co_totalprice#6775,co_orderpriority#6776,co_clerk#6777,co_shippriority#6778,co_comment#6779,co_orderdate#6780] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 181888ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/15 16:50:45 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:50:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6924L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:50:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6924L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#6926 AS rid_0#6959, cpfk_orders_lineitem#6927 AS cpfk_orders_lineitem_0#6960, cpfk_supplier_lineitem#6928 AS cpfk_supplier_lineitem_0#6961, cfpk_lineitem_supplier#6929 AS cfpk_lineitem_supplier_0#6962, cfpk_lineitem_partsupp#6930 AS cfpk_lineitem_partsupp_0#6963, cpfk_part_lineitem#6931 AS cpfk_part_lineitem_0#6964, cfpk_lineitem_part#6932 AS cfpk_lineitem_part_0#6965, cpfk_partsupp_lineitem#6933 AS cpfk_partsupp_lineitem_0#6966, cfpk_lineitem_orders#6934 AS cfpk_lineitem_orders_0#6967, cval_lineitem_l_quantity#6935 AS cval_lineitem_l_quantity_0#6968, cval_lineitem_l_extendedprice#6936 AS cval_lineitem_l_extendedprice_0#6969, cval_lineitem_l_discount#6937 AS cval_lineitem_l_discount_0#6970, cval_lineitem_l_tax#6938 AS cval_lineitem_l_tax_0#6971, cval_lineitem_l_returnflag#6939 AS cval_lineitem_l_returnflag_0#6972, cval_lineitem_l_linestatus#6940 AS cval_lineitem_l_linestatus_0#6973, cval_lineitem_l_commitdate#6941 AS cval_lineitem_l_commitdate_0#6974, cval_lineitem_l_receiptdate#6942 AS cval_lineitem_l_receiptdate_0#6975, cval_lineitem_l_shipinstruct#6943 AS cval_lineitem_l_shipinstruct_0#6976, cval_lineitem_l_shipmode#6944 AS cval_lineitem_l_shipmode_0#6977, cval_lineitem_l_comment#6945 AS cval_lineitem_l_comment_0#6978, cval_lineitem_l_shipdate#6946 AS cval_lineitem_l_shipdate_0#6979, cl_quantity#6947 AS cl_quantity_0#6980, cl_extendedprice#6948 AS cl_extendedprice_0#6981, cl_discount#6949 AS cl_discount_0#6982, ... 9 more fields]
            :  +- Relation[rid#6926,cpfk_orders_lineitem#6927,cpfk_supplier_lineitem#6928,cfpk_lineitem_supplier#6929,cfpk_lineitem_partsupp#6930,cpfk_part_lineitem#6931,cfpk_lineitem_part#6932,cpfk_partsupp_lineitem#6933,cfpk_lineitem_orders#6934,cval_lineitem_l_quantity#6935,cval_lineitem_l_extendedprice#6936,cval_lineitem_l_discount#6937,cval_lineitem_l_tax#6938,cval_lineitem_l_returnflag#6939,cval_lineitem_l_linestatus#6940,cval_lineitem_l_commitdate#6941,cval_lineitem_l_receiptdate#6942,cval_lineitem_l_shipinstruct#6943,cval_lineitem_l_shipmode#6944,cval_lineitem_l_comment#6945,cval_lineitem_l_shipdate#6946,cl_quantity#6947,cl_extendedprice#6948,cl_discount#6949,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#6992 AS rid_1#7009, cpfk_customer_orders#6993 AS cpfk_customer_orders_1#7010, cfpk_orders_customer#6994 AS cfpk_orders_customer_1#7011, cval_orders_o_orderstatus#6995 AS cval_orders_o_orderstatus_1#7012, cval_orders_o_totalprice#6996 AS cval_orders_o_totalprice_1#7013, cval_orders_o_orderpriority#6997 AS cval_orders_o_orderpriority_1#7014, cval_orders_o_clerk#6998 AS cval_orders_o_clerk_1#7015, cval_orders_o_shippriority#6999 AS cval_orders_o_shippriority_1#7016, cval_orders_o_comment#7000 AS cval_orders_o_comment_1#7017, cval_orders_o_orderdate#7001 AS cval_orders_o_orderdate_1#7018, co_orderstatus#7002 AS co_orderstatus_1#7019, co_totalprice#7003 AS co_totalprice_1#7020, co_orderpriority#7004 AS co_orderpriority_1#7021, co_clerk#7005 AS co_clerk_1#7022, co_shippriority#7006 AS co_shippriority_1#7023, co_comment#7007 AS co_comment_1#7024, co_orderdate#7008 AS co_orderdate_1#7025]
               +- Relation[rid#6992,cpfk_customer_orders#6993,cfpk_orders_customer#6994,cval_orders_o_orderstatus#6995,cval_orders_o_totalprice#6996,cval_orders_o_orderpriority#6997,cval_orders_o_clerk#6998,cval_orders_o_shippriority#6999,cval_orders_o_comment#7000,cval_orders_o_orderdate#7001,co_orderstatus#7002,co_totalprice#7003,co_orderpriority#7004,co_clerk#7005,co_shippriority#7006,co_comment#7007,co_orderdate#7008] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 56905ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/15 16:51:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:51:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7080L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:51:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:51:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7080L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#7082 AS rid_0#7087, cval_region_r_name#7083 AS cval_region_r_name_0#7088, cval_region_r_comment#7084 AS cval_region_r_comment_0#7089, cr_name#7085 AS cr_name_0#7090, cr_comment#7086 AS cr_comment_0#7091]
         :  :  :  :  :  :  :  +- Relation[rid#7082,cval_region_r_name#7083,cval_region_r_comment#7084,cr_name#7085,cr_comment#7086] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#7092 AS rid_0#7097, cval_region_r_name#7093 AS cval_region_r_name_0#7098, cval_region_r_comment#7094 AS cval_region_r_comment_0#7099, cr_name#7095 AS cr_name_0#7100, cr_comment#7096 AS cr_comment_0#7101]
         :  :  :  :  :  :        +- Relation[rid#7092,cval_region_r_name#7093,cval_region_r_comment#7094,cr_name#7095,cr_comment#7096] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- Project [rid#7126 AS rid_1#7133, cpfk_region_nation#7127 AS cpfk_region_nation_1#7134, cfpk_nation_region#7128 AS cfpk_nation_region_1#7135, cval_nation_n_name#7129 AS cval_nation_n_name_1#7136, cval_nation_n_comment#7130 AS cval_nation_n_comment_1#7137, cn_name#7131 AS cn_name_1#7138, cn_comment#7132 AS cn_comment_1#7139]
         :  :  :  :  :     +- Relation[rid#7126,cpfk_region_nation#7127,cfpk_nation_region#7128,cval_nation_n_name#7129,cval_nation_n_comment#7130,cn_name#7131,cn_comment#7132] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#7102 AS rid_1#7109, cpfk_region_nation#7103 AS cpfk_region_nation_1#7110, cfpk_nation_region#7104 AS cfpk_nation_region_1#7111, cval_nation_n_name#7105 AS cval_nation_n_name_1#7112, cval_nation_n_comment#7106 AS cval_nation_n_comment_1#7113, cn_name#7107 AS cn_name_1#7114, cn_comment#7108 AS cn_comment_1#7115]
         :  :  :  :     +- Relation[rid#7102,cpfk_region_nation#7103,cfpk_nation_region#7104,cval_nation_n_name#7105,cval_nation_n_comment#7106,cn_name#7107,cn_comment#7108] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#7180 AS rid_2#7193, cpfk_nation_supplier#7181 AS cpfk_nation_supplier_2#7194, cfpk_supplier_nation#7182 AS cfpk_supplier_nation_2#7195, cval_supplier_s_name#7183 AS cval_supplier_s_name_2#7196, cval_supplier_s_address#7184 AS cval_supplier_s_address_2#7197, cval_supplier_s_phone#7185 AS cval_supplier_s_phone_2#7198, cval_supplier_s_acctbal#7186 AS cval_supplier_s_acctbal_2#7199, cval_supplier_s_comment#7187 AS cval_supplier_s_comment_2#7200, cs_name#7188 AS cs_name_2#7201, cs_address#7189 AS cs_address_2#7202, cs_phone#7190 AS cs_phone_2#7203, cs_acctbal#7191 AS cs_acctbal_2#7204, cs_comment#7192 AS cs_comment_2#7205]
         :  :  :     +- Relation[rid#7180,cpfk_nation_supplier#7181,cfpk_supplier_nation#7182,cval_supplier_s_name#7183,cval_supplier_s_address#7184,cval_supplier_s_phone#7185,cval_supplier_s_acctbal#7186,cval_supplier_s_comment#7187,cs_name#7188,cs_address#7189,cs_phone#7190,cs_acctbal#7191,cs_comment#7192] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#7140 AS rid_2#7153, cpfk_nation_supplier#7141 AS cpfk_nation_supplier_2#7154, cfpk_supplier_nation#7142 AS cfpk_supplier_nation_2#7155, cval_supplier_s_name#7143 AS cval_supplier_s_name_2#7156, cval_supplier_s_address#7144 AS cval_supplier_s_address_2#7157, cval_supplier_s_phone#7145 AS cval_supplier_s_phone_2#7158, cval_supplier_s_acctbal#7146 AS cval_supplier_s_acctbal_2#7159, cval_supplier_s_comment#7147 AS cval_supplier_s_comment_2#7160, cs_name#7148 AS cs_name_2#7161, cs_address#7149 AS cs_address_2#7162, cs_phone#7150 AS cs_phone_2#7163, cs_acctbal#7151 AS cs_acctbal_2#7164, cs_comment#7152 AS cs_comment_2#7165]
         :  :     +- Relation[rid#7140,cpfk_nation_supplier#7141,cfpk_supplier_nation#7142,cval_supplier_s_name#7143,cval_supplier_s_address#7144,cval_supplier_s_phone#7145,cval_supplier_s_acctbal#7146,cval_supplier_s_comment#7147,cs_name#7148,cs_address#7149,cs_phone#7150,cs_acctbal#7151,cs_comment#7152] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#7378 AS rid_4#7389, cpfk_part_partsupp#7379 AS cpfk_part_partsupp_4#7390, cfpk_partsupp_part#7380 AS cfpk_partsupp_part_4#7391, cpfk_supplier_partsupp#7381 AS cpfk_supplier_partsupp_4#7392, cfpk_partsupp_supplier#7382 AS cfpk_partsupp_supplier_4#7393, cval_partsupp_ps_availqty#7383 AS cval_partsupp_ps_availqty_4#7394, cval_partsupp_ps_supplycost#7384 AS cval_partsupp_ps_supplycost_4#7395, cval_partsupp_ps_comment#7385 AS cval_partsupp_ps_comment_4#7396, cps_availqty#7386 AS cps_availqty_4#7397, cps_supplycost#7387 AS cps_supplycost_4#7398, cps_comment#7388 AS cps_comment_4#7399]
         :     +- Relation[rid#7378,cpfk_part_partsupp#7379,cfpk_partsupp_part#7380,cpfk_supplier_partsupp#7381,cfpk_partsupp_supplier#7382,cval_partsupp_ps_availqty#7383,cval_partsupp_ps_supplycost#7384,cval_partsupp_ps_comment#7385,cps_availqty#7386,cps_supplycost#7387,cps_comment#7388] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#7206 AS rid_3#7223, cval_part_p_name#7207 AS cval_part_p_name_3#7224, cval_part_p_mfgr#7208 AS cval_part_p_mfgr_3#7225, cval_part_p_type#7209 AS cval_part_p_type_3#7226, cval_part_p_size#7210 AS cval_part_p_size_3#7227, cval_part_p_container#7211 AS cval_part_p_container_3#7228, cval_part_p_retailprice#7212 AS cval_part_p_retailprice_3#7229, cval_part_p_comment#7213 AS cval_part_p_comment_3#7230, cval_part_p_brand#7214 AS cval_part_p_brand_3#7231, cp_name#7215 AS cp_name_3#7232, cp_mfgr#7216 AS cp_mfgr_3#7233, cp_type#7217 AS cp_type_3#7234, cp_size#7218 AS cp_size_3#7235, cp_container#7219 AS cp_container_3#7236, cp_retailprice#7220 AS cp_retailprice_3#7237, cp_comment#7221 AS cp_comment_3#7238, cp_brand#7222 AS cp_brand_3#7239]
            :  :  :  +- Relation[rid#7206,cval_part_p_name#7207,cval_part_p_mfgr#7208,cval_part_p_type#7209,cval_part_p_size#7210,cval_part_p_container#7211,cval_part_p_retailprice#7212,cval_part_p_comment#7213,cval_part_p_brand#7214,cp_name#7215,cp_mfgr#7216,cp_type#7217,cp_size#7218,cp_container#7219,cp_retailprice#7220,cp_comment#7221,cp_brand#7222] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#7240 AS rid_3#7257, cval_part_p_name#7241 AS cval_part_p_name_3#7258, cval_part_p_mfgr#7242 AS cval_part_p_mfgr_3#7259, cval_part_p_type#7243 AS cval_part_p_type_3#7260, cval_part_p_size#7244 AS cval_part_p_size_3#7261, cval_part_p_container#7245 AS cval_part_p_container_3#7262, cval_part_p_retailprice#7246 AS cval_part_p_retailprice_3#7263, cval_part_p_comment#7247 AS cval_part_p_comment_3#7264, cval_part_p_brand#7248 AS cval_part_p_brand_3#7265, cp_name#7249 AS cp_name_3#7266, cp_mfgr#7250 AS cp_mfgr_3#7267, cp_type#7251 AS cp_type_3#7268, cp_size#7252 AS cp_size_3#7269, cp_container#7253 AS cp_container_3#7270, cp_retailprice#7254 AS cp_retailprice_3#7271, cp_comment#7255 AS cp_comment_3#7272, cp_brand#7256 AS cp_brand_3#7273]
            :  :        +- Relation[rid#7240,cval_part_p_name#7241,cval_part_p_mfgr#7242,cval_part_p_type#7243,cval_part_p_size#7244,cval_part_p_container#7245,cval_part_p_retailprice#7246,cval_part_p_comment#7247,cval_part_p_brand#7248,cp_name#7249,cp_mfgr#7250,cp_type#7251,cp_size#7252,cp_container#7253,cp_retailprice#7254,cp_comment#7255,cp_brand#7256] JDBCRelation(tpart) [numPartitions=1]
            :  +- Project [rid#7330 AS rid_4#7341, cpfk_part_partsupp#7331 AS cpfk_part_partsupp_4#7342, cfpk_partsupp_part#7332 AS cfpk_partsupp_part_4#7343, cpfk_supplier_partsupp#7333 AS cpfk_supplier_partsupp_4#7344, cfpk_partsupp_supplier#7334 AS cfpk_partsupp_supplier_4#7345, cval_partsupp_ps_availqty#7335 AS cval_partsupp_ps_availqty_4#7346, cval_partsupp_ps_supplycost#7336 AS cval_partsupp_ps_supplycost_4#7347, cval_partsupp_ps_comment#7337 AS cval_partsupp_ps_comment_4#7348, cps_availqty#7338 AS cps_availqty_4#7349, cps_supplycost#7339 AS cps_supplycost_4#7350, cps_comment#7340 AS cps_comment_4#7351]
            :     +- Relation[rid#7330,cpfk_part_partsupp#7331,cfpk_partsupp_part#7332,cpfk_supplier_partsupp#7333,cfpk_partsupp_supplier#7334,cval_partsupp_ps_availqty#7335,cval_partsupp_ps_supplycost#7336,cval_partsupp_ps_comment#7337,cps_availqty#7338,cps_supplycost#7339,cps_comment#7340] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#7274 AS rid_4#7285, cpfk_part_partsupp#7275 AS cpfk_part_partsupp_4#7286, cfpk_partsupp_part#7276 AS cfpk_partsupp_part_4#7287, cpfk_supplier_partsupp#7277 AS cpfk_supplier_partsupp_4#7288, cfpk_partsupp_supplier#7278 AS cfpk_partsupp_supplier_4#7289, cval_partsupp_ps_availqty#7279 AS cval_partsupp_ps_availqty_4#7290, cval_partsupp_ps_supplycost#7280 AS cval_partsupp_ps_supplycost_4#7291, cval_partsupp_ps_comment#7281 AS cval_partsupp_ps_comment_4#7292, cps_availqty#7282 AS cps_availqty_4#7293, cps_supplycost#7283 AS cps_supplycost_4#7294, cps_comment#7284 AS cps_comment_4#7295]
               +- Relation[rid#7274,cpfk_part_partsupp#7275,cfpk_partsupp_part#7276,cpfk_supplier_partsupp#7277,cfpk_partsupp_supplier#7278,cval_partsupp_ps_availqty#7279,cval_partsupp_ps_supplycost#7280,cval_partsupp_ps_comment#7281,cps_availqty#7282,cps_supplycost#7283,cps_comment#7284] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 1476ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/15 16:51:44 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:51:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7461L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:51:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7461L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#7463 AS rid_0#7470, cpfk_region_nation#7464 AS cpfk_region_nation_0#7471, cfpk_nation_region#7465 AS cfpk_nation_region_0#7472, cval_nation_n_name#7466 AS cval_nation_n_name_0#7473, cval_nation_n_comment#7467 AS cval_nation_n_comment_0#7474, cn_name#7468 AS cn_name_0#7475, cn_comment#7469 AS cn_comment_0#7476]
            :  :  :  :  :  :  +- Relation[rid#7463,cpfk_region_nation#7464,cfpk_nation_region#7465,cval_nation_n_name#7466,cval_nation_n_comment#7467,cn_name#7468,cn_comment#7469] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#7477 AS rid_0#7484, cpfk_region_nation#7478 AS cpfk_region_nation_0#7485, cfpk_nation_region#7479 AS cfpk_nation_region_0#7486, cval_nation_n_name#7480 AS cval_nation_n_name_0#7487, cval_nation_n_comment#7481 AS cval_nation_n_comment_0#7488, cn_name#7482 AS cn_name_0#7489, cn_comment#7483 AS cn_comment_0#7490]
            :  :  :  :  :        +- Relation[rid#7477,cpfk_region_nation#7478,cfpk_nation_region#7479,cval_nation_n_name#7480,cval_nation_n_comment#7481,cn_name#7482,cn_comment#7483] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- Project [rid#7531 AS rid_1#7544, cpfk_nation_supplier#7532 AS cpfk_nation_supplier_1#7545, cfpk_supplier_nation#7533 AS cfpk_supplier_nation_1#7546, cval_supplier_s_name#7534 AS cval_supplier_s_name_1#7547, cval_supplier_s_address#7535 AS cval_supplier_s_address_1#7548, cval_supplier_s_phone#7536 AS cval_supplier_s_phone_1#7549, cval_supplier_s_acctbal#7537 AS cval_supplier_s_acctbal_1#7550, cval_supplier_s_comment#7538 AS cval_supplier_s_comment_1#7551, cs_name#7539 AS cs_name_1#7552, cs_address#7540 AS cs_address_1#7553, cs_phone#7541 AS cs_phone_1#7554, cs_acctbal#7542 AS cs_acctbal_1#7555, cs_comment#7543 AS cs_comment_1#7556]
            :  :  :  :     +- Relation[rid#7531,cpfk_nation_supplier#7532,cfpk_supplier_nation#7533,cval_supplier_s_name#7534,cval_supplier_s_address#7535,cval_supplier_s_phone#7536,cval_supplier_s_acctbal#7537,cval_supplier_s_comment#7538,cs_name#7539,cs_address#7540,cs_phone#7541,cs_acctbal#7542,cs_comment#7543] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#7491 AS rid_1#7504, cpfk_nation_supplier#7492 AS cpfk_nation_supplier_1#7505, cfpk_supplier_nation#7493 AS cfpk_supplier_nation_1#7506, cval_supplier_s_name#7494 AS cval_supplier_s_name_1#7507, cval_supplier_s_address#7495 AS cval_supplier_s_address_1#7508, cval_supplier_s_phone#7496 AS cval_supplier_s_phone_1#7509, cval_supplier_s_acctbal#7497 AS cval_supplier_s_acctbal_1#7510, cval_supplier_s_comment#7498 AS cval_supplier_s_comment_1#7511, cs_name#7499 AS cs_name_1#7512, cs_address#7500 AS cs_address_1#7513, cs_phone#7501 AS cs_phone_1#7514, cs_acctbal#7502 AS cs_acctbal_1#7515, cs_comment#7503 AS cs_comment_1#7516]
            :  :  :     +- Relation[rid#7491,cpfk_nation_supplier#7492,cfpk_supplier_nation#7493,cval_supplier_s_name#7494,cval_supplier_s_address#7495,cval_supplier_s_phone#7496,cval_supplier_s_acctbal#7497,cval_supplier_s_comment#7498,cs_name#7499,cs_address#7500,cs_phone#7501,cs_acctbal#7502,cs_comment#7503] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- Project [rid#7649 AS rid_2#7682, cpfk_orders_lineitem#7650 AS cpfk_orders_lineitem_2#7683, cpfk_supplier_lineitem#7651 AS cpfk_supplier_lineitem_2#7684, cfpk_lineitem_supplier#7652 AS cfpk_lineitem_supplier_2#7685, cfpk_lineitem_partsupp#7653 AS cfpk_lineitem_partsupp_2#7686, cpfk_part_lineitem#7654 AS cpfk_part_lineitem_2#7687, cfpk_lineitem_part#7655 AS cfpk_lineitem_part_2#7688, cpfk_partsupp_lineitem#7656 AS cpfk_partsupp_lineitem_2#7689, cfpk_lineitem_orders#7657 AS cfpk_lineitem_orders_2#7690, cval_lineitem_l_quantity#7658 AS cval_lineitem_l_quantity_2#7691, cval_lineitem_l_extendedprice#7659 AS cval_lineitem_l_extendedprice_2#7692, cval_lineitem_l_discount#7660 AS cval_lineitem_l_discount_2#7693, cval_lineitem_l_tax#7661 AS cval_lineitem_l_tax_2#7694, cval_lineitem_l_returnflag#7662 AS cval_lineitem_l_returnflag_2#7695, cval_lineitem_l_linestatus#7663 AS cval_lineitem_l_linestatus_2#7696, cval_lineitem_l_commitdate#7664 AS cval_lineitem_l_commitdate_2#7697, cval_lineitem_l_receiptdate#7665 AS cval_lineitem_l_receiptdate_2#7698, cval_lineitem_l_shipinstruct#7666 AS cval_lineitem_l_shipinstruct_2#7699, cval_lineitem_l_shipmode#7667 AS cval_lineitem_l_shipmode_2#7700, cval_lineitem_l_comment#7668 AS cval_lineitem_l_comment_2#7701, cval_lineitem_l_shipdate#7669 AS cval_lineitem_l_shipdate_2#7702, cl_quantity#7670 AS cl_quantity_2#7703, cl_extendedprice#7671 AS cl_extendedprice_2#7704, cl_discount#7672 AS cl_discount_2#7705, ... 9 more fields]
            :  :     +- Relation[rid#7649,cpfk_orders_lineitem#7650,cpfk_supplier_lineitem#7651,cfpk_lineitem_supplier#7652,cfpk_lineitem_partsupp#7653,cpfk_part_lineitem#7654,cfpk_lineitem_part#7655,cpfk_partsupp_lineitem#7656,cfpk_lineitem_orders#7657,cval_lineitem_l_quantity#7658,cval_lineitem_l_extendedprice#7659,cval_lineitem_l_discount#7660,cval_lineitem_l_tax#7661,cval_lineitem_l_returnflag#7662,cval_lineitem_l_linestatus#7663,cval_lineitem_l_commitdate#7664,cval_lineitem_l_receiptdate#7665,cval_lineitem_l_shipinstruct#7666,cval_lineitem_l_shipmode#7667,cval_lineitem_l_comment#7668,cval_lineitem_l_shipdate#7669,cl_quantity#7670,cl_extendedprice#7671,cl_discount#7672,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#7557 AS rid_2#7590, cpfk_orders_lineitem#7558 AS cpfk_orders_lineitem_2#7591, cpfk_supplier_lineitem#7559 AS cpfk_supplier_lineitem_2#7592, cfpk_lineitem_supplier#7560 AS cfpk_lineitem_supplier_2#7593, cfpk_lineitem_partsupp#7561 AS cfpk_lineitem_partsupp_2#7594, cpfk_part_lineitem#7562 AS cpfk_part_lineitem_2#7595, cfpk_lineitem_part#7563 AS cfpk_lineitem_part_2#7596, cpfk_partsupp_lineitem#7564 AS cpfk_partsupp_lineitem_2#7597, cfpk_lineitem_orders#7565 AS cfpk_lineitem_orders_2#7598, cval_lineitem_l_quantity#7566 AS cval_lineitem_l_quantity_2#7599, cval_lineitem_l_extendedprice#7567 AS cval_lineitem_l_extendedprice_2#7600, cval_lineitem_l_discount#7568 AS cval_lineitem_l_discount_2#7601, cval_lineitem_l_tax#7569 AS cval_lineitem_l_tax_2#7602, cval_lineitem_l_returnflag#7570 AS cval_lineitem_l_returnflag_2#7603, cval_lineitem_l_linestatus#7571 AS cval_lineitem_l_linestatus_2#7604, cval_lineitem_l_commitdate#7572 AS cval_lineitem_l_commitdate_2#7605, cval_lineitem_l_receiptdate#7573 AS cval_lineitem_l_receiptdate_2#7606, cval_lineitem_l_shipinstruct#7574 AS cval_lineitem_l_shipinstruct_2#7607, cval_lineitem_l_shipmode#7575 AS cval_lineitem_l_shipmode_2#7608, cval_lineitem_l_comment#7576 AS cval_lineitem_l_comment_2#7609, cval_lineitem_l_shipdate#7577 AS cval_lineitem_l_shipdate_2#7610, cl_quantity#7578 AS cl_quantity_2#7611, cl_extendedprice#7579 AS cl_extendedprice_2#7612, cl_discount#7580 AS cl_discount_2#7613, ... 9 more fields]
            :     +- Relation[rid#7557,cpfk_orders_lineitem#7558,cpfk_supplier_lineitem#7559,cfpk_lineitem_supplier#7560,cfpk_lineitem_partsupp#7561,cpfk_part_lineitem#7562,cfpk_lineitem_part#7563,cpfk_partsupp_lineitem#7564,cfpk_lineitem_orders#7565,cval_lineitem_l_quantity#7566,cval_lineitem_l_extendedprice#7567,cval_lineitem_l_discount#7568,cval_lineitem_l_tax#7569,cval_lineitem_l_returnflag#7570,cval_lineitem_l_linestatus#7571,cval_lineitem_l_commitdate#7572,cval_lineitem_l_receiptdate#7573,cval_lineitem_l_shipinstruct#7574,cval_lineitem_l_shipmode#7575,cval_lineitem_l_comment#7576,cval_lineitem_l_shipdate#7577,cl_quantity#7578,cl_extendedprice#7579,cl_discount#7580,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#7715 AS rid_3#7722, cpfk_region_nation#7716 AS cpfk_region_nation_3#7723, cfpk_nation_region#7717 AS cfpk_nation_region_3#7724, cval_nation_n_name#7718 AS cval_nation_n_name_3#7725, cval_nation_n_comment#7719 AS cval_nation_n_comment_3#7726, cn_name#7720 AS cn_name_3#7727, cn_comment#7721 AS cn_comment_3#7728]
               :  :  :  :  :  +- Relation[rid#7715,cpfk_region_nation#7716,cfpk_nation_region#7717,cval_nation_n_name#7718,cval_nation_n_comment#7719,cn_name#7720,cn_comment#7721] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#7729 AS rid_3#7736, cpfk_region_nation#7730 AS cpfk_region_nation_3#7737, cfpk_nation_region#7731 AS cfpk_nation_region_3#7738, cval_nation_n_name#7732 AS cval_nation_n_name_3#7739, cval_nation_n_comment#7733 AS cval_nation_n_comment_3#7740, cn_name#7734 AS cn_name_3#7741, cn_comment#7735 AS cn_comment_3#7742]
               :  :  :  :        +- Relation[rid#7729,cpfk_region_nation#7730,cfpk_nation_region#7731,cval_nation_n_name#7732,cval_nation_n_comment#7733,cn_name#7734,cn_comment#7735] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#7787 AS rid_4#7802, cpfk_nation_customer#7788 AS cpfk_nation_customer_4#7803, cfpk_customer_nation#7789 AS cfpk_customer_nation_4#7804, cval_customer_c_name#7790 AS cval_customer_c_name_4#7805, cval_customer_c_address#7791 AS cval_customer_c_address_4#7806, cval_customer_c_phone#7792 AS cval_customer_c_phone_4#7807, cval_customer_c_acctbal#7793 AS cval_customer_c_acctbal_4#7808, cval_customer_c_comment#7794 AS cval_customer_c_comment_4#7809, cval_customer_c_mktsegment#7795 AS cval_customer_c_mktsegment_4#7810, cc_name#7796 AS cc_name_4#7811, cc_address#7797 AS cc_address_4#7812, cc_phone#7798 AS cc_phone_4#7813, cc_acctbal#7799 AS cc_acctbal_4#7814, cc_comment#7800 AS cc_comment_4#7815, cc_mktsegment#7801 AS cc_mktsegment_4#7816]
               :  :  :     +- Relation[rid#7787,cpfk_nation_customer#7788,cfpk_customer_nation#7789,cval_customer_c_name#7790,cval_customer_c_address#7791,cval_customer_c_phone#7792,cval_customer_c_acctbal#7793,cval_customer_c_comment#7794,cval_customer_c_mktsegment#7795,cc_name#7796,cc_address#7797,cc_phone#7798,cc_acctbal#7799,cc_comment#7800,cc_mktsegment#7801] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#7743 AS rid_4#7758, cpfk_nation_customer#7744 AS cpfk_nation_customer_4#7759, cfpk_customer_nation#7745 AS cfpk_customer_nation_4#7760, cval_customer_c_name#7746 AS cval_customer_c_name_4#7761, cval_customer_c_address#7747 AS cval_customer_c_address_4#7762, cval_customer_c_phone#7748 AS cval_customer_c_phone_4#7763, cval_customer_c_acctbal#7749 AS cval_customer_c_acctbal_4#7764, cval_customer_c_comment#7750 AS cval_customer_c_comment_4#7765, cval_customer_c_mktsegment#7751 AS cval_customer_c_mktsegment_4#7766, cc_name#7752 AS cc_name_4#7767, cc_address#7753 AS cc_address_4#7768, cc_phone#7754 AS cc_phone_4#7769, cc_acctbal#7755 AS cc_acctbal_4#7770, cc_comment#7756 AS cc_comment_4#7771, cc_mktsegment#7757 AS cc_mktsegment_4#7772]
               :  :     +- Relation[rid#7743,cpfk_nation_customer#7744,cfpk_customer_nation#7745,cval_customer_c_name#7746,cval_customer_c_address#7747,cval_customer_c_phone#7748,cval_customer_c_acctbal#7749,cval_customer_c_comment#7750,cval_customer_c_mktsegment#7751,cc_name#7752,cc_address#7753,cc_phone#7754,cc_acctbal#7755,cc_comment#7756,cc_mktsegment#7757] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#7881 AS rid_5#7898, cpfk_customer_orders#7882 AS cpfk_customer_orders_5#7899, cfpk_orders_customer#7883 AS cfpk_orders_customer_5#7900, cval_orders_o_orderstatus#7884 AS cval_orders_o_orderstatus_5#7901, cval_orders_o_totalprice#7885 AS cval_orders_o_totalprice_5#7902, cval_orders_o_orderpriority#7886 AS cval_orders_o_orderpriority_5#7903, cval_orders_o_clerk#7887 AS cval_orders_o_clerk_5#7904, cval_orders_o_shippriority#7888 AS cval_orders_o_shippriority_5#7905, cval_orders_o_comment#7889 AS cval_orders_o_comment_5#7906, cval_orders_o_orderdate#7890 AS cval_orders_o_orderdate_5#7907, co_orderstatus#7891 AS co_orderstatus_5#7908, co_totalprice#7892 AS co_totalprice_5#7909, co_orderpriority#7893 AS co_orderpriority_5#7910, co_clerk#7894 AS co_clerk_5#7911, co_shippriority#7895 AS co_shippriority_5#7912, co_comment#7896 AS co_comment_5#7913, co_orderdate#7897 AS co_orderdate_5#7914]
               :     +- Relation[rid#7881,cpfk_customer_orders#7882,cfpk_orders_customer#7883,cval_orders_o_orderstatus#7884,cval_orders_o_totalprice#7885,cval_orders_o_orderpriority#7886,cval_orders_o_clerk#7887,cval_orders_o_shippriority#7888,cval_orders_o_comment#7889,cval_orders_o_orderdate#7890,co_orderstatus#7891,co_totalprice#7892,co_orderpriority#7893,co_clerk#7894,co_shippriority#7895,co_comment#7896,co_orderdate#7897] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#7817 AS rid_5#7834, cpfk_customer_orders#7818 AS cpfk_customer_orders_5#7835, cfpk_orders_customer#7819 AS cfpk_orders_customer_5#7836, cval_orders_o_orderstatus#7820 AS cval_orders_o_orderstatus_5#7837, cval_orders_o_totalprice#7821 AS cval_orders_o_totalprice_5#7838, cval_orders_o_orderpriority#7822 AS cval_orders_o_orderpriority_5#7839, cval_orders_o_clerk#7823 AS cval_orders_o_clerk_5#7840, cval_orders_o_shippriority#7824 AS cval_orders_o_shippriority_5#7841, cval_orders_o_comment#7825 AS cval_orders_o_comment_5#7842, cval_orders_o_orderdate#7826 AS cval_orders_o_orderdate_5#7843, co_orderstatus#7827 AS co_orderstatus_5#7844, co_totalprice#7828 AS co_totalprice_5#7845, co_orderpriority#7829 AS co_orderpriority_5#7846, co_clerk#7830 AS co_clerk_5#7847, co_shippriority#7831 AS co_shippriority_5#7848, co_comment#7832 AS co_comment_5#7849, co_orderdate#7833 AS co_orderdate_5#7850]
                  +- Relation[rid#7817,cpfk_customer_orders#7818,cfpk_orders_customer#7819,cval_orders_o_orderstatus#7820,cval_orders_o_totalprice#7821,cval_orders_o_orderpriority#7822,cval_orders_o_clerk#7823,cval_orders_o_shippriority#7824,cval_orders_o_comment#7825,cval_orders_o_orderdate#7826,co_orderstatus#7827,co_totalprice#7828,co_orderpriority#7829,co_clerk#7830,co_shippriority#7831,co_comment#7832,co_orderdate#7833] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 355ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/15 16:51:44 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:51:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8015L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:51:44 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:51:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8015L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#8017 AS rid_0#8032, cpfk_nation_customer#8018 AS cpfk_nation_customer_0#8033, cfpk_customer_nation#8019 AS cfpk_customer_nation_0#8034, cval_customer_c_name#8020 AS cval_customer_c_name_0#8035, cval_customer_c_address#8021 AS cval_customer_c_address_0#8036, cval_customer_c_phone#8022 AS cval_customer_c_phone_0#8037, cval_customer_c_acctbal#8023 AS cval_customer_c_acctbal_0#8038, cval_customer_c_comment#8024 AS cval_customer_c_comment_0#8039, cval_customer_c_mktsegment#8025 AS cval_customer_c_mktsegment_0#8040, cc_name#8026 AS cc_name_0#8041, cc_address#8027 AS cc_address_0#8042, cc_phone#8028 AS cc_phone_0#8043, cc_acctbal#8029 AS cc_acctbal_0#8044, cc_comment#8030 AS cc_comment_0#8045, cc_mktsegment#8031 AS cc_mktsegment_0#8046]
         :  :  :  :  :  +- Relation[rid#8017,cpfk_nation_customer#8018,cfpk_customer_nation#8019,cval_customer_c_name#8020,cval_customer_c_address#8021,cval_customer_c_phone#8022,cval_customer_c_acctbal#8023,cval_customer_c_comment#8024,cval_customer_c_mktsegment#8025,cc_name#8026,cc_address#8027,cc_phone#8028,cc_acctbal#8029,cc_comment#8030,cc_mktsegment#8031] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#8047 AS rid_0#8062, cpfk_nation_customer#8048 AS cpfk_nation_customer_0#8063, cfpk_customer_nation#8049 AS cfpk_customer_nation_0#8064, cval_customer_c_name#8050 AS cval_customer_c_name_0#8065, cval_customer_c_address#8051 AS cval_customer_c_address_0#8066, cval_customer_c_phone#8052 AS cval_customer_c_phone_0#8067, cval_customer_c_acctbal#8053 AS cval_customer_c_acctbal_0#8068, cval_customer_c_comment#8054 AS cval_customer_c_comment_0#8069, cval_customer_c_mktsegment#8055 AS cval_customer_c_mktsegment_0#8070, cc_name#8056 AS cc_name_0#8071, cc_address#8057 AS cc_address_0#8072, cc_phone#8058 AS cc_phone_0#8073, cc_acctbal#8059 AS cc_acctbal_0#8074, cc_comment#8060 AS cc_comment_0#8075, cc_mktsegment#8061 AS cc_mktsegment_0#8076]
         :  :  :  :        +- Relation[rid#8047,cpfk_nation_customer#8048,cfpk_customer_nation#8049,cval_customer_c_name#8050,cval_customer_c_address#8051,cval_customer_c_phone#8052,cval_customer_c_acctbal#8053,cval_customer_c_comment#8054,cval_customer_c_mktsegment#8055,cc_name#8056,cc_address#8057,cc_phone#8058,cc_acctbal#8059,cc_comment#8060,cc_mktsegment#8061] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- Project [rid#8141 AS rid_1#8158, cpfk_customer_orders#8142 AS cpfk_customer_orders_1#8159, cfpk_orders_customer#8143 AS cfpk_orders_customer_1#8160, cval_orders_o_orderstatus#8144 AS cval_orders_o_orderstatus_1#8161, cval_orders_o_totalprice#8145 AS cval_orders_o_totalprice_1#8162, cval_orders_o_orderpriority#8146 AS cval_orders_o_orderpriority_1#8163, cval_orders_o_clerk#8147 AS cval_orders_o_clerk_1#8164, cval_orders_o_shippriority#8148 AS cval_orders_o_shippriority_1#8165, cval_orders_o_comment#8149 AS cval_orders_o_comment_1#8166, cval_orders_o_orderdate#8150 AS cval_orders_o_orderdate_1#8167, co_orderstatus#8151 AS co_orderstatus_1#8168, co_totalprice#8152 AS co_totalprice_1#8169, co_orderpriority#8153 AS co_orderpriority_1#8170, co_clerk#8154 AS co_clerk_1#8171, co_shippriority#8155 AS co_shippriority_1#8172, co_comment#8156 AS co_comment_1#8173, co_orderdate#8157 AS co_orderdate_1#8174]
         :  :  :     +- Relation[rid#8141,cpfk_customer_orders#8142,cfpk_orders_customer#8143,cval_orders_o_orderstatus#8144,cval_orders_o_totalprice#8145,cval_orders_o_orderpriority#8146,cval_orders_o_clerk#8147,cval_orders_o_shippriority#8148,cval_orders_o_comment#8149,cval_orders_o_orderdate#8150,co_orderstatus#8151,co_totalprice#8152,co_orderpriority#8153,co_clerk#8154,co_shippriority#8155,co_comment#8156,co_orderdate#8157] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#8077 AS rid_1#8094, cpfk_customer_orders#8078 AS cpfk_customer_orders_1#8095, cfpk_orders_customer#8079 AS cfpk_orders_customer_1#8096, cval_orders_o_orderstatus#8080 AS cval_orders_o_orderstatus_1#8097, cval_orders_o_totalprice#8081 AS cval_orders_o_totalprice_1#8098, cval_orders_o_orderpriority#8082 AS cval_orders_o_orderpriority_1#8099, cval_orders_o_clerk#8083 AS cval_orders_o_clerk_1#8100, cval_orders_o_shippriority#8084 AS cval_orders_o_shippriority_1#8101, cval_orders_o_comment#8085 AS cval_orders_o_comment_1#8102, cval_orders_o_orderdate#8086 AS cval_orders_o_orderdate_1#8103, co_orderstatus#8087 AS co_orderstatus_1#8104, co_totalprice#8088 AS co_totalprice_1#8105, co_orderpriority#8089 AS co_orderpriority_1#8106, co_clerk#8090 AS co_clerk_1#8107, co_shippriority#8091 AS co_shippriority_1#8108, co_comment#8092 AS co_comment_1#8109, co_orderdate#8093 AS co_orderdate_1#8110]
         :  :     +- Relation[rid#8077,cpfk_customer_orders#8078,cfpk_orders_customer#8079,cval_orders_o_orderstatus#8080,cval_orders_o_totalprice#8081,cval_orders_o_orderpriority#8082,cval_orders_o_clerk#8083,cval_orders_o_shippriority#8084,cval_orders_o_comment#8085,cval_orders_o_orderdate#8086,co_orderstatus#8087,co_totalprice#8088,co_orderpriority#8089,co_clerk#8090,co_shippriority#8091,co_comment#8092,co_orderdate#8093] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#8275 AS rid_2#8308, cpfk_orders_lineitem#8276 AS cpfk_orders_lineitem_2#8309, cpfk_supplier_lineitem#8277 AS cpfk_supplier_lineitem_2#8310, cfpk_lineitem_supplier#8278 AS cfpk_lineitem_supplier_2#8311, cfpk_lineitem_partsupp#8279 AS cfpk_lineitem_partsupp_2#8312, cpfk_part_lineitem#8280 AS cpfk_part_lineitem_2#8313, cfpk_lineitem_part#8281 AS cfpk_lineitem_part_2#8314, cpfk_partsupp_lineitem#8282 AS cpfk_partsupp_lineitem_2#8315, cfpk_lineitem_orders#8283 AS cfpk_lineitem_orders_2#8316, cval_lineitem_l_quantity#8284 AS cval_lineitem_l_quantity_2#8317, cval_lineitem_l_extendedprice#8285 AS cval_lineitem_l_extendedprice_2#8318, cval_lineitem_l_discount#8286 AS cval_lineitem_l_discount_2#8319, cval_lineitem_l_tax#8287 AS cval_lineitem_l_tax_2#8320, cval_lineitem_l_returnflag#8288 AS cval_lineitem_l_returnflag_2#8321, cval_lineitem_l_linestatus#8289 AS cval_lineitem_l_linestatus_2#8322, cval_lineitem_l_commitdate#8290 AS cval_lineitem_l_commitdate_2#8323, cval_lineitem_l_receiptdate#8291 AS cval_lineitem_l_receiptdate_2#8324, cval_lineitem_l_shipinstruct#8292 AS cval_lineitem_l_shipinstruct_2#8325, cval_lineitem_l_shipmode#8293 AS cval_lineitem_l_shipmode_2#8326, cval_lineitem_l_comment#8294 AS cval_lineitem_l_comment_2#8327, cval_lineitem_l_shipdate#8295 AS cval_lineitem_l_shipdate_2#8328, cl_quantity#8296 AS cl_quantity_2#8329, cl_extendedprice#8297 AS cl_extendedprice_2#8330, cl_discount#8298 AS cl_discount_2#8331, ... 9 more fields]
         :     +- Relation[rid#8275,cpfk_orders_lineitem#8276,cpfk_supplier_lineitem#8277,cfpk_lineitem_supplier#8278,cfpk_lineitem_partsupp#8279,cpfk_part_lineitem#8280,cfpk_lineitem_part#8281,cpfk_partsupp_lineitem#8282,cfpk_lineitem_orders#8283,cval_lineitem_l_quantity#8284,cval_lineitem_l_extendedprice#8285,cval_lineitem_l_discount#8286,cval_lineitem_l_tax#8287,cval_lineitem_l_returnflag#8288,cval_lineitem_l_linestatus#8289,cval_lineitem_l_commitdate#8290,cval_lineitem_l_receiptdate#8291,cval_lineitem_l_shipinstruct#8292,cval_lineitem_l_shipmode#8293,cval_lineitem_l_comment#8294,cval_lineitem_l_shipdate#8295,cl_quantity#8296,cl_extendedprice#8297,cl_discount#8298,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8175 AS rid_2#8208, cpfk_orders_lineitem#8176 AS cpfk_orders_lineitem_2#8209, cpfk_supplier_lineitem#8177 AS cpfk_supplier_lineitem_2#8210, cfpk_lineitem_supplier#8178 AS cfpk_lineitem_supplier_2#8211, cfpk_lineitem_partsupp#8179 AS cfpk_lineitem_partsupp_2#8212, cpfk_part_lineitem#8180 AS cpfk_part_lineitem_2#8213, cfpk_lineitem_part#8181 AS cfpk_lineitem_part_2#8214, cpfk_partsupp_lineitem#8182 AS cpfk_partsupp_lineitem_2#8215, cfpk_lineitem_orders#8183 AS cfpk_lineitem_orders_2#8216, cval_lineitem_l_quantity#8184 AS cval_lineitem_l_quantity_2#8217, cval_lineitem_l_extendedprice#8185 AS cval_lineitem_l_extendedprice_2#8218, cval_lineitem_l_discount#8186 AS cval_lineitem_l_discount_2#8219, cval_lineitem_l_tax#8187 AS cval_lineitem_l_tax_2#8220, cval_lineitem_l_returnflag#8188 AS cval_lineitem_l_returnflag_2#8221, cval_lineitem_l_linestatus#8189 AS cval_lineitem_l_linestatus_2#8222, cval_lineitem_l_commitdate#8190 AS cval_lineitem_l_commitdate_2#8223, cval_lineitem_l_receiptdate#8191 AS cval_lineitem_l_receiptdate_2#8224, cval_lineitem_l_shipinstruct#8192 AS cval_lineitem_l_shipinstruct_2#8225, cval_lineitem_l_shipmode#8193 AS cval_lineitem_l_shipmode_2#8226, cval_lineitem_l_comment#8194 AS cval_lineitem_l_comment_2#8227, cval_lineitem_l_shipdate#8195 AS cval_lineitem_l_shipdate_2#8228, cl_quantity#8196 AS cl_quantity_2#8229, cl_extendedprice#8197 AS cl_extendedprice_2#8230, cl_discount#8198 AS cl_discount_2#8231, ... 9 more fields]
            +- Relation[rid#8175,cpfk_orders_lineitem#8176,cpfk_supplier_lineitem#8177,cfpk_lineitem_supplier#8178,cfpk_lineitem_partsupp#8179,cpfk_part_lineitem#8180,cfpk_lineitem_part#8181,cpfk_partsupp_lineitem#8182,cfpk_lineitem_orders#8183,cval_lineitem_l_quantity#8184,cval_lineitem_l_extendedprice#8185,cval_lineitem_l_discount#8186,cval_lineitem_l_tax#8187,cval_lineitem_l_returnflag#8188,cval_lineitem_l_linestatus#8189,cval_lineitem_l_commitdate#8190,cval_lineitem_l_receiptdate#8191,cval_lineitem_l_shipinstruct#8192,cval_lineitem_l_shipmode#8193,cval_lineitem_l_comment#8194,cval_lineitem_l_shipdate#8195,cl_quantity#8196,cl_extendedprice#8197,cl_discount#8198,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=75006
Elapsed time: 6471ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/15 16:51:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:51:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8415L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:51:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8415L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#8417 AS rid_0#8432, cpfk_nation_customer#8418 AS cpfk_nation_customer_0#8433, cfpk_customer_nation#8419 AS cfpk_customer_nation_0#8434, cval_customer_c_name#8420 AS cval_customer_c_name_0#8435, cval_customer_c_address#8421 AS cval_customer_c_address_0#8436, cval_customer_c_phone#8422 AS cval_customer_c_phone_0#8437, cval_customer_c_acctbal#8423 AS cval_customer_c_acctbal_0#8438, cval_customer_c_comment#8424 AS cval_customer_c_comment_0#8439, cval_customer_c_mktsegment#8425 AS cval_customer_c_mktsegment_0#8440, cc_name#8426 AS cc_name_0#8441, cc_address#8427 AS cc_address_0#8442, cc_phone#8428 AS cc_phone_0#8443, cc_acctbal#8429 AS cc_acctbal_0#8444, cc_comment#8430 AS cc_comment_0#8445, cc_mktsegment#8431 AS cc_mktsegment_0#8446]
         :  :  :  :  +- Relation[rid#8417,cpfk_nation_customer#8418,cfpk_customer_nation#8419,cval_customer_c_name#8420,cval_customer_c_address#8421,cval_customer_c_phone#8422,cval_customer_c_acctbal#8423,cval_customer_c_comment#8424,cval_customer_c_mktsegment#8425,cc_name#8426,cc_address#8427,cc_phone#8428,cc_acctbal#8429,cc_comment#8430,cc_mktsegment#8431] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#8481 AS rid_0#8496, cpfk_nation_customer#8482 AS cpfk_nation_customer_0#8497, cfpk_customer_nation#8483 AS cfpk_customer_nation_0#8498, cval_customer_c_name#8484 AS cval_customer_c_name_0#8499, cval_customer_c_address#8485 AS cval_customer_c_address_0#8500, cval_customer_c_phone#8486 AS cval_customer_c_phone_0#8501, cval_customer_c_acctbal#8487 AS cval_customer_c_acctbal_0#8502, cval_customer_c_comment#8488 AS cval_customer_c_comment_0#8503, cval_customer_c_mktsegment#8489 AS cval_customer_c_mktsegment_0#8504, cc_name#8490 AS cc_name_0#8505, cc_address#8491 AS cc_address_0#8506, cc_phone#8492 AS cc_phone_0#8507, cc_acctbal#8493 AS cc_acctbal_0#8508, cc_comment#8494 AS cc_comment_0#8509, cc_mktsegment#8495 AS cc_mktsegment_0#8510]
         :  :  :     :  +- Relation[rid#8481,cpfk_nation_customer#8482,cfpk_customer_nation#8483,cval_customer_c_name#8484,cval_customer_c_address#8485,cval_customer_c_phone#8486,cval_customer_c_acctbal#8487,cval_customer_c_comment#8488,cval_customer_c_mktsegment#8489,cc_name#8490,cc_address#8491,cc_phone#8492,cc_acctbal#8493,cc_comment#8494,cc_mktsegment#8495] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#8511 AS rid_1#8528, cpfk_customer_orders#8512 AS cpfk_customer_orders_1#8529, cfpk_orders_customer#8513 AS cfpk_orders_customer_1#8530, cval_orders_o_orderstatus#8514 AS cval_orders_o_orderstatus_1#8531, cval_orders_o_totalprice#8515 AS cval_orders_o_totalprice_1#8532, cval_orders_o_orderpriority#8516 AS cval_orders_o_orderpriority_1#8533, cval_orders_o_clerk#8517 AS cval_orders_o_clerk_1#8534, cval_orders_o_shippriority#8518 AS cval_orders_o_shippriority_1#8535, cval_orders_o_comment#8519 AS cval_orders_o_comment_1#8536, cval_orders_o_orderdate#8520 AS cval_orders_o_orderdate_1#8537, co_orderstatus#8521 AS co_orderstatus_1#8538, co_totalprice#8522 AS co_totalprice_1#8539, co_orderpriority#8523 AS co_orderpriority_1#8540, co_clerk#8524 AS co_clerk_1#8541, co_shippriority#8525 AS co_shippriority_1#8542, co_comment#8526 AS co_comment_1#8543, co_orderdate#8527 AS co_orderdate_1#8544]
         :  :  :        +- Relation[rid#8511,cpfk_customer_orders#8512,cfpk_orders_customer#8513,cval_orders_o_orderstatus#8514,cval_orders_o_totalprice#8515,cval_orders_o_orderpriority#8516,cval_orders_o_clerk#8517,cval_orders_o_shippriority#8518,cval_orders_o_comment#8519,cval_orders_o_orderdate#8520,co_orderstatus#8521,co_totalprice#8522,co_orderpriority#8523,co_clerk#8524,co_shippriority#8525,co_comment#8526,co_orderdate#8527] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#8447 AS rid_1#8464, cpfk_customer_orders#8448 AS cpfk_customer_orders_1#8465, cfpk_orders_customer#8449 AS cfpk_orders_customer_1#8466, cval_orders_o_orderstatus#8450 AS cval_orders_o_orderstatus_1#8467, cval_orders_o_totalprice#8451 AS cval_orders_o_totalprice_1#8468, cval_orders_o_orderpriority#8452 AS cval_orders_o_orderpriority_1#8469, cval_orders_o_clerk#8453 AS cval_orders_o_clerk_1#8470, cval_orders_o_shippriority#8454 AS cval_orders_o_shippriority_1#8471, cval_orders_o_comment#8455 AS cval_orders_o_comment_1#8472, cval_orders_o_orderdate#8456 AS cval_orders_o_orderdate_1#8473, co_orderstatus#8457 AS co_orderstatus_1#8474, co_totalprice#8458 AS co_totalprice_1#8475, co_orderpriority#8459 AS co_orderpriority_1#8476, co_clerk#8460 AS co_clerk_1#8477, co_shippriority#8461 AS co_shippriority_1#8478, co_comment#8462 AS co_comment_1#8479, co_orderdate#8463 AS co_orderdate_1#8480]
         :  :     +- Relation[rid#8447,cpfk_customer_orders#8448,cfpk_orders_customer#8449,cval_orders_o_orderstatus#8450,cval_orders_o_totalprice#8451,cval_orders_o_orderpriority#8452,cval_orders_o_clerk#8453,cval_orders_o_shippriority#8454,cval_orders_o_comment#8455,cval_orders_o_orderdate#8456,co_orderstatus#8457,co_totalprice#8458,co_orderpriority#8459,co_clerk#8460,co_shippriority#8461,co_comment#8462,co_orderdate#8463] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#8611 AS rid_1#8628, cpfk_customer_orders#8612 AS cpfk_customer_orders_1#8629, cfpk_orders_customer#8613 AS cfpk_orders_customer_1#8630, cval_orders_o_orderstatus#8614 AS cval_orders_o_orderstatus_1#8631, cval_orders_o_totalprice#8615 AS cval_orders_o_totalprice_1#8632, cval_orders_o_orderpriority#8616 AS cval_orders_o_orderpriority_1#8633, cval_orders_o_clerk#8617 AS cval_orders_o_clerk_1#8634, cval_orders_o_shippriority#8618 AS cval_orders_o_shippriority_1#8635, cval_orders_o_comment#8619 AS cval_orders_o_comment_1#8636, cval_orders_o_orderdate#8620 AS cval_orders_o_orderdate_1#8637, co_orderstatus#8621 AS co_orderstatus_1#8638, co_totalprice#8622 AS co_totalprice_1#8639, co_orderpriority#8623 AS co_orderpriority_1#8640, co_clerk#8624 AS co_clerk_1#8641, co_shippriority#8625 AS co_shippriority_1#8642, co_comment#8626 AS co_comment_1#8643, co_orderdate#8627 AS co_orderdate_1#8644]
         :     :  +- Relation[rid#8611,cpfk_customer_orders#8612,cfpk_orders_customer#8613,cval_orders_o_orderstatus#8614,cval_orders_o_totalprice#8615,cval_orders_o_orderpriority#8616,cval_orders_o_clerk#8617,cval_orders_o_shippriority#8618,cval_orders_o_comment#8619,cval_orders_o_orderdate#8620,co_orderstatus#8621,co_totalprice#8622,co_orderpriority#8623,co_clerk#8624,co_shippriority#8625,co_comment#8626,co_orderdate#8627] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#8645 AS rid_2#8678, cpfk_orders_lineitem#8646 AS cpfk_orders_lineitem_2#8679, cpfk_supplier_lineitem#8647 AS cpfk_supplier_lineitem_2#8680, cfpk_lineitem_supplier#8648 AS cfpk_lineitem_supplier_2#8681, cfpk_lineitem_partsupp#8649 AS cfpk_lineitem_partsupp_2#8682, cpfk_part_lineitem#8650 AS cpfk_part_lineitem_2#8683, cfpk_lineitem_part#8651 AS cfpk_lineitem_part_2#8684, cpfk_partsupp_lineitem#8652 AS cpfk_partsupp_lineitem_2#8685, cfpk_lineitem_orders#8653 AS cfpk_lineitem_orders_2#8686, cval_lineitem_l_quantity#8654 AS cval_lineitem_l_quantity_2#8687, cval_lineitem_l_extendedprice#8655 AS cval_lineitem_l_extendedprice_2#8688, cval_lineitem_l_discount#8656 AS cval_lineitem_l_discount_2#8689, cval_lineitem_l_tax#8657 AS cval_lineitem_l_tax_2#8690, cval_lineitem_l_returnflag#8658 AS cval_lineitem_l_returnflag_2#8691, cval_lineitem_l_linestatus#8659 AS cval_lineitem_l_linestatus_2#8692, cval_lineitem_l_commitdate#8660 AS cval_lineitem_l_commitdate_2#8693, cval_lineitem_l_receiptdate#8661 AS cval_lineitem_l_receiptdate_2#8694, cval_lineitem_l_shipinstruct#8662 AS cval_lineitem_l_shipinstruct_2#8695, cval_lineitem_l_shipmode#8663 AS cval_lineitem_l_shipmode_2#8696, cval_lineitem_l_comment#8664 AS cval_lineitem_l_comment_2#8697, cval_lineitem_l_shipdate#8665 AS cval_lineitem_l_shipdate_2#8698, cl_quantity#8666 AS cl_quantity_2#8699, cl_extendedprice#8667 AS cl_extendedprice_2#8700, cl_discount#8668 AS cl_discount_2#8701, ... 9 more fields]
         :        +- Relation[rid#8645,cpfk_orders_lineitem#8646,cpfk_supplier_lineitem#8647,cfpk_lineitem_supplier#8648,cfpk_lineitem_partsupp#8649,cpfk_part_lineitem#8650,cfpk_lineitem_part#8651,cpfk_partsupp_lineitem#8652,cfpk_lineitem_orders#8653,cval_lineitem_l_quantity#8654,cval_lineitem_l_extendedprice#8655,cval_lineitem_l_discount#8656,cval_lineitem_l_tax#8657,cval_lineitem_l_returnflag#8658,cval_lineitem_l_linestatus#8659,cval_lineitem_l_commitdate#8660,cval_lineitem_l_receiptdate#8661,cval_lineitem_l_shipinstruct#8662,cval_lineitem_l_shipmode#8663,cval_lineitem_l_comment#8664,cval_lineitem_l_shipdate#8665,cl_quantity#8666,cl_extendedprice#8667,cl_discount#8668,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8545 AS rid_2#8578, cpfk_orders_lineitem#8546 AS cpfk_orders_lineitem_2#8579, cpfk_supplier_lineitem#8547 AS cpfk_supplier_lineitem_2#8580, cfpk_lineitem_supplier#8548 AS cfpk_lineitem_supplier_2#8581, cfpk_lineitem_partsupp#8549 AS cfpk_lineitem_partsupp_2#8582, cpfk_part_lineitem#8550 AS cpfk_part_lineitem_2#8583, cfpk_lineitem_part#8551 AS cfpk_lineitem_part_2#8584, cpfk_partsupp_lineitem#8552 AS cpfk_partsupp_lineitem_2#8585, cfpk_lineitem_orders#8553 AS cfpk_lineitem_orders_2#8586, cval_lineitem_l_quantity#8554 AS cval_lineitem_l_quantity_2#8587, cval_lineitem_l_extendedprice#8555 AS cval_lineitem_l_extendedprice_2#8588, cval_lineitem_l_discount#8556 AS cval_lineitem_l_discount_2#8589, cval_lineitem_l_tax#8557 AS cval_lineitem_l_tax_2#8590, cval_lineitem_l_returnflag#8558 AS cval_lineitem_l_returnflag_2#8591, cval_lineitem_l_linestatus#8559 AS cval_lineitem_l_linestatus_2#8592, cval_lineitem_l_commitdate#8560 AS cval_lineitem_l_commitdate_2#8593, cval_lineitem_l_receiptdate#8561 AS cval_lineitem_l_receiptdate_2#8594, cval_lineitem_l_shipinstruct#8562 AS cval_lineitem_l_shipinstruct_2#8595, cval_lineitem_l_shipmode#8563 AS cval_lineitem_l_shipmode_2#8596, cval_lineitem_l_comment#8564 AS cval_lineitem_l_comment_2#8597, cval_lineitem_l_shipdate#8565 AS cval_lineitem_l_shipdate_2#8598, cl_quantity#8566 AS cl_quantity_2#8599, cl_extendedprice#8567 AS cl_extendedprice_2#8600, cl_discount#8568 AS cl_discount_2#8601, ... 9 more fields]
            +- Relation[rid#8545,cpfk_orders_lineitem#8546,cpfk_supplier_lineitem#8547,cfpk_lineitem_supplier#8548,cfpk_lineitem_partsupp#8549,cpfk_part_lineitem#8550,cfpk_lineitem_part#8551,cpfk_partsupp_lineitem#8552,cfpk_lineitem_orders#8553,cval_lineitem_l_quantity#8554,cval_lineitem_l_extendedprice#8555,cval_lineitem_l_discount#8556,cval_lineitem_l_tax#8557,cval_lineitem_l_returnflag#8558,cval_lineitem_l_linestatus#8559,cval_lineitem_l_commitdate#8560,cval_lineitem_l_receiptdate#8561,cval_lineitem_l_shipinstruct#8562,cval_lineitem_l_shipmode#8563,cval_lineitem_l_comment#8564,cval_lineitem_l_shipdate#8565,cl_quantity#8566,cl_extendedprice#8567,cl_discount#8568,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 128204ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/15 16:53:59 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:53:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8781L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:53:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:53:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:53:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:53:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:53:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:53:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:53:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:53:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8781L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#8783 AS rid_0#8800, cval_part_p_name#8784 AS cval_part_p_name_0#8801, cval_part_p_mfgr#8785 AS cval_part_p_mfgr_0#8802, cval_part_p_type#8786 AS cval_part_p_type_0#8803, cval_part_p_size#8787 AS cval_part_p_size_0#8804, cval_part_p_container#8788 AS cval_part_p_container_0#8805, cval_part_p_retailprice#8789 AS cval_part_p_retailprice_0#8806, cval_part_p_comment#8790 AS cval_part_p_comment_0#8807, cval_part_p_brand#8791 AS cval_part_p_brand_0#8808, cp_name#8792 AS cp_name_0#8809, cp_mfgr#8793 AS cp_mfgr_0#8810, cp_type#8794 AS cp_type_0#8811, cp_size#8795 AS cp_size_0#8812, cp_container#8796 AS cp_container_0#8813, cp_retailprice#8797 AS cp_retailprice_0#8814, cp_comment#8798 AS cp_comment_0#8815, cp_brand#8799 AS cp_brand_0#8816]
         :  :  :  :  +- Relation[rid#8783,cval_part_p_name#8784,cval_part_p_mfgr#8785,cval_part_p_type#8786,cval_part_p_size#8787,cval_part_p_container#8788,cval_part_p_retailprice#8789,cval_part_p_comment#8790,cval_part_p_brand#8791,cp_name#8792,cp_mfgr#8793,cp_type#8794,cp_size#8795,cp_container#8796,cp_retailprice#8797,cp_comment#8798,cp_brand#8799] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#8817 AS rid_0#8834, cval_part_p_name#8818 AS cval_part_p_name_0#8835, cval_part_p_mfgr#8819 AS cval_part_p_mfgr_0#8836, cval_part_p_type#8820 AS cval_part_p_type_0#8837, cval_part_p_size#8821 AS cval_part_p_size_0#8838, cval_part_p_container#8822 AS cval_part_p_container_0#8839, cval_part_p_retailprice#8823 AS cval_part_p_retailprice_0#8840, cval_part_p_comment#8824 AS cval_part_p_comment_0#8841, cval_part_p_brand#8825 AS cval_part_p_brand_0#8842, cp_name#8826 AS cp_name_0#8843, cp_mfgr#8827 AS cp_mfgr_0#8844, cp_type#8828 AS cp_type_0#8845, cp_size#8829 AS cp_size_0#8846, cp_container#8830 AS cp_container_0#8847, cp_retailprice#8831 AS cp_retailprice_0#8848, cp_comment#8832 AS cp_comment_0#8849, cp_brand#8833 AS cp_brand_0#8850]
         :  :  :        +- Relation[rid#8817,cval_part_p_name#8818,cval_part_p_mfgr#8819,cval_part_p_type#8820,cval_part_p_size#8821,cval_part_p_container#8822,cval_part_p_retailprice#8823,cval_part_p_comment#8824,cval_part_p_brand#8825,cp_name#8826,cp_mfgr#8827,cp_type#8828,cp_size#8829,cp_container#8830,cp_retailprice#8831,cp_comment#8832,cp_brand#8833] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#8851 AS rid_0#8868, cval_part_p_name#8852 AS cval_part_p_name_0#8869, cval_part_p_mfgr#8853 AS cval_part_p_mfgr_0#8870, cval_part_p_type#8854 AS cval_part_p_type_0#8871, cval_part_p_size#8855 AS cval_part_p_size_0#8872, cval_part_p_container#8856 AS cval_part_p_container_0#8873, cval_part_p_retailprice#8857 AS cval_part_p_retailprice_0#8874, cval_part_p_comment#8858 AS cval_part_p_comment_0#8875, cval_part_p_brand#8859 AS cval_part_p_brand_0#8876, cp_name#8860 AS cp_name_0#8877, cp_mfgr#8861 AS cp_mfgr_0#8878, cp_type#8862 AS cp_type_0#8879, cp_size#8863 AS cp_size_0#8880, cp_container#8864 AS cp_container_0#8881, cp_retailprice#8865 AS cp_retailprice_0#8882, cp_comment#8866 AS cp_comment_0#8883, cp_brand#8867 AS cp_brand_0#8884]
         :  :        +- Relation[rid#8851,cval_part_p_name#8852,cval_part_p_mfgr#8853,cval_part_p_type#8854,cval_part_p_size#8855,cval_part_p_container#8856,cval_part_p_retailprice#8857,cval_part_p_comment#8858,cval_part_p_brand#8859,cp_name#8860,cp_mfgr#8861,cp_type#8862,cp_size#8863,cp_container#8864,cp_retailprice#8865,cp_comment#8866,cp_brand#8867] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#9117 AS rid_1#9150, cpfk_orders_lineitem#9118 AS cpfk_orders_lineitem_1#9151, cpfk_supplier_lineitem#9119 AS cpfk_supplier_lineitem_1#9152, cfpk_lineitem_supplier#9120 AS cfpk_lineitem_supplier_1#9153, cfpk_lineitem_partsupp#9121 AS cfpk_lineitem_partsupp_1#9154, cpfk_part_lineitem#9122 AS cpfk_part_lineitem_1#9155, cfpk_lineitem_part#9123 AS cfpk_lineitem_part_1#9156, cpfk_partsupp_lineitem#9124 AS cpfk_partsupp_lineitem_1#9157, cfpk_lineitem_orders#9125 AS cfpk_lineitem_orders_1#9158, cval_lineitem_l_quantity#9126 AS cval_lineitem_l_quantity_1#9159, cval_lineitem_l_extendedprice#9127 AS cval_lineitem_l_extendedprice_1#9160, cval_lineitem_l_discount#9128 AS cval_lineitem_l_discount_1#9161, cval_lineitem_l_tax#9129 AS cval_lineitem_l_tax_1#9162, cval_lineitem_l_returnflag#9130 AS cval_lineitem_l_returnflag_1#9163, cval_lineitem_l_linestatus#9131 AS cval_lineitem_l_linestatus_1#9164, cval_lineitem_l_commitdate#9132 AS cval_lineitem_l_commitdate_1#9165, cval_lineitem_l_receiptdate#9133 AS cval_lineitem_l_receiptdate_1#9166, cval_lineitem_l_shipinstruct#9134 AS cval_lineitem_l_shipinstruct_1#9167, cval_lineitem_l_shipmode#9135 AS cval_lineitem_l_shipmode_1#9168, cval_lineitem_l_comment#9136 AS cval_lineitem_l_comment_1#9169, cval_lineitem_l_shipdate#9137 AS cval_lineitem_l_shipdate_1#9170, cl_quantity#9138 AS cl_quantity_1#9171, cl_extendedprice#9139 AS cl_extendedprice_1#9172, cl_discount#9140 AS cl_discount_1#9173, ... 9 more fields]
         :     +- Relation[rid#9117,cpfk_orders_lineitem#9118,cpfk_supplier_lineitem#9119,cfpk_lineitem_supplier#9120,cfpk_lineitem_partsupp#9121,cpfk_part_lineitem#9122,cfpk_lineitem_part#9123,cpfk_partsupp_lineitem#9124,cfpk_lineitem_orders#9125,cval_lineitem_l_quantity#9126,cval_lineitem_l_extendedprice#9127,cval_lineitem_l_discount#9128,cval_lineitem_l_tax#9129,cval_lineitem_l_returnflag#9130,cval_lineitem_l_linestatus#9131,cval_lineitem_l_commitdate#9132,cval_lineitem_l_receiptdate#9133,cval_lineitem_l_shipinstruct#9134,cval_lineitem_l_shipmode#9135,cval_lineitem_l_comment#9136,cval_lineitem_l_shipdate#9137,cl_quantity#9138,cl_extendedprice#9139,cl_discount#9140,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#8885 AS rid_1#8918, cpfk_orders_lineitem#8886 AS cpfk_orders_lineitem_1#8919, cpfk_supplier_lineitem#8887 AS cpfk_supplier_lineitem_1#8920, cfpk_lineitem_supplier#8888 AS cfpk_lineitem_supplier_1#8921, cfpk_lineitem_partsupp#8889 AS cfpk_lineitem_partsupp_1#8922, cpfk_part_lineitem#8890 AS cpfk_part_lineitem_1#8923, cfpk_lineitem_part#8891 AS cfpk_lineitem_part_1#8924, cpfk_partsupp_lineitem#8892 AS cpfk_partsupp_lineitem_1#8925, cfpk_lineitem_orders#8893 AS cfpk_lineitem_orders_1#8926, cval_lineitem_l_quantity#8894 AS cval_lineitem_l_quantity_1#8927, cval_lineitem_l_extendedprice#8895 AS cval_lineitem_l_extendedprice_1#8928, cval_lineitem_l_discount#8896 AS cval_lineitem_l_discount_1#8929, cval_lineitem_l_tax#8897 AS cval_lineitem_l_tax_1#8930, cval_lineitem_l_returnflag#8898 AS cval_lineitem_l_returnflag_1#8931, cval_lineitem_l_linestatus#8899 AS cval_lineitem_l_linestatus_1#8932, cval_lineitem_l_commitdate#8900 AS cval_lineitem_l_commitdate_1#8933, cval_lineitem_l_receiptdate#8901 AS cval_lineitem_l_receiptdate_1#8934, cval_lineitem_l_shipinstruct#8902 AS cval_lineitem_l_shipinstruct_1#8935, cval_lineitem_l_shipmode#8903 AS cval_lineitem_l_shipmode_1#8936, cval_lineitem_l_comment#8904 AS cval_lineitem_l_comment_1#8937, cval_lineitem_l_shipdate#8905 AS cval_lineitem_l_shipdate_1#8938, cl_quantity#8906 AS cl_quantity_1#8939, cl_extendedprice#8907 AS cl_extendedprice_1#8940, cl_discount#8908 AS cl_discount_1#8941, ... 9 more fields]
            :  :  +- Relation[rid#8885,cpfk_orders_lineitem#8886,cpfk_supplier_lineitem#8887,cfpk_lineitem_supplier#8888,cfpk_lineitem_partsupp#8889,cpfk_part_lineitem#8890,cfpk_lineitem_part#8891,cpfk_partsupp_lineitem#8892,cfpk_lineitem_orders#8893,cval_lineitem_l_quantity#8894,cval_lineitem_l_extendedprice#8895,cval_lineitem_l_discount#8896,cval_lineitem_l_tax#8897,cval_lineitem_l_returnflag#8898,cval_lineitem_l_linestatus#8899,cval_lineitem_l_commitdate#8900,cval_lineitem_l_receiptdate#8901,cval_lineitem_l_shipinstruct#8902,cval_lineitem_l_shipmode#8903,cval_lineitem_l_comment#8904,cval_lineitem_l_shipdate#8905,cl_quantity#8906,cl_extendedprice#8907,cl_discount#8908,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#8951 AS rid_1#8984, cpfk_orders_lineitem#8952 AS cpfk_orders_lineitem_1#8985, cpfk_supplier_lineitem#8953 AS cpfk_supplier_lineitem_1#8986, cfpk_lineitem_supplier#8954 AS cfpk_lineitem_supplier_1#8987, cfpk_lineitem_partsupp#8955 AS cfpk_lineitem_partsupp_1#8988, cpfk_part_lineitem#8956 AS cpfk_part_lineitem_1#8989, cfpk_lineitem_part#8957 AS cfpk_lineitem_part_1#8990, cpfk_partsupp_lineitem#8958 AS cpfk_partsupp_lineitem_1#8991, cfpk_lineitem_orders#8959 AS cfpk_lineitem_orders_1#8992, cval_lineitem_l_quantity#8960 AS cval_lineitem_l_quantity_1#8993, cval_lineitem_l_extendedprice#8961 AS cval_lineitem_l_extendedprice_1#8994, cval_lineitem_l_discount#8962 AS cval_lineitem_l_discount_1#8995, cval_lineitem_l_tax#8963 AS cval_lineitem_l_tax_1#8996, cval_lineitem_l_returnflag#8964 AS cval_lineitem_l_returnflag_1#8997, cval_lineitem_l_linestatus#8965 AS cval_lineitem_l_linestatus_1#8998, cval_lineitem_l_commitdate#8966 AS cval_lineitem_l_commitdate_1#8999, cval_lineitem_l_receiptdate#8967 AS cval_lineitem_l_receiptdate_1#9000, cval_lineitem_l_shipinstruct#8968 AS cval_lineitem_l_shipinstruct_1#9001, cval_lineitem_l_shipmode#8969 AS cval_lineitem_l_shipmode_1#9002, cval_lineitem_l_comment#8970 AS cval_lineitem_l_comment_1#9003, cval_lineitem_l_shipdate#8971 AS cval_lineitem_l_shipdate_1#9004, cl_quantity#8972 AS cl_quantity_1#9005, cl_extendedprice#8973 AS cl_extendedprice_1#9006, cl_discount#8974 AS cl_discount_1#9007, ... 9 more fields]
            :        +- Relation[rid#8951,cpfk_orders_lineitem#8952,cpfk_supplier_lineitem#8953,cfpk_lineitem_supplier#8954,cfpk_lineitem_partsupp#8955,cpfk_part_lineitem#8956,cfpk_lineitem_part#8957,cpfk_partsupp_lineitem#8958,cfpk_lineitem_orders#8959,cval_lineitem_l_quantity#8960,cval_lineitem_l_extendedprice#8961,cval_lineitem_l_discount#8962,cval_lineitem_l_tax#8963,cval_lineitem_l_returnflag#8964,cval_lineitem_l_linestatus#8965,cval_lineitem_l_commitdate#8966,cval_lineitem_l_receiptdate#8967,cval_lineitem_l_shipinstruct#8968,cval_lineitem_l_shipmode#8969,cval_lineitem_l_comment#8970,cval_lineitem_l_shipdate#8971,cl_quantity#8972,cl_extendedprice#8973,cl_discount#8974,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#9017 AS rid_1#9050, cpfk_orders_lineitem#9018 AS cpfk_orders_lineitem_1#9051, cpfk_supplier_lineitem#9019 AS cpfk_supplier_lineitem_1#9052, cfpk_lineitem_supplier#9020 AS cfpk_lineitem_supplier_1#9053, cfpk_lineitem_partsupp#9021 AS cfpk_lineitem_partsupp_1#9054, cpfk_part_lineitem#9022 AS cpfk_part_lineitem_1#9055, cfpk_lineitem_part#9023 AS cfpk_lineitem_part_1#9056, cpfk_partsupp_lineitem#9024 AS cpfk_partsupp_lineitem_1#9057, cfpk_lineitem_orders#9025 AS cfpk_lineitem_orders_1#9058, cval_lineitem_l_quantity#9026 AS cval_lineitem_l_quantity_1#9059, cval_lineitem_l_extendedprice#9027 AS cval_lineitem_l_extendedprice_1#9060, cval_lineitem_l_discount#9028 AS cval_lineitem_l_discount_1#9061, cval_lineitem_l_tax#9029 AS cval_lineitem_l_tax_1#9062, cval_lineitem_l_returnflag#9030 AS cval_lineitem_l_returnflag_1#9063, cval_lineitem_l_linestatus#9031 AS cval_lineitem_l_linestatus_1#9064, cval_lineitem_l_commitdate#9032 AS cval_lineitem_l_commitdate_1#9065, cval_lineitem_l_receiptdate#9033 AS cval_lineitem_l_receiptdate_1#9066, cval_lineitem_l_shipinstruct#9034 AS cval_lineitem_l_shipinstruct_1#9067, cval_lineitem_l_shipmode#9035 AS cval_lineitem_l_shipmode_1#9068, cval_lineitem_l_comment#9036 AS cval_lineitem_l_comment_1#9069, cval_lineitem_l_shipdate#9037 AS cval_lineitem_l_shipdate_1#9070, cl_quantity#9038 AS cl_quantity_1#9071, cl_extendedprice#9039 AS cl_extendedprice_1#9072, cl_discount#9040 AS cl_discount_1#9073, ... 9 more fields]
                  +- Relation[rid#9017,cpfk_orders_lineitem#9018,cpfk_supplier_lineitem#9019,cfpk_lineitem_supplier#9020,cfpk_lineitem_partsupp#9021,cpfk_part_lineitem#9022,cfpk_lineitem_part#9023,cpfk_partsupp_lineitem#9024,cfpk_lineitem_orders#9025,cval_lineitem_l_quantity#9026,cval_lineitem_l_extendedprice#9027,cval_lineitem_l_discount#9028,cval_lineitem_l_tax#9029,cval_lineitem_l_returnflag#9030,cval_lineitem_l_linestatus#9031,cval_lineitem_l_commitdate#9032,cval_lineitem_l_receiptdate#9033,cval_lineitem_l_shipinstruct#9034,cval_lineitem_l_shipmode#9035,cval_lineitem_l_comment#9036,cval_lineitem_l_shipdate#9037,cl_quantity#9038,cl_extendedprice#9039,cl_discount#9040,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=13
Elapsed time: 64058ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/15 16:55:03 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:55:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9240L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 16:55:03 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:55:03 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:55:03 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:55:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9240L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#9242 AS rid_0#9259, cval_part_p_name#9243 AS cval_part_p_name_0#9260, cval_part_p_mfgr#9244 AS cval_part_p_mfgr_0#9261, cval_part_p_type#9245 AS cval_part_p_type_0#9262, cval_part_p_size#9246 AS cval_part_p_size_0#9263, cval_part_p_container#9247 AS cval_part_p_container_0#9264, cval_part_p_retailprice#9248 AS cval_part_p_retailprice_0#9265, cval_part_p_comment#9249 AS cval_part_p_comment_0#9266, cval_part_p_brand#9250 AS cval_part_p_brand_0#9267, cp_name#9251 AS cp_name_0#9268, cp_mfgr#9252 AS cp_mfgr_0#9269, cp_type#9253 AS cp_type_0#9270, cp_size#9254 AS cp_size_0#9271, cp_container#9255 AS cp_container_0#9272, cp_retailprice#9256 AS cp_retailprice_0#9273, cp_comment#9257 AS cp_comment_0#9274, cp_brand#9258 AS cp_brand_0#9275]
         :  :  :  +- Relation[rid#9242,cval_part_p_name#9243,cval_part_p_mfgr#9244,cval_part_p_type#9245,cval_part_p_size#9246,cval_part_p_container#9247,cval_part_p_retailprice#9248,cval_part_p_comment#9249,cval_part_p_brand#9250,cp_name#9251,cp_mfgr#9252,cp_type#9253,cp_size#9254,cp_container#9255,cp_retailprice#9256,cp_comment#9257,cp_brand#9258] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#9276 AS rid_0#9293, cval_part_p_name#9277 AS cval_part_p_name_0#9294, cval_part_p_mfgr#9278 AS cval_part_p_mfgr_0#9295, cval_part_p_type#9279 AS cval_part_p_type_0#9296, cval_part_p_size#9280 AS cval_part_p_size_0#9297, cval_part_p_container#9281 AS cval_part_p_container_0#9298, cval_part_p_retailprice#9282 AS cval_part_p_retailprice_0#9299, cval_part_p_comment#9283 AS cval_part_p_comment_0#9300, cval_part_p_brand#9284 AS cval_part_p_brand_0#9301, cp_name#9285 AS cp_name_0#9302, cp_mfgr#9286 AS cp_mfgr_0#9303, cp_type#9287 AS cp_type_0#9304, cp_size#9288 AS cp_size_0#9305, cp_container#9289 AS cp_container_0#9306, cp_retailprice#9290 AS cp_retailprice_0#9307, cp_comment#9291 AS cp_comment_0#9308, cp_brand#9292 AS cp_brand_0#9309]
         :  :        +- Relation[rid#9276,cval_part_p_name#9277,cval_part_p_mfgr#9278,cval_part_p_type#9279,cval_part_p_size#9280,cval_part_p_container#9281,cval_part_p_retailprice#9282,cval_part_p_comment#9283,cval_part_p_brand#9284,cp_name#9285,cp_mfgr#9286,cp_type#9287,cp_size#9288,cp_container#9289,cp_retailprice#9290,cp_comment#9291,cp_brand#9292] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#9366 AS rid_1#9377, cpfk_part_partsupp#9367 AS cpfk_part_partsupp_1#9378, cfpk_partsupp_part#9368 AS cfpk_partsupp_part_1#9379, cpfk_supplier_partsupp#9369 AS cpfk_supplier_partsupp_1#9380, cfpk_partsupp_supplier#9370 AS cfpk_partsupp_supplier_1#9381, cval_partsupp_ps_availqty#9371 AS cval_partsupp_ps_availqty_1#9382, cval_partsupp_ps_supplycost#9372 AS cval_partsupp_ps_supplycost_1#9383, cval_partsupp_ps_comment#9373 AS cval_partsupp_ps_comment_1#9384, cps_availqty#9374 AS cps_availqty_1#9385, cps_supplycost#9375 AS cps_supplycost_1#9386, cps_comment#9376 AS cps_comment_1#9387]
         :     +- Relation[rid#9366,cpfk_part_partsupp#9367,cfpk_partsupp_part#9368,cpfk_supplier_partsupp#9369,cfpk_partsupp_supplier#9370,cval_partsupp_ps_availqty#9371,cval_partsupp_ps_supplycost#9372,cval_partsupp_ps_comment#9373,cps_availqty#9374,cps_supplycost#9375,cps_comment#9376] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#9310 AS rid_1#9321, cpfk_part_partsupp#9311 AS cpfk_part_partsupp_1#9322, cfpk_partsupp_part#9312 AS cfpk_partsupp_part_1#9323, cpfk_supplier_partsupp#9313 AS cpfk_supplier_partsupp_1#9324, cfpk_partsupp_supplier#9314 AS cfpk_partsupp_supplier_1#9325, cval_partsupp_ps_availqty#9315 AS cval_partsupp_ps_availqty_1#9326, cval_partsupp_ps_supplycost#9316 AS cval_partsupp_ps_supplycost_1#9327, cval_partsupp_ps_comment#9317 AS cval_partsupp_ps_comment_1#9328, cps_availqty#9318 AS cps_availqty_1#9329, cps_supplycost#9319 AS cps_supplycost_1#9330, cps_comment#9320 AS cps_comment_1#9331]
            +- Relation[rid#9310,cpfk_part_partsupp#9311,cfpk_partsupp_part#9312,cpfk_supplier_partsupp#9313,cfpk_partsupp_supplier#9314,cval_partsupp_ps_availqty#9315,cval_partsupp_ps_supplycost#9316,cval_partsupp_ps_comment#9317,cps_availqty#9318,cps_supplycost#9319,cps_comment#9320] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=7890
Elapsed time: 540ms
query=q1, count=6001215, duration=2904
query=q10, count=1478870, duration=69873
query=q11, count=4, duration=1305
query=q12, count=857401, duration=24432
query=q13, count=1500000, duration=13945
query=q14, count=6001215, duration=91096
query=q15, count=6001215, duration=97430
query=q16, count=7890, duration=540
query=q17, count=408, duration=414
query=q18, count=6001215, duration=128204
query=q19, count=13, duration=64058
query=q2, count=0, duration=1476
query=q20, count=1, duration=766
query=q21a, count=120762, duration=93892
query=q22, count=1500000, duration=13997
query=q3, count=75006, duration=6471
query=q4, count=6001215, duration=56905
query=q5, count=5, duration=21091
query=q6, count=6001215, duration=2847
query=q7, count=0, duration=355
query=q8, count=0, duration=2269
query=q9a, count=6001215, duration=278744
query=q9b, count=6001215, duration=181888
