20/04/15 17:14:08 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 12250ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Apr 15 17:14:11 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Apr 15 17:14:13 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Apr 15 17:14:13 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Apr 15 17:14:13 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Apr 15 17:14:13 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Apr 15 17:14:18 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Apr 15 17:14:22 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Apr 15 17:14:22 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/15 17:14:23 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:14:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2079L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:14:24 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/15 17:14:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#2079L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#2081 AS rid_0#2114, cpfk_orders_lineitem#2082 AS cpfk_orders_lineitem_0#2115, cpfk_supplier_lineitem#2083 AS cpfk_supplier_lineitem_0#2116, cfpk_lineitem_supplier#2084 AS cfpk_lineitem_supplier_0#2117, cfpk_lineitem_partsupp#2085 AS cfpk_lineitem_partsupp_0#2118, cpfk_part_lineitem#2086 AS cpfk_part_lineitem_0#2119, cfpk_lineitem_part#2087 AS cfpk_lineitem_part_0#2120, cpfk_partsupp_lineitem#2088 AS cpfk_partsupp_lineitem_0#2121, cfpk_lineitem_orders#2089 AS cfpk_lineitem_orders_0#2122, cval_lineitem_l_quantity#2090 AS cval_lineitem_l_quantity_0#2123, cval_lineitem_l_extendedprice#2091 AS cval_lineitem_l_extendedprice_0#2124, cval_lineitem_l_discount#2092 AS cval_lineitem_l_discount_0#2125, cval_lineitem_l_tax#2093 AS cval_lineitem_l_tax_0#2126, cval_lineitem_l_returnflag#2094 AS cval_lineitem_l_returnflag_0#2127, cval_lineitem_l_linestatus#2095 AS cval_lineitem_l_linestatus_0#2128, cval_lineitem_l_commitdate#2096 AS cval_lineitem_l_commitdate_0#2129, cval_lineitem_l_receiptdate#2097 AS cval_lineitem_l_receiptdate_0#2130, cval_lineitem_l_shipinstruct#2098 AS cval_lineitem_l_shipinstruct_0#2131, cval_lineitem_l_shipmode#2099 AS cval_lineitem_l_shipmode_0#2132, cval_lineitem_l_comment#2100 AS cval_lineitem_l_comment_0#2133, cval_lineitem_l_shipdate#2101 AS cval_lineitem_l_shipdate_0#2134, cl_quantity#2102 AS cl_quantity_0#2135, cl_extendedprice#2103 AS cl_extendedprice_0#2136, cl_discount#2104 AS cl_discount_0#2137, ... 9 more fields]
         +- Relation[rid#2081,cpfk_orders_lineitem#2082,cpfk_supplier_lineitem#2083,cfpk_lineitem_supplier#2084,cfpk_lineitem_partsupp#2085,cpfk_part_lineitem#2086,cfpk_lineitem_part#2087,cpfk_partsupp_lineitem#2088,cfpk_lineitem_orders#2089,cval_lineitem_l_quantity#2090,cval_lineitem_l_extendedprice#2091,cval_lineitem_l_discount#2092,cval_lineitem_l_tax#2093,cval_lineitem_l_returnflag#2094,cval_lineitem_l_linestatus#2095,cval_lineitem_l_commitdate#2096,cval_lineitem_l_receiptdate#2097,cval_lineitem_l_shipinstruct#2098,cval_lineitem_l_shipmode#2099,cval_lineitem_l_comment#2100,cval_lineitem_l_shipdate#2101,cl_quantity#2102,cl_extendedprice#2103,cl_discount#2104,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 3241ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/15 17:14:27 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:14:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2185L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:14:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#2185L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#2187 AS rid_0#2220, cpfk_orders_lineitem#2188 AS cpfk_orders_lineitem_0#2221, cpfk_supplier_lineitem#2189 AS cpfk_supplier_lineitem_0#2222, cfpk_lineitem_supplier#2190 AS cfpk_lineitem_supplier_0#2223, cfpk_lineitem_partsupp#2191 AS cfpk_lineitem_partsupp_0#2224, cpfk_part_lineitem#2192 AS cpfk_part_lineitem_0#2225, cfpk_lineitem_part#2193 AS cfpk_lineitem_part_0#2226, cpfk_partsupp_lineitem#2194 AS cpfk_partsupp_lineitem_0#2227, cfpk_lineitem_orders#2195 AS cfpk_lineitem_orders_0#2228, cval_lineitem_l_quantity#2196 AS cval_lineitem_l_quantity_0#2229, cval_lineitem_l_extendedprice#2197 AS cval_lineitem_l_extendedprice_0#2230, cval_lineitem_l_discount#2198 AS cval_lineitem_l_discount_0#2231, cval_lineitem_l_tax#2199 AS cval_lineitem_l_tax_0#2232, cval_lineitem_l_returnflag#2200 AS cval_lineitem_l_returnflag_0#2233, cval_lineitem_l_linestatus#2201 AS cval_lineitem_l_linestatus_0#2234, cval_lineitem_l_commitdate#2202 AS cval_lineitem_l_commitdate_0#2235, cval_lineitem_l_receiptdate#2203 AS cval_lineitem_l_receiptdate_0#2236, cval_lineitem_l_shipinstruct#2204 AS cval_lineitem_l_shipinstruct_0#2237, cval_lineitem_l_shipmode#2205 AS cval_lineitem_l_shipmode_0#2238, cval_lineitem_l_comment#2206 AS cval_lineitem_l_comment_0#2239, cval_lineitem_l_shipdate#2207 AS cval_lineitem_l_shipdate_0#2240, cl_quantity#2208 AS cl_quantity_0#2241, cl_extendedprice#2209 AS cl_extendedprice_0#2242, cl_discount#2210 AS cl_discount_0#2243, ... 9 more fields]
         +- Relation[rid#2187,cpfk_orders_lineitem#2188,cpfk_supplier_lineitem#2189,cfpk_lineitem_supplier#2190,cfpk_lineitem_partsupp#2191,cpfk_part_lineitem#2192,cfpk_lineitem_part#2193,cpfk_partsupp_lineitem#2194,cfpk_lineitem_orders#2195,cval_lineitem_l_quantity#2196,cval_lineitem_l_extendedprice#2197,cval_lineitem_l_discount#2198,cval_lineitem_l_tax#2199,cval_lineitem_l_returnflag#2200,cval_lineitem_l_linestatus#2201,cval_lineitem_l_commitdate#2202,cval_lineitem_l_receiptdate#2203,cval_lineitem_l_shipinstruct#2204,cval_lineitem_l_shipmode#2205,cval_lineitem_l_comment#2206,cval_lineitem_l_shipdate#2207,cl_quantity#2208,cl_extendedprice#2209,cl_discount#2210,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2754ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 17:14:30 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:14:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2295L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 17:14:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:14:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:14:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:14:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:14:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:14:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:14:30 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:14:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:14:30 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:14:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:14:30 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:14:30 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:14:30 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:14:30 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:14:30 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:14:30 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:14:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2295L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#2297 AS rid_0#2304, cpfk_region_nation#2298 AS cpfk_region_nation_0#2305, cfpk_nation_region#2299 AS cfpk_nation_region_0#2306, cval_nation_n_name#2300 AS cval_nation_n_name_0#2307, cval_nation_n_comment#2301 AS cval_nation_n_comment_0#2308, cn_name#2302 AS cn_name_0#2309, cn_comment#2303 AS cn_comment_0#2310]
            :  :  :     :  :  :  :  :  +- Relation[rid#2297,cpfk_region_nation#2298,cfpk_nation_region#2299,cval_nation_n_name#2300,cval_nation_n_comment#2301,cn_name#2302,cn_comment#2303] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#2337 AS rid_0#2344, cpfk_region_nation#2338 AS cpfk_region_nation_0#2345, cfpk_nation_region#2339 AS cfpk_nation_region_0#2346, cval_nation_n_name#2340 AS cval_nation_n_name_0#2347, cval_nation_n_comment#2341 AS cval_nation_n_comment_0#2348, cn_name#2342 AS cn_name_0#2349, cn_comment#2343 AS cn_comment_0#2350]
            :  :  :     :  :  :  :     :  +- Relation[rid#2337,cpfk_region_nation#2338,cfpk_nation_region#2339,cval_nation_n_name#2340,cval_nation_n_comment#2341,cn_name#2342,cn_comment#2343] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#2351 AS rid_1#2364, cpfk_nation_supplier#2352 AS cpfk_nation_supplier_1#2365, cfpk_supplier_nation#2353 AS cfpk_supplier_nation_1#2366, cval_supplier_s_name#2354 AS cval_supplier_s_name_1#2367, cval_supplier_s_address#2355 AS cval_supplier_s_address_1#2368, cval_supplier_s_phone#2356 AS cval_supplier_s_phone_1#2369, cval_supplier_s_acctbal#2357 AS cval_supplier_s_acctbal_1#2370, cval_supplier_s_comment#2358 AS cval_supplier_s_comment_1#2371, cs_name#2359 AS cs_name_1#2372, cs_address#2360 AS cs_address_1#2373, cs_phone#2361 AS cs_phone_1#2374, cs_acctbal#2362 AS cs_acctbal_1#2375, cs_comment#2363 AS cs_comment_1#2376]
            :  :  :     :  :  :  :        +- Relation[rid#2351,cpfk_nation_supplier#2352,cfpk_supplier_nation#2353,cval_supplier_s_name#2354,cval_supplier_s_address#2355,cval_supplier_s_phone#2356,cval_supplier_s_acctbal#2357,cval_supplier_s_comment#2358,cs_name#2359,cs_address#2360,cs_phone#2361,cs_acctbal#2362,cs_comment#2363] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#2311 AS rid_1#2324, cpfk_nation_supplier#2312 AS cpfk_nation_supplier_1#2325, cfpk_supplier_nation#2313 AS cfpk_supplier_nation_1#2326, cval_supplier_s_name#2314 AS cval_supplier_s_name_1#2327, cval_supplier_s_address#2315 AS cval_supplier_s_address_1#2328, cval_supplier_s_phone#2316 AS cval_supplier_s_phone_1#2329, cval_supplier_s_acctbal#2317 AS cval_supplier_s_acctbal_1#2330, cval_supplier_s_comment#2318 AS cval_supplier_s_comment_1#2331, cs_name#2319 AS cs_name_1#2332, cs_address#2320 AS cs_address_1#2333, cs_phone#2321 AS cs_phone_1#2334, cs_acctbal#2322 AS cs_acctbal_1#2335, cs_comment#2323 AS cs_comment_1#2336]
            :  :  :     :  :  :     +- Relation[rid#2311,cpfk_nation_supplier#2312,cfpk_supplier_nation#2313,cval_supplier_s_name#2314,cval_supplier_s_address#2315,cval_supplier_s_phone#2316,cval_supplier_s_acctbal#2317,cval_supplier_s_comment#2318,cs_name#2319,cs_address#2320,cs_phone#2321,cs_acctbal#2322,cs_comment#2323] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#2399 AS rid_1#2412, cpfk_nation_supplier#2400 AS cpfk_nation_supplier_1#2413, cfpk_supplier_nation#2401 AS cfpk_supplier_nation_1#2414, cval_supplier_s_name#2402 AS cval_supplier_s_name_1#2415, cval_supplier_s_address#2403 AS cval_supplier_s_address_1#2416, cval_supplier_s_phone#2404 AS cval_supplier_s_phone_1#2417, cval_supplier_s_acctbal#2405 AS cval_supplier_s_acctbal_1#2418, cval_supplier_s_comment#2406 AS cval_supplier_s_comment_1#2419, cs_name#2407 AS cs_name_1#2420, cs_address#2408 AS cs_address_1#2421, cs_phone#2409 AS cs_phone_1#2422, cs_acctbal#2410 AS cs_acctbal_1#2423, cs_comment#2411 AS cs_comment_1#2424]
            :  :  :     :  :     :  +- Relation[rid#2399,cpfk_nation_supplier#2400,cfpk_supplier_nation#2401,cval_supplier_s_name#2402,cval_supplier_s_address#2403,cval_supplier_s_phone#2404,cval_supplier_s_acctbal#2405,cval_supplier_s_comment#2406,cs_name#2407,cs_address#2408,cs_phone#2409,cs_acctbal#2410,cs_comment#2411] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#2425 AS rid_2#2436, cpfk_part_partsupp#2426 AS cpfk_part_partsupp_2#2437, cfpk_partsupp_part#2427 AS cfpk_partsupp_part_2#2438, cpfk_supplier_partsupp#2428 AS cpfk_supplier_partsupp_2#2439, cfpk_partsupp_supplier#2429 AS cfpk_partsupp_supplier_2#2440, cval_partsupp_ps_availqty#2430 AS cval_partsupp_ps_availqty_2#2441, cval_partsupp_ps_supplycost#2431 AS cval_partsupp_ps_supplycost_2#2442, cval_partsupp_ps_comment#2432 AS cval_partsupp_ps_comment_2#2443, cps_availqty#2433 AS cps_availqty_2#2444, cps_supplycost#2434 AS cps_supplycost_2#2445, cps_comment#2435 AS cps_comment_2#2446]
            :  :  :     :  :        +- Relation[rid#2425,cpfk_part_partsupp#2426,cfpk_partsupp_part#2427,cpfk_supplier_partsupp#2428,cfpk_partsupp_supplier#2429,cval_partsupp_ps_availqty#2430,cval_partsupp_ps_supplycost#2431,cval_partsupp_ps_comment#2432,cps_availqty#2433,cps_supplycost#2434,cps_comment#2435] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#2377 AS rid_2#2388, cpfk_part_partsupp#2378 AS cpfk_part_partsupp_2#2389, cfpk_partsupp_part#2379 AS cfpk_partsupp_part_2#2390, cpfk_supplier_partsupp#2380 AS cpfk_supplier_partsupp_2#2391, cfpk_partsupp_supplier#2381 AS cfpk_partsupp_supplier_2#2392, cval_partsupp_ps_availqty#2382 AS cval_partsupp_ps_availqty_2#2393, cval_partsupp_ps_supplycost#2383 AS cval_partsupp_ps_supplycost_2#2394, cval_partsupp_ps_comment#2384 AS cval_partsupp_ps_comment_2#2395, cps_availqty#2385 AS cps_availqty_2#2396, cps_supplycost#2386 AS cps_supplycost_2#2397, cps_comment#2387 AS cps_comment_2#2398]
            :  :  :     :     +- Relation[rid#2377,cpfk_part_partsupp#2378,cfpk_partsupp_part#2379,cpfk_supplier_partsupp#2380,cfpk_partsupp_supplier#2381,cval_partsupp_ps_availqty#2382,cval_partsupp_ps_supplycost#2383,cval_partsupp_ps_comment#2384,cps_availqty#2385,cps_supplycost#2386,cps_comment#2387] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#2447 AS rid_3#2464, cval_part_p_name#2448 AS cval_part_p_name_3#2465, cval_part_p_mfgr#2449 AS cval_part_p_mfgr_3#2466, cval_part_p_type#2450 AS cval_part_p_type_3#2467, cval_part_p_size#2451 AS cval_part_p_size_3#2468, cval_part_p_container#2452 AS cval_part_p_container_3#2469, cval_part_p_retailprice#2453 AS cval_part_p_retailprice_3#2470, cval_part_p_comment#2454 AS cval_part_p_comment_3#2471, cval_part_p_brand#2455 AS cval_part_p_brand_3#2472, cp_name#2456 AS cp_name_3#2473, cp_mfgr#2457 AS cp_mfgr_3#2474, cp_type#2458 AS cp_type_3#2475, cp_size#2459 AS cp_size_3#2476, cp_container#2460 AS cp_container_3#2477, cp_retailprice#2461 AS cp_retailprice_3#2478, cp_comment#2462 AS cp_comment_3#2479, cp_brand#2463 AS cp_brand_3#2480]
            :  :  :        +- Relation[rid#2447,cval_part_p_name#2448,cval_part_p_mfgr#2449,cval_part_p_type#2450,cval_part_p_size#2451,cval_part_p_container#2452,cval_part_p_retailprice#2453,cval_part_p_comment#2454,cval_part_p_brand#2455,cp_name#2456,cp_mfgr#2457,cp_type#2458,cp_size#2459,cp_container#2460,cp_retailprice#2461,cp_comment#2462,cp_brand#2463] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#2547 AS rid_2#2558, cpfk_part_partsupp#2548 AS cpfk_part_partsupp_2#2559, cfpk_partsupp_part#2549 AS cfpk_partsupp_part_2#2560, cpfk_supplier_partsupp#2550 AS cpfk_supplier_partsupp_2#2561, cfpk_partsupp_supplier#2551 AS cfpk_partsupp_supplier_2#2562, cval_partsupp_ps_availqty#2552 AS cval_partsupp_ps_availqty_2#2563, cval_partsupp_ps_supplycost#2553 AS cval_partsupp_ps_supplycost_2#2564, cval_partsupp_ps_comment#2554 AS cval_partsupp_ps_comment_2#2565, cps_availqty#2555 AS cps_availqty_2#2566, cps_supplycost#2556 AS cps_supplycost_2#2567, cps_comment#2557 AS cps_comment_2#2568]
            :  :     :  +- Relation[rid#2547,cpfk_part_partsupp#2548,cfpk_partsupp_part#2549,cpfk_supplier_partsupp#2550,cfpk_partsupp_supplier#2551,cval_partsupp_ps_availqty#2552,cval_partsupp_ps_supplycost#2553,cval_partsupp_ps_comment#2554,cps_availqty#2555,cps_supplycost#2556,cps_comment#2557] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#2569 AS rid_4#2602, cpfk_orders_lineitem#2570 AS cpfk_orders_lineitem_4#2603, cpfk_supplier_lineitem#2571 AS cpfk_supplier_lineitem_4#2604, cfpk_lineitem_supplier#2572 AS cfpk_lineitem_supplier_4#2605, cfpk_lineitem_partsupp#2573 AS cfpk_lineitem_partsupp_4#2606, cpfk_part_lineitem#2574 AS cpfk_part_lineitem_4#2607, cfpk_lineitem_part#2575 AS cfpk_lineitem_part_4#2608, cpfk_partsupp_lineitem#2576 AS cpfk_partsupp_lineitem_4#2609, cfpk_lineitem_orders#2577 AS cfpk_lineitem_orders_4#2610, cval_lineitem_l_quantity#2578 AS cval_lineitem_l_quantity_4#2611, cval_lineitem_l_extendedprice#2579 AS cval_lineitem_l_extendedprice_4#2612, cval_lineitem_l_discount#2580 AS cval_lineitem_l_discount_4#2613, cval_lineitem_l_tax#2581 AS cval_lineitem_l_tax_4#2614, cval_lineitem_l_returnflag#2582 AS cval_lineitem_l_returnflag_4#2615, cval_lineitem_l_linestatus#2583 AS cval_lineitem_l_linestatus_4#2616, cval_lineitem_l_commitdate#2584 AS cval_lineitem_l_commitdate_4#2617, cval_lineitem_l_receiptdate#2585 AS cval_lineitem_l_receiptdate_4#2618, cval_lineitem_l_shipinstruct#2586 AS cval_lineitem_l_shipinstruct_4#2619, cval_lineitem_l_shipmode#2587 AS cval_lineitem_l_shipmode_4#2620, cval_lineitem_l_comment#2588 AS cval_lineitem_l_comment_4#2621, cval_lineitem_l_shipdate#2589 AS cval_lineitem_l_shipdate_4#2622, cl_quantity#2590 AS cl_quantity_4#2623, cl_extendedprice#2591 AS cl_extendedprice_4#2624, cl_discount#2592 AS cl_discount_4#2625, ... 9 more fields]
            :  :        +- Relation[rid#2569,cpfk_orders_lineitem#2570,cpfk_supplier_lineitem#2571,cfpk_lineitem_supplier#2572,cfpk_lineitem_partsupp#2573,cpfk_part_lineitem#2574,cfpk_lineitem_part#2575,cpfk_partsupp_lineitem#2576,cfpk_lineitem_orders#2577,cval_lineitem_l_quantity#2578,cval_lineitem_l_extendedprice#2579,cval_lineitem_l_discount#2580,cval_lineitem_l_tax#2581,cval_lineitem_l_returnflag#2582,cval_lineitem_l_linestatus#2583,cval_lineitem_l_commitdate#2584,cval_lineitem_l_receiptdate#2585,cval_lineitem_l_shipinstruct#2586,cval_lineitem_l_shipmode#2587,cval_lineitem_l_comment#2588,cval_lineitem_l_shipdate#2589,cl_quantity#2590,cl_extendedprice#2591,cl_discount#2592,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#2481 AS rid_4#2514, cpfk_orders_lineitem#2482 AS cpfk_orders_lineitem_4#2515, cpfk_supplier_lineitem#2483 AS cpfk_supplier_lineitem_4#2516, cfpk_lineitem_supplier#2484 AS cfpk_lineitem_supplier_4#2517, cfpk_lineitem_partsupp#2485 AS cfpk_lineitem_partsupp_4#2518, cpfk_part_lineitem#2486 AS cpfk_part_lineitem_4#2519, cfpk_lineitem_part#2487 AS cfpk_lineitem_part_4#2520, cpfk_partsupp_lineitem#2488 AS cpfk_partsupp_lineitem_4#2521, cfpk_lineitem_orders#2489 AS cfpk_lineitem_orders_4#2522, cval_lineitem_l_quantity#2490 AS cval_lineitem_l_quantity_4#2523, cval_lineitem_l_extendedprice#2491 AS cval_lineitem_l_extendedprice_4#2524, cval_lineitem_l_discount#2492 AS cval_lineitem_l_discount_4#2525, cval_lineitem_l_tax#2493 AS cval_lineitem_l_tax_4#2526, cval_lineitem_l_returnflag#2494 AS cval_lineitem_l_returnflag_4#2527, cval_lineitem_l_linestatus#2495 AS cval_lineitem_l_linestatus_4#2528, cval_lineitem_l_commitdate#2496 AS cval_lineitem_l_commitdate_4#2529, cval_lineitem_l_receiptdate#2497 AS cval_lineitem_l_receiptdate_4#2530, cval_lineitem_l_shipinstruct#2498 AS cval_lineitem_l_shipinstruct_4#2531, cval_lineitem_l_shipmode#2499 AS cval_lineitem_l_shipmode_4#2532, cval_lineitem_l_comment#2500 AS cval_lineitem_l_comment_4#2533, cval_lineitem_l_shipdate#2501 AS cval_lineitem_l_shipdate_4#2534, cl_quantity#2502 AS cl_quantity_4#2535, cl_extendedprice#2503 AS cl_extendedprice_4#2536, cl_discount#2504 AS cl_discount_4#2537, ... 9 more fields]
            :     +- Relation[rid#2481,cpfk_orders_lineitem#2482,cpfk_supplier_lineitem#2483,cfpk_lineitem_supplier#2484,cfpk_lineitem_partsupp#2485,cpfk_part_lineitem#2486,cfpk_lineitem_part#2487,cpfk_partsupp_lineitem#2488,cfpk_lineitem_orders#2489,cval_lineitem_l_quantity#2490,cval_lineitem_l_extendedprice#2491,cval_lineitem_l_discount#2492,cval_lineitem_l_tax#2493,cval_lineitem_l_returnflag#2494,cval_lineitem_l_linestatus#2495,cval_lineitem_l_commitdate#2496,cval_lineitem_l_receiptdate#2497,cval_lineitem_l_shipinstruct#2498,cval_lineitem_l_shipmode#2499,cval_lineitem_l_comment#2500,cval_lineitem_l_shipdate#2501,cl_quantity#2502,cl_extendedprice#2503,cl_discount#2504,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#2635 AS rid_5#2652, cpfk_customer_orders#2636 AS cpfk_customer_orders_5#2653, cfpk_orders_customer#2637 AS cfpk_orders_customer_5#2654, cval_orders_o_orderstatus#2638 AS cval_orders_o_orderstatus_5#2655, cval_orders_o_totalprice#2639 AS cval_orders_o_totalprice_5#2656, cval_orders_o_orderpriority#2640 AS cval_orders_o_orderpriority_5#2657, cval_orders_o_clerk#2641 AS cval_orders_o_clerk_5#2658, cval_orders_o_shippriority#2642 AS cval_orders_o_shippriority_5#2659, cval_orders_o_comment#2643 AS cval_orders_o_comment_5#2660, cval_orders_o_orderdate#2644 AS cval_orders_o_orderdate_5#2661, co_orderstatus#2645 AS co_orderstatus_5#2662, co_totalprice#2646 AS co_totalprice_5#2663, co_orderpriority#2647 AS co_orderpriority_5#2664, co_clerk#2648 AS co_clerk_5#2665, co_shippriority#2649 AS co_shippriority_5#2666, co_comment#2650 AS co_comment_5#2667, co_orderdate#2651 AS co_orderdate_5#2668]
               +- Relation[rid#2635,cpfk_customer_orders#2636,cfpk_orders_customer#2637,cval_orders_o_orderstatus#2638,cval_orders_o_totalprice#2639,cval_orders_o_orderpriority#2640,cval_orders_o_clerk#2641,cval_orders_o_shippriority#2642,cval_orders_o_comment#2643,cval_orders_o_orderdate#2644,co_orderstatus#2645,co_totalprice#2646,co_orderpriority#2647,co_clerk#2648,co_shippriority#2649,co_comment#2650,co_orderdate#2651] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 174705ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/15 17:17:24 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:17:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2771L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 17:17:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:17:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:17:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:17:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:17:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:17:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:17:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:17:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2771L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#2773 AS rid_0#2806, cpfk_orders_lineitem#2774 AS cpfk_orders_lineitem_0#2807, cpfk_supplier_lineitem#2775 AS cpfk_supplier_lineitem_0#2808, cfpk_lineitem_supplier#2776 AS cfpk_lineitem_supplier_0#2809, cfpk_lineitem_partsupp#2777 AS cfpk_lineitem_partsupp_0#2810, cpfk_part_lineitem#2778 AS cpfk_part_lineitem_0#2811, cfpk_lineitem_part#2779 AS cfpk_lineitem_part_0#2812, cpfk_partsupp_lineitem#2780 AS cpfk_partsupp_lineitem_0#2813, cfpk_lineitem_orders#2781 AS cfpk_lineitem_orders_0#2814, cval_lineitem_l_quantity#2782 AS cval_lineitem_l_quantity_0#2815, cval_lineitem_l_extendedprice#2783 AS cval_lineitem_l_extendedprice_0#2816, cval_lineitem_l_discount#2784 AS cval_lineitem_l_discount_0#2817, cval_lineitem_l_tax#2785 AS cval_lineitem_l_tax_0#2818, cval_lineitem_l_returnflag#2786 AS cval_lineitem_l_returnflag_0#2819, cval_lineitem_l_linestatus#2787 AS cval_lineitem_l_linestatus_0#2820, cval_lineitem_l_commitdate#2788 AS cval_lineitem_l_commitdate_0#2821, cval_lineitem_l_receiptdate#2789 AS cval_lineitem_l_receiptdate_0#2822, cval_lineitem_l_shipinstruct#2790 AS cval_lineitem_l_shipinstruct_0#2823, cval_lineitem_l_shipmode#2791 AS cval_lineitem_l_shipmode_0#2824, cval_lineitem_l_comment#2792 AS cval_lineitem_l_comment_0#2825, cval_lineitem_l_shipdate#2793 AS cval_lineitem_l_shipdate_0#2826, cl_quantity#2794 AS cl_quantity_0#2827, cl_extendedprice#2795 AS cl_extendedprice_0#2828, cl_discount#2796 AS cl_discount_0#2829, ... 9 more fields]
            :  +- Relation[rid#2773,cpfk_orders_lineitem#2774,cpfk_supplier_lineitem#2775,cfpk_lineitem_supplier#2776,cfpk_lineitem_partsupp#2777,cpfk_part_lineitem#2778,cfpk_lineitem_part#2779,cpfk_partsupp_lineitem#2780,cfpk_lineitem_orders#2781,cval_lineitem_l_quantity#2782,cval_lineitem_l_extendedprice#2783,cval_lineitem_l_discount#2784,cval_lineitem_l_tax#2785,cval_lineitem_l_returnflag#2786,cval_lineitem_l_linestatus#2787,cval_lineitem_l_commitdate#2788,cval_lineitem_l_receiptdate#2789,cval_lineitem_l_shipinstruct#2790,cval_lineitem_l_shipmode#2791,cval_lineitem_l_comment#2792,cval_lineitem_l_shipdate#2793,cl_quantity#2794,cl_extendedprice#2795,cl_discount#2796,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#2839 AS rid_1#2856, cpfk_customer_orders#2840 AS cpfk_customer_orders_1#2857, cfpk_orders_customer#2841 AS cfpk_orders_customer_1#2858, cval_orders_o_orderstatus#2842 AS cval_orders_o_orderstatus_1#2859, cval_orders_o_totalprice#2843 AS cval_orders_o_totalprice_1#2860, cval_orders_o_orderpriority#2844 AS cval_orders_o_orderpriority_1#2861, cval_orders_o_clerk#2845 AS cval_orders_o_clerk_1#2862, cval_orders_o_shippriority#2846 AS cval_orders_o_shippriority_1#2863, cval_orders_o_comment#2847 AS cval_orders_o_comment_1#2864, cval_orders_o_orderdate#2848 AS cval_orders_o_orderdate_1#2865, co_orderstatus#2849 AS co_orderstatus_1#2866, co_totalprice#2850 AS co_totalprice_1#2867, co_orderpriority#2851 AS co_orderpriority_1#2868, co_clerk#2852 AS co_clerk_1#2869, co_shippriority#2853 AS co_shippriority_1#2870, co_comment#2854 AS co_comment_1#2871, co_orderdate#2855 AS co_orderdate_1#2872]
                  :     :  :  :  :  +- Relation[rid#2839,cpfk_customer_orders#2840,cfpk_orders_customer#2841,cval_orders_o_orderstatus#2842,cval_orders_o_totalprice#2843,cval_orders_o_orderpriority#2844,cval_orders_o_clerk#2845,cval_orders_o_shippriority#2846,cval_orders_o_comment#2847,cval_orders_o_orderdate#2848,co_orderstatus#2849,co_totalprice#2850,co_orderpriority#2851,co_clerk#2852,co_shippriority#2853,co_comment#2854,co_orderdate#2855] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#2873 AS rid_1#2890, cpfk_customer_orders#2874 AS cpfk_customer_orders_1#2891, cfpk_orders_customer#2875 AS cfpk_orders_customer_1#2892, cval_orders_o_orderstatus#2876 AS cval_orders_o_orderstatus_1#2893, cval_orders_o_totalprice#2877 AS cval_orders_o_totalprice_1#2894, cval_orders_o_orderpriority#2878 AS cval_orders_o_orderpriority_1#2895, cval_orders_o_clerk#2879 AS cval_orders_o_clerk_1#2896, cval_orders_o_shippriority#2880 AS cval_orders_o_shippriority_1#2897, cval_orders_o_comment#2881 AS cval_orders_o_comment_1#2898, cval_orders_o_orderdate#2882 AS cval_orders_o_orderdate_1#2899, co_orderstatus#2883 AS co_orderstatus_1#2900, co_totalprice#2884 AS co_totalprice_1#2901, co_orderpriority#2885 AS co_orderpriority_1#2902, co_clerk#2886 AS co_clerk_1#2903, co_shippriority#2887 AS co_shippriority_1#2904, co_comment#2888 AS co_comment_1#2905, co_orderdate#2889 AS co_orderdate_1#2906]
                  :     :  :  :        +- Relation[rid#2873,cpfk_customer_orders#2874,cfpk_orders_customer#2875,cval_orders_o_orderstatus#2876,cval_orders_o_totalprice#2877,cval_orders_o_orderpriority#2878,cval_orders_o_clerk#2879,cval_orders_o_shippriority#2880,cval_orders_o_comment#2881,cval_orders_o_orderdate#2882,co_orderstatus#2883,co_totalprice#2884,co_orderpriority#2885,co_clerk#2886,co_shippriority#2887,co_comment#2888,co_orderdate#2889] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- Project [rid#3007 AS rid_2#3040, cpfk_orders_lineitem#3008 AS cpfk_orders_lineitem_2#3041, cpfk_supplier_lineitem#3009 AS cpfk_supplier_lineitem_2#3042, cfpk_lineitem_supplier#3010 AS cfpk_lineitem_supplier_2#3043, cfpk_lineitem_partsupp#3011 AS cfpk_lineitem_partsupp_2#3044, cpfk_part_lineitem#3012 AS cpfk_part_lineitem_2#3045, cfpk_lineitem_part#3013 AS cfpk_lineitem_part_2#3046, cpfk_partsupp_lineitem#3014 AS cpfk_partsupp_lineitem_2#3047, cfpk_lineitem_orders#3015 AS cfpk_lineitem_orders_2#3048, cval_lineitem_l_quantity#3016 AS cval_lineitem_l_quantity_2#3049, cval_lineitem_l_extendedprice#3017 AS cval_lineitem_l_extendedprice_2#3050, cval_lineitem_l_discount#3018 AS cval_lineitem_l_discount_2#3051, cval_lineitem_l_tax#3019 AS cval_lineitem_l_tax_2#3052, cval_lineitem_l_returnflag#3020 AS cval_lineitem_l_returnflag_2#3053, cval_lineitem_l_linestatus#3021 AS cval_lineitem_l_linestatus_2#3054, cval_lineitem_l_commitdate#3022 AS cval_lineitem_l_commitdate_2#3055, cval_lineitem_l_receiptdate#3023 AS cval_lineitem_l_receiptdate_2#3056, cval_lineitem_l_shipinstruct#3024 AS cval_lineitem_l_shipinstruct_2#3057, cval_lineitem_l_shipmode#3025 AS cval_lineitem_l_shipmode_2#3058, cval_lineitem_l_comment#3026 AS cval_lineitem_l_comment_2#3059, cval_lineitem_l_shipdate#3027 AS cval_lineitem_l_shipdate_2#3060, cl_quantity#3028 AS cl_quantity_2#3061, cl_extendedprice#3029 AS cl_extendedprice_2#3062, cl_discount#3030 AS cl_discount_2#3063, ... 9 more fields]
                  :     :  :     +- Relation[rid#3007,cpfk_orders_lineitem#3008,cpfk_supplier_lineitem#3009,cfpk_lineitem_supplier#3010,cfpk_lineitem_partsupp#3011,cpfk_part_lineitem#3012,cfpk_lineitem_part#3013,cpfk_partsupp_lineitem#3014,cfpk_lineitem_orders#3015,cval_lineitem_l_quantity#3016,cval_lineitem_l_extendedprice#3017,cval_lineitem_l_discount#3018,cval_lineitem_l_tax#3019,cval_lineitem_l_returnflag#3020,cval_lineitem_l_linestatus#3021,cval_lineitem_l_commitdate#3022,cval_lineitem_l_receiptdate#3023,cval_lineitem_l_shipinstruct#3024,cval_lineitem_l_shipmode#3025,cval_lineitem_l_comment#3026,cval_lineitem_l_shipdate#3027,cl_quantity#3028,cl_extendedprice#3029,cl_discount#3030,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#2907 AS rid_2#2940, cpfk_orders_lineitem#2908 AS cpfk_orders_lineitem_2#2941, cpfk_supplier_lineitem#2909 AS cpfk_supplier_lineitem_2#2942, cfpk_lineitem_supplier#2910 AS cfpk_lineitem_supplier_2#2943, cfpk_lineitem_partsupp#2911 AS cfpk_lineitem_partsupp_2#2944, cpfk_part_lineitem#2912 AS cpfk_part_lineitem_2#2945, cfpk_lineitem_part#2913 AS cfpk_lineitem_part_2#2946, cpfk_partsupp_lineitem#2914 AS cpfk_partsupp_lineitem_2#2947, cfpk_lineitem_orders#2915 AS cfpk_lineitem_orders_2#2948, cval_lineitem_l_quantity#2916 AS cval_lineitem_l_quantity_2#2949, cval_lineitem_l_extendedprice#2917 AS cval_lineitem_l_extendedprice_2#2950, cval_lineitem_l_discount#2918 AS cval_lineitem_l_discount_2#2951, cval_lineitem_l_tax#2919 AS cval_lineitem_l_tax_2#2952, cval_lineitem_l_returnflag#2920 AS cval_lineitem_l_returnflag_2#2953, cval_lineitem_l_linestatus#2921 AS cval_lineitem_l_linestatus_2#2954, cval_lineitem_l_commitdate#2922 AS cval_lineitem_l_commitdate_2#2955, cval_lineitem_l_receiptdate#2923 AS cval_lineitem_l_receiptdate_2#2956, cval_lineitem_l_shipinstruct#2924 AS cval_lineitem_l_shipinstruct_2#2957, cval_lineitem_l_shipmode#2925 AS cval_lineitem_l_shipmode_2#2958, cval_lineitem_l_comment#2926 AS cval_lineitem_l_comment_2#2959, cval_lineitem_l_shipdate#2927 AS cval_lineitem_l_shipdate_2#2960, cl_quantity#2928 AS cl_quantity_2#2961, cl_extendedprice#2929 AS cl_extendedprice_2#2962, cl_discount#2930 AS cl_discount_2#2963, ... 9 more fields]
                  :     :     +- Relation[rid#2907,cpfk_orders_lineitem#2908,cpfk_supplier_lineitem#2909,cfpk_lineitem_supplier#2910,cfpk_lineitem_partsupp#2911,cpfk_part_lineitem#2912,cfpk_lineitem_part#2913,cpfk_partsupp_lineitem#2914,cfpk_lineitem_orders#2915,cval_lineitem_l_quantity#2916,cval_lineitem_l_extendedprice#2917,cval_lineitem_l_discount#2918,cval_lineitem_l_tax#2919,cval_lineitem_l_returnflag#2920,cval_lineitem_l_linestatus#2921,cval_lineitem_l_commitdate#2922,cval_lineitem_l_receiptdate#2923,cval_lineitem_l_shipinstruct#2924,cval_lineitem_l_shipmode#2925,cval_lineitem_l_comment#2926,cval_lineitem_l_shipdate#2927,cl_quantity#2928,cl_extendedprice#2929,cl_discount#2930,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#3073 AS rid_3#3086, cpfk_nation_supplier#3074 AS cpfk_nation_supplier_3#3087, cfpk_supplier_nation#3075 AS cfpk_supplier_nation_3#3088, cval_supplier_s_name#3076 AS cval_supplier_s_name_3#3089, cval_supplier_s_address#3077 AS cval_supplier_s_address_3#3090, cval_supplier_s_phone#3078 AS cval_supplier_s_phone_3#3091, cval_supplier_s_acctbal#3079 AS cval_supplier_s_acctbal_3#3092, cval_supplier_s_comment#3080 AS cval_supplier_s_comment_3#3093, cs_name#3081 AS cs_name_3#3094, cs_address#3082 AS cs_address_3#3095, cs_phone#3083 AS cs_phone_3#3096, cs_acctbal#3084 AS cs_acctbal_3#3097, cs_comment#3085 AS cs_comment_3#3098]
                  :        +- Relation[rid#3073,cpfk_nation_supplier#3074,cfpk_supplier_nation#3075,cval_supplier_s_name#3076,cval_supplier_s_address#3077,cval_supplier_s_phone#3078,cval_supplier_s_acctbal#3079,cval_supplier_s_comment#3080,cs_name#3081,cs_address#3082,cs_phone#3083,cs_acctbal#3084,cs_comment#3085] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#3099 AS rid_4#3106, cpfk_region_nation#3100 AS cpfk_region_nation_4#3107, cfpk_nation_region#3101 AS cfpk_nation_region_4#3108, cval_nation_n_name#3102 AS cval_nation_n_name_4#3109, cval_nation_n_comment#3103 AS cval_nation_n_comment_4#3110, cn_name#3104 AS cn_name_4#3111, cn_comment#3105 AS cn_comment_4#3112]
                     :  +- Relation[rid#3099,cpfk_region_nation#3100,cfpk_nation_region#3101,cval_nation_n_name#3102,cval_nation_n_comment#3103,cn_name#3104,cn_comment#3105] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#3113 AS rid_4#3120, cpfk_region_nation#3114 AS cpfk_region_nation_4#3121, cfpk_nation_region#3115 AS cfpk_nation_region_4#3122, cval_nation_n_name#3116 AS cval_nation_n_name_4#3123, cval_nation_n_comment#3117 AS cval_nation_n_comment_4#3124, cn_name#3118 AS cn_name_4#3125, cn_comment#3119 AS cn_comment_4#3126]
                           +- Relation[rid#3113,cpfk_region_nation#3114,cfpk_nation_region#3115,cval_nation_n_name#3116,cval_nation_n_comment#3117,cn_name#3118,cn_comment#3119] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=120762
Elapsed time: 89709ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/15 17:18:54 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:18:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3235L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:18:54 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:18:54 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:18:54 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:18:54 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:18:54 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:18:54 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:18:54 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:18:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3235L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#3237 AS rid_0#3254, cval_part_p_name#3238 AS cval_part_p_name_0#3255, cval_part_p_mfgr#3239 AS cval_part_p_mfgr_0#3256, cval_part_p_type#3240 AS cval_part_p_type_0#3257, cval_part_p_size#3241 AS cval_part_p_size_0#3258, cval_part_p_container#3242 AS cval_part_p_container_0#3259, cval_part_p_retailprice#3243 AS cval_part_p_retailprice_0#3260, cval_part_p_comment#3244 AS cval_part_p_comment_0#3261, cval_part_p_brand#3245 AS cval_part_p_brand_0#3262, cp_name#3246 AS cp_name_0#3263, cp_mfgr#3247 AS cp_mfgr_0#3264, cp_type#3248 AS cp_type_0#3265, cp_size#3249 AS cp_size_0#3266, cp_container#3250 AS cp_container_0#3267, cp_retailprice#3251 AS cp_retailprice_0#3268, cp_comment#3252 AS cp_comment_0#3269, cp_brand#3253 AS cp_brand_0#3270]
         :  :  :  :  +- Relation[rid#3237,cval_part_p_name#3238,cval_part_p_mfgr#3239,cval_part_p_type#3240,cval_part_p_size#3241,cval_part_p_container#3242,cval_part_p_retailprice#3243,cval_part_p_comment#3244,cval_part_p_brand#3245,cp_name#3246,cp_mfgr#3247,cp_type#3248,cp_size#3249,cp_container#3250,cp_retailprice#3251,cp_comment#3252,cp_brand#3253] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#3271 AS rid_0#3288, cval_part_p_name#3272 AS cval_part_p_name_0#3289, cval_part_p_mfgr#3273 AS cval_part_p_mfgr_0#3290, cval_part_p_type#3274 AS cval_part_p_type_0#3291, cval_part_p_size#3275 AS cval_part_p_size_0#3292, cval_part_p_container#3276 AS cval_part_p_container_0#3293, cval_part_p_retailprice#3277 AS cval_part_p_retailprice_0#3294, cval_part_p_comment#3278 AS cval_part_p_comment_0#3295, cval_part_p_brand#3279 AS cval_part_p_brand_0#3296, cp_name#3280 AS cp_name_0#3297, cp_mfgr#3281 AS cp_mfgr_0#3298, cp_type#3282 AS cp_type_0#3299, cp_size#3283 AS cp_size_0#3300, cp_container#3284 AS cp_container_0#3301, cp_retailprice#3285 AS cp_retailprice_0#3302, cp_comment#3286 AS cp_comment_0#3303, cp_brand#3287 AS cp_brand_0#3304]
         :  :  :        +- Relation[rid#3271,cval_part_p_name#3272,cval_part_p_mfgr#3273,cval_part_p_type#3274,cval_part_p_size#3275,cval_part_p_container#3276,cval_part_p_retailprice#3277,cval_part_p_comment#3278,cval_part_p_brand#3279,cp_name#3280,cp_mfgr#3281,cp_type#3282,cp_size#3283,cp_container#3284,cp_retailprice#3285,cp_comment#3286,cp_brand#3287] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#3305 AS rid_0#3322, cval_part_p_name#3306 AS cval_part_p_name_0#3323, cval_part_p_mfgr#3307 AS cval_part_p_mfgr_0#3324, cval_part_p_type#3308 AS cval_part_p_type_0#3325, cval_part_p_size#3309 AS cval_part_p_size_0#3326, cval_part_p_container#3310 AS cval_part_p_container_0#3327, cval_part_p_retailprice#3311 AS cval_part_p_retailprice_0#3328, cval_part_p_comment#3312 AS cval_part_p_comment_0#3329, cval_part_p_brand#3313 AS cval_part_p_brand_0#3330, cp_name#3314 AS cp_name_0#3331, cp_mfgr#3315 AS cp_mfgr_0#3332, cp_type#3316 AS cp_type_0#3333, cp_size#3317 AS cp_size_0#3334, cp_container#3318 AS cp_container_0#3335, cp_retailprice#3319 AS cp_retailprice_0#3336, cp_comment#3320 AS cp_comment_0#3337, cp_brand#3321 AS cp_brand_0#3338]
         :  :        +- Relation[rid#3305,cval_part_p_name#3306,cval_part_p_mfgr#3307,cval_part_p_type#3308,cval_part_p_size#3309,cval_part_p_container#3310,cval_part_p_retailprice#3311,cval_part_p_comment#3312,cval_part_p_brand#3313,cp_name#3314,cp_mfgr#3315,cp_type#3316,cp_size#3317,cp_container#3318,cp_retailprice#3319,cp_comment#3320,cp_brand#3321] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#3571 AS rid_1#3604, cpfk_orders_lineitem#3572 AS cpfk_orders_lineitem_1#3605, cpfk_supplier_lineitem#3573 AS cpfk_supplier_lineitem_1#3606, cfpk_lineitem_supplier#3574 AS cfpk_lineitem_supplier_1#3607, cfpk_lineitem_partsupp#3575 AS cfpk_lineitem_partsupp_1#3608, cpfk_part_lineitem#3576 AS cpfk_part_lineitem_1#3609, cfpk_lineitem_part#3577 AS cfpk_lineitem_part_1#3610, cpfk_partsupp_lineitem#3578 AS cpfk_partsupp_lineitem_1#3611, cfpk_lineitem_orders#3579 AS cfpk_lineitem_orders_1#3612, cval_lineitem_l_quantity#3580 AS cval_lineitem_l_quantity_1#3613, cval_lineitem_l_extendedprice#3581 AS cval_lineitem_l_extendedprice_1#3614, cval_lineitem_l_discount#3582 AS cval_lineitem_l_discount_1#3615, cval_lineitem_l_tax#3583 AS cval_lineitem_l_tax_1#3616, cval_lineitem_l_returnflag#3584 AS cval_lineitem_l_returnflag_1#3617, cval_lineitem_l_linestatus#3585 AS cval_lineitem_l_linestatus_1#3618, cval_lineitem_l_commitdate#3586 AS cval_lineitem_l_commitdate_1#3619, cval_lineitem_l_receiptdate#3587 AS cval_lineitem_l_receiptdate_1#3620, cval_lineitem_l_shipinstruct#3588 AS cval_lineitem_l_shipinstruct_1#3621, cval_lineitem_l_shipmode#3589 AS cval_lineitem_l_shipmode_1#3622, cval_lineitem_l_comment#3590 AS cval_lineitem_l_comment_1#3623, cval_lineitem_l_shipdate#3591 AS cval_lineitem_l_shipdate_1#3624, cl_quantity#3592 AS cl_quantity_1#3625, cl_extendedprice#3593 AS cl_extendedprice_1#3626, cl_discount#3594 AS cl_discount_1#3627, ... 9 more fields]
         :     +- Relation[rid#3571,cpfk_orders_lineitem#3572,cpfk_supplier_lineitem#3573,cfpk_lineitem_supplier#3574,cfpk_lineitem_partsupp#3575,cpfk_part_lineitem#3576,cfpk_lineitem_part#3577,cpfk_partsupp_lineitem#3578,cfpk_lineitem_orders#3579,cval_lineitem_l_quantity#3580,cval_lineitem_l_extendedprice#3581,cval_lineitem_l_discount#3582,cval_lineitem_l_tax#3583,cval_lineitem_l_returnflag#3584,cval_lineitem_l_linestatus#3585,cval_lineitem_l_commitdate#3586,cval_lineitem_l_receiptdate#3587,cval_lineitem_l_shipinstruct#3588,cval_lineitem_l_shipmode#3589,cval_lineitem_l_comment#3590,cval_lineitem_l_shipdate#3591,cl_quantity#3592,cl_extendedprice#3593,cl_discount#3594,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#3339 AS rid_1#3372, cpfk_orders_lineitem#3340 AS cpfk_orders_lineitem_1#3373, cpfk_supplier_lineitem#3341 AS cpfk_supplier_lineitem_1#3374, cfpk_lineitem_supplier#3342 AS cfpk_lineitem_supplier_1#3375, cfpk_lineitem_partsupp#3343 AS cfpk_lineitem_partsupp_1#3376, cpfk_part_lineitem#3344 AS cpfk_part_lineitem_1#3377, cfpk_lineitem_part#3345 AS cfpk_lineitem_part_1#3378, cpfk_partsupp_lineitem#3346 AS cpfk_partsupp_lineitem_1#3379, cfpk_lineitem_orders#3347 AS cfpk_lineitem_orders_1#3380, cval_lineitem_l_quantity#3348 AS cval_lineitem_l_quantity_1#3381, cval_lineitem_l_extendedprice#3349 AS cval_lineitem_l_extendedprice_1#3382, cval_lineitem_l_discount#3350 AS cval_lineitem_l_discount_1#3383, cval_lineitem_l_tax#3351 AS cval_lineitem_l_tax_1#3384, cval_lineitem_l_returnflag#3352 AS cval_lineitem_l_returnflag_1#3385, cval_lineitem_l_linestatus#3353 AS cval_lineitem_l_linestatus_1#3386, cval_lineitem_l_commitdate#3354 AS cval_lineitem_l_commitdate_1#3387, cval_lineitem_l_receiptdate#3355 AS cval_lineitem_l_receiptdate_1#3388, cval_lineitem_l_shipinstruct#3356 AS cval_lineitem_l_shipinstruct_1#3389, cval_lineitem_l_shipmode#3357 AS cval_lineitem_l_shipmode_1#3390, cval_lineitem_l_comment#3358 AS cval_lineitem_l_comment_1#3391, cval_lineitem_l_shipdate#3359 AS cval_lineitem_l_shipdate_1#3392, cl_quantity#3360 AS cl_quantity_1#3393, cl_extendedprice#3361 AS cl_extendedprice_1#3394, cl_discount#3362 AS cl_discount_1#3395, ... 9 more fields]
            :  :  +- Relation[rid#3339,cpfk_orders_lineitem#3340,cpfk_supplier_lineitem#3341,cfpk_lineitem_supplier#3342,cfpk_lineitem_partsupp#3343,cpfk_part_lineitem#3344,cfpk_lineitem_part#3345,cpfk_partsupp_lineitem#3346,cfpk_lineitem_orders#3347,cval_lineitem_l_quantity#3348,cval_lineitem_l_extendedprice#3349,cval_lineitem_l_discount#3350,cval_lineitem_l_tax#3351,cval_lineitem_l_returnflag#3352,cval_lineitem_l_linestatus#3353,cval_lineitem_l_commitdate#3354,cval_lineitem_l_receiptdate#3355,cval_lineitem_l_shipinstruct#3356,cval_lineitem_l_shipmode#3357,cval_lineitem_l_comment#3358,cval_lineitem_l_shipdate#3359,cl_quantity#3360,cl_extendedprice#3361,cl_discount#3362,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#3405 AS rid_1#3438, cpfk_orders_lineitem#3406 AS cpfk_orders_lineitem_1#3439, cpfk_supplier_lineitem#3407 AS cpfk_supplier_lineitem_1#3440, cfpk_lineitem_supplier#3408 AS cfpk_lineitem_supplier_1#3441, cfpk_lineitem_partsupp#3409 AS cfpk_lineitem_partsupp_1#3442, cpfk_part_lineitem#3410 AS cpfk_part_lineitem_1#3443, cfpk_lineitem_part#3411 AS cfpk_lineitem_part_1#3444, cpfk_partsupp_lineitem#3412 AS cpfk_partsupp_lineitem_1#3445, cfpk_lineitem_orders#3413 AS cfpk_lineitem_orders_1#3446, cval_lineitem_l_quantity#3414 AS cval_lineitem_l_quantity_1#3447, cval_lineitem_l_extendedprice#3415 AS cval_lineitem_l_extendedprice_1#3448, cval_lineitem_l_discount#3416 AS cval_lineitem_l_discount_1#3449, cval_lineitem_l_tax#3417 AS cval_lineitem_l_tax_1#3450, cval_lineitem_l_returnflag#3418 AS cval_lineitem_l_returnflag_1#3451, cval_lineitem_l_linestatus#3419 AS cval_lineitem_l_linestatus_1#3452, cval_lineitem_l_commitdate#3420 AS cval_lineitem_l_commitdate_1#3453, cval_lineitem_l_receiptdate#3421 AS cval_lineitem_l_receiptdate_1#3454, cval_lineitem_l_shipinstruct#3422 AS cval_lineitem_l_shipinstruct_1#3455, cval_lineitem_l_shipmode#3423 AS cval_lineitem_l_shipmode_1#3456, cval_lineitem_l_comment#3424 AS cval_lineitem_l_comment_1#3457, cval_lineitem_l_shipdate#3425 AS cval_lineitem_l_shipdate_1#3458, cl_quantity#3426 AS cl_quantity_1#3459, cl_extendedprice#3427 AS cl_extendedprice_1#3460, cl_discount#3428 AS cl_discount_1#3461, ... 9 more fields]
            :        +- Relation[rid#3405,cpfk_orders_lineitem#3406,cpfk_supplier_lineitem#3407,cfpk_lineitem_supplier#3408,cfpk_lineitem_partsupp#3409,cpfk_part_lineitem#3410,cfpk_lineitem_part#3411,cpfk_partsupp_lineitem#3412,cfpk_lineitem_orders#3413,cval_lineitem_l_quantity#3414,cval_lineitem_l_extendedprice#3415,cval_lineitem_l_discount#3416,cval_lineitem_l_tax#3417,cval_lineitem_l_returnflag#3418,cval_lineitem_l_linestatus#3419,cval_lineitem_l_commitdate#3420,cval_lineitem_l_receiptdate#3421,cval_lineitem_l_shipinstruct#3422,cval_lineitem_l_shipmode#3423,cval_lineitem_l_comment#3424,cval_lineitem_l_shipdate#3425,cl_quantity#3426,cl_extendedprice#3427,cl_discount#3428,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#3471 AS rid_1#3504, cpfk_orders_lineitem#3472 AS cpfk_orders_lineitem_1#3505, cpfk_supplier_lineitem#3473 AS cpfk_supplier_lineitem_1#3506, cfpk_lineitem_supplier#3474 AS cfpk_lineitem_supplier_1#3507, cfpk_lineitem_partsupp#3475 AS cfpk_lineitem_partsupp_1#3508, cpfk_part_lineitem#3476 AS cpfk_part_lineitem_1#3509, cfpk_lineitem_part#3477 AS cfpk_lineitem_part_1#3510, cpfk_partsupp_lineitem#3478 AS cpfk_partsupp_lineitem_1#3511, cfpk_lineitem_orders#3479 AS cfpk_lineitem_orders_1#3512, cval_lineitem_l_quantity#3480 AS cval_lineitem_l_quantity_1#3513, cval_lineitem_l_extendedprice#3481 AS cval_lineitem_l_extendedprice_1#3514, cval_lineitem_l_discount#3482 AS cval_lineitem_l_discount_1#3515, cval_lineitem_l_tax#3483 AS cval_lineitem_l_tax_1#3516, cval_lineitem_l_returnflag#3484 AS cval_lineitem_l_returnflag_1#3517, cval_lineitem_l_linestatus#3485 AS cval_lineitem_l_linestatus_1#3518, cval_lineitem_l_commitdate#3486 AS cval_lineitem_l_commitdate_1#3519, cval_lineitem_l_receiptdate#3487 AS cval_lineitem_l_receiptdate_1#3520, cval_lineitem_l_shipinstruct#3488 AS cval_lineitem_l_shipinstruct_1#3521, cval_lineitem_l_shipmode#3489 AS cval_lineitem_l_shipmode_1#3522, cval_lineitem_l_comment#3490 AS cval_lineitem_l_comment_1#3523, cval_lineitem_l_shipdate#3491 AS cval_lineitem_l_shipdate_1#3524, cl_quantity#3492 AS cl_quantity_1#3525, cl_extendedprice#3493 AS cl_extendedprice_1#3526, cl_discount#3494 AS cl_discount_1#3527, ... 9 more fields]
                  +- Relation[rid#3471,cpfk_orders_lineitem#3472,cpfk_supplier_lineitem#3473,cfpk_lineitem_supplier#3474,cfpk_lineitem_partsupp#3475,cpfk_part_lineitem#3476,cfpk_lineitem_part#3477,cpfk_partsupp_lineitem#3478,cfpk_lineitem_orders#3479,cval_lineitem_l_quantity#3480,cval_lineitem_l_extendedprice#3481,cval_lineitem_l_discount#3482,cval_lineitem_l_tax#3483,cval_lineitem_l_returnflag#3484,cval_lineitem_l_linestatus#3485,cval_lineitem_l_commitdate#3486,cval_lineitem_l_receiptdate#3487,cval_lineitem_l_shipinstruct#3488,cval_lineitem_l_shipmode#3489,cval_lineitem_l_comment#3490,cval_lineitem_l_shipdate#3491,cl_quantity#3492,cl_extendedprice#3493,cl_discount#3494,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=13
Elapsed time: 62943ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/15 17:19:57 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:19:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3696L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:19:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3696L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#3698 AS rid_0#3713, cpfk_nation_customer#3699 AS cpfk_nation_customer_0#3714, cfpk_customer_nation#3700 AS cfpk_customer_nation_0#3715, cval_customer_c_name#3701 AS cval_customer_c_name_0#3716, cval_customer_c_address#3702 AS cval_customer_c_address_0#3717, cval_customer_c_phone#3703 AS cval_customer_c_phone_0#3718, cval_customer_c_acctbal#3704 AS cval_customer_c_acctbal_0#3719, cval_customer_c_comment#3705 AS cval_customer_c_comment_0#3720, cval_customer_c_mktsegment#3706 AS cval_customer_c_mktsegment_0#3721, cc_name#3707 AS cc_name_0#3722, cc_address#3708 AS cc_address_0#3723, cc_phone#3709 AS cc_phone_0#3724, cc_acctbal#3710 AS cc_acctbal_0#3725, cc_comment#3711 AS cc_comment_0#3726, cc_mktsegment#3712 AS cc_mktsegment_0#3727]
         :  :  :  :  +- Relation[rid#3698,cpfk_nation_customer#3699,cfpk_customer_nation#3700,cval_customer_c_name#3701,cval_customer_c_address#3702,cval_customer_c_phone#3703,cval_customer_c_acctbal#3704,cval_customer_c_comment#3705,cval_customer_c_mktsegment#3706,cc_name#3707,cc_address#3708,cc_phone#3709,cc_acctbal#3710,cc_comment#3711,cc_mktsegment#3712] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#3762 AS rid_0#3777, cpfk_nation_customer#3763 AS cpfk_nation_customer_0#3778, cfpk_customer_nation#3764 AS cfpk_customer_nation_0#3779, cval_customer_c_name#3765 AS cval_customer_c_name_0#3780, cval_customer_c_address#3766 AS cval_customer_c_address_0#3781, cval_customer_c_phone#3767 AS cval_customer_c_phone_0#3782, cval_customer_c_acctbal#3768 AS cval_customer_c_acctbal_0#3783, cval_customer_c_comment#3769 AS cval_customer_c_comment_0#3784, cval_customer_c_mktsegment#3770 AS cval_customer_c_mktsegment_0#3785, cc_name#3771 AS cc_name_0#3786, cc_address#3772 AS cc_address_0#3787, cc_phone#3773 AS cc_phone_0#3788, cc_acctbal#3774 AS cc_acctbal_0#3789, cc_comment#3775 AS cc_comment_0#3790, cc_mktsegment#3776 AS cc_mktsegment_0#3791]
         :  :  :     :  +- Relation[rid#3762,cpfk_nation_customer#3763,cfpk_customer_nation#3764,cval_customer_c_name#3765,cval_customer_c_address#3766,cval_customer_c_phone#3767,cval_customer_c_acctbal#3768,cval_customer_c_comment#3769,cval_customer_c_mktsegment#3770,cc_name#3771,cc_address#3772,cc_phone#3773,cc_acctbal#3774,cc_comment#3775,cc_mktsegment#3776] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#3792 AS rid_1#3809, cpfk_customer_orders#3793 AS cpfk_customer_orders_1#3810, cfpk_orders_customer#3794 AS cfpk_orders_customer_1#3811, cval_orders_o_orderstatus#3795 AS cval_orders_o_orderstatus_1#3812, cval_orders_o_totalprice#3796 AS cval_orders_o_totalprice_1#3813, cval_orders_o_orderpriority#3797 AS cval_orders_o_orderpriority_1#3814, cval_orders_o_clerk#3798 AS cval_orders_o_clerk_1#3815, cval_orders_o_shippriority#3799 AS cval_orders_o_shippriority_1#3816, cval_orders_o_comment#3800 AS cval_orders_o_comment_1#3817, cval_orders_o_orderdate#3801 AS cval_orders_o_orderdate_1#3818, co_orderstatus#3802 AS co_orderstatus_1#3819, co_totalprice#3803 AS co_totalprice_1#3820, co_orderpriority#3804 AS co_orderpriority_1#3821, co_clerk#3805 AS co_clerk_1#3822, co_shippriority#3806 AS co_shippriority_1#3823, co_comment#3807 AS co_comment_1#3824, co_orderdate#3808 AS co_orderdate_1#3825]
         :  :  :        +- Relation[rid#3792,cpfk_customer_orders#3793,cfpk_orders_customer#3794,cval_orders_o_orderstatus#3795,cval_orders_o_totalprice#3796,cval_orders_o_orderpriority#3797,cval_orders_o_clerk#3798,cval_orders_o_shippriority#3799,cval_orders_o_comment#3800,cval_orders_o_orderdate#3801,co_orderstatus#3802,co_totalprice#3803,co_orderpriority#3804,co_clerk#3805,co_shippriority#3806,co_comment#3807,co_orderdate#3808] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#3728 AS rid_1#3745, cpfk_customer_orders#3729 AS cpfk_customer_orders_1#3746, cfpk_orders_customer#3730 AS cfpk_orders_customer_1#3747, cval_orders_o_orderstatus#3731 AS cval_orders_o_orderstatus_1#3748, cval_orders_o_totalprice#3732 AS cval_orders_o_totalprice_1#3749, cval_orders_o_orderpriority#3733 AS cval_orders_o_orderpriority_1#3750, cval_orders_o_clerk#3734 AS cval_orders_o_clerk_1#3751, cval_orders_o_shippriority#3735 AS cval_orders_o_shippriority_1#3752, cval_orders_o_comment#3736 AS cval_orders_o_comment_1#3753, cval_orders_o_orderdate#3737 AS cval_orders_o_orderdate_1#3754, co_orderstatus#3738 AS co_orderstatus_1#3755, co_totalprice#3739 AS co_totalprice_1#3756, co_orderpriority#3740 AS co_orderpriority_1#3757, co_clerk#3741 AS co_clerk_1#3758, co_shippriority#3742 AS co_shippriority_1#3759, co_comment#3743 AS co_comment_1#3760, co_orderdate#3744 AS co_orderdate_1#3761]
         :  :     +- Relation[rid#3728,cpfk_customer_orders#3729,cfpk_orders_customer#3730,cval_orders_o_orderstatus#3731,cval_orders_o_totalprice#3732,cval_orders_o_orderpriority#3733,cval_orders_o_clerk#3734,cval_orders_o_shippriority#3735,cval_orders_o_comment#3736,cval_orders_o_orderdate#3737,co_orderstatus#3738,co_totalprice#3739,co_orderpriority#3740,co_clerk#3741,co_shippriority#3742,co_comment#3743,co_orderdate#3744] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#3892 AS rid_1#3909, cpfk_customer_orders#3893 AS cpfk_customer_orders_1#3910, cfpk_orders_customer#3894 AS cfpk_orders_customer_1#3911, cval_orders_o_orderstatus#3895 AS cval_orders_o_orderstatus_1#3912, cval_orders_o_totalprice#3896 AS cval_orders_o_totalprice_1#3913, cval_orders_o_orderpriority#3897 AS cval_orders_o_orderpriority_1#3914, cval_orders_o_clerk#3898 AS cval_orders_o_clerk_1#3915, cval_orders_o_shippriority#3899 AS cval_orders_o_shippriority_1#3916, cval_orders_o_comment#3900 AS cval_orders_o_comment_1#3917, cval_orders_o_orderdate#3901 AS cval_orders_o_orderdate_1#3918, co_orderstatus#3902 AS co_orderstatus_1#3919, co_totalprice#3903 AS co_totalprice_1#3920, co_orderpriority#3904 AS co_orderpriority_1#3921, co_clerk#3905 AS co_clerk_1#3922, co_shippriority#3906 AS co_shippriority_1#3923, co_comment#3907 AS co_comment_1#3924, co_orderdate#3908 AS co_orderdate_1#3925]
         :     :  +- Relation[rid#3892,cpfk_customer_orders#3893,cfpk_orders_customer#3894,cval_orders_o_orderstatus#3895,cval_orders_o_totalprice#3896,cval_orders_o_orderpriority#3897,cval_orders_o_clerk#3898,cval_orders_o_shippriority#3899,cval_orders_o_comment#3900,cval_orders_o_orderdate#3901,co_orderstatus#3902,co_totalprice#3903,co_orderpriority#3904,co_clerk#3905,co_shippriority#3906,co_comment#3907,co_orderdate#3908] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#3926 AS rid_2#3959, cpfk_orders_lineitem#3927 AS cpfk_orders_lineitem_2#3960, cpfk_supplier_lineitem#3928 AS cpfk_supplier_lineitem_2#3961, cfpk_lineitem_supplier#3929 AS cfpk_lineitem_supplier_2#3962, cfpk_lineitem_partsupp#3930 AS cfpk_lineitem_partsupp_2#3963, cpfk_part_lineitem#3931 AS cpfk_part_lineitem_2#3964, cfpk_lineitem_part#3932 AS cfpk_lineitem_part_2#3965, cpfk_partsupp_lineitem#3933 AS cpfk_partsupp_lineitem_2#3966, cfpk_lineitem_orders#3934 AS cfpk_lineitem_orders_2#3967, cval_lineitem_l_quantity#3935 AS cval_lineitem_l_quantity_2#3968, cval_lineitem_l_extendedprice#3936 AS cval_lineitem_l_extendedprice_2#3969, cval_lineitem_l_discount#3937 AS cval_lineitem_l_discount_2#3970, cval_lineitem_l_tax#3938 AS cval_lineitem_l_tax_2#3971, cval_lineitem_l_returnflag#3939 AS cval_lineitem_l_returnflag_2#3972, cval_lineitem_l_linestatus#3940 AS cval_lineitem_l_linestatus_2#3973, cval_lineitem_l_commitdate#3941 AS cval_lineitem_l_commitdate_2#3974, cval_lineitem_l_receiptdate#3942 AS cval_lineitem_l_receiptdate_2#3975, cval_lineitem_l_shipinstruct#3943 AS cval_lineitem_l_shipinstruct_2#3976, cval_lineitem_l_shipmode#3944 AS cval_lineitem_l_shipmode_2#3977, cval_lineitem_l_comment#3945 AS cval_lineitem_l_comment_2#3978, cval_lineitem_l_shipdate#3946 AS cval_lineitem_l_shipdate_2#3979, cl_quantity#3947 AS cl_quantity_2#3980, cl_extendedprice#3948 AS cl_extendedprice_2#3981, cl_discount#3949 AS cl_discount_2#3982, ... 9 more fields]
         :        +- Relation[rid#3926,cpfk_orders_lineitem#3927,cpfk_supplier_lineitem#3928,cfpk_lineitem_supplier#3929,cfpk_lineitem_partsupp#3930,cpfk_part_lineitem#3931,cfpk_lineitem_part#3932,cpfk_partsupp_lineitem#3933,cfpk_lineitem_orders#3934,cval_lineitem_l_quantity#3935,cval_lineitem_l_extendedprice#3936,cval_lineitem_l_discount#3937,cval_lineitem_l_tax#3938,cval_lineitem_l_returnflag#3939,cval_lineitem_l_linestatus#3940,cval_lineitem_l_commitdate#3941,cval_lineitem_l_receiptdate#3942,cval_lineitem_l_shipinstruct#3943,cval_lineitem_l_shipmode#3944,cval_lineitem_l_comment#3945,cval_lineitem_l_shipdate#3946,cl_quantity#3947,cl_extendedprice#3948,cl_discount#3949,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#3826 AS rid_2#3859, cpfk_orders_lineitem#3827 AS cpfk_orders_lineitem_2#3860, cpfk_supplier_lineitem#3828 AS cpfk_supplier_lineitem_2#3861, cfpk_lineitem_supplier#3829 AS cfpk_lineitem_supplier_2#3862, cfpk_lineitem_partsupp#3830 AS cfpk_lineitem_partsupp_2#3863, cpfk_part_lineitem#3831 AS cpfk_part_lineitem_2#3864, cfpk_lineitem_part#3832 AS cfpk_lineitem_part_2#3865, cpfk_partsupp_lineitem#3833 AS cpfk_partsupp_lineitem_2#3866, cfpk_lineitem_orders#3834 AS cfpk_lineitem_orders_2#3867, cval_lineitem_l_quantity#3835 AS cval_lineitem_l_quantity_2#3868, cval_lineitem_l_extendedprice#3836 AS cval_lineitem_l_extendedprice_2#3869, cval_lineitem_l_discount#3837 AS cval_lineitem_l_discount_2#3870, cval_lineitem_l_tax#3838 AS cval_lineitem_l_tax_2#3871, cval_lineitem_l_returnflag#3839 AS cval_lineitem_l_returnflag_2#3872, cval_lineitem_l_linestatus#3840 AS cval_lineitem_l_linestatus_2#3873, cval_lineitem_l_commitdate#3841 AS cval_lineitem_l_commitdate_2#3874, cval_lineitem_l_receiptdate#3842 AS cval_lineitem_l_receiptdate_2#3875, cval_lineitem_l_shipinstruct#3843 AS cval_lineitem_l_shipinstruct_2#3876, cval_lineitem_l_shipmode#3844 AS cval_lineitem_l_shipmode_2#3877, cval_lineitem_l_comment#3845 AS cval_lineitem_l_comment_2#3878, cval_lineitem_l_shipdate#3846 AS cval_lineitem_l_shipdate_2#3879, cl_quantity#3847 AS cl_quantity_2#3880, cl_extendedprice#3848 AS cl_extendedprice_2#3881, cl_discount#3849 AS cl_discount_2#3882, ... 9 more fields]
            +- Relation[rid#3826,cpfk_orders_lineitem#3827,cpfk_supplier_lineitem#3828,cfpk_lineitem_supplier#3829,cfpk_lineitem_partsupp#3830,cpfk_part_lineitem#3831,cfpk_lineitem_part#3832,cpfk_partsupp_lineitem#3833,cfpk_lineitem_orders#3834,cval_lineitem_l_quantity#3835,cval_lineitem_l_extendedprice#3836,cval_lineitem_l_discount#3837,cval_lineitem_l_tax#3838,cval_lineitem_l_returnflag#3839,cval_lineitem_l_linestatus#3840,cval_lineitem_l_commitdate#3841,cval_lineitem_l_receiptdate#3842,cval_lineitem_l_shipinstruct#3843,cval_lineitem_l_shipmode#3844,cval_lineitem_l_comment#3845,cval_lineitem_l_shipdate#3846,cl_quantity#3847,cl_extendedprice#3848,cl_discount#3849,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 132378ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/15 17:22:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:22:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4063L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 17:22:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:22:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:22:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:22:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:22:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:22:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:22:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:22:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:22:09 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:22:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:22:09 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:22:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:22:09 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:22:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4063L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#4065 AS rid_0#4072, cpfk_region_nation#4066 AS cpfk_region_nation_0#4073, cfpk_nation_region#4067 AS cfpk_nation_region_0#4074, cval_nation_n_name#4068 AS cval_nation_n_name_0#4075, cval_nation_n_comment#4069 AS cval_nation_n_comment_0#4076, cn_name#4070 AS cn_name_0#4077, cn_comment#4071 AS cn_comment_0#4078]
         :  :  :  :  :  +- Relation[rid#4065,cpfk_region_nation#4066,cfpk_nation_region#4067,cval_nation_n_name#4068,cval_nation_n_comment#4069,cn_name#4070,cn_comment#4071] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#4079 AS rid_0#4086, cpfk_region_nation#4080 AS cpfk_region_nation_0#4087, cfpk_nation_region#4081 AS cfpk_nation_region_0#4088, cval_nation_n_name#4082 AS cval_nation_n_name_0#4089, cval_nation_n_comment#4083 AS cval_nation_n_comment_0#4090, cn_name#4084 AS cn_name_0#4091, cn_comment#4085 AS cn_comment_0#4092]
         :  :  :  :        +- Relation[rid#4079,cpfk_region_nation#4080,cfpk_nation_region#4081,cval_nation_n_name#4082,cval_nation_n_comment#4083,cn_name#4084,cn_comment#4085] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#4133 AS rid_1#4146, cpfk_nation_supplier#4134 AS cpfk_nation_supplier_1#4147, cfpk_supplier_nation#4135 AS cfpk_supplier_nation_1#4148, cval_supplier_s_name#4136 AS cval_supplier_s_name_1#4149, cval_supplier_s_address#4137 AS cval_supplier_s_address_1#4150, cval_supplier_s_phone#4138 AS cval_supplier_s_phone_1#4151, cval_supplier_s_acctbal#4139 AS cval_supplier_s_acctbal_1#4152, cval_supplier_s_comment#4140 AS cval_supplier_s_comment_1#4153, cs_name#4141 AS cs_name_1#4154, cs_address#4142 AS cs_address_1#4155, cs_phone#4143 AS cs_phone_1#4156, cs_acctbal#4144 AS cs_acctbal_1#4157, cs_comment#4145 AS cs_comment_1#4158]
         :  :  :     +- Relation[rid#4133,cpfk_nation_supplier#4134,cfpk_supplier_nation#4135,cval_supplier_s_name#4136,cval_supplier_s_address#4137,cval_supplier_s_phone#4138,cval_supplier_s_acctbal#4139,cval_supplier_s_comment#4140,cs_name#4141,cs_address#4142,cs_phone#4143,cs_acctbal#4144,cs_comment#4145] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#4093 AS rid_1#4106, cpfk_nation_supplier#4094 AS cpfk_nation_supplier_1#4107, cfpk_supplier_nation#4095 AS cfpk_supplier_nation_1#4108, cval_supplier_s_name#4096 AS cval_supplier_s_name_1#4109, cval_supplier_s_address#4097 AS cval_supplier_s_address_1#4110, cval_supplier_s_phone#4098 AS cval_supplier_s_phone_1#4111, cval_supplier_s_acctbal#4099 AS cval_supplier_s_acctbal_1#4112, cval_supplier_s_comment#4100 AS cval_supplier_s_comment_1#4113, cs_name#4101 AS cs_name_1#4114, cs_address#4102 AS cs_address_1#4115, cs_phone#4103 AS cs_phone_1#4116, cs_acctbal#4104 AS cs_acctbal_1#4117, cs_comment#4105 AS cs_comment_1#4118]
         :  :     +- Relation[rid#4093,cpfk_nation_supplier#4094,cfpk_supplier_nation#4095,cval_supplier_s_name#4096,cval_supplier_s_address#4097,cval_supplier_s_phone#4098,cval_supplier_s_acctbal#4099,cval_supplier_s_comment#4100,cs_name#4101,cs_address#4102,cs_phone#4103,cs_acctbal#4104,cs_comment#4105] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#4207 AS rid_2#4218, cpfk_part_partsupp#4208 AS cpfk_part_partsupp_2#4219, cfpk_partsupp_part#4209 AS cfpk_partsupp_part_2#4220, cpfk_supplier_partsupp#4210 AS cpfk_supplier_partsupp_2#4221, cfpk_partsupp_supplier#4211 AS cfpk_partsupp_supplier_2#4222, cval_partsupp_ps_availqty#4212 AS cval_partsupp_ps_availqty_2#4223, cval_partsupp_ps_supplycost#4213 AS cval_partsupp_ps_supplycost_2#4224, cval_partsupp_ps_comment#4214 AS cval_partsupp_ps_comment_2#4225, cps_availqty#4215 AS cps_availqty_2#4226, cps_supplycost#4216 AS cps_supplycost_2#4227, cps_comment#4217 AS cps_comment_2#4228]
         :     +- Relation[rid#4207,cpfk_part_partsupp#4208,cfpk_partsupp_part#4209,cpfk_supplier_partsupp#4210,cfpk_partsupp_supplier#4211,cval_partsupp_ps_availqty#4212,cval_partsupp_ps_supplycost#4213,cval_partsupp_ps_comment#4214,cps_availqty#4215,cps_supplycost#4216,cps_comment#4217] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#4159 AS rid_2#4170, cpfk_part_partsupp#4160 AS cpfk_part_partsupp_2#4171, cfpk_partsupp_part#4161 AS cfpk_partsupp_part_2#4172, cpfk_supplier_partsupp#4162 AS cpfk_supplier_partsupp_2#4173, cfpk_partsupp_supplier#4163 AS cfpk_partsupp_supplier_2#4174, cval_partsupp_ps_availqty#4164 AS cval_partsupp_ps_availqty_2#4175, cval_partsupp_ps_supplycost#4165 AS cval_partsupp_ps_supplycost_2#4176, cval_partsupp_ps_comment#4166 AS cval_partsupp_ps_comment_2#4177, cps_availqty#4167 AS cps_availqty_2#4178, cps_supplycost#4168 AS cps_supplycost_2#4179, cps_comment#4169 AS cps_comment_2#4180]
            +- Relation[rid#4159,cpfk_part_partsupp#4160,cfpk_partsupp_part#4161,cpfk_supplier_partsupp#4162,cfpk_partsupp_supplier#4163,cval_partsupp_ps_availqty#4164,cval_partsupp_ps_supplycost#4165,cval_partsupp_ps_comment#4166,cps_availqty#4167,cps_supplycost#4168,cps_comment#4169] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=4
Elapsed time: 1297ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/15 17:22:10 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:22:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4272L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 17:22:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:22:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:22:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4272L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#4274 AS rid_0#4307, cpfk_orders_lineitem#4275 AS cpfk_orders_lineitem_0#4308, cpfk_supplier_lineitem#4276 AS cpfk_supplier_lineitem_0#4309, cfpk_lineitem_supplier#4277 AS cfpk_lineitem_supplier_0#4310, cfpk_lineitem_partsupp#4278 AS cfpk_lineitem_partsupp_0#4311, cpfk_part_lineitem#4279 AS cpfk_part_lineitem_0#4312, cfpk_lineitem_part#4280 AS cfpk_lineitem_part_0#4313, cpfk_partsupp_lineitem#4281 AS cpfk_partsupp_lineitem_0#4314, cfpk_lineitem_orders#4282 AS cfpk_lineitem_orders_0#4315, cval_lineitem_l_quantity#4283 AS cval_lineitem_l_quantity_0#4316, cval_lineitem_l_extendedprice#4284 AS cval_lineitem_l_extendedprice_0#4317, cval_lineitem_l_discount#4285 AS cval_lineitem_l_discount_0#4318, cval_lineitem_l_tax#4286 AS cval_lineitem_l_tax_0#4319, cval_lineitem_l_returnflag#4287 AS cval_lineitem_l_returnflag_0#4320, cval_lineitem_l_linestatus#4288 AS cval_lineitem_l_linestatus_0#4321, cval_lineitem_l_commitdate#4289 AS cval_lineitem_l_commitdate_0#4322, cval_lineitem_l_receiptdate#4290 AS cval_lineitem_l_receiptdate_0#4323, cval_lineitem_l_shipinstruct#4291 AS cval_lineitem_l_shipinstruct_0#4324, cval_lineitem_l_shipmode#4292 AS cval_lineitem_l_shipmode_0#4325, cval_lineitem_l_comment#4293 AS cval_lineitem_l_comment_0#4326, cval_lineitem_l_shipdate#4294 AS cval_lineitem_l_shipdate_0#4327, cl_quantity#4295 AS cl_quantity_0#4328, cl_extendedprice#4296 AS cl_extendedprice_0#4329, cl_discount#4297 AS cl_discount_0#4330, ... 9 more fields]
            :     :     :  :  +- Relation[rid#4274,cpfk_orders_lineitem#4275,cpfk_supplier_lineitem#4276,cfpk_lineitem_supplier#4277,cfpk_lineitem_partsupp#4278,cpfk_part_lineitem#4279,cfpk_lineitem_part#4280,cpfk_partsupp_lineitem#4281,cfpk_lineitem_orders#4282,cval_lineitem_l_quantity#4283,cval_lineitem_l_extendedprice#4284,cval_lineitem_l_discount#4285,cval_lineitem_l_tax#4286,cval_lineitem_l_returnflag#4287,cval_lineitem_l_linestatus#4288,cval_lineitem_l_commitdate#4289,cval_lineitem_l_receiptdate#4290,cval_lineitem_l_shipinstruct#4291,cval_lineitem_l_shipmode#4292,cval_lineitem_l_comment#4293,cval_lineitem_l_shipdate#4294,cl_quantity#4295,cl_extendedprice#4296,cl_discount#4297,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#4340 AS rid_0#4373, cpfk_orders_lineitem#4341 AS cpfk_orders_lineitem_0#4374, cpfk_supplier_lineitem#4342 AS cpfk_supplier_lineitem_0#4375, cfpk_lineitem_supplier#4343 AS cfpk_lineitem_supplier_0#4376, cfpk_lineitem_partsupp#4344 AS cfpk_lineitem_partsupp_0#4377, cpfk_part_lineitem#4345 AS cpfk_part_lineitem_0#4378, cfpk_lineitem_part#4346 AS cfpk_lineitem_part_0#4379, cpfk_partsupp_lineitem#4347 AS cpfk_partsupp_lineitem_0#4380, cfpk_lineitem_orders#4348 AS cfpk_lineitem_orders_0#4381, cval_lineitem_l_quantity#4349 AS cval_lineitem_l_quantity_0#4382, cval_lineitem_l_extendedprice#4350 AS cval_lineitem_l_extendedprice_0#4383, cval_lineitem_l_discount#4351 AS cval_lineitem_l_discount_0#4384, cval_lineitem_l_tax#4352 AS cval_lineitem_l_tax_0#4385, cval_lineitem_l_returnflag#4353 AS cval_lineitem_l_returnflag_0#4386, cval_lineitem_l_linestatus#4354 AS cval_lineitem_l_linestatus_0#4387, cval_lineitem_l_commitdate#4355 AS cval_lineitem_l_commitdate_0#4388, cval_lineitem_l_receiptdate#4356 AS cval_lineitem_l_receiptdate_0#4389, cval_lineitem_l_shipinstruct#4357 AS cval_lineitem_l_shipinstruct_0#4390, cval_lineitem_l_shipmode#4358 AS cval_lineitem_l_shipmode_0#4391, cval_lineitem_l_comment#4359 AS cval_lineitem_l_comment_0#4392, cval_lineitem_l_shipdate#4360 AS cval_lineitem_l_shipdate_0#4393, cl_quantity#4361 AS cl_quantity_0#4394, cl_extendedprice#4362 AS cl_extendedprice_0#4395, cl_discount#4363 AS cl_discount_0#4396, ... 9 more fields]
            :     :     :        +- Relation[rid#4340,cpfk_orders_lineitem#4341,cpfk_supplier_lineitem#4342,cfpk_lineitem_supplier#4343,cfpk_lineitem_partsupp#4344,cpfk_part_lineitem#4345,cfpk_lineitem_part#4346,cpfk_partsupp_lineitem#4347,cfpk_lineitem_orders#4348,cval_lineitem_l_quantity#4349,cval_lineitem_l_extendedprice#4350,cval_lineitem_l_discount#4351,cval_lineitem_l_tax#4352,cval_lineitem_l_returnflag#4353,cval_lineitem_l_linestatus#4354,cval_lineitem_l_commitdate#4355,cval_lineitem_l_receiptdate#4356,cval_lineitem_l_shipinstruct#4357,cval_lineitem_l_shipmode#4358,cval_lineitem_l_comment#4359,cval_lineitem_l_shipdate#4360,cl_quantity#4361,cl_extendedprice#4362,cl_discount#4363,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#4406 AS rid_1#4423, cpfk_customer_orders#4407 AS cpfk_customer_orders_1#4424, cfpk_orders_customer#4408 AS cfpk_orders_customer_1#4425, cval_orders_o_orderstatus#4409 AS cval_orders_o_orderstatus_1#4426, cval_orders_o_totalprice#4410 AS cval_orders_o_totalprice_1#4427, cval_orders_o_orderpriority#4411 AS cval_orders_o_orderpriority_1#4428, cval_orders_o_clerk#4412 AS cval_orders_o_clerk_1#4429, cval_orders_o_shippriority#4413 AS cval_orders_o_shippriority_1#4430, cval_orders_o_comment#4414 AS cval_orders_o_comment_1#4431, cval_orders_o_orderdate#4415 AS cval_orders_o_orderdate_1#4432, co_orderstatus#4416 AS co_orderstatus_1#4433, co_totalprice#4417 AS co_totalprice_1#4434, co_orderpriority#4418 AS co_orderpriority_1#4435, co_clerk#4419 AS co_clerk_1#4436, co_shippriority#4420 AS co_shippriority_1#4437, co_comment#4421 AS co_comment_1#4438, co_orderdate#4422 AS co_orderdate_1#4439]
            :     :        +- Relation[rid#4406,cpfk_customer_orders#4407,cfpk_orders_customer#4408,cval_orders_o_orderstatus#4409,cval_orders_o_totalprice#4410,cval_orders_o_orderpriority#4411,cval_orders_o_clerk#4412,cval_orders_o_shippriority#4413,cval_orders_o_comment#4414,cval_orders_o_orderdate#4415,co_orderstatus#4416,co_totalprice#4417,co_orderpriority#4418,co_clerk#4419,co_shippriority#4420,co_comment#4421,co_orderdate#4422] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#4440 AS rid_2#4455, cpfk_nation_customer#4441 AS cpfk_nation_customer_2#4456, cfpk_customer_nation#4442 AS cfpk_customer_nation_2#4457, cval_customer_c_name#4443 AS cval_customer_c_name_2#4458, cval_customer_c_address#4444 AS cval_customer_c_address_2#4459, cval_customer_c_phone#4445 AS cval_customer_c_phone_2#4460, cval_customer_c_acctbal#4446 AS cval_customer_c_acctbal_2#4461, cval_customer_c_comment#4447 AS cval_customer_c_comment_2#4462, cval_customer_c_mktsegment#4448 AS cval_customer_c_mktsegment_2#4463, cc_name#4449 AS cc_name_2#4464, cc_address#4450 AS cc_address_2#4465, cc_phone#4451 AS cc_phone_2#4466, cc_acctbal#4452 AS cc_acctbal_2#4467, cc_comment#4453 AS cc_comment_2#4468, cc_mktsegment#4454 AS cc_mktsegment_2#4469]
            :        +- Relation[rid#4440,cpfk_nation_customer#4441,cfpk_customer_nation#4442,cval_customer_c_name#4443,cval_customer_c_address#4444,cval_customer_c_phone#4445,cval_customer_c_acctbal#4446,cval_customer_c_comment#4447,cval_customer_c_mktsegment#4448,cc_name#4449,cc_address#4450,cc_phone#4451,cc_acctbal#4452,cc_comment#4453,cc_mktsegment#4454] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#4470 AS rid_3#4477, cpfk_region_nation#4471 AS cpfk_region_nation_3#4478, cfpk_nation_region#4472 AS cfpk_nation_region_3#4479, cval_nation_n_name#4473 AS cval_nation_n_name_3#4480, cval_nation_n_comment#4474 AS cval_nation_n_comment_3#4481, cn_name#4475 AS cn_name_3#4482, cn_comment#4476 AS cn_comment_3#4483]
               +- Relation[rid#4470,cpfk_region_nation#4471,cfpk_nation_region#4472,cval_nation_n_name#4473,cval_nation_n_comment#4474,cn_name#4475,cn_comment#4476] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 70264ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/15 17:23:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:23:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4584L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 17:23:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4584L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#4586 AS rid_0#4619, cpfk_orders_lineitem#4587 AS cpfk_orders_lineitem_0#4620, cpfk_supplier_lineitem#4588 AS cpfk_supplier_lineitem_0#4621, cfpk_lineitem_supplier#4589 AS cfpk_lineitem_supplier_0#4622, cfpk_lineitem_partsupp#4590 AS cfpk_lineitem_partsupp_0#4623, cpfk_part_lineitem#4591 AS cpfk_part_lineitem_0#4624, cfpk_lineitem_part#4592 AS cfpk_lineitem_part_0#4625, cpfk_partsupp_lineitem#4593 AS cpfk_partsupp_lineitem_0#4626, cfpk_lineitem_orders#4594 AS cfpk_lineitem_orders_0#4627, cval_lineitem_l_quantity#4595 AS cval_lineitem_l_quantity_0#4628, cval_lineitem_l_extendedprice#4596 AS cval_lineitem_l_extendedprice_0#4629, cval_lineitem_l_discount#4597 AS cval_lineitem_l_discount_0#4630, cval_lineitem_l_tax#4598 AS cval_lineitem_l_tax_0#4631, cval_lineitem_l_returnflag#4599 AS cval_lineitem_l_returnflag_0#4632, cval_lineitem_l_linestatus#4600 AS cval_lineitem_l_linestatus_0#4633, cval_lineitem_l_commitdate#4601 AS cval_lineitem_l_commitdate_0#4634, cval_lineitem_l_receiptdate#4602 AS cval_lineitem_l_receiptdate_0#4635, cval_lineitem_l_shipinstruct#4603 AS cval_lineitem_l_shipinstruct_0#4636, cval_lineitem_l_shipmode#4604 AS cval_lineitem_l_shipmode_0#4637, cval_lineitem_l_comment#4605 AS cval_lineitem_l_comment_0#4638, cval_lineitem_l_shipdate#4606 AS cval_lineitem_l_shipdate_0#4639, cl_quantity#4607 AS cl_quantity_0#4640, cl_extendedprice#4608 AS cl_extendedprice_0#4641, cl_discount#4609 AS cl_discount_0#4642, ... 9 more fields]
            :  +- Relation[rid#4586,cpfk_orders_lineitem#4587,cpfk_supplier_lineitem#4588,cfpk_lineitem_supplier#4589,cfpk_lineitem_partsupp#4590,cpfk_part_lineitem#4591,cfpk_lineitem_part#4592,cpfk_partsupp_lineitem#4593,cfpk_lineitem_orders#4594,cval_lineitem_l_quantity#4595,cval_lineitem_l_extendedprice#4596,cval_lineitem_l_discount#4597,cval_lineitem_l_tax#4598,cval_lineitem_l_returnflag#4599,cval_lineitem_l_linestatus#4600,cval_lineitem_l_commitdate#4601,cval_lineitem_l_receiptdate#4602,cval_lineitem_l_shipinstruct#4603,cval_lineitem_l_shipmode#4604,cval_lineitem_l_comment#4605,cval_lineitem_l_shipdate#4606,cl_quantity#4607,cl_extendedprice#4608,cl_discount#4609,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#4652 AS rid_1#4669, cpfk_customer_orders#4653 AS cpfk_customer_orders_1#4670, cfpk_orders_customer#4654 AS cfpk_orders_customer_1#4671, cval_orders_o_orderstatus#4655 AS cval_orders_o_orderstatus_1#4672, cval_orders_o_totalprice#4656 AS cval_orders_o_totalprice_1#4673, cval_orders_o_orderpriority#4657 AS cval_orders_o_orderpriority_1#4674, cval_orders_o_clerk#4658 AS cval_orders_o_clerk_1#4675, cval_orders_o_shippriority#4659 AS cval_orders_o_shippriority_1#4676, cval_orders_o_comment#4660 AS cval_orders_o_comment_1#4677, cval_orders_o_orderdate#4661 AS cval_orders_o_orderdate_1#4678, co_orderstatus#4662 AS co_orderstatus_1#4679, co_totalprice#4663 AS co_totalprice_1#4680, co_orderpriority#4664 AS co_orderpriority_1#4681, co_clerk#4665 AS co_clerk_1#4682, co_shippriority#4666 AS co_shippriority_1#4683, co_comment#4667 AS co_comment_1#4684, co_orderdate#4668 AS co_orderdate_1#4685]
               +- Relation[rid#4652,cpfk_customer_orders#4653,cfpk_orders_customer#4654,cval_orders_o_orderstatus#4655,cval_orders_o_totalprice#4656,cval_orders_o_orderpriority#4657,cval_orders_o_clerk#4658,cval_orders_o_shippriority#4659,cval_orders_o_comment#4660,cval_orders_o_orderdate#4661,co_orderstatus#4662,co_totalprice#4663,co_orderpriority#4664,co_clerk#4665,co_shippriority#4666,co_comment#4667,co_orderdate#4668] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 57147ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/15 17:24:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:24:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4740L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:24:18 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:24:18 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:24:18 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:24:18 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:24:18 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:24:18 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:24:18 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:24:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4740L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#4742 AS rid_0#4759, cval_part_p_name#4743 AS cval_part_p_name_0#4760, cval_part_p_mfgr#4744 AS cval_part_p_mfgr_0#4761, cval_part_p_type#4745 AS cval_part_p_type_0#4762, cval_part_p_size#4746 AS cval_part_p_size_0#4763, cval_part_p_container#4747 AS cval_part_p_container_0#4764, cval_part_p_retailprice#4748 AS cval_part_p_retailprice_0#4765, cval_part_p_comment#4749 AS cval_part_p_comment_0#4766, cval_part_p_brand#4750 AS cval_part_p_brand_0#4767, cp_name#4751 AS cp_name_0#4768, cp_mfgr#4752 AS cp_mfgr_0#4769, cp_type#4753 AS cp_type_0#4770, cp_size#4754 AS cp_size_0#4771, cp_container#4755 AS cp_container_0#4772, cp_retailprice#4756 AS cp_retailprice_0#4773, cp_comment#4757 AS cp_comment_0#4774, cp_brand#4758 AS cp_brand_0#4775]
         :  :  :  :  +- Relation[rid#4742,cval_part_p_name#4743,cval_part_p_mfgr#4744,cval_part_p_type#4745,cval_part_p_size#4746,cval_part_p_container#4747,cval_part_p_retailprice#4748,cval_part_p_comment#4749,cval_part_p_brand#4750,cp_name#4751,cp_mfgr#4752,cp_type#4753,cp_size#4754,cp_container#4755,cp_retailprice#4756,cp_comment#4757,cp_brand#4758] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#4776 AS rid_0#4793, cval_part_p_name#4777 AS cval_part_p_name_0#4794, cval_part_p_mfgr#4778 AS cval_part_p_mfgr_0#4795, cval_part_p_type#4779 AS cval_part_p_type_0#4796, cval_part_p_size#4780 AS cval_part_p_size_0#4797, cval_part_p_container#4781 AS cval_part_p_container_0#4798, cval_part_p_retailprice#4782 AS cval_part_p_retailprice_0#4799, cval_part_p_comment#4783 AS cval_part_p_comment_0#4800, cval_part_p_brand#4784 AS cval_part_p_brand_0#4801, cp_name#4785 AS cp_name_0#4802, cp_mfgr#4786 AS cp_mfgr_0#4803, cp_type#4787 AS cp_type_0#4804, cp_size#4788 AS cp_size_0#4805, cp_container#4789 AS cp_container_0#4806, cp_retailprice#4790 AS cp_retailprice_0#4807, cp_comment#4791 AS cp_comment_0#4808, cp_brand#4792 AS cp_brand_0#4809]
         :  :  :        +- Relation[rid#4776,cval_part_p_name#4777,cval_part_p_mfgr#4778,cval_part_p_type#4779,cval_part_p_size#4780,cval_part_p_container#4781,cval_part_p_retailprice#4782,cval_part_p_comment#4783,cval_part_p_brand#4784,cp_name#4785,cp_mfgr#4786,cp_type#4787,cp_size#4788,cp_container#4789,cp_retailprice#4790,cp_comment#4791,cp_brand#4792] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#4810 AS rid_0#4827, cval_part_p_name#4811 AS cval_part_p_name_0#4828, cval_part_p_mfgr#4812 AS cval_part_p_mfgr_0#4829, cval_part_p_type#4813 AS cval_part_p_type_0#4830, cval_part_p_size#4814 AS cval_part_p_size_0#4831, cval_part_p_container#4815 AS cval_part_p_container_0#4832, cval_part_p_retailprice#4816 AS cval_part_p_retailprice_0#4833, cval_part_p_comment#4817 AS cval_part_p_comment_0#4834, cval_part_p_brand#4818 AS cval_part_p_brand_0#4835, cp_name#4819 AS cp_name_0#4836, cp_mfgr#4820 AS cp_mfgr_0#4837, cp_type#4821 AS cp_type_0#4838, cp_size#4822 AS cp_size_0#4839, cp_container#4823 AS cp_container_0#4840, cp_retailprice#4824 AS cp_retailprice_0#4841, cp_comment#4825 AS cp_comment_0#4842, cp_brand#4826 AS cp_brand_0#4843]
         :  :        +- Relation[rid#4810,cval_part_p_name#4811,cval_part_p_mfgr#4812,cval_part_p_type#4813,cval_part_p_size#4814,cval_part_p_container#4815,cval_part_p_retailprice#4816,cval_part_p_comment#4817,cval_part_p_brand#4818,cp_name#4819,cp_mfgr#4820,cp_type#4821,cp_size#4822,cp_container#4823,cp_retailprice#4824,cp_comment#4825,cp_brand#4826] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#4944 AS rid_1#4977, cpfk_orders_lineitem#4945 AS cpfk_orders_lineitem_1#4978, cpfk_supplier_lineitem#4946 AS cpfk_supplier_lineitem_1#4979, cfpk_lineitem_supplier#4947 AS cfpk_lineitem_supplier_1#4980, cfpk_lineitem_partsupp#4948 AS cfpk_lineitem_partsupp_1#4981, cpfk_part_lineitem#4949 AS cpfk_part_lineitem_1#4982, cfpk_lineitem_part#4950 AS cfpk_lineitem_part_1#4983, cpfk_partsupp_lineitem#4951 AS cpfk_partsupp_lineitem_1#4984, cfpk_lineitem_orders#4952 AS cfpk_lineitem_orders_1#4985, cval_lineitem_l_quantity#4953 AS cval_lineitem_l_quantity_1#4986, cval_lineitem_l_extendedprice#4954 AS cval_lineitem_l_extendedprice_1#4987, cval_lineitem_l_discount#4955 AS cval_lineitem_l_discount_1#4988, cval_lineitem_l_tax#4956 AS cval_lineitem_l_tax_1#4989, cval_lineitem_l_returnflag#4957 AS cval_lineitem_l_returnflag_1#4990, cval_lineitem_l_linestatus#4958 AS cval_lineitem_l_linestatus_1#4991, cval_lineitem_l_commitdate#4959 AS cval_lineitem_l_commitdate_1#4992, cval_lineitem_l_receiptdate#4960 AS cval_lineitem_l_receiptdate_1#4993, cval_lineitem_l_shipinstruct#4961 AS cval_lineitem_l_shipinstruct_1#4994, cval_lineitem_l_shipmode#4962 AS cval_lineitem_l_shipmode_1#4995, cval_lineitem_l_comment#4963 AS cval_lineitem_l_comment_1#4996, cval_lineitem_l_shipdate#4964 AS cval_lineitem_l_shipdate_1#4997, cl_quantity#4965 AS cl_quantity_1#4998, cl_extendedprice#4966 AS cl_extendedprice_1#4999, cl_discount#4967 AS cl_discount_1#5000, ... 9 more fields]
         :     +- Relation[rid#4944,cpfk_orders_lineitem#4945,cpfk_supplier_lineitem#4946,cfpk_lineitem_supplier#4947,cfpk_lineitem_partsupp#4948,cpfk_part_lineitem#4949,cfpk_lineitem_part#4950,cpfk_partsupp_lineitem#4951,cfpk_lineitem_orders#4952,cval_lineitem_l_quantity#4953,cval_lineitem_l_extendedprice#4954,cval_lineitem_l_discount#4955,cval_lineitem_l_tax#4956,cval_lineitem_l_returnflag#4957,cval_lineitem_l_linestatus#4958,cval_lineitem_l_commitdate#4959,cval_lineitem_l_receiptdate#4960,cval_lineitem_l_shipinstruct#4961,cval_lineitem_l_shipmode#4962,cval_lineitem_l_comment#4963,cval_lineitem_l_shipdate#4964,cl_quantity#4965,cl_extendedprice#4966,cl_discount#4967,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4844 AS rid_1#4877, cpfk_orders_lineitem#4845 AS cpfk_orders_lineitem_1#4878, cpfk_supplier_lineitem#4846 AS cpfk_supplier_lineitem_1#4879, cfpk_lineitem_supplier#4847 AS cfpk_lineitem_supplier_1#4880, cfpk_lineitem_partsupp#4848 AS cfpk_lineitem_partsupp_1#4881, cpfk_part_lineitem#4849 AS cpfk_part_lineitem_1#4882, cfpk_lineitem_part#4850 AS cfpk_lineitem_part_1#4883, cpfk_partsupp_lineitem#4851 AS cpfk_partsupp_lineitem_1#4884, cfpk_lineitem_orders#4852 AS cfpk_lineitem_orders_1#4885, cval_lineitem_l_quantity#4853 AS cval_lineitem_l_quantity_1#4886, cval_lineitem_l_extendedprice#4854 AS cval_lineitem_l_extendedprice_1#4887, cval_lineitem_l_discount#4855 AS cval_lineitem_l_discount_1#4888, cval_lineitem_l_tax#4856 AS cval_lineitem_l_tax_1#4889, cval_lineitem_l_returnflag#4857 AS cval_lineitem_l_returnflag_1#4890, cval_lineitem_l_linestatus#4858 AS cval_lineitem_l_linestatus_1#4891, cval_lineitem_l_commitdate#4859 AS cval_lineitem_l_commitdate_1#4892, cval_lineitem_l_receiptdate#4860 AS cval_lineitem_l_receiptdate_1#4893, cval_lineitem_l_shipinstruct#4861 AS cval_lineitem_l_shipinstruct_1#4894, cval_lineitem_l_shipmode#4862 AS cval_lineitem_l_shipmode_1#4895, cval_lineitem_l_comment#4863 AS cval_lineitem_l_comment_1#4896, cval_lineitem_l_shipdate#4864 AS cval_lineitem_l_shipdate_1#4897, cl_quantity#4865 AS cl_quantity_1#4898, cl_extendedprice#4866 AS cl_extendedprice_1#4899, cl_discount#4867 AS cl_discount_1#4900, ... 9 more fields]
            +- Relation[rid#4844,cpfk_orders_lineitem#4845,cpfk_supplier_lineitem#4846,cfpk_lineitem_supplier#4847,cfpk_lineitem_partsupp#4848,cpfk_part_lineitem#4849,cfpk_lineitem_part#4850,cpfk_partsupp_lineitem#4851,cfpk_lineitem_orders#4852,cval_lineitem_l_quantity#4853,cval_lineitem_l_extendedprice#4854,cval_lineitem_l_discount#4855,cval_lineitem_l_tax#4856,cval_lineitem_l_returnflag#4857,cval_lineitem_l_linestatus#4858,cval_lineitem_l_commitdate#4859,cval_lineitem_l_receiptdate#4860,cval_lineitem_l_shipinstruct#4861,cval_lineitem_l_shipmode#4862,cval_lineitem_l_comment#4863,cval_lineitem_l_shipdate#4864,cl_quantity#4865,cl_extendedprice#4866,cl_discount#4867,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=408
Elapsed time: 433ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/15 17:24:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:24:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5067L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 17:24:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:24:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:24:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:24:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:24:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:24:18 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:24:18 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:24:18 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:24:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:24:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:24:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:24:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:24:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:24:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:24:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:24:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5067L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#5069 AS rid_0#5086, cval_part_p_name#5070 AS cval_part_p_name_0#5087, cval_part_p_mfgr#5071 AS cval_part_p_mfgr_0#5088, cval_part_p_type#5072 AS cval_part_p_type_0#5089, cval_part_p_size#5073 AS cval_part_p_size_0#5090, cval_part_p_container#5074 AS cval_part_p_container_0#5091, cval_part_p_retailprice#5075 AS cval_part_p_retailprice_0#5092, cval_part_p_comment#5076 AS cval_part_p_comment_0#5093, cval_part_p_brand#5077 AS cval_part_p_brand_0#5094, cp_name#5078 AS cp_name_0#5095, cp_mfgr#5079 AS cp_mfgr_0#5096, cp_type#5080 AS cp_type_0#5097, cp_size#5081 AS cp_size_0#5098, cp_container#5082 AS cp_container_0#5099, cp_retailprice#5083 AS cp_retailprice_0#5100, cp_comment#5084 AS cp_comment_0#5101, cp_brand#5085 AS cp_brand_0#5102]
            :     :     :  :  :  :  +- Relation[rid#5069,cval_part_p_name#5070,cval_part_p_mfgr#5071,cval_part_p_type#5072,cval_part_p_size#5073,cval_part_p_container#5074,cval_part_p_retailprice#5075,cval_part_p_comment#5076,cval_part_p_brand#5077,cp_name#5078,cp_mfgr#5079,cp_type#5080,cp_size#5081,cp_container#5082,cp_retailprice#5083,cp_comment#5084,cp_brand#5085] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#5103 AS rid_0#5120, cval_part_p_name#5104 AS cval_part_p_name_0#5121, cval_part_p_mfgr#5105 AS cval_part_p_mfgr_0#5122, cval_part_p_type#5106 AS cval_part_p_type_0#5123, cval_part_p_size#5107 AS cval_part_p_size_0#5124, cval_part_p_container#5108 AS cval_part_p_container_0#5125, cval_part_p_retailprice#5109 AS cval_part_p_retailprice_0#5126, cval_part_p_comment#5110 AS cval_part_p_comment_0#5127, cval_part_p_brand#5111 AS cval_part_p_brand_0#5128, cp_name#5112 AS cp_name_0#5129, cp_mfgr#5113 AS cp_mfgr_0#5130, cp_type#5114 AS cp_type_0#5131, cp_size#5115 AS cp_size_0#5132, cp_container#5116 AS cp_container_0#5133, cp_retailprice#5117 AS cp_retailprice_0#5134, cp_comment#5118 AS cp_comment_0#5135, cp_brand#5119 AS cp_brand_0#5136]
            :     :     :  :  :        +- Relation[rid#5103,cval_part_p_name#5104,cval_part_p_mfgr#5105,cval_part_p_type#5106,cval_part_p_size#5107,cval_part_p_container#5108,cval_part_p_retailprice#5109,cval_part_p_comment#5110,cval_part_p_brand#5111,cp_name#5112,cp_mfgr#5113,cp_type#5114,cp_size#5115,cp_container#5116,cp_retailprice#5117,cp_comment#5118,cp_brand#5119] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- Project [rid#5237 AS rid_1#5270, cpfk_orders_lineitem#5238 AS cpfk_orders_lineitem_1#5271, cpfk_supplier_lineitem#5239 AS cpfk_supplier_lineitem_1#5272, cfpk_lineitem_supplier#5240 AS cfpk_lineitem_supplier_1#5273, cfpk_lineitem_partsupp#5241 AS cfpk_lineitem_partsupp_1#5274, cpfk_part_lineitem#5242 AS cpfk_part_lineitem_1#5275, cfpk_lineitem_part#5243 AS cfpk_lineitem_part_1#5276, cpfk_partsupp_lineitem#5244 AS cpfk_partsupp_lineitem_1#5277, cfpk_lineitem_orders#5245 AS cfpk_lineitem_orders_1#5278, cval_lineitem_l_quantity#5246 AS cval_lineitem_l_quantity_1#5279, cval_lineitem_l_extendedprice#5247 AS cval_lineitem_l_extendedprice_1#5280, cval_lineitem_l_discount#5248 AS cval_lineitem_l_discount_1#5281, cval_lineitem_l_tax#5249 AS cval_lineitem_l_tax_1#5282, cval_lineitem_l_returnflag#5250 AS cval_lineitem_l_returnflag_1#5283, cval_lineitem_l_linestatus#5251 AS cval_lineitem_l_linestatus_1#5284, cval_lineitem_l_commitdate#5252 AS cval_lineitem_l_commitdate_1#5285, cval_lineitem_l_receiptdate#5253 AS cval_lineitem_l_receiptdate_1#5286, cval_lineitem_l_shipinstruct#5254 AS cval_lineitem_l_shipinstruct_1#5287, cval_lineitem_l_shipmode#5255 AS cval_lineitem_l_shipmode_1#5288, cval_lineitem_l_comment#5256 AS cval_lineitem_l_comment_1#5289, cval_lineitem_l_shipdate#5257 AS cval_lineitem_l_shipdate_1#5290, cl_quantity#5258 AS cl_quantity_1#5291, cl_extendedprice#5259 AS cl_extendedprice_1#5292, cl_discount#5260 AS cl_discount_1#5293, ... 9 more fields]
            :     :     :  :     +- Relation[rid#5237,cpfk_orders_lineitem#5238,cpfk_supplier_lineitem#5239,cfpk_lineitem_supplier#5240,cfpk_lineitem_partsupp#5241,cpfk_part_lineitem#5242,cfpk_lineitem_part#5243,cpfk_partsupp_lineitem#5244,cfpk_lineitem_orders#5245,cval_lineitem_l_quantity#5246,cval_lineitem_l_extendedprice#5247,cval_lineitem_l_discount#5248,cval_lineitem_l_tax#5249,cval_lineitem_l_returnflag#5250,cval_lineitem_l_linestatus#5251,cval_lineitem_l_commitdate#5252,cval_lineitem_l_receiptdate#5253,cval_lineitem_l_shipinstruct#5254,cval_lineitem_l_shipmode#5255,cval_lineitem_l_comment#5256,cval_lineitem_l_shipdate#5257,cl_quantity#5258,cl_extendedprice#5259,cl_discount#5260,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#5137 AS rid_1#5170, cpfk_orders_lineitem#5138 AS cpfk_orders_lineitem_1#5171, cpfk_supplier_lineitem#5139 AS cpfk_supplier_lineitem_1#5172, cfpk_lineitem_supplier#5140 AS cfpk_lineitem_supplier_1#5173, cfpk_lineitem_partsupp#5141 AS cfpk_lineitem_partsupp_1#5174, cpfk_part_lineitem#5142 AS cpfk_part_lineitem_1#5175, cfpk_lineitem_part#5143 AS cfpk_lineitem_part_1#5176, cpfk_partsupp_lineitem#5144 AS cpfk_partsupp_lineitem_1#5177, cfpk_lineitem_orders#5145 AS cfpk_lineitem_orders_1#5178, cval_lineitem_l_quantity#5146 AS cval_lineitem_l_quantity_1#5179, cval_lineitem_l_extendedprice#5147 AS cval_lineitem_l_extendedprice_1#5180, cval_lineitem_l_discount#5148 AS cval_lineitem_l_discount_1#5181, cval_lineitem_l_tax#5149 AS cval_lineitem_l_tax_1#5182, cval_lineitem_l_returnflag#5150 AS cval_lineitem_l_returnflag_1#5183, cval_lineitem_l_linestatus#5151 AS cval_lineitem_l_linestatus_1#5184, cval_lineitem_l_commitdate#5152 AS cval_lineitem_l_commitdate_1#5185, cval_lineitem_l_receiptdate#5153 AS cval_lineitem_l_receiptdate_1#5186, cval_lineitem_l_shipinstruct#5154 AS cval_lineitem_l_shipinstruct_1#5187, cval_lineitem_l_shipmode#5155 AS cval_lineitem_l_shipmode_1#5188, cval_lineitem_l_comment#5156 AS cval_lineitem_l_comment_1#5189, cval_lineitem_l_shipdate#5157 AS cval_lineitem_l_shipdate_1#5190, cl_quantity#5158 AS cl_quantity_1#5191, cl_extendedprice#5159 AS cl_extendedprice_1#5192, cl_discount#5160 AS cl_discount_1#5193, ... 9 more fields]
            :     :     :     +- Relation[rid#5137,cpfk_orders_lineitem#5138,cpfk_supplier_lineitem#5139,cfpk_lineitem_supplier#5140,cfpk_lineitem_partsupp#5141,cpfk_part_lineitem#5142,cfpk_lineitem_part#5143,cpfk_partsupp_lineitem#5144,cfpk_lineitem_orders#5145,cval_lineitem_l_quantity#5146,cval_lineitem_l_extendedprice#5147,cval_lineitem_l_discount#5148,cval_lineitem_l_tax#5149,cval_lineitem_l_returnflag#5150,cval_lineitem_l_linestatus#5151,cval_lineitem_l_commitdate#5152,cval_lineitem_l_receiptdate#5153,cval_lineitem_l_shipinstruct#5154,cval_lineitem_l_shipmode#5155,cval_lineitem_l_comment#5156,cval_lineitem_l_shipdate#5157,cl_quantity#5158,cl_extendedprice#5159,cl_discount#5160,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#5303 AS rid_2#5316, cpfk_nation_supplier#5304 AS cpfk_nation_supplier_2#5317, cfpk_supplier_nation#5305 AS cfpk_supplier_nation_2#5318, cval_supplier_s_name#5306 AS cval_supplier_s_name_2#5319, cval_supplier_s_address#5307 AS cval_supplier_s_address_2#5320, cval_supplier_s_phone#5308 AS cval_supplier_s_phone_2#5321, cval_supplier_s_acctbal#5309 AS cval_supplier_s_acctbal_2#5322, cval_supplier_s_comment#5310 AS cval_supplier_s_comment_2#5323, cs_name#5311 AS cs_name_2#5324, cs_address#5312 AS cs_address_2#5325, cs_phone#5313 AS cs_phone_2#5326, cs_acctbal#5314 AS cs_acctbal_2#5327, cs_comment#5315 AS cs_comment_2#5328]
            :     :        +- Relation[rid#5303,cpfk_nation_supplier#5304,cfpk_supplier_nation#5305,cval_supplier_s_name#5306,cval_supplier_s_address#5307,cval_supplier_s_phone#5308,cval_supplier_s_acctbal#5309,cval_supplier_s_comment#5310,cs_name#5311,cs_address#5312,cs_phone#5313,cs_acctbal#5314,cs_comment#5315] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#5329 AS rid_3#5336, cpfk_region_nation#5330 AS cpfk_region_nation_3#5337, cfpk_nation_region#5331 AS cfpk_nation_region_3#5338, cval_nation_n_name#5332 AS cval_nation_n_name_3#5339, cval_nation_n_comment#5333 AS cval_nation_n_comment_3#5340, cn_name#5334 AS cn_name_3#5341, cn_comment#5335 AS cn_comment_3#5342]
            :        +- Relation[rid#5329,cpfk_region_nation#5330,cfpk_nation_region#5331,cval_nation_n_name#5332,cval_nation_n_comment#5333,cn_name#5334,cn_comment#5335] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#5343 AS rid_4#5348, cval_region_r_name#5344 AS cval_region_r_name_4#5349, cval_region_r_comment#5345 AS cval_region_r_comment_4#5350, cr_name#5346 AS cr_name_4#5351, cr_comment#5347 AS cr_comment_4#5352]
               :  :  :  :  :  :  :  +- Relation[rid#5343,cval_region_r_name#5344,cval_region_r_comment#5345,cr_name#5346,cr_comment#5347] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#5353 AS rid_4#5358, cval_region_r_name#5354 AS cval_region_r_name_4#5359, cval_region_r_comment#5355 AS cval_region_r_comment_4#5360, cr_name#5356 AS cr_name_4#5361, cr_comment#5357 AS cr_comment_4#5362]
               :  :  :  :  :  :        +- Relation[rid#5353,cval_region_r_name#5354,cval_region_r_comment#5355,cr_name#5356,cr_comment#5357] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- Project [rid#5387 AS rid_5#5394, cpfk_region_nation#5388 AS cpfk_region_nation_5#5395, cfpk_nation_region#5389 AS cfpk_nation_region_5#5396, cval_nation_n_name#5390 AS cval_nation_n_name_5#5397, cval_nation_n_comment#5391 AS cval_nation_n_comment_5#5398, cn_name#5392 AS cn_name_5#5399, cn_comment#5393 AS cn_comment_5#5400]
               :  :  :  :  :     +- Relation[rid#5387,cpfk_region_nation#5388,cfpk_nation_region#5389,cval_nation_n_name#5390,cval_nation_n_comment#5391,cn_name#5392,cn_comment#5393] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#5363 AS rid_5#5370, cpfk_region_nation#5364 AS cpfk_region_nation_5#5371, cfpk_nation_region#5365 AS cfpk_nation_region_5#5372, cval_nation_n_name#5366 AS cval_nation_n_name_5#5373, cval_nation_n_comment#5367 AS cval_nation_n_comment_5#5374, cn_name#5368 AS cn_name_5#5375, cn_comment#5369 AS cn_comment_5#5376]
               :  :  :  :     +- Relation[rid#5363,cpfk_region_nation#5364,cfpk_nation_region#5365,cval_nation_n_name#5366,cval_nation_n_comment#5367,cn_name#5368,cn_comment#5369] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#5445 AS rid_6#5460, cpfk_nation_customer#5446 AS cpfk_nation_customer_6#5461, cfpk_customer_nation#5447 AS cfpk_customer_nation_6#5462, cval_customer_c_name#5448 AS cval_customer_c_name_6#5463, cval_customer_c_address#5449 AS cval_customer_c_address_6#5464, cval_customer_c_phone#5450 AS cval_customer_c_phone_6#5465, cval_customer_c_acctbal#5451 AS cval_customer_c_acctbal_6#5466, cval_customer_c_comment#5452 AS cval_customer_c_comment_6#5467, cval_customer_c_mktsegment#5453 AS cval_customer_c_mktsegment_6#5468, cc_name#5454 AS cc_name_6#5469, cc_address#5455 AS cc_address_6#5470, cc_phone#5456 AS cc_phone_6#5471, cc_acctbal#5457 AS cc_acctbal_6#5472, cc_comment#5458 AS cc_comment_6#5473, cc_mktsegment#5459 AS cc_mktsegment_6#5474]
               :  :  :     +- Relation[rid#5445,cpfk_nation_customer#5446,cfpk_customer_nation#5447,cval_customer_c_name#5448,cval_customer_c_address#5449,cval_customer_c_phone#5450,cval_customer_c_acctbal#5451,cval_customer_c_comment#5452,cval_customer_c_mktsegment#5453,cc_name#5454,cc_address#5455,cc_phone#5456,cc_acctbal#5457,cc_comment#5458,cc_mktsegment#5459] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#5401 AS rid_6#5416, cpfk_nation_customer#5402 AS cpfk_nation_customer_6#5417, cfpk_customer_nation#5403 AS cfpk_customer_nation_6#5418, cval_customer_c_name#5404 AS cval_customer_c_name_6#5419, cval_customer_c_address#5405 AS cval_customer_c_address_6#5420, cval_customer_c_phone#5406 AS cval_customer_c_phone_6#5421, cval_customer_c_acctbal#5407 AS cval_customer_c_acctbal_6#5422, cval_customer_c_comment#5408 AS cval_customer_c_comment_6#5423, cval_customer_c_mktsegment#5409 AS cval_customer_c_mktsegment_6#5424, cc_name#5410 AS cc_name_6#5425, cc_address#5411 AS cc_address_6#5426, cc_phone#5412 AS cc_phone_6#5427, cc_acctbal#5413 AS cc_acctbal_6#5428, cc_comment#5414 AS cc_comment_6#5429, cc_mktsegment#5415 AS cc_mktsegment_6#5430]
               :  :     +- Relation[rid#5401,cpfk_nation_customer#5402,cfpk_customer_nation#5403,cval_customer_c_name#5404,cval_customer_c_address#5405,cval_customer_c_phone#5406,cval_customer_c_acctbal#5407,cval_customer_c_comment#5408,cval_customer_c_mktsegment#5409,cc_name#5410,cc_address#5411,cc_phone#5412,cc_acctbal#5413,cc_comment#5414,cc_mktsegment#5415] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#5539 AS rid_7#5556, cpfk_customer_orders#5540 AS cpfk_customer_orders_7#5557, cfpk_orders_customer#5541 AS cfpk_orders_customer_7#5558, cval_orders_o_orderstatus#5542 AS cval_orders_o_orderstatus_7#5559, cval_orders_o_totalprice#5543 AS cval_orders_o_totalprice_7#5560, cval_orders_o_orderpriority#5544 AS cval_orders_o_orderpriority_7#5561, cval_orders_o_clerk#5545 AS cval_orders_o_clerk_7#5562, cval_orders_o_shippriority#5546 AS cval_orders_o_shippriority_7#5563, cval_orders_o_comment#5547 AS cval_orders_o_comment_7#5564, cval_orders_o_orderdate#5548 AS cval_orders_o_orderdate_7#5565, co_orderstatus#5549 AS co_orderstatus_7#5566, co_totalprice#5550 AS co_totalprice_7#5567, co_orderpriority#5551 AS co_orderpriority_7#5568, co_clerk#5552 AS co_clerk_7#5569, co_shippriority#5553 AS co_shippriority_7#5570, co_comment#5554 AS co_comment_7#5571, co_orderdate#5555 AS co_orderdate_7#5572]
               :     +- Relation[rid#5539,cpfk_customer_orders#5540,cfpk_orders_customer#5541,cval_orders_o_orderstatus#5542,cval_orders_o_totalprice#5543,cval_orders_o_orderpriority#5544,cval_orders_o_clerk#5545,cval_orders_o_shippriority#5546,cval_orders_o_comment#5547,cval_orders_o_orderdate#5548,co_orderstatus#5549,co_totalprice#5550,co_orderpriority#5551,co_clerk#5552,co_shippriority#5553,co_comment#5554,co_orderdate#5555] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#5475 AS rid_7#5492, cpfk_customer_orders#5476 AS cpfk_customer_orders_7#5493, cfpk_orders_customer#5477 AS cfpk_orders_customer_7#5494, cval_orders_o_orderstatus#5478 AS cval_orders_o_orderstatus_7#5495, cval_orders_o_totalprice#5479 AS cval_orders_o_totalprice_7#5496, cval_orders_o_orderpriority#5480 AS cval_orders_o_orderpriority_7#5497, cval_orders_o_clerk#5481 AS cval_orders_o_clerk_7#5498, cval_orders_o_shippriority#5482 AS cval_orders_o_shippriority_7#5499, cval_orders_o_comment#5483 AS cval_orders_o_comment_7#5500, cval_orders_o_orderdate#5484 AS cval_orders_o_orderdate_7#5501, co_orderstatus#5485 AS co_orderstatus_7#5502, co_totalprice#5486 AS co_totalprice_7#5503, co_orderpriority#5487 AS co_orderpriority_7#5504, co_clerk#5488 AS co_clerk_7#5505, co_shippriority#5489 AS co_shippriority_7#5506, co_comment#5490 AS co_comment_7#5507, co_orderdate#5491 AS co_orderdate_7#5508]
                  +- Relation[rid#5475,cpfk_customer_orders#5476,cfpk_orders_customer#5477,cval_orders_o_orderstatus#5478,cval_orders_o_totalprice#5479,cval_orders_o_orderpriority#5480,cval_orders_o_clerk#5481,cval_orders_o_shippriority#5482,cval_orders_o_comment#5483,cval_orders_o_orderdate#5484,co_orderstatus#5485,co_totalprice#5486,co_orderpriority#5487,co_clerk#5488,co_shippriority#5489,co_comment#5490,co_orderdate#5491] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 2011ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/15 17:24:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:24:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5692L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 17:24:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5692L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#5694 AS rid_0#5711, cpfk_customer_orders#5695 AS cpfk_customer_orders_0#5712, cfpk_orders_customer#5696 AS cfpk_orders_customer_0#5713, cval_orders_o_orderstatus#5697 AS cval_orders_o_orderstatus_0#5714, cval_orders_o_totalprice#5698 AS cval_orders_o_totalprice_0#5715, cval_orders_o_orderpriority#5699 AS cval_orders_o_orderpriority_0#5716, cval_orders_o_clerk#5700 AS cval_orders_o_clerk_0#5717, cval_orders_o_shippriority#5701 AS cval_orders_o_shippriority_0#5718, cval_orders_o_comment#5702 AS cval_orders_o_comment_0#5719, cval_orders_o_orderdate#5703 AS cval_orders_o_orderdate_0#5720, co_orderstatus#5704 AS co_orderstatus_0#5721, co_totalprice#5705 AS co_totalprice_0#5722, co_orderpriority#5706 AS co_orderpriority_0#5723, co_clerk#5707 AS co_clerk_0#5724, co_shippriority#5708 AS co_shippriority_0#5725, co_comment#5709 AS co_comment_0#5726, co_orderdate#5710 AS co_orderdate_0#5727]
            :  +- Relation[rid#5694,cpfk_customer_orders#5695,cfpk_orders_customer#5696,cval_orders_o_orderstatus#5697,cval_orders_o_totalprice#5698,cval_orders_o_orderpriority#5699,cval_orders_o_clerk#5700,cval_orders_o_shippriority#5701,cval_orders_o_comment#5702,cval_orders_o_orderdate#5703,co_orderstatus#5704,co_totalprice#5705,co_orderpriority#5706,co_clerk#5707,co_shippriority#5708,co_comment#5709,co_orderdate#5710] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#5728 AS rid_1#5743, cpfk_nation_customer#5729 AS cpfk_nation_customer_1#5744, cfpk_customer_nation#5730 AS cfpk_customer_nation_1#5745, cval_customer_c_name#5731 AS cval_customer_c_name_1#5746, cval_customer_c_address#5732 AS cval_customer_c_address_1#5747, cval_customer_c_phone#5733 AS cval_customer_c_phone_1#5748, cval_customer_c_acctbal#5734 AS cval_customer_c_acctbal_1#5749, cval_customer_c_comment#5735 AS cval_customer_c_comment_1#5750, cval_customer_c_mktsegment#5736 AS cval_customer_c_mktsegment_1#5751, cc_name#5737 AS cc_name_1#5752, cc_address#5738 AS cc_address_1#5753, cc_phone#5739 AS cc_phone_1#5754, cc_acctbal#5740 AS cc_acctbal_1#5755, cc_comment#5741 AS cc_comment_1#5756, cc_mktsegment#5742 AS cc_mktsegment_1#5757]
               +- Relation[rid#5728,cpfk_nation_customer#5729,cfpk_customer_nation#5730,cval_customer_c_name#5731,cval_customer_c_address#5732,cval_customer_c_phone#5733,cval_customer_c_acctbal#5734,cval_customer_c_comment#5735,cval_customer_c_mktsegment#5736,cc_name#5737,cc_address#5738,cc_phone#5739,cc_acctbal#5740,cc_comment#5741,cc_mktsegment#5742] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13505ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/15 17:24:34 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:24:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5794L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:24:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:24:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5794L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#5796 AS rid_0#5801, cval_region_r_name#5797 AS cval_region_r_name_0#5802, cval_region_r_comment#5798 AS cval_region_r_comment_0#5803, cr_name#5799 AS cr_name_0#5804, cr_comment#5800 AS cr_comment_0#5805]
         :  :  :  :  :  :  :  +- Relation[rid#5796,cval_region_r_name#5797,cval_region_r_comment#5798,cr_name#5799,cr_comment#5800] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#5806 AS rid_0#5811, cval_region_r_name#5807 AS cval_region_r_name_0#5812, cval_region_r_comment#5808 AS cval_region_r_comment_0#5813, cr_name#5809 AS cr_name_0#5814, cr_comment#5810 AS cr_comment_0#5815]
         :  :  :  :  :  :        +- Relation[rid#5806,cval_region_r_name#5807,cval_region_r_comment#5808,cr_name#5809,cr_comment#5810] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- Project [rid#5840 AS rid_1#5847, cpfk_region_nation#5841 AS cpfk_region_nation_1#5848, cfpk_nation_region#5842 AS cfpk_nation_region_1#5849, cval_nation_n_name#5843 AS cval_nation_n_name_1#5850, cval_nation_n_comment#5844 AS cval_nation_n_comment_1#5851, cn_name#5845 AS cn_name_1#5852, cn_comment#5846 AS cn_comment_1#5853]
         :  :  :  :  :     +- Relation[rid#5840,cpfk_region_nation#5841,cfpk_nation_region#5842,cval_nation_n_name#5843,cval_nation_n_comment#5844,cn_name#5845,cn_comment#5846] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#5816 AS rid_1#5823, cpfk_region_nation#5817 AS cpfk_region_nation_1#5824, cfpk_nation_region#5818 AS cfpk_nation_region_1#5825, cval_nation_n_name#5819 AS cval_nation_n_name_1#5826, cval_nation_n_comment#5820 AS cval_nation_n_comment_1#5827, cn_name#5821 AS cn_name_1#5828, cn_comment#5822 AS cn_comment_1#5829]
         :  :  :  :     +- Relation[rid#5816,cpfk_region_nation#5817,cfpk_nation_region#5818,cval_nation_n_name#5819,cval_nation_n_comment#5820,cn_name#5821,cn_comment#5822] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#5894 AS rid_2#5907, cpfk_nation_supplier#5895 AS cpfk_nation_supplier_2#5908, cfpk_supplier_nation#5896 AS cfpk_supplier_nation_2#5909, cval_supplier_s_name#5897 AS cval_supplier_s_name_2#5910, cval_supplier_s_address#5898 AS cval_supplier_s_address_2#5911, cval_supplier_s_phone#5899 AS cval_supplier_s_phone_2#5912, cval_supplier_s_acctbal#5900 AS cval_supplier_s_acctbal_2#5913, cval_supplier_s_comment#5901 AS cval_supplier_s_comment_2#5914, cs_name#5902 AS cs_name_2#5915, cs_address#5903 AS cs_address_2#5916, cs_phone#5904 AS cs_phone_2#5917, cs_acctbal#5905 AS cs_acctbal_2#5918, cs_comment#5906 AS cs_comment_2#5919]
         :  :  :     +- Relation[rid#5894,cpfk_nation_supplier#5895,cfpk_supplier_nation#5896,cval_supplier_s_name#5897,cval_supplier_s_address#5898,cval_supplier_s_phone#5899,cval_supplier_s_acctbal#5900,cval_supplier_s_comment#5901,cs_name#5902,cs_address#5903,cs_phone#5904,cs_acctbal#5905,cs_comment#5906] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#5854 AS rid_2#5867, cpfk_nation_supplier#5855 AS cpfk_nation_supplier_2#5868, cfpk_supplier_nation#5856 AS cfpk_supplier_nation_2#5869, cval_supplier_s_name#5857 AS cval_supplier_s_name_2#5870, cval_supplier_s_address#5858 AS cval_supplier_s_address_2#5871, cval_supplier_s_phone#5859 AS cval_supplier_s_phone_2#5872, cval_supplier_s_acctbal#5860 AS cval_supplier_s_acctbal_2#5873, cval_supplier_s_comment#5861 AS cval_supplier_s_comment_2#5874, cs_name#5862 AS cs_name_2#5875, cs_address#5863 AS cs_address_2#5876, cs_phone#5864 AS cs_phone_2#5877, cs_acctbal#5865 AS cs_acctbal_2#5878, cs_comment#5866 AS cs_comment_2#5879]
         :  :     +- Relation[rid#5854,cpfk_nation_supplier#5855,cfpk_supplier_nation#5856,cval_supplier_s_name#5857,cval_supplier_s_address#5858,cval_supplier_s_phone#5859,cval_supplier_s_acctbal#5860,cval_supplier_s_comment#5861,cs_name#5862,cs_address#5863,cs_phone#5864,cs_acctbal#5865,cs_comment#5866] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#6092 AS rid_4#6103, cpfk_part_partsupp#6093 AS cpfk_part_partsupp_4#6104, cfpk_partsupp_part#6094 AS cfpk_partsupp_part_4#6105, cpfk_supplier_partsupp#6095 AS cpfk_supplier_partsupp_4#6106, cfpk_partsupp_supplier#6096 AS cfpk_partsupp_supplier_4#6107, cval_partsupp_ps_availqty#6097 AS cval_partsupp_ps_availqty_4#6108, cval_partsupp_ps_supplycost#6098 AS cval_partsupp_ps_supplycost_4#6109, cval_partsupp_ps_comment#6099 AS cval_partsupp_ps_comment_4#6110, cps_availqty#6100 AS cps_availqty_4#6111, cps_supplycost#6101 AS cps_supplycost_4#6112, cps_comment#6102 AS cps_comment_4#6113]
         :     +- Relation[rid#6092,cpfk_part_partsupp#6093,cfpk_partsupp_part#6094,cpfk_supplier_partsupp#6095,cfpk_partsupp_supplier#6096,cval_partsupp_ps_availqty#6097,cval_partsupp_ps_supplycost#6098,cval_partsupp_ps_comment#6099,cps_availqty#6100,cps_supplycost#6101,cps_comment#6102] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#5920 AS rid_3#5937, cval_part_p_name#5921 AS cval_part_p_name_3#5938, cval_part_p_mfgr#5922 AS cval_part_p_mfgr_3#5939, cval_part_p_type#5923 AS cval_part_p_type_3#5940, cval_part_p_size#5924 AS cval_part_p_size_3#5941, cval_part_p_container#5925 AS cval_part_p_container_3#5942, cval_part_p_retailprice#5926 AS cval_part_p_retailprice_3#5943, cval_part_p_comment#5927 AS cval_part_p_comment_3#5944, cval_part_p_brand#5928 AS cval_part_p_brand_3#5945, cp_name#5929 AS cp_name_3#5946, cp_mfgr#5930 AS cp_mfgr_3#5947, cp_type#5931 AS cp_type_3#5948, cp_size#5932 AS cp_size_3#5949, cp_container#5933 AS cp_container_3#5950, cp_retailprice#5934 AS cp_retailprice_3#5951, cp_comment#5935 AS cp_comment_3#5952, cp_brand#5936 AS cp_brand_3#5953]
            :  :  :  +- Relation[rid#5920,cval_part_p_name#5921,cval_part_p_mfgr#5922,cval_part_p_type#5923,cval_part_p_size#5924,cval_part_p_container#5925,cval_part_p_retailprice#5926,cval_part_p_comment#5927,cval_part_p_brand#5928,cp_name#5929,cp_mfgr#5930,cp_type#5931,cp_size#5932,cp_container#5933,cp_retailprice#5934,cp_comment#5935,cp_brand#5936] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#5954 AS rid_3#5971, cval_part_p_name#5955 AS cval_part_p_name_3#5972, cval_part_p_mfgr#5956 AS cval_part_p_mfgr_3#5973, cval_part_p_type#5957 AS cval_part_p_type_3#5974, cval_part_p_size#5958 AS cval_part_p_size_3#5975, cval_part_p_container#5959 AS cval_part_p_container_3#5976, cval_part_p_retailprice#5960 AS cval_part_p_retailprice_3#5977, cval_part_p_comment#5961 AS cval_part_p_comment_3#5978, cval_part_p_brand#5962 AS cval_part_p_brand_3#5979, cp_name#5963 AS cp_name_3#5980, cp_mfgr#5964 AS cp_mfgr_3#5981, cp_type#5965 AS cp_type_3#5982, cp_size#5966 AS cp_size_3#5983, cp_container#5967 AS cp_container_3#5984, cp_retailprice#5968 AS cp_retailprice_3#5985, cp_comment#5969 AS cp_comment_3#5986, cp_brand#5970 AS cp_brand_3#5987]
            :  :        +- Relation[rid#5954,cval_part_p_name#5955,cval_part_p_mfgr#5956,cval_part_p_type#5957,cval_part_p_size#5958,cval_part_p_container#5959,cval_part_p_retailprice#5960,cval_part_p_comment#5961,cval_part_p_brand#5962,cp_name#5963,cp_mfgr#5964,cp_type#5965,cp_size#5966,cp_container#5967,cp_retailprice#5968,cp_comment#5969,cp_brand#5970] JDBCRelation(tpart) [numPartitions=1]
            :  +- Project [rid#6044 AS rid_4#6055, cpfk_part_partsupp#6045 AS cpfk_part_partsupp_4#6056, cfpk_partsupp_part#6046 AS cfpk_partsupp_part_4#6057, cpfk_supplier_partsupp#6047 AS cpfk_supplier_partsupp_4#6058, cfpk_partsupp_supplier#6048 AS cfpk_partsupp_supplier_4#6059, cval_partsupp_ps_availqty#6049 AS cval_partsupp_ps_availqty_4#6060, cval_partsupp_ps_supplycost#6050 AS cval_partsupp_ps_supplycost_4#6061, cval_partsupp_ps_comment#6051 AS cval_partsupp_ps_comment_4#6062, cps_availqty#6052 AS cps_availqty_4#6063, cps_supplycost#6053 AS cps_supplycost_4#6064, cps_comment#6054 AS cps_comment_4#6065]
            :     +- Relation[rid#6044,cpfk_part_partsupp#6045,cfpk_partsupp_part#6046,cpfk_supplier_partsupp#6047,cfpk_partsupp_supplier#6048,cval_partsupp_ps_availqty#6049,cval_partsupp_ps_supplycost#6050,cval_partsupp_ps_comment#6051,cps_availqty#6052,cps_supplycost#6053,cps_comment#6054] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#5988 AS rid_4#5999, cpfk_part_partsupp#5989 AS cpfk_part_partsupp_4#6000, cfpk_partsupp_part#5990 AS cfpk_partsupp_part_4#6001, cpfk_supplier_partsupp#5991 AS cpfk_supplier_partsupp_4#6002, cfpk_partsupp_supplier#5992 AS cfpk_partsupp_supplier_4#6003, cval_partsupp_ps_availqty#5993 AS cval_partsupp_ps_availqty_4#6004, cval_partsupp_ps_supplycost#5994 AS cval_partsupp_ps_supplycost_4#6005, cval_partsupp_ps_comment#5995 AS cval_partsupp_ps_comment_4#6006, cps_availqty#5996 AS cps_availqty_4#6007, cps_supplycost#5997 AS cps_supplycost_4#6008, cps_comment#5998 AS cps_comment_4#6009]
               +- Relation[rid#5988,cpfk_part_partsupp#5989,cfpk_partsupp_part#5990,cpfk_supplier_partsupp#5991,cfpk_partsupp_supplier#5992,cval_partsupp_ps_availqty#5993,cval_partsupp_ps_supplycost#5994,cval_partsupp_ps_comment#5995,cps_availqty#5996,cps_supplycost#5997,cps_comment#5998] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 1688ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/15 17:24:36 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:24:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6173L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:24:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6173L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#6175 AS rid_0#6192, cval_part_p_name#6176 AS cval_part_p_name_0#6193, cval_part_p_mfgr#6177 AS cval_part_p_mfgr_0#6194, cval_part_p_type#6178 AS cval_part_p_type_0#6195, cval_part_p_size#6179 AS cval_part_p_size_0#6196, cval_part_p_container#6180 AS cval_part_p_container_0#6197, cval_part_p_retailprice#6181 AS cval_part_p_retailprice_0#6198, cval_part_p_comment#6182 AS cval_part_p_comment_0#6199, cval_part_p_brand#6183 AS cval_part_p_brand_0#6200, cp_name#6184 AS cp_name_0#6201, cp_mfgr#6185 AS cp_mfgr_0#6202, cp_type#6186 AS cp_type_0#6203, cp_size#6187 AS cp_size_0#6204, cp_container#6188 AS cp_container_0#6205, cp_retailprice#6189 AS cp_retailprice_0#6206, cp_comment#6190 AS cp_comment_0#6207, cp_brand#6191 AS cp_brand_0#6208]
         :  :  +- Relation[rid#6175,cval_part_p_name#6176,cval_part_p_mfgr#6177,cval_part_p_type#6178,cval_part_p_size#6179,cval_part_p_container#6180,cval_part_p_retailprice#6181,cval_part_p_comment#6182,cval_part_p_brand#6183,cp_name#6184,cp_mfgr#6185,cp_type#6186,cp_size#6187,cp_container#6188,cp_retailprice#6189,cp_comment#6190,cp_brand#6191] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#6275 AS rid_0#6292, cval_part_p_name#6276 AS cval_part_p_name_0#6293, cval_part_p_mfgr#6277 AS cval_part_p_mfgr_0#6294, cval_part_p_type#6278 AS cval_part_p_type_0#6295, cval_part_p_size#6279 AS cval_part_p_size_0#6296, cval_part_p_container#6280 AS cval_part_p_container_0#6297, cval_part_p_retailprice#6281 AS cval_part_p_retailprice_0#6298, cval_part_p_comment#6282 AS cval_part_p_comment_0#6299, cval_part_p_brand#6283 AS cval_part_p_brand_0#6300, cp_name#6284 AS cp_name_0#6301, cp_mfgr#6285 AS cp_mfgr_0#6302, cp_type#6286 AS cp_type_0#6303, cp_size#6287 AS cp_size_0#6304, cp_container#6288 AS cp_container_0#6305, cp_retailprice#6289 AS cp_retailprice_0#6306, cp_comment#6290 AS cp_comment_0#6307, cp_brand#6291 AS cp_brand_0#6308]
         :     :  +- Relation[rid#6275,cval_part_p_name#6276,cval_part_p_mfgr#6277,cval_part_p_type#6278,cval_part_p_size#6279,cval_part_p_container#6280,cval_part_p_retailprice#6281,cval_part_p_comment#6282,cval_part_p_brand#6283,cp_name#6284,cp_mfgr#6285,cp_type#6286,cp_size#6287,cp_container#6288,cp_retailprice#6289,cp_comment#6290,cp_brand#6291] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#6309 AS rid_1#6342, cpfk_orders_lineitem#6310 AS cpfk_orders_lineitem_1#6343, cpfk_supplier_lineitem#6311 AS cpfk_supplier_lineitem_1#6344, cfpk_lineitem_supplier#6312 AS cfpk_lineitem_supplier_1#6345, cfpk_lineitem_partsupp#6313 AS cfpk_lineitem_partsupp_1#6346, cpfk_part_lineitem#6314 AS cpfk_part_lineitem_1#6347, cfpk_lineitem_part#6315 AS cfpk_lineitem_part_1#6348, cpfk_partsupp_lineitem#6316 AS cpfk_partsupp_lineitem_1#6349, cfpk_lineitem_orders#6317 AS cfpk_lineitem_orders_1#6350, cval_lineitem_l_quantity#6318 AS cval_lineitem_l_quantity_1#6351, cval_lineitem_l_extendedprice#6319 AS cval_lineitem_l_extendedprice_1#6352, cval_lineitem_l_discount#6320 AS cval_lineitem_l_discount_1#6353, cval_lineitem_l_tax#6321 AS cval_lineitem_l_tax_1#6354, cval_lineitem_l_returnflag#6322 AS cval_lineitem_l_returnflag_1#6355, cval_lineitem_l_linestatus#6323 AS cval_lineitem_l_linestatus_1#6356, cval_lineitem_l_commitdate#6324 AS cval_lineitem_l_commitdate_1#6357, cval_lineitem_l_receiptdate#6325 AS cval_lineitem_l_receiptdate_1#6358, cval_lineitem_l_shipinstruct#6326 AS cval_lineitem_l_shipinstruct_1#6359, cval_lineitem_l_shipmode#6327 AS cval_lineitem_l_shipmode_1#6360, cval_lineitem_l_comment#6328 AS cval_lineitem_l_comment_1#6361, cval_lineitem_l_shipdate#6329 AS cval_lineitem_l_shipdate_1#6362, cl_quantity#6330 AS cl_quantity_1#6363, cl_extendedprice#6331 AS cl_extendedprice_1#6364, cl_discount#6332 AS cl_discount_1#6365, ... 9 more fields]
         :        +- Relation[rid#6309,cpfk_orders_lineitem#6310,cpfk_supplier_lineitem#6311,cfpk_lineitem_supplier#6312,cfpk_lineitem_partsupp#6313,cpfk_part_lineitem#6314,cfpk_lineitem_part#6315,cpfk_partsupp_lineitem#6316,cfpk_lineitem_orders#6317,cval_lineitem_l_quantity#6318,cval_lineitem_l_extendedprice#6319,cval_lineitem_l_discount#6320,cval_lineitem_l_tax#6321,cval_lineitem_l_returnflag#6322,cval_lineitem_l_linestatus#6323,cval_lineitem_l_commitdate#6324,cval_lineitem_l_receiptdate#6325,cval_lineitem_l_shipinstruct#6326,cval_lineitem_l_shipmode#6327,cval_lineitem_l_comment#6328,cval_lineitem_l_shipdate#6329,cl_quantity#6330,cl_extendedprice#6331,cl_discount#6332,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6209 AS rid_1#6242, cpfk_orders_lineitem#6210 AS cpfk_orders_lineitem_1#6243, cpfk_supplier_lineitem#6211 AS cpfk_supplier_lineitem_1#6244, cfpk_lineitem_supplier#6212 AS cfpk_lineitem_supplier_1#6245, cfpk_lineitem_partsupp#6213 AS cfpk_lineitem_partsupp_1#6246, cpfk_part_lineitem#6214 AS cpfk_part_lineitem_1#6247, cfpk_lineitem_part#6215 AS cfpk_lineitem_part_1#6248, cpfk_partsupp_lineitem#6216 AS cpfk_partsupp_lineitem_1#6249, cfpk_lineitem_orders#6217 AS cfpk_lineitem_orders_1#6250, cval_lineitem_l_quantity#6218 AS cval_lineitem_l_quantity_1#6251, cval_lineitem_l_extendedprice#6219 AS cval_lineitem_l_extendedprice_1#6252, cval_lineitem_l_discount#6220 AS cval_lineitem_l_discount_1#6253, cval_lineitem_l_tax#6221 AS cval_lineitem_l_tax_1#6254, cval_lineitem_l_returnflag#6222 AS cval_lineitem_l_returnflag_1#6255, cval_lineitem_l_linestatus#6223 AS cval_lineitem_l_linestatus_1#6256, cval_lineitem_l_commitdate#6224 AS cval_lineitem_l_commitdate_1#6257, cval_lineitem_l_receiptdate#6225 AS cval_lineitem_l_receiptdate_1#6258, cval_lineitem_l_shipinstruct#6226 AS cval_lineitem_l_shipinstruct_1#6259, cval_lineitem_l_shipmode#6227 AS cval_lineitem_l_shipmode_1#6260, cval_lineitem_l_comment#6228 AS cval_lineitem_l_comment_1#6261, cval_lineitem_l_shipdate#6229 AS cval_lineitem_l_shipdate_1#6262, cl_quantity#6230 AS cl_quantity_1#6263, cl_extendedprice#6231 AS cl_extendedprice_1#6264, cl_discount#6232 AS cl_discount_1#6265, ... 9 more fields]
            +- Relation[rid#6209,cpfk_orders_lineitem#6210,cpfk_supplier_lineitem#6211,cfpk_lineitem_supplier#6212,cfpk_lineitem_partsupp#6213,cpfk_part_lineitem#6214,cfpk_lineitem_part#6215,cpfk_partsupp_lineitem#6216,cfpk_lineitem_orders#6217,cval_lineitem_l_quantity#6218,cval_lineitem_l_extendedprice#6219,cval_lineitem_l_discount#6220,cval_lineitem_l_tax#6221,cval_lineitem_l_returnflag#6222,cval_lineitem_l_linestatus#6223,cval_lineitem_l_commitdate#6224,cval_lineitem_l_receiptdate#6225,cval_lineitem_l_shipinstruct#6226,cval_lineitem_l_shipmode#6227,cval_lineitem_l_comment#6228,cval_lineitem_l_shipdate#6229,cl_quantity#6230,cl_extendedprice#6231,cl_discount#6232,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 95386ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/15 17:26:11 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:26:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6431L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 17:26:11 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:26:11 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:26:11 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:26:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:11 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:26:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:11 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:26:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:26:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:26:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:26:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:26:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6431L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#6433 AS rid_0#6438, cval_region_r_name#6434 AS cval_region_r_name_0#6439, cval_region_r_comment#6435 AS cval_region_r_comment_0#6440, cr_name#6436 AS cr_name_0#6441, cr_comment#6437 AS cr_comment_0#6442]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#6433,cval_region_r_name#6434,cval_region_r_comment#6435,cr_name#6436,cr_comment#6437] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#6443 AS rid_0#6448, cval_region_r_name#6444 AS cval_region_r_name_0#6449, cval_region_r_comment#6445 AS cval_region_r_comment_0#6450, cr_name#6446 AS cr_name_0#6451, cr_comment#6447 AS cr_comment_0#6452]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#6443,cval_region_r_name#6444,cval_region_r_comment#6445,cr_name#6446,cr_comment#6447] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- Project [rid#6477 AS rid_1#6484, cpfk_region_nation#6478 AS cpfk_region_nation_1#6485, cfpk_nation_region#6479 AS cfpk_nation_region_1#6486, cval_nation_n_name#6480 AS cval_nation_n_name_1#6487, cval_nation_n_comment#6481 AS cval_nation_n_comment_1#6488, cn_name#6482 AS cn_name_1#6489, cn_comment#6483 AS cn_comment_1#6490]
         :     :  :  :  :  :  :  :  :     +- Relation[rid#6477,cpfk_region_nation#6478,cfpk_nation_region#6479,cval_nation_n_name#6480,cval_nation_n_comment#6481,cn_name#6482,cn_comment#6483] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#6453 AS rid_1#6460, cpfk_region_nation#6454 AS cpfk_region_nation_1#6461, cfpk_nation_region#6455 AS cfpk_nation_region_1#6462, cval_nation_n_name#6456 AS cval_nation_n_name_1#6463, cval_nation_n_comment#6457 AS cval_nation_n_comment_1#6464, cn_name#6458 AS cn_name_1#6465, cn_comment#6459 AS cn_comment_1#6466]
         :     :  :  :  :  :  :  :     +- Relation[rid#6453,cpfk_region_nation#6454,cfpk_nation_region#6455,cval_nation_n_name#6456,cval_nation_n_comment#6457,cn_name#6458,cn_comment#6459] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- Project [rid#6535 AS rid_2#6550, cpfk_nation_customer#6536 AS cpfk_nation_customer_2#6551, cfpk_customer_nation#6537 AS cfpk_customer_nation_2#6552, cval_customer_c_name#6538 AS cval_customer_c_name_2#6553, cval_customer_c_address#6539 AS cval_customer_c_address_2#6554, cval_customer_c_phone#6540 AS cval_customer_c_phone_2#6555, cval_customer_c_acctbal#6541 AS cval_customer_c_acctbal_2#6556, cval_customer_c_comment#6542 AS cval_customer_c_comment_2#6557, cval_customer_c_mktsegment#6543 AS cval_customer_c_mktsegment_2#6558, cc_name#6544 AS cc_name_2#6559, cc_address#6545 AS cc_address_2#6560, cc_phone#6546 AS cc_phone_2#6561, cc_acctbal#6547 AS cc_acctbal_2#6562, cc_comment#6548 AS cc_comment_2#6563, cc_mktsegment#6549 AS cc_mktsegment_2#6564]
         :     :  :  :  :  :  :     +- Relation[rid#6535,cpfk_nation_customer#6536,cfpk_customer_nation#6537,cval_customer_c_name#6538,cval_customer_c_address#6539,cval_customer_c_phone#6540,cval_customer_c_acctbal#6541,cval_customer_c_comment#6542,cval_customer_c_mktsegment#6543,cc_name#6544,cc_address#6545,cc_phone#6546,cc_acctbal#6547,cc_comment#6548,cc_mktsegment#6549] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#6491 AS rid_2#6506, cpfk_nation_customer#6492 AS cpfk_nation_customer_2#6507, cfpk_customer_nation#6493 AS cfpk_customer_nation_2#6508, cval_customer_c_name#6494 AS cval_customer_c_name_2#6509, cval_customer_c_address#6495 AS cval_customer_c_address_2#6510, cval_customer_c_phone#6496 AS cval_customer_c_phone_2#6511, cval_customer_c_acctbal#6497 AS cval_customer_c_acctbal_2#6512, cval_customer_c_comment#6498 AS cval_customer_c_comment_2#6513, cval_customer_c_mktsegment#6499 AS cval_customer_c_mktsegment_2#6514, cc_name#6500 AS cc_name_2#6515, cc_address#6501 AS cc_address_2#6516, cc_phone#6502 AS cc_phone_2#6517, cc_acctbal#6503 AS cc_acctbal_2#6518, cc_comment#6504 AS cc_comment_2#6519, cc_mktsegment#6505 AS cc_mktsegment_2#6520]
         :     :  :  :  :  :     +- Relation[rid#6491,cpfk_nation_customer#6492,cfpk_customer_nation#6493,cval_customer_c_name#6494,cval_customer_c_address#6495,cval_customer_c_phone#6496,cval_customer_c_acctbal#6497,cval_customer_c_comment#6498,cval_customer_c_mktsegment#6499,cc_name#6500,cc_address#6501,cc_phone#6502,cc_acctbal#6503,cc_comment#6504,cc_mktsegment#6505] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- Project [rid#6629 AS rid_3#6646, cpfk_customer_orders#6630 AS cpfk_customer_orders_3#6647, cfpk_orders_customer#6631 AS cfpk_orders_customer_3#6648, cval_orders_o_orderstatus#6632 AS cval_orders_o_orderstatus_3#6649, cval_orders_o_totalprice#6633 AS cval_orders_o_totalprice_3#6650, cval_orders_o_orderpriority#6634 AS cval_orders_o_orderpriority_3#6651, cval_orders_o_clerk#6635 AS cval_orders_o_clerk_3#6652, cval_orders_o_shippriority#6636 AS cval_orders_o_shippriority_3#6653, cval_orders_o_comment#6637 AS cval_orders_o_comment_3#6654, cval_orders_o_orderdate#6638 AS cval_orders_o_orderdate_3#6655, co_orderstatus#6639 AS co_orderstatus_3#6656, co_totalprice#6640 AS co_totalprice_3#6657, co_orderpriority#6641 AS co_orderpriority_3#6658, co_clerk#6642 AS co_clerk_3#6659, co_shippriority#6643 AS co_shippriority_3#6660, co_comment#6644 AS co_comment_3#6661, co_orderdate#6645 AS co_orderdate_3#6662]
         :     :  :  :  :     +- Relation[rid#6629,cpfk_customer_orders#6630,cfpk_orders_customer#6631,cval_orders_o_orderstatus#6632,cval_orders_o_totalprice#6633,cval_orders_o_orderpriority#6634,cval_orders_o_clerk#6635,cval_orders_o_shippriority#6636,cval_orders_o_comment#6637,cval_orders_o_orderdate#6638,co_orderstatus#6639,co_totalprice#6640,co_orderpriority#6641,co_clerk#6642,co_shippriority#6643,co_comment#6644,co_orderdate#6645] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#6565 AS rid_3#6582, cpfk_customer_orders#6566 AS cpfk_customer_orders_3#6583, cfpk_orders_customer#6567 AS cfpk_orders_customer_3#6584, cval_orders_o_orderstatus#6568 AS cval_orders_o_orderstatus_3#6585, cval_orders_o_totalprice#6569 AS cval_orders_o_totalprice_3#6586, cval_orders_o_orderpriority#6570 AS cval_orders_o_orderpriority_3#6587, cval_orders_o_clerk#6571 AS cval_orders_o_clerk_3#6588, cval_orders_o_shippriority#6572 AS cval_orders_o_shippriority_3#6589, cval_orders_o_comment#6573 AS cval_orders_o_comment_3#6590, cval_orders_o_orderdate#6574 AS cval_orders_o_orderdate_3#6591, co_orderstatus#6575 AS co_orderstatus_3#6592, co_totalprice#6576 AS co_totalprice_3#6593, co_orderpriority#6577 AS co_orderpriority_3#6594, co_clerk#6578 AS co_clerk_3#6595, co_shippriority#6579 AS co_shippriority_3#6596, co_comment#6580 AS co_comment_3#6597, co_orderdate#6581 AS co_orderdate_3#6598]
         :     :  :  :     +- Relation[rid#6565,cpfk_customer_orders#6566,cfpk_orders_customer#6567,cval_orders_o_orderstatus#6568,cval_orders_o_totalprice#6569,cval_orders_o_orderpriority#6570,cval_orders_o_clerk#6571,cval_orders_o_shippriority#6572,cval_orders_o_comment#6573,cval_orders_o_orderdate#6574,co_orderstatus#6575,co_totalprice#6576,co_orderpriority#6577,co_clerk#6578,co_shippriority#6579,co_comment#6580,co_orderdate#6581] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- Project [rid#6763 AS rid_4#6796, cpfk_orders_lineitem#6764 AS cpfk_orders_lineitem_4#6797, cpfk_supplier_lineitem#6765 AS cpfk_supplier_lineitem_4#6798, cfpk_lineitem_supplier#6766 AS cfpk_lineitem_supplier_4#6799, cfpk_lineitem_partsupp#6767 AS cfpk_lineitem_partsupp_4#6800, cpfk_part_lineitem#6768 AS cpfk_part_lineitem_4#6801, cfpk_lineitem_part#6769 AS cfpk_lineitem_part_4#6802, cpfk_partsupp_lineitem#6770 AS cpfk_partsupp_lineitem_4#6803, cfpk_lineitem_orders#6771 AS cfpk_lineitem_orders_4#6804, cval_lineitem_l_quantity#6772 AS cval_lineitem_l_quantity_4#6805, cval_lineitem_l_extendedprice#6773 AS cval_lineitem_l_extendedprice_4#6806, cval_lineitem_l_discount#6774 AS cval_lineitem_l_discount_4#6807, cval_lineitem_l_tax#6775 AS cval_lineitem_l_tax_4#6808, cval_lineitem_l_returnflag#6776 AS cval_lineitem_l_returnflag_4#6809, cval_lineitem_l_linestatus#6777 AS cval_lineitem_l_linestatus_4#6810, cval_lineitem_l_commitdate#6778 AS cval_lineitem_l_commitdate_4#6811, cval_lineitem_l_receiptdate#6779 AS cval_lineitem_l_receiptdate_4#6812, cval_lineitem_l_shipinstruct#6780 AS cval_lineitem_l_shipinstruct_4#6813, cval_lineitem_l_shipmode#6781 AS cval_lineitem_l_shipmode_4#6814, cval_lineitem_l_comment#6782 AS cval_lineitem_l_comment_4#6815, cval_lineitem_l_shipdate#6783 AS cval_lineitem_l_shipdate_4#6816, cl_quantity#6784 AS cl_quantity_4#6817, cl_extendedprice#6785 AS cl_extendedprice_4#6818, cl_discount#6786 AS cl_discount_4#6819, ... 9 more fields]
         :     :  :     +- Relation[rid#6763,cpfk_orders_lineitem#6764,cpfk_supplier_lineitem#6765,cfpk_lineitem_supplier#6766,cfpk_lineitem_partsupp#6767,cpfk_part_lineitem#6768,cfpk_lineitem_part#6769,cpfk_partsupp_lineitem#6770,cfpk_lineitem_orders#6771,cval_lineitem_l_quantity#6772,cval_lineitem_l_extendedprice#6773,cval_lineitem_l_discount#6774,cval_lineitem_l_tax#6775,cval_lineitem_l_returnflag#6776,cval_lineitem_l_linestatus#6777,cval_lineitem_l_commitdate#6778,cval_lineitem_l_receiptdate#6779,cval_lineitem_l_shipinstruct#6780,cval_lineitem_l_shipmode#6781,cval_lineitem_l_comment#6782,cval_lineitem_l_shipdate#6783,cl_quantity#6784,cl_extendedprice#6785,cl_discount#6786,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#6663 AS rid_4#6696, cpfk_orders_lineitem#6664 AS cpfk_orders_lineitem_4#6697, cpfk_supplier_lineitem#6665 AS cpfk_supplier_lineitem_4#6698, cfpk_lineitem_supplier#6666 AS cfpk_lineitem_supplier_4#6699, cfpk_lineitem_partsupp#6667 AS cfpk_lineitem_partsupp_4#6700, cpfk_part_lineitem#6668 AS cpfk_part_lineitem_4#6701, cfpk_lineitem_part#6669 AS cfpk_lineitem_part_4#6702, cpfk_partsupp_lineitem#6670 AS cpfk_partsupp_lineitem_4#6703, cfpk_lineitem_orders#6671 AS cfpk_lineitem_orders_4#6704, cval_lineitem_l_quantity#6672 AS cval_lineitem_l_quantity_4#6705, cval_lineitem_l_extendedprice#6673 AS cval_lineitem_l_extendedprice_4#6706, cval_lineitem_l_discount#6674 AS cval_lineitem_l_discount_4#6707, cval_lineitem_l_tax#6675 AS cval_lineitem_l_tax_4#6708, cval_lineitem_l_returnflag#6676 AS cval_lineitem_l_returnflag_4#6709, cval_lineitem_l_linestatus#6677 AS cval_lineitem_l_linestatus_4#6710, cval_lineitem_l_commitdate#6678 AS cval_lineitem_l_commitdate_4#6711, cval_lineitem_l_receiptdate#6679 AS cval_lineitem_l_receiptdate_4#6712, cval_lineitem_l_shipinstruct#6680 AS cval_lineitem_l_shipinstruct_4#6713, cval_lineitem_l_shipmode#6681 AS cval_lineitem_l_shipmode_4#6714, cval_lineitem_l_comment#6682 AS cval_lineitem_l_comment_4#6715, cval_lineitem_l_shipdate#6683 AS cval_lineitem_l_shipdate_4#6716, cl_quantity#6684 AS cl_quantity_4#6717, cl_extendedprice#6685 AS cl_extendedprice_4#6718, cl_discount#6686 AS cl_discount_4#6719, ... 9 more fields]
         :     :     +- Relation[rid#6663,cpfk_orders_lineitem#6664,cpfk_supplier_lineitem#6665,cfpk_lineitem_supplier#6666,cfpk_lineitem_partsupp#6667,cpfk_part_lineitem#6668,cfpk_lineitem_part#6669,cpfk_partsupp_lineitem#6670,cfpk_lineitem_orders#6671,cval_lineitem_l_quantity#6672,cval_lineitem_l_extendedprice#6673,cval_lineitem_l_discount#6674,cval_lineitem_l_tax#6675,cval_lineitem_l_returnflag#6676,cval_lineitem_l_linestatus#6677,cval_lineitem_l_commitdate#6678,cval_lineitem_l_receiptdate#6679,cval_lineitem_l_shipinstruct#6680,cval_lineitem_l_shipmode#6681,cval_lineitem_l_comment#6682,cval_lineitem_l_shipdate#6683,cl_quantity#6684,cl_extendedprice#6685,cl_discount#6686,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#6829 AS rid_5#6842, cpfk_nation_supplier#6830 AS cpfk_nation_supplier_5#6843, cfpk_supplier_nation#6831 AS cfpk_supplier_nation_5#6844, cval_supplier_s_name#6832 AS cval_supplier_s_name_5#6845, cval_supplier_s_address#6833 AS cval_supplier_s_address_5#6846, cval_supplier_s_phone#6834 AS cval_supplier_s_phone_5#6847, cval_supplier_s_acctbal#6835 AS cval_supplier_s_acctbal_5#6848, cval_supplier_s_comment#6836 AS cval_supplier_s_comment_5#6849, cs_name#6837 AS cs_name_5#6850, cs_address#6838 AS cs_address_5#6851, cs_phone#6839 AS cs_phone_5#6852, cs_acctbal#6840 AS cs_acctbal_5#6853, cs_comment#6841 AS cs_comment_5#6854]
         :        +- Relation[rid#6829,cpfk_nation_supplier#6830,cfpk_supplier_nation#6831,cval_supplier_s_name#6832,cval_supplier_s_address#6833,cval_supplier_s_phone#6834,cval_supplier_s_acctbal#6835,cval_supplier_s_comment#6836,cs_name#6837,cs_address#6838,cs_phone#6839,cs_acctbal#6840,cs_comment#6841] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#6855 AS rid_1#6862, cpfk_region_nation#6856 AS cpfk_region_nation_1#6863, cfpk_nation_region#6857 AS cfpk_nation_region_1#6864, cval_nation_n_name#6858 AS cval_nation_n_name_1#6865, cval_nation_n_comment#6859 AS cval_nation_n_comment_1#6866, cn_name#6860 AS cn_name_1#6867, cn_comment#6861 AS cn_comment_1#6868]
            :  +- Relation[rid#6855,cpfk_region_nation#6856,cfpk_nation_region#6857,cval_nation_n_name#6858,cval_nation_n_comment#6859,cn_name#6860,cn_comment#6861] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#6869 AS rid_5#6882, cpfk_nation_supplier#6870 AS cpfk_nation_supplier_5#6883, cfpk_supplier_nation#6871 AS cfpk_supplier_nation_5#6884, cval_supplier_s_name#6872 AS cval_supplier_s_name_5#6885, cval_supplier_s_address#6873 AS cval_supplier_s_address_5#6886, cval_supplier_s_phone#6874 AS cval_supplier_s_phone_5#6887, cval_supplier_s_acctbal#6875 AS cval_supplier_s_acctbal_5#6888, cval_supplier_s_comment#6876 AS cval_supplier_s_comment_5#6889, cs_name#6877 AS cs_name_5#6890, cs_address#6878 AS cs_address_5#6891, cs_phone#6879 AS cs_phone_5#6892, cs_acctbal#6880 AS cs_acctbal_5#6893, cs_comment#6881 AS cs_comment_5#6894]
               +- Relation[rid#6869,cpfk_nation_supplier#6870,cfpk_supplier_nation#6871,cval_supplier_s_name#6872,cval_supplier_s_address#6873,cval_supplier_s_phone#6874,cval_supplier_s_acctbal#6875,cval_supplier_s_comment#6876,cs_name#6877,cs_address#6878,cs_phone#6879,cs_acctbal#6880,cs_comment#6881] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=3
Elapsed time: 21715ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/15 17:26:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:26:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6993L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 17:26:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:26:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:26:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:26:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:26:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:26:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6993L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#6995 AS rid_0#7002, cpfk_region_nation#6996 AS cpfk_region_nation_0#7003, cfpk_nation_region#6997 AS cfpk_nation_region_0#7004, cval_nation_n_name#6998 AS cval_nation_n_name_0#7005, cval_nation_n_comment#6999 AS cval_nation_n_comment_0#7006, cn_name#7000 AS cn_name_0#7007, cn_comment#7001 AS cn_comment_0#7008]
            :  :  :  :  :  :  +- Relation[rid#6995,cpfk_region_nation#6996,cfpk_nation_region#6997,cval_nation_n_name#6998,cval_nation_n_comment#6999,cn_name#7000,cn_comment#7001] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#7009 AS rid_0#7016, cpfk_region_nation#7010 AS cpfk_region_nation_0#7017, cfpk_nation_region#7011 AS cfpk_nation_region_0#7018, cval_nation_n_name#7012 AS cval_nation_n_name_0#7019, cval_nation_n_comment#7013 AS cval_nation_n_comment_0#7020, cn_name#7014 AS cn_name_0#7021, cn_comment#7015 AS cn_comment_0#7022]
            :  :  :  :  :        +- Relation[rid#7009,cpfk_region_nation#7010,cfpk_nation_region#7011,cval_nation_n_name#7012,cval_nation_n_comment#7013,cn_name#7014,cn_comment#7015] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- Project [rid#7063 AS rid_1#7076, cpfk_nation_supplier#7064 AS cpfk_nation_supplier_1#7077, cfpk_supplier_nation#7065 AS cfpk_supplier_nation_1#7078, cval_supplier_s_name#7066 AS cval_supplier_s_name_1#7079, cval_supplier_s_address#7067 AS cval_supplier_s_address_1#7080, cval_supplier_s_phone#7068 AS cval_supplier_s_phone_1#7081, cval_supplier_s_acctbal#7069 AS cval_supplier_s_acctbal_1#7082, cval_supplier_s_comment#7070 AS cval_supplier_s_comment_1#7083, cs_name#7071 AS cs_name_1#7084, cs_address#7072 AS cs_address_1#7085, cs_phone#7073 AS cs_phone_1#7086, cs_acctbal#7074 AS cs_acctbal_1#7087, cs_comment#7075 AS cs_comment_1#7088]
            :  :  :  :     +- Relation[rid#7063,cpfk_nation_supplier#7064,cfpk_supplier_nation#7065,cval_supplier_s_name#7066,cval_supplier_s_address#7067,cval_supplier_s_phone#7068,cval_supplier_s_acctbal#7069,cval_supplier_s_comment#7070,cs_name#7071,cs_address#7072,cs_phone#7073,cs_acctbal#7074,cs_comment#7075] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#7023 AS rid_1#7036, cpfk_nation_supplier#7024 AS cpfk_nation_supplier_1#7037, cfpk_supplier_nation#7025 AS cfpk_supplier_nation_1#7038, cval_supplier_s_name#7026 AS cval_supplier_s_name_1#7039, cval_supplier_s_address#7027 AS cval_supplier_s_address_1#7040, cval_supplier_s_phone#7028 AS cval_supplier_s_phone_1#7041, cval_supplier_s_acctbal#7029 AS cval_supplier_s_acctbal_1#7042, cval_supplier_s_comment#7030 AS cval_supplier_s_comment_1#7043, cs_name#7031 AS cs_name_1#7044, cs_address#7032 AS cs_address_1#7045, cs_phone#7033 AS cs_phone_1#7046, cs_acctbal#7034 AS cs_acctbal_1#7047, cs_comment#7035 AS cs_comment_1#7048]
            :  :  :     +- Relation[rid#7023,cpfk_nation_supplier#7024,cfpk_supplier_nation#7025,cval_supplier_s_name#7026,cval_supplier_s_address#7027,cval_supplier_s_phone#7028,cval_supplier_s_acctbal#7029,cval_supplier_s_comment#7030,cs_name#7031,cs_address#7032,cs_phone#7033,cs_acctbal#7034,cs_comment#7035] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- Project [rid#7181 AS rid_2#7214, cpfk_orders_lineitem#7182 AS cpfk_orders_lineitem_2#7215, cpfk_supplier_lineitem#7183 AS cpfk_supplier_lineitem_2#7216, cfpk_lineitem_supplier#7184 AS cfpk_lineitem_supplier_2#7217, cfpk_lineitem_partsupp#7185 AS cfpk_lineitem_partsupp_2#7218, cpfk_part_lineitem#7186 AS cpfk_part_lineitem_2#7219, cfpk_lineitem_part#7187 AS cfpk_lineitem_part_2#7220, cpfk_partsupp_lineitem#7188 AS cpfk_partsupp_lineitem_2#7221, cfpk_lineitem_orders#7189 AS cfpk_lineitem_orders_2#7222, cval_lineitem_l_quantity#7190 AS cval_lineitem_l_quantity_2#7223, cval_lineitem_l_extendedprice#7191 AS cval_lineitem_l_extendedprice_2#7224, cval_lineitem_l_discount#7192 AS cval_lineitem_l_discount_2#7225, cval_lineitem_l_tax#7193 AS cval_lineitem_l_tax_2#7226, cval_lineitem_l_returnflag#7194 AS cval_lineitem_l_returnflag_2#7227, cval_lineitem_l_linestatus#7195 AS cval_lineitem_l_linestatus_2#7228, cval_lineitem_l_commitdate#7196 AS cval_lineitem_l_commitdate_2#7229, cval_lineitem_l_receiptdate#7197 AS cval_lineitem_l_receiptdate_2#7230, cval_lineitem_l_shipinstruct#7198 AS cval_lineitem_l_shipinstruct_2#7231, cval_lineitem_l_shipmode#7199 AS cval_lineitem_l_shipmode_2#7232, cval_lineitem_l_comment#7200 AS cval_lineitem_l_comment_2#7233, cval_lineitem_l_shipdate#7201 AS cval_lineitem_l_shipdate_2#7234, cl_quantity#7202 AS cl_quantity_2#7235, cl_extendedprice#7203 AS cl_extendedprice_2#7236, cl_discount#7204 AS cl_discount_2#7237, ... 9 more fields]
            :  :     +- Relation[rid#7181,cpfk_orders_lineitem#7182,cpfk_supplier_lineitem#7183,cfpk_lineitem_supplier#7184,cfpk_lineitem_partsupp#7185,cpfk_part_lineitem#7186,cfpk_lineitem_part#7187,cpfk_partsupp_lineitem#7188,cfpk_lineitem_orders#7189,cval_lineitem_l_quantity#7190,cval_lineitem_l_extendedprice#7191,cval_lineitem_l_discount#7192,cval_lineitem_l_tax#7193,cval_lineitem_l_returnflag#7194,cval_lineitem_l_linestatus#7195,cval_lineitem_l_commitdate#7196,cval_lineitem_l_receiptdate#7197,cval_lineitem_l_shipinstruct#7198,cval_lineitem_l_shipmode#7199,cval_lineitem_l_comment#7200,cval_lineitem_l_shipdate#7201,cl_quantity#7202,cl_extendedprice#7203,cl_discount#7204,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#7089 AS rid_2#7122, cpfk_orders_lineitem#7090 AS cpfk_orders_lineitem_2#7123, cpfk_supplier_lineitem#7091 AS cpfk_supplier_lineitem_2#7124, cfpk_lineitem_supplier#7092 AS cfpk_lineitem_supplier_2#7125, cfpk_lineitem_partsupp#7093 AS cfpk_lineitem_partsupp_2#7126, cpfk_part_lineitem#7094 AS cpfk_part_lineitem_2#7127, cfpk_lineitem_part#7095 AS cfpk_lineitem_part_2#7128, cpfk_partsupp_lineitem#7096 AS cpfk_partsupp_lineitem_2#7129, cfpk_lineitem_orders#7097 AS cfpk_lineitem_orders_2#7130, cval_lineitem_l_quantity#7098 AS cval_lineitem_l_quantity_2#7131, cval_lineitem_l_extendedprice#7099 AS cval_lineitem_l_extendedprice_2#7132, cval_lineitem_l_discount#7100 AS cval_lineitem_l_discount_2#7133, cval_lineitem_l_tax#7101 AS cval_lineitem_l_tax_2#7134, cval_lineitem_l_returnflag#7102 AS cval_lineitem_l_returnflag_2#7135, cval_lineitem_l_linestatus#7103 AS cval_lineitem_l_linestatus_2#7136, cval_lineitem_l_commitdate#7104 AS cval_lineitem_l_commitdate_2#7137, cval_lineitem_l_receiptdate#7105 AS cval_lineitem_l_receiptdate_2#7138, cval_lineitem_l_shipinstruct#7106 AS cval_lineitem_l_shipinstruct_2#7139, cval_lineitem_l_shipmode#7107 AS cval_lineitem_l_shipmode_2#7140, cval_lineitem_l_comment#7108 AS cval_lineitem_l_comment_2#7141, cval_lineitem_l_shipdate#7109 AS cval_lineitem_l_shipdate_2#7142, cl_quantity#7110 AS cl_quantity_2#7143, cl_extendedprice#7111 AS cl_extendedprice_2#7144, cl_discount#7112 AS cl_discount_2#7145, ... 9 more fields]
            :     +- Relation[rid#7089,cpfk_orders_lineitem#7090,cpfk_supplier_lineitem#7091,cfpk_lineitem_supplier#7092,cfpk_lineitem_partsupp#7093,cpfk_part_lineitem#7094,cfpk_lineitem_part#7095,cpfk_partsupp_lineitem#7096,cfpk_lineitem_orders#7097,cval_lineitem_l_quantity#7098,cval_lineitem_l_extendedprice#7099,cval_lineitem_l_discount#7100,cval_lineitem_l_tax#7101,cval_lineitem_l_returnflag#7102,cval_lineitem_l_linestatus#7103,cval_lineitem_l_commitdate#7104,cval_lineitem_l_receiptdate#7105,cval_lineitem_l_shipinstruct#7106,cval_lineitem_l_shipmode#7107,cval_lineitem_l_comment#7108,cval_lineitem_l_shipdate#7109,cl_quantity#7110,cl_extendedprice#7111,cl_discount#7112,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#7247 AS rid_3#7254, cpfk_region_nation#7248 AS cpfk_region_nation_3#7255, cfpk_nation_region#7249 AS cfpk_nation_region_3#7256, cval_nation_n_name#7250 AS cval_nation_n_name_3#7257, cval_nation_n_comment#7251 AS cval_nation_n_comment_3#7258, cn_name#7252 AS cn_name_3#7259, cn_comment#7253 AS cn_comment_3#7260]
               :  :  :  :  :  +- Relation[rid#7247,cpfk_region_nation#7248,cfpk_nation_region#7249,cval_nation_n_name#7250,cval_nation_n_comment#7251,cn_name#7252,cn_comment#7253] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#7261 AS rid_3#7268, cpfk_region_nation#7262 AS cpfk_region_nation_3#7269, cfpk_nation_region#7263 AS cfpk_nation_region_3#7270, cval_nation_n_name#7264 AS cval_nation_n_name_3#7271, cval_nation_n_comment#7265 AS cval_nation_n_comment_3#7272, cn_name#7266 AS cn_name_3#7273, cn_comment#7267 AS cn_comment_3#7274]
               :  :  :  :        +- Relation[rid#7261,cpfk_region_nation#7262,cfpk_nation_region#7263,cval_nation_n_name#7264,cval_nation_n_comment#7265,cn_name#7266,cn_comment#7267] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#7319 AS rid_4#7334, cpfk_nation_customer#7320 AS cpfk_nation_customer_4#7335, cfpk_customer_nation#7321 AS cfpk_customer_nation_4#7336, cval_customer_c_name#7322 AS cval_customer_c_name_4#7337, cval_customer_c_address#7323 AS cval_customer_c_address_4#7338, cval_customer_c_phone#7324 AS cval_customer_c_phone_4#7339, cval_customer_c_acctbal#7325 AS cval_customer_c_acctbal_4#7340, cval_customer_c_comment#7326 AS cval_customer_c_comment_4#7341, cval_customer_c_mktsegment#7327 AS cval_customer_c_mktsegment_4#7342, cc_name#7328 AS cc_name_4#7343, cc_address#7329 AS cc_address_4#7344, cc_phone#7330 AS cc_phone_4#7345, cc_acctbal#7331 AS cc_acctbal_4#7346, cc_comment#7332 AS cc_comment_4#7347, cc_mktsegment#7333 AS cc_mktsegment_4#7348]
               :  :  :     +- Relation[rid#7319,cpfk_nation_customer#7320,cfpk_customer_nation#7321,cval_customer_c_name#7322,cval_customer_c_address#7323,cval_customer_c_phone#7324,cval_customer_c_acctbal#7325,cval_customer_c_comment#7326,cval_customer_c_mktsegment#7327,cc_name#7328,cc_address#7329,cc_phone#7330,cc_acctbal#7331,cc_comment#7332,cc_mktsegment#7333] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#7275 AS rid_4#7290, cpfk_nation_customer#7276 AS cpfk_nation_customer_4#7291, cfpk_customer_nation#7277 AS cfpk_customer_nation_4#7292, cval_customer_c_name#7278 AS cval_customer_c_name_4#7293, cval_customer_c_address#7279 AS cval_customer_c_address_4#7294, cval_customer_c_phone#7280 AS cval_customer_c_phone_4#7295, cval_customer_c_acctbal#7281 AS cval_customer_c_acctbal_4#7296, cval_customer_c_comment#7282 AS cval_customer_c_comment_4#7297, cval_customer_c_mktsegment#7283 AS cval_customer_c_mktsegment_4#7298, cc_name#7284 AS cc_name_4#7299, cc_address#7285 AS cc_address_4#7300, cc_phone#7286 AS cc_phone_4#7301, cc_acctbal#7287 AS cc_acctbal_4#7302, cc_comment#7288 AS cc_comment_4#7303, cc_mktsegment#7289 AS cc_mktsegment_4#7304]
               :  :     +- Relation[rid#7275,cpfk_nation_customer#7276,cfpk_customer_nation#7277,cval_customer_c_name#7278,cval_customer_c_address#7279,cval_customer_c_phone#7280,cval_customer_c_acctbal#7281,cval_customer_c_comment#7282,cval_customer_c_mktsegment#7283,cc_name#7284,cc_address#7285,cc_phone#7286,cc_acctbal#7287,cc_comment#7288,cc_mktsegment#7289] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#7413 AS rid_5#7430, cpfk_customer_orders#7414 AS cpfk_customer_orders_5#7431, cfpk_orders_customer#7415 AS cfpk_orders_customer_5#7432, cval_orders_o_orderstatus#7416 AS cval_orders_o_orderstatus_5#7433, cval_orders_o_totalprice#7417 AS cval_orders_o_totalprice_5#7434, cval_orders_o_orderpriority#7418 AS cval_orders_o_orderpriority_5#7435, cval_orders_o_clerk#7419 AS cval_orders_o_clerk_5#7436, cval_orders_o_shippriority#7420 AS cval_orders_o_shippriority_5#7437, cval_orders_o_comment#7421 AS cval_orders_o_comment_5#7438, cval_orders_o_orderdate#7422 AS cval_orders_o_orderdate_5#7439, co_orderstatus#7423 AS co_orderstatus_5#7440, co_totalprice#7424 AS co_totalprice_5#7441, co_orderpriority#7425 AS co_orderpriority_5#7442, co_clerk#7426 AS co_clerk_5#7443, co_shippriority#7427 AS co_shippriority_5#7444, co_comment#7428 AS co_comment_5#7445, co_orderdate#7429 AS co_orderdate_5#7446]
               :     +- Relation[rid#7413,cpfk_customer_orders#7414,cfpk_orders_customer#7415,cval_orders_o_orderstatus#7416,cval_orders_o_totalprice#7417,cval_orders_o_orderpriority#7418,cval_orders_o_clerk#7419,cval_orders_o_shippriority#7420,cval_orders_o_comment#7421,cval_orders_o_orderdate#7422,co_orderstatus#7423,co_totalprice#7424,co_orderpriority#7425,co_clerk#7426,co_shippriority#7427,co_comment#7428,co_orderdate#7429] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#7349 AS rid_5#7366, cpfk_customer_orders#7350 AS cpfk_customer_orders_5#7367, cfpk_orders_customer#7351 AS cfpk_orders_customer_5#7368, cval_orders_o_orderstatus#7352 AS cval_orders_o_orderstatus_5#7369, cval_orders_o_totalprice#7353 AS cval_orders_o_totalprice_5#7370, cval_orders_o_orderpriority#7354 AS cval_orders_o_orderpriority_5#7371, cval_orders_o_clerk#7355 AS cval_orders_o_clerk_5#7372, cval_orders_o_shippriority#7356 AS cval_orders_o_shippriority_5#7373, cval_orders_o_comment#7357 AS cval_orders_o_comment_5#7374, cval_orders_o_orderdate#7358 AS cval_orders_o_orderdate_5#7375, co_orderstatus#7359 AS co_orderstatus_5#7376, co_totalprice#7360 AS co_totalprice_5#7377, co_orderpriority#7361 AS co_orderpriority_5#7378, co_clerk#7362 AS co_clerk_5#7379, co_shippriority#7363 AS co_shippriority_5#7380, co_comment#7364 AS co_comment_5#7381, co_orderdate#7365 AS co_orderdate_5#7382]
                  +- Relation[rid#7349,cpfk_customer_orders#7350,cfpk_orders_customer#7351,cval_orders_o_orderstatus#7352,cval_orders_o_totalprice#7353,cval_orders_o_orderpriority#7354,cval_orders_o_clerk#7355,cval_orders_o_shippriority#7356,cval_orders_o_comment#7357,cval_orders_o_orderdate#7358,co_orderstatus#7359,co_totalprice#7360,co_orderpriority#7361,co_clerk#7362,co_shippriority#7363,co_comment#7364,co_orderdate#7365] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 383ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/15 17:26:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:26:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7543L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 17:26:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7543L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#7545 AS rid_0#7562, cpfk_customer_orders#7546 AS cpfk_customer_orders_0#7563, cfpk_orders_customer#7547 AS cfpk_orders_customer_0#7564, cval_orders_o_orderstatus#7548 AS cval_orders_o_orderstatus_0#7565, cval_orders_o_totalprice#7549 AS cval_orders_o_totalprice_0#7566, cval_orders_o_orderpriority#7550 AS cval_orders_o_orderpriority_0#7567, cval_orders_o_clerk#7551 AS cval_orders_o_clerk_0#7568, cval_orders_o_shippriority#7552 AS cval_orders_o_shippriority_0#7569, cval_orders_o_comment#7553 AS cval_orders_o_comment_0#7570, cval_orders_o_orderdate#7554 AS cval_orders_o_orderdate_0#7571, co_orderstatus#7555 AS co_orderstatus_0#7572, co_totalprice#7556 AS co_totalprice_0#7573, co_orderpriority#7557 AS co_orderpriority_0#7574, co_clerk#7558 AS co_clerk_0#7575, co_shippriority#7559 AS co_shippriority_0#7576, co_comment#7560 AS co_comment_0#7577, co_orderdate#7561 AS co_orderdate_0#7578]
            :  +- Relation[rid#7545,cpfk_customer_orders#7546,cfpk_orders_customer#7547,cval_orders_o_orderstatus#7548,cval_orders_o_totalprice#7549,cval_orders_o_orderpriority#7550,cval_orders_o_clerk#7551,cval_orders_o_shippriority#7552,cval_orders_o_comment#7553,cval_orders_o_orderdate#7554,co_orderstatus#7555,co_totalprice#7556,co_orderpriority#7557,co_clerk#7558,co_shippriority#7559,co_comment#7560,co_orderdate#7561] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#7579 AS rid_1#7594, cpfk_nation_customer#7580 AS cpfk_nation_customer_1#7595, cfpk_customer_nation#7581 AS cfpk_customer_nation_1#7596, cval_customer_c_name#7582 AS cval_customer_c_name_1#7597, cval_customer_c_address#7583 AS cval_customer_c_address_1#7598, cval_customer_c_phone#7584 AS cval_customer_c_phone_1#7599, cval_customer_c_acctbal#7585 AS cval_customer_c_acctbal_1#7600, cval_customer_c_comment#7586 AS cval_customer_c_comment_1#7601, cval_customer_c_mktsegment#7587 AS cval_customer_c_mktsegment_1#7602, cc_name#7588 AS cc_name_1#7603, cc_address#7589 AS cc_address_1#7604, cc_phone#7590 AS cc_phone_1#7605, cc_acctbal#7591 AS cc_acctbal_1#7606, cc_comment#7592 AS cc_comment_1#7607, cc_mktsegment#7593 AS cc_mktsegment_1#7608]
               +- Relation[rid#7579,cpfk_nation_customer#7580,cfpk_customer_nation#7581,cval_customer_c_name#7582,cval_customer_c_address#7583,cval_customer_c_phone#7584,cval_customer_c_acctbal#7585,cval_customer_c_comment#7586,cval_customer_c_mktsegment#7587,cc_name#7588,cc_address#7589,cc_phone#7590,cc_acctbal#7591,cc_comment#7592,cc_mktsegment#7593] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13400ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/15 17:26:46 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:26:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7646L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 17:26:46 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:26:46 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:26:46 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:26:46 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:46 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:46 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:26:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:26:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:26:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:26:47 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:26:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:26:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7646L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#7648 AS rid_0#7665, cval_part_p_name#7649 AS cval_part_p_name_0#7666, cval_part_p_mfgr#7650 AS cval_part_p_mfgr_0#7667, cval_part_p_type#7651 AS cval_part_p_type_0#7668, cval_part_p_size#7652 AS cval_part_p_size_0#7669, cval_part_p_container#7653 AS cval_part_p_container_0#7670, cval_part_p_retailprice#7654 AS cval_part_p_retailprice_0#7671, cval_part_p_comment#7655 AS cval_part_p_comment_0#7672, cval_part_p_brand#7656 AS cval_part_p_brand_0#7673, cp_name#7657 AS cp_name_0#7674, cp_mfgr#7658 AS cp_mfgr_0#7675, cp_type#7659 AS cp_type_0#7676, cp_size#7660 AS cp_size_0#7677, cp_container#7661 AS cp_container_0#7678, cp_retailprice#7662 AS cp_retailprice_0#7679, cp_comment#7663 AS cp_comment_0#7680, cp_brand#7664 AS cp_brand_0#7681]
            :  :  :  :  +- Relation[rid#7648,cval_part_p_name#7649,cval_part_p_mfgr#7650,cval_part_p_type#7651,cval_part_p_size#7652,cval_part_p_container#7653,cval_part_p_retailprice#7654,cval_part_p_comment#7655,cval_part_p_brand#7656,cp_name#7657,cp_mfgr#7658,cp_type#7659,cp_size#7660,cp_container#7661,cp_retailprice#7662,cp_comment#7663,cp_brand#7664] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#7682 AS rid_0#7699, cval_part_p_name#7683 AS cval_part_p_name_0#7700, cval_part_p_mfgr#7684 AS cval_part_p_mfgr_0#7701, cval_part_p_type#7685 AS cval_part_p_type_0#7702, cval_part_p_size#7686 AS cval_part_p_size_0#7703, cval_part_p_container#7687 AS cval_part_p_container_0#7704, cval_part_p_retailprice#7688 AS cval_part_p_retailprice_0#7705, cval_part_p_comment#7689 AS cval_part_p_comment_0#7706, cval_part_p_brand#7690 AS cval_part_p_brand_0#7707, cp_name#7691 AS cp_name_0#7708, cp_mfgr#7692 AS cp_mfgr_0#7709, cp_type#7693 AS cp_type_0#7710, cp_size#7694 AS cp_size_0#7711, cp_container#7695 AS cp_container_0#7712, cp_retailprice#7696 AS cp_retailprice_0#7713, cp_comment#7697 AS cp_comment_0#7714, cp_brand#7698 AS cp_brand_0#7715]
            :  :  :        +- Relation[rid#7682,cval_part_p_name#7683,cval_part_p_mfgr#7684,cval_part_p_type#7685,cval_part_p_size#7686,cval_part_p_container#7687,cval_part_p_retailprice#7688,cval_part_p_comment#7689,cval_part_p_brand#7690,cp_name#7691,cp_mfgr#7692,cp_type#7693,cp_size#7694,cp_container#7695,cp_retailprice#7696,cp_comment#7697,cp_brand#7698] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- Project [rid#7772 AS rid_1#7783, cpfk_part_partsupp#7773 AS cpfk_part_partsupp_1#7784, cfpk_partsupp_part#7774 AS cfpk_partsupp_part_1#7785, cpfk_supplier_partsupp#7775 AS cpfk_supplier_partsupp_1#7786, cfpk_partsupp_supplier#7776 AS cfpk_partsupp_supplier_1#7787, cval_partsupp_ps_availqty#7777 AS cval_partsupp_ps_availqty_1#7788, cval_partsupp_ps_supplycost#7778 AS cval_partsupp_ps_supplycost_1#7789, cval_partsupp_ps_comment#7779 AS cval_partsupp_ps_comment_1#7790, cps_availqty#7780 AS cps_availqty_1#7791, cps_supplycost#7781 AS cps_supplycost_1#7792, cps_comment#7782 AS cps_comment_1#7793]
            :  :     +- Relation[rid#7772,cpfk_part_partsupp#7773,cfpk_partsupp_part#7774,cpfk_supplier_partsupp#7775,cfpk_partsupp_supplier#7776,cval_partsupp_ps_availqty#7777,cval_partsupp_ps_supplycost#7778,cval_partsupp_ps_comment#7779,cps_availqty#7780,cps_supplycost#7781,cps_comment#7782] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#7716 AS rid_1#7727, cpfk_part_partsupp#7717 AS cpfk_part_partsupp_1#7728, cfpk_partsupp_part#7718 AS cfpk_partsupp_part_1#7729, cpfk_supplier_partsupp#7719 AS cpfk_supplier_partsupp_1#7730, cfpk_partsupp_supplier#7720 AS cfpk_partsupp_supplier_1#7731, cval_partsupp_ps_availqty#7721 AS cval_partsupp_ps_availqty_1#7732, cval_partsupp_ps_supplycost#7722 AS cval_partsupp_ps_supplycost_1#7733, cval_partsupp_ps_comment#7723 AS cval_partsupp_ps_comment_1#7734, cps_availqty#7724 AS cps_availqty_1#7735, cps_supplycost#7725 AS cps_supplycost_1#7736, cps_comment#7726 AS cps_comment_1#7737]
            :     +- Relation[rid#7716,cpfk_part_partsupp#7717,cfpk_partsupp_part#7718,cpfk_supplier_partsupp#7719,cfpk_partsupp_supplier#7720,cval_partsupp_ps_availqty#7721,cval_partsupp_ps_supplycost#7722,cval_partsupp_ps_comment#7723,cps_availqty#7724,cps_supplycost#7725,cps_comment#7726] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#7794 AS rid_2#7801, cpfk_region_nation#7795 AS cpfk_region_nation_2#7802, cfpk_nation_region#7796 AS cfpk_nation_region_2#7803, cval_nation_n_name#7797 AS cval_nation_n_name_2#7804, cval_nation_n_comment#7798 AS cval_nation_n_comment_2#7805, cn_name#7799 AS cn_name_2#7806, cn_comment#7800 AS cn_comment_2#7807]
               :  :  :  +- Relation[rid#7794,cpfk_region_nation#7795,cfpk_nation_region#7796,cval_nation_n_name#7797,cval_nation_n_comment#7798,cn_name#7799,cn_comment#7800] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#7808 AS rid_2#7815, cpfk_region_nation#7809 AS cpfk_region_nation_2#7816, cfpk_nation_region#7810 AS cfpk_nation_region_2#7817, cval_nation_n_name#7811 AS cval_nation_n_name_2#7818, cval_nation_n_comment#7812 AS cval_nation_n_comment_2#7819, cn_name#7813 AS cn_name_2#7820, cn_comment#7814 AS cn_comment_2#7821]
               :  :        +- Relation[rid#7808,cpfk_region_nation#7809,cfpk_nation_region#7810,cval_nation_n_name#7811,cval_nation_n_comment#7812,cn_name#7813,cn_comment#7814] JDBCRelation(tnation) [numPartitions=1]
               :  +- Project [rid#7862 AS rid_3#7875, cpfk_nation_supplier#7863 AS cpfk_nation_supplier_3#7876, cfpk_supplier_nation#7864 AS cfpk_supplier_nation_3#7877, cval_supplier_s_name#7865 AS cval_supplier_s_name_3#7878, cval_supplier_s_address#7866 AS cval_supplier_s_address_3#7879, cval_supplier_s_phone#7867 AS cval_supplier_s_phone_3#7880, cval_supplier_s_acctbal#7868 AS cval_supplier_s_acctbal_3#7881, cval_supplier_s_comment#7869 AS cval_supplier_s_comment_3#7882, cs_name#7870 AS cs_name_3#7883, cs_address#7871 AS cs_address_3#7884, cs_phone#7872 AS cs_phone_3#7885, cs_acctbal#7873 AS cs_acctbal_3#7886, cs_comment#7874 AS cs_comment_3#7887]
               :     +- Relation[rid#7862,cpfk_nation_supplier#7863,cfpk_supplier_nation#7864,cval_supplier_s_name#7865,cval_supplier_s_address#7866,cval_supplier_s_phone#7867,cval_supplier_s_acctbal#7868,cval_supplier_s_comment#7869,cs_name#7870,cs_address#7871,cs_phone#7872,cs_acctbal#7873,cs_comment#7874] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#7822 AS rid_3#7835, cpfk_nation_supplier#7823 AS cpfk_nation_supplier_3#7836, cfpk_supplier_nation#7824 AS cfpk_supplier_nation_3#7837, cval_supplier_s_name#7825 AS cval_supplier_s_name_3#7838, cval_supplier_s_address#7826 AS cval_supplier_s_address_3#7839, cval_supplier_s_phone#7827 AS cval_supplier_s_phone_3#7840, cval_supplier_s_acctbal#7828 AS cval_supplier_s_acctbal_3#7841, cval_supplier_s_comment#7829 AS cval_supplier_s_comment_3#7842, cs_name#7830 AS cs_name_3#7843, cs_address#7831 AS cs_address_3#7844, cs_phone#7832 AS cs_phone_3#7845, cs_acctbal#7833 AS cs_acctbal_3#7846, cs_comment#7834 AS cs_comment_3#7847]
                  +- Relation[rid#7822,cpfk_nation_supplier#7823,cfpk_supplier_nation#7824,cval_supplier_s_name#7825,cval_supplier_s_address#7826,cval_supplier_s_phone#7827,cval_supplier_s_acctbal#7828,cval_supplier_s_comment#7829,cs_name#7830,cs_address#7831,cs_phone#7832,cs_acctbal#7833,cs_comment#7834] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=326
Elapsed time: 635ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/15 17:26:47 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:26:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7944L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:26:47 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 17:26:47 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 17:26:47 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 17:26:47 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 17:26:47 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 17:26:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7944L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#7946 AS rid_0#7961, cpfk_nation_customer#7947 AS cpfk_nation_customer_0#7962, cfpk_customer_nation#7948 AS cfpk_customer_nation_0#7963, cval_customer_c_name#7949 AS cval_customer_c_name_0#7964, cval_customer_c_address#7950 AS cval_customer_c_address_0#7965, cval_customer_c_phone#7951 AS cval_customer_c_phone_0#7966, cval_customer_c_acctbal#7952 AS cval_customer_c_acctbal_0#7967, cval_customer_c_comment#7953 AS cval_customer_c_comment_0#7968, cval_customer_c_mktsegment#7954 AS cval_customer_c_mktsegment_0#7969, cc_name#7955 AS cc_name_0#7970, cc_address#7956 AS cc_address_0#7971, cc_phone#7957 AS cc_phone_0#7972, cc_acctbal#7958 AS cc_acctbal_0#7973, cc_comment#7959 AS cc_comment_0#7974, cc_mktsegment#7960 AS cc_mktsegment_0#7975]
         :  :  :  :  :  +- Relation[rid#7946,cpfk_nation_customer#7947,cfpk_customer_nation#7948,cval_customer_c_name#7949,cval_customer_c_address#7950,cval_customer_c_phone#7951,cval_customer_c_acctbal#7952,cval_customer_c_comment#7953,cval_customer_c_mktsegment#7954,cc_name#7955,cc_address#7956,cc_phone#7957,cc_acctbal#7958,cc_comment#7959,cc_mktsegment#7960] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#7976 AS rid_0#7991, cpfk_nation_customer#7977 AS cpfk_nation_customer_0#7992, cfpk_customer_nation#7978 AS cfpk_customer_nation_0#7993, cval_customer_c_name#7979 AS cval_customer_c_name_0#7994, cval_customer_c_address#7980 AS cval_customer_c_address_0#7995, cval_customer_c_phone#7981 AS cval_customer_c_phone_0#7996, cval_customer_c_acctbal#7982 AS cval_customer_c_acctbal_0#7997, cval_customer_c_comment#7983 AS cval_customer_c_comment_0#7998, cval_customer_c_mktsegment#7984 AS cval_customer_c_mktsegment_0#7999, cc_name#7985 AS cc_name_0#8000, cc_address#7986 AS cc_address_0#8001, cc_phone#7987 AS cc_phone_0#8002, cc_acctbal#7988 AS cc_acctbal_0#8003, cc_comment#7989 AS cc_comment_0#8004, cc_mktsegment#7990 AS cc_mktsegment_0#8005]
         :  :  :  :        +- Relation[rid#7976,cpfk_nation_customer#7977,cfpk_customer_nation#7978,cval_customer_c_name#7979,cval_customer_c_address#7980,cval_customer_c_phone#7981,cval_customer_c_acctbal#7982,cval_customer_c_comment#7983,cval_customer_c_mktsegment#7984,cc_name#7985,cc_address#7986,cc_phone#7987,cc_acctbal#7988,cc_comment#7989,cc_mktsegment#7990] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- Project [rid#8070 AS rid_1#8087, cpfk_customer_orders#8071 AS cpfk_customer_orders_1#8088, cfpk_orders_customer#8072 AS cfpk_orders_customer_1#8089, cval_orders_o_orderstatus#8073 AS cval_orders_o_orderstatus_1#8090, cval_orders_o_totalprice#8074 AS cval_orders_o_totalprice_1#8091, cval_orders_o_orderpriority#8075 AS cval_orders_o_orderpriority_1#8092, cval_orders_o_clerk#8076 AS cval_orders_o_clerk_1#8093, cval_orders_o_shippriority#8077 AS cval_orders_o_shippriority_1#8094, cval_orders_o_comment#8078 AS cval_orders_o_comment_1#8095, cval_orders_o_orderdate#8079 AS cval_orders_o_orderdate_1#8096, co_orderstatus#8080 AS co_orderstatus_1#8097, co_totalprice#8081 AS co_totalprice_1#8098, co_orderpriority#8082 AS co_orderpriority_1#8099, co_clerk#8083 AS co_clerk_1#8100, co_shippriority#8084 AS co_shippriority_1#8101, co_comment#8085 AS co_comment_1#8102, co_orderdate#8086 AS co_orderdate_1#8103]
         :  :  :     +- Relation[rid#8070,cpfk_customer_orders#8071,cfpk_orders_customer#8072,cval_orders_o_orderstatus#8073,cval_orders_o_totalprice#8074,cval_orders_o_orderpriority#8075,cval_orders_o_clerk#8076,cval_orders_o_shippriority#8077,cval_orders_o_comment#8078,cval_orders_o_orderdate#8079,co_orderstatus#8080,co_totalprice#8081,co_orderpriority#8082,co_clerk#8083,co_shippriority#8084,co_comment#8085,co_orderdate#8086] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#8006 AS rid_1#8023, cpfk_customer_orders#8007 AS cpfk_customer_orders_1#8024, cfpk_orders_customer#8008 AS cfpk_orders_customer_1#8025, cval_orders_o_orderstatus#8009 AS cval_orders_o_orderstatus_1#8026, cval_orders_o_totalprice#8010 AS cval_orders_o_totalprice_1#8027, cval_orders_o_orderpriority#8011 AS cval_orders_o_orderpriority_1#8028, cval_orders_o_clerk#8012 AS cval_orders_o_clerk_1#8029, cval_orders_o_shippriority#8013 AS cval_orders_o_shippriority_1#8030, cval_orders_o_comment#8014 AS cval_orders_o_comment_1#8031, cval_orders_o_orderdate#8015 AS cval_orders_o_orderdate_1#8032, co_orderstatus#8016 AS co_orderstatus_1#8033, co_totalprice#8017 AS co_totalprice_1#8034, co_orderpriority#8018 AS co_orderpriority_1#8035, co_clerk#8019 AS co_clerk_1#8036, co_shippriority#8020 AS co_shippriority_1#8037, co_comment#8021 AS co_comment_1#8038, co_orderdate#8022 AS co_orderdate_1#8039]
         :  :     +- Relation[rid#8006,cpfk_customer_orders#8007,cfpk_orders_customer#8008,cval_orders_o_orderstatus#8009,cval_orders_o_totalprice#8010,cval_orders_o_orderpriority#8011,cval_orders_o_clerk#8012,cval_orders_o_shippriority#8013,cval_orders_o_comment#8014,cval_orders_o_orderdate#8015,co_orderstatus#8016,co_totalprice#8017,co_orderpriority#8018,co_clerk#8019,co_shippriority#8020,co_comment#8021,co_orderdate#8022] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#8204 AS rid_2#8237, cpfk_orders_lineitem#8205 AS cpfk_orders_lineitem_2#8238, cpfk_supplier_lineitem#8206 AS cpfk_supplier_lineitem_2#8239, cfpk_lineitem_supplier#8207 AS cfpk_lineitem_supplier_2#8240, cfpk_lineitem_partsupp#8208 AS cfpk_lineitem_partsupp_2#8241, cpfk_part_lineitem#8209 AS cpfk_part_lineitem_2#8242, cfpk_lineitem_part#8210 AS cfpk_lineitem_part_2#8243, cpfk_partsupp_lineitem#8211 AS cpfk_partsupp_lineitem_2#8244, cfpk_lineitem_orders#8212 AS cfpk_lineitem_orders_2#8245, cval_lineitem_l_quantity#8213 AS cval_lineitem_l_quantity_2#8246, cval_lineitem_l_extendedprice#8214 AS cval_lineitem_l_extendedprice_2#8247, cval_lineitem_l_discount#8215 AS cval_lineitem_l_discount_2#8248, cval_lineitem_l_tax#8216 AS cval_lineitem_l_tax_2#8249, cval_lineitem_l_returnflag#8217 AS cval_lineitem_l_returnflag_2#8250, cval_lineitem_l_linestatus#8218 AS cval_lineitem_l_linestatus_2#8251, cval_lineitem_l_commitdate#8219 AS cval_lineitem_l_commitdate_2#8252, cval_lineitem_l_receiptdate#8220 AS cval_lineitem_l_receiptdate_2#8253, cval_lineitem_l_shipinstruct#8221 AS cval_lineitem_l_shipinstruct_2#8254, cval_lineitem_l_shipmode#8222 AS cval_lineitem_l_shipmode_2#8255, cval_lineitem_l_comment#8223 AS cval_lineitem_l_comment_2#8256, cval_lineitem_l_shipdate#8224 AS cval_lineitem_l_shipdate_2#8257, cl_quantity#8225 AS cl_quantity_2#8258, cl_extendedprice#8226 AS cl_extendedprice_2#8259, cl_discount#8227 AS cl_discount_2#8260, ... 9 more fields]
         :     +- Relation[rid#8204,cpfk_orders_lineitem#8205,cpfk_supplier_lineitem#8206,cfpk_lineitem_supplier#8207,cfpk_lineitem_partsupp#8208,cpfk_part_lineitem#8209,cfpk_lineitem_part#8210,cpfk_partsupp_lineitem#8211,cfpk_lineitem_orders#8212,cval_lineitem_l_quantity#8213,cval_lineitem_l_extendedprice#8214,cval_lineitem_l_discount#8215,cval_lineitem_l_tax#8216,cval_lineitem_l_returnflag#8217,cval_lineitem_l_linestatus#8218,cval_lineitem_l_commitdate#8219,cval_lineitem_l_receiptdate#8220,cval_lineitem_l_shipinstruct#8221,cval_lineitem_l_shipmode#8222,cval_lineitem_l_comment#8223,cval_lineitem_l_shipdate#8224,cl_quantity#8225,cl_extendedprice#8226,cl_discount#8227,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8104 AS rid_2#8137, cpfk_orders_lineitem#8105 AS cpfk_orders_lineitem_2#8138, cpfk_supplier_lineitem#8106 AS cpfk_supplier_lineitem_2#8139, cfpk_lineitem_supplier#8107 AS cfpk_lineitem_supplier_2#8140, cfpk_lineitem_partsupp#8108 AS cfpk_lineitem_partsupp_2#8141, cpfk_part_lineitem#8109 AS cpfk_part_lineitem_2#8142, cfpk_lineitem_part#8110 AS cfpk_lineitem_part_2#8143, cpfk_partsupp_lineitem#8111 AS cpfk_partsupp_lineitem_2#8144, cfpk_lineitem_orders#8112 AS cfpk_lineitem_orders_2#8145, cval_lineitem_l_quantity#8113 AS cval_lineitem_l_quantity_2#8146, cval_lineitem_l_extendedprice#8114 AS cval_lineitem_l_extendedprice_2#8147, cval_lineitem_l_discount#8115 AS cval_lineitem_l_discount_2#8148, cval_lineitem_l_tax#8116 AS cval_lineitem_l_tax_2#8149, cval_lineitem_l_returnflag#8117 AS cval_lineitem_l_returnflag_2#8150, cval_lineitem_l_linestatus#8118 AS cval_lineitem_l_linestatus_2#8151, cval_lineitem_l_commitdate#8119 AS cval_lineitem_l_commitdate_2#8152, cval_lineitem_l_receiptdate#8120 AS cval_lineitem_l_receiptdate_2#8153, cval_lineitem_l_shipinstruct#8121 AS cval_lineitem_l_shipinstruct_2#8154, cval_lineitem_l_shipmode#8122 AS cval_lineitem_l_shipmode_2#8155, cval_lineitem_l_comment#8123 AS cval_lineitem_l_comment_2#8156, cval_lineitem_l_shipdate#8124 AS cval_lineitem_l_shipdate_2#8157, cl_quantity#8125 AS cl_quantity_2#8158, cl_extendedprice#8126 AS cl_extendedprice_2#8159, cl_discount#8127 AS cl_discount_2#8160, ... 9 more fields]
            +- Relation[rid#8104,cpfk_orders_lineitem#8105,cpfk_supplier_lineitem#8106,cfpk_lineitem_supplier#8107,cfpk_lineitem_partsupp#8108,cpfk_part_lineitem#8109,cfpk_lineitem_part#8110,cpfk_partsupp_lineitem#8111,cfpk_lineitem_orders#8112,cval_lineitem_l_quantity#8113,cval_lineitem_l_extendedprice#8114,cval_lineitem_l_discount#8115,cval_lineitem_l_tax#8116,cval_lineitem_l_returnflag#8117,cval_lineitem_l_linestatus#8118,cval_lineitem_l_commitdate#8119,cval_lineitem_l_receiptdate#8120,cval_lineitem_l_shipinstruct#8121,cval_lineitem_l_shipmode#8122,cval_lineitem_l_comment#8123,cval_lineitem_l_shipdate#8124,cl_quantity#8125,cl_extendedprice#8126,cl_discount#8127,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=75006
Elapsed time: 6371ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/15 17:26:53 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:26:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8342L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:26:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:26:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:26:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:26:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8342L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#8344 AS rid_0#8357, cpfk_nation_supplier#8345 AS cpfk_nation_supplier_0#8358, cfpk_supplier_nation#8346 AS cfpk_supplier_nation_0#8359, cval_supplier_s_name#8347 AS cval_supplier_s_name_0#8360, cval_supplier_s_address#8348 AS cval_supplier_s_address_0#8361, cval_supplier_s_phone#8349 AS cval_supplier_s_phone_0#8362, cval_supplier_s_acctbal#8350 AS cval_supplier_s_acctbal_0#8363, cval_supplier_s_comment#8351 AS cval_supplier_s_comment_0#8364, cs_name#8352 AS cs_name_0#8365, cs_address#8353 AS cs_address_0#8366, cs_phone#8354 AS cs_phone_0#8367, cs_acctbal#8355 AS cs_acctbal_0#8368, cs_comment#8356 AS cs_comment_0#8369]
         :  :  +- Relation[rid#8344,cpfk_nation_supplier#8345,cfpk_supplier_nation#8346,cval_supplier_s_name#8347,cval_supplier_s_address#8348,cval_supplier_s_phone#8349,cval_supplier_s_acctbal#8350,cval_supplier_s_comment#8351,cs_name#8352,cs_address#8353,cs_phone#8354,cs_acctbal#8355,cs_comment#8356] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#8436 AS rid_0#8449, cpfk_nation_supplier#8437 AS cpfk_nation_supplier_0#8450, cfpk_supplier_nation#8438 AS cfpk_supplier_nation_0#8451, cval_supplier_s_name#8439 AS cval_supplier_s_name_0#8452, cval_supplier_s_address#8440 AS cval_supplier_s_address_0#8453, cval_supplier_s_phone#8441 AS cval_supplier_s_phone_0#8454, cval_supplier_s_acctbal#8442 AS cval_supplier_s_acctbal_0#8455, cval_supplier_s_comment#8443 AS cval_supplier_s_comment_0#8456, cs_name#8444 AS cs_name_0#8457, cs_address#8445 AS cs_address_0#8458, cs_phone#8446 AS cs_phone_0#8459, cs_acctbal#8447 AS cs_acctbal_0#8460, cs_comment#8448 AS cs_comment_0#8461]
         :     :  +- Relation[rid#8436,cpfk_nation_supplier#8437,cfpk_supplier_nation#8438,cval_supplier_s_name#8439,cval_supplier_s_address#8440,cval_supplier_s_phone#8441,cval_supplier_s_acctbal#8442,cval_supplier_s_comment#8443,cs_name#8444,cs_address#8445,cs_phone#8446,cs_acctbal#8447,cs_comment#8448] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#8462 AS rid_1#8495, cpfk_orders_lineitem#8463 AS cpfk_orders_lineitem_1#8496, cpfk_supplier_lineitem#8464 AS cpfk_supplier_lineitem_1#8497, cfpk_lineitem_supplier#8465 AS cfpk_lineitem_supplier_1#8498, cfpk_lineitem_partsupp#8466 AS cfpk_lineitem_partsupp_1#8499, cpfk_part_lineitem#8467 AS cpfk_part_lineitem_1#8500, cfpk_lineitem_part#8468 AS cfpk_lineitem_part_1#8501, cpfk_partsupp_lineitem#8469 AS cpfk_partsupp_lineitem_1#8502, cfpk_lineitem_orders#8470 AS cfpk_lineitem_orders_1#8503, cval_lineitem_l_quantity#8471 AS cval_lineitem_l_quantity_1#8504, cval_lineitem_l_extendedprice#8472 AS cval_lineitem_l_extendedprice_1#8505, cval_lineitem_l_discount#8473 AS cval_lineitem_l_discount_1#8506, cval_lineitem_l_tax#8474 AS cval_lineitem_l_tax_1#8507, cval_lineitem_l_returnflag#8475 AS cval_lineitem_l_returnflag_1#8508, cval_lineitem_l_linestatus#8476 AS cval_lineitem_l_linestatus_1#8509, cval_lineitem_l_commitdate#8477 AS cval_lineitem_l_commitdate_1#8510, cval_lineitem_l_receiptdate#8478 AS cval_lineitem_l_receiptdate_1#8511, cval_lineitem_l_shipinstruct#8479 AS cval_lineitem_l_shipinstruct_1#8512, cval_lineitem_l_shipmode#8480 AS cval_lineitem_l_shipmode_1#8513, cval_lineitem_l_comment#8481 AS cval_lineitem_l_comment_1#8514, cval_lineitem_l_shipdate#8482 AS cval_lineitem_l_shipdate_1#8515, cl_quantity#8483 AS cl_quantity_1#8516, cl_extendedprice#8484 AS cl_extendedprice_1#8517, cl_discount#8485 AS cl_discount_1#8518, ... 9 more fields]
         :        +- Relation[rid#8462,cpfk_orders_lineitem#8463,cpfk_supplier_lineitem#8464,cfpk_lineitem_supplier#8465,cfpk_lineitem_partsupp#8466,cpfk_part_lineitem#8467,cfpk_lineitem_part#8468,cpfk_partsupp_lineitem#8469,cfpk_lineitem_orders#8470,cval_lineitem_l_quantity#8471,cval_lineitem_l_extendedprice#8472,cval_lineitem_l_discount#8473,cval_lineitem_l_tax#8474,cval_lineitem_l_returnflag#8475,cval_lineitem_l_linestatus#8476,cval_lineitem_l_commitdate#8477,cval_lineitem_l_receiptdate#8478,cval_lineitem_l_shipinstruct#8479,cval_lineitem_l_shipmode#8480,cval_lineitem_l_comment#8481,cval_lineitem_l_shipdate#8482,cl_quantity#8483,cl_extendedprice#8484,cl_discount#8485,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8370 AS rid_1#8403, cpfk_orders_lineitem#8371 AS cpfk_orders_lineitem_1#8404, cpfk_supplier_lineitem#8372 AS cpfk_supplier_lineitem_1#8405, cfpk_lineitem_supplier#8373 AS cfpk_lineitem_supplier_1#8406, cfpk_lineitem_partsupp#8374 AS cfpk_lineitem_partsupp_1#8407, cpfk_part_lineitem#8375 AS cpfk_part_lineitem_1#8408, cfpk_lineitem_part#8376 AS cfpk_lineitem_part_1#8409, cpfk_partsupp_lineitem#8377 AS cpfk_partsupp_lineitem_1#8410, cfpk_lineitem_orders#8378 AS cfpk_lineitem_orders_1#8411, cval_lineitem_l_quantity#8379 AS cval_lineitem_l_quantity_1#8412, cval_lineitem_l_extendedprice#8380 AS cval_lineitem_l_extendedprice_1#8413, cval_lineitem_l_discount#8381 AS cval_lineitem_l_discount_1#8414, cval_lineitem_l_tax#8382 AS cval_lineitem_l_tax_1#8415, cval_lineitem_l_returnflag#8383 AS cval_lineitem_l_returnflag_1#8416, cval_lineitem_l_linestatus#8384 AS cval_lineitem_l_linestatus_1#8417, cval_lineitem_l_commitdate#8385 AS cval_lineitem_l_commitdate_1#8418, cval_lineitem_l_receiptdate#8386 AS cval_lineitem_l_receiptdate_1#8419, cval_lineitem_l_shipinstruct#8387 AS cval_lineitem_l_shipinstruct_1#8420, cval_lineitem_l_shipmode#8388 AS cval_lineitem_l_shipmode_1#8421, cval_lineitem_l_comment#8389 AS cval_lineitem_l_comment_1#8422, cval_lineitem_l_shipdate#8390 AS cval_lineitem_l_shipdate_1#8423, cl_quantity#8391 AS cl_quantity_1#8424, cl_extendedprice#8392 AS cl_extendedprice_1#8425, cl_discount#8393 AS cl_discount_1#8426, ... 9 more fields]
            +- Relation[rid#8370,cpfk_orders_lineitem#8371,cpfk_supplier_lineitem#8372,cfpk_lineitem_supplier#8373,cfpk_lineitem_partsupp#8374,cpfk_part_lineitem#8375,cfpk_lineitem_part#8376,cpfk_partsupp_lineitem#8377,cfpk_lineitem_orders#8378,cval_lineitem_l_quantity#8379,cval_lineitem_l_extendedprice#8380,cval_lineitem_l_discount#8381,cval_lineitem_l_tax#8382,cval_lineitem_l_returnflag#8383,cval_lineitem_l_linestatus#8384,cval_lineitem_l_commitdate#8385,cval_lineitem_l_receiptdate#8386,cval_lineitem_l_shipinstruct#8387,cval_lineitem_l_shipmode#8388,cval_lineitem_l_comment#8389,cval_lineitem_l_shipdate#8390,cl_quantity#8391,cl_extendedprice#8392,cl_discount#8393,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 88119ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/15 17:28:22 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:28:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8578L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 17:28:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8578L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#8580 AS rid_0#8613, cpfk_orders_lineitem#8581 AS cpfk_orders_lineitem_0#8614, cpfk_supplier_lineitem#8582 AS cpfk_supplier_lineitem_0#8615, cfpk_lineitem_supplier#8583 AS cfpk_lineitem_supplier_0#8616, cfpk_lineitem_partsupp#8584 AS cfpk_lineitem_partsupp_0#8617, cpfk_part_lineitem#8585 AS cpfk_part_lineitem_0#8618, cfpk_lineitem_part#8586 AS cfpk_lineitem_part_0#8619, cpfk_partsupp_lineitem#8587 AS cpfk_partsupp_lineitem_0#8620, cfpk_lineitem_orders#8588 AS cfpk_lineitem_orders_0#8621, cval_lineitem_l_quantity#8589 AS cval_lineitem_l_quantity_0#8622, cval_lineitem_l_extendedprice#8590 AS cval_lineitem_l_extendedprice_0#8623, cval_lineitem_l_discount#8591 AS cval_lineitem_l_discount_0#8624, cval_lineitem_l_tax#8592 AS cval_lineitem_l_tax_0#8625, cval_lineitem_l_returnflag#8593 AS cval_lineitem_l_returnflag_0#8626, cval_lineitem_l_linestatus#8594 AS cval_lineitem_l_linestatus_0#8627, cval_lineitem_l_commitdate#8595 AS cval_lineitem_l_commitdate_0#8628, cval_lineitem_l_receiptdate#8596 AS cval_lineitem_l_receiptdate_0#8629, cval_lineitem_l_shipinstruct#8597 AS cval_lineitem_l_shipinstruct_0#8630, cval_lineitem_l_shipmode#8598 AS cval_lineitem_l_shipmode_0#8631, cval_lineitem_l_comment#8599 AS cval_lineitem_l_comment_0#8632, cval_lineitem_l_shipdate#8600 AS cval_lineitem_l_shipdate_0#8633, cl_quantity#8601 AS cl_quantity_0#8634, cl_extendedprice#8602 AS cl_extendedprice_0#8635, cl_discount#8603 AS cl_discount_0#8636, ... 9 more fields]
            :  :  +- Relation[rid#8580,cpfk_orders_lineitem#8581,cpfk_supplier_lineitem#8582,cfpk_lineitem_supplier#8583,cfpk_lineitem_partsupp#8584,cpfk_part_lineitem#8585,cfpk_lineitem_part#8586,cpfk_partsupp_lineitem#8587,cfpk_lineitem_orders#8588,cval_lineitem_l_quantity#8589,cval_lineitem_l_extendedprice#8590,cval_lineitem_l_discount#8591,cval_lineitem_l_tax#8592,cval_lineitem_l_returnflag#8593,cval_lineitem_l_linestatus#8594,cval_lineitem_l_commitdate#8595,cval_lineitem_l_receiptdate#8596,cval_lineitem_l_shipinstruct#8597,cval_lineitem_l_shipmode#8598,cval_lineitem_l_comment#8599,cval_lineitem_l_shipdate#8600,cl_quantity#8601,cl_extendedprice#8602,cl_discount#8603,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#8646 AS rid_0#8679, cpfk_orders_lineitem#8647 AS cpfk_orders_lineitem_0#8680, cpfk_supplier_lineitem#8648 AS cpfk_supplier_lineitem_0#8681, cfpk_lineitem_supplier#8649 AS cfpk_lineitem_supplier_0#8682, cfpk_lineitem_partsupp#8650 AS cfpk_lineitem_partsupp_0#8683, cpfk_part_lineitem#8651 AS cpfk_part_lineitem_0#8684, cfpk_lineitem_part#8652 AS cfpk_lineitem_part_0#8685, cpfk_partsupp_lineitem#8653 AS cpfk_partsupp_lineitem_0#8686, cfpk_lineitem_orders#8654 AS cfpk_lineitem_orders_0#8687, cval_lineitem_l_quantity#8655 AS cval_lineitem_l_quantity_0#8688, cval_lineitem_l_extendedprice#8656 AS cval_lineitem_l_extendedprice_0#8689, cval_lineitem_l_discount#8657 AS cval_lineitem_l_discount_0#8690, cval_lineitem_l_tax#8658 AS cval_lineitem_l_tax_0#8691, cval_lineitem_l_returnflag#8659 AS cval_lineitem_l_returnflag_0#8692, cval_lineitem_l_linestatus#8660 AS cval_lineitem_l_linestatus_0#8693, cval_lineitem_l_commitdate#8661 AS cval_lineitem_l_commitdate_0#8694, cval_lineitem_l_receiptdate#8662 AS cval_lineitem_l_receiptdate_0#8695, cval_lineitem_l_shipinstruct#8663 AS cval_lineitem_l_shipinstruct_0#8696, cval_lineitem_l_shipmode#8664 AS cval_lineitem_l_shipmode_0#8697, cval_lineitem_l_comment#8665 AS cval_lineitem_l_comment_0#8698, cval_lineitem_l_shipdate#8666 AS cval_lineitem_l_shipdate_0#8699, cl_quantity#8667 AS cl_quantity_0#8700, cl_extendedprice#8668 AS cl_extendedprice_0#8701, cl_discount#8669 AS cl_discount_0#8702, ... 9 more fields]
            :        +- Relation[rid#8646,cpfk_orders_lineitem#8647,cpfk_supplier_lineitem#8648,cfpk_lineitem_supplier#8649,cfpk_lineitem_partsupp#8650,cpfk_part_lineitem#8651,cfpk_lineitem_part#8652,cpfk_partsupp_lineitem#8653,cfpk_lineitem_orders#8654,cval_lineitem_l_quantity#8655,cval_lineitem_l_extendedprice#8656,cval_lineitem_l_discount#8657,cval_lineitem_l_tax#8658,cval_lineitem_l_returnflag#8659,cval_lineitem_l_linestatus#8660,cval_lineitem_l_commitdate#8661,cval_lineitem_l_receiptdate#8662,cval_lineitem_l_shipinstruct#8663,cval_lineitem_l_shipmode#8664,cval_lineitem_l_comment#8665,cval_lineitem_l_shipdate#8666,cl_quantity#8667,cl_extendedprice#8668,cl_discount#8669,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#8712 AS rid_1#8729, cpfk_customer_orders#8713 AS cpfk_customer_orders_1#8730, cfpk_orders_customer#8714 AS cfpk_orders_customer_1#8731, cval_orders_o_orderstatus#8715 AS cval_orders_o_orderstatus_1#8732, cval_orders_o_totalprice#8716 AS cval_orders_o_totalprice_1#8733, cval_orders_o_orderpriority#8717 AS cval_orders_o_orderpriority_1#8734, cval_orders_o_clerk#8718 AS cval_orders_o_clerk_1#8735, cval_orders_o_shippriority#8719 AS cval_orders_o_shippriority_1#8736, cval_orders_o_comment#8720 AS cval_orders_o_comment_1#8737, cval_orders_o_orderdate#8721 AS cval_orders_o_orderdate_1#8738, co_orderstatus#8722 AS co_orderstatus_1#8739, co_totalprice#8723 AS co_totalprice_1#8740, co_orderpriority#8724 AS co_orderpriority_1#8741, co_clerk#8725 AS co_clerk_1#8742, co_shippriority#8726 AS co_shippriority_1#8743, co_comment#8727 AS co_comment_1#8744, co_orderdate#8728 AS co_orderdate_1#8745]
               +- Relation[rid#8712,cpfk_customer_orders#8713,cfpk_orders_customer#8714,cval_orders_o_orderstatus#8715,cval_orders_o_totalprice#8716,cval_orders_o_orderpriority#8717,cval_orders_o_clerk#8718,cval_orders_o_shippriority#8719,cval_orders_o_comment#8720,cval_orders_o_orderdate#8721,co_orderstatus#8722,co_totalprice#8723,co_orderpriority#8724,co_clerk#8725,co_shippriority#8726,co_comment#8727,co_orderdate#8728] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 23460ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 17:28:45 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:28:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8805L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 17:28:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:28:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:28:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:28:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:28:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:28:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:28:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:28:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:28:45 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:28:45 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:28:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8805L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#8807 AS rid_0#8814, cpfk_region_nation#8808 AS cpfk_region_nation_0#8815, cfpk_nation_region#8809 AS cfpk_nation_region_0#8816, cval_nation_n_name#8810 AS cval_nation_n_name_0#8817, cval_nation_n_comment#8811 AS cval_nation_n_comment_0#8818, cn_name#8812 AS cn_name_0#8819, cn_comment#8813 AS cn_comment_0#8820]
            :     :     :  :  :  :  :  +- Relation[rid#8807,cpfk_region_nation#8808,cfpk_nation_region#8809,cval_nation_n_name#8810,cval_nation_n_comment#8811,cn_name#8812,cn_comment#8813] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#8847 AS rid_0#8854, cpfk_region_nation#8848 AS cpfk_region_nation_0#8855, cfpk_nation_region#8849 AS cfpk_nation_region_0#8856, cval_nation_n_name#8850 AS cval_nation_n_name_0#8857, cval_nation_n_comment#8851 AS cval_nation_n_comment_0#8858, cn_name#8852 AS cn_name_0#8859, cn_comment#8853 AS cn_comment_0#8860]
            :     :     :  :  :  :     :  +- Relation[rid#8847,cpfk_region_nation#8848,cfpk_nation_region#8849,cval_nation_n_name#8850,cval_nation_n_comment#8851,cn_name#8852,cn_comment#8853] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#8861 AS rid_1#8874, cpfk_nation_supplier#8862 AS cpfk_nation_supplier_1#8875, cfpk_supplier_nation#8863 AS cfpk_supplier_nation_1#8876, cval_supplier_s_name#8864 AS cval_supplier_s_name_1#8877, cval_supplier_s_address#8865 AS cval_supplier_s_address_1#8878, cval_supplier_s_phone#8866 AS cval_supplier_s_phone_1#8879, cval_supplier_s_acctbal#8867 AS cval_supplier_s_acctbal_1#8880, cval_supplier_s_comment#8868 AS cval_supplier_s_comment_1#8881, cs_name#8869 AS cs_name_1#8882, cs_address#8870 AS cs_address_1#8883, cs_phone#8871 AS cs_phone_1#8884, cs_acctbal#8872 AS cs_acctbal_1#8885, cs_comment#8873 AS cs_comment_1#8886]
            :     :     :  :  :  :        +- Relation[rid#8861,cpfk_nation_supplier#8862,cfpk_supplier_nation#8863,cval_supplier_s_name#8864,cval_supplier_s_address#8865,cval_supplier_s_phone#8866,cval_supplier_s_acctbal#8867,cval_supplier_s_comment#8868,cs_name#8869,cs_address#8870,cs_phone#8871,cs_acctbal#8872,cs_comment#8873] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#8821 AS rid_1#8834, cpfk_nation_supplier#8822 AS cpfk_nation_supplier_1#8835, cfpk_supplier_nation#8823 AS cfpk_supplier_nation_1#8836, cval_supplier_s_name#8824 AS cval_supplier_s_name_1#8837, cval_supplier_s_address#8825 AS cval_supplier_s_address_1#8838, cval_supplier_s_phone#8826 AS cval_supplier_s_phone_1#8839, cval_supplier_s_acctbal#8827 AS cval_supplier_s_acctbal_1#8840, cval_supplier_s_comment#8828 AS cval_supplier_s_comment_1#8841, cs_name#8829 AS cs_name_1#8842, cs_address#8830 AS cs_address_1#8843, cs_phone#8831 AS cs_phone_1#8844, cs_acctbal#8832 AS cs_acctbal_1#8845, cs_comment#8833 AS cs_comment_1#8846]
            :     :     :  :  :     +- Relation[rid#8821,cpfk_nation_supplier#8822,cfpk_supplier_nation#8823,cval_supplier_s_name#8824,cval_supplier_s_address#8825,cval_supplier_s_phone#8826,cval_supplier_s_acctbal#8827,cval_supplier_s_comment#8828,cs_name#8829,cs_address#8830,cs_phone#8831,cs_acctbal#8832,cs_comment#8833] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#8953 AS rid_1#8966, cpfk_nation_supplier#8954 AS cpfk_nation_supplier_1#8967, cfpk_supplier_nation#8955 AS cfpk_supplier_nation_1#8968, cval_supplier_s_name#8956 AS cval_supplier_s_name_1#8969, cval_supplier_s_address#8957 AS cval_supplier_s_address_1#8970, cval_supplier_s_phone#8958 AS cval_supplier_s_phone_1#8971, cval_supplier_s_acctbal#8959 AS cval_supplier_s_acctbal_1#8972, cval_supplier_s_comment#8960 AS cval_supplier_s_comment_1#8973, cs_name#8961 AS cs_name_1#8974, cs_address#8962 AS cs_address_1#8975, cs_phone#8963 AS cs_phone_1#8976, cs_acctbal#8964 AS cs_acctbal_1#8977, cs_comment#8965 AS cs_comment_1#8978]
            :     :     :  :     :  +- Relation[rid#8953,cpfk_nation_supplier#8954,cfpk_supplier_nation#8955,cval_supplier_s_name#8956,cval_supplier_s_address#8957,cval_supplier_s_phone#8958,cval_supplier_s_acctbal#8959,cval_supplier_s_comment#8960,cs_name#8961,cs_address#8962,cs_phone#8963,cs_acctbal#8964,cs_comment#8965] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#8979 AS rid_2#9012, cpfk_orders_lineitem#8980 AS cpfk_orders_lineitem_2#9013, cpfk_supplier_lineitem#8981 AS cpfk_supplier_lineitem_2#9014, cfpk_lineitem_supplier#8982 AS cfpk_lineitem_supplier_2#9015, cfpk_lineitem_partsupp#8983 AS cfpk_lineitem_partsupp_2#9016, cpfk_part_lineitem#8984 AS cpfk_part_lineitem_2#9017, cfpk_lineitem_part#8985 AS cfpk_lineitem_part_2#9018, cpfk_partsupp_lineitem#8986 AS cpfk_partsupp_lineitem_2#9019, cfpk_lineitem_orders#8987 AS cfpk_lineitem_orders_2#9020, cval_lineitem_l_quantity#8988 AS cval_lineitem_l_quantity_2#9021, cval_lineitem_l_extendedprice#8989 AS cval_lineitem_l_extendedprice_2#9022, cval_lineitem_l_discount#8990 AS cval_lineitem_l_discount_2#9023, cval_lineitem_l_tax#8991 AS cval_lineitem_l_tax_2#9024, cval_lineitem_l_returnflag#8992 AS cval_lineitem_l_returnflag_2#9025, cval_lineitem_l_linestatus#8993 AS cval_lineitem_l_linestatus_2#9026, cval_lineitem_l_commitdate#8994 AS cval_lineitem_l_commitdate_2#9027, cval_lineitem_l_receiptdate#8995 AS cval_lineitem_l_receiptdate_2#9028, cval_lineitem_l_shipinstruct#8996 AS cval_lineitem_l_shipinstruct_2#9029, cval_lineitem_l_shipmode#8997 AS cval_lineitem_l_shipmode_2#9030, cval_lineitem_l_comment#8998 AS cval_lineitem_l_comment_2#9031, cval_lineitem_l_shipdate#8999 AS cval_lineitem_l_shipdate_2#9032, cl_quantity#9000 AS cl_quantity_2#9033, cl_extendedprice#9001 AS cl_extendedprice_2#9034, cl_discount#9002 AS cl_discount_2#9035, ... 9 more fields]
            :     :     :  :        +- Relation[rid#8979,cpfk_orders_lineitem#8980,cpfk_supplier_lineitem#8981,cfpk_lineitem_supplier#8982,cfpk_lineitem_partsupp#8983,cpfk_part_lineitem#8984,cfpk_lineitem_part#8985,cpfk_partsupp_lineitem#8986,cfpk_lineitem_orders#8987,cval_lineitem_l_quantity#8988,cval_lineitem_l_extendedprice#8989,cval_lineitem_l_discount#8990,cval_lineitem_l_tax#8991,cval_lineitem_l_returnflag#8992,cval_lineitem_l_linestatus#8993,cval_lineitem_l_commitdate#8994,cval_lineitem_l_receiptdate#8995,cval_lineitem_l_shipinstruct#8996,cval_lineitem_l_shipmode#8997,cval_lineitem_l_comment#8998,cval_lineitem_l_shipdate#8999,cl_quantity#9000,cl_extendedprice#9001,cl_discount#9002,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#8887 AS rid_2#8920, cpfk_orders_lineitem#8888 AS cpfk_orders_lineitem_2#8921, cpfk_supplier_lineitem#8889 AS cpfk_supplier_lineitem_2#8922, cfpk_lineitem_supplier#8890 AS cfpk_lineitem_supplier_2#8923, cfpk_lineitem_partsupp#8891 AS cfpk_lineitem_partsupp_2#8924, cpfk_part_lineitem#8892 AS cpfk_part_lineitem_2#8925, cfpk_lineitem_part#8893 AS cfpk_lineitem_part_2#8926, cpfk_partsupp_lineitem#8894 AS cpfk_partsupp_lineitem_2#8927, cfpk_lineitem_orders#8895 AS cfpk_lineitem_orders_2#8928, cval_lineitem_l_quantity#8896 AS cval_lineitem_l_quantity_2#8929, cval_lineitem_l_extendedprice#8897 AS cval_lineitem_l_extendedprice_2#8930, cval_lineitem_l_discount#8898 AS cval_lineitem_l_discount_2#8931, cval_lineitem_l_tax#8899 AS cval_lineitem_l_tax_2#8932, cval_lineitem_l_returnflag#8900 AS cval_lineitem_l_returnflag_2#8933, cval_lineitem_l_linestatus#8901 AS cval_lineitem_l_linestatus_2#8934, cval_lineitem_l_commitdate#8902 AS cval_lineitem_l_commitdate_2#8935, cval_lineitem_l_receiptdate#8903 AS cval_lineitem_l_receiptdate_2#8936, cval_lineitem_l_shipinstruct#8904 AS cval_lineitem_l_shipinstruct_2#8937, cval_lineitem_l_shipmode#8905 AS cval_lineitem_l_shipmode_2#8938, cval_lineitem_l_comment#8906 AS cval_lineitem_l_comment_2#8939, cval_lineitem_l_shipdate#8907 AS cval_lineitem_l_shipdate_2#8940, cl_quantity#8908 AS cl_quantity_2#8941, cl_extendedprice#8909 AS cl_extendedprice_2#8942, cl_discount#8910 AS cl_discount_2#8943, ... 9 more fields]
            :     :     :     +- Relation[rid#8887,cpfk_orders_lineitem#8888,cpfk_supplier_lineitem#8889,cfpk_lineitem_supplier#8890,cfpk_lineitem_partsupp#8891,cpfk_part_lineitem#8892,cfpk_lineitem_part#8893,cpfk_partsupp_lineitem#8894,cfpk_lineitem_orders#8895,cval_lineitem_l_quantity#8896,cval_lineitem_l_extendedprice#8897,cval_lineitem_l_discount#8898,cval_lineitem_l_tax#8899,cval_lineitem_l_returnflag#8900,cval_lineitem_l_linestatus#8901,cval_lineitem_l_commitdate#8902,cval_lineitem_l_receiptdate#8903,cval_lineitem_l_shipinstruct#8904,cval_lineitem_l_shipmode#8905,cval_lineitem_l_comment#8906,cval_lineitem_l_shipdate#8907,cl_quantity#8908,cl_extendedprice#8909,cl_discount#8910,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#9045 AS rid_3#9062, cval_part_p_name#9046 AS cval_part_p_name_3#9063, cval_part_p_mfgr#9047 AS cval_part_p_mfgr_3#9064, cval_part_p_type#9048 AS cval_part_p_type_3#9065, cval_part_p_size#9049 AS cval_part_p_size_3#9066, cval_part_p_container#9050 AS cval_part_p_container_3#9067, cval_part_p_retailprice#9051 AS cval_part_p_retailprice_3#9068, cval_part_p_comment#9052 AS cval_part_p_comment_3#9069, cval_part_p_brand#9053 AS cval_part_p_brand_3#9070, cp_name#9054 AS cp_name_3#9071, cp_mfgr#9055 AS cp_mfgr_3#9072, cp_type#9056 AS cp_type_3#9073, cp_size#9057 AS cp_size_3#9074, cp_container#9058 AS cp_container_3#9075, cp_retailprice#9059 AS cp_retailprice_3#9076, cp_comment#9060 AS cp_comment_3#9077, cp_brand#9061 AS cp_brand_3#9078]
            :     :        +- Relation[rid#9045,cval_part_p_name#9046,cval_part_p_mfgr#9047,cval_part_p_type#9048,cval_part_p_size#9049,cval_part_p_container#9050,cval_part_p_retailprice#9051,cval_part_p_comment#9052,cval_part_p_brand#9053,cp_name#9054,cp_mfgr#9055,cp_type#9056,cp_size#9057,cp_container#9058,cp_retailprice#9059,cp_comment#9060,cp_brand#9061] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#9079 AS rid_4#9090, cpfk_part_partsupp#9080 AS cpfk_part_partsupp_4#9091, cfpk_partsupp_part#9081 AS cfpk_partsupp_part_4#9092, cpfk_supplier_partsupp#9082 AS cpfk_supplier_partsupp_4#9093, cfpk_partsupp_supplier#9083 AS cfpk_partsupp_supplier_4#9094, cval_partsupp_ps_availqty#9084 AS cval_partsupp_ps_availqty_4#9095, cval_partsupp_ps_supplycost#9085 AS cval_partsupp_ps_supplycost_4#9096, cval_partsupp_ps_comment#9086 AS cval_partsupp_ps_comment_4#9097, cps_availqty#9087 AS cps_availqty_4#9098, cps_supplycost#9088 AS cps_supplycost_4#9099, cps_comment#9089 AS cps_comment_4#9100]
            :        +- Relation[rid#9079,cpfk_part_partsupp#9080,cfpk_partsupp_part#9081,cpfk_supplier_partsupp#9082,cfpk_partsupp_supplier#9083,cval_partsupp_ps_availqty#9084,cval_partsupp_ps_supplycost#9085,cval_partsupp_ps_comment#9086,cps_availqty#9087,cps_supplycost#9088,cps_comment#9089] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#9101 AS rid_5#9118, cpfk_customer_orders#9102 AS cpfk_customer_orders_5#9119, cfpk_orders_customer#9103 AS cfpk_orders_customer_5#9120, cval_orders_o_orderstatus#9104 AS cval_orders_o_orderstatus_5#9121, cval_orders_o_totalprice#9105 AS cval_orders_o_totalprice_5#9122, cval_orders_o_orderpriority#9106 AS cval_orders_o_orderpriority_5#9123, cval_orders_o_clerk#9107 AS cval_orders_o_clerk_5#9124, cval_orders_o_shippriority#9108 AS cval_orders_o_shippriority_5#9125, cval_orders_o_comment#9109 AS cval_orders_o_comment_5#9126, cval_orders_o_orderdate#9110 AS cval_orders_o_orderdate_5#9127, co_orderstatus#9111 AS co_orderstatus_5#9128, co_totalprice#9112 AS co_totalprice_5#9129, co_orderpriority#9113 AS co_orderpriority_5#9130, co_clerk#9114 AS co_clerk_5#9131, co_shippriority#9115 AS co_shippriority_5#9132, co_comment#9116 AS co_comment_5#9133, co_orderdate#9117 AS co_orderdate_5#9134]
               +- Relation[rid#9101,cpfk_customer_orders#9102,cfpk_orders_customer#9103,cval_orders_o_orderstatus#9104,cval_orders_o_totalprice#9105,cval_orders_o_orderpriority#9106,cval_orders_o_clerk#9107,cval_orders_o_shippriority#9108,cval_orders_o_comment#9109,cval_orders_o_orderdate#9110,co_orderstatus#9111,co_totalprice#9112,co_orderpriority#9113,co_clerk#9114,co_shippriority#9115,co_comment#9116,co_orderdate#9117] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 266825ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/15 17:33:12 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:33:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9240L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 17:33:12 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:33:12 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:33:12 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:33:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9240L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#9242 AS rid_0#9259, cval_part_p_name#9243 AS cval_part_p_name_0#9260, cval_part_p_mfgr#9244 AS cval_part_p_mfgr_0#9261, cval_part_p_type#9245 AS cval_part_p_type_0#9262, cval_part_p_size#9246 AS cval_part_p_size_0#9263, cval_part_p_container#9247 AS cval_part_p_container_0#9264, cval_part_p_retailprice#9248 AS cval_part_p_retailprice_0#9265, cval_part_p_comment#9249 AS cval_part_p_comment_0#9266, cval_part_p_brand#9250 AS cval_part_p_brand_0#9267, cp_name#9251 AS cp_name_0#9268, cp_mfgr#9252 AS cp_mfgr_0#9269, cp_type#9253 AS cp_type_0#9270, cp_size#9254 AS cp_size_0#9271, cp_container#9255 AS cp_container_0#9272, cp_retailprice#9256 AS cp_retailprice_0#9273, cp_comment#9257 AS cp_comment_0#9274, cp_brand#9258 AS cp_brand_0#9275]
         :  :  :  +- Relation[rid#9242,cval_part_p_name#9243,cval_part_p_mfgr#9244,cval_part_p_type#9245,cval_part_p_size#9246,cval_part_p_container#9247,cval_part_p_retailprice#9248,cval_part_p_comment#9249,cval_part_p_brand#9250,cp_name#9251,cp_mfgr#9252,cp_type#9253,cp_size#9254,cp_container#9255,cp_retailprice#9256,cp_comment#9257,cp_brand#9258] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#9276 AS rid_0#9293, cval_part_p_name#9277 AS cval_part_p_name_0#9294, cval_part_p_mfgr#9278 AS cval_part_p_mfgr_0#9295, cval_part_p_type#9279 AS cval_part_p_type_0#9296, cval_part_p_size#9280 AS cval_part_p_size_0#9297, cval_part_p_container#9281 AS cval_part_p_container_0#9298, cval_part_p_retailprice#9282 AS cval_part_p_retailprice_0#9299, cval_part_p_comment#9283 AS cval_part_p_comment_0#9300, cval_part_p_brand#9284 AS cval_part_p_brand_0#9301, cp_name#9285 AS cp_name_0#9302, cp_mfgr#9286 AS cp_mfgr_0#9303, cp_type#9287 AS cp_type_0#9304, cp_size#9288 AS cp_size_0#9305, cp_container#9289 AS cp_container_0#9306, cp_retailprice#9290 AS cp_retailprice_0#9307, cp_comment#9291 AS cp_comment_0#9308, cp_brand#9292 AS cp_brand_0#9309]
         :  :        +- Relation[rid#9276,cval_part_p_name#9277,cval_part_p_mfgr#9278,cval_part_p_type#9279,cval_part_p_size#9280,cval_part_p_container#9281,cval_part_p_retailprice#9282,cval_part_p_comment#9283,cval_part_p_brand#9284,cp_name#9285,cp_mfgr#9286,cp_type#9287,cp_size#9288,cp_container#9289,cp_retailprice#9290,cp_comment#9291,cp_brand#9292] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#9366 AS rid_1#9377, cpfk_part_partsupp#9367 AS cpfk_part_partsupp_1#9378, cfpk_partsupp_part#9368 AS cfpk_partsupp_part_1#9379, cpfk_supplier_partsupp#9369 AS cpfk_supplier_partsupp_1#9380, cfpk_partsupp_supplier#9370 AS cfpk_partsupp_supplier_1#9381, cval_partsupp_ps_availqty#9371 AS cval_partsupp_ps_availqty_1#9382, cval_partsupp_ps_supplycost#9372 AS cval_partsupp_ps_supplycost_1#9383, cval_partsupp_ps_comment#9373 AS cval_partsupp_ps_comment_1#9384, cps_availqty#9374 AS cps_availqty_1#9385, cps_supplycost#9375 AS cps_supplycost_1#9386, cps_comment#9376 AS cps_comment_1#9387]
         :     +- Relation[rid#9366,cpfk_part_partsupp#9367,cfpk_partsupp_part#9368,cpfk_supplier_partsupp#9369,cfpk_partsupp_supplier#9370,cval_partsupp_ps_availqty#9371,cval_partsupp_ps_supplycost#9372,cval_partsupp_ps_comment#9373,cps_availqty#9374,cps_supplycost#9375,cps_comment#9376] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#9310 AS rid_1#9321, cpfk_part_partsupp#9311 AS cpfk_part_partsupp_1#9322, cfpk_partsupp_part#9312 AS cfpk_partsupp_part_1#9323, cpfk_supplier_partsupp#9313 AS cpfk_supplier_partsupp_1#9324, cfpk_partsupp_supplier#9314 AS cfpk_partsupp_supplier_1#9325, cval_partsupp_ps_availqty#9315 AS cval_partsupp_ps_availqty_1#9326, cval_partsupp_ps_supplycost#9316 AS cval_partsupp_ps_supplycost_1#9327, cval_partsupp_ps_comment#9317 AS cval_partsupp_ps_comment_1#9328, cps_availqty#9318 AS cps_availqty_1#9329, cps_supplycost#9319 AS cps_supplycost_1#9330, cps_comment#9320 AS cps_comment_1#9331]
            +- Relation[rid#9310,cpfk_part_partsupp#9311,cfpk_partsupp_part#9312,cpfk_supplier_partsupp#9313,cfpk_partsupp_supplier#9314,cval_partsupp_ps_availqty#9315,cval_partsupp_ps_supplycost#9316,cval_partsupp_ps_comment#9317,cps_availqty#9318,cps_supplycost#9319,cps_comment#9320] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=7890
Elapsed time: 540ms
query=q1, count=6001215, duration=3241
query=q10, count=1478870, duration=70264
query=q11, count=4, duration=1297
query=q12, count=857401, duration=23460
query=q13, count=1500000, duration=13400
query=q14, count=6001215, duration=95386
query=q15, count=6001215, duration=88119
query=q16, count=7890, duration=540
query=q17, count=408, duration=433
query=q18, count=6001215, duration=132378
query=q19, count=13, duration=62943
query=q2, count=0, duration=1688
query=q20, count=326, duration=635
query=q21a, count=120762, duration=89709
query=q22, count=1500000, duration=13505
query=q3, count=75006, duration=6371
query=q4, count=6001215, duration=57147
query=q5, count=3, duration=21715
query=q6, count=6001215, duration=2754
query=q7, count=0, duration=383
query=q8, count=0, duration=2011
query=q9a, count=6001215, duration=266825
query=q9b, count=6001215, duration=174705
