20/04/15 14:38:25 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 13416ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Apr 15 14:38:29 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Apr 15 14:38:30 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Apr 15 14:38:30 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Apr 15 14:38:30 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Apr 15 14:38:30 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Apr 15 14:38:36 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Apr 15 14:38:40 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Apr 15 14:38:40 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/15 14:38:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:38:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2079L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 14:38:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2079L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#2081 AS rid_0#2098, cpfk_customer_orders#2082 AS cpfk_customer_orders_0#2099, cfpk_orders_customer#2083 AS cfpk_orders_customer_0#2100, cval_orders_o_orderstatus#2084 AS cval_orders_o_orderstatus_0#2101, cval_orders_o_totalprice#2085 AS cval_orders_o_totalprice_0#2102, cval_orders_o_orderpriority#2086 AS cval_orders_o_orderpriority_0#2103, cval_orders_o_clerk#2087 AS cval_orders_o_clerk_0#2104, cval_orders_o_shippriority#2088 AS cval_orders_o_shippriority_0#2105, cval_orders_o_comment#2089 AS cval_orders_o_comment_0#2106, cval_orders_o_orderdate#2090 AS cval_orders_o_orderdate_0#2107, co_orderstatus#2091 AS co_orderstatus_0#2108, co_totalprice#2092 AS co_totalprice_0#2109, co_orderpriority#2093 AS co_orderpriority_0#2110, co_clerk#2094 AS co_clerk_0#2111, co_shippriority#2095 AS co_shippriority_0#2112, co_comment#2096 AS co_comment_0#2113, co_orderdate#2097 AS co_orderdate_0#2114]
            :  +- Relation[rid#2081,cpfk_customer_orders#2082,cfpk_orders_customer#2083,cval_orders_o_orderstatus#2084,cval_orders_o_totalprice#2085,cval_orders_o_orderpriority#2086,cval_orders_o_clerk#2087,cval_orders_o_shippriority#2088,cval_orders_o_comment#2089,cval_orders_o_orderdate#2090,co_orderstatus#2091,co_totalprice#2092,co_orderpriority#2093,co_clerk#2094,co_shippriority#2095,co_comment#2096,co_orderdate#2097] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#2115 AS rid_1#2130, cpfk_nation_customer#2116 AS cpfk_nation_customer_1#2131, cfpk_customer_nation#2117 AS cfpk_customer_nation_1#2132, cval_customer_c_name#2118 AS cval_customer_c_name_1#2133, cval_customer_c_address#2119 AS cval_customer_c_address_1#2134, cval_customer_c_phone#2120 AS cval_customer_c_phone_1#2135, cval_customer_c_acctbal#2121 AS cval_customer_c_acctbal_1#2136, cval_customer_c_comment#2122 AS cval_customer_c_comment_1#2137, cval_customer_c_mktsegment#2123 AS cval_customer_c_mktsegment_1#2138, cc_name#2124 AS cc_name_1#2139, cc_address#2125 AS cc_address_1#2140, cc_phone#2126 AS cc_phone_1#2141, cc_acctbal#2127 AS cc_acctbal_1#2142, cc_comment#2128 AS cc_comment_1#2143, cc_mktsegment#2129 AS cc_mktsegment_1#2144]
               +- Relation[rid#2115,cpfk_nation_customer#2116,cfpk_customer_nation#2117,cval_customer_c_name#2118,cval_customer_c_address#2119,cval_customer_c_phone#2120,cval_customer_c_acctbal#2121,cval_customer_c_comment#2122,cval_customer_c_mktsegment#2123,cc_name#2124,cc_address#2125,cc_phone#2126,cc_acctbal#2127,cc_comment#2128,cc_mktsegment#2129] JDBCRelation(tcustomer) [numPartitions=1]

20/04/15 14:38:43 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexPkFk$ result size=1500000
Elapsed time: 15158ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/15 14:38:57 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:38:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2181L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 14:38:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 14:38:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 14:38:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 14:38:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:38:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 14:38:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:38:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 14:38:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:38:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:38:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:38:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:38:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:38:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:38:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:38:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:38:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:38:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:38:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:38:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:38:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:38:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2181L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#2183 AS rid_0#2188, cval_region_r_name#2184 AS cval_region_r_name_0#2189, cval_region_r_comment#2185 AS cval_region_r_comment_0#2190, cr_name#2186 AS cr_name_0#2191, cr_comment#2187 AS cr_comment_0#2192]
         :  :  :  :  :  :  :  +- Relation[rid#2183,cval_region_r_name#2184,cval_region_r_comment#2185,cr_name#2186,cr_comment#2187] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#2193 AS rid_0#2198, cval_region_r_name#2194 AS cval_region_r_name_0#2199, cval_region_r_comment#2195 AS cval_region_r_comment_0#2200, cr_name#2196 AS cr_name_0#2201, cr_comment#2197 AS cr_comment_0#2202]
         :  :  :  :  :  :        +- Relation[rid#2193,cval_region_r_name#2194,cval_region_r_comment#2195,cr_name#2196,cr_comment#2197] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- Project [rid#2227 AS rid_1#2234, cpfk_region_nation#2228 AS cpfk_region_nation_1#2235, cfpk_nation_region#2229 AS cfpk_nation_region_1#2236, cval_nation_n_name#2230 AS cval_nation_n_name_1#2237, cval_nation_n_comment#2231 AS cval_nation_n_comment_1#2238, cn_name#2232 AS cn_name_1#2239, cn_comment#2233 AS cn_comment_1#2240]
         :  :  :  :  :     +- Relation[rid#2227,cpfk_region_nation#2228,cfpk_nation_region#2229,cval_nation_n_name#2230,cval_nation_n_comment#2231,cn_name#2232,cn_comment#2233] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#2203 AS rid_1#2210, cpfk_region_nation#2204 AS cpfk_region_nation_1#2211, cfpk_nation_region#2205 AS cfpk_nation_region_1#2212, cval_nation_n_name#2206 AS cval_nation_n_name_1#2213, cval_nation_n_comment#2207 AS cval_nation_n_comment_1#2214, cn_name#2208 AS cn_name_1#2215, cn_comment#2209 AS cn_comment_1#2216]
         :  :  :  :     +- Relation[rid#2203,cpfk_region_nation#2204,cfpk_nation_region#2205,cval_nation_n_name#2206,cval_nation_n_comment#2207,cn_name#2208,cn_comment#2209] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#2281 AS rid_2#2294, cpfk_nation_supplier#2282 AS cpfk_nation_supplier_2#2295, cfpk_supplier_nation#2283 AS cfpk_supplier_nation_2#2296, cval_supplier_s_name#2284 AS cval_supplier_s_name_2#2297, cval_supplier_s_address#2285 AS cval_supplier_s_address_2#2298, cval_supplier_s_phone#2286 AS cval_supplier_s_phone_2#2299, cval_supplier_s_acctbal#2287 AS cval_supplier_s_acctbal_2#2300, cval_supplier_s_comment#2288 AS cval_supplier_s_comment_2#2301, cs_name#2289 AS cs_name_2#2302, cs_address#2290 AS cs_address_2#2303, cs_phone#2291 AS cs_phone_2#2304, cs_acctbal#2292 AS cs_acctbal_2#2305, cs_comment#2293 AS cs_comment_2#2306]
         :  :  :     +- Relation[rid#2281,cpfk_nation_supplier#2282,cfpk_supplier_nation#2283,cval_supplier_s_name#2284,cval_supplier_s_address#2285,cval_supplier_s_phone#2286,cval_supplier_s_acctbal#2287,cval_supplier_s_comment#2288,cs_name#2289,cs_address#2290,cs_phone#2291,cs_acctbal#2292,cs_comment#2293] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#2241 AS rid_2#2254, cpfk_nation_supplier#2242 AS cpfk_nation_supplier_2#2255, cfpk_supplier_nation#2243 AS cfpk_supplier_nation_2#2256, cval_supplier_s_name#2244 AS cval_supplier_s_name_2#2257, cval_supplier_s_address#2245 AS cval_supplier_s_address_2#2258, cval_supplier_s_phone#2246 AS cval_supplier_s_phone_2#2259, cval_supplier_s_acctbal#2247 AS cval_supplier_s_acctbal_2#2260, cval_supplier_s_comment#2248 AS cval_supplier_s_comment_2#2261, cs_name#2249 AS cs_name_2#2262, cs_address#2250 AS cs_address_2#2263, cs_phone#2251 AS cs_phone_2#2264, cs_acctbal#2252 AS cs_acctbal_2#2265, cs_comment#2253 AS cs_comment_2#2266]
         :  :     +- Relation[rid#2241,cpfk_nation_supplier#2242,cfpk_supplier_nation#2243,cval_supplier_s_name#2244,cval_supplier_s_address#2245,cval_supplier_s_phone#2246,cval_supplier_s_acctbal#2247,cval_supplier_s_comment#2248,cs_name#2249,cs_address#2250,cs_phone#2251,cs_acctbal#2252,cs_comment#2253] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#2479 AS rid_4#2490, cpfk_part_partsupp#2480 AS cpfk_part_partsupp_4#2491, cfpk_partsupp_part#2481 AS cfpk_partsupp_part_4#2492, cpfk_supplier_partsupp#2482 AS cpfk_supplier_partsupp_4#2493, cfpk_partsupp_supplier#2483 AS cfpk_partsupp_supplier_4#2494, cval_partsupp_ps_availqty#2484 AS cval_partsupp_ps_availqty_4#2495, cval_partsupp_ps_supplycost#2485 AS cval_partsupp_ps_supplycost_4#2496, cval_partsupp_ps_comment#2486 AS cval_partsupp_ps_comment_4#2497, cps_availqty#2487 AS cps_availqty_4#2498, cps_supplycost#2488 AS cps_supplycost_4#2499, cps_comment#2489 AS cps_comment_4#2500]
         :     +- Relation[rid#2479,cpfk_part_partsupp#2480,cfpk_partsupp_part#2481,cpfk_supplier_partsupp#2482,cfpk_partsupp_supplier#2483,cval_partsupp_ps_availqty#2484,cval_partsupp_ps_supplycost#2485,cval_partsupp_ps_comment#2486,cps_availqty#2487,cps_supplycost#2488,cps_comment#2489] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#2307 AS rid_3#2324, cval_part_p_name#2308 AS cval_part_p_name_3#2325, cval_part_p_mfgr#2309 AS cval_part_p_mfgr_3#2326, cval_part_p_type#2310 AS cval_part_p_type_3#2327, cval_part_p_size#2311 AS cval_part_p_size_3#2328, cval_part_p_container#2312 AS cval_part_p_container_3#2329, cval_part_p_retailprice#2313 AS cval_part_p_retailprice_3#2330, cval_part_p_comment#2314 AS cval_part_p_comment_3#2331, cval_part_p_brand#2315 AS cval_part_p_brand_3#2332, cp_name#2316 AS cp_name_3#2333, cp_mfgr#2317 AS cp_mfgr_3#2334, cp_type#2318 AS cp_type_3#2335, cp_size#2319 AS cp_size_3#2336, cp_container#2320 AS cp_container_3#2337, cp_retailprice#2321 AS cp_retailprice_3#2338, cp_comment#2322 AS cp_comment_3#2339, cp_brand#2323 AS cp_brand_3#2340]
            :  :  :  +- Relation[rid#2307,cval_part_p_name#2308,cval_part_p_mfgr#2309,cval_part_p_type#2310,cval_part_p_size#2311,cval_part_p_container#2312,cval_part_p_retailprice#2313,cval_part_p_comment#2314,cval_part_p_brand#2315,cp_name#2316,cp_mfgr#2317,cp_type#2318,cp_size#2319,cp_container#2320,cp_retailprice#2321,cp_comment#2322,cp_brand#2323] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#2341 AS rid_3#2358, cval_part_p_name#2342 AS cval_part_p_name_3#2359, cval_part_p_mfgr#2343 AS cval_part_p_mfgr_3#2360, cval_part_p_type#2344 AS cval_part_p_type_3#2361, cval_part_p_size#2345 AS cval_part_p_size_3#2362, cval_part_p_container#2346 AS cval_part_p_container_3#2363, cval_part_p_retailprice#2347 AS cval_part_p_retailprice_3#2364, cval_part_p_comment#2348 AS cval_part_p_comment_3#2365, cval_part_p_brand#2349 AS cval_part_p_brand_3#2366, cp_name#2350 AS cp_name_3#2367, cp_mfgr#2351 AS cp_mfgr_3#2368, cp_type#2352 AS cp_type_3#2369, cp_size#2353 AS cp_size_3#2370, cp_container#2354 AS cp_container_3#2371, cp_retailprice#2355 AS cp_retailprice_3#2372, cp_comment#2356 AS cp_comment_3#2373, cp_brand#2357 AS cp_brand_3#2374]
            :  :        +- Relation[rid#2341,cval_part_p_name#2342,cval_part_p_mfgr#2343,cval_part_p_type#2344,cval_part_p_size#2345,cval_part_p_container#2346,cval_part_p_retailprice#2347,cval_part_p_comment#2348,cval_part_p_brand#2349,cp_name#2350,cp_mfgr#2351,cp_type#2352,cp_size#2353,cp_container#2354,cp_retailprice#2355,cp_comment#2356,cp_brand#2357] JDBCRelation(tpart) [numPartitions=1]
            :  +- Project [rid#2431 AS rid_4#2442, cpfk_part_partsupp#2432 AS cpfk_part_partsupp_4#2443, cfpk_partsupp_part#2433 AS cfpk_partsupp_part_4#2444, cpfk_supplier_partsupp#2434 AS cpfk_supplier_partsupp_4#2445, cfpk_partsupp_supplier#2435 AS cfpk_partsupp_supplier_4#2446, cval_partsupp_ps_availqty#2436 AS cval_partsupp_ps_availqty_4#2447, cval_partsupp_ps_supplycost#2437 AS cval_partsupp_ps_supplycost_4#2448, cval_partsupp_ps_comment#2438 AS cval_partsupp_ps_comment_4#2449, cps_availqty#2439 AS cps_availqty_4#2450, cps_supplycost#2440 AS cps_supplycost_4#2451, cps_comment#2441 AS cps_comment_4#2452]
            :     +- Relation[rid#2431,cpfk_part_partsupp#2432,cfpk_partsupp_part#2433,cpfk_supplier_partsupp#2434,cfpk_partsupp_supplier#2435,cval_partsupp_ps_availqty#2436,cval_partsupp_ps_supplycost#2437,cval_partsupp_ps_comment#2438,cps_availqty#2439,cps_supplycost#2440,cps_comment#2441] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#2375 AS rid_4#2386, cpfk_part_partsupp#2376 AS cpfk_part_partsupp_4#2387, cfpk_partsupp_part#2377 AS cfpk_partsupp_part_4#2388, cpfk_supplier_partsupp#2378 AS cpfk_supplier_partsupp_4#2389, cfpk_partsupp_supplier#2379 AS cfpk_partsupp_supplier_4#2390, cval_partsupp_ps_availqty#2380 AS cval_partsupp_ps_availqty_4#2391, cval_partsupp_ps_supplycost#2381 AS cval_partsupp_ps_supplycost_4#2392, cval_partsupp_ps_comment#2382 AS cval_partsupp_ps_comment_4#2393, cps_availqty#2383 AS cps_availqty_4#2394, cps_supplycost#2384 AS cps_supplycost_4#2395, cps_comment#2385 AS cps_comment_4#2396]
               +- Relation[rid#2375,cpfk_part_partsupp#2376,cfpk_partsupp_part#2377,cpfk_supplier_partsupp#2378,cfpk_partsupp_supplier#2379,cval_partsupp_ps_availqty#2380,cval_partsupp_ps_supplycost#2381,cval_partsupp_ps_comment#2382,cps_availqty#2383,cps_supplycost#2384,cps_comment#2385] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 5926ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/15 14:39:03 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:39:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2560L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 14:39:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2560L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#2562 AS rid_0#2579, cval_part_p_name#2563 AS cval_part_p_name_0#2580, cval_part_p_mfgr#2564 AS cval_part_p_mfgr_0#2581, cval_part_p_type#2565 AS cval_part_p_type_0#2582, cval_part_p_size#2566 AS cval_part_p_size_0#2583, cval_part_p_container#2567 AS cval_part_p_container_0#2584, cval_part_p_retailprice#2568 AS cval_part_p_retailprice_0#2585, cval_part_p_comment#2569 AS cval_part_p_comment_0#2586, cval_part_p_brand#2570 AS cval_part_p_brand_0#2587, cp_name#2571 AS cp_name_0#2588, cp_mfgr#2572 AS cp_mfgr_0#2589, cp_type#2573 AS cp_type_0#2590, cp_size#2574 AS cp_size_0#2591, cp_container#2575 AS cp_container_0#2592, cp_retailprice#2576 AS cp_retailprice_0#2593, cp_comment#2577 AS cp_comment_0#2594, cp_brand#2578 AS cp_brand_0#2595]
         :  :  +- Relation[rid#2562,cval_part_p_name#2563,cval_part_p_mfgr#2564,cval_part_p_type#2565,cval_part_p_size#2566,cval_part_p_container#2567,cval_part_p_retailprice#2568,cval_part_p_comment#2569,cval_part_p_brand#2570,cp_name#2571,cp_mfgr#2572,cp_type#2573,cp_size#2574,cp_container#2575,cp_retailprice#2576,cp_comment#2577,cp_brand#2578] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#2662 AS rid_0#2679, cval_part_p_name#2663 AS cval_part_p_name_0#2680, cval_part_p_mfgr#2664 AS cval_part_p_mfgr_0#2681, cval_part_p_type#2665 AS cval_part_p_type_0#2682, cval_part_p_size#2666 AS cval_part_p_size_0#2683, cval_part_p_container#2667 AS cval_part_p_container_0#2684, cval_part_p_retailprice#2668 AS cval_part_p_retailprice_0#2685, cval_part_p_comment#2669 AS cval_part_p_comment_0#2686, cval_part_p_brand#2670 AS cval_part_p_brand_0#2687, cp_name#2671 AS cp_name_0#2688, cp_mfgr#2672 AS cp_mfgr_0#2689, cp_type#2673 AS cp_type_0#2690, cp_size#2674 AS cp_size_0#2691, cp_container#2675 AS cp_container_0#2692, cp_retailprice#2676 AS cp_retailprice_0#2693, cp_comment#2677 AS cp_comment_0#2694, cp_brand#2678 AS cp_brand_0#2695]
         :     :  +- Relation[rid#2662,cval_part_p_name#2663,cval_part_p_mfgr#2664,cval_part_p_type#2665,cval_part_p_size#2666,cval_part_p_container#2667,cval_part_p_retailprice#2668,cval_part_p_comment#2669,cval_part_p_brand#2670,cp_name#2671,cp_mfgr#2672,cp_type#2673,cp_size#2674,cp_container#2675,cp_retailprice#2676,cp_comment#2677,cp_brand#2678] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#2696 AS rid_1#2729, cpfk_orders_lineitem#2697 AS cpfk_orders_lineitem_1#2730, cpfk_supplier_lineitem#2698 AS cpfk_supplier_lineitem_1#2731, cfpk_lineitem_supplier#2699 AS cfpk_lineitem_supplier_1#2732, cfpk_lineitem_partsupp#2700 AS cfpk_lineitem_partsupp_1#2733, cpfk_part_lineitem#2701 AS cpfk_part_lineitem_1#2734, cfpk_lineitem_part#2702 AS cfpk_lineitem_part_1#2735, cpfk_partsupp_lineitem#2703 AS cpfk_partsupp_lineitem_1#2736, cfpk_lineitem_orders#2704 AS cfpk_lineitem_orders_1#2737, cval_lineitem_l_quantity#2705 AS cval_lineitem_l_quantity_1#2738, cval_lineitem_l_extendedprice#2706 AS cval_lineitem_l_extendedprice_1#2739, cval_lineitem_l_discount#2707 AS cval_lineitem_l_discount_1#2740, cval_lineitem_l_tax#2708 AS cval_lineitem_l_tax_1#2741, cval_lineitem_l_returnflag#2709 AS cval_lineitem_l_returnflag_1#2742, cval_lineitem_l_linestatus#2710 AS cval_lineitem_l_linestatus_1#2743, cval_lineitem_l_commitdate#2711 AS cval_lineitem_l_commitdate_1#2744, cval_lineitem_l_receiptdate#2712 AS cval_lineitem_l_receiptdate_1#2745, cval_lineitem_l_shipinstruct#2713 AS cval_lineitem_l_shipinstruct_1#2746, cval_lineitem_l_shipmode#2714 AS cval_lineitem_l_shipmode_1#2747, cval_lineitem_l_comment#2715 AS cval_lineitem_l_comment_1#2748, cval_lineitem_l_shipdate#2716 AS cval_lineitem_l_shipdate_1#2749, cl_quantity#2717 AS cl_quantity_1#2750, cl_extendedprice#2718 AS cl_extendedprice_1#2751, cl_discount#2719 AS cl_discount_1#2752, ... 9 more fields]
         :        +- Relation[rid#2696,cpfk_orders_lineitem#2697,cpfk_supplier_lineitem#2698,cfpk_lineitem_supplier#2699,cfpk_lineitem_partsupp#2700,cpfk_part_lineitem#2701,cfpk_lineitem_part#2702,cpfk_partsupp_lineitem#2703,cfpk_lineitem_orders#2704,cval_lineitem_l_quantity#2705,cval_lineitem_l_extendedprice#2706,cval_lineitem_l_discount#2707,cval_lineitem_l_tax#2708,cval_lineitem_l_returnflag#2709,cval_lineitem_l_linestatus#2710,cval_lineitem_l_commitdate#2711,cval_lineitem_l_receiptdate#2712,cval_lineitem_l_shipinstruct#2713,cval_lineitem_l_shipmode#2714,cval_lineitem_l_comment#2715,cval_lineitem_l_shipdate#2716,cl_quantity#2717,cl_extendedprice#2718,cl_discount#2719,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2596 AS rid_1#2629, cpfk_orders_lineitem#2597 AS cpfk_orders_lineitem_1#2630, cpfk_supplier_lineitem#2598 AS cpfk_supplier_lineitem_1#2631, cfpk_lineitem_supplier#2599 AS cfpk_lineitem_supplier_1#2632, cfpk_lineitem_partsupp#2600 AS cfpk_lineitem_partsupp_1#2633, cpfk_part_lineitem#2601 AS cpfk_part_lineitem_1#2634, cfpk_lineitem_part#2602 AS cfpk_lineitem_part_1#2635, cpfk_partsupp_lineitem#2603 AS cpfk_partsupp_lineitem_1#2636, cfpk_lineitem_orders#2604 AS cfpk_lineitem_orders_1#2637, cval_lineitem_l_quantity#2605 AS cval_lineitem_l_quantity_1#2638, cval_lineitem_l_extendedprice#2606 AS cval_lineitem_l_extendedprice_1#2639, cval_lineitem_l_discount#2607 AS cval_lineitem_l_discount_1#2640, cval_lineitem_l_tax#2608 AS cval_lineitem_l_tax_1#2641, cval_lineitem_l_returnflag#2609 AS cval_lineitem_l_returnflag_1#2642, cval_lineitem_l_linestatus#2610 AS cval_lineitem_l_linestatus_1#2643, cval_lineitem_l_commitdate#2611 AS cval_lineitem_l_commitdate_1#2644, cval_lineitem_l_receiptdate#2612 AS cval_lineitem_l_receiptdate_1#2645, cval_lineitem_l_shipinstruct#2613 AS cval_lineitem_l_shipinstruct_1#2646, cval_lineitem_l_shipmode#2614 AS cval_lineitem_l_shipmode_1#2647, cval_lineitem_l_comment#2615 AS cval_lineitem_l_comment_1#2648, cval_lineitem_l_shipdate#2616 AS cval_lineitem_l_shipdate_1#2649, cl_quantity#2617 AS cl_quantity_1#2650, cl_extendedprice#2618 AS cl_extendedprice_1#2651, cl_discount#2619 AS cl_discount_1#2652, ... 9 more fields]
            +- Relation[rid#2596,cpfk_orders_lineitem#2597,cpfk_supplier_lineitem#2598,cfpk_lineitem_supplier#2599,cfpk_lineitem_partsupp#2600,cpfk_part_lineitem#2601,cfpk_lineitem_part#2602,cpfk_partsupp_lineitem#2603,cfpk_lineitem_orders#2604,cval_lineitem_l_quantity#2605,cval_lineitem_l_extendedprice#2606,cval_lineitem_l_discount#2607,cval_lineitem_l_tax#2608,cval_lineitem_l_returnflag#2609,cval_lineitem_l_linestatus#2610,cval_lineitem_l_commitdate#2611,cval_lineitem_l_receiptdate#2612,cval_lineitem_l_shipinstruct#2613,cval_lineitem_l_shipmode#2614,cval_lineitem_l_comment#2615,cval_lineitem_l_shipdate#2616,cl_quantity#2617,cl_extendedprice#2618,cl_discount#2619,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 227803ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/15 14:42:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:42:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2818L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 14:42:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:42:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:42:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:42:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:42:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:42:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:42:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:42:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:42:51 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:42:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:42:51 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:42:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:42:51 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:42:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2818L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#2820 AS rid_0#2827, cpfk_region_nation#2821 AS cpfk_region_nation_0#2828, cfpk_nation_region#2822 AS cfpk_nation_region_0#2829, cval_nation_n_name#2823 AS cval_nation_n_name_0#2830, cval_nation_n_comment#2824 AS cval_nation_n_comment_0#2831, cn_name#2825 AS cn_name_0#2832, cn_comment#2826 AS cn_comment_0#2833]
         :  :  :  :  :  +- Relation[rid#2820,cpfk_region_nation#2821,cfpk_nation_region#2822,cval_nation_n_name#2823,cval_nation_n_comment#2824,cn_name#2825,cn_comment#2826] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#2834 AS rid_0#2841, cpfk_region_nation#2835 AS cpfk_region_nation_0#2842, cfpk_nation_region#2836 AS cfpk_nation_region_0#2843, cval_nation_n_name#2837 AS cval_nation_n_name_0#2844, cval_nation_n_comment#2838 AS cval_nation_n_comment_0#2845, cn_name#2839 AS cn_name_0#2846, cn_comment#2840 AS cn_comment_0#2847]
         :  :  :  :        +- Relation[rid#2834,cpfk_region_nation#2835,cfpk_nation_region#2836,cval_nation_n_name#2837,cval_nation_n_comment#2838,cn_name#2839,cn_comment#2840] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#2888 AS rid_1#2901, cpfk_nation_supplier#2889 AS cpfk_nation_supplier_1#2902, cfpk_supplier_nation#2890 AS cfpk_supplier_nation_1#2903, cval_supplier_s_name#2891 AS cval_supplier_s_name_1#2904, cval_supplier_s_address#2892 AS cval_supplier_s_address_1#2905, cval_supplier_s_phone#2893 AS cval_supplier_s_phone_1#2906, cval_supplier_s_acctbal#2894 AS cval_supplier_s_acctbal_1#2907, cval_supplier_s_comment#2895 AS cval_supplier_s_comment_1#2908, cs_name#2896 AS cs_name_1#2909, cs_address#2897 AS cs_address_1#2910, cs_phone#2898 AS cs_phone_1#2911, cs_acctbal#2899 AS cs_acctbal_1#2912, cs_comment#2900 AS cs_comment_1#2913]
         :  :  :     +- Relation[rid#2888,cpfk_nation_supplier#2889,cfpk_supplier_nation#2890,cval_supplier_s_name#2891,cval_supplier_s_address#2892,cval_supplier_s_phone#2893,cval_supplier_s_acctbal#2894,cval_supplier_s_comment#2895,cs_name#2896,cs_address#2897,cs_phone#2898,cs_acctbal#2899,cs_comment#2900] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#2848 AS rid_1#2861, cpfk_nation_supplier#2849 AS cpfk_nation_supplier_1#2862, cfpk_supplier_nation#2850 AS cfpk_supplier_nation_1#2863, cval_supplier_s_name#2851 AS cval_supplier_s_name_1#2864, cval_supplier_s_address#2852 AS cval_supplier_s_address_1#2865, cval_supplier_s_phone#2853 AS cval_supplier_s_phone_1#2866, cval_supplier_s_acctbal#2854 AS cval_supplier_s_acctbal_1#2867, cval_supplier_s_comment#2855 AS cval_supplier_s_comment_1#2868, cs_name#2856 AS cs_name_1#2869, cs_address#2857 AS cs_address_1#2870, cs_phone#2858 AS cs_phone_1#2871, cs_acctbal#2859 AS cs_acctbal_1#2872, cs_comment#2860 AS cs_comment_1#2873]
         :  :     +- Relation[rid#2848,cpfk_nation_supplier#2849,cfpk_supplier_nation#2850,cval_supplier_s_name#2851,cval_supplier_s_address#2852,cval_supplier_s_phone#2853,cval_supplier_s_acctbal#2854,cval_supplier_s_comment#2855,cs_name#2856,cs_address#2857,cs_phone#2858,cs_acctbal#2859,cs_comment#2860] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#2962 AS rid_2#2973, cpfk_part_partsupp#2963 AS cpfk_part_partsupp_2#2974, cfpk_partsupp_part#2964 AS cfpk_partsupp_part_2#2975, cpfk_supplier_partsupp#2965 AS cpfk_supplier_partsupp_2#2976, cfpk_partsupp_supplier#2966 AS cfpk_partsupp_supplier_2#2977, cval_partsupp_ps_availqty#2967 AS cval_partsupp_ps_availqty_2#2978, cval_partsupp_ps_supplycost#2968 AS cval_partsupp_ps_supplycost_2#2979, cval_partsupp_ps_comment#2969 AS cval_partsupp_ps_comment_2#2980, cps_availqty#2970 AS cps_availqty_2#2981, cps_supplycost#2971 AS cps_supplycost_2#2982, cps_comment#2972 AS cps_comment_2#2983]
         :     +- Relation[rid#2962,cpfk_part_partsupp#2963,cfpk_partsupp_part#2964,cpfk_supplier_partsupp#2965,cfpk_partsupp_supplier#2966,cval_partsupp_ps_availqty#2967,cval_partsupp_ps_supplycost#2968,cval_partsupp_ps_comment#2969,cps_availqty#2970,cps_supplycost#2971,cps_comment#2972] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#2914 AS rid_2#2925, cpfk_part_partsupp#2915 AS cpfk_part_partsupp_2#2926, cfpk_partsupp_part#2916 AS cfpk_partsupp_part_2#2927, cpfk_supplier_partsupp#2917 AS cpfk_supplier_partsupp_2#2928, cfpk_partsupp_supplier#2918 AS cfpk_partsupp_supplier_2#2929, cval_partsupp_ps_availqty#2919 AS cval_partsupp_ps_availqty_2#2930, cval_partsupp_ps_supplycost#2920 AS cval_partsupp_ps_supplycost_2#2931, cval_partsupp_ps_comment#2921 AS cval_partsupp_ps_comment_2#2932, cps_availqty#2922 AS cps_availqty_2#2933, cps_supplycost#2923 AS cps_supplycost_2#2934, cps_comment#2924 AS cps_comment_2#2935]
            +- Relation[rid#2914,cpfk_part_partsupp#2915,cfpk_partsupp_part#2916,cpfk_supplier_partsupp#2917,cfpk_partsupp_supplier#2918,cval_partsupp_ps_availqty#2919,cval_partsupp_ps_supplycost#2920,cval_partsupp_ps_comment#2921,cps_availqty#2922,cps_supplycost#2923,cps_comment#2924] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=4
Elapsed time: 984ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/15 14:42:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:42:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3043L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 14:42:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3043L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#3045 AS rid_0#3078, cpfk_orders_lineitem#3046 AS cpfk_orders_lineitem_0#3079, cpfk_supplier_lineitem#3047 AS cpfk_supplier_lineitem_0#3080, cfpk_lineitem_supplier#3048 AS cfpk_lineitem_supplier_0#3081, cfpk_lineitem_partsupp#3049 AS cfpk_lineitem_partsupp_0#3082, cpfk_part_lineitem#3050 AS cpfk_part_lineitem_0#3083, cfpk_lineitem_part#3051 AS cfpk_lineitem_part_0#3084, cpfk_partsupp_lineitem#3052 AS cpfk_partsupp_lineitem_0#3085, cfpk_lineitem_orders#3053 AS cfpk_lineitem_orders_0#3086, cval_lineitem_l_quantity#3054 AS cval_lineitem_l_quantity_0#3087, cval_lineitem_l_extendedprice#3055 AS cval_lineitem_l_extendedprice_0#3088, cval_lineitem_l_discount#3056 AS cval_lineitem_l_discount_0#3089, cval_lineitem_l_tax#3057 AS cval_lineitem_l_tax_0#3090, cval_lineitem_l_returnflag#3058 AS cval_lineitem_l_returnflag_0#3091, cval_lineitem_l_linestatus#3059 AS cval_lineitem_l_linestatus_0#3092, cval_lineitem_l_commitdate#3060 AS cval_lineitem_l_commitdate_0#3093, cval_lineitem_l_receiptdate#3061 AS cval_lineitem_l_receiptdate_0#3094, cval_lineitem_l_shipinstruct#3062 AS cval_lineitem_l_shipinstruct_0#3095, cval_lineitem_l_shipmode#3063 AS cval_lineitem_l_shipmode_0#3096, cval_lineitem_l_comment#3064 AS cval_lineitem_l_comment_0#3097, cval_lineitem_l_shipdate#3065 AS cval_lineitem_l_shipdate_0#3098, cl_quantity#3066 AS cl_quantity_0#3099, cl_extendedprice#3067 AS cl_extendedprice_0#3100, cl_discount#3068 AS cl_discount_0#3101, ... 9 more fields]
            :  +- Relation[rid#3045,cpfk_orders_lineitem#3046,cpfk_supplier_lineitem#3047,cfpk_lineitem_supplier#3048,cfpk_lineitem_partsupp#3049,cpfk_part_lineitem#3050,cfpk_lineitem_part#3051,cpfk_partsupp_lineitem#3052,cfpk_lineitem_orders#3053,cval_lineitem_l_quantity#3054,cval_lineitem_l_extendedprice#3055,cval_lineitem_l_discount#3056,cval_lineitem_l_tax#3057,cval_lineitem_l_returnflag#3058,cval_lineitem_l_linestatus#3059,cval_lineitem_l_commitdate#3060,cval_lineitem_l_receiptdate#3061,cval_lineitem_l_shipinstruct#3062,cval_lineitem_l_shipmode#3063,cval_lineitem_l_comment#3064,cval_lineitem_l_shipdate#3065,cl_quantity#3066,cl_extendedprice#3067,cl_discount#3068,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#3111 AS rid_1#3128, cpfk_customer_orders#3112 AS cpfk_customer_orders_1#3129, cfpk_orders_customer#3113 AS cfpk_orders_customer_1#3130, cval_orders_o_orderstatus#3114 AS cval_orders_o_orderstatus_1#3131, cval_orders_o_totalprice#3115 AS cval_orders_o_totalprice_1#3132, cval_orders_o_orderpriority#3116 AS cval_orders_o_orderpriority_1#3133, cval_orders_o_clerk#3117 AS cval_orders_o_clerk_1#3134, cval_orders_o_shippriority#3118 AS cval_orders_o_shippriority_1#3135, cval_orders_o_comment#3119 AS cval_orders_o_comment_1#3136, cval_orders_o_orderdate#3120 AS cval_orders_o_orderdate_1#3137, co_orderstatus#3121 AS co_orderstatus_1#3138, co_totalprice#3122 AS co_totalprice_1#3139, co_orderpriority#3123 AS co_orderpriority_1#3140, co_clerk#3124 AS co_clerk_1#3141, co_shippriority#3125 AS co_shippriority_1#3142, co_comment#3126 AS co_comment_1#3143, co_orderdate#3127 AS co_orderdate_1#3144]
               +- Relation[rid#3111,cpfk_customer_orders#3112,cfpk_orders_customer#3113,cval_orders_o_orderstatus#3114,cval_orders_o_totalprice#3115,cval_orders_o_orderpriority#3116,cval_orders_o_clerk#3117,cval_orders_o_shippriority#3118,cval_orders_o_comment#3119,cval_orders_o_orderdate#3120,co_orderstatus#3121,co_totalprice#3122,co_orderpriority#3123,co_clerk#3124,co_shippriority#3125,co_comment#3126,co_orderdate#3127] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 56195ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/15 14:43:48 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:43:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3199L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 14:43:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3199L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#3201 AS rid_0#3234, cpfk_orders_lineitem#3202 AS cpfk_orders_lineitem_0#3235, cpfk_supplier_lineitem#3203 AS cpfk_supplier_lineitem_0#3236, cfpk_lineitem_supplier#3204 AS cfpk_lineitem_supplier_0#3237, cfpk_lineitem_partsupp#3205 AS cfpk_lineitem_partsupp_0#3238, cpfk_part_lineitem#3206 AS cpfk_part_lineitem_0#3239, cfpk_lineitem_part#3207 AS cfpk_lineitem_part_0#3240, cpfk_partsupp_lineitem#3208 AS cpfk_partsupp_lineitem_0#3241, cfpk_lineitem_orders#3209 AS cfpk_lineitem_orders_0#3242, cval_lineitem_l_quantity#3210 AS cval_lineitem_l_quantity_0#3243, cval_lineitem_l_extendedprice#3211 AS cval_lineitem_l_extendedprice_0#3244, cval_lineitem_l_discount#3212 AS cval_lineitem_l_discount_0#3245, cval_lineitem_l_tax#3213 AS cval_lineitem_l_tax_0#3246, cval_lineitem_l_returnflag#3214 AS cval_lineitem_l_returnflag_0#3247, cval_lineitem_l_linestatus#3215 AS cval_lineitem_l_linestatus_0#3248, cval_lineitem_l_commitdate#3216 AS cval_lineitem_l_commitdate_0#3249, cval_lineitem_l_receiptdate#3217 AS cval_lineitem_l_receiptdate_0#3250, cval_lineitem_l_shipinstruct#3218 AS cval_lineitem_l_shipinstruct_0#3251, cval_lineitem_l_shipmode#3219 AS cval_lineitem_l_shipmode_0#3252, cval_lineitem_l_comment#3220 AS cval_lineitem_l_comment_0#3253, cval_lineitem_l_shipdate#3221 AS cval_lineitem_l_shipdate_0#3254, cl_quantity#3222 AS cl_quantity_0#3255, cl_extendedprice#3223 AS cl_extendedprice_0#3256, cl_discount#3224 AS cl_discount_0#3257, ... 9 more fields]
            :  :  +- Relation[rid#3201,cpfk_orders_lineitem#3202,cpfk_supplier_lineitem#3203,cfpk_lineitem_supplier#3204,cfpk_lineitem_partsupp#3205,cpfk_part_lineitem#3206,cfpk_lineitem_part#3207,cpfk_partsupp_lineitem#3208,cfpk_lineitem_orders#3209,cval_lineitem_l_quantity#3210,cval_lineitem_l_extendedprice#3211,cval_lineitem_l_discount#3212,cval_lineitem_l_tax#3213,cval_lineitem_l_returnflag#3214,cval_lineitem_l_linestatus#3215,cval_lineitem_l_commitdate#3216,cval_lineitem_l_receiptdate#3217,cval_lineitem_l_shipinstruct#3218,cval_lineitem_l_shipmode#3219,cval_lineitem_l_comment#3220,cval_lineitem_l_shipdate#3221,cl_quantity#3222,cl_extendedprice#3223,cl_discount#3224,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#3267 AS rid_0#3300, cpfk_orders_lineitem#3268 AS cpfk_orders_lineitem_0#3301, cpfk_supplier_lineitem#3269 AS cpfk_supplier_lineitem_0#3302, cfpk_lineitem_supplier#3270 AS cfpk_lineitem_supplier_0#3303, cfpk_lineitem_partsupp#3271 AS cfpk_lineitem_partsupp_0#3304, cpfk_part_lineitem#3272 AS cpfk_part_lineitem_0#3305, cfpk_lineitem_part#3273 AS cfpk_lineitem_part_0#3306, cpfk_partsupp_lineitem#3274 AS cpfk_partsupp_lineitem_0#3307, cfpk_lineitem_orders#3275 AS cfpk_lineitem_orders_0#3308, cval_lineitem_l_quantity#3276 AS cval_lineitem_l_quantity_0#3309, cval_lineitem_l_extendedprice#3277 AS cval_lineitem_l_extendedprice_0#3310, cval_lineitem_l_discount#3278 AS cval_lineitem_l_discount_0#3311, cval_lineitem_l_tax#3279 AS cval_lineitem_l_tax_0#3312, cval_lineitem_l_returnflag#3280 AS cval_lineitem_l_returnflag_0#3313, cval_lineitem_l_linestatus#3281 AS cval_lineitem_l_linestatus_0#3314, cval_lineitem_l_commitdate#3282 AS cval_lineitem_l_commitdate_0#3315, cval_lineitem_l_receiptdate#3283 AS cval_lineitem_l_receiptdate_0#3316, cval_lineitem_l_shipinstruct#3284 AS cval_lineitem_l_shipinstruct_0#3317, cval_lineitem_l_shipmode#3285 AS cval_lineitem_l_shipmode_0#3318, cval_lineitem_l_comment#3286 AS cval_lineitem_l_comment_0#3319, cval_lineitem_l_shipdate#3287 AS cval_lineitem_l_shipdate_0#3320, cl_quantity#3288 AS cl_quantity_0#3321, cl_extendedprice#3289 AS cl_extendedprice_0#3322, cl_discount#3290 AS cl_discount_0#3323, ... 9 more fields]
            :        +- Relation[rid#3267,cpfk_orders_lineitem#3268,cpfk_supplier_lineitem#3269,cfpk_lineitem_supplier#3270,cfpk_lineitem_partsupp#3271,cpfk_part_lineitem#3272,cfpk_lineitem_part#3273,cpfk_partsupp_lineitem#3274,cfpk_lineitem_orders#3275,cval_lineitem_l_quantity#3276,cval_lineitem_l_extendedprice#3277,cval_lineitem_l_discount#3278,cval_lineitem_l_tax#3279,cval_lineitem_l_returnflag#3280,cval_lineitem_l_linestatus#3281,cval_lineitem_l_commitdate#3282,cval_lineitem_l_receiptdate#3283,cval_lineitem_l_shipinstruct#3284,cval_lineitem_l_shipmode#3285,cval_lineitem_l_comment#3286,cval_lineitem_l_shipdate#3287,cl_quantity#3288,cl_extendedprice#3289,cl_discount#3290,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#3333 AS rid_1#3350, cpfk_customer_orders#3334 AS cpfk_customer_orders_1#3351, cfpk_orders_customer#3335 AS cfpk_orders_customer_1#3352, cval_orders_o_orderstatus#3336 AS cval_orders_o_orderstatus_1#3353, cval_orders_o_totalprice#3337 AS cval_orders_o_totalprice_1#3354, cval_orders_o_orderpriority#3338 AS cval_orders_o_orderpriority_1#3355, cval_orders_o_clerk#3339 AS cval_orders_o_clerk_1#3356, cval_orders_o_shippriority#3340 AS cval_orders_o_shippriority_1#3357, cval_orders_o_comment#3341 AS cval_orders_o_comment_1#3358, cval_orders_o_orderdate#3342 AS cval_orders_o_orderdate_1#3359, co_orderstatus#3343 AS co_orderstatus_1#3360, co_totalprice#3344 AS co_totalprice_1#3361, co_orderpriority#3345 AS co_orderpriority_1#3362, co_clerk#3346 AS co_clerk_1#3363, co_shippriority#3347 AS co_shippriority_1#3364, co_comment#3348 AS co_comment_1#3365, co_orderdate#3349 AS co_orderdate_1#3366]
               +- Relation[rid#3333,cpfk_customer_orders#3334,cfpk_orders_customer#3335,cval_orders_o_orderstatus#3336,cval_orders_o_totalprice#3337,cval_orders_o_orderpriority#3338,cval_orders_o_clerk#3339,cval_orders_o_shippriority#3340,cval_orders_o_comment#3341,cval_orders_o_orderdate#3342,co_orderstatus#3343,co_totalprice#3344,co_orderpriority#3345,co_clerk#3346,co_shippriority#3347,co_comment#3348,co_orderdate#3349] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 24371ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/15 14:44:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:44:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3422L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 14:44:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#3422L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#3424 AS rid_0#3457, cpfk_orders_lineitem#3425 AS cpfk_orders_lineitem_0#3458, cpfk_supplier_lineitem#3426 AS cpfk_supplier_lineitem_0#3459, cfpk_lineitem_supplier#3427 AS cfpk_lineitem_supplier_0#3460, cfpk_lineitem_partsupp#3428 AS cfpk_lineitem_partsupp_0#3461, cpfk_part_lineitem#3429 AS cpfk_part_lineitem_0#3462, cfpk_lineitem_part#3430 AS cfpk_lineitem_part_0#3463, cpfk_partsupp_lineitem#3431 AS cpfk_partsupp_lineitem_0#3464, cfpk_lineitem_orders#3432 AS cfpk_lineitem_orders_0#3465, cval_lineitem_l_quantity#3433 AS cval_lineitem_l_quantity_0#3466, cval_lineitem_l_extendedprice#3434 AS cval_lineitem_l_extendedprice_0#3467, cval_lineitem_l_discount#3435 AS cval_lineitem_l_discount_0#3468, cval_lineitem_l_tax#3436 AS cval_lineitem_l_tax_0#3469, cval_lineitem_l_returnflag#3437 AS cval_lineitem_l_returnflag_0#3470, cval_lineitem_l_linestatus#3438 AS cval_lineitem_l_linestatus_0#3471, cval_lineitem_l_commitdate#3439 AS cval_lineitem_l_commitdate_0#3472, cval_lineitem_l_receiptdate#3440 AS cval_lineitem_l_receiptdate_0#3473, cval_lineitem_l_shipinstruct#3441 AS cval_lineitem_l_shipinstruct_0#3474, cval_lineitem_l_shipmode#3442 AS cval_lineitem_l_shipmode_0#3475, cval_lineitem_l_comment#3443 AS cval_lineitem_l_comment_0#3476, cval_lineitem_l_shipdate#3444 AS cval_lineitem_l_shipdate_0#3477, cl_quantity#3445 AS cl_quantity_0#3478, cl_extendedprice#3446 AS cl_extendedprice_0#3479, cl_discount#3447 AS cl_discount_0#3480, ... 9 more fields]
         +- Relation[rid#3424,cpfk_orders_lineitem#3425,cpfk_supplier_lineitem#3426,cfpk_lineitem_supplier#3427,cfpk_lineitem_partsupp#3428,cpfk_part_lineitem#3429,cfpk_lineitem_part#3430,cpfk_partsupp_lineitem#3431,cfpk_lineitem_orders#3432,cval_lineitem_l_quantity#3433,cval_lineitem_l_extendedprice#3434,cval_lineitem_l_discount#3435,cval_lineitem_l_tax#3436,cval_lineitem_l_returnflag#3437,cval_lineitem_l_linestatus#3438,cval_lineitem_l_commitdate#3439,cval_lineitem_l_receiptdate#3440,cval_lineitem_l_shipinstruct#3441,cval_lineitem_l_shipmode#3442,cval_lineitem_l_comment#3443,cval_lineitem_l_shipdate#3444,cl_quantity#3445,cl_extendedprice#3446,cl_discount#3447,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2611ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/15 14:44:15 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:44:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3531L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 14:44:15 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 14:44:15 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 14:44:15 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 14:44:15 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 14:44:15 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 14:44:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3531L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#3533 AS rid_0#3548, cpfk_nation_customer#3534 AS cpfk_nation_customer_0#3549, cfpk_customer_nation#3535 AS cfpk_customer_nation_0#3550, cval_customer_c_name#3536 AS cval_customer_c_name_0#3551, cval_customer_c_address#3537 AS cval_customer_c_address_0#3552, cval_customer_c_phone#3538 AS cval_customer_c_phone_0#3553, cval_customer_c_acctbal#3539 AS cval_customer_c_acctbal_0#3554, cval_customer_c_comment#3540 AS cval_customer_c_comment_0#3555, cval_customer_c_mktsegment#3541 AS cval_customer_c_mktsegment_0#3556, cc_name#3542 AS cc_name_0#3557, cc_address#3543 AS cc_address_0#3558, cc_phone#3544 AS cc_phone_0#3559, cc_acctbal#3545 AS cc_acctbal_0#3560, cc_comment#3546 AS cc_comment_0#3561, cc_mktsegment#3547 AS cc_mktsegment_0#3562]
         :  :  :  :  :  +- Relation[rid#3533,cpfk_nation_customer#3534,cfpk_customer_nation#3535,cval_customer_c_name#3536,cval_customer_c_address#3537,cval_customer_c_phone#3538,cval_customer_c_acctbal#3539,cval_customer_c_comment#3540,cval_customer_c_mktsegment#3541,cc_name#3542,cc_address#3543,cc_phone#3544,cc_acctbal#3545,cc_comment#3546,cc_mktsegment#3547] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#3563 AS rid_0#3578, cpfk_nation_customer#3564 AS cpfk_nation_customer_0#3579, cfpk_customer_nation#3565 AS cfpk_customer_nation_0#3580, cval_customer_c_name#3566 AS cval_customer_c_name_0#3581, cval_customer_c_address#3567 AS cval_customer_c_address_0#3582, cval_customer_c_phone#3568 AS cval_customer_c_phone_0#3583, cval_customer_c_acctbal#3569 AS cval_customer_c_acctbal_0#3584, cval_customer_c_comment#3570 AS cval_customer_c_comment_0#3585, cval_customer_c_mktsegment#3571 AS cval_customer_c_mktsegment_0#3586, cc_name#3572 AS cc_name_0#3587, cc_address#3573 AS cc_address_0#3588, cc_phone#3574 AS cc_phone_0#3589, cc_acctbal#3575 AS cc_acctbal_0#3590, cc_comment#3576 AS cc_comment_0#3591, cc_mktsegment#3577 AS cc_mktsegment_0#3592]
         :  :  :  :        +- Relation[rid#3563,cpfk_nation_customer#3564,cfpk_customer_nation#3565,cval_customer_c_name#3566,cval_customer_c_address#3567,cval_customer_c_phone#3568,cval_customer_c_acctbal#3569,cval_customer_c_comment#3570,cval_customer_c_mktsegment#3571,cc_name#3572,cc_address#3573,cc_phone#3574,cc_acctbal#3575,cc_comment#3576,cc_mktsegment#3577] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- Project [rid#3657 AS rid_1#3674, cpfk_customer_orders#3658 AS cpfk_customer_orders_1#3675, cfpk_orders_customer#3659 AS cfpk_orders_customer_1#3676, cval_orders_o_orderstatus#3660 AS cval_orders_o_orderstatus_1#3677, cval_orders_o_totalprice#3661 AS cval_orders_o_totalprice_1#3678, cval_orders_o_orderpriority#3662 AS cval_orders_o_orderpriority_1#3679, cval_orders_o_clerk#3663 AS cval_orders_o_clerk_1#3680, cval_orders_o_shippriority#3664 AS cval_orders_o_shippriority_1#3681, cval_orders_o_comment#3665 AS cval_orders_o_comment_1#3682, cval_orders_o_orderdate#3666 AS cval_orders_o_orderdate_1#3683, co_orderstatus#3667 AS co_orderstatus_1#3684, co_totalprice#3668 AS co_totalprice_1#3685, co_orderpriority#3669 AS co_orderpriority_1#3686, co_clerk#3670 AS co_clerk_1#3687, co_shippriority#3671 AS co_shippriority_1#3688, co_comment#3672 AS co_comment_1#3689, co_orderdate#3673 AS co_orderdate_1#3690]
         :  :  :     +- Relation[rid#3657,cpfk_customer_orders#3658,cfpk_orders_customer#3659,cval_orders_o_orderstatus#3660,cval_orders_o_totalprice#3661,cval_orders_o_orderpriority#3662,cval_orders_o_clerk#3663,cval_orders_o_shippriority#3664,cval_orders_o_comment#3665,cval_orders_o_orderdate#3666,co_orderstatus#3667,co_totalprice#3668,co_orderpriority#3669,co_clerk#3670,co_shippriority#3671,co_comment#3672,co_orderdate#3673] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#3593 AS rid_1#3610, cpfk_customer_orders#3594 AS cpfk_customer_orders_1#3611, cfpk_orders_customer#3595 AS cfpk_orders_customer_1#3612, cval_orders_o_orderstatus#3596 AS cval_orders_o_orderstatus_1#3613, cval_orders_o_totalprice#3597 AS cval_orders_o_totalprice_1#3614, cval_orders_o_orderpriority#3598 AS cval_orders_o_orderpriority_1#3615, cval_orders_o_clerk#3599 AS cval_orders_o_clerk_1#3616, cval_orders_o_shippriority#3600 AS cval_orders_o_shippriority_1#3617, cval_orders_o_comment#3601 AS cval_orders_o_comment_1#3618, cval_orders_o_orderdate#3602 AS cval_orders_o_orderdate_1#3619, co_orderstatus#3603 AS co_orderstatus_1#3620, co_totalprice#3604 AS co_totalprice_1#3621, co_orderpriority#3605 AS co_orderpriority_1#3622, co_clerk#3606 AS co_clerk_1#3623, co_shippriority#3607 AS co_shippriority_1#3624, co_comment#3608 AS co_comment_1#3625, co_orderdate#3609 AS co_orderdate_1#3626]
         :  :     +- Relation[rid#3593,cpfk_customer_orders#3594,cfpk_orders_customer#3595,cval_orders_o_orderstatus#3596,cval_orders_o_totalprice#3597,cval_orders_o_orderpriority#3598,cval_orders_o_clerk#3599,cval_orders_o_shippriority#3600,cval_orders_o_comment#3601,cval_orders_o_orderdate#3602,co_orderstatus#3603,co_totalprice#3604,co_orderpriority#3605,co_clerk#3606,co_shippriority#3607,co_comment#3608,co_orderdate#3609] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#3791 AS rid_2#3824, cpfk_orders_lineitem#3792 AS cpfk_orders_lineitem_2#3825, cpfk_supplier_lineitem#3793 AS cpfk_supplier_lineitem_2#3826, cfpk_lineitem_supplier#3794 AS cfpk_lineitem_supplier_2#3827, cfpk_lineitem_partsupp#3795 AS cfpk_lineitem_partsupp_2#3828, cpfk_part_lineitem#3796 AS cpfk_part_lineitem_2#3829, cfpk_lineitem_part#3797 AS cfpk_lineitem_part_2#3830, cpfk_partsupp_lineitem#3798 AS cpfk_partsupp_lineitem_2#3831, cfpk_lineitem_orders#3799 AS cfpk_lineitem_orders_2#3832, cval_lineitem_l_quantity#3800 AS cval_lineitem_l_quantity_2#3833, cval_lineitem_l_extendedprice#3801 AS cval_lineitem_l_extendedprice_2#3834, cval_lineitem_l_discount#3802 AS cval_lineitem_l_discount_2#3835, cval_lineitem_l_tax#3803 AS cval_lineitem_l_tax_2#3836, cval_lineitem_l_returnflag#3804 AS cval_lineitem_l_returnflag_2#3837, cval_lineitem_l_linestatus#3805 AS cval_lineitem_l_linestatus_2#3838, cval_lineitem_l_commitdate#3806 AS cval_lineitem_l_commitdate_2#3839, cval_lineitem_l_receiptdate#3807 AS cval_lineitem_l_receiptdate_2#3840, cval_lineitem_l_shipinstruct#3808 AS cval_lineitem_l_shipinstruct_2#3841, cval_lineitem_l_shipmode#3809 AS cval_lineitem_l_shipmode_2#3842, cval_lineitem_l_comment#3810 AS cval_lineitem_l_comment_2#3843, cval_lineitem_l_shipdate#3811 AS cval_lineitem_l_shipdate_2#3844, cl_quantity#3812 AS cl_quantity_2#3845, cl_extendedprice#3813 AS cl_extendedprice_2#3846, cl_discount#3814 AS cl_discount_2#3847, ... 9 more fields]
         :     +- Relation[rid#3791,cpfk_orders_lineitem#3792,cpfk_supplier_lineitem#3793,cfpk_lineitem_supplier#3794,cfpk_lineitem_partsupp#3795,cpfk_part_lineitem#3796,cfpk_lineitem_part#3797,cpfk_partsupp_lineitem#3798,cfpk_lineitem_orders#3799,cval_lineitem_l_quantity#3800,cval_lineitem_l_extendedprice#3801,cval_lineitem_l_discount#3802,cval_lineitem_l_tax#3803,cval_lineitem_l_returnflag#3804,cval_lineitem_l_linestatus#3805,cval_lineitem_l_commitdate#3806,cval_lineitem_l_receiptdate#3807,cval_lineitem_l_shipinstruct#3808,cval_lineitem_l_shipmode#3809,cval_lineitem_l_comment#3810,cval_lineitem_l_shipdate#3811,cl_quantity#3812,cl_extendedprice#3813,cl_discount#3814,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#3691 AS rid_2#3724, cpfk_orders_lineitem#3692 AS cpfk_orders_lineitem_2#3725, cpfk_supplier_lineitem#3693 AS cpfk_supplier_lineitem_2#3726, cfpk_lineitem_supplier#3694 AS cfpk_lineitem_supplier_2#3727, cfpk_lineitem_partsupp#3695 AS cfpk_lineitem_partsupp_2#3728, cpfk_part_lineitem#3696 AS cpfk_part_lineitem_2#3729, cfpk_lineitem_part#3697 AS cfpk_lineitem_part_2#3730, cpfk_partsupp_lineitem#3698 AS cpfk_partsupp_lineitem_2#3731, cfpk_lineitem_orders#3699 AS cfpk_lineitem_orders_2#3732, cval_lineitem_l_quantity#3700 AS cval_lineitem_l_quantity_2#3733, cval_lineitem_l_extendedprice#3701 AS cval_lineitem_l_extendedprice_2#3734, cval_lineitem_l_discount#3702 AS cval_lineitem_l_discount_2#3735, cval_lineitem_l_tax#3703 AS cval_lineitem_l_tax_2#3736, cval_lineitem_l_returnflag#3704 AS cval_lineitem_l_returnflag_2#3737, cval_lineitem_l_linestatus#3705 AS cval_lineitem_l_linestatus_2#3738, cval_lineitem_l_commitdate#3706 AS cval_lineitem_l_commitdate_2#3739, cval_lineitem_l_receiptdate#3707 AS cval_lineitem_l_receiptdate_2#3740, cval_lineitem_l_shipinstruct#3708 AS cval_lineitem_l_shipinstruct_2#3741, cval_lineitem_l_shipmode#3709 AS cval_lineitem_l_shipmode_2#3742, cval_lineitem_l_comment#3710 AS cval_lineitem_l_comment_2#3743, cval_lineitem_l_shipdate#3711 AS cval_lineitem_l_shipdate_2#3744, cl_quantity#3712 AS cl_quantity_2#3745, cl_extendedprice#3713 AS cl_extendedprice_2#3746, cl_discount#3714 AS cl_discount_2#3747, ... 9 more fields]
            +- Relation[rid#3691,cpfk_orders_lineitem#3692,cpfk_supplier_lineitem#3693,cfpk_lineitem_supplier#3694,cfpk_lineitem_partsupp#3695,cpfk_part_lineitem#3696,cfpk_lineitem_part#3697,cpfk_partsupp_lineitem#3698,cfpk_lineitem_orders#3699,cval_lineitem_l_quantity#3700,cval_lineitem_l_extendedprice#3701,cval_lineitem_l_discount#3702,cval_lineitem_l_tax#3703,cval_lineitem_l_returnflag#3704,cval_lineitem_l_linestatus#3705,cval_lineitem_l_commitdate#3706,cval_lineitem_l_receiptdate#3707,cval_lineitem_l_shipinstruct#3708,cval_lineitem_l_shipmode#3709,cval_lineitem_l_comment#3710,cval_lineitem_l_shipdate#3711,cl_quantity#3712,cl_extendedprice#3713,cl_discount#3714,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=75006
Elapsed time: 7227ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/15 14:44:22 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:44:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3934L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 14:44:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:44:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:44:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3934L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#3936 AS rid_0#3969, cpfk_orders_lineitem#3937 AS cpfk_orders_lineitem_0#3970, cpfk_supplier_lineitem#3938 AS cpfk_supplier_lineitem_0#3971, cfpk_lineitem_supplier#3939 AS cfpk_lineitem_supplier_0#3972, cfpk_lineitem_partsupp#3940 AS cfpk_lineitem_partsupp_0#3973, cpfk_part_lineitem#3941 AS cpfk_part_lineitem_0#3974, cfpk_lineitem_part#3942 AS cfpk_lineitem_part_0#3975, cpfk_partsupp_lineitem#3943 AS cpfk_partsupp_lineitem_0#3976, cfpk_lineitem_orders#3944 AS cfpk_lineitem_orders_0#3977, cval_lineitem_l_quantity#3945 AS cval_lineitem_l_quantity_0#3978, cval_lineitem_l_extendedprice#3946 AS cval_lineitem_l_extendedprice_0#3979, cval_lineitem_l_discount#3947 AS cval_lineitem_l_discount_0#3980, cval_lineitem_l_tax#3948 AS cval_lineitem_l_tax_0#3981, cval_lineitem_l_returnflag#3949 AS cval_lineitem_l_returnflag_0#3982, cval_lineitem_l_linestatus#3950 AS cval_lineitem_l_linestatus_0#3983, cval_lineitem_l_commitdate#3951 AS cval_lineitem_l_commitdate_0#3984, cval_lineitem_l_receiptdate#3952 AS cval_lineitem_l_receiptdate_0#3985, cval_lineitem_l_shipinstruct#3953 AS cval_lineitem_l_shipinstruct_0#3986, cval_lineitem_l_shipmode#3954 AS cval_lineitem_l_shipmode_0#3987, cval_lineitem_l_comment#3955 AS cval_lineitem_l_comment_0#3988, cval_lineitem_l_shipdate#3956 AS cval_lineitem_l_shipdate_0#3989, cl_quantity#3957 AS cl_quantity_0#3990, cl_extendedprice#3958 AS cl_extendedprice_0#3991, cl_discount#3959 AS cl_discount_0#3992, ... 9 more fields]
            :     :     :  :  +- Relation[rid#3936,cpfk_orders_lineitem#3937,cpfk_supplier_lineitem#3938,cfpk_lineitem_supplier#3939,cfpk_lineitem_partsupp#3940,cpfk_part_lineitem#3941,cfpk_lineitem_part#3942,cpfk_partsupp_lineitem#3943,cfpk_lineitem_orders#3944,cval_lineitem_l_quantity#3945,cval_lineitem_l_extendedprice#3946,cval_lineitem_l_discount#3947,cval_lineitem_l_tax#3948,cval_lineitem_l_returnflag#3949,cval_lineitem_l_linestatus#3950,cval_lineitem_l_commitdate#3951,cval_lineitem_l_receiptdate#3952,cval_lineitem_l_shipinstruct#3953,cval_lineitem_l_shipmode#3954,cval_lineitem_l_comment#3955,cval_lineitem_l_shipdate#3956,cl_quantity#3957,cl_extendedprice#3958,cl_discount#3959,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#4002 AS rid_0#4035, cpfk_orders_lineitem#4003 AS cpfk_orders_lineitem_0#4036, cpfk_supplier_lineitem#4004 AS cpfk_supplier_lineitem_0#4037, cfpk_lineitem_supplier#4005 AS cfpk_lineitem_supplier_0#4038, cfpk_lineitem_partsupp#4006 AS cfpk_lineitem_partsupp_0#4039, cpfk_part_lineitem#4007 AS cpfk_part_lineitem_0#4040, cfpk_lineitem_part#4008 AS cfpk_lineitem_part_0#4041, cpfk_partsupp_lineitem#4009 AS cpfk_partsupp_lineitem_0#4042, cfpk_lineitem_orders#4010 AS cfpk_lineitem_orders_0#4043, cval_lineitem_l_quantity#4011 AS cval_lineitem_l_quantity_0#4044, cval_lineitem_l_extendedprice#4012 AS cval_lineitem_l_extendedprice_0#4045, cval_lineitem_l_discount#4013 AS cval_lineitem_l_discount_0#4046, cval_lineitem_l_tax#4014 AS cval_lineitem_l_tax_0#4047, cval_lineitem_l_returnflag#4015 AS cval_lineitem_l_returnflag_0#4048, cval_lineitem_l_linestatus#4016 AS cval_lineitem_l_linestatus_0#4049, cval_lineitem_l_commitdate#4017 AS cval_lineitem_l_commitdate_0#4050, cval_lineitem_l_receiptdate#4018 AS cval_lineitem_l_receiptdate_0#4051, cval_lineitem_l_shipinstruct#4019 AS cval_lineitem_l_shipinstruct_0#4052, cval_lineitem_l_shipmode#4020 AS cval_lineitem_l_shipmode_0#4053, cval_lineitem_l_comment#4021 AS cval_lineitem_l_comment_0#4054, cval_lineitem_l_shipdate#4022 AS cval_lineitem_l_shipdate_0#4055, cl_quantity#4023 AS cl_quantity_0#4056, cl_extendedprice#4024 AS cl_extendedprice_0#4057, cl_discount#4025 AS cl_discount_0#4058, ... 9 more fields]
            :     :     :        +- Relation[rid#4002,cpfk_orders_lineitem#4003,cpfk_supplier_lineitem#4004,cfpk_lineitem_supplier#4005,cfpk_lineitem_partsupp#4006,cpfk_part_lineitem#4007,cfpk_lineitem_part#4008,cpfk_partsupp_lineitem#4009,cfpk_lineitem_orders#4010,cval_lineitem_l_quantity#4011,cval_lineitem_l_extendedprice#4012,cval_lineitem_l_discount#4013,cval_lineitem_l_tax#4014,cval_lineitem_l_returnflag#4015,cval_lineitem_l_linestatus#4016,cval_lineitem_l_commitdate#4017,cval_lineitem_l_receiptdate#4018,cval_lineitem_l_shipinstruct#4019,cval_lineitem_l_shipmode#4020,cval_lineitem_l_comment#4021,cval_lineitem_l_shipdate#4022,cl_quantity#4023,cl_extendedprice#4024,cl_discount#4025,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#4068 AS rid_1#4085, cpfk_customer_orders#4069 AS cpfk_customer_orders_1#4086, cfpk_orders_customer#4070 AS cfpk_orders_customer_1#4087, cval_orders_o_orderstatus#4071 AS cval_orders_o_orderstatus_1#4088, cval_orders_o_totalprice#4072 AS cval_orders_o_totalprice_1#4089, cval_orders_o_orderpriority#4073 AS cval_orders_o_orderpriority_1#4090, cval_orders_o_clerk#4074 AS cval_orders_o_clerk_1#4091, cval_orders_o_shippriority#4075 AS cval_orders_o_shippriority_1#4092, cval_orders_o_comment#4076 AS cval_orders_o_comment_1#4093, cval_orders_o_orderdate#4077 AS cval_orders_o_orderdate_1#4094, co_orderstatus#4078 AS co_orderstatus_1#4095, co_totalprice#4079 AS co_totalprice_1#4096, co_orderpriority#4080 AS co_orderpriority_1#4097, co_clerk#4081 AS co_clerk_1#4098, co_shippriority#4082 AS co_shippriority_1#4099, co_comment#4083 AS co_comment_1#4100, co_orderdate#4084 AS co_orderdate_1#4101]
            :     :        +- Relation[rid#4068,cpfk_customer_orders#4069,cfpk_orders_customer#4070,cval_orders_o_orderstatus#4071,cval_orders_o_totalprice#4072,cval_orders_o_orderpriority#4073,cval_orders_o_clerk#4074,cval_orders_o_shippriority#4075,cval_orders_o_comment#4076,cval_orders_o_orderdate#4077,co_orderstatus#4078,co_totalprice#4079,co_orderpriority#4080,co_clerk#4081,co_shippriority#4082,co_comment#4083,co_orderdate#4084] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#4102 AS rid_2#4117, cpfk_nation_customer#4103 AS cpfk_nation_customer_2#4118, cfpk_customer_nation#4104 AS cfpk_customer_nation_2#4119, cval_customer_c_name#4105 AS cval_customer_c_name_2#4120, cval_customer_c_address#4106 AS cval_customer_c_address_2#4121, cval_customer_c_phone#4107 AS cval_customer_c_phone_2#4122, cval_customer_c_acctbal#4108 AS cval_customer_c_acctbal_2#4123, cval_customer_c_comment#4109 AS cval_customer_c_comment_2#4124, cval_customer_c_mktsegment#4110 AS cval_customer_c_mktsegment_2#4125, cc_name#4111 AS cc_name_2#4126, cc_address#4112 AS cc_address_2#4127, cc_phone#4113 AS cc_phone_2#4128, cc_acctbal#4114 AS cc_acctbal_2#4129, cc_comment#4115 AS cc_comment_2#4130, cc_mktsegment#4116 AS cc_mktsegment_2#4131]
            :        +- Relation[rid#4102,cpfk_nation_customer#4103,cfpk_customer_nation#4104,cval_customer_c_name#4105,cval_customer_c_address#4106,cval_customer_c_phone#4107,cval_customer_c_acctbal#4108,cval_customer_c_comment#4109,cval_customer_c_mktsegment#4110,cc_name#4111,cc_address#4112,cc_phone#4113,cc_acctbal#4114,cc_comment#4115,cc_mktsegment#4116] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#4132 AS rid_3#4139, cpfk_region_nation#4133 AS cpfk_region_nation_3#4140, cfpk_nation_region#4134 AS cfpk_nation_region_3#4141, cval_nation_n_name#4135 AS cval_nation_n_name_3#4142, cval_nation_n_comment#4136 AS cval_nation_n_comment_3#4143, cn_name#4137 AS cn_name_3#4144, cn_comment#4138 AS cn_comment_3#4145]
               +- Relation[rid#4132,cpfk_region_nation#4133,cfpk_nation_region#4134,cval_nation_n_name#4135,cval_nation_n_comment#4136,cn_name#4137,cn_comment#4138] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 67244ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/15 14:45:30 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:45:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4223L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 14:45:30 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 14:45:30 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 14:45:30 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 14:45:30 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 14:45:30 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 14:45:30 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 14:45:30 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 14:45:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4223L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#4225 AS rid_0#4242, cval_part_p_name#4226 AS cval_part_p_name_0#4243, cval_part_p_mfgr#4227 AS cval_part_p_mfgr_0#4244, cval_part_p_type#4228 AS cval_part_p_type_0#4245, cval_part_p_size#4229 AS cval_part_p_size_0#4246, cval_part_p_container#4230 AS cval_part_p_container_0#4247, cval_part_p_retailprice#4231 AS cval_part_p_retailprice_0#4248, cval_part_p_comment#4232 AS cval_part_p_comment_0#4249, cval_part_p_brand#4233 AS cval_part_p_brand_0#4250, cp_name#4234 AS cp_name_0#4251, cp_mfgr#4235 AS cp_mfgr_0#4252, cp_type#4236 AS cp_type_0#4253, cp_size#4237 AS cp_size_0#4254, cp_container#4238 AS cp_container_0#4255, cp_retailprice#4239 AS cp_retailprice_0#4256, cp_comment#4240 AS cp_comment_0#4257, cp_brand#4241 AS cp_brand_0#4258]
         :  :  :  :  +- Relation[rid#4225,cval_part_p_name#4226,cval_part_p_mfgr#4227,cval_part_p_type#4228,cval_part_p_size#4229,cval_part_p_container#4230,cval_part_p_retailprice#4231,cval_part_p_comment#4232,cval_part_p_brand#4233,cp_name#4234,cp_mfgr#4235,cp_type#4236,cp_size#4237,cp_container#4238,cp_retailprice#4239,cp_comment#4240,cp_brand#4241] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#4259 AS rid_0#4276, cval_part_p_name#4260 AS cval_part_p_name_0#4277, cval_part_p_mfgr#4261 AS cval_part_p_mfgr_0#4278, cval_part_p_type#4262 AS cval_part_p_type_0#4279, cval_part_p_size#4263 AS cval_part_p_size_0#4280, cval_part_p_container#4264 AS cval_part_p_container_0#4281, cval_part_p_retailprice#4265 AS cval_part_p_retailprice_0#4282, cval_part_p_comment#4266 AS cval_part_p_comment_0#4283, cval_part_p_brand#4267 AS cval_part_p_brand_0#4284, cp_name#4268 AS cp_name_0#4285, cp_mfgr#4269 AS cp_mfgr_0#4286, cp_type#4270 AS cp_type_0#4287, cp_size#4271 AS cp_size_0#4288, cp_container#4272 AS cp_container_0#4289, cp_retailprice#4273 AS cp_retailprice_0#4290, cp_comment#4274 AS cp_comment_0#4291, cp_brand#4275 AS cp_brand_0#4292]
         :  :  :        +- Relation[rid#4259,cval_part_p_name#4260,cval_part_p_mfgr#4261,cval_part_p_type#4262,cval_part_p_size#4263,cval_part_p_container#4264,cval_part_p_retailprice#4265,cval_part_p_comment#4266,cval_part_p_brand#4267,cp_name#4268,cp_mfgr#4269,cp_type#4270,cp_size#4271,cp_container#4272,cp_retailprice#4273,cp_comment#4274,cp_brand#4275] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#4293 AS rid_0#4310, cval_part_p_name#4294 AS cval_part_p_name_0#4311, cval_part_p_mfgr#4295 AS cval_part_p_mfgr_0#4312, cval_part_p_type#4296 AS cval_part_p_type_0#4313, cval_part_p_size#4297 AS cval_part_p_size_0#4314, cval_part_p_container#4298 AS cval_part_p_container_0#4315, cval_part_p_retailprice#4299 AS cval_part_p_retailprice_0#4316, cval_part_p_comment#4300 AS cval_part_p_comment_0#4317, cval_part_p_brand#4301 AS cval_part_p_brand_0#4318, cp_name#4302 AS cp_name_0#4319, cp_mfgr#4303 AS cp_mfgr_0#4320, cp_type#4304 AS cp_type_0#4321, cp_size#4305 AS cp_size_0#4322, cp_container#4306 AS cp_container_0#4323, cp_retailprice#4307 AS cp_retailprice_0#4324, cp_comment#4308 AS cp_comment_0#4325, cp_brand#4309 AS cp_brand_0#4326]
         :  :        +- Relation[rid#4293,cval_part_p_name#4294,cval_part_p_mfgr#4295,cval_part_p_type#4296,cval_part_p_size#4297,cval_part_p_container#4298,cval_part_p_retailprice#4299,cval_part_p_comment#4300,cval_part_p_brand#4301,cp_name#4302,cp_mfgr#4303,cp_type#4304,cp_size#4305,cp_container#4306,cp_retailprice#4307,cp_comment#4308,cp_brand#4309] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#4559 AS rid_1#4592, cpfk_orders_lineitem#4560 AS cpfk_orders_lineitem_1#4593, cpfk_supplier_lineitem#4561 AS cpfk_supplier_lineitem_1#4594, cfpk_lineitem_supplier#4562 AS cfpk_lineitem_supplier_1#4595, cfpk_lineitem_partsupp#4563 AS cfpk_lineitem_partsupp_1#4596, cpfk_part_lineitem#4564 AS cpfk_part_lineitem_1#4597, cfpk_lineitem_part#4565 AS cfpk_lineitem_part_1#4598, cpfk_partsupp_lineitem#4566 AS cpfk_partsupp_lineitem_1#4599, cfpk_lineitem_orders#4567 AS cfpk_lineitem_orders_1#4600, cval_lineitem_l_quantity#4568 AS cval_lineitem_l_quantity_1#4601, cval_lineitem_l_extendedprice#4569 AS cval_lineitem_l_extendedprice_1#4602, cval_lineitem_l_discount#4570 AS cval_lineitem_l_discount_1#4603, cval_lineitem_l_tax#4571 AS cval_lineitem_l_tax_1#4604, cval_lineitem_l_returnflag#4572 AS cval_lineitem_l_returnflag_1#4605, cval_lineitem_l_linestatus#4573 AS cval_lineitem_l_linestatus_1#4606, cval_lineitem_l_commitdate#4574 AS cval_lineitem_l_commitdate_1#4607, cval_lineitem_l_receiptdate#4575 AS cval_lineitem_l_receiptdate_1#4608, cval_lineitem_l_shipinstruct#4576 AS cval_lineitem_l_shipinstruct_1#4609, cval_lineitem_l_shipmode#4577 AS cval_lineitem_l_shipmode_1#4610, cval_lineitem_l_comment#4578 AS cval_lineitem_l_comment_1#4611, cval_lineitem_l_shipdate#4579 AS cval_lineitem_l_shipdate_1#4612, cl_quantity#4580 AS cl_quantity_1#4613, cl_extendedprice#4581 AS cl_extendedprice_1#4614, cl_discount#4582 AS cl_discount_1#4615, ... 9 more fields]
         :     +- Relation[rid#4559,cpfk_orders_lineitem#4560,cpfk_supplier_lineitem#4561,cfpk_lineitem_supplier#4562,cfpk_lineitem_partsupp#4563,cpfk_part_lineitem#4564,cfpk_lineitem_part#4565,cpfk_partsupp_lineitem#4566,cfpk_lineitem_orders#4567,cval_lineitem_l_quantity#4568,cval_lineitem_l_extendedprice#4569,cval_lineitem_l_discount#4570,cval_lineitem_l_tax#4571,cval_lineitem_l_returnflag#4572,cval_lineitem_l_linestatus#4573,cval_lineitem_l_commitdate#4574,cval_lineitem_l_receiptdate#4575,cval_lineitem_l_shipinstruct#4576,cval_lineitem_l_shipmode#4577,cval_lineitem_l_comment#4578,cval_lineitem_l_shipdate#4579,cl_quantity#4580,cl_extendedprice#4581,cl_discount#4582,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#4327 AS rid_1#4360, cpfk_orders_lineitem#4328 AS cpfk_orders_lineitem_1#4361, cpfk_supplier_lineitem#4329 AS cpfk_supplier_lineitem_1#4362, cfpk_lineitem_supplier#4330 AS cfpk_lineitem_supplier_1#4363, cfpk_lineitem_partsupp#4331 AS cfpk_lineitem_partsupp_1#4364, cpfk_part_lineitem#4332 AS cpfk_part_lineitem_1#4365, cfpk_lineitem_part#4333 AS cfpk_lineitem_part_1#4366, cpfk_partsupp_lineitem#4334 AS cpfk_partsupp_lineitem_1#4367, cfpk_lineitem_orders#4335 AS cfpk_lineitem_orders_1#4368, cval_lineitem_l_quantity#4336 AS cval_lineitem_l_quantity_1#4369, cval_lineitem_l_extendedprice#4337 AS cval_lineitem_l_extendedprice_1#4370, cval_lineitem_l_discount#4338 AS cval_lineitem_l_discount_1#4371, cval_lineitem_l_tax#4339 AS cval_lineitem_l_tax_1#4372, cval_lineitem_l_returnflag#4340 AS cval_lineitem_l_returnflag_1#4373, cval_lineitem_l_linestatus#4341 AS cval_lineitem_l_linestatus_1#4374, cval_lineitem_l_commitdate#4342 AS cval_lineitem_l_commitdate_1#4375, cval_lineitem_l_receiptdate#4343 AS cval_lineitem_l_receiptdate_1#4376, cval_lineitem_l_shipinstruct#4344 AS cval_lineitem_l_shipinstruct_1#4377, cval_lineitem_l_shipmode#4345 AS cval_lineitem_l_shipmode_1#4378, cval_lineitem_l_comment#4346 AS cval_lineitem_l_comment_1#4379, cval_lineitem_l_shipdate#4347 AS cval_lineitem_l_shipdate_1#4380, cl_quantity#4348 AS cl_quantity_1#4381, cl_extendedprice#4349 AS cl_extendedprice_1#4382, cl_discount#4350 AS cl_discount_1#4383, ... 9 more fields]
            :  :  +- Relation[rid#4327,cpfk_orders_lineitem#4328,cpfk_supplier_lineitem#4329,cfpk_lineitem_supplier#4330,cfpk_lineitem_partsupp#4331,cpfk_part_lineitem#4332,cfpk_lineitem_part#4333,cpfk_partsupp_lineitem#4334,cfpk_lineitem_orders#4335,cval_lineitem_l_quantity#4336,cval_lineitem_l_extendedprice#4337,cval_lineitem_l_discount#4338,cval_lineitem_l_tax#4339,cval_lineitem_l_returnflag#4340,cval_lineitem_l_linestatus#4341,cval_lineitem_l_commitdate#4342,cval_lineitem_l_receiptdate#4343,cval_lineitem_l_shipinstruct#4344,cval_lineitem_l_shipmode#4345,cval_lineitem_l_comment#4346,cval_lineitem_l_shipdate#4347,cl_quantity#4348,cl_extendedprice#4349,cl_discount#4350,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#4393 AS rid_1#4426, cpfk_orders_lineitem#4394 AS cpfk_orders_lineitem_1#4427, cpfk_supplier_lineitem#4395 AS cpfk_supplier_lineitem_1#4428, cfpk_lineitem_supplier#4396 AS cfpk_lineitem_supplier_1#4429, cfpk_lineitem_partsupp#4397 AS cfpk_lineitem_partsupp_1#4430, cpfk_part_lineitem#4398 AS cpfk_part_lineitem_1#4431, cfpk_lineitem_part#4399 AS cfpk_lineitem_part_1#4432, cpfk_partsupp_lineitem#4400 AS cpfk_partsupp_lineitem_1#4433, cfpk_lineitem_orders#4401 AS cfpk_lineitem_orders_1#4434, cval_lineitem_l_quantity#4402 AS cval_lineitem_l_quantity_1#4435, cval_lineitem_l_extendedprice#4403 AS cval_lineitem_l_extendedprice_1#4436, cval_lineitem_l_discount#4404 AS cval_lineitem_l_discount_1#4437, cval_lineitem_l_tax#4405 AS cval_lineitem_l_tax_1#4438, cval_lineitem_l_returnflag#4406 AS cval_lineitem_l_returnflag_1#4439, cval_lineitem_l_linestatus#4407 AS cval_lineitem_l_linestatus_1#4440, cval_lineitem_l_commitdate#4408 AS cval_lineitem_l_commitdate_1#4441, cval_lineitem_l_receiptdate#4409 AS cval_lineitem_l_receiptdate_1#4442, cval_lineitem_l_shipinstruct#4410 AS cval_lineitem_l_shipinstruct_1#4443, cval_lineitem_l_shipmode#4411 AS cval_lineitem_l_shipmode_1#4444, cval_lineitem_l_comment#4412 AS cval_lineitem_l_comment_1#4445, cval_lineitem_l_shipdate#4413 AS cval_lineitem_l_shipdate_1#4446, cl_quantity#4414 AS cl_quantity_1#4447, cl_extendedprice#4415 AS cl_extendedprice_1#4448, cl_discount#4416 AS cl_discount_1#4449, ... 9 more fields]
            :        +- Relation[rid#4393,cpfk_orders_lineitem#4394,cpfk_supplier_lineitem#4395,cfpk_lineitem_supplier#4396,cfpk_lineitem_partsupp#4397,cpfk_part_lineitem#4398,cfpk_lineitem_part#4399,cpfk_partsupp_lineitem#4400,cfpk_lineitem_orders#4401,cval_lineitem_l_quantity#4402,cval_lineitem_l_extendedprice#4403,cval_lineitem_l_discount#4404,cval_lineitem_l_tax#4405,cval_lineitem_l_returnflag#4406,cval_lineitem_l_linestatus#4407,cval_lineitem_l_commitdate#4408,cval_lineitem_l_receiptdate#4409,cval_lineitem_l_shipinstruct#4410,cval_lineitem_l_shipmode#4411,cval_lineitem_l_comment#4412,cval_lineitem_l_shipdate#4413,cl_quantity#4414,cl_extendedprice#4415,cl_discount#4416,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#4459 AS rid_1#4492, cpfk_orders_lineitem#4460 AS cpfk_orders_lineitem_1#4493, cpfk_supplier_lineitem#4461 AS cpfk_supplier_lineitem_1#4494, cfpk_lineitem_supplier#4462 AS cfpk_lineitem_supplier_1#4495, cfpk_lineitem_partsupp#4463 AS cfpk_lineitem_partsupp_1#4496, cpfk_part_lineitem#4464 AS cpfk_part_lineitem_1#4497, cfpk_lineitem_part#4465 AS cfpk_lineitem_part_1#4498, cpfk_partsupp_lineitem#4466 AS cpfk_partsupp_lineitem_1#4499, cfpk_lineitem_orders#4467 AS cfpk_lineitem_orders_1#4500, cval_lineitem_l_quantity#4468 AS cval_lineitem_l_quantity_1#4501, cval_lineitem_l_extendedprice#4469 AS cval_lineitem_l_extendedprice_1#4502, cval_lineitem_l_discount#4470 AS cval_lineitem_l_discount_1#4503, cval_lineitem_l_tax#4471 AS cval_lineitem_l_tax_1#4504, cval_lineitem_l_returnflag#4472 AS cval_lineitem_l_returnflag_1#4505, cval_lineitem_l_linestatus#4473 AS cval_lineitem_l_linestatus_1#4506, cval_lineitem_l_commitdate#4474 AS cval_lineitem_l_commitdate_1#4507, cval_lineitem_l_receiptdate#4475 AS cval_lineitem_l_receiptdate_1#4508, cval_lineitem_l_shipinstruct#4476 AS cval_lineitem_l_shipinstruct_1#4509, cval_lineitem_l_shipmode#4477 AS cval_lineitem_l_shipmode_1#4510, cval_lineitem_l_comment#4478 AS cval_lineitem_l_comment_1#4511, cval_lineitem_l_shipdate#4479 AS cval_lineitem_l_shipdate_1#4512, cl_quantity#4480 AS cl_quantity_1#4513, cl_extendedprice#4481 AS cl_extendedprice_1#4514, cl_discount#4482 AS cl_discount_1#4515, ... 9 more fields]
                  +- Relation[rid#4459,cpfk_orders_lineitem#4460,cpfk_supplier_lineitem#4461,cfpk_lineitem_supplier#4462,cfpk_lineitem_partsupp#4463,cpfk_part_lineitem#4464,cfpk_lineitem_part#4465,cpfk_partsupp_lineitem#4466,cfpk_lineitem_orders#4467,cval_lineitem_l_quantity#4468,cval_lineitem_l_extendedprice#4469,cval_lineitem_l_discount#4470,cval_lineitem_l_tax#4471,cval_lineitem_l_returnflag#4472,cval_lineitem_l_linestatus#4473,cval_lineitem_l_commitdate#4474,cval_lineitem_l_receiptdate#4475,cval_lineitem_l_shipinstruct#4476,cval_lineitem_l_shipmode#4477,cval_lineitem_l_comment#4478,cval_lineitem_l_shipdate#4479,cl_quantity#4480,cl_extendedprice#4481,cl_discount#4482,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=13
Elapsed time: 64281ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/15 14:46:34 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:46:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4682L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 14:46:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:46:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:46:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:46:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4682L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#4684 AS rid_0#4701, cval_part_p_name#4685 AS cval_part_p_name_0#4702, cval_part_p_mfgr#4686 AS cval_part_p_mfgr_0#4703, cval_part_p_type#4687 AS cval_part_p_type_0#4704, cval_part_p_size#4688 AS cval_part_p_size_0#4705, cval_part_p_container#4689 AS cval_part_p_container_0#4706, cval_part_p_retailprice#4690 AS cval_part_p_retailprice_0#4707, cval_part_p_comment#4691 AS cval_part_p_comment_0#4708, cval_part_p_brand#4692 AS cval_part_p_brand_0#4709, cp_name#4693 AS cp_name_0#4710, cp_mfgr#4694 AS cp_mfgr_0#4711, cp_type#4695 AS cp_type_0#4712, cp_size#4696 AS cp_size_0#4713, cp_container#4697 AS cp_container_0#4714, cp_retailprice#4698 AS cp_retailprice_0#4715, cp_comment#4699 AS cp_comment_0#4716, cp_brand#4700 AS cp_brand_0#4717]
         :  :  :  +- Relation[rid#4684,cval_part_p_name#4685,cval_part_p_mfgr#4686,cval_part_p_type#4687,cval_part_p_size#4688,cval_part_p_container#4689,cval_part_p_retailprice#4690,cval_part_p_comment#4691,cval_part_p_brand#4692,cp_name#4693,cp_mfgr#4694,cp_type#4695,cp_size#4696,cp_container#4697,cp_retailprice#4698,cp_comment#4699,cp_brand#4700] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#4718 AS rid_0#4735, cval_part_p_name#4719 AS cval_part_p_name_0#4736, cval_part_p_mfgr#4720 AS cval_part_p_mfgr_0#4737, cval_part_p_type#4721 AS cval_part_p_type_0#4738, cval_part_p_size#4722 AS cval_part_p_size_0#4739, cval_part_p_container#4723 AS cval_part_p_container_0#4740, cval_part_p_retailprice#4724 AS cval_part_p_retailprice_0#4741, cval_part_p_comment#4725 AS cval_part_p_comment_0#4742, cval_part_p_brand#4726 AS cval_part_p_brand_0#4743, cp_name#4727 AS cp_name_0#4744, cp_mfgr#4728 AS cp_mfgr_0#4745, cp_type#4729 AS cp_type_0#4746, cp_size#4730 AS cp_size_0#4747, cp_container#4731 AS cp_container_0#4748, cp_retailprice#4732 AS cp_retailprice_0#4749, cp_comment#4733 AS cp_comment_0#4750, cp_brand#4734 AS cp_brand_0#4751]
         :  :        +- Relation[rid#4718,cval_part_p_name#4719,cval_part_p_mfgr#4720,cval_part_p_type#4721,cval_part_p_size#4722,cval_part_p_container#4723,cval_part_p_retailprice#4724,cval_part_p_comment#4725,cval_part_p_brand#4726,cp_name#4727,cp_mfgr#4728,cp_type#4729,cp_size#4730,cp_container#4731,cp_retailprice#4732,cp_comment#4733,cp_brand#4734] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#4808 AS rid_1#4819, cpfk_part_partsupp#4809 AS cpfk_part_partsupp_1#4820, cfpk_partsupp_part#4810 AS cfpk_partsupp_part_1#4821, cpfk_supplier_partsupp#4811 AS cpfk_supplier_partsupp_1#4822, cfpk_partsupp_supplier#4812 AS cfpk_partsupp_supplier_1#4823, cval_partsupp_ps_availqty#4813 AS cval_partsupp_ps_availqty_1#4824, cval_partsupp_ps_supplycost#4814 AS cval_partsupp_ps_supplycost_1#4825, cval_partsupp_ps_comment#4815 AS cval_partsupp_ps_comment_1#4826, cps_availqty#4816 AS cps_availqty_1#4827, cps_supplycost#4817 AS cps_supplycost_1#4828, cps_comment#4818 AS cps_comment_1#4829]
         :     +- Relation[rid#4808,cpfk_part_partsupp#4809,cfpk_partsupp_part#4810,cpfk_supplier_partsupp#4811,cfpk_partsupp_supplier#4812,cval_partsupp_ps_availqty#4813,cval_partsupp_ps_supplycost#4814,cval_partsupp_ps_comment#4815,cps_availqty#4816,cps_supplycost#4817,cps_comment#4818] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#4752 AS rid_1#4763, cpfk_part_partsupp#4753 AS cpfk_part_partsupp_1#4764, cfpk_partsupp_part#4754 AS cfpk_partsupp_part_1#4765, cpfk_supplier_partsupp#4755 AS cpfk_supplier_partsupp_1#4766, cfpk_partsupp_supplier#4756 AS cfpk_partsupp_supplier_1#4767, cval_partsupp_ps_availqty#4757 AS cval_partsupp_ps_availqty_1#4768, cval_partsupp_ps_supplycost#4758 AS cval_partsupp_ps_supplycost_1#4769, cval_partsupp_ps_comment#4759 AS cval_partsupp_ps_comment_1#4770, cps_availqty#4760 AS cps_availqty_1#4771, cps_supplycost#4761 AS cps_supplycost_1#4772, cps_comment#4762 AS cps_comment_1#4773]
            +- Relation[rid#4752,cpfk_part_partsupp#4753,cfpk_partsupp_part#4754,cpfk_supplier_partsupp#4755,cfpk_partsupp_supplier#4756,cval_partsupp_ps_availqty#4757,cval_partsupp_ps_supplycost#4758,cval_partsupp_ps_comment#4759,cps_availqty#4760,cps_supplycost#4761,cps_comment#4762] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=7890
Elapsed time: 1445ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/15 14:46:35 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:46:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4864L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 14:46:35 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 14:46:35 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 14:46:35 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 14:46:35 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:36 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 14:46:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:36 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 14:46:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:46:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:46:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:46:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:46:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4864L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#4866 AS rid_0#4871, cval_region_r_name#4867 AS cval_region_r_name_0#4872, cval_region_r_comment#4868 AS cval_region_r_comment_0#4873, cr_name#4869 AS cr_name_0#4874, cr_comment#4870 AS cr_comment_0#4875]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#4866,cval_region_r_name#4867,cval_region_r_comment#4868,cr_name#4869,cr_comment#4870] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#4876 AS rid_0#4881, cval_region_r_name#4877 AS cval_region_r_name_0#4882, cval_region_r_comment#4878 AS cval_region_r_comment_0#4883, cr_name#4879 AS cr_name_0#4884, cr_comment#4880 AS cr_comment_0#4885]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#4876,cval_region_r_name#4877,cval_region_r_comment#4878,cr_name#4879,cr_comment#4880] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- Project [rid#4910 AS rid_1#4917, cpfk_region_nation#4911 AS cpfk_region_nation_1#4918, cfpk_nation_region#4912 AS cfpk_nation_region_1#4919, cval_nation_n_name#4913 AS cval_nation_n_name_1#4920, cval_nation_n_comment#4914 AS cval_nation_n_comment_1#4921, cn_name#4915 AS cn_name_1#4922, cn_comment#4916 AS cn_comment_1#4923]
         :     :  :  :  :  :  :  :  :     +- Relation[rid#4910,cpfk_region_nation#4911,cfpk_nation_region#4912,cval_nation_n_name#4913,cval_nation_n_comment#4914,cn_name#4915,cn_comment#4916] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#4886 AS rid_1#4893, cpfk_region_nation#4887 AS cpfk_region_nation_1#4894, cfpk_nation_region#4888 AS cfpk_nation_region_1#4895, cval_nation_n_name#4889 AS cval_nation_n_name_1#4896, cval_nation_n_comment#4890 AS cval_nation_n_comment_1#4897, cn_name#4891 AS cn_name_1#4898, cn_comment#4892 AS cn_comment_1#4899]
         :     :  :  :  :  :  :  :     +- Relation[rid#4886,cpfk_region_nation#4887,cfpk_nation_region#4888,cval_nation_n_name#4889,cval_nation_n_comment#4890,cn_name#4891,cn_comment#4892] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- Project [rid#4968 AS rid_2#4983, cpfk_nation_customer#4969 AS cpfk_nation_customer_2#4984, cfpk_customer_nation#4970 AS cfpk_customer_nation_2#4985, cval_customer_c_name#4971 AS cval_customer_c_name_2#4986, cval_customer_c_address#4972 AS cval_customer_c_address_2#4987, cval_customer_c_phone#4973 AS cval_customer_c_phone_2#4988, cval_customer_c_acctbal#4974 AS cval_customer_c_acctbal_2#4989, cval_customer_c_comment#4975 AS cval_customer_c_comment_2#4990, cval_customer_c_mktsegment#4976 AS cval_customer_c_mktsegment_2#4991, cc_name#4977 AS cc_name_2#4992, cc_address#4978 AS cc_address_2#4993, cc_phone#4979 AS cc_phone_2#4994, cc_acctbal#4980 AS cc_acctbal_2#4995, cc_comment#4981 AS cc_comment_2#4996, cc_mktsegment#4982 AS cc_mktsegment_2#4997]
         :     :  :  :  :  :  :     +- Relation[rid#4968,cpfk_nation_customer#4969,cfpk_customer_nation#4970,cval_customer_c_name#4971,cval_customer_c_address#4972,cval_customer_c_phone#4973,cval_customer_c_acctbal#4974,cval_customer_c_comment#4975,cval_customer_c_mktsegment#4976,cc_name#4977,cc_address#4978,cc_phone#4979,cc_acctbal#4980,cc_comment#4981,cc_mktsegment#4982] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#4924 AS rid_2#4939, cpfk_nation_customer#4925 AS cpfk_nation_customer_2#4940, cfpk_customer_nation#4926 AS cfpk_customer_nation_2#4941, cval_customer_c_name#4927 AS cval_customer_c_name_2#4942, cval_customer_c_address#4928 AS cval_customer_c_address_2#4943, cval_customer_c_phone#4929 AS cval_customer_c_phone_2#4944, cval_customer_c_acctbal#4930 AS cval_customer_c_acctbal_2#4945, cval_customer_c_comment#4931 AS cval_customer_c_comment_2#4946, cval_customer_c_mktsegment#4932 AS cval_customer_c_mktsegment_2#4947, cc_name#4933 AS cc_name_2#4948, cc_address#4934 AS cc_address_2#4949, cc_phone#4935 AS cc_phone_2#4950, cc_acctbal#4936 AS cc_acctbal_2#4951, cc_comment#4937 AS cc_comment_2#4952, cc_mktsegment#4938 AS cc_mktsegment_2#4953]
         :     :  :  :  :  :     +- Relation[rid#4924,cpfk_nation_customer#4925,cfpk_customer_nation#4926,cval_customer_c_name#4927,cval_customer_c_address#4928,cval_customer_c_phone#4929,cval_customer_c_acctbal#4930,cval_customer_c_comment#4931,cval_customer_c_mktsegment#4932,cc_name#4933,cc_address#4934,cc_phone#4935,cc_acctbal#4936,cc_comment#4937,cc_mktsegment#4938] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- Project [rid#5062 AS rid_3#5079, cpfk_customer_orders#5063 AS cpfk_customer_orders_3#5080, cfpk_orders_customer#5064 AS cfpk_orders_customer_3#5081, cval_orders_o_orderstatus#5065 AS cval_orders_o_orderstatus_3#5082, cval_orders_o_totalprice#5066 AS cval_orders_o_totalprice_3#5083, cval_orders_o_orderpriority#5067 AS cval_orders_o_orderpriority_3#5084, cval_orders_o_clerk#5068 AS cval_orders_o_clerk_3#5085, cval_orders_o_shippriority#5069 AS cval_orders_o_shippriority_3#5086, cval_orders_o_comment#5070 AS cval_orders_o_comment_3#5087, cval_orders_o_orderdate#5071 AS cval_orders_o_orderdate_3#5088, co_orderstatus#5072 AS co_orderstatus_3#5089, co_totalprice#5073 AS co_totalprice_3#5090, co_orderpriority#5074 AS co_orderpriority_3#5091, co_clerk#5075 AS co_clerk_3#5092, co_shippriority#5076 AS co_shippriority_3#5093, co_comment#5077 AS co_comment_3#5094, co_orderdate#5078 AS co_orderdate_3#5095]
         :     :  :  :  :     +- Relation[rid#5062,cpfk_customer_orders#5063,cfpk_orders_customer#5064,cval_orders_o_orderstatus#5065,cval_orders_o_totalprice#5066,cval_orders_o_orderpriority#5067,cval_orders_o_clerk#5068,cval_orders_o_shippriority#5069,cval_orders_o_comment#5070,cval_orders_o_orderdate#5071,co_orderstatus#5072,co_totalprice#5073,co_orderpriority#5074,co_clerk#5075,co_shippriority#5076,co_comment#5077,co_orderdate#5078] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#4998 AS rid_3#5015, cpfk_customer_orders#4999 AS cpfk_customer_orders_3#5016, cfpk_orders_customer#5000 AS cfpk_orders_customer_3#5017, cval_orders_o_orderstatus#5001 AS cval_orders_o_orderstatus_3#5018, cval_orders_o_totalprice#5002 AS cval_orders_o_totalprice_3#5019, cval_orders_o_orderpriority#5003 AS cval_orders_o_orderpriority_3#5020, cval_orders_o_clerk#5004 AS cval_orders_o_clerk_3#5021, cval_orders_o_shippriority#5005 AS cval_orders_o_shippriority_3#5022, cval_orders_o_comment#5006 AS cval_orders_o_comment_3#5023, cval_orders_o_orderdate#5007 AS cval_orders_o_orderdate_3#5024, co_orderstatus#5008 AS co_orderstatus_3#5025, co_totalprice#5009 AS co_totalprice_3#5026, co_orderpriority#5010 AS co_orderpriority_3#5027, co_clerk#5011 AS co_clerk_3#5028, co_shippriority#5012 AS co_shippriority_3#5029, co_comment#5013 AS co_comment_3#5030, co_orderdate#5014 AS co_orderdate_3#5031]
         :     :  :  :     +- Relation[rid#4998,cpfk_customer_orders#4999,cfpk_orders_customer#5000,cval_orders_o_orderstatus#5001,cval_orders_o_totalprice#5002,cval_orders_o_orderpriority#5003,cval_orders_o_clerk#5004,cval_orders_o_shippriority#5005,cval_orders_o_comment#5006,cval_orders_o_orderdate#5007,co_orderstatus#5008,co_totalprice#5009,co_orderpriority#5010,co_clerk#5011,co_shippriority#5012,co_comment#5013,co_orderdate#5014] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- Project [rid#5196 AS rid_4#5229, cpfk_orders_lineitem#5197 AS cpfk_orders_lineitem_4#5230, cpfk_supplier_lineitem#5198 AS cpfk_supplier_lineitem_4#5231, cfpk_lineitem_supplier#5199 AS cfpk_lineitem_supplier_4#5232, cfpk_lineitem_partsupp#5200 AS cfpk_lineitem_partsupp_4#5233, cpfk_part_lineitem#5201 AS cpfk_part_lineitem_4#5234, cfpk_lineitem_part#5202 AS cfpk_lineitem_part_4#5235, cpfk_partsupp_lineitem#5203 AS cpfk_partsupp_lineitem_4#5236, cfpk_lineitem_orders#5204 AS cfpk_lineitem_orders_4#5237, cval_lineitem_l_quantity#5205 AS cval_lineitem_l_quantity_4#5238, cval_lineitem_l_extendedprice#5206 AS cval_lineitem_l_extendedprice_4#5239, cval_lineitem_l_discount#5207 AS cval_lineitem_l_discount_4#5240, cval_lineitem_l_tax#5208 AS cval_lineitem_l_tax_4#5241, cval_lineitem_l_returnflag#5209 AS cval_lineitem_l_returnflag_4#5242, cval_lineitem_l_linestatus#5210 AS cval_lineitem_l_linestatus_4#5243, cval_lineitem_l_commitdate#5211 AS cval_lineitem_l_commitdate_4#5244, cval_lineitem_l_receiptdate#5212 AS cval_lineitem_l_receiptdate_4#5245, cval_lineitem_l_shipinstruct#5213 AS cval_lineitem_l_shipinstruct_4#5246, cval_lineitem_l_shipmode#5214 AS cval_lineitem_l_shipmode_4#5247, cval_lineitem_l_comment#5215 AS cval_lineitem_l_comment_4#5248, cval_lineitem_l_shipdate#5216 AS cval_lineitem_l_shipdate_4#5249, cl_quantity#5217 AS cl_quantity_4#5250, cl_extendedprice#5218 AS cl_extendedprice_4#5251, cl_discount#5219 AS cl_discount_4#5252, ... 9 more fields]
         :     :  :     +- Relation[rid#5196,cpfk_orders_lineitem#5197,cpfk_supplier_lineitem#5198,cfpk_lineitem_supplier#5199,cfpk_lineitem_partsupp#5200,cpfk_part_lineitem#5201,cfpk_lineitem_part#5202,cpfk_partsupp_lineitem#5203,cfpk_lineitem_orders#5204,cval_lineitem_l_quantity#5205,cval_lineitem_l_extendedprice#5206,cval_lineitem_l_discount#5207,cval_lineitem_l_tax#5208,cval_lineitem_l_returnflag#5209,cval_lineitem_l_linestatus#5210,cval_lineitem_l_commitdate#5211,cval_lineitem_l_receiptdate#5212,cval_lineitem_l_shipinstruct#5213,cval_lineitem_l_shipmode#5214,cval_lineitem_l_comment#5215,cval_lineitem_l_shipdate#5216,cl_quantity#5217,cl_extendedprice#5218,cl_discount#5219,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#5096 AS rid_4#5129, cpfk_orders_lineitem#5097 AS cpfk_orders_lineitem_4#5130, cpfk_supplier_lineitem#5098 AS cpfk_supplier_lineitem_4#5131, cfpk_lineitem_supplier#5099 AS cfpk_lineitem_supplier_4#5132, cfpk_lineitem_partsupp#5100 AS cfpk_lineitem_partsupp_4#5133, cpfk_part_lineitem#5101 AS cpfk_part_lineitem_4#5134, cfpk_lineitem_part#5102 AS cfpk_lineitem_part_4#5135, cpfk_partsupp_lineitem#5103 AS cpfk_partsupp_lineitem_4#5136, cfpk_lineitem_orders#5104 AS cfpk_lineitem_orders_4#5137, cval_lineitem_l_quantity#5105 AS cval_lineitem_l_quantity_4#5138, cval_lineitem_l_extendedprice#5106 AS cval_lineitem_l_extendedprice_4#5139, cval_lineitem_l_discount#5107 AS cval_lineitem_l_discount_4#5140, cval_lineitem_l_tax#5108 AS cval_lineitem_l_tax_4#5141, cval_lineitem_l_returnflag#5109 AS cval_lineitem_l_returnflag_4#5142, cval_lineitem_l_linestatus#5110 AS cval_lineitem_l_linestatus_4#5143, cval_lineitem_l_commitdate#5111 AS cval_lineitem_l_commitdate_4#5144, cval_lineitem_l_receiptdate#5112 AS cval_lineitem_l_receiptdate_4#5145, cval_lineitem_l_shipinstruct#5113 AS cval_lineitem_l_shipinstruct_4#5146, cval_lineitem_l_shipmode#5114 AS cval_lineitem_l_shipmode_4#5147, cval_lineitem_l_comment#5115 AS cval_lineitem_l_comment_4#5148, cval_lineitem_l_shipdate#5116 AS cval_lineitem_l_shipdate_4#5149, cl_quantity#5117 AS cl_quantity_4#5150, cl_extendedprice#5118 AS cl_extendedprice_4#5151, cl_discount#5119 AS cl_discount_4#5152, ... 9 more fields]
         :     :     +- Relation[rid#5096,cpfk_orders_lineitem#5097,cpfk_supplier_lineitem#5098,cfpk_lineitem_supplier#5099,cfpk_lineitem_partsupp#5100,cpfk_part_lineitem#5101,cfpk_lineitem_part#5102,cpfk_partsupp_lineitem#5103,cfpk_lineitem_orders#5104,cval_lineitem_l_quantity#5105,cval_lineitem_l_extendedprice#5106,cval_lineitem_l_discount#5107,cval_lineitem_l_tax#5108,cval_lineitem_l_returnflag#5109,cval_lineitem_l_linestatus#5110,cval_lineitem_l_commitdate#5111,cval_lineitem_l_receiptdate#5112,cval_lineitem_l_shipinstruct#5113,cval_lineitem_l_shipmode#5114,cval_lineitem_l_comment#5115,cval_lineitem_l_shipdate#5116,cl_quantity#5117,cl_extendedprice#5118,cl_discount#5119,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#5262 AS rid_5#5275, cpfk_nation_supplier#5263 AS cpfk_nation_supplier_5#5276, cfpk_supplier_nation#5264 AS cfpk_supplier_nation_5#5277, cval_supplier_s_name#5265 AS cval_supplier_s_name_5#5278, cval_supplier_s_address#5266 AS cval_supplier_s_address_5#5279, cval_supplier_s_phone#5267 AS cval_supplier_s_phone_5#5280, cval_supplier_s_acctbal#5268 AS cval_supplier_s_acctbal_5#5281, cval_supplier_s_comment#5269 AS cval_supplier_s_comment_5#5282, cs_name#5270 AS cs_name_5#5283, cs_address#5271 AS cs_address_5#5284, cs_phone#5272 AS cs_phone_5#5285, cs_acctbal#5273 AS cs_acctbal_5#5286, cs_comment#5274 AS cs_comment_5#5287]
         :        +- Relation[rid#5262,cpfk_nation_supplier#5263,cfpk_supplier_nation#5264,cval_supplier_s_name#5265,cval_supplier_s_address#5266,cval_supplier_s_phone#5267,cval_supplier_s_acctbal#5268,cval_supplier_s_comment#5269,cs_name#5270,cs_address#5271,cs_phone#5272,cs_acctbal#5273,cs_comment#5274] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#5288 AS rid_1#5295, cpfk_region_nation#5289 AS cpfk_region_nation_1#5296, cfpk_nation_region#5290 AS cfpk_nation_region_1#5297, cval_nation_n_name#5291 AS cval_nation_n_name_1#5298, cval_nation_n_comment#5292 AS cval_nation_n_comment_1#5299, cn_name#5293 AS cn_name_1#5300, cn_comment#5294 AS cn_comment_1#5301]
            :  +- Relation[rid#5288,cpfk_region_nation#5289,cfpk_nation_region#5290,cval_nation_n_name#5291,cval_nation_n_comment#5292,cn_name#5293,cn_comment#5294] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#5302 AS rid_5#5315, cpfk_nation_supplier#5303 AS cpfk_nation_supplier_5#5316, cfpk_supplier_nation#5304 AS cfpk_supplier_nation_5#5317, cval_supplier_s_name#5305 AS cval_supplier_s_name_5#5318, cval_supplier_s_address#5306 AS cval_supplier_s_address_5#5319, cval_supplier_s_phone#5307 AS cval_supplier_s_phone_5#5320, cval_supplier_s_acctbal#5308 AS cval_supplier_s_acctbal_5#5321, cval_supplier_s_comment#5309 AS cval_supplier_s_comment_5#5322, cs_name#5310 AS cs_name_5#5323, cs_address#5311 AS cs_address_5#5324, cs_phone#5312 AS cs_phone_5#5325, cs_acctbal#5313 AS cs_acctbal_5#5326, cs_comment#5314 AS cs_comment_5#5327]
               +- Relation[rid#5302,cpfk_nation_supplier#5303,cfpk_supplier_nation#5304,cval_supplier_s_name#5305,cval_supplier_s_address#5306,cval_supplier_s_phone#5307,cval_supplier_s_acctbal#5308,cval_supplier_s_comment#5309,cs_name#5310,cs_address#5311,cs_phone#5312,cs_acctbal#5313,cs_comment#5314] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1
Elapsed time: 19774ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/15 14:46:55 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:46:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5422L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 14:46:55 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 14:46:55 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 14:46:55 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 14:46:55 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 14:46:55 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 14:46:55 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 14:46:55 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 14:46:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5422L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#5424 AS rid_0#5441, cval_part_p_name#5425 AS cval_part_p_name_0#5442, cval_part_p_mfgr#5426 AS cval_part_p_mfgr_0#5443, cval_part_p_type#5427 AS cval_part_p_type_0#5444, cval_part_p_size#5428 AS cval_part_p_size_0#5445, cval_part_p_container#5429 AS cval_part_p_container_0#5446, cval_part_p_retailprice#5430 AS cval_part_p_retailprice_0#5447, cval_part_p_comment#5431 AS cval_part_p_comment_0#5448, cval_part_p_brand#5432 AS cval_part_p_brand_0#5449, cp_name#5433 AS cp_name_0#5450, cp_mfgr#5434 AS cp_mfgr_0#5451, cp_type#5435 AS cp_type_0#5452, cp_size#5436 AS cp_size_0#5453, cp_container#5437 AS cp_container_0#5454, cp_retailprice#5438 AS cp_retailprice_0#5455, cp_comment#5439 AS cp_comment_0#5456, cp_brand#5440 AS cp_brand_0#5457]
         :  :  :  :  +- Relation[rid#5424,cval_part_p_name#5425,cval_part_p_mfgr#5426,cval_part_p_type#5427,cval_part_p_size#5428,cval_part_p_container#5429,cval_part_p_retailprice#5430,cval_part_p_comment#5431,cval_part_p_brand#5432,cp_name#5433,cp_mfgr#5434,cp_type#5435,cp_size#5436,cp_container#5437,cp_retailprice#5438,cp_comment#5439,cp_brand#5440] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#5458 AS rid_0#5475, cval_part_p_name#5459 AS cval_part_p_name_0#5476, cval_part_p_mfgr#5460 AS cval_part_p_mfgr_0#5477, cval_part_p_type#5461 AS cval_part_p_type_0#5478, cval_part_p_size#5462 AS cval_part_p_size_0#5479, cval_part_p_container#5463 AS cval_part_p_container_0#5480, cval_part_p_retailprice#5464 AS cval_part_p_retailprice_0#5481, cval_part_p_comment#5465 AS cval_part_p_comment_0#5482, cval_part_p_brand#5466 AS cval_part_p_brand_0#5483, cp_name#5467 AS cp_name_0#5484, cp_mfgr#5468 AS cp_mfgr_0#5485, cp_type#5469 AS cp_type_0#5486, cp_size#5470 AS cp_size_0#5487, cp_container#5471 AS cp_container_0#5488, cp_retailprice#5472 AS cp_retailprice_0#5489, cp_comment#5473 AS cp_comment_0#5490, cp_brand#5474 AS cp_brand_0#5491]
         :  :  :        +- Relation[rid#5458,cval_part_p_name#5459,cval_part_p_mfgr#5460,cval_part_p_type#5461,cval_part_p_size#5462,cval_part_p_container#5463,cval_part_p_retailprice#5464,cval_part_p_comment#5465,cval_part_p_brand#5466,cp_name#5467,cp_mfgr#5468,cp_type#5469,cp_size#5470,cp_container#5471,cp_retailprice#5472,cp_comment#5473,cp_brand#5474] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#5492 AS rid_0#5509, cval_part_p_name#5493 AS cval_part_p_name_0#5510, cval_part_p_mfgr#5494 AS cval_part_p_mfgr_0#5511, cval_part_p_type#5495 AS cval_part_p_type_0#5512, cval_part_p_size#5496 AS cval_part_p_size_0#5513, cval_part_p_container#5497 AS cval_part_p_container_0#5514, cval_part_p_retailprice#5498 AS cval_part_p_retailprice_0#5515, cval_part_p_comment#5499 AS cval_part_p_comment_0#5516, cval_part_p_brand#5500 AS cval_part_p_brand_0#5517, cp_name#5501 AS cp_name_0#5518, cp_mfgr#5502 AS cp_mfgr_0#5519, cp_type#5503 AS cp_type_0#5520, cp_size#5504 AS cp_size_0#5521, cp_container#5505 AS cp_container_0#5522, cp_retailprice#5506 AS cp_retailprice_0#5523, cp_comment#5507 AS cp_comment_0#5524, cp_brand#5508 AS cp_brand_0#5525]
         :  :        +- Relation[rid#5492,cval_part_p_name#5493,cval_part_p_mfgr#5494,cval_part_p_type#5495,cval_part_p_size#5496,cval_part_p_container#5497,cval_part_p_retailprice#5498,cval_part_p_comment#5499,cval_part_p_brand#5500,cp_name#5501,cp_mfgr#5502,cp_type#5503,cp_size#5504,cp_container#5505,cp_retailprice#5506,cp_comment#5507,cp_brand#5508] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#5626 AS rid_1#5659, cpfk_orders_lineitem#5627 AS cpfk_orders_lineitem_1#5660, cpfk_supplier_lineitem#5628 AS cpfk_supplier_lineitem_1#5661, cfpk_lineitem_supplier#5629 AS cfpk_lineitem_supplier_1#5662, cfpk_lineitem_partsupp#5630 AS cfpk_lineitem_partsupp_1#5663, cpfk_part_lineitem#5631 AS cpfk_part_lineitem_1#5664, cfpk_lineitem_part#5632 AS cfpk_lineitem_part_1#5665, cpfk_partsupp_lineitem#5633 AS cpfk_partsupp_lineitem_1#5666, cfpk_lineitem_orders#5634 AS cfpk_lineitem_orders_1#5667, cval_lineitem_l_quantity#5635 AS cval_lineitem_l_quantity_1#5668, cval_lineitem_l_extendedprice#5636 AS cval_lineitem_l_extendedprice_1#5669, cval_lineitem_l_discount#5637 AS cval_lineitem_l_discount_1#5670, cval_lineitem_l_tax#5638 AS cval_lineitem_l_tax_1#5671, cval_lineitem_l_returnflag#5639 AS cval_lineitem_l_returnflag_1#5672, cval_lineitem_l_linestatus#5640 AS cval_lineitem_l_linestatus_1#5673, cval_lineitem_l_commitdate#5641 AS cval_lineitem_l_commitdate_1#5674, cval_lineitem_l_receiptdate#5642 AS cval_lineitem_l_receiptdate_1#5675, cval_lineitem_l_shipinstruct#5643 AS cval_lineitem_l_shipinstruct_1#5676, cval_lineitem_l_shipmode#5644 AS cval_lineitem_l_shipmode_1#5677, cval_lineitem_l_comment#5645 AS cval_lineitem_l_comment_1#5678, cval_lineitem_l_shipdate#5646 AS cval_lineitem_l_shipdate_1#5679, cl_quantity#5647 AS cl_quantity_1#5680, cl_extendedprice#5648 AS cl_extendedprice_1#5681, cl_discount#5649 AS cl_discount_1#5682, ... 9 more fields]
         :     +- Relation[rid#5626,cpfk_orders_lineitem#5627,cpfk_supplier_lineitem#5628,cfpk_lineitem_supplier#5629,cfpk_lineitem_partsupp#5630,cpfk_part_lineitem#5631,cfpk_lineitem_part#5632,cpfk_partsupp_lineitem#5633,cfpk_lineitem_orders#5634,cval_lineitem_l_quantity#5635,cval_lineitem_l_extendedprice#5636,cval_lineitem_l_discount#5637,cval_lineitem_l_tax#5638,cval_lineitem_l_returnflag#5639,cval_lineitem_l_linestatus#5640,cval_lineitem_l_commitdate#5641,cval_lineitem_l_receiptdate#5642,cval_lineitem_l_shipinstruct#5643,cval_lineitem_l_shipmode#5644,cval_lineitem_l_comment#5645,cval_lineitem_l_shipdate#5646,cl_quantity#5647,cl_extendedprice#5648,cl_discount#5649,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5526 AS rid_1#5559, cpfk_orders_lineitem#5527 AS cpfk_orders_lineitem_1#5560, cpfk_supplier_lineitem#5528 AS cpfk_supplier_lineitem_1#5561, cfpk_lineitem_supplier#5529 AS cfpk_lineitem_supplier_1#5562, cfpk_lineitem_partsupp#5530 AS cfpk_lineitem_partsupp_1#5563, cpfk_part_lineitem#5531 AS cpfk_part_lineitem_1#5564, cfpk_lineitem_part#5532 AS cfpk_lineitem_part_1#5565, cpfk_partsupp_lineitem#5533 AS cpfk_partsupp_lineitem_1#5566, cfpk_lineitem_orders#5534 AS cfpk_lineitem_orders_1#5567, cval_lineitem_l_quantity#5535 AS cval_lineitem_l_quantity_1#5568, cval_lineitem_l_extendedprice#5536 AS cval_lineitem_l_extendedprice_1#5569, cval_lineitem_l_discount#5537 AS cval_lineitem_l_discount_1#5570, cval_lineitem_l_tax#5538 AS cval_lineitem_l_tax_1#5571, cval_lineitem_l_returnflag#5539 AS cval_lineitem_l_returnflag_1#5572, cval_lineitem_l_linestatus#5540 AS cval_lineitem_l_linestatus_1#5573, cval_lineitem_l_commitdate#5541 AS cval_lineitem_l_commitdate_1#5574, cval_lineitem_l_receiptdate#5542 AS cval_lineitem_l_receiptdate_1#5575, cval_lineitem_l_shipinstruct#5543 AS cval_lineitem_l_shipinstruct_1#5576, cval_lineitem_l_shipmode#5544 AS cval_lineitem_l_shipmode_1#5577, cval_lineitem_l_comment#5545 AS cval_lineitem_l_comment_1#5578, cval_lineitem_l_shipdate#5546 AS cval_lineitem_l_shipdate_1#5579, cl_quantity#5547 AS cl_quantity_1#5580, cl_extendedprice#5548 AS cl_extendedprice_1#5581, cl_discount#5549 AS cl_discount_1#5582, ... 9 more fields]
            +- Relation[rid#5526,cpfk_orders_lineitem#5527,cpfk_supplier_lineitem#5528,cfpk_lineitem_supplier#5529,cfpk_lineitem_partsupp#5530,cpfk_part_lineitem#5531,cfpk_lineitem_part#5532,cpfk_partsupp_lineitem#5533,cfpk_lineitem_orders#5534,cval_lineitem_l_quantity#5535,cval_lineitem_l_extendedprice#5536,cval_lineitem_l_discount#5537,cval_lineitem_l_tax#5538,cval_lineitem_l_returnflag#5539,cval_lineitem_l_linestatus#5540,cval_lineitem_l_commitdate#5541,cval_lineitem_l_receiptdate#5542,cval_lineitem_l_shipinstruct#5543,cval_lineitem_l_shipmode#5544,cval_lineitem_l_comment#5545,cval_lineitem_l_shipdate#5546,cl_quantity#5547,cl_extendedprice#5548,cl_discount#5549,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=408
Elapsed time: 1126ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/15 14:46:56 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:46:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5750L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 14:46:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:46:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:46:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:46:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:46:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:46:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5750L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#5752 AS rid_0#5759, cpfk_region_nation#5753 AS cpfk_region_nation_0#5760, cfpk_nation_region#5754 AS cfpk_nation_region_0#5761, cval_nation_n_name#5755 AS cval_nation_n_name_0#5762, cval_nation_n_comment#5756 AS cval_nation_n_comment_0#5763, cn_name#5757 AS cn_name_0#5764, cn_comment#5758 AS cn_comment_0#5765]
            :  :  :  :  :  :  +- Relation[rid#5752,cpfk_region_nation#5753,cfpk_nation_region#5754,cval_nation_n_name#5755,cval_nation_n_comment#5756,cn_name#5757,cn_comment#5758] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#5766 AS rid_0#5773, cpfk_region_nation#5767 AS cpfk_region_nation_0#5774, cfpk_nation_region#5768 AS cfpk_nation_region_0#5775, cval_nation_n_name#5769 AS cval_nation_n_name_0#5776, cval_nation_n_comment#5770 AS cval_nation_n_comment_0#5777, cn_name#5771 AS cn_name_0#5778, cn_comment#5772 AS cn_comment_0#5779]
            :  :  :  :  :        +- Relation[rid#5766,cpfk_region_nation#5767,cfpk_nation_region#5768,cval_nation_n_name#5769,cval_nation_n_comment#5770,cn_name#5771,cn_comment#5772] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- Project [rid#5820 AS rid_1#5833, cpfk_nation_supplier#5821 AS cpfk_nation_supplier_1#5834, cfpk_supplier_nation#5822 AS cfpk_supplier_nation_1#5835, cval_supplier_s_name#5823 AS cval_supplier_s_name_1#5836, cval_supplier_s_address#5824 AS cval_supplier_s_address_1#5837, cval_supplier_s_phone#5825 AS cval_supplier_s_phone_1#5838, cval_supplier_s_acctbal#5826 AS cval_supplier_s_acctbal_1#5839, cval_supplier_s_comment#5827 AS cval_supplier_s_comment_1#5840, cs_name#5828 AS cs_name_1#5841, cs_address#5829 AS cs_address_1#5842, cs_phone#5830 AS cs_phone_1#5843, cs_acctbal#5831 AS cs_acctbal_1#5844, cs_comment#5832 AS cs_comment_1#5845]
            :  :  :  :     +- Relation[rid#5820,cpfk_nation_supplier#5821,cfpk_supplier_nation#5822,cval_supplier_s_name#5823,cval_supplier_s_address#5824,cval_supplier_s_phone#5825,cval_supplier_s_acctbal#5826,cval_supplier_s_comment#5827,cs_name#5828,cs_address#5829,cs_phone#5830,cs_acctbal#5831,cs_comment#5832] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#5780 AS rid_1#5793, cpfk_nation_supplier#5781 AS cpfk_nation_supplier_1#5794, cfpk_supplier_nation#5782 AS cfpk_supplier_nation_1#5795, cval_supplier_s_name#5783 AS cval_supplier_s_name_1#5796, cval_supplier_s_address#5784 AS cval_supplier_s_address_1#5797, cval_supplier_s_phone#5785 AS cval_supplier_s_phone_1#5798, cval_supplier_s_acctbal#5786 AS cval_supplier_s_acctbal_1#5799, cval_supplier_s_comment#5787 AS cval_supplier_s_comment_1#5800, cs_name#5788 AS cs_name_1#5801, cs_address#5789 AS cs_address_1#5802, cs_phone#5790 AS cs_phone_1#5803, cs_acctbal#5791 AS cs_acctbal_1#5804, cs_comment#5792 AS cs_comment_1#5805]
            :  :  :     +- Relation[rid#5780,cpfk_nation_supplier#5781,cfpk_supplier_nation#5782,cval_supplier_s_name#5783,cval_supplier_s_address#5784,cval_supplier_s_phone#5785,cval_supplier_s_acctbal#5786,cval_supplier_s_comment#5787,cs_name#5788,cs_address#5789,cs_phone#5790,cs_acctbal#5791,cs_comment#5792] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- Project [rid#5938 AS rid_2#5971, cpfk_orders_lineitem#5939 AS cpfk_orders_lineitem_2#5972, cpfk_supplier_lineitem#5940 AS cpfk_supplier_lineitem_2#5973, cfpk_lineitem_supplier#5941 AS cfpk_lineitem_supplier_2#5974, cfpk_lineitem_partsupp#5942 AS cfpk_lineitem_partsupp_2#5975, cpfk_part_lineitem#5943 AS cpfk_part_lineitem_2#5976, cfpk_lineitem_part#5944 AS cfpk_lineitem_part_2#5977, cpfk_partsupp_lineitem#5945 AS cpfk_partsupp_lineitem_2#5978, cfpk_lineitem_orders#5946 AS cfpk_lineitem_orders_2#5979, cval_lineitem_l_quantity#5947 AS cval_lineitem_l_quantity_2#5980, cval_lineitem_l_extendedprice#5948 AS cval_lineitem_l_extendedprice_2#5981, cval_lineitem_l_discount#5949 AS cval_lineitem_l_discount_2#5982, cval_lineitem_l_tax#5950 AS cval_lineitem_l_tax_2#5983, cval_lineitem_l_returnflag#5951 AS cval_lineitem_l_returnflag_2#5984, cval_lineitem_l_linestatus#5952 AS cval_lineitem_l_linestatus_2#5985, cval_lineitem_l_commitdate#5953 AS cval_lineitem_l_commitdate_2#5986, cval_lineitem_l_receiptdate#5954 AS cval_lineitem_l_receiptdate_2#5987, cval_lineitem_l_shipinstruct#5955 AS cval_lineitem_l_shipinstruct_2#5988, cval_lineitem_l_shipmode#5956 AS cval_lineitem_l_shipmode_2#5989, cval_lineitem_l_comment#5957 AS cval_lineitem_l_comment_2#5990, cval_lineitem_l_shipdate#5958 AS cval_lineitem_l_shipdate_2#5991, cl_quantity#5959 AS cl_quantity_2#5992, cl_extendedprice#5960 AS cl_extendedprice_2#5993, cl_discount#5961 AS cl_discount_2#5994, ... 9 more fields]
            :  :     +- Relation[rid#5938,cpfk_orders_lineitem#5939,cpfk_supplier_lineitem#5940,cfpk_lineitem_supplier#5941,cfpk_lineitem_partsupp#5942,cpfk_part_lineitem#5943,cfpk_lineitem_part#5944,cpfk_partsupp_lineitem#5945,cfpk_lineitem_orders#5946,cval_lineitem_l_quantity#5947,cval_lineitem_l_extendedprice#5948,cval_lineitem_l_discount#5949,cval_lineitem_l_tax#5950,cval_lineitem_l_returnflag#5951,cval_lineitem_l_linestatus#5952,cval_lineitem_l_commitdate#5953,cval_lineitem_l_receiptdate#5954,cval_lineitem_l_shipinstruct#5955,cval_lineitem_l_shipmode#5956,cval_lineitem_l_comment#5957,cval_lineitem_l_shipdate#5958,cl_quantity#5959,cl_extendedprice#5960,cl_discount#5961,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#5846 AS rid_2#5879, cpfk_orders_lineitem#5847 AS cpfk_orders_lineitem_2#5880, cpfk_supplier_lineitem#5848 AS cpfk_supplier_lineitem_2#5881, cfpk_lineitem_supplier#5849 AS cfpk_lineitem_supplier_2#5882, cfpk_lineitem_partsupp#5850 AS cfpk_lineitem_partsupp_2#5883, cpfk_part_lineitem#5851 AS cpfk_part_lineitem_2#5884, cfpk_lineitem_part#5852 AS cfpk_lineitem_part_2#5885, cpfk_partsupp_lineitem#5853 AS cpfk_partsupp_lineitem_2#5886, cfpk_lineitem_orders#5854 AS cfpk_lineitem_orders_2#5887, cval_lineitem_l_quantity#5855 AS cval_lineitem_l_quantity_2#5888, cval_lineitem_l_extendedprice#5856 AS cval_lineitem_l_extendedprice_2#5889, cval_lineitem_l_discount#5857 AS cval_lineitem_l_discount_2#5890, cval_lineitem_l_tax#5858 AS cval_lineitem_l_tax_2#5891, cval_lineitem_l_returnflag#5859 AS cval_lineitem_l_returnflag_2#5892, cval_lineitem_l_linestatus#5860 AS cval_lineitem_l_linestatus_2#5893, cval_lineitem_l_commitdate#5861 AS cval_lineitem_l_commitdate_2#5894, cval_lineitem_l_receiptdate#5862 AS cval_lineitem_l_receiptdate_2#5895, cval_lineitem_l_shipinstruct#5863 AS cval_lineitem_l_shipinstruct_2#5896, cval_lineitem_l_shipmode#5864 AS cval_lineitem_l_shipmode_2#5897, cval_lineitem_l_comment#5865 AS cval_lineitem_l_comment_2#5898, cval_lineitem_l_shipdate#5866 AS cval_lineitem_l_shipdate_2#5899, cl_quantity#5867 AS cl_quantity_2#5900, cl_extendedprice#5868 AS cl_extendedprice_2#5901, cl_discount#5869 AS cl_discount_2#5902, ... 9 more fields]
            :     +- Relation[rid#5846,cpfk_orders_lineitem#5847,cpfk_supplier_lineitem#5848,cfpk_lineitem_supplier#5849,cfpk_lineitem_partsupp#5850,cpfk_part_lineitem#5851,cfpk_lineitem_part#5852,cpfk_partsupp_lineitem#5853,cfpk_lineitem_orders#5854,cval_lineitem_l_quantity#5855,cval_lineitem_l_extendedprice#5856,cval_lineitem_l_discount#5857,cval_lineitem_l_tax#5858,cval_lineitem_l_returnflag#5859,cval_lineitem_l_linestatus#5860,cval_lineitem_l_commitdate#5861,cval_lineitem_l_receiptdate#5862,cval_lineitem_l_shipinstruct#5863,cval_lineitem_l_shipmode#5864,cval_lineitem_l_comment#5865,cval_lineitem_l_shipdate#5866,cl_quantity#5867,cl_extendedprice#5868,cl_discount#5869,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#6004 AS rid_3#6011, cpfk_region_nation#6005 AS cpfk_region_nation_3#6012, cfpk_nation_region#6006 AS cfpk_nation_region_3#6013, cval_nation_n_name#6007 AS cval_nation_n_name_3#6014, cval_nation_n_comment#6008 AS cval_nation_n_comment_3#6015, cn_name#6009 AS cn_name_3#6016, cn_comment#6010 AS cn_comment_3#6017]
               :  :  :  :  :  +- Relation[rid#6004,cpfk_region_nation#6005,cfpk_nation_region#6006,cval_nation_n_name#6007,cval_nation_n_comment#6008,cn_name#6009,cn_comment#6010] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#6018 AS rid_3#6025, cpfk_region_nation#6019 AS cpfk_region_nation_3#6026, cfpk_nation_region#6020 AS cfpk_nation_region_3#6027, cval_nation_n_name#6021 AS cval_nation_n_name_3#6028, cval_nation_n_comment#6022 AS cval_nation_n_comment_3#6029, cn_name#6023 AS cn_name_3#6030, cn_comment#6024 AS cn_comment_3#6031]
               :  :  :  :        +- Relation[rid#6018,cpfk_region_nation#6019,cfpk_nation_region#6020,cval_nation_n_name#6021,cval_nation_n_comment#6022,cn_name#6023,cn_comment#6024] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#6076 AS rid_4#6091, cpfk_nation_customer#6077 AS cpfk_nation_customer_4#6092, cfpk_customer_nation#6078 AS cfpk_customer_nation_4#6093, cval_customer_c_name#6079 AS cval_customer_c_name_4#6094, cval_customer_c_address#6080 AS cval_customer_c_address_4#6095, cval_customer_c_phone#6081 AS cval_customer_c_phone_4#6096, cval_customer_c_acctbal#6082 AS cval_customer_c_acctbal_4#6097, cval_customer_c_comment#6083 AS cval_customer_c_comment_4#6098, cval_customer_c_mktsegment#6084 AS cval_customer_c_mktsegment_4#6099, cc_name#6085 AS cc_name_4#6100, cc_address#6086 AS cc_address_4#6101, cc_phone#6087 AS cc_phone_4#6102, cc_acctbal#6088 AS cc_acctbal_4#6103, cc_comment#6089 AS cc_comment_4#6104, cc_mktsegment#6090 AS cc_mktsegment_4#6105]
               :  :  :     +- Relation[rid#6076,cpfk_nation_customer#6077,cfpk_customer_nation#6078,cval_customer_c_name#6079,cval_customer_c_address#6080,cval_customer_c_phone#6081,cval_customer_c_acctbal#6082,cval_customer_c_comment#6083,cval_customer_c_mktsegment#6084,cc_name#6085,cc_address#6086,cc_phone#6087,cc_acctbal#6088,cc_comment#6089,cc_mktsegment#6090] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#6032 AS rid_4#6047, cpfk_nation_customer#6033 AS cpfk_nation_customer_4#6048, cfpk_customer_nation#6034 AS cfpk_customer_nation_4#6049, cval_customer_c_name#6035 AS cval_customer_c_name_4#6050, cval_customer_c_address#6036 AS cval_customer_c_address_4#6051, cval_customer_c_phone#6037 AS cval_customer_c_phone_4#6052, cval_customer_c_acctbal#6038 AS cval_customer_c_acctbal_4#6053, cval_customer_c_comment#6039 AS cval_customer_c_comment_4#6054, cval_customer_c_mktsegment#6040 AS cval_customer_c_mktsegment_4#6055, cc_name#6041 AS cc_name_4#6056, cc_address#6042 AS cc_address_4#6057, cc_phone#6043 AS cc_phone_4#6058, cc_acctbal#6044 AS cc_acctbal_4#6059, cc_comment#6045 AS cc_comment_4#6060, cc_mktsegment#6046 AS cc_mktsegment_4#6061]
               :  :     +- Relation[rid#6032,cpfk_nation_customer#6033,cfpk_customer_nation#6034,cval_customer_c_name#6035,cval_customer_c_address#6036,cval_customer_c_phone#6037,cval_customer_c_acctbal#6038,cval_customer_c_comment#6039,cval_customer_c_mktsegment#6040,cc_name#6041,cc_address#6042,cc_phone#6043,cc_acctbal#6044,cc_comment#6045,cc_mktsegment#6046] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#6170 AS rid_5#6187, cpfk_customer_orders#6171 AS cpfk_customer_orders_5#6188, cfpk_orders_customer#6172 AS cfpk_orders_customer_5#6189, cval_orders_o_orderstatus#6173 AS cval_orders_o_orderstatus_5#6190, cval_orders_o_totalprice#6174 AS cval_orders_o_totalprice_5#6191, cval_orders_o_orderpriority#6175 AS cval_orders_o_orderpriority_5#6192, cval_orders_o_clerk#6176 AS cval_orders_o_clerk_5#6193, cval_orders_o_shippriority#6177 AS cval_orders_o_shippriority_5#6194, cval_orders_o_comment#6178 AS cval_orders_o_comment_5#6195, cval_orders_o_orderdate#6179 AS cval_orders_o_orderdate_5#6196, co_orderstatus#6180 AS co_orderstatus_5#6197, co_totalprice#6181 AS co_totalprice_5#6198, co_orderpriority#6182 AS co_orderpriority_5#6199, co_clerk#6183 AS co_clerk_5#6200, co_shippriority#6184 AS co_shippriority_5#6201, co_comment#6185 AS co_comment_5#6202, co_orderdate#6186 AS co_orderdate_5#6203]
               :     +- Relation[rid#6170,cpfk_customer_orders#6171,cfpk_orders_customer#6172,cval_orders_o_orderstatus#6173,cval_orders_o_totalprice#6174,cval_orders_o_orderpriority#6175,cval_orders_o_clerk#6176,cval_orders_o_shippriority#6177,cval_orders_o_comment#6178,cval_orders_o_orderdate#6179,co_orderstatus#6180,co_totalprice#6181,co_orderpriority#6182,co_clerk#6183,co_shippriority#6184,co_comment#6185,co_orderdate#6186] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#6106 AS rid_5#6123, cpfk_customer_orders#6107 AS cpfk_customer_orders_5#6124, cfpk_orders_customer#6108 AS cfpk_orders_customer_5#6125, cval_orders_o_orderstatus#6109 AS cval_orders_o_orderstatus_5#6126, cval_orders_o_totalprice#6110 AS cval_orders_o_totalprice_5#6127, cval_orders_o_orderpriority#6111 AS cval_orders_o_orderpriority_5#6128, cval_orders_o_clerk#6112 AS cval_orders_o_clerk_5#6129, cval_orders_o_shippriority#6113 AS cval_orders_o_shippriority_5#6130, cval_orders_o_comment#6114 AS cval_orders_o_comment_5#6131, cval_orders_o_orderdate#6115 AS cval_orders_o_orderdate_5#6132, co_orderstatus#6116 AS co_orderstatus_5#6133, co_totalprice#6117 AS co_totalprice_5#6134, co_orderpriority#6118 AS co_orderpriority_5#6135, co_clerk#6119 AS co_clerk_5#6136, co_shippriority#6120 AS co_shippriority_5#6137, co_comment#6121 AS co_comment_5#6138, co_orderdate#6122 AS co_orderdate_5#6139]
                  +- Relation[rid#6106,cpfk_customer_orders#6107,cfpk_orders_customer#6108,cval_orders_o_orderstatus#6109,cval_orders_o_totalprice#6110,cval_orders_o_orderpriority#6111,cval_orders_o_clerk#6112,cval_orders_o_shippriority#6113,cval_orders_o_comment#6114,cval_orders_o_orderdate#6115,co_orderstatus#6116,co_totalprice#6117,co_orderpriority#6118,co_clerk#6119,co_shippriority#6120,co_comment#6121,co_orderdate#6122] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 333ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 14:46:57 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:46:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6305L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 14:46:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:46:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:46:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:46:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:46:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:46:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:46:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:46:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:46:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:46:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:46:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:46:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:46:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:46:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:46:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6305L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#6307 AS rid_0#6314, cpfk_region_nation#6308 AS cpfk_region_nation_0#6315, cfpk_nation_region#6309 AS cfpk_nation_region_0#6316, cval_nation_n_name#6310 AS cval_nation_n_name_0#6317, cval_nation_n_comment#6311 AS cval_nation_n_comment_0#6318, cn_name#6312 AS cn_name_0#6319, cn_comment#6313 AS cn_comment_0#6320]
            :  :  :     :  :  :  :  :  +- Relation[rid#6307,cpfk_region_nation#6308,cfpk_nation_region#6309,cval_nation_n_name#6310,cval_nation_n_comment#6311,cn_name#6312,cn_comment#6313] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#6347 AS rid_0#6354, cpfk_region_nation#6348 AS cpfk_region_nation_0#6355, cfpk_nation_region#6349 AS cfpk_nation_region_0#6356, cval_nation_n_name#6350 AS cval_nation_n_name_0#6357, cval_nation_n_comment#6351 AS cval_nation_n_comment_0#6358, cn_name#6352 AS cn_name_0#6359, cn_comment#6353 AS cn_comment_0#6360]
            :  :  :     :  :  :  :     :  +- Relation[rid#6347,cpfk_region_nation#6348,cfpk_nation_region#6349,cval_nation_n_name#6350,cval_nation_n_comment#6351,cn_name#6352,cn_comment#6353] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#6361 AS rid_1#6374, cpfk_nation_supplier#6362 AS cpfk_nation_supplier_1#6375, cfpk_supplier_nation#6363 AS cfpk_supplier_nation_1#6376, cval_supplier_s_name#6364 AS cval_supplier_s_name_1#6377, cval_supplier_s_address#6365 AS cval_supplier_s_address_1#6378, cval_supplier_s_phone#6366 AS cval_supplier_s_phone_1#6379, cval_supplier_s_acctbal#6367 AS cval_supplier_s_acctbal_1#6380, cval_supplier_s_comment#6368 AS cval_supplier_s_comment_1#6381, cs_name#6369 AS cs_name_1#6382, cs_address#6370 AS cs_address_1#6383, cs_phone#6371 AS cs_phone_1#6384, cs_acctbal#6372 AS cs_acctbal_1#6385, cs_comment#6373 AS cs_comment_1#6386]
            :  :  :     :  :  :  :        +- Relation[rid#6361,cpfk_nation_supplier#6362,cfpk_supplier_nation#6363,cval_supplier_s_name#6364,cval_supplier_s_address#6365,cval_supplier_s_phone#6366,cval_supplier_s_acctbal#6367,cval_supplier_s_comment#6368,cs_name#6369,cs_address#6370,cs_phone#6371,cs_acctbal#6372,cs_comment#6373] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#6321 AS rid_1#6334, cpfk_nation_supplier#6322 AS cpfk_nation_supplier_1#6335, cfpk_supplier_nation#6323 AS cfpk_supplier_nation_1#6336, cval_supplier_s_name#6324 AS cval_supplier_s_name_1#6337, cval_supplier_s_address#6325 AS cval_supplier_s_address_1#6338, cval_supplier_s_phone#6326 AS cval_supplier_s_phone_1#6339, cval_supplier_s_acctbal#6327 AS cval_supplier_s_acctbal_1#6340, cval_supplier_s_comment#6328 AS cval_supplier_s_comment_1#6341, cs_name#6329 AS cs_name_1#6342, cs_address#6330 AS cs_address_1#6343, cs_phone#6331 AS cs_phone_1#6344, cs_acctbal#6332 AS cs_acctbal_1#6345, cs_comment#6333 AS cs_comment_1#6346]
            :  :  :     :  :  :     +- Relation[rid#6321,cpfk_nation_supplier#6322,cfpk_supplier_nation#6323,cval_supplier_s_name#6324,cval_supplier_s_address#6325,cval_supplier_s_phone#6326,cval_supplier_s_acctbal#6327,cval_supplier_s_comment#6328,cs_name#6329,cs_address#6330,cs_phone#6331,cs_acctbal#6332,cs_comment#6333] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#6409 AS rid_1#6422, cpfk_nation_supplier#6410 AS cpfk_nation_supplier_1#6423, cfpk_supplier_nation#6411 AS cfpk_supplier_nation_1#6424, cval_supplier_s_name#6412 AS cval_supplier_s_name_1#6425, cval_supplier_s_address#6413 AS cval_supplier_s_address_1#6426, cval_supplier_s_phone#6414 AS cval_supplier_s_phone_1#6427, cval_supplier_s_acctbal#6415 AS cval_supplier_s_acctbal_1#6428, cval_supplier_s_comment#6416 AS cval_supplier_s_comment_1#6429, cs_name#6417 AS cs_name_1#6430, cs_address#6418 AS cs_address_1#6431, cs_phone#6419 AS cs_phone_1#6432, cs_acctbal#6420 AS cs_acctbal_1#6433, cs_comment#6421 AS cs_comment_1#6434]
            :  :  :     :  :     :  +- Relation[rid#6409,cpfk_nation_supplier#6410,cfpk_supplier_nation#6411,cval_supplier_s_name#6412,cval_supplier_s_address#6413,cval_supplier_s_phone#6414,cval_supplier_s_acctbal#6415,cval_supplier_s_comment#6416,cs_name#6417,cs_address#6418,cs_phone#6419,cs_acctbal#6420,cs_comment#6421] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#6435 AS rid_2#6446, cpfk_part_partsupp#6436 AS cpfk_part_partsupp_2#6447, cfpk_partsupp_part#6437 AS cfpk_partsupp_part_2#6448, cpfk_supplier_partsupp#6438 AS cpfk_supplier_partsupp_2#6449, cfpk_partsupp_supplier#6439 AS cfpk_partsupp_supplier_2#6450, cval_partsupp_ps_availqty#6440 AS cval_partsupp_ps_availqty_2#6451, cval_partsupp_ps_supplycost#6441 AS cval_partsupp_ps_supplycost_2#6452, cval_partsupp_ps_comment#6442 AS cval_partsupp_ps_comment_2#6453, cps_availqty#6443 AS cps_availqty_2#6454, cps_supplycost#6444 AS cps_supplycost_2#6455, cps_comment#6445 AS cps_comment_2#6456]
            :  :  :     :  :        +- Relation[rid#6435,cpfk_part_partsupp#6436,cfpk_partsupp_part#6437,cpfk_supplier_partsupp#6438,cfpk_partsupp_supplier#6439,cval_partsupp_ps_availqty#6440,cval_partsupp_ps_supplycost#6441,cval_partsupp_ps_comment#6442,cps_availqty#6443,cps_supplycost#6444,cps_comment#6445] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#6387 AS rid_2#6398, cpfk_part_partsupp#6388 AS cpfk_part_partsupp_2#6399, cfpk_partsupp_part#6389 AS cfpk_partsupp_part_2#6400, cpfk_supplier_partsupp#6390 AS cpfk_supplier_partsupp_2#6401, cfpk_partsupp_supplier#6391 AS cfpk_partsupp_supplier_2#6402, cval_partsupp_ps_availqty#6392 AS cval_partsupp_ps_availqty_2#6403, cval_partsupp_ps_supplycost#6393 AS cval_partsupp_ps_supplycost_2#6404, cval_partsupp_ps_comment#6394 AS cval_partsupp_ps_comment_2#6405, cps_availqty#6395 AS cps_availqty_2#6406, cps_supplycost#6396 AS cps_supplycost_2#6407, cps_comment#6397 AS cps_comment_2#6408]
            :  :  :     :     +- Relation[rid#6387,cpfk_part_partsupp#6388,cfpk_partsupp_part#6389,cpfk_supplier_partsupp#6390,cfpk_partsupp_supplier#6391,cval_partsupp_ps_availqty#6392,cval_partsupp_ps_supplycost#6393,cval_partsupp_ps_comment#6394,cps_availqty#6395,cps_supplycost#6396,cps_comment#6397] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#6457 AS rid_3#6474, cval_part_p_name#6458 AS cval_part_p_name_3#6475, cval_part_p_mfgr#6459 AS cval_part_p_mfgr_3#6476, cval_part_p_type#6460 AS cval_part_p_type_3#6477, cval_part_p_size#6461 AS cval_part_p_size_3#6478, cval_part_p_container#6462 AS cval_part_p_container_3#6479, cval_part_p_retailprice#6463 AS cval_part_p_retailprice_3#6480, cval_part_p_comment#6464 AS cval_part_p_comment_3#6481, cval_part_p_brand#6465 AS cval_part_p_brand_3#6482, cp_name#6466 AS cp_name_3#6483, cp_mfgr#6467 AS cp_mfgr_3#6484, cp_type#6468 AS cp_type_3#6485, cp_size#6469 AS cp_size_3#6486, cp_container#6470 AS cp_container_3#6487, cp_retailprice#6471 AS cp_retailprice_3#6488, cp_comment#6472 AS cp_comment_3#6489, cp_brand#6473 AS cp_brand_3#6490]
            :  :  :        +- Relation[rid#6457,cval_part_p_name#6458,cval_part_p_mfgr#6459,cval_part_p_type#6460,cval_part_p_size#6461,cval_part_p_container#6462,cval_part_p_retailprice#6463,cval_part_p_comment#6464,cval_part_p_brand#6465,cp_name#6466,cp_mfgr#6467,cp_type#6468,cp_size#6469,cp_container#6470,cp_retailprice#6471,cp_comment#6472,cp_brand#6473] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#6557 AS rid_2#6568, cpfk_part_partsupp#6558 AS cpfk_part_partsupp_2#6569, cfpk_partsupp_part#6559 AS cfpk_partsupp_part_2#6570, cpfk_supplier_partsupp#6560 AS cpfk_supplier_partsupp_2#6571, cfpk_partsupp_supplier#6561 AS cfpk_partsupp_supplier_2#6572, cval_partsupp_ps_availqty#6562 AS cval_partsupp_ps_availqty_2#6573, cval_partsupp_ps_supplycost#6563 AS cval_partsupp_ps_supplycost_2#6574, cval_partsupp_ps_comment#6564 AS cval_partsupp_ps_comment_2#6575, cps_availqty#6565 AS cps_availqty_2#6576, cps_supplycost#6566 AS cps_supplycost_2#6577, cps_comment#6567 AS cps_comment_2#6578]
            :  :     :  +- Relation[rid#6557,cpfk_part_partsupp#6558,cfpk_partsupp_part#6559,cpfk_supplier_partsupp#6560,cfpk_partsupp_supplier#6561,cval_partsupp_ps_availqty#6562,cval_partsupp_ps_supplycost#6563,cval_partsupp_ps_comment#6564,cps_availqty#6565,cps_supplycost#6566,cps_comment#6567] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#6579 AS rid_4#6612, cpfk_orders_lineitem#6580 AS cpfk_orders_lineitem_4#6613, cpfk_supplier_lineitem#6581 AS cpfk_supplier_lineitem_4#6614, cfpk_lineitem_supplier#6582 AS cfpk_lineitem_supplier_4#6615, cfpk_lineitem_partsupp#6583 AS cfpk_lineitem_partsupp_4#6616, cpfk_part_lineitem#6584 AS cpfk_part_lineitem_4#6617, cfpk_lineitem_part#6585 AS cfpk_lineitem_part_4#6618, cpfk_partsupp_lineitem#6586 AS cpfk_partsupp_lineitem_4#6619, cfpk_lineitem_orders#6587 AS cfpk_lineitem_orders_4#6620, cval_lineitem_l_quantity#6588 AS cval_lineitem_l_quantity_4#6621, cval_lineitem_l_extendedprice#6589 AS cval_lineitem_l_extendedprice_4#6622, cval_lineitem_l_discount#6590 AS cval_lineitem_l_discount_4#6623, cval_lineitem_l_tax#6591 AS cval_lineitem_l_tax_4#6624, cval_lineitem_l_returnflag#6592 AS cval_lineitem_l_returnflag_4#6625, cval_lineitem_l_linestatus#6593 AS cval_lineitem_l_linestatus_4#6626, cval_lineitem_l_commitdate#6594 AS cval_lineitem_l_commitdate_4#6627, cval_lineitem_l_receiptdate#6595 AS cval_lineitem_l_receiptdate_4#6628, cval_lineitem_l_shipinstruct#6596 AS cval_lineitem_l_shipinstruct_4#6629, cval_lineitem_l_shipmode#6597 AS cval_lineitem_l_shipmode_4#6630, cval_lineitem_l_comment#6598 AS cval_lineitem_l_comment_4#6631, cval_lineitem_l_shipdate#6599 AS cval_lineitem_l_shipdate_4#6632, cl_quantity#6600 AS cl_quantity_4#6633, cl_extendedprice#6601 AS cl_extendedprice_4#6634, cl_discount#6602 AS cl_discount_4#6635, ... 9 more fields]
            :  :        +- Relation[rid#6579,cpfk_orders_lineitem#6580,cpfk_supplier_lineitem#6581,cfpk_lineitem_supplier#6582,cfpk_lineitem_partsupp#6583,cpfk_part_lineitem#6584,cfpk_lineitem_part#6585,cpfk_partsupp_lineitem#6586,cfpk_lineitem_orders#6587,cval_lineitem_l_quantity#6588,cval_lineitem_l_extendedprice#6589,cval_lineitem_l_discount#6590,cval_lineitem_l_tax#6591,cval_lineitem_l_returnflag#6592,cval_lineitem_l_linestatus#6593,cval_lineitem_l_commitdate#6594,cval_lineitem_l_receiptdate#6595,cval_lineitem_l_shipinstruct#6596,cval_lineitem_l_shipmode#6597,cval_lineitem_l_comment#6598,cval_lineitem_l_shipdate#6599,cl_quantity#6600,cl_extendedprice#6601,cl_discount#6602,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#6491 AS rid_4#6524, cpfk_orders_lineitem#6492 AS cpfk_orders_lineitem_4#6525, cpfk_supplier_lineitem#6493 AS cpfk_supplier_lineitem_4#6526, cfpk_lineitem_supplier#6494 AS cfpk_lineitem_supplier_4#6527, cfpk_lineitem_partsupp#6495 AS cfpk_lineitem_partsupp_4#6528, cpfk_part_lineitem#6496 AS cpfk_part_lineitem_4#6529, cfpk_lineitem_part#6497 AS cfpk_lineitem_part_4#6530, cpfk_partsupp_lineitem#6498 AS cpfk_partsupp_lineitem_4#6531, cfpk_lineitem_orders#6499 AS cfpk_lineitem_orders_4#6532, cval_lineitem_l_quantity#6500 AS cval_lineitem_l_quantity_4#6533, cval_lineitem_l_extendedprice#6501 AS cval_lineitem_l_extendedprice_4#6534, cval_lineitem_l_discount#6502 AS cval_lineitem_l_discount_4#6535, cval_lineitem_l_tax#6503 AS cval_lineitem_l_tax_4#6536, cval_lineitem_l_returnflag#6504 AS cval_lineitem_l_returnflag_4#6537, cval_lineitem_l_linestatus#6505 AS cval_lineitem_l_linestatus_4#6538, cval_lineitem_l_commitdate#6506 AS cval_lineitem_l_commitdate_4#6539, cval_lineitem_l_receiptdate#6507 AS cval_lineitem_l_receiptdate_4#6540, cval_lineitem_l_shipinstruct#6508 AS cval_lineitem_l_shipinstruct_4#6541, cval_lineitem_l_shipmode#6509 AS cval_lineitem_l_shipmode_4#6542, cval_lineitem_l_comment#6510 AS cval_lineitem_l_comment_4#6543, cval_lineitem_l_shipdate#6511 AS cval_lineitem_l_shipdate_4#6544, cl_quantity#6512 AS cl_quantity_4#6545, cl_extendedprice#6513 AS cl_extendedprice_4#6546, cl_discount#6514 AS cl_discount_4#6547, ... 9 more fields]
            :     +- Relation[rid#6491,cpfk_orders_lineitem#6492,cpfk_supplier_lineitem#6493,cfpk_lineitem_supplier#6494,cfpk_lineitem_partsupp#6495,cpfk_part_lineitem#6496,cfpk_lineitem_part#6497,cpfk_partsupp_lineitem#6498,cfpk_lineitem_orders#6499,cval_lineitem_l_quantity#6500,cval_lineitem_l_extendedprice#6501,cval_lineitem_l_discount#6502,cval_lineitem_l_tax#6503,cval_lineitem_l_returnflag#6504,cval_lineitem_l_linestatus#6505,cval_lineitem_l_commitdate#6506,cval_lineitem_l_receiptdate#6507,cval_lineitem_l_shipinstruct#6508,cval_lineitem_l_shipmode#6509,cval_lineitem_l_comment#6510,cval_lineitem_l_shipdate#6511,cl_quantity#6512,cl_extendedprice#6513,cl_discount#6514,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#6645 AS rid_5#6662, cpfk_customer_orders#6646 AS cpfk_customer_orders_5#6663, cfpk_orders_customer#6647 AS cfpk_orders_customer_5#6664, cval_orders_o_orderstatus#6648 AS cval_orders_o_orderstatus_5#6665, cval_orders_o_totalprice#6649 AS cval_orders_o_totalprice_5#6666, cval_orders_o_orderpriority#6650 AS cval_orders_o_orderpriority_5#6667, cval_orders_o_clerk#6651 AS cval_orders_o_clerk_5#6668, cval_orders_o_shippriority#6652 AS cval_orders_o_shippriority_5#6669, cval_orders_o_comment#6653 AS cval_orders_o_comment_5#6670, cval_orders_o_orderdate#6654 AS cval_orders_o_orderdate_5#6671, co_orderstatus#6655 AS co_orderstatus_5#6672, co_totalprice#6656 AS co_totalprice_5#6673, co_orderpriority#6657 AS co_orderpriority_5#6674, co_clerk#6658 AS co_clerk_5#6675, co_shippriority#6659 AS co_shippriority_5#6676, co_comment#6660 AS co_comment_5#6677, co_orderdate#6661 AS co_orderdate_5#6678]
               +- Relation[rid#6645,cpfk_customer_orders#6646,cfpk_orders_customer#6647,cval_orders_o_orderstatus#6648,cval_orders_o_totalprice#6649,cval_orders_o_orderpriority#6650,cval_orders_o_clerk#6651,cval_orders_o_shippriority#6652,cval_orders_o_comment#6653,cval_orders_o_orderdate#6654,co_orderstatus#6655,co_totalprice#6656,co_orderpriority#6657,co_clerk#6658,co_shippriority#6659,co_comment#6660,co_orderdate#6661] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 169735ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/15 14:49:46 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:49:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6782L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 14:49:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#6782L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#6784 AS rid_0#6817, cpfk_orders_lineitem#6785 AS cpfk_orders_lineitem_0#6818, cpfk_supplier_lineitem#6786 AS cpfk_supplier_lineitem_0#6819, cfpk_lineitem_supplier#6787 AS cfpk_lineitem_supplier_0#6820, cfpk_lineitem_partsupp#6788 AS cfpk_lineitem_partsupp_0#6821, cpfk_part_lineitem#6789 AS cpfk_part_lineitem_0#6822, cfpk_lineitem_part#6790 AS cfpk_lineitem_part_0#6823, cpfk_partsupp_lineitem#6791 AS cpfk_partsupp_lineitem_0#6824, cfpk_lineitem_orders#6792 AS cfpk_lineitem_orders_0#6825, cval_lineitem_l_quantity#6793 AS cval_lineitem_l_quantity_0#6826, cval_lineitem_l_extendedprice#6794 AS cval_lineitem_l_extendedprice_0#6827, cval_lineitem_l_discount#6795 AS cval_lineitem_l_discount_0#6828, cval_lineitem_l_tax#6796 AS cval_lineitem_l_tax_0#6829, cval_lineitem_l_returnflag#6797 AS cval_lineitem_l_returnflag_0#6830, cval_lineitem_l_linestatus#6798 AS cval_lineitem_l_linestatus_0#6831, cval_lineitem_l_commitdate#6799 AS cval_lineitem_l_commitdate_0#6832, cval_lineitem_l_receiptdate#6800 AS cval_lineitem_l_receiptdate_0#6833, cval_lineitem_l_shipinstruct#6801 AS cval_lineitem_l_shipinstruct_0#6834, cval_lineitem_l_shipmode#6802 AS cval_lineitem_l_shipmode_0#6835, cval_lineitem_l_comment#6803 AS cval_lineitem_l_comment_0#6836, cval_lineitem_l_shipdate#6804 AS cval_lineitem_l_shipdate_0#6837, cl_quantity#6805 AS cl_quantity_0#6838, cl_extendedprice#6806 AS cl_extendedprice_0#6839, cl_discount#6807 AS cl_discount_0#6840, ... 9 more fields]
         +- Relation[rid#6784,cpfk_orders_lineitem#6785,cpfk_supplier_lineitem#6786,cfpk_lineitem_supplier#6787,cfpk_lineitem_partsupp#6788,cpfk_part_lineitem#6789,cfpk_lineitem_part#6790,cpfk_partsupp_lineitem#6791,cfpk_lineitem_orders#6792,cval_lineitem_l_quantity#6793,cval_lineitem_l_extendedprice#6794,cval_lineitem_l_discount#6795,cval_lineitem_l_tax#6796,cval_lineitem_l_returnflag#6797,cval_lineitem_l_linestatus#6798,cval_lineitem_l_commitdate#6799,cval_lineitem_l_receiptdate#6800,cval_lineitem_l_shipinstruct#6801,cval_lineitem_l_shipmode#6802,cval_lineitem_l_comment#6803,cval_lineitem_l_shipdate#6804,cl_quantity#6805,cl_extendedprice#6806,cl_discount#6807,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2731ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/15 14:49:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:49:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6892L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 14:49:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6892L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#6894 AS rid_0#6909, cpfk_nation_customer#6895 AS cpfk_nation_customer_0#6910, cfpk_customer_nation#6896 AS cfpk_customer_nation_0#6911, cval_customer_c_name#6897 AS cval_customer_c_name_0#6912, cval_customer_c_address#6898 AS cval_customer_c_address_0#6913, cval_customer_c_phone#6899 AS cval_customer_c_phone_0#6914, cval_customer_c_acctbal#6900 AS cval_customer_c_acctbal_0#6915, cval_customer_c_comment#6901 AS cval_customer_c_comment_0#6916, cval_customer_c_mktsegment#6902 AS cval_customer_c_mktsegment_0#6917, cc_name#6903 AS cc_name_0#6918, cc_address#6904 AS cc_address_0#6919, cc_phone#6905 AS cc_phone_0#6920, cc_acctbal#6906 AS cc_acctbal_0#6921, cc_comment#6907 AS cc_comment_0#6922, cc_mktsegment#6908 AS cc_mktsegment_0#6923]
         :  :  :  :  +- Relation[rid#6894,cpfk_nation_customer#6895,cfpk_customer_nation#6896,cval_customer_c_name#6897,cval_customer_c_address#6898,cval_customer_c_phone#6899,cval_customer_c_acctbal#6900,cval_customer_c_comment#6901,cval_customer_c_mktsegment#6902,cc_name#6903,cc_address#6904,cc_phone#6905,cc_acctbal#6906,cc_comment#6907,cc_mktsegment#6908] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#6958 AS rid_0#6973, cpfk_nation_customer#6959 AS cpfk_nation_customer_0#6974, cfpk_customer_nation#6960 AS cfpk_customer_nation_0#6975, cval_customer_c_name#6961 AS cval_customer_c_name_0#6976, cval_customer_c_address#6962 AS cval_customer_c_address_0#6977, cval_customer_c_phone#6963 AS cval_customer_c_phone_0#6978, cval_customer_c_acctbal#6964 AS cval_customer_c_acctbal_0#6979, cval_customer_c_comment#6965 AS cval_customer_c_comment_0#6980, cval_customer_c_mktsegment#6966 AS cval_customer_c_mktsegment_0#6981, cc_name#6967 AS cc_name_0#6982, cc_address#6968 AS cc_address_0#6983, cc_phone#6969 AS cc_phone_0#6984, cc_acctbal#6970 AS cc_acctbal_0#6985, cc_comment#6971 AS cc_comment_0#6986, cc_mktsegment#6972 AS cc_mktsegment_0#6987]
         :  :  :     :  +- Relation[rid#6958,cpfk_nation_customer#6959,cfpk_customer_nation#6960,cval_customer_c_name#6961,cval_customer_c_address#6962,cval_customer_c_phone#6963,cval_customer_c_acctbal#6964,cval_customer_c_comment#6965,cval_customer_c_mktsegment#6966,cc_name#6967,cc_address#6968,cc_phone#6969,cc_acctbal#6970,cc_comment#6971,cc_mktsegment#6972] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#6988 AS rid_1#7005, cpfk_customer_orders#6989 AS cpfk_customer_orders_1#7006, cfpk_orders_customer#6990 AS cfpk_orders_customer_1#7007, cval_orders_o_orderstatus#6991 AS cval_orders_o_orderstatus_1#7008, cval_orders_o_totalprice#6992 AS cval_orders_o_totalprice_1#7009, cval_orders_o_orderpriority#6993 AS cval_orders_o_orderpriority_1#7010, cval_orders_o_clerk#6994 AS cval_orders_o_clerk_1#7011, cval_orders_o_shippriority#6995 AS cval_orders_o_shippriority_1#7012, cval_orders_o_comment#6996 AS cval_orders_o_comment_1#7013, cval_orders_o_orderdate#6997 AS cval_orders_o_orderdate_1#7014, co_orderstatus#6998 AS co_orderstatus_1#7015, co_totalprice#6999 AS co_totalprice_1#7016, co_orderpriority#7000 AS co_orderpriority_1#7017, co_clerk#7001 AS co_clerk_1#7018, co_shippriority#7002 AS co_shippriority_1#7019, co_comment#7003 AS co_comment_1#7020, co_orderdate#7004 AS co_orderdate_1#7021]
         :  :  :        +- Relation[rid#6988,cpfk_customer_orders#6989,cfpk_orders_customer#6990,cval_orders_o_orderstatus#6991,cval_orders_o_totalprice#6992,cval_orders_o_orderpriority#6993,cval_orders_o_clerk#6994,cval_orders_o_shippriority#6995,cval_orders_o_comment#6996,cval_orders_o_orderdate#6997,co_orderstatus#6998,co_totalprice#6999,co_orderpriority#7000,co_clerk#7001,co_shippriority#7002,co_comment#7003,co_orderdate#7004] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#6924 AS rid_1#6941, cpfk_customer_orders#6925 AS cpfk_customer_orders_1#6942, cfpk_orders_customer#6926 AS cfpk_orders_customer_1#6943, cval_orders_o_orderstatus#6927 AS cval_orders_o_orderstatus_1#6944, cval_orders_o_totalprice#6928 AS cval_orders_o_totalprice_1#6945, cval_orders_o_orderpriority#6929 AS cval_orders_o_orderpriority_1#6946, cval_orders_o_clerk#6930 AS cval_orders_o_clerk_1#6947, cval_orders_o_shippriority#6931 AS cval_orders_o_shippriority_1#6948, cval_orders_o_comment#6932 AS cval_orders_o_comment_1#6949, cval_orders_o_orderdate#6933 AS cval_orders_o_orderdate_1#6950, co_orderstatus#6934 AS co_orderstatus_1#6951, co_totalprice#6935 AS co_totalprice_1#6952, co_orderpriority#6936 AS co_orderpriority_1#6953, co_clerk#6937 AS co_clerk_1#6954, co_shippriority#6938 AS co_shippriority_1#6955, co_comment#6939 AS co_comment_1#6956, co_orderdate#6940 AS co_orderdate_1#6957]
         :  :     +- Relation[rid#6924,cpfk_customer_orders#6925,cfpk_orders_customer#6926,cval_orders_o_orderstatus#6927,cval_orders_o_totalprice#6928,cval_orders_o_orderpriority#6929,cval_orders_o_clerk#6930,cval_orders_o_shippriority#6931,cval_orders_o_comment#6932,cval_orders_o_orderdate#6933,co_orderstatus#6934,co_totalprice#6935,co_orderpriority#6936,co_clerk#6937,co_shippriority#6938,co_comment#6939,co_orderdate#6940] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#7088 AS rid_1#7105, cpfk_customer_orders#7089 AS cpfk_customer_orders_1#7106, cfpk_orders_customer#7090 AS cfpk_orders_customer_1#7107, cval_orders_o_orderstatus#7091 AS cval_orders_o_orderstatus_1#7108, cval_orders_o_totalprice#7092 AS cval_orders_o_totalprice_1#7109, cval_orders_o_orderpriority#7093 AS cval_orders_o_orderpriority_1#7110, cval_orders_o_clerk#7094 AS cval_orders_o_clerk_1#7111, cval_orders_o_shippriority#7095 AS cval_orders_o_shippriority_1#7112, cval_orders_o_comment#7096 AS cval_orders_o_comment_1#7113, cval_orders_o_orderdate#7097 AS cval_orders_o_orderdate_1#7114, co_orderstatus#7098 AS co_orderstatus_1#7115, co_totalprice#7099 AS co_totalprice_1#7116, co_orderpriority#7100 AS co_orderpriority_1#7117, co_clerk#7101 AS co_clerk_1#7118, co_shippriority#7102 AS co_shippriority_1#7119, co_comment#7103 AS co_comment_1#7120, co_orderdate#7104 AS co_orderdate_1#7121]
         :     :  +- Relation[rid#7088,cpfk_customer_orders#7089,cfpk_orders_customer#7090,cval_orders_o_orderstatus#7091,cval_orders_o_totalprice#7092,cval_orders_o_orderpriority#7093,cval_orders_o_clerk#7094,cval_orders_o_shippriority#7095,cval_orders_o_comment#7096,cval_orders_o_orderdate#7097,co_orderstatus#7098,co_totalprice#7099,co_orderpriority#7100,co_clerk#7101,co_shippriority#7102,co_comment#7103,co_orderdate#7104] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#7122 AS rid_2#7155, cpfk_orders_lineitem#7123 AS cpfk_orders_lineitem_2#7156, cpfk_supplier_lineitem#7124 AS cpfk_supplier_lineitem_2#7157, cfpk_lineitem_supplier#7125 AS cfpk_lineitem_supplier_2#7158, cfpk_lineitem_partsupp#7126 AS cfpk_lineitem_partsupp_2#7159, cpfk_part_lineitem#7127 AS cpfk_part_lineitem_2#7160, cfpk_lineitem_part#7128 AS cfpk_lineitem_part_2#7161, cpfk_partsupp_lineitem#7129 AS cpfk_partsupp_lineitem_2#7162, cfpk_lineitem_orders#7130 AS cfpk_lineitem_orders_2#7163, cval_lineitem_l_quantity#7131 AS cval_lineitem_l_quantity_2#7164, cval_lineitem_l_extendedprice#7132 AS cval_lineitem_l_extendedprice_2#7165, cval_lineitem_l_discount#7133 AS cval_lineitem_l_discount_2#7166, cval_lineitem_l_tax#7134 AS cval_lineitem_l_tax_2#7167, cval_lineitem_l_returnflag#7135 AS cval_lineitem_l_returnflag_2#7168, cval_lineitem_l_linestatus#7136 AS cval_lineitem_l_linestatus_2#7169, cval_lineitem_l_commitdate#7137 AS cval_lineitem_l_commitdate_2#7170, cval_lineitem_l_receiptdate#7138 AS cval_lineitem_l_receiptdate_2#7171, cval_lineitem_l_shipinstruct#7139 AS cval_lineitem_l_shipinstruct_2#7172, cval_lineitem_l_shipmode#7140 AS cval_lineitem_l_shipmode_2#7173, cval_lineitem_l_comment#7141 AS cval_lineitem_l_comment_2#7174, cval_lineitem_l_shipdate#7142 AS cval_lineitem_l_shipdate_2#7175, cl_quantity#7143 AS cl_quantity_2#7176, cl_extendedprice#7144 AS cl_extendedprice_2#7177, cl_discount#7145 AS cl_discount_2#7178, ... 9 more fields]
         :        +- Relation[rid#7122,cpfk_orders_lineitem#7123,cpfk_supplier_lineitem#7124,cfpk_lineitem_supplier#7125,cfpk_lineitem_partsupp#7126,cpfk_part_lineitem#7127,cfpk_lineitem_part#7128,cpfk_partsupp_lineitem#7129,cfpk_lineitem_orders#7130,cval_lineitem_l_quantity#7131,cval_lineitem_l_extendedprice#7132,cval_lineitem_l_discount#7133,cval_lineitem_l_tax#7134,cval_lineitem_l_returnflag#7135,cval_lineitem_l_linestatus#7136,cval_lineitem_l_commitdate#7137,cval_lineitem_l_receiptdate#7138,cval_lineitem_l_shipinstruct#7139,cval_lineitem_l_shipmode#7140,cval_lineitem_l_comment#7141,cval_lineitem_l_shipdate#7142,cl_quantity#7143,cl_extendedprice#7144,cl_discount#7145,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7022 AS rid_2#7055, cpfk_orders_lineitem#7023 AS cpfk_orders_lineitem_2#7056, cpfk_supplier_lineitem#7024 AS cpfk_supplier_lineitem_2#7057, cfpk_lineitem_supplier#7025 AS cfpk_lineitem_supplier_2#7058, cfpk_lineitem_partsupp#7026 AS cfpk_lineitem_partsupp_2#7059, cpfk_part_lineitem#7027 AS cpfk_part_lineitem_2#7060, cfpk_lineitem_part#7028 AS cfpk_lineitem_part_2#7061, cpfk_partsupp_lineitem#7029 AS cpfk_partsupp_lineitem_2#7062, cfpk_lineitem_orders#7030 AS cfpk_lineitem_orders_2#7063, cval_lineitem_l_quantity#7031 AS cval_lineitem_l_quantity_2#7064, cval_lineitem_l_extendedprice#7032 AS cval_lineitem_l_extendedprice_2#7065, cval_lineitem_l_discount#7033 AS cval_lineitem_l_discount_2#7066, cval_lineitem_l_tax#7034 AS cval_lineitem_l_tax_2#7067, cval_lineitem_l_returnflag#7035 AS cval_lineitem_l_returnflag_2#7068, cval_lineitem_l_linestatus#7036 AS cval_lineitem_l_linestatus_2#7069, cval_lineitem_l_commitdate#7037 AS cval_lineitem_l_commitdate_2#7070, cval_lineitem_l_receiptdate#7038 AS cval_lineitem_l_receiptdate_2#7071, cval_lineitem_l_shipinstruct#7039 AS cval_lineitem_l_shipinstruct_2#7072, cval_lineitem_l_shipmode#7040 AS cval_lineitem_l_shipmode_2#7073, cval_lineitem_l_comment#7041 AS cval_lineitem_l_comment_2#7074, cval_lineitem_l_shipdate#7042 AS cval_lineitem_l_shipdate_2#7075, cl_quantity#7043 AS cl_quantity_2#7076, cl_extendedprice#7044 AS cl_extendedprice_2#7077, cl_discount#7045 AS cl_discount_2#7078, ... 9 more fields]
            +- Relation[rid#7022,cpfk_orders_lineitem#7023,cpfk_supplier_lineitem#7024,cfpk_lineitem_supplier#7025,cfpk_lineitem_partsupp#7026,cpfk_part_lineitem#7027,cfpk_lineitem_part#7028,cpfk_partsupp_lineitem#7029,cfpk_lineitem_orders#7030,cval_lineitem_l_quantity#7031,cval_lineitem_l_extendedprice#7032,cval_lineitem_l_discount#7033,cval_lineitem_l_tax#7034,cval_lineitem_l_returnflag#7035,cval_lineitem_l_linestatus#7036,cval_lineitem_l_commitdate#7037,cval_lineitem_l_receiptdate#7038,cval_lineitem_l_shipinstruct#7039,cval_lineitem_l_shipmode#7040,cval_lineitem_l_comment#7041,cval_lineitem_l_shipdate#7042,cl_quantity#7043,cl_extendedprice#7044,cl_discount#7045,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 124249ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 14:51:53 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:51:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7262L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 14:51:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:51:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:51:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:51:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:51:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:51:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:51:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:51:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:51:54 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:51:54 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:51:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7262L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#7264 AS rid_0#7271, cpfk_region_nation#7265 AS cpfk_region_nation_0#7272, cfpk_nation_region#7266 AS cfpk_nation_region_0#7273, cval_nation_n_name#7267 AS cval_nation_n_name_0#7274, cval_nation_n_comment#7268 AS cval_nation_n_comment_0#7275, cn_name#7269 AS cn_name_0#7276, cn_comment#7270 AS cn_comment_0#7277]
            :     :     :  :  :  :  :  +- Relation[rid#7264,cpfk_region_nation#7265,cfpk_nation_region#7266,cval_nation_n_name#7267,cval_nation_n_comment#7268,cn_name#7269,cn_comment#7270] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#7304 AS rid_0#7311, cpfk_region_nation#7305 AS cpfk_region_nation_0#7312, cfpk_nation_region#7306 AS cfpk_nation_region_0#7313, cval_nation_n_name#7307 AS cval_nation_n_name_0#7314, cval_nation_n_comment#7308 AS cval_nation_n_comment_0#7315, cn_name#7309 AS cn_name_0#7316, cn_comment#7310 AS cn_comment_0#7317]
            :     :     :  :  :  :     :  +- Relation[rid#7304,cpfk_region_nation#7305,cfpk_nation_region#7306,cval_nation_n_name#7307,cval_nation_n_comment#7308,cn_name#7309,cn_comment#7310] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#7318 AS rid_1#7331, cpfk_nation_supplier#7319 AS cpfk_nation_supplier_1#7332, cfpk_supplier_nation#7320 AS cfpk_supplier_nation_1#7333, cval_supplier_s_name#7321 AS cval_supplier_s_name_1#7334, cval_supplier_s_address#7322 AS cval_supplier_s_address_1#7335, cval_supplier_s_phone#7323 AS cval_supplier_s_phone_1#7336, cval_supplier_s_acctbal#7324 AS cval_supplier_s_acctbal_1#7337, cval_supplier_s_comment#7325 AS cval_supplier_s_comment_1#7338, cs_name#7326 AS cs_name_1#7339, cs_address#7327 AS cs_address_1#7340, cs_phone#7328 AS cs_phone_1#7341, cs_acctbal#7329 AS cs_acctbal_1#7342, cs_comment#7330 AS cs_comment_1#7343]
            :     :     :  :  :  :        +- Relation[rid#7318,cpfk_nation_supplier#7319,cfpk_supplier_nation#7320,cval_supplier_s_name#7321,cval_supplier_s_address#7322,cval_supplier_s_phone#7323,cval_supplier_s_acctbal#7324,cval_supplier_s_comment#7325,cs_name#7326,cs_address#7327,cs_phone#7328,cs_acctbal#7329,cs_comment#7330] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#7278 AS rid_1#7291, cpfk_nation_supplier#7279 AS cpfk_nation_supplier_1#7292, cfpk_supplier_nation#7280 AS cfpk_supplier_nation_1#7293, cval_supplier_s_name#7281 AS cval_supplier_s_name_1#7294, cval_supplier_s_address#7282 AS cval_supplier_s_address_1#7295, cval_supplier_s_phone#7283 AS cval_supplier_s_phone_1#7296, cval_supplier_s_acctbal#7284 AS cval_supplier_s_acctbal_1#7297, cval_supplier_s_comment#7285 AS cval_supplier_s_comment_1#7298, cs_name#7286 AS cs_name_1#7299, cs_address#7287 AS cs_address_1#7300, cs_phone#7288 AS cs_phone_1#7301, cs_acctbal#7289 AS cs_acctbal_1#7302, cs_comment#7290 AS cs_comment_1#7303]
            :     :     :  :  :     +- Relation[rid#7278,cpfk_nation_supplier#7279,cfpk_supplier_nation#7280,cval_supplier_s_name#7281,cval_supplier_s_address#7282,cval_supplier_s_phone#7283,cval_supplier_s_acctbal#7284,cval_supplier_s_comment#7285,cs_name#7286,cs_address#7287,cs_phone#7288,cs_acctbal#7289,cs_comment#7290] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#7410 AS rid_1#7423, cpfk_nation_supplier#7411 AS cpfk_nation_supplier_1#7424, cfpk_supplier_nation#7412 AS cfpk_supplier_nation_1#7425, cval_supplier_s_name#7413 AS cval_supplier_s_name_1#7426, cval_supplier_s_address#7414 AS cval_supplier_s_address_1#7427, cval_supplier_s_phone#7415 AS cval_supplier_s_phone_1#7428, cval_supplier_s_acctbal#7416 AS cval_supplier_s_acctbal_1#7429, cval_supplier_s_comment#7417 AS cval_supplier_s_comment_1#7430, cs_name#7418 AS cs_name_1#7431, cs_address#7419 AS cs_address_1#7432, cs_phone#7420 AS cs_phone_1#7433, cs_acctbal#7421 AS cs_acctbal_1#7434, cs_comment#7422 AS cs_comment_1#7435]
            :     :     :  :     :  +- Relation[rid#7410,cpfk_nation_supplier#7411,cfpk_supplier_nation#7412,cval_supplier_s_name#7413,cval_supplier_s_address#7414,cval_supplier_s_phone#7415,cval_supplier_s_acctbal#7416,cval_supplier_s_comment#7417,cs_name#7418,cs_address#7419,cs_phone#7420,cs_acctbal#7421,cs_comment#7422] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#7436 AS rid_2#7469, cpfk_orders_lineitem#7437 AS cpfk_orders_lineitem_2#7470, cpfk_supplier_lineitem#7438 AS cpfk_supplier_lineitem_2#7471, cfpk_lineitem_supplier#7439 AS cfpk_lineitem_supplier_2#7472, cfpk_lineitem_partsupp#7440 AS cfpk_lineitem_partsupp_2#7473, cpfk_part_lineitem#7441 AS cpfk_part_lineitem_2#7474, cfpk_lineitem_part#7442 AS cfpk_lineitem_part_2#7475, cpfk_partsupp_lineitem#7443 AS cpfk_partsupp_lineitem_2#7476, cfpk_lineitem_orders#7444 AS cfpk_lineitem_orders_2#7477, cval_lineitem_l_quantity#7445 AS cval_lineitem_l_quantity_2#7478, cval_lineitem_l_extendedprice#7446 AS cval_lineitem_l_extendedprice_2#7479, cval_lineitem_l_discount#7447 AS cval_lineitem_l_discount_2#7480, cval_lineitem_l_tax#7448 AS cval_lineitem_l_tax_2#7481, cval_lineitem_l_returnflag#7449 AS cval_lineitem_l_returnflag_2#7482, cval_lineitem_l_linestatus#7450 AS cval_lineitem_l_linestatus_2#7483, cval_lineitem_l_commitdate#7451 AS cval_lineitem_l_commitdate_2#7484, cval_lineitem_l_receiptdate#7452 AS cval_lineitem_l_receiptdate_2#7485, cval_lineitem_l_shipinstruct#7453 AS cval_lineitem_l_shipinstruct_2#7486, cval_lineitem_l_shipmode#7454 AS cval_lineitem_l_shipmode_2#7487, cval_lineitem_l_comment#7455 AS cval_lineitem_l_comment_2#7488, cval_lineitem_l_shipdate#7456 AS cval_lineitem_l_shipdate_2#7489, cl_quantity#7457 AS cl_quantity_2#7490, cl_extendedprice#7458 AS cl_extendedprice_2#7491, cl_discount#7459 AS cl_discount_2#7492, ... 9 more fields]
            :     :     :  :        +- Relation[rid#7436,cpfk_orders_lineitem#7437,cpfk_supplier_lineitem#7438,cfpk_lineitem_supplier#7439,cfpk_lineitem_partsupp#7440,cpfk_part_lineitem#7441,cfpk_lineitem_part#7442,cpfk_partsupp_lineitem#7443,cfpk_lineitem_orders#7444,cval_lineitem_l_quantity#7445,cval_lineitem_l_extendedprice#7446,cval_lineitem_l_discount#7447,cval_lineitem_l_tax#7448,cval_lineitem_l_returnflag#7449,cval_lineitem_l_linestatus#7450,cval_lineitem_l_commitdate#7451,cval_lineitem_l_receiptdate#7452,cval_lineitem_l_shipinstruct#7453,cval_lineitem_l_shipmode#7454,cval_lineitem_l_comment#7455,cval_lineitem_l_shipdate#7456,cl_quantity#7457,cl_extendedprice#7458,cl_discount#7459,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#7344 AS rid_2#7377, cpfk_orders_lineitem#7345 AS cpfk_orders_lineitem_2#7378, cpfk_supplier_lineitem#7346 AS cpfk_supplier_lineitem_2#7379, cfpk_lineitem_supplier#7347 AS cfpk_lineitem_supplier_2#7380, cfpk_lineitem_partsupp#7348 AS cfpk_lineitem_partsupp_2#7381, cpfk_part_lineitem#7349 AS cpfk_part_lineitem_2#7382, cfpk_lineitem_part#7350 AS cfpk_lineitem_part_2#7383, cpfk_partsupp_lineitem#7351 AS cpfk_partsupp_lineitem_2#7384, cfpk_lineitem_orders#7352 AS cfpk_lineitem_orders_2#7385, cval_lineitem_l_quantity#7353 AS cval_lineitem_l_quantity_2#7386, cval_lineitem_l_extendedprice#7354 AS cval_lineitem_l_extendedprice_2#7387, cval_lineitem_l_discount#7355 AS cval_lineitem_l_discount_2#7388, cval_lineitem_l_tax#7356 AS cval_lineitem_l_tax_2#7389, cval_lineitem_l_returnflag#7357 AS cval_lineitem_l_returnflag_2#7390, cval_lineitem_l_linestatus#7358 AS cval_lineitem_l_linestatus_2#7391, cval_lineitem_l_commitdate#7359 AS cval_lineitem_l_commitdate_2#7392, cval_lineitem_l_receiptdate#7360 AS cval_lineitem_l_receiptdate_2#7393, cval_lineitem_l_shipinstruct#7361 AS cval_lineitem_l_shipinstruct_2#7394, cval_lineitem_l_shipmode#7362 AS cval_lineitem_l_shipmode_2#7395, cval_lineitem_l_comment#7363 AS cval_lineitem_l_comment_2#7396, cval_lineitem_l_shipdate#7364 AS cval_lineitem_l_shipdate_2#7397, cl_quantity#7365 AS cl_quantity_2#7398, cl_extendedprice#7366 AS cl_extendedprice_2#7399, cl_discount#7367 AS cl_discount_2#7400, ... 9 more fields]
            :     :     :     +- Relation[rid#7344,cpfk_orders_lineitem#7345,cpfk_supplier_lineitem#7346,cfpk_lineitem_supplier#7347,cfpk_lineitem_partsupp#7348,cpfk_part_lineitem#7349,cfpk_lineitem_part#7350,cpfk_partsupp_lineitem#7351,cfpk_lineitem_orders#7352,cval_lineitem_l_quantity#7353,cval_lineitem_l_extendedprice#7354,cval_lineitem_l_discount#7355,cval_lineitem_l_tax#7356,cval_lineitem_l_returnflag#7357,cval_lineitem_l_linestatus#7358,cval_lineitem_l_commitdate#7359,cval_lineitem_l_receiptdate#7360,cval_lineitem_l_shipinstruct#7361,cval_lineitem_l_shipmode#7362,cval_lineitem_l_comment#7363,cval_lineitem_l_shipdate#7364,cl_quantity#7365,cl_extendedprice#7366,cl_discount#7367,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#7502 AS rid_3#7519, cval_part_p_name#7503 AS cval_part_p_name_3#7520, cval_part_p_mfgr#7504 AS cval_part_p_mfgr_3#7521, cval_part_p_type#7505 AS cval_part_p_type_3#7522, cval_part_p_size#7506 AS cval_part_p_size_3#7523, cval_part_p_container#7507 AS cval_part_p_container_3#7524, cval_part_p_retailprice#7508 AS cval_part_p_retailprice_3#7525, cval_part_p_comment#7509 AS cval_part_p_comment_3#7526, cval_part_p_brand#7510 AS cval_part_p_brand_3#7527, cp_name#7511 AS cp_name_3#7528, cp_mfgr#7512 AS cp_mfgr_3#7529, cp_type#7513 AS cp_type_3#7530, cp_size#7514 AS cp_size_3#7531, cp_container#7515 AS cp_container_3#7532, cp_retailprice#7516 AS cp_retailprice_3#7533, cp_comment#7517 AS cp_comment_3#7534, cp_brand#7518 AS cp_brand_3#7535]
            :     :        +- Relation[rid#7502,cval_part_p_name#7503,cval_part_p_mfgr#7504,cval_part_p_type#7505,cval_part_p_size#7506,cval_part_p_container#7507,cval_part_p_retailprice#7508,cval_part_p_comment#7509,cval_part_p_brand#7510,cp_name#7511,cp_mfgr#7512,cp_type#7513,cp_size#7514,cp_container#7515,cp_retailprice#7516,cp_comment#7517,cp_brand#7518] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#7536 AS rid_4#7547, cpfk_part_partsupp#7537 AS cpfk_part_partsupp_4#7548, cfpk_partsupp_part#7538 AS cfpk_partsupp_part_4#7549, cpfk_supplier_partsupp#7539 AS cpfk_supplier_partsupp_4#7550, cfpk_partsupp_supplier#7540 AS cfpk_partsupp_supplier_4#7551, cval_partsupp_ps_availqty#7541 AS cval_partsupp_ps_availqty_4#7552, cval_partsupp_ps_supplycost#7542 AS cval_partsupp_ps_supplycost_4#7553, cval_partsupp_ps_comment#7543 AS cval_partsupp_ps_comment_4#7554, cps_availqty#7544 AS cps_availqty_4#7555, cps_supplycost#7545 AS cps_supplycost_4#7556, cps_comment#7546 AS cps_comment_4#7557]
            :        +- Relation[rid#7536,cpfk_part_partsupp#7537,cfpk_partsupp_part#7538,cpfk_supplier_partsupp#7539,cfpk_partsupp_supplier#7540,cval_partsupp_ps_availqty#7541,cval_partsupp_ps_supplycost#7542,cval_partsupp_ps_comment#7543,cps_availqty#7544,cps_supplycost#7545,cps_comment#7546] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#7558 AS rid_5#7575, cpfk_customer_orders#7559 AS cpfk_customer_orders_5#7576, cfpk_orders_customer#7560 AS cfpk_orders_customer_5#7577, cval_orders_o_orderstatus#7561 AS cval_orders_o_orderstatus_5#7578, cval_orders_o_totalprice#7562 AS cval_orders_o_totalprice_5#7579, cval_orders_o_orderpriority#7563 AS cval_orders_o_orderpriority_5#7580, cval_orders_o_clerk#7564 AS cval_orders_o_clerk_5#7581, cval_orders_o_shippriority#7565 AS cval_orders_o_shippriority_5#7582, cval_orders_o_comment#7566 AS cval_orders_o_comment_5#7583, cval_orders_o_orderdate#7567 AS cval_orders_o_orderdate_5#7584, co_orderstatus#7568 AS co_orderstatus_5#7585, co_totalprice#7569 AS co_totalprice_5#7586, co_orderpriority#7570 AS co_orderpriority_5#7587, co_clerk#7571 AS co_clerk_5#7588, co_shippriority#7572 AS co_shippriority_5#7589, co_comment#7573 AS co_comment_5#7590, co_orderdate#7574 AS co_orderdate_5#7591]
               +- Relation[rid#7558,cpfk_customer_orders#7559,cfpk_orders_customer#7560,cval_orders_o_orderstatus#7561,cval_orders_o_totalprice#7562,cval_orders_o_orderpriority#7563,cval_orders_o_clerk#7564,cval_orders_o_shippriority#7565,cval_orders_o_comment#7566,cval_orders_o_orderdate#7567,co_orderstatus#7568,co_totalprice#7569,co_orderpriority#7570,co_clerk#7571,co_shippriority#7572,co_comment#7573,co_orderdate#7574] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 266878ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/15 14:56:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:56:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7695L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 14:56:20 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:56:20 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:56:20 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:56:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:56:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:56:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:56:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:56:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:56:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:56:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:56:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:56:20 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 14:56:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:56:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7695L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#7697 AS rid_0#7714, cval_part_p_name#7698 AS cval_part_p_name_0#7715, cval_part_p_mfgr#7699 AS cval_part_p_mfgr_0#7716, cval_part_p_type#7700 AS cval_part_p_type_0#7717, cval_part_p_size#7701 AS cval_part_p_size_0#7718, cval_part_p_container#7702 AS cval_part_p_container_0#7719, cval_part_p_retailprice#7703 AS cval_part_p_retailprice_0#7720, cval_part_p_comment#7704 AS cval_part_p_comment_0#7721, cval_part_p_brand#7705 AS cval_part_p_brand_0#7722, cp_name#7706 AS cp_name_0#7723, cp_mfgr#7707 AS cp_mfgr_0#7724, cp_type#7708 AS cp_type_0#7725, cp_size#7709 AS cp_size_0#7726, cp_container#7710 AS cp_container_0#7727, cp_retailprice#7711 AS cp_retailprice_0#7728, cp_comment#7712 AS cp_comment_0#7729, cp_brand#7713 AS cp_brand_0#7730]
            :  :  :  :  +- Relation[rid#7697,cval_part_p_name#7698,cval_part_p_mfgr#7699,cval_part_p_type#7700,cval_part_p_size#7701,cval_part_p_container#7702,cval_part_p_retailprice#7703,cval_part_p_comment#7704,cval_part_p_brand#7705,cp_name#7706,cp_mfgr#7707,cp_type#7708,cp_size#7709,cp_container#7710,cp_retailprice#7711,cp_comment#7712,cp_brand#7713] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#7731 AS rid_0#7748, cval_part_p_name#7732 AS cval_part_p_name_0#7749, cval_part_p_mfgr#7733 AS cval_part_p_mfgr_0#7750, cval_part_p_type#7734 AS cval_part_p_type_0#7751, cval_part_p_size#7735 AS cval_part_p_size_0#7752, cval_part_p_container#7736 AS cval_part_p_container_0#7753, cval_part_p_retailprice#7737 AS cval_part_p_retailprice_0#7754, cval_part_p_comment#7738 AS cval_part_p_comment_0#7755, cval_part_p_brand#7739 AS cval_part_p_brand_0#7756, cp_name#7740 AS cp_name_0#7757, cp_mfgr#7741 AS cp_mfgr_0#7758, cp_type#7742 AS cp_type_0#7759, cp_size#7743 AS cp_size_0#7760, cp_container#7744 AS cp_container_0#7761, cp_retailprice#7745 AS cp_retailprice_0#7762, cp_comment#7746 AS cp_comment_0#7763, cp_brand#7747 AS cp_brand_0#7764]
            :  :  :        +- Relation[rid#7731,cval_part_p_name#7732,cval_part_p_mfgr#7733,cval_part_p_type#7734,cval_part_p_size#7735,cval_part_p_container#7736,cval_part_p_retailprice#7737,cval_part_p_comment#7738,cval_part_p_brand#7739,cp_name#7740,cp_mfgr#7741,cp_type#7742,cp_size#7743,cp_container#7744,cp_retailprice#7745,cp_comment#7746,cp_brand#7747] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- Project [rid#7821 AS rid_1#7832, cpfk_part_partsupp#7822 AS cpfk_part_partsupp_1#7833, cfpk_partsupp_part#7823 AS cfpk_partsupp_part_1#7834, cpfk_supplier_partsupp#7824 AS cpfk_supplier_partsupp_1#7835, cfpk_partsupp_supplier#7825 AS cfpk_partsupp_supplier_1#7836, cval_partsupp_ps_availqty#7826 AS cval_partsupp_ps_availqty_1#7837, cval_partsupp_ps_supplycost#7827 AS cval_partsupp_ps_supplycost_1#7838, cval_partsupp_ps_comment#7828 AS cval_partsupp_ps_comment_1#7839, cps_availqty#7829 AS cps_availqty_1#7840, cps_supplycost#7830 AS cps_supplycost_1#7841, cps_comment#7831 AS cps_comment_1#7842]
            :  :     +- Relation[rid#7821,cpfk_part_partsupp#7822,cfpk_partsupp_part#7823,cpfk_supplier_partsupp#7824,cfpk_partsupp_supplier#7825,cval_partsupp_ps_availqty#7826,cval_partsupp_ps_supplycost#7827,cval_partsupp_ps_comment#7828,cps_availqty#7829,cps_supplycost#7830,cps_comment#7831] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#7765 AS rid_1#7776, cpfk_part_partsupp#7766 AS cpfk_part_partsupp_1#7777, cfpk_partsupp_part#7767 AS cfpk_partsupp_part_1#7778, cpfk_supplier_partsupp#7768 AS cpfk_supplier_partsupp_1#7779, cfpk_partsupp_supplier#7769 AS cfpk_partsupp_supplier_1#7780, cval_partsupp_ps_availqty#7770 AS cval_partsupp_ps_availqty_1#7781, cval_partsupp_ps_supplycost#7771 AS cval_partsupp_ps_supplycost_1#7782, cval_partsupp_ps_comment#7772 AS cval_partsupp_ps_comment_1#7783, cps_availqty#7773 AS cps_availqty_1#7784, cps_supplycost#7774 AS cps_supplycost_1#7785, cps_comment#7775 AS cps_comment_1#7786]
            :     +- Relation[rid#7765,cpfk_part_partsupp#7766,cfpk_partsupp_part#7767,cpfk_supplier_partsupp#7768,cfpk_partsupp_supplier#7769,cval_partsupp_ps_availqty#7770,cval_partsupp_ps_supplycost#7771,cval_partsupp_ps_comment#7772,cps_availqty#7773,cps_supplycost#7774,cps_comment#7775] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#7843 AS rid_2#7850, cpfk_region_nation#7844 AS cpfk_region_nation_2#7851, cfpk_nation_region#7845 AS cfpk_nation_region_2#7852, cval_nation_n_name#7846 AS cval_nation_n_name_2#7853, cval_nation_n_comment#7847 AS cval_nation_n_comment_2#7854, cn_name#7848 AS cn_name_2#7855, cn_comment#7849 AS cn_comment_2#7856]
               :  :  :  +- Relation[rid#7843,cpfk_region_nation#7844,cfpk_nation_region#7845,cval_nation_n_name#7846,cval_nation_n_comment#7847,cn_name#7848,cn_comment#7849] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#7857 AS rid_2#7864, cpfk_region_nation#7858 AS cpfk_region_nation_2#7865, cfpk_nation_region#7859 AS cfpk_nation_region_2#7866, cval_nation_n_name#7860 AS cval_nation_n_name_2#7867, cval_nation_n_comment#7861 AS cval_nation_n_comment_2#7868, cn_name#7862 AS cn_name_2#7869, cn_comment#7863 AS cn_comment_2#7870]
               :  :        +- Relation[rid#7857,cpfk_region_nation#7858,cfpk_nation_region#7859,cval_nation_n_name#7860,cval_nation_n_comment#7861,cn_name#7862,cn_comment#7863] JDBCRelation(tnation) [numPartitions=1]
               :  +- Project [rid#7911 AS rid_3#7924, cpfk_nation_supplier#7912 AS cpfk_nation_supplier_3#7925, cfpk_supplier_nation#7913 AS cfpk_supplier_nation_3#7926, cval_supplier_s_name#7914 AS cval_supplier_s_name_3#7927, cval_supplier_s_address#7915 AS cval_supplier_s_address_3#7928, cval_supplier_s_phone#7916 AS cval_supplier_s_phone_3#7929, cval_supplier_s_acctbal#7917 AS cval_supplier_s_acctbal_3#7930, cval_supplier_s_comment#7918 AS cval_supplier_s_comment_3#7931, cs_name#7919 AS cs_name_3#7932, cs_address#7920 AS cs_address_3#7933, cs_phone#7921 AS cs_phone_3#7934, cs_acctbal#7922 AS cs_acctbal_3#7935, cs_comment#7923 AS cs_comment_3#7936]
               :     +- Relation[rid#7911,cpfk_nation_supplier#7912,cfpk_supplier_nation#7913,cval_supplier_s_name#7914,cval_supplier_s_address#7915,cval_supplier_s_phone#7916,cval_supplier_s_acctbal#7917,cval_supplier_s_comment#7918,cs_name#7919,cs_address#7920,cs_phone#7921,cs_acctbal#7922,cs_comment#7923] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#7871 AS rid_3#7884, cpfk_nation_supplier#7872 AS cpfk_nation_supplier_3#7885, cfpk_supplier_nation#7873 AS cfpk_supplier_nation_3#7886, cval_supplier_s_name#7874 AS cval_supplier_s_name_3#7887, cval_supplier_s_address#7875 AS cval_supplier_s_address_3#7888, cval_supplier_s_phone#7876 AS cval_supplier_s_phone_3#7889, cval_supplier_s_acctbal#7877 AS cval_supplier_s_acctbal_3#7890, cval_supplier_s_comment#7878 AS cval_supplier_s_comment_3#7891, cs_name#7879 AS cs_name_3#7892, cs_address#7880 AS cs_address_3#7893, cs_phone#7881 AS cs_phone_3#7894, cs_acctbal#7882 AS cs_acctbal_3#7895, cs_comment#7883 AS cs_comment_3#7896]
                  +- Relation[rid#7871,cpfk_nation_supplier#7872,cfpk_supplier_nation#7873,cval_supplier_s_name#7874,cval_supplier_s_address#7875,cval_supplier_s_phone#7876,cval_supplier_s_acctbal#7877,cval_supplier_s_comment#7878,cs_name#7879,cs_address#7880,cs_phone#7881,cs_acctbal#7882,cs_comment#7883] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1
Elapsed time: 704ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/15 14:56:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:56:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7989L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 14:56:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7989L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#7991 AS rid_0#8008, cpfk_customer_orders#7992 AS cpfk_customer_orders_0#8009, cfpk_orders_customer#7993 AS cfpk_orders_customer_0#8010, cval_orders_o_orderstatus#7994 AS cval_orders_o_orderstatus_0#8011, cval_orders_o_totalprice#7995 AS cval_orders_o_totalprice_0#8012, cval_orders_o_orderpriority#7996 AS cval_orders_o_orderpriority_0#8013, cval_orders_o_clerk#7997 AS cval_orders_o_clerk_0#8014, cval_orders_o_shippriority#7998 AS cval_orders_o_shippriority_0#8015, cval_orders_o_comment#7999 AS cval_orders_o_comment_0#8016, cval_orders_o_orderdate#8000 AS cval_orders_o_orderdate_0#8017, co_orderstatus#8001 AS co_orderstatus_0#8018, co_totalprice#8002 AS co_totalprice_0#8019, co_orderpriority#8003 AS co_orderpriority_0#8020, co_clerk#8004 AS co_clerk_0#8021, co_shippriority#8005 AS co_shippriority_0#8022, co_comment#8006 AS co_comment_0#8023, co_orderdate#8007 AS co_orderdate_0#8024]
            :  +- Relation[rid#7991,cpfk_customer_orders#7992,cfpk_orders_customer#7993,cval_orders_o_orderstatus#7994,cval_orders_o_totalprice#7995,cval_orders_o_orderpriority#7996,cval_orders_o_clerk#7997,cval_orders_o_shippriority#7998,cval_orders_o_comment#7999,cval_orders_o_orderdate#8000,co_orderstatus#8001,co_totalprice#8002,co_orderpriority#8003,co_clerk#8004,co_shippriority#8005,co_comment#8006,co_orderdate#8007] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#8025 AS rid_1#8040, cpfk_nation_customer#8026 AS cpfk_nation_customer_1#8041, cfpk_customer_nation#8027 AS cfpk_customer_nation_1#8042, cval_customer_c_name#8028 AS cval_customer_c_name_1#8043, cval_customer_c_address#8029 AS cval_customer_c_address_1#8044, cval_customer_c_phone#8030 AS cval_customer_c_phone_1#8045, cval_customer_c_acctbal#8031 AS cval_customer_c_acctbal_1#8046, cval_customer_c_comment#8032 AS cval_customer_c_comment_1#8047, cval_customer_c_mktsegment#8033 AS cval_customer_c_mktsegment_1#8048, cc_name#8034 AS cc_name_1#8049, cc_address#8035 AS cc_address_1#8050, cc_phone#8036 AS cc_phone_1#8051, cc_acctbal#8037 AS cc_acctbal_1#8052, cc_comment#8038 AS cc_comment_1#8053, cc_mktsegment#8039 AS cc_mktsegment_1#8054]
               +- Relation[rid#8025,cpfk_nation_customer#8026,cfpk_customer_nation#8027,cval_customer_c_name#8028,cval_customer_c_address#8029,cval_customer_c_phone#8030,cval_customer_c_acctbal#8031,cval_customer_c_comment#8032,cval_customer_c_mktsegment#8033,cc_name#8034,cc_address#8035,cc_phone#8036,cc_acctbal#8037,cc_comment#8038,cc_mktsegment#8039] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13950ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/15 14:56:35 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:56:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8094L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 14:56:35 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:56:35 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:56:35 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:56:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8094L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#8096 AS rid_0#8109, cpfk_nation_supplier#8097 AS cpfk_nation_supplier_0#8110, cfpk_supplier_nation#8098 AS cfpk_supplier_nation_0#8111, cval_supplier_s_name#8099 AS cval_supplier_s_name_0#8112, cval_supplier_s_address#8100 AS cval_supplier_s_address_0#8113, cval_supplier_s_phone#8101 AS cval_supplier_s_phone_0#8114, cval_supplier_s_acctbal#8102 AS cval_supplier_s_acctbal_0#8115, cval_supplier_s_comment#8103 AS cval_supplier_s_comment_0#8116, cs_name#8104 AS cs_name_0#8117, cs_address#8105 AS cs_address_0#8118, cs_phone#8106 AS cs_phone_0#8119, cs_acctbal#8107 AS cs_acctbal_0#8120, cs_comment#8108 AS cs_comment_0#8121]
         :  :  +- Relation[rid#8096,cpfk_nation_supplier#8097,cfpk_supplier_nation#8098,cval_supplier_s_name#8099,cval_supplier_s_address#8100,cval_supplier_s_phone#8101,cval_supplier_s_acctbal#8102,cval_supplier_s_comment#8103,cs_name#8104,cs_address#8105,cs_phone#8106,cs_acctbal#8107,cs_comment#8108] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#8188 AS rid_0#8201, cpfk_nation_supplier#8189 AS cpfk_nation_supplier_0#8202, cfpk_supplier_nation#8190 AS cfpk_supplier_nation_0#8203, cval_supplier_s_name#8191 AS cval_supplier_s_name_0#8204, cval_supplier_s_address#8192 AS cval_supplier_s_address_0#8205, cval_supplier_s_phone#8193 AS cval_supplier_s_phone_0#8206, cval_supplier_s_acctbal#8194 AS cval_supplier_s_acctbal_0#8207, cval_supplier_s_comment#8195 AS cval_supplier_s_comment_0#8208, cs_name#8196 AS cs_name_0#8209, cs_address#8197 AS cs_address_0#8210, cs_phone#8198 AS cs_phone_0#8211, cs_acctbal#8199 AS cs_acctbal_0#8212, cs_comment#8200 AS cs_comment_0#8213]
         :     :  +- Relation[rid#8188,cpfk_nation_supplier#8189,cfpk_supplier_nation#8190,cval_supplier_s_name#8191,cval_supplier_s_address#8192,cval_supplier_s_phone#8193,cval_supplier_s_acctbal#8194,cval_supplier_s_comment#8195,cs_name#8196,cs_address#8197,cs_phone#8198,cs_acctbal#8199,cs_comment#8200] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#8214 AS rid_1#8247, cpfk_orders_lineitem#8215 AS cpfk_orders_lineitem_1#8248, cpfk_supplier_lineitem#8216 AS cpfk_supplier_lineitem_1#8249, cfpk_lineitem_supplier#8217 AS cfpk_lineitem_supplier_1#8250, cfpk_lineitem_partsupp#8218 AS cfpk_lineitem_partsupp_1#8251, cpfk_part_lineitem#8219 AS cpfk_part_lineitem_1#8252, cfpk_lineitem_part#8220 AS cfpk_lineitem_part_1#8253, cpfk_partsupp_lineitem#8221 AS cpfk_partsupp_lineitem_1#8254, cfpk_lineitem_orders#8222 AS cfpk_lineitem_orders_1#8255, cval_lineitem_l_quantity#8223 AS cval_lineitem_l_quantity_1#8256, cval_lineitem_l_extendedprice#8224 AS cval_lineitem_l_extendedprice_1#8257, cval_lineitem_l_discount#8225 AS cval_lineitem_l_discount_1#8258, cval_lineitem_l_tax#8226 AS cval_lineitem_l_tax_1#8259, cval_lineitem_l_returnflag#8227 AS cval_lineitem_l_returnflag_1#8260, cval_lineitem_l_linestatus#8228 AS cval_lineitem_l_linestatus_1#8261, cval_lineitem_l_commitdate#8229 AS cval_lineitem_l_commitdate_1#8262, cval_lineitem_l_receiptdate#8230 AS cval_lineitem_l_receiptdate_1#8263, cval_lineitem_l_shipinstruct#8231 AS cval_lineitem_l_shipinstruct_1#8264, cval_lineitem_l_shipmode#8232 AS cval_lineitem_l_shipmode_1#8265, cval_lineitem_l_comment#8233 AS cval_lineitem_l_comment_1#8266, cval_lineitem_l_shipdate#8234 AS cval_lineitem_l_shipdate_1#8267, cl_quantity#8235 AS cl_quantity_1#8268, cl_extendedprice#8236 AS cl_extendedprice_1#8269, cl_discount#8237 AS cl_discount_1#8270, ... 9 more fields]
         :        +- Relation[rid#8214,cpfk_orders_lineitem#8215,cpfk_supplier_lineitem#8216,cfpk_lineitem_supplier#8217,cfpk_lineitem_partsupp#8218,cpfk_part_lineitem#8219,cfpk_lineitem_part#8220,cpfk_partsupp_lineitem#8221,cfpk_lineitem_orders#8222,cval_lineitem_l_quantity#8223,cval_lineitem_l_extendedprice#8224,cval_lineitem_l_discount#8225,cval_lineitem_l_tax#8226,cval_lineitem_l_returnflag#8227,cval_lineitem_l_linestatus#8228,cval_lineitem_l_commitdate#8229,cval_lineitem_l_receiptdate#8230,cval_lineitem_l_shipinstruct#8231,cval_lineitem_l_shipmode#8232,cval_lineitem_l_comment#8233,cval_lineitem_l_shipdate#8234,cl_quantity#8235,cl_extendedprice#8236,cl_discount#8237,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8122 AS rid_1#8155, cpfk_orders_lineitem#8123 AS cpfk_orders_lineitem_1#8156, cpfk_supplier_lineitem#8124 AS cpfk_supplier_lineitem_1#8157, cfpk_lineitem_supplier#8125 AS cfpk_lineitem_supplier_1#8158, cfpk_lineitem_partsupp#8126 AS cfpk_lineitem_partsupp_1#8159, cpfk_part_lineitem#8127 AS cpfk_part_lineitem_1#8160, cfpk_lineitem_part#8128 AS cfpk_lineitem_part_1#8161, cpfk_partsupp_lineitem#8129 AS cpfk_partsupp_lineitem_1#8162, cfpk_lineitem_orders#8130 AS cfpk_lineitem_orders_1#8163, cval_lineitem_l_quantity#8131 AS cval_lineitem_l_quantity_1#8164, cval_lineitem_l_extendedprice#8132 AS cval_lineitem_l_extendedprice_1#8165, cval_lineitem_l_discount#8133 AS cval_lineitem_l_discount_1#8166, cval_lineitem_l_tax#8134 AS cval_lineitem_l_tax_1#8167, cval_lineitem_l_returnflag#8135 AS cval_lineitem_l_returnflag_1#8168, cval_lineitem_l_linestatus#8136 AS cval_lineitem_l_linestatus_1#8169, cval_lineitem_l_commitdate#8137 AS cval_lineitem_l_commitdate_1#8170, cval_lineitem_l_receiptdate#8138 AS cval_lineitem_l_receiptdate_1#8171, cval_lineitem_l_shipinstruct#8139 AS cval_lineitem_l_shipinstruct_1#8172, cval_lineitem_l_shipmode#8140 AS cval_lineitem_l_shipmode_1#8173, cval_lineitem_l_comment#8141 AS cval_lineitem_l_comment_1#8174, cval_lineitem_l_shipdate#8142 AS cval_lineitem_l_shipdate_1#8175, cl_quantity#8143 AS cl_quantity_1#8176, cl_extendedprice#8144 AS cl_extendedprice_1#8177, cl_discount#8145 AS cl_discount_1#8178, ... 9 more fields]
            +- Relation[rid#8122,cpfk_orders_lineitem#8123,cpfk_supplier_lineitem#8124,cfpk_lineitem_supplier#8125,cfpk_lineitem_partsupp#8126,cpfk_part_lineitem#8127,cfpk_lineitem_part#8128,cpfk_partsupp_lineitem#8129,cfpk_lineitem_orders#8130,cval_lineitem_l_quantity#8131,cval_lineitem_l_extendedprice#8132,cval_lineitem_l_discount#8133,cval_lineitem_l_tax#8134,cval_lineitem_l_returnflag#8135,cval_lineitem_l_linestatus#8136,cval_lineitem_l_commitdate#8137,cval_lineitem_l_receiptdate#8138,cval_lineitem_l_shipinstruct#8139,cval_lineitem_l_shipmode#8140,cval_lineitem_l_comment#8141,cval_lineitem_l_shipdate#8142,cl_quantity#8143,cl_extendedprice#8144,cl_discount#8145,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 82873ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/15 14:57:58 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:57:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8333L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 14:57:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:57:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:57:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:57:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:57:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:57:58 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 14:57:58 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 14:57:58 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 14:57:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:57:58 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 14:57:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:57:58 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 14:57:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:57:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:57:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:57:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8333L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#8335 AS rid_0#8352, cval_part_p_name#8336 AS cval_part_p_name_0#8353, cval_part_p_mfgr#8337 AS cval_part_p_mfgr_0#8354, cval_part_p_type#8338 AS cval_part_p_type_0#8355, cval_part_p_size#8339 AS cval_part_p_size_0#8356, cval_part_p_container#8340 AS cval_part_p_container_0#8357, cval_part_p_retailprice#8341 AS cval_part_p_retailprice_0#8358, cval_part_p_comment#8342 AS cval_part_p_comment_0#8359, cval_part_p_brand#8343 AS cval_part_p_brand_0#8360, cp_name#8344 AS cp_name_0#8361, cp_mfgr#8345 AS cp_mfgr_0#8362, cp_type#8346 AS cp_type_0#8363, cp_size#8347 AS cp_size_0#8364, cp_container#8348 AS cp_container_0#8365, cp_retailprice#8349 AS cp_retailprice_0#8366, cp_comment#8350 AS cp_comment_0#8367, cp_brand#8351 AS cp_brand_0#8368]
            :     :     :  :  :  :  +- Relation[rid#8335,cval_part_p_name#8336,cval_part_p_mfgr#8337,cval_part_p_type#8338,cval_part_p_size#8339,cval_part_p_container#8340,cval_part_p_retailprice#8341,cval_part_p_comment#8342,cval_part_p_brand#8343,cp_name#8344,cp_mfgr#8345,cp_type#8346,cp_size#8347,cp_container#8348,cp_retailprice#8349,cp_comment#8350,cp_brand#8351] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#8369 AS rid_0#8386, cval_part_p_name#8370 AS cval_part_p_name_0#8387, cval_part_p_mfgr#8371 AS cval_part_p_mfgr_0#8388, cval_part_p_type#8372 AS cval_part_p_type_0#8389, cval_part_p_size#8373 AS cval_part_p_size_0#8390, cval_part_p_container#8374 AS cval_part_p_container_0#8391, cval_part_p_retailprice#8375 AS cval_part_p_retailprice_0#8392, cval_part_p_comment#8376 AS cval_part_p_comment_0#8393, cval_part_p_brand#8377 AS cval_part_p_brand_0#8394, cp_name#8378 AS cp_name_0#8395, cp_mfgr#8379 AS cp_mfgr_0#8396, cp_type#8380 AS cp_type_0#8397, cp_size#8381 AS cp_size_0#8398, cp_container#8382 AS cp_container_0#8399, cp_retailprice#8383 AS cp_retailprice_0#8400, cp_comment#8384 AS cp_comment_0#8401, cp_brand#8385 AS cp_brand_0#8402]
            :     :     :  :  :        +- Relation[rid#8369,cval_part_p_name#8370,cval_part_p_mfgr#8371,cval_part_p_type#8372,cval_part_p_size#8373,cval_part_p_container#8374,cval_part_p_retailprice#8375,cval_part_p_comment#8376,cval_part_p_brand#8377,cp_name#8378,cp_mfgr#8379,cp_type#8380,cp_size#8381,cp_container#8382,cp_retailprice#8383,cp_comment#8384,cp_brand#8385] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- Project [rid#8503 AS rid_1#8536, cpfk_orders_lineitem#8504 AS cpfk_orders_lineitem_1#8537, cpfk_supplier_lineitem#8505 AS cpfk_supplier_lineitem_1#8538, cfpk_lineitem_supplier#8506 AS cfpk_lineitem_supplier_1#8539, cfpk_lineitem_partsupp#8507 AS cfpk_lineitem_partsupp_1#8540, cpfk_part_lineitem#8508 AS cpfk_part_lineitem_1#8541, cfpk_lineitem_part#8509 AS cfpk_lineitem_part_1#8542, cpfk_partsupp_lineitem#8510 AS cpfk_partsupp_lineitem_1#8543, cfpk_lineitem_orders#8511 AS cfpk_lineitem_orders_1#8544, cval_lineitem_l_quantity#8512 AS cval_lineitem_l_quantity_1#8545, cval_lineitem_l_extendedprice#8513 AS cval_lineitem_l_extendedprice_1#8546, cval_lineitem_l_discount#8514 AS cval_lineitem_l_discount_1#8547, cval_lineitem_l_tax#8515 AS cval_lineitem_l_tax_1#8548, cval_lineitem_l_returnflag#8516 AS cval_lineitem_l_returnflag_1#8549, cval_lineitem_l_linestatus#8517 AS cval_lineitem_l_linestatus_1#8550, cval_lineitem_l_commitdate#8518 AS cval_lineitem_l_commitdate_1#8551, cval_lineitem_l_receiptdate#8519 AS cval_lineitem_l_receiptdate_1#8552, cval_lineitem_l_shipinstruct#8520 AS cval_lineitem_l_shipinstruct_1#8553, cval_lineitem_l_shipmode#8521 AS cval_lineitem_l_shipmode_1#8554, cval_lineitem_l_comment#8522 AS cval_lineitem_l_comment_1#8555, cval_lineitem_l_shipdate#8523 AS cval_lineitem_l_shipdate_1#8556, cl_quantity#8524 AS cl_quantity_1#8557, cl_extendedprice#8525 AS cl_extendedprice_1#8558, cl_discount#8526 AS cl_discount_1#8559, ... 9 more fields]
            :     :     :  :     +- Relation[rid#8503,cpfk_orders_lineitem#8504,cpfk_supplier_lineitem#8505,cfpk_lineitem_supplier#8506,cfpk_lineitem_partsupp#8507,cpfk_part_lineitem#8508,cfpk_lineitem_part#8509,cpfk_partsupp_lineitem#8510,cfpk_lineitem_orders#8511,cval_lineitem_l_quantity#8512,cval_lineitem_l_extendedprice#8513,cval_lineitem_l_discount#8514,cval_lineitem_l_tax#8515,cval_lineitem_l_returnflag#8516,cval_lineitem_l_linestatus#8517,cval_lineitem_l_commitdate#8518,cval_lineitem_l_receiptdate#8519,cval_lineitem_l_shipinstruct#8520,cval_lineitem_l_shipmode#8521,cval_lineitem_l_comment#8522,cval_lineitem_l_shipdate#8523,cl_quantity#8524,cl_extendedprice#8525,cl_discount#8526,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#8403 AS rid_1#8436, cpfk_orders_lineitem#8404 AS cpfk_orders_lineitem_1#8437, cpfk_supplier_lineitem#8405 AS cpfk_supplier_lineitem_1#8438, cfpk_lineitem_supplier#8406 AS cfpk_lineitem_supplier_1#8439, cfpk_lineitem_partsupp#8407 AS cfpk_lineitem_partsupp_1#8440, cpfk_part_lineitem#8408 AS cpfk_part_lineitem_1#8441, cfpk_lineitem_part#8409 AS cfpk_lineitem_part_1#8442, cpfk_partsupp_lineitem#8410 AS cpfk_partsupp_lineitem_1#8443, cfpk_lineitem_orders#8411 AS cfpk_lineitem_orders_1#8444, cval_lineitem_l_quantity#8412 AS cval_lineitem_l_quantity_1#8445, cval_lineitem_l_extendedprice#8413 AS cval_lineitem_l_extendedprice_1#8446, cval_lineitem_l_discount#8414 AS cval_lineitem_l_discount_1#8447, cval_lineitem_l_tax#8415 AS cval_lineitem_l_tax_1#8448, cval_lineitem_l_returnflag#8416 AS cval_lineitem_l_returnflag_1#8449, cval_lineitem_l_linestatus#8417 AS cval_lineitem_l_linestatus_1#8450, cval_lineitem_l_commitdate#8418 AS cval_lineitem_l_commitdate_1#8451, cval_lineitem_l_receiptdate#8419 AS cval_lineitem_l_receiptdate_1#8452, cval_lineitem_l_shipinstruct#8420 AS cval_lineitem_l_shipinstruct_1#8453, cval_lineitem_l_shipmode#8421 AS cval_lineitem_l_shipmode_1#8454, cval_lineitem_l_comment#8422 AS cval_lineitem_l_comment_1#8455, cval_lineitem_l_shipdate#8423 AS cval_lineitem_l_shipdate_1#8456, cl_quantity#8424 AS cl_quantity_1#8457, cl_extendedprice#8425 AS cl_extendedprice_1#8458, cl_discount#8426 AS cl_discount_1#8459, ... 9 more fields]
            :     :     :     +- Relation[rid#8403,cpfk_orders_lineitem#8404,cpfk_supplier_lineitem#8405,cfpk_lineitem_supplier#8406,cfpk_lineitem_partsupp#8407,cpfk_part_lineitem#8408,cfpk_lineitem_part#8409,cpfk_partsupp_lineitem#8410,cfpk_lineitem_orders#8411,cval_lineitem_l_quantity#8412,cval_lineitem_l_extendedprice#8413,cval_lineitem_l_discount#8414,cval_lineitem_l_tax#8415,cval_lineitem_l_returnflag#8416,cval_lineitem_l_linestatus#8417,cval_lineitem_l_commitdate#8418,cval_lineitem_l_receiptdate#8419,cval_lineitem_l_shipinstruct#8420,cval_lineitem_l_shipmode#8421,cval_lineitem_l_comment#8422,cval_lineitem_l_shipdate#8423,cl_quantity#8424,cl_extendedprice#8425,cl_discount#8426,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#8569 AS rid_2#8582, cpfk_nation_supplier#8570 AS cpfk_nation_supplier_2#8583, cfpk_supplier_nation#8571 AS cfpk_supplier_nation_2#8584, cval_supplier_s_name#8572 AS cval_supplier_s_name_2#8585, cval_supplier_s_address#8573 AS cval_supplier_s_address_2#8586, cval_supplier_s_phone#8574 AS cval_supplier_s_phone_2#8587, cval_supplier_s_acctbal#8575 AS cval_supplier_s_acctbal_2#8588, cval_supplier_s_comment#8576 AS cval_supplier_s_comment_2#8589, cs_name#8577 AS cs_name_2#8590, cs_address#8578 AS cs_address_2#8591, cs_phone#8579 AS cs_phone_2#8592, cs_acctbal#8580 AS cs_acctbal_2#8593, cs_comment#8581 AS cs_comment_2#8594]
            :     :        +- Relation[rid#8569,cpfk_nation_supplier#8570,cfpk_supplier_nation#8571,cval_supplier_s_name#8572,cval_supplier_s_address#8573,cval_supplier_s_phone#8574,cval_supplier_s_acctbal#8575,cval_supplier_s_comment#8576,cs_name#8577,cs_address#8578,cs_phone#8579,cs_acctbal#8580,cs_comment#8581] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#8595 AS rid_3#8602, cpfk_region_nation#8596 AS cpfk_region_nation_3#8603, cfpk_nation_region#8597 AS cfpk_nation_region_3#8604, cval_nation_n_name#8598 AS cval_nation_n_name_3#8605, cval_nation_n_comment#8599 AS cval_nation_n_comment_3#8606, cn_name#8600 AS cn_name_3#8607, cn_comment#8601 AS cn_comment_3#8608]
            :        +- Relation[rid#8595,cpfk_region_nation#8596,cfpk_nation_region#8597,cval_nation_n_name#8598,cval_nation_n_comment#8599,cn_name#8600,cn_comment#8601] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#8609 AS rid_4#8614, cval_region_r_name#8610 AS cval_region_r_name_4#8615, cval_region_r_comment#8611 AS cval_region_r_comment_4#8616, cr_name#8612 AS cr_name_4#8617, cr_comment#8613 AS cr_comment_4#8618]
               :  :  :  :  :  :  :  +- Relation[rid#8609,cval_region_r_name#8610,cval_region_r_comment#8611,cr_name#8612,cr_comment#8613] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#8619 AS rid_4#8624, cval_region_r_name#8620 AS cval_region_r_name_4#8625, cval_region_r_comment#8621 AS cval_region_r_comment_4#8626, cr_name#8622 AS cr_name_4#8627, cr_comment#8623 AS cr_comment_4#8628]
               :  :  :  :  :  :        +- Relation[rid#8619,cval_region_r_name#8620,cval_region_r_comment#8621,cr_name#8622,cr_comment#8623] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- Project [rid#8653 AS rid_5#8660, cpfk_region_nation#8654 AS cpfk_region_nation_5#8661, cfpk_nation_region#8655 AS cfpk_nation_region_5#8662, cval_nation_n_name#8656 AS cval_nation_n_name_5#8663, cval_nation_n_comment#8657 AS cval_nation_n_comment_5#8664, cn_name#8658 AS cn_name_5#8665, cn_comment#8659 AS cn_comment_5#8666]
               :  :  :  :  :     +- Relation[rid#8653,cpfk_region_nation#8654,cfpk_nation_region#8655,cval_nation_n_name#8656,cval_nation_n_comment#8657,cn_name#8658,cn_comment#8659] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#8629 AS rid_5#8636, cpfk_region_nation#8630 AS cpfk_region_nation_5#8637, cfpk_nation_region#8631 AS cfpk_nation_region_5#8638, cval_nation_n_name#8632 AS cval_nation_n_name_5#8639, cval_nation_n_comment#8633 AS cval_nation_n_comment_5#8640, cn_name#8634 AS cn_name_5#8641, cn_comment#8635 AS cn_comment_5#8642]
               :  :  :  :     +- Relation[rid#8629,cpfk_region_nation#8630,cfpk_nation_region#8631,cval_nation_n_name#8632,cval_nation_n_comment#8633,cn_name#8634,cn_comment#8635] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#8711 AS rid_6#8726, cpfk_nation_customer#8712 AS cpfk_nation_customer_6#8727, cfpk_customer_nation#8713 AS cfpk_customer_nation_6#8728, cval_customer_c_name#8714 AS cval_customer_c_name_6#8729, cval_customer_c_address#8715 AS cval_customer_c_address_6#8730, cval_customer_c_phone#8716 AS cval_customer_c_phone_6#8731, cval_customer_c_acctbal#8717 AS cval_customer_c_acctbal_6#8732, cval_customer_c_comment#8718 AS cval_customer_c_comment_6#8733, cval_customer_c_mktsegment#8719 AS cval_customer_c_mktsegment_6#8734, cc_name#8720 AS cc_name_6#8735, cc_address#8721 AS cc_address_6#8736, cc_phone#8722 AS cc_phone_6#8737, cc_acctbal#8723 AS cc_acctbal_6#8738, cc_comment#8724 AS cc_comment_6#8739, cc_mktsegment#8725 AS cc_mktsegment_6#8740]
               :  :  :     +- Relation[rid#8711,cpfk_nation_customer#8712,cfpk_customer_nation#8713,cval_customer_c_name#8714,cval_customer_c_address#8715,cval_customer_c_phone#8716,cval_customer_c_acctbal#8717,cval_customer_c_comment#8718,cval_customer_c_mktsegment#8719,cc_name#8720,cc_address#8721,cc_phone#8722,cc_acctbal#8723,cc_comment#8724,cc_mktsegment#8725] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#8667 AS rid_6#8682, cpfk_nation_customer#8668 AS cpfk_nation_customer_6#8683, cfpk_customer_nation#8669 AS cfpk_customer_nation_6#8684, cval_customer_c_name#8670 AS cval_customer_c_name_6#8685, cval_customer_c_address#8671 AS cval_customer_c_address_6#8686, cval_customer_c_phone#8672 AS cval_customer_c_phone_6#8687, cval_customer_c_acctbal#8673 AS cval_customer_c_acctbal_6#8688, cval_customer_c_comment#8674 AS cval_customer_c_comment_6#8689, cval_customer_c_mktsegment#8675 AS cval_customer_c_mktsegment_6#8690, cc_name#8676 AS cc_name_6#8691, cc_address#8677 AS cc_address_6#8692, cc_phone#8678 AS cc_phone_6#8693, cc_acctbal#8679 AS cc_acctbal_6#8694, cc_comment#8680 AS cc_comment_6#8695, cc_mktsegment#8681 AS cc_mktsegment_6#8696]
               :  :     +- Relation[rid#8667,cpfk_nation_customer#8668,cfpk_customer_nation#8669,cval_customer_c_name#8670,cval_customer_c_address#8671,cval_customer_c_phone#8672,cval_customer_c_acctbal#8673,cval_customer_c_comment#8674,cval_customer_c_mktsegment#8675,cc_name#8676,cc_address#8677,cc_phone#8678,cc_acctbal#8679,cc_comment#8680,cc_mktsegment#8681] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#8805 AS rid_7#8822, cpfk_customer_orders#8806 AS cpfk_customer_orders_7#8823, cfpk_orders_customer#8807 AS cfpk_orders_customer_7#8824, cval_orders_o_orderstatus#8808 AS cval_orders_o_orderstatus_7#8825, cval_orders_o_totalprice#8809 AS cval_orders_o_totalprice_7#8826, cval_orders_o_orderpriority#8810 AS cval_orders_o_orderpriority_7#8827, cval_orders_o_clerk#8811 AS cval_orders_o_clerk_7#8828, cval_orders_o_shippriority#8812 AS cval_orders_o_shippriority_7#8829, cval_orders_o_comment#8813 AS cval_orders_o_comment_7#8830, cval_orders_o_orderdate#8814 AS cval_orders_o_orderdate_7#8831, co_orderstatus#8815 AS co_orderstatus_7#8832, co_totalprice#8816 AS co_totalprice_7#8833, co_orderpriority#8817 AS co_orderpriority_7#8834, co_clerk#8818 AS co_clerk_7#8835, co_shippriority#8819 AS co_shippriority_7#8836, co_comment#8820 AS co_comment_7#8837, co_orderdate#8821 AS co_orderdate_7#8838]
               :     +- Relation[rid#8805,cpfk_customer_orders#8806,cfpk_orders_customer#8807,cval_orders_o_orderstatus#8808,cval_orders_o_totalprice#8809,cval_orders_o_orderpriority#8810,cval_orders_o_clerk#8811,cval_orders_o_shippriority#8812,cval_orders_o_comment#8813,cval_orders_o_orderdate#8814,co_orderstatus#8815,co_totalprice#8816,co_orderpriority#8817,co_clerk#8818,co_shippriority#8819,co_comment#8820,co_orderdate#8821] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#8741 AS rid_7#8758, cpfk_customer_orders#8742 AS cpfk_customer_orders_7#8759, cfpk_orders_customer#8743 AS cfpk_orders_customer_7#8760, cval_orders_o_orderstatus#8744 AS cval_orders_o_orderstatus_7#8761, cval_orders_o_totalprice#8745 AS cval_orders_o_totalprice_7#8762, cval_orders_o_orderpriority#8746 AS cval_orders_o_orderpriority_7#8763, cval_orders_o_clerk#8747 AS cval_orders_o_clerk_7#8764, cval_orders_o_shippriority#8748 AS cval_orders_o_shippriority_7#8765, cval_orders_o_comment#8749 AS cval_orders_o_comment_7#8766, cval_orders_o_orderdate#8750 AS cval_orders_o_orderdate_7#8767, co_orderstatus#8751 AS co_orderstatus_7#8768, co_totalprice#8752 AS co_totalprice_7#8769, co_orderpriority#8753 AS co_orderpriority_7#8770, co_clerk#8754 AS co_clerk_7#8771, co_shippriority#8755 AS co_shippriority_7#8772, co_comment#8756 AS co_comment_7#8773, co_orderdate#8757 AS co_orderdate_7#8774]
                  +- Relation[rid#8741,cpfk_customer_orders#8742,cfpk_orders_customer#8743,cval_orders_o_orderstatus#8744,cval_orders_o_totalprice#8745,cval_orders_o_orderpriority#8746,cval_orders_o_clerk#8747,cval_orders_o_shippriority#8748,cval_orders_o_comment#8749,cval_orders_o_orderdate#8750,co_orderstatus#8751,co_totalprice#8752,co_orderpriority#8753,co_clerk#8754,co_shippriority#8755,co_comment#8756,co_orderdate#8757] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 2331ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/15 14:58:00 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:58:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8957L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 14:58:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:58:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:58:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:58:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:58:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:58:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:58:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:58:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8957L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#8959 AS rid_0#8992, cpfk_orders_lineitem#8960 AS cpfk_orders_lineitem_0#8993, cpfk_supplier_lineitem#8961 AS cpfk_supplier_lineitem_0#8994, cfpk_lineitem_supplier#8962 AS cfpk_lineitem_supplier_0#8995, cfpk_lineitem_partsupp#8963 AS cfpk_lineitem_partsupp_0#8996, cpfk_part_lineitem#8964 AS cpfk_part_lineitem_0#8997, cfpk_lineitem_part#8965 AS cfpk_lineitem_part_0#8998, cpfk_partsupp_lineitem#8966 AS cpfk_partsupp_lineitem_0#8999, cfpk_lineitem_orders#8967 AS cfpk_lineitem_orders_0#9000, cval_lineitem_l_quantity#8968 AS cval_lineitem_l_quantity_0#9001, cval_lineitem_l_extendedprice#8969 AS cval_lineitem_l_extendedprice_0#9002, cval_lineitem_l_discount#8970 AS cval_lineitem_l_discount_0#9003, cval_lineitem_l_tax#8971 AS cval_lineitem_l_tax_0#9004, cval_lineitem_l_returnflag#8972 AS cval_lineitem_l_returnflag_0#9005, cval_lineitem_l_linestatus#8973 AS cval_lineitem_l_linestatus_0#9006, cval_lineitem_l_commitdate#8974 AS cval_lineitem_l_commitdate_0#9007, cval_lineitem_l_receiptdate#8975 AS cval_lineitem_l_receiptdate_0#9008, cval_lineitem_l_shipinstruct#8976 AS cval_lineitem_l_shipinstruct_0#9009, cval_lineitem_l_shipmode#8977 AS cval_lineitem_l_shipmode_0#9010, cval_lineitem_l_comment#8978 AS cval_lineitem_l_comment_0#9011, cval_lineitem_l_shipdate#8979 AS cval_lineitem_l_shipdate_0#9012, cl_quantity#8980 AS cl_quantity_0#9013, cl_extendedprice#8981 AS cl_extendedprice_0#9014, cl_discount#8982 AS cl_discount_0#9015, ... 9 more fields]
            :  +- Relation[rid#8959,cpfk_orders_lineitem#8960,cpfk_supplier_lineitem#8961,cfpk_lineitem_supplier#8962,cfpk_lineitem_partsupp#8963,cpfk_part_lineitem#8964,cfpk_lineitem_part#8965,cpfk_partsupp_lineitem#8966,cfpk_lineitem_orders#8967,cval_lineitem_l_quantity#8968,cval_lineitem_l_extendedprice#8969,cval_lineitem_l_discount#8970,cval_lineitem_l_tax#8971,cval_lineitem_l_returnflag#8972,cval_lineitem_l_linestatus#8973,cval_lineitem_l_commitdate#8974,cval_lineitem_l_receiptdate#8975,cval_lineitem_l_shipinstruct#8976,cval_lineitem_l_shipmode#8977,cval_lineitem_l_comment#8978,cval_lineitem_l_shipdate#8979,cl_quantity#8980,cl_extendedprice#8981,cl_discount#8982,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#9025 AS rid_1#9042, cpfk_customer_orders#9026 AS cpfk_customer_orders_1#9043, cfpk_orders_customer#9027 AS cfpk_orders_customer_1#9044, cval_orders_o_orderstatus#9028 AS cval_orders_o_orderstatus_1#9045, cval_orders_o_totalprice#9029 AS cval_orders_o_totalprice_1#9046, cval_orders_o_orderpriority#9030 AS cval_orders_o_orderpriority_1#9047, cval_orders_o_clerk#9031 AS cval_orders_o_clerk_1#9048, cval_orders_o_shippriority#9032 AS cval_orders_o_shippriority_1#9049, cval_orders_o_comment#9033 AS cval_orders_o_comment_1#9050, cval_orders_o_orderdate#9034 AS cval_orders_o_orderdate_1#9051, co_orderstatus#9035 AS co_orderstatus_1#9052, co_totalprice#9036 AS co_totalprice_1#9053, co_orderpriority#9037 AS co_orderpriority_1#9054, co_clerk#9038 AS co_clerk_1#9055, co_shippriority#9039 AS co_shippriority_1#9056, co_comment#9040 AS co_comment_1#9057, co_orderdate#9041 AS co_orderdate_1#9058]
                  :     :  :  :  :  +- Relation[rid#9025,cpfk_customer_orders#9026,cfpk_orders_customer#9027,cval_orders_o_orderstatus#9028,cval_orders_o_totalprice#9029,cval_orders_o_orderpriority#9030,cval_orders_o_clerk#9031,cval_orders_o_shippriority#9032,cval_orders_o_comment#9033,cval_orders_o_orderdate#9034,co_orderstatus#9035,co_totalprice#9036,co_orderpriority#9037,co_clerk#9038,co_shippriority#9039,co_comment#9040,co_orderdate#9041] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#9059 AS rid_1#9076, cpfk_customer_orders#9060 AS cpfk_customer_orders_1#9077, cfpk_orders_customer#9061 AS cfpk_orders_customer_1#9078, cval_orders_o_orderstatus#9062 AS cval_orders_o_orderstatus_1#9079, cval_orders_o_totalprice#9063 AS cval_orders_o_totalprice_1#9080, cval_orders_o_orderpriority#9064 AS cval_orders_o_orderpriority_1#9081, cval_orders_o_clerk#9065 AS cval_orders_o_clerk_1#9082, cval_orders_o_shippriority#9066 AS cval_orders_o_shippriority_1#9083, cval_orders_o_comment#9067 AS cval_orders_o_comment_1#9084, cval_orders_o_orderdate#9068 AS cval_orders_o_orderdate_1#9085, co_orderstatus#9069 AS co_orderstatus_1#9086, co_totalprice#9070 AS co_totalprice_1#9087, co_orderpriority#9071 AS co_orderpriority_1#9088, co_clerk#9072 AS co_clerk_1#9089, co_shippriority#9073 AS co_shippriority_1#9090, co_comment#9074 AS co_comment_1#9091, co_orderdate#9075 AS co_orderdate_1#9092]
                  :     :  :  :        +- Relation[rid#9059,cpfk_customer_orders#9060,cfpk_orders_customer#9061,cval_orders_o_orderstatus#9062,cval_orders_o_totalprice#9063,cval_orders_o_orderpriority#9064,cval_orders_o_clerk#9065,cval_orders_o_shippriority#9066,cval_orders_o_comment#9067,cval_orders_o_orderdate#9068,co_orderstatus#9069,co_totalprice#9070,co_orderpriority#9071,co_clerk#9072,co_shippriority#9073,co_comment#9074,co_orderdate#9075] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- Project [rid#9193 AS rid_2#9226, cpfk_orders_lineitem#9194 AS cpfk_orders_lineitem_2#9227, cpfk_supplier_lineitem#9195 AS cpfk_supplier_lineitem_2#9228, cfpk_lineitem_supplier#9196 AS cfpk_lineitem_supplier_2#9229, cfpk_lineitem_partsupp#9197 AS cfpk_lineitem_partsupp_2#9230, cpfk_part_lineitem#9198 AS cpfk_part_lineitem_2#9231, cfpk_lineitem_part#9199 AS cfpk_lineitem_part_2#9232, cpfk_partsupp_lineitem#9200 AS cpfk_partsupp_lineitem_2#9233, cfpk_lineitem_orders#9201 AS cfpk_lineitem_orders_2#9234, cval_lineitem_l_quantity#9202 AS cval_lineitem_l_quantity_2#9235, cval_lineitem_l_extendedprice#9203 AS cval_lineitem_l_extendedprice_2#9236, cval_lineitem_l_discount#9204 AS cval_lineitem_l_discount_2#9237, cval_lineitem_l_tax#9205 AS cval_lineitem_l_tax_2#9238, cval_lineitem_l_returnflag#9206 AS cval_lineitem_l_returnflag_2#9239, cval_lineitem_l_linestatus#9207 AS cval_lineitem_l_linestatus_2#9240, cval_lineitem_l_commitdate#9208 AS cval_lineitem_l_commitdate_2#9241, cval_lineitem_l_receiptdate#9209 AS cval_lineitem_l_receiptdate_2#9242, cval_lineitem_l_shipinstruct#9210 AS cval_lineitem_l_shipinstruct_2#9243, cval_lineitem_l_shipmode#9211 AS cval_lineitem_l_shipmode_2#9244, cval_lineitem_l_comment#9212 AS cval_lineitem_l_comment_2#9245, cval_lineitem_l_shipdate#9213 AS cval_lineitem_l_shipdate_2#9246, cl_quantity#9214 AS cl_quantity_2#9247, cl_extendedprice#9215 AS cl_extendedprice_2#9248, cl_discount#9216 AS cl_discount_2#9249, ... 9 more fields]
                  :     :  :     +- Relation[rid#9193,cpfk_orders_lineitem#9194,cpfk_supplier_lineitem#9195,cfpk_lineitem_supplier#9196,cfpk_lineitem_partsupp#9197,cpfk_part_lineitem#9198,cfpk_lineitem_part#9199,cpfk_partsupp_lineitem#9200,cfpk_lineitem_orders#9201,cval_lineitem_l_quantity#9202,cval_lineitem_l_extendedprice#9203,cval_lineitem_l_discount#9204,cval_lineitem_l_tax#9205,cval_lineitem_l_returnflag#9206,cval_lineitem_l_linestatus#9207,cval_lineitem_l_commitdate#9208,cval_lineitem_l_receiptdate#9209,cval_lineitem_l_shipinstruct#9210,cval_lineitem_l_shipmode#9211,cval_lineitem_l_comment#9212,cval_lineitem_l_shipdate#9213,cl_quantity#9214,cl_extendedprice#9215,cl_discount#9216,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#9093 AS rid_2#9126, cpfk_orders_lineitem#9094 AS cpfk_orders_lineitem_2#9127, cpfk_supplier_lineitem#9095 AS cpfk_supplier_lineitem_2#9128, cfpk_lineitem_supplier#9096 AS cfpk_lineitem_supplier_2#9129, cfpk_lineitem_partsupp#9097 AS cfpk_lineitem_partsupp_2#9130, cpfk_part_lineitem#9098 AS cpfk_part_lineitem_2#9131, cfpk_lineitem_part#9099 AS cfpk_lineitem_part_2#9132, cpfk_partsupp_lineitem#9100 AS cpfk_partsupp_lineitem_2#9133, cfpk_lineitem_orders#9101 AS cfpk_lineitem_orders_2#9134, cval_lineitem_l_quantity#9102 AS cval_lineitem_l_quantity_2#9135, cval_lineitem_l_extendedprice#9103 AS cval_lineitem_l_extendedprice_2#9136, cval_lineitem_l_discount#9104 AS cval_lineitem_l_discount_2#9137, cval_lineitem_l_tax#9105 AS cval_lineitem_l_tax_2#9138, cval_lineitem_l_returnflag#9106 AS cval_lineitem_l_returnflag_2#9139, cval_lineitem_l_linestatus#9107 AS cval_lineitem_l_linestatus_2#9140, cval_lineitem_l_commitdate#9108 AS cval_lineitem_l_commitdate_2#9141, cval_lineitem_l_receiptdate#9109 AS cval_lineitem_l_receiptdate_2#9142, cval_lineitem_l_shipinstruct#9110 AS cval_lineitem_l_shipinstruct_2#9143, cval_lineitem_l_shipmode#9111 AS cval_lineitem_l_shipmode_2#9144, cval_lineitem_l_comment#9112 AS cval_lineitem_l_comment_2#9145, cval_lineitem_l_shipdate#9113 AS cval_lineitem_l_shipdate_2#9146, cl_quantity#9114 AS cl_quantity_2#9147, cl_extendedprice#9115 AS cl_extendedprice_2#9148, cl_discount#9116 AS cl_discount_2#9149, ... 9 more fields]
                  :     :     +- Relation[rid#9093,cpfk_orders_lineitem#9094,cpfk_supplier_lineitem#9095,cfpk_lineitem_supplier#9096,cfpk_lineitem_partsupp#9097,cpfk_part_lineitem#9098,cfpk_lineitem_part#9099,cpfk_partsupp_lineitem#9100,cfpk_lineitem_orders#9101,cval_lineitem_l_quantity#9102,cval_lineitem_l_extendedprice#9103,cval_lineitem_l_discount#9104,cval_lineitem_l_tax#9105,cval_lineitem_l_returnflag#9106,cval_lineitem_l_linestatus#9107,cval_lineitem_l_commitdate#9108,cval_lineitem_l_receiptdate#9109,cval_lineitem_l_shipinstruct#9110,cval_lineitem_l_shipmode#9111,cval_lineitem_l_comment#9112,cval_lineitem_l_shipdate#9113,cl_quantity#9114,cl_extendedprice#9115,cl_discount#9116,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#9259 AS rid_3#9272, cpfk_nation_supplier#9260 AS cpfk_nation_supplier_3#9273, cfpk_supplier_nation#9261 AS cfpk_supplier_nation_3#9274, cval_supplier_s_name#9262 AS cval_supplier_s_name_3#9275, cval_supplier_s_address#9263 AS cval_supplier_s_address_3#9276, cval_supplier_s_phone#9264 AS cval_supplier_s_phone_3#9277, cval_supplier_s_acctbal#9265 AS cval_supplier_s_acctbal_3#9278, cval_supplier_s_comment#9266 AS cval_supplier_s_comment_3#9279, cs_name#9267 AS cs_name_3#9280, cs_address#9268 AS cs_address_3#9281, cs_phone#9269 AS cs_phone_3#9282, cs_acctbal#9270 AS cs_acctbal_3#9283, cs_comment#9271 AS cs_comment_3#9284]
                  :        +- Relation[rid#9259,cpfk_nation_supplier#9260,cfpk_supplier_nation#9261,cval_supplier_s_name#9262,cval_supplier_s_address#9263,cval_supplier_s_phone#9264,cval_supplier_s_acctbal#9265,cval_supplier_s_comment#9266,cs_name#9267,cs_address#9268,cs_phone#9269,cs_acctbal#9270,cs_comment#9271] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#9285 AS rid_4#9292, cpfk_region_nation#9286 AS cpfk_region_nation_4#9293, cfpk_nation_region#9287 AS cfpk_nation_region_4#9294, cval_nation_n_name#9288 AS cval_nation_n_name_4#9295, cval_nation_n_comment#9289 AS cval_nation_n_comment_4#9296, cn_name#9290 AS cn_name_4#9297, cn_comment#9291 AS cn_comment_4#9298]
                     :  +- Relation[rid#9285,cpfk_region_nation#9286,cfpk_nation_region#9287,cval_nation_n_name#9288,cval_nation_n_comment#9289,cn_name#9290,cn_comment#9291] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#9299 AS rid_4#9306, cpfk_region_nation#9300 AS cpfk_region_nation_4#9307, cfpk_nation_region#9301 AS cfpk_nation_region_4#9308, cval_nation_n_name#9302 AS cval_nation_n_name_4#9309, cval_nation_n_comment#9303 AS cval_nation_n_comment_4#9310, cn_name#9304 AS cn_name_4#9311, cn_comment#9305 AS cn_comment_4#9312]
                           +- Relation[rid#9299,cpfk_region_nation#9300,cfpk_nation_region#9301,cval_nation_n_name#9302,cval_nation_n_comment#9303,cn_name#9304,cn_comment#9305] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=120762
Elapsed time: 92300ms
query=q1, count=6001215, duration=2731
query=q10, count=1478870, duration=67244
query=q11, count=4, duration=984
query=q12, count=857401, duration=24371
query=q13, count=1500000, duration=13950
query=q14, count=6001215, duration=227803
query=q15, count=6001215, duration=82873
query=q16, count=7890, duration=1445
query=q17, count=408, duration=1126
query=q18, count=6001215, duration=124249
query=q19, count=13, duration=64281
query=q2, count=0, duration=5926
query=q20, count=1, duration=704
query=q21a, count=120762, duration=92300
query=q22, count=1500000, duration=15158
query=q3, count=75006, duration=7227
query=q4, count=6001215, duration=56195
query=q5, count=1, duration=19774
query=q6, count=6001215, duration=2611
query=q7, count=0, duration=333
query=q8, count=0, duration=2331
query=q9a, count=6001215, duration=266878
query=q9b, count=6001215, duration=169735
