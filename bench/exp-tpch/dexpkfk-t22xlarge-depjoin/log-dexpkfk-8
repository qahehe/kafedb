20/04/15 16:55:05 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 38271ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Apr 15 16:55:09 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Apr 15 16:55:15 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Apr 15 16:55:16 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Apr 15 16:55:16 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Apr 15 16:55:16 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Apr 15 16:55:34 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Apr 15 16:55:45 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Apr 15 16:55:45 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/15 16:55:47 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:55:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2082L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:55:47 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:55:48 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:55:48 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:55:48 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:55:48 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:55:48 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/15 16:55:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2082L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#2084 AS rid_0#2099, cpfk_nation_customer#2085 AS cpfk_nation_customer_0#2100, cfpk_customer_nation#2086 AS cfpk_customer_nation_0#2101, cval_customer_c_name#2087 AS cval_customer_c_name_0#2102, cval_customer_c_address#2088 AS cval_customer_c_address_0#2103, cval_customer_c_phone#2089 AS cval_customer_c_phone_0#2104, cval_customer_c_acctbal#2090 AS cval_customer_c_acctbal_0#2105, cval_customer_c_comment#2091 AS cval_customer_c_comment_0#2106, cval_customer_c_mktsegment#2092 AS cval_customer_c_mktsegment_0#2107, cc_name#2093 AS cc_name_0#2108, cc_address#2094 AS cc_address_0#2109, cc_phone#2095 AS cc_phone_0#2110, cc_acctbal#2096 AS cc_acctbal_0#2111, cc_comment#2097 AS cc_comment_0#2112, cc_mktsegment#2098 AS cc_mktsegment_0#2113]
         :  :  :  :  :  +- Relation[rid#2084,cpfk_nation_customer#2085,cfpk_customer_nation#2086,cval_customer_c_name#2087,cval_customer_c_address#2088,cval_customer_c_phone#2089,cval_customer_c_acctbal#2090,cval_customer_c_comment#2091,cval_customer_c_mktsegment#2092,cc_name#2093,cc_address#2094,cc_phone#2095,cc_acctbal#2096,cc_comment#2097,cc_mktsegment#2098] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#2114 AS rid_0#2129, cpfk_nation_customer#2115 AS cpfk_nation_customer_0#2130, cfpk_customer_nation#2116 AS cfpk_customer_nation_0#2131, cval_customer_c_name#2117 AS cval_customer_c_name_0#2132, cval_customer_c_address#2118 AS cval_customer_c_address_0#2133, cval_customer_c_phone#2119 AS cval_customer_c_phone_0#2134, cval_customer_c_acctbal#2120 AS cval_customer_c_acctbal_0#2135, cval_customer_c_comment#2121 AS cval_customer_c_comment_0#2136, cval_customer_c_mktsegment#2122 AS cval_customer_c_mktsegment_0#2137, cc_name#2123 AS cc_name_0#2138, cc_address#2124 AS cc_address_0#2139, cc_phone#2125 AS cc_phone_0#2140, cc_acctbal#2126 AS cc_acctbal_0#2141, cc_comment#2127 AS cc_comment_0#2142, cc_mktsegment#2128 AS cc_mktsegment_0#2143]
         :  :  :  :        +- Relation[rid#2114,cpfk_nation_customer#2115,cfpk_customer_nation#2116,cval_customer_c_name#2117,cval_customer_c_address#2118,cval_customer_c_phone#2119,cval_customer_c_acctbal#2120,cval_customer_c_comment#2121,cval_customer_c_mktsegment#2122,cc_name#2123,cc_address#2124,cc_phone#2125,cc_acctbal#2126,cc_comment#2127,cc_mktsegment#2128] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- Project [rid#2208 AS rid_1#2225, cpfk_customer_orders#2209 AS cpfk_customer_orders_1#2226, cfpk_orders_customer#2210 AS cfpk_orders_customer_1#2227, cval_orders_o_orderstatus#2211 AS cval_orders_o_orderstatus_1#2228, cval_orders_o_totalprice#2212 AS cval_orders_o_totalprice_1#2229, cval_orders_o_orderpriority#2213 AS cval_orders_o_orderpriority_1#2230, cval_orders_o_clerk#2214 AS cval_orders_o_clerk_1#2231, cval_orders_o_shippriority#2215 AS cval_orders_o_shippriority_1#2232, cval_orders_o_comment#2216 AS cval_orders_o_comment_1#2233, cval_orders_o_orderdate#2217 AS cval_orders_o_orderdate_1#2234, co_orderstatus#2218 AS co_orderstatus_1#2235, co_totalprice#2219 AS co_totalprice_1#2236, co_orderpriority#2220 AS co_orderpriority_1#2237, co_clerk#2221 AS co_clerk_1#2238, co_shippriority#2222 AS co_shippriority_1#2239, co_comment#2223 AS co_comment_1#2240, co_orderdate#2224 AS co_orderdate_1#2241]
         :  :  :     +- Relation[rid#2208,cpfk_customer_orders#2209,cfpk_orders_customer#2210,cval_orders_o_orderstatus#2211,cval_orders_o_totalprice#2212,cval_orders_o_orderpriority#2213,cval_orders_o_clerk#2214,cval_orders_o_shippriority#2215,cval_orders_o_comment#2216,cval_orders_o_orderdate#2217,co_orderstatus#2218,co_totalprice#2219,co_orderpriority#2220,co_clerk#2221,co_shippriority#2222,co_comment#2223,co_orderdate#2224] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#2144 AS rid_1#2161, cpfk_customer_orders#2145 AS cpfk_customer_orders_1#2162, cfpk_orders_customer#2146 AS cfpk_orders_customer_1#2163, cval_orders_o_orderstatus#2147 AS cval_orders_o_orderstatus_1#2164, cval_orders_o_totalprice#2148 AS cval_orders_o_totalprice_1#2165, cval_orders_o_orderpriority#2149 AS cval_orders_o_orderpriority_1#2166, cval_orders_o_clerk#2150 AS cval_orders_o_clerk_1#2167, cval_orders_o_shippriority#2151 AS cval_orders_o_shippriority_1#2168, cval_orders_o_comment#2152 AS cval_orders_o_comment_1#2169, cval_orders_o_orderdate#2153 AS cval_orders_o_orderdate_1#2170, co_orderstatus#2154 AS co_orderstatus_1#2171, co_totalprice#2155 AS co_totalprice_1#2172, co_orderpriority#2156 AS co_orderpriority_1#2173, co_clerk#2157 AS co_clerk_1#2174, co_shippriority#2158 AS co_shippriority_1#2175, co_comment#2159 AS co_comment_1#2176, co_orderdate#2160 AS co_orderdate_1#2177]
         :  :     +- Relation[rid#2144,cpfk_customer_orders#2145,cfpk_orders_customer#2146,cval_orders_o_orderstatus#2147,cval_orders_o_totalprice#2148,cval_orders_o_orderpriority#2149,cval_orders_o_clerk#2150,cval_orders_o_shippriority#2151,cval_orders_o_comment#2152,cval_orders_o_orderdate#2153,co_orderstatus#2154,co_totalprice#2155,co_orderpriority#2156,co_clerk#2157,co_shippriority#2158,co_comment#2159,co_orderdate#2160] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#2342 AS rid_2#2375, cpfk_orders_lineitem#2343 AS cpfk_orders_lineitem_2#2376, cpfk_supplier_lineitem#2344 AS cpfk_supplier_lineitem_2#2377, cfpk_lineitem_supplier#2345 AS cfpk_lineitem_supplier_2#2378, cfpk_lineitem_partsupp#2346 AS cfpk_lineitem_partsupp_2#2379, cpfk_part_lineitem#2347 AS cpfk_part_lineitem_2#2380, cfpk_lineitem_part#2348 AS cfpk_lineitem_part_2#2381, cpfk_partsupp_lineitem#2349 AS cpfk_partsupp_lineitem_2#2382, cfpk_lineitem_orders#2350 AS cfpk_lineitem_orders_2#2383, cval_lineitem_l_quantity#2351 AS cval_lineitem_l_quantity_2#2384, cval_lineitem_l_extendedprice#2352 AS cval_lineitem_l_extendedprice_2#2385, cval_lineitem_l_discount#2353 AS cval_lineitem_l_discount_2#2386, cval_lineitem_l_tax#2354 AS cval_lineitem_l_tax_2#2387, cval_lineitem_l_returnflag#2355 AS cval_lineitem_l_returnflag_2#2388, cval_lineitem_l_linestatus#2356 AS cval_lineitem_l_linestatus_2#2389, cval_lineitem_l_commitdate#2357 AS cval_lineitem_l_commitdate_2#2390, cval_lineitem_l_receiptdate#2358 AS cval_lineitem_l_receiptdate_2#2391, cval_lineitem_l_shipinstruct#2359 AS cval_lineitem_l_shipinstruct_2#2392, cval_lineitem_l_shipmode#2360 AS cval_lineitem_l_shipmode_2#2393, cval_lineitem_l_comment#2361 AS cval_lineitem_l_comment_2#2394, cval_lineitem_l_shipdate#2362 AS cval_lineitem_l_shipdate_2#2395, cl_quantity#2363 AS cl_quantity_2#2396, cl_extendedprice#2364 AS cl_extendedprice_2#2397, cl_discount#2365 AS cl_discount_2#2398, ... 9 more fields]
         :     +- Relation[rid#2342,cpfk_orders_lineitem#2343,cpfk_supplier_lineitem#2344,cfpk_lineitem_supplier#2345,cfpk_lineitem_partsupp#2346,cpfk_part_lineitem#2347,cfpk_lineitem_part#2348,cpfk_partsupp_lineitem#2349,cfpk_lineitem_orders#2350,cval_lineitem_l_quantity#2351,cval_lineitem_l_extendedprice#2352,cval_lineitem_l_discount#2353,cval_lineitem_l_tax#2354,cval_lineitem_l_returnflag#2355,cval_lineitem_l_linestatus#2356,cval_lineitem_l_commitdate#2357,cval_lineitem_l_receiptdate#2358,cval_lineitem_l_shipinstruct#2359,cval_lineitem_l_shipmode#2360,cval_lineitem_l_comment#2361,cval_lineitem_l_shipdate#2362,cl_quantity#2363,cl_extendedprice#2364,cl_discount#2365,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2242 AS rid_2#2275, cpfk_orders_lineitem#2243 AS cpfk_orders_lineitem_2#2276, cpfk_supplier_lineitem#2244 AS cpfk_supplier_lineitem_2#2277, cfpk_lineitem_supplier#2245 AS cfpk_lineitem_supplier_2#2278, cfpk_lineitem_partsupp#2246 AS cfpk_lineitem_partsupp_2#2279, cpfk_part_lineitem#2247 AS cpfk_part_lineitem_2#2280, cfpk_lineitem_part#2248 AS cfpk_lineitem_part_2#2281, cpfk_partsupp_lineitem#2249 AS cpfk_partsupp_lineitem_2#2282, cfpk_lineitem_orders#2250 AS cfpk_lineitem_orders_2#2283, cval_lineitem_l_quantity#2251 AS cval_lineitem_l_quantity_2#2284, cval_lineitem_l_extendedprice#2252 AS cval_lineitem_l_extendedprice_2#2285, cval_lineitem_l_discount#2253 AS cval_lineitem_l_discount_2#2286, cval_lineitem_l_tax#2254 AS cval_lineitem_l_tax_2#2287, cval_lineitem_l_returnflag#2255 AS cval_lineitem_l_returnflag_2#2288, cval_lineitem_l_linestatus#2256 AS cval_lineitem_l_linestatus_2#2289, cval_lineitem_l_commitdate#2257 AS cval_lineitem_l_commitdate_2#2290, cval_lineitem_l_receiptdate#2258 AS cval_lineitem_l_receiptdate_2#2291, cval_lineitem_l_shipinstruct#2259 AS cval_lineitem_l_shipinstruct_2#2292, cval_lineitem_l_shipmode#2260 AS cval_lineitem_l_shipmode_2#2293, cval_lineitem_l_comment#2261 AS cval_lineitem_l_comment_2#2294, cval_lineitem_l_shipdate#2262 AS cval_lineitem_l_shipdate_2#2295, cl_quantity#2263 AS cl_quantity_2#2296, cl_extendedprice#2264 AS cl_extendedprice_2#2297, cl_discount#2265 AS cl_discount_2#2298, ... 9 more fields]
            +- Relation[rid#2242,cpfk_orders_lineitem#2243,cpfk_supplier_lineitem#2244,cfpk_lineitem_supplier#2245,cfpk_lineitem_partsupp#2246,cpfk_part_lineitem#2247,cfpk_lineitem_part#2248,cpfk_partsupp_lineitem#2249,cfpk_lineitem_orders#2250,cval_lineitem_l_quantity#2251,cval_lineitem_l_extendedprice#2252,cval_lineitem_l_discount#2253,cval_lineitem_l_tax#2254,cval_lineitem_l_returnflag#2255,cval_lineitem_l_linestatus#2256,cval_lineitem_l_commitdate#2257,cval_lineitem_l_receiptdate#2258,cval_lineitem_l_shipinstruct#2259,cval_lineitem_l_shipmode#2260,cval_lineitem_l_comment#2261,cval_lineitem_l_shipdate#2262,cl_quantity#2263,cl_extendedprice#2264,cl_discount#2265,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=75006
Elapsed time: 6744ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/15 16:55:54 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:55:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2477L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:55:54 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:55:54 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:55:54 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:55:54 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:55:54 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:55:54 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:55:54 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:55:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2477L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#2479 AS rid_0#2496, cval_part_p_name#2480 AS cval_part_p_name_0#2497, cval_part_p_mfgr#2481 AS cval_part_p_mfgr_0#2498, cval_part_p_type#2482 AS cval_part_p_type_0#2499, cval_part_p_size#2483 AS cval_part_p_size_0#2500, cval_part_p_container#2484 AS cval_part_p_container_0#2501, cval_part_p_retailprice#2485 AS cval_part_p_retailprice_0#2502, cval_part_p_comment#2486 AS cval_part_p_comment_0#2503, cval_part_p_brand#2487 AS cval_part_p_brand_0#2504, cp_name#2488 AS cp_name_0#2505, cp_mfgr#2489 AS cp_mfgr_0#2506, cp_type#2490 AS cp_type_0#2507, cp_size#2491 AS cp_size_0#2508, cp_container#2492 AS cp_container_0#2509, cp_retailprice#2493 AS cp_retailprice_0#2510, cp_comment#2494 AS cp_comment_0#2511, cp_brand#2495 AS cp_brand_0#2512]
         :  :  :  :  +- Relation[rid#2479,cval_part_p_name#2480,cval_part_p_mfgr#2481,cval_part_p_type#2482,cval_part_p_size#2483,cval_part_p_container#2484,cval_part_p_retailprice#2485,cval_part_p_comment#2486,cval_part_p_brand#2487,cp_name#2488,cp_mfgr#2489,cp_type#2490,cp_size#2491,cp_container#2492,cp_retailprice#2493,cp_comment#2494,cp_brand#2495] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#2513 AS rid_0#2530, cval_part_p_name#2514 AS cval_part_p_name_0#2531, cval_part_p_mfgr#2515 AS cval_part_p_mfgr_0#2532, cval_part_p_type#2516 AS cval_part_p_type_0#2533, cval_part_p_size#2517 AS cval_part_p_size_0#2534, cval_part_p_container#2518 AS cval_part_p_container_0#2535, cval_part_p_retailprice#2519 AS cval_part_p_retailprice_0#2536, cval_part_p_comment#2520 AS cval_part_p_comment_0#2537, cval_part_p_brand#2521 AS cval_part_p_brand_0#2538, cp_name#2522 AS cp_name_0#2539, cp_mfgr#2523 AS cp_mfgr_0#2540, cp_type#2524 AS cp_type_0#2541, cp_size#2525 AS cp_size_0#2542, cp_container#2526 AS cp_container_0#2543, cp_retailprice#2527 AS cp_retailprice_0#2544, cp_comment#2528 AS cp_comment_0#2545, cp_brand#2529 AS cp_brand_0#2546]
         :  :  :        +- Relation[rid#2513,cval_part_p_name#2514,cval_part_p_mfgr#2515,cval_part_p_type#2516,cval_part_p_size#2517,cval_part_p_container#2518,cval_part_p_retailprice#2519,cval_part_p_comment#2520,cval_part_p_brand#2521,cp_name#2522,cp_mfgr#2523,cp_type#2524,cp_size#2525,cp_container#2526,cp_retailprice#2527,cp_comment#2528,cp_brand#2529] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#2547 AS rid_0#2564, cval_part_p_name#2548 AS cval_part_p_name_0#2565, cval_part_p_mfgr#2549 AS cval_part_p_mfgr_0#2566, cval_part_p_type#2550 AS cval_part_p_type_0#2567, cval_part_p_size#2551 AS cval_part_p_size_0#2568, cval_part_p_container#2552 AS cval_part_p_container_0#2569, cval_part_p_retailprice#2553 AS cval_part_p_retailprice_0#2570, cval_part_p_comment#2554 AS cval_part_p_comment_0#2571, cval_part_p_brand#2555 AS cval_part_p_brand_0#2572, cp_name#2556 AS cp_name_0#2573, cp_mfgr#2557 AS cp_mfgr_0#2574, cp_type#2558 AS cp_type_0#2575, cp_size#2559 AS cp_size_0#2576, cp_container#2560 AS cp_container_0#2577, cp_retailprice#2561 AS cp_retailprice_0#2578, cp_comment#2562 AS cp_comment_0#2579, cp_brand#2563 AS cp_brand_0#2580]
         :  :        +- Relation[rid#2547,cval_part_p_name#2548,cval_part_p_mfgr#2549,cval_part_p_type#2550,cval_part_p_size#2551,cval_part_p_container#2552,cval_part_p_retailprice#2553,cval_part_p_comment#2554,cval_part_p_brand#2555,cp_name#2556,cp_mfgr#2557,cp_type#2558,cp_size#2559,cp_container#2560,cp_retailprice#2561,cp_comment#2562,cp_brand#2563] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#2681 AS rid_1#2714, cpfk_orders_lineitem#2682 AS cpfk_orders_lineitem_1#2715, cpfk_supplier_lineitem#2683 AS cpfk_supplier_lineitem_1#2716, cfpk_lineitem_supplier#2684 AS cfpk_lineitem_supplier_1#2717, cfpk_lineitem_partsupp#2685 AS cfpk_lineitem_partsupp_1#2718, cpfk_part_lineitem#2686 AS cpfk_part_lineitem_1#2719, cfpk_lineitem_part#2687 AS cfpk_lineitem_part_1#2720, cpfk_partsupp_lineitem#2688 AS cpfk_partsupp_lineitem_1#2721, cfpk_lineitem_orders#2689 AS cfpk_lineitem_orders_1#2722, cval_lineitem_l_quantity#2690 AS cval_lineitem_l_quantity_1#2723, cval_lineitem_l_extendedprice#2691 AS cval_lineitem_l_extendedprice_1#2724, cval_lineitem_l_discount#2692 AS cval_lineitem_l_discount_1#2725, cval_lineitem_l_tax#2693 AS cval_lineitem_l_tax_1#2726, cval_lineitem_l_returnflag#2694 AS cval_lineitem_l_returnflag_1#2727, cval_lineitem_l_linestatus#2695 AS cval_lineitem_l_linestatus_1#2728, cval_lineitem_l_commitdate#2696 AS cval_lineitem_l_commitdate_1#2729, cval_lineitem_l_receiptdate#2697 AS cval_lineitem_l_receiptdate_1#2730, cval_lineitem_l_shipinstruct#2698 AS cval_lineitem_l_shipinstruct_1#2731, cval_lineitem_l_shipmode#2699 AS cval_lineitem_l_shipmode_1#2732, cval_lineitem_l_comment#2700 AS cval_lineitem_l_comment_1#2733, cval_lineitem_l_shipdate#2701 AS cval_lineitem_l_shipdate_1#2734, cl_quantity#2702 AS cl_quantity_1#2735, cl_extendedprice#2703 AS cl_extendedprice_1#2736, cl_discount#2704 AS cl_discount_1#2737, ... 9 more fields]
         :     +- Relation[rid#2681,cpfk_orders_lineitem#2682,cpfk_supplier_lineitem#2683,cfpk_lineitem_supplier#2684,cfpk_lineitem_partsupp#2685,cpfk_part_lineitem#2686,cfpk_lineitem_part#2687,cpfk_partsupp_lineitem#2688,cfpk_lineitem_orders#2689,cval_lineitem_l_quantity#2690,cval_lineitem_l_extendedprice#2691,cval_lineitem_l_discount#2692,cval_lineitem_l_tax#2693,cval_lineitem_l_returnflag#2694,cval_lineitem_l_linestatus#2695,cval_lineitem_l_commitdate#2696,cval_lineitem_l_receiptdate#2697,cval_lineitem_l_shipinstruct#2698,cval_lineitem_l_shipmode#2699,cval_lineitem_l_comment#2700,cval_lineitem_l_shipdate#2701,cl_quantity#2702,cl_extendedprice#2703,cl_discount#2704,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2581 AS rid_1#2614, cpfk_orders_lineitem#2582 AS cpfk_orders_lineitem_1#2615, cpfk_supplier_lineitem#2583 AS cpfk_supplier_lineitem_1#2616, cfpk_lineitem_supplier#2584 AS cfpk_lineitem_supplier_1#2617, cfpk_lineitem_partsupp#2585 AS cfpk_lineitem_partsupp_1#2618, cpfk_part_lineitem#2586 AS cpfk_part_lineitem_1#2619, cfpk_lineitem_part#2587 AS cfpk_lineitem_part_1#2620, cpfk_partsupp_lineitem#2588 AS cpfk_partsupp_lineitem_1#2621, cfpk_lineitem_orders#2589 AS cfpk_lineitem_orders_1#2622, cval_lineitem_l_quantity#2590 AS cval_lineitem_l_quantity_1#2623, cval_lineitem_l_extendedprice#2591 AS cval_lineitem_l_extendedprice_1#2624, cval_lineitem_l_discount#2592 AS cval_lineitem_l_discount_1#2625, cval_lineitem_l_tax#2593 AS cval_lineitem_l_tax_1#2626, cval_lineitem_l_returnflag#2594 AS cval_lineitem_l_returnflag_1#2627, cval_lineitem_l_linestatus#2595 AS cval_lineitem_l_linestatus_1#2628, cval_lineitem_l_commitdate#2596 AS cval_lineitem_l_commitdate_1#2629, cval_lineitem_l_receiptdate#2597 AS cval_lineitem_l_receiptdate_1#2630, cval_lineitem_l_shipinstruct#2598 AS cval_lineitem_l_shipinstruct_1#2631, cval_lineitem_l_shipmode#2599 AS cval_lineitem_l_shipmode_1#2632, cval_lineitem_l_comment#2600 AS cval_lineitem_l_comment_1#2633, cval_lineitem_l_shipdate#2601 AS cval_lineitem_l_shipdate_1#2634, cl_quantity#2602 AS cl_quantity_1#2635, cl_extendedprice#2603 AS cl_extendedprice_1#2636, cl_discount#2604 AS cl_discount_1#2637, ... 9 more fields]
            +- Relation[rid#2581,cpfk_orders_lineitem#2582,cpfk_supplier_lineitem#2583,cfpk_lineitem_supplier#2584,cfpk_lineitem_partsupp#2585,cpfk_part_lineitem#2586,cfpk_lineitem_part#2587,cpfk_partsupp_lineitem#2588,cfpk_lineitem_orders#2589,cval_lineitem_l_quantity#2590,cval_lineitem_l_extendedprice#2591,cval_lineitem_l_discount#2592,cval_lineitem_l_tax#2593,cval_lineitem_l_returnflag#2594,cval_lineitem_l_linestatus#2595,cval_lineitem_l_commitdate#2596,cval_lineitem_l_receiptdate#2597,cval_lineitem_l_shipinstruct#2598,cval_lineitem_l_shipmode#2599,cval_lineitem_l_comment#2600,cval_lineitem_l_shipdate#2601,cl_quantity#2602,cl_extendedprice#2603,cl_discount#2604,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=408
Elapsed time: 415ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/15 16:55:55 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:55:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2801L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:55:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:55:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2801L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#2803 AS rid_0#2808, cval_region_r_name#2804 AS cval_region_r_name_0#2809, cval_region_r_comment#2805 AS cval_region_r_comment_0#2810, cr_name#2806 AS cr_name_0#2811, cr_comment#2807 AS cr_comment_0#2812]
         :  :  :  :  :  :  :  +- Relation[rid#2803,cval_region_r_name#2804,cval_region_r_comment#2805,cr_name#2806,cr_comment#2807] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#2813 AS rid_0#2818, cval_region_r_name#2814 AS cval_region_r_name_0#2819, cval_region_r_comment#2815 AS cval_region_r_comment_0#2820, cr_name#2816 AS cr_name_0#2821, cr_comment#2817 AS cr_comment_0#2822]
         :  :  :  :  :  :        +- Relation[rid#2813,cval_region_r_name#2814,cval_region_r_comment#2815,cr_name#2816,cr_comment#2817] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- Project [rid#2847 AS rid_1#2854, cpfk_region_nation#2848 AS cpfk_region_nation_1#2855, cfpk_nation_region#2849 AS cfpk_nation_region_1#2856, cval_nation_n_name#2850 AS cval_nation_n_name_1#2857, cval_nation_n_comment#2851 AS cval_nation_n_comment_1#2858, cn_name#2852 AS cn_name_1#2859, cn_comment#2853 AS cn_comment_1#2860]
         :  :  :  :  :     +- Relation[rid#2847,cpfk_region_nation#2848,cfpk_nation_region#2849,cval_nation_n_name#2850,cval_nation_n_comment#2851,cn_name#2852,cn_comment#2853] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#2823 AS rid_1#2830, cpfk_region_nation#2824 AS cpfk_region_nation_1#2831, cfpk_nation_region#2825 AS cfpk_nation_region_1#2832, cval_nation_n_name#2826 AS cval_nation_n_name_1#2833, cval_nation_n_comment#2827 AS cval_nation_n_comment_1#2834, cn_name#2828 AS cn_name_1#2835, cn_comment#2829 AS cn_comment_1#2836]
         :  :  :  :     +- Relation[rid#2823,cpfk_region_nation#2824,cfpk_nation_region#2825,cval_nation_n_name#2826,cval_nation_n_comment#2827,cn_name#2828,cn_comment#2829] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#2901 AS rid_2#2914, cpfk_nation_supplier#2902 AS cpfk_nation_supplier_2#2915, cfpk_supplier_nation#2903 AS cfpk_supplier_nation_2#2916, cval_supplier_s_name#2904 AS cval_supplier_s_name_2#2917, cval_supplier_s_address#2905 AS cval_supplier_s_address_2#2918, cval_supplier_s_phone#2906 AS cval_supplier_s_phone_2#2919, cval_supplier_s_acctbal#2907 AS cval_supplier_s_acctbal_2#2920, cval_supplier_s_comment#2908 AS cval_supplier_s_comment_2#2921, cs_name#2909 AS cs_name_2#2922, cs_address#2910 AS cs_address_2#2923, cs_phone#2911 AS cs_phone_2#2924, cs_acctbal#2912 AS cs_acctbal_2#2925, cs_comment#2913 AS cs_comment_2#2926]
         :  :  :     +- Relation[rid#2901,cpfk_nation_supplier#2902,cfpk_supplier_nation#2903,cval_supplier_s_name#2904,cval_supplier_s_address#2905,cval_supplier_s_phone#2906,cval_supplier_s_acctbal#2907,cval_supplier_s_comment#2908,cs_name#2909,cs_address#2910,cs_phone#2911,cs_acctbal#2912,cs_comment#2913] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#2861 AS rid_2#2874, cpfk_nation_supplier#2862 AS cpfk_nation_supplier_2#2875, cfpk_supplier_nation#2863 AS cfpk_supplier_nation_2#2876, cval_supplier_s_name#2864 AS cval_supplier_s_name_2#2877, cval_supplier_s_address#2865 AS cval_supplier_s_address_2#2878, cval_supplier_s_phone#2866 AS cval_supplier_s_phone_2#2879, cval_supplier_s_acctbal#2867 AS cval_supplier_s_acctbal_2#2880, cval_supplier_s_comment#2868 AS cval_supplier_s_comment_2#2881, cs_name#2869 AS cs_name_2#2882, cs_address#2870 AS cs_address_2#2883, cs_phone#2871 AS cs_phone_2#2884, cs_acctbal#2872 AS cs_acctbal_2#2885, cs_comment#2873 AS cs_comment_2#2886]
         :  :     +- Relation[rid#2861,cpfk_nation_supplier#2862,cfpk_supplier_nation#2863,cval_supplier_s_name#2864,cval_supplier_s_address#2865,cval_supplier_s_phone#2866,cval_supplier_s_acctbal#2867,cval_supplier_s_comment#2868,cs_name#2869,cs_address#2870,cs_phone#2871,cs_acctbal#2872,cs_comment#2873] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#3099 AS rid_4#3110, cpfk_part_partsupp#3100 AS cpfk_part_partsupp_4#3111, cfpk_partsupp_part#3101 AS cfpk_partsupp_part_4#3112, cpfk_supplier_partsupp#3102 AS cpfk_supplier_partsupp_4#3113, cfpk_partsupp_supplier#3103 AS cfpk_partsupp_supplier_4#3114, cval_partsupp_ps_availqty#3104 AS cval_partsupp_ps_availqty_4#3115, cval_partsupp_ps_supplycost#3105 AS cval_partsupp_ps_supplycost_4#3116, cval_partsupp_ps_comment#3106 AS cval_partsupp_ps_comment_4#3117, cps_availqty#3107 AS cps_availqty_4#3118, cps_supplycost#3108 AS cps_supplycost_4#3119, cps_comment#3109 AS cps_comment_4#3120]
         :     +- Relation[rid#3099,cpfk_part_partsupp#3100,cfpk_partsupp_part#3101,cpfk_supplier_partsupp#3102,cfpk_partsupp_supplier#3103,cval_partsupp_ps_availqty#3104,cval_partsupp_ps_supplycost#3105,cval_partsupp_ps_comment#3106,cps_availqty#3107,cps_supplycost#3108,cps_comment#3109] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#2927 AS rid_3#2944, cval_part_p_name#2928 AS cval_part_p_name_3#2945, cval_part_p_mfgr#2929 AS cval_part_p_mfgr_3#2946, cval_part_p_type#2930 AS cval_part_p_type_3#2947, cval_part_p_size#2931 AS cval_part_p_size_3#2948, cval_part_p_container#2932 AS cval_part_p_container_3#2949, cval_part_p_retailprice#2933 AS cval_part_p_retailprice_3#2950, cval_part_p_comment#2934 AS cval_part_p_comment_3#2951, cval_part_p_brand#2935 AS cval_part_p_brand_3#2952, cp_name#2936 AS cp_name_3#2953, cp_mfgr#2937 AS cp_mfgr_3#2954, cp_type#2938 AS cp_type_3#2955, cp_size#2939 AS cp_size_3#2956, cp_container#2940 AS cp_container_3#2957, cp_retailprice#2941 AS cp_retailprice_3#2958, cp_comment#2942 AS cp_comment_3#2959, cp_brand#2943 AS cp_brand_3#2960]
            :  :  :  +- Relation[rid#2927,cval_part_p_name#2928,cval_part_p_mfgr#2929,cval_part_p_type#2930,cval_part_p_size#2931,cval_part_p_container#2932,cval_part_p_retailprice#2933,cval_part_p_comment#2934,cval_part_p_brand#2935,cp_name#2936,cp_mfgr#2937,cp_type#2938,cp_size#2939,cp_container#2940,cp_retailprice#2941,cp_comment#2942,cp_brand#2943] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#2961 AS rid_3#2978, cval_part_p_name#2962 AS cval_part_p_name_3#2979, cval_part_p_mfgr#2963 AS cval_part_p_mfgr_3#2980, cval_part_p_type#2964 AS cval_part_p_type_3#2981, cval_part_p_size#2965 AS cval_part_p_size_3#2982, cval_part_p_container#2966 AS cval_part_p_container_3#2983, cval_part_p_retailprice#2967 AS cval_part_p_retailprice_3#2984, cval_part_p_comment#2968 AS cval_part_p_comment_3#2985, cval_part_p_brand#2969 AS cval_part_p_brand_3#2986, cp_name#2970 AS cp_name_3#2987, cp_mfgr#2971 AS cp_mfgr_3#2988, cp_type#2972 AS cp_type_3#2989, cp_size#2973 AS cp_size_3#2990, cp_container#2974 AS cp_container_3#2991, cp_retailprice#2975 AS cp_retailprice_3#2992, cp_comment#2976 AS cp_comment_3#2993, cp_brand#2977 AS cp_brand_3#2994]
            :  :        +- Relation[rid#2961,cval_part_p_name#2962,cval_part_p_mfgr#2963,cval_part_p_type#2964,cval_part_p_size#2965,cval_part_p_container#2966,cval_part_p_retailprice#2967,cval_part_p_comment#2968,cval_part_p_brand#2969,cp_name#2970,cp_mfgr#2971,cp_type#2972,cp_size#2973,cp_container#2974,cp_retailprice#2975,cp_comment#2976,cp_brand#2977] JDBCRelation(tpart) [numPartitions=1]
            :  +- Project [rid#3051 AS rid_4#3062, cpfk_part_partsupp#3052 AS cpfk_part_partsupp_4#3063, cfpk_partsupp_part#3053 AS cfpk_partsupp_part_4#3064, cpfk_supplier_partsupp#3054 AS cpfk_supplier_partsupp_4#3065, cfpk_partsupp_supplier#3055 AS cfpk_partsupp_supplier_4#3066, cval_partsupp_ps_availqty#3056 AS cval_partsupp_ps_availqty_4#3067, cval_partsupp_ps_supplycost#3057 AS cval_partsupp_ps_supplycost_4#3068, cval_partsupp_ps_comment#3058 AS cval_partsupp_ps_comment_4#3069, cps_availqty#3059 AS cps_availqty_4#3070, cps_supplycost#3060 AS cps_supplycost_4#3071, cps_comment#3061 AS cps_comment_4#3072]
            :     +- Relation[rid#3051,cpfk_part_partsupp#3052,cfpk_partsupp_part#3053,cpfk_supplier_partsupp#3054,cfpk_partsupp_supplier#3055,cval_partsupp_ps_availqty#3056,cval_partsupp_ps_supplycost#3057,cval_partsupp_ps_comment#3058,cps_availqty#3059,cps_supplycost#3060,cps_comment#3061] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#2995 AS rid_4#3006, cpfk_part_partsupp#2996 AS cpfk_part_partsupp_4#3007, cfpk_partsupp_part#2997 AS cfpk_partsupp_part_4#3008, cpfk_supplier_partsupp#2998 AS cpfk_supplier_partsupp_4#3009, cfpk_partsupp_supplier#2999 AS cfpk_partsupp_supplier_4#3010, cval_partsupp_ps_availqty#3000 AS cval_partsupp_ps_availqty_4#3011, cval_partsupp_ps_supplycost#3001 AS cval_partsupp_ps_supplycost_4#3012, cval_partsupp_ps_comment#3002 AS cval_partsupp_ps_comment_4#3013, cps_availqty#3003 AS cps_availqty_4#3014, cps_supplycost#3004 AS cps_supplycost_4#3015, cps_comment#3005 AS cps_comment_4#3016]
               +- Relation[rid#2995,cpfk_part_partsupp#2996,cfpk_partsupp_part#2997,cpfk_supplier_partsupp#2998,cfpk_partsupp_supplier#2999,cval_partsupp_ps_availqty#3000,cval_partsupp_ps_supplycost#3001,cval_partsupp_ps_comment#3002,cps_availqty#3003,cps_supplycost#3004,cps_comment#3005] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 1607ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/15 16:55:56 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:55:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3178L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 16:55:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:55:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:55:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:55:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:55:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:55:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:55:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:55:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3178L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#3180 AS rid_0#3213, cpfk_orders_lineitem#3181 AS cpfk_orders_lineitem_0#3214, cpfk_supplier_lineitem#3182 AS cpfk_supplier_lineitem_0#3215, cfpk_lineitem_supplier#3183 AS cfpk_lineitem_supplier_0#3216, cfpk_lineitem_partsupp#3184 AS cfpk_lineitem_partsupp_0#3217, cpfk_part_lineitem#3185 AS cpfk_part_lineitem_0#3218, cfpk_lineitem_part#3186 AS cfpk_lineitem_part_0#3219, cpfk_partsupp_lineitem#3187 AS cpfk_partsupp_lineitem_0#3220, cfpk_lineitem_orders#3188 AS cfpk_lineitem_orders_0#3221, cval_lineitem_l_quantity#3189 AS cval_lineitem_l_quantity_0#3222, cval_lineitem_l_extendedprice#3190 AS cval_lineitem_l_extendedprice_0#3223, cval_lineitem_l_discount#3191 AS cval_lineitem_l_discount_0#3224, cval_lineitem_l_tax#3192 AS cval_lineitem_l_tax_0#3225, cval_lineitem_l_returnflag#3193 AS cval_lineitem_l_returnflag_0#3226, cval_lineitem_l_linestatus#3194 AS cval_lineitem_l_linestatus_0#3227, cval_lineitem_l_commitdate#3195 AS cval_lineitem_l_commitdate_0#3228, cval_lineitem_l_receiptdate#3196 AS cval_lineitem_l_receiptdate_0#3229, cval_lineitem_l_shipinstruct#3197 AS cval_lineitem_l_shipinstruct_0#3230, cval_lineitem_l_shipmode#3198 AS cval_lineitem_l_shipmode_0#3231, cval_lineitem_l_comment#3199 AS cval_lineitem_l_comment_0#3232, cval_lineitem_l_shipdate#3200 AS cval_lineitem_l_shipdate_0#3233, cl_quantity#3201 AS cl_quantity_0#3234, cl_extendedprice#3202 AS cl_extendedprice_0#3235, cl_discount#3203 AS cl_discount_0#3236, ... 9 more fields]
            :  +- Relation[rid#3180,cpfk_orders_lineitem#3181,cpfk_supplier_lineitem#3182,cfpk_lineitem_supplier#3183,cfpk_lineitem_partsupp#3184,cpfk_part_lineitem#3185,cfpk_lineitem_part#3186,cpfk_partsupp_lineitem#3187,cfpk_lineitem_orders#3188,cval_lineitem_l_quantity#3189,cval_lineitem_l_extendedprice#3190,cval_lineitem_l_discount#3191,cval_lineitem_l_tax#3192,cval_lineitem_l_returnflag#3193,cval_lineitem_l_linestatus#3194,cval_lineitem_l_commitdate#3195,cval_lineitem_l_receiptdate#3196,cval_lineitem_l_shipinstruct#3197,cval_lineitem_l_shipmode#3198,cval_lineitem_l_comment#3199,cval_lineitem_l_shipdate#3200,cl_quantity#3201,cl_extendedprice#3202,cl_discount#3203,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#3246 AS rid_1#3263, cpfk_customer_orders#3247 AS cpfk_customer_orders_1#3264, cfpk_orders_customer#3248 AS cfpk_orders_customer_1#3265, cval_orders_o_orderstatus#3249 AS cval_orders_o_orderstatus_1#3266, cval_orders_o_totalprice#3250 AS cval_orders_o_totalprice_1#3267, cval_orders_o_orderpriority#3251 AS cval_orders_o_orderpriority_1#3268, cval_orders_o_clerk#3252 AS cval_orders_o_clerk_1#3269, cval_orders_o_shippriority#3253 AS cval_orders_o_shippriority_1#3270, cval_orders_o_comment#3254 AS cval_orders_o_comment_1#3271, cval_orders_o_orderdate#3255 AS cval_orders_o_orderdate_1#3272, co_orderstatus#3256 AS co_orderstatus_1#3273, co_totalprice#3257 AS co_totalprice_1#3274, co_orderpriority#3258 AS co_orderpriority_1#3275, co_clerk#3259 AS co_clerk_1#3276, co_shippriority#3260 AS co_shippriority_1#3277, co_comment#3261 AS co_comment_1#3278, co_orderdate#3262 AS co_orderdate_1#3279]
                  :     :  :  :  :  +- Relation[rid#3246,cpfk_customer_orders#3247,cfpk_orders_customer#3248,cval_orders_o_orderstatus#3249,cval_orders_o_totalprice#3250,cval_orders_o_orderpriority#3251,cval_orders_o_clerk#3252,cval_orders_o_shippriority#3253,cval_orders_o_comment#3254,cval_orders_o_orderdate#3255,co_orderstatus#3256,co_totalprice#3257,co_orderpriority#3258,co_clerk#3259,co_shippriority#3260,co_comment#3261,co_orderdate#3262] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#3280 AS rid_1#3297, cpfk_customer_orders#3281 AS cpfk_customer_orders_1#3298, cfpk_orders_customer#3282 AS cfpk_orders_customer_1#3299, cval_orders_o_orderstatus#3283 AS cval_orders_o_orderstatus_1#3300, cval_orders_o_totalprice#3284 AS cval_orders_o_totalprice_1#3301, cval_orders_o_orderpriority#3285 AS cval_orders_o_orderpriority_1#3302, cval_orders_o_clerk#3286 AS cval_orders_o_clerk_1#3303, cval_orders_o_shippriority#3287 AS cval_orders_o_shippriority_1#3304, cval_orders_o_comment#3288 AS cval_orders_o_comment_1#3305, cval_orders_o_orderdate#3289 AS cval_orders_o_orderdate_1#3306, co_orderstatus#3290 AS co_orderstatus_1#3307, co_totalprice#3291 AS co_totalprice_1#3308, co_orderpriority#3292 AS co_orderpriority_1#3309, co_clerk#3293 AS co_clerk_1#3310, co_shippriority#3294 AS co_shippriority_1#3311, co_comment#3295 AS co_comment_1#3312, co_orderdate#3296 AS co_orderdate_1#3313]
                  :     :  :  :        +- Relation[rid#3280,cpfk_customer_orders#3281,cfpk_orders_customer#3282,cval_orders_o_orderstatus#3283,cval_orders_o_totalprice#3284,cval_orders_o_orderpriority#3285,cval_orders_o_clerk#3286,cval_orders_o_shippriority#3287,cval_orders_o_comment#3288,cval_orders_o_orderdate#3289,co_orderstatus#3290,co_totalprice#3291,co_orderpriority#3292,co_clerk#3293,co_shippriority#3294,co_comment#3295,co_orderdate#3296] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- Project [rid#3414 AS rid_2#3447, cpfk_orders_lineitem#3415 AS cpfk_orders_lineitem_2#3448, cpfk_supplier_lineitem#3416 AS cpfk_supplier_lineitem_2#3449, cfpk_lineitem_supplier#3417 AS cfpk_lineitem_supplier_2#3450, cfpk_lineitem_partsupp#3418 AS cfpk_lineitem_partsupp_2#3451, cpfk_part_lineitem#3419 AS cpfk_part_lineitem_2#3452, cfpk_lineitem_part#3420 AS cfpk_lineitem_part_2#3453, cpfk_partsupp_lineitem#3421 AS cpfk_partsupp_lineitem_2#3454, cfpk_lineitem_orders#3422 AS cfpk_lineitem_orders_2#3455, cval_lineitem_l_quantity#3423 AS cval_lineitem_l_quantity_2#3456, cval_lineitem_l_extendedprice#3424 AS cval_lineitem_l_extendedprice_2#3457, cval_lineitem_l_discount#3425 AS cval_lineitem_l_discount_2#3458, cval_lineitem_l_tax#3426 AS cval_lineitem_l_tax_2#3459, cval_lineitem_l_returnflag#3427 AS cval_lineitem_l_returnflag_2#3460, cval_lineitem_l_linestatus#3428 AS cval_lineitem_l_linestatus_2#3461, cval_lineitem_l_commitdate#3429 AS cval_lineitem_l_commitdate_2#3462, cval_lineitem_l_receiptdate#3430 AS cval_lineitem_l_receiptdate_2#3463, cval_lineitem_l_shipinstruct#3431 AS cval_lineitem_l_shipinstruct_2#3464, cval_lineitem_l_shipmode#3432 AS cval_lineitem_l_shipmode_2#3465, cval_lineitem_l_comment#3433 AS cval_lineitem_l_comment_2#3466, cval_lineitem_l_shipdate#3434 AS cval_lineitem_l_shipdate_2#3467, cl_quantity#3435 AS cl_quantity_2#3468, cl_extendedprice#3436 AS cl_extendedprice_2#3469, cl_discount#3437 AS cl_discount_2#3470, ... 9 more fields]
                  :     :  :     +- Relation[rid#3414,cpfk_orders_lineitem#3415,cpfk_supplier_lineitem#3416,cfpk_lineitem_supplier#3417,cfpk_lineitem_partsupp#3418,cpfk_part_lineitem#3419,cfpk_lineitem_part#3420,cpfk_partsupp_lineitem#3421,cfpk_lineitem_orders#3422,cval_lineitem_l_quantity#3423,cval_lineitem_l_extendedprice#3424,cval_lineitem_l_discount#3425,cval_lineitem_l_tax#3426,cval_lineitem_l_returnflag#3427,cval_lineitem_l_linestatus#3428,cval_lineitem_l_commitdate#3429,cval_lineitem_l_receiptdate#3430,cval_lineitem_l_shipinstruct#3431,cval_lineitem_l_shipmode#3432,cval_lineitem_l_comment#3433,cval_lineitem_l_shipdate#3434,cl_quantity#3435,cl_extendedprice#3436,cl_discount#3437,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#3314 AS rid_2#3347, cpfk_orders_lineitem#3315 AS cpfk_orders_lineitem_2#3348, cpfk_supplier_lineitem#3316 AS cpfk_supplier_lineitem_2#3349, cfpk_lineitem_supplier#3317 AS cfpk_lineitem_supplier_2#3350, cfpk_lineitem_partsupp#3318 AS cfpk_lineitem_partsupp_2#3351, cpfk_part_lineitem#3319 AS cpfk_part_lineitem_2#3352, cfpk_lineitem_part#3320 AS cfpk_lineitem_part_2#3353, cpfk_partsupp_lineitem#3321 AS cpfk_partsupp_lineitem_2#3354, cfpk_lineitem_orders#3322 AS cfpk_lineitem_orders_2#3355, cval_lineitem_l_quantity#3323 AS cval_lineitem_l_quantity_2#3356, cval_lineitem_l_extendedprice#3324 AS cval_lineitem_l_extendedprice_2#3357, cval_lineitem_l_discount#3325 AS cval_lineitem_l_discount_2#3358, cval_lineitem_l_tax#3326 AS cval_lineitem_l_tax_2#3359, cval_lineitem_l_returnflag#3327 AS cval_lineitem_l_returnflag_2#3360, cval_lineitem_l_linestatus#3328 AS cval_lineitem_l_linestatus_2#3361, cval_lineitem_l_commitdate#3329 AS cval_lineitem_l_commitdate_2#3362, cval_lineitem_l_receiptdate#3330 AS cval_lineitem_l_receiptdate_2#3363, cval_lineitem_l_shipinstruct#3331 AS cval_lineitem_l_shipinstruct_2#3364, cval_lineitem_l_shipmode#3332 AS cval_lineitem_l_shipmode_2#3365, cval_lineitem_l_comment#3333 AS cval_lineitem_l_comment_2#3366, cval_lineitem_l_shipdate#3334 AS cval_lineitem_l_shipdate_2#3367, cl_quantity#3335 AS cl_quantity_2#3368, cl_extendedprice#3336 AS cl_extendedprice_2#3369, cl_discount#3337 AS cl_discount_2#3370, ... 9 more fields]
                  :     :     +- Relation[rid#3314,cpfk_orders_lineitem#3315,cpfk_supplier_lineitem#3316,cfpk_lineitem_supplier#3317,cfpk_lineitem_partsupp#3318,cpfk_part_lineitem#3319,cfpk_lineitem_part#3320,cpfk_partsupp_lineitem#3321,cfpk_lineitem_orders#3322,cval_lineitem_l_quantity#3323,cval_lineitem_l_extendedprice#3324,cval_lineitem_l_discount#3325,cval_lineitem_l_tax#3326,cval_lineitem_l_returnflag#3327,cval_lineitem_l_linestatus#3328,cval_lineitem_l_commitdate#3329,cval_lineitem_l_receiptdate#3330,cval_lineitem_l_shipinstruct#3331,cval_lineitem_l_shipmode#3332,cval_lineitem_l_comment#3333,cval_lineitem_l_shipdate#3334,cl_quantity#3335,cl_extendedprice#3336,cl_discount#3337,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#3480 AS rid_3#3493, cpfk_nation_supplier#3481 AS cpfk_nation_supplier_3#3494, cfpk_supplier_nation#3482 AS cfpk_supplier_nation_3#3495, cval_supplier_s_name#3483 AS cval_supplier_s_name_3#3496, cval_supplier_s_address#3484 AS cval_supplier_s_address_3#3497, cval_supplier_s_phone#3485 AS cval_supplier_s_phone_3#3498, cval_supplier_s_acctbal#3486 AS cval_supplier_s_acctbal_3#3499, cval_supplier_s_comment#3487 AS cval_supplier_s_comment_3#3500, cs_name#3488 AS cs_name_3#3501, cs_address#3489 AS cs_address_3#3502, cs_phone#3490 AS cs_phone_3#3503, cs_acctbal#3491 AS cs_acctbal_3#3504, cs_comment#3492 AS cs_comment_3#3505]
                  :        +- Relation[rid#3480,cpfk_nation_supplier#3481,cfpk_supplier_nation#3482,cval_supplier_s_name#3483,cval_supplier_s_address#3484,cval_supplier_s_phone#3485,cval_supplier_s_acctbal#3486,cval_supplier_s_comment#3487,cs_name#3488,cs_address#3489,cs_phone#3490,cs_acctbal#3491,cs_comment#3492] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#3506 AS rid_4#3513, cpfk_region_nation#3507 AS cpfk_region_nation_4#3514, cfpk_nation_region#3508 AS cfpk_nation_region_4#3515, cval_nation_n_name#3509 AS cval_nation_n_name_4#3516, cval_nation_n_comment#3510 AS cval_nation_n_comment_4#3517, cn_name#3511 AS cn_name_4#3518, cn_comment#3512 AS cn_comment_4#3519]
                     :  +- Relation[rid#3506,cpfk_region_nation#3507,cfpk_nation_region#3508,cval_nation_n_name#3509,cval_nation_n_comment#3510,cn_name#3511,cn_comment#3512] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#3520 AS rid_4#3527, cpfk_region_nation#3521 AS cpfk_region_nation_4#3528, cfpk_nation_region#3522 AS cfpk_nation_region_4#3529, cval_nation_n_name#3523 AS cval_nation_n_name_4#3530, cval_nation_n_comment#3524 AS cval_nation_n_comment_4#3531, cn_name#3525 AS cn_name_4#3532, cn_comment#3526 AS cn_comment_4#3533]
                           +- Relation[rid#3520,cpfk_region_nation#3521,cfpk_nation_region#3522,cval_nation_n_name#3523,cval_nation_n_comment#3524,cn_name#3525,cn_comment#3526] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=120762
Elapsed time: 90411ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/15 16:57:27 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:57:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3643L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 16:57:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:57:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:57:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:57:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:57:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:57:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:57:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:57:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:57:27 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:57:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:57:27 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:57:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:57:27 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:57:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3643L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#3645 AS rid_0#3652, cpfk_region_nation#3646 AS cpfk_region_nation_0#3653, cfpk_nation_region#3647 AS cfpk_nation_region_0#3654, cval_nation_n_name#3648 AS cval_nation_n_name_0#3655, cval_nation_n_comment#3649 AS cval_nation_n_comment_0#3656, cn_name#3650 AS cn_name_0#3657, cn_comment#3651 AS cn_comment_0#3658]
         :  :  :  :  :  +- Relation[rid#3645,cpfk_region_nation#3646,cfpk_nation_region#3647,cval_nation_n_name#3648,cval_nation_n_comment#3649,cn_name#3650,cn_comment#3651] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#3659 AS rid_0#3666, cpfk_region_nation#3660 AS cpfk_region_nation_0#3667, cfpk_nation_region#3661 AS cfpk_nation_region_0#3668, cval_nation_n_name#3662 AS cval_nation_n_name_0#3669, cval_nation_n_comment#3663 AS cval_nation_n_comment_0#3670, cn_name#3664 AS cn_name_0#3671, cn_comment#3665 AS cn_comment_0#3672]
         :  :  :  :        +- Relation[rid#3659,cpfk_region_nation#3660,cfpk_nation_region#3661,cval_nation_n_name#3662,cval_nation_n_comment#3663,cn_name#3664,cn_comment#3665] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#3713 AS rid_1#3726, cpfk_nation_supplier#3714 AS cpfk_nation_supplier_1#3727, cfpk_supplier_nation#3715 AS cfpk_supplier_nation_1#3728, cval_supplier_s_name#3716 AS cval_supplier_s_name_1#3729, cval_supplier_s_address#3717 AS cval_supplier_s_address_1#3730, cval_supplier_s_phone#3718 AS cval_supplier_s_phone_1#3731, cval_supplier_s_acctbal#3719 AS cval_supplier_s_acctbal_1#3732, cval_supplier_s_comment#3720 AS cval_supplier_s_comment_1#3733, cs_name#3721 AS cs_name_1#3734, cs_address#3722 AS cs_address_1#3735, cs_phone#3723 AS cs_phone_1#3736, cs_acctbal#3724 AS cs_acctbal_1#3737, cs_comment#3725 AS cs_comment_1#3738]
         :  :  :     +- Relation[rid#3713,cpfk_nation_supplier#3714,cfpk_supplier_nation#3715,cval_supplier_s_name#3716,cval_supplier_s_address#3717,cval_supplier_s_phone#3718,cval_supplier_s_acctbal#3719,cval_supplier_s_comment#3720,cs_name#3721,cs_address#3722,cs_phone#3723,cs_acctbal#3724,cs_comment#3725] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#3673 AS rid_1#3686, cpfk_nation_supplier#3674 AS cpfk_nation_supplier_1#3687, cfpk_supplier_nation#3675 AS cfpk_supplier_nation_1#3688, cval_supplier_s_name#3676 AS cval_supplier_s_name_1#3689, cval_supplier_s_address#3677 AS cval_supplier_s_address_1#3690, cval_supplier_s_phone#3678 AS cval_supplier_s_phone_1#3691, cval_supplier_s_acctbal#3679 AS cval_supplier_s_acctbal_1#3692, cval_supplier_s_comment#3680 AS cval_supplier_s_comment_1#3693, cs_name#3681 AS cs_name_1#3694, cs_address#3682 AS cs_address_1#3695, cs_phone#3683 AS cs_phone_1#3696, cs_acctbal#3684 AS cs_acctbal_1#3697, cs_comment#3685 AS cs_comment_1#3698]
         :  :     +- Relation[rid#3673,cpfk_nation_supplier#3674,cfpk_supplier_nation#3675,cval_supplier_s_name#3676,cval_supplier_s_address#3677,cval_supplier_s_phone#3678,cval_supplier_s_acctbal#3679,cval_supplier_s_comment#3680,cs_name#3681,cs_address#3682,cs_phone#3683,cs_acctbal#3684,cs_comment#3685] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#3787 AS rid_2#3798, cpfk_part_partsupp#3788 AS cpfk_part_partsupp_2#3799, cfpk_partsupp_part#3789 AS cfpk_partsupp_part_2#3800, cpfk_supplier_partsupp#3790 AS cpfk_supplier_partsupp_2#3801, cfpk_partsupp_supplier#3791 AS cfpk_partsupp_supplier_2#3802, cval_partsupp_ps_availqty#3792 AS cval_partsupp_ps_availqty_2#3803, cval_partsupp_ps_supplycost#3793 AS cval_partsupp_ps_supplycost_2#3804, cval_partsupp_ps_comment#3794 AS cval_partsupp_ps_comment_2#3805, cps_availqty#3795 AS cps_availqty_2#3806, cps_supplycost#3796 AS cps_supplycost_2#3807, cps_comment#3797 AS cps_comment_2#3808]
         :     +- Relation[rid#3787,cpfk_part_partsupp#3788,cfpk_partsupp_part#3789,cpfk_supplier_partsupp#3790,cfpk_partsupp_supplier#3791,cval_partsupp_ps_availqty#3792,cval_partsupp_ps_supplycost#3793,cval_partsupp_ps_comment#3794,cps_availqty#3795,cps_supplycost#3796,cps_comment#3797] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#3739 AS rid_2#3750, cpfk_part_partsupp#3740 AS cpfk_part_partsupp_2#3751, cfpk_partsupp_part#3741 AS cfpk_partsupp_part_2#3752, cpfk_supplier_partsupp#3742 AS cpfk_supplier_partsupp_2#3753, cfpk_partsupp_supplier#3743 AS cfpk_partsupp_supplier_2#3754, cval_partsupp_ps_availqty#3744 AS cval_partsupp_ps_availqty_2#3755, cval_partsupp_ps_supplycost#3745 AS cval_partsupp_ps_supplycost_2#3756, cval_partsupp_ps_comment#3746 AS cval_partsupp_ps_comment_2#3757, cps_availqty#3747 AS cps_availqty_2#3758, cps_supplycost#3748 AS cps_supplycost_2#3759, cps_comment#3749 AS cps_comment_2#3760]
            +- Relation[rid#3739,cpfk_part_partsupp#3740,cfpk_partsupp_part#3741,cpfk_supplier_partsupp#3742,cfpk_partsupp_supplier#3743,cval_partsupp_ps_availqty#3744,cval_partsupp_ps_supplycost#3745,cval_partsupp_ps_comment#3746,cps_availqty#3747,cps_supplycost#3748,cps_comment#3749] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=4
Elapsed time: 1132ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/15 16:57:28 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:57:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3846L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 16:57:28 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:57:28 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:57:28 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:57:28 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:57:28 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:57:28 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:57:28 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:57:28 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:57:28 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:57:28 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:57:28 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:57:28 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:57:28 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:57:28 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:57:28 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:57:28 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:57:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3846L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#3848 AS rid_0#3853, cval_region_r_name#3849 AS cval_region_r_name_0#3854, cval_region_r_comment#3850 AS cval_region_r_comment_0#3855, cr_name#3851 AS cr_name_0#3856, cr_comment#3852 AS cr_comment_0#3857]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#3848,cval_region_r_name#3849,cval_region_r_comment#3850,cr_name#3851,cr_comment#3852] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#3858 AS rid_0#3863, cval_region_r_name#3859 AS cval_region_r_name_0#3864, cval_region_r_comment#3860 AS cval_region_r_comment_0#3865, cr_name#3861 AS cr_name_0#3866, cr_comment#3862 AS cr_comment_0#3867]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#3858,cval_region_r_name#3859,cval_region_r_comment#3860,cr_name#3861,cr_comment#3862] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- Project [rid#3892 AS rid_1#3899, cpfk_region_nation#3893 AS cpfk_region_nation_1#3900, cfpk_nation_region#3894 AS cfpk_nation_region_1#3901, cval_nation_n_name#3895 AS cval_nation_n_name_1#3902, cval_nation_n_comment#3896 AS cval_nation_n_comment_1#3903, cn_name#3897 AS cn_name_1#3904, cn_comment#3898 AS cn_comment_1#3905]
         :     :  :  :  :  :  :  :  :     +- Relation[rid#3892,cpfk_region_nation#3893,cfpk_nation_region#3894,cval_nation_n_name#3895,cval_nation_n_comment#3896,cn_name#3897,cn_comment#3898] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#3868 AS rid_1#3875, cpfk_region_nation#3869 AS cpfk_region_nation_1#3876, cfpk_nation_region#3870 AS cfpk_nation_region_1#3877, cval_nation_n_name#3871 AS cval_nation_n_name_1#3878, cval_nation_n_comment#3872 AS cval_nation_n_comment_1#3879, cn_name#3873 AS cn_name_1#3880, cn_comment#3874 AS cn_comment_1#3881]
         :     :  :  :  :  :  :  :     +- Relation[rid#3868,cpfk_region_nation#3869,cfpk_nation_region#3870,cval_nation_n_name#3871,cval_nation_n_comment#3872,cn_name#3873,cn_comment#3874] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- Project [rid#3950 AS rid_2#3965, cpfk_nation_customer#3951 AS cpfk_nation_customer_2#3966, cfpk_customer_nation#3952 AS cfpk_customer_nation_2#3967, cval_customer_c_name#3953 AS cval_customer_c_name_2#3968, cval_customer_c_address#3954 AS cval_customer_c_address_2#3969, cval_customer_c_phone#3955 AS cval_customer_c_phone_2#3970, cval_customer_c_acctbal#3956 AS cval_customer_c_acctbal_2#3971, cval_customer_c_comment#3957 AS cval_customer_c_comment_2#3972, cval_customer_c_mktsegment#3958 AS cval_customer_c_mktsegment_2#3973, cc_name#3959 AS cc_name_2#3974, cc_address#3960 AS cc_address_2#3975, cc_phone#3961 AS cc_phone_2#3976, cc_acctbal#3962 AS cc_acctbal_2#3977, cc_comment#3963 AS cc_comment_2#3978, cc_mktsegment#3964 AS cc_mktsegment_2#3979]
         :     :  :  :  :  :  :     +- Relation[rid#3950,cpfk_nation_customer#3951,cfpk_customer_nation#3952,cval_customer_c_name#3953,cval_customer_c_address#3954,cval_customer_c_phone#3955,cval_customer_c_acctbal#3956,cval_customer_c_comment#3957,cval_customer_c_mktsegment#3958,cc_name#3959,cc_address#3960,cc_phone#3961,cc_acctbal#3962,cc_comment#3963,cc_mktsegment#3964] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#3906 AS rid_2#3921, cpfk_nation_customer#3907 AS cpfk_nation_customer_2#3922, cfpk_customer_nation#3908 AS cfpk_customer_nation_2#3923, cval_customer_c_name#3909 AS cval_customer_c_name_2#3924, cval_customer_c_address#3910 AS cval_customer_c_address_2#3925, cval_customer_c_phone#3911 AS cval_customer_c_phone_2#3926, cval_customer_c_acctbal#3912 AS cval_customer_c_acctbal_2#3927, cval_customer_c_comment#3913 AS cval_customer_c_comment_2#3928, cval_customer_c_mktsegment#3914 AS cval_customer_c_mktsegment_2#3929, cc_name#3915 AS cc_name_2#3930, cc_address#3916 AS cc_address_2#3931, cc_phone#3917 AS cc_phone_2#3932, cc_acctbal#3918 AS cc_acctbal_2#3933, cc_comment#3919 AS cc_comment_2#3934, cc_mktsegment#3920 AS cc_mktsegment_2#3935]
         :     :  :  :  :  :     +- Relation[rid#3906,cpfk_nation_customer#3907,cfpk_customer_nation#3908,cval_customer_c_name#3909,cval_customer_c_address#3910,cval_customer_c_phone#3911,cval_customer_c_acctbal#3912,cval_customer_c_comment#3913,cval_customer_c_mktsegment#3914,cc_name#3915,cc_address#3916,cc_phone#3917,cc_acctbal#3918,cc_comment#3919,cc_mktsegment#3920] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- Project [rid#4044 AS rid_3#4061, cpfk_customer_orders#4045 AS cpfk_customer_orders_3#4062, cfpk_orders_customer#4046 AS cfpk_orders_customer_3#4063, cval_orders_o_orderstatus#4047 AS cval_orders_o_orderstatus_3#4064, cval_orders_o_totalprice#4048 AS cval_orders_o_totalprice_3#4065, cval_orders_o_orderpriority#4049 AS cval_orders_o_orderpriority_3#4066, cval_orders_o_clerk#4050 AS cval_orders_o_clerk_3#4067, cval_orders_o_shippriority#4051 AS cval_orders_o_shippriority_3#4068, cval_orders_o_comment#4052 AS cval_orders_o_comment_3#4069, cval_orders_o_orderdate#4053 AS cval_orders_o_orderdate_3#4070, co_orderstatus#4054 AS co_orderstatus_3#4071, co_totalprice#4055 AS co_totalprice_3#4072, co_orderpriority#4056 AS co_orderpriority_3#4073, co_clerk#4057 AS co_clerk_3#4074, co_shippriority#4058 AS co_shippriority_3#4075, co_comment#4059 AS co_comment_3#4076, co_orderdate#4060 AS co_orderdate_3#4077]
         :     :  :  :  :     +- Relation[rid#4044,cpfk_customer_orders#4045,cfpk_orders_customer#4046,cval_orders_o_orderstatus#4047,cval_orders_o_totalprice#4048,cval_orders_o_orderpriority#4049,cval_orders_o_clerk#4050,cval_orders_o_shippriority#4051,cval_orders_o_comment#4052,cval_orders_o_orderdate#4053,co_orderstatus#4054,co_totalprice#4055,co_orderpriority#4056,co_clerk#4057,co_shippriority#4058,co_comment#4059,co_orderdate#4060] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#3980 AS rid_3#3997, cpfk_customer_orders#3981 AS cpfk_customer_orders_3#3998, cfpk_orders_customer#3982 AS cfpk_orders_customer_3#3999, cval_orders_o_orderstatus#3983 AS cval_orders_o_orderstatus_3#4000, cval_orders_o_totalprice#3984 AS cval_orders_o_totalprice_3#4001, cval_orders_o_orderpriority#3985 AS cval_orders_o_orderpriority_3#4002, cval_orders_o_clerk#3986 AS cval_orders_o_clerk_3#4003, cval_orders_o_shippriority#3987 AS cval_orders_o_shippriority_3#4004, cval_orders_o_comment#3988 AS cval_orders_o_comment_3#4005, cval_orders_o_orderdate#3989 AS cval_orders_o_orderdate_3#4006, co_orderstatus#3990 AS co_orderstatus_3#4007, co_totalprice#3991 AS co_totalprice_3#4008, co_orderpriority#3992 AS co_orderpriority_3#4009, co_clerk#3993 AS co_clerk_3#4010, co_shippriority#3994 AS co_shippriority_3#4011, co_comment#3995 AS co_comment_3#4012, co_orderdate#3996 AS co_orderdate_3#4013]
         :     :  :  :     +- Relation[rid#3980,cpfk_customer_orders#3981,cfpk_orders_customer#3982,cval_orders_o_orderstatus#3983,cval_orders_o_totalprice#3984,cval_orders_o_orderpriority#3985,cval_orders_o_clerk#3986,cval_orders_o_shippriority#3987,cval_orders_o_comment#3988,cval_orders_o_orderdate#3989,co_orderstatus#3990,co_totalprice#3991,co_orderpriority#3992,co_clerk#3993,co_shippriority#3994,co_comment#3995,co_orderdate#3996] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- Project [rid#4178 AS rid_4#4211, cpfk_orders_lineitem#4179 AS cpfk_orders_lineitem_4#4212, cpfk_supplier_lineitem#4180 AS cpfk_supplier_lineitem_4#4213, cfpk_lineitem_supplier#4181 AS cfpk_lineitem_supplier_4#4214, cfpk_lineitem_partsupp#4182 AS cfpk_lineitem_partsupp_4#4215, cpfk_part_lineitem#4183 AS cpfk_part_lineitem_4#4216, cfpk_lineitem_part#4184 AS cfpk_lineitem_part_4#4217, cpfk_partsupp_lineitem#4185 AS cpfk_partsupp_lineitem_4#4218, cfpk_lineitem_orders#4186 AS cfpk_lineitem_orders_4#4219, cval_lineitem_l_quantity#4187 AS cval_lineitem_l_quantity_4#4220, cval_lineitem_l_extendedprice#4188 AS cval_lineitem_l_extendedprice_4#4221, cval_lineitem_l_discount#4189 AS cval_lineitem_l_discount_4#4222, cval_lineitem_l_tax#4190 AS cval_lineitem_l_tax_4#4223, cval_lineitem_l_returnflag#4191 AS cval_lineitem_l_returnflag_4#4224, cval_lineitem_l_linestatus#4192 AS cval_lineitem_l_linestatus_4#4225, cval_lineitem_l_commitdate#4193 AS cval_lineitem_l_commitdate_4#4226, cval_lineitem_l_receiptdate#4194 AS cval_lineitem_l_receiptdate_4#4227, cval_lineitem_l_shipinstruct#4195 AS cval_lineitem_l_shipinstruct_4#4228, cval_lineitem_l_shipmode#4196 AS cval_lineitem_l_shipmode_4#4229, cval_lineitem_l_comment#4197 AS cval_lineitem_l_comment_4#4230, cval_lineitem_l_shipdate#4198 AS cval_lineitem_l_shipdate_4#4231, cl_quantity#4199 AS cl_quantity_4#4232, cl_extendedprice#4200 AS cl_extendedprice_4#4233, cl_discount#4201 AS cl_discount_4#4234, ... 9 more fields]
         :     :  :     +- Relation[rid#4178,cpfk_orders_lineitem#4179,cpfk_supplier_lineitem#4180,cfpk_lineitem_supplier#4181,cfpk_lineitem_partsupp#4182,cpfk_part_lineitem#4183,cfpk_lineitem_part#4184,cpfk_partsupp_lineitem#4185,cfpk_lineitem_orders#4186,cval_lineitem_l_quantity#4187,cval_lineitem_l_extendedprice#4188,cval_lineitem_l_discount#4189,cval_lineitem_l_tax#4190,cval_lineitem_l_returnflag#4191,cval_lineitem_l_linestatus#4192,cval_lineitem_l_commitdate#4193,cval_lineitem_l_receiptdate#4194,cval_lineitem_l_shipinstruct#4195,cval_lineitem_l_shipmode#4196,cval_lineitem_l_comment#4197,cval_lineitem_l_shipdate#4198,cl_quantity#4199,cl_extendedprice#4200,cl_discount#4201,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#4078 AS rid_4#4111, cpfk_orders_lineitem#4079 AS cpfk_orders_lineitem_4#4112, cpfk_supplier_lineitem#4080 AS cpfk_supplier_lineitem_4#4113, cfpk_lineitem_supplier#4081 AS cfpk_lineitem_supplier_4#4114, cfpk_lineitem_partsupp#4082 AS cfpk_lineitem_partsupp_4#4115, cpfk_part_lineitem#4083 AS cpfk_part_lineitem_4#4116, cfpk_lineitem_part#4084 AS cfpk_lineitem_part_4#4117, cpfk_partsupp_lineitem#4085 AS cpfk_partsupp_lineitem_4#4118, cfpk_lineitem_orders#4086 AS cfpk_lineitem_orders_4#4119, cval_lineitem_l_quantity#4087 AS cval_lineitem_l_quantity_4#4120, cval_lineitem_l_extendedprice#4088 AS cval_lineitem_l_extendedprice_4#4121, cval_lineitem_l_discount#4089 AS cval_lineitem_l_discount_4#4122, cval_lineitem_l_tax#4090 AS cval_lineitem_l_tax_4#4123, cval_lineitem_l_returnflag#4091 AS cval_lineitem_l_returnflag_4#4124, cval_lineitem_l_linestatus#4092 AS cval_lineitem_l_linestatus_4#4125, cval_lineitem_l_commitdate#4093 AS cval_lineitem_l_commitdate_4#4126, cval_lineitem_l_receiptdate#4094 AS cval_lineitem_l_receiptdate_4#4127, cval_lineitem_l_shipinstruct#4095 AS cval_lineitem_l_shipinstruct_4#4128, cval_lineitem_l_shipmode#4096 AS cval_lineitem_l_shipmode_4#4129, cval_lineitem_l_comment#4097 AS cval_lineitem_l_comment_4#4130, cval_lineitem_l_shipdate#4098 AS cval_lineitem_l_shipdate_4#4131, cl_quantity#4099 AS cl_quantity_4#4132, cl_extendedprice#4100 AS cl_extendedprice_4#4133, cl_discount#4101 AS cl_discount_4#4134, ... 9 more fields]
         :     :     +- Relation[rid#4078,cpfk_orders_lineitem#4079,cpfk_supplier_lineitem#4080,cfpk_lineitem_supplier#4081,cfpk_lineitem_partsupp#4082,cpfk_part_lineitem#4083,cfpk_lineitem_part#4084,cpfk_partsupp_lineitem#4085,cfpk_lineitem_orders#4086,cval_lineitem_l_quantity#4087,cval_lineitem_l_extendedprice#4088,cval_lineitem_l_discount#4089,cval_lineitem_l_tax#4090,cval_lineitem_l_returnflag#4091,cval_lineitem_l_linestatus#4092,cval_lineitem_l_commitdate#4093,cval_lineitem_l_receiptdate#4094,cval_lineitem_l_shipinstruct#4095,cval_lineitem_l_shipmode#4096,cval_lineitem_l_comment#4097,cval_lineitem_l_shipdate#4098,cl_quantity#4099,cl_extendedprice#4100,cl_discount#4101,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#4244 AS rid_5#4257, cpfk_nation_supplier#4245 AS cpfk_nation_supplier_5#4258, cfpk_supplier_nation#4246 AS cfpk_supplier_nation_5#4259, cval_supplier_s_name#4247 AS cval_supplier_s_name_5#4260, cval_supplier_s_address#4248 AS cval_supplier_s_address_5#4261, cval_supplier_s_phone#4249 AS cval_supplier_s_phone_5#4262, cval_supplier_s_acctbal#4250 AS cval_supplier_s_acctbal_5#4263, cval_supplier_s_comment#4251 AS cval_supplier_s_comment_5#4264, cs_name#4252 AS cs_name_5#4265, cs_address#4253 AS cs_address_5#4266, cs_phone#4254 AS cs_phone_5#4267, cs_acctbal#4255 AS cs_acctbal_5#4268, cs_comment#4256 AS cs_comment_5#4269]
         :        +- Relation[rid#4244,cpfk_nation_supplier#4245,cfpk_supplier_nation#4246,cval_supplier_s_name#4247,cval_supplier_s_address#4248,cval_supplier_s_phone#4249,cval_supplier_s_acctbal#4250,cval_supplier_s_comment#4251,cs_name#4252,cs_address#4253,cs_phone#4254,cs_acctbal#4255,cs_comment#4256] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#4270 AS rid_1#4277, cpfk_region_nation#4271 AS cpfk_region_nation_1#4278, cfpk_nation_region#4272 AS cfpk_nation_region_1#4279, cval_nation_n_name#4273 AS cval_nation_n_name_1#4280, cval_nation_n_comment#4274 AS cval_nation_n_comment_1#4281, cn_name#4275 AS cn_name_1#4282, cn_comment#4276 AS cn_comment_1#4283]
            :  +- Relation[rid#4270,cpfk_region_nation#4271,cfpk_nation_region#4272,cval_nation_n_name#4273,cval_nation_n_comment#4274,cn_name#4275,cn_comment#4276] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#4284 AS rid_5#4297, cpfk_nation_supplier#4285 AS cpfk_nation_supplier_5#4298, cfpk_supplier_nation#4286 AS cfpk_supplier_nation_5#4299, cval_supplier_s_name#4287 AS cval_supplier_s_name_5#4300, cval_supplier_s_address#4288 AS cval_supplier_s_address_5#4301, cval_supplier_s_phone#4289 AS cval_supplier_s_phone_5#4302, cval_supplier_s_acctbal#4290 AS cval_supplier_s_acctbal_5#4303, cval_supplier_s_comment#4291 AS cval_supplier_s_comment_5#4304, cs_name#4292 AS cs_name_5#4305, cs_address#4293 AS cs_address_5#4306, cs_phone#4294 AS cs_phone_5#4307, cs_acctbal#4295 AS cs_acctbal_5#4308, cs_comment#4296 AS cs_comment_5#4309]
               +- Relation[rid#4284,cpfk_nation_supplier#4285,cfpk_supplier_nation#4286,cval_supplier_s_name#4287,cval_supplier_s_address#4288,cval_supplier_s_phone#4289,cval_supplier_s_acctbal#4290,cval_supplier_s_comment#4291,cs_name#4292,cs_address#4293,cs_phone#4294,cs_acctbal#4295,cs_comment#4296] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1
Elapsed time: 21013ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/15 16:57:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:57:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4428L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:57:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4428L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#4430 AS rid_0#4463, cpfk_orders_lineitem#4431 AS cpfk_orders_lineitem_0#4464, cpfk_supplier_lineitem#4432 AS cpfk_supplier_lineitem_0#4465, cfpk_lineitem_supplier#4433 AS cfpk_lineitem_supplier_0#4466, cfpk_lineitem_partsupp#4434 AS cfpk_lineitem_partsupp_0#4467, cpfk_part_lineitem#4435 AS cpfk_part_lineitem_0#4468, cfpk_lineitem_part#4436 AS cfpk_lineitem_part_0#4469, cpfk_partsupp_lineitem#4437 AS cpfk_partsupp_lineitem_0#4470, cfpk_lineitem_orders#4438 AS cfpk_lineitem_orders_0#4471, cval_lineitem_l_quantity#4439 AS cval_lineitem_l_quantity_0#4472, cval_lineitem_l_extendedprice#4440 AS cval_lineitem_l_extendedprice_0#4473, cval_lineitem_l_discount#4441 AS cval_lineitem_l_discount_0#4474, cval_lineitem_l_tax#4442 AS cval_lineitem_l_tax_0#4475, cval_lineitem_l_returnflag#4443 AS cval_lineitem_l_returnflag_0#4476, cval_lineitem_l_linestatus#4444 AS cval_lineitem_l_linestatus_0#4477, cval_lineitem_l_commitdate#4445 AS cval_lineitem_l_commitdate_0#4478, cval_lineitem_l_receiptdate#4446 AS cval_lineitem_l_receiptdate_0#4479, cval_lineitem_l_shipinstruct#4447 AS cval_lineitem_l_shipinstruct_0#4480, cval_lineitem_l_shipmode#4448 AS cval_lineitem_l_shipmode_0#4481, cval_lineitem_l_comment#4449 AS cval_lineitem_l_comment_0#4482, cval_lineitem_l_shipdate#4450 AS cval_lineitem_l_shipdate_0#4483, cl_quantity#4451 AS cl_quantity_0#4484, cl_extendedprice#4452 AS cl_extendedprice_0#4485, cl_discount#4453 AS cl_discount_0#4486, ... 9 more fields]
            :  +- Relation[rid#4430,cpfk_orders_lineitem#4431,cpfk_supplier_lineitem#4432,cfpk_lineitem_supplier#4433,cfpk_lineitem_partsupp#4434,cpfk_part_lineitem#4435,cfpk_lineitem_part#4436,cpfk_partsupp_lineitem#4437,cfpk_lineitem_orders#4438,cval_lineitem_l_quantity#4439,cval_lineitem_l_extendedprice#4440,cval_lineitem_l_discount#4441,cval_lineitem_l_tax#4442,cval_lineitem_l_returnflag#4443,cval_lineitem_l_linestatus#4444,cval_lineitem_l_commitdate#4445,cval_lineitem_l_receiptdate#4446,cval_lineitem_l_shipinstruct#4447,cval_lineitem_l_shipmode#4448,cval_lineitem_l_comment#4449,cval_lineitem_l_shipdate#4450,cl_quantity#4451,cl_extendedprice#4452,cl_discount#4453,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#4496 AS rid_1#4513, cpfk_customer_orders#4497 AS cpfk_customer_orders_1#4514, cfpk_orders_customer#4498 AS cfpk_orders_customer_1#4515, cval_orders_o_orderstatus#4499 AS cval_orders_o_orderstatus_1#4516, cval_orders_o_totalprice#4500 AS cval_orders_o_totalprice_1#4517, cval_orders_o_orderpriority#4501 AS cval_orders_o_orderpriority_1#4518, cval_orders_o_clerk#4502 AS cval_orders_o_clerk_1#4519, cval_orders_o_shippriority#4503 AS cval_orders_o_shippriority_1#4520, cval_orders_o_comment#4504 AS cval_orders_o_comment_1#4521, cval_orders_o_orderdate#4505 AS cval_orders_o_orderdate_1#4522, co_orderstatus#4506 AS co_orderstatus_1#4523, co_totalprice#4507 AS co_totalprice_1#4524, co_orderpriority#4508 AS co_orderpriority_1#4525, co_clerk#4509 AS co_clerk_1#4526, co_shippriority#4510 AS co_shippriority_1#4527, co_comment#4511 AS co_comment_1#4528, co_orderdate#4512 AS co_orderdate_1#4529]
               +- Relation[rid#4496,cpfk_customer_orders#4497,cfpk_orders_customer#4498,cval_orders_o_orderstatus#4499,cval_orders_o_totalprice#4500,cval_orders_o_orderpriority#4501,cval_orders_o_clerk#4502,cval_orders_o_shippriority#4503,cval_orders_o_comment#4504,cval_orders_o_orderdate#4505,co_orderstatus#4506,co_totalprice#4507,co_orderpriority#4508,co_clerk#4509,co_shippriority#4510,co_comment#4511,co_orderdate#4512] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 56631ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/15 16:58:45 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:58:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4585L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 16:58:45 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:58:45 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:58:45 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:58:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:58:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:58:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:58:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:58:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:58:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:58:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:58:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:58:45 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:58:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:58:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4585L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#4587 AS rid_0#4604, cval_part_p_name#4588 AS cval_part_p_name_0#4605, cval_part_p_mfgr#4589 AS cval_part_p_mfgr_0#4606, cval_part_p_type#4590 AS cval_part_p_type_0#4607, cval_part_p_size#4591 AS cval_part_p_size_0#4608, cval_part_p_container#4592 AS cval_part_p_container_0#4609, cval_part_p_retailprice#4593 AS cval_part_p_retailprice_0#4610, cval_part_p_comment#4594 AS cval_part_p_comment_0#4611, cval_part_p_brand#4595 AS cval_part_p_brand_0#4612, cp_name#4596 AS cp_name_0#4613, cp_mfgr#4597 AS cp_mfgr_0#4614, cp_type#4598 AS cp_type_0#4615, cp_size#4599 AS cp_size_0#4616, cp_container#4600 AS cp_container_0#4617, cp_retailprice#4601 AS cp_retailprice_0#4618, cp_comment#4602 AS cp_comment_0#4619, cp_brand#4603 AS cp_brand_0#4620]
            :  :  :  :  +- Relation[rid#4587,cval_part_p_name#4588,cval_part_p_mfgr#4589,cval_part_p_type#4590,cval_part_p_size#4591,cval_part_p_container#4592,cval_part_p_retailprice#4593,cval_part_p_comment#4594,cval_part_p_brand#4595,cp_name#4596,cp_mfgr#4597,cp_type#4598,cp_size#4599,cp_container#4600,cp_retailprice#4601,cp_comment#4602,cp_brand#4603] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#4621 AS rid_0#4638, cval_part_p_name#4622 AS cval_part_p_name_0#4639, cval_part_p_mfgr#4623 AS cval_part_p_mfgr_0#4640, cval_part_p_type#4624 AS cval_part_p_type_0#4641, cval_part_p_size#4625 AS cval_part_p_size_0#4642, cval_part_p_container#4626 AS cval_part_p_container_0#4643, cval_part_p_retailprice#4627 AS cval_part_p_retailprice_0#4644, cval_part_p_comment#4628 AS cval_part_p_comment_0#4645, cval_part_p_brand#4629 AS cval_part_p_brand_0#4646, cp_name#4630 AS cp_name_0#4647, cp_mfgr#4631 AS cp_mfgr_0#4648, cp_type#4632 AS cp_type_0#4649, cp_size#4633 AS cp_size_0#4650, cp_container#4634 AS cp_container_0#4651, cp_retailprice#4635 AS cp_retailprice_0#4652, cp_comment#4636 AS cp_comment_0#4653, cp_brand#4637 AS cp_brand_0#4654]
            :  :  :        +- Relation[rid#4621,cval_part_p_name#4622,cval_part_p_mfgr#4623,cval_part_p_type#4624,cval_part_p_size#4625,cval_part_p_container#4626,cval_part_p_retailprice#4627,cval_part_p_comment#4628,cval_part_p_brand#4629,cp_name#4630,cp_mfgr#4631,cp_type#4632,cp_size#4633,cp_container#4634,cp_retailprice#4635,cp_comment#4636,cp_brand#4637] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- Project [rid#4711 AS rid_1#4722, cpfk_part_partsupp#4712 AS cpfk_part_partsupp_1#4723, cfpk_partsupp_part#4713 AS cfpk_partsupp_part_1#4724, cpfk_supplier_partsupp#4714 AS cpfk_supplier_partsupp_1#4725, cfpk_partsupp_supplier#4715 AS cfpk_partsupp_supplier_1#4726, cval_partsupp_ps_availqty#4716 AS cval_partsupp_ps_availqty_1#4727, cval_partsupp_ps_supplycost#4717 AS cval_partsupp_ps_supplycost_1#4728, cval_partsupp_ps_comment#4718 AS cval_partsupp_ps_comment_1#4729, cps_availqty#4719 AS cps_availqty_1#4730, cps_supplycost#4720 AS cps_supplycost_1#4731, cps_comment#4721 AS cps_comment_1#4732]
            :  :     +- Relation[rid#4711,cpfk_part_partsupp#4712,cfpk_partsupp_part#4713,cpfk_supplier_partsupp#4714,cfpk_partsupp_supplier#4715,cval_partsupp_ps_availqty#4716,cval_partsupp_ps_supplycost#4717,cval_partsupp_ps_comment#4718,cps_availqty#4719,cps_supplycost#4720,cps_comment#4721] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#4655 AS rid_1#4666, cpfk_part_partsupp#4656 AS cpfk_part_partsupp_1#4667, cfpk_partsupp_part#4657 AS cfpk_partsupp_part_1#4668, cpfk_supplier_partsupp#4658 AS cpfk_supplier_partsupp_1#4669, cfpk_partsupp_supplier#4659 AS cfpk_partsupp_supplier_1#4670, cval_partsupp_ps_availqty#4660 AS cval_partsupp_ps_availqty_1#4671, cval_partsupp_ps_supplycost#4661 AS cval_partsupp_ps_supplycost_1#4672, cval_partsupp_ps_comment#4662 AS cval_partsupp_ps_comment_1#4673, cps_availqty#4663 AS cps_availqty_1#4674, cps_supplycost#4664 AS cps_supplycost_1#4675, cps_comment#4665 AS cps_comment_1#4676]
            :     +- Relation[rid#4655,cpfk_part_partsupp#4656,cfpk_partsupp_part#4657,cpfk_supplier_partsupp#4658,cfpk_partsupp_supplier#4659,cval_partsupp_ps_availqty#4660,cval_partsupp_ps_supplycost#4661,cval_partsupp_ps_comment#4662,cps_availqty#4663,cps_supplycost#4664,cps_comment#4665] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#4733 AS rid_2#4740, cpfk_region_nation#4734 AS cpfk_region_nation_2#4741, cfpk_nation_region#4735 AS cfpk_nation_region_2#4742, cval_nation_n_name#4736 AS cval_nation_n_name_2#4743, cval_nation_n_comment#4737 AS cval_nation_n_comment_2#4744, cn_name#4738 AS cn_name_2#4745, cn_comment#4739 AS cn_comment_2#4746]
               :  :  :  +- Relation[rid#4733,cpfk_region_nation#4734,cfpk_nation_region#4735,cval_nation_n_name#4736,cval_nation_n_comment#4737,cn_name#4738,cn_comment#4739] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#4747 AS rid_2#4754, cpfk_region_nation#4748 AS cpfk_region_nation_2#4755, cfpk_nation_region#4749 AS cfpk_nation_region_2#4756, cval_nation_n_name#4750 AS cval_nation_n_name_2#4757, cval_nation_n_comment#4751 AS cval_nation_n_comment_2#4758, cn_name#4752 AS cn_name_2#4759, cn_comment#4753 AS cn_comment_2#4760]
               :  :        +- Relation[rid#4747,cpfk_region_nation#4748,cfpk_nation_region#4749,cval_nation_n_name#4750,cval_nation_n_comment#4751,cn_name#4752,cn_comment#4753] JDBCRelation(tnation) [numPartitions=1]
               :  +- Project [rid#4801 AS rid_3#4814, cpfk_nation_supplier#4802 AS cpfk_nation_supplier_3#4815, cfpk_supplier_nation#4803 AS cfpk_supplier_nation_3#4816, cval_supplier_s_name#4804 AS cval_supplier_s_name_3#4817, cval_supplier_s_address#4805 AS cval_supplier_s_address_3#4818, cval_supplier_s_phone#4806 AS cval_supplier_s_phone_3#4819, cval_supplier_s_acctbal#4807 AS cval_supplier_s_acctbal_3#4820, cval_supplier_s_comment#4808 AS cval_supplier_s_comment_3#4821, cs_name#4809 AS cs_name_3#4822, cs_address#4810 AS cs_address_3#4823, cs_phone#4811 AS cs_phone_3#4824, cs_acctbal#4812 AS cs_acctbal_3#4825, cs_comment#4813 AS cs_comment_3#4826]
               :     +- Relation[rid#4801,cpfk_nation_supplier#4802,cfpk_supplier_nation#4803,cval_supplier_s_name#4804,cval_supplier_s_address#4805,cval_supplier_s_phone#4806,cval_supplier_s_acctbal#4807,cval_supplier_s_comment#4808,cs_name#4809,cs_address#4810,cs_phone#4811,cs_acctbal#4812,cs_comment#4813] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#4761 AS rid_3#4774, cpfk_nation_supplier#4762 AS cpfk_nation_supplier_3#4775, cfpk_supplier_nation#4763 AS cfpk_supplier_nation_3#4776, cval_supplier_s_name#4764 AS cval_supplier_s_name_3#4777, cval_supplier_s_address#4765 AS cval_supplier_s_address_3#4778, cval_supplier_s_phone#4766 AS cval_supplier_s_phone_3#4779, cval_supplier_s_acctbal#4767 AS cval_supplier_s_acctbal_3#4780, cval_supplier_s_comment#4768 AS cval_supplier_s_comment_3#4781, cs_name#4769 AS cs_name_3#4782, cs_address#4770 AS cs_address_3#4783, cs_phone#4771 AS cs_phone_3#4784, cs_acctbal#4772 AS cs_acctbal_3#4785, cs_comment#4773 AS cs_comment_3#4786]
                  +- Relation[rid#4761,cpfk_nation_supplier#4762,cfpk_supplier_nation#4763,cval_supplier_s_name#4764,cval_supplier_s_address#4765,cval_supplier_s_phone#4766,cval_supplier_s_acctbal#4767,cval_supplier_s_comment#4768,cs_name#4769,cs_address#4770,cs_phone#4771,cs_acctbal#4772,cs_comment#4773] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=326
Elapsed time: 653ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/15 16:58:46 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:58:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4887L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 16:58:46 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:58:46 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:58:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4887L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#4889 AS rid_0#4922, cpfk_orders_lineitem#4890 AS cpfk_orders_lineitem_0#4923, cpfk_supplier_lineitem#4891 AS cpfk_supplier_lineitem_0#4924, cfpk_lineitem_supplier#4892 AS cfpk_lineitem_supplier_0#4925, cfpk_lineitem_partsupp#4893 AS cfpk_lineitem_partsupp_0#4926, cpfk_part_lineitem#4894 AS cpfk_part_lineitem_0#4927, cfpk_lineitem_part#4895 AS cfpk_lineitem_part_0#4928, cpfk_partsupp_lineitem#4896 AS cpfk_partsupp_lineitem_0#4929, cfpk_lineitem_orders#4897 AS cfpk_lineitem_orders_0#4930, cval_lineitem_l_quantity#4898 AS cval_lineitem_l_quantity_0#4931, cval_lineitem_l_extendedprice#4899 AS cval_lineitem_l_extendedprice_0#4932, cval_lineitem_l_discount#4900 AS cval_lineitem_l_discount_0#4933, cval_lineitem_l_tax#4901 AS cval_lineitem_l_tax_0#4934, cval_lineitem_l_returnflag#4902 AS cval_lineitem_l_returnflag_0#4935, cval_lineitem_l_linestatus#4903 AS cval_lineitem_l_linestatus_0#4936, cval_lineitem_l_commitdate#4904 AS cval_lineitem_l_commitdate_0#4937, cval_lineitem_l_receiptdate#4905 AS cval_lineitem_l_receiptdate_0#4938, cval_lineitem_l_shipinstruct#4906 AS cval_lineitem_l_shipinstruct_0#4939, cval_lineitem_l_shipmode#4907 AS cval_lineitem_l_shipmode_0#4940, cval_lineitem_l_comment#4908 AS cval_lineitem_l_comment_0#4941, cval_lineitem_l_shipdate#4909 AS cval_lineitem_l_shipdate_0#4942, cl_quantity#4910 AS cl_quantity_0#4943, cl_extendedprice#4911 AS cl_extendedprice_0#4944, cl_discount#4912 AS cl_discount_0#4945, ... 9 more fields]
            :     :     :  :  +- Relation[rid#4889,cpfk_orders_lineitem#4890,cpfk_supplier_lineitem#4891,cfpk_lineitem_supplier#4892,cfpk_lineitem_partsupp#4893,cpfk_part_lineitem#4894,cfpk_lineitem_part#4895,cpfk_partsupp_lineitem#4896,cfpk_lineitem_orders#4897,cval_lineitem_l_quantity#4898,cval_lineitem_l_extendedprice#4899,cval_lineitem_l_discount#4900,cval_lineitem_l_tax#4901,cval_lineitem_l_returnflag#4902,cval_lineitem_l_linestatus#4903,cval_lineitem_l_commitdate#4904,cval_lineitem_l_receiptdate#4905,cval_lineitem_l_shipinstruct#4906,cval_lineitem_l_shipmode#4907,cval_lineitem_l_comment#4908,cval_lineitem_l_shipdate#4909,cl_quantity#4910,cl_extendedprice#4911,cl_discount#4912,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#4955 AS rid_0#4988, cpfk_orders_lineitem#4956 AS cpfk_orders_lineitem_0#4989, cpfk_supplier_lineitem#4957 AS cpfk_supplier_lineitem_0#4990, cfpk_lineitem_supplier#4958 AS cfpk_lineitem_supplier_0#4991, cfpk_lineitem_partsupp#4959 AS cfpk_lineitem_partsupp_0#4992, cpfk_part_lineitem#4960 AS cpfk_part_lineitem_0#4993, cfpk_lineitem_part#4961 AS cfpk_lineitem_part_0#4994, cpfk_partsupp_lineitem#4962 AS cpfk_partsupp_lineitem_0#4995, cfpk_lineitem_orders#4963 AS cfpk_lineitem_orders_0#4996, cval_lineitem_l_quantity#4964 AS cval_lineitem_l_quantity_0#4997, cval_lineitem_l_extendedprice#4965 AS cval_lineitem_l_extendedprice_0#4998, cval_lineitem_l_discount#4966 AS cval_lineitem_l_discount_0#4999, cval_lineitem_l_tax#4967 AS cval_lineitem_l_tax_0#5000, cval_lineitem_l_returnflag#4968 AS cval_lineitem_l_returnflag_0#5001, cval_lineitem_l_linestatus#4969 AS cval_lineitem_l_linestatus_0#5002, cval_lineitem_l_commitdate#4970 AS cval_lineitem_l_commitdate_0#5003, cval_lineitem_l_receiptdate#4971 AS cval_lineitem_l_receiptdate_0#5004, cval_lineitem_l_shipinstruct#4972 AS cval_lineitem_l_shipinstruct_0#5005, cval_lineitem_l_shipmode#4973 AS cval_lineitem_l_shipmode_0#5006, cval_lineitem_l_comment#4974 AS cval_lineitem_l_comment_0#5007, cval_lineitem_l_shipdate#4975 AS cval_lineitem_l_shipdate_0#5008, cl_quantity#4976 AS cl_quantity_0#5009, cl_extendedprice#4977 AS cl_extendedprice_0#5010, cl_discount#4978 AS cl_discount_0#5011, ... 9 more fields]
            :     :     :        +- Relation[rid#4955,cpfk_orders_lineitem#4956,cpfk_supplier_lineitem#4957,cfpk_lineitem_supplier#4958,cfpk_lineitem_partsupp#4959,cpfk_part_lineitem#4960,cfpk_lineitem_part#4961,cpfk_partsupp_lineitem#4962,cfpk_lineitem_orders#4963,cval_lineitem_l_quantity#4964,cval_lineitem_l_extendedprice#4965,cval_lineitem_l_discount#4966,cval_lineitem_l_tax#4967,cval_lineitem_l_returnflag#4968,cval_lineitem_l_linestatus#4969,cval_lineitem_l_commitdate#4970,cval_lineitem_l_receiptdate#4971,cval_lineitem_l_shipinstruct#4972,cval_lineitem_l_shipmode#4973,cval_lineitem_l_comment#4974,cval_lineitem_l_shipdate#4975,cl_quantity#4976,cl_extendedprice#4977,cl_discount#4978,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#5021 AS rid_1#5038, cpfk_customer_orders#5022 AS cpfk_customer_orders_1#5039, cfpk_orders_customer#5023 AS cfpk_orders_customer_1#5040, cval_orders_o_orderstatus#5024 AS cval_orders_o_orderstatus_1#5041, cval_orders_o_totalprice#5025 AS cval_orders_o_totalprice_1#5042, cval_orders_o_orderpriority#5026 AS cval_orders_o_orderpriority_1#5043, cval_orders_o_clerk#5027 AS cval_orders_o_clerk_1#5044, cval_orders_o_shippriority#5028 AS cval_orders_o_shippriority_1#5045, cval_orders_o_comment#5029 AS cval_orders_o_comment_1#5046, cval_orders_o_orderdate#5030 AS cval_orders_o_orderdate_1#5047, co_orderstatus#5031 AS co_orderstatus_1#5048, co_totalprice#5032 AS co_totalprice_1#5049, co_orderpriority#5033 AS co_orderpriority_1#5050, co_clerk#5034 AS co_clerk_1#5051, co_shippriority#5035 AS co_shippriority_1#5052, co_comment#5036 AS co_comment_1#5053, co_orderdate#5037 AS co_orderdate_1#5054]
            :     :        +- Relation[rid#5021,cpfk_customer_orders#5022,cfpk_orders_customer#5023,cval_orders_o_orderstatus#5024,cval_orders_o_totalprice#5025,cval_orders_o_orderpriority#5026,cval_orders_o_clerk#5027,cval_orders_o_shippriority#5028,cval_orders_o_comment#5029,cval_orders_o_orderdate#5030,co_orderstatus#5031,co_totalprice#5032,co_orderpriority#5033,co_clerk#5034,co_shippriority#5035,co_comment#5036,co_orderdate#5037] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#5055 AS rid_2#5070, cpfk_nation_customer#5056 AS cpfk_nation_customer_2#5071, cfpk_customer_nation#5057 AS cfpk_customer_nation_2#5072, cval_customer_c_name#5058 AS cval_customer_c_name_2#5073, cval_customer_c_address#5059 AS cval_customer_c_address_2#5074, cval_customer_c_phone#5060 AS cval_customer_c_phone_2#5075, cval_customer_c_acctbal#5061 AS cval_customer_c_acctbal_2#5076, cval_customer_c_comment#5062 AS cval_customer_c_comment_2#5077, cval_customer_c_mktsegment#5063 AS cval_customer_c_mktsegment_2#5078, cc_name#5064 AS cc_name_2#5079, cc_address#5065 AS cc_address_2#5080, cc_phone#5066 AS cc_phone_2#5081, cc_acctbal#5067 AS cc_acctbal_2#5082, cc_comment#5068 AS cc_comment_2#5083, cc_mktsegment#5069 AS cc_mktsegment_2#5084]
            :        +- Relation[rid#5055,cpfk_nation_customer#5056,cfpk_customer_nation#5057,cval_customer_c_name#5058,cval_customer_c_address#5059,cval_customer_c_phone#5060,cval_customer_c_acctbal#5061,cval_customer_c_comment#5062,cval_customer_c_mktsegment#5063,cc_name#5064,cc_address#5065,cc_phone#5066,cc_acctbal#5067,cc_comment#5068,cc_mktsegment#5069] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#5085 AS rid_3#5092, cpfk_region_nation#5086 AS cpfk_region_nation_3#5093, cfpk_nation_region#5087 AS cfpk_nation_region_3#5094, cval_nation_n_name#5088 AS cval_nation_n_name_3#5095, cval_nation_n_comment#5089 AS cval_nation_n_comment_3#5096, cn_name#5090 AS cn_name_3#5097, cn_comment#5091 AS cn_comment_3#5098]
               +- Relation[rid#5085,cpfk_region_nation#5086,cfpk_nation_region#5087,cval_nation_n_name#5088,cval_nation_n_comment#5089,cn_name#5090,cn_comment#5091] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 66095ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/15 16:59:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:59:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5179L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:59:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:59:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:59:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:59:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:59:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:59:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:59:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:59:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:59:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:59:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:59:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:59:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:59:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:59:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:59:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:59:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5179L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#5181 AS rid_0#5188, cpfk_region_nation#5182 AS cpfk_region_nation_0#5189, cfpk_nation_region#5183 AS cfpk_nation_region_0#5190, cval_nation_n_name#5184 AS cval_nation_n_name_0#5191, cval_nation_n_comment#5185 AS cval_nation_n_comment_0#5192, cn_name#5186 AS cn_name_0#5193, cn_comment#5187 AS cn_comment_0#5194]
            :  :  :  :  :  :  +- Relation[rid#5181,cpfk_region_nation#5182,cfpk_nation_region#5183,cval_nation_n_name#5184,cval_nation_n_comment#5185,cn_name#5186,cn_comment#5187] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#5195 AS rid_0#5202, cpfk_region_nation#5196 AS cpfk_region_nation_0#5203, cfpk_nation_region#5197 AS cfpk_nation_region_0#5204, cval_nation_n_name#5198 AS cval_nation_n_name_0#5205, cval_nation_n_comment#5199 AS cval_nation_n_comment_0#5206, cn_name#5200 AS cn_name_0#5207, cn_comment#5201 AS cn_comment_0#5208]
            :  :  :  :  :        +- Relation[rid#5195,cpfk_region_nation#5196,cfpk_nation_region#5197,cval_nation_n_name#5198,cval_nation_n_comment#5199,cn_name#5200,cn_comment#5201] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- Project [rid#5249 AS rid_1#5262, cpfk_nation_supplier#5250 AS cpfk_nation_supplier_1#5263, cfpk_supplier_nation#5251 AS cfpk_supplier_nation_1#5264, cval_supplier_s_name#5252 AS cval_supplier_s_name_1#5265, cval_supplier_s_address#5253 AS cval_supplier_s_address_1#5266, cval_supplier_s_phone#5254 AS cval_supplier_s_phone_1#5267, cval_supplier_s_acctbal#5255 AS cval_supplier_s_acctbal_1#5268, cval_supplier_s_comment#5256 AS cval_supplier_s_comment_1#5269, cs_name#5257 AS cs_name_1#5270, cs_address#5258 AS cs_address_1#5271, cs_phone#5259 AS cs_phone_1#5272, cs_acctbal#5260 AS cs_acctbal_1#5273, cs_comment#5261 AS cs_comment_1#5274]
            :  :  :  :     +- Relation[rid#5249,cpfk_nation_supplier#5250,cfpk_supplier_nation#5251,cval_supplier_s_name#5252,cval_supplier_s_address#5253,cval_supplier_s_phone#5254,cval_supplier_s_acctbal#5255,cval_supplier_s_comment#5256,cs_name#5257,cs_address#5258,cs_phone#5259,cs_acctbal#5260,cs_comment#5261] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#5209 AS rid_1#5222, cpfk_nation_supplier#5210 AS cpfk_nation_supplier_1#5223, cfpk_supplier_nation#5211 AS cfpk_supplier_nation_1#5224, cval_supplier_s_name#5212 AS cval_supplier_s_name_1#5225, cval_supplier_s_address#5213 AS cval_supplier_s_address_1#5226, cval_supplier_s_phone#5214 AS cval_supplier_s_phone_1#5227, cval_supplier_s_acctbal#5215 AS cval_supplier_s_acctbal_1#5228, cval_supplier_s_comment#5216 AS cval_supplier_s_comment_1#5229, cs_name#5217 AS cs_name_1#5230, cs_address#5218 AS cs_address_1#5231, cs_phone#5219 AS cs_phone_1#5232, cs_acctbal#5220 AS cs_acctbal_1#5233, cs_comment#5221 AS cs_comment_1#5234]
            :  :  :     +- Relation[rid#5209,cpfk_nation_supplier#5210,cfpk_supplier_nation#5211,cval_supplier_s_name#5212,cval_supplier_s_address#5213,cval_supplier_s_phone#5214,cval_supplier_s_acctbal#5215,cval_supplier_s_comment#5216,cs_name#5217,cs_address#5218,cs_phone#5219,cs_acctbal#5220,cs_comment#5221] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- Project [rid#5367 AS rid_2#5400, cpfk_orders_lineitem#5368 AS cpfk_orders_lineitem_2#5401, cpfk_supplier_lineitem#5369 AS cpfk_supplier_lineitem_2#5402, cfpk_lineitem_supplier#5370 AS cfpk_lineitem_supplier_2#5403, cfpk_lineitem_partsupp#5371 AS cfpk_lineitem_partsupp_2#5404, cpfk_part_lineitem#5372 AS cpfk_part_lineitem_2#5405, cfpk_lineitem_part#5373 AS cfpk_lineitem_part_2#5406, cpfk_partsupp_lineitem#5374 AS cpfk_partsupp_lineitem_2#5407, cfpk_lineitem_orders#5375 AS cfpk_lineitem_orders_2#5408, cval_lineitem_l_quantity#5376 AS cval_lineitem_l_quantity_2#5409, cval_lineitem_l_extendedprice#5377 AS cval_lineitem_l_extendedprice_2#5410, cval_lineitem_l_discount#5378 AS cval_lineitem_l_discount_2#5411, cval_lineitem_l_tax#5379 AS cval_lineitem_l_tax_2#5412, cval_lineitem_l_returnflag#5380 AS cval_lineitem_l_returnflag_2#5413, cval_lineitem_l_linestatus#5381 AS cval_lineitem_l_linestatus_2#5414, cval_lineitem_l_commitdate#5382 AS cval_lineitem_l_commitdate_2#5415, cval_lineitem_l_receiptdate#5383 AS cval_lineitem_l_receiptdate_2#5416, cval_lineitem_l_shipinstruct#5384 AS cval_lineitem_l_shipinstruct_2#5417, cval_lineitem_l_shipmode#5385 AS cval_lineitem_l_shipmode_2#5418, cval_lineitem_l_comment#5386 AS cval_lineitem_l_comment_2#5419, cval_lineitem_l_shipdate#5387 AS cval_lineitem_l_shipdate_2#5420, cl_quantity#5388 AS cl_quantity_2#5421, cl_extendedprice#5389 AS cl_extendedprice_2#5422, cl_discount#5390 AS cl_discount_2#5423, ... 9 more fields]
            :  :     +- Relation[rid#5367,cpfk_orders_lineitem#5368,cpfk_supplier_lineitem#5369,cfpk_lineitem_supplier#5370,cfpk_lineitem_partsupp#5371,cpfk_part_lineitem#5372,cfpk_lineitem_part#5373,cpfk_partsupp_lineitem#5374,cfpk_lineitem_orders#5375,cval_lineitem_l_quantity#5376,cval_lineitem_l_extendedprice#5377,cval_lineitem_l_discount#5378,cval_lineitem_l_tax#5379,cval_lineitem_l_returnflag#5380,cval_lineitem_l_linestatus#5381,cval_lineitem_l_commitdate#5382,cval_lineitem_l_receiptdate#5383,cval_lineitem_l_shipinstruct#5384,cval_lineitem_l_shipmode#5385,cval_lineitem_l_comment#5386,cval_lineitem_l_shipdate#5387,cl_quantity#5388,cl_extendedprice#5389,cl_discount#5390,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#5275 AS rid_2#5308, cpfk_orders_lineitem#5276 AS cpfk_orders_lineitem_2#5309, cpfk_supplier_lineitem#5277 AS cpfk_supplier_lineitem_2#5310, cfpk_lineitem_supplier#5278 AS cfpk_lineitem_supplier_2#5311, cfpk_lineitem_partsupp#5279 AS cfpk_lineitem_partsupp_2#5312, cpfk_part_lineitem#5280 AS cpfk_part_lineitem_2#5313, cfpk_lineitem_part#5281 AS cfpk_lineitem_part_2#5314, cpfk_partsupp_lineitem#5282 AS cpfk_partsupp_lineitem_2#5315, cfpk_lineitem_orders#5283 AS cfpk_lineitem_orders_2#5316, cval_lineitem_l_quantity#5284 AS cval_lineitem_l_quantity_2#5317, cval_lineitem_l_extendedprice#5285 AS cval_lineitem_l_extendedprice_2#5318, cval_lineitem_l_discount#5286 AS cval_lineitem_l_discount_2#5319, cval_lineitem_l_tax#5287 AS cval_lineitem_l_tax_2#5320, cval_lineitem_l_returnflag#5288 AS cval_lineitem_l_returnflag_2#5321, cval_lineitem_l_linestatus#5289 AS cval_lineitem_l_linestatus_2#5322, cval_lineitem_l_commitdate#5290 AS cval_lineitem_l_commitdate_2#5323, cval_lineitem_l_receiptdate#5291 AS cval_lineitem_l_receiptdate_2#5324, cval_lineitem_l_shipinstruct#5292 AS cval_lineitem_l_shipinstruct_2#5325, cval_lineitem_l_shipmode#5293 AS cval_lineitem_l_shipmode_2#5326, cval_lineitem_l_comment#5294 AS cval_lineitem_l_comment_2#5327, cval_lineitem_l_shipdate#5295 AS cval_lineitem_l_shipdate_2#5328, cl_quantity#5296 AS cl_quantity_2#5329, cl_extendedprice#5297 AS cl_extendedprice_2#5330, cl_discount#5298 AS cl_discount_2#5331, ... 9 more fields]
            :     +- Relation[rid#5275,cpfk_orders_lineitem#5276,cpfk_supplier_lineitem#5277,cfpk_lineitem_supplier#5278,cfpk_lineitem_partsupp#5279,cpfk_part_lineitem#5280,cfpk_lineitem_part#5281,cpfk_partsupp_lineitem#5282,cfpk_lineitem_orders#5283,cval_lineitem_l_quantity#5284,cval_lineitem_l_extendedprice#5285,cval_lineitem_l_discount#5286,cval_lineitem_l_tax#5287,cval_lineitem_l_returnflag#5288,cval_lineitem_l_linestatus#5289,cval_lineitem_l_commitdate#5290,cval_lineitem_l_receiptdate#5291,cval_lineitem_l_shipinstruct#5292,cval_lineitem_l_shipmode#5293,cval_lineitem_l_comment#5294,cval_lineitem_l_shipdate#5295,cl_quantity#5296,cl_extendedprice#5297,cl_discount#5298,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#5433 AS rid_3#5440, cpfk_region_nation#5434 AS cpfk_region_nation_3#5441, cfpk_nation_region#5435 AS cfpk_nation_region_3#5442, cval_nation_n_name#5436 AS cval_nation_n_name_3#5443, cval_nation_n_comment#5437 AS cval_nation_n_comment_3#5444, cn_name#5438 AS cn_name_3#5445, cn_comment#5439 AS cn_comment_3#5446]
               :  :  :  :  :  +- Relation[rid#5433,cpfk_region_nation#5434,cfpk_nation_region#5435,cval_nation_n_name#5436,cval_nation_n_comment#5437,cn_name#5438,cn_comment#5439] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#5447 AS rid_3#5454, cpfk_region_nation#5448 AS cpfk_region_nation_3#5455, cfpk_nation_region#5449 AS cfpk_nation_region_3#5456, cval_nation_n_name#5450 AS cval_nation_n_name_3#5457, cval_nation_n_comment#5451 AS cval_nation_n_comment_3#5458, cn_name#5452 AS cn_name_3#5459, cn_comment#5453 AS cn_comment_3#5460]
               :  :  :  :        +- Relation[rid#5447,cpfk_region_nation#5448,cfpk_nation_region#5449,cval_nation_n_name#5450,cval_nation_n_comment#5451,cn_name#5452,cn_comment#5453] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#5505 AS rid_4#5520, cpfk_nation_customer#5506 AS cpfk_nation_customer_4#5521, cfpk_customer_nation#5507 AS cfpk_customer_nation_4#5522, cval_customer_c_name#5508 AS cval_customer_c_name_4#5523, cval_customer_c_address#5509 AS cval_customer_c_address_4#5524, cval_customer_c_phone#5510 AS cval_customer_c_phone_4#5525, cval_customer_c_acctbal#5511 AS cval_customer_c_acctbal_4#5526, cval_customer_c_comment#5512 AS cval_customer_c_comment_4#5527, cval_customer_c_mktsegment#5513 AS cval_customer_c_mktsegment_4#5528, cc_name#5514 AS cc_name_4#5529, cc_address#5515 AS cc_address_4#5530, cc_phone#5516 AS cc_phone_4#5531, cc_acctbal#5517 AS cc_acctbal_4#5532, cc_comment#5518 AS cc_comment_4#5533, cc_mktsegment#5519 AS cc_mktsegment_4#5534]
               :  :  :     +- Relation[rid#5505,cpfk_nation_customer#5506,cfpk_customer_nation#5507,cval_customer_c_name#5508,cval_customer_c_address#5509,cval_customer_c_phone#5510,cval_customer_c_acctbal#5511,cval_customer_c_comment#5512,cval_customer_c_mktsegment#5513,cc_name#5514,cc_address#5515,cc_phone#5516,cc_acctbal#5517,cc_comment#5518,cc_mktsegment#5519] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#5461 AS rid_4#5476, cpfk_nation_customer#5462 AS cpfk_nation_customer_4#5477, cfpk_customer_nation#5463 AS cfpk_customer_nation_4#5478, cval_customer_c_name#5464 AS cval_customer_c_name_4#5479, cval_customer_c_address#5465 AS cval_customer_c_address_4#5480, cval_customer_c_phone#5466 AS cval_customer_c_phone_4#5481, cval_customer_c_acctbal#5467 AS cval_customer_c_acctbal_4#5482, cval_customer_c_comment#5468 AS cval_customer_c_comment_4#5483, cval_customer_c_mktsegment#5469 AS cval_customer_c_mktsegment_4#5484, cc_name#5470 AS cc_name_4#5485, cc_address#5471 AS cc_address_4#5486, cc_phone#5472 AS cc_phone_4#5487, cc_acctbal#5473 AS cc_acctbal_4#5488, cc_comment#5474 AS cc_comment_4#5489, cc_mktsegment#5475 AS cc_mktsegment_4#5490]
               :  :     +- Relation[rid#5461,cpfk_nation_customer#5462,cfpk_customer_nation#5463,cval_customer_c_name#5464,cval_customer_c_address#5465,cval_customer_c_phone#5466,cval_customer_c_acctbal#5467,cval_customer_c_comment#5468,cval_customer_c_mktsegment#5469,cc_name#5470,cc_address#5471,cc_phone#5472,cc_acctbal#5473,cc_comment#5474,cc_mktsegment#5475] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#5599 AS rid_5#5616, cpfk_customer_orders#5600 AS cpfk_customer_orders_5#5617, cfpk_orders_customer#5601 AS cfpk_orders_customer_5#5618, cval_orders_o_orderstatus#5602 AS cval_orders_o_orderstatus_5#5619, cval_orders_o_totalprice#5603 AS cval_orders_o_totalprice_5#5620, cval_orders_o_orderpriority#5604 AS cval_orders_o_orderpriority_5#5621, cval_orders_o_clerk#5605 AS cval_orders_o_clerk_5#5622, cval_orders_o_shippriority#5606 AS cval_orders_o_shippriority_5#5623, cval_orders_o_comment#5607 AS cval_orders_o_comment_5#5624, cval_orders_o_orderdate#5608 AS cval_orders_o_orderdate_5#5625, co_orderstatus#5609 AS co_orderstatus_5#5626, co_totalprice#5610 AS co_totalprice_5#5627, co_orderpriority#5611 AS co_orderpriority_5#5628, co_clerk#5612 AS co_clerk_5#5629, co_shippriority#5613 AS co_shippriority_5#5630, co_comment#5614 AS co_comment_5#5631, co_orderdate#5615 AS co_orderdate_5#5632]
               :     +- Relation[rid#5599,cpfk_customer_orders#5600,cfpk_orders_customer#5601,cval_orders_o_orderstatus#5602,cval_orders_o_totalprice#5603,cval_orders_o_orderpriority#5604,cval_orders_o_clerk#5605,cval_orders_o_shippriority#5606,cval_orders_o_comment#5607,cval_orders_o_orderdate#5608,co_orderstatus#5609,co_totalprice#5610,co_orderpriority#5611,co_clerk#5612,co_shippriority#5613,co_comment#5614,co_orderdate#5615] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#5535 AS rid_5#5552, cpfk_customer_orders#5536 AS cpfk_customer_orders_5#5553, cfpk_orders_customer#5537 AS cfpk_orders_customer_5#5554, cval_orders_o_orderstatus#5538 AS cval_orders_o_orderstatus_5#5555, cval_orders_o_totalprice#5539 AS cval_orders_o_totalprice_5#5556, cval_orders_o_orderpriority#5540 AS cval_orders_o_orderpriority_5#5557, cval_orders_o_clerk#5541 AS cval_orders_o_clerk_5#5558, cval_orders_o_shippriority#5542 AS cval_orders_o_shippriority_5#5559, cval_orders_o_comment#5543 AS cval_orders_o_comment_5#5560, cval_orders_o_orderdate#5544 AS cval_orders_o_orderdate_5#5561, co_orderstatus#5545 AS co_orderstatus_5#5562, co_totalprice#5546 AS co_totalprice_5#5563, co_orderpriority#5547 AS co_orderpriority_5#5564, co_clerk#5548 AS co_clerk_5#5565, co_shippriority#5549 AS co_shippriority_5#5566, co_comment#5550 AS co_comment_5#5567, co_orderdate#5551 AS co_orderdate_5#5568]
                  +- Relation[rid#5535,cpfk_customer_orders#5536,cfpk_orders_customer#5537,cval_orders_o_orderstatus#5538,cval_orders_o_totalprice#5539,cval_orders_o_orderpriority#5540,cval_orders_o_clerk#5541,cval_orders_o_shippriority#5542,cval_orders_o_comment#5543,cval_orders_o_orderdate#5544,co_orderstatus#5545,co_totalprice#5546,co_orderpriority#5547,co_clerk#5548,co_shippriority#5549,co_comment#5550,co_orderdate#5551] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 361ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/15 16:59:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:59:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5730L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:59:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#5730L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#5732 AS rid_0#5765, cpfk_orders_lineitem#5733 AS cpfk_orders_lineitem_0#5766, cpfk_supplier_lineitem#5734 AS cpfk_supplier_lineitem_0#5767, cfpk_lineitem_supplier#5735 AS cfpk_lineitem_supplier_0#5768, cfpk_lineitem_partsupp#5736 AS cfpk_lineitem_partsupp_0#5769, cpfk_part_lineitem#5737 AS cpfk_part_lineitem_0#5770, cfpk_lineitem_part#5738 AS cfpk_lineitem_part_0#5771, cpfk_partsupp_lineitem#5739 AS cpfk_partsupp_lineitem_0#5772, cfpk_lineitem_orders#5740 AS cfpk_lineitem_orders_0#5773, cval_lineitem_l_quantity#5741 AS cval_lineitem_l_quantity_0#5774, cval_lineitem_l_extendedprice#5742 AS cval_lineitem_l_extendedprice_0#5775, cval_lineitem_l_discount#5743 AS cval_lineitem_l_discount_0#5776, cval_lineitem_l_tax#5744 AS cval_lineitem_l_tax_0#5777, cval_lineitem_l_returnflag#5745 AS cval_lineitem_l_returnflag_0#5778, cval_lineitem_l_linestatus#5746 AS cval_lineitem_l_linestatus_0#5779, cval_lineitem_l_commitdate#5747 AS cval_lineitem_l_commitdate_0#5780, cval_lineitem_l_receiptdate#5748 AS cval_lineitem_l_receiptdate_0#5781, cval_lineitem_l_shipinstruct#5749 AS cval_lineitem_l_shipinstruct_0#5782, cval_lineitem_l_shipmode#5750 AS cval_lineitem_l_shipmode_0#5783, cval_lineitem_l_comment#5751 AS cval_lineitem_l_comment_0#5784, cval_lineitem_l_shipdate#5752 AS cval_lineitem_l_shipdate_0#5785, cl_quantity#5753 AS cl_quantity_0#5786, cl_extendedprice#5754 AS cl_extendedprice_0#5787, cl_discount#5755 AS cl_discount_0#5788, ... 9 more fields]
         +- Relation[rid#5732,cpfk_orders_lineitem#5733,cpfk_supplier_lineitem#5734,cfpk_lineitem_supplier#5735,cfpk_lineitem_partsupp#5736,cpfk_part_lineitem#5737,cfpk_lineitem_part#5738,cpfk_partsupp_lineitem#5739,cfpk_lineitem_orders#5740,cval_lineitem_l_quantity#5741,cval_lineitem_l_extendedprice#5742,cval_lineitem_l_discount#5743,cval_lineitem_l_tax#5744,cval_lineitem_l_returnflag#5745,cval_lineitem_l_linestatus#5746,cval_lineitem_l_commitdate#5747,cval_lineitem_l_receiptdate#5748,cval_lineitem_l_shipinstruct#5749,cval_lineitem_l_shipmode#5750,cval_lineitem_l_comment#5751,cval_lineitem_l_shipdate#5752,cl_quantity#5753,cl_extendedprice#5754,cl_discount#5755,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2769ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/15 16:59:55 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:59:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5838L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:59:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:59:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:59:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:59:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5838L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#5840 AS rid_0#5853, cpfk_nation_supplier#5841 AS cpfk_nation_supplier_0#5854, cfpk_supplier_nation#5842 AS cfpk_supplier_nation_0#5855, cval_supplier_s_name#5843 AS cval_supplier_s_name_0#5856, cval_supplier_s_address#5844 AS cval_supplier_s_address_0#5857, cval_supplier_s_phone#5845 AS cval_supplier_s_phone_0#5858, cval_supplier_s_acctbal#5846 AS cval_supplier_s_acctbal_0#5859, cval_supplier_s_comment#5847 AS cval_supplier_s_comment_0#5860, cs_name#5848 AS cs_name_0#5861, cs_address#5849 AS cs_address_0#5862, cs_phone#5850 AS cs_phone_0#5863, cs_acctbal#5851 AS cs_acctbal_0#5864, cs_comment#5852 AS cs_comment_0#5865]
         :  :  +- Relation[rid#5840,cpfk_nation_supplier#5841,cfpk_supplier_nation#5842,cval_supplier_s_name#5843,cval_supplier_s_address#5844,cval_supplier_s_phone#5845,cval_supplier_s_acctbal#5846,cval_supplier_s_comment#5847,cs_name#5848,cs_address#5849,cs_phone#5850,cs_acctbal#5851,cs_comment#5852] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#5932 AS rid_0#5945, cpfk_nation_supplier#5933 AS cpfk_nation_supplier_0#5946, cfpk_supplier_nation#5934 AS cfpk_supplier_nation_0#5947, cval_supplier_s_name#5935 AS cval_supplier_s_name_0#5948, cval_supplier_s_address#5936 AS cval_supplier_s_address_0#5949, cval_supplier_s_phone#5937 AS cval_supplier_s_phone_0#5950, cval_supplier_s_acctbal#5938 AS cval_supplier_s_acctbal_0#5951, cval_supplier_s_comment#5939 AS cval_supplier_s_comment_0#5952, cs_name#5940 AS cs_name_0#5953, cs_address#5941 AS cs_address_0#5954, cs_phone#5942 AS cs_phone_0#5955, cs_acctbal#5943 AS cs_acctbal_0#5956, cs_comment#5944 AS cs_comment_0#5957]
         :     :  +- Relation[rid#5932,cpfk_nation_supplier#5933,cfpk_supplier_nation#5934,cval_supplier_s_name#5935,cval_supplier_s_address#5936,cval_supplier_s_phone#5937,cval_supplier_s_acctbal#5938,cval_supplier_s_comment#5939,cs_name#5940,cs_address#5941,cs_phone#5942,cs_acctbal#5943,cs_comment#5944] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#5958 AS rid_1#5991, cpfk_orders_lineitem#5959 AS cpfk_orders_lineitem_1#5992, cpfk_supplier_lineitem#5960 AS cpfk_supplier_lineitem_1#5993, cfpk_lineitem_supplier#5961 AS cfpk_lineitem_supplier_1#5994, cfpk_lineitem_partsupp#5962 AS cfpk_lineitem_partsupp_1#5995, cpfk_part_lineitem#5963 AS cpfk_part_lineitem_1#5996, cfpk_lineitem_part#5964 AS cfpk_lineitem_part_1#5997, cpfk_partsupp_lineitem#5965 AS cpfk_partsupp_lineitem_1#5998, cfpk_lineitem_orders#5966 AS cfpk_lineitem_orders_1#5999, cval_lineitem_l_quantity#5967 AS cval_lineitem_l_quantity_1#6000, cval_lineitem_l_extendedprice#5968 AS cval_lineitem_l_extendedprice_1#6001, cval_lineitem_l_discount#5969 AS cval_lineitem_l_discount_1#6002, cval_lineitem_l_tax#5970 AS cval_lineitem_l_tax_1#6003, cval_lineitem_l_returnflag#5971 AS cval_lineitem_l_returnflag_1#6004, cval_lineitem_l_linestatus#5972 AS cval_lineitem_l_linestatus_1#6005, cval_lineitem_l_commitdate#5973 AS cval_lineitem_l_commitdate_1#6006, cval_lineitem_l_receiptdate#5974 AS cval_lineitem_l_receiptdate_1#6007, cval_lineitem_l_shipinstruct#5975 AS cval_lineitem_l_shipinstruct_1#6008, cval_lineitem_l_shipmode#5976 AS cval_lineitem_l_shipmode_1#6009, cval_lineitem_l_comment#5977 AS cval_lineitem_l_comment_1#6010, cval_lineitem_l_shipdate#5978 AS cval_lineitem_l_shipdate_1#6011, cl_quantity#5979 AS cl_quantity_1#6012, cl_extendedprice#5980 AS cl_extendedprice_1#6013, cl_discount#5981 AS cl_discount_1#6014, ... 9 more fields]
         :        +- Relation[rid#5958,cpfk_orders_lineitem#5959,cpfk_supplier_lineitem#5960,cfpk_lineitem_supplier#5961,cfpk_lineitem_partsupp#5962,cpfk_part_lineitem#5963,cfpk_lineitem_part#5964,cpfk_partsupp_lineitem#5965,cfpk_lineitem_orders#5966,cval_lineitem_l_quantity#5967,cval_lineitem_l_extendedprice#5968,cval_lineitem_l_discount#5969,cval_lineitem_l_tax#5970,cval_lineitem_l_returnflag#5971,cval_lineitem_l_linestatus#5972,cval_lineitem_l_commitdate#5973,cval_lineitem_l_receiptdate#5974,cval_lineitem_l_shipinstruct#5975,cval_lineitem_l_shipmode#5976,cval_lineitem_l_comment#5977,cval_lineitem_l_shipdate#5978,cl_quantity#5979,cl_extendedprice#5980,cl_discount#5981,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5866 AS rid_1#5899, cpfk_orders_lineitem#5867 AS cpfk_orders_lineitem_1#5900, cpfk_supplier_lineitem#5868 AS cpfk_supplier_lineitem_1#5901, cfpk_lineitem_supplier#5869 AS cfpk_lineitem_supplier_1#5902, cfpk_lineitem_partsupp#5870 AS cfpk_lineitem_partsupp_1#5903, cpfk_part_lineitem#5871 AS cpfk_part_lineitem_1#5904, cfpk_lineitem_part#5872 AS cfpk_lineitem_part_1#5905, cpfk_partsupp_lineitem#5873 AS cpfk_partsupp_lineitem_1#5906, cfpk_lineitem_orders#5874 AS cfpk_lineitem_orders_1#5907, cval_lineitem_l_quantity#5875 AS cval_lineitem_l_quantity_1#5908, cval_lineitem_l_extendedprice#5876 AS cval_lineitem_l_extendedprice_1#5909, cval_lineitem_l_discount#5877 AS cval_lineitem_l_discount_1#5910, cval_lineitem_l_tax#5878 AS cval_lineitem_l_tax_1#5911, cval_lineitem_l_returnflag#5879 AS cval_lineitem_l_returnflag_1#5912, cval_lineitem_l_linestatus#5880 AS cval_lineitem_l_linestatus_1#5913, cval_lineitem_l_commitdate#5881 AS cval_lineitem_l_commitdate_1#5914, cval_lineitem_l_receiptdate#5882 AS cval_lineitem_l_receiptdate_1#5915, cval_lineitem_l_shipinstruct#5883 AS cval_lineitem_l_shipinstruct_1#5916, cval_lineitem_l_shipmode#5884 AS cval_lineitem_l_shipmode_1#5917, cval_lineitem_l_comment#5885 AS cval_lineitem_l_comment_1#5918, cval_lineitem_l_shipdate#5886 AS cval_lineitem_l_shipdate_1#5919, cl_quantity#5887 AS cl_quantity_1#5920, cl_extendedprice#5888 AS cl_extendedprice_1#5921, cl_discount#5889 AS cl_discount_1#5922, ... 9 more fields]
            +- Relation[rid#5866,cpfk_orders_lineitem#5867,cpfk_supplier_lineitem#5868,cfpk_lineitem_supplier#5869,cfpk_lineitem_partsupp#5870,cpfk_part_lineitem#5871,cfpk_lineitem_part#5872,cpfk_partsupp_lineitem#5873,cfpk_lineitem_orders#5874,cval_lineitem_l_quantity#5875,cval_lineitem_l_extendedprice#5876,cval_lineitem_l_discount#5877,cval_lineitem_l_tax#5878,cval_lineitem_l_returnflag#5879,cval_lineitem_l_linestatus#5880,cval_lineitem_l_commitdate#5881,cval_lineitem_l_receiptdate#5882,cval_lineitem_l_shipinstruct#5883,cval_lineitem_l_shipmode#5884,cval_lineitem_l_comment#5885,cval_lineitem_l_shipdate#5886,cl_quantity#5887,cl_extendedprice#5888,cl_discount#5889,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 90528ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/15 17:01:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:01:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6075L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:01:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#6075L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#6077 AS rid_0#6110, cpfk_orders_lineitem#6078 AS cpfk_orders_lineitem_0#6111, cpfk_supplier_lineitem#6079 AS cpfk_supplier_lineitem_0#6112, cfpk_lineitem_supplier#6080 AS cfpk_lineitem_supplier_0#6113, cfpk_lineitem_partsupp#6081 AS cfpk_lineitem_partsupp_0#6114, cpfk_part_lineitem#6082 AS cpfk_part_lineitem_0#6115, cfpk_lineitem_part#6083 AS cfpk_lineitem_part_0#6116, cpfk_partsupp_lineitem#6084 AS cpfk_partsupp_lineitem_0#6117, cfpk_lineitem_orders#6085 AS cfpk_lineitem_orders_0#6118, cval_lineitem_l_quantity#6086 AS cval_lineitem_l_quantity_0#6119, cval_lineitem_l_extendedprice#6087 AS cval_lineitem_l_extendedprice_0#6120, cval_lineitem_l_discount#6088 AS cval_lineitem_l_discount_0#6121, cval_lineitem_l_tax#6089 AS cval_lineitem_l_tax_0#6122, cval_lineitem_l_returnflag#6090 AS cval_lineitem_l_returnflag_0#6123, cval_lineitem_l_linestatus#6091 AS cval_lineitem_l_linestatus_0#6124, cval_lineitem_l_commitdate#6092 AS cval_lineitem_l_commitdate_0#6125, cval_lineitem_l_receiptdate#6093 AS cval_lineitem_l_receiptdate_0#6126, cval_lineitem_l_shipinstruct#6094 AS cval_lineitem_l_shipinstruct_0#6127, cval_lineitem_l_shipmode#6095 AS cval_lineitem_l_shipmode_0#6128, cval_lineitem_l_comment#6096 AS cval_lineitem_l_comment_0#6129, cval_lineitem_l_shipdate#6097 AS cval_lineitem_l_shipdate_0#6130, cl_quantity#6098 AS cl_quantity_0#6131, cl_extendedprice#6099 AS cl_extendedprice_0#6132, cl_discount#6100 AS cl_discount_0#6133, ... 9 more fields]
         +- Relation[rid#6077,cpfk_orders_lineitem#6078,cpfk_supplier_lineitem#6079,cfpk_lineitem_supplier#6080,cfpk_lineitem_partsupp#6081,cpfk_part_lineitem#6082,cfpk_lineitem_part#6083,cpfk_partsupp_lineitem#6084,cfpk_lineitem_orders#6085,cval_lineitem_l_quantity#6086,cval_lineitem_l_extendedprice#6087,cval_lineitem_l_discount#6088,cval_lineitem_l_tax#6089,cval_lineitem_l_returnflag#6090,cval_lineitem_l_linestatus#6091,cval_lineitem_l_commitdate#6092,cval_lineitem_l_receiptdate#6093,cval_lineitem_l_shipinstruct#6094,cval_lineitem_l_shipmode#6095,cval_lineitem_l_comment#6096,cval_lineitem_l_shipdate#6097,cl_quantity#6098,cl_extendedprice#6099,cl_discount#6100,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2693ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 17:01:28 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:01:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6185L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 17:01:28 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:01:28 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:01:28 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:01:28 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:01:28 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:01:28 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:01:29 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:01:29 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:01:29 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:01:29 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:01:29 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:01:29 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:01:29 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:01:29 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:01:29 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:01:29 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:01:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6185L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#6187 AS rid_0#6194, cpfk_region_nation#6188 AS cpfk_region_nation_0#6195, cfpk_nation_region#6189 AS cfpk_nation_region_0#6196, cval_nation_n_name#6190 AS cval_nation_n_name_0#6197, cval_nation_n_comment#6191 AS cval_nation_n_comment_0#6198, cn_name#6192 AS cn_name_0#6199, cn_comment#6193 AS cn_comment_0#6200]
            :  :  :     :  :  :  :  :  +- Relation[rid#6187,cpfk_region_nation#6188,cfpk_nation_region#6189,cval_nation_n_name#6190,cval_nation_n_comment#6191,cn_name#6192,cn_comment#6193] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#6227 AS rid_0#6234, cpfk_region_nation#6228 AS cpfk_region_nation_0#6235, cfpk_nation_region#6229 AS cfpk_nation_region_0#6236, cval_nation_n_name#6230 AS cval_nation_n_name_0#6237, cval_nation_n_comment#6231 AS cval_nation_n_comment_0#6238, cn_name#6232 AS cn_name_0#6239, cn_comment#6233 AS cn_comment_0#6240]
            :  :  :     :  :  :  :     :  +- Relation[rid#6227,cpfk_region_nation#6228,cfpk_nation_region#6229,cval_nation_n_name#6230,cval_nation_n_comment#6231,cn_name#6232,cn_comment#6233] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#6241 AS rid_1#6254, cpfk_nation_supplier#6242 AS cpfk_nation_supplier_1#6255, cfpk_supplier_nation#6243 AS cfpk_supplier_nation_1#6256, cval_supplier_s_name#6244 AS cval_supplier_s_name_1#6257, cval_supplier_s_address#6245 AS cval_supplier_s_address_1#6258, cval_supplier_s_phone#6246 AS cval_supplier_s_phone_1#6259, cval_supplier_s_acctbal#6247 AS cval_supplier_s_acctbal_1#6260, cval_supplier_s_comment#6248 AS cval_supplier_s_comment_1#6261, cs_name#6249 AS cs_name_1#6262, cs_address#6250 AS cs_address_1#6263, cs_phone#6251 AS cs_phone_1#6264, cs_acctbal#6252 AS cs_acctbal_1#6265, cs_comment#6253 AS cs_comment_1#6266]
            :  :  :     :  :  :  :        +- Relation[rid#6241,cpfk_nation_supplier#6242,cfpk_supplier_nation#6243,cval_supplier_s_name#6244,cval_supplier_s_address#6245,cval_supplier_s_phone#6246,cval_supplier_s_acctbal#6247,cval_supplier_s_comment#6248,cs_name#6249,cs_address#6250,cs_phone#6251,cs_acctbal#6252,cs_comment#6253] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#6201 AS rid_1#6214, cpfk_nation_supplier#6202 AS cpfk_nation_supplier_1#6215, cfpk_supplier_nation#6203 AS cfpk_supplier_nation_1#6216, cval_supplier_s_name#6204 AS cval_supplier_s_name_1#6217, cval_supplier_s_address#6205 AS cval_supplier_s_address_1#6218, cval_supplier_s_phone#6206 AS cval_supplier_s_phone_1#6219, cval_supplier_s_acctbal#6207 AS cval_supplier_s_acctbal_1#6220, cval_supplier_s_comment#6208 AS cval_supplier_s_comment_1#6221, cs_name#6209 AS cs_name_1#6222, cs_address#6210 AS cs_address_1#6223, cs_phone#6211 AS cs_phone_1#6224, cs_acctbal#6212 AS cs_acctbal_1#6225, cs_comment#6213 AS cs_comment_1#6226]
            :  :  :     :  :  :     +- Relation[rid#6201,cpfk_nation_supplier#6202,cfpk_supplier_nation#6203,cval_supplier_s_name#6204,cval_supplier_s_address#6205,cval_supplier_s_phone#6206,cval_supplier_s_acctbal#6207,cval_supplier_s_comment#6208,cs_name#6209,cs_address#6210,cs_phone#6211,cs_acctbal#6212,cs_comment#6213] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#6289 AS rid_1#6302, cpfk_nation_supplier#6290 AS cpfk_nation_supplier_1#6303, cfpk_supplier_nation#6291 AS cfpk_supplier_nation_1#6304, cval_supplier_s_name#6292 AS cval_supplier_s_name_1#6305, cval_supplier_s_address#6293 AS cval_supplier_s_address_1#6306, cval_supplier_s_phone#6294 AS cval_supplier_s_phone_1#6307, cval_supplier_s_acctbal#6295 AS cval_supplier_s_acctbal_1#6308, cval_supplier_s_comment#6296 AS cval_supplier_s_comment_1#6309, cs_name#6297 AS cs_name_1#6310, cs_address#6298 AS cs_address_1#6311, cs_phone#6299 AS cs_phone_1#6312, cs_acctbal#6300 AS cs_acctbal_1#6313, cs_comment#6301 AS cs_comment_1#6314]
            :  :  :     :  :     :  +- Relation[rid#6289,cpfk_nation_supplier#6290,cfpk_supplier_nation#6291,cval_supplier_s_name#6292,cval_supplier_s_address#6293,cval_supplier_s_phone#6294,cval_supplier_s_acctbal#6295,cval_supplier_s_comment#6296,cs_name#6297,cs_address#6298,cs_phone#6299,cs_acctbal#6300,cs_comment#6301] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#6315 AS rid_2#6326, cpfk_part_partsupp#6316 AS cpfk_part_partsupp_2#6327, cfpk_partsupp_part#6317 AS cfpk_partsupp_part_2#6328, cpfk_supplier_partsupp#6318 AS cpfk_supplier_partsupp_2#6329, cfpk_partsupp_supplier#6319 AS cfpk_partsupp_supplier_2#6330, cval_partsupp_ps_availqty#6320 AS cval_partsupp_ps_availqty_2#6331, cval_partsupp_ps_supplycost#6321 AS cval_partsupp_ps_supplycost_2#6332, cval_partsupp_ps_comment#6322 AS cval_partsupp_ps_comment_2#6333, cps_availqty#6323 AS cps_availqty_2#6334, cps_supplycost#6324 AS cps_supplycost_2#6335, cps_comment#6325 AS cps_comment_2#6336]
            :  :  :     :  :        +- Relation[rid#6315,cpfk_part_partsupp#6316,cfpk_partsupp_part#6317,cpfk_supplier_partsupp#6318,cfpk_partsupp_supplier#6319,cval_partsupp_ps_availqty#6320,cval_partsupp_ps_supplycost#6321,cval_partsupp_ps_comment#6322,cps_availqty#6323,cps_supplycost#6324,cps_comment#6325] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#6267 AS rid_2#6278, cpfk_part_partsupp#6268 AS cpfk_part_partsupp_2#6279, cfpk_partsupp_part#6269 AS cfpk_partsupp_part_2#6280, cpfk_supplier_partsupp#6270 AS cpfk_supplier_partsupp_2#6281, cfpk_partsupp_supplier#6271 AS cfpk_partsupp_supplier_2#6282, cval_partsupp_ps_availqty#6272 AS cval_partsupp_ps_availqty_2#6283, cval_partsupp_ps_supplycost#6273 AS cval_partsupp_ps_supplycost_2#6284, cval_partsupp_ps_comment#6274 AS cval_partsupp_ps_comment_2#6285, cps_availqty#6275 AS cps_availqty_2#6286, cps_supplycost#6276 AS cps_supplycost_2#6287, cps_comment#6277 AS cps_comment_2#6288]
            :  :  :     :     +- Relation[rid#6267,cpfk_part_partsupp#6268,cfpk_partsupp_part#6269,cpfk_supplier_partsupp#6270,cfpk_partsupp_supplier#6271,cval_partsupp_ps_availqty#6272,cval_partsupp_ps_supplycost#6273,cval_partsupp_ps_comment#6274,cps_availqty#6275,cps_supplycost#6276,cps_comment#6277] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#6337 AS rid_3#6354, cval_part_p_name#6338 AS cval_part_p_name_3#6355, cval_part_p_mfgr#6339 AS cval_part_p_mfgr_3#6356, cval_part_p_type#6340 AS cval_part_p_type_3#6357, cval_part_p_size#6341 AS cval_part_p_size_3#6358, cval_part_p_container#6342 AS cval_part_p_container_3#6359, cval_part_p_retailprice#6343 AS cval_part_p_retailprice_3#6360, cval_part_p_comment#6344 AS cval_part_p_comment_3#6361, cval_part_p_brand#6345 AS cval_part_p_brand_3#6362, cp_name#6346 AS cp_name_3#6363, cp_mfgr#6347 AS cp_mfgr_3#6364, cp_type#6348 AS cp_type_3#6365, cp_size#6349 AS cp_size_3#6366, cp_container#6350 AS cp_container_3#6367, cp_retailprice#6351 AS cp_retailprice_3#6368, cp_comment#6352 AS cp_comment_3#6369, cp_brand#6353 AS cp_brand_3#6370]
            :  :  :        +- Relation[rid#6337,cval_part_p_name#6338,cval_part_p_mfgr#6339,cval_part_p_type#6340,cval_part_p_size#6341,cval_part_p_container#6342,cval_part_p_retailprice#6343,cval_part_p_comment#6344,cval_part_p_brand#6345,cp_name#6346,cp_mfgr#6347,cp_type#6348,cp_size#6349,cp_container#6350,cp_retailprice#6351,cp_comment#6352,cp_brand#6353] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#6437 AS rid_2#6448, cpfk_part_partsupp#6438 AS cpfk_part_partsupp_2#6449, cfpk_partsupp_part#6439 AS cfpk_partsupp_part_2#6450, cpfk_supplier_partsupp#6440 AS cpfk_supplier_partsupp_2#6451, cfpk_partsupp_supplier#6441 AS cfpk_partsupp_supplier_2#6452, cval_partsupp_ps_availqty#6442 AS cval_partsupp_ps_availqty_2#6453, cval_partsupp_ps_supplycost#6443 AS cval_partsupp_ps_supplycost_2#6454, cval_partsupp_ps_comment#6444 AS cval_partsupp_ps_comment_2#6455, cps_availqty#6445 AS cps_availqty_2#6456, cps_supplycost#6446 AS cps_supplycost_2#6457, cps_comment#6447 AS cps_comment_2#6458]
            :  :     :  +- Relation[rid#6437,cpfk_part_partsupp#6438,cfpk_partsupp_part#6439,cpfk_supplier_partsupp#6440,cfpk_partsupp_supplier#6441,cval_partsupp_ps_availqty#6442,cval_partsupp_ps_supplycost#6443,cval_partsupp_ps_comment#6444,cps_availqty#6445,cps_supplycost#6446,cps_comment#6447] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#6459 AS rid_4#6492, cpfk_orders_lineitem#6460 AS cpfk_orders_lineitem_4#6493, cpfk_supplier_lineitem#6461 AS cpfk_supplier_lineitem_4#6494, cfpk_lineitem_supplier#6462 AS cfpk_lineitem_supplier_4#6495, cfpk_lineitem_partsupp#6463 AS cfpk_lineitem_partsupp_4#6496, cpfk_part_lineitem#6464 AS cpfk_part_lineitem_4#6497, cfpk_lineitem_part#6465 AS cfpk_lineitem_part_4#6498, cpfk_partsupp_lineitem#6466 AS cpfk_partsupp_lineitem_4#6499, cfpk_lineitem_orders#6467 AS cfpk_lineitem_orders_4#6500, cval_lineitem_l_quantity#6468 AS cval_lineitem_l_quantity_4#6501, cval_lineitem_l_extendedprice#6469 AS cval_lineitem_l_extendedprice_4#6502, cval_lineitem_l_discount#6470 AS cval_lineitem_l_discount_4#6503, cval_lineitem_l_tax#6471 AS cval_lineitem_l_tax_4#6504, cval_lineitem_l_returnflag#6472 AS cval_lineitem_l_returnflag_4#6505, cval_lineitem_l_linestatus#6473 AS cval_lineitem_l_linestatus_4#6506, cval_lineitem_l_commitdate#6474 AS cval_lineitem_l_commitdate_4#6507, cval_lineitem_l_receiptdate#6475 AS cval_lineitem_l_receiptdate_4#6508, cval_lineitem_l_shipinstruct#6476 AS cval_lineitem_l_shipinstruct_4#6509, cval_lineitem_l_shipmode#6477 AS cval_lineitem_l_shipmode_4#6510, cval_lineitem_l_comment#6478 AS cval_lineitem_l_comment_4#6511, cval_lineitem_l_shipdate#6479 AS cval_lineitem_l_shipdate_4#6512, cl_quantity#6480 AS cl_quantity_4#6513, cl_extendedprice#6481 AS cl_extendedprice_4#6514, cl_discount#6482 AS cl_discount_4#6515, ... 9 more fields]
            :  :        +- Relation[rid#6459,cpfk_orders_lineitem#6460,cpfk_supplier_lineitem#6461,cfpk_lineitem_supplier#6462,cfpk_lineitem_partsupp#6463,cpfk_part_lineitem#6464,cfpk_lineitem_part#6465,cpfk_partsupp_lineitem#6466,cfpk_lineitem_orders#6467,cval_lineitem_l_quantity#6468,cval_lineitem_l_extendedprice#6469,cval_lineitem_l_discount#6470,cval_lineitem_l_tax#6471,cval_lineitem_l_returnflag#6472,cval_lineitem_l_linestatus#6473,cval_lineitem_l_commitdate#6474,cval_lineitem_l_receiptdate#6475,cval_lineitem_l_shipinstruct#6476,cval_lineitem_l_shipmode#6477,cval_lineitem_l_comment#6478,cval_lineitem_l_shipdate#6479,cl_quantity#6480,cl_extendedprice#6481,cl_discount#6482,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#6371 AS rid_4#6404, cpfk_orders_lineitem#6372 AS cpfk_orders_lineitem_4#6405, cpfk_supplier_lineitem#6373 AS cpfk_supplier_lineitem_4#6406, cfpk_lineitem_supplier#6374 AS cfpk_lineitem_supplier_4#6407, cfpk_lineitem_partsupp#6375 AS cfpk_lineitem_partsupp_4#6408, cpfk_part_lineitem#6376 AS cpfk_part_lineitem_4#6409, cfpk_lineitem_part#6377 AS cfpk_lineitem_part_4#6410, cpfk_partsupp_lineitem#6378 AS cpfk_partsupp_lineitem_4#6411, cfpk_lineitem_orders#6379 AS cfpk_lineitem_orders_4#6412, cval_lineitem_l_quantity#6380 AS cval_lineitem_l_quantity_4#6413, cval_lineitem_l_extendedprice#6381 AS cval_lineitem_l_extendedprice_4#6414, cval_lineitem_l_discount#6382 AS cval_lineitem_l_discount_4#6415, cval_lineitem_l_tax#6383 AS cval_lineitem_l_tax_4#6416, cval_lineitem_l_returnflag#6384 AS cval_lineitem_l_returnflag_4#6417, cval_lineitem_l_linestatus#6385 AS cval_lineitem_l_linestatus_4#6418, cval_lineitem_l_commitdate#6386 AS cval_lineitem_l_commitdate_4#6419, cval_lineitem_l_receiptdate#6387 AS cval_lineitem_l_receiptdate_4#6420, cval_lineitem_l_shipinstruct#6388 AS cval_lineitem_l_shipinstruct_4#6421, cval_lineitem_l_shipmode#6389 AS cval_lineitem_l_shipmode_4#6422, cval_lineitem_l_comment#6390 AS cval_lineitem_l_comment_4#6423, cval_lineitem_l_shipdate#6391 AS cval_lineitem_l_shipdate_4#6424, cl_quantity#6392 AS cl_quantity_4#6425, cl_extendedprice#6393 AS cl_extendedprice_4#6426, cl_discount#6394 AS cl_discount_4#6427, ... 9 more fields]
            :     +- Relation[rid#6371,cpfk_orders_lineitem#6372,cpfk_supplier_lineitem#6373,cfpk_lineitem_supplier#6374,cfpk_lineitem_partsupp#6375,cpfk_part_lineitem#6376,cfpk_lineitem_part#6377,cpfk_partsupp_lineitem#6378,cfpk_lineitem_orders#6379,cval_lineitem_l_quantity#6380,cval_lineitem_l_extendedprice#6381,cval_lineitem_l_discount#6382,cval_lineitem_l_tax#6383,cval_lineitem_l_returnflag#6384,cval_lineitem_l_linestatus#6385,cval_lineitem_l_commitdate#6386,cval_lineitem_l_receiptdate#6387,cval_lineitem_l_shipinstruct#6388,cval_lineitem_l_shipmode#6389,cval_lineitem_l_comment#6390,cval_lineitem_l_shipdate#6391,cl_quantity#6392,cl_extendedprice#6393,cl_discount#6394,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#6525 AS rid_5#6542, cpfk_customer_orders#6526 AS cpfk_customer_orders_5#6543, cfpk_orders_customer#6527 AS cfpk_orders_customer_5#6544, cval_orders_o_orderstatus#6528 AS cval_orders_o_orderstatus_5#6545, cval_orders_o_totalprice#6529 AS cval_orders_o_totalprice_5#6546, cval_orders_o_orderpriority#6530 AS cval_orders_o_orderpriority_5#6547, cval_orders_o_clerk#6531 AS cval_orders_o_clerk_5#6548, cval_orders_o_shippriority#6532 AS cval_orders_o_shippriority_5#6549, cval_orders_o_comment#6533 AS cval_orders_o_comment_5#6550, cval_orders_o_orderdate#6534 AS cval_orders_o_orderdate_5#6551, co_orderstatus#6535 AS co_orderstatus_5#6552, co_totalprice#6536 AS co_totalprice_5#6553, co_orderpriority#6537 AS co_orderpriority_5#6554, co_clerk#6538 AS co_clerk_5#6555, co_shippriority#6539 AS co_shippriority_5#6556, co_comment#6540 AS co_comment_5#6557, co_orderdate#6541 AS co_orderdate_5#6558]
               +- Relation[rid#6525,cpfk_customer_orders#6526,cfpk_orders_customer#6527,cval_orders_o_orderstatus#6528,cval_orders_o_totalprice#6529,cval_orders_o_orderpriority#6530,cval_orders_o_clerk#6531,cval_orders_o_shippriority#6532,cval_orders_o_comment#6533,cval_orders_o_orderdate#6534,co_orderstatus#6535,co_totalprice#6536,co_orderpriority#6537,co_clerk#6538,co_shippriority#6539,co_comment#6540,co_orderdate#6541] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 169517ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/15 17:04:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:04:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6663L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:04:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6663L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#6665 AS rid_0#6682, cval_part_p_name#6666 AS cval_part_p_name_0#6683, cval_part_p_mfgr#6667 AS cval_part_p_mfgr_0#6684, cval_part_p_type#6668 AS cval_part_p_type_0#6685, cval_part_p_size#6669 AS cval_part_p_size_0#6686, cval_part_p_container#6670 AS cval_part_p_container_0#6687, cval_part_p_retailprice#6671 AS cval_part_p_retailprice_0#6688, cval_part_p_comment#6672 AS cval_part_p_comment_0#6689, cval_part_p_brand#6673 AS cval_part_p_brand_0#6690, cp_name#6674 AS cp_name_0#6691, cp_mfgr#6675 AS cp_mfgr_0#6692, cp_type#6676 AS cp_type_0#6693, cp_size#6677 AS cp_size_0#6694, cp_container#6678 AS cp_container_0#6695, cp_retailprice#6679 AS cp_retailprice_0#6696, cp_comment#6680 AS cp_comment_0#6697, cp_brand#6681 AS cp_brand_0#6698]
         :  :  +- Relation[rid#6665,cval_part_p_name#6666,cval_part_p_mfgr#6667,cval_part_p_type#6668,cval_part_p_size#6669,cval_part_p_container#6670,cval_part_p_retailprice#6671,cval_part_p_comment#6672,cval_part_p_brand#6673,cp_name#6674,cp_mfgr#6675,cp_type#6676,cp_size#6677,cp_container#6678,cp_retailprice#6679,cp_comment#6680,cp_brand#6681] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#6765 AS rid_0#6782, cval_part_p_name#6766 AS cval_part_p_name_0#6783, cval_part_p_mfgr#6767 AS cval_part_p_mfgr_0#6784, cval_part_p_type#6768 AS cval_part_p_type_0#6785, cval_part_p_size#6769 AS cval_part_p_size_0#6786, cval_part_p_container#6770 AS cval_part_p_container_0#6787, cval_part_p_retailprice#6771 AS cval_part_p_retailprice_0#6788, cval_part_p_comment#6772 AS cval_part_p_comment_0#6789, cval_part_p_brand#6773 AS cval_part_p_brand_0#6790, cp_name#6774 AS cp_name_0#6791, cp_mfgr#6775 AS cp_mfgr_0#6792, cp_type#6776 AS cp_type_0#6793, cp_size#6777 AS cp_size_0#6794, cp_container#6778 AS cp_container_0#6795, cp_retailprice#6779 AS cp_retailprice_0#6796, cp_comment#6780 AS cp_comment_0#6797, cp_brand#6781 AS cp_brand_0#6798]
         :     :  +- Relation[rid#6765,cval_part_p_name#6766,cval_part_p_mfgr#6767,cval_part_p_type#6768,cval_part_p_size#6769,cval_part_p_container#6770,cval_part_p_retailprice#6771,cval_part_p_comment#6772,cval_part_p_brand#6773,cp_name#6774,cp_mfgr#6775,cp_type#6776,cp_size#6777,cp_container#6778,cp_retailprice#6779,cp_comment#6780,cp_brand#6781] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#6799 AS rid_1#6832, cpfk_orders_lineitem#6800 AS cpfk_orders_lineitem_1#6833, cpfk_supplier_lineitem#6801 AS cpfk_supplier_lineitem_1#6834, cfpk_lineitem_supplier#6802 AS cfpk_lineitem_supplier_1#6835, cfpk_lineitem_partsupp#6803 AS cfpk_lineitem_partsupp_1#6836, cpfk_part_lineitem#6804 AS cpfk_part_lineitem_1#6837, cfpk_lineitem_part#6805 AS cfpk_lineitem_part_1#6838, cpfk_partsupp_lineitem#6806 AS cpfk_partsupp_lineitem_1#6839, cfpk_lineitem_orders#6807 AS cfpk_lineitem_orders_1#6840, cval_lineitem_l_quantity#6808 AS cval_lineitem_l_quantity_1#6841, cval_lineitem_l_extendedprice#6809 AS cval_lineitem_l_extendedprice_1#6842, cval_lineitem_l_discount#6810 AS cval_lineitem_l_discount_1#6843, cval_lineitem_l_tax#6811 AS cval_lineitem_l_tax_1#6844, cval_lineitem_l_returnflag#6812 AS cval_lineitem_l_returnflag_1#6845, cval_lineitem_l_linestatus#6813 AS cval_lineitem_l_linestatus_1#6846, cval_lineitem_l_commitdate#6814 AS cval_lineitem_l_commitdate_1#6847, cval_lineitem_l_receiptdate#6815 AS cval_lineitem_l_receiptdate_1#6848, cval_lineitem_l_shipinstruct#6816 AS cval_lineitem_l_shipinstruct_1#6849, cval_lineitem_l_shipmode#6817 AS cval_lineitem_l_shipmode_1#6850, cval_lineitem_l_comment#6818 AS cval_lineitem_l_comment_1#6851, cval_lineitem_l_shipdate#6819 AS cval_lineitem_l_shipdate_1#6852, cl_quantity#6820 AS cl_quantity_1#6853, cl_extendedprice#6821 AS cl_extendedprice_1#6854, cl_discount#6822 AS cl_discount_1#6855, ... 9 more fields]
         :        +- Relation[rid#6799,cpfk_orders_lineitem#6800,cpfk_supplier_lineitem#6801,cfpk_lineitem_supplier#6802,cfpk_lineitem_partsupp#6803,cpfk_part_lineitem#6804,cfpk_lineitem_part#6805,cpfk_partsupp_lineitem#6806,cfpk_lineitem_orders#6807,cval_lineitem_l_quantity#6808,cval_lineitem_l_extendedprice#6809,cval_lineitem_l_discount#6810,cval_lineitem_l_tax#6811,cval_lineitem_l_returnflag#6812,cval_lineitem_l_linestatus#6813,cval_lineitem_l_commitdate#6814,cval_lineitem_l_receiptdate#6815,cval_lineitem_l_shipinstruct#6816,cval_lineitem_l_shipmode#6817,cval_lineitem_l_comment#6818,cval_lineitem_l_shipdate#6819,cl_quantity#6820,cl_extendedprice#6821,cl_discount#6822,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6699 AS rid_1#6732, cpfk_orders_lineitem#6700 AS cpfk_orders_lineitem_1#6733, cpfk_supplier_lineitem#6701 AS cpfk_supplier_lineitem_1#6734, cfpk_lineitem_supplier#6702 AS cfpk_lineitem_supplier_1#6735, cfpk_lineitem_partsupp#6703 AS cfpk_lineitem_partsupp_1#6736, cpfk_part_lineitem#6704 AS cpfk_part_lineitem_1#6737, cfpk_lineitem_part#6705 AS cfpk_lineitem_part_1#6738, cpfk_partsupp_lineitem#6706 AS cpfk_partsupp_lineitem_1#6739, cfpk_lineitem_orders#6707 AS cfpk_lineitem_orders_1#6740, cval_lineitem_l_quantity#6708 AS cval_lineitem_l_quantity_1#6741, cval_lineitem_l_extendedprice#6709 AS cval_lineitem_l_extendedprice_1#6742, cval_lineitem_l_discount#6710 AS cval_lineitem_l_discount_1#6743, cval_lineitem_l_tax#6711 AS cval_lineitem_l_tax_1#6744, cval_lineitem_l_returnflag#6712 AS cval_lineitem_l_returnflag_1#6745, cval_lineitem_l_linestatus#6713 AS cval_lineitem_l_linestatus_1#6746, cval_lineitem_l_commitdate#6714 AS cval_lineitem_l_commitdate_1#6747, cval_lineitem_l_receiptdate#6715 AS cval_lineitem_l_receiptdate_1#6748, cval_lineitem_l_shipinstruct#6716 AS cval_lineitem_l_shipinstruct_1#6749, cval_lineitem_l_shipmode#6717 AS cval_lineitem_l_shipmode_1#6750, cval_lineitem_l_comment#6718 AS cval_lineitem_l_comment_1#6751, cval_lineitem_l_shipdate#6719 AS cval_lineitem_l_shipdate_1#6752, cl_quantity#6720 AS cl_quantity_1#6753, cl_extendedprice#6721 AS cl_extendedprice_1#6754, cl_discount#6722 AS cl_discount_1#6755, ... 9 more fields]
            +- Relation[rid#6699,cpfk_orders_lineitem#6700,cpfk_supplier_lineitem#6701,cfpk_lineitem_supplier#6702,cfpk_lineitem_partsupp#6703,cpfk_part_lineitem#6704,cfpk_lineitem_part#6705,cpfk_partsupp_lineitem#6706,cfpk_lineitem_orders#6707,cval_lineitem_l_quantity#6708,cval_lineitem_l_extendedprice#6709,cval_lineitem_l_discount#6710,cval_lineitem_l_tax#6711,cval_lineitem_l_returnflag#6712,cval_lineitem_l_linestatus#6713,cval_lineitem_l_commitdate#6714,cval_lineitem_l_receiptdate#6715,cval_lineitem_l_shipinstruct#6716,cval_lineitem_l_shipmode#6717,cval_lineitem_l_comment#6718,cval_lineitem_l_shipdate#6719,cl_quantity#6720,cl_extendedprice#6721,cl_discount#6722,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 90691ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/15 17:05:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:05:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6922L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 17:05:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:05:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:05:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:05:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6922L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#6924 AS rid_0#6941, cval_part_p_name#6925 AS cval_part_p_name_0#6942, cval_part_p_mfgr#6926 AS cval_part_p_mfgr_0#6943, cval_part_p_type#6927 AS cval_part_p_type_0#6944, cval_part_p_size#6928 AS cval_part_p_size_0#6945, cval_part_p_container#6929 AS cval_part_p_container_0#6946, cval_part_p_retailprice#6930 AS cval_part_p_retailprice_0#6947, cval_part_p_comment#6931 AS cval_part_p_comment_0#6948, cval_part_p_brand#6932 AS cval_part_p_brand_0#6949, cp_name#6933 AS cp_name_0#6950, cp_mfgr#6934 AS cp_mfgr_0#6951, cp_type#6935 AS cp_type_0#6952, cp_size#6936 AS cp_size_0#6953, cp_container#6937 AS cp_container_0#6954, cp_retailprice#6938 AS cp_retailprice_0#6955, cp_comment#6939 AS cp_comment_0#6956, cp_brand#6940 AS cp_brand_0#6957]
         :  :  :  +- Relation[rid#6924,cval_part_p_name#6925,cval_part_p_mfgr#6926,cval_part_p_type#6927,cval_part_p_size#6928,cval_part_p_container#6929,cval_part_p_retailprice#6930,cval_part_p_comment#6931,cval_part_p_brand#6932,cp_name#6933,cp_mfgr#6934,cp_type#6935,cp_size#6936,cp_container#6937,cp_retailprice#6938,cp_comment#6939,cp_brand#6940] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#6958 AS rid_0#6975, cval_part_p_name#6959 AS cval_part_p_name_0#6976, cval_part_p_mfgr#6960 AS cval_part_p_mfgr_0#6977, cval_part_p_type#6961 AS cval_part_p_type_0#6978, cval_part_p_size#6962 AS cval_part_p_size_0#6979, cval_part_p_container#6963 AS cval_part_p_container_0#6980, cval_part_p_retailprice#6964 AS cval_part_p_retailprice_0#6981, cval_part_p_comment#6965 AS cval_part_p_comment_0#6982, cval_part_p_brand#6966 AS cval_part_p_brand_0#6983, cp_name#6967 AS cp_name_0#6984, cp_mfgr#6968 AS cp_mfgr_0#6985, cp_type#6969 AS cp_type_0#6986, cp_size#6970 AS cp_size_0#6987, cp_container#6971 AS cp_container_0#6988, cp_retailprice#6972 AS cp_retailprice_0#6989, cp_comment#6973 AS cp_comment_0#6990, cp_brand#6974 AS cp_brand_0#6991]
         :  :        +- Relation[rid#6958,cval_part_p_name#6959,cval_part_p_mfgr#6960,cval_part_p_type#6961,cval_part_p_size#6962,cval_part_p_container#6963,cval_part_p_retailprice#6964,cval_part_p_comment#6965,cval_part_p_brand#6966,cp_name#6967,cp_mfgr#6968,cp_type#6969,cp_size#6970,cp_container#6971,cp_retailprice#6972,cp_comment#6973,cp_brand#6974] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#7048 AS rid_1#7059, cpfk_part_partsupp#7049 AS cpfk_part_partsupp_1#7060, cfpk_partsupp_part#7050 AS cfpk_partsupp_part_1#7061, cpfk_supplier_partsupp#7051 AS cpfk_supplier_partsupp_1#7062, cfpk_partsupp_supplier#7052 AS cfpk_partsupp_supplier_1#7063, cval_partsupp_ps_availqty#7053 AS cval_partsupp_ps_availqty_1#7064, cval_partsupp_ps_supplycost#7054 AS cval_partsupp_ps_supplycost_1#7065, cval_partsupp_ps_comment#7055 AS cval_partsupp_ps_comment_1#7066, cps_availqty#7056 AS cps_availqty_1#7067, cps_supplycost#7057 AS cps_supplycost_1#7068, cps_comment#7058 AS cps_comment_1#7069]
         :     +- Relation[rid#7048,cpfk_part_partsupp#7049,cfpk_partsupp_part#7050,cpfk_supplier_partsupp#7051,cfpk_partsupp_supplier#7052,cval_partsupp_ps_availqty#7053,cval_partsupp_ps_supplycost#7054,cval_partsupp_ps_comment#7055,cps_availqty#7056,cps_supplycost#7057,cps_comment#7058] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#6992 AS rid_1#7003, cpfk_part_partsupp#6993 AS cpfk_part_partsupp_1#7004, cfpk_partsupp_part#6994 AS cfpk_partsupp_part_1#7005, cpfk_supplier_partsupp#6995 AS cpfk_supplier_partsupp_1#7006, cfpk_partsupp_supplier#6996 AS cfpk_partsupp_supplier_1#7007, cval_partsupp_ps_availqty#6997 AS cval_partsupp_ps_availqty_1#7008, cval_partsupp_ps_supplycost#6998 AS cval_partsupp_ps_supplycost_1#7009, cval_partsupp_ps_comment#6999 AS cval_partsupp_ps_comment_1#7010, cps_availqty#7000 AS cps_availqty_1#7011, cps_supplycost#7001 AS cps_supplycost_1#7012, cps_comment#7002 AS cps_comment_1#7013]
            +- Relation[rid#6992,cpfk_part_partsupp#6993,cfpk_partsupp_part#6994,cpfk_supplier_partsupp#6995,cfpk_partsupp_supplier#6996,cval_partsupp_ps_availqty#6997,cval_partsupp_ps_supplycost#6998,cval_partsupp_ps_comment#6999,cps_availqty#7000,cps_supplycost#7001,cps_comment#7002] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=7890
Elapsed time: 499ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/15 17:05:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:05:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7102L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 17:05:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7102L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#7104 AS rid_0#7137, cpfk_orders_lineitem#7105 AS cpfk_orders_lineitem_0#7138, cpfk_supplier_lineitem#7106 AS cpfk_supplier_lineitem_0#7139, cfpk_lineitem_supplier#7107 AS cfpk_lineitem_supplier_0#7140, cfpk_lineitem_partsupp#7108 AS cfpk_lineitem_partsupp_0#7141, cpfk_part_lineitem#7109 AS cpfk_part_lineitem_0#7142, cfpk_lineitem_part#7110 AS cfpk_lineitem_part_0#7143, cpfk_partsupp_lineitem#7111 AS cpfk_partsupp_lineitem_0#7144, cfpk_lineitem_orders#7112 AS cfpk_lineitem_orders_0#7145, cval_lineitem_l_quantity#7113 AS cval_lineitem_l_quantity_0#7146, cval_lineitem_l_extendedprice#7114 AS cval_lineitem_l_extendedprice_0#7147, cval_lineitem_l_discount#7115 AS cval_lineitem_l_discount_0#7148, cval_lineitem_l_tax#7116 AS cval_lineitem_l_tax_0#7149, cval_lineitem_l_returnflag#7117 AS cval_lineitem_l_returnflag_0#7150, cval_lineitem_l_linestatus#7118 AS cval_lineitem_l_linestatus_0#7151, cval_lineitem_l_commitdate#7119 AS cval_lineitem_l_commitdate_0#7152, cval_lineitem_l_receiptdate#7120 AS cval_lineitem_l_receiptdate_0#7153, cval_lineitem_l_shipinstruct#7121 AS cval_lineitem_l_shipinstruct_0#7154, cval_lineitem_l_shipmode#7122 AS cval_lineitem_l_shipmode_0#7155, cval_lineitem_l_comment#7123 AS cval_lineitem_l_comment_0#7156, cval_lineitem_l_shipdate#7124 AS cval_lineitem_l_shipdate_0#7157, cl_quantity#7125 AS cl_quantity_0#7158, cl_extendedprice#7126 AS cl_extendedprice_0#7159, cl_discount#7127 AS cl_discount_0#7160, ... 9 more fields]
            :  :  +- Relation[rid#7104,cpfk_orders_lineitem#7105,cpfk_supplier_lineitem#7106,cfpk_lineitem_supplier#7107,cfpk_lineitem_partsupp#7108,cpfk_part_lineitem#7109,cfpk_lineitem_part#7110,cpfk_partsupp_lineitem#7111,cfpk_lineitem_orders#7112,cval_lineitem_l_quantity#7113,cval_lineitem_l_extendedprice#7114,cval_lineitem_l_discount#7115,cval_lineitem_l_tax#7116,cval_lineitem_l_returnflag#7117,cval_lineitem_l_linestatus#7118,cval_lineitem_l_commitdate#7119,cval_lineitem_l_receiptdate#7120,cval_lineitem_l_shipinstruct#7121,cval_lineitem_l_shipmode#7122,cval_lineitem_l_comment#7123,cval_lineitem_l_shipdate#7124,cl_quantity#7125,cl_extendedprice#7126,cl_discount#7127,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#7170 AS rid_0#7203, cpfk_orders_lineitem#7171 AS cpfk_orders_lineitem_0#7204, cpfk_supplier_lineitem#7172 AS cpfk_supplier_lineitem_0#7205, cfpk_lineitem_supplier#7173 AS cfpk_lineitem_supplier_0#7206, cfpk_lineitem_partsupp#7174 AS cfpk_lineitem_partsupp_0#7207, cpfk_part_lineitem#7175 AS cpfk_part_lineitem_0#7208, cfpk_lineitem_part#7176 AS cfpk_lineitem_part_0#7209, cpfk_partsupp_lineitem#7177 AS cpfk_partsupp_lineitem_0#7210, cfpk_lineitem_orders#7178 AS cfpk_lineitem_orders_0#7211, cval_lineitem_l_quantity#7179 AS cval_lineitem_l_quantity_0#7212, cval_lineitem_l_extendedprice#7180 AS cval_lineitem_l_extendedprice_0#7213, cval_lineitem_l_discount#7181 AS cval_lineitem_l_discount_0#7214, cval_lineitem_l_tax#7182 AS cval_lineitem_l_tax_0#7215, cval_lineitem_l_returnflag#7183 AS cval_lineitem_l_returnflag_0#7216, cval_lineitem_l_linestatus#7184 AS cval_lineitem_l_linestatus_0#7217, cval_lineitem_l_commitdate#7185 AS cval_lineitem_l_commitdate_0#7218, cval_lineitem_l_receiptdate#7186 AS cval_lineitem_l_receiptdate_0#7219, cval_lineitem_l_shipinstruct#7187 AS cval_lineitem_l_shipinstruct_0#7220, cval_lineitem_l_shipmode#7188 AS cval_lineitem_l_shipmode_0#7221, cval_lineitem_l_comment#7189 AS cval_lineitem_l_comment_0#7222, cval_lineitem_l_shipdate#7190 AS cval_lineitem_l_shipdate_0#7223, cl_quantity#7191 AS cl_quantity_0#7224, cl_extendedprice#7192 AS cl_extendedprice_0#7225, cl_discount#7193 AS cl_discount_0#7226, ... 9 more fields]
            :        +- Relation[rid#7170,cpfk_orders_lineitem#7171,cpfk_supplier_lineitem#7172,cfpk_lineitem_supplier#7173,cfpk_lineitem_partsupp#7174,cpfk_part_lineitem#7175,cfpk_lineitem_part#7176,cpfk_partsupp_lineitem#7177,cfpk_lineitem_orders#7178,cval_lineitem_l_quantity#7179,cval_lineitem_l_extendedprice#7180,cval_lineitem_l_discount#7181,cval_lineitem_l_tax#7182,cval_lineitem_l_returnflag#7183,cval_lineitem_l_linestatus#7184,cval_lineitem_l_commitdate#7185,cval_lineitem_l_receiptdate#7186,cval_lineitem_l_shipinstruct#7187,cval_lineitem_l_shipmode#7188,cval_lineitem_l_comment#7189,cval_lineitem_l_shipdate#7190,cl_quantity#7191,cl_extendedprice#7192,cl_discount#7193,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#7236 AS rid_1#7253, cpfk_customer_orders#7237 AS cpfk_customer_orders_1#7254, cfpk_orders_customer#7238 AS cfpk_orders_customer_1#7255, cval_orders_o_orderstatus#7239 AS cval_orders_o_orderstatus_1#7256, cval_orders_o_totalprice#7240 AS cval_orders_o_totalprice_1#7257, cval_orders_o_orderpriority#7241 AS cval_orders_o_orderpriority_1#7258, cval_orders_o_clerk#7242 AS cval_orders_o_clerk_1#7259, cval_orders_o_shippriority#7243 AS cval_orders_o_shippriority_1#7260, cval_orders_o_comment#7244 AS cval_orders_o_comment_1#7261, cval_orders_o_orderdate#7245 AS cval_orders_o_orderdate_1#7262, co_orderstatus#7246 AS co_orderstatus_1#7263, co_totalprice#7247 AS co_totalprice_1#7264, co_orderpriority#7248 AS co_orderpriority_1#7265, co_clerk#7249 AS co_clerk_1#7266, co_shippriority#7250 AS co_shippriority_1#7267, co_comment#7251 AS co_comment_1#7268, co_orderdate#7252 AS co_orderdate_1#7269]
               +- Relation[rid#7236,cpfk_customer_orders#7237,cfpk_orders_customer#7238,cval_orders_o_orderstatus#7239,cval_orders_o_totalprice#7240,cval_orders_o_orderpriority#7241,cval_orders_o_clerk#7242,cval_orders_o_shippriority#7243,cval_orders_o_comment#7244,cval_orders_o_orderdate#7245,co_orderstatus#7246,co_totalprice#7247,co_orderpriority#7248,co_clerk#7249,co_shippriority#7250,co_comment#7251,co_orderdate#7252] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 21831ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/15 17:06:11 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:06:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7325L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 17:06:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7325L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#7327 AS rid_0#7344, cpfk_customer_orders#7328 AS cpfk_customer_orders_0#7345, cfpk_orders_customer#7329 AS cfpk_orders_customer_0#7346, cval_orders_o_orderstatus#7330 AS cval_orders_o_orderstatus_0#7347, cval_orders_o_totalprice#7331 AS cval_orders_o_totalprice_0#7348, cval_orders_o_orderpriority#7332 AS cval_orders_o_orderpriority_0#7349, cval_orders_o_clerk#7333 AS cval_orders_o_clerk_0#7350, cval_orders_o_shippriority#7334 AS cval_orders_o_shippriority_0#7351, cval_orders_o_comment#7335 AS cval_orders_o_comment_0#7352, cval_orders_o_orderdate#7336 AS cval_orders_o_orderdate_0#7353, co_orderstatus#7337 AS co_orderstatus_0#7354, co_totalprice#7338 AS co_totalprice_0#7355, co_orderpriority#7339 AS co_orderpriority_0#7356, co_clerk#7340 AS co_clerk_0#7357, co_shippriority#7341 AS co_shippriority_0#7358, co_comment#7342 AS co_comment_0#7359, co_orderdate#7343 AS co_orderdate_0#7360]
            :  +- Relation[rid#7327,cpfk_customer_orders#7328,cfpk_orders_customer#7329,cval_orders_o_orderstatus#7330,cval_orders_o_totalprice#7331,cval_orders_o_orderpriority#7332,cval_orders_o_clerk#7333,cval_orders_o_shippriority#7334,cval_orders_o_comment#7335,cval_orders_o_orderdate#7336,co_orderstatus#7337,co_totalprice#7338,co_orderpriority#7339,co_clerk#7340,co_shippriority#7341,co_comment#7342,co_orderdate#7343] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#7361 AS rid_1#7376, cpfk_nation_customer#7362 AS cpfk_nation_customer_1#7377, cfpk_customer_nation#7363 AS cfpk_customer_nation_1#7378, cval_customer_c_name#7364 AS cval_customer_c_name_1#7379, cval_customer_c_address#7365 AS cval_customer_c_address_1#7380, cval_customer_c_phone#7366 AS cval_customer_c_phone_1#7381, cval_customer_c_acctbal#7367 AS cval_customer_c_acctbal_1#7382, cval_customer_c_comment#7368 AS cval_customer_c_comment_1#7383, cval_customer_c_mktsegment#7369 AS cval_customer_c_mktsegment_1#7384, cc_name#7370 AS cc_name_1#7385, cc_address#7371 AS cc_address_1#7386, cc_phone#7372 AS cc_phone_1#7387, cc_acctbal#7373 AS cc_acctbal_1#7388, cc_comment#7374 AS cc_comment_1#7389, cc_mktsegment#7375 AS cc_mktsegment_1#7390]
               +- Relation[rid#7361,cpfk_nation_customer#7362,cfpk_customer_nation#7363,cval_customer_c_name#7364,cval_customer_c_address#7365,cval_customer_c_phone#7366,cval_customer_c_acctbal#7367,cval_customer_c_comment#7368,cval_customer_c_mktsegment#7369,cc_name#7370,cc_address#7371,cc_phone#7372,cc_acctbal#7373,cc_comment#7374,cc_mktsegment#7375] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13618ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/15 17:06:25 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:06:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7427L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 17:06:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7427L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#7429 AS rid_0#7446, cpfk_customer_orders#7430 AS cpfk_customer_orders_0#7447, cfpk_orders_customer#7431 AS cfpk_orders_customer_0#7448, cval_orders_o_orderstatus#7432 AS cval_orders_o_orderstatus_0#7449, cval_orders_o_totalprice#7433 AS cval_orders_o_totalprice_0#7450, cval_orders_o_orderpriority#7434 AS cval_orders_o_orderpriority_0#7451, cval_orders_o_clerk#7435 AS cval_orders_o_clerk_0#7452, cval_orders_o_shippriority#7436 AS cval_orders_o_shippriority_0#7453, cval_orders_o_comment#7437 AS cval_orders_o_comment_0#7454, cval_orders_o_orderdate#7438 AS cval_orders_o_orderdate_0#7455, co_orderstatus#7439 AS co_orderstatus_0#7456, co_totalprice#7440 AS co_totalprice_0#7457, co_orderpriority#7441 AS co_orderpriority_0#7458, co_clerk#7442 AS co_clerk_0#7459, co_shippriority#7443 AS co_shippriority_0#7460, co_comment#7444 AS co_comment_0#7461, co_orderdate#7445 AS co_orderdate_0#7462]
            :  +- Relation[rid#7429,cpfk_customer_orders#7430,cfpk_orders_customer#7431,cval_orders_o_orderstatus#7432,cval_orders_o_totalprice#7433,cval_orders_o_orderpriority#7434,cval_orders_o_clerk#7435,cval_orders_o_shippriority#7436,cval_orders_o_comment#7437,cval_orders_o_orderdate#7438,co_orderstatus#7439,co_totalprice#7440,co_orderpriority#7441,co_clerk#7442,co_shippriority#7443,co_comment#7444,co_orderdate#7445] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#7463 AS rid_1#7478, cpfk_nation_customer#7464 AS cpfk_nation_customer_1#7479, cfpk_customer_nation#7465 AS cfpk_customer_nation_1#7480, cval_customer_c_name#7466 AS cval_customer_c_name_1#7481, cval_customer_c_address#7467 AS cval_customer_c_address_1#7482, cval_customer_c_phone#7468 AS cval_customer_c_phone_1#7483, cval_customer_c_acctbal#7469 AS cval_customer_c_acctbal_1#7484, cval_customer_c_comment#7470 AS cval_customer_c_comment_1#7485, cval_customer_c_mktsegment#7471 AS cval_customer_c_mktsegment_1#7486, cc_name#7472 AS cc_name_1#7487, cc_address#7473 AS cc_address_1#7488, cc_phone#7474 AS cc_phone_1#7489, cc_acctbal#7475 AS cc_acctbal_1#7490, cc_comment#7476 AS cc_comment_1#7491, cc_mktsegment#7477 AS cc_mktsegment_1#7492]
               +- Relation[rid#7463,cpfk_nation_customer#7464,cfpk_customer_nation#7465,cval_customer_c_name#7466,cval_customer_c_address#7467,cval_customer_c_phone#7468,cval_customer_c_acctbal#7469,cval_customer_c_comment#7470,cval_customer_c_mktsegment#7471,cc_name#7472,cc_address#7473,cc_phone#7474,cc_acctbal#7475,cc_comment#7476,cc_mktsegment#7477] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13209ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/15 17:06:38 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:06:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7532L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 17:06:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:06:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:06:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:06:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:06:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:06:38 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:06:38 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:06:38 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:06:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:06:38 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:06:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:06:38 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:06:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:06:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:06:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:06:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7532L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#7534 AS rid_0#7551, cval_part_p_name#7535 AS cval_part_p_name_0#7552, cval_part_p_mfgr#7536 AS cval_part_p_mfgr_0#7553, cval_part_p_type#7537 AS cval_part_p_type_0#7554, cval_part_p_size#7538 AS cval_part_p_size_0#7555, cval_part_p_container#7539 AS cval_part_p_container_0#7556, cval_part_p_retailprice#7540 AS cval_part_p_retailprice_0#7557, cval_part_p_comment#7541 AS cval_part_p_comment_0#7558, cval_part_p_brand#7542 AS cval_part_p_brand_0#7559, cp_name#7543 AS cp_name_0#7560, cp_mfgr#7544 AS cp_mfgr_0#7561, cp_type#7545 AS cp_type_0#7562, cp_size#7546 AS cp_size_0#7563, cp_container#7547 AS cp_container_0#7564, cp_retailprice#7548 AS cp_retailprice_0#7565, cp_comment#7549 AS cp_comment_0#7566, cp_brand#7550 AS cp_brand_0#7567]
            :     :     :  :  :  :  +- Relation[rid#7534,cval_part_p_name#7535,cval_part_p_mfgr#7536,cval_part_p_type#7537,cval_part_p_size#7538,cval_part_p_container#7539,cval_part_p_retailprice#7540,cval_part_p_comment#7541,cval_part_p_brand#7542,cp_name#7543,cp_mfgr#7544,cp_type#7545,cp_size#7546,cp_container#7547,cp_retailprice#7548,cp_comment#7549,cp_brand#7550] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#7568 AS rid_0#7585, cval_part_p_name#7569 AS cval_part_p_name_0#7586, cval_part_p_mfgr#7570 AS cval_part_p_mfgr_0#7587, cval_part_p_type#7571 AS cval_part_p_type_0#7588, cval_part_p_size#7572 AS cval_part_p_size_0#7589, cval_part_p_container#7573 AS cval_part_p_container_0#7590, cval_part_p_retailprice#7574 AS cval_part_p_retailprice_0#7591, cval_part_p_comment#7575 AS cval_part_p_comment_0#7592, cval_part_p_brand#7576 AS cval_part_p_brand_0#7593, cp_name#7577 AS cp_name_0#7594, cp_mfgr#7578 AS cp_mfgr_0#7595, cp_type#7579 AS cp_type_0#7596, cp_size#7580 AS cp_size_0#7597, cp_container#7581 AS cp_container_0#7598, cp_retailprice#7582 AS cp_retailprice_0#7599, cp_comment#7583 AS cp_comment_0#7600, cp_brand#7584 AS cp_brand_0#7601]
            :     :     :  :  :        +- Relation[rid#7568,cval_part_p_name#7569,cval_part_p_mfgr#7570,cval_part_p_type#7571,cval_part_p_size#7572,cval_part_p_container#7573,cval_part_p_retailprice#7574,cval_part_p_comment#7575,cval_part_p_brand#7576,cp_name#7577,cp_mfgr#7578,cp_type#7579,cp_size#7580,cp_container#7581,cp_retailprice#7582,cp_comment#7583,cp_brand#7584] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- Project [rid#7702 AS rid_1#7735, cpfk_orders_lineitem#7703 AS cpfk_orders_lineitem_1#7736, cpfk_supplier_lineitem#7704 AS cpfk_supplier_lineitem_1#7737, cfpk_lineitem_supplier#7705 AS cfpk_lineitem_supplier_1#7738, cfpk_lineitem_partsupp#7706 AS cfpk_lineitem_partsupp_1#7739, cpfk_part_lineitem#7707 AS cpfk_part_lineitem_1#7740, cfpk_lineitem_part#7708 AS cfpk_lineitem_part_1#7741, cpfk_partsupp_lineitem#7709 AS cpfk_partsupp_lineitem_1#7742, cfpk_lineitem_orders#7710 AS cfpk_lineitem_orders_1#7743, cval_lineitem_l_quantity#7711 AS cval_lineitem_l_quantity_1#7744, cval_lineitem_l_extendedprice#7712 AS cval_lineitem_l_extendedprice_1#7745, cval_lineitem_l_discount#7713 AS cval_lineitem_l_discount_1#7746, cval_lineitem_l_tax#7714 AS cval_lineitem_l_tax_1#7747, cval_lineitem_l_returnflag#7715 AS cval_lineitem_l_returnflag_1#7748, cval_lineitem_l_linestatus#7716 AS cval_lineitem_l_linestatus_1#7749, cval_lineitem_l_commitdate#7717 AS cval_lineitem_l_commitdate_1#7750, cval_lineitem_l_receiptdate#7718 AS cval_lineitem_l_receiptdate_1#7751, cval_lineitem_l_shipinstruct#7719 AS cval_lineitem_l_shipinstruct_1#7752, cval_lineitem_l_shipmode#7720 AS cval_lineitem_l_shipmode_1#7753, cval_lineitem_l_comment#7721 AS cval_lineitem_l_comment_1#7754, cval_lineitem_l_shipdate#7722 AS cval_lineitem_l_shipdate_1#7755, cl_quantity#7723 AS cl_quantity_1#7756, cl_extendedprice#7724 AS cl_extendedprice_1#7757, cl_discount#7725 AS cl_discount_1#7758, ... 9 more fields]
            :     :     :  :     +- Relation[rid#7702,cpfk_orders_lineitem#7703,cpfk_supplier_lineitem#7704,cfpk_lineitem_supplier#7705,cfpk_lineitem_partsupp#7706,cpfk_part_lineitem#7707,cfpk_lineitem_part#7708,cpfk_partsupp_lineitem#7709,cfpk_lineitem_orders#7710,cval_lineitem_l_quantity#7711,cval_lineitem_l_extendedprice#7712,cval_lineitem_l_discount#7713,cval_lineitem_l_tax#7714,cval_lineitem_l_returnflag#7715,cval_lineitem_l_linestatus#7716,cval_lineitem_l_commitdate#7717,cval_lineitem_l_receiptdate#7718,cval_lineitem_l_shipinstruct#7719,cval_lineitem_l_shipmode#7720,cval_lineitem_l_comment#7721,cval_lineitem_l_shipdate#7722,cl_quantity#7723,cl_extendedprice#7724,cl_discount#7725,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#7602 AS rid_1#7635, cpfk_orders_lineitem#7603 AS cpfk_orders_lineitem_1#7636, cpfk_supplier_lineitem#7604 AS cpfk_supplier_lineitem_1#7637, cfpk_lineitem_supplier#7605 AS cfpk_lineitem_supplier_1#7638, cfpk_lineitem_partsupp#7606 AS cfpk_lineitem_partsupp_1#7639, cpfk_part_lineitem#7607 AS cpfk_part_lineitem_1#7640, cfpk_lineitem_part#7608 AS cfpk_lineitem_part_1#7641, cpfk_partsupp_lineitem#7609 AS cpfk_partsupp_lineitem_1#7642, cfpk_lineitem_orders#7610 AS cfpk_lineitem_orders_1#7643, cval_lineitem_l_quantity#7611 AS cval_lineitem_l_quantity_1#7644, cval_lineitem_l_extendedprice#7612 AS cval_lineitem_l_extendedprice_1#7645, cval_lineitem_l_discount#7613 AS cval_lineitem_l_discount_1#7646, cval_lineitem_l_tax#7614 AS cval_lineitem_l_tax_1#7647, cval_lineitem_l_returnflag#7615 AS cval_lineitem_l_returnflag_1#7648, cval_lineitem_l_linestatus#7616 AS cval_lineitem_l_linestatus_1#7649, cval_lineitem_l_commitdate#7617 AS cval_lineitem_l_commitdate_1#7650, cval_lineitem_l_receiptdate#7618 AS cval_lineitem_l_receiptdate_1#7651, cval_lineitem_l_shipinstruct#7619 AS cval_lineitem_l_shipinstruct_1#7652, cval_lineitem_l_shipmode#7620 AS cval_lineitem_l_shipmode_1#7653, cval_lineitem_l_comment#7621 AS cval_lineitem_l_comment_1#7654, cval_lineitem_l_shipdate#7622 AS cval_lineitem_l_shipdate_1#7655, cl_quantity#7623 AS cl_quantity_1#7656, cl_extendedprice#7624 AS cl_extendedprice_1#7657, cl_discount#7625 AS cl_discount_1#7658, ... 9 more fields]
            :     :     :     +- Relation[rid#7602,cpfk_orders_lineitem#7603,cpfk_supplier_lineitem#7604,cfpk_lineitem_supplier#7605,cfpk_lineitem_partsupp#7606,cpfk_part_lineitem#7607,cfpk_lineitem_part#7608,cpfk_partsupp_lineitem#7609,cfpk_lineitem_orders#7610,cval_lineitem_l_quantity#7611,cval_lineitem_l_extendedprice#7612,cval_lineitem_l_discount#7613,cval_lineitem_l_tax#7614,cval_lineitem_l_returnflag#7615,cval_lineitem_l_linestatus#7616,cval_lineitem_l_commitdate#7617,cval_lineitem_l_receiptdate#7618,cval_lineitem_l_shipinstruct#7619,cval_lineitem_l_shipmode#7620,cval_lineitem_l_comment#7621,cval_lineitem_l_shipdate#7622,cl_quantity#7623,cl_extendedprice#7624,cl_discount#7625,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#7768 AS rid_2#7781, cpfk_nation_supplier#7769 AS cpfk_nation_supplier_2#7782, cfpk_supplier_nation#7770 AS cfpk_supplier_nation_2#7783, cval_supplier_s_name#7771 AS cval_supplier_s_name_2#7784, cval_supplier_s_address#7772 AS cval_supplier_s_address_2#7785, cval_supplier_s_phone#7773 AS cval_supplier_s_phone_2#7786, cval_supplier_s_acctbal#7774 AS cval_supplier_s_acctbal_2#7787, cval_supplier_s_comment#7775 AS cval_supplier_s_comment_2#7788, cs_name#7776 AS cs_name_2#7789, cs_address#7777 AS cs_address_2#7790, cs_phone#7778 AS cs_phone_2#7791, cs_acctbal#7779 AS cs_acctbal_2#7792, cs_comment#7780 AS cs_comment_2#7793]
            :     :        +- Relation[rid#7768,cpfk_nation_supplier#7769,cfpk_supplier_nation#7770,cval_supplier_s_name#7771,cval_supplier_s_address#7772,cval_supplier_s_phone#7773,cval_supplier_s_acctbal#7774,cval_supplier_s_comment#7775,cs_name#7776,cs_address#7777,cs_phone#7778,cs_acctbal#7779,cs_comment#7780] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#7794 AS rid_3#7801, cpfk_region_nation#7795 AS cpfk_region_nation_3#7802, cfpk_nation_region#7796 AS cfpk_nation_region_3#7803, cval_nation_n_name#7797 AS cval_nation_n_name_3#7804, cval_nation_n_comment#7798 AS cval_nation_n_comment_3#7805, cn_name#7799 AS cn_name_3#7806, cn_comment#7800 AS cn_comment_3#7807]
            :        +- Relation[rid#7794,cpfk_region_nation#7795,cfpk_nation_region#7796,cval_nation_n_name#7797,cval_nation_n_comment#7798,cn_name#7799,cn_comment#7800] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#7808 AS rid_4#7813, cval_region_r_name#7809 AS cval_region_r_name_4#7814, cval_region_r_comment#7810 AS cval_region_r_comment_4#7815, cr_name#7811 AS cr_name_4#7816, cr_comment#7812 AS cr_comment_4#7817]
               :  :  :  :  :  :  :  +- Relation[rid#7808,cval_region_r_name#7809,cval_region_r_comment#7810,cr_name#7811,cr_comment#7812] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#7818 AS rid_4#7823, cval_region_r_name#7819 AS cval_region_r_name_4#7824, cval_region_r_comment#7820 AS cval_region_r_comment_4#7825, cr_name#7821 AS cr_name_4#7826, cr_comment#7822 AS cr_comment_4#7827]
               :  :  :  :  :  :        +- Relation[rid#7818,cval_region_r_name#7819,cval_region_r_comment#7820,cr_name#7821,cr_comment#7822] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- Project [rid#7852 AS rid_5#7859, cpfk_region_nation#7853 AS cpfk_region_nation_5#7860, cfpk_nation_region#7854 AS cfpk_nation_region_5#7861, cval_nation_n_name#7855 AS cval_nation_n_name_5#7862, cval_nation_n_comment#7856 AS cval_nation_n_comment_5#7863, cn_name#7857 AS cn_name_5#7864, cn_comment#7858 AS cn_comment_5#7865]
               :  :  :  :  :     +- Relation[rid#7852,cpfk_region_nation#7853,cfpk_nation_region#7854,cval_nation_n_name#7855,cval_nation_n_comment#7856,cn_name#7857,cn_comment#7858] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#7828 AS rid_5#7835, cpfk_region_nation#7829 AS cpfk_region_nation_5#7836, cfpk_nation_region#7830 AS cfpk_nation_region_5#7837, cval_nation_n_name#7831 AS cval_nation_n_name_5#7838, cval_nation_n_comment#7832 AS cval_nation_n_comment_5#7839, cn_name#7833 AS cn_name_5#7840, cn_comment#7834 AS cn_comment_5#7841]
               :  :  :  :     +- Relation[rid#7828,cpfk_region_nation#7829,cfpk_nation_region#7830,cval_nation_n_name#7831,cval_nation_n_comment#7832,cn_name#7833,cn_comment#7834] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#7910 AS rid_6#7925, cpfk_nation_customer#7911 AS cpfk_nation_customer_6#7926, cfpk_customer_nation#7912 AS cfpk_customer_nation_6#7927, cval_customer_c_name#7913 AS cval_customer_c_name_6#7928, cval_customer_c_address#7914 AS cval_customer_c_address_6#7929, cval_customer_c_phone#7915 AS cval_customer_c_phone_6#7930, cval_customer_c_acctbal#7916 AS cval_customer_c_acctbal_6#7931, cval_customer_c_comment#7917 AS cval_customer_c_comment_6#7932, cval_customer_c_mktsegment#7918 AS cval_customer_c_mktsegment_6#7933, cc_name#7919 AS cc_name_6#7934, cc_address#7920 AS cc_address_6#7935, cc_phone#7921 AS cc_phone_6#7936, cc_acctbal#7922 AS cc_acctbal_6#7937, cc_comment#7923 AS cc_comment_6#7938, cc_mktsegment#7924 AS cc_mktsegment_6#7939]
               :  :  :     +- Relation[rid#7910,cpfk_nation_customer#7911,cfpk_customer_nation#7912,cval_customer_c_name#7913,cval_customer_c_address#7914,cval_customer_c_phone#7915,cval_customer_c_acctbal#7916,cval_customer_c_comment#7917,cval_customer_c_mktsegment#7918,cc_name#7919,cc_address#7920,cc_phone#7921,cc_acctbal#7922,cc_comment#7923,cc_mktsegment#7924] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#7866 AS rid_6#7881, cpfk_nation_customer#7867 AS cpfk_nation_customer_6#7882, cfpk_customer_nation#7868 AS cfpk_customer_nation_6#7883, cval_customer_c_name#7869 AS cval_customer_c_name_6#7884, cval_customer_c_address#7870 AS cval_customer_c_address_6#7885, cval_customer_c_phone#7871 AS cval_customer_c_phone_6#7886, cval_customer_c_acctbal#7872 AS cval_customer_c_acctbal_6#7887, cval_customer_c_comment#7873 AS cval_customer_c_comment_6#7888, cval_customer_c_mktsegment#7874 AS cval_customer_c_mktsegment_6#7889, cc_name#7875 AS cc_name_6#7890, cc_address#7876 AS cc_address_6#7891, cc_phone#7877 AS cc_phone_6#7892, cc_acctbal#7878 AS cc_acctbal_6#7893, cc_comment#7879 AS cc_comment_6#7894, cc_mktsegment#7880 AS cc_mktsegment_6#7895]
               :  :     +- Relation[rid#7866,cpfk_nation_customer#7867,cfpk_customer_nation#7868,cval_customer_c_name#7869,cval_customer_c_address#7870,cval_customer_c_phone#7871,cval_customer_c_acctbal#7872,cval_customer_c_comment#7873,cval_customer_c_mktsegment#7874,cc_name#7875,cc_address#7876,cc_phone#7877,cc_acctbal#7878,cc_comment#7879,cc_mktsegment#7880] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#8004 AS rid_7#8021, cpfk_customer_orders#8005 AS cpfk_customer_orders_7#8022, cfpk_orders_customer#8006 AS cfpk_orders_customer_7#8023, cval_orders_o_orderstatus#8007 AS cval_orders_o_orderstatus_7#8024, cval_orders_o_totalprice#8008 AS cval_orders_o_totalprice_7#8025, cval_orders_o_orderpriority#8009 AS cval_orders_o_orderpriority_7#8026, cval_orders_o_clerk#8010 AS cval_orders_o_clerk_7#8027, cval_orders_o_shippriority#8011 AS cval_orders_o_shippriority_7#8028, cval_orders_o_comment#8012 AS cval_orders_o_comment_7#8029, cval_orders_o_orderdate#8013 AS cval_orders_o_orderdate_7#8030, co_orderstatus#8014 AS co_orderstatus_7#8031, co_totalprice#8015 AS co_totalprice_7#8032, co_orderpriority#8016 AS co_orderpriority_7#8033, co_clerk#8017 AS co_clerk_7#8034, co_shippriority#8018 AS co_shippriority_7#8035, co_comment#8019 AS co_comment_7#8036, co_orderdate#8020 AS co_orderdate_7#8037]
               :     +- Relation[rid#8004,cpfk_customer_orders#8005,cfpk_orders_customer#8006,cval_orders_o_orderstatus#8007,cval_orders_o_totalprice#8008,cval_orders_o_orderpriority#8009,cval_orders_o_clerk#8010,cval_orders_o_shippriority#8011,cval_orders_o_comment#8012,cval_orders_o_orderdate#8013,co_orderstatus#8014,co_totalprice#8015,co_orderpriority#8016,co_clerk#8017,co_shippriority#8018,co_comment#8019,co_orderdate#8020] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#7940 AS rid_7#7957, cpfk_customer_orders#7941 AS cpfk_customer_orders_7#7958, cfpk_orders_customer#7942 AS cfpk_orders_customer_7#7959, cval_orders_o_orderstatus#7943 AS cval_orders_o_orderstatus_7#7960, cval_orders_o_totalprice#7944 AS cval_orders_o_totalprice_7#7961, cval_orders_o_orderpriority#7945 AS cval_orders_o_orderpriority_7#7962, cval_orders_o_clerk#7946 AS cval_orders_o_clerk_7#7963, cval_orders_o_shippriority#7947 AS cval_orders_o_shippriority_7#7964, cval_orders_o_comment#7948 AS cval_orders_o_comment_7#7965, cval_orders_o_orderdate#7949 AS cval_orders_o_orderdate_7#7966, co_orderstatus#7950 AS co_orderstatus_7#7967, co_totalprice#7951 AS co_totalprice_7#7968, co_orderpriority#7952 AS co_orderpriority_7#7969, co_clerk#7953 AS co_clerk_7#7970, co_shippriority#7954 AS co_shippriority_7#7971, co_comment#7955 AS co_comment_7#7972, co_orderdate#7956 AS co_orderdate_7#7973]
                  +- Relation[rid#7940,cpfk_customer_orders#7941,cfpk_orders_customer#7942,cval_orders_o_orderstatus#7943,cval_orders_o_totalprice#7944,cval_orders_o_orderpriority#7945,cval_orders_o_clerk#7946,cval_orders_o_shippriority#7947,cval_orders_o_comment#7948,cval_orders_o_orderdate#7949,co_orderstatus#7950,co_totalprice#7951,co_orderpriority#7952,co_clerk#7953,co_shippriority#7954,co_comment#7955,co_orderdate#7956] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 1771ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/15 17:06:40 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:06:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8161L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:06:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8161L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#8163 AS rid_0#8178, cpfk_nation_customer#8164 AS cpfk_nation_customer_0#8179, cfpk_customer_nation#8165 AS cfpk_customer_nation_0#8180, cval_customer_c_name#8166 AS cval_customer_c_name_0#8181, cval_customer_c_address#8167 AS cval_customer_c_address_0#8182, cval_customer_c_phone#8168 AS cval_customer_c_phone_0#8183, cval_customer_c_acctbal#8169 AS cval_customer_c_acctbal_0#8184, cval_customer_c_comment#8170 AS cval_customer_c_comment_0#8185, cval_customer_c_mktsegment#8171 AS cval_customer_c_mktsegment_0#8186, cc_name#8172 AS cc_name_0#8187, cc_address#8173 AS cc_address_0#8188, cc_phone#8174 AS cc_phone_0#8189, cc_acctbal#8175 AS cc_acctbal_0#8190, cc_comment#8176 AS cc_comment_0#8191, cc_mktsegment#8177 AS cc_mktsegment_0#8192]
         :  :  :  :  +- Relation[rid#8163,cpfk_nation_customer#8164,cfpk_customer_nation#8165,cval_customer_c_name#8166,cval_customer_c_address#8167,cval_customer_c_phone#8168,cval_customer_c_acctbal#8169,cval_customer_c_comment#8170,cval_customer_c_mktsegment#8171,cc_name#8172,cc_address#8173,cc_phone#8174,cc_acctbal#8175,cc_comment#8176,cc_mktsegment#8177] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#8227 AS rid_0#8242, cpfk_nation_customer#8228 AS cpfk_nation_customer_0#8243, cfpk_customer_nation#8229 AS cfpk_customer_nation_0#8244, cval_customer_c_name#8230 AS cval_customer_c_name_0#8245, cval_customer_c_address#8231 AS cval_customer_c_address_0#8246, cval_customer_c_phone#8232 AS cval_customer_c_phone_0#8247, cval_customer_c_acctbal#8233 AS cval_customer_c_acctbal_0#8248, cval_customer_c_comment#8234 AS cval_customer_c_comment_0#8249, cval_customer_c_mktsegment#8235 AS cval_customer_c_mktsegment_0#8250, cc_name#8236 AS cc_name_0#8251, cc_address#8237 AS cc_address_0#8252, cc_phone#8238 AS cc_phone_0#8253, cc_acctbal#8239 AS cc_acctbal_0#8254, cc_comment#8240 AS cc_comment_0#8255, cc_mktsegment#8241 AS cc_mktsegment_0#8256]
         :  :  :     :  +- Relation[rid#8227,cpfk_nation_customer#8228,cfpk_customer_nation#8229,cval_customer_c_name#8230,cval_customer_c_address#8231,cval_customer_c_phone#8232,cval_customer_c_acctbal#8233,cval_customer_c_comment#8234,cval_customer_c_mktsegment#8235,cc_name#8236,cc_address#8237,cc_phone#8238,cc_acctbal#8239,cc_comment#8240,cc_mktsegment#8241] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#8257 AS rid_1#8274, cpfk_customer_orders#8258 AS cpfk_customer_orders_1#8275, cfpk_orders_customer#8259 AS cfpk_orders_customer_1#8276, cval_orders_o_orderstatus#8260 AS cval_orders_o_orderstatus_1#8277, cval_orders_o_totalprice#8261 AS cval_orders_o_totalprice_1#8278, cval_orders_o_orderpriority#8262 AS cval_orders_o_orderpriority_1#8279, cval_orders_o_clerk#8263 AS cval_orders_o_clerk_1#8280, cval_orders_o_shippriority#8264 AS cval_orders_o_shippriority_1#8281, cval_orders_o_comment#8265 AS cval_orders_o_comment_1#8282, cval_orders_o_orderdate#8266 AS cval_orders_o_orderdate_1#8283, co_orderstatus#8267 AS co_orderstatus_1#8284, co_totalprice#8268 AS co_totalprice_1#8285, co_orderpriority#8269 AS co_orderpriority_1#8286, co_clerk#8270 AS co_clerk_1#8287, co_shippriority#8271 AS co_shippriority_1#8288, co_comment#8272 AS co_comment_1#8289, co_orderdate#8273 AS co_orderdate_1#8290]
         :  :  :        +- Relation[rid#8257,cpfk_customer_orders#8258,cfpk_orders_customer#8259,cval_orders_o_orderstatus#8260,cval_orders_o_totalprice#8261,cval_orders_o_orderpriority#8262,cval_orders_o_clerk#8263,cval_orders_o_shippriority#8264,cval_orders_o_comment#8265,cval_orders_o_orderdate#8266,co_orderstatus#8267,co_totalprice#8268,co_orderpriority#8269,co_clerk#8270,co_shippriority#8271,co_comment#8272,co_orderdate#8273] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#8193 AS rid_1#8210, cpfk_customer_orders#8194 AS cpfk_customer_orders_1#8211, cfpk_orders_customer#8195 AS cfpk_orders_customer_1#8212, cval_orders_o_orderstatus#8196 AS cval_orders_o_orderstatus_1#8213, cval_orders_o_totalprice#8197 AS cval_orders_o_totalprice_1#8214, cval_orders_o_orderpriority#8198 AS cval_orders_o_orderpriority_1#8215, cval_orders_o_clerk#8199 AS cval_orders_o_clerk_1#8216, cval_orders_o_shippriority#8200 AS cval_orders_o_shippriority_1#8217, cval_orders_o_comment#8201 AS cval_orders_o_comment_1#8218, cval_orders_o_orderdate#8202 AS cval_orders_o_orderdate_1#8219, co_orderstatus#8203 AS co_orderstatus_1#8220, co_totalprice#8204 AS co_totalprice_1#8221, co_orderpriority#8205 AS co_orderpriority_1#8222, co_clerk#8206 AS co_clerk_1#8223, co_shippriority#8207 AS co_shippriority_1#8224, co_comment#8208 AS co_comment_1#8225, co_orderdate#8209 AS co_orderdate_1#8226]
         :  :     +- Relation[rid#8193,cpfk_customer_orders#8194,cfpk_orders_customer#8195,cval_orders_o_orderstatus#8196,cval_orders_o_totalprice#8197,cval_orders_o_orderpriority#8198,cval_orders_o_clerk#8199,cval_orders_o_shippriority#8200,cval_orders_o_comment#8201,cval_orders_o_orderdate#8202,co_orderstatus#8203,co_totalprice#8204,co_orderpriority#8205,co_clerk#8206,co_shippriority#8207,co_comment#8208,co_orderdate#8209] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#8357 AS rid_1#8374, cpfk_customer_orders#8358 AS cpfk_customer_orders_1#8375, cfpk_orders_customer#8359 AS cfpk_orders_customer_1#8376, cval_orders_o_orderstatus#8360 AS cval_orders_o_orderstatus_1#8377, cval_orders_o_totalprice#8361 AS cval_orders_o_totalprice_1#8378, cval_orders_o_orderpriority#8362 AS cval_orders_o_orderpriority_1#8379, cval_orders_o_clerk#8363 AS cval_orders_o_clerk_1#8380, cval_orders_o_shippriority#8364 AS cval_orders_o_shippriority_1#8381, cval_orders_o_comment#8365 AS cval_orders_o_comment_1#8382, cval_orders_o_orderdate#8366 AS cval_orders_o_orderdate_1#8383, co_orderstatus#8367 AS co_orderstatus_1#8384, co_totalprice#8368 AS co_totalprice_1#8385, co_orderpriority#8369 AS co_orderpriority_1#8386, co_clerk#8370 AS co_clerk_1#8387, co_shippriority#8371 AS co_shippriority_1#8388, co_comment#8372 AS co_comment_1#8389, co_orderdate#8373 AS co_orderdate_1#8390]
         :     :  +- Relation[rid#8357,cpfk_customer_orders#8358,cfpk_orders_customer#8359,cval_orders_o_orderstatus#8360,cval_orders_o_totalprice#8361,cval_orders_o_orderpriority#8362,cval_orders_o_clerk#8363,cval_orders_o_shippriority#8364,cval_orders_o_comment#8365,cval_orders_o_orderdate#8366,co_orderstatus#8367,co_totalprice#8368,co_orderpriority#8369,co_clerk#8370,co_shippriority#8371,co_comment#8372,co_orderdate#8373] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#8391 AS rid_2#8424, cpfk_orders_lineitem#8392 AS cpfk_orders_lineitem_2#8425, cpfk_supplier_lineitem#8393 AS cpfk_supplier_lineitem_2#8426, cfpk_lineitem_supplier#8394 AS cfpk_lineitem_supplier_2#8427, cfpk_lineitem_partsupp#8395 AS cfpk_lineitem_partsupp_2#8428, cpfk_part_lineitem#8396 AS cpfk_part_lineitem_2#8429, cfpk_lineitem_part#8397 AS cfpk_lineitem_part_2#8430, cpfk_partsupp_lineitem#8398 AS cpfk_partsupp_lineitem_2#8431, cfpk_lineitem_orders#8399 AS cfpk_lineitem_orders_2#8432, cval_lineitem_l_quantity#8400 AS cval_lineitem_l_quantity_2#8433, cval_lineitem_l_extendedprice#8401 AS cval_lineitem_l_extendedprice_2#8434, cval_lineitem_l_discount#8402 AS cval_lineitem_l_discount_2#8435, cval_lineitem_l_tax#8403 AS cval_lineitem_l_tax_2#8436, cval_lineitem_l_returnflag#8404 AS cval_lineitem_l_returnflag_2#8437, cval_lineitem_l_linestatus#8405 AS cval_lineitem_l_linestatus_2#8438, cval_lineitem_l_commitdate#8406 AS cval_lineitem_l_commitdate_2#8439, cval_lineitem_l_receiptdate#8407 AS cval_lineitem_l_receiptdate_2#8440, cval_lineitem_l_shipinstruct#8408 AS cval_lineitem_l_shipinstruct_2#8441, cval_lineitem_l_shipmode#8409 AS cval_lineitem_l_shipmode_2#8442, cval_lineitem_l_comment#8410 AS cval_lineitem_l_comment_2#8443, cval_lineitem_l_shipdate#8411 AS cval_lineitem_l_shipdate_2#8444, cl_quantity#8412 AS cl_quantity_2#8445, cl_extendedprice#8413 AS cl_extendedprice_2#8446, cl_discount#8414 AS cl_discount_2#8447, ... 9 more fields]
         :        +- Relation[rid#8391,cpfk_orders_lineitem#8392,cpfk_supplier_lineitem#8393,cfpk_lineitem_supplier#8394,cfpk_lineitem_partsupp#8395,cpfk_part_lineitem#8396,cfpk_lineitem_part#8397,cpfk_partsupp_lineitem#8398,cfpk_lineitem_orders#8399,cval_lineitem_l_quantity#8400,cval_lineitem_l_extendedprice#8401,cval_lineitem_l_discount#8402,cval_lineitem_l_tax#8403,cval_lineitem_l_returnflag#8404,cval_lineitem_l_linestatus#8405,cval_lineitem_l_commitdate#8406,cval_lineitem_l_receiptdate#8407,cval_lineitem_l_shipinstruct#8408,cval_lineitem_l_shipmode#8409,cval_lineitem_l_comment#8410,cval_lineitem_l_shipdate#8411,cl_quantity#8412,cl_extendedprice#8413,cl_discount#8414,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8291 AS rid_2#8324, cpfk_orders_lineitem#8292 AS cpfk_orders_lineitem_2#8325, cpfk_supplier_lineitem#8293 AS cpfk_supplier_lineitem_2#8326, cfpk_lineitem_supplier#8294 AS cfpk_lineitem_supplier_2#8327, cfpk_lineitem_partsupp#8295 AS cfpk_lineitem_partsupp_2#8328, cpfk_part_lineitem#8296 AS cpfk_part_lineitem_2#8329, cfpk_lineitem_part#8297 AS cfpk_lineitem_part_2#8330, cpfk_partsupp_lineitem#8298 AS cpfk_partsupp_lineitem_2#8331, cfpk_lineitem_orders#8299 AS cfpk_lineitem_orders_2#8332, cval_lineitem_l_quantity#8300 AS cval_lineitem_l_quantity_2#8333, cval_lineitem_l_extendedprice#8301 AS cval_lineitem_l_extendedprice_2#8334, cval_lineitem_l_discount#8302 AS cval_lineitem_l_discount_2#8335, cval_lineitem_l_tax#8303 AS cval_lineitem_l_tax_2#8336, cval_lineitem_l_returnflag#8304 AS cval_lineitem_l_returnflag_2#8337, cval_lineitem_l_linestatus#8305 AS cval_lineitem_l_linestatus_2#8338, cval_lineitem_l_commitdate#8306 AS cval_lineitem_l_commitdate_2#8339, cval_lineitem_l_receiptdate#8307 AS cval_lineitem_l_receiptdate_2#8340, cval_lineitem_l_shipinstruct#8308 AS cval_lineitem_l_shipinstruct_2#8341, cval_lineitem_l_shipmode#8309 AS cval_lineitem_l_shipmode_2#8342, cval_lineitem_l_comment#8310 AS cval_lineitem_l_comment_2#8343, cval_lineitem_l_shipdate#8311 AS cval_lineitem_l_shipdate_2#8344, cl_quantity#8312 AS cl_quantity_2#8345, cl_extendedprice#8313 AS cl_extendedprice_2#8346, cl_discount#8314 AS cl_discount_2#8347, ... 9 more fields]
            +- Relation[rid#8291,cpfk_orders_lineitem#8292,cpfk_supplier_lineitem#8293,cfpk_lineitem_supplier#8294,cfpk_lineitem_partsupp#8295,cpfk_part_lineitem#8296,cfpk_lineitem_part#8297,cpfk_partsupp_lineitem#8298,cfpk_lineitem_orders#8299,cval_lineitem_l_quantity#8300,cval_lineitem_l_extendedprice#8301,cval_lineitem_l_discount#8302,cval_lineitem_l_tax#8303,cval_lineitem_l_returnflag#8304,cval_lineitem_l_linestatus#8305,cval_lineitem_l_commitdate#8306,cval_lineitem_l_receiptdate#8307,cval_lineitem_l_shipinstruct#8308,cval_lineitem_l_shipmode#8309,cval_lineitem_l_comment#8310,cval_lineitem_l_shipdate#8311,cl_quantity#8312,cl_extendedprice#8313,cl_discount#8314,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 123323ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/15 17:08:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:08:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8527L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:08:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:08:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:08:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:08:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:08:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:08:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:08:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:08:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8527L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#8529 AS rid_0#8546, cval_part_p_name#8530 AS cval_part_p_name_0#8547, cval_part_p_mfgr#8531 AS cval_part_p_mfgr_0#8548, cval_part_p_type#8532 AS cval_part_p_type_0#8549, cval_part_p_size#8533 AS cval_part_p_size_0#8550, cval_part_p_container#8534 AS cval_part_p_container_0#8551, cval_part_p_retailprice#8535 AS cval_part_p_retailprice_0#8552, cval_part_p_comment#8536 AS cval_part_p_comment_0#8553, cval_part_p_brand#8537 AS cval_part_p_brand_0#8554, cp_name#8538 AS cp_name_0#8555, cp_mfgr#8539 AS cp_mfgr_0#8556, cp_type#8540 AS cp_type_0#8557, cp_size#8541 AS cp_size_0#8558, cp_container#8542 AS cp_container_0#8559, cp_retailprice#8543 AS cp_retailprice_0#8560, cp_comment#8544 AS cp_comment_0#8561, cp_brand#8545 AS cp_brand_0#8562]
         :  :  :  :  +- Relation[rid#8529,cval_part_p_name#8530,cval_part_p_mfgr#8531,cval_part_p_type#8532,cval_part_p_size#8533,cval_part_p_container#8534,cval_part_p_retailprice#8535,cval_part_p_comment#8536,cval_part_p_brand#8537,cp_name#8538,cp_mfgr#8539,cp_type#8540,cp_size#8541,cp_container#8542,cp_retailprice#8543,cp_comment#8544,cp_brand#8545] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#8563 AS rid_0#8580, cval_part_p_name#8564 AS cval_part_p_name_0#8581, cval_part_p_mfgr#8565 AS cval_part_p_mfgr_0#8582, cval_part_p_type#8566 AS cval_part_p_type_0#8583, cval_part_p_size#8567 AS cval_part_p_size_0#8584, cval_part_p_container#8568 AS cval_part_p_container_0#8585, cval_part_p_retailprice#8569 AS cval_part_p_retailprice_0#8586, cval_part_p_comment#8570 AS cval_part_p_comment_0#8587, cval_part_p_brand#8571 AS cval_part_p_brand_0#8588, cp_name#8572 AS cp_name_0#8589, cp_mfgr#8573 AS cp_mfgr_0#8590, cp_type#8574 AS cp_type_0#8591, cp_size#8575 AS cp_size_0#8592, cp_container#8576 AS cp_container_0#8593, cp_retailprice#8577 AS cp_retailprice_0#8594, cp_comment#8578 AS cp_comment_0#8595, cp_brand#8579 AS cp_brand_0#8596]
         :  :  :        +- Relation[rid#8563,cval_part_p_name#8564,cval_part_p_mfgr#8565,cval_part_p_type#8566,cval_part_p_size#8567,cval_part_p_container#8568,cval_part_p_retailprice#8569,cval_part_p_comment#8570,cval_part_p_brand#8571,cp_name#8572,cp_mfgr#8573,cp_type#8574,cp_size#8575,cp_container#8576,cp_retailprice#8577,cp_comment#8578,cp_brand#8579] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#8597 AS rid_0#8614, cval_part_p_name#8598 AS cval_part_p_name_0#8615, cval_part_p_mfgr#8599 AS cval_part_p_mfgr_0#8616, cval_part_p_type#8600 AS cval_part_p_type_0#8617, cval_part_p_size#8601 AS cval_part_p_size_0#8618, cval_part_p_container#8602 AS cval_part_p_container_0#8619, cval_part_p_retailprice#8603 AS cval_part_p_retailprice_0#8620, cval_part_p_comment#8604 AS cval_part_p_comment_0#8621, cval_part_p_brand#8605 AS cval_part_p_brand_0#8622, cp_name#8606 AS cp_name_0#8623, cp_mfgr#8607 AS cp_mfgr_0#8624, cp_type#8608 AS cp_type_0#8625, cp_size#8609 AS cp_size_0#8626, cp_container#8610 AS cp_container_0#8627, cp_retailprice#8611 AS cp_retailprice_0#8628, cp_comment#8612 AS cp_comment_0#8629, cp_brand#8613 AS cp_brand_0#8630]
         :  :        +- Relation[rid#8597,cval_part_p_name#8598,cval_part_p_mfgr#8599,cval_part_p_type#8600,cval_part_p_size#8601,cval_part_p_container#8602,cval_part_p_retailprice#8603,cval_part_p_comment#8604,cval_part_p_brand#8605,cp_name#8606,cp_mfgr#8607,cp_type#8608,cp_size#8609,cp_container#8610,cp_retailprice#8611,cp_comment#8612,cp_brand#8613] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#8863 AS rid_1#8896, cpfk_orders_lineitem#8864 AS cpfk_orders_lineitem_1#8897, cpfk_supplier_lineitem#8865 AS cpfk_supplier_lineitem_1#8898, cfpk_lineitem_supplier#8866 AS cfpk_lineitem_supplier_1#8899, cfpk_lineitem_partsupp#8867 AS cfpk_lineitem_partsupp_1#8900, cpfk_part_lineitem#8868 AS cpfk_part_lineitem_1#8901, cfpk_lineitem_part#8869 AS cfpk_lineitem_part_1#8902, cpfk_partsupp_lineitem#8870 AS cpfk_partsupp_lineitem_1#8903, cfpk_lineitem_orders#8871 AS cfpk_lineitem_orders_1#8904, cval_lineitem_l_quantity#8872 AS cval_lineitem_l_quantity_1#8905, cval_lineitem_l_extendedprice#8873 AS cval_lineitem_l_extendedprice_1#8906, cval_lineitem_l_discount#8874 AS cval_lineitem_l_discount_1#8907, cval_lineitem_l_tax#8875 AS cval_lineitem_l_tax_1#8908, cval_lineitem_l_returnflag#8876 AS cval_lineitem_l_returnflag_1#8909, cval_lineitem_l_linestatus#8877 AS cval_lineitem_l_linestatus_1#8910, cval_lineitem_l_commitdate#8878 AS cval_lineitem_l_commitdate_1#8911, cval_lineitem_l_receiptdate#8879 AS cval_lineitem_l_receiptdate_1#8912, cval_lineitem_l_shipinstruct#8880 AS cval_lineitem_l_shipinstruct_1#8913, cval_lineitem_l_shipmode#8881 AS cval_lineitem_l_shipmode_1#8914, cval_lineitem_l_comment#8882 AS cval_lineitem_l_comment_1#8915, cval_lineitem_l_shipdate#8883 AS cval_lineitem_l_shipdate_1#8916, cl_quantity#8884 AS cl_quantity_1#8917, cl_extendedprice#8885 AS cl_extendedprice_1#8918, cl_discount#8886 AS cl_discount_1#8919, ... 9 more fields]
         :     +- Relation[rid#8863,cpfk_orders_lineitem#8864,cpfk_supplier_lineitem#8865,cfpk_lineitem_supplier#8866,cfpk_lineitem_partsupp#8867,cpfk_part_lineitem#8868,cfpk_lineitem_part#8869,cpfk_partsupp_lineitem#8870,cfpk_lineitem_orders#8871,cval_lineitem_l_quantity#8872,cval_lineitem_l_extendedprice#8873,cval_lineitem_l_discount#8874,cval_lineitem_l_tax#8875,cval_lineitem_l_returnflag#8876,cval_lineitem_l_linestatus#8877,cval_lineitem_l_commitdate#8878,cval_lineitem_l_receiptdate#8879,cval_lineitem_l_shipinstruct#8880,cval_lineitem_l_shipmode#8881,cval_lineitem_l_comment#8882,cval_lineitem_l_shipdate#8883,cl_quantity#8884,cl_extendedprice#8885,cl_discount#8886,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#8631 AS rid_1#8664, cpfk_orders_lineitem#8632 AS cpfk_orders_lineitem_1#8665, cpfk_supplier_lineitem#8633 AS cpfk_supplier_lineitem_1#8666, cfpk_lineitem_supplier#8634 AS cfpk_lineitem_supplier_1#8667, cfpk_lineitem_partsupp#8635 AS cfpk_lineitem_partsupp_1#8668, cpfk_part_lineitem#8636 AS cpfk_part_lineitem_1#8669, cfpk_lineitem_part#8637 AS cfpk_lineitem_part_1#8670, cpfk_partsupp_lineitem#8638 AS cpfk_partsupp_lineitem_1#8671, cfpk_lineitem_orders#8639 AS cfpk_lineitem_orders_1#8672, cval_lineitem_l_quantity#8640 AS cval_lineitem_l_quantity_1#8673, cval_lineitem_l_extendedprice#8641 AS cval_lineitem_l_extendedprice_1#8674, cval_lineitem_l_discount#8642 AS cval_lineitem_l_discount_1#8675, cval_lineitem_l_tax#8643 AS cval_lineitem_l_tax_1#8676, cval_lineitem_l_returnflag#8644 AS cval_lineitem_l_returnflag_1#8677, cval_lineitem_l_linestatus#8645 AS cval_lineitem_l_linestatus_1#8678, cval_lineitem_l_commitdate#8646 AS cval_lineitem_l_commitdate_1#8679, cval_lineitem_l_receiptdate#8647 AS cval_lineitem_l_receiptdate_1#8680, cval_lineitem_l_shipinstruct#8648 AS cval_lineitem_l_shipinstruct_1#8681, cval_lineitem_l_shipmode#8649 AS cval_lineitem_l_shipmode_1#8682, cval_lineitem_l_comment#8650 AS cval_lineitem_l_comment_1#8683, cval_lineitem_l_shipdate#8651 AS cval_lineitem_l_shipdate_1#8684, cl_quantity#8652 AS cl_quantity_1#8685, cl_extendedprice#8653 AS cl_extendedprice_1#8686, cl_discount#8654 AS cl_discount_1#8687, ... 9 more fields]
            :  :  +- Relation[rid#8631,cpfk_orders_lineitem#8632,cpfk_supplier_lineitem#8633,cfpk_lineitem_supplier#8634,cfpk_lineitem_partsupp#8635,cpfk_part_lineitem#8636,cfpk_lineitem_part#8637,cpfk_partsupp_lineitem#8638,cfpk_lineitem_orders#8639,cval_lineitem_l_quantity#8640,cval_lineitem_l_extendedprice#8641,cval_lineitem_l_discount#8642,cval_lineitem_l_tax#8643,cval_lineitem_l_returnflag#8644,cval_lineitem_l_linestatus#8645,cval_lineitem_l_commitdate#8646,cval_lineitem_l_receiptdate#8647,cval_lineitem_l_shipinstruct#8648,cval_lineitem_l_shipmode#8649,cval_lineitem_l_comment#8650,cval_lineitem_l_shipdate#8651,cl_quantity#8652,cl_extendedprice#8653,cl_discount#8654,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#8697 AS rid_1#8730, cpfk_orders_lineitem#8698 AS cpfk_orders_lineitem_1#8731, cpfk_supplier_lineitem#8699 AS cpfk_supplier_lineitem_1#8732, cfpk_lineitem_supplier#8700 AS cfpk_lineitem_supplier_1#8733, cfpk_lineitem_partsupp#8701 AS cfpk_lineitem_partsupp_1#8734, cpfk_part_lineitem#8702 AS cpfk_part_lineitem_1#8735, cfpk_lineitem_part#8703 AS cfpk_lineitem_part_1#8736, cpfk_partsupp_lineitem#8704 AS cpfk_partsupp_lineitem_1#8737, cfpk_lineitem_orders#8705 AS cfpk_lineitem_orders_1#8738, cval_lineitem_l_quantity#8706 AS cval_lineitem_l_quantity_1#8739, cval_lineitem_l_extendedprice#8707 AS cval_lineitem_l_extendedprice_1#8740, cval_lineitem_l_discount#8708 AS cval_lineitem_l_discount_1#8741, cval_lineitem_l_tax#8709 AS cval_lineitem_l_tax_1#8742, cval_lineitem_l_returnflag#8710 AS cval_lineitem_l_returnflag_1#8743, cval_lineitem_l_linestatus#8711 AS cval_lineitem_l_linestatus_1#8744, cval_lineitem_l_commitdate#8712 AS cval_lineitem_l_commitdate_1#8745, cval_lineitem_l_receiptdate#8713 AS cval_lineitem_l_receiptdate_1#8746, cval_lineitem_l_shipinstruct#8714 AS cval_lineitem_l_shipinstruct_1#8747, cval_lineitem_l_shipmode#8715 AS cval_lineitem_l_shipmode_1#8748, cval_lineitem_l_comment#8716 AS cval_lineitem_l_comment_1#8749, cval_lineitem_l_shipdate#8717 AS cval_lineitem_l_shipdate_1#8750, cl_quantity#8718 AS cl_quantity_1#8751, cl_extendedprice#8719 AS cl_extendedprice_1#8752, cl_discount#8720 AS cl_discount_1#8753, ... 9 more fields]
            :        +- Relation[rid#8697,cpfk_orders_lineitem#8698,cpfk_supplier_lineitem#8699,cfpk_lineitem_supplier#8700,cfpk_lineitem_partsupp#8701,cpfk_part_lineitem#8702,cfpk_lineitem_part#8703,cpfk_partsupp_lineitem#8704,cfpk_lineitem_orders#8705,cval_lineitem_l_quantity#8706,cval_lineitem_l_extendedprice#8707,cval_lineitem_l_discount#8708,cval_lineitem_l_tax#8709,cval_lineitem_l_returnflag#8710,cval_lineitem_l_linestatus#8711,cval_lineitem_l_commitdate#8712,cval_lineitem_l_receiptdate#8713,cval_lineitem_l_shipinstruct#8714,cval_lineitem_l_shipmode#8715,cval_lineitem_l_comment#8716,cval_lineitem_l_shipdate#8717,cl_quantity#8718,cl_extendedprice#8719,cl_discount#8720,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#8763 AS rid_1#8796, cpfk_orders_lineitem#8764 AS cpfk_orders_lineitem_1#8797, cpfk_supplier_lineitem#8765 AS cpfk_supplier_lineitem_1#8798, cfpk_lineitem_supplier#8766 AS cfpk_lineitem_supplier_1#8799, cfpk_lineitem_partsupp#8767 AS cfpk_lineitem_partsupp_1#8800, cpfk_part_lineitem#8768 AS cpfk_part_lineitem_1#8801, cfpk_lineitem_part#8769 AS cfpk_lineitem_part_1#8802, cpfk_partsupp_lineitem#8770 AS cpfk_partsupp_lineitem_1#8803, cfpk_lineitem_orders#8771 AS cfpk_lineitem_orders_1#8804, cval_lineitem_l_quantity#8772 AS cval_lineitem_l_quantity_1#8805, cval_lineitem_l_extendedprice#8773 AS cval_lineitem_l_extendedprice_1#8806, cval_lineitem_l_discount#8774 AS cval_lineitem_l_discount_1#8807, cval_lineitem_l_tax#8775 AS cval_lineitem_l_tax_1#8808, cval_lineitem_l_returnflag#8776 AS cval_lineitem_l_returnflag_1#8809, cval_lineitem_l_linestatus#8777 AS cval_lineitem_l_linestatus_1#8810, cval_lineitem_l_commitdate#8778 AS cval_lineitem_l_commitdate_1#8811, cval_lineitem_l_receiptdate#8779 AS cval_lineitem_l_receiptdate_1#8812, cval_lineitem_l_shipinstruct#8780 AS cval_lineitem_l_shipinstruct_1#8813, cval_lineitem_l_shipmode#8781 AS cval_lineitem_l_shipmode_1#8814, cval_lineitem_l_comment#8782 AS cval_lineitem_l_comment_1#8815, cval_lineitem_l_shipdate#8783 AS cval_lineitem_l_shipdate_1#8816, cl_quantity#8784 AS cl_quantity_1#8817, cl_extendedprice#8785 AS cl_extendedprice_1#8818, cl_discount#8786 AS cl_discount_1#8819, ... 9 more fields]
                  +- Relation[rid#8763,cpfk_orders_lineitem#8764,cpfk_supplier_lineitem#8765,cfpk_lineitem_supplier#8766,cfpk_lineitem_partsupp#8767,cpfk_part_lineitem#8768,cfpk_lineitem_part#8769,cpfk_partsupp_lineitem#8770,cfpk_lineitem_orders#8771,cval_lineitem_l_quantity#8772,cval_lineitem_l_extendedprice#8773,cval_lineitem_l_discount#8774,cval_lineitem_l_tax#8775,cval_lineitem_l_returnflag#8776,cval_lineitem_l_linestatus#8777,cval_lineitem_l_commitdate#8778,cval_lineitem_l_receiptdate#8779,cval_lineitem_l_shipinstruct#8780,cval_lineitem_l_shipmode#8781,cval_lineitem_l_comment#8782,cval_lineitem_l_shipdate#8783,cl_quantity#8784,cl_extendedprice#8785,cl_discount#8786,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=13
Elapsed time: 61643ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 17:09:45 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:09:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8988L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 17:09:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:09:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:09:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:09:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:09:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:09:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:09:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:09:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:09:45 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:09:45 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:09:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8988L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#8990 AS rid_0#8997, cpfk_region_nation#8991 AS cpfk_region_nation_0#8998, cfpk_nation_region#8992 AS cfpk_nation_region_0#8999, cval_nation_n_name#8993 AS cval_nation_n_name_0#9000, cval_nation_n_comment#8994 AS cval_nation_n_comment_0#9001, cn_name#8995 AS cn_name_0#9002, cn_comment#8996 AS cn_comment_0#9003]
            :     :     :  :  :  :  :  +- Relation[rid#8990,cpfk_region_nation#8991,cfpk_nation_region#8992,cval_nation_n_name#8993,cval_nation_n_comment#8994,cn_name#8995,cn_comment#8996] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#9030 AS rid_0#9037, cpfk_region_nation#9031 AS cpfk_region_nation_0#9038, cfpk_nation_region#9032 AS cfpk_nation_region_0#9039, cval_nation_n_name#9033 AS cval_nation_n_name_0#9040, cval_nation_n_comment#9034 AS cval_nation_n_comment_0#9041, cn_name#9035 AS cn_name_0#9042, cn_comment#9036 AS cn_comment_0#9043]
            :     :     :  :  :  :     :  +- Relation[rid#9030,cpfk_region_nation#9031,cfpk_nation_region#9032,cval_nation_n_name#9033,cval_nation_n_comment#9034,cn_name#9035,cn_comment#9036] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#9044 AS rid_1#9057, cpfk_nation_supplier#9045 AS cpfk_nation_supplier_1#9058, cfpk_supplier_nation#9046 AS cfpk_supplier_nation_1#9059, cval_supplier_s_name#9047 AS cval_supplier_s_name_1#9060, cval_supplier_s_address#9048 AS cval_supplier_s_address_1#9061, cval_supplier_s_phone#9049 AS cval_supplier_s_phone_1#9062, cval_supplier_s_acctbal#9050 AS cval_supplier_s_acctbal_1#9063, cval_supplier_s_comment#9051 AS cval_supplier_s_comment_1#9064, cs_name#9052 AS cs_name_1#9065, cs_address#9053 AS cs_address_1#9066, cs_phone#9054 AS cs_phone_1#9067, cs_acctbal#9055 AS cs_acctbal_1#9068, cs_comment#9056 AS cs_comment_1#9069]
            :     :     :  :  :  :        +- Relation[rid#9044,cpfk_nation_supplier#9045,cfpk_supplier_nation#9046,cval_supplier_s_name#9047,cval_supplier_s_address#9048,cval_supplier_s_phone#9049,cval_supplier_s_acctbal#9050,cval_supplier_s_comment#9051,cs_name#9052,cs_address#9053,cs_phone#9054,cs_acctbal#9055,cs_comment#9056] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#9004 AS rid_1#9017, cpfk_nation_supplier#9005 AS cpfk_nation_supplier_1#9018, cfpk_supplier_nation#9006 AS cfpk_supplier_nation_1#9019, cval_supplier_s_name#9007 AS cval_supplier_s_name_1#9020, cval_supplier_s_address#9008 AS cval_supplier_s_address_1#9021, cval_supplier_s_phone#9009 AS cval_supplier_s_phone_1#9022, cval_supplier_s_acctbal#9010 AS cval_supplier_s_acctbal_1#9023, cval_supplier_s_comment#9011 AS cval_supplier_s_comment_1#9024, cs_name#9012 AS cs_name_1#9025, cs_address#9013 AS cs_address_1#9026, cs_phone#9014 AS cs_phone_1#9027, cs_acctbal#9015 AS cs_acctbal_1#9028, cs_comment#9016 AS cs_comment_1#9029]
            :     :     :  :  :     +- Relation[rid#9004,cpfk_nation_supplier#9005,cfpk_supplier_nation#9006,cval_supplier_s_name#9007,cval_supplier_s_address#9008,cval_supplier_s_phone#9009,cval_supplier_s_acctbal#9010,cval_supplier_s_comment#9011,cs_name#9012,cs_address#9013,cs_phone#9014,cs_acctbal#9015,cs_comment#9016] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#9136 AS rid_1#9149, cpfk_nation_supplier#9137 AS cpfk_nation_supplier_1#9150, cfpk_supplier_nation#9138 AS cfpk_supplier_nation_1#9151, cval_supplier_s_name#9139 AS cval_supplier_s_name_1#9152, cval_supplier_s_address#9140 AS cval_supplier_s_address_1#9153, cval_supplier_s_phone#9141 AS cval_supplier_s_phone_1#9154, cval_supplier_s_acctbal#9142 AS cval_supplier_s_acctbal_1#9155, cval_supplier_s_comment#9143 AS cval_supplier_s_comment_1#9156, cs_name#9144 AS cs_name_1#9157, cs_address#9145 AS cs_address_1#9158, cs_phone#9146 AS cs_phone_1#9159, cs_acctbal#9147 AS cs_acctbal_1#9160, cs_comment#9148 AS cs_comment_1#9161]
            :     :     :  :     :  +- Relation[rid#9136,cpfk_nation_supplier#9137,cfpk_supplier_nation#9138,cval_supplier_s_name#9139,cval_supplier_s_address#9140,cval_supplier_s_phone#9141,cval_supplier_s_acctbal#9142,cval_supplier_s_comment#9143,cs_name#9144,cs_address#9145,cs_phone#9146,cs_acctbal#9147,cs_comment#9148] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#9162 AS rid_2#9195, cpfk_orders_lineitem#9163 AS cpfk_orders_lineitem_2#9196, cpfk_supplier_lineitem#9164 AS cpfk_supplier_lineitem_2#9197, cfpk_lineitem_supplier#9165 AS cfpk_lineitem_supplier_2#9198, cfpk_lineitem_partsupp#9166 AS cfpk_lineitem_partsupp_2#9199, cpfk_part_lineitem#9167 AS cpfk_part_lineitem_2#9200, cfpk_lineitem_part#9168 AS cfpk_lineitem_part_2#9201, cpfk_partsupp_lineitem#9169 AS cpfk_partsupp_lineitem_2#9202, cfpk_lineitem_orders#9170 AS cfpk_lineitem_orders_2#9203, cval_lineitem_l_quantity#9171 AS cval_lineitem_l_quantity_2#9204, cval_lineitem_l_extendedprice#9172 AS cval_lineitem_l_extendedprice_2#9205, cval_lineitem_l_discount#9173 AS cval_lineitem_l_discount_2#9206, cval_lineitem_l_tax#9174 AS cval_lineitem_l_tax_2#9207, cval_lineitem_l_returnflag#9175 AS cval_lineitem_l_returnflag_2#9208, cval_lineitem_l_linestatus#9176 AS cval_lineitem_l_linestatus_2#9209, cval_lineitem_l_commitdate#9177 AS cval_lineitem_l_commitdate_2#9210, cval_lineitem_l_receiptdate#9178 AS cval_lineitem_l_receiptdate_2#9211, cval_lineitem_l_shipinstruct#9179 AS cval_lineitem_l_shipinstruct_2#9212, cval_lineitem_l_shipmode#9180 AS cval_lineitem_l_shipmode_2#9213, cval_lineitem_l_comment#9181 AS cval_lineitem_l_comment_2#9214, cval_lineitem_l_shipdate#9182 AS cval_lineitem_l_shipdate_2#9215, cl_quantity#9183 AS cl_quantity_2#9216, cl_extendedprice#9184 AS cl_extendedprice_2#9217, cl_discount#9185 AS cl_discount_2#9218, ... 9 more fields]
            :     :     :  :        +- Relation[rid#9162,cpfk_orders_lineitem#9163,cpfk_supplier_lineitem#9164,cfpk_lineitem_supplier#9165,cfpk_lineitem_partsupp#9166,cpfk_part_lineitem#9167,cfpk_lineitem_part#9168,cpfk_partsupp_lineitem#9169,cfpk_lineitem_orders#9170,cval_lineitem_l_quantity#9171,cval_lineitem_l_extendedprice#9172,cval_lineitem_l_discount#9173,cval_lineitem_l_tax#9174,cval_lineitem_l_returnflag#9175,cval_lineitem_l_linestatus#9176,cval_lineitem_l_commitdate#9177,cval_lineitem_l_receiptdate#9178,cval_lineitem_l_shipinstruct#9179,cval_lineitem_l_shipmode#9180,cval_lineitem_l_comment#9181,cval_lineitem_l_shipdate#9182,cl_quantity#9183,cl_extendedprice#9184,cl_discount#9185,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#9070 AS rid_2#9103, cpfk_orders_lineitem#9071 AS cpfk_orders_lineitem_2#9104, cpfk_supplier_lineitem#9072 AS cpfk_supplier_lineitem_2#9105, cfpk_lineitem_supplier#9073 AS cfpk_lineitem_supplier_2#9106, cfpk_lineitem_partsupp#9074 AS cfpk_lineitem_partsupp_2#9107, cpfk_part_lineitem#9075 AS cpfk_part_lineitem_2#9108, cfpk_lineitem_part#9076 AS cfpk_lineitem_part_2#9109, cpfk_partsupp_lineitem#9077 AS cpfk_partsupp_lineitem_2#9110, cfpk_lineitem_orders#9078 AS cfpk_lineitem_orders_2#9111, cval_lineitem_l_quantity#9079 AS cval_lineitem_l_quantity_2#9112, cval_lineitem_l_extendedprice#9080 AS cval_lineitem_l_extendedprice_2#9113, cval_lineitem_l_discount#9081 AS cval_lineitem_l_discount_2#9114, cval_lineitem_l_tax#9082 AS cval_lineitem_l_tax_2#9115, cval_lineitem_l_returnflag#9083 AS cval_lineitem_l_returnflag_2#9116, cval_lineitem_l_linestatus#9084 AS cval_lineitem_l_linestatus_2#9117, cval_lineitem_l_commitdate#9085 AS cval_lineitem_l_commitdate_2#9118, cval_lineitem_l_receiptdate#9086 AS cval_lineitem_l_receiptdate_2#9119, cval_lineitem_l_shipinstruct#9087 AS cval_lineitem_l_shipinstruct_2#9120, cval_lineitem_l_shipmode#9088 AS cval_lineitem_l_shipmode_2#9121, cval_lineitem_l_comment#9089 AS cval_lineitem_l_comment_2#9122, cval_lineitem_l_shipdate#9090 AS cval_lineitem_l_shipdate_2#9123, cl_quantity#9091 AS cl_quantity_2#9124, cl_extendedprice#9092 AS cl_extendedprice_2#9125, cl_discount#9093 AS cl_discount_2#9126, ... 9 more fields]
            :     :     :     +- Relation[rid#9070,cpfk_orders_lineitem#9071,cpfk_supplier_lineitem#9072,cfpk_lineitem_supplier#9073,cfpk_lineitem_partsupp#9074,cpfk_part_lineitem#9075,cfpk_lineitem_part#9076,cpfk_partsupp_lineitem#9077,cfpk_lineitem_orders#9078,cval_lineitem_l_quantity#9079,cval_lineitem_l_extendedprice#9080,cval_lineitem_l_discount#9081,cval_lineitem_l_tax#9082,cval_lineitem_l_returnflag#9083,cval_lineitem_l_linestatus#9084,cval_lineitem_l_commitdate#9085,cval_lineitem_l_receiptdate#9086,cval_lineitem_l_shipinstruct#9087,cval_lineitem_l_shipmode#9088,cval_lineitem_l_comment#9089,cval_lineitem_l_shipdate#9090,cl_quantity#9091,cl_extendedprice#9092,cl_discount#9093,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#9228 AS rid_3#9245, cval_part_p_name#9229 AS cval_part_p_name_3#9246, cval_part_p_mfgr#9230 AS cval_part_p_mfgr_3#9247, cval_part_p_type#9231 AS cval_part_p_type_3#9248, cval_part_p_size#9232 AS cval_part_p_size_3#9249, cval_part_p_container#9233 AS cval_part_p_container_3#9250, cval_part_p_retailprice#9234 AS cval_part_p_retailprice_3#9251, cval_part_p_comment#9235 AS cval_part_p_comment_3#9252, cval_part_p_brand#9236 AS cval_part_p_brand_3#9253, cp_name#9237 AS cp_name_3#9254, cp_mfgr#9238 AS cp_mfgr_3#9255, cp_type#9239 AS cp_type_3#9256, cp_size#9240 AS cp_size_3#9257, cp_container#9241 AS cp_container_3#9258, cp_retailprice#9242 AS cp_retailprice_3#9259, cp_comment#9243 AS cp_comment_3#9260, cp_brand#9244 AS cp_brand_3#9261]
            :     :        +- Relation[rid#9228,cval_part_p_name#9229,cval_part_p_mfgr#9230,cval_part_p_type#9231,cval_part_p_size#9232,cval_part_p_container#9233,cval_part_p_retailprice#9234,cval_part_p_comment#9235,cval_part_p_brand#9236,cp_name#9237,cp_mfgr#9238,cp_type#9239,cp_size#9240,cp_container#9241,cp_retailprice#9242,cp_comment#9243,cp_brand#9244] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#9262 AS rid_4#9273, cpfk_part_partsupp#9263 AS cpfk_part_partsupp_4#9274, cfpk_partsupp_part#9264 AS cfpk_partsupp_part_4#9275, cpfk_supplier_partsupp#9265 AS cpfk_supplier_partsupp_4#9276, cfpk_partsupp_supplier#9266 AS cfpk_partsupp_supplier_4#9277, cval_partsupp_ps_availqty#9267 AS cval_partsupp_ps_availqty_4#9278, cval_partsupp_ps_supplycost#9268 AS cval_partsupp_ps_supplycost_4#9279, cval_partsupp_ps_comment#9269 AS cval_partsupp_ps_comment_4#9280, cps_availqty#9270 AS cps_availqty_4#9281, cps_supplycost#9271 AS cps_supplycost_4#9282, cps_comment#9272 AS cps_comment_4#9283]
            :        +- Relation[rid#9262,cpfk_part_partsupp#9263,cfpk_partsupp_part#9264,cpfk_supplier_partsupp#9265,cfpk_partsupp_supplier#9266,cval_partsupp_ps_availqty#9267,cval_partsupp_ps_supplycost#9268,cval_partsupp_ps_comment#9269,cps_availqty#9270,cps_supplycost#9271,cps_comment#9272] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#9284 AS rid_5#9301, cpfk_customer_orders#9285 AS cpfk_customer_orders_5#9302, cfpk_orders_customer#9286 AS cfpk_orders_customer_5#9303, cval_orders_o_orderstatus#9287 AS cval_orders_o_orderstatus_5#9304, cval_orders_o_totalprice#9288 AS cval_orders_o_totalprice_5#9305, cval_orders_o_orderpriority#9289 AS cval_orders_o_orderpriority_5#9306, cval_orders_o_clerk#9290 AS cval_orders_o_clerk_5#9307, cval_orders_o_shippriority#9291 AS cval_orders_o_shippriority_5#9308, cval_orders_o_comment#9292 AS cval_orders_o_comment_5#9309, cval_orders_o_orderdate#9293 AS cval_orders_o_orderdate_5#9310, co_orderstatus#9294 AS co_orderstatus_5#9311, co_totalprice#9295 AS co_totalprice_5#9312, co_orderpriority#9296 AS co_orderpriority_5#9313, co_clerk#9297 AS co_clerk_5#9314, co_shippriority#9298 AS co_shippriority_5#9315, co_comment#9299 AS co_comment_5#9316, co_orderdate#9300 AS co_orderdate_5#9317]
               +- Relation[rid#9284,cpfk_customer_orders#9285,cfpk_orders_customer#9286,cval_orders_o_orderstatus#9287,cval_orders_o_totalprice#9288,cval_orders_o_orderpriority#9289,cval_orders_o_clerk#9290,cval_orders_o_shippriority#9291,cval_orders_o_comment#9292,cval_orders_o_orderdate#9293,co_orderstatus#9294,co_totalprice#9295,co_orderpriority#9296,co_clerk#9297,co_shippriority#9298,co_comment#9299,co_orderdate#9300] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 261625ms
query=q1, count=6001215, duration=2769
query=q10, count=1478870, duration=66095
query=q11, count=4, duration=1132
query=q12, count=857401, duration=21831
query=q13, count=1500000, duration=13209
query=q14, count=6001215, duration=90691
query=q15, count=6001215, duration=90528
query=q16, count=7890, duration=499
query=q17, count=408, duration=415
query=q18, count=6001215, duration=123323
query=q19, count=13, duration=61643
query=q2, count=0, duration=1607
query=q20, count=326, duration=653
query=q21a, count=120762, duration=90411
query=q22, count=1500000, duration=13618
query=q3, count=75006, duration=6744
query=q4, count=6001215, duration=56631
query=q5, count=1, duration=21013
query=q6, count=6001215, duration=2693
query=q7, count=0, duration=361
query=q8, count=0, duration=1771
query=q9a, count=6001215, duration=261625
query=q9b, count=6001215, duration=169517
