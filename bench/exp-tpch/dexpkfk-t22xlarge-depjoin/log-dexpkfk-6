20/04/15 16:14:58 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 38681ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Apr 15 16:15:04 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Apr 15 16:15:05 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Apr 15 16:15:06 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Apr 15 16:15:06 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Apr 15 16:15:06 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Apr 15 16:15:21 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Apr 15 16:15:40 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Apr 15 16:15:40 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/15 16:15:44 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:15:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2078L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 16:15:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2078L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#2080 AS rid_0#2097, cpfk_customer_orders#2081 AS cpfk_customer_orders_0#2098, cfpk_orders_customer#2082 AS cfpk_orders_customer_0#2099, cval_orders_o_orderstatus#2083 AS cval_orders_o_orderstatus_0#2100, cval_orders_o_totalprice#2084 AS cval_orders_o_totalprice_0#2101, cval_orders_o_orderpriority#2085 AS cval_orders_o_orderpriority_0#2102, cval_orders_o_clerk#2086 AS cval_orders_o_clerk_0#2103, cval_orders_o_shippriority#2087 AS cval_orders_o_shippriority_0#2104, cval_orders_o_comment#2088 AS cval_orders_o_comment_0#2105, cval_orders_o_orderdate#2089 AS cval_orders_o_orderdate_0#2106, co_orderstatus#2090 AS co_orderstatus_0#2107, co_totalprice#2091 AS co_totalprice_0#2108, co_orderpriority#2092 AS co_orderpriority_0#2109, co_clerk#2093 AS co_clerk_0#2110, co_shippriority#2094 AS co_shippriority_0#2111, co_comment#2095 AS co_comment_0#2112, co_orderdate#2096 AS co_orderdate_0#2113]
            :  +- Relation[rid#2080,cpfk_customer_orders#2081,cfpk_orders_customer#2082,cval_orders_o_orderstatus#2083,cval_orders_o_totalprice#2084,cval_orders_o_orderpriority#2085,cval_orders_o_clerk#2086,cval_orders_o_shippriority#2087,cval_orders_o_comment#2088,cval_orders_o_orderdate#2089,co_orderstatus#2090,co_totalprice#2091,co_orderpriority#2092,co_clerk#2093,co_shippriority#2094,co_comment#2095,co_orderdate#2096] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#2114 AS rid_1#2129, cpfk_nation_customer#2115 AS cpfk_nation_customer_1#2130, cfpk_customer_nation#2116 AS cfpk_customer_nation_1#2131, cval_customer_c_name#2117 AS cval_customer_c_name_1#2132, cval_customer_c_address#2118 AS cval_customer_c_address_1#2133, cval_customer_c_phone#2119 AS cval_customer_c_phone_1#2134, cval_customer_c_acctbal#2120 AS cval_customer_c_acctbal_1#2135, cval_customer_c_comment#2121 AS cval_customer_c_comment_1#2136, cval_customer_c_mktsegment#2122 AS cval_customer_c_mktsegment_1#2137, cc_name#2123 AS cc_name_1#2138, cc_address#2124 AS cc_address_1#2139, cc_phone#2125 AS cc_phone_1#2140, cc_acctbal#2126 AS cc_acctbal_1#2141, cc_comment#2127 AS cc_comment_1#2142, cc_mktsegment#2128 AS cc_mktsegment_1#2143]
               +- Relation[rid#2114,cpfk_nation_customer#2115,cfpk_customer_nation#2116,cval_customer_c_name#2117,cval_customer_c_address#2118,cval_customer_c_phone#2119,cval_customer_c_acctbal#2120,cval_customer_c_comment#2121,cval_customer_c_mktsegment#2122,cc_name#2123,cc_address#2124,cc_phone#2125,cc_acctbal#2126,cc_comment#2127,cc_mktsegment#2128] JDBCRelation(tcustomer) [numPartitions=1]

20/04/15 16:15:45 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexPkFk$ result size=1500000
Elapsed time: 15143ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 16:16:00 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:16:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2185L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:16:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:16:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:16:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:16:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:16:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:16:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:16:00 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:16:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:16:00 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:16:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:16:00 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:16:00 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:16:00 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:16:00 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:16:00 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:16:00 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:16:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2185L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#2187 AS rid_0#2194, cpfk_region_nation#2188 AS cpfk_region_nation_0#2195, cfpk_nation_region#2189 AS cfpk_nation_region_0#2196, cval_nation_n_name#2190 AS cval_nation_n_name_0#2197, cval_nation_n_comment#2191 AS cval_nation_n_comment_0#2198, cn_name#2192 AS cn_name_0#2199, cn_comment#2193 AS cn_comment_0#2200]
            :  :  :     :  :  :  :  :  +- Relation[rid#2187,cpfk_region_nation#2188,cfpk_nation_region#2189,cval_nation_n_name#2190,cval_nation_n_comment#2191,cn_name#2192,cn_comment#2193] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#2227 AS rid_0#2234, cpfk_region_nation#2228 AS cpfk_region_nation_0#2235, cfpk_nation_region#2229 AS cfpk_nation_region_0#2236, cval_nation_n_name#2230 AS cval_nation_n_name_0#2237, cval_nation_n_comment#2231 AS cval_nation_n_comment_0#2238, cn_name#2232 AS cn_name_0#2239, cn_comment#2233 AS cn_comment_0#2240]
            :  :  :     :  :  :  :     :  +- Relation[rid#2227,cpfk_region_nation#2228,cfpk_nation_region#2229,cval_nation_n_name#2230,cval_nation_n_comment#2231,cn_name#2232,cn_comment#2233] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#2241 AS rid_1#2254, cpfk_nation_supplier#2242 AS cpfk_nation_supplier_1#2255, cfpk_supplier_nation#2243 AS cfpk_supplier_nation_1#2256, cval_supplier_s_name#2244 AS cval_supplier_s_name_1#2257, cval_supplier_s_address#2245 AS cval_supplier_s_address_1#2258, cval_supplier_s_phone#2246 AS cval_supplier_s_phone_1#2259, cval_supplier_s_acctbal#2247 AS cval_supplier_s_acctbal_1#2260, cval_supplier_s_comment#2248 AS cval_supplier_s_comment_1#2261, cs_name#2249 AS cs_name_1#2262, cs_address#2250 AS cs_address_1#2263, cs_phone#2251 AS cs_phone_1#2264, cs_acctbal#2252 AS cs_acctbal_1#2265, cs_comment#2253 AS cs_comment_1#2266]
            :  :  :     :  :  :  :        +- Relation[rid#2241,cpfk_nation_supplier#2242,cfpk_supplier_nation#2243,cval_supplier_s_name#2244,cval_supplier_s_address#2245,cval_supplier_s_phone#2246,cval_supplier_s_acctbal#2247,cval_supplier_s_comment#2248,cs_name#2249,cs_address#2250,cs_phone#2251,cs_acctbal#2252,cs_comment#2253] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#2201 AS rid_1#2214, cpfk_nation_supplier#2202 AS cpfk_nation_supplier_1#2215, cfpk_supplier_nation#2203 AS cfpk_supplier_nation_1#2216, cval_supplier_s_name#2204 AS cval_supplier_s_name_1#2217, cval_supplier_s_address#2205 AS cval_supplier_s_address_1#2218, cval_supplier_s_phone#2206 AS cval_supplier_s_phone_1#2219, cval_supplier_s_acctbal#2207 AS cval_supplier_s_acctbal_1#2220, cval_supplier_s_comment#2208 AS cval_supplier_s_comment_1#2221, cs_name#2209 AS cs_name_1#2222, cs_address#2210 AS cs_address_1#2223, cs_phone#2211 AS cs_phone_1#2224, cs_acctbal#2212 AS cs_acctbal_1#2225, cs_comment#2213 AS cs_comment_1#2226]
            :  :  :     :  :  :     +- Relation[rid#2201,cpfk_nation_supplier#2202,cfpk_supplier_nation#2203,cval_supplier_s_name#2204,cval_supplier_s_address#2205,cval_supplier_s_phone#2206,cval_supplier_s_acctbal#2207,cval_supplier_s_comment#2208,cs_name#2209,cs_address#2210,cs_phone#2211,cs_acctbal#2212,cs_comment#2213] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#2289 AS rid_1#2302, cpfk_nation_supplier#2290 AS cpfk_nation_supplier_1#2303, cfpk_supplier_nation#2291 AS cfpk_supplier_nation_1#2304, cval_supplier_s_name#2292 AS cval_supplier_s_name_1#2305, cval_supplier_s_address#2293 AS cval_supplier_s_address_1#2306, cval_supplier_s_phone#2294 AS cval_supplier_s_phone_1#2307, cval_supplier_s_acctbal#2295 AS cval_supplier_s_acctbal_1#2308, cval_supplier_s_comment#2296 AS cval_supplier_s_comment_1#2309, cs_name#2297 AS cs_name_1#2310, cs_address#2298 AS cs_address_1#2311, cs_phone#2299 AS cs_phone_1#2312, cs_acctbal#2300 AS cs_acctbal_1#2313, cs_comment#2301 AS cs_comment_1#2314]
            :  :  :     :  :     :  +- Relation[rid#2289,cpfk_nation_supplier#2290,cfpk_supplier_nation#2291,cval_supplier_s_name#2292,cval_supplier_s_address#2293,cval_supplier_s_phone#2294,cval_supplier_s_acctbal#2295,cval_supplier_s_comment#2296,cs_name#2297,cs_address#2298,cs_phone#2299,cs_acctbal#2300,cs_comment#2301] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#2315 AS rid_2#2326, cpfk_part_partsupp#2316 AS cpfk_part_partsupp_2#2327, cfpk_partsupp_part#2317 AS cfpk_partsupp_part_2#2328, cpfk_supplier_partsupp#2318 AS cpfk_supplier_partsupp_2#2329, cfpk_partsupp_supplier#2319 AS cfpk_partsupp_supplier_2#2330, cval_partsupp_ps_availqty#2320 AS cval_partsupp_ps_availqty_2#2331, cval_partsupp_ps_supplycost#2321 AS cval_partsupp_ps_supplycost_2#2332, cval_partsupp_ps_comment#2322 AS cval_partsupp_ps_comment_2#2333, cps_availqty#2323 AS cps_availqty_2#2334, cps_supplycost#2324 AS cps_supplycost_2#2335, cps_comment#2325 AS cps_comment_2#2336]
            :  :  :     :  :        +- Relation[rid#2315,cpfk_part_partsupp#2316,cfpk_partsupp_part#2317,cpfk_supplier_partsupp#2318,cfpk_partsupp_supplier#2319,cval_partsupp_ps_availqty#2320,cval_partsupp_ps_supplycost#2321,cval_partsupp_ps_comment#2322,cps_availqty#2323,cps_supplycost#2324,cps_comment#2325] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#2267 AS rid_2#2278, cpfk_part_partsupp#2268 AS cpfk_part_partsupp_2#2279, cfpk_partsupp_part#2269 AS cfpk_partsupp_part_2#2280, cpfk_supplier_partsupp#2270 AS cpfk_supplier_partsupp_2#2281, cfpk_partsupp_supplier#2271 AS cfpk_partsupp_supplier_2#2282, cval_partsupp_ps_availqty#2272 AS cval_partsupp_ps_availqty_2#2283, cval_partsupp_ps_supplycost#2273 AS cval_partsupp_ps_supplycost_2#2284, cval_partsupp_ps_comment#2274 AS cval_partsupp_ps_comment_2#2285, cps_availqty#2275 AS cps_availqty_2#2286, cps_supplycost#2276 AS cps_supplycost_2#2287, cps_comment#2277 AS cps_comment_2#2288]
            :  :  :     :     +- Relation[rid#2267,cpfk_part_partsupp#2268,cfpk_partsupp_part#2269,cpfk_supplier_partsupp#2270,cfpk_partsupp_supplier#2271,cval_partsupp_ps_availqty#2272,cval_partsupp_ps_supplycost#2273,cval_partsupp_ps_comment#2274,cps_availqty#2275,cps_supplycost#2276,cps_comment#2277] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#2337 AS rid_3#2354, cval_part_p_name#2338 AS cval_part_p_name_3#2355, cval_part_p_mfgr#2339 AS cval_part_p_mfgr_3#2356, cval_part_p_type#2340 AS cval_part_p_type_3#2357, cval_part_p_size#2341 AS cval_part_p_size_3#2358, cval_part_p_container#2342 AS cval_part_p_container_3#2359, cval_part_p_retailprice#2343 AS cval_part_p_retailprice_3#2360, cval_part_p_comment#2344 AS cval_part_p_comment_3#2361, cval_part_p_brand#2345 AS cval_part_p_brand_3#2362, cp_name#2346 AS cp_name_3#2363, cp_mfgr#2347 AS cp_mfgr_3#2364, cp_type#2348 AS cp_type_3#2365, cp_size#2349 AS cp_size_3#2366, cp_container#2350 AS cp_container_3#2367, cp_retailprice#2351 AS cp_retailprice_3#2368, cp_comment#2352 AS cp_comment_3#2369, cp_brand#2353 AS cp_brand_3#2370]
            :  :  :        +- Relation[rid#2337,cval_part_p_name#2338,cval_part_p_mfgr#2339,cval_part_p_type#2340,cval_part_p_size#2341,cval_part_p_container#2342,cval_part_p_retailprice#2343,cval_part_p_comment#2344,cval_part_p_brand#2345,cp_name#2346,cp_mfgr#2347,cp_type#2348,cp_size#2349,cp_container#2350,cp_retailprice#2351,cp_comment#2352,cp_brand#2353] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#2437 AS rid_2#2448, cpfk_part_partsupp#2438 AS cpfk_part_partsupp_2#2449, cfpk_partsupp_part#2439 AS cfpk_partsupp_part_2#2450, cpfk_supplier_partsupp#2440 AS cpfk_supplier_partsupp_2#2451, cfpk_partsupp_supplier#2441 AS cfpk_partsupp_supplier_2#2452, cval_partsupp_ps_availqty#2442 AS cval_partsupp_ps_availqty_2#2453, cval_partsupp_ps_supplycost#2443 AS cval_partsupp_ps_supplycost_2#2454, cval_partsupp_ps_comment#2444 AS cval_partsupp_ps_comment_2#2455, cps_availqty#2445 AS cps_availqty_2#2456, cps_supplycost#2446 AS cps_supplycost_2#2457, cps_comment#2447 AS cps_comment_2#2458]
            :  :     :  +- Relation[rid#2437,cpfk_part_partsupp#2438,cfpk_partsupp_part#2439,cpfk_supplier_partsupp#2440,cfpk_partsupp_supplier#2441,cval_partsupp_ps_availqty#2442,cval_partsupp_ps_supplycost#2443,cval_partsupp_ps_comment#2444,cps_availqty#2445,cps_supplycost#2446,cps_comment#2447] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#2459 AS rid_4#2492, cpfk_orders_lineitem#2460 AS cpfk_orders_lineitem_4#2493, cpfk_supplier_lineitem#2461 AS cpfk_supplier_lineitem_4#2494, cfpk_lineitem_supplier#2462 AS cfpk_lineitem_supplier_4#2495, cfpk_lineitem_partsupp#2463 AS cfpk_lineitem_partsupp_4#2496, cpfk_part_lineitem#2464 AS cpfk_part_lineitem_4#2497, cfpk_lineitem_part#2465 AS cfpk_lineitem_part_4#2498, cpfk_partsupp_lineitem#2466 AS cpfk_partsupp_lineitem_4#2499, cfpk_lineitem_orders#2467 AS cfpk_lineitem_orders_4#2500, cval_lineitem_l_quantity#2468 AS cval_lineitem_l_quantity_4#2501, cval_lineitem_l_extendedprice#2469 AS cval_lineitem_l_extendedprice_4#2502, cval_lineitem_l_discount#2470 AS cval_lineitem_l_discount_4#2503, cval_lineitem_l_tax#2471 AS cval_lineitem_l_tax_4#2504, cval_lineitem_l_returnflag#2472 AS cval_lineitem_l_returnflag_4#2505, cval_lineitem_l_linestatus#2473 AS cval_lineitem_l_linestatus_4#2506, cval_lineitem_l_commitdate#2474 AS cval_lineitem_l_commitdate_4#2507, cval_lineitem_l_receiptdate#2475 AS cval_lineitem_l_receiptdate_4#2508, cval_lineitem_l_shipinstruct#2476 AS cval_lineitem_l_shipinstruct_4#2509, cval_lineitem_l_shipmode#2477 AS cval_lineitem_l_shipmode_4#2510, cval_lineitem_l_comment#2478 AS cval_lineitem_l_comment_4#2511, cval_lineitem_l_shipdate#2479 AS cval_lineitem_l_shipdate_4#2512, cl_quantity#2480 AS cl_quantity_4#2513, cl_extendedprice#2481 AS cl_extendedprice_4#2514, cl_discount#2482 AS cl_discount_4#2515, ... 9 more fields]
            :  :        +- Relation[rid#2459,cpfk_orders_lineitem#2460,cpfk_supplier_lineitem#2461,cfpk_lineitem_supplier#2462,cfpk_lineitem_partsupp#2463,cpfk_part_lineitem#2464,cfpk_lineitem_part#2465,cpfk_partsupp_lineitem#2466,cfpk_lineitem_orders#2467,cval_lineitem_l_quantity#2468,cval_lineitem_l_extendedprice#2469,cval_lineitem_l_discount#2470,cval_lineitem_l_tax#2471,cval_lineitem_l_returnflag#2472,cval_lineitem_l_linestatus#2473,cval_lineitem_l_commitdate#2474,cval_lineitem_l_receiptdate#2475,cval_lineitem_l_shipinstruct#2476,cval_lineitem_l_shipmode#2477,cval_lineitem_l_comment#2478,cval_lineitem_l_shipdate#2479,cl_quantity#2480,cl_extendedprice#2481,cl_discount#2482,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#2371 AS rid_4#2404, cpfk_orders_lineitem#2372 AS cpfk_orders_lineitem_4#2405, cpfk_supplier_lineitem#2373 AS cpfk_supplier_lineitem_4#2406, cfpk_lineitem_supplier#2374 AS cfpk_lineitem_supplier_4#2407, cfpk_lineitem_partsupp#2375 AS cfpk_lineitem_partsupp_4#2408, cpfk_part_lineitem#2376 AS cpfk_part_lineitem_4#2409, cfpk_lineitem_part#2377 AS cfpk_lineitem_part_4#2410, cpfk_partsupp_lineitem#2378 AS cpfk_partsupp_lineitem_4#2411, cfpk_lineitem_orders#2379 AS cfpk_lineitem_orders_4#2412, cval_lineitem_l_quantity#2380 AS cval_lineitem_l_quantity_4#2413, cval_lineitem_l_extendedprice#2381 AS cval_lineitem_l_extendedprice_4#2414, cval_lineitem_l_discount#2382 AS cval_lineitem_l_discount_4#2415, cval_lineitem_l_tax#2383 AS cval_lineitem_l_tax_4#2416, cval_lineitem_l_returnflag#2384 AS cval_lineitem_l_returnflag_4#2417, cval_lineitem_l_linestatus#2385 AS cval_lineitem_l_linestatus_4#2418, cval_lineitem_l_commitdate#2386 AS cval_lineitem_l_commitdate_4#2419, cval_lineitem_l_receiptdate#2387 AS cval_lineitem_l_receiptdate_4#2420, cval_lineitem_l_shipinstruct#2388 AS cval_lineitem_l_shipinstruct_4#2421, cval_lineitem_l_shipmode#2389 AS cval_lineitem_l_shipmode_4#2422, cval_lineitem_l_comment#2390 AS cval_lineitem_l_comment_4#2423, cval_lineitem_l_shipdate#2391 AS cval_lineitem_l_shipdate_4#2424, cl_quantity#2392 AS cl_quantity_4#2425, cl_extendedprice#2393 AS cl_extendedprice_4#2426, cl_discount#2394 AS cl_discount_4#2427, ... 9 more fields]
            :     +- Relation[rid#2371,cpfk_orders_lineitem#2372,cpfk_supplier_lineitem#2373,cfpk_lineitem_supplier#2374,cfpk_lineitem_partsupp#2375,cpfk_part_lineitem#2376,cfpk_lineitem_part#2377,cpfk_partsupp_lineitem#2378,cfpk_lineitem_orders#2379,cval_lineitem_l_quantity#2380,cval_lineitem_l_extendedprice#2381,cval_lineitem_l_discount#2382,cval_lineitem_l_tax#2383,cval_lineitem_l_returnflag#2384,cval_lineitem_l_linestatus#2385,cval_lineitem_l_commitdate#2386,cval_lineitem_l_receiptdate#2387,cval_lineitem_l_shipinstruct#2388,cval_lineitem_l_shipmode#2389,cval_lineitem_l_comment#2390,cval_lineitem_l_shipdate#2391,cl_quantity#2392,cl_extendedprice#2393,cl_discount#2394,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#2525 AS rid_5#2542, cpfk_customer_orders#2526 AS cpfk_customer_orders_5#2543, cfpk_orders_customer#2527 AS cfpk_orders_customer_5#2544, cval_orders_o_orderstatus#2528 AS cval_orders_o_orderstatus_5#2545, cval_orders_o_totalprice#2529 AS cval_orders_o_totalprice_5#2546, cval_orders_o_orderpriority#2530 AS cval_orders_o_orderpriority_5#2547, cval_orders_o_clerk#2531 AS cval_orders_o_clerk_5#2548, cval_orders_o_shippriority#2532 AS cval_orders_o_shippriority_5#2549, cval_orders_o_comment#2533 AS cval_orders_o_comment_5#2550, cval_orders_o_orderdate#2534 AS cval_orders_o_orderdate_5#2551, co_orderstatus#2535 AS co_orderstatus_5#2552, co_totalprice#2536 AS co_totalprice_5#2553, co_orderpriority#2537 AS co_orderpriority_5#2554, co_clerk#2538 AS co_clerk_5#2555, co_shippriority#2539 AS co_shippriority_5#2556, co_comment#2540 AS co_comment_5#2557, co_orderdate#2541 AS co_orderdate_5#2558]
               +- Relation[rid#2525,cpfk_customer_orders#2526,cfpk_orders_customer#2527,cval_orders_o_orderstatus#2528,cval_orders_o_totalprice#2529,cval_orders_o_orderpriority#2530,cval_orders_o_clerk#2531,cval_orders_o_shippriority#2532,cval_orders_o_comment#2533,cval_orders_o_orderdate#2534,co_orderstatus#2535,co_totalprice#2536,co_orderpriority#2537,co_clerk#2538,co_shippriority#2539,co_comment#2540,co_orderdate#2541] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 177014ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/15 16:18:57 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:18:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2664L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:18:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:18:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:18:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:18:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:18:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:18:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:18:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:18:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:18:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:18:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:18:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:18:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:18:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:18:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:18:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:18:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2664L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#2666 AS rid_0#2683, cval_part_p_name#2667 AS cval_part_p_name_0#2684, cval_part_p_mfgr#2668 AS cval_part_p_mfgr_0#2685, cval_part_p_type#2669 AS cval_part_p_type_0#2686, cval_part_p_size#2670 AS cval_part_p_size_0#2687, cval_part_p_container#2671 AS cval_part_p_container_0#2688, cval_part_p_retailprice#2672 AS cval_part_p_retailprice_0#2689, cval_part_p_comment#2673 AS cval_part_p_comment_0#2690, cval_part_p_brand#2674 AS cval_part_p_brand_0#2691, cp_name#2675 AS cp_name_0#2692, cp_mfgr#2676 AS cp_mfgr_0#2693, cp_type#2677 AS cp_type_0#2694, cp_size#2678 AS cp_size_0#2695, cp_container#2679 AS cp_container_0#2696, cp_retailprice#2680 AS cp_retailprice_0#2697, cp_comment#2681 AS cp_comment_0#2698, cp_brand#2682 AS cp_brand_0#2699]
            :     :     :  :  :  :  +- Relation[rid#2666,cval_part_p_name#2667,cval_part_p_mfgr#2668,cval_part_p_type#2669,cval_part_p_size#2670,cval_part_p_container#2671,cval_part_p_retailprice#2672,cval_part_p_comment#2673,cval_part_p_brand#2674,cp_name#2675,cp_mfgr#2676,cp_type#2677,cp_size#2678,cp_container#2679,cp_retailprice#2680,cp_comment#2681,cp_brand#2682] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#2700 AS rid_0#2717, cval_part_p_name#2701 AS cval_part_p_name_0#2718, cval_part_p_mfgr#2702 AS cval_part_p_mfgr_0#2719, cval_part_p_type#2703 AS cval_part_p_type_0#2720, cval_part_p_size#2704 AS cval_part_p_size_0#2721, cval_part_p_container#2705 AS cval_part_p_container_0#2722, cval_part_p_retailprice#2706 AS cval_part_p_retailprice_0#2723, cval_part_p_comment#2707 AS cval_part_p_comment_0#2724, cval_part_p_brand#2708 AS cval_part_p_brand_0#2725, cp_name#2709 AS cp_name_0#2726, cp_mfgr#2710 AS cp_mfgr_0#2727, cp_type#2711 AS cp_type_0#2728, cp_size#2712 AS cp_size_0#2729, cp_container#2713 AS cp_container_0#2730, cp_retailprice#2714 AS cp_retailprice_0#2731, cp_comment#2715 AS cp_comment_0#2732, cp_brand#2716 AS cp_brand_0#2733]
            :     :     :  :  :        +- Relation[rid#2700,cval_part_p_name#2701,cval_part_p_mfgr#2702,cval_part_p_type#2703,cval_part_p_size#2704,cval_part_p_container#2705,cval_part_p_retailprice#2706,cval_part_p_comment#2707,cval_part_p_brand#2708,cp_name#2709,cp_mfgr#2710,cp_type#2711,cp_size#2712,cp_container#2713,cp_retailprice#2714,cp_comment#2715,cp_brand#2716] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- Project [rid#2834 AS rid_1#2867, cpfk_orders_lineitem#2835 AS cpfk_orders_lineitem_1#2868, cpfk_supplier_lineitem#2836 AS cpfk_supplier_lineitem_1#2869, cfpk_lineitem_supplier#2837 AS cfpk_lineitem_supplier_1#2870, cfpk_lineitem_partsupp#2838 AS cfpk_lineitem_partsupp_1#2871, cpfk_part_lineitem#2839 AS cpfk_part_lineitem_1#2872, cfpk_lineitem_part#2840 AS cfpk_lineitem_part_1#2873, cpfk_partsupp_lineitem#2841 AS cpfk_partsupp_lineitem_1#2874, cfpk_lineitem_orders#2842 AS cfpk_lineitem_orders_1#2875, cval_lineitem_l_quantity#2843 AS cval_lineitem_l_quantity_1#2876, cval_lineitem_l_extendedprice#2844 AS cval_lineitem_l_extendedprice_1#2877, cval_lineitem_l_discount#2845 AS cval_lineitem_l_discount_1#2878, cval_lineitem_l_tax#2846 AS cval_lineitem_l_tax_1#2879, cval_lineitem_l_returnflag#2847 AS cval_lineitem_l_returnflag_1#2880, cval_lineitem_l_linestatus#2848 AS cval_lineitem_l_linestatus_1#2881, cval_lineitem_l_commitdate#2849 AS cval_lineitem_l_commitdate_1#2882, cval_lineitem_l_receiptdate#2850 AS cval_lineitem_l_receiptdate_1#2883, cval_lineitem_l_shipinstruct#2851 AS cval_lineitem_l_shipinstruct_1#2884, cval_lineitem_l_shipmode#2852 AS cval_lineitem_l_shipmode_1#2885, cval_lineitem_l_comment#2853 AS cval_lineitem_l_comment_1#2886, cval_lineitem_l_shipdate#2854 AS cval_lineitem_l_shipdate_1#2887, cl_quantity#2855 AS cl_quantity_1#2888, cl_extendedprice#2856 AS cl_extendedprice_1#2889, cl_discount#2857 AS cl_discount_1#2890, ... 9 more fields]
            :     :     :  :     +- Relation[rid#2834,cpfk_orders_lineitem#2835,cpfk_supplier_lineitem#2836,cfpk_lineitem_supplier#2837,cfpk_lineitem_partsupp#2838,cpfk_part_lineitem#2839,cfpk_lineitem_part#2840,cpfk_partsupp_lineitem#2841,cfpk_lineitem_orders#2842,cval_lineitem_l_quantity#2843,cval_lineitem_l_extendedprice#2844,cval_lineitem_l_discount#2845,cval_lineitem_l_tax#2846,cval_lineitem_l_returnflag#2847,cval_lineitem_l_linestatus#2848,cval_lineitem_l_commitdate#2849,cval_lineitem_l_receiptdate#2850,cval_lineitem_l_shipinstruct#2851,cval_lineitem_l_shipmode#2852,cval_lineitem_l_comment#2853,cval_lineitem_l_shipdate#2854,cl_quantity#2855,cl_extendedprice#2856,cl_discount#2857,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#2734 AS rid_1#2767, cpfk_orders_lineitem#2735 AS cpfk_orders_lineitem_1#2768, cpfk_supplier_lineitem#2736 AS cpfk_supplier_lineitem_1#2769, cfpk_lineitem_supplier#2737 AS cfpk_lineitem_supplier_1#2770, cfpk_lineitem_partsupp#2738 AS cfpk_lineitem_partsupp_1#2771, cpfk_part_lineitem#2739 AS cpfk_part_lineitem_1#2772, cfpk_lineitem_part#2740 AS cfpk_lineitem_part_1#2773, cpfk_partsupp_lineitem#2741 AS cpfk_partsupp_lineitem_1#2774, cfpk_lineitem_orders#2742 AS cfpk_lineitem_orders_1#2775, cval_lineitem_l_quantity#2743 AS cval_lineitem_l_quantity_1#2776, cval_lineitem_l_extendedprice#2744 AS cval_lineitem_l_extendedprice_1#2777, cval_lineitem_l_discount#2745 AS cval_lineitem_l_discount_1#2778, cval_lineitem_l_tax#2746 AS cval_lineitem_l_tax_1#2779, cval_lineitem_l_returnflag#2747 AS cval_lineitem_l_returnflag_1#2780, cval_lineitem_l_linestatus#2748 AS cval_lineitem_l_linestatus_1#2781, cval_lineitem_l_commitdate#2749 AS cval_lineitem_l_commitdate_1#2782, cval_lineitem_l_receiptdate#2750 AS cval_lineitem_l_receiptdate_1#2783, cval_lineitem_l_shipinstruct#2751 AS cval_lineitem_l_shipinstruct_1#2784, cval_lineitem_l_shipmode#2752 AS cval_lineitem_l_shipmode_1#2785, cval_lineitem_l_comment#2753 AS cval_lineitem_l_comment_1#2786, cval_lineitem_l_shipdate#2754 AS cval_lineitem_l_shipdate_1#2787, cl_quantity#2755 AS cl_quantity_1#2788, cl_extendedprice#2756 AS cl_extendedprice_1#2789, cl_discount#2757 AS cl_discount_1#2790, ... 9 more fields]
            :     :     :     +- Relation[rid#2734,cpfk_orders_lineitem#2735,cpfk_supplier_lineitem#2736,cfpk_lineitem_supplier#2737,cfpk_lineitem_partsupp#2738,cpfk_part_lineitem#2739,cfpk_lineitem_part#2740,cpfk_partsupp_lineitem#2741,cfpk_lineitem_orders#2742,cval_lineitem_l_quantity#2743,cval_lineitem_l_extendedprice#2744,cval_lineitem_l_discount#2745,cval_lineitem_l_tax#2746,cval_lineitem_l_returnflag#2747,cval_lineitem_l_linestatus#2748,cval_lineitem_l_commitdate#2749,cval_lineitem_l_receiptdate#2750,cval_lineitem_l_shipinstruct#2751,cval_lineitem_l_shipmode#2752,cval_lineitem_l_comment#2753,cval_lineitem_l_shipdate#2754,cl_quantity#2755,cl_extendedprice#2756,cl_discount#2757,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#2900 AS rid_2#2913, cpfk_nation_supplier#2901 AS cpfk_nation_supplier_2#2914, cfpk_supplier_nation#2902 AS cfpk_supplier_nation_2#2915, cval_supplier_s_name#2903 AS cval_supplier_s_name_2#2916, cval_supplier_s_address#2904 AS cval_supplier_s_address_2#2917, cval_supplier_s_phone#2905 AS cval_supplier_s_phone_2#2918, cval_supplier_s_acctbal#2906 AS cval_supplier_s_acctbal_2#2919, cval_supplier_s_comment#2907 AS cval_supplier_s_comment_2#2920, cs_name#2908 AS cs_name_2#2921, cs_address#2909 AS cs_address_2#2922, cs_phone#2910 AS cs_phone_2#2923, cs_acctbal#2911 AS cs_acctbal_2#2924, cs_comment#2912 AS cs_comment_2#2925]
            :     :        +- Relation[rid#2900,cpfk_nation_supplier#2901,cfpk_supplier_nation#2902,cval_supplier_s_name#2903,cval_supplier_s_address#2904,cval_supplier_s_phone#2905,cval_supplier_s_acctbal#2906,cval_supplier_s_comment#2907,cs_name#2908,cs_address#2909,cs_phone#2910,cs_acctbal#2911,cs_comment#2912] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#2926 AS rid_3#2933, cpfk_region_nation#2927 AS cpfk_region_nation_3#2934, cfpk_nation_region#2928 AS cfpk_nation_region_3#2935, cval_nation_n_name#2929 AS cval_nation_n_name_3#2936, cval_nation_n_comment#2930 AS cval_nation_n_comment_3#2937, cn_name#2931 AS cn_name_3#2938, cn_comment#2932 AS cn_comment_3#2939]
            :        +- Relation[rid#2926,cpfk_region_nation#2927,cfpk_nation_region#2928,cval_nation_n_name#2929,cval_nation_n_comment#2930,cn_name#2931,cn_comment#2932] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#2940 AS rid_4#2945, cval_region_r_name#2941 AS cval_region_r_name_4#2946, cval_region_r_comment#2942 AS cval_region_r_comment_4#2947, cr_name#2943 AS cr_name_4#2948, cr_comment#2944 AS cr_comment_4#2949]
               :  :  :  :  :  :  :  +- Relation[rid#2940,cval_region_r_name#2941,cval_region_r_comment#2942,cr_name#2943,cr_comment#2944] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#2950 AS rid_4#2955, cval_region_r_name#2951 AS cval_region_r_name_4#2956, cval_region_r_comment#2952 AS cval_region_r_comment_4#2957, cr_name#2953 AS cr_name_4#2958, cr_comment#2954 AS cr_comment_4#2959]
               :  :  :  :  :  :        +- Relation[rid#2950,cval_region_r_name#2951,cval_region_r_comment#2952,cr_name#2953,cr_comment#2954] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- Project [rid#2984 AS rid_5#2991, cpfk_region_nation#2985 AS cpfk_region_nation_5#2992, cfpk_nation_region#2986 AS cfpk_nation_region_5#2993, cval_nation_n_name#2987 AS cval_nation_n_name_5#2994, cval_nation_n_comment#2988 AS cval_nation_n_comment_5#2995, cn_name#2989 AS cn_name_5#2996, cn_comment#2990 AS cn_comment_5#2997]
               :  :  :  :  :     +- Relation[rid#2984,cpfk_region_nation#2985,cfpk_nation_region#2986,cval_nation_n_name#2987,cval_nation_n_comment#2988,cn_name#2989,cn_comment#2990] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#2960 AS rid_5#2967, cpfk_region_nation#2961 AS cpfk_region_nation_5#2968, cfpk_nation_region#2962 AS cfpk_nation_region_5#2969, cval_nation_n_name#2963 AS cval_nation_n_name_5#2970, cval_nation_n_comment#2964 AS cval_nation_n_comment_5#2971, cn_name#2965 AS cn_name_5#2972, cn_comment#2966 AS cn_comment_5#2973]
               :  :  :  :     +- Relation[rid#2960,cpfk_region_nation#2961,cfpk_nation_region#2962,cval_nation_n_name#2963,cval_nation_n_comment#2964,cn_name#2965,cn_comment#2966] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#3042 AS rid_6#3057, cpfk_nation_customer#3043 AS cpfk_nation_customer_6#3058, cfpk_customer_nation#3044 AS cfpk_customer_nation_6#3059, cval_customer_c_name#3045 AS cval_customer_c_name_6#3060, cval_customer_c_address#3046 AS cval_customer_c_address_6#3061, cval_customer_c_phone#3047 AS cval_customer_c_phone_6#3062, cval_customer_c_acctbal#3048 AS cval_customer_c_acctbal_6#3063, cval_customer_c_comment#3049 AS cval_customer_c_comment_6#3064, cval_customer_c_mktsegment#3050 AS cval_customer_c_mktsegment_6#3065, cc_name#3051 AS cc_name_6#3066, cc_address#3052 AS cc_address_6#3067, cc_phone#3053 AS cc_phone_6#3068, cc_acctbal#3054 AS cc_acctbal_6#3069, cc_comment#3055 AS cc_comment_6#3070, cc_mktsegment#3056 AS cc_mktsegment_6#3071]
               :  :  :     +- Relation[rid#3042,cpfk_nation_customer#3043,cfpk_customer_nation#3044,cval_customer_c_name#3045,cval_customer_c_address#3046,cval_customer_c_phone#3047,cval_customer_c_acctbal#3048,cval_customer_c_comment#3049,cval_customer_c_mktsegment#3050,cc_name#3051,cc_address#3052,cc_phone#3053,cc_acctbal#3054,cc_comment#3055,cc_mktsegment#3056] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#2998 AS rid_6#3013, cpfk_nation_customer#2999 AS cpfk_nation_customer_6#3014, cfpk_customer_nation#3000 AS cfpk_customer_nation_6#3015, cval_customer_c_name#3001 AS cval_customer_c_name_6#3016, cval_customer_c_address#3002 AS cval_customer_c_address_6#3017, cval_customer_c_phone#3003 AS cval_customer_c_phone_6#3018, cval_customer_c_acctbal#3004 AS cval_customer_c_acctbal_6#3019, cval_customer_c_comment#3005 AS cval_customer_c_comment_6#3020, cval_customer_c_mktsegment#3006 AS cval_customer_c_mktsegment_6#3021, cc_name#3007 AS cc_name_6#3022, cc_address#3008 AS cc_address_6#3023, cc_phone#3009 AS cc_phone_6#3024, cc_acctbal#3010 AS cc_acctbal_6#3025, cc_comment#3011 AS cc_comment_6#3026, cc_mktsegment#3012 AS cc_mktsegment_6#3027]
               :  :     +- Relation[rid#2998,cpfk_nation_customer#2999,cfpk_customer_nation#3000,cval_customer_c_name#3001,cval_customer_c_address#3002,cval_customer_c_phone#3003,cval_customer_c_acctbal#3004,cval_customer_c_comment#3005,cval_customer_c_mktsegment#3006,cc_name#3007,cc_address#3008,cc_phone#3009,cc_acctbal#3010,cc_comment#3011,cc_mktsegment#3012] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#3136 AS rid_7#3153, cpfk_customer_orders#3137 AS cpfk_customer_orders_7#3154, cfpk_orders_customer#3138 AS cfpk_orders_customer_7#3155, cval_orders_o_orderstatus#3139 AS cval_orders_o_orderstatus_7#3156, cval_orders_o_totalprice#3140 AS cval_orders_o_totalprice_7#3157, cval_orders_o_orderpriority#3141 AS cval_orders_o_orderpriority_7#3158, cval_orders_o_clerk#3142 AS cval_orders_o_clerk_7#3159, cval_orders_o_shippriority#3143 AS cval_orders_o_shippriority_7#3160, cval_orders_o_comment#3144 AS cval_orders_o_comment_7#3161, cval_orders_o_orderdate#3145 AS cval_orders_o_orderdate_7#3162, co_orderstatus#3146 AS co_orderstatus_7#3163, co_totalprice#3147 AS co_totalprice_7#3164, co_orderpriority#3148 AS co_orderpriority_7#3165, co_clerk#3149 AS co_clerk_7#3166, co_shippriority#3150 AS co_shippriority_7#3167, co_comment#3151 AS co_comment_7#3168, co_orderdate#3152 AS co_orderdate_7#3169]
               :     +- Relation[rid#3136,cpfk_customer_orders#3137,cfpk_orders_customer#3138,cval_orders_o_orderstatus#3139,cval_orders_o_totalprice#3140,cval_orders_o_orderpriority#3141,cval_orders_o_clerk#3142,cval_orders_o_shippriority#3143,cval_orders_o_comment#3144,cval_orders_o_orderdate#3145,co_orderstatus#3146,co_totalprice#3147,co_orderpriority#3148,co_clerk#3149,co_shippriority#3150,co_comment#3151,co_orderdate#3152] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#3072 AS rid_7#3089, cpfk_customer_orders#3073 AS cpfk_customer_orders_7#3090, cfpk_orders_customer#3074 AS cfpk_orders_customer_7#3091, cval_orders_o_orderstatus#3075 AS cval_orders_o_orderstatus_7#3092, cval_orders_o_totalprice#3076 AS cval_orders_o_totalprice_7#3093, cval_orders_o_orderpriority#3077 AS cval_orders_o_orderpriority_7#3094, cval_orders_o_clerk#3078 AS cval_orders_o_clerk_7#3095, cval_orders_o_shippriority#3079 AS cval_orders_o_shippriority_7#3096, cval_orders_o_comment#3080 AS cval_orders_o_comment_7#3097, cval_orders_o_orderdate#3081 AS cval_orders_o_orderdate_7#3098, co_orderstatus#3082 AS co_orderstatus_7#3099, co_totalprice#3083 AS co_totalprice_7#3100, co_orderpriority#3084 AS co_orderpriority_7#3101, co_clerk#3085 AS co_clerk_7#3102, co_shippriority#3086 AS co_shippriority_7#3103, co_comment#3087 AS co_comment_7#3104, co_orderdate#3088 AS co_orderdate_7#3105]
                  +- Relation[rid#3072,cpfk_customer_orders#3073,cfpk_orders_customer#3074,cval_orders_o_orderstatus#3075,cval_orders_o_totalprice#3076,cval_orders_o_orderpriority#3077,cval_orders_o_clerk#3078,cval_orders_o_shippriority#3079,cval_orders_o_comment#3080,cval_orders_o_orderdate#3081,co_orderstatus#3082,co_totalprice#3083,co_orderpriority#3084,co_clerk#3085,co_shippriority#3086,co_comment#3087,co_orderdate#3088] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 2462ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/15 16:18:59 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:18:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3291L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:18:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:18:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:18:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:18:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3291L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#3293 AS rid_0#3306, cpfk_nation_supplier#3294 AS cpfk_nation_supplier_0#3307, cfpk_supplier_nation#3295 AS cfpk_supplier_nation_0#3308, cval_supplier_s_name#3296 AS cval_supplier_s_name_0#3309, cval_supplier_s_address#3297 AS cval_supplier_s_address_0#3310, cval_supplier_s_phone#3298 AS cval_supplier_s_phone_0#3311, cval_supplier_s_acctbal#3299 AS cval_supplier_s_acctbal_0#3312, cval_supplier_s_comment#3300 AS cval_supplier_s_comment_0#3313, cs_name#3301 AS cs_name_0#3314, cs_address#3302 AS cs_address_0#3315, cs_phone#3303 AS cs_phone_0#3316, cs_acctbal#3304 AS cs_acctbal_0#3317, cs_comment#3305 AS cs_comment_0#3318]
         :  :  +- Relation[rid#3293,cpfk_nation_supplier#3294,cfpk_supplier_nation#3295,cval_supplier_s_name#3296,cval_supplier_s_address#3297,cval_supplier_s_phone#3298,cval_supplier_s_acctbal#3299,cval_supplier_s_comment#3300,cs_name#3301,cs_address#3302,cs_phone#3303,cs_acctbal#3304,cs_comment#3305] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#3385 AS rid_0#3398, cpfk_nation_supplier#3386 AS cpfk_nation_supplier_0#3399, cfpk_supplier_nation#3387 AS cfpk_supplier_nation_0#3400, cval_supplier_s_name#3388 AS cval_supplier_s_name_0#3401, cval_supplier_s_address#3389 AS cval_supplier_s_address_0#3402, cval_supplier_s_phone#3390 AS cval_supplier_s_phone_0#3403, cval_supplier_s_acctbal#3391 AS cval_supplier_s_acctbal_0#3404, cval_supplier_s_comment#3392 AS cval_supplier_s_comment_0#3405, cs_name#3393 AS cs_name_0#3406, cs_address#3394 AS cs_address_0#3407, cs_phone#3395 AS cs_phone_0#3408, cs_acctbal#3396 AS cs_acctbal_0#3409, cs_comment#3397 AS cs_comment_0#3410]
         :     :  +- Relation[rid#3385,cpfk_nation_supplier#3386,cfpk_supplier_nation#3387,cval_supplier_s_name#3388,cval_supplier_s_address#3389,cval_supplier_s_phone#3390,cval_supplier_s_acctbal#3391,cval_supplier_s_comment#3392,cs_name#3393,cs_address#3394,cs_phone#3395,cs_acctbal#3396,cs_comment#3397] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#3411 AS rid_1#3444, cpfk_orders_lineitem#3412 AS cpfk_orders_lineitem_1#3445, cpfk_supplier_lineitem#3413 AS cpfk_supplier_lineitem_1#3446, cfpk_lineitem_supplier#3414 AS cfpk_lineitem_supplier_1#3447, cfpk_lineitem_partsupp#3415 AS cfpk_lineitem_partsupp_1#3448, cpfk_part_lineitem#3416 AS cpfk_part_lineitem_1#3449, cfpk_lineitem_part#3417 AS cfpk_lineitem_part_1#3450, cpfk_partsupp_lineitem#3418 AS cpfk_partsupp_lineitem_1#3451, cfpk_lineitem_orders#3419 AS cfpk_lineitem_orders_1#3452, cval_lineitem_l_quantity#3420 AS cval_lineitem_l_quantity_1#3453, cval_lineitem_l_extendedprice#3421 AS cval_lineitem_l_extendedprice_1#3454, cval_lineitem_l_discount#3422 AS cval_lineitem_l_discount_1#3455, cval_lineitem_l_tax#3423 AS cval_lineitem_l_tax_1#3456, cval_lineitem_l_returnflag#3424 AS cval_lineitem_l_returnflag_1#3457, cval_lineitem_l_linestatus#3425 AS cval_lineitem_l_linestatus_1#3458, cval_lineitem_l_commitdate#3426 AS cval_lineitem_l_commitdate_1#3459, cval_lineitem_l_receiptdate#3427 AS cval_lineitem_l_receiptdate_1#3460, cval_lineitem_l_shipinstruct#3428 AS cval_lineitem_l_shipinstruct_1#3461, cval_lineitem_l_shipmode#3429 AS cval_lineitem_l_shipmode_1#3462, cval_lineitem_l_comment#3430 AS cval_lineitem_l_comment_1#3463, cval_lineitem_l_shipdate#3431 AS cval_lineitem_l_shipdate_1#3464, cl_quantity#3432 AS cl_quantity_1#3465, cl_extendedprice#3433 AS cl_extendedprice_1#3466, cl_discount#3434 AS cl_discount_1#3467, ... 9 more fields]
         :        +- Relation[rid#3411,cpfk_orders_lineitem#3412,cpfk_supplier_lineitem#3413,cfpk_lineitem_supplier#3414,cfpk_lineitem_partsupp#3415,cpfk_part_lineitem#3416,cfpk_lineitem_part#3417,cpfk_partsupp_lineitem#3418,cfpk_lineitem_orders#3419,cval_lineitem_l_quantity#3420,cval_lineitem_l_extendedprice#3421,cval_lineitem_l_discount#3422,cval_lineitem_l_tax#3423,cval_lineitem_l_returnflag#3424,cval_lineitem_l_linestatus#3425,cval_lineitem_l_commitdate#3426,cval_lineitem_l_receiptdate#3427,cval_lineitem_l_shipinstruct#3428,cval_lineitem_l_shipmode#3429,cval_lineitem_l_comment#3430,cval_lineitem_l_shipdate#3431,cl_quantity#3432,cl_extendedprice#3433,cl_discount#3434,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#3319 AS rid_1#3352, cpfk_orders_lineitem#3320 AS cpfk_orders_lineitem_1#3353, cpfk_supplier_lineitem#3321 AS cpfk_supplier_lineitem_1#3354, cfpk_lineitem_supplier#3322 AS cfpk_lineitem_supplier_1#3355, cfpk_lineitem_partsupp#3323 AS cfpk_lineitem_partsupp_1#3356, cpfk_part_lineitem#3324 AS cpfk_part_lineitem_1#3357, cfpk_lineitem_part#3325 AS cfpk_lineitem_part_1#3358, cpfk_partsupp_lineitem#3326 AS cpfk_partsupp_lineitem_1#3359, cfpk_lineitem_orders#3327 AS cfpk_lineitem_orders_1#3360, cval_lineitem_l_quantity#3328 AS cval_lineitem_l_quantity_1#3361, cval_lineitem_l_extendedprice#3329 AS cval_lineitem_l_extendedprice_1#3362, cval_lineitem_l_discount#3330 AS cval_lineitem_l_discount_1#3363, cval_lineitem_l_tax#3331 AS cval_lineitem_l_tax_1#3364, cval_lineitem_l_returnflag#3332 AS cval_lineitem_l_returnflag_1#3365, cval_lineitem_l_linestatus#3333 AS cval_lineitem_l_linestatus_1#3366, cval_lineitem_l_commitdate#3334 AS cval_lineitem_l_commitdate_1#3367, cval_lineitem_l_receiptdate#3335 AS cval_lineitem_l_receiptdate_1#3368, cval_lineitem_l_shipinstruct#3336 AS cval_lineitem_l_shipinstruct_1#3369, cval_lineitem_l_shipmode#3337 AS cval_lineitem_l_shipmode_1#3370, cval_lineitem_l_comment#3338 AS cval_lineitem_l_comment_1#3371, cval_lineitem_l_shipdate#3339 AS cval_lineitem_l_shipdate_1#3372, cl_quantity#3340 AS cl_quantity_1#3373, cl_extendedprice#3341 AS cl_extendedprice_1#3374, cl_discount#3342 AS cl_discount_1#3375, ... 9 more fields]
            +- Relation[rid#3319,cpfk_orders_lineitem#3320,cpfk_supplier_lineitem#3321,cfpk_lineitem_supplier#3322,cfpk_lineitem_partsupp#3323,cpfk_part_lineitem#3324,cfpk_lineitem_part#3325,cpfk_partsupp_lineitem#3326,cfpk_lineitem_orders#3327,cval_lineitem_l_quantity#3328,cval_lineitem_l_extendedprice#3329,cval_lineitem_l_discount#3330,cval_lineitem_l_tax#3331,cval_lineitem_l_returnflag#3332,cval_lineitem_l_linestatus#3333,cval_lineitem_l_commitdate#3334,cval_lineitem_l_receiptdate#3335,cval_lineitem_l_shipinstruct#3336,cval_lineitem_l_shipmode#3337,cval_lineitem_l_comment#3338,cval_lineitem_l_shipdate#3339,cl_quantity#3340,cl_extendedprice#3341,cl_discount#3342,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 99376ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/15 16:20:38 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:20:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3527L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:20:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3527L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#3529 AS rid_0#3562, cpfk_orders_lineitem#3530 AS cpfk_orders_lineitem_0#3563, cpfk_supplier_lineitem#3531 AS cpfk_supplier_lineitem_0#3564, cfpk_lineitem_supplier#3532 AS cfpk_lineitem_supplier_0#3565, cfpk_lineitem_partsupp#3533 AS cfpk_lineitem_partsupp_0#3566, cpfk_part_lineitem#3534 AS cpfk_part_lineitem_0#3567, cfpk_lineitem_part#3535 AS cfpk_lineitem_part_0#3568, cpfk_partsupp_lineitem#3536 AS cpfk_partsupp_lineitem_0#3569, cfpk_lineitem_orders#3537 AS cfpk_lineitem_orders_0#3570, cval_lineitem_l_quantity#3538 AS cval_lineitem_l_quantity_0#3571, cval_lineitem_l_extendedprice#3539 AS cval_lineitem_l_extendedprice_0#3572, cval_lineitem_l_discount#3540 AS cval_lineitem_l_discount_0#3573, cval_lineitem_l_tax#3541 AS cval_lineitem_l_tax_0#3574, cval_lineitem_l_returnflag#3542 AS cval_lineitem_l_returnflag_0#3575, cval_lineitem_l_linestatus#3543 AS cval_lineitem_l_linestatus_0#3576, cval_lineitem_l_commitdate#3544 AS cval_lineitem_l_commitdate_0#3577, cval_lineitem_l_receiptdate#3545 AS cval_lineitem_l_receiptdate_0#3578, cval_lineitem_l_shipinstruct#3546 AS cval_lineitem_l_shipinstruct_0#3579, cval_lineitem_l_shipmode#3547 AS cval_lineitem_l_shipmode_0#3580, cval_lineitem_l_comment#3548 AS cval_lineitem_l_comment_0#3581, cval_lineitem_l_shipdate#3549 AS cval_lineitem_l_shipdate_0#3582, cl_quantity#3550 AS cl_quantity_0#3583, cl_extendedprice#3551 AS cl_extendedprice_0#3584, cl_discount#3552 AS cl_discount_0#3585, ... 9 more fields]
            :  :  +- Relation[rid#3529,cpfk_orders_lineitem#3530,cpfk_supplier_lineitem#3531,cfpk_lineitem_supplier#3532,cfpk_lineitem_partsupp#3533,cpfk_part_lineitem#3534,cfpk_lineitem_part#3535,cpfk_partsupp_lineitem#3536,cfpk_lineitem_orders#3537,cval_lineitem_l_quantity#3538,cval_lineitem_l_extendedprice#3539,cval_lineitem_l_discount#3540,cval_lineitem_l_tax#3541,cval_lineitem_l_returnflag#3542,cval_lineitem_l_linestatus#3543,cval_lineitem_l_commitdate#3544,cval_lineitem_l_receiptdate#3545,cval_lineitem_l_shipinstruct#3546,cval_lineitem_l_shipmode#3547,cval_lineitem_l_comment#3548,cval_lineitem_l_shipdate#3549,cl_quantity#3550,cl_extendedprice#3551,cl_discount#3552,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#3595 AS rid_0#3628, cpfk_orders_lineitem#3596 AS cpfk_orders_lineitem_0#3629, cpfk_supplier_lineitem#3597 AS cpfk_supplier_lineitem_0#3630, cfpk_lineitem_supplier#3598 AS cfpk_lineitem_supplier_0#3631, cfpk_lineitem_partsupp#3599 AS cfpk_lineitem_partsupp_0#3632, cpfk_part_lineitem#3600 AS cpfk_part_lineitem_0#3633, cfpk_lineitem_part#3601 AS cfpk_lineitem_part_0#3634, cpfk_partsupp_lineitem#3602 AS cpfk_partsupp_lineitem_0#3635, cfpk_lineitem_orders#3603 AS cfpk_lineitem_orders_0#3636, cval_lineitem_l_quantity#3604 AS cval_lineitem_l_quantity_0#3637, cval_lineitem_l_extendedprice#3605 AS cval_lineitem_l_extendedprice_0#3638, cval_lineitem_l_discount#3606 AS cval_lineitem_l_discount_0#3639, cval_lineitem_l_tax#3607 AS cval_lineitem_l_tax_0#3640, cval_lineitem_l_returnflag#3608 AS cval_lineitem_l_returnflag_0#3641, cval_lineitem_l_linestatus#3609 AS cval_lineitem_l_linestatus_0#3642, cval_lineitem_l_commitdate#3610 AS cval_lineitem_l_commitdate_0#3643, cval_lineitem_l_receiptdate#3611 AS cval_lineitem_l_receiptdate_0#3644, cval_lineitem_l_shipinstruct#3612 AS cval_lineitem_l_shipinstruct_0#3645, cval_lineitem_l_shipmode#3613 AS cval_lineitem_l_shipmode_0#3646, cval_lineitem_l_comment#3614 AS cval_lineitem_l_comment_0#3647, cval_lineitem_l_shipdate#3615 AS cval_lineitem_l_shipdate_0#3648, cl_quantity#3616 AS cl_quantity_0#3649, cl_extendedprice#3617 AS cl_extendedprice_0#3650, cl_discount#3618 AS cl_discount_0#3651, ... 9 more fields]
            :        +- Relation[rid#3595,cpfk_orders_lineitem#3596,cpfk_supplier_lineitem#3597,cfpk_lineitem_supplier#3598,cfpk_lineitem_partsupp#3599,cpfk_part_lineitem#3600,cfpk_lineitem_part#3601,cpfk_partsupp_lineitem#3602,cfpk_lineitem_orders#3603,cval_lineitem_l_quantity#3604,cval_lineitem_l_extendedprice#3605,cval_lineitem_l_discount#3606,cval_lineitem_l_tax#3607,cval_lineitem_l_returnflag#3608,cval_lineitem_l_linestatus#3609,cval_lineitem_l_commitdate#3610,cval_lineitem_l_receiptdate#3611,cval_lineitem_l_shipinstruct#3612,cval_lineitem_l_shipmode#3613,cval_lineitem_l_comment#3614,cval_lineitem_l_shipdate#3615,cl_quantity#3616,cl_extendedprice#3617,cl_discount#3618,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#3661 AS rid_1#3678, cpfk_customer_orders#3662 AS cpfk_customer_orders_1#3679, cfpk_orders_customer#3663 AS cfpk_orders_customer_1#3680, cval_orders_o_orderstatus#3664 AS cval_orders_o_orderstatus_1#3681, cval_orders_o_totalprice#3665 AS cval_orders_o_totalprice_1#3682, cval_orders_o_orderpriority#3666 AS cval_orders_o_orderpriority_1#3683, cval_orders_o_clerk#3667 AS cval_orders_o_clerk_1#3684, cval_orders_o_shippriority#3668 AS cval_orders_o_shippriority_1#3685, cval_orders_o_comment#3669 AS cval_orders_o_comment_1#3686, cval_orders_o_orderdate#3670 AS cval_orders_o_orderdate_1#3687, co_orderstatus#3671 AS co_orderstatus_1#3688, co_totalprice#3672 AS co_totalprice_1#3689, co_orderpriority#3673 AS co_orderpriority_1#3690, co_clerk#3674 AS co_clerk_1#3691, co_shippriority#3675 AS co_shippriority_1#3692, co_comment#3676 AS co_comment_1#3693, co_orderdate#3677 AS co_orderdate_1#3694]
               +- Relation[rid#3661,cpfk_customer_orders#3662,cfpk_orders_customer#3663,cval_orders_o_orderstatus#3664,cval_orders_o_totalprice#3665,cval_orders_o_orderpriority#3666,cval_orders_o_clerk#3667,cval_orders_o_shippriority#3668,cval_orders_o_comment#3669,cval_orders_o_orderdate#3670,co_orderstatus#3671,co_totalprice#3672,co_orderpriority#3673,co_clerk#3674,co_shippriority#3675,co_comment#3676,co_orderdate#3677] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 23749ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/15 16:21:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:21:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3750L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:21:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:21:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:21:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:21:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:21:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:21:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:21:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:21:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3750L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#3752 AS rid_0#3769, cval_part_p_name#3753 AS cval_part_p_name_0#3770, cval_part_p_mfgr#3754 AS cval_part_p_mfgr_0#3771, cval_part_p_type#3755 AS cval_part_p_type_0#3772, cval_part_p_size#3756 AS cval_part_p_size_0#3773, cval_part_p_container#3757 AS cval_part_p_container_0#3774, cval_part_p_retailprice#3758 AS cval_part_p_retailprice_0#3775, cval_part_p_comment#3759 AS cval_part_p_comment_0#3776, cval_part_p_brand#3760 AS cval_part_p_brand_0#3777, cp_name#3761 AS cp_name_0#3778, cp_mfgr#3762 AS cp_mfgr_0#3779, cp_type#3763 AS cp_type_0#3780, cp_size#3764 AS cp_size_0#3781, cp_container#3765 AS cp_container_0#3782, cp_retailprice#3766 AS cp_retailprice_0#3783, cp_comment#3767 AS cp_comment_0#3784, cp_brand#3768 AS cp_brand_0#3785]
         :  :  :  :  +- Relation[rid#3752,cval_part_p_name#3753,cval_part_p_mfgr#3754,cval_part_p_type#3755,cval_part_p_size#3756,cval_part_p_container#3757,cval_part_p_retailprice#3758,cval_part_p_comment#3759,cval_part_p_brand#3760,cp_name#3761,cp_mfgr#3762,cp_type#3763,cp_size#3764,cp_container#3765,cp_retailprice#3766,cp_comment#3767,cp_brand#3768] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#3786 AS rid_0#3803, cval_part_p_name#3787 AS cval_part_p_name_0#3804, cval_part_p_mfgr#3788 AS cval_part_p_mfgr_0#3805, cval_part_p_type#3789 AS cval_part_p_type_0#3806, cval_part_p_size#3790 AS cval_part_p_size_0#3807, cval_part_p_container#3791 AS cval_part_p_container_0#3808, cval_part_p_retailprice#3792 AS cval_part_p_retailprice_0#3809, cval_part_p_comment#3793 AS cval_part_p_comment_0#3810, cval_part_p_brand#3794 AS cval_part_p_brand_0#3811, cp_name#3795 AS cp_name_0#3812, cp_mfgr#3796 AS cp_mfgr_0#3813, cp_type#3797 AS cp_type_0#3814, cp_size#3798 AS cp_size_0#3815, cp_container#3799 AS cp_container_0#3816, cp_retailprice#3800 AS cp_retailprice_0#3817, cp_comment#3801 AS cp_comment_0#3818, cp_brand#3802 AS cp_brand_0#3819]
         :  :  :        +- Relation[rid#3786,cval_part_p_name#3787,cval_part_p_mfgr#3788,cval_part_p_type#3789,cval_part_p_size#3790,cval_part_p_container#3791,cval_part_p_retailprice#3792,cval_part_p_comment#3793,cval_part_p_brand#3794,cp_name#3795,cp_mfgr#3796,cp_type#3797,cp_size#3798,cp_container#3799,cp_retailprice#3800,cp_comment#3801,cp_brand#3802] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#3820 AS rid_0#3837, cval_part_p_name#3821 AS cval_part_p_name_0#3838, cval_part_p_mfgr#3822 AS cval_part_p_mfgr_0#3839, cval_part_p_type#3823 AS cval_part_p_type_0#3840, cval_part_p_size#3824 AS cval_part_p_size_0#3841, cval_part_p_container#3825 AS cval_part_p_container_0#3842, cval_part_p_retailprice#3826 AS cval_part_p_retailprice_0#3843, cval_part_p_comment#3827 AS cval_part_p_comment_0#3844, cval_part_p_brand#3828 AS cval_part_p_brand_0#3845, cp_name#3829 AS cp_name_0#3846, cp_mfgr#3830 AS cp_mfgr_0#3847, cp_type#3831 AS cp_type_0#3848, cp_size#3832 AS cp_size_0#3849, cp_container#3833 AS cp_container_0#3850, cp_retailprice#3834 AS cp_retailprice_0#3851, cp_comment#3835 AS cp_comment_0#3852, cp_brand#3836 AS cp_brand_0#3853]
         :  :        +- Relation[rid#3820,cval_part_p_name#3821,cval_part_p_mfgr#3822,cval_part_p_type#3823,cval_part_p_size#3824,cval_part_p_container#3825,cval_part_p_retailprice#3826,cval_part_p_comment#3827,cval_part_p_brand#3828,cp_name#3829,cp_mfgr#3830,cp_type#3831,cp_size#3832,cp_container#3833,cp_retailprice#3834,cp_comment#3835,cp_brand#3836] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#4086 AS rid_1#4119, cpfk_orders_lineitem#4087 AS cpfk_orders_lineitem_1#4120, cpfk_supplier_lineitem#4088 AS cpfk_supplier_lineitem_1#4121, cfpk_lineitem_supplier#4089 AS cfpk_lineitem_supplier_1#4122, cfpk_lineitem_partsupp#4090 AS cfpk_lineitem_partsupp_1#4123, cpfk_part_lineitem#4091 AS cpfk_part_lineitem_1#4124, cfpk_lineitem_part#4092 AS cfpk_lineitem_part_1#4125, cpfk_partsupp_lineitem#4093 AS cpfk_partsupp_lineitem_1#4126, cfpk_lineitem_orders#4094 AS cfpk_lineitem_orders_1#4127, cval_lineitem_l_quantity#4095 AS cval_lineitem_l_quantity_1#4128, cval_lineitem_l_extendedprice#4096 AS cval_lineitem_l_extendedprice_1#4129, cval_lineitem_l_discount#4097 AS cval_lineitem_l_discount_1#4130, cval_lineitem_l_tax#4098 AS cval_lineitem_l_tax_1#4131, cval_lineitem_l_returnflag#4099 AS cval_lineitem_l_returnflag_1#4132, cval_lineitem_l_linestatus#4100 AS cval_lineitem_l_linestatus_1#4133, cval_lineitem_l_commitdate#4101 AS cval_lineitem_l_commitdate_1#4134, cval_lineitem_l_receiptdate#4102 AS cval_lineitem_l_receiptdate_1#4135, cval_lineitem_l_shipinstruct#4103 AS cval_lineitem_l_shipinstruct_1#4136, cval_lineitem_l_shipmode#4104 AS cval_lineitem_l_shipmode_1#4137, cval_lineitem_l_comment#4105 AS cval_lineitem_l_comment_1#4138, cval_lineitem_l_shipdate#4106 AS cval_lineitem_l_shipdate_1#4139, cl_quantity#4107 AS cl_quantity_1#4140, cl_extendedprice#4108 AS cl_extendedprice_1#4141, cl_discount#4109 AS cl_discount_1#4142, ... 9 more fields]
         :     +- Relation[rid#4086,cpfk_orders_lineitem#4087,cpfk_supplier_lineitem#4088,cfpk_lineitem_supplier#4089,cfpk_lineitem_partsupp#4090,cpfk_part_lineitem#4091,cfpk_lineitem_part#4092,cpfk_partsupp_lineitem#4093,cfpk_lineitem_orders#4094,cval_lineitem_l_quantity#4095,cval_lineitem_l_extendedprice#4096,cval_lineitem_l_discount#4097,cval_lineitem_l_tax#4098,cval_lineitem_l_returnflag#4099,cval_lineitem_l_linestatus#4100,cval_lineitem_l_commitdate#4101,cval_lineitem_l_receiptdate#4102,cval_lineitem_l_shipinstruct#4103,cval_lineitem_l_shipmode#4104,cval_lineitem_l_comment#4105,cval_lineitem_l_shipdate#4106,cl_quantity#4107,cl_extendedprice#4108,cl_discount#4109,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#3854 AS rid_1#3887, cpfk_orders_lineitem#3855 AS cpfk_orders_lineitem_1#3888, cpfk_supplier_lineitem#3856 AS cpfk_supplier_lineitem_1#3889, cfpk_lineitem_supplier#3857 AS cfpk_lineitem_supplier_1#3890, cfpk_lineitem_partsupp#3858 AS cfpk_lineitem_partsupp_1#3891, cpfk_part_lineitem#3859 AS cpfk_part_lineitem_1#3892, cfpk_lineitem_part#3860 AS cfpk_lineitem_part_1#3893, cpfk_partsupp_lineitem#3861 AS cpfk_partsupp_lineitem_1#3894, cfpk_lineitem_orders#3862 AS cfpk_lineitem_orders_1#3895, cval_lineitem_l_quantity#3863 AS cval_lineitem_l_quantity_1#3896, cval_lineitem_l_extendedprice#3864 AS cval_lineitem_l_extendedprice_1#3897, cval_lineitem_l_discount#3865 AS cval_lineitem_l_discount_1#3898, cval_lineitem_l_tax#3866 AS cval_lineitem_l_tax_1#3899, cval_lineitem_l_returnflag#3867 AS cval_lineitem_l_returnflag_1#3900, cval_lineitem_l_linestatus#3868 AS cval_lineitem_l_linestatus_1#3901, cval_lineitem_l_commitdate#3869 AS cval_lineitem_l_commitdate_1#3902, cval_lineitem_l_receiptdate#3870 AS cval_lineitem_l_receiptdate_1#3903, cval_lineitem_l_shipinstruct#3871 AS cval_lineitem_l_shipinstruct_1#3904, cval_lineitem_l_shipmode#3872 AS cval_lineitem_l_shipmode_1#3905, cval_lineitem_l_comment#3873 AS cval_lineitem_l_comment_1#3906, cval_lineitem_l_shipdate#3874 AS cval_lineitem_l_shipdate_1#3907, cl_quantity#3875 AS cl_quantity_1#3908, cl_extendedprice#3876 AS cl_extendedprice_1#3909, cl_discount#3877 AS cl_discount_1#3910, ... 9 more fields]
            :  :  +- Relation[rid#3854,cpfk_orders_lineitem#3855,cpfk_supplier_lineitem#3856,cfpk_lineitem_supplier#3857,cfpk_lineitem_partsupp#3858,cpfk_part_lineitem#3859,cfpk_lineitem_part#3860,cpfk_partsupp_lineitem#3861,cfpk_lineitem_orders#3862,cval_lineitem_l_quantity#3863,cval_lineitem_l_extendedprice#3864,cval_lineitem_l_discount#3865,cval_lineitem_l_tax#3866,cval_lineitem_l_returnflag#3867,cval_lineitem_l_linestatus#3868,cval_lineitem_l_commitdate#3869,cval_lineitem_l_receiptdate#3870,cval_lineitem_l_shipinstruct#3871,cval_lineitem_l_shipmode#3872,cval_lineitem_l_comment#3873,cval_lineitem_l_shipdate#3874,cl_quantity#3875,cl_extendedprice#3876,cl_discount#3877,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#3920 AS rid_1#3953, cpfk_orders_lineitem#3921 AS cpfk_orders_lineitem_1#3954, cpfk_supplier_lineitem#3922 AS cpfk_supplier_lineitem_1#3955, cfpk_lineitem_supplier#3923 AS cfpk_lineitem_supplier_1#3956, cfpk_lineitem_partsupp#3924 AS cfpk_lineitem_partsupp_1#3957, cpfk_part_lineitem#3925 AS cpfk_part_lineitem_1#3958, cfpk_lineitem_part#3926 AS cfpk_lineitem_part_1#3959, cpfk_partsupp_lineitem#3927 AS cpfk_partsupp_lineitem_1#3960, cfpk_lineitem_orders#3928 AS cfpk_lineitem_orders_1#3961, cval_lineitem_l_quantity#3929 AS cval_lineitem_l_quantity_1#3962, cval_lineitem_l_extendedprice#3930 AS cval_lineitem_l_extendedprice_1#3963, cval_lineitem_l_discount#3931 AS cval_lineitem_l_discount_1#3964, cval_lineitem_l_tax#3932 AS cval_lineitem_l_tax_1#3965, cval_lineitem_l_returnflag#3933 AS cval_lineitem_l_returnflag_1#3966, cval_lineitem_l_linestatus#3934 AS cval_lineitem_l_linestatus_1#3967, cval_lineitem_l_commitdate#3935 AS cval_lineitem_l_commitdate_1#3968, cval_lineitem_l_receiptdate#3936 AS cval_lineitem_l_receiptdate_1#3969, cval_lineitem_l_shipinstruct#3937 AS cval_lineitem_l_shipinstruct_1#3970, cval_lineitem_l_shipmode#3938 AS cval_lineitem_l_shipmode_1#3971, cval_lineitem_l_comment#3939 AS cval_lineitem_l_comment_1#3972, cval_lineitem_l_shipdate#3940 AS cval_lineitem_l_shipdate_1#3973, cl_quantity#3941 AS cl_quantity_1#3974, cl_extendedprice#3942 AS cl_extendedprice_1#3975, cl_discount#3943 AS cl_discount_1#3976, ... 9 more fields]
            :        +- Relation[rid#3920,cpfk_orders_lineitem#3921,cpfk_supplier_lineitem#3922,cfpk_lineitem_supplier#3923,cfpk_lineitem_partsupp#3924,cpfk_part_lineitem#3925,cfpk_lineitem_part#3926,cpfk_partsupp_lineitem#3927,cfpk_lineitem_orders#3928,cval_lineitem_l_quantity#3929,cval_lineitem_l_extendedprice#3930,cval_lineitem_l_discount#3931,cval_lineitem_l_tax#3932,cval_lineitem_l_returnflag#3933,cval_lineitem_l_linestatus#3934,cval_lineitem_l_commitdate#3935,cval_lineitem_l_receiptdate#3936,cval_lineitem_l_shipinstruct#3937,cval_lineitem_l_shipmode#3938,cval_lineitem_l_comment#3939,cval_lineitem_l_shipdate#3940,cl_quantity#3941,cl_extendedprice#3942,cl_discount#3943,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#3986 AS rid_1#4019, cpfk_orders_lineitem#3987 AS cpfk_orders_lineitem_1#4020, cpfk_supplier_lineitem#3988 AS cpfk_supplier_lineitem_1#4021, cfpk_lineitem_supplier#3989 AS cfpk_lineitem_supplier_1#4022, cfpk_lineitem_partsupp#3990 AS cfpk_lineitem_partsupp_1#4023, cpfk_part_lineitem#3991 AS cpfk_part_lineitem_1#4024, cfpk_lineitem_part#3992 AS cfpk_lineitem_part_1#4025, cpfk_partsupp_lineitem#3993 AS cpfk_partsupp_lineitem_1#4026, cfpk_lineitem_orders#3994 AS cfpk_lineitem_orders_1#4027, cval_lineitem_l_quantity#3995 AS cval_lineitem_l_quantity_1#4028, cval_lineitem_l_extendedprice#3996 AS cval_lineitem_l_extendedprice_1#4029, cval_lineitem_l_discount#3997 AS cval_lineitem_l_discount_1#4030, cval_lineitem_l_tax#3998 AS cval_lineitem_l_tax_1#4031, cval_lineitem_l_returnflag#3999 AS cval_lineitem_l_returnflag_1#4032, cval_lineitem_l_linestatus#4000 AS cval_lineitem_l_linestatus_1#4033, cval_lineitem_l_commitdate#4001 AS cval_lineitem_l_commitdate_1#4034, cval_lineitem_l_receiptdate#4002 AS cval_lineitem_l_receiptdate_1#4035, cval_lineitem_l_shipinstruct#4003 AS cval_lineitem_l_shipinstruct_1#4036, cval_lineitem_l_shipmode#4004 AS cval_lineitem_l_shipmode_1#4037, cval_lineitem_l_comment#4005 AS cval_lineitem_l_comment_1#4038, cval_lineitem_l_shipdate#4006 AS cval_lineitem_l_shipdate_1#4039, cl_quantity#4007 AS cl_quantity_1#4040, cl_extendedprice#4008 AS cl_extendedprice_1#4041, cl_discount#4009 AS cl_discount_1#4042, ... 9 more fields]
                  +- Relation[rid#3986,cpfk_orders_lineitem#3987,cpfk_supplier_lineitem#3988,cfpk_lineitem_supplier#3989,cfpk_lineitem_partsupp#3990,cpfk_part_lineitem#3991,cfpk_lineitem_part#3992,cpfk_partsupp_lineitem#3993,cfpk_lineitem_orders#3994,cval_lineitem_l_quantity#3995,cval_lineitem_l_extendedprice#3996,cval_lineitem_l_discount#3997,cval_lineitem_l_tax#3998,cval_lineitem_l_returnflag#3999,cval_lineitem_l_linestatus#4000,cval_lineitem_l_commitdate#4001,cval_lineitem_l_receiptdate#4002,cval_lineitem_l_shipinstruct#4003,cval_lineitem_l_shipmode#4004,cval_lineitem_l_comment#4005,cval_lineitem_l_shipdate#4006,cl_quantity#4007,cl_extendedprice#4008,cl_discount#4009,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=13
Elapsed time: 65652ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/15 16:22:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:22:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4211L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:22:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4211L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#4213 AS rid_0#4228, cpfk_nation_customer#4214 AS cpfk_nation_customer_0#4229, cfpk_customer_nation#4215 AS cfpk_customer_nation_0#4230, cval_customer_c_name#4216 AS cval_customer_c_name_0#4231, cval_customer_c_address#4217 AS cval_customer_c_address_0#4232, cval_customer_c_phone#4218 AS cval_customer_c_phone_0#4233, cval_customer_c_acctbal#4219 AS cval_customer_c_acctbal_0#4234, cval_customer_c_comment#4220 AS cval_customer_c_comment_0#4235, cval_customer_c_mktsegment#4221 AS cval_customer_c_mktsegment_0#4236, cc_name#4222 AS cc_name_0#4237, cc_address#4223 AS cc_address_0#4238, cc_phone#4224 AS cc_phone_0#4239, cc_acctbal#4225 AS cc_acctbal_0#4240, cc_comment#4226 AS cc_comment_0#4241, cc_mktsegment#4227 AS cc_mktsegment_0#4242]
         :  :  :  :  +- Relation[rid#4213,cpfk_nation_customer#4214,cfpk_customer_nation#4215,cval_customer_c_name#4216,cval_customer_c_address#4217,cval_customer_c_phone#4218,cval_customer_c_acctbal#4219,cval_customer_c_comment#4220,cval_customer_c_mktsegment#4221,cc_name#4222,cc_address#4223,cc_phone#4224,cc_acctbal#4225,cc_comment#4226,cc_mktsegment#4227] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#4277 AS rid_0#4292, cpfk_nation_customer#4278 AS cpfk_nation_customer_0#4293, cfpk_customer_nation#4279 AS cfpk_customer_nation_0#4294, cval_customer_c_name#4280 AS cval_customer_c_name_0#4295, cval_customer_c_address#4281 AS cval_customer_c_address_0#4296, cval_customer_c_phone#4282 AS cval_customer_c_phone_0#4297, cval_customer_c_acctbal#4283 AS cval_customer_c_acctbal_0#4298, cval_customer_c_comment#4284 AS cval_customer_c_comment_0#4299, cval_customer_c_mktsegment#4285 AS cval_customer_c_mktsegment_0#4300, cc_name#4286 AS cc_name_0#4301, cc_address#4287 AS cc_address_0#4302, cc_phone#4288 AS cc_phone_0#4303, cc_acctbal#4289 AS cc_acctbal_0#4304, cc_comment#4290 AS cc_comment_0#4305, cc_mktsegment#4291 AS cc_mktsegment_0#4306]
         :  :  :     :  +- Relation[rid#4277,cpfk_nation_customer#4278,cfpk_customer_nation#4279,cval_customer_c_name#4280,cval_customer_c_address#4281,cval_customer_c_phone#4282,cval_customer_c_acctbal#4283,cval_customer_c_comment#4284,cval_customer_c_mktsegment#4285,cc_name#4286,cc_address#4287,cc_phone#4288,cc_acctbal#4289,cc_comment#4290,cc_mktsegment#4291] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#4307 AS rid_1#4324, cpfk_customer_orders#4308 AS cpfk_customer_orders_1#4325, cfpk_orders_customer#4309 AS cfpk_orders_customer_1#4326, cval_orders_o_orderstatus#4310 AS cval_orders_o_orderstatus_1#4327, cval_orders_o_totalprice#4311 AS cval_orders_o_totalprice_1#4328, cval_orders_o_orderpriority#4312 AS cval_orders_o_orderpriority_1#4329, cval_orders_o_clerk#4313 AS cval_orders_o_clerk_1#4330, cval_orders_o_shippriority#4314 AS cval_orders_o_shippriority_1#4331, cval_orders_o_comment#4315 AS cval_orders_o_comment_1#4332, cval_orders_o_orderdate#4316 AS cval_orders_o_orderdate_1#4333, co_orderstatus#4317 AS co_orderstatus_1#4334, co_totalprice#4318 AS co_totalprice_1#4335, co_orderpriority#4319 AS co_orderpriority_1#4336, co_clerk#4320 AS co_clerk_1#4337, co_shippriority#4321 AS co_shippriority_1#4338, co_comment#4322 AS co_comment_1#4339, co_orderdate#4323 AS co_orderdate_1#4340]
         :  :  :        +- Relation[rid#4307,cpfk_customer_orders#4308,cfpk_orders_customer#4309,cval_orders_o_orderstatus#4310,cval_orders_o_totalprice#4311,cval_orders_o_orderpriority#4312,cval_orders_o_clerk#4313,cval_orders_o_shippriority#4314,cval_orders_o_comment#4315,cval_orders_o_orderdate#4316,co_orderstatus#4317,co_totalprice#4318,co_orderpriority#4319,co_clerk#4320,co_shippriority#4321,co_comment#4322,co_orderdate#4323] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#4243 AS rid_1#4260, cpfk_customer_orders#4244 AS cpfk_customer_orders_1#4261, cfpk_orders_customer#4245 AS cfpk_orders_customer_1#4262, cval_orders_o_orderstatus#4246 AS cval_orders_o_orderstatus_1#4263, cval_orders_o_totalprice#4247 AS cval_orders_o_totalprice_1#4264, cval_orders_o_orderpriority#4248 AS cval_orders_o_orderpriority_1#4265, cval_orders_o_clerk#4249 AS cval_orders_o_clerk_1#4266, cval_orders_o_shippriority#4250 AS cval_orders_o_shippriority_1#4267, cval_orders_o_comment#4251 AS cval_orders_o_comment_1#4268, cval_orders_o_orderdate#4252 AS cval_orders_o_orderdate_1#4269, co_orderstatus#4253 AS co_orderstatus_1#4270, co_totalprice#4254 AS co_totalprice_1#4271, co_orderpriority#4255 AS co_orderpriority_1#4272, co_clerk#4256 AS co_clerk_1#4273, co_shippriority#4257 AS co_shippriority_1#4274, co_comment#4258 AS co_comment_1#4275, co_orderdate#4259 AS co_orderdate_1#4276]
         :  :     +- Relation[rid#4243,cpfk_customer_orders#4244,cfpk_orders_customer#4245,cval_orders_o_orderstatus#4246,cval_orders_o_totalprice#4247,cval_orders_o_orderpriority#4248,cval_orders_o_clerk#4249,cval_orders_o_shippriority#4250,cval_orders_o_comment#4251,cval_orders_o_orderdate#4252,co_orderstatus#4253,co_totalprice#4254,co_orderpriority#4255,co_clerk#4256,co_shippriority#4257,co_comment#4258,co_orderdate#4259] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#4407 AS rid_1#4424, cpfk_customer_orders#4408 AS cpfk_customer_orders_1#4425, cfpk_orders_customer#4409 AS cfpk_orders_customer_1#4426, cval_orders_o_orderstatus#4410 AS cval_orders_o_orderstatus_1#4427, cval_orders_o_totalprice#4411 AS cval_orders_o_totalprice_1#4428, cval_orders_o_orderpriority#4412 AS cval_orders_o_orderpriority_1#4429, cval_orders_o_clerk#4413 AS cval_orders_o_clerk_1#4430, cval_orders_o_shippriority#4414 AS cval_orders_o_shippriority_1#4431, cval_orders_o_comment#4415 AS cval_orders_o_comment_1#4432, cval_orders_o_orderdate#4416 AS cval_orders_o_orderdate_1#4433, co_orderstatus#4417 AS co_orderstatus_1#4434, co_totalprice#4418 AS co_totalprice_1#4435, co_orderpriority#4419 AS co_orderpriority_1#4436, co_clerk#4420 AS co_clerk_1#4437, co_shippriority#4421 AS co_shippriority_1#4438, co_comment#4422 AS co_comment_1#4439, co_orderdate#4423 AS co_orderdate_1#4440]
         :     :  +- Relation[rid#4407,cpfk_customer_orders#4408,cfpk_orders_customer#4409,cval_orders_o_orderstatus#4410,cval_orders_o_totalprice#4411,cval_orders_o_orderpriority#4412,cval_orders_o_clerk#4413,cval_orders_o_shippriority#4414,cval_orders_o_comment#4415,cval_orders_o_orderdate#4416,co_orderstatus#4417,co_totalprice#4418,co_orderpriority#4419,co_clerk#4420,co_shippriority#4421,co_comment#4422,co_orderdate#4423] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#4441 AS rid_2#4474, cpfk_orders_lineitem#4442 AS cpfk_orders_lineitem_2#4475, cpfk_supplier_lineitem#4443 AS cpfk_supplier_lineitem_2#4476, cfpk_lineitem_supplier#4444 AS cfpk_lineitem_supplier_2#4477, cfpk_lineitem_partsupp#4445 AS cfpk_lineitem_partsupp_2#4478, cpfk_part_lineitem#4446 AS cpfk_part_lineitem_2#4479, cfpk_lineitem_part#4447 AS cfpk_lineitem_part_2#4480, cpfk_partsupp_lineitem#4448 AS cpfk_partsupp_lineitem_2#4481, cfpk_lineitem_orders#4449 AS cfpk_lineitem_orders_2#4482, cval_lineitem_l_quantity#4450 AS cval_lineitem_l_quantity_2#4483, cval_lineitem_l_extendedprice#4451 AS cval_lineitem_l_extendedprice_2#4484, cval_lineitem_l_discount#4452 AS cval_lineitem_l_discount_2#4485, cval_lineitem_l_tax#4453 AS cval_lineitem_l_tax_2#4486, cval_lineitem_l_returnflag#4454 AS cval_lineitem_l_returnflag_2#4487, cval_lineitem_l_linestatus#4455 AS cval_lineitem_l_linestatus_2#4488, cval_lineitem_l_commitdate#4456 AS cval_lineitem_l_commitdate_2#4489, cval_lineitem_l_receiptdate#4457 AS cval_lineitem_l_receiptdate_2#4490, cval_lineitem_l_shipinstruct#4458 AS cval_lineitem_l_shipinstruct_2#4491, cval_lineitem_l_shipmode#4459 AS cval_lineitem_l_shipmode_2#4492, cval_lineitem_l_comment#4460 AS cval_lineitem_l_comment_2#4493, cval_lineitem_l_shipdate#4461 AS cval_lineitem_l_shipdate_2#4494, cl_quantity#4462 AS cl_quantity_2#4495, cl_extendedprice#4463 AS cl_extendedprice_2#4496, cl_discount#4464 AS cl_discount_2#4497, ... 9 more fields]
         :        +- Relation[rid#4441,cpfk_orders_lineitem#4442,cpfk_supplier_lineitem#4443,cfpk_lineitem_supplier#4444,cfpk_lineitem_partsupp#4445,cpfk_part_lineitem#4446,cfpk_lineitem_part#4447,cpfk_partsupp_lineitem#4448,cfpk_lineitem_orders#4449,cval_lineitem_l_quantity#4450,cval_lineitem_l_extendedprice#4451,cval_lineitem_l_discount#4452,cval_lineitem_l_tax#4453,cval_lineitem_l_returnflag#4454,cval_lineitem_l_linestatus#4455,cval_lineitem_l_commitdate#4456,cval_lineitem_l_receiptdate#4457,cval_lineitem_l_shipinstruct#4458,cval_lineitem_l_shipmode#4459,cval_lineitem_l_comment#4460,cval_lineitem_l_shipdate#4461,cl_quantity#4462,cl_extendedprice#4463,cl_discount#4464,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4341 AS rid_2#4374, cpfk_orders_lineitem#4342 AS cpfk_orders_lineitem_2#4375, cpfk_supplier_lineitem#4343 AS cpfk_supplier_lineitem_2#4376, cfpk_lineitem_supplier#4344 AS cfpk_lineitem_supplier_2#4377, cfpk_lineitem_partsupp#4345 AS cfpk_lineitem_partsupp_2#4378, cpfk_part_lineitem#4346 AS cpfk_part_lineitem_2#4379, cfpk_lineitem_part#4347 AS cfpk_lineitem_part_2#4380, cpfk_partsupp_lineitem#4348 AS cpfk_partsupp_lineitem_2#4381, cfpk_lineitem_orders#4349 AS cfpk_lineitem_orders_2#4382, cval_lineitem_l_quantity#4350 AS cval_lineitem_l_quantity_2#4383, cval_lineitem_l_extendedprice#4351 AS cval_lineitem_l_extendedprice_2#4384, cval_lineitem_l_discount#4352 AS cval_lineitem_l_discount_2#4385, cval_lineitem_l_tax#4353 AS cval_lineitem_l_tax_2#4386, cval_lineitem_l_returnflag#4354 AS cval_lineitem_l_returnflag_2#4387, cval_lineitem_l_linestatus#4355 AS cval_lineitem_l_linestatus_2#4388, cval_lineitem_l_commitdate#4356 AS cval_lineitem_l_commitdate_2#4389, cval_lineitem_l_receiptdate#4357 AS cval_lineitem_l_receiptdate_2#4390, cval_lineitem_l_shipinstruct#4358 AS cval_lineitem_l_shipinstruct_2#4391, cval_lineitem_l_shipmode#4359 AS cval_lineitem_l_shipmode_2#4392, cval_lineitem_l_comment#4360 AS cval_lineitem_l_comment_2#4393, cval_lineitem_l_shipdate#4361 AS cval_lineitem_l_shipdate_2#4394, cl_quantity#4362 AS cl_quantity_2#4395, cl_extendedprice#4363 AS cl_extendedprice_2#4396, cl_discount#4364 AS cl_discount_2#4397, ... 9 more fields]
            +- Relation[rid#4341,cpfk_orders_lineitem#4342,cpfk_supplier_lineitem#4343,cfpk_lineitem_supplier#4344,cfpk_lineitem_partsupp#4345,cpfk_part_lineitem#4346,cfpk_lineitem_part#4347,cpfk_partsupp_lineitem#4348,cfpk_lineitem_orders#4349,cval_lineitem_l_quantity#4350,cval_lineitem_l_extendedprice#4351,cval_lineitem_l_discount#4352,cval_lineitem_l_tax#4353,cval_lineitem_l_returnflag#4354,cval_lineitem_l_linestatus#4355,cval_lineitem_l_commitdate#4356,cval_lineitem_l_receiptdate#4357,cval_lineitem_l_shipinstruct#4358,cval_lineitem_l_shipmode#4359,cval_lineitem_l_comment#4360,cval_lineitem_l_shipdate#4361,cl_quantity#4362,cl_extendedprice#4363,cl_discount#4364,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 129278ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/15 16:24:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:24:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4578L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 16:24:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:24:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:24:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:24:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4578L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#4580 AS rid_0#4587, cpfk_region_nation#4581 AS cpfk_region_nation_0#4588, cfpk_nation_region#4582 AS cfpk_nation_region_0#4589, cval_nation_n_name#4583 AS cval_nation_n_name_0#4590, cval_nation_n_comment#4584 AS cval_nation_n_comment_0#4591, cn_name#4585 AS cn_name_0#4592, cn_comment#4586 AS cn_comment_0#4593]
         :  :  :  :  :  +- Relation[rid#4580,cpfk_region_nation#4581,cfpk_nation_region#4582,cval_nation_n_name#4583,cval_nation_n_comment#4584,cn_name#4585,cn_comment#4586] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#4594 AS rid_0#4601, cpfk_region_nation#4595 AS cpfk_region_nation_0#4602, cfpk_nation_region#4596 AS cfpk_nation_region_0#4603, cval_nation_n_name#4597 AS cval_nation_n_name_0#4604, cval_nation_n_comment#4598 AS cval_nation_n_comment_0#4605, cn_name#4599 AS cn_name_0#4606, cn_comment#4600 AS cn_comment_0#4607]
         :  :  :  :        +- Relation[rid#4594,cpfk_region_nation#4595,cfpk_nation_region#4596,cval_nation_n_name#4597,cval_nation_n_comment#4598,cn_name#4599,cn_comment#4600] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#4648 AS rid_1#4661, cpfk_nation_supplier#4649 AS cpfk_nation_supplier_1#4662, cfpk_supplier_nation#4650 AS cfpk_supplier_nation_1#4663, cval_supplier_s_name#4651 AS cval_supplier_s_name_1#4664, cval_supplier_s_address#4652 AS cval_supplier_s_address_1#4665, cval_supplier_s_phone#4653 AS cval_supplier_s_phone_1#4666, cval_supplier_s_acctbal#4654 AS cval_supplier_s_acctbal_1#4667, cval_supplier_s_comment#4655 AS cval_supplier_s_comment_1#4668, cs_name#4656 AS cs_name_1#4669, cs_address#4657 AS cs_address_1#4670, cs_phone#4658 AS cs_phone_1#4671, cs_acctbal#4659 AS cs_acctbal_1#4672, cs_comment#4660 AS cs_comment_1#4673]
         :  :  :     +- Relation[rid#4648,cpfk_nation_supplier#4649,cfpk_supplier_nation#4650,cval_supplier_s_name#4651,cval_supplier_s_address#4652,cval_supplier_s_phone#4653,cval_supplier_s_acctbal#4654,cval_supplier_s_comment#4655,cs_name#4656,cs_address#4657,cs_phone#4658,cs_acctbal#4659,cs_comment#4660] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#4608 AS rid_1#4621, cpfk_nation_supplier#4609 AS cpfk_nation_supplier_1#4622, cfpk_supplier_nation#4610 AS cfpk_supplier_nation_1#4623, cval_supplier_s_name#4611 AS cval_supplier_s_name_1#4624, cval_supplier_s_address#4612 AS cval_supplier_s_address_1#4625, cval_supplier_s_phone#4613 AS cval_supplier_s_phone_1#4626, cval_supplier_s_acctbal#4614 AS cval_supplier_s_acctbal_1#4627, cval_supplier_s_comment#4615 AS cval_supplier_s_comment_1#4628, cs_name#4616 AS cs_name_1#4629, cs_address#4617 AS cs_address_1#4630, cs_phone#4618 AS cs_phone_1#4631, cs_acctbal#4619 AS cs_acctbal_1#4632, cs_comment#4620 AS cs_comment_1#4633]
         :  :     +- Relation[rid#4608,cpfk_nation_supplier#4609,cfpk_supplier_nation#4610,cval_supplier_s_name#4611,cval_supplier_s_address#4612,cval_supplier_s_phone#4613,cval_supplier_s_acctbal#4614,cval_supplier_s_comment#4615,cs_name#4616,cs_address#4617,cs_phone#4618,cs_acctbal#4619,cs_comment#4620] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#4722 AS rid_2#4733, cpfk_part_partsupp#4723 AS cpfk_part_partsupp_2#4734, cfpk_partsupp_part#4724 AS cfpk_partsupp_part_2#4735, cpfk_supplier_partsupp#4725 AS cpfk_supplier_partsupp_2#4736, cfpk_partsupp_supplier#4726 AS cfpk_partsupp_supplier_2#4737, cval_partsupp_ps_availqty#4727 AS cval_partsupp_ps_availqty_2#4738, cval_partsupp_ps_supplycost#4728 AS cval_partsupp_ps_supplycost_2#4739, cval_partsupp_ps_comment#4729 AS cval_partsupp_ps_comment_2#4740, cps_availqty#4730 AS cps_availqty_2#4741, cps_supplycost#4731 AS cps_supplycost_2#4742, cps_comment#4732 AS cps_comment_2#4743]
         :     +- Relation[rid#4722,cpfk_part_partsupp#4723,cfpk_partsupp_part#4724,cpfk_supplier_partsupp#4725,cfpk_partsupp_supplier#4726,cval_partsupp_ps_availqty#4727,cval_partsupp_ps_supplycost#4728,cval_partsupp_ps_comment#4729,cps_availqty#4730,cps_supplycost#4731,cps_comment#4732] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#4674 AS rid_2#4685, cpfk_part_partsupp#4675 AS cpfk_part_partsupp_2#4686, cfpk_partsupp_part#4676 AS cfpk_partsupp_part_2#4687, cpfk_supplier_partsupp#4677 AS cpfk_supplier_partsupp_2#4688, cfpk_partsupp_supplier#4678 AS cfpk_partsupp_supplier_2#4689, cval_partsupp_ps_availqty#4679 AS cval_partsupp_ps_availqty_2#4690, cval_partsupp_ps_supplycost#4680 AS cval_partsupp_ps_supplycost_2#4691, cval_partsupp_ps_comment#4681 AS cval_partsupp_ps_comment_2#4692, cps_availqty#4682 AS cps_availqty_2#4693, cps_supplycost#4683 AS cps_supplycost_2#4694, cps_comment#4684 AS cps_comment_2#4695]
            +- Relation[rid#4674,cpfk_part_partsupp#4675,cfpk_partsupp_part#4676,cpfk_supplier_partsupp#4677,cfpk_partsupp_supplier#4678,cval_partsupp_ps_availqty#4679,cval_partsupp_ps_supplycost#4680,cval_partsupp_ps_comment#4681,cps_availqty#4682,cps_supplycost#4683,cps_comment#4684] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=4
Elapsed time: 1325ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/15 16:24:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:24:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4780L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:24:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#4780L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#4782 AS rid_0#4815, cpfk_orders_lineitem#4783 AS cpfk_orders_lineitem_0#4816, cpfk_supplier_lineitem#4784 AS cpfk_supplier_lineitem_0#4817, cfpk_lineitem_supplier#4785 AS cfpk_lineitem_supplier_0#4818, cfpk_lineitem_partsupp#4786 AS cfpk_lineitem_partsupp_0#4819, cpfk_part_lineitem#4787 AS cpfk_part_lineitem_0#4820, cfpk_lineitem_part#4788 AS cfpk_lineitem_part_0#4821, cpfk_partsupp_lineitem#4789 AS cpfk_partsupp_lineitem_0#4822, cfpk_lineitem_orders#4790 AS cfpk_lineitem_orders_0#4823, cval_lineitem_l_quantity#4791 AS cval_lineitem_l_quantity_0#4824, cval_lineitem_l_extendedprice#4792 AS cval_lineitem_l_extendedprice_0#4825, cval_lineitem_l_discount#4793 AS cval_lineitem_l_discount_0#4826, cval_lineitem_l_tax#4794 AS cval_lineitem_l_tax_0#4827, cval_lineitem_l_returnflag#4795 AS cval_lineitem_l_returnflag_0#4828, cval_lineitem_l_linestatus#4796 AS cval_lineitem_l_linestatus_0#4829, cval_lineitem_l_commitdate#4797 AS cval_lineitem_l_commitdate_0#4830, cval_lineitem_l_receiptdate#4798 AS cval_lineitem_l_receiptdate_0#4831, cval_lineitem_l_shipinstruct#4799 AS cval_lineitem_l_shipinstruct_0#4832, cval_lineitem_l_shipmode#4800 AS cval_lineitem_l_shipmode_0#4833, cval_lineitem_l_comment#4801 AS cval_lineitem_l_comment_0#4834, cval_lineitem_l_shipdate#4802 AS cval_lineitem_l_shipdate_0#4835, cl_quantity#4803 AS cl_quantity_0#4836, cl_extendedprice#4804 AS cl_extendedprice_0#4837, cl_discount#4805 AS cl_discount_0#4838, ... 9 more fields]
         +- Relation[rid#4782,cpfk_orders_lineitem#4783,cpfk_supplier_lineitem#4784,cfpk_lineitem_supplier#4785,cfpk_lineitem_partsupp#4786,cpfk_part_lineitem#4787,cfpk_lineitem_part#4788,cpfk_partsupp_lineitem#4789,cfpk_lineitem_orders#4790,cval_lineitem_l_quantity#4791,cval_lineitem_l_extendedprice#4792,cval_lineitem_l_discount#4793,cval_lineitem_l_tax#4794,cval_lineitem_l_returnflag#4795,cval_lineitem_l_linestatus#4796,cval_lineitem_l_commitdate#4797,cval_lineitem_l_receiptdate#4798,cval_lineitem_l_shipinstruct#4799,cval_lineitem_l_shipmode#4800,cval_lineitem_l_comment#4801,cval_lineitem_l_shipdate#4802,cl_quantity#4803,cl_extendedprice#4804,cl_discount#4805,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2814ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/15 16:24:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:24:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4886L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 16:24:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:24:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:24:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:24:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:24:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4886L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#4888 AS rid_0#4905, cval_part_p_name#4889 AS cval_part_p_name_0#4906, cval_part_p_mfgr#4890 AS cval_part_p_mfgr_0#4907, cval_part_p_type#4891 AS cval_part_p_type_0#4908, cval_part_p_size#4892 AS cval_part_p_size_0#4909, cval_part_p_container#4893 AS cval_part_p_container_0#4910, cval_part_p_retailprice#4894 AS cval_part_p_retailprice_0#4911, cval_part_p_comment#4895 AS cval_part_p_comment_0#4912, cval_part_p_brand#4896 AS cval_part_p_brand_0#4913, cp_name#4897 AS cp_name_0#4914, cp_mfgr#4898 AS cp_mfgr_0#4915, cp_type#4899 AS cp_type_0#4916, cp_size#4900 AS cp_size_0#4917, cp_container#4901 AS cp_container_0#4918, cp_retailprice#4902 AS cp_retailprice_0#4919, cp_comment#4903 AS cp_comment_0#4920, cp_brand#4904 AS cp_brand_0#4921]
            :  :  :  :  +- Relation[rid#4888,cval_part_p_name#4889,cval_part_p_mfgr#4890,cval_part_p_type#4891,cval_part_p_size#4892,cval_part_p_container#4893,cval_part_p_retailprice#4894,cval_part_p_comment#4895,cval_part_p_brand#4896,cp_name#4897,cp_mfgr#4898,cp_type#4899,cp_size#4900,cp_container#4901,cp_retailprice#4902,cp_comment#4903,cp_brand#4904] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#4922 AS rid_0#4939, cval_part_p_name#4923 AS cval_part_p_name_0#4940, cval_part_p_mfgr#4924 AS cval_part_p_mfgr_0#4941, cval_part_p_type#4925 AS cval_part_p_type_0#4942, cval_part_p_size#4926 AS cval_part_p_size_0#4943, cval_part_p_container#4927 AS cval_part_p_container_0#4944, cval_part_p_retailprice#4928 AS cval_part_p_retailprice_0#4945, cval_part_p_comment#4929 AS cval_part_p_comment_0#4946, cval_part_p_brand#4930 AS cval_part_p_brand_0#4947, cp_name#4931 AS cp_name_0#4948, cp_mfgr#4932 AS cp_mfgr_0#4949, cp_type#4933 AS cp_type_0#4950, cp_size#4934 AS cp_size_0#4951, cp_container#4935 AS cp_container_0#4952, cp_retailprice#4936 AS cp_retailprice_0#4953, cp_comment#4937 AS cp_comment_0#4954, cp_brand#4938 AS cp_brand_0#4955]
            :  :  :        +- Relation[rid#4922,cval_part_p_name#4923,cval_part_p_mfgr#4924,cval_part_p_type#4925,cval_part_p_size#4926,cval_part_p_container#4927,cval_part_p_retailprice#4928,cval_part_p_comment#4929,cval_part_p_brand#4930,cp_name#4931,cp_mfgr#4932,cp_type#4933,cp_size#4934,cp_container#4935,cp_retailprice#4936,cp_comment#4937,cp_brand#4938] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- Project [rid#5012 AS rid_1#5023, cpfk_part_partsupp#5013 AS cpfk_part_partsupp_1#5024, cfpk_partsupp_part#5014 AS cfpk_partsupp_part_1#5025, cpfk_supplier_partsupp#5015 AS cpfk_supplier_partsupp_1#5026, cfpk_partsupp_supplier#5016 AS cfpk_partsupp_supplier_1#5027, cval_partsupp_ps_availqty#5017 AS cval_partsupp_ps_availqty_1#5028, cval_partsupp_ps_supplycost#5018 AS cval_partsupp_ps_supplycost_1#5029, cval_partsupp_ps_comment#5019 AS cval_partsupp_ps_comment_1#5030, cps_availqty#5020 AS cps_availqty_1#5031, cps_supplycost#5021 AS cps_supplycost_1#5032, cps_comment#5022 AS cps_comment_1#5033]
            :  :     +- Relation[rid#5012,cpfk_part_partsupp#5013,cfpk_partsupp_part#5014,cpfk_supplier_partsupp#5015,cfpk_partsupp_supplier#5016,cval_partsupp_ps_availqty#5017,cval_partsupp_ps_supplycost#5018,cval_partsupp_ps_comment#5019,cps_availqty#5020,cps_supplycost#5021,cps_comment#5022] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#4956 AS rid_1#4967, cpfk_part_partsupp#4957 AS cpfk_part_partsupp_1#4968, cfpk_partsupp_part#4958 AS cfpk_partsupp_part_1#4969, cpfk_supplier_partsupp#4959 AS cpfk_supplier_partsupp_1#4970, cfpk_partsupp_supplier#4960 AS cfpk_partsupp_supplier_1#4971, cval_partsupp_ps_availqty#4961 AS cval_partsupp_ps_availqty_1#4972, cval_partsupp_ps_supplycost#4962 AS cval_partsupp_ps_supplycost_1#4973, cval_partsupp_ps_comment#4963 AS cval_partsupp_ps_comment_1#4974, cps_availqty#4964 AS cps_availqty_1#4975, cps_supplycost#4965 AS cps_supplycost_1#4976, cps_comment#4966 AS cps_comment_1#4977]
            :     +- Relation[rid#4956,cpfk_part_partsupp#4957,cfpk_partsupp_part#4958,cpfk_supplier_partsupp#4959,cfpk_partsupp_supplier#4960,cval_partsupp_ps_availqty#4961,cval_partsupp_ps_supplycost#4962,cval_partsupp_ps_comment#4963,cps_availqty#4964,cps_supplycost#4965,cps_comment#4966] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#5034 AS rid_2#5041, cpfk_region_nation#5035 AS cpfk_region_nation_2#5042, cfpk_nation_region#5036 AS cfpk_nation_region_2#5043, cval_nation_n_name#5037 AS cval_nation_n_name_2#5044, cval_nation_n_comment#5038 AS cval_nation_n_comment_2#5045, cn_name#5039 AS cn_name_2#5046, cn_comment#5040 AS cn_comment_2#5047]
               :  :  :  +- Relation[rid#5034,cpfk_region_nation#5035,cfpk_nation_region#5036,cval_nation_n_name#5037,cval_nation_n_comment#5038,cn_name#5039,cn_comment#5040] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#5048 AS rid_2#5055, cpfk_region_nation#5049 AS cpfk_region_nation_2#5056, cfpk_nation_region#5050 AS cfpk_nation_region_2#5057, cval_nation_n_name#5051 AS cval_nation_n_name_2#5058, cval_nation_n_comment#5052 AS cval_nation_n_comment_2#5059, cn_name#5053 AS cn_name_2#5060, cn_comment#5054 AS cn_comment_2#5061]
               :  :        +- Relation[rid#5048,cpfk_region_nation#5049,cfpk_nation_region#5050,cval_nation_n_name#5051,cval_nation_n_comment#5052,cn_name#5053,cn_comment#5054] JDBCRelation(tnation) [numPartitions=1]
               :  +- Project [rid#5102 AS rid_3#5115, cpfk_nation_supplier#5103 AS cpfk_nation_supplier_3#5116, cfpk_supplier_nation#5104 AS cfpk_supplier_nation_3#5117, cval_supplier_s_name#5105 AS cval_supplier_s_name_3#5118, cval_supplier_s_address#5106 AS cval_supplier_s_address_3#5119, cval_supplier_s_phone#5107 AS cval_supplier_s_phone_3#5120, cval_supplier_s_acctbal#5108 AS cval_supplier_s_acctbal_3#5121, cval_supplier_s_comment#5109 AS cval_supplier_s_comment_3#5122, cs_name#5110 AS cs_name_3#5123, cs_address#5111 AS cs_address_3#5124, cs_phone#5112 AS cs_phone_3#5125, cs_acctbal#5113 AS cs_acctbal_3#5126, cs_comment#5114 AS cs_comment_3#5127]
               :     +- Relation[rid#5102,cpfk_nation_supplier#5103,cfpk_supplier_nation#5104,cval_supplier_s_name#5105,cval_supplier_s_address#5106,cval_supplier_s_phone#5107,cval_supplier_s_acctbal#5108,cval_supplier_s_comment#5109,cs_name#5110,cs_address#5111,cs_phone#5112,cs_acctbal#5113,cs_comment#5114] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#5062 AS rid_3#5075, cpfk_nation_supplier#5063 AS cpfk_nation_supplier_3#5076, cfpk_supplier_nation#5064 AS cfpk_supplier_nation_3#5077, cval_supplier_s_name#5065 AS cval_supplier_s_name_3#5078, cval_supplier_s_address#5066 AS cval_supplier_s_address_3#5079, cval_supplier_s_phone#5067 AS cval_supplier_s_phone_3#5080, cval_supplier_s_acctbal#5068 AS cval_supplier_s_acctbal_3#5081, cval_supplier_s_comment#5069 AS cval_supplier_s_comment_3#5082, cs_name#5070 AS cs_name_3#5083, cs_address#5071 AS cs_address_3#5084, cs_phone#5072 AS cs_phone_3#5085, cs_acctbal#5073 AS cs_acctbal_3#5086, cs_comment#5074 AS cs_comment_3#5087]
                  +- Relation[rid#5062,cpfk_nation_supplier#5063,cfpk_supplier_nation#5064,cval_supplier_s_name#5065,cval_supplier_s_address#5066,cval_supplier_s_phone#5067,cval_supplier_s_acctbal#5068,cval_supplier_s_comment#5069,cs_name#5070,cs_address#5071,cs_phone#5072,cs_acctbal#5073,cs_comment#5074] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=326
Elapsed time: 703ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/15 16:24:22 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:24:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5182L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 16:24:22 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:24:22 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:24:22 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:24:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:22 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:24:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:22 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:24:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5182L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#5184 AS rid_0#5189, cval_region_r_name#5185 AS cval_region_r_name_0#5190, cval_region_r_comment#5186 AS cval_region_r_comment_0#5191, cr_name#5187 AS cr_name_0#5192, cr_comment#5188 AS cr_comment_0#5193]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#5184,cval_region_r_name#5185,cval_region_r_comment#5186,cr_name#5187,cr_comment#5188] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#5194 AS rid_0#5199, cval_region_r_name#5195 AS cval_region_r_name_0#5200, cval_region_r_comment#5196 AS cval_region_r_comment_0#5201, cr_name#5197 AS cr_name_0#5202, cr_comment#5198 AS cr_comment_0#5203]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#5194,cval_region_r_name#5195,cval_region_r_comment#5196,cr_name#5197,cr_comment#5198] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- Project [rid#5228 AS rid_1#5235, cpfk_region_nation#5229 AS cpfk_region_nation_1#5236, cfpk_nation_region#5230 AS cfpk_nation_region_1#5237, cval_nation_n_name#5231 AS cval_nation_n_name_1#5238, cval_nation_n_comment#5232 AS cval_nation_n_comment_1#5239, cn_name#5233 AS cn_name_1#5240, cn_comment#5234 AS cn_comment_1#5241]
         :     :  :  :  :  :  :  :  :     +- Relation[rid#5228,cpfk_region_nation#5229,cfpk_nation_region#5230,cval_nation_n_name#5231,cval_nation_n_comment#5232,cn_name#5233,cn_comment#5234] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#5204 AS rid_1#5211, cpfk_region_nation#5205 AS cpfk_region_nation_1#5212, cfpk_nation_region#5206 AS cfpk_nation_region_1#5213, cval_nation_n_name#5207 AS cval_nation_n_name_1#5214, cval_nation_n_comment#5208 AS cval_nation_n_comment_1#5215, cn_name#5209 AS cn_name_1#5216, cn_comment#5210 AS cn_comment_1#5217]
         :     :  :  :  :  :  :  :     +- Relation[rid#5204,cpfk_region_nation#5205,cfpk_nation_region#5206,cval_nation_n_name#5207,cval_nation_n_comment#5208,cn_name#5209,cn_comment#5210] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- Project [rid#5286 AS rid_2#5301, cpfk_nation_customer#5287 AS cpfk_nation_customer_2#5302, cfpk_customer_nation#5288 AS cfpk_customer_nation_2#5303, cval_customer_c_name#5289 AS cval_customer_c_name_2#5304, cval_customer_c_address#5290 AS cval_customer_c_address_2#5305, cval_customer_c_phone#5291 AS cval_customer_c_phone_2#5306, cval_customer_c_acctbal#5292 AS cval_customer_c_acctbal_2#5307, cval_customer_c_comment#5293 AS cval_customer_c_comment_2#5308, cval_customer_c_mktsegment#5294 AS cval_customer_c_mktsegment_2#5309, cc_name#5295 AS cc_name_2#5310, cc_address#5296 AS cc_address_2#5311, cc_phone#5297 AS cc_phone_2#5312, cc_acctbal#5298 AS cc_acctbal_2#5313, cc_comment#5299 AS cc_comment_2#5314, cc_mktsegment#5300 AS cc_mktsegment_2#5315]
         :     :  :  :  :  :  :     +- Relation[rid#5286,cpfk_nation_customer#5287,cfpk_customer_nation#5288,cval_customer_c_name#5289,cval_customer_c_address#5290,cval_customer_c_phone#5291,cval_customer_c_acctbal#5292,cval_customer_c_comment#5293,cval_customer_c_mktsegment#5294,cc_name#5295,cc_address#5296,cc_phone#5297,cc_acctbal#5298,cc_comment#5299,cc_mktsegment#5300] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#5242 AS rid_2#5257, cpfk_nation_customer#5243 AS cpfk_nation_customer_2#5258, cfpk_customer_nation#5244 AS cfpk_customer_nation_2#5259, cval_customer_c_name#5245 AS cval_customer_c_name_2#5260, cval_customer_c_address#5246 AS cval_customer_c_address_2#5261, cval_customer_c_phone#5247 AS cval_customer_c_phone_2#5262, cval_customer_c_acctbal#5248 AS cval_customer_c_acctbal_2#5263, cval_customer_c_comment#5249 AS cval_customer_c_comment_2#5264, cval_customer_c_mktsegment#5250 AS cval_customer_c_mktsegment_2#5265, cc_name#5251 AS cc_name_2#5266, cc_address#5252 AS cc_address_2#5267, cc_phone#5253 AS cc_phone_2#5268, cc_acctbal#5254 AS cc_acctbal_2#5269, cc_comment#5255 AS cc_comment_2#5270, cc_mktsegment#5256 AS cc_mktsegment_2#5271]
         :     :  :  :  :  :     +- Relation[rid#5242,cpfk_nation_customer#5243,cfpk_customer_nation#5244,cval_customer_c_name#5245,cval_customer_c_address#5246,cval_customer_c_phone#5247,cval_customer_c_acctbal#5248,cval_customer_c_comment#5249,cval_customer_c_mktsegment#5250,cc_name#5251,cc_address#5252,cc_phone#5253,cc_acctbal#5254,cc_comment#5255,cc_mktsegment#5256] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- Project [rid#5380 AS rid_3#5397, cpfk_customer_orders#5381 AS cpfk_customer_orders_3#5398, cfpk_orders_customer#5382 AS cfpk_orders_customer_3#5399, cval_orders_o_orderstatus#5383 AS cval_orders_o_orderstatus_3#5400, cval_orders_o_totalprice#5384 AS cval_orders_o_totalprice_3#5401, cval_orders_o_orderpriority#5385 AS cval_orders_o_orderpriority_3#5402, cval_orders_o_clerk#5386 AS cval_orders_o_clerk_3#5403, cval_orders_o_shippriority#5387 AS cval_orders_o_shippriority_3#5404, cval_orders_o_comment#5388 AS cval_orders_o_comment_3#5405, cval_orders_o_orderdate#5389 AS cval_orders_o_orderdate_3#5406, co_orderstatus#5390 AS co_orderstatus_3#5407, co_totalprice#5391 AS co_totalprice_3#5408, co_orderpriority#5392 AS co_orderpriority_3#5409, co_clerk#5393 AS co_clerk_3#5410, co_shippriority#5394 AS co_shippriority_3#5411, co_comment#5395 AS co_comment_3#5412, co_orderdate#5396 AS co_orderdate_3#5413]
         :     :  :  :  :     +- Relation[rid#5380,cpfk_customer_orders#5381,cfpk_orders_customer#5382,cval_orders_o_orderstatus#5383,cval_orders_o_totalprice#5384,cval_orders_o_orderpriority#5385,cval_orders_o_clerk#5386,cval_orders_o_shippriority#5387,cval_orders_o_comment#5388,cval_orders_o_orderdate#5389,co_orderstatus#5390,co_totalprice#5391,co_orderpriority#5392,co_clerk#5393,co_shippriority#5394,co_comment#5395,co_orderdate#5396] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#5316 AS rid_3#5333, cpfk_customer_orders#5317 AS cpfk_customer_orders_3#5334, cfpk_orders_customer#5318 AS cfpk_orders_customer_3#5335, cval_orders_o_orderstatus#5319 AS cval_orders_o_orderstatus_3#5336, cval_orders_o_totalprice#5320 AS cval_orders_o_totalprice_3#5337, cval_orders_o_orderpriority#5321 AS cval_orders_o_orderpriority_3#5338, cval_orders_o_clerk#5322 AS cval_orders_o_clerk_3#5339, cval_orders_o_shippriority#5323 AS cval_orders_o_shippriority_3#5340, cval_orders_o_comment#5324 AS cval_orders_o_comment_3#5341, cval_orders_o_orderdate#5325 AS cval_orders_o_orderdate_3#5342, co_orderstatus#5326 AS co_orderstatus_3#5343, co_totalprice#5327 AS co_totalprice_3#5344, co_orderpriority#5328 AS co_orderpriority_3#5345, co_clerk#5329 AS co_clerk_3#5346, co_shippriority#5330 AS co_shippriority_3#5347, co_comment#5331 AS co_comment_3#5348, co_orderdate#5332 AS co_orderdate_3#5349]
         :     :  :  :     +- Relation[rid#5316,cpfk_customer_orders#5317,cfpk_orders_customer#5318,cval_orders_o_orderstatus#5319,cval_orders_o_totalprice#5320,cval_orders_o_orderpriority#5321,cval_orders_o_clerk#5322,cval_orders_o_shippriority#5323,cval_orders_o_comment#5324,cval_orders_o_orderdate#5325,co_orderstatus#5326,co_totalprice#5327,co_orderpriority#5328,co_clerk#5329,co_shippriority#5330,co_comment#5331,co_orderdate#5332] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- Project [rid#5514 AS rid_4#5547, cpfk_orders_lineitem#5515 AS cpfk_orders_lineitem_4#5548, cpfk_supplier_lineitem#5516 AS cpfk_supplier_lineitem_4#5549, cfpk_lineitem_supplier#5517 AS cfpk_lineitem_supplier_4#5550, cfpk_lineitem_partsupp#5518 AS cfpk_lineitem_partsupp_4#5551, cpfk_part_lineitem#5519 AS cpfk_part_lineitem_4#5552, cfpk_lineitem_part#5520 AS cfpk_lineitem_part_4#5553, cpfk_partsupp_lineitem#5521 AS cpfk_partsupp_lineitem_4#5554, cfpk_lineitem_orders#5522 AS cfpk_lineitem_orders_4#5555, cval_lineitem_l_quantity#5523 AS cval_lineitem_l_quantity_4#5556, cval_lineitem_l_extendedprice#5524 AS cval_lineitem_l_extendedprice_4#5557, cval_lineitem_l_discount#5525 AS cval_lineitem_l_discount_4#5558, cval_lineitem_l_tax#5526 AS cval_lineitem_l_tax_4#5559, cval_lineitem_l_returnflag#5527 AS cval_lineitem_l_returnflag_4#5560, cval_lineitem_l_linestatus#5528 AS cval_lineitem_l_linestatus_4#5561, cval_lineitem_l_commitdate#5529 AS cval_lineitem_l_commitdate_4#5562, cval_lineitem_l_receiptdate#5530 AS cval_lineitem_l_receiptdate_4#5563, cval_lineitem_l_shipinstruct#5531 AS cval_lineitem_l_shipinstruct_4#5564, cval_lineitem_l_shipmode#5532 AS cval_lineitem_l_shipmode_4#5565, cval_lineitem_l_comment#5533 AS cval_lineitem_l_comment_4#5566, cval_lineitem_l_shipdate#5534 AS cval_lineitem_l_shipdate_4#5567, cl_quantity#5535 AS cl_quantity_4#5568, cl_extendedprice#5536 AS cl_extendedprice_4#5569, cl_discount#5537 AS cl_discount_4#5570, ... 9 more fields]
         :     :  :     +- Relation[rid#5514,cpfk_orders_lineitem#5515,cpfk_supplier_lineitem#5516,cfpk_lineitem_supplier#5517,cfpk_lineitem_partsupp#5518,cpfk_part_lineitem#5519,cfpk_lineitem_part#5520,cpfk_partsupp_lineitem#5521,cfpk_lineitem_orders#5522,cval_lineitem_l_quantity#5523,cval_lineitem_l_extendedprice#5524,cval_lineitem_l_discount#5525,cval_lineitem_l_tax#5526,cval_lineitem_l_returnflag#5527,cval_lineitem_l_linestatus#5528,cval_lineitem_l_commitdate#5529,cval_lineitem_l_receiptdate#5530,cval_lineitem_l_shipinstruct#5531,cval_lineitem_l_shipmode#5532,cval_lineitem_l_comment#5533,cval_lineitem_l_shipdate#5534,cl_quantity#5535,cl_extendedprice#5536,cl_discount#5537,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#5414 AS rid_4#5447, cpfk_orders_lineitem#5415 AS cpfk_orders_lineitem_4#5448, cpfk_supplier_lineitem#5416 AS cpfk_supplier_lineitem_4#5449, cfpk_lineitem_supplier#5417 AS cfpk_lineitem_supplier_4#5450, cfpk_lineitem_partsupp#5418 AS cfpk_lineitem_partsupp_4#5451, cpfk_part_lineitem#5419 AS cpfk_part_lineitem_4#5452, cfpk_lineitem_part#5420 AS cfpk_lineitem_part_4#5453, cpfk_partsupp_lineitem#5421 AS cpfk_partsupp_lineitem_4#5454, cfpk_lineitem_orders#5422 AS cfpk_lineitem_orders_4#5455, cval_lineitem_l_quantity#5423 AS cval_lineitem_l_quantity_4#5456, cval_lineitem_l_extendedprice#5424 AS cval_lineitem_l_extendedprice_4#5457, cval_lineitem_l_discount#5425 AS cval_lineitem_l_discount_4#5458, cval_lineitem_l_tax#5426 AS cval_lineitem_l_tax_4#5459, cval_lineitem_l_returnflag#5427 AS cval_lineitem_l_returnflag_4#5460, cval_lineitem_l_linestatus#5428 AS cval_lineitem_l_linestatus_4#5461, cval_lineitem_l_commitdate#5429 AS cval_lineitem_l_commitdate_4#5462, cval_lineitem_l_receiptdate#5430 AS cval_lineitem_l_receiptdate_4#5463, cval_lineitem_l_shipinstruct#5431 AS cval_lineitem_l_shipinstruct_4#5464, cval_lineitem_l_shipmode#5432 AS cval_lineitem_l_shipmode_4#5465, cval_lineitem_l_comment#5433 AS cval_lineitem_l_comment_4#5466, cval_lineitem_l_shipdate#5434 AS cval_lineitem_l_shipdate_4#5467, cl_quantity#5435 AS cl_quantity_4#5468, cl_extendedprice#5436 AS cl_extendedprice_4#5469, cl_discount#5437 AS cl_discount_4#5470, ... 9 more fields]
         :     :     +- Relation[rid#5414,cpfk_orders_lineitem#5415,cpfk_supplier_lineitem#5416,cfpk_lineitem_supplier#5417,cfpk_lineitem_partsupp#5418,cpfk_part_lineitem#5419,cfpk_lineitem_part#5420,cpfk_partsupp_lineitem#5421,cfpk_lineitem_orders#5422,cval_lineitem_l_quantity#5423,cval_lineitem_l_extendedprice#5424,cval_lineitem_l_discount#5425,cval_lineitem_l_tax#5426,cval_lineitem_l_returnflag#5427,cval_lineitem_l_linestatus#5428,cval_lineitem_l_commitdate#5429,cval_lineitem_l_receiptdate#5430,cval_lineitem_l_shipinstruct#5431,cval_lineitem_l_shipmode#5432,cval_lineitem_l_comment#5433,cval_lineitem_l_shipdate#5434,cl_quantity#5435,cl_extendedprice#5436,cl_discount#5437,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#5580 AS rid_5#5593, cpfk_nation_supplier#5581 AS cpfk_nation_supplier_5#5594, cfpk_supplier_nation#5582 AS cfpk_supplier_nation_5#5595, cval_supplier_s_name#5583 AS cval_supplier_s_name_5#5596, cval_supplier_s_address#5584 AS cval_supplier_s_address_5#5597, cval_supplier_s_phone#5585 AS cval_supplier_s_phone_5#5598, cval_supplier_s_acctbal#5586 AS cval_supplier_s_acctbal_5#5599, cval_supplier_s_comment#5587 AS cval_supplier_s_comment_5#5600, cs_name#5588 AS cs_name_5#5601, cs_address#5589 AS cs_address_5#5602, cs_phone#5590 AS cs_phone_5#5603, cs_acctbal#5591 AS cs_acctbal_5#5604, cs_comment#5592 AS cs_comment_5#5605]
         :        +- Relation[rid#5580,cpfk_nation_supplier#5581,cfpk_supplier_nation#5582,cval_supplier_s_name#5583,cval_supplier_s_address#5584,cval_supplier_s_phone#5585,cval_supplier_s_acctbal#5586,cval_supplier_s_comment#5587,cs_name#5588,cs_address#5589,cs_phone#5590,cs_acctbal#5591,cs_comment#5592] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#5606 AS rid_1#5613, cpfk_region_nation#5607 AS cpfk_region_nation_1#5614, cfpk_nation_region#5608 AS cfpk_nation_region_1#5615, cval_nation_n_name#5609 AS cval_nation_n_name_1#5616, cval_nation_n_comment#5610 AS cval_nation_n_comment_1#5617, cn_name#5611 AS cn_name_1#5618, cn_comment#5612 AS cn_comment_1#5619]
            :  +- Relation[rid#5606,cpfk_region_nation#5607,cfpk_nation_region#5608,cval_nation_n_name#5609,cval_nation_n_comment#5610,cn_name#5611,cn_comment#5612] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#5620 AS rid_5#5633, cpfk_nation_supplier#5621 AS cpfk_nation_supplier_5#5634, cfpk_supplier_nation#5622 AS cfpk_supplier_nation_5#5635, cval_supplier_s_name#5623 AS cval_supplier_s_name_5#5636, cval_supplier_s_address#5624 AS cval_supplier_s_address_5#5637, cval_supplier_s_phone#5625 AS cval_supplier_s_phone_5#5638, cval_supplier_s_acctbal#5626 AS cval_supplier_s_acctbal_5#5639, cval_supplier_s_comment#5627 AS cval_supplier_s_comment_5#5640, cs_name#5628 AS cs_name_5#5641, cs_address#5629 AS cs_address_5#5642, cs_phone#5630 AS cs_phone_5#5643, cs_acctbal#5631 AS cs_acctbal_5#5644, cs_comment#5632 AS cs_comment_5#5645]
               +- Relation[rid#5620,cpfk_nation_supplier#5621,cfpk_supplier_nation#5622,cval_supplier_s_name#5623,cval_supplier_s_address#5624,cval_supplier_s_phone#5625,cval_supplier_s_acctbal#5626,cval_supplier_s_comment#5627,cs_name#5628,cs_address#5629,cs_phone#5630,cs_acctbal#5631,cs_comment#5632] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1
Elapsed time: 21383ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/15 16:24:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:24:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5744L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:24:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:24:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:24:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5744L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#5746 AS rid_0#5753, cpfk_region_nation#5747 AS cpfk_region_nation_0#5754, cfpk_nation_region#5748 AS cfpk_nation_region_0#5755, cval_nation_n_name#5749 AS cval_nation_n_name_0#5756, cval_nation_n_comment#5750 AS cval_nation_n_comment_0#5757, cn_name#5751 AS cn_name_0#5758, cn_comment#5752 AS cn_comment_0#5759]
            :  :  :  :  :  :  +- Relation[rid#5746,cpfk_region_nation#5747,cfpk_nation_region#5748,cval_nation_n_name#5749,cval_nation_n_comment#5750,cn_name#5751,cn_comment#5752] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#5760 AS rid_0#5767, cpfk_region_nation#5761 AS cpfk_region_nation_0#5768, cfpk_nation_region#5762 AS cfpk_nation_region_0#5769, cval_nation_n_name#5763 AS cval_nation_n_name_0#5770, cval_nation_n_comment#5764 AS cval_nation_n_comment_0#5771, cn_name#5765 AS cn_name_0#5772, cn_comment#5766 AS cn_comment_0#5773]
            :  :  :  :  :        +- Relation[rid#5760,cpfk_region_nation#5761,cfpk_nation_region#5762,cval_nation_n_name#5763,cval_nation_n_comment#5764,cn_name#5765,cn_comment#5766] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- Project [rid#5814 AS rid_1#5827, cpfk_nation_supplier#5815 AS cpfk_nation_supplier_1#5828, cfpk_supplier_nation#5816 AS cfpk_supplier_nation_1#5829, cval_supplier_s_name#5817 AS cval_supplier_s_name_1#5830, cval_supplier_s_address#5818 AS cval_supplier_s_address_1#5831, cval_supplier_s_phone#5819 AS cval_supplier_s_phone_1#5832, cval_supplier_s_acctbal#5820 AS cval_supplier_s_acctbal_1#5833, cval_supplier_s_comment#5821 AS cval_supplier_s_comment_1#5834, cs_name#5822 AS cs_name_1#5835, cs_address#5823 AS cs_address_1#5836, cs_phone#5824 AS cs_phone_1#5837, cs_acctbal#5825 AS cs_acctbal_1#5838, cs_comment#5826 AS cs_comment_1#5839]
            :  :  :  :     +- Relation[rid#5814,cpfk_nation_supplier#5815,cfpk_supplier_nation#5816,cval_supplier_s_name#5817,cval_supplier_s_address#5818,cval_supplier_s_phone#5819,cval_supplier_s_acctbal#5820,cval_supplier_s_comment#5821,cs_name#5822,cs_address#5823,cs_phone#5824,cs_acctbal#5825,cs_comment#5826] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#5774 AS rid_1#5787, cpfk_nation_supplier#5775 AS cpfk_nation_supplier_1#5788, cfpk_supplier_nation#5776 AS cfpk_supplier_nation_1#5789, cval_supplier_s_name#5777 AS cval_supplier_s_name_1#5790, cval_supplier_s_address#5778 AS cval_supplier_s_address_1#5791, cval_supplier_s_phone#5779 AS cval_supplier_s_phone_1#5792, cval_supplier_s_acctbal#5780 AS cval_supplier_s_acctbal_1#5793, cval_supplier_s_comment#5781 AS cval_supplier_s_comment_1#5794, cs_name#5782 AS cs_name_1#5795, cs_address#5783 AS cs_address_1#5796, cs_phone#5784 AS cs_phone_1#5797, cs_acctbal#5785 AS cs_acctbal_1#5798, cs_comment#5786 AS cs_comment_1#5799]
            :  :  :     +- Relation[rid#5774,cpfk_nation_supplier#5775,cfpk_supplier_nation#5776,cval_supplier_s_name#5777,cval_supplier_s_address#5778,cval_supplier_s_phone#5779,cval_supplier_s_acctbal#5780,cval_supplier_s_comment#5781,cs_name#5782,cs_address#5783,cs_phone#5784,cs_acctbal#5785,cs_comment#5786] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- Project [rid#5932 AS rid_2#5965, cpfk_orders_lineitem#5933 AS cpfk_orders_lineitem_2#5966, cpfk_supplier_lineitem#5934 AS cpfk_supplier_lineitem_2#5967, cfpk_lineitem_supplier#5935 AS cfpk_lineitem_supplier_2#5968, cfpk_lineitem_partsupp#5936 AS cfpk_lineitem_partsupp_2#5969, cpfk_part_lineitem#5937 AS cpfk_part_lineitem_2#5970, cfpk_lineitem_part#5938 AS cfpk_lineitem_part_2#5971, cpfk_partsupp_lineitem#5939 AS cpfk_partsupp_lineitem_2#5972, cfpk_lineitem_orders#5940 AS cfpk_lineitem_orders_2#5973, cval_lineitem_l_quantity#5941 AS cval_lineitem_l_quantity_2#5974, cval_lineitem_l_extendedprice#5942 AS cval_lineitem_l_extendedprice_2#5975, cval_lineitem_l_discount#5943 AS cval_lineitem_l_discount_2#5976, cval_lineitem_l_tax#5944 AS cval_lineitem_l_tax_2#5977, cval_lineitem_l_returnflag#5945 AS cval_lineitem_l_returnflag_2#5978, cval_lineitem_l_linestatus#5946 AS cval_lineitem_l_linestatus_2#5979, cval_lineitem_l_commitdate#5947 AS cval_lineitem_l_commitdate_2#5980, cval_lineitem_l_receiptdate#5948 AS cval_lineitem_l_receiptdate_2#5981, cval_lineitem_l_shipinstruct#5949 AS cval_lineitem_l_shipinstruct_2#5982, cval_lineitem_l_shipmode#5950 AS cval_lineitem_l_shipmode_2#5983, cval_lineitem_l_comment#5951 AS cval_lineitem_l_comment_2#5984, cval_lineitem_l_shipdate#5952 AS cval_lineitem_l_shipdate_2#5985, cl_quantity#5953 AS cl_quantity_2#5986, cl_extendedprice#5954 AS cl_extendedprice_2#5987, cl_discount#5955 AS cl_discount_2#5988, ... 9 more fields]
            :  :     +- Relation[rid#5932,cpfk_orders_lineitem#5933,cpfk_supplier_lineitem#5934,cfpk_lineitem_supplier#5935,cfpk_lineitem_partsupp#5936,cpfk_part_lineitem#5937,cfpk_lineitem_part#5938,cpfk_partsupp_lineitem#5939,cfpk_lineitem_orders#5940,cval_lineitem_l_quantity#5941,cval_lineitem_l_extendedprice#5942,cval_lineitem_l_discount#5943,cval_lineitem_l_tax#5944,cval_lineitem_l_returnflag#5945,cval_lineitem_l_linestatus#5946,cval_lineitem_l_commitdate#5947,cval_lineitem_l_receiptdate#5948,cval_lineitem_l_shipinstruct#5949,cval_lineitem_l_shipmode#5950,cval_lineitem_l_comment#5951,cval_lineitem_l_shipdate#5952,cl_quantity#5953,cl_extendedprice#5954,cl_discount#5955,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#5840 AS rid_2#5873, cpfk_orders_lineitem#5841 AS cpfk_orders_lineitem_2#5874, cpfk_supplier_lineitem#5842 AS cpfk_supplier_lineitem_2#5875, cfpk_lineitem_supplier#5843 AS cfpk_lineitem_supplier_2#5876, cfpk_lineitem_partsupp#5844 AS cfpk_lineitem_partsupp_2#5877, cpfk_part_lineitem#5845 AS cpfk_part_lineitem_2#5878, cfpk_lineitem_part#5846 AS cfpk_lineitem_part_2#5879, cpfk_partsupp_lineitem#5847 AS cpfk_partsupp_lineitem_2#5880, cfpk_lineitem_orders#5848 AS cfpk_lineitem_orders_2#5881, cval_lineitem_l_quantity#5849 AS cval_lineitem_l_quantity_2#5882, cval_lineitem_l_extendedprice#5850 AS cval_lineitem_l_extendedprice_2#5883, cval_lineitem_l_discount#5851 AS cval_lineitem_l_discount_2#5884, cval_lineitem_l_tax#5852 AS cval_lineitem_l_tax_2#5885, cval_lineitem_l_returnflag#5853 AS cval_lineitem_l_returnflag_2#5886, cval_lineitem_l_linestatus#5854 AS cval_lineitem_l_linestatus_2#5887, cval_lineitem_l_commitdate#5855 AS cval_lineitem_l_commitdate_2#5888, cval_lineitem_l_receiptdate#5856 AS cval_lineitem_l_receiptdate_2#5889, cval_lineitem_l_shipinstruct#5857 AS cval_lineitem_l_shipinstruct_2#5890, cval_lineitem_l_shipmode#5858 AS cval_lineitem_l_shipmode_2#5891, cval_lineitem_l_comment#5859 AS cval_lineitem_l_comment_2#5892, cval_lineitem_l_shipdate#5860 AS cval_lineitem_l_shipdate_2#5893, cl_quantity#5861 AS cl_quantity_2#5894, cl_extendedprice#5862 AS cl_extendedprice_2#5895, cl_discount#5863 AS cl_discount_2#5896, ... 9 more fields]
            :     +- Relation[rid#5840,cpfk_orders_lineitem#5841,cpfk_supplier_lineitem#5842,cfpk_lineitem_supplier#5843,cfpk_lineitem_partsupp#5844,cpfk_part_lineitem#5845,cfpk_lineitem_part#5846,cpfk_partsupp_lineitem#5847,cfpk_lineitem_orders#5848,cval_lineitem_l_quantity#5849,cval_lineitem_l_extendedprice#5850,cval_lineitem_l_discount#5851,cval_lineitem_l_tax#5852,cval_lineitem_l_returnflag#5853,cval_lineitem_l_linestatus#5854,cval_lineitem_l_commitdate#5855,cval_lineitem_l_receiptdate#5856,cval_lineitem_l_shipinstruct#5857,cval_lineitem_l_shipmode#5858,cval_lineitem_l_comment#5859,cval_lineitem_l_shipdate#5860,cl_quantity#5861,cl_extendedprice#5862,cl_discount#5863,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#5998 AS rid_3#6005, cpfk_region_nation#5999 AS cpfk_region_nation_3#6006, cfpk_nation_region#6000 AS cfpk_nation_region_3#6007, cval_nation_n_name#6001 AS cval_nation_n_name_3#6008, cval_nation_n_comment#6002 AS cval_nation_n_comment_3#6009, cn_name#6003 AS cn_name_3#6010, cn_comment#6004 AS cn_comment_3#6011]
               :  :  :  :  :  +- Relation[rid#5998,cpfk_region_nation#5999,cfpk_nation_region#6000,cval_nation_n_name#6001,cval_nation_n_comment#6002,cn_name#6003,cn_comment#6004] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#6012 AS rid_3#6019, cpfk_region_nation#6013 AS cpfk_region_nation_3#6020, cfpk_nation_region#6014 AS cfpk_nation_region_3#6021, cval_nation_n_name#6015 AS cval_nation_n_name_3#6022, cval_nation_n_comment#6016 AS cval_nation_n_comment_3#6023, cn_name#6017 AS cn_name_3#6024, cn_comment#6018 AS cn_comment_3#6025]
               :  :  :  :        +- Relation[rid#6012,cpfk_region_nation#6013,cfpk_nation_region#6014,cval_nation_n_name#6015,cval_nation_n_comment#6016,cn_name#6017,cn_comment#6018] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#6070 AS rid_4#6085, cpfk_nation_customer#6071 AS cpfk_nation_customer_4#6086, cfpk_customer_nation#6072 AS cfpk_customer_nation_4#6087, cval_customer_c_name#6073 AS cval_customer_c_name_4#6088, cval_customer_c_address#6074 AS cval_customer_c_address_4#6089, cval_customer_c_phone#6075 AS cval_customer_c_phone_4#6090, cval_customer_c_acctbal#6076 AS cval_customer_c_acctbal_4#6091, cval_customer_c_comment#6077 AS cval_customer_c_comment_4#6092, cval_customer_c_mktsegment#6078 AS cval_customer_c_mktsegment_4#6093, cc_name#6079 AS cc_name_4#6094, cc_address#6080 AS cc_address_4#6095, cc_phone#6081 AS cc_phone_4#6096, cc_acctbal#6082 AS cc_acctbal_4#6097, cc_comment#6083 AS cc_comment_4#6098, cc_mktsegment#6084 AS cc_mktsegment_4#6099]
               :  :  :     +- Relation[rid#6070,cpfk_nation_customer#6071,cfpk_customer_nation#6072,cval_customer_c_name#6073,cval_customer_c_address#6074,cval_customer_c_phone#6075,cval_customer_c_acctbal#6076,cval_customer_c_comment#6077,cval_customer_c_mktsegment#6078,cc_name#6079,cc_address#6080,cc_phone#6081,cc_acctbal#6082,cc_comment#6083,cc_mktsegment#6084] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#6026 AS rid_4#6041, cpfk_nation_customer#6027 AS cpfk_nation_customer_4#6042, cfpk_customer_nation#6028 AS cfpk_customer_nation_4#6043, cval_customer_c_name#6029 AS cval_customer_c_name_4#6044, cval_customer_c_address#6030 AS cval_customer_c_address_4#6045, cval_customer_c_phone#6031 AS cval_customer_c_phone_4#6046, cval_customer_c_acctbal#6032 AS cval_customer_c_acctbal_4#6047, cval_customer_c_comment#6033 AS cval_customer_c_comment_4#6048, cval_customer_c_mktsegment#6034 AS cval_customer_c_mktsegment_4#6049, cc_name#6035 AS cc_name_4#6050, cc_address#6036 AS cc_address_4#6051, cc_phone#6037 AS cc_phone_4#6052, cc_acctbal#6038 AS cc_acctbal_4#6053, cc_comment#6039 AS cc_comment_4#6054, cc_mktsegment#6040 AS cc_mktsegment_4#6055]
               :  :     +- Relation[rid#6026,cpfk_nation_customer#6027,cfpk_customer_nation#6028,cval_customer_c_name#6029,cval_customer_c_address#6030,cval_customer_c_phone#6031,cval_customer_c_acctbal#6032,cval_customer_c_comment#6033,cval_customer_c_mktsegment#6034,cc_name#6035,cc_address#6036,cc_phone#6037,cc_acctbal#6038,cc_comment#6039,cc_mktsegment#6040] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#6164 AS rid_5#6181, cpfk_customer_orders#6165 AS cpfk_customer_orders_5#6182, cfpk_orders_customer#6166 AS cfpk_orders_customer_5#6183, cval_orders_o_orderstatus#6167 AS cval_orders_o_orderstatus_5#6184, cval_orders_o_totalprice#6168 AS cval_orders_o_totalprice_5#6185, cval_orders_o_orderpriority#6169 AS cval_orders_o_orderpriority_5#6186, cval_orders_o_clerk#6170 AS cval_orders_o_clerk_5#6187, cval_orders_o_shippriority#6171 AS cval_orders_o_shippriority_5#6188, cval_orders_o_comment#6172 AS cval_orders_o_comment_5#6189, cval_orders_o_orderdate#6173 AS cval_orders_o_orderdate_5#6190, co_orderstatus#6174 AS co_orderstatus_5#6191, co_totalprice#6175 AS co_totalprice_5#6192, co_orderpriority#6176 AS co_orderpriority_5#6193, co_clerk#6177 AS co_clerk_5#6194, co_shippriority#6178 AS co_shippriority_5#6195, co_comment#6179 AS co_comment_5#6196, co_orderdate#6180 AS co_orderdate_5#6197]
               :     +- Relation[rid#6164,cpfk_customer_orders#6165,cfpk_orders_customer#6166,cval_orders_o_orderstatus#6167,cval_orders_o_totalprice#6168,cval_orders_o_orderpriority#6169,cval_orders_o_clerk#6170,cval_orders_o_shippriority#6171,cval_orders_o_comment#6172,cval_orders_o_orderdate#6173,co_orderstatus#6174,co_totalprice#6175,co_orderpriority#6176,co_clerk#6177,co_shippriority#6178,co_comment#6179,co_orderdate#6180] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#6100 AS rid_5#6117, cpfk_customer_orders#6101 AS cpfk_customer_orders_5#6118, cfpk_orders_customer#6102 AS cfpk_orders_customer_5#6119, cval_orders_o_orderstatus#6103 AS cval_orders_o_orderstatus_5#6120, cval_orders_o_totalprice#6104 AS cval_orders_o_totalprice_5#6121, cval_orders_o_orderpriority#6105 AS cval_orders_o_orderpriority_5#6122, cval_orders_o_clerk#6106 AS cval_orders_o_clerk_5#6123, cval_orders_o_shippriority#6107 AS cval_orders_o_shippriority_5#6124, cval_orders_o_comment#6108 AS cval_orders_o_comment_5#6125, cval_orders_o_orderdate#6109 AS cval_orders_o_orderdate_5#6126, co_orderstatus#6110 AS co_orderstatus_5#6127, co_totalprice#6111 AS co_totalprice_5#6128, co_orderpriority#6112 AS co_orderpriority_5#6129, co_clerk#6113 AS co_clerk_5#6130, co_shippriority#6114 AS co_shippriority_5#6131, co_comment#6115 AS co_comment_5#6132, co_orderdate#6116 AS co_orderdate_5#6133]
                  +- Relation[rid#6100,cpfk_customer_orders#6101,cfpk_orders_customer#6102,cval_orders_o_orderstatus#6103,cval_orders_o_totalprice#6104,cval_orders_o_orderpriority#6105,cval_orders_o_clerk#6106,cval_orders_o_shippriority#6107,cval_orders_o_comment#6108,cval_orders_o_orderdate#6109,co_orderstatus#6110,co_totalprice#6111,co_orderpriority#6112,co_clerk#6113,co_shippriority#6114,co_comment#6115,co_orderdate#6116] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 379ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/15 16:24:44 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:24:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6298L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:24:44 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:24:44 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:24:44 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:24:44 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:24:44 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:24:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6298L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#6300 AS rid_0#6315, cpfk_nation_customer#6301 AS cpfk_nation_customer_0#6316, cfpk_customer_nation#6302 AS cfpk_customer_nation_0#6317, cval_customer_c_name#6303 AS cval_customer_c_name_0#6318, cval_customer_c_address#6304 AS cval_customer_c_address_0#6319, cval_customer_c_phone#6305 AS cval_customer_c_phone_0#6320, cval_customer_c_acctbal#6306 AS cval_customer_c_acctbal_0#6321, cval_customer_c_comment#6307 AS cval_customer_c_comment_0#6322, cval_customer_c_mktsegment#6308 AS cval_customer_c_mktsegment_0#6323, cc_name#6309 AS cc_name_0#6324, cc_address#6310 AS cc_address_0#6325, cc_phone#6311 AS cc_phone_0#6326, cc_acctbal#6312 AS cc_acctbal_0#6327, cc_comment#6313 AS cc_comment_0#6328, cc_mktsegment#6314 AS cc_mktsegment_0#6329]
         :  :  :  :  :  +- Relation[rid#6300,cpfk_nation_customer#6301,cfpk_customer_nation#6302,cval_customer_c_name#6303,cval_customer_c_address#6304,cval_customer_c_phone#6305,cval_customer_c_acctbal#6306,cval_customer_c_comment#6307,cval_customer_c_mktsegment#6308,cc_name#6309,cc_address#6310,cc_phone#6311,cc_acctbal#6312,cc_comment#6313,cc_mktsegment#6314] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#6330 AS rid_0#6345, cpfk_nation_customer#6331 AS cpfk_nation_customer_0#6346, cfpk_customer_nation#6332 AS cfpk_customer_nation_0#6347, cval_customer_c_name#6333 AS cval_customer_c_name_0#6348, cval_customer_c_address#6334 AS cval_customer_c_address_0#6349, cval_customer_c_phone#6335 AS cval_customer_c_phone_0#6350, cval_customer_c_acctbal#6336 AS cval_customer_c_acctbal_0#6351, cval_customer_c_comment#6337 AS cval_customer_c_comment_0#6352, cval_customer_c_mktsegment#6338 AS cval_customer_c_mktsegment_0#6353, cc_name#6339 AS cc_name_0#6354, cc_address#6340 AS cc_address_0#6355, cc_phone#6341 AS cc_phone_0#6356, cc_acctbal#6342 AS cc_acctbal_0#6357, cc_comment#6343 AS cc_comment_0#6358, cc_mktsegment#6344 AS cc_mktsegment_0#6359]
         :  :  :  :        +- Relation[rid#6330,cpfk_nation_customer#6331,cfpk_customer_nation#6332,cval_customer_c_name#6333,cval_customer_c_address#6334,cval_customer_c_phone#6335,cval_customer_c_acctbal#6336,cval_customer_c_comment#6337,cval_customer_c_mktsegment#6338,cc_name#6339,cc_address#6340,cc_phone#6341,cc_acctbal#6342,cc_comment#6343,cc_mktsegment#6344] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- Project [rid#6424 AS rid_1#6441, cpfk_customer_orders#6425 AS cpfk_customer_orders_1#6442, cfpk_orders_customer#6426 AS cfpk_orders_customer_1#6443, cval_orders_o_orderstatus#6427 AS cval_orders_o_orderstatus_1#6444, cval_orders_o_totalprice#6428 AS cval_orders_o_totalprice_1#6445, cval_orders_o_orderpriority#6429 AS cval_orders_o_orderpriority_1#6446, cval_orders_o_clerk#6430 AS cval_orders_o_clerk_1#6447, cval_orders_o_shippriority#6431 AS cval_orders_o_shippriority_1#6448, cval_orders_o_comment#6432 AS cval_orders_o_comment_1#6449, cval_orders_o_orderdate#6433 AS cval_orders_o_orderdate_1#6450, co_orderstatus#6434 AS co_orderstatus_1#6451, co_totalprice#6435 AS co_totalprice_1#6452, co_orderpriority#6436 AS co_orderpriority_1#6453, co_clerk#6437 AS co_clerk_1#6454, co_shippriority#6438 AS co_shippriority_1#6455, co_comment#6439 AS co_comment_1#6456, co_orderdate#6440 AS co_orderdate_1#6457]
         :  :  :     +- Relation[rid#6424,cpfk_customer_orders#6425,cfpk_orders_customer#6426,cval_orders_o_orderstatus#6427,cval_orders_o_totalprice#6428,cval_orders_o_orderpriority#6429,cval_orders_o_clerk#6430,cval_orders_o_shippriority#6431,cval_orders_o_comment#6432,cval_orders_o_orderdate#6433,co_orderstatus#6434,co_totalprice#6435,co_orderpriority#6436,co_clerk#6437,co_shippriority#6438,co_comment#6439,co_orderdate#6440] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#6360 AS rid_1#6377, cpfk_customer_orders#6361 AS cpfk_customer_orders_1#6378, cfpk_orders_customer#6362 AS cfpk_orders_customer_1#6379, cval_orders_o_orderstatus#6363 AS cval_orders_o_orderstatus_1#6380, cval_orders_o_totalprice#6364 AS cval_orders_o_totalprice_1#6381, cval_orders_o_orderpriority#6365 AS cval_orders_o_orderpriority_1#6382, cval_orders_o_clerk#6366 AS cval_orders_o_clerk_1#6383, cval_orders_o_shippriority#6367 AS cval_orders_o_shippriority_1#6384, cval_orders_o_comment#6368 AS cval_orders_o_comment_1#6385, cval_orders_o_orderdate#6369 AS cval_orders_o_orderdate_1#6386, co_orderstatus#6370 AS co_orderstatus_1#6387, co_totalprice#6371 AS co_totalprice_1#6388, co_orderpriority#6372 AS co_orderpriority_1#6389, co_clerk#6373 AS co_clerk_1#6390, co_shippriority#6374 AS co_shippriority_1#6391, co_comment#6375 AS co_comment_1#6392, co_orderdate#6376 AS co_orderdate_1#6393]
         :  :     +- Relation[rid#6360,cpfk_customer_orders#6361,cfpk_orders_customer#6362,cval_orders_o_orderstatus#6363,cval_orders_o_totalprice#6364,cval_orders_o_orderpriority#6365,cval_orders_o_clerk#6366,cval_orders_o_shippriority#6367,cval_orders_o_comment#6368,cval_orders_o_orderdate#6369,co_orderstatus#6370,co_totalprice#6371,co_orderpriority#6372,co_clerk#6373,co_shippriority#6374,co_comment#6375,co_orderdate#6376] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#6558 AS rid_2#6591, cpfk_orders_lineitem#6559 AS cpfk_orders_lineitem_2#6592, cpfk_supplier_lineitem#6560 AS cpfk_supplier_lineitem_2#6593, cfpk_lineitem_supplier#6561 AS cfpk_lineitem_supplier_2#6594, cfpk_lineitem_partsupp#6562 AS cfpk_lineitem_partsupp_2#6595, cpfk_part_lineitem#6563 AS cpfk_part_lineitem_2#6596, cfpk_lineitem_part#6564 AS cfpk_lineitem_part_2#6597, cpfk_partsupp_lineitem#6565 AS cpfk_partsupp_lineitem_2#6598, cfpk_lineitem_orders#6566 AS cfpk_lineitem_orders_2#6599, cval_lineitem_l_quantity#6567 AS cval_lineitem_l_quantity_2#6600, cval_lineitem_l_extendedprice#6568 AS cval_lineitem_l_extendedprice_2#6601, cval_lineitem_l_discount#6569 AS cval_lineitem_l_discount_2#6602, cval_lineitem_l_tax#6570 AS cval_lineitem_l_tax_2#6603, cval_lineitem_l_returnflag#6571 AS cval_lineitem_l_returnflag_2#6604, cval_lineitem_l_linestatus#6572 AS cval_lineitem_l_linestatus_2#6605, cval_lineitem_l_commitdate#6573 AS cval_lineitem_l_commitdate_2#6606, cval_lineitem_l_receiptdate#6574 AS cval_lineitem_l_receiptdate_2#6607, cval_lineitem_l_shipinstruct#6575 AS cval_lineitem_l_shipinstruct_2#6608, cval_lineitem_l_shipmode#6576 AS cval_lineitem_l_shipmode_2#6609, cval_lineitem_l_comment#6577 AS cval_lineitem_l_comment_2#6610, cval_lineitem_l_shipdate#6578 AS cval_lineitem_l_shipdate_2#6611, cl_quantity#6579 AS cl_quantity_2#6612, cl_extendedprice#6580 AS cl_extendedprice_2#6613, cl_discount#6581 AS cl_discount_2#6614, ... 9 more fields]
         :     +- Relation[rid#6558,cpfk_orders_lineitem#6559,cpfk_supplier_lineitem#6560,cfpk_lineitem_supplier#6561,cfpk_lineitem_partsupp#6562,cpfk_part_lineitem#6563,cfpk_lineitem_part#6564,cpfk_partsupp_lineitem#6565,cfpk_lineitem_orders#6566,cval_lineitem_l_quantity#6567,cval_lineitem_l_extendedprice#6568,cval_lineitem_l_discount#6569,cval_lineitem_l_tax#6570,cval_lineitem_l_returnflag#6571,cval_lineitem_l_linestatus#6572,cval_lineitem_l_commitdate#6573,cval_lineitem_l_receiptdate#6574,cval_lineitem_l_shipinstruct#6575,cval_lineitem_l_shipmode#6576,cval_lineitem_l_comment#6577,cval_lineitem_l_shipdate#6578,cl_quantity#6579,cl_extendedprice#6580,cl_discount#6581,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6458 AS rid_2#6491, cpfk_orders_lineitem#6459 AS cpfk_orders_lineitem_2#6492, cpfk_supplier_lineitem#6460 AS cpfk_supplier_lineitem_2#6493, cfpk_lineitem_supplier#6461 AS cfpk_lineitem_supplier_2#6494, cfpk_lineitem_partsupp#6462 AS cfpk_lineitem_partsupp_2#6495, cpfk_part_lineitem#6463 AS cpfk_part_lineitem_2#6496, cfpk_lineitem_part#6464 AS cfpk_lineitem_part_2#6497, cpfk_partsupp_lineitem#6465 AS cpfk_partsupp_lineitem_2#6498, cfpk_lineitem_orders#6466 AS cfpk_lineitem_orders_2#6499, cval_lineitem_l_quantity#6467 AS cval_lineitem_l_quantity_2#6500, cval_lineitem_l_extendedprice#6468 AS cval_lineitem_l_extendedprice_2#6501, cval_lineitem_l_discount#6469 AS cval_lineitem_l_discount_2#6502, cval_lineitem_l_tax#6470 AS cval_lineitem_l_tax_2#6503, cval_lineitem_l_returnflag#6471 AS cval_lineitem_l_returnflag_2#6504, cval_lineitem_l_linestatus#6472 AS cval_lineitem_l_linestatus_2#6505, cval_lineitem_l_commitdate#6473 AS cval_lineitem_l_commitdate_2#6506, cval_lineitem_l_receiptdate#6474 AS cval_lineitem_l_receiptdate_2#6507, cval_lineitem_l_shipinstruct#6475 AS cval_lineitem_l_shipinstruct_2#6508, cval_lineitem_l_shipmode#6476 AS cval_lineitem_l_shipmode_2#6509, cval_lineitem_l_comment#6477 AS cval_lineitem_l_comment_2#6510, cval_lineitem_l_shipdate#6478 AS cval_lineitem_l_shipdate_2#6511, cl_quantity#6479 AS cl_quantity_2#6512, cl_extendedprice#6480 AS cl_extendedprice_2#6513, cl_discount#6481 AS cl_discount_2#6514, ... 9 more fields]
            +- Relation[rid#6458,cpfk_orders_lineitem#6459,cpfk_supplier_lineitem#6460,cfpk_lineitem_supplier#6461,cfpk_lineitem_partsupp#6462,cpfk_part_lineitem#6463,cfpk_lineitem_part#6464,cpfk_partsupp_lineitem#6465,cfpk_lineitem_orders#6466,cval_lineitem_l_quantity#6467,cval_lineitem_l_extendedprice#6468,cval_lineitem_l_discount#6469,cval_lineitem_l_tax#6470,cval_lineitem_l_returnflag#6471,cval_lineitem_l_linestatus#6472,cval_lineitem_l_commitdate#6473,cval_lineitem_l_receiptdate#6474,cval_lineitem_l_shipinstruct#6475,cval_lineitem_l_shipmode#6476,cval_lineitem_l_comment#6477,cval_lineitem_l_shipdate#6478,cl_quantity#6479,cl_extendedprice#6480,cl_discount#6481,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=75006
Elapsed time: 6464ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/15 16:24:50 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:24:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6695L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:24:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6695L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#6697 AS rid_0#6714, cval_part_p_name#6698 AS cval_part_p_name_0#6715, cval_part_p_mfgr#6699 AS cval_part_p_mfgr_0#6716, cval_part_p_type#6700 AS cval_part_p_type_0#6717, cval_part_p_size#6701 AS cval_part_p_size_0#6718, cval_part_p_container#6702 AS cval_part_p_container_0#6719, cval_part_p_retailprice#6703 AS cval_part_p_retailprice_0#6720, cval_part_p_comment#6704 AS cval_part_p_comment_0#6721, cval_part_p_brand#6705 AS cval_part_p_brand_0#6722, cp_name#6706 AS cp_name_0#6723, cp_mfgr#6707 AS cp_mfgr_0#6724, cp_type#6708 AS cp_type_0#6725, cp_size#6709 AS cp_size_0#6726, cp_container#6710 AS cp_container_0#6727, cp_retailprice#6711 AS cp_retailprice_0#6728, cp_comment#6712 AS cp_comment_0#6729, cp_brand#6713 AS cp_brand_0#6730]
         :  :  +- Relation[rid#6697,cval_part_p_name#6698,cval_part_p_mfgr#6699,cval_part_p_type#6700,cval_part_p_size#6701,cval_part_p_container#6702,cval_part_p_retailprice#6703,cval_part_p_comment#6704,cval_part_p_brand#6705,cp_name#6706,cp_mfgr#6707,cp_type#6708,cp_size#6709,cp_container#6710,cp_retailprice#6711,cp_comment#6712,cp_brand#6713] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#6797 AS rid_0#6814, cval_part_p_name#6798 AS cval_part_p_name_0#6815, cval_part_p_mfgr#6799 AS cval_part_p_mfgr_0#6816, cval_part_p_type#6800 AS cval_part_p_type_0#6817, cval_part_p_size#6801 AS cval_part_p_size_0#6818, cval_part_p_container#6802 AS cval_part_p_container_0#6819, cval_part_p_retailprice#6803 AS cval_part_p_retailprice_0#6820, cval_part_p_comment#6804 AS cval_part_p_comment_0#6821, cval_part_p_brand#6805 AS cval_part_p_brand_0#6822, cp_name#6806 AS cp_name_0#6823, cp_mfgr#6807 AS cp_mfgr_0#6824, cp_type#6808 AS cp_type_0#6825, cp_size#6809 AS cp_size_0#6826, cp_container#6810 AS cp_container_0#6827, cp_retailprice#6811 AS cp_retailprice_0#6828, cp_comment#6812 AS cp_comment_0#6829, cp_brand#6813 AS cp_brand_0#6830]
         :     :  +- Relation[rid#6797,cval_part_p_name#6798,cval_part_p_mfgr#6799,cval_part_p_type#6800,cval_part_p_size#6801,cval_part_p_container#6802,cval_part_p_retailprice#6803,cval_part_p_comment#6804,cval_part_p_brand#6805,cp_name#6806,cp_mfgr#6807,cp_type#6808,cp_size#6809,cp_container#6810,cp_retailprice#6811,cp_comment#6812,cp_brand#6813] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#6831 AS rid_1#6864, cpfk_orders_lineitem#6832 AS cpfk_orders_lineitem_1#6865, cpfk_supplier_lineitem#6833 AS cpfk_supplier_lineitem_1#6866, cfpk_lineitem_supplier#6834 AS cfpk_lineitem_supplier_1#6867, cfpk_lineitem_partsupp#6835 AS cfpk_lineitem_partsupp_1#6868, cpfk_part_lineitem#6836 AS cpfk_part_lineitem_1#6869, cfpk_lineitem_part#6837 AS cfpk_lineitem_part_1#6870, cpfk_partsupp_lineitem#6838 AS cpfk_partsupp_lineitem_1#6871, cfpk_lineitem_orders#6839 AS cfpk_lineitem_orders_1#6872, cval_lineitem_l_quantity#6840 AS cval_lineitem_l_quantity_1#6873, cval_lineitem_l_extendedprice#6841 AS cval_lineitem_l_extendedprice_1#6874, cval_lineitem_l_discount#6842 AS cval_lineitem_l_discount_1#6875, cval_lineitem_l_tax#6843 AS cval_lineitem_l_tax_1#6876, cval_lineitem_l_returnflag#6844 AS cval_lineitem_l_returnflag_1#6877, cval_lineitem_l_linestatus#6845 AS cval_lineitem_l_linestatus_1#6878, cval_lineitem_l_commitdate#6846 AS cval_lineitem_l_commitdate_1#6879, cval_lineitem_l_receiptdate#6847 AS cval_lineitem_l_receiptdate_1#6880, cval_lineitem_l_shipinstruct#6848 AS cval_lineitem_l_shipinstruct_1#6881, cval_lineitem_l_shipmode#6849 AS cval_lineitem_l_shipmode_1#6882, cval_lineitem_l_comment#6850 AS cval_lineitem_l_comment_1#6883, cval_lineitem_l_shipdate#6851 AS cval_lineitem_l_shipdate_1#6884, cl_quantity#6852 AS cl_quantity_1#6885, cl_extendedprice#6853 AS cl_extendedprice_1#6886, cl_discount#6854 AS cl_discount_1#6887, ... 9 more fields]
         :        +- Relation[rid#6831,cpfk_orders_lineitem#6832,cpfk_supplier_lineitem#6833,cfpk_lineitem_supplier#6834,cfpk_lineitem_partsupp#6835,cpfk_part_lineitem#6836,cfpk_lineitem_part#6837,cpfk_partsupp_lineitem#6838,cfpk_lineitem_orders#6839,cval_lineitem_l_quantity#6840,cval_lineitem_l_extendedprice#6841,cval_lineitem_l_discount#6842,cval_lineitem_l_tax#6843,cval_lineitem_l_returnflag#6844,cval_lineitem_l_linestatus#6845,cval_lineitem_l_commitdate#6846,cval_lineitem_l_receiptdate#6847,cval_lineitem_l_shipinstruct#6848,cval_lineitem_l_shipmode#6849,cval_lineitem_l_comment#6850,cval_lineitem_l_shipdate#6851,cl_quantity#6852,cl_extendedprice#6853,cl_discount#6854,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6731 AS rid_1#6764, cpfk_orders_lineitem#6732 AS cpfk_orders_lineitem_1#6765, cpfk_supplier_lineitem#6733 AS cpfk_supplier_lineitem_1#6766, cfpk_lineitem_supplier#6734 AS cfpk_lineitem_supplier_1#6767, cfpk_lineitem_partsupp#6735 AS cfpk_lineitem_partsupp_1#6768, cpfk_part_lineitem#6736 AS cpfk_part_lineitem_1#6769, cfpk_lineitem_part#6737 AS cfpk_lineitem_part_1#6770, cpfk_partsupp_lineitem#6738 AS cpfk_partsupp_lineitem_1#6771, cfpk_lineitem_orders#6739 AS cfpk_lineitem_orders_1#6772, cval_lineitem_l_quantity#6740 AS cval_lineitem_l_quantity_1#6773, cval_lineitem_l_extendedprice#6741 AS cval_lineitem_l_extendedprice_1#6774, cval_lineitem_l_discount#6742 AS cval_lineitem_l_discount_1#6775, cval_lineitem_l_tax#6743 AS cval_lineitem_l_tax_1#6776, cval_lineitem_l_returnflag#6744 AS cval_lineitem_l_returnflag_1#6777, cval_lineitem_l_linestatus#6745 AS cval_lineitem_l_linestatus_1#6778, cval_lineitem_l_commitdate#6746 AS cval_lineitem_l_commitdate_1#6779, cval_lineitem_l_receiptdate#6747 AS cval_lineitem_l_receiptdate_1#6780, cval_lineitem_l_shipinstruct#6748 AS cval_lineitem_l_shipinstruct_1#6781, cval_lineitem_l_shipmode#6749 AS cval_lineitem_l_shipmode_1#6782, cval_lineitem_l_comment#6750 AS cval_lineitem_l_comment_1#6783, cval_lineitem_l_shipdate#6751 AS cval_lineitem_l_shipdate_1#6784, cl_quantity#6752 AS cl_quantity_1#6785, cl_extendedprice#6753 AS cl_extendedprice_1#6786, cl_discount#6754 AS cl_discount_1#6787, ... 9 more fields]
            +- Relation[rid#6731,cpfk_orders_lineitem#6732,cpfk_supplier_lineitem#6733,cfpk_lineitem_supplier#6734,cfpk_lineitem_partsupp#6735,cpfk_part_lineitem#6736,cfpk_lineitem_part#6737,cpfk_partsupp_lineitem#6738,cfpk_lineitem_orders#6739,cval_lineitem_l_quantity#6740,cval_lineitem_l_extendedprice#6741,cval_lineitem_l_discount#6742,cval_lineitem_l_tax#6743,cval_lineitem_l_returnflag#6744,cval_lineitem_l_linestatus#6745,cval_lineitem_l_commitdate#6746,cval_lineitem_l_receiptdate#6747,cval_lineitem_l_shipinstruct#6748,cval_lineitem_l_shipmode#6749,cval_lineitem_l_comment#6750,cval_lineitem_l_shipdate#6751,cl_quantity#6752,cl_extendedprice#6753,cl_discount#6754,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 98460ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/15 16:26:29 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:26:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6951L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:26:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:26:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:26:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:26:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:26:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:26:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:26:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:26:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6951L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#6953 AS rid_0#6970, cval_part_p_name#6954 AS cval_part_p_name_0#6971, cval_part_p_mfgr#6955 AS cval_part_p_mfgr_0#6972, cval_part_p_type#6956 AS cval_part_p_type_0#6973, cval_part_p_size#6957 AS cval_part_p_size_0#6974, cval_part_p_container#6958 AS cval_part_p_container_0#6975, cval_part_p_retailprice#6959 AS cval_part_p_retailprice_0#6976, cval_part_p_comment#6960 AS cval_part_p_comment_0#6977, cval_part_p_brand#6961 AS cval_part_p_brand_0#6978, cp_name#6962 AS cp_name_0#6979, cp_mfgr#6963 AS cp_mfgr_0#6980, cp_type#6964 AS cp_type_0#6981, cp_size#6965 AS cp_size_0#6982, cp_container#6966 AS cp_container_0#6983, cp_retailprice#6967 AS cp_retailprice_0#6984, cp_comment#6968 AS cp_comment_0#6985, cp_brand#6969 AS cp_brand_0#6986]
         :  :  :  :  +- Relation[rid#6953,cval_part_p_name#6954,cval_part_p_mfgr#6955,cval_part_p_type#6956,cval_part_p_size#6957,cval_part_p_container#6958,cval_part_p_retailprice#6959,cval_part_p_comment#6960,cval_part_p_brand#6961,cp_name#6962,cp_mfgr#6963,cp_type#6964,cp_size#6965,cp_container#6966,cp_retailprice#6967,cp_comment#6968,cp_brand#6969] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#6987 AS rid_0#7004, cval_part_p_name#6988 AS cval_part_p_name_0#7005, cval_part_p_mfgr#6989 AS cval_part_p_mfgr_0#7006, cval_part_p_type#6990 AS cval_part_p_type_0#7007, cval_part_p_size#6991 AS cval_part_p_size_0#7008, cval_part_p_container#6992 AS cval_part_p_container_0#7009, cval_part_p_retailprice#6993 AS cval_part_p_retailprice_0#7010, cval_part_p_comment#6994 AS cval_part_p_comment_0#7011, cval_part_p_brand#6995 AS cval_part_p_brand_0#7012, cp_name#6996 AS cp_name_0#7013, cp_mfgr#6997 AS cp_mfgr_0#7014, cp_type#6998 AS cp_type_0#7015, cp_size#6999 AS cp_size_0#7016, cp_container#7000 AS cp_container_0#7017, cp_retailprice#7001 AS cp_retailprice_0#7018, cp_comment#7002 AS cp_comment_0#7019, cp_brand#7003 AS cp_brand_0#7020]
         :  :  :        +- Relation[rid#6987,cval_part_p_name#6988,cval_part_p_mfgr#6989,cval_part_p_type#6990,cval_part_p_size#6991,cval_part_p_container#6992,cval_part_p_retailprice#6993,cval_part_p_comment#6994,cval_part_p_brand#6995,cp_name#6996,cp_mfgr#6997,cp_type#6998,cp_size#6999,cp_container#7000,cp_retailprice#7001,cp_comment#7002,cp_brand#7003] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#7021 AS rid_0#7038, cval_part_p_name#7022 AS cval_part_p_name_0#7039, cval_part_p_mfgr#7023 AS cval_part_p_mfgr_0#7040, cval_part_p_type#7024 AS cval_part_p_type_0#7041, cval_part_p_size#7025 AS cval_part_p_size_0#7042, cval_part_p_container#7026 AS cval_part_p_container_0#7043, cval_part_p_retailprice#7027 AS cval_part_p_retailprice_0#7044, cval_part_p_comment#7028 AS cval_part_p_comment_0#7045, cval_part_p_brand#7029 AS cval_part_p_brand_0#7046, cp_name#7030 AS cp_name_0#7047, cp_mfgr#7031 AS cp_mfgr_0#7048, cp_type#7032 AS cp_type_0#7049, cp_size#7033 AS cp_size_0#7050, cp_container#7034 AS cp_container_0#7051, cp_retailprice#7035 AS cp_retailprice_0#7052, cp_comment#7036 AS cp_comment_0#7053, cp_brand#7037 AS cp_brand_0#7054]
         :  :        +- Relation[rid#7021,cval_part_p_name#7022,cval_part_p_mfgr#7023,cval_part_p_type#7024,cval_part_p_size#7025,cval_part_p_container#7026,cval_part_p_retailprice#7027,cval_part_p_comment#7028,cval_part_p_brand#7029,cp_name#7030,cp_mfgr#7031,cp_type#7032,cp_size#7033,cp_container#7034,cp_retailprice#7035,cp_comment#7036,cp_brand#7037] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#7155 AS rid_1#7188, cpfk_orders_lineitem#7156 AS cpfk_orders_lineitem_1#7189, cpfk_supplier_lineitem#7157 AS cpfk_supplier_lineitem_1#7190, cfpk_lineitem_supplier#7158 AS cfpk_lineitem_supplier_1#7191, cfpk_lineitem_partsupp#7159 AS cfpk_lineitem_partsupp_1#7192, cpfk_part_lineitem#7160 AS cpfk_part_lineitem_1#7193, cfpk_lineitem_part#7161 AS cfpk_lineitem_part_1#7194, cpfk_partsupp_lineitem#7162 AS cpfk_partsupp_lineitem_1#7195, cfpk_lineitem_orders#7163 AS cfpk_lineitem_orders_1#7196, cval_lineitem_l_quantity#7164 AS cval_lineitem_l_quantity_1#7197, cval_lineitem_l_extendedprice#7165 AS cval_lineitem_l_extendedprice_1#7198, cval_lineitem_l_discount#7166 AS cval_lineitem_l_discount_1#7199, cval_lineitem_l_tax#7167 AS cval_lineitem_l_tax_1#7200, cval_lineitem_l_returnflag#7168 AS cval_lineitem_l_returnflag_1#7201, cval_lineitem_l_linestatus#7169 AS cval_lineitem_l_linestatus_1#7202, cval_lineitem_l_commitdate#7170 AS cval_lineitem_l_commitdate_1#7203, cval_lineitem_l_receiptdate#7171 AS cval_lineitem_l_receiptdate_1#7204, cval_lineitem_l_shipinstruct#7172 AS cval_lineitem_l_shipinstruct_1#7205, cval_lineitem_l_shipmode#7173 AS cval_lineitem_l_shipmode_1#7206, cval_lineitem_l_comment#7174 AS cval_lineitem_l_comment_1#7207, cval_lineitem_l_shipdate#7175 AS cval_lineitem_l_shipdate_1#7208, cl_quantity#7176 AS cl_quantity_1#7209, cl_extendedprice#7177 AS cl_extendedprice_1#7210, cl_discount#7178 AS cl_discount_1#7211, ... 9 more fields]
         :     +- Relation[rid#7155,cpfk_orders_lineitem#7156,cpfk_supplier_lineitem#7157,cfpk_lineitem_supplier#7158,cfpk_lineitem_partsupp#7159,cpfk_part_lineitem#7160,cfpk_lineitem_part#7161,cpfk_partsupp_lineitem#7162,cfpk_lineitem_orders#7163,cval_lineitem_l_quantity#7164,cval_lineitem_l_extendedprice#7165,cval_lineitem_l_discount#7166,cval_lineitem_l_tax#7167,cval_lineitem_l_returnflag#7168,cval_lineitem_l_linestatus#7169,cval_lineitem_l_commitdate#7170,cval_lineitem_l_receiptdate#7171,cval_lineitem_l_shipinstruct#7172,cval_lineitem_l_shipmode#7173,cval_lineitem_l_comment#7174,cval_lineitem_l_shipdate#7175,cl_quantity#7176,cl_extendedprice#7177,cl_discount#7178,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7055 AS rid_1#7088, cpfk_orders_lineitem#7056 AS cpfk_orders_lineitem_1#7089, cpfk_supplier_lineitem#7057 AS cpfk_supplier_lineitem_1#7090, cfpk_lineitem_supplier#7058 AS cfpk_lineitem_supplier_1#7091, cfpk_lineitem_partsupp#7059 AS cfpk_lineitem_partsupp_1#7092, cpfk_part_lineitem#7060 AS cpfk_part_lineitem_1#7093, cfpk_lineitem_part#7061 AS cfpk_lineitem_part_1#7094, cpfk_partsupp_lineitem#7062 AS cpfk_partsupp_lineitem_1#7095, cfpk_lineitem_orders#7063 AS cfpk_lineitem_orders_1#7096, cval_lineitem_l_quantity#7064 AS cval_lineitem_l_quantity_1#7097, cval_lineitem_l_extendedprice#7065 AS cval_lineitem_l_extendedprice_1#7098, cval_lineitem_l_discount#7066 AS cval_lineitem_l_discount_1#7099, cval_lineitem_l_tax#7067 AS cval_lineitem_l_tax_1#7100, cval_lineitem_l_returnflag#7068 AS cval_lineitem_l_returnflag_1#7101, cval_lineitem_l_linestatus#7069 AS cval_lineitem_l_linestatus_1#7102, cval_lineitem_l_commitdate#7070 AS cval_lineitem_l_commitdate_1#7103, cval_lineitem_l_receiptdate#7071 AS cval_lineitem_l_receiptdate_1#7104, cval_lineitem_l_shipinstruct#7072 AS cval_lineitem_l_shipinstruct_1#7105, cval_lineitem_l_shipmode#7073 AS cval_lineitem_l_shipmode_1#7106, cval_lineitem_l_comment#7074 AS cval_lineitem_l_comment_1#7107, cval_lineitem_l_shipdate#7075 AS cval_lineitem_l_shipdate_1#7108, cl_quantity#7076 AS cl_quantity_1#7109, cl_extendedprice#7077 AS cl_extendedprice_1#7110, cl_discount#7078 AS cl_discount_1#7111, ... 9 more fields]
            +- Relation[rid#7055,cpfk_orders_lineitem#7056,cpfk_supplier_lineitem#7057,cfpk_lineitem_supplier#7058,cfpk_lineitem_partsupp#7059,cpfk_part_lineitem#7060,cfpk_lineitem_part#7061,cpfk_partsupp_lineitem#7062,cfpk_lineitem_orders#7063,cval_lineitem_l_quantity#7064,cval_lineitem_l_extendedprice#7065,cval_lineitem_l_discount#7066,cval_lineitem_l_tax#7067,cval_lineitem_l_returnflag#7068,cval_lineitem_l_linestatus#7069,cval_lineitem_l_commitdate#7070,cval_lineitem_l_receiptdate#7071,cval_lineitem_l_shipinstruct#7072,cval_lineitem_l_shipmode#7073,cval_lineitem_l_comment#7074,cval_lineitem_l_shipdate#7075,cl_quantity#7076,cl_extendedprice#7077,cl_discount#7078,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=408
Elapsed time: 452ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 16:26:29 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:26:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7280L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:26:29 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:26:29 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:26:29 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:26:29 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:26:29 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:26:29 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:26:29 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:26:29 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:26:29 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:26:29 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:26:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7280L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#7282 AS rid_0#7289, cpfk_region_nation#7283 AS cpfk_region_nation_0#7290, cfpk_nation_region#7284 AS cfpk_nation_region_0#7291, cval_nation_n_name#7285 AS cval_nation_n_name_0#7292, cval_nation_n_comment#7286 AS cval_nation_n_comment_0#7293, cn_name#7287 AS cn_name_0#7294, cn_comment#7288 AS cn_comment_0#7295]
            :     :     :  :  :  :  :  +- Relation[rid#7282,cpfk_region_nation#7283,cfpk_nation_region#7284,cval_nation_n_name#7285,cval_nation_n_comment#7286,cn_name#7287,cn_comment#7288] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#7322 AS rid_0#7329, cpfk_region_nation#7323 AS cpfk_region_nation_0#7330, cfpk_nation_region#7324 AS cfpk_nation_region_0#7331, cval_nation_n_name#7325 AS cval_nation_n_name_0#7332, cval_nation_n_comment#7326 AS cval_nation_n_comment_0#7333, cn_name#7327 AS cn_name_0#7334, cn_comment#7328 AS cn_comment_0#7335]
            :     :     :  :  :  :     :  +- Relation[rid#7322,cpfk_region_nation#7323,cfpk_nation_region#7324,cval_nation_n_name#7325,cval_nation_n_comment#7326,cn_name#7327,cn_comment#7328] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#7336 AS rid_1#7349, cpfk_nation_supplier#7337 AS cpfk_nation_supplier_1#7350, cfpk_supplier_nation#7338 AS cfpk_supplier_nation_1#7351, cval_supplier_s_name#7339 AS cval_supplier_s_name_1#7352, cval_supplier_s_address#7340 AS cval_supplier_s_address_1#7353, cval_supplier_s_phone#7341 AS cval_supplier_s_phone_1#7354, cval_supplier_s_acctbal#7342 AS cval_supplier_s_acctbal_1#7355, cval_supplier_s_comment#7343 AS cval_supplier_s_comment_1#7356, cs_name#7344 AS cs_name_1#7357, cs_address#7345 AS cs_address_1#7358, cs_phone#7346 AS cs_phone_1#7359, cs_acctbal#7347 AS cs_acctbal_1#7360, cs_comment#7348 AS cs_comment_1#7361]
            :     :     :  :  :  :        +- Relation[rid#7336,cpfk_nation_supplier#7337,cfpk_supplier_nation#7338,cval_supplier_s_name#7339,cval_supplier_s_address#7340,cval_supplier_s_phone#7341,cval_supplier_s_acctbal#7342,cval_supplier_s_comment#7343,cs_name#7344,cs_address#7345,cs_phone#7346,cs_acctbal#7347,cs_comment#7348] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#7296 AS rid_1#7309, cpfk_nation_supplier#7297 AS cpfk_nation_supplier_1#7310, cfpk_supplier_nation#7298 AS cfpk_supplier_nation_1#7311, cval_supplier_s_name#7299 AS cval_supplier_s_name_1#7312, cval_supplier_s_address#7300 AS cval_supplier_s_address_1#7313, cval_supplier_s_phone#7301 AS cval_supplier_s_phone_1#7314, cval_supplier_s_acctbal#7302 AS cval_supplier_s_acctbal_1#7315, cval_supplier_s_comment#7303 AS cval_supplier_s_comment_1#7316, cs_name#7304 AS cs_name_1#7317, cs_address#7305 AS cs_address_1#7318, cs_phone#7306 AS cs_phone_1#7319, cs_acctbal#7307 AS cs_acctbal_1#7320, cs_comment#7308 AS cs_comment_1#7321]
            :     :     :  :  :     +- Relation[rid#7296,cpfk_nation_supplier#7297,cfpk_supplier_nation#7298,cval_supplier_s_name#7299,cval_supplier_s_address#7300,cval_supplier_s_phone#7301,cval_supplier_s_acctbal#7302,cval_supplier_s_comment#7303,cs_name#7304,cs_address#7305,cs_phone#7306,cs_acctbal#7307,cs_comment#7308] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#7428 AS rid_1#7441, cpfk_nation_supplier#7429 AS cpfk_nation_supplier_1#7442, cfpk_supplier_nation#7430 AS cfpk_supplier_nation_1#7443, cval_supplier_s_name#7431 AS cval_supplier_s_name_1#7444, cval_supplier_s_address#7432 AS cval_supplier_s_address_1#7445, cval_supplier_s_phone#7433 AS cval_supplier_s_phone_1#7446, cval_supplier_s_acctbal#7434 AS cval_supplier_s_acctbal_1#7447, cval_supplier_s_comment#7435 AS cval_supplier_s_comment_1#7448, cs_name#7436 AS cs_name_1#7449, cs_address#7437 AS cs_address_1#7450, cs_phone#7438 AS cs_phone_1#7451, cs_acctbal#7439 AS cs_acctbal_1#7452, cs_comment#7440 AS cs_comment_1#7453]
            :     :     :  :     :  +- Relation[rid#7428,cpfk_nation_supplier#7429,cfpk_supplier_nation#7430,cval_supplier_s_name#7431,cval_supplier_s_address#7432,cval_supplier_s_phone#7433,cval_supplier_s_acctbal#7434,cval_supplier_s_comment#7435,cs_name#7436,cs_address#7437,cs_phone#7438,cs_acctbal#7439,cs_comment#7440] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#7454 AS rid_2#7487, cpfk_orders_lineitem#7455 AS cpfk_orders_lineitem_2#7488, cpfk_supplier_lineitem#7456 AS cpfk_supplier_lineitem_2#7489, cfpk_lineitem_supplier#7457 AS cfpk_lineitem_supplier_2#7490, cfpk_lineitem_partsupp#7458 AS cfpk_lineitem_partsupp_2#7491, cpfk_part_lineitem#7459 AS cpfk_part_lineitem_2#7492, cfpk_lineitem_part#7460 AS cfpk_lineitem_part_2#7493, cpfk_partsupp_lineitem#7461 AS cpfk_partsupp_lineitem_2#7494, cfpk_lineitem_orders#7462 AS cfpk_lineitem_orders_2#7495, cval_lineitem_l_quantity#7463 AS cval_lineitem_l_quantity_2#7496, cval_lineitem_l_extendedprice#7464 AS cval_lineitem_l_extendedprice_2#7497, cval_lineitem_l_discount#7465 AS cval_lineitem_l_discount_2#7498, cval_lineitem_l_tax#7466 AS cval_lineitem_l_tax_2#7499, cval_lineitem_l_returnflag#7467 AS cval_lineitem_l_returnflag_2#7500, cval_lineitem_l_linestatus#7468 AS cval_lineitem_l_linestatus_2#7501, cval_lineitem_l_commitdate#7469 AS cval_lineitem_l_commitdate_2#7502, cval_lineitem_l_receiptdate#7470 AS cval_lineitem_l_receiptdate_2#7503, cval_lineitem_l_shipinstruct#7471 AS cval_lineitem_l_shipinstruct_2#7504, cval_lineitem_l_shipmode#7472 AS cval_lineitem_l_shipmode_2#7505, cval_lineitem_l_comment#7473 AS cval_lineitem_l_comment_2#7506, cval_lineitem_l_shipdate#7474 AS cval_lineitem_l_shipdate_2#7507, cl_quantity#7475 AS cl_quantity_2#7508, cl_extendedprice#7476 AS cl_extendedprice_2#7509, cl_discount#7477 AS cl_discount_2#7510, ... 9 more fields]
            :     :     :  :        +- Relation[rid#7454,cpfk_orders_lineitem#7455,cpfk_supplier_lineitem#7456,cfpk_lineitem_supplier#7457,cfpk_lineitem_partsupp#7458,cpfk_part_lineitem#7459,cfpk_lineitem_part#7460,cpfk_partsupp_lineitem#7461,cfpk_lineitem_orders#7462,cval_lineitem_l_quantity#7463,cval_lineitem_l_extendedprice#7464,cval_lineitem_l_discount#7465,cval_lineitem_l_tax#7466,cval_lineitem_l_returnflag#7467,cval_lineitem_l_linestatus#7468,cval_lineitem_l_commitdate#7469,cval_lineitem_l_receiptdate#7470,cval_lineitem_l_shipinstruct#7471,cval_lineitem_l_shipmode#7472,cval_lineitem_l_comment#7473,cval_lineitem_l_shipdate#7474,cl_quantity#7475,cl_extendedprice#7476,cl_discount#7477,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#7362 AS rid_2#7395, cpfk_orders_lineitem#7363 AS cpfk_orders_lineitem_2#7396, cpfk_supplier_lineitem#7364 AS cpfk_supplier_lineitem_2#7397, cfpk_lineitem_supplier#7365 AS cfpk_lineitem_supplier_2#7398, cfpk_lineitem_partsupp#7366 AS cfpk_lineitem_partsupp_2#7399, cpfk_part_lineitem#7367 AS cpfk_part_lineitem_2#7400, cfpk_lineitem_part#7368 AS cfpk_lineitem_part_2#7401, cpfk_partsupp_lineitem#7369 AS cpfk_partsupp_lineitem_2#7402, cfpk_lineitem_orders#7370 AS cfpk_lineitem_orders_2#7403, cval_lineitem_l_quantity#7371 AS cval_lineitem_l_quantity_2#7404, cval_lineitem_l_extendedprice#7372 AS cval_lineitem_l_extendedprice_2#7405, cval_lineitem_l_discount#7373 AS cval_lineitem_l_discount_2#7406, cval_lineitem_l_tax#7374 AS cval_lineitem_l_tax_2#7407, cval_lineitem_l_returnflag#7375 AS cval_lineitem_l_returnflag_2#7408, cval_lineitem_l_linestatus#7376 AS cval_lineitem_l_linestatus_2#7409, cval_lineitem_l_commitdate#7377 AS cval_lineitem_l_commitdate_2#7410, cval_lineitem_l_receiptdate#7378 AS cval_lineitem_l_receiptdate_2#7411, cval_lineitem_l_shipinstruct#7379 AS cval_lineitem_l_shipinstruct_2#7412, cval_lineitem_l_shipmode#7380 AS cval_lineitem_l_shipmode_2#7413, cval_lineitem_l_comment#7381 AS cval_lineitem_l_comment_2#7414, cval_lineitem_l_shipdate#7382 AS cval_lineitem_l_shipdate_2#7415, cl_quantity#7383 AS cl_quantity_2#7416, cl_extendedprice#7384 AS cl_extendedprice_2#7417, cl_discount#7385 AS cl_discount_2#7418, ... 9 more fields]
            :     :     :     +- Relation[rid#7362,cpfk_orders_lineitem#7363,cpfk_supplier_lineitem#7364,cfpk_lineitem_supplier#7365,cfpk_lineitem_partsupp#7366,cpfk_part_lineitem#7367,cfpk_lineitem_part#7368,cpfk_partsupp_lineitem#7369,cfpk_lineitem_orders#7370,cval_lineitem_l_quantity#7371,cval_lineitem_l_extendedprice#7372,cval_lineitem_l_discount#7373,cval_lineitem_l_tax#7374,cval_lineitem_l_returnflag#7375,cval_lineitem_l_linestatus#7376,cval_lineitem_l_commitdate#7377,cval_lineitem_l_receiptdate#7378,cval_lineitem_l_shipinstruct#7379,cval_lineitem_l_shipmode#7380,cval_lineitem_l_comment#7381,cval_lineitem_l_shipdate#7382,cl_quantity#7383,cl_extendedprice#7384,cl_discount#7385,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#7520 AS rid_3#7537, cval_part_p_name#7521 AS cval_part_p_name_3#7538, cval_part_p_mfgr#7522 AS cval_part_p_mfgr_3#7539, cval_part_p_type#7523 AS cval_part_p_type_3#7540, cval_part_p_size#7524 AS cval_part_p_size_3#7541, cval_part_p_container#7525 AS cval_part_p_container_3#7542, cval_part_p_retailprice#7526 AS cval_part_p_retailprice_3#7543, cval_part_p_comment#7527 AS cval_part_p_comment_3#7544, cval_part_p_brand#7528 AS cval_part_p_brand_3#7545, cp_name#7529 AS cp_name_3#7546, cp_mfgr#7530 AS cp_mfgr_3#7547, cp_type#7531 AS cp_type_3#7548, cp_size#7532 AS cp_size_3#7549, cp_container#7533 AS cp_container_3#7550, cp_retailprice#7534 AS cp_retailprice_3#7551, cp_comment#7535 AS cp_comment_3#7552, cp_brand#7536 AS cp_brand_3#7553]
            :     :        +- Relation[rid#7520,cval_part_p_name#7521,cval_part_p_mfgr#7522,cval_part_p_type#7523,cval_part_p_size#7524,cval_part_p_container#7525,cval_part_p_retailprice#7526,cval_part_p_comment#7527,cval_part_p_brand#7528,cp_name#7529,cp_mfgr#7530,cp_type#7531,cp_size#7532,cp_container#7533,cp_retailprice#7534,cp_comment#7535,cp_brand#7536] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#7554 AS rid_4#7565, cpfk_part_partsupp#7555 AS cpfk_part_partsupp_4#7566, cfpk_partsupp_part#7556 AS cfpk_partsupp_part_4#7567, cpfk_supplier_partsupp#7557 AS cpfk_supplier_partsupp_4#7568, cfpk_partsupp_supplier#7558 AS cfpk_partsupp_supplier_4#7569, cval_partsupp_ps_availqty#7559 AS cval_partsupp_ps_availqty_4#7570, cval_partsupp_ps_supplycost#7560 AS cval_partsupp_ps_supplycost_4#7571, cval_partsupp_ps_comment#7561 AS cval_partsupp_ps_comment_4#7572, cps_availqty#7562 AS cps_availqty_4#7573, cps_supplycost#7563 AS cps_supplycost_4#7574, cps_comment#7564 AS cps_comment_4#7575]
            :        +- Relation[rid#7554,cpfk_part_partsupp#7555,cfpk_partsupp_part#7556,cpfk_supplier_partsupp#7557,cfpk_partsupp_supplier#7558,cval_partsupp_ps_availqty#7559,cval_partsupp_ps_supplycost#7560,cval_partsupp_ps_comment#7561,cps_availqty#7562,cps_supplycost#7563,cps_comment#7564] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#7576 AS rid_5#7593, cpfk_customer_orders#7577 AS cpfk_customer_orders_5#7594, cfpk_orders_customer#7578 AS cfpk_orders_customer_5#7595, cval_orders_o_orderstatus#7579 AS cval_orders_o_orderstatus_5#7596, cval_orders_o_totalprice#7580 AS cval_orders_o_totalprice_5#7597, cval_orders_o_orderpriority#7581 AS cval_orders_o_orderpriority_5#7598, cval_orders_o_clerk#7582 AS cval_orders_o_clerk_5#7599, cval_orders_o_shippriority#7583 AS cval_orders_o_shippriority_5#7600, cval_orders_o_comment#7584 AS cval_orders_o_comment_5#7601, cval_orders_o_orderdate#7585 AS cval_orders_o_orderdate_5#7602, co_orderstatus#7586 AS co_orderstatus_5#7603, co_totalprice#7587 AS co_totalprice_5#7604, co_orderpriority#7588 AS co_orderpriority_5#7605, co_clerk#7589 AS co_clerk_5#7606, co_shippriority#7590 AS co_shippriority_5#7607, co_comment#7591 AS co_comment_5#7608, co_orderdate#7592 AS co_orderdate_5#7609]
               +- Relation[rid#7576,cpfk_customer_orders#7577,cfpk_orders_customer#7578,cval_orders_o_orderstatus#7579,cval_orders_o_totalprice#7580,cval_orders_o_orderpriority#7581,cval_orders_o_clerk#7582,cval_orders_o_shippriority#7583,cval_orders_o_comment#7584,cval_orders_o_orderdate#7585,co_orderstatus#7586,co_totalprice#7587,co_orderpriority#7588,co_clerk#7589,co_shippriority#7590,co_comment#7591,co_orderdate#7592] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 271037ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/15 16:31:00 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:31:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7736L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:31:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7736L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#7738 AS rid_0#7771, cpfk_orders_lineitem#7739 AS cpfk_orders_lineitem_0#7772, cpfk_supplier_lineitem#7740 AS cpfk_supplier_lineitem_0#7773, cfpk_lineitem_supplier#7741 AS cfpk_lineitem_supplier_0#7774, cfpk_lineitem_partsupp#7742 AS cfpk_lineitem_partsupp_0#7775, cpfk_part_lineitem#7743 AS cpfk_part_lineitem_0#7776, cfpk_lineitem_part#7744 AS cfpk_lineitem_part_0#7777, cpfk_partsupp_lineitem#7745 AS cpfk_partsupp_lineitem_0#7778, cfpk_lineitem_orders#7746 AS cfpk_lineitem_orders_0#7779, cval_lineitem_l_quantity#7747 AS cval_lineitem_l_quantity_0#7780, cval_lineitem_l_extendedprice#7748 AS cval_lineitem_l_extendedprice_0#7781, cval_lineitem_l_discount#7749 AS cval_lineitem_l_discount_0#7782, cval_lineitem_l_tax#7750 AS cval_lineitem_l_tax_0#7783, cval_lineitem_l_returnflag#7751 AS cval_lineitem_l_returnflag_0#7784, cval_lineitem_l_linestatus#7752 AS cval_lineitem_l_linestatus_0#7785, cval_lineitem_l_commitdate#7753 AS cval_lineitem_l_commitdate_0#7786, cval_lineitem_l_receiptdate#7754 AS cval_lineitem_l_receiptdate_0#7787, cval_lineitem_l_shipinstruct#7755 AS cval_lineitem_l_shipinstruct_0#7788, cval_lineitem_l_shipmode#7756 AS cval_lineitem_l_shipmode_0#7789, cval_lineitem_l_comment#7757 AS cval_lineitem_l_comment_0#7790, cval_lineitem_l_shipdate#7758 AS cval_lineitem_l_shipdate_0#7791, cl_quantity#7759 AS cl_quantity_0#7792, cl_extendedprice#7760 AS cl_extendedprice_0#7793, cl_discount#7761 AS cl_discount_0#7794, ... 9 more fields]
            :  +- Relation[rid#7738,cpfk_orders_lineitem#7739,cpfk_supplier_lineitem#7740,cfpk_lineitem_supplier#7741,cfpk_lineitem_partsupp#7742,cpfk_part_lineitem#7743,cfpk_lineitem_part#7744,cpfk_partsupp_lineitem#7745,cfpk_lineitem_orders#7746,cval_lineitem_l_quantity#7747,cval_lineitem_l_extendedprice#7748,cval_lineitem_l_discount#7749,cval_lineitem_l_tax#7750,cval_lineitem_l_returnflag#7751,cval_lineitem_l_linestatus#7752,cval_lineitem_l_commitdate#7753,cval_lineitem_l_receiptdate#7754,cval_lineitem_l_shipinstruct#7755,cval_lineitem_l_shipmode#7756,cval_lineitem_l_comment#7757,cval_lineitem_l_shipdate#7758,cl_quantity#7759,cl_extendedprice#7760,cl_discount#7761,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#7804 AS rid_1#7821, cpfk_customer_orders#7805 AS cpfk_customer_orders_1#7822, cfpk_orders_customer#7806 AS cfpk_orders_customer_1#7823, cval_orders_o_orderstatus#7807 AS cval_orders_o_orderstatus_1#7824, cval_orders_o_totalprice#7808 AS cval_orders_o_totalprice_1#7825, cval_orders_o_orderpriority#7809 AS cval_orders_o_orderpriority_1#7826, cval_orders_o_clerk#7810 AS cval_orders_o_clerk_1#7827, cval_orders_o_shippriority#7811 AS cval_orders_o_shippriority_1#7828, cval_orders_o_comment#7812 AS cval_orders_o_comment_1#7829, cval_orders_o_orderdate#7813 AS cval_orders_o_orderdate_1#7830, co_orderstatus#7814 AS co_orderstatus_1#7831, co_totalprice#7815 AS co_totalprice_1#7832, co_orderpriority#7816 AS co_orderpriority_1#7833, co_clerk#7817 AS co_clerk_1#7834, co_shippriority#7818 AS co_shippriority_1#7835, co_comment#7819 AS co_comment_1#7836, co_orderdate#7820 AS co_orderdate_1#7837]
               +- Relation[rid#7804,cpfk_customer_orders#7805,cfpk_orders_customer#7806,cval_orders_o_orderstatus#7807,cval_orders_o_totalprice#7808,cval_orders_o_orderpriority#7809,cval_orders_o_clerk#7810,cval_orders_o_shippriority#7811,cval_orders_o_comment#7812,cval_orders_o_orderdate#7813,co_orderstatus#7814,co_totalprice#7815,co_orderpriority#7816,co_clerk#7817,co_shippriority#7818,co_comment#7819,co_orderdate#7820] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 57660ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/15 16:31:58 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:31:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7892L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:31:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:31:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7892L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#7894 AS rid_0#7899, cval_region_r_name#7895 AS cval_region_r_name_0#7900, cval_region_r_comment#7896 AS cval_region_r_comment_0#7901, cr_name#7897 AS cr_name_0#7902, cr_comment#7898 AS cr_comment_0#7903]
         :  :  :  :  :  :  :  +- Relation[rid#7894,cval_region_r_name#7895,cval_region_r_comment#7896,cr_name#7897,cr_comment#7898] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#7904 AS rid_0#7909, cval_region_r_name#7905 AS cval_region_r_name_0#7910, cval_region_r_comment#7906 AS cval_region_r_comment_0#7911, cr_name#7907 AS cr_name_0#7912, cr_comment#7908 AS cr_comment_0#7913]
         :  :  :  :  :  :        +- Relation[rid#7904,cval_region_r_name#7905,cval_region_r_comment#7906,cr_name#7907,cr_comment#7908] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- Project [rid#7938 AS rid_1#7945, cpfk_region_nation#7939 AS cpfk_region_nation_1#7946, cfpk_nation_region#7940 AS cfpk_nation_region_1#7947, cval_nation_n_name#7941 AS cval_nation_n_name_1#7948, cval_nation_n_comment#7942 AS cval_nation_n_comment_1#7949, cn_name#7943 AS cn_name_1#7950, cn_comment#7944 AS cn_comment_1#7951]
         :  :  :  :  :     +- Relation[rid#7938,cpfk_region_nation#7939,cfpk_nation_region#7940,cval_nation_n_name#7941,cval_nation_n_comment#7942,cn_name#7943,cn_comment#7944] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#7914 AS rid_1#7921, cpfk_region_nation#7915 AS cpfk_region_nation_1#7922, cfpk_nation_region#7916 AS cfpk_nation_region_1#7923, cval_nation_n_name#7917 AS cval_nation_n_name_1#7924, cval_nation_n_comment#7918 AS cval_nation_n_comment_1#7925, cn_name#7919 AS cn_name_1#7926, cn_comment#7920 AS cn_comment_1#7927]
         :  :  :  :     +- Relation[rid#7914,cpfk_region_nation#7915,cfpk_nation_region#7916,cval_nation_n_name#7917,cval_nation_n_comment#7918,cn_name#7919,cn_comment#7920] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#7992 AS rid_2#8005, cpfk_nation_supplier#7993 AS cpfk_nation_supplier_2#8006, cfpk_supplier_nation#7994 AS cfpk_supplier_nation_2#8007, cval_supplier_s_name#7995 AS cval_supplier_s_name_2#8008, cval_supplier_s_address#7996 AS cval_supplier_s_address_2#8009, cval_supplier_s_phone#7997 AS cval_supplier_s_phone_2#8010, cval_supplier_s_acctbal#7998 AS cval_supplier_s_acctbal_2#8011, cval_supplier_s_comment#7999 AS cval_supplier_s_comment_2#8012, cs_name#8000 AS cs_name_2#8013, cs_address#8001 AS cs_address_2#8014, cs_phone#8002 AS cs_phone_2#8015, cs_acctbal#8003 AS cs_acctbal_2#8016, cs_comment#8004 AS cs_comment_2#8017]
         :  :  :     +- Relation[rid#7992,cpfk_nation_supplier#7993,cfpk_supplier_nation#7994,cval_supplier_s_name#7995,cval_supplier_s_address#7996,cval_supplier_s_phone#7997,cval_supplier_s_acctbal#7998,cval_supplier_s_comment#7999,cs_name#8000,cs_address#8001,cs_phone#8002,cs_acctbal#8003,cs_comment#8004] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#7952 AS rid_2#7965, cpfk_nation_supplier#7953 AS cpfk_nation_supplier_2#7966, cfpk_supplier_nation#7954 AS cfpk_supplier_nation_2#7967, cval_supplier_s_name#7955 AS cval_supplier_s_name_2#7968, cval_supplier_s_address#7956 AS cval_supplier_s_address_2#7969, cval_supplier_s_phone#7957 AS cval_supplier_s_phone_2#7970, cval_supplier_s_acctbal#7958 AS cval_supplier_s_acctbal_2#7971, cval_supplier_s_comment#7959 AS cval_supplier_s_comment_2#7972, cs_name#7960 AS cs_name_2#7973, cs_address#7961 AS cs_address_2#7974, cs_phone#7962 AS cs_phone_2#7975, cs_acctbal#7963 AS cs_acctbal_2#7976, cs_comment#7964 AS cs_comment_2#7977]
         :  :     +- Relation[rid#7952,cpfk_nation_supplier#7953,cfpk_supplier_nation#7954,cval_supplier_s_name#7955,cval_supplier_s_address#7956,cval_supplier_s_phone#7957,cval_supplier_s_acctbal#7958,cval_supplier_s_comment#7959,cs_name#7960,cs_address#7961,cs_phone#7962,cs_acctbal#7963,cs_comment#7964] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#8190 AS rid_4#8201, cpfk_part_partsupp#8191 AS cpfk_part_partsupp_4#8202, cfpk_partsupp_part#8192 AS cfpk_partsupp_part_4#8203, cpfk_supplier_partsupp#8193 AS cpfk_supplier_partsupp_4#8204, cfpk_partsupp_supplier#8194 AS cfpk_partsupp_supplier_4#8205, cval_partsupp_ps_availqty#8195 AS cval_partsupp_ps_availqty_4#8206, cval_partsupp_ps_supplycost#8196 AS cval_partsupp_ps_supplycost_4#8207, cval_partsupp_ps_comment#8197 AS cval_partsupp_ps_comment_4#8208, cps_availqty#8198 AS cps_availqty_4#8209, cps_supplycost#8199 AS cps_supplycost_4#8210, cps_comment#8200 AS cps_comment_4#8211]
         :     +- Relation[rid#8190,cpfk_part_partsupp#8191,cfpk_partsupp_part#8192,cpfk_supplier_partsupp#8193,cfpk_partsupp_supplier#8194,cval_partsupp_ps_availqty#8195,cval_partsupp_ps_supplycost#8196,cval_partsupp_ps_comment#8197,cps_availqty#8198,cps_supplycost#8199,cps_comment#8200] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#8018 AS rid_3#8035, cval_part_p_name#8019 AS cval_part_p_name_3#8036, cval_part_p_mfgr#8020 AS cval_part_p_mfgr_3#8037, cval_part_p_type#8021 AS cval_part_p_type_3#8038, cval_part_p_size#8022 AS cval_part_p_size_3#8039, cval_part_p_container#8023 AS cval_part_p_container_3#8040, cval_part_p_retailprice#8024 AS cval_part_p_retailprice_3#8041, cval_part_p_comment#8025 AS cval_part_p_comment_3#8042, cval_part_p_brand#8026 AS cval_part_p_brand_3#8043, cp_name#8027 AS cp_name_3#8044, cp_mfgr#8028 AS cp_mfgr_3#8045, cp_type#8029 AS cp_type_3#8046, cp_size#8030 AS cp_size_3#8047, cp_container#8031 AS cp_container_3#8048, cp_retailprice#8032 AS cp_retailprice_3#8049, cp_comment#8033 AS cp_comment_3#8050, cp_brand#8034 AS cp_brand_3#8051]
            :  :  :  +- Relation[rid#8018,cval_part_p_name#8019,cval_part_p_mfgr#8020,cval_part_p_type#8021,cval_part_p_size#8022,cval_part_p_container#8023,cval_part_p_retailprice#8024,cval_part_p_comment#8025,cval_part_p_brand#8026,cp_name#8027,cp_mfgr#8028,cp_type#8029,cp_size#8030,cp_container#8031,cp_retailprice#8032,cp_comment#8033,cp_brand#8034] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#8052 AS rid_3#8069, cval_part_p_name#8053 AS cval_part_p_name_3#8070, cval_part_p_mfgr#8054 AS cval_part_p_mfgr_3#8071, cval_part_p_type#8055 AS cval_part_p_type_3#8072, cval_part_p_size#8056 AS cval_part_p_size_3#8073, cval_part_p_container#8057 AS cval_part_p_container_3#8074, cval_part_p_retailprice#8058 AS cval_part_p_retailprice_3#8075, cval_part_p_comment#8059 AS cval_part_p_comment_3#8076, cval_part_p_brand#8060 AS cval_part_p_brand_3#8077, cp_name#8061 AS cp_name_3#8078, cp_mfgr#8062 AS cp_mfgr_3#8079, cp_type#8063 AS cp_type_3#8080, cp_size#8064 AS cp_size_3#8081, cp_container#8065 AS cp_container_3#8082, cp_retailprice#8066 AS cp_retailprice_3#8083, cp_comment#8067 AS cp_comment_3#8084, cp_brand#8068 AS cp_brand_3#8085]
            :  :        +- Relation[rid#8052,cval_part_p_name#8053,cval_part_p_mfgr#8054,cval_part_p_type#8055,cval_part_p_size#8056,cval_part_p_container#8057,cval_part_p_retailprice#8058,cval_part_p_comment#8059,cval_part_p_brand#8060,cp_name#8061,cp_mfgr#8062,cp_type#8063,cp_size#8064,cp_container#8065,cp_retailprice#8066,cp_comment#8067,cp_brand#8068] JDBCRelation(tpart) [numPartitions=1]
            :  +- Project [rid#8142 AS rid_4#8153, cpfk_part_partsupp#8143 AS cpfk_part_partsupp_4#8154, cfpk_partsupp_part#8144 AS cfpk_partsupp_part_4#8155, cpfk_supplier_partsupp#8145 AS cpfk_supplier_partsupp_4#8156, cfpk_partsupp_supplier#8146 AS cfpk_partsupp_supplier_4#8157, cval_partsupp_ps_availqty#8147 AS cval_partsupp_ps_availqty_4#8158, cval_partsupp_ps_supplycost#8148 AS cval_partsupp_ps_supplycost_4#8159, cval_partsupp_ps_comment#8149 AS cval_partsupp_ps_comment_4#8160, cps_availqty#8150 AS cps_availqty_4#8161, cps_supplycost#8151 AS cps_supplycost_4#8162, cps_comment#8152 AS cps_comment_4#8163]
            :     +- Relation[rid#8142,cpfk_part_partsupp#8143,cfpk_partsupp_part#8144,cpfk_supplier_partsupp#8145,cfpk_partsupp_supplier#8146,cval_partsupp_ps_availqty#8147,cval_partsupp_ps_supplycost#8148,cval_partsupp_ps_comment#8149,cps_availqty#8150,cps_supplycost#8151,cps_comment#8152] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#8086 AS rid_4#8097, cpfk_part_partsupp#8087 AS cpfk_part_partsupp_4#8098, cfpk_partsupp_part#8088 AS cfpk_partsupp_part_4#8099, cpfk_supplier_partsupp#8089 AS cpfk_supplier_partsupp_4#8100, cfpk_partsupp_supplier#8090 AS cfpk_partsupp_supplier_4#8101, cval_partsupp_ps_availqty#8091 AS cval_partsupp_ps_availqty_4#8102, cval_partsupp_ps_supplycost#8092 AS cval_partsupp_ps_supplycost_4#8103, cval_partsupp_ps_comment#8093 AS cval_partsupp_ps_comment_4#8104, cps_availqty#8094 AS cps_availqty_4#8105, cps_supplycost#8095 AS cps_supplycost_4#8106, cps_comment#8096 AS cps_comment_4#8107]
               +- Relation[rid#8086,cpfk_part_partsupp#8087,cfpk_partsupp_part#8088,cpfk_supplier_partsupp#8089,cfpk_partsupp_supplier#8090,cval_partsupp_ps_availqty#8091,cval_partsupp_ps_supplycost#8092,cval_partsupp_ps_comment#8093,cps_availqty#8094,cps_supplycost#8095,cps_comment#8096] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 1721ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/15 16:31:59 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:31:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8270L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:31:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#8270L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#8272 AS rid_0#8305, cpfk_orders_lineitem#8273 AS cpfk_orders_lineitem_0#8306, cpfk_supplier_lineitem#8274 AS cpfk_supplier_lineitem_0#8307, cfpk_lineitem_supplier#8275 AS cfpk_lineitem_supplier_0#8308, cfpk_lineitem_partsupp#8276 AS cfpk_lineitem_partsupp_0#8309, cpfk_part_lineitem#8277 AS cpfk_part_lineitem_0#8310, cfpk_lineitem_part#8278 AS cfpk_lineitem_part_0#8311, cpfk_partsupp_lineitem#8279 AS cpfk_partsupp_lineitem_0#8312, cfpk_lineitem_orders#8280 AS cfpk_lineitem_orders_0#8313, cval_lineitem_l_quantity#8281 AS cval_lineitem_l_quantity_0#8314, cval_lineitem_l_extendedprice#8282 AS cval_lineitem_l_extendedprice_0#8315, cval_lineitem_l_discount#8283 AS cval_lineitem_l_discount_0#8316, cval_lineitem_l_tax#8284 AS cval_lineitem_l_tax_0#8317, cval_lineitem_l_returnflag#8285 AS cval_lineitem_l_returnflag_0#8318, cval_lineitem_l_linestatus#8286 AS cval_lineitem_l_linestatus_0#8319, cval_lineitem_l_commitdate#8287 AS cval_lineitem_l_commitdate_0#8320, cval_lineitem_l_receiptdate#8288 AS cval_lineitem_l_receiptdate_0#8321, cval_lineitem_l_shipinstruct#8289 AS cval_lineitem_l_shipinstruct_0#8322, cval_lineitem_l_shipmode#8290 AS cval_lineitem_l_shipmode_0#8323, cval_lineitem_l_comment#8291 AS cval_lineitem_l_comment_0#8324, cval_lineitem_l_shipdate#8292 AS cval_lineitem_l_shipdate_0#8325, cl_quantity#8293 AS cl_quantity_0#8326, cl_extendedprice#8294 AS cl_extendedprice_0#8327, cl_discount#8295 AS cl_discount_0#8328, ... 9 more fields]
         +- Relation[rid#8272,cpfk_orders_lineitem#8273,cpfk_supplier_lineitem#8274,cfpk_lineitem_supplier#8275,cfpk_lineitem_partsupp#8276,cpfk_part_lineitem#8277,cfpk_lineitem_part#8278,cpfk_partsupp_lineitem#8279,cfpk_lineitem_orders#8280,cval_lineitem_l_quantity#8281,cval_lineitem_l_extendedprice#8282,cval_lineitem_l_discount#8283,cval_lineitem_l_tax#8284,cval_lineitem_l_returnflag#8285,cval_lineitem_l_linestatus#8286,cval_lineitem_l_commitdate#8287,cval_lineitem_l_receiptdate#8288,cval_lineitem_l_shipinstruct#8289,cval_lineitem_l_shipmode#8290,cval_lineitem_l_comment#8291,cval_lineitem_l_shipdate#8292,cl_quantity#8293,cl_extendedprice#8294,cl_discount#8295,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2997ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/15 16:32:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:32:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8378L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 16:32:02 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:32:02 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:32:02 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:32:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8378L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#8380 AS rid_0#8397, cval_part_p_name#8381 AS cval_part_p_name_0#8398, cval_part_p_mfgr#8382 AS cval_part_p_mfgr_0#8399, cval_part_p_type#8383 AS cval_part_p_type_0#8400, cval_part_p_size#8384 AS cval_part_p_size_0#8401, cval_part_p_container#8385 AS cval_part_p_container_0#8402, cval_part_p_retailprice#8386 AS cval_part_p_retailprice_0#8403, cval_part_p_comment#8387 AS cval_part_p_comment_0#8404, cval_part_p_brand#8388 AS cval_part_p_brand_0#8405, cp_name#8389 AS cp_name_0#8406, cp_mfgr#8390 AS cp_mfgr_0#8407, cp_type#8391 AS cp_type_0#8408, cp_size#8392 AS cp_size_0#8409, cp_container#8393 AS cp_container_0#8410, cp_retailprice#8394 AS cp_retailprice_0#8411, cp_comment#8395 AS cp_comment_0#8412, cp_brand#8396 AS cp_brand_0#8413]
         :  :  :  +- Relation[rid#8380,cval_part_p_name#8381,cval_part_p_mfgr#8382,cval_part_p_type#8383,cval_part_p_size#8384,cval_part_p_container#8385,cval_part_p_retailprice#8386,cval_part_p_comment#8387,cval_part_p_brand#8388,cp_name#8389,cp_mfgr#8390,cp_type#8391,cp_size#8392,cp_container#8393,cp_retailprice#8394,cp_comment#8395,cp_brand#8396] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#8414 AS rid_0#8431, cval_part_p_name#8415 AS cval_part_p_name_0#8432, cval_part_p_mfgr#8416 AS cval_part_p_mfgr_0#8433, cval_part_p_type#8417 AS cval_part_p_type_0#8434, cval_part_p_size#8418 AS cval_part_p_size_0#8435, cval_part_p_container#8419 AS cval_part_p_container_0#8436, cval_part_p_retailprice#8420 AS cval_part_p_retailprice_0#8437, cval_part_p_comment#8421 AS cval_part_p_comment_0#8438, cval_part_p_brand#8422 AS cval_part_p_brand_0#8439, cp_name#8423 AS cp_name_0#8440, cp_mfgr#8424 AS cp_mfgr_0#8441, cp_type#8425 AS cp_type_0#8442, cp_size#8426 AS cp_size_0#8443, cp_container#8427 AS cp_container_0#8444, cp_retailprice#8428 AS cp_retailprice_0#8445, cp_comment#8429 AS cp_comment_0#8446, cp_brand#8430 AS cp_brand_0#8447]
         :  :        +- Relation[rid#8414,cval_part_p_name#8415,cval_part_p_mfgr#8416,cval_part_p_type#8417,cval_part_p_size#8418,cval_part_p_container#8419,cval_part_p_retailprice#8420,cval_part_p_comment#8421,cval_part_p_brand#8422,cp_name#8423,cp_mfgr#8424,cp_type#8425,cp_size#8426,cp_container#8427,cp_retailprice#8428,cp_comment#8429,cp_brand#8430] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#8504 AS rid_1#8515, cpfk_part_partsupp#8505 AS cpfk_part_partsupp_1#8516, cfpk_partsupp_part#8506 AS cfpk_partsupp_part_1#8517, cpfk_supplier_partsupp#8507 AS cpfk_supplier_partsupp_1#8518, cfpk_partsupp_supplier#8508 AS cfpk_partsupp_supplier_1#8519, cval_partsupp_ps_availqty#8509 AS cval_partsupp_ps_availqty_1#8520, cval_partsupp_ps_supplycost#8510 AS cval_partsupp_ps_supplycost_1#8521, cval_partsupp_ps_comment#8511 AS cval_partsupp_ps_comment_1#8522, cps_availqty#8512 AS cps_availqty_1#8523, cps_supplycost#8513 AS cps_supplycost_1#8524, cps_comment#8514 AS cps_comment_1#8525]
         :     +- Relation[rid#8504,cpfk_part_partsupp#8505,cfpk_partsupp_part#8506,cpfk_supplier_partsupp#8507,cfpk_partsupp_supplier#8508,cval_partsupp_ps_availqty#8509,cval_partsupp_ps_supplycost#8510,cval_partsupp_ps_comment#8511,cps_availqty#8512,cps_supplycost#8513,cps_comment#8514] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#8448 AS rid_1#8459, cpfk_part_partsupp#8449 AS cpfk_part_partsupp_1#8460, cfpk_partsupp_part#8450 AS cfpk_partsupp_part_1#8461, cpfk_supplier_partsupp#8451 AS cpfk_supplier_partsupp_1#8462, cfpk_partsupp_supplier#8452 AS cfpk_partsupp_supplier_1#8463, cval_partsupp_ps_availqty#8453 AS cval_partsupp_ps_availqty_1#8464, cval_partsupp_ps_supplycost#8454 AS cval_partsupp_ps_supplycost_1#8465, cval_partsupp_ps_comment#8455 AS cval_partsupp_ps_comment_1#8466, cps_availqty#8456 AS cps_availqty_1#8467, cps_supplycost#8457 AS cps_supplycost_1#8468, cps_comment#8458 AS cps_comment_1#8469]
            +- Relation[rid#8448,cpfk_part_partsupp#8449,cfpk_partsupp_part#8450,cpfk_supplier_partsupp#8451,cfpk_partsupp_supplier#8452,cval_partsupp_ps_availqty#8453,cval_partsupp_ps_supplycost#8454,cval_partsupp_ps_comment#8455,cps_availqty#8456,cps_supplycost#8457,cps_comment#8458] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=7890
Elapsed time: 516ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/15 16:32:03 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:32:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8559L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 16:32:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8559L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#8561 AS rid_0#8578, cpfk_customer_orders#8562 AS cpfk_customer_orders_0#8579, cfpk_orders_customer#8563 AS cfpk_orders_customer_0#8580, cval_orders_o_orderstatus#8564 AS cval_orders_o_orderstatus_0#8581, cval_orders_o_totalprice#8565 AS cval_orders_o_totalprice_0#8582, cval_orders_o_orderpriority#8566 AS cval_orders_o_orderpriority_0#8583, cval_orders_o_clerk#8567 AS cval_orders_o_clerk_0#8584, cval_orders_o_shippriority#8568 AS cval_orders_o_shippriority_0#8585, cval_orders_o_comment#8569 AS cval_orders_o_comment_0#8586, cval_orders_o_orderdate#8570 AS cval_orders_o_orderdate_0#8587, co_orderstatus#8571 AS co_orderstatus_0#8588, co_totalprice#8572 AS co_totalprice_0#8589, co_orderpriority#8573 AS co_orderpriority_0#8590, co_clerk#8574 AS co_clerk_0#8591, co_shippriority#8575 AS co_shippriority_0#8592, co_comment#8576 AS co_comment_0#8593, co_orderdate#8577 AS co_orderdate_0#8594]
            :  +- Relation[rid#8561,cpfk_customer_orders#8562,cfpk_orders_customer#8563,cval_orders_o_orderstatus#8564,cval_orders_o_totalprice#8565,cval_orders_o_orderpriority#8566,cval_orders_o_clerk#8567,cval_orders_o_shippriority#8568,cval_orders_o_comment#8569,cval_orders_o_orderdate#8570,co_orderstatus#8571,co_totalprice#8572,co_orderpriority#8573,co_clerk#8574,co_shippriority#8575,co_comment#8576,co_orderdate#8577] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#8595 AS rid_1#8610, cpfk_nation_customer#8596 AS cpfk_nation_customer_1#8611, cfpk_customer_nation#8597 AS cfpk_customer_nation_1#8612, cval_customer_c_name#8598 AS cval_customer_c_name_1#8613, cval_customer_c_address#8599 AS cval_customer_c_address_1#8614, cval_customer_c_phone#8600 AS cval_customer_c_phone_1#8615, cval_customer_c_acctbal#8601 AS cval_customer_c_acctbal_1#8616, cval_customer_c_comment#8602 AS cval_customer_c_comment_1#8617, cval_customer_c_mktsegment#8603 AS cval_customer_c_mktsegment_1#8618, cc_name#8604 AS cc_name_1#8619, cc_address#8605 AS cc_address_1#8620, cc_phone#8606 AS cc_phone_1#8621, cc_acctbal#8607 AS cc_acctbal_1#8622, cc_comment#8608 AS cc_comment_1#8623, cc_mktsegment#8609 AS cc_mktsegment_1#8624]
               +- Relation[rid#8595,cpfk_nation_customer#8596,cfpk_customer_nation#8597,cval_customer_c_name#8598,cval_customer_c_address#8599,cval_customer_c_phone#8600,cval_customer_c_acctbal#8601,cval_customer_c_comment#8602,cval_customer_c_mktsegment#8603,cc_name#8604,cc_address#8605,cc_phone#8606,cc_acctbal#8607,cc_comment#8608,cc_mktsegment#8609] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13903ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/15 16:32:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:32:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8661L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 16:32:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:32:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:32:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:32:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:32:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:32:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:32:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:32:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8661L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#8663 AS rid_0#8696, cpfk_orders_lineitem#8664 AS cpfk_orders_lineitem_0#8697, cpfk_supplier_lineitem#8665 AS cpfk_supplier_lineitem_0#8698, cfpk_lineitem_supplier#8666 AS cfpk_lineitem_supplier_0#8699, cfpk_lineitem_partsupp#8667 AS cfpk_lineitem_partsupp_0#8700, cpfk_part_lineitem#8668 AS cpfk_part_lineitem_0#8701, cfpk_lineitem_part#8669 AS cfpk_lineitem_part_0#8702, cpfk_partsupp_lineitem#8670 AS cpfk_partsupp_lineitem_0#8703, cfpk_lineitem_orders#8671 AS cfpk_lineitem_orders_0#8704, cval_lineitem_l_quantity#8672 AS cval_lineitem_l_quantity_0#8705, cval_lineitem_l_extendedprice#8673 AS cval_lineitem_l_extendedprice_0#8706, cval_lineitem_l_discount#8674 AS cval_lineitem_l_discount_0#8707, cval_lineitem_l_tax#8675 AS cval_lineitem_l_tax_0#8708, cval_lineitem_l_returnflag#8676 AS cval_lineitem_l_returnflag_0#8709, cval_lineitem_l_linestatus#8677 AS cval_lineitem_l_linestatus_0#8710, cval_lineitem_l_commitdate#8678 AS cval_lineitem_l_commitdate_0#8711, cval_lineitem_l_receiptdate#8679 AS cval_lineitem_l_receiptdate_0#8712, cval_lineitem_l_shipinstruct#8680 AS cval_lineitem_l_shipinstruct_0#8713, cval_lineitem_l_shipmode#8681 AS cval_lineitem_l_shipmode_0#8714, cval_lineitem_l_comment#8682 AS cval_lineitem_l_comment_0#8715, cval_lineitem_l_shipdate#8683 AS cval_lineitem_l_shipdate_0#8716, cl_quantity#8684 AS cl_quantity_0#8717, cl_extendedprice#8685 AS cl_extendedprice_0#8718, cl_discount#8686 AS cl_discount_0#8719, ... 9 more fields]
            :  +- Relation[rid#8663,cpfk_orders_lineitem#8664,cpfk_supplier_lineitem#8665,cfpk_lineitem_supplier#8666,cfpk_lineitem_partsupp#8667,cpfk_part_lineitem#8668,cfpk_lineitem_part#8669,cpfk_partsupp_lineitem#8670,cfpk_lineitem_orders#8671,cval_lineitem_l_quantity#8672,cval_lineitem_l_extendedprice#8673,cval_lineitem_l_discount#8674,cval_lineitem_l_tax#8675,cval_lineitem_l_returnflag#8676,cval_lineitem_l_linestatus#8677,cval_lineitem_l_commitdate#8678,cval_lineitem_l_receiptdate#8679,cval_lineitem_l_shipinstruct#8680,cval_lineitem_l_shipmode#8681,cval_lineitem_l_comment#8682,cval_lineitem_l_shipdate#8683,cl_quantity#8684,cl_extendedprice#8685,cl_discount#8686,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#8729 AS rid_1#8746, cpfk_customer_orders#8730 AS cpfk_customer_orders_1#8747, cfpk_orders_customer#8731 AS cfpk_orders_customer_1#8748, cval_orders_o_orderstatus#8732 AS cval_orders_o_orderstatus_1#8749, cval_orders_o_totalprice#8733 AS cval_orders_o_totalprice_1#8750, cval_orders_o_orderpriority#8734 AS cval_orders_o_orderpriority_1#8751, cval_orders_o_clerk#8735 AS cval_orders_o_clerk_1#8752, cval_orders_o_shippriority#8736 AS cval_orders_o_shippriority_1#8753, cval_orders_o_comment#8737 AS cval_orders_o_comment_1#8754, cval_orders_o_orderdate#8738 AS cval_orders_o_orderdate_1#8755, co_orderstatus#8739 AS co_orderstatus_1#8756, co_totalprice#8740 AS co_totalprice_1#8757, co_orderpriority#8741 AS co_orderpriority_1#8758, co_clerk#8742 AS co_clerk_1#8759, co_shippriority#8743 AS co_shippriority_1#8760, co_comment#8744 AS co_comment_1#8761, co_orderdate#8745 AS co_orderdate_1#8762]
                  :     :  :  :  :  +- Relation[rid#8729,cpfk_customer_orders#8730,cfpk_orders_customer#8731,cval_orders_o_orderstatus#8732,cval_orders_o_totalprice#8733,cval_orders_o_orderpriority#8734,cval_orders_o_clerk#8735,cval_orders_o_shippriority#8736,cval_orders_o_comment#8737,cval_orders_o_orderdate#8738,co_orderstatus#8739,co_totalprice#8740,co_orderpriority#8741,co_clerk#8742,co_shippriority#8743,co_comment#8744,co_orderdate#8745] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#8763 AS rid_1#8780, cpfk_customer_orders#8764 AS cpfk_customer_orders_1#8781, cfpk_orders_customer#8765 AS cfpk_orders_customer_1#8782, cval_orders_o_orderstatus#8766 AS cval_orders_o_orderstatus_1#8783, cval_orders_o_totalprice#8767 AS cval_orders_o_totalprice_1#8784, cval_orders_o_orderpriority#8768 AS cval_orders_o_orderpriority_1#8785, cval_orders_o_clerk#8769 AS cval_orders_o_clerk_1#8786, cval_orders_o_shippriority#8770 AS cval_orders_o_shippriority_1#8787, cval_orders_o_comment#8771 AS cval_orders_o_comment_1#8788, cval_orders_o_orderdate#8772 AS cval_orders_o_orderdate_1#8789, co_orderstatus#8773 AS co_orderstatus_1#8790, co_totalprice#8774 AS co_totalprice_1#8791, co_orderpriority#8775 AS co_orderpriority_1#8792, co_clerk#8776 AS co_clerk_1#8793, co_shippriority#8777 AS co_shippriority_1#8794, co_comment#8778 AS co_comment_1#8795, co_orderdate#8779 AS co_orderdate_1#8796]
                  :     :  :  :        +- Relation[rid#8763,cpfk_customer_orders#8764,cfpk_orders_customer#8765,cval_orders_o_orderstatus#8766,cval_orders_o_totalprice#8767,cval_orders_o_orderpriority#8768,cval_orders_o_clerk#8769,cval_orders_o_shippriority#8770,cval_orders_o_comment#8771,cval_orders_o_orderdate#8772,co_orderstatus#8773,co_totalprice#8774,co_orderpriority#8775,co_clerk#8776,co_shippriority#8777,co_comment#8778,co_orderdate#8779] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- Project [rid#8897 AS rid_2#8930, cpfk_orders_lineitem#8898 AS cpfk_orders_lineitem_2#8931, cpfk_supplier_lineitem#8899 AS cpfk_supplier_lineitem_2#8932, cfpk_lineitem_supplier#8900 AS cfpk_lineitem_supplier_2#8933, cfpk_lineitem_partsupp#8901 AS cfpk_lineitem_partsupp_2#8934, cpfk_part_lineitem#8902 AS cpfk_part_lineitem_2#8935, cfpk_lineitem_part#8903 AS cfpk_lineitem_part_2#8936, cpfk_partsupp_lineitem#8904 AS cpfk_partsupp_lineitem_2#8937, cfpk_lineitem_orders#8905 AS cfpk_lineitem_orders_2#8938, cval_lineitem_l_quantity#8906 AS cval_lineitem_l_quantity_2#8939, cval_lineitem_l_extendedprice#8907 AS cval_lineitem_l_extendedprice_2#8940, cval_lineitem_l_discount#8908 AS cval_lineitem_l_discount_2#8941, cval_lineitem_l_tax#8909 AS cval_lineitem_l_tax_2#8942, cval_lineitem_l_returnflag#8910 AS cval_lineitem_l_returnflag_2#8943, cval_lineitem_l_linestatus#8911 AS cval_lineitem_l_linestatus_2#8944, cval_lineitem_l_commitdate#8912 AS cval_lineitem_l_commitdate_2#8945, cval_lineitem_l_receiptdate#8913 AS cval_lineitem_l_receiptdate_2#8946, cval_lineitem_l_shipinstruct#8914 AS cval_lineitem_l_shipinstruct_2#8947, cval_lineitem_l_shipmode#8915 AS cval_lineitem_l_shipmode_2#8948, cval_lineitem_l_comment#8916 AS cval_lineitem_l_comment_2#8949, cval_lineitem_l_shipdate#8917 AS cval_lineitem_l_shipdate_2#8950, cl_quantity#8918 AS cl_quantity_2#8951, cl_extendedprice#8919 AS cl_extendedprice_2#8952, cl_discount#8920 AS cl_discount_2#8953, ... 9 more fields]
                  :     :  :     +- Relation[rid#8897,cpfk_orders_lineitem#8898,cpfk_supplier_lineitem#8899,cfpk_lineitem_supplier#8900,cfpk_lineitem_partsupp#8901,cpfk_part_lineitem#8902,cfpk_lineitem_part#8903,cpfk_partsupp_lineitem#8904,cfpk_lineitem_orders#8905,cval_lineitem_l_quantity#8906,cval_lineitem_l_extendedprice#8907,cval_lineitem_l_discount#8908,cval_lineitem_l_tax#8909,cval_lineitem_l_returnflag#8910,cval_lineitem_l_linestatus#8911,cval_lineitem_l_commitdate#8912,cval_lineitem_l_receiptdate#8913,cval_lineitem_l_shipinstruct#8914,cval_lineitem_l_shipmode#8915,cval_lineitem_l_comment#8916,cval_lineitem_l_shipdate#8917,cl_quantity#8918,cl_extendedprice#8919,cl_discount#8920,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#8797 AS rid_2#8830, cpfk_orders_lineitem#8798 AS cpfk_orders_lineitem_2#8831, cpfk_supplier_lineitem#8799 AS cpfk_supplier_lineitem_2#8832, cfpk_lineitem_supplier#8800 AS cfpk_lineitem_supplier_2#8833, cfpk_lineitem_partsupp#8801 AS cfpk_lineitem_partsupp_2#8834, cpfk_part_lineitem#8802 AS cpfk_part_lineitem_2#8835, cfpk_lineitem_part#8803 AS cfpk_lineitem_part_2#8836, cpfk_partsupp_lineitem#8804 AS cpfk_partsupp_lineitem_2#8837, cfpk_lineitem_orders#8805 AS cfpk_lineitem_orders_2#8838, cval_lineitem_l_quantity#8806 AS cval_lineitem_l_quantity_2#8839, cval_lineitem_l_extendedprice#8807 AS cval_lineitem_l_extendedprice_2#8840, cval_lineitem_l_discount#8808 AS cval_lineitem_l_discount_2#8841, cval_lineitem_l_tax#8809 AS cval_lineitem_l_tax_2#8842, cval_lineitem_l_returnflag#8810 AS cval_lineitem_l_returnflag_2#8843, cval_lineitem_l_linestatus#8811 AS cval_lineitem_l_linestatus_2#8844, cval_lineitem_l_commitdate#8812 AS cval_lineitem_l_commitdate_2#8845, cval_lineitem_l_receiptdate#8813 AS cval_lineitem_l_receiptdate_2#8846, cval_lineitem_l_shipinstruct#8814 AS cval_lineitem_l_shipinstruct_2#8847, cval_lineitem_l_shipmode#8815 AS cval_lineitem_l_shipmode_2#8848, cval_lineitem_l_comment#8816 AS cval_lineitem_l_comment_2#8849, cval_lineitem_l_shipdate#8817 AS cval_lineitem_l_shipdate_2#8850, cl_quantity#8818 AS cl_quantity_2#8851, cl_extendedprice#8819 AS cl_extendedprice_2#8852, cl_discount#8820 AS cl_discount_2#8853, ... 9 more fields]
                  :     :     +- Relation[rid#8797,cpfk_orders_lineitem#8798,cpfk_supplier_lineitem#8799,cfpk_lineitem_supplier#8800,cfpk_lineitem_partsupp#8801,cpfk_part_lineitem#8802,cfpk_lineitem_part#8803,cpfk_partsupp_lineitem#8804,cfpk_lineitem_orders#8805,cval_lineitem_l_quantity#8806,cval_lineitem_l_extendedprice#8807,cval_lineitem_l_discount#8808,cval_lineitem_l_tax#8809,cval_lineitem_l_returnflag#8810,cval_lineitem_l_linestatus#8811,cval_lineitem_l_commitdate#8812,cval_lineitem_l_receiptdate#8813,cval_lineitem_l_shipinstruct#8814,cval_lineitem_l_shipmode#8815,cval_lineitem_l_comment#8816,cval_lineitem_l_shipdate#8817,cl_quantity#8818,cl_extendedprice#8819,cl_discount#8820,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#8963 AS rid_3#8976, cpfk_nation_supplier#8964 AS cpfk_nation_supplier_3#8977, cfpk_supplier_nation#8965 AS cfpk_supplier_nation_3#8978, cval_supplier_s_name#8966 AS cval_supplier_s_name_3#8979, cval_supplier_s_address#8967 AS cval_supplier_s_address_3#8980, cval_supplier_s_phone#8968 AS cval_supplier_s_phone_3#8981, cval_supplier_s_acctbal#8969 AS cval_supplier_s_acctbal_3#8982, cval_supplier_s_comment#8970 AS cval_supplier_s_comment_3#8983, cs_name#8971 AS cs_name_3#8984, cs_address#8972 AS cs_address_3#8985, cs_phone#8973 AS cs_phone_3#8986, cs_acctbal#8974 AS cs_acctbal_3#8987, cs_comment#8975 AS cs_comment_3#8988]
                  :        +- Relation[rid#8963,cpfk_nation_supplier#8964,cfpk_supplier_nation#8965,cval_supplier_s_name#8966,cval_supplier_s_address#8967,cval_supplier_s_phone#8968,cval_supplier_s_acctbal#8969,cval_supplier_s_comment#8970,cs_name#8971,cs_address#8972,cs_phone#8973,cs_acctbal#8974,cs_comment#8975] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#8989 AS rid_4#8996, cpfk_region_nation#8990 AS cpfk_region_nation_4#8997, cfpk_nation_region#8991 AS cfpk_nation_region_4#8998, cval_nation_n_name#8992 AS cval_nation_n_name_4#8999, cval_nation_n_comment#8993 AS cval_nation_n_comment_4#9000, cn_name#8994 AS cn_name_4#9001, cn_comment#8995 AS cn_comment_4#9002]
                     :  +- Relation[rid#8989,cpfk_region_nation#8990,cfpk_nation_region#8991,cval_nation_n_name#8992,cval_nation_n_comment#8993,cn_name#8994,cn_comment#8995] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#9003 AS rid_4#9010, cpfk_region_nation#9004 AS cpfk_region_nation_4#9011, cfpk_nation_region#9005 AS cfpk_nation_region_4#9012, cval_nation_n_name#9006 AS cval_nation_n_name_4#9013, cval_nation_n_comment#9007 AS cval_nation_n_comment_4#9014, cn_name#9008 AS cn_name_4#9015, cn_comment#9009 AS cn_comment_4#9016]
                           +- Relation[rid#9003,cpfk_region_nation#9004,cfpk_nation_region#9005,cval_nation_n_name#9006,cval_nation_n_comment#9007,cn_name#9008,cn_comment#9009] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=120762
Elapsed time: 95091ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/15 16:33:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:33:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9132L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 16:33:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:33:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:33:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9132L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#9134 AS rid_0#9167, cpfk_orders_lineitem#9135 AS cpfk_orders_lineitem_0#9168, cpfk_supplier_lineitem#9136 AS cpfk_supplier_lineitem_0#9169, cfpk_lineitem_supplier#9137 AS cfpk_lineitem_supplier_0#9170, cfpk_lineitem_partsupp#9138 AS cfpk_lineitem_partsupp_0#9171, cpfk_part_lineitem#9139 AS cpfk_part_lineitem_0#9172, cfpk_lineitem_part#9140 AS cfpk_lineitem_part_0#9173, cpfk_partsupp_lineitem#9141 AS cpfk_partsupp_lineitem_0#9174, cfpk_lineitem_orders#9142 AS cfpk_lineitem_orders_0#9175, cval_lineitem_l_quantity#9143 AS cval_lineitem_l_quantity_0#9176, cval_lineitem_l_extendedprice#9144 AS cval_lineitem_l_extendedprice_0#9177, cval_lineitem_l_discount#9145 AS cval_lineitem_l_discount_0#9178, cval_lineitem_l_tax#9146 AS cval_lineitem_l_tax_0#9179, cval_lineitem_l_returnflag#9147 AS cval_lineitem_l_returnflag_0#9180, cval_lineitem_l_linestatus#9148 AS cval_lineitem_l_linestatus_0#9181, cval_lineitem_l_commitdate#9149 AS cval_lineitem_l_commitdate_0#9182, cval_lineitem_l_receiptdate#9150 AS cval_lineitem_l_receiptdate_0#9183, cval_lineitem_l_shipinstruct#9151 AS cval_lineitem_l_shipinstruct_0#9184, cval_lineitem_l_shipmode#9152 AS cval_lineitem_l_shipmode_0#9185, cval_lineitem_l_comment#9153 AS cval_lineitem_l_comment_0#9186, cval_lineitem_l_shipdate#9154 AS cval_lineitem_l_shipdate_0#9187, cl_quantity#9155 AS cl_quantity_0#9188, cl_extendedprice#9156 AS cl_extendedprice_0#9189, cl_discount#9157 AS cl_discount_0#9190, ... 9 more fields]
            :     :     :  :  +- Relation[rid#9134,cpfk_orders_lineitem#9135,cpfk_supplier_lineitem#9136,cfpk_lineitem_supplier#9137,cfpk_lineitem_partsupp#9138,cpfk_part_lineitem#9139,cfpk_lineitem_part#9140,cpfk_partsupp_lineitem#9141,cfpk_lineitem_orders#9142,cval_lineitem_l_quantity#9143,cval_lineitem_l_extendedprice#9144,cval_lineitem_l_discount#9145,cval_lineitem_l_tax#9146,cval_lineitem_l_returnflag#9147,cval_lineitem_l_linestatus#9148,cval_lineitem_l_commitdate#9149,cval_lineitem_l_receiptdate#9150,cval_lineitem_l_shipinstruct#9151,cval_lineitem_l_shipmode#9152,cval_lineitem_l_comment#9153,cval_lineitem_l_shipdate#9154,cl_quantity#9155,cl_extendedprice#9156,cl_discount#9157,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#9200 AS rid_0#9233, cpfk_orders_lineitem#9201 AS cpfk_orders_lineitem_0#9234, cpfk_supplier_lineitem#9202 AS cpfk_supplier_lineitem_0#9235, cfpk_lineitem_supplier#9203 AS cfpk_lineitem_supplier_0#9236, cfpk_lineitem_partsupp#9204 AS cfpk_lineitem_partsupp_0#9237, cpfk_part_lineitem#9205 AS cpfk_part_lineitem_0#9238, cfpk_lineitem_part#9206 AS cfpk_lineitem_part_0#9239, cpfk_partsupp_lineitem#9207 AS cpfk_partsupp_lineitem_0#9240, cfpk_lineitem_orders#9208 AS cfpk_lineitem_orders_0#9241, cval_lineitem_l_quantity#9209 AS cval_lineitem_l_quantity_0#9242, cval_lineitem_l_extendedprice#9210 AS cval_lineitem_l_extendedprice_0#9243, cval_lineitem_l_discount#9211 AS cval_lineitem_l_discount_0#9244, cval_lineitem_l_tax#9212 AS cval_lineitem_l_tax_0#9245, cval_lineitem_l_returnflag#9213 AS cval_lineitem_l_returnflag_0#9246, cval_lineitem_l_linestatus#9214 AS cval_lineitem_l_linestatus_0#9247, cval_lineitem_l_commitdate#9215 AS cval_lineitem_l_commitdate_0#9248, cval_lineitem_l_receiptdate#9216 AS cval_lineitem_l_receiptdate_0#9249, cval_lineitem_l_shipinstruct#9217 AS cval_lineitem_l_shipinstruct_0#9250, cval_lineitem_l_shipmode#9218 AS cval_lineitem_l_shipmode_0#9251, cval_lineitem_l_comment#9219 AS cval_lineitem_l_comment_0#9252, cval_lineitem_l_shipdate#9220 AS cval_lineitem_l_shipdate_0#9253, cl_quantity#9221 AS cl_quantity_0#9254, cl_extendedprice#9222 AS cl_extendedprice_0#9255, cl_discount#9223 AS cl_discount_0#9256, ... 9 more fields]
            :     :     :        +- Relation[rid#9200,cpfk_orders_lineitem#9201,cpfk_supplier_lineitem#9202,cfpk_lineitem_supplier#9203,cfpk_lineitem_partsupp#9204,cpfk_part_lineitem#9205,cfpk_lineitem_part#9206,cpfk_partsupp_lineitem#9207,cfpk_lineitem_orders#9208,cval_lineitem_l_quantity#9209,cval_lineitem_l_extendedprice#9210,cval_lineitem_l_discount#9211,cval_lineitem_l_tax#9212,cval_lineitem_l_returnflag#9213,cval_lineitem_l_linestatus#9214,cval_lineitem_l_commitdate#9215,cval_lineitem_l_receiptdate#9216,cval_lineitem_l_shipinstruct#9217,cval_lineitem_l_shipmode#9218,cval_lineitem_l_comment#9219,cval_lineitem_l_shipdate#9220,cl_quantity#9221,cl_extendedprice#9222,cl_discount#9223,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#9266 AS rid_1#9283, cpfk_customer_orders#9267 AS cpfk_customer_orders_1#9284, cfpk_orders_customer#9268 AS cfpk_orders_customer_1#9285, cval_orders_o_orderstatus#9269 AS cval_orders_o_orderstatus_1#9286, cval_orders_o_totalprice#9270 AS cval_orders_o_totalprice_1#9287, cval_orders_o_orderpriority#9271 AS cval_orders_o_orderpriority_1#9288, cval_orders_o_clerk#9272 AS cval_orders_o_clerk_1#9289, cval_orders_o_shippriority#9273 AS cval_orders_o_shippriority_1#9290, cval_orders_o_comment#9274 AS cval_orders_o_comment_1#9291, cval_orders_o_orderdate#9275 AS cval_orders_o_orderdate_1#9292, co_orderstatus#9276 AS co_orderstatus_1#9293, co_totalprice#9277 AS co_totalprice_1#9294, co_orderpriority#9278 AS co_orderpriority_1#9295, co_clerk#9279 AS co_clerk_1#9296, co_shippriority#9280 AS co_shippriority_1#9297, co_comment#9281 AS co_comment_1#9298, co_orderdate#9282 AS co_orderdate_1#9299]
            :     :        +- Relation[rid#9266,cpfk_customer_orders#9267,cfpk_orders_customer#9268,cval_orders_o_orderstatus#9269,cval_orders_o_totalprice#9270,cval_orders_o_orderpriority#9271,cval_orders_o_clerk#9272,cval_orders_o_shippriority#9273,cval_orders_o_comment#9274,cval_orders_o_orderdate#9275,co_orderstatus#9276,co_totalprice#9277,co_orderpriority#9278,co_clerk#9279,co_shippriority#9280,co_comment#9281,co_orderdate#9282] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#9300 AS rid_2#9315, cpfk_nation_customer#9301 AS cpfk_nation_customer_2#9316, cfpk_customer_nation#9302 AS cfpk_customer_nation_2#9317, cval_customer_c_name#9303 AS cval_customer_c_name_2#9318, cval_customer_c_address#9304 AS cval_customer_c_address_2#9319, cval_customer_c_phone#9305 AS cval_customer_c_phone_2#9320, cval_customer_c_acctbal#9306 AS cval_customer_c_acctbal_2#9321, cval_customer_c_comment#9307 AS cval_customer_c_comment_2#9322, cval_customer_c_mktsegment#9308 AS cval_customer_c_mktsegment_2#9323, cc_name#9309 AS cc_name_2#9324, cc_address#9310 AS cc_address_2#9325, cc_phone#9311 AS cc_phone_2#9326, cc_acctbal#9312 AS cc_acctbal_2#9327, cc_comment#9313 AS cc_comment_2#9328, cc_mktsegment#9314 AS cc_mktsegment_2#9329]
            :        +- Relation[rid#9300,cpfk_nation_customer#9301,cfpk_customer_nation#9302,cval_customer_c_name#9303,cval_customer_c_address#9304,cval_customer_c_phone#9305,cval_customer_c_acctbal#9306,cval_customer_c_comment#9307,cval_customer_c_mktsegment#9308,cc_name#9309,cc_address#9310,cc_phone#9311,cc_acctbal#9312,cc_comment#9313,cc_mktsegment#9314] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#9330 AS rid_3#9337, cpfk_region_nation#9331 AS cpfk_region_nation_3#9338, cfpk_nation_region#9332 AS cfpk_nation_region_3#9339, cval_nation_n_name#9333 AS cval_nation_n_name_3#9340, cval_nation_n_comment#9334 AS cval_nation_n_comment_3#9341, cn_name#9335 AS cn_name_3#9342, cn_comment#9336 AS cn_comment_3#9343]
               +- Relation[rid#9330,cpfk_region_nation#9331,cfpk_nation_region#9332,cval_nation_n_name#9333,cval_nation_n_comment#9334,cn_name#9335,cn_comment#9336] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 71730ms
query=q1, count=6001215, duration=2814
query=q10, count=1478870, duration=71730
query=q11, count=4, duration=1325
query=q12, count=857401, duration=23749
query=q13, count=1500000, duration=15143
query=q14, count=6001215, duration=98460
query=q15, count=6001215, duration=99376
query=q16, count=7890, duration=516
query=q17, count=408, duration=452
query=q18, count=6001215, duration=129278
query=q19, count=13, duration=65652
query=q2, count=0, duration=1721
query=q20, count=326, duration=703
query=q21a, count=120762, duration=95091
query=q22, count=1500000, duration=13903
query=q3, count=75006, duration=6464
query=q4, count=6001215, duration=57660
query=q5, count=1, duration=21383
query=q6, count=6001215, duration=2997
query=q7, count=0, duration=379
query=q8, count=0, duration=2462
query=q9a, count=6001215, duration=271037
query=q9b, count=6001215, duration=177014
