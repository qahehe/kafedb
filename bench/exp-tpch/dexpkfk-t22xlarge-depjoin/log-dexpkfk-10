20/04/15 17:33:14 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 14279ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Apr 15 17:33:17 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Apr 15 17:33:19 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Apr 15 17:33:19 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Apr 15 17:33:19 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Apr 15 17:33:19 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Apr 15 17:33:25 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Apr 15 17:33:30 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Apr 15 17:33:30 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/15 17:33:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:33:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2081L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 17:33:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:33:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:33:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:33:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2081L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#2083 AS rid_0#2100, cval_part_p_name#2084 AS cval_part_p_name_0#2101, cval_part_p_mfgr#2085 AS cval_part_p_mfgr_0#2102, cval_part_p_type#2086 AS cval_part_p_type_0#2103, cval_part_p_size#2087 AS cval_part_p_size_0#2104, cval_part_p_container#2088 AS cval_part_p_container_0#2105, cval_part_p_retailprice#2089 AS cval_part_p_retailprice_0#2106, cval_part_p_comment#2090 AS cval_part_p_comment_0#2107, cval_part_p_brand#2091 AS cval_part_p_brand_0#2108, cp_name#2092 AS cp_name_0#2109, cp_mfgr#2093 AS cp_mfgr_0#2110, cp_type#2094 AS cp_type_0#2111, cp_size#2095 AS cp_size_0#2112, cp_container#2096 AS cp_container_0#2113, cp_retailprice#2097 AS cp_retailprice_0#2114, cp_comment#2098 AS cp_comment_0#2115, cp_brand#2099 AS cp_brand_0#2116]
         :  :  :  +- Relation[rid#2083,cval_part_p_name#2084,cval_part_p_mfgr#2085,cval_part_p_type#2086,cval_part_p_size#2087,cval_part_p_container#2088,cval_part_p_retailprice#2089,cval_part_p_comment#2090,cval_part_p_brand#2091,cp_name#2092,cp_mfgr#2093,cp_type#2094,cp_size#2095,cp_container#2096,cp_retailprice#2097,cp_comment#2098,cp_brand#2099] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#2117 AS rid_0#2134, cval_part_p_name#2118 AS cval_part_p_name_0#2135, cval_part_p_mfgr#2119 AS cval_part_p_mfgr_0#2136, cval_part_p_type#2120 AS cval_part_p_type_0#2137, cval_part_p_size#2121 AS cval_part_p_size_0#2138, cval_part_p_container#2122 AS cval_part_p_container_0#2139, cval_part_p_retailprice#2123 AS cval_part_p_retailprice_0#2140, cval_part_p_comment#2124 AS cval_part_p_comment_0#2141, cval_part_p_brand#2125 AS cval_part_p_brand_0#2142, cp_name#2126 AS cp_name_0#2143, cp_mfgr#2127 AS cp_mfgr_0#2144, cp_type#2128 AS cp_type_0#2145, cp_size#2129 AS cp_size_0#2146, cp_container#2130 AS cp_container_0#2147, cp_retailprice#2131 AS cp_retailprice_0#2148, cp_comment#2132 AS cp_comment_0#2149, cp_brand#2133 AS cp_brand_0#2150]
         :  :        +- Relation[rid#2117,cval_part_p_name#2118,cval_part_p_mfgr#2119,cval_part_p_type#2120,cval_part_p_size#2121,cval_part_p_container#2122,cval_part_p_retailprice#2123,cval_part_p_comment#2124,cval_part_p_brand#2125,cp_name#2126,cp_mfgr#2127,cp_type#2128,cp_size#2129,cp_container#2130,cp_retailprice#2131,cp_comment#2132,cp_brand#2133] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#2207 AS rid_1#2218, cpfk_part_partsupp#2208 AS cpfk_part_partsupp_1#2219, cfpk_partsupp_part#2209 AS cfpk_partsupp_part_1#2220, cpfk_supplier_partsupp#2210 AS cpfk_supplier_partsupp_1#2221, cfpk_partsupp_supplier#2211 AS cfpk_partsupp_supplier_1#2222, cval_partsupp_ps_availqty#2212 AS cval_partsupp_ps_availqty_1#2223, cval_partsupp_ps_supplycost#2213 AS cval_partsupp_ps_supplycost_1#2224, cval_partsupp_ps_comment#2214 AS cval_partsupp_ps_comment_1#2225, cps_availqty#2215 AS cps_availqty_1#2226, cps_supplycost#2216 AS cps_supplycost_1#2227, cps_comment#2217 AS cps_comment_1#2228]
         :     +- Relation[rid#2207,cpfk_part_partsupp#2208,cfpk_partsupp_part#2209,cpfk_supplier_partsupp#2210,cfpk_partsupp_supplier#2211,cval_partsupp_ps_availqty#2212,cval_partsupp_ps_supplycost#2213,cval_partsupp_ps_comment#2214,cps_availqty#2215,cps_supplycost#2216,cps_comment#2217] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#2151 AS rid_1#2162, cpfk_part_partsupp#2152 AS cpfk_part_partsupp_1#2163, cfpk_partsupp_part#2153 AS cfpk_partsupp_part_1#2164, cpfk_supplier_partsupp#2154 AS cpfk_supplier_partsupp_1#2165, cfpk_partsupp_supplier#2155 AS cfpk_partsupp_supplier_1#2166, cval_partsupp_ps_availqty#2156 AS cval_partsupp_ps_availqty_1#2167, cval_partsupp_ps_supplycost#2157 AS cval_partsupp_ps_supplycost_1#2168, cval_partsupp_ps_comment#2158 AS cval_partsupp_ps_comment_1#2169, cps_availqty#2159 AS cps_availqty_1#2170, cps_supplycost#2160 AS cps_supplycost_1#2171, cps_comment#2161 AS cps_comment_1#2172]
            +- Relation[rid#2151,cpfk_part_partsupp#2152,cfpk_partsupp_part#2153,cpfk_supplier_partsupp#2154,cfpk_partsupp_supplier#2155,cval_partsupp_ps_availqty#2156,cval_partsupp_ps_supplycost#2157,cval_partsupp_ps_comment#2158,cps_availqty#2159,cps_supplycost#2160,cps_comment#2161] JDBCRelation(tpartsupp) [numPartitions=1]

20/04/15 17:33:33 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexPkFk$ result size=7890
Elapsed time: 1082ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/15 17:33:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:33:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2285L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 17:33:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2285L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#2287 AS rid_0#2320, cpfk_orders_lineitem#2288 AS cpfk_orders_lineitem_0#2321, cpfk_supplier_lineitem#2289 AS cpfk_supplier_lineitem_0#2322, cfpk_lineitem_supplier#2290 AS cfpk_lineitem_supplier_0#2323, cfpk_lineitem_partsupp#2291 AS cfpk_lineitem_partsupp_0#2324, cpfk_part_lineitem#2292 AS cpfk_part_lineitem_0#2325, cfpk_lineitem_part#2293 AS cfpk_lineitem_part_0#2326, cpfk_partsupp_lineitem#2294 AS cpfk_partsupp_lineitem_0#2327, cfpk_lineitem_orders#2295 AS cfpk_lineitem_orders_0#2328, cval_lineitem_l_quantity#2296 AS cval_lineitem_l_quantity_0#2329, cval_lineitem_l_extendedprice#2297 AS cval_lineitem_l_extendedprice_0#2330, cval_lineitem_l_discount#2298 AS cval_lineitem_l_discount_0#2331, cval_lineitem_l_tax#2299 AS cval_lineitem_l_tax_0#2332, cval_lineitem_l_returnflag#2300 AS cval_lineitem_l_returnflag_0#2333, cval_lineitem_l_linestatus#2301 AS cval_lineitem_l_linestatus_0#2334, cval_lineitem_l_commitdate#2302 AS cval_lineitem_l_commitdate_0#2335, cval_lineitem_l_receiptdate#2303 AS cval_lineitem_l_receiptdate_0#2336, cval_lineitem_l_shipinstruct#2304 AS cval_lineitem_l_shipinstruct_0#2337, cval_lineitem_l_shipmode#2305 AS cval_lineitem_l_shipmode_0#2338, cval_lineitem_l_comment#2306 AS cval_lineitem_l_comment_0#2339, cval_lineitem_l_shipdate#2307 AS cval_lineitem_l_shipdate_0#2340, cl_quantity#2308 AS cl_quantity_0#2341, cl_extendedprice#2309 AS cl_extendedprice_0#2342, cl_discount#2310 AS cl_discount_0#2343, ... 9 more fields]
            :  +- Relation[rid#2287,cpfk_orders_lineitem#2288,cpfk_supplier_lineitem#2289,cfpk_lineitem_supplier#2290,cfpk_lineitem_partsupp#2291,cpfk_part_lineitem#2292,cfpk_lineitem_part#2293,cpfk_partsupp_lineitem#2294,cfpk_lineitem_orders#2295,cval_lineitem_l_quantity#2296,cval_lineitem_l_extendedprice#2297,cval_lineitem_l_discount#2298,cval_lineitem_l_tax#2299,cval_lineitem_l_returnflag#2300,cval_lineitem_l_linestatus#2301,cval_lineitem_l_commitdate#2302,cval_lineitem_l_receiptdate#2303,cval_lineitem_l_shipinstruct#2304,cval_lineitem_l_shipmode#2305,cval_lineitem_l_comment#2306,cval_lineitem_l_shipdate#2307,cl_quantity#2308,cl_extendedprice#2309,cl_discount#2310,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#2353 AS rid_1#2370, cpfk_customer_orders#2354 AS cpfk_customer_orders_1#2371, cfpk_orders_customer#2355 AS cfpk_orders_customer_1#2372, cval_orders_o_orderstatus#2356 AS cval_orders_o_orderstatus_1#2373, cval_orders_o_totalprice#2357 AS cval_orders_o_totalprice_1#2374, cval_orders_o_orderpriority#2358 AS cval_orders_o_orderpriority_1#2375, cval_orders_o_clerk#2359 AS cval_orders_o_clerk_1#2376, cval_orders_o_shippriority#2360 AS cval_orders_o_shippriority_1#2377, cval_orders_o_comment#2361 AS cval_orders_o_comment_1#2378, cval_orders_o_orderdate#2362 AS cval_orders_o_orderdate_1#2379, co_orderstatus#2363 AS co_orderstatus_1#2380, co_totalprice#2364 AS co_totalprice_1#2381, co_orderpriority#2365 AS co_orderpriority_1#2382, co_clerk#2366 AS co_clerk_1#2383, co_shippriority#2367 AS co_shippriority_1#2384, co_comment#2368 AS co_comment_1#2385, co_orderdate#2369 AS co_orderdate_1#2386]
               +- Relation[rid#2353,cpfk_customer_orders#2354,cfpk_orders_customer#2355,cval_orders_o_orderstatus#2356,cval_orders_o_totalprice#2357,cval_orders_o_orderpriority#2358,cval_orders_o_clerk#2359,cval_orders_o_shippriority#2360,cval_orders_o_comment#2361,cval_orders_o_orderdate#2362,co_orderstatus#2363,co_totalprice#2364,co_orderpriority#2365,co_clerk#2366,co_shippriority#2367,co_comment#2368,co_orderdate#2369] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 56586ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/15 17:34:30 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:34:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2441L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:34:30 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:34:30 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:34:30 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:34:30 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:34:30 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:34:30 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:34:30 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:34:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2441L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#2443 AS rid_0#2460, cval_part_p_name#2444 AS cval_part_p_name_0#2461, cval_part_p_mfgr#2445 AS cval_part_p_mfgr_0#2462, cval_part_p_type#2446 AS cval_part_p_type_0#2463, cval_part_p_size#2447 AS cval_part_p_size_0#2464, cval_part_p_container#2448 AS cval_part_p_container_0#2465, cval_part_p_retailprice#2449 AS cval_part_p_retailprice_0#2466, cval_part_p_comment#2450 AS cval_part_p_comment_0#2467, cval_part_p_brand#2451 AS cval_part_p_brand_0#2468, cp_name#2452 AS cp_name_0#2469, cp_mfgr#2453 AS cp_mfgr_0#2470, cp_type#2454 AS cp_type_0#2471, cp_size#2455 AS cp_size_0#2472, cp_container#2456 AS cp_container_0#2473, cp_retailprice#2457 AS cp_retailprice_0#2474, cp_comment#2458 AS cp_comment_0#2475, cp_brand#2459 AS cp_brand_0#2476]
         :  :  :  :  +- Relation[rid#2443,cval_part_p_name#2444,cval_part_p_mfgr#2445,cval_part_p_type#2446,cval_part_p_size#2447,cval_part_p_container#2448,cval_part_p_retailprice#2449,cval_part_p_comment#2450,cval_part_p_brand#2451,cp_name#2452,cp_mfgr#2453,cp_type#2454,cp_size#2455,cp_container#2456,cp_retailprice#2457,cp_comment#2458,cp_brand#2459] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#2477 AS rid_0#2494, cval_part_p_name#2478 AS cval_part_p_name_0#2495, cval_part_p_mfgr#2479 AS cval_part_p_mfgr_0#2496, cval_part_p_type#2480 AS cval_part_p_type_0#2497, cval_part_p_size#2481 AS cval_part_p_size_0#2498, cval_part_p_container#2482 AS cval_part_p_container_0#2499, cval_part_p_retailprice#2483 AS cval_part_p_retailprice_0#2500, cval_part_p_comment#2484 AS cval_part_p_comment_0#2501, cval_part_p_brand#2485 AS cval_part_p_brand_0#2502, cp_name#2486 AS cp_name_0#2503, cp_mfgr#2487 AS cp_mfgr_0#2504, cp_type#2488 AS cp_type_0#2505, cp_size#2489 AS cp_size_0#2506, cp_container#2490 AS cp_container_0#2507, cp_retailprice#2491 AS cp_retailprice_0#2508, cp_comment#2492 AS cp_comment_0#2509, cp_brand#2493 AS cp_brand_0#2510]
         :  :  :        +- Relation[rid#2477,cval_part_p_name#2478,cval_part_p_mfgr#2479,cval_part_p_type#2480,cval_part_p_size#2481,cval_part_p_container#2482,cval_part_p_retailprice#2483,cval_part_p_comment#2484,cval_part_p_brand#2485,cp_name#2486,cp_mfgr#2487,cp_type#2488,cp_size#2489,cp_container#2490,cp_retailprice#2491,cp_comment#2492,cp_brand#2493] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#2511 AS rid_0#2528, cval_part_p_name#2512 AS cval_part_p_name_0#2529, cval_part_p_mfgr#2513 AS cval_part_p_mfgr_0#2530, cval_part_p_type#2514 AS cval_part_p_type_0#2531, cval_part_p_size#2515 AS cval_part_p_size_0#2532, cval_part_p_container#2516 AS cval_part_p_container_0#2533, cval_part_p_retailprice#2517 AS cval_part_p_retailprice_0#2534, cval_part_p_comment#2518 AS cval_part_p_comment_0#2535, cval_part_p_brand#2519 AS cval_part_p_brand_0#2536, cp_name#2520 AS cp_name_0#2537, cp_mfgr#2521 AS cp_mfgr_0#2538, cp_type#2522 AS cp_type_0#2539, cp_size#2523 AS cp_size_0#2540, cp_container#2524 AS cp_container_0#2541, cp_retailprice#2525 AS cp_retailprice_0#2542, cp_comment#2526 AS cp_comment_0#2543, cp_brand#2527 AS cp_brand_0#2544]
         :  :        +- Relation[rid#2511,cval_part_p_name#2512,cval_part_p_mfgr#2513,cval_part_p_type#2514,cval_part_p_size#2515,cval_part_p_container#2516,cval_part_p_retailprice#2517,cval_part_p_comment#2518,cval_part_p_brand#2519,cp_name#2520,cp_mfgr#2521,cp_type#2522,cp_size#2523,cp_container#2524,cp_retailprice#2525,cp_comment#2526,cp_brand#2527] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#2645 AS rid_1#2678, cpfk_orders_lineitem#2646 AS cpfk_orders_lineitem_1#2679, cpfk_supplier_lineitem#2647 AS cpfk_supplier_lineitem_1#2680, cfpk_lineitem_supplier#2648 AS cfpk_lineitem_supplier_1#2681, cfpk_lineitem_partsupp#2649 AS cfpk_lineitem_partsupp_1#2682, cpfk_part_lineitem#2650 AS cpfk_part_lineitem_1#2683, cfpk_lineitem_part#2651 AS cfpk_lineitem_part_1#2684, cpfk_partsupp_lineitem#2652 AS cpfk_partsupp_lineitem_1#2685, cfpk_lineitem_orders#2653 AS cfpk_lineitem_orders_1#2686, cval_lineitem_l_quantity#2654 AS cval_lineitem_l_quantity_1#2687, cval_lineitem_l_extendedprice#2655 AS cval_lineitem_l_extendedprice_1#2688, cval_lineitem_l_discount#2656 AS cval_lineitem_l_discount_1#2689, cval_lineitem_l_tax#2657 AS cval_lineitem_l_tax_1#2690, cval_lineitem_l_returnflag#2658 AS cval_lineitem_l_returnflag_1#2691, cval_lineitem_l_linestatus#2659 AS cval_lineitem_l_linestatus_1#2692, cval_lineitem_l_commitdate#2660 AS cval_lineitem_l_commitdate_1#2693, cval_lineitem_l_receiptdate#2661 AS cval_lineitem_l_receiptdate_1#2694, cval_lineitem_l_shipinstruct#2662 AS cval_lineitem_l_shipinstruct_1#2695, cval_lineitem_l_shipmode#2663 AS cval_lineitem_l_shipmode_1#2696, cval_lineitem_l_comment#2664 AS cval_lineitem_l_comment_1#2697, cval_lineitem_l_shipdate#2665 AS cval_lineitem_l_shipdate_1#2698, cl_quantity#2666 AS cl_quantity_1#2699, cl_extendedprice#2667 AS cl_extendedprice_1#2700, cl_discount#2668 AS cl_discount_1#2701, ... 9 more fields]
         :     +- Relation[rid#2645,cpfk_orders_lineitem#2646,cpfk_supplier_lineitem#2647,cfpk_lineitem_supplier#2648,cfpk_lineitem_partsupp#2649,cpfk_part_lineitem#2650,cfpk_lineitem_part#2651,cpfk_partsupp_lineitem#2652,cfpk_lineitem_orders#2653,cval_lineitem_l_quantity#2654,cval_lineitem_l_extendedprice#2655,cval_lineitem_l_discount#2656,cval_lineitem_l_tax#2657,cval_lineitem_l_returnflag#2658,cval_lineitem_l_linestatus#2659,cval_lineitem_l_commitdate#2660,cval_lineitem_l_receiptdate#2661,cval_lineitem_l_shipinstruct#2662,cval_lineitem_l_shipmode#2663,cval_lineitem_l_comment#2664,cval_lineitem_l_shipdate#2665,cl_quantity#2666,cl_extendedprice#2667,cl_discount#2668,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2545 AS rid_1#2578, cpfk_orders_lineitem#2546 AS cpfk_orders_lineitem_1#2579, cpfk_supplier_lineitem#2547 AS cpfk_supplier_lineitem_1#2580, cfpk_lineitem_supplier#2548 AS cfpk_lineitem_supplier_1#2581, cfpk_lineitem_partsupp#2549 AS cfpk_lineitem_partsupp_1#2582, cpfk_part_lineitem#2550 AS cpfk_part_lineitem_1#2583, cfpk_lineitem_part#2551 AS cfpk_lineitem_part_1#2584, cpfk_partsupp_lineitem#2552 AS cpfk_partsupp_lineitem_1#2585, cfpk_lineitem_orders#2553 AS cfpk_lineitem_orders_1#2586, cval_lineitem_l_quantity#2554 AS cval_lineitem_l_quantity_1#2587, cval_lineitem_l_extendedprice#2555 AS cval_lineitem_l_extendedprice_1#2588, cval_lineitem_l_discount#2556 AS cval_lineitem_l_discount_1#2589, cval_lineitem_l_tax#2557 AS cval_lineitem_l_tax_1#2590, cval_lineitem_l_returnflag#2558 AS cval_lineitem_l_returnflag_1#2591, cval_lineitem_l_linestatus#2559 AS cval_lineitem_l_linestatus_1#2592, cval_lineitem_l_commitdate#2560 AS cval_lineitem_l_commitdate_1#2593, cval_lineitem_l_receiptdate#2561 AS cval_lineitem_l_receiptdate_1#2594, cval_lineitem_l_shipinstruct#2562 AS cval_lineitem_l_shipinstruct_1#2595, cval_lineitem_l_shipmode#2563 AS cval_lineitem_l_shipmode_1#2596, cval_lineitem_l_comment#2564 AS cval_lineitem_l_comment_1#2597, cval_lineitem_l_shipdate#2565 AS cval_lineitem_l_shipdate_1#2598, cl_quantity#2566 AS cl_quantity_1#2599, cl_extendedprice#2567 AS cl_extendedprice_1#2600, cl_discount#2568 AS cl_discount_1#2601, ... 9 more fields]
            +- Relation[rid#2545,cpfk_orders_lineitem#2546,cpfk_supplier_lineitem#2547,cfpk_lineitem_supplier#2548,cfpk_lineitem_partsupp#2549,cpfk_part_lineitem#2550,cfpk_lineitem_part#2551,cpfk_partsupp_lineitem#2552,cfpk_lineitem_orders#2553,cval_lineitem_l_quantity#2554,cval_lineitem_l_extendedprice#2555,cval_lineitem_l_discount#2556,cval_lineitem_l_tax#2557,cval_lineitem_l_returnflag#2558,cval_lineitem_l_linestatus#2559,cval_lineitem_l_commitdate#2560,cval_lineitem_l_receiptdate#2561,cval_lineitem_l_shipinstruct#2562,cval_lineitem_l_shipmode#2563,cval_lineitem_l_comment#2564,cval_lineitem_l_shipdate#2565,cl_quantity#2566,cl_extendedprice#2567,cl_discount#2568,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 630ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/15 17:34:30 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:34:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2766L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:34:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#2766L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#2768 AS rid_0#2801, cpfk_orders_lineitem#2769 AS cpfk_orders_lineitem_0#2802, cpfk_supplier_lineitem#2770 AS cpfk_supplier_lineitem_0#2803, cfpk_lineitem_supplier#2771 AS cfpk_lineitem_supplier_0#2804, cfpk_lineitem_partsupp#2772 AS cfpk_lineitem_partsupp_0#2805, cpfk_part_lineitem#2773 AS cpfk_part_lineitem_0#2806, cfpk_lineitem_part#2774 AS cfpk_lineitem_part_0#2807, cpfk_partsupp_lineitem#2775 AS cpfk_partsupp_lineitem_0#2808, cfpk_lineitem_orders#2776 AS cfpk_lineitem_orders_0#2809, cval_lineitem_l_quantity#2777 AS cval_lineitem_l_quantity_0#2810, cval_lineitem_l_extendedprice#2778 AS cval_lineitem_l_extendedprice_0#2811, cval_lineitem_l_discount#2779 AS cval_lineitem_l_discount_0#2812, cval_lineitem_l_tax#2780 AS cval_lineitem_l_tax_0#2813, cval_lineitem_l_returnflag#2781 AS cval_lineitem_l_returnflag_0#2814, cval_lineitem_l_linestatus#2782 AS cval_lineitem_l_linestatus_0#2815, cval_lineitem_l_commitdate#2783 AS cval_lineitem_l_commitdate_0#2816, cval_lineitem_l_receiptdate#2784 AS cval_lineitem_l_receiptdate_0#2817, cval_lineitem_l_shipinstruct#2785 AS cval_lineitem_l_shipinstruct_0#2818, cval_lineitem_l_shipmode#2786 AS cval_lineitem_l_shipmode_0#2819, cval_lineitem_l_comment#2787 AS cval_lineitem_l_comment_0#2820, cval_lineitem_l_shipdate#2788 AS cval_lineitem_l_shipdate_0#2821, cl_quantity#2789 AS cl_quantity_0#2822, cl_extendedprice#2790 AS cl_extendedprice_0#2823, cl_discount#2791 AS cl_discount_0#2824, ... 9 more fields]
         +- Relation[rid#2768,cpfk_orders_lineitem#2769,cpfk_supplier_lineitem#2770,cfpk_lineitem_supplier#2771,cfpk_lineitem_partsupp#2772,cpfk_part_lineitem#2773,cfpk_lineitem_part#2774,cpfk_partsupp_lineitem#2775,cfpk_lineitem_orders#2776,cval_lineitem_l_quantity#2777,cval_lineitem_l_extendedprice#2778,cval_lineitem_l_discount#2779,cval_lineitem_l_tax#2780,cval_lineitem_l_returnflag#2781,cval_lineitem_l_linestatus#2782,cval_lineitem_l_commitdate#2783,cval_lineitem_l_receiptdate#2784,cval_lineitem_l_shipinstruct#2785,cval_lineitem_l_shipmode#2786,cval_lineitem_l_comment#2787,cval_lineitem_l_shipdate#2788,cl_quantity#2789,cl_extendedprice#2790,cl_discount#2791,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2731ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/15 17:34:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:34:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2873L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:34:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2873L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#2875 AS rid_0#2892, cval_part_p_name#2876 AS cval_part_p_name_0#2893, cval_part_p_mfgr#2877 AS cval_part_p_mfgr_0#2894, cval_part_p_type#2878 AS cval_part_p_type_0#2895, cval_part_p_size#2879 AS cval_part_p_size_0#2896, cval_part_p_container#2880 AS cval_part_p_container_0#2897, cval_part_p_retailprice#2881 AS cval_part_p_retailprice_0#2898, cval_part_p_comment#2882 AS cval_part_p_comment_0#2899, cval_part_p_brand#2883 AS cval_part_p_brand_0#2900, cp_name#2884 AS cp_name_0#2901, cp_mfgr#2885 AS cp_mfgr_0#2902, cp_type#2886 AS cp_type_0#2903, cp_size#2887 AS cp_size_0#2904, cp_container#2888 AS cp_container_0#2905, cp_retailprice#2889 AS cp_retailprice_0#2906, cp_comment#2890 AS cp_comment_0#2907, cp_brand#2891 AS cp_brand_0#2908]
         :  :  +- Relation[rid#2875,cval_part_p_name#2876,cval_part_p_mfgr#2877,cval_part_p_type#2878,cval_part_p_size#2879,cval_part_p_container#2880,cval_part_p_retailprice#2881,cval_part_p_comment#2882,cval_part_p_brand#2883,cp_name#2884,cp_mfgr#2885,cp_type#2886,cp_size#2887,cp_container#2888,cp_retailprice#2889,cp_comment#2890,cp_brand#2891] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#2975 AS rid_0#2992, cval_part_p_name#2976 AS cval_part_p_name_0#2993, cval_part_p_mfgr#2977 AS cval_part_p_mfgr_0#2994, cval_part_p_type#2978 AS cval_part_p_type_0#2995, cval_part_p_size#2979 AS cval_part_p_size_0#2996, cval_part_p_container#2980 AS cval_part_p_container_0#2997, cval_part_p_retailprice#2981 AS cval_part_p_retailprice_0#2998, cval_part_p_comment#2982 AS cval_part_p_comment_0#2999, cval_part_p_brand#2983 AS cval_part_p_brand_0#3000, cp_name#2984 AS cp_name_0#3001, cp_mfgr#2985 AS cp_mfgr_0#3002, cp_type#2986 AS cp_type_0#3003, cp_size#2987 AS cp_size_0#3004, cp_container#2988 AS cp_container_0#3005, cp_retailprice#2989 AS cp_retailprice_0#3006, cp_comment#2990 AS cp_comment_0#3007, cp_brand#2991 AS cp_brand_0#3008]
         :     :  +- Relation[rid#2975,cval_part_p_name#2976,cval_part_p_mfgr#2977,cval_part_p_type#2978,cval_part_p_size#2979,cval_part_p_container#2980,cval_part_p_retailprice#2981,cval_part_p_comment#2982,cval_part_p_brand#2983,cp_name#2984,cp_mfgr#2985,cp_type#2986,cp_size#2987,cp_container#2988,cp_retailprice#2989,cp_comment#2990,cp_brand#2991] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#3009 AS rid_1#3042, cpfk_orders_lineitem#3010 AS cpfk_orders_lineitem_1#3043, cpfk_supplier_lineitem#3011 AS cpfk_supplier_lineitem_1#3044, cfpk_lineitem_supplier#3012 AS cfpk_lineitem_supplier_1#3045, cfpk_lineitem_partsupp#3013 AS cfpk_lineitem_partsupp_1#3046, cpfk_part_lineitem#3014 AS cpfk_part_lineitem_1#3047, cfpk_lineitem_part#3015 AS cfpk_lineitem_part_1#3048, cpfk_partsupp_lineitem#3016 AS cpfk_partsupp_lineitem_1#3049, cfpk_lineitem_orders#3017 AS cfpk_lineitem_orders_1#3050, cval_lineitem_l_quantity#3018 AS cval_lineitem_l_quantity_1#3051, cval_lineitem_l_extendedprice#3019 AS cval_lineitem_l_extendedprice_1#3052, cval_lineitem_l_discount#3020 AS cval_lineitem_l_discount_1#3053, cval_lineitem_l_tax#3021 AS cval_lineitem_l_tax_1#3054, cval_lineitem_l_returnflag#3022 AS cval_lineitem_l_returnflag_1#3055, cval_lineitem_l_linestatus#3023 AS cval_lineitem_l_linestatus_1#3056, cval_lineitem_l_commitdate#3024 AS cval_lineitem_l_commitdate_1#3057, cval_lineitem_l_receiptdate#3025 AS cval_lineitem_l_receiptdate_1#3058, cval_lineitem_l_shipinstruct#3026 AS cval_lineitem_l_shipinstruct_1#3059, cval_lineitem_l_shipmode#3027 AS cval_lineitem_l_shipmode_1#3060, cval_lineitem_l_comment#3028 AS cval_lineitem_l_comment_1#3061, cval_lineitem_l_shipdate#3029 AS cval_lineitem_l_shipdate_1#3062, cl_quantity#3030 AS cl_quantity_1#3063, cl_extendedprice#3031 AS cl_extendedprice_1#3064, cl_discount#3032 AS cl_discount_1#3065, ... 9 more fields]
         :        +- Relation[rid#3009,cpfk_orders_lineitem#3010,cpfk_supplier_lineitem#3011,cfpk_lineitem_supplier#3012,cfpk_lineitem_partsupp#3013,cpfk_part_lineitem#3014,cfpk_lineitem_part#3015,cpfk_partsupp_lineitem#3016,cfpk_lineitem_orders#3017,cval_lineitem_l_quantity#3018,cval_lineitem_l_extendedprice#3019,cval_lineitem_l_discount#3020,cval_lineitem_l_tax#3021,cval_lineitem_l_returnflag#3022,cval_lineitem_l_linestatus#3023,cval_lineitem_l_commitdate#3024,cval_lineitem_l_receiptdate#3025,cval_lineitem_l_shipinstruct#3026,cval_lineitem_l_shipmode#3027,cval_lineitem_l_comment#3028,cval_lineitem_l_shipdate#3029,cl_quantity#3030,cl_extendedprice#3031,cl_discount#3032,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2909 AS rid_1#2942, cpfk_orders_lineitem#2910 AS cpfk_orders_lineitem_1#2943, cpfk_supplier_lineitem#2911 AS cpfk_supplier_lineitem_1#2944, cfpk_lineitem_supplier#2912 AS cfpk_lineitem_supplier_1#2945, cfpk_lineitem_partsupp#2913 AS cfpk_lineitem_partsupp_1#2946, cpfk_part_lineitem#2914 AS cpfk_part_lineitem_1#2947, cfpk_lineitem_part#2915 AS cfpk_lineitem_part_1#2948, cpfk_partsupp_lineitem#2916 AS cpfk_partsupp_lineitem_1#2949, cfpk_lineitem_orders#2917 AS cfpk_lineitem_orders_1#2950, cval_lineitem_l_quantity#2918 AS cval_lineitem_l_quantity_1#2951, cval_lineitem_l_extendedprice#2919 AS cval_lineitem_l_extendedprice_1#2952, cval_lineitem_l_discount#2920 AS cval_lineitem_l_discount_1#2953, cval_lineitem_l_tax#2921 AS cval_lineitem_l_tax_1#2954, cval_lineitem_l_returnflag#2922 AS cval_lineitem_l_returnflag_1#2955, cval_lineitem_l_linestatus#2923 AS cval_lineitem_l_linestatus_1#2956, cval_lineitem_l_commitdate#2924 AS cval_lineitem_l_commitdate_1#2957, cval_lineitem_l_receiptdate#2925 AS cval_lineitem_l_receiptdate_1#2958, cval_lineitem_l_shipinstruct#2926 AS cval_lineitem_l_shipinstruct_1#2959, cval_lineitem_l_shipmode#2927 AS cval_lineitem_l_shipmode_1#2960, cval_lineitem_l_comment#2928 AS cval_lineitem_l_comment_1#2961, cval_lineitem_l_shipdate#2929 AS cval_lineitem_l_shipdate_1#2962, cl_quantity#2930 AS cl_quantity_1#2963, cl_extendedprice#2931 AS cl_extendedprice_1#2964, cl_discount#2932 AS cl_discount_1#2965, ... 9 more fields]
            +- Relation[rid#2909,cpfk_orders_lineitem#2910,cpfk_supplier_lineitem#2911,cfpk_lineitem_supplier#2912,cfpk_lineitem_partsupp#2913,cpfk_part_lineitem#2914,cfpk_lineitem_part#2915,cpfk_partsupp_lineitem#2916,cfpk_lineitem_orders#2917,cval_lineitem_l_quantity#2918,cval_lineitem_l_extendedprice#2919,cval_lineitem_l_discount#2920,cval_lineitem_l_tax#2921,cval_lineitem_l_returnflag#2922,cval_lineitem_l_linestatus#2923,cval_lineitem_l_commitdate#2924,cval_lineitem_l_receiptdate#2925,cval_lineitem_l_shipinstruct#2926,cval_lineitem_l_shipmode#2927,cval_lineitem_l_comment#2928,cval_lineitem_l_shipdate#2929,cl_quantity#2930,cl_extendedprice#2931,cl_discount#2932,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 93153ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/15 17:36:06 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:36:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3133L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 17:36:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:36:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:36:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:36:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:36:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:36:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:36:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:36:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:36:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:36:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:36:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:36:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:36:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:36:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:36:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:36:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3133L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#3135 AS rid_0#3142, cpfk_region_nation#3136 AS cpfk_region_nation_0#3143, cfpk_nation_region#3137 AS cfpk_nation_region_0#3144, cval_nation_n_name#3138 AS cval_nation_n_name_0#3145, cval_nation_n_comment#3139 AS cval_nation_n_comment_0#3146, cn_name#3140 AS cn_name_0#3147, cn_comment#3141 AS cn_comment_0#3148]
            :  :  :  :  :  :  +- Relation[rid#3135,cpfk_region_nation#3136,cfpk_nation_region#3137,cval_nation_n_name#3138,cval_nation_n_comment#3139,cn_name#3140,cn_comment#3141] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#3149 AS rid_0#3156, cpfk_region_nation#3150 AS cpfk_region_nation_0#3157, cfpk_nation_region#3151 AS cfpk_nation_region_0#3158, cval_nation_n_name#3152 AS cval_nation_n_name_0#3159, cval_nation_n_comment#3153 AS cval_nation_n_comment_0#3160, cn_name#3154 AS cn_name_0#3161, cn_comment#3155 AS cn_comment_0#3162]
            :  :  :  :  :        +- Relation[rid#3149,cpfk_region_nation#3150,cfpk_nation_region#3151,cval_nation_n_name#3152,cval_nation_n_comment#3153,cn_name#3154,cn_comment#3155] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- Project [rid#3203 AS rid_1#3216, cpfk_nation_supplier#3204 AS cpfk_nation_supplier_1#3217, cfpk_supplier_nation#3205 AS cfpk_supplier_nation_1#3218, cval_supplier_s_name#3206 AS cval_supplier_s_name_1#3219, cval_supplier_s_address#3207 AS cval_supplier_s_address_1#3220, cval_supplier_s_phone#3208 AS cval_supplier_s_phone_1#3221, cval_supplier_s_acctbal#3209 AS cval_supplier_s_acctbal_1#3222, cval_supplier_s_comment#3210 AS cval_supplier_s_comment_1#3223, cs_name#3211 AS cs_name_1#3224, cs_address#3212 AS cs_address_1#3225, cs_phone#3213 AS cs_phone_1#3226, cs_acctbal#3214 AS cs_acctbal_1#3227, cs_comment#3215 AS cs_comment_1#3228]
            :  :  :  :     +- Relation[rid#3203,cpfk_nation_supplier#3204,cfpk_supplier_nation#3205,cval_supplier_s_name#3206,cval_supplier_s_address#3207,cval_supplier_s_phone#3208,cval_supplier_s_acctbal#3209,cval_supplier_s_comment#3210,cs_name#3211,cs_address#3212,cs_phone#3213,cs_acctbal#3214,cs_comment#3215] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#3163 AS rid_1#3176, cpfk_nation_supplier#3164 AS cpfk_nation_supplier_1#3177, cfpk_supplier_nation#3165 AS cfpk_supplier_nation_1#3178, cval_supplier_s_name#3166 AS cval_supplier_s_name_1#3179, cval_supplier_s_address#3167 AS cval_supplier_s_address_1#3180, cval_supplier_s_phone#3168 AS cval_supplier_s_phone_1#3181, cval_supplier_s_acctbal#3169 AS cval_supplier_s_acctbal_1#3182, cval_supplier_s_comment#3170 AS cval_supplier_s_comment_1#3183, cs_name#3171 AS cs_name_1#3184, cs_address#3172 AS cs_address_1#3185, cs_phone#3173 AS cs_phone_1#3186, cs_acctbal#3174 AS cs_acctbal_1#3187, cs_comment#3175 AS cs_comment_1#3188]
            :  :  :     +- Relation[rid#3163,cpfk_nation_supplier#3164,cfpk_supplier_nation#3165,cval_supplier_s_name#3166,cval_supplier_s_address#3167,cval_supplier_s_phone#3168,cval_supplier_s_acctbal#3169,cval_supplier_s_comment#3170,cs_name#3171,cs_address#3172,cs_phone#3173,cs_acctbal#3174,cs_comment#3175] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- Project [rid#3321 AS rid_2#3354, cpfk_orders_lineitem#3322 AS cpfk_orders_lineitem_2#3355, cpfk_supplier_lineitem#3323 AS cpfk_supplier_lineitem_2#3356, cfpk_lineitem_supplier#3324 AS cfpk_lineitem_supplier_2#3357, cfpk_lineitem_partsupp#3325 AS cfpk_lineitem_partsupp_2#3358, cpfk_part_lineitem#3326 AS cpfk_part_lineitem_2#3359, cfpk_lineitem_part#3327 AS cfpk_lineitem_part_2#3360, cpfk_partsupp_lineitem#3328 AS cpfk_partsupp_lineitem_2#3361, cfpk_lineitem_orders#3329 AS cfpk_lineitem_orders_2#3362, cval_lineitem_l_quantity#3330 AS cval_lineitem_l_quantity_2#3363, cval_lineitem_l_extendedprice#3331 AS cval_lineitem_l_extendedprice_2#3364, cval_lineitem_l_discount#3332 AS cval_lineitem_l_discount_2#3365, cval_lineitem_l_tax#3333 AS cval_lineitem_l_tax_2#3366, cval_lineitem_l_returnflag#3334 AS cval_lineitem_l_returnflag_2#3367, cval_lineitem_l_linestatus#3335 AS cval_lineitem_l_linestatus_2#3368, cval_lineitem_l_commitdate#3336 AS cval_lineitem_l_commitdate_2#3369, cval_lineitem_l_receiptdate#3337 AS cval_lineitem_l_receiptdate_2#3370, cval_lineitem_l_shipinstruct#3338 AS cval_lineitem_l_shipinstruct_2#3371, cval_lineitem_l_shipmode#3339 AS cval_lineitem_l_shipmode_2#3372, cval_lineitem_l_comment#3340 AS cval_lineitem_l_comment_2#3373, cval_lineitem_l_shipdate#3341 AS cval_lineitem_l_shipdate_2#3374, cl_quantity#3342 AS cl_quantity_2#3375, cl_extendedprice#3343 AS cl_extendedprice_2#3376, cl_discount#3344 AS cl_discount_2#3377, ... 9 more fields]
            :  :     +- Relation[rid#3321,cpfk_orders_lineitem#3322,cpfk_supplier_lineitem#3323,cfpk_lineitem_supplier#3324,cfpk_lineitem_partsupp#3325,cpfk_part_lineitem#3326,cfpk_lineitem_part#3327,cpfk_partsupp_lineitem#3328,cfpk_lineitem_orders#3329,cval_lineitem_l_quantity#3330,cval_lineitem_l_extendedprice#3331,cval_lineitem_l_discount#3332,cval_lineitem_l_tax#3333,cval_lineitem_l_returnflag#3334,cval_lineitem_l_linestatus#3335,cval_lineitem_l_commitdate#3336,cval_lineitem_l_receiptdate#3337,cval_lineitem_l_shipinstruct#3338,cval_lineitem_l_shipmode#3339,cval_lineitem_l_comment#3340,cval_lineitem_l_shipdate#3341,cl_quantity#3342,cl_extendedprice#3343,cl_discount#3344,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#3229 AS rid_2#3262, cpfk_orders_lineitem#3230 AS cpfk_orders_lineitem_2#3263, cpfk_supplier_lineitem#3231 AS cpfk_supplier_lineitem_2#3264, cfpk_lineitem_supplier#3232 AS cfpk_lineitem_supplier_2#3265, cfpk_lineitem_partsupp#3233 AS cfpk_lineitem_partsupp_2#3266, cpfk_part_lineitem#3234 AS cpfk_part_lineitem_2#3267, cfpk_lineitem_part#3235 AS cfpk_lineitem_part_2#3268, cpfk_partsupp_lineitem#3236 AS cpfk_partsupp_lineitem_2#3269, cfpk_lineitem_orders#3237 AS cfpk_lineitem_orders_2#3270, cval_lineitem_l_quantity#3238 AS cval_lineitem_l_quantity_2#3271, cval_lineitem_l_extendedprice#3239 AS cval_lineitem_l_extendedprice_2#3272, cval_lineitem_l_discount#3240 AS cval_lineitem_l_discount_2#3273, cval_lineitem_l_tax#3241 AS cval_lineitem_l_tax_2#3274, cval_lineitem_l_returnflag#3242 AS cval_lineitem_l_returnflag_2#3275, cval_lineitem_l_linestatus#3243 AS cval_lineitem_l_linestatus_2#3276, cval_lineitem_l_commitdate#3244 AS cval_lineitem_l_commitdate_2#3277, cval_lineitem_l_receiptdate#3245 AS cval_lineitem_l_receiptdate_2#3278, cval_lineitem_l_shipinstruct#3246 AS cval_lineitem_l_shipinstruct_2#3279, cval_lineitem_l_shipmode#3247 AS cval_lineitem_l_shipmode_2#3280, cval_lineitem_l_comment#3248 AS cval_lineitem_l_comment_2#3281, cval_lineitem_l_shipdate#3249 AS cval_lineitem_l_shipdate_2#3282, cl_quantity#3250 AS cl_quantity_2#3283, cl_extendedprice#3251 AS cl_extendedprice_2#3284, cl_discount#3252 AS cl_discount_2#3285, ... 9 more fields]
            :     +- Relation[rid#3229,cpfk_orders_lineitem#3230,cpfk_supplier_lineitem#3231,cfpk_lineitem_supplier#3232,cfpk_lineitem_partsupp#3233,cpfk_part_lineitem#3234,cfpk_lineitem_part#3235,cpfk_partsupp_lineitem#3236,cfpk_lineitem_orders#3237,cval_lineitem_l_quantity#3238,cval_lineitem_l_extendedprice#3239,cval_lineitem_l_discount#3240,cval_lineitem_l_tax#3241,cval_lineitem_l_returnflag#3242,cval_lineitem_l_linestatus#3243,cval_lineitem_l_commitdate#3244,cval_lineitem_l_receiptdate#3245,cval_lineitem_l_shipinstruct#3246,cval_lineitem_l_shipmode#3247,cval_lineitem_l_comment#3248,cval_lineitem_l_shipdate#3249,cl_quantity#3250,cl_extendedprice#3251,cl_discount#3252,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#3387 AS rid_3#3394, cpfk_region_nation#3388 AS cpfk_region_nation_3#3395, cfpk_nation_region#3389 AS cfpk_nation_region_3#3396, cval_nation_n_name#3390 AS cval_nation_n_name_3#3397, cval_nation_n_comment#3391 AS cval_nation_n_comment_3#3398, cn_name#3392 AS cn_name_3#3399, cn_comment#3393 AS cn_comment_3#3400]
               :  :  :  :  :  +- Relation[rid#3387,cpfk_region_nation#3388,cfpk_nation_region#3389,cval_nation_n_name#3390,cval_nation_n_comment#3391,cn_name#3392,cn_comment#3393] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#3401 AS rid_3#3408, cpfk_region_nation#3402 AS cpfk_region_nation_3#3409, cfpk_nation_region#3403 AS cfpk_nation_region_3#3410, cval_nation_n_name#3404 AS cval_nation_n_name_3#3411, cval_nation_n_comment#3405 AS cval_nation_n_comment_3#3412, cn_name#3406 AS cn_name_3#3413, cn_comment#3407 AS cn_comment_3#3414]
               :  :  :  :        +- Relation[rid#3401,cpfk_region_nation#3402,cfpk_nation_region#3403,cval_nation_n_name#3404,cval_nation_n_comment#3405,cn_name#3406,cn_comment#3407] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#3459 AS rid_4#3474, cpfk_nation_customer#3460 AS cpfk_nation_customer_4#3475, cfpk_customer_nation#3461 AS cfpk_customer_nation_4#3476, cval_customer_c_name#3462 AS cval_customer_c_name_4#3477, cval_customer_c_address#3463 AS cval_customer_c_address_4#3478, cval_customer_c_phone#3464 AS cval_customer_c_phone_4#3479, cval_customer_c_acctbal#3465 AS cval_customer_c_acctbal_4#3480, cval_customer_c_comment#3466 AS cval_customer_c_comment_4#3481, cval_customer_c_mktsegment#3467 AS cval_customer_c_mktsegment_4#3482, cc_name#3468 AS cc_name_4#3483, cc_address#3469 AS cc_address_4#3484, cc_phone#3470 AS cc_phone_4#3485, cc_acctbal#3471 AS cc_acctbal_4#3486, cc_comment#3472 AS cc_comment_4#3487, cc_mktsegment#3473 AS cc_mktsegment_4#3488]
               :  :  :     +- Relation[rid#3459,cpfk_nation_customer#3460,cfpk_customer_nation#3461,cval_customer_c_name#3462,cval_customer_c_address#3463,cval_customer_c_phone#3464,cval_customer_c_acctbal#3465,cval_customer_c_comment#3466,cval_customer_c_mktsegment#3467,cc_name#3468,cc_address#3469,cc_phone#3470,cc_acctbal#3471,cc_comment#3472,cc_mktsegment#3473] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#3415 AS rid_4#3430, cpfk_nation_customer#3416 AS cpfk_nation_customer_4#3431, cfpk_customer_nation#3417 AS cfpk_customer_nation_4#3432, cval_customer_c_name#3418 AS cval_customer_c_name_4#3433, cval_customer_c_address#3419 AS cval_customer_c_address_4#3434, cval_customer_c_phone#3420 AS cval_customer_c_phone_4#3435, cval_customer_c_acctbal#3421 AS cval_customer_c_acctbal_4#3436, cval_customer_c_comment#3422 AS cval_customer_c_comment_4#3437, cval_customer_c_mktsegment#3423 AS cval_customer_c_mktsegment_4#3438, cc_name#3424 AS cc_name_4#3439, cc_address#3425 AS cc_address_4#3440, cc_phone#3426 AS cc_phone_4#3441, cc_acctbal#3427 AS cc_acctbal_4#3442, cc_comment#3428 AS cc_comment_4#3443, cc_mktsegment#3429 AS cc_mktsegment_4#3444]
               :  :     +- Relation[rid#3415,cpfk_nation_customer#3416,cfpk_customer_nation#3417,cval_customer_c_name#3418,cval_customer_c_address#3419,cval_customer_c_phone#3420,cval_customer_c_acctbal#3421,cval_customer_c_comment#3422,cval_customer_c_mktsegment#3423,cc_name#3424,cc_address#3425,cc_phone#3426,cc_acctbal#3427,cc_comment#3428,cc_mktsegment#3429] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#3553 AS rid_5#3570, cpfk_customer_orders#3554 AS cpfk_customer_orders_5#3571, cfpk_orders_customer#3555 AS cfpk_orders_customer_5#3572, cval_orders_o_orderstatus#3556 AS cval_orders_o_orderstatus_5#3573, cval_orders_o_totalprice#3557 AS cval_orders_o_totalprice_5#3574, cval_orders_o_orderpriority#3558 AS cval_orders_o_orderpriority_5#3575, cval_orders_o_clerk#3559 AS cval_orders_o_clerk_5#3576, cval_orders_o_shippriority#3560 AS cval_orders_o_shippriority_5#3577, cval_orders_o_comment#3561 AS cval_orders_o_comment_5#3578, cval_orders_o_orderdate#3562 AS cval_orders_o_orderdate_5#3579, co_orderstatus#3563 AS co_orderstatus_5#3580, co_totalprice#3564 AS co_totalprice_5#3581, co_orderpriority#3565 AS co_orderpriority_5#3582, co_clerk#3566 AS co_clerk_5#3583, co_shippriority#3567 AS co_shippriority_5#3584, co_comment#3568 AS co_comment_5#3585, co_orderdate#3569 AS co_orderdate_5#3586]
               :     +- Relation[rid#3553,cpfk_customer_orders#3554,cfpk_orders_customer#3555,cval_orders_o_orderstatus#3556,cval_orders_o_totalprice#3557,cval_orders_o_orderpriority#3558,cval_orders_o_clerk#3559,cval_orders_o_shippriority#3560,cval_orders_o_comment#3561,cval_orders_o_orderdate#3562,co_orderstatus#3563,co_totalprice#3564,co_orderpriority#3565,co_clerk#3566,co_shippriority#3567,co_comment#3568,co_orderdate#3569] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#3489 AS rid_5#3506, cpfk_customer_orders#3490 AS cpfk_customer_orders_5#3507, cfpk_orders_customer#3491 AS cfpk_orders_customer_5#3508, cval_orders_o_orderstatus#3492 AS cval_orders_o_orderstatus_5#3509, cval_orders_o_totalprice#3493 AS cval_orders_o_totalprice_5#3510, cval_orders_o_orderpriority#3494 AS cval_orders_o_orderpriority_5#3511, cval_orders_o_clerk#3495 AS cval_orders_o_clerk_5#3512, cval_orders_o_shippriority#3496 AS cval_orders_o_shippriority_5#3513, cval_orders_o_comment#3497 AS cval_orders_o_comment_5#3514, cval_orders_o_orderdate#3498 AS cval_orders_o_orderdate_5#3515, co_orderstatus#3499 AS co_orderstatus_5#3516, co_totalprice#3500 AS co_totalprice_5#3517, co_orderpriority#3501 AS co_orderpriority_5#3518, co_clerk#3502 AS co_clerk_5#3519, co_shippriority#3503 AS co_shippriority_5#3520, co_comment#3504 AS co_comment_5#3521, co_orderdate#3505 AS co_orderdate_5#3522]
                  +- Relation[rid#3489,cpfk_customer_orders#3490,cfpk_orders_customer#3491,cval_orders_o_orderstatus#3492,cval_orders_o_totalprice#3493,cval_orders_o_orderpriority#3494,cval_orders_o_clerk#3495,cval_orders_o_shippriority#3496,cval_orders_o_comment#3497,cval_orders_o_orderdate#3498,co_orderstatus#3499,co_totalprice#3500,co_orderpriority#3501,co_clerk#3502,co_shippriority#3503,co_comment#3504,co_orderdate#3505] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 401ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/15 17:36:07 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:36:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3683L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:36:07 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:36:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3683L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#3685 AS rid_0#3690, cval_region_r_name#3686 AS cval_region_r_name_0#3691, cval_region_r_comment#3687 AS cval_region_r_comment_0#3692, cr_name#3688 AS cr_name_0#3693, cr_comment#3689 AS cr_comment_0#3694]
         :  :  :  :  :  :  :  +- Relation[rid#3685,cval_region_r_name#3686,cval_region_r_comment#3687,cr_name#3688,cr_comment#3689] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#3695 AS rid_0#3700, cval_region_r_name#3696 AS cval_region_r_name_0#3701, cval_region_r_comment#3697 AS cval_region_r_comment_0#3702, cr_name#3698 AS cr_name_0#3703, cr_comment#3699 AS cr_comment_0#3704]
         :  :  :  :  :  :        +- Relation[rid#3695,cval_region_r_name#3696,cval_region_r_comment#3697,cr_name#3698,cr_comment#3699] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- Project [rid#3729 AS rid_1#3736, cpfk_region_nation#3730 AS cpfk_region_nation_1#3737, cfpk_nation_region#3731 AS cfpk_nation_region_1#3738, cval_nation_n_name#3732 AS cval_nation_n_name_1#3739, cval_nation_n_comment#3733 AS cval_nation_n_comment_1#3740, cn_name#3734 AS cn_name_1#3741, cn_comment#3735 AS cn_comment_1#3742]
         :  :  :  :  :     +- Relation[rid#3729,cpfk_region_nation#3730,cfpk_nation_region#3731,cval_nation_n_name#3732,cval_nation_n_comment#3733,cn_name#3734,cn_comment#3735] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#3705 AS rid_1#3712, cpfk_region_nation#3706 AS cpfk_region_nation_1#3713, cfpk_nation_region#3707 AS cfpk_nation_region_1#3714, cval_nation_n_name#3708 AS cval_nation_n_name_1#3715, cval_nation_n_comment#3709 AS cval_nation_n_comment_1#3716, cn_name#3710 AS cn_name_1#3717, cn_comment#3711 AS cn_comment_1#3718]
         :  :  :  :     +- Relation[rid#3705,cpfk_region_nation#3706,cfpk_nation_region#3707,cval_nation_n_name#3708,cval_nation_n_comment#3709,cn_name#3710,cn_comment#3711] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#3783 AS rid_2#3796, cpfk_nation_supplier#3784 AS cpfk_nation_supplier_2#3797, cfpk_supplier_nation#3785 AS cfpk_supplier_nation_2#3798, cval_supplier_s_name#3786 AS cval_supplier_s_name_2#3799, cval_supplier_s_address#3787 AS cval_supplier_s_address_2#3800, cval_supplier_s_phone#3788 AS cval_supplier_s_phone_2#3801, cval_supplier_s_acctbal#3789 AS cval_supplier_s_acctbal_2#3802, cval_supplier_s_comment#3790 AS cval_supplier_s_comment_2#3803, cs_name#3791 AS cs_name_2#3804, cs_address#3792 AS cs_address_2#3805, cs_phone#3793 AS cs_phone_2#3806, cs_acctbal#3794 AS cs_acctbal_2#3807, cs_comment#3795 AS cs_comment_2#3808]
         :  :  :     +- Relation[rid#3783,cpfk_nation_supplier#3784,cfpk_supplier_nation#3785,cval_supplier_s_name#3786,cval_supplier_s_address#3787,cval_supplier_s_phone#3788,cval_supplier_s_acctbal#3789,cval_supplier_s_comment#3790,cs_name#3791,cs_address#3792,cs_phone#3793,cs_acctbal#3794,cs_comment#3795] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#3743 AS rid_2#3756, cpfk_nation_supplier#3744 AS cpfk_nation_supplier_2#3757, cfpk_supplier_nation#3745 AS cfpk_supplier_nation_2#3758, cval_supplier_s_name#3746 AS cval_supplier_s_name_2#3759, cval_supplier_s_address#3747 AS cval_supplier_s_address_2#3760, cval_supplier_s_phone#3748 AS cval_supplier_s_phone_2#3761, cval_supplier_s_acctbal#3749 AS cval_supplier_s_acctbal_2#3762, cval_supplier_s_comment#3750 AS cval_supplier_s_comment_2#3763, cs_name#3751 AS cs_name_2#3764, cs_address#3752 AS cs_address_2#3765, cs_phone#3753 AS cs_phone_2#3766, cs_acctbal#3754 AS cs_acctbal_2#3767, cs_comment#3755 AS cs_comment_2#3768]
         :  :     +- Relation[rid#3743,cpfk_nation_supplier#3744,cfpk_supplier_nation#3745,cval_supplier_s_name#3746,cval_supplier_s_address#3747,cval_supplier_s_phone#3748,cval_supplier_s_acctbal#3749,cval_supplier_s_comment#3750,cs_name#3751,cs_address#3752,cs_phone#3753,cs_acctbal#3754,cs_comment#3755] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#3981 AS rid_4#3992, cpfk_part_partsupp#3982 AS cpfk_part_partsupp_4#3993, cfpk_partsupp_part#3983 AS cfpk_partsupp_part_4#3994, cpfk_supplier_partsupp#3984 AS cpfk_supplier_partsupp_4#3995, cfpk_partsupp_supplier#3985 AS cfpk_partsupp_supplier_4#3996, cval_partsupp_ps_availqty#3986 AS cval_partsupp_ps_availqty_4#3997, cval_partsupp_ps_supplycost#3987 AS cval_partsupp_ps_supplycost_4#3998, cval_partsupp_ps_comment#3988 AS cval_partsupp_ps_comment_4#3999, cps_availqty#3989 AS cps_availqty_4#4000, cps_supplycost#3990 AS cps_supplycost_4#4001, cps_comment#3991 AS cps_comment_4#4002]
         :     +- Relation[rid#3981,cpfk_part_partsupp#3982,cfpk_partsupp_part#3983,cpfk_supplier_partsupp#3984,cfpk_partsupp_supplier#3985,cval_partsupp_ps_availqty#3986,cval_partsupp_ps_supplycost#3987,cval_partsupp_ps_comment#3988,cps_availqty#3989,cps_supplycost#3990,cps_comment#3991] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#3809 AS rid_3#3826, cval_part_p_name#3810 AS cval_part_p_name_3#3827, cval_part_p_mfgr#3811 AS cval_part_p_mfgr_3#3828, cval_part_p_type#3812 AS cval_part_p_type_3#3829, cval_part_p_size#3813 AS cval_part_p_size_3#3830, cval_part_p_container#3814 AS cval_part_p_container_3#3831, cval_part_p_retailprice#3815 AS cval_part_p_retailprice_3#3832, cval_part_p_comment#3816 AS cval_part_p_comment_3#3833, cval_part_p_brand#3817 AS cval_part_p_brand_3#3834, cp_name#3818 AS cp_name_3#3835, cp_mfgr#3819 AS cp_mfgr_3#3836, cp_type#3820 AS cp_type_3#3837, cp_size#3821 AS cp_size_3#3838, cp_container#3822 AS cp_container_3#3839, cp_retailprice#3823 AS cp_retailprice_3#3840, cp_comment#3824 AS cp_comment_3#3841, cp_brand#3825 AS cp_brand_3#3842]
            :  :  :  +- Relation[rid#3809,cval_part_p_name#3810,cval_part_p_mfgr#3811,cval_part_p_type#3812,cval_part_p_size#3813,cval_part_p_container#3814,cval_part_p_retailprice#3815,cval_part_p_comment#3816,cval_part_p_brand#3817,cp_name#3818,cp_mfgr#3819,cp_type#3820,cp_size#3821,cp_container#3822,cp_retailprice#3823,cp_comment#3824,cp_brand#3825] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#3843 AS rid_3#3860, cval_part_p_name#3844 AS cval_part_p_name_3#3861, cval_part_p_mfgr#3845 AS cval_part_p_mfgr_3#3862, cval_part_p_type#3846 AS cval_part_p_type_3#3863, cval_part_p_size#3847 AS cval_part_p_size_3#3864, cval_part_p_container#3848 AS cval_part_p_container_3#3865, cval_part_p_retailprice#3849 AS cval_part_p_retailprice_3#3866, cval_part_p_comment#3850 AS cval_part_p_comment_3#3867, cval_part_p_brand#3851 AS cval_part_p_brand_3#3868, cp_name#3852 AS cp_name_3#3869, cp_mfgr#3853 AS cp_mfgr_3#3870, cp_type#3854 AS cp_type_3#3871, cp_size#3855 AS cp_size_3#3872, cp_container#3856 AS cp_container_3#3873, cp_retailprice#3857 AS cp_retailprice_3#3874, cp_comment#3858 AS cp_comment_3#3875, cp_brand#3859 AS cp_brand_3#3876]
            :  :        +- Relation[rid#3843,cval_part_p_name#3844,cval_part_p_mfgr#3845,cval_part_p_type#3846,cval_part_p_size#3847,cval_part_p_container#3848,cval_part_p_retailprice#3849,cval_part_p_comment#3850,cval_part_p_brand#3851,cp_name#3852,cp_mfgr#3853,cp_type#3854,cp_size#3855,cp_container#3856,cp_retailprice#3857,cp_comment#3858,cp_brand#3859] JDBCRelation(tpart) [numPartitions=1]
            :  +- Project [rid#3933 AS rid_4#3944, cpfk_part_partsupp#3934 AS cpfk_part_partsupp_4#3945, cfpk_partsupp_part#3935 AS cfpk_partsupp_part_4#3946, cpfk_supplier_partsupp#3936 AS cpfk_supplier_partsupp_4#3947, cfpk_partsupp_supplier#3937 AS cfpk_partsupp_supplier_4#3948, cval_partsupp_ps_availqty#3938 AS cval_partsupp_ps_availqty_4#3949, cval_partsupp_ps_supplycost#3939 AS cval_partsupp_ps_supplycost_4#3950, cval_partsupp_ps_comment#3940 AS cval_partsupp_ps_comment_4#3951, cps_availqty#3941 AS cps_availqty_4#3952, cps_supplycost#3942 AS cps_supplycost_4#3953, cps_comment#3943 AS cps_comment_4#3954]
            :     +- Relation[rid#3933,cpfk_part_partsupp#3934,cfpk_partsupp_part#3935,cpfk_supplier_partsupp#3936,cfpk_partsupp_supplier#3937,cval_partsupp_ps_availqty#3938,cval_partsupp_ps_supplycost#3939,cval_partsupp_ps_comment#3940,cps_availqty#3941,cps_supplycost#3942,cps_comment#3943] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#3877 AS rid_4#3888, cpfk_part_partsupp#3878 AS cpfk_part_partsupp_4#3889, cfpk_partsupp_part#3879 AS cfpk_partsupp_part_4#3890, cpfk_supplier_partsupp#3880 AS cpfk_supplier_partsupp_4#3891, cfpk_partsupp_supplier#3881 AS cfpk_partsupp_supplier_4#3892, cval_partsupp_ps_availqty#3882 AS cval_partsupp_ps_availqty_4#3893, cval_partsupp_ps_supplycost#3883 AS cval_partsupp_ps_supplycost_4#3894, cval_partsupp_ps_comment#3884 AS cval_partsupp_ps_comment_4#3895, cps_availqty#3885 AS cps_availqty_4#3896, cps_supplycost#3886 AS cps_supplycost_4#3897, cps_comment#3887 AS cps_comment_4#3898]
               +- Relation[rid#3877,cpfk_part_partsupp#3878,cfpk_partsupp_part#3879,cpfk_supplier_partsupp#3880,cfpk_partsupp_supplier#3881,cval_partsupp_ps_availqty#3882,cval_partsupp_ps_supplycost#3883,cval_partsupp_ps_comment#3884,cps_availqty#3885,cps_supplycost#3886,cps_comment#3887] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 1743ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/15 17:36:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:36:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4068L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 17:36:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:36:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:36:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4068L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#4070 AS rid_0#4103, cpfk_orders_lineitem#4071 AS cpfk_orders_lineitem_0#4104, cpfk_supplier_lineitem#4072 AS cpfk_supplier_lineitem_0#4105, cfpk_lineitem_supplier#4073 AS cfpk_lineitem_supplier_0#4106, cfpk_lineitem_partsupp#4074 AS cfpk_lineitem_partsupp_0#4107, cpfk_part_lineitem#4075 AS cpfk_part_lineitem_0#4108, cfpk_lineitem_part#4076 AS cfpk_lineitem_part_0#4109, cpfk_partsupp_lineitem#4077 AS cpfk_partsupp_lineitem_0#4110, cfpk_lineitem_orders#4078 AS cfpk_lineitem_orders_0#4111, cval_lineitem_l_quantity#4079 AS cval_lineitem_l_quantity_0#4112, cval_lineitem_l_extendedprice#4080 AS cval_lineitem_l_extendedprice_0#4113, cval_lineitem_l_discount#4081 AS cval_lineitem_l_discount_0#4114, cval_lineitem_l_tax#4082 AS cval_lineitem_l_tax_0#4115, cval_lineitem_l_returnflag#4083 AS cval_lineitem_l_returnflag_0#4116, cval_lineitem_l_linestatus#4084 AS cval_lineitem_l_linestatus_0#4117, cval_lineitem_l_commitdate#4085 AS cval_lineitem_l_commitdate_0#4118, cval_lineitem_l_receiptdate#4086 AS cval_lineitem_l_receiptdate_0#4119, cval_lineitem_l_shipinstruct#4087 AS cval_lineitem_l_shipinstruct_0#4120, cval_lineitem_l_shipmode#4088 AS cval_lineitem_l_shipmode_0#4121, cval_lineitem_l_comment#4089 AS cval_lineitem_l_comment_0#4122, cval_lineitem_l_shipdate#4090 AS cval_lineitem_l_shipdate_0#4123, cl_quantity#4091 AS cl_quantity_0#4124, cl_extendedprice#4092 AS cl_extendedprice_0#4125, cl_discount#4093 AS cl_discount_0#4126, ... 9 more fields]
            :     :     :  :  +- Relation[rid#4070,cpfk_orders_lineitem#4071,cpfk_supplier_lineitem#4072,cfpk_lineitem_supplier#4073,cfpk_lineitem_partsupp#4074,cpfk_part_lineitem#4075,cfpk_lineitem_part#4076,cpfk_partsupp_lineitem#4077,cfpk_lineitem_orders#4078,cval_lineitem_l_quantity#4079,cval_lineitem_l_extendedprice#4080,cval_lineitem_l_discount#4081,cval_lineitem_l_tax#4082,cval_lineitem_l_returnflag#4083,cval_lineitem_l_linestatus#4084,cval_lineitem_l_commitdate#4085,cval_lineitem_l_receiptdate#4086,cval_lineitem_l_shipinstruct#4087,cval_lineitem_l_shipmode#4088,cval_lineitem_l_comment#4089,cval_lineitem_l_shipdate#4090,cl_quantity#4091,cl_extendedprice#4092,cl_discount#4093,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#4136 AS rid_0#4169, cpfk_orders_lineitem#4137 AS cpfk_orders_lineitem_0#4170, cpfk_supplier_lineitem#4138 AS cpfk_supplier_lineitem_0#4171, cfpk_lineitem_supplier#4139 AS cfpk_lineitem_supplier_0#4172, cfpk_lineitem_partsupp#4140 AS cfpk_lineitem_partsupp_0#4173, cpfk_part_lineitem#4141 AS cpfk_part_lineitem_0#4174, cfpk_lineitem_part#4142 AS cfpk_lineitem_part_0#4175, cpfk_partsupp_lineitem#4143 AS cpfk_partsupp_lineitem_0#4176, cfpk_lineitem_orders#4144 AS cfpk_lineitem_orders_0#4177, cval_lineitem_l_quantity#4145 AS cval_lineitem_l_quantity_0#4178, cval_lineitem_l_extendedprice#4146 AS cval_lineitem_l_extendedprice_0#4179, cval_lineitem_l_discount#4147 AS cval_lineitem_l_discount_0#4180, cval_lineitem_l_tax#4148 AS cval_lineitem_l_tax_0#4181, cval_lineitem_l_returnflag#4149 AS cval_lineitem_l_returnflag_0#4182, cval_lineitem_l_linestatus#4150 AS cval_lineitem_l_linestatus_0#4183, cval_lineitem_l_commitdate#4151 AS cval_lineitem_l_commitdate_0#4184, cval_lineitem_l_receiptdate#4152 AS cval_lineitem_l_receiptdate_0#4185, cval_lineitem_l_shipinstruct#4153 AS cval_lineitem_l_shipinstruct_0#4186, cval_lineitem_l_shipmode#4154 AS cval_lineitem_l_shipmode_0#4187, cval_lineitem_l_comment#4155 AS cval_lineitem_l_comment_0#4188, cval_lineitem_l_shipdate#4156 AS cval_lineitem_l_shipdate_0#4189, cl_quantity#4157 AS cl_quantity_0#4190, cl_extendedprice#4158 AS cl_extendedprice_0#4191, cl_discount#4159 AS cl_discount_0#4192, ... 9 more fields]
            :     :     :        +- Relation[rid#4136,cpfk_orders_lineitem#4137,cpfk_supplier_lineitem#4138,cfpk_lineitem_supplier#4139,cfpk_lineitem_partsupp#4140,cpfk_part_lineitem#4141,cfpk_lineitem_part#4142,cpfk_partsupp_lineitem#4143,cfpk_lineitem_orders#4144,cval_lineitem_l_quantity#4145,cval_lineitem_l_extendedprice#4146,cval_lineitem_l_discount#4147,cval_lineitem_l_tax#4148,cval_lineitem_l_returnflag#4149,cval_lineitem_l_linestatus#4150,cval_lineitem_l_commitdate#4151,cval_lineitem_l_receiptdate#4152,cval_lineitem_l_shipinstruct#4153,cval_lineitem_l_shipmode#4154,cval_lineitem_l_comment#4155,cval_lineitem_l_shipdate#4156,cl_quantity#4157,cl_extendedprice#4158,cl_discount#4159,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#4202 AS rid_1#4219, cpfk_customer_orders#4203 AS cpfk_customer_orders_1#4220, cfpk_orders_customer#4204 AS cfpk_orders_customer_1#4221, cval_orders_o_orderstatus#4205 AS cval_orders_o_orderstatus_1#4222, cval_orders_o_totalprice#4206 AS cval_orders_o_totalprice_1#4223, cval_orders_o_orderpriority#4207 AS cval_orders_o_orderpriority_1#4224, cval_orders_o_clerk#4208 AS cval_orders_o_clerk_1#4225, cval_orders_o_shippriority#4209 AS cval_orders_o_shippriority_1#4226, cval_orders_o_comment#4210 AS cval_orders_o_comment_1#4227, cval_orders_o_orderdate#4211 AS cval_orders_o_orderdate_1#4228, co_orderstatus#4212 AS co_orderstatus_1#4229, co_totalprice#4213 AS co_totalprice_1#4230, co_orderpriority#4214 AS co_orderpriority_1#4231, co_clerk#4215 AS co_clerk_1#4232, co_shippriority#4216 AS co_shippriority_1#4233, co_comment#4217 AS co_comment_1#4234, co_orderdate#4218 AS co_orderdate_1#4235]
            :     :        +- Relation[rid#4202,cpfk_customer_orders#4203,cfpk_orders_customer#4204,cval_orders_o_orderstatus#4205,cval_orders_o_totalprice#4206,cval_orders_o_orderpriority#4207,cval_orders_o_clerk#4208,cval_orders_o_shippriority#4209,cval_orders_o_comment#4210,cval_orders_o_orderdate#4211,co_orderstatus#4212,co_totalprice#4213,co_orderpriority#4214,co_clerk#4215,co_shippriority#4216,co_comment#4217,co_orderdate#4218] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#4236 AS rid_2#4251, cpfk_nation_customer#4237 AS cpfk_nation_customer_2#4252, cfpk_customer_nation#4238 AS cfpk_customer_nation_2#4253, cval_customer_c_name#4239 AS cval_customer_c_name_2#4254, cval_customer_c_address#4240 AS cval_customer_c_address_2#4255, cval_customer_c_phone#4241 AS cval_customer_c_phone_2#4256, cval_customer_c_acctbal#4242 AS cval_customer_c_acctbal_2#4257, cval_customer_c_comment#4243 AS cval_customer_c_comment_2#4258, cval_customer_c_mktsegment#4244 AS cval_customer_c_mktsegment_2#4259, cc_name#4245 AS cc_name_2#4260, cc_address#4246 AS cc_address_2#4261, cc_phone#4247 AS cc_phone_2#4262, cc_acctbal#4248 AS cc_acctbal_2#4263, cc_comment#4249 AS cc_comment_2#4264, cc_mktsegment#4250 AS cc_mktsegment_2#4265]
            :        +- Relation[rid#4236,cpfk_nation_customer#4237,cfpk_customer_nation#4238,cval_customer_c_name#4239,cval_customer_c_address#4240,cval_customer_c_phone#4241,cval_customer_c_acctbal#4242,cval_customer_c_comment#4243,cval_customer_c_mktsegment#4244,cc_name#4245,cc_address#4246,cc_phone#4247,cc_acctbal#4248,cc_comment#4249,cc_mktsegment#4250] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#4266 AS rid_3#4273, cpfk_region_nation#4267 AS cpfk_region_nation_3#4274, cfpk_nation_region#4268 AS cfpk_nation_region_3#4275, cval_nation_n_name#4269 AS cval_nation_n_name_3#4276, cval_nation_n_comment#4270 AS cval_nation_n_comment_3#4277, cn_name#4271 AS cn_name_3#4278, cn_comment#4272 AS cn_comment_3#4279]
               +- Relation[rid#4266,cpfk_region_nation#4267,cfpk_nation_region#4268,cval_nation_n_name#4269,cval_nation_n_comment#4270,cn_name#4271,cn_comment#4272] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 67633ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 17:37:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:37:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4361L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 17:37:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:37:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:37:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:37:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:37:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:37:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:37:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:37:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:37:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:37:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:37:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4361L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#4363 AS rid_0#4370, cpfk_region_nation#4364 AS cpfk_region_nation_0#4371, cfpk_nation_region#4365 AS cfpk_nation_region_0#4372, cval_nation_n_name#4366 AS cval_nation_n_name_0#4373, cval_nation_n_comment#4367 AS cval_nation_n_comment_0#4374, cn_name#4368 AS cn_name_0#4375, cn_comment#4369 AS cn_comment_0#4376]
            :     :     :  :  :  :  :  +- Relation[rid#4363,cpfk_region_nation#4364,cfpk_nation_region#4365,cval_nation_n_name#4366,cval_nation_n_comment#4367,cn_name#4368,cn_comment#4369] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#4403 AS rid_0#4410, cpfk_region_nation#4404 AS cpfk_region_nation_0#4411, cfpk_nation_region#4405 AS cfpk_nation_region_0#4412, cval_nation_n_name#4406 AS cval_nation_n_name_0#4413, cval_nation_n_comment#4407 AS cval_nation_n_comment_0#4414, cn_name#4408 AS cn_name_0#4415, cn_comment#4409 AS cn_comment_0#4416]
            :     :     :  :  :  :     :  +- Relation[rid#4403,cpfk_region_nation#4404,cfpk_nation_region#4405,cval_nation_n_name#4406,cval_nation_n_comment#4407,cn_name#4408,cn_comment#4409] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#4417 AS rid_1#4430, cpfk_nation_supplier#4418 AS cpfk_nation_supplier_1#4431, cfpk_supplier_nation#4419 AS cfpk_supplier_nation_1#4432, cval_supplier_s_name#4420 AS cval_supplier_s_name_1#4433, cval_supplier_s_address#4421 AS cval_supplier_s_address_1#4434, cval_supplier_s_phone#4422 AS cval_supplier_s_phone_1#4435, cval_supplier_s_acctbal#4423 AS cval_supplier_s_acctbal_1#4436, cval_supplier_s_comment#4424 AS cval_supplier_s_comment_1#4437, cs_name#4425 AS cs_name_1#4438, cs_address#4426 AS cs_address_1#4439, cs_phone#4427 AS cs_phone_1#4440, cs_acctbal#4428 AS cs_acctbal_1#4441, cs_comment#4429 AS cs_comment_1#4442]
            :     :     :  :  :  :        +- Relation[rid#4417,cpfk_nation_supplier#4418,cfpk_supplier_nation#4419,cval_supplier_s_name#4420,cval_supplier_s_address#4421,cval_supplier_s_phone#4422,cval_supplier_s_acctbal#4423,cval_supplier_s_comment#4424,cs_name#4425,cs_address#4426,cs_phone#4427,cs_acctbal#4428,cs_comment#4429] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#4377 AS rid_1#4390, cpfk_nation_supplier#4378 AS cpfk_nation_supplier_1#4391, cfpk_supplier_nation#4379 AS cfpk_supplier_nation_1#4392, cval_supplier_s_name#4380 AS cval_supplier_s_name_1#4393, cval_supplier_s_address#4381 AS cval_supplier_s_address_1#4394, cval_supplier_s_phone#4382 AS cval_supplier_s_phone_1#4395, cval_supplier_s_acctbal#4383 AS cval_supplier_s_acctbal_1#4396, cval_supplier_s_comment#4384 AS cval_supplier_s_comment_1#4397, cs_name#4385 AS cs_name_1#4398, cs_address#4386 AS cs_address_1#4399, cs_phone#4387 AS cs_phone_1#4400, cs_acctbal#4388 AS cs_acctbal_1#4401, cs_comment#4389 AS cs_comment_1#4402]
            :     :     :  :  :     +- Relation[rid#4377,cpfk_nation_supplier#4378,cfpk_supplier_nation#4379,cval_supplier_s_name#4380,cval_supplier_s_address#4381,cval_supplier_s_phone#4382,cval_supplier_s_acctbal#4383,cval_supplier_s_comment#4384,cs_name#4385,cs_address#4386,cs_phone#4387,cs_acctbal#4388,cs_comment#4389] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#4509 AS rid_1#4522, cpfk_nation_supplier#4510 AS cpfk_nation_supplier_1#4523, cfpk_supplier_nation#4511 AS cfpk_supplier_nation_1#4524, cval_supplier_s_name#4512 AS cval_supplier_s_name_1#4525, cval_supplier_s_address#4513 AS cval_supplier_s_address_1#4526, cval_supplier_s_phone#4514 AS cval_supplier_s_phone_1#4527, cval_supplier_s_acctbal#4515 AS cval_supplier_s_acctbal_1#4528, cval_supplier_s_comment#4516 AS cval_supplier_s_comment_1#4529, cs_name#4517 AS cs_name_1#4530, cs_address#4518 AS cs_address_1#4531, cs_phone#4519 AS cs_phone_1#4532, cs_acctbal#4520 AS cs_acctbal_1#4533, cs_comment#4521 AS cs_comment_1#4534]
            :     :     :  :     :  +- Relation[rid#4509,cpfk_nation_supplier#4510,cfpk_supplier_nation#4511,cval_supplier_s_name#4512,cval_supplier_s_address#4513,cval_supplier_s_phone#4514,cval_supplier_s_acctbal#4515,cval_supplier_s_comment#4516,cs_name#4517,cs_address#4518,cs_phone#4519,cs_acctbal#4520,cs_comment#4521] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#4535 AS rid_2#4568, cpfk_orders_lineitem#4536 AS cpfk_orders_lineitem_2#4569, cpfk_supplier_lineitem#4537 AS cpfk_supplier_lineitem_2#4570, cfpk_lineitem_supplier#4538 AS cfpk_lineitem_supplier_2#4571, cfpk_lineitem_partsupp#4539 AS cfpk_lineitem_partsupp_2#4572, cpfk_part_lineitem#4540 AS cpfk_part_lineitem_2#4573, cfpk_lineitem_part#4541 AS cfpk_lineitem_part_2#4574, cpfk_partsupp_lineitem#4542 AS cpfk_partsupp_lineitem_2#4575, cfpk_lineitem_orders#4543 AS cfpk_lineitem_orders_2#4576, cval_lineitem_l_quantity#4544 AS cval_lineitem_l_quantity_2#4577, cval_lineitem_l_extendedprice#4545 AS cval_lineitem_l_extendedprice_2#4578, cval_lineitem_l_discount#4546 AS cval_lineitem_l_discount_2#4579, cval_lineitem_l_tax#4547 AS cval_lineitem_l_tax_2#4580, cval_lineitem_l_returnflag#4548 AS cval_lineitem_l_returnflag_2#4581, cval_lineitem_l_linestatus#4549 AS cval_lineitem_l_linestatus_2#4582, cval_lineitem_l_commitdate#4550 AS cval_lineitem_l_commitdate_2#4583, cval_lineitem_l_receiptdate#4551 AS cval_lineitem_l_receiptdate_2#4584, cval_lineitem_l_shipinstruct#4552 AS cval_lineitem_l_shipinstruct_2#4585, cval_lineitem_l_shipmode#4553 AS cval_lineitem_l_shipmode_2#4586, cval_lineitem_l_comment#4554 AS cval_lineitem_l_comment_2#4587, cval_lineitem_l_shipdate#4555 AS cval_lineitem_l_shipdate_2#4588, cl_quantity#4556 AS cl_quantity_2#4589, cl_extendedprice#4557 AS cl_extendedprice_2#4590, cl_discount#4558 AS cl_discount_2#4591, ... 9 more fields]
            :     :     :  :        +- Relation[rid#4535,cpfk_orders_lineitem#4536,cpfk_supplier_lineitem#4537,cfpk_lineitem_supplier#4538,cfpk_lineitem_partsupp#4539,cpfk_part_lineitem#4540,cfpk_lineitem_part#4541,cpfk_partsupp_lineitem#4542,cfpk_lineitem_orders#4543,cval_lineitem_l_quantity#4544,cval_lineitem_l_extendedprice#4545,cval_lineitem_l_discount#4546,cval_lineitem_l_tax#4547,cval_lineitem_l_returnflag#4548,cval_lineitem_l_linestatus#4549,cval_lineitem_l_commitdate#4550,cval_lineitem_l_receiptdate#4551,cval_lineitem_l_shipinstruct#4552,cval_lineitem_l_shipmode#4553,cval_lineitem_l_comment#4554,cval_lineitem_l_shipdate#4555,cl_quantity#4556,cl_extendedprice#4557,cl_discount#4558,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#4443 AS rid_2#4476, cpfk_orders_lineitem#4444 AS cpfk_orders_lineitem_2#4477, cpfk_supplier_lineitem#4445 AS cpfk_supplier_lineitem_2#4478, cfpk_lineitem_supplier#4446 AS cfpk_lineitem_supplier_2#4479, cfpk_lineitem_partsupp#4447 AS cfpk_lineitem_partsupp_2#4480, cpfk_part_lineitem#4448 AS cpfk_part_lineitem_2#4481, cfpk_lineitem_part#4449 AS cfpk_lineitem_part_2#4482, cpfk_partsupp_lineitem#4450 AS cpfk_partsupp_lineitem_2#4483, cfpk_lineitem_orders#4451 AS cfpk_lineitem_orders_2#4484, cval_lineitem_l_quantity#4452 AS cval_lineitem_l_quantity_2#4485, cval_lineitem_l_extendedprice#4453 AS cval_lineitem_l_extendedprice_2#4486, cval_lineitem_l_discount#4454 AS cval_lineitem_l_discount_2#4487, cval_lineitem_l_tax#4455 AS cval_lineitem_l_tax_2#4488, cval_lineitem_l_returnflag#4456 AS cval_lineitem_l_returnflag_2#4489, cval_lineitem_l_linestatus#4457 AS cval_lineitem_l_linestatus_2#4490, cval_lineitem_l_commitdate#4458 AS cval_lineitem_l_commitdate_2#4491, cval_lineitem_l_receiptdate#4459 AS cval_lineitem_l_receiptdate_2#4492, cval_lineitem_l_shipinstruct#4460 AS cval_lineitem_l_shipinstruct_2#4493, cval_lineitem_l_shipmode#4461 AS cval_lineitem_l_shipmode_2#4494, cval_lineitem_l_comment#4462 AS cval_lineitem_l_comment_2#4495, cval_lineitem_l_shipdate#4463 AS cval_lineitem_l_shipdate_2#4496, cl_quantity#4464 AS cl_quantity_2#4497, cl_extendedprice#4465 AS cl_extendedprice_2#4498, cl_discount#4466 AS cl_discount_2#4499, ... 9 more fields]
            :     :     :     +- Relation[rid#4443,cpfk_orders_lineitem#4444,cpfk_supplier_lineitem#4445,cfpk_lineitem_supplier#4446,cfpk_lineitem_partsupp#4447,cpfk_part_lineitem#4448,cfpk_lineitem_part#4449,cpfk_partsupp_lineitem#4450,cfpk_lineitem_orders#4451,cval_lineitem_l_quantity#4452,cval_lineitem_l_extendedprice#4453,cval_lineitem_l_discount#4454,cval_lineitem_l_tax#4455,cval_lineitem_l_returnflag#4456,cval_lineitem_l_linestatus#4457,cval_lineitem_l_commitdate#4458,cval_lineitem_l_receiptdate#4459,cval_lineitem_l_shipinstruct#4460,cval_lineitem_l_shipmode#4461,cval_lineitem_l_comment#4462,cval_lineitem_l_shipdate#4463,cl_quantity#4464,cl_extendedprice#4465,cl_discount#4466,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#4601 AS rid_3#4618, cval_part_p_name#4602 AS cval_part_p_name_3#4619, cval_part_p_mfgr#4603 AS cval_part_p_mfgr_3#4620, cval_part_p_type#4604 AS cval_part_p_type_3#4621, cval_part_p_size#4605 AS cval_part_p_size_3#4622, cval_part_p_container#4606 AS cval_part_p_container_3#4623, cval_part_p_retailprice#4607 AS cval_part_p_retailprice_3#4624, cval_part_p_comment#4608 AS cval_part_p_comment_3#4625, cval_part_p_brand#4609 AS cval_part_p_brand_3#4626, cp_name#4610 AS cp_name_3#4627, cp_mfgr#4611 AS cp_mfgr_3#4628, cp_type#4612 AS cp_type_3#4629, cp_size#4613 AS cp_size_3#4630, cp_container#4614 AS cp_container_3#4631, cp_retailprice#4615 AS cp_retailprice_3#4632, cp_comment#4616 AS cp_comment_3#4633, cp_brand#4617 AS cp_brand_3#4634]
            :     :        +- Relation[rid#4601,cval_part_p_name#4602,cval_part_p_mfgr#4603,cval_part_p_type#4604,cval_part_p_size#4605,cval_part_p_container#4606,cval_part_p_retailprice#4607,cval_part_p_comment#4608,cval_part_p_brand#4609,cp_name#4610,cp_mfgr#4611,cp_type#4612,cp_size#4613,cp_container#4614,cp_retailprice#4615,cp_comment#4616,cp_brand#4617] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#4635 AS rid_4#4646, cpfk_part_partsupp#4636 AS cpfk_part_partsupp_4#4647, cfpk_partsupp_part#4637 AS cfpk_partsupp_part_4#4648, cpfk_supplier_partsupp#4638 AS cpfk_supplier_partsupp_4#4649, cfpk_partsupp_supplier#4639 AS cfpk_partsupp_supplier_4#4650, cval_partsupp_ps_availqty#4640 AS cval_partsupp_ps_availqty_4#4651, cval_partsupp_ps_supplycost#4641 AS cval_partsupp_ps_supplycost_4#4652, cval_partsupp_ps_comment#4642 AS cval_partsupp_ps_comment_4#4653, cps_availqty#4643 AS cps_availqty_4#4654, cps_supplycost#4644 AS cps_supplycost_4#4655, cps_comment#4645 AS cps_comment_4#4656]
            :        +- Relation[rid#4635,cpfk_part_partsupp#4636,cfpk_partsupp_part#4637,cpfk_supplier_partsupp#4638,cfpk_partsupp_supplier#4639,cval_partsupp_ps_availqty#4640,cval_partsupp_ps_supplycost#4641,cval_partsupp_ps_comment#4642,cps_availqty#4643,cps_supplycost#4644,cps_comment#4645] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#4657 AS rid_5#4674, cpfk_customer_orders#4658 AS cpfk_customer_orders_5#4675, cfpk_orders_customer#4659 AS cfpk_orders_customer_5#4676, cval_orders_o_orderstatus#4660 AS cval_orders_o_orderstatus_5#4677, cval_orders_o_totalprice#4661 AS cval_orders_o_totalprice_5#4678, cval_orders_o_orderpriority#4662 AS cval_orders_o_orderpriority_5#4679, cval_orders_o_clerk#4663 AS cval_orders_o_clerk_5#4680, cval_orders_o_shippriority#4664 AS cval_orders_o_shippriority_5#4681, cval_orders_o_comment#4665 AS cval_orders_o_comment_5#4682, cval_orders_o_orderdate#4666 AS cval_orders_o_orderdate_5#4683, co_orderstatus#4667 AS co_orderstatus_5#4684, co_totalprice#4668 AS co_totalprice_5#4685, co_orderpriority#4669 AS co_orderpriority_5#4686, co_clerk#4670 AS co_clerk_5#4687, co_shippriority#4671 AS co_shippriority_5#4688, co_comment#4672 AS co_comment_5#4689, co_orderdate#4673 AS co_orderdate_5#4690]
               +- Relation[rid#4657,cpfk_customer_orders#4658,cfpk_orders_customer#4659,cval_orders_o_orderstatus#4660,cval_orders_o_totalprice#4661,cval_orders_o_orderpriority#4662,cval_orders_o_clerk#4663,cval_orders_o_shippriority#4664,cval_orders_o_comment#4665,cval_orders_o_orderdate#4666,co_orderstatus#4667,co_totalprice#4668,co_orderpriority#4669,co_clerk#4670,co_shippriority#4671,co_comment#4672,co_orderdate#4673] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 268226ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/15 17:41:44 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:41:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4794L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:41:44 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:41:44 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:41:44 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:41:44 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:41:44 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:41:44 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:41:44 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 17:41:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4794L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#4796 AS rid_0#4813, cval_part_p_name#4797 AS cval_part_p_name_0#4814, cval_part_p_mfgr#4798 AS cval_part_p_mfgr_0#4815, cval_part_p_type#4799 AS cval_part_p_type_0#4816, cval_part_p_size#4800 AS cval_part_p_size_0#4817, cval_part_p_container#4801 AS cval_part_p_container_0#4818, cval_part_p_retailprice#4802 AS cval_part_p_retailprice_0#4819, cval_part_p_comment#4803 AS cval_part_p_comment_0#4820, cval_part_p_brand#4804 AS cval_part_p_brand_0#4821, cp_name#4805 AS cp_name_0#4822, cp_mfgr#4806 AS cp_mfgr_0#4823, cp_type#4807 AS cp_type_0#4824, cp_size#4808 AS cp_size_0#4825, cp_container#4809 AS cp_container_0#4826, cp_retailprice#4810 AS cp_retailprice_0#4827, cp_comment#4811 AS cp_comment_0#4828, cp_brand#4812 AS cp_brand_0#4829]
         :  :  :  :  +- Relation[rid#4796,cval_part_p_name#4797,cval_part_p_mfgr#4798,cval_part_p_type#4799,cval_part_p_size#4800,cval_part_p_container#4801,cval_part_p_retailprice#4802,cval_part_p_comment#4803,cval_part_p_brand#4804,cp_name#4805,cp_mfgr#4806,cp_type#4807,cp_size#4808,cp_container#4809,cp_retailprice#4810,cp_comment#4811,cp_brand#4812] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#4830 AS rid_0#4847, cval_part_p_name#4831 AS cval_part_p_name_0#4848, cval_part_p_mfgr#4832 AS cval_part_p_mfgr_0#4849, cval_part_p_type#4833 AS cval_part_p_type_0#4850, cval_part_p_size#4834 AS cval_part_p_size_0#4851, cval_part_p_container#4835 AS cval_part_p_container_0#4852, cval_part_p_retailprice#4836 AS cval_part_p_retailprice_0#4853, cval_part_p_comment#4837 AS cval_part_p_comment_0#4854, cval_part_p_brand#4838 AS cval_part_p_brand_0#4855, cp_name#4839 AS cp_name_0#4856, cp_mfgr#4840 AS cp_mfgr_0#4857, cp_type#4841 AS cp_type_0#4858, cp_size#4842 AS cp_size_0#4859, cp_container#4843 AS cp_container_0#4860, cp_retailprice#4844 AS cp_retailprice_0#4861, cp_comment#4845 AS cp_comment_0#4862, cp_brand#4846 AS cp_brand_0#4863]
         :  :  :        +- Relation[rid#4830,cval_part_p_name#4831,cval_part_p_mfgr#4832,cval_part_p_type#4833,cval_part_p_size#4834,cval_part_p_container#4835,cval_part_p_retailprice#4836,cval_part_p_comment#4837,cval_part_p_brand#4838,cp_name#4839,cp_mfgr#4840,cp_type#4841,cp_size#4842,cp_container#4843,cp_retailprice#4844,cp_comment#4845,cp_brand#4846] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#4864 AS rid_0#4881, cval_part_p_name#4865 AS cval_part_p_name_0#4882, cval_part_p_mfgr#4866 AS cval_part_p_mfgr_0#4883, cval_part_p_type#4867 AS cval_part_p_type_0#4884, cval_part_p_size#4868 AS cval_part_p_size_0#4885, cval_part_p_container#4869 AS cval_part_p_container_0#4886, cval_part_p_retailprice#4870 AS cval_part_p_retailprice_0#4887, cval_part_p_comment#4871 AS cval_part_p_comment_0#4888, cval_part_p_brand#4872 AS cval_part_p_brand_0#4889, cp_name#4873 AS cp_name_0#4890, cp_mfgr#4874 AS cp_mfgr_0#4891, cp_type#4875 AS cp_type_0#4892, cp_size#4876 AS cp_size_0#4893, cp_container#4877 AS cp_container_0#4894, cp_retailprice#4878 AS cp_retailprice_0#4895, cp_comment#4879 AS cp_comment_0#4896, cp_brand#4880 AS cp_brand_0#4897]
         :  :        +- Relation[rid#4864,cval_part_p_name#4865,cval_part_p_mfgr#4866,cval_part_p_type#4867,cval_part_p_size#4868,cval_part_p_container#4869,cval_part_p_retailprice#4870,cval_part_p_comment#4871,cval_part_p_brand#4872,cp_name#4873,cp_mfgr#4874,cp_type#4875,cp_size#4876,cp_container#4877,cp_retailprice#4878,cp_comment#4879,cp_brand#4880] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#5130 AS rid_1#5163, cpfk_orders_lineitem#5131 AS cpfk_orders_lineitem_1#5164, cpfk_supplier_lineitem#5132 AS cpfk_supplier_lineitem_1#5165, cfpk_lineitem_supplier#5133 AS cfpk_lineitem_supplier_1#5166, cfpk_lineitem_partsupp#5134 AS cfpk_lineitem_partsupp_1#5167, cpfk_part_lineitem#5135 AS cpfk_part_lineitem_1#5168, cfpk_lineitem_part#5136 AS cfpk_lineitem_part_1#5169, cpfk_partsupp_lineitem#5137 AS cpfk_partsupp_lineitem_1#5170, cfpk_lineitem_orders#5138 AS cfpk_lineitem_orders_1#5171, cval_lineitem_l_quantity#5139 AS cval_lineitem_l_quantity_1#5172, cval_lineitem_l_extendedprice#5140 AS cval_lineitem_l_extendedprice_1#5173, cval_lineitem_l_discount#5141 AS cval_lineitem_l_discount_1#5174, cval_lineitem_l_tax#5142 AS cval_lineitem_l_tax_1#5175, cval_lineitem_l_returnflag#5143 AS cval_lineitem_l_returnflag_1#5176, cval_lineitem_l_linestatus#5144 AS cval_lineitem_l_linestatus_1#5177, cval_lineitem_l_commitdate#5145 AS cval_lineitem_l_commitdate_1#5178, cval_lineitem_l_receiptdate#5146 AS cval_lineitem_l_receiptdate_1#5179, cval_lineitem_l_shipinstruct#5147 AS cval_lineitem_l_shipinstruct_1#5180, cval_lineitem_l_shipmode#5148 AS cval_lineitem_l_shipmode_1#5181, cval_lineitem_l_comment#5149 AS cval_lineitem_l_comment_1#5182, cval_lineitem_l_shipdate#5150 AS cval_lineitem_l_shipdate_1#5183, cl_quantity#5151 AS cl_quantity_1#5184, cl_extendedprice#5152 AS cl_extendedprice_1#5185, cl_discount#5153 AS cl_discount_1#5186, ... 9 more fields]
         :     +- Relation[rid#5130,cpfk_orders_lineitem#5131,cpfk_supplier_lineitem#5132,cfpk_lineitem_supplier#5133,cfpk_lineitem_partsupp#5134,cpfk_part_lineitem#5135,cfpk_lineitem_part#5136,cpfk_partsupp_lineitem#5137,cfpk_lineitem_orders#5138,cval_lineitem_l_quantity#5139,cval_lineitem_l_extendedprice#5140,cval_lineitem_l_discount#5141,cval_lineitem_l_tax#5142,cval_lineitem_l_returnflag#5143,cval_lineitem_l_linestatus#5144,cval_lineitem_l_commitdate#5145,cval_lineitem_l_receiptdate#5146,cval_lineitem_l_shipinstruct#5147,cval_lineitem_l_shipmode#5148,cval_lineitem_l_comment#5149,cval_lineitem_l_shipdate#5150,cl_quantity#5151,cl_extendedprice#5152,cl_discount#5153,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#4898 AS rid_1#4931, cpfk_orders_lineitem#4899 AS cpfk_orders_lineitem_1#4932, cpfk_supplier_lineitem#4900 AS cpfk_supplier_lineitem_1#4933, cfpk_lineitem_supplier#4901 AS cfpk_lineitem_supplier_1#4934, cfpk_lineitem_partsupp#4902 AS cfpk_lineitem_partsupp_1#4935, cpfk_part_lineitem#4903 AS cpfk_part_lineitem_1#4936, cfpk_lineitem_part#4904 AS cfpk_lineitem_part_1#4937, cpfk_partsupp_lineitem#4905 AS cpfk_partsupp_lineitem_1#4938, cfpk_lineitem_orders#4906 AS cfpk_lineitem_orders_1#4939, cval_lineitem_l_quantity#4907 AS cval_lineitem_l_quantity_1#4940, cval_lineitem_l_extendedprice#4908 AS cval_lineitem_l_extendedprice_1#4941, cval_lineitem_l_discount#4909 AS cval_lineitem_l_discount_1#4942, cval_lineitem_l_tax#4910 AS cval_lineitem_l_tax_1#4943, cval_lineitem_l_returnflag#4911 AS cval_lineitem_l_returnflag_1#4944, cval_lineitem_l_linestatus#4912 AS cval_lineitem_l_linestatus_1#4945, cval_lineitem_l_commitdate#4913 AS cval_lineitem_l_commitdate_1#4946, cval_lineitem_l_receiptdate#4914 AS cval_lineitem_l_receiptdate_1#4947, cval_lineitem_l_shipinstruct#4915 AS cval_lineitem_l_shipinstruct_1#4948, cval_lineitem_l_shipmode#4916 AS cval_lineitem_l_shipmode_1#4949, cval_lineitem_l_comment#4917 AS cval_lineitem_l_comment_1#4950, cval_lineitem_l_shipdate#4918 AS cval_lineitem_l_shipdate_1#4951, cl_quantity#4919 AS cl_quantity_1#4952, cl_extendedprice#4920 AS cl_extendedprice_1#4953, cl_discount#4921 AS cl_discount_1#4954, ... 9 more fields]
            :  :  +- Relation[rid#4898,cpfk_orders_lineitem#4899,cpfk_supplier_lineitem#4900,cfpk_lineitem_supplier#4901,cfpk_lineitem_partsupp#4902,cpfk_part_lineitem#4903,cfpk_lineitem_part#4904,cpfk_partsupp_lineitem#4905,cfpk_lineitem_orders#4906,cval_lineitem_l_quantity#4907,cval_lineitem_l_extendedprice#4908,cval_lineitem_l_discount#4909,cval_lineitem_l_tax#4910,cval_lineitem_l_returnflag#4911,cval_lineitem_l_linestatus#4912,cval_lineitem_l_commitdate#4913,cval_lineitem_l_receiptdate#4914,cval_lineitem_l_shipinstruct#4915,cval_lineitem_l_shipmode#4916,cval_lineitem_l_comment#4917,cval_lineitem_l_shipdate#4918,cl_quantity#4919,cl_extendedprice#4920,cl_discount#4921,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#4964 AS rid_1#4997, cpfk_orders_lineitem#4965 AS cpfk_orders_lineitem_1#4998, cpfk_supplier_lineitem#4966 AS cpfk_supplier_lineitem_1#4999, cfpk_lineitem_supplier#4967 AS cfpk_lineitem_supplier_1#5000, cfpk_lineitem_partsupp#4968 AS cfpk_lineitem_partsupp_1#5001, cpfk_part_lineitem#4969 AS cpfk_part_lineitem_1#5002, cfpk_lineitem_part#4970 AS cfpk_lineitem_part_1#5003, cpfk_partsupp_lineitem#4971 AS cpfk_partsupp_lineitem_1#5004, cfpk_lineitem_orders#4972 AS cfpk_lineitem_orders_1#5005, cval_lineitem_l_quantity#4973 AS cval_lineitem_l_quantity_1#5006, cval_lineitem_l_extendedprice#4974 AS cval_lineitem_l_extendedprice_1#5007, cval_lineitem_l_discount#4975 AS cval_lineitem_l_discount_1#5008, cval_lineitem_l_tax#4976 AS cval_lineitem_l_tax_1#5009, cval_lineitem_l_returnflag#4977 AS cval_lineitem_l_returnflag_1#5010, cval_lineitem_l_linestatus#4978 AS cval_lineitem_l_linestatus_1#5011, cval_lineitem_l_commitdate#4979 AS cval_lineitem_l_commitdate_1#5012, cval_lineitem_l_receiptdate#4980 AS cval_lineitem_l_receiptdate_1#5013, cval_lineitem_l_shipinstruct#4981 AS cval_lineitem_l_shipinstruct_1#5014, cval_lineitem_l_shipmode#4982 AS cval_lineitem_l_shipmode_1#5015, cval_lineitem_l_comment#4983 AS cval_lineitem_l_comment_1#5016, cval_lineitem_l_shipdate#4984 AS cval_lineitem_l_shipdate_1#5017, cl_quantity#4985 AS cl_quantity_1#5018, cl_extendedprice#4986 AS cl_extendedprice_1#5019, cl_discount#4987 AS cl_discount_1#5020, ... 9 more fields]
            :        +- Relation[rid#4964,cpfk_orders_lineitem#4965,cpfk_supplier_lineitem#4966,cfpk_lineitem_supplier#4967,cfpk_lineitem_partsupp#4968,cpfk_part_lineitem#4969,cfpk_lineitem_part#4970,cpfk_partsupp_lineitem#4971,cfpk_lineitem_orders#4972,cval_lineitem_l_quantity#4973,cval_lineitem_l_extendedprice#4974,cval_lineitem_l_discount#4975,cval_lineitem_l_tax#4976,cval_lineitem_l_returnflag#4977,cval_lineitem_l_linestatus#4978,cval_lineitem_l_commitdate#4979,cval_lineitem_l_receiptdate#4980,cval_lineitem_l_shipinstruct#4981,cval_lineitem_l_shipmode#4982,cval_lineitem_l_comment#4983,cval_lineitem_l_shipdate#4984,cl_quantity#4985,cl_extendedprice#4986,cl_discount#4987,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#5030 AS rid_1#5063, cpfk_orders_lineitem#5031 AS cpfk_orders_lineitem_1#5064, cpfk_supplier_lineitem#5032 AS cpfk_supplier_lineitem_1#5065, cfpk_lineitem_supplier#5033 AS cfpk_lineitem_supplier_1#5066, cfpk_lineitem_partsupp#5034 AS cfpk_lineitem_partsupp_1#5067, cpfk_part_lineitem#5035 AS cpfk_part_lineitem_1#5068, cfpk_lineitem_part#5036 AS cfpk_lineitem_part_1#5069, cpfk_partsupp_lineitem#5037 AS cpfk_partsupp_lineitem_1#5070, cfpk_lineitem_orders#5038 AS cfpk_lineitem_orders_1#5071, cval_lineitem_l_quantity#5039 AS cval_lineitem_l_quantity_1#5072, cval_lineitem_l_extendedprice#5040 AS cval_lineitem_l_extendedprice_1#5073, cval_lineitem_l_discount#5041 AS cval_lineitem_l_discount_1#5074, cval_lineitem_l_tax#5042 AS cval_lineitem_l_tax_1#5075, cval_lineitem_l_returnflag#5043 AS cval_lineitem_l_returnflag_1#5076, cval_lineitem_l_linestatus#5044 AS cval_lineitem_l_linestatus_1#5077, cval_lineitem_l_commitdate#5045 AS cval_lineitem_l_commitdate_1#5078, cval_lineitem_l_receiptdate#5046 AS cval_lineitem_l_receiptdate_1#5079, cval_lineitem_l_shipinstruct#5047 AS cval_lineitem_l_shipinstruct_1#5080, cval_lineitem_l_shipmode#5048 AS cval_lineitem_l_shipmode_1#5081, cval_lineitem_l_comment#5049 AS cval_lineitem_l_comment_1#5082, cval_lineitem_l_shipdate#5050 AS cval_lineitem_l_shipdate_1#5083, cl_quantity#5051 AS cl_quantity_1#5084, cl_extendedprice#5052 AS cl_extendedprice_1#5085, cl_discount#5053 AS cl_discount_1#5086, ... 9 more fields]
                  +- Relation[rid#5030,cpfk_orders_lineitem#5031,cpfk_supplier_lineitem#5032,cfpk_lineitem_supplier#5033,cfpk_lineitem_partsupp#5034,cpfk_part_lineitem#5035,cfpk_lineitem_part#5036,cpfk_partsupp_lineitem#5037,cfpk_lineitem_orders#5038,cval_lineitem_l_quantity#5039,cval_lineitem_l_extendedprice#5040,cval_lineitem_l_discount#5041,cval_lineitem_l_tax#5042,cval_lineitem_l_returnflag#5043,cval_lineitem_l_linestatus#5044,cval_lineitem_l_commitdate#5045,cval_lineitem_l_receiptdate#5046,cval_lineitem_l_shipinstruct#5047,cval_lineitem_l_shipmode#5048,cval_lineitem_l_comment#5049,cval_lineitem_l_shipdate#5050,cl_quantity#5051,cl_extendedprice#5052,cl_discount#5053,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=13
Elapsed time: 63616ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/15 17:42:48 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:42:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5250L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 17:42:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5250L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#5252 AS rid_0#5269, cpfk_customer_orders#5253 AS cpfk_customer_orders_0#5270, cfpk_orders_customer#5254 AS cfpk_orders_customer_0#5271, cval_orders_o_orderstatus#5255 AS cval_orders_o_orderstatus_0#5272, cval_orders_o_totalprice#5256 AS cval_orders_o_totalprice_0#5273, cval_orders_o_orderpriority#5257 AS cval_orders_o_orderpriority_0#5274, cval_orders_o_clerk#5258 AS cval_orders_o_clerk_0#5275, cval_orders_o_shippriority#5259 AS cval_orders_o_shippriority_0#5276, cval_orders_o_comment#5260 AS cval_orders_o_comment_0#5277, cval_orders_o_orderdate#5261 AS cval_orders_o_orderdate_0#5278, co_orderstatus#5262 AS co_orderstatus_0#5279, co_totalprice#5263 AS co_totalprice_0#5280, co_orderpriority#5264 AS co_orderpriority_0#5281, co_clerk#5265 AS co_clerk_0#5282, co_shippriority#5266 AS co_shippriority_0#5283, co_comment#5267 AS co_comment_0#5284, co_orderdate#5268 AS co_orderdate_0#5285]
            :  +- Relation[rid#5252,cpfk_customer_orders#5253,cfpk_orders_customer#5254,cval_orders_o_orderstatus#5255,cval_orders_o_totalprice#5256,cval_orders_o_orderpriority#5257,cval_orders_o_clerk#5258,cval_orders_o_shippriority#5259,cval_orders_o_comment#5260,cval_orders_o_orderdate#5261,co_orderstatus#5262,co_totalprice#5263,co_orderpriority#5264,co_clerk#5265,co_shippriority#5266,co_comment#5267,co_orderdate#5268] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#5286 AS rid_1#5301, cpfk_nation_customer#5287 AS cpfk_nation_customer_1#5302, cfpk_customer_nation#5288 AS cfpk_customer_nation_1#5303, cval_customer_c_name#5289 AS cval_customer_c_name_1#5304, cval_customer_c_address#5290 AS cval_customer_c_address_1#5305, cval_customer_c_phone#5291 AS cval_customer_c_phone_1#5306, cval_customer_c_acctbal#5292 AS cval_customer_c_acctbal_1#5307, cval_customer_c_comment#5293 AS cval_customer_c_comment_1#5308, cval_customer_c_mktsegment#5294 AS cval_customer_c_mktsegment_1#5309, cc_name#5295 AS cc_name_1#5310, cc_address#5296 AS cc_address_1#5311, cc_phone#5297 AS cc_phone_1#5312, cc_acctbal#5298 AS cc_acctbal_1#5313, cc_comment#5299 AS cc_comment_1#5314, cc_mktsegment#5300 AS cc_mktsegment_1#5315]
               +- Relation[rid#5286,cpfk_nation_customer#5287,cfpk_customer_nation#5288,cval_customer_c_name#5289,cval_customer_c_address#5290,cval_customer_c_phone#5291,cval_customer_c_acctbal#5292,cval_customer_c_comment#5293,cval_customer_c_mktsegment#5294,cc_name#5295,cc_address#5296,cc_phone#5297,cc_acctbal#5298,cc_comment#5299,cc_mktsegment#5300] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 14102ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/15 17:43:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:43:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5355L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 17:43:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:43:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:43:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:43:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:43:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:43:02 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:43:02 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:43:02 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:43:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:43:02 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:43:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:43:02 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:43:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:43:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:43:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:43:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5355L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#5357 AS rid_0#5374, cval_part_p_name#5358 AS cval_part_p_name_0#5375, cval_part_p_mfgr#5359 AS cval_part_p_mfgr_0#5376, cval_part_p_type#5360 AS cval_part_p_type_0#5377, cval_part_p_size#5361 AS cval_part_p_size_0#5378, cval_part_p_container#5362 AS cval_part_p_container_0#5379, cval_part_p_retailprice#5363 AS cval_part_p_retailprice_0#5380, cval_part_p_comment#5364 AS cval_part_p_comment_0#5381, cval_part_p_brand#5365 AS cval_part_p_brand_0#5382, cp_name#5366 AS cp_name_0#5383, cp_mfgr#5367 AS cp_mfgr_0#5384, cp_type#5368 AS cp_type_0#5385, cp_size#5369 AS cp_size_0#5386, cp_container#5370 AS cp_container_0#5387, cp_retailprice#5371 AS cp_retailprice_0#5388, cp_comment#5372 AS cp_comment_0#5389, cp_brand#5373 AS cp_brand_0#5390]
            :     :     :  :  :  :  +- Relation[rid#5357,cval_part_p_name#5358,cval_part_p_mfgr#5359,cval_part_p_type#5360,cval_part_p_size#5361,cval_part_p_container#5362,cval_part_p_retailprice#5363,cval_part_p_comment#5364,cval_part_p_brand#5365,cp_name#5366,cp_mfgr#5367,cp_type#5368,cp_size#5369,cp_container#5370,cp_retailprice#5371,cp_comment#5372,cp_brand#5373] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#5391 AS rid_0#5408, cval_part_p_name#5392 AS cval_part_p_name_0#5409, cval_part_p_mfgr#5393 AS cval_part_p_mfgr_0#5410, cval_part_p_type#5394 AS cval_part_p_type_0#5411, cval_part_p_size#5395 AS cval_part_p_size_0#5412, cval_part_p_container#5396 AS cval_part_p_container_0#5413, cval_part_p_retailprice#5397 AS cval_part_p_retailprice_0#5414, cval_part_p_comment#5398 AS cval_part_p_comment_0#5415, cval_part_p_brand#5399 AS cval_part_p_brand_0#5416, cp_name#5400 AS cp_name_0#5417, cp_mfgr#5401 AS cp_mfgr_0#5418, cp_type#5402 AS cp_type_0#5419, cp_size#5403 AS cp_size_0#5420, cp_container#5404 AS cp_container_0#5421, cp_retailprice#5405 AS cp_retailprice_0#5422, cp_comment#5406 AS cp_comment_0#5423, cp_brand#5407 AS cp_brand_0#5424]
            :     :     :  :  :        +- Relation[rid#5391,cval_part_p_name#5392,cval_part_p_mfgr#5393,cval_part_p_type#5394,cval_part_p_size#5395,cval_part_p_container#5396,cval_part_p_retailprice#5397,cval_part_p_comment#5398,cval_part_p_brand#5399,cp_name#5400,cp_mfgr#5401,cp_type#5402,cp_size#5403,cp_container#5404,cp_retailprice#5405,cp_comment#5406,cp_brand#5407] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- Project [rid#5525 AS rid_1#5558, cpfk_orders_lineitem#5526 AS cpfk_orders_lineitem_1#5559, cpfk_supplier_lineitem#5527 AS cpfk_supplier_lineitem_1#5560, cfpk_lineitem_supplier#5528 AS cfpk_lineitem_supplier_1#5561, cfpk_lineitem_partsupp#5529 AS cfpk_lineitem_partsupp_1#5562, cpfk_part_lineitem#5530 AS cpfk_part_lineitem_1#5563, cfpk_lineitem_part#5531 AS cfpk_lineitem_part_1#5564, cpfk_partsupp_lineitem#5532 AS cpfk_partsupp_lineitem_1#5565, cfpk_lineitem_orders#5533 AS cfpk_lineitem_orders_1#5566, cval_lineitem_l_quantity#5534 AS cval_lineitem_l_quantity_1#5567, cval_lineitem_l_extendedprice#5535 AS cval_lineitem_l_extendedprice_1#5568, cval_lineitem_l_discount#5536 AS cval_lineitem_l_discount_1#5569, cval_lineitem_l_tax#5537 AS cval_lineitem_l_tax_1#5570, cval_lineitem_l_returnflag#5538 AS cval_lineitem_l_returnflag_1#5571, cval_lineitem_l_linestatus#5539 AS cval_lineitem_l_linestatus_1#5572, cval_lineitem_l_commitdate#5540 AS cval_lineitem_l_commitdate_1#5573, cval_lineitem_l_receiptdate#5541 AS cval_lineitem_l_receiptdate_1#5574, cval_lineitem_l_shipinstruct#5542 AS cval_lineitem_l_shipinstruct_1#5575, cval_lineitem_l_shipmode#5543 AS cval_lineitem_l_shipmode_1#5576, cval_lineitem_l_comment#5544 AS cval_lineitem_l_comment_1#5577, cval_lineitem_l_shipdate#5545 AS cval_lineitem_l_shipdate_1#5578, cl_quantity#5546 AS cl_quantity_1#5579, cl_extendedprice#5547 AS cl_extendedprice_1#5580, cl_discount#5548 AS cl_discount_1#5581, ... 9 more fields]
            :     :     :  :     +- Relation[rid#5525,cpfk_orders_lineitem#5526,cpfk_supplier_lineitem#5527,cfpk_lineitem_supplier#5528,cfpk_lineitem_partsupp#5529,cpfk_part_lineitem#5530,cfpk_lineitem_part#5531,cpfk_partsupp_lineitem#5532,cfpk_lineitem_orders#5533,cval_lineitem_l_quantity#5534,cval_lineitem_l_extendedprice#5535,cval_lineitem_l_discount#5536,cval_lineitem_l_tax#5537,cval_lineitem_l_returnflag#5538,cval_lineitem_l_linestatus#5539,cval_lineitem_l_commitdate#5540,cval_lineitem_l_receiptdate#5541,cval_lineitem_l_shipinstruct#5542,cval_lineitem_l_shipmode#5543,cval_lineitem_l_comment#5544,cval_lineitem_l_shipdate#5545,cl_quantity#5546,cl_extendedprice#5547,cl_discount#5548,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#5425 AS rid_1#5458, cpfk_orders_lineitem#5426 AS cpfk_orders_lineitem_1#5459, cpfk_supplier_lineitem#5427 AS cpfk_supplier_lineitem_1#5460, cfpk_lineitem_supplier#5428 AS cfpk_lineitem_supplier_1#5461, cfpk_lineitem_partsupp#5429 AS cfpk_lineitem_partsupp_1#5462, cpfk_part_lineitem#5430 AS cpfk_part_lineitem_1#5463, cfpk_lineitem_part#5431 AS cfpk_lineitem_part_1#5464, cpfk_partsupp_lineitem#5432 AS cpfk_partsupp_lineitem_1#5465, cfpk_lineitem_orders#5433 AS cfpk_lineitem_orders_1#5466, cval_lineitem_l_quantity#5434 AS cval_lineitem_l_quantity_1#5467, cval_lineitem_l_extendedprice#5435 AS cval_lineitem_l_extendedprice_1#5468, cval_lineitem_l_discount#5436 AS cval_lineitem_l_discount_1#5469, cval_lineitem_l_tax#5437 AS cval_lineitem_l_tax_1#5470, cval_lineitem_l_returnflag#5438 AS cval_lineitem_l_returnflag_1#5471, cval_lineitem_l_linestatus#5439 AS cval_lineitem_l_linestatus_1#5472, cval_lineitem_l_commitdate#5440 AS cval_lineitem_l_commitdate_1#5473, cval_lineitem_l_receiptdate#5441 AS cval_lineitem_l_receiptdate_1#5474, cval_lineitem_l_shipinstruct#5442 AS cval_lineitem_l_shipinstruct_1#5475, cval_lineitem_l_shipmode#5443 AS cval_lineitem_l_shipmode_1#5476, cval_lineitem_l_comment#5444 AS cval_lineitem_l_comment_1#5477, cval_lineitem_l_shipdate#5445 AS cval_lineitem_l_shipdate_1#5478, cl_quantity#5446 AS cl_quantity_1#5479, cl_extendedprice#5447 AS cl_extendedprice_1#5480, cl_discount#5448 AS cl_discount_1#5481, ... 9 more fields]
            :     :     :     +- Relation[rid#5425,cpfk_orders_lineitem#5426,cpfk_supplier_lineitem#5427,cfpk_lineitem_supplier#5428,cfpk_lineitem_partsupp#5429,cpfk_part_lineitem#5430,cfpk_lineitem_part#5431,cpfk_partsupp_lineitem#5432,cfpk_lineitem_orders#5433,cval_lineitem_l_quantity#5434,cval_lineitem_l_extendedprice#5435,cval_lineitem_l_discount#5436,cval_lineitem_l_tax#5437,cval_lineitem_l_returnflag#5438,cval_lineitem_l_linestatus#5439,cval_lineitem_l_commitdate#5440,cval_lineitem_l_receiptdate#5441,cval_lineitem_l_shipinstruct#5442,cval_lineitem_l_shipmode#5443,cval_lineitem_l_comment#5444,cval_lineitem_l_shipdate#5445,cl_quantity#5446,cl_extendedprice#5447,cl_discount#5448,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#5591 AS rid_2#5604, cpfk_nation_supplier#5592 AS cpfk_nation_supplier_2#5605, cfpk_supplier_nation#5593 AS cfpk_supplier_nation_2#5606, cval_supplier_s_name#5594 AS cval_supplier_s_name_2#5607, cval_supplier_s_address#5595 AS cval_supplier_s_address_2#5608, cval_supplier_s_phone#5596 AS cval_supplier_s_phone_2#5609, cval_supplier_s_acctbal#5597 AS cval_supplier_s_acctbal_2#5610, cval_supplier_s_comment#5598 AS cval_supplier_s_comment_2#5611, cs_name#5599 AS cs_name_2#5612, cs_address#5600 AS cs_address_2#5613, cs_phone#5601 AS cs_phone_2#5614, cs_acctbal#5602 AS cs_acctbal_2#5615, cs_comment#5603 AS cs_comment_2#5616]
            :     :        +- Relation[rid#5591,cpfk_nation_supplier#5592,cfpk_supplier_nation#5593,cval_supplier_s_name#5594,cval_supplier_s_address#5595,cval_supplier_s_phone#5596,cval_supplier_s_acctbal#5597,cval_supplier_s_comment#5598,cs_name#5599,cs_address#5600,cs_phone#5601,cs_acctbal#5602,cs_comment#5603] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#5617 AS rid_3#5624, cpfk_region_nation#5618 AS cpfk_region_nation_3#5625, cfpk_nation_region#5619 AS cfpk_nation_region_3#5626, cval_nation_n_name#5620 AS cval_nation_n_name_3#5627, cval_nation_n_comment#5621 AS cval_nation_n_comment_3#5628, cn_name#5622 AS cn_name_3#5629, cn_comment#5623 AS cn_comment_3#5630]
            :        +- Relation[rid#5617,cpfk_region_nation#5618,cfpk_nation_region#5619,cval_nation_n_name#5620,cval_nation_n_comment#5621,cn_name#5622,cn_comment#5623] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#5631 AS rid_4#5636, cval_region_r_name#5632 AS cval_region_r_name_4#5637, cval_region_r_comment#5633 AS cval_region_r_comment_4#5638, cr_name#5634 AS cr_name_4#5639, cr_comment#5635 AS cr_comment_4#5640]
               :  :  :  :  :  :  :  +- Relation[rid#5631,cval_region_r_name#5632,cval_region_r_comment#5633,cr_name#5634,cr_comment#5635] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#5641 AS rid_4#5646, cval_region_r_name#5642 AS cval_region_r_name_4#5647, cval_region_r_comment#5643 AS cval_region_r_comment_4#5648, cr_name#5644 AS cr_name_4#5649, cr_comment#5645 AS cr_comment_4#5650]
               :  :  :  :  :  :        +- Relation[rid#5641,cval_region_r_name#5642,cval_region_r_comment#5643,cr_name#5644,cr_comment#5645] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- Project [rid#5675 AS rid_5#5682, cpfk_region_nation#5676 AS cpfk_region_nation_5#5683, cfpk_nation_region#5677 AS cfpk_nation_region_5#5684, cval_nation_n_name#5678 AS cval_nation_n_name_5#5685, cval_nation_n_comment#5679 AS cval_nation_n_comment_5#5686, cn_name#5680 AS cn_name_5#5687, cn_comment#5681 AS cn_comment_5#5688]
               :  :  :  :  :     +- Relation[rid#5675,cpfk_region_nation#5676,cfpk_nation_region#5677,cval_nation_n_name#5678,cval_nation_n_comment#5679,cn_name#5680,cn_comment#5681] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#5651 AS rid_5#5658, cpfk_region_nation#5652 AS cpfk_region_nation_5#5659, cfpk_nation_region#5653 AS cfpk_nation_region_5#5660, cval_nation_n_name#5654 AS cval_nation_n_name_5#5661, cval_nation_n_comment#5655 AS cval_nation_n_comment_5#5662, cn_name#5656 AS cn_name_5#5663, cn_comment#5657 AS cn_comment_5#5664]
               :  :  :  :     +- Relation[rid#5651,cpfk_region_nation#5652,cfpk_nation_region#5653,cval_nation_n_name#5654,cval_nation_n_comment#5655,cn_name#5656,cn_comment#5657] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#5733 AS rid_6#5748, cpfk_nation_customer#5734 AS cpfk_nation_customer_6#5749, cfpk_customer_nation#5735 AS cfpk_customer_nation_6#5750, cval_customer_c_name#5736 AS cval_customer_c_name_6#5751, cval_customer_c_address#5737 AS cval_customer_c_address_6#5752, cval_customer_c_phone#5738 AS cval_customer_c_phone_6#5753, cval_customer_c_acctbal#5739 AS cval_customer_c_acctbal_6#5754, cval_customer_c_comment#5740 AS cval_customer_c_comment_6#5755, cval_customer_c_mktsegment#5741 AS cval_customer_c_mktsegment_6#5756, cc_name#5742 AS cc_name_6#5757, cc_address#5743 AS cc_address_6#5758, cc_phone#5744 AS cc_phone_6#5759, cc_acctbal#5745 AS cc_acctbal_6#5760, cc_comment#5746 AS cc_comment_6#5761, cc_mktsegment#5747 AS cc_mktsegment_6#5762]
               :  :  :     +- Relation[rid#5733,cpfk_nation_customer#5734,cfpk_customer_nation#5735,cval_customer_c_name#5736,cval_customer_c_address#5737,cval_customer_c_phone#5738,cval_customer_c_acctbal#5739,cval_customer_c_comment#5740,cval_customer_c_mktsegment#5741,cc_name#5742,cc_address#5743,cc_phone#5744,cc_acctbal#5745,cc_comment#5746,cc_mktsegment#5747] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#5689 AS rid_6#5704, cpfk_nation_customer#5690 AS cpfk_nation_customer_6#5705, cfpk_customer_nation#5691 AS cfpk_customer_nation_6#5706, cval_customer_c_name#5692 AS cval_customer_c_name_6#5707, cval_customer_c_address#5693 AS cval_customer_c_address_6#5708, cval_customer_c_phone#5694 AS cval_customer_c_phone_6#5709, cval_customer_c_acctbal#5695 AS cval_customer_c_acctbal_6#5710, cval_customer_c_comment#5696 AS cval_customer_c_comment_6#5711, cval_customer_c_mktsegment#5697 AS cval_customer_c_mktsegment_6#5712, cc_name#5698 AS cc_name_6#5713, cc_address#5699 AS cc_address_6#5714, cc_phone#5700 AS cc_phone_6#5715, cc_acctbal#5701 AS cc_acctbal_6#5716, cc_comment#5702 AS cc_comment_6#5717, cc_mktsegment#5703 AS cc_mktsegment_6#5718]
               :  :     +- Relation[rid#5689,cpfk_nation_customer#5690,cfpk_customer_nation#5691,cval_customer_c_name#5692,cval_customer_c_address#5693,cval_customer_c_phone#5694,cval_customer_c_acctbal#5695,cval_customer_c_comment#5696,cval_customer_c_mktsegment#5697,cc_name#5698,cc_address#5699,cc_phone#5700,cc_acctbal#5701,cc_comment#5702,cc_mktsegment#5703] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#5827 AS rid_7#5844, cpfk_customer_orders#5828 AS cpfk_customer_orders_7#5845, cfpk_orders_customer#5829 AS cfpk_orders_customer_7#5846, cval_orders_o_orderstatus#5830 AS cval_orders_o_orderstatus_7#5847, cval_orders_o_totalprice#5831 AS cval_orders_o_totalprice_7#5848, cval_orders_o_orderpriority#5832 AS cval_orders_o_orderpriority_7#5849, cval_orders_o_clerk#5833 AS cval_orders_o_clerk_7#5850, cval_orders_o_shippriority#5834 AS cval_orders_o_shippriority_7#5851, cval_orders_o_comment#5835 AS cval_orders_o_comment_7#5852, cval_orders_o_orderdate#5836 AS cval_orders_o_orderdate_7#5853, co_orderstatus#5837 AS co_orderstatus_7#5854, co_totalprice#5838 AS co_totalprice_7#5855, co_orderpriority#5839 AS co_orderpriority_7#5856, co_clerk#5840 AS co_clerk_7#5857, co_shippriority#5841 AS co_shippriority_7#5858, co_comment#5842 AS co_comment_7#5859, co_orderdate#5843 AS co_orderdate_7#5860]
               :     +- Relation[rid#5827,cpfk_customer_orders#5828,cfpk_orders_customer#5829,cval_orders_o_orderstatus#5830,cval_orders_o_totalprice#5831,cval_orders_o_orderpriority#5832,cval_orders_o_clerk#5833,cval_orders_o_shippriority#5834,cval_orders_o_comment#5835,cval_orders_o_orderdate#5836,co_orderstatus#5837,co_totalprice#5838,co_orderpriority#5839,co_clerk#5840,co_shippriority#5841,co_comment#5842,co_orderdate#5843] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#5763 AS rid_7#5780, cpfk_customer_orders#5764 AS cpfk_customer_orders_7#5781, cfpk_orders_customer#5765 AS cfpk_orders_customer_7#5782, cval_orders_o_orderstatus#5766 AS cval_orders_o_orderstatus_7#5783, cval_orders_o_totalprice#5767 AS cval_orders_o_totalprice_7#5784, cval_orders_o_orderpriority#5768 AS cval_orders_o_orderpriority_7#5785, cval_orders_o_clerk#5769 AS cval_orders_o_clerk_7#5786, cval_orders_o_shippriority#5770 AS cval_orders_o_shippriority_7#5787, cval_orders_o_comment#5771 AS cval_orders_o_comment_7#5788, cval_orders_o_orderdate#5772 AS cval_orders_o_orderdate_7#5789, co_orderstatus#5773 AS co_orderstatus_7#5790, co_totalprice#5774 AS co_totalprice_7#5791, co_orderpriority#5775 AS co_orderpriority_7#5792, co_clerk#5776 AS co_clerk_7#5793, co_shippriority#5777 AS co_shippriority_7#5794, co_comment#5778 AS co_comment_7#5795, co_orderdate#5779 AS co_orderdate_7#5796]
                  +- Relation[rid#5763,cpfk_customer_orders#5764,cfpk_orders_customer#5765,cval_orders_o_orderstatus#5766,cval_orders_o_totalprice#5767,cval_orders_o_orderpriority#5768,cval_orders_o_clerk#5769,cval_orders_o_shippriority#5770,cval_orders_o_comment#5771,cval_orders_o_orderdate#5772,co_orderstatus#5773,co_totalprice#5774,co_orderpriority#5775,co_clerk#5776,co_shippriority#5777,co_comment#5778,co_orderdate#5779] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 2107ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/15 17:43:04 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:43:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5980L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:43:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#5980L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#5982 AS rid_0#6015, cpfk_orders_lineitem#5983 AS cpfk_orders_lineitem_0#6016, cpfk_supplier_lineitem#5984 AS cpfk_supplier_lineitem_0#6017, cfpk_lineitem_supplier#5985 AS cfpk_lineitem_supplier_0#6018, cfpk_lineitem_partsupp#5986 AS cfpk_lineitem_partsupp_0#6019, cpfk_part_lineitem#5987 AS cpfk_part_lineitem_0#6020, cfpk_lineitem_part#5988 AS cfpk_lineitem_part_0#6021, cpfk_partsupp_lineitem#5989 AS cpfk_partsupp_lineitem_0#6022, cfpk_lineitem_orders#5990 AS cfpk_lineitem_orders_0#6023, cval_lineitem_l_quantity#5991 AS cval_lineitem_l_quantity_0#6024, cval_lineitem_l_extendedprice#5992 AS cval_lineitem_l_extendedprice_0#6025, cval_lineitem_l_discount#5993 AS cval_lineitem_l_discount_0#6026, cval_lineitem_l_tax#5994 AS cval_lineitem_l_tax_0#6027, cval_lineitem_l_returnflag#5995 AS cval_lineitem_l_returnflag_0#6028, cval_lineitem_l_linestatus#5996 AS cval_lineitem_l_linestatus_0#6029, cval_lineitem_l_commitdate#5997 AS cval_lineitem_l_commitdate_0#6030, cval_lineitem_l_receiptdate#5998 AS cval_lineitem_l_receiptdate_0#6031, cval_lineitem_l_shipinstruct#5999 AS cval_lineitem_l_shipinstruct_0#6032, cval_lineitem_l_shipmode#6000 AS cval_lineitem_l_shipmode_0#6033, cval_lineitem_l_comment#6001 AS cval_lineitem_l_comment_0#6034, cval_lineitem_l_shipdate#6002 AS cval_lineitem_l_shipdate_0#6035, cl_quantity#6003 AS cl_quantity_0#6036, cl_extendedprice#6004 AS cl_extendedprice_0#6037, cl_discount#6005 AS cl_discount_0#6038, ... 9 more fields]
         +- Relation[rid#5982,cpfk_orders_lineitem#5983,cpfk_supplier_lineitem#5984,cfpk_lineitem_supplier#5985,cfpk_lineitem_partsupp#5986,cpfk_part_lineitem#5987,cfpk_lineitem_part#5988,cpfk_partsupp_lineitem#5989,cfpk_lineitem_orders#5990,cval_lineitem_l_quantity#5991,cval_lineitem_l_extendedprice#5992,cval_lineitem_l_discount#5993,cval_lineitem_l_tax#5994,cval_lineitem_l_returnflag#5995,cval_lineitem_l_linestatus#5996,cval_lineitem_l_commitdate#5997,cval_lineitem_l_receiptdate#5998,cval_lineitem_l_shipinstruct#5999,cval_lineitem_l_shipmode#6000,cval_lineitem_l_comment#6001,cval_lineitem_l_shipdate#6002,cl_quantity#6003,cl_extendedprice#6004,cl_discount#6005,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2868ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/15 17:43:07 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:43:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6086L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 17:43:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6086L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#6088 AS rid_0#6105, cpfk_customer_orders#6089 AS cpfk_customer_orders_0#6106, cfpk_orders_customer#6090 AS cfpk_orders_customer_0#6107, cval_orders_o_orderstatus#6091 AS cval_orders_o_orderstatus_0#6108, cval_orders_o_totalprice#6092 AS cval_orders_o_totalprice_0#6109, cval_orders_o_orderpriority#6093 AS cval_orders_o_orderpriority_0#6110, cval_orders_o_clerk#6094 AS cval_orders_o_clerk_0#6111, cval_orders_o_shippriority#6095 AS cval_orders_o_shippriority_0#6112, cval_orders_o_comment#6096 AS cval_orders_o_comment_0#6113, cval_orders_o_orderdate#6097 AS cval_orders_o_orderdate_0#6114, co_orderstatus#6098 AS co_orderstatus_0#6115, co_totalprice#6099 AS co_totalprice_0#6116, co_orderpriority#6100 AS co_orderpriority_0#6117, co_clerk#6101 AS co_clerk_0#6118, co_shippriority#6102 AS co_shippriority_0#6119, co_comment#6103 AS co_comment_0#6120, co_orderdate#6104 AS co_orderdate_0#6121]
            :  +- Relation[rid#6088,cpfk_customer_orders#6089,cfpk_orders_customer#6090,cval_orders_o_orderstatus#6091,cval_orders_o_totalprice#6092,cval_orders_o_orderpriority#6093,cval_orders_o_clerk#6094,cval_orders_o_shippriority#6095,cval_orders_o_comment#6096,cval_orders_o_orderdate#6097,co_orderstatus#6098,co_totalprice#6099,co_orderpriority#6100,co_clerk#6101,co_shippriority#6102,co_comment#6103,co_orderdate#6104] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#6122 AS rid_1#6137, cpfk_nation_customer#6123 AS cpfk_nation_customer_1#6138, cfpk_customer_nation#6124 AS cfpk_customer_nation_1#6139, cval_customer_c_name#6125 AS cval_customer_c_name_1#6140, cval_customer_c_address#6126 AS cval_customer_c_address_1#6141, cval_customer_c_phone#6127 AS cval_customer_c_phone_1#6142, cval_customer_c_acctbal#6128 AS cval_customer_c_acctbal_1#6143, cval_customer_c_comment#6129 AS cval_customer_c_comment_1#6144, cval_customer_c_mktsegment#6130 AS cval_customer_c_mktsegment_1#6145, cc_name#6131 AS cc_name_1#6146, cc_address#6132 AS cc_address_1#6147, cc_phone#6133 AS cc_phone_1#6148, cc_acctbal#6134 AS cc_acctbal_1#6149, cc_comment#6135 AS cc_comment_1#6150, cc_mktsegment#6136 AS cc_mktsegment_1#6151]
               +- Relation[rid#6122,cpfk_nation_customer#6123,cfpk_customer_nation#6124,cval_customer_c_name#6125,cval_customer_c_address#6126,cval_customer_c_phone#6127,cval_customer_c_acctbal#6128,cval_customer_c_comment#6129,cval_customer_c_mktsegment#6130,cc_name#6131,cc_address#6132,cc_phone#6133,cc_acctbal#6134,cc_comment#6135,cc_mktsegment#6136] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13725ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 17:43:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:43:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6193L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 17:43:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:43:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:43:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:43:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:43:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:43:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:43:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:43:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:43:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:43:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:43:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:43:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:43:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:43:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:43:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:43:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:43:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6193L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#6195 AS rid_0#6202, cpfk_region_nation#6196 AS cpfk_region_nation_0#6203, cfpk_nation_region#6197 AS cfpk_nation_region_0#6204, cval_nation_n_name#6198 AS cval_nation_n_name_0#6205, cval_nation_n_comment#6199 AS cval_nation_n_comment_0#6206, cn_name#6200 AS cn_name_0#6207, cn_comment#6201 AS cn_comment_0#6208]
            :  :  :     :  :  :  :  :  +- Relation[rid#6195,cpfk_region_nation#6196,cfpk_nation_region#6197,cval_nation_n_name#6198,cval_nation_n_comment#6199,cn_name#6200,cn_comment#6201] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#6235 AS rid_0#6242, cpfk_region_nation#6236 AS cpfk_region_nation_0#6243, cfpk_nation_region#6237 AS cfpk_nation_region_0#6244, cval_nation_n_name#6238 AS cval_nation_n_name_0#6245, cval_nation_n_comment#6239 AS cval_nation_n_comment_0#6246, cn_name#6240 AS cn_name_0#6247, cn_comment#6241 AS cn_comment_0#6248]
            :  :  :     :  :  :  :     :  +- Relation[rid#6235,cpfk_region_nation#6236,cfpk_nation_region#6237,cval_nation_n_name#6238,cval_nation_n_comment#6239,cn_name#6240,cn_comment#6241] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#6249 AS rid_1#6262, cpfk_nation_supplier#6250 AS cpfk_nation_supplier_1#6263, cfpk_supplier_nation#6251 AS cfpk_supplier_nation_1#6264, cval_supplier_s_name#6252 AS cval_supplier_s_name_1#6265, cval_supplier_s_address#6253 AS cval_supplier_s_address_1#6266, cval_supplier_s_phone#6254 AS cval_supplier_s_phone_1#6267, cval_supplier_s_acctbal#6255 AS cval_supplier_s_acctbal_1#6268, cval_supplier_s_comment#6256 AS cval_supplier_s_comment_1#6269, cs_name#6257 AS cs_name_1#6270, cs_address#6258 AS cs_address_1#6271, cs_phone#6259 AS cs_phone_1#6272, cs_acctbal#6260 AS cs_acctbal_1#6273, cs_comment#6261 AS cs_comment_1#6274]
            :  :  :     :  :  :  :        +- Relation[rid#6249,cpfk_nation_supplier#6250,cfpk_supplier_nation#6251,cval_supplier_s_name#6252,cval_supplier_s_address#6253,cval_supplier_s_phone#6254,cval_supplier_s_acctbal#6255,cval_supplier_s_comment#6256,cs_name#6257,cs_address#6258,cs_phone#6259,cs_acctbal#6260,cs_comment#6261] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#6209 AS rid_1#6222, cpfk_nation_supplier#6210 AS cpfk_nation_supplier_1#6223, cfpk_supplier_nation#6211 AS cfpk_supplier_nation_1#6224, cval_supplier_s_name#6212 AS cval_supplier_s_name_1#6225, cval_supplier_s_address#6213 AS cval_supplier_s_address_1#6226, cval_supplier_s_phone#6214 AS cval_supplier_s_phone_1#6227, cval_supplier_s_acctbal#6215 AS cval_supplier_s_acctbal_1#6228, cval_supplier_s_comment#6216 AS cval_supplier_s_comment_1#6229, cs_name#6217 AS cs_name_1#6230, cs_address#6218 AS cs_address_1#6231, cs_phone#6219 AS cs_phone_1#6232, cs_acctbal#6220 AS cs_acctbal_1#6233, cs_comment#6221 AS cs_comment_1#6234]
            :  :  :     :  :  :     +- Relation[rid#6209,cpfk_nation_supplier#6210,cfpk_supplier_nation#6211,cval_supplier_s_name#6212,cval_supplier_s_address#6213,cval_supplier_s_phone#6214,cval_supplier_s_acctbal#6215,cval_supplier_s_comment#6216,cs_name#6217,cs_address#6218,cs_phone#6219,cs_acctbal#6220,cs_comment#6221] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#6297 AS rid_1#6310, cpfk_nation_supplier#6298 AS cpfk_nation_supplier_1#6311, cfpk_supplier_nation#6299 AS cfpk_supplier_nation_1#6312, cval_supplier_s_name#6300 AS cval_supplier_s_name_1#6313, cval_supplier_s_address#6301 AS cval_supplier_s_address_1#6314, cval_supplier_s_phone#6302 AS cval_supplier_s_phone_1#6315, cval_supplier_s_acctbal#6303 AS cval_supplier_s_acctbal_1#6316, cval_supplier_s_comment#6304 AS cval_supplier_s_comment_1#6317, cs_name#6305 AS cs_name_1#6318, cs_address#6306 AS cs_address_1#6319, cs_phone#6307 AS cs_phone_1#6320, cs_acctbal#6308 AS cs_acctbal_1#6321, cs_comment#6309 AS cs_comment_1#6322]
            :  :  :     :  :     :  +- Relation[rid#6297,cpfk_nation_supplier#6298,cfpk_supplier_nation#6299,cval_supplier_s_name#6300,cval_supplier_s_address#6301,cval_supplier_s_phone#6302,cval_supplier_s_acctbal#6303,cval_supplier_s_comment#6304,cs_name#6305,cs_address#6306,cs_phone#6307,cs_acctbal#6308,cs_comment#6309] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#6323 AS rid_2#6334, cpfk_part_partsupp#6324 AS cpfk_part_partsupp_2#6335, cfpk_partsupp_part#6325 AS cfpk_partsupp_part_2#6336, cpfk_supplier_partsupp#6326 AS cpfk_supplier_partsupp_2#6337, cfpk_partsupp_supplier#6327 AS cfpk_partsupp_supplier_2#6338, cval_partsupp_ps_availqty#6328 AS cval_partsupp_ps_availqty_2#6339, cval_partsupp_ps_supplycost#6329 AS cval_partsupp_ps_supplycost_2#6340, cval_partsupp_ps_comment#6330 AS cval_partsupp_ps_comment_2#6341, cps_availqty#6331 AS cps_availqty_2#6342, cps_supplycost#6332 AS cps_supplycost_2#6343, cps_comment#6333 AS cps_comment_2#6344]
            :  :  :     :  :        +- Relation[rid#6323,cpfk_part_partsupp#6324,cfpk_partsupp_part#6325,cpfk_supplier_partsupp#6326,cfpk_partsupp_supplier#6327,cval_partsupp_ps_availqty#6328,cval_partsupp_ps_supplycost#6329,cval_partsupp_ps_comment#6330,cps_availqty#6331,cps_supplycost#6332,cps_comment#6333] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#6275 AS rid_2#6286, cpfk_part_partsupp#6276 AS cpfk_part_partsupp_2#6287, cfpk_partsupp_part#6277 AS cfpk_partsupp_part_2#6288, cpfk_supplier_partsupp#6278 AS cpfk_supplier_partsupp_2#6289, cfpk_partsupp_supplier#6279 AS cfpk_partsupp_supplier_2#6290, cval_partsupp_ps_availqty#6280 AS cval_partsupp_ps_availqty_2#6291, cval_partsupp_ps_supplycost#6281 AS cval_partsupp_ps_supplycost_2#6292, cval_partsupp_ps_comment#6282 AS cval_partsupp_ps_comment_2#6293, cps_availqty#6283 AS cps_availqty_2#6294, cps_supplycost#6284 AS cps_supplycost_2#6295, cps_comment#6285 AS cps_comment_2#6296]
            :  :  :     :     +- Relation[rid#6275,cpfk_part_partsupp#6276,cfpk_partsupp_part#6277,cpfk_supplier_partsupp#6278,cfpk_partsupp_supplier#6279,cval_partsupp_ps_availqty#6280,cval_partsupp_ps_supplycost#6281,cval_partsupp_ps_comment#6282,cps_availqty#6283,cps_supplycost#6284,cps_comment#6285] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#6345 AS rid_3#6362, cval_part_p_name#6346 AS cval_part_p_name_3#6363, cval_part_p_mfgr#6347 AS cval_part_p_mfgr_3#6364, cval_part_p_type#6348 AS cval_part_p_type_3#6365, cval_part_p_size#6349 AS cval_part_p_size_3#6366, cval_part_p_container#6350 AS cval_part_p_container_3#6367, cval_part_p_retailprice#6351 AS cval_part_p_retailprice_3#6368, cval_part_p_comment#6352 AS cval_part_p_comment_3#6369, cval_part_p_brand#6353 AS cval_part_p_brand_3#6370, cp_name#6354 AS cp_name_3#6371, cp_mfgr#6355 AS cp_mfgr_3#6372, cp_type#6356 AS cp_type_3#6373, cp_size#6357 AS cp_size_3#6374, cp_container#6358 AS cp_container_3#6375, cp_retailprice#6359 AS cp_retailprice_3#6376, cp_comment#6360 AS cp_comment_3#6377, cp_brand#6361 AS cp_brand_3#6378]
            :  :  :        +- Relation[rid#6345,cval_part_p_name#6346,cval_part_p_mfgr#6347,cval_part_p_type#6348,cval_part_p_size#6349,cval_part_p_container#6350,cval_part_p_retailprice#6351,cval_part_p_comment#6352,cval_part_p_brand#6353,cp_name#6354,cp_mfgr#6355,cp_type#6356,cp_size#6357,cp_container#6358,cp_retailprice#6359,cp_comment#6360,cp_brand#6361] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#6445 AS rid_2#6456, cpfk_part_partsupp#6446 AS cpfk_part_partsupp_2#6457, cfpk_partsupp_part#6447 AS cfpk_partsupp_part_2#6458, cpfk_supplier_partsupp#6448 AS cpfk_supplier_partsupp_2#6459, cfpk_partsupp_supplier#6449 AS cfpk_partsupp_supplier_2#6460, cval_partsupp_ps_availqty#6450 AS cval_partsupp_ps_availqty_2#6461, cval_partsupp_ps_supplycost#6451 AS cval_partsupp_ps_supplycost_2#6462, cval_partsupp_ps_comment#6452 AS cval_partsupp_ps_comment_2#6463, cps_availqty#6453 AS cps_availqty_2#6464, cps_supplycost#6454 AS cps_supplycost_2#6465, cps_comment#6455 AS cps_comment_2#6466]
            :  :     :  +- Relation[rid#6445,cpfk_part_partsupp#6446,cfpk_partsupp_part#6447,cpfk_supplier_partsupp#6448,cfpk_partsupp_supplier#6449,cval_partsupp_ps_availqty#6450,cval_partsupp_ps_supplycost#6451,cval_partsupp_ps_comment#6452,cps_availqty#6453,cps_supplycost#6454,cps_comment#6455] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#6467 AS rid_4#6500, cpfk_orders_lineitem#6468 AS cpfk_orders_lineitem_4#6501, cpfk_supplier_lineitem#6469 AS cpfk_supplier_lineitem_4#6502, cfpk_lineitem_supplier#6470 AS cfpk_lineitem_supplier_4#6503, cfpk_lineitem_partsupp#6471 AS cfpk_lineitem_partsupp_4#6504, cpfk_part_lineitem#6472 AS cpfk_part_lineitem_4#6505, cfpk_lineitem_part#6473 AS cfpk_lineitem_part_4#6506, cpfk_partsupp_lineitem#6474 AS cpfk_partsupp_lineitem_4#6507, cfpk_lineitem_orders#6475 AS cfpk_lineitem_orders_4#6508, cval_lineitem_l_quantity#6476 AS cval_lineitem_l_quantity_4#6509, cval_lineitem_l_extendedprice#6477 AS cval_lineitem_l_extendedprice_4#6510, cval_lineitem_l_discount#6478 AS cval_lineitem_l_discount_4#6511, cval_lineitem_l_tax#6479 AS cval_lineitem_l_tax_4#6512, cval_lineitem_l_returnflag#6480 AS cval_lineitem_l_returnflag_4#6513, cval_lineitem_l_linestatus#6481 AS cval_lineitem_l_linestatus_4#6514, cval_lineitem_l_commitdate#6482 AS cval_lineitem_l_commitdate_4#6515, cval_lineitem_l_receiptdate#6483 AS cval_lineitem_l_receiptdate_4#6516, cval_lineitem_l_shipinstruct#6484 AS cval_lineitem_l_shipinstruct_4#6517, cval_lineitem_l_shipmode#6485 AS cval_lineitem_l_shipmode_4#6518, cval_lineitem_l_comment#6486 AS cval_lineitem_l_comment_4#6519, cval_lineitem_l_shipdate#6487 AS cval_lineitem_l_shipdate_4#6520, cl_quantity#6488 AS cl_quantity_4#6521, cl_extendedprice#6489 AS cl_extendedprice_4#6522, cl_discount#6490 AS cl_discount_4#6523, ... 9 more fields]
            :  :        +- Relation[rid#6467,cpfk_orders_lineitem#6468,cpfk_supplier_lineitem#6469,cfpk_lineitem_supplier#6470,cfpk_lineitem_partsupp#6471,cpfk_part_lineitem#6472,cfpk_lineitem_part#6473,cpfk_partsupp_lineitem#6474,cfpk_lineitem_orders#6475,cval_lineitem_l_quantity#6476,cval_lineitem_l_extendedprice#6477,cval_lineitem_l_discount#6478,cval_lineitem_l_tax#6479,cval_lineitem_l_returnflag#6480,cval_lineitem_l_linestatus#6481,cval_lineitem_l_commitdate#6482,cval_lineitem_l_receiptdate#6483,cval_lineitem_l_shipinstruct#6484,cval_lineitem_l_shipmode#6485,cval_lineitem_l_comment#6486,cval_lineitem_l_shipdate#6487,cl_quantity#6488,cl_extendedprice#6489,cl_discount#6490,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#6379 AS rid_4#6412, cpfk_orders_lineitem#6380 AS cpfk_orders_lineitem_4#6413, cpfk_supplier_lineitem#6381 AS cpfk_supplier_lineitem_4#6414, cfpk_lineitem_supplier#6382 AS cfpk_lineitem_supplier_4#6415, cfpk_lineitem_partsupp#6383 AS cfpk_lineitem_partsupp_4#6416, cpfk_part_lineitem#6384 AS cpfk_part_lineitem_4#6417, cfpk_lineitem_part#6385 AS cfpk_lineitem_part_4#6418, cpfk_partsupp_lineitem#6386 AS cpfk_partsupp_lineitem_4#6419, cfpk_lineitem_orders#6387 AS cfpk_lineitem_orders_4#6420, cval_lineitem_l_quantity#6388 AS cval_lineitem_l_quantity_4#6421, cval_lineitem_l_extendedprice#6389 AS cval_lineitem_l_extendedprice_4#6422, cval_lineitem_l_discount#6390 AS cval_lineitem_l_discount_4#6423, cval_lineitem_l_tax#6391 AS cval_lineitem_l_tax_4#6424, cval_lineitem_l_returnflag#6392 AS cval_lineitem_l_returnflag_4#6425, cval_lineitem_l_linestatus#6393 AS cval_lineitem_l_linestatus_4#6426, cval_lineitem_l_commitdate#6394 AS cval_lineitem_l_commitdate_4#6427, cval_lineitem_l_receiptdate#6395 AS cval_lineitem_l_receiptdate_4#6428, cval_lineitem_l_shipinstruct#6396 AS cval_lineitem_l_shipinstruct_4#6429, cval_lineitem_l_shipmode#6397 AS cval_lineitem_l_shipmode_4#6430, cval_lineitem_l_comment#6398 AS cval_lineitem_l_comment_4#6431, cval_lineitem_l_shipdate#6399 AS cval_lineitem_l_shipdate_4#6432, cl_quantity#6400 AS cl_quantity_4#6433, cl_extendedprice#6401 AS cl_extendedprice_4#6434, cl_discount#6402 AS cl_discount_4#6435, ... 9 more fields]
            :     +- Relation[rid#6379,cpfk_orders_lineitem#6380,cpfk_supplier_lineitem#6381,cfpk_lineitem_supplier#6382,cfpk_lineitem_partsupp#6383,cpfk_part_lineitem#6384,cfpk_lineitem_part#6385,cpfk_partsupp_lineitem#6386,cfpk_lineitem_orders#6387,cval_lineitem_l_quantity#6388,cval_lineitem_l_extendedprice#6389,cval_lineitem_l_discount#6390,cval_lineitem_l_tax#6391,cval_lineitem_l_returnflag#6392,cval_lineitem_l_linestatus#6393,cval_lineitem_l_commitdate#6394,cval_lineitem_l_receiptdate#6395,cval_lineitem_l_shipinstruct#6396,cval_lineitem_l_shipmode#6397,cval_lineitem_l_comment#6398,cval_lineitem_l_shipdate#6399,cl_quantity#6400,cl_extendedprice#6401,cl_discount#6402,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#6533 AS rid_5#6550, cpfk_customer_orders#6534 AS cpfk_customer_orders_5#6551, cfpk_orders_customer#6535 AS cfpk_orders_customer_5#6552, cval_orders_o_orderstatus#6536 AS cval_orders_o_orderstatus_5#6553, cval_orders_o_totalprice#6537 AS cval_orders_o_totalprice_5#6554, cval_orders_o_orderpriority#6538 AS cval_orders_o_orderpriority_5#6555, cval_orders_o_clerk#6539 AS cval_orders_o_clerk_5#6556, cval_orders_o_shippriority#6540 AS cval_orders_o_shippriority_5#6557, cval_orders_o_comment#6541 AS cval_orders_o_comment_5#6558, cval_orders_o_orderdate#6542 AS cval_orders_o_orderdate_5#6559, co_orderstatus#6543 AS co_orderstatus_5#6560, co_totalprice#6544 AS co_totalprice_5#6561, co_orderpriority#6545 AS co_orderpriority_5#6562, co_clerk#6546 AS co_clerk_5#6563, co_shippriority#6547 AS co_shippriority_5#6564, co_comment#6548 AS co_comment_5#6565, co_orderdate#6549 AS co_orderdate_5#6566]
               +- Relation[rid#6533,cpfk_customer_orders#6534,cfpk_orders_customer#6535,cval_orders_o_orderstatus#6536,cval_orders_o_totalprice#6537,cval_orders_o_orderpriority#6538,cval_orders_o_clerk#6539,cval_orders_o_shippriority#6540,cval_orders_o_comment#6541,cval_orders_o_orderdate#6542,co_orderstatus#6543,co_totalprice#6544,co_orderpriority#6545,co_clerk#6546,co_shippriority#6547,co_comment#6548,co_orderdate#6549] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 187871ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/15 17:46:28 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:46:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6669L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 17:46:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6669L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#6671 AS rid_0#6704, cpfk_orders_lineitem#6672 AS cpfk_orders_lineitem_0#6705, cpfk_supplier_lineitem#6673 AS cpfk_supplier_lineitem_0#6706, cfpk_lineitem_supplier#6674 AS cfpk_lineitem_supplier_0#6707, cfpk_lineitem_partsupp#6675 AS cfpk_lineitem_partsupp_0#6708, cpfk_part_lineitem#6676 AS cpfk_part_lineitem_0#6709, cfpk_lineitem_part#6677 AS cfpk_lineitem_part_0#6710, cpfk_partsupp_lineitem#6678 AS cpfk_partsupp_lineitem_0#6711, cfpk_lineitem_orders#6679 AS cfpk_lineitem_orders_0#6712, cval_lineitem_l_quantity#6680 AS cval_lineitem_l_quantity_0#6713, cval_lineitem_l_extendedprice#6681 AS cval_lineitem_l_extendedprice_0#6714, cval_lineitem_l_discount#6682 AS cval_lineitem_l_discount_0#6715, cval_lineitem_l_tax#6683 AS cval_lineitem_l_tax_0#6716, cval_lineitem_l_returnflag#6684 AS cval_lineitem_l_returnflag_0#6717, cval_lineitem_l_linestatus#6685 AS cval_lineitem_l_linestatus_0#6718, cval_lineitem_l_commitdate#6686 AS cval_lineitem_l_commitdate_0#6719, cval_lineitem_l_receiptdate#6687 AS cval_lineitem_l_receiptdate_0#6720, cval_lineitem_l_shipinstruct#6688 AS cval_lineitem_l_shipinstruct_0#6721, cval_lineitem_l_shipmode#6689 AS cval_lineitem_l_shipmode_0#6722, cval_lineitem_l_comment#6690 AS cval_lineitem_l_comment_0#6723, cval_lineitem_l_shipdate#6691 AS cval_lineitem_l_shipdate_0#6724, cl_quantity#6692 AS cl_quantity_0#6725, cl_extendedprice#6693 AS cl_extendedprice_0#6726, cl_discount#6694 AS cl_discount_0#6727, ... 9 more fields]
            :  :  +- Relation[rid#6671,cpfk_orders_lineitem#6672,cpfk_supplier_lineitem#6673,cfpk_lineitem_supplier#6674,cfpk_lineitem_partsupp#6675,cpfk_part_lineitem#6676,cfpk_lineitem_part#6677,cpfk_partsupp_lineitem#6678,cfpk_lineitem_orders#6679,cval_lineitem_l_quantity#6680,cval_lineitem_l_extendedprice#6681,cval_lineitem_l_discount#6682,cval_lineitem_l_tax#6683,cval_lineitem_l_returnflag#6684,cval_lineitem_l_linestatus#6685,cval_lineitem_l_commitdate#6686,cval_lineitem_l_receiptdate#6687,cval_lineitem_l_shipinstruct#6688,cval_lineitem_l_shipmode#6689,cval_lineitem_l_comment#6690,cval_lineitem_l_shipdate#6691,cl_quantity#6692,cl_extendedprice#6693,cl_discount#6694,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#6737 AS rid_0#6770, cpfk_orders_lineitem#6738 AS cpfk_orders_lineitem_0#6771, cpfk_supplier_lineitem#6739 AS cpfk_supplier_lineitem_0#6772, cfpk_lineitem_supplier#6740 AS cfpk_lineitem_supplier_0#6773, cfpk_lineitem_partsupp#6741 AS cfpk_lineitem_partsupp_0#6774, cpfk_part_lineitem#6742 AS cpfk_part_lineitem_0#6775, cfpk_lineitem_part#6743 AS cfpk_lineitem_part_0#6776, cpfk_partsupp_lineitem#6744 AS cpfk_partsupp_lineitem_0#6777, cfpk_lineitem_orders#6745 AS cfpk_lineitem_orders_0#6778, cval_lineitem_l_quantity#6746 AS cval_lineitem_l_quantity_0#6779, cval_lineitem_l_extendedprice#6747 AS cval_lineitem_l_extendedprice_0#6780, cval_lineitem_l_discount#6748 AS cval_lineitem_l_discount_0#6781, cval_lineitem_l_tax#6749 AS cval_lineitem_l_tax_0#6782, cval_lineitem_l_returnflag#6750 AS cval_lineitem_l_returnflag_0#6783, cval_lineitem_l_linestatus#6751 AS cval_lineitem_l_linestatus_0#6784, cval_lineitem_l_commitdate#6752 AS cval_lineitem_l_commitdate_0#6785, cval_lineitem_l_receiptdate#6753 AS cval_lineitem_l_receiptdate_0#6786, cval_lineitem_l_shipinstruct#6754 AS cval_lineitem_l_shipinstruct_0#6787, cval_lineitem_l_shipmode#6755 AS cval_lineitem_l_shipmode_0#6788, cval_lineitem_l_comment#6756 AS cval_lineitem_l_comment_0#6789, cval_lineitem_l_shipdate#6757 AS cval_lineitem_l_shipdate_0#6790, cl_quantity#6758 AS cl_quantity_0#6791, cl_extendedprice#6759 AS cl_extendedprice_0#6792, cl_discount#6760 AS cl_discount_0#6793, ... 9 more fields]
            :        +- Relation[rid#6737,cpfk_orders_lineitem#6738,cpfk_supplier_lineitem#6739,cfpk_lineitem_supplier#6740,cfpk_lineitem_partsupp#6741,cpfk_part_lineitem#6742,cfpk_lineitem_part#6743,cpfk_partsupp_lineitem#6744,cfpk_lineitem_orders#6745,cval_lineitem_l_quantity#6746,cval_lineitem_l_extendedprice#6747,cval_lineitem_l_discount#6748,cval_lineitem_l_tax#6749,cval_lineitem_l_returnflag#6750,cval_lineitem_l_linestatus#6751,cval_lineitem_l_commitdate#6752,cval_lineitem_l_receiptdate#6753,cval_lineitem_l_shipinstruct#6754,cval_lineitem_l_shipmode#6755,cval_lineitem_l_comment#6756,cval_lineitem_l_shipdate#6757,cl_quantity#6758,cl_extendedprice#6759,cl_discount#6760,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#6803 AS rid_1#6820, cpfk_customer_orders#6804 AS cpfk_customer_orders_1#6821, cfpk_orders_customer#6805 AS cfpk_orders_customer_1#6822, cval_orders_o_orderstatus#6806 AS cval_orders_o_orderstatus_1#6823, cval_orders_o_totalprice#6807 AS cval_orders_o_totalprice_1#6824, cval_orders_o_orderpriority#6808 AS cval_orders_o_orderpriority_1#6825, cval_orders_o_clerk#6809 AS cval_orders_o_clerk_1#6826, cval_orders_o_shippriority#6810 AS cval_orders_o_shippriority_1#6827, cval_orders_o_comment#6811 AS cval_orders_o_comment_1#6828, cval_orders_o_orderdate#6812 AS cval_orders_o_orderdate_1#6829, co_orderstatus#6813 AS co_orderstatus_1#6830, co_totalprice#6814 AS co_totalprice_1#6831, co_orderpriority#6815 AS co_orderpriority_1#6832, co_clerk#6816 AS co_clerk_1#6833, co_shippriority#6817 AS co_shippriority_1#6834, co_comment#6818 AS co_comment_1#6835, co_orderdate#6819 AS co_orderdate_1#6836]
               +- Relation[rid#6803,cpfk_customer_orders#6804,cfpk_orders_customer#6805,cval_orders_o_orderstatus#6806,cval_orders_o_totalprice#6807,cval_orders_o_orderpriority#6808,cval_orders_o_clerk#6809,cval_orders_o_shippriority#6810,cval_orders_o_comment#6811,cval_orders_o_orderdate#6812,co_orderstatus#6813,co_totalprice#6814,co_orderpriority#6815,co_clerk#6816,co_shippriority#6817,co_comment#6818,co_orderdate#6819] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 25554ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/15 17:46:54 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:46:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6893L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 17:46:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:46:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:46:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:46:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:46:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:46:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:46:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:46:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:46:54 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:46:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:46:54 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:46:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:46:54 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:46:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6893L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#6895 AS rid_0#6902, cpfk_region_nation#6896 AS cpfk_region_nation_0#6903, cfpk_nation_region#6897 AS cfpk_nation_region_0#6904, cval_nation_n_name#6898 AS cval_nation_n_name_0#6905, cval_nation_n_comment#6899 AS cval_nation_n_comment_0#6906, cn_name#6900 AS cn_name_0#6907, cn_comment#6901 AS cn_comment_0#6908]
         :  :  :  :  :  +- Relation[rid#6895,cpfk_region_nation#6896,cfpk_nation_region#6897,cval_nation_n_name#6898,cval_nation_n_comment#6899,cn_name#6900,cn_comment#6901] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#6909 AS rid_0#6916, cpfk_region_nation#6910 AS cpfk_region_nation_0#6917, cfpk_nation_region#6911 AS cfpk_nation_region_0#6918, cval_nation_n_name#6912 AS cval_nation_n_name_0#6919, cval_nation_n_comment#6913 AS cval_nation_n_comment_0#6920, cn_name#6914 AS cn_name_0#6921, cn_comment#6915 AS cn_comment_0#6922]
         :  :  :  :        +- Relation[rid#6909,cpfk_region_nation#6910,cfpk_nation_region#6911,cval_nation_n_name#6912,cval_nation_n_comment#6913,cn_name#6914,cn_comment#6915] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#6963 AS rid_1#6976, cpfk_nation_supplier#6964 AS cpfk_nation_supplier_1#6977, cfpk_supplier_nation#6965 AS cfpk_supplier_nation_1#6978, cval_supplier_s_name#6966 AS cval_supplier_s_name_1#6979, cval_supplier_s_address#6967 AS cval_supplier_s_address_1#6980, cval_supplier_s_phone#6968 AS cval_supplier_s_phone_1#6981, cval_supplier_s_acctbal#6969 AS cval_supplier_s_acctbal_1#6982, cval_supplier_s_comment#6970 AS cval_supplier_s_comment_1#6983, cs_name#6971 AS cs_name_1#6984, cs_address#6972 AS cs_address_1#6985, cs_phone#6973 AS cs_phone_1#6986, cs_acctbal#6974 AS cs_acctbal_1#6987, cs_comment#6975 AS cs_comment_1#6988]
         :  :  :     +- Relation[rid#6963,cpfk_nation_supplier#6964,cfpk_supplier_nation#6965,cval_supplier_s_name#6966,cval_supplier_s_address#6967,cval_supplier_s_phone#6968,cval_supplier_s_acctbal#6969,cval_supplier_s_comment#6970,cs_name#6971,cs_address#6972,cs_phone#6973,cs_acctbal#6974,cs_comment#6975] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#6923 AS rid_1#6936, cpfk_nation_supplier#6924 AS cpfk_nation_supplier_1#6937, cfpk_supplier_nation#6925 AS cfpk_supplier_nation_1#6938, cval_supplier_s_name#6926 AS cval_supplier_s_name_1#6939, cval_supplier_s_address#6927 AS cval_supplier_s_address_1#6940, cval_supplier_s_phone#6928 AS cval_supplier_s_phone_1#6941, cval_supplier_s_acctbal#6929 AS cval_supplier_s_acctbal_1#6942, cval_supplier_s_comment#6930 AS cval_supplier_s_comment_1#6943, cs_name#6931 AS cs_name_1#6944, cs_address#6932 AS cs_address_1#6945, cs_phone#6933 AS cs_phone_1#6946, cs_acctbal#6934 AS cs_acctbal_1#6947, cs_comment#6935 AS cs_comment_1#6948]
         :  :     +- Relation[rid#6923,cpfk_nation_supplier#6924,cfpk_supplier_nation#6925,cval_supplier_s_name#6926,cval_supplier_s_address#6927,cval_supplier_s_phone#6928,cval_supplier_s_acctbal#6929,cval_supplier_s_comment#6930,cs_name#6931,cs_address#6932,cs_phone#6933,cs_acctbal#6934,cs_comment#6935] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#7037 AS rid_2#7048, cpfk_part_partsupp#7038 AS cpfk_part_partsupp_2#7049, cfpk_partsupp_part#7039 AS cfpk_partsupp_part_2#7050, cpfk_supplier_partsupp#7040 AS cpfk_supplier_partsupp_2#7051, cfpk_partsupp_supplier#7041 AS cfpk_partsupp_supplier_2#7052, cval_partsupp_ps_availqty#7042 AS cval_partsupp_ps_availqty_2#7053, cval_partsupp_ps_supplycost#7043 AS cval_partsupp_ps_supplycost_2#7054, cval_partsupp_ps_comment#7044 AS cval_partsupp_ps_comment_2#7055, cps_availqty#7045 AS cps_availqty_2#7056, cps_supplycost#7046 AS cps_supplycost_2#7057, cps_comment#7047 AS cps_comment_2#7058]
         :     +- Relation[rid#7037,cpfk_part_partsupp#7038,cfpk_partsupp_part#7039,cpfk_supplier_partsupp#7040,cfpk_partsupp_supplier#7041,cval_partsupp_ps_availqty#7042,cval_partsupp_ps_supplycost#7043,cval_partsupp_ps_comment#7044,cps_availqty#7045,cps_supplycost#7046,cps_comment#7047] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#6989 AS rid_2#7000, cpfk_part_partsupp#6990 AS cpfk_part_partsupp_2#7001, cfpk_partsupp_part#6991 AS cfpk_partsupp_part_2#7002, cpfk_supplier_partsupp#6992 AS cpfk_supplier_partsupp_2#7003, cfpk_partsupp_supplier#6993 AS cfpk_partsupp_supplier_2#7004, cval_partsupp_ps_availqty#6994 AS cval_partsupp_ps_availqty_2#7005, cval_partsupp_ps_supplycost#6995 AS cval_partsupp_ps_supplycost_2#7006, cval_partsupp_ps_comment#6996 AS cval_partsupp_ps_comment_2#7007, cps_availqty#6997 AS cps_availqty_2#7008, cps_supplycost#6998 AS cps_supplycost_2#7009, cps_comment#6999 AS cps_comment_2#7010]
            +- Relation[rid#6989,cpfk_part_partsupp#6990,cfpk_partsupp_part#6991,cpfk_supplier_partsupp#6992,cfpk_partsupp_supplier#6993,cval_partsupp_ps_availqty#6994,cval_partsupp_ps_supplycost#6995,cval_partsupp_ps_comment#6996,cps_availqty#6997,cps_supplycost#6998,cps_comment#6999] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=4
Elapsed time: 1212ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/15 17:46:55 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:46:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7096L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 17:46:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:46:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:46:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:46:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:46:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:46:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:46:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 17:46:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:46:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:46:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:46:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:46:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:46:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:46:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:46:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:46:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:46:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7096L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#7098 AS rid_0#7103, cval_region_r_name#7099 AS cval_region_r_name_0#7104, cval_region_r_comment#7100 AS cval_region_r_comment_0#7105, cr_name#7101 AS cr_name_0#7106, cr_comment#7102 AS cr_comment_0#7107]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#7098,cval_region_r_name#7099,cval_region_r_comment#7100,cr_name#7101,cr_comment#7102] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#7108 AS rid_0#7113, cval_region_r_name#7109 AS cval_region_r_name_0#7114, cval_region_r_comment#7110 AS cval_region_r_comment_0#7115, cr_name#7111 AS cr_name_0#7116, cr_comment#7112 AS cr_comment_0#7117]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#7108,cval_region_r_name#7109,cval_region_r_comment#7110,cr_name#7111,cr_comment#7112] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- Project [rid#7142 AS rid_1#7149, cpfk_region_nation#7143 AS cpfk_region_nation_1#7150, cfpk_nation_region#7144 AS cfpk_nation_region_1#7151, cval_nation_n_name#7145 AS cval_nation_n_name_1#7152, cval_nation_n_comment#7146 AS cval_nation_n_comment_1#7153, cn_name#7147 AS cn_name_1#7154, cn_comment#7148 AS cn_comment_1#7155]
         :     :  :  :  :  :  :  :  :     +- Relation[rid#7142,cpfk_region_nation#7143,cfpk_nation_region#7144,cval_nation_n_name#7145,cval_nation_n_comment#7146,cn_name#7147,cn_comment#7148] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#7118 AS rid_1#7125, cpfk_region_nation#7119 AS cpfk_region_nation_1#7126, cfpk_nation_region#7120 AS cfpk_nation_region_1#7127, cval_nation_n_name#7121 AS cval_nation_n_name_1#7128, cval_nation_n_comment#7122 AS cval_nation_n_comment_1#7129, cn_name#7123 AS cn_name_1#7130, cn_comment#7124 AS cn_comment_1#7131]
         :     :  :  :  :  :  :  :     +- Relation[rid#7118,cpfk_region_nation#7119,cfpk_nation_region#7120,cval_nation_n_name#7121,cval_nation_n_comment#7122,cn_name#7123,cn_comment#7124] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- Project [rid#7200 AS rid_2#7215, cpfk_nation_customer#7201 AS cpfk_nation_customer_2#7216, cfpk_customer_nation#7202 AS cfpk_customer_nation_2#7217, cval_customer_c_name#7203 AS cval_customer_c_name_2#7218, cval_customer_c_address#7204 AS cval_customer_c_address_2#7219, cval_customer_c_phone#7205 AS cval_customer_c_phone_2#7220, cval_customer_c_acctbal#7206 AS cval_customer_c_acctbal_2#7221, cval_customer_c_comment#7207 AS cval_customer_c_comment_2#7222, cval_customer_c_mktsegment#7208 AS cval_customer_c_mktsegment_2#7223, cc_name#7209 AS cc_name_2#7224, cc_address#7210 AS cc_address_2#7225, cc_phone#7211 AS cc_phone_2#7226, cc_acctbal#7212 AS cc_acctbal_2#7227, cc_comment#7213 AS cc_comment_2#7228, cc_mktsegment#7214 AS cc_mktsegment_2#7229]
         :     :  :  :  :  :  :     +- Relation[rid#7200,cpfk_nation_customer#7201,cfpk_customer_nation#7202,cval_customer_c_name#7203,cval_customer_c_address#7204,cval_customer_c_phone#7205,cval_customer_c_acctbal#7206,cval_customer_c_comment#7207,cval_customer_c_mktsegment#7208,cc_name#7209,cc_address#7210,cc_phone#7211,cc_acctbal#7212,cc_comment#7213,cc_mktsegment#7214] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#7156 AS rid_2#7171, cpfk_nation_customer#7157 AS cpfk_nation_customer_2#7172, cfpk_customer_nation#7158 AS cfpk_customer_nation_2#7173, cval_customer_c_name#7159 AS cval_customer_c_name_2#7174, cval_customer_c_address#7160 AS cval_customer_c_address_2#7175, cval_customer_c_phone#7161 AS cval_customer_c_phone_2#7176, cval_customer_c_acctbal#7162 AS cval_customer_c_acctbal_2#7177, cval_customer_c_comment#7163 AS cval_customer_c_comment_2#7178, cval_customer_c_mktsegment#7164 AS cval_customer_c_mktsegment_2#7179, cc_name#7165 AS cc_name_2#7180, cc_address#7166 AS cc_address_2#7181, cc_phone#7167 AS cc_phone_2#7182, cc_acctbal#7168 AS cc_acctbal_2#7183, cc_comment#7169 AS cc_comment_2#7184, cc_mktsegment#7170 AS cc_mktsegment_2#7185]
         :     :  :  :  :  :     +- Relation[rid#7156,cpfk_nation_customer#7157,cfpk_customer_nation#7158,cval_customer_c_name#7159,cval_customer_c_address#7160,cval_customer_c_phone#7161,cval_customer_c_acctbal#7162,cval_customer_c_comment#7163,cval_customer_c_mktsegment#7164,cc_name#7165,cc_address#7166,cc_phone#7167,cc_acctbal#7168,cc_comment#7169,cc_mktsegment#7170] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- Project [rid#7294 AS rid_3#7311, cpfk_customer_orders#7295 AS cpfk_customer_orders_3#7312, cfpk_orders_customer#7296 AS cfpk_orders_customer_3#7313, cval_orders_o_orderstatus#7297 AS cval_orders_o_orderstatus_3#7314, cval_orders_o_totalprice#7298 AS cval_orders_o_totalprice_3#7315, cval_orders_o_orderpriority#7299 AS cval_orders_o_orderpriority_3#7316, cval_orders_o_clerk#7300 AS cval_orders_o_clerk_3#7317, cval_orders_o_shippriority#7301 AS cval_orders_o_shippriority_3#7318, cval_orders_o_comment#7302 AS cval_orders_o_comment_3#7319, cval_orders_o_orderdate#7303 AS cval_orders_o_orderdate_3#7320, co_orderstatus#7304 AS co_orderstatus_3#7321, co_totalprice#7305 AS co_totalprice_3#7322, co_orderpriority#7306 AS co_orderpriority_3#7323, co_clerk#7307 AS co_clerk_3#7324, co_shippriority#7308 AS co_shippriority_3#7325, co_comment#7309 AS co_comment_3#7326, co_orderdate#7310 AS co_orderdate_3#7327]
         :     :  :  :  :     +- Relation[rid#7294,cpfk_customer_orders#7295,cfpk_orders_customer#7296,cval_orders_o_orderstatus#7297,cval_orders_o_totalprice#7298,cval_orders_o_orderpriority#7299,cval_orders_o_clerk#7300,cval_orders_o_shippriority#7301,cval_orders_o_comment#7302,cval_orders_o_orderdate#7303,co_orderstatus#7304,co_totalprice#7305,co_orderpriority#7306,co_clerk#7307,co_shippriority#7308,co_comment#7309,co_orderdate#7310] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#7230 AS rid_3#7247, cpfk_customer_orders#7231 AS cpfk_customer_orders_3#7248, cfpk_orders_customer#7232 AS cfpk_orders_customer_3#7249, cval_orders_o_orderstatus#7233 AS cval_orders_o_orderstatus_3#7250, cval_orders_o_totalprice#7234 AS cval_orders_o_totalprice_3#7251, cval_orders_o_orderpriority#7235 AS cval_orders_o_orderpriority_3#7252, cval_orders_o_clerk#7236 AS cval_orders_o_clerk_3#7253, cval_orders_o_shippriority#7237 AS cval_orders_o_shippriority_3#7254, cval_orders_o_comment#7238 AS cval_orders_o_comment_3#7255, cval_orders_o_orderdate#7239 AS cval_orders_o_orderdate_3#7256, co_orderstatus#7240 AS co_orderstatus_3#7257, co_totalprice#7241 AS co_totalprice_3#7258, co_orderpriority#7242 AS co_orderpriority_3#7259, co_clerk#7243 AS co_clerk_3#7260, co_shippriority#7244 AS co_shippriority_3#7261, co_comment#7245 AS co_comment_3#7262, co_orderdate#7246 AS co_orderdate_3#7263]
         :     :  :  :     +- Relation[rid#7230,cpfk_customer_orders#7231,cfpk_orders_customer#7232,cval_orders_o_orderstatus#7233,cval_orders_o_totalprice#7234,cval_orders_o_orderpriority#7235,cval_orders_o_clerk#7236,cval_orders_o_shippriority#7237,cval_orders_o_comment#7238,cval_orders_o_orderdate#7239,co_orderstatus#7240,co_totalprice#7241,co_orderpriority#7242,co_clerk#7243,co_shippriority#7244,co_comment#7245,co_orderdate#7246] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- Project [rid#7428 AS rid_4#7461, cpfk_orders_lineitem#7429 AS cpfk_orders_lineitem_4#7462, cpfk_supplier_lineitem#7430 AS cpfk_supplier_lineitem_4#7463, cfpk_lineitem_supplier#7431 AS cfpk_lineitem_supplier_4#7464, cfpk_lineitem_partsupp#7432 AS cfpk_lineitem_partsupp_4#7465, cpfk_part_lineitem#7433 AS cpfk_part_lineitem_4#7466, cfpk_lineitem_part#7434 AS cfpk_lineitem_part_4#7467, cpfk_partsupp_lineitem#7435 AS cpfk_partsupp_lineitem_4#7468, cfpk_lineitem_orders#7436 AS cfpk_lineitem_orders_4#7469, cval_lineitem_l_quantity#7437 AS cval_lineitem_l_quantity_4#7470, cval_lineitem_l_extendedprice#7438 AS cval_lineitem_l_extendedprice_4#7471, cval_lineitem_l_discount#7439 AS cval_lineitem_l_discount_4#7472, cval_lineitem_l_tax#7440 AS cval_lineitem_l_tax_4#7473, cval_lineitem_l_returnflag#7441 AS cval_lineitem_l_returnflag_4#7474, cval_lineitem_l_linestatus#7442 AS cval_lineitem_l_linestatus_4#7475, cval_lineitem_l_commitdate#7443 AS cval_lineitem_l_commitdate_4#7476, cval_lineitem_l_receiptdate#7444 AS cval_lineitem_l_receiptdate_4#7477, cval_lineitem_l_shipinstruct#7445 AS cval_lineitem_l_shipinstruct_4#7478, cval_lineitem_l_shipmode#7446 AS cval_lineitem_l_shipmode_4#7479, cval_lineitem_l_comment#7447 AS cval_lineitem_l_comment_4#7480, cval_lineitem_l_shipdate#7448 AS cval_lineitem_l_shipdate_4#7481, cl_quantity#7449 AS cl_quantity_4#7482, cl_extendedprice#7450 AS cl_extendedprice_4#7483, cl_discount#7451 AS cl_discount_4#7484, ... 9 more fields]
         :     :  :     +- Relation[rid#7428,cpfk_orders_lineitem#7429,cpfk_supplier_lineitem#7430,cfpk_lineitem_supplier#7431,cfpk_lineitem_partsupp#7432,cpfk_part_lineitem#7433,cfpk_lineitem_part#7434,cpfk_partsupp_lineitem#7435,cfpk_lineitem_orders#7436,cval_lineitem_l_quantity#7437,cval_lineitem_l_extendedprice#7438,cval_lineitem_l_discount#7439,cval_lineitem_l_tax#7440,cval_lineitem_l_returnflag#7441,cval_lineitem_l_linestatus#7442,cval_lineitem_l_commitdate#7443,cval_lineitem_l_receiptdate#7444,cval_lineitem_l_shipinstruct#7445,cval_lineitem_l_shipmode#7446,cval_lineitem_l_comment#7447,cval_lineitem_l_shipdate#7448,cl_quantity#7449,cl_extendedprice#7450,cl_discount#7451,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#7328 AS rid_4#7361, cpfk_orders_lineitem#7329 AS cpfk_orders_lineitem_4#7362, cpfk_supplier_lineitem#7330 AS cpfk_supplier_lineitem_4#7363, cfpk_lineitem_supplier#7331 AS cfpk_lineitem_supplier_4#7364, cfpk_lineitem_partsupp#7332 AS cfpk_lineitem_partsupp_4#7365, cpfk_part_lineitem#7333 AS cpfk_part_lineitem_4#7366, cfpk_lineitem_part#7334 AS cfpk_lineitem_part_4#7367, cpfk_partsupp_lineitem#7335 AS cpfk_partsupp_lineitem_4#7368, cfpk_lineitem_orders#7336 AS cfpk_lineitem_orders_4#7369, cval_lineitem_l_quantity#7337 AS cval_lineitem_l_quantity_4#7370, cval_lineitem_l_extendedprice#7338 AS cval_lineitem_l_extendedprice_4#7371, cval_lineitem_l_discount#7339 AS cval_lineitem_l_discount_4#7372, cval_lineitem_l_tax#7340 AS cval_lineitem_l_tax_4#7373, cval_lineitem_l_returnflag#7341 AS cval_lineitem_l_returnflag_4#7374, cval_lineitem_l_linestatus#7342 AS cval_lineitem_l_linestatus_4#7375, cval_lineitem_l_commitdate#7343 AS cval_lineitem_l_commitdate_4#7376, cval_lineitem_l_receiptdate#7344 AS cval_lineitem_l_receiptdate_4#7377, cval_lineitem_l_shipinstruct#7345 AS cval_lineitem_l_shipinstruct_4#7378, cval_lineitem_l_shipmode#7346 AS cval_lineitem_l_shipmode_4#7379, cval_lineitem_l_comment#7347 AS cval_lineitem_l_comment_4#7380, cval_lineitem_l_shipdate#7348 AS cval_lineitem_l_shipdate_4#7381, cl_quantity#7349 AS cl_quantity_4#7382, cl_extendedprice#7350 AS cl_extendedprice_4#7383, cl_discount#7351 AS cl_discount_4#7384, ... 9 more fields]
         :     :     +- Relation[rid#7328,cpfk_orders_lineitem#7329,cpfk_supplier_lineitem#7330,cfpk_lineitem_supplier#7331,cfpk_lineitem_partsupp#7332,cpfk_part_lineitem#7333,cfpk_lineitem_part#7334,cpfk_partsupp_lineitem#7335,cfpk_lineitem_orders#7336,cval_lineitem_l_quantity#7337,cval_lineitem_l_extendedprice#7338,cval_lineitem_l_discount#7339,cval_lineitem_l_tax#7340,cval_lineitem_l_returnflag#7341,cval_lineitem_l_linestatus#7342,cval_lineitem_l_commitdate#7343,cval_lineitem_l_receiptdate#7344,cval_lineitem_l_shipinstruct#7345,cval_lineitem_l_shipmode#7346,cval_lineitem_l_comment#7347,cval_lineitem_l_shipdate#7348,cl_quantity#7349,cl_extendedprice#7350,cl_discount#7351,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#7494 AS rid_5#7507, cpfk_nation_supplier#7495 AS cpfk_nation_supplier_5#7508, cfpk_supplier_nation#7496 AS cfpk_supplier_nation_5#7509, cval_supplier_s_name#7497 AS cval_supplier_s_name_5#7510, cval_supplier_s_address#7498 AS cval_supplier_s_address_5#7511, cval_supplier_s_phone#7499 AS cval_supplier_s_phone_5#7512, cval_supplier_s_acctbal#7500 AS cval_supplier_s_acctbal_5#7513, cval_supplier_s_comment#7501 AS cval_supplier_s_comment_5#7514, cs_name#7502 AS cs_name_5#7515, cs_address#7503 AS cs_address_5#7516, cs_phone#7504 AS cs_phone_5#7517, cs_acctbal#7505 AS cs_acctbal_5#7518, cs_comment#7506 AS cs_comment_5#7519]
         :        +- Relation[rid#7494,cpfk_nation_supplier#7495,cfpk_supplier_nation#7496,cval_supplier_s_name#7497,cval_supplier_s_address#7498,cval_supplier_s_phone#7499,cval_supplier_s_acctbal#7500,cval_supplier_s_comment#7501,cs_name#7502,cs_address#7503,cs_phone#7504,cs_acctbal#7505,cs_comment#7506] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#7520 AS rid_1#7527, cpfk_region_nation#7521 AS cpfk_region_nation_1#7528, cfpk_nation_region#7522 AS cfpk_nation_region_1#7529, cval_nation_n_name#7523 AS cval_nation_n_name_1#7530, cval_nation_n_comment#7524 AS cval_nation_n_comment_1#7531, cn_name#7525 AS cn_name_1#7532, cn_comment#7526 AS cn_comment_1#7533]
            :  +- Relation[rid#7520,cpfk_region_nation#7521,cfpk_nation_region#7522,cval_nation_n_name#7523,cval_nation_n_comment#7524,cn_name#7525,cn_comment#7526] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#7534 AS rid_5#7547, cpfk_nation_supplier#7535 AS cpfk_nation_supplier_5#7548, cfpk_supplier_nation#7536 AS cfpk_supplier_nation_5#7549, cval_supplier_s_name#7537 AS cval_supplier_s_name_5#7550, cval_supplier_s_address#7538 AS cval_supplier_s_address_5#7551, cval_supplier_s_phone#7539 AS cval_supplier_s_phone_5#7552, cval_supplier_s_acctbal#7540 AS cval_supplier_s_acctbal_5#7553, cval_supplier_s_comment#7541 AS cval_supplier_s_comment_5#7554, cs_name#7542 AS cs_name_5#7555, cs_address#7543 AS cs_address_5#7556, cs_phone#7544 AS cs_phone_5#7557, cs_acctbal#7545 AS cs_acctbal_5#7558, cs_comment#7546 AS cs_comment_5#7559]
               +- Relation[rid#7534,cpfk_nation_supplier#7535,cfpk_supplier_nation#7536,cval_supplier_s_name#7537,cval_supplier_s_address#7538,cval_supplier_s_phone#7539,cval_supplier_s_acctbal#7540,cval_supplier_s_comment#7541,cs_name#7542,cs_address#7543,cs_phone#7544,cs_acctbal#7545,cs_comment#7546] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1
Elapsed time: 23214ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/15 17:47:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:47:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7654L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 17:47:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:47:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:47:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:47:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:47:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:47:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:47:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:47:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7654L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#7656 AS rid_0#7689, cpfk_orders_lineitem#7657 AS cpfk_orders_lineitem_0#7690, cpfk_supplier_lineitem#7658 AS cpfk_supplier_lineitem_0#7691, cfpk_lineitem_supplier#7659 AS cfpk_lineitem_supplier_0#7692, cfpk_lineitem_partsupp#7660 AS cfpk_lineitem_partsupp_0#7693, cpfk_part_lineitem#7661 AS cpfk_part_lineitem_0#7694, cfpk_lineitem_part#7662 AS cfpk_lineitem_part_0#7695, cpfk_partsupp_lineitem#7663 AS cpfk_partsupp_lineitem_0#7696, cfpk_lineitem_orders#7664 AS cfpk_lineitem_orders_0#7697, cval_lineitem_l_quantity#7665 AS cval_lineitem_l_quantity_0#7698, cval_lineitem_l_extendedprice#7666 AS cval_lineitem_l_extendedprice_0#7699, cval_lineitem_l_discount#7667 AS cval_lineitem_l_discount_0#7700, cval_lineitem_l_tax#7668 AS cval_lineitem_l_tax_0#7701, cval_lineitem_l_returnflag#7669 AS cval_lineitem_l_returnflag_0#7702, cval_lineitem_l_linestatus#7670 AS cval_lineitem_l_linestatus_0#7703, cval_lineitem_l_commitdate#7671 AS cval_lineitem_l_commitdate_0#7704, cval_lineitem_l_receiptdate#7672 AS cval_lineitem_l_receiptdate_0#7705, cval_lineitem_l_shipinstruct#7673 AS cval_lineitem_l_shipinstruct_0#7706, cval_lineitem_l_shipmode#7674 AS cval_lineitem_l_shipmode_0#7707, cval_lineitem_l_comment#7675 AS cval_lineitem_l_comment_0#7708, cval_lineitem_l_shipdate#7676 AS cval_lineitem_l_shipdate_0#7709, cl_quantity#7677 AS cl_quantity_0#7710, cl_extendedprice#7678 AS cl_extendedprice_0#7711, cl_discount#7679 AS cl_discount_0#7712, ... 9 more fields]
            :  +- Relation[rid#7656,cpfk_orders_lineitem#7657,cpfk_supplier_lineitem#7658,cfpk_lineitem_supplier#7659,cfpk_lineitem_partsupp#7660,cpfk_part_lineitem#7661,cfpk_lineitem_part#7662,cpfk_partsupp_lineitem#7663,cfpk_lineitem_orders#7664,cval_lineitem_l_quantity#7665,cval_lineitem_l_extendedprice#7666,cval_lineitem_l_discount#7667,cval_lineitem_l_tax#7668,cval_lineitem_l_returnflag#7669,cval_lineitem_l_linestatus#7670,cval_lineitem_l_commitdate#7671,cval_lineitem_l_receiptdate#7672,cval_lineitem_l_shipinstruct#7673,cval_lineitem_l_shipmode#7674,cval_lineitem_l_comment#7675,cval_lineitem_l_shipdate#7676,cl_quantity#7677,cl_extendedprice#7678,cl_discount#7679,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#7722 AS rid_1#7739, cpfk_customer_orders#7723 AS cpfk_customer_orders_1#7740, cfpk_orders_customer#7724 AS cfpk_orders_customer_1#7741, cval_orders_o_orderstatus#7725 AS cval_orders_o_orderstatus_1#7742, cval_orders_o_totalprice#7726 AS cval_orders_o_totalprice_1#7743, cval_orders_o_orderpriority#7727 AS cval_orders_o_orderpriority_1#7744, cval_orders_o_clerk#7728 AS cval_orders_o_clerk_1#7745, cval_orders_o_shippriority#7729 AS cval_orders_o_shippriority_1#7746, cval_orders_o_comment#7730 AS cval_orders_o_comment_1#7747, cval_orders_o_orderdate#7731 AS cval_orders_o_orderdate_1#7748, co_orderstatus#7732 AS co_orderstatus_1#7749, co_totalprice#7733 AS co_totalprice_1#7750, co_orderpriority#7734 AS co_orderpriority_1#7751, co_clerk#7735 AS co_clerk_1#7752, co_shippriority#7736 AS co_shippriority_1#7753, co_comment#7737 AS co_comment_1#7754, co_orderdate#7738 AS co_orderdate_1#7755]
                  :     :  :  :  :  +- Relation[rid#7722,cpfk_customer_orders#7723,cfpk_orders_customer#7724,cval_orders_o_orderstatus#7725,cval_orders_o_totalprice#7726,cval_orders_o_orderpriority#7727,cval_orders_o_clerk#7728,cval_orders_o_shippriority#7729,cval_orders_o_comment#7730,cval_orders_o_orderdate#7731,co_orderstatus#7732,co_totalprice#7733,co_orderpriority#7734,co_clerk#7735,co_shippriority#7736,co_comment#7737,co_orderdate#7738] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#7756 AS rid_1#7773, cpfk_customer_orders#7757 AS cpfk_customer_orders_1#7774, cfpk_orders_customer#7758 AS cfpk_orders_customer_1#7775, cval_orders_o_orderstatus#7759 AS cval_orders_o_orderstatus_1#7776, cval_orders_o_totalprice#7760 AS cval_orders_o_totalprice_1#7777, cval_orders_o_orderpriority#7761 AS cval_orders_o_orderpriority_1#7778, cval_orders_o_clerk#7762 AS cval_orders_o_clerk_1#7779, cval_orders_o_shippriority#7763 AS cval_orders_o_shippriority_1#7780, cval_orders_o_comment#7764 AS cval_orders_o_comment_1#7781, cval_orders_o_orderdate#7765 AS cval_orders_o_orderdate_1#7782, co_orderstatus#7766 AS co_orderstatus_1#7783, co_totalprice#7767 AS co_totalprice_1#7784, co_orderpriority#7768 AS co_orderpriority_1#7785, co_clerk#7769 AS co_clerk_1#7786, co_shippriority#7770 AS co_shippriority_1#7787, co_comment#7771 AS co_comment_1#7788, co_orderdate#7772 AS co_orderdate_1#7789]
                  :     :  :  :        +- Relation[rid#7756,cpfk_customer_orders#7757,cfpk_orders_customer#7758,cval_orders_o_orderstatus#7759,cval_orders_o_totalprice#7760,cval_orders_o_orderpriority#7761,cval_orders_o_clerk#7762,cval_orders_o_shippriority#7763,cval_orders_o_comment#7764,cval_orders_o_orderdate#7765,co_orderstatus#7766,co_totalprice#7767,co_orderpriority#7768,co_clerk#7769,co_shippriority#7770,co_comment#7771,co_orderdate#7772] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- Project [rid#7890 AS rid_2#7923, cpfk_orders_lineitem#7891 AS cpfk_orders_lineitem_2#7924, cpfk_supplier_lineitem#7892 AS cpfk_supplier_lineitem_2#7925, cfpk_lineitem_supplier#7893 AS cfpk_lineitem_supplier_2#7926, cfpk_lineitem_partsupp#7894 AS cfpk_lineitem_partsupp_2#7927, cpfk_part_lineitem#7895 AS cpfk_part_lineitem_2#7928, cfpk_lineitem_part#7896 AS cfpk_lineitem_part_2#7929, cpfk_partsupp_lineitem#7897 AS cpfk_partsupp_lineitem_2#7930, cfpk_lineitem_orders#7898 AS cfpk_lineitem_orders_2#7931, cval_lineitem_l_quantity#7899 AS cval_lineitem_l_quantity_2#7932, cval_lineitem_l_extendedprice#7900 AS cval_lineitem_l_extendedprice_2#7933, cval_lineitem_l_discount#7901 AS cval_lineitem_l_discount_2#7934, cval_lineitem_l_tax#7902 AS cval_lineitem_l_tax_2#7935, cval_lineitem_l_returnflag#7903 AS cval_lineitem_l_returnflag_2#7936, cval_lineitem_l_linestatus#7904 AS cval_lineitem_l_linestatus_2#7937, cval_lineitem_l_commitdate#7905 AS cval_lineitem_l_commitdate_2#7938, cval_lineitem_l_receiptdate#7906 AS cval_lineitem_l_receiptdate_2#7939, cval_lineitem_l_shipinstruct#7907 AS cval_lineitem_l_shipinstruct_2#7940, cval_lineitem_l_shipmode#7908 AS cval_lineitem_l_shipmode_2#7941, cval_lineitem_l_comment#7909 AS cval_lineitem_l_comment_2#7942, cval_lineitem_l_shipdate#7910 AS cval_lineitem_l_shipdate_2#7943, cl_quantity#7911 AS cl_quantity_2#7944, cl_extendedprice#7912 AS cl_extendedprice_2#7945, cl_discount#7913 AS cl_discount_2#7946, ... 9 more fields]
                  :     :  :     +- Relation[rid#7890,cpfk_orders_lineitem#7891,cpfk_supplier_lineitem#7892,cfpk_lineitem_supplier#7893,cfpk_lineitem_partsupp#7894,cpfk_part_lineitem#7895,cfpk_lineitem_part#7896,cpfk_partsupp_lineitem#7897,cfpk_lineitem_orders#7898,cval_lineitem_l_quantity#7899,cval_lineitem_l_extendedprice#7900,cval_lineitem_l_discount#7901,cval_lineitem_l_tax#7902,cval_lineitem_l_returnflag#7903,cval_lineitem_l_linestatus#7904,cval_lineitem_l_commitdate#7905,cval_lineitem_l_receiptdate#7906,cval_lineitem_l_shipinstruct#7907,cval_lineitem_l_shipmode#7908,cval_lineitem_l_comment#7909,cval_lineitem_l_shipdate#7910,cl_quantity#7911,cl_extendedprice#7912,cl_discount#7913,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#7790 AS rid_2#7823, cpfk_orders_lineitem#7791 AS cpfk_orders_lineitem_2#7824, cpfk_supplier_lineitem#7792 AS cpfk_supplier_lineitem_2#7825, cfpk_lineitem_supplier#7793 AS cfpk_lineitem_supplier_2#7826, cfpk_lineitem_partsupp#7794 AS cfpk_lineitem_partsupp_2#7827, cpfk_part_lineitem#7795 AS cpfk_part_lineitem_2#7828, cfpk_lineitem_part#7796 AS cfpk_lineitem_part_2#7829, cpfk_partsupp_lineitem#7797 AS cpfk_partsupp_lineitem_2#7830, cfpk_lineitem_orders#7798 AS cfpk_lineitem_orders_2#7831, cval_lineitem_l_quantity#7799 AS cval_lineitem_l_quantity_2#7832, cval_lineitem_l_extendedprice#7800 AS cval_lineitem_l_extendedprice_2#7833, cval_lineitem_l_discount#7801 AS cval_lineitem_l_discount_2#7834, cval_lineitem_l_tax#7802 AS cval_lineitem_l_tax_2#7835, cval_lineitem_l_returnflag#7803 AS cval_lineitem_l_returnflag_2#7836, cval_lineitem_l_linestatus#7804 AS cval_lineitem_l_linestatus_2#7837, cval_lineitem_l_commitdate#7805 AS cval_lineitem_l_commitdate_2#7838, cval_lineitem_l_receiptdate#7806 AS cval_lineitem_l_receiptdate_2#7839, cval_lineitem_l_shipinstruct#7807 AS cval_lineitem_l_shipinstruct_2#7840, cval_lineitem_l_shipmode#7808 AS cval_lineitem_l_shipmode_2#7841, cval_lineitem_l_comment#7809 AS cval_lineitem_l_comment_2#7842, cval_lineitem_l_shipdate#7810 AS cval_lineitem_l_shipdate_2#7843, cl_quantity#7811 AS cl_quantity_2#7844, cl_extendedprice#7812 AS cl_extendedprice_2#7845, cl_discount#7813 AS cl_discount_2#7846, ... 9 more fields]
                  :     :     +- Relation[rid#7790,cpfk_orders_lineitem#7791,cpfk_supplier_lineitem#7792,cfpk_lineitem_supplier#7793,cfpk_lineitem_partsupp#7794,cpfk_part_lineitem#7795,cfpk_lineitem_part#7796,cpfk_partsupp_lineitem#7797,cfpk_lineitem_orders#7798,cval_lineitem_l_quantity#7799,cval_lineitem_l_extendedprice#7800,cval_lineitem_l_discount#7801,cval_lineitem_l_tax#7802,cval_lineitem_l_returnflag#7803,cval_lineitem_l_linestatus#7804,cval_lineitem_l_commitdate#7805,cval_lineitem_l_receiptdate#7806,cval_lineitem_l_shipinstruct#7807,cval_lineitem_l_shipmode#7808,cval_lineitem_l_comment#7809,cval_lineitem_l_shipdate#7810,cl_quantity#7811,cl_extendedprice#7812,cl_discount#7813,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#7956 AS rid_3#7969, cpfk_nation_supplier#7957 AS cpfk_nation_supplier_3#7970, cfpk_supplier_nation#7958 AS cfpk_supplier_nation_3#7971, cval_supplier_s_name#7959 AS cval_supplier_s_name_3#7972, cval_supplier_s_address#7960 AS cval_supplier_s_address_3#7973, cval_supplier_s_phone#7961 AS cval_supplier_s_phone_3#7974, cval_supplier_s_acctbal#7962 AS cval_supplier_s_acctbal_3#7975, cval_supplier_s_comment#7963 AS cval_supplier_s_comment_3#7976, cs_name#7964 AS cs_name_3#7977, cs_address#7965 AS cs_address_3#7978, cs_phone#7966 AS cs_phone_3#7979, cs_acctbal#7967 AS cs_acctbal_3#7980, cs_comment#7968 AS cs_comment_3#7981]
                  :        +- Relation[rid#7956,cpfk_nation_supplier#7957,cfpk_supplier_nation#7958,cval_supplier_s_name#7959,cval_supplier_s_address#7960,cval_supplier_s_phone#7961,cval_supplier_s_acctbal#7962,cval_supplier_s_comment#7963,cs_name#7964,cs_address#7965,cs_phone#7966,cs_acctbal#7967,cs_comment#7968] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#7982 AS rid_4#7989, cpfk_region_nation#7983 AS cpfk_region_nation_4#7990, cfpk_nation_region#7984 AS cfpk_nation_region_4#7991, cval_nation_n_name#7985 AS cval_nation_n_name_4#7992, cval_nation_n_comment#7986 AS cval_nation_n_comment_4#7993, cn_name#7987 AS cn_name_4#7994, cn_comment#7988 AS cn_comment_4#7995]
                     :  +- Relation[rid#7982,cpfk_region_nation#7983,cfpk_nation_region#7984,cval_nation_n_name#7985,cval_nation_n_comment#7986,cn_name#7987,cn_comment#7988] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#7996 AS rid_4#8003, cpfk_region_nation#7997 AS cpfk_region_nation_4#8004, cfpk_nation_region#7998 AS cfpk_nation_region_4#8005, cval_nation_n_name#7999 AS cval_nation_n_name_4#8006, cval_nation_n_comment#8000 AS cval_nation_n_comment_4#8007, cn_name#8001 AS cn_name_4#8008, cn_comment#8002 AS cn_comment_4#8009]
                           +- Relation[rid#7996,cpfk_region_nation#7997,cfpk_nation_region#7998,cval_nation_n_name#7999,cval_nation_n_comment#8000,cn_name#8001,cn_comment#8002] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=120762
Elapsed time: 97660ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/15 17:48:56 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:48:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8122L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:48:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8122L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#8124 AS rid_0#8139, cpfk_nation_customer#8125 AS cpfk_nation_customer_0#8140, cfpk_customer_nation#8126 AS cfpk_customer_nation_0#8141, cval_customer_c_name#8127 AS cval_customer_c_name_0#8142, cval_customer_c_address#8128 AS cval_customer_c_address_0#8143, cval_customer_c_phone#8129 AS cval_customer_c_phone_0#8144, cval_customer_c_acctbal#8130 AS cval_customer_c_acctbal_0#8145, cval_customer_c_comment#8131 AS cval_customer_c_comment_0#8146, cval_customer_c_mktsegment#8132 AS cval_customer_c_mktsegment_0#8147, cc_name#8133 AS cc_name_0#8148, cc_address#8134 AS cc_address_0#8149, cc_phone#8135 AS cc_phone_0#8150, cc_acctbal#8136 AS cc_acctbal_0#8151, cc_comment#8137 AS cc_comment_0#8152, cc_mktsegment#8138 AS cc_mktsegment_0#8153]
         :  :  :  :  +- Relation[rid#8124,cpfk_nation_customer#8125,cfpk_customer_nation#8126,cval_customer_c_name#8127,cval_customer_c_address#8128,cval_customer_c_phone#8129,cval_customer_c_acctbal#8130,cval_customer_c_comment#8131,cval_customer_c_mktsegment#8132,cc_name#8133,cc_address#8134,cc_phone#8135,cc_acctbal#8136,cc_comment#8137,cc_mktsegment#8138] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#8188 AS rid_0#8203, cpfk_nation_customer#8189 AS cpfk_nation_customer_0#8204, cfpk_customer_nation#8190 AS cfpk_customer_nation_0#8205, cval_customer_c_name#8191 AS cval_customer_c_name_0#8206, cval_customer_c_address#8192 AS cval_customer_c_address_0#8207, cval_customer_c_phone#8193 AS cval_customer_c_phone_0#8208, cval_customer_c_acctbal#8194 AS cval_customer_c_acctbal_0#8209, cval_customer_c_comment#8195 AS cval_customer_c_comment_0#8210, cval_customer_c_mktsegment#8196 AS cval_customer_c_mktsegment_0#8211, cc_name#8197 AS cc_name_0#8212, cc_address#8198 AS cc_address_0#8213, cc_phone#8199 AS cc_phone_0#8214, cc_acctbal#8200 AS cc_acctbal_0#8215, cc_comment#8201 AS cc_comment_0#8216, cc_mktsegment#8202 AS cc_mktsegment_0#8217]
         :  :  :     :  +- Relation[rid#8188,cpfk_nation_customer#8189,cfpk_customer_nation#8190,cval_customer_c_name#8191,cval_customer_c_address#8192,cval_customer_c_phone#8193,cval_customer_c_acctbal#8194,cval_customer_c_comment#8195,cval_customer_c_mktsegment#8196,cc_name#8197,cc_address#8198,cc_phone#8199,cc_acctbal#8200,cc_comment#8201,cc_mktsegment#8202] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#8218 AS rid_1#8235, cpfk_customer_orders#8219 AS cpfk_customer_orders_1#8236, cfpk_orders_customer#8220 AS cfpk_orders_customer_1#8237, cval_orders_o_orderstatus#8221 AS cval_orders_o_orderstatus_1#8238, cval_orders_o_totalprice#8222 AS cval_orders_o_totalprice_1#8239, cval_orders_o_orderpriority#8223 AS cval_orders_o_orderpriority_1#8240, cval_orders_o_clerk#8224 AS cval_orders_o_clerk_1#8241, cval_orders_o_shippriority#8225 AS cval_orders_o_shippriority_1#8242, cval_orders_o_comment#8226 AS cval_orders_o_comment_1#8243, cval_orders_o_orderdate#8227 AS cval_orders_o_orderdate_1#8244, co_orderstatus#8228 AS co_orderstatus_1#8245, co_totalprice#8229 AS co_totalprice_1#8246, co_orderpriority#8230 AS co_orderpriority_1#8247, co_clerk#8231 AS co_clerk_1#8248, co_shippriority#8232 AS co_shippriority_1#8249, co_comment#8233 AS co_comment_1#8250, co_orderdate#8234 AS co_orderdate_1#8251]
         :  :  :        +- Relation[rid#8218,cpfk_customer_orders#8219,cfpk_orders_customer#8220,cval_orders_o_orderstatus#8221,cval_orders_o_totalprice#8222,cval_orders_o_orderpriority#8223,cval_orders_o_clerk#8224,cval_orders_o_shippriority#8225,cval_orders_o_comment#8226,cval_orders_o_orderdate#8227,co_orderstatus#8228,co_totalprice#8229,co_orderpriority#8230,co_clerk#8231,co_shippriority#8232,co_comment#8233,co_orderdate#8234] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#8154 AS rid_1#8171, cpfk_customer_orders#8155 AS cpfk_customer_orders_1#8172, cfpk_orders_customer#8156 AS cfpk_orders_customer_1#8173, cval_orders_o_orderstatus#8157 AS cval_orders_o_orderstatus_1#8174, cval_orders_o_totalprice#8158 AS cval_orders_o_totalprice_1#8175, cval_orders_o_orderpriority#8159 AS cval_orders_o_orderpriority_1#8176, cval_orders_o_clerk#8160 AS cval_orders_o_clerk_1#8177, cval_orders_o_shippriority#8161 AS cval_orders_o_shippriority_1#8178, cval_orders_o_comment#8162 AS cval_orders_o_comment_1#8179, cval_orders_o_orderdate#8163 AS cval_orders_o_orderdate_1#8180, co_orderstatus#8164 AS co_orderstatus_1#8181, co_totalprice#8165 AS co_totalprice_1#8182, co_orderpriority#8166 AS co_orderpriority_1#8183, co_clerk#8167 AS co_clerk_1#8184, co_shippriority#8168 AS co_shippriority_1#8185, co_comment#8169 AS co_comment_1#8186, co_orderdate#8170 AS co_orderdate_1#8187]
         :  :     +- Relation[rid#8154,cpfk_customer_orders#8155,cfpk_orders_customer#8156,cval_orders_o_orderstatus#8157,cval_orders_o_totalprice#8158,cval_orders_o_orderpriority#8159,cval_orders_o_clerk#8160,cval_orders_o_shippriority#8161,cval_orders_o_comment#8162,cval_orders_o_orderdate#8163,co_orderstatus#8164,co_totalprice#8165,co_orderpriority#8166,co_clerk#8167,co_shippriority#8168,co_comment#8169,co_orderdate#8170] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#8318 AS rid_1#8335, cpfk_customer_orders#8319 AS cpfk_customer_orders_1#8336, cfpk_orders_customer#8320 AS cfpk_orders_customer_1#8337, cval_orders_o_orderstatus#8321 AS cval_orders_o_orderstatus_1#8338, cval_orders_o_totalprice#8322 AS cval_orders_o_totalprice_1#8339, cval_orders_o_orderpriority#8323 AS cval_orders_o_orderpriority_1#8340, cval_orders_o_clerk#8324 AS cval_orders_o_clerk_1#8341, cval_orders_o_shippriority#8325 AS cval_orders_o_shippriority_1#8342, cval_orders_o_comment#8326 AS cval_orders_o_comment_1#8343, cval_orders_o_orderdate#8327 AS cval_orders_o_orderdate_1#8344, co_orderstatus#8328 AS co_orderstatus_1#8345, co_totalprice#8329 AS co_totalprice_1#8346, co_orderpriority#8330 AS co_orderpriority_1#8347, co_clerk#8331 AS co_clerk_1#8348, co_shippriority#8332 AS co_shippriority_1#8349, co_comment#8333 AS co_comment_1#8350, co_orderdate#8334 AS co_orderdate_1#8351]
         :     :  +- Relation[rid#8318,cpfk_customer_orders#8319,cfpk_orders_customer#8320,cval_orders_o_orderstatus#8321,cval_orders_o_totalprice#8322,cval_orders_o_orderpriority#8323,cval_orders_o_clerk#8324,cval_orders_o_shippriority#8325,cval_orders_o_comment#8326,cval_orders_o_orderdate#8327,co_orderstatus#8328,co_totalprice#8329,co_orderpriority#8330,co_clerk#8331,co_shippriority#8332,co_comment#8333,co_orderdate#8334] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#8352 AS rid_2#8385, cpfk_orders_lineitem#8353 AS cpfk_orders_lineitem_2#8386, cpfk_supplier_lineitem#8354 AS cpfk_supplier_lineitem_2#8387, cfpk_lineitem_supplier#8355 AS cfpk_lineitem_supplier_2#8388, cfpk_lineitem_partsupp#8356 AS cfpk_lineitem_partsupp_2#8389, cpfk_part_lineitem#8357 AS cpfk_part_lineitem_2#8390, cfpk_lineitem_part#8358 AS cfpk_lineitem_part_2#8391, cpfk_partsupp_lineitem#8359 AS cpfk_partsupp_lineitem_2#8392, cfpk_lineitem_orders#8360 AS cfpk_lineitem_orders_2#8393, cval_lineitem_l_quantity#8361 AS cval_lineitem_l_quantity_2#8394, cval_lineitem_l_extendedprice#8362 AS cval_lineitem_l_extendedprice_2#8395, cval_lineitem_l_discount#8363 AS cval_lineitem_l_discount_2#8396, cval_lineitem_l_tax#8364 AS cval_lineitem_l_tax_2#8397, cval_lineitem_l_returnflag#8365 AS cval_lineitem_l_returnflag_2#8398, cval_lineitem_l_linestatus#8366 AS cval_lineitem_l_linestatus_2#8399, cval_lineitem_l_commitdate#8367 AS cval_lineitem_l_commitdate_2#8400, cval_lineitem_l_receiptdate#8368 AS cval_lineitem_l_receiptdate_2#8401, cval_lineitem_l_shipinstruct#8369 AS cval_lineitem_l_shipinstruct_2#8402, cval_lineitem_l_shipmode#8370 AS cval_lineitem_l_shipmode_2#8403, cval_lineitem_l_comment#8371 AS cval_lineitem_l_comment_2#8404, cval_lineitem_l_shipdate#8372 AS cval_lineitem_l_shipdate_2#8405, cl_quantity#8373 AS cl_quantity_2#8406, cl_extendedprice#8374 AS cl_extendedprice_2#8407, cl_discount#8375 AS cl_discount_2#8408, ... 9 more fields]
         :        +- Relation[rid#8352,cpfk_orders_lineitem#8353,cpfk_supplier_lineitem#8354,cfpk_lineitem_supplier#8355,cfpk_lineitem_partsupp#8356,cpfk_part_lineitem#8357,cfpk_lineitem_part#8358,cpfk_partsupp_lineitem#8359,cfpk_lineitem_orders#8360,cval_lineitem_l_quantity#8361,cval_lineitem_l_extendedprice#8362,cval_lineitem_l_discount#8363,cval_lineitem_l_tax#8364,cval_lineitem_l_returnflag#8365,cval_lineitem_l_linestatus#8366,cval_lineitem_l_commitdate#8367,cval_lineitem_l_receiptdate#8368,cval_lineitem_l_shipinstruct#8369,cval_lineitem_l_shipmode#8370,cval_lineitem_l_comment#8371,cval_lineitem_l_shipdate#8372,cl_quantity#8373,cl_extendedprice#8374,cl_discount#8375,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8252 AS rid_2#8285, cpfk_orders_lineitem#8253 AS cpfk_orders_lineitem_2#8286, cpfk_supplier_lineitem#8254 AS cpfk_supplier_lineitem_2#8287, cfpk_lineitem_supplier#8255 AS cfpk_lineitem_supplier_2#8288, cfpk_lineitem_partsupp#8256 AS cfpk_lineitem_partsupp_2#8289, cpfk_part_lineitem#8257 AS cpfk_part_lineitem_2#8290, cfpk_lineitem_part#8258 AS cfpk_lineitem_part_2#8291, cpfk_partsupp_lineitem#8259 AS cpfk_partsupp_lineitem_2#8292, cfpk_lineitem_orders#8260 AS cfpk_lineitem_orders_2#8293, cval_lineitem_l_quantity#8261 AS cval_lineitem_l_quantity_2#8294, cval_lineitem_l_extendedprice#8262 AS cval_lineitem_l_extendedprice_2#8295, cval_lineitem_l_discount#8263 AS cval_lineitem_l_discount_2#8296, cval_lineitem_l_tax#8264 AS cval_lineitem_l_tax_2#8297, cval_lineitem_l_returnflag#8265 AS cval_lineitem_l_returnflag_2#8298, cval_lineitem_l_linestatus#8266 AS cval_lineitem_l_linestatus_2#8299, cval_lineitem_l_commitdate#8267 AS cval_lineitem_l_commitdate_2#8300, cval_lineitem_l_receiptdate#8268 AS cval_lineitem_l_receiptdate_2#8301, cval_lineitem_l_shipinstruct#8269 AS cval_lineitem_l_shipinstruct_2#8302, cval_lineitem_l_shipmode#8270 AS cval_lineitem_l_shipmode_2#8303, cval_lineitem_l_comment#8271 AS cval_lineitem_l_comment_2#8304, cval_lineitem_l_shipdate#8272 AS cval_lineitem_l_shipdate_2#8305, cl_quantity#8273 AS cl_quantity_2#8306, cl_extendedprice#8274 AS cl_extendedprice_2#8307, cl_discount#8275 AS cl_discount_2#8308, ... 9 more fields]
            +- Relation[rid#8252,cpfk_orders_lineitem#8253,cpfk_supplier_lineitem#8254,cfpk_lineitem_supplier#8255,cfpk_lineitem_partsupp#8256,cpfk_part_lineitem#8257,cfpk_lineitem_part#8258,cpfk_partsupp_lineitem#8259,cfpk_lineitem_orders#8260,cval_lineitem_l_quantity#8261,cval_lineitem_l_extendedprice#8262,cval_lineitem_l_discount#8263,cval_lineitem_l_tax#8264,cval_lineitem_l_returnflag#8265,cval_lineitem_l_linestatus#8266,cval_lineitem_l_commitdate#8267,cval_lineitem_l_receiptdate#8268,cval_lineitem_l_shipinstruct#8269,cval_lineitem_l_shipmode#8270,cval_lineitem_l_comment#8271,cval_lineitem_l_shipdate#8272,cl_quantity#8273,cl_extendedprice#8274,cl_discount#8275,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 139336ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/15 17:51:15 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:51:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8491L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:51:15 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 17:51:15 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 17:51:15 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 17:51:15 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 17:51:15 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 17:51:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8491L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#8493 AS rid_0#8508, cpfk_nation_customer#8494 AS cpfk_nation_customer_0#8509, cfpk_customer_nation#8495 AS cfpk_customer_nation_0#8510, cval_customer_c_name#8496 AS cval_customer_c_name_0#8511, cval_customer_c_address#8497 AS cval_customer_c_address_0#8512, cval_customer_c_phone#8498 AS cval_customer_c_phone_0#8513, cval_customer_c_acctbal#8499 AS cval_customer_c_acctbal_0#8514, cval_customer_c_comment#8500 AS cval_customer_c_comment_0#8515, cval_customer_c_mktsegment#8501 AS cval_customer_c_mktsegment_0#8516, cc_name#8502 AS cc_name_0#8517, cc_address#8503 AS cc_address_0#8518, cc_phone#8504 AS cc_phone_0#8519, cc_acctbal#8505 AS cc_acctbal_0#8520, cc_comment#8506 AS cc_comment_0#8521, cc_mktsegment#8507 AS cc_mktsegment_0#8522]
         :  :  :  :  :  +- Relation[rid#8493,cpfk_nation_customer#8494,cfpk_customer_nation#8495,cval_customer_c_name#8496,cval_customer_c_address#8497,cval_customer_c_phone#8498,cval_customer_c_acctbal#8499,cval_customer_c_comment#8500,cval_customer_c_mktsegment#8501,cc_name#8502,cc_address#8503,cc_phone#8504,cc_acctbal#8505,cc_comment#8506,cc_mktsegment#8507] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#8523 AS rid_0#8538, cpfk_nation_customer#8524 AS cpfk_nation_customer_0#8539, cfpk_customer_nation#8525 AS cfpk_customer_nation_0#8540, cval_customer_c_name#8526 AS cval_customer_c_name_0#8541, cval_customer_c_address#8527 AS cval_customer_c_address_0#8542, cval_customer_c_phone#8528 AS cval_customer_c_phone_0#8543, cval_customer_c_acctbal#8529 AS cval_customer_c_acctbal_0#8544, cval_customer_c_comment#8530 AS cval_customer_c_comment_0#8545, cval_customer_c_mktsegment#8531 AS cval_customer_c_mktsegment_0#8546, cc_name#8532 AS cc_name_0#8547, cc_address#8533 AS cc_address_0#8548, cc_phone#8534 AS cc_phone_0#8549, cc_acctbal#8535 AS cc_acctbal_0#8550, cc_comment#8536 AS cc_comment_0#8551, cc_mktsegment#8537 AS cc_mktsegment_0#8552]
         :  :  :  :        +- Relation[rid#8523,cpfk_nation_customer#8524,cfpk_customer_nation#8525,cval_customer_c_name#8526,cval_customer_c_address#8527,cval_customer_c_phone#8528,cval_customer_c_acctbal#8529,cval_customer_c_comment#8530,cval_customer_c_mktsegment#8531,cc_name#8532,cc_address#8533,cc_phone#8534,cc_acctbal#8535,cc_comment#8536,cc_mktsegment#8537] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- Project [rid#8617 AS rid_1#8634, cpfk_customer_orders#8618 AS cpfk_customer_orders_1#8635, cfpk_orders_customer#8619 AS cfpk_orders_customer_1#8636, cval_orders_o_orderstatus#8620 AS cval_orders_o_orderstatus_1#8637, cval_orders_o_totalprice#8621 AS cval_orders_o_totalprice_1#8638, cval_orders_o_orderpriority#8622 AS cval_orders_o_orderpriority_1#8639, cval_orders_o_clerk#8623 AS cval_orders_o_clerk_1#8640, cval_orders_o_shippriority#8624 AS cval_orders_o_shippriority_1#8641, cval_orders_o_comment#8625 AS cval_orders_o_comment_1#8642, cval_orders_o_orderdate#8626 AS cval_orders_o_orderdate_1#8643, co_orderstatus#8627 AS co_orderstatus_1#8644, co_totalprice#8628 AS co_totalprice_1#8645, co_orderpriority#8629 AS co_orderpriority_1#8646, co_clerk#8630 AS co_clerk_1#8647, co_shippriority#8631 AS co_shippriority_1#8648, co_comment#8632 AS co_comment_1#8649, co_orderdate#8633 AS co_orderdate_1#8650]
         :  :  :     +- Relation[rid#8617,cpfk_customer_orders#8618,cfpk_orders_customer#8619,cval_orders_o_orderstatus#8620,cval_orders_o_totalprice#8621,cval_orders_o_orderpriority#8622,cval_orders_o_clerk#8623,cval_orders_o_shippriority#8624,cval_orders_o_comment#8625,cval_orders_o_orderdate#8626,co_orderstatus#8627,co_totalprice#8628,co_orderpriority#8629,co_clerk#8630,co_shippriority#8631,co_comment#8632,co_orderdate#8633] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#8553 AS rid_1#8570, cpfk_customer_orders#8554 AS cpfk_customer_orders_1#8571, cfpk_orders_customer#8555 AS cfpk_orders_customer_1#8572, cval_orders_o_orderstatus#8556 AS cval_orders_o_orderstatus_1#8573, cval_orders_o_totalprice#8557 AS cval_orders_o_totalprice_1#8574, cval_orders_o_orderpriority#8558 AS cval_orders_o_orderpriority_1#8575, cval_orders_o_clerk#8559 AS cval_orders_o_clerk_1#8576, cval_orders_o_shippriority#8560 AS cval_orders_o_shippriority_1#8577, cval_orders_o_comment#8561 AS cval_orders_o_comment_1#8578, cval_orders_o_orderdate#8562 AS cval_orders_o_orderdate_1#8579, co_orderstatus#8563 AS co_orderstatus_1#8580, co_totalprice#8564 AS co_totalprice_1#8581, co_orderpriority#8565 AS co_orderpriority_1#8582, co_clerk#8566 AS co_clerk_1#8583, co_shippriority#8567 AS co_shippriority_1#8584, co_comment#8568 AS co_comment_1#8585, co_orderdate#8569 AS co_orderdate_1#8586]
         :  :     +- Relation[rid#8553,cpfk_customer_orders#8554,cfpk_orders_customer#8555,cval_orders_o_orderstatus#8556,cval_orders_o_totalprice#8557,cval_orders_o_orderpriority#8558,cval_orders_o_clerk#8559,cval_orders_o_shippriority#8560,cval_orders_o_comment#8561,cval_orders_o_orderdate#8562,co_orderstatus#8563,co_totalprice#8564,co_orderpriority#8565,co_clerk#8566,co_shippriority#8567,co_comment#8568,co_orderdate#8569] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#8751 AS rid_2#8784, cpfk_orders_lineitem#8752 AS cpfk_orders_lineitem_2#8785, cpfk_supplier_lineitem#8753 AS cpfk_supplier_lineitem_2#8786, cfpk_lineitem_supplier#8754 AS cfpk_lineitem_supplier_2#8787, cfpk_lineitem_partsupp#8755 AS cfpk_lineitem_partsupp_2#8788, cpfk_part_lineitem#8756 AS cpfk_part_lineitem_2#8789, cfpk_lineitem_part#8757 AS cfpk_lineitem_part_2#8790, cpfk_partsupp_lineitem#8758 AS cpfk_partsupp_lineitem_2#8791, cfpk_lineitem_orders#8759 AS cfpk_lineitem_orders_2#8792, cval_lineitem_l_quantity#8760 AS cval_lineitem_l_quantity_2#8793, cval_lineitem_l_extendedprice#8761 AS cval_lineitem_l_extendedprice_2#8794, cval_lineitem_l_discount#8762 AS cval_lineitem_l_discount_2#8795, cval_lineitem_l_tax#8763 AS cval_lineitem_l_tax_2#8796, cval_lineitem_l_returnflag#8764 AS cval_lineitem_l_returnflag_2#8797, cval_lineitem_l_linestatus#8765 AS cval_lineitem_l_linestatus_2#8798, cval_lineitem_l_commitdate#8766 AS cval_lineitem_l_commitdate_2#8799, cval_lineitem_l_receiptdate#8767 AS cval_lineitem_l_receiptdate_2#8800, cval_lineitem_l_shipinstruct#8768 AS cval_lineitem_l_shipinstruct_2#8801, cval_lineitem_l_shipmode#8769 AS cval_lineitem_l_shipmode_2#8802, cval_lineitem_l_comment#8770 AS cval_lineitem_l_comment_2#8803, cval_lineitem_l_shipdate#8771 AS cval_lineitem_l_shipdate_2#8804, cl_quantity#8772 AS cl_quantity_2#8805, cl_extendedprice#8773 AS cl_extendedprice_2#8806, cl_discount#8774 AS cl_discount_2#8807, ... 9 more fields]
         :     +- Relation[rid#8751,cpfk_orders_lineitem#8752,cpfk_supplier_lineitem#8753,cfpk_lineitem_supplier#8754,cfpk_lineitem_partsupp#8755,cpfk_part_lineitem#8756,cfpk_lineitem_part#8757,cpfk_partsupp_lineitem#8758,cfpk_lineitem_orders#8759,cval_lineitem_l_quantity#8760,cval_lineitem_l_extendedprice#8761,cval_lineitem_l_discount#8762,cval_lineitem_l_tax#8763,cval_lineitem_l_returnflag#8764,cval_lineitem_l_linestatus#8765,cval_lineitem_l_commitdate#8766,cval_lineitem_l_receiptdate#8767,cval_lineitem_l_shipinstruct#8768,cval_lineitem_l_shipmode#8769,cval_lineitem_l_comment#8770,cval_lineitem_l_shipdate#8771,cl_quantity#8772,cl_extendedprice#8773,cl_discount#8774,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8651 AS rid_2#8684, cpfk_orders_lineitem#8652 AS cpfk_orders_lineitem_2#8685, cpfk_supplier_lineitem#8653 AS cpfk_supplier_lineitem_2#8686, cfpk_lineitem_supplier#8654 AS cfpk_lineitem_supplier_2#8687, cfpk_lineitem_partsupp#8655 AS cfpk_lineitem_partsupp_2#8688, cpfk_part_lineitem#8656 AS cpfk_part_lineitem_2#8689, cfpk_lineitem_part#8657 AS cfpk_lineitem_part_2#8690, cpfk_partsupp_lineitem#8658 AS cpfk_partsupp_lineitem_2#8691, cfpk_lineitem_orders#8659 AS cfpk_lineitem_orders_2#8692, cval_lineitem_l_quantity#8660 AS cval_lineitem_l_quantity_2#8693, cval_lineitem_l_extendedprice#8661 AS cval_lineitem_l_extendedprice_2#8694, cval_lineitem_l_discount#8662 AS cval_lineitem_l_discount_2#8695, cval_lineitem_l_tax#8663 AS cval_lineitem_l_tax_2#8696, cval_lineitem_l_returnflag#8664 AS cval_lineitem_l_returnflag_2#8697, cval_lineitem_l_linestatus#8665 AS cval_lineitem_l_linestatus_2#8698, cval_lineitem_l_commitdate#8666 AS cval_lineitem_l_commitdate_2#8699, cval_lineitem_l_receiptdate#8667 AS cval_lineitem_l_receiptdate_2#8700, cval_lineitem_l_shipinstruct#8668 AS cval_lineitem_l_shipinstruct_2#8701, cval_lineitem_l_shipmode#8669 AS cval_lineitem_l_shipmode_2#8702, cval_lineitem_l_comment#8670 AS cval_lineitem_l_comment_2#8703, cval_lineitem_l_shipdate#8671 AS cval_lineitem_l_shipdate_2#8704, cl_quantity#8672 AS cl_quantity_2#8705, cl_extendedprice#8673 AS cl_extendedprice_2#8706, cl_discount#8674 AS cl_discount_2#8707, ... 9 more fields]
            +- Relation[rid#8651,cpfk_orders_lineitem#8652,cpfk_supplier_lineitem#8653,cfpk_lineitem_supplier#8654,cfpk_lineitem_partsupp#8655,cpfk_part_lineitem#8656,cfpk_lineitem_part#8657,cpfk_partsupp_lineitem#8658,cfpk_lineitem_orders#8659,cval_lineitem_l_quantity#8660,cval_lineitem_l_extendedprice#8661,cval_lineitem_l_discount#8662,cval_lineitem_l_tax#8663,cval_lineitem_l_returnflag#8664,cval_lineitem_l_linestatus#8665,cval_lineitem_l_commitdate#8666,cval_lineitem_l_receiptdate#8667,cval_lineitem_l_shipinstruct#8668,cval_lineitem_l_shipmode#8669,cval_lineitem_l_comment#8670,cval_lineitem_l_shipdate#8671,cl_quantity#8672,cl_extendedprice#8673,cl_discount#8674,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=75006
Elapsed time: 6399ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/15 17:51:22 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:51:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8887L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 17:51:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:51:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:51:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:51:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:51:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:51:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:51:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:51:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:51:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:51:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 17:51:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:51:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 17:51:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:51:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8887L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#8889 AS rid_0#8906, cval_part_p_name#8890 AS cval_part_p_name_0#8907, cval_part_p_mfgr#8891 AS cval_part_p_mfgr_0#8908, cval_part_p_type#8892 AS cval_part_p_type_0#8909, cval_part_p_size#8893 AS cval_part_p_size_0#8910, cval_part_p_container#8894 AS cval_part_p_container_0#8911, cval_part_p_retailprice#8895 AS cval_part_p_retailprice_0#8912, cval_part_p_comment#8896 AS cval_part_p_comment_0#8913, cval_part_p_brand#8897 AS cval_part_p_brand_0#8914, cp_name#8898 AS cp_name_0#8915, cp_mfgr#8899 AS cp_mfgr_0#8916, cp_type#8900 AS cp_type_0#8917, cp_size#8901 AS cp_size_0#8918, cp_container#8902 AS cp_container_0#8919, cp_retailprice#8903 AS cp_retailprice_0#8920, cp_comment#8904 AS cp_comment_0#8921, cp_brand#8905 AS cp_brand_0#8922]
            :  :  :  :  +- Relation[rid#8889,cval_part_p_name#8890,cval_part_p_mfgr#8891,cval_part_p_type#8892,cval_part_p_size#8893,cval_part_p_container#8894,cval_part_p_retailprice#8895,cval_part_p_comment#8896,cval_part_p_brand#8897,cp_name#8898,cp_mfgr#8899,cp_type#8900,cp_size#8901,cp_container#8902,cp_retailprice#8903,cp_comment#8904,cp_brand#8905] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#8923 AS rid_0#8940, cval_part_p_name#8924 AS cval_part_p_name_0#8941, cval_part_p_mfgr#8925 AS cval_part_p_mfgr_0#8942, cval_part_p_type#8926 AS cval_part_p_type_0#8943, cval_part_p_size#8927 AS cval_part_p_size_0#8944, cval_part_p_container#8928 AS cval_part_p_container_0#8945, cval_part_p_retailprice#8929 AS cval_part_p_retailprice_0#8946, cval_part_p_comment#8930 AS cval_part_p_comment_0#8947, cval_part_p_brand#8931 AS cval_part_p_brand_0#8948, cp_name#8932 AS cp_name_0#8949, cp_mfgr#8933 AS cp_mfgr_0#8950, cp_type#8934 AS cp_type_0#8951, cp_size#8935 AS cp_size_0#8952, cp_container#8936 AS cp_container_0#8953, cp_retailprice#8937 AS cp_retailprice_0#8954, cp_comment#8938 AS cp_comment_0#8955, cp_brand#8939 AS cp_brand_0#8956]
            :  :  :        +- Relation[rid#8923,cval_part_p_name#8924,cval_part_p_mfgr#8925,cval_part_p_type#8926,cval_part_p_size#8927,cval_part_p_container#8928,cval_part_p_retailprice#8929,cval_part_p_comment#8930,cval_part_p_brand#8931,cp_name#8932,cp_mfgr#8933,cp_type#8934,cp_size#8935,cp_container#8936,cp_retailprice#8937,cp_comment#8938,cp_brand#8939] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- Project [rid#9013 AS rid_1#9024, cpfk_part_partsupp#9014 AS cpfk_part_partsupp_1#9025, cfpk_partsupp_part#9015 AS cfpk_partsupp_part_1#9026, cpfk_supplier_partsupp#9016 AS cpfk_supplier_partsupp_1#9027, cfpk_partsupp_supplier#9017 AS cfpk_partsupp_supplier_1#9028, cval_partsupp_ps_availqty#9018 AS cval_partsupp_ps_availqty_1#9029, cval_partsupp_ps_supplycost#9019 AS cval_partsupp_ps_supplycost_1#9030, cval_partsupp_ps_comment#9020 AS cval_partsupp_ps_comment_1#9031, cps_availqty#9021 AS cps_availqty_1#9032, cps_supplycost#9022 AS cps_supplycost_1#9033, cps_comment#9023 AS cps_comment_1#9034]
            :  :     +- Relation[rid#9013,cpfk_part_partsupp#9014,cfpk_partsupp_part#9015,cpfk_supplier_partsupp#9016,cfpk_partsupp_supplier#9017,cval_partsupp_ps_availqty#9018,cval_partsupp_ps_supplycost#9019,cval_partsupp_ps_comment#9020,cps_availqty#9021,cps_supplycost#9022,cps_comment#9023] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#8957 AS rid_1#8968, cpfk_part_partsupp#8958 AS cpfk_part_partsupp_1#8969, cfpk_partsupp_part#8959 AS cfpk_partsupp_part_1#8970, cpfk_supplier_partsupp#8960 AS cpfk_supplier_partsupp_1#8971, cfpk_partsupp_supplier#8961 AS cfpk_partsupp_supplier_1#8972, cval_partsupp_ps_availqty#8962 AS cval_partsupp_ps_availqty_1#8973, cval_partsupp_ps_supplycost#8963 AS cval_partsupp_ps_supplycost_1#8974, cval_partsupp_ps_comment#8964 AS cval_partsupp_ps_comment_1#8975, cps_availqty#8965 AS cps_availqty_1#8976, cps_supplycost#8966 AS cps_supplycost_1#8977, cps_comment#8967 AS cps_comment_1#8978]
            :     +- Relation[rid#8957,cpfk_part_partsupp#8958,cfpk_partsupp_part#8959,cpfk_supplier_partsupp#8960,cfpk_partsupp_supplier#8961,cval_partsupp_ps_availqty#8962,cval_partsupp_ps_supplycost#8963,cval_partsupp_ps_comment#8964,cps_availqty#8965,cps_supplycost#8966,cps_comment#8967] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#9035 AS rid_2#9042, cpfk_region_nation#9036 AS cpfk_region_nation_2#9043, cfpk_nation_region#9037 AS cfpk_nation_region_2#9044, cval_nation_n_name#9038 AS cval_nation_n_name_2#9045, cval_nation_n_comment#9039 AS cval_nation_n_comment_2#9046, cn_name#9040 AS cn_name_2#9047, cn_comment#9041 AS cn_comment_2#9048]
               :  :  :  +- Relation[rid#9035,cpfk_region_nation#9036,cfpk_nation_region#9037,cval_nation_n_name#9038,cval_nation_n_comment#9039,cn_name#9040,cn_comment#9041] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#9049 AS rid_2#9056, cpfk_region_nation#9050 AS cpfk_region_nation_2#9057, cfpk_nation_region#9051 AS cfpk_nation_region_2#9058, cval_nation_n_name#9052 AS cval_nation_n_name_2#9059, cval_nation_n_comment#9053 AS cval_nation_n_comment_2#9060, cn_name#9054 AS cn_name_2#9061, cn_comment#9055 AS cn_comment_2#9062]
               :  :        +- Relation[rid#9049,cpfk_region_nation#9050,cfpk_nation_region#9051,cval_nation_n_name#9052,cval_nation_n_comment#9053,cn_name#9054,cn_comment#9055] JDBCRelation(tnation) [numPartitions=1]
               :  +- Project [rid#9103 AS rid_3#9116, cpfk_nation_supplier#9104 AS cpfk_nation_supplier_3#9117, cfpk_supplier_nation#9105 AS cfpk_supplier_nation_3#9118, cval_supplier_s_name#9106 AS cval_supplier_s_name_3#9119, cval_supplier_s_address#9107 AS cval_supplier_s_address_3#9120, cval_supplier_s_phone#9108 AS cval_supplier_s_phone_3#9121, cval_supplier_s_acctbal#9109 AS cval_supplier_s_acctbal_3#9122, cval_supplier_s_comment#9110 AS cval_supplier_s_comment_3#9123, cs_name#9111 AS cs_name_3#9124, cs_address#9112 AS cs_address_3#9125, cs_phone#9113 AS cs_phone_3#9126, cs_acctbal#9114 AS cs_acctbal_3#9127, cs_comment#9115 AS cs_comment_3#9128]
               :     +- Relation[rid#9103,cpfk_nation_supplier#9104,cfpk_supplier_nation#9105,cval_supplier_s_name#9106,cval_supplier_s_address#9107,cval_supplier_s_phone#9108,cval_supplier_s_acctbal#9109,cval_supplier_s_comment#9110,cs_name#9111,cs_address#9112,cs_phone#9113,cs_acctbal#9114,cs_comment#9115] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#9063 AS rid_3#9076, cpfk_nation_supplier#9064 AS cpfk_nation_supplier_3#9077, cfpk_supplier_nation#9065 AS cfpk_supplier_nation_3#9078, cval_supplier_s_name#9066 AS cval_supplier_s_name_3#9079, cval_supplier_s_address#9067 AS cval_supplier_s_address_3#9080, cval_supplier_s_phone#9068 AS cval_supplier_s_phone_3#9081, cval_supplier_s_acctbal#9069 AS cval_supplier_s_acctbal_3#9082, cval_supplier_s_comment#9070 AS cval_supplier_s_comment_3#9083, cs_name#9071 AS cs_name_3#9084, cs_address#9072 AS cs_address_3#9085, cs_phone#9073 AS cs_phone_3#9086, cs_acctbal#9074 AS cs_acctbal_3#9087, cs_comment#9075 AS cs_comment_3#9088]
                  +- Relation[rid#9063,cpfk_nation_supplier#9064,cfpk_supplier_nation#9065,cval_supplier_s_name#9066,cval_supplier_s_address#9067,cval_supplier_s_phone#9068,cval_supplier_s_acctbal#9069,cval_supplier_s_comment#9070,cs_name#9071,cs_address#9072,cs_phone#9073,cs_acctbal#9074,cs_comment#9075] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=326
Elapsed time: 824ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/15 17:51:23 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 17:51:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9184L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 17:51:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:51:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:51:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 17:51:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9184L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#9186 AS rid_0#9199, cpfk_nation_supplier#9187 AS cpfk_nation_supplier_0#9200, cfpk_supplier_nation#9188 AS cfpk_supplier_nation_0#9201, cval_supplier_s_name#9189 AS cval_supplier_s_name_0#9202, cval_supplier_s_address#9190 AS cval_supplier_s_address_0#9203, cval_supplier_s_phone#9191 AS cval_supplier_s_phone_0#9204, cval_supplier_s_acctbal#9192 AS cval_supplier_s_acctbal_0#9205, cval_supplier_s_comment#9193 AS cval_supplier_s_comment_0#9206, cs_name#9194 AS cs_name_0#9207, cs_address#9195 AS cs_address_0#9208, cs_phone#9196 AS cs_phone_0#9209, cs_acctbal#9197 AS cs_acctbal_0#9210, cs_comment#9198 AS cs_comment_0#9211]
         :  :  +- Relation[rid#9186,cpfk_nation_supplier#9187,cfpk_supplier_nation#9188,cval_supplier_s_name#9189,cval_supplier_s_address#9190,cval_supplier_s_phone#9191,cval_supplier_s_acctbal#9192,cval_supplier_s_comment#9193,cs_name#9194,cs_address#9195,cs_phone#9196,cs_acctbal#9197,cs_comment#9198] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#9278 AS rid_0#9291, cpfk_nation_supplier#9279 AS cpfk_nation_supplier_0#9292, cfpk_supplier_nation#9280 AS cfpk_supplier_nation_0#9293, cval_supplier_s_name#9281 AS cval_supplier_s_name_0#9294, cval_supplier_s_address#9282 AS cval_supplier_s_address_0#9295, cval_supplier_s_phone#9283 AS cval_supplier_s_phone_0#9296, cval_supplier_s_acctbal#9284 AS cval_supplier_s_acctbal_0#9297, cval_supplier_s_comment#9285 AS cval_supplier_s_comment_0#9298, cs_name#9286 AS cs_name_0#9299, cs_address#9287 AS cs_address_0#9300, cs_phone#9288 AS cs_phone_0#9301, cs_acctbal#9289 AS cs_acctbal_0#9302, cs_comment#9290 AS cs_comment_0#9303]
         :     :  +- Relation[rid#9278,cpfk_nation_supplier#9279,cfpk_supplier_nation#9280,cval_supplier_s_name#9281,cval_supplier_s_address#9282,cval_supplier_s_phone#9283,cval_supplier_s_acctbal#9284,cval_supplier_s_comment#9285,cs_name#9286,cs_address#9287,cs_phone#9288,cs_acctbal#9289,cs_comment#9290] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#9304 AS rid_1#9337, cpfk_orders_lineitem#9305 AS cpfk_orders_lineitem_1#9338, cpfk_supplier_lineitem#9306 AS cpfk_supplier_lineitem_1#9339, cfpk_lineitem_supplier#9307 AS cfpk_lineitem_supplier_1#9340, cfpk_lineitem_partsupp#9308 AS cfpk_lineitem_partsupp_1#9341, cpfk_part_lineitem#9309 AS cpfk_part_lineitem_1#9342, cfpk_lineitem_part#9310 AS cfpk_lineitem_part_1#9343, cpfk_partsupp_lineitem#9311 AS cpfk_partsupp_lineitem_1#9344, cfpk_lineitem_orders#9312 AS cfpk_lineitem_orders_1#9345, cval_lineitem_l_quantity#9313 AS cval_lineitem_l_quantity_1#9346, cval_lineitem_l_extendedprice#9314 AS cval_lineitem_l_extendedprice_1#9347, cval_lineitem_l_discount#9315 AS cval_lineitem_l_discount_1#9348, cval_lineitem_l_tax#9316 AS cval_lineitem_l_tax_1#9349, cval_lineitem_l_returnflag#9317 AS cval_lineitem_l_returnflag_1#9350, cval_lineitem_l_linestatus#9318 AS cval_lineitem_l_linestatus_1#9351, cval_lineitem_l_commitdate#9319 AS cval_lineitem_l_commitdate_1#9352, cval_lineitem_l_receiptdate#9320 AS cval_lineitem_l_receiptdate_1#9353, cval_lineitem_l_shipinstruct#9321 AS cval_lineitem_l_shipinstruct_1#9354, cval_lineitem_l_shipmode#9322 AS cval_lineitem_l_shipmode_1#9355, cval_lineitem_l_comment#9323 AS cval_lineitem_l_comment_1#9356, cval_lineitem_l_shipdate#9324 AS cval_lineitem_l_shipdate_1#9357, cl_quantity#9325 AS cl_quantity_1#9358, cl_extendedprice#9326 AS cl_extendedprice_1#9359, cl_discount#9327 AS cl_discount_1#9360, ... 9 more fields]
         :        +- Relation[rid#9304,cpfk_orders_lineitem#9305,cpfk_supplier_lineitem#9306,cfpk_lineitem_supplier#9307,cfpk_lineitem_partsupp#9308,cpfk_part_lineitem#9309,cfpk_lineitem_part#9310,cpfk_partsupp_lineitem#9311,cfpk_lineitem_orders#9312,cval_lineitem_l_quantity#9313,cval_lineitem_l_extendedprice#9314,cval_lineitem_l_discount#9315,cval_lineitem_l_tax#9316,cval_lineitem_l_returnflag#9317,cval_lineitem_l_linestatus#9318,cval_lineitem_l_commitdate#9319,cval_lineitem_l_receiptdate#9320,cval_lineitem_l_shipinstruct#9321,cval_lineitem_l_shipmode#9322,cval_lineitem_l_comment#9323,cval_lineitem_l_shipdate#9324,cl_quantity#9325,cl_extendedprice#9326,cl_discount#9327,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#9212 AS rid_1#9245, cpfk_orders_lineitem#9213 AS cpfk_orders_lineitem_1#9246, cpfk_supplier_lineitem#9214 AS cpfk_supplier_lineitem_1#9247, cfpk_lineitem_supplier#9215 AS cfpk_lineitem_supplier_1#9248, cfpk_lineitem_partsupp#9216 AS cfpk_lineitem_partsupp_1#9249, cpfk_part_lineitem#9217 AS cpfk_part_lineitem_1#9250, cfpk_lineitem_part#9218 AS cfpk_lineitem_part_1#9251, cpfk_partsupp_lineitem#9219 AS cpfk_partsupp_lineitem_1#9252, cfpk_lineitem_orders#9220 AS cfpk_lineitem_orders_1#9253, cval_lineitem_l_quantity#9221 AS cval_lineitem_l_quantity_1#9254, cval_lineitem_l_extendedprice#9222 AS cval_lineitem_l_extendedprice_1#9255, cval_lineitem_l_discount#9223 AS cval_lineitem_l_discount_1#9256, cval_lineitem_l_tax#9224 AS cval_lineitem_l_tax_1#9257, cval_lineitem_l_returnflag#9225 AS cval_lineitem_l_returnflag_1#9258, cval_lineitem_l_linestatus#9226 AS cval_lineitem_l_linestatus_1#9259, cval_lineitem_l_commitdate#9227 AS cval_lineitem_l_commitdate_1#9260, cval_lineitem_l_receiptdate#9228 AS cval_lineitem_l_receiptdate_1#9261, cval_lineitem_l_shipinstruct#9229 AS cval_lineitem_l_shipinstruct_1#9262, cval_lineitem_l_shipmode#9230 AS cval_lineitem_l_shipmode_1#9263, cval_lineitem_l_comment#9231 AS cval_lineitem_l_comment_1#9264, cval_lineitem_l_shipdate#9232 AS cval_lineitem_l_shipdate_1#9265, cl_quantity#9233 AS cl_quantity_1#9266, cl_extendedprice#9234 AS cl_extendedprice_1#9267, cl_discount#9235 AS cl_discount_1#9268, ... 9 more fields]
            +- Relation[rid#9212,cpfk_orders_lineitem#9213,cpfk_supplier_lineitem#9214,cfpk_lineitem_supplier#9215,cfpk_lineitem_partsupp#9216,cpfk_part_lineitem#9217,cfpk_lineitem_part#9218,cpfk_partsupp_lineitem#9219,cfpk_lineitem_orders#9220,cval_lineitem_l_quantity#9221,cval_lineitem_l_extendedprice#9222,cval_lineitem_l_discount#9223,cval_lineitem_l_tax#9224,cval_lineitem_l_returnflag#9225,cval_lineitem_l_linestatus#9226,cval_lineitem_l_commitdate#9227,cval_lineitem_l_receiptdate#9228,cval_lineitem_l_shipinstruct#9229,cval_lineitem_l_shipmode#9230,cval_lineitem_l_comment#9231,cval_lineitem_l_shipdate#9232,cl_quantity#9233,cl_extendedprice#9234,cl_discount#9235,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 94634ms
query=q1, count=6001215, duration=2731
query=q10, count=1478870, duration=67633
query=q11, count=4, duration=1212
query=q12, count=857401, duration=25554
query=q13, count=1500000, duration=14102
query=q14, count=6001215, duration=93153
query=q15, count=6001215, duration=94634
query=q16, count=7890, duration=1082
query=q17, count=6088, duration=630
query=q18, count=6001215, duration=139336
query=q19, count=13, duration=63616
query=q2, count=0, duration=1743
query=q20, count=326, duration=824
query=q21a, count=120762, duration=97660
query=q22, count=1500000, duration=13725
query=q3, count=75006, duration=6399
query=q4, count=6001215, duration=56586
query=q5, count=1, duration=23214
query=q6, count=6001215, duration=2868
query=q7, count=0, duration=401
query=q8, count=0, duration=2107
query=q9a, count=6001215, duration=268226
query=q9b, count=6001215, duration=187871
