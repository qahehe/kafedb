20/04/15 14:59:34 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 12433ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Apr 15 14:59:37 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Apr 15 14:59:39 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Apr 15 14:59:39 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Apr 15 14:59:39 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Apr 15 14:59:39 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Apr 15 14:59:44 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Apr 15 14:59:48 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Apr 15 14:59:48 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/15 14:59:50 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 14:59:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2078L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 14:59:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:59:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:59:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:59:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:59:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:59:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 14:59:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 14:59:51 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/15 14:59:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2078L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#2080 AS rid_0#2113, cpfk_orders_lineitem#2081 AS cpfk_orders_lineitem_0#2114, cpfk_supplier_lineitem#2082 AS cpfk_supplier_lineitem_0#2115, cfpk_lineitem_supplier#2083 AS cfpk_lineitem_supplier_0#2116, cfpk_lineitem_partsupp#2084 AS cfpk_lineitem_partsupp_0#2117, cpfk_part_lineitem#2085 AS cpfk_part_lineitem_0#2118, cfpk_lineitem_part#2086 AS cfpk_lineitem_part_0#2119, cpfk_partsupp_lineitem#2087 AS cpfk_partsupp_lineitem_0#2120, cfpk_lineitem_orders#2088 AS cfpk_lineitem_orders_0#2121, cval_lineitem_l_quantity#2089 AS cval_lineitem_l_quantity_0#2122, cval_lineitem_l_extendedprice#2090 AS cval_lineitem_l_extendedprice_0#2123, cval_lineitem_l_discount#2091 AS cval_lineitem_l_discount_0#2124, cval_lineitem_l_tax#2092 AS cval_lineitem_l_tax_0#2125, cval_lineitem_l_returnflag#2093 AS cval_lineitem_l_returnflag_0#2126, cval_lineitem_l_linestatus#2094 AS cval_lineitem_l_linestatus_0#2127, cval_lineitem_l_commitdate#2095 AS cval_lineitem_l_commitdate_0#2128, cval_lineitem_l_receiptdate#2096 AS cval_lineitem_l_receiptdate_0#2129, cval_lineitem_l_shipinstruct#2097 AS cval_lineitem_l_shipinstruct_0#2130, cval_lineitem_l_shipmode#2098 AS cval_lineitem_l_shipmode_0#2131, cval_lineitem_l_comment#2099 AS cval_lineitem_l_comment_0#2132, cval_lineitem_l_shipdate#2100 AS cval_lineitem_l_shipdate_0#2133, cl_quantity#2101 AS cl_quantity_0#2134, cl_extendedprice#2102 AS cl_extendedprice_0#2135, cl_discount#2103 AS cl_discount_0#2136, ... 9 more fields]
            :  +- Relation[rid#2080,cpfk_orders_lineitem#2081,cpfk_supplier_lineitem#2082,cfpk_lineitem_supplier#2083,cfpk_lineitem_partsupp#2084,cpfk_part_lineitem#2085,cfpk_lineitem_part#2086,cpfk_partsupp_lineitem#2087,cfpk_lineitem_orders#2088,cval_lineitem_l_quantity#2089,cval_lineitem_l_extendedprice#2090,cval_lineitem_l_discount#2091,cval_lineitem_l_tax#2092,cval_lineitem_l_returnflag#2093,cval_lineitem_l_linestatus#2094,cval_lineitem_l_commitdate#2095,cval_lineitem_l_receiptdate#2096,cval_lineitem_l_shipinstruct#2097,cval_lineitem_l_shipmode#2098,cval_lineitem_l_comment#2099,cval_lineitem_l_shipdate#2100,cl_quantity#2101,cl_extendedprice#2102,cl_discount#2103,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#2146 AS rid_1#2163, cpfk_customer_orders#2147 AS cpfk_customer_orders_1#2164, cfpk_orders_customer#2148 AS cfpk_orders_customer_1#2165, cval_orders_o_orderstatus#2149 AS cval_orders_o_orderstatus_1#2166, cval_orders_o_totalprice#2150 AS cval_orders_o_totalprice_1#2167, cval_orders_o_orderpriority#2151 AS cval_orders_o_orderpriority_1#2168, cval_orders_o_clerk#2152 AS cval_orders_o_clerk_1#2169, cval_orders_o_shippriority#2153 AS cval_orders_o_shippriority_1#2170, cval_orders_o_comment#2154 AS cval_orders_o_comment_1#2171, cval_orders_o_orderdate#2155 AS cval_orders_o_orderdate_1#2172, co_orderstatus#2156 AS co_orderstatus_1#2173, co_totalprice#2157 AS co_totalprice_1#2174, co_orderpriority#2158 AS co_orderpriority_1#2175, co_clerk#2159 AS co_clerk_1#2176, co_shippriority#2160 AS co_shippriority_1#2177, co_comment#2161 AS co_comment_1#2178, co_orderdate#2162 AS co_orderdate_1#2179]
                  :     :  :  :  :  +- Relation[rid#2146,cpfk_customer_orders#2147,cfpk_orders_customer#2148,cval_orders_o_orderstatus#2149,cval_orders_o_totalprice#2150,cval_orders_o_orderpriority#2151,cval_orders_o_clerk#2152,cval_orders_o_shippriority#2153,cval_orders_o_comment#2154,cval_orders_o_orderdate#2155,co_orderstatus#2156,co_totalprice#2157,co_orderpriority#2158,co_clerk#2159,co_shippriority#2160,co_comment#2161,co_orderdate#2162] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#2180 AS rid_1#2197, cpfk_customer_orders#2181 AS cpfk_customer_orders_1#2198, cfpk_orders_customer#2182 AS cfpk_orders_customer_1#2199, cval_orders_o_orderstatus#2183 AS cval_orders_o_orderstatus_1#2200, cval_orders_o_totalprice#2184 AS cval_orders_o_totalprice_1#2201, cval_orders_o_orderpriority#2185 AS cval_orders_o_orderpriority_1#2202, cval_orders_o_clerk#2186 AS cval_orders_o_clerk_1#2203, cval_orders_o_shippriority#2187 AS cval_orders_o_shippriority_1#2204, cval_orders_o_comment#2188 AS cval_orders_o_comment_1#2205, cval_orders_o_orderdate#2189 AS cval_orders_o_orderdate_1#2206, co_orderstatus#2190 AS co_orderstatus_1#2207, co_totalprice#2191 AS co_totalprice_1#2208, co_orderpriority#2192 AS co_orderpriority_1#2209, co_clerk#2193 AS co_clerk_1#2210, co_shippriority#2194 AS co_shippriority_1#2211, co_comment#2195 AS co_comment_1#2212, co_orderdate#2196 AS co_orderdate_1#2213]
                  :     :  :  :        +- Relation[rid#2180,cpfk_customer_orders#2181,cfpk_orders_customer#2182,cval_orders_o_orderstatus#2183,cval_orders_o_totalprice#2184,cval_orders_o_orderpriority#2185,cval_orders_o_clerk#2186,cval_orders_o_shippriority#2187,cval_orders_o_comment#2188,cval_orders_o_orderdate#2189,co_orderstatus#2190,co_totalprice#2191,co_orderpriority#2192,co_clerk#2193,co_shippriority#2194,co_comment#2195,co_orderdate#2196] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- Project [rid#2314 AS rid_2#2347, cpfk_orders_lineitem#2315 AS cpfk_orders_lineitem_2#2348, cpfk_supplier_lineitem#2316 AS cpfk_supplier_lineitem_2#2349, cfpk_lineitem_supplier#2317 AS cfpk_lineitem_supplier_2#2350, cfpk_lineitem_partsupp#2318 AS cfpk_lineitem_partsupp_2#2351, cpfk_part_lineitem#2319 AS cpfk_part_lineitem_2#2352, cfpk_lineitem_part#2320 AS cfpk_lineitem_part_2#2353, cpfk_partsupp_lineitem#2321 AS cpfk_partsupp_lineitem_2#2354, cfpk_lineitem_orders#2322 AS cfpk_lineitem_orders_2#2355, cval_lineitem_l_quantity#2323 AS cval_lineitem_l_quantity_2#2356, cval_lineitem_l_extendedprice#2324 AS cval_lineitem_l_extendedprice_2#2357, cval_lineitem_l_discount#2325 AS cval_lineitem_l_discount_2#2358, cval_lineitem_l_tax#2326 AS cval_lineitem_l_tax_2#2359, cval_lineitem_l_returnflag#2327 AS cval_lineitem_l_returnflag_2#2360, cval_lineitem_l_linestatus#2328 AS cval_lineitem_l_linestatus_2#2361, cval_lineitem_l_commitdate#2329 AS cval_lineitem_l_commitdate_2#2362, cval_lineitem_l_receiptdate#2330 AS cval_lineitem_l_receiptdate_2#2363, cval_lineitem_l_shipinstruct#2331 AS cval_lineitem_l_shipinstruct_2#2364, cval_lineitem_l_shipmode#2332 AS cval_lineitem_l_shipmode_2#2365, cval_lineitem_l_comment#2333 AS cval_lineitem_l_comment_2#2366, cval_lineitem_l_shipdate#2334 AS cval_lineitem_l_shipdate_2#2367, cl_quantity#2335 AS cl_quantity_2#2368, cl_extendedprice#2336 AS cl_extendedprice_2#2369, cl_discount#2337 AS cl_discount_2#2370, ... 9 more fields]
                  :     :  :     +- Relation[rid#2314,cpfk_orders_lineitem#2315,cpfk_supplier_lineitem#2316,cfpk_lineitem_supplier#2317,cfpk_lineitem_partsupp#2318,cpfk_part_lineitem#2319,cfpk_lineitem_part#2320,cpfk_partsupp_lineitem#2321,cfpk_lineitem_orders#2322,cval_lineitem_l_quantity#2323,cval_lineitem_l_extendedprice#2324,cval_lineitem_l_discount#2325,cval_lineitem_l_tax#2326,cval_lineitem_l_returnflag#2327,cval_lineitem_l_linestatus#2328,cval_lineitem_l_commitdate#2329,cval_lineitem_l_receiptdate#2330,cval_lineitem_l_shipinstruct#2331,cval_lineitem_l_shipmode#2332,cval_lineitem_l_comment#2333,cval_lineitem_l_shipdate#2334,cl_quantity#2335,cl_extendedprice#2336,cl_discount#2337,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#2214 AS rid_2#2247, cpfk_orders_lineitem#2215 AS cpfk_orders_lineitem_2#2248, cpfk_supplier_lineitem#2216 AS cpfk_supplier_lineitem_2#2249, cfpk_lineitem_supplier#2217 AS cfpk_lineitem_supplier_2#2250, cfpk_lineitem_partsupp#2218 AS cfpk_lineitem_partsupp_2#2251, cpfk_part_lineitem#2219 AS cpfk_part_lineitem_2#2252, cfpk_lineitem_part#2220 AS cfpk_lineitem_part_2#2253, cpfk_partsupp_lineitem#2221 AS cpfk_partsupp_lineitem_2#2254, cfpk_lineitem_orders#2222 AS cfpk_lineitem_orders_2#2255, cval_lineitem_l_quantity#2223 AS cval_lineitem_l_quantity_2#2256, cval_lineitem_l_extendedprice#2224 AS cval_lineitem_l_extendedprice_2#2257, cval_lineitem_l_discount#2225 AS cval_lineitem_l_discount_2#2258, cval_lineitem_l_tax#2226 AS cval_lineitem_l_tax_2#2259, cval_lineitem_l_returnflag#2227 AS cval_lineitem_l_returnflag_2#2260, cval_lineitem_l_linestatus#2228 AS cval_lineitem_l_linestatus_2#2261, cval_lineitem_l_commitdate#2229 AS cval_lineitem_l_commitdate_2#2262, cval_lineitem_l_receiptdate#2230 AS cval_lineitem_l_receiptdate_2#2263, cval_lineitem_l_shipinstruct#2231 AS cval_lineitem_l_shipinstruct_2#2264, cval_lineitem_l_shipmode#2232 AS cval_lineitem_l_shipmode_2#2265, cval_lineitem_l_comment#2233 AS cval_lineitem_l_comment_2#2266, cval_lineitem_l_shipdate#2234 AS cval_lineitem_l_shipdate_2#2267, cl_quantity#2235 AS cl_quantity_2#2268, cl_extendedprice#2236 AS cl_extendedprice_2#2269, cl_discount#2237 AS cl_discount_2#2270, ... 9 more fields]
                  :     :     +- Relation[rid#2214,cpfk_orders_lineitem#2215,cpfk_supplier_lineitem#2216,cfpk_lineitem_supplier#2217,cfpk_lineitem_partsupp#2218,cpfk_part_lineitem#2219,cfpk_lineitem_part#2220,cpfk_partsupp_lineitem#2221,cfpk_lineitem_orders#2222,cval_lineitem_l_quantity#2223,cval_lineitem_l_extendedprice#2224,cval_lineitem_l_discount#2225,cval_lineitem_l_tax#2226,cval_lineitem_l_returnflag#2227,cval_lineitem_l_linestatus#2228,cval_lineitem_l_commitdate#2229,cval_lineitem_l_receiptdate#2230,cval_lineitem_l_shipinstruct#2231,cval_lineitem_l_shipmode#2232,cval_lineitem_l_comment#2233,cval_lineitem_l_shipdate#2234,cl_quantity#2235,cl_extendedprice#2236,cl_discount#2237,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#2380 AS rid_3#2393, cpfk_nation_supplier#2381 AS cpfk_nation_supplier_3#2394, cfpk_supplier_nation#2382 AS cfpk_supplier_nation_3#2395, cval_supplier_s_name#2383 AS cval_supplier_s_name_3#2396, cval_supplier_s_address#2384 AS cval_supplier_s_address_3#2397, cval_supplier_s_phone#2385 AS cval_supplier_s_phone_3#2398, cval_supplier_s_acctbal#2386 AS cval_supplier_s_acctbal_3#2399, cval_supplier_s_comment#2387 AS cval_supplier_s_comment_3#2400, cs_name#2388 AS cs_name_3#2401, cs_address#2389 AS cs_address_3#2402, cs_phone#2390 AS cs_phone_3#2403, cs_acctbal#2391 AS cs_acctbal_3#2404, cs_comment#2392 AS cs_comment_3#2405]
                  :        +- Relation[rid#2380,cpfk_nation_supplier#2381,cfpk_supplier_nation#2382,cval_supplier_s_name#2383,cval_supplier_s_address#2384,cval_supplier_s_phone#2385,cval_supplier_s_acctbal#2386,cval_supplier_s_comment#2387,cs_name#2388,cs_address#2389,cs_phone#2390,cs_acctbal#2391,cs_comment#2392] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#2406 AS rid_4#2413, cpfk_region_nation#2407 AS cpfk_region_nation_4#2414, cfpk_nation_region#2408 AS cfpk_nation_region_4#2415, cval_nation_n_name#2409 AS cval_nation_n_name_4#2416, cval_nation_n_comment#2410 AS cval_nation_n_comment_4#2417, cn_name#2411 AS cn_name_4#2418, cn_comment#2412 AS cn_comment_4#2419]
                     :  +- Relation[rid#2406,cpfk_region_nation#2407,cfpk_nation_region#2408,cval_nation_n_name#2409,cval_nation_n_comment#2410,cn_name#2411,cn_comment#2412] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#2420 AS rid_4#2427, cpfk_region_nation#2421 AS cpfk_region_nation_4#2428, cfpk_nation_region#2422 AS cfpk_nation_region_4#2429, cval_nation_n_name#2423 AS cval_nation_n_name_4#2430, cval_nation_n_comment#2424 AS cval_nation_n_comment_4#2431, cn_name#2425 AS cn_name_4#2432, cn_comment#2426 AS cn_comment_4#2433]
                           +- Relation[rid#2420,cpfk_region_nation#2421,cfpk_nation_region#2422,cval_nation_n_name#2423,cval_nation_n_comment#2424,cn_name#2425,cn_comment#2426] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=120762
Elapsed time: 92741ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/15 15:01:23 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:01:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2542L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:01:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#2542L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#2544 AS rid_0#2577, cpfk_orders_lineitem#2545 AS cpfk_orders_lineitem_0#2578, cpfk_supplier_lineitem#2546 AS cpfk_supplier_lineitem_0#2579, cfpk_lineitem_supplier#2547 AS cfpk_lineitem_supplier_0#2580, cfpk_lineitem_partsupp#2548 AS cfpk_lineitem_partsupp_0#2581, cpfk_part_lineitem#2549 AS cpfk_part_lineitem_0#2582, cfpk_lineitem_part#2550 AS cfpk_lineitem_part_0#2583, cpfk_partsupp_lineitem#2551 AS cpfk_partsupp_lineitem_0#2584, cfpk_lineitem_orders#2552 AS cfpk_lineitem_orders_0#2585, cval_lineitem_l_quantity#2553 AS cval_lineitem_l_quantity_0#2586, cval_lineitem_l_extendedprice#2554 AS cval_lineitem_l_extendedprice_0#2587, cval_lineitem_l_discount#2555 AS cval_lineitem_l_discount_0#2588, cval_lineitem_l_tax#2556 AS cval_lineitem_l_tax_0#2589, cval_lineitem_l_returnflag#2557 AS cval_lineitem_l_returnflag_0#2590, cval_lineitem_l_linestatus#2558 AS cval_lineitem_l_linestatus_0#2591, cval_lineitem_l_commitdate#2559 AS cval_lineitem_l_commitdate_0#2592, cval_lineitem_l_receiptdate#2560 AS cval_lineitem_l_receiptdate_0#2593, cval_lineitem_l_shipinstruct#2561 AS cval_lineitem_l_shipinstruct_0#2594, cval_lineitem_l_shipmode#2562 AS cval_lineitem_l_shipmode_0#2595, cval_lineitem_l_comment#2563 AS cval_lineitem_l_comment_0#2596, cval_lineitem_l_shipdate#2564 AS cval_lineitem_l_shipdate_0#2597, cl_quantity#2565 AS cl_quantity_0#2598, cl_extendedprice#2566 AS cl_extendedprice_0#2599, cl_discount#2567 AS cl_discount_0#2600, ... 9 more fields]
         +- Relation[rid#2544,cpfk_orders_lineitem#2545,cpfk_supplier_lineitem#2546,cfpk_lineitem_supplier#2547,cfpk_lineitem_partsupp#2548,cpfk_part_lineitem#2549,cfpk_lineitem_part#2550,cpfk_partsupp_lineitem#2551,cfpk_lineitem_orders#2552,cval_lineitem_l_quantity#2553,cval_lineitem_l_extendedprice#2554,cval_lineitem_l_discount#2555,cval_lineitem_l_tax#2556,cval_lineitem_l_returnflag#2557,cval_lineitem_l_linestatus#2558,cval_lineitem_l_commitdate#2559,cval_lineitem_l_receiptdate#2560,cval_lineitem_l_shipinstruct#2561,cval_lineitem_l_shipmode#2562,cval_lineitem_l_comment#2563,cval_lineitem_l_shipdate#2564,cl_quantity#2565,cl_extendedprice#2566,cl_discount#2567,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2789ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/15 15:01:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:01:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2647L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:01:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2647L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#2649 AS rid_0#2682, cpfk_orders_lineitem#2650 AS cpfk_orders_lineitem_0#2683, cpfk_supplier_lineitem#2651 AS cpfk_supplier_lineitem_0#2684, cfpk_lineitem_supplier#2652 AS cfpk_lineitem_supplier_0#2685, cfpk_lineitem_partsupp#2653 AS cfpk_lineitem_partsupp_0#2686, cpfk_part_lineitem#2654 AS cpfk_part_lineitem_0#2687, cfpk_lineitem_part#2655 AS cfpk_lineitem_part_0#2688, cpfk_partsupp_lineitem#2656 AS cpfk_partsupp_lineitem_0#2689, cfpk_lineitem_orders#2657 AS cfpk_lineitem_orders_0#2690, cval_lineitem_l_quantity#2658 AS cval_lineitem_l_quantity_0#2691, cval_lineitem_l_extendedprice#2659 AS cval_lineitem_l_extendedprice_0#2692, cval_lineitem_l_discount#2660 AS cval_lineitem_l_discount_0#2693, cval_lineitem_l_tax#2661 AS cval_lineitem_l_tax_0#2694, cval_lineitem_l_returnflag#2662 AS cval_lineitem_l_returnflag_0#2695, cval_lineitem_l_linestatus#2663 AS cval_lineitem_l_linestatus_0#2696, cval_lineitem_l_commitdate#2664 AS cval_lineitem_l_commitdate_0#2697, cval_lineitem_l_receiptdate#2665 AS cval_lineitem_l_receiptdate_0#2698, cval_lineitem_l_shipinstruct#2666 AS cval_lineitem_l_shipinstruct_0#2699, cval_lineitem_l_shipmode#2667 AS cval_lineitem_l_shipmode_0#2700, cval_lineitem_l_comment#2668 AS cval_lineitem_l_comment_0#2701, cval_lineitem_l_shipdate#2669 AS cval_lineitem_l_shipdate_0#2702, cl_quantity#2670 AS cl_quantity_0#2703, cl_extendedprice#2671 AS cl_extendedprice_0#2704, cl_discount#2672 AS cl_discount_0#2705, ... 9 more fields]
            :  :  +- Relation[rid#2649,cpfk_orders_lineitem#2650,cpfk_supplier_lineitem#2651,cfpk_lineitem_supplier#2652,cfpk_lineitem_partsupp#2653,cpfk_part_lineitem#2654,cfpk_lineitem_part#2655,cpfk_partsupp_lineitem#2656,cfpk_lineitem_orders#2657,cval_lineitem_l_quantity#2658,cval_lineitem_l_extendedprice#2659,cval_lineitem_l_discount#2660,cval_lineitem_l_tax#2661,cval_lineitem_l_returnflag#2662,cval_lineitem_l_linestatus#2663,cval_lineitem_l_commitdate#2664,cval_lineitem_l_receiptdate#2665,cval_lineitem_l_shipinstruct#2666,cval_lineitem_l_shipmode#2667,cval_lineitem_l_comment#2668,cval_lineitem_l_shipdate#2669,cl_quantity#2670,cl_extendedprice#2671,cl_discount#2672,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#2715 AS rid_0#2748, cpfk_orders_lineitem#2716 AS cpfk_orders_lineitem_0#2749, cpfk_supplier_lineitem#2717 AS cpfk_supplier_lineitem_0#2750, cfpk_lineitem_supplier#2718 AS cfpk_lineitem_supplier_0#2751, cfpk_lineitem_partsupp#2719 AS cfpk_lineitem_partsupp_0#2752, cpfk_part_lineitem#2720 AS cpfk_part_lineitem_0#2753, cfpk_lineitem_part#2721 AS cfpk_lineitem_part_0#2754, cpfk_partsupp_lineitem#2722 AS cpfk_partsupp_lineitem_0#2755, cfpk_lineitem_orders#2723 AS cfpk_lineitem_orders_0#2756, cval_lineitem_l_quantity#2724 AS cval_lineitem_l_quantity_0#2757, cval_lineitem_l_extendedprice#2725 AS cval_lineitem_l_extendedprice_0#2758, cval_lineitem_l_discount#2726 AS cval_lineitem_l_discount_0#2759, cval_lineitem_l_tax#2727 AS cval_lineitem_l_tax_0#2760, cval_lineitem_l_returnflag#2728 AS cval_lineitem_l_returnflag_0#2761, cval_lineitem_l_linestatus#2729 AS cval_lineitem_l_linestatus_0#2762, cval_lineitem_l_commitdate#2730 AS cval_lineitem_l_commitdate_0#2763, cval_lineitem_l_receiptdate#2731 AS cval_lineitem_l_receiptdate_0#2764, cval_lineitem_l_shipinstruct#2732 AS cval_lineitem_l_shipinstruct_0#2765, cval_lineitem_l_shipmode#2733 AS cval_lineitem_l_shipmode_0#2766, cval_lineitem_l_comment#2734 AS cval_lineitem_l_comment_0#2767, cval_lineitem_l_shipdate#2735 AS cval_lineitem_l_shipdate_0#2768, cl_quantity#2736 AS cl_quantity_0#2769, cl_extendedprice#2737 AS cl_extendedprice_0#2770, cl_discount#2738 AS cl_discount_0#2771, ... 9 more fields]
            :        +- Relation[rid#2715,cpfk_orders_lineitem#2716,cpfk_supplier_lineitem#2717,cfpk_lineitem_supplier#2718,cfpk_lineitem_partsupp#2719,cpfk_part_lineitem#2720,cfpk_lineitem_part#2721,cpfk_partsupp_lineitem#2722,cfpk_lineitem_orders#2723,cval_lineitem_l_quantity#2724,cval_lineitem_l_extendedprice#2725,cval_lineitem_l_discount#2726,cval_lineitem_l_tax#2727,cval_lineitem_l_returnflag#2728,cval_lineitem_l_linestatus#2729,cval_lineitem_l_commitdate#2730,cval_lineitem_l_receiptdate#2731,cval_lineitem_l_shipinstruct#2732,cval_lineitem_l_shipmode#2733,cval_lineitem_l_comment#2734,cval_lineitem_l_shipdate#2735,cl_quantity#2736,cl_extendedprice#2737,cl_discount#2738,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#2781 AS rid_1#2798, cpfk_customer_orders#2782 AS cpfk_customer_orders_1#2799, cfpk_orders_customer#2783 AS cfpk_orders_customer_1#2800, cval_orders_o_orderstatus#2784 AS cval_orders_o_orderstatus_1#2801, cval_orders_o_totalprice#2785 AS cval_orders_o_totalprice_1#2802, cval_orders_o_orderpriority#2786 AS cval_orders_o_orderpriority_1#2803, cval_orders_o_clerk#2787 AS cval_orders_o_clerk_1#2804, cval_orders_o_shippriority#2788 AS cval_orders_o_shippriority_1#2805, cval_orders_o_comment#2789 AS cval_orders_o_comment_1#2806, cval_orders_o_orderdate#2790 AS cval_orders_o_orderdate_1#2807, co_orderstatus#2791 AS co_orderstatus_1#2808, co_totalprice#2792 AS co_totalprice_1#2809, co_orderpriority#2793 AS co_orderpriority_1#2810, co_clerk#2794 AS co_clerk_1#2811, co_shippriority#2795 AS co_shippriority_1#2812, co_comment#2796 AS co_comment_1#2813, co_orderdate#2797 AS co_orderdate_1#2814]
               +- Relation[rid#2781,cpfk_customer_orders#2782,cfpk_orders_customer#2783,cval_orders_o_orderstatus#2784,cval_orders_o_totalprice#2785,cval_orders_o_orderpriority#2786,cval_orders_o_clerk#2787,cval_orders_o_shippriority#2788,cval_orders_o_comment#2789,cval_orders_o_orderdate#2790,co_orderstatus#2791,co_totalprice#2792,co_orderpriority#2793,co_clerk#2794,co_shippriority#2795,co_comment#2796,co_orderdate#2797] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 23726ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/15 15:01:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:01:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2869L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:01:49 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:01:49 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:01:49 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:01:49 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:01:49 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:01:49 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:01:49 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:01:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2869L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#2871 AS rid_0#2888, cval_part_p_name#2872 AS cval_part_p_name_0#2889, cval_part_p_mfgr#2873 AS cval_part_p_mfgr_0#2890, cval_part_p_type#2874 AS cval_part_p_type_0#2891, cval_part_p_size#2875 AS cval_part_p_size_0#2892, cval_part_p_container#2876 AS cval_part_p_container_0#2893, cval_part_p_retailprice#2877 AS cval_part_p_retailprice_0#2894, cval_part_p_comment#2878 AS cval_part_p_comment_0#2895, cval_part_p_brand#2879 AS cval_part_p_brand_0#2896, cp_name#2880 AS cp_name_0#2897, cp_mfgr#2881 AS cp_mfgr_0#2898, cp_type#2882 AS cp_type_0#2899, cp_size#2883 AS cp_size_0#2900, cp_container#2884 AS cp_container_0#2901, cp_retailprice#2885 AS cp_retailprice_0#2902, cp_comment#2886 AS cp_comment_0#2903, cp_brand#2887 AS cp_brand_0#2904]
         :  :  :  :  +- Relation[rid#2871,cval_part_p_name#2872,cval_part_p_mfgr#2873,cval_part_p_type#2874,cval_part_p_size#2875,cval_part_p_container#2876,cval_part_p_retailprice#2877,cval_part_p_comment#2878,cval_part_p_brand#2879,cp_name#2880,cp_mfgr#2881,cp_type#2882,cp_size#2883,cp_container#2884,cp_retailprice#2885,cp_comment#2886,cp_brand#2887] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#2905 AS rid_0#2922, cval_part_p_name#2906 AS cval_part_p_name_0#2923, cval_part_p_mfgr#2907 AS cval_part_p_mfgr_0#2924, cval_part_p_type#2908 AS cval_part_p_type_0#2925, cval_part_p_size#2909 AS cval_part_p_size_0#2926, cval_part_p_container#2910 AS cval_part_p_container_0#2927, cval_part_p_retailprice#2911 AS cval_part_p_retailprice_0#2928, cval_part_p_comment#2912 AS cval_part_p_comment_0#2929, cval_part_p_brand#2913 AS cval_part_p_brand_0#2930, cp_name#2914 AS cp_name_0#2931, cp_mfgr#2915 AS cp_mfgr_0#2932, cp_type#2916 AS cp_type_0#2933, cp_size#2917 AS cp_size_0#2934, cp_container#2918 AS cp_container_0#2935, cp_retailprice#2919 AS cp_retailprice_0#2936, cp_comment#2920 AS cp_comment_0#2937, cp_brand#2921 AS cp_brand_0#2938]
         :  :  :        +- Relation[rid#2905,cval_part_p_name#2906,cval_part_p_mfgr#2907,cval_part_p_type#2908,cval_part_p_size#2909,cval_part_p_container#2910,cval_part_p_retailprice#2911,cval_part_p_comment#2912,cval_part_p_brand#2913,cp_name#2914,cp_mfgr#2915,cp_type#2916,cp_size#2917,cp_container#2918,cp_retailprice#2919,cp_comment#2920,cp_brand#2921] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#2939 AS rid_0#2956, cval_part_p_name#2940 AS cval_part_p_name_0#2957, cval_part_p_mfgr#2941 AS cval_part_p_mfgr_0#2958, cval_part_p_type#2942 AS cval_part_p_type_0#2959, cval_part_p_size#2943 AS cval_part_p_size_0#2960, cval_part_p_container#2944 AS cval_part_p_container_0#2961, cval_part_p_retailprice#2945 AS cval_part_p_retailprice_0#2962, cval_part_p_comment#2946 AS cval_part_p_comment_0#2963, cval_part_p_brand#2947 AS cval_part_p_brand_0#2964, cp_name#2948 AS cp_name_0#2965, cp_mfgr#2949 AS cp_mfgr_0#2966, cp_type#2950 AS cp_type_0#2967, cp_size#2951 AS cp_size_0#2968, cp_container#2952 AS cp_container_0#2969, cp_retailprice#2953 AS cp_retailprice_0#2970, cp_comment#2954 AS cp_comment_0#2971, cp_brand#2955 AS cp_brand_0#2972]
         :  :        +- Relation[rid#2939,cval_part_p_name#2940,cval_part_p_mfgr#2941,cval_part_p_type#2942,cval_part_p_size#2943,cval_part_p_container#2944,cval_part_p_retailprice#2945,cval_part_p_comment#2946,cval_part_p_brand#2947,cp_name#2948,cp_mfgr#2949,cp_type#2950,cp_size#2951,cp_container#2952,cp_retailprice#2953,cp_comment#2954,cp_brand#2955] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#3073 AS rid_1#3106, cpfk_orders_lineitem#3074 AS cpfk_orders_lineitem_1#3107, cpfk_supplier_lineitem#3075 AS cpfk_supplier_lineitem_1#3108, cfpk_lineitem_supplier#3076 AS cfpk_lineitem_supplier_1#3109, cfpk_lineitem_partsupp#3077 AS cfpk_lineitem_partsupp_1#3110, cpfk_part_lineitem#3078 AS cpfk_part_lineitem_1#3111, cfpk_lineitem_part#3079 AS cfpk_lineitem_part_1#3112, cpfk_partsupp_lineitem#3080 AS cpfk_partsupp_lineitem_1#3113, cfpk_lineitem_orders#3081 AS cfpk_lineitem_orders_1#3114, cval_lineitem_l_quantity#3082 AS cval_lineitem_l_quantity_1#3115, cval_lineitem_l_extendedprice#3083 AS cval_lineitem_l_extendedprice_1#3116, cval_lineitem_l_discount#3084 AS cval_lineitem_l_discount_1#3117, cval_lineitem_l_tax#3085 AS cval_lineitem_l_tax_1#3118, cval_lineitem_l_returnflag#3086 AS cval_lineitem_l_returnflag_1#3119, cval_lineitem_l_linestatus#3087 AS cval_lineitem_l_linestatus_1#3120, cval_lineitem_l_commitdate#3088 AS cval_lineitem_l_commitdate_1#3121, cval_lineitem_l_receiptdate#3089 AS cval_lineitem_l_receiptdate_1#3122, cval_lineitem_l_shipinstruct#3090 AS cval_lineitem_l_shipinstruct_1#3123, cval_lineitem_l_shipmode#3091 AS cval_lineitem_l_shipmode_1#3124, cval_lineitem_l_comment#3092 AS cval_lineitem_l_comment_1#3125, cval_lineitem_l_shipdate#3093 AS cval_lineitem_l_shipdate_1#3126, cl_quantity#3094 AS cl_quantity_1#3127, cl_extendedprice#3095 AS cl_extendedprice_1#3128, cl_discount#3096 AS cl_discount_1#3129, ... 9 more fields]
         :     +- Relation[rid#3073,cpfk_orders_lineitem#3074,cpfk_supplier_lineitem#3075,cfpk_lineitem_supplier#3076,cfpk_lineitem_partsupp#3077,cpfk_part_lineitem#3078,cfpk_lineitem_part#3079,cpfk_partsupp_lineitem#3080,cfpk_lineitem_orders#3081,cval_lineitem_l_quantity#3082,cval_lineitem_l_extendedprice#3083,cval_lineitem_l_discount#3084,cval_lineitem_l_tax#3085,cval_lineitem_l_returnflag#3086,cval_lineitem_l_linestatus#3087,cval_lineitem_l_commitdate#3088,cval_lineitem_l_receiptdate#3089,cval_lineitem_l_shipinstruct#3090,cval_lineitem_l_shipmode#3091,cval_lineitem_l_comment#3092,cval_lineitem_l_shipdate#3093,cl_quantity#3094,cl_extendedprice#3095,cl_discount#3096,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2973 AS rid_1#3006, cpfk_orders_lineitem#2974 AS cpfk_orders_lineitem_1#3007, cpfk_supplier_lineitem#2975 AS cpfk_supplier_lineitem_1#3008, cfpk_lineitem_supplier#2976 AS cfpk_lineitem_supplier_1#3009, cfpk_lineitem_partsupp#2977 AS cfpk_lineitem_partsupp_1#3010, cpfk_part_lineitem#2978 AS cpfk_part_lineitem_1#3011, cfpk_lineitem_part#2979 AS cfpk_lineitem_part_1#3012, cpfk_partsupp_lineitem#2980 AS cpfk_partsupp_lineitem_1#3013, cfpk_lineitem_orders#2981 AS cfpk_lineitem_orders_1#3014, cval_lineitem_l_quantity#2982 AS cval_lineitem_l_quantity_1#3015, cval_lineitem_l_extendedprice#2983 AS cval_lineitem_l_extendedprice_1#3016, cval_lineitem_l_discount#2984 AS cval_lineitem_l_discount_1#3017, cval_lineitem_l_tax#2985 AS cval_lineitem_l_tax_1#3018, cval_lineitem_l_returnflag#2986 AS cval_lineitem_l_returnflag_1#3019, cval_lineitem_l_linestatus#2987 AS cval_lineitem_l_linestatus_1#3020, cval_lineitem_l_commitdate#2988 AS cval_lineitem_l_commitdate_1#3021, cval_lineitem_l_receiptdate#2989 AS cval_lineitem_l_receiptdate_1#3022, cval_lineitem_l_shipinstruct#2990 AS cval_lineitem_l_shipinstruct_1#3023, cval_lineitem_l_shipmode#2991 AS cval_lineitem_l_shipmode_1#3024, cval_lineitem_l_comment#2992 AS cval_lineitem_l_comment_1#3025, cval_lineitem_l_shipdate#2993 AS cval_lineitem_l_shipdate_1#3026, cl_quantity#2994 AS cl_quantity_1#3027, cl_extendedprice#2995 AS cl_extendedprice_1#3028, cl_discount#2996 AS cl_discount_1#3029, ... 9 more fields]
            +- Relation[rid#2973,cpfk_orders_lineitem#2974,cpfk_supplier_lineitem#2975,cfpk_lineitem_supplier#2976,cfpk_lineitem_partsupp#2977,cpfk_part_lineitem#2978,cfpk_lineitem_part#2979,cpfk_partsupp_lineitem#2980,cfpk_lineitem_orders#2981,cval_lineitem_l_quantity#2982,cval_lineitem_l_extendedprice#2983,cval_lineitem_l_discount#2984,cval_lineitem_l_tax#2985,cval_lineitem_l_returnflag#2986,cval_lineitem_l_linestatus#2987,cval_lineitem_l_commitdate#2988,cval_lineitem_l_receiptdate#2989,cval_lineitem_l_shipinstruct#2990,cval_lineitem_l_shipmode#2991,cval_lineitem_l_comment#2992,cval_lineitem_l_shipdate#2993,cl_quantity#2994,cl_extendedprice#2995,cl_discount#2996,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=408
Elapsed time: 520ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/15 15:01:50 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:01:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3196L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:01:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:01:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:01:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:01:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:01:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:01:50 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:01:50 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:01:50 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:01:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:01:50 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:01:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:01:50 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:01:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:01:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:01:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:01:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3196L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#3198 AS rid_0#3215, cval_part_p_name#3199 AS cval_part_p_name_0#3216, cval_part_p_mfgr#3200 AS cval_part_p_mfgr_0#3217, cval_part_p_type#3201 AS cval_part_p_type_0#3218, cval_part_p_size#3202 AS cval_part_p_size_0#3219, cval_part_p_container#3203 AS cval_part_p_container_0#3220, cval_part_p_retailprice#3204 AS cval_part_p_retailprice_0#3221, cval_part_p_comment#3205 AS cval_part_p_comment_0#3222, cval_part_p_brand#3206 AS cval_part_p_brand_0#3223, cp_name#3207 AS cp_name_0#3224, cp_mfgr#3208 AS cp_mfgr_0#3225, cp_type#3209 AS cp_type_0#3226, cp_size#3210 AS cp_size_0#3227, cp_container#3211 AS cp_container_0#3228, cp_retailprice#3212 AS cp_retailprice_0#3229, cp_comment#3213 AS cp_comment_0#3230, cp_brand#3214 AS cp_brand_0#3231]
            :     :     :  :  :  :  +- Relation[rid#3198,cval_part_p_name#3199,cval_part_p_mfgr#3200,cval_part_p_type#3201,cval_part_p_size#3202,cval_part_p_container#3203,cval_part_p_retailprice#3204,cval_part_p_comment#3205,cval_part_p_brand#3206,cp_name#3207,cp_mfgr#3208,cp_type#3209,cp_size#3210,cp_container#3211,cp_retailprice#3212,cp_comment#3213,cp_brand#3214] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#3232 AS rid_0#3249, cval_part_p_name#3233 AS cval_part_p_name_0#3250, cval_part_p_mfgr#3234 AS cval_part_p_mfgr_0#3251, cval_part_p_type#3235 AS cval_part_p_type_0#3252, cval_part_p_size#3236 AS cval_part_p_size_0#3253, cval_part_p_container#3237 AS cval_part_p_container_0#3254, cval_part_p_retailprice#3238 AS cval_part_p_retailprice_0#3255, cval_part_p_comment#3239 AS cval_part_p_comment_0#3256, cval_part_p_brand#3240 AS cval_part_p_brand_0#3257, cp_name#3241 AS cp_name_0#3258, cp_mfgr#3242 AS cp_mfgr_0#3259, cp_type#3243 AS cp_type_0#3260, cp_size#3244 AS cp_size_0#3261, cp_container#3245 AS cp_container_0#3262, cp_retailprice#3246 AS cp_retailprice_0#3263, cp_comment#3247 AS cp_comment_0#3264, cp_brand#3248 AS cp_brand_0#3265]
            :     :     :  :  :        +- Relation[rid#3232,cval_part_p_name#3233,cval_part_p_mfgr#3234,cval_part_p_type#3235,cval_part_p_size#3236,cval_part_p_container#3237,cval_part_p_retailprice#3238,cval_part_p_comment#3239,cval_part_p_brand#3240,cp_name#3241,cp_mfgr#3242,cp_type#3243,cp_size#3244,cp_container#3245,cp_retailprice#3246,cp_comment#3247,cp_brand#3248] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- Project [rid#3366 AS rid_1#3399, cpfk_orders_lineitem#3367 AS cpfk_orders_lineitem_1#3400, cpfk_supplier_lineitem#3368 AS cpfk_supplier_lineitem_1#3401, cfpk_lineitem_supplier#3369 AS cfpk_lineitem_supplier_1#3402, cfpk_lineitem_partsupp#3370 AS cfpk_lineitem_partsupp_1#3403, cpfk_part_lineitem#3371 AS cpfk_part_lineitem_1#3404, cfpk_lineitem_part#3372 AS cfpk_lineitem_part_1#3405, cpfk_partsupp_lineitem#3373 AS cpfk_partsupp_lineitem_1#3406, cfpk_lineitem_orders#3374 AS cfpk_lineitem_orders_1#3407, cval_lineitem_l_quantity#3375 AS cval_lineitem_l_quantity_1#3408, cval_lineitem_l_extendedprice#3376 AS cval_lineitem_l_extendedprice_1#3409, cval_lineitem_l_discount#3377 AS cval_lineitem_l_discount_1#3410, cval_lineitem_l_tax#3378 AS cval_lineitem_l_tax_1#3411, cval_lineitem_l_returnflag#3379 AS cval_lineitem_l_returnflag_1#3412, cval_lineitem_l_linestatus#3380 AS cval_lineitem_l_linestatus_1#3413, cval_lineitem_l_commitdate#3381 AS cval_lineitem_l_commitdate_1#3414, cval_lineitem_l_receiptdate#3382 AS cval_lineitem_l_receiptdate_1#3415, cval_lineitem_l_shipinstruct#3383 AS cval_lineitem_l_shipinstruct_1#3416, cval_lineitem_l_shipmode#3384 AS cval_lineitem_l_shipmode_1#3417, cval_lineitem_l_comment#3385 AS cval_lineitem_l_comment_1#3418, cval_lineitem_l_shipdate#3386 AS cval_lineitem_l_shipdate_1#3419, cl_quantity#3387 AS cl_quantity_1#3420, cl_extendedprice#3388 AS cl_extendedprice_1#3421, cl_discount#3389 AS cl_discount_1#3422, ... 9 more fields]
            :     :     :  :     +- Relation[rid#3366,cpfk_orders_lineitem#3367,cpfk_supplier_lineitem#3368,cfpk_lineitem_supplier#3369,cfpk_lineitem_partsupp#3370,cpfk_part_lineitem#3371,cfpk_lineitem_part#3372,cpfk_partsupp_lineitem#3373,cfpk_lineitem_orders#3374,cval_lineitem_l_quantity#3375,cval_lineitem_l_extendedprice#3376,cval_lineitem_l_discount#3377,cval_lineitem_l_tax#3378,cval_lineitem_l_returnflag#3379,cval_lineitem_l_linestatus#3380,cval_lineitem_l_commitdate#3381,cval_lineitem_l_receiptdate#3382,cval_lineitem_l_shipinstruct#3383,cval_lineitem_l_shipmode#3384,cval_lineitem_l_comment#3385,cval_lineitem_l_shipdate#3386,cl_quantity#3387,cl_extendedprice#3388,cl_discount#3389,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#3266 AS rid_1#3299, cpfk_orders_lineitem#3267 AS cpfk_orders_lineitem_1#3300, cpfk_supplier_lineitem#3268 AS cpfk_supplier_lineitem_1#3301, cfpk_lineitem_supplier#3269 AS cfpk_lineitem_supplier_1#3302, cfpk_lineitem_partsupp#3270 AS cfpk_lineitem_partsupp_1#3303, cpfk_part_lineitem#3271 AS cpfk_part_lineitem_1#3304, cfpk_lineitem_part#3272 AS cfpk_lineitem_part_1#3305, cpfk_partsupp_lineitem#3273 AS cpfk_partsupp_lineitem_1#3306, cfpk_lineitem_orders#3274 AS cfpk_lineitem_orders_1#3307, cval_lineitem_l_quantity#3275 AS cval_lineitem_l_quantity_1#3308, cval_lineitem_l_extendedprice#3276 AS cval_lineitem_l_extendedprice_1#3309, cval_lineitem_l_discount#3277 AS cval_lineitem_l_discount_1#3310, cval_lineitem_l_tax#3278 AS cval_lineitem_l_tax_1#3311, cval_lineitem_l_returnflag#3279 AS cval_lineitem_l_returnflag_1#3312, cval_lineitem_l_linestatus#3280 AS cval_lineitem_l_linestatus_1#3313, cval_lineitem_l_commitdate#3281 AS cval_lineitem_l_commitdate_1#3314, cval_lineitem_l_receiptdate#3282 AS cval_lineitem_l_receiptdate_1#3315, cval_lineitem_l_shipinstruct#3283 AS cval_lineitem_l_shipinstruct_1#3316, cval_lineitem_l_shipmode#3284 AS cval_lineitem_l_shipmode_1#3317, cval_lineitem_l_comment#3285 AS cval_lineitem_l_comment_1#3318, cval_lineitem_l_shipdate#3286 AS cval_lineitem_l_shipdate_1#3319, cl_quantity#3287 AS cl_quantity_1#3320, cl_extendedprice#3288 AS cl_extendedprice_1#3321, cl_discount#3289 AS cl_discount_1#3322, ... 9 more fields]
            :     :     :     +- Relation[rid#3266,cpfk_orders_lineitem#3267,cpfk_supplier_lineitem#3268,cfpk_lineitem_supplier#3269,cfpk_lineitem_partsupp#3270,cpfk_part_lineitem#3271,cfpk_lineitem_part#3272,cpfk_partsupp_lineitem#3273,cfpk_lineitem_orders#3274,cval_lineitem_l_quantity#3275,cval_lineitem_l_extendedprice#3276,cval_lineitem_l_discount#3277,cval_lineitem_l_tax#3278,cval_lineitem_l_returnflag#3279,cval_lineitem_l_linestatus#3280,cval_lineitem_l_commitdate#3281,cval_lineitem_l_receiptdate#3282,cval_lineitem_l_shipinstruct#3283,cval_lineitem_l_shipmode#3284,cval_lineitem_l_comment#3285,cval_lineitem_l_shipdate#3286,cl_quantity#3287,cl_extendedprice#3288,cl_discount#3289,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#3432 AS rid_2#3445, cpfk_nation_supplier#3433 AS cpfk_nation_supplier_2#3446, cfpk_supplier_nation#3434 AS cfpk_supplier_nation_2#3447, cval_supplier_s_name#3435 AS cval_supplier_s_name_2#3448, cval_supplier_s_address#3436 AS cval_supplier_s_address_2#3449, cval_supplier_s_phone#3437 AS cval_supplier_s_phone_2#3450, cval_supplier_s_acctbal#3438 AS cval_supplier_s_acctbal_2#3451, cval_supplier_s_comment#3439 AS cval_supplier_s_comment_2#3452, cs_name#3440 AS cs_name_2#3453, cs_address#3441 AS cs_address_2#3454, cs_phone#3442 AS cs_phone_2#3455, cs_acctbal#3443 AS cs_acctbal_2#3456, cs_comment#3444 AS cs_comment_2#3457]
            :     :        +- Relation[rid#3432,cpfk_nation_supplier#3433,cfpk_supplier_nation#3434,cval_supplier_s_name#3435,cval_supplier_s_address#3436,cval_supplier_s_phone#3437,cval_supplier_s_acctbal#3438,cval_supplier_s_comment#3439,cs_name#3440,cs_address#3441,cs_phone#3442,cs_acctbal#3443,cs_comment#3444] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#3458 AS rid_3#3465, cpfk_region_nation#3459 AS cpfk_region_nation_3#3466, cfpk_nation_region#3460 AS cfpk_nation_region_3#3467, cval_nation_n_name#3461 AS cval_nation_n_name_3#3468, cval_nation_n_comment#3462 AS cval_nation_n_comment_3#3469, cn_name#3463 AS cn_name_3#3470, cn_comment#3464 AS cn_comment_3#3471]
            :        +- Relation[rid#3458,cpfk_region_nation#3459,cfpk_nation_region#3460,cval_nation_n_name#3461,cval_nation_n_comment#3462,cn_name#3463,cn_comment#3464] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#3472 AS rid_4#3477, cval_region_r_name#3473 AS cval_region_r_name_4#3478, cval_region_r_comment#3474 AS cval_region_r_comment_4#3479, cr_name#3475 AS cr_name_4#3480, cr_comment#3476 AS cr_comment_4#3481]
               :  :  :  :  :  :  :  +- Relation[rid#3472,cval_region_r_name#3473,cval_region_r_comment#3474,cr_name#3475,cr_comment#3476] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#3482 AS rid_4#3487, cval_region_r_name#3483 AS cval_region_r_name_4#3488, cval_region_r_comment#3484 AS cval_region_r_comment_4#3489, cr_name#3485 AS cr_name_4#3490, cr_comment#3486 AS cr_comment_4#3491]
               :  :  :  :  :  :        +- Relation[rid#3482,cval_region_r_name#3483,cval_region_r_comment#3484,cr_name#3485,cr_comment#3486] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- Project [rid#3516 AS rid_5#3523, cpfk_region_nation#3517 AS cpfk_region_nation_5#3524, cfpk_nation_region#3518 AS cfpk_nation_region_5#3525, cval_nation_n_name#3519 AS cval_nation_n_name_5#3526, cval_nation_n_comment#3520 AS cval_nation_n_comment_5#3527, cn_name#3521 AS cn_name_5#3528, cn_comment#3522 AS cn_comment_5#3529]
               :  :  :  :  :     +- Relation[rid#3516,cpfk_region_nation#3517,cfpk_nation_region#3518,cval_nation_n_name#3519,cval_nation_n_comment#3520,cn_name#3521,cn_comment#3522] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#3492 AS rid_5#3499, cpfk_region_nation#3493 AS cpfk_region_nation_5#3500, cfpk_nation_region#3494 AS cfpk_nation_region_5#3501, cval_nation_n_name#3495 AS cval_nation_n_name_5#3502, cval_nation_n_comment#3496 AS cval_nation_n_comment_5#3503, cn_name#3497 AS cn_name_5#3504, cn_comment#3498 AS cn_comment_5#3505]
               :  :  :  :     +- Relation[rid#3492,cpfk_region_nation#3493,cfpk_nation_region#3494,cval_nation_n_name#3495,cval_nation_n_comment#3496,cn_name#3497,cn_comment#3498] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#3574 AS rid_6#3589, cpfk_nation_customer#3575 AS cpfk_nation_customer_6#3590, cfpk_customer_nation#3576 AS cfpk_customer_nation_6#3591, cval_customer_c_name#3577 AS cval_customer_c_name_6#3592, cval_customer_c_address#3578 AS cval_customer_c_address_6#3593, cval_customer_c_phone#3579 AS cval_customer_c_phone_6#3594, cval_customer_c_acctbal#3580 AS cval_customer_c_acctbal_6#3595, cval_customer_c_comment#3581 AS cval_customer_c_comment_6#3596, cval_customer_c_mktsegment#3582 AS cval_customer_c_mktsegment_6#3597, cc_name#3583 AS cc_name_6#3598, cc_address#3584 AS cc_address_6#3599, cc_phone#3585 AS cc_phone_6#3600, cc_acctbal#3586 AS cc_acctbal_6#3601, cc_comment#3587 AS cc_comment_6#3602, cc_mktsegment#3588 AS cc_mktsegment_6#3603]
               :  :  :     +- Relation[rid#3574,cpfk_nation_customer#3575,cfpk_customer_nation#3576,cval_customer_c_name#3577,cval_customer_c_address#3578,cval_customer_c_phone#3579,cval_customer_c_acctbal#3580,cval_customer_c_comment#3581,cval_customer_c_mktsegment#3582,cc_name#3583,cc_address#3584,cc_phone#3585,cc_acctbal#3586,cc_comment#3587,cc_mktsegment#3588] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#3530 AS rid_6#3545, cpfk_nation_customer#3531 AS cpfk_nation_customer_6#3546, cfpk_customer_nation#3532 AS cfpk_customer_nation_6#3547, cval_customer_c_name#3533 AS cval_customer_c_name_6#3548, cval_customer_c_address#3534 AS cval_customer_c_address_6#3549, cval_customer_c_phone#3535 AS cval_customer_c_phone_6#3550, cval_customer_c_acctbal#3536 AS cval_customer_c_acctbal_6#3551, cval_customer_c_comment#3537 AS cval_customer_c_comment_6#3552, cval_customer_c_mktsegment#3538 AS cval_customer_c_mktsegment_6#3553, cc_name#3539 AS cc_name_6#3554, cc_address#3540 AS cc_address_6#3555, cc_phone#3541 AS cc_phone_6#3556, cc_acctbal#3542 AS cc_acctbal_6#3557, cc_comment#3543 AS cc_comment_6#3558, cc_mktsegment#3544 AS cc_mktsegment_6#3559]
               :  :     +- Relation[rid#3530,cpfk_nation_customer#3531,cfpk_customer_nation#3532,cval_customer_c_name#3533,cval_customer_c_address#3534,cval_customer_c_phone#3535,cval_customer_c_acctbal#3536,cval_customer_c_comment#3537,cval_customer_c_mktsegment#3538,cc_name#3539,cc_address#3540,cc_phone#3541,cc_acctbal#3542,cc_comment#3543,cc_mktsegment#3544] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#3668 AS rid_7#3685, cpfk_customer_orders#3669 AS cpfk_customer_orders_7#3686, cfpk_orders_customer#3670 AS cfpk_orders_customer_7#3687, cval_orders_o_orderstatus#3671 AS cval_orders_o_orderstatus_7#3688, cval_orders_o_totalprice#3672 AS cval_orders_o_totalprice_7#3689, cval_orders_o_orderpriority#3673 AS cval_orders_o_orderpriority_7#3690, cval_orders_o_clerk#3674 AS cval_orders_o_clerk_7#3691, cval_orders_o_shippriority#3675 AS cval_orders_o_shippriority_7#3692, cval_orders_o_comment#3676 AS cval_orders_o_comment_7#3693, cval_orders_o_orderdate#3677 AS cval_orders_o_orderdate_7#3694, co_orderstatus#3678 AS co_orderstatus_7#3695, co_totalprice#3679 AS co_totalprice_7#3696, co_orderpriority#3680 AS co_orderpriority_7#3697, co_clerk#3681 AS co_clerk_7#3698, co_shippriority#3682 AS co_shippriority_7#3699, co_comment#3683 AS co_comment_7#3700, co_orderdate#3684 AS co_orderdate_7#3701]
               :     +- Relation[rid#3668,cpfk_customer_orders#3669,cfpk_orders_customer#3670,cval_orders_o_orderstatus#3671,cval_orders_o_totalprice#3672,cval_orders_o_orderpriority#3673,cval_orders_o_clerk#3674,cval_orders_o_shippriority#3675,cval_orders_o_comment#3676,cval_orders_o_orderdate#3677,co_orderstatus#3678,co_totalprice#3679,co_orderpriority#3680,co_clerk#3681,co_shippriority#3682,co_comment#3683,co_orderdate#3684] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#3604 AS rid_7#3621, cpfk_customer_orders#3605 AS cpfk_customer_orders_7#3622, cfpk_orders_customer#3606 AS cfpk_orders_customer_7#3623, cval_orders_o_orderstatus#3607 AS cval_orders_o_orderstatus_7#3624, cval_orders_o_totalprice#3608 AS cval_orders_o_totalprice_7#3625, cval_orders_o_orderpriority#3609 AS cval_orders_o_orderpriority_7#3626, cval_orders_o_clerk#3610 AS cval_orders_o_clerk_7#3627, cval_orders_o_shippriority#3611 AS cval_orders_o_shippriority_7#3628, cval_orders_o_comment#3612 AS cval_orders_o_comment_7#3629, cval_orders_o_orderdate#3613 AS cval_orders_o_orderdate_7#3630, co_orderstatus#3614 AS co_orderstatus_7#3631, co_totalprice#3615 AS co_totalprice_7#3632, co_orderpriority#3616 AS co_orderpriority_7#3633, co_clerk#3617 AS co_clerk_7#3634, co_shippriority#3618 AS co_shippriority_7#3635, co_comment#3619 AS co_comment_7#3636, co_orderdate#3620 AS co_orderdate_7#3637]
                  +- Relation[rid#3604,cpfk_customer_orders#3605,cfpk_orders_customer#3606,cval_orders_o_orderstatus#3607,cval_orders_o_totalprice#3608,cval_orders_o_orderpriority#3609,cval_orders_o_clerk#3610,cval_orders_o_shippriority#3611,cval_orders_o_comment#3612,cval_orders_o_orderdate#3613,co_orderstatus#3614,co_totalprice#3615,co_orderpriority#3616,co_clerk#3617,co_shippriority#3618,co_comment#3619,co_orderdate#3620] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 2246ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 15:01:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:01:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3825L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:01:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:01:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:01:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:01:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:01:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:01:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:01:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:01:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:01:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:01:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:01:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:01:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:01:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:01:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:01:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:01:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:01:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3825L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#3827 AS rid_0#3834, cpfk_region_nation#3828 AS cpfk_region_nation_0#3835, cfpk_nation_region#3829 AS cfpk_nation_region_0#3836, cval_nation_n_name#3830 AS cval_nation_n_name_0#3837, cval_nation_n_comment#3831 AS cval_nation_n_comment_0#3838, cn_name#3832 AS cn_name_0#3839, cn_comment#3833 AS cn_comment_0#3840]
            :  :  :     :  :  :  :  :  +- Relation[rid#3827,cpfk_region_nation#3828,cfpk_nation_region#3829,cval_nation_n_name#3830,cval_nation_n_comment#3831,cn_name#3832,cn_comment#3833] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#3867 AS rid_0#3874, cpfk_region_nation#3868 AS cpfk_region_nation_0#3875, cfpk_nation_region#3869 AS cfpk_nation_region_0#3876, cval_nation_n_name#3870 AS cval_nation_n_name_0#3877, cval_nation_n_comment#3871 AS cval_nation_n_comment_0#3878, cn_name#3872 AS cn_name_0#3879, cn_comment#3873 AS cn_comment_0#3880]
            :  :  :     :  :  :  :     :  +- Relation[rid#3867,cpfk_region_nation#3868,cfpk_nation_region#3869,cval_nation_n_name#3870,cval_nation_n_comment#3871,cn_name#3872,cn_comment#3873] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#3881 AS rid_1#3894, cpfk_nation_supplier#3882 AS cpfk_nation_supplier_1#3895, cfpk_supplier_nation#3883 AS cfpk_supplier_nation_1#3896, cval_supplier_s_name#3884 AS cval_supplier_s_name_1#3897, cval_supplier_s_address#3885 AS cval_supplier_s_address_1#3898, cval_supplier_s_phone#3886 AS cval_supplier_s_phone_1#3899, cval_supplier_s_acctbal#3887 AS cval_supplier_s_acctbal_1#3900, cval_supplier_s_comment#3888 AS cval_supplier_s_comment_1#3901, cs_name#3889 AS cs_name_1#3902, cs_address#3890 AS cs_address_1#3903, cs_phone#3891 AS cs_phone_1#3904, cs_acctbal#3892 AS cs_acctbal_1#3905, cs_comment#3893 AS cs_comment_1#3906]
            :  :  :     :  :  :  :        +- Relation[rid#3881,cpfk_nation_supplier#3882,cfpk_supplier_nation#3883,cval_supplier_s_name#3884,cval_supplier_s_address#3885,cval_supplier_s_phone#3886,cval_supplier_s_acctbal#3887,cval_supplier_s_comment#3888,cs_name#3889,cs_address#3890,cs_phone#3891,cs_acctbal#3892,cs_comment#3893] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#3841 AS rid_1#3854, cpfk_nation_supplier#3842 AS cpfk_nation_supplier_1#3855, cfpk_supplier_nation#3843 AS cfpk_supplier_nation_1#3856, cval_supplier_s_name#3844 AS cval_supplier_s_name_1#3857, cval_supplier_s_address#3845 AS cval_supplier_s_address_1#3858, cval_supplier_s_phone#3846 AS cval_supplier_s_phone_1#3859, cval_supplier_s_acctbal#3847 AS cval_supplier_s_acctbal_1#3860, cval_supplier_s_comment#3848 AS cval_supplier_s_comment_1#3861, cs_name#3849 AS cs_name_1#3862, cs_address#3850 AS cs_address_1#3863, cs_phone#3851 AS cs_phone_1#3864, cs_acctbal#3852 AS cs_acctbal_1#3865, cs_comment#3853 AS cs_comment_1#3866]
            :  :  :     :  :  :     +- Relation[rid#3841,cpfk_nation_supplier#3842,cfpk_supplier_nation#3843,cval_supplier_s_name#3844,cval_supplier_s_address#3845,cval_supplier_s_phone#3846,cval_supplier_s_acctbal#3847,cval_supplier_s_comment#3848,cs_name#3849,cs_address#3850,cs_phone#3851,cs_acctbal#3852,cs_comment#3853] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#3929 AS rid_1#3942, cpfk_nation_supplier#3930 AS cpfk_nation_supplier_1#3943, cfpk_supplier_nation#3931 AS cfpk_supplier_nation_1#3944, cval_supplier_s_name#3932 AS cval_supplier_s_name_1#3945, cval_supplier_s_address#3933 AS cval_supplier_s_address_1#3946, cval_supplier_s_phone#3934 AS cval_supplier_s_phone_1#3947, cval_supplier_s_acctbal#3935 AS cval_supplier_s_acctbal_1#3948, cval_supplier_s_comment#3936 AS cval_supplier_s_comment_1#3949, cs_name#3937 AS cs_name_1#3950, cs_address#3938 AS cs_address_1#3951, cs_phone#3939 AS cs_phone_1#3952, cs_acctbal#3940 AS cs_acctbal_1#3953, cs_comment#3941 AS cs_comment_1#3954]
            :  :  :     :  :     :  +- Relation[rid#3929,cpfk_nation_supplier#3930,cfpk_supplier_nation#3931,cval_supplier_s_name#3932,cval_supplier_s_address#3933,cval_supplier_s_phone#3934,cval_supplier_s_acctbal#3935,cval_supplier_s_comment#3936,cs_name#3937,cs_address#3938,cs_phone#3939,cs_acctbal#3940,cs_comment#3941] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#3955 AS rid_2#3966, cpfk_part_partsupp#3956 AS cpfk_part_partsupp_2#3967, cfpk_partsupp_part#3957 AS cfpk_partsupp_part_2#3968, cpfk_supplier_partsupp#3958 AS cpfk_supplier_partsupp_2#3969, cfpk_partsupp_supplier#3959 AS cfpk_partsupp_supplier_2#3970, cval_partsupp_ps_availqty#3960 AS cval_partsupp_ps_availqty_2#3971, cval_partsupp_ps_supplycost#3961 AS cval_partsupp_ps_supplycost_2#3972, cval_partsupp_ps_comment#3962 AS cval_partsupp_ps_comment_2#3973, cps_availqty#3963 AS cps_availqty_2#3974, cps_supplycost#3964 AS cps_supplycost_2#3975, cps_comment#3965 AS cps_comment_2#3976]
            :  :  :     :  :        +- Relation[rid#3955,cpfk_part_partsupp#3956,cfpk_partsupp_part#3957,cpfk_supplier_partsupp#3958,cfpk_partsupp_supplier#3959,cval_partsupp_ps_availqty#3960,cval_partsupp_ps_supplycost#3961,cval_partsupp_ps_comment#3962,cps_availqty#3963,cps_supplycost#3964,cps_comment#3965] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#3907 AS rid_2#3918, cpfk_part_partsupp#3908 AS cpfk_part_partsupp_2#3919, cfpk_partsupp_part#3909 AS cfpk_partsupp_part_2#3920, cpfk_supplier_partsupp#3910 AS cpfk_supplier_partsupp_2#3921, cfpk_partsupp_supplier#3911 AS cfpk_partsupp_supplier_2#3922, cval_partsupp_ps_availqty#3912 AS cval_partsupp_ps_availqty_2#3923, cval_partsupp_ps_supplycost#3913 AS cval_partsupp_ps_supplycost_2#3924, cval_partsupp_ps_comment#3914 AS cval_partsupp_ps_comment_2#3925, cps_availqty#3915 AS cps_availqty_2#3926, cps_supplycost#3916 AS cps_supplycost_2#3927, cps_comment#3917 AS cps_comment_2#3928]
            :  :  :     :     +- Relation[rid#3907,cpfk_part_partsupp#3908,cfpk_partsupp_part#3909,cpfk_supplier_partsupp#3910,cfpk_partsupp_supplier#3911,cval_partsupp_ps_availqty#3912,cval_partsupp_ps_supplycost#3913,cval_partsupp_ps_comment#3914,cps_availqty#3915,cps_supplycost#3916,cps_comment#3917] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#3977 AS rid_3#3994, cval_part_p_name#3978 AS cval_part_p_name_3#3995, cval_part_p_mfgr#3979 AS cval_part_p_mfgr_3#3996, cval_part_p_type#3980 AS cval_part_p_type_3#3997, cval_part_p_size#3981 AS cval_part_p_size_3#3998, cval_part_p_container#3982 AS cval_part_p_container_3#3999, cval_part_p_retailprice#3983 AS cval_part_p_retailprice_3#4000, cval_part_p_comment#3984 AS cval_part_p_comment_3#4001, cval_part_p_brand#3985 AS cval_part_p_brand_3#4002, cp_name#3986 AS cp_name_3#4003, cp_mfgr#3987 AS cp_mfgr_3#4004, cp_type#3988 AS cp_type_3#4005, cp_size#3989 AS cp_size_3#4006, cp_container#3990 AS cp_container_3#4007, cp_retailprice#3991 AS cp_retailprice_3#4008, cp_comment#3992 AS cp_comment_3#4009, cp_brand#3993 AS cp_brand_3#4010]
            :  :  :        +- Relation[rid#3977,cval_part_p_name#3978,cval_part_p_mfgr#3979,cval_part_p_type#3980,cval_part_p_size#3981,cval_part_p_container#3982,cval_part_p_retailprice#3983,cval_part_p_comment#3984,cval_part_p_brand#3985,cp_name#3986,cp_mfgr#3987,cp_type#3988,cp_size#3989,cp_container#3990,cp_retailprice#3991,cp_comment#3992,cp_brand#3993] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#4077 AS rid_2#4088, cpfk_part_partsupp#4078 AS cpfk_part_partsupp_2#4089, cfpk_partsupp_part#4079 AS cfpk_partsupp_part_2#4090, cpfk_supplier_partsupp#4080 AS cpfk_supplier_partsupp_2#4091, cfpk_partsupp_supplier#4081 AS cfpk_partsupp_supplier_2#4092, cval_partsupp_ps_availqty#4082 AS cval_partsupp_ps_availqty_2#4093, cval_partsupp_ps_supplycost#4083 AS cval_partsupp_ps_supplycost_2#4094, cval_partsupp_ps_comment#4084 AS cval_partsupp_ps_comment_2#4095, cps_availqty#4085 AS cps_availqty_2#4096, cps_supplycost#4086 AS cps_supplycost_2#4097, cps_comment#4087 AS cps_comment_2#4098]
            :  :     :  +- Relation[rid#4077,cpfk_part_partsupp#4078,cfpk_partsupp_part#4079,cpfk_supplier_partsupp#4080,cfpk_partsupp_supplier#4081,cval_partsupp_ps_availqty#4082,cval_partsupp_ps_supplycost#4083,cval_partsupp_ps_comment#4084,cps_availqty#4085,cps_supplycost#4086,cps_comment#4087] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#4099 AS rid_4#4132, cpfk_orders_lineitem#4100 AS cpfk_orders_lineitem_4#4133, cpfk_supplier_lineitem#4101 AS cpfk_supplier_lineitem_4#4134, cfpk_lineitem_supplier#4102 AS cfpk_lineitem_supplier_4#4135, cfpk_lineitem_partsupp#4103 AS cfpk_lineitem_partsupp_4#4136, cpfk_part_lineitem#4104 AS cpfk_part_lineitem_4#4137, cfpk_lineitem_part#4105 AS cfpk_lineitem_part_4#4138, cpfk_partsupp_lineitem#4106 AS cpfk_partsupp_lineitem_4#4139, cfpk_lineitem_orders#4107 AS cfpk_lineitem_orders_4#4140, cval_lineitem_l_quantity#4108 AS cval_lineitem_l_quantity_4#4141, cval_lineitem_l_extendedprice#4109 AS cval_lineitem_l_extendedprice_4#4142, cval_lineitem_l_discount#4110 AS cval_lineitem_l_discount_4#4143, cval_lineitem_l_tax#4111 AS cval_lineitem_l_tax_4#4144, cval_lineitem_l_returnflag#4112 AS cval_lineitem_l_returnflag_4#4145, cval_lineitem_l_linestatus#4113 AS cval_lineitem_l_linestatus_4#4146, cval_lineitem_l_commitdate#4114 AS cval_lineitem_l_commitdate_4#4147, cval_lineitem_l_receiptdate#4115 AS cval_lineitem_l_receiptdate_4#4148, cval_lineitem_l_shipinstruct#4116 AS cval_lineitem_l_shipinstruct_4#4149, cval_lineitem_l_shipmode#4117 AS cval_lineitem_l_shipmode_4#4150, cval_lineitem_l_comment#4118 AS cval_lineitem_l_comment_4#4151, cval_lineitem_l_shipdate#4119 AS cval_lineitem_l_shipdate_4#4152, cl_quantity#4120 AS cl_quantity_4#4153, cl_extendedprice#4121 AS cl_extendedprice_4#4154, cl_discount#4122 AS cl_discount_4#4155, ... 9 more fields]
            :  :        +- Relation[rid#4099,cpfk_orders_lineitem#4100,cpfk_supplier_lineitem#4101,cfpk_lineitem_supplier#4102,cfpk_lineitem_partsupp#4103,cpfk_part_lineitem#4104,cfpk_lineitem_part#4105,cpfk_partsupp_lineitem#4106,cfpk_lineitem_orders#4107,cval_lineitem_l_quantity#4108,cval_lineitem_l_extendedprice#4109,cval_lineitem_l_discount#4110,cval_lineitem_l_tax#4111,cval_lineitem_l_returnflag#4112,cval_lineitem_l_linestatus#4113,cval_lineitem_l_commitdate#4114,cval_lineitem_l_receiptdate#4115,cval_lineitem_l_shipinstruct#4116,cval_lineitem_l_shipmode#4117,cval_lineitem_l_comment#4118,cval_lineitem_l_shipdate#4119,cl_quantity#4120,cl_extendedprice#4121,cl_discount#4122,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#4011 AS rid_4#4044, cpfk_orders_lineitem#4012 AS cpfk_orders_lineitem_4#4045, cpfk_supplier_lineitem#4013 AS cpfk_supplier_lineitem_4#4046, cfpk_lineitem_supplier#4014 AS cfpk_lineitem_supplier_4#4047, cfpk_lineitem_partsupp#4015 AS cfpk_lineitem_partsupp_4#4048, cpfk_part_lineitem#4016 AS cpfk_part_lineitem_4#4049, cfpk_lineitem_part#4017 AS cfpk_lineitem_part_4#4050, cpfk_partsupp_lineitem#4018 AS cpfk_partsupp_lineitem_4#4051, cfpk_lineitem_orders#4019 AS cfpk_lineitem_orders_4#4052, cval_lineitem_l_quantity#4020 AS cval_lineitem_l_quantity_4#4053, cval_lineitem_l_extendedprice#4021 AS cval_lineitem_l_extendedprice_4#4054, cval_lineitem_l_discount#4022 AS cval_lineitem_l_discount_4#4055, cval_lineitem_l_tax#4023 AS cval_lineitem_l_tax_4#4056, cval_lineitem_l_returnflag#4024 AS cval_lineitem_l_returnflag_4#4057, cval_lineitem_l_linestatus#4025 AS cval_lineitem_l_linestatus_4#4058, cval_lineitem_l_commitdate#4026 AS cval_lineitem_l_commitdate_4#4059, cval_lineitem_l_receiptdate#4027 AS cval_lineitem_l_receiptdate_4#4060, cval_lineitem_l_shipinstruct#4028 AS cval_lineitem_l_shipinstruct_4#4061, cval_lineitem_l_shipmode#4029 AS cval_lineitem_l_shipmode_4#4062, cval_lineitem_l_comment#4030 AS cval_lineitem_l_comment_4#4063, cval_lineitem_l_shipdate#4031 AS cval_lineitem_l_shipdate_4#4064, cl_quantity#4032 AS cl_quantity_4#4065, cl_extendedprice#4033 AS cl_extendedprice_4#4066, cl_discount#4034 AS cl_discount_4#4067, ... 9 more fields]
            :     +- Relation[rid#4011,cpfk_orders_lineitem#4012,cpfk_supplier_lineitem#4013,cfpk_lineitem_supplier#4014,cfpk_lineitem_partsupp#4015,cpfk_part_lineitem#4016,cfpk_lineitem_part#4017,cpfk_partsupp_lineitem#4018,cfpk_lineitem_orders#4019,cval_lineitem_l_quantity#4020,cval_lineitem_l_extendedprice#4021,cval_lineitem_l_discount#4022,cval_lineitem_l_tax#4023,cval_lineitem_l_returnflag#4024,cval_lineitem_l_linestatus#4025,cval_lineitem_l_commitdate#4026,cval_lineitem_l_receiptdate#4027,cval_lineitem_l_shipinstruct#4028,cval_lineitem_l_shipmode#4029,cval_lineitem_l_comment#4030,cval_lineitem_l_shipdate#4031,cl_quantity#4032,cl_extendedprice#4033,cl_discount#4034,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#4165 AS rid_5#4182, cpfk_customer_orders#4166 AS cpfk_customer_orders_5#4183, cfpk_orders_customer#4167 AS cfpk_orders_customer_5#4184, cval_orders_o_orderstatus#4168 AS cval_orders_o_orderstatus_5#4185, cval_orders_o_totalprice#4169 AS cval_orders_o_totalprice_5#4186, cval_orders_o_orderpriority#4170 AS cval_orders_o_orderpriority_5#4187, cval_orders_o_clerk#4171 AS cval_orders_o_clerk_5#4188, cval_orders_o_shippriority#4172 AS cval_orders_o_shippriority_5#4189, cval_orders_o_comment#4173 AS cval_orders_o_comment_5#4190, cval_orders_o_orderdate#4174 AS cval_orders_o_orderdate_5#4191, co_orderstatus#4175 AS co_orderstatus_5#4192, co_totalprice#4176 AS co_totalprice_5#4193, co_orderpriority#4177 AS co_orderpriority_5#4194, co_clerk#4178 AS co_clerk_5#4195, co_shippriority#4179 AS co_shippriority_5#4196, co_comment#4180 AS co_comment_5#4197, co_orderdate#4181 AS co_orderdate_5#4198]
               +- Relation[rid#4165,cpfk_customer_orders#4166,cfpk_orders_customer#4167,cval_orders_o_orderstatus#4168,cval_orders_o_totalprice#4169,cval_orders_o_orderpriority#4170,cval_orders_o_clerk#4171,cval_orders_o_shippriority#4172,cval_orders_o_comment#4173,cval_orders_o_orderdate#4174,co_orderstatus#4175,co_totalprice#4176,co_orderpriority#4177,co_clerk#4178,co_shippriority#4179,co_comment#4180,co_orderdate#4181] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 176422ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/15 15:04:48 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:04:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4301L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 15:04:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4301L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#4303 AS rid_0#4320, cpfk_customer_orders#4304 AS cpfk_customer_orders_0#4321, cfpk_orders_customer#4305 AS cfpk_orders_customer_0#4322, cval_orders_o_orderstatus#4306 AS cval_orders_o_orderstatus_0#4323, cval_orders_o_totalprice#4307 AS cval_orders_o_totalprice_0#4324, cval_orders_o_orderpriority#4308 AS cval_orders_o_orderpriority_0#4325, cval_orders_o_clerk#4309 AS cval_orders_o_clerk_0#4326, cval_orders_o_shippriority#4310 AS cval_orders_o_shippriority_0#4327, cval_orders_o_comment#4311 AS cval_orders_o_comment_0#4328, cval_orders_o_orderdate#4312 AS cval_orders_o_orderdate_0#4329, co_orderstatus#4313 AS co_orderstatus_0#4330, co_totalprice#4314 AS co_totalprice_0#4331, co_orderpriority#4315 AS co_orderpriority_0#4332, co_clerk#4316 AS co_clerk_0#4333, co_shippriority#4317 AS co_shippriority_0#4334, co_comment#4318 AS co_comment_0#4335, co_orderdate#4319 AS co_orderdate_0#4336]
            :  +- Relation[rid#4303,cpfk_customer_orders#4304,cfpk_orders_customer#4305,cval_orders_o_orderstatus#4306,cval_orders_o_totalprice#4307,cval_orders_o_orderpriority#4308,cval_orders_o_clerk#4309,cval_orders_o_shippriority#4310,cval_orders_o_comment#4311,cval_orders_o_orderdate#4312,co_orderstatus#4313,co_totalprice#4314,co_orderpriority#4315,co_clerk#4316,co_shippriority#4317,co_comment#4318,co_orderdate#4319] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#4337 AS rid_1#4352, cpfk_nation_customer#4338 AS cpfk_nation_customer_1#4353, cfpk_customer_nation#4339 AS cfpk_customer_nation_1#4354, cval_customer_c_name#4340 AS cval_customer_c_name_1#4355, cval_customer_c_address#4341 AS cval_customer_c_address_1#4356, cval_customer_c_phone#4342 AS cval_customer_c_phone_1#4357, cval_customer_c_acctbal#4343 AS cval_customer_c_acctbal_1#4358, cval_customer_c_comment#4344 AS cval_customer_c_comment_1#4359, cval_customer_c_mktsegment#4345 AS cval_customer_c_mktsegment_1#4360, cc_name#4346 AS cc_name_1#4361, cc_address#4347 AS cc_address_1#4362, cc_phone#4348 AS cc_phone_1#4363, cc_acctbal#4349 AS cc_acctbal_1#4364, cc_comment#4350 AS cc_comment_1#4365, cc_mktsegment#4351 AS cc_mktsegment_1#4366]
               +- Relation[rid#4337,cpfk_nation_customer#4338,cfpk_customer_nation#4339,cval_customer_c_name#4340,cval_customer_c_address#4341,cval_customer_c_phone#4342,cval_customer_c_acctbal#4343,cval_customer_c_comment#4344,cval_customer_c_mktsegment#4345,cc_name#4346,cc_address#4347,cc_phone#4348,cc_acctbal#4349,cc_comment#4350,cc_mktsegment#4351] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13791ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/15 15:05:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:05:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4411L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 15:05:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:05:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:05:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4411L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#4413 AS rid_0#4446, cpfk_orders_lineitem#4414 AS cpfk_orders_lineitem_0#4447, cpfk_supplier_lineitem#4415 AS cpfk_supplier_lineitem_0#4448, cfpk_lineitem_supplier#4416 AS cfpk_lineitem_supplier_0#4449, cfpk_lineitem_partsupp#4417 AS cfpk_lineitem_partsupp_0#4450, cpfk_part_lineitem#4418 AS cpfk_part_lineitem_0#4451, cfpk_lineitem_part#4419 AS cfpk_lineitem_part_0#4452, cpfk_partsupp_lineitem#4420 AS cpfk_partsupp_lineitem_0#4453, cfpk_lineitem_orders#4421 AS cfpk_lineitem_orders_0#4454, cval_lineitem_l_quantity#4422 AS cval_lineitem_l_quantity_0#4455, cval_lineitem_l_extendedprice#4423 AS cval_lineitem_l_extendedprice_0#4456, cval_lineitem_l_discount#4424 AS cval_lineitem_l_discount_0#4457, cval_lineitem_l_tax#4425 AS cval_lineitem_l_tax_0#4458, cval_lineitem_l_returnflag#4426 AS cval_lineitem_l_returnflag_0#4459, cval_lineitem_l_linestatus#4427 AS cval_lineitem_l_linestatus_0#4460, cval_lineitem_l_commitdate#4428 AS cval_lineitem_l_commitdate_0#4461, cval_lineitem_l_receiptdate#4429 AS cval_lineitem_l_receiptdate_0#4462, cval_lineitem_l_shipinstruct#4430 AS cval_lineitem_l_shipinstruct_0#4463, cval_lineitem_l_shipmode#4431 AS cval_lineitem_l_shipmode_0#4464, cval_lineitem_l_comment#4432 AS cval_lineitem_l_comment_0#4465, cval_lineitem_l_shipdate#4433 AS cval_lineitem_l_shipdate_0#4466, cl_quantity#4434 AS cl_quantity_0#4467, cl_extendedprice#4435 AS cl_extendedprice_0#4468, cl_discount#4436 AS cl_discount_0#4469, ... 9 more fields]
            :     :     :  :  +- Relation[rid#4413,cpfk_orders_lineitem#4414,cpfk_supplier_lineitem#4415,cfpk_lineitem_supplier#4416,cfpk_lineitem_partsupp#4417,cpfk_part_lineitem#4418,cfpk_lineitem_part#4419,cpfk_partsupp_lineitem#4420,cfpk_lineitem_orders#4421,cval_lineitem_l_quantity#4422,cval_lineitem_l_extendedprice#4423,cval_lineitem_l_discount#4424,cval_lineitem_l_tax#4425,cval_lineitem_l_returnflag#4426,cval_lineitem_l_linestatus#4427,cval_lineitem_l_commitdate#4428,cval_lineitem_l_receiptdate#4429,cval_lineitem_l_shipinstruct#4430,cval_lineitem_l_shipmode#4431,cval_lineitem_l_comment#4432,cval_lineitem_l_shipdate#4433,cl_quantity#4434,cl_extendedprice#4435,cl_discount#4436,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#4479 AS rid_0#4512, cpfk_orders_lineitem#4480 AS cpfk_orders_lineitem_0#4513, cpfk_supplier_lineitem#4481 AS cpfk_supplier_lineitem_0#4514, cfpk_lineitem_supplier#4482 AS cfpk_lineitem_supplier_0#4515, cfpk_lineitem_partsupp#4483 AS cfpk_lineitem_partsupp_0#4516, cpfk_part_lineitem#4484 AS cpfk_part_lineitem_0#4517, cfpk_lineitem_part#4485 AS cfpk_lineitem_part_0#4518, cpfk_partsupp_lineitem#4486 AS cpfk_partsupp_lineitem_0#4519, cfpk_lineitem_orders#4487 AS cfpk_lineitem_orders_0#4520, cval_lineitem_l_quantity#4488 AS cval_lineitem_l_quantity_0#4521, cval_lineitem_l_extendedprice#4489 AS cval_lineitem_l_extendedprice_0#4522, cval_lineitem_l_discount#4490 AS cval_lineitem_l_discount_0#4523, cval_lineitem_l_tax#4491 AS cval_lineitem_l_tax_0#4524, cval_lineitem_l_returnflag#4492 AS cval_lineitem_l_returnflag_0#4525, cval_lineitem_l_linestatus#4493 AS cval_lineitem_l_linestatus_0#4526, cval_lineitem_l_commitdate#4494 AS cval_lineitem_l_commitdate_0#4527, cval_lineitem_l_receiptdate#4495 AS cval_lineitem_l_receiptdate_0#4528, cval_lineitem_l_shipinstruct#4496 AS cval_lineitem_l_shipinstruct_0#4529, cval_lineitem_l_shipmode#4497 AS cval_lineitem_l_shipmode_0#4530, cval_lineitem_l_comment#4498 AS cval_lineitem_l_comment_0#4531, cval_lineitem_l_shipdate#4499 AS cval_lineitem_l_shipdate_0#4532, cl_quantity#4500 AS cl_quantity_0#4533, cl_extendedprice#4501 AS cl_extendedprice_0#4534, cl_discount#4502 AS cl_discount_0#4535, ... 9 more fields]
            :     :     :        +- Relation[rid#4479,cpfk_orders_lineitem#4480,cpfk_supplier_lineitem#4481,cfpk_lineitem_supplier#4482,cfpk_lineitem_partsupp#4483,cpfk_part_lineitem#4484,cfpk_lineitem_part#4485,cpfk_partsupp_lineitem#4486,cfpk_lineitem_orders#4487,cval_lineitem_l_quantity#4488,cval_lineitem_l_extendedprice#4489,cval_lineitem_l_discount#4490,cval_lineitem_l_tax#4491,cval_lineitem_l_returnflag#4492,cval_lineitem_l_linestatus#4493,cval_lineitem_l_commitdate#4494,cval_lineitem_l_receiptdate#4495,cval_lineitem_l_shipinstruct#4496,cval_lineitem_l_shipmode#4497,cval_lineitem_l_comment#4498,cval_lineitem_l_shipdate#4499,cl_quantity#4500,cl_extendedprice#4501,cl_discount#4502,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#4545 AS rid_1#4562, cpfk_customer_orders#4546 AS cpfk_customer_orders_1#4563, cfpk_orders_customer#4547 AS cfpk_orders_customer_1#4564, cval_orders_o_orderstatus#4548 AS cval_orders_o_orderstatus_1#4565, cval_orders_o_totalprice#4549 AS cval_orders_o_totalprice_1#4566, cval_orders_o_orderpriority#4550 AS cval_orders_o_orderpriority_1#4567, cval_orders_o_clerk#4551 AS cval_orders_o_clerk_1#4568, cval_orders_o_shippriority#4552 AS cval_orders_o_shippriority_1#4569, cval_orders_o_comment#4553 AS cval_orders_o_comment_1#4570, cval_orders_o_orderdate#4554 AS cval_orders_o_orderdate_1#4571, co_orderstatus#4555 AS co_orderstatus_1#4572, co_totalprice#4556 AS co_totalprice_1#4573, co_orderpriority#4557 AS co_orderpriority_1#4574, co_clerk#4558 AS co_clerk_1#4575, co_shippriority#4559 AS co_shippriority_1#4576, co_comment#4560 AS co_comment_1#4577, co_orderdate#4561 AS co_orderdate_1#4578]
            :     :        +- Relation[rid#4545,cpfk_customer_orders#4546,cfpk_orders_customer#4547,cval_orders_o_orderstatus#4548,cval_orders_o_totalprice#4549,cval_orders_o_orderpriority#4550,cval_orders_o_clerk#4551,cval_orders_o_shippriority#4552,cval_orders_o_comment#4553,cval_orders_o_orderdate#4554,co_orderstatus#4555,co_totalprice#4556,co_orderpriority#4557,co_clerk#4558,co_shippriority#4559,co_comment#4560,co_orderdate#4561] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#4579 AS rid_2#4594, cpfk_nation_customer#4580 AS cpfk_nation_customer_2#4595, cfpk_customer_nation#4581 AS cfpk_customer_nation_2#4596, cval_customer_c_name#4582 AS cval_customer_c_name_2#4597, cval_customer_c_address#4583 AS cval_customer_c_address_2#4598, cval_customer_c_phone#4584 AS cval_customer_c_phone_2#4599, cval_customer_c_acctbal#4585 AS cval_customer_c_acctbal_2#4600, cval_customer_c_comment#4586 AS cval_customer_c_comment_2#4601, cval_customer_c_mktsegment#4587 AS cval_customer_c_mktsegment_2#4602, cc_name#4588 AS cc_name_2#4603, cc_address#4589 AS cc_address_2#4604, cc_phone#4590 AS cc_phone_2#4605, cc_acctbal#4591 AS cc_acctbal_2#4606, cc_comment#4592 AS cc_comment_2#4607, cc_mktsegment#4593 AS cc_mktsegment_2#4608]
            :        +- Relation[rid#4579,cpfk_nation_customer#4580,cfpk_customer_nation#4581,cval_customer_c_name#4582,cval_customer_c_address#4583,cval_customer_c_phone#4584,cval_customer_c_acctbal#4585,cval_customer_c_comment#4586,cval_customer_c_mktsegment#4587,cc_name#4588,cc_address#4589,cc_phone#4590,cc_acctbal#4591,cc_comment#4592,cc_mktsegment#4593] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#4609 AS rid_3#4616, cpfk_region_nation#4610 AS cpfk_region_nation_3#4617, cfpk_nation_region#4611 AS cfpk_nation_region_3#4618, cval_nation_n_name#4612 AS cval_nation_n_name_3#4619, cval_nation_n_comment#4613 AS cval_nation_n_comment_3#4620, cn_name#4614 AS cn_name_3#4621, cn_comment#4615 AS cn_comment_3#4622]
               +- Relation[rid#4609,cpfk_region_nation#4610,cfpk_nation_region#4611,cval_nation_n_name#4612,cval_nation_n_comment#4613,cn_name#4614,cn_comment#4615] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 71124ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/15 15:06:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:06:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4700L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:06:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:06:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:06:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:06:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:06:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:06:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:06:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:06:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4700L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#4702 AS rid_0#4719, cval_part_p_name#4703 AS cval_part_p_name_0#4720, cval_part_p_mfgr#4704 AS cval_part_p_mfgr_0#4721, cval_part_p_type#4705 AS cval_part_p_type_0#4722, cval_part_p_size#4706 AS cval_part_p_size_0#4723, cval_part_p_container#4707 AS cval_part_p_container_0#4724, cval_part_p_retailprice#4708 AS cval_part_p_retailprice_0#4725, cval_part_p_comment#4709 AS cval_part_p_comment_0#4726, cval_part_p_brand#4710 AS cval_part_p_brand_0#4727, cp_name#4711 AS cp_name_0#4728, cp_mfgr#4712 AS cp_mfgr_0#4729, cp_type#4713 AS cp_type_0#4730, cp_size#4714 AS cp_size_0#4731, cp_container#4715 AS cp_container_0#4732, cp_retailprice#4716 AS cp_retailprice_0#4733, cp_comment#4717 AS cp_comment_0#4734, cp_brand#4718 AS cp_brand_0#4735]
         :  :  :  :  +- Relation[rid#4702,cval_part_p_name#4703,cval_part_p_mfgr#4704,cval_part_p_type#4705,cval_part_p_size#4706,cval_part_p_container#4707,cval_part_p_retailprice#4708,cval_part_p_comment#4709,cval_part_p_brand#4710,cp_name#4711,cp_mfgr#4712,cp_type#4713,cp_size#4714,cp_container#4715,cp_retailprice#4716,cp_comment#4717,cp_brand#4718] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#4736 AS rid_0#4753, cval_part_p_name#4737 AS cval_part_p_name_0#4754, cval_part_p_mfgr#4738 AS cval_part_p_mfgr_0#4755, cval_part_p_type#4739 AS cval_part_p_type_0#4756, cval_part_p_size#4740 AS cval_part_p_size_0#4757, cval_part_p_container#4741 AS cval_part_p_container_0#4758, cval_part_p_retailprice#4742 AS cval_part_p_retailprice_0#4759, cval_part_p_comment#4743 AS cval_part_p_comment_0#4760, cval_part_p_brand#4744 AS cval_part_p_brand_0#4761, cp_name#4745 AS cp_name_0#4762, cp_mfgr#4746 AS cp_mfgr_0#4763, cp_type#4747 AS cp_type_0#4764, cp_size#4748 AS cp_size_0#4765, cp_container#4749 AS cp_container_0#4766, cp_retailprice#4750 AS cp_retailprice_0#4767, cp_comment#4751 AS cp_comment_0#4768, cp_brand#4752 AS cp_brand_0#4769]
         :  :  :        +- Relation[rid#4736,cval_part_p_name#4737,cval_part_p_mfgr#4738,cval_part_p_type#4739,cval_part_p_size#4740,cval_part_p_container#4741,cval_part_p_retailprice#4742,cval_part_p_comment#4743,cval_part_p_brand#4744,cp_name#4745,cp_mfgr#4746,cp_type#4747,cp_size#4748,cp_container#4749,cp_retailprice#4750,cp_comment#4751,cp_brand#4752] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#4770 AS rid_0#4787, cval_part_p_name#4771 AS cval_part_p_name_0#4788, cval_part_p_mfgr#4772 AS cval_part_p_mfgr_0#4789, cval_part_p_type#4773 AS cval_part_p_type_0#4790, cval_part_p_size#4774 AS cval_part_p_size_0#4791, cval_part_p_container#4775 AS cval_part_p_container_0#4792, cval_part_p_retailprice#4776 AS cval_part_p_retailprice_0#4793, cval_part_p_comment#4777 AS cval_part_p_comment_0#4794, cval_part_p_brand#4778 AS cval_part_p_brand_0#4795, cp_name#4779 AS cp_name_0#4796, cp_mfgr#4780 AS cp_mfgr_0#4797, cp_type#4781 AS cp_type_0#4798, cp_size#4782 AS cp_size_0#4799, cp_container#4783 AS cp_container_0#4800, cp_retailprice#4784 AS cp_retailprice_0#4801, cp_comment#4785 AS cp_comment_0#4802, cp_brand#4786 AS cp_brand_0#4803]
         :  :        +- Relation[rid#4770,cval_part_p_name#4771,cval_part_p_mfgr#4772,cval_part_p_type#4773,cval_part_p_size#4774,cval_part_p_container#4775,cval_part_p_retailprice#4776,cval_part_p_comment#4777,cval_part_p_brand#4778,cp_name#4779,cp_mfgr#4780,cp_type#4781,cp_size#4782,cp_container#4783,cp_retailprice#4784,cp_comment#4785,cp_brand#4786] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#5036 AS rid_1#5069, cpfk_orders_lineitem#5037 AS cpfk_orders_lineitem_1#5070, cpfk_supplier_lineitem#5038 AS cpfk_supplier_lineitem_1#5071, cfpk_lineitem_supplier#5039 AS cfpk_lineitem_supplier_1#5072, cfpk_lineitem_partsupp#5040 AS cfpk_lineitem_partsupp_1#5073, cpfk_part_lineitem#5041 AS cpfk_part_lineitem_1#5074, cfpk_lineitem_part#5042 AS cfpk_lineitem_part_1#5075, cpfk_partsupp_lineitem#5043 AS cpfk_partsupp_lineitem_1#5076, cfpk_lineitem_orders#5044 AS cfpk_lineitem_orders_1#5077, cval_lineitem_l_quantity#5045 AS cval_lineitem_l_quantity_1#5078, cval_lineitem_l_extendedprice#5046 AS cval_lineitem_l_extendedprice_1#5079, cval_lineitem_l_discount#5047 AS cval_lineitem_l_discount_1#5080, cval_lineitem_l_tax#5048 AS cval_lineitem_l_tax_1#5081, cval_lineitem_l_returnflag#5049 AS cval_lineitem_l_returnflag_1#5082, cval_lineitem_l_linestatus#5050 AS cval_lineitem_l_linestatus_1#5083, cval_lineitem_l_commitdate#5051 AS cval_lineitem_l_commitdate_1#5084, cval_lineitem_l_receiptdate#5052 AS cval_lineitem_l_receiptdate_1#5085, cval_lineitem_l_shipinstruct#5053 AS cval_lineitem_l_shipinstruct_1#5086, cval_lineitem_l_shipmode#5054 AS cval_lineitem_l_shipmode_1#5087, cval_lineitem_l_comment#5055 AS cval_lineitem_l_comment_1#5088, cval_lineitem_l_shipdate#5056 AS cval_lineitem_l_shipdate_1#5089, cl_quantity#5057 AS cl_quantity_1#5090, cl_extendedprice#5058 AS cl_extendedprice_1#5091, cl_discount#5059 AS cl_discount_1#5092, ... 9 more fields]
         :     +- Relation[rid#5036,cpfk_orders_lineitem#5037,cpfk_supplier_lineitem#5038,cfpk_lineitem_supplier#5039,cfpk_lineitem_partsupp#5040,cpfk_part_lineitem#5041,cfpk_lineitem_part#5042,cpfk_partsupp_lineitem#5043,cfpk_lineitem_orders#5044,cval_lineitem_l_quantity#5045,cval_lineitem_l_extendedprice#5046,cval_lineitem_l_discount#5047,cval_lineitem_l_tax#5048,cval_lineitem_l_returnflag#5049,cval_lineitem_l_linestatus#5050,cval_lineitem_l_commitdate#5051,cval_lineitem_l_receiptdate#5052,cval_lineitem_l_shipinstruct#5053,cval_lineitem_l_shipmode#5054,cval_lineitem_l_comment#5055,cval_lineitem_l_shipdate#5056,cl_quantity#5057,cl_extendedprice#5058,cl_discount#5059,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#4804 AS rid_1#4837, cpfk_orders_lineitem#4805 AS cpfk_orders_lineitem_1#4838, cpfk_supplier_lineitem#4806 AS cpfk_supplier_lineitem_1#4839, cfpk_lineitem_supplier#4807 AS cfpk_lineitem_supplier_1#4840, cfpk_lineitem_partsupp#4808 AS cfpk_lineitem_partsupp_1#4841, cpfk_part_lineitem#4809 AS cpfk_part_lineitem_1#4842, cfpk_lineitem_part#4810 AS cfpk_lineitem_part_1#4843, cpfk_partsupp_lineitem#4811 AS cpfk_partsupp_lineitem_1#4844, cfpk_lineitem_orders#4812 AS cfpk_lineitem_orders_1#4845, cval_lineitem_l_quantity#4813 AS cval_lineitem_l_quantity_1#4846, cval_lineitem_l_extendedprice#4814 AS cval_lineitem_l_extendedprice_1#4847, cval_lineitem_l_discount#4815 AS cval_lineitem_l_discount_1#4848, cval_lineitem_l_tax#4816 AS cval_lineitem_l_tax_1#4849, cval_lineitem_l_returnflag#4817 AS cval_lineitem_l_returnflag_1#4850, cval_lineitem_l_linestatus#4818 AS cval_lineitem_l_linestatus_1#4851, cval_lineitem_l_commitdate#4819 AS cval_lineitem_l_commitdate_1#4852, cval_lineitem_l_receiptdate#4820 AS cval_lineitem_l_receiptdate_1#4853, cval_lineitem_l_shipinstruct#4821 AS cval_lineitem_l_shipinstruct_1#4854, cval_lineitem_l_shipmode#4822 AS cval_lineitem_l_shipmode_1#4855, cval_lineitem_l_comment#4823 AS cval_lineitem_l_comment_1#4856, cval_lineitem_l_shipdate#4824 AS cval_lineitem_l_shipdate_1#4857, cl_quantity#4825 AS cl_quantity_1#4858, cl_extendedprice#4826 AS cl_extendedprice_1#4859, cl_discount#4827 AS cl_discount_1#4860, ... 9 more fields]
            :  :  +- Relation[rid#4804,cpfk_orders_lineitem#4805,cpfk_supplier_lineitem#4806,cfpk_lineitem_supplier#4807,cfpk_lineitem_partsupp#4808,cpfk_part_lineitem#4809,cfpk_lineitem_part#4810,cpfk_partsupp_lineitem#4811,cfpk_lineitem_orders#4812,cval_lineitem_l_quantity#4813,cval_lineitem_l_extendedprice#4814,cval_lineitem_l_discount#4815,cval_lineitem_l_tax#4816,cval_lineitem_l_returnflag#4817,cval_lineitem_l_linestatus#4818,cval_lineitem_l_commitdate#4819,cval_lineitem_l_receiptdate#4820,cval_lineitem_l_shipinstruct#4821,cval_lineitem_l_shipmode#4822,cval_lineitem_l_comment#4823,cval_lineitem_l_shipdate#4824,cl_quantity#4825,cl_extendedprice#4826,cl_discount#4827,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#4870 AS rid_1#4903, cpfk_orders_lineitem#4871 AS cpfk_orders_lineitem_1#4904, cpfk_supplier_lineitem#4872 AS cpfk_supplier_lineitem_1#4905, cfpk_lineitem_supplier#4873 AS cfpk_lineitem_supplier_1#4906, cfpk_lineitem_partsupp#4874 AS cfpk_lineitem_partsupp_1#4907, cpfk_part_lineitem#4875 AS cpfk_part_lineitem_1#4908, cfpk_lineitem_part#4876 AS cfpk_lineitem_part_1#4909, cpfk_partsupp_lineitem#4877 AS cpfk_partsupp_lineitem_1#4910, cfpk_lineitem_orders#4878 AS cfpk_lineitem_orders_1#4911, cval_lineitem_l_quantity#4879 AS cval_lineitem_l_quantity_1#4912, cval_lineitem_l_extendedprice#4880 AS cval_lineitem_l_extendedprice_1#4913, cval_lineitem_l_discount#4881 AS cval_lineitem_l_discount_1#4914, cval_lineitem_l_tax#4882 AS cval_lineitem_l_tax_1#4915, cval_lineitem_l_returnflag#4883 AS cval_lineitem_l_returnflag_1#4916, cval_lineitem_l_linestatus#4884 AS cval_lineitem_l_linestatus_1#4917, cval_lineitem_l_commitdate#4885 AS cval_lineitem_l_commitdate_1#4918, cval_lineitem_l_receiptdate#4886 AS cval_lineitem_l_receiptdate_1#4919, cval_lineitem_l_shipinstruct#4887 AS cval_lineitem_l_shipinstruct_1#4920, cval_lineitem_l_shipmode#4888 AS cval_lineitem_l_shipmode_1#4921, cval_lineitem_l_comment#4889 AS cval_lineitem_l_comment_1#4922, cval_lineitem_l_shipdate#4890 AS cval_lineitem_l_shipdate_1#4923, cl_quantity#4891 AS cl_quantity_1#4924, cl_extendedprice#4892 AS cl_extendedprice_1#4925, cl_discount#4893 AS cl_discount_1#4926, ... 9 more fields]
            :        +- Relation[rid#4870,cpfk_orders_lineitem#4871,cpfk_supplier_lineitem#4872,cfpk_lineitem_supplier#4873,cfpk_lineitem_partsupp#4874,cpfk_part_lineitem#4875,cfpk_lineitem_part#4876,cpfk_partsupp_lineitem#4877,cfpk_lineitem_orders#4878,cval_lineitem_l_quantity#4879,cval_lineitem_l_extendedprice#4880,cval_lineitem_l_discount#4881,cval_lineitem_l_tax#4882,cval_lineitem_l_returnflag#4883,cval_lineitem_l_linestatus#4884,cval_lineitem_l_commitdate#4885,cval_lineitem_l_receiptdate#4886,cval_lineitem_l_shipinstruct#4887,cval_lineitem_l_shipmode#4888,cval_lineitem_l_comment#4889,cval_lineitem_l_shipdate#4890,cl_quantity#4891,cl_extendedprice#4892,cl_discount#4893,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#4936 AS rid_1#4969, cpfk_orders_lineitem#4937 AS cpfk_orders_lineitem_1#4970, cpfk_supplier_lineitem#4938 AS cpfk_supplier_lineitem_1#4971, cfpk_lineitem_supplier#4939 AS cfpk_lineitem_supplier_1#4972, cfpk_lineitem_partsupp#4940 AS cfpk_lineitem_partsupp_1#4973, cpfk_part_lineitem#4941 AS cpfk_part_lineitem_1#4974, cfpk_lineitem_part#4942 AS cfpk_lineitem_part_1#4975, cpfk_partsupp_lineitem#4943 AS cpfk_partsupp_lineitem_1#4976, cfpk_lineitem_orders#4944 AS cfpk_lineitem_orders_1#4977, cval_lineitem_l_quantity#4945 AS cval_lineitem_l_quantity_1#4978, cval_lineitem_l_extendedprice#4946 AS cval_lineitem_l_extendedprice_1#4979, cval_lineitem_l_discount#4947 AS cval_lineitem_l_discount_1#4980, cval_lineitem_l_tax#4948 AS cval_lineitem_l_tax_1#4981, cval_lineitem_l_returnflag#4949 AS cval_lineitem_l_returnflag_1#4982, cval_lineitem_l_linestatus#4950 AS cval_lineitem_l_linestatus_1#4983, cval_lineitem_l_commitdate#4951 AS cval_lineitem_l_commitdate_1#4984, cval_lineitem_l_receiptdate#4952 AS cval_lineitem_l_receiptdate_1#4985, cval_lineitem_l_shipinstruct#4953 AS cval_lineitem_l_shipinstruct_1#4986, cval_lineitem_l_shipmode#4954 AS cval_lineitem_l_shipmode_1#4987, cval_lineitem_l_comment#4955 AS cval_lineitem_l_comment_1#4988, cval_lineitem_l_shipdate#4956 AS cval_lineitem_l_shipdate_1#4989, cl_quantity#4957 AS cl_quantity_1#4990, cl_extendedprice#4958 AS cl_extendedprice_1#4991, cl_discount#4959 AS cl_discount_1#4992, ... 9 more fields]
                  +- Relation[rid#4936,cpfk_orders_lineitem#4937,cpfk_supplier_lineitem#4938,cfpk_lineitem_supplier#4939,cfpk_lineitem_partsupp#4940,cpfk_part_lineitem#4941,cfpk_lineitem_part#4942,cpfk_partsupp_lineitem#4943,cfpk_lineitem_orders#4944,cval_lineitem_l_quantity#4945,cval_lineitem_l_extendedprice#4946,cval_lineitem_l_discount#4947,cval_lineitem_l_tax#4948,cval_lineitem_l_returnflag#4949,cval_lineitem_l_linestatus#4950,cval_lineitem_l_commitdate#4951,cval_lineitem_l_receiptdate#4952,cval_lineitem_l_shipinstruct#4953,cval_lineitem_l_shipmode#4954,cval_lineitem_l_comment#4955,cval_lineitem_l_shipdate#4956,cl_quantity#4957,cl_extendedprice#4958,cl_discount#4959,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=13
Elapsed time: 66734ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/15 15:07:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:07:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5158L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 15:07:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:07:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:07:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:07:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:07:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:07:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:07:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:07:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:07:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:07:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:07:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:07:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:07:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:07:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:07:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:07:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:07:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5158L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#5160 AS rid_0#5165, cval_region_r_name#5161 AS cval_region_r_name_0#5166, cval_region_r_comment#5162 AS cval_region_r_comment_0#5167, cr_name#5163 AS cr_name_0#5168, cr_comment#5164 AS cr_comment_0#5169]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#5160,cval_region_r_name#5161,cval_region_r_comment#5162,cr_name#5163,cr_comment#5164] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#5170 AS rid_0#5175, cval_region_r_name#5171 AS cval_region_r_name_0#5176, cval_region_r_comment#5172 AS cval_region_r_comment_0#5177, cr_name#5173 AS cr_name_0#5178, cr_comment#5174 AS cr_comment_0#5179]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#5170,cval_region_r_name#5171,cval_region_r_comment#5172,cr_name#5173,cr_comment#5174] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- Project [rid#5204 AS rid_1#5211, cpfk_region_nation#5205 AS cpfk_region_nation_1#5212, cfpk_nation_region#5206 AS cfpk_nation_region_1#5213, cval_nation_n_name#5207 AS cval_nation_n_name_1#5214, cval_nation_n_comment#5208 AS cval_nation_n_comment_1#5215, cn_name#5209 AS cn_name_1#5216, cn_comment#5210 AS cn_comment_1#5217]
         :     :  :  :  :  :  :  :  :     +- Relation[rid#5204,cpfk_region_nation#5205,cfpk_nation_region#5206,cval_nation_n_name#5207,cval_nation_n_comment#5208,cn_name#5209,cn_comment#5210] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#5180 AS rid_1#5187, cpfk_region_nation#5181 AS cpfk_region_nation_1#5188, cfpk_nation_region#5182 AS cfpk_nation_region_1#5189, cval_nation_n_name#5183 AS cval_nation_n_name_1#5190, cval_nation_n_comment#5184 AS cval_nation_n_comment_1#5191, cn_name#5185 AS cn_name_1#5192, cn_comment#5186 AS cn_comment_1#5193]
         :     :  :  :  :  :  :  :     +- Relation[rid#5180,cpfk_region_nation#5181,cfpk_nation_region#5182,cval_nation_n_name#5183,cval_nation_n_comment#5184,cn_name#5185,cn_comment#5186] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- Project [rid#5262 AS rid_2#5277, cpfk_nation_customer#5263 AS cpfk_nation_customer_2#5278, cfpk_customer_nation#5264 AS cfpk_customer_nation_2#5279, cval_customer_c_name#5265 AS cval_customer_c_name_2#5280, cval_customer_c_address#5266 AS cval_customer_c_address_2#5281, cval_customer_c_phone#5267 AS cval_customer_c_phone_2#5282, cval_customer_c_acctbal#5268 AS cval_customer_c_acctbal_2#5283, cval_customer_c_comment#5269 AS cval_customer_c_comment_2#5284, cval_customer_c_mktsegment#5270 AS cval_customer_c_mktsegment_2#5285, cc_name#5271 AS cc_name_2#5286, cc_address#5272 AS cc_address_2#5287, cc_phone#5273 AS cc_phone_2#5288, cc_acctbal#5274 AS cc_acctbal_2#5289, cc_comment#5275 AS cc_comment_2#5290, cc_mktsegment#5276 AS cc_mktsegment_2#5291]
         :     :  :  :  :  :  :     +- Relation[rid#5262,cpfk_nation_customer#5263,cfpk_customer_nation#5264,cval_customer_c_name#5265,cval_customer_c_address#5266,cval_customer_c_phone#5267,cval_customer_c_acctbal#5268,cval_customer_c_comment#5269,cval_customer_c_mktsegment#5270,cc_name#5271,cc_address#5272,cc_phone#5273,cc_acctbal#5274,cc_comment#5275,cc_mktsegment#5276] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#5218 AS rid_2#5233, cpfk_nation_customer#5219 AS cpfk_nation_customer_2#5234, cfpk_customer_nation#5220 AS cfpk_customer_nation_2#5235, cval_customer_c_name#5221 AS cval_customer_c_name_2#5236, cval_customer_c_address#5222 AS cval_customer_c_address_2#5237, cval_customer_c_phone#5223 AS cval_customer_c_phone_2#5238, cval_customer_c_acctbal#5224 AS cval_customer_c_acctbal_2#5239, cval_customer_c_comment#5225 AS cval_customer_c_comment_2#5240, cval_customer_c_mktsegment#5226 AS cval_customer_c_mktsegment_2#5241, cc_name#5227 AS cc_name_2#5242, cc_address#5228 AS cc_address_2#5243, cc_phone#5229 AS cc_phone_2#5244, cc_acctbal#5230 AS cc_acctbal_2#5245, cc_comment#5231 AS cc_comment_2#5246, cc_mktsegment#5232 AS cc_mktsegment_2#5247]
         :     :  :  :  :  :     +- Relation[rid#5218,cpfk_nation_customer#5219,cfpk_customer_nation#5220,cval_customer_c_name#5221,cval_customer_c_address#5222,cval_customer_c_phone#5223,cval_customer_c_acctbal#5224,cval_customer_c_comment#5225,cval_customer_c_mktsegment#5226,cc_name#5227,cc_address#5228,cc_phone#5229,cc_acctbal#5230,cc_comment#5231,cc_mktsegment#5232] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- Project [rid#5356 AS rid_3#5373, cpfk_customer_orders#5357 AS cpfk_customer_orders_3#5374, cfpk_orders_customer#5358 AS cfpk_orders_customer_3#5375, cval_orders_o_orderstatus#5359 AS cval_orders_o_orderstatus_3#5376, cval_orders_o_totalprice#5360 AS cval_orders_o_totalprice_3#5377, cval_orders_o_orderpriority#5361 AS cval_orders_o_orderpriority_3#5378, cval_orders_o_clerk#5362 AS cval_orders_o_clerk_3#5379, cval_orders_o_shippriority#5363 AS cval_orders_o_shippriority_3#5380, cval_orders_o_comment#5364 AS cval_orders_o_comment_3#5381, cval_orders_o_orderdate#5365 AS cval_orders_o_orderdate_3#5382, co_orderstatus#5366 AS co_orderstatus_3#5383, co_totalprice#5367 AS co_totalprice_3#5384, co_orderpriority#5368 AS co_orderpriority_3#5385, co_clerk#5369 AS co_clerk_3#5386, co_shippriority#5370 AS co_shippriority_3#5387, co_comment#5371 AS co_comment_3#5388, co_orderdate#5372 AS co_orderdate_3#5389]
         :     :  :  :  :     +- Relation[rid#5356,cpfk_customer_orders#5357,cfpk_orders_customer#5358,cval_orders_o_orderstatus#5359,cval_orders_o_totalprice#5360,cval_orders_o_orderpriority#5361,cval_orders_o_clerk#5362,cval_orders_o_shippriority#5363,cval_orders_o_comment#5364,cval_orders_o_orderdate#5365,co_orderstatus#5366,co_totalprice#5367,co_orderpriority#5368,co_clerk#5369,co_shippriority#5370,co_comment#5371,co_orderdate#5372] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#5292 AS rid_3#5309, cpfk_customer_orders#5293 AS cpfk_customer_orders_3#5310, cfpk_orders_customer#5294 AS cfpk_orders_customer_3#5311, cval_orders_o_orderstatus#5295 AS cval_orders_o_orderstatus_3#5312, cval_orders_o_totalprice#5296 AS cval_orders_o_totalprice_3#5313, cval_orders_o_orderpriority#5297 AS cval_orders_o_orderpriority_3#5314, cval_orders_o_clerk#5298 AS cval_orders_o_clerk_3#5315, cval_orders_o_shippriority#5299 AS cval_orders_o_shippriority_3#5316, cval_orders_o_comment#5300 AS cval_orders_o_comment_3#5317, cval_orders_o_orderdate#5301 AS cval_orders_o_orderdate_3#5318, co_orderstatus#5302 AS co_orderstatus_3#5319, co_totalprice#5303 AS co_totalprice_3#5320, co_orderpriority#5304 AS co_orderpriority_3#5321, co_clerk#5305 AS co_clerk_3#5322, co_shippriority#5306 AS co_shippriority_3#5323, co_comment#5307 AS co_comment_3#5324, co_orderdate#5308 AS co_orderdate_3#5325]
         :     :  :  :     +- Relation[rid#5292,cpfk_customer_orders#5293,cfpk_orders_customer#5294,cval_orders_o_orderstatus#5295,cval_orders_o_totalprice#5296,cval_orders_o_orderpriority#5297,cval_orders_o_clerk#5298,cval_orders_o_shippriority#5299,cval_orders_o_comment#5300,cval_orders_o_orderdate#5301,co_orderstatus#5302,co_totalprice#5303,co_orderpriority#5304,co_clerk#5305,co_shippriority#5306,co_comment#5307,co_orderdate#5308] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- Project [rid#5490 AS rid_4#5523, cpfk_orders_lineitem#5491 AS cpfk_orders_lineitem_4#5524, cpfk_supplier_lineitem#5492 AS cpfk_supplier_lineitem_4#5525, cfpk_lineitem_supplier#5493 AS cfpk_lineitem_supplier_4#5526, cfpk_lineitem_partsupp#5494 AS cfpk_lineitem_partsupp_4#5527, cpfk_part_lineitem#5495 AS cpfk_part_lineitem_4#5528, cfpk_lineitem_part#5496 AS cfpk_lineitem_part_4#5529, cpfk_partsupp_lineitem#5497 AS cpfk_partsupp_lineitem_4#5530, cfpk_lineitem_orders#5498 AS cfpk_lineitem_orders_4#5531, cval_lineitem_l_quantity#5499 AS cval_lineitem_l_quantity_4#5532, cval_lineitem_l_extendedprice#5500 AS cval_lineitem_l_extendedprice_4#5533, cval_lineitem_l_discount#5501 AS cval_lineitem_l_discount_4#5534, cval_lineitem_l_tax#5502 AS cval_lineitem_l_tax_4#5535, cval_lineitem_l_returnflag#5503 AS cval_lineitem_l_returnflag_4#5536, cval_lineitem_l_linestatus#5504 AS cval_lineitem_l_linestatus_4#5537, cval_lineitem_l_commitdate#5505 AS cval_lineitem_l_commitdate_4#5538, cval_lineitem_l_receiptdate#5506 AS cval_lineitem_l_receiptdate_4#5539, cval_lineitem_l_shipinstruct#5507 AS cval_lineitem_l_shipinstruct_4#5540, cval_lineitem_l_shipmode#5508 AS cval_lineitem_l_shipmode_4#5541, cval_lineitem_l_comment#5509 AS cval_lineitem_l_comment_4#5542, cval_lineitem_l_shipdate#5510 AS cval_lineitem_l_shipdate_4#5543, cl_quantity#5511 AS cl_quantity_4#5544, cl_extendedprice#5512 AS cl_extendedprice_4#5545, cl_discount#5513 AS cl_discount_4#5546, ... 9 more fields]
         :     :  :     +- Relation[rid#5490,cpfk_orders_lineitem#5491,cpfk_supplier_lineitem#5492,cfpk_lineitem_supplier#5493,cfpk_lineitem_partsupp#5494,cpfk_part_lineitem#5495,cfpk_lineitem_part#5496,cpfk_partsupp_lineitem#5497,cfpk_lineitem_orders#5498,cval_lineitem_l_quantity#5499,cval_lineitem_l_extendedprice#5500,cval_lineitem_l_discount#5501,cval_lineitem_l_tax#5502,cval_lineitem_l_returnflag#5503,cval_lineitem_l_linestatus#5504,cval_lineitem_l_commitdate#5505,cval_lineitem_l_receiptdate#5506,cval_lineitem_l_shipinstruct#5507,cval_lineitem_l_shipmode#5508,cval_lineitem_l_comment#5509,cval_lineitem_l_shipdate#5510,cl_quantity#5511,cl_extendedprice#5512,cl_discount#5513,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#5390 AS rid_4#5423, cpfk_orders_lineitem#5391 AS cpfk_orders_lineitem_4#5424, cpfk_supplier_lineitem#5392 AS cpfk_supplier_lineitem_4#5425, cfpk_lineitem_supplier#5393 AS cfpk_lineitem_supplier_4#5426, cfpk_lineitem_partsupp#5394 AS cfpk_lineitem_partsupp_4#5427, cpfk_part_lineitem#5395 AS cpfk_part_lineitem_4#5428, cfpk_lineitem_part#5396 AS cfpk_lineitem_part_4#5429, cpfk_partsupp_lineitem#5397 AS cpfk_partsupp_lineitem_4#5430, cfpk_lineitem_orders#5398 AS cfpk_lineitem_orders_4#5431, cval_lineitem_l_quantity#5399 AS cval_lineitem_l_quantity_4#5432, cval_lineitem_l_extendedprice#5400 AS cval_lineitem_l_extendedprice_4#5433, cval_lineitem_l_discount#5401 AS cval_lineitem_l_discount_4#5434, cval_lineitem_l_tax#5402 AS cval_lineitem_l_tax_4#5435, cval_lineitem_l_returnflag#5403 AS cval_lineitem_l_returnflag_4#5436, cval_lineitem_l_linestatus#5404 AS cval_lineitem_l_linestatus_4#5437, cval_lineitem_l_commitdate#5405 AS cval_lineitem_l_commitdate_4#5438, cval_lineitem_l_receiptdate#5406 AS cval_lineitem_l_receiptdate_4#5439, cval_lineitem_l_shipinstruct#5407 AS cval_lineitem_l_shipinstruct_4#5440, cval_lineitem_l_shipmode#5408 AS cval_lineitem_l_shipmode_4#5441, cval_lineitem_l_comment#5409 AS cval_lineitem_l_comment_4#5442, cval_lineitem_l_shipdate#5410 AS cval_lineitem_l_shipdate_4#5443, cl_quantity#5411 AS cl_quantity_4#5444, cl_extendedprice#5412 AS cl_extendedprice_4#5445, cl_discount#5413 AS cl_discount_4#5446, ... 9 more fields]
         :     :     +- Relation[rid#5390,cpfk_orders_lineitem#5391,cpfk_supplier_lineitem#5392,cfpk_lineitem_supplier#5393,cfpk_lineitem_partsupp#5394,cpfk_part_lineitem#5395,cfpk_lineitem_part#5396,cpfk_partsupp_lineitem#5397,cfpk_lineitem_orders#5398,cval_lineitem_l_quantity#5399,cval_lineitem_l_extendedprice#5400,cval_lineitem_l_discount#5401,cval_lineitem_l_tax#5402,cval_lineitem_l_returnflag#5403,cval_lineitem_l_linestatus#5404,cval_lineitem_l_commitdate#5405,cval_lineitem_l_receiptdate#5406,cval_lineitem_l_shipinstruct#5407,cval_lineitem_l_shipmode#5408,cval_lineitem_l_comment#5409,cval_lineitem_l_shipdate#5410,cl_quantity#5411,cl_extendedprice#5412,cl_discount#5413,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#5556 AS rid_5#5569, cpfk_nation_supplier#5557 AS cpfk_nation_supplier_5#5570, cfpk_supplier_nation#5558 AS cfpk_supplier_nation_5#5571, cval_supplier_s_name#5559 AS cval_supplier_s_name_5#5572, cval_supplier_s_address#5560 AS cval_supplier_s_address_5#5573, cval_supplier_s_phone#5561 AS cval_supplier_s_phone_5#5574, cval_supplier_s_acctbal#5562 AS cval_supplier_s_acctbal_5#5575, cval_supplier_s_comment#5563 AS cval_supplier_s_comment_5#5576, cs_name#5564 AS cs_name_5#5577, cs_address#5565 AS cs_address_5#5578, cs_phone#5566 AS cs_phone_5#5579, cs_acctbal#5567 AS cs_acctbal_5#5580, cs_comment#5568 AS cs_comment_5#5581]
         :        +- Relation[rid#5556,cpfk_nation_supplier#5557,cfpk_supplier_nation#5558,cval_supplier_s_name#5559,cval_supplier_s_address#5560,cval_supplier_s_phone#5561,cval_supplier_s_acctbal#5562,cval_supplier_s_comment#5563,cs_name#5564,cs_address#5565,cs_phone#5566,cs_acctbal#5567,cs_comment#5568] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#5582 AS rid_1#5589, cpfk_region_nation#5583 AS cpfk_region_nation_1#5590, cfpk_nation_region#5584 AS cfpk_nation_region_1#5591, cval_nation_n_name#5585 AS cval_nation_n_name_1#5592, cval_nation_n_comment#5586 AS cval_nation_n_comment_1#5593, cn_name#5587 AS cn_name_1#5594, cn_comment#5588 AS cn_comment_1#5595]
            :  +- Relation[rid#5582,cpfk_region_nation#5583,cfpk_nation_region#5584,cval_nation_n_name#5585,cval_nation_n_comment#5586,cn_name#5587,cn_comment#5588] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#5596 AS rid_5#5609, cpfk_nation_supplier#5597 AS cpfk_nation_supplier_5#5610, cfpk_supplier_nation#5598 AS cfpk_supplier_nation_5#5611, cval_supplier_s_name#5599 AS cval_supplier_s_name_5#5612, cval_supplier_s_address#5600 AS cval_supplier_s_address_5#5613, cval_supplier_s_phone#5601 AS cval_supplier_s_phone_5#5614, cval_supplier_s_acctbal#5602 AS cval_supplier_s_acctbal_5#5615, cval_supplier_s_comment#5603 AS cval_supplier_s_comment_5#5616, cs_name#5604 AS cs_name_5#5617, cs_address#5605 AS cs_address_5#5618, cs_phone#5606 AS cs_phone_5#5619, cs_acctbal#5607 AS cs_acctbal_5#5620, cs_comment#5608 AS cs_comment_5#5621]
               +- Relation[rid#5596,cpfk_nation_supplier#5597,cfpk_supplier_nation#5598,cval_supplier_s_name#5599,cval_supplier_s_address#5600,cval_supplier_s_phone#5601,cval_supplier_s_acctbal#5602,cval_supplier_s_comment#5603,cs_name#5604,cs_address#5605,cs_phone#5606,cs_acctbal#5607,cs_comment#5608] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1
Elapsed time: 21471ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/15 15:07:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:07:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5717L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:07:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5717L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#5719 AS rid_0#5736, cval_part_p_name#5720 AS cval_part_p_name_0#5737, cval_part_p_mfgr#5721 AS cval_part_p_mfgr_0#5738, cval_part_p_type#5722 AS cval_part_p_type_0#5739, cval_part_p_size#5723 AS cval_part_p_size_0#5740, cval_part_p_container#5724 AS cval_part_p_container_0#5741, cval_part_p_retailprice#5725 AS cval_part_p_retailprice_0#5742, cval_part_p_comment#5726 AS cval_part_p_comment_0#5743, cval_part_p_brand#5727 AS cval_part_p_brand_0#5744, cp_name#5728 AS cp_name_0#5745, cp_mfgr#5729 AS cp_mfgr_0#5746, cp_type#5730 AS cp_type_0#5747, cp_size#5731 AS cp_size_0#5748, cp_container#5732 AS cp_container_0#5749, cp_retailprice#5733 AS cp_retailprice_0#5750, cp_comment#5734 AS cp_comment_0#5751, cp_brand#5735 AS cp_brand_0#5752]
            :  :  :  :  +- Relation[rid#5719,cval_part_p_name#5720,cval_part_p_mfgr#5721,cval_part_p_type#5722,cval_part_p_size#5723,cval_part_p_container#5724,cval_part_p_retailprice#5725,cval_part_p_comment#5726,cval_part_p_brand#5727,cp_name#5728,cp_mfgr#5729,cp_type#5730,cp_size#5731,cp_container#5732,cp_retailprice#5733,cp_comment#5734,cp_brand#5735] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#5753 AS rid_0#5770, cval_part_p_name#5754 AS cval_part_p_name_0#5771, cval_part_p_mfgr#5755 AS cval_part_p_mfgr_0#5772, cval_part_p_type#5756 AS cval_part_p_type_0#5773, cval_part_p_size#5757 AS cval_part_p_size_0#5774, cval_part_p_container#5758 AS cval_part_p_container_0#5775, cval_part_p_retailprice#5759 AS cval_part_p_retailprice_0#5776, cval_part_p_comment#5760 AS cval_part_p_comment_0#5777, cval_part_p_brand#5761 AS cval_part_p_brand_0#5778, cp_name#5762 AS cp_name_0#5779, cp_mfgr#5763 AS cp_mfgr_0#5780, cp_type#5764 AS cp_type_0#5781, cp_size#5765 AS cp_size_0#5782, cp_container#5766 AS cp_container_0#5783, cp_retailprice#5767 AS cp_retailprice_0#5784, cp_comment#5768 AS cp_comment_0#5785, cp_brand#5769 AS cp_brand_0#5786]
            :  :  :        +- Relation[rid#5753,cval_part_p_name#5754,cval_part_p_mfgr#5755,cval_part_p_type#5756,cval_part_p_size#5757,cval_part_p_container#5758,cval_part_p_retailprice#5759,cval_part_p_comment#5760,cval_part_p_brand#5761,cp_name#5762,cp_mfgr#5763,cp_type#5764,cp_size#5765,cp_container#5766,cp_retailprice#5767,cp_comment#5768,cp_brand#5769] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- Project [rid#5843 AS rid_1#5854, cpfk_part_partsupp#5844 AS cpfk_part_partsupp_1#5855, cfpk_partsupp_part#5845 AS cfpk_partsupp_part_1#5856, cpfk_supplier_partsupp#5846 AS cpfk_supplier_partsupp_1#5857, cfpk_partsupp_supplier#5847 AS cfpk_partsupp_supplier_1#5858, cval_partsupp_ps_availqty#5848 AS cval_partsupp_ps_availqty_1#5859, cval_partsupp_ps_supplycost#5849 AS cval_partsupp_ps_supplycost_1#5860, cval_partsupp_ps_comment#5850 AS cval_partsupp_ps_comment_1#5861, cps_availqty#5851 AS cps_availqty_1#5862, cps_supplycost#5852 AS cps_supplycost_1#5863, cps_comment#5853 AS cps_comment_1#5864]
            :  :     +- Relation[rid#5843,cpfk_part_partsupp#5844,cfpk_partsupp_part#5845,cpfk_supplier_partsupp#5846,cfpk_partsupp_supplier#5847,cval_partsupp_ps_availqty#5848,cval_partsupp_ps_supplycost#5849,cval_partsupp_ps_comment#5850,cps_availqty#5851,cps_supplycost#5852,cps_comment#5853] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#5787 AS rid_1#5798, cpfk_part_partsupp#5788 AS cpfk_part_partsupp_1#5799, cfpk_partsupp_part#5789 AS cfpk_partsupp_part_1#5800, cpfk_supplier_partsupp#5790 AS cpfk_supplier_partsupp_1#5801, cfpk_partsupp_supplier#5791 AS cfpk_partsupp_supplier_1#5802, cval_partsupp_ps_availqty#5792 AS cval_partsupp_ps_availqty_1#5803, cval_partsupp_ps_supplycost#5793 AS cval_partsupp_ps_supplycost_1#5804, cval_partsupp_ps_comment#5794 AS cval_partsupp_ps_comment_1#5805, cps_availqty#5795 AS cps_availqty_1#5806, cps_supplycost#5796 AS cps_supplycost_1#5807, cps_comment#5797 AS cps_comment_1#5808]
            :     +- Relation[rid#5787,cpfk_part_partsupp#5788,cfpk_partsupp_part#5789,cpfk_supplier_partsupp#5790,cfpk_partsupp_supplier#5791,cval_partsupp_ps_availqty#5792,cval_partsupp_ps_supplycost#5793,cval_partsupp_ps_comment#5794,cps_availqty#5795,cps_supplycost#5796,cps_comment#5797] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#5865 AS rid_2#5872, cpfk_region_nation#5866 AS cpfk_region_nation_2#5873, cfpk_nation_region#5867 AS cfpk_nation_region_2#5874, cval_nation_n_name#5868 AS cval_nation_n_name_2#5875, cval_nation_n_comment#5869 AS cval_nation_n_comment_2#5876, cn_name#5870 AS cn_name_2#5877, cn_comment#5871 AS cn_comment_2#5878]
               :  :  :  +- Relation[rid#5865,cpfk_region_nation#5866,cfpk_nation_region#5867,cval_nation_n_name#5868,cval_nation_n_comment#5869,cn_name#5870,cn_comment#5871] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#5879 AS rid_2#5886, cpfk_region_nation#5880 AS cpfk_region_nation_2#5887, cfpk_nation_region#5881 AS cfpk_nation_region_2#5888, cval_nation_n_name#5882 AS cval_nation_n_name_2#5889, cval_nation_n_comment#5883 AS cval_nation_n_comment_2#5890, cn_name#5884 AS cn_name_2#5891, cn_comment#5885 AS cn_comment_2#5892]
               :  :        +- Relation[rid#5879,cpfk_region_nation#5880,cfpk_nation_region#5881,cval_nation_n_name#5882,cval_nation_n_comment#5883,cn_name#5884,cn_comment#5885] JDBCRelation(tnation) [numPartitions=1]
               :  +- Project [rid#5933 AS rid_3#5946, cpfk_nation_supplier#5934 AS cpfk_nation_supplier_3#5947, cfpk_supplier_nation#5935 AS cfpk_supplier_nation_3#5948, cval_supplier_s_name#5936 AS cval_supplier_s_name_3#5949, cval_supplier_s_address#5937 AS cval_supplier_s_address_3#5950, cval_supplier_s_phone#5938 AS cval_supplier_s_phone_3#5951, cval_supplier_s_acctbal#5939 AS cval_supplier_s_acctbal_3#5952, cval_supplier_s_comment#5940 AS cval_supplier_s_comment_3#5953, cs_name#5941 AS cs_name_3#5954, cs_address#5942 AS cs_address_3#5955, cs_phone#5943 AS cs_phone_3#5956, cs_acctbal#5944 AS cs_acctbal_3#5957, cs_comment#5945 AS cs_comment_3#5958]
               :     +- Relation[rid#5933,cpfk_nation_supplier#5934,cfpk_supplier_nation#5935,cval_supplier_s_name#5936,cval_supplier_s_address#5937,cval_supplier_s_phone#5938,cval_supplier_s_acctbal#5939,cval_supplier_s_comment#5940,cs_name#5941,cs_address#5942,cs_phone#5943,cs_acctbal#5944,cs_comment#5945] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#5893 AS rid_3#5906, cpfk_nation_supplier#5894 AS cpfk_nation_supplier_3#5907, cfpk_supplier_nation#5895 AS cfpk_supplier_nation_3#5908, cval_supplier_s_name#5896 AS cval_supplier_s_name_3#5909, cval_supplier_s_address#5897 AS cval_supplier_s_address_3#5910, cval_supplier_s_phone#5898 AS cval_supplier_s_phone_3#5911, cval_supplier_s_acctbal#5899 AS cval_supplier_s_acctbal_3#5912, cval_supplier_s_comment#5900 AS cval_supplier_s_comment_3#5913, cs_name#5901 AS cs_name_3#5914, cs_address#5902 AS cs_address_3#5915, cs_phone#5903 AS cs_phone_3#5916, cs_acctbal#5904 AS cs_acctbal_3#5917, cs_comment#5905 AS cs_comment_3#5918]
                  +- Relation[rid#5893,cpfk_nation_supplier#5894,cfpk_supplier_nation#5895,cval_supplier_s_name#5896,cval_supplier_s_address#5897,cval_supplier_s_phone#5898,cval_supplier_s_acctbal#5899,cval_supplier_s_comment#5900,cs_name#5901,cs_address#5902,cs_phone#5903,cs_acctbal#5904,cs_comment#5905] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1
Elapsed time: 780ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/15 15:07:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:07:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6013L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:07:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:07:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6013L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#6015 AS rid_0#6022, cpfk_region_nation#6016 AS cpfk_region_nation_0#6023, cfpk_nation_region#6017 AS cfpk_nation_region_0#6024, cval_nation_n_name#6018 AS cval_nation_n_name_0#6025, cval_nation_n_comment#6019 AS cval_nation_n_comment_0#6026, cn_name#6020 AS cn_name_0#6027, cn_comment#6021 AS cn_comment_0#6028]
         :  :  :  :  :  +- Relation[rid#6015,cpfk_region_nation#6016,cfpk_nation_region#6017,cval_nation_n_name#6018,cval_nation_n_comment#6019,cn_name#6020,cn_comment#6021] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#6029 AS rid_0#6036, cpfk_region_nation#6030 AS cpfk_region_nation_0#6037, cfpk_nation_region#6031 AS cfpk_nation_region_0#6038, cval_nation_n_name#6032 AS cval_nation_n_name_0#6039, cval_nation_n_comment#6033 AS cval_nation_n_comment_0#6040, cn_name#6034 AS cn_name_0#6041, cn_comment#6035 AS cn_comment_0#6042]
         :  :  :  :        +- Relation[rid#6029,cpfk_region_nation#6030,cfpk_nation_region#6031,cval_nation_n_name#6032,cval_nation_n_comment#6033,cn_name#6034,cn_comment#6035] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#6083 AS rid_1#6096, cpfk_nation_supplier#6084 AS cpfk_nation_supplier_1#6097, cfpk_supplier_nation#6085 AS cfpk_supplier_nation_1#6098, cval_supplier_s_name#6086 AS cval_supplier_s_name_1#6099, cval_supplier_s_address#6087 AS cval_supplier_s_address_1#6100, cval_supplier_s_phone#6088 AS cval_supplier_s_phone_1#6101, cval_supplier_s_acctbal#6089 AS cval_supplier_s_acctbal_1#6102, cval_supplier_s_comment#6090 AS cval_supplier_s_comment_1#6103, cs_name#6091 AS cs_name_1#6104, cs_address#6092 AS cs_address_1#6105, cs_phone#6093 AS cs_phone_1#6106, cs_acctbal#6094 AS cs_acctbal_1#6107, cs_comment#6095 AS cs_comment_1#6108]
         :  :  :     +- Relation[rid#6083,cpfk_nation_supplier#6084,cfpk_supplier_nation#6085,cval_supplier_s_name#6086,cval_supplier_s_address#6087,cval_supplier_s_phone#6088,cval_supplier_s_acctbal#6089,cval_supplier_s_comment#6090,cs_name#6091,cs_address#6092,cs_phone#6093,cs_acctbal#6094,cs_comment#6095] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#6043 AS rid_1#6056, cpfk_nation_supplier#6044 AS cpfk_nation_supplier_1#6057, cfpk_supplier_nation#6045 AS cfpk_supplier_nation_1#6058, cval_supplier_s_name#6046 AS cval_supplier_s_name_1#6059, cval_supplier_s_address#6047 AS cval_supplier_s_address_1#6060, cval_supplier_s_phone#6048 AS cval_supplier_s_phone_1#6061, cval_supplier_s_acctbal#6049 AS cval_supplier_s_acctbal_1#6062, cval_supplier_s_comment#6050 AS cval_supplier_s_comment_1#6063, cs_name#6051 AS cs_name_1#6064, cs_address#6052 AS cs_address_1#6065, cs_phone#6053 AS cs_phone_1#6066, cs_acctbal#6054 AS cs_acctbal_1#6067, cs_comment#6055 AS cs_comment_1#6068]
         :  :     +- Relation[rid#6043,cpfk_nation_supplier#6044,cfpk_supplier_nation#6045,cval_supplier_s_name#6046,cval_supplier_s_address#6047,cval_supplier_s_phone#6048,cval_supplier_s_acctbal#6049,cval_supplier_s_comment#6050,cs_name#6051,cs_address#6052,cs_phone#6053,cs_acctbal#6054,cs_comment#6055] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#6157 AS rid_2#6168, cpfk_part_partsupp#6158 AS cpfk_part_partsupp_2#6169, cfpk_partsupp_part#6159 AS cfpk_partsupp_part_2#6170, cpfk_supplier_partsupp#6160 AS cpfk_supplier_partsupp_2#6171, cfpk_partsupp_supplier#6161 AS cfpk_partsupp_supplier_2#6172, cval_partsupp_ps_availqty#6162 AS cval_partsupp_ps_availqty_2#6173, cval_partsupp_ps_supplycost#6163 AS cval_partsupp_ps_supplycost_2#6174, cval_partsupp_ps_comment#6164 AS cval_partsupp_ps_comment_2#6175, cps_availqty#6165 AS cps_availqty_2#6176, cps_supplycost#6166 AS cps_supplycost_2#6177, cps_comment#6167 AS cps_comment_2#6178]
         :     +- Relation[rid#6157,cpfk_part_partsupp#6158,cfpk_partsupp_part#6159,cpfk_supplier_partsupp#6160,cfpk_partsupp_supplier#6161,cval_partsupp_ps_availqty#6162,cval_partsupp_ps_supplycost#6163,cval_partsupp_ps_comment#6164,cps_availqty#6165,cps_supplycost#6166,cps_comment#6167] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#6109 AS rid_2#6120, cpfk_part_partsupp#6110 AS cpfk_part_partsupp_2#6121, cfpk_partsupp_part#6111 AS cfpk_partsupp_part_2#6122, cpfk_supplier_partsupp#6112 AS cpfk_supplier_partsupp_2#6123, cfpk_partsupp_supplier#6113 AS cfpk_partsupp_supplier_2#6124, cval_partsupp_ps_availqty#6114 AS cval_partsupp_ps_availqty_2#6125, cval_partsupp_ps_supplycost#6115 AS cval_partsupp_ps_supplycost_2#6126, cval_partsupp_ps_comment#6116 AS cval_partsupp_ps_comment_2#6127, cps_availqty#6117 AS cps_availqty_2#6128, cps_supplycost#6118 AS cps_supplycost_2#6129, cps_comment#6119 AS cps_comment_2#6130]
            +- Relation[rid#6109,cpfk_part_partsupp#6110,cfpk_partsupp_part#6111,cpfk_supplier_partsupp#6112,cfpk_partsupp_supplier#6113,cval_partsupp_ps_availqty#6114,cval_partsupp_ps_supplycost#6115,cval_partsupp_ps_comment#6116,cps_availqty#6117,cps_supplycost#6118,cps_comment#6119] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=1188
Elapsed time: 1281ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/15 15:07:44 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:07:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6217L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:07:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:07:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:07:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:07:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6217L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#6219 AS rid_0#6232, cpfk_nation_supplier#6220 AS cpfk_nation_supplier_0#6233, cfpk_supplier_nation#6221 AS cfpk_supplier_nation_0#6234, cval_supplier_s_name#6222 AS cval_supplier_s_name_0#6235, cval_supplier_s_address#6223 AS cval_supplier_s_address_0#6236, cval_supplier_s_phone#6224 AS cval_supplier_s_phone_0#6237, cval_supplier_s_acctbal#6225 AS cval_supplier_s_acctbal_0#6238, cval_supplier_s_comment#6226 AS cval_supplier_s_comment_0#6239, cs_name#6227 AS cs_name_0#6240, cs_address#6228 AS cs_address_0#6241, cs_phone#6229 AS cs_phone_0#6242, cs_acctbal#6230 AS cs_acctbal_0#6243, cs_comment#6231 AS cs_comment_0#6244]
         :  :  +- Relation[rid#6219,cpfk_nation_supplier#6220,cfpk_supplier_nation#6221,cval_supplier_s_name#6222,cval_supplier_s_address#6223,cval_supplier_s_phone#6224,cval_supplier_s_acctbal#6225,cval_supplier_s_comment#6226,cs_name#6227,cs_address#6228,cs_phone#6229,cs_acctbal#6230,cs_comment#6231] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#6311 AS rid_0#6324, cpfk_nation_supplier#6312 AS cpfk_nation_supplier_0#6325, cfpk_supplier_nation#6313 AS cfpk_supplier_nation_0#6326, cval_supplier_s_name#6314 AS cval_supplier_s_name_0#6327, cval_supplier_s_address#6315 AS cval_supplier_s_address_0#6328, cval_supplier_s_phone#6316 AS cval_supplier_s_phone_0#6329, cval_supplier_s_acctbal#6317 AS cval_supplier_s_acctbal_0#6330, cval_supplier_s_comment#6318 AS cval_supplier_s_comment_0#6331, cs_name#6319 AS cs_name_0#6332, cs_address#6320 AS cs_address_0#6333, cs_phone#6321 AS cs_phone_0#6334, cs_acctbal#6322 AS cs_acctbal_0#6335, cs_comment#6323 AS cs_comment_0#6336]
         :     :  +- Relation[rid#6311,cpfk_nation_supplier#6312,cfpk_supplier_nation#6313,cval_supplier_s_name#6314,cval_supplier_s_address#6315,cval_supplier_s_phone#6316,cval_supplier_s_acctbal#6317,cval_supplier_s_comment#6318,cs_name#6319,cs_address#6320,cs_phone#6321,cs_acctbal#6322,cs_comment#6323] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#6337 AS rid_1#6370, cpfk_orders_lineitem#6338 AS cpfk_orders_lineitem_1#6371, cpfk_supplier_lineitem#6339 AS cpfk_supplier_lineitem_1#6372, cfpk_lineitem_supplier#6340 AS cfpk_lineitem_supplier_1#6373, cfpk_lineitem_partsupp#6341 AS cfpk_lineitem_partsupp_1#6374, cpfk_part_lineitem#6342 AS cpfk_part_lineitem_1#6375, cfpk_lineitem_part#6343 AS cfpk_lineitem_part_1#6376, cpfk_partsupp_lineitem#6344 AS cpfk_partsupp_lineitem_1#6377, cfpk_lineitem_orders#6345 AS cfpk_lineitem_orders_1#6378, cval_lineitem_l_quantity#6346 AS cval_lineitem_l_quantity_1#6379, cval_lineitem_l_extendedprice#6347 AS cval_lineitem_l_extendedprice_1#6380, cval_lineitem_l_discount#6348 AS cval_lineitem_l_discount_1#6381, cval_lineitem_l_tax#6349 AS cval_lineitem_l_tax_1#6382, cval_lineitem_l_returnflag#6350 AS cval_lineitem_l_returnflag_1#6383, cval_lineitem_l_linestatus#6351 AS cval_lineitem_l_linestatus_1#6384, cval_lineitem_l_commitdate#6352 AS cval_lineitem_l_commitdate_1#6385, cval_lineitem_l_receiptdate#6353 AS cval_lineitem_l_receiptdate_1#6386, cval_lineitem_l_shipinstruct#6354 AS cval_lineitem_l_shipinstruct_1#6387, cval_lineitem_l_shipmode#6355 AS cval_lineitem_l_shipmode_1#6388, cval_lineitem_l_comment#6356 AS cval_lineitem_l_comment_1#6389, cval_lineitem_l_shipdate#6357 AS cval_lineitem_l_shipdate_1#6390, cl_quantity#6358 AS cl_quantity_1#6391, cl_extendedprice#6359 AS cl_extendedprice_1#6392, cl_discount#6360 AS cl_discount_1#6393, ... 9 more fields]
         :        +- Relation[rid#6337,cpfk_orders_lineitem#6338,cpfk_supplier_lineitem#6339,cfpk_lineitem_supplier#6340,cfpk_lineitem_partsupp#6341,cpfk_part_lineitem#6342,cfpk_lineitem_part#6343,cpfk_partsupp_lineitem#6344,cfpk_lineitem_orders#6345,cval_lineitem_l_quantity#6346,cval_lineitem_l_extendedprice#6347,cval_lineitem_l_discount#6348,cval_lineitem_l_tax#6349,cval_lineitem_l_returnflag#6350,cval_lineitem_l_linestatus#6351,cval_lineitem_l_commitdate#6352,cval_lineitem_l_receiptdate#6353,cval_lineitem_l_shipinstruct#6354,cval_lineitem_l_shipmode#6355,cval_lineitem_l_comment#6356,cval_lineitem_l_shipdate#6357,cl_quantity#6358,cl_extendedprice#6359,cl_discount#6360,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6245 AS rid_1#6278, cpfk_orders_lineitem#6246 AS cpfk_orders_lineitem_1#6279, cpfk_supplier_lineitem#6247 AS cpfk_supplier_lineitem_1#6280, cfpk_lineitem_supplier#6248 AS cfpk_lineitem_supplier_1#6281, cfpk_lineitem_partsupp#6249 AS cfpk_lineitem_partsupp_1#6282, cpfk_part_lineitem#6250 AS cpfk_part_lineitem_1#6283, cfpk_lineitem_part#6251 AS cfpk_lineitem_part_1#6284, cpfk_partsupp_lineitem#6252 AS cpfk_partsupp_lineitem_1#6285, cfpk_lineitem_orders#6253 AS cfpk_lineitem_orders_1#6286, cval_lineitem_l_quantity#6254 AS cval_lineitem_l_quantity_1#6287, cval_lineitem_l_extendedprice#6255 AS cval_lineitem_l_extendedprice_1#6288, cval_lineitem_l_discount#6256 AS cval_lineitem_l_discount_1#6289, cval_lineitem_l_tax#6257 AS cval_lineitem_l_tax_1#6290, cval_lineitem_l_returnflag#6258 AS cval_lineitem_l_returnflag_1#6291, cval_lineitem_l_linestatus#6259 AS cval_lineitem_l_linestatus_1#6292, cval_lineitem_l_commitdate#6260 AS cval_lineitem_l_commitdate_1#6293, cval_lineitem_l_receiptdate#6261 AS cval_lineitem_l_receiptdate_1#6294, cval_lineitem_l_shipinstruct#6262 AS cval_lineitem_l_shipinstruct_1#6295, cval_lineitem_l_shipmode#6263 AS cval_lineitem_l_shipmode_1#6296, cval_lineitem_l_comment#6264 AS cval_lineitem_l_comment_1#6297, cval_lineitem_l_shipdate#6265 AS cval_lineitem_l_shipdate_1#6298, cl_quantity#6266 AS cl_quantity_1#6299, cl_extendedprice#6267 AS cl_extendedprice_1#6300, cl_discount#6268 AS cl_discount_1#6301, ... 9 more fields]
            +- Relation[rid#6245,cpfk_orders_lineitem#6246,cpfk_supplier_lineitem#6247,cfpk_lineitem_supplier#6248,cfpk_lineitem_partsupp#6249,cpfk_part_lineitem#6250,cfpk_lineitem_part#6251,cpfk_partsupp_lineitem#6252,cfpk_lineitem_orders#6253,cval_lineitem_l_quantity#6254,cval_lineitem_l_extendedprice#6255,cval_lineitem_l_discount#6256,cval_lineitem_l_tax#6257,cval_lineitem_l_returnflag#6258,cval_lineitem_l_linestatus#6259,cval_lineitem_l_commitdate#6260,cval_lineitem_l_receiptdate#6261,cval_lineitem_l_shipinstruct#6262,cval_lineitem_l_shipmode#6263,cval_lineitem_l_comment#6264,cval_lineitem_l_shipdate#6265,cl_quantity#6266,cl_extendedprice#6267,cl_discount#6268,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 84957ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/15 15:09:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:09:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6454L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:09:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#6454L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#6456 AS rid_0#6489, cpfk_orders_lineitem#6457 AS cpfk_orders_lineitem_0#6490, cpfk_supplier_lineitem#6458 AS cpfk_supplier_lineitem_0#6491, cfpk_lineitem_supplier#6459 AS cfpk_lineitem_supplier_0#6492, cfpk_lineitem_partsupp#6460 AS cfpk_lineitem_partsupp_0#6493, cpfk_part_lineitem#6461 AS cpfk_part_lineitem_0#6494, cfpk_lineitem_part#6462 AS cfpk_lineitem_part_0#6495, cpfk_partsupp_lineitem#6463 AS cpfk_partsupp_lineitem_0#6496, cfpk_lineitem_orders#6464 AS cfpk_lineitem_orders_0#6497, cval_lineitem_l_quantity#6465 AS cval_lineitem_l_quantity_0#6498, cval_lineitem_l_extendedprice#6466 AS cval_lineitem_l_extendedprice_0#6499, cval_lineitem_l_discount#6467 AS cval_lineitem_l_discount_0#6500, cval_lineitem_l_tax#6468 AS cval_lineitem_l_tax_0#6501, cval_lineitem_l_returnflag#6469 AS cval_lineitem_l_returnflag_0#6502, cval_lineitem_l_linestatus#6470 AS cval_lineitem_l_linestatus_0#6503, cval_lineitem_l_commitdate#6471 AS cval_lineitem_l_commitdate_0#6504, cval_lineitem_l_receiptdate#6472 AS cval_lineitem_l_receiptdate_0#6505, cval_lineitem_l_shipinstruct#6473 AS cval_lineitem_l_shipinstruct_0#6506, cval_lineitem_l_shipmode#6474 AS cval_lineitem_l_shipmode_0#6507, cval_lineitem_l_comment#6475 AS cval_lineitem_l_comment_0#6508, cval_lineitem_l_shipdate#6476 AS cval_lineitem_l_shipdate_0#6509, cl_quantity#6477 AS cl_quantity_0#6510, cl_extendedprice#6478 AS cl_extendedprice_0#6511, cl_discount#6479 AS cl_discount_0#6512, ... 9 more fields]
         +- Relation[rid#6456,cpfk_orders_lineitem#6457,cpfk_supplier_lineitem#6458,cfpk_lineitem_supplier#6459,cfpk_lineitem_partsupp#6460,cpfk_part_lineitem#6461,cfpk_lineitem_part#6462,cpfk_partsupp_lineitem#6463,cfpk_lineitem_orders#6464,cval_lineitem_l_quantity#6465,cval_lineitem_l_extendedprice#6466,cval_lineitem_l_discount#6467,cval_lineitem_l_tax#6468,cval_lineitem_l_returnflag#6469,cval_lineitem_l_linestatus#6470,cval_lineitem_l_commitdate#6471,cval_lineitem_l_receiptdate#6472,cval_lineitem_l_shipinstruct#6473,cval_lineitem_l_shipmode#6474,cval_lineitem_l_comment#6475,cval_lineitem_l_shipdate#6476,cl_quantity#6477,cl_extendedprice#6478,cl_discount#6479,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2756ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/15 15:09:11 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:09:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6562L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 15:09:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:09:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:09:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:09:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6562L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#6564 AS rid_0#6581, cval_part_p_name#6565 AS cval_part_p_name_0#6582, cval_part_p_mfgr#6566 AS cval_part_p_mfgr_0#6583, cval_part_p_type#6567 AS cval_part_p_type_0#6584, cval_part_p_size#6568 AS cval_part_p_size_0#6585, cval_part_p_container#6569 AS cval_part_p_container_0#6586, cval_part_p_retailprice#6570 AS cval_part_p_retailprice_0#6587, cval_part_p_comment#6571 AS cval_part_p_comment_0#6588, cval_part_p_brand#6572 AS cval_part_p_brand_0#6589, cp_name#6573 AS cp_name_0#6590, cp_mfgr#6574 AS cp_mfgr_0#6591, cp_type#6575 AS cp_type_0#6592, cp_size#6576 AS cp_size_0#6593, cp_container#6577 AS cp_container_0#6594, cp_retailprice#6578 AS cp_retailprice_0#6595, cp_comment#6579 AS cp_comment_0#6596, cp_brand#6580 AS cp_brand_0#6597]
         :  :  :  +- Relation[rid#6564,cval_part_p_name#6565,cval_part_p_mfgr#6566,cval_part_p_type#6567,cval_part_p_size#6568,cval_part_p_container#6569,cval_part_p_retailprice#6570,cval_part_p_comment#6571,cval_part_p_brand#6572,cp_name#6573,cp_mfgr#6574,cp_type#6575,cp_size#6576,cp_container#6577,cp_retailprice#6578,cp_comment#6579,cp_brand#6580] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#6598 AS rid_0#6615, cval_part_p_name#6599 AS cval_part_p_name_0#6616, cval_part_p_mfgr#6600 AS cval_part_p_mfgr_0#6617, cval_part_p_type#6601 AS cval_part_p_type_0#6618, cval_part_p_size#6602 AS cval_part_p_size_0#6619, cval_part_p_container#6603 AS cval_part_p_container_0#6620, cval_part_p_retailprice#6604 AS cval_part_p_retailprice_0#6621, cval_part_p_comment#6605 AS cval_part_p_comment_0#6622, cval_part_p_brand#6606 AS cval_part_p_brand_0#6623, cp_name#6607 AS cp_name_0#6624, cp_mfgr#6608 AS cp_mfgr_0#6625, cp_type#6609 AS cp_type_0#6626, cp_size#6610 AS cp_size_0#6627, cp_container#6611 AS cp_container_0#6628, cp_retailprice#6612 AS cp_retailprice_0#6629, cp_comment#6613 AS cp_comment_0#6630, cp_brand#6614 AS cp_brand_0#6631]
         :  :        +- Relation[rid#6598,cval_part_p_name#6599,cval_part_p_mfgr#6600,cval_part_p_type#6601,cval_part_p_size#6602,cval_part_p_container#6603,cval_part_p_retailprice#6604,cval_part_p_comment#6605,cval_part_p_brand#6606,cp_name#6607,cp_mfgr#6608,cp_type#6609,cp_size#6610,cp_container#6611,cp_retailprice#6612,cp_comment#6613,cp_brand#6614] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#6688 AS rid_1#6699, cpfk_part_partsupp#6689 AS cpfk_part_partsupp_1#6700, cfpk_partsupp_part#6690 AS cfpk_partsupp_part_1#6701, cpfk_supplier_partsupp#6691 AS cpfk_supplier_partsupp_1#6702, cfpk_partsupp_supplier#6692 AS cfpk_partsupp_supplier_1#6703, cval_partsupp_ps_availqty#6693 AS cval_partsupp_ps_availqty_1#6704, cval_partsupp_ps_supplycost#6694 AS cval_partsupp_ps_supplycost_1#6705, cval_partsupp_ps_comment#6695 AS cval_partsupp_ps_comment_1#6706, cps_availqty#6696 AS cps_availqty_1#6707, cps_supplycost#6697 AS cps_supplycost_1#6708, cps_comment#6698 AS cps_comment_1#6709]
         :     +- Relation[rid#6688,cpfk_part_partsupp#6689,cfpk_partsupp_part#6690,cpfk_supplier_partsupp#6691,cfpk_partsupp_supplier#6692,cval_partsupp_ps_availqty#6693,cval_partsupp_ps_supplycost#6694,cval_partsupp_ps_comment#6695,cps_availqty#6696,cps_supplycost#6697,cps_comment#6698] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#6632 AS rid_1#6643, cpfk_part_partsupp#6633 AS cpfk_part_partsupp_1#6644, cfpk_partsupp_part#6634 AS cfpk_partsupp_part_1#6645, cpfk_supplier_partsupp#6635 AS cpfk_supplier_partsupp_1#6646, cfpk_partsupp_supplier#6636 AS cfpk_partsupp_supplier_1#6647, cval_partsupp_ps_availqty#6637 AS cval_partsupp_ps_availqty_1#6648, cval_partsupp_ps_supplycost#6638 AS cval_partsupp_ps_supplycost_1#6649, cval_partsupp_ps_comment#6639 AS cval_partsupp_ps_comment_1#6650, cps_availqty#6640 AS cps_availqty_1#6651, cps_supplycost#6641 AS cps_supplycost_1#6652, cps_comment#6642 AS cps_comment_1#6653]
            +- Relation[rid#6632,cpfk_part_partsupp#6633,cfpk_partsupp_part#6634,cpfk_supplier_partsupp#6635,cfpk_partsupp_supplier#6636,cval_partsupp_ps_availqty#6637,cval_partsupp_ps_supplycost#6638,cval_partsupp_ps_comment#6639,cps_availqty#6640,cps_supplycost#6641,cps_comment#6642] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=7890
Elapsed time: 488ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/15 15:09:12 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:09:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6747L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:09:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6747L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#6749 AS rid_0#6764, cpfk_nation_customer#6750 AS cpfk_nation_customer_0#6765, cfpk_customer_nation#6751 AS cfpk_customer_nation_0#6766, cval_customer_c_name#6752 AS cval_customer_c_name_0#6767, cval_customer_c_address#6753 AS cval_customer_c_address_0#6768, cval_customer_c_phone#6754 AS cval_customer_c_phone_0#6769, cval_customer_c_acctbal#6755 AS cval_customer_c_acctbal_0#6770, cval_customer_c_comment#6756 AS cval_customer_c_comment_0#6771, cval_customer_c_mktsegment#6757 AS cval_customer_c_mktsegment_0#6772, cc_name#6758 AS cc_name_0#6773, cc_address#6759 AS cc_address_0#6774, cc_phone#6760 AS cc_phone_0#6775, cc_acctbal#6761 AS cc_acctbal_0#6776, cc_comment#6762 AS cc_comment_0#6777, cc_mktsegment#6763 AS cc_mktsegment_0#6778]
         :  :  :  :  +- Relation[rid#6749,cpfk_nation_customer#6750,cfpk_customer_nation#6751,cval_customer_c_name#6752,cval_customer_c_address#6753,cval_customer_c_phone#6754,cval_customer_c_acctbal#6755,cval_customer_c_comment#6756,cval_customer_c_mktsegment#6757,cc_name#6758,cc_address#6759,cc_phone#6760,cc_acctbal#6761,cc_comment#6762,cc_mktsegment#6763] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#6813 AS rid_0#6828, cpfk_nation_customer#6814 AS cpfk_nation_customer_0#6829, cfpk_customer_nation#6815 AS cfpk_customer_nation_0#6830, cval_customer_c_name#6816 AS cval_customer_c_name_0#6831, cval_customer_c_address#6817 AS cval_customer_c_address_0#6832, cval_customer_c_phone#6818 AS cval_customer_c_phone_0#6833, cval_customer_c_acctbal#6819 AS cval_customer_c_acctbal_0#6834, cval_customer_c_comment#6820 AS cval_customer_c_comment_0#6835, cval_customer_c_mktsegment#6821 AS cval_customer_c_mktsegment_0#6836, cc_name#6822 AS cc_name_0#6837, cc_address#6823 AS cc_address_0#6838, cc_phone#6824 AS cc_phone_0#6839, cc_acctbal#6825 AS cc_acctbal_0#6840, cc_comment#6826 AS cc_comment_0#6841, cc_mktsegment#6827 AS cc_mktsegment_0#6842]
         :  :  :     :  +- Relation[rid#6813,cpfk_nation_customer#6814,cfpk_customer_nation#6815,cval_customer_c_name#6816,cval_customer_c_address#6817,cval_customer_c_phone#6818,cval_customer_c_acctbal#6819,cval_customer_c_comment#6820,cval_customer_c_mktsegment#6821,cc_name#6822,cc_address#6823,cc_phone#6824,cc_acctbal#6825,cc_comment#6826,cc_mktsegment#6827] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#6843 AS rid_1#6860, cpfk_customer_orders#6844 AS cpfk_customer_orders_1#6861, cfpk_orders_customer#6845 AS cfpk_orders_customer_1#6862, cval_orders_o_orderstatus#6846 AS cval_orders_o_orderstatus_1#6863, cval_orders_o_totalprice#6847 AS cval_orders_o_totalprice_1#6864, cval_orders_o_orderpriority#6848 AS cval_orders_o_orderpriority_1#6865, cval_orders_o_clerk#6849 AS cval_orders_o_clerk_1#6866, cval_orders_o_shippriority#6850 AS cval_orders_o_shippriority_1#6867, cval_orders_o_comment#6851 AS cval_orders_o_comment_1#6868, cval_orders_o_orderdate#6852 AS cval_orders_o_orderdate_1#6869, co_orderstatus#6853 AS co_orderstatus_1#6870, co_totalprice#6854 AS co_totalprice_1#6871, co_orderpriority#6855 AS co_orderpriority_1#6872, co_clerk#6856 AS co_clerk_1#6873, co_shippriority#6857 AS co_shippriority_1#6874, co_comment#6858 AS co_comment_1#6875, co_orderdate#6859 AS co_orderdate_1#6876]
         :  :  :        +- Relation[rid#6843,cpfk_customer_orders#6844,cfpk_orders_customer#6845,cval_orders_o_orderstatus#6846,cval_orders_o_totalprice#6847,cval_orders_o_orderpriority#6848,cval_orders_o_clerk#6849,cval_orders_o_shippriority#6850,cval_orders_o_comment#6851,cval_orders_o_orderdate#6852,co_orderstatus#6853,co_totalprice#6854,co_orderpriority#6855,co_clerk#6856,co_shippriority#6857,co_comment#6858,co_orderdate#6859] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#6779 AS rid_1#6796, cpfk_customer_orders#6780 AS cpfk_customer_orders_1#6797, cfpk_orders_customer#6781 AS cfpk_orders_customer_1#6798, cval_orders_o_orderstatus#6782 AS cval_orders_o_orderstatus_1#6799, cval_orders_o_totalprice#6783 AS cval_orders_o_totalprice_1#6800, cval_orders_o_orderpriority#6784 AS cval_orders_o_orderpriority_1#6801, cval_orders_o_clerk#6785 AS cval_orders_o_clerk_1#6802, cval_orders_o_shippriority#6786 AS cval_orders_o_shippriority_1#6803, cval_orders_o_comment#6787 AS cval_orders_o_comment_1#6804, cval_orders_o_orderdate#6788 AS cval_orders_o_orderdate_1#6805, co_orderstatus#6789 AS co_orderstatus_1#6806, co_totalprice#6790 AS co_totalprice_1#6807, co_orderpriority#6791 AS co_orderpriority_1#6808, co_clerk#6792 AS co_clerk_1#6809, co_shippriority#6793 AS co_shippriority_1#6810, co_comment#6794 AS co_comment_1#6811, co_orderdate#6795 AS co_orderdate_1#6812]
         :  :     +- Relation[rid#6779,cpfk_customer_orders#6780,cfpk_orders_customer#6781,cval_orders_o_orderstatus#6782,cval_orders_o_totalprice#6783,cval_orders_o_orderpriority#6784,cval_orders_o_clerk#6785,cval_orders_o_shippriority#6786,cval_orders_o_comment#6787,cval_orders_o_orderdate#6788,co_orderstatus#6789,co_totalprice#6790,co_orderpriority#6791,co_clerk#6792,co_shippriority#6793,co_comment#6794,co_orderdate#6795] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#6943 AS rid_1#6960, cpfk_customer_orders#6944 AS cpfk_customer_orders_1#6961, cfpk_orders_customer#6945 AS cfpk_orders_customer_1#6962, cval_orders_o_orderstatus#6946 AS cval_orders_o_orderstatus_1#6963, cval_orders_o_totalprice#6947 AS cval_orders_o_totalprice_1#6964, cval_orders_o_orderpriority#6948 AS cval_orders_o_orderpriority_1#6965, cval_orders_o_clerk#6949 AS cval_orders_o_clerk_1#6966, cval_orders_o_shippriority#6950 AS cval_orders_o_shippriority_1#6967, cval_orders_o_comment#6951 AS cval_orders_o_comment_1#6968, cval_orders_o_orderdate#6952 AS cval_orders_o_orderdate_1#6969, co_orderstatus#6953 AS co_orderstatus_1#6970, co_totalprice#6954 AS co_totalprice_1#6971, co_orderpriority#6955 AS co_orderpriority_1#6972, co_clerk#6956 AS co_clerk_1#6973, co_shippriority#6957 AS co_shippriority_1#6974, co_comment#6958 AS co_comment_1#6975, co_orderdate#6959 AS co_orderdate_1#6976]
         :     :  +- Relation[rid#6943,cpfk_customer_orders#6944,cfpk_orders_customer#6945,cval_orders_o_orderstatus#6946,cval_orders_o_totalprice#6947,cval_orders_o_orderpriority#6948,cval_orders_o_clerk#6949,cval_orders_o_shippriority#6950,cval_orders_o_comment#6951,cval_orders_o_orderdate#6952,co_orderstatus#6953,co_totalprice#6954,co_orderpriority#6955,co_clerk#6956,co_shippriority#6957,co_comment#6958,co_orderdate#6959] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#6977 AS rid_2#7010, cpfk_orders_lineitem#6978 AS cpfk_orders_lineitem_2#7011, cpfk_supplier_lineitem#6979 AS cpfk_supplier_lineitem_2#7012, cfpk_lineitem_supplier#6980 AS cfpk_lineitem_supplier_2#7013, cfpk_lineitem_partsupp#6981 AS cfpk_lineitem_partsupp_2#7014, cpfk_part_lineitem#6982 AS cpfk_part_lineitem_2#7015, cfpk_lineitem_part#6983 AS cfpk_lineitem_part_2#7016, cpfk_partsupp_lineitem#6984 AS cpfk_partsupp_lineitem_2#7017, cfpk_lineitem_orders#6985 AS cfpk_lineitem_orders_2#7018, cval_lineitem_l_quantity#6986 AS cval_lineitem_l_quantity_2#7019, cval_lineitem_l_extendedprice#6987 AS cval_lineitem_l_extendedprice_2#7020, cval_lineitem_l_discount#6988 AS cval_lineitem_l_discount_2#7021, cval_lineitem_l_tax#6989 AS cval_lineitem_l_tax_2#7022, cval_lineitem_l_returnflag#6990 AS cval_lineitem_l_returnflag_2#7023, cval_lineitem_l_linestatus#6991 AS cval_lineitem_l_linestatus_2#7024, cval_lineitem_l_commitdate#6992 AS cval_lineitem_l_commitdate_2#7025, cval_lineitem_l_receiptdate#6993 AS cval_lineitem_l_receiptdate_2#7026, cval_lineitem_l_shipinstruct#6994 AS cval_lineitem_l_shipinstruct_2#7027, cval_lineitem_l_shipmode#6995 AS cval_lineitem_l_shipmode_2#7028, cval_lineitem_l_comment#6996 AS cval_lineitem_l_comment_2#7029, cval_lineitem_l_shipdate#6997 AS cval_lineitem_l_shipdate_2#7030, cl_quantity#6998 AS cl_quantity_2#7031, cl_extendedprice#6999 AS cl_extendedprice_2#7032, cl_discount#7000 AS cl_discount_2#7033, ... 9 more fields]
         :        +- Relation[rid#6977,cpfk_orders_lineitem#6978,cpfk_supplier_lineitem#6979,cfpk_lineitem_supplier#6980,cfpk_lineitem_partsupp#6981,cpfk_part_lineitem#6982,cfpk_lineitem_part#6983,cpfk_partsupp_lineitem#6984,cfpk_lineitem_orders#6985,cval_lineitem_l_quantity#6986,cval_lineitem_l_extendedprice#6987,cval_lineitem_l_discount#6988,cval_lineitem_l_tax#6989,cval_lineitem_l_returnflag#6990,cval_lineitem_l_linestatus#6991,cval_lineitem_l_commitdate#6992,cval_lineitem_l_receiptdate#6993,cval_lineitem_l_shipinstruct#6994,cval_lineitem_l_shipmode#6995,cval_lineitem_l_comment#6996,cval_lineitem_l_shipdate#6997,cl_quantity#6998,cl_extendedprice#6999,cl_discount#7000,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6877 AS rid_2#6910, cpfk_orders_lineitem#6878 AS cpfk_orders_lineitem_2#6911, cpfk_supplier_lineitem#6879 AS cpfk_supplier_lineitem_2#6912, cfpk_lineitem_supplier#6880 AS cfpk_lineitem_supplier_2#6913, cfpk_lineitem_partsupp#6881 AS cfpk_lineitem_partsupp_2#6914, cpfk_part_lineitem#6882 AS cpfk_part_lineitem_2#6915, cfpk_lineitem_part#6883 AS cfpk_lineitem_part_2#6916, cpfk_partsupp_lineitem#6884 AS cpfk_partsupp_lineitem_2#6917, cfpk_lineitem_orders#6885 AS cfpk_lineitem_orders_2#6918, cval_lineitem_l_quantity#6886 AS cval_lineitem_l_quantity_2#6919, cval_lineitem_l_extendedprice#6887 AS cval_lineitem_l_extendedprice_2#6920, cval_lineitem_l_discount#6888 AS cval_lineitem_l_discount_2#6921, cval_lineitem_l_tax#6889 AS cval_lineitem_l_tax_2#6922, cval_lineitem_l_returnflag#6890 AS cval_lineitem_l_returnflag_2#6923, cval_lineitem_l_linestatus#6891 AS cval_lineitem_l_linestatus_2#6924, cval_lineitem_l_commitdate#6892 AS cval_lineitem_l_commitdate_2#6925, cval_lineitem_l_receiptdate#6893 AS cval_lineitem_l_receiptdate_2#6926, cval_lineitem_l_shipinstruct#6894 AS cval_lineitem_l_shipinstruct_2#6927, cval_lineitem_l_shipmode#6895 AS cval_lineitem_l_shipmode_2#6928, cval_lineitem_l_comment#6896 AS cval_lineitem_l_comment_2#6929, cval_lineitem_l_shipdate#6897 AS cval_lineitem_l_shipdate_2#6930, cl_quantity#6898 AS cl_quantity_2#6931, cl_extendedprice#6899 AS cl_extendedprice_2#6932, cl_discount#6900 AS cl_discount_2#6933, ... 9 more fields]
            +- Relation[rid#6877,cpfk_orders_lineitem#6878,cpfk_supplier_lineitem#6879,cfpk_lineitem_supplier#6880,cfpk_lineitem_partsupp#6881,cpfk_part_lineitem#6882,cfpk_lineitem_part#6883,cpfk_partsupp_lineitem#6884,cfpk_lineitem_orders#6885,cval_lineitem_l_quantity#6886,cval_lineitem_l_extendedprice#6887,cval_lineitem_l_discount#6888,cval_lineitem_l_tax#6889,cval_lineitem_l_returnflag#6890,cval_lineitem_l_linestatus#6891,cval_lineitem_l_commitdate#6892,cval_lineitem_l_receiptdate#6893,cval_lineitem_l_shipinstruct#6894,cval_lineitem_l_shipmode#6895,cval_lineitem_l_comment#6896,cval_lineitem_l_shipdate#6897,cl_quantity#6898,cl_extendedprice#6899,cl_discount#6900,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 124190ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/15 15:11:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:11:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7112L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:11:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:11:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7112L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#7114 AS rid_0#7119, cval_region_r_name#7115 AS cval_region_r_name_0#7120, cval_region_r_comment#7116 AS cval_region_r_comment_0#7121, cr_name#7117 AS cr_name_0#7122, cr_comment#7118 AS cr_comment_0#7123]
         :  :  :  :  :  :  :  +- Relation[rid#7114,cval_region_r_name#7115,cval_region_r_comment#7116,cr_name#7117,cr_comment#7118] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#7124 AS rid_0#7129, cval_region_r_name#7125 AS cval_region_r_name_0#7130, cval_region_r_comment#7126 AS cval_region_r_comment_0#7131, cr_name#7127 AS cr_name_0#7132, cr_comment#7128 AS cr_comment_0#7133]
         :  :  :  :  :  :        +- Relation[rid#7124,cval_region_r_name#7125,cval_region_r_comment#7126,cr_name#7127,cr_comment#7128] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- Project [rid#7158 AS rid_1#7165, cpfk_region_nation#7159 AS cpfk_region_nation_1#7166, cfpk_nation_region#7160 AS cfpk_nation_region_1#7167, cval_nation_n_name#7161 AS cval_nation_n_name_1#7168, cval_nation_n_comment#7162 AS cval_nation_n_comment_1#7169, cn_name#7163 AS cn_name_1#7170, cn_comment#7164 AS cn_comment_1#7171]
         :  :  :  :  :     +- Relation[rid#7158,cpfk_region_nation#7159,cfpk_nation_region#7160,cval_nation_n_name#7161,cval_nation_n_comment#7162,cn_name#7163,cn_comment#7164] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#7134 AS rid_1#7141, cpfk_region_nation#7135 AS cpfk_region_nation_1#7142, cfpk_nation_region#7136 AS cfpk_nation_region_1#7143, cval_nation_n_name#7137 AS cval_nation_n_name_1#7144, cval_nation_n_comment#7138 AS cval_nation_n_comment_1#7145, cn_name#7139 AS cn_name_1#7146, cn_comment#7140 AS cn_comment_1#7147]
         :  :  :  :     +- Relation[rid#7134,cpfk_region_nation#7135,cfpk_nation_region#7136,cval_nation_n_name#7137,cval_nation_n_comment#7138,cn_name#7139,cn_comment#7140] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#7212 AS rid_2#7225, cpfk_nation_supplier#7213 AS cpfk_nation_supplier_2#7226, cfpk_supplier_nation#7214 AS cfpk_supplier_nation_2#7227, cval_supplier_s_name#7215 AS cval_supplier_s_name_2#7228, cval_supplier_s_address#7216 AS cval_supplier_s_address_2#7229, cval_supplier_s_phone#7217 AS cval_supplier_s_phone_2#7230, cval_supplier_s_acctbal#7218 AS cval_supplier_s_acctbal_2#7231, cval_supplier_s_comment#7219 AS cval_supplier_s_comment_2#7232, cs_name#7220 AS cs_name_2#7233, cs_address#7221 AS cs_address_2#7234, cs_phone#7222 AS cs_phone_2#7235, cs_acctbal#7223 AS cs_acctbal_2#7236, cs_comment#7224 AS cs_comment_2#7237]
         :  :  :     +- Relation[rid#7212,cpfk_nation_supplier#7213,cfpk_supplier_nation#7214,cval_supplier_s_name#7215,cval_supplier_s_address#7216,cval_supplier_s_phone#7217,cval_supplier_s_acctbal#7218,cval_supplier_s_comment#7219,cs_name#7220,cs_address#7221,cs_phone#7222,cs_acctbal#7223,cs_comment#7224] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#7172 AS rid_2#7185, cpfk_nation_supplier#7173 AS cpfk_nation_supplier_2#7186, cfpk_supplier_nation#7174 AS cfpk_supplier_nation_2#7187, cval_supplier_s_name#7175 AS cval_supplier_s_name_2#7188, cval_supplier_s_address#7176 AS cval_supplier_s_address_2#7189, cval_supplier_s_phone#7177 AS cval_supplier_s_phone_2#7190, cval_supplier_s_acctbal#7178 AS cval_supplier_s_acctbal_2#7191, cval_supplier_s_comment#7179 AS cval_supplier_s_comment_2#7192, cs_name#7180 AS cs_name_2#7193, cs_address#7181 AS cs_address_2#7194, cs_phone#7182 AS cs_phone_2#7195, cs_acctbal#7183 AS cs_acctbal_2#7196, cs_comment#7184 AS cs_comment_2#7197]
         :  :     +- Relation[rid#7172,cpfk_nation_supplier#7173,cfpk_supplier_nation#7174,cval_supplier_s_name#7175,cval_supplier_s_address#7176,cval_supplier_s_phone#7177,cval_supplier_s_acctbal#7178,cval_supplier_s_comment#7179,cs_name#7180,cs_address#7181,cs_phone#7182,cs_acctbal#7183,cs_comment#7184] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#7410 AS rid_4#7421, cpfk_part_partsupp#7411 AS cpfk_part_partsupp_4#7422, cfpk_partsupp_part#7412 AS cfpk_partsupp_part_4#7423, cpfk_supplier_partsupp#7413 AS cpfk_supplier_partsupp_4#7424, cfpk_partsupp_supplier#7414 AS cfpk_partsupp_supplier_4#7425, cval_partsupp_ps_availqty#7415 AS cval_partsupp_ps_availqty_4#7426, cval_partsupp_ps_supplycost#7416 AS cval_partsupp_ps_supplycost_4#7427, cval_partsupp_ps_comment#7417 AS cval_partsupp_ps_comment_4#7428, cps_availqty#7418 AS cps_availqty_4#7429, cps_supplycost#7419 AS cps_supplycost_4#7430, cps_comment#7420 AS cps_comment_4#7431]
         :     +- Relation[rid#7410,cpfk_part_partsupp#7411,cfpk_partsupp_part#7412,cpfk_supplier_partsupp#7413,cfpk_partsupp_supplier#7414,cval_partsupp_ps_availqty#7415,cval_partsupp_ps_supplycost#7416,cval_partsupp_ps_comment#7417,cps_availqty#7418,cps_supplycost#7419,cps_comment#7420] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#7238 AS rid_3#7255, cval_part_p_name#7239 AS cval_part_p_name_3#7256, cval_part_p_mfgr#7240 AS cval_part_p_mfgr_3#7257, cval_part_p_type#7241 AS cval_part_p_type_3#7258, cval_part_p_size#7242 AS cval_part_p_size_3#7259, cval_part_p_container#7243 AS cval_part_p_container_3#7260, cval_part_p_retailprice#7244 AS cval_part_p_retailprice_3#7261, cval_part_p_comment#7245 AS cval_part_p_comment_3#7262, cval_part_p_brand#7246 AS cval_part_p_brand_3#7263, cp_name#7247 AS cp_name_3#7264, cp_mfgr#7248 AS cp_mfgr_3#7265, cp_type#7249 AS cp_type_3#7266, cp_size#7250 AS cp_size_3#7267, cp_container#7251 AS cp_container_3#7268, cp_retailprice#7252 AS cp_retailprice_3#7269, cp_comment#7253 AS cp_comment_3#7270, cp_brand#7254 AS cp_brand_3#7271]
            :  :  :  +- Relation[rid#7238,cval_part_p_name#7239,cval_part_p_mfgr#7240,cval_part_p_type#7241,cval_part_p_size#7242,cval_part_p_container#7243,cval_part_p_retailprice#7244,cval_part_p_comment#7245,cval_part_p_brand#7246,cp_name#7247,cp_mfgr#7248,cp_type#7249,cp_size#7250,cp_container#7251,cp_retailprice#7252,cp_comment#7253,cp_brand#7254] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#7272 AS rid_3#7289, cval_part_p_name#7273 AS cval_part_p_name_3#7290, cval_part_p_mfgr#7274 AS cval_part_p_mfgr_3#7291, cval_part_p_type#7275 AS cval_part_p_type_3#7292, cval_part_p_size#7276 AS cval_part_p_size_3#7293, cval_part_p_container#7277 AS cval_part_p_container_3#7294, cval_part_p_retailprice#7278 AS cval_part_p_retailprice_3#7295, cval_part_p_comment#7279 AS cval_part_p_comment_3#7296, cval_part_p_brand#7280 AS cval_part_p_brand_3#7297, cp_name#7281 AS cp_name_3#7298, cp_mfgr#7282 AS cp_mfgr_3#7299, cp_type#7283 AS cp_type_3#7300, cp_size#7284 AS cp_size_3#7301, cp_container#7285 AS cp_container_3#7302, cp_retailprice#7286 AS cp_retailprice_3#7303, cp_comment#7287 AS cp_comment_3#7304, cp_brand#7288 AS cp_brand_3#7305]
            :  :        +- Relation[rid#7272,cval_part_p_name#7273,cval_part_p_mfgr#7274,cval_part_p_type#7275,cval_part_p_size#7276,cval_part_p_container#7277,cval_part_p_retailprice#7278,cval_part_p_comment#7279,cval_part_p_brand#7280,cp_name#7281,cp_mfgr#7282,cp_type#7283,cp_size#7284,cp_container#7285,cp_retailprice#7286,cp_comment#7287,cp_brand#7288] JDBCRelation(tpart) [numPartitions=1]
            :  +- Project [rid#7362 AS rid_4#7373, cpfk_part_partsupp#7363 AS cpfk_part_partsupp_4#7374, cfpk_partsupp_part#7364 AS cfpk_partsupp_part_4#7375, cpfk_supplier_partsupp#7365 AS cpfk_supplier_partsupp_4#7376, cfpk_partsupp_supplier#7366 AS cfpk_partsupp_supplier_4#7377, cval_partsupp_ps_availqty#7367 AS cval_partsupp_ps_availqty_4#7378, cval_partsupp_ps_supplycost#7368 AS cval_partsupp_ps_supplycost_4#7379, cval_partsupp_ps_comment#7369 AS cval_partsupp_ps_comment_4#7380, cps_availqty#7370 AS cps_availqty_4#7381, cps_supplycost#7371 AS cps_supplycost_4#7382, cps_comment#7372 AS cps_comment_4#7383]
            :     +- Relation[rid#7362,cpfk_part_partsupp#7363,cfpk_partsupp_part#7364,cpfk_supplier_partsupp#7365,cfpk_partsupp_supplier#7366,cval_partsupp_ps_availqty#7367,cval_partsupp_ps_supplycost#7368,cval_partsupp_ps_comment#7369,cps_availqty#7370,cps_supplycost#7371,cps_comment#7372] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#7306 AS rid_4#7317, cpfk_part_partsupp#7307 AS cpfk_part_partsupp_4#7318, cfpk_partsupp_part#7308 AS cfpk_partsupp_part_4#7319, cpfk_supplier_partsupp#7309 AS cpfk_supplier_partsupp_4#7320, cfpk_partsupp_supplier#7310 AS cfpk_partsupp_supplier_4#7321, cval_partsupp_ps_availqty#7311 AS cval_partsupp_ps_availqty_4#7322, cval_partsupp_ps_supplycost#7312 AS cval_partsupp_ps_supplycost_4#7323, cval_partsupp_ps_comment#7313 AS cval_partsupp_ps_comment_4#7324, cps_availqty#7314 AS cps_availqty_4#7325, cps_supplycost#7315 AS cps_supplycost_4#7326, cps_comment#7316 AS cps_comment_4#7327]
               +- Relation[rid#7306,cpfk_part_partsupp#7307,cfpk_partsupp_part#7308,cpfk_supplier_partsupp#7309,cfpk_partsupp_supplier#7310,cval_partsupp_ps_availqty#7311,cval_partsupp_ps_supplycost#7312,cval_partsupp_ps_comment#7313,cps_availqty#7314,cps_supplycost#7315,cps_comment#7316] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 1656ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/15 15:11:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:11:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7491L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:11:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7491L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#7493 AS rid_0#7510, cval_part_p_name#7494 AS cval_part_p_name_0#7511, cval_part_p_mfgr#7495 AS cval_part_p_mfgr_0#7512, cval_part_p_type#7496 AS cval_part_p_type_0#7513, cval_part_p_size#7497 AS cval_part_p_size_0#7514, cval_part_p_container#7498 AS cval_part_p_container_0#7515, cval_part_p_retailprice#7499 AS cval_part_p_retailprice_0#7516, cval_part_p_comment#7500 AS cval_part_p_comment_0#7517, cval_part_p_brand#7501 AS cval_part_p_brand_0#7518, cp_name#7502 AS cp_name_0#7519, cp_mfgr#7503 AS cp_mfgr_0#7520, cp_type#7504 AS cp_type_0#7521, cp_size#7505 AS cp_size_0#7522, cp_container#7506 AS cp_container_0#7523, cp_retailprice#7507 AS cp_retailprice_0#7524, cp_comment#7508 AS cp_comment_0#7525, cp_brand#7509 AS cp_brand_0#7526]
         :  :  +- Relation[rid#7493,cval_part_p_name#7494,cval_part_p_mfgr#7495,cval_part_p_type#7496,cval_part_p_size#7497,cval_part_p_container#7498,cval_part_p_retailprice#7499,cval_part_p_comment#7500,cval_part_p_brand#7501,cp_name#7502,cp_mfgr#7503,cp_type#7504,cp_size#7505,cp_container#7506,cp_retailprice#7507,cp_comment#7508,cp_brand#7509] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#7593 AS rid_0#7610, cval_part_p_name#7594 AS cval_part_p_name_0#7611, cval_part_p_mfgr#7595 AS cval_part_p_mfgr_0#7612, cval_part_p_type#7596 AS cval_part_p_type_0#7613, cval_part_p_size#7597 AS cval_part_p_size_0#7614, cval_part_p_container#7598 AS cval_part_p_container_0#7615, cval_part_p_retailprice#7599 AS cval_part_p_retailprice_0#7616, cval_part_p_comment#7600 AS cval_part_p_comment_0#7617, cval_part_p_brand#7601 AS cval_part_p_brand_0#7618, cp_name#7602 AS cp_name_0#7619, cp_mfgr#7603 AS cp_mfgr_0#7620, cp_type#7604 AS cp_type_0#7621, cp_size#7605 AS cp_size_0#7622, cp_container#7606 AS cp_container_0#7623, cp_retailprice#7607 AS cp_retailprice_0#7624, cp_comment#7608 AS cp_comment_0#7625, cp_brand#7609 AS cp_brand_0#7626]
         :     :  +- Relation[rid#7593,cval_part_p_name#7594,cval_part_p_mfgr#7595,cval_part_p_type#7596,cval_part_p_size#7597,cval_part_p_container#7598,cval_part_p_retailprice#7599,cval_part_p_comment#7600,cval_part_p_brand#7601,cp_name#7602,cp_mfgr#7603,cp_type#7604,cp_size#7605,cp_container#7606,cp_retailprice#7607,cp_comment#7608,cp_brand#7609] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#7627 AS rid_1#7660, cpfk_orders_lineitem#7628 AS cpfk_orders_lineitem_1#7661, cpfk_supplier_lineitem#7629 AS cpfk_supplier_lineitem_1#7662, cfpk_lineitem_supplier#7630 AS cfpk_lineitem_supplier_1#7663, cfpk_lineitem_partsupp#7631 AS cfpk_lineitem_partsupp_1#7664, cpfk_part_lineitem#7632 AS cpfk_part_lineitem_1#7665, cfpk_lineitem_part#7633 AS cfpk_lineitem_part_1#7666, cpfk_partsupp_lineitem#7634 AS cpfk_partsupp_lineitem_1#7667, cfpk_lineitem_orders#7635 AS cfpk_lineitem_orders_1#7668, cval_lineitem_l_quantity#7636 AS cval_lineitem_l_quantity_1#7669, cval_lineitem_l_extendedprice#7637 AS cval_lineitem_l_extendedprice_1#7670, cval_lineitem_l_discount#7638 AS cval_lineitem_l_discount_1#7671, cval_lineitem_l_tax#7639 AS cval_lineitem_l_tax_1#7672, cval_lineitem_l_returnflag#7640 AS cval_lineitem_l_returnflag_1#7673, cval_lineitem_l_linestatus#7641 AS cval_lineitem_l_linestatus_1#7674, cval_lineitem_l_commitdate#7642 AS cval_lineitem_l_commitdate_1#7675, cval_lineitem_l_receiptdate#7643 AS cval_lineitem_l_receiptdate_1#7676, cval_lineitem_l_shipinstruct#7644 AS cval_lineitem_l_shipinstruct_1#7677, cval_lineitem_l_shipmode#7645 AS cval_lineitem_l_shipmode_1#7678, cval_lineitem_l_comment#7646 AS cval_lineitem_l_comment_1#7679, cval_lineitem_l_shipdate#7647 AS cval_lineitem_l_shipdate_1#7680, cl_quantity#7648 AS cl_quantity_1#7681, cl_extendedprice#7649 AS cl_extendedprice_1#7682, cl_discount#7650 AS cl_discount_1#7683, ... 9 more fields]
         :        +- Relation[rid#7627,cpfk_orders_lineitem#7628,cpfk_supplier_lineitem#7629,cfpk_lineitem_supplier#7630,cfpk_lineitem_partsupp#7631,cpfk_part_lineitem#7632,cfpk_lineitem_part#7633,cpfk_partsupp_lineitem#7634,cfpk_lineitem_orders#7635,cval_lineitem_l_quantity#7636,cval_lineitem_l_extendedprice#7637,cval_lineitem_l_discount#7638,cval_lineitem_l_tax#7639,cval_lineitem_l_returnflag#7640,cval_lineitem_l_linestatus#7641,cval_lineitem_l_commitdate#7642,cval_lineitem_l_receiptdate#7643,cval_lineitem_l_shipinstruct#7644,cval_lineitem_l_shipmode#7645,cval_lineitem_l_comment#7646,cval_lineitem_l_shipdate#7647,cl_quantity#7648,cl_extendedprice#7649,cl_discount#7650,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7527 AS rid_1#7560, cpfk_orders_lineitem#7528 AS cpfk_orders_lineitem_1#7561, cpfk_supplier_lineitem#7529 AS cpfk_supplier_lineitem_1#7562, cfpk_lineitem_supplier#7530 AS cfpk_lineitem_supplier_1#7563, cfpk_lineitem_partsupp#7531 AS cfpk_lineitem_partsupp_1#7564, cpfk_part_lineitem#7532 AS cpfk_part_lineitem_1#7565, cfpk_lineitem_part#7533 AS cfpk_lineitem_part_1#7566, cpfk_partsupp_lineitem#7534 AS cpfk_partsupp_lineitem_1#7567, cfpk_lineitem_orders#7535 AS cfpk_lineitem_orders_1#7568, cval_lineitem_l_quantity#7536 AS cval_lineitem_l_quantity_1#7569, cval_lineitem_l_extendedprice#7537 AS cval_lineitem_l_extendedprice_1#7570, cval_lineitem_l_discount#7538 AS cval_lineitem_l_discount_1#7571, cval_lineitem_l_tax#7539 AS cval_lineitem_l_tax_1#7572, cval_lineitem_l_returnflag#7540 AS cval_lineitem_l_returnflag_1#7573, cval_lineitem_l_linestatus#7541 AS cval_lineitem_l_linestatus_1#7574, cval_lineitem_l_commitdate#7542 AS cval_lineitem_l_commitdate_1#7575, cval_lineitem_l_receiptdate#7543 AS cval_lineitem_l_receiptdate_1#7576, cval_lineitem_l_shipinstruct#7544 AS cval_lineitem_l_shipinstruct_1#7577, cval_lineitem_l_shipmode#7545 AS cval_lineitem_l_shipmode_1#7578, cval_lineitem_l_comment#7546 AS cval_lineitem_l_comment_1#7579, cval_lineitem_l_shipdate#7547 AS cval_lineitem_l_shipdate_1#7580, cl_quantity#7548 AS cl_quantity_1#7581, cl_extendedprice#7549 AS cl_extendedprice_1#7582, cl_discount#7550 AS cl_discount_1#7583, ... 9 more fields]
            +- Relation[rid#7527,cpfk_orders_lineitem#7528,cpfk_supplier_lineitem#7529,cfpk_lineitem_supplier#7530,cfpk_lineitem_partsupp#7531,cpfk_part_lineitem#7532,cfpk_lineitem_part#7533,cpfk_partsupp_lineitem#7534,cfpk_lineitem_orders#7535,cval_lineitem_l_quantity#7536,cval_lineitem_l_extendedprice#7537,cval_lineitem_l_discount#7538,cval_lineitem_l_tax#7539,cval_lineitem_l_returnflag#7540,cval_lineitem_l_linestatus#7541,cval_lineitem_l_commitdate#7542,cval_lineitem_l_receiptdate#7543,cval_lineitem_l_shipinstruct#7544,cval_lineitem_l_shipmode#7545,cval_lineitem_l_comment#7546,cval_lineitem_l_shipdate#7547,cl_quantity#7548,cl_extendedprice#7549,cl_discount#7550,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 88152ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/15 15:12:46 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:12:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7771L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:12:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7771L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#7773 AS rid_0#7806, cpfk_orders_lineitem#7774 AS cpfk_orders_lineitem_0#7807, cpfk_supplier_lineitem#7775 AS cpfk_supplier_lineitem_0#7808, cfpk_lineitem_supplier#7776 AS cfpk_lineitem_supplier_0#7809, cfpk_lineitem_partsupp#7777 AS cfpk_lineitem_partsupp_0#7810, cpfk_part_lineitem#7778 AS cpfk_part_lineitem_0#7811, cfpk_lineitem_part#7779 AS cfpk_lineitem_part_0#7812, cpfk_partsupp_lineitem#7780 AS cpfk_partsupp_lineitem_0#7813, cfpk_lineitem_orders#7781 AS cfpk_lineitem_orders_0#7814, cval_lineitem_l_quantity#7782 AS cval_lineitem_l_quantity_0#7815, cval_lineitem_l_extendedprice#7783 AS cval_lineitem_l_extendedprice_0#7816, cval_lineitem_l_discount#7784 AS cval_lineitem_l_discount_0#7817, cval_lineitem_l_tax#7785 AS cval_lineitem_l_tax_0#7818, cval_lineitem_l_returnflag#7786 AS cval_lineitem_l_returnflag_0#7819, cval_lineitem_l_linestatus#7787 AS cval_lineitem_l_linestatus_0#7820, cval_lineitem_l_commitdate#7788 AS cval_lineitem_l_commitdate_0#7821, cval_lineitem_l_receiptdate#7789 AS cval_lineitem_l_receiptdate_0#7822, cval_lineitem_l_shipinstruct#7790 AS cval_lineitem_l_shipinstruct_0#7823, cval_lineitem_l_shipmode#7791 AS cval_lineitem_l_shipmode_0#7824, cval_lineitem_l_comment#7792 AS cval_lineitem_l_comment_0#7825, cval_lineitem_l_shipdate#7793 AS cval_lineitem_l_shipdate_0#7826, cl_quantity#7794 AS cl_quantity_0#7827, cl_extendedprice#7795 AS cl_extendedprice_0#7828, cl_discount#7796 AS cl_discount_0#7829, ... 9 more fields]
            :  +- Relation[rid#7773,cpfk_orders_lineitem#7774,cpfk_supplier_lineitem#7775,cfpk_lineitem_supplier#7776,cfpk_lineitem_partsupp#7777,cpfk_part_lineitem#7778,cfpk_lineitem_part#7779,cpfk_partsupp_lineitem#7780,cfpk_lineitem_orders#7781,cval_lineitem_l_quantity#7782,cval_lineitem_l_extendedprice#7783,cval_lineitem_l_discount#7784,cval_lineitem_l_tax#7785,cval_lineitem_l_returnflag#7786,cval_lineitem_l_linestatus#7787,cval_lineitem_l_commitdate#7788,cval_lineitem_l_receiptdate#7789,cval_lineitem_l_shipinstruct#7790,cval_lineitem_l_shipmode#7791,cval_lineitem_l_comment#7792,cval_lineitem_l_shipdate#7793,cl_quantity#7794,cl_extendedprice#7795,cl_discount#7796,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#7839 AS rid_1#7856, cpfk_customer_orders#7840 AS cpfk_customer_orders_1#7857, cfpk_orders_customer#7841 AS cfpk_orders_customer_1#7858, cval_orders_o_orderstatus#7842 AS cval_orders_o_orderstatus_1#7859, cval_orders_o_totalprice#7843 AS cval_orders_o_totalprice_1#7860, cval_orders_o_orderpriority#7844 AS cval_orders_o_orderpriority_1#7861, cval_orders_o_clerk#7845 AS cval_orders_o_clerk_1#7862, cval_orders_o_shippriority#7846 AS cval_orders_o_shippriority_1#7863, cval_orders_o_comment#7847 AS cval_orders_o_comment_1#7864, cval_orders_o_orderdate#7848 AS cval_orders_o_orderdate_1#7865, co_orderstatus#7849 AS co_orderstatus_1#7866, co_totalprice#7850 AS co_totalprice_1#7867, co_orderpriority#7851 AS co_orderpriority_1#7868, co_clerk#7852 AS co_clerk_1#7869, co_shippriority#7853 AS co_shippriority_1#7870, co_comment#7854 AS co_comment_1#7871, co_orderdate#7855 AS co_orderdate_1#7872]
               +- Relation[rid#7839,cpfk_customer_orders#7840,cfpk_orders_customer#7841,cval_orders_o_orderstatus#7842,cval_orders_o_totalprice#7843,cval_orders_o_orderpriority#7844,cval_orders_o_clerk#7845,cval_orders_o_shippriority#7846,cval_orders_o_comment#7847,cval_orders_o_orderdate#7848,co_orderstatus#7849,co_totalprice#7850,co_orderpriority#7851,co_clerk#7852,co_shippriority#7853,co_comment#7854,co_orderdate#7855] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 55769ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/15 15:13:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:13:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7931L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:13:42 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 15:13:42 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 15:13:42 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 15:13:42 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 15:13:42 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 15:13:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7931L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#7933 AS rid_0#7948, cpfk_nation_customer#7934 AS cpfk_nation_customer_0#7949, cfpk_customer_nation#7935 AS cfpk_customer_nation_0#7950, cval_customer_c_name#7936 AS cval_customer_c_name_0#7951, cval_customer_c_address#7937 AS cval_customer_c_address_0#7952, cval_customer_c_phone#7938 AS cval_customer_c_phone_0#7953, cval_customer_c_acctbal#7939 AS cval_customer_c_acctbal_0#7954, cval_customer_c_comment#7940 AS cval_customer_c_comment_0#7955, cval_customer_c_mktsegment#7941 AS cval_customer_c_mktsegment_0#7956, cc_name#7942 AS cc_name_0#7957, cc_address#7943 AS cc_address_0#7958, cc_phone#7944 AS cc_phone_0#7959, cc_acctbal#7945 AS cc_acctbal_0#7960, cc_comment#7946 AS cc_comment_0#7961, cc_mktsegment#7947 AS cc_mktsegment_0#7962]
         :  :  :  :  :  +- Relation[rid#7933,cpfk_nation_customer#7934,cfpk_customer_nation#7935,cval_customer_c_name#7936,cval_customer_c_address#7937,cval_customer_c_phone#7938,cval_customer_c_acctbal#7939,cval_customer_c_comment#7940,cval_customer_c_mktsegment#7941,cc_name#7942,cc_address#7943,cc_phone#7944,cc_acctbal#7945,cc_comment#7946,cc_mktsegment#7947] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#7963 AS rid_0#7978, cpfk_nation_customer#7964 AS cpfk_nation_customer_0#7979, cfpk_customer_nation#7965 AS cfpk_customer_nation_0#7980, cval_customer_c_name#7966 AS cval_customer_c_name_0#7981, cval_customer_c_address#7967 AS cval_customer_c_address_0#7982, cval_customer_c_phone#7968 AS cval_customer_c_phone_0#7983, cval_customer_c_acctbal#7969 AS cval_customer_c_acctbal_0#7984, cval_customer_c_comment#7970 AS cval_customer_c_comment_0#7985, cval_customer_c_mktsegment#7971 AS cval_customer_c_mktsegment_0#7986, cc_name#7972 AS cc_name_0#7987, cc_address#7973 AS cc_address_0#7988, cc_phone#7974 AS cc_phone_0#7989, cc_acctbal#7975 AS cc_acctbal_0#7990, cc_comment#7976 AS cc_comment_0#7991, cc_mktsegment#7977 AS cc_mktsegment_0#7992]
         :  :  :  :        +- Relation[rid#7963,cpfk_nation_customer#7964,cfpk_customer_nation#7965,cval_customer_c_name#7966,cval_customer_c_address#7967,cval_customer_c_phone#7968,cval_customer_c_acctbal#7969,cval_customer_c_comment#7970,cval_customer_c_mktsegment#7971,cc_name#7972,cc_address#7973,cc_phone#7974,cc_acctbal#7975,cc_comment#7976,cc_mktsegment#7977] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- Project [rid#8057 AS rid_1#8074, cpfk_customer_orders#8058 AS cpfk_customer_orders_1#8075, cfpk_orders_customer#8059 AS cfpk_orders_customer_1#8076, cval_orders_o_orderstatus#8060 AS cval_orders_o_orderstatus_1#8077, cval_orders_o_totalprice#8061 AS cval_orders_o_totalprice_1#8078, cval_orders_o_orderpriority#8062 AS cval_orders_o_orderpriority_1#8079, cval_orders_o_clerk#8063 AS cval_orders_o_clerk_1#8080, cval_orders_o_shippriority#8064 AS cval_orders_o_shippriority_1#8081, cval_orders_o_comment#8065 AS cval_orders_o_comment_1#8082, cval_orders_o_orderdate#8066 AS cval_orders_o_orderdate_1#8083, co_orderstatus#8067 AS co_orderstatus_1#8084, co_totalprice#8068 AS co_totalprice_1#8085, co_orderpriority#8069 AS co_orderpriority_1#8086, co_clerk#8070 AS co_clerk_1#8087, co_shippriority#8071 AS co_shippriority_1#8088, co_comment#8072 AS co_comment_1#8089, co_orderdate#8073 AS co_orderdate_1#8090]
         :  :  :     +- Relation[rid#8057,cpfk_customer_orders#8058,cfpk_orders_customer#8059,cval_orders_o_orderstatus#8060,cval_orders_o_totalprice#8061,cval_orders_o_orderpriority#8062,cval_orders_o_clerk#8063,cval_orders_o_shippriority#8064,cval_orders_o_comment#8065,cval_orders_o_orderdate#8066,co_orderstatus#8067,co_totalprice#8068,co_orderpriority#8069,co_clerk#8070,co_shippriority#8071,co_comment#8072,co_orderdate#8073] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#7993 AS rid_1#8010, cpfk_customer_orders#7994 AS cpfk_customer_orders_1#8011, cfpk_orders_customer#7995 AS cfpk_orders_customer_1#8012, cval_orders_o_orderstatus#7996 AS cval_orders_o_orderstatus_1#8013, cval_orders_o_totalprice#7997 AS cval_orders_o_totalprice_1#8014, cval_orders_o_orderpriority#7998 AS cval_orders_o_orderpriority_1#8015, cval_orders_o_clerk#7999 AS cval_orders_o_clerk_1#8016, cval_orders_o_shippriority#8000 AS cval_orders_o_shippriority_1#8017, cval_orders_o_comment#8001 AS cval_orders_o_comment_1#8018, cval_orders_o_orderdate#8002 AS cval_orders_o_orderdate_1#8019, co_orderstatus#8003 AS co_orderstatus_1#8020, co_totalprice#8004 AS co_totalprice_1#8021, co_orderpriority#8005 AS co_orderpriority_1#8022, co_clerk#8006 AS co_clerk_1#8023, co_shippriority#8007 AS co_shippriority_1#8024, co_comment#8008 AS co_comment_1#8025, co_orderdate#8009 AS co_orderdate_1#8026]
         :  :     +- Relation[rid#7993,cpfk_customer_orders#7994,cfpk_orders_customer#7995,cval_orders_o_orderstatus#7996,cval_orders_o_totalprice#7997,cval_orders_o_orderpriority#7998,cval_orders_o_clerk#7999,cval_orders_o_shippriority#8000,cval_orders_o_comment#8001,cval_orders_o_orderdate#8002,co_orderstatus#8003,co_totalprice#8004,co_orderpriority#8005,co_clerk#8006,co_shippriority#8007,co_comment#8008,co_orderdate#8009] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#8191 AS rid_2#8224, cpfk_orders_lineitem#8192 AS cpfk_orders_lineitem_2#8225, cpfk_supplier_lineitem#8193 AS cpfk_supplier_lineitem_2#8226, cfpk_lineitem_supplier#8194 AS cfpk_lineitem_supplier_2#8227, cfpk_lineitem_partsupp#8195 AS cfpk_lineitem_partsupp_2#8228, cpfk_part_lineitem#8196 AS cpfk_part_lineitem_2#8229, cfpk_lineitem_part#8197 AS cfpk_lineitem_part_2#8230, cpfk_partsupp_lineitem#8198 AS cpfk_partsupp_lineitem_2#8231, cfpk_lineitem_orders#8199 AS cfpk_lineitem_orders_2#8232, cval_lineitem_l_quantity#8200 AS cval_lineitem_l_quantity_2#8233, cval_lineitem_l_extendedprice#8201 AS cval_lineitem_l_extendedprice_2#8234, cval_lineitem_l_discount#8202 AS cval_lineitem_l_discount_2#8235, cval_lineitem_l_tax#8203 AS cval_lineitem_l_tax_2#8236, cval_lineitem_l_returnflag#8204 AS cval_lineitem_l_returnflag_2#8237, cval_lineitem_l_linestatus#8205 AS cval_lineitem_l_linestatus_2#8238, cval_lineitem_l_commitdate#8206 AS cval_lineitem_l_commitdate_2#8239, cval_lineitem_l_receiptdate#8207 AS cval_lineitem_l_receiptdate_2#8240, cval_lineitem_l_shipinstruct#8208 AS cval_lineitem_l_shipinstruct_2#8241, cval_lineitem_l_shipmode#8209 AS cval_lineitem_l_shipmode_2#8242, cval_lineitem_l_comment#8210 AS cval_lineitem_l_comment_2#8243, cval_lineitem_l_shipdate#8211 AS cval_lineitem_l_shipdate_2#8244, cl_quantity#8212 AS cl_quantity_2#8245, cl_extendedprice#8213 AS cl_extendedprice_2#8246, cl_discount#8214 AS cl_discount_2#8247, ... 9 more fields]
         :     +- Relation[rid#8191,cpfk_orders_lineitem#8192,cpfk_supplier_lineitem#8193,cfpk_lineitem_supplier#8194,cfpk_lineitem_partsupp#8195,cpfk_part_lineitem#8196,cfpk_lineitem_part#8197,cpfk_partsupp_lineitem#8198,cfpk_lineitem_orders#8199,cval_lineitem_l_quantity#8200,cval_lineitem_l_extendedprice#8201,cval_lineitem_l_discount#8202,cval_lineitem_l_tax#8203,cval_lineitem_l_returnflag#8204,cval_lineitem_l_linestatus#8205,cval_lineitem_l_commitdate#8206,cval_lineitem_l_receiptdate#8207,cval_lineitem_l_shipinstruct#8208,cval_lineitem_l_shipmode#8209,cval_lineitem_l_comment#8210,cval_lineitem_l_shipdate#8211,cl_quantity#8212,cl_extendedprice#8213,cl_discount#8214,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8091 AS rid_2#8124, cpfk_orders_lineitem#8092 AS cpfk_orders_lineitem_2#8125, cpfk_supplier_lineitem#8093 AS cpfk_supplier_lineitem_2#8126, cfpk_lineitem_supplier#8094 AS cfpk_lineitem_supplier_2#8127, cfpk_lineitem_partsupp#8095 AS cfpk_lineitem_partsupp_2#8128, cpfk_part_lineitem#8096 AS cpfk_part_lineitem_2#8129, cfpk_lineitem_part#8097 AS cfpk_lineitem_part_2#8130, cpfk_partsupp_lineitem#8098 AS cpfk_partsupp_lineitem_2#8131, cfpk_lineitem_orders#8099 AS cfpk_lineitem_orders_2#8132, cval_lineitem_l_quantity#8100 AS cval_lineitem_l_quantity_2#8133, cval_lineitem_l_extendedprice#8101 AS cval_lineitem_l_extendedprice_2#8134, cval_lineitem_l_discount#8102 AS cval_lineitem_l_discount_2#8135, cval_lineitem_l_tax#8103 AS cval_lineitem_l_tax_2#8136, cval_lineitem_l_returnflag#8104 AS cval_lineitem_l_returnflag_2#8137, cval_lineitem_l_linestatus#8105 AS cval_lineitem_l_linestatus_2#8138, cval_lineitem_l_commitdate#8106 AS cval_lineitem_l_commitdate_2#8139, cval_lineitem_l_receiptdate#8107 AS cval_lineitem_l_receiptdate_2#8140, cval_lineitem_l_shipinstruct#8108 AS cval_lineitem_l_shipinstruct_2#8141, cval_lineitem_l_shipmode#8109 AS cval_lineitem_l_shipmode_2#8142, cval_lineitem_l_comment#8110 AS cval_lineitem_l_comment_2#8143, cval_lineitem_l_shipdate#8111 AS cval_lineitem_l_shipdate_2#8144, cl_quantity#8112 AS cl_quantity_2#8145, cl_extendedprice#8113 AS cl_extendedprice_2#8146, cl_discount#8114 AS cl_discount_2#8147, ... 9 more fields]
            +- Relation[rid#8091,cpfk_orders_lineitem#8092,cpfk_supplier_lineitem#8093,cfpk_lineitem_supplier#8094,cfpk_lineitem_partsupp#8095,cpfk_part_lineitem#8096,cfpk_lineitem_part#8097,cpfk_partsupp_lineitem#8098,cfpk_lineitem_orders#8099,cval_lineitem_l_quantity#8100,cval_lineitem_l_extendedprice#8101,cval_lineitem_l_discount#8102,cval_lineitem_l_tax#8103,cval_lineitem_l_returnflag#8104,cval_lineitem_l_linestatus#8105,cval_lineitem_l_commitdate#8106,cval_lineitem_l_receiptdate#8107,cval_lineitem_l_shipinstruct#8108,cval_lineitem_l_shipmode#8109,cval_lineitem_l_comment#8110,cval_lineitem_l_shipdate#8111,cl_quantity#8112,cl_extendedprice#8113,cl_discount#8114,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=75006
Elapsed time: 6155ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 15:13:48 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:13:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8331L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:13:48 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:13:48 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:13:48 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:13:48 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:13:48 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:13:48 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:13:48 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:13:48 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:13:48 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:13:48 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:13:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8331L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#8333 AS rid_0#8340, cpfk_region_nation#8334 AS cpfk_region_nation_0#8341, cfpk_nation_region#8335 AS cfpk_nation_region_0#8342, cval_nation_n_name#8336 AS cval_nation_n_name_0#8343, cval_nation_n_comment#8337 AS cval_nation_n_comment_0#8344, cn_name#8338 AS cn_name_0#8345, cn_comment#8339 AS cn_comment_0#8346]
            :     :     :  :  :  :  :  +- Relation[rid#8333,cpfk_region_nation#8334,cfpk_nation_region#8335,cval_nation_n_name#8336,cval_nation_n_comment#8337,cn_name#8338,cn_comment#8339] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#8373 AS rid_0#8380, cpfk_region_nation#8374 AS cpfk_region_nation_0#8381, cfpk_nation_region#8375 AS cfpk_nation_region_0#8382, cval_nation_n_name#8376 AS cval_nation_n_name_0#8383, cval_nation_n_comment#8377 AS cval_nation_n_comment_0#8384, cn_name#8378 AS cn_name_0#8385, cn_comment#8379 AS cn_comment_0#8386]
            :     :     :  :  :  :     :  +- Relation[rid#8373,cpfk_region_nation#8374,cfpk_nation_region#8375,cval_nation_n_name#8376,cval_nation_n_comment#8377,cn_name#8378,cn_comment#8379] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#8387 AS rid_1#8400, cpfk_nation_supplier#8388 AS cpfk_nation_supplier_1#8401, cfpk_supplier_nation#8389 AS cfpk_supplier_nation_1#8402, cval_supplier_s_name#8390 AS cval_supplier_s_name_1#8403, cval_supplier_s_address#8391 AS cval_supplier_s_address_1#8404, cval_supplier_s_phone#8392 AS cval_supplier_s_phone_1#8405, cval_supplier_s_acctbal#8393 AS cval_supplier_s_acctbal_1#8406, cval_supplier_s_comment#8394 AS cval_supplier_s_comment_1#8407, cs_name#8395 AS cs_name_1#8408, cs_address#8396 AS cs_address_1#8409, cs_phone#8397 AS cs_phone_1#8410, cs_acctbal#8398 AS cs_acctbal_1#8411, cs_comment#8399 AS cs_comment_1#8412]
            :     :     :  :  :  :        +- Relation[rid#8387,cpfk_nation_supplier#8388,cfpk_supplier_nation#8389,cval_supplier_s_name#8390,cval_supplier_s_address#8391,cval_supplier_s_phone#8392,cval_supplier_s_acctbal#8393,cval_supplier_s_comment#8394,cs_name#8395,cs_address#8396,cs_phone#8397,cs_acctbal#8398,cs_comment#8399] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#8347 AS rid_1#8360, cpfk_nation_supplier#8348 AS cpfk_nation_supplier_1#8361, cfpk_supplier_nation#8349 AS cfpk_supplier_nation_1#8362, cval_supplier_s_name#8350 AS cval_supplier_s_name_1#8363, cval_supplier_s_address#8351 AS cval_supplier_s_address_1#8364, cval_supplier_s_phone#8352 AS cval_supplier_s_phone_1#8365, cval_supplier_s_acctbal#8353 AS cval_supplier_s_acctbal_1#8366, cval_supplier_s_comment#8354 AS cval_supplier_s_comment_1#8367, cs_name#8355 AS cs_name_1#8368, cs_address#8356 AS cs_address_1#8369, cs_phone#8357 AS cs_phone_1#8370, cs_acctbal#8358 AS cs_acctbal_1#8371, cs_comment#8359 AS cs_comment_1#8372]
            :     :     :  :  :     +- Relation[rid#8347,cpfk_nation_supplier#8348,cfpk_supplier_nation#8349,cval_supplier_s_name#8350,cval_supplier_s_address#8351,cval_supplier_s_phone#8352,cval_supplier_s_acctbal#8353,cval_supplier_s_comment#8354,cs_name#8355,cs_address#8356,cs_phone#8357,cs_acctbal#8358,cs_comment#8359] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#8479 AS rid_1#8492, cpfk_nation_supplier#8480 AS cpfk_nation_supplier_1#8493, cfpk_supplier_nation#8481 AS cfpk_supplier_nation_1#8494, cval_supplier_s_name#8482 AS cval_supplier_s_name_1#8495, cval_supplier_s_address#8483 AS cval_supplier_s_address_1#8496, cval_supplier_s_phone#8484 AS cval_supplier_s_phone_1#8497, cval_supplier_s_acctbal#8485 AS cval_supplier_s_acctbal_1#8498, cval_supplier_s_comment#8486 AS cval_supplier_s_comment_1#8499, cs_name#8487 AS cs_name_1#8500, cs_address#8488 AS cs_address_1#8501, cs_phone#8489 AS cs_phone_1#8502, cs_acctbal#8490 AS cs_acctbal_1#8503, cs_comment#8491 AS cs_comment_1#8504]
            :     :     :  :     :  +- Relation[rid#8479,cpfk_nation_supplier#8480,cfpk_supplier_nation#8481,cval_supplier_s_name#8482,cval_supplier_s_address#8483,cval_supplier_s_phone#8484,cval_supplier_s_acctbal#8485,cval_supplier_s_comment#8486,cs_name#8487,cs_address#8488,cs_phone#8489,cs_acctbal#8490,cs_comment#8491] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#8505 AS rid_2#8538, cpfk_orders_lineitem#8506 AS cpfk_orders_lineitem_2#8539, cpfk_supplier_lineitem#8507 AS cpfk_supplier_lineitem_2#8540, cfpk_lineitem_supplier#8508 AS cfpk_lineitem_supplier_2#8541, cfpk_lineitem_partsupp#8509 AS cfpk_lineitem_partsupp_2#8542, cpfk_part_lineitem#8510 AS cpfk_part_lineitem_2#8543, cfpk_lineitem_part#8511 AS cfpk_lineitem_part_2#8544, cpfk_partsupp_lineitem#8512 AS cpfk_partsupp_lineitem_2#8545, cfpk_lineitem_orders#8513 AS cfpk_lineitem_orders_2#8546, cval_lineitem_l_quantity#8514 AS cval_lineitem_l_quantity_2#8547, cval_lineitem_l_extendedprice#8515 AS cval_lineitem_l_extendedprice_2#8548, cval_lineitem_l_discount#8516 AS cval_lineitem_l_discount_2#8549, cval_lineitem_l_tax#8517 AS cval_lineitem_l_tax_2#8550, cval_lineitem_l_returnflag#8518 AS cval_lineitem_l_returnflag_2#8551, cval_lineitem_l_linestatus#8519 AS cval_lineitem_l_linestatus_2#8552, cval_lineitem_l_commitdate#8520 AS cval_lineitem_l_commitdate_2#8553, cval_lineitem_l_receiptdate#8521 AS cval_lineitem_l_receiptdate_2#8554, cval_lineitem_l_shipinstruct#8522 AS cval_lineitem_l_shipinstruct_2#8555, cval_lineitem_l_shipmode#8523 AS cval_lineitem_l_shipmode_2#8556, cval_lineitem_l_comment#8524 AS cval_lineitem_l_comment_2#8557, cval_lineitem_l_shipdate#8525 AS cval_lineitem_l_shipdate_2#8558, cl_quantity#8526 AS cl_quantity_2#8559, cl_extendedprice#8527 AS cl_extendedprice_2#8560, cl_discount#8528 AS cl_discount_2#8561, ... 9 more fields]
            :     :     :  :        +- Relation[rid#8505,cpfk_orders_lineitem#8506,cpfk_supplier_lineitem#8507,cfpk_lineitem_supplier#8508,cfpk_lineitem_partsupp#8509,cpfk_part_lineitem#8510,cfpk_lineitem_part#8511,cpfk_partsupp_lineitem#8512,cfpk_lineitem_orders#8513,cval_lineitem_l_quantity#8514,cval_lineitem_l_extendedprice#8515,cval_lineitem_l_discount#8516,cval_lineitem_l_tax#8517,cval_lineitem_l_returnflag#8518,cval_lineitem_l_linestatus#8519,cval_lineitem_l_commitdate#8520,cval_lineitem_l_receiptdate#8521,cval_lineitem_l_shipinstruct#8522,cval_lineitem_l_shipmode#8523,cval_lineitem_l_comment#8524,cval_lineitem_l_shipdate#8525,cl_quantity#8526,cl_extendedprice#8527,cl_discount#8528,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#8413 AS rid_2#8446, cpfk_orders_lineitem#8414 AS cpfk_orders_lineitem_2#8447, cpfk_supplier_lineitem#8415 AS cpfk_supplier_lineitem_2#8448, cfpk_lineitem_supplier#8416 AS cfpk_lineitem_supplier_2#8449, cfpk_lineitem_partsupp#8417 AS cfpk_lineitem_partsupp_2#8450, cpfk_part_lineitem#8418 AS cpfk_part_lineitem_2#8451, cfpk_lineitem_part#8419 AS cfpk_lineitem_part_2#8452, cpfk_partsupp_lineitem#8420 AS cpfk_partsupp_lineitem_2#8453, cfpk_lineitem_orders#8421 AS cfpk_lineitem_orders_2#8454, cval_lineitem_l_quantity#8422 AS cval_lineitem_l_quantity_2#8455, cval_lineitem_l_extendedprice#8423 AS cval_lineitem_l_extendedprice_2#8456, cval_lineitem_l_discount#8424 AS cval_lineitem_l_discount_2#8457, cval_lineitem_l_tax#8425 AS cval_lineitem_l_tax_2#8458, cval_lineitem_l_returnflag#8426 AS cval_lineitem_l_returnflag_2#8459, cval_lineitem_l_linestatus#8427 AS cval_lineitem_l_linestatus_2#8460, cval_lineitem_l_commitdate#8428 AS cval_lineitem_l_commitdate_2#8461, cval_lineitem_l_receiptdate#8429 AS cval_lineitem_l_receiptdate_2#8462, cval_lineitem_l_shipinstruct#8430 AS cval_lineitem_l_shipinstruct_2#8463, cval_lineitem_l_shipmode#8431 AS cval_lineitem_l_shipmode_2#8464, cval_lineitem_l_comment#8432 AS cval_lineitem_l_comment_2#8465, cval_lineitem_l_shipdate#8433 AS cval_lineitem_l_shipdate_2#8466, cl_quantity#8434 AS cl_quantity_2#8467, cl_extendedprice#8435 AS cl_extendedprice_2#8468, cl_discount#8436 AS cl_discount_2#8469, ... 9 more fields]
            :     :     :     +- Relation[rid#8413,cpfk_orders_lineitem#8414,cpfk_supplier_lineitem#8415,cfpk_lineitem_supplier#8416,cfpk_lineitem_partsupp#8417,cpfk_part_lineitem#8418,cfpk_lineitem_part#8419,cpfk_partsupp_lineitem#8420,cfpk_lineitem_orders#8421,cval_lineitem_l_quantity#8422,cval_lineitem_l_extendedprice#8423,cval_lineitem_l_discount#8424,cval_lineitem_l_tax#8425,cval_lineitem_l_returnflag#8426,cval_lineitem_l_linestatus#8427,cval_lineitem_l_commitdate#8428,cval_lineitem_l_receiptdate#8429,cval_lineitem_l_shipinstruct#8430,cval_lineitem_l_shipmode#8431,cval_lineitem_l_comment#8432,cval_lineitem_l_shipdate#8433,cl_quantity#8434,cl_extendedprice#8435,cl_discount#8436,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#8571 AS rid_3#8588, cval_part_p_name#8572 AS cval_part_p_name_3#8589, cval_part_p_mfgr#8573 AS cval_part_p_mfgr_3#8590, cval_part_p_type#8574 AS cval_part_p_type_3#8591, cval_part_p_size#8575 AS cval_part_p_size_3#8592, cval_part_p_container#8576 AS cval_part_p_container_3#8593, cval_part_p_retailprice#8577 AS cval_part_p_retailprice_3#8594, cval_part_p_comment#8578 AS cval_part_p_comment_3#8595, cval_part_p_brand#8579 AS cval_part_p_brand_3#8596, cp_name#8580 AS cp_name_3#8597, cp_mfgr#8581 AS cp_mfgr_3#8598, cp_type#8582 AS cp_type_3#8599, cp_size#8583 AS cp_size_3#8600, cp_container#8584 AS cp_container_3#8601, cp_retailprice#8585 AS cp_retailprice_3#8602, cp_comment#8586 AS cp_comment_3#8603, cp_brand#8587 AS cp_brand_3#8604]
            :     :        +- Relation[rid#8571,cval_part_p_name#8572,cval_part_p_mfgr#8573,cval_part_p_type#8574,cval_part_p_size#8575,cval_part_p_container#8576,cval_part_p_retailprice#8577,cval_part_p_comment#8578,cval_part_p_brand#8579,cp_name#8580,cp_mfgr#8581,cp_type#8582,cp_size#8583,cp_container#8584,cp_retailprice#8585,cp_comment#8586,cp_brand#8587] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#8605 AS rid_4#8616, cpfk_part_partsupp#8606 AS cpfk_part_partsupp_4#8617, cfpk_partsupp_part#8607 AS cfpk_partsupp_part_4#8618, cpfk_supplier_partsupp#8608 AS cpfk_supplier_partsupp_4#8619, cfpk_partsupp_supplier#8609 AS cfpk_partsupp_supplier_4#8620, cval_partsupp_ps_availqty#8610 AS cval_partsupp_ps_availqty_4#8621, cval_partsupp_ps_supplycost#8611 AS cval_partsupp_ps_supplycost_4#8622, cval_partsupp_ps_comment#8612 AS cval_partsupp_ps_comment_4#8623, cps_availqty#8613 AS cps_availqty_4#8624, cps_supplycost#8614 AS cps_supplycost_4#8625, cps_comment#8615 AS cps_comment_4#8626]
            :        +- Relation[rid#8605,cpfk_part_partsupp#8606,cfpk_partsupp_part#8607,cpfk_supplier_partsupp#8608,cfpk_partsupp_supplier#8609,cval_partsupp_ps_availqty#8610,cval_partsupp_ps_supplycost#8611,cval_partsupp_ps_comment#8612,cps_availqty#8613,cps_supplycost#8614,cps_comment#8615] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#8627 AS rid_5#8644, cpfk_customer_orders#8628 AS cpfk_customer_orders_5#8645, cfpk_orders_customer#8629 AS cfpk_orders_customer_5#8646, cval_orders_o_orderstatus#8630 AS cval_orders_o_orderstatus_5#8647, cval_orders_o_totalprice#8631 AS cval_orders_o_totalprice_5#8648, cval_orders_o_orderpriority#8632 AS cval_orders_o_orderpriority_5#8649, cval_orders_o_clerk#8633 AS cval_orders_o_clerk_5#8650, cval_orders_o_shippriority#8634 AS cval_orders_o_shippriority_5#8651, cval_orders_o_comment#8635 AS cval_orders_o_comment_5#8652, cval_orders_o_orderdate#8636 AS cval_orders_o_orderdate_5#8653, co_orderstatus#8637 AS co_orderstatus_5#8654, co_totalprice#8638 AS co_totalprice_5#8655, co_orderpriority#8639 AS co_orderpriority_5#8656, co_clerk#8640 AS co_clerk_5#8657, co_shippriority#8641 AS co_shippriority_5#8658, co_comment#8642 AS co_comment_5#8659, co_orderdate#8643 AS co_orderdate_5#8660]
               +- Relation[rid#8627,cpfk_customer_orders#8628,cfpk_orders_customer#8629,cval_orders_o_orderstatus#8630,cval_orders_o_totalprice#8631,cval_orders_o_orderpriority#8632,cval_orders_o_clerk#8633,cval_orders_o_shippriority#8634,cval_orders_o_comment#8635,cval_orders_o_orderdate#8636,co_orderstatus#8637,co_totalprice#8638,co_orderpriority#8639,co_clerk#8640,co_shippriority#8641,co_comment#8642,co_orderdate#8643] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 258804ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/15 15:18:07 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:18:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8767L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:18:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:18:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:18:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:18:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:18:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:18:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:18:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:18:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:18:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:18:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:18:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:18:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:18:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:18:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:18:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:18:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8767L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#8769 AS rid_0#8776, cpfk_region_nation#8770 AS cpfk_region_nation_0#8777, cfpk_nation_region#8771 AS cfpk_nation_region_0#8778, cval_nation_n_name#8772 AS cval_nation_n_name_0#8779, cval_nation_n_comment#8773 AS cval_nation_n_comment_0#8780, cn_name#8774 AS cn_name_0#8781, cn_comment#8775 AS cn_comment_0#8782]
            :  :  :  :  :  :  +- Relation[rid#8769,cpfk_region_nation#8770,cfpk_nation_region#8771,cval_nation_n_name#8772,cval_nation_n_comment#8773,cn_name#8774,cn_comment#8775] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#8783 AS rid_0#8790, cpfk_region_nation#8784 AS cpfk_region_nation_0#8791, cfpk_nation_region#8785 AS cfpk_nation_region_0#8792, cval_nation_n_name#8786 AS cval_nation_n_name_0#8793, cval_nation_n_comment#8787 AS cval_nation_n_comment_0#8794, cn_name#8788 AS cn_name_0#8795, cn_comment#8789 AS cn_comment_0#8796]
            :  :  :  :  :        +- Relation[rid#8783,cpfk_region_nation#8784,cfpk_nation_region#8785,cval_nation_n_name#8786,cval_nation_n_comment#8787,cn_name#8788,cn_comment#8789] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- Project [rid#8837 AS rid_1#8850, cpfk_nation_supplier#8838 AS cpfk_nation_supplier_1#8851, cfpk_supplier_nation#8839 AS cfpk_supplier_nation_1#8852, cval_supplier_s_name#8840 AS cval_supplier_s_name_1#8853, cval_supplier_s_address#8841 AS cval_supplier_s_address_1#8854, cval_supplier_s_phone#8842 AS cval_supplier_s_phone_1#8855, cval_supplier_s_acctbal#8843 AS cval_supplier_s_acctbal_1#8856, cval_supplier_s_comment#8844 AS cval_supplier_s_comment_1#8857, cs_name#8845 AS cs_name_1#8858, cs_address#8846 AS cs_address_1#8859, cs_phone#8847 AS cs_phone_1#8860, cs_acctbal#8848 AS cs_acctbal_1#8861, cs_comment#8849 AS cs_comment_1#8862]
            :  :  :  :     +- Relation[rid#8837,cpfk_nation_supplier#8838,cfpk_supplier_nation#8839,cval_supplier_s_name#8840,cval_supplier_s_address#8841,cval_supplier_s_phone#8842,cval_supplier_s_acctbal#8843,cval_supplier_s_comment#8844,cs_name#8845,cs_address#8846,cs_phone#8847,cs_acctbal#8848,cs_comment#8849] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#8797 AS rid_1#8810, cpfk_nation_supplier#8798 AS cpfk_nation_supplier_1#8811, cfpk_supplier_nation#8799 AS cfpk_supplier_nation_1#8812, cval_supplier_s_name#8800 AS cval_supplier_s_name_1#8813, cval_supplier_s_address#8801 AS cval_supplier_s_address_1#8814, cval_supplier_s_phone#8802 AS cval_supplier_s_phone_1#8815, cval_supplier_s_acctbal#8803 AS cval_supplier_s_acctbal_1#8816, cval_supplier_s_comment#8804 AS cval_supplier_s_comment_1#8817, cs_name#8805 AS cs_name_1#8818, cs_address#8806 AS cs_address_1#8819, cs_phone#8807 AS cs_phone_1#8820, cs_acctbal#8808 AS cs_acctbal_1#8821, cs_comment#8809 AS cs_comment_1#8822]
            :  :  :     +- Relation[rid#8797,cpfk_nation_supplier#8798,cfpk_supplier_nation#8799,cval_supplier_s_name#8800,cval_supplier_s_address#8801,cval_supplier_s_phone#8802,cval_supplier_s_acctbal#8803,cval_supplier_s_comment#8804,cs_name#8805,cs_address#8806,cs_phone#8807,cs_acctbal#8808,cs_comment#8809] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- Project [rid#8955 AS rid_2#8988, cpfk_orders_lineitem#8956 AS cpfk_orders_lineitem_2#8989, cpfk_supplier_lineitem#8957 AS cpfk_supplier_lineitem_2#8990, cfpk_lineitem_supplier#8958 AS cfpk_lineitem_supplier_2#8991, cfpk_lineitem_partsupp#8959 AS cfpk_lineitem_partsupp_2#8992, cpfk_part_lineitem#8960 AS cpfk_part_lineitem_2#8993, cfpk_lineitem_part#8961 AS cfpk_lineitem_part_2#8994, cpfk_partsupp_lineitem#8962 AS cpfk_partsupp_lineitem_2#8995, cfpk_lineitem_orders#8963 AS cfpk_lineitem_orders_2#8996, cval_lineitem_l_quantity#8964 AS cval_lineitem_l_quantity_2#8997, cval_lineitem_l_extendedprice#8965 AS cval_lineitem_l_extendedprice_2#8998, cval_lineitem_l_discount#8966 AS cval_lineitem_l_discount_2#8999, cval_lineitem_l_tax#8967 AS cval_lineitem_l_tax_2#9000, cval_lineitem_l_returnflag#8968 AS cval_lineitem_l_returnflag_2#9001, cval_lineitem_l_linestatus#8969 AS cval_lineitem_l_linestatus_2#9002, cval_lineitem_l_commitdate#8970 AS cval_lineitem_l_commitdate_2#9003, cval_lineitem_l_receiptdate#8971 AS cval_lineitem_l_receiptdate_2#9004, cval_lineitem_l_shipinstruct#8972 AS cval_lineitem_l_shipinstruct_2#9005, cval_lineitem_l_shipmode#8973 AS cval_lineitem_l_shipmode_2#9006, cval_lineitem_l_comment#8974 AS cval_lineitem_l_comment_2#9007, cval_lineitem_l_shipdate#8975 AS cval_lineitem_l_shipdate_2#9008, cl_quantity#8976 AS cl_quantity_2#9009, cl_extendedprice#8977 AS cl_extendedprice_2#9010, cl_discount#8978 AS cl_discount_2#9011, ... 9 more fields]
            :  :     +- Relation[rid#8955,cpfk_orders_lineitem#8956,cpfk_supplier_lineitem#8957,cfpk_lineitem_supplier#8958,cfpk_lineitem_partsupp#8959,cpfk_part_lineitem#8960,cfpk_lineitem_part#8961,cpfk_partsupp_lineitem#8962,cfpk_lineitem_orders#8963,cval_lineitem_l_quantity#8964,cval_lineitem_l_extendedprice#8965,cval_lineitem_l_discount#8966,cval_lineitem_l_tax#8967,cval_lineitem_l_returnflag#8968,cval_lineitem_l_linestatus#8969,cval_lineitem_l_commitdate#8970,cval_lineitem_l_receiptdate#8971,cval_lineitem_l_shipinstruct#8972,cval_lineitem_l_shipmode#8973,cval_lineitem_l_comment#8974,cval_lineitem_l_shipdate#8975,cl_quantity#8976,cl_extendedprice#8977,cl_discount#8978,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#8863 AS rid_2#8896, cpfk_orders_lineitem#8864 AS cpfk_orders_lineitem_2#8897, cpfk_supplier_lineitem#8865 AS cpfk_supplier_lineitem_2#8898, cfpk_lineitem_supplier#8866 AS cfpk_lineitem_supplier_2#8899, cfpk_lineitem_partsupp#8867 AS cfpk_lineitem_partsupp_2#8900, cpfk_part_lineitem#8868 AS cpfk_part_lineitem_2#8901, cfpk_lineitem_part#8869 AS cfpk_lineitem_part_2#8902, cpfk_partsupp_lineitem#8870 AS cpfk_partsupp_lineitem_2#8903, cfpk_lineitem_orders#8871 AS cfpk_lineitem_orders_2#8904, cval_lineitem_l_quantity#8872 AS cval_lineitem_l_quantity_2#8905, cval_lineitem_l_extendedprice#8873 AS cval_lineitem_l_extendedprice_2#8906, cval_lineitem_l_discount#8874 AS cval_lineitem_l_discount_2#8907, cval_lineitem_l_tax#8875 AS cval_lineitem_l_tax_2#8908, cval_lineitem_l_returnflag#8876 AS cval_lineitem_l_returnflag_2#8909, cval_lineitem_l_linestatus#8877 AS cval_lineitem_l_linestatus_2#8910, cval_lineitem_l_commitdate#8878 AS cval_lineitem_l_commitdate_2#8911, cval_lineitem_l_receiptdate#8879 AS cval_lineitem_l_receiptdate_2#8912, cval_lineitem_l_shipinstruct#8880 AS cval_lineitem_l_shipinstruct_2#8913, cval_lineitem_l_shipmode#8881 AS cval_lineitem_l_shipmode_2#8914, cval_lineitem_l_comment#8882 AS cval_lineitem_l_comment_2#8915, cval_lineitem_l_shipdate#8883 AS cval_lineitem_l_shipdate_2#8916, cl_quantity#8884 AS cl_quantity_2#8917, cl_extendedprice#8885 AS cl_extendedprice_2#8918, cl_discount#8886 AS cl_discount_2#8919, ... 9 more fields]
            :     +- Relation[rid#8863,cpfk_orders_lineitem#8864,cpfk_supplier_lineitem#8865,cfpk_lineitem_supplier#8866,cfpk_lineitem_partsupp#8867,cpfk_part_lineitem#8868,cfpk_lineitem_part#8869,cpfk_partsupp_lineitem#8870,cfpk_lineitem_orders#8871,cval_lineitem_l_quantity#8872,cval_lineitem_l_extendedprice#8873,cval_lineitem_l_discount#8874,cval_lineitem_l_tax#8875,cval_lineitem_l_returnflag#8876,cval_lineitem_l_linestatus#8877,cval_lineitem_l_commitdate#8878,cval_lineitem_l_receiptdate#8879,cval_lineitem_l_shipinstruct#8880,cval_lineitem_l_shipmode#8881,cval_lineitem_l_comment#8882,cval_lineitem_l_shipdate#8883,cl_quantity#8884,cl_extendedprice#8885,cl_discount#8886,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#9021 AS rid_3#9028, cpfk_region_nation#9022 AS cpfk_region_nation_3#9029, cfpk_nation_region#9023 AS cfpk_nation_region_3#9030, cval_nation_n_name#9024 AS cval_nation_n_name_3#9031, cval_nation_n_comment#9025 AS cval_nation_n_comment_3#9032, cn_name#9026 AS cn_name_3#9033, cn_comment#9027 AS cn_comment_3#9034]
               :  :  :  :  :  +- Relation[rid#9021,cpfk_region_nation#9022,cfpk_nation_region#9023,cval_nation_n_name#9024,cval_nation_n_comment#9025,cn_name#9026,cn_comment#9027] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#9035 AS rid_3#9042, cpfk_region_nation#9036 AS cpfk_region_nation_3#9043, cfpk_nation_region#9037 AS cfpk_nation_region_3#9044, cval_nation_n_name#9038 AS cval_nation_n_name_3#9045, cval_nation_n_comment#9039 AS cval_nation_n_comment_3#9046, cn_name#9040 AS cn_name_3#9047, cn_comment#9041 AS cn_comment_3#9048]
               :  :  :  :        +- Relation[rid#9035,cpfk_region_nation#9036,cfpk_nation_region#9037,cval_nation_n_name#9038,cval_nation_n_comment#9039,cn_name#9040,cn_comment#9041] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#9093 AS rid_4#9108, cpfk_nation_customer#9094 AS cpfk_nation_customer_4#9109, cfpk_customer_nation#9095 AS cfpk_customer_nation_4#9110, cval_customer_c_name#9096 AS cval_customer_c_name_4#9111, cval_customer_c_address#9097 AS cval_customer_c_address_4#9112, cval_customer_c_phone#9098 AS cval_customer_c_phone_4#9113, cval_customer_c_acctbal#9099 AS cval_customer_c_acctbal_4#9114, cval_customer_c_comment#9100 AS cval_customer_c_comment_4#9115, cval_customer_c_mktsegment#9101 AS cval_customer_c_mktsegment_4#9116, cc_name#9102 AS cc_name_4#9117, cc_address#9103 AS cc_address_4#9118, cc_phone#9104 AS cc_phone_4#9119, cc_acctbal#9105 AS cc_acctbal_4#9120, cc_comment#9106 AS cc_comment_4#9121, cc_mktsegment#9107 AS cc_mktsegment_4#9122]
               :  :  :     +- Relation[rid#9093,cpfk_nation_customer#9094,cfpk_customer_nation#9095,cval_customer_c_name#9096,cval_customer_c_address#9097,cval_customer_c_phone#9098,cval_customer_c_acctbal#9099,cval_customer_c_comment#9100,cval_customer_c_mktsegment#9101,cc_name#9102,cc_address#9103,cc_phone#9104,cc_acctbal#9105,cc_comment#9106,cc_mktsegment#9107] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#9049 AS rid_4#9064, cpfk_nation_customer#9050 AS cpfk_nation_customer_4#9065, cfpk_customer_nation#9051 AS cfpk_customer_nation_4#9066, cval_customer_c_name#9052 AS cval_customer_c_name_4#9067, cval_customer_c_address#9053 AS cval_customer_c_address_4#9068, cval_customer_c_phone#9054 AS cval_customer_c_phone_4#9069, cval_customer_c_acctbal#9055 AS cval_customer_c_acctbal_4#9070, cval_customer_c_comment#9056 AS cval_customer_c_comment_4#9071, cval_customer_c_mktsegment#9057 AS cval_customer_c_mktsegment_4#9072, cc_name#9058 AS cc_name_4#9073, cc_address#9059 AS cc_address_4#9074, cc_phone#9060 AS cc_phone_4#9075, cc_acctbal#9061 AS cc_acctbal_4#9076, cc_comment#9062 AS cc_comment_4#9077, cc_mktsegment#9063 AS cc_mktsegment_4#9078]
               :  :     +- Relation[rid#9049,cpfk_nation_customer#9050,cfpk_customer_nation#9051,cval_customer_c_name#9052,cval_customer_c_address#9053,cval_customer_c_phone#9054,cval_customer_c_acctbal#9055,cval_customer_c_comment#9056,cval_customer_c_mktsegment#9057,cc_name#9058,cc_address#9059,cc_phone#9060,cc_acctbal#9061,cc_comment#9062,cc_mktsegment#9063] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#9187 AS rid_5#9204, cpfk_customer_orders#9188 AS cpfk_customer_orders_5#9205, cfpk_orders_customer#9189 AS cfpk_orders_customer_5#9206, cval_orders_o_orderstatus#9190 AS cval_orders_o_orderstatus_5#9207, cval_orders_o_totalprice#9191 AS cval_orders_o_totalprice_5#9208, cval_orders_o_orderpriority#9192 AS cval_orders_o_orderpriority_5#9209, cval_orders_o_clerk#9193 AS cval_orders_o_clerk_5#9210, cval_orders_o_shippriority#9194 AS cval_orders_o_shippriority_5#9211, cval_orders_o_comment#9195 AS cval_orders_o_comment_5#9212, cval_orders_o_orderdate#9196 AS cval_orders_o_orderdate_5#9213, co_orderstatus#9197 AS co_orderstatus_5#9214, co_totalprice#9198 AS co_totalprice_5#9215, co_orderpriority#9199 AS co_orderpriority_5#9216, co_clerk#9200 AS co_clerk_5#9217, co_shippriority#9201 AS co_shippriority_5#9218, co_comment#9202 AS co_comment_5#9219, co_orderdate#9203 AS co_orderdate_5#9220]
               :     +- Relation[rid#9187,cpfk_customer_orders#9188,cfpk_orders_customer#9189,cval_orders_o_orderstatus#9190,cval_orders_o_totalprice#9191,cval_orders_o_orderpriority#9192,cval_orders_o_clerk#9193,cval_orders_o_shippriority#9194,cval_orders_o_comment#9195,cval_orders_o_orderdate#9196,co_orderstatus#9197,co_totalprice#9198,co_orderpriority#9199,co_clerk#9200,co_shippriority#9201,co_comment#9202,co_orderdate#9203] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#9123 AS rid_5#9140, cpfk_customer_orders#9124 AS cpfk_customer_orders_5#9141, cfpk_orders_customer#9125 AS cfpk_orders_customer_5#9142, cval_orders_o_orderstatus#9126 AS cval_orders_o_orderstatus_5#9143, cval_orders_o_totalprice#9127 AS cval_orders_o_totalprice_5#9144, cval_orders_o_orderpriority#9128 AS cval_orders_o_orderpriority_5#9145, cval_orders_o_clerk#9129 AS cval_orders_o_clerk_5#9146, cval_orders_o_shippriority#9130 AS cval_orders_o_shippriority_5#9147, cval_orders_o_comment#9131 AS cval_orders_o_comment_5#9148, cval_orders_o_orderdate#9132 AS cval_orders_o_orderdate_5#9149, co_orderstatus#9133 AS co_orderstatus_5#9150, co_totalprice#9134 AS co_totalprice_5#9151, co_orderpriority#9135 AS co_orderpriority_5#9152, co_clerk#9136 AS co_clerk_5#9153, co_shippriority#9137 AS co_shippriority_5#9154, co_comment#9138 AS co_comment_5#9155, co_orderdate#9139 AS co_orderdate_5#9156]
                  +- Relation[rid#9123,cpfk_customer_orders#9124,cfpk_orders_customer#9125,cval_orders_o_orderstatus#9126,cval_orders_o_totalprice#9127,cval_orders_o_orderpriority#9128,cval_orders_o_clerk#9129,cval_orders_o_shippriority#9130,cval_orders_o_comment#9131,cval_orders_o_orderdate#9132,co_orderstatus#9133,co_totalprice#9134,co_orderpriority#9135,co_clerk#9136,co_shippriority#9137,co_comment#9138,co_orderdate#9139] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 329ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/15 15:18:07 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:18:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9318L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 15:18:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9318L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#9320 AS rid_0#9337, cpfk_customer_orders#9321 AS cpfk_customer_orders_0#9338, cfpk_orders_customer#9322 AS cfpk_orders_customer_0#9339, cval_orders_o_orderstatus#9323 AS cval_orders_o_orderstatus_0#9340, cval_orders_o_totalprice#9324 AS cval_orders_o_totalprice_0#9341, cval_orders_o_orderpriority#9325 AS cval_orders_o_orderpriority_0#9342, cval_orders_o_clerk#9326 AS cval_orders_o_clerk_0#9343, cval_orders_o_shippriority#9327 AS cval_orders_o_shippriority_0#9344, cval_orders_o_comment#9328 AS cval_orders_o_comment_0#9345, cval_orders_o_orderdate#9329 AS cval_orders_o_orderdate_0#9346, co_orderstatus#9330 AS co_orderstatus_0#9347, co_totalprice#9331 AS co_totalprice_0#9348, co_orderpriority#9332 AS co_orderpriority_0#9349, co_clerk#9333 AS co_clerk_0#9350, co_shippriority#9334 AS co_shippriority_0#9351, co_comment#9335 AS co_comment_0#9352, co_orderdate#9336 AS co_orderdate_0#9353]
            :  +- Relation[rid#9320,cpfk_customer_orders#9321,cfpk_orders_customer#9322,cval_orders_o_orderstatus#9323,cval_orders_o_totalprice#9324,cval_orders_o_orderpriority#9325,cval_orders_o_clerk#9326,cval_orders_o_shippriority#9327,cval_orders_o_comment#9328,cval_orders_o_orderdate#9329,co_orderstatus#9330,co_totalprice#9331,co_orderpriority#9332,co_clerk#9333,co_shippriority#9334,co_comment#9335,co_orderdate#9336] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#9354 AS rid_1#9369, cpfk_nation_customer#9355 AS cpfk_nation_customer_1#9370, cfpk_customer_nation#9356 AS cfpk_customer_nation_1#9371, cval_customer_c_name#9357 AS cval_customer_c_name_1#9372, cval_customer_c_address#9358 AS cval_customer_c_address_1#9373, cval_customer_c_phone#9359 AS cval_customer_c_phone_1#9374, cval_customer_c_acctbal#9360 AS cval_customer_c_acctbal_1#9375, cval_customer_c_comment#9361 AS cval_customer_c_comment_1#9376, cval_customer_c_mktsegment#9362 AS cval_customer_c_mktsegment_1#9377, cc_name#9363 AS cc_name_1#9378, cc_address#9364 AS cc_address_1#9379, cc_phone#9365 AS cc_phone_1#9380, cc_acctbal#9366 AS cc_acctbal_1#9381, cc_comment#9367 AS cc_comment_1#9382, cc_mktsegment#9368 AS cc_mktsegment_1#9383]
               +- Relation[rid#9354,cpfk_nation_customer#9355,cfpk_customer_nation#9356,cval_customer_c_name#9357,cval_customer_c_address#9358,cval_customer_c_phone#9359,cval_customer_c_acctbal#9360,cval_customer_c_comment#9361,cval_customer_c_mktsegment#9362,cc_name#9363,cc_address#9364,cc_phone#9365,cc_acctbal#9366,cc_comment#9367,cc_mktsegment#9368] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13626ms
query=q1, count=6001215, duration=2789
query=q10, count=1478870, duration=71124
query=q11, count=1188, duration=1281
query=q12, count=857401, duration=23726
query=q13, count=1500000, duration=13791
query=q14, count=6001215, duration=88152
query=q15, count=6001215, duration=84957
query=q16, count=7890, duration=488
query=q17, count=408, duration=520
query=q18, count=6001215, duration=124190
query=q19, count=13, duration=66734
query=q2, count=0, duration=1656
query=q20, count=1, duration=780
query=q21a, count=120762, duration=92741
query=q22, count=1500000, duration=13626
query=q3, count=75006, duration=6155
query=q4, count=6001215, duration=55769
query=q5, count=1, duration=21471
query=q6, count=6001215, duration=2756
query=q7, count=0, duration=329
query=q8, count=0, duration=2246
query=q9a, count=6001215, duration=258804
query=q9b, count=6001215, duration=176422
