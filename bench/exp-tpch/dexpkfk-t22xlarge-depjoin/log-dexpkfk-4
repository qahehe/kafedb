20/04/15 15:36:48 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 13228ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Apr 15 15:36:51 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Apr 15 15:36:53 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Apr 15 15:36:53 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Apr 15 15:36:53 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Apr 15 15:36:53 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Apr 15 15:36:58 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Apr 15 15:37:03 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Apr 15 15:37:03 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/15 15:37:05 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:37:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2081L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:37:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:37:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:37:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:37:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:37:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:37:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:37:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:37:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:37:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:37:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:37:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:37:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:37:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:37:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:37:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:37:06 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/15 15:37:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2081L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#2083 AS rid_0#2100, cval_part_p_name#2084 AS cval_part_p_name_0#2101, cval_part_p_mfgr#2085 AS cval_part_p_mfgr_0#2102, cval_part_p_type#2086 AS cval_part_p_type_0#2103, cval_part_p_size#2087 AS cval_part_p_size_0#2104, cval_part_p_container#2088 AS cval_part_p_container_0#2105, cval_part_p_retailprice#2089 AS cval_part_p_retailprice_0#2106, cval_part_p_comment#2090 AS cval_part_p_comment_0#2107, cval_part_p_brand#2091 AS cval_part_p_brand_0#2108, cp_name#2092 AS cp_name_0#2109, cp_mfgr#2093 AS cp_mfgr_0#2110, cp_type#2094 AS cp_type_0#2111, cp_size#2095 AS cp_size_0#2112, cp_container#2096 AS cp_container_0#2113, cp_retailprice#2097 AS cp_retailprice_0#2114, cp_comment#2098 AS cp_comment_0#2115, cp_brand#2099 AS cp_brand_0#2116]
            :     :     :  :  :  :  +- Relation[rid#2083,cval_part_p_name#2084,cval_part_p_mfgr#2085,cval_part_p_type#2086,cval_part_p_size#2087,cval_part_p_container#2088,cval_part_p_retailprice#2089,cval_part_p_comment#2090,cval_part_p_brand#2091,cp_name#2092,cp_mfgr#2093,cp_type#2094,cp_size#2095,cp_container#2096,cp_retailprice#2097,cp_comment#2098,cp_brand#2099] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#2117 AS rid_0#2134, cval_part_p_name#2118 AS cval_part_p_name_0#2135, cval_part_p_mfgr#2119 AS cval_part_p_mfgr_0#2136, cval_part_p_type#2120 AS cval_part_p_type_0#2137, cval_part_p_size#2121 AS cval_part_p_size_0#2138, cval_part_p_container#2122 AS cval_part_p_container_0#2139, cval_part_p_retailprice#2123 AS cval_part_p_retailprice_0#2140, cval_part_p_comment#2124 AS cval_part_p_comment_0#2141, cval_part_p_brand#2125 AS cval_part_p_brand_0#2142, cp_name#2126 AS cp_name_0#2143, cp_mfgr#2127 AS cp_mfgr_0#2144, cp_type#2128 AS cp_type_0#2145, cp_size#2129 AS cp_size_0#2146, cp_container#2130 AS cp_container_0#2147, cp_retailprice#2131 AS cp_retailprice_0#2148, cp_comment#2132 AS cp_comment_0#2149, cp_brand#2133 AS cp_brand_0#2150]
            :     :     :  :  :        +- Relation[rid#2117,cval_part_p_name#2118,cval_part_p_mfgr#2119,cval_part_p_type#2120,cval_part_p_size#2121,cval_part_p_container#2122,cval_part_p_retailprice#2123,cval_part_p_comment#2124,cval_part_p_brand#2125,cp_name#2126,cp_mfgr#2127,cp_type#2128,cp_size#2129,cp_container#2130,cp_retailprice#2131,cp_comment#2132,cp_brand#2133] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- Project [rid#2251 AS rid_1#2284, cpfk_orders_lineitem#2252 AS cpfk_orders_lineitem_1#2285, cpfk_supplier_lineitem#2253 AS cpfk_supplier_lineitem_1#2286, cfpk_lineitem_supplier#2254 AS cfpk_lineitem_supplier_1#2287, cfpk_lineitem_partsupp#2255 AS cfpk_lineitem_partsupp_1#2288, cpfk_part_lineitem#2256 AS cpfk_part_lineitem_1#2289, cfpk_lineitem_part#2257 AS cfpk_lineitem_part_1#2290, cpfk_partsupp_lineitem#2258 AS cpfk_partsupp_lineitem_1#2291, cfpk_lineitem_orders#2259 AS cfpk_lineitem_orders_1#2292, cval_lineitem_l_quantity#2260 AS cval_lineitem_l_quantity_1#2293, cval_lineitem_l_extendedprice#2261 AS cval_lineitem_l_extendedprice_1#2294, cval_lineitem_l_discount#2262 AS cval_lineitem_l_discount_1#2295, cval_lineitem_l_tax#2263 AS cval_lineitem_l_tax_1#2296, cval_lineitem_l_returnflag#2264 AS cval_lineitem_l_returnflag_1#2297, cval_lineitem_l_linestatus#2265 AS cval_lineitem_l_linestatus_1#2298, cval_lineitem_l_commitdate#2266 AS cval_lineitem_l_commitdate_1#2299, cval_lineitem_l_receiptdate#2267 AS cval_lineitem_l_receiptdate_1#2300, cval_lineitem_l_shipinstruct#2268 AS cval_lineitem_l_shipinstruct_1#2301, cval_lineitem_l_shipmode#2269 AS cval_lineitem_l_shipmode_1#2302, cval_lineitem_l_comment#2270 AS cval_lineitem_l_comment_1#2303, cval_lineitem_l_shipdate#2271 AS cval_lineitem_l_shipdate_1#2304, cl_quantity#2272 AS cl_quantity_1#2305, cl_extendedprice#2273 AS cl_extendedprice_1#2306, cl_discount#2274 AS cl_discount_1#2307, ... 9 more fields]
            :     :     :  :     +- Relation[rid#2251,cpfk_orders_lineitem#2252,cpfk_supplier_lineitem#2253,cfpk_lineitem_supplier#2254,cfpk_lineitem_partsupp#2255,cpfk_part_lineitem#2256,cfpk_lineitem_part#2257,cpfk_partsupp_lineitem#2258,cfpk_lineitem_orders#2259,cval_lineitem_l_quantity#2260,cval_lineitem_l_extendedprice#2261,cval_lineitem_l_discount#2262,cval_lineitem_l_tax#2263,cval_lineitem_l_returnflag#2264,cval_lineitem_l_linestatus#2265,cval_lineitem_l_commitdate#2266,cval_lineitem_l_receiptdate#2267,cval_lineitem_l_shipinstruct#2268,cval_lineitem_l_shipmode#2269,cval_lineitem_l_comment#2270,cval_lineitem_l_shipdate#2271,cl_quantity#2272,cl_extendedprice#2273,cl_discount#2274,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#2151 AS rid_1#2184, cpfk_orders_lineitem#2152 AS cpfk_orders_lineitem_1#2185, cpfk_supplier_lineitem#2153 AS cpfk_supplier_lineitem_1#2186, cfpk_lineitem_supplier#2154 AS cfpk_lineitem_supplier_1#2187, cfpk_lineitem_partsupp#2155 AS cfpk_lineitem_partsupp_1#2188, cpfk_part_lineitem#2156 AS cpfk_part_lineitem_1#2189, cfpk_lineitem_part#2157 AS cfpk_lineitem_part_1#2190, cpfk_partsupp_lineitem#2158 AS cpfk_partsupp_lineitem_1#2191, cfpk_lineitem_orders#2159 AS cfpk_lineitem_orders_1#2192, cval_lineitem_l_quantity#2160 AS cval_lineitem_l_quantity_1#2193, cval_lineitem_l_extendedprice#2161 AS cval_lineitem_l_extendedprice_1#2194, cval_lineitem_l_discount#2162 AS cval_lineitem_l_discount_1#2195, cval_lineitem_l_tax#2163 AS cval_lineitem_l_tax_1#2196, cval_lineitem_l_returnflag#2164 AS cval_lineitem_l_returnflag_1#2197, cval_lineitem_l_linestatus#2165 AS cval_lineitem_l_linestatus_1#2198, cval_lineitem_l_commitdate#2166 AS cval_lineitem_l_commitdate_1#2199, cval_lineitem_l_receiptdate#2167 AS cval_lineitem_l_receiptdate_1#2200, cval_lineitem_l_shipinstruct#2168 AS cval_lineitem_l_shipinstruct_1#2201, cval_lineitem_l_shipmode#2169 AS cval_lineitem_l_shipmode_1#2202, cval_lineitem_l_comment#2170 AS cval_lineitem_l_comment_1#2203, cval_lineitem_l_shipdate#2171 AS cval_lineitem_l_shipdate_1#2204, cl_quantity#2172 AS cl_quantity_1#2205, cl_extendedprice#2173 AS cl_extendedprice_1#2206, cl_discount#2174 AS cl_discount_1#2207, ... 9 more fields]
            :     :     :     +- Relation[rid#2151,cpfk_orders_lineitem#2152,cpfk_supplier_lineitem#2153,cfpk_lineitem_supplier#2154,cfpk_lineitem_partsupp#2155,cpfk_part_lineitem#2156,cfpk_lineitem_part#2157,cpfk_partsupp_lineitem#2158,cfpk_lineitem_orders#2159,cval_lineitem_l_quantity#2160,cval_lineitem_l_extendedprice#2161,cval_lineitem_l_discount#2162,cval_lineitem_l_tax#2163,cval_lineitem_l_returnflag#2164,cval_lineitem_l_linestatus#2165,cval_lineitem_l_commitdate#2166,cval_lineitem_l_receiptdate#2167,cval_lineitem_l_shipinstruct#2168,cval_lineitem_l_shipmode#2169,cval_lineitem_l_comment#2170,cval_lineitem_l_shipdate#2171,cl_quantity#2172,cl_extendedprice#2173,cl_discount#2174,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#2317 AS rid_2#2330, cpfk_nation_supplier#2318 AS cpfk_nation_supplier_2#2331, cfpk_supplier_nation#2319 AS cfpk_supplier_nation_2#2332, cval_supplier_s_name#2320 AS cval_supplier_s_name_2#2333, cval_supplier_s_address#2321 AS cval_supplier_s_address_2#2334, cval_supplier_s_phone#2322 AS cval_supplier_s_phone_2#2335, cval_supplier_s_acctbal#2323 AS cval_supplier_s_acctbal_2#2336, cval_supplier_s_comment#2324 AS cval_supplier_s_comment_2#2337, cs_name#2325 AS cs_name_2#2338, cs_address#2326 AS cs_address_2#2339, cs_phone#2327 AS cs_phone_2#2340, cs_acctbal#2328 AS cs_acctbal_2#2341, cs_comment#2329 AS cs_comment_2#2342]
            :     :        +- Relation[rid#2317,cpfk_nation_supplier#2318,cfpk_supplier_nation#2319,cval_supplier_s_name#2320,cval_supplier_s_address#2321,cval_supplier_s_phone#2322,cval_supplier_s_acctbal#2323,cval_supplier_s_comment#2324,cs_name#2325,cs_address#2326,cs_phone#2327,cs_acctbal#2328,cs_comment#2329] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#2343 AS rid_3#2350, cpfk_region_nation#2344 AS cpfk_region_nation_3#2351, cfpk_nation_region#2345 AS cfpk_nation_region_3#2352, cval_nation_n_name#2346 AS cval_nation_n_name_3#2353, cval_nation_n_comment#2347 AS cval_nation_n_comment_3#2354, cn_name#2348 AS cn_name_3#2355, cn_comment#2349 AS cn_comment_3#2356]
            :        +- Relation[rid#2343,cpfk_region_nation#2344,cfpk_nation_region#2345,cval_nation_n_name#2346,cval_nation_n_comment#2347,cn_name#2348,cn_comment#2349] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#2357 AS rid_4#2362, cval_region_r_name#2358 AS cval_region_r_name_4#2363, cval_region_r_comment#2359 AS cval_region_r_comment_4#2364, cr_name#2360 AS cr_name_4#2365, cr_comment#2361 AS cr_comment_4#2366]
               :  :  :  :  :  :  :  +- Relation[rid#2357,cval_region_r_name#2358,cval_region_r_comment#2359,cr_name#2360,cr_comment#2361] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#2367 AS rid_4#2372, cval_region_r_name#2368 AS cval_region_r_name_4#2373, cval_region_r_comment#2369 AS cval_region_r_comment_4#2374, cr_name#2370 AS cr_name_4#2375, cr_comment#2371 AS cr_comment_4#2376]
               :  :  :  :  :  :        +- Relation[rid#2367,cval_region_r_name#2368,cval_region_r_comment#2369,cr_name#2370,cr_comment#2371] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- Project [rid#2401 AS rid_5#2408, cpfk_region_nation#2402 AS cpfk_region_nation_5#2409, cfpk_nation_region#2403 AS cfpk_nation_region_5#2410, cval_nation_n_name#2404 AS cval_nation_n_name_5#2411, cval_nation_n_comment#2405 AS cval_nation_n_comment_5#2412, cn_name#2406 AS cn_name_5#2413, cn_comment#2407 AS cn_comment_5#2414]
               :  :  :  :  :     +- Relation[rid#2401,cpfk_region_nation#2402,cfpk_nation_region#2403,cval_nation_n_name#2404,cval_nation_n_comment#2405,cn_name#2406,cn_comment#2407] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#2377 AS rid_5#2384, cpfk_region_nation#2378 AS cpfk_region_nation_5#2385, cfpk_nation_region#2379 AS cfpk_nation_region_5#2386, cval_nation_n_name#2380 AS cval_nation_n_name_5#2387, cval_nation_n_comment#2381 AS cval_nation_n_comment_5#2388, cn_name#2382 AS cn_name_5#2389, cn_comment#2383 AS cn_comment_5#2390]
               :  :  :  :     +- Relation[rid#2377,cpfk_region_nation#2378,cfpk_nation_region#2379,cval_nation_n_name#2380,cval_nation_n_comment#2381,cn_name#2382,cn_comment#2383] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#2459 AS rid_6#2474, cpfk_nation_customer#2460 AS cpfk_nation_customer_6#2475, cfpk_customer_nation#2461 AS cfpk_customer_nation_6#2476, cval_customer_c_name#2462 AS cval_customer_c_name_6#2477, cval_customer_c_address#2463 AS cval_customer_c_address_6#2478, cval_customer_c_phone#2464 AS cval_customer_c_phone_6#2479, cval_customer_c_acctbal#2465 AS cval_customer_c_acctbal_6#2480, cval_customer_c_comment#2466 AS cval_customer_c_comment_6#2481, cval_customer_c_mktsegment#2467 AS cval_customer_c_mktsegment_6#2482, cc_name#2468 AS cc_name_6#2483, cc_address#2469 AS cc_address_6#2484, cc_phone#2470 AS cc_phone_6#2485, cc_acctbal#2471 AS cc_acctbal_6#2486, cc_comment#2472 AS cc_comment_6#2487, cc_mktsegment#2473 AS cc_mktsegment_6#2488]
               :  :  :     +- Relation[rid#2459,cpfk_nation_customer#2460,cfpk_customer_nation#2461,cval_customer_c_name#2462,cval_customer_c_address#2463,cval_customer_c_phone#2464,cval_customer_c_acctbal#2465,cval_customer_c_comment#2466,cval_customer_c_mktsegment#2467,cc_name#2468,cc_address#2469,cc_phone#2470,cc_acctbal#2471,cc_comment#2472,cc_mktsegment#2473] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#2415 AS rid_6#2430, cpfk_nation_customer#2416 AS cpfk_nation_customer_6#2431, cfpk_customer_nation#2417 AS cfpk_customer_nation_6#2432, cval_customer_c_name#2418 AS cval_customer_c_name_6#2433, cval_customer_c_address#2419 AS cval_customer_c_address_6#2434, cval_customer_c_phone#2420 AS cval_customer_c_phone_6#2435, cval_customer_c_acctbal#2421 AS cval_customer_c_acctbal_6#2436, cval_customer_c_comment#2422 AS cval_customer_c_comment_6#2437, cval_customer_c_mktsegment#2423 AS cval_customer_c_mktsegment_6#2438, cc_name#2424 AS cc_name_6#2439, cc_address#2425 AS cc_address_6#2440, cc_phone#2426 AS cc_phone_6#2441, cc_acctbal#2427 AS cc_acctbal_6#2442, cc_comment#2428 AS cc_comment_6#2443, cc_mktsegment#2429 AS cc_mktsegment_6#2444]
               :  :     +- Relation[rid#2415,cpfk_nation_customer#2416,cfpk_customer_nation#2417,cval_customer_c_name#2418,cval_customer_c_address#2419,cval_customer_c_phone#2420,cval_customer_c_acctbal#2421,cval_customer_c_comment#2422,cval_customer_c_mktsegment#2423,cc_name#2424,cc_address#2425,cc_phone#2426,cc_acctbal#2427,cc_comment#2428,cc_mktsegment#2429] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#2553 AS rid_7#2570, cpfk_customer_orders#2554 AS cpfk_customer_orders_7#2571, cfpk_orders_customer#2555 AS cfpk_orders_customer_7#2572, cval_orders_o_orderstatus#2556 AS cval_orders_o_orderstatus_7#2573, cval_orders_o_totalprice#2557 AS cval_orders_o_totalprice_7#2574, cval_orders_o_orderpriority#2558 AS cval_orders_o_orderpriority_7#2575, cval_orders_o_clerk#2559 AS cval_orders_o_clerk_7#2576, cval_orders_o_shippriority#2560 AS cval_orders_o_shippriority_7#2577, cval_orders_o_comment#2561 AS cval_orders_o_comment_7#2578, cval_orders_o_orderdate#2562 AS cval_orders_o_orderdate_7#2579, co_orderstatus#2563 AS co_orderstatus_7#2580, co_totalprice#2564 AS co_totalprice_7#2581, co_orderpriority#2565 AS co_orderpriority_7#2582, co_clerk#2566 AS co_clerk_7#2583, co_shippriority#2567 AS co_shippriority_7#2584, co_comment#2568 AS co_comment_7#2585, co_orderdate#2569 AS co_orderdate_7#2586]
               :     +- Relation[rid#2553,cpfk_customer_orders#2554,cfpk_orders_customer#2555,cval_orders_o_orderstatus#2556,cval_orders_o_totalprice#2557,cval_orders_o_orderpriority#2558,cval_orders_o_clerk#2559,cval_orders_o_shippriority#2560,cval_orders_o_comment#2561,cval_orders_o_orderdate#2562,co_orderstatus#2563,co_totalprice#2564,co_orderpriority#2565,co_clerk#2566,co_shippriority#2567,co_comment#2568,co_orderdate#2569] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#2489 AS rid_7#2506, cpfk_customer_orders#2490 AS cpfk_customer_orders_7#2507, cfpk_orders_customer#2491 AS cfpk_orders_customer_7#2508, cval_orders_o_orderstatus#2492 AS cval_orders_o_orderstatus_7#2509, cval_orders_o_totalprice#2493 AS cval_orders_o_totalprice_7#2510, cval_orders_o_orderpriority#2494 AS cval_orders_o_orderpriority_7#2511, cval_orders_o_clerk#2495 AS cval_orders_o_clerk_7#2512, cval_orders_o_shippriority#2496 AS cval_orders_o_shippriority_7#2513, cval_orders_o_comment#2497 AS cval_orders_o_comment_7#2514, cval_orders_o_orderdate#2498 AS cval_orders_o_orderdate_7#2515, co_orderstatus#2499 AS co_orderstatus_7#2516, co_totalprice#2500 AS co_totalprice_7#2517, co_orderpriority#2501 AS co_orderpriority_7#2518, co_clerk#2502 AS co_clerk_7#2519, co_shippriority#2503 AS co_shippriority_7#2520, co_comment#2504 AS co_comment_7#2521, co_orderdate#2505 AS co_orderdate_7#2522]
                  +- Relation[rid#2489,cpfk_customer_orders#2490,cfpk_orders_customer#2491,cval_orders_o_orderstatus#2492,cval_orders_o_totalprice#2493,cval_orders_o_orderpriority#2494,cval_orders_o_clerk#2495,cval_orders_o_shippriority#2496,cval_orders_o_comment#2497,cval_orders_o_orderdate#2498,co_orderstatus#2499,co_totalprice#2500,co_orderpriority#2501,co_clerk#2502,co_shippriority#2503,co_comment#2504,co_orderdate#2505] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 2688ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/15 15:37:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:37:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2707L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 15:37:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:37:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:37:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:37:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:37:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:37:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:37:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:37:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:37:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:37:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:37:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:37:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:37:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:37:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2707L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#2709 AS rid_0#2716, cpfk_region_nation#2710 AS cpfk_region_nation_0#2717, cfpk_nation_region#2711 AS cfpk_nation_region_0#2718, cval_nation_n_name#2712 AS cval_nation_n_name_0#2719, cval_nation_n_comment#2713 AS cval_nation_n_comment_0#2720, cn_name#2714 AS cn_name_0#2721, cn_comment#2715 AS cn_comment_0#2722]
         :  :  :  :  :  +- Relation[rid#2709,cpfk_region_nation#2710,cfpk_nation_region#2711,cval_nation_n_name#2712,cval_nation_n_comment#2713,cn_name#2714,cn_comment#2715] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#2723 AS rid_0#2730, cpfk_region_nation#2724 AS cpfk_region_nation_0#2731, cfpk_nation_region#2725 AS cfpk_nation_region_0#2732, cval_nation_n_name#2726 AS cval_nation_n_name_0#2733, cval_nation_n_comment#2727 AS cval_nation_n_comment_0#2734, cn_name#2728 AS cn_name_0#2735, cn_comment#2729 AS cn_comment_0#2736]
         :  :  :  :        +- Relation[rid#2723,cpfk_region_nation#2724,cfpk_nation_region#2725,cval_nation_n_name#2726,cval_nation_n_comment#2727,cn_name#2728,cn_comment#2729] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#2777 AS rid_1#2790, cpfk_nation_supplier#2778 AS cpfk_nation_supplier_1#2791, cfpk_supplier_nation#2779 AS cfpk_supplier_nation_1#2792, cval_supplier_s_name#2780 AS cval_supplier_s_name_1#2793, cval_supplier_s_address#2781 AS cval_supplier_s_address_1#2794, cval_supplier_s_phone#2782 AS cval_supplier_s_phone_1#2795, cval_supplier_s_acctbal#2783 AS cval_supplier_s_acctbal_1#2796, cval_supplier_s_comment#2784 AS cval_supplier_s_comment_1#2797, cs_name#2785 AS cs_name_1#2798, cs_address#2786 AS cs_address_1#2799, cs_phone#2787 AS cs_phone_1#2800, cs_acctbal#2788 AS cs_acctbal_1#2801, cs_comment#2789 AS cs_comment_1#2802]
         :  :  :     +- Relation[rid#2777,cpfk_nation_supplier#2778,cfpk_supplier_nation#2779,cval_supplier_s_name#2780,cval_supplier_s_address#2781,cval_supplier_s_phone#2782,cval_supplier_s_acctbal#2783,cval_supplier_s_comment#2784,cs_name#2785,cs_address#2786,cs_phone#2787,cs_acctbal#2788,cs_comment#2789] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#2737 AS rid_1#2750, cpfk_nation_supplier#2738 AS cpfk_nation_supplier_1#2751, cfpk_supplier_nation#2739 AS cfpk_supplier_nation_1#2752, cval_supplier_s_name#2740 AS cval_supplier_s_name_1#2753, cval_supplier_s_address#2741 AS cval_supplier_s_address_1#2754, cval_supplier_s_phone#2742 AS cval_supplier_s_phone_1#2755, cval_supplier_s_acctbal#2743 AS cval_supplier_s_acctbal_1#2756, cval_supplier_s_comment#2744 AS cval_supplier_s_comment_1#2757, cs_name#2745 AS cs_name_1#2758, cs_address#2746 AS cs_address_1#2759, cs_phone#2747 AS cs_phone_1#2760, cs_acctbal#2748 AS cs_acctbal_1#2761, cs_comment#2749 AS cs_comment_1#2762]
         :  :     +- Relation[rid#2737,cpfk_nation_supplier#2738,cfpk_supplier_nation#2739,cval_supplier_s_name#2740,cval_supplier_s_address#2741,cval_supplier_s_phone#2742,cval_supplier_s_acctbal#2743,cval_supplier_s_comment#2744,cs_name#2745,cs_address#2746,cs_phone#2747,cs_acctbal#2748,cs_comment#2749] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#2851 AS rid_2#2862, cpfk_part_partsupp#2852 AS cpfk_part_partsupp_2#2863, cfpk_partsupp_part#2853 AS cfpk_partsupp_part_2#2864, cpfk_supplier_partsupp#2854 AS cpfk_supplier_partsupp_2#2865, cfpk_partsupp_supplier#2855 AS cfpk_partsupp_supplier_2#2866, cval_partsupp_ps_availqty#2856 AS cval_partsupp_ps_availqty_2#2867, cval_partsupp_ps_supplycost#2857 AS cval_partsupp_ps_supplycost_2#2868, cval_partsupp_ps_comment#2858 AS cval_partsupp_ps_comment_2#2869, cps_availqty#2859 AS cps_availqty_2#2870, cps_supplycost#2860 AS cps_supplycost_2#2871, cps_comment#2861 AS cps_comment_2#2872]
         :     +- Relation[rid#2851,cpfk_part_partsupp#2852,cfpk_partsupp_part#2853,cpfk_supplier_partsupp#2854,cfpk_partsupp_supplier#2855,cval_partsupp_ps_availqty#2856,cval_partsupp_ps_supplycost#2857,cval_partsupp_ps_comment#2858,cps_availqty#2859,cps_supplycost#2860,cps_comment#2861] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#2803 AS rid_2#2814, cpfk_part_partsupp#2804 AS cpfk_part_partsupp_2#2815, cfpk_partsupp_part#2805 AS cfpk_partsupp_part_2#2816, cpfk_supplier_partsupp#2806 AS cpfk_supplier_partsupp_2#2817, cfpk_partsupp_supplier#2807 AS cfpk_partsupp_supplier_2#2818, cval_partsupp_ps_availqty#2808 AS cval_partsupp_ps_availqty_2#2819, cval_partsupp_ps_supplycost#2809 AS cval_partsupp_ps_supplycost_2#2820, cval_partsupp_ps_comment#2810 AS cval_partsupp_ps_comment_2#2821, cps_availqty#2811 AS cps_availqty_2#2822, cps_supplycost#2812 AS cps_supplycost_2#2823, cps_comment#2813 AS cps_comment_2#2824]
            +- Relation[rid#2803,cpfk_part_partsupp#2804,cfpk_partsupp_part#2805,cpfk_supplier_partsupp#2806,cfpk_partsupp_supplier#2807,cval_partsupp_ps_availqty#2808,cval_partsupp_ps_supplycost#2809,cval_partsupp_ps_comment#2810,cps_availqty#2811,cps_supplycost#2812,cps_comment#2813] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=4
Elapsed time: 1211ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/15 15:37:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:37:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2916L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 15:37:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:37:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:37:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2916L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#2918 AS rid_0#2951, cpfk_orders_lineitem#2919 AS cpfk_orders_lineitem_0#2952, cpfk_supplier_lineitem#2920 AS cpfk_supplier_lineitem_0#2953, cfpk_lineitem_supplier#2921 AS cfpk_lineitem_supplier_0#2954, cfpk_lineitem_partsupp#2922 AS cfpk_lineitem_partsupp_0#2955, cpfk_part_lineitem#2923 AS cpfk_part_lineitem_0#2956, cfpk_lineitem_part#2924 AS cfpk_lineitem_part_0#2957, cpfk_partsupp_lineitem#2925 AS cpfk_partsupp_lineitem_0#2958, cfpk_lineitem_orders#2926 AS cfpk_lineitem_orders_0#2959, cval_lineitem_l_quantity#2927 AS cval_lineitem_l_quantity_0#2960, cval_lineitem_l_extendedprice#2928 AS cval_lineitem_l_extendedprice_0#2961, cval_lineitem_l_discount#2929 AS cval_lineitem_l_discount_0#2962, cval_lineitem_l_tax#2930 AS cval_lineitem_l_tax_0#2963, cval_lineitem_l_returnflag#2931 AS cval_lineitem_l_returnflag_0#2964, cval_lineitem_l_linestatus#2932 AS cval_lineitem_l_linestatus_0#2965, cval_lineitem_l_commitdate#2933 AS cval_lineitem_l_commitdate_0#2966, cval_lineitem_l_receiptdate#2934 AS cval_lineitem_l_receiptdate_0#2967, cval_lineitem_l_shipinstruct#2935 AS cval_lineitem_l_shipinstruct_0#2968, cval_lineitem_l_shipmode#2936 AS cval_lineitem_l_shipmode_0#2969, cval_lineitem_l_comment#2937 AS cval_lineitem_l_comment_0#2970, cval_lineitem_l_shipdate#2938 AS cval_lineitem_l_shipdate_0#2971, cl_quantity#2939 AS cl_quantity_0#2972, cl_extendedprice#2940 AS cl_extendedprice_0#2973, cl_discount#2941 AS cl_discount_0#2974, ... 9 more fields]
            :     :     :  :  +- Relation[rid#2918,cpfk_orders_lineitem#2919,cpfk_supplier_lineitem#2920,cfpk_lineitem_supplier#2921,cfpk_lineitem_partsupp#2922,cpfk_part_lineitem#2923,cfpk_lineitem_part#2924,cpfk_partsupp_lineitem#2925,cfpk_lineitem_orders#2926,cval_lineitem_l_quantity#2927,cval_lineitem_l_extendedprice#2928,cval_lineitem_l_discount#2929,cval_lineitem_l_tax#2930,cval_lineitem_l_returnflag#2931,cval_lineitem_l_linestatus#2932,cval_lineitem_l_commitdate#2933,cval_lineitem_l_receiptdate#2934,cval_lineitem_l_shipinstruct#2935,cval_lineitem_l_shipmode#2936,cval_lineitem_l_comment#2937,cval_lineitem_l_shipdate#2938,cl_quantity#2939,cl_extendedprice#2940,cl_discount#2941,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#2984 AS rid_0#3017, cpfk_orders_lineitem#2985 AS cpfk_orders_lineitem_0#3018, cpfk_supplier_lineitem#2986 AS cpfk_supplier_lineitem_0#3019, cfpk_lineitem_supplier#2987 AS cfpk_lineitem_supplier_0#3020, cfpk_lineitem_partsupp#2988 AS cfpk_lineitem_partsupp_0#3021, cpfk_part_lineitem#2989 AS cpfk_part_lineitem_0#3022, cfpk_lineitem_part#2990 AS cfpk_lineitem_part_0#3023, cpfk_partsupp_lineitem#2991 AS cpfk_partsupp_lineitem_0#3024, cfpk_lineitem_orders#2992 AS cfpk_lineitem_orders_0#3025, cval_lineitem_l_quantity#2993 AS cval_lineitem_l_quantity_0#3026, cval_lineitem_l_extendedprice#2994 AS cval_lineitem_l_extendedprice_0#3027, cval_lineitem_l_discount#2995 AS cval_lineitem_l_discount_0#3028, cval_lineitem_l_tax#2996 AS cval_lineitem_l_tax_0#3029, cval_lineitem_l_returnflag#2997 AS cval_lineitem_l_returnflag_0#3030, cval_lineitem_l_linestatus#2998 AS cval_lineitem_l_linestatus_0#3031, cval_lineitem_l_commitdate#2999 AS cval_lineitem_l_commitdate_0#3032, cval_lineitem_l_receiptdate#3000 AS cval_lineitem_l_receiptdate_0#3033, cval_lineitem_l_shipinstruct#3001 AS cval_lineitem_l_shipinstruct_0#3034, cval_lineitem_l_shipmode#3002 AS cval_lineitem_l_shipmode_0#3035, cval_lineitem_l_comment#3003 AS cval_lineitem_l_comment_0#3036, cval_lineitem_l_shipdate#3004 AS cval_lineitem_l_shipdate_0#3037, cl_quantity#3005 AS cl_quantity_0#3038, cl_extendedprice#3006 AS cl_extendedprice_0#3039, cl_discount#3007 AS cl_discount_0#3040, ... 9 more fields]
            :     :     :        +- Relation[rid#2984,cpfk_orders_lineitem#2985,cpfk_supplier_lineitem#2986,cfpk_lineitem_supplier#2987,cfpk_lineitem_partsupp#2988,cpfk_part_lineitem#2989,cfpk_lineitem_part#2990,cpfk_partsupp_lineitem#2991,cfpk_lineitem_orders#2992,cval_lineitem_l_quantity#2993,cval_lineitem_l_extendedprice#2994,cval_lineitem_l_discount#2995,cval_lineitem_l_tax#2996,cval_lineitem_l_returnflag#2997,cval_lineitem_l_linestatus#2998,cval_lineitem_l_commitdate#2999,cval_lineitem_l_receiptdate#3000,cval_lineitem_l_shipinstruct#3001,cval_lineitem_l_shipmode#3002,cval_lineitem_l_comment#3003,cval_lineitem_l_shipdate#3004,cl_quantity#3005,cl_extendedprice#3006,cl_discount#3007,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#3050 AS rid_1#3067, cpfk_customer_orders#3051 AS cpfk_customer_orders_1#3068, cfpk_orders_customer#3052 AS cfpk_orders_customer_1#3069, cval_orders_o_orderstatus#3053 AS cval_orders_o_orderstatus_1#3070, cval_orders_o_totalprice#3054 AS cval_orders_o_totalprice_1#3071, cval_orders_o_orderpriority#3055 AS cval_orders_o_orderpriority_1#3072, cval_orders_o_clerk#3056 AS cval_orders_o_clerk_1#3073, cval_orders_o_shippriority#3057 AS cval_orders_o_shippriority_1#3074, cval_orders_o_comment#3058 AS cval_orders_o_comment_1#3075, cval_orders_o_orderdate#3059 AS cval_orders_o_orderdate_1#3076, co_orderstatus#3060 AS co_orderstatus_1#3077, co_totalprice#3061 AS co_totalprice_1#3078, co_orderpriority#3062 AS co_orderpriority_1#3079, co_clerk#3063 AS co_clerk_1#3080, co_shippriority#3064 AS co_shippriority_1#3081, co_comment#3065 AS co_comment_1#3082, co_orderdate#3066 AS co_orderdate_1#3083]
            :     :        +- Relation[rid#3050,cpfk_customer_orders#3051,cfpk_orders_customer#3052,cval_orders_o_orderstatus#3053,cval_orders_o_totalprice#3054,cval_orders_o_orderpriority#3055,cval_orders_o_clerk#3056,cval_orders_o_shippriority#3057,cval_orders_o_comment#3058,cval_orders_o_orderdate#3059,co_orderstatus#3060,co_totalprice#3061,co_orderpriority#3062,co_clerk#3063,co_shippriority#3064,co_comment#3065,co_orderdate#3066] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#3084 AS rid_2#3099, cpfk_nation_customer#3085 AS cpfk_nation_customer_2#3100, cfpk_customer_nation#3086 AS cfpk_customer_nation_2#3101, cval_customer_c_name#3087 AS cval_customer_c_name_2#3102, cval_customer_c_address#3088 AS cval_customer_c_address_2#3103, cval_customer_c_phone#3089 AS cval_customer_c_phone_2#3104, cval_customer_c_acctbal#3090 AS cval_customer_c_acctbal_2#3105, cval_customer_c_comment#3091 AS cval_customer_c_comment_2#3106, cval_customer_c_mktsegment#3092 AS cval_customer_c_mktsegment_2#3107, cc_name#3093 AS cc_name_2#3108, cc_address#3094 AS cc_address_2#3109, cc_phone#3095 AS cc_phone_2#3110, cc_acctbal#3096 AS cc_acctbal_2#3111, cc_comment#3097 AS cc_comment_2#3112, cc_mktsegment#3098 AS cc_mktsegment_2#3113]
            :        +- Relation[rid#3084,cpfk_nation_customer#3085,cfpk_customer_nation#3086,cval_customer_c_name#3087,cval_customer_c_address#3088,cval_customer_c_phone#3089,cval_customer_c_acctbal#3090,cval_customer_c_comment#3091,cval_customer_c_mktsegment#3092,cc_name#3093,cc_address#3094,cc_phone#3095,cc_acctbal#3096,cc_comment#3097,cc_mktsegment#3098] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#3114 AS rid_3#3121, cpfk_region_nation#3115 AS cpfk_region_nation_3#3122, cfpk_nation_region#3116 AS cfpk_nation_region_3#3123, cval_nation_n_name#3117 AS cval_nation_n_name_3#3124, cval_nation_n_comment#3118 AS cval_nation_n_comment_3#3125, cn_name#3119 AS cn_name_3#3126, cn_comment#3120 AS cn_comment_3#3127]
               +- Relation[rid#3114,cpfk_region_nation#3115,cfpk_nation_region#3116,cval_nation_n_name#3117,cval_nation_n_comment#3118,cn_name#3119,cn_comment#3120] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 66368ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/15 15:38:15 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:38:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3228L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:38:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3228L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#3230 AS rid_0#3263, cpfk_orders_lineitem#3231 AS cpfk_orders_lineitem_0#3264, cpfk_supplier_lineitem#3232 AS cpfk_supplier_lineitem_0#3265, cfpk_lineitem_supplier#3233 AS cfpk_lineitem_supplier_0#3266, cfpk_lineitem_partsupp#3234 AS cfpk_lineitem_partsupp_0#3267, cpfk_part_lineitem#3235 AS cpfk_part_lineitem_0#3268, cfpk_lineitem_part#3236 AS cfpk_lineitem_part_0#3269, cpfk_partsupp_lineitem#3237 AS cpfk_partsupp_lineitem_0#3270, cfpk_lineitem_orders#3238 AS cfpk_lineitem_orders_0#3271, cval_lineitem_l_quantity#3239 AS cval_lineitem_l_quantity_0#3272, cval_lineitem_l_extendedprice#3240 AS cval_lineitem_l_extendedprice_0#3273, cval_lineitem_l_discount#3241 AS cval_lineitem_l_discount_0#3274, cval_lineitem_l_tax#3242 AS cval_lineitem_l_tax_0#3275, cval_lineitem_l_returnflag#3243 AS cval_lineitem_l_returnflag_0#3276, cval_lineitem_l_linestatus#3244 AS cval_lineitem_l_linestatus_0#3277, cval_lineitem_l_commitdate#3245 AS cval_lineitem_l_commitdate_0#3278, cval_lineitem_l_receiptdate#3246 AS cval_lineitem_l_receiptdate_0#3279, cval_lineitem_l_shipinstruct#3247 AS cval_lineitem_l_shipinstruct_0#3280, cval_lineitem_l_shipmode#3248 AS cval_lineitem_l_shipmode_0#3281, cval_lineitem_l_comment#3249 AS cval_lineitem_l_comment_0#3282, cval_lineitem_l_shipdate#3250 AS cval_lineitem_l_shipdate_0#3283, cl_quantity#3251 AS cl_quantity_0#3284, cl_extendedprice#3252 AS cl_extendedprice_0#3285, cl_discount#3253 AS cl_discount_0#3286, ... 9 more fields]
            :  +- Relation[rid#3230,cpfk_orders_lineitem#3231,cpfk_supplier_lineitem#3232,cfpk_lineitem_supplier#3233,cfpk_lineitem_partsupp#3234,cpfk_part_lineitem#3235,cfpk_lineitem_part#3236,cpfk_partsupp_lineitem#3237,cfpk_lineitem_orders#3238,cval_lineitem_l_quantity#3239,cval_lineitem_l_extendedprice#3240,cval_lineitem_l_discount#3241,cval_lineitem_l_tax#3242,cval_lineitem_l_returnflag#3243,cval_lineitem_l_linestatus#3244,cval_lineitem_l_commitdate#3245,cval_lineitem_l_receiptdate#3246,cval_lineitem_l_shipinstruct#3247,cval_lineitem_l_shipmode#3248,cval_lineitem_l_comment#3249,cval_lineitem_l_shipdate#3250,cl_quantity#3251,cl_extendedprice#3252,cl_discount#3253,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#3296 AS rid_1#3313, cpfk_customer_orders#3297 AS cpfk_customer_orders_1#3314, cfpk_orders_customer#3298 AS cfpk_orders_customer_1#3315, cval_orders_o_orderstatus#3299 AS cval_orders_o_orderstatus_1#3316, cval_orders_o_totalprice#3300 AS cval_orders_o_totalprice_1#3317, cval_orders_o_orderpriority#3301 AS cval_orders_o_orderpriority_1#3318, cval_orders_o_clerk#3302 AS cval_orders_o_clerk_1#3319, cval_orders_o_shippriority#3303 AS cval_orders_o_shippriority_1#3320, cval_orders_o_comment#3304 AS cval_orders_o_comment_1#3321, cval_orders_o_orderdate#3305 AS cval_orders_o_orderdate_1#3322, co_orderstatus#3306 AS co_orderstatus_1#3323, co_totalprice#3307 AS co_totalprice_1#3324, co_orderpriority#3308 AS co_orderpriority_1#3325, co_clerk#3309 AS co_clerk_1#3326, co_shippriority#3310 AS co_shippriority_1#3327, co_comment#3311 AS co_comment_1#3328, co_orderdate#3312 AS co_orderdate_1#3329]
               +- Relation[rid#3296,cpfk_customer_orders#3297,cfpk_orders_customer#3298,cval_orders_o_orderstatus#3299,cval_orders_o_totalprice#3300,cval_orders_o_orderpriority#3301,cval_orders_o_clerk#3302,cval_orders_o_shippriority#3303,cval_orders_o_comment#3304,cval_orders_o_orderdate#3305,co_orderstatus#3306,co_totalprice#3307,co_orderpriority#3308,co_clerk#3309,co_shippriority#3310,co_comment#3311,co_orderdate#3312] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 56140ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/15 15:39:11 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:39:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3387L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 15:39:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:39:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:39:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:39:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3387L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#3389 AS rid_0#3406, cval_part_p_name#3390 AS cval_part_p_name_0#3407, cval_part_p_mfgr#3391 AS cval_part_p_mfgr_0#3408, cval_part_p_type#3392 AS cval_part_p_type_0#3409, cval_part_p_size#3393 AS cval_part_p_size_0#3410, cval_part_p_container#3394 AS cval_part_p_container_0#3411, cval_part_p_retailprice#3395 AS cval_part_p_retailprice_0#3412, cval_part_p_comment#3396 AS cval_part_p_comment_0#3413, cval_part_p_brand#3397 AS cval_part_p_brand_0#3414, cp_name#3398 AS cp_name_0#3415, cp_mfgr#3399 AS cp_mfgr_0#3416, cp_type#3400 AS cp_type_0#3417, cp_size#3401 AS cp_size_0#3418, cp_container#3402 AS cp_container_0#3419, cp_retailprice#3403 AS cp_retailprice_0#3420, cp_comment#3404 AS cp_comment_0#3421, cp_brand#3405 AS cp_brand_0#3422]
         :  :  :  +- Relation[rid#3389,cval_part_p_name#3390,cval_part_p_mfgr#3391,cval_part_p_type#3392,cval_part_p_size#3393,cval_part_p_container#3394,cval_part_p_retailprice#3395,cval_part_p_comment#3396,cval_part_p_brand#3397,cp_name#3398,cp_mfgr#3399,cp_type#3400,cp_size#3401,cp_container#3402,cp_retailprice#3403,cp_comment#3404,cp_brand#3405] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#3423 AS rid_0#3440, cval_part_p_name#3424 AS cval_part_p_name_0#3441, cval_part_p_mfgr#3425 AS cval_part_p_mfgr_0#3442, cval_part_p_type#3426 AS cval_part_p_type_0#3443, cval_part_p_size#3427 AS cval_part_p_size_0#3444, cval_part_p_container#3428 AS cval_part_p_container_0#3445, cval_part_p_retailprice#3429 AS cval_part_p_retailprice_0#3446, cval_part_p_comment#3430 AS cval_part_p_comment_0#3447, cval_part_p_brand#3431 AS cval_part_p_brand_0#3448, cp_name#3432 AS cp_name_0#3449, cp_mfgr#3433 AS cp_mfgr_0#3450, cp_type#3434 AS cp_type_0#3451, cp_size#3435 AS cp_size_0#3452, cp_container#3436 AS cp_container_0#3453, cp_retailprice#3437 AS cp_retailprice_0#3454, cp_comment#3438 AS cp_comment_0#3455, cp_brand#3439 AS cp_brand_0#3456]
         :  :        +- Relation[rid#3423,cval_part_p_name#3424,cval_part_p_mfgr#3425,cval_part_p_type#3426,cval_part_p_size#3427,cval_part_p_container#3428,cval_part_p_retailprice#3429,cval_part_p_comment#3430,cval_part_p_brand#3431,cp_name#3432,cp_mfgr#3433,cp_type#3434,cp_size#3435,cp_container#3436,cp_retailprice#3437,cp_comment#3438,cp_brand#3439] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#3513 AS rid_1#3524, cpfk_part_partsupp#3514 AS cpfk_part_partsupp_1#3525, cfpk_partsupp_part#3515 AS cfpk_partsupp_part_1#3526, cpfk_supplier_partsupp#3516 AS cpfk_supplier_partsupp_1#3527, cfpk_partsupp_supplier#3517 AS cfpk_partsupp_supplier_1#3528, cval_partsupp_ps_availqty#3518 AS cval_partsupp_ps_availqty_1#3529, cval_partsupp_ps_supplycost#3519 AS cval_partsupp_ps_supplycost_1#3530, cval_partsupp_ps_comment#3520 AS cval_partsupp_ps_comment_1#3531, cps_availqty#3521 AS cps_availqty_1#3532, cps_supplycost#3522 AS cps_supplycost_1#3533, cps_comment#3523 AS cps_comment_1#3534]
         :     +- Relation[rid#3513,cpfk_part_partsupp#3514,cfpk_partsupp_part#3515,cpfk_supplier_partsupp#3516,cfpk_partsupp_supplier#3517,cval_partsupp_ps_availqty#3518,cval_partsupp_ps_supplycost#3519,cval_partsupp_ps_comment#3520,cps_availqty#3521,cps_supplycost#3522,cps_comment#3523] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#3457 AS rid_1#3468, cpfk_part_partsupp#3458 AS cpfk_part_partsupp_1#3469, cfpk_partsupp_part#3459 AS cfpk_partsupp_part_1#3470, cpfk_supplier_partsupp#3460 AS cpfk_supplier_partsupp_1#3471, cfpk_partsupp_supplier#3461 AS cfpk_partsupp_supplier_1#3472, cval_partsupp_ps_availqty#3462 AS cval_partsupp_ps_availqty_1#3473, cval_partsupp_ps_supplycost#3463 AS cval_partsupp_ps_supplycost_1#3474, cval_partsupp_ps_comment#3464 AS cval_partsupp_ps_comment_1#3475, cps_availqty#3465 AS cps_availqty_1#3476, cps_supplycost#3466 AS cps_supplycost_1#3477, cps_comment#3467 AS cps_comment_1#3478]
            +- Relation[rid#3457,cpfk_part_partsupp#3458,cfpk_partsupp_part#3459,cpfk_supplier_partsupp#3460,cfpk_partsupp_supplier#3461,cval_partsupp_ps_availqty#3462,cval_partsupp_ps_supplycost#3463,cval_partsupp_ps_comment#3464,cps_availqty#3465,cps_supplycost#3466,cps_comment#3467] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=7890
Elapsed time: 505ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/15 15:39:12 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:39:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3572L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:39:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3572L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#3574 AS rid_0#3589, cpfk_nation_customer#3575 AS cpfk_nation_customer_0#3590, cfpk_customer_nation#3576 AS cfpk_customer_nation_0#3591, cval_customer_c_name#3577 AS cval_customer_c_name_0#3592, cval_customer_c_address#3578 AS cval_customer_c_address_0#3593, cval_customer_c_phone#3579 AS cval_customer_c_phone_0#3594, cval_customer_c_acctbal#3580 AS cval_customer_c_acctbal_0#3595, cval_customer_c_comment#3581 AS cval_customer_c_comment_0#3596, cval_customer_c_mktsegment#3582 AS cval_customer_c_mktsegment_0#3597, cc_name#3583 AS cc_name_0#3598, cc_address#3584 AS cc_address_0#3599, cc_phone#3585 AS cc_phone_0#3600, cc_acctbal#3586 AS cc_acctbal_0#3601, cc_comment#3587 AS cc_comment_0#3602, cc_mktsegment#3588 AS cc_mktsegment_0#3603]
         :  :  :  :  +- Relation[rid#3574,cpfk_nation_customer#3575,cfpk_customer_nation#3576,cval_customer_c_name#3577,cval_customer_c_address#3578,cval_customer_c_phone#3579,cval_customer_c_acctbal#3580,cval_customer_c_comment#3581,cval_customer_c_mktsegment#3582,cc_name#3583,cc_address#3584,cc_phone#3585,cc_acctbal#3586,cc_comment#3587,cc_mktsegment#3588] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#3638 AS rid_0#3653, cpfk_nation_customer#3639 AS cpfk_nation_customer_0#3654, cfpk_customer_nation#3640 AS cfpk_customer_nation_0#3655, cval_customer_c_name#3641 AS cval_customer_c_name_0#3656, cval_customer_c_address#3642 AS cval_customer_c_address_0#3657, cval_customer_c_phone#3643 AS cval_customer_c_phone_0#3658, cval_customer_c_acctbal#3644 AS cval_customer_c_acctbal_0#3659, cval_customer_c_comment#3645 AS cval_customer_c_comment_0#3660, cval_customer_c_mktsegment#3646 AS cval_customer_c_mktsegment_0#3661, cc_name#3647 AS cc_name_0#3662, cc_address#3648 AS cc_address_0#3663, cc_phone#3649 AS cc_phone_0#3664, cc_acctbal#3650 AS cc_acctbal_0#3665, cc_comment#3651 AS cc_comment_0#3666, cc_mktsegment#3652 AS cc_mktsegment_0#3667]
         :  :  :     :  +- Relation[rid#3638,cpfk_nation_customer#3639,cfpk_customer_nation#3640,cval_customer_c_name#3641,cval_customer_c_address#3642,cval_customer_c_phone#3643,cval_customer_c_acctbal#3644,cval_customer_c_comment#3645,cval_customer_c_mktsegment#3646,cc_name#3647,cc_address#3648,cc_phone#3649,cc_acctbal#3650,cc_comment#3651,cc_mktsegment#3652] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#3668 AS rid_1#3685, cpfk_customer_orders#3669 AS cpfk_customer_orders_1#3686, cfpk_orders_customer#3670 AS cfpk_orders_customer_1#3687, cval_orders_o_orderstatus#3671 AS cval_orders_o_orderstatus_1#3688, cval_orders_o_totalprice#3672 AS cval_orders_o_totalprice_1#3689, cval_orders_o_orderpriority#3673 AS cval_orders_o_orderpriority_1#3690, cval_orders_o_clerk#3674 AS cval_orders_o_clerk_1#3691, cval_orders_o_shippriority#3675 AS cval_orders_o_shippriority_1#3692, cval_orders_o_comment#3676 AS cval_orders_o_comment_1#3693, cval_orders_o_orderdate#3677 AS cval_orders_o_orderdate_1#3694, co_orderstatus#3678 AS co_orderstatus_1#3695, co_totalprice#3679 AS co_totalprice_1#3696, co_orderpriority#3680 AS co_orderpriority_1#3697, co_clerk#3681 AS co_clerk_1#3698, co_shippriority#3682 AS co_shippriority_1#3699, co_comment#3683 AS co_comment_1#3700, co_orderdate#3684 AS co_orderdate_1#3701]
         :  :  :        +- Relation[rid#3668,cpfk_customer_orders#3669,cfpk_orders_customer#3670,cval_orders_o_orderstatus#3671,cval_orders_o_totalprice#3672,cval_orders_o_orderpriority#3673,cval_orders_o_clerk#3674,cval_orders_o_shippriority#3675,cval_orders_o_comment#3676,cval_orders_o_orderdate#3677,co_orderstatus#3678,co_totalprice#3679,co_orderpriority#3680,co_clerk#3681,co_shippriority#3682,co_comment#3683,co_orderdate#3684] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#3604 AS rid_1#3621, cpfk_customer_orders#3605 AS cpfk_customer_orders_1#3622, cfpk_orders_customer#3606 AS cfpk_orders_customer_1#3623, cval_orders_o_orderstatus#3607 AS cval_orders_o_orderstatus_1#3624, cval_orders_o_totalprice#3608 AS cval_orders_o_totalprice_1#3625, cval_orders_o_orderpriority#3609 AS cval_orders_o_orderpriority_1#3626, cval_orders_o_clerk#3610 AS cval_orders_o_clerk_1#3627, cval_orders_o_shippriority#3611 AS cval_orders_o_shippriority_1#3628, cval_orders_o_comment#3612 AS cval_orders_o_comment_1#3629, cval_orders_o_orderdate#3613 AS cval_orders_o_orderdate_1#3630, co_orderstatus#3614 AS co_orderstatus_1#3631, co_totalprice#3615 AS co_totalprice_1#3632, co_orderpriority#3616 AS co_orderpriority_1#3633, co_clerk#3617 AS co_clerk_1#3634, co_shippriority#3618 AS co_shippriority_1#3635, co_comment#3619 AS co_comment_1#3636, co_orderdate#3620 AS co_orderdate_1#3637]
         :  :     +- Relation[rid#3604,cpfk_customer_orders#3605,cfpk_orders_customer#3606,cval_orders_o_orderstatus#3607,cval_orders_o_totalprice#3608,cval_orders_o_orderpriority#3609,cval_orders_o_clerk#3610,cval_orders_o_shippriority#3611,cval_orders_o_comment#3612,cval_orders_o_orderdate#3613,co_orderstatus#3614,co_totalprice#3615,co_orderpriority#3616,co_clerk#3617,co_shippriority#3618,co_comment#3619,co_orderdate#3620] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#3768 AS rid_1#3785, cpfk_customer_orders#3769 AS cpfk_customer_orders_1#3786, cfpk_orders_customer#3770 AS cfpk_orders_customer_1#3787, cval_orders_o_orderstatus#3771 AS cval_orders_o_orderstatus_1#3788, cval_orders_o_totalprice#3772 AS cval_orders_o_totalprice_1#3789, cval_orders_o_orderpriority#3773 AS cval_orders_o_orderpriority_1#3790, cval_orders_o_clerk#3774 AS cval_orders_o_clerk_1#3791, cval_orders_o_shippriority#3775 AS cval_orders_o_shippriority_1#3792, cval_orders_o_comment#3776 AS cval_orders_o_comment_1#3793, cval_orders_o_orderdate#3777 AS cval_orders_o_orderdate_1#3794, co_orderstatus#3778 AS co_orderstatus_1#3795, co_totalprice#3779 AS co_totalprice_1#3796, co_orderpriority#3780 AS co_orderpriority_1#3797, co_clerk#3781 AS co_clerk_1#3798, co_shippriority#3782 AS co_shippriority_1#3799, co_comment#3783 AS co_comment_1#3800, co_orderdate#3784 AS co_orderdate_1#3801]
         :     :  +- Relation[rid#3768,cpfk_customer_orders#3769,cfpk_orders_customer#3770,cval_orders_o_orderstatus#3771,cval_orders_o_totalprice#3772,cval_orders_o_orderpriority#3773,cval_orders_o_clerk#3774,cval_orders_o_shippriority#3775,cval_orders_o_comment#3776,cval_orders_o_orderdate#3777,co_orderstatus#3778,co_totalprice#3779,co_orderpriority#3780,co_clerk#3781,co_shippriority#3782,co_comment#3783,co_orderdate#3784] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#3802 AS rid_2#3835, cpfk_orders_lineitem#3803 AS cpfk_orders_lineitem_2#3836, cpfk_supplier_lineitem#3804 AS cpfk_supplier_lineitem_2#3837, cfpk_lineitem_supplier#3805 AS cfpk_lineitem_supplier_2#3838, cfpk_lineitem_partsupp#3806 AS cfpk_lineitem_partsupp_2#3839, cpfk_part_lineitem#3807 AS cpfk_part_lineitem_2#3840, cfpk_lineitem_part#3808 AS cfpk_lineitem_part_2#3841, cpfk_partsupp_lineitem#3809 AS cpfk_partsupp_lineitem_2#3842, cfpk_lineitem_orders#3810 AS cfpk_lineitem_orders_2#3843, cval_lineitem_l_quantity#3811 AS cval_lineitem_l_quantity_2#3844, cval_lineitem_l_extendedprice#3812 AS cval_lineitem_l_extendedprice_2#3845, cval_lineitem_l_discount#3813 AS cval_lineitem_l_discount_2#3846, cval_lineitem_l_tax#3814 AS cval_lineitem_l_tax_2#3847, cval_lineitem_l_returnflag#3815 AS cval_lineitem_l_returnflag_2#3848, cval_lineitem_l_linestatus#3816 AS cval_lineitem_l_linestatus_2#3849, cval_lineitem_l_commitdate#3817 AS cval_lineitem_l_commitdate_2#3850, cval_lineitem_l_receiptdate#3818 AS cval_lineitem_l_receiptdate_2#3851, cval_lineitem_l_shipinstruct#3819 AS cval_lineitem_l_shipinstruct_2#3852, cval_lineitem_l_shipmode#3820 AS cval_lineitem_l_shipmode_2#3853, cval_lineitem_l_comment#3821 AS cval_lineitem_l_comment_2#3854, cval_lineitem_l_shipdate#3822 AS cval_lineitem_l_shipdate_2#3855, cl_quantity#3823 AS cl_quantity_2#3856, cl_extendedprice#3824 AS cl_extendedprice_2#3857, cl_discount#3825 AS cl_discount_2#3858, ... 9 more fields]
         :        +- Relation[rid#3802,cpfk_orders_lineitem#3803,cpfk_supplier_lineitem#3804,cfpk_lineitem_supplier#3805,cfpk_lineitem_partsupp#3806,cpfk_part_lineitem#3807,cfpk_lineitem_part#3808,cpfk_partsupp_lineitem#3809,cfpk_lineitem_orders#3810,cval_lineitem_l_quantity#3811,cval_lineitem_l_extendedprice#3812,cval_lineitem_l_discount#3813,cval_lineitem_l_tax#3814,cval_lineitem_l_returnflag#3815,cval_lineitem_l_linestatus#3816,cval_lineitem_l_commitdate#3817,cval_lineitem_l_receiptdate#3818,cval_lineitem_l_shipinstruct#3819,cval_lineitem_l_shipmode#3820,cval_lineitem_l_comment#3821,cval_lineitem_l_shipdate#3822,cl_quantity#3823,cl_extendedprice#3824,cl_discount#3825,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#3702 AS rid_2#3735, cpfk_orders_lineitem#3703 AS cpfk_orders_lineitem_2#3736, cpfk_supplier_lineitem#3704 AS cpfk_supplier_lineitem_2#3737, cfpk_lineitem_supplier#3705 AS cfpk_lineitem_supplier_2#3738, cfpk_lineitem_partsupp#3706 AS cfpk_lineitem_partsupp_2#3739, cpfk_part_lineitem#3707 AS cpfk_part_lineitem_2#3740, cfpk_lineitem_part#3708 AS cfpk_lineitem_part_2#3741, cpfk_partsupp_lineitem#3709 AS cpfk_partsupp_lineitem_2#3742, cfpk_lineitem_orders#3710 AS cfpk_lineitem_orders_2#3743, cval_lineitem_l_quantity#3711 AS cval_lineitem_l_quantity_2#3744, cval_lineitem_l_extendedprice#3712 AS cval_lineitem_l_extendedprice_2#3745, cval_lineitem_l_discount#3713 AS cval_lineitem_l_discount_2#3746, cval_lineitem_l_tax#3714 AS cval_lineitem_l_tax_2#3747, cval_lineitem_l_returnflag#3715 AS cval_lineitem_l_returnflag_2#3748, cval_lineitem_l_linestatus#3716 AS cval_lineitem_l_linestatus_2#3749, cval_lineitem_l_commitdate#3717 AS cval_lineitem_l_commitdate_2#3750, cval_lineitem_l_receiptdate#3718 AS cval_lineitem_l_receiptdate_2#3751, cval_lineitem_l_shipinstruct#3719 AS cval_lineitem_l_shipinstruct_2#3752, cval_lineitem_l_shipmode#3720 AS cval_lineitem_l_shipmode_2#3753, cval_lineitem_l_comment#3721 AS cval_lineitem_l_comment_2#3754, cval_lineitem_l_shipdate#3722 AS cval_lineitem_l_shipdate_2#3755, cl_quantity#3723 AS cl_quantity_2#3756, cl_extendedprice#3724 AS cl_extendedprice_2#3757, cl_discount#3725 AS cl_discount_2#3758, ... 9 more fields]
            +- Relation[rid#3702,cpfk_orders_lineitem#3703,cpfk_supplier_lineitem#3704,cfpk_lineitem_supplier#3705,cfpk_lineitem_partsupp#3706,cpfk_part_lineitem#3707,cfpk_lineitem_part#3708,cpfk_partsupp_lineitem#3709,cfpk_lineitem_orders#3710,cval_lineitem_l_quantity#3711,cval_lineitem_l_extendedprice#3712,cval_lineitem_l_discount#3713,cval_lineitem_l_tax#3714,cval_lineitem_l_returnflag#3715,cval_lineitem_l_linestatus#3716,cval_lineitem_l_commitdate#3717,cval_lineitem_l_receiptdate#3718,cval_lineitem_l_shipinstruct#3719,cval_lineitem_l_shipmode#3720,cval_lineitem_l_comment#3721,cval_lineitem_l_shipdate#3722,cl_quantity#3723,cl_extendedprice#3724,cl_discount#3725,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 124468ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/15 15:41:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:41:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3938L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:41:16 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:41:16 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:41:16 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:41:16 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:41:16 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:41:16 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:41:16 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:41:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3938L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#3940 AS rid_0#3957, cval_part_p_name#3941 AS cval_part_p_name_0#3958, cval_part_p_mfgr#3942 AS cval_part_p_mfgr_0#3959, cval_part_p_type#3943 AS cval_part_p_type_0#3960, cval_part_p_size#3944 AS cval_part_p_size_0#3961, cval_part_p_container#3945 AS cval_part_p_container_0#3962, cval_part_p_retailprice#3946 AS cval_part_p_retailprice_0#3963, cval_part_p_comment#3947 AS cval_part_p_comment_0#3964, cval_part_p_brand#3948 AS cval_part_p_brand_0#3965, cp_name#3949 AS cp_name_0#3966, cp_mfgr#3950 AS cp_mfgr_0#3967, cp_type#3951 AS cp_type_0#3968, cp_size#3952 AS cp_size_0#3969, cp_container#3953 AS cp_container_0#3970, cp_retailprice#3954 AS cp_retailprice_0#3971, cp_comment#3955 AS cp_comment_0#3972, cp_brand#3956 AS cp_brand_0#3973]
         :  :  :  :  +- Relation[rid#3940,cval_part_p_name#3941,cval_part_p_mfgr#3942,cval_part_p_type#3943,cval_part_p_size#3944,cval_part_p_container#3945,cval_part_p_retailprice#3946,cval_part_p_comment#3947,cval_part_p_brand#3948,cp_name#3949,cp_mfgr#3950,cp_type#3951,cp_size#3952,cp_container#3953,cp_retailprice#3954,cp_comment#3955,cp_brand#3956] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#3974 AS rid_0#3991, cval_part_p_name#3975 AS cval_part_p_name_0#3992, cval_part_p_mfgr#3976 AS cval_part_p_mfgr_0#3993, cval_part_p_type#3977 AS cval_part_p_type_0#3994, cval_part_p_size#3978 AS cval_part_p_size_0#3995, cval_part_p_container#3979 AS cval_part_p_container_0#3996, cval_part_p_retailprice#3980 AS cval_part_p_retailprice_0#3997, cval_part_p_comment#3981 AS cval_part_p_comment_0#3998, cval_part_p_brand#3982 AS cval_part_p_brand_0#3999, cp_name#3983 AS cp_name_0#4000, cp_mfgr#3984 AS cp_mfgr_0#4001, cp_type#3985 AS cp_type_0#4002, cp_size#3986 AS cp_size_0#4003, cp_container#3987 AS cp_container_0#4004, cp_retailprice#3988 AS cp_retailprice_0#4005, cp_comment#3989 AS cp_comment_0#4006, cp_brand#3990 AS cp_brand_0#4007]
         :  :  :        +- Relation[rid#3974,cval_part_p_name#3975,cval_part_p_mfgr#3976,cval_part_p_type#3977,cval_part_p_size#3978,cval_part_p_container#3979,cval_part_p_retailprice#3980,cval_part_p_comment#3981,cval_part_p_brand#3982,cp_name#3983,cp_mfgr#3984,cp_type#3985,cp_size#3986,cp_container#3987,cp_retailprice#3988,cp_comment#3989,cp_brand#3990] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#4008 AS rid_0#4025, cval_part_p_name#4009 AS cval_part_p_name_0#4026, cval_part_p_mfgr#4010 AS cval_part_p_mfgr_0#4027, cval_part_p_type#4011 AS cval_part_p_type_0#4028, cval_part_p_size#4012 AS cval_part_p_size_0#4029, cval_part_p_container#4013 AS cval_part_p_container_0#4030, cval_part_p_retailprice#4014 AS cval_part_p_retailprice_0#4031, cval_part_p_comment#4015 AS cval_part_p_comment_0#4032, cval_part_p_brand#4016 AS cval_part_p_brand_0#4033, cp_name#4017 AS cp_name_0#4034, cp_mfgr#4018 AS cp_mfgr_0#4035, cp_type#4019 AS cp_type_0#4036, cp_size#4020 AS cp_size_0#4037, cp_container#4021 AS cp_container_0#4038, cp_retailprice#4022 AS cp_retailprice_0#4039, cp_comment#4023 AS cp_comment_0#4040, cp_brand#4024 AS cp_brand_0#4041]
         :  :        +- Relation[rid#4008,cval_part_p_name#4009,cval_part_p_mfgr#4010,cval_part_p_type#4011,cval_part_p_size#4012,cval_part_p_container#4013,cval_part_p_retailprice#4014,cval_part_p_comment#4015,cval_part_p_brand#4016,cp_name#4017,cp_mfgr#4018,cp_type#4019,cp_size#4020,cp_container#4021,cp_retailprice#4022,cp_comment#4023,cp_brand#4024] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#4274 AS rid_1#4307, cpfk_orders_lineitem#4275 AS cpfk_orders_lineitem_1#4308, cpfk_supplier_lineitem#4276 AS cpfk_supplier_lineitem_1#4309, cfpk_lineitem_supplier#4277 AS cfpk_lineitem_supplier_1#4310, cfpk_lineitem_partsupp#4278 AS cfpk_lineitem_partsupp_1#4311, cpfk_part_lineitem#4279 AS cpfk_part_lineitem_1#4312, cfpk_lineitem_part#4280 AS cfpk_lineitem_part_1#4313, cpfk_partsupp_lineitem#4281 AS cpfk_partsupp_lineitem_1#4314, cfpk_lineitem_orders#4282 AS cfpk_lineitem_orders_1#4315, cval_lineitem_l_quantity#4283 AS cval_lineitem_l_quantity_1#4316, cval_lineitem_l_extendedprice#4284 AS cval_lineitem_l_extendedprice_1#4317, cval_lineitem_l_discount#4285 AS cval_lineitem_l_discount_1#4318, cval_lineitem_l_tax#4286 AS cval_lineitem_l_tax_1#4319, cval_lineitem_l_returnflag#4287 AS cval_lineitem_l_returnflag_1#4320, cval_lineitem_l_linestatus#4288 AS cval_lineitem_l_linestatus_1#4321, cval_lineitem_l_commitdate#4289 AS cval_lineitem_l_commitdate_1#4322, cval_lineitem_l_receiptdate#4290 AS cval_lineitem_l_receiptdate_1#4323, cval_lineitem_l_shipinstruct#4291 AS cval_lineitem_l_shipinstruct_1#4324, cval_lineitem_l_shipmode#4292 AS cval_lineitem_l_shipmode_1#4325, cval_lineitem_l_comment#4293 AS cval_lineitem_l_comment_1#4326, cval_lineitem_l_shipdate#4294 AS cval_lineitem_l_shipdate_1#4327, cl_quantity#4295 AS cl_quantity_1#4328, cl_extendedprice#4296 AS cl_extendedprice_1#4329, cl_discount#4297 AS cl_discount_1#4330, ... 9 more fields]
         :     +- Relation[rid#4274,cpfk_orders_lineitem#4275,cpfk_supplier_lineitem#4276,cfpk_lineitem_supplier#4277,cfpk_lineitem_partsupp#4278,cpfk_part_lineitem#4279,cfpk_lineitem_part#4280,cpfk_partsupp_lineitem#4281,cfpk_lineitem_orders#4282,cval_lineitem_l_quantity#4283,cval_lineitem_l_extendedprice#4284,cval_lineitem_l_discount#4285,cval_lineitem_l_tax#4286,cval_lineitem_l_returnflag#4287,cval_lineitem_l_linestatus#4288,cval_lineitem_l_commitdate#4289,cval_lineitem_l_receiptdate#4290,cval_lineitem_l_shipinstruct#4291,cval_lineitem_l_shipmode#4292,cval_lineitem_l_comment#4293,cval_lineitem_l_shipdate#4294,cl_quantity#4295,cl_extendedprice#4296,cl_discount#4297,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#4042 AS rid_1#4075, cpfk_orders_lineitem#4043 AS cpfk_orders_lineitem_1#4076, cpfk_supplier_lineitem#4044 AS cpfk_supplier_lineitem_1#4077, cfpk_lineitem_supplier#4045 AS cfpk_lineitem_supplier_1#4078, cfpk_lineitem_partsupp#4046 AS cfpk_lineitem_partsupp_1#4079, cpfk_part_lineitem#4047 AS cpfk_part_lineitem_1#4080, cfpk_lineitem_part#4048 AS cfpk_lineitem_part_1#4081, cpfk_partsupp_lineitem#4049 AS cpfk_partsupp_lineitem_1#4082, cfpk_lineitem_orders#4050 AS cfpk_lineitem_orders_1#4083, cval_lineitem_l_quantity#4051 AS cval_lineitem_l_quantity_1#4084, cval_lineitem_l_extendedprice#4052 AS cval_lineitem_l_extendedprice_1#4085, cval_lineitem_l_discount#4053 AS cval_lineitem_l_discount_1#4086, cval_lineitem_l_tax#4054 AS cval_lineitem_l_tax_1#4087, cval_lineitem_l_returnflag#4055 AS cval_lineitem_l_returnflag_1#4088, cval_lineitem_l_linestatus#4056 AS cval_lineitem_l_linestatus_1#4089, cval_lineitem_l_commitdate#4057 AS cval_lineitem_l_commitdate_1#4090, cval_lineitem_l_receiptdate#4058 AS cval_lineitem_l_receiptdate_1#4091, cval_lineitem_l_shipinstruct#4059 AS cval_lineitem_l_shipinstruct_1#4092, cval_lineitem_l_shipmode#4060 AS cval_lineitem_l_shipmode_1#4093, cval_lineitem_l_comment#4061 AS cval_lineitem_l_comment_1#4094, cval_lineitem_l_shipdate#4062 AS cval_lineitem_l_shipdate_1#4095, cl_quantity#4063 AS cl_quantity_1#4096, cl_extendedprice#4064 AS cl_extendedprice_1#4097, cl_discount#4065 AS cl_discount_1#4098, ... 9 more fields]
            :  :  +- Relation[rid#4042,cpfk_orders_lineitem#4043,cpfk_supplier_lineitem#4044,cfpk_lineitem_supplier#4045,cfpk_lineitem_partsupp#4046,cpfk_part_lineitem#4047,cfpk_lineitem_part#4048,cpfk_partsupp_lineitem#4049,cfpk_lineitem_orders#4050,cval_lineitem_l_quantity#4051,cval_lineitem_l_extendedprice#4052,cval_lineitem_l_discount#4053,cval_lineitem_l_tax#4054,cval_lineitem_l_returnflag#4055,cval_lineitem_l_linestatus#4056,cval_lineitem_l_commitdate#4057,cval_lineitem_l_receiptdate#4058,cval_lineitem_l_shipinstruct#4059,cval_lineitem_l_shipmode#4060,cval_lineitem_l_comment#4061,cval_lineitem_l_shipdate#4062,cl_quantity#4063,cl_extendedprice#4064,cl_discount#4065,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#4108 AS rid_1#4141, cpfk_orders_lineitem#4109 AS cpfk_orders_lineitem_1#4142, cpfk_supplier_lineitem#4110 AS cpfk_supplier_lineitem_1#4143, cfpk_lineitem_supplier#4111 AS cfpk_lineitem_supplier_1#4144, cfpk_lineitem_partsupp#4112 AS cfpk_lineitem_partsupp_1#4145, cpfk_part_lineitem#4113 AS cpfk_part_lineitem_1#4146, cfpk_lineitem_part#4114 AS cfpk_lineitem_part_1#4147, cpfk_partsupp_lineitem#4115 AS cpfk_partsupp_lineitem_1#4148, cfpk_lineitem_orders#4116 AS cfpk_lineitem_orders_1#4149, cval_lineitem_l_quantity#4117 AS cval_lineitem_l_quantity_1#4150, cval_lineitem_l_extendedprice#4118 AS cval_lineitem_l_extendedprice_1#4151, cval_lineitem_l_discount#4119 AS cval_lineitem_l_discount_1#4152, cval_lineitem_l_tax#4120 AS cval_lineitem_l_tax_1#4153, cval_lineitem_l_returnflag#4121 AS cval_lineitem_l_returnflag_1#4154, cval_lineitem_l_linestatus#4122 AS cval_lineitem_l_linestatus_1#4155, cval_lineitem_l_commitdate#4123 AS cval_lineitem_l_commitdate_1#4156, cval_lineitem_l_receiptdate#4124 AS cval_lineitem_l_receiptdate_1#4157, cval_lineitem_l_shipinstruct#4125 AS cval_lineitem_l_shipinstruct_1#4158, cval_lineitem_l_shipmode#4126 AS cval_lineitem_l_shipmode_1#4159, cval_lineitem_l_comment#4127 AS cval_lineitem_l_comment_1#4160, cval_lineitem_l_shipdate#4128 AS cval_lineitem_l_shipdate_1#4161, cl_quantity#4129 AS cl_quantity_1#4162, cl_extendedprice#4130 AS cl_extendedprice_1#4163, cl_discount#4131 AS cl_discount_1#4164, ... 9 more fields]
            :        +- Relation[rid#4108,cpfk_orders_lineitem#4109,cpfk_supplier_lineitem#4110,cfpk_lineitem_supplier#4111,cfpk_lineitem_partsupp#4112,cpfk_part_lineitem#4113,cfpk_lineitem_part#4114,cpfk_partsupp_lineitem#4115,cfpk_lineitem_orders#4116,cval_lineitem_l_quantity#4117,cval_lineitem_l_extendedprice#4118,cval_lineitem_l_discount#4119,cval_lineitem_l_tax#4120,cval_lineitem_l_returnflag#4121,cval_lineitem_l_linestatus#4122,cval_lineitem_l_commitdate#4123,cval_lineitem_l_receiptdate#4124,cval_lineitem_l_shipinstruct#4125,cval_lineitem_l_shipmode#4126,cval_lineitem_l_comment#4127,cval_lineitem_l_shipdate#4128,cl_quantity#4129,cl_extendedprice#4130,cl_discount#4131,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#4174 AS rid_1#4207, cpfk_orders_lineitem#4175 AS cpfk_orders_lineitem_1#4208, cpfk_supplier_lineitem#4176 AS cpfk_supplier_lineitem_1#4209, cfpk_lineitem_supplier#4177 AS cfpk_lineitem_supplier_1#4210, cfpk_lineitem_partsupp#4178 AS cfpk_lineitem_partsupp_1#4211, cpfk_part_lineitem#4179 AS cpfk_part_lineitem_1#4212, cfpk_lineitem_part#4180 AS cfpk_lineitem_part_1#4213, cpfk_partsupp_lineitem#4181 AS cpfk_partsupp_lineitem_1#4214, cfpk_lineitem_orders#4182 AS cfpk_lineitem_orders_1#4215, cval_lineitem_l_quantity#4183 AS cval_lineitem_l_quantity_1#4216, cval_lineitem_l_extendedprice#4184 AS cval_lineitem_l_extendedprice_1#4217, cval_lineitem_l_discount#4185 AS cval_lineitem_l_discount_1#4218, cval_lineitem_l_tax#4186 AS cval_lineitem_l_tax_1#4219, cval_lineitem_l_returnflag#4187 AS cval_lineitem_l_returnflag_1#4220, cval_lineitem_l_linestatus#4188 AS cval_lineitem_l_linestatus_1#4221, cval_lineitem_l_commitdate#4189 AS cval_lineitem_l_commitdate_1#4222, cval_lineitem_l_receiptdate#4190 AS cval_lineitem_l_receiptdate_1#4223, cval_lineitem_l_shipinstruct#4191 AS cval_lineitem_l_shipinstruct_1#4224, cval_lineitem_l_shipmode#4192 AS cval_lineitem_l_shipmode_1#4225, cval_lineitem_l_comment#4193 AS cval_lineitem_l_comment_1#4226, cval_lineitem_l_shipdate#4194 AS cval_lineitem_l_shipdate_1#4227, cl_quantity#4195 AS cl_quantity_1#4228, cl_extendedprice#4196 AS cl_extendedprice_1#4229, cl_discount#4197 AS cl_discount_1#4230, ... 9 more fields]
                  +- Relation[rid#4174,cpfk_orders_lineitem#4175,cpfk_supplier_lineitem#4176,cfpk_lineitem_supplier#4177,cfpk_lineitem_partsupp#4178,cpfk_part_lineitem#4179,cfpk_lineitem_part#4180,cpfk_partsupp_lineitem#4181,cfpk_lineitem_orders#4182,cval_lineitem_l_quantity#4183,cval_lineitem_l_extendedprice#4184,cval_lineitem_l_discount#4185,cval_lineitem_l_tax#4186,cval_lineitem_l_returnflag#4187,cval_lineitem_l_linestatus#4188,cval_lineitem_l_commitdate#4189,cval_lineitem_l_receiptdate#4190,cval_lineitem_l_shipinstruct#4191,cval_lineitem_l_shipmode#4192,cval_lineitem_l_comment#4193,cval_lineitem_l_shipdate#4194,cl_quantity#4195,cl_extendedprice#4196,cl_discount#4197,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=13
Elapsed time: 63663ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/15 15:42:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:42:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4398L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:42:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4398L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#4400 AS rid_0#4407, cpfk_region_nation#4401 AS cpfk_region_nation_0#4408, cfpk_nation_region#4402 AS cfpk_nation_region_0#4409, cval_nation_n_name#4403 AS cval_nation_n_name_0#4410, cval_nation_n_comment#4404 AS cval_nation_n_comment_0#4411, cn_name#4405 AS cn_name_0#4412, cn_comment#4406 AS cn_comment_0#4413]
            :  :  :  :  :  :  +- Relation[rid#4400,cpfk_region_nation#4401,cfpk_nation_region#4402,cval_nation_n_name#4403,cval_nation_n_comment#4404,cn_name#4405,cn_comment#4406] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#4414 AS rid_0#4421, cpfk_region_nation#4415 AS cpfk_region_nation_0#4422, cfpk_nation_region#4416 AS cfpk_nation_region_0#4423, cval_nation_n_name#4417 AS cval_nation_n_name_0#4424, cval_nation_n_comment#4418 AS cval_nation_n_comment_0#4425, cn_name#4419 AS cn_name_0#4426, cn_comment#4420 AS cn_comment_0#4427]
            :  :  :  :  :        +- Relation[rid#4414,cpfk_region_nation#4415,cfpk_nation_region#4416,cval_nation_n_name#4417,cval_nation_n_comment#4418,cn_name#4419,cn_comment#4420] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- Project [rid#4468 AS rid_1#4481, cpfk_nation_supplier#4469 AS cpfk_nation_supplier_1#4482, cfpk_supplier_nation#4470 AS cfpk_supplier_nation_1#4483, cval_supplier_s_name#4471 AS cval_supplier_s_name_1#4484, cval_supplier_s_address#4472 AS cval_supplier_s_address_1#4485, cval_supplier_s_phone#4473 AS cval_supplier_s_phone_1#4486, cval_supplier_s_acctbal#4474 AS cval_supplier_s_acctbal_1#4487, cval_supplier_s_comment#4475 AS cval_supplier_s_comment_1#4488, cs_name#4476 AS cs_name_1#4489, cs_address#4477 AS cs_address_1#4490, cs_phone#4478 AS cs_phone_1#4491, cs_acctbal#4479 AS cs_acctbal_1#4492, cs_comment#4480 AS cs_comment_1#4493]
            :  :  :  :     +- Relation[rid#4468,cpfk_nation_supplier#4469,cfpk_supplier_nation#4470,cval_supplier_s_name#4471,cval_supplier_s_address#4472,cval_supplier_s_phone#4473,cval_supplier_s_acctbal#4474,cval_supplier_s_comment#4475,cs_name#4476,cs_address#4477,cs_phone#4478,cs_acctbal#4479,cs_comment#4480] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#4428 AS rid_1#4441, cpfk_nation_supplier#4429 AS cpfk_nation_supplier_1#4442, cfpk_supplier_nation#4430 AS cfpk_supplier_nation_1#4443, cval_supplier_s_name#4431 AS cval_supplier_s_name_1#4444, cval_supplier_s_address#4432 AS cval_supplier_s_address_1#4445, cval_supplier_s_phone#4433 AS cval_supplier_s_phone_1#4446, cval_supplier_s_acctbal#4434 AS cval_supplier_s_acctbal_1#4447, cval_supplier_s_comment#4435 AS cval_supplier_s_comment_1#4448, cs_name#4436 AS cs_name_1#4449, cs_address#4437 AS cs_address_1#4450, cs_phone#4438 AS cs_phone_1#4451, cs_acctbal#4439 AS cs_acctbal_1#4452, cs_comment#4440 AS cs_comment_1#4453]
            :  :  :     +- Relation[rid#4428,cpfk_nation_supplier#4429,cfpk_supplier_nation#4430,cval_supplier_s_name#4431,cval_supplier_s_address#4432,cval_supplier_s_phone#4433,cval_supplier_s_acctbal#4434,cval_supplier_s_comment#4435,cs_name#4436,cs_address#4437,cs_phone#4438,cs_acctbal#4439,cs_comment#4440] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- Project [rid#4586 AS rid_2#4619, cpfk_orders_lineitem#4587 AS cpfk_orders_lineitem_2#4620, cpfk_supplier_lineitem#4588 AS cpfk_supplier_lineitem_2#4621, cfpk_lineitem_supplier#4589 AS cfpk_lineitem_supplier_2#4622, cfpk_lineitem_partsupp#4590 AS cfpk_lineitem_partsupp_2#4623, cpfk_part_lineitem#4591 AS cpfk_part_lineitem_2#4624, cfpk_lineitem_part#4592 AS cfpk_lineitem_part_2#4625, cpfk_partsupp_lineitem#4593 AS cpfk_partsupp_lineitem_2#4626, cfpk_lineitem_orders#4594 AS cfpk_lineitem_orders_2#4627, cval_lineitem_l_quantity#4595 AS cval_lineitem_l_quantity_2#4628, cval_lineitem_l_extendedprice#4596 AS cval_lineitem_l_extendedprice_2#4629, cval_lineitem_l_discount#4597 AS cval_lineitem_l_discount_2#4630, cval_lineitem_l_tax#4598 AS cval_lineitem_l_tax_2#4631, cval_lineitem_l_returnflag#4599 AS cval_lineitem_l_returnflag_2#4632, cval_lineitem_l_linestatus#4600 AS cval_lineitem_l_linestatus_2#4633, cval_lineitem_l_commitdate#4601 AS cval_lineitem_l_commitdate_2#4634, cval_lineitem_l_receiptdate#4602 AS cval_lineitem_l_receiptdate_2#4635, cval_lineitem_l_shipinstruct#4603 AS cval_lineitem_l_shipinstruct_2#4636, cval_lineitem_l_shipmode#4604 AS cval_lineitem_l_shipmode_2#4637, cval_lineitem_l_comment#4605 AS cval_lineitem_l_comment_2#4638, cval_lineitem_l_shipdate#4606 AS cval_lineitem_l_shipdate_2#4639, cl_quantity#4607 AS cl_quantity_2#4640, cl_extendedprice#4608 AS cl_extendedprice_2#4641, cl_discount#4609 AS cl_discount_2#4642, ... 9 more fields]
            :  :     +- Relation[rid#4586,cpfk_orders_lineitem#4587,cpfk_supplier_lineitem#4588,cfpk_lineitem_supplier#4589,cfpk_lineitem_partsupp#4590,cpfk_part_lineitem#4591,cfpk_lineitem_part#4592,cpfk_partsupp_lineitem#4593,cfpk_lineitem_orders#4594,cval_lineitem_l_quantity#4595,cval_lineitem_l_extendedprice#4596,cval_lineitem_l_discount#4597,cval_lineitem_l_tax#4598,cval_lineitem_l_returnflag#4599,cval_lineitem_l_linestatus#4600,cval_lineitem_l_commitdate#4601,cval_lineitem_l_receiptdate#4602,cval_lineitem_l_shipinstruct#4603,cval_lineitem_l_shipmode#4604,cval_lineitem_l_comment#4605,cval_lineitem_l_shipdate#4606,cl_quantity#4607,cl_extendedprice#4608,cl_discount#4609,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#4494 AS rid_2#4527, cpfk_orders_lineitem#4495 AS cpfk_orders_lineitem_2#4528, cpfk_supplier_lineitem#4496 AS cpfk_supplier_lineitem_2#4529, cfpk_lineitem_supplier#4497 AS cfpk_lineitem_supplier_2#4530, cfpk_lineitem_partsupp#4498 AS cfpk_lineitem_partsupp_2#4531, cpfk_part_lineitem#4499 AS cpfk_part_lineitem_2#4532, cfpk_lineitem_part#4500 AS cfpk_lineitem_part_2#4533, cpfk_partsupp_lineitem#4501 AS cpfk_partsupp_lineitem_2#4534, cfpk_lineitem_orders#4502 AS cfpk_lineitem_orders_2#4535, cval_lineitem_l_quantity#4503 AS cval_lineitem_l_quantity_2#4536, cval_lineitem_l_extendedprice#4504 AS cval_lineitem_l_extendedprice_2#4537, cval_lineitem_l_discount#4505 AS cval_lineitem_l_discount_2#4538, cval_lineitem_l_tax#4506 AS cval_lineitem_l_tax_2#4539, cval_lineitem_l_returnflag#4507 AS cval_lineitem_l_returnflag_2#4540, cval_lineitem_l_linestatus#4508 AS cval_lineitem_l_linestatus_2#4541, cval_lineitem_l_commitdate#4509 AS cval_lineitem_l_commitdate_2#4542, cval_lineitem_l_receiptdate#4510 AS cval_lineitem_l_receiptdate_2#4543, cval_lineitem_l_shipinstruct#4511 AS cval_lineitem_l_shipinstruct_2#4544, cval_lineitem_l_shipmode#4512 AS cval_lineitem_l_shipmode_2#4545, cval_lineitem_l_comment#4513 AS cval_lineitem_l_comment_2#4546, cval_lineitem_l_shipdate#4514 AS cval_lineitem_l_shipdate_2#4547, cl_quantity#4515 AS cl_quantity_2#4548, cl_extendedprice#4516 AS cl_extendedprice_2#4549, cl_discount#4517 AS cl_discount_2#4550, ... 9 more fields]
            :     +- Relation[rid#4494,cpfk_orders_lineitem#4495,cpfk_supplier_lineitem#4496,cfpk_lineitem_supplier#4497,cfpk_lineitem_partsupp#4498,cpfk_part_lineitem#4499,cfpk_lineitem_part#4500,cpfk_partsupp_lineitem#4501,cfpk_lineitem_orders#4502,cval_lineitem_l_quantity#4503,cval_lineitem_l_extendedprice#4504,cval_lineitem_l_discount#4505,cval_lineitem_l_tax#4506,cval_lineitem_l_returnflag#4507,cval_lineitem_l_linestatus#4508,cval_lineitem_l_commitdate#4509,cval_lineitem_l_receiptdate#4510,cval_lineitem_l_shipinstruct#4511,cval_lineitem_l_shipmode#4512,cval_lineitem_l_comment#4513,cval_lineitem_l_shipdate#4514,cl_quantity#4515,cl_extendedprice#4516,cl_discount#4517,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#4652 AS rid_3#4659, cpfk_region_nation#4653 AS cpfk_region_nation_3#4660, cfpk_nation_region#4654 AS cfpk_nation_region_3#4661, cval_nation_n_name#4655 AS cval_nation_n_name_3#4662, cval_nation_n_comment#4656 AS cval_nation_n_comment_3#4663, cn_name#4657 AS cn_name_3#4664, cn_comment#4658 AS cn_comment_3#4665]
               :  :  :  :  :  +- Relation[rid#4652,cpfk_region_nation#4653,cfpk_nation_region#4654,cval_nation_n_name#4655,cval_nation_n_comment#4656,cn_name#4657,cn_comment#4658] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#4666 AS rid_3#4673, cpfk_region_nation#4667 AS cpfk_region_nation_3#4674, cfpk_nation_region#4668 AS cfpk_nation_region_3#4675, cval_nation_n_name#4669 AS cval_nation_n_name_3#4676, cval_nation_n_comment#4670 AS cval_nation_n_comment_3#4677, cn_name#4671 AS cn_name_3#4678, cn_comment#4672 AS cn_comment_3#4679]
               :  :  :  :        +- Relation[rid#4666,cpfk_region_nation#4667,cfpk_nation_region#4668,cval_nation_n_name#4669,cval_nation_n_comment#4670,cn_name#4671,cn_comment#4672] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#4724 AS rid_4#4739, cpfk_nation_customer#4725 AS cpfk_nation_customer_4#4740, cfpk_customer_nation#4726 AS cfpk_customer_nation_4#4741, cval_customer_c_name#4727 AS cval_customer_c_name_4#4742, cval_customer_c_address#4728 AS cval_customer_c_address_4#4743, cval_customer_c_phone#4729 AS cval_customer_c_phone_4#4744, cval_customer_c_acctbal#4730 AS cval_customer_c_acctbal_4#4745, cval_customer_c_comment#4731 AS cval_customer_c_comment_4#4746, cval_customer_c_mktsegment#4732 AS cval_customer_c_mktsegment_4#4747, cc_name#4733 AS cc_name_4#4748, cc_address#4734 AS cc_address_4#4749, cc_phone#4735 AS cc_phone_4#4750, cc_acctbal#4736 AS cc_acctbal_4#4751, cc_comment#4737 AS cc_comment_4#4752, cc_mktsegment#4738 AS cc_mktsegment_4#4753]
               :  :  :     +- Relation[rid#4724,cpfk_nation_customer#4725,cfpk_customer_nation#4726,cval_customer_c_name#4727,cval_customer_c_address#4728,cval_customer_c_phone#4729,cval_customer_c_acctbal#4730,cval_customer_c_comment#4731,cval_customer_c_mktsegment#4732,cc_name#4733,cc_address#4734,cc_phone#4735,cc_acctbal#4736,cc_comment#4737,cc_mktsegment#4738] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#4680 AS rid_4#4695, cpfk_nation_customer#4681 AS cpfk_nation_customer_4#4696, cfpk_customer_nation#4682 AS cfpk_customer_nation_4#4697, cval_customer_c_name#4683 AS cval_customer_c_name_4#4698, cval_customer_c_address#4684 AS cval_customer_c_address_4#4699, cval_customer_c_phone#4685 AS cval_customer_c_phone_4#4700, cval_customer_c_acctbal#4686 AS cval_customer_c_acctbal_4#4701, cval_customer_c_comment#4687 AS cval_customer_c_comment_4#4702, cval_customer_c_mktsegment#4688 AS cval_customer_c_mktsegment_4#4703, cc_name#4689 AS cc_name_4#4704, cc_address#4690 AS cc_address_4#4705, cc_phone#4691 AS cc_phone_4#4706, cc_acctbal#4692 AS cc_acctbal_4#4707, cc_comment#4693 AS cc_comment_4#4708, cc_mktsegment#4694 AS cc_mktsegment_4#4709]
               :  :     +- Relation[rid#4680,cpfk_nation_customer#4681,cfpk_customer_nation#4682,cval_customer_c_name#4683,cval_customer_c_address#4684,cval_customer_c_phone#4685,cval_customer_c_acctbal#4686,cval_customer_c_comment#4687,cval_customer_c_mktsegment#4688,cc_name#4689,cc_address#4690,cc_phone#4691,cc_acctbal#4692,cc_comment#4693,cc_mktsegment#4694] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#4818 AS rid_5#4835, cpfk_customer_orders#4819 AS cpfk_customer_orders_5#4836, cfpk_orders_customer#4820 AS cfpk_orders_customer_5#4837, cval_orders_o_orderstatus#4821 AS cval_orders_o_orderstatus_5#4838, cval_orders_o_totalprice#4822 AS cval_orders_o_totalprice_5#4839, cval_orders_o_orderpriority#4823 AS cval_orders_o_orderpriority_5#4840, cval_orders_o_clerk#4824 AS cval_orders_o_clerk_5#4841, cval_orders_o_shippriority#4825 AS cval_orders_o_shippriority_5#4842, cval_orders_o_comment#4826 AS cval_orders_o_comment_5#4843, cval_orders_o_orderdate#4827 AS cval_orders_o_orderdate_5#4844, co_orderstatus#4828 AS co_orderstatus_5#4845, co_totalprice#4829 AS co_totalprice_5#4846, co_orderpriority#4830 AS co_orderpriority_5#4847, co_clerk#4831 AS co_clerk_5#4848, co_shippriority#4832 AS co_shippriority_5#4849, co_comment#4833 AS co_comment_5#4850, co_orderdate#4834 AS co_orderdate_5#4851]
               :     +- Relation[rid#4818,cpfk_customer_orders#4819,cfpk_orders_customer#4820,cval_orders_o_orderstatus#4821,cval_orders_o_totalprice#4822,cval_orders_o_orderpriority#4823,cval_orders_o_clerk#4824,cval_orders_o_shippriority#4825,cval_orders_o_comment#4826,cval_orders_o_orderdate#4827,co_orderstatus#4828,co_totalprice#4829,co_orderpriority#4830,co_clerk#4831,co_shippriority#4832,co_comment#4833,co_orderdate#4834] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#4754 AS rid_5#4771, cpfk_customer_orders#4755 AS cpfk_customer_orders_5#4772, cfpk_orders_customer#4756 AS cfpk_orders_customer_5#4773, cval_orders_o_orderstatus#4757 AS cval_orders_o_orderstatus_5#4774, cval_orders_o_totalprice#4758 AS cval_orders_o_totalprice_5#4775, cval_orders_o_orderpriority#4759 AS cval_orders_o_orderpriority_5#4776, cval_orders_o_clerk#4760 AS cval_orders_o_clerk_5#4777, cval_orders_o_shippriority#4761 AS cval_orders_o_shippriority_5#4778, cval_orders_o_comment#4762 AS cval_orders_o_comment_5#4779, cval_orders_o_orderdate#4763 AS cval_orders_o_orderdate_5#4780, co_orderstatus#4764 AS co_orderstatus_5#4781, co_totalprice#4765 AS co_totalprice_5#4782, co_orderpriority#4766 AS co_orderpriority_5#4783, co_clerk#4767 AS co_clerk_5#4784, co_shippriority#4768 AS co_shippriority_5#4785, co_comment#4769 AS co_comment_5#4786, co_orderdate#4770 AS co_orderdate_5#4787]
                  +- Relation[rid#4754,cpfk_customer_orders#4755,cfpk_orders_customer#4756,cval_orders_o_orderstatus#4757,cval_orders_o_totalprice#4758,cval_orders_o_orderpriority#4759,cval_orders_o_clerk#4760,cval_orders_o_shippriority#4761,cval_orders_o_comment#4762,cval_orders_o_orderdate#4763,co_orderstatus#4764,co_totalprice#4765,co_orderpriority#4766,co_clerk#4767,co_shippriority#4768,co_comment#4769,co_orderdate#4770] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 347ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/15 15:42:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:42:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4952L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 15:42:20 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 15:42:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4952L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#4954 AS rid_0#4969, cpfk_nation_customer#4955 AS cpfk_nation_customer_0#4970, cfpk_customer_nation#4956 AS cfpk_customer_nation_0#4971, cval_customer_c_name#4957 AS cval_customer_c_name_0#4972, cval_customer_c_address#4958 AS cval_customer_c_address_0#4973, cval_customer_c_phone#4959 AS cval_customer_c_phone_0#4974, cval_customer_c_acctbal#4960 AS cval_customer_c_acctbal_0#4975, cval_customer_c_comment#4961 AS cval_customer_c_comment_0#4976, cval_customer_c_mktsegment#4962 AS cval_customer_c_mktsegment_0#4977, cc_name#4963 AS cc_name_0#4978, cc_address#4964 AS cc_address_0#4979, cc_phone#4965 AS cc_phone_0#4980, cc_acctbal#4966 AS cc_acctbal_0#4981, cc_comment#4967 AS cc_comment_0#4982, cc_mktsegment#4968 AS cc_mktsegment_0#4983]
         :  :  :  :  :  +- Relation[rid#4954,cpfk_nation_customer#4955,cfpk_customer_nation#4956,cval_customer_c_name#4957,cval_customer_c_address#4958,cval_customer_c_phone#4959,cval_customer_c_acctbal#4960,cval_customer_c_comment#4961,cval_customer_c_mktsegment#4962,cc_name#4963,cc_address#4964,cc_phone#4965,cc_acctbal#4966,cc_comment#4967,cc_mktsegment#4968] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#4984 AS rid_0#4999, cpfk_nation_customer#4985 AS cpfk_nation_customer_0#5000, cfpk_customer_nation#4986 AS cfpk_customer_nation_0#5001, cval_customer_c_name#4987 AS cval_customer_c_name_0#5002, cval_customer_c_address#4988 AS cval_customer_c_address_0#5003, cval_customer_c_phone#4989 AS cval_customer_c_phone_0#5004, cval_customer_c_acctbal#4990 AS cval_customer_c_acctbal_0#5005, cval_customer_c_comment#4991 AS cval_customer_c_comment_0#5006, cval_customer_c_mktsegment#4992 AS cval_customer_c_mktsegment_0#5007, cc_name#4993 AS cc_name_0#5008, cc_address#4994 AS cc_address_0#5009, cc_phone#4995 AS cc_phone_0#5010, cc_acctbal#4996 AS cc_acctbal_0#5011, cc_comment#4997 AS cc_comment_0#5012, cc_mktsegment#4998 AS cc_mktsegment_0#5013]
         :  :  :  :        +- Relation[rid#4984,cpfk_nation_customer#4985,cfpk_customer_nation#4986,cval_customer_c_name#4987,cval_customer_c_address#4988,cval_customer_c_phone#4989,cval_customer_c_acctbal#4990,cval_customer_c_comment#4991,cval_customer_c_mktsegment#4992,cc_name#4993,cc_address#4994,cc_phone#4995,cc_acctbal#4996,cc_comment#4997,cc_mktsegment#4998] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- Project [rid#5078 AS rid_1#5095, cpfk_customer_orders#5079 AS cpfk_customer_orders_1#5096, cfpk_orders_customer#5080 AS cfpk_orders_customer_1#5097, cval_orders_o_orderstatus#5081 AS cval_orders_o_orderstatus_1#5098, cval_orders_o_totalprice#5082 AS cval_orders_o_totalprice_1#5099, cval_orders_o_orderpriority#5083 AS cval_orders_o_orderpriority_1#5100, cval_orders_o_clerk#5084 AS cval_orders_o_clerk_1#5101, cval_orders_o_shippriority#5085 AS cval_orders_o_shippriority_1#5102, cval_orders_o_comment#5086 AS cval_orders_o_comment_1#5103, cval_orders_o_orderdate#5087 AS cval_orders_o_orderdate_1#5104, co_orderstatus#5088 AS co_orderstatus_1#5105, co_totalprice#5089 AS co_totalprice_1#5106, co_orderpriority#5090 AS co_orderpriority_1#5107, co_clerk#5091 AS co_clerk_1#5108, co_shippriority#5092 AS co_shippriority_1#5109, co_comment#5093 AS co_comment_1#5110, co_orderdate#5094 AS co_orderdate_1#5111]
         :  :  :     +- Relation[rid#5078,cpfk_customer_orders#5079,cfpk_orders_customer#5080,cval_orders_o_orderstatus#5081,cval_orders_o_totalprice#5082,cval_orders_o_orderpriority#5083,cval_orders_o_clerk#5084,cval_orders_o_shippriority#5085,cval_orders_o_comment#5086,cval_orders_o_orderdate#5087,co_orderstatus#5088,co_totalprice#5089,co_orderpriority#5090,co_clerk#5091,co_shippriority#5092,co_comment#5093,co_orderdate#5094] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#5014 AS rid_1#5031, cpfk_customer_orders#5015 AS cpfk_customer_orders_1#5032, cfpk_orders_customer#5016 AS cfpk_orders_customer_1#5033, cval_orders_o_orderstatus#5017 AS cval_orders_o_orderstatus_1#5034, cval_orders_o_totalprice#5018 AS cval_orders_o_totalprice_1#5035, cval_orders_o_orderpriority#5019 AS cval_orders_o_orderpriority_1#5036, cval_orders_o_clerk#5020 AS cval_orders_o_clerk_1#5037, cval_orders_o_shippriority#5021 AS cval_orders_o_shippriority_1#5038, cval_orders_o_comment#5022 AS cval_orders_o_comment_1#5039, cval_orders_o_orderdate#5023 AS cval_orders_o_orderdate_1#5040, co_orderstatus#5024 AS co_orderstatus_1#5041, co_totalprice#5025 AS co_totalprice_1#5042, co_orderpriority#5026 AS co_orderpriority_1#5043, co_clerk#5027 AS co_clerk_1#5044, co_shippriority#5028 AS co_shippriority_1#5045, co_comment#5029 AS co_comment_1#5046, co_orderdate#5030 AS co_orderdate_1#5047]
         :  :     +- Relation[rid#5014,cpfk_customer_orders#5015,cfpk_orders_customer#5016,cval_orders_o_orderstatus#5017,cval_orders_o_totalprice#5018,cval_orders_o_orderpriority#5019,cval_orders_o_clerk#5020,cval_orders_o_shippriority#5021,cval_orders_o_comment#5022,cval_orders_o_orderdate#5023,co_orderstatus#5024,co_totalprice#5025,co_orderpriority#5026,co_clerk#5027,co_shippriority#5028,co_comment#5029,co_orderdate#5030] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#5212 AS rid_2#5245, cpfk_orders_lineitem#5213 AS cpfk_orders_lineitem_2#5246, cpfk_supplier_lineitem#5214 AS cpfk_supplier_lineitem_2#5247, cfpk_lineitem_supplier#5215 AS cfpk_lineitem_supplier_2#5248, cfpk_lineitem_partsupp#5216 AS cfpk_lineitem_partsupp_2#5249, cpfk_part_lineitem#5217 AS cpfk_part_lineitem_2#5250, cfpk_lineitem_part#5218 AS cfpk_lineitem_part_2#5251, cpfk_partsupp_lineitem#5219 AS cpfk_partsupp_lineitem_2#5252, cfpk_lineitem_orders#5220 AS cfpk_lineitem_orders_2#5253, cval_lineitem_l_quantity#5221 AS cval_lineitem_l_quantity_2#5254, cval_lineitem_l_extendedprice#5222 AS cval_lineitem_l_extendedprice_2#5255, cval_lineitem_l_discount#5223 AS cval_lineitem_l_discount_2#5256, cval_lineitem_l_tax#5224 AS cval_lineitem_l_tax_2#5257, cval_lineitem_l_returnflag#5225 AS cval_lineitem_l_returnflag_2#5258, cval_lineitem_l_linestatus#5226 AS cval_lineitem_l_linestatus_2#5259, cval_lineitem_l_commitdate#5227 AS cval_lineitem_l_commitdate_2#5260, cval_lineitem_l_receiptdate#5228 AS cval_lineitem_l_receiptdate_2#5261, cval_lineitem_l_shipinstruct#5229 AS cval_lineitem_l_shipinstruct_2#5262, cval_lineitem_l_shipmode#5230 AS cval_lineitem_l_shipmode_2#5263, cval_lineitem_l_comment#5231 AS cval_lineitem_l_comment_2#5264, cval_lineitem_l_shipdate#5232 AS cval_lineitem_l_shipdate_2#5265, cl_quantity#5233 AS cl_quantity_2#5266, cl_extendedprice#5234 AS cl_extendedprice_2#5267, cl_discount#5235 AS cl_discount_2#5268, ... 9 more fields]
         :     +- Relation[rid#5212,cpfk_orders_lineitem#5213,cpfk_supplier_lineitem#5214,cfpk_lineitem_supplier#5215,cfpk_lineitem_partsupp#5216,cpfk_part_lineitem#5217,cfpk_lineitem_part#5218,cpfk_partsupp_lineitem#5219,cfpk_lineitem_orders#5220,cval_lineitem_l_quantity#5221,cval_lineitem_l_extendedprice#5222,cval_lineitem_l_discount#5223,cval_lineitem_l_tax#5224,cval_lineitem_l_returnflag#5225,cval_lineitem_l_linestatus#5226,cval_lineitem_l_commitdate#5227,cval_lineitem_l_receiptdate#5228,cval_lineitem_l_shipinstruct#5229,cval_lineitem_l_shipmode#5230,cval_lineitem_l_comment#5231,cval_lineitem_l_shipdate#5232,cl_quantity#5233,cl_extendedprice#5234,cl_discount#5235,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5112 AS rid_2#5145, cpfk_orders_lineitem#5113 AS cpfk_orders_lineitem_2#5146, cpfk_supplier_lineitem#5114 AS cpfk_supplier_lineitem_2#5147, cfpk_lineitem_supplier#5115 AS cfpk_lineitem_supplier_2#5148, cfpk_lineitem_partsupp#5116 AS cfpk_lineitem_partsupp_2#5149, cpfk_part_lineitem#5117 AS cpfk_part_lineitem_2#5150, cfpk_lineitem_part#5118 AS cfpk_lineitem_part_2#5151, cpfk_partsupp_lineitem#5119 AS cpfk_partsupp_lineitem_2#5152, cfpk_lineitem_orders#5120 AS cfpk_lineitem_orders_2#5153, cval_lineitem_l_quantity#5121 AS cval_lineitem_l_quantity_2#5154, cval_lineitem_l_extendedprice#5122 AS cval_lineitem_l_extendedprice_2#5155, cval_lineitem_l_discount#5123 AS cval_lineitem_l_discount_2#5156, cval_lineitem_l_tax#5124 AS cval_lineitem_l_tax_2#5157, cval_lineitem_l_returnflag#5125 AS cval_lineitem_l_returnflag_2#5158, cval_lineitem_l_linestatus#5126 AS cval_lineitem_l_linestatus_2#5159, cval_lineitem_l_commitdate#5127 AS cval_lineitem_l_commitdate_2#5160, cval_lineitem_l_receiptdate#5128 AS cval_lineitem_l_receiptdate_2#5161, cval_lineitem_l_shipinstruct#5129 AS cval_lineitem_l_shipinstruct_2#5162, cval_lineitem_l_shipmode#5130 AS cval_lineitem_l_shipmode_2#5163, cval_lineitem_l_comment#5131 AS cval_lineitem_l_comment_2#5164, cval_lineitem_l_shipdate#5132 AS cval_lineitem_l_shipdate_2#5165, cl_quantity#5133 AS cl_quantity_2#5166, cl_extendedprice#5134 AS cl_extendedprice_2#5167, cl_discount#5135 AS cl_discount_2#5168, ... 9 more fields]
            +- Relation[rid#5112,cpfk_orders_lineitem#5113,cpfk_supplier_lineitem#5114,cfpk_lineitem_supplier#5115,cfpk_lineitem_partsupp#5116,cpfk_part_lineitem#5117,cfpk_lineitem_part#5118,cpfk_partsupp_lineitem#5119,cfpk_lineitem_orders#5120,cval_lineitem_l_quantity#5121,cval_lineitem_l_extendedprice#5122,cval_lineitem_l_discount#5123,cval_lineitem_l_tax#5124,cval_lineitem_l_returnflag#5125,cval_lineitem_l_linestatus#5126,cval_lineitem_l_commitdate#5127,cval_lineitem_l_receiptdate#5128,cval_lineitem_l_shipinstruct#5129,cval_lineitem_l_shipmode#5130,cval_lineitem_l_comment#5131,cval_lineitem_l_shipdate#5132,cl_quantity#5133,cl_extendedprice#5134,cl_discount#5135,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=75006
Elapsed time: 6180ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/15 15:42:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:42:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5349L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:42:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5349L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#5351 AS rid_0#5368, cval_part_p_name#5352 AS cval_part_p_name_0#5369, cval_part_p_mfgr#5353 AS cval_part_p_mfgr_0#5370, cval_part_p_type#5354 AS cval_part_p_type_0#5371, cval_part_p_size#5355 AS cval_part_p_size_0#5372, cval_part_p_container#5356 AS cval_part_p_container_0#5373, cval_part_p_retailprice#5357 AS cval_part_p_retailprice_0#5374, cval_part_p_comment#5358 AS cval_part_p_comment_0#5375, cval_part_p_brand#5359 AS cval_part_p_brand_0#5376, cp_name#5360 AS cp_name_0#5377, cp_mfgr#5361 AS cp_mfgr_0#5378, cp_type#5362 AS cp_type_0#5379, cp_size#5363 AS cp_size_0#5380, cp_container#5364 AS cp_container_0#5381, cp_retailprice#5365 AS cp_retailprice_0#5382, cp_comment#5366 AS cp_comment_0#5383, cp_brand#5367 AS cp_brand_0#5384]
         :  :  +- Relation[rid#5351,cval_part_p_name#5352,cval_part_p_mfgr#5353,cval_part_p_type#5354,cval_part_p_size#5355,cval_part_p_container#5356,cval_part_p_retailprice#5357,cval_part_p_comment#5358,cval_part_p_brand#5359,cp_name#5360,cp_mfgr#5361,cp_type#5362,cp_size#5363,cp_container#5364,cp_retailprice#5365,cp_comment#5366,cp_brand#5367] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#5451 AS rid_0#5468, cval_part_p_name#5452 AS cval_part_p_name_0#5469, cval_part_p_mfgr#5453 AS cval_part_p_mfgr_0#5470, cval_part_p_type#5454 AS cval_part_p_type_0#5471, cval_part_p_size#5455 AS cval_part_p_size_0#5472, cval_part_p_container#5456 AS cval_part_p_container_0#5473, cval_part_p_retailprice#5457 AS cval_part_p_retailprice_0#5474, cval_part_p_comment#5458 AS cval_part_p_comment_0#5475, cval_part_p_brand#5459 AS cval_part_p_brand_0#5476, cp_name#5460 AS cp_name_0#5477, cp_mfgr#5461 AS cp_mfgr_0#5478, cp_type#5462 AS cp_type_0#5479, cp_size#5463 AS cp_size_0#5480, cp_container#5464 AS cp_container_0#5481, cp_retailprice#5465 AS cp_retailprice_0#5482, cp_comment#5466 AS cp_comment_0#5483, cp_brand#5467 AS cp_brand_0#5484]
         :     :  +- Relation[rid#5451,cval_part_p_name#5452,cval_part_p_mfgr#5453,cval_part_p_type#5454,cval_part_p_size#5455,cval_part_p_container#5456,cval_part_p_retailprice#5457,cval_part_p_comment#5458,cval_part_p_brand#5459,cp_name#5460,cp_mfgr#5461,cp_type#5462,cp_size#5463,cp_container#5464,cp_retailprice#5465,cp_comment#5466,cp_brand#5467] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#5485 AS rid_1#5518, cpfk_orders_lineitem#5486 AS cpfk_orders_lineitem_1#5519, cpfk_supplier_lineitem#5487 AS cpfk_supplier_lineitem_1#5520, cfpk_lineitem_supplier#5488 AS cfpk_lineitem_supplier_1#5521, cfpk_lineitem_partsupp#5489 AS cfpk_lineitem_partsupp_1#5522, cpfk_part_lineitem#5490 AS cpfk_part_lineitem_1#5523, cfpk_lineitem_part#5491 AS cfpk_lineitem_part_1#5524, cpfk_partsupp_lineitem#5492 AS cpfk_partsupp_lineitem_1#5525, cfpk_lineitem_orders#5493 AS cfpk_lineitem_orders_1#5526, cval_lineitem_l_quantity#5494 AS cval_lineitem_l_quantity_1#5527, cval_lineitem_l_extendedprice#5495 AS cval_lineitem_l_extendedprice_1#5528, cval_lineitem_l_discount#5496 AS cval_lineitem_l_discount_1#5529, cval_lineitem_l_tax#5497 AS cval_lineitem_l_tax_1#5530, cval_lineitem_l_returnflag#5498 AS cval_lineitem_l_returnflag_1#5531, cval_lineitem_l_linestatus#5499 AS cval_lineitem_l_linestatus_1#5532, cval_lineitem_l_commitdate#5500 AS cval_lineitem_l_commitdate_1#5533, cval_lineitem_l_receiptdate#5501 AS cval_lineitem_l_receiptdate_1#5534, cval_lineitem_l_shipinstruct#5502 AS cval_lineitem_l_shipinstruct_1#5535, cval_lineitem_l_shipmode#5503 AS cval_lineitem_l_shipmode_1#5536, cval_lineitem_l_comment#5504 AS cval_lineitem_l_comment_1#5537, cval_lineitem_l_shipdate#5505 AS cval_lineitem_l_shipdate_1#5538, cl_quantity#5506 AS cl_quantity_1#5539, cl_extendedprice#5507 AS cl_extendedprice_1#5540, cl_discount#5508 AS cl_discount_1#5541, ... 9 more fields]
         :        +- Relation[rid#5485,cpfk_orders_lineitem#5486,cpfk_supplier_lineitem#5487,cfpk_lineitem_supplier#5488,cfpk_lineitem_partsupp#5489,cpfk_part_lineitem#5490,cfpk_lineitem_part#5491,cpfk_partsupp_lineitem#5492,cfpk_lineitem_orders#5493,cval_lineitem_l_quantity#5494,cval_lineitem_l_extendedprice#5495,cval_lineitem_l_discount#5496,cval_lineitem_l_tax#5497,cval_lineitem_l_returnflag#5498,cval_lineitem_l_linestatus#5499,cval_lineitem_l_commitdate#5500,cval_lineitem_l_receiptdate#5501,cval_lineitem_l_shipinstruct#5502,cval_lineitem_l_shipmode#5503,cval_lineitem_l_comment#5504,cval_lineitem_l_shipdate#5505,cl_quantity#5506,cl_extendedprice#5507,cl_discount#5508,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5385 AS rid_1#5418, cpfk_orders_lineitem#5386 AS cpfk_orders_lineitem_1#5419, cpfk_supplier_lineitem#5387 AS cpfk_supplier_lineitem_1#5420, cfpk_lineitem_supplier#5388 AS cfpk_lineitem_supplier_1#5421, cfpk_lineitem_partsupp#5389 AS cfpk_lineitem_partsupp_1#5422, cpfk_part_lineitem#5390 AS cpfk_part_lineitem_1#5423, cfpk_lineitem_part#5391 AS cfpk_lineitem_part_1#5424, cpfk_partsupp_lineitem#5392 AS cpfk_partsupp_lineitem_1#5425, cfpk_lineitem_orders#5393 AS cfpk_lineitem_orders_1#5426, cval_lineitem_l_quantity#5394 AS cval_lineitem_l_quantity_1#5427, cval_lineitem_l_extendedprice#5395 AS cval_lineitem_l_extendedprice_1#5428, cval_lineitem_l_discount#5396 AS cval_lineitem_l_discount_1#5429, cval_lineitem_l_tax#5397 AS cval_lineitem_l_tax_1#5430, cval_lineitem_l_returnflag#5398 AS cval_lineitem_l_returnflag_1#5431, cval_lineitem_l_linestatus#5399 AS cval_lineitem_l_linestatus_1#5432, cval_lineitem_l_commitdate#5400 AS cval_lineitem_l_commitdate_1#5433, cval_lineitem_l_receiptdate#5401 AS cval_lineitem_l_receiptdate_1#5434, cval_lineitem_l_shipinstruct#5402 AS cval_lineitem_l_shipinstruct_1#5435, cval_lineitem_l_shipmode#5403 AS cval_lineitem_l_shipmode_1#5436, cval_lineitem_l_comment#5404 AS cval_lineitem_l_comment_1#5437, cval_lineitem_l_shipdate#5405 AS cval_lineitem_l_shipdate_1#5438, cl_quantity#5406 AS cl_quantity_1#5439, cl_extendedprice#5407 AS cl_extendedprice_1#5440, cl_discount#5408 AS cl_discount_1#5441, ... 9 more fields]
            +- Relation[rid#5385,cpfk_orders_lineitem#5386,cpfk_supplier_lineitem#5387,cfpk_lineitem_supplier#5388,cfpk_lineitem_partsupp#5389,cpfk_part_lineitem#5390,cfpk_lineitem_part#5391,cpfk_partsupp_lineitem#5392,cfpk_lineitem_orders#5393,cval_lineitem_l_quantity#5394,cval_lineitem_l_extendedprice#5395,cval_lineitem_l_discount#5396,cval_lineitem_l_tax#5397,cval_lineitem_l_returnflag#5398,cval_lineitem_l_linestatus#5399,cval_lineitem_l_commitdate#5400,cval_lineitem_l_receiptdate#5401,cval_lineitem_l_shipinstruct#5402,cval_lineitem_l_shipmode#5403,cval_lineitem_l_comment#5404,cval_lineitem_l_shipdate#5405,cl_quantity#5406,cl_extendedprice#5407,cl_discount#5408,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 87827ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/15 15:43:54 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:43:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5605L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 15:43:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5605L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#5607 AS rid_0#5624, cpfk_customer_orders#5608 AS cpfk_customer_orders_0#5625, cfpk_orders_customer#5609 AS cfpk_orders_customer_0#5626, cval_orders_o_orderstatus#5610 AS cval_orders_o_orderstatus_0#5627, cval_orders_o_totalprice#5611 AS cval_orders_o_totalprice_0#5628, cval_orders_o_orderpriority#5612 AS cval_orders_o_orderpriority_0#5629, cval_orders_o_clerk#5613 AS cval_orders_o_clerk_0#5630, cval_orders_o_shippriority#5614 AS cval_orders_o_shippriority_0#5631, cval_orders_o_comment#5615 AS cval_orders_o_comment_0#5632, cval_orders_o_orderdate#5616 AS cval_orders_o_orderdate_0#5633, co_orderstatus#5617 AS co_orderstatus_0#5634, co_totalprice#5618 AS co_totalprice_0#5635, co_orderpriority#5619 AS co_orderpriority_0#5636, co_clerk#5620 AS co_clerk_0#5637, co_shippriority#5621 AS co_shippriority_0#5638, co_comment#5622 AS co_comment_0#5639, co_orderdate#5623 AS co_orderdate_0#5640]
            :  +- Relation[rid#5607,cpfk_customer_orders#5608,cfpk_orders_customer#5609,cval_orders_o_orderstatus#5610,cval_orders_o_totalprice#5611,cval_orders_o_orderpriority#5612,cval_orders_o_clerk#5613,cval_orders_o_shippriority#5614,cval_orders_o_comment#5615,cval_orders_o_orderdate#5616,co_orderstatus#5617,co_totalprice#5618,co_orderpriority#5619,co_clerk#5620,co_shippriority#5621,co_comment#5622,co_orderdate#5623] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#5641 AS rid_1#5656, cpfk_nation_customer#5642 AS cpfk_nation_customer_1#5657, cfpk_customer_nation#5643 AS cfpk_customer_nation_1#5658, cval_customer_c_name#5644 AS cval_customer_c_name_1#5659, cval_customer_c_address#5645 AS cval_customer_c_address_1#5660, cval_customer_c_phone#5646 AS cval_customer_c_phone_1#5661, cval_customer_c_acctbal#5647 AS cval_customer_c_acctbal_1#5662, cval_customer_c_comment#5648 AS cval_customer_c_comment_1#5663, cval_customer_c_mktsegment#5649 AS cval_customer_c_mktsegment_1#5664, cc_name#5650 AS cc_name_1#5665, cc_address#5651 AS cc_address_1#5666, cc_phone#5652 AS cc_phone_1#5667, cc_acctbal#5653 AS cc_acctbal_1#5668, cc_comment#5654 AS cc_comment_1#5669, cc_mktsegment#5655 AS cc_mktsegment_1#5670]
               +- Relation[rid#5641,cpfk_nation_customer#5642,cfpk_customer_nation#5643,cval_customer_c_name#5644,cval_customer_c_address#5645,cval_customer_c_phone#5646,cval_customer_c_acctbal#5647,cval_customer_c_comment#5648,cval_customer_c_mktsegment#5649,cc_name#5650,cc_address#5651,cc_phone#5652,cc_acctbal#5653,cc_comment#5654,cc_mktsegment#5655] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13634ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/15 15:44:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:44:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5707L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:44:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5707L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#5709 AS rid_0#5742, cpfk_orders_lineitem#5710 AS cpfk_orders_lineitem_0#5743, cpfk_supplier_lineitem#5711 AS cpfk_supplier_lineitem_0#5744, cfpk_lineitem_supplier#5712 AS cfpk_lineitem_supplier_0#5745, cfpk_lineitem_partsupp#5713 AS cfpk_lineitem_partsupp_0#5746, cpfk_part_lineitem#5714 AS cpfk_part_lineitem_0#5747, cfpk_lineitem_part#5715 AS cfpk_lineitem_part_0#5748, cpfk_partsupp_lineitem#5716 AS cpfk_partsupp_lineitem_0#5749, cfpk_lineitem_orders#5717 AS cfpk_lineitem_orders_0#5750, cval_lineitem_l_quantity#5718 AS cval_lineitem_l_quantity_0#5751, cval_lineitem_l_extendedprice#5719 AS cval_lineitem_l_extendedprice_0#5752, cval_lineitem_l_discount#5720 AS cval_lineitem_l_discount_0#5753, cval_lineitem_l_tax#5721 AS cval_lineitem_l_tax_0#5754, cval_lineitem_l_returnflag#5722 AS cval_lineitem_l_returnflag_0#5755, cval_lineitem_l_linestatus#5723 AS cval_lineitem_l_linestatus_0#5756, cval_lineitem_l_commitdate#5724 AS cval_lineitem_l_commitdate_0#5757, cval_lineitem_l_receiptdate#5725 AS cval_lineitem_l_receiptdate_0#5758, cval_lineitem_l_shipinstruct#5726 AS cval_lineitem_l_shipinstruct_0#5759, cval_lineitem_l_shipmode#5727 AS cval_lineitem_l_shipmode_0#5760, cval_lineitem_l_comment#5728 AS cval_lineitem_l_comment_0#5761, cval_lineitem_l_shipdate#5729 AS cval_lineitem_l_shipdate_0#5762, cl_quantity#5730 AS cl_quantity_0#5763, cl_extendedprice#5731 AS cl_extendedprice_0#5764, cl_discount#5732 AS cl_discount_0#5765, ... 9 more fields]
            :  :  +- Relation[rid#5709,cpfk_orders_lineitem#5710,cpfk_supplier_lineitem#5711,cfpk_lineitem_supplier#5712,cfpk_lineitem_partsupp#5713,cpfk_part_lineitem#5714,cfpk_lineitem_part#5715,cpfk_partsupp_lineitem#5716,cfpk_lineitem_orders#5717,cval_lineitem_l_quantity#5718,cval_lineitem_l_extendedprice#5719,cval_lineitem_l_discount#5720,cval_lineitem_l_tax#5721,cval_lineitem_l_returnflag#5722,cval_lineitem_l_linestatus#5723,cval_lineitem_l_commitdate#5724,cval_lineitem_l_receiptdate#5725,cval_lineitem_l_shipinstruct#5726,cval_lineitem_l_shipmode#5727,cval_lineitem_l_comment#5728,cval_lineitem_l_shipdate#5729,cl_quantity#5730,cl_extendedprice#5731,cl_discount#5732,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#5775 AS rid_0#5808, cpfk_orders_lineitem#5776 AS cpfk_orders_lineitem_0#5809, cpfk_supplier_lineitem#5777 AS cpfk_supplier_lineitem_0#5810, cfpk_lineitem_supplier#5778 AS cfpk_lineitem_supplier_0#5811, cfpk_lineitem_partsupp#5779 AS cfpk_lineitem_partsupp_0#5812, cpfk_part_lineitem#5780 AS cpfk_part_lineitem_0#5813, cfpk_lineitem_part#5781 AS cfpk_lineitem_part_0#5814, cpfk_partsupp_lineitem#5782 AS cpfk_partsupp_lineitem_0#5815, cfpk_lineitem_orders#5783 AS cfpk_lineitem_orders_0#5816, cval_lineitem_l_quantity#5784 AS cval_lineitem_l_quantity_0#5817, cval_lineitem_l_extendedprice#5785 AS cval_lineitem_l_extendedprice_0#5818, cval_lineitem_l_discount#5786 AS cval_lineitem_l_discount_0#5819, cval_lineitem_l_tax#5787 AS cval_lineitem_l_tax_0#5820, cval_lineitem_l_returnflag#5788 AS cval_lineitem_l_returnflag_0#5821, cval_lineitem_l_linestatus#5789 AS cval_lineitem_l_linestatus_0#5822, cval_lineitem_l_commitdate#5790 AS cval_lineitem_l_commitdate_0#5823, cval_lineitem_l_receiptdate#5791 AS cval_lineitem_l_receiptdate_0#5824, cval_lineitem_l_shipinstruct#5792 AS cval_lineitem_l_shipinstruct_0#5825, cval_lineitem_l_shipmode#5793 AS cval_lineitem_l_shipmode_0#5826, cval_lineitem_l_comment#5794 AS cval_lineitem_l_comment_0#5827, cval_lineitem_l_shipdate#5795 AS cval_lineitem_l_shipdate_0#5828, cl_quantity#5796 AS cl_quantity_0#5829, cl_extendedprice#5797 AS cl_extendedprice_0#5830, cl_discount#5798 AS cl_discount_0#5831, ... 9 more fields]
            :        +- Relation[rid#5775,cpfk_orders_lineitem#5776,cpfk_supplier_lineitem#5777,cfpk_lineitem_supplier#5778,cfpk_lineitem_partsupp#5779,cpfk_part_lineitem#5780,cfpk_lineitem_part#5781,cpfk_partsupp_lineitem#5782,cfpk_lineitem_orders#5783,cval_lineitem_l_quantity#5784,cval_lineitem_l_extendedprice#5785,cval_lineitem_l_discount#5786,cval_lineitem_l_tax#5787,cval_lineitem_l_returnflag#5788,cval_lineitem_l_linestatus#5789,cval_lineitem_l_commitdate#5790,cval_lineitem_l_receiptdate#5791,cval_lineitem_l_shipinstruct#5792,cval_lineitem_l_shipmode#5793,cval_lineitem_l_comment#5794,cval_lineitem_l_shipdate#5795,cl_quantity#5796,cl_extendedprice#5797,cl_discount#5798,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#5841 AS rid_1#5858, cpfk_customer_orders#5842 AS cpfk_customer_orders_1#5859, cfpk_orders_customer#5843 AS cfpk_orders_customer_1#5860, cval_orders_o_orderstatus#5844 AS cval_orders_o_orderstatus_1#5861, cval_orders_o_totalprice#5845 AS cval_orders_o_totalprice_1#5862, cval_orders_o_orderpriority#5846 AS cval_orders_o_orderpriority_1#5863, cval_orders_o_clerk#5847 AS cval_orders_o_clerk_1#5864, cval_orders_o_shippriority#5848 AS cval_orders_o_shippriority_1#5865, cval_orders_o_comment#5849 AS cval_orders_o_comment_1#5866, cval_orders_o_orderdate#5850 AS cval_orders_o_orderdate_1#5867, co_orderstatus#5851 AS co_orderstatus_1#5868, co_totalprice#5852 AS co_totalprice_1#5869, co_orderpriority#5853 AS co_orderpriority_1#5870, co_clerk#5854 AS co_clerk_1#5871, co_shippriority#5855 AS co_shippriority_1#5872, co_comment#5856 AS co_comment_1#5873, co_orderdate#5857 AS co_orderdate_1#5874]
               +- Relation[rid#5841,cpfk_customer_orders#5842,cfpk_orders_customer#5843,cval_orders_o_orderstatus#5844,cval_orders_o_totalprice#5845,cval_orders_o_orderpriority#5846,cval_orders_o_clerk#5847,cval_orders_o_shippriority#5848,cval_orders_o_comment#5849,cval_orders_o_orderdate#5850,co_orderstatus#5851,co_totalprice#5852,co_orderpriority#5853,co_clerk#5854,co_shippriority#5855,co_comment#5856,co_orderdate#5857] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 23156ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/15 15:44:31 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:44:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5929L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:44:31 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:44:31 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:44:31 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:44:31 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:44:31 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:44:31 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:44:31 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:44:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5929L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#5931 AS rid_0#5948, cval_part_p_name#5932 AS cval_part_p_name_0#5949, cval_part_p_mfgr#5933 AS cval_part_p_mfgr_0#5950, cval_part_p_type#5934 AS cval_part_p_type_0#5951, cval_part_p_size#5935 AS cval_part_p_size_0#5952, cval_part_p_container#5936 AS cval_part_p_container_0#5953, cval_part_p_retailprice#5937 AS cval_part_p_retailprice_0#5954, cval_part_p_comment#5938 AS cval_part_p_comment_0#5955, cval_part_p_brand#5939 AS cval_part_p_brand_0#5956, cp_name#5940 AS cp_name_0#5957, cp_mfgr#5941 AS cp_mfgr_0#5958, cp_type#5942 AS cp_type_0#5959, cp_size#5943 AS cp_size_0#5960, cp_container#5944 AS cp_container_0#5961, cp_retailprice#5945 AS cp_retailprice_0#5962, cp_comment#5946 AS cp_comment_0#5963, cp_brand#5947 AS cp_brand_0#5964]
         :  :  :  :  +- Relation[rid#5931,cval_part_p_name#5932,cval_part_p_mfgr#5933,cval_part_p_type#5934,cval_part_p_size#5935,cval_part_p_container#5936,cval_part_p_retailprice#5937,cval_part_p_comment#5938,cval_part_p_brand#5939,cp_name#5940,cp_mfgr#5941,cp_type#5942,cp_size#5943,cp_container#5944,cp_retailprice#5945,cp_comment#5946,cp_brand#5947] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#5965 AS rid_0#5982, cval_part_p_name#5966 AS cval_part_p_name_0#5983, cval_part_p_mfgr#5967 AS cval_part_p_mfgr_0#5984, cval_part_p_type#5968 AS cval_part_p_type_0#5985, cval_part_p_size#5969 AS cval_part_p_size_0#5986, cval_part_p_container#5970 AS cval_part_p_container_0#5987, cval_part_p_retailprice#5971 AS cval_part_p_retailprice_0#5988, cval_part_p_comment#5972 AS cval_part_p_comment_0#5989, cval_part_p_brand#5973 AS cval_part_p_brand_0#5990, cp_name#5974 AS cp_name_0#5991, cp_mfgr#5975 AS cp_mfgr_0#5992, cp_type#5976 AS cp_type_0#5993, cp_size#5977 AS cp_size_0#5994, cp_container#5978 AS cp_container_0#5995, cp_retailprice#5979 AS cp_retailprice_0#5996, cp_comment#5980 AS cp_comment_0#5997, cp_brand#5981 AS cp_brand_0#5998]
         :  :  :        +- Relation[rid#5965,cval_part_p_name#5966,cval_part_p_mfgr#5967,cval_part_p_type#5968,cval_part_p_size#5969,cval_part_p_container#5970,cval_part_p_retailprice#5971,cval_part_p_comment#5972,cval_part_p_brand#5973,cp_name#5974,cp_mfgr#5975,cp_type#5976,cp_size#5977,cp_container#5978,cp_retailprice#5979,cp_comment#5980,cp_brand#5981] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#5999 AS rid_0#6016, cval_part_p_name#6000 AS cval_part_p_name_0#6017, cval_part_p_mfgr#6001 AS cval_part_p_mfgr_0#6018, cval_part_p_type#6002 AS cval_part_p_type_0#6019, cval_part_p_size#6003 AS cval_part_p_size_0#6020, cval_part_p_container#6004 AS cval_part_p_container_0#6021, cval_part_p_retailprice#6005 AS cval_part_p_retailprice_0#6022, cval_part_p_comment#6006 AS cval_part_p_comment_0#6023, cval_part_p_brand#6007 AS cval_part_p_brand_0#6024, cp_name#6008 AS cp_name_0#6025, cp_mfgr#6009 AS cp_mfgr_0#6026, cp_type#6010 AS cp_type_0#6027, cp_size#6011 AS cp_size_0#6028, cp_container#6012 AS cp_container_0#6029, cp_retailprice#6013 AS cp_retailprice_0#6030, cp_comment#6014 AS cp_comment_0#6031, cp_brand#6015 AS cp_brand_0#6032]
         :  :        +- Relation[rid#5999,cval_part_p_name#6000,cval_part_p_mfgr#6001,cval_part_p_type#6002,cval_part_p_size#6003,cval_part_p_container#6004,cval_part_p_retailprice#6005,cval_part_p_comment#6006,cval_part_p_brand#6007,cp_name#6008,cp_mfgr#6009,cp_type#6010,cp_size#6011,cp_container#6012,cp_retailprice#6013,cp_comment#6014,cp_brand#6015] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#6133 AS rid_1#6166, cpfk_orders_lineitem#6134 AS cpfk_orders_lineitem_1#6167, cpfk_supplier_lineitem#6135 AS cpfk_supplier_lineitem_1#6168, cfpk_lineitem_supplier#6136 AS cfpk_lineitem_supplier_1#6169, cfpk_lineitem_partsupp#6137 AS cfpk_lineitem_partsupp_1#6170, cpfk_part_lineitem#6138 AS cpfk_part_lineitem_1#6171, cfpk_lineitem_part#6139 AS cfpk_lineitem_part_1#6172, cpfk_partsupp_lineitem#6140 AS cpfk_partsupp_lineitem_1#6173, cfpk_lineitem_orders#6141 AS cfpk_lineitem_orders_1#6174, cval_lineitem_l_quantity#6142 AS cval_lineitem_l_quantity_1#6175, cval_lineitem_l_extendedprice#6143 AS cval_lineitem_l_extendedprice_1#6176, cval_lineitem_l_discount#6144 AS cval_lineitem_l_discount_1#6177, cval_lineitem_l_tax#6145 AS cval_lineitem_l_tax_1#6178, cval_lineitem_l_returnflag#6146 AS cval_lineitem_l_returnflag_1#6179, cval_lineitem_l_linestatus#6147 AS cval_lineitem_l_linestatus_1#6180, cval_lineitem_l_commitdate#6148 AS cval_lineitem_l_commitdate_1#6181, cval_lineitem_l_receiptdate#6149 AS cval_lineitem_l_receiptdate_1#6182, cval_lineitem_l_shipinstruct#6150 AS cval_lineitem_l_shipinstruct_1#6183, cval_lineitem_l_shipmode#6151 AS cval_lineitem_l_shipmode_1#6184, cval_lineitem_l_comment#6152 AS cval_lineitem_l_comment_1#6185, cval_lineitem_l_shipdate#6153 AS cval_lineitem_l_shipdate_1#6186, cl_quantity#6154 AS cl_quantity_1#6187, cl_extendedprice#6155 AS cl_extendedprice_1#6188, cl_discount#6156 AS cl_discount_1#6189, ... 9 more fields]
         :     +- Relation[rid#6133,cpfk_orders_lineitem#6134,cpfk_supplier_lineitem#6135,cfpk_lineitem_supplier#6136,cfpk_lineitem_partsupp#6137,cpfk_part_lineitem#6138,cfpk_lineitem_part#6139,cpfk_partsupp_lineitem#6140,cfpk_lineitem_orders#6141,cval_lineitem_l_quantity#6142,cval_lineitem_l_extendedprice#6143,cval_lineitem_l_discount#6144,cval_lineitem_l_tax#6145,cval_lineitem_l_returnflag#6146,cval_lineitem_l_linestatus#6147,cval_lineitem_l_commitdate#6148,cval_lineitem_l_receiptdate#6149,cval_lineitem_l_shipinstruct#6150,cval_lineitem_l_shipmode#6151,cval_lineitem_l_comment#6152,cval_lineitem_l_shipdate#6153,cl_quantity#6154,cl_extendedprice#6155,cl_discount#6156,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6033 AS rid_1#6066, cpfk_orders_lineitem#6034 AS cpfk_orders_lineitem_1#6067, cpfk_supplier_lineitem#6035 AS cpfk_supplier_lineitem_1#6068, cfpk_lineitem_supplier#6036 AS cfpk_lineitem_supplier_1#6069, cfpk_lineitem_partsupp#6037 AS cfpk_lineitem_partsupp_1#6070, cpfk_part_lineitem#6038 AS cpfk_part_lineitem_1#6071, cfpk_lineitem_part#6039 AS cfpk_lineitem_part_1#6072, cpfk_partsupp_lineitem#6040 AS cpfk_partsupp_lineitem_1#6073, cfpk_lineitem_orders#6041 AS cfpk_lineitem_orders_1#6074, cval_lineitem_l_quantity#6042 AS cval_lineitem_l_quantity_1#6075, cval_lineitem_l_extendedprice#6043 AS cval_lineitem_l_extendedprice_1#6076, cval_lineitem_l_discount#6044 AS cval_lineitem_l_discount_1#6077, cval_lineitem_l_tax#6045 AS cval_lineitem_l_tax_1#6078, cval_lineitem_l_returnflag#6046 AS cval_lineitem_l_returnflag_1#6079, cval_lineitem_l_linestatus#6047 AS cval_lineitem_l_linestatus_1#6080, cval_lineitem_l_commitdate#6048 AS cval_lineitem_l_commitdate_1#6081, cval_lineitem_l_receiptdate#6049 AS cval_lineitem_l_receiptdate_1#6082, cval_lineitem_l_shipinstruct#6050 AS cval_lineitem_l_shipinstruct_1#6083, cval_lineitem_l_shipmode#6051 AS cval_lineitem_l_shipmode_1#6084, cval_lineitem_l_comment#6052 AS cval_lineitem_l_comment_1#6085, cval_lineitem_l_shipdate#6053 AS cval_lineitem_l_shipdate_1#6086, cl_quantity#6054 AS cl_quantity_1#6087, cl_extendedprice#6055 AS cl_extendedprice_1#6088, cl_discount#6056 AS cl_discount_1#6089, ... 9 more fields]
            +- Relation[rid#6033,cpfk_orders_lineitem#6034,cpfk_supplier_lineitem#6035,cfpk_lineitem_supplier#6036,cfpk_lineitem_partsupp#6037,cpfk_part_lineitem#6038,cfpk_lineitem_part#6039,cpfk_partsupp_lineitem#6040,cfpk_lineitem_orders#6041,cval_lineitem_l_quantity#6042,cval_lineitem_l_extendedprice#6043,cval_lineitem_l_discount#6044,cval_lineitem_l_tax#6045,cval_lineitem_l_returnflag#6046,cval_lineitem_l_linestatus#6047,cval_lineitem_l_commitdate#6048,cval_lineitem_l_receiptdate#6049,cval_lineitem_l_shipinstruct#6050,cval_lineitem_l_shipmode#6051,cval_lineitem_l_comment#6052,cval_lineitem_l_shipdate#6053,cl_quantity#6054,cl_extendedprice#6055,cl_discount#6056,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=408
Elapsed time: 379ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/15 15:44:31 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:44:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6254L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 15:44:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:44:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:44:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:44:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:44:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6254L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#6256 AS rid_0#6273, cval_part_p_name#6257 AS cval_part_p_name_0#6274, cval_part_p_mfgr#6258 AS cval_part_p_mfgr_0#6275, cval_part_p_type#6259 AS cval_part_p_type_0#6276, cval_part_p_size#6260 AS cval_part_p_size_0#6277, cval_part_p_container#6261 AS cval_part_p_container_0#6278, cval_part_p_retailprice#6262 AS cval_part_p_retailprice_0#6279, cval_part_p_comment#6263 AS cval_part_p_comment_0#6280, cval_part_p_brand#6264 AS cval_part_p_brand_0#6281, cp_name#6265 AS cp_name_0#6282, cp_mfgr#6266 AS cp_mfgr_0#6283, cp_type#6267 AS cp_type_0#6284, cp_size#6268 AS cp_size_0#6285, cp_container#6269 AS cp_container_0#6286, cp_retailprice#6270 AS cp_retailprice_0#6287, cp_comment#6271 AS cp_comment_0#6288, cp_brand#6272 AS cp_brand_0#6289]
            :  :  :  :  +- Relation[rid#6256,cval_part_p_name#6257,cval_part_p_mfgr#6258,cval_part_p_type#6259,cval_part_p_size#6260,cval_part_p_container#6261,cval_part_p_retailprice#6262,cval_part_p_comment#6263,cval_part_p_brand#6264,cp_name#6265,cp_mfgr#6266,cp_type#6267,cp_size#6268,cp_container#6269,cp_retailprice#6270,cp_comment#6271,cp_brand#6272] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#6290 AS rid_0#6307, cval_part_p_name#6291 AS cval_part_p_name_0#6308, cval_part_p_mfgr#6292 AS cval_part_p_mfgr_0#6309, cval_part_p_type#6293 AS cval_part_p_type_0#6310, cval_part_p_size#6294 AS cval_part_p_size_0#6311, cval_part_p_container#6295 AS cval_part_p_container_0#6312, cval_part_p_retailprice#6296 AS cval_part_p_retailprice_0#6313, cval_part_p_comment#6297 AS cval_part_p_comment_0#6314, cval_part_p_brand#6298 AS cval_part_p_brand_0#6315, cp_name#6299 AS cp_name_0#6316, cp_mfgr#6300 AS cp_mfgr_0#6317, cp_type#6301 AS cp_type_0#6318, cp_size#6302 AS cp_size_0#6319, cp_container#6303 AS cp_container_0#6320, cp_retailprice#6304 AS cp_retailprice_0#6321, cp_comment#6305 AS cp_comment_0#6322, cp_brand#6306 AS cp_brand_0#6323]
            :  :  :        +- Relation[rid#6290,cval_part_p_name#6291,cval_part_p_mfgr#6292,cval_part_p_type#6293,cval_part_p_size#6294,cval_part_p_container#6295,cval_part_p_retailprice#6296,cval_part_p_comment#6297,cval_part_p_brand#6298,cp_name#6299,cp_mfgr#6300,cp_type#6301,cp_size#6302,cp_container#6303,cp_retailprice#6304,cp_comment#6305,cp_brand#6306] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- Project [rid#6380 AS rid_1#6391, cpfk_part_partsupp#6381 AS cpfk_part_partsupp_1#6392, cfpk_partsupp_part#6382 AS cfpk_partsupp_part_1#6393, cpfk_supplier_partsupp#6383 AS cpfk_supplier_partsupp_1#6394, cfpk_partsupp_supplier#6384 AS cfpk_partsupp_supplier_1#6395, cval_partsupp_ps_availqty#6385 AS cval_partsupp_ps_availqty_1#6396, cval_partsupp_ps_supplycost#6386 AS cval_partsupp_ps_supplycost_1#6397, cval_partsupp_ps_comment#6387 AS cval_partsupp_ps_comment_1#6398, cps_availqty#6388 AS cps_availqty_1#6399, cps_supplycost#6389 AS cps_supplycost_1#6400, cps_comment#6390 AS cps_comment_1#6401]
            :  :     +- Relation[rid#6380,cpfk_part_partsupp#6381,cfpk_partsupp_part#6382,cpfk_supplier_partsupp#6383,cfpk_partsupp_supplier#6384,cval_partsupp_ps_availqty#6385,cval_partsupp_ps_supplycost#6386,cval_partsupp_ps_comment#6387,cps_availqty#6388,cps_supplycost#6389,cps_comment#6390] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#6324 AS rid_1#6335, cpfk_part_partsupp#6325 AS cpfk_part_partsupp_1#6336, cfpk_partsupp_part#6326 AS cfpk_partsupp_part_1#6337, cpfk_supplier_partsupp#6327 AS cpfk_supplier_partsupp_1#6338, cfpk_partsupp_supplier#6328 AS cfpk_partsupp_supplier_1#6339, cval_partsupp_ps_availqty#6329 AS cval_partsupp_ps_availqty_1#6340, cval_partsupp_ps_supplycost#6330 AS cval_partsupp_ps_supplycost_1#6341, cval_partsupp_ps_comment#6331 AS cval_partsupp_ps_comment_1#6342, cps_availqty#6332 AS cps_availqty_1#6343, cps_supplycost#6333 AS cps_supplycost_1#6344, cps_comment#6334 AS cps_comment_1#6345]
            :     +- Relation[rid#6324,cpfk_part_partsupp#6325,cfpk_partsupp_part#6326,cpfk_supplier_partsupp#6327,cfpk_partsupp_supplier#6328,cval_partsupp_ps_availqty#6329,cval_partsupp_ps_supplycost#6330,cval_partsupp_ps_comment#6331,cps_availqty#6332,cps_supplycost#6333,cps_comment#6334] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#6402 AS rid_2#6409, cpfk_region_nation#6403 AS cpfk_region_nation_2#6410, cfpk_nation_region#6404 AS cfpk_nation_region_2#6411, cval_nation_n_name#6405 AS cval_nation_n_name_2#6412, cval_nation_n_comment#6406 AS cval_nation_n_comment_2#6413, cn_name#6407 AS cn_name_2#6414, cn_comment#6408 AS cn_comment_2#6415]
               :  :  :  +- Relation[rid#6402,cpfk_region_nation#6403,cfpk_nation_region#6404,cval_nation_n_name#6405,cval_nation_n_comment#6406,cn_name#6407,cn_comment#6408] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#6416 AS rid_2#6423, cpfk_region_nation#6417 AS cpfk_region_nation_2#6424, cfpk_nation_region#6418 AS cfpk_nation_region_2#6425, cval_nation_n_name#6419 AS cval_nation_n_name_2#6426, cval_nation_n_comment#6420 AS cval_nation_n_comment_2#6427, cn_name#6421 AS cn_name_2#6428, cn_comment#6422 AS cn_comment_2#6429]
               :  :        +- Relation[rid#6416,cpfk_region_nation#6417,cfpk_nation_region#6418,cval_nation_n_name#6419,cval_nation_n_comment#6420,cn_name#6421,cn_comment#6422] JDBCRelation(tnation) [numPartitions=1]
               :  +- Project [rid#6470 AS rid_3#6483, cpfk_nation_supplier#6471 AS cpfk_nation_supplier_3#6484, cfpk_supplier_nation#6472 AS cfpk_supplier_nation_3#6485, cval_supplier_s_name#6473 AS cval_supplier_s_name_3#6486, cval_supplier_s_address#6474 AS cval_supplier_s_address_3#6487, cval_supplier_s_phone#6475 AS cval_supplier_s_phone_3#6488, cval_supplier_s_acctbal#6476 AS cval_supplier_s_acctbal_3#6489, cval_supplier_s_comment#6477 AS cval_supplier_s_comment_3#6490, cs_name#6478 AS cs_name_3#6491, cs_address#6479 AS cs_address_3#6492, cs_phone#6480 AS cs_phone_3#6493, cs_acctbal#6481 AS cs_acctbal_3#6494, cs_comment#6482 AS cs_comment_3#6495]
               :     +- Relation[rid#6470,cpfk_nation_supplier#6471,cfpk_supplier_nation#6472,cval_supplier_s_name#6473,cval_supplier_s_address#6474,cval_supplier_s_phone#6475,cval_supplier_s_acctbal#6476,cval_supplier_s_comment#6477,cs_name#6478,cs_address#6479,cs_phone#6480,cs_acctbal#6481,cs_comment#6482] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#6430 AS rid_3#6443, cpfk_nation_supplier#6431 AS cpfk_nation_supplier_3#6444, cfpk_supplier_nation#6432 AS cfpk_supplier_nation_3#6445, cval_supplier_s_name#6433 AS cval_supplier_s_name_3#6446, cval_supplier_s_address#6434 AS cval_supplier_s_address_3#6447, cval_supplier_s_phone#6435 AS cval_supplier_s_phone_3#6448, cval_supplier_s_acctbal#6436 AS cval_supplier_s_acctbal_3#6449, cval_supplier_s_comment#6437 AS cval_supplier_s_comment_3#6450, cs_name#6438 AS cs_name_3#6451, cs_address#6439 AS cs_address_3#6452, cs_phone#6440 AS cs_phone_3#6453, cs_acctbal#6441 AS cs_acctbal_3#6454, cs_comment#6442 AS cs_comment_3#6455]
                  +- Relation[rid#6430,cpfk_nation_supplier#6431,cfpk_supplier_nation#6432,cval_supplier_s_name#6433,cval_supplier_s_address#6434,cval_supplier_s_phone#6435,cval_supplier_s_acctbal#6436,cval_supplier_s_comment#6437,cs_name#6438,cs_address#6439,cs_phone#6440,cs_acctbal#6441,cs_comment#6442] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1
Elapsed time: 711ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 15:44:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:44:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6553L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:44:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:44:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6553L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#6555 AS rid_0#6562, cpfk_region_nation#6556 AS cpfk_region_nation_0#6563, cfpk_nation_region#6557 AS cfpk_nation_region_0#6564, cval_nation_n_name#6558 AS cval_nation_n_name_0#6565, cval_nation_n_comment#6559 AS cval_nation_n_comment_0#6566, cn_name#6560 AS cn_name_0#6567, cn_comment#6561 AS cn_comment_0#6568]
            :  :  :     :  :  :  :  :  +- Relation[rid#6555,cpfk_region_nation#6556,cfpk_nation_region#6557,cval_nation_n_name#6558,cval_nation_n_comment#6559,cn_name#6560,cn_comment#6561] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#6595 AS rid_0#6602, cpfk_region_nation#6596 AS cpfk_region_nation_0#6603, cfpk_nation_region#6597 AS cfpk_nation_region_0#6604, cval_nation_n_name#6598 AS cval_nation_n_name_0#6605, cval_nation_n_comment#6599 AS cval_nation_n_comment_0#6606, cn_name#6600 AS cn_name_0#6607, cn_comment#6601 AS cn_comment_0#6608]
            :  :  :     :  :  :  :     :  +- Relation[rid#6595,cpfk_region_nation#6596,cfpk_nation_region#6597,cval_nation_n_name#6598,cval_nation_n_comment#6599,cn_name#6600,cn_comment#6601] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#6609 AS rid_1#6622, cpfk_nation_supplier#6610 AS cpfk_nation_supplier_1#6623, cfpk_supplier_nation#6611 AS cfpk_supplier_nation_1#6624, cval_supplier_s_name#6612 AS cval_supplier_s_name_1#6625, cval_supplier_s_address#6613 AS cval_supplier_s_address_1#6626, cval_supplier_s_phone#6614 AS cval_supplier_s_phone_1#6627, cval_supplier_s_acctbal#6615 AS cval_supplier_s_acctbal_1#6628, cval_supplier_s_comment#6616 AS cval_supplier_s_comment_1#6629, cs_name#6617 AS cs_name_1#6630, cs_address#6618 AS cs_address_1#6631, cs_phone#6619 AS cs_phone_1#6632, cs_acctbal#6620 AS cs_acctbal_1#6633, cs_comment#6621 AS cs_comment_1#6634]
            :  :  :     :  :  :  :        +- Relation[rid#6609,cpfk_nation_supplier#6610,cfpk_supplier_nation#6611,cval_supplier_s_name#6612,cval_supplier_s_address#6613,cval_supplier_s_phone#6614,cval_supplier_s_acctbal#6615,cval_supplier_s_comment#6616,cs_name#6617,cs_address#6618,cs_phone#6619,cs_acctbal#6620,cs_comment#6621] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#6569 AS rid_1#6582, cpfk_nation_supplier#6570 AS cpfk_nation_supplier_1#6583, cfpk_supplier_nation#6571 AS cfpk_supplier_nation_1#6584, cval_supplier_s_name#6572 AS cval_supplier_s_name_1#6585, cval_supplier_s_address#6573 AS cval_supplier_s_address_1#6586, cval_supplier_s_phone#6574 AS cval_supplier_s_phone_1#6587, cval_supplier_s_acctbal#6575 AS cval_supplier_s_acctbal_1#6588, cval_supplier_s_comment#6576 AS cval_supplier_s_comment_1#6589, cs_name#6577 AS cs_name_1#6590, cs_address#6578 AS cs_address_1#6591, cs_phone#6579 AS cs_phone_1#6592, cs_acctbal#6580 AS cs_acctbal_1#6593, cs_comment#6581 AS cs_comment_1#6594]
            :  :  :     :  :  :     +- Relation[rid#6569,cpfk_nation_supplier#6570,cfpk_supplier_nation#6571,cval_supplier_s_name#6572,cval_supplier_s_address#6573,cval_supplier_s_phone#6574,cval_supplier_s_acctbal#6575,cval_supplier_s_comment#6576,cs_name#6577,cs_address#6578,cs_phone#6579,cs_acctbal#6580,cs_comment#6581] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#6657 AS rid_1#6670, cpfk_nation_supplier#6658 AS cpfk_nation_supplier_1#6671, cfpk_supplier_nation#6659 AS cfpk_supplier_nation_1#6672, cval_supplier_s_name#6660 AS cval_supplier_s_name_1#6673, cval_supplier_s_address#6661 AS cval_supplier_s_address_1#6674, cval_supplier_s_phone#6662 AS cval_supplier_s_phone_1#6675, cval_supplier_s_acctbal#6663 AS cval_supplier_s_acctbal_1#6676, cval_supplier_s_comment#6664 AS cval_supplier_s_comment_1#6677, cs_name#6665 AS cs_name_1#6678, cs_address#6666 AS cs_address_1#6679, cs_phone#6667 AS cs_phone_1#6680, cs_acctbal#6668 AS cs_acctbal_1#6681, cs_comment#6669 AS cs_comment_1#6682]
            :  :  :     :  :     :  +- Relation[rid#6657,cpfk_nation_supplier#6658,cfpk_supplier_nation#6659,cval_supplier_s_name#6660,cval_supplier_s_address#6661,cval_supplier_s_phone#6662,cval_supplier_s_acctbal#6663,cval_supplier_s_comment#6664,cs_name#6665,cs_address#6666,cs_phone#6667,cs_acctbal#6668,cs_comment#6669] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#6683 AS rid_2#6694, cpfk_part_partsupp#6684 AS cpfk_part_partsupp_2#6695, cfpk_partsupp_part#6685 AS cfpk_partsupp_part_2#6696, cpfk_supplier_partsupp#6686 AS cpfk_supplier_partsupp_2#6697, cfpk_partsupp_supplier#6687 AS cfpk_partsupp_supplier_2#6698, cval_partsupp_ps_availqty#6688 AS cval_partsupp_ps_availqty_2#6699, cval_partsupp_ps_supplycost#6689 AS cval_partsupp_ps_supplycost_2#6700, cval_partsupp_ps_comment#6690 AS cval_partsupp_ps_comment_2#6701, cps_availqty#6691 AS cps_availqty_2#6702, cps_supplycost#6692 AS cps_supplycost_2#6703, cps_comment#6693 AS cps_comment_2#6704]
            :  :  :     :  :        +- Relation[rid#6683,cpfk_part_partsupp#6684,cfpk_partsupp_part#6685,cpfk_supplier_partsupp#6686,cfpk_partsupp_supplier#6687,cval_partsupp_ps_availqty#6688,cval_partsupp_ps_supplycost#6689,cval_partsupp_ps_comment#6690,cps_availqty#6691,cps_supplycost#6692,cps_comment#6693] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#6635 AS rid_2#6646, cpfk_part_partsupp#6636 AS cpfk_part_partsupp_2#6647, cfpk_partsupp_part#6637 AS cfpk_partsupp_part_2#6648, cpfk_supplier_partsupp#6638 AS cpfk_supplier_partsupp_2#6649, cfpk_partsupp_supplier#6639 AS cfpk_partsupp_supplier_2#6650, cval_partsupp_ps_availqty#6640 AS cval_partsupp_ps_availqty_2#6651, cval_partsupp_ps_supplycost#6641 AS cval_partsupp_ps_supplycost_2#6652, cval_partsupp_ps_comment#6642 AS cval_partsupp_ps_comment_2#6653, cps_availqty#6643 AS cps_availqty_2#6654, cps_supplycost#6644 AS cps_supplycost_2#6655, cps_comment#6645 AS cps_comment_2#6656]
            :  :  :     :     +- Relation[rid#6635,cpfk_part_partsupp#6636,cfpk_partsupp_part#6637,cpfk_supplier_partsupp#6638,cfpk_partsupp_supplier#6639,cval_partsupp_ps_availqty#6640,cval_partsupp_ps_supplycost#6641,cval_partsupp_ps_comment#6642,cps_availqty#6643,cps_supplycost#6644,cps_comment#6645] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#6705 AS rid_3#6722, cval_part_p_name#6706 AS cval_part_p_name_3#6723, cval_part_p_mfgr#6707 AS cval_part_p_mfgr_3#6724, cval_part_p_type#6708 AS cval_part_p_type_3#6725, cval_part_p_size#6709 AS cval_part_p_size_3#6726, cval_part_p_container#6710 AS cval_part_p_container_3#6727, cval_part_p_retailprice#6711 AS cval_part_p_retailprice_3#6728, cval_part_p_comment#6712 AS cval_part_p_comment_3#6729, cval_part_p_brand#6713 AS cval_part_p_brand_3#6730, cp_name#6714 AS cp_name_3#6731, cp_mfgr#6715 AS cp_mfgr_3#6732, cp_type#6716 AS cp_type_3#6733, cp_size#6717 AS cp_size_3#6734, cp_container#6718 AS cp_container_3#6735, cp_retailprice#6719 AS cp_retailprice_3#6736, cp_comment#6720 AS cp_comment_3#6737, cp_brand#6721 AS cp_brand_3#6738]
            :  :  :        +- Relation[rid#6705,cval_part_p_name#6706,cval_part_p_mfgr#6707,cval_part_p_type#6708,cval_part_p_size#6709,cval_part_p_container#6710,cval_part_p_retailprice#6711,cval_part_p_comment#6712,cval_part_p_brand#6713,cp_name#6714,cp_mfgr#6715,cp_type#6716,cp_size#6717,cp_container#6718,cp_retailprice#6719,cp_comment#6720,cp_brand#6721] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#6805 AS rid_2#6816, cpfk_part_partsupp#6806 AS cpfk_part_partsupp_2#6817, cfpk_partsupp_part#6807 AS cfpk_partsupp_part_2#6818, cpfk_supplier_partsupp#6808 AS cpfk_supplier_partsupp_2#6819, cfpk_partsupp_supplier#6809 AS cfpk_partsupp_supplier_2#6820, cval_partsupp_ps_availqty#6810 AS cval_partsupp_ps_availqty_2#6821, cval_partsupp_ps_supplycost#6811 AS cval_partsupp_ps_supplycost_2#6822, cval_partsupp_ps_comment#6812 AS cval_partsupp_ps_comment_2#6823, cps_availqty#6813 AS cps_availqty_2#6824, cps_supplycost#6814 AS cps_supplycost_2#6825, cps_comment#6815 AS cps_comment_2#6826]
            :  :     :  +- Relation[rid#6805,cpfk_part_partsupp#6806,cfpk_partsupp_part#6807,cpfk_supplier_partsupp#6808,cfpk_partsupp_supplier#6809,cval_partsupp_ps_availqty#6810,cval_partsupp_ps_supplycost#6811,cval_partsupp_ps_comment#6812,cps_availqty#6813,cps_supplycost#6814,cps_comment#6815] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#6827 AS rid_4#6860, cpfk_orders_lineitem#6828 AS cpfk_orders_lineitem_4#6861, cpfk_supplier_lineitem#6829 AS cpfk_supplier_lineitem_4#6862, cfpk_lineitem_supplier#6830 AS cfpk_lineitem_supplier_4#6863, cfpk_lineitem_partsupp#6831 AS cfpk_lineitem_partsupp_4#6864, cpfk_part_lineitem#6832 AS cpfk_part_lineitem_4#6865, cfpk_lineitem_part#6833 AS cfpk_lineitem_part_4#6866, cpfk_partsupp_lineitem#6834 AS cpfk_partsupp_lineitem_4#6867, cfpk_lineitem_orders#6835 AS cfpk_lineitem_orders_4#6868, cval_lineitem_l_quantity#6836 AS cval_lineitem_l_quantity_4#6869, cval_lineitem_l_extendedprice#6837 AS cval_lineitem_l_extendedprice_4#6870, cval_lineitem_l_discount#6838 AS cval_lineitem_l_discount_4#6871, cval_lineitem_l_tax#6839 AS cval_lineitem_l_tax_4#6872, cval_lineitem_l_returnflag#6840 AS cval_lineitem_l_returnflag_4#6873, cval_lineitem_l_linestatus#6841 AS cval_lineitem_l_linestatus_4#6874, cval_lineitem_l_commitdate#6842 AS cval_lineitem_l_commitdate_4#6875, cval_lineitem_l_receiptdate#6843 AS cval_lineitem_l_receiptdate_4#6876, cval_lineitem_l_shipinstruct#6844 AS cval_lineitem_l_shipinstruct_4#6877, cval_lineitem_l_shipmode#6845 AS cval_lineitem_l_shipmode_4#6878, cval_lineitem_l_comment#6846 AS cval_lineitem_l_comment_4#6879, cval_lineitem_l_shipdate#6847 AS cval_lineitem_l_shipdate_4#6880, cl_quantity#6848 AS cl_quantity_4#6881, cl_extendedprice#6849 AS cl_extendedprice_4#6882, cl_discount#6850 AS cl_discount_4#6883, ... 9 more fields]
            :  :        +- Relation[rid#6827,cpfk_orders_lineitem#6828,cpfk_supplier_lineitem#6829,cfpk_lineitem_supplier#6830,cfpk_lineitem_partsupp#6831,cpfk_part_lineitem#6832,cfpk_lineitem_part#6833,cpfk_partsupp_lineitem#6834,cfpk_lineitem_orders#6835,cval_lineitem_l_quantity#6836,cval_lineitem_l_extendedprice#6837,cval_lineitem_l_discount#6838,cval_lineitem_l_tax#6839,cval_lineitem_l_returnflag#6840,cval_lineitem_l_linestatus#6841,cval_lineitem_l_commitdate#6842,cval_lineitem_l_receiptdate#6843,cval_lineitem_l_shipinstruct#6844,cval_lineitem_l_shipmode#6845,cval_lineitem_l_comment#6846,cval_lineitem_l_shipdate#6847,cl_quantity#6848,cl_extendedprice#6849,cl_discount#6850,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#6739 AS rid_4#6772, cpfk_orders_lineitem#6740 AS cpfk_orders_lineitem_4#6773, cpfk_supplier_lineitem#6741 AS cpfk_supplier_lineitem_4#6774, cfpk_lineitem_supplier#6742 AS cfpk_lineitem_supplier_4#6775, cfpk_lineitem_partsupp#6743 AS cfpk_lineitem_partsupp_4#6776, cpfk_part_lineitem#6744 AS cpfk_part_lineitem_4#6777, cfpk_lineitem_part#6745 AS cfpk_lineitem_part_4#6778, cpfk_partsupp_lineitem#6746 AS cpfk_partsupp_lineitem_4#6779, cfpk_lineitem_orders#6747 AS cfpk_lineitem_orders_4#6780, cval_lineitem_l_quantity#6748 AS cval_lineitem_l_quantity_4#6781, cval_lineitem_l_extendedprice#6749 AS cval_lineitem_l_extendedprice_4#6782, cval_lineitem_l_discount#6750 AS cval_lineitem_l_discount_4#6783, cval_lineitem_l_tax#6751 AS cval_lineitem_l_tax_4#6784, cval_lineitem_l_returnflag#6752 AS cval_lineitem_l_returnflag_4#6785, cval_lineitem_l_linestatus#6753 AS cval_lineitem_l_linestatus_4#6786, cval_lineitem_l_commitdate#6754 AS cval_lineitem_l_commitdate_4#6787, cval_lineitem_l_receiptdate#6755 AS cval_lineitem_l_receiptdate_4#6788, cval_lineitem_l_shipinstruct#6756 AS cval_lineitem_l_shipinstruct_4#6789, cval_lineitem_l_shipmode#6757 AS cval_lineitem_l_shipmode_4#6790, cval_lineitem_l_comment#6758 AS cval_lineitem_l_comment_4#6791, cval_lineitem_l_shipdate#6759 AS cval_lineitem_l_shipdate_4#6792, cl_quantity#6760 AS cl_quantity_4#6793, cl_extendedprice#6761 AS cl_extendedprice_4#6794, cl_discount#6762 AS cl_discount_4#6795, ... 9 more fields]
            :     +- Relation[rid#6739,cpfk_orders_lineitem#6740,cpfk_supplier_lineitem#6741,cfpk_lineitem_supplier#6742,cfpk_lineitem_partsupp#6743,cpfk_part_lineitem#6744,cfpk_lineitem_part#6745,cpfk_partsupp_lineitem#6746,cfpk_lineitem_orders#6747,cval_lineitem_l_quantity#6748,cval_lineitem_l_extendedprice#6749,cval_lineitem_l_discount#6750,cval_lineitem_l_tax#6751,cval_lineitem_l_returnflag#6752,cval_lineitem_l_linestatus#6753,cval_lineitem_l_commitdate#6754,cval_lineitem_l_receiptdate#6755,cval_lineitem_l_shipinstruct#6756,cval_lineitem_l_shipmode#6757,cval_lineitem_l_comment#6758,cval_lineitem_l_shipdate#6759,cl_quantity#6760,cl_extendedprice#6761,cl_discount#6762,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#6893 AS rid_5#6910, cpfk_customer_orders#6894 AS cpfk_customer_orders_5#6911, cfpk_orders_customer#6895 AS cfpk_orders_customer_5#6912, cval_orders_o_orderstatus#6896 AS cval_orders_o_orderstatus_5#6913, cval_orders_o_totalprice#6897 AS cval_orders_o_totalprice_5#6914, cval_orders_o_orderpriority#6898 AS cval_orders_o_orderpriority_5#6915, cval_orders_o_clerk#6899 AS cval_orders_o_clerk_5#6916, cval_orders_o_shippriority#6900 AS cval_orders_o_shippriority_5#6917, cval_orders_o_comment#6901 AS cval_orders_o_comment_5#6918, cval_orders_o_orderdate#6902 AS cval_orders_o_orderdate_5#6919, co_orderstatus#6903 AS co_orderstatus_5#6920, co_totalprice#6904 AS co_totalprice_5#6921, co_orderpriority#6905 AS co_orderpriority_5#6922, co_clerk#6906 AS co_clerk_5#6923, co_shippriority#6907 AS co_shippriority_5#6924, co_comment#6908 AS co_comment_5#6925, co_orderdate#6909 AS co_orderdate_5#6926]
               +- Relation[rid#6893,cpfk_customer_orders#6894,cfpk_orders_customer#6895,cval_orders_o_orderstatus#6896,cval_orders_o_totalprice#6897,cval_orders_o_orderpriority#6898,cval_orders_o_clerk#6899,cval_orders_o_shippriority#6900,cval_orders_o_comment#6901,cval_orders_o_orderdate#6902,co_orderstatus#6903,co_totalprice#6904,co_orderpriority#6905,co_clerk#6906,co_shippriority#6907,co_comment#6908,co_orderdate#6909] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 171796ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/15 15:47:24 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:47:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7030L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 15:47:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7030L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#7032 AS rid_0#7049, cpfk_customer_orders#7033 AS cpfk_customer_orders_0#7050, cfpk_orders_customer#7034 AS cfpk_orders_customer_0#7051, cval_orders_o_orderstatus#7035 AS cval_orders_o_orderstatus_0#7052, cval_orders_o_totalprice#7036 AS cval_orders_o_totalprice_0#7053, cval_orders_o_orderpriority#7037 AS cval_orders_o_orderpriority_0#7054, cval_orders_o_clerk#7038 AS cval_orders_o_clerk_0#7055, cval_orders_o_shippriority#7039 AS cval_orders_o_shippriority_0#7056, cval_orders_o_comment#7040 AS cval_orders_o_comment_0#7057, cval_orders_o_orderdate#7041 AS cval_orders_o_orderdate_0#7058, co_orderstatus#7042 AS co_orderstatus_0#7059, co_totalprice#7043 AS co_totalprice_0#7060, co_orderpriority#7044 AS co_orderpriority_0#7061, co_clerk#7045 AS co_clerk_0#7062, co_shippriority#7046 AS co_shippriority_0#7063, co_comment#7047 AS co_comment_0#7064, co_orderdate#7048 AS co_orderdate_0#7065]
            :  +- Relation[rid#7032,cpfk_customer_orders#7033,cfpk_orders_customer#7034,cval_orders_o_orderstatus#7035,cval_orders_o_totalprice#7036,cval_orders_o_orderpriority#7037,cval_orders_o_clerk#7038,cval_orders_o_shippriority#7039,cval_orders_o_comment#7040,cval_orders_o_orderdate#7041,co_orderstatus#7042,co_totalprice#7043,co_orderpriority#7044,co_clerk#7045,co_shippriority#7046,co_comment#7047,co_orderdate#7048] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#7066 AS rid_1#7081, cpfk_nation_customer#7067 AS cpfk_nation_customer_1#7082, cfpk_customer_nation#7068 AS cfpk_customer_nation_1#7083, cval_customer_c_name#7069 AS cval_customer_c_name_1#7084, cval_customer_c_address#7070 AS cval_customer_c_address_1#7085, cval_customer_c_phone#7071 AS cval_customer_c_phone_1#7086, cval_customer_c_acctbal#7072 AS cval_customer_c_acctbal_1#7087, cval_customer_c_comment#7073 AS cval_customer_c_comment_1#7088, cval_customer_c_mktsegment#7074 AS cval_customer_c_mktsegment_1#7089, cc_name#7075 AS cc_name_1#7090, cc_address#7076 AS cc_address_1#7091, cc_phone#7077 AS cc_phone_1#7092, cc_acctbal#7078 AS cc_acctbal_1#7093, cc_comment#7079 AS cc_comment_1#7094, cc_mktsegment#7080 AS cc_mktsegment_1#7095]
               +- Relation[rid#7066,cpfk_nation_customer#7067,cfpk_customer_nation#7068,cval_customer_c_name#7069,cval_customer_c_address#7070,cval_customer_c_phone#7071,cval_customer_c_acctbal#7072,cval_customer_c_comment#7073,cval_customer_c_mktsegment#7074,cc_name#7075,cc_address#7076,cc_phone#7077,cc_acctbal#7078,cc_comment#7079,cc_mktsegment#7080] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13685ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 15:47:38 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:47:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7137L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:47:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:47:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:47:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:47:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:47:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:47:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:47:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:47:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:47:38 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:47:38 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:47:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7137L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#7139 AS rid_0#7146, cpfk_region_nation#7140 AS cpfk_region_nation_0#7147, cfpk_nation_region#7141 AS cfpk_nation_region_0#7148, cval_nation_n_name#7142 AS cval_nation_n_name_0#7149, cval_nation_n_comment#7143 AS cval_nation_n_comment_0#7150, cn_name#7144 AS cn_name_0#7151, cn_comment#7145 AS cn_comment_0#7152]
            :     :     :  :  :  :  :  +- Relation[rid#7139,cpfk_region_nation#7140,cfpk_nation_region#7141,cval_nation_n_name#7142,cval_nation_n_comment#7143,cn_name#7144,cn_comment#7145] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#7179 AS rid_0#7186, cpfk_region_nation#7180 AS cpfk_region_nation_0#7187, cfpk_nation_region#7181 AS cfpk_nation_region_0#7188, cval_nation_n_name#7182 AS cval_nation_n_name_0#7189, cval_nation_n_comment#7183 AS cval_nation_n_comment_0#7190, cn_name#7184 AS cn_name_0#7191, cn_comment#7185 AS cn_comment_0#7192]
            :     :     :  :  :  :     :  +- Relation[rid#7179,cpfk_region_nation#7180,cfpk_nation_region#7181,cval_nation_n_name#7182,cval_nation_n_comment#7183,cn_name#7184,cn_comment#7185] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#7193 AS rid_1#7206, cpfk_nation_supplier#7194 AS cpfk_nation_supplier_1#7207, cfpk_supplier_nation#7195 AS cfpk_supplier_nation_1#7208, cval_supplier_s_name#7196 AS cval_supplier_s_name_1#7209, cval_supplier_s_address#7197 AS cval_supplier_s_address_1#7210, cval_supplier_s_phone#7198 AS cval_supplier_s_phone_1#7211, cval_supplier_s_acctbal#7199 AS cval_supplier_s_acctbal_1#7212, cval_supplier_s_comment#7200 AS cval_supplier_s_comment_1#7213, cs_name#7201 AS cs_name_1#7214, cs_address#7202 AS cs_address_1#7215, cs_phone#7203 AS cs_phone_1#7216, cs_acctbal#7204 AS cs_acctbal_1#7217, cs_comment#7205 AS cs_comment_1#7218]
            :     :     :  :  :  :        +- Relation[rid#7193,cpfk_nation_supplier#7194,cfpk_supplier_nation#7195,cval_supplier_s_name#7196,cval_supplier_s_address#7197,cval_supplier_s_phone#7198,cval_supplier_s_acctbal#7199,cval_supplier_s_comment#7200,cs_name#7201,cs_address#7202,cs_phone#7203,cs_acctbal#7204,cs_comment#7205] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#7153 AS rid_1#7166, cpfk_nation_supplier#7154 AS cpfk_nation_supplier_1#7167, cfpk_supplier_nation#7155 AS cfpk_supplier_nation_1#7168, cval_supplier_s_name#7156 AS cval_supplier_s_name_1#7169, cval_supplier_s_address#7157 AS cval_supplier_s_address_1#7170, cval_supplier_s_phone#7158 AS cval_supplier_s_phone_1#7171, cval_supplier_s_acctbal#7159 AS cval_supplier_s_acctbal_1#7172, cval_supplier_s_comment#7160 AS cval_supplier_s_comment_1#7173, cs_name#7161 AS cs_name_1#7174, cs_address#7162 AS cs_address_1#7175, cs_phone#7163 AS cs_phone_1#7176, cs_acctbal#7164 AS cs_acctbal_1#7177, cs_comment#7165 AS cs_comment_1#7178]
            :     :     :  :  :     +- Relation[rid#7153,cpfk_nation_supplier#7154,cfpk_supplier_nation#7155,cval_supplier_s_name#7156,cval_supplier_s_address#7157,cval_supplier_s_phone#7158,cval_supplier_s_acctbal#7159,cval_supplier_s_comment#7160,cs_name#7161,cs_address#7162,cs_phone#7163,cs_acctbal#7164,cs_comment#7165] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#7285 AS rid_1#7298, cpfk_nation_supplier#7286 AS cpfk_nation_supplier_1#7299, cfpk_supplier_nation#7287 AS cfpk_supplier_nation_1#7300, cval_supplier_s_name#7288 AS cval_supplier_s_name_1#7301, cval_supplier_s_address#7289 AS cval_supplier_s_address_1#7302, cval_supplier_s_phone#7290 AS cval_supplier_s_phone_1#7303, cval_supplier_s_acctbal#7291 AS cval_supplier_s_acctbal_1#7304, cval_supplier_s_comment#7292 AS cval_supplier_s_comment_1#7305, cs_name#7293 AS cs_name_1#7306, cs_address#7294 AS cs_address_1#7307, cs_phone#7295 AS cs_phone_1#7308, cs_acctbal#7296 AS cs_acctbal_1#7309, cs_comment#7297 AS cs_comment_1#7310]
            :     :     :  :     :  +- Relation[rid#7285,cpfk_nation_supplier#7286,cfpk_supplier_nation#7287,cval_supplier_s_name#7288,cval_supplier_s_address#7289,cval_supplier_s_phone#7290,cval_supplier_s_acctbal#7291,cval_supplier_s_comment#7292,cs_name#7293,cs_address#7294,cs_phone#7295,cs_acctbal#7296,cs_comment#7297] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#7311 AS rid_2#7344, cpfk_orders_lineitem#7312 AS cpfk_orders_lineitem_2#7345, cpfk_supplier_lineitem#7313 AS cpfk_supplier_lineitem_2#7346, cfpk_lineitem_supplier#7314 AS cfpk_lineitem_supplier_2#7347, cfpk_lineitem_partsupp#7315 AS cfpk_lineitem_partsupp_2#7348, cpfk_part_lineitem#7316 AS cpfk_part_lineitem_2#7349, cfpk_lineitem_part#7317 AS cfpk_lineitem_part_2#7350, cpfk_partsupp_lineitem#7318 AS cpfk_partsupp_lineitem_2#7351, cfpk_lineitem_orders#7319 AS cfpk_lineitem_orders_2#7352, cval_lineitem_l_quantity#7320 AS cval_lineitem_l_quantity_2#7353, cval_lineitem_l_extendedprice#7321 AS cval_lineitem_l_extendedprice_2#7354, cval_lineitem_l_discount#7322 AS cval_lineitem_l_discount_2#7355, cval_lineitem_l_tax#7323 AS cval_lineitem_l_tax_2#7356, cval_lineitem_l_returnflag#7324 AS cval_lineitem_l_returnflag_2#7357, cval_lineitem_l_linestatus#7325 AS cval_lineitem_l_linestatus_2#7358, cval_lineitem_l_commitdate#7326 AS cval_lineitem_l_commitdate_2#7359, cval_lineitem_l_receiptdate#7327 AS cval_lineitem_l_receiptdate_2#7360, cval_lineitem_l_shipinstruct#7328 AS cval_lineitem_l_shipinstruct_2#7361, cval_lineitem_l_shipmode#7329 AS cval_lineitem_l_shipmode_2#7362, cval_lineitem_l_comment#7330 AS cval_lineitem_l_comment_2#7363, cval_lineitem_l_shipdate#7331 AS cval_lineitem_l_shipdate_2#7364, cl_quantity#7332 AS cl_quantity_2#7365, cl_extendedprice#7333 AS cl_extendedprice_2#7366, cl_discount#7334 AS cl_discount_2#7367, ... 9 more fields]
            :     :     :  :        +- Relation[rid#7311,cpfk_orders_lineitem#7312,cpfk_supplier_lineitem#7313,cfpk_lineitem_supplier#7314,cfpk_lineitem_partsupp#7315,cpfk_part_lineitem#7316,cfpk_lineitem_part#7317,cpfk_partsupp_lineitem#7318,cfpk_lineitem_orders#7319,cval_lineitem_l_quantity#7320,cval_lineitem_l_extendedprice#7321,cval_lineitem_l_discount#7322,cval_lineitem_l_tax#7323,cval_lineitem_l_returnflag#7324,cval_lineitem_l_linestatus#7325,cval_lineitem_l_commitdate#7326,cval_lineitem_l_receiptdate#7327,cval_lineitem_l_shipinstruct#7328,cval_lineitem_l_shipmode#7329,cval_lineitem_l_comment#7330,cval_lineitem_l_shipdate#7331,cl_quantity#7332,cl_extendedprice#7333,cl_discount#7334,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#7219 AS rid_2#7252, cpfk_orders_lineitem#7220 AS cpfk_orders_lineitem_2#7253, cpfk_supplier_lineitem#7221 AS cpfk_supplier_lineitem_2#7254, cfpk_lineitem_supplier#7222 AS cfpk_lineitem_supplier_2#7255, cfpk_lineitem_partsupp#7223 AS cfpk_lineitem_partsupp_2#7256, cpfk_part_lineitem#7224 AS cpfk_part_lineitem_2#7257, cfpk_lineitem_part#7225 AS cfpk_lineitem_part_2#7258, cpfk_partsupp_lineitem#7226 AS cpfk_partsupp_lineitem_2#7259, cfpk_lineitem_orders#7227 AS cfpk_lineitem_orders_2#7260, cval_lineitem_l_quantity#7228 AS cval_lineitem_l_quantity_2#7261, cval_lineitem_l_extendedprice#7229 AS cval_lineitem_l_extendedprice_2#7262, cval_lineitem_l_discount#7230 AS cval_lineitem_l_discount_2#7263, cval_lineitem_l_tax#7231 AS cval_lineitem_l_tax_2#7264, cval_lineitem_l_returnflag#7232 AS cval_lineitem_l_returnflag_2#7265, cval_lineitem_l_linestatus#7233 AS cval_lineitem_l_linestatus_2#7266, cval_lineitem_l_commitdate#7234 AS cval_lineitem_l_commitdate_2#7267, cval_lineitem_l_receiptdate#7235 AS cval_lineitem_l_receiptdate_2#7268, cval_lineitem_l_shipinstruct#7236 AS cval_lineitem_l_shipinstruct_2#7269, cval_lineitem_l_shipmode#7237 AS cval_lineitem_l_shipmode_2#7270, cval_lineitem_l_comment#7238 AS cval_lineitem_l_comment_2#7271, cval_lineitem_l_shipdate#7239 AS cval_lineitem_l_shipdate_2#7272, cl_quantity#7240 AS cl_quantity_2#7273, cl_extendedprice#7241 AS cl_extendedprice_2#7274, cl_discount#7242 AS cl_discount_2#7275, ... 9 more fields]
            :     :     :     +- Relation[rid#7219,cpfk_orders_lineitem#7220,cpfk_supplier_lineitem#7221,cfpk_lineitem_supplier#7222,cfpk_lineitem_partsupp#7223,cpfk_part_lineitem#7224,cfpk_lineitem_part#7225,cpfk_partsupp_lineitem#7226,cfpk_lineitem_orders#7227,cval_lineitem_l_quantity#7228,cval_lineitem_l_extendedprice#7229,cval_lineitem_l_discount#7230,cval_lineitem_l_tax#7231,cval_lineitem_l_returnflag#7232,cval_lineitem_l_linestatus#7233,cval_lineitem_l_commitdate#7234,cval_lineitem_l_receiptdate#7235,cval_lineitem_l_shipinstruct#7236,cval_lineitem_l_shipmode#7237,cval_lineitem_l_comment#7238,cval_lineitem_l_shipdate#7239,cl_quantity#7240,cl_extendedprice#7241,cl_discount#7242,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#7377 AS rid_3#7394, cval_part_p_name#7378 AS cval_part_p_name_3#7395, cval_part_p_mfgr#7379 AS cval_part_p_mfgr_3#7396, cval_part_p_type#7380 AS cval_part_p_type_3#7397, cval_part_p_size#7381 AS cval_part_p_size_3#7398, cval_part_p_container#7382 AS cval_part_p_container_3#7399, cval_part_p_retailprice#7383 AS cval_part_p_retailprice_3#7400, cval_part_p_comment#7384 AS cval_part_p_comment_3#7401, cval_part_p_brand#7385 AS cval_part_p_brand_3#7402, cp_name#7386 AS cp_name_3#7403, cp_mfgr#7387 AS cp_mfgr_3#7404, cp_type#7388 AS cp_type_3#7405, cp_size#7389 AS cp_size_3#7406, cp_container#7390 AS cp_container_3#7407, cp_retailprice#7391 AS cp_retailprice_3#7408, cp_comment#7392 AS cp_comment_3#7409, cp_brand#7393 AS cp_brand_3#7410]
            :     :        +- Relation[rid#7377,cval_part_p_name#7378,cval_part_p_mfgr#7379,cval_part_p_type#7380,cval_part_p_size#7381,cval_part_p_container#7382,cval_part_p_retailprice#7383,cval_part_p_comment#7384,cval_part_p_brand#7385,cp_name#7386,cp_mfgr#7387,cp_type#7388,cp_size#7389,cp_container#7390,cp_retailprice#7391,cp_comment#7392,cp_brand#7393] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#7411 AS rid_4#7422, cpfk_part_partsupp#7412 AS cpfk_part_partsupp_4#7423, cfpk_partsupp_part#7413 AS cfpk_partsupp_part_4#7424, cpfk_supplier_partsupp#7414 AS cpfk_supplier_partsupp_4#7425, cfpk_partsupp_supplier#7415 AS cfpk_partsupp_supplier_4#7426, cval_partsupp_ps_availqty#7416 AS cval_partsupp_ps_availqty_4#7427, cval_partsupp_ps_supplycost#7417 AS cval_partsupp_ps_supplycost_4#7428, cval_partsupp_ps_comment#7418 AS cval_partsupp_ps_comment_4#7429, cps_availqty#7419 AS cps_availqty_4#7430, cps_supplycost#7420 AS cps_supplycost_4#7431, cps_comment#7421 AS cps_comment_4#7432]
            :        +- Relation[rid#7411,cpfk_part_partsupp#7412,cfpk_partsupp_part#7413,cpfk_supplier_partsupp#7414,cfpk_partsupp_supplier#7415,cval_partsupp_ps_availqty#7416,cval_partsupp_ps_supplycost#7417,cval_partsupp_ps_comment#7418,cps_availqty#7419,cps_supplycost#7420,cps_comment#7421] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#7433 AS rid_5#7450, cpfk_customer_orders#7434 AS cpfk_customer_orders_5#7451, cfpk_orders_customer#7435 AS cfpk_orders_customer_5#7452, cval_orders_o_orderstatus#7436 AS cval_orders_o_orderstatus_5#7453, cval_orders_o_totalprice#7437 AS cval_orders_o_totalprice_5#7454, cval_orders_o_orderpriority#7438 AS cval_orders_o_orderpriority_5#7455, cval_orders_o_clerk#7439 AS cval_orders_o_clerk_5#7456, cval_orders_o_shippriority#7440 AS cval_orders_o_shippriority_5#7457, cval_orders_o_comment#7441 AS cval_orders_o_comment_5#7458, cval_orders_o_orderdate#7442 AS cval_orders_o_orderdate_5#7459, co_orderstatus#7443 AS co_orderstatus_5#7460, co_totalprice#7444 AS co_totalprice_5#7461, co_orderpriority#7445 AS co_orderpriority_5#7462, co_clerk#7446 AS co_clerk_5#7463, co_shippriority#7447 AS co_shippriority_5#7464, co_comment#7448 AS co_comment_5#7465, co_orderdate#7449 AS co_orderdate_5#7466]
               +- Relation[rid#7433,cpfk_customer_orders#7434,cfpk_orders_customer#7435,cval_orders_o_orderstatus#7436,cval_orders_o_totalprice#7437,cval_orders_o_orderpriority#7438,cval_orders_o_clerk#7439,cval_orders_o_shippriority#7440,cval_orders_o_comment#7441,cval_orders_o_orderdate#7442,co_orderstatus#7443,co_totalprice#7444,co_orderpriority#7445,co_clerk#7446,co_shippriority#7447,co_comment#7448,co_orderdate#7449] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 261479ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/15 15:51:59 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:51:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7569L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 15:51:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:51:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:51:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:51:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:51:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:51:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:51:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:51:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7569L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#7571 AS rid_0#7604, cpfk_orders_lineitem#7572 AS cpfk_orders_lineitem_0#7605, cpfk_supplier_lineitem#7573 AS cpfk_supplier_lineitem_0#7606, cfpk_lineitem_supplier#7574 AS cfpk_lineitem_supplier_0#7607, cfpk_lineitem_partsupp#7575 AS cfpk_lineitem_partsupp_0#7608, cpfk_part_lineitem#7576 AS cpfk_part_lineitem_0#7609, cfpk_lineitem_part#7577 AS cfpk_lineitem_part_0#7610, cpfk_partsupp_lineitem#7578 AS cpfk_partsupp_lineitem_0#7611, cfpk_lineitem_orders#7579 AS cfpk_lineitem_orders_0#7612, cval_lineitem_l_quantity#7580 AS cval_lineitem_l_quantity_0#7613, cval_lineitem_l_extendedprice#7581 AS cval_lineitem_l_extendedprice_0#7614, cval_lineitem_l_discount#7582 AS cval_lineitem_l_discount_0#7615, cval_lineitem_l_tax#7583 AS cval_lineitem_l_tax_0#7616, cval_lineitem_l_returnflag#7584 AS cval_lineitem_l_returnflag_0#7617, cval_lineitem_l_linestatus#7585 AS cval_lineitem_l_linestatus_0#7618, cval_lineitem_l_commitdate#7586 AS cval_lineitem_l_commitdate_0#7619, cval_lineitem_l_receiptdate#7587 AS cval_lineitem_l_receiptdate_0#7620, cval_lineitem_l_shipinstruct#7588 AS cval_lineitem_l_shipinstruct_0#7621, cval_lineitem_l_shipmode#7589 AS cval_lineitem_l_shipmode_0#7622, cval_lineitem_l_comment#7590 AS cval_lineitem_l_comment_0#7623, cval_lineitem_l_shipdate#7591 AS cval_lineitem_l_shipdate_0#7624, cl_quantity#7592 AS cl_quantity_0#7625, cl_extendedprice#7593 AS cl_extendedprice_0#7626, cl_discount#7594 AS cl_discount_0#7627, ... 9 more fields]
            :  +- Relation[rid#7571,cpfk_orders_lineitem#7572,cpfk_supplier_lineitem#7573,cfpk_lineitem_supplier#7574,cfpk_lineitem_partsupp#7575,cpfk_part_lineitem#7576,cfpk_lineitem_part#7577,cpfk_partsupp_lineitem#7578,cfpk_lineitem_orders#7579,cval_lineitem_l_quantity#7580,cval_lineitem_l_extendedprice#7581,cval_lineitem_l_discount#7582,cval_lineitem_l_tax#7583,cval_lineitem_l_returnflag#7584,cval_lineitem_l_linestatus#7585,cval_lineitem_l_commitdate#7586,cval_lineitem_l_receiptdate#7587,cval_lineitem_l_shipinstruct#7588,cval_lineitem_l_shipmode#7589,cval_lineitem_l_comment#7590,cval_lineitem_l_shipdate#7591,cl_quantity#7592,cl_extendedprice#7593,cl_discount#7594,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#7637 AS rid_1#7654, cpfk_customer_orders#7638 AS cpfk_customer_orders_1#7655, cfpk_orders_customer#7639 AS cfpk_orders_customer_1#7656, cval_orders_o_orderstatus#7640 AS cval_orders_o_orderstatus_1#7657, cval_orders_o_totalprice#7641 AS cval_orders_o_totalprice_1#7658, cval_orders_o_orderpriority#7642 AS cval_orders_o_orderpriority_1#7659, cval_orders_o_clerk#7643 AS cval_orders_o_clerk_1#7660, cval_orders_o_shippriority#7644 AS cval_orders_o_shippriority_1#7661, cval_orders_o_comment#7645 AS cval_orders_o_comment_1#7662, cval_orders_o_orderdate#7646 AS cval_orders_o_orderdate_1#7663, co_orderstatus#7647 AS co_orderstatus_1#7664, co_totalprice#7648 AS co_totalprice_1#7665, co_orderpriority#7649 AS co_orderpriority_1#7666, co_clerk#7650 AS co_clerk_1#7667, co_shippriority#7651 AS co_shippriority_1#7668, co_comment#7652 AS co_comment_1#7669, co_orderdate#7653 AS co_orderdate_1#7670]
                  :     :  :  :  :  +- Relation[rid#7637,cpfk_customer_orders#7638,cfpk_orders_customer#7639,cval_orders_o_orderstatus#7640,cval_orders_o_totalprice#7641,cval_orders_o_orderpriority#7642,cval_orders_o_clerk#7643,cval_orders_o_shippriority#7644,cval_orders_o_comment#7645,cval_orders_o_orderdate#7646,co_orderstatus#7647,co_totalprice#7648,co_orderpriority#7649,co_clerk#7650,co_shippriority#7651,co_comment#7652,co_orderdate#7653] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#7671 AS rid_1#7688, cpfk_customer_orders#7672 AS cpfk_customer_orders_1#7689, cfpk_orders_customer#7673 AS cfpk_orders_customer_1#7690, cval_orders_o_orderstatus#7674 AS cval_orders_o_orderstatus_1#7691, cval_orders_o_totalprice#7675 AS cval_orders_o_totalprice_1#7692, cval_orders_o_orderpriority#7676 AS cval_orders_o_orderpriority_1#7693, cval_orders_o_clerk#7677 AS cval_orders_o_clerk_1#7694, cval_orders_o_shippriority#7678 AS cval_orders_o_shippriority_1#7695, cval_orders_o_comment#7679 AS cval_orders_o_comment_1#7696, cval_orders_o_orderdate#7680 AS cval_orders_o_orderdate_1#7697, co_orderstatus#7681 AS co_orderstatus_1#7698, co_totalprice#7682 AS co_totalprice_1#7699, co_orderpriority#7683 AS co_orderpriority_1#7700, co_clerk#7684 AS co_clerk_1#7701, co_shippriority#7685 AS co_shippriority_1#7702, co_comment#7686 AS co_comment_1#7703, co_orderdate#7687 AS co_orderdate_1#7704]
                  :     :  :  :        +- Relation[rid#7671,cpfk_customer_orders#7672,cfpk_orders_customer#7673,cval_orders_o_orderstatus#7674,cval_orders_o_totalprice#7675,cval_orders_o_orderpriority#7676,cval_orders_o_clerk#7677,cval_orders_o_shippriority#7678,cval_orders_o_comment#7679,cval_orders_o_orderdate#7680,co_orderstatus#7681,co_totalprice#7682,co_orderpriority#7683,co_clerk#7684,co_shippriority#7685,co_comment#7686,co_orderdate#7687] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- Project [rid#7805 AS rid_2#7838, cpfk_orders_lineitem#7806 AS cpfk_orders_lineitem_2#7839, cpfk_supplier_lineitem#7807 AS cpfk_supplier_lineitem_2#7840, cfpk_lineitem_supplier#7808 AS cfpk_lineitem_supplier_2#7841, cfpk_lineitem_partsupp#7809 AS cfpk_lineitem_partsupp_2#7842, cpfk_part_lineitem#7810 AS cpfk_part_lineitem_2#7843, cfpk_lineitem_part#7811 AS cfpk_lineitem_part_2#7844, cpfk_partsupp_lineitem#7812 AS cpfk_partsupp_lineitem_2#7845, cfpk_lineitem_orders#7813 AS cfpk_lineitem_orders_2#7846, cval_lineitem_l_quantity#7814 AS cval_lineitem_l_quantity_2#7847, cval_lineitem_l_extendedprice#7815 AS cval_lineitem_l_extendedprice_2#7848, cval_lineitem_l_discount#7816 AS cval_lineitem_l_discount_2#7849, cval_lineitem_l_tax#7817 AS cval_lineitem_l_tax_2#7850, cval_lineitem_l_returnflag#7818 AS cval_lineitem_l_returnflag_2#7851, cval_lineitem_l_linestatus#7819 AS cval_lineitem_l_linestatus_2#7852, cval_lineitem_l_commitdate#7820 AS cval_lineitem_l_commitdate_2#7853, cval_lineitem_l_receiptdate#7821 AS cval_lineitem_l_receiptdate_2#7854, cval_lineitem_l_shipinstruct#7822 AS cval_lineitem_l_shipinstruct_2#7855, cval_lineitem_l_shipmode#7823 AS cval_lineitem_l_shipmode_2#7856, cval_lineitem_l_comment#7824 AS cval_lineitem_l_comment_2#7857, cval_lineitem_l_shipdate#7825 AS cval_lineitem_l_shipdate_2#7858, cl_quantity#7826 AS cl_quantity_2#7859, cl_extendedprice#7827 AS cl_extendedprice_2#7860, cl_discount#7828 AS cl_discount_2#7861, ... 9 more fields]
                  :     :  :     +- Relation[rid#7805,cpfk_orders_lineitem#7806,cpfk_supplier_lineitem#7807,cfpk_lineitem_supplier#7808,cfpk_lineitem_partsupp#7809,cpfk_part_lineitem#7810,cfpk_lineitem_part#7811,cpfk_partsupp_lineitem#7812,cfpk_lineitem_orders#7813,cval_lineitem_l_quantity#7814,cval_lineitem_l_extendedprice#7815,cval_lineitem_l_discount#7816,cval_lineitem_l_tax#7817,cval_lineitem_l_returnflag#7818,cval_lineitem_l_linestatus#7819,cval_lineitem_l_commitdate#7820,cval_lineitem_l_receiptdate#7821,cval_lineitem_l_shipinstruct#7822,cval_lineitem_l_shipmode#7823,cval_lineitem_l_comment#7824,cval_lineitem_l_shipdate#7825,cl_quantity#7826,cl_extendedprice#7827,cl_discount#7828,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#7705 AS rid_2#7738, cpfk_orders_lineitem#7706 AS cpfk_orders_lineitem_2#7739, cpfk_supplier_lineitem#7707 AS cpfk_supplier_lineitem_2#7740, cfpk_lineitem_supplier#7708 AS cfpk_lineitem_supplier_2#7741, cfpk_lineitem_partsupp#7709 AS cfpk_lineitem_partsupp_2#7742, cpfk_part_lineitem#7710 AS cpfk_part_lineitem_2#7743, cfpk_lineitem_part#7711 AS cfpk_lineitem_part_2#7744, cpfk_partsupp_lineitem#7712 AS cpfk_partsupp_lineitem_2#7745, cfpk_lineitem_orders#7713 AS cfpk_lineitem_orders_2#7746, cval_lineitem_l_quantity#7714 AS cval_lineitem_l_quantity_2#7747, cval_lineitem_l_extendedprice#7715 AS cval_lineitem_l_extendedprice_2#7748, cval_lineitem_l_discount#7716 AS cval_lineitem_l_discount_2#7749, cval_lineitem_l_tax#7717 AS cval_lineitem_l_tax_2#7750, cval_lineitem_l_returnflag#7718 AS cval_lineitem_l_returnflag_2#7751, cval_lineitem_l_linestatus#7719 AS cval_lineitem_l_linestatus_2#7752, cval_lineitem_l_commitdate#7720 AS cval_lineitem_l_commitdate_2#7753, cval_lineitem_l_receiptdate#7721 AS cval_lineitem_l_receiptdate_2#7754, cval_lineitem_l_shipinstruct#7722 AS cval_lineitem_l_shipinstruct_2#7755, cval_lineitem_l_shipmode#7723 AS cval_lineitem_l_shipmode_2#7756, cval_lineitem_l_comment#7724 AS cval_lineitem_l_comment_2#7757, cval_lineitem_l_shipdate#7725 AS cval_lineitem_l_shipdate_2#7758, cl_quantity#7726 AS cl_quantity_2#7759, cl_extendedprice#7727 AS cl_extendedprice_2#7760, cl_discount#7728 AS cl_discount_2#7761, ... 9 more fields]
                  :     :     +- Relation[rid#7705,cpfk_orders_lineitem#7706,cpfk_supplier_lineitem#7707,cfpk_lineitem_supplier#7708,cfpk_lineitem_partsupp#7709,cpfk_part_lineitem#7710,cfpk_lineitem_part#7711,cpfk_partsupp_lineitem#7712,cfpk_lineitem_orders#7713,cval_lineitem_l_quantity#7714,cval_lineitem_l_extendedprice#7715,cval_lineitem_l_discount#7716,cval_lineitem_l_tax#7717,cval_lineitem_l_returnflag#7718,cval_lineitem_l_linestatus#7719,cval_lineitem_l_commitdate#7720,cval_lineitem_l_receiptdate#7721,cval_lineitem_l_shipinstruct#7722,cval_lineitem_l_shipmode#7723,cval_lineitem_l_comment#7724,cval_lineitem_l_shipdate#7725,cl_quantity#7726,cl_extendedprice#7727,cl_discount#7728,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#7871 AS rid_3#7884, cpfk_nation_supplier#7872 AS cpfk_nation_supplier_3#7885, cfpk_supplier_nation#7873 AS cfpk_supplier_nation_3#7886, cval_supplier_s_name#7874 AS cval_supplier_s_name_3#7887, cval_supplier_s_address#7875 AS cval_supplier_s_address_3#7888, cval_supplier_s_phone#7876 AS cval_supplier_s_phone_3#7889, cval_supplier_s_acctbal#7877 AS cval_supplier_s_acctbal_3#7890, cval_supplier_s_comment#7878 AS cval_supplier_s_comment_3#7891, cs_name#7879 AS cs_name_3#7892, cs_address#7880 AS cs_address_3#7893, cs_phone#7881 AS cs_phone_3#7894, cs_acctbal#7882 AS cs_acctbal_3#7895, cs_comment#7883 AS cs_comment_3#7896]
                  :        +- Relation[rid#7871,cpfk_nation_supplier#7872,cfpk_supplier_nation#7873,cval_supplier_s_name#7874,cval_supplier_s_address#7875,cval_supplier_s_phone#7876,cval_supplier_s_acctbal#7877,cval_supplier_s_comment#7878,cs_name#7879,cs_address#7880,cs_phone#7881,cs_acctbal#7882,cs_comment#7883] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#7897 AS rid_4#7904, cpfk_region_nation#7898 AS cpfk_region_nation_4#7905, cfpk_nation_region#7899 AS cfpk_nation_region_4#7906, cval_nation_n_name#7900 AS cval_nation_n_name_4#7907, cval_nation_n_comment#7901 AS cval_nation_n_comment_4#7908, cn_name#7902 AS cn_name_4#7909, cn_comment#7903 AS cn_comment_4#7910]
                     :  +- Relation[rid#7897,cpfk_region_nation#7898,cfpk_nation_region#7899,cval_nation_n_name#7900,cval_nation_n_comment#7901,cn_name#7902,cn_comment#7903] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#7911 AS rid_4#7918, cpfk_region_nation#7912 AS cpfk_region_nation_4#7919, cfpk_nation_region#7913 AS cfpk_nation_region_4#7920, cval_nation_n_name#7914 AS cval_nation_n_name_4#7921, cval_nation_n_comment#7915 AS cval_nation_n_comment_4#7922, cn_name#7916 AS cn_name_4#7923, cn_comment#7917 AS cn_comment_4#7924]
                           +- Relation[rid#7911,cpfk_region_nation#7912,cfpk_nation_region#7913,cval_nation_n_name#7914,cval_nation_n_comment#7915,cn_name#7916,cn_comment#7917] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=120762
Elapsed time: 91064ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/15 15:53:30 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:53:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8033L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:53:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#8033L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#8035 AS rid_0#8068, cpfk_orders_lineitem#8036 AS cpfk_orders_lineitem_0#8069, cpfk_supplier_lineitem#8037 AS cpfk_supplier_lineitem_0#8070, cfpk_lineitem_supplier#8038 AS cfpk_lineitem_supplier_0#8071, cfpk_lineitem_partsupp#8039 AS cfpk_lineitem_partsupp_0#8072, cpfk_part_lineitem#8040 AS cpfk_part_lineitem_0#8073, cfpk_lineitem_part#8041 AS cfpk_lineitem_part_0#8074, cpfk_partsupp_lineitem#8042 AS cpfk_partsupp_lineitem_0#8075, cfpk_lineitem_orders#8043 AS cfpk_lineitem_orders_0#8076, cval_lineitem_l_quantity#8044 AS cval_lineitem_l_quantity_0#8077, cval_lineitem_l_extendedprice#8045 AS cval_lineitem_l_extendedprice_0#8078, cval_lineitem_l_discount#8046 AS cval_lineitem_l_discount_0#8079, cval_lineitem_l_tax#8047 AS cval_lineitem_l_tax_0#8080, cval_lineitem_l_returnflag#8048 AS cval_lineitem_l_returnflag_0#8081, cval_lineitem_l_linestatus#8049 AS cval_lineitem_l_linestatus_0#8082, cval_lineitem_l_commitdate#8050 AS cval_lineitem_l_commitdate_0#8083, cval_lineitem_l_receiptdate#8051 AS cval_lineitem_l_receiptdate_0#8084, cval_lineitem_l_shipinstruct#8052 AS cval_lineitem_l_shipinstruct_0#8085, cval_lineitem_l_shipmode#8053 AS cval_lineitem_l_shipmode_0#8086, cval_lineitem_l_comment#8054 AS cval_lineitem_l_comment_0#8087, cval_lineitem_l_shipdate#8055 AS cval_lineitem_l_shipdate_0#8088, cl_quantity#8056 AS cl_quantity_0#8089, cl_extendedprice#8057 AS cl_extendedprice_0#8090, cl_discount#8058 AS cl_discount_0#8091, ... 9 more fields]
         +- Relation[rid#8035,cpfk_orders_lineitem#8036,cpfk_supplier_lineitem#8037,cfpk_lineitem_supplier#8038,cfpk_lineitem_partsupp#8039,cpfk_part_lineitem#8040,cfpk_lineitem_part#8041,cpfk_partsupp_lineitem#8042,cfpk_lineitem_orders#8043,cval_lineitem_l_quantity#8044,cval_lineitem_l_extendedprice#8045,cval_lineitem_l_discount#8046,cval_lineitem_l_tax#8047,cval_lineitem_l_returnflag#8048,cval_lineitem_l_linestatus#8049,cval_lineitem_l_commitdate#8050,cval_lineitem_l_receiptdate#8051,cval_lineitem_l_shipinstruct#8052,cval_lineitem_l_shipmode#8053,cval_lineitem_l_comment#8054,cval_lineitem_l_shipdate#8055,cl_quantity#8056,cl_extendedprice#8057,cl_discount#8058,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2796ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/15 15:53:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:53:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8138L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:53:33 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:53:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8138L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#8140 AS rid_0#8145, cval_region_r_name#8141 AS cval_region_r_name_0#8146, cval_region_r_comment#8142 AS cval_region_r_comment_0#8147, cr_name#8143 AS cr_name_0#8148, cr_comment#8144 AS cr_comment_0#8149]
         :  :  :  :  :  :  :  +- Relation[rid#8140,cval_region_r_name#8141,cval_region_r_comment#8142,cr_name#8143,cr_comment#8144] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#8150 AS rid_0#8155, cval_region_r_name#8151 AS cval_region_r_name_0#8156, cval_region_r_comment#8152 AS cval_region_r_comment_0#8157, cr_name#8153 AS cr_name_0#8158, cr_comment#8154 AS cr_comment_0#8159]
         :  :  :  :  :  :        +- Relation[rid#8150,cval_region_r_name#8151,cval_region_r_comment#8152,cr_name#8153,cr_comment#8154] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- Project [rid#8184 AS rid_1#8191, cpfk_region_nation#8185 AS cpfk_region_nation_1#8192, cfpk_nation_region#8186 AS cfpk_nation_region_1#8193, cval_nation_n_name#8187 AS cval_nation_n_name_1#8194, cval_nation_n_comment#8188 AS cval_nation_n_comment_1#8195, cn_name#8189 AS cn_name_1#8196, cn_comment#8190 AS cn_comment_1#8197]
         :  :  :  :  :     +- Relation[rid#8184,cpfk_region_nation#8185,cfpk_nation_region#8186,cval_nation_n_name#8187,cval_nation_n_comment#8188,cn_name#8189,cn_comment#8190] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#8160 AS rid_1#8167, cpfk_region_nation#8161 AS cpfk_region_nation_1#8168, cfpk_nation_region#8162 AS cfpk_nation_region_1#8169, cval_nation_n_name#8163 AS cval_nation_n_name_1#8170, cval_nation_n_comment#8164 AS cval_nation_n_comment_1#8171, cn_name#8165 AS cn_name_1#8172, cn_comment#8166 AS cn_comment_1#8173]
         :  :  :  :     +- Relation[rid#8160,cpfk_region_nation#8161,cfpk_nation_region#8162,cval_nation_n_name#8163,cval_nation_n_comment#8164,cn_name#8165,cn_comment#8166] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#8238 AS rid_2#8251, cpfk_nation_supplier#8239 AS cpfk_nation_supplier_2#8252, cfpk_supplier_nation#8240 AS cfpk_supplier_nation_2#8253, cval_supplier_s_name#8241 AS cval_supplier_s_name_2#8254, cval_supplier_s_address#8242 AS cval_supplier_s_address_2#8255, cval_supplier_s_phone#8243 AS cval_supplier_s_phone_2#8256, cval_supplier_s_acctbal#8244 AS cval_supplier_s_acctbal_2#8257, cval_supplier_s_comment#8245 AS cval_supplier_s_comment_2#8258, cs_name#8246 AS cs_name_2#8259, cs_address#8247 AS cs_address_2#8260, cs_phone#8248 AS cs_phone_2#8261, cs_acctbal#8249 AS cs_acctbal_2#8262, cs_comment#8250 AS cs_comment_2#8263]
         :  :  :     +- Relation[rid#8238,cpfk_nation_supplier#8239,cfpk_supplier_nation#8240,cval_supplier_s_name#8241,cval_supplier_s_address#8242,cval_supplier_s_phone#8243,cval_supplier_s_acctbal#8244,cval_supplier_s_comment#8245,cs_name#8246,cs_address#8247,cs_phone#8248,cs_acctbal#8249,cs_comment#8250] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#8198 AS rid_2#8211, cpfk_nation_supplier#8199 AS cpfk_nation_supplier_2#8212, cfpk_supplier_nation#8200 AS cfpk_supplier_nation_2#8213, cval_supplier_s_name#8201 AS cval_supplier_s_name_2#8214, cval_supplier_s_address#8202 AS cval_supplier_s_address_2#8215, cval_supplier_s_phone#8203 AS cval_supplier_s_phone_2#8216, cval_supplier_s_acctbal#8204 AS cval_supplier_s_acctbal_2#8217, cval_supplier_s_comment#8205 AS cval_supplier_s_comment_2#8218, cs_name#8206 AS cs_name_2#8219, cs_address#8207 AS cs_address_2#8220, cs_phone#8208 AS cs_phone_2#8221, cs_acctbal#8209 AS cs_acctbal_2#8222, cs_comment#8210 AS cs_comment_2#8223]
         :  :     +- Relation[rid#8198,cpfk_nation_supplier#8199,cfpk_supplier_nation#8200,cval_supplier_s_name#8201,cval_supplier_s_address#8202,cval_supplier_s_phone#8203,cval_supplier_s_acctbal#8204,cval_supplier_s_comment#8205,cs_name#8206,cs_address#8207,cs_phone#8208,cs_acctbal#8209,cs_comment#8210] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#8436 AS rid_4#8447, cpfk_part_partsupp#8437 AS cpfk_part_partsupp_4#8448, cfpk_partsupp_part#8438 AS cfpk_partsupp_part_4#8449, cpfk_supplier_partsupp#8439 AS cpfk_supplier_partsupp_4#8450, cfpk_partsupp_supplier#8440 AS cfpk_partsupp_supplier_4#8451, cval_partsupp_ps_availqty#8441 AS cval_partsupp_ps_availqty_4#8452, cval_partsupp_ps_supplycost#8442 AS cval_partsupp_ps_supplycost_4#8453, cval_partsupp_ps_comment#8443 AS cval_partsupp_ps_comment_4#8454, cps_availqty#8444 AS cps_availqty_4#8455, cps_supplycost#8445 AS cps_supplycost_4#8456, cps_comment#8446 AS cps_comment_4#8457]
         :     +- Relation[rid#8436,cpfk_part_partsupp#8437,cfpk_partsupp_part#8438,cpfk_supplier_partsupp#8439,cfpk_partsupp_supplier#8440,cval_partsupp_ps_availqty#8441,cval_partsupp_ps_supplycost#8442,cval_partsupp_ps_comment#8443,cps_availqty#8444,cps_supplycost#8445,cps_comment#8446] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#8264 AS rid_3#8281, cval_part_p_name#8265 AS cval_part_p_name_3#8282, cval_part_p_mfgr#8266 AS cval_part_p_mfgr_3#8283, cval_part_p_type#8267 AS cval_part_p_type_3#8284, cval_part_p_size#8268 AS cval_part_p_size_3#8285, cval_part_p_container#8269 AS cval_part_p_container_3#8286, cval_part_p_retailprice#8270 AS cval_part_p_retailprice_3#8287, cval_part_p_comment#8271 AS cval_part_p_comment_3#8288, cval_part_p_brand#8272 AS cval_part_p_brand_3#8289, cp_name#8273 AS cp_name_3#8290, cp_mfgr#8274 AS cp_mfgr_3#8291, cp_type#8275 AS cp_type_3#8292, cp_size#8276 AS cp_size_3#8293, cp_container#8277 AS cp_container_3#8294, cp_retailprice#8278 AS cp_retailprice_3#8295, cp_comment#8279 AS cp_comment_3#8296, cp_brand#8280 AS cp_brand_3#8297]
            :  :  :  +- Relation[rid#8264,cval_part_p_name#8265,cval_part_p_mfgr#8266,cval_part_p_type#8267,cval_part_p_size#8268,cval_part_p_container#8269,cval_part_p_retailprice#8270,cval_part_p_comment#8271,cval_part_p_brand#8272,cp_name#8273,cp_mfgr#8274,cp_type#8275,cp_size#8276,cp_container#8277,cp_retailprice#8278,cp_comment#8279,cp_brand#8280] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#8298 AS rid_3#8315, cval_part_p_name#8299 AS cval_part_p_name_3#8316, cval_part_p_mfgr#8300 AS cval_part_p_mfgr_3#8317, cval_part_p_type#8301 AS cval_part_p_type_3#8318, cval_part_p_size#8302 AS cval_part_p_size_3#8319, cval_part_p_container#8303 AS cval_part_p_container_3#8320, cval_part_p_retailprice#8304 AS cval_part_p_retailprice_3#8321, cval_part_p_comment#8305 AS cval_part_p_comment_3#8322, cval_part_p_brand#8306 AS cval_part_p_brand_3#8323, cp_name#8307 AS cp_name_3#8324, cp_mfgr#8308 AS cp_mfgr_3#8325, cp_type#8309 AS cp_type_3#8326, cp_size#8310 AS cp_size_3#8327, cp_container#8311 AS cp_container_3#8328, cp_retailprice#8312 AS cp_retailprice_3#8329, cp_comment#8313 AS cp_comment_3#8330, cp_brand#8314 AS cp_brand_3#8331]
            :  :        +- Relation[rid#8298,cval_part_p_name#8299,cval_part_p_mfgr#8300,cval_part_p_type#8301,cval_part_p_size#8302,cval_part_p_container#8303,cval_part_p_retailprice#8304,cval_part_p_comment#8305,cval_part_p_brand#8306,cp_name#8307,cp_mfgr#8308,cp_type#8309,cp_size#8310,cp_container#8311,cp_retailprice#8312,cp_comment#8313,cp_brand#8314] JDBCRelation(tpart) [numPartitions=1]
            :  +- Project [rid#8388 AS rid_4#8399, cpfk_part_partsupp#8389 AS cpfk_part_partsupp_4#8400, cfpk_partsupp_part#8390 AS cfpk_partsupp_part_4#8401, cpfk_supplier_partsupp#8391 AS cpfk_supplier_partsupp_4#8402, cfpk_partsupp_supplier#8392 AS cfpk_partsupp_supplier_4#8403, cval_partsupp_ps_availqty#8393 AS cval_partsupp_ps_availqty_4#8404, cval_partsupp_ps_supplycost#8394 AS cval_partsupp_ps_supplycost_4#8405, cval_partsupp_ps_comment#8395 AS cval_partsupp_ps_comment_4#8406, cps_availqty#8396 AS cps_availqty_4#8407, cps_supplycost#8397 AS cps_supplycost_4#8408, cps_comment#8398 AS cps_comment_4#8409]
            :     +- Relation[rid#8388,cpfk_part_partsupp#8389,cfpk_partsupp_part#8390,cpfk_supplier_partsupp#8391,cfpk_partsupp_supplier#8392,cval_partsupp_ps_availqty#8393,cval_partsupp_ps_supplycost#8394,cval_partsupp_ps_comment#8395,cps_availqty#8396,cps_supplycost#8397,cps_comment#8398] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#8332 AS rid_4#8343, cpfk_part_partsupp#8333 AS cpfk_part_partsupp_4#8344, cfpk_partsupp_part#8334 AS cfpk_partsupp_part_4#8345, cpfk_supplier_partsupp#8335 AS cpfk_supplier_partsupp_4#8346, cfpk_partsupp_supplier#8336 AS cfpk_partsupp_supplier_4#8347, cval_partsupp_ps_availqty#8337 AS cval_partsupp_ps_availqty_4#8348, cval_partsupp_ps_supplycost#8338 AS cval_partsupp_ps_supplycost_4#8349, cval_partsupp_ps_comment#8339 AS cval_partsupp_ps_comment_4#8350, cps_availqty#8340 AS cps_availqty_4#8351, cps_supplycost#8341 AS cps_supplycost_4#8352, cps_comment#8342 AS cps_comment_4#8353]
               +- Relation[rid#8332,cpfk_part_partsupp#8333,cfpk_partsupp_part#8334,cpfk_supplier_partsupp#8335,cfpk_partsupp_supplier#8336,cval_partsupp_ps_availqty#8337,cval_partsupp_ps_supplycost#8338,cval_partsupp_ps_comment#8339,cps_availqty#8340,cps_supplycost#8341,cps_comment#8342] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 8198ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/15 15:53:41 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:53:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8518L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:53:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:53:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:53:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:53:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8518L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#8520 AS rid_0#8533, cpfk_nation_supplier#8521 AS cpfk_nation_supplier_0#8534, cfpk_supplier_nation#8522 AS cfpk_supplier_nation_0#8535, cval_supplier_s_name#8523 AS cval_supplier_s_name_0#8536, cval_supplier_s_address#8524 AS cval_supplier_s_address_0#8537, cval_supplier_s_phone#8525 AS cval_supplier_s_phone_0#8538, cval_supplier_s_acctbal#8526 AS cval_supplier_s_acctbal_0#8539, cval_supplier_s_comment#8527 AS cval_supplier_s_comment_0#8540, cs_name#8528 AS cs_name_0#8541, cs_address#8529 AS cs_address_0#8542, cs_phone#8530 AS cs_phone_0#8543, cs_acctbal#8531 AS cs_acctbal_0#8544, cs_comment#8532 AS cs_comment_0#8545]
         :  :  +- Relation[rid#8520,cpfk_nation_supplier#8521,cfpk_supplier_nation#8522,cval_supplier_s_name#8523,cval_supplier_s_address#8524,cval_supplier_s_phone#8525,cval_supplier_s_acctbal#8526,cval_supplier_s_comment#8527,cs_name#8528,cs_address#8529,cs_phone#8530,cs_acctbal#8531,cs_comment#8532] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#8612 AS rid_0#8625, cpfk_nation_supplier#8613 AS cpfk_nation_supplier_0#8626, cfpk_supplier_nation#8614 AS cfpk_supplier_nation_0#8627, cval_supplier_s_name#8615 AS cval_supplier_s_name_0#8628, cval_supplier_s_address#8616 AS cval_supplier_s_address_0#8629, cval_supplier_s_phone#8617 AS cval_supplier_s_phone_0#8630, cval_supplier_s_acctbal#8618 AS cval_supplier_s_acctbal_0#8631, cval_supplier_s_comment#8619 AS cval_supplier_s_comment_0#8632, cs_name#8620 AS cs_name_0#8633, cs_address#8621 AS cs_address_0#8634, cs_phone#8622 AS cs_phone_0#8635, cs_acctbal#8623 AS cs_acctbal_0#8636, cs_comment#8624 AS cs_comment_0#8637]
         :     :  +- Relation[rid#8612,cpfk_nation_supplier#8613,cfpk_supplier_nation#8614,cval_supplier_s_name#8615,cval_supplier_s_address#8616,cval_supplier_s_phone#8617,cval_supplier_s_acctbal#8618,cval_supplier_s_comment#8619,cs_name#8620,cs_address#8621,cs_phone#8622,cs_acctbal#8623,cs_comment#8624] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#8638 AS rid_1#8671, cpfk_orders_lineitem#8639 AS cpfk_orders_lineitem_1#8672, cpfk_supplier_lineitem#8640 AS cpfk_supplier_lineitem_1#8673, cfpk_lineitem_supplier#8641 AS cfpk_lineitem_supplier_1#8674, cfpk_lineitem_partsupp#8642 AS cfpk_lineitem_partsupp_1#8675, cpfk_part_lineitem#8643 AS cpfk_part_lineitem_1#8676, cfpk_lineitem_part#8644 AS cfpk_lineitem_part_1#8677, cpfk_partsupp_lineitem#8645 AS cpfk_partsupp_lineitem_1#8678, cfpk_lineitem_orders#8646 AS cfpk_lineitem_orders_1#8679, cval_lineitem_l_quantity#8647 AS cval_lineitem_l_quantity_1#8680, cval_lineitem_l_extendedprice#8648 AS cval_lineitem_l_extendedprice_1#8681, cval_lineitem_l_discount#8649 AS cval_lineitem_l_discount_1#8682, cval_lineitem_l_tax#8650 AS cval_lineitem_l_tax_1#8683, cval_lineitem_l_returnflag#8651 AS cval_lineitem_l_returnflag_1#8684, cval_lineitem_l_linestatus#8652 AS cval_lineitem_l_linestatus_1#8685, cval_lineitem_l_commitdate#8653 AS cval_lineitem_l_commitdate_1#8686, cval_lineitem_l_receiptdate#8654 AS cval_lineitem_l_receiptdate_1#8687, cval_lineitem_l_shipinstruct#8655 AS cval_lineitem_l_shipinstruct_1#8688, cval_lineitem_l_shipmode#8656 AS cval_lineitem_l_shipmode_1#8689, cval_lineitem_l_comment#8657 AS cval_lineitem_l_comment_1#8690, cval_lineitem_l_shipdate#8658 AS cval_lineitem_l_shipdate_1#8691, cl_quantity#8659 AS cl_quantity_1#8692, cl_extendedprice#8660 AS cl_extendedprice_1#8693, cl_discount#8661 AS cl_discount_1#8694, ... 9 more fields]
         :        +- Relation[rid#8638,cpfk_orders_lineitem#8639,cpfk_supplier_lineitem#8640,cfpk_lineitem_supplier#8641,cfpk_lineitem_partsupp#8642,cpfk_part_lineitem#8643,cfpk_lineitem_part#8644,cpfk_partsupp_lineitem#8645,cfpk_lineitem_orders#8646,cval_lineitem_l_quantity#8647,cval_lineitem_l_extendedprice#8648,cval_lineitem_l_discount#8649,cval_lineitem_l_tax#8650,cval_lineitem_l_returnflag#8651,cval_lineitem_l_linestatus#8652,cval_lineitem_l_commitdate#8653,cval_lineitem_l_receiptdate#8654,cval_lineitem_l_shipinstruct#8655,cval_lineitem_l_shipmode#8656,cval_lineitem_l_comment#8657,cval_lineitem_l_shipdate#8658,cl_quantity#8659,cl_extendedprice#8660,cl_discount#8661,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8546 AS rid_1#8579, cpfk_orders_lineitem#8547 AS cpfk_orders_lineitem_1#8580, cpfk_supplier_lineitem#8548 AS cpfk_supplier_lineitem_1#8581, cfpk_lineitem_supplier#8549 AS cfpk_lineitem_supplier_1#8582, cfpk_lineitem_partsupp#8550 AS cfpk_lineitem_partsupp_1#8583, cpfk_part_lineitem#8551 AS cpfk_part_lineitem_1#8584, cfpk_lineitem_part#8552 AS cfpk_lineitem_part_1#8585, cpfk_partsupp_lineitem#8553 AS cpfk_partsupp_lineitem_1#8586, cfpk_lineitem_orders#8554 AS cfpk_lineitem_orders_1#8587, cval_lineitem_l_quantity#8555 AS cval_lineitem_l_quantity_1#8588, cval_lineitem_l_extendedprice#8556 AS cval_lineitem_l_extendedprice_1#8589, cval_lineitem_l_discount#8557 AS cval_lineitem_l_discount_1#8590, cval_lineitem_l_tax#8558 AS cval_lineitem_l_tax_1#8591, cval_lineitem_l_returnflag#8559 AS cval_lineitem_l_returnflag_1#8592, cval_lineitem_l_linestatus#8560 AS cval_lineitem_l_linestatus_1#8593, cval_lineitem_l_commitdate#8561 AS cval_lineitem_l_commitdate_1#8594, cval_lineitem_l_receiptdate#8562 AS cval_lineitem_l_receiptdate_1#8595, cval_lineitem_l_shipinstruct#8563 AS cval_lineitem_l_shipinstruct_1#8596, cval_lineitem_l_shipmode#8564 AS cval_lineitem_l_shipmode_1#8597, cval_lineitem_l_comment#8565 AS cval_lineitem_l_comment_1#8598, cval_lineitem_l_shipdate#8566 AS cval_lineitem_l_shipdate_1#8599, cl_quantity#8567 AS cl_quantity_1#8600, cl_extendedprice#8568 AS cl_extendedprice_1#8601, cl_discount#8569 AS cl_discount_1#8602, ... 9 more fields]
            +- Relation[rid#8546,cpfk_orders_lineitem#8547,cpfk_supplier_lineitem#8548,cfpk_lineitem_supplier#8549,cfpk_lineitem_partsupp#8550,cpfk_part_lineitem#8551,cfpk_lineitem_part#8552,cpfk_partsupp_lineitem#8553,cfpk_lineitem_orders#8554,cval_lineitem_l_quantity#8555,cval_lineitem_l_extendedprice#8556,cval_lineitem_l_discount#8557,cval_lineitem_l_tax#8558,cval_lineitem_l_returnflag#8559,cval_lineitem_l_linestatus#8560,cval_lineitem_l_commitdate#8561,cval_lineitem_l_receiptdate#8562,cval_lineitem_l_shipinstruct#8563,cval_lineitem_l_shipmode#8564,cval_lineitem_l_comment#8565,cval_lineitem_l_shipdate#8566,cl_quantity#8567,cl_extendedprice#8568,cl_discount#8569,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 84721ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/15 15:55:06 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:55:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8755L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:55:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#8755L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#8757 AS rid_0#8790, cpfk_orders_lineitem#8758 AS cpfk_orders_lineitem_0#8791, cpfk_supplier_lineitem#8759 AS cpfk_supplier_lineitem_0#8792, cfpk_lineitem_supplier#8760 AS cfpk_lineitem_supplier_0#8793, cfpk_lineitem_partsupp#8761 AS cfpk_lineitem_partsupp_0#8794, cpfk_part_lineitem#8762 AS cpfk_part_lineitem_0#8795, cfpk_lineitem_part#8763 AS cfpk_lineitem_part_0#8796, cpfk_partsupp_lineitem#8764 AS cpfk_partsupp_lineitem_0#8797, cfpk_lineitem_orders#8765 AS cfpk_lineitem_orders_0#8798, cval_lineitem_l_quantity#8766 AS cval_lineitem_l_quantity_0#8799, cval_lineitem_l_extendedprice#8767 AS cval_lineitem_l_extendedprice_0#8800, cval_lineitem_l_discount#8768 AS cval_lineitem_l_discount_0#8801, cval_lineitem_l_tax#8769 AS cval_lineitem_l_tax_0#8802, cval_lineitem_l_returnflag#8770 AS cval_lineitem_l_returnflag_0#8803, cval_lineitem_l_linestatus#8771 AS cval_lineitem_l_linestatus_0#8804, cval_lineitem_l_commitdate#8772 AS cval_lineitem_l_commitdate_0#8805, cval_lineitem_l_receiptdate#8773 AS cval_lineitem_l_receiptdate_0#8806, cval_lineitem_l_shipinstruct#8774 AS cval_lineitem_l_shipinstruct_0#8807, cval_lineitem_l_shipmode#8775 AS cval_lineitem_l_shipmode_0#8808, cval_lineitem_l_comment#8776 AS cval_lineitem_l_comment_0#8809, cval_lineitem_l_shipdate#8777 AS cval_lineitem_l_shipdate_0#8810, cl_quantity#8778 AS cl_quantity_0#8811, cl_extendedprice#8779 AS cl_extendedprice_0#8812, cl_discount#8780 AS cl_discount_0#8813, ... 9 more fields]
         +- Relation[rid#8757,cpfk_orders_lineitem#8758,cpfk_supplier_lineitem#8759,cfpk_lineitem_supplier#8760,cfpk_lineitem_partsupp#8761,cpfk_part_lineitem#8762,cfpk_lineitem_part#8763,cpfk_partsupp_lineitem#8764,cfpk_lineitem_orders#8765,cval_lineitem_l_quantity#8766,cval_lineitem_l_extendedprice#8767,cval_lineitem_l_discount#8768,cval_lineitem_l_tax#8769,cval_lineitem_l_returnflag#8770,cval_lineitem_l_linestatus#8771,cval_lineitem_l_commitdate#8772,cval_lineitem_l_receiptdate#8773,cval_lineitem_l_shipinstruct#8774,cval_lineitem_l_shipmode#8775,cval_lineitem_l_comment#8776,cval_lineitem_l_shipdate#8777,cl_quantity#8778,cl_extendedprice#8779,cl_discount#8780,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2814ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/15 15:55:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:55:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8862L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 15:55:09 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:55:09 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:55:09 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:55:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:55:09 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:55:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:55:09 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:55:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:55:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:55:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:55:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:55:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:55:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:55:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:55:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:55:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:55:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8862L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#8864 AS rid_0#8869, cval_region_r_name#8865 AS cval_region_r_name_0#8870, cval_region_r_comment#8866 AS cval_region_r_comment_0#8871, cr_name#8867 AS cr_name_0#8872, cr_comment#8868 AS cr_comment_0#8873]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#8864,cval_region_r_name#8865,cval_region_r_comment#8866,cr_name#8867,cr_comment#8868] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#8874 AS rid_0#8879, cval_region_r_name#8875 AS cval_region_r_name_0#8880, cval_region_r_comment#8876 AS cval_region_r_comment_0#8881, cr_name#8877 AS cr_name_0#8882, cr_comment#8878 AS cr_comment_0#8883]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#8874,cval_region_r_name#8875,cval_region_r_comment#8876,cr_name#8877,cr_comment#8878] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- Project [rid#8908 AS rid_1#8915, cpfk_region_nation#8909 AS cpfk_region_nation_1#8916, cfpk_nation_region#8910 AS cfpk_nation_region_1#8917, cval_nation_n_name#8911 AS cval_nation_n_name_1#8918, cval_nation_n_comment#8912 AS cval_nation_n_comment_1#8919, cn_name#8913 AS cn_name_1#8920, cn_comment#8914 AS cn_comment_1#8921]
         :     :  :  :  :  :  :  :  :     +- Relation[rid#8908,cpfk_region_nation#8909,cfpk_nation_region#8910,cval_nation_n_name#8911,cval_nation_n_comment#8912,cn_name#8913,cn_comment#8914] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#8884 AS rid_1#8891, cpfk_region_nation#8885 AS cpfk_region_nation_1#8892, cfpk_nation_region#8886 AS cfpk_nation_region_1#8893, cval_nation_n_name#8887 AS cval_nation_n_name_1#8894, cval_nation_n_comment#8888 AS cval_nation_n_comment_1#8895, cn_name#8889 AS cn_name_1#8896, cn_comment#8890 AS cn_comment_1#8897]
         :     :  :  :  :  :  :  :     +- Relation[rid#8884,cpfk_region_nation#8885,cfpk_nation_region#8886,cval_nation_n_name#8887,cval_nation_n_comment#8888,cn_name#8889,cn_comment#8890] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- Project [rid#8966 AS rid_2#8981, cpfk_nation_customer#8967 AS cpfk_nation_customer_2#8982, cfpk_customer_nation#8968 AS cfpk_customer_nation_2#8983, cval_customer_c_name#8969 AS cval_customer_c_name_2#8984, cval_customer_c_address#8970 AS cval_customer_c_address_2#8985, cval_customer_c_phone#8971 AS cval_customer_c_phone_2#8986, cval_customer_c_acctbal#8972 AS cval_customer_c_acctbal_2#8987, cval_customer_c_comment#8973 AS cval_customer_c_comment_2#8988, cval_customer_c_mktsegment#8974 AS cval_customer_c_mktsegment_2#8989, cc_name#8975 AS cc_name_2#8990, cc_address#8976 AS cc_address_2#8991, cc_phone#8977 AS cc_phone_2#8992, cc_acctbal#8978 AS cc_acctbal_2#8993, cc_comment#8979 AS cc_comment_2#8994, cc_mktsegment#8980 AS cc_mktsegment_2#8995]
         :     :  :  :  :  :  :     +- Relation[rid#8966,cpfk_nation_customer#8967,cfpk_customer_nation#8968,cval_customer_c_name#8969,cval_customer_c_address#8970,cval_customer_c_phone#8971,cval_customer_c_acctbal#8972,cval_customer_c_comment#8973,cval_customer_c_mktsegment#8974,cc_name#8975,cc_address#8976,cc_phone#8977,cc_acctbal#8978,cc_comment#8979,cc_mktsegment#8980] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#8922 AS rid_2#8937, cpfk_nation_customer#8923 AS cpfk_nation_customer_2#8938, cfpk_customer_nation#8924 AS cfpk_customer_nation_2#8939, cval_customer_c_name#8925 AS cval_customer_c_name_2#8940, cval_customer_c_address#8926 AS cval_customer_c_address_2#8941, cval_customer_c_phone#8927 AS cval_customer_c_phone_2#8942, cval_customer_c_acctbal#8928 AS cval_customer_c_acctbal_2#8943, cval_customer_c_comment#8929 AS cval_customer_c_comment_2#8944, cval_customer_c_mktsegment#8930 AS cval_customer_c_mktsegment_2#8945, cc_name#8931 AS cc_name_2#8946, cc_address#8932 AS cc_address_2#8947, cc_phone#8933 AS cc_phone_2#8948, cc_acctbal#8934 AS cc_acctbal_2#8949, cc_comment#8935 AS cc_comment_2#8950, cc_mktsegment#8936 AS cc_mktsegment_2#8951]
         :     :  :  :  :  :     +- Relation[rid#8922,cpfk_nation_customer#8923,cfpk_customer_nation#8924,cval_customer_c_name#8925,cval_customer_c_address#8926,cval_customer_c_phone#8927,cval_customer_c_acctbal#8928,cval_customer_c_comment#8929,cval_customer_c_mktsegment#8930,cc_name#8931,cc_address#8932,cc_phone#8933,cc_acctbal#8934,cc_comment#8935,cc_mktsegment#8936] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- Project [rid#9060 AS rid_3#9077, cpfk_customer_orders#9061 AS cpfk_customer_orders_3#9078, cfpk_orders_customer#9062 AS cfpk_orders_customer_3#9079, cval_orders_o_orderstatus#9063 AS cval_orders_o_orderstatus_3#9080, cval_orders_o_totalprice#9064 AS cval_orders_o_totalprice_3#9081, cval_orders_o_orderpriority#9065 AS cval_orders_o_orderpriority_3#9082, cval_orders_o_clerk#9066 AS cval_orders_o_clerk_3#9083, cval_orders_o_shippriority#9067 AS cval_orders_o_shippriority_3#9084, cval_orders_o_comment#9068 AS cval_orders_o_comment_3#9085, cval_orders_o_orderdate#9069 AS cval_orders_o_orderdate_3#9086, co_orderstatus#9070 AS co_orderstatus_3#9087, co_totalprice#9071 AS co_totalprice_3#9088, co_orderpriority#9072 AS co_orderpriority_3#9089, co_clerk#9073 AS co_clerk_3#9090, co_shippriority#9074 AS co_shippriority_3#9091, co_comment#9075 AS co_comment_3#9092, co_orderdate#9076 AS co_orderdate_3#9093]
         :     :  :  :  :     +- Relation[rid#9060,cpfk_customer_orders#9061,cfpk_orders_customer#9062,cval_orders_o_orderstatus#9063,cval_orders_o_totalprice#9064,cval_orders_o_orderpriority#9065,cval_orders_o_clerk#9066,cval_orders_o_shippriority#9067,cval_orders_o_comment#9068,cval_orders_o_orderdate#9069,co_orderstatus#9070,co_totalprice#9071,co_orderpriority#9072,co_clerk#9073,co_shippriority#9074,co_comment#9075,co_orderdate#9076] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#8996 AS rid_3#9013, cpfk_customer_orders#8997 AS cpfk_customer_orders_3#9014, cfpk_orders_customer#8998 AS cfpk_orders_customer_3#9015, cval_orders_o_orderstatus#8999 AS cval_orders_o_orderstatus_3#9016, cval_orders_o_totalprice#9000 AS cval_orders_o_totalprice_3#9017, cval_orders_o_orderpriority#9001 AS cval_orders_o_orderpriority_3#9018, cval_orders_o_clerk#9002 AS cval_orders_o_clerk_3#9019, cval_orders_o_shippriority#9003 AS cval_orders_o_shippriority_3#9020, cval_orders_o_comment#9004 AS cval_orders_o_comment_3#9021, cval_orders_o_orderdate#9005 AS cval_orders_o_orderdate_3#9022, co_orderstatus#9006 AS co_orderstatus_3#9023, co_totalprice#9007 AS co_totalprice_3#9024, co_orderpriority#9008 AS co_orderpriority_3#9025, co_clerk#9009 AS co_clerk_3#9026, co_shippriority#9010 AS co_shippriority_3#9027, co_comment#9011 AS co_comment_3#9028, co_orderdate#9012 AS co_orderdate_3#9029]
         :     :  :  :     +- Relation[rid#8996,cpfk_customer_orders#8997,cfpk_orders_customer#8998,cval_orders_o_orderstatus#8999,cval_orders_o_totalprice#9000,cval_orders_o_orderpriority#9001,cval_orders_o_clerk#9002,cval_orders_o_shippriority#9003,cval_orders_o_comment#9004,cval_orders_o_orderdate#9005,co_orderstatus#9006,co_totalprice#9007,co_orderpriority#9008,co_clerk#9009,co_shippriority#9010,co_comment#9011,co_orderdate#9012] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- Project [rid#9194 AS rid_4#9227, cpfk_orders_lineitem#9195 AS cpfk_orders_lineitem_4#9228, cpfk_supplier_lineitem#9196 AS cpfk_supplier_lineitem_4#9229, cfpk_lineitem_supplier#9197 AS cfpk_lineitem_supplier_4#9230, cfpk_lineitem_partsupp#9198 AS cfpk_lineitem_partsupp_4#9231, cpfk_part_lineitem#9199 AS cpfk_part_lineitem_4#9232, cfpk_lineitem_part#9200 AS cfpk_lineitem_part_4#9233, cpfk_partsupp_lineitem#9201 AS cpfk_partsupp_lineitem_4#9234, cfpk_lineitem_orders#9202 AS cfpk_lineitem_orders_4#9235, cval_lineitem_l_quantity#9203 AS cval_lineitem_l_quantity_4#9236, cval_lineitem_l_extendedprice#9204 AS cval_lineitem_l_extendedprice_4#9237, cval_lineitem_l_discount#9205 AS cval_lineitem_l_discount_4#9238, cval_lineitem_l_tax#9206 AS cval_lineitem_l_tax_4#9239, cval_lineitem_l_returnflag#9207 AS cval_lineitem_l_returnflag_4#9240, cval_lineitem_l_linestatus#9208 AS cval_lineitem_l_linestatus_4#9241, cval_lineitem_l_commitdate#9209 AS cval_lineitem_l_commitdate_4#9242, cval_lineitem_l_receiptdate#9210 AS cval_lineitem_l_receiptdate_4#9243, cval_lineitem_l_shipinstruct#9211 AS cval_lineitem_l_shipinstruct_4#9244, cval_lineitem_l_shipmode#9212 AS cval_lineitem_l_shipmode_4#9245, cval_lineitem_l_comment#9213 AS cval_lineitem_l_comment_4#9246, cval_lineitem_l_shipdate#9214 AS cval_lineitem_l_shipdate_4#9247, cl_quantity#9215 AS cl_quantity_4#9248, cl_extendedprice#9216 AS cl_extendedprice_4#9249, cl_discount#9217 AS cl_discount_4#9250, ... 9 more fields]
         :     :  :     +- Relation[rid#9194,cpfk_orders_lineitem#9195,cpfk_supplier_lineitem#9196,cfpk_lineitem_supplier#9197,cfpk_lineitem_partsupp#9198,cpfk_part_lineitem#9199,cfpk_lineitem_part#9200,cpfk_partsupp_lineitem#9201,cfpk_lineitem_orders#9202,cval_lineitem_l_quantity#9203,cval_lineitem_l_extendedprice#9204,cval_lineitem_l_discount#9205,cval_lineitem_l_tax#9206,cval_lineitem_l_returnflag#9207,cval_lineitem_l_linestatus#9208,cval_lineitem_l_commitdate#9209,cval_lineitem_l_receiptdate#9210,cval_lineitem_l_shipinstruct#9211,cval_lineitem_l_shipmode#9212,cval_lineitem_l_comment#9213,cval_lineitem_l_shipdate#9214,cl_quantity#9215,cl_extendedprice#9216,cl_discount#9217,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#9094 AS rid_4#9127, cpfk_orders_lineitem#9095 AS cpfk_orders_lineitem_4#9128, cpfk_supplier_lineitem#9096 AS cpfk_supplier_lineitem_4#9129, cfpk_lineitem_supplier#9097 AS cfpk_lineitem_supplier_4#9130, cfpk_lineitem_partsupp#9098 AS cfpk_lineitem_partsupp_4#9131, cpfk_part_lineitem#9099 AS cpfk_part_lineitem_4#9132, cfpk_lineitem_part#9100 AS cfpk_lineitem_part_4#9133, cpfk_partsupp_lineitem#9101 AS cpfk_partsupp_lineitem_4#9134, cfpk_lineitem_orders#9102 AS cfpk_lineitem_orders_4#9135, cval_lineitem_l_quantity#9103 AS cval_lineitem_l_quantity_4#9136, cval_lineitem_l_extendedprice#9104 AS cval_lineitem_l_extendedprice_4#9137, cval_lineitem_l_discount#9105 AS cval_lineitem_l_discount_4#9138, cval_lineitem_l_tax#9106 AS cval_lineitem_l_tax_4#9139, cval_lineitem_l_returnflag#9107 AS cval_lineitem_l_returnflag_4#9140, cval_lineitem_l_linestatus#9108 AS cval_lineitem_l_linestatus_4#9141, cval_lineitem_l_commitdate#9109 AS cval_lineitem_l_commitdate_4#9142, cval_lineitem_l_receiptdate#9110 AS cval_lineitem_l_receiptdate_4#9143, cval_lineitem_l_shipinstruct#9111 AS cval_lineitem_l_shipinstruct_4#9144, cval_lineitem_l_shipmode#9112 AS cval_lineitem_l_shipmode_4#9145, cval_lineitem_l_comment#9113 AS cval_lineitem_l_comment_4#9146, cval_lineitem_l_shipdate#9114 AS cval_lineitem_l_shipdate_4#9147, cl_quantity#9115 AS cl_quantity_4#9148, cl_extendedprice#9116 AS cl_extendedprice_4#9149, cl_discount#9117 AS cl_discount_4#9150, ... 9 more fields]
         :     :     +- Relation[rid#9094,cpfk_orders_lineitem#9095,cpfk_supplier_lineitem#9096,cfpk_lineitem_supplier#9097,cfpk_lineitem_partsupp#9098,cpfk_part_lineitem#9099,cfpk_lineitem_part#9100,cpfk_partsupp_lineitem#9101,cfpk_lineitem_orders#9102,cval_lineitem_l_quantity#9103,cval_lineitem_l_extendedprice#9104,cval_lineitem_l_discount#9105,cval_lineitem_l_tax#9106,cval_lineitem_l_returnflag#9107,cval_lineitem_l_linestatus#9108,cval_lineitem_l_commitdate#9109,cval_lineitem_l_receiptdate#9110,cval_lineitem_l_shipinstruct#9111,cval_lineitem_l_shipmode#9112,cval_lineitem_l_comment#9113,cval_lineitem_l_shipdate#9114,cl_quantity#9115,cl_extendedprice#9116,cl_discount#9117,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#9260 AS rid_5#9273, cpfk_nation_supplier#9261 AS cpfk_nation_supplier_5#9274, cfpk_supplier_nation#9262 AS cfpk_supplier_nation_5#9275, cval_supplier_s_name#9263 AS cval_supplier_s_name_5#9276, cval_supplier_s_address#9264 AS cval_supplier_s_address_5#9277, cval_supplier_s_phone#9265 AS cval_supplier_s_phone_5#9278, cval_supplier_s_acctbal#9266 AS cval_supplier_s_acctbal_5#9279, cval_supplier_s_comment#9267 AS cval_supplier_s_comment_5#9280, cs_name#9268 AS cs_name_5#9281, cs_address#9269 AS cs_address_5#9282, cs_phone#9270 AS cs_phone_5#9283, cs_acctbal#9271 AS cs_acctbal_5#9284, cs_comment#9272 AS cs_comment_5#9285]
         :        +- Relation[rid#9260,cpfk_nation_supplier#9261,cfpk_supplier_nation#9262,cval_supplier_s_name#9263,cval_supplier_s_address#9264,cval_supplier_s_phone#9265,cval_supplier_s_acctbal#9266,cval_supplier_s_comment#9267,cs_name#9268,cs_address#9269,cs_phone#9270,cs_acctbal#9271,cs_comment#9272] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#9286 AS rid_1#9293, cpfk_region_nation#9287 AS cpfk_region_nation_1#9294, cfpk_nation_region#9288 AS cfpk_nation_region_1#9295, cval_nation_n_name#9289 AS cval_nation_n_name_1#9296, cval_nation_n_comment#9290 AS cval_nation_n_comment_1#9297, cn_name#9291 AS cn_name_1#9298, cn_comment#9292 AS cn_comment_1#9299]
            :  +- Relation[rid#9286,cpfk_region_nation#9287,cfpk_nation_region#9288,cval_nation_n_name#9289,cval_nation_n_comment#9290,cn_name#9291,cn_comment#9292] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#9300 AS rid_5#9313, cpfk_nation_supplier#9301 AS cpfk_nation_supplier_5#9314, cfpk_supplier_nation#9302 AS cfpk_supplier_nation_5#9315, cval_supplier_s_name#9303 AS cval_supplier_s_name_5#9316, cval_supplier_s_address#9304 AS cval_supplier_s_address_5#9317, cval_supplier_s_phone#9305 AS cval_supplier_s_phone_5#9318, cval_supplier_s_acctbal#9306 AS cval_supplier_s_acctbal_5#9319, cval_supplier_s_comment#9307 AS cval_supplier_s_comment_5#9320, cs_name#9308 AS cs_name_5#9321, cs_address#9309 AS cs_address_5#9322, cs_phone#9310 AS cs_phone_5#9323, cs_acctbal#9311 AS cs_acctbal_5#9324, cs_comment#9312 AS cs_comment_5#9325]
               +- Relation[rid#9300,cpfk_nation_supplier#9301,cfpk_supplier_nation#9302,cval_supplier_s_name#9303,cval_supplier_s_address#9304,cval_supplier_s_phone#9305,cval_supplier_s_acctbal#9306,cval_supplier_s_comment#9307,cs_name#9308,cs_address#9309,cs_phone#9310,cs_acctbal#9311,cs_comment#9312] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=5
Elapsed time: 20357ms
query=q1, count=6001215, duration=2814
query=q10, count=1478870, duration=66368
query=q11, count=4, duration=1211
query=q12, count=857401, duration=23156
query=q13, count=1500000, duration=13634
query=q14, count=6001215, duration=87827
query=q15, count=6001215, duration=84721
query=q16, count=7890, duration=505
query=q17, count=408, duration=379
query=q18, count=6001215, duration=124468
query=q19, count=13, duration=63663
query=q2, count=0, duration=8198
query=q20, count=1, duration=711
query=q21a, count=120762, duration=91064
query=q22, count=1500000, duration=13685
query=q3, count=75006, duration=6180
query=q4, count=6001215, duration=56140
query=q5, count=5, duration=20357
query=q6, count=6001215, duration=2796
query=q7, count=0, duration=347
query=q8, count=0, duration=2688
query=q9a, count=6001215, duration=261479
query=q9b, count=6001215, duration=171796
