20/04/15 15:18:22 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 12589ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Apr 15 15:18:25 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Apr 15 15:18:27 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Apr 15 15:18:27 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Apr 15 15:18:27 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Apr 15 15:18:27 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Apr 15 15:18:32 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Apr 15 15:18:36 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Apr 15 15:18:36 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/15 15:18:38 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:18:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2078L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 15:18:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2078L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#2080 AS rid_0#2097, cpfk_customer_orders#2081 AS cpfk_customer_orders_0#2098, cfpk_orders_customer#2082 AS cfpk_orders_customer_0#2099, cval_orders_o_orderstatus#2083 AS cval_orders_o_orderstatus_0#2100, cval_orders_o_totalprice#2084 AS cval_orders_o_totalprice_0#2101, cval_orders_o_orderpriority#2085 AS cval_orders_o_orderpriority_0#2102, cval_orders_o_clerk#2086 AS cval_orders_o_clerk_0#2103, cval_orders_o_shippriority#2087 AS cval_orders_o_shippriority_0#2104, cval_orders_o_comment#2088 AS cval_orders_o_comment_0#2105, cval_orders_o_orderdate#2089 AS cval_orders_o_orderdate_0#2106, co_orderstatus#2090 AS co_orderstatus_0#2107, co_totalprice#2091 AS co_totalprice_0#2108, co_orderpriority#2092 AS co_orderpriority_0#2109, co_clerk#2093 AS co_clerk_0#2110, co_shippriority#2094 AS co_shippriority_0#2111, co_comment#2095 AS co_comment_0#2112, co_orderdate#2096 AS co_orderdate_0#2113]
            :  +- Relation[rid#2080,cpfk_customer_orders#2081,cfpk_orders_customer#2082,cval_orders_o_orderstatus#2083,cval_orders_o_totalprice#2084,cval_orders_o_orderpriority#2085,cval_orders_o_clerk#2086,cval_orders_o_shippriority#2087,cval_orders_o_comment#2088,cval_orders_o_orderdate#2089,co_orderstatus#2090,co_totalprice#2091,co_orderpriority#2092,co_clerk#2093,co_shippriority#2094,co_comment#2095,co_orderdate#2096] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#2114 AS rid_1#2129, cpfk_nation_customer#2115 AS cpfk_nation_customer_1#2130, cfpk_customer_nation#2116 AS cfpk_customer_nation_1#2131, cval_customer_c_name#2117 AS cval_customer_c_name_1#2132, cval_customer_c_address#2118 AS cval_customer_c_address_1#2133, cval_customer_c_phone#2119 AS cval_customer_c_phone_1#2134, cval_customer_c_acctbal#2120 AS cval_customer_c_acctbal_1#2135, cval_customer_c_comment#2121 AS cval_customer_c_comment_1#2136, cval_customer_c_mktsegment#2122 AS cval_customer_c_mktsegment_1#2137, cc_name#2123 AS cc_name_1#2138, cc_address#2124 AS cc_address_1#2139, cc_phone#2125 AS cc_phone_1#2140, cc_acctbal#2126 AS cc_acctbal_1#2141, cc_comment#2127 AS cc_comment_1#2142, cc_mktsegment#2128 AS cc_mktsegment_1#2143]
               +- Relation[rid#2114,cpfk_nation_customer#2115,cfpk_customer_nation#2116,cval_customer_c_name#2117,cval_customer_c_address#2118,cval_customer_c_phone#2119,cval_customer_c_acctbal#2120,cval_customer_c_comment#2121,cval_customer_c_mktsegment#2122,cc_name#2123,cc_address#2124,cc_phone#2125,cc_acctbal#2126,cc_comment#2127,cc_mktsegment#2128] JDBCRelation(tcustomer) [numPartitions=1]

20/04/15 15:18:39 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexPkFk$ result size=1500000
Elapsed time: 14125ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/15 15:18:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:18:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2183L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 15:18:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:18:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:18:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:18:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2183L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#2185 AS rid_0#2202, cval_part_p_name#2186 AS cval_part_p_name_0#2203, cval_part_p_mfgr#2187 AS cval_part_p_mfgr_0#2204, cval_part_p_type#2188 AS cval_part_p_type_0#2205, cval_part_p_size#2189 AS cval_part_p_size_0#2206, cval_part_p_container#2190 AS cval_part_p_container_0#2207, cval_part_p_retailprice#2191 AS cval_part_p_retailprice_0#2208, cval_part_p_comment#2192 AS cval_part_p_comment_0#2209, cval_part_p_brand#2193 AS cval_part_p_brand_0#2210, cp_name#2194 AS cp_name_0#2211, cp_mfgr#2195 AS cp_mfgr_0#2212, cp_type#2196 AS cp_type_0#2213, cp_size#2197 AS cp_size_0#2214, cp_container#2198 AS cp_container_0#2215, cp_retailprice#2199 AS cp_retailprice_0#2216, cp_comment#2200 AS cp_comment_0#2217, cp_brand#2201 AS cp_brand_0#2218]
         :  :  :  +- Relation[rid#2185,cval_part_p_name#2186,cval_part_p_mfgr#2187,cval_part_p_type#2188,cval_part_p_size#2189,cval_part_p_container#2190,cval_part_p_retailprice#2191,cval_part_p_comment#2192,cval_part_p_brand#2193,cp_name#2194,cp_mfgr#2195,cp_type#2196,cp_size#2197,cp_container#2198,cp_retailprice#2199,cp_comment#2200,cp_brand#2201] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#2219 AS rid_0#2236, cval_part_p_name#2220 AS cval_part_p_name_0#2237, cval_part_p_mfgr#2221 AS cval_part_p_mfgr_0#2238, cval_part_p_type#2222 AS cval_part_p_type_0#2239, cval_part_p_size#2223 AS cval_part_p_size_0#2240, cval_part_p_container#2224 AS cval_part_p_container_0#2241, cval_part_p_retailprice#2225 AS cval_part_p_retailprice_0#2242, cval_part_p_comment#2226 AS cval_part_p_comment_0#2243, cval_part_p_brand#2227 AS cval_part_p_brand_0#2244, cp_name#2228 AS cp_name_0#2245, cp_mfgr#2229 AS cp_mfgr_0#2246, cp_type#2230 AS cp_type_0#2247, cp_size#2231 AS cp_size_0#2248, cp_container#2232 AS cp_container_0#2249, cp_retailprice#2233 AS cp_retailprice_0#2250, cp_comment#2234 AS cp_comment_0#2251, cp_brand#2235 AS cp_brand_0#2252]
         :  :        +- Relation[rid#2219,cval_part_p_name#2220,cval_part_p_mfgr#2221,cval_part_p_type#2222,cval_part_p_size#2223,cval_part_p_container#2224,cval_part_p_retailprice#2225,cval_part_p_comment#2226,cval_part_p_brand#2227,cp_name#2228,cp_mfgr#2229,cp_type#2230,cp_size#2231,cp_container#2232,cp_retailprice#2233,cp_comment#2234,cp_brand#2235] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#2309 AS rid_1#2320, cpfk_part_partsupp#2310 AS cpfk_part_partsupp_1#2321, cfpk_partsupp_part#2311 AS cfpk_partsupp_part_1#2322, cpfk_supplier_partsupp#2312 AS cpfk_supplier_partsupp_1#2323, cfpk_partsupp_supplier#2313 AS cfpk_partsupp_supplier_1#2324, cval_partsupp_ps_availqty#2314 AS cval_partsupp_ps_availqty_1#2325, cval_partsupp_ps_supplycost#2315 AS cval_partsupp_ps_supplycost_1#2326, cval_partsupp_ps_comment#2316 AS cval_partsupp_ps_comment_1#2327, cps_availqty#2317 AS cps_availqty_1#2328, cps_supplycost#2318 AS cps_supplycost_1#2329, cps_comment#2319 AS cps_comment_1#2330]
         :     +- Relation[rid#2309,cpfk_part_partsupp#2310,cfpk_partsupp_part#2311,cpfk_supplier_partsupp#2312,cfpk_partsupp_supplier#2313,cval_partsupp_ps_availqty#2314,cval_partsupp_ps_supplycost#2315,cval_partsupp_ps_comment#2316,cps_availqty#2317,cps_supplycost#2318,cps_comment#2319] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#2253 AS rid_1#2264, cpfk_part_partsupp#2254 AS cpfk_part_partsupp_1#2265, cfpk_partsupp_part#2255 AS cfpk_partsupp_part_1#2266, cpfk_supplier_partsupp#2256 AS cpfk_supplier_partsupp_1#2267, cfpk_partsupp_supplier#2257 AS cfpk_partsupp_supplier_1#2268, cval_partsupp_ps_availqty#2258 AS cval_partsupp_ps_availqty_1#2269, cval_partsupp_ps_supplycost#2259 AS cval_partsupp_ps_supplycost_1#2270, cval_partsupp_ps_comment#2260 AS cval_partsupp_ps_comment_1#2271, cps_availqty#2261 AS cps_availqty_1#2272, cps_supplycost#2262 AS cps_supplycost_1#2273, cps_comment#2263 AS cps_comment_1#2274]
            +- Relation[rid#2253,cpfk_part_partsupp#2254,cfpk_partsupp_part#2255,cpfk_supplier_partsupp#2256,cfpk_partsupp_supplier#2257,cval_partsupp_ps_availqty#2258,cval_partsupp_ps_supplycost#2259,cval_partsupp_ps_comment#2260,cps_availqty#2261,cps_supplycost#2262,cps_comment#2263] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=7890
Elapsed time: 650ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/15 15:18:53 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:18:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2363L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:18:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2363L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#2365 AS rid_0#2398, cpfk_orders_lineitem#2366 AS cpfk_orders_lineitem_0#2399, cpfk_supplier_lineitem#2367 AS cpfk_supplier_lineitem_0#2400, cfpk_lineitem_supplier#2368 AS cfpk_lineitem_supplier_0#2401, cfpk_lineitem_partsupp#2369 AS cfpk_lineitem_partsupp_0#2402, cpfk_part_lineitem#2370 AS cpfk_part_lineitem_0#2403, cfpk_lineitem_part#2371 AS cfpk_lineitem_part_0#2404, cpfk_partsupp_lineitem#2372 AS cpfk_partsupp_lineitem_0#2405, cfpk_lineitem_orders#2373 AS cfpk_lineitem_orders_0#2406, cval_lineitem_l_quantity#2374 AS cval_lineitem_l_quantity_0#2407, cval_lineitem_l_extendedprice#2375 AS cval_lineitem_l_extendedprice_0#2408, cval_lineitem_l_discount#2376 AS cval_lineitem_l_discount_0#2409, cval_lineitem_l_tax#2377 AS cval_lineitem_l_tax_0#2410, cval_lineitem_l_returnflag#2378 AS cval_lineitem_l_returnflag_0#2411, cval_lineitem_l_linestatus#2379 AS cval_lineitem_l_linestatus_0#2412, cval_lineitem_l_commitdate#2380 AS cval_lineitem_l_commitdate_0#2413, cval_lineitem_l_receiptdate#2381 AS cval_lineitem_l_receiptdate_0#2414, cval_lineitem_l_shipinstruct#2382 AS cval_lineitem_l_shipinstruct_0#2415, cval_lineitem_l_shipmode#2383 AS cval_lineitem_l_shipmode_0#2416, cval_lineitem_l_comment#2384 AS cval_lineitem_l_comment_0#2417, cval_lineitem_l_shipdate#2385 AS cval_lineitem_l_shipdate_0#2418, cl_quantity#2386 AS cl_quantity_0#2419, cl_extendedprice#2387 AS cl_extendedprice_0#2420, cl_discount#2388 AS cl_discount_0#2421, ... 9 more fields]
            :  :  +- Relation[rid#2365,cpfk_orders_lineitem#2366,cpfk_supplier_lineitem#2367,cfpk_lineitem_supplier#2368,cfpk_lineitem_partsupp#2369,cpfk_part_lineitem#2370,cfpk_lineitem_part#2371,cpfk_partsupp_lineitem#2372,cfpk_lineitem_orders#2373,cval_lineitem_l_quantity#2374,cval_lineitem_l_extendedprice#2375,cval_lineitem_l_discount#2376,cval_lineitem_l_tax#2377,cval_lineitem_l_returnflag#2378,cval_lineitem_l_linestatus#2379,cval_lineitem_l_commitdate#2380,cval_lineitem_l_receiptdate#2381,cval_lineitem_l_shipinstruct#2382,cval_lineitem_l_shipmode#2383,cval_lineitem_l_comment#2384,cval_lineitem_l_shipdate#2385,cl_quantity#2386,cl_extendedprice#2387,cl_discount#2388,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#2431 AS rid_0#2464, cpfk_orders_lineitem#2432 AS cpfk_orders_lineitem_0#2465, cpfk_supplier_lineitem#2433 AS cpfk_supplier_lineitem_0#2466, cfpk_lineitem_supplier#2434 AS cfpk_lineitem_supplier_0#2467, cfpk_lineitem_partsupp#2435 AS cfpk_lineitem_partsupp_0#2468, cpfk_part_lineitem#2436 AS cpfk_part_lineitem_0#2469, cfpk_lineitem_part#2437 AS cfpk_lineitem_part_0#2470, cpfk_partsupp_lineitem#2438 AS cpfk_partsupp_lineitem_0#2471, cfpk_lineitem_orders#2439 AS cfpk_lineitem_orders_0#2472, cval_lineitem_l_quantity#2440 AS cval_lineitem_l_quantity_0#2473, cval_lineitem_l_extendedprice#2441 AS cval_lineitem_l_extendedprice_0#2474, cval_lineitem_l_discount#2442 AS cval_lineitem_l_discount_0#2475, cval_lineitem_l_tax#2443 AS cval_lineitem_l_tax_0#2476, cval_lineitem_l_returnflag#2444 AS cval_lineitem_l_returnflag_0#2477, cval_lineitem_l_linestatus#2445 AS cval_lineitem_l_linestatus_0#2478, cval_lineitem_l_commitdate#2446 AS cval_lineitem_l_commitdate_0#2479, cval_lineitem_l_receiptdate#2447 AS cval_lineitem_l_receiptdate_0#2480, cval_lineitem_l_shipinstruct#2448 AS cval_lineitem_l_shipinstruct_0#2481, cval_lineitem_l_shipmode#2449 AS cval_lineitem_l_shipmode_0#2482, cval_lineitem_l_comment#2450 AS cval_lineitem_l_comment_0#2483, cval_lineitem_l_shipdate#2451 AS cval_lineitem_l_shipdate_0#2484, cl_quantity#2452 AS cl_quantity_0#2485, cl_extendedprice#2453 AS cl_extendedprice_0#2486, cl_discount#2454 AS cl_discount_0#2487, ... 9 more fields]
            :        +- Relation[rid#2431,cpfk_orders_lineitem#2432,cpfk_supplier_lineitem#2433,cfpk_lineitem_supplier#2434,cfpk_lineitem_partsupp#2435,cpfk_part_lineitem#2436,cfpk_lineitem_part#2437,cpfk_partsupp_lineitem#2438,cfpk_lineitem_orders#2439,cval_lineitem_l_quantity#2440,cval_lineitem_l_extendedprice#2441,cval_lineitem_l_discount#2442,cval_lineitem_l_tax#2443,cval_lineitem_l_returnflag#2444,cval_lineitem_l_linestatus#2445,cval_lineitem_l_commitdate#2446,cval_lineitem_l_receiptdate#2447,cval_lineitem_l_shipinstruct#2448,cval_lineitem_l_shipmode#2449,cval_lineitem_l_comment#2450,cval_lineitem_l_shipdate#2451,cl_quantity#2452,cl_extendedprice#2453,cl_discount#2454,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#2497 AS rid_1#2514, cpfk_customer_orders#2498 AS cpfk_customer_orders_1#2515, cfpk_orders_customer#2499 AS cfpk_orders_customer_1#2516, cval_orders_o_orderstatus#2500 AS cval_orders_o_orderstatus_1#2517, cval_orders_o_totalprice#2501 AS cval_orders_o_totalprice_1#2518, cval_orders_o_orderpriority#2502 AS cval_orders_o_orderpriority_1#2519, cval_orders_o_clerk#2503 AS cval_orders_o_clerk_1#2520, cval_orders_o_shippriority#2504 AS cval_orders_o_shippriority_1#2521, cval_orders_o_comment#2505 AS cval_orders_o_comment_1#2522, cval_orders_o_orderdate#2506 AS cval_orders_o_orderdate_1#2523, co_orderstatus#2507 AS co_orderstatus_1#2524, co_totalprice#2508 AS co_totalprice_1#2525, co_orderpriority#2509 AS co_orderpriority_1#2526, co_clerk#2510 AS co_clerk_1#2527, co_shippriority#2511 AS co_shippriority_1#2528, co_comment#2512 AS co_comment_1#2529, co_orderdate#2513 AS co_orderdate_1#2530]
               +- Relation[rid#2497,cpfk_customer_orders#2498,cfpk_orders_customer#2499,cval_orders_o_orderstatus#2500,cval_orders_o_totalprice#2501,cval_orders_o_orderpriority#2502,cval_orders_o_clerk#2503,cval_orders_o_shippriority#2504,cval_orders_o_comment#2505,cval_orders_o_orderdate#2506,co_orderstatus#2507,co_totalprice#2508,co_orderpriority#2509,co_clerk#2510,co_shippriority#2511,co_comment#2512,co_orderdate#2513] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 22925ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/15 15:19:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:19:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2586L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:19:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#2586L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#2588 AS rid_0#2621, cpfk_orders_lineitem#2589 AS cpfk_orders_lineitem_0#2622, cpfk_supplier_lineitem#2590 AS cpfk_supplier_lineitem_0#2623, cfpk_lineitem_supplier#2591 AS cfpk_lineitem_supplier_0#2624, cfpk_lineitem_partsupp#2592 AS cfpk_lineitem_partsupp_0#2625, cpfk_part_lineitem#2593 AS cpfk_part_lineitem_0#2626, cfpk_lineitem_part#2594 AS cfpk_lineitem_part_0#2627, cpfk_partsupp_lineitem#2595 AS cpfk_partsupp_lineitem_0#2628, cfpk_lineitem_orders#2596 AS cfpk_lineitem_orders_0#2629, cval_lineitem_l_quantity#2597 AS cval_lineitem_l_quantity_0#2630, cval_lineitem_l_extendedprice#2598 AS cval_lineitem_l_extendedprice_0#2631, cval_lineitem_l_discount#2599 AS cval_lineitem_l_discount_0#2632, cval_lineitem_l_tax#2600 AS cval_lineitem_l_tax_0#2633, cval_lineitem_l_returnflag#2601 AS cval_lineitem_l_returnflag_0#2634, cval_lineitem_l_linestatus#2602 AS cval_lineitem_l_linestatus_0#2635, cval_lineitem_l_commitdate#2603 AS cval_lineitem_l_commitdate_0#2636, cval_lineitem_l_receiptdate#2604 AS cval_lineitem_l_receiptdate_0#2637, cval_lineitem_l_shipinstruct#2605 AS cval_lineitem_l_shipinstruct_0#2638, cval_lineitem_l_shipmode#2606 AS cval_lineitem_l_shipmode_0#2639, cval_lineitem_l_comment#2607 AS cval_lineitem_l_comment_0#2640, cval_lineitem_l_shipdate#2608 AS cval_lineitem_l_shipdate_0#2641, cl_quantity#2609 AS cl_quantity_0#2642, cl_extendedprice#2610 AS cl_extendedprice_0#2643, cl_discount#2611 AS cl_discount_0#2644, ... 9 more fields]
         +- Relation[rid#2588,cpfk_orders_lineitem#2589,cpfk_supplier_lineitem#2590,cfpk_lineitem_supplier#2591,cfpk_lineitem_partsupp#2592,cpfk_part_lineitem#2593,cfpk_lineitem_part#2594,cpfk_partsupp_lineitem#2595,cfpk_lineitem_orders#2596,cval_lineitem_l_quantity#2597,cval_lineitem_l_extendedprice#2598,cval_lineitem_l_discount#2599,cval_lineitem_l_tax#2600,cval_lineitem_l_returnflag#2601,cval_lineitem_l_linestatus#2602,cval_lineitem_l_commitdate#2603,cval_lineitem_l_receiptdate#2604,cval_lineitem_l_shipinstruct#2605,cval_lineitem_l_shipmode#2606,cval_lineitem_l_comment#2607,cval_lineitem_l_shipdate#2608,cl_quantity#2609,cl_extendedprice#2610,cl_discount#2611,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2787ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/15 15:19:19 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:19:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2691L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 15:19:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:19:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:19:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:19:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:19:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:19:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:19:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:19:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2691L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#2693 AS rid_0#2726, cpfk_orders_lineitem#2694 AS cpfk_orders_lineitem_0#2727, cpfk_supplier_lineitem#2695 AS cpfk_supplier_lineitem_0#2728, cfpk_lineitem_supplier#2696 AS cfpk_lineitem_supplier_0#2729, cfpk_lineitem_partsupp#2697 AS cfpk_lineitem_partsupp_0#2730, cpfk_part_lineitem#2698 AS cpfk_part_lineitem_0#2731, cfpk_lineitem_part#2699 AS cfpk_lineitem_part_0#2732, cpfk_partsupp_lineitem#2700 AS cpfk_partsupp_lineitem_0#2733, cfpk_lineitem_orders#2701 AS cfpk_lineitem_orders_0#2734, cval_lineitem_l_quantity#2702 AS cval_lineitem_l_quantity_0#2735, cval_lineitem_l_extendedprice#2703 AS cval_lineitem_l_extendedprice_0#2736, cval_lineitem_l_discount#2704 AS cval_lineitem_l_discount_0#2737, cval_lineitem_l_tax#2705 AS cval_lineitem_l_tax_0#2738, cval_lineitem_l_returnflag#2706 AS cval_lineitem_l_returnflag_0#2739, cval_lineitem_l_linestatus#2707 AS cval_lineitem_l_linestatus_0#2740, cval_lineitem_l_commitdate#2708 AS cval_lineitem_l_commitdate_0#2741, cval_lineitem_l_receiptdate#2709 AS cval_lineitem_l_receiptdate_0#2742, cval_lineitem_l_shipinstruct#2710 AS cval_lineitem_l_shipinstruct_0#2743, cval_lineitem_l_shipmode#2711 AS cval_lineitem_l_shipmode_0#2744, cval_lineitem_l_comment#2712 AS cval_lineitem_l_comment_0#2745, cval_lineitem_l_shipdate#2713 AS cval_lineitem_l_shipdate_0#2746, cl_quantity#2714 AS cl_quantity_0#2747, cl_extendedprice#2715 AS cl_extendedprice_0#2748, cl_discount#2716 AS cl_discount_0#2749, ... 9 more fields]
            :  +- Relation[rid#2693,cpfk_orders_lineitem#2694,cpfk_supplier_lineitem#2695,cfpk_lineitem_supplier#2696,cfpk_lineitem_partsupp#2697,cpfk_part_lineitem#2698,cfpk_lineitem_part#2699,cpfk_partsupp_lineitem#2700,cfpk_lineitem_orders#2701,cval_lineitem_l_quantity#2702,cval_lineitem_l_extendedprice#2703,cval_lineitem_l_discount#2704,cval_lineitem_l_tax#2705,cval_lineitem_l_returnflag#2706,cval_lineitem_l_linestatus#2707,cval_lineitem_l_commitdate#2708,cval_lineitem_l_receiptdate#2709,cval_lineitem_l_shipinstruct#2710,cval_lineitem_l_shipmode#2711,cval_lineitem_l_comment#2712,cval_lineitem_l_shipdate#2713,cl_quantity#2714,cl_extendedprice#2715,cl_discount#2716,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#2759 AS rid_1#2776, cpfk_customer_orders#2760 AS cpfk_customer_orders_1#2777, cfpk_orders_customer#2761 AS cfpk_orders_customer_1#2778, cval_orders_o_orderstatus#2762 AS cval_orders_o_orderstatus_1#2779, cval_orders_o_totalprice#2763 AS cval_orders_o_totalprice_1#2780, cval_orders_o_orderpriority#2764 AS cval_orders_o_orderpriority_1#2781, cval_orders_o_clerk#2765 AS cval_orders_o_clerk_1#2782, cval_orders_o_shippriority#2766 AS cval_orders_o_shippriority_1#2783, cval_orders_o_comment#2767 AS cval_orders_o_comment_1#2784, cval_orders_o_orderdate#2768 AS cval_orders_o_orderdate_1#2785, co_orderstatus#2769 AS co_orderstatus_1#2786, co_totalprice#2770 AS co_totalprice_1#2787, co_orderpriority#2771 AS co_orderpriority_1#2788, co_clerk#2772 AS co_clerk_1#2789, co_shippriority#2773 AS co_shippriority_1#2790, co_comment#2774 AS co_comment_1#2791, co_orderdate#2775 AS co_orderdate_1#2792]
                  :     :  :  :  :  +- Relation[rid#2759,cpfk_customer_orders#2760,cfpk_orders_customer#2761,cval_orders_o_orderstatus#2762,cval_orders_o_totalprice#2763,cval_orders_o_orderpriority#2764,cval_orders_o_clerk#2765,cval_orders_o_shippriority#2766,cval_orders_o_comment#2767,cval_orders_o_orderdate#2768,co_orderstatus#2769,co_totalprice#2770,co_orderpriority#2771,co_clerk#2772,co_shippriority#2773,co_comment#2774,co_orderdate#2775] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#2793 AS rid_1#2810, cpfk_customer_orders#2794 AS cpfk_customer_orders_1#2811, cfpk_orders_customer#2795 AS cfpk_orders_customer_1#2812, cval_orders_o_orderstatus#2796 AS cval_orders_o_orderstatus_1#2813, cval_orders_o_totalprice#2797 AS cval_orders_o_totalprice_1#2814, cval_orders_o_orderpriority#2798 AS cval_orders_o_orderpriority_1#2815, cval_orders_o_clerk#2799 AS cval_orders_o_clerk_1#2816, cval_orders_o_shippriority#2800 AS cval_orders_o_shippriority_1#2817, cval_orders_o_comment#2801 AS cval_orders_o_comment_1#2818, cval_orders_o_orderdate#2802 AS cval_orders_o_orderdate_1#2819, co_orderstatus#2803 AS co_orderstatus_1#2820, co_totalprice#2804 AS co_totalprice_1#2821, co_orderpriority#2805 AS co_orderpriority_1#2822, co_clerk#2806 AS co_clerk_1#2823, co_shippriority#2807 AS co_shippriority_1#2824, co_comment#2808 AS co_comment_1#2825, co_orderdate#2809 AS co_orderdate_1#2826]
                  :     :  :  :        +- Relation[rid#2793,cpfk_customer_orders#2794,cfpk_orders_customer#2795,cval_orders_o_orderstatus#2796,cval_orders_o_totalprice#2797,cval_orders_o_orderpriority#2798,cval_orders_o_clerk#2799,cval_orders_o_shippriority#2800,cval_orders_o_comment#2801,cval_orders_o_orderdate#2802,co_orderstatus#2803,co_totalprice#2804,co_orderpriority#2805,co_clerk#2806,co_shippriority#2807,co_comment#2808,co_orderdate#2809] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- Project [rid#2927 AS rid_2#2960, cpfk_orders_lineitem#2928 AS cpfk_orders_lineitem_2#2961, cpfk_supplier_lineitem#2929 AS cpfk_supplier_lineitem_2#2962, cfpk_lineitem_supplier#2930 AS cfpk_lineitem_supplier_2#2963, cfpk_lineitem_partsupp#2931 AS cfpk_lineitem_partsupp_2#2964, cpfk_part_lineitem#2932 AS cpfk_part_lineitem_2#2965, cfpk_lineitem_part#2933 AS cfpk_lineitem_part_2#2966, cpfk_partsupp_lineitem#2934 AS cpfk_partsupp_lineitem_2#2967, cfpk_lineitem_orders#2935 AS cfpk_lineitem_orders_2#2968, cval_lineitem_l_quantity#2936 AS cval_lineitem_l_quantity_2#2969, cval_lineitem_l_extendedprice#2937 AS cval_lineitem_l_extendedprice_2#2970, cval_lineitem_l_discount#2938 AS cval_lineitem_l_discount_2#2971, cval_lineitem_l_tax#2939 AS cval_lineitem_l_tax_2#2972, cval_lineitem_l_returnflag#2940 AS cval_lineitem_l_returnflag_2#2973, cval_lineitem_l_linestatus#2941 AS cval_lineitem_l_linestatus_2#2974, cval_lineitem_l_commitdate#2942 AS cval_lineitem_l_commitdate_2#2975, cval_lineitem_l_receiptdate#2943 AS cval_lineitem_l_receiptdate_2#2976, cval_lineitem_l_shipinstruct#2944 AS cval_lineitem_l_shipinstruct_2#2977, cval_lineitem_l_shipmode#2945 AS cval_lineitem_l_shipmode_2#2978, cval_lineitem_l_comment#2946 AS cval_lineitem_l_comment_2#2979, cval_lineitem_l_shipdate#2947 AS cval_lineitem_l_shipdate_2#2980, cl_quantity#2948 AS cl_quantity_2#2981, cl_extendedprice#2949 AS cl_extendedprice_2#2982, cl_discount#2950 AS cl_discount_2#2983, ... 9 more fields]
                  :     :  :     +- Relation[rid#2927,cpfk_orders_lineitem#2928,cpfk_supplier_lineitem#2929,cfpk_lineitem_supplier#2930,cfpk_lineitem_partsupp#2931,cpfk_part_lineitem#2932,cfpk_lineitem_part#2933,cpfk_partsupp_lineitem#2934,cfpk_lineitem_orders#2935,cval_lineitem_l_quantity#2936,cval_lineitem_l_extendedprice#2937,cval_lineitem_l_discount#2938,cval_lineitem_l_tax#2939,cval_lineitem_l_returnflag#2940,cval_lineitem_l_linestatus#2941,cval_lineitem_l_commitdate#2942,cval_lineitem_l_receiptdate#2943,cval_lineitem_l_shipinstruct#2944,cval_lineitem_l_shipmode#2945,cval_lineitem_l_comment#2946,cval_lineitem_l_shipdate#2947,cl_quantity#2948,cl_extendedprice#2949,cl_discount#2950,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#2827 AS rid_2#2860, cpfk_orders_lineitem#2828 AS cpfk_orders_lineitem_2#2861, cpfk_supplier_lineitem#2829 AS cpfk_supplier_lineitem_2#2862, cfpk_lineitem_supplier#2830 AS cfpk_lineitem_supplier_2#2863, cfpk_lineitem_partsupp#2831 AS cfpk_lineitem_partsupp_2#2864, cpfk_part_lineitem#2832 AS cpfk_part_lineitem_2#2865, cfpk_lineitem_part#2833 AS cfpk_lineitem_part_2#2866, cpfk_partsupp_lineitem#2834 AS cpfk_partsupp_lineitem_2#2867, cfpk_lineitem_orders#2835 AS cfpk_lineitem_orders_2#2868, cval_lineitem_l_quantity#2836 AS cval_lineitem_l_quantity_2#2869, cval_lineitem_l_extendedprice#2837 AS cval_lineitem_l_extendedprice_2#2870, cval_lineitem_l_discount#2838 AS cval_lineitem_l_discount_2#2871, cval_lineitem_l_tax#2839 AS cval_lineitem_l_tax_2#2872, cval_lineitem_l_returnflag#2840 AS cval_lineitem_l_returnflag_2#2873, cval_lineitem_l_linestatus#2841 AS cval_lineitem_l_linestatus_2#2874, cval_lineitem_l_commitdate#2842 AS cval_lineitem_l_commitdate_2#2875, cval_lineitem_l_receiptdate#2843 AS cval_lineitem_l_receiptdate_2#2876, cval_lineitem_l_shipinstruct#2844 AS cval_lineitem_l_shipinstruct_2#2877, cval_lineitem_l_shipmode#2845 AS cval_lineitem_l_shipmode_2#2878, cval_lineitem_l_comment#2846 AS cval_lineitem_l_comment_2#2879, cval_lineitem_l_shipdate#2847 AS cval_lineitem_l_shipdate_2#2880, cl_quantity#2848 AS cl_quantity_2#2881, cl_extendedprice#2849 AS cl_extendedprice_2#2882, cl_discount#2850 AS cl_discount_2#2883, ... 9 more fields]
                  :     :     +- Relation[rid#2827,cpfk_orders_lineitem#2828,cpfk_supplier_lineitem#2829,cfpk_lineitem_supplier#2830,cfpk_lineitem_partsupp#2831,cpfk_part_lineitem#2832,cfpk_lineitem_part#2833,cpfk_partsupp_lineitem#2834,cfpk_lineitem_orders#2835,cval_lineitem_l_quantity#2836,cval_lineitem_l_extendedprice#2837,cval_lineitem_l_discount#2838,cval_lineitem_l_tax#2839,cval_lineitem_l_returnflag#2840,cval_lineitem_l_linestatus#2841,cval_lineitem_l_commitdate#2842,cval_lineitem_l_receiptdate#2843,cval_lineitem_l_shipinstruct#2844,cval_lineitem_l_shipmode#2845,cval_lineitem_l_comment#2846,cval_lineitem_l_shipdate#2847,cl_quantity#2848,cl_extendedprice#2849,cl_discount#2850,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#2993 AS rid_3#3006, cpfk_nation_supplier#2994 AS cpfk_nation_supplier_3#3007, cfpk_supplier_nation#2995 AS cfpk_supplier_nation_3#3008, cval_supplier_s_name#2996 AS cval_supplier_s_name_3#3009, cval_supplier_s_address#2997 AS cval_supplier_s_address_3#3010, cval_supplier_s_phone#2998 AS cval_supplier_s_phone_3#3011, cval_supplier_s_acctbal#2999 AS cval_supplier_s_acctbal_3#3012, cval_supplier_s_comment#3000 AS cval_supplier_s_comment_3#3013, cs_name#3001 AS cs_name_3#3014, cs_address#3002 AS cs_address_3#3015, cs_phone#3003 AS cs_phone_3#3016, cs_acctbal#3004 AS cs_acctbal_3#3017, cs_comment#3005 AS cs_comment_3#3018]
                  :        +- Relation[rid#2993,cpfk_nation_supplier#2994,cfpk_supplier_nation#2995,cval_supplier_s_name#2996,cval_supplier_s_address#2997,cval_supplier_s_phone#2998,cval_supplier_s_acctbal#2999,cval_supplier_s_comment#3000,cs_name#3001,cs_address#3002,cs_phone#3003,cs_acctbal#3004,cs_comment#3005] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#3019 AS rid_4#3026, cpfk_region_nation#3020 AS cpfk_region_nation_4#3027, cfpk_nation_region#3021 AS cfpk_nation_region_4#3028, cval_nation_n_name#3022 AS cval_nation_n_name_4#3029, cval_nation_n_comment#3023 AS cval_nation_n_comment_4#3030, cn_name#3024 AS cn_name_4#3031, cn_comment#3025 AS cn_comment_4#3032]
                     :  +- Relation[rid#3019,cpfk_region_nation#3020,cfpk_nation_region#3021,cval_nation_n_name#3022,cval_nation_n_comment#3023,cn_name#3024,cn_comment#3025] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#3033 AS rid_4#3040, cpfk_region_nation#3034 AS cpfk_region_nation_4#3041, cfpk_nation_region#3035 AS cfpk_nation_region_4#3042, cval_nation_n_name#3036 AS cval_nation_n_name_4#3043, cval_nation_n_comment#3037 AS cval_nation_n_comment_4#3044, cn_name#3038 AS cn_name_4#3045, cn_comment#3039 AS cn_comment_4#3046]
                           +- Relation[rid#3033,cpfk_region_nation#3034,cfpk_nation_region#3035,cval_nation_n_name#3036,cval_nation_n_comment#3037,cn_name#3038,cn_comment#3039] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=120762
Elapsed time: 89656ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/15 15:20:48 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:20:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3155L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:20:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:20:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:20:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:20:49 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:20:49 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:20:49 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:20:49 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:20:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3155L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#3157 AS rid_0#3174, cval_part_p_name#3158 AS cval_part_p_name_0#3175, cval_part_p_mfgr#3159 AS cval_part_p_mfgr_0#3176, cval_part_p_type#3160 AS cval_part_p_type_0#3177, cval_part_p_size#3161 AS cval_part_p_size_0#3178, cval_part_p_container#3162 AS cval_part_p_container_0#3179, cval_part_p_retailprice#3163 AS cval_part_p_retailprice_0#3180, cval_part_p_comment#3164 AS cval_part_p_comment_0#3181, cval_part_p_brand#3165 AS cval_part_p_brand_0#3182, cp_name#3166 AS cp_name_0#3183, cp_mfgr#3167 AS cp_mfgr_0#3184, cp_type#3168 AS cp_type_0#3185, cp_size#3169 AS cp_size_0#3186, cp_container#3170 AS cp_container_0#3187, cp_retailprice#3171 AS cp_retailprice_0#3188, cp_comment#3172 AS cp_comment_0#3189, cp_brand#3173 AS cp_brand_0#3190]
         :  :  :  :  +- Relation[rid#3157,cval_part_p_name#3158,cval_part_p_mfgr#3159,cval_part_p_type#3160,cval_part_p_size#3161,cval_part_p_container#3162,cval_part_p_retailprice#3163,cval_part_p_comment#3164,cval_part_p_brand#3165,cp_name#3166,cp_mfgr#3167,cp_type#3168,cp_size#3169,cp_container#3170,cp_retailprice#3171,cp_comment#3172,cp_brand#3173] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#3191 AS rid_0#3208, cval_part_p_name#3192 AS cval_part_p_name_0#3209, cval_part_p_mfgr#3193 AS cval_part_p_mfgr_0#3210, cval_part_p_type#3194 AS cval_part_p_type_0#3211, cval_part_p_size#3195 AS cval_part_p_size_0#3212, cval_part_p_container#3196 AS cval_part_p_container_0#3213, cval_part_p_retailprice#3197 AS cval_part_p_retailprice_0#3214, cval_part_p_comment#3198 AS cval_part_p_comment_0#3215, cval_part_p_brand#3199 AS cval_part_p_brand_0#3216, cp_name#3200 AS cp_name_0#3217, cp_mfgr#3201 AS cp_mfgr_0#3218, cp_type#3202 AS cp_type_0#3219, cp_size#3203 AS cp_size_0#3220, cp_container#3204 AS cp_container_0#3221, cp_retailprice#3205 AS cp_retailprice_0#3222, cp_comment#3206 AS cp_comment_0#3223, cp_brand#3207 AS cp_brand_0#3224]
         :  :  :        +- Relation[rid#3191,cval_part_p_name#3192,cval_part_p_mfgr#3193,cval_part_p_type#3194,cval_part_p_size#3195,cval_part_p_container#3196,cval_part_p_retailprice#3197,cval_part_p_comment#3198,cval_part_p_brand#3199,cp_name#3200,cp_mfgr#3201,cp_type#3202,cp_size#3203,cp_container#3204,cp_retailprice#3205,cp_comment#3206,cp_brand#3207] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#3225 AS rid_0#3242, cval_part_p_name#3226 AS cval_part_p_name_0#3243, cval_part_p_mfgr#3227 AS cval_part_p_mfgr_0#3244, cval_part_p_type#3228 AS cval_part_p_type_0#3245, cval_part_p_size#3229 AS cval_part_p_size_0#3246, cval_part_p_container#3230 AS cval_part_p_container_0#3247, cval_part_p_retailprice#3231 AS cval_part_p_retailprice_0#3248, cval_part_p_comment#3232 AS cval_part_p_comment_0#3249, cval_part_p_brand#3233 AS cval_part_p_brand_0#3250, cp_name#3234 AS cp_name_0#3251, cp_mfgr#3235 AS cp_mfgr_0#3252, cp_type#3236 AS cp_type_0#3253, cp_size#3237 AS cp_size_0#3254, cp_container#3238 AS cp_container_0#3255, cp_retailprice#3239 AS cp_retailprice_0#3256, cp_comment#3240 AS cp_comment_0#3257, cp_brand#3241 AS cp_brand_0#3258]
         :  :        +- Relation[rid#3225,cval_part_p_name#3226,cval_part_p_mfgr#3227,cval_part_p_type#3228,cval_part_p_size#3229,cval_part_p_container#3230,cval_part_p_retailprice#3231,cval_part_p_comment#3232,cval_part_p_brand#3233,cp_name#3234,cp_mfgr#3235,cp_type#3236,cp_size#3237,cp_container#3238,cp_retailprice#3239,cp_comment#3240,cp_brand#3241] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#3491 AS rid_1#3524, cpfk_orders_lineitem#3492 AS cpfk_orders_lineitem_1#3525, cpfk_supplier_lineitem#3493 AS cpfk_supplier_lineitem_1#3526, cfpk_lineitem_supplier#3494 AS cfpk_lineitem_supplier_1#3527, cfpk_lineitem_partsupp#3495 AS cfpk_lineitem_partsupp_1#3528, cpfk_part_lineitem#3496 AS cpfk_part_lineitem_1#3529, cfpk_lineitem_part#3497 AS cfpk_lineitem_part_1#3530, cpfk_partsupp_lineitem#3498 AS cpfk_partsupp_lineitem_1#3531, cfpk_lineitem_orders#3499 AS cfpk_lineitem_orders_1#3532, cval_lineitem_l_quantity#3500 AS cval_lineitem_l_quantity_1#3533, cval_lineitem_l_extendedprice#3501 AS cval_lineitem_l_extendedprice_1#3534, cval_lineitem_l_discount#3502 AS cval_lineitem_l_discount_1#3535, cval_lineitem_l_tax#3503 AS cval_lineitem_l_tax_1#3536, cval_lineitem_l_returnflag#3504 AS cval_lineitem_l_returnflag_1#3537, cval_lineitem_l_linestatus#3505 AS cval_lineitem_l_linestatus_1#3538, cval_lineitem_l_commitdate#3506 AS cval_lineitem_l_commitdate_1#3539, cval_lineitem_l_receiptdate#3507 AS cval_lineitem_l_receiptdate_1#3540, cval_lineitem_l_shipinstruct#3508 AS cval_lineitem_l_shipinstruct_1#3541, cval_lineitem_l_shipmode#3509 AS cval_lineitem_l_shipmode_1#3542, cval_lineitem_l_comment#3510 AS cval_lineitem_l_comment_1#3543, cval_lineitem_l_shipdate#3511 AS cval_lineitem_l_shipdate_1#3544, cl_quantity#3512 AS cl_quantity_1#3545, cl_extendedprice#3513 AS cl_extendedprice_1#3546, cl_discount#3514 AS cl_discount_1#3547, ... 9 more fields]
         :     +- Relation[rid#3491,cpfk_orders_lineitem#3492,cpfk_supplier_lineitem#3493,cfpk_lineitem_supplier#3494,cfpk_lineitem_partsupp#3495,cpfk_part_lineitem#3496,cfpk_lineitem_part#3497,cpfk_partsupp_lineitem#3498,cfpk_lineitem_orders#3499,cval_lineitem_l_quantity#3500,cval_lineitem_l_extendedprice#3501,cval_lineitem_l_discount#3502,cval_lineitem_l_tax#3503,cval_lineitem_l_returnflag#3504,cval_lineitem_l_linestatus#3505,cval_lineitem_l_commitdate#3506,cval_lineitem_l_receiptdate#3507,cval_lineitem_l_shipinstruct#3508,cval_lineitem_l_shipmode#3509,cval_lineitem_l_comment#3510,cval_lineitem_l_shipdate#3511,cl_quantity#3512,cl_extendedprice#3513,cl_discount#3514,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#3259 AS rid_1#3292, cpfk_orders_lineitem#3260 AS cpfk_orders_lineitem_1#3293, cpfk_supplier_lineitem#3261 AS cpfk_supplier_lineitem_1#3294, cfpk_lineitem_supplier#3262 AS cfpk_lineitem_supplier_1#3295, cfpk_lineitem_partsupp#3263 AS cfpk_lineitem_partsupp_1#3296, cpfk_part_lineitem#3264 AS cpfk_part_lineitem_1#3297, cfpk_lineitem_part#3265 AS cfpk_lineitem_part_1#3298, cpfk_partsupp_lineitem#3266 AS cpfk_partsupp_lineitem_1#3299, cfpk_lineitem_orders#3267 AS cfpk_lineitem_orders_1#3300, cval_lineitem_l_quantity#3268 AS cval_lineitem_l_quantity_1#3301, cval_lineitem_l_extendedprice#3269 AS cval_lineitem_l_extendedprice_1#3302, cval_lineitem_l_discount#3270 AS cval_lineitem_l_discount_1#3303, cval_lineitem_l_tax#3271 AS cval_lineitem_l_tax_1#3304, cval_lineitem_l_returnflag#3272 AS cval_lineitem_l_returnflag_1#3305, cval_lineitem_l_linestatus#3273 AS cval_lineitem_l_linestatus_1#3306, cval_lineitem_l_commitdate#3274 AS cval_lineitem_l_commitdate_1#3307, cval_lineitem_l_receiptdate#3275 AS cval_lineitem_l_receiptdate_1#3308, cval_lineitem_l_shipinstruct#3276 AS cval_lineitem_l_shipinstruct_1#3309, cval_lineitem_l_shipmode#3277 AS cval_lineitem_l_shipmode_1#3310, cval_lineitem_l_comment#3278 AS cval_lineitem_l_comment_1#3311, cval_lineitem_l_shipdate#3279 AS cval_lineitem_l_shipdate_1#3312, cl_quantity#3280 AS cl_quantity_1#3313, cl_extendedprice#3281 AS cl_extendedprice_1#3314, cl_discount#3282 AS cl_discount_1#3315, ... 9 more fields]
            :  :  +- Relation[rid#3259,cpfk_orders_lineitem#3260,cpfk_supplier_lineitem#3261,cfpk_lineitem_supplier#3262,cfpk_lineitem_partsupp#3263,cpfk_part_lineitem#3264,cfpk_lineitem_part#3265,cpfk_partsupp_lineitem#3266,cfpk_lineitem_orders#3267,cval_lineitem_l_quantity#3268,cval_lineitem_l_extendedprice#3269,cval_lineitem_l_discount#3270,cval_lineitem_l_tax#3271,cval_lineitem_l_returnflag#3272,cval_lineitem_l_linestatus#3273,cval_lineitem_l_commitdate#3274,cval_lineitem_l_receiptdate#3275,cval_lineitem_l_shipinstruct#3276,cval_lineitem_l_shipmode#3277,cval_lineitem_l_comment#3278,cval_lineitem_l_shipdate#3279,cl_quantity#3280,cl_extendedprice#3281,cl_discount#3282,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#3325 AS rid_1#3358, cpfk_orders_lineitem#3326 AS cpfk_orders_lineitem_1#3359, cpfk_supplier_lineitem#3327 AS cpfk_supplier_lineitem_1#3360, cfpk_lineitem_supplier#3328 AS cfpk_lineitem_supplier_1#3361, cfpk_lineitem_partsupp#3329 AS cfpk_lineitem_partsupp_1#3362, cpfk_part_lineitem#3330 AS cpfk_part_lineitem_1#3363, cfpk_lineitem_part#3331 AS cfpk_lineitem_part_1#3364, cpfk_partsupp_lineitem#3332 AS cpfk_partsupp_lineitem_1#3365, cfpk_lineitem_orders#3333 AS cfpk_lineitem_orders_1#3366, cval_lineitem_l_quantity#3334 AS cval_lineitem_l_quantity_1#3367, cval_lineitem_l_extendedprice#3335 AS cval_lineitem_l_extendedprice_1#3368, cval_lineitem_l_discount#3336 AS cval_lineitem_l_discount_1#3369, cval_lineitem_l_tax#3337 AS cval_lineitem_l_tax_1#3370, cval_lineitem_l_returnflag#3338 AS cval_lineitem_l_returnflag_1#3371, cval_lineitem_l_linestatus#3339 AS cval_lineitem_l_linestatus_1#3372, cval_lineitem_l_commitdate#3340 AS cval_lineitem_l_commitdate_1#3373, cval_lineitem_l_receiptdate#3341 AS cval_lineitem_l_receiptdate_1#3374, cval_lineitem_l_shipinstruct#3342 AS cval_lineitem_l_shipinstruct_1#3375, cval_lineitem_l_shipmode#3343 AS cval_lineitem_l_shipmode_1#3376, cval_lineitem_l_comment#3344 AS cval_lineitem_l_comment_1#3377, cval_lineitem_l_shipdate#3345 AS cval_lineitem_l_shipdate_1#3378, cl_quantity#3346 AS cl_quantity_1#3379, cl_extendedprice#3347 AS cl_extendedprice_1#3380, cl_discount#3348 AS cl_discount_1#3381, ... 9 more fields]
            :        +- Relation[rid#3325,cpfk_orders_lineitem#3326,cpfk_supplier_lineitem#3327,cfpk_lineitem_supplier#3328,cfpk_lineitem_partsupp#3329,cpfk_part_lineitem#3330,cfpk_lineitem_part#3331,cpfk_partsupp_lineitem#3332,cfpk_lineitem_orders#3333,cval_lineitem_l_quantity#3334,cval_lineitem_l_extendedprice#3335,cval_lineitem_l_discount#3336,cval_lineitem_l_tax#3337,cval_lineitem_l_returnflag#3338,cval_lineitem_l_linestatus#3339,cval_lineitem_l_commitdate#3340,cval_lineitem_l_receiptdate#3341,cval_lineitem_l_shipinstruct#3342,cval_lineitem_l_shipmode#3343,cval_lineitem_l_comment#3344,cval_lineitem_l_shipdate#3345,cl_quantity#3346,cl_extendedprice#3347,cl_discount#3348,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#3391 AS rid_1#3424, cpfk_orders_lineitem#3392 AS cpfk_orders_lineitem_1#3425, cpfk_supplier_lineitem#3393 AS cpfk_supplier_lineitem_1#3426, cfpk_lineitem_supplier#3394 AS cfpk_lineitem_supplier_1#3427, cfpk_lineitem_partsupp#3395 AS cfpk_lineitem_partsupp_1#3428, cpfk_part_lineitem#3396 AS cpfk_part_lineitem_1#3429, cfpk_lineitem_part#3397 AS cfpk_lineitem_part_1#3430, cpfk_partsupp_lineitem#3398 AS cpfk_partsupp_lineitem_1#3431, cfpk_lineitem_orders#3399 AS cfpk_lineitem_orders_1#3432, cval_lineitem_l_quantity#3400 AS cval_lineitem_l_quantity_1#3433, cval_lineitem_l_extendedprice#3401 AS cval_lineitem_l_extendedprice_1#3434, cval_lineitem_l_discount#3402 AS cval_lineitem_l_discount_1#3435, cval_lineitem_l_tax#3403 AS cval_lineitem_l_tax_1#3436, cval_lineitem_l_returnflag#3404 AS cval_lineitem_l_returnflag_1#3437, cval_lineitem_l_linestatus#3405 AS cval_lineitem_l_linestatus_1#3438, cval_lineitem_l_commitdate#3406 AS cval_lineitem_l_commitdate_1#3439, cval_lineitem_l_receiptdate#3407 AS cval_lineitem_l_receiptdate_1#3440, cval_lineitem_l_shipinstruct#3408 AS cval_lineitem_l_shipinstruct_1#3441, cval_lineitem_l_shipmode#3409 AS cval_lineitem_l_shipmode_1#3442, cval_lineitem_l_comment#3410 AS cval_lineitem_l_comment_1#3443, cval_lineitem_l_shipdate#3411 AS cval_lineitem_l_shipdate_1#3444, cl_quantity#3412 AS cl_quantity_1#3445, cl_extendedprice#3413 AS cl_extendedprice_1#3446, cl_discount#3414 AS cl_discount_1#3447, ... 9 more fields]
                  +- Relation[rid#3391,cpfk_orders_lineitem#3392,cpfk_supplier_lineitem#3393,cfpk_lineitem_supplier#3394,cfpk_lineitem_partsupp#3395,cpfk_part_lineitem#3396,cfpk_lineitem_part#3397,cpfk_partsupp_lineitem#3398,cfpk_lineitem_orders#3399,cval_lineitem_l_quantity#3400,cval_lineitem_l_extendedprice#3401,cval_lineitem_l_discount#3402,cval_lineitem_l_tax#3403,cval_lineitem_l_returnflag#3404,cval_lineitem_l_linestatus#3405,cval_lineitem_l_commitdate#3406,cval_lineitem_l_receiptdate#3407,cval_lineitem_l_shipinstruct#3408,cval_lineitem_l_shipmode#3409,cval_lineitem_l_comment#3410,cval_lineitem_l_shipdate#3411,cl_quantity#3412,cl_extendedprice#3413,cl_discount#3414,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=13
Elapsed time: 62043ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/15 15:21:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:21:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3613L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 15:21:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:21:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:21:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:21:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:21:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:21:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:21:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:21:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:21:51 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:21:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:21:51 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:21:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:21:51 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:21:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3613L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#3615 AS rid_0#3622, cpfk_region_nation#3616 AS cpfk_region_nation_0#3623, cfpk_nation_region#3617 AS cfpk_nation_region_0#3624, cval_nation_n_name#3618 AS cval_nation_n_name_0#3625, cval_nation_n_comment#3619 AS cval_nation_n_comment_0#3626, cn_name#3620 AS cn_name_0#3627, cn_comment#3621 AS cn_comment_0#3628]
         :  :  :  :  :  +- Relation[rid#3615,cpfk_region_nation#3616,cfpk_nation_region#3617,cval_nation_n_name#3618,cval_nation_n_comment#3619,cn_name#3620,cn_comment#3621] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#3629 AS rid_0#3636, cpfk_region_nation#3630 AS cpfk_region_nation_0#3637, cfpk_nation_region#3631 AS cfpk_nation_region_0#3638, cval_nation_n_name#3632 AS cval_nation_n_name_0#3639, cval_nation_n_comment#3633 AS cval_nation_n_comment_0#3640, cn_name#3634 AS cn_name_0#3641, cn_comment#3635 AS cn_comment_0#3642]
         :  :  :  :        +- Relation[rid#3629,cpfk_region_nation#3630,cfpk_nation_region#3631,cval_nation_n_name#3632,cval_nation_n_comment#3633,cn_name#3634,cn_comment#3635] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#3683 AS rid_1#3696, cpfk_nation_supplier#3684 AS cpfk_nation_supplier_1#3697, cfpk_supplier_nation#3685 AS cfpk_supplier_nation_1#3698, cval_supplier_s_name#3686 AS cval_supplier_s_name_1#3699, cval_supplier_s_address#3687 AS cval_supplier_s_address_1#3700, cval_supplier_s_phone#3688 AS cval_supplier_s_phone_1#3701, cval_supplier_s_acctbal#3689 AS cval_supplier_s_acctbal_1#3702, cval_supplier_s_comment#3690 AS cval_supplier_s_comment_1#3703, cs_name#3691 AS cs_name_1#3704, cs_address#3692 AS cs_address_1#3705, cs_phone#3693 AS cs_phone_1#3706, cs_acctbal#3694 AS cs_acctbal_1#3707, cs_comment#3695 AS cs_comment_1#3708]
         :  :  :     +- Relation[rid#3683,cpfk_nation_supplier#3684,cfpk_supplier_nation#3685,cval_supplier_s_name#3686,cval_supplier_s_address#3687,cval_supplier_s_phone#3688,cval_supplier_s_acctbal#3689,cval_supplier_s_comment#3690,cs_name#3691,cs_address#3692,cs_phone#3693,cs_acctbal#3694,cs_comment#3695] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#3643 AS rid_1#3656, cpfk_nation_supplier#3644 AS cpfk_nation_supplier_1#3657, cfpk_supplier_nation#3645 AS cfpk_supplier_nation_1#3658, cval_supplier_s_name#3646 AS cval_supplier_s_name_1#3659, cval_supplier_s_address#3647 AS cval_supplier_s_address_1#3660, cval_supplier_s_phone#3648 AS cval_supplier_s_phone_1#3661, cval_supplier_s_acctbal#3649 AS cval_supplier_s_acctbal_1#3662, cval_supplier_s_comment#3650 AS cval_supplier_s_comment_1#3663, cs_name#3651 AS cs_name_1#3664, cs_address#3652 AS cs_address_1#3665, cs_phone#3653 AS cs_phone_1#3666, cs_acctbal#3654 AS cs_acctbal_1#3667, cs_comment#3655 AS cs_comment_1#3668]
         :  :     +- Relation[rid#3643,cpfk_nation_supplier#3644,cfpk_supplier_nation#3645,cval_supplier_s_name#3646,cval_supplier_s_address#3647,cval_supplier_s_phone#3648,cval_supplier_s_acctbal#3649,cval_supplier_s_comment#3650,cs_name#3651,cs_address#3652,cs_phone#3653,cs_acctbal#3654,cs_comment#3655] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#3757 AS rid_2#3768, cpfk_part_partsupp#3758 AS cpfk_part_partsupp_2#3769, cfpk_partsupp_part#3759 AS cfpk_partsupp_part_2#3770, cpfk_supplier_partsupp#3760 AS cpfk_supplier_partsupp_2#3771, cfpk_partsupp_supplier#3761 AS cfpk_partsupp_supplier_2#3772, cval_partsupp_ps_availqty#3762 AS cval_partsupp_ps_availqty_2#3773, cval_partsupp_ps_supplycost#3763 AS cval_partsupp_ps_supplycost_2#3774, cval_partsupp_ps_comment#3764 AS cval_partsupp_ps_comment_2#3775, cps_availqty#3765 AS cps_availqty_2#3776, cps_supplycost#3766 AS cps_supplycost_2#3777, cps_comment#3767 AS cps_comment_2#3778]
         :     +- Relation[rid#3757,cpfk_part_partsupp#3758,cfpk_partsupp_part#3759,cpfk_supplier_partsupp#3760,cfpk_partsupp_supplier#3761,cval_partsupp_ps_availqty#3762,cval_partsupp_ps_supplycost#3763,cval_partsupp_ps_comment#3764,cps_availqty#3765,cps_supplycost#3766,cps_comment#3767] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#3709 AS rid_2#3720, cpfk_part_partsupp#3710 AS cpfk_part_partsupp_2#3721, cfpk_partsupp_part#3711 AS cfpk_partsupp_part_2#3722, cpfk_supplier_partsupp#3712 AS cpfk_supplier_partsupp_2#3723, cfpk_partsupp_supplier#3713 AS cfpk_partsupp_supplier_2#3724, cval_partsupp_ps_availqty#3714 AS cval_partsupp_ps_availqty_2#3725, cval_partsupp_ps_supplycost#3715 AS cval_partsupp_ps_supplycost_2#3726, cval_partsupp_ps_comment#3716 AS cval_partsupp_ps_comment_2#3727, cps_availqty#3717 AS cps_availqty_2#3728, cps_supplycost#3718 AS cps_supplycost_2#3729, cps_comment#3719 AS cps_comment_2#3730]
            +- Relation[rid#3709,cpfk_part_partsupp#3710,cfpk_partsupp_part#3711,cpfk_supplier_partsupp#3712,cfpk_partsupp_supplier#3713,cval_partsupp_ps_availqty#3714,cval_partsupp_ps_supplycost#3715,cval_partsupp_ps_comment#3716,cps_availqty#3717,cps_supplycost#3718,cps_comment#3719] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=4
Elapsed time: 1272ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 15:21:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:21:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3819L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:21:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:21:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:21:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:21:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:21:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:21:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:21:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:21:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:21:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:21:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:21:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:21:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:21:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:21:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:21:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:21:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:21:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3819L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#3821 AS rid_0#3828, cpfk_region_nation#3822 AS cpfk_region_nation_0#3829, cfpk_nation_region#3823 AS cfpk_nation_region_0#3830, cval_nation_n_name#3824 AS cval_nation_n_name_0#3831, cval_nation_n_comment#3825 AS cval_nation_n_comment_0#3832, cn_name#3826 AS cn_name_0#3833, cn_comment#3827 AS cn_comment_0#3834]
            :  :  :     :  :  :  :  :  +- Relation[rid#3821,cpfk_region_nation#3822,cfpk_nation_region#3823,cval_nation_n_name#3824,cval_nation_n_comment#3825,cn_name#3826,cn_comment#3827] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#3861 AS rid_0#3868, cpfk_region_nation#3862 AS cpfk_region_nation_0#3869, cfpk_nation_region#3863 AS cfpk_nation_region_0#3870, cval_nation_n_name#3864 AS cval_nation_n_name_0#3871, cval_nation_n_comment#3865 AS cval_nation_n_comment_0#3872, cn_name#3866 AS cn_name_0#3873, cn_comment#3867 AS cn_comment_0#3874]
            :  :  :     :  :  :  :     :  +- Relation[rid#3861,cpfk_region_nation#3862,cfpk_nation_region#3863,cval_nation_n_name#3864,cval_nation_n_comment#3865,cn_name#3866,cn_comment#3867] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#3875 AS rid_1#3888, cpfk_nation_supplier#3876 AS cpfk_nation_supplier_1#3889, cfpk_supplier_nation#3877 AS cfpk_supplier_nation_1#3890, cval_supplier_s_name#3878 AS cval_supplier_s_name_1#3891, cval_supplier_s_address#3879 AS cval_supplier_s_address_1#3892, cval_supplier_s_phone#3880 AS cval_supplier_s_phone_1#3893, cval_supplier_s_acctbal#3881 AS cval_supplier_s_acctbal_1#3894, cval_supplier_s_comment#3882 AS cval_supplier_s_comment_1#3895, cs_name#3883 AS cs_name_1#3896, cs_address#3884 AS cs_address_1#3897, cs_phone#3885 AS cs_phone_1#3898, cs_acctbal#3886 AS cs_acctbal_1#3899, cs_comment#3887 AS cs_comment_1#3900]
            :  :  :     :  :  :  :        +- Relation[rid#3875,cpfk_nation_supplier#3876,cfpk_supplier_nation#3877,cval_supplier_s_name#3878,cval_supplier_s_address#3879,cval_supplier_s_phone#3880,cval_supplier_s_acctbal#3881,cval_supplier_s_comment#3882,cs_name#3883,cs_address#3884,cs_phone#3885,cs_acctbal#3886,cs_comment#3887] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#3835 AS rid_1#3848, cpfk_nation_supplier#3836 AS cpfk_nation_supplier_1#3849, cfpk_supplier_nation#3837 AS cfpk_supplier_nation_1#3850, cval_supplier_s_name#3838 AS cval_supplier_s_name_1#3851, cval_supplier_s_address#3839 AS cval_supplier_s_address_1#3852, cval_supplier_s_phone#3840 AS cval_supplier_s_phone_1#3853, cval_supplier_s_acctbal#3841 AS cval_supplier_s_acctbal_1#3854, cval_supplier_s_comment#3842 AS cval_supplier_s_comment_1#3855, cs_name#3843 AS cs_name_1#3856, cs_address#3844 AS cs_address_1#3857, cs_phone#3845 AS cs_phone_1#3858, cs_acctbal#3846 AS cs_acctbal_1#3859, cs_comment#3847 AS cs_comment_1#3860]
            :  :  :     :  :  :     +- Relation[rid#3835,cpfk_nation_supplier#3836,cfpk_supplier_nation#3837,cval_supplier_s_name#3838,cval_supplier_s_address#3839,cval_supplier_s_phone#3840,cval_supplier_s_acctbal#3841,cval_supplier_s_comment#3842,cs_name#3843,cs_address#3844,cs_phone#3845,cs_acctbal#3846,cs_comment#3847] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#3923 AS rid_1#3936, cpfk_nation_supplier#3924 AS cpfk_nation_supplier_1#3937, cfpk_supplier_nation#3925 AS cfpk_supplier_nation_1#3938, cval_supplier_s_name#3926 AS cval_supplier_s_name_1#3939, cval_supplier_s_address#3927 AS cval_supplier_s_address_1#3940, cval_supplier_s_phone#3928 AS cval_supplier_s_phone_1#3941, cval_supplier_s_acctbal#3929 AS cval_supplier_s_acctbal_1#3942, cval_supplier_s_comment#3930 AS cval_supplier_s_comment_1#3943, cs_name#3931 AS cs_name_1#3944, cs_address#3932 AS cs_address_1#3945, cs_phone#3933 AS cs_phone_1#3946, cs_acctbal#3934 AS cs_acctbal_1#3947, cs_comment#3935 AS cs_comment_1#3948]
            :  :  :     :  :     :  +- Relation[rid#3923,cpfk_nation_supplier#3924,cfpk_supplier_nation#3925,cval_supplier_s_name#3926,cval_supplier_s_address#3927,cval_supplier_s_phone#3928,cval_supplier_s_acctbal#3929,cval_supplier_s_comment#3930,cs_name#3931,cs_address#3932,cs_phone#3933,cs_acctbal#3934,cs_comment#3935] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#3949 AS rid_2#3960, cpfk_part_partsupp#3950 AS cpfk_part_partsupp_2#3961, cfpk_partsupp_part#3951 AS cfpk_partsupp_part_2#3962, cpfk_supplier_partsupp#3952 AS cpfk_supplier_partsupp_2#3963, cfpk_partsupp_supplier#3953 AS cfpk_partsupp_supplier_2#3964, cval_partsupp_ps_availqty#3954 AS cval_partsupp_ps_availqty_2#3965, cval_partsupp_ps_supplycost#3955 AS cval_partsupp_ps_supplycost_2#3966, cval_partsupp_ps_comment#3956 AS cval_partsupp_ps_comment_2#3967, cps_availqty#3957 AS cps_availqty_2#3968, cps_supplycost#3958 AS cps_supplycost_2#3969, cps_comment#3959 AS cps_comment_2#3970]
            :  :  :     :  :        +- Relation[rid#3949,cpfk_part_partsupp#3950,cfpk_partsupp_part#3951,cpfk_supplier_partsupp#3952,cfpk_partsupp_supplier#3953,cval_partsupp_ps_availqty#3954,cval_partsupp_ps_supplycost#3955,cval_partsupp_ps_comment#3956,cps_availqty#3957,cps_supplycost#3958,cps_comment#3959] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#3901 AS rid_2#3912, cpfk_part_partsupp#3902 AS cpfk_part_partsupp_2#3913, cfpk_partsupp_part#3903 AS cfpk_partsupp_part_2#3914, cpfk_supplier_partsupp#3904 AS cpfk_supplier_partsupp_2#3915, cfpk_partsupp_supplier#3905 AS cfpk_partsupp_supplier_2#3916, cval_partsupp_ps_availqty#3906 AS cval_partsupp_ps_availqty_2#3917, cval_partsupp_ps_supplycost#3907 AS cval_partsupp_ps_supplycost_2#3918, cval_partsupp_ps_comment#3908 AS cval_partsupp_ps_comment_2#3919, cps_availqty#3909 AS cps_availqty_2#3920, cps_supplycost#3910 AS cps_supplycost_2#3921, cps_comment#3911 AS cps_comment_2#3922]
            :  :  :     :     +- Relation[rid#3901,cpfk_part_partsupp#3902,cfpk_partsupp_part#3903,cpfk_supplier_partsupp#3904,cfpk_partsupp_supplier#3905,cval_partsupp_ps_availqty#3906,cval_partsupp_ps_supplycost#3907,cval_partsupp_ps_comment#3908,cps_availqty#3909,cps_supplycost#3910,cps_comment#3911] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#3971 AS rid_3#3988, cval_part_p_name#3972 AS cval_part_p_name_3#3989, cval_part_p_mfgr#3973 AS cval_part_p_mfgr_3#3990, cval_part_p_type#3974 AS cval_part_p_type_3#3991, cval_part_p_size#3975 AS cval_part_p_size_3#3992, cval_part_p_container#3976 AS cval_part_p_container_3#3993, cval_part_p_retailprice#3977 AS cval_part_p_retailprice_3#3994, cval_part_p_comment#3978 AS cval_part_p_comment_3#3995, cval_part_p_brand#3979 AS cval_part_p_brand_3#3996, cp_name#3980 AS cp_name_3#3997, cp_mfgr#3981 AS cp_mfgr_3#3998, cp_type#3982 AS cp_type_3#3999, cp_size#3983 AS cp_size_3#4000, cp_container#3984 AS cp_container_3#4001, cp_retailprice#3985 AS cp_retailprice_3#4002, cp_comment#3986 AS cp_comment_3#4003, cp_brand#3987 AS cp_brand_3#4004]
            :  :  :        +- Relation[rid#3971,cval_part_p_name#3972,cval_part_p_mfgr#3973,cval_part_p_type#3974,cval_part_p_size#3975,cval_part_p_container#3976,cval_part_p_retailprice#3977,cval_part_p_comment#3978,cval_part_p_brand#3979,cp_name#3980,cp_mfgr#3981,cp_type#3982,cp_size#3983,cp_container#3984,cp_retailprice#3985,cp_comment#3986,cp_brand#3987] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#4071 AS rid_2#4082, cpfk_part_partsupp#4072 AS cpfk_part_partsupp_2#4083, cfpk_partsupp_part#4073 AS cfpk_partsupp_part_2#4084, cpfk_supplier_partsupp#4074 AS cpfk_supplier_partsupp_2#4085, cfpk_partsupp_supplier#4075 AS cfpk_partsupp_supplier_2#4086, cval_partsupp_ps_availqty#4076 AS cval_partsupp_ps_availqty_2#4087, cval_partsupp_ps_supplycost#4077 AS cval_partsupp_ps_supplycost_2#4088, cval_partsupp_ps_comment#4078 AS cval_partsupp_ps_comment_2#4089, cps_availqty#4079 AS cps_availqty_2#4090, cps_supplycost#4080 AS cps_supplycost_2#4091, cps_comment#4081 AS cps_comment_2#4092]
            :  :     :  +- Relation[rid#4071,cpfk_part_partsupp#4072,cfpk_partsupp_part#4073,cpfk_supplier_partsupp#4074,cfpk_partsupp_supplier#4075,cval_partsupp_ps_availqty#4076,cval_partsupp_ps_supplycost#4077,cval_partsupp_ps_comment#4078,cps_availqty#4079,cps_supplycost#4080,cps_comment#4081] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#4093 AS rid_4#4126, cpfk_orders_lineitem#4094 AS cpfk_orders_lineitem_4#4127, cpfk_supplier_lineitem#4095 AS cpfk_supplier_lineitem_4#4128, cfpk_lineitem_supplier#4096 AS cfpk_lineitem_supplier_4#4129, cfpk_lineitem_partsupp#4097 AS cfpk_lineitem_partsupp_4#4130, cpfk_part_lineitem#4098 AS cpfk_part_lineitem_4#4131, cfpk_lineitem_part#4099 AS cfpk_lineitem_part_4#4132, cpfk_partsupp_lineitem#4100 AS cpfk_partsupp_lineitem_4#4133, cfpk_lineitem_orders#4101 AS cfpk_lineitem_orders_4#4134, cval_lineitem_l_quantity#4102 AS cval_lineitem_l_quantity_4#4135, cval_lineitem_l_extendedprice#4103 AS cval_lineitem_l_extendedprice_4#4136, cval_lineitem_l_discount#4104 AS cval_lineitem_l_discount_4#4137, cval_lineitem_l_tax#4105 AS cval_lineitem_l_tax_4#4138, cval_lineitem_l_returnflag#4106 AS cval_lineitem_l_returnflag_4#4139, cval_lineitem_l_linestatus#4107 AS cval_lineitem_l_linestatus_4#4140, cval_lineitem_l_commitdate#4108 AS cval_lineitem_l_commitdate_4#4141, cval_lineitem_l_receiptdate#4109 AS cval_lineitem_l_receiptdate_4#4142, cval_lineitem_l_shipinstruct#4110 AS cval_lineitem_l_shipinstruct_4#4143, cval_lineitem_l_shipmode#4111 AS cval_lineitem_l_shipmode_4#4144, cval_lineitem_l_comment#4112 AS cval_lineitem_l_comment_4#4145, cval_lineitem_l_shipdate#4113 AS cval_lineitem_l_shipdate_4#4146, cl_quantity#4114 AS cl_quantity_4#4147, cl_extendedprice#4115 AS cl_extendedprice_4#4148, cl_discount#4116 AS cl_discount_4#4149, ... 9 more fields]
            :  :        +- Relation[rid#4093,cpfk_orders_lineitem#4094,cpfk_supplier_lineitem#4095,cfpk_lineitem_supplier#4096,cfpk_lineitem_partsupp#4097,cpfk_part_lineitem#4098,cfpk_lineitem_part#4099,cpfk_partsupp_lineitem#4100,cfpk_lineitem_orders#4101,cval_lineitem_l_quantity#4102,cval_lineitem_l_extendedprice#4103,cval_lineitem_l_discount#4104,cval_lineitem_l_tax#4105,cval_lineitem_l_returnflag#4106,cval_lineitem_l_linestatus#4107,cval_lineitem_l_commitdate#4108,cval_lineitem_l_receiptdate#4109,cval_lineitem_l_shipinstruct#4110,cval_lineitem_l_shipmode#4111,cval_lineitem_l_comment#4112,cval_lineitem_l_shipdate#4113,cl_quantity#4114,cl_extendedprice#4115,cl_discount#4116,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#4005 AS rid_4#4038, cpfk_orders_lineitem#4006 AS cpfk_orders_lineitem_4#4039, cpfk_supplier_lineitem#4007 AS cpfk_supplier_lineitem_4#4040, cfpk_lineitem_supplier#4008 AS cfpk_lineitem_supplier_4#4041, cfpk_lineitem_partsupp#4009 AS cfpk_lineitem_partsupp_4#4042, cpfk_part_lineitem#4010 AS cpfk_part_lineitem_4#4043, cfpk_lineitem_part#4011 AS cfpk_lineitem_part_4#4044, cpfk_partsupp_lineitem#4012 AS cpfk_partsupp_lineitem_4#4045, cfpk_lineitem_orders#4013 AS cfpk_lineitem_orders_4#4046, cval_lineitem_l_quantity#4014 AS cval_lineitem_l_quantity_4#4047, cval_lineitem_l_extendedprice#4015 AS cval_lineitem_l_extendedprice_4#4048, cval_lineitem_l_discount#4016 AS cval_lineitem_l_discount_4#4049, cval_lineitem_l_tax#4017 AS cval_lineitem_l_tax_4#4050, cval_lineitem_l_returnflag#4018 AS cval_lineitem_l_returnflag_4#4051, cval_lineitem_l_linestatus#4019 AS cval_lineitem_l_linestatus_4#4052, cval_lineitem_l_commitdate#4020 AS cval_lineitem_l_commitdate_4#4053, cval_lineitem_l_receiptdate#4021 AS cval_lineitem_l_receiptdate_4#4054, cval_lineitem_l_shipinstruct#4022 AS cval_lineitem_l_shipinstruct_4#4055, cval_lineitem_l_shipmode#4023 AS cval_lineitem_l_shipmode_4#4056, cval_lineitem_l_comment#4024 AS cval_lineitem_l_comment_4#4057, cval_lineitem_l_shipdate#4025 AS cval_lineitem_l_shipdate_4#4058, cl_quantity#4026 AS cl_quantity_4#4059, cl_extendedprice#4027 AS cl_extendedprice_4#4060, cl_discount#4028 AS cl_discount_4#4061, ... 9 more fields]
            :     +- Relation[rid#4005,cpfk_orders_lineitem#4006,cpfk_supplier_lineitem#4007,cfpk_lineitem_supplier#4008,cfpk_lineitem_partsupp#4009,cpfk_part_lineitem#4010,cfpk_lineitem_part#4011,cpfk_partsupp_lineitem#4012,cfpk_lineitem_orders#4013,cval_lineitem_l_quantity#4014,cval_lineitem_l_extendedprice#4015,cval_lineitem_l_discount#4016,cval_lineitem_l_tax#4017,cval_lineitem_l_returnflag#4018,cval_lineitem_l_linestatus#4019,cval_lineitem_l_commitdate#4020,cval_lineitem_l_receiptdate#4021,cval_lineitem_l_shipinstruct#4022,cval_lineitem_l_shipmode#4023,cval_lineitem_l_comment#4024,cval_lineitem_l_shipdate#4025,cl_quantity#4026,cl_extendedprice#4027,cl_discount#4028,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#4159 AS rid_5#4176, cpfk_customer_orders#4160 AS cpfk_customer_orders_5#4177, cfpk_orders_customer#4161 AS cfpk_orders_customer_5#4178, cval_orders_o_orderstatus#4162 AS cval_orders_o_orderstatus_5#4179, cval_orders_o_totalprice#4163 AS cval_orders_o_totalprice_5#4180, cval_orders_o_orderpriority#4164 AS cval_orders_o_orderpriority_5#4181, cval_orders_o_clerk#4165 AS cval_orders_o_clerk_5#4182, cval_orders_o_shippriority#4166 AS cval_orders_o_shippriority_5#4183, cval_orders_o_comment#4167 AS cval_orders_o_comment_5#4184, cval_orders_o_orderdate#4168 AS cval_orders_o_orderdate_5#4185, co_orderstatus#4169 AS co_orderstatus_5#4186, co_totalprice#4170 AS co_totalprice_5#4187, co_orderpriority#4171 AS co_orderpriority_5#4188, co_clerk#4172 AS co_clerk_5#4189, co_shippriority#4173 AS co_shippriority_5#4190, co_comment#4174 AS co_comment_5#4191, co_orderdate#4175 AS co_orderdate_5#4192]
               +- Relation[rid#4159,cpfk_customer_orders#4160,cfpk_orders_customer#4161,cval_orders_o_orderstatus#4162,cval_orders_o_totalprice#4163,cval_orders_o_orderpriority#4164,cval_orders_o_clerk#4165,cval_orders_o_shippriority#4166,cval_orders_o_comment#4167,cval_orders_o_orderdate#4168,co_orderstatus#4169,co_totalprice#4170,co_orderpriority#4171,co_clerk#4172,co_shippriority#4173,co_comment#4174,co_orderdate#4175] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 170906ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/15 15:24:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:24:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4297L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 15:24:43 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:24:43 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:24:43 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:24:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:24:43 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:24:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:24:43 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:24:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:24:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:24:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:24:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:24:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:24:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:24:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:24:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:24:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:24:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4297L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#4299 AS rid_0#4304, cval_region_r_name#4300 AS cval_region_r_name_0#4305, cval_region_r_comment#4301 AS cval_region_r_comment_0#4306, cr_name#4302 AS cr_name_0#4307, cr_comment#4303 AS cr_comment_0#4308]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#4299,cval_region_r_name#4300,cval_region_r_comment#4301,cr_name#4302,cr_comment#4303] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#4309 AS rid_0#4314, cval_region_r_name#4310 AS cval_region_r_name_0#4315, cval_region_r_comment#4311 AS cval_region_r_comment_0#4316, cr_name#4312 AS cr_name_0#4317, cr_comment#4313 AS cr_comment_0#4318]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#4309,cval_region_r_name#4310,cval_region_r_comment#4311,cr_name#4312,cr_comment#4313] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- Project [rid#4343 AS rid_1#4350, cpfk_region_nation#4344 AS cpfk_region_nation_1#4351, cfpk_nation_region#4345 AS cfpk_nation_region_1#4352, cval_nation_n_name#4346 AS cval_nation_n_name_1#4353, cval_nation_n_comment#4347 AS cval_nation_n_comment_1#4354, cn_name#4348 AS cn_name_1#4355, cn_comment#4349 AS cn_comment_1#4356]
         :     :  :  :  :  :  :  :  :     +- Relation[rid#4343,cpfk_region_nation#4344,cfpk_nation_region#4345,cval_nation_n_name#4346,cval_nation_n_comment#4347,cn_name#4348,cn_comment#4349] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#4319 AS rid_1#4326, cpfk_region_nation#4320 AS cpfk_region_nation_1#4327, cfpk_nation_region#4321 AS cfpk_nation_region_1#4328, cval_nation_n_name#4322 AS cval_nation_n_name_1#4329, cval_nation_n_comment#4323 AS cval_nation_n_comment_1#4330, cn_name#4324 AS cn_name_1#4331, cn_comment#4325 AS cn_comment_1#4332]
         :     :  :  :  :  :  :  :     +- Relation[rid#4319,cpfk_region_nation#4320,cfpk_nation_region#4321,cval_nation_n_name#4322,cval_nation_n_comment#4323,cn_name#4324,cn_comment#4325] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- Project [rid#4401 AS rid_2#4416, cpfk_nation_customer#4402 AS cpfk_nation_customer_2#4417, cfpk_customer_nation#4403 AS cfpk_customer_nation_2#4418, cval_customer_c_name#4404 AS cval_customer_c_name_2#4419, cval_customer_c_address#4405 AS cval_customer_c_address_2#4420, cval_customer_c_phone#4406 AS cval_customer_c_phone_2#4421, cval_customer_c_acctbal#4407 AS cval_customer_c_acctbal_2#4422, cval_customer_c_comment#4408 AS cval_customer_c_comment_2#4423, cval_customer_c_mktsegment#4409 AS cval_customer_c_mktsegment_2#4424, cc_name#4410 AS cc_name_2#4425, cc_address#4411 AS cc_address_2#4426, cc_phone#4412 AS cc_phone_2#4427, cc_acctbal#4413 AS cc_acctbal_2#4428, cc_comment#4414 AS cc_comment_2#4429, cc_mktsegment#4415 AS cc_mktsegment_2#4430]
         :     :  :  :  :  :  :     +- Relation[rid#4401,cpfk_nation_customer#4402,cfpk_customer_nation#4403,cval_customer_c_name#4404,cval_customer_c_address#4405,cval_customer_c_phone#4406,cval_customer_c_acctbal#4407,cval_customer_c_comment#4408,cval_customer_c_mktsegment#4409,cc_name#4410,cc_address#4411,cc_phone#4412,cc_acctbal#4413,cc_comment#4414,cc_mktsegment#4415] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#4357 AS rid_2#4372, cpfk_nation_customer#4358 AS cpfk_nation_customer_2#4373, cfpk_customer_nation#4359 AS cfpk_customer_nation_2#4374, cval_customer_c_name#4360 AS cval_customer_c_name_2#4375, cval_customer_c_address#4361 AS cval_customer_c_address_2#4376, cval_customer_c_phone#4362 AS cval_customer_c_phone_2#4377, cval_customer_c_acctbal#4363 AS cval_customer_c_acctbal_2#4378, cval_customer_c_comment#4364 AS cval_customer_c_comment_2#4379, cval_customer_c_mktsegment#4365 AS cval_customer_c_mktsegment_2#4380, cc_name#4366 AS cc_name_2#4381, cc_address#4367 AS cc_address_2#4382, cc_phone#4368 AS cc_phone_2#4383, cc_acctbal#4369 AS cc_acctbal_2#4384, cc_comment#4370 AS cc_comment_2#4385, cc_mktsegment#4371 AS cc_mktsegment_2#4386]
         :     :  :  :  :  :     +- Relation[rid#4357,cpfk_nation_customer#4358,cfpk_customer_nation#4359,cval_customer_c_name#4360,cval_customer_c_address#4361,cval_customer_c_phone#4362,cval_customer_c_acctbal#4363,cval_customer_c_comment#4364,cval_customer_c_mktsegment#4365,cc_name#4366,cc_address#4367,cc_phone#4368,cc_acctbal#4369,cc_comment#4370,cc_mktsegment#4371] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- Project [rid#4495 AS rid_3#4512, cpfk_customer_orders#4496 AS cpfk_customer_orders_3#4513, cfpk_orders_customer#4497 AS cfpk_orders_customer_3#4514, cval_orders_o_orderstatus#4498 AS cval_orders_o_orderstatus_3#4515, cval_orders_o_totalprice#4499 AS cval_orders_o_totalprice_3#4516, cval_orders_o_orderpriority#4500 AS cval_orders_o_orderpriority_3#4517, cval_orders_o_clerk#4501 AS cval_orders_o_clerk_3#4518, cval_orders_o_shippriority#4502 AS cval_orders_o_shippriority_3#4519, cval_orders_o_comment#4503 AS cval_orders_o_comment_3#4520, cval_orders_o_orderdate#4504 AS cval_orders_o_orderdate_3#4521, co_orderstatus#4505 AS co_orderstatus_3#4522, co_totalprice#4506 AS co_totalprice_3#4523, co_orderpriority#4507 AS co_orderpriority_3#4524, co_clerk#4508 AS co_clerk_3#4525, co_shippriority#4509 AS co_shippriority_3#4526, co_comment#4510 AS co_comment_3#4527, co_orderdate#4511 AS co_orderdate_3#4528]
         :     :  :  :  :     +- Relation[rid#4495,cpfk_customer_orders#4496,cfpk_orders_customer#4497,cval_orders_o_orderstatus#4498,cval_orders_o_totalprice#4499,cval_orders_o_orderpriority#4500,cval_orders_o_clerk#4501,cval_orders_o_shippriority#4502,cval_orders_o_comment#4503,cval_orders_o_orderdate#4504,co_orderstatus#4505,co_totalprice#4506,co_orderpriority#4507,co_clerk#4508,co_shippriority#4509,co_comment#4510,co_orderdate#4511] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#4431 AS rid_3#4448, cpfk_customer_orders#4432 AS cpfk_customer_orders_3#4449, cfpk_orders_customer#4433 AS cfpk_orders_customer_3#4450, cval_orders_o_orderstatus#4434 AS cval_orders_o_orderstatus_3#4451, cval_orders_o_totalprice#4435 AS cval_orders_o_totalprice_3#4452, cval_orders_o_orderpriority#4436 AS cval_orders_o_orderpriority_3#4453, cval_orders_o_clerk#4437 AS cval_orders_o_clerk_3#4454, cval_orders_o_shippriority#4438 AS cval_orders_o_shippriority_3#4455, cval_orders_o_comment#4439 AS cval_orders_o_comment_3#4456, cval_orders_o_orderdate#4440 AS cval_orders_o_orderdate_3#4457, co_orderstatus#4441 AS co_orderstatus_3#4458, co_totalprice#4442 AS co_totalprice_3#4459, co_orderpriority#4443 AS co_orderpriority_3#4460, co_clerk#4444 AS co_clerk_3#4461, co_shippriority#4445 AS co_shippriority_3#4462, co_comment#4446 AS co_comment_3#4463, co_orderdate#4447 AS co_orderdate_3#4464]
         :     :  :  :     +- Relation[rid#4431,cpfk_customer_orders#4432,cfpk_orders_customer#4433,cval_orders_o_orderstatus#4434,cval_orders_o_totalprice#4435,cval_orders_o_orderpriority#4436,cval_orders_o_clerk#4437,cval_orders_o_shippriority#4438,cval_orders_o_comment#4439,cval_orders_o_orderdate#4440,co_orderstatus#4441,co_totalprice#4442,co_orderpriority#4443,co_clerk#4444,co_shippriority#4445,co_comment#4446,co_orderdate#4447] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- Project [rid#4629 AS rid_4#4662, cpfk_orders_lineitem#4630 AS cpfk_orders_lineitem_4#4663, cpfk_supplier_lineitem#4631 AS cpfk_supplier_lineitem_4#4664, cfpk_lineitem_supplier#4632 AS cfpk_lineitem_supplier_4#4665, cfpk_lineitem_partsupp#4633 AS cfpk_lineitem_partsupp_4#4666, cpfk_part_lineitem#4634 AS cpfk_part_lineitem_4#4667, cfpk_lineitem_part#4635 AS cfpk_lineitem_part_4#4668, cpfk_partsupp_lineitem#4636 AS cpfk_partsupp_lineitem_4#4669, cfpk_lineitem_orders#4637 AS cfpk_lineitem_orders_4#4670, cval_lineitem_l_quantity#4638 AS cval_lineitem_l_quantity_4#4671, cval_lineitem_l_extendedprice#4639 AS cval_lineitem_l_extendedprice_4#4672, cval_lineitem_l_discount#4640 AS cval_lineitem_l_discount_4#4673, cval_lineitem_l_tax#4641 AS cval_lineitem_l_tax_4#4674, cval_lineitem_l_returnflag#4642 AS cval_lineitem_l_returnflag_4#4675, cval_lineitem_l_linestatus#4643 AS cval_lineitem_l_linestatus_4#4676, cval_lineitem_l_commitdate#4644 AS cval_lineitem_l_commitdate_4#4677, cval_lineitem_l_receiptdate#4645 AS cval_lineitem_l_receiptdate_4#4678, cval_lineitem_l_shipinstruct#4646 AS cval_lineitem_l_shipinstruct_4#4679, cval_lineitem_l_shipmode#4647 AS cval_lineitem_l_shipmode_4#4680, cval_lineitem_l_comment#4648 AS cval_lineitem_l_comment_4#4681, cval_lineitem_l_shipdate#4649 AS cval_lineitem_l_shipdate_4#4682, cl_quantity#4650 AS cl_quantity_4#4683, cl_extendedprice#4651 AS cl_extendedprice_4#4684, cl_discount#4652 AS cl_discount_4#4685, ... 9 more fields]
         :     :  :     +- Relation[rid#4629,cpfk_orders_lineitem#4630,cpfk_supplier_lineitem#4631,cfpk_lineitem_supplier#4632,cfpk_lineitem_partsupp#4633,cpfk_part_lineitem#4634,cfpk_lineitem_part#4635,cpfk_partsupp_lineitem#4636,cfpk_lineitem_orders#4637,cval_lineitem_l_quantity#4638,cval_lineitem_l_extendedprice#4639,cval_lineitem_l_discount#4640,cval_lineitem_l_tax#4641,cval_lineitem_l_returnflag#4642,cval_lineitem_l_linestatus#4643,cval_lineitem_l_commitdate#4644,cval_lineitem_l_receiptdate#4645,cval_lineitem_l_shipinstruct#4646,cval_lineitem_l_shipmode#4647,cval_lineitem_l_comment#4648,cval_lineitem_l_shipdate#4649,cl_quantity#4650,cl_extendedprice#4651,cl_discount#4652,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#4529 AS rid_4#4562, cpfk_orders_lineitem#4530 AS cpfk_orders_lineitem_4#4563, cpfk_supplier_lineitem#4531 AS cpfk_supplier_lineitem_4#4564, cfpk_lineitem_supplier#4532 AS cfpk_lineitem_supplier_4#4565, cfpk_lineitem_partsupp#4533 AS cfpk_lineitem_partsupp_4#4566, cpfk_part_lineitem#4534 AS cpfk_part_lineitem_4#4567, cfpk_lineitem_part#4535 AS cfpk_lineitem_part_4#4568, cpfk_partsupp_lineitem#4536 AS cpfk_partsupp_lineitem_4#4569, cfpk_lineitem_orders#4537 AS cfpk_lineitem_orders_4#4570, cval_lineitem_l_quantity#4538 AS cval_lineitem_l_quantity_4#4571, cval_lineitem_l_extendedprice#4539 AS cval_lineitem_l_extendedprice_4#4572, cval_lineitem_l_discount#4540 AS cval_lineitem_l_discount_4#4573, cval_lineitem_l_tax#4541 AS cval_lineitem_l_tax_4#4574, cval_lineitem_l_returnflag#4542 AS cval_lineitem_l_returnflag_4#4575, cval_lineitem_l_linestatus#4543 AS cval_lineitem_l_linestatus_4#4576, cval_lineitem_l_commitdate#4544 AS cval_lineitem_l_commitdate_4#4577, cval_lineitem_l_receiptdate#4545 AS cval_lineitem_l_receiptdate_4#4578, cval_lineitem_l_shipinstruct#4546 AS cval_lineitem_l_shipinstruct_4#4579, cval_lineitem_l_shipmode#4547 AS cval_lineitem_l_shipmode_4#4580, cval_lineitem_l_comment#4548 AS cval_lineitem_l_comment_4#4581, cval_lineitem_l_shipdate#4549 AS cval_lineitem_l_shipdate_4#4582, cl_quantity#4550 AS cl_quantity_4#4583, cl_extendedprice#4551 AS cl_extendedprice_4#4584, cl_discount#4552 AS cl_discount_4#4585, ... 9 more fields]
         :     :     +- Relation[rid#4529,cpfk_orders_lineitem#4530,cpfk_supplier_lineitem#4531,cfpk_lineitem_supplier#4532,cfpk_lineitem_partsupp#4533,cpfk_part_lineitem#4534,cfpk_lineitem_part#4535,cpfk_partsupp_lineitem#4536,cfpk_lineitem_orders#4537,cval_lineitem_l_quantity#4538,cval_lineitem_l_extendedprice#4539,cval_lineitem_l_discount#4540,cval_lineitem_l_tax#4541,cval_lineitem_l_returnflag#4542,cval_lineitem_l_linestatus#4543,cval_lineitem_l_commitdate#4544,cval_lineitem_l_receiptdate#4545,cval_lineitem_l_shipinstruct#4546,cval_lineitem_l_shipmode#4547,cval_lineitem_l_comment#4548,cval_lineitem_l_shipdate#4549,cl_quantity#4550,cl_extendedprice#4551,cl_discount#4552,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#4695 AS rid_5#4708, cpfk_nation_supplier#4696 AS cpfk_nation_supplier_5#4709, cfpk_supplier_nation#4697 AS cfpk_supplier_nation_5#4710, cval_supplier_s_name#4698 AS cval_supplier_s_name_5#4711, cval_supplier_s_address#4699 AS cval_supplier_s_address_5#4712, cval_supplier_s_phone#4700 AS cval_supplier_s_phone_5#4713, cval_supplier_s_acctbal#4701 AS cval_supplier_s_acctbal_5#4714, cval_supplier_s_comment#4702 AS cval_supplier_s_comment_5#4715, cs_name#4703 AS cs_name_5#4716, cs_address#4704 AS cs_address_5#4717, cs_phone#4705 AS cs_phone_5#4718, cs_acctbal#4706 AS cs_acctbal_5#4719, cs_comment#4707 AS cs_comment_5#4720]
         :        +- Relation[rid#4695,cpfk_nation_supplier#4696,cfpk_supplier_nation#4697,cval_supplier_s_name#4698,cval_supplier_s_address#4699,cval_supplier_s_phone#4700,cval_supplier_s_acctbal#4701,cval_supplier_s_comment#4702,cs_name#4703,cs_address#4704,cs_phone#4705,cs_acctbal#4706,cs_comment#4707] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#4721 AS rid_1#4728, cpfk_region_nation#4722 AS cpfk_region_nation_1#4729, cfpk_nation_region#4723 AS cfpk_nation_region_1#4730, cval_nation_n_name#4724 AS cval_nation_n_name_1#4731, cval_nation_n_comment#4725 AS cval_nation_n_comment_1#4732, cn_name#4726 AS cn_name_1#4733, cn_comment#4727 AS cn_comment_1#4734]
            :  +- Relation[rid#4721,cpfk_region_nation#4722,cfpk_nation_region#4723,cval_nation_n_name#4724,cval_nation_n_comment#4725,cn_name#4726,cn_comment#4727] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#4735 AS rid_5#4748, cpfk_nation_supplier#4736 AS cpfk_nation_supplier_5#4749, cfpk_supplier_nation#4737 AS cfpk_supplier_nation_5#4750, cval_supplier_s_name#4738 AS cval_supplier_s_name_5#4751, cval_supplier_s_address#4739 AS cval_supplier_s_address_5#4752, cval_supplier_s_phone#4740 AS cval_supplier_s_phone_5#4753, cval_supplier_s_acctbal#4741 AS cval_supplier_s_acctbal_5#4754, cval_supplier_s_comment#4742 AS cval_supplier_s_comment_5#4755, cs_name#4743 AS cs_name_5#4756, cs_address#4744 AS cs_address_5#4757, cs_phone#4745 AS cs_phone_5#4758, cs_acctbal#4746 AS cs_acctbal_5#4759, cs_comment#4747 AS cs_comment_5#4760]
               +- Relation[rid#4735,cpfk_nation_supplier#4736,cfpk_supplier_nation#4737,cval_supplier_s_name#4738,cval_supplier_s_address#4739,cval_supplier_s_phone#4740,cval_supplier_s_acctbal#4741,cval_supplier_s_comment#4742,cs_name#4743,cs_address#4744,cs_phone#4745,cs_acctbal#4746,cs_comment#4747] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=8
Elapsed time: 20995ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/15 15:25:04 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:25:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4859L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:25:04 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 15:25:04 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 15:25:04 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 15:25:04 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 15:25:04 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 15:25:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4859L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#4861 AS rid_0#4876, cpfk_nation_customer#4862 AS cpfk_nation_customer_0#4877, cfpk_customer_nation#4863 AS cfpk_customer_nation_0#4878, cval_customer_c_name#4864 AS cval_customer_c_name_0#4879, cval_customer_c_address#4865 AS cval_customer_c_address_0#4880, cval_customer_c_phone#4866 AS cval_customer_c_phone_0#4881, cval_customer_c_acctbal#4867 AS cval_customer_c_acctbal_0#4882, cval_customer_c_comment#4868 AS cval_customer_c_comment_0#4883, cval_customer_c_mktsegment#4869 AS cval_customer_c_mktsegment_0#4884, cc_name#4870 AS cc_name_0#4885, cc_address#4871 AS cc_address_0#4886, cc_phone#4872 AS cc_phone_0#4887, cc_acctbal#4873 AS cc_acctbal_0#4888, cc_comment#4874 AS cc_comment_0#4889, cc_mktsegment#4875 AS cc_mktsegment_0#4890]
         :  :  :  :  :  +- Relation[rid#4861,cpfk_nation_customer#4862,cfpk_customer_nation#4863,cval_customer_c_name#4864,cval_customer_c_address#4865,cval_customer_c_phone#4866,cval_customer_c_acctbal#4867,cval_customer_c_comment#4868,cval_customer_c_mktsegment#4869,cc_name#4870,cc_address#4871,cc_phone#4872,cc_acctbal#4873,cc_comment#4874,cc_mktsegment#4875] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#4891 AS rid_0#4906, cpfk_nation_customer#4892 AS cpfk_nation_customer_0#4907, cfpk_customer_nation#4893 AS cfpk_customer_nation_0#4908, cval_customer_c_name#4894 AS cval_customer_c_name_0#4909, cval_customer_c_address#4895 AS cval_customer_c_address_0#4910, cval_customer_c_phone#4896 AS cval_customer_c_phone_0#4911, cval_customer_c_acctbal#4897 AS cval_customer_c_acctbal_0#4912, cval_customer_c_comment#4898 AS cval_customer_c_comment_0#4913, cval_customer_c_mktsegment#4899 AS cval_customer_c_mktsegment_0#4914, cc_name#4900 AS cc_name_0#4915, cc_address#4901 AS cc_address_0#4916, cc_phone#4902 AS cc_phone_0#4917, cc_acctbal#4903 AS cc_acctbal_0#4918, cc_comment#4904 AS cc_comment_0#4919, cc_mktsegment#4905 AS cc_mktsegment_0#4920]
         :  :  :  :        +- Relation[rid#4891,cpfk_nation_customer#4892,cfpk_customer_nation#4893,cval_customer_c_name#4894,cval_customer_c_address#4895,cval_customer_c_phone#4896,cval_customer_c_acctbal#4897,cval_customer_c_comment#4898,cval_customer_c_mktsegment#4899,cc_name#4900,cc_address#4901,cc_phone#4902,cc_acctbal#4903,cc_comment#4904,cc_mktsegment#4905] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- Project [rid#4985 AS rid_1#5002, cpfk_customer_orders#4986 AS cpfk_customer_orders_1#5003, cfpk_orders_customer#4987 AS cfpk_orders_customer_1#5004, cval_orders_o_orderstatus#4988 AS cval_orders_o_orderstatus_1#5005, cval_orders_o_totalprice#4989 AS cval_orders_o_totalprice_1#5006, cval_orders_o_orderpriority#4990 AS cval_orders_o_orderpriority_1#5007, cval_orders_o_clerk#4991 AS cval_orders_o_clerk_1#5008, cval_orders_o_shippriority#4992 AS cval_orders_o_shippriority_1#5009, cval_orders_o_comment#4993 AS cval_orders_o_comment_1#5010, cval_orders_o_orderdate#4994 AS cval_orders_o_orderdate_1#5011, co_orderstatus#4995 AS co_orderstatus_1#5012, co_totalprice#4996 AS co_totalprice_1#5013, co_orderpriority#4997 AS co_orderpriority_1#5014, co_clerk#4998 AS co_clerk_1#5015, co_shippriority#4999 AS co_shippriority_1#5016, co_comment#5000 AS co_comment_1#5017, co_orderdate#5001 AS co_orderdate_1#5018]
         :  :  :     +- Relation[rid#4985,cpfk_customer_orders#4986,cfpk_orders_customer#4987,cval_orders_o_orderstatus#4988,cval_orders_o_totalprice#4989,cval_orders_o_orderpriority#4990,cval_orders_o_clerk#4991,cval_orders_o_shippriority#4992,cval_orders_o_comment#4993,cval_orders_o_orderdate#4994,co_orderstatus#4995,co_totalprice#4996,co_orderpriority#4997,co_clerk#4998,co_shippriority#4999,co_comment#5000,co_orderdate#5001] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#4921 AS rid_1#4938, cpfk_customer_orders#4922 AS cpfk_customer_orders_1#4939, cfpk_orders_customer#4923 AS cfpk_orders_customer_1#4940, cval_orders_o_orderstatus#4924 AS cval_orders_o_orderstatus_1#4941, cval_orders_o_totalprice#4925 AS cval_orders_o_totalprice_1#4942, cval_orders_o_orderpriority#4926 AS cval_orders_o_orderpriority_1#4943, cval_orders_o_clerk#4927 AS cval_orders_o_clerk_1#4944, cval_orders_o_shippriority#4928 AS cval_orders_o_shippriority_1#4945, cval_orders_o_comment#4929 AS cval_orders_o_comment_1#4946, cval_orders_o_orderdate#4930 AS cval_orders_o_orderdate_1#4947, co_orderstatus#4931 AS co_orderstatus_1#4948, co_totalprice#4932 AS co_totalprice_1#4949, co_orderpriority#4933 AS co_orderpriority_1#4950, co_clerk#4934 AS co_clerk_1#4951, co_shippriority#4935 AS co_shippriority_1#4952, co_comment#4936 AS co_comment_1#4953, co_orderdate#4937 AS co_orderdate_1#4954]
         :  :     +- Relation[rid#4921,cpfk_customer_orders#4922,cfpk_orders_customer#4923,cval_orders_o_orderstatus#4924,cval_orders_o_totalprice#4925,cval_orders_o_orderpriority#4926,cval_orders_o_clerk#4927,cval_orders_o_shippriority#4928,cval_orders_o_comment#4929,cval_orders_o_orderdate#4930,co_orderstatus#4931,co_totalprice#4932,co_orderpriority#4933,co_clerk#4934,co_shippriority#4935,co_comment#4936,co_orderdate#4937] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#5119 AS rid_2#5152, cpfk_orders_lineitem#5120 AS cpfk_orders_lineitem_2#5153, cpfk_supplier_lineitem#5121 AS cpfk_supplier_lineitem_2#5154, cfpk_lineitem_supplier#5122 AS cfpk_lineitem_supplier_2#5155, cfpk_lineitem_partsupp#5123 AS cfpk_lineitem_partsupp_2#5156, cpfk_part_lineitem#5124 AS cpfk_part_lineitem_2#5157, cfpk_lineitem_part#5125 AS cfpk_lineitem_part_2#5158, cpfk_partsupp_lineitem#5126 AS cpfk_partsupp_lineitem_2#5159, cfpk_lineitem_orders#5127 AS cfpk_lineitem_orders_2#5160, cval_lineitem_l_quantity#5128 AS cval_lineitem_l_quantity_2#5161, cval_lineitem_l_extendedprice#5129 AS cval_lineitem_l_extendedprice_2#5162, cval_lineitem_l_discount#5130 AS cval_lineitem_l_discount_2#5163, cval_lineitem_l_tax#5131 AS cval_lineitem_l_tax_2#5164, cval_lineitem_l_returnflag#5132 AS cval_lineitem_l_returnflag_2#5165, cval_lineitem_l_linestatus#5133 AS cval_lineitem_l_linestatus_2#5166, cval_lineitem_l_commitdate#5134 AS cval_lineitem_l_commitdate_2#5167, cval_lineitem_l_receiptdate#5135 AS cval_lineitem_l_receiptdate_2#5168, cval_lineitem_l_shipinstruct#5136 AS cval_lineitem_l_shipinstruct_2#5169, cval_lineitem_l_shipmode#5137 AS cval_lineitem_l_shipmode_2#5170, cval_lineitem_l_comment#5138 AS cval_lineitem_l_comment_2#5171, cval_lineitem_l_shipdate#5139 AS cval_lineitem_l_shipdate_2#5172, cl_quantity#5140 AS cl_quantity_2#5173, cl_extendedprice#5141 AS cl_extendedprice_2#5174, cl_discount#5142 AS cl_discount_2#5175, ... 9 more fields]
         :     +- Relation[rid#5119,cpfk_orders_lineitem#5120,cpfk_supplier_lineitem#5121,cfpk_lineitem_supplier#5122,cfpk_lineitem_partsupp#5123,cpfk_part_lineitem#5124,cfpk_lineitem_part#5125,cpfk_partsupp_lineitem#5126,cfpk_lineitem_orders#5127,cval_lineitem_l_quantity#5128,cval_lineitem_l_extendedprice#5129,cval_lineitem_l_discount#5130,cval_lineitem_l_tax#5131,cval_lineitem_l_returnflag#5132,cval_lineitem_l_linestatus#5133,cval_lineitem_l_commitdate#5134,cval_lineitem_l_receiptdate#5135,cval_lineitem_l_shipinstruct#5136,cval_lineitem_l_shipmode#5137,cval_lineitem_l_comment#5138,cval_lineitem_l_shipdate#5139,cl_quantity#5140,cl_extendedprice#5141,cl_discount#5142,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5019 AS rid_2#5052, cpfk_orders_lineitem#5020 AS cpfk_orders_lineitem_2#5053, cpfk_supplier_lineitem#5021 AS cpfk_supplier_lineitem_2#5054, cfpk_lineitem_supplier#5022 AS cfpk_lineitem_supplier_2#5055, cfpk_lineitem_partsupp#5023 AS cfpk_lineitem_partsupp_2#5056, cpfk_part_lineitem#5024 AS cpfk_part_lineitem_2#5057, cfpk_lineitem_part#5025 AS cfpk_lineitem_part_2#5058, cpfk_partsupp_lineitem#5026 AS cpfk_partsupp_lineitem_2#5059, cfpk_lineitem_orders#5027 AS cfpk_lineitem_orders_2#5060, cval_lineitem_l_quantity#5028 AS cval_lineitem_l_quantity_2#5061, cval_lineitem_l_extendedprice#5029 AS cval_lineitem_l_extendedprice_2#5062, cval_lineitem_l_discount#5030 AS cval_lineitem_l_discount_2#5063, cval_lineitem_l_tax#5031 AS cval_lineitem_l_tax_2#5064, cval_lineitem_l_returnflag#5032 AS cval_lineitem_l_returnflag_2#5065, cval_lineitem_l_linestatus#5033 AS cval_lineitem_l_linestatus_2#5066, cval_lineitem_l_commitdate#5034 AS cval_lineitem_l_commitdate_2#5067, cval_lineitem_l_receiptdate#5035 AS cval_lineitem_l_receiptdate_2#5068, cval_lineitem_l_shipinstruct#5036 AS cval_lineitem_l_shipinstruct_2#5069, cval_lineitem_l_shipmode#5037 AS cval_lineitem_l_shipmode_2#5070, cval_lineitem_l_comment#5038 AS cval_lineitem_l_comment_2#5071, cval_lineitem_l_shipdate#5039 AS cval_lineitem_l_shipdate_2#5072, cl_quantity#5040 AS cl_quantity_2#5073, cl_extendedprice#5041 AS cl_extendedprice_2#5074, cl_discount#5042 AS cl_discount_2#5075, ... 9 more fields]
            +- Relation[rid#5019,cpfk_orders_lineitem#5020,cpfk_supplier_lineitem#5021,cfpk_lineitem_supplier#5022,cfpk_lineitem_partsupp#5023,cpfk_part_lineitem#5024,cfpk_lineitem_part#5025,cpfk_partsupp_lineitem#5026,cfpk_lineitem_orders#5027,cval_lineitem_l_quantity#5028,cval_lineitem_l_extendedprice#5029,cval_lineitem_l_discount#5030,cval_lineitem_l_tax#5031,cval_lineitem_l_returnflag#5032,cval_lineitem_l_linestatus#5033,cval_lineitem_l_commitdate#5034,cval_lineitem_l_receiptdate#5035,cval_lineitem_l_shipinstruct#5036,cval_lineitem_l_shipmode#5037,cval_lineitem_l_comment#5038,cval_lineitem_l_shipdate#5039,cl_quantity#5040,cl_extendedprice#5041,cl_discount#5042,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=75006
Elapsed time: 6246ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/15 15:25:10 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:25:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5278L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:25:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5278L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#5280 AS rid_0#5313, cpfk_orders_lineitem#5281 AS cpfk_orders_lineitem_0#5314, cpfk_supplier_lineitem#5282 AS cpfk_supplier_lineitem_0#5315, cfpk_lineitem_supplier#5283 AS cfpk_lineitem_supplier_0#5316, cfpk_lineitem_partsupp#5284 AS cfpk_lineitem_partsupp_0#5317, cpfk_part_lineitem#5285 AS cpfk_part_lineitem_0#5318, cfpk_lineitem_part#5286 AS cfpk_lineitem_part_0#5319, cpfk_partsupp_lineitem#5287 AS cpfk_partsupp_lineitem_0#5320, cfpk_lineitem_orders#5288 AS cfpk_lineitem_orders_0#5321, cval_lineitem_l_quantity#5289 AS cval_lineitem_l_quantity_0#5322, cval_lineitem_l_extendedprice#5290 AS cval_lineitem_l_extendedprice_0#5323, cval_lineitem_l_discount#5291 AS cval_lineitem_l_discount_0#5324, cval_lineitem_l_tax#5292 AS cval_lineitem_l_tax_0#5325, cval_lineitem_l_returnflag#5293 AS cval_lineitem_l_returnflag_0#5326, cval_lineitem_l_linestatus#5294 AS cval_lineitem_l_linestatus_0#5327, cval_lineitem_l_commitdate#5295 AS cval_lineitem_l_commitdate_0#5328, cval_lineitem_l_receiptdate#5296 AS cval_lineitem_l_receiptdate_0#5329, cval_lineitem_l_shipinstruct#5297 AS cval_lineitem_l_shipinstruct_0#5330, cval_lineitem_l_shipmode#5298 AS cval_lineitem_l_shipmode_0#5331, cval_lineitem_l_comment#5299 AS cval_lineitem_l_comment_0#5332, cval_lineitem_l_shipdate#5300 AS cval_lineitem_l_shipdate_0#5333, cl_quantity#5301 AS cl_quantity_0#5334, cl_extendedprice#5302 AS cl_extendedprice_0#5335, cl_discount#5303 AS cl_discount_0#5336, ... 9 more fields]
            :  +- Relation[rid#5280,cpfk_orders_lineitem#5281,cpfk_supplier_lineitem#5282,cfpk_lineitem_supplier#5283,cfpk_lineitem_partsupp#5284,cpfk_part_lineitem#5285,cfpk_lineitem_part#5286,cpfk_partsupp_lineitem#5287,cfpk_lineitem_orders#5288,cval_lineitem_l_quantity#5289,cval_lineitem_l_extendedprice#5290,cval_lineitem_l_discount#5291,cval_lineitem_l_tax#5292,cval_lineitem_l_returnflag#5293,cval_lineitem_l_linestatus#5294,cval_lineitem_l_commitdate#5295,cval_lineitem_l_receiptdate#5296,cval_lineitem_l_shipinstruct#5297,cval_lineitem_l_shipmode#5298,cval_lineitem_l_comment#5299,cval_lineitem_l_shipdate#5300,cl_quantity#5301,cl_extendedprice#5302,cl_discount#5303,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#5346 AS rid_1#5363, cpfk_customer_orders#5347 AS cpfk_customer_orders_1#5364, cfpk_orders_customer#5348 AS cfpk_orders_customer_1#5365, cval_orders_o_orderstatus#5349 AS cval_orders_o_orderstatus_1#5366, cval_orders_o_totalprice#5350 AS cval_orders_o_totalprice_1#5367, cval_orders_o_orderpriority#5351 AS cval_orders_o_orderpriority_1#5368, cval_orders_o_clerk#5352 AS cval_orders_o_clerk_1#5369, cval_orders_o_shippriority#5353 AS cval_orders_o_shippriority_1#5370, cval_orders_o_comment#5354 AS cval_orders_o_comment_1#5371, cval_orders_o_orderdate#5355 AS cval_orders_o_orderdate_1#5372, co_orderstatus#5356 AS co_orderstatus_1#5373, co_totalprice#5357 AS co_totalprice_1#5374, co_orderpriority#5358 AS co_orderpriority_1#5375, co_clerk#5359 AS co_clerk_1#5376, co_shippriority#5360 AS co_shippriority_1#5377, co_comment#5361 AS co_comment_1#5378, co_orderdate#5362 AS co_orderdate_1#5379]
               +- Relation[rid#5346,cpfk_customer_orders#5347,cfpk_orders_customer#5348,cval_orders_o_orderstatus#5349,cval_orders_o_totalprice#5350,cval_orders_o_orderpriority#5351,cval_orders_o_clerk#5352,cval_orders_o_shippriority#5353,cval_orders_o_comment#5354,cval_orders_o_orderdate#5355,co_orderstatus#5356,co_totalprice#5357,co_orderpriority#5358,co_clerk#5359,co_shippriority#5360,co_comment#5361,co_orderdate#5362] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 55933ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/15 15:26:06 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:26:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5434L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:26:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:26:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5434L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#5436 AS rid_0#5441, cval_region_r_name#5437 AS cval_region_r_name_0#5442, cval_region_r_comment#5438 AS cval_region_r_comment_0#5443, cr_name#5439 AS cr_name_0#5444, cr_comment#5440 AS cr_comment_0#5445]
         :  :  :  :  :  :  :  +- Relation[rid#5436,cval_region_r_name#5437,cval_region_r_comment#5438,cr_name#5439,cr_comment#5440] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#5446 AS rid_0#5451, cval_region_r_name#5447 AS cval_region_r_name_0#5452, cval_region_r_comment#5448 AS cval_region_r_comment_0#5453, cr_name#5449 AS cr_name_0#5454, cr_comment#5450 AS cr_comment_0#5455]
         :  :  :  :  :  :        +- Relation[rid#5446,cval_region_r_name#5447,cval_region_r_comment#5448,cr_name#5449,cr_comment#5450] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- Project [rid#5480 AS rid_1#5487, cpfk_region_nation#5481 AS cpfk_region_nation_1#5488, cfpk_nation_region#5482 AS cfpk_nation_region_1#5489, cval_nation_n_name#5483 AS cval_nation_n_name_1#5490, cval_nation_n_comment#5484 AS cval_nation_n_comment_1#5491, cn_name#5485 AS cn_name_1#5492, cn_comment#5486 AS cn_comment_1#5493]
         :  :  :  :  :     +- Relation[rid#5480,cpfk_region_nation#5481,cfpk_nation_region#5482,cval_nation_n_name#5483,cval_nation_n_comment#5484,cn_name#5485,cn_comment#5486] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#5456 AS rid_1#5463, cpfk_region_nation#5457 AS cpfk_region_nation_1#5464, cfpk_nation_region#5458 AS cfpk_nation_region_1#5465, cval_nation_n_name#5459 AS cval_nation_n_name_1#5466, cval_nation_n_comment#5460 AS cval_nation_n_comment_1#5467, cn_name#5461 AS cn_name_1#5468, cn_comment#5462 AS cn_comment_1#5469]
         :  :  :  :     +- Relation[rid#5456,cpfk_region_nation#5457,cfpk_nation_region#5458,cval_nation_n_name#5459,cval_nation_n_comment#5460,cn_name#5461,cn_comment#5462] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#5534 AS rid_2#5547, cpfk_nation_supplier#5535 AS cpfk_nation_supplier_2#5548, cfpk_supplier_nation#5536 AS cfpk_supplier_nation_2#5549, cval_supplier_s_name#5537 AS cval_supplier_s_name_2#5550, cval_supplier_s_address#5538 AS cval_supplier_s_address_2#5551, cval_supplier_s_phone#5539 AS cval_supplier_s_phone_2#5552, cval_supplier_s_acctbal#5540 AS cval_supplier_s_acctbal_2#5553, cval_supplier_s_comment#5541 AS cval_supplier_s_comment_2#5554, cs_name#5542 AS cs_name_2#5555, cs_address#5543 AS cs_address_2#5556, cs_phone#5544 AS cs_phone_2#5557, cs_acctbal#5545 AS cs_acctbal_2#5558, cs_comment#5546 AS cs_comment_2#5559]
         :  :  :     +- Relation[rid#5534,cpfk_nation_supplier#5535,cfpk_supplier_nation#5536,cval_supplier_s_name#5537,cval_supplier_s_address#5538,cval_supplier_s_phone#5539,cval_supplier_s_acctbal#5540,cval_supplier_s_comment#5541,cs_name#5542,cs_address#5543,cs_phone#5544,cs_acctbal#5545,cs_comment#5546] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#5494 AS rid_2#5507, cpfk_nation_supplier#5495 AS cpfk_nation_supplier_2#5508, cfpk_supplier_nation#5496 AS cfpk_supplier_nation_2#5509, cval_supplier_s_name#5497 AS cval_supplier_s_name_2#5510, cval_supplier_s_address#5498 AS cval_supplier_s_address_2#5511, cval_supplier_s_phone#5499 AS cval_supplier_s_phone_2#5512, cval_supplier_s_acctbal#5500 AS cval_supplier_s_acctbal_2#5513, cval_supplier_s_comment#5501 AS cval_supplier_s_comment_2#5514, cs_name#5502 AS cs_name_2#5515, cs_address#5503 AS cs_address_2#5516, cs_phone#5504 AS cs_phone_2#5517, cs_acctbal#5505 AS cs_acctbal_2#5518, cs_comment#5506 AS cs_comment_2#5519]
         :  :     +- Relation[rid#5494,cpfk_nation_supplier#5495,cfpk_supplier_nation#5496,cval_supplier_s_name#5497,cval_supplier_s_address#5498,cval_supplier_s_phone#5499,cval_supplier_s_acctbal#5500,cval_supplier_s_comment#5501,cs_name#5502,cs_address#5503,cs_phone#5504,cs_acctbal#5505,cs_comment#5506] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#5732 AS rid_4#5743, cpfk_part_partsupp#5733 AS cpfk_part_partsupp_4#5744, cfpk_partsupp_part#5734 AS cfpk_partsupp_part_4#5745, cpfk_supplier_partsupp#5735 AS cpfk_supplier_partsupp_4#5746, cfpk_partsupp_supplier#5736 AS cfpk_partsupp_supplier_4#5747, cval_partsupp_ps_availqty#5737 AS cval_partsupp_ps_availqty_4#5748, cval_partsupp_ps_supplycost#5738 AS cval_partsupp_ps_supplycost_4#5749, cval_partsupp_ps_comment#5739 AS cval_partsupp_ps_comment_4#5750, cps_availqty#5740 AS cps_availqty_4#5751, cps_supplycost#5741 AS cps_supplycost_4#5752, cps_comment#5742 AS cps_comment_4#5753]
         :     +- Relation[rid#5732,cpfk_part_partsupp#5733,cfpk_partsupp_part#5734,cpfk_supplier_partsupp#5735,cfpk_partsupp_supplier#5736,cval_partsupp_ps_availqty#5737,cval_partsupp_ps_supplycost#5738,cval_partsupp_ps_comment#5739,cps_availqty#5740,cps_supplycost#5741,cps_comment#5742] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#5560 AS rid_3#5577, cval_part_p_name#5561 AS cval_part_p_name_3#5578, cval_part_p_mfgr#5562 AS cval_part_p_mfgr_3#5579, cval_part_p_type#5563 AS cval_part_p_type_3#5580, cval_part_p_size#5564 AS cval_part_p_size_3#5581, cval_part_p_container#5565 AS cval_part_p_container_3#5582, cval_part_p_retailprice#5566 AS cval_part_p_retailprice_3#5583, cval_part_p_comment#5567 AS cval_part_p_comment_3#5584, cval_part_p_brand#5568 AS cval_part_p_brand_3#5585, cp_name#5569 AS cp_name_3#5586, cp_mfgr#5570 AS cp_mfgr_3#5587, cp_type#5571 AS cp_type_3#5588, cp_size#5572 AS cp_size_3#5589, cp_container#5573 AS cp_container_3#5590, cp_retailprice#5574 AS cp_retailprice_3#5591, cp_comment#5575 AS cp_comment_3#5592, cp_brand#5576 AS cp_brand_3#5593]
            :  :  :  +- Relation[rid#5560,cval_part_p_name#5561,cval_part_p_mfgr#5562,cval_part_p_type#5563,cval_part_p_size#5564,cval_part_p_container#5565,cval_part_p_retailprice#5566,cval_part_p_comment#5567,cval_part_p_brand#5568,cp_name#5569,cp_mfgr#5570,cp_type#5571,cp_size#5572,cp_container#5573,cp_retailprice#5574,cp_comment#5575,cp_brand#5576] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#5594 AS rid_3#5611, cval_part_p_name#5595 AS cval_part_p_name_3#5612, cval_part_p_mfgr#5596 AS cval_part_p_mfgr_3#5613, cval_part_p_type#5597 AS cval_part_p_type_3#5614, cval_part_p_size#5598 AS cval_part_p_size_3#5615, cval_part_p_container#5599 AS cval_part_p_container_3#5616, cval_part_p_retailprice#5600 AS cval_part_p_retailprice_3#5617, cval_part_p_comment#5601 AS cval_part_p_comment_3#5618, cval_part_p_brand#5602 AS cval_part_p_brand_3#5619, cp_name#5603 AS cp_name_3#5620, cp_mfgr#5604 AS cp_mfgr_3#5621, cp_type#5605 AS cp_type_3#5622, cp_size#5606 AS cp_size_3#5623, cp_container#5607 AS cp_container_3#5624, cp_retailprice#5608 AS cp_retailprice_3#5625, cp_comment#5609 AS cp_comment_3#5626, cp_brand#5610 AS cp_brand_3#5627]
            :  :        +- Relation[rid#5594,cval_part_p_name#5595,cval_part_p_mfgr#5596,cval_part_p_type#5597,cval_part_p_size#5598,cval_part_p_container#5599,cval_part_p_retailprice#5600,cval_part_p_comment#5601,cval_part_p_brand#5602,cp_name#5603,cp_mfgr#5604,cp_type#5605,cp_size#5606,cp_container#5607,cp_retailprice#5608,cp_comment#5609,cp_brand#5610] JDBCRelation(tpart) [numPartitions=1]
            :  +- Project [rid#5684 AS rid_4#5695, cpfk_part_partsupp#5685 AS cpfk_part_partsupp_4#5696, cfpk_partsupp_part#5686 AS cfpk_partsupp_part_4#5697, cpfk_supplier_partsupp#5687 AS cpfk_supplier_partsupp_4#5698, cfpk_partsupp_supplier#5688 AS cfpk_partsupp_supplier_4#5699, cval_partsupp_ps_availqty#5689 AS cval_partsupp_ps_availqty_4#5700, cval_partsupp_ps_supplycost#5690 AS cval_partsupp_ps_supplycost_4#5701, cval_partsupp_ps_comment#5691 AS cval_partsupp_ps_comment_4#5702, cps_availqty#5692 AS cps_availqty_4#5703, cps_supplycost#5693 AS cps_supplycost_4#5704, cps_comment#5694 AS cps_comment_4#5705]
            :     +- Relation[rid#5684,cpfk_part_partsupp#5685,cfpk_partsupp_part#5686,cpfk_supplier_partsupp#5687,cfpk_partsupp_supplier#5688,cval_partsupp_ps_availqty#5689,cval_partsupp_ps_supplycost#5690,cval_partsupp_ps_comment#5691,cps_availqty#5692,cps_supplycost#5693,cps_comment#5694] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#5628 AS rid_4#5639, cpfk_part_partsupp#5629 AS cpfk_part_partsupp_4#5640, cfpk_partsupp_part#5630 AS cfpk_partsupp_part_4#5641, cpfk_supplier_partsupp#5631 AS cpfk_supplier_partsupp_4#5642, cfpk_partsupp_supplier#5632 AS cfpk_partsupp_supplier_4#5643, cval_partsupp_ps_availqty#5633 AS cval_partsupp_ps_availqty_4#5644, cval_partsupp_ps_supplycost#5634 AS cval_partsupp_ps_supplycost_4#5645, cval_partsupp_ps_comment#5635 AS cval_partsupp_ps_comment_4#5646, cps_availqty#5636 AS cps_availqty_4#5647, cps_supplycost#5637 AS cps_supplycost_4#5648, cps_comment#5638 AS cps_comment_4#5649]
               +- Relation[rid#5628,cpfk_part_partsupp#5629,cfpk_partsupp_part#5630,cpfk_supplier_partsupp#5631,cfpk_partsupp_supplier#5632,cval_partsupp_ps_availqty#5633,cval_partsupp_ps_supplycost#5634,cval_partsupp_ps_comment#5635,cps_availqty#5636,cps_supplycost#5637,cps_comment#5638] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15
Elapsed time: 1560ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/15 15:26:07 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:26:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5816L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:26:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5816L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#5818 AS rid_0#5833, cpfk_nation_customer#5819 AS cpfk_nation_customer_0#5834, cfpk_customer_nation#5820 AS cfpk_customer_nation_0#5835, cval_customer_c_name#5821 AS cval_customer_c_name_0#5836, cval_customer_c_address#5822 AS cval_customer_c_address_0#5837, cval_customer_c_phone#5823 AS cval_customer_c_phone_0#5838, cval_customer_c_acctbal#5824 AS cval_customer_c_acctbal_0#5839, cval_customer_c_comment#5825 AS cval_customer_c_comment_0#5840, cval_customer_c_mktsegment#5826 AS cval_customer_c_mktsegment_0#5841, cc_name#5827 AS cc_name_0#5842, cc_address#5828 AS cc_address_0#5843, cc_phone#5829 AS cc_phone_0#5844, cc_acctbal#5830 AS cc_acctbal_0#5845, cc_comment#5831 AS cc_comment_0#5846, cc_mktsegment#5832 AS cc_mktsegment_0#5847]
         :  :  :  :  +- Relation[rid#5818,cpfk_nation_customer#5819,cfpk_customer_nation#5820,cval_customer_c_name#5821,cval_customer_c_address#5822,cval_customer_c_phone#5823,cval_customer_c_acctbal#5824,cval_customer_c_comment#5825,cval_customer_c_mktsegment#5826,cc_name#5827,cc_address#5828,cc_phone#5829,cc_acctbal#5830,cc_comment#5831,cc_mktsegment#5832] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#5882 AS rid_0#5897, cpfk_nation_customer#5883 AS cpfk_nation_customer_0#5898, cfpk_customer_nation#5884 AS cfpk_customer_nation_0#5899, cval_customer_c_name#5885 AS cval_customer_c_name_0#5900, cval_customer_c_address#5886 AS cval_customer_c_address_0#5901, cval_customer_c_phone#5887 AS cval_customer_c_phone_0#5902, cval_customer_c_acctbal#5888 AS cval_customer_c_acctbal_0#5903, cval_customer_c_comment#5889 AS cval_customer_c_comment_0#5904, cval_customer_c_mktsegment#5890 AS cval_customer_c_mktsegment_0#5905, cc_name#5891 AS cc_name_0#5906, cc_address#5892 AS cc_address_0#5907, cc_phone#5893 AS cc_phone_0#5908, cc_acctbal#5894 AS cc_acctbal_0#5909, cc_comment#5895 AS cc_comment_0#5910, cc_mktsegment#5896 AS cc_mktsegment_0#5911]
         :  :  :     :  +- Relation[rid#5882,cpfk_nation_customer#5883,cfpk_customer_nation#5884,cval_customer_c_name#5885,cval_customer_c_address#5886,cval_customer_c_phone#5887,cval_customer_c_acctbal#5888,cval_customer_c_comment#5889,cval_customer_c_mktsegment#5890,cc_name#5891,cc_address#5892,cc_phone#5893,cc_acctbal#5894,cc_comment#5895,cc_mktsegment#5896] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#5912 AS rid_1#5929, cpfk_customer_orders#5913 AS cpfk_customer_orders_1#5930, cfpk_orders_customer#5914 AS cfpk_orders_customer_1#5931, cval_orders_o_orderstatus#5915 AS cval_orders_o_orderstatus_1#5932, cval_orders_o_totalprice#5916 AS cval_orders_o_totalprice_1#5933, cval_orders_o_orderpriority#5917 AS cval_orders_o_orderpriority_1#5934, cval_orders_o_clerk#5918 AS cval_orders_o_clerk_1#5935, cval_orders_o_shippriority#5919 AS cval_orders_o_shippriority_1#5936, cval_orders_o_comment#5920 AS cval_orders_o_comment_1#5937, cval_orders_o_orderdate#5921 AS cval_orders_o_orderdate_1#5938, co_orderstatus#5922 AS co_orderstatus_1#5939, co_totalprice#5923 AS co_totalprice_1#5940, co_orderpriority#5924 AS co_orderpriority_1#5941, co_clerk#5925 AS co_clerk_1#5942, co_shippriority#5926 AS co_shippriority_1#5943, co_comment#5927 AS co_comment_1#5944, co_orderdate#5928 AS co_orderdate_1#5945]
         :  :  :        +- Relation[rid#5912,cpfk_customer_orders#5913,cfpk_orders_customer#5914,cval_orders_o_orderstatus#5915,cval_orders_o_totalprice#5916,cval_orders_o_orderpriority#5917,cval_orders_o_clerk#5918,cval_orders_o_shippriority#5919,cval_orders_o_comment#5920,cval_orders_o_orderdate#5921,co_orderstatus#5922,co_totalprice#5923,co_orderpriority#5924,co_clerk#5925,co_shippriority#5926,co_comment#5927,co_orderdate#5928] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#5848 AS rid_1#5865, cpfk_customer_orders#5849 AS cpfk_customer_orders_1#5866, cfpk_orders_customer#5850 AS cfpk_orders_customer_1#5867, cval_orders_o_orderstatus#5851 AS cval_orders_o_orderstatus_1#5868, cval_orders_o_totalprice#5852 AS cval_orders_o_totalprice_1#5869, cval_orders_o_orderpriority#5853 AS cval_orders_o_orderpriority_1#5870, cval_orders_o_clerk#5854 AS cval_orders_o_clerk_1#5871, cval_orders_o_shippriority#5855 AS cval_orders_o_shippriority_1#5872, cval_orders_o_comment#5856 AS cval_orders_o_comment_1#5873, cval_orders_o_orderdate#5857 AS cval_orders_o_orderdate_1#5874, co_orderstatus#5858 AS co_orderstatus_1#5875, co_totalprice#5859 AS co_totalprice_1#5876, co_orderpriority#5860 AS co_orderpriority_1#5877, co_clerk#5861 AS co_clerk_1#5878, co_shippriority#5862 AS co_shippriority_1#5879, co_comment#5863 AS co_comment_1#5880, co_orderdate#5864 AS co_orderdate_1#5881]
         :  :     +- Relation[rid#5848,cpfk_customer_orders#5849,cfpk_orders_customer#5850,cval_orders_o_orderstatus#5851,cval_orders_o_totalprice#5852,cval_orders_o_orderpriority#5853,cval_orders_o_clerk#5854,cval_orders_o_shippriority#5855,cval_orders_o_comment#5856,cval_orders_o_orderdate#5857,co_orderstatus#5858,co_totalprice#5859,co_orderpriority#5860,co_clerk#5861,co_shippriority#5862,co_comment#5863,co_orderdate#5864] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#6012 AS rid_1#6029, cpfk_customer_orders#6013 AS cpfk_customer_orders_1#6030, cfpk_orders_customer#6014 AS cfpk_orders_customer_1#6031, cval_orders_o_orderstatus#6015 AS cval_orders_o_orderstatus_1#6032, cval_orders_o_totalprice#6016 AS cval_orders_o_totalprice_1#6033, cval_orders_o_orderpriority#6017 AS cval_orders_o_orderpriority_1#6034, cval_orders_o_clerk#6018 AS cval_orders_o_clerk_1#6035, cval_orders_o_shippriority#6019 AS cval_orders_o_shippriority_1#6036, cval_orders_o_comment#6020 AS cval_orders_o_comment_1#6037, cval_orders_o_orderdate#6021 AS cval_orders_o_orderdate_1#6038, co_orderstatus#6022 AS co_orderstatus_1#6039, co_totalprice#6023 AS co_totalprice_1#6040, co_orderpriority#6024 AS co_orderpriority_1#6041, co_clerk#6025 AS co_clerk_1#6042, co_shippriority#6026 AS co_shippriority_1#6043, co_comment#6027 AS co_comment_1#6044, co_orderdate#6028 AS co_orderdate_1#6045]
         :     :  +- Relation[rid#6012,cpfk_customer_orders#6013,cfpk_orders_customer#6014,cval_orders_o_orderstatus#6015,cval_orders_o_totalprice#6016,cval_orders_o_orderpriority#6017,cval_orders_o_clerk#6018,cval_orders_o_shippriority#6019,cval_orders_o_comment#6020,cval_orders_o_orderdate#6021,co_orderstatus#6022,co_totalprice#6023,co_orderpriority#6024,co_clerk#6025,co_shippriority#6026,co_comment#6027,co_orderdate#6028] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#6046 AS rid_2#6079, cpfk_orders_lineitem#6047 AS cpfk_orders_lineitem_2#6080, cpfk_supplier_lineitem#6048 AS cpfk_supplier_lineitem_2#6081, cfpk_lineitem_supplier#6049 AS cfpk_lineitem_supplier_2#6082, cfpk_lineitem_partsupp#6050 AS cfpk_lineitem_partsupp_2#6083, cpfk_part_lineitem#6051 AS cpfk_part_lineitem_2#6084, cfpk_lineitem_part#6052 AS cfpk_lineitem_part_2#6085, cpfk_partsupp_lineitem#6053 AS cpfk_partsupp_lineitem_2#6086, cfpk_lineitem_orders#6054 AS cfpk_lineitem_orders_2#6087, cval_lineitem_l_quantity#6055 AS cval_lineitem_l_quantity_2#6088, cval_lineitem_l_extendedprice#6056 AS cval_lineitem_l_extendedprice_2#6089, cval_lineitem_l_discount#6057 AS cval_lineitem_l_discount_2#6090, cval_lineitem_l_tax#6058 AS cval_lineitem_l_tax_2#6091, cval_lineitem_l_returnflag#6059 AS cval_lineitem_l_returnflag_2#6092, cval_lineitem_l_linestatus#6060 AS cval_lineitem_l_linestatus_2#6093, cval_lineitem_l_commitdate#6061 AS cval_lineitem_l_commitdate_2#6094, cval_lineitem_l_receiptdate#6062 AS cval_lineitem_l_receiptdate_2#6095, cval_lineitem_l_shipinstruct#6063 AS cval_lineitem_l_shipinstruct_2#6096, cval_lineitem_l_shipmode#6064 AS cval_lineitem_l_shipmode_2#6097, cval_lineitem_l_comment#6065 AS cval_lineitem_l_comment_2#6098, cval_lineitem_l_shipdate#6066 AS cval_lineitem_l_shipdate_2#6099, cl_quantity#6067 AS cl_quantity_2#6100, cl_extendedprice#6068 AS cl_extendedprice_2#6101, cl_discount#6069 AS cl_discount_2#6102, ... 9 more fields]
         :        +- Relation[rid#6046,cpfk_orders_lineitem#6047,cpfk_supplier_lineitem#6048,cfpk_lineitem_supplier#6049,cfpk_lineitem_partsupp#6050,cpfk_part_lineitem#6051,cfpk_lineitem_part#6052,cpfk_partsupp_lineitem#6053,cfpk_lineitem_orders#6054,cval_lineitem_l_quantity#6055,cval_lineitem_l_extendedprice#6056,cval_lineitem_l_discount#6057,cval_lineitem_l_tax#6058,cval_lineitem_l_returnflag#6059,cval_lineitem_l_linestatus#6060,cval_lineitem_l_commitdate#6061,cval_lineitem_l_receiptdate#6062,cval_lineitem_l_shipinstruct#6063,cval_lineitem_l_shipmode#6064,cval_lineitem_l_comment#6065,cval_lineitem_l_shipdate#6066,cl_quantity#6067,cl_extendedprice#6068,cl_discount#6069,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5946 AS rid_2#5979, cpfk_orders_lineitem#5947 AS cpfk_orders_lineitem_2#5980, cpfk_supplier_lineitem#5948 AS cpfk_supplier_lineitem_2#5981, cfpk_lineitem_supplier#5949 AS cfpk_lineitem_supplier_2#5982, cfpk_lineitem_partsupp#5950 AS cfpk_lineitem_partsupp_2#5983, cpfk_part_lineitem#5951 AS cpfk_part_lineitem_2#5984, cfpk_lineitem_part#5952 AS cfpk_lineitem_part_2#5985, cpfk_partsupp_lineitem#5953 AS cpfk_partsupp_lineitem_2#5986, cfpk_lineitem_orders#5954 AS cfpk_lineitem_orders_2#5987, cval_lineitem_l_quantity#5955 AS cval_lineitem_l_quantity_2#5988, cval_lineitem_l_extendedprice#5956 AS cval_lineitem_l_extendedprice_2#5989, cval_lineitem_l_discount#5957 AS cval_lineitem_l_discount_2#5990, cval_lineitem_l_tax#5958 AS cval_lineitem_l_tax_2#5991, cval_lineitem_l_returnflag#5959 AS cval_lineitem_l_returnflag_2#5992, cval_lineitem_l_linestatus#5960 AS cval_lineitem_l_linestatus_2#5993, cval_lineitem_l_commitdate#5961 AS cval_lineitem_l_commitdate_2#5994, cval_lineitem_l_receiptdate#5962 AS cval_lineitem_l_receiptdate_2#5995, cval_lineitem_l_shipinstruct#5963 AS cval_lineitem_l_shipinstruct_2#5996, cval_lineitem_l_shipmode#5964 AS cval_lineitem_l_shipmode_2#5997, cval_lineitem_l_comment#5965 AS cval_lineitem_l_comment_2#5998, cval_lineitem_l_shipdate#5966 AS cval_lineitem_l_shipdate_2#5999, cl_quantity#5967 AS cl_quantity_2#6000, cl_extendedprice#5968 AS cl_extendedprice_2#6001, cl_discount#5969 AS cl_discount_2#6002, ... 9 more fields]
            +- Relation[rid#5946,cpfk_orders_lineitem#5947,cpfk_supplier_lineitem#5948,cfpk_lineitem_supplier#5949,cfpk_lineitem_partsupp#5950,cpfk_part_lineitem#5951,cfpk_lineitem_part#5952,cpfk_partsupp_lineitem#5953,cfpk_lineitem_orders#5954,cval_lineitem_l_quantity#5955,cval_lineitem_l_extendedprice#5956,cval_lineitem_l_discount#5957,cval_lineitem_l_tax#5958,cval_lineitem_l_returnflag#5959,cval_lineitem_l_linestatus#5960,cval_lineitem_l_commitdate#5961,cval_lineitem_l_receiptdate#5962,cval_lineitem_l_shipinstruct#5963,cval_lineitem_l_shipmode#5964,cval_lineitem_l_comment#5965,cval_lineitem_l_shipdate#5966,cl_quantity#5967,cl_extendedprice#5968,cl_discount#5969,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 125125ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/15 15:28:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:28:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6184L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:28:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:28:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:28:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:28:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6184L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#6186 AS rid_0#6199, cpfk_nation_supplier#6187 AS cpfk_nation_supplier_0#6200, cfpk_supplier_nation#6188 AS cfpk_supplier_nation_0#6201, cval_supplier_s_name#6189 AS cval_supplier_s_name_0#6202, cval_supplier_s_address#6190 AS cval_supplier_s_address_0#6203, cval_supplier_s_phone#6191 AS cval_supplier_s_phone_0#6204, cval_supplier_s_acctbal#6192 AS cval_supplier_s_acctbal_0#6205, cval_supplier_s_comment#6193 AS cval_supplier_s_comment_0#6206, cs_name#6194 AS cs_name_0#6207, cs_address#6195 AS cs_address_0#6208, cs_phone#6196 AS cs_phone_0#6209, cs_acctbal#6197 AS cs_acctbal_0#6210, cs_comment#6198 AS cs_comment_0#6211]
         :  :  +- Relation[rid#6186,cpfk_nation_supplier#6187,cfpk_supplier_nation#6188,cval_supplier_s_name#6189,cval_supplier_s_address#6190,cval_supplier_s_phone#6191,cval_supplier_s_acctbal#6192,cval_supplier_s_comment#6193,cs_name#6194,cs_address#6195,cs_phone#6196,cs_acctbal#6197,cs_comment#6198] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#6278 AS rid_0#6291, cpfk_nation_supplier#6279 AS cpfk_nation_supplier_0#6292, cfpk_supplier_nation#6280 AS cfpk_supplier_nation_0#6293, cval_supplier_s_name#6281 AS cval_supplier_s_name_0#6294, cval_supplier_s_address#6282 AS cval_supplier_s_address_0#6295, cval_supplier_s_phone#6283 AS cval_supplier_s_phone_0#6296, cval_supplier_s_acctbal#6284 AS cval_supplier_s_acctbal_0#6297, cval_supplier_s_comment#6285 AS cval_supplier_s_comment_0#6298, cs_name#6286 AS cs_name_0#6299, cs_address#6287 AS cs_address_0#6300, cs_phone#6288 AS cs_phone_0#6301, cs_acctbal#6289 AS cs_acctbal_0#6302, cs_comment#6290 AS cs_comment_0#6303]
         :     :  +- Relation[rid#6278,cpfk_nation_supplier#6279,cfpk_supplier_nation#6280,cval_supplier_s_name#6281,cval_supplier_s_address#6282,cval_supplier_s_phone#6283,cval_supplier_s_acctbal#6284,cval_supplier_s_comment#6285,cs_name#6286,cs_address#6287,cs_phone#6288,cs_acctbal#6289,cs_comment#6290] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#6304 AS rid_1#6337, cpfk_orders_lineitem#6305 AS cpfk_orders_lineitem_1#6338, cpfk_supplier_lineitem#6306 AS cpfk_supplier_lineitem_1#6339, cfpk_lineitem_supplier#6307 AS cfpk_lineitem_supplier_1#6340, cfpk_lineitem_partsupp#6308 AS cfpk_lineitem_partsupp_1#6341, cpfk_part_lineitem#6309 AS cpfk_part_lineitem_1#6342, cfpk_lineitem_part#6310 AS cfpk_lineitem_part_1#6343, cpfk_partsupp_lineitem#6311 AS cpfk_partsupp_lineitem_1#6344, cfpk_lineitem_orders#6312 AS cfpk_lineitem_orders_1#6345, cval_lineitem_l_quantity#6313 AS cval_lineitem_l_quantity_1#6346, cval_lineitem_l_extendedprice#6314 AS cval_lineitem_l_extendedprice_1#6347, cval_lineitem_l_discount#6315 AS cval_lineitem_l_discount_1#6348, cval_lineitem_l_tax#6316 AS cval_lineitem_l_tax_1#6349, cval_lineitem_l_returnflag#6317 AS cval_lineitem_l_returnflag_1#6350, cval_lineitem_l_linestatus#6318 AS cval_lineitem_l_linestatus_1#6351, cval_lineitem_l_commitdate#6319 AS cval_lineitem_l_commitdate_1#6352, cval_lineitem_l_receiptdate#6320 AS cval_lineitem_l_receiptdate_1#6353, cval_lineitem_l_shipinstruct#6321 AS cval_lineitem_l_shipinstruct_1#6354, cval_lineitem_l_shipmode#6322 AS cval_lineitem_l_shipmode_1#6355, cval_lineitem_l_comment#6323 AS cval_lineitem_l_comment_1#6356, cval_lineitem_l_shipdate#6324 AS cval_lineitem_l_shipdate_1#6357, cl_quantity#6325 AS cl_quantity_1#6358, cl_extendedprice#6326 AS cl_extendedprice_1#6359, cl_discount#6327 AS cl_discount_1#6360, ... 9 more fields]
         :        +- Relation[rid#6304,cpfk_orders_lineitem#6305,cpfk_supplier_lineitem#6306,cfpk_lineitem_supplier#6307,cfpk_lineitem_partsupp#6308,cpfk_part_lineitem#6309,cfpk_lineitem_part#6310,cpfk_partsupp_lineitem#6311,cfpk_lineitem_orders#6312,cval_lineitem_l_quantity#6313,cval_lineitem_l_extendedprice#6314,cval_lineitem_l_discount#6315,cval_lineitem_l_tax#6316,cval_lineitem_l_returnflag#6317,cval_lineitem_l_linestatus#6318,cval_lineitem_l_commitdate#6319,cval_lineitem_l_receiptdate#6320,cval_lineitem_l_shipinstruct#6321,cval_lineitem_l_shipmode#6322,cval_lineitem_l_comment#6323,cval_lineitem_l_shipdate#6324,cl_quantity#6325,cl_extendedprice#6326,cl_discount#6327,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6212 AS rid_1#6245, cpfk_orders_lineitem#6213 AS cpfk_orders_lineitem_1#6246, cpfk_supplier_lineitem#6214 AS cpfk_supplier_lineitem_1#6247, cfpk_lineitem_supplier#6215 AS cfpk_lineitem_supplier_1#6248, cfpk_lineitem_partsupp#6216 AS cfpk_lineitem_partsupp_1#6249, cpfk_part_lineitem#6217 AS cpfk_part_lineitem_1#6250, cfpk_lineitem_part#6218 AS cfpk_lineitem_part_1#6251, cpfk_partsupp_lineitem#6219 AS cpfk_partsupp_lineitem_1#6252, cfpk_lineitem_orders#6220 AS cfpk_lineitem_orders_1#6253, cval_lineitem_l_quantity#6221 AS cval_lineitem_l_quantity_1#6254, cval_lineitem_l_extendedprice#6222 AS cval_lineitem_l_extendedprice_1#6255, cval_lineitem_l_discount#6223 AS cval_lineitem_l_discount_1#6256, cval_lineitem_l_tax#6224 AS cval_lineitem_l_tax_1#6257, cval_lineitem_l_returnflag#6225 AS cval_lineitem_l_returnflag_1#6258, cval_lineitem_l_linestatus#6226 AS cval_lineitem_l_linestatus_1#6259, cval_lineitem_l_commitdate#6227 AS cval_lineitem_l_commitdate_1#6260, cval_lineitem_l_receiptdate#6228 AS cval_lineitem_l_receiptdate_1#6261, cval_lineitem_l_shipinstruct#6229 AS cval_lineitem_l_shipinstruct_1#6262, cval_lineitem_l_shipmode#6230 AS cval_lineitem_l_shipmode_1#6263, cval_lineitem_l_comment#6231 AS cval_lineitem_l_comment_1#6264, cval_lineitem_l_shipdate#6232 AS cval_lineitem_l_shipdate_1#6265, cl_quantity#6233 AS cl_quantity_1#6266, cl_extendedprice#6234 AS cl_extendedprice_1#6267, cl_discount#6235 AS cl_discount_1#6268, ... 9 more fields]
            +- Relation[rid#6212,cpfk_orders_lineitem#6213,cpfk_supplier_lineitem#6214,cfpk_lineitem_supplier#6215,cfpk_lineitem_partsupp#6216,cpfk_part_lineitem#6217,cfpk_lineitem_part#6218,cpfk_partsupp_lineitem#6219,cfpk_lineitem_orders#6220,cval_lineitem_l_quantity#6221,cval_lineitem_l_extendedprice#6222,cval_lineitem_l_discount#6223,cval_lineitem_l_tax#6224,cval_lineitem_l_returnflag#6225,cval_lineitem_l_linestatus#6226,cval_lineitem_l_commitdate#6227,cval_lineitem_l_receiptdate#6228,cval_lineitem_l_shipinstruct#6229,cval_lineitem_l_shipmode#6230,cval_lineitem_l_comment#6231,cval_lineitem_l_shipdate#6232,cl_quantity#6233,cl_extendedprice#6234,cl_discount#6235,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 83667ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/15 15:29:36 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:29:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6421L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 15:29:36 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:29:36 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:29:36 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:29:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:29:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:29:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:29:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:29:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:29:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:29:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:29:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:29:36 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:29:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:29:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6421L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#6423 AS rid_0#6440, cval_part_p_name#6424 AS cval_part_p_name_0#6441, cval_part_p_mfgr#6425 AS cval_part_p_mfgr_0#6442, cval_part_p_type#6426 AS cval_part_p_type_0#6443, cval_part_p_size#6427 AS cval_part_p_size_0#6444, cval_part_p_container#6428 AS cval_part_p_container_0#6445, cval_part_p_retailprice#6429 AS cval_part_p_retailprice_0#6446, cval_part_p_comment#6430 AS cval_part_p_comment_0#6447, cval_part_p_brand#6431 AS cval_part_p_brand_0#6448, cp_name#6432 AS cp_name_0#6449, cp_mfgr#6433 AS cp_mfgr_0#6450, cp_type#6434 AS cp_type_0#6451, cp_size#6435 AS cp_size_0#6452, cp_container#6436 AS cp_container_0#6453, cp_retailprice#6437 AS cp_retailprice_0#6454, cp_comment#6438 AS cp_comment_0#6455, cp_brand#6439 AS cp_brand_0#6456]
            :  :  :  :  +- Relation[rid#6423,cval_part_p_name#6424,cval_part_p_mfgr#6425,cval_part_p_type#6426,cval_part_p_size#6427,cval_part_p_container#6428,cval_part_p_retailprice#6429,cval_part_p_comment#6430,cval_part_p_brand#6431,cp_name#6432,cp_mfgr#6433,cp_type#6434,cp_size#6435,cp_container#6436,cp_retailprice#6437,cp_comment#6438,cp_brand#6439] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#6457 AS rid_0#6474, cval_part_p_name#6458 AS cval_part_p_name_0#6475, cval_part_p_mfgr#6459 AS cval_part_p_mfgr_0#6476, cval_part_p_type#6460 AS cval_part_p_type_0#6477, cval_part_p_size#6461 AS cval_part_p_size_0#6478, cval_part_p_container#6462 AS cval_part_p_container_0#6479, cval_part_p_retailprice#6463 AS cval_part_p_retailprice_0#6480, cval_part_p_comment#6464 AS cval_part_p_comment_0#6481, cval_part_p_brand#6465 AS cval_part_p_brand_0#6482, cp_name#6466 AS cp_name_0#6483, cp_mfgr#6467 AS cp_mfgr_0#6484, cp_type#6468 AS cp_type_0#6485, cp_size#6469 AS cp_size_0#6486, cp_container#6470 AS cp_container_0#6487, cp_retailprice#6471 AS cp_retailprice_0#6488, cp_comment#6472 AS cp_comment_0#6489, cp_brand#6473 AS cp_brand_0#6490]
            :  :  :        +- Relation[rid#6457,cval_part_p_name#6458,cval_part_p_mfgr#6459,cval_part_p_type#6460,cval_part_p_size#6461,cval_part_p_container#6462,cval_part_p_retailprice#6463,cval_part_p_comment#6464,cval_part_p_brand#6465,cp_name#6466,cp_mfgr#6467,cp_type#6468,cp_size#6469,cp_container#6470,cp_retailprice#6471,cp_comment#6472,cp_brand#6473] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- Project [rid#6547 AS rid_1#6558, cpfk_part_partsupp#6548 AS cpfk_part_partsupp_1#6559, cfpk_partsupp_part#6549 AS cfpk_partsupp_part_1#6560, cpfk_supplier_partsupp#6550 AS cpfk_supplier_partsupp_1#6561, cfpk_partsupp_supplier#6551 AS cfpk_partsupp_supplier_1#6562, cval_partsupp_ps_availqty#6552 AS cval_partsupp_ps_availqty_1#6563, cval_partsupp_ps_supplycost#6553 AS cval_partsupp_ps_supplycost_1#6564, cval_partsupp_ps_comment#6554 AS cval_partsupp_ps_comment_1#6565, cps_availqty#6555 AS cps_availqty_1#6566, cps_supplycost#6556 AS cps_supplycost_1#6567, cps_comment#6557 AS cps_comment_1#6568]
            :  :     +- Relation[rid#6547,cpfk_part_partsupp#6548,cfpk_partsupp_part#6549,cpfk_supplier_partsupp#6550,cfpk_partsupp_supplier#6551,cval_partsupp_ps_availqty#6552,cval_partsupp_ps_supplycost#6553,cval_partsupp_ps_comment#6554,cps_availqty#6555,cps_supplycost#6556,cps_comment#6557] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#6491 AS rid_1#6502, cpfk_part_partsupp#6492 AS cpfk_part_partsupp_1#6503, cfpk_partsupp_part#6493 AS cfpk_partsupp_part_1#6504, cpfk_supplier_partsupp#6494 AS cpfk_supplier_partsupp_1#6505, cfpk_partsupp_supplier#6495 AS cfpk_partsupp_supplier_1#6506, cval_partsupp_ps_availqty#6496 AS cval_partsupp_ps_availqty_1#6507, cval_partsupp_ps_supplycost#6497 AS cval_partsupp_ps_supplycost_1#6508, cval_partsupp_ps_comment#6498 AS cval_partsupp_ps_comment_1#6509, cps_availqty#6499 AS cps_availqty_1#6510, cps_supplycost#6500 AS cps_supplycost_1#6511, cps_comment#6501 AS cps_comment_1#6512]
            :     +- Relation[rid#6491,cpfk_part_partsupp#6492,cfpk_partsupp_part#6493,cpfk_supplier_partsupp#6494,cfpk_partsupp_supplier#6495,cval_partsupp_ps_availqty#6496,cval_partsupp_ps_supplycost#6497,cval_partsupp_ps_comment#6498,cps_availqty#6499,cps_supplycost#6500,cps_comment#6501] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#6569 AS rid_2#6576, cpfk_region_nation#6570 AS cpfk_region_nation_2#6577, cfpk_nation_region#6571 AS cfpk_nation_region_2#6578, cval_nation_n_name#6572 AS cval_nation_n_name_2#6579, cval_nation_n_comment#6573 AS cval_nation_n_comment_2#6580, cn_name#6574 AS cn_name_2#6581, cn_comment#6575 AS cn_comment_2#6582]
               :  :  :  +- Relation[rid#6569,cpfk_region_nation#6570,cfpk_nation_region#6571,cval_nation_n_name#6572,cval_nation_n_comment#6573,cn_name#6574,cn_comment#6575] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#6583 AS rid_2#6590, cpfk_region_nation#6584 AS cpfk_region_nation_2#6591, cfpk_nation_region#6585 AS cfpk_nation_region_2#6592, cval_nation_n_name#6586 AS cval_nation_n_name_2#6593, cval_nation_n_comment#6587 AS cval_nation_n_comment_2#6594, cn_name#6588 AS cn_name_2#6595, cn_comment#6589 AS cn_comment_2#6596]
               :  :        +- Relation[rid#6583,cpfk_region_nation#6584,cfpk_nation_region#6585,cval_nation_n_name#6586,cval_nation_n_comment#6587,cn_name#6588,cn_comment#6589] JDBCRelation(tnation) [numPartitions=1]
               :  +- Project [rid#6637 AS rid_3#6650, cpfk_nation_supplier#6638 AS cpfk_nation_supplier_3#6651, cfpk_supplier_nation#6639 AS cfpk_supplier_nation_3#6652, cval_supplier_s_name#6640 AS cval_supplier_s_name_3#6653, cval_supplier_s_address#6641 AS cval_supplier_s_address_3#6654, cval_supplier_s_phone#6642 AS cval_supplier_s_phone_3#6655, cval_supplier_s_acctbal#6643 AS cval_supplier_s_acctbal_3#6656, cval_supplier_s_comment#6644 AS cval_supplier_s_comment_3#6657, cs_name#6645 AS cs_name_3#6658, cs_address#6646 AS cs_address_3#6659, cs_phone#6647 AS cs_phone_3#6660, cs_acctbal#6648 AS cs_acctbal_3#6661, cs_comment#6649 AS cs_comment_3#6662]
               :     +- Relation[rid#6637,cpfk_nation_supplier#6638,cfpk_supplier_nation#6639,cval_supplier_s_name#6640,cval_supplier_s_address#6641,cval_supplier_s_phone#6642,cval_supplier_s_acctbal#6643,cval_supplier_s_comment#6644,cs_name#6645,cs_address#6646,cs_phone#6647,cs_acctbal#6648,cs_comment#6649] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#6597 AS rid_3#6610, cpfk_nation_supplier#6598 AS cpfk_nation_supplier_3#6611, cfpk_supplier_nation#6599 AS cfpk_supplier_nation_3#6612, cval_supplier_s_name#6600 AS cval_supplier_s_name_3#6613, cval_supplier_s_address#6601 AS cval_supplier_s_address_3#6614, cval_supplier_s_phone#6602 AS cval_supplier_s_phone_3#6615, cval_supplier_s_acctbal#6603 AS cval_supplier_s_acctbal_3#6616, cval_supplier_s_comment#6604 AS cval_supplier_s_comment_3#6617, cs_name#6605 AS cs_name_3#6618, cs_address#6606 AS cs_address_3#6619, cs_phone#6607 AS cs_phone_3#6620, cs_acctbal#6608 AS cs_acctbal_3#6621, cs_comment#6609 AS cs_comment_3#6622]
                  +- Relation[rid#6597,cpfk_nation_supplier#6598,cfpk_supplier_nation#6599,cval_supplier_s_name#6600,cval_supplier_s_address#6601,cval_supplier_s_phone#6602,cval_supplier_s_acctbal#6603,cval_supplier_s_comment#6604,cs_name#6605,cs_address#6606,cs_phone#6607,cs_acctbal#6608,cs_comment#6609] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1
Elapsed time: 671ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/15 15:29:37 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:29:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6717L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:29:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6717L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#6719 AS rid_0#6736, cval_part_p_name#6720 AS cval_part_p_name_0#6737, cval_part_p_mfgr#6721 AS cval_part_p_mfgr_0#6738, cval_part_p_type#6722 AS cval_part_p_type_0#6739, cval_part_p_size#6723 AS cval_part_p_size_0#6740, cval_part_p_container#6724 AS cval_part_p_container_0#6741, cval_part_p_retailprice#6725 AS cval_part_p_retailprice_0#6742, cval_part_p_comment#6726 AS cval_part_p_comment_0#6743, cval_part_p_brand#6727 AS cval_part_p_brand_0#6744, cp_name#6728 AS cp_name_0#6745, cp_mfgr#6729 AS cp_mfgr_0#6746, cp_type#6730 AS cp_type_0#6747, cp_size#6731 AS cp_size_0#6748, cp_container#6732 AS cp_container_0#6749, cp_retailprice#6733 AS cp_retailprice_0#6750, cp_comment#6734 AS cp_comment_0#6751, cp_brand#6735 AS cp_brand_0#6752]
         :  :  +- Relation[rid#6719,cval_part_p_name#6720,cval_part_p_mfgr#6721,cval_part_p_type#6722,cval_part_p_size#6723,cval_part_p_container#6724,cval_part_p_retailprice#6725,cval_part_p_comment#6726,cval_part_p_brand#6727,cp_name#6728,cp_mfgr#6729,cp_type#6730,cp_size#6731,cp_container#6732,cp_retailprice#6733,cp_comment#6734,cp_brand#6735] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#6819 AS rid_0#6836, cval_part_p_name#6820 AS cval_part_p_name_0#6837, cval_part_p_mfgr#6821 AS cval_part_p_mfgr_0#6838, cval_part_p_type#6822 AS cval_part_p_type_0#6839, cval_part_p_size#6823 AS cval_part_p_size_0#6840, cval_part_p_container#6824 AS cval_part_p_container_0#6841, cval_part_p_retailprice#6825 AS cval_part_p_retailprice_0#6842, cval_part_p_comment#6826 AS cval_part_p_comment_0#6843, cval_part_p_brand#6827 AS cval_part_p_brand_0#6844, cp_name#6828 AS cp_name_0#6845, cp_mfgr#6829 AS cp_mfgr_0#6846, cp_type#6830 AS cp_type_0#6847, cp_size#6831 AS cp_size_0#6848, cp_container#6832 AS cp_container_0#6849, cp_retailprice#6833 AS cp_retailprice_0#6850, cp_comment#6834 AS cp_comment_0#6851, cp_brand#6835 AS cp_brand_0#6852]
         :     :  +- Relation[rid#6819,cval_part_p_name#6820,cval_part_p_mfgr#6821,cval_part_p_type#6822,cval_part_p_size#6823,cval_part_p_container#6824,cval_part_p_retailprice#6825,cval_part_p_comment#6826,cval_part_p_brand#6827,cp_name#6828,cp_mfgr#6829,cp_type#6830,cp_size#6831,cp_container#6832,cp_retailprice#6833,cp_comment#6834,cp_brand#6835] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#6853 AS rid_1#6886, cpfk_orders_lineitem#6854 AS cpfk_orders_lineitem_1#6887, cpfk_supplier_lineitem#6855 AS cpfk_supplier_lineitem_1#6888, cfpk_lineitem_supplier#6856 AS cfpk_lineitem_supplier_1#6889, cfpk_lineitem_partsupp#6857 AS cfpk_lineitem_partsupp_1#6890, cpfk_part_lineitem#6858 AS cpfk_part_lineitem_1#6891, cfpk_lineitem_part#6859 AS cfpk_lineitem_part_1#6892, cpfk_partsupp_lineitem#6860 AS cpfk_partsupp_lineitem_1#6893, cfpk_lineitem_orders#6861 AS cfpk_lineitem_orders_1#6894, cval_lineitem_l_quantity#6862 AS cval_lineitem_l_quantity_1#6895, cval_lineitem_l_extendedprice#6863 AS cval_lineitem_l_extendedprice_1#6896, cval_lineitem_l_discount#6864 AS cval_lineitem_l_discount_1#6897, cval_lineitem_l_tax#6865 AS cval_lineitem_l_tax_1#6898, cval_lineitem_l_returnflag#6866 AS cval_lineitem_l_returnflag_1#6899, cval_lineitem_l_linestatus#6867 AS cval_lineitem_l_linestatus_1#6900, cval_lineitem_l_commitdate#6868 AS cval_lineitem_l_commitdate_1#6901, cval_lineitem_l_receiptdate#6869 AS cval_lineitem_l_receiptdate_1#6902, cval_lineitem_l_shipinstruct#6870 AS cval_lineitem_l_shipinstruct_1#6903, cval_lineitem_l_shipmode#6871 AS cval_lineitem_l_shipmode_1#6904, cval_lineitem_l_comment#6872 AS cval_lineitem_l_comment_1#6905, cval_lineitem_l_shipdate#6873 AS cval_lineitem_l_shipdate_1#6906, cl_quantity#6874 AS cl_quantity_1#6907, cl_extendedprice#6875 AS cl_extendedprice_1#6908, cl_discount#6876 AS cl_discount_1#6909, ... 9 more fields]
         :        +- Relation[rid#6853,cpfk_orders_lineitem#6854,cpfk_supplier_lineitem#6855,cfpk_lineitem_supplier#6856,cfpk_lineitem_partsupp#6857,cpfk_part_lineitem#6858,cfpk_lineitem_part#6859,cpfk_partsupp_lineitem#6860,cfpk_lineitem_orders#6861,cval_lineitem_l_quantity#6862,cval_lineitem_l_extendedprice#6863,cval_lineitem_l_discount#6864,cval_lineitem_l_tax#6865,cval_lineitem_l_returnflag#6866,cval_lineitem_l_linestatus#6867,cval_lineitem_l_commitdate#6868,cval_lineitem_l_receiptdate#6869,cval_lineitem_l_shipinstruct#6870,cval_lineitem_l_shipmode#6871,cval_lineitem_l_comment#6872,cval_lineitem_l_shipdate#6873,cl_quantity#6874,cl_extendedprice#6875,cl_discount#6876,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6753 AS rid_1#6786, cpfk_orders_lineitem#6754 AS cpfk_orders_lineitem_1#6787, cpfk_supplier_lineitem#6755 AS cpfk_supplier_lineitem_1#6788, cfpk_lineitem_supplier#6756 AS cfpk_lineitem_supplier_1#6789, cfpk_lineitem_partsupp#6757 AS cfpk_lineitem_partsupp_1#6790, cpfk_part_lineitem#6758 AS cpfk_part_lineitem_1#6791, cfpk_lineitem_part#6759 AS cfpk_lineitem_part_1#6792, cpfk_partsupp_lineitem#6760 AS cpfk_partsupp_lineitem_1#6793, cfpk_lineitem_orders#6761 AS cfpk_lineitem_orders_1#6794, cval_lineitem_l_quantity#6762 AS cval_lineitem_l_quantity_1#6795, cval_lineitem_l_extendedprice#6763 AS cval_lineitem_l_extendedprice_1#6796, cval_lineitem_l_discount#6764 AS cval_lineitem_l_discount_1#6797, cval_lineitem_l_tax#6765 AS cval_lineitem_l_tax_1#6798, cval_lineitem_l_returnflag#6766 AS cval_lineitem_l_returnflag_1#6799, cval_lineitem_l_linestatus#6767 AS cval_lineitem_l_linestatus_1#6800, cval_lineitem_l_commitdate#6768 AS cval_lineitem_l_commitdate_1#6801, cval_lineitem_l_receiptdate#6769 AS cval_lineitem_l_receiptdate_1#6802, cval_lineitem_l_shipinstruct#6770 AS cval_lineitem_l_shipinstruct_1#6803, cval_lineitem_l_shipmode#6771 AS cval_lineitem_l_shipmode_1#6804, cval_lineitem_l_comment#6772 AS cval_lineitem_l_comment_1#6805, cval_lineitem_l_shipdate#6773 AS cval_lineitem_l_shipdate_1#6806, cl_quantity#6774 AS cl_quantity_1#6807, cl_extendedprice#6775 AS cl_extendedprice_1#6808, cl_discount#6776 AS cl_discount_1#6809, ... 9 more fields]
            +- Relation[rid#6753,cpfk_orders_lineitem#6754,cpfk_supplier_lineitem#6755,cfpk_lineitem_supplier#6756,cfpk_lineitem_partsupp#6757,cpfk_part_lineitem#6758,cfpk_lineitem_part#6759,cpfk_partsupp_lineitem#6760,cfpk_lineitem_orders#6761,cval_lineitem_l_quantity#6762,cval_lineitem_l_extendedprice#6763,cval_lineitem_l_discount#6764,cval_lineitem_l_tax#6765,cval_lineitem_l_returnflag#6766,cval_lineitem_l_linestatus#6767,cval_lineitem_l_commitdate#6768,cval_lineitem_l_receiptdate#6769,cval_lineitem_l_shipinstruct#6770,cval_lineitem_l_shipmode#6771,cval_lineitem_l_comment#6772,cval_lineitem_l_shipdate#6773,cl_quantity#6774,cl_extendedprice#6775,cl_discount#6776,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 87213ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/15 15:31:04 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:31:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6976L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:31:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:31:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:31:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:31:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:31:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:31:04 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:31:04 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:31:04 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:31:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:31:04 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:31:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:31:04 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:31:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:31:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:31:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:31:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6976L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#6978 AS rid_0#6995, cval_part_p_name#6979 AS cval_part_p_name_0#6996, cval_part_p_mfgr#6980 AS cval_part_p_mfgr_0#6997, cval_part_p_type#6981 AS cval_part_p_type_0#6998, cval_part_p_size#6982 AS cval_part_p_size_0#6999, cval_part_p_container#6983 AS cval_part_p_container_0#7000, cval_part_p_retailprice#6984 AS cval_part_p_retailprice_0#7001, cval_part_p_comment#6985 AS cval_part_p_comment_0#7002, cval_part_p_brand#6986 AS cval_part_p_brand_0#7003, cp_name#6987 AS cp_name_0#7004, cp_mfgr#6988 AS cp_mfgr_0#7005, cp_type#6989 AS cp_type_0#7006, cp_size#6990 AS cp_size_0#7007, cp_container#6991 AS cp_container_0#7008, cp_retailprice#6992 AS cp_retailprice_0#7009, cp_comment#6993 AS cp_comment_0#7010, cp_brand#6994 AS cp_brand_0#7011]
            :     :     :  :  :  :  +- Relation[rid#6978,cval_part_p_name#6979,cval_part_p_mfgr#6980,cval_part_p_type#6981,cval_part_p_size#6982,cval_part_p_container#6983,cval_part_p_retailprice#6984,cval_part_p_comment#6985,cval_part_p_brand#6986,cp_name#6987,cp_mfgr#6988,cp_type#6989,cp_size#6990,cp_container#6991,cp_retailprice#6992,cp_comment#6993,cp_brand#6994] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#7012 AS rid_0#7029, cval_part_p_name#7013 AS cval_part_p_name_0#7030, cval_part_p_mfgr#7014 AS cval_part_p_mfgr_0#7031, cval_part_p_type#7015 AS cval_part_p_type_0#7032, cval_part_p_size#7016 AS cval_part_p_size_0#7033, cval_part_p_container#7017 AS cval_part_p_container_0#7034, cval_part_p_retailprice#7018 AS cval_part_p_retailprice_0#7035, cval_part_p_comment#7019 AS cval_part_p_comment_0#7036, cval_part_p_brand#7020 AS cval_part_p_brand_0#7037, cp_name#7021 AS cp_name_0#7038, cp_mfgr#7022 AS cp_mfgr_0#7039, cp_type#7023 AS cp_type_0#7040, cp_size#7024 AS cp_size_0#7041, cp_container#7025 AS cp_container_0#7042, cp_retailprice#7026 AS cp_retailprice_0#7043, cp_comment#7027 AS cp_comment_0#7044, cp_brand#7028 AS cp_brand_0#7045]
            :     :     :  :  :        +- Relation[rid#7012,cval_part_p_name#7013,cval_part_p_mfgr#7014,cval_part_p_type#7015,cval_part_p_size#7016,cval_part_p_container#7017,cval_part_p_retailprice#7018,cval_part_p_comment#7019,cval_part_p_brand#7020,cp_name#7021,cp_mfgr#7022,cp_type#7023,cp_size#7024,cp_container#7025,cp_retailprice#7026,cp_comment#7027,cp_brand#7028] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- Project [rid#7146 AS rid_1#7179, cpfk_orders_lineitem#7147 AS cpfk_orders_lineitem_1#7180, cpfk_supplier_lineitem#7148 AS cpfk_supplier_lineitem_1#7181, cfpk_lineitem_supplier#7149 AS cfpk_lineitem_supplier_1#7182, cfpk_lineitem_partsupp#7150 AS cfpk_lineitem_partsupp_1#7183, cpfk_part_lineitem#7151 AS cpfk_part_lineitem_1#7184, cfpk_lineitem_part#7152 AS cfpk_lineitem_part_1#7185, cpfk_partsupp_lineitem#7153 AS cpfk_partsupp_lineitem_1#7186, cfpk_lineitem_orders#7154 AS cfpk_lineitem_orders_1#7187, cval_lineitem_l_quantity#7155 AS cval_lineitem_l_quantity_1#7188, cval_lineitem_l_extendedprice#7156 AS cval_lineitem_l_extendedprice_1#7189, cval_lineitem_l_discount#7157 AS cval_lineitem_l_discount_1#7190, cval_lineitem_l_tax#7158 AS cval_lineitem_l_tax_1#7191, cval_lineitem_l_returnflag#7159 AS cval_lineitem_l_returnflag_1#7192, cval_lineitem_l_linestatus#7160 AS cval_lineitem_l_linestatus_1#7193, cval_lineitem_l_commitdate#7161 AS cval_lineitem_l_commitdate_1#7194, cval_lineitem_l_receiptdate#7162 AS cval_lineitem_l_receiptdate_1#7195, cval_lineitem_l_shipinstruct#7163 AS cval_lineitem_l_shipinstruct_1#7196, cval_lineitem_l_shipmode#7164 AS cval_lineitem_l_shipmode_1#7197, cval_lineitem_l_comment#7165 AS cval_lineitem_l_comment_1#7198, cval_lineitem_l_shipdate#7166 AS cval_lineitem_l_shipdate_1#7199, cl_quantity#7167 AS cl_quantity_1#7200, cl_extendedprice#7168 AS cl_extendedprice_1#7201, cl_discount#7169 AS cl_discount_1#7202, ... 9 more fields]
            :     :     :  :     +- Relation[rid#7146,cpfk_orders_lineitem#7147,cpfk_supplier_lineitem#7148,cfpk_lineitem_supplier#7149,cfpk_lineitem_partsupp#7150,cpfk_part_lineitem#7151,cfpk_lineitem_part#7152,cpfk_partsupp_lineitem#7153,cfpk_lineitem_orders#7154,cval_lineitem_l_quantity#7155,cval_lineitem_l_extendedprice#7156,cval_lineitem_l_discount#7157,cval_lineitem_l_tax#7158,cval_lineitem_l_returnflag#7159,cval_lineitem_l_linestatus#7160,cval_lineitem_l_commitdate#7161,cval_lineitem_l_receiptdate#7162,cval_lineitem_l_shipinstruct#7163,cval_lineitem_l_shipmode#7164,cval_lineitem_l_comment#7165,cval_lineitem_l_shipdate#7166,cl_quantity#7167,cl_extendedprice#7168,cl_discount#7169,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#7046 AS rid_1#7079, cpfk_orders_lineitem#7047 AS cpfk_orders_lineitem_1#7080, cpfk_supplier_lineitem#7048 AS cpfk_supplier_lineitem_1#7081, cfpk_lineitem_supplier#7049 AS cfpk_lineitem_supplier_1#7082, cfpk_lineitem_partsupp#7050 AS cfpk_lineitem_partsupp_1#7083, cpfk_part_lineitem#7051 AS cpfk_part_lineitem_1#7084, cfpk_lineitem_part#7052 AS cfpk_lineitem_part_1#7085, cpfk_partsupp_lineitem#7053 AS cpfk_partsupp_lineitem_1#7086, cfpk_lineitem_orders#7054 AS cfpk_lineitem_orders_1#7087, cval_lineitem_l_quantity#7055 AS cval_lineitem_l_quantity_1#7088, cval_lineitem_l_extendedprice#7056 AS cval_lineitem_l_extendedprice_1#7089, cval_lineitem_l_discount#7057 AS cval_lineitem_l_discount_1#7090, cval_lineitem_l_tax#7058 AS cval_lineitem_l_tax_1#7091, cval_lineitem_l_returnflag#7059 AS cval_lineitem_l_returnflag_1#7092, cval_lineitem_l_linestatus#7060 AS cval_lineitem_l_linestatus_1#7093, cval_lineitem_l_commitdate#7061 AS cval_lineitem_l_commitdate_1#7094, cval_lineitem_l_receiptdate#7062 AS cval_lineitem_l_receiptdate_1#7095, cval_lineitem_l_shipinstruct#7063 AS cval_lineitem_l_shipinstruct_1#7096, cval_lineitem_l_shipmode#7064 AS cval_lineitem_l_shipmode_1#7097, cval_lineitem_l_comment#7065 AS cval_lineitem_l_comment_1#7098, cval_lineitem_l_shipdate#7066 AS cval_lineitem_l_shipdate_1#7099, cl_quantity#7067 AS cl_quantity_1#7100, cl_extendedprice#7068 AS cl_extendedprice_1#7101, cl_discount#7069 AS cl_discount_1#7102, ... 9 more fields]
            :     :     :     +- Relation[rid#7046,cpfk_orders_lineitem#7047,cpfk_supplier_lineitem#7048,cfpk_lineitem_supplier#7049,cfpk_lineitem_partsupp#7050,cpfk_part_lineitem#7051,cfpk_lineitem_part#7052,cpfk_partsupp_lineitem#7053,cfpk_lineitem_orders#7054,cval_lineitem_l_quantity#7055,cval_lineitem_l_extendedprice#7056,cval_lineitem_l_discount#7057,cval_lineitem_l_tax#7058,cval_lineitem_l_returnflag#7059,cval_lineitem_l_linestatus#7060,cval_lineitem_l_commitdate#7061,cval_lineitem_l_receiptdate#7062,cval_lineitem_l_shipinstruct#7063,cval_lineitem_l_shipmode#7064,cval_lineitem_l_comment#7065,cval_lineitem_l_shipdate#7066,cl_quantity#7067,cl_extendedprice#7068,cl_discount#7069,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#7212 AS rid_2#7225, cpfk_nation_supplier#7213 AS cpfk_nation_supplier_2#7226, cfpk_supplier_nation#7214 AS cfpk_supplier_nation_2#7227, cval_supplier_s_name#7215 AS cval_supplier_s_name_2#7228, cval_supplier_s_address#7216 AS cval_supplier_s_address_2#7229, cval_supplier_s_phone#7217 AS cval_supplier_s_phone_2#7230, cval_supplier_s_acctbal#7218 AS cval_supplier_s_acctbal_2#7231, cval_supplier_s_comment#7219 AS cval_supplier_s_comment_2#7232, cs_name#7220 AS cs_name_2#7233, cs_address#7221 AS cs_address_2#7234, cs_phone#7222 AS cs_phone_2#7235, cs_acctbal#7223 AS cs_acctbal_2#7236, cs_comment#7224 AS cs_comment_2#7237]
            :     :        +- Relation[rid#7212,cpfk_nation_supplier#7213,cfpk_supplier_nation#7214,cval_supplier_s_name#7215,cval_supplier_s_address#7216,cval_supplier_s_phone#7217,cval_supplier_s_acctbal#7218,cval_supplier_s_comment#7219,cs_name#7220,cs_address#7221,cs_phone#7222,cs_acctbal#7223,cs_comment#7224] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#7238 AS rid_3#7245, cpfk_region_nation#7239 AS cpfk_region_nation_3#7246, cfpk_nation_region#7240 AS cfpk_nation_region_3#7247, cval_nation_n_name#7241 AS cval_nation_n_name_3#7248, cval_nation_n_comment#7242 AS cval_nation_n_comment_3#7249, cn_name#7243 AS cn_name_3#7250, cn_comment#7244 AS cn_comment_3#7251]
            :        +- Relation[rid#7238,cpfk_region_nation#7239,cfpk_nation_region#7240,cval_nation_n_name#7241,cval_nation_n_comment#7242,cn_name#7243,cn_comment#7244] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#7252 AS rid_4#7257, cval_region_r_name#7253 AS cval_region_r_name_4#7258, cval_region_r_comment#7254 AS cval_region_r_comment_4#7259, cr_name#7255 AS cr_name_4#7260, cr_comment#7256 AS cr_comment_4#7261]
               :  :  :  :  :  :  :  +- Relation[rid#7252,cval_region_r_name#7253,cval_region_r_comment#7254,cr_name#7255,cr_comment#7256] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#7262 AS rid_4#7267, cval_region_r_name#7263 AS cval_region_r_name_4#7268, cval_region_r_comment#7264 AS cval_region_r_comment_4#7269, cr_name#7265 AS cr_name_4#7270, cr_comment#7266 AS cr_comment_4#7271]
               :  :  :  :  :  :        +- Relation[rid#7262,cval_region_r_name#7263,cval_region_r_comment#7264,cr_name#7265,cr_comment#7266] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- Project [rid#7296 AS rid_5#7303, cpfk_region_nation#7297 AS cpfk_region_nation_5#7304, cfpk_nation_region#7298 AS cfpk_nation_region_5#7305, cval_nation_n_name#7299 AS cval_nation_n_name_5#7306, cval_nation_n_comment#7300 AS cval_nation_n_comment_5#7307, cn_name#7301 AS cn_name_5#7308, cn_comment#7302 AS cn_comment_5#7309]
               :  :  :  :  :     +- Relation[rid#7296,cpfk_region_nation#7297,cfpk_nation_region#7298,cval_nation_n_name#7299,cval_nation_n_comment#7300,cn_name#7301,cn_comment#7302] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#7272 AS rid_5#7279, cpfk_region_nation#7273 AS cpfk_region_nation_5#7280, cfpk_nation_region#7274 AS cfpk_nation_region_5#7281, cval_nation_n_name#7275 AS cval_nation_n_name_5#7282, cval_nation_n_comment#7276 AS cval_nation_n_comment_5#7283, cn_name#7277 AS cn_name_5#7284, cn_comment#7278 AS cn_comment_5#7285]
               :  :  :  :     +- Relation[rid#7272,cpfk_region_nation#7273,cfpk_nation_region#7274,cval_nation_n_name#7275,cval_nation_n_comment#7276,cn_name#7277,cn_comment#7278] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#7354 AS rid_6#7369, cpfk_nation_customer#7355 AS cpfk_nation_customer_6#7370, cfpk_customer_nation#7356 AS cfpk_customer_nation_6#7371, cval_customer_c_name#7357 AS cval_customer_c_name_6#7372, cval_customer_c_address#7358 AS cval_customer_c_address_6#7373, cval_customer_c_phone#7359 AS cval_customer_c_phone_6#7374, cval_customer_c_acctbal#7360 AS cval_customer_c_acctbal_6#7375, cval_customer_c_comment#7361 AS cval_customer_c_comment_6#7376, cval_customer_c_mktsegment#7362 AS cval_customer_c_mktsegment_6#7377, cc_name#7363 AS cc_name_6#7378, cc_address#7364 AS cc_address_6#7379, cc_phone#7365 AS cc_phone_6#7380, cc_acctbal#7366 AS cc_acctbal_6#7381, cc_comment#7367 AS cc_comment_6#7382, cc_mktsegment#7368 AS cc_mktsegment_6#7383]
               :  :  :     +- Relation[rid#7354,cpfk_nation_customer#7355,cfpk_customer_nation#7356,cval_customer_c_name#7357,cval_customer_c_address#7358,cval_customer_c_phone#7359,cval_customer_c_acctbal#7360,cval_customer_c_comment#7361,cval_customer_c_mktsegment#7362,cc_name#7363,cc_address#7364,cc_phone#7365,cc_acctbal#7366,cc_comment#7367,cc_mktsegment#7368] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#7310 AS rid_6#7325, cpfk_nation_customer#7311 AS cpfk_nation_customer_6#7326, cfpk_customer_nation#7312 AS cfpk_customer_nation_6#7327, cval_customer_c_name#7313 AS cval_customer_c_name_6#7328, cval_customer_c_address#7314 AS cval_customer_c_address_6#7329, cval_customer_c_phone#7315 AS cval_customer_c_phone_6#7330, cval_customer_c_acctbal#7316 AS cval_customer_c_acctbal_6#7331, cval_customer_c_comment#7317 AS cval_customer_c_comment_6#7332, cval_customer_c_mktsegment#7318 AS cval_customer_c_mktsegment_6#7333, cc_name#7319 AS cc_name_6#7334, cc_address#7320 AS cc_address_6#7335, cc_phone#7321 AS cc_phone_6#7336, cc_acctbal#7322 AS cc_acctbal_6#7337, cc_comment#7323 AS cc_comment_6#7338, cc_mktsegment#7324 AS cc_mktsegment_6#7339]
               :  :     +- Relation[rid#7310,cpfk_nation_customer#7311,cfpk_customer_nation#7312,cval_customer_c_name#7313,cval_customer_c_address#7314,cval_customer_c_phone#7315,cval_customer_c_acctbal#7316,cval_customer_c_comment#7317,cval_customer_c_mktsegment#7318,cc_name#7319,cc_address#7320,cc_phone#7321,cc_acctbal#7322,cc_comment#7323,cc_mktsegment#7324] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#7448 AS rid_7#7465, cpfk_customer_orders#7449 AS cpfk_customer_orders_7#7466, cfpk_orders_customer#7450 AS cfpk_orders_customer_7#7467, cval_orders_o_orderstatus#7451 AS cval_orders_o_orderstatus_7#7468, cval_orders_o_totalprice#7452 AS cval_orders_o_totalprice_7#7469, cval_orders_o_orderpriority#7453 AS cval_orders_o_orderpriority_7#7470, cval_orders_o_clerk#7454 AS cval_orders_o_clerk_7#7471, cval_orders_o_shippriority#7455 AS cval_orders_o_shippriority_7#7472, cval_orders_o_comment#7456 AS cval_orders_o_comment_7#7473, cval_orders_o_orderdate#7457 AS cval_orders_o_orderdate_7#7474, co_orderstatus#7458 AS co_orderstatus_7#7475, co_totalprice#7459 AS co_totalprice_7#7476, co_orderpriority#7460 AS co_orderpriority_7#7477, co_clerk#7461 AS co_clerk_7#7478, co_shippriority#7462 AS co_shippriority_7#7479, co_comment#7463 AS co_comment_7#7480, co_orderdate#7464 AS co_orderdate_7#7481]
               :     +- Relation[rid#7448,cpfk_customer_orders#7449,cfpk_orders_customer#7450,cval_orders_o_orderstatus#7451,cval_orders_o_totalprice#7452,cval_orders_o_orderpriority#7453,cval_orders_o_clerk#7454,cval_orders_o_shippriority#7455,cval_orders_o_comment#7456,cval_orders_o_orderdate#7457,co_orderstatus#7458,co_totalprice#7459,co_orderpriority#7460,co_clerk#7461,co_shippriority#7462,co_comment#7463,co_orderdate#7464] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#7384 AS rid_7#7401, cpfk_customer_orders#7385 AS cpfk_customer_orders_7#7402, cfpk_orders_customer#7386 AS cfpk_orders_customer_7#7403, cval_orders_o_orderstatus#7387 AS cval_orders_o_orderstatus_7#7404, cval_orders_o_totalprice#7388 AS cval_orders_o_totalprice_7#7405, cval_orders_o_orderpriority#7389 AS cval_orders_o_orderpriority_7#7406, cval_orders_o_clerk#7390 AS cval_orders_o_clerk_7#7407, cval_orders_o_shippriority#7391 AS cval_orders_o_shippriority_7#7408, cval_orders_o_comment#7392 AS cval_orders_o_comment_7#7409, cval_orders_o_orderdate#7393 AS cval_orders_o_orderdate_7#7410, co_orderstatus#7394 AS co_orderstatus_7#7411, co_totalprice#7395 AS co_totalprice_7#7412, co_orderpriority#7396 AS co_orderpriority_7#7413, co_clerk#7397 AS co_clerk_7#7414, co_shippriority#7398 AS co_shippriority_7#7415, co_comment#7399 AS co_comment_7#7416, co_orderdate#7400 AS co_orderdate_7#7417]
                  +- Relation[rid#7384,cpfk_customer_orders#7385,cfpk_orders_customer#7386,cval_orders_o_orderstatus#7387,cval_orders_o_totalprice#7388,cval_orders_o_orderpriority#7389,cval_orders_o_clerk#7390,cval_orders_o_shippriority#7391,cval_orders_o_comment#7392,cval_orders_o_orderdate#7393,co_orderstatus#7394,co_totalprice#7395,co_orderpriority#7396,co_clerk#7397,co_shippriority#7398,co_comment#7399,co_orderdate#7400] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 2171ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/15 15:31:06 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:31:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7601L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:31:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#7601L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#7603 AS rid_0#7636, cpfk_orders_lineitem#7604 AS cpfk_orders_lineitem_0#7637, cpfk_supplier_lineitem#7605 AS cpfk_supplier_lineitem_0#7638, cfpk_lineitem_supplier#7606 AS cfpk_lineitem_supplier_0#7639, cfpk_lineitem_partsupp#7607 AS cfpk_lineitem_partsupp_0#7640, cpfk_part_lineitem#7608 AS cpfk_part_lineitem_0#7641, cfpk_lineitem_part#7609 AS cfpk_lineitem_part_0#7642, cpfk_partsupp_lineitem#7610 AS cpfk_partsupp_lineitem_0#7643, cfpk_lineitem_orders#7611 AS cfpk_lineitem_orders_0#7644, cval_lineitem_l_quantity#7612 AS cval_lineitem_l_quantity_0#7645, cval_lineitem_l_extendedprice#7613 AS cval_lineitem_l_extendedprice_0#7646, cval_lineitem_l_discount#7614 AS cval_lineitem_l_discount_0#7647, cval_lineitem_l_tax#7615 AS cval_lineitem_l_tax_0#7648, cval_lineitem_l_returnflag#7616 AS cval_lineitem_l_returnflag_0#7649, cval_lineitem_l_linestatus#7617 AS cval_lineitem_l_linestatus_0#7650, cval_lineitem_l_commitdate#7618 AS cval_lineitem_l_commitdate_0#7651, cval_lineitem_l_receiptdate#7619 AS cval_lineitem_l_receiptdate_0#7652, cval_lineitem_l_shipinstruct#7620 AS cval_lineitem_l_shipinstruct_0#7653, cval_lineitem_l_shipmode#7621 AS cval_lineitem_l_shipmode_0#7654, cval_lineitem_l_comment#7622 AS cval_lineitem_l_comment_0#7655, cval_lineitem_l_shipdate#7623 AS cval_lineitem_l_shipdate_0#7656, cl_quantity#7624 AS cl_quantity_0#7657, cl_extendedprice#7625 AS cl_extendedprice_0#7658, cl_discount#7626 AS cl_discount_0#7659, ... 9 more fields]
         +- Relation[rid#7603,cpfk_orders_lineitem#7604,cpfk_supplier_lineitem#7605,cfpk_lineitem_supplier#7606,cfpk_lineitem_partsupp#7607,cpfk_part_lineitem#7608,cfpk_lineitem_part#7609,cpfk_partsupp_lineitem#7610,cfpk_lineitem_orders#7611,cval_lineitem_l_quantity#7612,cval_lineitem_l_extendedprice#7613,cval_lineitem_l_discount#7614,cval_lineitem_l_tax#7615,cval_lineitem_l_returnflag#7616,cval_lineitem_l_linestatus#7617,cval_lineitem_l_commitdate#7618,cval_lineitem_l_receiptdate#7619,cval_lineitem_l_shipinstruct#7620,cval_lineitem_l_shipmode#7621,cval_lineitem_l_comment#7622,cval_lineitem_l_shipdate#7623,cl_quantity#7624,cl_extendedprice#7625,cl_discount#7626,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2817ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 15:31:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:31:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7711L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:31:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:31:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:31:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:31:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:31:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:31:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:31:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:31:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:31:09 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:31:09 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:31:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7711L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#7713 AS rid_0#7720, cpfk_region_nation#7714 AS cpfk_region_nation_0#7721, cfpk_nation_region#7715 AS cfpk_nation_region_0#7722, cval_nation_n_name#7716 AS cval_nation_n_name_0#7723, cval_nation_n_comment#7717 AS cval_nation_n_comment_0#7724, cn_name#7718 AS cn_name_0#7725, cn_comment#7719 AS cn_comment_0#7726]
            :     :     :  :  :  :  :  +- Relation[rid#7713,cpfk_region_nation#7714,cfpk_nation_region#7715,cval_nation_n_name#7716,cval_nation_n_comment#7717,cn_name#7718,cn_comment#7719] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#7753 AS rid_0#7760, cpfk_region_nation#7754 AS cpfk_region_nation_0#7761, cfpk_nation_region#7755 AS cfpk_nation_region_0#7762, cval_nation_n_name#7756 AS cval_nation_n_name_0#7763, cval_nation_n_comment#7757 AS cval_nation_n_comment_0#7764, cn_name#7758 AS cn_name_0#7765, cn_comment#7759 AS cn_comment_0#7766]
            :     :     :  :  :  :     :  +- Relation[rid#7753,cpfk_region_nation#7754,cfpk_nation_region#7755,cval_nation_n_name#7756,cval_nation_n_comment#7757,cn_name#7758,cn_comment#7759] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#7767 AS rid_1#7780, cpfk_nation_supplier#7768 AS cpfk_nation_supplier_1#7781, cfpk_supplier_nation#7769 AS cfpk_supplier_nation_1#7782, cval_supplier_s_name#7770 AS cval_supplier_s_name_1#7783, cval_supplier_s_address#7771 AS cval_supplier_s_address_1#7784, cval_supplier_s_phone#7772 AS cval_supplier_s_phone_1#7785, cval_supplier_s_acctbal#7773 AS cval_supplier_s_acctbal_1#7786, cval_supplier_s_comment#7774 AS cval_supplier_s_comment_1#7787, cs_name#7775 AS cs_name_1#7788, cs_address#7776 AS cs_address_1#7789, cs_phone#7777 AS cs_phone_1#7790, cs_acctbal#7778 AS cs_acctbal_1#7791, cs_comment#7779 AS cs_comment_1#7792]
            :     :     :  :  :  :        +- Relation[rid#7767,cpfk_nation_supplier#7768,cfpk_supplier_nation#7769,cval_supplier_s_name#7770,cval_supplier_s_address#7771,cval_supplier_s_phone#7772,cval_supplier_s_acctbal#7773,cval_supplier_s_comment#7774,cs_name#7775,cs_address#7776,cs_phone#7777,cs_acctbal#7778,cs_comment#7779] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#7727 AS rid_1#7740, cpfk_nation_supplier#7728 AS cpfk_nation_supplier_1#7741, cfpk_supplier_nation#7729 AS cfpk_supplier_nation_1#7742, cval_supplier_s_name#7730 AS cval_supplier_s_name_1#7743, cval_supplier_s_address#7731 AS cval_supplier_s_address_1#7744, cval_supplier_s_phone#7732 AS cval_supplier_s_phone_1#7745, cval_supplier_s_acctbal#7733 AS cval_supplier_s_acctbal_1#7746, cval_supplier_s_comment#7734 AS cval_supplier_s_comment_1#7747, cs_name#7735 AS cs_name_1#7748, cs_address#7736 AS cs_address_1#7749, cs_phone#7737 AS cs_phone_1#7750, cs_acctbal#7738 AS cs_acctbal_1#7751, cs_comment#7739 AS cs_comment_1#7752]
            :     :     :  :  :     +- Relation[rid#7727,cpfk_nation_supplier#7728,cfpk_supplier_nation#7729,cval_supplier_s_name#7730,cval_supplier_s_address#7731,cval_supplier_s_phone#7732,cval_supplier_s_acctbal#7733,cval_supplier_s_comment#7734,cs_name#7735,cs_address#7736,cs_phone#7737,cs_acctbal#7738,cs_comment#7739] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#7859 AS rid_1#7872, cpfk_nation_supplier#7860 AS cpfk_nation_supplier_1#7873, cfpk_supplier_nation#7861 AS cfpk_supplier_nation_1#7874, cval_supplier_s_name#7862 AS cval_supplier_s_name_1#7875, cval_supplier_s_address#7863 AS cval_supplier_s_address_1#7876, cval_supplier_s_phone#7864 AS cval_supplier_s_phone_1#7877, cval_supplier_s_acctbal#7865 AS cval_supplier_s_acctbal_1#7878, cval_supplier_s_comment#7866 AS cval_supplier_s_comment_1#7879, cs_name#7867 AS cs_name_1#7880, cs_address#7868 AS cs_address_1#7881, cs_phone#7869 AS cs_phone_1#7882, cs_acctbal#7870 AS cs_acctbal_1#7883, cs_comment#7871 AS cs_comment_1#7884]
            :     :     :  :     :  +- Relation[rid#7859,cpfk_nation_supplier#7860,cfpk_supplier_nation#7861,cval_supplier_s_name#7862,cval_supplier_s_address#7863,cval_supplier_s_phone#7864,cval_supplier_s_acctbal#7865,cval_supplier_s_comment#7866,cs_name#7867,cs_address#7868,cs_phone#7869,cs_acctbal#7870,cs_comment#7871] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#7885 AS rid_2#7918, cpfk_orders_lineitem#7886 AS cpfk_orders_lineitem_2#7919, cpfk_supplier_lineitem#7887 AS cpfk_supplier_lineitem_2#7920, cfpk_lineitem_supplier#7888 AS cfpk_lineitem_supplier_2#7921, cfpk_lineitem_partsupp#7889 AS cfpk_lineitem_partsupp_2#7922, cpfk_part_lineitem#7890 AS cpfk_part_lineitem_2#7923, cfpk_lineitem_part#7891 AS cfpk_lineitem_part_2#7924, cpfk_partsupp_lineitem#7892 AS cpfk_partsupp_lineitem_2#7925, cfpk_lineitem_orders#7893 AS cfpk_lineitem_orders_2#7926, cval_lineitem_l_quantity#7894 AS cval_lineitem_l_quantity_2#7927, cval_lineitem_l_extendedprice#7895 AS cval_lineitem_l_extendedprice_2#7928, cval_lineitem_l_discount#7896 AS cval_lineitem_l_discount_2#7929, cval_lineitem_l_tax#7897 AS cval_lineitem_l_tax_2#7930, cval_lineitem_l_returnflag#7898 AS cval_lineitem_l_returnflag_2#7931, cval_lineitem_l_linestatus#7899 AS cval_lineitem_l_linestatus_2#7932, cval_lineitem_l_commitdate#7900 AS cval_lineitem_l_commitdate_2#7933, cval_lineitem_l_receiptdate#7901 AS cval_lineitem_l_receiptdate_2#7934, cval_lineitem_l_shipinstruct#7902 AS cval_lineitem_l_shipinstruct_2#7935, cval_lineitem_l_shipmode#7903 AS cval_lineitem_l_shipmode_2#7936, cval_lineitem_l_comment#7904 AS cval_lineitem_l_comment_2#7937, cval_lineitem_l_shipdate#7905 AS cval_lineitem_l_shipdate_2#7938, cl_quantity#7906 AS cl_quantity_2#7939, cl_extendedprice#7907 AS cl_extendedprice_2#7940, cl_discount#7908 AS cl_discount_2#7941, ... 9 more fields]
            :     :     :  :        +- Relation[rid#7885,cpfk_orders_lineitem#7886,cpfk_supplier_lineitem#7887,cfpk_lineitem_supplier#7888,cfpk_lineitem_partsupp#7889,cpfk_part_lineitem#7890,cfpk_lineitem_part#7891,cpfk_partsupp_lineitem#7892,cfpk_lineitem_orders#7893,cval_lineitem_l_quantity#7894,cval_lineitem_l_extendedprice#7895,cval_lineitem_l_discount#7896,cval_lineitem_l_tax#7897,cval_lineitem_l_returnflag#7898,cval_lineitem_l_linestatus#7899,cval_lineitem_l_commitdate#7900,cval_lineitem_l_receiptdate#7901,cval_lineitem_l_shipinstruct#7902,cval_lineitem_l_shipmode#7903,cval_lineitem_l_comment#7904,cval_lineitem_l_shipdate#7905,cl_quantity#7906,cl_extendedprice#7907,cl_discount#7908,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#7793 AS rid_2#7826, cpfk_orders_lineitem#7794 AS cpfk_orders_lineitem_2#7827, cpfk_supplier_lineitem#7795 AS cpfk_supplier_lineitem_2#7828, cfpk_lineitem_supplier#7796 AS cfpk_lineitem_supplier_2#7829, cfpk_lineitem_partsupp#7797 AS cfpk_lineitem_partsupp_2#7830, cpfk_part_lineitem#7798 AS cpfk_part_lineitem_2#7831, cfpk_lineitem_part#7799 AS cfpk_lineitem_part_2#7832, cpfk_partsupp_lineitem#7800 AS cpfk_partsupp_lineitem_2#7833, cfpk_lineitem_orders#7801 AS cfpk_lineitem_orders_2#7834, cval_lineitem_l_quantity#7802 AS cval_lineitem_l_quantity_2#7835, cval_lineitem_l_extendedprice#7803 AS cval_lineitem_l_extendedprice_2#7836, cval_lineitem_l_discount#7804 AS cval_lineitem_l_discount_2#7837, cval_lineitem_l_tax#7805 AS cval_lineitem_l_tax_2#7838, cval_lineitem_l_returnflag#7806 AS cval_lineitem_l_returnflag_2#7839, cval_lineitem_l_linestatus#7807 AS cval_lineitem_l_linestatus_2#7840, cval_lineitem_l_commitdate#7808 AS cval_lineitem_l_commitdate_2#7841, cval_lineitem_l_receiptdate#7809 AS cval_lineitem_l_receiptdate_2#7842, cval_lineitem_l_shipinstruct#7810 AS cval_lineitem_l_shipinstruct_2#7843, cval_lineitem_l_shipmode#7811 AS cval_lineitem_l_shipmode_2#7844, cval_lineitem_l_comment#7812 AS cval_lineitem_l_comment_2#7845, cval_lineitem_l_shipdate#7813 AS cval_lineitem_l_shipdate_2#7846, cl_quantity#7814 AS cl_quantity_2#7847, cl_extendedprice#7815 AS cl_extendedprice_2#7848, cl_discount#7816 AS cl_discount_2#7849, ... 9 more fields]
            :     :     :     +- Relation[rid#7793,cpfk_orders_lineitem#7794,cpfk_supplier_lineitem#7795,cfpk_lineitem_supplier#7796,cfpk_lineitem_partsupp#7797,cpfk_part_lineitem#7798,cfpk_lineitem_part#7799,cpfk_partsupp_lineitem#7800,cfpk_lineitem_orders#7801,cval_lineitem_l_quantity#7802,cval_lineitem_l_extendedprice#7803,cval_lineitem_l_discount#7804,cval_lineitem_l_tax#7805,cval_lineitem_l_returnflag#7806,cval_lineitem_l_linestatus#7807,cval_lineitem_l_commitdate#7808,cval_lineitem_l_receiptdate#7809,cval_lineitem_l_shipinstruct#7810,cval_lineitem_l_shipmode#7811,cval_lineitem_l_comment#7812,cval_lineitem_l_shipdate#7813,cl_quantity#7814,cl_extendedprice#7815,cl_discount#7816,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#7951 AS rid_3#7968, cval_part_p_name#7952 AS cval_part_p_name_3#7969, cval_part_p_mfgr#7953 AS cval_part_p_mfgr_3#7970, cval_part_p_type#7954 AS cval_part_p_type_3#7971, cval_part_p_size#7955 AS cval_part_p_size_3#7972, cval_part_p_container#7956 AS cval_part_p_container_3#7973, cval_part_p_retailprice#7957 AS cval_part_p_retailprice_3#7974, cval_part_p_comment#7958 AS cval_part_p_comment_3#7975, cval_part_p_brand#7959 AS cval_part_p_brand_3#7976, cp_name#7960 AS cp_name_3#7977, cp_mfgr#7961 AS cp_mfgr_3#7978, cp_type#7962 AS cp_type_3#7979, cp_size#7963 AS cp_size_3#7980, cp_container#7964 AS cp_container_3#7981, cp_retailprice#7965 AS cp_retailprice_3#7982, cp_comment#7966 AS cp_comment_3#7983, cp_brand#7967 AS cp_brand_3#7984]
            :     :        +- Relation[rid#7951,cval_part_p_name#7952,cval_part_p_mfgr#7953,cval_part_p_type#7954,cval_part_p_size#7955,cval_part_p_container#7956,cval_part_p_retailprice#7957,cval_part_p_comment#7958,cval_part_p_brand#7959,cp_name#7960,cp_mfgr#7961,cp_type#7962,cp_size#7963,cp_container#7964,cp_retailprice#7965,cp_comment#7966,cp_brand#7967] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#7985 AS rid_4#7996, cpfk_part_partsupp#7986 AS cpfk_part_partsupp_4#7997, cfpk_partsupp_part#7987 AS cfpk_partsupp_part_4#7998, cpfk_supplier_partsupp#7988 AS cpfk_supplier_partsupp_4#7999, cfpk_partsupp_supplier#7989 AS cfpk_partsupp_supplier_4#8000, cval_partsupp_ps_availqty#7990 AS cval_partsupp_ps_availqty_4#8001, cval_partsupp_ps_supplycost#7991 AS cval_partsupp_ps_supplycost_4#8002, cval_partsupp_ps_comment#7992 AS cval_partsupp_ps_comment_4#8003, cps_availqty#7993 AS cps_availqty_4#8004, cps_supplycost#7994 AS cps_supplycost_4#8005, cps_comment#7995 AS cps_comment_4#8006]
            :        +- Relation[rid#7985,cpfk_part_partsupp#7986,cfpk_partsupp_part#7987,cpfk_supplier_partsupp#7988,cfpk_partsupp_supplier#7989,cval_partsupp_ps_availqty#7990,cval_partsupp_ps_supplycost#7991,cval_partsupp_ps_comment#7992,cps_availqty#7993,cps_supplycost#7994,cps_comment#7995] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#8007 AS rid_5#8024, cpfk_customer_orders#8008 AS cpfk_customer_orders_5#8025, cfpk_orders_customer#8009 AS cfpk_orders_customer_5#8026, cval_orders_o_orderstatus#8010 AS cval_orders_o_orderstatus_5#8027, cval_orders_o_totalprice#8011 AS cval_orders_o_totalprice_5#8028, cval_orders_o_orderpriority#8012 AS cval_orders_o_orderpriority_5#8029, cval_orders_o_clerk#8013 AS cval_orders_o_clerk_5#8030, cval_orders_o_shippriority#8014 AS cval_orders_o_shippriority_5#8031, cval_orders_o_comment#8015 AS cval_orders_o_comment_5#8032, cval_orders_o_orderdate#8016 AS cval_orders_o_orderdate_5#8033, co_orderstatus#8017 AS co_orderstatus_5#8034, co_totalprice#8018 AS co_totalprice_5#8035, co_orderpriority#8019 AS co_orderpriority_5#8036, co_clerk#8020 AS co_clerk_5#8037, co_shippriority#8021 AS co_shippriority_5#8038, co_comment#8022 AS co_comment_5#8039, co_orderdate#8023 AS co_orderdate_5#8040]
               +- Relation[rid#8007,cpfk_customer_orders#8008,cfpk_orders_customer#8009,cval_orders_o_orderstatus#8010,cval_orders_o_totalprice#8011,cval_orders_o_orderpriority#8012,cval_orders_o_clerk#8013,cval_orders_o_shippriority#8014,cval_orders_o_comment#8015,cval_orders_o_orderdate#8016,co_orderstatus#8017,co_totalprice#8018,co_orderpriority#8019,co_clerk#8020,co_shippriority#8021,co_comment#8022,co_orderdate#8023] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 256052ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/15 15:35:25 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:35:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8144L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 15:35:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8144L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#8146 AS rid_0#8163, cpfk_customer_orders#8147 AS cpfk_customer_orders_0#8164, cfpk_orders_customer#8148 AS cfpk_orders_customer_0#8165, cval_orders_o_orderstatus#8149 AS cval_orders_o_orderstatus_0#8166, cval_orders_o_totalprice#8150 AS cval_orders_o_totalprice_0#8167, cval_orders_o_orderpriority#8151 AS cval_orders_o_orderpriority_0#8168, cval_orders_o_clerk#8152 AS cval_orders_o_clerk_0#8169, cval_orders_o_shippriority#8153 AS cval_orders_o_shippriority_0#8170, cval_orders_o_comment#8154 AS cval_orders_o_comment_0#8171, cval_orders_o_orderdate#8155 AS cval_orders_o_orderdate_0#8172, co_orderstatus#8156 AS co_orderstatus_0#8173, co_totalprice#8157 AS co_totalprice_0#8174, co_orderpriority#8158 AS co_orderpriority_0#8175, co_clerk#8159 AS co_clerk_0#8176, co_shippriority#8160 AS co_shippriority_0#8177, co_comment#8161 AS co_comment_0#8178, co_orderdate#8162 AS co_orderdate_0#8179]
            :  +- Relation[rid#8146,cpfk_customer_orders#8147,cfpk_orders_customer#8148,cval_orders_o_orderstatus#8149,cval_orders_o_totalprice#8150,cval_orders_o_orderpriority#8151,cval_orders_o_clerk#8152,cval_orders_o_shippriority#8153,cval_orders_o_comment#8154,cval_orders_o_orderdate#8155,co_orderstatus#8156,co_totalprice#8157,co_orderpriority#8158,co_clerk#8159,co_shippriority#8160,co_comment#8161,co_orderdate#8162] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#8180 AS rid_1#8195, cpfk_nation_customer#8181 AS cpfk_nation_customer_1#8196, cfpk_customer_nation#8182 AS cfpk_customer_nation_1#8197, cval_customer_c_name#8183 AS cval_customer_c_name_1#8198, cval_customer_c_address#8184 AS cval_customer_c_address_1#8199, cval_customer_c_phone#8185 AS cval_customer_c_phone_1#8200, cval_customer_c_acctbal#8186 AS cval_customer_c_acctbal_1#8201, cval_customer_c_comment#8187 AS cval_customer_c_comment_1#8202, cval_customer_c_mktsegment#8188 AS cval_customer_c_mktsegment_1#8203, cc_name#8189 AS cc_name_1#8204, cc_address#8190 AS cc_address_1#8205, cc_phone#8191 AS cc_phone_1#8206, cc_acctbal#8192 AS cc_acctbal_1#8207, cc_comment#8193 AS cc_comment_1#8208, cc_mktsegment#8194 AS cc_mktsegment_1#8209]
               +- Relation[rid#8180,cpfk_nation_customer#8181,cfpk_customer_nation#8182,cval_customer_c_name#8183,cval_customer_c_address#8184,cval_customer_c_phone#8185,cval_customer_c_acctbal#8186,cval_customer_c_comment#8187,cval_customer_c_mktsegment#8188,cc_name#8189,cc_address#8190,cc_phone#8191,cc_acctbal#8192,cc_comment#8193,cc_mktsegment#8194] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13661ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/15 15:35:39 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:35:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8250L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:35:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:35:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:35:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:35:39 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:35:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:35:39 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:35:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:35:39 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:35:39 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:35:39 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:35:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:35:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:35:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:35:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:35:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:35:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8250L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#8252 AS rid_0#8259, cpfk_region_nation#8253 AS cpfk_region_nation_0#8260, cfpk_nation_region#8254 AS cfpk_nation_region_0#8261, cval_nation_n_name#8255 AS cval_nation_n_name_0#8262, cval_nation_n_comment#8256 AS cval_nation_n_comment_0#8263, cn_name#8257 AS cn_name_0#8264, cn_comment#8258 AS cn_comment_0#8265]
            :  :  :  :  :  :  +- Relation[rid#8252,cpfk_region_nation#8253,cfpk_nation_region#8254,cval_nation_n_name#8255,cval_nation_n_comment#8256,cn_name#8257,cn_comment#8258] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#8266 AS rid_0#8273, cpfk_region_nation#8267 AS cpfk_region_nation_0#8274, cfpk_nation_region#8268 AS cfpk_nation_region_0#8275, cval_nation_n_name#8269 AS cval_nation_n_name_0#8276, cval_nation_n_comment#8270 AS cval_nation_n_comment_0#8277, cn_name#8271 AS cn_name_0#8278, cn_comment#8272 AS cn_comment_0#8279]
            :  :  :  :  :        +- Relation[rid#8266,cpfk_region_nation#8267,cfpk_nation_region#8268,cval_nation_n_name#8269,cval_nation_n_comment#8270,cn_name#8271,cn_comment#8272] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- Project [rid#8320 AS rid_1#8333, cpfk_nation_supplier#8321 AS cpfk_nation_supplier_1#8334, cfpk_supplier_nation#8322 AS cfpk_supplier_nation_1#8335, cval_supplier_s_name#8323 AS cval_supplier_s_name_1#8336, cval_supplier_s_address#8324 AS cval_supplier_s_address_1#8337, cval_supplier_s_phone#8325 AS cval_supplier_s_phone_1#8338, cval_supplier_s_acctbal#8326 AS cval_supplier_s_acctbal_1#8339, cval_supplier_s_comment#8327 AS cval_supplier_s_comment_1#8340, cs_name#8328 AS cs_name_1#8341, cs_address#8329 AS cs_address_1#8342, cs_phone#8330 AS cs_phone_1#8343, cs_acctbal#8331 AS cs_acctbal_1#8344, cs_comment#8332 AS cs_comment_1#8345]
            :  :  :  :     +- Relation[rid#8320,cpfk_nation_supplier#8321,cfpk_supplier_nation#8322,cval_supplier_s_name#8323,cval_supplier_s_address#8324,cval_supplier_s_phone#8325,cval_supplier_s_acctbal#8326,cval_supplier_s_comment#8327,cs_name#8328,cs_address#8329,cs_phone#8330,cs_acctbal#8331,cs_comment#8332] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#8280 AS rid_1#8293, cpfk_nation_supplier#8281 AS cpfk_nation_supplier_1#8294, cfpk_supplier_nation#8282 AS cfpk_supplier_nation_1#8295, cval_supplier_s_name#8283 AS cval_supplier_s_name_1#8296, cval_supplier_s_address#8284 AS cval_supplier_s_address_1#8297, cval_supplier_s_phone#8285 AS cval_supplier_s_phone_1#8298, cval_supplier_s_acctbal#8286 AS cval_supplier_s_acctbal_1#8299, cval_supplier_s_comment#8287 AS cval_supplier_s_comment_1#8300, cs_name#8288 AS cs_name_1#8301, cs_address#8289 AS cs_address_1#8302, cs_phone#8290 AS cs_phone_1#8303, cs_acctbal#8291 AS cs_acctbal_1#8304, cs_comment#8292 AS cs_comment_1#8305]
            :  :  :     +- Relation[rid#8280,cpfk_nation_supplier#8281,cfpk_supplier_nation#8282,cval_supplier_s_name#8283,cval_supplier_s_address#8284,cval_supplier_s_phone#8285,cval_supplier_s_acctbal#8286,cval_supplier_s_comment#8287,cs_name#8288,cs_address#8289,cs_phone#8290,cs_acctbal#8291,cs_comment#8292] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- Project [rid#8438 AS rid_2#8471, cpfk_orders_lineitem#8439 AS cpfk_orders_lineitem_2#8472, cpfk_supplier_lineitem#8440 AS cpfk_supplier_lineitem_2#8473, cfpk_lineitem_supplier#8441 AS cfpk_lineitem_supplier_2#8474, cfpk_lineitem_partsupp#8442 AS cfpk_lineitem_partsupp_2#8475, cpfk_part_lineitem#8443 AS cpfk_part_lineitem_2#8476, cfpk_lineitem_part#8444 AS cfpk_lineitem_part_2#8477, cpfk_partsupp_lineitem#8445 AS cpfk_partsupp_lineitem_2#8478, cfpk_lineitem_orders#8446 AS cfpk_lineitem_orders_2#8479, cval_lineitem_l_quantity#8447 AS cval_lineitem_l_quantity_2#8480, cval_lineitem_l_extendedprice#8448 AS cval_lineitem_l_extendedprice_2#8481, cval_lineitem_l_discount#8449 AS cval_lineitem_l_discount_2#8482, cval_lineitem_l_tax#8450 AS cval_lineitem_l_tax_2#8483, cval_lineitem_l_returnflag#8451 AS cval_lineitem_l_returnflag_2#8484, cval_lineitem_l_linestatus#8452 AS cval_lineitem_l_linestatus_2#8485, cval_lineitem_l_commitdate#8453 AS cval_lineitem_l_commitdate_2#8486, cval_lineitem_l_receiptdate#8454 AS cval_lineitem_l_receiptdate_2#8487, cval_lineitem_l_shipinstruct#8455 AS cval_lineitem_l_shipinstruct_2#8488, cval_lineitem_l_shipmode#8456 AS cval_lineitem_l_shipmode_2#8489, cval_lineitem_l_comment#8457 AS cval_lineitem_l_comment_2#8490, cval_lineitem_l_shipdate#8458 AS cval_lineitem_l_shipdate_2#8491, cl_quantity#8459 AS cl_quantity_2#8492, cl_extendedprice#8460 AS cl_extendedprice_2#8493, cl_discount#8461 AS cl_discount_2#8494, ... 9 more fields]
            :  :     +- Relation[rid#8438,cpfk_orders_lineitem#8439,cpfk_supplier_lineitem#8440,cfpk_lineitem_supplier#8441,cfpk_lineitem_partsupp#8442,cpfk_part_lineitem#8443,cfpk_lineitem_part#8444,cpfk_partsupp_lineitem#8445,cfpk_lineitem_orders#8446,cval_lineitem_l_quantity#8447,cval_lineitem_l_extendedprice#8448,cval_lineitem_l_discount#8449,cval_lineitem_l_tax#8450,cval_lineitem_l_returnflag#8451,cval_lineitem_l_linestatus#8452,cval_lineitem_l_commitdate#8453,cval_lineitem_l_receiptdate#8454,cval_lineitem_l_shipinstruct#8455,cval_lineitem_l_shipmode#8456,cval_lineitem_l_comment#8457,cval_lineitem_l_shipdate#8458,cl_quantity#8459,cl_extendedprice#8460,cl_discount#8461,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#8346 AS rid_2#8379, cpfk_orders_lineitem#8347 AS cpfk_orders_lineitem_2#8380, cpfk_supplier_lineitem#8348 AS cpfk_supplier_lineitem_2#8381, cfpk_lineitem_supplier#8349 AS cfpk_lineitem_supplier_2#8382, cfpk_lineitem_partsupp#8350 AS cfpk_lineitem_partsupp_2#8383, cpfk_part_lineitem#8351 AS cpfk_part_lineitem_2#8384, cfpk_lineitem_part#8352 AS cfpk_lineitem_part_2#8385, cpfk_partsupp_lineitem#8353 AS cpfk_partsupp_lineitem_2#8386, cfpk_lineitem_orders#8354 AS cfpk_lineitem_orders_2#8387, cval_lineitem_l_quantity#8355 AS cval_lineitem_l_quantity_2#8388, cval_lineitem_l_extendedprice#8356 AS cval_lineitem_l_extendedprice_2#8389, cval_lineitem_l_discount#8357 AS cval_lineitem_l_discount_2#8390, cval_lineitem_l_tax#8358 AS cval_lineitem_l_tax_2#8391, cval_lineitem_l_returnflag#8359 AS cval_lineitem_l_returnflag_2#8392, cval_lineitem_l_linestatus#8360 AS cval_lineitem_l_linestatus_2#8393, cval_lineitem_l_commitdate#8361 AS cval_lineitem_l_commitdate_2#8394, cval_lineitem_l_receiptdate#8362 AS cval_lineitem_l_receiptdate_2#8395, cval_lineitem_l_shipinstruct#8363 AS cval_lineitem_l_shipinstruct_2#8396, cval_lineitem_l_shipmode#8364 AS cval_lineitem_l_shipmode_2#8397, cval_lineitem_l_comment#8365 AS cval_lineitem_l_comment_2#8398, cval_lineitem_l_shipdate#8366 AS cval_lineitem_l_shipdate_2#8399, cl_quantity#8367 AS cl_quantity_2#8400, cl_extendedprice#8368 AS cl_extendedprice_2#8401, cl_discount#8369 AS cl_discount_2#8402, ... 9 more fields]
            :     +- Relation[rid#8346,cpfk_orders_lineitem#8347,cpfk_supplier_lineitem#8348,cfpk_lineitem_supplier#8349,cfpk_lineitem_partsupp#8350,cpfk_part_lineitem#8351,cfpk_lineitem_part#8352,cpfk_partsupp_lineitem#8353,cfpk_lineitem_orders#8354,cval_lineitem_l_quantity#8355,cval_lineitem_l_extendedprice#8356,cval_lineitem_l_discount#8357,cval_lineitem_l_tax#8358,cval_lineitem_l_returnflag#8359,cval_lineitem_l_linestatus#8360,cval_lineitem_l_commitdate#8361,cval_lineitem_l_receiptdate#8362,cval_lineitem_l_shipinstruct#8363,cval_lineitem_l_shipmode#8364,cval_lineitem_l_comment#8365,cval_lineitem_l_shipdate#8366,cl_quantity#8367,cl_extendedprice#8368,cl_discount#8369,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#8504 AS rid_3#8511, cpfk_region_nation#8505 AS cpfk_region_nation_3#8512, cfpk_nation_region#8506 AS cfpk_nation_region_3#8513, cval_nation_n_name#8507 AS cval_nation_n_name_3#8514, cval_nation_n_comment#8508 AS cval_nation_n_comment_3#8515, cn_name#8509 AS cn_name_3#8516, cn_comment#8510 AS cn_comment_3#8517]
               :  :  :  :  :  +- Relation[rid#8504,cpfk_region_nation#8505,cfpk_nation_region#8506,cval_nation_n_name#8507,cval_nation_n_comment#8508,cn_name#8509,cn_comment#8510] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#8518 AS rid_3#8525, cpfk_region_nation#8519 AS cpfk_region_nation_3#8526, cfpk_nation_region#8520 AS cfpk_nation_region_3#8527, cval_nation_n_name#8521 AS cval_nation_n_name_3#8528, cval_nation_n_comment#8522 AS cval_nation_n_comment_3#8529, cn_name#8523 AS cn_name_3#8530, cn_comment#8524 AS cn_comment_3#8531]
               :  :  :  :        +- Relation[rid#8518,cpfk_region_nation#8519,cfpk_nation_region#8520,cval_nation_n_name#8521,cval_nation_n_comment#8522,cn_name#8523,cn_comment#8524] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#8576 AS rid_4#8591, cpfk_nation_customer#8577 AS cpfk_nation_customer_4#8592, cfpk_customer_nation#8578 AS cfpk_customer_nation_4#8593, cval_customer_c_name#8579 AS cval_customer_c_name_4#8594, cval_customer_c_address#8580 AS cval_customer_c_address_4#8595, cval_customer_c_phone#8581 AS cval_customer_c_phone_4#8596, cval_customer_c_acctbal#8582 AS cval_customer_c_acctbal_4#8597, cval_customer_c_comment#8583 AS cval_customer_c_comment_4#8598, cval_customer_c_mktsegment#8584 AS cval_customer_c_mktsegment_4#8599, cc_name#8585 AS cc_name_4#8600, cc_address#8586 AS cc_address_4#8601, cc_phone#8587 AS cc_phone_4#8602, cc_acctbal#8588 AS cc_acctbal_4#8603, cc_comment#8589 AS cc_comment_4#8604, cc_mktsegment#8590 AS cc_mktsegment_4#8605]
               :  :  :     +- Relation[rid#8576,cpfk_nation_customer#8577,cfpk_customer_nation#8578,cval_customer_c_name#8579,cval_customer_c_address#8580,cval_customer_c_phone#8581,cval_customer_c_acctbal#8582,cval_customer_c_comment#8583,cval_customer_c_mktsegment#8584,cc_name#8585,cc_address#8586,cc_phone#8587,cc_acctbal#8588,cc_comment#8589,cc_mktsegment#8590] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#8532 AS rid_4#8547, cpfk_nation_customer#8533 AS cpfk_nation_customer_4#8548, cfpk_customer_nation#8534 AS cfpk_customer_nation_4#8549, cval_customer_c_name#8535 AS cval_customer_c_name_4#8550, cval_customer_c_address#8536 AS cval_customer_c_address_4#8551, cval_customer_c_phone#8537 AS cval_customer_c_phone_4#8552, cval_customer_c_acctbal#8538 AS cval_customer_c_acctbal_4#8553, cval_customer_c_comment#8539 AS cval_customer_c_comment_4#8554, cval_customer_c_mktsegment#8540 AS cval_customer_c_mktsegment_4#8555, cc_name#8541 AS cc_name_4#8556, cc_address#8542 AS cc_address_4#8557, cc_phone#8543 AS cc_phone_4#8558, cc_acctbal#8544 AS cc_acctbal_4#8559, cc_comment#8545 AS cc_comment_4#8560, cc_mktsegment#8546 AS cc_mktsegment_4#8561]
               :  :     +- Relation[rid#8532,cpfk_nation_customer#8533,cfpk_customer_nation#8534,cval_customer_c_name#8535,cval_customer_c_address#8536,cval_customer_c_phone#8537,cval_customer_c_acctbal#8538,cval_customer_c_comment#8539,cval_customer_c_mktsegment#8540,cc_name#8541,cc_address#8542,cc_phone#8543,cc_acctbal#8544,cc_comment#8545,cc_mktsegment#8546] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#8670 AS rid_5#8687, cpfk_customer_orders#8671 AS cpfk_customer_orders_5#8688, cfpk_orders_customer#8672 AS cfpk_orders_customer_5#8689, cval_orders_o_orderstatus#8673 AS cval_orders_o_orderstatus_5#8690, cval_orders_o_totalprice#8674 AS cval_orders_o_totalprice_5#8691, cval_orders_o_orderpriority#8675 AS cval_orders_o_orderpriority_5#8692, cval_orders_o_clerk#8676 AS cval_orders_o_clerk_5#8693, cval_orders_o_shippriority#8677 AS cval_orders_o_shippriority_5#8694, cval_orders_o_comment#8678 AS cval_orders_o_comment_5#8695, cval_orders_o_orderdate#8679 AS cval_orders_o_orderdate_5#8696, co_orderstatus#8680 AS co_orderstatus_5#8697, co_totalprice#8681 AS co_totalprice_5#8698, co_orderpriority#8682 AS co_orderpriority_5#8699, co_clerk#8683 AS co_clerk_5#8700, co_shippriority#8684 AS co_shippriority_5#8701, co_comment#8685 AS co_comment_5#8702, co_orderdate#8686 AS co_orderdate_5#8703]
               :     +- Relation[rid#8670,cpfk_customer_orders#8671,cfpk_orders_customer#8672,cval_orders_o_orderstatus#8673,cval_orders_o_totalprice#8674,cval_orders_o_orderpriority#8675,cval_orders_o_clerk#8676,cval_orders_o_shippriority#8677,cval_orders_o_comment#8678,cval_orders_o_orderdate#8679,co_orderstatus#8680,co_totalprice#8681,co_orderpriority#8682,co_clerk#8683,co_shippriority#8684,co_comment#8685,co_orderdate#8686] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#8606 AS rid_5#8623, cpfk_customer_orders#8607 AS cpfk_customer_orders_5#8624, cfpk_orders_customer#8608 AS cfpk_orders_customer_5#8625, cval_orders_o_orderstatus#8609 AS cval_orders_o_orderstatus_5#8626, cval_orders_o_totalprice#8610 AS cval_orders_o_totalprice_5#8627, cval_orders_o_orderpriority#8611 AS cval_orders_o_orderpriority_5#8628, cval_orders_o_clerk#8612 AS cval_orders_o_clerk_5#8629, cval_orders_o_shippriority#8613 AS cval_orders_o_shippriority_5#8630, cval_orders_o_comment#8614 AS cval_orders_o_comment_5#8631, cval_orders_o_orderdate#8615 AS cval_orders_o_orderdate_5#8632, co_orderstatus#8616 AS co_orderstatus_5#8633, co_totalprice#8617 AS co_totalprice_5#8634, co_orderpriority#8618 AS co_orderpriority_5#8635, co_clerk#8619 AS co_clerk_5#8636, co_shippriority#8620 AS co_shippriority_5#8637, co_comment#8621 AS co_comment_5#8638, co_orderdate#8622 AS co_orderdate_5#8639]
                  +- Relation[rid#8606,cpfk_customer_orders#8607,cfpk_orders_customer#8608,cval_orders_o_orderstatus#8609,cval_orders_o_totalprice#8610,cval_orders_o_orderpriority#8611,cval_orders_o_clerk#8612,cval_orders_o_shippriority#8613,cval_orders_o_comment#8614,cval_orders_o_orderdate#8615,co_orderstatus#8616,co_totalprice#8617,co_orderpriority#8618,co_clerk#8619,co_shippriority#8620,co_comment#8621,co_orderdate#8622] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 330ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/15 15:35:39 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:35:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8808L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 15:35:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:35:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:35:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8808L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#8810 AS rid_0#8843, cpfk_orders_lineitem#8811 AS cpfk_orders_lineitem_0#8844, cpfk_supplier_lineitem#8812 AS cpfk_supplier_lineitem_0#8845, cfpk_lineitem_supplier#8813 AS cfpk_lineitem_supplier_0#8846, cfpk_lineitem_partsupp#8814 AS cfpk_lineitem_partsupp_0#8847, cpfk_part_lineitem#8815 AS cpfk_part_lineitem_0#8848, cfpk_lineitem_part#8816 AS cfpk_lineitem_part_0#8849, cpfk_partsupp_lineitem#8817 AS cpfk_partsupp_lineitem_0#8850, cfpk_lineitem_orders#8818 AS cfpk_lineitem_orders_0#8851, cval_lineitem_l_quantity#8819 AS cval_lineitem_l_quantity_0#8852, cval_lineitem_l_extendedprice#8820 AS cval_lineitem_l_extendedprice_0#8853, cval_lineitem_l_discount#8821 AS cval_lineitem_l_discount_0#8854, cval_lineitem_l_tax#8822 AS cval_lineitem_l_tax_0#8855, cval_lineitem_l_returnflag#8823 AS cval_lineitem_l_returnflag_0#8856, cval_lineitem_l_linestatus#8824 AS cval_lineitem_l_linestatus_0#8857, cval_lineitem_l_commitdate#8825 AS cval_lineitem_l_commitdate_0#8858, cval_lineitem_l_receiptdate#8826 AS cval_lineitem_l_receiptdate_0#8859, cval_lineitem_l_shipinstruct#8827 AS cval_lineitem_l_shipinstruct_0#8860, cval_lineitem_l_shipmode#8828 AS cval_lineitem_l_shipmode_0#8861, cval_lineitem_l_comment#8829 AS cval_lineitem_l_comment_0#8862, cval_lineitem_l_shipdate#8830 AS cval_lineitem_l_shipdate_0#8863, cl_quantity#8831 AS cl_quantity_0#8864, cl_extendedprice#8832 AS cl_extendedprice_0#8865, cl_discount#8833 AS cl_discount_0#8866, ... 9 more fields]
            :     :     :  :  +- Relation[rid#8810,cpfk_orders_lineitem#8811,cpfk_supplier_lineitem#8812,cfpk_lineitem_supplier#8813,cfpk_lineitem_partsupp#8814,cpfk_part_lineitem#8815,cfpk_lineitem_part#8816,cpfk_partsupp_lineitem#8817,cfpk_lineitem_orders#8818,cval_lineitem_l_quantity#8819,cval_lineitem_l_extendedprice#8820,cval_lineitem_l_discount#8821,cval_lineitem_l_tax#8822,cval_lineitem_l_returnflag#8823,cval_lineitem_l_linestatus#8824,cval_lineitem_l_commitdate#8825,cval_lineitem_l_receiptdate#8826,cval_lineitem_l_shipinstruct#8827,cval_lineitem_l_shipmode#8828,cval_lineitem_l_comment#8829,cval_lineitem_l_shipdate#8830,cl_quantity#8831,cl_extendedprice#8832,cl_discount#8833,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#8876 AS rid_0#8909, cpfk_orders_lineitem#8877 AS cpfk_orders_lineitem_0#8910, cpfk_supplier_lineitem#8878 AS cpfk_supplier_lineitem_0#8911, cfpk_lineitem_supplier#8879 AS cfpk_lineitem_supplier_0#8912, cfpk_lineitem_partsupp#8880 AS cfpk_lineitem_partsupp_0#8913, cpfk_part_lineitem#8881 AS cpfk_part_lineitem_0#8914, cfpk_lineitem_part#8882 AS cfpk_lineitem_part_0#8915, cpfk_partsupp_lineitem#8883 AS cpfk_partsupp_lineitem_0#8916, cfpk_lineitem_orders#8884 AS cfpk_lineitem_orders_0#8917, cval_lineitem_l_quantity#8885 AS cval_lineitem_l_quantity_0#8918, cval_lineitem_l_extendedprice#8886 AS cval_lineitem_l_extendedprice_0#8919, cval_lineitem_l_discount#8887 AS cval_lineitem_l_discount_0#8920, cval_lineitem_l_tax#8888 AS cval_lineitem_l_tax_0#8921, cval_lineitem_l_returnflag#8889 AS cval_lineitem_l_returnflag_0#8922, cval_lineitem_l_linestatus#8890 AS cval_lineitem_l_linestatus_0#8923, cval_lineitem_l_commitdate#8891 AS cval_lineitem_l_commitdate_0#8924, cval_lineitem_l_receiptdate#8892 AS cval_lineitem_l_receiptdate_0#8925, cval_lineitem_l_shipinstruct#8893 AS cval_lineitem_l_shipinstruct_0#8926, cval_lineitem_l_shipmode#8894 AS cval_lineitem_l_shipmode_0#8927, cval_lineitem_l_comment#8895 AS cval_lineitem_l_comment_0#8928, cval_lineitem_l_shipdate#8896 AS cval_lineitem_l_shipdate_0#8929, cl_quantity#8897 AS cl_quantity_0#8930, cl_extendedprice#8898 AS cl_extendedprice_0#8931, cl_discount#8899 AS cl_discount_0#8932, ... 9 more fields]
            :     :     :        +- Relation[rid#8876,cpfk_orders_lineitem#8877,cpfk_supplier_lineitem#8878,cfpk_lineitem_supplier#8879,cfpk_lineitem_partsupp#8880,cpfk_part_lineitem#8881,cfpk_lineitem_part#8882,cpfk_partsupp_lineitem#8883,cfpk_lineitem_orders#8884,cval_lineitem_l_quantity#8885,cval_lineitem_l_extendedprice#8886,cval_lineitem_l_discount#8887,cval_lineitem_l_tax#8888,cval_lineitem_l_returnflag#8889,cval_lineitem_l_linestatus#8890,cval_lineitem_l_commitdate#8891,cval_lineitem_l_receiptdate#8892,cval_lineitem_l_shipinstruct#8893,cval_lineitem_l_shipmode#8894,cval_lineitem_l_comment#8895,cval_lineitem_l_shipdate#8896,cl_quantity#8897,cl_extendedprice#8898,cl_discount#8899,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#8942 AS rid_1#8959, cpfk_customer_orders#8943 AS cpfk_customer_orders_1#8960, cfpk_orders_customer#8944 AS cfpk_orders_customer_1#8961, cval_orders_o_orderstatus#8945 AS cval_orders_o_orderstatus_1#8962, cval_orders_o_totalprice#8946 AS cval_orders_o_totalprice_1#8963, cval_orders_o_orderpriority#8947 AS cval_orders_o_orderpriority_1#8964, cval_orders_o_clerk#8948 AS cval_orders_o_clerk_1#8965, cval_orders_o_shippriority#8949 AS cval_orders_o_shippriority_1#8966, cval_orders_o_comment#8950 AS cval_orders_o_comment_1#8967, cval_orders_o_orderdate#8951 AS cval_orders_o_orderdate_1#8968, co_orderstatus#8952 AS co_orderstatus_1#8969, co_totalprice#8953 AS co_totalprice_1#8970, co_orderpriority#8954 AS co_orderpriority_1#8971, co_clerk#8955 AS co_clerk_1#8972, co_shippriority#8956 AS co_shippriority_1#8973, co_comment#8957 AS co_comment_1#8974, co_orderdate#8958 AS co_orderdate_1#8975]
            :     :        +- Relation[rid#8942,cpfk_customer_orders#8943,cfpk_orders_customer#8944,cval_orders_o_orderstatus#8945,cval_orders_o_totalprice#8946,cval_orders_o_orderpriority#8947,cval_orders_o_clerk#8948,cval_orders_o_shippriority#8949,cval_orders_o_comment#8950,cval_orders_o_orderdate#8951,co_orderstatus#8952,co_totalprice#8953,co_orderpriority#8954,co_clerk#8955,co_shippriority#8956,co_comment#8957,co_orderdate#8958] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#8976 AS rid_2#8991, cpfk_nation_customer#8977 AS cpfk_nation_customer_2#8992, cfpk_customer_nation#8978 AS cfpk_customer_nation_2#8993, cval_customer_c_name#8979 AS cval_customer_c_name_2#8994, cval_customer_c_address#8980 AS cval_customer_c_address_2#8995, cval_customer_c_phone#8981 AS cval_customer_c_phone_2#8996, cval_customer_c_acctbal#8982 AS cval_customer_c_acctbal_2#8997, cval_customer_c_comment#8983 AS cval_customer_c_comment_2#8998, cval_customer_c_mktsegment#8984 AS cval_customer_c_mktsegment_2#8999, cc_name#8985 AS cc_name_2#9000, cc_address#8986 AS cc_address_2#9001, cc_phone#8987 AS cc_phone_2#9002, cc_acctbal#8988 AS cc_acctbal_2#9003, cc_comment#8989 AS cc_comment_2#9004, cc_mktsegment#8990 AS cc_mktsegment_2#9005]
            :        +- Relation[rid#8976,cpfk_nation_customer#8977,cfpk_customer_nation#8978,cval_customer_c_name#8979,cval_customer_c_address#8980,cval_customer_c_phone#8981,cval_customer_c_acctbal#8982,cval_customer_c_comment#8983,cval_customer_c_mktsegment#8984,cc_name#8985,cc_address#8986,cc_phone#8987,cc_acctbal#8988,cc_comment#8989,cc_mktsegment#8990] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#9006 AS rid_3#9013, cpfk_region_nation#9007 AS cpfk_region_nation_3#9014, cfpk_nation_region#9008 AS cfpk_nation_region_3#9015, cval_nation_n_name#9009 AS cval_nation_n_name_3#9016, cval_nation_n_comment#9010 AS cval_nation_n_comment_3#9017, cn_name#9011 AS cn_name_3#9018, cn_comment#9012 AS cn_comment_3#9019]
               +- Relation[rid#9006,cpfk_region_nation#9007,cfpk_nation_region#9008,cval_nation_n_name#9009,cval_nation_n_comment#9010,cn_name#9011,cn_comment#9012] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 66843ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/15 15:36:46 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:36:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9096L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:36:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:36:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:36:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:36:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:36:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:36:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:36:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:36:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9096L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#9098 AS rid_0#9115, cval_part_p_name#9099 AS cval_part_p_name_0#9116, cval_part_p_mfgr#9100 AS cval_part_p_mfgr_0#9117, cval_part_p_type#9101 AS cval_part_p_type_0#9118, cval_part_p_size#9102 AS cval_part_p_size_0#9119, cval_part_p_container#9103 AS cval_part_p_container_0#9120, cval_part_p_retailprice#9104 AS cval_part_p_retailprice_0#9121, cval_part_p_comment#9105 AS cval_part_p_comment_0#9122, cval_part_p_brand#9106 AS cval_part_p_brand_0#9123, cp_name#9107 AS cp_name_0#9124, cp_mfgr#9108 AS cp_mfgr_0#9125, cp_type#9109 AS cp_type_0#9126, cp_size#9110 AS cp_size_0#9127, cp_container#9111 AS cp_container_0#9128, cp_retailprice#9112 AS cp_retailprice_0#9129, cp_comment#9113 AS cp_comment_0#9130, cp_brand#9114 AS cp_brand_0#9131]
         :  :  :  :  +- Relation[rid#9098,cval_part_p_name#9099,cval_part_p_mfgr#9100,cval_part_p_type#9101,cval_part_p_size#9102,cval_part_p_container#9103,cval_part_p_retailprice#9104,cval_part_p_comment#9105,cval_part_p_brand#9106,cp_name#9107,cp_mfgr#9108,cp_type#9109,cp_size#9110,cp_container#9111,cp_retailprice#9112,cp_comment#9113,cp_brand#9114] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#9132 AS rid_0#9149, cval_part_p_name#9133 AS cval_part_p_name_0#9150, cval_part_p_mfgr#9134 AS cval_part_p_mfgr_0#9151, cval_part_p_type#9135 AS cval_part_p_type_0#9152, cval_part_p_size#9136 AS cval_part_p_size_0#9153, cval_part_p_container#9137 AS cval_part_p_container_0#9154, cval_part_p_retailprice#9138 AS cval_part_p_retailprice_0#9155, cval_part_p_comment#9139 AS cval_part_p_comment_0#9156, cval_part_p_brand#9140 AS cval_part_p_brand_0#9157, cp_name#9141 AS cp_name_0#9158, cp_mfgr#9142 AS cp_mfgr_0#9159, cp_type#9143 AS cp_type_0#9160, cp_size#9144 AS cp_size_0#9161, cp_container#9145 AS cp_container_0#9162, cp_retailprice#9146 AS cp_retailprice_0#9163, cp_comment#9147 AS cp_comment_0#9164, cp_brand#9148 AS cp_brand_0#9165]
         :  :  :        +- Relation[rid#9132,cval_part_p_name#9133,cval_part_p_mfgr#9134,cval_part_p_type#9135,cval_part_p_size#9136,cval_part_p_container#9137,cval_part_p_retailprice#9138,cval_part_p_comment#9139,cval_part_p_brand#9140,cp_name#9141,cp_mfgr#9142,cp_type#9143,cp_size#9144,cp_container#9145,cp_retailprice#9146,cp_comment#9147,cp_brand#9148] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#9166 AS rid_0#9183, cval_part_p_name#9167 AS cval_part_p_name_0#9184, cval_part_p_mfgr#9168 AS cval_part_p_mfgr_0#9185, cval_part_p_type#9169 AS cval_part_p_type_0#9186, cval_part_p_size#9170 AS cval_part_p_size_0#9187, cval_part_p_container#9171 AS cval_part_p_container_0#9188, cval_part_p_retailprice#9172 AS cval_part_p_retailprice_0#9189, cval_part_p_comment#9173 AS cval_part_p_comment_0#9190, cval_part_p_brand#9174 AS cval_part_p_brand_0#9191, cp_name#9175 AS cp_name_0#9192, cp_mfgr#9176 AS cp_mfgr_0#9193, cp_type#9177 AS cp_type_0#9194, cp_size#9178 AS cp_size_0#9195, cp_container#9179 AS cp_container_0#9196, cp_retailprice#9180 AS cp_retailprice_0#9197, cp_comment#9181 AS cp_comment_0#9198, cp_brand#9182 AS cp_brand_0#9199]
         :  :        +- Relation[rid#9166,cval_part_p_name#9167,cval_part_p_mfgr#9168,cval_part_p_type#9169,cval_part_p_size#9170,cval_part_p_container#9171,cval_part_p_retailprice#9172,cval_part_p_comment#9173,cval_part_p_brand#9174,cp_name#9175,cp_mfgr#9176,cp_type#9177,cp_size#9178,cp_container#9179,cp_retailprice#9180,cp_comment#9181,cp_brand#9182] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#9300 AS rid_1#9333, cpfk_orders_lineitem#9301 AS cpfk_orders_lineitem_1#9334, cpfk_supplier_lineitem#9302 AS cpfk_supplier_lineitem_1#9335, cfpk_lineitem_supplier#9303 AS cfpk_lineitem_supplier_1#9336, cfpk_lineitem_partsupp#9304 AS cfpk_lineitem_partsupp_1#9337, cpfk_part_lineitem#9305 AS cpfk_part_lineitem_1#9338, cfpk_lineitem_part#9306 AS cfpk_lineitem_part_1#9339, cpfk_partsupp_lineitem#9307 AS cpfk_partsupp_lineitem_1#9340, cfpk_lineitem_orders#9308 AS cfpk_lineitem_orders_1#9341, cval_lineitem_l_quantity#9309 AS cval_lineitem_l_quantity_1#9342, cval_lineitem_l_extendedprice#9310 AS cval_lineitem_l_extendedprice_1#9343, cval_lineitem_l_discount#9311 AS cval_lineitem_l_discount_1#9344, cval_lineitem_l_tax#9312 AS cval_lineitem_l_tax_1#9345, cval_lineitem_l_returnflag#9313 AS cval_lineitem_l_returnflag_1#9346, cval_lineitem_l_linestatus#9314 AS cval_lineitem_l_linestatus_1#9347, cval_lineitem_l_commitdate#9315 AS cval_lineitem_l_commitdate_1#9348, cval_lineitem_l_receiptdate#9316 AS cval_lineitem_l_receiptdate_1#9349, cval_lineitem_l_shipinstruct#9317 AS cval_lineitem_l_shipinstruct_1#9350, cval_lineitem_l_shipmode#9318 AS cval_lineitem_l_shipmode_1#9351, cval_lineitem_l_comment#9319 AS cval_lineitem_l_comment_1#9352, cval_lineitem_l_shipdate#9320 AS cval_lineitem_l_shipdate_1#9353, cl_quantity#9321 AS cl_quantity_1#9354, cl_extendedprice#9322 AS cl_extendedprice_1#9355, cl_discount#9323 AS cl_discount_1#9356, ... 9 more fields]
         :     +- Relation[rid#9300,cpfk_orders_lineitem#9301,cpfk_supplier_lineitem#9302,cfpk_lineitem_supplier#9303,cfpk_lineitem_partsupp#9304,cpfk_part_lineitem#9305,cfpk_lineitem_part#9306,cpfk_partsupp_lineitem#9307,cfpk_lineitem_orders#9308,cval_lineitem_l_quantity#9309,cval_lineitem_l_extendedprice#9310,cval_lineitem_l_discount#9311,cval_lineitem_l_tax#9312,cval_lineitem_l_returnflag#9313,cval_lineitem_l_linestatus#9314,cval_lineitem_l_commitdate#9315,cval_lineitem_l_receiptdate#9316,cval_lineitem_l_shipinstruct#9317,cval_lineitem_l_shipmode#9318,cval_lineitem_l_comment#9319,cval_lineitem_l_shipdate#9320,cl_quantity#9321,cl_extendedprice#9322,cl_discount#9323,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#9200 AS rid_1#9233, cpfk_orders_lineitem#9201 AS cpfk_orders_lineitem_1#9234, cpfk_supplier_lineitem#9202 AS cpfk_supplier_lineitem_1#9235, cfpk_lineitem_supplier#9203 AS cfpk_lineitem_supplier_1#9236, cfpk_lineitem_partsupp#9204 AS cfpk_lineitem_partsupp_1#9237, cpfk_part_lineitem#9205 AS cpfk_part_lineitem_1#9238, cfpk_lineitem_part#9206 AS cfpk_lineitem_part_1#9239, cpfk_partsupp_lineitem#9207 AS cpfk_partsupp_lineitem_1#9240, cfpk_lineitem_orders#9208 AS cfpk_lineitem_orders_1#9241, cval_lineitem_l_quantity#9209 AS cval_lineitem_l_quantity_1#9242, cval_lineitem_l_extendedprice#9210 AS cval_lineitem_l_extendedprice_1#9243, cval_lineitem_l_discount#9211 AS cval_lineitem_l_discount_1#9244, cval_lineitem_l_tax#9212 AS cval_lineitem_l_tax_1#9245, cval_lineitem_l_returnflag#9213 AS cval_lineitem_l_returnflag_1#9246, cval_lineitem_l_linestatus#9214 AS cval_lineitem_l_linestatus_1#9247, cval_lineitem_l_commitdate#9215 AS cval_lineitem_l_commitdate_1#9248, cval_lineitem_l_receiptdate#9216 AS cval_lineitem_l_receiptdate_1#9249, cval_lineitem_l_shipinstruct#9217 AS cval_lineitem_l_shipinstruct_1#9250, cval_lineitem_l_shipmode#9218 AS cval_lineitem_l_shipmode_1#9251, cval_lineitem_l_comment#9219 AS cval_lineitem_l_comment_1#9252, cval_lineitem_l_shipdate#9220 AS cval_lineitem_l_shipdate_1#9253, cl_quantity#9221 AS cl_quantity_1#9254, cl_extendedprice#9222 AS cl_extendedprice_1#9255, cl_discount#9223 AS cl_discount_1#9256, ... 9 more fields]
            +- Relation[rid#9200,cpfk_orders_lineitem#9201,cpfk_supplier_lineitem#9202,cfpk_lineitem_supplier#9203,cfpk_lineitem_partsupp#9204,cpfk_part_lineitem#9205,cfpk_lineitem_part#9206,cpfk_partsupp_lineitem#9207,cfpk_lineitem_orders#9208,cval_lineitem_l_quantity#9209,cval_lineitem_l_extendedprice#9210,cval_lineitem_l_discount#9211,cval_lineitem_l_tax#9212,cval_lineitem_l_returnflag#9213,cval_lineitem_l_linestatus#9214,cval_lineitem_l_commitdate#9215,cval_lineitem_l_receiptdate#9216,cval_lineitem_l_shipinstruct#9217,cval_lineitem_l_shipmode#9218,cval_lineitem_l_comment#9219,cval_lineitem_l_shipdate#9220,cl_quantity#9221,cl_extendedprice#9222,cl_discount#9223,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=408
Elapsed time: 430ms
query=q1, count=6001215, duration=2817
query=q10, count=1478870, duration=66843
query=q11, count=4, duration=1272
query=q12, count=857401, duration=22925
query=q13, count=1500000, duration=14125
query=q14, count=6001215, duration=87213
query=q15, count=6001215, duration=83667
query=q16, count=7890, duration=650
query=q17, count=408, duration=430
query=q18, count=6001215, duration=125125
query=q19, count=13, duration=62043
query=q2, count=15, duration=1560
query=q20, count=1, duration=671
query=q21a, count=120762, duration=89656
query=q22, count=1500000, duration=13661
query=q3, count=75006, duration=6246
query=q4, count=6001215, duration=55933
query=q5, count=8, duration=20995
query=q6, count=6001215, duration=2787
query=q7, count=0, duration=330
query=q8, count=0, duration=2171
query=q9a, count=6001215, duration=256052
query=q9b, count=6001215, duration=170906
