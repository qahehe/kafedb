20/04/15 15:55:31 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 12766ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Apr 15 15:55:34 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Apr 15 15:55:36 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Apr 15 15:55:36 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Apr 15 15:55:36 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Apr 15 15:55:36 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Apr 15 15:55:41 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Apr 15 15:55:45 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Apr 15 15:55:45 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/15 15:55:47 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:55:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2079L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 15:55:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2079L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#2081 AS rid_0#2098, cpfk_customer_orders#2082 AS cpfk_customer_orders_0#2099, cfpk_orders_customer#2083 AS cfpk_orders_customer_0#2100, cval_orders_o_orderstatus#2084 AS cval_orders_o_orderstatus_0#2101, cval_orders_o_totalprice#2085 AS cval_orders_o_totalprice_0#2102, cval_orders_o_orderpriority#2086 AS cval_orders_o_orderpriority_0#2103, cval_orders_o_clerk#2087 AS cval_orders_o_clerk_0#2104, cval_orders_o_shippriority#2088 AS cval_orders_o_shippriority_0#2105, cval_orders_o_comment#2089 AS cval_orders_o_comment_0#2106, cval_orders_o_orderdate#2090 AS cval_orders_o_orderdate_0#2107, co_orderstatus#2091 AS co_orderstatus_0#2108, co_totalprice#2092 AS co_totalprice_0#2109, co_orderpriority#2093 AS co_orderpriority_0#2110, co_clerk#2094 AS co_clerk_0#2111, co_shippriority#2095 AS co_shippriority_0#2112, co_comment#2096 AS co_comment_0#2113, co_orderdate#2097 AS co_orderdate_0#2114]
            :  +- Relation[rid#2081,cpfk_customer_orders#2082,cfpk_orders_customer#2083,cval_orders_o_orderstatus#2084,cval_orders_o_totalprice#2085,cval_orders_o_orderpriority#2086,cval_orders_o_clerk#2087,cval_orders_o_shippriority#2088,cval_orders_o_comment#2089,cval_orders_o_orderdate#2090,co_orderstatus#2091,co_totalprice#2092,co_orderpriority#2093,co_clerk#2094,co_shippriority#2095,co_comment#2096,co_orderdate#2097] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#2115 AS rid_1#2130, cpfk_nation_customer#2116 AS cpfk_nation_customer_1#2131, cfpk_customer_nation#2117 AS cfpk_customer_nation_1#2132, cval_customer_c_name#2118 AS cval_customer_c_name_1#2133, cval_customer_c_address#2119 AS cval_customer_c_address_1#2134, cval_customer_c_phone#2120 AS cval_customer_c_phone_1#2135, cval_customer_c_acctbal#2121 AS cval_customer_c_acctbal_1#2136, cval_customer_c_comment#2122 AS cval_customer_c_comment_1#2137, cval_customer_c_mktsegment#2123 AS cval_customer_c_mktsegment_1#2138, cc_name#2124 AS cc_name_1#2139, cc_address#2125 AS cc_address_1#2140, cc_phone#2126 AS cc_phone_1#2141, cc_acctbal#2127 AS cc_acctbal_1#2142, cc_comment#2128 AS cc_comment_1#2143, cc_mktsegment#2129 AS cc_mktsegment_1#2144]
               +- Relation[rid#2115,cpfk_nation_customer#2116,cfpk_customer_nation#2117,cval_customer_c_name#2118,cval_customer_c_address#2119,cval_customer_c_phone#2120,cval_customer_c_acctbal#2121,cval_customer_c_comment#2122,cval_customer_c_mktsegment#2123,cc_name#2124,cc_address#2125,cc_phone#2126,cc_acctbal#2127,cc_comment#2128,cc_mktsegment#2129] JDBCRelation(tcustomer) [numPartitions=1]

20/04/15 15:55:48 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexPkFk$ result size=1500000
Elapsed time: 13828ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/15 15:56:01 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:56:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2183L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:56:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2183L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#2185 AS rid_0#2202, cval_part_p_name#2186 AS cval_part_p_name_0#2203, cval_part_p_mfgr#2187 AS cval_part_p_mfgr_0#2204, cval_part_p_type#2188 AS cval_part_p_type_0#2205, cval_part_p_size#2189 AS cval_part_p_size_0#2206, cval_part_p_container#2190 AS cval_part_p_container_0#2207, cval_part_p_retailprice#2191 AS cval_part_p_retailprice_0#2208, cval_part_p_comment#2192 AS cval_part_p_comment_0#2209, cval_part_p_brand#2193 AS cval_part_p_brand_0#2210, cp_name#2194 AS cp_name_0#2211, cp_mfgr#2195 AS cp_mfgr_0#2212, cp_type#2196 AS cp_type_0#2213, cp_size#2197 AS cp_size_0#2214, cp_container#2198 AS cp_container_0#2215, cp_retailprice#2199 AS cp_retailprice_0#2216, cp_comment#2200 AS cp_comment_0#2217, cp_brand#2201 AS cp_brand_0#2218]
         :  :  +- Relation[rid#2185,cval_part_p_name#2186,cval_part_p_mfgr#2187,cval_part_p_type#2188,cval_part_p_size#2189,cval_part_p_container#2190,cval_part_p_retailprice#2191,cval_part_p_comment#2192,cval_part_p_brand#2193,cp_name#2194,cp_mfgr#2195,cp_type#2196,cp_size#2197,cp_container#2198,cp_retailprice#2199,cp_comment#2200,cp_brand#2201] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#2285 AS rid_0#2302, cval_part_p_name#2286 AS cval_part_p_name_0#2303, cval_part_p_mfgr#2287 AS cval_part_p_mfgr_0#2304, cval_part_p_type#2288 AS cval_part_p_type_0#2305, cval_part_p_size#2289 AS cval_part_p_size_0#2306, cval_part_p_container#2290 AS cval_part_p_container_0#2307, cval_part_p_retailprice#2291 AS cval_part_p_retailprice_0#2308, cval_part_p_comment#2292 AS cval_part_p_comment_0#2309, cval_part_p_brand#2293 AS cval_part_p_brand_0#2310, cp_name#2294 AS cp_name_0#2311, cp_mfgr#2295 AS cp_mfgr_0#2312, cp_type#2296 AS cp_type_0#2313, cp_size#2297 AS cp_size_0#2314, cp_container#2298 AS cp_container_0#2315, cp_retailprice#2299 AS cp_retailprice_0#2316, cp_comment#2300 AS cp_comment_0#2317, cp_brand#2301 AS cp_brand_0#2318]
         :     :  +- Relation[rid#2285,cval_part_p_name#2286,cval_part_p_mfgr#2287,cval_part_p_type#2288,cval_part_p_size#2289,cval_part_p_container#2290,cval_part_p_retailprice#2291,cval_part_p_comment#2292,cval_part_p_brand#2293,cp_name#2294,cp_mfgr#2295,cp_type#2296,cp_size#2297,cp_container#2298,cp_retailprice#2299,cp_comment#2300,cp_brand#2301] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#2319 AS rid_1#2352, cpfk_orders_lineitem#2320 AS cpfk_orders_lineitem_1#2353, cpfk_supplier_lineitem#2321 AS cpfk_supplier_lineitem_1#2354, cfpk_lineitem_supplier#2322 AS cfpk_lineitem_supplier_1#2355, cfpk_lineitem_partsupp#2323 AS cfpk_lineitem_partsupp_1#2356, cpfk_part_lineitem#2324 AS cpfk_part_lineitem_1#2357, cfpk_lineitem_part#2325 AS cfpk_lineitem_part_1#2358, cpfk_partsupp_lineitem#2326 AS cpfk_partsupp_lineitem_1#2359, cfpk_lineitem_orders#2327 AS cfpk_lineitem_orders_1#2360, cval_lineitem_l_quantity#2328 AS cval_lineitem_l_quantity_1#2361, cval_lineitem_l_extendedprice#2329 AS cval_lineitem_l_extendedprice_1#2362, cval_lineitem_l_discount#2330 AS cval_lineitem_l_discount_1#2363, cval_lineitem_l_tax#2331 AS cval_lineitem_l_tax_1#2364, cval_lineitem_l_returnflag#2332 AS cval_lineitem_l_returnflag_1#2365, cval_lineitem_l_linestatus#2333 AS cval_lineitem_l_linestatus_1#2366, cval_lineitem_l_commitdate#2334 AS cval_lineitem_l_commitdate_1#2367, cval_lineitem_l_receiptdate#2335 AS cval_lineitem_l_receiptdate_1#2368, cval_lineitem_l_shipinstruct#2336 AS cval_lineitem_l_shipinstruct_1#2369, cval_lineitem_l_shipmode#2337 AS cval_lineitem_l_shipmode_1#2370, cval_lineitem_l_comment#2338 AS cval_lineitem_l_comment_1#2371, cval_lineitem_l_shipdate#2339 AS cval_lineitem_l_shipdate_1#2372, cl_quantity#2340 AS cl_quantity_1#2373, cl_extendedprice#2341 AS cl_extendedprice_1#2374, cl_discount#2342 AS cl_discount_1#2375, ... 9 more fields]
         :        +- Relation[rid#2319,cpfk_orders_lineitem#2320,cpfk_supplier_lineitem#2321,cfpk_lineitem_supplier#2322,cfpk_lineitem_partsupp#2323,cpfk_part_lineitem#2324,cfpk_lineitem_part#2325,cpfk_partsupp_lineitem#2326,cfpk_lineitem_orders#2327,cval_lineitem_l_quantity#2328,cval_lineitem_l_extendedprice#2329,cval_lineitem_l_discount#2330,cval_lineitem_l_tax#2331,cval_lineitem_l_returnflag#2332,cval_lineitem_l_linestatus#2333,cval_lineitem_l_commitdate#2334,cval_lineitem_l_receiptdate#2335,cval_lineitem_l_shipinstruct#2336,cval_lineitem_l_shipmode#2337,cval_lineitem_l_comment#2338,cval_lineitem_l_shipdate#2339,cl_quantity#2340,cl_extendedprice#2341,cl_discount#2342,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2219 AS rid_1#2252, cpfk_orders_lineitem#2220 AS cpfk_orders_lineitem_1#2253, cpfk_supplier_lineitem#2221 AS cpfk_supplier_lineitem_1#2254, cfpk_lineitem_supplier#2222 AS cfpk_lineitem_supplier_1#2255, cfpk_lineitem_partsupp#2223 AS cfpk_lineitem_partsupp_1#2256, cpfk_part_lineitem#2224 AS cpfk_part_lineitem_1#2257, cfpk_lineitem_part#2225 AS cfpk_lineitem_part_1#2258, cpfk_partsupp_lineitem#2226 AS cpfk_partsupp_lineitem_1#2259, cfpk_lineitem_orders#2227 AS cfpk_lineitem_orders_1#2260, cval_lineitem_l_quantity#2228 AS cval_lineitem_l_quantity_1#2261, cval_lineitem_l_extendedprice#2229 AS cval_lineitem_l_extendedprice_1#2262, cval_lineitem_l_discount#2230 AS cval_lineitem_l_discount_1#2263, cval_lineitem_l_tax#2231 AS cval_lineitem_l_tax_1#2264, cval_lineitem_l_returnflag#2232 AS cval_lineitem_l_returnflag_1#2265, cval_lineitem_l_linestatus#2233 AS cval_lineitem_l_linestatus_1#2266, cval_lineitem_l_commitdate#2234 AS cval_lineitem_l_commitdate_1#2267, cval_lineitem_l_receiptdate#2235 AS cval_lineitem_l_receiptdate_1#2268, cval_lineitem_l_shipinstruct#2236 AS cval_lineitem_l_shipinstruct_1#2269, cval_lineitem_l_shipmode#2237 AS cval_lineitem_l_shipmode_1#2270, cval_lineitem_l_comment#2238 AS cval_lineitem_l_comment_1#2271, cval_lineitem_l_shipdate#2239 AS cval_lineitem_l_shipdate_1#2272, cl_quantity#2240 AS cl_quantity_1#2273, cl_extendedprice#2241 AS cl_extendedprice_1#2274, cl_discount#2242 AS cl_discount_1#2275, ... 9 more fields]
            +- Relation[rid#2219,cpfk_orders_lineitem#2220,cpfk_supplier_lineitem#2221,cfpk_lineitem_supplier#2222,cfpk_lineitem_partsupp#2223,cpfk_part_lineitem#2224,cfpk_lineitem_part#2225,cpfk_partsupp_lineitem#2226,cfpk_lineitem_orders#2227,cval_lineitem_l_quantity#2228,cval_lineitem_l_extendedprice#2229,cval_lineitem_l_discount#2230,cval_lineitem_l_tax#2231,cval_lineitem_l_returnflag#2232,cval_lineitem_l_linestatus#2233,cval_lineitem_l_commitdate#2234,cval_lineitem_l_receiptdate#2235,cval_lineitem_l_shipinstruct#2236,cval_lineitem_l_shipmode#2237,cval_lineitem_l_comment#2238,cval_lineitem_l_shipdate#2239,cl_quantity#2240,cl_extendedprice#2241,cl_discount#2242,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 87873ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/15 15:57:29 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:57:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2440L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:57:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#2440L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#2442 AS rid_0#2475, cpfk_orders_lineitem#2443 AS cpfk_orders_lineitem_0#2476, cpfk_supplier_lineitem#2444 AS cpfk_supplier_lineitem_0#2477, cfpk_lineitem_supplier#2445 AS cfpk_lineitem_supplier_0#2478, cfpk_lineitem_partsupp#2446 AS cfpk_lineitem_partsupp_0#2479, cpfk_part_lineitem#2447 AS cpfk_part_lineitem_0#2480, cfpk_lineitem_part#2448 AS cfpk_lineitem_part_0#2481, cpfk_partsupp_lineitem#2449 AS cpfk_partsupp_lineitem_0#2482, cfpk_lineitem_orders#2450 AS cfpk_lineitem_orders_0#2483, cval_lineitem_l_quantity#2451 AS cval_lineitem_l_quantity_0#2484, cval_lineitem_l_extendedprice#2452 AS cval_lineitem_l_extendedprice_0#2485, cval_lineitem_l_discount#2453 AS cval_lineitem_l_discount_0#2486, cval_lineitem_l_tax#2454 AS cval_lineitem_l_tax_0#2487, cval_lineitem_l_returnflag#2455 AS cval_lineitem_l_returnflag_0#2488, cval_lineitem_l_linestatus#2456 AS cval_lineitem_l_linestatus_0#2489, cval_lineitem_l_commitdate#2457 AS cval_lineitem_l_commitdate_0#2490, cval_lineitem_l_receiptdate#2458 AS cval_lineitem_l_receiptdate_0#2491, cval_lineitem_l_shipinstruct#2459 AS cval_lineitem_l_shipinstruct_0#2492, cval_lineitem_l_shipmode#2460 AS cval_lineitem_l_shipmode_0#2493, cval_lineitem_l_comment#2461 AS cval_lineitem_l_comment_0#2494, cval_lineitem_l_shipdate#2462 AS cval_lineitem_l_shipdate_0#2495, cl_quantity#2463 AS cl_quantity_0#2496, cl_extendedprice#2464 AS cl_extendedprice_0#2497, cl_discount#2465 AS cl_discount_0#2498, ... 9 more fields]
         +- Relation[rid#2442,cpfk_orders_lineitem#2443,cpfk_supplier_lineitem#2444,cfpk_lineitem_supplier#2445,cfpk_lineitem_partsupp#2446,cpfk_part_lineitem#2447,cfpk_lineitem_part#2448,cpfk_partsupp_lineitem#2449,cfpk_lineitem_orders#2450,cval_lineitem_l_quantity#2451,cval_lineitem_l_extendedprice#2452,cval_lineitem_l_discount#2453,cval_lineitem_l_tax#2454,cval_lineitem_l_returnflag#2455,cval_lineitem_l_linestatus#2456,cval_lineitem_l_commitdate#2457,cval_lineitem_l_receiptdate#2458,cval_lineitem_l_shipinstruct#2459,cval_lineitem_l_shipmode#2460,cval_lineitem_l_comment#2461,cval_lineitem_l_shipdate#2462,cl_quantity#2463,cl_extendedprice#2464,cl_discount#2465,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2848ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/15 15:57:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:57:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2545L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 15:57:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2545L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#2547 AS rid_0#2564, cpfk_customer_orders#2548 AS cpfk_customer_orders_0#2565, cfpk_orders_customer#2549 AS cfpk_orders_customer_0#2566, cval_orders_o_orderstatus#2550 AS cval_orders_o_orderstatus_0#2567, cval_orders_o_totalprice#2551 AS cval_orders_o_totalprice_0#2568, cval_orders_o_orderpriority#2552 AS cval_orders_o_orderpriority_0#2569, cval_orders_o_clerk#2553 AS cval_orders_o_clerk_0#2570, cval_orders_o_shippriority#2554 AS cval_orders_o_shippriority_0#2571, cval_orders_o_comment#2555 AS cval_orders_o_comment_0#2572, cval_orders_o_orderdate#2556 AS cval_orders_o_orderdate_0#2573, co_orderstatus#2557 AS co_orderstatus_0#2574, co_totalprice#2558 AS co_totalprice_0#2575, co_orderpriority#2559 AS co_orderpriority_0#2576, co_clerk#2560 AS co_clerk_0#2577, co_shippriority#2561 AS co_shippriority_0#2578, co_comment#2562 AS co_comment_0#2579, co_orderdate#2563 AS co_orderdate_0#2580]
            :  +- Relation[rid#2547,cpfk_customer_orders#2548,cfpk_orders_customer#2549,cval_orders_o_orderstatus#2550,cval_orders_o_totalprice#2551,cval_orders_o_orderpriority#2552,cval_orders_o_clerk#2553,cval_orders_o_shippriority#2554,cval_orders_o_comment#2555,cval_orders_o_orderdate#2556,co_orderstatus#2557,co_totalprice#2558,co_orderpriority#2559,co_clerk#2560,co_shippriority#2561,co_comment#2562,co_orderdate#2563] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#2581 AS rid_1#2596, cpfk_nation_customer#2582 AS cpfk_nation_customer_1#2597, cfpk_customer_nation#2583 AS cfpk_customer_nation_1#2598, cval_customer_c_name#2584 AS cval_customer_c_name_1#2599, cval_customer_c_address#2585 AS cval_customer_c_address_1#2600, cval_customer_c_phone#2586 AS cval_customer_c_phone_1#2601, cval_customer_c_acctbal#2587 AS cval_customer_c_acctbal_1#2602, cval_customer_c_comment#2588 AS cval_customer_c_comment_1#2603, cval_customer_c_mktsegment#2589 AS cval_customer_c_mktsegment_1#2604, cc_name#2590 AS cc_name_1#2605, cc_address#2591 AS cc_address_1#2606, cc_phone#2592 AS cc_phone_1#2607, cc_acctbal#2593 AS cc_acctbal_1#2608, cc_comment#2594 AS cc_comment_1#2609, cc_mktsegment#2595 AS cc_mktsegment_1#2610]
               +- Relation[rid#2581,cpfk_nation_customer#2582,cfpk_customer_nation#2583,cval_customer_c_name#2584,cval_customer_c_address#2585,cval_customer_c_phone#2586,cval_customer_c_acctbal#2587,cval_customer_c_comment#2588,cval_customer_c_mktsegment#2589,cc_name#2590,cc_address#2591,cc_phone#2592,cc_acctbal#2593,cc_comment#2594,cc_mktsegment#2595] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13649ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/15 15:57:45 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:57:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2650L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:57:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:57:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:57:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:57:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:57:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:57:45 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:57:45 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:57:45 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:57:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:57:45 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:57:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:57:45 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:57:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:57:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:57:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:57:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2650L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#2652 AS rid_0#2669, cval_part_p_name#2653 AS cval_part_p_name_0#2670, cval_part_p_mfgr#2654 AS cval_part_p_mfgr_0#2671, cval_part_p_type#2655 AS cval_part_p_type_0#2672, cval_part_p_size#2656 AS cval_part_p_size_0#2673, cval_part_p_container#2657 AS cval_part_p_container_0#2674, cval_part_p_retailprice#2658 AS cval_part_p_retailprice_0#2675, cval_part_p_comment#2659 AS cval_part_p_comment_0#2676, cval_part_p_brand#2660 AS cval_part_p_brand_0#2677, cp_name#2661 AS cp_name_0#2678, cp_mfgr#2662 AS cp_mfgr_0#2679, cp_type#2663 AS cp_type_0#2680, cp_size#2664 AS cp_size_0#2681, cp_container#2665 AS cp_container_0#2682, cp_retailprice#2666 AS cp_retailprice_0#2683, cp_comment#2667 AS cp_comment_0#2684, cp_brand#2668 AS cp_brand_0#2685]
            :     :     :  :  :  :  +- Relation[rid#2652,cval_part_p_name#2653,cval_part_p_mfgr#2654,cval_part_p_type#2655,cval_part_p_size#2656,cval_part_p_container#2657,cval_part_p_retailprice#2658,cval_part_p_comment#2659,cval_part_p_brand#2660,cp_name#2661,cp_mfgr#2662,cp_type#2663,cp_size#2664,cp_container#2665,cp_retailprice#2666,cp_comment#2667,cp_brand#2668] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#2686 AS rid_0#2703, cval_part_p_name#2687 AS cval_part_p_name_0#2704, cval_part_p_mfgr#2688 AS cval_part_p_mfgr_0#2705, cval_part_p_type#2689 AS cval_part_p_type_0#2706, cval_part_p_size#2690 AS cval_part_p_size_0#2707, cval_part_p_container#2691 AS cval_part_p_container_0#2708, cval_part_p_retailprice#2692 AS cval_part_p_retailprice_0#2709, cval_part_p_comment#2693 AS cval_part_p_comment_0#2710, cval_part_p_brand#2694 AS cval_part_p_brand_0#2711, cp_name#2695 AS cp_name_0#2712, cp_mfgr#2696 AS cp_mfgr_0#2713, cp_type#2697 AS cp_type_0#2714, cp_size#2698 AS cp_size_0#2715, cp_container#2699 AS cp_container_0#2716, cp_retailprice#2700 AS cp_retailprice_0#2717, cp_comment#2701 AS cp_comment_0#2718, cp_brand#2702 AS cp_brand_0#2719]
            :     :     :  :  :        +- Relation[rid#2686,cval_part_p_name#2687,cval_part_p_mfgr#2688,cval_part_p_type#2689,cval_part_p_size#2690,cval_part_p_container#2691,cval_part_p_retailprice#2692,cval_part_p_comment#2693,cval_part_p_brand#2694,cp_name#2695,cp_mfgr#2696,cp_type#2697,cp_size#2698,cp_container#2699,cp_retailprice#2700,cp_comment#2701,cp_brand#2702] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- Project [rid#2820 AS rid_1#2853, cpfk_orders_lineitem#2821 AS cpfk_orders_lineitem_1#2854, cpfk_supplier_lineitem#2822 AS cpfk_supplier_lineitem_1#2855, cfpk_lineitem_supplier#2823 AS cfpk_lineitem_supplier_1#2856, cfpk_lineitem_partsupp#2824 AS cfpk_lineitem_partsupp_1#2857, cpfk_part_lineitem#2825 AS cpfk_part_lineitem_1#2858, cfpk_lineitem_part#2826 AS cfpk_lineitem_part_1#2859, cpfk_partsupp_lineitem#2827 AS cpfk_partsupp_lineitem_1#2860, cfpk_lineitem_orders#2828 AS cfpk_lineitem_orders_1#2861, cval_lineitem_l_quantity#2829 AS cval_lineitem_l_quantity_1#2862, cval_lineitem_l_extendedprice#2830 AS cval_lineitem_l_extendedprice_1#2863, cval_lineitem_l_discount#2831 AS cval_lineitem_l_discount_1#2864, cval_lineitem_l_tax#2832 AS cval_lineitem_l_tax_1#2865, cval_lineitem_l_returnflag#2833 AS cval_lineitem_l_returnflag_1#2866, cval_lineitem_l_linestatus#2834 AS cval_lineitem_l_linestatus_1#2867, cval_lineitem_l_commitdate#2835 AS cval_lineitem_l_commitdate_1#2868, cval_lineitem_l_receiptdate#2836 AS cval_lineitem_l_receiptdate_1#2869, cval_lineitem_l_shipinstruct#2837 AS cval_lineitem_l_shipinstruct_1#2870, cval_lineitem_l_shipmode#2838 AS cval_lineitem_l_shipmode_1#2871, cval_lineitem_l_comment#2839 AS cval_lineitem_l_comment_1#2872, cval_lineitem_l_shipdate#2840 AS cval_lineitem_l_shipdate_1#2873, cl_quantity#2841 AS cl_quantity_1#2874, cl_extendedprice#2842 AS cl_extendedprice_1#2875, cl_discount#2843 AS cl_discount_1#2876, ... 9 more fields]
            :     :     :  :     +- Relation[rid#2820,cpfk_orders_lineitem#2821,cpfk_supplier_lineitem#2822,cfpk_lineitem_supplier#2823,cfpk_lineitem_partsupp#2824,cpfk_part_lineitem#2825,cfpk_lineitem_part#2826,cpfk_partsupp_lineitem#2827,cfpk_lineitem_orders#2828,cval_lineitem_l_quantity#2829,cval_lineitem_l_extendedprice#2830,cval_lineitem_l_discount#2831,cval_lineitem_l_tax#2832,cval_lineitem_l_returnflag#2833,cval_lineitem_l_linestatus#2834,cval_lineitem_l_commitdate#2835,cval_lineitem_l_receiptdate#2836,cval_lineitem_l_shipinstruct#2837,cval_lineitem_l_shipmode#2838,cval_lineitem_l_comment#2839,cval_lineitem_l_shipdate#2840,cl_quantity#2841,cl_extendedprice#2842,cl_discount#2843,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#2720 AS rid_1#2753, cpfk_orders_lineitem#2721 AS cpfk_orders_lineitem_1#2754, cpfk_supplier_lineitem#2722 AS cpfk_supplier_lineitem_1#2755, cfpk_lineitem_supplier#2723 AS cfpk_lineitem_supplier_1#2756, cfpk_lineitem_partsupp#2724 AS cfpk_lineitem_partsupp_1#2757, cpfk_part_lineitem#2725 AS cpfk_part_lineitem_1#2758, cfpk_lineitem_part#2726 AS cfpk_lineitem_part_1#2759, cpfk_partsupp_lineitem#2727 AS cpfk_partsupp_lineitem_1#2760, cfpk_lineitem_orders#2728 AS cfpk_lineitem_orders_1#2761, cval_lineitem_l_quantity#2729 AS cval_lineitem_l_quantity_1#2762, cval_lineitem_l_extendedprice#2730 AS cval_lineitem_l_extendedprice_1#2763, cval_lineitem_l_discount#2731 AS cval_lineitem_l_discount_1#2764, cval_lineitem_l_tax#2732 AS cval_lineitem_l_tax_1#2765, cval_lineitem_l_returnflag#2733 AS cval_lineitem_l_returnflag_1#2766, cval_lineitem_l_linestatus#2734 AS cval_lineitem_l_linestatus_1#2767, cval_lineitem_l_commitdate#2735 AS cval_lineitem_l_commitdate_1#2768, cval_lineitem_l_receiptdate#2736 AS cval_lineitem_l_receiptdate_1#2769, cval_lineitem_l_shipinstruct#2737 AS cval_lineitem_l_shipinstruct_1#2770, cval_lineitem_l_shipmode#2738 AS cval_lineitem_l_shipmode_1#2771, cval_lineitem_l_comment#2739 AS cval_lineitem_l_comment_1#2772, cval_lineitem_l_shipdate#2740 AS cval_lineitem_l_shipdate_1#2773, cl_quantity#2741 AS cl_quantity_1#2774, cl_extendedprice#2742 AS cl_extendedprice_1#2775, cl_discount#2743 AS cl_discount_1#2776, ... 9 more fields]
            :     :     :     +- Relation[rid#2720,cpfk_orders_lineitem#2721,cpfk_supplier_lineitem#2722,cfpk_lineitem_supplier#2723,cfpk_lineitem_partsupp#2724,cpfk_part_lineitem#2725,cfpk_lineitem_part#2726,cpfk_partsupp_lineitem#2727,cfpk_lineitem_orders#2728,cval_lineitem_l_quantity#2729,cval_lineitem_l_extendedprice#2730,cval_lineitem_l_discount#2731,cval_lineitem_l_tax#2732,cval_lineitem_l_returnflag#2733,cval_lineitem_l_linestatus#2734,cval_lineitem_l_commitdate#2735,cval_lineitem_l_receiptdate#2736,cval_lineitem_l_shipinstruct#2737,cval_lineitem_l_shipmode#2738,cval_lineitem_l_comment#2739,cval_lineitem_l_shipdate#2740,cl_quantity#2741,cl_extendedprice#2742,cl_discount#2743,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#2886 AS rid_2#2899, cpfk_nation_supplier#2887 AS cpfk_nation_supplier_2#2900, cfpk_supplier_nation#2888 AS cfpk_supplier_nation_2#2901, cval_supplier_s_name#2889 AS cval_supplier_s_name_2#2902, cval_supplier_s_address#2890 AS cval_supplier_s_address_2#2903, cval_supplier_s_phone#2891 AS cval_supplier_s_phone_2#2904, cval_supplier_s_acctbal#2892 AS cval_supplier_s_acctbal_2#2905, cval_supplier_s_comment#2893 AS cval_supplier_s_comment_2#2906, cs_name#2894 AS cs_name_2#2907, cs_address#2895 AS cs_address_2#2908, cs_phone#2896 AS cs_phone_2#2909, cs_acctbal#2897 AS cs_acctbal_2#2910, cs_comment#2898 AS cs_comment_2#2911]
            :     :        +- Relation[rid#2886,cpfk_nation_supplier#2887,cfpk_supplier_nation#2888,cval_supplier_s_name#2889,cval_supplier_s_address#2890,cval_supplier_s_phone#2891,cval_supplier_s_acctbal#2892,cval_supplier_s_comment#2893,cs_name#2894,cs_address#2895,cs_phone#2896,cs_acctbal#2897,cs_comment#2898] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#2912 AS rid_3#2919, cpfk_region_nation#2913 AS cpfk_region_nation_3#2920, cfpk_nation_region#2914 AS cfpk_nation_region_3#2921, cval_nation_n_name#2915 AS cval_nation_n_name_3#2922, cval_nation_n_comment#2916 AS cval_nation_n_comment_3#2923, cn_name#2917 AS cn_name_3#2924, cn_comment#2918 AS cn_comment_3#2925]
            :        +- Relation[rid#2912,cpfk_region_nation#2913,cfpk_nation_region#2914,cval_nation_n_name#2915,cval_nation_n_comment#2916,cn_name#2917,cn_comment#2918] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#2926 AS rid_4#2931, cval_region_r_name#2927 AS cval_region_r_name_4#2932, cval_region_r_comment#2928 AS cval_region_r_comment_4#2933, cr_name#2929 AS cr_name_4#2934, cr_comment#2930 AS cr_comment_4#2935]
               :  :  :  :  :  :  :  +- Relation[rid#2926,cval_region_r_name#2927,cval_region_r_comment#2928,cr_name#2929,cr_comment#2930] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#2936 AS rid_4#2941, cval_region_r_name#2937 AS cval_region_r_name_4#2942, cval_region_r_comment#2938 AS cval_region_r_comment_4#2943, cr_name#2939 AS cr_name_4#2944, cr_comment#2940 AS cr_comment_4#2945]
               :  :  :  :  :  :        +- Relation[rid#2936,cval_region_r_name#2937,cval_region_r_comment#2938,cr_name#2939,cr_comment#2940] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- Project [rid#2970 AS rid_5#2977, cpfk_region_nation#2971 AS cpfk_region_nation_5#2978, cfpk_nation_region#2972 AS cfpk_nation_region_5#2979, cval_nation_n_name#2973 AS cval_nation_n_name_5#2980, cval_nation_n_comment#2974 AS cval_nation_n_comment_5#2981, cn_name#2975 AS cn_name_5#2982, cn_comment#2976 AS cn_comment_5#2983]
               :  :  :  :  :     +- Relation[rid#2970,cpfk_region_nation#2971,cfpk_nation_region#2972,cval_nation_n_name#2973,cval_nation_n_comment#2974,cn_name#2975,cn_comment#2976] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#2946 AS rid_5#2953, cpfk_region_nation#2947 AS cpfk_region_nation_5#2954, cfpk_nation_region#2948 AS cfpk_nation_region_5#2955, cval_nation_n_name#2949 AS cval_nation_n_name_5#2956, cval_nation_n_comment#2950 AS cval_nation_n_comment_5#2957, cn_name#2951 AS cn_name_5#2958, cn_comment#2952 AS cn_comment_5#2959]
               :  :  :  :     +- Relation[rid#2946,cpfk_region_nation#2947,cfpk_nation_region#2948,cval_nation_n_name#2949,cval_nation_n_comment#2950,cn_name#2951,cn_comment#2952] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#3028 AS rid_6#3043, cpfk_nation_customer#3029 AS cpfk_nation_customer_6#3044, cfpk_customer_nation#3030 AS cfpk_customer_nation_6#3045, cval_customer_c_name#3031 AS cval_customer_c_name_6#3046, cval_customer_c_address#3032 AS cval_customer_c_address_6#3047, cval_customer_c_phone#3033 AS cval_customer_c_phone_6#3048, cval_customer_c_acctbal#3034 AS cval_customer_c_acctbal_6#3049, cval_customer_c_comment#3035 AS cval_customer_c_comment_6#3050, cval_customer_c_mktsegment#3036 AS cval_customer_c_mktsegment_6#3051, cc_name#3037 AS cc_name_6#3052, cc_address#3038 AS cc_address_6#3053, cc_phone#3039 AS cc_phone_6#3054, cc_acctbal#3040 AS cc_acctbal_6#3055, cc_comment#3041 AS cc_comment_6#3056, cc_mktsegment#3042 AS cc_mktsegment_6#3057]
               :  :  :     +- Relation[rid#3028,cpfk_nation_customer#3029,cfpk_customer_nation#3030,cval_customer_c_name#3031,cval_customer_c_address#3032,cval_customer_c_phone#3033,cval_customer_c_acctbal#3034,cval_customer_c_comment#3035,cval_customer_c_mktsegment#3036,cc_name#3037,cc_address#3038,cc_phone#3039,cc_acctbal#3040,cc_comment#3041,cc_mktsegment#3042] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#2984 AS rid_6#2999, cpfk_nation_customer#2985 AS cpfk_nation_customer_6#3000, cfpk_customer_nation#2986 AS cfpk_customer_nation_6#3001, cval_customer_c_name#2987 AS cval_customer_c_name_6#3002, cval_customer_c_address#2988 AS cval_customer_c_address_6#3003, cval_customer_c_phone#2989 AS cval_customer_c_phone_6#3004, cval_customer_c_acctbal#2990 AS cval_customer_c_acctbal_6#3005, cval_customer_c_comment#2991 AS cval_customer_c_comment_6#3006, cval_customer_c_mktsegment#2992 AS cval_customer_c_mktsegment_6#3007, cc_name#2993 AS cc_name_6#3008, cc_address#2994 AS cc_address_6#3009, cc_phone#2995 AS cc_phone_6#3010, cc_acctbal#2996 AS cc_acctbal_6#3011, cc_comment#2997 AS cc_comment_6#3012, cc_mktsegment#2998 AS cc_mktsegment_6#3013]
               :  :     +- Relation[rid#2984,cpfk_nation_customer#2985,cfpk_customer_nation#2986,cval_customer_c_name#2987,cval_customer_c_address#2988,cval_customer_c_phone#2989,cval_customer_c_acctbal#2990,cval_customer_c_comment#2991,cval_customer_c_mktsegment#2992,cc_name#2993,cc_address#2994,cc_phone#2995,cc_acctbal#2996,cc_comment#2997,cc_mktsegment#2998] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#3122 AS rid_7#3139, cpfk_customer_orders#3123 AS cpfk_customer_orders_7#3140, cfpk_orders_customer#3124 AS cfpk_orders_customer_7#3141, cval_orders_o_orderstatus#3125 AS cval_orders_o_orderstatus_7#3142, cval_orders_o_totalprice#3126 AS cval_orders_o_totalprice_7#3143, cval_orders_o_orderpriority#3127 AS cval_orders_o_orderpriority_7#3144, cval_orders_o_clerk#3128 AS cval_orders_o_clerk_7#3145, cval_orders_o_shippriority#3129 AS cval_orders_o_shippriority_7#3146, cval_orders_o_comment#3130 AS cval_orders_o_comment_7#3147, cval_orders_o_orderdate#3131 AS cval_orders_o_orderdate_7#3148, co_orderstatus#3132 AS co_orderstatus_7#3149, co_totalprice#3133 AS co_totalprice_7#3150, co_orderpriority#3134 AS co_orderpriority_7#3151, co_clerk#3135 AS co_clerk_7#3152, co_shippriority#3136 AS co_shippriority_7#3153, co_comment#3137 AS co_comment_7#3154, co_orderdate#3138 AS co_orderdate_7#3155]
               :     +- Relation[rid#3122,cpfk_customer_orders#3123,cfpk_orders_customer#3124,cval_orders_o_orderstatus#3125,cval_orders_o_totalprice#3126,cval_orders_o_orderpriority#3127,cval_orders_o_clerk#3128,cval_orders_o_shippriority#3129,cval_orders_o_comment#3130,cval_orders_o_orderdate#3131,co_orderstatus#3132,co_totalprice#3133,co_orderpriority#3134,co_clerk#3135,co_shippriority#3136,co_comment#3137,co_orderdate#3138] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#3058 AS rid_7#3075, cpfk_customer_orders#3059 AS cpfk_customer_orders_7#3076, cfpk_orders_customer#3060 AS cfpk_orders_customer_7#3077, cval_orders_o_orderstatus#3061 AS cval_orders_o_orderstatus_7#3078, cval_orders_o_totalprice#3062 AS cval_orders_o_totalprice_7#3079, cval_orders_o_orderpriority#3063 AS cval_orders_o_orderpriority_7#3080, cval_orders_o_clerk#3064 AS cval_orders_o_clerk_7#3081, cval_orders_o_shippriority#3065 AS cval_orders_o_shippriority_7#3082, cval_orders_o_comment#3066 AS cval_orders_o_comment_7#3083, cval_orders_o_orderdate#3067 AS cval_orders_o_orderdate_7#3084, co_orderstatus#3068 AS co_orderstatus_7#3085, co_totalprice#3069 AS co_totalprice_7#3086, co_orderpriority#3070 AS co_orderpriority_7#3087, co_clerk#3071 AS co_clerk_7#3088, co_shippriority#3072 AS co_shippriority_7#3089, co_comment#3073 AS co_comment_7#3090, co_orderdate#3074 AS co_orderdate_7#3091]
                  +- Relation[rid#3058,cpfk_customer_orders#3059,cfpk_orders_customer#3060,cval_orders_o_orderstatus#3061,cval_orders_o_totalprice#3062,cval_orders_o_orderpriority#3063,cval_orders_o_clerk#3064,cval_orders_o_shippriority#3065,cval_orders_o_comment#3066,cval_orders_o_orderdate#3067,co_orderstatus#3068,co_totalprice#3069,co_orderpriority#3070,co_clerk#3071,co_shippriority#3072,co_comment#3073,co_orderdate#3074] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 2955ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/15 15:57:48 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:57:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3275L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:57:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#3275L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#3277 AS rid_0#3310, cpfk_orders_lineitem#3278 AS cpfk_orders_lineitem_0#3311, cpfk_supplier_lineitem#3279 AS cpfk_supplier_lineitem_0#3312, cfpk_lineitem_supplier#3280 AS cfpk_lineitem_supplier_0#3313, cfpk_lineitem_partsupp#3281 AS cfpk_lineitem_partsupp_0#3314, cpfk_part_lineitem#3282 AS cpfk_part_lineitem_0#3315, cfpk_lineitem_part#3283 AS cfpk_lineitem_part_0#3316, cpfk_partsupp_lineitem#3284 AS cpfk_partsupp_lineitem_0#3317, cfpk_lineitem_orders#3285 AS cfpk_lineitem_orders_0#3318, cval_lineitem_l_quantity#3286 AS cval_lineitem_l_quantity_0#3319, cval_lineitem_l_extendedprice#3287 AS cval_lineitem_l_extendedprice_0#3320, cval_lineitem_l_discount#3288 AS cval_lineitem_l_discount_0#3321, cval_lineitem_l_tax#3289 AS cval_lineitem_l_tax_0#3322, cval_lineitem_l_returnflag#3290 AS cval_lineitem_l_returnflag_0#3323, cval_lineitem_l_linestatus#3291 AS cval_lineitem_l_linestatus_0#3324, cval_lineitem_l_commitdate#3292 AS cval_lineitem_l_commitdate_0#3325, cval_lineitem_l_receiptdate#3293 AS cval_lineitem_l_receiptdate_0#3326, cval_lineitem_l_shipinstruct#3294 AS cval_lineitem_l_shipinstruct_0#3327, cval_lineitem_l_shipmode#3295 AS cval_lineitem_l_shipmode_0#3328, cval_lineitem_l_comment#3296 AS cval_lineitem_l_comment_0#3329, cval_lineitem_l_shipdate#3297 AS cval_lineitem_l_shipdate_0#3330, cl_quantity#3298 AS cl_quantity_0#3331, cl_extendedprice#3299 AS cl_extendedprice_0#3332, cl_discount#3300 AS cl_discount_0#3333, ... 9 more fields]
         +- Relation[rid#3277,cpfk_orders_lineitem#3278,cpfk_supplier_lineitem#3279,cfpk_lineitem_supplier#3280,cfpk_lineitem_partsupp#3281,cpfk_part_lineitem#3282,cfpk_lineitem_part#3283,cpfk_partsupp_lineitem#3284,cfpk_lineitem_orders#3285,cval_lineitem_l_quantity#3286,cval_lineitem_l_extendedprice#3287,cval_lineitem_l_discount#3288,cval_lineitem_l_tax#3289,cval_lineitem_l_returnflag#3290,cval_lineitem_l_linestatus#3291,cval_lineitem_l_commitdate#3292,cval_lineitem_l_receiptdate#3293,cval_lineitem_l_shipinstruct#3294,cval_lineitem_l_shipmode#3295,cval_lineitem_l_comment#3296,cval_lineitem_l_shipdate#3297,cl_quantity#3298,cl_extendedprice#3299,cl_discount#3300,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2725ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/15 15:57:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:57:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3380L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 15:57:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:57:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:57:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:57:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:57:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:57:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:57:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:57:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3380L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#3382 AS rid_0#3415, cpfk_orders_lineitem#3383 AS cpfk_orders_lineitem_0#3416, cpfk_supplier_lineitem#3384 AS cpfk_supplier_lineitem_0#3417, cfpk_lineitem_supplier#3385 AS cfpk_lineitem_supplier_0#3418, cfpk_lineitem_partsupp#3386 AS cfpk_lineitem_partsupp_0#3419, cpfk_part_lineitem#3387 AS cpfk_part_lineitem_0#3420, cfpk_lineitem_part#3388 AS cfpk_lineitem_part_0#3421, cpfk_partsupp_lineitem#3389 AS cpfk_partsupp_lineitem_0#3422, cfpk_lineitem_orders#3390 AS cfpk_lineitem_orders_0#3423, cval_lineitem_l_quantity#3391 AS cval_lineitem_l_quantity_0#3424, cval_lineitem_l_extendedprice#3392 AS cval_lineitem_l_extendedprice_0#3425, cval_lineitem_l_discount#3393 AS cval_lineitem_l_discount_0#3426, cval_lineitem_l_tax#3394 AS cval_lineitem_l_tax_0#3427, cval_lineitem_l_returnflag#3395 AS cval_lineitem_l_returnflag_0#3428, cval_lineitem_l_linestatus#3396 AS cval_lineitem_l_linestatus_0#3429, cval_lineitem_l_commitdate#3397 AS cval_lineitem_l_commitdate_0#3430, cval_lineitem_l_receiptdate#3398 AS cval_lineitem_l_receiptdate_0#3431, cval_lineitem_l_shipinstruct#3399 AS cval_lineitem_l_shipinstruct_0#3432, cval_lineitem_l_shipmode#3400 AS cval_lineitem_l_shipmode_0#3433, cval_lineitem_l_comment#3401 AS cval_lineitem_l_comment_0#3434, cval_lineitem_l_shipdate#3402 AS cval_lineitem_l_shipdate_0#3435, cl_quantity#3403 AS cl_quantity_0#3436, cl_extendedprice#3404 AS cl_extendedprice_0#3437, cl_discount#3405 AS cl_discount_0#3438, ... 9 more fields]
            :  +- Relation[rid#3382,cpfk_orders_lineitem#3383,cpfk_supplier_lineitem#3384,cfpk_lineitem_supplier#3385,cfpk_lineitem_partsupp#3386,cpfk_part_lineitem#3387,cfpk_lineitem_part#3388,cpfk_partsupp_lineitem#3389,cfpk_lineitem_orders#3390,cval_lineitem_l_quantity#3391,cval_lineitem_l_extendedprice#3392,cval_lineitem_l_discount#3393,cval_lineitem_l_tax#3394,cval_lineitem_l_returnflag#3395,cval_lineitem_l_linestatus#3396,cval_lineitem_l_commitdate#3397,cval_lineitem_l_receiptdate#3398,cval_lineitem_l_shipinstruct#3399,cval_lineitem_l_shipmode#3400,cval_lineitem_l_comment#3401,cval_lineitem_l_shipdate#3402,cl_quantity#3403,cl_extendedprice#3404,cl_discount#3405,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#3448 AS rid_1#3465, cpfk_customer_orders#3449 AS cpfk_customer_orders_1#3466, cfpk_orders_customer#3450 AS cfpk_orders_customer_1#3467, cval_orders_o_orderstatus#3451 AS cval_orders_o_orderstatus_1#3468, cval_orders_o_totalprice#3452 AS cval_orders_o_totalprice_1#3469, cval_orders_o_orderpriority#3453 AS cval_orders_o_orderpriority_1#3470, cval_orders_o_clerk#3454 AS cval_orders_o_clerk_1#3471, cval_orders_o_shippriority#3455 AS cval_orders_o_shippriority_1#3472, cval_orders_o_comment#3456 AS cval_orders_o_comment_1#3473, cval_orders_o_orderdate#3457 AS cval_orders_o_orderdate_1#3474, co_orderstatus#3458 AS co_orderstatus_1#3475, co_totalprice#3459 AS co_totalprice_1#3476, co_orderpriority#3460 AS co_orderpriority_1#3477, co_clerk#3461 AS co_clerk_1#3478, co_shippriority#3462 AS co_shippriority_1#3479, co_comment#3463 AS co_comment_1#3480, co_orderdate#3464 AS co_orderdate_1#3481]
                  :     :  :  :  :  +- Relation[rid#3448,cpfk_customer_orders#3449,cfpk_orders_customer#3450,cval_orders_o_orderstatus#3451,cval_orders_o_totalprice#3452,cval_orders_o_orderpriority#3453,cval_orders_o_clerk#3454,cval_orders_o_shippriority#3455,cval_orders_o_comment#3456,cval_orders_o_orderdate#3457,co_orderstatus#3458,co_totalprice#3459,co_orderpriority#3460,co_clerk#3461,co_shippriority#3462,co_comment#3463,co_orderdate#3464] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#3482 AS rid_1#3499, cpfk_customer_orders#3483 AS cpfk_customer_orders_1#3500, cfpk_orders_customer#3484 AS cfpk_orders_customer_1#3501, cval_orders_o_orderstatus#3485 AS cval_orders_o_orderstatus_1#3502, cval_orders_o_totalprice#3486 AS cval_orders_o_totalprice_1#3503, cval_orders_o_orderpriority#3487 AS cval_orders_o_orderpriority_1#3504, cval_orders_o_clerk#3488 AS cval_orders_o_clerk_1#3505, cval_orders_o_shippriority#3489 AS cval_orders_o_shippriority_1#3506, cval_orders_o_comment#3490 AS cval_orders_o_comment_1#3507, cval_orders_o_orderdate#3491 AS cval_orders_o_orderdate_1#3508, co_orderstatus#3492 AS co_orderstatus_1#3509, co_totalprice#3493 AS co_totalprice_1#3510, co_orderpriority#3494 AS co_orderpriority_1#3511, co_clerk#3495 AS co_clerk_1#3512, co_shippriority#3496 AS co_shippriority_1#3513, co_comment#3497 AS co_comment_1#3514, co_orderdate#3498 AS co_orderdate_1#3515]
                  :     :  :  :        +- Relation[rid#3482,cpfk_customer_orders#3483,cfpk_orders_customer#3484,cval_orders_o_orderstatus#3485,cval_orders_o_totalprice#3486,cval_orders_o_orderpriority#3487,cval_orders_o_clerk#3488,cval_orders_o_shippriority#3489,cval_orders_o_comment#3490,cval_orders_o_orderdate#3491,co_orderstatus#3492,co_totalprice#3493,co_orderpriority#3494,co_clerk#3495,co_shippriority#3496,co_comment#3497,co_orderdate#3498] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- Project [rid#3616 AS rid_2#3649, cpfk_orders_lineitem#3617 AS cpfk_orders_lineitem_2#3650, cpfk_supplier_lineitem#3618 AS cpfk_supplier_lineitem_2#3651, cfpk_lineitem_supplier#3619 AS cfpk_lineitem_supplier_2#3652, cfpk_lineitem_partsupp#3620 AS cfpk_lineitem_partsupp_2#3653, cpfk_part_lineitem#3621 AS cpfk_part_lineitem_2#3654, cfpk_lineitem_part#3622 AS cfpk_lineitem_part_2#3655, cpfk_partsupp_lineitem#3623 AS cpfk_partsupp_lineitem_2#3656, cfpk_lineitem_orders#3624 AS cfpk_lineitem_orders_2#3657, cval_lineitem_l_quantity#3625 AS cval_lineitem_l_quantity_2#3658, cval_lineitem_l_extendedprice#3626 AS cval_lineitem_l_extendedprice_2#3659, cval_lineitem_l_discount#3627 AS cval_lineitem_l_discount_2#3660, cval_lineitem_l_tax#3628 AS cval_lineitem_l_tax_2#3661, cval_lineitem_l_returnflag#3629 AS cval_lineitem_l_returnflag_2#3662, cval_lineitem_l_linestatus#3630 AS cval_lineitem_l_linestatus_2#3663, cval_lineitem_l_commitdate#3631 AS cval_lineitem_l_commitdate_2#3664, cval_lineitem_l_receiptdate#3632 AS cval_lineitem_l_receiptdate_2#3665, cval_lineitem_l_shipinstruct#3633 AS cval_lineitem_l_shipinstruct_2#3666, cval_lineitem_l_shipmode#3634 AS cval_lineitem_l_shipmode_2#3667, cval_lineitem_l_comment#3635 AS cval_lineitem_l_comment_2#3668, cval_lineitem_l_shipdate#3636 AS cval_lineitem_l_shipdate_2#3669, cl_quantity#3637 AS cl_quantity_2#3670, cl_extendedprice#3638 AS cl_extendedprice_2#3671, cl_discount#3639 AS cl_discount_2#3672, ... 9 more fields]
                  :     :  :     +- Relation[rid#3616,cpfk_orders_lineitem#3617,cpfk_supplier_lineitem#3618,cfpk_lineitem_supplier#3619,cfpk_lineitem_partsupp#3620,cpfk_part_lineitem#3621,cfpk_lineitem_part#3622,cpfk_partsupp_lineitem#3623,cfpk_lineitem_orders#3624,cval_lineitem_l_quantity#3625,cval_lineitem_l_extendedprice#3626,cval_lineitem_l_discount#3627,cval_lineitem_l_tax#3628,cval_lineitem_l_returnflag#3629,cval_lineitem_l_linestatus#3630,cval_lineitem_l_commitdate#3631,cval_lineitem_l_receiptdate#3632,cval_lineitem_l_shipinstruct#3633,cval_lineitem_l_shipmode#3634,cval_lineitem_l_comment#3635,cval_lineitem_l_shipdate#3636,cl_quantity#3637,cl_extendedprice#3638,cl_discount#3639,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#3516 AS rid_2#3549, cpfk_orders_lineitem#3517 AS cpfk_orders_lineitem_2#3550, cpfk_supplier_lineitem#3518 AS cpfk_supplier_lineitem_2#3551, cfpk_lineitem_supplier#3519 AS cfpk_lineitem_supplier_2#3552, cfpk_lineitem_partsupp#3520 AS cfpk_lineitem_partsupp_2#3553, cpfk_part_lineitem#3521 AS cpfk_part_lineitem_2#3554, cfpk_lineitem_part#3522 AS cfpk_lineitem_part_2#3555, cpfk_partsupp_lineitem#3523 AS cpfk_partsupp_lineitem_2#3556, cfpk_lineitem_orders#3524 AS cfpk_lineitem_orders_2#3557, cval_lineitem_l_quantity#3525 AS cval_lineitem_l_quantity_2#3558, cval_lineitem_l_extendedprice#3526 AS cval_lineitem_l_extendedprice_2#3559, cval_lineitem_l_discount#3527 AS cval_lineitem_l_discount_2#3560, cval_lineitem_l_tax#3528 AS cval_lineitem_l_tax_2#3561, cval_lineitem_l_returnflag#3529 AS cval_lineitem_l_returnflag_2#3562, cval_lineitem_l_linestatus#3530 AS cval_lineitem_l_linestatus_2#3563, cval_lineitem_l_commitdate#3531 AS cval_lineitem_l_commitdate_2#3564, cval_lineitem_l_receiptdate#3532 AS cval_lineitem_l_receiptdate_2#3565, cval_lineitem_l_shipinstruct#3533 AS cval_lineitem_l_shipinstruct_2#3566, cval_lineitem_l_shipmode#3534 AS cval_lineitem_l_shipmode_2#3567, cval_lineitem_l_comment#3535 AS cval_lineitem_l_comment_2#3568, cval_lineitem_l_shipdate#3536 AS cval_lineitem_l_shipdate_2#3569, cl_quantity#3537 AS cl_quantity_2#3570, cl_extendedprice#3538 AS cl_extendedprice_2#3571, cl_discount#3539 AS cl_discount_2#3572, ... 9 more fields]
                  :     :     +- Relation[rid#3516,cpfk_orders_lineitem#3517,cpfk_supplier_lineitem#3518,cfpk_lineitem_supplier#3519,cfpk_lineitem_partsupp#3520,cpfk_part_lineitem#3521,cfpk_lineitem_part#3522,cpfk_partsupp_lineitem#3523,cfpk_lineitem_orders#3524,cval_lineitem_l_quantity#3525,cval_lineitem_l_extendedprice#3526,cval_lineitem_l_discount#3527,cval_lineitem_l_tax#3528,cval_lineitem_l_returnflag#3529,cval_lineitem_l_linestatus#3530,cval_lineitem_l_commitdate#3531,cval_lineitem_l_receiptdate#3532,cval_lineitem_l_shipinstruct#3533,cval_lineitem_l_shipmode#3534,cval_lineitem_l_comment#3535,cval_lineitem_l_shipdate#3536,cl_quantity#3537,cl_extendedprice#3538,cl_discount#3539,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#3682 AS rid_3#3695, cpfk_nation_supplier#3683 AS cpfk_nation_supplier_3#3696, cfpk_supplier_nation#3684 AS cfpk_supplier_nation_3#3697, cval_supplier_s_name#3685 AS cval_supplier_s_name_3#3698, cval_supplier_s_address#3686 AS cval_supplier_s_address_3#3699, cval_supplier_s_phone#3687 AS cval_supplier_s_phone_3#3700, cval_supplier_s_acctbal#3688 AS cval_supplier_s_acctbal_3#3701, cval_supplier_s_comment#3689 AS cval_supplier_s_comment_3#3702, cs_name#3690 AS cs_name_3#3703, cs_address#3691 AS cs_address_3#3704, cs_phone#3692 AS cs_phone_3#3705, cs_acctbal#3693 AS cs_acctbal_3#3706, cs_comment#3694 AS cs_comment_3#3707]
                  :        +- Relation[rid#3682,cpfk_nation_supplier#3683,cfpk_supplier_nation#3684,cval_supplier_s_name#3685,cval_supplier_s_address#3686,cval_supplier_s_phone#3687,cval_supplier_s_acctbal#3688,cval_supplier_s_comment#3689,cs_name#3690,cs_address#3691,cs_phone#3692,cs_acctbal#3693,cs_comment#3694] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#3708 AS rid_4#3715, cpfk_region_nation#3709 AS cpfk_region_nation_4#3716, cfpk_nation_region#3710 AS cfpk_nation_region_4#3717, cval_nation_n_name#3711 AS cval_nation_n_name_4#3718, cval_nation_n_comment#3712 AS cval_nation_n_comment_4#3719, cn_name#3713 AS cn_name_4#3720, cn_comment#3714 AS cn_comment_4#3721]
                     :  +- Relation[rid#3708,cpfk_region_nation#3709,cfpk_nation_region#3710,cval_nation_n_name#3711,cval_nation_n_comment#3712,cn_name#3713,cn_comment#3714] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#3722 AS rid_4#3729, cpfk_region_nation#3723 AS cpfk_region_nation_4#3730, cfpk_nation_region#3724 AS cfpk_nation_region_4#3731, cval_nation_n_name#3725 AS cval_nation_n_name_4#3732, cval_nation_n_comment#3726 AS cval_nation_n_comment_4#3733, cn_name#3727 AS cn_name_4#3734, cn_comment#3728 AS cn_comment_4#3735]
                           +- Relation[rid#3722,cpfk_region_nation#3723,cfpk_nation_region#3724,cval_nation_n_name#3725,cval_nation_n_comment#3726,cn_name#3727,cn_comment#3728] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=120762
Elapsed time: 88254ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/15 15:59:19 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:59:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3844L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 15:59:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:59:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:59:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:59:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:59:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:59:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:59:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:59:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:59:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:59:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:59:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:59:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:59:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:59:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3844L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#3846 AS rid_0#3863, cval_part_p_name#3847 AS cval_part_p_name_0#3864, cval_part_p_mfgr#3848 AS cval_part_p_mfgr_0#3865, cval_part_p_type#3849 AS cval_part_p_type_0#3866, cval_part_p_size#3850 AS cval_part_p_size_0#3867, cval_part_p_container#3851 AS cval_part_p_container_0#3868, cval_part_p_retailprice#3852 AS cval_part_p_retailprice_0#3869, cval_part_p_comment#3853 AS cval_part_p_comment_0#3870, cval_part_p_brand#3854 AS cval_part_p_brand_0#3871, cp_name#3855 AS cp_name_0#3872, cp_mfgr#3856 AS cp_mfgr_0#3873, cp_type#3857 AS cp_type_0#3874, cp_size#3858 AS cp_size_0#3875, cp_container#3859 AS cp_container_0#3876, cp_retailprice#3860 AS cp_retailprice_0#3877, cp_comment#3861 AS cp_comment_0#3878, cp_brand#3862 AS cp_brand_0#3879]
            :  :  :  :  +- Relation[rid#3846,cval_part_p_name#3847,cval_part_p_mfgr#3848,cval_part_p_type#3849,cval_part_p_size#3850,cval_part_p_container#3851,cval_part_p_retailprice#3852,cval_part_p_comment#3853,cval_part_p_brand#3854,cp_name#3855,cp_mfgr#3856,cp_type#3857,cp_size#3858,cp_container#3859,cp_retailprice#3860,cp_comment#3861,cp_brand#3862] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#3880 AS rid_0#3897, cval_part_p_name#3881 AS cval_part_p_name_0#3898, cval_part_p_mfgr#3882 AS cval_part_p_mfgr_0#3899, cval_part_p_type#3883 AS cval_part_p_type_0#3900, cval_part_p_size#3884 AS cval_part_p_size_0#3901, cval_part_p_container#3885 AS cval_part_p_container_0#3902, cval_part_p_retailprice#3886 AS cval_part_p_retailprice_0#3903, cval_part_p_comment#3887 AS cval_part_p_comment_0#3904, cval_part_p_brand#3888 AS cval_part_p_brand_0#3905, cp_name#3889 AS cp_name_0#3906, cp_mfgr#3890 AS cp_mfgr_0#3907, cp_type#3891 AS cp_type_0#3908, cp_size#3892 AS cp_size_0#3909, cp_container#3893 AS cp_container_0#3910, cp_retailprice#3894 AS cp_retailprice_0#3911, cp_comment#3895 AS cp_comment_0#3912, cp_brand#3896 AS cp_brand_0#3913]
            :  :  :        +- Relation[rid#3880,cval_part_p_name#3881,cval_part_p_mfgr#3882,cval_part_p_type#3883,cval_part_p_size#3884,cval_part_p_container#3885,cval_part_p_retailprice#3886,cval_part_p_comment#3887,cval_part_p_brand#3888,cp_name#3889,cp_mfgr#3890,cp_type#3891,cp_size#3892,cp_container#3893,cp_retailprice#3894,cp_comment#3895,cp_brand#3896] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- Project [rid#3970 AS rid_1#3981, cpfk_part_partsupp#3971 AS cpfk_part_partsupp_1#3982, cfpk_partsupp_part#3972 AS cfpk_partsupp_part_1#3983, cpfk_supplier_partsupp#3973 AS cpfk_supplier_partsupp_1#3984, cfpk_partsupp_supplier#3974 AS cfpk_partsupp_supplier_1#3985, cval_partsupp_ps_availqty#3975 AS cval_partsupp_ps_availqty_1#3986, cval_partsupp_ps_supplycost#3976 AS cval_partsupp_ps_supplycost_1#3987, cval_partsupp_ps_comment#3977 AS cval_partsupp_ps_comment_1#3988, cps_availqty#3978 AS cps_availqty_1#3989, cps_supplycost#3979 AS cps_supplycost_1#3990, cps_comment#3980 AS cps_comment_1#3991]
            :  :     +- Relation[rid#3970,cpfk_part_partsupp#3971,cfpk_partsupp_part#3972,cpfk_supplier_partsupp#3973,cfpk_partsupp_supplier#3974,cval_partsupp_ps_availqty#3975,cval_partsupp_ps_supplycost#3976,cval_partsupp_ps_comment#3977,cps_availqty#3978,cps_supplycost#3979,cps_comment#3980] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#3914 AS rid_1#3925, cpfk_part_partsupp#3915 AS cpfk_part_partsupp_1#3926, cfpk_partsupp_part#3916 AS cfpk_partsupp_part_1#3927, cpfk_supplier_partsupp#3917 AS cpfk_supplier_partsupp_1#3928, cfpk_partsupp_supplier#3918 AS cfpk_partsupp_supplier_1#3929, cval_partsupp_ps_availqty#3919 AS cval_partsupp_ps_availqty_1#3930, cval_partsupp_ps_supplycost#3920 AS cval_partsupp_ps_supplycost_1#3931, cval_partsupp_ps_comment#3921 AS cval_partsupp_ps_comment_1#3932, cps_availqty#3922 AS cps_availqty_1#3933, cps_supplycost#3923 AS cps_supplycost_1#3934, cps_comment#3924 AS cps_comment_1#3935]
            :     +- Relation[rid#3914,cpfk_part_partsupp#3915,cfpk_partsupp_part#3916,cpfk_supplier_partsupp#3917,cfpk_partsupp_supplier#3918,cval_partsupp_ps_availqty#3919,cval_partsupp_ps_supplycost#3920,cval_partsupp_ps_comment#3921,cps_availqty#3922,cps_supplycost#3923,cps_comment#3924] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#3992 AS rid_2#3999, cpfk_region_nation#3993 AS cpfk_region_nation_2#4000, cfpk_nation_region#3994 AS cfpk_nation_region_2#4001, cval_nation_n_name#3995 AS cval_nation_n_name_2#4002, cval_nation_n_comment#3996 AS cval_nation_n_comment_2#4003, cn_name#3997 AS cn_name_2#4004, cn_comment#3998 AS cn_comment_2#4005]
               :  :  :  +- Relation[rid#3992,cpfk_region_nation#3993,cfpk_nation_region#3994,cval_nation_n_name#3995,cval_nation_n_comment#3996,cn_name#3997,cn_comment#3998] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#4006 AS rid_2#4013, cpfk_region_nation#4007 AS cpfk_region_nation_2#4014, cfpk_nation_region#4008 AS cfpk_nation_region_2#4015, cval_nation_n_name#4009 AS cval_nation_n_name_2#4016, cval_nation_n_comment#4010 AS cval_nation_n_comment_2#4017, cn_name#4011 AS cn_name_2#4018, cn_comment#4012 AS cn_comment_2#4019]
               :  :        +- Relation[rid#4006,cpfk_region_nation#4007,cfpk_nation_region#4008,cval_nation_n_name#4009,cval_nation_n_comment#4010,cn_name#4011,cn_comment#4012] JDBCRelation(tnation) [numPartitions=1]
               :  +- Project [rid#4060 AS rid_3#4073, cpfk_nation_supplier#4061 AS cpfk_nation_supplier_3#4074, cfpk_supplier_nation#4062 AS cfpk_supplier_nation_3#4075, cval_supplier_s_name#4063 AS cval_supplier_s_name_3#4076, cval_supplier_s_address#4064 AS cval_supplier_s_address_3#4077, cval_supplier_s_phone#4065 AS cval_supplier_s_phone_3#4078, cval_supplier_s_acctbal#4066 AS cval_supplier_s_acctbal_3#4079, cval_supplier_s_comment#4067 AS cval_supplier_s_comment_3#4080, cs_name#4068 AS cs_name_3#4081, cs_address#4069 AS cs_address_3#4082, cs_phone#4070 AS cs_phone_3#4083, cs_acctbal#4071 AS cs_acctbal_3#4084, cs_comment#4072 AS cs_comment_3#4085]
               :     +- Relation[rid#4060,cpfk_nation_supplier#4061,cfpk_supplier_nation#4062,cval_supplier_s_name#4063,cval_supplier_s_address#4064,cval_supplier_s_phone#4065,cval_supplier_s_acctbal#4066,cval_supplier_s_comment#4067,cs_name#4068,cs_address#4069,cs_phone#4070,cs_acctbal#4071,cs_comment#4072] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#4020 AS rid_3#4033, cpfk_nation_supplier#4021 AS cpfk_nation_supplier_3#4034, cfpk_supplier_nation#4022 AS cfpk_supplier_nation_3#4035, cval_supplier_s_name#4023 AS cval_supplier_s_name_3#4036, cval_supplier_s_address#4024 AS cval_supplier_s_address_3#4037, cval_supplier_s_phone#4025 AS cval_supplier_s_phone_3#4038, cval_supplier_s_acctbal#4026 AS cval_supplier_s_acctbal_3#4039, cval_supplier_s_comment#4027 AS cval_supplier_s_comment_3#4040, cs_name#4028 AS cs_name_3#4041, cs_address#4029 AS cs_address_3#4042, cs_phone#4030 AS cs_phone_3#4043, cs_acctbal#4031 AS cs_acctbal_3#4044, cs_comment#4032 AS cs_comment_3#4045]
                  +- Relation[rid#4020,cpfk_nation_supplier#4021,cfpk_supplier_nation#4022,cval_supplier_s_name#4023,cval_supplier_s_address#4024,cval_supplier_s_phone#4025,cval_supplier_s_acctbal#4026,cval_supplier_s_comment#4027,cs_name#4028,cs_address#4029,cs_phone#4030,cs_acctbal#4031,cs_comment#4032] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=326
Elapsed time: 783ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/15 15:59:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:59:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4141L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 15:59:20 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:59:20 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:59:20 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:59:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4141L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#4143 AS rid_0#4160, cval_part_p_name#4144 AS cval_part_p_name_0#4161, cval_part_p_mfgr#4145 AS cval_part_p_mfgr_0#4162, cval_part_p_type#4146 AS cval_part_p_type_0#4163, cval_part_p_size#4147 AS cval_part_p_size_0#4164, cval_part_p_container#4148 AS cval_part_p_container_0#4165, cval_part_p_retailprice#4149 AS cval_part_p_retailprice_0#4166, cval_part_p_comment#4150 AS cval_part_p_comment_0#4167, cval_part_p_brand#4151 AS cval_part_p_brand_0#4168, cp_name#4152 AS cp_name_0#4169, cp_mfgr#4153 AS cp_mfgr_0#4170, cp_type#4154 AS cp_type_0#4171, cp_size#4155 AS cp_size_0#4172, cp_container#4156 AS cp_container_0#4173, cp_retailprice#4157 AS cp_retailprice_0#4174, cp_comment#4158 AS cp_comment_0#4175, cp_brand#4159 AS cp_brand_0#4176]
         :  :  :  +- Relation[rid#4143,cval_part_p_name#4144,cval_part_p_mfgr#4145,cval_part_p_type#4146,cval_part_p_size#4147,cval_part_p_container#4148,cval_part_p_retailprice#4149,cval_part_p_comment#4150,cval_part_p_brand#4151,cp_name#4152,cp_mfgr#4153,cp_type#4154,cp_size#4155,cp_container#4156,cp_retailprice#4157,cp_comment#4158,cp_brand#4159] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#4177 AS rid_0#4194, cval_part_p_name#4178 AS cval_part_p_name_0#4195, cval_part_p_mfgr#4179 AS cval_part_p_mfgr_0#4196, cval_part_p_type#4180 AS cval_part_p_type_0#4197, cval_part_p_size#4181 AS cval_part_p_size_0#4198, cval_part_p_container#4182 AS cval_part_p_container_0#4199, cval_part_p_retailprice#4183 AS cval_part_p_retailprice_0#4200, cval_part_p_comment#4184 AS cval_part_p_comment_0#4201, cval_part_p_brand#4185 AS cval_part_p_brand_0#4202, cp_name#4186 AS cp_name_0#4203, cp_mfgr#4187 AS cp_mfgr_0#4204, cp_type#4188 AS cp_type_0#4205, cp_size#4189 AS cp_size_0#4206, cp_container#4190 AS cp_container_0#4207, cp_retailprice#4191 AS cp_retailprice_0#4208, cp_comment#4192 AS cp_comment_0#4209, cp_brand#4193 AS cp_brand_0#4210]
         :  :        +- Relation[rid#4177,cval_part_p_name#4178,cval_part_p_mfgr#4179,cval_part_p_type#4180,cval_part_p_size#4181,cval_part_p_container#4182,cval_part_p_retailprice#4183,cval_part_p_comment#4184,cval_part_p_brand#4185,cp_name#4186,cp_mfgr#4187,cp_type#4188,cp_size#4189,cp_container#4190,cp_retailprice#4191,cp_comment#4192,cp_brand#4193] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#4267 AS rid_1#4278, cpfk_part_partsupp#4268 AS cpfk_part_partsupp_1#4279, cfpk_partsupp_part#4269 AS cfpk_partsupp_part_1#4280, cpfk_supplier_partsupp#4270 AS cpfk_supplier_partsupp_1#4281, cfpk_partsupp_supplier#4271 AS cfpk_partsupp_supplier_1#4282, cval_partsupp_ps_availqty#4272 AS cval_partsupp_ps_availqty_1#4283, cval_partsupp_ps_supplycost#4273 AS cval_partsupp_ps_supplycost_1#4284, cval_partsupp_ps_comment#4274 AS cval_partsupp_ps_comment_1#4285, cps_availqty#4275 AS cps_availqty_1#4286, cps_supplycost#4276 AS cps_supplycost_1#4287, cps_comment#4277 AS cps_comment_1#4288]
         :     +- Relation[rid#4267,cpfk_part_partsupp#4268,cfpk_partsupp_part#4269,cpfk_supplier_partsupp#4270,cfpk_partsupp_supplier#4271,cval_partsupp_ps_availqty#4272,cval_partsupp_ps_supplycost#4273,cval_partsupp_ps_comment#4274,cps_availqty#4275,cps_supplycost#4276,cps_comment#4277] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#4211 AS rid_1#4222, cpfk_part_partsupp#4212 AS cpfk_part_partsupp_1#4223, cfpk_partsupp_part#4213 AS cfpk_partsupp_part_1#4224, cpfk_supplier_partsupp#4214 AS cpfk_supplier_partsupp_1#4225, cfpk_partsupp_supplier#4215 AS cfpk_partsupp_supplier_1#4226, cval_partsupp_ps_availqty#4216 AS cval_partsupp_ps_availqty_1#4227, cval_partsupp_ps_supplycost#4217 AS cval_partsupp_ps_supplycost_1#4228, cval_partsupp_ps_comment#4218 AS cval_partsupp_ps_comment_1#4229, cps_availqty#4219 AS cps_availqty_1#4230, cps_supplycost#4220 AS cps_supplycost_1#4231, cps_comment#4221 AS cps_comment_1#4232]
            +- Relation[rid#4211,cpfk_part_partsupp#4212,cfpk_partsupp_part#4213,cpfk_supplier_partsupp#4214,cfpk_partsupp_supplier#4215,cval_partsupp_ps_availqty#4216,cval_partsupp_ps_supplycost#4217,cval_partsupp_ps_comment#4218,cps_availqty#4219,cps_supplycost#4220,cps_comment#4221] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=7890
Elapsed time: 2340ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/15 15:59:22 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:59:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4321L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 15:59:22 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:59:22 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:59:22 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:59:22 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:59:22 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:59:22 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:59:22 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 15:59:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4321L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#4323 AS rid_0#4340, cval_part_p_name#4324 AS cval_part_p_name_0#4341, cval_part_p_mfgr#4325 AS cval_part_p_mfgr_0#4342, cval_part_p_type#4326 AS cval_part_p_type_0#4343, cval_part_p_size#4327 AS cval_part_p_size_0#4344, cval_part_p_container#4328 AS cval_part_p_container_0#4345, cval_part_p_retailprice#4329 AS cval_part_p_retailprice_0#4346, cval_part_p_comment#4330 AS cval_part_p_comment_0#4347, cval_part_p_brand#4331 AS cval_part_p_brand_0#4348, cp_name#4332 AS cp_name_0#4349, cp_mfgr#4333 AS cp_mfgr_0#4350, cp_type#4334 AS cp_type_0#4351, cp_size#4335 AS cp_size_0#4352, cp_container#4336 AS cp_container_0#4353, cp_retailprice#4337 AS cp_retailprice_0#4354, cp_comment#4338 AS cp_comment_0#4355, cp_brand#4339 AS cp_brand_0#4356]
         :  :  :  :  +- Relation[rid#4323,cval_part_p_name#4324,cval_part_p_mfgr#4325,cval_part_p_type#4326,cval_part_p_size#4327,cval_part_p_container#4328,cval_part_p_retailprice#4329,cval_part_p_comment#4330,cval_part_p_brand#4331,cp_name#4332,cp_mfgr#4333,cp_type#4334,cp_size#4335,cp_container#4336,cp_retailprice#4337,cp_comment#4338,cp_brand#4339] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#4357 AS rid_0#4374, cval_part_p_name#4358 AS cval_part_p_name_0#4375, cval_part_p_mfgr#4359 AS cval_part_p_mfgr_0#4376, cval_part_p_type#4360 AS cval_part_p_type_0#4377, cval_part_p_size#4361 AS cval_part_p_size_0#4378, cval_part_p_container#4362 AS cval_part_p_container_0#4379, cval_part_p_retailprice#4363 AS cval_part_p_retailprice_0#4380, cval_part_p_comment#4364 AS cval_part_p_comment_0#4381, cval_part_p_brand#4365 AS cval_part_p_brand_0#4382, cp_name#4366 AS cp_name_0#4383, cp_mfgr#4367 AS cp_mfgr_0#4384, cp_type#4368 AS cp_type_0#4385, cp_size#4369 AS cp_size_0#4386, cp_container#4370 AS cp_container_0#4387, cp_retailprice#4371 AS cp_retailprice_0#4388, cp_comment#4372 AS cp_comment_0#4389, cp_brand#4373 AS cp_brand_0#4390]
         :  :  :        +- Relation[rid#4357,cval_part_p_name#4358,cval_part_p_mfgr#4359,cval_part_p_type#4360,cval_part_p_size#4361,cval_part_p_container#4362,cval_part_p_retailprice#4363,cval_part_p_comment#4364,cval_part_p_brand#4365,cp_name#4366,cp_mfgr#4367,cp_type#4368,cp_size#4369,cp_container#4370,cp_retailprice#4371,cp_comment#4372,cp_brand#4373] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#4391 AS rid_0#4408, cval_part_p_name#4392 AS cval_part_p_name_0#4409, cval_part_p_mfgr#4393 AS cval_part_p_mfgr_0#4410, cval_part_p_type#4394 AS cval_part_p_type_0#4411, cval_part_p_size#4395 AS cval_part_p_size_0#4412, cval_part_p_container#4396 AS cval_part_p_container_0#4413, cval_part_p_retailprice#4397 AS cval_part_p_retailprice_0#4414, cval_part_p_comment#4398 AS cval_part_p_comment_0#4415, cval_part_p_brand#4399 AS cval_part_p_brand_0#4416, cp_name#4400 AS cp_name_0#4417, cp_mfgr#4401 AS cp_mfgr_0#4418, cp_type#4402 AS cp_type_0#4419, cp_size#4403 AS cp_size_0#4420, cp_container#4404 AS cp_container_0#4421, cp_retailprice#4405 AS cp_retailprice_0#4422, cp_comment#4406 AS cp_comment_0#4423, cp_brand#4407 AS cp_brand_0#4424]
         :  :        +- Relation[rid#4391,cval_part_p_name#4392,cval_part_p_mfgr#4393,cval_part_p_type#4394,cval_part_p_size#4395,cval_part_p_container#4396,cval_part_p_retailprice#4397,cval_part_p_comment#4398,cval_part_p_brand#4399,cp_name#4400,cp_mfgr#4401,cp_type#4402,cp_size#4403,cp_container#4404,cp_retailprice#4405,cp_comment#4406,cp_brand#4407] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#4525 AS rid_1#4558, cpfk_orders_lineitem#4526 AS cpfk_orders_lineitem_1#4559, cpfk_supplier_lineitem#4527 AS cpfk_supplier_lineitem_1#4560, cfpk_lineitem_supplier#4528 AS cfpk_lineitem_supplier_1#4561, cfpk_lineitem_partsupp#4529 AS cfpk_lineitem_partsupp_1#4562, cpfk_part_lineitem#4530 AS cpfk_part_lineitem_1#4563, cfpk_lineitem_part#4531 AS cfpk_lineitem_part_1#4564, cpfk_partsupp_lineitem#4532 AS cpfk_partsupp_lineitem_1#4565, cfpk_lineitem_orders#4533 AS cfpk_lineitem_orders_1#4566, cval_lineitem_l_quantity#4534 AS cval_lineitem_l_quantity_1#4567, cval_lineitem_l_extendedprice#4535 AS cval_lineitem_l_extendedprice_1#4568, cval_lineitem_l_discount#4536 AS cval_lineitem_l_discount_1#4569, cval_lineitem_l_tax#4537 AS cval_lineitem_l_tax_1#4570, cval_lineitem_l_returnflag#4538 AS cval_lineitem_l_returnflag_1#4571, cval_lineitem_l_linestatus#4539 AS cval_lineitem_l_linestatus_1#4572, cval_lineitem_l_commitdate#4540 AS cval_lineitem_l_commitdate_1#4573, cval_lineitem_l_receiptdate#4541 AS cval_lineitem_l_receiptdate_1#4574, cval_lineitem_l_shipinstruct#4542 AS cval_lineitem_l_shipinstruct_1#4575, cval_lineitem_l_shipmode#4543 AS cval_lineitem_l_shipmode_1#4576, cval_lineitem_l_comment#4544 AS cval_lineitem_l_comment_1#4577, cval_lineitem_l_shipdate#4545 AS cval_lineitem_l_shipdate_1#4578, cl_quantity#4546 AS cl_quantity_1#4579, cl_extendedprice#4547 AS cl_extendedprice_1#4580, cl_discount#4548 AS cl_discount_1#4581, ... 9 more fields]
         :     +- Relation[rid#4525,cpfk_orders_lineitem#4526,cpfk_supplier_lineitem#4527,cfpk_lineitem_supplier#4528,cfpk_lineitem_partsupp#4529,cpfk_part_lineitem#4530,cfpk_lineitem_part#4531,cpfk_partsupp_lineitem#4532,cfpk_lineitem_orders#4533,cval_lineitem_l_quantity#4534,cval_lineitem_l_extendedprice#4535,cval_lineitem_l_discount#4536,cval_lineitem_l_tax#4537,cval_lineitem_l_returnflag#4538,cval_lineitem_l_linestatus#4539,cval_lineitem_l_commitdate#4540,cval_lineitem_l_receiptdate#4541,cval_lineitem_l_shipinstruct#4542,cval_lineitem_l_shipmode#4543,cval_lineitem_l_comment#4544,cval_lineitem_l_shipdate#4545,cl_quantity#4546,cl_extendedprice#4547,cl_discount#4548,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4425 AS rid_1#4458, cpfk_orders_lineitem#4426 AS cpfk_orders_lineitem_1#4459, cpfk_supplier_lineitem#4427 AS cpfk_supplier_lineitem_1#4460, cfpk_lineitem_supplier#4428 AS cfpk_lineitem_supplier_1#4461, cfpk_lineitem_partsupp#4429 AS cfpk_lineitem_partsupp_1#4462, cpfk_part_lineitem#4430 AS cpfk_part_lineitem_1#4463, cfpk_lineitem_part#4431 AS cfpk_lineitem_part_1#4464, cpfk_partsupp_lineitem#4432 AS cpfk_partsupp_lineitem_1#4465, cfpk_lineitem_orders#4433 AS cfpk_lineitem_orders_1#4466, cval_lineitem_l_quantity#4434 AS cval_lineitem_l_quantity_1#4467, cval_lineitem_l_extendedprice#4435 AS cval_lineitem_l_extendedprice_1#4468, cval_lineitem_l_discount#4436 AS cval_lineitem_l_discount_1#4469, cval_lineitem_l_tax#4437 AS cval_lineitem_l_tax_1#4470, cval_lineitem_l_returnflag#4438 AS cval_lineitem_l_returnflag_1#4471, cval_lineitem_l_linestatus#4439 AS cval_lineitem_l_linestatus_1#4472, cval_lineitem_l_commitdate#4440 AS cval_lineitem_l_commitdate_1#4473, cval_lineitem_l_receiptdate#4441 AS cval_lineitem_l_receiptdate_1#4474, cval_lineitem_l_shipinstruct#4442 AS cval_lineitem_l_shipinstruct_1#4475, cval_lineitem_l_shipmode#4443 AS cval_lineitem_l_shipmode_1#4476, cval_lineitem_l_comment#4444 AS cval_lineitem_l_comment_1#4477, cval_lineitem_l_shipdate#4445 AS cval_lineitem_l_shipdate_1#4478, cl_quantity#4446 AS cl_quantity_1#4479, cl_extendedprice#4447 AS cl_extendedprice_1#4480, cl_discount#4448 AS cl_discount_1#4481, ... 9 more fields]
            +- Relation[rid#4425,cpfk_orders_lineitem#4426,cpfk_supplier_lineitem#4427,cfpk_lineitem_supplier#4428,cfpk_lineitem_partsupp#4429,cpfk_part_lineitem#4430,cfpk_lineitem_part#4431,cpfk_partsupp_lineitem#4432,cfpk_lineitem_orders#4433,cval_lineitem_l_quantity#4434,cval_lineitem_l_extendedprice#4435,cval_lineitem_l_discount#4436,cval_lineitem_l_tax#4437,cval_lineitem_l_returnflag#4438,cval_lineitem_l_linestatus#4439,cval_lineitem_l_commitdate#4440,cval_lineitem_l_receiptdate#4441,cval_lineitem_l_shipinstruct#4442,cval_lineitem_l_shipmode#4443,cval_lineitem_l_comment#4444,cval_lineitem_l_shipdate#4445,cl_quantity#4446,cl_extendedprice#4447,cl_discount#4448,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=408
Elapsed time: 3133ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/15 15:59:25 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:59:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4647L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 15:59:25 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:59:25 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:59:25 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:59:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:59:25 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:59:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:59:25 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 15:59:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:59:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:59:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:59:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:59:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:59:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:59:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:59:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:59:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:59:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4647L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#4649 AS rid_0#4654, cval_region_r_name#4650 AS cval_region_r_name_0#4655, cval_region_r_comment#4651 AS cval_region_r_comment_0#4656, cr_name#4652 AS cr_name_0#4657, cr_comment#4653 AS cr_comment_0#4658]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#4649,cval_region_r_name#4650,cval_region_r_comment#4651,cr_name#4652,cr_comment#4653] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#4659 AS rid_0#4664, cval_region_r_name#4660 AS cval_region_r_name_0#4665, cval_region_r_comment#4661 AS cval_region_r_comment_0#4666, cr_name#4662 AS cr_name_0#4667, cr_comment#4663 AS cr_comment_0#4668]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#4659,cval_region_r_name#4660,cval_region_r_comment#4661,cr_name#4662,cr_comment#4663] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- Project [rid#4693 AS rid_1#4700, cpfk_region_nation#4694 AS cpfk_region_nation_1#4701, cfpk_nation_region#4695 AS cfpk_nation_region_1#4702, cval_nation_n_name#4696 AS cval_nation_n_name_1#4703, cval_nation_n_comment#4697 AS cval_nation_n_comment_1#4704, cn_name#4698 AS cn_name_1#4705, cn_comment#4699 AS cn_comment_1#4706]
         :     :  :  :  :  :  :  :  :     +- Relation[rid#4693,cpfk_region_nation#4694,cfpk_nation_region#4695,cval_nation_n_name#4696,cval_nation_n_comment#4697,cn_name#4698,cn_comment#4699] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#4669 AS rid_1#4676, cpfk_region_nation#4670 AS cpfk_region_nation_1#4677, cfpk_nation_region#4671 AS cfpk_nation_region_1#4678, cval_nation_n_name#4672 AS cval_nation_n_name_1#4679, cval_nation_n_comment#4673 AS cval_nation_n_comment_1#4680, cn_name#4674 AS cn_name_1#4681, cn_comment#4675 AS cn_comment_1#4682]
         :     :  :  :  :  :  :  :     +- Relation[rid#4669,cpfk_region_nation#4670,cfpk_nation_region#4671,cval_nation_n_name#4672,cval_nation_n_comment#4673,cn_name#4674,cn_comment#4675] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- Project [rid#4751 AS rid_2#4766, cpfk_nation_customer#4752 AS cpfk_nation_customer_2#4767, cfpk_customer_nation#4753 AS cfpk_customer_nation_2#4768, cval_customer_c_name#4754 AS cval_customer_c_name_2#4769, cval_customer_c_address#4755 AS cval_customer_c_address_2#4770, cval_customer_c_phone#4756 AS cval_customer_c_phone_2#4771, cval_customer_c_acctbal#4757 AS cval_customer_c_acctbal_2#4772, cval_customer_c_comment#4758 AS cval_customer_c_comment_2#4773, cval_customer_c_mktsegment#4759 AS cval_customer_c_mktsegment_2#4774, cc_name#4760 AS cc_name_2#4775, cc_address#4761 AS cc_address_2#4776, cc_phone#4762 AS cc_phone_2#4777, cc_acctbal#4763 AS cc_acctbal_2#4778, cc_comment#4764 AS cc_comment_2#4779, cc_mktsegment#4765 AS cc_mktsegment_2#4780]
         :     :  :  :  :  :  :     +- Relation[rid#4751,cpfk_nation_customer#4752,cfpk_customer_nation#4753,cval_customer_c_name#4754,cval_customer_c_address#4755,cval_customer_c_phone#4756,cval_customer_c_acctbal#4757,cval_customer_c_comment#4758,cval_customer_c_mktsegment#4759,cc_name#4760,cc_address#4761,cc_phone#4762,cc_acctbal#4763,cc_comment#4764,cc_mktsegment#4765] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#4707 AS rid_2#4722, cpfk_nation_customer#4708 AS cpfk_nation_customer_2#4723, cfpk_customer_nation#4709 AS cfpk_customer_nation_2#4724, cval_customer_c_name#4710 AS cval_customer_c_name_2#4725, cval_customer_c_address#4711 AS cval_customer_c_address_2#4726, cval_customer_c_phone#4712 AS cval_customer_c_phone_2#4727, cval_customer_c_acctbal#4713 AS cval_customer_c_acctbal_2#4728, cval_customer_c_comment#4714 AS cval_customer_c_comment_2#4729, cval_customer_c_mktsegment#4715 AS cval_customer_c_mktsegment_2#4730, cc_name#4716 AS cc_name_2#4731, cc_address#4717 AS cc_address_2#4732, cc_phone#4718 AS cc_phone_2#4733, cc_acctbal#4719 AS cc_acctbal_2#4734, cc_comment#4720 AS cc_comment_2#4735, cc_mktsegment#4721 AS cc_mktsegment_2#4736]
         :     :  :  :  :  :     +- Relation[rid#4707,cpfk_nation_customer#4708,cfpk_customer_nation#4709,cval_customer_c_name#4710,cval_customer_c_address#4711,cval_customer_c_phone#4712,cval_customer_c_acctbal#4713,cval_customer_c_comment#4714,cval_customer_c_mktsegment#4715,cc_name#4716,cc_address#4717,cc_phone#4718,cc_acctbal#4719,cc_comment#4720,cc_mktsegment#4721] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- Project [rid#4845 AS rid_3#4862, cpfk_customer_orders#4846 AS cpfk_customer_orders_3#4863, cfpk_orders_customer#4847 AS cfpk_orders_customer_3#4864, cval_orders_o_orderstatus#4848 AS cval_orders_o_orderstatus_3#4865, cval_orders_o_totalprice#4849 AS cval_orders_o_totalprice_3#4866, cval_orders_o_orderpriority#4850 AS cval_orders_o_orderpriority_3#4867, cval_orders_o_clerk#4851 AS cval_orders_o_clerk_3#4868, cval_orders_o_shippriority#4852 AS cval_orders_o_shippriority_3#4869, cval_orders_o_comment#4853 AS cval_orders_o_comment_3#4870, cval_orders_o_orderdate#4854 AS cval_orders_o_orderdate_3#4871, co_orderstatus#4855 AS co_orderstatus_3#4872, co_totalprice#4856 AS co_totalprice_3#4873, co_orderpriority#4857 AS co_orderpriority_3#4874, co_clerk#4858 AS co_clerk_3#4875, co_shippriority#4859 AS co_shippriority_3#4876, co_comment#4860 AS co_comment_3#4877, co_orderdate#4861 AS co_orderdate_3#4878]
         :     :  :  :  :     +- Relation[rid#4845,cpfk_customer_orders#4846,cfpk_orders_customer#4847,cval_orders_o_orderstatus#4848,cval_orders_o_totalprice#4849,cval_orders_o_orderpriority#4850,cval_orders_o_clerk#4851,cval_orders_o_shippriority#4852,cval_orders_o_comment#4853,cval_orders_o_orderdate#4854,co_orderstatus#4855,co_totalprice#4856,co_orderpriority#4857,co_clerk#4858,co_shippriority#4859,co_comment#4860,co_orderdate#4861] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#4781 AS rid_3#4798, cpfk_customer_orders#4782 AS cpfk_customer_orders_3#4799, cfpk_orders_customer#4783 AS cfpk_orders_customer_3#4800, cval_orders_o_orderstatus#4784 AS cval_orders_o_orderstatus_3#4801, cval_orders_o_totalprice#4785 AS cval_orders_o_totalprice_3#4802, cval_orders_o_orderpriority#4786 AS cval_orders_o_orderpriority_3#4803, cval_orders_o_clerk#4787 AS cval_orders_o_clerk_3#4804, cval_orders_o_shippriority#4788 AS cval_orders_o_shippriority_3#4805, cval_orders_o_comment#4789 AS cval_orders_o_comment_3#4806, cval_orders_o_orderdate#4790 AS cval_orders_o_orderdate_3#4807, co_orderstatus#4791 AS co_orderstatus_3#4808, co_totalprice#4792 AS co_totalprice_3#4809, co_orderpriority#4793 AS co_orderpriority_3#4810, co_clerk#4794 AS co_clerk_3#4811, co_shippriority#4795 AS co_shippriority_3#4812, co_comment#4796 AS co_comment_3#4813, co_orderdate#4797 AS co_orderdate_3#4814]
         :     :  :  :     +- Relation[rid#4781,cpfk_customer_orders#4782,cfpk_orders_customer#4783,cval_orders_o_orderstatus#4784,cval_orders_o_totalprice#4785,cval_orders_o_orderpriority#4786,cval_orders_o_clerk#4787,cval_orders_o_shippriority#4788,cval_orders_o_comment#4789,cval_orders_o_orderdate#4790,co_orderstatus#4791,co_totalprice#4792,co_orderpriority#4793,co_clerk#4794,co_shippriority#4795,co_comment#4796,co_orderdate#4797] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- Project [rid#4979 AS rid_4#5012, cpfk_orders_lineitem#4980 AS cpfk_orders_lineitem_4#5013, cpfk_supplier_lineitem#4981 AS cpfk_supplier_lineitem_4#5014, cfpk_lineitem_supplier#4982 AS cfpk_lineitem_supplier_4#5015, cfpk_lineitem_partsupp#4983 AS cfpk_lineitem_partsupp_4#5016, cpfk_part_lineitem#4984 AS cpfk_part_lineitem_4#5017, cfpk_lineitem_part#4985 AS cfpk_lineitem_part_4#5018, cpfk_partsupp_lineitem#4986 AS cpfk_partsupp_lineitem_4#5019, cfpk_lineitem_orders#4987 AS cfpk_lineitem_orders_4#5020, cval_lineitem_l_quantity#4988 AS cval_lineitem_l_quantity_4#5021, cval_lineitem_l_extendedprice#4989 AS cval_lineitem_l_extendedprice_4#5022, cval_lineitem_l_discount#4990 AS cval_lineitem_l_discount_4#5023, cval_lineitem_l_tax#4991 AS cval_lineitem_l_tax_4#5024, cval_lineitem_l_returnflag#4992 AS cval_lineitem_l_returnflag_4#5025, cval_lineitem_l_linestatus#4993 AS cval_lineitem_l_linestatus_4#5026, cval_lineitem_l_commitdate#4994 AS cval_lineitem_l_commitdate_4#5027, cval_lineitem_l_receiptdate#4995 AS cval_lineitem_l_receiptdate_4#5028, cval_lineitem_l_shipinstruct#4996 AS cval_lineitem_l_shipinstruct_4#5029, cval_lineitem_l_shipmode#4997 AS cval_lineitem_l_shipmode_4#5030, cval_lineitem_l_comment#4998 AS cval_lineitem_l_comment_4#5031, cval_lineitem_l_shipdate#4999 AS cval_lineitem_l_shipdate_4#5032, cl_quantity#5000 AS cl_quantity_4#5033, cl_extendedprice#5001 AS cl_extendedprice_4#5034, cl_discount#5002 AS cl_discount_4#5035, ... 9 more fields]
         :     :  :     +- Relation[rid#4979,cpfk_orders_lineitem#4980,cpfk_supplier_lineitem#4981,cfpk_lineitem_supplier#4982,cfpk_lineitem_partsupp#4983,cpfk_part_lineitem#4984,cfpk_lineitem_part#4985,cpfk_partsupp_lineitem#4986,cfpk_lineitem_orders#4987,cval_lineitem_l_quantity#4988,cval_lineitem_l_extendedprice#4989,cval_lineitem_l_discount#4990,cval_lineitem_l_tax#4991,cval_lineitem_l_returnflag#4992,cval_lineitem_l_linestatus#4993,cval_lineitem_l_commitdate#4994,cval_lineitem_l_receiptdate#4995,cval_lineitem_l_shipinstruct#4996,cval_lineitem_l_shipmode#4997,cval_lineitem_l_comment#4998,cval_lineitem_l_shipdate#4999,cl_quantity#5000,cl_extendedprice#5001,cl_discount#5002,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#4879 AS rid_4#4912, cpfk_orders_lineitem#4880 AS cpfk_orders_lineitem_4#4913, cpfk_supplier_lineitem#4881 AS cpfk_supplier_lineitem_4#4914, cfpk_lineitem_supplier#4882 AS cfpk_lineitem_supplier_4#4915, cfpk_lineitem_partsupp#4883 AS cfpk_lineitem_partsupp_4#4916, cpfk_part_lineitem#4884 AS cpfk_part_lineitem_4#4917, cfpk_lineitem_part#4885 AS cfpk_lineitem_part_4#4918, cpfk_partsupp_lineitem#4886 AS cpfk_partsupp_lineitem_4#4919, cfpk_lineitem_orders#4887 AS cfpk_lineitem_orders_4#4920, cval_lineitem_l_quantity#4888 AS cval_lineitem_l_quantity_4#4921, cval_lineitem_l_extendedprice#4889 AS cval_lineitem_l_extendedprice_4#4922, cval_lineitem_l_discount#4890 AS cval_lineitem_l_discount_4#4923, cval_lineitem_l_tax#4891 AS cval_lineitem_l_tax_4#4924, cval_lineitem_l_returnflag#4892 AS cval_lineitem_l_returnflag_4#4925, cval_lineitem_l_linestatus#4893 AS cval_lineitem_l_linestatus_4#4926, cval_lineitem_l_commitdate#4894 AS cval_lineitem_l_commitdate_4#4927, cval_lineitem_l_receiptdate#4895 AS cval_lineitem_l_receiptdate_4#4928, cval_lineitem_l_shipinstruct#4896 AS cval_lineitem_l_shipinstruct_4#4929, cval_lineitem_l_shipmode#4897 AS cval_lineitem_l_shipmode_4#4930, cval_lineitem_l_comment#4898 AS cval_lineitem_l_comment_4#4931, cval_lineitem_l_shipdate#4899 AS cval_lineitem_l_shipdate_4#4932, cl_quantity#4900 AS cl_quantity_4#4933, cl_extendedprice#4901 AS cl_extendedprice_4#4934, cl_discount#4902 AS cl_discount_4#4935, ... 9 more fields]
         :     :     +- Relation[rid#4879,cpfk_orders_lineitem#4880,cpfk_supplier_lineitem#4881,cfpk_lineitem_supplier#4882,cfpk_lineitem_partsupp#4883,cpfk_part_lineitem#4884,cfpk_lineitem_part#4885,cpfk_partsupp_lineitem#4886,cfpk_lineitem_orders#4887,cval_lineitem_l_quantity#4888,cval_lineitem_l_extendedprice#4889,cval_lineitem_l_discount#4890,cval_lineitem_l_tax#4891,cval_lineitem_l_returnflag#4892,cval_lineitem_l_linestatus#4893,cval_lineitem_l_commitdate#4894,cval_lineitem_l_receiptdate#4895,cval_lineitem_l_shipinstruct#4896,cval_lineitem_l_shipmode#4897,cval_lineitem_l_comment#4898,cval_lineitem_l_shipdate#4899,cl_quantity#4900,cl_extendedprice#4901,cl_discount#4902,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#5045 AS rid_5#5058, cpfk_nation_supplier#5046 AS cpfk_nation_supplier_5#5059, cfpk_supplier_nation#5047 AS cfpk_supplier_nation_5#5060, cval_supplier_s_name#5048 AS cval_supplier_s_name_5#5061, cval_supplier_s_address#5049 AS cval_supplier_s_address_5#5062, cval_supplier_s_phone#5050 AS cval_supplier_s_phone_5#5063, cval_supplier_s_acctbal#5051 AS cval_supplier_s_acctbal_5#5064, cval_supplier_s_comment#5052 AS cval_supplier_s_comment_5#5065, cs_name#5053 AS cs_name_5#5066, cs_address#5054 AS cs_address_5#5067, cs_phone#5055 AS cs_phone_5#5068, cs_acctbal#5056 AS cs_acctbal_5#5069, cs_comment#5057 AS cs_comment_5#5070]
         :        +- Relation[rid#5045,cpfk_nation_supplier#5046,cfpk_supplier_nation#5047,cval_supplier_s_name#5048,cval_supplier_s_address#5049,cval_supplier_s_phone#5050,cval_supplier_s_acctbal#5051,cval_supplier_s_comment#5052,cs_name#5053,cs_address#5054,cs_phone#5055,cs_acctbal#5056,cs_comment#5057] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#5071 AS rid_1#5078, cpfk_region_nation#5072 AS cpfk_region_nation_1#5079, cfpk_nation_region#5073 AS cfpk_nation_region_1#5080, cval_nation_n_name#5074 AS cval_nation_n_name_1#5081, cval_nation_n_comment#5075 AS cval_nation_n_comment_1#5082, cn_name#5076 AS cn_name_1#5083, cn_comment#5077 AS cn_comment_1#5084]
            :  +- Relation[rid#5071,cpfk_region_nation#5072,cfpk_nation_region#5073,cval_nation_n_name#5074,cval_nation_n_comment#5075,cn_name#5076,cn_comment#5077] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#5085 AS rid_5#5098, cpfk_nation_supplier#5086 AS cpfk_nation_supplier_5#5099, cfpk_supplier_nation#5087 AS cfpk_supplier_nation_5#5100, cval_supplier_s_name#5088 AS cval_supplier_s_name_5#5101, cval_supplier_s_address#5089 AS cval_supplier_s_address_5#5102, cval_supplier_s_phone#5090 AS cval_supplier_s_phone_5#5103, cval_supplier_s_acctbal#5091 AS cval_supplier_s_acctbal_5#5104, cval_supplier_s_comment#5092 AS cval_supplier_s_comment_5#5105, cs_name#5093 AS cs_name_5#5106, cs_address#5094 AS cs_address_5#5107, cs_phone#5095 AS cs_phone_5#5108, cs_acctbal#5096 AS cs_acctbal_5#5109, cs_comment#5097 AS cs_comment_5#5110]
               +- Relation[rid#5085,cpfk_nation_supplier#5086,cfpk_supplier_nation#5087,cval_supplier_s_name#5088,cval_supplier_s_address#5089,cval_supplier_s_phone#5090,cval_supplier_s_acctbal#5091,cval_supplier_s_comment#5092,cs_name#5093,cs_address#5094,cs_phone#5095,cs_acctbal#5096,cs_comment#5097] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=16077
Elapsed time: 27426ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 15:59:53 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 15:59:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5210L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 15:59:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:59:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:59:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:59:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:59:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 15:59:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:59:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:59:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:59:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:59:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 15:59:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:59:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:59:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:59:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:59:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:59:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 15:59:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5210L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#5212 AS rid_0#5219, cpfk_region_nation#5213 AS cpfk_region_nation_0#5220, cfpk_nation_region#5214 AS cfpk_nation_region_0#5221, cval_nation_n_name#5215 AS cval_nation_n_name_0#5222, cval_nation_n_comment#5216 AS cval_nation_n_comment_0#5223, cn_name#5217 AS cn_name_0#5224, cn_comment#5218 AS cn_comment_0#5225]
            :  :  :     :  :  :  :  :  +- Relation[rid#5212,cpfk_region_nation#5213,cfpk_nation_region#5214,cval_nation_n_name#5215,cval_nation_n_comment#5216,cn_name#5217,cn_comment#5218] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#5252 AS rid_0#5259, cpfk_region_nation#5253 AS cpfk_region_nation_0#5260, cfpk_nation_region#5254 AS cfpk_nation_region_0#5261, cval_nation_n_name#5255 AS cval_nation_n_name_0#5262, cval_nation_n_comment#5256 AS cval_nation_n_comment_0#5263, cn_name#5257 AS cn_name_0#5264, cn_comment#5258 AS cn_comment_0#5265]
            :  :  :     :  :  :  :     :  +- Relation[rid#5252,cpfk_region_nation#5253,cfpk_nation_region#5254,cval_nation_n_name#5255,cval_nation_n_comment#5256,cn_name#5257,cn_comment#5258] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#5266 AS rid_1#5279, cpfk_nation_supplier#5267 AS cpfk_nation_supplier_1#5280, cfpk_supplier_nation#5268 AS cfpk_supplier_nation_1#5281, cval_supplier_s_name#5269 AS cval_supplier_s_name_1#5282, cval_supplier_s_address#5270 AS cval_supplier_s_address_1#5283, cval_supplier_s_phone#5271 AS cval_supplier_s_phone_1#5284, cval_supplier_s_acctbal#5272 AS cval_supplier_s_acctbal_1#5285, cval_supplier_s_comment#5273 AS cval_supplier_s_comment_1#5286, cs_name#5274 AS cs_name_1#5287, cs_address#5275 AS cs_address_1#5288, cs_phone#5276 AS cs_phone_1#5289, cs_acctbal#5277 AS cs_acctbal_1#5290, cs_comment#5278 AS cs_comment_1#5291]
            :  :  :     :  :  :  :        +- Relation[rid#5266,cpfk_nation_supplier#5267,cfpk_supplier_nation#5268,cval_supplier_s_name#5269,cval_supplier_s_address#5270,cval_supplier_s_phone#5271,cval_supplier_s_acctbal#5272,cval_supplier_s_comment#5273,cs_name#5274,cs_address#5275,cs_phone#5276,cs_acctbal#5277,cs_comment#5278] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#5226 AS rid_1#5239, cpfk_nation_supplier#5227 AS cpfk_nation_supplier_1#5240, cfpk_supplier_nation#5228 AS cfpk_supplier_nation_1#5241, cval_supplier_s_name#5229 AS cval_supplier_s_name_1#5242, cval_supplier_s_address#5230 AS cval_supplier_s_address_1#5243, cval_supplier_s_phone#5231 AS cval_supplier_s_phone_1#5244, cval_supplier_s_acctbal#5232 AS cval_supplier_s_acctbal_1#5245, cval_supplier_s_comment#5233 AS cval_supplier_s_comment_1#5246, cs_name#5234 AS cs_name_1#5247, cs_address#5235 AS cs_address_1#5248, cs_phone#5236 AS cs_phone_1#5249, cs_acctbal#5237 AS cs_acctbal_1#5250, cs_comment#5238 AS cs_comment_1#5251]
            :  :  :     :  :  :     +- Relation[rid#5226,cpfk_nation_supplier#5227,cfpk_supplier_nation#5228,cval_supplier_s_name#5229,cval_supplier_s_address#5230,cval_supplier_s_phone#5231,cval_supplier_s_acctbal#5232,cval_supplier_s_comment#5233,cs_name#5234,cs_address#5235,cs_phone#5236,cs_acctbal#5237,cs_comment#5238] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#5314 AS rid_1#5327, cpfk_nation_supplier#5315 AS cpfk_nation_supplier_1#5328, cfpk_supplier_nation#5316 AS cfpk_supplier_nation_1#5329, cval_supplier_s_name#5317 AS cval_supplier_s_name_1#5330, cval_supplier_s_address#5318 AS cval_supplier_s_address_1#5331, cval_supplier_s_phone#5319 AS cval_supplier_s_phone_1#5332, cval_supplier_s_acctbal#5320 AS cval_supplier_s_acctbal_1#5333, cval_supplier_s_comment#5321 AS cval_supplier_s_comment_1#5334, cs_name#5322 AS cs_name_1#5335, cs_address#5323 AS cs_address_1#5336, cs_phone#5324 AS cs_phone_1#5337, cs_acctbal#5325 AS cs_acctbal_1#5338, cs_comment#5326 AS cs_comment_1#5339]
            :  :  :     :  :     :  +- Relation[rid#5314,cpfk_nation_supplier#5315,cfpk_supplier_nation#5316,cval_supplier_s_name#5317,cval_supplier_s_address#5318,cval_supplier_s_phone#5319,cval_supplier_s_acctbal#5320,cval_supplier_s_comment#5321,cs_name#5322,cs_address#5323,cs_phone#5324,cs_acctbal#5325,cs_comment#5326] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#5340 AS rid_2#5351, cpfk_part_partsupp#5341 AS cpfk_part_partsupp_2#5352, cfpk_partsupp_part#5342 AS cfpk_partsupp_part_2#5353, cpfk_supplier_partsupp#5343 AS cpfk_supplier_partsupp_2#5354, cfpk_partsupp_supplier#5344 AS cfpk_partsupp_supplier_2#5355, cval_partsupp_ps_availqty#5345 AS cval_partsupp_ps_availqty_2#5356, cval_partsupp_ps_supplycost#5346 AS cval_partsupp_ps_supplycost_2#5357, cval_partsupp_ps_comment#5347 AS cval_partsupp_ps_comment_2#5358, cps_availqty#5348 AS cps_availqty_2#5359, cps_supplycost#5349 AS cps_supplycost_2#5360, cps_comment#5350 AS cps_comment_2#5361]
            :  :  :     :  :        +- Relation[rid#5340,cpfk_part_partsupp#5341,cfpk_partsupp_part#5342,cpfk_supplier_partsupp#5343,cfpk_partsupp_supplier#5344,cval_partsupp_ps_availqty#5345,cval_partsupp_ps_supplycost#5346,cval_partsupp_ps_comment#5347,cps_availqty#5348,cps_supplycost#5349,cps_comment#5350] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#5292 AS rid_2#5303, cpfk_part_partsupp#5293 AS cpfk_part_partsupp_2#5304, cfpk_partsupp_part#5294 AS cfpk_partsupp_part_2#5305, cpfk_supplier_partsupp#5295 AS cpfk_supplier_partsupp_2#5306, cfpk_partsupp_supplier#5296 AS cfpk_partsupp_supplier_2#5307, cval_partsupp_ps_availqty#5297 AS cval_partsupp_ps_availqty_2#5308, cval_partsupp_ps_supplycost#5298 AS cval_partsupp_ps_supplycost_2#5309, cval_partsupp_ps_comment#5299 AS cval_partsupp_ps_comment_2#5310, cps_availqty#5300 AS cps_availqty_2#5311, cps_supplycost#5301 AS cps_supplycost_2#5312, cps_comment#5302 AS cps_comment_2#5313]
            :  :  :     :     +- Relation[rid#5292,cpfk_part_partsupp#5293,cfpk_partsupp_part#5294,cpfk_supplier_partsupp#5295,cfpk_partsupp_supplier#5296,cval_partsupp_ps_availqty#5297,cval_partsupp_ps_supplycost#5298,cval_partsupp_ps_comment#5299,cps_availqty#5300,cps_supplycost#5301,cps_comment#5302] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#5362 AS rid_3#5379, cval_part_p_name#5363 AS cval_part_p_name_3#5380, cval_part_p_mfgr#5364 AS cval_part_p_mfgr_3#5381, cval_part_p_type#5365 AS cval_part_p_type_3#5382, cval_part_p_size#5366 AS cval_part_p_size_3#5383, cval_part_p_container#5367 AS cval_part_p_container_3#5384, cval_part_p_retailprice#5368 AS cval_part_p_retailprice_3#5385, cval_part_p_comment#5369 AS cval_part_p_comment_3#5386, cval_part_p_brand#5370 AS cval_part_p_brand_3#5387, cp_name#5371 AS cp_name_3#5388, cp_mfgr#5372 AS cp_mfgr_3#5389, cp_type#5373 AS cp_type_3#5390, cp_size#5374 AS cp_size_3#5391, cp_container#5375 AS cp_container_3#5392, cp_retailprice#5376 AS cp_retailprice_3#5393, cp_comment#5377 AS cp_comment_3#5394, cp_brand#5378 AS cp_brand_3#5395]
            :  :  :        +- Relation[rid#5362,cval_part_p_name#5363,cval_part_p_mfgr#5364,cval_part_p_type#5365,cval_part_p_size#5366,cval_part_p_container#5367,cval_part_p_retailprice#5368,cval_part_p_comment#5369,cval_part_p_brand#5370,cp_name#5371,cp_mfgr#5372,cp_type#5373,cp_size#5374,cp_container#5375,cp_retailprice#5376,cp_comment#5377,cp_brand#5378] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#5462 AS rid_2#5473, cpfk_part_partsupp#5463 AS cpfk_part_partsupp_2#5474, cfpk_partsupp_part#5464 AS cfpk_partsupp_part_2#5475, cpfk_supplier_partsupp#5465 AS cpfk_supplier_partsupp_2#5476, cfpk_partsupp_supplier#5466 AS cfpk_partsupp_supplier_2#5477, cval_partsupp_ps_availqty#5467 AS cval_partsupp_ps_availqty_2#5478, cval_partsupp_ps_supplycost#5468 AS cval_partsupp_ps_supplycost_2#5479, cval_partsupp_ps_comment#5469 AS cval_partsupp_ps_comment_2#5480, cps_availqty#5470 AS cps_availqty_2#5481, cps_supplycost#5471 AS cps_supplycost_2#5482, cps_comment#5472 AS cps_comment_2#5483]
            :  :     :  +- Relation[rid#5462,cpfk_part_partsupp#5463,cfpk_partsupp_part#5464,cpfk_supplier_partsupp#5465,cfpk_partsupp_supplier#5466,cval_partsupp_ps_availqty#5467,cval_partsupp_ps_supplycost#5468,cval_partsupp_ps_comment#5469,cps_availqty#5470,cps_supplycost#5471,cps_comment#5472] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#5484 AS rid_4#5517, cpfk_orders_lineitem#5485 AS cpfk_orders_lineitem_4#5518, cpfk_supplier_lineitem#5486 AS cpfk_supplier_lineitem_4#5519, cfpk_lineitem_supplier#5487 AS cfpk_lineitem_supplier_4#5520, cfpk_lineitem_partsupp#5488 AS cfpk_lineitem_partsupp_4#5521, cpfk_part_lineitem#5489 AS cpfk_part_lineitem_4#5522, cfpk_lineitem_part#5490 AS cfpk_lineitem_part_4#5523, cpfk_partsupp_lineitem#5491 AS cpfk_partsupp_lineitem_4#5524, cfpk_lineitem_orders#5492 AS cfpk_lineitem_orders_4#5525, cval_lineitem_l_quantity#5493 AS cval_lineitem_l_quantity_4#5526, cval_lineitem_l_extendedprice#5494 AS cval_lineitem_l_extendedprice_4#5527, cval_lineitem_l_discount#5495 AS cval_lineitem_l_discount_4#5528, cval_lineitem_l_tax#5496 AS cval_lineitem_l_tax_4#5529, cval_lineitem_l_returnflag#5497 AS cval_lineitem_l_returnflag_4#5530, cval_lineitem_l_linestatus#5498 AS cval_lineitem_l_linestatus_4#5531, cval_lineitem_l_commitdate#5499 AS cval_lineitem_l_commitdate_4#5532, cval_lineitem_l_receiptdate#5500 AS cval_lineitem_l_receiptdate_4#5533, cval_lineitem_l_shipinstruct#5501 AS cval_lineitem_l_shipinstruct_4#5534, cval_lineitem_l_shipmode#5502 AS cval_lineitem_l_shipmode_4#5535, cval_lineitem_l_comment#5503 AS cval_lineitem_l_comment_4#5536, cval_lineitem_l_shipdate#5504 AS cval_lineitem_l_shipdate_4#5537, cl_quantity#5505 AS cl_quantity_4#5538, cl_extendedprice#5506 AS cl_extendedprice_4#5539, cl_discount#5507 AS cl_discount_4#5540, ... 9 more fields]
            :  :        +- Relation[rid#5484,cpfk_orders_lineitem#5485,cpfk_supplier_lineitem#5486,cfpk_lineitem_supplier#5487,cfpk_lineitem_partsupp#5488,cpfk_part_lineitem#5489,cfpk_lineitem_part#5490,cpfk_partsupp_lineitem#5491,cfpk_lineitem_orders#5492,cval_lineitem_l_quantity#5493,cval_lineitem_l_extendedprice#5494,cval_lineitem_l_discount#5495,cval_lineitem_l_tax#5496,cval_lineitem_l_returnflag#5497,cval_lineitem_l_linestatus#5498,cval_lineitem_l_commitdate#5499,cval_lineitem_l_receiptdate#5500,cval_lineitem_l_shipinstruct#5501,cval_lineitem_l_shipmode#5502,cval_lineitem_l_comment#5503,cval_lineitem_l_shipdate#5504,cl_quantity#5505,cl_extendedprice#5506,cl_discount#5507,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#5396 AS rid_4#5429, cpfk_orders_lineitem#5397 AS cpfk_orders_lineitem_4#5430, cpfk_supplier_lineitem#5398 AS cpfk_supplier_lineitem_4#5431, cfpk_lineitem_supplier#5399 AS cfpk_lineitem_supplier_4#5432, cfpk_lineitem_partsupp#5400 AS cfpk_lineitem_partsupp_4#5433, cpfk_part_lineitem#5401 AS cpfk_part_lineitem_4#5434, cfpk_lineitem_part#5402 AS cfpk_lineitem_part_4#5435, cpfk_partsupp_lineitem#5403 AS cpfk_partsupp_lineitem_4#5436, cfpk_lineitem_orders#5404 AS cfpk_lineitem_orders_4#5437, cval_lineitem_l_quantity#5405 AS cval_lineitem_l_quantity_4#5438, cval_lineitem_l_extendedprice#5406 AS cval_lineitem_l_extendedprice_4#5439, cval_lineitem_l_discount#5407 AS cval_lineitem_l_discount_4#5440, cval_lineitem_l_tax#5408 AS cval_lineitem_l_tax_4#5441, cval_lineitem_l_returnflag#5409 AS cval_lineitem_l_returnflag_4#5442, cval_lineitem_l_linestatus#5410 AS cval_lineitem_l_linestatus_4#5443, cval_lineitem_l_commitdate#5411 AS cval_lineitem_l_commitdate_4#5444, cval_lineitem_l_receiptdate#5412 AS cval_lineitem_l_receiptdate_4#5445, cval_lineitem_l_shipinstruct#5413 AS cval_lineitem_l_shipinstruct_4#5446, cval_lineitem_l_shipmode#5414 AS cval_lineitem_l_shipmode_4#5447, cval_lineitem_l_comment#5415 AS cval_lineitem_l_comment_4#5448, cval_lineitem_l_shipdate#5416 AS cval_lineitem_l_shipdate_4#5449, cl_quantity#5417 AS cl_quantity_4#5450, cl_extendedprice#5418 AS cl_extendedprice_4#5451, cl_discount#5419 AS cl_discount_4#5452, ... 9 more fields]
            :     +- Relation[rid#5396,cpfk_orders_lineitem#5397,cpfk_supplier_lineitem#5398,cfpk_lineitem_supplier#5399,cfpk_lineitem_partsupp#5400,cpfk_part_lineitem#5401,cfpk_lineitem_part#5402,cpfk_partsupp_lineitem#5403,cfpk_lineitem_orders#5404,cval_lineitem_l_quantity#5405,cval_lineitem_l_extendedprice#5406,cval_lineitem_l_discount#5407,cval_lineitem_l_tax#5408,cval_lineitem_l_returnflag#5409,cval_lineitem_l_linestatus#5410,cval_lineitem_l_commitdate#5411,cval_lineitem_l_receiptdate#5412,cval_lineitem_l_shipinstruct#5413,cval_lineitem_l_shipmode#5414,cval_lineitem_l_comment#5415,cval_lineitem_l_shipdate#5416,cl_quantity#5417,cl_extendedprice#5418,cl_discount#5419,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#5550 AS rid_5#5567, cpfk_customer_orders#5551 AS cpfk_customer_orders_5#5568, cfpk_orders_customer#5552 AS cfpk_orders_customer_5#5569, cval_orders_o_orderstatus#5553 AS cval_orders_o_orderstatus_5#5570, cval_orders_o_totalprice#5554 AS cval_orders_o_totalprice_5#5571, cval_orders_o_orderpriority#5555 AS cval_orders_o_orderpriority_5#5572, cval_orders_o_clerk#5556 AS cval_orders_o_clerk_5#5573, cval_orders_o_shippriority#5557 AS cval_orders_o_shippriority_5#5574, cval_orders_o_comment#5558 AS cval_orders_o_comment_5#5575, cval_orders_o_orderdate#5559 AS cval_orders_o_orderdate_5#5576, co_orderstatus#5560 AS co_orderstatus_5#5577, co_totalprice#5561 AS co_totalprice_5#5578, co_orderpriority#5562 AS co_orderpriority_5#5579, co_clerk#5563 AS co_clerk_5#5580, co_shippriority#5564 AS co_shippriority_5#5581, co_comment#5565 AS co_comment_5#5582, co_orderdate#5566 AS co_orderdate_5#5583]
               +- Relation[rid#5550,cpfk_customer_orders#5551,cfpk_orders_customer#5552,cval_orders_o_orderstatus#5553,cval_orders_o_totalprice#5554,cval_orders_o_orderpriority#5555,cval_orders_o_clerk#5556,cval_orders_o_shippriority#5557,cval_orders_o_comment#5558,cval_orders_o_orderdate#5559,co_orderstatus#5560,co_totalprice#5561,co_orderpriority#5562,co_clerk#5563,co_shippriority#5564,co_comment#5565,co_orderdate#5566] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 179001ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/15 16:02:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:02:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5688L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 16:02:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:02:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:02:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:02:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:02:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:02:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:02:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:02:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:02:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:02:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:02:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:02:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:02:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:02:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5688L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#5690 AS rid_0#5697, cpfk_region_nation#5691 AS cpfk_region_nation_0#5698, cfpk_nation_region#5692 AS cfpk_nation_region_0#5699, cval_nation_n_name#5693 AS cval_nation_n_name_0#5700, cval_nation_n_comment#5694 AS cval_nation_n_comment_0#5701, cn_name#5695 AS cn_name_0#5702, cn_comment#5696 AS cn_comment_0#5703]
         :  :  :  :  :  +- Relation[rid#5690,cpfk_region_nation#5691,cfpk_nation_region#5692,cval_nation_n_name#5693,cval_nation_n_comment#5694,cn_name#5695,cn_comment#5696] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#5704 AS rid_0#5711, cpfk_region_nation#5705 AS cpfk_region_nation_0#5712, cfpk_nation_region#5706 AS cfpk_nation_region_0#5713, cval_nation_n_name#5707 AS cval_nation_n_name_0#5714, cval_nation_n_comment#5708 AS cval_nation_n_comment_0#5715, cn_name#5709 AS cn_name_0#5716, cn_comment#5710 AS cn_comment_0#5717]
         :  :  :  :        +- Relation[rid#5704,cpfk_region_nation#5705,cfpk_nation_region#5706,cval_nation_n_name#5707,cval_nation_n_comment#5708,cn_name#5709,cn_comment#5710] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#5758 AS rid_1#5771, cpfk_nation_supplier#5759 AS cpfk_nation_supplier_1#5772, cfpk_supplier_nation#5760 AS cfpk_supplier_nation_1#5773, cval_supplier_s_name#5761 AS cval_supplier_s_name_1#5774, cval_supplier_s_address#5762 AS cval_supplier_s_address_1#5775, cval_supplier_s_phone#5763 AS cval_supplier_s_phone_1#5776, cval_supplier_s_acctbal#5764 AS cval_supplier_s_acctbal_1#5777, cval_supplier_s_comment#5765 AS cval_supplier_s_comment_1#5778, cs_name#5766 AS cs_name_1#5779, cs_address#5767 AS cs_address_1#5780, cs_phone#5768 AS cs_phone_1#5781, cs_acctbal#5769 AS cs_acctbal_1#5782, cs_comment#5770 AS cs_comment_1#5783]
         :  :  :     +- Relation[rid#5758,cpfk_nation_supplier#5759,cfpk_supplier_nation#5760,cval_supplier_s_name#5761,cval_supplier_s_address#5762,cval_supplier_s_phone#5763,cval_supplier_s_acctbal#5764,cval_supplier_s_comment#5765,cs_name#5766,cs_address#5767,cs_phone#5768,cs_acctbal#5769,cs_comment#5770] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#5718 AS rid_1#5731, cpfk_nation_supplier#5719 AS cpfk_nation_supplier_1#5732, cfpk_supplier_nation#5720 AS cfpk_supplier_nation_1#5733, cval_supplier_s_name#5721 AS cval_supplier_s_name_1#5734, cval_supplier_s_address#5722 AS cval_supplier_s_address_1#5735, cval_supplier_s_phone#5723 AS cval_supplier_s_phone_1#5736, cval_supplier_s_acctbal#5724 AS cval_supplier_s_acctbal_1#5737, cval_supplier_s_comment#5725 AS cval_supplier_s_comment_1#5738, cs_name#5726 AS cs_name_1#5739, cs_address#5727 AS cs_address_1#5740, cs_phone#5728 AS cs_phone_1#5741, cs_acctbal#5729 AS cs_acctbal_1#5742, cs_comment#5730 AS cs_comment_1#5743]
         :  :     +- Relation[rid#5718,cpfk_nation_supplier#5719,cfpk_supplier_nation#5720,cval_supplier_s_name#5721,cval_supplier_s_address#5722,cval_supplier_s_phone#5723,cval_supplier_s_acctbal#5724,cval_supplier_s_comment#5725,cs_name#5726,cs_address#5727,cs_phone#5728,cs_acctbal#5729,cs_comment#5730] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#5832 AS rid_2#5843, cpfk_part_partsupp#5833 AS cpfk_part_partsupp_2#5844, cfpk_partsupp_part#5834 AS cfpk_partsupp_part_2#5845, cpfk_supplier_partsupp#5835 AS cpfk_supplier_partsupp_2#5846, cfpk_partsupp_supplier#5836 AS cfpk_partsupp_supplier_2#5847, cval_partsupp_ps_availqty#5837 AS cval_partsupp_ps_availqty_2#5848, cval_partsupp_ps_supplycost#5838 AS cval_partsupp_ps_supplycost_2#5849, cval_partsupp_ps_comment#5839 AS cval_partsupp_ps_comment_2#5850, cps_availqty#5840 AS cps_availqty_2#5851, cps_supplycost#5841 AS cps_supplycost_2#5852, cps_comment#5842 AS cps_comment_2#5853]
         :     +- Relation[rid#5832,cpfk_part_partsupp#5833,cfpk_partsupp_part#5834,cpfk_supplier_partsupp#5835,cfpk_partsupp_supplier#5836,cval_partsupp_ps_availqty#5837,cval_partsupp_ps_supplycost#5838,cval_partsupp_ps_comment#5839,cps_availqty#5840,cps_supplycost#5841,cps_comment#5842] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#5784 AS rid_2#5795, cpfk_part_partsupp#5785 AS cpfk_part_partsupp_2#5796, cfpk_partsupp_part#5786 AS cfpk_partsupp_part_2#5797, cpfk_supplier_partsupp#5787 AS cpfk_supplier_partsupp_2#5798, cfpk_partsupp_supplier#5788 AS cfpk_partsupp_supplier_2#5799, cval_partsupp_ps_availqty#5789 AS cval_partsupp_ps_availqty_2#5800, cval_partsupp_ps_supplycost#5790 AS cval_partsupp_ps_supplycost_2#5801, cval_partsupp_ps_comment#5791 AS cval_partsupp_ps_comment_2#5802, cps_availqty#5792 AS cps_availqty_2#5803, cps_supplycost#5793 AS cps_supplycost_2#5804, cps_comment#5794 AS cps_comment_2#5805]
            +- Relation[rid#5784,cpfk_part_partsupp#5785,cfpk_partsupp_part#5786,cpfk_supplier_partsupp#5787,cfpk_partsupp_supplier#5788,cval_partsupp_ps_availqty#5789,cval_partsupp_ps_supplycost#5790,cval_partsupp_ps_comment#5791,cps_availqty#5792,cps_supplycost#5793,cps_comment#5794] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=4
Elapsed time: 1087ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/15 16:02:53 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:02:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5890L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:02:53 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:02:53 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:02:53 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:02:53 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:02:53 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:02:53 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:02:53 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 16:02:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5890L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#5892 AS rid_0#5909, cval_part_p_name#5893 AS cval_part_p_name_0#5910, cval_part_p_mfgr#5894 AS cval_part_p_mfgr_0#5911, cval_part_p_type#5895 AS cval_part_p_type_0#5912, cval_part_p_size#5896 AS cval_part_p_size_0#5913, cval_part_p_container#5897 AS cval_part_p_container_0#5914, cval_part_p_retailprice#5898 AS cval_part_p_retailprice_0#5915, cval_part_p_comment#5899 AS cval_part_p_comment_0#5916, cval_part_p_brand#5900 AS cval_part_p_brand_0#5917, cp_name#5901 AS cp_name_0#5918, cp_mfgr#5902 AS cp_mfgr_0#5919, cp_type#5903 AS cp_type_0#5920, cp_size#5904 AS cp_size_0#5921, cp_container#5905 AS cp_container_0#5922, cp_retailprice#5906 AS cp_retailprice_0#5923, cp_comment#5907 AS cp_comment_0#5924, cp_brand#5908 AS cp_brand_0#5925]
         :  :  :  :  +- Relation[rid#5892,cval_part_p_name#5893,cval_part_p_mfgr#5894,cval_part_p_type#5895,cval_part_p_size#5896,cval_part_p_container#5897,cval_part_p_retailprice#5898,cval_part_p_comment#5899,cval_part_p_brand#5900,cp_name#5901,cp_mfgr#5902,cp_type#5903,cp_size#5904,cp_container#5905,cp_retailprice#5906,cp_comment#5907,cp_brand#5908] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#5926 AS rid_0#5943, cval_part_p_name#5927 AS cval_part_p_name_0#5944, cval_part_p_mfgr#5928 AS cval_part_p_mfgr_0#5945, cval_part_p_type#5929 AS cval_part_p_type_0#5946, cval_part_p_size#5930 AS cval_part_p_size_0#5947, cval_part_p_container#5931 AS cval_part_p_container_0#5948, cval_part_p_retailprice#5932 AS cval_part_p_retailprice_0#5949, cval_part_p_comment#5933 AS cval_part_p_comment_0#5950, cval_part_p_brand#5934 AS cval_part_p_brand_0#5951, cp_name#5935 AS cp_name_0#5952, cp_mfgr#5936 AS cp_mfgr_0#5953, cp_type#5937 AS cp_type_0#5954, cp_size#5938 AS cp_size_0#5955, cp_container#5939 AS cp_container_0#5956, cp_retailprice#5940 AS cp_retailprice_0#5957, cp_comment#5941 AS cp_comment_0#5958, cp_brand#5942 AS cp_brand_0#5959]
         :  :  :        +- Relation[rid#5926,cval_part_p_name#5927,cval_part_p_mfgr#5928,cval_part_p_type#5929,cval_part_p_size#5930,cval_part_p_container#5931,cval_part_p_retailprice#5932,cval_part_p_comment#5933,cval_part_p_brand#5934,cp_name#5935,cp_mfgr#5936,cp_type#5937,cp_size#5938,cp_container#5939,cp_retailprice#5940,cp_comment#5941,cp_brand#5942] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#5960 AS rid_0#5977, cval_part_p_name#5961 AS cval_part_p_name_0#5978, cval_part_p_mfgr#5962 AS cval_part_p_mfgr_0#5979, cval_part_p_type#5963 AS cval_part_p_type_0#5980, cval_part_p_size#5964 AS cval_part_p_size_0#5981, cval_part_p_container#5965 AS cval_part_p_container_0#5982, cval_part_p_retailprice#5966 AS cval_part_p_retailprice_0#5983, cval_part_p_comment#5967 AS cval_part_p_comment_0#5984, cval_part_p_brand#5968 AS cval_part_p_brand_0#5985, cp_name#5969 AS cp_name_0#5986, cp_mfgr#5970 AS cp_mfgr_0#5987, cp_type#5971 AS cp_type_0#5988, cp_size#5972 AS cp_size_0#5989, cp_container#5973 AS cp_container_0#5990, cp_retailprice#5974 AS cp_retailprice_0#5991, cp_comment#5975 AS cp_comment_0#5992, cp_brand#5976 AS cp_brand_0#5993]
         :  :        +- Relation[rid#5960,cval_part_p_name#5961,cval_part_p_mfgr#5962,cval_part_p_type#5963,cval_part_p_size#5964,cval_part_p_container#5965,cval_part_p_retailprice#5966,cval_part_p_comment#5967,cval_part_p_brand#5968,cp_name#5969,cp_mfgr#5970,cp_type#5971,cp_size#5972,cp_container#5973,cp_retailprice#5974,cp_comment#5975,cp_brand#5976] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#6226 AS rid_1#6259, cpfk_orders_lineitem#6227 AS cpfk_orders_lineitem_1#6260, cpfk_supplier_lineitem#6228 AS cpfk_supplier_lineitem_1#6261, cfpk_lineitem_supplier#6229 AS cfpk_lineitem_supplier_1#6262, cfpk_lineitem_partsupp#6230 AS cfpk_lineitem_partsupp_1#6263, cpfk_part_lineitem#6231 AS cpfk_part_lineitem_1#6264, cfpk_lineitem_part#6232 AS cfpk_lineitem_part_1#6265, cpfk_partsupp_lineitem#6233 AS cpfk_partsupp_lineitem_1#6266, cfpk_lineitem_orders#6234 AS cfpk_lineitem_orders_1#6267, cval_lineitem_l_quantity#6235 AS cval_lineitem_l_quantity_1#6268, cval_lineitem_l_extendedprice#6236 AS cval_lineitem_l_extendedprice_1#6269, cval_lineitem_l_discount#6237 AS cval_lineitem_l_discount_1#6270, cval_lineitem_l_tax#6238 AS cval_lineitem_l_tax_1#6271, cval_lineitem_l_returnflag#6239 AS cval_lineitem_l_returnflag_1#6272, cval_lineitem_l_linestatus#6240 AS cval_lineitem_l_linestatus_1#6273, cval_lineitem_l_commitdate#6241 AS cval_lineitem_l_commitdate_1#6274, cval_lineitem_l_receiptdate#6242 AS cval_lineitem_l_receiptdate_1#6275, cval_lineitem_l_shipinstruct#6243 AS cval_lineitem_l_shipinstruct_1#6276, cval_lineitem_l_shipmode#6244 AS cval_lineitem_l_shipmode_1#6277, cval_lineitem_l_comment#6245 AS cval_lineitem_l_comment_1#6278, cval_lineitem_l_shipdate#6246 AS cval_lineitem_l_shipdate_1#6279, cl_quantity#6247 AS cl_quantity_1#6280, cl_extendedprice#6248 AS cl_extendedprice_1#6281, cl_discount#6249 AS cl_discount_1#6282, ... 9 more fields]
         :     +- Relation[rid#6226,cpfk_orders_lineitem#6227,cpfk_supplier_lineitem#6228,cfpk_lineitem_supplier#6229,cfpk_lineitem_partsupp#6230,cpfk_part_lineitem#6231,cfpk_lineitem_part#6232,cpfk_partsupp_lineitem#6233,cfpk_lineitem_orders#6234,cval_lineitem_l_quantity#6235,cval_lineitem_l_extendedprice#6236,cval_lineitem_l_discount#6237,cval_lineitem_l_tax#6238,cval_lineitem_l_returnflag#6239,cval_lineitem_l_linestatus#6240,cval_lineitem_l_commitdate#6241,cval_lineitem_l_receiptdate#6242,cval_lineitem_l_shipinstruct#6243,cval_lineitem_l_shipmode#6244,cval_lineitem_l_comment#6245,cval_lineitem_l_shipdate#6246,cl_quantity#6247,cl_extendedprice#6248,cl_discount#6249,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#5994 AS rid_1#6027, cpfk_orders_lineitem#5995 AS cpfk_orders_lineitem_1#6028, cpfk_supplier_lineitem#5996 AS cpfk_supplier_lineitem_1#6029, cfpk_lineitem_supplier#5997 AS cfpk_lineitem_supplier_1#6030, cfpk_lineitem_partsupp#5998 AS cfpk_lineitem_partsupp_1#6031, cpfk_part_lineitem#5999 AS cpfk_part_lineitem_1#6032, cfpk_lineitem_part#6000 AS cfpk_lineitem_part_1#6033, cpfk_partsupp_lineitem#6001 AS cpfk_partsupp_lineitem_1#6034, cfpk_lineitem_orders#6002 AS cfpk_lineitem_orders_1#6035, cval_lineitem_l_quantity#6003 AS cval_lineitem_l_quantity_1#6036, cval_lineitem_l_extendedprice#6004 AS cval_lineitem_l_extendedprice_1#6037, cval_lineitem_l_discount#6005 AS cval_lineitem_l_discount_1#6038, cval_lineitem_l_tax#6006 AS cval_lineitem_l_tax_1#6039, cval_lineitem_l_returnflag#6007 AS cval_lineitem_l_returnflag_1#6040, cval_lineitem_l_linestatus#6008 AS cval_lineitem_l_linestatus_1#6041, cval_lineitem_l_commitdate#6009 AS cval_lineitem_l_commitdate_1#6042, cval_lineitem_l_receiptdate#6010 AS cval_lineitem_l_receiptdate_1#6043, cval_lineitem_l_shipinstruct#6011 AS cval_lineitem_l_shipinstruct_1#6044, cval_lineitem_l_shipmode#6012 AS cval_lineitem_l_shipmode_1#6045, cval_lineitem_l_comment#6013 AS cval_lineitem_l_comment_1#6046, cval_lineitem_l_shipdate#6014 AS cval_lineitem_l_shipdate_1#6047, cl_quantity#6015 AS cl_quantity_1#6048, cl_extendedprice#6016 AS cl_extendedprice_1#6049, cl_discount#6017 AS cl_discount_1#6050, ... 9 more fields]
            :  :  +- Relation[rid#5994,cpfk_orders_lineitem#5995,cpfk_supplier_lineitem#5996,cfpk_lineitem_supplier#5997,cfpk_lineitem_partsupp#5998,cpfk_part_lineitem#5999,cfpk_lineitem_part#6000,cpfk_partsupp_lineitem#6001,cfpk_lineitem_orders#6002,cval_lineitem_l_quantity#6003,cval_lineitem_l_extendedprice#6004,cval_lineitem_l_discount#6005,cval_lineitem_l_tax#6006,cval_lineitem_l_returnflag#6007,cval_lineitem_l_linestatus#6008,cval_lineitem_l_commitdate#6009,cval_lineitem_l_receiptdate#6010,cval_lineitem_l_shipinstruct#6011,cval_lineitem_l_shipmode#6012,cval_lineitem_l_comment#6013,cval_lineitem_l_shipdate#6014,cl_quantity#6015,cl_extendedprice#6016,cl_discount#6017,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#6060 AS rid_1#6093, cpfk_orders_lineitem#6061 AS cpfk_orders_lineitem_1#6094, cpfk_supplier_lineitem#6062 AS cpfk_supplier_lineitem_1#6095, cfpk_lineitem_supplier#6063 AS cfpk_lineitem_supplier_1#6096, cfpk_lineitem_partsupp#6064 AS cfpk_lineitem_partsupp_1#6097, cpfk_part_lineitem#6065 AS cpfk_part_lineitem_1#6098, cfpk_lineitem_part#6066 AS cfpk_lineitem_part_1#6099, cpfk_partsupp_lineitem#6067 AS cpfk_partsupp_lineitem_1#6100, cfpk_lineitem_orders#6068 AS cfpk_lineitem_orders_1#6101, cval_lineitem_l_quantity#6069 AS cval_lineitem_l_quantity_1#6102, cval_lineitem_l_extendedprice#6070 AS cval_lineitem_l_extendedprice_1#6103, cval_lineitem_l_discount#6071 AS cval_lineitem_l_discount_1#6104, cval_lineitem_l_tax#6072 AS cval_lineitem_l_tax_1#6105, cval_lineitem_l_returnflag#6073 AS cval_lineitem_l_returnflag_1#6106, cval_lineitem_l_linestatus#6074 AS cval_lineitem_l_linestatus_1#6107, cval_lineitem_l_commitdate#6075 AS cval_lineitem_l_commitdate_1#6108, cval_lineitem_l_receiptdate#6076 AS cval_lineitem_l_receiptdate_1#6109, cval_lineitem_l_shipinstruct#6077 AS cval_lineitem_l_shipinstruct_1#6110, cval_lineitem_l_shipmode#6078 AS cval_lineitem_l_shipmode_1#6111, cval_lineitem_l_comment#6079 AS cval_lineitem_l_comment_1#6112, cval_lineitem_l_shipdate#6080 AS cval_lineitem_l_shipdate_1#6113, cl_quantity#6081 AS cl_quantity_1#6114, cl_extendedprice#6082 AS cl_extendedprice_1#6115, cl_discount#6083 AS cl_discount_1#6116, ... 9 more fields]
            :        +- Relation[rid#6060,cpfk_orders_lineitem#6061,cpfk_supplier_lineitem#6062,cfpk_lineitem_supplier#6063,cfpk_lineitem_partsupp#6064,cpfk_part_lineitem#6065,cfpk_lineitem_part#6066,cpfk_partsupp_lineitem#6067,cfpk_lineitem_orders#6068,cval_lineitem_l_quantity#6069,cval_lineitem_l_extendedprice#6070,cval_lineitem_l_discount#6071,cval_lineitem_l_tax#6072,cval_lineitem_l_returnflag#6073,cval_lineitem_l_linestatus#6074,cval_lineitem_l_commitdate#6075,cval_lineitem_l_receiptdate#6076,cval_lineitem_l_shipinstruct#6077,cval_lineitem_l_shipmode#6078,cval_lineitem_l_comment#6079,cval_lineitem_l_shipdate#6080,cl_quantity#6081,cl_extendedprice#6082,cl_discount#6083,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#6126 AS rid_1#6159, cpfk_orders_lineitem#6127 AS cpfk_orders_lineitem_1#6160, cpfk_supplier_lineitem#6128 AS cpfk_supplier_lineitem_1#6161, cfpk_lineitem_supplier#6129 AS cfpk_lineitem_supplier_1#6162, cfpk_lineitem_partsupp#6130 AS cfpk_lineitem_partsupp_1#6163, cpfk_part_lineitem#6131 AS cpfk_part_lineitem_1#6164, cfpk_lineitem_part#6132 AS cfpk_lineitem_part_1#6165, cpfk_partsupp_lineitem#6133 AS cpfk_partsupp_lineitem_1#6166, cfpk_lineitem_orders#6134 AS cfpk_lineitem_orders_1#6167, cval_lineitem_l_quantity#6135 AS cval_lineitem_l_quantity_1#6168, cval_lineitem_l_extendedprice#6136 AS cval_lineitem_l_extendedprice_1#6169, cval_lineitem_l_discount#6137 AS cval_lineitem_l_discount_1#6170, cval_lineitem_l_tax#6138 AS cval_lineitem_l_tax_1#6171, cval_lineitem_l_returnflag#6139 AS cval_lineitem_l_returnflag_1#6172, cval_lineitem_l_linestatus#6140 AS cval_lineitem_l_linestatus_1#6173, cval_lineitem_l_commitdate#6141 AS cval_lineitem_l_commitdate_1#6174, cval_lineitem_l_receiptdate#6142 AS cval_lineitem_l_receiptdate_1#6175, cval_lineitem_l_shipinstruct#6143 AS cval_lineitem_l_shipinstruct_1#6176, cval_lineitem_l_shipmode#6144 AS cval_lineitem_l_shipmode_1#6177, cval_lineitem_l_comment#6145 AS cval_lineitem_l_comment_1#6178, cval_lineitem_l_shipdate#6146 AS cval_lineitem_l_shipdate_1#6179, cl_quantity#6147 AS cl_quantity_1#6180, cl_extendedprice#6148 AS cl_extendedprice_1#6181, cl_discount#6149 AS cl_discount_1#6182, ... 9 more fields]
                  +- Relation[rid#6126,cpfk_orders_lineitem#6127,cpfk_supplier_lineitem#6128,cfpk_lineitem_supplier#6129,cfpk_lineitem_partsupp#6130,cpfk_part_lineitem#6131,cfpk_lineitem_part#6132,cpfk_partsupp_lineitem#6133,cfpk_lineitem_orders#6134,cval_lineitem_l_quantity#6135,cval_lineitem_l_extendedprice#6136,cval_lineitem_l_discount#6137,cval_lineitem_l_tax#6138,cval_lineitem_l_returnflag#6139,cval_lineitem_l_linestatus#6140,cval_lineitem_l_commitdate#6141,cval_lineitem_l_receiptdate#6142,cval_lineitem_l_shipinstruct#6143,cval_lineitem_l_shipmode#6144,cval_lineitem_l_comment#6145,cval_lineitem_l_shipdate#6146,cl_quantity#6147,cl_extendedprice#6148,cl_discount#6149,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=13
Elapsed time: 64804ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/15 16:03:58 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:03:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6354L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 16:03:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:03:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:03:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6354L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#6356 AS rid_0#6389, cpfk_orders_lineitem#6357 AS cpfk_orders_lineitem_0#6390, cpfk_supplier_lineitem#6358 AS cpfk_supplier_lineitem_0#6391, cfpk_lineitem_supplier#6359 AS cfpk_lineitem_supplier_0#6392, cfpk_lineitem_partsupp#6360 AS cfpk_lineitem_partsupp_0#6393, cpfk_part_lineitem#6361 AS cpfk_part_lineitem_0#6394, cfpk_lineitem_part#6362 AS cfpk_lineitem_part_0#6395, cpfk_partsupp_lineitem#6363 AS cpfk_partsupp_lineitem_0#6396, cfpk_lineitem_orders#6364 AS cfpk_lineitem_orders_0#6397, cval_lineitem_l_quantity#6365 AS cval_lineitem_l_quantity_0#6398, cval_lineitem_l_extendedprice#6366 AS cval_lineitem_l_extendedprice_0#6399, cval_lineitem_l_discount#6367 AS cval_lineitem_l_discount_0#6400, cval_lineitem_l_tax#6368 AS cval_lineitem_l_tax_0#6401, cval_lineitem_l_returnflag#6369 AS cval_lineitem_l_returnflag_0#6402, cval_lineitem_l_linestatus#6370 AS cval_lineitem_l_linestatus_0#6403, cval_lineitem_l_commitdate#6371 AS cval_lineitem_l_commitdate_0#6404, cval_lineitem_l_receiptdate#6372 AS cval_lineitem_l_receiptdate_0#6405, cval_lineitem_l_shipinstruct#6373 AS cval_lineitem_l_shipinstruct_0#6406, cval_lineitem_l_shipmode#6374 AS cval_lineitem_l_shipmode_0#6407, cval_lineitem_l_comment#6375 AS cval_lineitem_l_comment_0#6408, cval_lineitem_l_shipdate#6376 AS cval_lineitem_l_shipdate_0#6409, cl_quantity#6377 AS cl_quantity_0#6410, cl_extendedprice#6378 AS cl_extendedprice_0#6411, cl_discount#6379 AS cl_discount_0#6412, ... 9 more fields]
            :     :     :  :  +- Relation[rid#6356,cpfk_orders_lineitem#6357,cpfk_supplier_lineitem#6358,cfpk_lineitem_supplier#6359,cfpk_lineitem_partsupp#6360,cpfk_part_lineitem#6361,cfpk_lineitem_part#6362,cpfk_partsupp_lineitem#6363,cfpk_lineitem_orders#6364,cval_lineitem_l_quantity#6365,cval_lineitem_l_extendedprice#6366,cval_lineitem_l_discount#6367,cval_lineitem_l_tax#6368,cval_lineitem_l_returnflag#6369,cval_lineitem_l_linestatus#6370,cval_lineitem_l_commitdate#6371,cval_lineitem_l_receiptdate#6372,cval_lineitem_l_shipinstruct#6373,cval_lineitem_l_shipmode#6374,cval_lineitem_l_comment#6375,cval_lineitem_l_shipdate#6376,cl_quantity#6377,cl_extendedprice#6378,cl_discount#6379,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#6422 AS rid_0#6455, cpfk_orders_lineitem#6423 AS cpfk_orders_lineitem_0#6456, cpfk_supplier_lineitem#6424 AS cpfk_supplier_lineitem_0#6457, cfpk_lineitem_supplier#6425 AS cfpk_lineitem_supplier_0#6458, cfpk_lineitem_partsupp#6426 AS cfpk_lineitem_partsupp_0#6459, cpfk_part_lineitem#6427 AS cpfk_part_lineitem_0#6460, cfpk_lineitem_part#6428 AS cfpk_lineitem_part_0#6461, cpfk_partsupp_lineitem#6429 AS cpfk_partsupp_lineitem_0#6462, cfpk_lineitem_orders#6430 AS cfpk_lineitem_orders_0#6463, cval_lineitem_l_quantity#6431 AS cval_lineitem_l_quantity_0#6464, cval_lineitem_l_extendedprice#6432 AS cval_lineitem_l_extendedprice_0#6465, cval_lineitem_l_discount#6433 AS cval_lineitem_l_discount_0#6466, cval_lineitem_l_tax#6434 AS cval_lineitem_l_tax_0#6467, cval_lineitem_l_returnflag#6435 AS cval_lineitem_l_returnflag_0#6468, cval_lineitem_l_linestatus#6436 AS cval_lineitem_l_linestatus_0#6469, cval_lineitem_l_commitdate#6437 AS cval_lineitem_l_commitdate_0#6470, cval_lineitem_l_receiptdate#6438 AS cval_lineitem_l_receiptdate_0#6471, cval_lineitem_l_shipinstruct#6439 AS cval_lineitem_l_shipinstruct_0#6472, cval_lineitem_l_shipmode#6440 AS cval_lineitem_l_shipmode_0#6473, cval_lineitem_l_comment#6441 AS cval_lineitem_l_comment_0#6474, cval_lineitem_l_shipdate#6442 AS cval_lineitem_l_shipdate_0#6475, cl_quantity#6443 AS cl_quantity_0#6476, cl_extendedprice#6444 AS cl_extendedprice_0#6477, cl_discount#6445 AS cl_discount_0#6478, ... 9 more fields]
            :     :     :        +- Relation[rid#6422,cpfk_orders_lineitem#6423,cpfk_supplier_lineitem#6424,cfpk_lineitem_supplier#6425,cfpk_lineitem_partsupp#6426,cpfk_part_lineitem#6427,cfpk_lineitem_part#6428,cpfk_partsupp_lineitem#6429,cfpk_lineitem_orders#6430,cval_lineitem_l_quantity#6431,cval_lineitem_l_extendedprice#6432,cval_lineitem_l_discount#6433,cval_lineitem_l_tax#6434,cval_lineitem_l_returnflag#6435,cval_lineitem_l_linestatus#6436,cval_lineitem_l_commitdate#6437,cval_lineitem_l_receiptdate#6438,cval_lineitem_l_shipinstruct#6439,cval_lineitem_l_shipmode#6440,cval_lineitem_l_comment#6441,cval_lineitem_l_shipdate#6442,cl_quantity#6443,cl_extendedprice#6444,cl_discount#6445,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#6488 AS rid_1#6505, cpfk_customer_orders#6489 AS cpfk_customer_orders_1#6506, cfpk_orders_customer#6490 AS cfpk_orders_customer_1#6507, cval_orders_o_orderstatus#6491 AS cval_orders_o_orderstatus_1#6508, cval_orders_o_totalprice#6492 AS cval_orders_o_totalprice_1#6509, cval_orders_o_orderpriority#6493 AS cval_orders_o_orderpriority_1#6510, cval_orders_o_clerk#6494 AS cval_orders_o_clerk_1#6511, cval_orders_o_shippriority#6495 AS cval_orders_o_shippriority_1#6512, cval_orders_o_comment#6496 AS cval_orders_o_comment_1#6513, cval_orders_o_orderdate#6497 AS cval_orders_o_orderdate_1#6514, co_orderstatus#6498 AS co_orderstatus_1#6515, co_totalprice#6499 AS co_totalprice_1#6516, co_orderpriority#6500 AS co_orderpriority_1#6517, co_clerk#6501 AS co_clerk_1#6518, co_shippriority#6502 AS co_shippriority_1#6519, co_comment#6503 AS co_comment_1#6520, co_orderdate#6504 AS co_orderdate_1#6521]
            :     :        +- Relation[rid#6488,cpfk_customer_orders#6489,cfpk_orders_customer#6490,cval_orders_o_orderstatus#6491,cval_orders_o_totalprice#6492,cval_orders_o_orderpriority#6493,cval_orders_o_clerk#6494,cval_orders_o_shippriority#6495,cval_orders_o_comment#6496,cval_orders_o_orderdate#6497,co_orderstatus#6498,co_totalprice#6499,co_orderpriority#6500,co_clerk#6501,co_shippriority#6502,co_comment#6503,co_orderdate#6504] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#6522 AS rid_2#6537, cpfk_nation_customer#6523 AS cpfk_nation_customer_2#6538, cfpk_customer_nation#6524 AS cfpk_customer_nation_2#6539, cval_customer_c_name#6525 AS cval_customer_c_name_2#6540, cval_customer_c_address#6526 AS cval_customer_c_address_2#6541, cval_customer_c_phone#6527 AS cval_customer_c_phone_2#6542, cval_customer_c_acctbal#6528 AS cval_customer_c_acctbal_2#6543, cval_customer_c_comment#6529 AS cval_customer_c_comment_2#6544, cval_customer_c_mktsegment#6530 AS cval_customer_c_mktsegment_2#6545, cc_name#6531 AS cc_name_2#6546, cc_address#6532 AS cc_address_2#6547, cc_phone#6533 AS cc_phone_2#6548, cc_acctbal#6534 AS cc_acctbal_2#6549, cc_comment#6535 AS cc_comment_2#6550, cc_mktsegment#6536 AS cc_mktsegment_2#6551]
            :        +- Relation[rid#6522,cpfk_nation_customer#6523,cfpk_customer_nation#6524,cval_customer_c_name#6525,cval_customer_c_address#6526,cval_customer_c_phone#6527,cval_customer_c_acctbal#6528,cval_customer_c_comment#6529,cval_customer_c_mktsegment#6530,cc_name#6531,cc_address#6532,cc_phone#6533,cc_acctbal#6534,cc_comment#6535,cc_mktsegment#6536] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#6552 AS rid_3#6559, cpfk_region_nation#6553 AS cpfk_region_nation_3#6560, cfpk_nation_region#6554 AS cfpk_nation_region_3#6561, cval_nation_n_name#6555 AS cval_nation_n_name_3#6562, cval_nation_n_comment#6556 AS cval_nation_n_comment_3#6563, cn_name#6557 AS cn_name_3#6564, cn_comment#6558 AS cn_comment_3#6565]
               +- Relation[rid#6552,cpfk_region_nation#6553,cfpk_nation_region#6554,cval_nation_n_name#6555,cval_nation_n_comment#6556,cn_name#6557,cn_comment#6558] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 69661ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/15 16:05:07 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:05:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6647L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:05:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6647L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#6649 AS rid_0#6664, cpfk_nation_customer#6650 AS cpfk_nation_customer_0#6665, cfpk_customer_nation#6651 AS cfpk_customer_nation_0#6666, cval_customer_c_name#6652 AS cval_customer_c_name_0#6667, cval_customer_c_address#6653 AS cval_customer_c_address_0#6668, cval_customer_c_phone#6654 AS cval_customer_c_phone_0#6669, cval_customer_c_acctbal#6655 AS cval_customer_c_acctbal_0#6670, cval_customer_c_comment#6656 AS cval_customer_c_comment_0#6671, cval_customer_c_mktsegment#6657 AS cval_customer_c_mktsegment_0#6672, cc_name#6658 AS cc_name_0#6673, cc_address#6659 AS cc_address_0#6674, cc_phone#6660 AS cc_phone_0#6675, cc_acctbal#6661 AS cc_acctbal_0#6676, cc_comment#6662 AS cc_comment_0#6677, cc_mktsegment#6663 AS cc_mktsegment_0#6678]
         :  :  :  :  +- Relation[rid#6649,cpfk_nation_customer#6650,cfpk_customer_nation#6651,cval_customer_c_name#6652,cval_customer_c_address#6653,cval_customer_c_phone#6654,cval_customer_c_acctbal#6655,cval_customer_c_comment#6656,cval_customer_c_mktsegment#6657,cc_name#6658,cc_address#6659,cc_phone#6660,cc_acctbal#6661,cc_comment#6662,cc_mktsegment#6663] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#6713 AS rid_0#6728, cpfk_nation_customer#6714 AS cpfk_nation_customer_0#6729, cfpk_customer_nation#6715 AS cfpk_customer_nation_0#6730, cval_customer_c_name#6716 AS cval_customer_c_name_0#6731, cval_customer_c_address#6717 AS cval_customer_c_address_0#6732, cval_customer_c_phone#6718 AS cval_customer_c_phone_0#6733, cval_customer_c_acctbal#6719 AS cval_customer_c_acctbal_0#6734, cval_customer_c_comment#6720 AS cval_customer_c_comment_0#6735, cval_customer_c_mktsegment#6721 AS cval_customer_c_mktsegment_0#6736, cc_name#6722 AS cc_name_0#6737, cc_address#6723 AS cc_address_0#6738, cc_phone#6724 AS cc_phone_0#6739, cc_acctbal#6725 AS cc_acctbal_0#6740, cc_comment#6726 AS cc_comment_0#6741, cc_mktsegment#6727 AS cc_mktsegment_0#6742]
         :  :  :     :  +- Relation[rid#6713,cpfk_nation_customer#6714,cfpk_customer_nation#6715,cval_customer_c_name#6716,cval_customer_c_address#6717,cval_customer_c_phone#6718,cval_customer_c_acctbal#6719,cval_customer_c_comment#6720,cval_customer_c_mktsegment#6721,cc_name#6722,cc_address#6723,cc_phone#6724,cc_acctbal#6725,cc_comment#6726,cc_mktsegment#6727] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#6743 AS rid_1#6760, cpfk_customer_orders#6744 AS cpfk_customer_orders_1#6761, cfpk_orders_customer#6745 AS cfpk_orders_customer_1#6762, cval_orders_o_orderstatus#6746 AS cval_orders_o_orderstatus_1#6763, cval_orders_o_totalprice#6747 AS cval_orders_o_totalprice_1#6764, cval_orders_o_orderpriority#6748 AS cval_orders_o_orderpriority_1#6765, cval_orders_o_clerk#6749 AS cval_orders_o_clerk_1#6766, cval_orders_o_shippriority#6750 AS cval_orders_o_shippriority_1#6767, cval_orders_o_comment#6751 AS cval_orders_o_comment_1#6768, cval_orders_o_orderdate#6752 AS cval_orders_o_orderdate_1#6769, co_orderstatus#6753 AS co_orderstatus_1#6770, co_totalprice#6754 AS co_totalprice_1#6771, co_orderpriority#6755 AS co_orderpriority_1#6772, co_clerk#6756 AS co_clerk_1#6773, co_shippriority#6757 AS co_shippriority_1#6774, co_comment#6758 AS co_comment_1#6775, co_orderdate#6759 AS co_orderdate_1#6776]
         :  :  :        +- Relation[rid#6743,cpfk_customer_orders#6744,cfpk_orders_customer#6745,cval_orders_o_orderstatus#6746,cval_orders_o_totalprice#6747,cval_orders_o_orderpriority#6748,cval_orders_o_clerk#6749,cval_orders_o_shippriority#6750,cval_orders_o_comment#6751,cval_orders_o_orderdate#6752,co_orderstatus#6753,co_totalprice#6754,co_orderpriority#6755,co_clerk#6756,co_shippriority#6757,co_comment#6758,co_orderdate#6759] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#6679 AS rid_1#6696, cpfk_customer_orders#6680 AS cpfk_customer_orders_1#6697, cfpk_orders_customer#6681 AS cfpk_orders_customer_1#6698, cval_orders_o_orderstatus#6682 AS cval_orders_o_orderstatus_1#6699, cval_orders_o_totalprice#6683 AS cval_orders_o_totalprice_1#6700, cval_orders_o_orderpriority#6684 AS cval_orders_o_orderpriority_1#6701, cval_orders_o_clerk#6685 AS cval_orders_o_clerk_1#6702, cval_orders_o_shippriority#6686 AS cval_orders_o_shippriority_1#6703, cval_orders_o_comment#6687 AS cval_orders_o_comment_1#6704, cval_orders_o_orderdate#6688 AS cval_orders_o_orderdate_1#6705, co_orderstatus#6689 AS co_orderstatus_1#6706, co_totalprice#6690 AS co_totalprice_1#6707, co_orderpriority#6691 AS co_orderpriority_1#6708, co_clerk#6692 AS co_clerk_1#6709, co_shippriority#6693 AS co_shippriority_1#6710, co_comment#6694 AS co_comment_1#6711, co_orderdate#6695 AS co_orderdate_1#6712]
         :  :     +- Relation[rid#6679,cpfk_customer_orders#6680,cfpk_orders_customer#6681,cval_orders_o_orderstatus#6682,cval_orders_o_totalprice#6683,cval_orders_o_orderpriority#6684,cval_orders_o_clerk#6685,cval_orders_o_shippriority#6686,cval_orders_o_comment#6687,cval_orders_o_orderdate#6688,co_orderstatus#6689,co_totalprice#6690,co_orderpriority#6691,co_clerk#6692,co_shippriority#6693,co_comment#6694,co_orderdate#6695] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#6843 AS rid_1#6860, cpfk_customer_orders#6844 AS cpfk_customer_orders_1#6861, cfpk_orders_customer#6845 AS cfpk_orders_customer_1#6862, cval_orders_o_orderstatus#6846 AS cval_orders_o_orderstatus_1#6863, cval_orders_o_totalprice#6847 AS cval_orders_o_totalprice_1#6864, cval_orders_o_orderpriority#6848 AS cval_orders_o_orderpriority_1#6865, cval_orders_o_clerk#6849 AS cval_orders_o_clerk_1#6866, cval_orders_o_shippriority#6850 AS cval_orders_o_shippriority_1#6867, cval_orders_o_comment#6851 AS cval_orders_o_comment_1#6868, cval_orders_o_orderdate#6852 AS cval_orders_o_orderdate_1#6869, co_orderstatus#6853 AS co_orderstatus_1#6870, co_totalprice#6854 AS co_totalprice_1#6871, co_orderpriority#6855 AS co_orderpriority_1#6872, co_clerk#6856 AS co_clerk_1#6873, co_shippriority#6857 AS co_shippriority_1#6874, co_comment#6858 AS co_comment_1#6875, co_orderdate#6859 AS co_orderdate_1#6876]
         :     :  +- Relation[rid#6843,cpfk_customer_orders#6844,cfpk_orders_customer#6845,cval_orders_o_orderstatus#6846,cval_orders_o_totalprice#6847,cval_orders_o_orderpriority#6848,cval_orders_o_clerk#6849,cval_orders_o_shippriority#6850,cval_orders_o_comment#6851,cval_orders_o_orderdate#6852,co_orderstatus#6853,co_totalprice#6854,co_orderpriority#6855,co_clerk#6856,co_shippriority#6857,co_comment#6858,co_orderdate#6859] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#6877 AS rid_2#6910, cpfk_orders_lineitem#6878 AS cpfk_orders_lineitem_2#6911, cpfk_supplier_lineitem#6879 AS cpfk_supplier_lineitem_2#6912, cfpk_lineitem_supplier#6880 AS cfpk_lineitem_supplier_2#6913, cfpk_lineitem_partsupp#6881 AS cfpk_lineitem_partsupp_2#6914, cpfk_part_lineitem#6882 AS cpfk_part_lineitem_2#6915, cfpk_lineitem_part#6883 AS cfpk_lineitem_part_2#6916, cpfk_partsupp_lineitem#6884 AS cpfk_partsupp_lineitem_2#6917, cfpk_lineitem_orders#6885 AS cfpk_lineitem_orders_2#6918, cval_lineitem_l_quantity#6886 AS cval_lineitem_l_quantity_2#6919, cval_lineitem_l_extendedprice#6887 AS cval_lineitem_l_extendedprice_2#6920, cval_lineitem_l_discount#6888 AS cval_lineitem_l_discount_2#6921, cval_lineitem_l_tax#6889 AS cval_lineitem_l_tax_2#6922, cval_lineitem_l_returnflag#6890 AS cval_lineitem_l_returnflag_2#6923, cval_lineitem_l_linestatus#6891 AS cval_lineitem_l_linestatus_2#6924, cval_lineitem_l_commitdate#6892 AS cval_lineitem_l_commitdate_2#6925, cval_lineitem_l_receiptdate#6893 AS cval_lineitem_l_receiptdate_2#6926, cval_lineitem_l_shipinstruct#6894 AS cval_lineitem_l_shipinstruct_2#6927, cval_lineitem_l_shipmode#6895 AS cval_lineitem_l_shipmode_2#6928, cval_lineitem_l_comment#6896 AS cval_lineitem_l_comment_2#6929, cval_lineitem_l_shipdate#6897 AS cval_lineitem_l_shipdate_2#6930, cl_quantity#6898 AS cl_quantity_2#6931, cl_extendedprice#6899 AS cl_extendedprice_2#6932, cl_discount#6900 AS cl_discount_2#6933, ... 9 more fields]
         :        +- Relation[rid#6877,cpfk_orders_lineitem#6878,cpfk_supplier_lineitem#6879,cfpk_lineitem_supplier#6880,cfpk_lineitem_partsupp#6881,cpfk_part_lineitem#6882,cfpk_lineitem_part#6883,cpfk_partsupp_lineitem#6884,cfpk_lineitem_orders#6885,cval_lineitem_l_quantity#6886,cval_lineitem_l_extendedprice#6887,cval_lineitem_l_discount#6888,cval_lineitem_l_tax#6889,cval_lineitem_l_returnflag#6890,cval_lineitem_l_linestatus#6891,cval_lineitem_l_commitdate#6892,cval_lineitem_l_receiptdate#6893,cval_lineitem_l_shipinstruct#6894,cval_lineitem_l_shipmode#6895,cval_lineitem_l_comment#6896,cval_lineitem_l_shipdate#6897,cl_quantity#6898,cl_extendedprice#6899,cl_discount#6900,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6777 AS rid_2#6810, cpfk_orders_lineitem#6778 AS cpfk_orders_lineitem_2#6811, cpfk_supplier_lineitem#6779 AS cpfk_supplier_lineitem_2#6812, cfpk_lineitem_supplier#6780 AS cfpk_lineitem_supplier_2#6813, cfpk_lineitem_partsupp#6781 AS cfpk_lineitem_partsupp_2#6814, cpfk_part_lineitem#6782 AS cpfk_part_lineitem_2#6815, cfpk_lineitem_part#6783 AS cfpk_lineitem_part_2#6816, cpfk_partsupp_lineitem#6784 AS cpfk_partsupp_lineitem_2#6817, cfpk_lineitem_orders#6785 AS cfpk_lineitem_orders_2#6818, cval_lineitem_l_quantity#6786 AS cval_lineitem_l_quantity_2#6819, cval_lineitem_l_extendedprice#6787 AS cval_lineitem_l_extendedprice_2#6820, cval_lineitem_l_discount#6788 AS cval_lineitem_l_discount_2#6821, cval_lineitem_l_tax#6789 AS cval_lineitem_l_tax_2#6822, cval_lineitem_l_returnflag#6790 AS cval_lineitem_l_returnflag_2#6823, cval_lineitem_l_linestatus#6791 AS cval_lineitem_l_linestatus_2#6824, cval_lineitem_l_commitdate#6792 AS cval_lineitem_l_commitdate_2#6825, cval_lineitem_l_receiptdate#6793 AS cval_lineitem_l_receiptdate_2#6826, cval_lineitem_l_shipinstruct#6794 AS cval_lineitem_l_shipinstruct_2#6827, cval_lineitem_l_shipmode#6795 AS cval_lineitem_l_shipmode_2#6828, cval_lineitem_l_comment#6796 AS cval_lineitem_l_comment_2#6829, cval_lineitem_l_shipdate#6797 AS cval_lineitem_l_shipdate_2#6830, cl_quantity#6798 AS cl_quantity_2#6831, cl_extendedprice#6799 AS cl_extendedprice_2#6832, cl_discount#6800 AS cl_discount_2#6833, ... 9 more fields]
            +- Relation[rid#6777,cpfk_orders_lineitem#6778,cpfk_supplier_lineitem#6779,cfpk_lineitem_supplier#6780,cfpk_lineitem_partsupp#6781,cpfk_part_lineitem#6782,cfpk_lineitem_part#6783,cpfk_partsupp_lineitem#6784,cfpk_lineitem_orders#6785,cval_lineitem_l_quantity#6786,cval_lineitem_l_extendedprice#6787,cval_lineitem_l_discount#6788,cval_lineitem_l_tax#6789,cval_lineitem_l_returnflag#6790,cval_lineitem_l_linestatus#6791,cval_lineitem_l_commitdate#6792,cval_lineitem_l_receiptdate#6793,cval_lineitem_l_shipinstruct#6794,cval_lineitem_l_shipmode#6795,cval_lineitem_l_comment#6796,cval_lineitem_l_shipdate#6797,cl_quantity#6798,cl_extendedprice#6799,cl_discount#6800,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 132576ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/15 16:07:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:07:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7015L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:07:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:07:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:07:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:07:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7015L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#7017 AS rid_0#7030, cpfk_nation_supplier#7018 AS cpfk_nation_supplier_0#7031, cfpk_supplier_nation#7019 AS cfpk_supplier_nation_0#7032, cval_supplier_s_name#7020 AS cval_supplier_s_name_0#7033, cval_supplier_s_address#7021 AS cval_supplier_s_address_0#7034, cval_supplier_s_phone#7022 AS cval_supplier_s_phone_0#7035, cval_supplier_s_acctbal#7023 AS cval_supplier_s_acctbal_0#7036, cval_supplier_s_comment#7024 AS cval_supplier_s_comment_0#7037, cs_name#7025 AS cs_name_0#7038, cs_address#7026 AS cs_address_0#7039, cs_phone#7027 AS cs_phone_0#7040, cs_acctbal#7028 AS cs_acctbal_0#7041, cs_comment#7029 AS cs_comment_0#7042]
         :  :  +- Relation[rid#7017,cpfk_nation_supplier#7018,cfpk_supplier_nation#7019,cval_supplier_s_name#7020,cval_supplier_s_address#7021,cval_supplier_s_phone#7022,cval_supplier_s_acctbal#7023,cval_supplier_s_comment#7024,cs_name#7025,cs_address#7026,cs_phone#7027,cs_acctbal#7028,cs_comment#7029] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#7109 AS rid_0#7122, cpfk_nation_supplier#7110 AS cpfk_nation_supplier_0#7123, cfpk_supplier_nation#7111 AS cfpk_supplier_nation_0#7124, cval_supplier_s_name#7112 AS cval_supplier_s_name_0#7125, cval_supplier_s_address#7113 AS cval_supplier_s_address_0#7126, cval_supplier_s_phone#7114 AS cval_supplier_s_phone_0#7127, cval_supplier_s_acctbal#7115 AS cval_supplier_s_acctbal_0#7128, cval_supplier_s_comment#7116 AS cval_supplier_s_comment_0#7129, cs_name#7117 AS cs_name_0#7130, cs_address#7118 AS cs_address_0#7131, cs_phone#7119 AS cs_phone_0#7132, cs_acctbal#7120 AS cs_acctbal_0#7133, cs_comment#7121 AS cs_comment_0#7134]
         :     :  +- Relation[rid#7109,cpfk_nation_supplier#7110,cfpk_supplier_nation#7111,cval_supplier_s_name#7112,cval_supplier_s_address#7113,cval_supplier_s_phone#7114,cval_supplier_s_acctbal#7115,cval_supplier_s_comment#7116,cs_name#7117,cs_address#7118,cs_phone#7119,cs_acctbal#7120,cs_comment#7121] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#7135 AS rid_1#7168, cpfk_orders_lineitem#7136 AS cpfk_orders_lineitem_1#7169, cpfk_supplier_lineitem#7137 AS cpfk_supplier_lineitem_1#7170, cfpk_lineitem_supplier#7138 AS cfpk_lineitem_supplier_1#7171, cfpk_lineitem_partsupp#7139 AS cfpk_lineitem_partsupp_1#7172, cpfk_part_lineitem#7140 AS cpfk_part_lineitem_1#7173, cfpk_lineitem_part#7141 AS cfpk_lineitem_part_1#7174, cpfk_partsupp_lineitem#7142 AS cpfk_partsupp_lineitem_1#7175, cfpk_lineitem_orders#7143 AS cfpk_lineitem_orders_1#7176, cval_lineitem_l_quantity#7144 AS cval_lineitem_l_quantity_1#7177, cval_lineitem_l_extendedprice#7145 AS cval_lineitem_l_extendedprice_1#7178, cval_lineitem_l_discount#7146 AS cval_lineitem_l_discount_1#7179, cval_lineitem_l_tax#7147 AS cval_lineitem_l_tax_1#7180, cval_lineitem_l_returnflag#7148 AS cval_lineitem_l_returnflag_1#7181, cval_lineitem_l_linestatus#7149 AS cval_lineitem_l_linestatus_1#7182, cval_lineitem_l_commitdate#7150 AS cval_lineitem_l_commitdate_1#7183, cval_lineitem_l_receiptdate#7151 AS cval_lineitem_l_receiptdate_1#7184, cval_lineitem_l_shipinstruct#7152 AS cval_lineitem_l_shipinstruct_1#7185, cval_lineitem_l_shipmode#7153 AS cval_lineitem_l_shipmode_1#7186, cval_lineitem_l_comment#7154 AS cval_lineitem_l_comment_1#7187, cval_lineitem_l_shipdate#7155 AS cval_lineitem_l_shipdate_1#7188, cl_quantity#7156 AS cl_quantity_1#7189, cl_extendedprice#7157 AS cl_extendedprice_1#7190, cl_discount#7158 AS cl_discount_1#7191, ... 9 more fields]
         :        +- Relation[rid#7135,cpfk_orders_lineitem#7136,cpfk_supplier_lineitem#7137,cfpk_lineitem_supplier#7138,cfpk_lineitem_partsupp#7139,cpfk_part_lineitem#7140,cfpk_lineitem_part#7141,cpfk_partsupp_lineitem#7142,cfpk_lineitem_orders#7143,cval_lineitem_l_quantity#7144,cval_lineitem_l_extendedprice#7145,cval_lineitem_l_discount#7146,cval_lineitem_l_tax#7147,cval_lineitem_l_returnflag#7148,cval_lineitem_l_linestatus#7149,cval_lineitem_l_commitdate#7150,cval_lineitem_l_receiptdate#7151,cval_lineitem_l_shipinstruct#7152,cval_lineitem_l_shipmode#7153,cval_lineitem_l_comment#7154,cval_lineitem_l_shipdate#7155,cl_quantity#7156,cl_extendedprice#7157,cl_discount#7158,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7043 AS rid_1#7076, cpfk_orders_lineitem#7044 AS cpfk_orders_lineitem_1#7077, cpfk_supplier_lineitem#7045 AS cpfk_supplier_lineitem_1#7078, cfpk_lineitem_supplier#7046 AS cfpk_lineitem_supplier_1#7079, cfpk_lineitem_partsupp#7047 AS cfpk_lineitem_partsupp_1#7080, cpfk_part_lineitem#7048 AS cpfk_part_lineitem_1#7081, cfpk_lineitem_part#7049 AS cfpk_lineitem_part_1#7082, cpfk_partsupp_lineitem#7050 AS cpfk_partsupp_lineitem_1#7083, cfpk_lineitem_orders#7051 AS cfpk_lineitem_orders_1#7084, cval_lineitem_l_quantity#7052 AS cval_lineitem_l_quantity_1#7085, cval_lineitem_l_extendedprice#7053 AS cval_lineitem_l_extendedprice_1#7086, cval_lineitem_l_discount#7054 AS cval_lineitem_l_discount_1#7087, cval_lineitem_l_tax#7055 AS cval_lineitem_l_tax_1#7088, cval_lineitem_l_returnflag#7056 AS cval_lineitem_l_returnflag_1#7089, cval_lineitem_l_linestatus#7057 AS cval_lineitem_l_linestatus_1#7090, cval_lineitem_l_commitdate#7058 AS cval_lineitem_l_commitdate_1#7091, cval_lineitem_l_receiptdate#7059 AS cval_lineitem_l_receiptdate_1#7092, cval_lineitem_l_shipinstruct#7060 AS cval_lineitem_l_shipinstruct_1#7093, cval_lineitem_l_shipmode#7061 AS cval_lineitem_l_shipmode_1#7094, cval_lineitem_l_comment#7062 AS cval_lineitem_l_comment_1#7095, cval_lineitem_l_shipdate#7063 AS cval_lineitem_l_shipdate_1#7096, cl_quantity#7064 AS cl_quantity_1#7097, cl_extendedprice#7065 AS cl_extendedprice_1#7098, cl_discount#7066 AS cl_discount_1#7099, ... 9 more fields]
            +- Relation[rid#7043,cpfk_orders_lineitem#7044,cpfk_supplier_lineitem#7045,cfpk_lineitem_supplier#7046,cfpk_lineitem_partsupp#7047,cpfk_part_lineitem#7048,cfpk_lineitem_part#7049,cpfk_partsupp_lineitem#7050,cfpk_lineitem_orders#7051,cval_lineitem_l_quantity#7052,cval_lineitem_l_extendedprice#7053,cval_lineitem_l_discount#7054,cval_lineitem_l_tax#7055,cval_lineitem_l_returnflag#7056,cval_lineitem_l_linestatus#7057,cval_lineitem_l_commitdate#7058,cval_lineitem_l_receiptdate#7059,cval_lineitem_l_shipinstruct#7060,cval_lineitem_l_shipmode#7061,cval_lineitem_l_comment#7062,cval_lineitem_l_shipdate#7063,cl_quantity#7064,cl_extendedprice#7065,cl_discount#7066,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 90675ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/15 16:08:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:08:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7255L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:08:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7255L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#7257 AS rid_0#7264, cpfk_region_nation#7258 AS cpfk_region_nation_0#7265, cfpk_nation_region#7259 AS cfpk_nation_region_0#7266, cval_nation_n_name#7260 AS cval_nation_n_name_0#7267, cval_nation_n_comment#7261 AS cval_nation_n_comment_0#7268, cn_name#7262 AS cn_name_0#7269, cn_comment#7263 AS cn_comment_0#7270]
            :  :  :  :  :  :  +- Relation[rid#7257,cpfk_region_nation#7258,cfpk_nation_region#7259,cval_nation_n_name#7260,cval_nation_n_comment#7261,cn_name#7262,cn_comment#7263] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#7271 AS rid_0#7278, cpfk_region_nation#7272 AS cpfk_region_nation_0#7279, cfpk_nation_region#7273 AS cfpk_nation_region_0#7280, cval_nation_n_name#7274 AS cval_nation_n_name_0#7281, cval_nation_n_comment#7275 AS cval_nation_n_comment_0#7282, cn_name#7276 AS cn_name_0#7283, cn_comment#7277 AS cn_comment_0#7284]
            :  :  :  :  :        +- Relation[rid#7271,cpfk_region_nation#7272,cfpk_nation_region#7273,cval_nation_n_name#7274,cval_nation_n_comment#7275,cn_name#7276,cn_comment#7277] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- Project [rid#7325 AS rid_1#7338, cpfk_nation_supplier#7326 AS cpfk_nation_supplier_1#7339, cfpk_supplier_nation#7327 AS cfpk_supplier_nation_1#7340, cval_supplier_s_name#7328 AS cval_supplier_s_name_1#7341, cval_supplier_s_address#7329 AS cval_supplier_s_address_1#7342, cval_supplier_s_phone#7330 AS cval_supplier_s_phone_1#7343, cval_supplier_s_acctbal#7331 AS cval_supplier_s_acctbal_1#7344, cval_supplier_s_comment#7332 AS cval_supplier_s_comment_1#7345, cs_name#7333 AS cs_name_1#7346, cs_address#7334 AS cs_address_1#7347, cs_phone#7335 AS cs_phone_1#7348, cs_acctbal#7336 AS cs_acctbal_1#7349, cs_comment#7337 AS cs_comment_1#7350]
            :  :  :  :     +- Relation[rid#7325,cpfk_nation_supplier#7326,cfpk_supplier_nation#7327,cval_supplier_s_name#7328,cval_supplier_s_address#7329,cval_supplier_s_phone#7330,cval_supplier_s_acctbal#7331,cval_supplier_s_comment#7332,cs_name#7333,cs_address#7334,cs_phone#7335,cs_acctbal#7336,cs_comment#7337] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#7285 AS rid_1#7298, cpfk_nation_supplier#7286 AS cpfk_nation_supplier_1#7299, cfpk_supplier_nation#7287 AS cfpk_supplier_nation_1#7300, cval_supplier_s_name#7288 AS cval_supplier_s_name_1#7301, cval_supplier_s_address#7289 AS cval_supplier_s_address_1#7302, cval_supplier_s_phone#7290 AS cval_supplier_s_phone_1#7303, cval_supplier_s_acctbal#7291 AS cval_supplier_s_acctbal_1#7304, cval_supplier_s_comment#7292 AS cval_supplier_s_comment_1#7305, cs_name#7293 AS cs_name_1#7306, cs_address#7294 AS cs_address_1#7307, cs_phone#7295 AS cs_phone_1#7308, cs_acctbal#7296 AS cs_acctbal_1#7309, cs_comment#7297 AS cs_comment_1#7310]
            :  :  :     +- Relation[rid#7285,cpfk_nation_supplier#7286,cfpk_supplier_nation#7287,cval_supplier_s_name#7288,cval_supplier_s_address#7289,cval_supplier_s_phone#7290,cval_supplier_s_acctbal#7291,cval_supplier_s_comment#7292,cs_name#7293,cs_address#7294,cs_phone#7295,cs_acctbal#7296,cs_comment#7297] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- Project [rid#7443 AS rid_2#7476, cpfk_orders_lineitem#7444 AS cpfk_orders_lineitem_2#7477, cpfk_supplier_lineitem#7445 AS cpfk_supplier_lineitem_2#7478, cfpk_lineitem_supplier#7446 AS cfpk_lineitem_supplier_2#7479, cfpk_lineitem_partsupp#7447 AS cfpk_lineitem_partsupp_2#7480, cpfk_part_lineitem#7448 AS cpfk_part_lineitem_2#7481, cfpk_lineitem_part#7449 AS cfpk_lineitem_part_2#7482, cpfk_partsupp_lineitem#7450 AS cpfk_partsupp_lineitem_2#7483, cfpk_lineitem_orders#7451 AS cfpk_lineitem_orders_2#7484, cval_lineitem_l_quantity#7452 AS cval_lineitem_l_quantity_2#7485, cval_lineitem_l_extendedprice#7453 AS cval_lineitem_l_extendedprice_2#7486, cval_lineitem_l_discount#7454 AS cval_lineitem_l_discount_2#7487, cval_lineitem_l_tax#7455 AS cval_lineitem_l_tax_2#7488, cval_lineitem_l_returnflag#7456 AS cval_lineitem_l_returnflag_2#7489, cval_lineitem_l_linestatus#7457 AS cval_lineitem_l_linestatus_2#7490, cval_lineitem_l_commitdate#7458 AS cval_lineitem_l_commitdate_2#7491, cval_lineitem_l_receiptdate#7459 AS cval_lineitem_l_receiptdate_2#7492, cval_lineitem_l_shipinstruct#7460 AS cval_lineitem_l_shipinstruct_2#7493, cval_lineitem_l_shipmode#7461 AS cval_lineitem_l_shipmode_2#7494, cval_lineitem_l_comment#7462 AS cval_lineitem_l_comment_2#7495, cval_lineitem_l_shipdate#7463 AS cval_lineitem_l_shipdate_2#7496, cl_quantity#7464 AS cl_quantity_2#7497, cl_extendedprice#7465 AS cl_extendedprice_2#7498, cl_discount#7466 AS cl_discount_2#7499, ... 9 more fields]
            :  :     +- Relation[rid#7443,cpfk_orders_lineitem#7444,cpfk_supplier_lineitem#7445,cfpk_lineitem_supplier#7446,cfpk_lineitem_partsupp#7447,cpfk_part_lineitem#7448,cfpk_lineitem_part#7449,cpfk_partsupp_lineitem#7450,cfpk_lineitem_orders#7451,cval_lineitem_l_quantity#7452,cval_lineitem_l_extendedprice#7453,cval_lineitem_l_discount#7454,cval_lineitem_l_tax#7455,cval_lineitem_l_returnflag#7456,cval_lineitem_l_linestatus#7457,cval_lineitem_l_commitdate#7458,cval_lineitem_l_receiptdate#7459,cval_lineitem_l_shipinstruct#7460,cval_lineitem_l_shipmode#7461,cval_lineitem_l_comment#7462,cval_lineitem_l_shipdate#7463,cl_quantity#7464,cl_extendedprice#7465,cl_discount#7466,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#7351 AS rid_2#7384, cpfk_orders_lineitem#7352 AS cpfk_orders_lineitem_2#7385, cpfk_supplier_lineitem#7353 AS cpfk_supplier_lineitem_2#7386, cfpk_lineitem_supplier#7354 AS cfpk_lineitem_supplier_2#7387, cfpk_lineitem_partsupp#7355 AS cfpk_lineitem_partsupp_2#7388, cpfk_part_lineitem#7356 AS cpfk_part_lineitem_2#7389, cfpk_lineitem_part#7357 AS cfpk_lineitem_part_2#7390, cpfk_partsupp_lineitem#7358 AS cpfk_partsupp_lineitem_2#7391, cfpk_lineitem_orders#7359 AS cfpk_lineitem_orders_2#7392, cval_lineitem_l_quantity#7360 AS cval_lineitem_l_quantity_2#7393, cval_lineitem_l_extendedprice#7361 AS cval_lineitem_l_extendedprice_2#7394, cval_lineitem_l_discount#7362 AS cval_lineitem_l_discount_2#7395, cval_lineitem_l_tax#7363 AS cval_lineitem_l_tax_2#7396, cval_lineitem_l_returnflag#7364 AS cval_lineitem_l_returnflag_2#7397, cval_lineitem_l_linestatus#7365 AS cval_lineitem_l_linestatus_2#7398, cval_lineitem_l_commitdate#7366 AS cval_lineitem_l_commitdate_2#7399, cval_lineitem_l_receiptdate#7367 AS cval_lineitem_l_receiptdate_2#7400, cval_lineitem_l_shipinstruct#7368 AS cval_lineitem_l_shipinstruct_2#7401, cval_lineitem_l_shipmode#7369 AS cval_lineitem_l_shipmode_2#7402, cval_lineitem_l_comment#7370 AS cval_lineitem_l_comment_2#7403, cval_lineitem_l_shipdate#7371 AS cval_lineitem_l_shipdate_2#7404, cl_quantity#7372 AS cl_quantity_2#7405, cl_extendedprice#7373 AS cl_extendedprice_2#7406, cl_discount#7374 AS cl_discount_2#7407, ... 9 more fields]
            :     +- Relation[rid#7351,cpfk_orders_lineitem#7352,cpfk_supplier_lineitem#7353,cfpk_lineitem_supplier#7354,cfpk_lineitem_partsupp#7355,cpfk_part_lineitem#7356,cfpk_lineitem_part#7357,cpfk_partsupp_lineitem#7358,cfpk_lineitem_orders#7359,cval_lineitem_l_quantity#7360,cval_lineitem_l_extendedprice#7361,cval_lineitem_l_discount#7362,cval_lineitem_l_tax#7363,cval_lineitem_l_returnflag#7364,cval_lineitem_l_linestatus#7365,cval_lineitem_l_commitdate#7366,cval_lineitem_l_receiptdate#7367,cval_lineitem_l_shipinstruct#7368,cval_lineitem_l_shipmode#7369,cval_lineitem_l_comment#7370,cval_lineitem_l_shipdate#7371,cl_quantity#7372,cl_extendedprice#7373,cl_discount#7374,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#7509 AS rid_3#7516, cpfk_region_nation#7510 AS cpfk_region_nation_3#7517, cfpk_nation_region#7511 AS cfpk_nation_region_3#7518, cval_nation_n_name#7512 AS cval_nation_n_name_3#7519, cval_nation_n_comment#7513 AS cval_nation_n_comment_3#7520, cn_name#7514 AS cn_name_3#7521, cn_comment#7515 AS cn_comment_3#7522]
               :  :  :  :  :  +- Relation[rid#7509,cpfk_region_nation#7510,cfpk_nation_region#7511,cval_nation_n_name#7512,cval_nation_n_comment#7513,cn_name#7514,cn_comment#7515] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#7523 AS rid_3#7530, cpfk_region_nation#7524 AS cpfk_region_nation_3#7531, cfpk_nation_region#7525 AS cfpk_nation_region_3#7532, cval_nation_n_name#7526 AS cval_nation_n_name_3#7533, cval_nation_n_comment#7527 AS cval_nation_n_comment_3#7534, cn_name#7528 AS cn_name_3#7535, cn_comment#7529 AS cn_comment_3#7536]
               :  :  :  :        +- Relation[rid#7523,cpfk_region_nation#7524,cfpk_nation_region#7525,cval_nation_n_name#7526,cval_nation_n_comment#7527,cn_name#7528,cn_comment#7529] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- Project [rid#7581 AS rid_4#7596, cpfk_nation_customer#7582 AS cpfk_nation_customer_4#7597, cfpk_customer_nation#7583 AS cfpk_customer_nation_4#7598, cval_customer_c_name#7584 AS cval_customer_c_name_4#7599, cval_customer_c_address#7585 AS cval_customer_c_address_4#7600, cval_customer_c_phone#7586 AS cval_customer_c_phone_4#7601, cval_customer_c_acctbal#7587 AS cval_customer_c_acctbal_4#7602, cval_customer_c_comment#7588 AS cval_customer_c_comment_4#7603, cval_customer_c_mktsegment#7589 AS cval_customer_c_mktsegment_4#7604, cc_name#7590 AS cc_name_4#7605, cc_address#7591 AS cc_address_4#7606, cc_phone#7592 AS cc_phone_4#7607, cc_acctbal#7593 AS cc_acctbal_4#7608, cc_comment#7594 AS cc_comment_4#7609, cc_mktsegment#7595 AS cc_mktsegment_4#7610]
               :  :  :     +- Relation[rid#7581,cpfk_nation_customer#7582,cfpk_customer_nation#7583,cval_customer_c_name#7584,cval_customer_c_address#7585,cval_customer_c_phone#7586,cval_customer_c_acctbal#7587,cval_customer_c_comment#7588,cval_customer_c_mktsegment#7589,cc_name#7590,cc_address#7591,cc_phone#7592,cc_acctbal#7593,cc_comment#7594,cc_mktsegment#7595] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#7537 AS rid_4#7552, cpfk_nation_customer#7538 AS cpfk_nation_customer_4#7553, cfpk_customer_nation#7539 AS cfpk_customer_nation_4#7554, cval_customer_c_name#7540 AS cval_customer_c_name_4#7555, cval_customer_c_address#7541 AS cval_customer_c_address_4#7556, cval_customer_c_phone#7542 AS cval_customer_c_phone_4#7557, cval_customer_c_acctbal#7543 AS cval_customer_c_acctbal_4#7558, cval_customer_c_comment#7544 AS cval_customer_c_comment_4#7559, cval_customer_c_mktsegment#7545 AS cval_customer_c_mktsegment_4#7560, cc_name#7546 AS cc_name_4#7561, cc_address#7547 AS cc_address_4#7562, cc_phone#7548 AS cc_phone_4#7563, cc_acctbal#7549 AS cc_acctbal_4#7564, cc_comment#7550 AS cc_comment_4#7565, cc_mktsegment#7551 AS cc_mktsegment_4#7566]
               :  :     +- Relation[rid#7537,cpfk_nation_customer#7538,cfpk_customer_nation#7539,cval_customer_c_name#7540,cval_customer_c_address#7541,cval_customer_c_phone#7542,cval_customer_c_acctbal#7543,cval_customer_c_comment#7544,cval_customer_c_mktsegment#7545,cc_name#7546,cc_address#7547,cc_phone#7548,cc_acctbal#7549,cc_comment#7550,cc_mktsegment#7551] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- Project [rid#7675 AS rid_5#7692, cpfk_customer_orders#7676 AS cpfk_customer_orders_5#7693, cfpk_orders_customer#7677 AS cfpk_orders_customer_5#7694, cval_orders_o_orderstatus#7678 AS cval_orders_o_orderstatus_5#7695, cval_orders_o_totalprice#7679 AS cval_orders_o_totalprice_5#7696, cval_orders_o_orderpriority#7680 AS cval_orders_o_orderpriority_5#7697, cval_orders_o_clerk#7681 AS cval_orders_o_clerk_5#7698, cval_orders_o_shippriority#7682 AS cval_orders_o_shippriority_5#7699, cval_orders_o_comment#7683 AS cval_orders_o_comment_5#7700, cval_orders_o_orderdate#7684 AS cval_orders_o_orderdate_5#7701, co_orderstatus#7685 AS co_orderstatus_5#7702, co_totalprice#7686 AS co_totalprice_5#7703, co_orderpriority#7687 AS co_orderpriority_5#7704, co_clerk#7688 AS co_clerk_5#7705, co_shippriority#7689 AS co_shippriority_5#7706, co_comment#7690 AS co_comment_5#7707, co_orderdate#7691 AS co_orderdate_5#7708]
               :     +- Relation[rid#7675,cpfk_customer_orders#7676,cfpk_orders_customer#7677,cval_orders_o_orderstatus#7678,cval_orders_o_totalprice#7679,cval_orders_o_orderpriority#7680,cval_orders_o_clerk#7681,cval_orders_o_shippriority#7682,cval_orders_o_comment#7683,cval_orders_o_orderdate#7684,co_orderstatus#7685,co_totalprice#7686,co_orderpriority#7687,co_clerk#7688,co_shippriority#7689,co_comment#7690,co_orderdate#7691] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#7611 AS rid_5#7628, cpfk_customer_orders#7612 AS cpfk_customer_orders_5#7629, cfpk_orders_customer#7613 AS cfpk_orders_customer_5#7630, cval_orders_o_orderstatus#7614 AS cval_orders_o_orderstatus_5#7631, cval_orders_o_totalprice#7615 AS cval_orders_o_totalprice_5#7632, cval_orders_o_orderpriority#7616 AS cval_orders_o_orderpriority_5#7633, cval_orders_o_clerk#7617 AS cval_orders_o_clerk_5#7634, cval_orders_o_shippriority#7618 AS cval_orders_o_shippriority_5#7635, cval_orders_o_comment#7619 AS cval_orders_o_comment_5#7636, cval_orders_o_orderdate#7620 AS cval_orders_o_orderdate_5#7637, co_orderstatus#7621 AS co_orderstatus_5#7638, co_totalprice#7622 AS co_totalprice_5#7639, co_orderpriority#7623 AS co_orderpriority_5#7640, co_clerk#7624 AS co_clerk_5#7641, co_shippriority#7625 AS co_shippriority_5#7642, co_comment#7626 AS co_comment_5#7643, co_orderdate#7627 AS co_orderdate_5#7644]
                  +- Relation[rid#7611,cpfk_customer_orders#7612,cfpk_orders_customer#7613,cval_orders_o_orderstatus#7614,cval_orders_o_totalprice#7615,cval_orders_o_orderpriority#7616,cval_orders_o_clerk#7617,cval_orders_o_shippriority#7618,cval_orders_o_comment#7619,cval_orders_o_orderdate#7620,co_orderstatus#7621,co_totalprice#7622,co_orderpriority#7623,co_clerk#7624,co_shippriority#7625,co_comment#7626,co_orderdate#7627] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 370ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 16:08:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:08:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7810L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:08:51 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:08:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7810L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#7812 AS rid_0#7819, cpfk_region_nation#7813 AS cpfk_region_nation_0#7820, cfpk_nation_region#7814 AS cfpk_nation_region_0#7821, cval_nation_n_name#7815 AS cval_nation_n_name_0#7822, cval_nation_n_comment#7816 AS cval_nation_n_comment_0#7823, cn_name#7817 AS cn_name_0#7824, cn_comment#7818 AS cn_comment_0#7825]
            :     :     :  :  :  :  :  +- Relation[rid#7812,cpfk_region_nation#7813,cfpk_nation_region#7814,cval_nation_n_name#7815,cval_nation_n_comment#7816,cn_name#7817,cn_comment#7818] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#7852 AS rid_0#7859, cpfk_region_nation#7853 AS cpfk_region_nation_0#7860, cfpk_nation_region#7854 AS cfpk_nation_region_0#7861, cval_nation_n_name#7855 AS cval_nation_n_name_0#7862, cval_nation_n_comment#7856 AS cval_nation_n_comment_0#7863, cn_name#7857 AS cn_name_0#7864, cn_comment#7858 AS cn_comment_0#7865]
            :     :     :  :  :  :     :  +- Relation[rid#7852,cpfk_region_nation#7853,cfpk_nation_region#7854,cval_nation_n_name#7855,cval_nation_n_comment#7856,cn_name#7857,cn_comment#7858] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#7866 AS rid_1#7879, cpfk_nation_supplier#7867 AS cpfk_nation_supplier_1#7880, cfpk_supplier_nation#7868 AS cfpk_supplier_nation_1#7881, cval_supplier_s_name#7869 AS cval_supplier_s_name_1#7882, cval_supplier_s_address#7870 AS cval_supplier_s_address_1#7883, cval_supplier_s_phone#7871 AS cval_supplier_s_phone_1#7884, cval_supplier_s_acctbal#7872 AS cval_supplier_s_acctbal_1#7885, cval_supplier_s_comment#7873 AS cval_supplier_s_comment_1#7886, cs_name#7874 AS cs_name_1#7887, cs_address#7875 AS cs_address_1#7888, cs_phone#7876 AS cs_phone_1#7889, cs_acctbal#7877 AS cs_acctbal_1#7890, cs_comment#7878 AS cs_comment_1#7891]
            :     :     :  :  :  :        +- Relation[rid#7866,cpfk_nation_supplier#7867,cfpk_supplier_nation#7868,cval_supplier_s_name#7869,cval_supplier_s_address#7870,cval_supplier_s_phone#7871,cval_supplier_s_acctbal#7872,cval_supplier_s_comment#7873,cs_name#7874,cs_address#7875,cs_phone#7876,cs_acctbal#7877,cs_comment#7878] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#7826 AS rid_1#7839, cpfk_nation_supplier#7827 AS cpfk_nation_supplier_1#7840, cfpk_supplier_nation#7828 AS cfpk_supplier_nation_1#7841, cval_supplier_s_name#7829 AS cval_supplier_s_name_1#7842, cval_supplier_s_address#7830 AS cval_supplier_s_address_1#7843, cval_supplier_s_phone#7831 AS cval_supplier_s_phone_1#7844, cval_supplier_s_acctbal#7832 AS cval_supplier_s_acctbal_1#7845, cval_supplier_s_comment#7833 AS cval_supplier_s_comment_1#7846, cs_name#7834 AS cs_name_1#7847, cs_address#7835 AS cs_address_1#7848, cs_phone#7836 AS cs_phone_1#7849, cs_acctbal#7837 AS cs_acctbal_1#7850, cs_comment#7838 AS cs_comment_1#7851]
            :     :     :  :  :     +- Relation[rid#7826,cpfk_nation_supplier#7827,cfpk_supplier_nation#7828,cval_supplier_s_name#7829,cval_supplier_s_address#7830,cval_supplier_s_phone#7831,cval_supplier_s_acctbal#7832,cval_supplier_s_comment#7833,cs_name#7834,cs_address#7835,cs_phone#7836,cs_acctbal#7837,cs_comment#7838] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#7958 AS rid_1#7971, cpfk_nation_supplier#7959 AS cpfk_nation_supplier_1#7972, cfpk_supplier_nation#7960 AS cfpk_supplier_nation_1#7973, cval_supplier_s_name#7961 AS cval_supplier_s_name_1#7974, cval_supplier_s_address#7962 AS cval_supplier_s_address_1#7975, cval_supplier_s_phone#7963 AS cval_supplier_s_phone_1#7976, cval_supplier_s_acctbal#7964 AS cval_supplier_s_acctbal_1#7977, cval_supplier_s_comment#7965 AS cval_supplier_s_comment_1#7978, cs_name#7966 AS cs_name_1#7979, cs_address#7967 AS cs_address_1#7980, cs_phone#7968 AS cs_phone_1#7981, cs_acctbal#7969 AS cs_acctbal_1#7982, cs_comment#7970 AS cs_comment_1#7983]
            :     :     :  :     :  +- Relation[rid#7958,cpfk_nation_supplier#7959,cfpk_supplier_nation#7960,cval_supplier_s_name#7961,cval_supplier_s_address#7962,cval_supplier_s_phone#7963,cval_supplier_s_acctbal#7964,cval_supplier_s_comment#7965,cs_name#7966,cs_address#7967,cs_phone#7968,cs_acctbal#7969,cs_comment#7970] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#7984 AS rid_2#8017, cpfk_orders_lineitem#7985 AS cpfk_orders_lineitem_2#8018, cpfk_supplier_lineitem#7986 AS cpfk_supplier_lineitem_2#8019, cfpk_lineitem_supplier#7987 AS cfpk_lineitem_supplier_2#8020, cfpk_lineitem_partsupp#7988 AS cfpk_lineitem_partsupp_2#8021, cpfk_part_lineitem#7989 AS cpfk_part_lineitem_2#8022, cfpk_lineitem_part#7990 AS cfpk_lineitem_part_2#8023, cpfk_partsupp_lineitem#7991 AS cpfk_partsupp_lineitem_2#8024, cfpk_lineitem_orders#7992 AS cfpk_lineitem_orders_2#8025, cval_lineitem_l_quantity#7993 AS cval_lineitem_l_quantity_2#8026, cval_lineitem_l_extendedprice#7994 AS cval_lineitem_l_extendedprice_2#8027, cval_lineitem_l_discount#7995 AS cval_lineitem_l_discount_2#8028, cval_lineitem_l_tax#7996 AS cval_lineitem_l_tax_2#8029, cval_lineitem_l_returnflag#7997 AS cval_lineitem_l_returnflag_2#8030, cval_lineitem_l_linestatus#7998 AS cval_lineitem_l_linestatus_2#8031, cval_lineitem_l_commitdate#7999 AS cval_lineitem_l_commitdate_2#8032, cval_lineitem_l_receiptdate#8000 AS cval_lineitem_l_receiptdate_2#8033, cval_lineitem_l_shipinstruct#8001 AS cval_lineitem_l_shipinstruct_2#8034, cval_lineitem_l_shipmode#8002 AS cval_lineitem_l_shipmode_2#8035, cval_lineitem_l_comment#8003 AS cval_lineitem_l_comment_2#8036, cval_lineitem_l_shipdate#8004 AS cval_lineitem_l_shipdate_2#8037, cl_quantity#8005 AS cl_quantity_2#8038, cl_extendedprice#8006 AS cl_extendedprice_2#8039, cl_discount#8007 AS cl_discount_2#8040, ... 9 more fields]
            :     :     :  :        +- Relation[rid#7984,cpfk_orders_lineitem#7985,cpfk_supplier_lineitem#7986,cfpk_lineitem_supplier#7987,cfpk_lineitem_partsupp#7988,cpfk_part_lineitem#7989,cfpk_lineitem_part#7990,cpfk_partsupp_lineitem#7991,cfpk_lineitem_orders#7992,cval_lineitem_l_quantity#7993,cval_lineitem_l_extendedprice#7994,cval_lineitem_l_discount#7995,cval_lineitem_l_tax#7996,cval_lineitem_l_returnflag#7997,cval_lineitem_l_linestatus#7998,cval_lineitem_l_commitdate#7999,cval_lineitem_l_receiptdate#8000,cval_lineitem_l_shipinstruct#8001,cval_lineitem_l_shipmode#8002,cval_lineitem_l_comment#8003,cval_lineitem_l_shipdate#8004,cl_quantity#8005,cl_extendedprice#8006,cl_discount#8007,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#7892 AS rid_2#7925, cpfk_orders_lineitem#7893 AS cpfk_orders_lineitem_2#7926, cpfk_supplier_lineitem#7894 AS cpfk_supplier_lineitem_2#7927, cfpk_lineitem_supplier#7895 AS cfpk_lineitem_supplier_2#7928, cfpk_lineitem_partsupp#7896 AS cfpk_lineitem_partsupp_2#7929, cpfk_part_lineitem#7897 AS cpfk_part_lineitem_2#7930, cfpk_lineitem_part#7898 AS cfpk_lineitem_part_2#7931, cpfk_partsupp_lineitem#7899 AS cpfk_partsupp_lineitem_2#7932, cfpk_lineitem_orders#7900 AS cfpk_lineitem_orders_2#7933, cval_lineitem_l_quantity#7901 AS cval_lineitem_l_quantity_2#7934, cval_lineitem_l_extendedprice#7902 AS cval_lineitem_l_extendedprice_2#7935, cval_lineitem_l_discount#7903 AS cval_lineitem_l_discount_2#7936, cval_lineitem_l_tax#7904 AS cval_lineitem_l_tax_2#7937, cval_lineitem_l_returnflag#7905 AS cval_lineitem_l_returnflag_2#7938, cval_lineitem_l_linestatus#7906 AS cval_lineitem_l_linestatus_2#7939, cval_lineitem_l_commitdate#7907 AS cval_lineitem_l_commitdate_2#7940, cval_lineitem_l_receiptdate#7908 AS cval_lineitem_l_receiptdate_2#7941, cval_lineitem_l_shipinstruct#7909 AS cval_lineitem_l_shipinstruct_2#7942, cval_lineitem_l_shipmode#7910 AS cval_lineitem_l_shipmode_2#7943, cval_lineitem_l_comment#7911 AS cval_lineitem_l_comment_2#7944, cval_lineitem_l_shipdate#7912 AS cval_lineitem_l_shipdate_2#7945, cl_quantity#7913 AS cl_quantity_2#7946, cl_extendedprice#7914 AS cl_extendedprice_2#7947, cl_discount#7915 AS cl_discount_2#7948, ... 9 more fields]
            :     :     :     +- Relation[rid#7892,cpfk_orders_lineitem#7893,cpfk_supplier_lineitem#7894,cfpk_lineitem_supplier#7895,cfpk_lineitem_partsupp#7896,cpfk_part_lineitem#7897,cfpk_lineitem_part#7898,cpfk_partsupp_lineitem#7899,cfpk_lineitem_orders#7900,cval_lineitem_l_quantity#7901,cval_lineitem_l_extendedprice#7902,cval_lineitem_l_discount#7903,cval_lineitem_l_tax#7904,cval_lineitem_l_returnflag#7905,cval_lineitem_l_linestatus#7906,cval_lineitem_l_commitdate#7907,cval_lineitem_l_receiptdate#7908,cval_lineitem_l_shipinstruct#7909,cval_lineitem_l_shipmode#7910,cval_lineitem_l_comment#7911,cval_lineitem_l_shipdate#7912,cl_quantity#7913,cl_extendedprice#7914,cl_discount#7915,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#8050 AS rid_3#8067, cval_part_p_name#8051 AS cval_part_p_name_3#8068, cval_part_p_mfgr#8052 AS cval_part_p_mfgr_3#8069, cval_part_p_type#8053 AS cval_part_p_type_3#8070, cval_part_p_size#8054 AS cval_part_p_size_3#8071, cval_part_p_container#8055 AS cval_part_p_container_3#8072, cval_part_p_retailprice#8056 AS cval_part_p_retailprice_3#8073, cval_part_p_comment#8057 AS cval_part_p_comment_3#8074, cval_part_p_brand#8058 AS cval_part_p_brand_3#8075, cp_name#8059 AS cp_name_3#8076, cp_mfgr#8060 AS cp_mfgr_3#8077, cp_type#8061 AS cp_type_3#8078, cp_size#8062 AS cp_size_3#8079, cp_container#8063 AS cp_container_3#8080, cp_retailprice#8064 AS cp_retailprice_3#8081, cp_comment#8065 AS cp_comment_3#8082, cp_brand#8066 AS cp_brand_3#8083]
            :     :        +- Relation[rid#8050,cval_part_p_name#8051,cval_part_p_mfgr#8052,cval_part_p_type#8053,cval_part_p_size#8054,cval_part_p_container#8055,cval_part_p_retailprice#8056,cval_part_p_comment#8057,cval_part_p_brand#8058,cp_name#8059,cp_mfgr#8060,cp_type#8061,cp_size#8062,cp_container#8063,cp_retailprice#8064,cp_comment#8065,cp_brand#8066] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#8084 AS rid_4#8095, cpfk_part_partsupp#8085 AS cpfk_part_partsupp_4#8096, cfpk_partsupp_part#8086 AS cfpk_partsupp_part_4#8097, cpfk_supplier_partsupp#8087 AS cpfk_supplier_partsupp_4#8098, cfpk_partsupp_supplier#8088 AS cfpk_partsupp_supplier_4#8099, cval_partsupp_ps_availqty#8089 AS cval_partsupp_ps_availqty_4#8100, cval_partsupp_ps_supplycost#8090 AS cval_partsupp_ps_supplycost_4#8101, cval_partsupp_ps_comment#8091 AS cval_partsupp_ps_comment_4#8102, cps_availqty#8092 AS cps_availqty_4#8103, cps_supplycost#8093 AS cps_supplycost_4#8104, cps_comment#8094 AS cps_comment_4#8105]
            :        +- Relation[rid#8084,cpfk_part_partsupp#8085,cfpk_partsupp_part#8086,cpfk_supplier_partsupp#8087,cfpk_partsupp_supplier#8088,cval_partsupp_ps_availqty#8089,cval_partsupp_ps_supplycost#8090,cval_partsupp_ps_comment#8091,cps_availqty#8092,cps_supplycost#8093,cps_comment#8094] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#8106 AS rid_5#8123, cpfk_customer_orders#8107 AS cpfk_customer_orders_5#8124, cfpk_orders_customer#8108 AS cfpk_orders_customer_5#8125, cval_orders_o_orderstatus#8109 AS cval_orders_o_orderstatus_5#8126, cval_orders_o_totalprice#8110 AS cval_orders_o_totalprice_5#8127, cval_orders_o_orderpriority#8111 AS cval_orders_o_orderpriority_5#8128, cval_orders_o_clerk#8112 AS cval_orders_o_clerk_5#8129, cval_orders_o_shippriority#8113 AS cval_orders_o_shippriority_5#8130, cval_orders_o_comment#8114 AS cval_orders_o_comment_5#8131, cval_orders_o_orderdate#8115 AS cval_orders_o_orderdate_5#8132, co_orderstatus#8116 AS co_orderstatus_5#8133, co_totalprice#8117 AS co_totalprice_5#8134, co_orderpriority#8118 AS co_orderpriority_5#8135, co_clerk#8119 AS co_clerk_5#8136, co_shippriority#8120 AS co_shippriority_5#8137, co_comment#8121 AS co_comment_5#8138, co_orderdate#8122 AS co_orderdate_5#8139]
               +- Relation[rid#8106,cpfk_customer_orders#8107,cfpk_orders_customer#8108,cval_orders_o_orderstatus#8109,cval_orders_o_totalprice#8110,cval_orders_o_orderpriority#8111,cval_orders_o_clerk#8112,cval_orders_o_shippriority#8113,cval_orders_o_comment#8114,cval_orders_o_orderdate#8115,co_orderstatus#8116,co_totalprice#8117,co_orderpriority#8118,co_clerk#8119,co_shippriority#8120,co_comment#8121,co_orderdate#8122] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 273267ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/15 16:13:24 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:13:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8242L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 16:13:24 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 16:13:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8242L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#8244 AS rid_0#8249, cval_region_r_name#8245 AS cval_region_r_name_0#8250, cval_region_r_comment#8246 AS cval_region_r_comment_0#8251, cr_name#8247 AS cr_name_0#8252, cr_comment#8248 AS cr_comment_0#8253]
         :  :  :  :  :  :  :  +- Relation[rid#8244,cval_region_r_name#8245,cval_region_r_comment#8246,cr_name#8247,cr_comment#8248] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#8254 AS rid_0#8259, cval_region_r_name#8255 AS cval_region_r_name_0#8260, cval_region_r_comment#8256 AS cval_region_r_comment_0#8261, cr_name#8257 AS cr_name_0#8262, cr_comment#8258 AS cr_comment_0#8263]
         :  :  :  :  :  :        +- Relation[rid#8254,cval_region_r_name#8255,cval_region_r_comment#8256,cr_name#8257,cr_comment#8258] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- Project [rid#8288 AS rid_1#8295, cpfk_region_nation#8289 AS cpfk_region_nation_1#8296, cfpk_nation_region#8290 AS cfpk_nation_region_1#8297, cval_nation_n_name#8291 AS cval_nation_n_name_1#8298, cval_nation_n_comment#8292 AS cval_nation_n_comment_1#8299, cn_name#8293 AS cn_name_1#8300, cn_comment#8294 AS cn_comment_1#8301]
         :  :  :  :  :     +- Relation[rid#8288,cpfk_region_nation#8289,cfpk_nation_region#8290,cval_nation_n_name#8291,cval_nation_n_comment#8292,cn_name#8293,cn_comment#8294] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#8264 AS rid_1#8271, cpfk_region_nation#8265 AS cpfk_region_nation_1#8272, cfpk_nation_region#8266 AS cfpk_nation_region_1#8273, cval_nation_n_name#8267 AS cval_nation_n_name_1#8274, cval_nation_n_comment#8268 AS cval_nation_n_comment_1#8275, cn_name#8269 AS cn_name_1#8276, cn_comment#8270 AS cn_comment_1#8277]
         :  :  :  :     +- Relation[rid#8264,cpfk_region_nation#8265,cfpk_nation_region#8266,cval_nation_n_name#8267,cval_nation_n_comment#8268,cn_name#8269,cn_comment#8270] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- Project [rid#8342 AS rid_2#8355, cpfk_nation_supplier#8343 AS cpfk_nation_supplier_2#8356, cfpk_supplier_nation#8344 AS cfpk_supplier_nation_2#8357, cval_supplier_s_name#8345 AS cval_supplier_s_name_2#8358, cval_supplier_s_address#8346 AS cval_supplier_s_address_2#8359, cval_supplier_s_phone#8347 AS cval_supplier_s_phone_2#8360, cval_supplier_s_acctbal#8348 AS cval_supplier_s_acctbal_2#8361, cval_supplier_s_comment#8349 AS cval_supplier_s_comment_2#8362, cs_name#8350 AS cs_name_2#8363, cs_address#8351 AS cs_address_2#8364, cs_phone#8352 AS cs_phone_2#8365, cs_acctbal#8353 AS cs_acctbal_2#8366, cs_comment#8354 AS cs_comment_2#8367]
         :  :  :     +- Relation[rid#8342,cpfk_nation_supplier#8343,cfpk_supplier_nation#8344,cval_supplier_s_name#8345,cval_supplier_s_address#8346,cval_supplier_s_phone#8347,cval_supplier_s_acctbal#8348,cval_supplier_s_comment#8349,cs_name#8350,cs_address#8351,cs_phone#8352,cs_acctbal#8353,cs_comment#8354] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#8302 AS rid_2#8315, cpfk_nation_supplier#8303 AS cpfk_nation_supplier_2#8316, cfpk_supplier_nation#8304 AS cfpk_supplier_nation_2#8317, cval_supplier_s_name#8305 AS cval_supplier_s_name_2#8318, cval_supplier_s_address#8306 AS cval_supplier_s_address_2#8319, cval_supplier_s_phone#8307 AS cval_supplier_s_phone_2#8320, cval_supplier_s_acctbal#8308 AS cval_supplier_s_acctbal_2#8321, cval_supplier_s_comment#8309 AS cval_supplier_s_comment_2#8322, cs_name#8310 AS cs_name_2#8323, cs_address#8311 AS cs_address_2#8324, cs_phone#8312 AS cs_phone_2#8325, cs_acctbal#8313 AS cs_acctbal_2#8326, cs_comment#8314 AS cs_comment_2#8327]
         :  :     +- Relation[rid#8302,cpfk_nation_supplier#8303,cfpk_supplier_nation#8304,cval_supplier_s_name#8305,cval_supplier_s_address#8306,cval_supplier_s_phone#8307,cval_supplier_s_acctbal#8308,cval_supplier_s_comment#8309,cs_name#8310,cs_address#8311,cs_phone#8312,cs_acctbal#8313,cs_comment#8314] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#8540 AS rid_4#8551, cpfk_part_partsupp#8541 AS cpfk_part_partsupp_4#8552, cfpk_partsupp_part#8542 AS cfpk_partsupp_part_4#8553, cpfk_supplier_partsupp#8543 AS cpfk_supplier_partsupp_4#8554, cfpk_partsupp_supplier#8544 AS cfpk_partsupp_supplier_4#8555, cval_partsupp_ps_availqty#8545 AS cval_partsupp_ps_availqty_4#8556, cval_partsupp_ps_supplycost#8546 AS cval_partsupp_ps_supplycost_4#8557, cval_partsupp_ps_comment#8547 AS cval_partsupp_ps_comment_4#8558, cps_availqty#8548 AS cps_availqty_4#8559, cps_supplycost#8549 AS cps_supplycost_4#8560, cps_comment#8550 AS cps_comment_4#8561]
         :     +- Relation[rid#8540,cpfk_part_partsupp#8541,cfpk_partsupp_part#8542,cpfk_supplier_partsupp#8543,cfpk_partsupp_supplier#8544,cval_partsupp_ps_availqty#8545,cval_partsupp_ps_supplycost#8546,cval_partsupp_ps_comment#8547,cps_availqty#8548,cps_supplycost#8549,cps_comment#8550] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'DexPseudoPrimaryKeyLeftDependentJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#8368 AS rid_3#8385, cval_part_p_name#8369 AS cval_part_p_name_3#8386, cval_part_p_mfgr#8370 AS cval_part_p_mfgr_3#8387, cval_part_p_type#8371 AS cval_part_p_type_3#8388, cval_part_p_size#8372 AS cval_part_p_size_3#8389, cval_part_p_container#8373 AS cval_part_p_container_3#8390, cval_part_p_retailprice#8374 AS cval_part_p_retailprice_3#8391, cval_part_p_comment#8375 AS cval_part_p_comment_3#8392, cval_part_p_brand#8376 AS cval_part_p_brand_3#8393, cp_name#8377 AS cp_name_3#8394, cp_mfgr#8378 AS cp_mfgr_3#8395, cp_type#8379 AS cp_type_3#8396, cp_size#8380 AS cp_size_3#8397, cp_container#8381 AS cp_container_3#8398, cp_retailprice#8382 AS cp_retailprice_3#8399, cp_comment#8383 AS cp_comment_3#8400, cp_brand#8384 AS cp_brand_3#8401]
            :  :  :  +- Relation[rid#8368,cval_part_p_name#8369,cval_part_p_mfgr#8370,cval_part_p_type#8371,cval_part_p_size#8372,cval_part_p_container#8373,cval_part_p_retailprice#8374,cval_part_p_comment#8375,cval_part_p_brand#8376,cp_name#8377,cp_mfgr#8378,cp_type#8379,cp_size#8380,cp_container#8381,cp_retailprice#8382,cp_comment#8383,cp_brand#8384] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#8402 AS rid_3#8419, cval_part_p_name#8403 AS cval_part_p_name_3#8420, cval_part_p_mfgr#8404 AS cval_part_p_mfgr_3#8421, cval_part_p_type#8405 AS cval_part_p_type_3#8422, cval_part_p_size#8406 AS cval_part_p_size_3#8423, cval_part_p_container#8407 AS cval_part_p_container_3#8424, cval_part_p_retailprice#8408 AS cval_part_p_retailprice_3#8425, cval_part_p_comment#8409 AS cval_part_p_comment_3#8426, cval_part_p_brand#8410 AS cval_part_p_brand_3#8427, cp_name#8411 AS cp_name_3#8428, cp_mfgr#8412 AS cp_mfgr_3#8429, cp_type#8413 AS cp_type_3#8430, cp_size#8414 AS cp_size_3#8431, cp_container#8415 AS cp_container_3#8432, cp_retailprice#8416 AS cp_retailprice_3#8433, cp_comment#8417 AS cp_comment_3#8434, cp_brand#8418 AS cp_brand_3#8435]
            :  :        +- Relation[rid#8402,cval_part_p_name#8403,cval_part_p_mfgr#8404,cval_part_p_type#8405,cval_part_p_size#8406,cval_part_p_container#8407,cval_part_p_retailprice#8408,cval_part_p_comment#8409,cval_part_p_brand#8410,cp_name#8411,cp_mfgr#8412,cp_type#8413,cp_size#8414,cp_container#8415,cp_retailprice#8416,cp_comment#8417,cp_brand#8418] JDBCRelation(tpart) [numPartitions=1]
            :  +- Project [rid#8492 AS rid_4#8503, cpfk_part_partsupp#8493 AS cpfk_part_partsupp_4#8504, cfpk_partsupp_part#8494 AS cfpk_partsupp_part_4#8505, cpfk_supplier_partsupp#8495 AS cpfk_supplier_partsupp_4#8506, cfpk_partsupp_supplier#8496 AS cfpk_partsupp_supplier_4#8507, cval_partsupp_ps_availqty#8497 AS cval_partsupp_ps_availqty_4#8508, cval_partsupp_ps_supplycost#8498 AS cval_partsupp_ps_supplycost_4#8509, cval_partsupp_ps_comment#8499 AS cval_partsupp_ps_comment_4#8510, cps_availqty#8500 AS cps_availqty_4#8511, cps_supplycost#8501 AS cps_supplycost_4#8512, cps_comment#8502 AS cps_comment_4#8513]
            :     +- Relation[rid#8492,cpfk_part_partsupp#8493,cfpk_partsupp_part#8494,cpfk_supplier_partsupp#8495,cfpk_partsupp_supplier#8496,cval_partsupp_ps_availqty#8497,cval_partsupp_ps_supplycost#8498,cval_partsupp_ps_comment#8499,cps_availqty#8500,cps_supplycost#8501,cps_comment#8502] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#8436 AS rid_4#8447, cpfk_part_partsupp#8437 AS cpfk_part_partsupp_4#8448, cfpk_partsupp_part#8438 AS cfpk_partsupp_part_4#8449, cpfk_supplier_partsupp#8439 AS cpfk_supplier_partsupp_4#8450, cfpk_partsupp_supplier#8440 AS cfpk_partsupp_supplier_4#8451, cval_partsupp_ps_availqty#8441 AS cval_partsupp_ps_availqty_4#8452, cval_partsupp_ps_supplycost#8442 AS cval_partsupp_ps_supplycost_4#8453, cval_partsupp_ps_comment#8443 AS cval_partsupp_ps_comment_4#8454, cps_availqty#8444 AS cps_availqty_4#8455, cps_supplycost#8445 AS cps_supplycost_4#8456, cps_comment#8446 AS cps_comment_4#8457]
               +- Relation[rid#8436,cpfk_part_partsupp#8437,cfpk_partsupp_part#8438,cpfk_supplier_partsupp#8439,cfpk_partsupp_supplier#8440,cval_partsupp_ps_availqty#8441,cval_partsupp_ps_supplycost#8442,cval_partsupp_ps_comment#8443,cps_availqty#8444,cps_supplycost#8445,cps_comment#8446] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=0
Elapsed time: 1725ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/15 16:13:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:13:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8643L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:13:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8643L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#8645 AS rid_0#8678, cpfk_orders_lineitem#8646 AS cpfk_orders_lineitem_0#8679, cpfk_supplier_lineitem#8647 AS cpfk_supplier_lineitem_0#8680, cfpk_lineitem_supplier#8648 AS cfpk_lineitem_supplier_0#8681, cfpk_lineitem_partsupp#8649 AS cfpk_lineitem_partsupp_0#8682, cpfk_part_lineitem#8650 AS cpfk_part_lineitem_0#8683, cfpk_lineitem_part#8651 AS cfpk_lineitem_part_0#8684, cpfk_partsupp_lineitem#8652 AS cpfk_partsupp_lineitem_0#8685, cfpk_lineitem_orders#8653 AS cfpk_lineitem_orders_0#8686, cval_lineitem_l_quantity#8654 AS cval_lineitem_l_quantity_0#8687, cval_lineitem_l_extendedprice#8655 AS cval_lineitem_l_extendedprice_0#8688, cval_lineitem_l_discount#8656 AS cval_lineitem_l_discount_0#8689, cval_lineitem_l_tax#8657 AS cval_lineitem_l_tax_0#8690, cval_lineitem_l_returnflag#8658 AS cval_lineitem_l_returnflag_0#8691, cval_lineitem_l_linestatus#8659 AS cval_lineitem_l_linestatus_0#8692, cval_lineitem_l_commitdate#8660 AS cval_lineitem_l_commitdate_0#8693, cval_lineitem_l_receiptdate#8661 AS cval_lineitem_l_receiptdate_0#8694, cval_lineitem_l_shipinstruct#8662 AS cval_lineitem_l_shipinstruct_0#8695, cval_lineitem_l_shipmode#8663 AS cval_lineitem_l_shipmode_0#8696, cval_lineitem_l_comment#8664 AS cval_lineitem_l_comment_0#8697, cval_lineitem_l_shipdate#8665 AS cval_lineitem_l_shipdate_0#8698, cl_quantity#8666 AS cl_quantity_0#8699, cl_extendedprice#8667 AS cl_extendedprice_0#8700, cl_discount#8668 AS cl_discount_0#8701, ... 9 more fields]
            :  +- Relation[rid#8645,cpfk_orders_lineitem#8646,cpfk_supplier_lineitem#8647,cfpk_lineitem_supplier#8648,cfpk_lineitem_partsupp#8649,cpfk_part_lineitem#8650,cfpk_lineitem_part#8651,cpfk_partsupp_lineitem#8652,cfpk_lineitem_orders#8653,cval_lineitem_l_quantity#8654,cval_lineitem_l_extendedprice#8655,cval_lineitem_l_discount#8656,cval_lineitem_l_tax#8657,cval_lineitem_l_returnflag#8658,cval_lineitem_l_linestatus#8659,cval_lineitem_l_commitdate#8660,cval_lineitem_l_receiptdate#8661,cval_lineitem_l_shipinstruct#8662,cval_lineitem_l_shipmode#8663,cval_lineitem_l_comment#8664,cval_lineitem_l_shipdate#8665,cl_quantity#8666,cl_extendedprice#8667,cl_discount#8668,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#8711 AS rid_1#8728, cpfk_customer_orders#8712 AS cpfk_customer_orders_1#8729, cfpk_orders_customer#8713 AS cfpk_orders_customer_1#8730, cval_orders_o_orderstatus#8714 AS cval_orders_o_orderstatus_1#8731, cval_orders_o_totalprice#8715 AS cval_orders_o_totalprice_1#8732, cval_orders_o_orderpriority#8716 AS cval_orders_o_orderpriority_1#8733, cval_orders_o_clerk#8717 AS cval_orders_o_clerk_1#8734, cval_orders_o_shippriority#8718 AS cval_orders_o_shippriority_1#8735, cval_orders_o_comment#8719 AS cval_orders_o_comment_1#8736, cval_orders_o_orderdate#8720 AS cval_orders_o_orderdate_1#8737, co_orderstatus#8721 AS co_orderstatus_1#8738, co_totalprice#8722 AS co_totalprice_1#8739, co_orderpriority#8723 AS co_orderpriority_1#8740, co_clerk#8724 AS co_clerk_1#8741, co_shippriority#8725 AS co_shippriority_1#8742, co_comment#8726 AS co_comment_1#8743, co_orderdate#8727 AS co_orderdate_1#8744]
               +- Relation[rid#8711,cpfk_customer_orders#8712,cfpk_orders_customer#8713,cval_orders_o_orderstatus#8714,cval_orders_o_totalprice#8715,cval_orders_o_orderpriority#8716,cval_orders_o_clerk#8717,cval_orders_o_shippriority#8718,cval_orders_o_comment#8719,cval_orders_o_orderdate#8720,co_orderstatus#8721,co_totalprice#8722,co_orderpriority#8723,co_clerk#8724,co_shippriority#8725,co_comment#8726,co_orderdate#8727] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 58132ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/15 16:14:24 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:14:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8803L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 16:14:24 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:14:24 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:14:24 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:14:24 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:14:24 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 16:14:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8803L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'DexPseudoPrimaryKeyLeftDependentJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'DexPseudoPrimaryKeyLeftDependentJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#8805 AS rid_0#8820, cpfk_nation_customer#8806 AS cpfk_nation_customer_0#8821, cfpk_customer_nation#8807 AS cfpk_customer_nation_0#8822, cval_customer_c_name#8808 AS cval_customer_c_name_0#8823, cval_customer_c_address#8809 AS cval_customer_c_address_0#8824, cval_customer_c_phone#8810 AS cval_customer_c_phone_0#8825, cval_customer_c_acctbal#8811 AS cval_customer_c_acctbal_0#8826, cval_customer_c_comment#8812 AS cval_customer_c_comment_0#8827, cval_customer_c_mktsegment#8813 AS cval_customer_c_mktsegment_0#8828, cc_name#8814 AS cc_name_0#8829, cc_address#8815 AS cc_address_0#8830, cc_phone#8816 AS cc_phone_0#8831, cc_acctbal#8817 AS cc_acctbal_0#8832, cc_comment#8818 AS cc_comment_0#8833, cc_mktsegment#8819 AS cc_mktsegment_0#8834]
         :  :  :  :  :  +- Relation[rid#8805,cpfk_nation_customer#8806,cfpk_customer_nation#8807,cval_customer_c_name#8808,cval_customer_c_address#8809,cval_customer_c_phone#8810,cval_customer_c_acctbal#8811,cval_customer_c_comment#8812,cval_customer_c_mktsegment#8813,cc_name#8814,cc_address#8815,cc_phone#8816,cc_acctbal#8817,cc_comment#8818,cc_mktsegment#8819] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#8835 AS rid_0#8850, cpfk_nation_customer#8836 AS cpfk_nation_customer_0#8851, cfpk_customer_nation#8837 AS cfpk_customer_nation_0#8852, cval_customer_c_name#8838 AS cval_customer_c_name_0#8853, cval_customer_c_address#8839 AS cval_customer_c_address_0#8854, cval_customer_c_phone#8840 AS cval_customer_c_phone_0#8855, cval_customer_c_acctbal#8841 AS cval_customer_c_acctbal_0#8856, cval_customer_c_comment#8842 AS cval_customer_c_comment_0#8857, cval_customer_c_mktsegment#8843 AS cval_customer_c_mktsegment_0#8858, cc_name#8844 AS cc_name_0#8859, cc_address#8845 AS cc_address_0#8860, cc_phone#8846 AS cc_phone_0#8861, cc_acctbal#8847 AS cc_acctbal_0#8862, cc_comment#8848 AS cc_comment_0#8863, cc_mktsegment#8849 AS cc_mktsegment_0#8864]
         :  :  :  :        +- Relation[rid#8835,cpfk_nation_customer#8836,cfpk_customer_nation#8837,cval_customer_c_name#8838,cval_customer_c_address#8839,cval_customer_c_phone#8840,cval_customer_c_acctbal#8841,cval_customer_c_comment#8842,cval_customer_c_mktsegment#8843,cc_name#8844,cc_address#8845,cc_phone#8846,cc_acctbal#8847,cc_comment#8848,cc_mktsegment#8849] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- Project [rid#8929 AS rid_1#8946, cpfk_customer_orders#8930 AS cpfk_customer_orders_1#8947, cfpk_orders_customer#8931 AS cfpk_orders_customer_1#8948, cval_orders_o_orderstatus#8932 AS cval_orders_o_orderstatus_1#8949, cval_orders_o_totalprice#8933 AS cval_orders_o_totalprice_1#8950, cval_orders_o_orderpriority#8934 AS cval_orders_o_orderpriority_1#8951, cval_orders_o_clerk#8935 AS cval_orders_o_clerk_1#8952, cval_orders_o_shippriority#8936 AS cval_orders_o_shippriority_1#8953, cval_orders_o_comment#8937 AS cval_orders_o_comment_1#8954, cval_orders_o_orderdate#8938 AS cval_orders_o_orderdate_1#8955, co_orderstatus#8939 AS co_orderstatus_1#8956, co_totalprice#8940 AS co_totalprice_1#8957, co_orderpriority#8941 AS co_orderpriority_1#8958, co_clerk#8942 AS co_clerk_1#8959, co_shippriority#8943 AS co_shippriority_1#8960, co_comment#8944 AS co_comment_1#8961, co_orderdate#8945 AS co_orderdate_1#8962]
         :  :  :     +- Relation[rid#8929,cpfk_customer_orders#8930,cfpk_orders_customer#8931,cval_orders_o_orderstatus#8932,cval_orders_o_totalprice#8933,cval_orders_o_orderpriority#8934,cval_orders_o_clerk#8935,cval_orders_o_shippriority#8936,cval_orders_o_comment#8937,cval_orders_o_orderdate#8938,co_orderstatus#8939,co_totalprice#8940,co_orderpriority#8941,co_clerk#8942,co_shippriority#8943,co_comment#8944,co_orderdate#8945] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#8865 AS rid_1#8882, cpfk_customer_orders#8866 AS cpfk_customer_orders_1#8883, cfpk_orders_customer#8867 AS cfpk_orders_customer_1#8884, cval_orders_o_orderstatus#8868 AS cval_orders_o_orderstatus_1#8885, cval_orders_o_totalprice#8869 AS cval_orders_o_totalprice_1#8886, cval_orders_o_orderpriority#8870 AS cval_orders_o_orderpriority_1#8887, cval_orders_o_clerk#8871 AS cval_orders_o_clerk_1#8888, cval_orders_o_shippriority#8872 AS cval_orders_o_shippriority_1#8889, cval_orders_o_comment#8873 AS cval_orders_o_comment_1#8890, cval_orders_o_orderdate#8874 AS cval_orders_o_orderdate_1#8891, co_orderstatus#8875 AS co_orderstatus_1#8892, co_totalprice#8876 AS co_totalprice_1#8893, co_orderpriority#8877 AS co_orderpriority_1#8894, co_clerk#8878 AS co_clerk_1#8895, co_shippriority#8879 AS co_shippriority_1#8896, co_comment#8880 AS co_comment_1#8897, co_orderdate#8881 AS co_orderdate_1#8898]
         :  :     +- Relation[rid#8865,cpfk_customer_orders#8866,cfpk_orders_customer#8867,cval_orders_o_orderstatus#8868,cval_orders_o_totalprice#8869,cval_orders_o_orderpriority#8870,cval_orders_o_clerk#8871,cval_orders_o_shippriority#8872,cval_orders_o_comment#8873,cval_orders_o_orderdate#8874,co_orderstatus#8875,co_totalprice#8876,co_orderpriority#8877,co_clerk#8878,co_shippriority#8879,co_comment#8880,co_orderdate#8881] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#9063 AS rid_2#9096, cpfk_orders_lineitem#9064 AS cpfk_orders_lineitem_2#9097, cpfk_supplier_lineitem#9065 AS cpfk_supplier_lineitem_2#9098, cfpk_lineitem_supplier#9066 AS cfpk_lineitem_supplier_2#9099, cfpk_lineitem_partsupp#9067 AS cfpk_lineitem_partsupp_2#9100, cpfk_part_lineitem#9068 AS cpfk_part_lineitem_2#9101, cfpk_lineitem_part#9069 AS cfpk_lineitem_part_2#9102, cpfk_partsupp_lineitem#9070 AS cpfk_partsupp_lineitem_2#9103, cfpk_lineitem_orders#9071 AS cfpk_lineitem_orders_2#9104, cval_lineitem_l_quantity#9072 AS cval_lineitem_l_quantity_2#9105, cval_lineitem_l_extendedprice#9073 AS cval_lineitem_l_extendedprice_2#9106, cval_lineitem_l_discount#9074 AS cval_lineitem_l_discount_2#9107, cval_lineitem_l_tax#9075 AS cval_lineitem_l_tax_2#9108, cval_lineitem_l_returnflag#9076 AS cval_lineitem_l_returnflag_2#9109, cval_lineitem_l_linestatus#9077 AS cval_lineitem_l_linestatus_2#9110, cval_lineitem_l_commitdate#9078 AS cval_lineitem_l_commitdate_2#9111, cval_lineitem_l_receiptdate#9079 AS cval_lineitem_l_receiptdate_2#9112, cval_lineitem_l_shipinstruct#9080 AS cval_lineitem_l_shipinstruct_2#9113, cval_lineitem_l_shipmode#9081 AS cval_lineitem_l_shipmode_2#9114, cval_lineitem_l_comment#9082 AS cval_lineitem_l_comment_2#9115, cval_lineitem_l_shipdate#9083 AS cval_lineitem_l_shipdate_2#9116, cl_quantity#9084 AS cl_quantity_2#9117, cl_extendedprice#9085 AS cl_extendedprice_2#9118, cl_discount#9086 AS cl_discount_2#9119, ... 9 more fields]
         :     +- Relation[rid#9063,cpfk_orders_lineitem#9064,cpfk_supplier_lineitem#9065,cfpk_lineitem_supplier#9066,cfpk_lineitem_partsupp#9067,cpfk_part_lineitem#9068,cfpk_lineitem_part#9069,cpfk_partsupp_lineitem#9070,cfpk_lineitem_orders#9071,cval_lineitem_l_quantity#9072,cval_lineitem_l_extendedprice#9073,cval_lineitem_l_discount#9074,cval_lineitem_l_tax#9075,cval_lineitem_l_returnflag#9076,cval_lineitem_l_linestatus#9077,cval_lineitem_l_commitdate#9078,cval_lineitem_l_receiptdate#9079,cval_lineitem_l_shipinstruct#9080,cval_lineitem_l_shipmode#9081,cval_lineitem_l_comment#9082,cval_lineitem_l_shipdate#9083,cl_quantity#9084,cl_extendedprice#9085,cl_discount#9086,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8963 AS rid_2#8996, cpfk_orders_lineitem#8964 AS cpfk_orders_lineitem_2#8997, cpfk_supplier_lineitem#8965 AS cpfk_supplier_lineitem_2#8998, cfpk_lineitem_supplier#8966 AS cfpk_lineitem_supplier_2#8999, cfpk_lineitem_partsupp#8967 AS cfpk_lineitem_partsupp_2#9000, cpfk_part_lineitem#8968 AS cpfk_part_lineitem_2#9001, cfpk_lineitem_part#8969 AS cfpk_lineitem_part_2#9002, cpfk_partsupp_lineitem#8970 AS cpfk_partsupp_lineitem_2#9003, cfpk_lineitem_orders#8971 AS cfpk_lineitem_orders_2#9004, cval_lineitem_l_quantity#8972 AS cval_lineitem_l_quantity_2#9005, cval_lineitem_l_extendedprice#8973 AS cval_lineitem_l_extendedprice_2#9006, cval_lineitem_l_discount#8974 AS cval_lineitem_l_discount_2#9007, cval_lineitem_l_tax#8975 AS cval_lineitem_l_tax_2#9008, cval_lineitem_l_returnflag#8976 AS cval_lineitem_l_returnflag_2#9009, cval_lineitem_l_linestatus#8977 AS cval_lineitem_l_linestatus_2#9010, cval_lineitem_l_commitdate#8978 AS cval_lineitem_l_commitdate_2#9011, cval_lineitem_l_receiptdate#8979 AS cval_lineitem_l_receiptdate_2#9012, cval_lineitem_l_shipinstruct#8980 AS cval_lineitem_l_shipinstruct_2#9013, cval_lineitem_l_shipmode#8981 AS cval_lineitem_l_shipmode_2#9014, cval_lineitem_l_comment#8982 AS cval_lineitem_l_comment_2#9015, cval_lineitem_l_shipdate#8983 AS cval_lineitem_l_shipdate_2#9016, cl_quantity#8984 AS cl_quantity_2#9017, cl_extendedprice#8985 AS cl_extendedprice_2#9018, cl_discount#8986 AS cl_discount_2#9019, ... 9 more fields]
            +- Relation[rid#8963,cpfk_orders_lineitem#8964,cpfk_supplier_lineitem#8965,cfpk_lineitem_supplier#8966,cfpk_lineitem_partsupp#8967,cpfk_part_lineitem#8968,cfpk_lineitem_part#8969,cpfk_partsupp_lineitem#8970,cfpk_lineitem_orders#8971,cval_lineitem_l_quantity#8972,cval_lineitem_l_extendedprice#8973,cval_lineitem_l_discount#8974,cval_lineitem_l_tax#8975,cval_lineitem_l_returnflag#8976,cval_lineitem_l_linestatus#8977,cval_lineitem_l_commitdate#8978,cval_lineitem_l_receiptdate#8979,cval_lineitem_l_shipinstruct#8980,cval_lineitem_l_shipmode#8981,cval_lineitem_l_comment#8982,cval_lineitem_l_shipdate#8983,cl_quantity#8984,cl_extendedprice#8985,cl_discount#8986,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=75006
Elapsed time: 7218ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/15 16:14:31 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 16:14:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9198L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 16:14:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9198L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#9200 AS rid_0#9233, cpfk_orders_lineitem#9201 AS cpfk_orders_lineitem_0#9234, cpfk_supplier_lineitem#9202 AS cpfk_supplier_lineitem_0#9235, cfpk_lineitem_supplier#9203 AS cfpk_lineitem_supplier_0#9236, cfpk_lineitem_partsupp#9204 AS cfpk_lineitem_partsupp_0#9237, cpfk_part_lineitem#9205 AS cpfk_part_lineitem_0#9238, cfpk_lineitem_part#9206 AS cfpk_lineitem_part_0#9239, cpfk_partsupp_lineitem#9207 AS cpfk_partsupp_lineitem_0#9240, cfpk_lineitem_orders#9208 AS cfpk_lineitem_orders_0#9241, cval_lineitem_l_quantity#9209 AS cval_lineitem_l_quantity_0#9242, cval_lineitem_l_extendedprice#9210 AS cval_lineitem_l_extendedprice_0#9243, cval_lineitem_l_discount#9211 AS cval_lineitem_l_discount_0#9244, cval_lineitem_l_tax#9212 AS cval_lineitem_l_tax_0#9245, cval_lineitem_l_returnflag#9213 AS cval_lineitem_l_returnflag_0#9246, cval_lineitem_l_linestatus#9214 AS cval_lineitem_l_linestatus_0#9247, cval_lineitem_l_commitdate#9215 AS cval_lineitem_l_commitdate_0#9248, cval_lineitem_l_receiptdate#9216 AS cval_lineitem_l_receiptdate_0#9249, cval_lineitem_l_shipinstruct#9217 AS cval_lineitem_l_shipinstruct_0#9250, cval_lineitem_l_shipmode#9218 AS cval_lineitem_l_shipmode_0#9251, cval_lineitem_l_comment#9219 AS cval_lineitem_l_comment_0#9252, cval_lineitem_l_shipdate#9220 AS cval_lineitem_l_shipdate_0#9253, cl_quantity#9221 AS cl_quantity_0#9254, cl_extendedprice#9222 AS cl_extendedprice_0#9255, cl_discount#9223 AS cl_discount_0#9256, ... 9 more fields]
            :  :  +- Relation[rid#9200,cpfk_orders_lineitem#9201,cpfk_supplier_lineitem#9202,cfpk_lineitem_supplier#9203,cfpk_lineitem_partsupp#9204,cpfk_part_lineitem#9205,cfpk_lineitem_part#9206,cpfk_partsupp_lineitem#9207,cfpk_lineitem_orders#9208,cval_lineitem_l_quantity#9209,cval_lineitem_l_extendedprice#9210,cval_lineitem_l_discount#9211,cval_lineitem_l_tax#9212,cval_lineitem_l_returnflag#9213,cval_lineitem_l_linestatus#9214,cval_lineitem_l_commitdate#9215,cval_lineitem_l_receiptdate#9216,cval_lineitem_l_shipinstruct#9217,cval_lineitem_l_shipmode#9218,cval_lineitem_l_comment#9219,cval_lineitem_l_shipdate#9220,cl_quantity#9221,cl_extendedprice#9222,cl_discount#9223,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#9266 AS rid_0#9299, cpfk_orders_lineitem#9267 AS cpfk_orders_lineitem_0#9300, cpfk_supplier_lineitem#9268 AS cpfk_supplier_lineitem_0#9301, cfpk_lineitem_supplier#9269 AS cfpk_lineitem_supplier_0#9302, cfpk_lineitem_partsupp#9270 AS cfpk_lineitem_partsupp_0#9303, cpfk_part_lineitem#9271 AS cpfk_part_lineitem_0#9304, cfpk_lineitem_part#9272 AS cfpk_lineitem_part_0#9305, cpfk_partsupp_lineitem#9273 AS cpfk_partsupp_lineitem_0#9306, cfpk_lineitem_orders#9274 AS cfpk_lineitem_orders_0#9307, cval_lineitem_l_quantity#9275 AS cval_lineitem_l_quantity_0#9308, cval_lineitem_l_extendedprice#9276 AS cval_lineitem_l_extendedprice_0#9309, cval_lineitem_l_discount#9277 AS cval_lineitem_l_discount_0#9310, cval_lineitem_l_tax#9278 AS cval_lineitem_l_tax_0#9311, cval_lineitem_l_returnflag#9279 AS cval_lineitem_l_returnflag_0#9312, cval_lineitem_l_linestatus#9280 AS cval_lineitem_l_linestatus_0#9313, cval_lineitem_l_commitdate#9281 AS cval_lineitem_l_commitdate_0#9314, cval_lineitem_l_receiptdate#9282 AS cval_lineitem_l_receiptdate_0#9315, cval_lineitem_l_shipinstruct#9283 AS cval_lineitem_l_shipinstruct_0#9316, cval_lineitem_l_shipmode#9284 AS cval_lineitem_l_shipmode_0#9317, cval_lineitem_l_comment#9285 AS cval_lineitem_l_comment_0#9318, cval_lineitem_l_shipdate#9286 AS cval_lineitem_l_shipdate_0#9319, cl_quantity#9287 AS cl_quantity_0#9320, cl_extendedprice#9288 AS cl_extendedprice_0#9321, cl_discount#9289 AS cl_discount_0#9322, ... 9 more fields]
            :        +- Relation[rid#9266,cpfk_orders_lineitem#9267,cpfk_supplier_lineitem#9268,cfpk_lineitem_supplier#9269,cfpk_lineitem_partsupp#9270,cpfk_part_lineitem#9271,cfpk_lineitem_part#9272,cpfk_partsupp_lineitem#9273,cfpk_lineitem_orders#9274,cval_lineitem_l_quantity#9275,cval_lineitem_l_extendedprice#9276,cval_lineitem_l_discount#9277,cval_lineitem_l_tax#9278,cval_lineitem_l_returnflag#9279,cval_lineitem_l_linestatus#9280,cval_lineitem_l_commitdate#9281,cval_lineitem_l_receiptdate#9282,cval_lineitem_l_shipinstruct#9283,cval_lineitem_l_shipmode#9284,cval_lineitem_l_comment#9285,cval_lineitem_l_shipdate#9286,cl_quantity#9287,cl_extendedprice#9288,cl_discount#9289,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#9332 AS rid_1#9349, cpfk_customer_orders#9333 AS cpfk_customer_orders_1#9350, cfpk_orders_customer#9334 AS cfpk_orders_customer_1#9351, cval_orders_o_orderstatus#9335 AS cval_orders_o_orderstatus_1#9352, cval_orders_o_totalprice#9336 AS cval_orders_o_totalprice_1#9353, cval_orders_o_orderpriority#9337 AS cval_orders_o_orderpriority_1#9354, cval_orders_o_clerk#9338 AS cval_orders_o_clerk_1#9355, cval_orders_o_shippriority#9339 AS cval_orders_o_shippriority_1#9356, cval_orders_o_comment#9340 AS cval_orders_o_comment_1#9357, cval_orders_o_orderdate#9341 AS cval_orders_o_orderdate_1#9358, co_orderstatus#9342 AS co_orderstatus_1#9359, co_totalprice#9343 AS co_totalprice_1#9360, co_orderpriority#9344 AS co_orderpriority_1#9361, co_clerk#9345 AS co_clerk_1#9362, co_shippriority#9346 AS co_shippriority_1#9363, co_comment#9347 AS co_comment_1#9364, co_orderdate#9348 AS co_orderdate_1#9365]
               +- Relation[rid#9332,cpfk_customer_orders#9333,cfpk_orders_customer#9334,cval_orders_o_orderstatus#9335,cval_orders_o_totalprice#9336,cval_orders_o_orderpriority#9337,cval_orders_o_clerk#9338,cval_orders_o_shippriority#9339,cval_orders_o_comment#9340,cval_orders_o_orderdate#9341,co_orderstatus#9342,co_totalprice#9343,co_orderpriority#9344,co_clerk#9345,co_shippriority#9346,co_comment#9347,co_orderdate#9348] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 24547ms
query=q1, count=6001215, duration=2725
query=q10, count=1478870, duration=69661
query=q11, count=4, duration=1087
query=q12, count=857401, duration=24547
query=q13, count=1500000, duration=13649
query=q14, count=6001215, duration=87873
query=q15, count=6001215, duration=90675
query=q16, count=7890, duration=2340
query=q17, count=408, duration=3133
query=q18, count=6001215, duration=132576
query=q19, count=13, duration=64804
query=q2, count=0, duration=1725
query=q20, count=326, duration=783
query=q21a, count=120762, duration=88254
query=q22, count=1500000, duration=13828
query=q3, count=75006, duration=7218
query=q4, count=6001215, duration=58132
query=q5, count=16077, duration=27426
query=q6, count=6001215, duration=2848
query=q7, count=0, duration=370
query=q8, count=0, duration=2955
query=q9a, count=6001215, duration=273267
query=q9b, count=6001215, duration=179001
