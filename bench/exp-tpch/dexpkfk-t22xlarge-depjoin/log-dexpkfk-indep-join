20/04/15 02:25:30 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 11250ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Apr 15 02:25:34 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Apr 15 02:25:35 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Apr 15 02:25:35 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Apr 15 02:25:35 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Apr 15 02:25:35 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Apr 15 02:25:40 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Apr 15 02:25:43 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Apr 15 02:25:43 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/15 02:25:45 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:25:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2083L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 02:25:46 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/15 02:25:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2083L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#2085 AS rid_0#2100, cpfk_nation_customer#2086 AS cpfk_nation_customer_0#2101, cfpk_customer_nation#2087 AS cfpk_customer_nation_0#2102, cval_customer_c_name#2088 AS cval_customer_c_name_0#2103, cval_customer_c_address#2089 AS cval_customer_c_address_0#2104, cval_customer_c_phone#2090 AS cval_customer_c_phone_0#2105, cval_customer_c_acctbal#2091 AS cval_customer_c_acctbal_0#2106, cval_customer_c_comment#2092 AS cval_customer_c_comment_0#2107, cval_customer_c_mktsegment#2093 AS cval_customer_c_mktsegment_0#2108, cc_name#2094 AS cc_name_0#2109, cc_address#2095 AS cc_address_0#2110, cc_phone#2096 AS cc_phone_0#2111, cc_acctbal#2097 AS cc_acctbal_0#2112, cc_comment#2098 AS cc_comment_0#2113, cc_mktsegment#2099 AS cc_mktsegment_0#2114]
         :  :  :  :  +- Relation[rid#2085,cpfk_nation_customer#2086,cfpk_customer_nation#2087,cval_customer_c_name#2088,cval_customer_c_address#2089,cval_customer_c_phone#2090,cval_customer_c_acctbal#2091,cval_customer_c_comment#2092,cval_customer_c_mktsegment#2093,cc_name#2094,cc_address#2095,cc_phone#2096,cc_acctbal#2097,cc_comment#2098,cc_mktsegment#2099] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#2149 AS rid_0#2164, cpfk_nation_customer#2150 AS cpfk_nation_customer_0#2165, cfpk_customer_nation#2151 AS cfpk_customer_nation_0#2166, cval_customer_c_name#2152 AS cval_customer_c_name_0#2167, cval_customer_c_address#2153 AS cval_customer_c_address_0#2168, cval_customer_c_phone#2154 AS cval_customer_c_phone_0#2169, cval_customer_c_acctbal#2155 AS cval_customer_c_acctbal_0#2170, cval_customer_c_comment#2156 AS cval_customer_c_comment_0#2171, cval_customer_c_mktsegment#2157 AS cval_customer_c_mktsegment_0#2172, cc_name#2158 AS cc_name_0#2173, cc_address#2159 AS cc_address_0#2174, cc_phone#2160 AS cc_phone_0#2175, cc_acctbal#2161 AS cc_acctbal_0#2176, cc_comment#2162 AS cc_comment_0#2177, cc_mktsegment#2163 AS cc_mktsegment_0#2178]
         :  :  :     :  +- Relation[rid#2149,cpfk_nation_customer#2150,cfpk_customer_nation#2151,cval_customer_c_name#2152,cval_customer_c_address#2153,cval_customer_c_phone#2154,cval_customer_c_acctbal#2155,cval_customer_c_comment#2156,cval_customer_c_mktsegment#2157,cc_name#2158,cc_address#2159,cc_phone#2160,cc_acctbal#2161,cc_comment#2162,cc_mktsegment#2163] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#2179 AS rid_1#2196, cpfk_customer_orders#2180 AS cpfk_customer_orders_1#2197, cfpk_orders_customer#2181 AS cfpk_orders_customer_1#2198, cval_orders_o_orderstatus#2182 AS cval_orders_o_orderstatus_1#2199, cval_orders_o_totalprice#2183 AS cval_orders_o_totalprice_1#2200, cval_orders_o_orderpriority#2184 AS cval_orders_o_orderpriority_1#2201, cval_orders_o_clerk#2185 AS cval_orders_o_clerk_1#2202, cval_orders_o_shippriority#2186 AS cval_orders_o_shippriority_1#2203, cval_orders_o_comment#2187 AS cval_orders_o_comment_1#2204, cval_orders_o_orderdate#2188 AS cval_orders_o_orderdate_1#2205, co_orderstatus#2189 AS co_orderstatus_1#2206, co_totalprice#2190 AS co_totalprice_1#2207, co_orderpriority#2191 AS co_orderpriority_1#2208, co_clerk#2192 AS co_clerk_1#2209, co_shippriority#2193 AS co_shippriority_1#2210, co_comment#2194 AS co_comment_1#2211, co_orderdate#2195 AS co_orderdate_1#2212]
         :  :  :        +- Relation[rid#2179,cpfk_customer_orders#2180,cfpk_orders_customer#2181,cval_orders_o_orderstatus#2182,cval_orders_o_totalprice#2183,cval_orders_o_orderpriority#2184,cval_orders_o_clerk#2185,cval_orders_o_shippriority#2186,cval_orders_o_comment#2187,cval_orders_o_orderdate#2188,co_orderstatus#2189,co_totalprice#2190,co_orderpriority#2191,co_clerk#2192,co_shippriority#2193,co_comment#2194,co_orderdate#2195] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#2115 AS rid_1#2132, cpfk_customer_orders#2116 AS cpfk_customer_orders_1#2133, cfpk_orders_customer#2117 AS cfpk_orders_customer_1#2134, cval_orders_o_orderstatus#2118 AS cval_orders_o_orderstatus_1#2135, cval_orders_o_totalprice#2119 AS cval_orders_o_totalprice_1#2136, cval_orders_o_orderpriority#2120 AS cval_orders_o_orderpriority_1#2137, cval_orders_o_clerk#2121 AS cval_orders_o_clerk_1#2138, cval_orders_o_shippriority#2122 AS cval_orders_o_shippriority_1#2139, cval_orders_o_comment#2123 AS cval_orders_o_comment_1#2140, cval_orders_o_orderdate#2124 AS cval_orders_o_orderdate_1#2141, co_orderstatus#2125 AS co_orderstatus_1#2142, co_totalprice#2126 AS co_totalprice_1#2143, co_orderpriority#2127 AS co_orderpriority_1#2144, co_clerk#2128 AS co_clerk_1#2145, co_shippriority#2129 AS co_shippriority_1#2146, co_comment#2130 AS co_comment_1#2147, co_orderdate#2131 AS co_orderdate_1#2148]
         :  :     +- Relation[rid#2115,cpfk_customer_orders#2116,cfpk_orders_customer#2117,cval_orders_o_orderstatus#2118,cval_orders_o_totalprice#2119,cval_orders_o_orderpriority#2120,cval_orders_o_clerk#2121,cval_orders_o_shippriority#2122,cval_orders_o_comment#2123,cval_orders_o_orderdate#2124,co_orderstatus#2125,co_totalprice#2126,co_orderpriority#2127,co_clerk#2128,co_shippriority#2129,co_comment#2130,co_orderdate#2131] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#2279 AS rid_1#2296, cpfk_customer_orders#2280 AS cpfk_customer_orders_1#2297, cfpk_orders_customer#2281 AS cfpk_orders_customer_1#2298, cval_orders_o_orderstatus#2282 AS cval_orders_o_orderstatus_1#2299, cval_orders_o_totalprice#2283 AS cval_orders_o_totalprice_1#2300, cval_orders_o_orderpriority#2284 AS cval_orders_o_orderpriority_1#2301, cval_orders_o_clerk#2285 AS cval_orders_o_clerk_1#2302, cval_orders_o_shippriority#2286 AS cval_orders_o_shippriority_1#2303, cval_orders_o_comment#2287 AS cval_orders_o_comment_1#2304, cval_orders_o_orderdate#2288 AS cval_orders_o_orderdate_1#2305, co_orderstatus#2289 AS co_orderstatus_1#2306, co_totalprice#2290 AS co_totalprice_1#2307, co_orderpriority#2291 AS co_orderpriority_1#2308, co_clerk#2292 AS co_clerk_1#2309, co_shippriority#2293 AS co_shippriority_1#2310, co_comment#2294 AS co_comment_1#2311, co_orderdate#2295 AS co_orderdate_1#2312]
         :     :  +- Relation[rid#2279,cpfk_customer_orders#2280,cfpk_orders_customer#2281,cval_orders_o_orderstatus#2282,cval_orders_o_totalprice#2283,cval_orders_o_orderpriority#2284,cval_orders_o_clerk#2285,cval_orders_o_shippriority#2286,cval_orders_o_comment#2287,cval_orders_o_orderdate#2288,co_orderstatus#2289,co_totalprice#2290,co_orderpriority#2291,co_clerk#2292,co_shippriority#2293,co_comment#2294,co_orderdate#2295] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#2313 AS rid_2#2346, cpfk_orders_lineitem#2314 AS cpfk_orders_lineitem_2#2347, cpfk_supplier_lineitem#2315 AS cpfk_supplier_lineitem_2#2348, cfpk_lineitem_supplier#2316 AS cfpk_lineitem_supplier_2#2349, cfpk_lineitem_partsupp#2317 AS cfpk_lineitem_partsupp_2#2350, cpfk_part_lineitem#2318 AS cpfk_part_lineitem_2#2351, cfpk_lineitem_part#2319 AS cfpk_lineitem_part_2#2352, cpfk_partsupp_lineitem#2320 AS cpfk_partsupp_lineitem_2#2353, cfpk_lineitem_orders#2321 AS cfpk_lineitem_orders_2#2354, cval_lineitem_l_quantity#2322 AS cval_lineitem_l_quantity_2#2355, cval_lineitem_l_extendedprice#2323 AS cval_lineitem_l_extendedprice_2#2356, cval_lineitem_l_discount#2324 AS cval_lineitem_l_discount_2#2357, cval_lineitem_l_tax#2325 AS cval_lineitem_l_tax_2#2358, cval_lineitem_l_returnflag#2326 AS cval_lineitem_l_returnflag_2#2359, cval_lineitem_l_linestatus#2327 AS cval_lineitem_l_linestatus_2#2360, cval_lineitem_l_commitdate#2328 AS cval_lineitem_l_commitdate_2#2361, cval_lineitem_l_receiptdate#2329 AS cval_lineitem_l_receiptdate_2#2362, cval_lineitem_l_shipinstruct#2330 AS cval_lineitem_l_shipinstruct_2#2363, cval_lineitem_l_shipmode#2331 AS cval_lineitem_l_shipmode_2#2364, cval_lineitem_l_comment#2332 AS cval_lineitem_l_comment_2#2365, cval_lineitem_l_shipdate#2333 AS cval_lineitem_l_shipdate_2#2366, cl_quantity#2334 AS cl_quantity_2#2367, cl_extendedprice#2335 AS cl_extendedprice_2#2368, cl_discount#2336 AS cl_discount_2#2369, ... 9 more fields]
         :        +- Relation[rid#2313,cpfk_orders_lineitem#2314,cpfk_supplier_lineitem#2315,cfpk_lineitem_supplier#2316,cfpk_lineitem_partsupp#2317,cpfk_part_lineitem#2318,cfpk_lineitem_part#2319,cpfk_partsupp_lineitem#2320,cfpk_lineitem_orders#2321,cval_lineitem_l_quantity#2322,cval_lineitem_l_extendedprice#2323,cval_lineitem_l_discount#2324,cval_lineitem_l_tax#2325,cval_lineitem_l_returnflag#2326,cval_lineitem_l_linestatus#2327,cval_lineitem_l_commitdate#2328,cval_lineitem_l_receiptdate#2329,cval_lineitem_l_shipinstruct#2330,cval_lineitem_l_shipmode#2331,cval_lineitem_l_comment#2332,cval_lineitem_l_shipdate#2333,cl_quantity#2334,cl_extendedprice#2335,cl_discount#2336,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2213 AS rid_2#2246, cpfk_orders_lineitem#2214 AS cpfk_orders_lineitem_2#2247, cpfk_supplier_lineitem#2215 AS cpfk_supplier_lineitem_2#2248, cfpk_lineitem_supplier#2216 AS cfpk_lineitem_supplier_2#2249, cfpk_lineitem_partsupp#2217 AS cfpk_lineitem_partsupp_2#2250, cpfk_part_lineitem#2218 AS cpfk_part_lineitem_2#2251, cfpk_lineitem_part#2219 AS cfpk_lineitem_part_2#2252, cpfk_partsupp_lineitem#2220 AS cpfk_partsupp_lineitem_2#2253, cfpk_lineitem_orders#2221 AS cfpk_lineitem_orders_2#2254, cval_lineitem_l_quantity#2222 AS cval_lineitem_l_quantity_2#2255, cval_lineitem_l_extendedprice#2223 AS cval_lineitem_l_extendedprice_2#2256, cval_lineitem_l_discount#2224 AS cval_lineitem_l_discount_2#2257, cval_lineitem_l_tax#2225 AS cval_lineitem_l_tax_2#2258, cval_lineitem_l_returnflag#2226 AS cval_lineitem_l_returnflag_2#2259, cval_lineitem_l_linestatus#2227 AS cval_lineitem_l_linestatus_2#2260, cval_lineitem_l_commitdate#2228 AS cval_lineitem_l_commitdate_2#2261, cval_lineitem_l_receiptdate#2229 AS cval_lineitem_l_receiptdate_2#2262, cval_lineitem_l_shipinstruct#2230 AS cval_lineitem_l_shipinstruct_2#2263, cval_lineitem_l_shipmode#2231 AS cval_lineitem_l_shipmode_2#2264, cval_lineitem_l_comment#2232 AS cval_lineitem_l_comment_2#2265, cval_lineitem_l_shipdate#2233 AS cval_lineitem_l_shipdate_2#2266, cl_quantity#2234 AS cl_quantity_2#2267, cl_extendedprice#2235 AS cl_extendedprice_2#2268, cl_discount#2236 AS cl_discount_2#2269, ... 9 more fields]
            +- Relation[rid#2213,cpfk_orders_lineitem#2214,cpfk_supplier_lineitem#2215,cfpk_lineitem_supplier#2216,cfpk_lineitem_partsupp#2217,cpfk_part_lineitem#2218,cfpk_lineitem_part#2219,cpfk_partsupp_lineitem#2220,cfpk_lineitem_orders#2221,cval_lineitem_l_quantity#2222,cval_lineitem_l_extendedprice#2223,cval_lineitem_l_discount#2224,cval_lineitem_l_tax#2225,cval_lineitem_l_returnflag#2226,cval_lineitem_l_linestatus#2227,cval_lineitem_l_commitdate#2228,cval_lineitem_l_receiptdate#2229,cval_lineitem_l_shipinstruct#2230,cval_lineitem_l_shipmode#2231,cval_lineitem_l_comment#2232,cval_lineitem_l_shipdate#2233,cl_quantity#2234,cl_extendedprice#2235,cl_discount#2236,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 170792ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/15 02:28:36 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:28:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2472L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 02:28:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2472L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#2474 AS rid_0#2507, cpfk_orders_lineitem#2475 AS cpfk_orders_lineitem_0#2508, cpfk_supplier_lineitem#2476 AS cpfk_supplier_lineitem_0#2509, cfpk_lineitem_supplier#2477 AS cfpk_lineitem_supplier_0#2510, cfpk_lineitem_partsupp#2478 AS cfpk_lineitem_partsupp_0#2511, cpfk_part_lineitem#2479 AS cpfk_part_lineitem_0#2512, cfpk_lineitem_part#2480 AS cfpk_lineitem_part_0#2513, cpfk_partsupp_lineitem#2481 AS cpfk_partsupp_lineitem_0#2514, cfpk_lineitem_orders#2482 AS cfpk_lineitem_orders_0#2515, cval_lineitem_l_quantity#2483 AS cval_lineitem_l_quantity_0#2516, cval_lineitem_l_extendedprice#2484 AS cval_lineitem_l_extendedprice_0#2517, cval_lineitem_l_discount#2485 AS cval_lineitem_l_discount_0#2518, cval_lineitem_l_tax#2486 AS cval_lineitem_l_tax_0#2519, cval_lineitem_l_returnflag#2487 AS cval_lineitem_l_returnflag_0#2520, cval_lineitem_l_linestatus#2488 AS cval_lineitem_l_linestatus_0#2521, cval_lineitem_l_commitdate#2489 AS cval_lineitem_l_commitdate_0#2522, cval_lineitem_l_receiptdate#2490 AS cval_lineitem_l_receiptdate_0#2523, cval_lineitem_l_shipinstruct#2491 AS cval_lineitem_l_shipinstruct_0#2524, cval_lineitem_l_shipmode#2492 AS cval_lineitem_l_shipmode_0#2525, cval_lineitem_l_comment#2493 AS cval_lineitem_l_comment_0#2526, cval_lineitem_l_shipdate#2494 AS cval_lineitem_l_shipdate_0#2527, cl_quantity#2495 AS cl_quantity_0#2528, cl_extendedprice#2496 AS cl_extendedprice_0#2529, cl_discount#2497 AS cl_discount_0#2530, ... 9 more fields]
            :  +- Relation[rid#2474,cpfk_orders_lineitem#2475,cpfk_supplier_lineitem#2476,cfpk_lineitem_supplier#2477,cfpk_lineitem_partsupp#2478,cpfk_part_lineitem#2479,cfpk_lineitem_part#2480,cpfk_partsupp_lineitem#2481,cfpk_lineitem_orders#2482,cval_lineitem_l_quantity#2483,cval_lineitem_l_extendedprice#2484,cval_lineitem_l_discount#2485,cval_lineitem_l_tax#2486,cval_lineitem_l_returnflag#2487,cval_lineitem_l_linestatus#2488,cval_lineitem_l_commitdate#2489,cval_lineitem_l_receiptdate#2490,cval_lineitem_l_shipinstruct#2491,cval_lineitem_l_shipmode#2492,cval_lineitem_l_comment#2493,cval_lineitem_l_shipdate#2494,cl_quantity#2495,cl_extendedprice#2496,cl_discount#2497,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#2540 AS rid_1#2557, cpfk_customer_orders#2541 AS cpfk_customer_orders_1#2558, cfpk_orders_customer#2542 AS cfpk_orders_customer_1#2559, cval_orders_o_orderstatus#2543 AS cval_orders_o_orderstatus_1#2560, cval_orders_o_totalprice#2544 AS cval_orders_o_totalprice_1#2561, cval_orders_o_orderpriority#2545 AS cval_orders_o_orderpriority_1#2562, cval_orders_o_clerk#2546 AS cval_orders_o_clerk_1#2563, cval_orders_o_shippriority#2547 AS cval_orders_o_shippriority_1#2564, cval_orders_o_comment#2548 AS cval_orders_o_comment_1#2565, cval_orders_o_orderdate#2549 AS cval_orders_o_orderdate_1#2566, co_orderstatus#2550 AS co_orderstatus_1#2567, co_totalprice#2551 AS co_totalprice_1#2568, co_orderpriority#2552 AS co_orderpriority_1#2569, co_clerk#2553 AS co_clerk_1#2570, co_shippriority#2554 AS co_shippriority_1#2571, co_comment#2555 AS co_comment_1#2572, co_orderdate#2556 AS co_orderdate_1#2573]
               +- Relation[rid#2540,cpfk_customer_orders#2541,cfpk_orders_customer#2542,cval_orders_o_orderstatus#2543,cval_orders_o_totalprice#2544,cval_orders_o_orderpriority#2545,cval_orders_o_clerk#2546,cval_orders_o_shippriority#2547,cval_orders_o_comment#2548,cval_orders_o_orderdate#2549,co_orderstatus#2550,co_totalprice#2551,co_orderpriority#2552,co_clerk#2553,co_shippriority#2554,co_comment#2555,co_orderdate#2556] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 55033ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/15 02:29:31 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:29:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2636L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 02:29:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:29:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:29:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2636L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#2638 AS rid_0#2671, cpfk_orders_lineitem#2639 AS cpfk_orders_lineitem_0#2672, cpfk_supplier_lineitem#2640 AS cpfk_supplier_lineitem_0#2673, cfpk_lineitem_supplier#2641 AS cfpk_lineitem_supplier_0#2674, cfpk_lineitem_partsupp#2642 AS cfpk_lineitem_partsupp_0#2675, cpfk_part_lineitem#2643 AS cpfk_part_lineitem_0#2676, cfpk_lineitem_part#2644 AS cfpk_lineitem_part_0#2677, cpfk_partsupp_lineitem#2645 AS cpfk_partsupp_lineitem_0#2678, cfpk_lineitem_orders#2646 AS cfpk_lineitem_orders_0#2679, cval_lineitem_l_quantity#2647 AS cval_lineitem_l_quantity_0#2680, cval_lineitem_l_extendedprice#2648 AS cval_lineitem_l_extendedprice_0#2681, cval_lineitem_l_discount#2649 AS cval_lineitem_l_discount_0#2682, cval_lineitem_l_tax#2650 AS cval_lineitem_l_tax_0#2683, cval_lineitem_l_returnflag#2651 AS cval_lineitem_l_returnflag_0#2684, cval_lineitem_l_linestatus#2652 AS cval_lineitem_l_linestatus_0#2685, cval_lineitem_l_commitdate#2653 AS cval_lineitem_l_commitdate_0#2686, cval_lineitem_l_receiptdate#2654 AS cval_lineitem_l_receiptdate_0#2687, cval_lineitem_l_shipinstruct#2655 AS cval_lineitem_l_shipinstruct_0#2688, cval_lineitem_l_shipmode#2656 AS cval_lineitem_l_shipmode_0#2689, cval_lineitem_l_comment#2657 AS cval_lineitem_l_comment_0#2690, cval_lineitem_l_shipdate#2658 AS cval_lineitem_l_shipdate_0#2691, cl_quantity#2659 AS cl_quantity_0#2692, cl_extendedprice#2660 AS cl_extendedprice_0#2693, cl_discount#2661 AS cl_discount_0#2694, ... 9 more fields]
            :     :     :  :  +- Relation[rid#2638,cpfk_orders_lineitem#2639,cpfk_supplier_lineitem#2640,cfpk_lineitem_supplier#2641,cfpk_lineitem_partsupp#2642,cpfk_part_lineitem#2643,cfpk_lineitem_part#2644,cpfk_partsupp_lineitem#2645,cfpk_lineitem_orders#2646,cval_lineitem_l_quantity#2647,cval_lineitem_l_extendedprice#2648,cval_lineitem_l_discount#2649,cval_lineitem_l_tax#2650,cval_lineitem_l_returnflag#2651,cval_lineitem_l_linestatus#2652,cval_lineitem_l_commitdate#2653,cval_lineitem_l_receiptdate#2654,cval_lineitem_l_shipinstruct#2655,cval_lineitem_l_shipmode#2656,cval_lineitem_l_comment#2657,cval_lineitem_l_shipdate#2658,cl_quantity#2659,cl_extendedprice#2660,cl_discount#2661,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#2704 AS rid_0#2737, cpfk_orders_lineitem#2705 AS cpfk_orders_lineitem_0#2738, cpfk_supplier_lineitem#2706 AS cpfk_supplier_lineitem_0#2739, cfpk_lineitem_supplier#2707 AS cfpk_lineitem_supplier_0#2740, cfpk_lineitem_partsupp#2708 AS cfpk_lineitem_partsupp_0#2741, cpfk_part_lineitem#2709 AS cpfk_part_lineitem_0#2742, cfpk_lineitem_part#2710 AS cfpk_lineitem_part_0#2743, cpfk_partsupp_lineitem#2711 AS cpfk_partsupp_lineitem_0#2744, cfpk_lineitem_orders#2712 AS cfpk_lineitem_orders_0#2745, cval_lineitem_l_quantity#2713 AS cval_lineitem_l_quantity_0#2746, cval_lineitem_l_extendedprice#2714 AS cval_lineitem_l_extendedprice_0#2747, cval_lineitem_l_discount#2715 AS cval_lineitem_l_discount_0#2748, cval_lineitem_l_tax#2716 AS cval_lineitem_l_tax_0#2749, cval_lineitem_l_returnflag#2717 AS cval_lineitem_l_returnflag_0#2750, cval_lineitem_l_linestatus#2718 AS cval_lineitem_l_linestatus_0#2751, cval_lineitem_l_commitdate#2719 AS cval_lineitem_l_commitdate_0#2752, cval_lineitem_l_receiptdate#2720 AS cval_lineitem_l_receiptdate_0#2753, cval_lineitem_l_shipinstruct#2721 AS cval_lineitem_l_shipinstruct_0#2754, cval_lineitem_l_shipmode#2722 AS cval_lineitem_l_shipmode_0#2755, cval_lineitem_l_comment#2723 AS cval_lineitem_l_comment_0#2756, cval_lineitem_l_shipdate#2724 AS cval_lineitem_l_shipdate_0#2757, cl_quantity#2725 AS cl_quantity_0#2758, cl_extendedprice#2726 AS cl_extendedprice_0#2759, cl_discount#2727 AS cl_discount_0#2760, ... 9 more fields]
            :     :     :        +- Relation[rid#2704,cpfk_orders_lineitem#2705,cpfk_supplier_lineitem#2706,cfpk_lineitem_supplier#2707,cfpk_lineitem_partsupp#2708,cpfk_part_lineitem#2709,cfpk_lineitem_part#2710,cpfk_partsupp_lineitem#2711,cfpk_lineitem_orders#2712,cval_lineitem_l_quantity#2713,cval_lineitem_l_extendedprice#2714,cval_lineitem_l_discount#2715,cval_lineitem_l_tax#2716,cval_lineitem_l_returnflag#2717,cval_lineitem_l_linestatus#2718,cval_lineitem_l_commitdate#2719,cval_lineitem_l_receiptdate#2720,cval_lineitem_l_shipinstruct#2721,cval_lineitem_l_shipmode#2722,cval_lineitem_l_comment#2723,cval_lineitem_l_shipdate#2724,cl_quantity#2725,cl_extendedprice#2726,cl_discount#2727,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#2770 AS rid_1#2787, cpfk_customer_orders#2771 AS cpfk_customer_orders_1#2788, cfpk_orders_customer#2772 AS cfpk_orders_customer_1#2789, cval_orders_o_orderstatus#2773 AS cval_orders_o_orderstatus_1#2790, cval_orders_o_totalprice#2774 AS cval_orders_o_totalprice_1#2791, cval_orders_o_orderpriority#2775 AS cval_orders_o_orderpriority_1#2792, cval_orders_o_clerk#2776 AS cval_orders_o_clerk_1#2793, cval_orders_o_shippriority#2777 AS cval_orders_o_shippriority_1#2794, cval_orders_o_comment#2778 AS cval_orders_o_comment_1#2795, cval_orders_o_orderdate#2779 AS cval_orders_o_orderdate_1#2796, co_orderstatus#2780 AS co_orderstatus_1#2797, co_totalprice#2781 AS co_totalprice_1#2798, co_orderpriority#2782 AS co_orderpriority_1#2799, co_clerk#2783 AS co_clerk_1#2800, co_shippriority#2784 AS co_shippriority_1#2801, co_comment#2785 AS co_comment_1#2802, co_orderdate#2786 AS co_orderdate_1#2803]
            :     :        +- Relation[rid#2770,cpfk_customer_orders#2771,cfpk_orders_customer#2772,cval_orders_o_orderstatus#2773,cval_orders_o_totalprice#2774,cval_orders_o_orderpriority#2775,cval_orders_o_clerk#2776,cval_orders_o_shippriority#2777,cval_orders_o_comment#2778,cval_orders_o_orderdate#2779,co_orderstatus#2780,co_totalprice#2781,co_orderpriority#2782,co_clerk#2783,co_shippriority#2784,co_comment#2785,co_orderdate#2786] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#2804 AS rid_2#2819, cpfk_nation_customer#2805 AS cpfk_nation_customer_2#2820, cfpk_customer_nation#2806 AS cfpk_customer_nation_2#2821, cval_customer_c_name#2807 AS cval_customer_c_name_2#2822, cval_customer_c_address#2808 AS cval_customer_c_address_2#2823, cval_customer_c_phone#2809 AS cval_customer_c_phone_2#2824, cval_customer_c_acctbal#2810 AS cval_customer_c_acctbal_2#2825, cval_customer_c_comment#2811 AS cval_customer_c_comment_2#2826, cval_customer_c_mktsegment#2812 AS cval_customer_c_mktsegment_2#2827, cc_name#2813 AS cc_name_2#2828, cc_address#2814 AS cc_address_2#2829, cc_phone#2815 AS cc_phone_2#2830, cc_acctbal#2816 AS cc_acctbal_2#2831, cc_comment#2817 AS cc_comment_2#2832, cc_mktsegment#2818 AS cc_mktsegment_2#2833]
            :        +- Relation[rid#2804,cpfk_nation_customer#2805,cfpk_customer_nation#2806,cval_customer_c_name#2807,cval_customer_c_address#2808,cval_customer_c_phone#2809,cval_customer_c_acctbal#2810,cval_customer_c_comment#2811,cval_customer_c_mktsegment#2812,cc_name#2813,cc_address#2814,cc_phone#2815,cc_acctbal#2816,cc_comment#2817,cc_mktsegment#2818] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#2834 AS rid_3#2841, cpfk_region_nation#2835 AS cpfk_region_nation_3#2842, cfpk_nation_region#2836 AS cfpk_nation_region_3#2843, cval_nation_n_name#2837 AS cval_nation_n_name_3#2844, cval_nation_n_comment#2838 AS cval_nation_n_comment_3#2845, cn_name#2839 AS cn_name_3#2846, cn_comment#2840 AS cn_comment_3#2847]
               +- Relation[rid#2834,cpfk_region_nation#2835,cfpk_nation_region#2836,cval_nation_n_name#2837,cval_nation_n_comment#2838,cn_name#2839,cn_comment#2840] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 67594ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/15 02:30:38 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:30:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2925L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 02:30:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#2925L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#2927 AS rid_0#2960, cpfk_orders_lineitem#2928 AS cpfk_orders_lineitem_0#2961, cpfk_supplier_lineitem#2929 AS cpfk_supplier_lineitem_0#2962, cfpk_lineitem_supplier#2930 AS cfpk_lineitem_supplier_0#2963, cfpk_lineitem_partsupp#2931 AS cfpk_lineitem_partsupp_0#2964, cpfk_part_lineitem#2932 AS cpfk_part_lineitem_0#2965, cfpk_lineitem_part#2933 AS cfpk_lineitem_part_0#2966, cpfk_partsupp_lineitem#2934 AS cpfk_partsupp_lineitem_0#2967, cfpk_lineitem_orders#2935 AS cfpk_lineitem_orders_0#2968, cval_lineitem_l_quantity#2936 AS cval_lineitem_l_quantity_0#2969, cval_lineitem_l_extendedprice#2937 AS cval_lineitem_l_extendedprice_0#2970, cval_lineitem_l_discount#2938 AS cval_lineitem_l_discount_0#2971, cval_lineitem_l_tax#2939 AS cval_lineitem_l_tax_0#2972, cval_lineitem_l_returnflag#2940 AS cval_lineitem_l_returnflag_0#2973, cval_lineitem_l_linestatus#2941 AS cval_lineitem_l_linestatus_0#2974, cval_lineitem_l_commitdate#2942 AS cval_lineitem_l_commitdate_0#2975, cval_lineitem_l_receiptdate#2943 AS cval_lineitem_l_receiptdate_0#2976, cval_lineitem_l_shipinstruct#2944 AS cval_lineitem_l_shipinstruct_0#2977, cval_lineitem_l_shipmode#2945 AS cval_lineitem_l_shipmode_0#2978, cval_lineitem_l_comment#2946 AS cval_lineitem_l_comment_0#2979, cval_lineitem_l_shipdate#2947 AS cval_lineitem_l_shipdate_0#2980, cl_quantity#2948 AS cl_quantity_0#2981, cl_extendedprice#2949 AS cl_extendedprice_0#2982, cl_discount#2950 AS cl_discount_0#2983, ... 9 more fields]
         +- Relation[rid#2927,cpfk_orders_lineitem#2928,cpfk_supplier_lineitem#2929,cfpk_lineitem_supplier#2930,cfpk_lineitem_partsupp#2931,cpfk_part_lineitem#2932,cfpk_lineitem_part#2933,cpfk_partsupp_lineitem#2934,cfpk_lineitem_orders#2935,cval_lineitem_l_quantity#2936,cval_lineitem_l_extendedprice#2937,cval_lineitem_l_discount#2938,cval_lineitem_l_tax#2939,cval_lineitem_l_returnflag#2940,cval_lineitem_l_linestatus#2941,cval_lineitem_l_commitdate#2942,cval_lineitem_l_receiptdate#2943,cval_lineitem_l_shipinstruct#2944,cval_lineitem_l_shipmode#2945,cval_lineitem_l_comment#2946,cval_lineitem_l_shipdate#2947,cl_quantity#2948,cl_extendedprice#2949,cl_discount#2950,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2620ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/15 02:30:41 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:30:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3033L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 02:30:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:30:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:30:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:30:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:30:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:30:41 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 02:30:41 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 02:30:41 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 02:30:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:30:41 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 02:30:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:30:41 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 02:30:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:30:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:30:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:30:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3033L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#3035 AS rid_0#3052, cval_part_p_name#3036 AS cval_part_p_name_0#3053, cval_part_p_mfgr#3037 AS cval_part_p_mfgr_0#3054, cval_part_p_type#3038 AS cval_part_p_type_0#3055, cval_part_p_size#3039 AS cval_part_p_size_0#3056, cval_part_p_container#3040 AS cval_part_p_container_0#3057, cval_part_p_retailprice#3041 AS cval_part_p_retailprice_0#3058, cval_part_p_comment#3042 AS cval_part_p_comment_0#3059, cval_part_p_brand#3043 AS cval_part_p_brand_0#3060, cp_name#3044 AS cp_name_0#3061, cp_mfgr#3045 AS cp_mfgr_0#3062, cp_type#3046 AS cp_type_0#3063, cp_size#3047 AS cp_size_0#3064, cp_container#3048 AS cp_container_0#3065, cp_retailprice#3049 AS cp_retailprice_0#3066, cp_comment#3050 AS cp_comment_0#3067, cp_brand#3051 AS cp_brand_0#3068]
            :     :     :  :  :  :  +- Relation[rid#3035,cval_part_p_name#3036,cval_part_p_mfgr#3037,cval_part_p_type#3038,cval_part_p_size#3039,cval_part_p_container#3040,cval_part_p_retailprice#3041,cval_part_p_comment#3042,cval_part_p_brand#3043,cp_name#3044,cp_mfgr#3045,cp_type#3046,cp_size#3047,cp_container#3048,cp_retailprice#3049,cp_comment#3050,cp_brand#3051] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#3069 AS rid_0#3086, cval_part_p_name#3070 AS cval_part_p_name_0#3087, cval_part_p_mfgr#3071 AS cval_part_p_mfgr_0#3088, cval_part_p_type#3072 AS cval_part_p_type_0#3089, cval_part_p_size#3073 AS cval_part_p_size_0#3090, cval_part_p_container#3074 AS cval_part_p_container_0#3091, cval_part_p_retailprice#3075 AS cval_part_p_retailprice_0#3092, cval_part_p_comment#3076 AS cval_part_p_comment_0#3093, cval_part_p_brand#3077 AS cval_part_p_brand_0#3094, cp_name#3078 AS cp_name_0#3095, cp_mfgr#3079 AS cp_mfgr_0#3096, cp_type#3080 AS cp_type_0#3097, cp_size#3081 AS cp_size_0#3098, cp_container#3082 AS cp_container_0#3099, cp_retailprice#3083 AS cp_retailprice_0#3100, cp_comment#3084 AS cp_comment_0#3101, cp_brand#3085 AS cp_brand_0#3102]
            :     :     :  :  :        +- Relation[rid#3069,cval_part_p_name#3070,cval_part_p_mfgr#3071,cval_part_p_type#3072,cval_part_p_size#3073,cval_part_p_container#3074,cval_part_p_retailprice#3075,cval_part_p_comment#3076,cval_part_p_brand#3077,cp_name#3078,cp_mfgr#3079,cp_type#3080,cp_size#3081,cp_container#3082,cp_retailprice#3083,cp_comment#3084,cp_brand#3085] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :     :- Project [rid#3169 AS rid_0#3186, cval_part_p_name#3170 AS cval_part_p_name_0#3187, cval_part_p_mfgr#3171 AS cval_part_p_mfgr_0#3188, cval_part_p_type#3172 AS cval_part_p_type_0#3189, cval_part_p_size#3173 AS cval_part_p_size_0#3190, cval_part_p_container#3174 AS cval_part_p_container_0#3191, cval_part_p_retailprice#3175 AS cval_part_p_retailprice_0#3192, cval_part_p_comment#3176 AS cval_part_p_comment_0#3193, cval_part_p_brand#3177 AS cval_part_p_brand_0#3194, cp_name#3178 AS cp_name_0#3195, cp_mfgr#3179 AS cp_mfgr_0#3196, cp_type#3180 AS cp_type_0#3197, cp_size#3181 AS cp_size_0#3198, cp_container#3182 AS cp_container_0#3199, cp_retailprice#3183 AS cp_retailprice_0#3200, cp_comment#3184 AS cp_comment_0#3201, cp_brand#3185 AS cp_brand_0#3202]
            :     :     :  :     :  +- Relation[rid#3169,cval_part_p_name#3170,cval_part_p_mfgr#3171,cval_part_p_type#3172,cval_part_p_size#3173,cval_part_p_container#3174,cval_part_p_retailprice#3175,cval_part_p_comment#3176,cval_part_p_brand#3177,cp_name#3178,cp_mfgr#3179,cp_type#3180,cp_size#3181,cp_container#3182,cp_retailprice#3183,cp_comment#3184,cp_brand#3185] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :     +- Project [rid#3203 AS rid_1#3236, cpfk_orders_lineitem#3204 AS cpfk_orders_lineitem_1#3237, cpfk_supplier_lineitem#3205 AS cpfk_supplier_lineitem_1#3238, cfpk_lineitem_supplier#3206 AS cfpk_lineitem_supplier_1#3239, cfpk_lineitem_partsupp#3207 AS cfpk_lineitem_partsupp_1#3240, cpfk_part_lineitem#3208 AS cpfk_part_lineitem_1#3241, cfpk_lineitem_part#3209 AS cfpk_lineitem_part_1#3242, cpfk_partsupp_lineitem#3210 AS cpfk_partsupp_lineitem_1#3243, cfpk_lineitem_orders#3211 AS cfpk_lineitem_orders_1#3244, cval_lineitem_l_quantity#3212 AS cval_lineitem_l_quantity_1#3245, cval_lineitem_l_extendedprice#3213 AS cval_lineitem_l_extendedprice_1#3246, cval_lineitem_l_discount#3214 AS cval_lineitem_l_discount_1#3247, cval_lineitem_l_tax#3215 AS cval_lineitem_l_tax_1#3248, cval_lineitem_l_returnflag#3216 AS cval_lineitem_l_returnflag_1#3249, cval_lineitem_l_linestatus#3217 AS cval_lineitem_l_linestatus_1#3250, cval_lineitem_l_commitdate#3218 AS cval_lineitem_l_commitdate_1#3251, cval_lineitem_l_receiptdate#3219 AS cval_lineitem_l_receiptdate_1#3252, cval_lineitem_l_shipinstruct#3220 AS cval_lineitem_l_shipinstruct_1#3253, cval_lineitem_l_shipmode#3221 AS cval_lineitem_l_shipmode_1#3254, cval_lineitem_l_comment#3222 AS cval_lineitem_l_comment_1#3255, cval_lineitem_l_shipdate#3223 AS cval_lineitem_l_shipdate_1#3256, cl_quantity#3224 AS cl_quantity_1#3257, cl_extendedprice#3225 AS cl_extendedprice_1#3258, cl_discount#3226 AS cl_discount_1#3259, ... 9 more fields]
            :     :     :  :        +- Relation[rid#3203,cpfk_orders_lineitem#3204,cpfk_supplier_lineitem#3205,cfpk_lineitem_supplier#3206,cfpk_lineitem_partsupp#3207,cpfk_part_lineitem#3208,cfpk_lineitem_part#3209,cpfk_partsupp_lineitem#3210,cfpk_lineitem_orders#3211,cval_lineitem_l_quantity#3212,cval_lineitem_l_extendedprice#3213,cval_lineitem_l_discount#3214,cval_lineitem_l_tax#3215,cval_lineitem_l_returnflag#3216,cval_lineitem_l_linestatus#3217,cval_lineitem_l_commitdate#3218,cval_lineitem_l_receiptdate#3219,cval_lineitem_l_shipinstruct#3220,cval_lineitem_l_shipmode#3221,cval_lineitem_l_comment#3222,cval_lineitem_l_shipdate#3223,cl_quantity#3224,cl_extendedprice#3225,cl_discount#3226,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#3103 AS rid_1#3136, cpfk_orders_lineitem#3104 AS cpfk_orders_lineitem_1#3137, cpfk_supplier_lineitem#3105 AS cpfk_supplier_lineitem_1#3138, cfpk_lineitem_supplier#3106 AS cfpk_lineitem_supplier_1#3139, cfpk_lineitem_partsupp#3107 AS cfpk_lineitem_partsupp_1#3140, cpfk_part_lineitem#3108 AS cpfk_part_lineitem_1#3141, cfpk_lineitem_part#3109 AS cfpk_lineitem_part_1#3142, cpfk_partsupp_lineitem#3110 AS cpfk_partsupp_lineitem_1#3143, cfpk_lineitem_orders#3111 AS cfpk_lineitem_orders_1#3144, cval_lineitem_l_quantity#3112 AS cval_lineitem_l_quantity_1#3145, cval_lineitem_l_extendedprice#3113 AS cval_lineitem_l_extendedprice_1#3146, cval_lineitem_l_discount#3114 AS cval_lineitem_l_discount_1#3147, cval_lineitem_l_tax#3115 AS cval_lineitem_l_tax_1#3148, cval_lineitem_l_returnflag#3116 AS cval_lineitem_l_returnflag_1#3149, cval_lineitem_l_linestatus#3117 AS cval_lineitem_l_linestatus_1#3150, cval_lineitem_l_commitdate#3118 AS cval_lineitem_l_commitdate_1#3151, cval_lineitem_l_receiptdate#3119 AS cval_lineitem_l_receiptdate_1#3152, cval_lineitem_l_shipinstruct#3120 AS cval_lineitem_l_shipinstruct_1#3153, cval_lineitem_l_shipmode#3121 AS cval_lineitem_l_shipmode_1#3154, cval_lineitem_l_comment#3122 AS cval_lineitem_l_comment_1#3155, cval_lineitem_l_shipdate#3123 AS cval_lineitem_l_shipdate_1#3156, cl_quantity#3124 AS cl_quantity_1#3157, cl_extendedprice#3125 AS cl_extendedprice_1#3158, cl_discount#3126 AS cl_discount_1#3159, ... 9 more fields]
            :     :     :     +- Relation[rid#3103,cpfk_orders_lineitem#3104,cpfk_supplier_lineitem#3105,cfpk_lineitem_supplier#3106,cfpk_lineitem_partsupp#3107,cpfk_part_lineitem#3108,cfpk_lineitem_part#3109,cpfk_partsupp_lineitem#3110,cfpk_lineitem_orders#3111,cval_lineitem_l_quantity#3112,cval_lineitem_l_extendedprice#3113,cval_lineitem_l_discount#3114,cval_lineitem_l_tax#3115,cval_lineitem_l_returnflag#3116,cval_lineitem_l_linestatus#3117,cval_lineitem_l_commitdate#3118,cval_lineitem_l_receiptdate#3119,cval_lineitem_l_shipinstruct#3120,cval_lineitem_l_shipmode#3121,cval_lineitem_l_comment#3122,cval_lineitem_l_shipdate#3123,cl_quantity#3124,cl_extendedprice#3125,cl_discount#3126,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#3269 AS rid_2#3282, cpfk_nation_supplier#3270 AS cpfk_nation_supplier_2#3283, cfpk_supplier_nation#3271 AS cfpk_supplier_nation_2#3284, cval_supplier_s_name#3272 AS cval_supplier_s_name_2#3285, cval_supplier_s_address#3273 AS cval_supplier_s_address_2#3286, cval_supplier_s_phone#3274 AS cval_supplier_s_phone_2#3287, cval_supplier_s_acctbal#3275 AS cval_supplier_s_acctbal_2#3288, cval_supplier_s_comment#3276 AS cval_supplier_s_comment_2#3289, cs_name#3277 AS cs_name_2#3290, cs_address#3278 AS cs_address_2#3291, cs_phone#3279 AS cs_phone_2#3292, cs_acctbal#3280 AS cs_acctbal_2#3293, cs_comment#3281 AS cs_comment_2#3294]
            :     :        +- Relation[rid#3269,cpfk_nation_supplier#3270,cfpk_supplier_nation#3271,cval_supplier_s_name#3272,cval_supplier_s_address#3273,cval_supplier_s_phone#3274,cval_supplier_s_acctbal#3275,cval_supplier_s_comment#3276,cs_name#3277,cs_address#3278,cs_phone#3279,cs_acctbal#3280,cs_comment#3281] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#3295 AS rid_3#3302, cpfk_region_nation#3296 AS cpfk_region_nation_3#3303, cfpk_nation_region#3297 AS cfpk_nation_region_3#3304, cval_nation_n_name#3298 AS cval_nation_n_name_3#3305, cval_nation_n_comment#3299 AS cval_nation_n_comment_3#3306, cn_name#3300 AS cn_name_3#3307, cn_comment#3301 AS cn_comment_3#3308]
            :        +- Relation[rid#3295,cpfk_region_nation#3296,cfpk_nation_region#3297,cval_nation_n_name#3298,cval_nation_n_comment#3299,cn_name#3300,cn_comment#3301] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'Join UsingJoin(Inner,List(rid_6))
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#3309 AS rid_4#3314, cval_region_r_name#3310 AS cval_region_r_name_4#3315, cval_region_r_comment#3311 AS cval_region_r_comment_4#3316, cr_name#3312 AS cr_name_4#3317, cr_comment#3313 AS cr_comment_4#3318]
               :  :  :  :  :  :  :  +- Relation[rid#3309,cval_region_r_name#3310,cval_region_r_comment#3311,cr_name#3312,cr_comment#3313] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#3319 AS rid_4#3324, cval_region_r_name#3320 AS cval_region_r_name_4#3325, cval_region_r_comment#3321 AS cval_region_r_comment_4#3326, cr_name#3322 AS cr_name_4#3327, cr_comment#3323 AS cr_comment_4#3328]
               :  :  :  :  :  :        +- Relation[rid#3319,cval_region_r_name#3320,cval_region_r_comment#3321,cr_name#3322,cr_comment#3323] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :     :- Project [rid#3343 AS rid_4#3348, cval_region_r_name#3344 AS cval_region_r_name_4#3349, cval_region_r_comment#3345 AS cval_region_r_comment_4#3350, cr_name#3346 AS cr_name_4#3351, cr_comment#3347 AS cr_comment_4#3352]
               :  :  :  :  :     :  +- Relation[rid#3343,cval_region_r_name#3344,cval_region_r_comment#3345,cr_name#3346,cr_comment#3347] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :     +- Project [rid#3353 AS rid_5#3360, cpfk_region_nation#3354 AS cpfk_region_nation_5#3361, cfpk_nation_region#3355 AS cfpk_nation_region_5#3362, cval_nation_n_name#3356 AS cval_nation_n_name_5#3363, cval_nation_n_comment#3357 AS cval_nation_n_comment_5#3364, cn_name#3358 AS cn_name_5#3365, cn_comment#3359 AS cn_comment_5#3366]
               :  :  :  :  :        +- Relation[rid#3353,cpfk_region_nation#3354,cfpk_nation_region#3355,cval_nation_n_name#3356,cval_nation_n_comment#3357,cn_name#3358,cn_comment#3359] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#3329 AS rid_5#3336, cpfk_region_nation#3330 AS cpfk_region_nation_5#3337, cfpk_nation_region#3331 AS cfpk_nation_region_5#3338, cval_nation_n_name#3332 AS cval_nation_n_name_5#3339, cval_nation_n_comment#3333 AS cval_nation_n_comment_5#3340, cn_name#3334 AS cn_name_5#3341, cn_comment#3335 AS cn_comment_5#3342]
               :  :  :  :     +- Relation[rid#3329,cpfk_region_nation#3330,cfpk_nation_region#3331,cval_nation_n_name#3332,cval_nation_n_comment#3333,cn_name#3334,cn_comment#3335] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :     :- Project [rid#3397 AS rid_5#3404, cpfk_region_nation#3398 AS cpfk_region_nation_5#3405, cfpk_nation_region#3399 AS cfpk_nation_region_5#3406, cval_nation_n_name#3400 AS cval_nation_n_name_5#3407, cval_nation_n_comment#3401 AS cval_nation_n_comment_5#3408, cn_name#3402 AS cn_name_5#3409, cn_comment#3403 AS cn_comment_5#3410]
               :  :  :     :  +- Relation[rid#3397,cpfk_region_nation#3398,cfpk_nation_region#3399,cval_nation_n_name#3400,cval_nation_n_comment#3401,cn_name#3402,cn_comment#3403] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#3411 AS rid_6#3426, cpfk_nation_customer#3412 AS cpfk_nation_customer_6#3427, cfpk_customer_nation#3413 AS cfpk_customer_nation_6#3428, cval_customer_c_name#3414 AS cval_customer_c_name_6#3429, cval_customer_c_address#3415 AS cval_customer_c_address_6#3430, cval_customer_c_phone#3416 AS cval_customer_c_phone_6#3431, cval_customer_c_acctbal#3417 AS cval_customer_c_acctbal_6#3432, cval_customer_c_comment#3418 AS cval_customer_c_comment_6#3433, cval_customer_c_mktsegment#3419 AS cval_customer_c_mktsegment_6#3434, cc_name#3420 AS cc_name_6#3435, cc_address#3421 AS cc_address_6#3436, cc_phone#3422 AS cc_phone_6#3437, cc_acctbal#3423 AS cc_acctbal_6#3438, cc_comment#3424 AS cc_comment_6#3439, cc_mktsegment#3425 AS cc_mktsegment_6#3440]
               :  :  :        +- Relation[rid#3411,cpfk_nation_customer#3412,cfpk_customer_nation#3413,cval_customer_c_name#3414,cval_customer_c_address#3415,cval_customer_c_phone#3416,cval_customer_c_acctbal#3417,cval_customer_c_comment#3418,cval_customer_c_mktsegment#3419,cc_name#3420,cc_address#3421,cc_phone#3422,cc_acctbal#3423,cc_comment#3424,cc_mktsegment#3425] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#3367 AS rid_6#3382, cpfk_nation_customer#3368 AS cpfk_nation_customer_6#3383, cfpk_customer_nation#3369 AS cfpk_customer_nation_6#3384, cval_customer_c_name#3370 AS cval_customer_c_name_6#3385, cval_customer_c_address#3371 AS cval_customer_c_address_6#3386, cval_customer_c_phone#3372 AS cval_customer_c_phone_6#3387, cval_customer_c_acctbal#3373 AS cval_customer_c_acctbal_6#3388, cval_customer_c_comment#3374 AS cval_customer_c_comment_6#3389, cval_customer_c_mktsegment#3375 AS cval_customer_c_mktsegment_6#3390, cc_name#3376 AS cc_name_6#3391, cc_address#3377 AS cc_address_6#3392, cc_phone#3378 AS cc_phone_6#3393, cc_acctbal#3379 AS cc_acctbal_6#3394, cc_comment#3380 AS cc_comment_6#3395, cc_mktsegment#3381 AS cc_mktsegment_6#3396]
               :  :     +- Relation[rid#3367,cpfk_nation_customer#3368,cfpk_customer_nation#3369,cval_customer_c_name#3370,cval_customer_c_address#3371,cval_customer_c_phone#3372,cval_customer_c_acctbal#3373,cval_customer_c_comment#3374,cval_customer_c_mktsegment#3375,cc_name#3376,cc_address#3377,cc_phone#3378,cc_acctbal#3379,cc_comment#3380,cc_mktsegment#3381] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :     :- Project [rid#3475 AS rid_6#3490, cpfk_nation_customer#3476 AS cpfk_nation_customer_6#3491, cfpk_customer_nation#3477 AS cfpk_customer_nation_6#3492, cval_customer_c_name#3478 AS cval_customer_c_name_6#3493, cval_customer_c_address#3479 AS cval_customer_c_address_6#3494, cval_customer_c_phone#3480 AS cval_customer_c_phone_6#3495, cval_customer_c_acctbal#3481 AS cval_customer_c_acctbal_6#3496, cval_customer_c_comment#3482 AS cval_customer_c_comment_6#3497, cval_customer_c_mktsegment#3483 AS cval_customer_c_mktsegment_6#3498, cc_name#3484 AS cc_name_6#3499, cc_address#3485 AS cc_address_6#3500, cc_phone#3486 AS cc_phone_6#3501, cc_acctbal#3487 AS cc_acctbal_6#3502, cc_comment#3488 AS cc_comment_6#3503, cc_mktsegment#3489 AS cc_mktsegment_6#3504]
               :     :  +- Relation[rid#3475,cpfk_nation_customer#3476,cfpk_customer_nation#3477,cval_customer_c_name#3478,cval_customer_c_address#3479,cval_customer_c_phone#3480,cval_customer_c_acctbal#3481,cval_customer_c_comment#3482,cval_customer_c_mktsegment#3483,cc_name#3484,cc_address#3485,cc_phone#3486,cc_acctbal#3487,cc_comment#3488,cc_mktsegment#3489] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#3505 AS rid_7#3522, cpfk_customer_orders#3506 AS cpfk_customer_orders_7#3523, cfpk_orders_customer#3507 AS cfpk_orders_customer_7#3524, cval_orders_o_orderstatus#3508 AS cval_orders_o_orderstatus_7#3525, cval_orders_o_totalprice#3509 AS cval_orders_o_totalprice_7#3526, cval_orders_o_orderpriority#3510 AS cval_orders_o_orderpriority_7#3527, cval_orders_o_clerk#3511 AS cval_orders_o_clerk_7#3528, cval_orders_o_shippriority#3512 AS cval_orders_o_shippriority_7#3529, cval_orders_o_comment#3513 AS cval_orders_o_comment_7#3530, cval_orders_o_orderdate#3514 AS cval_orders_o_orderdate_7#3531, co_orderstatus#3515 AS co_orderstatus_7#3532, co_totalprice#3516 AS co_totalprice_7#3533, co_orderpriority#3517 AS co_orderpriority_7#3534, co_clerk#3518 AS co_clerk_7#3535, co_shippriority#3519 AS co_shippriority_7#3536, co_comment#3520 AS co_comment_7#3537, co_orderdate#3521 AS co_orderdate_7#3538]
               :        +- Relation[rid#3505,cpfk_customer_orders#3506,cfpk_orders_customer#3507,cval_orders_o_orderstatus#3508,cval_orders_o_totalprice#3509,cval_orders_o_orderpriority#3510,cval_orders_o_clerk#3511,cval_orders_o_shippriority#3512,cval_orders_o_comment#3513,cval_orders_o_orderdate#3514,co_orderstatus#3515,co_totalprice#3516,co_orderpriority#3517,co_clerk#3518,co_shippriority#3519,co_comment#3520,co_orderdate#3521] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#3441 AS rid_7#3458, cpfk_customer_orders#3442 AS cpfk_customer_orders_7#3459, cfpk_orders_customer#3443 AS cfpk_orders_customer_7#3460, cval_orders_o_orderstatus#3444 AS cval_orders_o_orderstatus_7#3461, cval_orders_o_totalprice#3445 AS cval_orders_o_totalprice_7#3462, cval_orders_o_orderpriority#3446 AS cval_orders_o_orderpriority_7#3463, cval_orders_o_clerk#3447 AS cval_orders_o_clerk_7#3464, cval_orders_o_shippriority#3448 AS cval_orders_o_shippriority_7#3465, cval_orders_o_comment#3449 AS cval_orders_o_comment_7#3466, cval_orders_o_orderdate#3450 AS cval_orders_o_orderdate_7#3467, co_orderstatus#3451 AS co_orderstatus_7#3468, co_totalprice#3452 AS co_totalprice_7#3469, co_orderpriority#3453 AS co_orderpriority_7#3470, co_clerk#3454 AS co_clerk_7#3471, co_shippriority#3455 AS co_shippriority_7#3472, co_comment#3456 AS co_comment_7#3473, co_orderdate#3457 AS co_orderdate_7#3474]
                  +- Relation[rid#3441,cpfk_customer_orders#3442,cfpk_orders_customer#3443,cval_orders_o_orderstatus#3444,cval_orders_o_totalprice#3445,cval_orders_o_orderpriority#3446,cval_orders_o_clerk#3447,cval_orders_o_shippriority#3448,cval_orders_o_comment#3449,cval_orders_o_orderdate#3450,co_orderstatus#3451,co_totalprice#3452,co_orderpriority#3453,co_clerk#3454,co_shippriority#3455,co_comment#3456,co_orderdate#3457] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 99041ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/15 02:32:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:32:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3658L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 02:32:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3658L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#3660 AS rid_0#3677, cpfk_customer_orders#3661 AS cpfk_customer_orders_0#3678, cfpk_orders_customer#3662 AS cfpk_orders_customer_0#3679, cval_orders_o_orderstatus#3663 AS cval_orders_o_orderstatus_0#3680, cval_orders_o_totalprice#3664 AS cval_orders_o_totalprice_0#3681, cval_orders_o_orderpriority#3665 AS cval_orders_o_orderpriority_0#3682, cval_orders_o_clerk#3666 AS cval_orders_o_clerk_0#3683, cval_orders_o_shippriority#3667 AS cval_orders_o_shippriority_0#3684, cval_orders_o_comment#3668 AS cval_orders_o_comment_0#3685, cval_orders_o_orderdate#3669 AS cval_orders_o_orderdate_0#3686, co_orderstatus#3670 AS co_orderstatus_0#3687, co_totalprice#3671 AS co_totalprice_0#3688, co_orderpriority#3672 AS co_orderpriority_0#3689, co_clerk#3673 AS co_clerk_0#3690, co_shippriority#3674 AS co_shippriority_0#3691, co_comment#3675 AS co_comment_0#3692, co_orderdate#3676 AS co_orderdate_0#3693]
            :  +- Relation[rid#3660,cpfk_customer_orders#3661,cfpk_orders_customer#3662,cval_orders_o_orderstatus#3663,cval_orders_o_totalprice#3664,cval_orders_o_orderpriority#3665,cval_orders_o_clerk#3666,cval_orders_o_shippriority#3667,cval_orders_o_comment#3668,cval_orders_o_orderdate#3669,co_orderstatus#3670,co_totalprice#3671,co_orderpriority#3672,co_clerk#3673,co_shippriority#3674,co_comment#3675,co_orderdate#3676] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#3694 AS rid_1#3709, cpfk_nation_customer#3695 AS cpfk_nation_customer_1#3710, cfpk_customer_nation#3696 AS cfpk_customer_nation_1#3711, cval_customer_c_name#3697 AS cval_customer_c_name_1#3712, cval_customer_c_address#3698 AS cval_customer_c_address_1#3713, cval_customer_c_phone#3699 AS cval_customer_c_phone_1#3714, cval_customer_c_acctbal#3700 AS cval_customer_c_acctbal_1#3715, cval_customer_c_comment#3701 AS cval_customer_c_comment_1#3716, cval_customer_c_mktsegment#3702 AS cval_customer_c_mktsegment_1#3717, cc_name#3703 AS cc_name_1#3718, cc_address#3704 AS cc_address_1#3719, cc_phone#3705 AS cc_phone_1#3720, cc_acctbal#3706 AS cc_acctbal_1#3721, cc_comment#3707 AS cc_comment_1#3722, cc_mktsegment#3708 AS cc_mktsegment_1#3723]
               +- Relation[rid#3694,cpfk_nation_customer#3695,cfpk_customer_nation#3696,cval_customer_c_name#3697,cval_customer_c_address#3698,cval_customer_c_phone#3699,cval_customer_c_acctbal#3700,cval_customer_c_comment#3701,cval_customer_c_mktsegment#3702,cc_name#3703,cc_address#3704,cc_phone#3705,cc_acctbal#3706,cc_comment#3707,cc_mktsegment#3708] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 12976ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/15 02:32:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:32:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3761L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 02:32:33 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:32:33 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:32:33 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:32:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:32:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:32:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:32:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:32:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:32:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:32:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:32:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:32:33 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:32:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:32:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3761L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#3763 AS rid_0#3780, cval_part_p_name#3764 AS cval_part_p_name_0#3781, cval_part_p_mfgr#3765 AS cval_part_p_mfgr_0#3782, cval_part_p_type#3766 AS cval_part_p_type_0#3783, cval_part_p_size#3767 AS cval_part_p_size_0#3784, cval_part_p_container#3768 AS cval_part_p_container_0#3785, cval_part_p_retailprice#3769 AS cval_part_p_retailprice_0#3786, cval_part_p_comment#3770 AS cval_part_p_comment_0#3787, cval_part_p_brand#3771 AS cval_part_p_brand_0#3788, cp_name#3772 AS cp_name_0#3789, cp_mfgr#3773 AS cp_mfgr_0#3790, cp_type#3774 AS cp_type_0#3791, cp_size#3775 AS cp_size_0#3792, cp_container#3776 AS cp_container_0#3793, cp_retailprice#3777 AS cp_retailprice_0#3794, cp_comment#3778 AS cp_comment_0#3795, cp_brand#3779 AS cp_brand_0#3796]
            :  :  :  :  +- Relation[rid#3763,cval_part_p_name#3764,cval_part_p_mfgr#3765,cval_part_p_type#3766,cval_part_p_size#3767,cval_part_p_container#3768,cval_part_p_retailprice#3769,cval_part_p_comment#3770,cval_part_p_brand#3771,cp_name#3772,cp_mfgr#3773,cp_type#3774,cp_size#3775,cp_container#3776,cp_retailprice#3777,cp_comment#3778,cp_brand#3779] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#3797 AS rid_0#3814, cval_part_p_name#3798 AS cval_part_p_name_0#3815, cval_part_p_mfgr#3799 AS cval_part_p_mfgr_0#3816, cval_part_p_type#3800 AS cval_part_p_type_0#3817, cval_part_p_size#3801 AS cval_part_p_size_0#3818, cval_part_p_container#3802 AS cval_part_p_container_0#3819, cval_part_p_retailprice#3803 AS cval_part_p_retailprice_0#3820, cval_part_p_comment#3804 AS cval_part_p_comment_0#3821, cval_part_p_brand#3805 AS cval_part_p_brand_0#3822, cp_name#3806 AS cp_name_0#3823, cp_mfgr#3807 AS cp_mfgr_0#3824, cp_type#3808 AS cp_type_0#3825, cp_size#3809 AS cp_size_0#3826, cp_container#3810 AS cp_container_0#3827, cp_retailprice#3811 AS cp_retailprice_0#3828, cp_comment#3812 AS cp_comment_0#3829, cp_brand#3813 AS cp_brand_0#3830]
            :  :  :        +- Relation[rid#3797,cval_part_p_name#3798,cval_part_p_mfgr#3799,cval_part_p_type#3800,cval_part_p_size#3801,cval_part_p_container#3802,cval_part_p_retailprice#3803,cval_part_p_comment#3804,cval_part_p_brand#3805,cp_name#3806,cp_mfgr#3807,cp_type#3808,cp_size#3809,cp_container#3810,cp_retailprice#3811,cp_comment#3812,cp_brand#3813] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :     :- Project [rid#3853 AS rid_0#3870, cval_part_p_name#3854 AS cval_part_p_name_0#3871, cval_part_p_mfgr#3855 AS cval_part_p_mfgr_0#3872, cval_part_p_type#3856 AS cval_part_p_type_0#3873, cval_part_p_size#3857 AS cval_part_p_size_0#3874, cval_part_p_container#3858 AS cval_part_p_container_0#3875, cval_part_p_retailprice#3859 AS cval_part_p_retailprice_0#3876, cval_part_p_comment#3860 AS cval_part_p_comment_0#3877, cval_part_p_brand#3861 AS cval_part_p_brand_0#3878, cp_name#3862 AS cp_name_0#3879, cp_mfgr#3863 AS cp_mfgr_0#3880, cp_type#3864 AS cp_type_0#3881, cp_size#3865 AS cp_size_0#3882, cp_container#3866 AS cp_container_0#3883, cp_retailprice#3867 AS cp_retailprice_0#3884, cp_comment#3868 AS cp_comment_0#3885, cp_brand#3869 AS cp_brand_0#3886]
            :  :     :  +- Relation[rid#3853,cval_part_p_name#3854,cval_part_p_mfgr#3855,cval_part_p_type#3856,cval_part_p_size#3857,cval_part_p_container#3858,cval_part_p_retailprice#3859,cval_part_p_comment#3860,cval_part_p_brand#3861,cp_name#3862,cp_mfgr#3863,cp_type#3864,cp_size#3865,cp_container#3866,cp_retailprice#3867,cp_comment#3868,cp_brand#3869] JDBCRelation(tpart) [numPartitions=1]
            :  :     +- Project [rid#3887 AS rid_1#3898, cpfk_part_partsupp#3888 AS cpfk_part_partsupp_1#3899, cfpk_partsupp_part#3889 AS cfpk_partsupp_part_1#3900, cpfk_supplier_partsupp#3890 AS cpfk_supplier_partsupp_1#3901, cfpk_partsupp_supplier#3891 AS cfpk_partsupp_supplier_1#3902, cval_partsupp_ps_availqty#3892 AS cval_partsupp_ps_availqty_1#3903, cval_partsupp_ps_supplycost#3893 AS cval_partsupp_ps_supplycost_1#3904, cval_partsupp_ps_comment#3894 AS cval_partsupp_ps_comment_1#3905, cps_availqty#3895 AS cps_availqty_1#3906, cps_supplycost#3896 AS cps_supplycost_1#3907, cps_comment#3897 AS cps_comment_1#3908]
            :  :        +- Relation[rid#3887,cpfk_part_partsupp#3888,cfpk_partsupp_part#3889,cpfk_supplier_partsupp#3890,cfpk_partsupp_supplier#3891,cval_partsupp_ps_availqty#3892,cval_partsupp_ps_supplycost#3893,cval_partsupp_ps_comment#3894,cps_availqty#3895,cps_supplycost#3896,cps_comment#3897] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#3831 AS rid_1#3842, cpfk_part_partsupp#3832 AS cpfk_part_partsupp_1#3843, cfpk_partsupp_part#3833 AS cfpk_partsupp_part_1#3844, cpfk_supplier_partsupp#3834 AS cpfk_supplier_partsupp_1#3845, cfpk_partsupp_supplier#3835 AS cfpk_partsupp_supplier_1#3846, cval_partsupp_ps_availqty#3836 AS cval_partsupp_ps_availqty_1#3847, cval_partsupp_ps_supplycost#3837 AS cval_partsupp_ps_supplycost_1#3848, cval_partsupp_ps_comment#3838 AS cval_partsupp_ps_comment_1#3849, cps_availqty#3839 AS cps_availqty_1#3850, cps_supplycost#3840 AS cps_supplycost_1#3851, cps_comment#3841 AS cps_comment_1#3852]
            :     +- Relation[rid#3831,cpfk_part_partsupp#3832,cfpk_partsupp_part#3833,cpfk_supplier_partsupp#3834,cfpk_partsupp_supplier#3835,cval_partsupp_ps_availqty#3836,cval_partsupp_ps_supplycost#3837,cval_partsupp_ps_comment#3838,cps_availqty#3839,cps_supplycost#3840,cps_comment#3841] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#3909 AS rid_2#3916, cpfk_region_nation#3910 AS cpfk_region_nation_2#3917, cfpk_nation_region#3911 AS cfpk_nation_region_2#3918, cval_nation_n_name#3912 AS cval_nation_n_name_2#3919, cval_nation_n_comment#3913 AS cval_nation_n_comment_2#3920, cn_name#3914 AS cn_name_2#3921, cn_comment#3915 AS cn_comment_2#3922]
               :  :  :  +- Relation[rid#3909,cpfk_region_nation#3910,cfpk_nation_region#3911,cval_nation_n_name#3912,cval_nation_n_comment#3913,cn_name#3914,cn_comment#3915] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#3923 AS rid_2#3930, cpfk_region_nation#3924 AS cpfk_region_nation_2#3931, cfpk_nation_region#3925 AS cfpk_nation_region_2#3932, cval_nation_n_name#3926 AS cval_nation_n_name_2#3933, cval_nation_n_comment#3927 AS cval_nation_n_comment_2#3934, cn_name#3928 AS cn_name_2#3935, cn_comment#3929 AS cn_comment_2#3936]
               :  :        +- Relation[rid#3923,cpfk_region_nation#3924,cfpk_nation_region#3925,cval_nation_n_name#3926,cval_nation_n_comment#3927,cn_name#3928,cn_comment#3929] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :     :- Project [rid#3963 AS rid_2#3970, cpfk_region_nation#3964 AS cpfk_region_nation_2#3971, cfpk_nation_region#3965 AS cfpk_nation_region_2#3972, cval_nation_n_name#3966 AS cval_nation_n_name_2#3973, cval_nation_n_comment#3967 AS cval_nation_n_comment_2#3974, cn_name#3968 AS cn_name_2#3975, cn_comment#3969 AS cn_comment_2#3976]
               :     :  +- Relation[rid#3963,cpfk_region_nation#3964,cfpk_nation_region#3965,cval_nation_n_name#3966,cval_nation_n_comment#3967,cn_name#3968,cn_comment#3969] JDBCRelation(tnation) [numPartitions=1]
               :     +- Project [rid#3977 AS rid_3#3990, cpfk_nation_supplier#3978 AS cpfk_nation_supplier_3#3991, cfpk_supplier_nation#3979 AS cfpk_supplier_nation_3#3992, cval_supplier_s_name#3980 AS cval_supplier_s_name_3#3993, cval_supplier_s_address#3981 AS cval_supplier_s_address_3#3994, cval_supplier_s_phone#3982 AS cval_supplier_s_phone_3#3995, cval_supplier_s_acctbal#3983 AS cval_supplier_s_acctbal_3#3996, cval_supplier_s_comment#3984 AS cval_supplier_s_comment_3#3997, cs_name#3985 AS cs_name_3#3998, cs_address#3986 AS cs_address_3#3999, cs_phone#3987 AS cs_phone_3#4000, cs_acctbal#3988 AS cs_acctbal_3#4001, cs_comment#3989 AS cs_comment_3#4002]
               :        +- Relation[rid#3977,cpfk_nation_supplier#3978,cfpk_supplier_nation#3979,cval_supplier_s_name#3980,cval_supplier_s_address#3981,cval_supplier_s_phone#3982,cval_supplier_s_acctbal#3983,cval_supplier_s_comment#3984,cs_name#3985,cs_address#3986,cs_phone#3987,cs_acctbal#3988,cs_comment#3989] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#3937 AS rid_3#3950, cpfk_nation_supplier#3938 AS cpfk_nation_supplier_3#3951, cfpk_supplier_nation#3939 AS cfpk_supplier_nation_3#3952, cval_supplier_s_name#3940 AS cval_supplier_s_name_3#3953, cval_supplier_s_address#3941 AS cval_supplier_s_address_3#3954, cval_supplier_s_phone#3942 AS cval_supplier_s_phone_3#3955, cval_supplier_s_acctbal#3943 AS cval_supplier_s_acctbal_3#3956, cval_supplier_s_comment#3944 AS cval_supplier_s_comment_3#3957, cs_name#3945 AS cs_name_3#3958, cs_address#3946 AS cs_address_3#3959, cs_phone#3947 AS cs_phone_3#3960, cs_acctbal#3948 AS cs_acctbal_3#3961, cs_comment#3949 AS cs_comment_3#3962]
                  +- Relation[rid#3937,cpfk_nation_supplier#3938,cfpk_supplier_nation#3939,cval_supplier_s_name#3940,cval_supplier_s_address#3941,cval_supplier_s_phone#3942,cval_supplier_s_acctbal#3943,cval_supplier_s_comment#3944,cs_name#3945,cs_address#3946,cs_phone#3947,cs_acctbal#3948,cs_comment#3949] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 13648ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/15 02:32:47 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:32:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4057L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/15 02:32:47 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 02:32:47 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 02:32:47 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 02:32:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:32:47 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 02:32:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:32:47 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 02:32:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:32:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:32:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:32:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:32:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:32:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:32:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:32:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:32:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:32:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4057L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#4059 AS rid_0#4064, cval_region_r_name#4060 AS cval_region_r_name_0#4065, cval_region_r_comment#4061 AS cval_region_r_comment_0#4066, cr_name#4062 AS cr_name_0#4067, cr_comment#4063 AS cr_comment_0#4068]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#4059,cval_region_r_name#4060,cval_region_r_comment#4061,cr_name#4062,cr_comment#4063] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#4069 AS rid_0#4074, cval_region_r_name#4070 AS cval_region_r_name_0#4075, cval_region_r_comment#4071 AS cval_region_r_comment_0#4076, cr_name#4072 AS cr_name_0#4077, cr_comment#4073 AS cr_comment_0#4078]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#4069,cval_region_r_name#4070,cval_region_r_comment#4071,cr_name#4072,cr_comment#4073] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :     :- Project [rid#4093 AS rid_0#4098, cval_region_r_name#4094 AS cval_region_r_name_0#4099, cval_region_r_comment#4095 AS cval_region_r_comment_0#4100, cr_name#4096 AS cr_name_0#4101, cr_comment#4097 AS cr_comment_0#4102]
         :     :  :  :  :  :  :  :  :     :  +- Relation[rid#4093,cval_region_r_name#4094,cval_region_r_comment#4095,cr_name#4096,cr_comment#4097] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :     +- Project [rid#4103 AS rid_1#4110, cpfk_region_nation#4104 AS cpfk_region_nation_1#4111, cfpk_nation_region#4105 AS cfpk_nation_region_1#4112, cval_nation_n_name#4106 AS cval_nation_n_name_1#4113, cval_nation_n_comment#4107 AS cval_nation_n_comment_1#4114, cn_name#4108 AS cn_name_1#4115, cn_comment#4109 AS cn_comment_1#4116]
         :     :  :  :  :  :  :  :  :        +- Relation[rid#4103,cpfk_region_nation#4104,cfpk_nation_region#4105,cval_nation_n_name#4106,cval_nation_n_comment#4107,cn_name#4108,cn_comment#4109] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#4079 AS rid_1#4086, cpfk_region_nation#4080 AS cpfk_region_nation_1#4087, cfpk_nation_region#4081 AS cfpk_nation_region_1#4088, cval_nation_n_name#4082 AS cval_nation_n_name_1#4089, cval_nation_n_comment#4083 AS cval_nation_n_comment_1#4090, cn_name#4084 AS cn_name_1#4091, cn_comment#4085 AS cn_comment_1#4092]
         :     :  :  :  :  :  :  :     +- Relation[rid#4079,cpfk_region_nation#4080,cfpk_nation_region#4081,cval_nation_n_name#4082,cval_nation_n_comment#4083,cn_name#4084,cn_comment#4085] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :     :- Project [rid#4147 AS rid_1#4154, cpfk_region_nation#4148 AS cpfk_region_nation_1#4155, cfpk_nation_region#4149 AS cfpk_nation_region_1#4156, cval_nation_n_name#4150 AS cval_nation_n_name_1#4157, cval_nation_n_comment#4151 AS cval_nation_n_comment_1#4158, cn_name#4152 AS cn_name_1#4159, cn_comment#4153 AS cn_comment_1#4160]
         :     :  :  :  :  :  :     :  +- Relation[rid#4147,cpfk_region_nation#4148,cfpk_nation_region#4149,cval_nation_n_name#4150,cval_nation_n_comment#4151,cn_name#4152,cn_comment#4153] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :     +- Project [rid#4161 AS rid_2#4176, cpfk_nation_customer#4162 AS cpfk_nation_customer_2#4177, cfpk_customer_nation#4163 AS cfpk_customer_nation_2#4178, cval_customer_c_name#4164 AS cval_customer_c_name_2#4179, cval_customer_c_address#4165 AS cval_customer_c_address_2#4180, cval_customer_c_phone#4166 AS cval_customer_c_phone_2#4181, cval_customer_c_acctbal#4167 AS cval_customer_c_acctbal_2#4182, cval_customer_c_comment#4168 AS cval_customer_c_comment_2#4183, cval_customer_c_mktsegment#4169 AS cval_customer_c_mktsegment_2#4184, cc_name#4170 AS cc_name_2#4185, cc_address#4171 AS cc_address_2#4186, cc_phone#4172 AS cc_phone_2#4187, cc_acctbal#4173 AS cc_acctbal_2#4188, cc_comment#4174 AS cc_comment_2#4189, cc_mktsegment#4175 AS cc_mktsegment_2#4190]
         :     :  :  :  :  :  :        +- Relation[rid#4161,cpfk_nation_customer#4162,cfpk_customer_nation#4163,cval_customer_c_name#4164,cval_customer_c_address#4165,cval_customer_c_phone#4166,cval_customer_c_acctbal#4167,cval_customer_c_comment#4168,cval_customer_c_mktsegment#4169,cc_name#4170,cc_address#4171,cc_phone#4172,cc_acctbal#4173,cc_comment#4174,cc_mktsegment#4175] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#4117 AS rid_2#4132, cpfk_nation_customer#4118 AS cpfk_nation_customer_2#4133, cfpk_customer_nation#4119 AS cfpk_customer_nation_2#4134, cval_customer_c_name#4120 AS cval_customer_c_name_2#4135, cval_customer_c_address#4121 AS cval_customer_c_address_2#4136, cval_customer_c_phone#4122 AS cval_customer_c_phone_2#4137, cval_customer_c_acctbal#4123 AS cval_customer_c_acctbal_2#4138, cval_customer_c_comment#4124 AS cval_customer_c_comment_2#4139, cval_customer_c_mktsegment#4125 AS cval_customer_c_mktsegment_2#4140, cc_name#4126 AS cc_name_2#4141, cc_address#4127 AS cc_address_2#4142, cc_phone#4128 AS cc_phone_2#4143, cc_acctbal#4129 AS cc_acctbal_2#4144, cc_comment#4130 AS cc_comment_2#4145, cc_mktsegment#4131 AS cc_mktsegment_2#4146]
         :     :  :  :  :  :     +- Relation[rid#4117,cpfk_nation_customer#4118,cfpk_customer_nation#4119,cval_customer_c_name#4120,cval_customer_c_address#4121,cval_customer_c_phone#4122,cval_customer_c_acctbal#4123,cval_customer_c_comment#4124,cval_customer_c_mktsegment#4125,cc_name#4126,cc_address#4127,cc_phone#4128,cc_acctbal#4129,cc_comment#4130,cc_mktsegment#4131] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :     :- Project [rid#4225 AS rid_2#4240, cpfk_nation_customer#4226 AS cpfk_nation_customer_2#4241, cfpk_customer_nation#4227 AS cfpk_customer_nation_2#4242, cval_customer_c_name#4228 AS cval_customer_c_name_2#4243, cval_customer_c_address#4229 AS cval_customer_c_address_2#4244, cval_customer_c_phone#4230 AS cval_customer_c_phone_2#4245, cval_customer_c_acctbal#4231 AS cval_customer_c_acctbal_2#4246, cval_customer_c_comment#4232 AS cval_customer_c_comment_2#4247, cval_customer_c_mktsegment#4233 AS cval_customer_c_mktsegment_2#4248, cc_name#4234 AS cc_name_2#4249, cc_address#4235 AS cc_address_2#4250, cc_phone#4236 AS cc_phone_2#4251, cc_acctbal#4237 AS cc_acctbal_2#4252, cc_comment#4238 AS cc_comment_2#4253, cc_mktsegment#4239 AS cc_mktsegment_2#4254]
         :     :  :  :  :     :  +- Relation[rid#4225,cpfk_nation_customer#4226,cfpk_customer_nation#4227,cval_customer_c_name#4228,cval_customer_c_address#4229,cval_customer_c_phone#4230,cval_customer_c_acctbal#4231,cval_customer_c_comment#4232,cval_customer_c_mktsegment#4233,cc_name#4234,cc_address#4235,cc_phone#4236,cc_acctbal#4237,cc_comment#4238,cc_mktsegment#4239] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :     +- Project [rid#4255 AS rid_3#4272, cpfk_customer_orders#4256 AS cpfk_customer_orders_3#4273, cfpk_orders_customer#4257 AS cfpk_orders_customer_3#4274, cval_orders_o_orderstatus#4258 AS cval_orders_o_orderstatus_3#4275, cval_orders_o_totalprice#4259 AS cval_orders_o_totalprice_3#4276, cval_orders_o_orderpriority#4260 AS cval_orders_o_orderpriority_3#4277, cval_orders_o_clerk#4261 AS cval_orders_o_clerk_3#4278, cval_orders_o_shippriority#4262 AS cval_orders_o_shippriority_3#4279, cval_orders_o_comment#4263 AS cval_orders_o_comment_3#4280, cval_orders_o_orderdate#4264 AS cval_orders_o_orderdate_3#4281, co_orderstatus#4265 AS co_orderstatus_3#4282, co_totalprice#4266 AS co_totalprice_3#4283, co_orderpriority#4267 AS co_orderpriority_3#4284, co_clerk#4268 AS co_clerk_3#4285, co_shippriority#4269 AS co_shippriority_3#4286, co_comment#4270 AS co_comment_3#4287, co_orderdate#4271 AS co_orderdate_3#4288]
         :     :  :  :  :        +- Relation[rid#4255,cpfk_customer_orders#4256,cfpk_orders_customer#4257,cval_orders_o_orderstatus#4258,cval_orders_o_totalprice#4259,cval_orders_o_orderpriority#4260,cval_orders_o_clerk#4261,cval_orders_o_shippriority#4262,cval_orders_o_comment#4263,cval_orders_o_orderdate#4264,co_orderstatus#4265,co_totalprice#4266,co_orderpriority#4267,co_clerk#4268,co_shippriority#4269,co_comment#4270,co_orderdate#4271] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#4191 AS rid_3#4208, cpfk_customer_orders#4192 AS cpfk_customer_orders_3#4209, cfpk_orders_customer#4193 AS cfpk_orders_customer_3#4210, cval_orders_o_orderstatus#4194 AS cval_orders_o_orderstatus_3#4211, cval_orders_o_totalprice#4195 AS cval_orders_o_totalprice_3#4212, cval_orders_o_orderpriority#4196 AS cval_orders_o_orderpriority_3#4213, cval_orders_o_clerk#4197 AS cval_orders_o_clerk_3#4214, cval_orders_o_shippriority#4198 AS cval_orders_o_shippriority_3#4215, cval_orders_o_comment#4199 AS cval_orders_o_comment_3#4216, cval_orders_o_orderdate#4200 AS cval_orders_o_orderdate_3#4217, co_orderstatus#4201 AS co_orderstatus_3#4218, co_totalprice#4202 AS co_totalprice_3#4219, co_orderpriority#4203 AS co_orderpriority_3#4220, co_clerk#4204 AS co_clerk_3#4221, co_shippriority#4205 AS co_shippriority_3#4222, co_comment#4206 AS co_comment_3#4223, co_orderdate#4207 AS co_orderdate_3#4224]
         :     :  :  :     +- Relation[rid#4191,cpfk_customer_orders#4192,cfpk_orders_customer#4193,cval_orders_o_orderstatus#4194,cval_orders_o_totalprice#4195,cval_orders_o_orderpriority#4196,cval_orders_o_clerk#4197,cval_orders_o_shippriority#4198,cval_orders_o_comment#4199,cval_orders_o_orderdate#4200,co_orderstatus#4201,co_totalprice#4202,co_orderpriority#4203,co_clerk#4204,co_shippriority#4205,co_comment#4206,co_orderdate#4207] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :     :- Project [rid#4355 AS rid_3#4372, cpfk_customer_orders#4356 AS cpfk_customer_orders_3#4373, cfpk_orders_customer#4357 AS cfpk_orders_customer_3#4374, cval_orders_o_orderstatus#4358 AS cval_orders_o_orderstatus_3#4375, cval_orders_o_totalprice#4359 AS cval_orders_o_totalprice_3#4376, cval_orders_o_orderpriority#4360 AS cval_orders_o_orderpriority_3#4377, cval_orders_o_clerk#4361 AS cval_orders_o_clerk_3#4378, cval_orders_o_shippriority#4362 AS cval_orders_o_shippriority_3#4379, cval_orders_o_comment#4363 AS cval_orders_o_comment_3#4380, cval_orders_o_orderdate#4364 AS cval_orders_o_orderdate_3#4381, co_orderstatus#4365 AS co_orderstatus_3#4382, co_totalprice#4366 AS co_totalprice_3#4383, co_orderpriority#4367 AS co_orderpriority_3#4384, co_clerk#4368 AS co_clerk_3#4385, co_shippriority#4369 AS co_shippriority_3#4386, co_comment#4370 AS co_comment_3#4387, co_orderdate#4371 AS co_orderdate_3#4388]
         :     :  :     :  +- Relation[rid#4355,cpfk_customer_orders#4356,cfpk_orders_customer#4357,cval_orders_o_orderstatus#4358,cval_orders_o_totalprice#4359,cval_orders_o_orderpriority#4360,cval_orders_o_clerk#4361,cval_orders_o_shippriority#4362,cval_orders_o_comment#4363,cval_orders_o_orderdate#4364,co_orderstatus#4365,co_totalprice#4366,co_orderpriority#4367,co_clerk#4368,co_shippriority#4369,co_comment#4370,co_orderdate#4371] JDBCRelation(torders) [numPartitions=1]
         :     :  :     +- Project [rid#4389 AS rid_4#4422, cpfk_orders_lineitem#4390 AS cpfk_orders_lineitem_4#4423, cpfk_supplier_lineitem#4391 AS cpfk_supplier_lineitem_4#4424, cfpk_lineitem_supplier#4392 AS cfpk_lineitem_supplier_4#4425, cfpk_lineitem_partsupp#4393 AS cfpk_lineitem_partsupp_4#4426, cpfk_part_lineitem#4394 AS cpfk_part_lineitem_4#4427, cfpk_lineitem_part#4395 AS cfpk_lineitem_part_4#4428, cpfk_partsupp_lineitem#4396 AS cpfk_partsupp_lineitem_4#4429, cfpk_lineitem_orders#4397 AS cfpk_lineitem_orders_4#4430, cval_lineitem_l_quantity#4398 AS cval_lineitem_l_quantity_4#4431, cval_lineitem_l_extendedprice#4399 AS cval_lineitem_l_extendedprice_4#4432, cval_lineitem_l_discount#4400 AS cval_lineitem_l_discount_4#4433, cval_lineitem_l_tax#4401 AS cval_lineitem_l_tax_4#4434, cval_lineitem_l_returnflag#4402 AS cval_lineitem_l_returnflag_4#4435, cval_lineitem_l_linestatus#4403 AS cval_lineitem_l_linestatus_4#4436, cval_lineitem_l_commitdate#4404 AS cval_lineitem_l_commitdate_4#4437, cval_lineitem_l_receiptdate#4405 AS cval_lineitem_l_receiptdate_4#4438, cval_lineitem_l_shipinstruct#4406 AS cval_lineitem_l_shipinstruct_4#4439, cval_lineitem_l_shipmode#4407 AS cval_lineitem_l_shipmode_4#4440, cval_lineitem_l_comment#4408 AS cval_lineitem_l_comment_4#4441, cval_lineitem_l_shipdate#4409 AS cval_lineitem_l_shipdate_4#4442, cl_quantity#4410 AS cl_quantity_4#4443, cl_extendedprice#4411 AS cl_extendedprice_4#4444, cl_discount#4412 AS cl_discount_4#4445, ... 9 more fields]
         :     :  :        +- Relation[rid#4389,cpfk_orders_lineitem#4390,cpfk_supplier_lineitem#4391,cfpk_lineitem_supplier#4392,cfpk_lineitem_partsupp#4393,cpfk_part_lineitem#4394,cfpk_lineitem_part#4395,cpfk_partsupp_lineitem#4396,cfpk_lineitem_orders#4397,cval_lineitem_l_quantity#4398,cval_lineitem_l_extendedprice#4399,cval_lineitem_l_discount#4400,cval_lineitem_l_tax#4401,cval_lineitem_l_returnflag#4402,cval_lineitem_l_linestatus#4403,cval_lineitem_l_commitdate#4404,cval_lineitem_l_receiptdate#4405,cval_lineitem_l_shipinstruct#4406,cval_lineitem_l_shipmode#4407,cval_lineitem_l_comment#4408,cval_lineitem_l_shipdate#4409,cl_quantity#4410,cl_extendedprice#4411,cl_discount#4412,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#4289 AS rid_4#4322, cpfk_orders_lineitem#4290 AS cpfk_orders_lineitem_4#4323, cpfk_supplier_lineitem#4291 AS cpfk_supplier_lineitem_4#4324, cfpk_lineitem_supplier#4292 AS cfpk_lineitem_supplier_4#4325, cfpk_lineitem_partsupp#4293 AS cfpk_lineitem_partsupp_4#4326, cpfk_part_lineitem#4294 AS cpfk_part_lineitem_4#4327, cfpk_lineitem_part#4295 AS cfpk_lineitem_part_4#4328, cpfk_partsupp_lineitem#4296 AS cpfk_partsupp_lineitem_4#4329, cfpk_lineitem_orders#4297 AS cfpk_lineitem_orders_4#4330, cval_lineitem_l_quantity#4298 AS cval_lineitem_l_quantity_4#4331, cval_lineitem_l_extendedprice#4299 AS cval_lineitem_l_extendedprice_4#4332, cval_lineitem_l_discount#4300 AS cval_lineitem_l_discount_4#4333, cval_lineitem_l_tax#4301 AS cval_lineitem_l_tax_4#4334, cval_lineitem_l_returnflag#4302 AS cval_lineitem_l_returnflag_4#4335, cval_lineitem_l_linestatus#4303 AS cval_lineitem_l_linestatus_4#4336, cval_lineitem_l_commitdate#4304 AS cval_lineitem_l_commitdate_4#4337, cval_lineitem_l_receiptdate#4305 AS cval_lineitem_l_receiptdate_4#4338, cval_lineitem_l_shipinstruct#4306 AS cval_lineitem_l_shipinstruct_4#4339, cval_lineitem_l_shipmode#4307 AS cval_lineitem_l_shipmode_4#4340, cval_lineitem_l_comment#4308 AS cval_lineitem_l_comment_4#4341, cval_lineitem_l_shipdate#4309 AS cval_lineitem_l_shipdate_4#4342, cl_quantity#4310 AS cl_quantity_4#4343, cl_extendedprice#4311 AS cl_extendedprice_4#4344, cl_discount#4312 AS cl_discount_4#4345, ... 9 more fields]
         :     :     +- Relation[rid#4289,cpfk_orders_lineitem#4290,cpfk_supplier_lineitem#4291,cfpk_lineitem_supplier#4292,cfpk_lineitem_partsupp#4293,cpfk_part_lineitem#4294,cfpk_lineitem_part#4295,cpfk_partsupp_lineitem#4296,cfpk_lineitem_orders#4297,cval_lineitem_l_quantity#4298,cval_lineitem_l_extendedprice#4299,cval_lineitem_l_discount#4300,cval_lineitem_l_tax#4301,cval_lineitem_l_returnflag#4302,cval_lineitem_l_linestatus#4303,cval_lineitem_l_commitdate#4304,cval_lineitem_l_receiptdate#4305,cval_lineitem_l_shipinstruct#4306,cval_lineitem_l_shipmode#4307,cval_lineitem_l_comment#4308,cval_lineitem_l_shipdate#4309,cl_quantity#4310,cl_extendedprice#4311,cl_discount#4312,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#4455 AS rid_5#4468, cpfk_nation_supplier#4456 AS cpfk_nation_supplier_5#4469, cfpk_supplier_nation#4457 AS cfpk_supplier_nation_5#4470, cval_supplier_s_name#4458 AS cval_supplier_s_name_5#4471, cval_supplier_s_address#4459 AS cval_supplier_s_address_5#4472, cval_supplier_s_phone#4460 AS cval_supplier_s_phone_5#4473, cval_supplier_s_acctbal#4461 AS cval_supplier_s_acctbal_5#4474, cval_supplier_s_comment#4462 AS cval_supplier_s_comment_5#4475, cs_name#4463 AS cs_name_5#4476, cs_address#4464 AS cs_address_5#4477, cs_phone#4465 AS cs_phone_5#4478, cs_acctbal#4466 AS cs_acctbal_5#4479, cs_comment#4467 AS cs_comment_5#4480]
         :        +- Relation[rid#4455,cpfk_nation_supplier#4456,cfpk_supplier_nation#4457,cval_supplier_s_name#4458,cval_supplier_s_address#4459,cval_supplier_s_phone#4460,cval_supplier_s_acctbal#4461,cval_supplier_s_comment#4462,cs_name#4463,cs_address#4464,cs_phone#4465,cs_acctbal#4466,cs_comment#4467] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyDependentJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#4481 AS rid_1#4488, cpfk_region_nation#4482 AS cpfk_region_nation_1#4489, cfpk_nation_region#4483 AS cfpk_nation_region_1#4490, cval_nation_n_name#4484 AS cval_nation_n_name_1#4491, cval_nation_n_comment#4485 AS cval_nation_n_comment_1#4492, cn_name#4486 AS cn_name_1#4493, cn_comment#4487 AS cn_comment_1#4494]
            :  +- Relation[rid#4481,cpfk_region_nation#4482,cfpk_nation_region#4483,cval_nation_n_name#4484,cval_nation_n_comment#4485,cn_name#4486,cn_comment#4487] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#4495 AS rid_5#4508, cpfk_nation_supplier#4496 AS cpfk_nation_supplier_5#4509, cfpk_supplier_nation#4497 AS cfpk_supplier_nation_5#4510, cval_supplier_s_name#4498 AS cval_supplier_s_name_5#4511, cval_supplier_s_address#4499 AS cval_supplier_s_address_5#4512, cval_supplier_s_phone#4500 AS cval_supplier_s_phone_5#4513, cval_supplier_s_acctbal#4501 AS cval_supplier_s_acctbal_5#4514, cval_supplier_s_comment#4502 AS cval_supplier_s_comment_5#4515, cs_name#4503 AS cs_name_5#4516, cs_address#4504 AS cs_address_5#4517, cs_phone#4505 AS cs_phone_5#4518, cs_acctbal#4506 AS cs_acctbal_5#4519, cs_comment#4507 AS cs_comment_5#4520]
               +- Relation[rid#4495,cpfk_nation_supplier#4496,cfpk_supplier_nation#4497,cval_supplier_s_name#4498,cval_supplier_s_address#4499,cval_supplier_s_phone#4500,cval_supplier_s_acctbal#4501,cval_supplier_s_comment#4502,cs_name#4503,cs_address#4504,cs_phone#4505,cs_acctbal#4506,cs_comment#4507] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1206514
Elapsed time: 170295ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/15 02:35:37 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:35:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4616L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 02:35:37 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 02:35:37 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 02:35:37 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 02:35:37 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 02:35:37 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 02:35:37 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 02:35:37 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 02:35:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4616L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#4618 AS rid_0#4635, cval_part_p_name#4619 AS cval_part_p_name_0#4636, cval_part_p_mfgr#4620 AS cval_part_p_mfgr_0#4637, cval_part_p_type#4621 AS cval_part_p_type_0#4638, cval_part_p_size#4622 AS cval_part_p_size_0#4639, cval_part_p_container#4623 AS cval_part_p_container_0#4640, cval_part_p_retailprice#4624 AS cval_part_p_retailprice_0#4641, cval_part_p_comment#4625 AS cval_part_p_comment_0#4642, cval_part_p_brand#4626 AS cval_part_p_brand_0#4643, cp_name#4627 AS cp_name_0#4644, cp_mfgr#4628 AS cp_mfgr_0#4645, cp_type#4629 AS cp_type_0#4646, cp_size#4630 AS cp_size_0#4647, cp_container#4631 AS cp_container_0#4648, cp_retailprice#4632 AS cp_retailprice_0#4649, cp_comment#4633 AS cp_comment_0#4650, cp_brand#4634 AS cp_brand_0#4651]
         :  :  :  :  +- Relation[rid#4618,cval_part_p_name#4619,cval_part_p_mfgr#4620,cval_part_p_type#4621,cval_part_p_size#4622,cval_part_p_container#4623,cval_part_p_retailprice#4624,cval_part_p_comment#4625,cval_part_p_brand#4626,cp_name#4627,cp_mfgr#4628,cp_type#4629,cp_size#4630,cp_container#4631,cp_retailprice#4632,cp_comment#4633,cp_brand#4634] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#4652 AS rid_0#4669, cval_part_p_name#4653 AS cval_part_p_name_0#4670, cval_part_p_mfgr#4654 AS cval_part_p_mfgr_0#4671, cval_part_p_type#4655 AS cval_part_p_type_0#4672, cval_part_p_size#4656 AS cval_part_p_size_0#4673, cval_part_p_container#4657 AS cval_part_p_container_0#4674, cval_part_p_retailprice#4658 AS cval_part_p_retailprice_0#4675, cval_part_p_comment#4659 AS cval_part_p_comment_0#4676, cval_part_p_brand#4660 AS cval_part_p_brand_0#4677, cp_name#4661 AS cp_name_0#4678, cp_mfgr#4662 AS cp_mfgr_0#4679, cp_type#4663 AS cp_type_0#4680, cp_size#4664 AS cp_size_0#4681, cp_container#4665 AS cp_container_0#4682, cp_retailprice#4666 AS cp_retailprice_0#4683, cp_comment#4667 AS cp_comment_0#4684, cp_brand#4668 AS cp_brand_0#4685]
         :  :  :        +- Relation[rid#4652,cval_part_p_name#4653,cval_part_p_mfgr#4654,cval_part_p_type#4655,cval_part_p_size#4656,cval_part_p_container#4657,cval_part_p_retailprice#4658,cval_part_p_comment#4659,cval_part_p_brand#4660,cp_name#4661,cp_mfgr#4662,cp_type#4663,cp_size#4664,cp_container#4665,cp_retailprice#4666,cp_comment#4667,cp_brand#4668] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#4686 AS rid_0#4703, cval_part_p_name#4687 AS cval_part_p_name_0#4704, cval_part_p_mfgr#4688 AS cval_part_p_mfgr_0#4705, cval_part_p_type#4689 AS cval_part_p_type_0#4706, cval_part_p_size#4690 AS cval_part_p_size_0#4707, cval_part_p_container#4691 AS cval_part_p_container_0#4708, cval_part_p_retailprice#4692 AS cval_part_p_retailprice_0#4709, cval_part_p_comment#4693 AS cval_part_p_comment_0#4710, cval_part_p_brand#4694 AS cval_part_p_brand_0#4711, cp_name#4695 AS cp_name_0#4712, cp_mfgr#4696 AS cp_mfgr_0#4713, cp_type#4697 AS cp_type_0#4714, cp_size#4698 AS cp_size_0#4715, cp_container#4699 AS cp_container_0#4716, cp_retailprice#4700 AS cp_retailprice_0#4717, cp_comment#4701 AS cp_comment_0#4718, cp_brand#4702 AS cp_brand_0#4719]
         :  :        +- Relation[rid#4686,cval_part_p_name#4687,cval_part_p_mfgr#4688,cval_part_p_type#4689,cval_part_p_size#4690,cval_part_p_container#4691,cval_part_p_retailprice#4692,cval_part_p_comment#4693,cval_part_p_brand#4694,cp_name#4695,cp_mfgr#4696,cp_type#4697,cp_size#4698,cp_container#4699,cp_retailprice#4700,cp_comment#4701,cp_brand#4702] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#4918 AS rid_0#4935, cval_part_p_name#4919 AS cval_part_p_name_0#4936, cval_part_p_mfgr#4920 AS cval_part_p_mfgr_0#4937, cval_part_p_type#4921 AS cval_part_p_type_0#4938, cval_part_p_size#4922 AS cval_part_p_size_0#4939, cval_part_p_container#4923 AS cval_part_p_container_0#4940, cval_part_p_retailprice#4924 AS cval_part_p_retailprice_0#4941, cval_part_p_comment#4925 AS cval_part_p_comment_0#4942, cval_part_p_brand#4926 AS cval_part_p_brand_0#4943, cp_name#4927 AS cp_name_0#4944, cp_mfgr#4928 AS cp_mfgr_0#4945, cp_type#4929 AS cp_type_0#4946, cp_size#4930 AS cp_size_0#4947, cp_container#4931 AS cp_container_0#4948, cp_retailprice#4932 AS cp_retailprice_0#4949, cp_comment#4933 AS cp_comment_0#4950, cp_brand#4934 AS cp_brand_0#4951]
         :     :  +- Relation[rid#4918,cval_part_p_name#4919,cval_part_p_mfgr#4920,cval_part_p_type#4921,cval_part_p_size#4922,cval_part_p_container#4923,cval_part_p_retailprice#4924,cval_part_p_comment#4925,cval_part_p_brand#4926,cp_name#4927,cp_mfgr#4928,cp_type#4929,cp_size#4930,cp_container#4931,cp_retailprice#4932,cp_comment#4933,cp_brand#4934] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#4952 AS rid_1#4985, cpfk_orders_lineitem#4953 AS cpfk_orders_lineitem_1#4986, cpfk_supplier_lineitem#4954 AS cpfk_supplier_lineitem_1#4987, cfpk_lineitem_supplier#4955 AS cfpk_lineitem_supplier_1#4988, cfpk_lineitem_partsupp#4956 AS cfpk_lineitem_partsupp_1#4989, cpfk_part_lineitem#4957 AS cpfk_part_lineitem_1#4990, cfpk_lineitem_part#4958 AS cfpk_lineitem_part_1#4991, cpfk_partsupp_lineitem#4959 AS cpfk_partsupp_lineitem_1#4992, cfpk_lineitem_orders#4960 AS cfpk_lineitem_orders_1#4993, cval_lineitem_l_quantity#4961 AS cval_lineitem_l_quantity_1#4994, cval_lineitem_l_extendedprice#4962 AS cval_lineitem_l_extendedprice_1#4995, cval_lineitem_l_discount#4963 AS cval_lineitem_l_discount_1#4996, cval_lineitem_l_tax#4964 AS cval_lineitem_l_tax_1#4997, cval_lineitem_l_returnflag#4965 AS cval_lineitem_l_returnflag_1#4998, cval_lineitem_l_linestatus#4966 AS cval_lineitem_l_linestatus_1#4999, cval_lineitem_l_commitdate#4967 AS cval_lineitem_l_commitdate_1#5000, cval_lineitem_l_receiptdate#4968 AS cval_lineitem_l_receiptdate_1#5001, cval_lineitem_l_shipinstruct#4969 AS cval_lineitem_l_shipinstruct_1#5002, cval_lineitem_l_shipmode#4970 AS cval_lineitem_l_shipmode_1#5003, cval_lineitem_l_comment#4971 AS cval_lineitem_l_comment_1#5004, cval_lineitem_l_shipdate#4972 AS cval_lineitem_l_shipdate_1#5005, cl_quantity#4973 AS cl_quantity_1#5006, cl_extendedprice#4974 AS cl_extendedprice_1#5007, cl_discount#4975 AS cl_discount_1#5008, ... 9 more fields]
         :        +- Relation[rid#4952,cpfk_orders_lineitem#4953,cpfk_supplier_lineitem#4954,cfpk_lineitem_supplier#4955,cfpk_lineitem_partsupp#4956,cpfk_part_lineitem#4957,cfpk_lineitem_part#4958,cpfk_partsupp_lineitem#4959,cfpk_lineitem_orders#4960,cval_lineitem_l_quantity#4961,cval_lineitem_l_extendedprice#4962,cval_lineitem_l_discount#4963,cval_lineitem_l_tax#4964,cval_lineitem_l_returnflag#4965,cval_lineitem_l_linestatus#4966,cval_lineitem_l_commitdate#4967,cval_lineitem_l_receiptdate#4968,cval_lineitem_l_shipinstruct#4969,cval_lineitem_l_shipmode#4970,cval_lineitem_l_comment#4971,cval_lineitem_l_shipdate#4972,cl_quantity#4973,cl_extendedprice#4974,cl_discount#4975,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#4720 AS rid_1#4753, cpfk_orders_lineitem#4721 AS cpfk_orders_lineitem_1#4754, cpfk_supplier_lineitem#4722 AS cpfk_supplier_lineitem_1#4755, cfpk_lineitem_supplier#4723 AS cfpk_lineitem_supplier_1#4756, cfpk_lineitem_partsupp#4724 AS cfpk_lineitem_partsupp_1#4757, cpfk_part_lineitem#4725 AS cpfk_part_lineitem_1#4758, cfpk_lineitem_part#4726 AS cfpk_lineitem_part_1#4759, cpfk_partsupp_lineitem#4727 AS cpfk_partsupp_lineitem_1#4760, cfpk_lineitem_orders#4728 AS cfpk_lineitem_orders_1#4761, cval_lineitem_l_quantity#4729 AS cval_lineitem_l_quantity_1#4762, cval_lineitem_l_extendedprice#4730 AS cval_lineitem_l_extendedprice_1#4763, cval_lineitem_l_discount#4731 AS cval_lineitem_l_discount_1#4764, cval_lineitem_l_tax#4732 AS cval_lineitem_l_tax_1#4765, cval_lineitem_l_returnflag#4733 AS cval_lineitem_l_returnflag_1#4766, cval_lineitem_l_linestatus#4734 AS cval_lineitem_l_linestatus_1#4767, cval_lineitem_l_commitdate#4735 AS cval_lineitem_l_commitdate_1#4768, cval_lineitem_l_receiptdate#4736 AS cval_lineitem_l_receiptdate_1#4769, cval_lineitem_l_shipinstruct#4737 AS cval_lineitem_l_shipinstruct_1#4770, cval_lineitem_l_shipmode#4738 AS cval_lineitem_l_shipmode_1#4771, cval_lineitem_l_comment#4739 AS cval_lineitem_l_comment_1#4772, cval_lineitem_l_shipdate#4740 AS cval_lineitem_l_shipdate_1#4773, cl_quantity#4741 AS cl_quantity_1#4774, cl_extendedprice#4742 AS cl_extendedprice_1#4775, cl_discount#4743 AS cl_discount_1#4776, ... 9 more fields]
            :  :  +- Relation[rid#4720,cpfk_orders_lineitem#4721,cpfk_supplier_lineitem#4722,cfpk_lineitem_supplier#4723,cfpk_lineitem_partsupp#4724,cpfk_part_lineitem#4725,cfpk_lineitem_part#4726,cpfk_partsupp_lineitem#4727,cfpk_lineitem_orders#4728,cval_lineitem_l_quantity#4729,cval_lineitem_l_extendedprice#4730,cval_lineitem_l_discount#4731,cval_lineitem_l_tax#4732,cval_lineitem_l_returnflag#4733,cval_lineitem_l_linestatus#4734,cval_lineitem_l_commitdate#4735,cval_lineitem_l_receiptdate#4736,cval_lineitem_l_shipinstruct#4737,cval_lineitem_l_shipmode#4738,cval_lineitem_l_comment#4739,cval_lineitem_l_shipdate#4740,cl_quantity#4741,cl_extendedprice#4742,cl_discount#4743,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#4786 AS rid_1#4819, cpfk_orders_lineitem#4787 AS cpfk_orders_lineitem_1#4820, cpfk_supplier_lineitem#4788 AS cpfk_supplier_lineitem_1#4821, cfpk_lineitem_supplier#4789 AS cfpk_lineitem_supplier_1#4822, cfpk_lineitem_partsupp#4790 AS cfpk_lineitem_partsupp_1#4823, cpfk_part_lineitem#4791 AS cpfk_part_lineitem_1#4824, cfpk_lineitem_part#4792 AS cfpk_lineitem_part_1#4825, cpfk_partsupp_lineitem#4793 AS cpfk_partsupp_lineitem_1#4826, cfpk_lineitem_orders#4794 AS cfpk_lineitem_orders_1#4827, cval_lineitem_l_quantity#4795 AS cval_lineitem_l_quantity_1#4828, cval_lineitem_l_extendedprice#4796 AS cval_lineitem_l_extendedprice_1#4829, cval_lineitem_l_discount#4797 AS cval_lineitem_l_discount_1#4830, cval_lineitem_l_tax#4798 AS cval_lineitem_l_tax_1#4831, cval_lineitem_l_returnflag#4799 AS cval_lineitem_l_returnflag_1#4832, cval_lineitem_l_linestatus#4800 AS cval_lineitem_l_linestatus_1#4833, cval_lineitem_l_commitdate#4801 AS cval_lineitem_l_commitdate_1#4834, cval_lineitem_l_receiptdate#4802 AS cval_lineitem_l_receiptdate_1#4835, cval_lineitem_l_shipinstruct#4803 AS cval_lineitem_l_shipinstruct_1#4836, cval_lineitem_l_shipmode#4804 AS cval_lineitem_l_shipmode_1#4837, cval_lineitem_l_comment#4805 AS cval_lineitem_l_comment_1#4838, cval_lineitem_l_shipdate#4806 AS cval_lineitem_l_shipdate_1#4839, cl_quantity#4807 AS cl_quantity_1#4840, cl_extendedprice#4808 AS cl_extendedprice_1#4841, cl_discount#4809 AS cl_discount_1#4842, ... 9 more fields]
            :        +- Relation[rid#4786,cpfk_orders_lineitem#4787,cpfk_supplier_lineitem#4788,cfpk_lineitem_supplier#4789,cfpk_lineitem_partsupp#4790,cpfk_part_lineitem#4791,cfpk_lineitem_part#4792,cpfk_partsupp_lineitem#4793,cfpk_lineitem_orders#4794,cval_lineitem_l_quantity#4795,cval_lineitem_l_extendedprice#4796,cval_lineitem_l_discount#4797,cval_lineitem_l_tax#4798,cval_lineitem_l_returnflag#4799,cval_lineitem_l_linestatus#4800,cval_lineitem_l_commitdate#4801,cval_lineitem_l_receiptdate#4802,cval_lineitem_l_shipinstruct#4803,cval_lineitem_l_shipmode#4804,cval_lineitem_l_comment#4805,cval_lineitem_l_shipdate#4806,cl_quantity#4807,cl_extendedprice#4808,cl_discount#4809,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#4852 AS rid_1#4885, cpfk_orders_lineitem#4853 AS cpfk_orders_lineitem_1#4886, cpfk_supplier_lineitem#4854 AS cpfk_supplier_lineitem_1#4887, cfpk_lineitem_supplier#4855 AS cfpk_lineitem_supplier_1#4888, cfpk_lineitem_partsupp#4856 AS cfpk_lineitem_partsupp_1#4889, cpfk_part_lineitem#4857 AS cpfk_part_lineitem_1#4890, cfpk_lineitem_part#4858 AS cfpk_lineitem_part_1#4891, cpfk_partsupp_lineitem#4859 AS cpfk_partsupp_lineitem_1#4892, cfpk_lineitem_orders#4860 AS cfpk_lineitem_orders_1#4893, cval_lineitem_l_quantity#4861 AS cval_lineitem_l_quantity_1#4894, cval_lineitem_l_extendedprice#4862 AS cval_lineitem_l_extendedprice_1#4895, cval_lineitem_l_discount#4863 AS cval_lineitem_l_discount_1#4896, cval_lineitem_l_tax#4864 AS cval_lineitem_l_tax_1#4897, cval_lineitem_l_returnflag#4865 AS cval_lineitem_l_returnflag_1#4898, cval_lineitem_l_linestatus#4866 AS cval_lineitem_l_linestatus_1#4899, cval_lineitem_l_commitdate#4867 AS cval_lineitem_l_commitdate_1#4900, cval_lineitem_l_receiptdate#4868 AS cval_lineitem_l_receiptdate_1#4901, cval_lineitem_l_shipinstruct#4869 AS cval_lineitem_l_shipinstruct_1#4902, cval_lineitem_l_shipmode#4870 AS cval_lineitem_l_shipmode_1#4903, cval_lineitem_l_comment#4871 AS cval_lineitem_l_comment_1#4904, cval_lineitem_l_shipdate#4872 AS cval_lineitem_l_shipdate_1#4905, cl_quantity#4873 AS cl_quantity_1#4906, cl_extendedprice#4874 AS cl_extendedprice_1#4907, cl_discount#4875 AS cl_discount_1#4908, ... 9 more fields]
                  +- Relation[rid#4852,cpfk_orders_lineitem#4853,cpfk_supplier_lineitem#4854,cfpk_lineitem_supplier#4855,cfpk_lineitem_partsupp#4856,cpfk_part_lineitem#4857,cfpk_lineitem_part#4858,cpfk_partsupp_lineitem#4859,cfpk_lineitem_orders#4860,cval_lineitem_l_quantity#4861,cval_lineitem_l_extendedprice#4862,cval_lineitem_l_discount#4863,cval_lineitem_l_tax#4864,cval_lineitem_l_returnflag#4865,cval_lineitem_l_linestatus#4866,cval_lineitem_l_commitdate#4867,cval_lineitem_l_receiptdate#4868,cval_lineitem_l_shipinstruct#4869,cval_lineitem_l_shipmode#4870,cval_lineitem_l_comment#4871,cval_lineitem_l_shipdate#4872,cl_quantity#4873,cl_extendedprice#4874,cl_discount#4875,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 101078ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/15 02:37:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:37:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5072L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/15 02:37:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5072L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#5074 AS rid_0#5091, cpfk_customer_orders#5075 AS cpfk_customer_orders_0#5092, cfpk_orders_customer#5076 AS cfpk_orders_customer_0#5093, cval_orders_o_orderstatus#5077 AS cval_orders_o_orderstatus_0#5094, cval_orders_o_totalprice#5078 AS cval_orders_o_totalprice_0#5095, cval_orders_o_orderpriority#5079 AS cval_orders_o_orderpriority_0#5096, cval_orders_o_clerk#5080 AS cval_orders_o_clerk_0#5097, cval_orders_o_shippriority#5081 AS cval_orders_o_shippriority_0#5098, cval_orders_o_comment#5082 AS cval_orders_o_comment_0#5099, cval_orders_o_orderdate#5083 AS cval_orders_o_orderdate_0#5100, co_orderstatus#5084 AS co_orderstatus_0#5101, co_totalprice#5085 AS co_totalprice_0#5102, co_orderpriority#5086 AS co_orderpriority_0#5103, co_clerk#5087 AS co_clerk_0#5104, co_shippriority#5088 AS co_shippriority_0#5105, co_comment#5089 AS co_comment_0#5106, co_orderdate#5090 AS co_orderdate_0#5107]
            :  +- Relation[rid#5074,cpfk_customer_orders#5075,cfpk_orders_customer#5076,cval_orders_o_orderstatus#5077,cval_orders_o_totalprice#5078,cval_orders_o_orderpriority#5079,cval_orders_o_clerk#5080,cval_orders_o_shippriority#5081,cval_orders_o_comment#5082,cval_orders_o_orderdate#5083,co_orderstatus#5084,co_totalprice#5085,co_orderpriority#5086,co_clerk#5087,co_shippriority#5088,co_comment#5089,co_orderdate#5090] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#5108 AS rid_1#5123, cpfk_nation_customer#5109 AS cpfk_nation_customer_1#5124, cfpk_customer_nation#5110 AS cfpk_customer_nation_1#5125, cval_customer_c_name#5111 AS cval_customer_c_name_1#5126, cval_customer_c_address#5112 AS cval_customer_c_address_1#5127, cval_customer_c_phone#5113 AS cval_customer_c_phone_1#5128, cval_customer_c_acctbal#5114 AS cval_customer_c_acctbal_1#5129, cval_customer_c_comment#5115 AS cval_customer_c_comment_1#5130, cval_customer_c_mktsegment#5116 AS cval_customer_c_mktsegment_1#5131, cc_name#5117 AS cc_name_1#5132, cc_address#5118 AS cc_address_1#5133, cc_phone#5119 AS cc_phone_1#5134, cc_acctbal#5120 AS cc_acctbal_1#5135, cc_comment#5121 AS cc_comment_1#5136, cc_mktsegment#5122 AS cc_mktsegment_1#5137]
               +- Relation[rid#5108,cpfk_nation_customer#5109,cfpk_customer_nation#5110,cval_customer_c_name#5111,cval_customer_c_address#5112,cval_customer_c_phone#5113,cval_customer_c_acctbal#5114,cval_customer_c_comment#5115,cval_customer_c_mktsegment#5116,cc_name#5117,cc_address#5118,cc_phone#5119,cc_acctbal#5120,cc_comment#5121,cc_mktsegment#5122] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13446ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/15 02:37:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:37:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5174L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/15 02:37:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:37:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:37:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:37:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:37:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:37:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:37:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:37:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5174L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#5176 AS rid_0#5209, cpfk_orders_lineitem#5177 AS cpfk_orders_lineitem_0#5210, cpfk_supplier_lineitem#5178 AS cpfk_supplier_lineitem_0#5211, cfpk_lineitem_supplier#5179 AS cfpk_lineitem_supplier_0#5212, cfpk_lineitem_partsupp#5180 AS cfpk_lineitem_partsupp_0#5213, cpfk_part_lineitem#5181 AS cpfk_part_lineitem_0#5214, cfpk_lineitem_part#5182 AS cfpk_lineitem_part_0#5215, cpfk_partsupp_lineitem#5183 AS cpfk_partsupp_lineitem_0#5216, cfpk_lineitem_orders#5184 AS cfpk_lineitem_orders_0#5217, cval_lineitem_l_quantity#5185 AS cval_lineitem_l_quantity_0#5218, cval_lineitem_l_extendedprice#5186 AS cval_lineitem_l_extendedprice_0#5219, cval_lineitem_l_discount#5187 AS cval_lineitem_l_discount_0#5220, cval_lineitem_l_tax#5188 AS cval_lineitem_l_tax_0#5221, cval_lineitem_l_returnflag#5189 AS cval_lineitem_l_returnflag_0#5222, cval_lineitem_l_linestatus#5190 AS cval_lineitem_l_linestatus_0#5223, cval_lineitem_l_commitdate#5191 AS cval_lineitem_l_commitdate_0#5224, cval_lineitem_l_receiptdate#5192 AS cval_lineitem_l_receiptdate_0#5225, cval_lineitem_l_shipinstruct#5193 AS cval_lineitem_l_shipinstruct_0#5226, cval_lineitem_l_shipmode#5194 AS cval_lineitem_l_shipmode_0#5227, cval_lineitem_l_comment#5195 AS cval_lineitem_l_comment_0#5228, cval_lineitem_l_shipdate#5196 AS cval_lineitem_l_shipdate_0#5229, cl_quantity#5197 AS cl_quantity_0#5230, cl_extendedprice#5198 AS cl_extendedprice_0#5231, cl_discount#5199 AS cl_discount_0#5232, ... 9 more fields]
            :  +- Relation[rid#5176,cpfk_orders_lineitem#5177,cpfk_supplier_lineitem#5178,cfpk_lineitem_supplier#5179,cfpk_lineitem_partsupp#5180,cpfk_part_lineitem#5181,cfpk_lineitem_part#5182,cpfk_partsupp_lineitem#5183,cfpk_lineitem_orders#5184,cval_lineitem_l_quantity#5185,cval_lineitem_l_extendedprice#5186,cval_lineitem_l_discount#5187,cval_lineitem_l_tax#5188,cval_lineitem_l_returnflag#5189,cval_lineitem_l_linestatus#5190,cval_lineitem_l_commitdate#5191,cval_lineitem_l_receiptdate#5192,cval_lineitem_l_shipinstruct#5193,cval_lineitem_l_shipmode#5194,cval_lineitem_l_comment#5195,cval_lineitem_l_shipdate#5196,cl_quantity#5197,cl_extendedprice#5198,cl_discount#5199,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#5242 AS rid_1#5259, cpfk_customer_orders#5243 AS cpfk_customer_orders_1#5260, cfpk_orders_customer#5244 AS cfpk_orders_customer_1#5261, cval_orders_o_orderstatus#5245 AS cval_orders_o_orderstatus_1#5262, cval_orders_o_totalprice#5246 AS cval_orders_o_totalprice_1#5263, cval_orders_o_orderpriority#5247 AS cval_orders_o_orderpriority_1#5264, cval_orders_o_clerk#5248 AS cval_orders_o_clerk_1#5265, cval_orders_o_shippriority#5249 AS cval_orders_o_shippriority_1#5266, cval_orders_o_comment#5250 AS cval_orders_o_comment_1#5267, cval_orders_o_orderdate#5251 AS cval_orders_o_orderdate_1#5268, co_orderstatus#5252 AS co_orderstatus_1#5269, co_totalprice#5253 AS co_totalprice_1#5270, co_orderpriority#5254 AS co_orderpriority_1#5271, co_clerk#5255 AS co_clerk_1#5272, co_shippriority#5256 AS co_shippriority_1#5273, co_comment#5257 AS co_comment_1#5274, co_orderdate#5258 AS co_orderdate_1#5275]
                  :     :  :  :  :  +- Relation[rid#5242,cpfk_customer_orders#5243,cfpk_orders_customer#5244,cval_orders_o_orderstatus#5245,cval_orders_o_totalprice#5246,cval_orders_o_orderpriority#5247,cval_orders_o_clerk#5248,cval_orders_o_shippriority#5249,cval_orders_o_comment#5250,cval_orders_o_orderdate#5251,co_orderstatus#5252,co_totalprice#5253,co_orderpriority#5254,co_clerk#5255,co_shippriority#5256,co_comment#5257,co_orderdate#5258] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#5276 AS rid_1#5293, cpfk_customer_orders#5277 AS cpfk_customer_orders_1#5294, cfpk_orders_customer#5278 AS cfpk_orders_customer_1#5295, cval_orders_o_orderstatus#5279 AS cval_orders_o_orderstatus_1#5296, cval_orders_o_totalprice#5280 AS cval_orders_o_totalprice_1#5297, cval_orders_o_orderpriority#5281 AS cval_orders_o_orderpriority_1#5298, cval_orders_o_clerk#5282 AS cval_orders_o_clerk_1#5299, cval_orders_o_shippriority#5283 AS cval_orders_o_shippriority_1#5300, cval_orders_o_comment#5284 AS cval_orders_o_comment_1#5301, cval_orders_o_orderdate#5285 AS cval_orders_o_orderdate_1#5302, co_orderstatus#5286 AS co_orderstatus_1#5303, co_totalprice#5287 AS co_totalprice_1#5304, co_orderpriority#5288 AS co_orderpriority_1#5305, co_clerk#5289 AS co_clerk_1#5306, co_shippriority#5290 AS co_shippriority_1#5307, co_comment#5291 AS co_comment_1#5308, co_orderdate#5292 AS co_orderdate_1#5309]
                  :     :  :  :        +- Relation[rid#5276,cpfk_customer_orders#5277,cfpk_orders_customer#5278,cval_orders_o_orderstatus#5279,cval_orders_o_totalprice#5280,cval_orders_o_orderpriority#5281,cval_orders_o_clerk#5282,cval_orders_o_shippriority#5283,cval_orders_o_comment#5284,cval_orders_o_orderdate#5285,co_orderstatus#5286,co_totalprice#5287,co_orderpriority#5288,co_clerk#5289,co_shippriority#5290,co_comment#5291,co_orderdate#5292] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :     :- Project [rid#5376 AS rid_1#5393, cpfk_customer_orders#5377 AS cpfk_customer_orders_1#5394, cfpk_orders_customer#5378 AS cfpk_orders_customer_1#5395, cval_orders_o_orderstatus#5379 AS cval_orders_o_orderstatus_1#5396, cval_orders_o_totalprice#5380 AS cval_orders_o_totalprice_1#5397, cval_orders_o_orderpriority#5381 AS cval_orders_o_orderpriority_1#5398, cval_orders_o_clerk#5382 AS cval_orders_o_clerk_1#5399, cval_orders_o_shippriority#5383 AS cval_orders_o_shippriority_1#5400, cval_orders_o_comment#5384 AS cval_orders_o_comment_1#5401, cval_orders_o_orderdate#5385 AS cval_orders_o_orderdate_1#5402, co_orderstatus#5386 AS co_orderstatus_1#5403, co_totalprice#5387 AS co_totalprice_1#5404, co_orderpriority#5388 AS co_orderpriority_1#5405, co_clerk#5389 AS co_clerk_1#5406, co_shippriority#5390 AS co_shippriority_1#5407, co_comment#5391 AS co_comment_1#5408, co_orderdate#5392 AS co_orderdate_1#5409]
                  :     :  :     :  +- Relation[rid#5376,cpfk_customer_orders#5377,cfpk_orders_customer#5378,cval_orders_o_orderstatus#5379,cval_orders_o_totalprice#5380,cval_orders_o_orderpriority#5381,cval_orders_o_clerk#5382,cval_orders_o_shippriority#5383,cval_orders_o_comment#5384,cval_orders_o_orderdate#5385,co_orderstatus#5386,co_totalprice#5387,co_orderpriority#5388,co_clerk#5389,co_shippriority#5390,co_comment#5391,co_orderdate#5392] JDBCRelation(torders) [numPartitions=1]
                  :     :  :     +- Project [rid#5410 AS rid_2#5443, cpfk_orders_lineitem#5411 AS cpfk_orders_lineitem_2#5444, cpfk_supplier_lineitem#5412 AS cpfk_supplier_lineitem_2#5445, cfpk_lineitem_supplier#5413 AS cfpk_lineitem_supplier_2#5446, cfpk_lineitem_partsupp#5414 AS cfpk_lineitem_partsupp_2#5447, cpfk_part_lineitem#5415 AS cpfk_part_lineitem_2#5448, cfpk_lineitem_part#5416 AS cfpk_lineitem_part_2#5449, cpfk_partsupp_lineitem#5417 AS cpfk_partsupp_lineitem_2#5450, cfpk_lineitem_orders#5418 AS cfpk_lineitem_orders_2#5451, cval_lineitem_l_quantity#5419 AS cval_lineitem_l_quantity_2#5452, cval_lineitem_l_extendedprice#5420 AS cval_lineitem_l_extendedprice_2#5453, cval_lineitem_l_discount#5421 AS cval_lineitem_l_discount_2#5454, cval_lineitem_l_tax#5422 AS cval_lineitem_l_tax_2#5455, cval_lineitem_l_returnflag#5423 AS cval_lineitem_l_returnflag_2#5456, cval_lineitem_l_linestatus#5424 AS cval_lineitem_l_linestatus_2#5457, cval_lineitem_l_commitdate#5425 AS cval_lineitem_l_commitdate_2#5458, cval_lineitem_l_receiptdate#5426 AS cval_lineitem_l_receiptdate_2#5459, cval_lineitem_l_shipinstruct#5427 AS cval_lineitem_l_shipinstruct_2#5460, cval_lineitem_l_shipmode#5428 AS cval_lineitem_l_shipmode_2#5461, cval_lineitem_l_comment#5429 AS cval_lineitem_l_comment_2#5462, cval_lineitem_l_shipdate#5430 AS cval_lineitem_l_shipdate_2#5463, cl_quantity#5431 AS cl_quantity_2#5464, cl_extendedprice#5432 AS cl_extendedprice_2#5465, cl_discount#5433 AS cl_discount_2#5466, ... 9 more fields]
                  :     :  :        +- Relation[rid#5410,cpfk_orders_lineitem#5411,cpfk_supplier_lineitem#5412,cfpk_lineitem_supplier#5413,cfpk_lineitem_partsupp#5414,cpfk_part_lineitem#5415,cfpk_lineitem_part#5416,cpfk_partsupp_lineitem#5417,cfpk_lineitem_orders#5418,cval_lineitem_l_quantity#5419,cval_lineitem_l_extendedprice#5420,cval_lineitem_l_discount#5421,cval_lineitem_l_tax#5422,cval_lineitem_l_returnflag#5423,cval_lineitem_l_linestatus#5424,cval_lineitem_l_commitdate#5425,cval_lineitem_l_receiptdate#5426,cval_lineitem_l_shipinstruct#5427,cval_lineitem_l_shipmode#5428,cval_lineitem_l_comment#5429,cval_lineitem_l_shipdate#5430,cl_quantity#5431,cl_extendedprice#5432,cl_discount#5433,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#5310 AS rid_2#5343, cpfk_orders_lineitem#5311 AS cpfk_orders_lineitem_2#5344, cpfk_supplier_lineitem#5312 AS cpfk_supplier_lineitem_2#5345, cfpk_lineitem_supplier#5313 AS cfpk_lineitem_supplier_2#5346, cfpk_lineitem_partsupp#5314 AS cfpk_lineitem_partsupp_2#5347, cpfk_part_lineitem#5315 AS cpfk_part_lineitem_2#5348, cfpk_lineitem_part#5316 AS cfpk_lineitem_part_2#5349, cpfk_partsupp_lineitem#5317 AS cpfk_partsupp_lineitem_2#5350, cfpk_lineitem_orders#5318 AS cfpk_lineitem_orders_2#5351, cval_lineitem_l_quantity#5319 AS cval_lineitem_l_quantity_2#5352, cval_lineitem_l_extendedprice#5320 AS cval_lineitem_l_extendedprice_2#5353, cval_lineitem_l_discount#5321 AS cval_lineitem_l_discount_2#5354, cval_lineitem_l_tax#5322 AS cval_lineitem_l_tax_2#5355, cval_lineitem_l_returnflag#5323 AS cval_lineitem_l_returnflag_2#5356, cval_lineitem_l_linestatus#5324 AS cval_lineitem_l_linestatus_2#5357, cval_lineitem_l_commitdate#5325 AS cval_lineitem_l_commitdate_2#5358, cval_lineitem_l_receiptdate#5326 AS cval_lineitem_l_receiptdate_2#5359, cval_lineitem_l_shipinstruct#5327 AS cval_lineitem_l_shipinstruct_2#5360, cval_lineitem_l_shipmode#5328 AS cval_lineitem_l_shipmode_2#5361, cval_lineitem_l_comment#5329 AS cval_lineitem_l_comment_2#5362, cval_lineitem_l_shipdate#5330 AS cval_lineitem_l_shipdate_2#5363, cl_quantity#5331 AS cl_quantity_2#5364, cl_extendedprice#5332 AS cl_extendedprice_2#5365, cl_discount#5333 AS cl_discount_2#5366, ... 9 more fields]
                  :     :     +- Relation[rid#5310,cpfk_orders_lineitem#5311,cpfk_supplier_lineitem#5312,cfpk_lineitem_supplier#5313,cfpk_lineitem_partsupp#5314,cpfk_part_lineitem#5315,cfpk_lineitem_part#5316,cpfk_partsupp_lineitem#5317,cfpk_lineitem_orders#5318,cval_lineitem_l_quantity#5319,cval_lineitem_l_extendedprice#5320,cval_lineitem_l_discount#5321,cval_lineitem_l_tax#5322,cval_lineitem_l_returnflag#5323,cval_lineitem_l_linestatus#5324,cval_lineitem_l_commitdate#5325,cval_lineitem_l_receiptdate#5326,cval_lineitem_l_shipinstruct#5327,cval_lineitem_l_shipmode#5328,cval_lineitem_l_comment#5329,cval_lineitem_l_shipdate#5330,cl_quantity#5331,cl_extendedprice#5332,cl_discount#5333,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#5476 AS rid_3#5489, cpfk_nation_supplier#5477 AS cpfk_nation_supplier_3#5490, cfpk_supplier_nation#5478 AS cfpk_supplier_nation_3#5491, cval_supplier_s_name#5479 AS cval_supplier_s_name_3#5492, cval_supplier_s_address#5480 AS cval_supplier_s_address_3#5493, cval_supplier_s_phone#5481 AS cval_supplier_s_phone_3#5494, cval_supplier_s_acctbal#5482 AS cval_supplier_s_acctbal_3#5495, cval_supplier_s_comment#5483 AS cval_supplier_s_comment_3#5496, cs_name#5484 AS cs_name_3#5497, cs_address#5485 AS cs_address_3#5498, cs_phone#5486 AS cs_phone_3#5499, cs_acctbal#5487 AS cs_acctbal_3#5500, cs_comment#5488 AS cs_comment_3#5501]
                  :        +- Relation[rid#5476,cpfk_nation_supplier#5477,cfpk_supplier_nation#5478,cval_supplier_s_name#5479,cval_supplier_s_address#5480,cval_supplier_s_phone#5481,cval_supplier_s_acctbal#5482,cval_supplier_s_comment#5483,cs_name#5484,cs_address#5485,cs_phone#5486,cs_acctbal#5487,cs_comment#5488] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#5502 AS rid_4#5509, cpfk_region_nation#5503 AS cpfk_region_nation_4#5510, cfpk_nation_region#5504 AS cfpk_nation_region_4#5511, cval_nation_n_name#5505 AS cval_nation_n_name_4#5512, cval_nation_n_comment#5506 AS cval_nation_n_comment_4#5513, cn_name#5507 AS cn_name_4#5514, cn_comment#5508 AS cn_comment_4#5515]
                     :  +- Relation[rid#5502,cpfk_region_nation#5503,cfpk_nation_region#5504,cval_nation_n_name#5505,cval_nation_n_comment#5506,cn_name#5507,cn_comment#5508] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#5516 AS rid_4#5523, cpfk_region_nation#5517 AS cpfk_region_nation_4#5524, cfpk_nation_region#5518 AS cfpk_nation_region_4#5525, cval_nation_n_name#5519 AS cval_nation_n_name_4#5526, cval_nation_n_comment#5520 AS cval_nation_n_comment_4#5527, cn_name#5521 AS cn_name_4#5528, cn_comment#5522 AS cn_comment_4#5529]
                           +- Relation[rid#5516,cpfk_region_nation#5517,cfpk_nation_region#5518,cval_nation_n_name#5519,cval_nation_n_comment#5520,cn_name#5521,cn_comment#5522] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 235427ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 02:41:27 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:41:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5642L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 02:41:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:41:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:41:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:41:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:41:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:41:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:41:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:41:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:41:27 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:41:27 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:41:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5642L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#5644 AS rid_0#5651, cpfk_region_nation#5645 AS cpfk_region_nation_0#5652, cfpk_nation_region#5646 AS cfpk_nation_region_0#5653, cval_nation_n_name#5647 AS cval_nation_n_name_0#5654, cval_nation_n_comment#5648 AS cval_nation_n_comment_0#5655, cn_name#5649 AS cn_name_0#5656, cn_comment#5650 AS cn_comment_0#5657]
            :     :     :  :  :  :  :  +- Relation[rid#5644,cpfk_region_nation#5645,cfpk_nation_region#5646,cval_nation_n_name#5647,cval_nation_n_comment#5648,cn_name#5649,cn_comment#5650] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#5684 AS rid_0#5691, cpfk_region_nation#5685 AS cpfk_region_nation_0#5692, cfpk_nation_region#5686 AS cfpk_nation_region_0#5693, cval_nation_n_name#5687 AS cval_nation_n_name_0#5694, cval_nation_n_comment#5688 AS cval_nation_n_comment_0#5695, cn_name#5689 AS cn_name_0#5696, cn_comment#5690 AS cn_comment_0#5697]
            :     :     :  :  :  :     :  +- Relation[rid#5684,cpfk_region_nation#5685,cfpk_nation_region#5686,cval_nation_n_name#5687,cval_nation_n_comment#5688,cn_name#5689,cn_comment#5690] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#5698 AS rid_1#5711, cpfk_nation_supplier#5699 AS cpfk_nation_supplier_1#5712, cfpk_supplier_nation#5700 AS cfpk_supplier_nation_1#5713, cval_supplier_s_name#5701 AS cval_supplier_s_name_1#5714, cval_supplier_s_address#5702 AS cval_supplier_s_address_1#5715, cval_supplier_s_phone#5703 AS cval_supplier_s_phone_1#5716, cval_supplier_s_acctbal#5704 AS cval_supplier_s_acctbal_1#5717, cval_supplier_s_comment#5705 AS cval_supplier_s_comment_1#5718, cs_name#5706 AS cs_name_1#5719, cs_address#5707 AS cs_address_1#5720, cs_phone#5708 AS cs_phone_1#5721, cs_acctbal#5709 AS cs_acctbal_1#5722, cs_comment#5710 AS cs_comment_1#5723]
            :     :     :  :  :  :        +- Relation[rid#5698,cpfk_nation_supplier#5699,cfpk_supplier_nation#5700,cval_supplier_s_name#5701,cval_supplier_s_address#5702,cval_supplier_s_phone#5703,cval_supplier_s_acctbal#5704,cval_supplier_s_comment#5705,cs_name#5706,cs_address#5707,cs_phone#5708,cs_acctbal#5709,cs_comment#5710] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#5658 AS rid_1#5671, cpfk_nation_supplier#5659 AS cpfk_nation_supplier_1#5672, cfpk_supplier_nation#5660 AS cfpk_supplier_nation_1#5673, cval_supplier_s_name#5661 AS cval_supplier_s_name_1#5674, cval_supplier_s_address#5662 AS cval_supplier_s_address_1#5675, cval_supplier_s_phone#5663 AS cval_supplier_s_phone_1#5676, cval_supplier_s_acctbal#5664 AS cval_supplier_s_acctbal_1#5677, cval_supplier_s_comment#5665 AS cval_supplier_s_comment_1#5678, cs_name#5666 AS cs_name_1#5679, cs_address#5667 AS cs_address_1#5680, cs_phone#5668 AS cs_phone_1#5681, cs_acctbal#5669 AS cs_acctbal_1#5682, cs_comment#5670 AS cs_comment_1#5683]
            :     :     :  :  :     +- Relation[rid#5658,cpfk_nation_supplier#5659,cfpk_supplier_nation#5660,cval_supplier_s_name#5661,cval_supplier_s_address#5662,cval_supplier_s_phone#5663,cval_supplier_s_acctbal#5664,cval_supplier_s_comment#5665,cs_name#5666,cs_address#5667,cs_phone#5668,cs_acctbal#5669,cs_comment#5670] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#5790 AS rid_1#5803, cpfk_nation_supplier#5791 AS cpfk_nation_supplier_1#5804, cfpk_supplier_nation#5792 AS cfpk_supplier_nation_1#5805, cval_supplier_s_name#5793 AS cval_supplier_s_name_1#5806, cval_supplier_s_address#5794 AS cval_supplier_s_address_1#5807, cval_supplier_s_phone#5795 AS cval_supplier_s_phone_1#5808, cval_supplier_s_acctbal#5796 AS cval_supplier_s_acctbal_1#5809, cval_supplier_s_comment#5797 AS cval_supplier_s_comment_1#5810, cs_name#5798 AS cs_name_1#5811, cs_address#5799 AS cs_address_1#5812, cs_phone#5800 AS cs_phone_1#5813, cs_acctbal#5801 AS cs_acctbal_1#5814, cs_comment#5802 AS cs_comment_1#5815]
            :     :     :  :     :  +- Relation[rid#5790,cpfk_nation_supplier#5791,cfpk_supplier_nation#5792,cval_supplier_s_name#5793,cval_supplier_s_address#5794,cval_supplier_s_phone#5795,cval_supplier_s_acctbal#5796,cval_supplier_s_comment#5797,cs_name#5798,cs_address#5799,cs_phone#5800,cs_acctbal#5801,cs_comment#5802] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#5816 AS rid_2#5849, cpfk_orders_lineitem#5817 AS cpfk_orders_lineitem_2#5850, cpfk_supplier_lineitem#5818 AS cpfk_supplier_lineitem_2#5851, cfpk_lineitem_supplier#5819 AS cfpk_lineitem_supplier_2#5852, cfpk_lineitem_partsupp#5820 AS cfpk_lineitem_partsupp_2#5853, cpfk_part_lineitem#5821 AS cpfk_part_lineitem_2#5854, cfpk_lineitem_part#5822 AS cfpk_lineitem_part_2#5855, cpfk_partsupp_lineitem#5823 AS cpfk_partsupp_lineitem_2#5856, cfpk_lineitem_orders#5824 AS cfpk_lineitem_orders_2#5857, cval_lineitem_l_quantity#5825 AS cval_lineitem_l_quantity_2#5858, cval_lineitem_l_extendedprice#5826 AS cval_lineitem_l_extendedprice_2#5859, cval_lineitem_l_discount#5827 AS cval_lineitem_l_discount_2#5860, cval_lineitem_l_tax#5828 AS cval_lineitem_l_tax_2#5861, cval_lineitem_l_returnflag#5829 AS cval_lineitem_l_returnflag_2#5862, cval_lineitem_l_linestatus#5830 AS cval_lineitem_l_linestatus_2#5863, cval_lineitem_l_commitdate#5831 AS cval_lineitem_l_commitdate_2#5864, cval_lineitem_l_receiptdate#5832 AS cval_lineitem_l_receiptdate_2#5865, cval_lineitem_l_shipinstruct#5833 AS cval_lineitem_l_shipinstruct_2#5866, cval_lineitem_l_shipmode#5834 AS cval_lineitem_l_shipmode_2#5867, cval_lineitem_l_comment#5835 AS cval_lineitem_l_comment_2#5868, cval_lineitem_l_shipdate#5836 AS cval_lineitem_l_shipdate_2#5869, cl_quantity#5837 AS cl_quantity_2#5870, cl_extendedprice#5838 AS cl_extendedprice_2#5871, cl_discount#5839 AS cl_discount_2#5872, ... 9 more fields]
            :     :     :  :        +- Relation[rid#5816,cpfk_orders_lineitem#5817,cpfk_supplier_lineitem#5818,cfpk_lineitem_supplier#5819,cfpk_lineitem_partsupp#5820,cpfk_part_lineitem#5821,cfpk_lineitem_part#5822,cpfk_partsupp_lineitem#5823,cfpk_lineitem_orders#5824,cval_lineitem_l_quantity#5825,cval_lineitem_l_extendedprice#5826,cval_lineitem_l_discount#5827,cval_lineitem_l_tax#5828,cval_lineitem_l_returnflag#5829,cval_lineitem_l_linestatus#5830,cval_lineitem_l_commitdate#5831,cval_lineitem_l_receiptdate#5832,cval_lineitem_l_shipinstruct#5833,cval_lineitem_l_shipmode#5834,cval_lineitem_l_comment#5835,cval_lineitem_l_shipdate#5836,cl_quantity#5837,cl_extendedprice#5838,cl_discount#5839,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#5724 AS rid_2#5757, cpfk_orders_lineitem#5725 AS cpfk_orders_lineitem_2#5758, cpfk_supplier_lineitem#5726 AS cpfk_supplier_lineitem_2#5759, cfpk_lineitem_supplier#5727 AS cfpk_lineitem_supplier_2#5760, cfpk_lineitem_partsupp#5728 AS cfpk_lineitem_partsupp_2#5761, cpfk_part_lineitem#5729 AS cpfk_part_lineitem_2#5762, cfpk_lineitem_part#5730 AS cfpk_lineitem_part_2#5763, cpfk_partsupp_lineitem#5731 AS cpfk_partsupp_lineitem_2#5764, cfpk_lineitem_orders#5732 AS cfpk_lineitem_orders_2#5765, cval_lineitem_l_quantity#5733 AS cval_lineitem_l_quantity_2#5766, cval_lineitem_l_extendedprice#5734 AS cval_lineitem_l_extendedprice_2#5767, cval_lineitem_l_discount#5735 AS cval_lineitem_l_discount_2#5768, cval_lineitem_l_tax#5736 AS cval_lineitem_l_tax_2#5769, cval_lineitem_l_returnflag#5737 AS cval_lineitem_l_returnflag_2#5770, cval_lineitem_l_linestatus#5738 AS cval_lineitem_l_linestatus_2#5771, cval_lineitem_l_commitdate#5739 AS cval_lineitem_l_commitdate_2#5772, cval_lineitem_l_receiptdate#5740 AS cval_lineitem_l_receiptdate_2#5773, cval_lineitem_l_shipinstruct#5741 AS cval_lineitem_l_shipinstruct_2#5774, cval_lineitem_l_shipmode#5742 AS cval_lineitem_l_shipmode_2#5775, cval_lineitem_l_comment#5743 AS cval_lineitem_l_comment_2#5776, cval_lineitem_l_shipdate#5744 AS cval_lineitem_l_shipdate_2#5777, cl_quantity#5745 AS cl_quantity_2#5778, cl_extendedprice#5746 AS cl_extendedprice_2#5779, cl_discount#5747 AS cl_discount_2#5780, ... 9 more fields]
            :     :     :     +- Relation[rid#5724,cpfk_orders_lineitem#5725,cpfk_supplier_lineitem#5726,cfpk_lineitem_supplier#5727,cfpk_lineitem_partsupp#5728,cpfk_part_lineitem#5729,cfpk_lineitem_part#5730,cpfk_partsupp_lineitem#5731,cfpk_lineitem_orders#5732,cval_lineitem_l_quantity#5733,cval_lineitem_l_extendedprice#5734,cval_lineitem_l_discount#5735,cval_lineitem_l_tax#5736,cval_lineitem_l_returnflag#5737,cval_lineitem_l_linestatus#5738,cval_lineitem_l_commitdate#5739,cval_lineitem_l_receiptdate#5740,cval_lineitem_l_shipinstruct#5741,cval_lineitem_l_shipmode#5742,cval_lineitem_l_comment#5743,cval_lineitem_l_shipdate#5744,cl_quantity#5745,cl_extendedprice#5746,cl_discount#5747,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#5882 AS rid_3#5899, cval_part_p_name#5883 AS cval_part_p_name_3#5900, cval_part_p_mfgr#5884 AS cval_part_p_mfgr_3#5901, cval_part_p_type#5885 AS cval_part_p_type_3#5902, cval_part_p_size#5886 AS cval_part_p_size_3#5903, cval_part_p_container#5887 AS cval_part_p_container_3#5904, cval_part_p_retailprice#5888 AS cval_part_p_retailprice_3#5905, cval_part_p_comment#5889 AS cval_part_p_comment_3#5906, cval_part_p_brand#5890 AS cval_part_p_brand_3#5907, cp_name#5891 AS cp_name_3#5908, cp_mfgr#5892 AS cp_mfgr_3#5909, cp_type#5893 AS cp_type_3#5910, cp_size#5894 AS cp_size_3#5911, cp_container#5895 AS cp_container_3#5912, cp_retailprice#5896 AS cp_retailprice_3#5913, cp_comment#5897 AS cp_comment_3#5914, cp_brand#5898 AS cp_brand_3#5915]
            :     :        +- Relation[rid#5882,cval_part_p_name#5883,cval_part_p_mfgr#5884,cval_part_p_type#5885,cval_part_p_size#5886,cval_part_p_container#5887,cval_part_p_retailprice#5888,cval_part_p_comment#5889,cval_part_p_brand#5890,cp_name#5891,cp_mfgr#5892,cp_type#5893,cp_size#5894,cp_container#5895,cp_retailprice#5896,cp_comment#5897,cp_brand#5898] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#5916 AS rid_4#5927, cpfk_part_partsupp#5917 AS cpfk_part_partsupp_4#5928, cfpk_partsupp_part#5918 AS cfpk_partsupp_part_4#5929, cpfk_supplier_partsupp#5919 AS cpfk_supplier_partsupp_4#5930, cfpk_partsupp_supplier#5920 AS cfpk_partsupp_supplier_4#5931, cval_partsupp_ps_availqty#5921 AS cval_partsupp_ps_availqty_4#5932, cval_partsupp_ps_supplycost#5922 AS cval_partsupp_ps_supplycost_4#5933, cval_partsupp_ps_comment#5923 AS cval_partsupp_ps_comment_4#5934, cps_availqty#5924 AS cps_availqty_4#5935, cps_supplycost#5925 AS cps_supplycost_4#5936, cps_comment#5926 AS cps_comment_4#5937]
            :        +- Relation[rid#5916,cpfk_part_partsupp#5917,cfpk_partsupp_part#5918,cpfk_supplier_partsupp#5919,cfpk_partsupp_supplier#5920,cval_partsupp_ps_availqty#5921,cval_partsupp_ps_supplycost#5922,cval_partsupp_ps_comment#5923,cps_availqty#5924,cps_supplycost#5925,cps_comment#5926] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#5938 AS rid_5#5955, cpfk_customer_orders#5939 AS cpfk_customer_orders_5#5956, cfpk_orders_customer#5940 AS cfpk_orders_customer_5#5957, cval_orders_o_orderstatus#5941 AS cval_orders_o_orderstatus_5#5958, cval_orders_o_totalprice#5942 AS cval_orders_o_totalprice_5#5959, cval_orders_o_orderpriority#5943 AS cval_orders_o_orderpriority_5#5960, cval_orders_o_clerk#5944 AS cval_orders_o_clerk_5#5961, cval_orders_o_shippriority#5945 AS cval_orders_o_shippriority_5#5962, cval_orders_o_comment#5946 AS cval_orders_o_comment_5#5963, cval_orders_o_orderdate#5947 AS cval_orders_o_orderdate_5#5964, co_orderstatus#5948 AS co_orderstatus_5#5965, co_totalprice#5949 AS co_totalprice_5#5966, co_orderpriority#5950 AS co_orderpriority_5#5967, co_clerk#5951 AS co_clerk_5#5968, co_shippriority#5952 AS co_shippriority_5#5969, co_comment#5953 AS co_comment_5#5970, co_orderdate#5954 AS co_orderdate_5#5971]
               +- Relation[rid#5938,cpfk_customer_orders#5939,cfpk_orders_customer#5940,cval_orders_o_orderstatus#5941,cval_orders_o_totalprice#5942,cval_orders_o_orderpriority#5943,cval_orders_o_clerk#5944,cval_orders_o_shippriority#5945,cval_orders_o_comment#5946,cval_orders_o_orderdate#5947,co_orderstatus#5948,co_totalprice#5949,co_orderpriority#5950,co_clerk#5951,co_shippriority#5952,co_comment#5953,co_orderdate#5954] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 242639ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/15 02:45:30 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:45:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6078L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 02:45:30 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 02:45:30 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 02:45:30 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 02:45:30 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 02:45:30 WARN DexPlanner: InMemoryFileIndex=customer
20/04/15 02:45:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6078L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#6080 AS rid_0#6095, cpfk_nation_customer#6081 AS cpfk_nation_customer_0#6096, cfpk_customer_nation#6082 AS cfpk_customer_nation_0#6097, cval_customer_c_name#6083 AS cval_customer_c_name_0#6098, cval_customer_c_address#6084 AS cval_customer_c_address_0#6099, cval_customer_c_phone#6085 AS cval_customer_c_phone_0#6100, cval_customer_c_acctbal#6086 AS cval_customer_c_acctbal_0#6101, cval_customer_c_comment#6087 AS cval_customer_c_comment_0#6102, cval_customer_c_mktsegment#6088 AS cval_customer_c_mktsegment_0#6103, cc_name#6089 AS cc_name_0#6104, cc_address#6090 AS cc_address_0#6105, cc_phone#6091 AS cc_phone_0#6106, cc_acctbal#6092 AS cc_acctbal_0#6107, cc_comment#6093 AS cc_comment_0#6108, cc_mktsegment#6094 AS cc_mktsegment_0#6109]
         :  :  :  :  :  +- Relation[rid#6080,cpfk_nation_customer#6081,cfpk_customer_nation#6082,cval_customer_c_name#6083,cval_customer_c_address#6084,cval_customer_c_phone#6085,cval_customer_c_acctbal#6086,cval_customer_c_comment#6087,cval_customer_c_mktsegment#6088,cc_name#6089,cc_address#6090,cc_phone#6091,cc_acctbal#6092,cc_comment#6093,cc_mktsegment#6094] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#6110 AS rid_0#6125, cpfk_nation_customer#6111 AS cpfk_nation_customer_0#6126, cfpk_customer_nation#6112 AS cfpk_customer_nation_0#6127, cval_customer_c_name#6113 AS cval_customer_c_name_0#6128, cval_customer_c_address#6114 AS cval_customer_c_address_0#6129, cval_customer_c_phone#6115 AS cval_customer_c_phone_0#6130, cval_customer_c_acctbal#6116 AS cval_customer_c_acctbal_0#6131, cval_customer_c_comment#6117 AS cval_customer_c_comment_0#6132, cval_customer_c_mktsegment#6118 AS cval_customer_c_mktsegment_0#6133, cc_name#6119 AS cc_name_0#6134, cc_address#6120 AS cc_address_0#6135, cc_phone#6121 AS cc_phone_0#6136, cc_acctbal#6122 AS cc_acctbal_0#6137, cc_comment#6123 AS cc_comment_0#6138, cc_mktsegment#6124 AS cc_mktsegment_0#6139]
         :  :  :  :        +- Relation[rid#6110,cpfk_nation_customer#6111,cfpk_customer_nation#6112,cval_customer_c_name#6113,cval_customer_c_address#6114,cval_customer_c_phone#6115,cval_customer_c_acctbal#6116,cval_customer_c_comment#6117,cval_customer_c_mktsegment#6118,cc_name#6119,cc_address#6120,cc_phone#6121,cc_acctbal#6122,cc_comment#6123,cc_mktsegment#6124] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#6174 AS rid_0#6189, cpfk_nation_customer#6175 AS cpfk_nation_customer_0#6190, cfpk_customer_nation#6176 AS cfpk_customer_nation_0#6191, cval_customer_c_name#6177 AS cval_customer_c_name_0#6192, cval_customer_c_address#6178 AS cval_customer_c_address_0#6193, cval_customer_c_phone#6179 AS cval_customer_c_phone_0#6194, cval_customer_c_acctbal#6180 AS cval_customer_c_acctbal_0#6195, cval_customer_c_comment#6181 AS cval_customer_c_comment_0#6196, cval_customer_c_mktsegment#6182 AS cval_customer_c_mktsegment_0#6197, cc_name#6183 AS cc_name_0#6198, cc_address#6184 AS cc_address_0#6199, cc_phone#6185 AS cc_phone_0#6200, cc_acctbal#6186 AS cc_acctbal_0#6201, cc_comment#6187 AS cc_comment_0#6202, cc_mktsegment#6188 AS cc_mktsegment_0#6203]
         :  :  :     :  +- Relation[rid#6174,cpfk_nation_customer#6175,cfpk_customer_nation#6176,cval_customer_c_name#6177,cval_customer_c_address#6178,cval_customer_c_phone#6179,cval_customer_c_acctbal#6180,cval_customer_c_comment#6181,cval_customer_c_mktsegment#6182,cc_name#6183,cc_address#6184,cc_phone#6185,cc_acctbal#6186,cc_comment#6187,cc_mktsegment#6188] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#6204 AS rid_1#6221, cpfk_customer_orders#6205 AS cpfk_customer_orders_1#6222, cfpk_orders_customer#6206 AS cfpk_orders_customer_1#6223, cval_orders_o_orderstatus#6207 AS cval_orders_o_orderstatus_1#6224, cval_orders_o_totalprice#6208 AS cval_orders_o_totalprice_1#6225, cval_orders_o_orderpriority#6209 AS cval_orders_o_orderpriority_1#6226, cval_orders_o_clerk#6210 AS cval_orders_o_clerk_1#6227, cval_orders_o_shippriority#6211 AS cval_orders_o_shippriority_1#6228, cval_orders_o_comment#6212 AS cval_orders_o_comment_1#6229, cval_orders_o_orderdate#6213 AS cval_orders_o_orderdate_1#6230, co_orderstatus#6214 AS co_orderstatus_1#6231, co_totalprice#6215 AS co_totalprice_1#6232, co_orderpriority#6216 AS co_orderpriority_1#6233, co_clerk#6217 AS co_clerk_1#6234, co_shippriority#6218 AS co_shippriority_1#6235, co_comment#6219 AS co_comment_1#6236, co_orderdate#6220 AS co_orderdate_1#6237]
         :  :  :        +- Relation[rid#6204,cpfk_customer_orders#6205,cfpk_orders_customer#6206,cval_orders_o_orderstatus#6207,cval_orders_o_totalprice#6208,cval_orders_o_orderpriority#6209,cval_orders_o_clerk#6210,cval_orders_o_shippriority#6211,cval_orders_o_comment#6212,cval_orders_o_orderdate#6213,co_orderstatus#6214,co_totalprice#6215,co_orderpriority#6216,co_clerk#6217,co_shippriority#6218,co_comment#6219,co_orderdate#6220] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#6140 AS rid_1#6157, cpfk_customer_orders#6141 AS cpfk_customer_orders_1#6158, cfpk_orders_customer#6142 AS cfpk_orders_customer_1#6159, cval_orders_o_orderstatus#6143 AS cval_orders_o_orderstatus_1#6160, cval_orders_o_totalprice#6144 AS cval_orders_o_totalprice_1#6161, cval_orders_o_orderpriority#6145 AS cval_orders_o_orderpriority_1#6162, cval_orders_o_clerk#6146 AS cval_orders_o_clerk_1#6163, cval_orders_o_shippriority#6147 AS cval_orders_o_shippriority_1#6164, cval_orders_o_comment#6148 AS cval_orders_o_comment_1#6165, cval_orders_o_orderdate#6149 AS cval_orders_o_orderdate_1#6166, co_orderstatus#6150 AS co_orderstatus_1#6167, co_totalprice#6151 AS co_totalprice_1#6168, co_orderpriority#6152 AS co_orderpriority_1#6169, co_clerk#6153 AS co_clerk_1#6170, co_shippriority#6154 AS co_shippriority_1#6171, co_comment#6155 AS co_comment_1#6172, co_orderdate#6156 AS co_orderdate_1#6173]
         :  :     +- Relation[rid#6140,cpfk_customer_orders#6141,cfpk_orders_customer#6142,cval_orders_o_orderstatus#6143,cval_orders_o_totalprice#6144,cval_orders_o_orderpriority#6145,cval_orders_o_clerk#6146,cval_orders_o_shippriority#6147,cval_orders_o_comment#6148,cval_orders_o_orderdate#6149,co_orderstatus#6150,co_totalprice#6151,co_orderpriority#6152,co_clerk#6153,co_shippriority#6154,co_comment#6155,co_orderdate#6156] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#6304 AS rid_1#6321, cpfk_customer_orders#6305 AS cpfk_customer_orders_1#6322, cfpk_orders_customer#6306 AS cfpk_orders_customer_1#6323, cval_orders_o_orderstatus#6307 AS cval_orders_o_orderstatus_1#6324, cval_orders_o_totalprice#6308 AS cval_orders_o_totalprice_1#6325, cval_orders_o_orderpriority#6309 AS cval_orders_o_orderpriority_1#6326, cval_orders_o_clerk#6310 AS cval_orders_o_clerk_1#6327, cval_orders_o_shippriority#6311 AS cval_orders_o_shippriority_1#6328, cval_orders_o_comment#6312 AS cval_orders_o_comment_1#6329, cval_orders_o_orderdate#6313 AS cval_orders_o_orderdate_1#6330, co_orderstatus#6314 AS co_orderstatus_1#6331, co_totalprice#6315 AS co_totalprice_1#6332, co_orderpriority#6316 AS co_orderpriority_1#6333, co_clerk#6317 AS co_clerk_1#6334, co_shippriority#6318 AS co_shippriority_1#6335, co_comment#6319 AS co_comment_1#6336, co_orderdate#6320 AS co_orderdate_1#6337]
         :     :  +- Relation[rid#6304,cpfk_customer_orders#6305,cfpk_orders_customer#6306,cval_orders_o_orderstatus#6307,cval_orders_o_totalprice#6308,cval_orders_o_orderpriority#6309,cval_orders_o_clerk#6310,cval_orders_o_shippriority#6311,cval_orders_o_comment#6312,cval_orders_o_orderdate#6313,co_orderstatus#6314,co_totalprice#6315,co_orderpriority#6316,co_clerk#6317,co_shippriority#6318,co_comment#6319,co_orderdate#6320] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#6338 AS rid_2#6371, cpfk_orders_lineitem#6339 AS cpfk_orders_lineitem_2#6372, cpfk_supplier_lineitem#6340 AS cpfk_supplier_lineitem_2#6373, cfpk_lineitem_supplier#6341 AS cfpk_lineitem_supplier_2#6374, cfpk_lineitem_partsupp#6342 AS cfpk_lineitem_partsupp_2#6375, cpfk_part_lineitem#6343 AS cpfk_part_lineitem_2#6376, cfpk_lineitem_part#6344 AS cfpk_lineitem_part_2#6377, cpfk_partsupp_lineitem#6345 AS cpfk_partsupp_lineitem_2#6378, cfpk_lineitem_orders#6346 AS cfpk_lineitem_orders_2#6379, cval_lineitem_l_quantity#6347 AS cval_lineitem_l_quantity_2#6380, cval_lineitem_l_extendedprice#6348 AS cval_lineitem_l_extendedprice_2#6381, cval_lineitem_l_discount#6349 AS cval_lineitem_l_discount_2#6382, cval_lineitem_l_tax#6350 AS cval_lineitem_l_tax_2#6383, cval_lineitem_l_returnflag#6351 AS cval_lineitem_l_returnflag_2#6384, cval_lineitem_l_linestatus#6352 AS cval_lineitem_l_linestatus_2#6385, cval_lineitem_l_commitdate#6353 AS cval_lineitem_l_commitdate_2#6386, cval_lineitem_l_receiptdate#6354 AS cval_lineitem_l_receiptdate_2#6387, cval_lineitem_l_shipinstruct#6355 AS cval_lineitem_l_shipinstruct_2#6388, cval_lineitem_l_shipmode#6356 AS cval_lineitem_l_shipmode_2#6389, cval_lineitem_l_comment#6357 AS cval_lineitem_l_comment_2#6390, cval_lineitem_l_shipdate#6358 AS cval_lineitem_l_shipdate_2#6391, cl_quantity#6359 AS cl_quantity_2#6392, cl_extendedprice#6360 AS cl_extendedprice_2#6393, cl_discount#6361 AS cl_discount_2#6394, ... 9 more fields]
         :        +- Relation[rid#6338,cpfk_orders_lineitem#6339,cpfk_supplier_lineitem#6340,cfpk_lineitem_supplier#6341,cfpk_lineitem_partsupp#6342,cpfk_part_lineitem#6343,cfpk_lineitem_part#6344,cpfk_partsupp_lineitem#6345,cfpk_lineitem_orders#6346,cval_lineitem_l_quantity#6347,cval_lineitem_l_extendedprice#6348,cval_lineitem_l_discount#6349,cval_lineitem_l_tax#6350,cval_lineitem_l_returnflag#6351,cval_lineitem_l_linestatus#6352,cval_lineitem_l_commitdate#6353,cval_lineitem_l_receiptdate#6354,cval_lineitem_l_shipinstruct#6355,cval_lineitem_l_shipmode#6356,cval_lineitem_l_comment#6357,cval_lineitem_l_shipdate#6358,cl_quantity#6359,cl_extendedprice#6360,cl_discount#6361,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6238 AS rid_2#6271, cpfk_orders_lineitem#6239 AS cpfk_orders_lineitem_2#6272, cpfk_supplier_lineitem#6240 AS cpfk_supplier_lineitem_2#6273, cfpk_lineitem_supplier#6241 AS cfpk_lineitem_supplier_2#6274, cfpk_lineitem_partsupp#6242 AS cfpk_lineitem_partsupp_2#6275, cpfk_part_lineitem#6243 AS cpfk_part_lineitem_2#6276, cfpk_lineitem_part#6244 AS cfpk_lineitem_part_2#6277, cpfk_partsupp_lineitem#6245 AS cpfk_partsupp_lineitem_2#6278, cfpk_lineitem_orders#6246 AS cfpk_lineitem_orders_2#6279, cval_lineitem_l_quantity#6247 AS cval_lineitem_l_quantity_2#6280, cval_lineitem_l_extendedprice#6248 AS cval_lineitem_l_extendedprice_2#6281, cval_lineitem_l_discount#6249 AS cval_lineitem_l_discount_2#6282, cval_lineitem_l_tax#6250 AS cval_lineitem_l_tax_2#6283, cval_lineitem_l_returnflag#6251 AS cval_lineitem_l_returnflag_2#6284, cval_lineitem_l_linestatus#6252 AS cval_lineitem_l_linestatus_2#6285, cval_lineitem_l_commitdate#6253 AS cval_lineitem_l_commitdate_2#6286, cval_lineitem_l_receiptdate#6254 AS cval_lineitem_l_receiptdate_2#6287, cval_lineitem_l_shipinstruct#6255 AS cval_lineitem_l_shipinstruct_2#6288, cval_lineitem_l_shipmode#6256 AS cval_lineitem_l_shipmode_2#6289, cval_lineitem_l_comment#6257 AS cval_lineitem_l_comment_2#6290, cval_lineitem_l_shipdate#6258 AS cval_lineitem_l_shipdate_2#6291, cl_quantity#6259 AS cl_quantity_2#6292, cl_extendedprice#6260 AS cl_extendedprice_2#6293, cl_discount#6261 AS cl_discount_2#6294, ... 9 more fields]
            +- Relation[rid#6238,cpfk_orders_lineitem#6239,cpfk_supplier_lineitem#6240,cfpk_lineitem_supplier#6241,cfpk_lineitem_partsupp#6242,cpfk_part_lineitem#6243,cfpk_lineitem_part#6244,cpfk_partsupp_lineitem#6245,cfpk_lineitem_orders#6246,cval_lineitem_l_quantity#6247,cval_lineitem_l_extendedprice#6248,cval_lineitem_l_discount#6249,cval_lineitem_l_tax#6250,cval_lineitem_l_returnflag#6251,cval_lineitem_l_linestatus#6252,cval_lineitem_l_commitdate#6253,cval_lineitem_l_receiptdate#6254,cval_lineitem_l_shipinstruct#6255,cval_lineitem_l_shipmode#6256,cval_lineitem_l_comment#6257,cval_lineitem_l_shipdate#6258,cl_quantity#6259,cl_extendedprice#6260,cl_discount#6261,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 117053ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/15 02:47:27 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:47:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6477L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 02:47:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:47:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:47:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:47:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:47:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:47:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:47:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:47:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:47:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:47:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:47:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:47:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:47:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:47:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:47:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:47:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6477L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#6479 AS rid_0#6486, cpfk_region_nation#6480 AS cpfk_region_nation_0#6487, cfpk_nation_region#6481 AS cfpk_nation_region_0#6488, cval_nation_n_name#6482 AS cval_nation_n_name_0#6489, cval_nation_n_comment#6483 AS cval_nation_n_comment_0#6490, cn_name#6484 AS cn_name_0#6491, cn_comment#6485 AS cn_comment_0#6492]
            :  :  :  :  :  :  +- Relation[rid#6479,cpfk_region_nation#6480,cfpk_nation_region#6481,cval_nation_n_name#6482,cval_nation_n_comment#6483,cn_name#6484,cn_comment#6485] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#6493 AS rid_0#6500, cpfk_region_nation#6494 AS cpfk_region_nation_0#6501, cfpk_nation_region#6495 AS cfpk_nation_region_0#6502, cval_nation_n_name#6496 AS cval_nation_n_name_0#6503, cval_nation_n_comment#6497 AS cval_nation_n_comment_0#6504, cn_name#6498 AS cn_name_0#6505, cn_comment#6499 AS cn_comment_0#6506]
            :  :  :  :  :        +- Relation[rid#6493,cpfk_region_nation#6494,cfpk_nation_region#6495,cval_nation_n_name#6496,cval_nation_n_comment#6497,cn_name#6498,cn_comment#6499] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :     :- Project [rid#6533 AS rid_0#6540, cpfk_region_nation#6534 AS cpfk_region_nation_0#6541, cfpk_nation_region#6535 AS cfpk_nation_region_0#6542, cval_nation_n_name#6536 AS cval_nation_n_name_0#6543, cval_nation_n_comment#6537 AS cval_nation_n_comment_0#6544, cn_name#6538 AS cn_name_0#6545, cn_comment#6539 AS cn_comment_0#6546]
            :  :  :  :     :  +- Relation[rid#6533,cpfk_region_nation#6534,cfpk_nation_region#6535,cval_nation_n_name#6536,cval_nation_n_comment#6537,cn_name#6538,cn_comment#6539] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :     +- Project [rid#6547 AS rid_1#6560, cpfk_nation_supplier#6548 AS cpfk_nation_supplier_1#6561, cfpk_supplier_nation#6549 AS cfpk_supplier_nation_1#6562, cval_supplier_s_name#6550 AS cval_supplier_s_name_1#6563, cval_supplier_s_address#6551 AS cval_supplier_s_address_1#6564, cval_supplier_s_phone#6552 AS cval_supplier_s_phone_1#6565, cval_supplier_s_acctbal#6553 AS cval_supplier_s_acctbal_1#6566, cval_supplier_s_comment#6554 AS cval_supplier_s_comment_1#6567, cs_name#6555 AS cs_name_1#6568, cs_address#6556 AS cs_address_1#6569, cs_phone#6557 AS cs_phone_1#6570, cs_acctbal#6558 AS cs_acctbal_1#6571, cs_comment#6559 AS cs_comment_1#6572]
            :  :  :  :        +- Relation[rid#6547,cpfk_nation_supplier#6548,cfpk_supplier_nation#6549,cval_supplier_s_name#6550,cval_supplier_s_address#6551,cval_supplier_s_phone#6552,cval_supplier_s_acctbal#6553,cval_supplier_s_comment#6554,cs_name#6555,cs_address#6556,cs_phone#6557,cs_acctbal#6558,cs_comment#6559] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#6507 AS rid_1#6520, cpfk_nation_supplier#6508 AS cpfk_nation_supplier_1#6521, cfpk_supplier_nation#6509 AS cfpk_supplier_nation_1#6522, cval_supplier_s_name#6510 AS cval_supplier_s_name_1#6523, cval_supplier_s_address#6511 AS cval_supplier_s_address_1#6524, cval_supplier_s_phone#6512 AS cval_supplier_s_phone_1#6525, cval_supplier_s_acctbal#6513 AS cval_supplier_s_acctbal_1#6526, cval_supplier_s_comment#6514 AS cval_supplier_s_comment_1#6527, cs_name#6515 AS cs_name_1#6528, cs_address#6516 AS cs_address_1#6529, cs_phone#6517 AS cs_phone_1#6530, cs_acctbal#6518 AS cs_acctbal_1#6531, cs_comment#6519 AS cs_comment_1#6532]
            :  :  :     +- Relation[rid#6507,cpfk_nation_supplier#6508,cfpk_supplier_nation#6509,cval_supplier_s_name#6510,cval_supplier_s_address#6511,cval_supplier_s_phone#6512,cval_supplier_s_acctbal#6513,cval_supplier_s_comment#6514,cs_name#6515,cs_address#6516,cs_phone#6517,cs_acctbal#6518,cs_comment#6519] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :     :- Project [rid#6639 AS rid_1#6652, cpfk_nation_supplier#6640 AS cpfk_nation_supplier_1#6653, cfpk_supplier_nation#6641 AS cfpk_supplier_nation_1#6654, cval_supplier_s_name#6642 AS cval_supplier_s_name_1#6655, cval_supplier_s_address#6643 AS cval_supplier_s_address_1#6656, cval_supplier_s_phone#6644 AS cval_supplier_s_phone_1#6657, cval_supplier_s_acctbal#6645 AS cval_supplier_s_acctbal_1#6658, cval_supplier_s_comment#6646 AS cval_supplier_s_comment_1#6659, cs_name#6647 AS cs_name_1#6660, cs_address#6648 AS cs_address_1#6661, cs_phone#6649 AS cs_phone_1#6662, cs_acctbal#6650 AS cs_acctbal_1#6663, cs_comment#6651 AS cs_comment_1#6664]
            :  :     :  +- Relation[rid#6639,cpfk_nation_supplier#6640,cfpk_supplier_nation#6641,cval_supplier_s_name#6642,cval_supplier_s_address#6643,cval_supplier_s_phone#6644,cval_supplier_s_acctbal#6645,cval_supplier_s_comment#6646,cs_name#6647,cs_address#6648,cs_phone#6649,cs_acctbal#6650,cs_comment#6651] JDBCRelation(tsupplier) [numPartitions=1]
            :  :     +- Project [rid#6665 AS rid_2#6698, cpfk_orders_lineitem#6666 AS cpfk_orders_lineitem_2#6699, cpfk_supplier_lineitem#6667 AS cpfk_supplier_lineitem_2#6700, cfpk_lineitem_supplier#6668 AS cfpk_lineitem_supplier_2#6701, cfpk_lineitem_partsupp#6669 AS cfpk_lineitem_partsupp_2#6702, cpfk_part_lineitem#6670 AS cpfk_part_lineitem_2#6703, cfpk_lineitem_part#6671 AS cfpk_lineitem_part_2#6704, cpfk_partsupp_lineitem#6672 AS cpfk_partsupp_lineitem_2#6705, cfpk_lineitem_orders#6673 AS cfpk_lineitem_orders_2#6706, cval_lineitem_l_quantity#6674 AS cval_lineitem_l_quantity_2#6707, cval_lineitem_l_extendedprice#6675 AS cval_lineitem_l_extendedprice_2#6708, cval_lineitem_l_discount#6676 AS cval_lineitem_l_discount_2#6709, cval_lineitem_l_tax#6677 AS cval_lineitem_l_tax_2#6710, cval_lineitem_l_returnflag#6678 AS cval_lineitem_l_returnflag_2#6711, cval_lineitem_l_linestatus#6679 AS cval_lineitem_l_linestatus_2#6712, cval_lineitem_l_commitdate#6680 AS cval_lineitem_l_commitdate_2#6713, cval_lineitem_l_receiptdate#6681 AS cval_lineitem_l_receiptdate_2#6714, cval_lineitem_l_shipinstruct#6682 AS cval_lineitem_l_shipinstruct_2#6715, cval_lineitem_l_shipmode#6683 AS cval_lineitem_l_shipmode_2#6716, cval_lineitem_l_comment#6684 AS cval_lineitem_l_comment_2#6717, cval_lineitem_l_shipdate#6685 AS cval_lineitem_l_shipdate_2#6718, cl_quantity#6686 AS cl_quantity_2#6719, cl_extendedprice#6687 AS cl_extendedprice_2#6720, cl_discount#6688 AS cl_discount_2#6721, ... 9 more fields]
            :  :        +- Relation[rid#6665,cpfk_orders_lineitem#6666,cpfk_supplier_lineitem#6667,cfpk_lineitem_supplier#6668,cfpk_lineitem_partsupp#6669,cpfk_part_lineitem#6670,cfpk_lineitem_part#6671,cpfk_partsupp_lineitem#6672,cfpk_lineitem_orders#6673,cval_lineitem_l_quantity#6674,cval_lineitem_l_extendedprice#6675,cval_lineitem_l_discount#6676,cval_lineitem_l_tax#6677,cval_lineitem_l_returnflag#6678,cval_lineitem_l_linestatus#6679,cval_lineitem_l_commitdate#6680,cval_lineitem_l_receiptdate#6681,cval_lineitem_l_shipinstruct#6682,cval_lineitem_l_shipmode#6683,cval_lineitem_l_comment#6684,cval_lineitem_l_shipdate#6685,cl_quantity#6686,cl_extendedprice#6687,cl_discount#6688,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#6573 AS rid_2#6606, cpfk_orders_lineitem#6574 AS cpfk_orders_lineitem_2#6607, cpfk_supplier_lineitem#6575 AS cpfk_supplier_lineitem_2#6608, cfpk_lineitem_supplier#6576 AS cfpk_lineitem_supplier_2#6609, cfpk_lineitem_partsupp#6577 AS cfpk_lineitem_partsupp_2#6610, cpfk_part_lineitem#6578 AS cpfk_part_lineitem_2#6611, cfpk_lineitem_part#6579 AS cfpk_lineitem_part_2#6612, cpfk_partsupp_lineitem#6580 AS cpfk_partsupp_lineitem_2#6613, cfpk_lineitem_orders#6581 AS cfpk_lineitem_orders_2#6614, cval_lineitem_l_quantity#6582 AS cval_lineitem_l_quantity_2#6615, cval_lineitem_l_extendedprice#6583 AS cval_lineitem_l_extendedprice_2#6616, cval_lineitem_l_discount#6584 AS cval_lineitem_l_discount_2#6617, cval_lineitem_l_tax#6585 AS cval_lineitem_l_tax_2#6618, cval_lineitem_l_returnflag#6586 AS cval_lineitem_l_returnflag_2#6619, cval_lineitem_l_linestatus#6587 AS cval_lineitem_l_linestatus_2#6620, cval_lineitem_l_commitdate#6588 AS cval_lineitem_l_commitdate_2#6621, cval_lineitem_l_receiptdate#6589 AS cval_lineitem_l_receiptdate_2#6622, cval_lineitem_l_shipinstruct#6590 AS cval_lineitem_l_shipinstruct_2#6623, cval_lineitem_l_shipmode#6591 AS cval_lineitem_l_shipmode_2#6624, cval_lineitem_l_comment#6592 AS cval_lineitem_l_comment_2#6625, cval_lineitem_l_shipdate#6593 AS cval_lineitem_l_shipdate_2#6626, cl_quantity#6594 AS cl_quantity_2#6627, cl_extendedprice#6595 AS cl_extendedprice_2#6628, cl_discount#6596 AS cl_discount_2#6629, ... 9 more fields]
            :     +- Relation[rid#6573,cpfk_orders_lineitem#6574,cpfk_supplier_lineitem#6575,cfpk_lineitem_supplier#6576,cfpk_lineitem_partsupp#6577,cpfk_part_lineitem#6578,cfpk_lineitem_part#6579,cpfk_partsupp_lineitem#6580,cfpk_lineitem_orders#6581,cval_lineitem_l_quantity#6582,cval_lineitem_l_extendedprice#6583,cval_lineitem_l_discount#6584,cval_lineitem_l_tax#6585,cval_lineitem_l_returnflag#6586,cval_lineitem_l_linestatus#6587,cval_lineitem_l_commitdate#6588,cval_lineitem_l_receiptdate#6589,cval_lineitem_l_shipinstruct#6590,cval_lineitem_l_shipmode#6591,cval_lineitem_l_comment#6592,cval_lineitem_l_shipdate#6593,cl_quantity#6594,cl_extendedprice#6595,cl_discount#6596,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'Join UsingJoin(Inner,List(rid_4))
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'Join UsingJoin(Inner,List(rid_3))
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#6731 AS rid_3#6738, cpfk_region_nation#6732 AS cpfk_region_nation_3#6739, cfpk_nation_region#6733 AS cfpk_nation_region_3#6740, cval_nation_n_name#6734 AS cval_nation_n_name_3#6741, cval_nation_n_comment#6735 AS cval_nation_n_comment_3#6742, cn_name#6736 AS cn_name_3#6743, cn_comment#6737 AS cn_comment_3#6744]
               :  :  :  :  :  +- Relation[rid#6731,cpfk_region_nation#6732,cfpk_nation_region#6733,cval_nation_n_name#6734,cval_nation_n_comment#6735,cn_name#6736,cn_comment#6737] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#6745 AS rid_3#6752, cpfk_region_nation#6746 AS cpfk_region_nation_3#6753, cfpk_nation_region#6747 AS cfpk_nation_region_3#6754, cval_nation_n_name#6748 AS cval_nation_n_name_3#6755, cval_nation_n_comment#6749 AS cval_nation_n_comment_3#6756, cn_name#6750 AS cn_name_3#6757, cn_comment#6751 AS cn_comment_3#6758]
               :  :  :  :        +- Relation[rid#6745,cpfk_region_nation#6746,cfpk_nation_region#6747,cval_nation_n_name#6748,cval_nation_n_comment#6749,cn_name#6750,cn_comment#6751] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :     :- Project [rid#6789 AS rid_3#6796, cpfk_region_nation#6790 AS cpfk_region_nation_3#6797, cfpk_nation_region#6791 AS cfpk_nation_region_3#6798, cval_nation_n_name#6792 AS cval_nation_n_name_3#6799, cval_nation_n_comment#6793 AS cval_nation_n_comment_3#6800, cn_name#6794 AS cn_name_3#6801, cn_comment#6795 AS cn_comment_3#6802]
               :  :  :     :  +- Relation[rid#6789,cpfk_region_nation#6790,cfpk_nation_region#6791,cval_nation_n_name#6792,cval_nation_n_comment#6793,cn_name#6794,cn_comment#6795] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#6803 AS rid_4#6818, cpfk_nation_customer#6804 AS cpfk_nation_customer_4#6819, cfpk_customer_nation#6805 AS cfpk_customer_nation_4#6820, cval_customer_c_name#6806 AS cval_customer_c_name_4#6821, cval_customer_c_address#6807 AS cval_customer_c_address_4#6822, cval_customer_c_phone#6808 AS cval_customer_c_phone_4#6823, cval_customer_c_acctbal#6809 AS cval_customer_c_acctbal_4#6824, cval_customer_c_comment#6810 AS cval_customer_c_comment_4#6825, cval_customer_c_mktsegment#6811 AS cval_customer_c_mktsegment_4#6826, cc_name#6812 AS cc_name_4#6827, cc_address#6813 AS cc_address_4#6828, cc_phone#6814 AS cc_phone_4#6829, cc_acctbal#6815 AS cc_acctbal_4#6830, cc_comment#6816 AS cc_comment_4#6831, cc_mktsegment#6817 AS cc_mktsegment_4#6832]
               :  :  :        +- Relation[rid#6803,cpfk_nation_customer#6804,cfpk_customer_nation#6805,cval_customer_c_name#6806,cval_customer_c_address#6807,cval_customer_c_phone#6808,cval_customer_c_acctbal#6809,cval_customer_c_comment#6810,cval_customer_c_mktsegment#6811,cc_name#6812,cc_address#6813,cc_phone#6814,cc_acctbal#6815,cc_comment#6816,cc_mktsegment#6817] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#6759 AS rid_4#6774, cpfk_nation_customer#6760 AS cpfk_nation_customer_4#6775, cfpk_customer_nation#6761 AS cfpk_customer_nation_4#6776, cval_customer_c_name#6762 AS cval_customer_c_name_4#6777, cval_customer_c_address#6763 AS cval_customer_c_address_4#6778, cval_customer_c_phone#6764 AS cval_customer_c_phone_4#6779, cval_customer_c_acctbal#6765 AS cval_customer_c_acctbal_4#6780, cval_customer_c_comment#6766 AS cval_customer_c_comment_4#6781, cval_customer_c_mktsegment#6767 AS cval_customer_c_mktsegment_4#6782, cc_name#6768 AS cc_name_4#6783, cc_address#6769 AS cc_address_4#6784, cc_phone#6770 AS cc_phone_4#6785, cc_acctbal#6771 AS cc_acctbal_4#6786, cc_comment#6772 AS cc_comment_4#6787, cc_mktsegment#6773 AS cc_mktsegment_4#6788]
               :  :     +- Relation[rid#6759,cpfk_nation_customer#6760,cfpk_customer_nation#6761,cval_customer_c_name#6762,cval_customer_c_address#6763,cval_customer_c_phone#6764,cval_customer_c_acctbal#6765,cval_customer_c_comment#6766,cval_customer_c_mktsegment#6767,cc_name#6768,cc_address#6769,cc_phone#6770,cc_acctbal#6771,cc_comment#6772,cc_mktsegment#6773] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :     :- Project [rid#6867 AS rid_4#6882, cpfk_nation_customer#6868 AS cpfk_nation_customer_4#6883, cfpk_customer_nation#6869 AS cfpk_customer_nation_4#6884, cval_customer_c_name#6870 AS cval_customer_c_name_4#6885, cval_customer_c_address#6871 AS cval_customer_c_address_4#6886, cval_customer_c_phone#6872 AS cval_customer_c_phone_4#6887, cval_customer_c_acctbal#6873 AS cval_customer_c_acctbal_4#6888, cval_customer_c_comment#6874 AS cval_customer_c_comment_4#6889, cval_customer_c_mktsegment#6875 AS cval_customer_c_mktsegment_4#6890, cc_name#6876 AS cc_name_4#6891, cc_address#6877 AS cc_address_4#6892, cc_phone#6878 AS cc_phone_4#6893, cc_acctbal#6879 AS cc_acctbal_4#6894, cc_comment#6880 AS cc_comment_4#6895, cc_mktsegment#6881 AS cc_mktsegment_4#6896]
               :     :  +- Relation[rid#6867,cpfk_nation_customer#6868,cfpk_customer_nation#6869,cval_customer_c_name#6870,cval_customer_c_address#6871,cval_customer_c_phone#6872,cval_customer_c_acctbal#6873,cval_customer_c_comment#6874,cval_customer_c_mktsegment#6875,cc_name#6876,cc_address#6877,cc_phone#6878,cc_acctbal#6879,cc_comment#6880,cc_mktsegment#6881] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#6897 AS rid_5#6914, cpfk_customer_orders#6898 AS cpfk_customer_orders_5#6915, cfpk_orders_customer#6899 AS cfpk_orders_customer_5#6916, cval_orders_o_orderstatus#6900 AS cval_orders_o_orderstatus_5#6917, cval_orders_o_totalprice#6901 AS cval_orders_o_totalprice_5#6918, cval_orders_o_orderpriority#6902 AS cval_orders_o_orderpriority_5#6919, cval_orders_o_clerk#6903 AS cval_orders_o_clerk_5#6920, cval_orders_o_shippriority#6904 AS cval_orders_o_shippriority_5#6921, cval_orders_o_comment#6905 AS cval_orders_o_comment_5#6922, cval_orders_o_orderdate#6906 AS cval_orders_o_orderdate_5#6923, co_orderstatus#6907 AS co_orderstatus_5#6924, co_totalprice#6908 AS co_totalprice_5#6925, co_orderpriority#6909 AS co_orderpriority_5#6926, co_clerk#6910 AS co_clerk_5#6927, co_shippriority#6911 AS co_shippriority_5#6928, co_comment#6912 AS co_comment_5#6929, co_orderdate#6913 AS co_orderdate_5#6930]
               :        +- Relation[rid#6897,cpfk_customer_orders#6898,cfpk_orders_customer#6899,cval_orders_o_orderstatus#6900,cval_orders_o_totalprice#6901,cval_orders_o_orderpriority#6902,cval_orders_o_clerk#6903,cval_orders_o_shippriority#6904,cval_orders_o_comment#6905,cval_orders_o_orderdate#6906,co_orderstatus#6907,co_totalprice#6908,co_orderpriority#6909,co_clerk#6910,co_shippriority#6911,co_comment#6912,co_orderdate#6913] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#6833 AS rid_5#6850, cpfk_customer_orders#6834 AS cpfk_customer_orders_5#6851, cfpk_orders_customer#6835 AS cfpk_orders_customer_5#6852, cval_orders_o_orderstatus#6836 AS cval_orders_o_orderstatus_5#6853, cval_orders_o_totalprice#6837 AS cval_orders_o_totalprice_5#6854, cval_orders_o_orderpriority#6838 AS cval_orders_o_orderpriority_5#6855, cval_orders_o_clerk#6839 AS cval_orders_o_clerk_5#6856, cval_orders_o_shippriority#6840 AS cval_orders_o_shippriority_5#6857, cval_orders_o_comment#6841 AS cval_orders_o_comment_5#6858, cval_orders_o_orderdate#6842 AS cval_orders_o_orderdate_5#6859, co_orderstatus#6843 AS co_orderstatus_5#6860, co_totalprice#6844 AS co_totalprice_5#6861, co_orderpriority#6845 AS co_orderpriority_5#6862, co_clerk#6846 AS co_clerk_5#6863, co_shippriority#6847 AS co_shippriority_5#6864, co_comment#6848 AS co_comment_5#6865, co_orderdate#6849 AS co_orderdate_5#6866]
                  +- Relation[rid#6833,cpfk_customer_orders#6834,cfpk_orders_customer#6835,cval_orders_o_orderstatus#6836,cval_orders_o_totalprice#6837,cval_orders_o_orderpriority#6838,cval_orders_o_clerk#6839,cval_orders_o_shippriority#6840,cval_orders_o_comment#6841,cval_orders_o_orderdate#6842,co_orderstatus#6843,co_totalprice#6844,co_orderpriority#6845,co_clerk#6846,co_shippriority#6847,co_comment#6848,co_orderdate#6849] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 101389ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/15 02:49:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:49:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7027L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 02:49:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7027L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#7029 AS rid_0#7062, cpfk_orders_lineitem#7030 AS cpfk_orders_lineitem_0#7063, cpfk_supplier_lineitem#7031 AS cpfk_supplier_lineitem_0#7064, cfpk_lineitem_supplier#7032 AS cfpk_lineitem_supplier_0#7065, cfpk_lineitem_partsupp#7033 AS cfpk_lineitem_partsupp_0#7066, cpfk_part_lineitem#7034 AS cpfk_part_lineitem_0#7067, cfpk_lineitem_part#7035 AS cfpk_lineitem_part_0#7068, cpfk_partsupp_lineitem#7036 AS cpfk_partsupp_lineitem_0#7069, cfpk_lineitem_orders#7037 AS cfpk_lineitem_orders_0#7070, cval_lineitem_l_quantity#7038 AS cval_lineitem_l_quantity_0#7071, cval_lineitem_l_extendedprice#7039 AS cval_lineitem_l_extendedprice_0#7072, cval_lineitem_l_discount#7040 AS cval_lineitem_l_discount_0#7073, cval_lineitem_l_tax#7041 AS cval_lineitem_l_tax_0#7074, cval_lineitem_l_returnflag#7042 AS cval_lineitem_l_returnflag_0#7075, cval_lineitem_l_linestatus#7043 AS cval_lineitem_l_linestatus_0#7076, cval_lineitem_l_commitdate#7044 AS cval_lineitem_l_commitdate_0#7077, cval_lineitem_l_receiptdate#7045 AS cval_lineitem_l_receiptdate_0#7078, cval_lineitem_l_shipinstruct#7046 AS cval_lineitem_l_shipinstruct_0#7079, cval_lineitem_l_shipmode#7047 AS cval_lineitem_l_shipmode_0#7080, cval_lineitem_l_comment#7048 AS cval_lineitem_l_comment_0#7081, cval_lineitem_l_shipdate#7049 AS cval_lineitem_l_shipdate_0#7082, cl_quantity#7050 AS cl_quantity_0#7083, cl_extendedprice#7051 AS cl_extendedprice_0#7084, cl_discount#7052 AS cl_discount_0#7085, ... 9 more fields]
            :  :  +- Relation[rid#7029,cpfk_orders_lineitem#7030,cpfk_supplier_lineitem#7031,cfpk_lineitem_supplier#7032,cfpk_lineitem_partsupp#7033,cpfk_part_lineitem#7034,cfpk_lineitem_part#7035,cpfk_partsupp_lineitem#7036,cfpk_lineitem_orders#7037,cval_lineitem_l_quantity#7038,cval_lineitem_l_extendedprice#7039,cval_lineitem_l_discount#7040,cval_lineitem_l_tax#7041,cval_lineitem_l_returnflag#7042,cval_lineitem_l_linestatus#7043,cval_lineitem_l_commitdate#7044,cval_lineitem_l_receiptdate#7045,cval_lineitem_l_shipinstruct#7046,cval_lineitem_l_shipmode#7047,cval_lineitem_l_comment#7048,cval_lineitem_l_shipdate#7049,cl_quantity#7050,cl_extendedprice#7051,cl_discount#7052,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyDependentFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#7095 AS rid_0#7128, cpfk_orders_lineitem#7096 AS cpfk_orders_lineitem_0#7129, cpfk_supplier_lineitem#7097 AS cpfk_supplier_lineitem_0#7130, cfpk_lineitem_supplier#7098 AS cfpk_lineitem_supplier_0#7131, cfpk_lineitem_partsupp#7099 AS cfpk_lineitem_partsupp_0#7132, cpfk_part_lineitem#7100 AS cpfk_part_lineitem_0#7133, cfpk_lineitem_part#7101 AS cfpk_lineitem_part_0#7134, cpfk_partsupp_lineitem#7102 AS cpfk_partsupp_lineitem_0#7135, cfpk_lineitem_orders#7103 AS cfpk_lineitem_orders_0#7136, cval_lineitem_l_quantity#7104 AS cval_lineitem_l_quantity_0#7137, cval_lineitem_l_extendedprice#7105 AS cval_lineitem_l_extendedprice_0#7138, cval_lineitem_l_discount#7106 AS cval_lineitem_l_discount_0#7139, cval_lineitem_l_tax#7107 AS cval_lineitem_l_tax_0#7140, cval_lineitem_l_returnflag#7108 AS cval_lineitem_l_returnflag_0#7141, cval_lineitem_l_linestatus#7109 AS cval_lineitem_l_linestatus_0#7142, cval_lineitem_l_commitdate#7110 AS cval_lineitem_l_commitdate_0#7143, cval_lineitem_l_receiptdate#7111 AS cval_lineitem_l_receiptdate_0#7144, cval_lineitem_l_shipinstruct#7112 AS cval_lineitem_l_shipinstruct_0#7145, cval_lineitem_l_shipmode#7113 AS cval_lineitem_l_shipmode_0#7146, cval_lineitem_l_comment#7114 AS cval_lineitem_l_comment_0#7147, cval_lineitem_l_shipdate#7115 AS cval_lineitem_l_shipdate_0#7148, cl_quantity#7116 AS cl_quantity_0#7149, cl_extendedprice#7117 AS cl_extendedprice_0#7150, cl_discount#7118 AS cl_discount_0#7151, ... 9 more fields]
            :        +- Relation[rid#7095,cpfk_orders_lineitem#7096,cpfk_supplier_lineitem#7097,cfpk_lineitem_supplier#7098,cfpk_lineitem_partsupp#7099,cpfk_part_lineitem#7100,cfpk_lineitem_part#7101,cpfk_partsupp_lineitem#7102,cfpk_lineitem_orders#7103,cval_lineitem_l_quantity#7104,cval_lineitem_l_extendedprice#7105,cval_lineitem_l_discount#7106,cval_lineitem_l_tax#7107,cval_lineitem_l_returnflag#7108,cval_lineitem_l_linestatus#7109,cval_lineitem_l_commitdate#7110,cval_lineitem_l_receiptdate#7111,cval_lineitem_l_shipinstruct#7112,cval_lineitem_l_shipmode#7113,cval_lineitem_l_comment#7114,cval_lineitem_l_shipdate#7115,cl_quantity#7116,cl_extendedprice#7117,cl_discount#7118,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#7161 AS rid_1#7178, cpfk_customer_orders#7162 AS cpfk_customer_orders_1#7179, cfpk_orders_customer#7163 AS cfpk_orders_customer_1#7180, cval_orders_o_orderstatus#7164 AS cval_orders_o_orderstatus_1#7181, cval_orders_o_totalprice#7165 AS cval_orders_o_totalprice_1#7182, cval_orders_o_orderpriority#7166 AS cval_orders_o_orderpriority_1#7183, cval_orders_o_clerk#7167 AS cval_orders_o_clerk_1#7184, cval_orders_o_shippriority#7168 AS cval_orders_o_shippriority_1#7185, cval_orders_o_comment#7169 AS cval_orders_o_comment_1#7186, cval_orders_o_orderdate#7170 AS cval_orders_o_orderdate_1#7187, co_orderstatus#7171 AS co_orderstatus_1#7188, co_totalprice#7172 AS co_totalprice_1#7189, co_orderpriority#7173 AS co_orderpriority_1#7190, co_clerk#7174 AS co_clerk_1#7191, co_shippriority#7175 AS co_shippriority_1#7192, co_comment#7176 AS co_comment_1#7193, co_orderdate#7177 AS co_orderdate_1#7194]
               +- Relation[rid#7161,cpfk_customer_orders#7162,cfpk_orders_customer#7163,cval_orders_o_orderstatus#7164,cval_orders_o_totalprice#7165,cval_orders_o_orderpriority#7166,cval_orders_o_clerk#7167,cval_orders_o_shippriority#7168,cval_orders_o_comment#7169,cval_orders_o_orderdate#7170,co_orderstatus#7171,co_totalprice#7172,co_orderpriority#7173,co_clerk#7174,co_shippriority#7175,co_comment#7176,co_orderdate#7177] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 20783ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/15 02:49:29 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:49:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7249L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 02:49:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 02:49:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 02:49:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 02:49:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 02:49:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 02:49:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 02:49:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/15 02:49:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7249L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#7251 AS rid_0#7268, cval_part_p_name#7252 AS cval_part_p_name_0#7269, cval_part_p_mfgr#7253 AS cval_part_p_mfgr_0#7270, cval_part_p_type#7254 AS cval_part_p_type_0#7271, cval_part_p_size#7255 AS cval_part_p_size_0#7272, cval_part_p_container#7256 AS cval_part_p_container_0#7273, cval_part_p_retailprice#7257 AS cval_part_p_retailprice_0#7274, cval_part_p_comment#7258 AS cval_part_p_comment_0#7275, cval_part_p_brand#7259 AS cval_part_p_brand_0#7276, cp_name#7260 AS cp_name_0#7277, cp_mfgr#7261 AS cp_mfgr_0#7278, cp_type#7262 AS cp_type_0#7279, cp_size#7263 AS cp_size_0#7280, cp_container#7264 AS cp_container_0#7281, cp_retailprice#7265 AS cp_retailprice_0#7282, cp_comment#7266 AS cp_comment_0#7283, cp_brand#7267 AS cp_brand_0#7284]
         :  :  :  :  +- Relation[rid#7251,cval_part_p_name#7252,cval_part_p_mfgr#7253,cval_part_p_type#7254,cval_part_p_size#7255,cval_part_p_container#7256,cval_part_p_retailprice#7257,cval_part_p_comment#7258,cval_part_p_brand#7259,cp_name#7260,cp_mfgr#7261,cp_type#7262,cp_size#7263,cp_container#7264,cp_retailprice#7265,cp_comment#7266,cp_brand#7267] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#7285 AS rid_0#7302, cval_part_p_name#7286 AS cval_part_p_name_0#7303, cval_part_p_mfgr#7287 AS cval_part_p_mfgr_0#7304, cval_part_p_type#7288 AS cval_part_p_type_0#7305, cval_part_p_size#7289 AS cval_part_p_size_0#7306, cval_part_p_container#7290 AS cval_part_p_container_0#7307, cval_part_p_retailprice#7291 AS cval_part_p_retailprice_0#7308, cval_part_p_comment#7292 AS cval_part_p_comment_0#7309, cval_part_p_brand#7293 AS cval_part_p_brand_0#7310, cp_name#7294 AS cp_name_0#7311, cp_mfgr#7295 AS cp_mfgr_0#7312, cp_type#7296 AS cp_type_0#7313, cp_size#7297 AS cp_size_0#7314, cp_container#7298 AS cp_container_0#7315, cp_retailprice#7299 AS cp_retailprice_0#7316, cp_comment#7300 AS cp_comment_0#7317, cp_brand#7301 AS cp_brand_0#7318]
         :  :  :        +- Relation[rid#7285,cval_part_p_name#7286,cval_part_p_mfgr#7287,cval_part_p_type#7288,cval_part_p_size#7289,cval_part_p_container#7290,cval_part_p_retailprice#7291,cval_part_p_comment#7292,cval_part_p_brand#7293,cp_name#7294,cp_mfgr#7295,cp_type#7296,cp_size#7297,cp_container#7298,cp_retailprice#7299,cp_comment#7300,cp_brand#7301] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#7319 AS rid_0#7336, cval_part_p_name#7320 AS cval_part_p_name_0#7337, cval_part_p_mfgr#7321 AS cval_part_p_mfgr_0#7338, cval_part_p_type#7322 AS cval_part_p_type_0#7339, cval_part_p_size#7323 AS cval_part_p_size_0#7340, cval_part_p_container#7324 AS cval_part_p_container_0#7341, cval_part_p_retailprice#7325 AS cval_part_p_retailprice_0#7342, cval_part_p_comment#7326 AS cval_part_p_comment_0#7343, cval_part_p_brand#7327 AS cval_part_p_brand_0#7344, cp_name#7328 AS cp_name_0#7345, cp_mfgr#7329 AS cp_mfgr_0#7346, cp_type#7330 AS cp_type_0#7347, cp_size#7331 AS cp_size_0#7348, cp_container#7332 AS cp_container_0#7349, cp_retailprice#7333 AS cp_retailprice_0#7350, cp_comment#7334 AS cp_comment_0#7351, cp_brand#7335 AS cp_brand_0#7352]
         :  :        +- Relation[rid#7319,cval_part_p_name#7320,cval_part_p_mfgr#7321,cval_part_p_type#7322,cval_part_p_size#7323,cval_part_p_container#7324,cval_part_p_retailprice#7325,cval_part_p_comment#7326,cval_part_p_brand#7327,cp_name#7328,cp_mfgr#7329,cp_type#7330,cp_size#7331,cp_container#7332,cp_retailprice#7333,cp_comment#7334,cp_brand#7335] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#7419 AS rid_0#7436, cval_part_p_name#7420 AS cval_part_p_name_0#7437, cval_part_p_mfgr#7421 AS cval_part_p_mfgr_0#7438, cval_part_p_type#7422 AS cval_part_p_type_0#7439, cval_part_p_size#7423 AS cval_part_p_size_0#7440, cval_part_p_container#7424 AS cval_part_p_container_0#7441, cval_part_p_retailprice#7425 AS cval_part_p_retailprice_0#7442, cval_part_p_comment#7426 AS cval_part_p_comment_0#7443, cval_part_p_brand#7427 AS cval_part_p_brand_0#7444, cp_name#7428 AS cp_name_0#7445, cp_mfgr#7429 AS cp_mfgr_0#7446, cp_type#7430 AS cp_type_0#7447, cp_size#7431 AS cp_size_0#7448, cp_container#7432 AS cp_container_0#7449, cp_retailprice#7433 AS cp_retailprice_0#7450, cp_comment#7434 AS cp_comment_0#7451, cp_brand#7435 AS cp_brand_0#7452]
         :     :  +- Relation[rid#7419,cval_part_p_name#7420,cval_part_p_mfgr#7421,cval_part_p_type#7422,cval_part_p_size#7423,cval_part_p_container#7424,cval_part_p_retailprice#7425,cval_part_p_comment#7426,cval_part_p_brand#7427,cp_name#7428,cp_mfgr#7429,cp_type#7430,cp_size#7431,cp_container#7432,cp_retailprice#7433,cp_comment#7434,cp_brand#7435] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#7453 AS rid_1#7486, cpfk_orders_lineitem#7454 AS cpfk_orders_lineitem_1#7487, cpfk_supplier_lineitem#7455 AS cpfk_supplier_lineitem_1#7488, cfpk_lineitem_supplier#7456 AS cfpk_lineitem_supplier_1#7489, cfpk_lineitem_partsupp#7457 AS cfpk_lineitem_partsupp_1#7490, cpfk_part_lineitem#7458 AS cpfk_part_lineitem_1#7491, cfpk_lineitem_part#7459 AS cfpk_lineitem_part_1#7492, cpfk_partsupp_lineitem#7460 AS cpfk_partsupp_lineitem_1#7493, cfpk_lineitem_orders#7461 AS cfpk_lineitem_orders_1#7494, cval_lineitem_l_quantity#7462 AS cval_lineitem_l_quantity_1#7495, cval_lineitem_l_extendedprice#7463 AS cval_lineitem_l_extendedprice_1#7496, cval_lineitem_l_discount#7464 AS cval_lineitem_l_discount_1#7497, cval_lineitem_l_tax#7465 AS cval_lineitem_l_tax_1#7498, cval_lineitem_l_returnflag#7466 AS cval_lineitem_l_returnflag_1#7499, cval_lineitem_l_linestatus#7467 AS cval_lineitem_l_linestatus_1#7500, cval_lineitem_l_commitdate#7468 AS cval_lineitem_l_commitdate_1#7501, cval_lineitem_l_receiptdate#7469 AS cval_lineitem_l_receiptdate_1#7502, cval_lineitem_l_shipinstruct#7470 AS cval_lineitem_l_shipinstruct_1#7503, cval_lineitem_l_shipmode#7471 AS cval_lineitem_l_shipmode_1#7504, cval_lineitem_l_comment#7472 AS cval_lineitem_l_comment_1#7505, cval_lineitem_l_shipdate#7473 AS cval_lineitem_l_shipdate_1#7506, cl_quantity#7474 AS cl_quantity_1#7507, cl_extendedprice#7475 AS cl_extendedprice_1#7508, cl_discount#7476 AS cl_discount_1#7509, ... 9 more fields]
         :        +- Relation[rid#7453,cpfk_orders_lineitem#7454,cpfk_supplier_lineitem#7455,cfpk_lineitem_supplier#7456,cfpk_lineitem_partsupp#7457,cpfk_part_lineitem#7458,cfpk_lineitem_part#7459,cpfk_partsupp_lineitem#7460,cfpk_lineitem_orders#7461,cval_lineitem_l_quantity#7462,cval_lineitem_l_extendedprice#7463,cval_lineitem_l_discount#7464,cval_lineitem_l_tax#7465,cval_lineitem_l_returnflag#7466,cval_lineitem_l_linestatus#7467,cval_lineitem_l_commitdate#7468,cval_lineitem_l_receiptdate#7469,cval_lineitem_l_shipinstruct#7470,cval_lineitem_l_shipmode#7471,cval_lineitem_l_comment#7472,cval_lineitem_l_shipdate#7473,cl_quantity#7474,cl_extendedprice#7475,cl_discount#7476,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7353 AS rid_1#7386, cpfk_orders_lineitem#7354 AS cpfk_orders_lineitem_1#7387, cpfk_supplier_lineitem#7355 AS cpfk_supplier_lineitem_1#7388, cfpk_lineitem_supplier#7356 AS cfpk_lineitem_supplier_1#7389, cfpk_lineitem_partsupp#7357 AS cfpk_lineitem_partsupp_1#7390, cpfk_part_lineitem#7358 AS cpfk_part_lineitem_1#7391, cfpk_lineitem_part#7359 AS cfpk_lineitem_part_1#7392, cpfk_partsupp_lineitem#7360 AS cpfk_partsupp_lineitem_1#7393, cfpk_lineitem_orders#7361 AS cfpk_lineitem_orders_1#7394, cval_lineitem_l_quantity#7362 AS cval_lineitem_l_quantity_1#7395, cval_lineitem_l_extendedprice#7363 AS cval_lineitem_l_extendedprice_1#7396, cval_lineitem_l_discount#7364 AS cval_lineitem_l_discount_1#7397, cval_lineitem_l_tax#7365 AS cval_lineitem_l_tax_1#7398, cval_lineitem_l_returnflag#7366 AS cval_lineitem_l_returnflag_1#7399, cval_lineitem_l_linestatus#7367 AS cval_lineitem_l_linestatus_1#7400, cval_lineitem_l_commitdate#7368 AS cval_lineitem_l_commitdate_1#7401, cval_lineitem_l_receiptdate#7369 AS cval_lineitem_l_receiptdate_1#7402, cval_lineitem_l_shipinstruct#7370 AS cval_lineitem_l_shipinstruct_1#7403, cval_lineitem_l_shipmode#7371 AS cval_lineitem_l_shipmode_1#7404, cval_lineitem_l_comment#7372 AS cval_lineitem_l_comment_1#7405, cval_lineitem_l_shipdate#7373 AS cval_lineitem_l_shipdate_1#7406, cl_quantity#7374 AS cl_quantity_1#7407, cl_extendedprice#7375 AS cl_extendedprice_1#7408, cl_discount#7376 AS cl_discount_1#7409, ... 9 more fields]
            +- Relation[rid#7353,cpfk_orders_lineitem#7354,cpfk_supplier_lineitem#7355,cfpk_lineitem_supplier#7356,cfpk_lineitem_partsupp#7357,cpfk_part_lineitem#7358,cfpk_lineitem_part#7359,cpfk_partsupp_lineitem#7360,cfpk_lineitem_orders#7361,cval_lineitem_l_quantity#7362,cval_lineitem_l_extendedprice#7363,cval_lineitem_l_discount#7364,cval_lineitem_l_tax#7365,cval_lineitem_l_returnflag#7366,cval_lineitem_l_linestatus#7367,cval_lineitem_l_commitdate#7368,cval_lineitem_l_receiptdate#7369,cval_lineitem_l_shipinstruct#7370,cval_lineitem_l_shipmode#7371,cval_lineitem_l_comment#7372,cval_lineitem_l_shipdate#7373,cl_quantity#7374,cl_extendedprice#7375,cl_discount#7376,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 74459ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/15 02:50:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:50:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7576L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 02:50:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:50:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:50:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:50:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7576L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#7578 AS rid_0#7591, cpfk_nation_supplier#7579 AS cpfk_nation_supplier_0#7592, cfpk_supplier_nation#7580 AS cfpk_supplier_nation_0#7593, cval_supplier_s_name#7581 AS cval_supplier_s_name_0#7594, cval_supplier_s_address#7582 AS cval_supplier_s_address_0#7595, cval_supplier_s_phone#7583 AS cval_supplier_s_phone_0#7596, cval_supplier_s_acctbal#7584 AS cval_supplier_s_acctbal_0#7597, cval_supplier_s_comment#7585 AS cval_supplier_s_comment_0#7598, cs_name#7586 AS cs_name_0#7599, cs_address#7587 AS cs_address_0#7600, cs_phone#7588 AS cs_phone_0#7601, cs_acctbal#7589 AS cs_acctbal_0#7602, cs_comment#7590 AS cs_comment_0#7603]
         :  :  +- Relation[rid#7578,cpfk_nation_supplier#7579,cfpk_supplier_nation#7580,cval_supplier_s_name#7581,cval_supplier_s_address#7582,cval_supplier_s_phone#7583,cval_supplier_s_acctbal#7584,cval_supplier_s_comment#7585,cs_name#7586,cs_address#7587,cs_phone#7588,cs_acctbal#7589,cs_comment#7590] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#7670 AS rid_0#7683, cpfk_nation_supplier#7671 AS cpfk_nation_supplier_0#7684, cfpk_supplier_nation#7672 AS cfpk_supplier_nation_0#7685, cval_supplier_s_name#7673 AS cval_supplier_s_name_0#7686, cval_supplier_s_address#7674 AS cval_supplier_s_address_0#7687, cval_supplier_s_phone#7675 AS cval_supplier_s_phone_0#7688, cval_supplier_s_acctbal#7676 AS cval_supplier_s_acctbal_0#7689, cval_supplier_s_comment#7677 AS cval_supplier_s_comment_0#7690, cs_name#7678 AS cs_name_0#7691, cs_address#7679 AS cs_address_0#7692, cs_phone#7680 AS cs_phone_0#7693, cs_acctbal#7681 AS cs_acctbal_0#7694, cs_comment#7682 AS cs_comment_0#7695]
         :     :  +- Relation[rid#7670,cpfk_nation_supplier#7671,cfpk_supplier_nation#7672,cval_supplier_s_name#7673,cval_supplier_s_address#7674,cval_supplier_s_phone#7675,cval_supplier_s_acctbal#7676,cval_supplier_s_comment#7677,cs_name#7678,cs_address#7679,cs_phone#7680,cs_acctbal#7681,cs_comment#7682] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#7696 AS rid_1#7729, cpfk_orders_lineitem#7697 AS cpfk_orders_lineitem_1#7730, cpfk_supplier_lineitem#7698 AS cpfk_supplier_lineitem_1#7731, cfpk_lineitem_supplier#7699 AS cfpk_lineitem_supplier_1#7732, cfpk_lineitem_partsupp#7700 AS cfpk_lineitem_partsupp_1#7733, cpfk_part_lineitem#7701 AS cpfk_part_lineitem_1#7734, cfpk_lineitem_part#7702 AS cfpk_lineitem_part_1#7735, cpfk_partsupp_lineitem#7703 AS cpfk_partsupp_lineitem_1#7736, cfpk_lineitem_orders#7704 AS cfpk_lineitem_orders_1#7737, cval_lineitem_l_quantity#7705 AS cval_lineitem_l_quantity_1#7738, cval_lineitem_l_extendedprice#7706 AS cval_lineitem_l_extendedprice_1#7739, cval_lineitem_l_discount#7707 AS cval_lineitem_l_discount_1#7740, cval_lineitem_l_tax#7708 AS cval_lineitem_l_tax_1#7741, cval_lineitem_l_returnflag#7709 AS cval_lineitem_l_returnflag_1#7742, cval_lineitem_l_linestatus#7710 AS cval_lineitem_l_linestatus_1#7743, cval_lineitem_l_commitdate#7711 AS cval_lineitem_l_commitdate_1#7744, cval_lineitem_l_receiptdate#7712 AS cval_lineitem_l_receiptdate_1#7745, cval_lineitem_l_shipinstruct#7713 AS cval_lineitem_l_shipinstruct_1#7746, cval_lineitem_l_shipmode#7714 AS cval_lineitem_l_shipmode_1#7747, cval_lineitem_l_comment#7715 AS cval_lineitem_l_comment_1#7748, cval_lineitem_l_shipdate#7716 AS cval_lineitem_l_shipdate_1#7749, cl_quantity#7717 AS cl_quantity_1#7750, cl_extendedprice#7718 AS cl_extendedprice_1#7751, cl_discount#7719 AS cl_discount_1#7752, ... 9 more fields]
         :        +- Relation[rid#7696,cpfk_orders_lineitem#7697,cpfk_supplier_lineitem#7698,cfpk_lineitem_supplier#7699,cfpk_lineitem_partsupp#7700,cpfk_part_lineitem#7701,cfpk_lineitem_part#7702,cpfk_partsupp_lineitem#7703,cfpk_lineitem_orders#7704,cval_lineitem_l_quantity#7705,cval_lineitem_l_extendedprice#7706,cval_lineitem_l_discount#7707,cval_lineitem_l_tax#7708,cval_lineitem_l_returnflag#7709,cval_lineitem_l_linestatus#7710,cval_lineitem_l_commitdate#7711,cval_lineitem_l_receiptdate#7712,cval_lineitem_l_shipinstruct#7713,cval_lineitem_l_shipmode#7714,cval_lineitem_l_comment#7715,cval_lineitem_l_shipdate#7716,cl_quantity#7717,cl_extendedprice#7718,cl_discount#7719,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7604 AS rid_1#7637, cpfk_orders_lineitem#7605 AS cpfk_orders_lineitem_1#7638, cpfk_supplier_lineitem#7606 AS cpfk_supplier_lineitem_1#7639, cfpk_lineitem_supplier#7607 AS cfpk_lineitem_supplier_1#7640, cfpk_lineitem_partsupp#7608 AS cfpk_lineitem_partsupp_1#7641, cpfk_part_lineitem#7609 AS cpfk_part_lineitem_1#7642, cfpk_lineitem_part#7610 AS cfpk_lineitem_part_1#7643, cpfk_partsupp_lineitem#7611 AS cpfk_partsupp_lineitem_1#7644, cfpk_lineitem_orders#7612 AS cfpk_lineitem_orders_1#7645, cval_lineitem_l_quantity#7613 AS cval_lineitem_l_quantity_1#7646, cval_lineitem_l_extendedprice#7614 AS cval_lineitem_l_extendedprice_1#7647, cval_lineitem_l_discount#7615 AS cval_lineitem_l_discount_1#7648, cval_lineitem_l_tax#7616 AS cval_lineitem_l_tax_1#7649, cval_lineitem_l_returnflag#7617 AS cval_lineitem_l_returnflag_1#7650, cval_lineitem_l_linestatus#7618 AS cval_lineitem_l_linestatus_1#7651, cval_lineitem_l_commitdate#7619 AS cval_lineitem_l_commitdate_1#7652, cval_lineitem_l_receiptdate#7620 AS cval_lineitem_l_receiptdate_1#7653, cval_lineitem_l_shipinstruct#7621 AS cval_lineitem_l_shipinstruct_1#7654, cval_lineitem_l_shipmode#7622 AS cval_lineitem_l_shipmode_1#7655, cval_lineitem_l_comment#7623 AS cval_lineitem_l_comment_1#7656, cval_lineitem_l_shipdate#7624 AS cval_lineitem_l_shipdate_1#7657, cl_quantity#7625 AS cl_quantity_1#7658, cl_extendedprice#7626 AS cl_extendedprice_1#7659, cl_discount#7627 AS cl_discount_1#7660, ... 9 more fields]
            +- Relation[rid#7604,cpfk_orders_lineitem#7605,cpfk_supplier_lineitem#7606,cfpk_lineitem_supplier#7607,cfpk_lineitem_partsupp#7608,cpfk_part_lineitem#7609,cfpk_lineitem_part#7610,cpfk_partsupp_lineitem#7611,cfpk_lineitem_orders#7612,cval_lineitem_l_quantity#7613,cval_lineitem_l_extendedprice#7614,cval_lineitem_l_discount#7615,cval_lineitem_l_tax#7616,cval_lineitem_l_returnflag#7617,cval_lineitem_l_linestatus#7618,cval_lineitem_l_commitdate#7619,cval_lineitem_l_receiptdate#7620,cval_lineitem_l_shipinstruct#7621,cval_lineitem_l_shipmode#7622,cval_lineitem_l_comment#7623,cval_lineitem_l_shipdate#7624,cl_quantity#7625,cl_extendedprice#7626,cl_discount#7627,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 74769ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/15 02:51:58 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:51:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7817L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/15 02:51:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:51:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:51:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:51:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:51:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:51:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:51:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:51:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:51:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:51:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:51:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:51:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:51:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:51:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:51:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:51:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:51:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7817L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#7819 AS rid_0#7826, cpfk_region_nation#7820 AS cpfk_region_nation_0#7827, cfpk_nation_region#7821 AS cfpk_nation_region_0#7828, cval_nation_n_name#7822 AS cval_nation_n_name_0#7829, cval_nation_n_comment#7823 AS cval_nation_n_comment_0#7830, cn_name#7824 AS cn_name_0#7831, cn_comment#7825 AS cn_comment_0#7832]
            :  :  :     :  :  :  :  :  +- Relation[rid#7819,cpfk_region_nation#7820,cfpk_nation_region#7821,cval_nation_n_name#7822,cval_nation_n_comment#7823,cn_name#7824,cn_comment#7825] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#7859 AS rid_0#7866, cpfk_region_nation#7860 AS cpfk_region_nation_0#7867, cfpk_nation_region#7861 AS cfpk_nation_region_0#7868, cval_nation_n_name#7862 AS cval_nation_n_name_0#7869, cval_nation_n_comment#7863 AS cval_nation_n_comment_0#7870, cn_name#7864 AS cn_name_0#7871, cn_comment#7865 AS cn_comment_0#7872]
            :  :  :     :  :  :  :     :  +- Relation[rid#7859,cpfk_region_nation#7860,cfpk_nation_region#7861,cval_nation_n_name#7862,cval_nation_n_comment#7863,cn_name#7864,cn_comment#7865] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#7873 AS rid_1#7886, cpfk_nation_supplier#7874 AS cpfk_nation_supplier_1#7887, cfpk_supplier_nation#7875 AS cfpk_supplier_nation_1#7888, cval_supplier_s_name#7876 AS cval_supplier_s_name_1#7889, cval_supplier_s_address#7877 AS cval_supplier_s_address_1#7890, cval_supplier_s_phone#7878 AS cval_supplier_s_phone_1#7891, cval_supplier_s_acctbal#7879 AS cval_supplier_s_acctbal_1#7892, cval_supplier_s_comment#7880 AS cval_supplier_s_comment_1#7893, cs_name#7881 AS cs_name_1#7894, cs_address#7882 AS cs_address_1#7895, cs_phone#7883 AS cs_phone_1#7896, cs_acctbal#7884 AS cs_acctbal_1#7897, cs_comment#7885 AS cs_comment_1#7898]
            :  :  :     :  :  :  :        +- Relation[rid#7873,cpfk_nation_supplier#7874,cfpk_supplier_nation#7875,cval_supplier_s_name#7876,cval_supplier_s_address#7877,cval_supplier_s_phone#7878,cval_supplier_s_acctbal#7879,cval_supplier_s_comment#7880,cs_name#7881,cs_address#7882,cs_phone#7883,cs_acctbal#7884,cs_comment#7885] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#7833 AS rid_1#7846, cpfk_nation_supplier#7834 AS cpfk_nation_supplier_1#7847, cfpk_supplier_nation#7835 AS cfpk_supplier_nation_1#7848, cval_supplier_s_name#7836 AS cval_supplier_s_name_1#7849, cval_supplier_s_address#7837 AS cval_supplier_s_address_1#7850, cval_supplier_s_phone#7838 AS cval_supplier_s_phone_1#7851, cval_supplier_s_acctbal#7839 AS cval_supplier_s_acctbal_1#7852, cval_supplier_s_comment#7840 AS cval_supplier_s_comment_1#7853, cs_name#7841 AS cs_name_1#7854, cs_address#7842 AS cs_address_1#7855, cs_phone#7843 AS cs_phone_1#7856, cs_acctbal#7844 AS cs_acctbal_1#7857, cs_comment#7845 AS cs_comment_1#7858]
            :  :  :     :  :  :     +- Relation[rid#7833,cpfk_nation_supplier#7834,cfpk_supplier_nation#7835,cval_supplier_s_name#7836,cval_supplier_s_address#7837,cval_supplier_s_phone#7838,cval_supplier_s_acctbal#7839,cval_supplier_s_comment#7840,cs_name#7841,cs_address#7842,cs_phone#7843,cs_acctbal#7844,cs_comment#7845] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#7921 AS rid_1#7934, cpfk_nation_supplier#7922 AS cpfk_nation_supplier_1#7935, cfpk_supplier_nation#7923 AS cfpk_supplier_nation_1#7936, cval_supplier_s_name#7924 AS cval_supplier_s_name_1#7937, cval_supplier_s_address#7925 AS cval_supplier_s_address_1#7938, cval_supplier_s_phone#7926 AS cval_supplier_s_phone_1#7939, cval_supplier_s_acctbal#7927 AS cval_supplier_s_acctbal_1#7940, cval_supplier_s_comment#7928 AS cval_supplier_s_comment_1#7941, cs_name#7929 AS cs_name_1#7942, cs_address#7930 AS cs_address_1#7943, cs_phone#7931 AS cs_phone_1#7944, cs_acctbal#7932 AS cs_acctbal_1#7945, cs_comment#7933 AS cs_comment_1#7946]
            :  :  :     :  :     :  +- Relation[rid#7921,cpfk_nation_supplier#7922,cfpk_supplier_nation#7923,cval_supplier_s_name#7924,cval_supplier_s_address#7925,cval_supplier_s_phone#7926,cval_supplier_s_acctbal#7927,cval_supplier_s_comment#7928,cs_name#7929,cs_address#7930,cs_phone#7931,cs_acctbal#7932,cs_comment#7933] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#7947 AS rid_2#7958, cpfk_part_partsupp#7948 AS cpfk_part_partsupp_2#7959, cfpk_partsupp_part#7949 AS cfpk_partsupp_part_2#7960, cpfk_supplier_partsupp#7950 AS cpfk_supplier_partsupp_2#7961, cfpk_partsupp_supplier#7951 AS cfpk_partsupp_supplier_2#7962, cval_partsupp_ps_availqty#7952 AS cval_partsupp_ps_availqty_2#7963, cval_partsupp_ps_supplycost#7953 AS cval_partsupp_ps_supplycost_2#7964, cval_partsupp_ps_comment#7954 AS cval_partsupp_ps_comment_2#7965, cps_availqty#7955 AS cps_availqty_2#7966, cps_supplycost#7956 AS cps_supplycost_2#7967, cps_comment#7957 AS cps_comment_2#7968]
            :  :  :     :  :        +- Relation[rid#7947,cpfk_part_partsupp#7948,cfpk_partsupp_part#7949,cpfk_supplier_partsupp#7950,cfpk_partsupp_supplier#7951,cval_partsupp_ps_availqty#7952,cval_partsupp_ps_supplycost#7953,cval_partsupp_ps_comment#7954,cps_availqty#7955,cps_supplycost#7956,cps_comment#7957] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#7899 AS rid_2#7910, cpfk_part_partsupp#7900 AS cpfk_part_partsupp_2#7911, cfpk_partsupp_part#7901 AS cfpk_partsupp_part_2#7912, cpfk_supplier_partsupp#7902 AS cpfk_supplier_partsupp_2#7913, cfpk_partsupp_supplier#7903 AS cfpk_partsupp_supplier_2#7914, cval_partsupp_ps_availqty#7904 AS cval_partsupp_ps_availqty_2#7915, cval_partsupp_ps_supplycost#7905 AS cval_partsupp_ps_supplycost_2#7916, cval_partsupp_ps_comment#7906 AS cval_partsupp_ps_comment_2#7917, cps_availqty#7907 AS cps_availqty_2#7918, cps_supplycost#7908 AS cps_supplycost_2#7919, cps_comment#7909 AS cps_comment_2#7920]
            :  :  :     :     +- Relation[rid#7899,cpfk_part_partsupp#7900,cfpk_partsupp_part#7901,cpfk_supplier_partsupp#7902,cfpk_partsupp_supplier#7903,cval_partsupp_ps_availqty#7904,cval_partsupp_ps_supplycost#7905,cval_partsupp_ps_comment#7906,cps_availqty#7907,cps_supplycost#7908,cps_comment#7909] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#7969 AS rid_3#7986, cval_part_p_name#7970 AS cval_part_p_name_3#7987, cval_part_p_mfgr#7971 AS cval_part_p_mfgr_3#7988, cval_part_p_type#7972 AS cval_part_p_type_3#7989, cval_part_p_size#7973 AS cval_part_p_size_3#7990, cval_part_p_container#7974 AS cval_part_p_container_3#7991, cval_part_p_retailprice#7975 AS cval_part_p_retailprice_3#7992, cval_part_p_comment#7976 AS cval_part_p_comment_3#7993, cval_part_p_brand#7977 AS cval_part_p_brand_3#7994, cp_name#7978 AS cp_name_3#7995, cp_mfgr#7979 AS cp_mfgr_3#7996, cp_type#7980 AS cp_type_3#7997, cp_size#7981 AS cp_size_3#7998, cp_container#7982 AS cp_container_3#7999, cp_retailprice#7983 AS cp_retailprice_3#8000, cp_comment#7984 AS cp_comment_3#8001, cp_brand#7985 AS cp_brand_3#8002]
            :  :  :        +- Relation[rid#7969,cval_part_p_name#7970,cval_part_p_mfgr#7971,cval_part_p_type#7972,cval_part_p_size#7973,cval_part_p_container#7974,cval_part_p_retailprice#7975,cval_part_p_comment#7976,cval_part_p_brand#7977,cp_name#7978,cp_mfgr#7979,cp_type#7980,cp_size#7981,cp_container#7982,cp_retailprice#7983,cp_comment#7984,cp_brand#7985] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#8069 AS rid_2#8080, cpfk_part_partsupp#8070 AS cpfk_part_partsupp_2#8081, cfpk_partsupp_part#8071 AS cfpk_partsupp_part_2#8082, cpfk_supplier_partsupp#8072 AS cpfk_supplier_partsupp_2#8083, cfpk_partsupp_supplier#8073 AS cfpk_partsupp_supplier_2#8084, cval_partsupp_ps_availqty#8074 AS cval_partsupp_ps_availqty_2#8085, cval_partsupp_ps_supplycost#8075 AS cval_partsupp_ps_supplycost_2#8086, cval_partsupp_ps_comment#8076 AS cval_partsupp_ps_comment_2#8087, cps_availqty#8077 AS cps_availqty_2#8088, cps_supplycost#8078 AS cps_supplycost_2#8089, cps_comment#8079 AS cps_comment_2#8090]
            :  :     :  +- Relation[rid#8069,cpfk_part_partsupp#8070,cfpk_partsupp_part#8071,cpfk_supplier_partsupp#8072,cfpk_partsupp_supplier#8073,cval_partsupp_ps_availqty#8074,cval_partsupp_ps_supplycost#8075,cval_partsupp_ps_comment#8076,cps_availqty#8077,cps_supplycost#8078,cps_comment#8079] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#8091 AS rid_4#8124, cpfk_orders_lineitem#8092 AS cpfk_orders_lineitem_4#8125, cpfk_supplier_lineitem#8093 AS cpfk_supplier_lineitem_4#8126, cfpk_lineitem_supplier#8094 AS cfpk_lineitem_supplier_4#8127, cfpk_lineitem_partsupp#8095 AS cfpk_lineitem_partsupp_4#8128, cpfk_part_lineitem#8096 AS cpfk_part_lineitem_4#8129, cfpk_lineitem_part#8097 AS cfpk_lineitem_part_4#8130, cpfk_partsupp_lineitem#8098 AS cpfk_partsupp_lineitem_4#8131, cfpk_lineitem_orders#8099 AS cfpk_lineitem_orders_4#8132, cval_lineitem_l_quantity#8100 AS cval_lineitem_l_quantity_4#8133, cval_lineitem_l_extendedprice#8101 AS cval_lineitem_l_extendedprice_4#8134, cval_lineitem_l_discount#8102 AS cval_lineitem_l_discount_4#8135, cval_lineitem_l_tax#8103 AS cval_lineitem_l_tax_4#8136, cval_lineitem_l_returnflag#8104 AS cval_lineitem_l_returnflag_4#8137, cval_lineitem_l_linestatus#8105 AS cval_lineitem_l_linestatus_4#8138, cval_lineitem_l_commitdate#8106 AS cval_lineitem_l_commitdate_4#8139, cval_lineitem_l_receiptdate#8107 AS cval_lineitem_l_receiptdate_4#8140, cval_lineitem_l_shipinstruct#8108 AS cval_lineitem_l_shipinstruct_4#8141, cval_lineitem_l_shipmode#8109 AS cval_lineitem_l_shipmode_4#8142, cval_lineitem_l_comment#8110 AS cval_lineitem_l_comment_4#8143, cval_lineitem_l_shipdate#8111 AS cval_lineitem_l_shipdate_4#8144, cl_quantity#8112 AS cl_quantity_4#8145, cl_extendedprice#8113 AS cl_extendedprice_4#8146, cl_discount#8114 AS cl_discount_4#8147, ... 9 more fields]
            :  :        +- Relation[rid#8091,cpfk_orders_lineitem#8092,cpfk_supplier_lineitem#8093,cfpk_lineitem_supplier#8094,cfpk_lineitem_partsupp#8095,cpfk_part_lineitem#8096,cfpk_lineitem_part#8097,cpfk_partsupp_lineitem#8098,cfpk_lineitem_orders#8099,cval_lineitem_l_quantity#8100,cval_lineitem_l_extendedprice#8101,cval_lineitem_l_discount#8102,cval_lineitem_l_tax#8103,cval_lineitem_l_returnflag#8104,cval_lineitem_l_linestatus#8105,cval_lineitem_l_commitdate#8106,cval_lineitem_l_receiptdate#8107,cval_lineitem_l_shipinstruct#8108,cval_lineitem_l_shipmode#8109,cval_lineitem_l_comment#8110,cval_lineitem_l_shipdate#8111,cl_quantity#8112,cl_extendedprice#8113,cl_discount#8114,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#8003 AS rid_4#8036, cpfk_orders_lineitem#8004 AS cpfk_orders_lineitem_4#8037, cpfk_supplier_lineitem#8005 AS cpfk_supplier_lineitem_4#8038, cfpk_lineitem_supplier#8006 AS cfpk_lineitem_supplier_4#8039, cfpk_lineitem_partsupp#8007 AS cfpk_lineitem_partsupp_4#8040, cpfk_part_lineitem#8008 AS cpfk_part_lineitem_4#8041, cfpk_lineitem_part#8009 AS cfpk_lineitem_part_4#8042, cpfk_partsupp_lineitem#8010 AS cpfk_partsupp_lineitem_4#8043, cfpk_lineitem_orders#8011 AS cfpk_lineitem_orders_4#8044, cval_lineitem_l_quantity#8012 AS cval_lineitem_l_quantity_4#8045, cval_lineitem_l_extendedprice#8013 AS cval_lineitem_l_extendedprice_4#8046, cval_lineitem_l_discount#8014 AS cval_lineitem_l_discount_4#8047, cval_lineitem_l_tax#8015 AS cval_lineitem_l_tax_4#8048, cval_lineitem_l_returnflag#8016 AS cval_lineitem_l_returnflag_4#8049, cval_lineitem_l_linestatus#8017 AS cval_lineitem_l_linestatus_4#8050, cval_lineitem_l_commitdate#8018 AS cval_lineitem_l_commitdate_4#8051, cval_lineitem_l_receiptdate#8019 AS cval_lineitem_l_receiptdate_4#8052, cval_lineitem_l_shipinstruct#8020 AS cval_lineitem_l_shipinstruct_4#8053, cval_lineitem_l_shipmode#8021 AS cval_lineitem_l_shipmode_4#8054, cval_lineitem_l_comment#8022 AS cval_lineitem_l_comment_4#8055, cval_lineitem_l_shipdate#8023 AS cval_lineitem_l_shipdate_4#8056, cl_quantity#8024 AS cl_quantity_4#8057, cl_extendedprice#8025 AS cl_extendedprice_4#8058, cl_discount#8026 AS cl_discount_4#8059, ... 9 more fields]
            :     +- Relation[rid#8003,cpfk_orders_lineitem#8004,cpfk_supplier_lineitem#8005,cfpk_lineitem_supplier#8006,cfpk_lineitem_partsupp#8007,cpfk_part_lineitem#8008,cfpk_lineitem_part#8009,cpfk_partsupp_lineitem#8010,cfpk_lineitem_orders#8011,cval_lineitem_l_quantity#8012,cval_lineitem_l_extendedprice#8013,cval_lineitem_l_discount#8014,cval_lineitem_l_tax#8015,cval_lineitem_l_returnflag#8016,cval_lineitem_l_linestatus#8017,cval_lineitem_l_commitdate#8018,cval_lineitem_l_receiptdate#8019,cval_lineitem_l_shipinstruct#8020,cval_lineitem_l_shipmode#8021,cval_lineitem_l_comment#8022,cval_lineitem_l_shipdate#8023,cl_quantity#8024,cl_extendedprice#8025,cl_discount#8026,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#8157 AS rid_5#8174, cpfk_customer_orders#8158 AS cpfk_customer_orders_5#8175, cfpk_orders_customer#8159 AS cfpk_orders_customer_5#8176, cval_orders_o_orderstatus#8160 AS cval_orders_o_orderstatus_5#8177, cval_orders_o_totalprice#8161 AS cval_orders_o_totalprice_5#8178, cval_orders_o_orderpriority#8162 AS cval_orders_o_orderpriority_5#8179, cval_orders_o_clerk#8163 AS cval_orders_o_clerk_5#8180, cval_orders_o_shippriority#8164 AS cval_orders_o_shippriority_5#8181, cval_orders_o_comment#8165 AS cval_orders_o_comment_5#8182, cval_orders_o_orderdate#8166 AS cval_orders_o_orderdate_5#8183, co_orderstatus#8167 AS co_orderstatus_5#8184, co_totalprice#8168 AS co_totalprice_5#8185, co_orderpriority#8169 AS co_orderpriority_5#8186, co_clerk#8170 AS co_clerk_5#8187, co_shippriority#8171 AS co_shippriority_5#8188, co_comment#8172 AS co_comment_5#8189, co_orderdate#8173 AS co_orderdate_5#8190]
               +- Relation[rid#8157,cpfk_customer_orders#8158,cfpk_orders_customer#8159,cval_orders_o_orderstatus#8160,cval_orders_o_totalprice#8161,cval_orders_o_orderpriority#8162,cval_orders_o_clerk#8163,cval_orders_o_shippriority#8164,cval_orders_o_comment#8165,cval_orders_o_orderdate#8166,co_orderstatus#8167,co_totalprice#8168,co_orderpriority#8169,co_clerk#8170,co_shippriority#8171,co_comment#8172,co_orderdate#8173] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 164997ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/15 02:54:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:54:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8295L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 02:54:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:54:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:54:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:54:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:54:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:54:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:54:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:54:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:54:43 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:54:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:54:43 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:54:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:54:43 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:54:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8295L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#8297 AS rid_0#8304, cpfk_region_nation#8298 AS cpfk_region_nation_0#8305, cfpk_nation_region#8299 AS cfpk_nation_region_0#8306, cval_nation_n_name#8300 AS cval_nation_n_name_0#8307, cval_nation_n_comment#8301 AS cval_nation_n_comment_0#8308, cn_name#8302 AS cn_name_0#8309, cn_comment#8303 AS cn_comment_0#8310]
         :  :  :  :  :  +- Relation[rid#8297,cpfk_region_nation#8298,cfpk_nation_region#8299,cval_nation_n_name#8300,cval_nation_n_comment#8301,cn_name#8302,cn_comment#8303] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#8311 AS rid_0#8318, cpfk_region_nation#8312 AS cpfk_region_nation_0#8319, cfpk_nation_region#8313 AS cfpk_nation_region_0#8320, cval_nation_n_name#8314 AS cval_nation_n_name_0#8321, cval_nation_n_comment#8315 AS cval_nation_n_comment_0#8322, cn_name#8316 AS cn_name_0#8323, cn_comment#8317 AS cn_comment_0#8324]
         :  :  :  :        +- Relation[rid#8311,cpfk_region_nation#8312,cfpk_nation_region#8313,cval_nation_n_name#8314,cval_nation_n_comment#8315,cn_name#8316,cn_comment#8317] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :     :- Project [rid#8351 AS rid_0#8358, cpfk_region_nation#8352 AS cpfk_region_nation_0#8359, cfpk_nation_region#8353 AS cfpk_nation_region_0#8360, cval_nation_n_name#8354 AS cval_nation_n_name_0#8361, cval_nation_n_comment#8355 AS cval_nation_n_comment_0#8362, cn_name#8356 AS cn_name_0#8363, cn_comment#8357 AS cn_comment_0#8364]
         :  :  :     :  +- Relation[rid#8351,cpfk_region_nation#8352,cfpk_nation_region#8353,cval_nation_n_name#8354,cval_nation_n_comment#8355,cn_name#8356,cn_comment#8357] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#8365 AS rid_1#8378, cpfk_nation_supplier#8366 AS cpfk_nation_supplier_1#8379, cfpk_supplier_nation#8367 AS cfpk_supplier_nation_1#8380, cval_supplier_s_name#8368 AS cval_supplier_s_name_1#8381, cval_supplier_s_address#8369 AS cval_supplier_s_address_1#8382, cval_supplier_s_phone#8370 AS cval_supplier_s_phone_1#8383, cval_supplier_s_acctbal#8371 AS cval_supplier_s_acctbal_1#8384, cval_supplier_s_comment#8372 AS cval_supplier_s_comment_1#8385, cs_name#8373 AS cs_name_1#8386, cs_address#8374 AS cs_address_1#8387, cs_phone#8375 AS cs_phone_1#8388, cs_acctbal#8376 AS cs_acctbal_1#8389, cs_comment#8377 AS cs_comment_1#8390]
         :  :  :        +- Relation[rid#8365,cpfk_nation_supplier#8366,cfpk_supplier_nation#8367,cval_supplier_s_name#8368,cval_supplier_s_address#8369,cval_supplier_s_phone#8370,cval_supplier_s_acctbal#8371,cval_supplier_s_comment#8372,cs_name#8373,cs_address#8374,cs_phone#8375,cs_acctbal#8376,cs_comment#8377] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#8325 AS rid_1#8338, cpfk_nation_supplier#8326 AS cpfk_nation_supplier_1#8339, cfpk_supplier_nation#8327 AS cfpk_supplier_nation_1#8340, cval_supplier_s_name#8328 AS cval_supplier_s_name_1#8341, cval_supplier_s_address#8329 AS cval_supplier_s_address_1#8342, cval_supplier_s_phone#8330 AS cval_supplier_s_phone_1#8343, cval_supplier_s_acctbal#8331 AS cval_supplier_s_acctbal_1#8344, cval_supplier_s_comment#8332 AS cval_supplier_s_comment_1#8345, cs_name#8333 AS cs_name_1#8346, cs_address#8334 AS cs_address_1#8347, cs_phone#8335 AS cs_phone_1#8348, cs_acctbal#8336 AS cs_acctbal_1#8349, cs_comment#8337 AS cs_comment_1#8350]
         :  :     +- Relation[rid#8325,cpfk_nation_supplier#8326,cfpk_supplier_nation#8327,cval_supplier_s_name#8328,cval_supplier_s_address#8329,cval_supplier_s_phone#8330,cval_supplier_s_acctbal#8331,cval_supplier_s_comment#8332,cs_name#8333,cs_address#8334,cs_phone#8335,cs_acctbal#8336,cs_comment#8337] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :     :- Project [rid#8413 AS rid_1#8426, cpfk_nation_supplier#8414 AS cpfk_nation_supplier_1#8427, cfpk_supplier_nation#8415 AS cfpk_supplier_nation_1#8428, cval_supplier_s_name#8416 AS cval_supplier_s_name_1#8429, cval_supplier_s_address#8417 AS cval_supplier_s_address_1#8430, cval_supplier_s_phone#8418 AS cval_supplier_s_phone_1#8431, cval_supplier_s_acctbal#8419 AS cval_supplier_s_acctbal_1#8432, cval_supplier_s_comment#8420 AS cval_supplier_s_comment_1#8433, cs_name#8421 AS cs_name_1#8434, cs_address#8422 AS cs_address_1#8435, cs_phone#8423 AS cs_phone_1#8436, cs_acctbal#8424 AS cs_acctbal_1#8437, cs_comment#8425 AS cs_comment_1#8438]
         :     :  +- Relation[rid#8413,cpfk_nation_supplier#8414,cfpk_supplier_nation#8415,cval_supplier_s_name#8416,cval_supplier_s_address#8417,cval_supplier_s_phone#8418,cval_supplier_s_acctbal#8419,cval_supplier_s_comment#8420,cs_name#8421,cs_address#8422,cs_phone#8423,cs_acctbal#8424,cs_comment#8425] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#8439 AS rid_2#8450, cpfk_part_partsupp#8440 AS cpfk_part_partsupp_2#8451, cfpk_partsupp_part#8441 AS cfpk_partsupp_part_2#8452, cpfk_supplier_partsupp#8442 AS cpfk_supplier_partsupp_2#8453, cfpk_partsupp_supplier#8443 AS cfpk_partsupp_supplier_2#8454, cval_partsupp_ps_availqty#8444 AS cval_partsupp_ps_availqty_2#8455, cval_partsupp_ps_supplycost#8445 AS cval_partsupp_ps_supplycost_2#8456, cval_partsupp_ps_comment#8446 AS cval_partsupp_ps_comment_2#8457, cps_availqty#8447 AS cps_availqty_2#8458, cps_supplycost#8448 AS cps_supplycost_2#8459, cps_comment#8449 AS cps_comment_2#8460]
         :        +- Relation[rid#8439,cpfk_part_partsupp#8440,cfpk_partsupp_part#8441,cpfk_supplier_partsupp#8442,cfpk_partsupp_supplier#8443,cval_partsupp_ps_availqty#8444,cval_partsupp_ps_supplycost#8445,cval_partsupp_ps_comment#8446,cps_availqty#8447,cps_supplycost#8448,cps_comment#8449] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#8391 AS rid_2#8402, cpfk_part_partsupp#8392 AS cpfk_part_partsupp_2#8403, cfpk_partsupp_part#8393 AS cfpk_partsupp_part_2#8404, cpfk_supplier_partsupp#8394 AS cpfk_supplier_partsupp_2#8405, cfpk_partsupp_supplier#8395 AS cfpk_partsupp_supplier_2#8406, cval_partsupp_ps_availqty#8396 AS cval_partsupp_ps_availqty_2#8407, cval_partsupp_ps_supplycost#8397 AS cval_partsupp_ps_supplycost_2#8408, cval_partsupp_ps_comment#8398 AS cval_partsupp_ps_comment_2#8409, cps_availqty#8399 AS cps_availqty_2#8410, cps_supplycost#8400 AS cps_supplycost_2#8411, cps_comment#8401 AS cps_comment_2#8412]
            +- Relation[rid#8391,cpfk_part_partsupp#8392,cfpk_partsupp_part#8393,cpfk_supplier_partsupp#8394,cfpk_partsupp_supplier#8395,cval_partsupp_ps_availqty#8396,cval_partsupp_ps_supplycost#8397,cval_partsupp_ps_comment#8398,cps_availqty#8399,cps_supplycost#8400,cps_comment#8401] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 10339ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/15 02:54:53 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:54:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8497L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 02:54:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#8497L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#8499 AS rid_0#8532, cpfk_orders_lineitem#8500 AS cpfk_orders_lineitem_0#8533, cpfk_supplier_lineitem#8501 AS cpfk_supplier_lineitem_0#8534, cfpk_lineitem_supplier#8502 AS cfpk_lineitem_supplier_0#8535, cfpk_lineitem_partsupp#8503 AS cfpk_lineitem_partsupp_0#8536, cpfk_part_lineitem#8504 AS cpfk_part_lineitem_0#8537, cfpk_lineitem_part#8505 AS cfpk_lineitem_part_0#8538, cpfk_partsupp_lineitem#8506 AS cpfk_partsupp_lineitem_0#8539, cfpk_lineitem_orders#8507 AS cfpk_lineitem_orders_0#8540, cval_lineitem_l_quantity#8508 AS cval_lineitem_l_quantity_0#8541, cval_lineitem_l_extendedprice#8509 AS cval_lineitem_l_extendedprice_0#8542, cval_lineitem_l_discount#8510 AS cval_lineitem_l_discount_0#8543, cval_lineitem_l_tax#8511 AS cval_lineitem_l_tax_0#8544, cval_lineitem_l_returnflag#8512 AS cval_lineitem_l_returnflag_0#8545, cval_lineitem_l_linestatus#8513 AS cval_lineitem_l_linestatus_0#8546, cval_lineitem_l_commitdate#8514 AS cval_lineitem_l_commitdate_0#8547, cval_lineitem_l_receiptdate#8515 AS cval_lineitem_l_receiptdate_0#8548, cval_lineitem_l_shipinstruct#8516 AS cval_lineitem_l_shipinstruct_0#8549, cval_lineitem_l_shipmode#8517 AS cval_lineitem_l_shipmode_0#8550, cval_lineitem_l_comment#8518 AS cval_lineitem_l_comment_0#8551, cval_lineitem_l_shipdate#8519 AS cval_lineitem_l_shipdate_0#8552, cl_quantity#8520 AS cl_quantity_0#8553, cl_extendedprice#8521 AS cl_extendedprice_0#8554, cl_discount#8522 AS cl_discount_0#8555, ... 9 more fields]
         +- Relation[rid#8499,cpfk_orders_lineitem#8500,cpfk_supplier_lineitem#8501,cfpk_lineitem_supplier#8502,cfpk_lineitem_partsupp#8503,cpfk_part_lineitem#8504,cfpk_lineitem_part#8505,cpfk_partsupp_lineitem#8506,cfpk_lineitem_orders#8507,cval_lineitem_l_quantity#8508,cval_lineitem_l_extendedprice#8509,cval_lineitem_l_discount#8510,cval_lineitem_l_tax#8511,cval_lineitem_l_returnflag#8512,cval_lineitem_l_linestatus#8513,cval_lineitem_l_commitdate#8514,cval_lineitem_l_receiptdate#8515,cval_lineitem_l_shipinstruct#8516,cval_lineitem_l_shipmode#8517,cval_lineitem_l_comment#8518,cval_lineitem_l_shipdate#8519,cl_quantity#8520,cl_extendedprice#8521,cl_discount#8522,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2749ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/15 02:54:56 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:54:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8605L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 02:54:56 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:54:56 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:54:56 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:54:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8605L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#8607 AS rid_0#8624, cval_part_p_name#8608 AS cval_part_p_name_0#8625, cval_part_p_mfgr#8609 AS cval_part_p_mfgr_0#8626, cval_part_p_type#8610 AS cval_part_p_type_0#8627, cval_part_p_size#8611 AS cval_part_p_size_0#8628, cval_part_p_container#8612 AS cval_part_p_container_0#8629, cval_part_p_retailprice#8613 AS cval_part_p_retailprice_0#8630, cval_part_p_comment#8614 AS cval_part_p_comment_0#8631, cval_part_p_brand#8615 AS cval_part_p_brand_0#8632, cp_name#8616 AS cp_name_0#8633, cp_mfgr#8617 AS cp_mfgr_0#8634, cp_type#8618 AS cp_type_0#8635, cp_size#8619 AS cp_size_0#8636, cp_container#8620 AS cp_container_0#8637, cp_retailprice#8621 AS cp_retailprice_0#8638, cp_comment#8622 AS cp_comment_0#8639, cp_brand#8623 AS cp_brand_0#8640]
         :  :  :  +- Relation[rid#8607,cval_part_p_name#8608,cval_part_p_mfgr#8609,cval_part_p_type#8610,cval_part_p_size#8611,cval_part_p_container#8612,cval_part_p_retailprice#8613,cval_part_p_comment#8614,cval_part_p_brand#8615,cp_name#8616,cp_mfgr#8617,cp_type#8618,cp_size#8619,cp_container#8620,cp_retailprice#8621,cp_comment#8622,cp_brand#8623] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#8641 AS rid_0#8658, cval_part_p_name#8642 AS cval_part_p_name_0#8659, cval_part_p_mfgr#8643 AS cval_part_p_mfgr_0#8660, cval_part_p_type#8644 AS cval_part_p_type_0#8661, cval_part_p_size#8645 AS cval_part_p_size_0#8662, cval_part_p_container#8646 AS cval_part_p_container_0#8663, cval_part_p_retailprice#8647 AS cval_part_p_retailprice_0#8664, cval_part_p_comment#8648 AS cval_part_p_comment_0#8665, cval_part_p_brand#8649 AS cval_part_p_brand_0#8666, cp_name#8650 AS cp_name_0#8667, cp_mfgr#8651 AS cp_mfgr_0#8668, cp_type#8652 AS cp_type_0#8669, cp_size#8653 AS cp_size_0#8670, cp_container#8654 AS cp_container_0#8671, cp_retailprice#8655 AS cp_retailprice_0#8672, cp_comment#8656 AS cp_comment_0#8673, cp_brand#8657 AS cp_brand_0#8674]
         :  :        +- Relation[rid#8641,cval_part_p_name#8642,cval_part_p_mfgr#8643,cval_part_p_type#8644,cval_part_p_size#8645,cval_part_p_container#8646,cval_part_p_retailprice#8647,cval_part_p_comment#8648,cval_part_p_brand#8649,cp_name#8650,cp_mfgr#8651,cp_type#8652,cp_size#8653,cp_container#8654,cp_retailprice#8655,cp_comment#8656,cp_brand#8657] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :     :- Project [rid#8697 AS rid_0#8714, cval_part_p_name#8698 AS cval_part_p_name_0#8715, cval_part_p_mfgr#8699 AS cval_part_p_mfgr_0#8716, cval_part_p_type#8700 AS cval_part_p_type_0#8717, cval_part_p_size#8701 AS cval_part_p_size_0#8718, cval_part_p_container#8702 AS cval_part_p_container_0#8719, cval_part_p_retailprice#8703 AS cval_part_p_retailprice_0#8720, cval_part_p_comment#8704 AS cval_part_p_comment_0#8721, cval_part_p_brand#8705 AS cval_part_p_brand_0#8722, cp_name#8706 AS cp_name_0#8723, cp_mfgr#8707 AS cp_mfgr_0#8724, cp_type#8708 AS cp_type_0#8725, cp_size#8709 AS cp_size_0#8726, cp_container#8710 AS cp_container_0#8727, cp_retailprice#8711 AS cp_retailprice_0#8728, cp_comment#8712 AS cp_comment_0#8729, cp_brand#8713 AS cp_brand_0#8730]
         :     :  +- Relation[rid#8697,cval_part_p_name#8698,cval_part_p_mfgr#8699,cval_part_p_type#8700,cval_part_p_size#8701,cval_part_p_container#8702,cval_part_p_retailprice#8703,cval_part_p_comment#8704,cval_part_p_brand#8705,cp_name#8706,cp_mfgr#8707,cp_type#8708,cp_size#8709,cp_container#8710,cp_retailprice#8711,cp_comment#8712,cp_brand#8713] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#8731 AS rid_1#8742, cpfk_part_partsupp#8732 AS cpfk_part_partsupp_1#8743, cfpk_partsupp_part#8733 AS cfpk_partsupp_part_1#8744, cpfk_supplier_partsupp#8734 AS cpfk_supplier_partsupp_1#8745, cfpk_partsupp_supplier#8735 AS cfpk_partsupp_supplier_1#8746, cval_partsupp_ps_availqty#8736 AS cval_partsupp_ps_availqty_1#8747, cval_partsupp_ps_supplycost#8737 AS cval_partsupp_ps_supplycost_1#8748, cval_partsupp_ps_comment#8738 AS cval_partsupp_ps_comment_1#8749, cps_availqty#8739 AS cps_availqty_1#8750, cps_supplycost#8740 AS cps_supplycost_1#8751, cps_comment#8741 AS cps_comment_1#8752]
         :        +- Relation[rid#8731,cpfk_part_partsupp#8732,cfpk_partsupp_part#8733,cpfk_supplier_partsupp#8734,cfpk_partsupp_supplier#8735,cval_partsupp_ps_availqty#8736,cval_partsupp_ps_supplycost#8737,cval_partsupp_ps_comment#8738,cps_availqty#8739,cps_supplycost#8740,cps_comment#8741] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#8675 AS rid_1#8686, cpfk_part_partsupp#8676 AS cpfk_part_partsupp_1#8687, cfpk_partsupp_part#8677 AS cfpk_partsupp_part_1#8688, cpfk_supplier_partsupp#8678 AS cpfk_supplier_partsupp_1#8689, cfpk_partsupp_supplier#8679 AS cfpk_partsupp_supplier_1#8690, cval_partsupp_ps_availqty#8680 AS cval_partsupp_ps_availqty_1#8691, cval_partsupp_ps_supplycost#8681 AS cval_partsupp_ps_supplycost_1#8692, cval_partsupp_ps_comment#8682 AS cval_partsupp_ps_comment_1#8693, cps_availqty#8683 AS cps_availqty_1#8694, cps_supplycost#8684 AS cps_supplycost_1#8695, cps_comment#8685 AS cps_comment_1#8696]
            +- Relation[rid#8675,cpfk_part_partsupp#8676,cfpk_partsupp_part#8677,cpfk_supplier_partsupp#8678,cfpk_partsupp_supplier#8679,cval_partsupp_ps_availqty#8680,cval_partsupp_ps_supplycost#8681,cval_partsupp_ps_comment#8682,cps_availqty#8683,cps_supplycost#8684,cps_comment#8685] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 11385ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/15 02:55:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:55:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8787L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/15 02:55:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8787L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#8789 AS rid_0#8806, cval_part_p_name#8790 AS cval_part_p_name_0#8807, cval_part_p_mfgr#8791 AS cval_part_p_mfgr_0#8808, cval_part_p_type#8792 AS cval_part_p_type_0#8809, cval_part_p_size#8793 AS cval_part_p_size_0#8810, cval_part_p_container#8794 AS cval_part_p_container_0#8811, cval_part_p_retailprice#8795 AS cval_part_p_retailprice_0#8812, cval_part_p_comment#8796 AS cval_part_p_comment_0#8813, cval_part_p_brand#8797 AS cval_part_p_brand_0#8814, cp_name#8798 AS cp_name_0#8815, cp_mfgr#8799 AS cp_mfgr_0#8816, cp_type#8800 AS cp_type_0#8817, cp_size#8801 AS cp_size_0#8818, cp_container#8802 AS cp_container_0#8819, cp_retailprice#8803 AS cp_retailprice_0#8820, cp_comment#8804 AS cp_comment_0#8821, cp_brand#8805 AS cp_brand_0#8822]
         :  :  +- Relation[rid#8789,cval_part_p_name#8790,cval_part_p_mfgr#8791,cval_part_p_type#8792,cval_part_p_size#8793,cval_part_p_container#8794,cval_part_p_retailprice#8795,cval_part_p_comment#8796,cval_part_p_brand#8797,cp_name#8798,cp_mfgr#8799,cp_type#8800,cp_size#8801,cp_container#8802,cp_retailprice#8803,cp_comment#8804,cp_brand#8805] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#8889 AS rid_0#8906, cval_part_p_name#8890 AS cval_part_p_name_0#8907, cval_part_p_mfgr#8891 AS cval_part_p_mfgr_0#8908, cval_part_p_type#8892 AS cval_part_p_type_0#8909, cval_part_p_size#8893 AS cval_part_p_size_0#8910, cval_part_p_container#8894 AS cval_part_p_container_0#8911, cval_part_p_retailprice#8895 AS cval_part_p_retailprice_0#8912, cval_part_p_comment#8896 AS cval_part_p_comment_0#8913, cval_part_p_brand#8897 AS cval_part_p_brand_0#8914, cp_name#8898 AS cp_name_0#8915, cp_mfgr#8899 AS cp_mfgr_0#8916, cp_type#8900 AS cp_type_0#8917, cp_size#8901 AS cp_size_0#8918, cp_container#8902 AS cp_container_0#8919, cp_retailprice#8903 AS cp_retailprice_0#8920, cp_comment#8904 AS cp_comment_0#8921, cp_brand#8905 AS cp_brand_0#8922]
         :     :  +- Relation[rid#8889,cval_part_p_name#8890,cval_part_p_mfgr#8891,cval_part_p_type#8892,cval_part_p_size#8893,cval_part_p_container#8894,cval_part_p_retailprice#8895,cval_part_p_comment#8896,cval_part_p_brand#8897,cp_name#8898,cp_mfgr#8899,cp_type#8900,cp_size#8901,cp_container#8902,cp_retailprice#8903,cp_comment#8904,cp_brand#8905] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#8923 AS rid_1#8956, cpfk_orders_lineitem#8924 AS cpfk_orders_lineitem_1#8957, cpfk_supplier_lineitem#8925 AS cpfk_supplier_lineitem_1#8958, cfpk_lineitem_supplier#8926 AS cfpk_lineitem_supplier_1#8959, cfpk_lineitem_partsupp#8927 AS cfpk_lineitem_partsupp_1#8960, cpfk_part_lineitem#8928 AS cpfk_part_lineitem_1#8961, cfpk_lineitem_part#8929 AS cfpk_lineitem_part_1#8962, cpfk_partsupp_lineitem#8930 AS cpfk_partsupp_lineitem_1#8963, cfpk_lineitem_orders#8931 AS cfpk_lineitem_orders_1#8964, cval_lineitem_l_quantity#8932 AS cval_lineitem_l_quantity_1#8965, cval_lineitem_l_extendedprice#8933 AS cval_lineitem_l_extendedprice_1#8966, cval_lineitem_l_discount#8934 AS cval_lineitem_l_discount_1#8967, cval_lineitem_l_tax#8935 AS cval_lineitem_l_tax_1#8968, cval_lineitem_l_returnflag#8936 AS cval_lineitem_l_returnflag_1#8969, cval_lineitem_l_linestatus#8937 AS cval_lineitem_l_linestatus_1#8970, cval_lineitem_l_commitdate#8938 AS cval_lineitem_l_commitdate_1#8971, cval_lineitem_l_receiptdate#8939 AS cval_lineitem_l_receiptdate_1#8972, cval_lineitem_l_shipinstruct#8940 AS cval_lineitem_l_shipinstruct_1#8973, cval_lineitem_l_shipmode#8941 AS cval_lineitem_l_shipmode_1#8974, cval_lineitem_l_comment#8942 AS cval_lineitem_l_comment_1#8975, cval_lineitem_l_shipdate#8943 AS cval_lineitem_l_shipdate_1#8976, cl_quantity#8944 AS cl_quantity_1#8977, cl_extendedprice#8945 AS cl_extendedprice_1#8978, cl_discount#8946 AS cl_discount_1#8979, ... 9 more fields]
         :        +- Relation[rid#8923,cpfk_orders_lineitem#8924,cpfk_supplier_lineitem#8925,cfpk_lineitem_supplier#8926,cfpk_lineitem_partsupp#8927,cpfk_part_lineitem#8928,cfpk_lineitem_part#8929,cpfk_partsupp_lineitem#8930,cfpk_lineitem_orders#8931,cval_lineitem_l_quantity#8932,cval_lineitem_l_extendedprice#8933,cval_lineitem_l_discount#8934,cval_lineitem_l_tax#8935,cval_lineitem_l_returnflag#8936,cval_lineitem_l_linestatus#8937,cval_lineitem_l_commitdate#8938,cval_lineitem_l_receiptdate#8939,cval_lineitem_l_shipinstruct#8940,cval_lineitem_l_shipmode#8941,cval_lineitem_l_comment#8942,cval_lineitem_l_shipdate#8943,cl_quantity#8944,cl_extendedprice#8945,cl_discount#8946,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8823 AS rid_1#8856, cpfk_orders_lineitem#8824 AS cpfk_orders_lineitem_1#8857, cpfk_supplier_lineitem#8825 AS cpfk_supplier_lineitem_1#8858, cfpk_lineitem_supplier#8826 AS cfpk_lineitem_supplier_1#8859, cfpk_lineitem_partsupp#8827 AS cfpk_lineitem_partsupp_1#8860, cpfk_part_lineitem#8828 AS cpfk_part_lineitem_1#8861, cfpk_lineitem_part#8829 AS cfpk_lineitem_part_1#8862, cpfk_partsupp_lineitem#8830 AS cpfk_partsupp_lineitem_1#8863, cfpk_lineitem_orders#8831 AS cfpk_lineitem_orders_1#8864, cval_lineitem_l_quantity#8832 AS cval_lineitem_l_quantity_1#8865, cval_lineitem_l_extendedprice#8833 AS cval_lineitem_l_extendedprice_1#8866, cval_lineitem_l_discount#8834 AS cval_lineitem_l_discount_1#8867, cval_lineitem_l_tax#8835 AS cval_lineitem_l_tax_1#8868, cval_lineitem_l_returnflag#8836 AS cval_lineitem_l_returnflag_1#8869, cval_lineitem_l_linestatus#8837 AS cval_lineitem_l_linestatus_1#8870, cval_lineitem_l_commitdate#8838 AS cval_lineitem_l_commitdate_1#8871, cval_lineitem_l_receiptdate#8839 AS cval_lineitem_l_receiptdate_1#8872, cval_lineitem_l_shipinstruct#8840 AS cval_lineitem_l_shipinstruct_1#8873, cval_lineitem_l_shipmode#8841 AS cval_lineitem_l_shipmode_1#8874, cval_lineitem_l_comment#8842 AS cval_lineitem_l_comment_1#8875, cval_lineitem_l_shipdate#8843 AS cval_lineitem_l_shipdate_1#8876, cl_quantity#8844 AS cl_quantity_1#8877, cl_extendedprice#8845 AS cl_extendedprice_1#8878, cl_discount#8846 AS cl_discount_1#8879, ... 9 more fields]
            +- Relation[rid#8823,cpfk_orders_lineitem#8824,cpfk_supplier_lineitem#8825,cfpk_lineitem_supplier#8826,cfpk_lineitem_partsupp#8827,cpfk_part_lineitem#8828,cfpk_lineitem_part#8829,cpfk_partsupp_lineitem#8830,cfpk_lineitem_orders#8831,cval_lineitem_l_quantity#8832,cval_lineitem_l_extendedprice#8833,cval_lineitem_l_discount#8834,cval_lineitem_l_tax#8835,cval_lineitem_l_returnflag#8836,cval_lineitem_l_linestatus#8837,cval_lineitem_l_commitdate#8838,cval_lineitem_l_receiptdate#8839,cval_lineitem_l_shipinstruct#8840,cval_lineitem_l_shipmode#8841,cval_lineitem_l_comment#8842,cval_lineitem_l_shipdate#8843,cl_quantity#8844,cl_extendedprice#8845,cl_discount#8846,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 84443ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/15 02:56:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/15 02:56:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9043L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=region
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/15 02:56:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/15 02:56:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9043L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#9045 AS rid_0#9050, cval_region_r_name#9046 AS cval_region_r_name_0#9051, cval_region_r_comment#9047 AS cval_region_r_comment_0#9052, cr_name#9048 AS cr_name_0#9053, cr_comment#9049 AS cr_comment_0#9054]
         :  :  :  :  :  :  :  +- Relation[rid#9045,cval_region_r_name#9046,cval_region_r_comment#9047,cr_name#9048,cr_comment#9049] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyDependentFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#9055 AS rid_0#9060, cval_region_r_name#9056 AS cval_region_r_name_0#9061, cval_region_r_comment#9057 AS cval_region_r_comment_0#9062, cr_name#9058 AS cr_name_0#9063, cr_comment#9059 AS cr_comment_0#9064]
         :  :  :  :  :  :        +- Relation[rid#9055,cval_region_r_name#9056,cval_region_r_comment#9057,cr_name#9058,cr_comment#9059] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :     :- Project [rid#9079 AS rid_0#9084, cval_region_r_name#9080 AS cval_region_r_name_0#9085, cval_region_r_comment#9081 AS cval_region_r_comment_0#9086, cr_name#9082 AS cr_name_0#9087, cr_comment#9083 AS cr_comment_0#9088]
         :  :  :  :  :     :  +- Relation[rid#9079,cval_region_r_name#9080,cval_region_r_comment#9081,cr_name#9082,cr_comment#9083] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :     +- Project [rid#9089 AS rid_1#9096, cpfk_region_nation#9090 AS cpfk_region_nation_1#9097, cfpk_nation_region#9091 AS cfpk_nation_region_1#9098, cval_nation_n_name#9092 AS cval_nation_n_name_1#9099, cval_nation_n_comment#9093 AS cval_nation_n_comment_1#9100, cn_name#9094 AS cn_name_1#9101, cn_comment#9095 AS cn_comment_1#9102]
         :  :  :  :  :        +- Relation[rid#9089,cpfk_region_nation#9090,cfpk_nation_region#9091,cval_nation_n_name#9092,cval_nation_n_comment#9093,cn_name#9094,cn_comment#9095] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#9065 AS rid_1#9072, cpfk_region_nation#9066 AS cpfk_region_nation_1#9073, cfpk_nation_region#9067 AS cfpk_nation_region_1#9074, cval_nation_n_name#9068 AS cval_nation_n_name_1#9075, cval_nation_n_comment#9069 AS cval_nation_n_comment_1#9076, cn_name#9070 AS cn_name_1#9077, cn_comment#9071 AS cn_comment_1#9078]
         :  :  :  :     +- Relation[rid#9065,cpfk_region_nation#9066,cfpk_nation_region#9067,cval_nation_n_name#9068,cval_nation_n_comment#9069,cn_name#9070,cn_comment#9071] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :     :- Project [rid#9129 AS rid_1#9136, cpfk_region_nation#9130 AS cpfk_region_nation_1#9137, cfpk_nation_region#9131 AS cfpk_nation_region_1#9138, cval_nation_n_name#9132 AS cval_nation_n_name_1#9139, cval_nation_n_comment#9133 AS cval_nation_n_comment_1#9140, cn_name#9134 AS cn_name_1#9141, cn_comment#9135 AS cn_comment_1#9142]
         :  :  :     :  +- Relation[rid#9129,cpfk_region_nation#9130,cfpk_nation_region#9131,cval_nation_n_name#9132,cval_nation_n_comment#9133,cn_name#9134,cn_comment#9135] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#9143 AS rid_2#9156, cpfk_nation_supplier#9144 AS cpfk_nation_supplier_2#9157, cfpk_supplier_nation#9145 AS cfpk_supplier_nation_2#9158, cval_supplier_s_name#9146 AS cval_supplier_s_name_2#9159, cval_supplier_s_address#9147 AS cval_supplier_s_address_2#9160, cval_supplier_s_phone#9148 AS cval_supplier_s_phone_2#9161, cval_supplier_s_acctbal#9149 AS cval_supplier_s_acctbal_2#9162, cval_supplier_s_comment#9150 AS cval_supplier_s_comment_2#9163, cs_name#9151 AS cs_name_2#9164, cs_address#9152 AS cs_address_2#9165, cs_phone#9153 AS cs_phone_2#9166, cs_acctbal#9154 AS cs_acctbal_2#9167, cs_comment#9155 AS cs_comment_2#9168]
         :  :  :        +- Relation[rid#9143,cpfk_nation_supplier#9144,cfpk_supplier_nation#9145,cval_supplier_s_name#9146,cval_supplier_s_address#9147,cval_supplier_s_phone#9148,cval_supplier_s_acctbal#9149,cval_supplier_s_comment#9150,cs_name#9151,cs_address#9152,cs_phone#9153,cs_acctbal#9154,cs_comment#9155] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#9103 AS rid_2#9116, cpfk_nation_supplier#9104 AS cpfk_nation_supplier_2#9117, cfpk_supplier_nation#9105 AS cfpk_supplier_nation_2#9118, cval_supplier_s_name#9106 AS cval_supplier_s_name_2#9119, cval_supplier_s_address#9107 AS cval_supplier_s_address_2#9120, cval_supplier_s_phone#9108 AS cval_supplier_s_phone_2#9121, cval_supplier_s_acctbal#9109 AS cval_supplier_s_acctbal_2#9122, cval_supplier_s_comment#9110 AS cval_supplier_s_comment_2#9123, cs_name#9111 AS cs_name_2#9124, cs_address#9112 AS cs_address_2#9125, cs_phone#9113 AS cs_phone_2#9126, cs_acctbal#9114 AS cs_acctbal_2#9127, cs_comment#9115 AS cs_comment_2#9128]
         :  :     +- Relation[rid#9103,cpfk_nation_supplier#9104,cfpk_supplier_nation#9105,cval_supplier_s_name#9106,cval_supplier_s_address#9107,cval_supplier_s_phone#9108,cval_supplier_s_acctbal#9109,cval_supplier_s_comment#9110,cs_name#9111,cs_address#9112,cs_phone#9113,cs_acctbal#9114,cs_comment#9115] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :     :- Project [rid#9315 AS rid_2#9328, cpfk_nation_supplier#9316 AS cpfk_nation_supplier_2#9329, cfpk_supplier_nation#9317 AS cfpk_supplier_nation_2#9330, cval_supplier_s_name#9318 AS cval_supplier_s_name_2#9331, cval_supplier_s_address#9319 AS cval_supplier_s_address_2#9332, cval_supplier_s_phone#9320 AS cval_supplier_s_phone_2#9333, cval_supplier_s_acctbal#9321 AS cval_supplier_s_acctbal_2#9334, cval_supplier_s_comment#9322 AS cval_supplier_s_comment_2#9335, cs_name#9323 AS cs_name_2#9336, cs_address#9324 AS cs_address_2#9337, cs_phone#9325 AS cs_phone_2#9338, cs_acctbal#9326 AS cs_acctbal_2#9339, cs_comment#9327 AS cs_comment_2#9340]
         :     :  +- Relation[rid#9315,cpfk_nation_supplier#9316,cfpk_supplier_nation#9317,cval_supplier_s_name#9318,cval_supplier_s_address#9319,cval_supplier_s_phone#9320,cval_supplier_s_acctbal#9321,cval_supplier_s_comment#9322,cs_name#9323,cs_address#9324,cs_phone#9325,cs_acctbal#9326,cs_comment#9327] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#9341 AS rid_4#9352, cpfk_part_partsupp#9342 AS cpfk_part_partsupp_4#9353, cfpk_partsupp_part#9343 AS cfpk_partsupp_part_4#9354, cpfk_supplier_partsupp#9344 AS cpfk_supplier_partsupp_4#9355, cfpk_partsupp_supplier#9345 AS cfpk_partsupp_supplier_4#9356, cval_partsupp_ps_availqty#9346 AS cval_partsupp_ps_availqty_4#9357, cval_partsupp_ps_supplycost#9347 AS cval_partsupp_ps_supplycost_4#9358, cval_partsupp_ps_comment#9348 AS cval_partsupp_ps_comment_4#9359, cps_availqty#9349 AS cps_availqty_4#9360, cps_supplycost#9350 AS cps_supplycost_4#9361, cps_comment#9351 AS cps_comment_4#9362]
         :        +- Relation[rid#9341,cpfk_part_partsupp#9342,cfpk_partsupp_part#9343,cpfk_supplier_partsupp#9344,cfpk_partsupp_supplier#9345,cval_partsupp_ps_availqty#9346,cval_partsupp_ps_supplycost#9347,cval_partsupp_ps_comment#9348,cps_availqty#9349,cps_supplycost#9350,cps_comment#9351] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'Join UsingJoin(Inner,List(rid_3))
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#9169 AS rid_3#9186, cval_part_p_name#9170 AS cval_part_p_name_3#9187, cval_part_p_mfgr#9171 AS cval_part_p_mfgr_3#9188, cval_part_p_type#9172 AS cval_part_p_type_3#9189, cval_part_p_size#9173 AS cval_part_p_size_3#9190, cval_part_p_container#9174 AS cval_part_p_container_3#9191, cval_part_p_retailprice#9175 AS cval_part_p_retailprice_3#9192, cval_part_p_comment#9176 AS cval_part_p_comment_3#9193, cval_part_p_brand#9177 AS cval_part_p_brand_3#9194, cp_name#9178 AS cp_name_3#9195, cp_mfgr#9179 AS cp_mfgr_3#9196, cp_type#9180 AS cp_type_3#9197, cp_size#9181 AS cp_size_3#9198, cp_container#9182 AS cp_container_3#9199, cp_retailprice#9183 AS cp_retailprice_3#9200, cp_comment#9184 AS cp_comment_3#9201, cp_brand#9185 AS cp_brand_3#9202]
            :  :  :  +- Relation[rid#9169,cval_part_p_name#9170,cval_part_p_mfgr#9171,cval_part_p_type#9172,cval_part_p_size#9173,cval_part_p_container#9174,cval_part_p_retailprice#9175,cval_part_p_comment#9176,cval_part_p_brand#9177,cp_name#9178,cp_mfgr#9179,cp_type#9180,cp_size#9181,cp_container#9182,cp_retailprice#9183,cp_comment#9184,cp_brand#9185] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyDependentFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#9203 AS rid_3#9220, cval_part_p_name#9204 AS cval_part_p_name_3#9221, cval_part_p_mfgr#9205 AS cval_part_p_mfgr_3#9222, cval_part_p_type#9206 AS cval_part_p_type_3#9223, cval_part_p_size#9207 AS cval_part_p_size_3#9224, cval_part_p_container#9208 AS cval_part_p_container_3#9225, cval_part_p_retailprice#9209 AS cval_part_p_retailprice_3#9226, cval_part_p_comment#9210 AS cval_part_p_comment_3#9227, cval_part_p_brand#9211 AS cval_part_p_brand_3#9228, cp_name#9212 AS cp_name_3#9229, cp_mfgr#9213 AS cp_mfgr_3#9230, cp_type#9214 AS cp_type_3#9231, cp_size#9215 AS cp_size_3#9232, cp_container#9216 AS cp_container_3#9233, cp_retailprice#9217 AS cp_retailprice_3#9234, cp_comment#9218 AS cp_comment_3#9235, cp_brand#9219 AS cp_brand_3#9236]
            :  :        +- Relation[rid#9203,cval_part_p_name#9204,cval_part_p_mfgr#9205,cval_part_p_type#9206,cval_part_p_size#9207,cval_part_p_container#9208,cval_part_p_retailprice#9209,cval_part_p_comment#9210,cval_part_p_brand#9211,cp_name#9212,cp_mfgr#9213,cp_type#9214,cp_size#9215,cp_container#9216,cp_retailprice#9217,cp_comment#9218,cp_brand#9219] JDBCRelation(tpart) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :     :- Project [rid#9259 AS rid_3#9276, cval_part_p_name#9260 AS cval_part_p_name_3#9277, cval_part_p_mfgr#9261 AS cval_part_p_mfgr_3#9278, cval_part_p_type#9262 AS cval_part_p_type_3#9279, cval_part_p_size#9263 AS cval_part_p_size_3#9280, cval_part_p_container#9264 AS cval_part_p_container_3#9281, cval_part_p_retailprice#9265 AS cval_part_p_retailprice_3#9282, cval_part_p_comment#9266 AS cval_part_p_comment_3#9283, cval_part_p_brand#9267 AS cval_part_p_brand_3#9284, cp_name#9268 AS cp_name_3#9285, cp_mfgr#9269 AS cp_mfgr_3#9286, cp_type#9270 AS cp_type_3#9287, cp_size#9271 AS cp_size_3#9288, cp_container#9272 AS cp_container_3#9289, cp_retailprice#9273 AS cp_retailprice_3#9290, cp_comment#9274 AS cp_comment_3#9291, cp_brand#9275 AS cp_brand_3#9292]
            :     :  +- Relation[rid#9259,cval_part_p_name#9260,cval_part_p_mfgr#9261,cval_part_p_type#9262,cval_part_p_size#9263,cval_part_p_container#9264,cval_part_p_retailprice#9265,cval_part_p_comment#9266,cval_part_p_brand#9267,cp_name#9268,cp_mfgr#9269,cp_type#9270,cp_size#9271,cp_container#9272,cp_retailprice#9273,cp_comment#9274,cp_brand#9275] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#9293 AS rid_4#9304, cpfk_part_partsupp#9294 AS cpfk_part_partsupp_4#9305, cfpk_partsupp_part#9295 AS cfpk_partsupp_part_4#9306, cpfk_supplier_partsupp#9296 AS cpfk_supplier_partsupp_4#9307, cfpk_partsupp_supplier#9297 AS cfpk_partsupp_supplier_4#9308, cval_partsupp_ps_availqty#9298 AS cval_partsupp_ps_availqty_4#9309, cval_partsupp_ps_supplycost#9299 AS cval_partsupp_ps_supplycost_4#9310, cval_partsupp_ps_comment#9300 AS cval_partsupp_ps_comment_4#9311, cps_availqty#9301 AS cps_availqty_4#9312, cps_supplycost#9302 AS cps_supplycost_4#9313, cps_comment#9303 AS cps_comment_4#9314]
            :        +- Relation[rid#9293,cpfk_part_partsupp#9294,cfpk_partsupp_part#9295,cpfk_supplier_partsupp#9296,cfpk_partsupp_supplier#9297,cval_partsupp_ps_availqty#9298,cval_partsupp_ps_supplycost#9299,cval_partsupp_ps_comment#9300,cps_availqty#9301,cps_supplycost#9302,cps_comment#9303] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#9237 AS rid_4#9248, cpfk_part_partsupp#9238 AS cpfk_part_partsupp_4#9249, cfpk_partsupp_part#9239 AS cfpk_partsupp_part_4#9250, cpfk_supplier_partsupp#9240 AS cpfk_supplier_partsupp_4#9251, cfpk_partsupp_supplier#9241 AS cfpk_partsupp_supplier_4#9252, cval_partsupp_ps_availqty#9242 AS cval_partsupp_ps_availqty_4#9253, cval_partsupp_ps_supplycost#9243 AS cval_partsupp_ps_supplycost_4#9254, cval_partsupp_ps_comment#9244 AS cval_partsupp_ps_comment_4#9255, cps_availqty#9245 AS cps_availqty_4#9256, cps_supplycost#9246 AS cps_supplycost_4#9257, cps_comment#9247 AS cps_comment_4#9258]
               +- Relation[rid#9237,cpfk_part_partsupp#9238,cfpk_partsupp_part#9239,cpfk_supplier_partsupp#9240,cfpk_partsupp_supplier#9241,cval_partsupp_ps_availqty#9242,cval_partsupp_ps_supplycost#9243,cval_partsupp_ps_comment#9244,cps_availqty#9245,cps_supplycost#9246,cps_comment#9247] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 20677ms
query=q1, count=6001215, duration=2620
query=q10, count=1478870, duration=67594
query=q11, count=31680, duration=10339
query=q12, count=857401, duration=20783
query=q13, count=1500000, duration=13446
query=q14, count=6001215, duration=84443
query=q15, count=6001215, duration=74769
query=q16, count=15780, duration=11385
query=q17, count=6088, duration=74459
query=q18, count=6001215, duration=170792
query=q19, count=205, duration=101078
query=q2, count=3162, duration=20677
query=q20, count=632, duration=13648
query=q21a, count=597422, duration=235427
query=q22, count=1500000, duration=12976
query=q3, count=1214743, duration=117053
query=q4, count=6001215, duration=55033
query=q5, count=1206514, duration=170295
query=q6, count=6001215, duration=2749
query=q7, count=9735, duration=101389
query=q8, count=8716, duration=99041
query=q9a, count=6001215, duration=242639
query=q9b, count=6001215, duration=164997
