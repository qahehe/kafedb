20/04/25 22:30:34 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10835ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 25 22:30:37 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 25 22:30:38 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 25 22:30:38 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 25 22:30:38 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 25 22:30:38 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 25 22:30:42 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 25 22:30:46 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 25 22:30:46 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/25 22:30:48 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:30:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2078L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:30:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:30:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:30:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:30:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:30:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:30:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:30:48 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/25 22:30:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2078L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#2230 AS rid_1#2275, cpfk_orders_lineitem#2231 AS cpfk_orders_lineitem_1#2276, cpfk_supplier_lineitem#2232 AS cpfk_supplier_lineitem_1#2277, cfpk_lineitem_supplier#2233 AS cfpk_lineitem_supplier_1#2278, cfpk_lineitem_partsupp#2234 AS cfpk_lineitem_partsupp_1#2279, cpfk_part_lineitem#2235 AS cpfk_part_lineitem_1#2280, cfpk_lineitem_part#2236 AS cfpk_lineitem_part_1#2281, cpfk_partsupp_lineitem#2237 AS cpfk_partsupp_lineitem_1#2282, cfpk_lineitem_orders#2238 AS cfpk_lineitem_orders_1#2283, cval_lineitem_l_quantity#2239 AS cval_lineitem_l_quantity_1#2284, cval_lineitem_l_extendedprice#2240 AS cval_lineitem_l_extendedprice_1#2285, cval_lineitem_l_discount#2241 AS cval_lineitem_l_discount_1#2286, cval_lineitem_l_tax#2242 AS cval_lineitem_l_tax_1#2287, cval_lineitem_l_returnflag#2243 AS cval_lineitem_l_returnflag_1#2288, cval_lineitem_l_linestatus#2244 AS cval_lineitem_l_linestatus_1#2289, cval_lineitem_l_commitdate#2245 AS cval_lineitem_l_commitdate_1#2290, cval_lineitem_l_receiptdate#2246 AS cval_lineitem_l_receiptdate_1#2291, cval_lineitem_l_shipinstruct#2247 AS cval_lineitem_l_shipinstruct_1#2292, cval_lineitem_l_shipmode#2248 AS cval_lineitem_l_shipmode_1#2293, cval_lineitem_l_comment#2249 AS cval_lineitem_l_comment_1#2294, cval_lineitem_l_shipdate#2250 AS cval_lineitem_l_shipdate_1#2295, cdepval_lineitem_l_quantity#2251 AS cdepval_lineitem_l_quantity_1#2296, cdepval_lineitem_l_extendedprice#2252 AS cdepval_lineitem_l_extendedprice_1#2297, cdepval_lineitem_l_discount#2253 AS cdepval_lineitem_l_discount_1#2298, ... 21 more fields]
         :  +- Relation[rid#2230,cpfk_orders_lineitem#2231,cpfk_supplier_lineitem#2232,cfpk_lineitem_supplier#2233,cfpk_lineitem_partsupp#2234,cpfk_part_lineitem#2235,cfpk_lineitem_part#2236,cpfk_partsupp_lineitem#2237,cfpk_lineitem_orders#2238,cval_lineitem_l_quantity#2239,cval_lineitem_l_extendedprice#2240,cval_lineitem_l_discount#2241,cval_lineitem_l_tax#2242,cval_lineitem_l_returnflag#2243,cval_lineitem_l_linestatus#2244,cval_lineitem_l_commitdate#2245,cval_lineitem_l_receiptdate#2246,cval_lineitem_l_shipinstruct#2247,cval_lineitem_l_shipmode#2248,cval_lineitem_l_comment#2249,cval_lineitem_l_shipdate#2250,cdepval_lineitem_l_quantity#2251,cdepval_lineitem_l_extendedprice#2252,cdepval_lineitem_l_discount#2253,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
               +- Project [rid#2080 AS rid_0#2105, cval_part_p_name#2081 AS cval_part_p_name_0#2106, cval_part_p_mfgr#2082 AS cval_part_p_mfgr_0#2107, cval_part_p_type#2083 AS cval_part_p_type_0#2108, cval_part_p_size#2084 AS cval_part_p_size_0#2109, cval_part_p_container#2085 AS cval_part_p_container_0#2110, cval_part_p_retailprice#2086 AS cval_part_p_retailprice_0#2111, cval_part_p_comment#2087 AS cval_part_p_comment_0#2112, cval_part_p_brand#2088 AS cval_part_p_brand_0#2113, cdepval_part_p_name#2089 AS cdepval_part_p_name_0#2114, cdepval_part_p_mfgr#2090 AS cdepval_part_p_mfgr_0#2115, cdepval_part_p_type#2091 AS cdepval_part_p_type_0#2116, cdepval_part_p_size#2092 AS cdepval_part_p_size_0#2117, cdepval_part_p_container#2093 AS cdepval_part_p_container_0#2118, cdepval_part_p_retailprice#2094 AS cdepval_part_p_retailprice_0#2119, cdepval_part_p_comment#2095 AS cdepval_part_p_comment_0#2120, cdepval_part_p_brand#2096 AS cdepval_part_p_brand_0#2121, cp_name#2097 AS cp_name_0#2122, cp_mfgr#2098 AS cp_mfgr_0#2123, cp_type#2099 AS cp_type_0#2124, cp_size#2100 AS cp_size_0#2125, cp_container#2101 AS cp_container_0#2126, cp_retailprice#2102 AS cp_retailprice_0#2127, cp_comment#2103 AS cp_comment_0#2128, cp_brand#2104 AS cp_brand_0#2129]
                  +- Relation[rid#2080,cval_part_p_name#2081,cval_part_p_mfgr#2082,cval_part_p_type#2083,cval_part_p_size#2084,cval_part_p_container#2085,cval_part_p_retailprice#2086,cval_part_p_comment#2087,cval_part_p_brand#2088,cdepval_part_p_name#2089,cdepval_part_p_mfgr#2090,cdepval_part_p_type#2091,cdepval_part_p_size#2092,cdepval_part_p_container#2093,cdepval_part_p_retailprice#2094,cdepval_part_p_comment#2095,cdepval_part_p_brand#2096,cp_name#2097,cp_mfgr#2098,cp_type#2099,cp_size#2100,cp_container#2101,cp_retailprice#2102,cp_comment#2103,cp_brand#2104] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 26472ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/25 22:31:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:31:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2398L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:31:14 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:31:14 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:31:14 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:31:14 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:31:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2398L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#2532 AS rid_2#2577, cpfk_orders_lineitem#2533 AS cpfk_orders_lineitem_2#2578, cpfk_supplier_lineitem#2534 AS cpfk_supplier_lineitem_2#2579, cfpk_lineitem_supplier#2535 AS cfpk_lineitem_supplier_2#2580, cfpk_lineitem_partsupp#2536 AS cfpk_lineitem_partsupp_2#2581, cpfk_part_lineitem#2537 AS cpfk_part_lineitem_2#2582, cfpk_lineitem_part#2538 AS cfpk_lineitem_part_2#2583, cpfk_partsupp_lineitem#2539 AS cpfk_partsupp_lineitem_2#2584, cfpk_lineitem_orders#2540 AS cfpk_lineitem_orders_2#2585, cval_lineitem_l_quantity#2541 AS cval_lineitem_l_quantity_2#2586, cval_lineitem_l_extendedprice#2542 AS cval_lineitem_l_extendedprice_2#2587, cval_lineitem_l_discount#2543 AS cval_lineitem_l_discount_2#2588, cval_lineitem_l_tax#2544 AS cval_lineitem_l_tax_2#2589, cval_lineitem_l_returnflag#2545 AS cval_lineitem_l_returnflag_2#2590, cval_lineitem_l_linestatus#2546 AS cval_lineitem_l_linestatus_2#2591, cval_lineitem_l_commitdate#2547 AS cval_lineitem_l_commitdate_2#2592, cval_lineitem_l_receiptdate#2548 AS cval_lineitem_l_receiptdate_2#2593, cval_lineitem_l_shipinstruct#2549 AS cval_lineitem_l_shipinstruct_2#2594, cval_lineitem_l_shipmode#2550 AS cval_lineitem_l_shipmode_2#2595, cval_lineitem_l_comment#2551 AS cval_lineitem_l_comment_2#2596, cval_lineitem_l_shipdate#2552 AS cval_lineitem_l_shipdate_2#2597, cdepval_lineitem_l_quantity#2553 AS cdepval_lineitem_l_quantity_2#2598, cdepval_lineitem_l_extendedprice#2554 AS cdepval_lineitem_l_extendedprice_2#2599, cdepval_lineitem_l_discount#2555 AS cdepval_lineitem_l_discount_2#2600, ... 21 more fields]
         :  +- Relation[rid#2532,cpfk_orders_lineitem#2533,cpfk_supplier_lineitem#2534,cfpk_lineitem_supplier#2535,cfpk_lineitem_partsupp#2536,cpfk_part_lineitem#2537,cfpk_lineitem_part#2538,cpfk_partsupp_lineitem#2539,cfpk_lineitem_orders#2540,cval_lineitem_l_quantity#2541,cval_lineitem_l_extendedprice#2542,cval_lineitem_l_discount#2543,cval_lineitem_l_tax#2544,cval_lineitem_l_returnflag#2545,cval_lineitem_l_linestatus#2546,cval_lineitem_l_commitdate#2547,cval_lineitem_l_receiptdate#2548,cval_lineitem_l_shipinstruct#2549,cval_lineitem_l_shipmode#2550,cval_lineitem_l_comment#2551,cval_lineitem_l_shipdate#2552,cdepval_lineitem_l_quantity#2553,cdepval_lineitem_l_extendedprice#2554,cdepval_lineitem_l_discount#2555,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#2484 AS rid_1#2508, cpfk_customer_orders#2485 AS cpfk_customer_orders_1#2509, cfpk_orders_customer#2486 AS cfpk_orders_customer_1#2510, cval_orders_o_orderstatus#2487 AS cval_orders_o_orderstatus_1#2511, cval_orders_o_totalprice#2488 AS cval_orders_o_totalprice_1#2512, cval_orders_o_orderpriority#2489 AS cval_orders_o_orderpriority_1#2513, cval_orders_o_clerk#2490 AS cval_orders_o_clerk_1#2514, cval_orders_o_shippriority#2491 AS cval_orders_o_shippriority_1#2515, cval_orders_o_comment#2492 AS cval_orders_o_comment_1#2516, cval_orders_o_orderdate#2493 AS cval_orders_o_orderdate_1#2517, cdepval_orders_o_orderstatus#2494 AS cdepval_orders_o_orderstatus_1#2518, cdepval_orders_o_totalprice#2495 AS cdepval_orders_o_totalprice_1#2519, cdepval_orders_o_orderpriority#2496 AS cdepval_orders_o_orderpriority_1#2520, cdepval_orders_o_clerk#2497 AS cdepval_orders_o_clerk_1#2521, cdepval_orders_o_shippriority#2498 AS cdepval_orders_o_shippriority_1#2522, cdepval_orders_o_comment#2499 AS cdepval_orders_o_comment_1#2523, cdepval_orders_o_orderdate#2500 AS cdepval_orders_o_orderdate_1#2524, co_orderstatus#2501 AS co_orderstatus_1#2525, co_totalprice#2502 AS co_totalprice_1#2526, co_orderpriority#2503 AS co_orderpriority_1#2527, co_clerk#2504 AS co_clerk_1#2528, co_shippriority#2505 AS co_shippriority_1#2529, co_comment#2506 AS co_comment_1#2530, co_orderdate#2507 AS co_orderdate_1#2531]
            :  +- Relation[rid#2484,cpfk_customer_orders#2485,cfpk_orders_customer#2486,cval_orders_o_orderstatus#2487,cval_orders_o_totalprice#2488,cval_orders_o_orderpriority#2489,cval_orders_o_clerk#2490,cval_orders_o_shippriority#2491,cval_orders_o_comment#2492,cval_orders_o_orderdate#2493,cdepval_orders_o_orderstatus#2494,cdepval_orders_o_totalprice#2495,cdepval_orders_o_orderpriority#2496,cdepval_orders_o_clerk#2497,cdepval_orders_o_shippriority#2498,cdepval_orders_o_comment#2499,cdepval_orders_o_orderdate#2500,co_orderstatus#2501,co_totalprice#2502,co_orderpriority#2503,co_clerk#2504,co_shippriority#2505,co_comment#2506,co_orderdate#2507] JDBCRelation(torders) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
               +- Project [rid#2400 AS rid_0#2421, cpfk_nation_customer#2401 AS cpfk_nation_customer_0#2422, cfpk_customer_nation#2402 AS cfpk_customer_nation_0#2423, cval_customer_c_name#2403 AS cval_customer_c_name_0#2424, cval_customer_c_address#2404 AS cval_customer_c_address_0#2425, cval_customer_c_phone#2405 AS cval_customer_c_phone_0#2426, cval_customer_c_acctbal#2406 AS cval_customer_c_acctbal_0#2427, cval_customer_c_comment#2407 AS cval_customer_c_comment_0#2428, cval_customer_c_mktsegment#2408 AS cval_customer_c_mktsegment_0#2429, cdepval_customer_c_name#2409 AS cdepval_customer_c_name_0#2430, cdepval_customer_c_address#2410 AS cdepval_customer_c_address_0#2431, cdepval_customer_c_phone#2411 AS cdepval_customer_c_phone_0#2432, cdepval_customer_c_acctbal#2412 AS cdepval_customer_c_acctbal_0#2433, cdepval_customer_c_comment#2413 AS cdepval_customer_c_comment_0#2434, cdepval_customer_c_mktsegment#2414 AS cdepval_customer_c_mktsegment_0#2435, cc_name#2415 AS cc_name_0#2436, cc_address#2416 AS cc_address_0#2437, cc_phone#2417 AS cc_phone_0#2438, cc_acctbal#2418 AS cc_acctbal_0#2439, cc_comment#2419 AS cc_comment_0#2440, cc_mktsegment#2420 AS cc_mktsegment_0#2441]
                  +- Relation[rid#2400,cpfk_nation_customer#2401,cfpk_customer_nation#2402,cval_customer_c_name#2403,cval_customer_c_address#2404,cval_customer_c_phone#2405,cval_customer_c_acctbal#2406,cval_customer_c_comment#2407,cval_customer_c_mktsegment#2408,cdepval_customer_c_name#2409,cdepval_customer_c_address#2410,cdepval_customer_c_phone#2411,cdepval_customer_c_acctbal#2412,cdepval_customer_c_comment#2413,cdepval_customer_c_mktsegment#2414,cc_name#2415,cc_address#2416,cc_phone#2417,cc_acctbal#2418,cc_comment#2419,cc_mktsegment#2420] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 38703ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 22:31:53 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:31:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2721L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:31:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:31:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:31:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:31:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:31:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:31:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:31:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:31:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:31:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:31:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:31:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:31:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2721L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#2855 AS rid_4#2900, cpfk_orders_lineitem#2856 AS cpfk_orders_lineitem_4#2901, cpfk_supplier_lineitem#2857 AS cpfk_supplier_lineitem_4#2902, cfpk_lineitem_supplier#2858 AS cfpk_lineitem_supplier_4#2903, cfpk_lineitem_partsupp#2859 AS cfpk_lineitem_partsupp_4#2904, cpfk_part_lineitem#2860 AS cpfk_part_lineitem_4#2905, cfpk_lineitem_part#2861 AS cfpk_lineitem_part_4#2906, cpfk_partsupp_lineitem#2862 AS cpfk_partsupp_lineitem_4#2907, cfpk_lineitem_orders#2863 AS cfpk_lineitem_orders_4#2908, cval_lineitem_l_quantity#2864 AS cval_lineitem_l_quantity_4#2909, cval_lineitem_l_extendedprice#2865 AS cval_lineitem_l_extendedprice_4#2910, cval_lineitem_l_discount#2866 AS cval_lineitem_l_discount_4#2911, cval_lineitem_l_tax#2867 AS cval_lineitem_l_tax_4#2912, cval_lineitem_l_returnflag#2868 AS cval_lineitem_l_returnflag_4#2913, cval_lineitem_l_linestatus#2869 AS cval_lineitem_l_linestatus_4#2914, cval_lineitem_l_commitdate#2870 AS cval_lineitem_l_commitdate_4#2915, cval_lineitem_l_receiptdate#2871 AS cval_lineitem_l_receiptdate_4#2916, cval_lineitem_l_shipinstruct#2872 AS cval_lineitem_l_shipinstruct_4#2917, cval_lineitem_l_shipmode#2873 AS cval_lineitem_l_shipmode_4#2918, cval_lineitem_l_comment#2874 AS cval_lineitem_l_comment_4#2919, cval_lineitem_l_shipdate#2875 AS cval_lineitem_l_shipdate_4#2920, cdepval_lineitem_l_quantity#2876 AS cdepval_lineitem_l_quantity_4#2921, cdepval_lineitem_l_extendedprice#2877 AS cdepval_lineitem_l_extendedprice_4#2922, cdepval_lineitem_l_discount#2878 AS cdepval_lineitem_l_discount_4#2923, ... 21 more fields]
         :  :  +- Relation[rid#2855,cpfk_orders_lineitem#2856,cpfk_supplier_lineitem#2857,cfpk_lineitem_supplier#2858,cfpk_lineitem_partsupp#2859,cpfk_part_lineitem#2860,cfpk_lineitem_part#2861,cpfk_partsupp_lineitem#2862,cfpk_lineitem_orders#2863,cval_lineitem_l_quantity#2864,cval_lineitem_l_extendedprice#2865,cval_lineitem_l_discount#2866,cval_lineitem_l_tax#2867,cval_lineitem_l_returnflag#2868,cval_lineitem_l_linestatus#2869,cval_lineitem_l_commitdate#2870,cval_lineitem_l_receiptdate#2871,cval_lineitem_l_shipinstruct#2872,cval_lineitem_l_shipmode#2873,cval_lineitem_l_comment#2874,cval_lineitem_l_shipdate#2875,cdepval_lineitem_l_quantity#2876,cdepval_lineitem_l_extendedprice#2877,cdepval_lineitem_l_discount#2878,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#2777 AS rid_2#2791, cpfk_part_partsupp#2778 AS cpfk_part_partsupp_2#2792, cfpk_partsupp_part#2779 AS cfpk_partsupp_part_2#2793, cpfk_supplier_partsupp#2780 AS cpfk_supplier_partsupp_2#2794, cfpk_partsupp_supplier#2781 AS cfpk_partsupp_supplier_2#2795, cval_partsupp_ps_availqty#2782 AS cval_partsupp_ps_availqty_2#2796, cval_partsupp_ps_supplycost#2783 AS cval_partsupp_ps_supplycost_2#2797, cval_partsupp_ps_comment#2784 AS cval_partsupp_ps_comment_2#2798, cdepval_partsupp_ps_availqty#2785 AS cdepval_partsupp_ps_availqty_2#2799, cdepval_partsupp_ps_supplycost#2786 AS cdepval_partsupp_ps_supplycost_2#2800, cdepval_partsupp_ps_comment#2787 AS cdepval_partsupp_ps_comment_2#2801, cps_availqty#2788 AS cps_availqty_2#2802, cps_supplycost#2789 AS cps_supplycost_2#2803, cps_comment#2790 AS cps_comment_2#2804]
         :     :  :  +- Relation[rid#2777,cpfk_part_partsupp#2778,cfpk_partsupp_part#2779,cpfk_supplier_partsupp#2780,cfpk_partsupp_supplier#2781,cval_partsupp_ps_availqty#2782,cval_partsupp_ps_supplycost#2783,cval_partsupp_ps_comment#2784,cdepval_partsupp_ps_availqty#2785,cdepval_partsupp_ps_supplycost#2786,cdepval_partsupp_ps_comment#2787,cps_availqty#2788,cps_supplycost#2789,cps_comment#2790] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#2741 AS rid_1#2759, cpfk_nation_supplier#2742 AS cpfk_nation_supplier_1#2760, cfpk_supplier_nation#2743 AS cfpk_supplier_nation_1#2761, cval_supplier_s_name#2744 AS cval_supplier_s_name_1#2762, cval_supplier_s_address#2745 AS cval_supplier_s_address_1#2763, cval_supplier_s_phone#2746 AS cval_supplier_s_phone_1#2764, cval_supplier_s_acctbal#2747 AS cval_supplier_s_acctbal_1#2765, cval_supplier_s_comment#2748 AS cval_supplier_s_comment_1#2766, cdepval_supplier_s_name#2749 AS cdepval_supplier_s_name_1#2767, cdepval_supplier_s_address#2750 AS cdepval_supplier_s_address_1#2768, cdepval_supplier_s_phone#2751 AS cdepval_supplier_s_phone_1#2769, cdepval_supplier_s_acctbal#2752 AS cdepval_supplier_s_acctbal_1#2770, cdepval_supplier_s_comment#2753 AS cdepval_supplier_s_comment_1#2771, cs_name#2754 AS cs_name_1#2772, cs_address#2755 AS cs_address_1#2773, cs_phone#2756 AS cs_phone_1#2774, cs_acctbal#2757 AS cs_acctbal_1#2775, cs_comment#2758 AS cs_comment_1#2776]
         :     :     :  +- Relation[rid#2741,cpfk_nation_supplier#2742,cfpk_supplier_nation#2743,cval_supplier_s_name#2744,cval_supplier_s_address#2745,cval_supplier_s_phone#2746,cval_supplier_s_acctbal#2747,cval_supplier_s_comment#2748,cdepval_supplier_s_name#2749,cdepval_supplier_s_address#2750,cdepval_supplier_s_phone#2751,cdepval_supplier_s_acctbal#2752,cdepval_supplier_s_comment#2753,cs_name#2754,cs_address#2755,cs_phone#2756,cs_acctbal#2757,cs_comment#2758] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#2723 AS rid_0#2732, cpfk_region_nation#2724 AS cpfk_region_nation_0#2733, cfpk_nation_region#2725 AS cfpk_nation_region_0#2734, cval_nation_n_name#2726 AS cval_nation_n_name_0#2735, cval_nation_n_comment#2727 AS cval_nation_n_comment_0#2736, cdepval_nation_n_name#2728 AS cdepval_nation_n_name_0#2737, cdepval_nation_n_comment#2729 AS cdepval_nation_n_comment_0#2738, cn_name#2730 AS cn_name_0#2739, cn_comment#2731 AS cn_comment_0#2740]
         :     :        +- Relation[rid#2723,cpfk_region_nation#2724,cfpk_nation_region#2725,cval_nation_n_name#2726,cval_nation_n_comment#2727,cdepval_nation_n_name#2728,cdepval_nation_n_comment#2729,cn_name#2730,cn_comment#2731] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#2805 AS rid_3#2830, cval_part_p_name#2806 AS cval_part_p_name_3#2831, cval_part_p_mfgr#2807 AS cval_part_p_mfgr_3#2832, cval_part_p_type#2808 AS cval_part_p_type_3#2833, cval_part_p_size#2809 AS cval_part_p_size_3#2834, cval_part_p_container#2810 AS cval_part_p_container_3#2835, cval_part_p_retailprice#2811 AS cval_part_p_retailprice_3#2836, cval_part_p_comment#2812 AS cval_part_p_comment_3#2837, cval_part_p_brand#2813 AS cval_part_p_brand_3#2838, cdepval_part_p_name#2814 AS cdepval_part_p_name_3#2839, cdepval_part_p_mfgr#2815 AS cdepval_part_p_mfgr_3#2840, cdepval_part_p_type#2816 AS cdepval_part_p_type_3#2841, cdepval_part_p_size#2817 AS cdepval_part_p_size_3#2842, cdepval_part_p_container#2818 AS cdepval_part_p_container_3#2843, cdepval_part_p_retailprice#2819 AS cdepval_part_p_retailprice_3#2844, cdepval_part_p_comment#2820 AS cdepval_part_p_comment_3#2845, cdepval_part_p_brand#2821 AS cdepval_part_p_brand_3#2846, cp_name#2822 AS cp_name_3#2847, cp_mfgr#2823 AS cp_mfgr_3#2848, cp_type#2824 AS cp_type_3#2849, cp_size#2825 AS cp_size_3#2850, cp_container#2826 AS cp_container_3#2851, cp_retailprice#2827 AS cp_retailprice_3#2852, cp_comment#2828 AS cp_comment_3#2853, cp_brand#2829 AS cp_brand_3#2854]
         :        +- Relation[rid#2805,cval_part_p_name#2806,cval_part_p_mfgr#2807,cval_part_p_type#2808,cval_part_p_size#2809,cval_part_p_container#2810,cval_part_p_retailprice#2811,cval_part_p_comment#2812,cval_part_p_brand#2813,cdepval_part_p_name#2814,cdepval_part_p_mfgr#2815,cdepval_part_p_type#2816,cdepval_part_p_size#2817,cdepval_part_p_container#2818,cdepval_part_p_retailprice#2819,cdepval_part_p_comment#2820,cdepval_part_p_brand#2821,cp_name#2822,cp_mfgr#2823,cp_type#2824,cp_size#2825,cp_container#2826,cp_retailprice#2827,cp_comment#2828,cp_brand#2829] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#2945 AS rid_5#2969, cpfk_customer_orders#2946 AS cpfk_customer_orders_5#2970, cfpk_orders_customer#2947 AS cfpk_orders_customer_5#2971, cval_orders_o_orderstatus#2948 AS cval_orders_o_orderstatus_5#2972, cval_orders_o_totalprice#2949 AS cval_orders_o_totalprice_5#2973, cval_orders_o_orderpriority#2950 AS cval_orders_o_orderpriority_5#2974, cval_orders_o_clerk#2951 AS cval_orders_o_clerk_5#2975, cval_orders_o_shippriority#2952 AS cval_orders_o_shippriority_5#2976, cval_orders_o_comment#2953 AS cval_orders_o_comment_5#2977, cval_orders_o_orderdate#2954 AS cval_orders_o_orderdate_5#2978, cdepval_orders_o_orderstatus#2955 AS cdepval_orders_o_orderstatus_5#2979, cdepval_orders_o_totalprice#2956 AS cdepval_orders_o_totalprice_5#2980, cdepval_orders_o_orderpriority#2957 AS cdepval_orders_o_orderpriority_5#2981, cdepval_orders_o_clerk#2958 AS cdepval_orders_o_clerk_5#2982, cdepval_orders_o_shippriority#2959 AS cdepval_orders_o_shippriority_5#2983, cdepval_orders_o_comment#2960 AS cdepval_orders_o_comment_5#2984, cdepval_orders_o_orderdate#2961 AS cdepval_orders_o_orderdate_5#2985, co_orderstatus#2962 AS co_orderstatus_5#2986, co_totalprice#2963 AS co_totalprice_5#2987, co_orderpriority#2964 AS co_orderpriority_5#2988, co_clerk#2965 AS co_clerk_5#2989, co_shippriority#2966 AS co_shippriority_5#2990, co_comment#2967 AS co_comment_5#2991, co_orderdate#2968 AS co_orderdate_5#2992]
            +- Relation[rid#2945,cpfk_customer_orders#2946,cfpk_orders_customer#2947,cval_orders_o_orderstatus#2948,cval_orders_o_totalprice#2949,cval_orders_o_orderpriority#2950,cval_orders_o_clerk#2951,cval_orders_o_shippriority#2952,cval_orders_o_comment#2953,cval_orders_o_orderdate#2954,cdepval_orders_o_orderstatus#2955,cdepval_orders_o_totalprice#2956,cdepval_orders_o_orderpriority#2957,cdepval_orders_o_clerk#2958,cdepval_orders_o_shippriority#2959,cdepval_orders_o_comment#2960,cdepval_orders_o_orderdate#2961,co_orderstatus#2962,co_totalprice#2963,co_orderpriority#2964,co_clerk#2965,co_shippriority#2966,co_comment#2967,co_orderdate#2968] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 38227ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/25 22:32:31 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:32:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3133L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 22:32:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3133L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#3135 AS rid_0#3159, cpfk_customer_orders#3136 AS cpfk_customer_orders_0#3160, cfpk_orders_customer#3137 AS cfpk_orders_customer_0#3161, cval_orders_o_orderstatus#3138 AS cval_orders_o_orderstatus_0#3162, cval_orders_o_totalprice#3139 AS cval_orders_o_totalprice_0#3163, cval_orders_o_orderpriority#3140 AS cval_orders_o_orderpriority_0#3164, cval_orders_o_clerk#3141 AS cval_orders_o_clerk_0#3165, cval_orders_o_shippriority#3142 AS cval_orders_o_shippriority_0#3166, cval_orders_o_comment#3143 AS cval_orders_o_comment_0#3167, cval_orders_o_orderdate#3144 AS cval_orders_o_orderdate_0#3168, cdepval_orders_o_orderstatus#3145 AS cdepval_orders_o_orderstatus_0#3169, cdepval_orders_o_totalprice#3146 AS cdepval_orders_o_totalprice_0#3170, cdepval_orders_o_orderpriority#3147 AS cdepval_orders_o_orderpriority_0#3171, cdepval_orders_o_clerk#3148 AS cdepval_orders_o_clerk_0#3172, cdepval_orders_o_shippriority#3149 AS cdepval_orders_o_shippriority_0#3173, cdepval_orders_o_comment#3150 AS cdepval_orders_o_comment_0#3174, cdepval_orders_o_orderdate#3151 AS cdepval_orders_o_orderdate_0#3175, co_orderstatus#3152 AS co_orderstatus_0#3176, co_totalprice#3153 AS co_totalprice_0#3177, co_orderpriority#3154 AS co_orderpriority_0#3178, co_clerk#3155 AS co_clerk_0#3179, co_shippriority#3156 AS co_shippriority_0#3180, co_comment#3157 AS co_comment_0#3181, co_orderdate#3158 AS co_orderdate_0#3182]
         :  +- Relation[rid#3135,cpfk_customer_orders#3136,cfpk_orders_customer#3137,cval_orders_o_orderstatus#3138,cval_orders_o_totalprice#3139,cval_orders_o_orderpriority#3140,cval_orders_o_clerk#3141,cval_orders_o_shippriority#3142,cval_orders_o_comment#3143,cval_orders_o_orderdate#3144,cdepval_orders_o_orderstatus#3145,cdepval_orders_o_totalprice#3146,cdepval_orders_o_orderpriority#3147,cdepval_orders_o_clerk#3148,cdepval_orders_o_shippriority#3149,cdepval_orders_o_comment#3150,cdepval_orders_o_orderdate#3151,co_orderstatus#3152,co_totalprice#3153,co_orderpriority#3154,co_clerk#3155,co_shippriority#3156,co_comment#3157,co_orderdate#3158] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#3183 AS rid_1#3204, cpfk_nation_customer#3184 AS cpfk_nation_customer_1#3205, cfpk_customer_nation#3185 AS cfpk_customer_nation_1#3206, cval_customer_c_name#3186 AS cval_customer_c_name_1#3207, cval_customer_c_address#3187 AS cval_customer_c_address_1#3208, cval_customer_c_phone#3188 AS cval_customer_c_phone_1#3209, cval_customer_c_acctbal#3189 AS cval_customer_c_acctbal_1#3210, cval_customer_c_comment#3190 AS cval_customer_c_comment_1#3211, cval_customer_c_mktsegment#3191 AS cval_customer_c_mktsegment_1#3212, cdepval_customer_c_name#3192 AS cdepval_customer_c_name_1#3213, cdepval_customer_c_address#3193 AS cdepval_customer_c_address_1#3214, cdepval_customer_c_phone#3194 AS cdepval_customer_c_phone_1#3215, cdepval_customer_c_acctbal#3195 AS cdepval_customer_c_acctbal_1#3216, cdepval_customer_c_comment#3196 AS cdepval_customer_c_comment_1#3217, cdepval_customer_c_mktsegment#3197 AS cdepval_customer_c_mktsegment_1#3218, cc_name#3198 AS cc_name_1#3219, cc_address#3199 AS cc_address_1#3220, cc_phone#3200 AS cc_phone_1#3221, cc_acctbal#3201 AS cc_acctbal_1#3222, cc_comment#3202 AS cc_comment_1#3223, cc_mktsegment#3203 AS cc_mktsegment_1#3224]
            +- Relation[rid#3183,cpfk_nation_customer#3184,cfpk_customer_nation#3185,cval_customer_c_name#3186,cval_customer_c_address#3187,cval_customer_c_phone#3188,cval_customer_c_acctbal#3189,cval_customer_c_comment#3190,cval_customer_c_mktsegment#3191,cdepval_customer_c_name#3192,cdepval_customer_c_address#3193,cdepval_customer_c_phone#3194,cdepval_customer_c_acctbal#3195,cdepval_customer_c_comment#3196,cdepval_customer_c_mktsegment#3197,cc_name#3198,cc_address#3199,cc_phone#3200,cc_acctbal#3201,cc_comment#3202,cc_mktsegment#3203] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4382ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/25 22:32:35 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:32:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3274L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 22:32:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3274L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#3276 AS rid_0#3300, cpfk_customer_orders#3277 AS cpfk_customer_orders_0#3301, cfpk_orders_customer#3278 AS cfpk_orders_customer_0#3302, cval_orders_o_orderstatus#3279 AS cval_orders_o_orderstatus_0#3303, cval_orders_o_totalprice#3280 AS cval_orders_o_totalprice_0#3304, cval_orders_o_orderpriority#3281 AS cval_orders_o_orderpriority_0#3305, cval_orders_o_clerk#3282 AS cval_orders_o_clerk_0#3306, cval_orders_o_shippriority#3283 AS cval_orders_o_shippriority_0#3307, cval_orders_o_comment#3284 AS cval_orders_o_comment_0#3308, cval_orders_o_orderdate#3285 AS cval_orders_o_orderdate_0#3309, cdepval_orders_o_orderstatus#3286 AS cdepval_orders_o_orderstatus_0#3310, cdepval_orders_o_totalprice#3287 AS cdepval_orders_o_totalprice_0#3311, cdepval_orders_o_orderpriority#3288 AS cdepval_orders_o_orderpriority_0#3312, cdepval_orders_o_clerk#3289 AS cdepval_orders_o_clerk_0#3313, cdepval_orders_o_shippriority#3290 AS cdepval_orders_o_shippriority_0#3314, cdepval_orders_o_comment#3291 AS cdepval_orders_o_comment_0#3315, cdepval_orders_o_orderdate#3292 AS cdepval_orders_o_orderdate_0#3316, co_orderstatus#3293 AS co_orderstatus_0#3317, co_totalprice#3294 AS co_totalprice_0#3318, co_orderpriority#3295 AS co_orderpriority_0#3319, co_clerk#3296 AS co_clerk_0#3320, co_shippriority#3297 AS co_shippriority_0#3321, co_comment#3298 AS co_comment_0#3322, co_orderdate#3299 AS co_orderdate_0#3323]
         :  +- Relation[rid#3276,cpfk_customer_orders#3277,cfpk_orders_customer#3278,cval_orders_o_orderstatus#3279,cval_orders_o_totalprice#3280,cval_orders_o_orderpriority#3281,cval_orders_o_clerk#3282,cval_orders_o_shippriority#3283,cval_orders_o_comment#3284,cval_orders_o_orderdate#3285,cdepval_orders_o_orderstatus#3286,cdepval_orders_o_totalprice#3287,cdepval_orders_o_orderpriority#3288,cdepval_orders_o_clerk#3289,cdepval_orders_o_shippriority#3290,cdepval_orders_o_comment#3291,cdepval_orders_o_orderdate#3292,co_orderstatus#3293,co_totalprice#3294,co_orderpriority#3295,co_clerk#3296,co_shippriority#3297,co_comment#3298,co_orderdate#3299] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#3324 AS rid_1#3345, cpfk_nation_customer#3325 AS cpfk_nation_customer_1#3346, cfpk_customer_nation#3326 AS cfpk_customer_nation_1#3347, cval_customer_c_name#3327 AS cval_customer_c_name_1#3348, cval_customer_c_address#3328 AS cval_customer_c_address_1#3349, cval_customer_c_phone#3329 AS cval_customer_c_phone_1#3350, cval_customer_c_acctbal#3330 AS cval_customer_c_acctbal_1#3351, cval_customer_c_comment#3331 AS cval_customer_c_comment_1#3352, cval_customer_c_mktsegment#3332 AS cval_customer_c_mktsegment_1#3353, cdepval_customer_c_name#3333 AS cdepval_customer_c_name_1#3354, cdepval_customer_c_address#3334 AS cdepval_customer_c_address_1#3355, cdepval_customer_c_phone#3335 AS cdepval_customer_c_phone_1#3356, cdepval_customer_c_acctbal#3336 AS cdepval_customer_c_acctbal_1#3357, cdepval_customer_c_comment#3337 AS cdepval_customer_c_comment_1#3358, cdepval_customer_c_mktsegment#3338 AS cdepval_customer_c_mktsegment_1#3359, cc_name#3339 AS cc_name_1#3360, cc_address#3340 AS cc_address_1#3361, cc_phone#3341 AS cc_phone_1#3362, cc_acctbal#3342 AS cc_acctbal_1#3363, cc_comment#3343 AS cc_comment_1#3364, cc_mktsegment#3344 AS cc_mktsegment_1#3365]
            +- Relation[rid#3324,cpfk_nation_customer#3325,cfpk_customer_nation#3326,cval_customer_c_name#3327,cval_customer_c_address#3328,cval_customer_c_phone#3329,cval_customer_c_acctbal#3330,cval_customer_c_comment#3331,cval_customer_c_mktsegment#3332,cdepval_customer_c_name#3333,cdepval_customer_c_address#3334,cdepval_customer_c_phone#3335,cdepval_customer_c_acctbal#3336,cdepval_customer_c_comment#3337,cdepval_customer_c_mktsegment#3338,cc_name#3339,cc_address#3340,cc_phone#3341,cc_acctbal#3342,cc_comment#3343,cc_mktsegment#3344] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4374ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/25 22:32:40 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:32:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3416L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 22:32:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:32:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:32:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:32:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:32:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:32:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:32:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:32:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:32:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:32:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:32:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3416L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :  :- Project [rid#3518 AS rid_1#3532, cpfk_part_partsupp#3519 AS cpfk_part_partsupp_1#3533, cfpk_partsupp_part#3520 AS cfpk_partsupp_part_1#3534, cpfk_supplier_partsupp#3521 AS cpfk_supplier_partsupp_1#3535, cfpk_partsupp_supplier#3522 AS cfpk_partsupp_supplier_1#3536, cval_partsupp_ps_availqty#3523 AS cval_partsupp_ps_availqty_1#3537, cval_partsupp_ps_supplycost#3524 AS cval_partsupp_ps_supplycost_1#3538, cval_partsupp_ps_comment#3525 AS cval_partsupp_ps_comment_1#3539, cdepval_partsupp_ps_availqty#3526 AS cdepval_partsupp_ps_availqty_1#3540, cdepval_partsupp_ps_supplycost#3527 AS cdepval_partsupp_ps_supplycost_1#3541, cdepval_partsupp_ps_comment#3528 AS cdepval_partsupp_ps_comment_1#3542, cps_availqty#3529 AS cps_availqty_1#3543, cps_supplycost#3530 AS cps_supplycost_1#3544, cps_comment#3531 AS cps_comment_1#3545]
         :  :  +- Relation[rid#3518,cpfk_part_partsupp#3519,cfpk_partsupp_part#3520,cpfk_supplier_partsupp#3521,cfpk_partsupp_supplier#3522,cval_partsupp_ps_availqty#3523,cval_partsupp_ps_supplycost#3524,cval_partsupp_ps_comment#3525,cdepval_partsupp_ps_availqty#3526,cdepval_partsupp_ps_supplycost#3527,cdepval_partsupp_ps_comment#3528,cps_availqty#3529,cps_supplycost#3530,cps_comment#3531] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :     +- Project [rid#3418 AS rid_0#3443, cval_part_p_name#3419 AS cval_part_p_name_0#3444, cval_part_p_mfgr#3420 AS cval_part_p_mfgr_0#3445, cval_part_p_type#3421 AS cval_part_p_type_0#3446, cval_part_p_size#3422 AS cval_part_p_size_0#3447, cval_part_p_container#3423 AS cval_part_p_container_0#3448, cval_part_p_retailprice#3424 AS cval_part_p_retailprice_0#3449, cval_part_p_comment#3425 AS cval_part_p_comment_0#3450, cval_part_p_brand#3426 AS cval_part_p_brand_0#3451, cdepval_part_p_name#3427 AS cdepval_part_p_name_0#3452, cdepval_part_p_mfgr#3428 AS cdepval_part_p_mfgr_0#3453, cdepval_part_p_type#3429 AS cdepval_part_p_type_0#3454, cdepval_part_p_size#3430 AS cdepval_part_p_size_0#3455, cdepval_part_p_container#3431 AS cdepval_part_p_container_0#3456, cdepval_part_p_retailprice#3432 AS cdepval_part_p_retailprice_0#3457, cdepval_part_p_comment#3433 AS cdepval_part_p_comment_0#3458, cdepval_part_p_brand#3434 AS cdepval_part_p_brand_0#3459, cp_name#3435 AS cp_name_0#3460, cp_mfgr#3436 AS cp_mfgr_0#3461, cp_type#3437 AS cp_type_0#3462, cp_size#3438 AS cp_size_0#3463, cp_container#3439 AS cp_container_0#3464, cp_retailprice#3440 AS cp_retailprice_0#3465, cp_comment#3441 AS cp_comment_0#3466, cp_brand#3442 AS cp_brand_0#3467]
         :        +- Relation[rid#3418,cval_part_p_name#3419,cval_part_p_mfgr#3420,cval_part_p_type#3421,cval_part_p_size#3422,cval_part_p_container#3423,cval_part_p_retailprice#3424,cval_part_p_comment#3425,cval_part_p_brand#3426,cdepval_part_p_name#3427,cdepval_part_p_mfgr#3428,cdepval_part_p_type#3429,cdepval_part_p_size#3430,cdepval_part_p_container#3431,cdepval_part_p_retailprice#3432,cdepval_part_p_comment#3433,cdepval_part_p_brand#3434,cp_name#3435,cp_mfgr#3436,cp_type#3437,cp_size#3438,cp_container#3439,cp_retailprice#3440,cp_comment#3441,cp_brand#3442] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_2)
            :- Project [rid#3582 AS rid_3#3600, cpfk_nation_supplier#3583 AS cpfk_nation_supplier_3#3601, cfpk_supplier_nation#3584 AS cfpk_supplier_nation_3#3602, cval_supplier_s_name#3585 AS cval_supplier_s_name_3#3603, cval_supplier_s_address#3586 AS cval_supplier_s_address_3#3604, cval_supplier_s_phone#3587 AS cval_supplier_s_phone_3#3605, cval_supplier_s_acctbal#3588 AS cval_supplier_s_acctbal_3#3606, cval_supplier_s_comment#3589 AS cval_supplier_s_comment_3#3607, cdepval_supplier_s_name#3590 AS cdepval_supplier_s_name_3#3608, cdepval_supplier_s_address#3591 AS cdepval_supplier_s_address_3#3609, cdepval_supplier_s_phone#3592 AS cdepval_supplier_s_phone_3#3610, cdepval_supplier_s_acctbal#3593 AS cdepval_supplier_s_acctbal_3#3611, cdepval_supplier_s_comment#3594 AS cdepval_supplier_s_comment_3#3612, cs_name#3595 AS cs_name_3#3613, cs_address#3596 AS cs_address_3#3614, cs_phone#3597 AS cs_phone_3#3615, cs_acctbal#3598 AS cs_acctbal_3#3616, cs_comment#3599 AS cs_comment_3#3617]
            :  +- Relation[rid#3582,cpfk_nation_supplier#3583,cfpk_supplier_nation#3584,cval_supplier_s_name#3585,cval_supplier_s_address#3586,cval_supplier_s_phone#3587,cval_supplier_s_acctbal#3588,cval_supplier_s_comment#3589,cdepval_supplier_s_name#3590,cdepval_supplier_s_address#3591,cdepval_supplier_s_phone#3592,cdepval_supplier_s_acctbal#3593,cdepval_supplier_s_comment#3594,cs_name#3595,cs_address#3596,cs_phone#3597,cs_acctbal#3598,cs_comment#3599] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
               +- Project [rid#3546 AS rid_2#3555, cpfk_region_nation#3547 AS cpfk_region_nation_2#3556, cfpk_nation_region#3548 AS cfpk_nation_region_2#3557, cval_nation_n_name#3549 AS cval_nation_n_name_2#3558, cval_nation_n_comment#3550 AS cval_nation_n_comment_2#3559, cdepval_nation_n_name#3551 AS cdepval_nation_n_name_2#3560, cdepval_nation_n_comment#3552 AS cdepval_nation_n_comment_2#3561, cn_name#3553 AS cn_name_2#3562, cn_comment#3554 AS cn_comment_2#3563]
                  +- Relation[rid#3546,cpfk_region_nation#3547,cfpk_nation_region#3548,cval_nation_n_name#3549,cval_nation_n_comment#3550,cdepval_nation_n_name#3551,cdepval_nation_n_comment#3552,cn_name#3553,cn_comment#3554] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 3594ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/25 22:32:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:32:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3690L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 22:32:43 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:32:43 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:32:43 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:32:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:32:43 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:32:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:32:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:32:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:32:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:32:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:32:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:32:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3690L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#3828 AS rid_4#3873, cpfk_orders_lineitem#3829 AS cpfk_orders_lineitem_4#3874, cpfk_supplier_lineitem#3830 AS cpfk_supplier_lineitem_4#3875, cfpk_lineitem_supplier#3831 AS cfpk_lineitem_supplier_4#3876, cfpk_lineitem_partsupp#3832 AS cfpk_lineitem_partsupp_4#3877, cpfk_part_lineitem#3833 AS cpfk_part_lineitem_4#3878, cfpk_lineitem_part#3834 AS cfpk_lineitem_part_4#3879, cpfk_partsupp_lineitem#3835 AS cpfk_partsupp_lineitem_4#3880, cfpk_lineitem_orders#3836 AS cfpk_lineitem_orders_4#3881, cval_lineitem_l_quantity#3837 AS cval_lineitem_l_quantity_4#3882, cval_lineitem_l_extendedprice#3838 AS cval_lineitem_l_extendedprice_4#3883, cval_lineitem_l_discount#3839 AS cval_lineitem_l_discount_4#3884, cval_lineitem_l_tax#3840 AS cval_lineitem_l_tax_4#3885, cval_lineitem_l_returnflag#3841 AS cval_lineitem_l_returnflag_4#3886, cval_lineitem_l_linestatus#3842 AS cval_lineitem_l_linestatus_4#3887, cval_lineitem_l_commitdate#3843 AS cval_lineitem_l_commitdate_4#3888, cval_lineitem_l_receiptdate#3844 AS cval_lineitem_l_receiptdate_4#3889, cval_lineitem_l_shipinstruct#3845 AS cval_lineitem_l_shipinstruct_4#3890, cval_lineitem_l_shipmode#3846 AS cval_lineitem_l_shipmode_4#3891, cval_lineitem_l_comment#3847 AS cval_lineitem_l_comment_4#3892, cval_lineitem_l_shipdate#3848 AS cval_lineitem_l_shipdate_4#3893, cdepval_lineitem_l_quantity#3849 AS cdepval_lineitem_l_quantity_4#3894, cdepval_lineitem_l_extendedprice#3850 AS cdepval_lineitem_l_extendedprice_4#3895, cdepval_lineitem_l_discount#3851 AS cdepval_lineitem_l_discount_4#3896, ... 21 more fields]
            :  :  +- Relation[rid#3828,cpfk_orders_lineitem#3829,cpfk_supplier_lineitem#3830,cfpk_lineitem_supplier#3831,cfpk_lineitem_partsupp#3832,cpfk_part_lineitem#3833,cfpk_lineitem_part#3834,cpfk_partsupp_lineitem#3835,cfpk_lineitem_orders#3836,cval_lineitem_l_quantity#3837,cval_lineitem_l_extendedprice#3838,cval_lineitem_l_discount#3839,cval_lineitem_l_tax#3840,cval_lineitem_l_returnflag#3841,cval_lineitem_l_linestatus#3842,cval_lineitem_l_commitdate#3843,cval_lineitem_l_receiptdate#3844,cval_lineitem_l_shipinstruct#3845,cval_lineitem_l_shipmode#3846,cval_lineitem_l_comment#3847,cval_lineitem_l_shipdate#3848,cdepval_lineitem_l_quantity#3849,cdepval_lineitem_l_extendedprice#3850,cdepval_lineitem_l_discount#3851,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#3780 AS rid_3#3804, cpfk_customer_orders#3781 AS cpfk_customer_orders_3#3805, cfpk_orders_customer#3782 AS cfpk_orders_customer_3#3806, cval_orders_o_orderstatus#3783 AS cval_orders_o_orderstatus_3#3807, cval_orders_o_totalprice#3784 AS cval_orders_o_totalprice_3#3808, cval_orders_o_orderpriority#3785 AS cval_orders_o_orderpriority_3#3809, cval_orders_o_clerk#3786 AS cval_orders_o_clerk_3#3810, cval_orders_o_shippriority#3787 AS cval_orders_o_shippriority_3#3811, cval_orders_o_comment#3788 AS cval_orders_o_comment_3#3812, cval_orders_o_orderdate#3789 AS cval_orders_o_orderdate_3#3813, cdepval_orders_o_orderstatus#3790 AS cdepval_orders_o_orderstatus_3#3814, cdepval_orders_o_totalprice#3791 AS cdepval_orders_o_totalprice_3#3815, cdepval_orders_o_orderpriority#3792 AS cdepval_orders_o_orderpriority_3#3816, cdepval_orders_o_clerk#3793 AS cdepval_orders_o_clerk_3#3817, cdepval_orders_o_shippriority#3794 AS cdepval_orders_o_shippriority_3#3818, cdepval_orders_o_comment#3795 AS cdepval_orders_o_comment_3#3819, cdepval_orders_o_orderdate#3796 AS cdepval_orders_o_orderdate_3#3820, co_orderstatus#3797 AS co_orderstatus_3#3821, co_totalprice#3798 AS co_totalprice_3#3822, co_orderpriority#3799 AS co_orderpriority_3#3823, co_clerk#3800 AS co_clerk_3#3824, co_shippriority#3801 AS co_shippriority_3#3825, co_comment#3802 AS co_comment_3#3826, co_orderdate#3803 AS co_orderdate_3#3827]
            :     :  +- Relation[rid#3780,cpfk_customer_orders#3781,cfpk_orders_customer#3782,cval_orders_o_orderstatus#3783,cval_orders_o_totalprice#3784,cval_orders_o_orderpriority#3785,cval_orders_o_clerk#3786,cval_orders_o_shippriority#3787,cval_orders_o_comment#3788,cval_orders_o_orderdate#3789,cdepval_orders_o_orderstatus#3790,cdepval_orders_o_totalprice#3791,cdepval_orders_o_orderpriority#3792,cdepval_orders_o_clerk#3793,cdepval_orders_o_shippriority#3794,cdepval_orders_o_comment#3795,cdepval_orders_o_orderdate#3796,co_orderstatus#3797,co_totalprice#3798,co_orderpriority#3799,co_clerk#3800,co_shippriority#3801,co_comment#3802,co_orderdate#3803] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#3738 AS rid_2#3759, cpfk_nation_customer#3739 AS cpfk_nation_customer_2#3760, cfpk_customer_nation#3740 AS cfpk_customer_nation_2#3761, cval_customer_c_name#3741 AS cval_customer_c_name_2#3762, cval_customer_c_address#3742 AS cval_customer_c_address_2#3763, cval_customer_c_phone#3743 AS cval_customer_c_phone_2#3764, cval_customer_c_acctbal#3744 AS cval_customer_c_acctbal_2#3765, cval_customer_c_comment#3745 AS cval_customer_c_comment_2#3766, cval_customer_c_mktsegment#3746 AS cval_customer_c_mktsegment_2#3767, cdepval_customer_c_name#3747 AS cdepval_customer_c_name_2#3768, cdepval_customer_c_address#3748 AS cdepval_customer_c_address_2#3769, cdepval_customer_c_phone#3749 AS cdepval_customer_c_phone_2#3770, cdepval_customer_c_acctbal#3750 AS cdepval_customer_c_acctbal_2#3771, cdepval_customer_c_comment#3751 AS cdepval_customer_c_comment_2#3772, cdepval_customer_c_mktsegment#3752 AS cdepval_customer_c_mktsegment_2#3773, cc_name#3753 AS cc_name_2#3774, cc_address#3754 AS cc_address_2#3775, cc_phone#3755 AS cc_phone_2#3776, cc_acctbal#3756 AS cc_acctbal_2#3777, cc_comment#3757 AS cc_comment_2#3778, cc_mktsegment#3758 AS cc_mktsegment_2#3779]
            :        :  +- Relation[rid#3738,cpfk_nation_customer#3739,cfpk_customer_nation#3740,cval_customer_c_name#3741,cval_customer_c_address#3742,cval_customer_c_phone#3743,cval_customer_c_acctbal#3744,cval_customer_c_comment#3745,cval_customer_c_mktsegment#3746,cdepval_customer_c_name#3747,cdepval_customer_c_address#3748,cdepval_customer_c_phone#3749,cdepval_customer_c_acctbal#3750,cdepval_customer_c_comment#3751,cdepval_customer_c_mktsegment#3752,cc_name#3753,cc_address#3754,cc_phone#3755,cc_acctbal#3756,cc_comment#3757,cc_mktsegment#3758] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
            :           :- Project [rid#3720 AS rid_1#3729, cpfk_region_nation#3721 AS cpfk_region_nation_1#3730, cfpk_nation_region#3722 AS cfpk_nation_region_1#3731, cval_nation_n_name#3723 AS cval_nation_n_name_1#3732, cval_nation_n_comment#3724 AS cval_nation_n_comment_1#3733, cdepval_nation_n_name#3725 AS cdepval_nation_n_name_1#3734, cdepval_nation_n_comment#3726 AS cdepval_nation_n_comment_1#3735, cn_name#3727 AS cn_name_1#3736, cn_comment#3728 AS cn_comment_1#3737]
            :           :  +- Relation[rid#3720,cpfk_region_nation#3721,cfpk_nation_region#3722,cval_nation_n_name#3723,cval_nation_n_comment#3724,cdepval_nation_n_name#3725,cdepval_nation_n_comment#3726,cn_name#3727,cn_comment#3728] JDBCRelation(tnation) [numPartitions=1]
            :           +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :              +- Project [rid#3692 AS rid_0#3699, cval_region_r_name#3693 AS cval_region_r_name_0#3700, cval_region_r_comment#3694 AS cval_region_r_comment_0#3701, cdepval_region_r_name#3695 AS cdepval_region_r_name_0#3702, cdepval_region_r_comment#3696 AS cdepval_region_r_comment_0#3703, cr_name#3697 AS cr_name_0#3704, cr_comment#3698 AS cr_comment_0#3705]
            :                 +- Relation[rid#3692,cval_region_r_name#3693,cval_region_r_comment#3694,cdepval_region_r_name#3695,cdepval_region_r_comment#3696,cr_name#3697,cr_comment#3698] JDBCRelation(tregion) [numPartitions=1]
            +- Project [rid#3918 AS rid_5#3936, cpfk_nation_supplier#3919 AS cpfk_nation_supplier_5#3937, cfpk_supplier_nation#3920 AS cfpk_supplier_nation_5#3938, cval_supplier_s_name#3921 AS cval_supplier_s_name_5#3939, cval_supplier_s_address#3922 AS cval_supplier_s_address_5#3940, cval_supplier_s_phone#3923 AS cval_supplier_s_phone_5#3941, cval_supplier_s_acctbal#3924 AS cval_supplier_s_acctbal_5#3942, cval_supplier_s_comment#3925 AS cval_supplier_s_comment_5#3943, cdepval_supplier_s_name#3926 AS cdepval_supplier_s_name_5#3944, cdepval_supplier_s_address#3927 AS cdepval_supplier_s_address_5#3945, cdepval_supplier_s_phone#3928 AS cdepval_supplier_s_phone_5#3946, cdepval_supplier_s_acctbal#3929 AS cdepval_supplier_s_acctbal_5#3947, cdepval_supplier_s_comment#3930 AS cdepval_supplier_s_comment_5#3948, cs_name#3931 AS cs_name_5#3949, cs_address#3932 AS cs_address_5#3950, cs_phone#3933 AS cs_phone_5#3951, cs_acctbal#3934 AS cs_acctbal_5#3952, cs_comment#3935 AS cs_comment_5#3953]
               +- Relation[rid#3918,cpfk_nation_supplier#3919,cfpk_supplier_nation#3920,cval_supplier_s_name#3921,cval_supplier_s_address#3922,cval_supplier_s_phone#3923,cval_supplier_s_acctbal#3924,cval_supplier_s_comment#3925,cdepval_supplier_s_name#3926,cdepval_supplier_s_address#3927,cdepval_supplier_s_phone#3928,cdepval_supplier_s_acctbal#3929,cdepval_supplier_s_comment#3930,cs_name#3931,cs_address#3932,cs_phone#3933,cs_acctbal#3934,cs_comment#3935] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 30651ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/25 22:33:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:33:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4082L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 22:33:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:33:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:33:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:33:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:33:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:33:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:33:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:33:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4082L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#4084 AS rid_0#4129, cpfk_orders_lineitem#4085 AS cpfk_orders_lineitem_0#4130, cpfk_supplier_lineitem#4086 AS cpfk_supplier_lineitem_0#4131, cfpk_lineitem_supplier#4087 AS cfpk_lineitem_supplier_0#4132, cfpk_lineitem_partsupp#4088 AS cfpk_lineitem_partsupp_0#4133, cpfk_part_lineitem#4089 AS cpfk_part_lineitem_0#4134, cfpk_lineitem_part#4090 AS cfpk_lineitem_part_0#4135, cpfk_partsupp_lineitem#4091 AS cpfk_partsupp_lineitem_0#4136, cfpk_lineitem_orders#4092 AS cfpk_lineitem_orders_0#4137, cval_lineitem_l_quantity#4093 AS cval_lineitem_l_quantity_0#4138, cval_lineitem_l_extendedprice#4094 AS cval_lineitem_l_extendedprice_0#4139, cval_lineitem_l_discount#4095 AS cval_lineitem_l_discount_0#4140, cval_lineitem_l_tax#4096 AS cval_lineitem_l_tax_0#4141, cval_lineitem_l_returnflag#4097 AS cval_lineitem_l_returnflag_0#4142, cval_lineitem_l_linestatus#4098 AS cval_lineitem_l_linestatus_0#4143, cval_lineitem_l_commitdate#4099 AS cval_lineitem_l_commitdate_0#4144, cval_lineitem_l_receiptdate#4100 AS cval_lineitem_l_receiptdate_0#4145, cval_lineitem_l_shipinstruct#4101 AS cval_lineitem_l_shipinstruct_0#4146, cval_lineitem_l_shipmode#4102 AS cval_lineitem_l_shipmode_0#4147, cval_lineitem_l_comment#4103 AS cval_lineitem_l_comment_0#4148, cval_lineitem_l_shipdate#4104 AS cval_lineitem_l_shipdate_0#4149, cdepval_lineitem_l_quantity#4105 AS cdepval_lineitem_l_quantity_0#4150, cdepval_lineitem_l_extendedprice#4106 AS cdepval_lineitem_l_extendedprice_0#4151, cdepval_lineitem_l_discount#4107 AS cdepval_lineitem_l_discount_0#4152, ... 21 more fields]
         :  +- Relation[rid#4084,cpfk_orders_lineitem#4085,cpfk_supplier_lineitem#4086,cfpk_lineitem_supplier#4087,cfpk_lineitem_partsupp#4088,cpfk_part_lineitem#4089,cfpk_lineitem_part#4090,cpfk_partsupp_lineitem#4091,cfpk_lineitem_orders#4092,cval_lineitem_l_quantity#4093,cval_lineitem_l_extendedprice#4094,cval_lineitem_l_discount#4095,cval_lineitem_l_tax#4096,cval_lineitem_l_returnflag#4097,cval_lineitem_l_linestatus#4098,cval_lineitem_l_commitdate#4099,cval_lineitem_l_receiptdate#4100,cval_lineitem_l_shipinstruct#4101,cval_lineitem_l_shipmode#4102,cval_lineitem_l_comment#4103,cval_lineitem_l_shipdate#4104,cdepval_lineitem_l_quantity#4105,cdepval_lineitem_l_extendedprice#4106,cdepval_lineitem_l_discount#4107,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
            :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
            :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
            :  :  :- Project [rid#4270 AS rid_2#4315, cpfk_orders_lineitem#4271 AS cpfk_orders_lineitem_2#4316, cpfk_supplier_lineitem#4272 AS cpfk_supplier_lineitem_2#4317, cfpk_lineitem_supplier#4273 AS cfpk_lineitem_supplier_2#4318, cfpk_lineitem_partsupp#4274 AS cfpk_lineitem_partsupp_2#4319, cpfk_part_lineitem#4275 AS cpfk_part_lineitem_2#4320, cfpk_lineitem_part#4276 AS cfpk_lineitem_part_2#4321, cpfk_partsupp_lineitem#4277 AS cpfk_partsupp_lineitem_2#4322, cfpk_lineitem_orders#4278 AS cfpk_lineitem_orders_2#4323, cval_lineitem_l_quantity#4279 AS cval_lineitem_l_quantity_2#4324, cval_lineitem_l_extendedprice#4280 AS cval_lineitem_l_extendedprice_2#4325, cval_lineitem_l_discount#4281 AS cval_lineitem_l_discount_2#4326, cval_lineitem_l_tax#4282 AS cval_lineitem_l_tax_2#4327, cval_lineitem_l_returnflag#4283 AS cval_lineitem_l_returnflag_2#4328, cval_lineitem_l_linestatus#4284 AS cval_lineitem_l_linestatus_2#4329, cval_lineitem_l_commitdate#4285 AS cval_lineitem_l_commitdate_2#4330, cval_lineitem_l_receiptdate#4286 AS cval_lineitem_l_receiptdate_2#4331, cval_lineitem_l_shipinstruct#4287 AS cval_lineitem_l_shipinstruct_2#4332, cval_lineitem_l_shipmode#4288 AS cval_lineitem_l_shipmode_2#4333, cval_lineitem_l_comment#4289 AS cval_lineitem_l_comment_2#4334, cval_lineitem_l_shipdate#4290 AS cval_lineitem_l_shipdate_2#4335, cdepval_lineitem_l_quantity#4291 AS cdepval_lineitem_l_quantity_2#4336, cdepval_lineitem_l_extendedprice#4292 AS cdepval_lineitem_l_extendedprice_2#4337, cdepval_lineitem_l_discount#4293 AS cdepval_lineitem_l_discount_2#4338, ... 21 more fields]
            :  :  :  +- Relation[rid#4270,cpfk_orders_lineitem#4271,cpfk_supplier_lineitem#4272,cfpk_lineitem_supplier#4273,cfpk_lineitem_partsupp#4274,cpfk_part_lineitem#4275,cfpk_lineitem_part#4276,cpfk_partsupp_lineitem#4277,cfpk_lineitem_orders#4278,cval_lineitem_l_quantity#4279,cval_lineitem_l_extendedprice#4280,cval_lineitem_l_discount#4281,cval_lineitem_l_tax#4282,cval_lineitem_l_returnflag#4283,cval_lineitem_l_linestatus#4284,cval_lineitem_l_commitdate#4285,cval_lineitem_l_receiptdate#4286,cval_lineitem_l_shipinstruct#4287,cval_lineitem_l_shipmode#4288,cval_lineitem_l_comment#4289,cval_lineitem_l_shipdate#4290,cdepval_lineitem_l_quantity#4291,cdepval_lineitem_l_extendedprice#4292,cdepval_lineitem_l_discount#4293,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
            :  :     +- Project [rid#4174 AS rid_1#4198, cpfk_customer_orders#4175 AS cpfk_customer_orders_1#4199, cfpk_orders_customer#4176 AS cfpk_orders_customer_1#4200, cval_orders_o_orderstatus#4177 AS cval_orders_o_orderstatus_1#4201, cval_orders_o_totalprice#4178 AS cval_orders_o_totalprice_1#4202, cval_orders_o_orderpriority#4179 AS cval_orders_o_orderpriority_1#4203, cval_orders_o_clerk#4180 AS cval_orders_o_clerk_1#4204, cval_orders_o_shippriority#4181 AS cval_orders_o_shippriority_1#4205, cval_orders_o_comment#4182 AS cval_orders_o_comment_1#4206, cval_orders_o_orderdate#4183 AS cval_orders_o_orderdate_1#4207, cdepval_orders_o_orderstatus#4184 AS cdepval_orders_o_orderstatus_1#4208, cdepval_orders_o_totalprice#4185 AS cdepval_orders_o_totalprice_1#4209, cdepval_orders_o_orderpriority#4186 AS cdepval_orders_o_orderpriority_1#4210, cdepval_orders_o_clerk#4187 AS cdepval_orders_o_clerk_1#4211, cdepval_orders_o_shippriority#4188 AS cdepval_orders_o_shippriority_1#4212, cdepval_orders_o_comment#4189 AS cdepval_orders_o_comment_1#4213, cdepval_orders_o_orderdate#4190 AS cdepval_orders_o_orderdate_1#4214, co_orderstatus#4191 AS co_orderstatus_1#4215, co_totalprice#4192 AS co_totalprice_1#4216, co_orderpriority#4193 AS co_orderpriority_1#4217, co_clerk#4194 AS co_clerk_1#4218, co_shippriority#4195 AS co_shippriority_1#4219, co_comment#4196 AS co_comment_1#4220, co_orderdate#4197 AS co_orderdate_1#4221]
            :  :        +- Relation[rid#4174,cpfk_customer_orders#4175,cfpk_orders_customer#4176,cval_orders_o_orderstatus#4177,cval_orders_o_totalprice#4178,cval_orders_o_orderpriority#4179,cval_orders_o_clerk#4180,cval_orders_o_shippriority#4181,cval_orders_o_comment#4182,cval_orders_o_orderdate#4183,cdepval_orders_o_orderstatus#4184,cdepval_orders_o_totalprice#4185,cdepval_orders_o_orderpriority#4186,cdepval_orders_o_clerk#4187,cdepval_orders_o_shippriority#4188,cdepval_orders_o_comment#4189,cdepval_orders_o_orderdate#4190,co_orderstatus#4191,co_totalprice#4192,co_orderpriority#4193,co_clerk#4194,co_shippriority#4195,co_comment#4196,co_orderdate#4197] JDBCRelation(torders) [numPartitions=1]
            :  +- Project [rid#4360 AS rid_3#4378, cpfk_nation_supplier#4361 AS cpfk_nation_supplier_3#4379, cfpk_supplier_nation#4362 AS cfpk_supplier_nation_3#4380, cval_supplier_s_name#4363 AS cval_supplier_s_name_3#4381, cval_supplier_s_address#4364 AS cval_supplier_s_address_3#4382, cval_supplier_s_phone#4365 AS cval_supplier_s_phone_3#4383, cval_supplier_s_acctbal#4366 AS cval_supplier_s_acctbal_3#4384, cval_supplier_s_comment#4367 AS cval_supplier_s_comment_3#4385, cdepval_supplier_s_name#4368 AS cdepval_supplier_s_name_3#4386, cdepval_supplier_s_address#4369 AS cdepval_supplier_s_address_3#4387, cdepval_supplier_s_phone#4370 AS cdepval_supplier_s_phone_3#4388, cdepval_supplier_s_acctbal#4371 AS cdepval_supplier_s_acctbal_3#4389, cdepval_supplier_s_comment#4372 AS cdepval_supplier_s_comment_3#4390, cs_name#4373 AS cs_name_3#4391, cs_address#4374 AS cs_address_3#4392, cs_phone#4375 AS cs_phone_3#4393, cs_acctbal#4376 AS cs_acctbal_3#4394, cs_comment#4377 AS cs_comment_3#4395]
            :     +- Relation[rid#4360,cpfk_nation_supplier#4361,cfpk_supplier_nation#4362,cval_supplier_s_name#4363,cval_supplier_s_address#4364,cval_supplier_s_phone#4365,cval_supplier_s_acctbal#4366,cval_supplier_s_comment#4367,cdepval_supplier_s_name#4368,cdepval_supplier_s_address#4369,cdepval_supplier_s_phone#4370,cdepval_supplier_s_acctbal#4371,cdepval_supplier_s_comment#4372,cs_name#4373,cs_address#4374,cs_phone#4375,cs_acctbal#4376,cs_comment#4377] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
               +- Project [rid#4396 AS rid_4#4405, cpfk_region_nation#4397 AS cpfk_region_nation_4#4406, cfpk_nation_region#4398 AS cfpk_nation_region_4#4407, cval_nation_n_name#4399 AS cval_nation_n_name_4#4408, cval_nation_n_comment#4400 AS cval_nation_n_comment_4#4409, cdepval_nation_n_name#4401 AS cdepval_nation_n_name_4#4410, cdepval_nation_n_comment#4402 AS cdepval_nation_n_comment_4#4411, cn_name#4403 AS cn_name_4#4412, cn_comment#4404 AS cn_comment_4#4413]
                  +- Relation[rid#4396,cpfk_region_nation#4397,cfpk_nation_region#4398,cval_nation_n_name#4399,cval_nation_n_comment#4400,cdepval_nation_n_name#4401,cdepval_nation_n_comment#4402,cn_name#4403,cn_comment#4404] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 75762ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/25 22:34:30 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:34:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4581L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:34:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:34:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:34:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:34:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:34:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:34:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:34:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:34:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:34:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:34:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:34:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:34:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4581L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#4655 AS rid_2#4700, cpfk_orders_lineitem#4656 AS cpfk_orders_lineitem_2#4701, cpfk_supplier_lineitem#4657 AS cpfk_supplier_lineitem_2#4702, cfpk_lineitem_supplier#4658 AS cfpk_lineitem_supplier_2#4703, cfpk_lineitem_partsupp#4659 AS cfpk_lineitem_partsupp_2#4704, cpfk_part_lineitem#4660 AS cpfk_part_lineitem_2#4705, cfpk_lineitem_part#4661 AS cfpk_lineitem_part_2#4706, cpfk_partsupp_lineitem#4662 AS cpfk_partsupp_lineitem_2#4707, cfpk_lineitem_orders#4663 AS cfpk_lineitem_orders_2#4708, cval_lineitem_l_quantity#4664 AS cval_lineitem_l_quantity_2#4709, cval_lineitem_l_extendedprice#4665 AS cval_lineitem_l_extendedprice_2#4710, cval_lineitem_l_discount#4666 AS cval_lineitem_l_discount_2#4711, cval_lineitem_l_tax#4667 AS cval_lineitem_l_tax_2#4712, cval_lineitem_l_returnflag#4668 AS cval_lineitem_l_returnflag_2#4713, cval_lineitem_l_linestatus#4669 AS cval_lineitem_l_linestatus_2#4714, cval_lineitem_l_commitdate#4670 AS cval_lineitem_l_commitdate_2#4715, cval_lineitem_l_receiptdate#4671 AS cval_lineitem_l_receiptdate_2#4716, cval_lineitem_l_shipinstruct#4672 AS cval_lineitem_l_shipinstruct_2#4717, cval_lineitem_l_shipmode#4673 AS cval_lineitem_l_shipmode_2#4718, cval_lineitem_l_comment#4674 AS cval_lineitem_l_comment_2#4719, cval_lineitem_l_shipdate#4675 AS cval_lineitem_l_shipdate_2#4720, cdepval_lineitem_l_quantity#4676 AS cdepval_lineitem_l_quantity_2#4721, cdepval_lineitem_l_extendedprice#4677 AS cdepval_lineitem_l_extendedprice_2#4722, cdepval_lineitem_l_discount#4678 AS cdepval_lineitem_l_discount_2#4723, ... 21 more fields]
         :  :  +- Relation[rid#4655,cpfk_orders_lineitem#4656,cpfk_supplier_lineitem#4657,cfpk_lineitem_supplier#4658,cfpk_lineitem_partsupp#4659,cpfk_part_lineitem#4660,cfpk_lineitem_part#4661,cpfk_partsupp_lineitem#4662,cfpk_lineitem_orders#4663,cval_lineitem_l_quantity#4664,cval_lineitem_l_extendedprice#4665,cval_lineitem_l_discount#4666,cval_lineitem_l_tax#4667,cval_lineitem_l_returnflag#4668,cval_lineitem_l_linestatus#4669,cval_lineitem_l_commitdate#4670,cval_lineitem_l_receiptdate#4671,cval_lineitem_l_shipinstruct#4672,cval_lineitem_l_shipmode#4673,cval_lineitem_l_comment#4674,cval_lineitem_l_shipdate#4675,cdepval_lineitem_l_quantity#4676,cdepval_lineitem_l_extendedprice#4677,cdepval_lineitem_l_discount#4678,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :- Project [rid#4619 AS rid_1#4637, cpfk_nation_supplier#4620 AS cpfk_nation_supplier_1#4638, cfpk_supplier_nation#4621 AS cfpk_supplier_nation_1#4639, cval_supplier_s_name#4622 AS cval_supplier_s_name_1#4640, cval_supplier_s_address#4623 AS cval_supplier_s_address_1#4641, cval_supplier_s_phone#4624 AS cval_supplier_s_phone_1#4642, cval_supplier_s_acctbal#4625 AS cval_supplier_s_acctbal_1#4643, cval_supplier_s_comment#4626 AS cval_supplier_s_comment_1#4644, cdepval_supplier_s_name#4627 AS cdepval_supplier_s_name_1#4645, cdepval_supplier_s_address#4628 AS cdepval_supplier_s_address_1#4646, cdepval_supplier_s_phone#4629 AS cdepval_supplier_s_phone_1#4647, cdepval_supplier_s_acctbal#4630 AS cdepval_supplier_s_acctbal_1#4648, cdepval_supplier_s_comment#4631 AS cdepval_supplier_s_comment_1#4649, cs_name#4632 AS cs_name_1#4650, cs_address#4633 AS cs_address_1#4651, cs_phone#4634 AS cs_phone_1#4652, cs_acctbal#4635 AS cs_acctbal_1#4653, cs_comment#4636 AS cs_comment_1#4654]
         :     :  +- Relation[rid#4619,cpfk_nation_supplier#4620,cfpk_supplier_nation#4621,cval_supplier_s_name#4622,cval_supplier_s_address#4623,cval_supplier_s_phone#4624,cval_supplier_s_acctbal#4625,cval_supplier_s_comment#4626,cdepval_supplier_s_name#4627,cdepval_supplier_s_address#4628,cdepval_supplier_s_phone#4629,cdepval_supplier_s_acctbal#4630,cdepval_supplier_s_comment#4631,cs_name#4632,cs_address#4633,cs_phone#4634,cs_acctbal#4635,cs_comment#4636] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :        +- Project [rid#4583 AS rid_0#4592, cpfk_region_nation#4584 AS cpfk_region_nation_0#4593, cfpk_nation_region#4585 AS cfpk_nation_region_0#4594, cval_nation_n_name#4586 AS cval_nation_n_name_0#4595, cval_nation_n_comment#4587 AS cval_nation_n_comment_0#4596, cdepval_nation_n_name#4588 AS cdepval_nation_n_name_0#4597, cdepval_nation_n_comment#4589 AS cdepval_nation_n_comment_0#4598, cn_name#4590 AS cn_name_0#4599, cn_comment#4591 AS cn_comment_0#4600]
         :           +- Relation[rid#4583,cpfk_region_nation#4584,cfpk_nation_region#4585,cval_nation_n_name#4586,cval_nation_n_comment#4587,cdepval_nation_n_name#4588,cdepval_nation_n_comment#4589,cn_name#4590,cn_comment#4591] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#4823 AS rid_5#4847, cpfk_customer_orders#4824 AS cpfk_customer_orders_5#4848, cfpk_orders_customer#4825 AS cfpk_orders_customer_5#4849, cval_orders_o_orderstatus#4826 AS cval_orders_o_orderstatus_5#4850, cval_orders_o_totalprice#4827 AS cval_orders_o_totalprice_5#4851, cval_orders_o_orderpriority#4828 AS cval_orders_o_orderpriority_5#4852, cval_orders_o_clerk#4829 AS cval_orders_o_clerk_5#4853, cval_orders_o_shippriority#4830 AS cval_orders_o_shippriority_5#4854, cval_orders_o_comment#4831 AS cval_orders_o_comment_5#4855, cval_orders_o_orderdate#4832 AS cval_orders_o_orderdate_5#4856, cdepval_orders_o_orderstatus#4833 AS cdepval_orders_o_orderstatus_5#4857, cdepval_orders_o_totalprice#4834 AS cdepval_orders_o_totalprice_5#4858, cdepval_orders_o_orderpriority#4835 AS cdepval_orders_o_orderpriority_5#4859, cdepval_orders_o_clerk#4836 AS cdepval_orders_o_clerk_5#4860, cdepval_orders_o_shippriority#4837 AS cdepval_orders_o_shippriority_5#4861, cdepval_orders_o_comment#4838 AS cdepval_orders_o_comment_5#4862, cdepval_orders_o_orderdate#4839 AS cdepval_orders_o_orderdate_5#4863, co_orderstatus#4840 AS co_orderstatus_5#4864, co_totalprice#4841 AS co_totalprice_5#4865, co_orderpriority#4842 AS co_orderpriority_5#4866, co_clerk#4843 AS co_clerk_5#4867, co_shippriority#4844 AS co_shippriority_5#4868, co_comment#4845 AS co_comment_5#4869, co_orderdate#4846 AS co_orderdate_5#4870]
            :  +- Relation[rid#4823,cpfk_customer_orders#4824,cfpk_orders_customer#4825,cval_orders_o_orderstatus#4826,cval_orders_o_totalprice#4827,cval_orders_o_orderpriority#4828,cval_orders_o_clerk#4829,cval_orders_o_shippriority#4830,cval_orders_o_comment#4831,cval_orders_o_orderdate#4832,cdepval_orders_o_orderstatus#4833,cdepval_orders_o_totalprice#4834,cdepval_orders_o_orderpriority#4835,cdepval_orders_o_clerk#4836,cdepval_orders_o_shippriority#4837,cdepval_orders_o_comment#4838,cdepval_orders_o_orderdate#4839,co_orderstatus#4840,co_totalprice#4841,co_orderpriority#4842,co_clerk#4843,co_shippriority#4844,co_comment#4845,co_orderdate#4846] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_4, BinaryType)), 'cfpk_customer_nation_4) = 'rid_3)
               :- Project [rid#4781 AS rid_4#4802, cpfk_nation_customer#4782 AS cpfk_nation_customer_4#4803, cfpk_customer_nation#4783 AS cfpk_customer_nation_4#4804, cval_customer_c_name#4784 AS cval_customer_c_name_4#4805, cval_customer_c_address#4785 AS cval_customer_c_address_4#4806, cval_customer_c_phone#4786 AS cval_customer_c_phone_4#4807, cval_customer_c_acctbal#4787 AS cval_customer_c_acctbal_4#4808, cval_customer_c_comment#4788 AS cval_customer_c_comment_4#4809, cval_customer_c_mktsegment#4789 AS cval_customer_c_mktsegment_4#4810, cdepval_customer_c_name#4790 AS cdepval_customer_c_name_4#4811, cdepval_customer_c_address#4791 AS cdepval_customer_c_address_4#4812, cdepval_customer_c_phone#4792 AS cdepval_customer_c_phone_4#4813, cdepval_customer_c_acctbal#4793 AS cdepval_customer_c_acctbal_4#4814, cdepval_customer_c_comment#4794 AS cdepval_customer_c_comment_4#4815, cdepval_customer_c_mktsegment#4795 AS cdepval_customer_c_mktsegment_4#4816, cc_name#4796 AS cc_name_4#4817, cc_address#4797 AS cc_address_4#4818, cc_phone#4798 AS cc_phone_4#4819, cc_acctbal#4799 AS cc_acctbal_4#4820, cc_comment#4800 AS cc_comment_4#4821, cc_mktsegment#4801 AS cc_mktsegment_4#4822]
               :  +- Relation[rid#4781,cpfk_nation_customer#4782,cfpk_customer_nation#4783,cval_customer_c_name#4784,cval_customer_c_address#4785,cval_customer_c_phone#4786,cval_customer_c_acctbal#4787,cval_customer_c_comment#4788,cval_customer_c_mktsegment#4789,cdepval_customer_c_name#4790,cdepval_customer_c_address#4791,cdepval_customer_c_phone#4792,cdepval_customer_c_acctbal#4793,cdepval_customer_c_comment#4794,cdepval_customer_c_mktsegment#4795,cc_name#4796,cc_address#4797,cc_phone#4798,cc_acctbal#4799,cc_comment#4800,cc_mktsegment#4801] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
                  +- Project [rid#4745 AS rid_3#4754, cpfk_region_nation#4746 AS cpfk_region_nation_3#4755, cfpk_nation_region#4747 AS cfpk_nation_region_3#4756, cval_nation_n_name#4748 AS cval_nation_n_name_3#4757, cval_nation_n_comment#4749 AS cval_nation_n_comment_3#4758, cdepval_nation_n_name#4750 AS cdepval_nation_n_name_3#4759, cdepval_nation_n_comment#4751 AS cdepval_nation_n_comment_3#4760, cn_name#4752 AS cn_name_3#4761, cn_comment#4753 AS cn_comment_3#4762]
                     +- Relation[rid#4745,cpfk_region_nation#4746,cfpk_nation_region#4747,cval_nation_n_name#4748,cval_nation_n_comment#4749,cdepval_nation_n_name#4750,cdepval_nation_n_comment#4751,cn_name#4752,cn_comment#4753] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 35184ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/25 22:35:05 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:35:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5004L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:35:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:35:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:35:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:35:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:35:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:35:05 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:35:05 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:35:05 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:35:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:35:05 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:35:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:35:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:35:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5004L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :  :  :  :- Project [rid#5106 AS rid_1#5151, cpfk_orders_lineitem#5107 AS cpfk_orders_lineitem_1#5152, cpfk_supplier_lineitem#5108 AS cpfk_supplier_lineitem_1#5153, cfpk_lineitem_supplier#5109 AS cfpk_lineitem_supplier_1#5154, cfpk_lineitem_partsupp#5110 AS cfpk_lineitem_partsupp_1#5155, cpfk_part_lineitem#5111 AS cpfk_part_lineitem_1#5156, cfpk_lineitem_part#5112 AS cfpk_lineitem_part_1#5157, cpfk_partsupp_lineitem#5113 AS cpfk_partsupp_lineitem_1#5158, cfpk_lineitem_orders#5114 AS cfpk_lineitem_orders_1#5159, cval_lineitem_l_quantity#5115 AS cval_lineitem_l_quantity_1#5160, cval_lineitem_l_extendedprice#5116 AS cval_lineitem_l_extendedprice_1#5161, cval_lineitem_l_discount#5117 AS cval_lineitem_l_discount_1#5162, cval_lineitem_l_tax#5118 AS cval_lineitem_l_tax_1#5163, cval_lineitem_l_returnflag#5119 AS cval_lineitem_l_returnflag_1#5164, cval_lineitem_l_linestatus#5120 AS cval_lineitem_l_linestatus_1#5165, cval_lineitem_l_commitdate#5121 AS cval_lineitem_l_commitdate_1#5166, cval_lineitem_l_receiptdate#5122 AS cval_lineitem_l_receiptdate_1#5167, cval_lineitem_l_shipinstruct#5123 AS cval_lineitem_l_shipinstruct_1#5168, cval_lineitem_l_shipmode#5124 AS cval_lineitem_l_shipmode_1#5169, cval_lineitem_l_comment#5125 AS cval_lineitem_l_comment_1#5170, cval_lineitem_l_shipdate#5126 AS cval_lineitem_l_shipdate_1#5171, cdepval_lineitem_l_quantity#5127 AS cdepval_lineitem_l_quantity_1#5172, cdepval_lineitem_l_extendedprice#5128 AS cdepval_lineitem_l_extendedprice_1#5173, cdepval_lineitem_l_discount#5129 AS cdepval_lineitem_l_discount_1#5174, ... 21 more fields]
         :  :  :  :  +- Relation[rid#5106,cpfk_orders_lineitem#5107,cpfk_supplier_lineitem#5108,cfpk_lineitem_supplier#5109,cfpk_lineitem_partsupp#5110,cpfk_part_lineitem#5111,cfpk_lineitem_part#5112,cpfk_partsupp_lineitem#5113,cfpk_lineitem_orders#5114,cval_lineitem_l_quantity#5115,cval_lineitem_l_extendedprice#5116,cval_lineitem_l_discount#5117,cval_lineitem_l_tax#5118,cval_lineitem_l_returnflag#5119,cval_lineitem_l_linestatus#5120,cval_lineitem_l_commitdate#5121,cval_lineitem_l_receiptdate#5122,cval_lineitem_l_shipinstruct#5123,cval_lineitem_l_shipmode#5124,cval_lineitem_l_comment#5125,cval_lineitem_l_shipdate#5126,cdepval_lineitem_l_quantity#5127,cdepval_lineitem_l_extendedprice#5128,cdepval_lineitem_l_discount#5129,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :     +- Project [rid#5006 AS rid_0#5031, cval_part_p_name#5007 AS cval_part_p_name_0#5032, cval_part_p_mfgr#5008 AS cval_part_p_mfgr_0#5033, cval_part_p_type#5009 AS cval_part_p_type_0#5034, cval_part_p_size#5010 AS cval_part_p_size_0#5035, cval_part_p_container#5011 AS cval_part_p_container_0#5036, cval_part_p_retailprice#5012 AS cval_part_p_retailprice_0#5037, cval_part_p_comment#5013 AS cval_part_p_comment_0#5038, cval_part_p_brand#5014 AS cval_part_p_brand_0#5039, cdepval_part_p_name#5015 AS cdepval_part_p_name_0#5040, cdepval_part_p_mfgr#5016 AS cdepval_part_p_mfgr_0#5041, cdepval_part_p_type#5017 AS cdepval_part_p_type_0#5042, cdepval_part_p_size#5018 AS cdepval_part_p_size_0#5043, cdepval_part_p_container#5019 AS cdepval_part_p_container_0#5044, cdepval_part_p_retailprice#5020 AS cdepval_part_p_retailprice_0#5045, cdepval_part_p_comment#5021 AS cdepval_part_p_comment_0#5046, cdepval_part_p_brand#5022 AS cdepval_part_p_brand_0#5047, cp_name#5023 AS cp_name_0#5048, cp_mfgr#5024 AS cp_mfgr_0#5049, cp_type#5025 AS cp_type_0#5050, cp_size#5026 AS cp_size_0#5051, cp_container#5027 AS cp_container_0#5052, cp_retailprice#5028 AS cp_retailprice_0#5053, cp_comment#5029 AS cp_comment_0#5054, cp_brand#5030 AS cp_brand_0#5055]
         :  :  :        +- Relation[rid#5006,cval_part_p_name#5007,cval_part_p_mfgr#5008,cval_part_p_type#5009,cval_part_p_size#5010,cval_part_p_container#5011,cval_part_p_retailprice#5012,cval_part_p_comment#5013,cval_part_p_brand#5014,cdepval_part_p_name#5015,cdepval_part_p_mfgr#5016,cdepval_part_p_type#5017,cdepval_part_p_size#5018,cdepval_part_p_container#5019,cdepval_part_p_retailprice#5020,cdepval_part_p_comment#5021,cdepval_part_p_brand#5022,cp_name#5023,cp_mfgr#5024,cp_type#5025,cp_size#5026,cp_container#5027,cp_retailprice#5028,cp_comment#5029,cp_brand#5030] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- Project [rid#5196 AS rid_2#5214, cpfk_nation_supplier#5197 AS cpfk_nation_supplier_2#5215, cfpk_supplier_nation#5198 AS cfpk_supplier_nation_2#5216, cval_supplier_s_name#5199 AS cval_supplier_s_name_2#5217, cval_supplier_s_address#5200 AS cval_supplier_s_address_2#5218, cval_supplier_s_phone#5201 AS cval_supplier_s_phone_2#5219, cval_supplier_s_acctbal#5202 AS cval_supplier_s_acctbal_2#5220, cval_supplier_s_comment#5203 AS cval_supplier_s_comment_2#5221, cdepval_supplier_s_name#5204 AS cdepval_supplier_s_name_2#5222, cdepval_supplier_s_address#5205 AS cdepval_supplier_s_address_2#5223, cdepval_supplier_s_phone#5206 AS cdepval_supplier_s_phone_2#5224, cdepval_supplier_s_acctbal#5207 AS cdepval_supplier_s_acctbal_2#5225, cdepval_supplier_s_comment#5208 AS cdepval_supplier_s_comment_2#5226, cs_name#5209 AS cs_name_2#5227, cs_address#5210 AS cs_address_2#5228, cs_phone#5211 AS cs_phone_2#5229, cs_acctbal#5212 AS cs_acctbal_2#5230, cs_comment#5213 AS cs_comment_2#5231]
         :  :     +- Relation[rid#5196,cpfk_nation_supplier#5197,cfpk_supplier_nation#5198,cval_supplier_s_name#5199,cval_supplier_s_address#5200,cval_supplier_s_phone#5201,cval_supplier_s_acctbal#5202,cval_supplier_s_comment#5203,cdepval_supplier_s_name#5204,cdepval_supplier_s_address#5205,cdepval_supplier_s_phone#5206,cdepval_supplier_s_acctbal#5207,cdepval_supplier_s_comment#5208,cs_name#5209,cs_address#5210,cs_phone#5211,cs_acctbal#5212,cs_comment#5213] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#5232 AS rid_3#5241, cpfk_region_nation#5233 AS cpfk_region_nation_3#5242, cfpk_nation_region#5234 AS cfpk_nation_region_3#5243, cval_nation_n_name#5235 AS cval_nation_n_name_3#5244, cval_nation_n_comment#5236 AS cval_nation_n_comment_3#5245, cdepval_nation_n_name#5237 AS cdepval_nation_n_name_3#5246, cdepval_nation_n_comment#5238 AS cdepval_nation_n_comment_3#5247, cn_name#5239 AS cn_name_3#5248, cn_comment#5240 AS cn_comment_3#5249]
         :     +- Relation[rid#5232,cpfk_region_nation#5233,cfpk_nation_region#5234,cval_nation_n_name#5235,cval_nation_n_comment#5236,cdepval_nation_n_name#5237,cdepval_nation_n_comment#5238,cn_name#5239,cn_comment#5240] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#5338 AS rid_7#5362, cpfk_customer_orders#5339 AS cpfk_customer_orders_7#5363, cfpk_orders_customer#5340 AS cfpk_orders_customer_7#5364, cval_orders_o_orderstatus#5341 AS cval_orders_o_orderstatus_7#5365, cval_orders_o_totalprice#5342 AS cval_orders_o_totalprice_7#5366, cval_orders_o_orderpriority#5343 AS cval_orders_o_orderpriority_7#5367, cval_orders_o_clerk#5344 AS cval_orders_o_clerk_7#5368, cval_orders_o_shippriority#5345 AS cval_orders_o_shippriority_7#5369, cval_orders_o_comment#5346 AS cval_orders_o_comment_7#5370, cval_orders_o_orderdate#5347 AS cval_orders_o_orderdate_7#5371, cdepval_orders_o_orderstatus#5348 AS cdepval_orders_o_orderstatus_7#5372, cdepval_orders_o_totalprice#5349 AS cdepval_orders_o_totalprice_7#5373, cdepval_orders_o_orderpriority#5350 AS cdepval_orders_o_orderpriority_7#5374, cdepval_orders_o_clerk#5351 AS cdepval_orders_o_clerk_7#5375, cdepval_orders_o_shippriority#5352 AS cdepval_orders_o_shippriority_7#5376, cdepval_orders_o_comment#5353 AS cdepval_orders_o_comment_7#5377, cdepval_orders_o_orderdate#5354 AS cdepval_orders_o_orderdate_7#5378, co_orderstatus#5355 AS co_orderstatus_7#5379, co_totalprice#5356 AS co_totalprice_7#5380, co_orderpriority#5357 AS co_orderpriority_7#5381, co_clerk#5358 AS co_clerk_7#5382, co_shippriority#5359 AS co_shippriority_7#5383, co_comment#5360 AS co_comment_7#5384, co_orderdate#5361 AS co_orderdate_7#5385]
            :  +- Relation[rid#5338,cpfk_customer_orders#5339,cfpk_orders_customer#5340,cval_orders_o_orderstatus#5341,cval_orders_o_totalprice#5342,cval_orders_o_orderpriority#5343,cval_orders_o_clerk#5344,cval_orders_o_shippriority#5345,cval_orders_o_comment#5346,cval_orders_o_orderdate#5347,cdepval_orders_o_orderstatus#5348,cdepval_orders_o_totalprice#5349,cdepval_orders_o_orderpriority#5350,cdepval_orders_o_clerk#5351,cdepval_orders_o_shippriority#5352,cdepval_orders_o_comment#5353,cdepval_orders_o_orderdate#5354,co_orderstatus#5355,co_totalprice#5356,co_orderpriority#5357,co_clerk#5358,co_shippriority#5359,co_comment#5360,co_orderdate#5361] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#5296 AS rid_6#5317, cpfk_nation_customer#5297 AS cpfk_nation_customer_6#5318, cfpk_customer_nation#5298 AS cfpk_customer_nation_6#5319, cval_customer_c_name#5299 AS cval_customer_c_name_6#5320, cval_customer_c_address#5300 AS cval_customer_c_address_6#5321, cval_customer_c_phone#5301 AS cval_customer_c_phone_6#5322, cval_customer_c_acctbal#5302 AS cval_customer_c_acctbal_6#5323, cval_customer_c_comment#5303 AS cval_customer_c_comment_6#5324, cval_customer_c_mktsegment#5304 AS cval_customer_c_mktsegment_6#5325, cdepval_customer_c_name#5305 AS cdepval_customer_c_name_6#5326, cdepval_customer_c_address#5306 AS cdepval_customer_c_address_6#5327, cdepval_customer_c_phone#5307 AS cdepval_customer_c_phone_6#5328, cdepval_customer_c_acctbal#5308 AS cdepval_customer_c_acctbal_6#5329, cdepval_customer_c_comment#5309 AS cdepval_customer_c_comment_6#5330, cdepval_customer_c_mktsegment#5310 AS cdepval_customer_c_mktsegment_6#5331, cc_name#5311 AS cc_name_6#5332, cc_address#5312 AS cc_address_6#5333, cc_phone#5313 AS cc_phone_6#5334, cc_acctbal#5314 AS cc_acctbal_6#5335, cc_comment#5315 AS cc_comment_6#5336, cc_mktsegment#5316 AS cc_mktsegment_6#5337]
               :  +- Relation[rid#5296,cpfk_nation_customer#5297,cfpk_customer_nation#5298,cval_customer_c_name#5299,cval_customer_c_address#5300,cval_customer_c_phone#5301,cval_customer_c_acctbal#5302,cval_customer_c_comment#5303,cval_customer_c_mktsegment#5304,cdepval_customer_c_name#5305,cdepval_customer_c_address#5306,cdepval_customer_c_phone#5307,cdepval_customer_c_acctbal#5308,cdepval_customer_c_comment#5309,cdepval_customer_c_mktsegment#5310,cc_name#5311,cc_address#5312,cc_phone#5313,cc_acctbal#5314,cc_comment#5315,cc_mktsegment#5316] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_5, BinaryType)), 'cfpk_nation_region_5) = 'rid_4)
                  :- Project [rid#5278 AS rid_5#5287, cpfk_region_nation#5279 AS cpfk_region_nation_5#5288, cfpk_nation_region#5280 AS cfpk_nation_region_5#5289, cval_nation_n_name#5281 AS cval_nation_n_name_5#5290, cval_nation_n_comment#5282 AS cval_nation_n_comment_5#5291, cdepval_nation_n_name#5283 AS cdepval_nation_n_name_5#5292, cdepval_nation_n_comment#5284 AS cdepval_nation_n_comment_5#5293, cn_name#5285 AS cn_name_5#5294, cn_comment#5286 AS cn_comment_5#5295]
                  :  +- Relation[rid#5278,cpfk_region_nation#5279,cfpk_nation_region#5280,cval_nation_n_name#5281,cval_nation_n_comment#5282,cdepval_nation_n_name#5283,cdepval_nation_n_comment#5284,cn_name#5285,cn_comment#5286] JDBCRelation(tnation) [numPartitions=1]
                  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                     +- Project [rid#5250 AS rid_4#5257, cval_region_r_name#5251 AS cval_region_r_name_4#5258, cval_region_r_comment#5252 AS cval_region_r_comment_4#5259, cdepval_region_r_name#5253 AS cdepval_region_r_name_4#5260, cdepval_region_r_comment#5254 AS cdepval_region_r_comment_4#5261, cr_name#5255 AS cr_name_4#5262, cr_comment#5256 AS cr_comment_4#5263]
                        +- Relation[rid#5250,cval_region_r_name#5251,cval_region_r_comment#5252,cdepval_region_r_name#5253,cdepval_region_r_comment#5254,cr_name#5255,cr_comment#5256] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 44837ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/25 22:35:50 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:35:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5556L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 22:35:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:35:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:35:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5556L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#5558 AS rid_0#5603, cpfk_orders_lineitem#5559 AS cpfk_orders_lineitem_0#5604, cpfk_supplier_lineitem#5560 AS cpfk_supplier_lineitem_0#5605, cfpk_lineitem_supplier#5561 AS cfpk_lineitem_supplier_0#5606, cfpk_lineitem_partsupp#5562 AS cfpk_lineitem_partsupp_0#5607, cpfk_part_lineitem#5563 AS cpfk_part_lineitem_0#5608, cfpk_lineitem_part#5564 AS cfpk_lineitem_part_0#5609, cpfk_partsupp_lineitem#5565 AS cpfk_partsupp_lineitem_0#5610, cfpk_lineitem_orders#5566 AS cfpk_lineitem_orders_0#5611, cval_lineitem_l_quantity#5567 AS cval_lineitem_l_quantity_0#5612, cval_lineitem_l_extendedprice#5568 AS cval_lineitem_l_extendedprice_0#5613, cval_lineitem_l_discount#5569 AS cval_lineitem_l_discount_0#5614, cval_lineitem_l_tax#5570 AS cval_lineitem_l_tax_0#5615, cval_lineitem_l_returnflag#5571 AS cval_lineitem_l_returnflag_0#5616, cval_lineitem_l_linestatus#5572 AS cval_lineitem_l_linestatus_0#5617, cval_lineitem_l_commitdate#5573 AS cval_lineitem_l_commitdate_0#5618, cval_lineitem_l_receiptdate#5574 AS cval_lineitem_l_receiptdate_0#5619, cval_lineitem_l_shipinstruct#5575 AS cval_lineitem_l_shipinstruct_0#5620, cval_lineitem_l_shipmode#5576 AS cval_lineitem_l_shipmode_0#5621, cval_lineitem_l_comment#5577 AS cval_lineitem_l_comment_0#5622, cval_lineitem_l_shipdate#5578 AS cval_lineitem_l_shipdate_0#5623, cdepval_lineitem_l_quantity#5579 AS cdepval_lineitem_l_quantity_0#5624, cdepval_lineitem_l_extendedprice#5580 AS cdepval_lineitem_l_extendedprice_0#5625, cdepval_lineitem_l_discount#5581 AS cdepval_lineitem_l_discount_0#5626, ... 21 more fields]
         :  :  :     +- Relation[rid#5558,cpfk_orders_lineitem#5559,cpfk_supplier_lineitem#5560,cfpk_lineitem_supplier#5561,cfpk_lineitem_partsupp#5562,cpfk_part_lineitem#5563,cfpk_lineitem_part#5564,cpfk_partsupp_lineitem#5565,cfpk_lineitem_orders#5566,cval_lineitem_l_quantity#5567,cval_lineitem_l_extendedprice#5568,cval_lineitem_l_discount#5569,cval_lineitem_l_tax#5570,cval_lineitem_l_returnflag#5571,cval_lineitem_l_linestatus#5572,cval_lineitem_l_commitdate#5573,cval_lineitem_l_receiptdate#5574,cval_lineitem_l_shipinstruct#5575,cval_lineitem_l_shipmode#5576,cval_lineitem_l_comment#5577,cval_lineitem_l_shipdate#5578,cdepval_lineitem_l_quantity#5579,cdepval_lineitem_l_extendedprice#5580,cdepval_lineitem_l_discount#5581,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#5738 AS rid_1#5762, cpfk_customer_orders#5739 AS cpfk_customer_orders_1#5763, cfpk_orders_customer#5740 AS cfpk_orders_customer_1#5764, cval_orders_o_orderstatus#5741 AS cval_orders_o_orderstatus_1#5765, cval_orders_o_totalprice#5742 AS cval_orders_o_totalprice_1#5766, cval_orders_o_orderpriority#5743 AS cval_orders_o_orderpriority_1#5767, cval_orders_o_clerk#5744 AS cval_orders_o_clerk_1#5768, cval_orders_o_shippriority#5745 AS cval_orders_o_shippriority_1#5769, cval_orders_o_comment#5746 AS cval_orders_o_comment_1#5770, cval_orders_o_orderdate#5747 AS cval_orders_o_orderdate_1#5771, cdepval_orders_o_orderstatus#5748 AS cdepval_orders_o_orderstatus_1#5772, cdepval_orders_o_totalprice#5749 AS cdepval_orders_o_totalprice_1#5773, cdepval_orders_o_orderpriority#5750 AS cdepval_orders_o_orderpriority_1#5774, cdepval_orders_o_clerk#5751 AS cdepval_orders_o_clerk_1#5775, cdepval_orders_o_shippriority#5752 AS cdepval_orders_o_shippriority_1#5776, cdepval_orders_o_comment#5753 AS cdepval_orders_o_comment_1#5777, cdepval_orders_o_orderdate#5754 AS cdepval_orders_o_orderdate_1#5778, co_orderstatus#5755 AS co_orderstatus_1#5779, co_totalprice#5756 AS co_totalprice_1#5780, co_orderpriority#5757 AS co_orderpriority_1#5781, co_clerk#5758 AS co_clerk_1#5782, co_shippriority#5759 AS co_shippriority_1#5783, co_comment#5760 AS co_comment_1#5784, co_orderdate#5761 AS co_orderdate_1#5785]
         :  :     +- Relation[rid#5738,cpfk_customer_orders#5739,cfpk_orders_customer#5740,cval_orders_o_orderstatus#5741,cval_orders_o_totalprice#5742,cval_orders_o_orderpriority#5743,cval_orders_o_clerk#5744,cval_orders_o_shippriority#5745,cval_orders_o_comment#5746,cval_orders_o_orderdate#5747,cdepval_orders_o_orderstatus#5748,cdepval_orders_o_totalprice#5749,cdepval_orders_o_orderpriority#5750,cdepval_orders_o_clerk#5751,cdepval_orders_o_shippriority#5752,cdepval_orders_o_comment#5753,cdepval_orders_o_orderdate#5754,co_orderstatus#5755,co_totalprice#5756,co_orderpriority#5757,co_clerk#5758,co_shippriority#5759,co_comment#5760,co_orderdate#5761] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#5786 AS rid_2#5807, cpfk_nation_customer#5787 AS cpfk_nation_customer_2#5808, cfpk_customer_nation#5788 AS cfpk_customer_nation_2#5809, cval_customer_c_name#5789 AS cval_customer_c_name_2#5810, cval_customer_c_address#5790 AS cval_customer_c_address_2#5811, cval_customer_c_phone#5791 AS cval_customer_c_phone_2#5812, cval_customer_c_acctbal#5792 AS cval_customer_c_acctbal_2#5813, cval_customer_c_comment#5793 AS cval_customer_c_comment_2#5814, cval_customer_c_mktsegment#5794 AS cval_customer_c_mktsegment_2#5815, cdepval_customer_c_name#5795 AS cdepval_customer_c_name_2#5816, cdepval_customer_c_address#5796 AS cdepval_customer_c_address_2#5817, cdepval_customer_c_phone#5797 AS cdepval_customer_c_phone_2#5818, cdepval_customer_c_acctbal#5798 AS cdepval_customer_c_acctbal_2#5819, cdepval_customer_c_comment#5799 AS cdepval_customer_c_comment_2#5820, cdepval_customer_c_mktsegment#5800 AS cdepval_customer_c_mktsegment_2#5821, cc_name#5801 AS cc_name_2#5822, cc_address#5802 AS cc_address_2#5823, cc_phone#5803 AS cc_phone_2#5824, cc_acctbal#5804 AS cc_acctbal_2#5825, cc_comment#5805 AS cc_comment_2#5826, cc_mktsegment#5806 AS cc_mktsegment_2#5827]
         :     +- Relation[rid#5786,cpfk_nation_customer#5787,cfpk_customer_nation#5788,cval_customer_c_name#5789,cval_customer_c_address#5790,cval_customer_c_phone#5791,cval_customer_c_acctbal#5792,cval_customer_c_comment#5793,cval_customer_c_mktsegment#5794,cdepval_customer_c_name#5795,cdepval_customer_c_address#5796,cdepval_customer_c_phone#5797,cdepval_customer_c_acctbal#5798,cdepval_customer_c_comment#5799,cdepval_customer_c_mktsegment#5800,cc_name#5801,cc_address#5802,cc_phone#5803,cc_acctbal#5804,cc_comment#5805,cc_mktsegment#5806] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#5828 AS rid_3#5837, cpfk_region_nation#5829 AS cpfk_region_nation_3#5838, cfpk_nation_region#5830 AS cfpk_nation_region_3#5839, cval_nation_n_name#5831 AS cval_nation_n_name_3#5840, cval_nation_n_comment#5832 AS cval_nation_n_comment_3#5841, cdepval_nation_n_name#5833 AS cdepval_nation_n_name_3#5842, cdepval_nation_n_comment#5834 AS cdepval_nation_n_comment_3#5843, cn_name#5835 AS cn_name_3#5844, cn_comment#5836 AS cn_comment_3#5845]
            +- Relation[rid#5828,cpfk_region_nation#5829,cfpk_nation_region#5830,cval_nation_n_name#5831,cval_nation_n_comment#5832,cdepval_nation_n_name#5833,cdepval_nation_n_comment#5834,cn_name#5835,cn_comment#5836] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 59033ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/25 22:36:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:36:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5951L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:36:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5951L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#6003 AS rid_1#6048, cpfk_orders_lineitem#6004 AS cpfk_orders_lineitem_1#6049, cpfk_supplier_lineitem#6005 AS cpfk_supplier_lineitem_1#6050, cfpk_lineitem_supplier#6006 AS cfpk_lineitem_supplier_1#6051, cfpk_lineitem_partsupp#6007 AS cfpk_lineitem_partsupp_1#6052, cpfk_part_lineitem#6008 AS cpfk_part_lineitem_1#6053, cfpk_lineitem_part#6009 AS cfpk_lineitem_part_1#6054, cpfk_partsupp_lineitem#6010 AS cpfk_partsupp_lineitem_1#6055, cfpk_lineitem_orders#6011 AS cfpk_lineitem_orders_1#6056, cval_lineitem_l_quantity#6012 AS cval_lineitem_l_quantity_1#6057, cval_lineitem_l_extendedprice#6013 AS cval_lineitem_l_extendedprice_1#6058, cval_lineitem_l_discount#6014 AS cval_lineitem_l_discount_1#6059, cval_lineitem_l_tax#6015 AS cval_lineitem_l_tax_1#6060, cval_lineitem_l_returnflag#6016 AS cval_lineitem_l_returnflag_1#6061, cval_lineitem_l_linestatus#6017 AS cval_lineitem_l_linestatus_1#6062, cval_lineitem_l_commitdate#6018 AS cval_lineitem_l_commitdate_1#6063, cval_lineitem_l_receiptdate#6019 AS cval_lineitem_l_receiptdate_1#6064, cval_lineitem_l_shipinstruct#6020 AS cval_lineitem_l_shipinstruct_1#6065, cval_lineitem_l_shipmode#6021 AS cval_lineitem_l_shipmode_1#6066, cval_lineitem_l_comment#6022 AS cval_lineitem_l_comment_1#6067, cval_lineitem_l_shipdate#6023 AS cval_lineitem_l_shipdate_1#6068, cdepval_lineitem_l_quantity#6024 AS cdepval_lineitem_l_quantity_1#6069, cdepval_lineitem_l_extendedprice#6025 AS cdepval_lineitem_l_extendedprice_1#6070, cdepval_lineitem_l_discount#6026 AS cdepval_lineitem_l_discount_1#6071, ... 21 more fields]
         :  +- Relation[rid#6003,cpfk_orders_lineitem#6004,cpfk_supplier_lineitem#6005,cfpk_lineitem_supplier#6006,cfpk_lineitem_partsupp#6007,cpfk_part_lineitem#6008,cfpk_lineitem_part#6009,cpfk_partsupp_lineitem#6010,cfpk_lineitem_orders#6011,cval_lineitem_l_quantity#6012,cval_lineitem_l_extendedprice#6013,cval_lineitem_l_discount#6014,cval_lineitem_l_tax#6015,cval_lineitem_l_returnflag#6016,cval_lineitem_l_linestatus#6017,cval_lineitem_l_commitdate#6018,cval_lineitem_l_receiptdate#6019,cval_lineitem_l_shipinstruct#6020,cval_lineitem_l_shipmode#6021,cval_lineitem_l_comment#6022,cval_lineitem_l_shipdate#6023,cdepval_lineitem_l_quantity#6024,cdepval_lineitem_l_extendedprice#6025,cdepval_lineitem_l_discount#6026,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5953 AS rid_0#5978, cval_part_p_name#5954 AS cval_part_p_name_0#5979, cval_part_p_mfgr#5955 AS cval_part_p_mfgr_0#5980, cval_part_p_type#5956 AS cval_part_p_type_0#5981, cval_part_p_size#5957 AS cval_part_p_size_0#5982, cval_part_p_container#5958 AS cval_part_p_container_0#5983, cval_part_p_retailprice#5959 AS cval_part_p_retailprice_0#5984, cval_part_p_comment#5960 AS cval_part_p_comment_0#5985, cval_part_p_brand#5961 AS cval_part_p_brand_0#5986, cdepval_part_p_name#5962 AS cdepval_part_p_name_0#5987, cdepval_part_p_mfgr#5963 AS cdepval_part_p_mfgr_0#5988, cdepval_part_p_type#5964 AS cdepval_part_p_type_0#5989, cdepval_part_p_size#5965 AS cdepval_part_p_size_0#5990, cdepval_part_p_container#5966 AS cdepval_part_p_container_0#5991, cdepval_part_p_retailprice#5967 AS cdepval_part_p_retailprice_0#5992, cdepval_part_p_comment#5968 AS cdepval_part_p_comment_0#5993, cdepval_part_p_brand#5969 AS cdepval_part_p_brand_0#5994, cp_name#5970 AS cp_name_0#5995, cp_mfgr#5971 AS cp_mfgr_0#5996, cp_type#5972 AS cp_type_0#5997, cp_size#5973 AS cp_size_0#5998, cp_container#5974 AS cp_container_0#5999, cp_retailprice#5975 AS cp_retailprice_0#6000, cp_comment#5976 AS cp_comment_0#6001, cp_brand#5977 AS cp_brand_0#6002]
            +- Relation[rid#5953,cval_part_p_name#5954,cval_part_p_mfgr#5955,cval_part_p_type#5956,cval_part_p_size#5957,cval_part_p_container#5958,cval_part_p_retailprice#5959,cval_part_p_comment#5960,cval_part_p_brand#5961,cdepval_part_p_name#5962,cdepval_part_p_mfgr#5963,cdepval_part_p_type#5964,cdepval_part_p_size#5965,cdepval_part_p_container#5966,cdepval_part_p_retailprice#5967,cdepval_part_p_comment#5968,cdepval_part_p_brand#5969,cp_name#5970,cp_mfgr#5971,cp_type#5972,cp_size#5973,cp_container#5974,cp_retailprice#5975,cp_comment#5976,cp_brand#5977] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17896ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/25 22:37:07 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:37:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6170L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:37:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:37:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:37:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6170L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#6208 AS rid_1#6253, cpfk_orders_lineitem#6209 AS cpfk_orders_lineitem_1#6254, cpfk_supplier_lineitem#6210 AS cpfk_supplier_lineitem_1#6255, cfpk_lineitem_supplier#6211 AS cfpk_lineitem_supplier_1#6256, cfpk_lineitem_partsupp#6212 AS cfpk_lineitem_partsupp_1#6257, cpfk_part_lineitem#6213 AS cpfk_part_lineitem_1#6258, cfpk_lineitem_part#6214 AS cfpk_lineitem_part_1#6259, cpfk_partsupp_lineitem#6215 AS cpfk_partsupp_lineitem_1#6260, cfpk_lineitem_orders#6216 AS cfpk_lineitem_orders_1#6261, cval_lineitem_l_quantity#6217 AS cval_lineitem_l_quantity_1#6262, cval_lineitem_l_extendedprice#6218 AS cval_lineitem_l_extendedprice_1#6263, cval_lineitem_l_discount#6219 AS cval_lineitem_l_discount_1#6264, cval_lineitem_l_tax#6220 AS cval_lineitem_l_tax_1#6265, cval_lineitem_l_returnflag#6221 AS cval_lineitem_l_returnflag_1#6266, cval_lineitem_l_linestatus#6222 AS cval_lineitem_l_linestatus_1#6267, cval_lineitem_l_commitdate#6223 AS cval_lineitem_l_commitdate_1#6268, cval_lineitem_l_receiptdate#6224 AS cval_lineitem_l_receiptdate_1#6269, cval_lineitem_l_shipinstruct#6225 AS cval_lineitem_l_shipinstruct_1#6270, cval_lineitem_l_shipmode#6226 AS cval_lineitem_l_shipmode_1#6271, cval_lineitem_l_comment#6227 AS cval_lineitem_l_comment_1#6272, cval_lineitem_l_shipdate#6228 AS cval_lineitem_l_shipdate_1#6273, cdepval_lineitem_l_quantity#6229 AS cdepval_lineitem_l_quantity_1#6274, cdepval_lineitem_l_extendedprice#6230 AS cdepval_lineitem_l_extendedprice_1#6275, cdepval_lineitem_l_discount#6231 AS cdepval_lineitem_l_discount_1#6276, ... 21 more fields]
         :  +- Relation[rid#6208,cpfk_orders_lineitem#6209,cpfk_supplier_lineitem#6210,cfpk_lineitem_supplier#6211,cfpk_lineitem_partsupp#6212,cpfk_part_lineitem#6213,cfpk_lineitem_part#6214,cpfk_partsupp_lineitem#6215,cfpk_lineitem_orders#6216,cval_lineitem_l_quantity#6217,cval_lineitem_l_extendedprice#6218,cval_lineitem_l_discount#6219,cval_lineitem_l_tax#6220,cval_lineitem_l_returnflag#6221,cval_lineitem_l_linestatus#6222,cval_lineitem_l_commitdate#6223,cval_lineitem_l_receiptdate#6224,cval_lineitem_l_shipinstruct#6225,cval_lineitem_l_shipmode#6226,cval_lineitem_l_comment#6227,cval_lineitem_l_shipdate#6228,cdepval_lineitem_l_quantity#6229,cdepval_lineitem_l_extendedprice#6230,cdepval_lineitem_l_discount#6231,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6172 AS rid_0#6190, cpfk_nation_supplier#6173 AS cpfk_nation_supplier_0#6191, cfpk_supplier_nation#6174 AS cfpk_supplier_nation_0#6192, cval_supplier_s_name#6175 AS cval_supplier_s_name_0#6193, cval_supplier_s_address#6176 AS cval_supplier_s_address_0#6194, cval_supplier_s_phone#6177 AS cval_supplier_s_phone_0#6195, cval_supplier_s_acctbal#6178 AS cval_supplier_s_acctbal_0#6196, cval_supplier_s_comment#6179 AS cval_supplier_s_comment_0#6197, cdepval_supplier_s_name#6180 AS cdepval_supplier_s_name_0#6198, cdepval_supplier_s_address#6181 AS cdepval_supplier_s_address_0#6199, cdepval_supplier_s_phone#6182 AS cdepval_supplier_s_phone_0#6200, cdepval_supplier_s_acctbal#6183 AS cdepval_supplier_s_acctbal_0#6201, cdepval_supplier_s_comment#6184 AS cdepval_supplier_s_comment_0#6202, cs_name#6185 AS cs_name_0#6203, cs_address#6186 AS cs_address_0#6204, cs_phone#6187 AS cs_phone_0#6205, cs_acctbal#6188 AS cs_acctbal_0#6206, cs_comment#6189 AS cs_comment_0#6207]
            +- Relation[rid#6172,cpfk_nation_supplier#6173,cfpk_supplier_nation#6174,cval_supplier_s_name#6175,cval_supplier_s_address#6176,cval_supplier_s_phone#6177,cval_supplier_s_acctbal#6178,cval_supplier_s_comment#6179,cdepval_supplier_s_name#6180,cdepval_supplier_s_address#6181,cdepval_supplier_s_phone#6182,cdepval_supplier_s_acctbal#6183,cdepval_supplier_s_comment#6184,cs_name#6185,cs_address#6186,cs_phone#6187,cs_acctbal#6188,cs_comment#6189] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17246ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/25 22:37:24 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:37:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6389L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:37:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6389L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#6391 AS rid_0#6436, cpfk_orders_lineitem#6392 AS cpfk_orders_lineitem_0#6437, cpfk_supplier_lineitem#6393 AS cpfk_supplier_lineitem_0#6438, cfpk_lineitem_supplier#6394 AS cfpk_lineitem_supplier_0#6439, cfpk_lineitem_partsupp#6395 AS cfpk_lineitem_partsupp_0#6440, cpfk_part_lineitem#6396 AS cpfk_part_lineitem_0#6441, cfpk_lineitem_part#6397 AS cfpk_lineitem_part_0#6442, cpfk_partsupp_lineitem#6398 AS cpfk_partsupp_lineitem_0#6443, cfpk_lineitem_orders#6399 AS cfpk_lineitem_orders_0#6444, cval_lineitem_l_quantity#6400 AS cval_lineitem_l_quantity_0#6445, cval_lineitem_l_extendedprice#6401 AS cval_lineitem_l_extendedprice_0#6446, cval_lineitem_l_discount#6402 AS cval_lineitem_l_discount_0#6447, cval_lineitem_l_tax#6403 AS cval_lineitem_l_tax_0#6448, cval_lineitem_l_returnflag#6404 AS cval_lineitem_l_returnflag_0#6449, cval_lineitem_l_linestatus#6405 AS cval_lineitem_l_linestatus_0#6450, cval_lineitem_l_commitdate#6406 AS cval_lineitem_l_commitdate_0#6451, cval_lineitem_l_receiptdate#6407 AS cval_lineitem_l_receiptdate_0#6452, cval_lineitem_l_shipinstruct#6408 AS cval_lineitem_l_shipinstruct_0#6453, cval_lineitem_l_shipmode#6409 AS cval_lineitem_l_shipmode_0#6454, cval_lineitem_l_comment#6410 AS cval_lineitem_l_comment_0#6455, cval_lineitem_l_shipdate#6411 AS cval_lineitem_l_shipdate_0#6456, cdepval_lineitem_l_quantity#6412 AS cdepval_lineitem_l_quantity_0#6457, cdepval_lineitem_l_extendedprice#6413 AS cdepval_lineitem_l_extendedprice_0#6458, cdepval_lineitem_l_discount#6414 AS cdepval_lineitem_l_discount_0#6459, ... 21 more fields]
         :  +- Relation[rid#6391,cpfk_orders_lineitem#6392,cpfk_supplier_lineitem#6393,cfpk_lineitem_supplier#6394,cfpk_lineitem_partsupp#6395,cpfk_part_lineitem#6396,cfpk_lineitem_part#6397,cpfk_partsupp_lineitem#6398,cfpk_lineitem_orders#6399,cval_lineitem_l_quantity#6400,cval_lineitem_l_extendedprice#6401,cval_lineitem_l_discount#6402,cval_lineitem_l_tax#6403,cval_lineitem_l_returnflag#6404,cval_lineitem_l_linestatus#6405,cval_lineitem_l_commitdate#6406,cval_lineitem_l_receiptdate#6407,cval_lineitem_l_shipinstruct#6408,cval_lineitem_l_shipmode#6409,cval_lineitem_l_comment#6410,cval_lineitem_l_shipdate#6411,cdepval_lineitem_l_quantity#6412,cdepval_lineitem_l_extendedprice#6413,cdepval_lineitem_l_discount#6414,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6481 AS rid_1#6505, cpfk_customer_orders#6482 AS cpfk_customer_orders_1#6506, cfpk_orders_customer#6483 AS cfpk_orders_customer_1#6507, cval_orders_o_orderstatus#6484 AS cval_orders_o_orderstatus_1#6508, cval_orders_o_totalprice#6485 AS cval_orders_o_totalprice_1#6509, cval_orders_o_orderpriority#6486 AS cval_orders_o_orderpriority_1#6510, cval_orders_o_clerk#6487 AS cval_orders_o_clerk_1#6511, cval_orders_o_shippriority#6488 AS cval_orders_o_shippriority_1#6512, cval_orders_o_comment#6489 AS cval_orders_o_comment_1#6513, cval_orders_o_orderdate#6490 AS cval_orders_o_orderdate_1#6514, cdepval_orders_o_orderstatus#6491 AS cdepval_orders_o_orderstatus_1#6515, cdepval_orders_o_totalprice#6492 AS cdepval_orders_o_totalprice_1#6516, cdepval_orders_o_orderpriority#6493 AS cdepval_orders_o_orderpriority_1#6517, cdepval_orders_o_clerk#6494 AS cdepval_orders_o_clerk_1#6518, cdepval_orders_o_shippriority#6495 AS cdepval_orders_o_shippriority_1#6519, cdepval_orders_o_comment#6496 AS cdepval_orders_o_comment_1#6520, cdepval_orders_o_orderdate#6497 AS cdepval_orders_o_orderdate_1#6521, co_orderstatus#6498 AS co_orderstatus_1#6522, co_totalprice#6499 AS co_totalprice_1#6523, co_orderpriority#6500 AS co_orderpriority_1#6524, co_clerk#6501 AS co_clerk_1#6525, co_shippriority#6502 AS co_shippriority_1#6526, co_comment#6503 AS co_comment_1#6527, co_orderdate#6504 AS co_orderdate_1#6528]
            +- Relation[rid#6481,cpfk_customer_orders#6482,cfpk_orders_customer#6483,cval_orders_o_orderstatus#6484,cval_orders_o_totalprice#6485,cval_orders_o_orderpriority#6486,cval_orders_o_clerk#6487,cval_orders_o_shippriority#6488,cval_orders_o_comment#6489,cval_orders_o_orderdate#6490,cdepval_orders_o_orderstatus#6491,cdepval_orders_o_totalprice#6492,cdepval_orders_o_orderpriority#6493,cdepval_orders_o_clerk#6494,cdepval_orders_o_shippriority#6495,cdepval_orders_o_comment#6496,cdepval_orders_o_orderdate#6497,co_orderstatus#6498,co_totalprice#6499,co_orderpriority#6500,co_clerk#6501,co_shippriority#6502,co_comment#6503,co_orderdate#6504] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18243ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/25 22:37:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:37:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6602L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:37:42 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:37:42 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:37:42 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:37:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:37:42 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:37:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:37:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:37:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:37:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:37:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:37:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:37:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:37:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:37:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6602L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_part_4) = 'rid_3)
         :  :- Project [rid#6786 AS rid_4#6800, cpfk_part_partsupp#6787 AS cpfk_part_partsupp_4#6801, cfpk_partsupp_part#6788 AS cfpk_partsupp_part_4#6802, cpfk_supplier_partsupp#6789 AS cpfk_supplier_partsupp_4#6803, cfpk_partsupp_supplier#6790 AS cfpk_partsupp_supplier_4#6804, cval_partsupp_ps_availqty#6791 AS cval_partsupp_ps_availqty_4#6805, cval_partsupp_ps_supplycost#6792 AS cval_partsupp_ps_supplycost_4#6806, cval_partsupp_ps_comment#6793 AS cval_partsupp_ps_comment_4#6807, cdepval_partsupp_ps_availqty#6794 AS cdepval_partsupp_ps_availqty_4#6808, cdepval_partsupp_ps_supplycost#6795 AS cdepval_partsupp_ps_supplycost_4#6809, cdepval_partsupp_ps_comment#6796 AS cdepval_partsupp_ps_comment_4#6810, cps_availqty#6797 AS cps_availqty_4#6811, cps_supplycost#6798 AS cps_supplycost_4#6812, cps_comment#6799 AS cps_comment_4#6813]
         :  :  +- Relation[rid#6786,cpfk_part_partsupp#6787,cfpk_partsupp_part#6788,cpfk_supplier_partsupp#6789,cfpk_partsupp_supplier#6790,cval_partsupp_ps_availqty#6791,cval_partsupp_ps_supplycost#6792,cval_partsupp_ps_comment#6793,cdepval_partsupp_ps_availqty#6794,cdepval_partsupp_ps_supplycost#6795,cdepval_partsupp_ps_comment#6796,cps_availqty#6797,cps_supplycost#6798,cps_comment#6799] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :     +- Project [rid#6686 AS rid_3#6711, cval_part_p_name#6687 AS cval_part_p_name_3#6712, cval_part_p_mfgr#6688 AS cval_part_p_mfgr_3#6713, cval_part_p_type#6689 AS cval_part_p_type_3#6714, cval_part_p_size#6690 AS cval_part_p_size_3#6715, cval_part_p_container#6691 AS cval_part_p_container_3#6716, cval_part_p_retailprice#6692 AS cval_part_p_retailprice_3#6717, cval_part_p_comment#6693 AS cval_part_p_comment_3#6718, cval_part_p_brand#6694 AS cval_part_p_brand_3#6719, cdepval_part_p_name#6695 AS cdepval_part_p_name_3#6720, cdepval_part_p_mfgr#6696 AS cdepval_part_p_mfgr_3#6721, cdepval_part_p_type#6697 AS cdepval_part_p_type_3#6722, cdepval_part_p_size#6698 AS cdepval_part_p_size_3#6723, cdepval_part_p_container#6699 AS cdepval_part_p_container_3#6724, cdepval_part_p_retailprice#6700 AS cdepval_part_p_retailprice_3#6725, cdepval_part_p_comment#6701 AS cdepval_part_p_comment_3#6726, cdepval_part_p_brand#6702 AS cdepval_part_p_brand_3#6727, cp_name#6703 AS cp_name_3#6728, cp_mfgr#6704 AS cp_mfgr_3#6729, cp_type#6705 AS cp_type_3#6730, cp_size#6706 AS cp_size_3#6731, cp_container#6707 AS cp_container_3#6732, cp_retailprice#6708 AS cp_retailprice_3#6733, cp_comment#6709 AS cp_comment_3#6734, cp_brand#6710 AS cp_brand_3#6735]
         :        +- Relation[rid#6686,cval_part_p_name#6687,cval_part_p_mfgr#6688,cval_part_p_type#6689,cval_part_p_size#6690,cval_part_p_container#6691,cval_part_p_retailprice#6692,cval_part_p_comment#6693,cval_part_p_brand#6694,cdepval_part_p_name#6695,cdepval_part_p_mfgr#6696,cdepval_part_p_type#6697,cdepval_part_p_size#6698,cdepval_part_p_container#6699,cdepval_part_p_retailprice#6700,cdepval_part_p_comment#6701,cdepval_part_p_brand#6702,cp_name#6703,cp_mfgr#6704,cp_type#6705,cp_size#6706,cp_container#6707,cp_retailprice#6708,cp_comment#6709,cp_brand#6710] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#6650 AS rid_2#6668, cpfk_nation_supplier#6651 AS cpfk_nation_supplier_2#6669, cfpk_supplier_nation#6652 AS cfpk_supplier_nation_2#6670, cval_supplier_s_name#6653 AS cval_supplier_s_name_2#6671, cval_supplier_s_address#6654 AS cval_supplier_s_address_2#6672, cval_supplier_s_phone#6655 AS cval_supplier_s_phone_2#6673, cval_supplier_s_acctbal#6656 AS cval_supplier_s_acctbal_2#6674, cval_supplier_s_comment#6657 AS cval_supplier_s_comment_2#6675, cdepval_supplier_s_name#6658 AS cdepval_supplier_s_name_2#6676, cdepval_supplier_s_address#6659 AS cdepval_supplier_s_address_2#6677, cdepval_supplier_s_phone#6660 AS cdepval_supplier_s_phone_2#6678, cdepval_supplier_s_acctbal#6661 AS cdepval_supplier_s_acctbal_2#6679, cdepval_supplier_s_comment#6662 AS cdepval_supplier_s_comment_2#6680, cs_name#6663 AS cs_name_2#6681, cs_address#6664 AS cs_address_2#6682, cs_phone#6665 AS cs_phone_2#6683, cs_acctbal#6666 AS cs_acctbal_2#6684, cs_comment#6667 AS cs_comment_2#6685]
            :  +- Relation[rid#6650,cpfk_nation_supplier#6651,cfpk_supplier_nation#6652,cval_supplier_s_name#6653,cval_supplier_s_address#6654,cval_supplier_s_phone#6655,cval_supplier_s_acctbal#6656,cval_supplier_s_comment#6657,cdepval_supplier_s_name#6658,cdepval_supplier_s_address#6659,cdepval_supplier_s_phone#6660,cdepval_supplier_s_acctbal#6661,cdepval_supplier_s_comment#6662,cs_name#6663,cs_address#6664,cs_phone#6665,cs_acctbal#6666,cs_comment#6667] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
               :- Project [rid#6632 AS rid_1#6641, cpfk_region_nation#6633 AS cpfk_region_nation_1#6642, cfpk_nation_region#6634 AS cfpk_nation_region_1#6643, cval_nation_n_name#6635 AS cval_nation_n_name_1#6644, cval_nation_n_comment#6636 AS cval_nation_n_comment_1#6645, cdepval_nation_n_name#6637 AS cdepval_nation_n_name_1#6646, cdepval_nation_n_comment#6638 AS cdepval_nation_n_comment_1#6647, cn_name#6639 AS cn_name_1#6648, cn_comment#6640 AS cn_comment_1#6649]
               :  +- Relation[rid#6632,cpfk_region_nation#6633,cfpk_nation_region#6634,cval_nation_n_name#6635,cval_nation_n_comment#6636,cdepval_nation_n_name#6637,cdepval_nation_n_comment#6638,cn_name#6639,cn_comment#6640] JDBCRelation(tnation) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
                  +- Project [rid#6604 AS rid_0#6611, cval_region_r_name#6605 AS cval_region_r_name_0#6612, cval_region_r_comment#6606 AS cval_region_r_comment_0#6613, cdepval_region_r_name#6607 AS cdepval_region_r_name_0#6614, cdepval_region_r_comment#6608 AS cdepval_region_r_comment_0#6615, cr_name#6609 AS cr_name_0#6616, cr_comment#6610 AS cr_comment_0#6617]
                     +- Relation[rid#6604,cval_region_r_name#6605,cval_region_r_comment#6606,cdepval_region_r_name#6607,cdepval_region_r_comment#6608,cr_name#6609,cr_comment#6610] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 3569ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/25 22:37:46 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:37:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6892L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:37:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:37:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:37:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:37:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:37:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:37:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:37:46 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:37:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6892L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6919, cval_part_p_name_0#6920, cval_part_p_mfgr_0#6921, cval_part_p_type_0#6922, cval_part_p_size_0#6923, cval_part_p_container_0#6924, cval_part_p_retailprice_0#6925, cval_part_p_comment_0#6926, cval_part_p_brand_0#6927, cdepval_part_p_name_0#6928, cdepval_part_p_mfgr_0#6929, cdepval_part_p_type_0#6930, cdepval_part_p_size_0#6931, cdepval_part_p_container_0#6932, cdepval_part_p_retailprice_0#6933, cdepval_part_p_comment_0#6934, cdepval_part_p_brand_0#6935, cp_name_0#6936, cp_mfgr_0#6937, cp_type_0#6938, cp_size_0#6939, cp_container_0#6940, cp_retailprice_0#6941, cp_comment_0#6942, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#6894 AS rid_0#6919, cval_part_p_name#6895 AS cval_part_p_name_0#6920, cval_part_p_mfgr#6896 AS cval_part_p_mfgr_0#6921, cval_part_p_type#6897 AS cval_part_p_type_0#6922, cval_part_p_size#6898 AS cval_part_p_size_0#6923, cval_part_p_container#6899 AS cval_part_p_container_0#6924, cval_part_p_retailprice#6900 AS cval_part_p_retailprice_0#6925, cval_part_p_comment#6901 AS cval_part_p_comment_0#6926, cval_part_p_brand#6902 AS cval_part_p_brand_0#6927, cdepval_part_p_name#6903 AS cdepval_part_p_name_0#6928, cdepval_part_p_mfgr#6904 AS cdepval_part_p_mfgr_0#6929, cdepval_part_p_type#6905 AS cdepval_part_p_type_0#6930, cdepval_part_p_size#6906 AS cdepval_part_p_size_0#6931, cdepval_part_p_container#6907 AS cdepval_part_p_container_0#6932, cdepval_part_p_retailprice#6908 AS cdepval_part_p_retailprice_0#6933, cdepval_part_p_comment#6909 AS cdepval_part_p_comment_0#6934, cdepval_part_p_brand#6910 AS cdepval_part_p_brand_0#6935, cp_name#6911 AS cp_name_0#6936, cp_mfgr#6912 AS cp_mfgr_0#6937, cp_type#6913 AS cp_type_0#6938, cp_size#6914 AS cp_size_0#6939, cp_container#6915 AS cp_container_0#6940, cp_retailprice#6916 AS cp_retailprice_0#6941, cp_comment#6917 AS cp_comment_0#6942, cp_brand#6918 AS cp_brand_0#6943]
         :  :        +- Relation[rid#6894,cval_part_p_name#6895,cval_part_p_mfgr#6896,cval_part_p_type#6897,cval_part_p_size#6898,cval_part_p_container#6899,cval_part_p_retailprice#6900,cval_part_p_comment#6901,cval_part_p_brand#6902,cdepval_part_p_name#6903,cdepval_part_p_mfgr#6904,cdepval_part_p_type#6905,cdepval_part_p_size#6906,cdepval_part_p_container#6907,cdepval_part_p_retailprice#6908,cdepval_part_p_comment#6909,cdepval_part_p_brand#6910,cp_name#6911,cp_mfgr#6912,cp_type#6913,cp_size#6914,cp_container#6915,cp_retailprice#6916,cp_comment#6917,cp_brand#6918] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#7364 AS rid_1#7409, cpfk_orders_lineitem#7365 AS cpfk_orders_lineitem_1#7410, cpfk_supplier_lineitem#7366 AS cpfk_supplier_lineitem_1#7411, cfpk_lineitem_supplier#7367 AS cfpk_lineitem_supplier_1#7412, cfpk_lineitem_partsupp#7368 AS cfpk_lineitem_partsupp_1#7413, cpfk_part_lineitem#7369 AS cpfk_part_lineitem_1#7414, cfpk_lineitem_part#7370 AS cfpk_lineitem_part_1#7415, cpfk_partsupp_lineitem#7371 AS cpfk_partsupp_lineitem_1#7416, cfpk_lineitem_orders#7372 AS cfpk_lineitem_orders_1#7417, cval_lineitem_l_quantity#7373 AS cval_lineitem_l_quantity_1#7418, cval_lineitem_l_extendedprice#7374 AS cval_lineitem_l_extendedprice_1#7419, cval_lineitem_l_discount#7375 AS cval_lineitem_l_discount_1#7420, cval_lineitem_l_tax#7376 AS cval_lineitem_l_tax_1#7421, cval_lineitem_l_returnflag#7377 AS cval_lineitem_l_returnflag_1#7422, cval_lineitem_l_linestatus#7378 AS cval_lineitem_l_linestatus_1#7423, cval_lineitem_l_commitdate#7379 AS cval_lineitem_l_commitdate_1#7424, cval_lineitem_l_receiptdate#7380 AS cval_lineitem_l_receiptdate_1#7425, cval_lineitem_l_shipinstruct#7381 AS cval_lineitem_l_shipinstruct_1#7426, cval_lineitem_l_shipmode#7382 AS cval_lineitem_l_shipmode_1#7427, cval_lineitem_l_comment#7383 AS cval_lineitem_l_comment_1#7428, cval_lineitem_l_shipdate#7384 AS cval_lineitem_l_shipdate_1#7429, cdepval_lineitem_l_quantity#7385 AS cdepval_lineitem_l_quantity_1#7430, cdepval_lineitem_l_extendedprice#7386 AS cdepval_lineitem_l_extendedprice_1#7431, cdepval_lineitem_l_discount#7387 AS cdepval_lineitem_l_discount_1#7432, ... 21 more fields]
         :        +- Relation[rid#7364,cpfk_orders_lineitem#7365,cpfk_supplier_lineitem#7366,cfpk_lineitem_supplier#7367,cfpk_lineitem_partsupp#7368,cpfk_part_lineitem#7369,cfpk_lineitem_part#7370,cpfk_partsupp_lineitem#7371,cfpk_lineitem_orders#7372,cval_lineitem_l_quantity#7373,cval_lineitem_l_extendedprice#7374,cval_lineitem_l_discount#7375,cval_lineitem_l_tax#7376,cval_lineitem_l_returnflag#7377,cval_lineitem_l_linestatus#7378,cval_lineitem_l_commitdate#7379,cval_lineitem_l_receiptdate#7380,cval_lineitem_l_shipinstruct#7381,cval_lineitem_l_shipmode#7382,cval_lineitem_l_comment#7383,cval_lineitem_l_shipdate#7384,cdepval_lineitem_l_quantity#7385,cdepval_lineitem_l_extendedprice#7386,cdepval_lineitem_l_discount#7387,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#7044 AS rid_1#7089, cpfk_orders_lineitem#7045 AS cpfk_orders_lineitem_1#7090, cpfk_supplier_lineitem#7046 AS cpfk_supplier_lineitem_1#7091, cfpk_lineitem_supplier#7047 AS cfpk_lineitem_supplier_1#7092, cfpk_lineitem_partsupp#7048 AS cfpk_lineitem_partsupp_1#7093, cpfk_part_lineitem#7049 AS cpfk_part_lineitem_1#7094, cfpk_lineitem_part#7050 AS cfpk_lineitem_part_1#7095, cpfk_partsupp_lineitem#7051 AS cpfk_partsupp_lineitem_1#7096, cfpk_lineitem_orders#7052 AS cfpk_lineitem_orders_1#7097, cval_lineitem_l_quantity#7053 AS cval_lineitem_l_quantity_1#7098, cval_lineitem_l_extendedprice#7054 AS cval_lineitem_l_extendedprice_1#7099, cval_lineitem_l_discount#7055 AS cval_lineitem_l_discount_1#7100, cval_lineitem_l_tax#7056 AS cval_lineitem_l_tax_1#7101, cval_lineitem_l_returnflag#7057 AS cval_lineitem_l_returnflag_1#7102, cval_lineitem_l_linestatus#7058 AS cval_lineitem_l_linestatus_1#7103, cval_lineitem_l_commitdate#7059 AS cval_lineitem_l_commitdate_1#7104, cval_lineitem_l_receiptdate#7060 AS cval_lineitem_l_receiptdate_1#7105, cval_lineitem_l_shipinstruct#7061 AS cval_lineitem_l_shipinstruct_1#7106, cval_lineitem_l_shipmode#7062 AS cval_lineitem_l_shipmode_1#7107, cval_lineitem_l_comment#7063 AS cval_lineitem_l_comment_1#7108, cval_lineitem_l_shipdate#7064 AS cval_lineitem_l_shipdate_1#7109, cdepval_lineitem_l_quantity#7065 AS cdepval_lineitem_l_quantity_1#7110, cdepval_lineitem_l_extendedprice#7066 AS cdepval_lineitem_l_extendedprice_1#7111, cdepval_lineitem_l_discount#7067 AS cdepval_lineitem_l_discount_1#7112, ... 21 more fields]
                  +- Relation[rid#7044,cpfk_orders_lineitem#7045,cpfk_supplier_lineitem#7046,cfpk_lineitem_supplier#7047,cfpk_lineitem_partsupp#7048,cpfk_part_lineitem#7049,cfpk_lineitem_part#7050,cpfk_partsupp_lineitem#7051,cfpk_lineitem_orders#7052,cval_lineitem_l_quantity#7053,cval_lineitem_l_extendedprice#7054,cval_lineitem_l_discount#7055,cval_lineitem_l_tax#7056,cval_lineitem_l_returnflag#7057,cval_lineitem_l_linestatus#7058,cval_lineitem_l_commitdate#7059,cval_lineitem_l_receiptdate#7060,cval_lineitem_l_shipinstruct#7061,cval_lineitem_l_shipmode#7062,cval_lineitem_l_comment#7063,cval_lineitem_l_shipdate#7064,cdepval_lineitem_l_quantity#7065,cdepval_lineitem_l_extendedprice#7066,cdepval_lineitem_l_discount#7067,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 16669ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/25 22:38:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:38:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7530L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:38:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:38:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:38:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:38:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:38:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:38:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:38:02 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:38:03 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:38:03 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:38:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7530L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#7604 AS rid_2#7618, cpfk_part_partsupp#7605 AS cpfk_part_partsupp_2#7619, cfpk_partsupp_part#7606 AS cfpk_partsupp_part_2#7620, cpfk_supplier_partsupp#7607 AS cpfk_supplier_partsupp_2#7621, cfpk_partsupp_supplier#7608 AS cfpk_partsupp_supplier_2#7622, cval_partsupp_ps_availqty#7609 AS cval_partsupp_ps_availqty_2#7623, cval_partsupp_ps_supplycost#7610 AS cval_partsupp_ps_supplycost_2#7624, cval_partsupp_ps_comment#7611 AS cval_partsupp_ps_comment_2#7625, cdepval_partsupp_ps_availqty#7612 AS cdepval_partsupp_ps_availqty_2#7626, cdepval_partsupp_ps_supplycost#7613 AS cdepval_partsupp_ps_supplycost_2#7627, cdepval_partsupp_ps_comment#7614 AS cdepval_partsupp_ps_comment_2#7628, cps_availqty#7615 AS cps_availqty_2#7629, cps_supplycost#7616 AS cps_supplycost_2#7630, cps_comment#7617 AS cps_comment_2#7631]
         :  +- Relation[rid#7604,cpfk_part_partsupp#7605,cfpk_partsupp_part#7606,cpfk_supplier_partsupp#7607,cfpk_partsupp_supplier#7608,cval_partsupp_ps_availqty#7609,cval_partsupp_ps_supplycost#7610,cval_partsupp_ps_comment#7611,cdepval_partsupp_ps_availqty#7612,cdepval_partsupp_ps_supplycost#7613,cdepval_partsupp_ps_comment#7614,cps_availqty#7615,cps_supplycost#7616,cps_comment#7617] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
            :- Project [rid#7568 AS rid_1#7586, cpfk_nation_supplier#7569 AS cpfk_nation_supplier_1#7587, cfpk_supplier_nation#7570 AS cfpk_supplier_nation_1#7588, cval_supplier_s_name#7571 AS cval_supplier_s_name_1#7589, cval_supplier_s_address#7572 AS cval_supplier_s_address_1#7590, cval_supplier_s_phone#7573 AS cval_supplier_s_phone_1#7591, cval_supplier_s_acctbal#7574 AS cval_supplier_s_acctbal_1#7592, cval_supplier_s_comment#7575 AS cval_supplier_s_comment_1#7593, cdepval_supplier_s_name#7576 AS cdepval_supplier_s_name_1#7594, cdepval_supplier_s_address#7577 AS cdepval_supplier_s_address_1#7595, cdepval_supplier_s_phone#7578 AS cdepval_supplier_s_phone_1#7596, cdepval_supplier_s_acctbal#7579 AS cdepval_supplier_s_acctbal_1#7597, cdepval_supplier_s_comment#7580 AS cdepval_supplier_s_comment_1#7598, cs_name#7581 AS cs_name_1#7599, cs_address#7582 AS cs_address_1#7600, cs_phone#7583 AS cs_phone_1#7601, cs_acctbal#7584 AS cs_acctbal_1#7602, cs_comment#7585 AS cs_comment_1#7603]
            :  +- Relation[rid#7568,cpfk_nation_supplier#7569,cfpk_supplier_nation#7570,cval_supplier_s_name#7571,cval_supplier_s_address#7572,cval_supplier_s_phone#7573,cval_supplier_s_acctbal#7574,cval_supplier_s_comment#7575,cdepval_supplier_s_name#7576,cdepval_supplier_s_address#7577,cdepval_supplier_s_phone#7578,cdepval_supplier_s_acctbal#7579,cdepval_supplier_s_comment#7580,cs_name#7581,cs_address#7582,cs_phone#7583,cs_acctbal#7584,cs_comment#7585] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
               +- Project [rid#7532 AS rid_0#7541, cpfk_region_nation#7533 AS cpfk_region_nation_0#7542, cfpk_nation_region#7534 AS cfpk_nation_region_0#7543, cval_nation_n_name#7535 AS cval_nation_n_name_0#7544, cval_nation_n_comment#7536 AS cval_nation_n_comment_0#7545, cdepval_nation_n_name#7537 AS cdepval_nation_n_name_0#7546, cdepval_nation_n_comment#7538 AS cdepval_nation_n_comment_0#7547, cn_name#7539 AS cn_name_0#7548, cn_comment#7540 AS cn_comment_0#7549]
                  +- Relation[rid#7532,cpfk_region_nation#7533,cfpk_nation_region#7534,cval_nation_n_name#7535,cval_nation_n_comment#7536,cdepval_nation_n_name#7537,cdepval_nation_n_comment#7538,cn_name#7539,cn_comment#7540] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 3693ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/25 22:38:06 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:38:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7677L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:38:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7677L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#7679 AS rid_0#7724, cpfk_orders_lineitem#7680 AS cpfk_orders_lineitem_0#7725, cpfk_supplier_lineitem#7681 AS cpfk_supplier_lineitem_0#7726, cfpk_lineitem_supplier#7682 AS cfpk_lineitem_supplier_0#7727, cfpk_lineitem_partsupp#7683 AS cfpk_lineitem_partsupp_0#7728, cpfk_part_lineitem#7684 AS cpfk_part_lineitem_0#7729, cfpk_lineitem_part#7685 AS cfpk_lineitem_part_0#7730, cpfk_partsupp_lineitem#7686 AS cpfk_partsupp_lineitem_0#7731, cfpk_lineitem_orders#7687 AS cfpk_lineitem_orders_0#7732, cval_lineitem_l_quantity#7688 AS cval_lineitem_l_quantity_0#7733, cval_lineitem_l_extendedprice#7689 AS cval_lineitem_l_extendedprice_0#7734, cval_lineitem_l_discount#7690 AS cval_lineitem_l_discount_0#7735, cval_lineitem_l_tax#7691 AS cval_lineitem_l_tax_0#7736, cval_lineitem_l_returnflag#7692 AS cval_lineitem_l_returnflag_0#7737, cval_lineitem_l_linestatus#7693 AS cval_lineitem_l_linestatus_0#7738, cval_lineitem_l_commitdate#7694 AS cval_lineitem_l_commitdate_0#7739, cval_lineitem_l_receiptdate#7695 AS cval_lineitem_l_receiptdate_0#7740, cval_lineitem_l_shipinstruct#7696 AS cval_lineitem_l_shipinstruct_0#7741, cval_lineitem_l_shipmode#7697 AS cval_lineitem_l_shipmode_0#7742, cval_lineitem_l_comment#7698 AS cval_lineitem_l_comment_0#7743, cval_lineitem_l_shipdate#7699 AS cval_lineitem_l_shipdate_0#7744, cdepval_lineitem_l_quantity#7700 AS cdepval_lineitem_l_quantity_0#7745, cdepval_lineitem_l_extendedprice#7701 AS cdepval_lineitem_l_extendedprice_0#7746, cdepval_lineitem_l_discount#7702 AS cdepval_lineitem_l_discount_0#7747, ... 21 more fields]
         :     +- Relation[rid#7679,cpfk_orders_lineitem#7680,cpfk_supplier_lineitem#7681,cfpk_lineitem_supplier#7682,cfpk_lineitem_partsupp#7683,cpfk_part_lineitem#7684,cfpk_lineitem_part#7685,cpfk_partsupp_lineitem#7686,cfpk_lineitem_orders#7687,cval_lineitem_l_quantity#7688,cval_lineitem_l_extendedprice#7689,cval_lineitem_l_discount#7690,cval_lineitem_l_tax#7691,cval_lineitem_l_returnflag#7692,cval_lineitem_l_linestatus#7693,cval_lineitem_l_commitdate#7694,cval_lineitem_l_receiptdate#7695,cval_lineitem_l_shipinstruct#7696,cval_lineitem_l_shipmode#7697,cval_lineitem_l_comment#7698,cval_lineitem_l_shipdate#7699,cdepval_lineitem_l_quantity#7700,cdepval_lineitem_l_extendedprice#7701,cdepval_lineitem_l_discount#7702,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7859 AS rid_1#7883, cpfk_customer_orders#7860 AS cpfk_customer_orders_1#7884, cfpk_orders_customer#7861 AS cfpk_orders_customer_1#7885, cval_orders_o_orderstatus#7862 AS cval_orders_o_orderstatus_1#7886, cval_orders_o_totalprice#7863 AS cval_orders_o_totalprice_1#7887, cval_orders_o_orderpriority#7864 AS cval_orders_o_orderpriority_1#7888, cval_orders_o_clerk#7865 AS cval_orders_o_clerk_1#7889, cval_orders_o_shippriority#7866 AS cval_orders_o_shippriority_1#7890, cval_orders_o_comment#7867 AS cval_orders_o_comment_1#7891, cval_orders_o_orderdate#7868 AS cval_orders_o_orderdate_1#7892, cdepval_orders_o_orderstatus#7869 AS cdepval_orders_o_orderstatus_1#7893, cdepval_orders_o_totalprice#7870 AS cdepval_orders_o_totalprice_1#7894, cdepval_orders_o_orderpriority#7871 AS cdepval_orders_o_orderpriority_1#7895, cdepval_orders_o_clerk#7872 AS cdepval_orders_o_clerk_1#7896, cdepval_orders_o_shippriority#7873 AS cdepval_orders_o_shippriority_1#7897, cdepval_orders_o_comment#7874 AS cdepval_orders_o_comment_1#7898, cdepval_orders_o_orderdate#7875 AS cdepval_orders_o_orderdate_1#7899, co_orderstatus#7876 AS co_orderstatus_1#7900, co_totalprice#7877 AS co_totalprice_1#7901, co_orderpriority#7878 AS co_orderpriority_1#7902, co_clerk#7879 AS co_clerk_1#7903, co_shippriority#7880 AS co_shippriority_1#7904, co_comment#7881 AS co_comment_1#7905, co_orderdate#7882 AS co_orderdate_1#7906]
            +- Relation[rid#7859,cpfk_customer_orders#7860,cfpk_orders_customer#7861,cval_orders_o_orderstatus#7862,cval_orders_o_totalprice#7863,cval_orders_o_orderpriority#7864,cval_orders_o_clerk#7865,cval_orders_o_shippriority#7866,cval_orders_o_comment#7867,cval_orders_o_orderdate#7868,cdepval_orders_o_orderstatus#7869,cdepval_orders_o_totalprice#7870,cdepval_orders_o_orderpriority#7871,cdepval_orders_o_clerk#7872,cdepval_orders_o_shippriority#7873,cdepval_orders_o_comment#7874,cdepval_orders_o_orderdate#7875,co_orderstatus#7876,co_totalprice#7877,co_orderpriority#7878,co_clerk#7879,co_shippriority#7880,co_comment#7881,co_orderdate#7882] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 22667ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/25 22:38:29 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:38:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7985L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:38:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7985L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#8077 AS rid_2#8122, cpfk_orders_lineitem#8078 AS cpfk_orders_lineitem_2#8123, cpfk_supplier_lineitem#8079 AS cpfk_supplier_lineitem_2#8124, cfpk_lineitem_supplier#8080 AS cfpk_lineitem_supplier_2#8125, cfpk_lineitem_partsupp#8081 AS cfpk_lineitem_partsupp_2#8126, cpfk_part_lineitem#8082 AS cpfk_part_lineitem_2#8127, cfpk_lineitem_part#8083 AS cfpk_lineitem_part_2#8128, cpfk_partsupp_lineitem#8084 AS cpfk_partsupp_lineitem_2#8129, cfpk_lineitem_orders#8085 AS cfpk_lineitem_orders_2#8130, cval_lineitem_l_quantity#8086 AS cval_lineitem_l_quantity_2#8131, cval_lineitem_l_extendedprice#8087 AS cval_lineitem_l_extendedprice_2#8132, cval_lineitem_l_discount#8088 AS cval_lineitem_l_discount_2#8133, cval_lineitem_l_tax#8089 AS cval_lineitem_l_tax_2#8134, cval_lineitem_l_returnflag#8090 AS cval_lineitem_l_returnflag_2#8135, cval_lineitem_l_linestatus#8091 AS cval_lineitem_l_linestatus_2#8136, cval_lineitem_l_commitdate#8092 AS cval_lineitem_l_commitdate_2#8137, cval_lineitem_l_receiptdate#8093 AS cval_lineitem_l_receiptdate_2#8138, cval_lineitem_l_shipinstruct#8094 AS cval_lineitem_l_shipinstruct_2#8139, cval_lineitem_l_shipmode#8095 AS cval_lineitem_l_shipmode_2#8140, cval_lineitem_l_comment#8096 AS cval_lineitem_l_comment_2#8141, cval_lineitem_l_shipdate#8097 AS cval_lineitem_l_shipdate_2#8142, cdepval_lineitem_l_quantity#8098 AS cdepval_lineitem_l_quantity_2#8143, cdepval_lineitem_l_extendedprice#8099 AS cdepval_lineitem_l_extendedprice_2#8144, cdepval_lineitem_l_discount#8100 AS cdepval_lineitem_l_discount_2#8145, ... 21 more fields]
         :  +- Relation[rid#8077,cpfk_orders_lineitem#8078,cpfk_supplier_lineitem#8079,cfpk_lineitem_supplier#8080,cfpk_lineitem_partsupp#8081,cpfk_part_lineitem#8082,cfpk_lineitem_part#8083,cpfk_partsupp_lineitem#8084,cfpk_lineitem_orders#8085,cval_lineitem_l_quantity#8086,cval_lineitem_l_extendedprice#8087,cval_lineitem_l_discount#8088,cval_lineitem_l_tax#8089,cval_lineitem_l_returnflag#8090,cval_lineitem_l_linestatus#8091,cval_lineitem_l_commitdate#8092,cval_lineitem_l_receiptdate#8093,cval_lineitem_l_shipinstruct#8094,cval_lineitem_l_shipmode#8095,cval_lineitem_l_comment#8096,cval_lineitem_l_shipdate#8097,cdepval_lineitem_l_quantity#8098,cdepval_lineitem_l_extendedprice#8099,cdepval_lineitem_l_discount#8100,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#8029 AS rid_1#8053, cpfk_customer_orders#8030 AS cpfk_customer_orders_1#8054, cfpk_orders_customer#8031 AS cfpk_orders_customer_1#8055, cval_orders_o_orderstatus#8032 AS cval_orders_o_orderstatus_1#8056, cval_orders_o_totalprice#8033 AS cval_orders_o_totalprice_1#8057, cval_orders_o_orderpriority#8034 AS cval_orders_o_orderpriority_1#8058, cval_orders_o_clerk#8035 AS cval_orders_o_clerk_1#8059, cval_orders_o_shippriority#8036 AS cval_orders_o_shippriority_1#8060, cval_orders_o_comment#8037 AS cval_orders_o_comment_1#8061, cval_orders_o_orderdate#8038 AS cval_orders_o_orderdate_1#8062, cdepval_orders_o_orderstatus#8039 AS cdepval_orders_o_orderstatus_1#8063, cdepval_orders_o_totalprice#8040 AS cdepval_orders_o_totalprice_1#8064, cdepval_orders_o_orderpriority#8041 AS cdepval_orders_o_orderpriority_1#8065, cdepval_orders_o_clerk#8042 AS cdepval_orders_o_clerk_1#8066, cdepval_orders_o_shippriority#8043 AS cdepval_orders_o_shippriority_1#8067, cdepval_orders_o_comment#8044 AS cdepval_orders_o_comment_1#8068, cdepval_orders_o_orderdate#8045 AS cdepval_orders_o_orderdate_1#8069, co_orderstatus#8046 AS co_orderstatus_1#8070, co_totalprice#8047 AS co_totalprice_1#8071, co_orderpriority#8048 AS co_orderpriority_1#8072, co_clerk#8049 AS co_clerk_1#8073, co_shippriority#8050 AS co_shippriority_1#8074, co_comment#8051 AS co_comment_1#8075, co_orderdate#8052 AS co_orderdate_1#8076]
            :  +- Relation[rid#8029,cpfk_customer_orders#8030,cfpk_orders_customer#8031,cval_orders_o_orderstatus#8032,cval_orders_o_totalprice#8033,cval_orders_o_orderpriority#8034,cval_orders_o_clerk#8035,cval_orders_o_shippriority#8036,cval_orders_o_comment#8037,cval_orders_o_orderdate#8038,cdepval_orders_o_orderstatus#8039,cdepval_orders_o_totalprice#8040,cdepval_orders_o_orderpriority#8041,cdepval_orders_o_clerk#8042,cdepval_orders_o_shippriority#8043,cdepval_orders_o_comment#8044,cdepval_orders_o_orderdate#8045,co_orderstatus#8046,co_totalprice#8047,co_orderpriority#8048,co_clerk#8049,co_shippriority#8050,co_comment#8051,co_orderdate#8052] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#7987 AS rid_0#8008, cpfk_nation_customer#7988 AS cpfk_nation_customer_0#8009, cfpk_customer_nation#7989 AS cfpk_customer_nation_0#8010, cval_customer_c_name#7990 AS cval_customer_c_name_0#8011, cval_customer_c_address#7991 AS cval_customer_c_address_0#8012, cval_customer_c_phone#7992 AS cval_customer_c_phone_0#8013, cval_customer_c_acctbal#7993 AS cval_customer_c_acctbal_0#8014, cval_customer_c_comment#7994 AS cval_customer_c_comment_0#8015, cval_customer_c_mktsegment#7995 AS cval_customer_c_mktsegment_0#8016, cdepval_customer_c_name#7996 AS cdepval_customer_c_name_0#8017, cdepval_customer_c_address#7997 AS cdepval_customer_c_address_0#8018, cdepval_customer_c_phone#7998 AS cdepval_customer_c_phone_0#8019, cdepval_customer_c_acctbal#7999 AS cdepval_customer_c_acctbal_0#8020, cdepval_customer_c_comment#8000 AS cdepval_customer_c_comment_0#8021, cdepval_customer_c_mktsegment#8001 AS cdepval_customer_c_mktsegment_0#8022, cc_name#8002 AS cc_name_0#8023, cc_address#8003 AS cc_address_0#8024, cc_phone#8004 AS cc_phone_0#8025, cc_acctbal#8005 AS cc_acctbal_0#8026, cc_comment#8006 AS cc_comment_0#8027, cc_mktsegment#8007 AS cc_mktsegment_0#8028]
               +- Relation[rid#7987,cpfk_nation_customer#7988,cfpk_customer_nation#7989,cval_customer_c_name#7990,cval_customer_c_address#7991,cval_customer_c_phone#7992,cval_customer_c_acctbal#7993,cval_customer_c_comment#7994,cval_customer_c_mktsegment#7995,cdepval_customer_c_name#7996,cdepval_customer_c_address#7997,cdepval_customer_c_phone#7998,cdepval_customer_c_acctbal#7999,cdepval_customer_c_comment#8000,cdepval_customer_c_mktsegment#8001,cc_name#8002,cc_address#8003,cc_phone#8004,cc_acctbal#8005,cc_comment#8006,cc_mktsegment#8007] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 22301ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/25 22:38:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:38:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8262L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:38:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#8262L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#8264 AS rid_0#8309, cpfk_orders_lineitem#8265 AS cpfk_orders_lineitem_0#8310, cpfk_supplier_lineitem#8266 AS cpfk_supplier_lineitem_0#8311, cfpk_lineitem_supplier#8267 AS cfpk_lineitem_supplier_0#8312, cfpk_lineitem_partsupp#8268 AS cfpk_lineitem_partsupp_0#8313, cpfk_part_lineitem#8269 AS cpfk_part_lineitem_0#8314, cfpk_lineitem_part#8270 AS cfpk_lineitem_part_0#8315, cpfk_partsupp_lineitem#8271 AS cpfk_partsupp_lineitem_0#8316, cfpk_lineitem_orders#8272 AS cfpk_lineitem_orders_0#8317, cval_lineitem_l_quantity#8273 AS cval_lineitem_l_quantity_0#8318, cval_lineitem_l_extendedprice#8274 AS cval_lineitem_l_extendedprice_0#8319, cval_lineitem_l_discount#8275 AS cval_lineitem_l_discount_0#8320, cval_lineitem_l_tax#8276 AS cval_lineitem_l_tax_0#8321, cval_lineitem_l_returnflag#8277 AS cval_lineitem_l_returnflag_0#8322, cval_lineitem_l_linestatus#8278 AS cval_lineitem_l_linestatus_0#8323, cval_lineitem_l_commitdate#8279 AS cval_lineitem_l_commitdate_0#8324, cval_lineitem_l_receiptdate#8280 AS cval_lineitem_l_receiptdate_0#8325, cval_lineitem_l_shipinstruct#8281 AS cval_lineitem_l_shipinstruct_0#8326, cval_lineitem_l_shipmode#8282 AS cval_lineitem_l_shipmode_0#8327, cval_lineitem_l_comment#8283 AS cval_lineitem_l_comment_0#8328, cval_lineitem_l_shipdate#8284 AS cval_lineitem_l_shipdate_0#8329, cdepval_lineitem_l_quantity#8285 AS cdepval_lineitem_l_quantity_0#8330, cdepval_lineitem_l_extendedprice#8286 AS cdepval_lineitem_l_extendedprice_0#8331, cdepval_lineitem_l_discount#8287 AS cdepval_lineitem_l_discount_0#8332, ... 21 more fields]
         +- Relation[rid#8264,cpfk_orders_lineitem#8265,cpfk_supplier_lineitem#8266,cfpk_lineitem_supplier#8267,cfpk_lineitem_partsupp#8268,cpfk_part_lineitem#8269,cfpk_lineitem_part#8270,cpfk_partsupp_lineitem#8271,cfpk_lineitem_orders#8272,cval_lineitem_l_quantity#8273,cval_lineitem_l_extendedprice#8274,cval_lineitem_l_discount#8275,cval_lineitem_l_tax#8276,cval_lineitem_l_returnflag#8277,cval_lineitem_l_linestatus#8278,cval_lineitem_l_commitdate#8279,cval_lineitem_l_receiptdate#8280,cval_lineitem_l_shipinstruct#8281,cval_lineitem_l_shipmode#8282,cval_lineitem_l_comment#8283,cval_lineitem_l_shipdate#8284,cdepval_lineitem_l_quantity#8285,cdepval_lineitem_l_extendedprice#8286,cdepval_lineitem_l_discount#8287,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 5115ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 22:38:56 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:38:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8408L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:38:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:38:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:38:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:38:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:38:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:38:56 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:38:56 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:38:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8408L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#8464 AS rid_2#8509, cpfk_orders_lineitem#8465 AS cpfk_orders_lineitem_2#8510, cpfk_supplier_lineitem#8466 AS cpfk_supplier_lineitem_2#8511, cfpk_lineitem_supplier#8467 AS cfpk_lineitem_supplier_2#8512, cfpk_lineitem_partsupp#8468 AS cfpk_lineitem_partsupp_2#8513, cpfk_part_lineitem#8469 AS cpfk_part_lineitem_2#8514, cfpk_lineitem_part#8470 AS cfpk_lineitem_part_2#8515, cpfk_partsupp_lineitem#8471 AS cpfk_partsupp_lineitem_2#8516, cfpk_lineitem_orders#8472 AS cfpk_lineitem_orders_2#8517, cval_lineitem_l_quantity#8473 AS cval_lineitem_l_quantity_2#8518, cval_lineitem_l_extendedprice#8474 AS cval_lineitem_l_extendedprice_2#8519, cval_lineitem_l_discount#8475 AS cval_lineitem_l_discount_2#8520, cval_lineitem_l_tax#8476 AS cval_lineitem_l_tax_2#8521, cval_lineitem_l_returnflag#8477 AS cval_lineitem_l_returnflag_2#8522, cval_lineitem_l_linestatus#8478 AS cval_lineitem_l_linestatus_2#8523, cval_lineitem_l_commitdate#8479 AS cval_lineitem_l_commitdate_2#8524, cval_lineitem_l_receiptdate#8480 AS cval_lineitem_l_receiptdate_2#8525, cval_lineitem_l_shipinstruct#8481 AS cval_lineitem_l_shipinstruct_2#8526, cval_lineitem_l_shipmode#8482 AS cval_lineitem_l_shipmode_2#8527, cval_lineitem_l_comment#8483 AS cval_lineitem_l_comment_2#8528, cval_lineitem_l_shipdate#8484 AS cval_lineitem_l_shipdate_2#8529, cdepval_lineitem_l_quantity#8485 AS cdepval_lineitem_l_quantity_2#8530, cdepval_lineitem_l_extendedprice#8486 AS cdepval_lineitem_l_extendedprice_2#8531, cdepval_lineitem_l_discount#8487 AS cdepval_lineitem_l_discount_2#8532, ... 21 more fields]
         :  :  :  :  +- Relation[rid#8464,cpfk_orders_lineitem#8465,cpfk_supplier_lineitem#8466,cfpk_lineitem_supplier#8467,cfpk_lineitem_partsupp#8468,cpfk_part_lineitem#8469,cfpk_lineitem_part#8470,cpfk_partsupp_lineitem#8471,cfpk_lineitem_orders#8472,cval_lineitem_l_quantity#8473,cval_lineitem_l_extendedprice#8474,cval_lineitem_l_discount#8475,cval_lineitem_l_tax#8476,cval_lineitem_l_returnflag#8477,cval_lineitem_l_linestatus#8478,cval_lineitem_l_commitdate#8479,cval_lineitem_l_receiptdate#8480,cval_lineitem_l_shipinstruct#8481,cval_lineitem_l_shipmode#8482,cval_lineitem_l_comment#8483,cval_lineitem_l_shipdate#8484,cdepval_lineitem_l_quantity#8485,cdepval_lineitem_l_extendedprice#8486,cdepval_lineitem_l_discount#8487,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#8428 AS rid_1#8446, cpfk_nation_supplier#8429 AS cpfk_nation_supplier_1#8447, cfpk_supplier_nation#8430 AS cfpk_supplier_nation_1#8448, cval_supplier_s_name#8431 AS cval_supplier_s_name_1#8449, cval_supplier_s_address#8432 AS cval_supplier_s_address_1#8450, cval_supplier_s_phone#8433 AS cval_supplier_s_phone_1#8451, cval_supplier_s_acctbal#8434 AS cval_supplier_s_acctbal_1#8452, cval_supplier_s_comment#8435 AS cval_supplier_s_comment_1#8453, cdepval_supplier_s_name#8436 AS cdepval_supplier_s_name_1#8454, cdepval_supplier_s_address#8437 AS cdepval_supplier_s_address_1#8455, cdepval_supplier_s_phone#8438 AS cdepval_supplier_s_phone_1#8456, cdepval_supplier_s_acctbal#8439 AS cdepval_supplier_s_acctbal_1#8457, cdepval_supplier_s_comment#8440 AS cdepval_supplier_s_comment_1#8458, cs_name#8441 AS cs_name_1#8459, cs_address#8442 AS cs_address_1#8460, cs_phone#8443 AS cs_phone_1#8461, cs_acctbal#8444 AS cs_acctbal_1#8462, cs_comment#8445 AS cs_comment_1#8463]
         :  :  :     :  +- Relation[rid#8428,cpfk_nation_supplier#8429,cfpk_supplier_nation#8430,cval_supplier_s_name#8431,cval_supplier_s_address#8432,cval_supplier_s_phone#8433,cval_supplier_s_acctbal#8434,cval_supplier_s_comment#8435,cdepval_supplier_s_name#8436,cdepval_supplier_s_address#8437,cdepval_supplier_s_phone#8438,cdepval_supplier_s_acctbal#8439,cdepval_supplier_s_comment#8440,cs_name#8441,cs_address#8442,cs_phone#8443,cs_acctbal#8444,cs_comment#8445] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#8410 AS rid_0#8419, cpfk_region_nation#8411 AS cpfk_region_nation_0#8420, cfpk_nation_region#8412 AS cfpk_nation_region_0#8421, cval_nation_n_name#8413 AS cval_nation_n_name_0#8422, cval_nation_n_comment#8414 AS cval_nation_n_comment_0#8423, cdepval_nation_n_name#8415 AS cdepval_nation_n_name_0#8424, cdepval_nation_n_comment#8416 AS cdepval_nation_n_comment_0#8425, cn_name#8417 AS cn_name_0#8426, cn_comment#8418 AS cn_comment_0#8427]
         :  :  :        +- Relation[rid#8410,cpfk_region_nation#8411,cfpk_nation_region#8412,cval_nation_n_name#8413,cval_nation_n_comment#8414,cdepval_nation_n_name#8415,cdepval_nation_n_comment#8416,cn_name#8417,cn_comment#8418] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#8554 AS rid_3#8579, cval_part_p_name#8555 AS cval_part_p_name_3#8580, cval_part_p_mfgr#8556 AS cval_part_p_mfgr_3#8581, cval_part_p_type#8557 AS cval_part_p_type_3#8582, cval_part_p_size#8558 AS cval_part_p_size_3#8583, cval_part_p_container#8559 AS cval_part_p_container_3#8584, cval_part_p_retailprice#8560 AS cval_part_p_retailprice_3#8585, cval_part_p_comment#8561 AS cval_part_p_comment_3#8586, cval_part_p_brand#8562 AS cval_part_p_brand_3#8587, cdepval_part_p_name#8563 AS cdepval_part_p_name_3#8588, cdepval_part_p_mfgr#8564 AS cdepval_part_p_mfgr_3#8589, cdepval_part_p_type#8565 AS cdepval_part_p_type_3#8590, cdepval_part_p_size#8566 AS cdepval_part_p_size_3#8591, cdepval_part_p_container#8567 AS cdepval_part_p_container_3#8592, cdepval_part_p_retailprice#8568 AS cdepval_part_p_retailprice_3#8593, cdepval_part_p_comment#8569 AS cdepval_part_p_comment_3#8594, cdepval_part_p_brand#8570 AS cdepval_part_p_brand_3#8595, cp_name#8571 AS cp_name_3#8596, cp_mfgr#8572 AS cp_mfgr_3#8597, cp_type#8573 AS cp_type_3#8598, cp_size#8574 AS cp_size_3#8599, cp_container#8575 AS cp_container_3#8600, cp_retailprice#8576 AS cp_retailprice_3#8601, cp_comment#8577 AS cp_comment_3#8602, cp_brand#8578 AS cp_brand_3#8603]
         :  :     +- Relation[rid#8554,cval_part_p_name#8555,cval_part_p_mfgr#8556,cval_part_p_type#8557,cval_part_p_size#8558,cval_part_p_container#8559,cval_part_p_retailprice#8560,cval_part_p_comment#8561,cval_part_p_brand#8562,cdepval_part_p_name#8563,cdepval_part_p_mfgr#8564,cdepval_part_p_type#8565,cdepval_part_p_size#8566,cdepval_part_p_container#8567,cdepval_part_p_retailprice#8568,cdepval_part_p_comment#8569,cdepval_part_p_brand#8570,cp_name#8571,cp_mfgr#8572,cp_type#8573,cp_size#8574,cp_container#8575,cp_retailprice#8576,cp_comment#8577,cp_brand#8578] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#8604 AS rid_4#8618, cpfk_part_partsupp#8605 AS cpfk_part_partsupp_4#8619, cfpk_partsupp_part#8606 AS cfpk_partsupp_part_4#8620, cpfk_supplier_partsupp#8607 AS cpfk_supplier_partsupp_4#8621, cfpk_partsupp_supplier#8608 AS cfpk_partsupp_supplier_4#8622, cval_partsupp_ps_availqty#8609 AS cval_partsupp_ps_availqty_4#8623, cval_partsupp_ps_supplycost#8610 AS cval_partsupp_ps_supplycost_4#8624, cval_partsupp_ps_comment#8611 AS cval_partsupp_ps_comment_4#8625, cdepval_partsupp_ps_availqty#8612 AS cdepval_partsupp_ps_availqty_4#8626, cdepval_partsupp_ps_supplycost#8613 AS cdepval_partsupp_ps_supplycost_4#8627, cdepval_partsupp_ps_comment#8614 AS cdepval_partsupp_ps_comment_4#8628, cps_availqty#8615 AS cps_availqty_4#8629, cps_supplycost#8616 AS cps_supplycost_4#8630, cps_comment#8617 AS cps_comment_4#8631]
         :     +- Relation[rid#8604,cpfk_part_partsupp#8605,cfpk_partsupp_part#8606,cpfk_supplier_partsupp#8607,cfpk_partsupp_supplier#8608,cval_partsupp_ps_availqty#8609,cval_partsupp_ps_supplycost#8610,cval_partsupp_ps_comment#8611,cdepval_partsupp_ps_availqty#8612,cdepval_partsupp_ps_supplycost#8613,cdepval_partsupp_ps_comment#8614,cps_availqty#8615,cps_supplycost#8616,cps_comment#8617] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#8632 AS rid_5#8656, cpfk_customer_orders#8633 AS cpfk_customer_orders_5#8657, cfpk_orders_customer#8634 AS cfpk_orders_customer_5#8658, cval_orders_o_orderstatus#8635 AS cval_orders_o_orderstatus_5#8659, cval_orders_o_totalprice#8636 AS cval_orders_o_totalprice_5#8660, cval_orders_o_orderpriority#8637 AS cval_orders_o_orderpriority_5#8661, cval_orders_o_clerk#8638 AS cval_orders_o_clerk_5#8662, cval_orders_o_shippriority#8639 AS cval_orders_o_shippriority_5#8663, cval_orders_o_comment#8640 AS cval_orders_o_comment_5#8664, cval_orders_o_orderdate#8641 AS cval_orders_o_orderdate_5#8665, cdepval_orders_o_orderstatus#8642 AS cdepval_orders_o_orderstatus_5#8666, cdepval_orders_o_totalprice#8643 AS cdepval_orders_o_totalprice_5#8667, cdepval_orders_o_orderpriority#8644 AS cdepval_orders_o_orderpriority_5#8668, cdepval_orders_o_clerk#8645 AS cdepval_orders_o_clerk_5#8669, cdepval_orders_o_shippriority#8646 AS cdepval_orders_o_shippriority_5#8670, cdepval_orders_o_comment#8647 AS cdepval_orders_o_comment_5#8671, cdepval_orders_o_orderdate#8648 AS cdepval_orders_o_orderdate_5#8672, co_orderstatus#8649 AS co_orderstatus_5#8673, co_totalprice#8650 AS co_totalprice_5#8674, co_orderpriority#8651 AS co_orderpriority_5#8675, co_clerk#8652 AS co_clerk_5#8676, co_shippriority#8653 AS co_shippriority_5#8677, co_comment#8654 AS co_comment_5#8678, co_orderdate#8655 AS co_orderdate_5#8679]
            +- Relation[rid#8632,cpfk_customer_orders#8633,cfpk_orders_customer#8634,cval_orders_o_orderstatus#8635,cval_orders_o_totalprice#8636,cval_orders_o_orderpriority#8637,cval_orders_o_clerk#8638,cval_orders_o_shippriority#8639,cval_orders_o_comment#8640,cval_orders_o_orderdate#8641,cdepval_orders_o_orderstatus#8642,cdepval_orders_o_totalprice#8643,cdepval_orders_o_orderpriority#8644,cdepval_orders_o_clerk#8645,cdepval_orders_o_shippriority#8646,cdepval_orders_o_comment#8647,cdepval_orders_o_orderdate#8648,co_orderstatus#8649,co_totalprice#8650,co_orderpriority#8651,co_clerk#8652,co_shippriority#8653,co_comment#8654,co_orderdate#8655] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 63470ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/25 22:40:00 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:40:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8822L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:40:00 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:40:00 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:40:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8822L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :- Project [rid#8924 AS rid_1#8938, cpfk_part_partsupp#8925 AS cpfk_part_partsupp_1#8939, cfpk_partsupp_part#8926 AS cfpk_partsupp_part_1#8940, cpfk_supplier_partsupp#8927 AS cpfk_supplier_partsupp_1#8941, cfpk_partsupp_supplier#8928 AS cfpk_partsupp_supplier_1#8942, cval_partsupp_ps_availqty#8929 AS cval_partsupp_ps_availqty_1#8943, cval_partsupp_ps_supplycost#8930 AS cval_partsupp_ps_supplycost_1#8944, cval_partsupp_ps_comment#8931 AS cval_partsupp_ps_comment_1#8945, cdepval_partsupp_ps_availqty#8932 AS cdepval_partsupp_ps_availqty_1#8946, cdepval_partsupp_ps_supplycost#8933 AS cdepval_partsupp_ps_supplycost_1#8947, cdepval_partsupp_ps_comment#8934 AS cdepval_partsupp_ps_comment_1#8948, cps_availqty#8935 AS cps_availqty_1#8949, cps_supplycost#8936 AS cps_supplycost_1#8950, cps_comment#8937 AS cps_comment_1#8951]
         :  +- Relation[rid#8924,cpfk_part_partsupp#8925,cfpk_partsupp_part#8926,cpfk_supplier_partsupp#8927,cfpk_partsupp_supplier#8928,cval_partsupp_ps_availqty#8929,cval_partsupp_ps_supplycost#8930,cval_partsupp_ps_comment#8931,cdepval_partsupp_ps_availqty#8932,cdepval_partsupp_ps_supplycost#8933,cdepval_partsupp_ps_comment#8934,cps_availqty#8935,cps_supplycost#8936,cps_comment#8937] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
            +- Project [rid#8824 AS rid_0#8849, cval_part_p_name#8825 AS cval_part_p_name_0#8850, cval_part_p_mfgr#8826 AS cval_part_p_mfgr_0#8851, cval_part_p_type#8827 AS cval_part_p_type_0#8852, cval_part_p_size#8828 AS cval_part_p_size_0#8853, cval_part_p_container#8829 AS cval_part_p_container_0#8854, cval_part_p_retailprice#8830 AS cval_part_p_retailprice_0#8855, cval_part_p_comment#8831 AS cval_part_p_comment_0#8856, cval_part_p_brand#8832 AS cval_part_p_brand_0#8857, cdepval_part_p_name#8833 AS cdepval_part_p_name_0#8858, cdepval_part_p_mfgr#8834 AS cdepval_part_p_mfgr_0#8859, cdepval_part_p_type#8835 AS cdepval_part_p_type_0#8860, cdepval_part_p_size#8836 AS cdepval_part_p_size_0#8861, cdepval_part_p_container#8837 AS cdepval_part_p_container_0#8862, cdepval_part_p_retailprice#8838 AS cdepval_part_p_retailprice_0#8863, cdepval_part_p_comment#8839 AS cdepval_part_p_comment_0#8864, cdepval_part_p_brand#8840 AS cdepval_part_p_brand_0#8865, cp_name#8841 AS cp_name_0#8866, cp_mfgr#8842 AS cp_mfgr_0#8867, cp_type#8843 AS cp_type_0#8868, cp_size#8844 AS cp_size_0#8869, cp_container#8845 AS cp_container_0#8870, cp_retailprice#8846 AS cp_retailprice_0#8871, cp_comment#8847 AS cp_comment_0#8872, cp_brand#8848 AS cp_brand_0#8873]
               +- Relation[rid#8824,cval_part_p_name#8825,cval_part_p_mfgr#8826,cval_part_p_type#8827,cval_part_p_size#8828,cval_part_p_container#8829,cval_part_p_retailprice#8830,cval_part_p_comment#8831,cval_part_p_brand#8832,cdepval_part_p_name#8833,cdepval_part_p_mfgr#8834,cdepval_part_p_type#8835,cdepval_part_p_size#8836,cdepval_part_p_container#8837,cdepval_part_p_retailprice#8838,cdepval_part_p_comment#8839,cdepval_part_p_brand#8840,cp_name#8841,cp_mfgr#8842,cp_type#8843,cp_size#8844,cp_container#8845,cp_retailprice#8846,cp_comment#8847,cp_brand#8848] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 3628ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/25 22:40:03 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:40:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8996L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:40:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#8996L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#8998 AS rid_0#9043, cpfk_orders_lineitem#8999 AS cpfk_orders_lineitem_0#9044, cpfk_supplier_lineitem#9000 AS cpfk_supplier_lineitem_0#9045, cfpk_lineitem_supplier#9001 AS cfpk_lineitem_supplier_0#9046, cfpk_lineitem_partsupp#9002 AS cfpk_lineitem_partsupp_0#9047, cpfk_part_lineitem#9003 AS cpfk_part_lineitem_0#9048, cfpk_lineitem_part#9004 AS cfpk_lineitem_part_0#9049, cpfk_partsupp_lineitem#9005 AS cpfk_partsupp_lineitem_0#9050, cfpk_lineitem_orders#9006 AS cfpk_lineitem_orders_0#9051, cval_lineitem_l_quantity#9007 AS cval_lineitem_l_quantity_0#9052, cval_lineitem_l_extendedprice#9008 AS cval_lineitem_l_extendedprice_0#9053, cval_lineitem_l_discount#9009 AS cval_lineitem_l_discount_0#9054, cval_lineitem_l_tax#9010 AS cval_lineitem_l_tax_0#9055, cval_lineitem_l_returnflag#9011 AS cval_lineitem_l_returnflag_0#9056, cval_lineitem_l_linestatus#9012 AS cval_lineitem_l_linestatus_0#9057, cval_lineitem_l_commitdate#9013 AS cval_lineitem_l_commitdate_0#9058, cval_lineitem_l_receiptdate#9014 AS cval_lineitem_l_receiptdate_0#9059, cval_lineitem_l_shipinstruct#9015 AS cval_lineitem_l_shipinstruct_0#9060, cval_lineitem_l_shipmode#9016 AS cval_lineitem_l_shipmode_0#9061, cval_lineitem_l_comment#9017 AS cval_lineitem_l_comment_0#9062, cval_lineitem_l_shipdate#9018 AS cval_lineitem_l_shipdate_0#9063, cdepval_lineitem_l_quantity#9019 AS cdepval_lineitem_l_quantity_0#9064, cdepval_lineitem_l_extendedprice#9020 AS cdepval_lineitem_l_extendedprice_0#9065, cdepval_lineitem_l_discount#9021 AS cdepval_lineitem_l_discount_0#9066, ... 21 more fields]
         +- Relation[rid#8998,cpfk_orders_lineitem#8999,cpfk_supplier_lineitem#9000,cfpk_lineitem_supplier#9001,cfpk_lineitem_partsupp#9002,cpfk_part_lineitem#9003,cfpk_lineitem_part#9004,cpfk_partsupp_lineitem#9005,cfpk_lineitem_orders#9006,cval_lineitem_l_quantity#9007,cval_lineitem_l_extendedprice#9008,cval_lineitem_l_discount#9009,cval_lineitem_l_tax#9010,cval_lineitem_l_returnflag#9011,cval_lineitem_l_linestatus#9012,cval_lineitem_l_commitdate#9013,cval_lineitem_l_receiptdate#9014,cval_lineitem_l_shipinstruct#9015,cval_lineitem_l_shipmode#9016,cval_lineitem_l_comment#9017,cval_lineitem_l_shipdate#9018,cdepval_lineitem_l_quantity#9019,cdepval_lineitem_l_extendedprice#9020,cdepval_lineitem_l_discount#9021,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2325ms
query=q1, count=6001215, duration=5115
query=q10, count=1478870, duration=59033
query=q11, count=31680, duration=3693
query=q12, count=857401, duration=22667
query=q13, count=1500000, duration=4374
query=q14, count=6001215, duration=17896
query=q15, count=6001215, duration=17246
query=q16, count=15780, duration=3628
query=q17, count=6088, duration=26472
query=q18, count=6001215, duration=22301
query=q19, count=205, duration=16669
query=q2, count=3162, duration=3569
query=q20, count=632, duration=3594
query=q21a, count=597422, duration=75762
query=q22, count=1500000, duration=4382
query=q3, count=1214743, duration=38703
query=q4, count=6001215, duration=18243
query=q5, count=48089, duration=30651
query=q6, count=6001215, duration=2325
query=q7, count=9735, duration=35184
query=q8, count=8716, duration=44837
query=q9a, count=6001215, duration=63470
query=q9b, count=6001215, duration=38227
