20/04/26 21:49:28 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10983ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sun Apr 26 21:49:32 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sun Apr 26 21:49:33 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sun Apr 26 21:49:33 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sun Apr 26 21:49:33 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sun Apr 26 21:49:33 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sun Apr 26 21:49:37 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sun Apr 26 21:49:41 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sun Apr 26 21:49:41 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/26 21:49:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:49:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2079L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:49:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:49:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:49:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:49:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:49:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:49:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:49:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:49:43 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/26 21:49:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2079L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#2106, cval_part_p_name_0#2107, cval_part_p_mfgr_0#2108, cval_part_p_type_0#2109, cval_part_p_size_0#2110, cval_part_p_container_0#2111, cval_part_p_retailprice_0#2112, cval_part_p_comment_0#2113, cval_part_p_brand_0#2114, cdepval_part_p_name_0#2115, cdepval_part_p_mfgr_0#2116, cdepval_part_p_type_0#2117, cdepval_part_p_size_0#2118, cdepval_part_p_container_0#2119, cdepval_part_p_retailprice_0#2120, cdepval_part_p_comment_0#2121, cdepval_part_p_brand_0#2122, cp_name_0#2123, cp_mfgr_0#2124, cp_type_0#2125, cp_size_0#2126, cp_container_0#2127, cp_retailprice_0#2128, cp_comment_0#2129, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#2081 AS rid_0#2106, cval_part_p_name#2082 AS cval_part_p_name_0#2107, cval_part_p_mfgr#2083 AS cval_part_p_mfgr_0#2108, cval_part_p_type#2084 AS cval_part_p_type_0#2109, cval_part_p_size#2085 AS cval_part_p_size_0#2110, cval_part_p_container#2086 AS cval_part_p_container_0#2111, cval_part_p_retailprice#2087 AS cval_part_p_retailprice_0#2112, cval_part_p_comment#2088 AS cval_part_p_comment_0#2113, cval_part_p_brand#2089 AS cval_part_p_brand_0#2114, cdepval_part_p_name#2090 AS cdepval_part_p_name_0#2115, cdepval_part_p_mfgr#2091 AS cdepval_part_p_mfgr_0#2116, cdepval_part_p_type#2092 AS cdepval_part_p_type_0#2117, cdepval_part_p_size#2093 AS cdepval_part_p_size_0#2118, cdepval_part_p_container#2094 AS cdepval_part_p_container_0#2119, cdepval_part_p_retailprice#2095 AS cdepval_part_p_retailprice_0#2120, cdepval_part_p_comment#2096 AS cdepval_part_p_comment_0#2121, cdepval_part_p_brand#2097 AS cdepval_part_p_brand_0#2122, cp_name#2098 AS cp_name_0#2123, cp_mfgr#2099 AS cp_mfgr_0#2124, cp_type#2100 AS cp_type_0#2125, cp_size#2101 AS cp_size_0#2126, cp_container#2102 AS cp_container_0#2127, cp_retailprice#2103 AS cp_retailprice_0#2128, cp_comment#2104 AS cp_comment_0#2129, cp_brand#2105 AS cp_brand_0#2130]
         :  :        +- Relation[rid#2081,cval_part_p_name#2082,cval_part_p_mfgr#2083,cval_part_p_type#2084,cval_part_p_size#2085,cval_part_p_container#2086,cval_part_p_retailprice#2087,cval_part_p_comment#2088,cval_part_p_brand#2089,cdepval_part_p_name#2090,cdepval_part_p_mfgr#2091,cdepval_part_p_type#2092,cdepval_part_p_size#2093,cdepval_part_p_container#2094,cdepval_part_p_retailprice#2095,cdepval_part_p_comment#2096,cdepval_part_p_brand#2097,cp_name#2098,cp_mfgr#2099,cp_type#2100,cp_size#2101,cp_container#2102,cp_retailprice#2103,cp_comment#2104,cp_brand#2105] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#2551 AS rid_1#2596, cpfk_orders_lineitem#2552 AS cpfk_orders_lineitem_1#2597, cpfk_supplier_lineitem#2553 AS cpfk_supplier_lineitem_1#2598, cfpk_lineitem_supplier#2554 AS cfpk_lineitem_supplier_1#2599, cfpk_lineitem_partsupp#2555 AS cfpk_lineitem_partsupp_1#2600, cpfk_part_lineitem#2556 AS cpfk_part_lineitem_1#2601, cfpk_lineitem_part#2557 AS cfpk_lineitem_part_1#2602, cpfk_partsupp_lineitem#2558 AS cpfk_partsupp_lineitem_1#2603, cfpk_lineitem_orders#2559 AS cfpk_lineitem_orders_1#2604, cval_lineitem_l_quantity#2560 AS cval_lineitem_l_quantity_1#2605, cval_lineitem_l_extendedprice#2561 AS cval_lineitem_l_extendedprice_1#2606, cval_lineitem_l_discount#2562 AS cval_lineitem_l_discount_1#2607, cval_lineitem_l_tax#2563 AS cval_lineitem_l_tax_1#2608, cval_lineitem_l_returnflag#2564 AS cval_lineitem_l_returnflag_1#2609, cval_lineitem_l_linestatus#2565 AS cval_lineitem_l_linestatus_1#2610, cval_lineitem_l_commitdate#2566 AS cval_lineitem_l_commitdate_1#2611, cval_lineitem_l_receiptdate#2567 AS cval_lineitem_l_receiptdate_1#2612, cval_lineitem_l_shipinstruct#2568 AS cval_lineitem_l_shipinstruct_1#2613, cval_lineitem_l_shipmode#2569 AS cval_lineitem_l_shipmode_1#2614, cval_lineitem_l_comment#2570 AS cval_lineitem_l_comment_1#2615, cval_lineitem_l_shipdate#2571 AS cval_lineitem_l_shipdate_1#2616, cdepval_lineitem_l_quantity#2572 AS cdepval_lineitem_l_quantity_1#2617, cdepval_lineitem_l_extendedprice#2573 AS cdepval_lineitem_l_extendedprice_1#2618, cdepval_lineitem_l_discount#2574 AS cdepval_lineitem_l_discount_1#2619, ... 21 more fields]
         :        +- Relation[rid#2551,cpfk_orders_lineitem#2552,cpfk_supplier_lineitem#2553,cfpk_lineitem_supplier#2554,cfpk_lineitem_partsupp#2555,cpfk_part_lineitem#2556,cfpk_lineitem_part#2557,cpfk_partsupp_lineitem#2558,cfpk_lineitem_orders#2559,cval_lineitem_l_quantity#2560,cval_lineitem_l_extendedprice#2561,cval_lineitem_l_discount#2562,cval_lineitem_l_tax#2563,cval_lineitem_l_returnflag#2564,cval_lineitem_l_linestatus#2565,cval_lineitem_l_commitdate#2566,cval_lineitem_l_receiptdate#2567,cval_lineitem_l_shipinstruct#2568,cval_lineitem_l_shipmode#2569,cval_lineitem_l_comment#2570,cval_lineitem_l_shipdate#2571,cdepval_lineitem_l_quantity#2572,cdepval_lineitem_l_extendedprice#2573,cdepval_lineitem_l_discount#2574,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#2231 AS rid_1#2276, cpfk_orders_lineitem#2232 AS cpfk_orders_lineitem_1#2277, cpfk_supplier_lineitem#2233 AS cpfk_supplier_lineitem_1#2278, cfpk_lineitem_supplier#2234 AS cfpk_lineitem_supplier_1#2279, cfpk_lineitem_partsupp#2235 AS cfpk_lineitem_partsupp_1#2280, cpfk_part_lineitem#2236 AS cpfk_part_lineitem_1#2281, cfpk_lineitem_part#2237 AS cfpk_lineitem_part_1#2282, cpfk_partsupp_lineitem#2238 AS cpfk_partsupp_lineitem_1#2283, cfpk_lineitem_orders#2239 AS cfpk_lineitem_orders_1#2284, cval_lineitem_l_quantity#2240 AS cval_lineitem_l_quantity_1#2285, cval_lineitem_l_extendedprice#2241 AS cval_lineitem_l_extendedprice_1#2286, cval_lineitem_l_discount#2242 AS cval_lineitem_l_discount_1#2287, cval_lineitem_l_tax#2243 AS cval_lineitem_l_tax_1#2288, cval_lineitem_l_returnflag#2244 AS cval_lineitem_l_returnflag_1#2289, cval_lineitem_l_linestatus#2245 AS cval_lineitem_l_linestatus_1#2290, cval_lineitem_l_commitdate#2246 AS cval_lineitem_l_commitdate_1#2291, cval_lineitem_l_receiptdate#2247 AS cval_lineitem_l_receiptdate_1#2292, cval_lineitem_l_shipinstruct#2248 AS cval_lineitem_l_shipinstruct_1#2293, cval_lineitem_l_shipmode#2249 AS cval_lineitem_l_shipmode_1#2294, cval_lineitem_l_comment#2250 AS cval_lineitem_l_comment_1#2295, cval_lineitem_l_shipdate#2251 AS cval_lineitem_l_shipdate_1#2296, cdepval_lineitem_l_quantity#2252 AS cdepval_lineitem_l_quantity_1#2297, cdepval_lineitem_l_extendedprice#2253 AS cdepval_lineitem_l_extendedprice_1#2298, cdepval_lineitem_l_discount#2254 AS cdepval_lineitem_l_discount_1#2299, ... 21 more fields]
                  +- Relation[rid#2231,cpfk_orders_lineitem#2232,cpfk_supplier_lineitem#2233,cfpk_lineitem_supplier#2234,cfpk_lineitem_partsupp#2235,cpfk_part_lineitem#2236,cfpk_lineitem_part#2237,cpfk_partsupp_lineitem#2238,cfpk_lineitem_orders#2239,cval_lineitem_l_quantity#2240,cval_lineitem_l_extendedprice#2241,cval_lineitem_l_discount#2242,cval_lineitem_l_tax#2243,cval_lineitem_l_returnflag#2244,cval_lineitem_l_linestatus#2245,cval_lineitem_l_commitdate#2246,cval_lineitem_l_receiptdate#2247,cval_lineitem_l_shipinstruct#2248,cval_lineitem_l_shipmode#2249,cval_lineitem_l_comment#2250,cval_lineitem_l_shipdate#2251,cdepval_lineitem_l_quantity#2252,cdepval_lineitem_l_extendedprice#2253,cdepval_lineitem_l_discount#2254,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 16583ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/26 21:49:59 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:49:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2719L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:49:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:49:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:49:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:49:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:49:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:49:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:49:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:49:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:49:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:49:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:49:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:49:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:50:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:50:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:50:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2719L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#2847 AS rid_2#2892, cpfk_orders_lineitem#2848 AS cpfk_orders_lineitem_2#2893, cpfk_supplier_lineitem#2849 AS cpfk_supplier_lineitem_2#2894, cfpk_lineitem_supplier#2850 AS cfpk_lineitem_supplier_2#2895, cfpk_lineitem_partsupp#2851 AS cfpk_lineitem_partsupp_2#2896, cpfk_part_lineitem#2852 AS cpfk_part_lineitem_2#2897, cfpk_lineitem_part#2853 AS cfpk_lineitem_part_2#2898, cpfk_partsupp_lineitem#2854 AS cpfk_partsupp_lineitem_2#2899, cfpk_lineitem_orders#2855 AS cfpk_lineitem_orders_2#2900, cval_lineitem_l_quantity#2856 AS cval_lineitem_l_quantity_2#2901, cval_lineitem_l_extendedprice#2857 AS cval_lineitem_l_extendedprice_2#2902, cval_lineitem_l_discount#2858 AS cval_lineitem_l_discount_2#2903, cval_lineitem_l_tax#2859 AS cval_lineitem_l_tax_2#2904, cval_lineitem_l_returnflag#2860 AS cval_lineitem_l_returnflag_2#2905, cval_lineitem_l_linestatus#2861 AS cval_lineitem_l_linestatus_2#2906, cval_lineitem_l_commitdate#2862 AS cval_lineitem_l_commitdate_2#2907, cval_lineitem_l_receiptdate#2863 AS cval_lineitem_l_receiptdate_2#2908, cval_lineitem_l_shipinstruct#2864 AS cval_lineitem_l_shipinstruct_2#2909, cval_lineitem_l_shipmode#2865 AS cval_lineitem_l_shipmode_2#2910, cval_lineitem_l_comment#2866 AS cval_lineitem_l_comment_2#2911, cval_lineitem_l_shipdate#2867 AS cval_lineitem_l_shipdate_2#2912, cdepval_lineitem_l_quantity#2868 AS cdepval_lineitem_l_quantity_2#2913, cdepval_lineitem_l_extendedprice#2869 AS cdepval_lineitem_l_extendedprice_2#2914, cdepval_lineitem_l_discount#2870 AS cdepval_lineitem_l_discount_2#2915, ... 21 more fields]
         :  :  +- Relation[rid#2847,cpfk_orders_lineitem#2848,cpfk_supplier_lineitem#2849,cfpk_lineitem_supplier#2850,cfpk_lineitem_partsupp#2851,cpfk_part_lineitem#2852,cfpk_lineitem_part#2853,cpfk_partsupp_lineitem#2854,cfpk_lineitem_orders#2855,cval_lineitem_l_quantity#2856,cval_lineitem_l_extendedprice#2857,cval_lineitem_l_discount#2858,cval_lineitem_l_tax#2859,cval_lineitem_l_returnflag#2860,cval_lineitem_l_linestatus#2861,cval_lineitem_l_commitdate#2862,cval_lineitem_l_receiptdate#2863,cval_lineitem_l_shipinstruct#2864,cval_lineitem_l_shipmode#2865,cval_lineitem_l_comment#2866,cval_lineitem_l_shipdate#2867,cdepval_lineitem_l_quantity#2868,cdepval_lineitem_l_extendedprice#2869,cdepval_lineitem_l_discount#2870,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join UsingJoin(Inner,List(rid_1))
         :     :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#2730, cpfk_region_nation_0#2731, cfpk_nation_region_0#2732, cval_nation_n_name_0#2733, cval_nation_n_comment_0#2734, cdepval_nation_n_name_0#2735, cdepval_nation_n_comment_0#2736, cn_name_0#2737, cn_comment_0#2738, 'rid_1]
         :     :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :     :  :  +- Project [rid#2721 AS rid_0#2730, cpfk_region_nation#2722 AS cpfk_region_nation_0#2731, cfpk_nation_region#2723 AS cfpk_nation_region_0#2732, cval_nation_n_name#2724 AS cval_nation_n_name_0#2733, cval_nation_n_comment#2725 AS cval_nation_n_comment_0#2734, cdepval_nation_n_name#2726 AS cdepval_nation_n_name_0#2735, cdepval_nation_n_comment#2727 AS cdepval_nation_n_comment_0#2736, cn_name#2728 AS cn_name_0#2737, cn_comment#2729 AS cn_comment_0#2738]
         :     :  :     +- Relation[rid#2721,cpfk_region_nation#2722,cfpk_nation_region#2723,cval_nation_n_name#2724,cval_nation_n_comment#2725,cdepval_nation_n_name#2726,cdepval_nation_n_comment#2727,cn_name#2728,cn_comment#2729] JDBCRelation(tnation) [numPartitions=1]
         :     :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
         :     :     +- Project [rid#2811 AS rid_1#2829, cpfk_nation_supplier#2812 AS cpfk_nation_supplier_1#2830, cfpk_supplier_nation#2813 AS cfpk_supplier_nation_1#2831, cval_supplier_s_name#2814 AS cval_supplier_s_name_1#2832, cval_supplier_s_address#2815 AS cval_supplier_s_address_1#2833, cval_supplier_s_phone#2816 AS cval_supplier_s_phone_1#2834, cval_supplier_s_acctbal#2817 AS cval_supplier_s_acctbal_1#2835, cval_supplier_s_comment#2818 AS cval_supplier_s_comment_1#2836, cdepval_supplier_s_name#2819 AS cdepval_supplier_s_name_1#2837, cdepval_supplier_s_address#2820 AS cdepval_supplier_s_address_1#2838, cdepval_supplier_s_phone#2821 AS cdepval_supplier_s_phone_1#2839, cdepval_supplier_s_acctbal#2822 AS cdepval_supplier_s_acctbal_1#2840, cdepval_supplier_s_comment#2823 AS cdepval_supplier_s_comment_1#2841, cs_name#2824 AS cs_name_1#2842, cs_address#2825 AS cs_address_1#2843, cs_phone#2826 AS cs_phone_1#2844, cs_acctbal#2827 AS cs_acctbal_1#2845, cs_comment#2828 AS cs_comment_1#2846]
         :     :        +- Relation[rid#2811,cpfk_nation_supplier#2812,cfpk_supplier_nation#2813,cval_supplier_s_name#2814,cval_supplier_s_address#2815,cval_supplier_s_phone#2816,cval_supplier_s_acctbal#2817,cval_supplier_s_comment#2818,cdepval_supplier_s_name#2819,cdepval_supplier_s_address#2820,cdepval_supplier_s_phone#2821,cdepval_supplier_s_acctbal#2822,cdepval_supplier_s_comment#2823,cs_name#2824,cs_address#2825,cs_phone#2826,cs_acctbal#2827,cs_comment#2828] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#2757 AS rid_1#2775, cpfk_nation_supplier#2758 AS cpfk_nation_supplier_1#2776, cfpk_supplier_nation#2759 AS cfpk_supplier_nation_1#2777, cval_supplier_s_name#2760 AS cval_supplier_s_name_1#2778, cval_supplier_s_address#2761 AS cval_supplier_s_address_1#2779, cval_supplier_s_phone#2762 AS cval_supplier_s_phone_1#2780, cval_supplier_s_acctbal#2763 AS cval_supplier_s_acctbal_1#2781, cval_supplier_s_comment#2764 AS cval_supplier_s_comment_1#2782, cdepval_supplier_s_name#2765 AS cdepval_supplier_s_name_1#2783, cdepval_supplier_s_address#2766 AS cdepval_supplier_s_address_1#2784, cdepval_supplier_s_phone#2767 AS cdepval_supplier_s_phone_1#2785, cdepval_supplier_s_acctbal#2768 AS cdepval_supplier_s_acctbal_1#2786, cdepval_supplier_s_comment#2769 AS cdepval_supplier_s_comment_1#2787, cs_name#2770 AS cs_name_1#2788, cs_address#2771 AS cs_address_1#2789, cs_phone#2772 AS cs_phone_1#2790, cs_acctbal#2773 AS cs_acctbal_1#2791, cs_comment#2774 AS cs_comment_1#2792]
         :        +- Relation[rid#2757,cpfk_nation_supplier#2758,cfpk_supplier_nation#2759,cval_supplier_s_name#2760,cval_supplier_s_address#2761,cval_supplier_s_phone#2762,cval_supplier_s_acctbal#2763,cval_supplier_s_comment#2764,cdepval_supplier_s_name#2765,cdepval_supplier_s_address#2766,cdepval_supplier_s_phone#2767,cdepval_supplier_s_acctbal#2768,cdepval_supplier_s_comment#2769,cs_name#2770,cs_address#2771,cs_phone#2772,cs_acctbal#2773,cs_comment#2774] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#3075 AS rid_5#3099, cpfk_customer_orders#3076 AS cpfk_customer_orders_5#3100, cfpk_orders_customer#3077 AS cfpk_orders_customer_5#3101, cval_orders_o_orderstatus#3078 AS cval_orders_o_orderstatus_5#3102, cval_orders_o_totalprice#3079 AS cval_orders_o_totalprice_5#3103, cval_orders_o_orderpriority#3080 AS cval_orders_o_orderpriority_5#3104, cval_orders_o_clerk#3081 AS cval_orders_o_clerk_5#3105, cval_orders_o_shippriority#3082 AS cval_orders_o_shippriority_5#3106, cval_orders_o_comment#3083 AS cval_orders_o_comment_5#3107, cval_orders_o_orderdate#3084 AS cval_orders_o_orderdate_5#3108, cdepval_orders_o_orderstatus#3085 AS cdepval_orders_o_orderstatus_5#3109, cdepval_orders_o_totalprice#3086 AS cdepval_orders_o_totalprice_5#3110, cdepval_orders_o_orderpriority#3087 AS cdepval_orders_o_orderpriority_5#3111, cdepval_orders_o_clerk#3088 AS cdepval_orders_o_clerk_5#3112, cdepval_orders_o_shippriority#3089 AS cdepval_orders_o_shippriority_5#3113, cdepval_orders_o_comment#3090 AS cdepval_orders_o_comment_5#3114, cdepval_orders_o_orderdate#3091 AS cdepval_orders_o_orderdate_5#3115, co_orderstatus#3092 AS co_orderstatus_5#3116, co_totalprice#3093 AS co_totalprice_5#3117, co_orderpriority#3094 AS co_orderpriority_5#3118, co_clerk#3095 AS co_clerk_5#3119, co_shippriority#3096 AS co_shippriority_5#3120, co_comment#3097 AS co_comment_5#3121, co_orderdate#3098 AS co_orderdate_5#3122]
            :  +- Relation[rid#3075,cpfk_customer_orders#3076,cfpk_orders_customer#3077,cval_orders_o_orderstatus#3078,cval_orders_o_totalprice#3079,cval_orders_o_orderpriority#3080,cval_orders_o_clerk#3081,cval_orders_o_shippriority#3082,cval_orders_o_comment#3083,cval_orders_o_orderdate#3084,cdepval_orders_o_orderstatus#3085,cdepval_orders_o_totalprice#3086,cdepval_orders_o_orderpriority#3087,cdepval_orders_o_clerk#3088,cdepval_orders_o_shippriority#3089,cdepval_orders_o_comment#3090,cdepval_orders_o_orderdate#3091,co_orderstatus#3092,co_totalprice#3093,co_orderpriority#3094,co_clerk#3095,co_shippriority#3096,co_comment#3097,co_orderdate#3098] JDBCRelation(torders) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_4))
               :- 'DexPkfkMaterializationAwareJoin nation~customer, 'cpfk_nation_customer_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#2946, cpfk_region_nation_3#2947, cfpk_nation_region_3#2948, cval_nation_n_name_3#2949, cval_nation_n_comment_3#2950, cdepval_nation_n_name_3#2951, cdepval_nation_n_comment_3#2952, cn_name_3#2953, cn_comment_3#2954, 'rid_4]
               :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
               :  :  +- Project [rid#2937 AS rid_3#2946, cpfk_region_nation#2938 AS cpfk_region_nation_3#2947, cfpk_nation_region#2939 AS cfpk_nation_region_3#2948, cval_nation_n_name#2940 AS cval_nation_n_name_3#2949, cval_nation_n_comment#2941 AS cval_nation_n_comment_3#2950, cdepval_nation_n_name#2942 AS cdepval_nation_n_name_3#2951, cdepval_nation_n_comment#2943 AS cdepval_nation_n_comment_3#2952, cn_name#2944 AS cn_name_3#2953, cn_comment#2945 AS cn_comment_3#2954]
               :  :     +- Relation[rid#2937,cpfk_region_nation#2938,cfpk_nation_region#2939,cval_nation_n_name#2940,cval_nation_n_comment#2941,cdepval_nation_n_name#2942,cdepval_nation_n_comment#2943,cn_name#2944,cn_comment#2945] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'Project ['cpfk_nation_customer_4, 'rid_4]
               :     +- Project [rid#3033 AS rid_4#3054, cpfk_nation_customer#3034 AS cpfk_nation_customer_4#3055, cfpk_customer_nation#3035 AS cfpk_customer_nation_4#3056, cval_customer_c_name#3036 AS cval_customer_c_name_4#3057, cval_customer_c_address#3037 AS cval_customer_c_address_4#3058, cval_customer_c_phone#3038 AS cval_customer_c_phone_4#3059, cval_customer_c_acctbal#3039 AS cval_customer_c_acctbal_4#3060, cval_customer_c_comment#3040 AS cval_customer_c_comment_4#3061, cval_customer_c_mktsegment#3041 AS cval_customer_c_mktsegment_4#3062, cdepval_customer_c_name#3042 AS cdepval_customer_c_name_4#3063, cdepval_customer_c_address#3043 AS cdepval_customer_c_address_4#3064, cdepval_customer_c_phone#3044 AS cdepval_customer_c_phone_4#3065, cdepval_customer_c_acctbal#3045 AS cdepval_customer_c_acctbal_4#3066, cdepval_customer_c_comment#3046 AS cdepval_customer_c_comment_4#3067, cdepval_customer_c_mktsegment#3047 AS cdepval_customer_c_mktsegment_4#3068, cc_name#3048 AS cc_name_4#3069, cc_address#3049 AS cc_address_4#3070, cc_phone#3050 AS cc_phone_4#3071, cc_acctbal#3051 AS cc_acctbal_4#3072, cc_comment#3052 AS cc_comment_4#3073, cc_mktsegment#3053 AS cc_mktsegment_4#3074]
               :        +- Relation[rid#3033,cpfk_nation_customer#3034,cfpk_customer_nation#3035,cval_customer_c_name#3036,cval_customer_c_address#3037,cval_customer_c_phone#3038,cval_customer_c_acctbal#3039,cval_customer_c_comment#3040,cval_customer_c_mktsegment#3041,cdepval_customer_c_name#3042,cdepval_customer_c_address#3043,cdepval_customer_c_phone#3044,cdepval_customer_c_acctbal#3045,cdepval_customer_c_comment#3046,cdepval_customer_c_mktsegment#3047,cc_name#3048,cc_address#3049,cc_phone#3050,cc_acctbal#3051,cc_comment#3052,cc_mktsegment#3053] JDBCRelation(tcustomer) [numPartitions=1]
               +- Project [rid#2973 AS rid_4#2994, cpfk_nation_customer#2974 AS cpfk_nation_customer_4#2995, cfpk_customer_nation#2975 AS cfpk_customer_nation_4#2996, cval_customer_c_name#2976 AS cval_customer_c_name_4#2997, cval_customer_c_address#2977 AS cval_customer_c_address_4#2998, cval_customer_c_phone#2978 AS cval_customer_c_phone_4#2999, cval_customer_c_acctbal#2979 AS cval_customer_c_acctbal_4#3000, cval_customer_c_comment#2980 AS cval_customer_c_comment_4#3001, cval_customer_c_mktsegment#2981 AS cval_customer_c_mktsegment_4#3002, cdepval_customer_c_name#2982 AS cdepval_customer_c_name_4#3003, cdepval_customer_c_address#2983 AS cdepval_customer_c_address_4#3004, cdepval_customer_c_phone#2984 AS cdepval_customer_c_phone_4#3005, cdepval_customer_c_acctbal#2985 AS cdepval_customer_c_acctbal_4#3006, cdepval_customer_c_comment#2986 AS cdepval_customer_c_comment_4#3007, cdepval_customer_c_mktsegment#2987 AS cdepval_customer_c_mktsegment_4#3008, cc_name#2988 AS cc_name_4#3009, cc_address#2989 AS cc_address_4#3010, cc_phone#2990 AS cc_phone_4#3011, cc_acctbal#2991 AS cc_acctbal_4#3012, cc_comment#2992 AS cc_comment_4#3013, cc_mktsegment#2993 AS cc_mktsegment_4#3014]
                  +- Relation[rid#2973,cpfk_nation_customer#2974,cfpk_customer_nation#2975,cval_customer_c_name#2976,cval_customer_c_address#2977,cval_customer_c_phone#2978,cval_customer_c_acctbal#2979,cval_customer_c_comment#2980,cval_customer_c_mktsegment#2981,cdepval_customer_c_name#2982,cdepval_customer_c_address#2983,cdepval_customer_c_phone#2984,cdepval_customer_c_acctbal#2985,cdepval_customer_c_comment#2986,cdepval_customer_c_mktsegment#2987,cc_name#2988,cc_address#2989,cc_phone#2990,cc_acctbal#2991,cc_comment#2992,cc_mktsegment#2993] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 40814ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/26 21:50:40 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:50:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3254L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:50:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#3254L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#3256 AS rid_0#3301, cpfk_orders_lineitem#3257 AS cpfk_orders_lineitem_0#3302, cpfk_supplier_lineitem#3258 AS cpfk_supplier_lineitem_0#3303, cfpk_lineitem_supplier#3259 AS cfpk_lineitem_supplier_0#3304, cfpk_lineitem_partsupp#3260 AS cfpk_lineitem_partsupp_0#3305, cpfk_part_lineitem#3261 AS cpfk_part_lineitem_0#3306, cfpk_lineitem_part#3262 AS cfpk_lineitem_part_0#3307, cpfk_partsupp_lineitem#3263 AS cpfk_partsupp_lineitem_0#3308, cfpk_lineitem_orders#3264 AS cfpk_lineitem_orders_0#3309, cval_lineitem_l_quantity#3265 AS cval_lineitem_l_quantity_0#3310, cval_lineitem_l_extendedprice#3266 AS cval_lineitem_l_extendedprice_0#3311, cval_lineitem_l_discount#3267 AS cval_lineitem_l_discount_0#3312, cval_lineitem_l_tax#3268 AS cval_lineitem_l_tax_0#3313, cval_lineitem_l_returnflag#3269 AS cval_lineitem_l_returnflag_0#3314, cval_lineitem_l_linestatus#3270 AS cval_lineitem_l_linestatus_0#3315, cval_lineitem_l_commitdate#3271 AS cval_lineitem_l_commitdate_0#3316, cval_lineitem_l_receiptdate#3272 AS cval_lineitem_l_receiptdate_0#3317, cval_lineitem_l_shipinstruct#3273 AS cval_lineitem_l_shipinstruct_0#3318, cval_lineitem_l_shipmode#3274 AS cval_lineitem_l_shipmode_0#3319, cval_lineitem_l_comment#3275 AS cval_lineitem_l_comment_0#3320, cval_lineitem_l_shipdate#3276 AS cval_lineitem_l_shipdate_0#3321, cdepval_lineitem_l_quantity#3277 AS cdepval_lineitem_l_quantity_0#3322, cdepval_lineitem_l_extendedprice#3278 AS cdepval_lineitem_l_extendedprice_0#3323, cdepval_lineitem_l_discount#3279 AS cdepval_lineitem_l_discount_0#3324, ... 21 more fields]
         +- Relation[rid#3256,cpfk_orders_lineitem#3257,cpfk_supplier_lineitem#3258,cfpk_lineitem_supplier#3259,cfpk_lineitem_partsupp#3260,cpfk_part_lineitem#3261,cfpk_lineitem_part#3262,cpfk_partsupp_lineitem#3263,cfpk_lineitem_orders#3264,cval_lineitem_l_quantity#3265,cval_lineitem_l_extendedprice#3266,cval_lineitem_l_discount#3267,cval_lineitem_l_tax#3268,cval_lineitem_l_returnflag#3269,cval_lineitem_l_linestatus#3270,cval_lineitem_l_commitdate#3271,cval_lineitem_l_receiptdate#3272,cval_lineitem_l_shipinstruct#3273,cval_lineitem_l_shipmode#3274,cval_lineitem_l_comment#3275,cval_lineitem_l_shipdate#3276,cdepval_lineitem_l_quantity#3277,cdepval_lineitem_l_extendedprice#3278,cdepval_lineitem_l_discount#3279,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2394ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 21:50:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:50:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3400L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:50:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:50:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:50:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:50:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:50:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:50:43 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:50:43 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:50:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3400L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#3456 AS rid_2#3501, cpfk_orders_lineitem#3457 AS cpfk_orders_lineitem_2#3502, cpfk_supplier_lineitem#3458 AS cpfk_supplier_lineitem_2#3503, cfpk_lineitem_supplier#3459 AS cfpk_lineitem_supplier_2#3504, cfpk_lineitem_partsupp#3460 AS cfpk_lineitem_partsupp_2#3505, cpfk_part_lineitem#3461 AS cpfk_part_lineitem_2#3506, cfpk_lineitem_part#3462 AS cfpk_lineitem_part_2#3507, cpfk_partsupp_lineitem#3463 AS cpfk_partsupp_lineitem_2#3508, cfpk_lineitem_orders#3464 AS cfpk_lineitem_orders_2#3509, cval_lineitem_l_quantity#3465 AS cval_lineitem_l_quantity_2#3510, cval_lineitem_l_extendedprice#3466 AS cval_lineitem_l_extendedprice_2#3511, cval_lineitem_l_discount#3467 AS cval_lineitem_l_discount_2#3512, cval_lineitem_l_tax#3468 AS cval_lineitem_l_tax_2#3513, cval_lineitem_l_returnflag#3469 AS cval_lineitem_l_returnflag_2#3514, cval_lineitem_l_linestatus#3470 AS cval_lineitem_l_linestatus_2#3515, cval_lineitem_l_commitdate#3471 AS cval_lineitem_l_commitdate_2#3516, cval_lineitem_l_receiptdate#3472 AS cval_lineitem_l_receiptdate_2#3517, cval_lineitem_l_shipinstruct#3473 AS cval_lineitem_l_shipinstruct_2#3518, cval_lineitem_l_shipmode#3474 AS cval_lineitem_l_shipmode_2#3519, cval_lineitem_l_comment#3475 AS cval_lineitem_l_comment_2#3520, cval_lineitem_l_shipdate#3476 AS cval_lineitem_l_shipdate_2#3521, cdepval_lineitem_l_quantity#3477 AS cdepval_lineitem_l_quantity_2#3522, cdepval_lineitem_l_extendedprice#3478 AS cdepval_lineitem_l_extendedprice_2#3523, cdepval_lineitem_l_discount#3479 AS cdepval_lineitem_l_discount_2#3524, ... 21 more fields]
         :  :  :  :  +- Relation[rid#3456,cpfk_orders_lineitem#3457,cpfk_supplier_lineitem#3458,cfpk_lineitem_supplier#3459,cfpk_lineitem_partsupp#3460,cpfk_part_lineitem#3461,cfpk_lineitem_part#3462,cpfk_partsupp_lineitem#3463,cfpk_lineitem_orders#3464,cval_lineitem_l_quantity#3465,cval_lineitem_l_extendedprice#3466,cval_lineitem_l_discount#3467,cval_lineitem_l_tax#3468,cval_lineitem_l_returnflag#3469,cval_lineitem_l_linestatus#3470,cval_lineitem_l_commitdate#3471,cval_lineitem_l_receiptdate#3472,cval_lineitem_l_shipinstruct#3473,cval_lineitem_l_shipmode#3474,cval_lineitem_l_comment#3475,cval_lineitem_l_shipdate#3476,cdepval_lineitem_l_quantity#3477,cdepval_lineitem_l_extendedprice#3478,cdepval_lineitem_l_discount#3479,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#3420 AS rid_1#3438, cpfk_nation_supplier#3421 AS cpfk_nation_supplier_1#3439, cfpk_supplier_nation#3422 AS cfpk_supplier_nation_1#3440, cval_supplier_s_name#3423 AS cval_supplier_s_name_1#3441, cval_supplier_s_address#3424 AS cval_supplier_s_address_1#3442, cval_supplier_s_phone#3425 AS cval_supplier_s_phone_1#3443, cval_supplier_s_acctbal#3426 AS cval_supplier_s_acctbal_1#3444, cval_supplier_s_comment#3427 AS cval_supplier_s_comment_1#3445, cdepval_supplier_s_name#3428 AS cdepval_supplier_s_name_1#3446, cdepval_supplier_s_address#3429 AS cdepval_supplier_s_address_1#3447, cdepval_supplier_s_phone#3430 AS cdepval_supplier_s_phone_1#3448, cdepval_supplier_s_acctbal#3431 AS cdepval_supplier_s_acctbal_1#3449, cdepval_supplier_s_comment#3432 AS cdepval_supplier_s_comment_1#3450, cs_name#3433 AS cs_name_1#3451, cs_address#3434 AS cs_address_1#3452, cs_phone#3435 AS cs_phone_1#3453, cs_acctbal#3436 AS cs_acctbal_1#3454, cs_comment#3437 AS cs_comment_1#3455]
         :  :  :     :  +- Relation[rid#3420,cpfk_nation_supplier#3421,cfpk_supplier_nation#3422,cval_supplier_s_name#3423,cval_supplier_s_address#3424,cval_supplier_s_phone#3425,cval_supplier_s_acctbal#3426,cval_supplier_s_comment#3427,cdepval_supplier_s_name#3428,cdepval_supplier_s_address#3429,cdepval_supplier_s_phone#3430,cdepval_supplier_s_acctbal#3431,cdepval_supplier_s_comment#3432,cs_name#3433,cs_address#3434,cs_phone#3435,cs_acctbal#3436,cs_comment#3437] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#3402 AS rid_0#3411, cpfk_region_nation#3403 AS cpfk_region_nation_0#3412, cfpk_nation_region#3404 AS cfpk_nation_region_0#3413, cval_nation_n_name#3405 AS cval_nation_n_name_0#3414, cval_nation_n_comment#3406 AS cval_nation_n_comment_0#3415, cdepval_nation_n_name#3407 AS cdepval_nation_n_name_0#3416, cdepval_nation_n_comment#3408 AS cdepval_nation_n_comment_0#3417, cn_name#3409 AS cn_name_0#3418, cn_comment#3410 AS cn_comment_0#3419]
         :  :  :        +- Relation[rid#3402,cpfk_region_nation#3403,cfpk_nation_region#3404,cval_nation_n_name#3405,cval_nation_n_comment#3406,cdepval_nation_n_name#3407,cdepval_nation_n_comment#3408,cn_name#3409,cn_comment#3410] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#3546 AS rid_3#3571, cval_part_p_name#3547 AS cval_part_p_name_3#3572, cval_part_p_mfgr#3548 AS cval_part_p_mfgr_3#3573, cval_part_p_type#3549 AS cval_part_p_type_3#3574, cval_part_p_size#3550 AS cval_part_p_size_3#3575, cval_part_p_container#3551 AS cval_part_p_container_3#3576, cval_part_p_retailprice#3552 AS cval_part_p_retailprice_3#3577, cval_part_p_comment#3553 AS cval_part_p_comment_3#3578, cval_part_p_brand#3554 AS cval_part_p_brand_3#3579, cdepval_part_p_name#3555 AS cdepval_part_p_name_3#3580, cdepval_part_p_mfgr#3556 AS cdepval_part_p_mfgr_3#3581, cdepval_part_p_type#3557 AS cdepval_part_p_type_3#3582, cdepval_part_p_size#3558 AS cdepval_part_p_size_3#3583, cdepval_part_p_container#3559 AS cdepval_part_p_container_3#3584, cdepval_part_p_retailprice#3560 AS cdepval_part_p_retailprice_3#3585, cdepval_part_p_comment#3561 AS cdepval_part_p_comment_3#3586, cdepval_part_p_brand#3562 AS cdepval_part_p_brand_3#3587, cp_name#3563 AS cp_name_3#3588, cp_mfgr#3564 AS cp_mfgr_3#3589, cp_type#3565 AS cp_type_3#3590, cp_size#3566 AS cp_size_3#3591, cp_container#3567 AS cp_container_3#3592, cp_retailprice#3568 AS cp_retailprice_3#3593, cp_comment#3569 AS cp_comment_3#3594, cp_brand#3570 AS cp_brand_3#3595]
         :  :     +- Relation[rid#3546,cval_part_p_name#3547,cval_part_p_mfgr#3548,cval_part_p_type#3549,cval_part_p_size#3550,cval_part_p_container#3551,cval_part_p_retailprice#3552,cval_part_p_comment#3553,cval_part_p_brand#3554,cdepval_part_p_name#3555,cdepval_part_p_mfgr#3556,cdepval_part_p_type#3557,cdepval_part_p_size#3558,cdepval_part_p_container#3559,cdepval_part_p_retailprice#3560,cdepval_part_p_comment#3561,cdepval_part_p_brand#3562,cp_name#3563,cp_mfgr#3564,cp_type#3565,cp_size#3566,cp_container#3567,cp_retailprice#3568,cp_comment#3569,cp_brand#3570] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#3596 AS rid_4#3610, cpfk_part_partsupp#3597 AS cpfk_part_partsupp_4#3611, cfpk_partsupp_part#3598 AS cfpk_partsupp_part_4#3612, cpfk_supplier_partsupp#3599 AS cpfk_supplier_partsupp_4#3613, cfpk_partsupp_supplier#3600 AS cfpk_partsupp_supplier_4#3614, cval_partsupp_ps_availqty#3601 AS cval_partsupp_ps_availqty_4#3615, cval_partsupp_ps_supplycost#3602 AS cval_partsupp_ps_supplycost_4#3616, cval_partsupp_ps_comment#3603 AS cval_partsupp_ps_comment_4#3617, cdepval_partsupp_ps_availqty#3604 AS cdepval_partsupp_ps_availqty_4#3618, cdepval_partsupp_ps_supplycost#3605 AS cdepval_partsupp_ps_supplycost_4#3619, cdepval_partsupp_ps_comment#3606 AS cdepval_partsupp_ps_comment_4#3620, cps_availqty#3607 AS cps_availqty_4#3621, cps_supplycost#3608 AS cps_supplycost_4#3622, cps_comment#3609 AS cps_comment_4#3623]
         :     +- Relation[rid#3596,cpfk_part_partsupp#3597,cfpk_partsupp_part#3598,cpfk_supplier_partsupp#3599,cfpk_partsupp_supplier#3600,cval_partsupp_ps_availqty#3601,cval_partsupp_ps_supplycost#3602,cval_partsupp_ps_comment#3603,cdepval_partsupp_ps_availqty#3604,cdepval_partsupp_ps_supplycost#3605,cdepval_partsupp_ps_comment#3606,cps_availqty#3607,cps_supplycost#3608,cps_comment#3609] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#3624 AS rid_5#3648, cpfk_customer_orders#3625 AS cpfk_customer_orders_5#3649, cfpk_orders_customer#3626 AS cfpk_orders_customer_5#3650, cval_orders_o_orderstatus#3627 AS cval_orders_o_orderstatus_5#3651, cval_orders_o_totalprice#3628 AS cval_orders_o_totalprice_5#3652, cval_orders_o_orderpriority#3629 AS cval_orders_o_orderpriority_5#3653, cval_orders_o_clerk#3630 AS cval_orders_o_clerk_5#3654, cval_orders_o_shippriority#3631 AS cval_orders_o_shippriority_5#3655, cval_orders_o_comment#3632 AS cval_orders_o_comment_5#3656, cval_orders_o_orderdate#3633 AS cval_orders_o_orderdate_5#3657, cdepval_orders_o_orderstatus#3634 AS cdepval_orders_o_orderstatus_5#3658, cdepval_orders_o_totalprice#3635 AS cdepval_orders_o_totalprice_5#3659, cdepval_orders_o_orderpriority#3636 AS cdepval_orders_o_orderpriority_5#3660, cdepval_orders_o_clerk#3637 AS cdepval_orders_o_clerk_5#3661, cdepval_orders_o_shippriority#3638 AS cdepval_orders_o_shippriority_5#3662, cdepval_orders_o_comment#3639 AS cdepval_orders_o_comment_5#3663, cdepval_orders_o_orderdate#3640 AS cdepval_orders_o_orderdate_5#3664, co_orderstatus#3641 AS co_orderstatus_5#3665, co_totalprice#3642 AS co_totalprice_5#3666, co_orderpriority#3643 AS co_orderpriority_5#3667, co_clerk#3644 AS co_clerk_5#3668, co_shippriority#3645 AS co_shippriority_5#3669, co_comment#3646 AS co_comment_5#3670, co_orderdate#3647 AS co_orderdate_5#3671]
            +- Relation[rid#3624,cpfk_customer_orders#3625,cfpk_orders_customer#3626,cval_orders_o_orderstatus#3627,cval_orders_o_totalprice#3628,cval_orders_o_orderpriority#3629,cval_orders_o_clerk#3630,cval_orders_o_shippriority#3631,cval_orders_o_comment#3632,cval_orders_o_orderdate#3633,cdepval_orders_o_orderstatus#3634,cdepval_orders_o_totalprice#3635,cdepval_orders_o_orderpriority#3636,cdepval_orders_o_clerk#3637,cdepval_orders_o_shippriority#3638,cdepval_orders_o_comment#3639,cdepval_orders_o_orderdate#3640,co_orderstatus#3641,co_totalprice#3642,co_orderpriority#3643,co_clerk#3644,co_shippriority#3645,co_comment#3646,co_orderdate#3647] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 62942ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/26 21:51:46 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:51:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3815L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:51:46 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:51:46 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:51:46 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:51:46 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:51:46 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:51:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3815L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#4039 AS rid_2#4084, cpfk_orders_lineitem#4040 AS cpfk_orders_lineitem_2#4085, cpfk_supplier_lineitem#4041 AS cpfk_supplier_lineitem_2#4086, cfpk_lineitem_supplier#4042 AS cfpk_lineitem_supplier_2#4087, cfpk_lineitem_partsupp#4043 AS cfpk_lineitem_partsupp_2#4088, cpfk_part_lineitem#4044 AS cpfk_part_lineitem_2#4089, cfpk_lineitem_part#4045 AS cfpk_lineitem_part_2#4090, cpfk_partsupp_lineitem#4046 AS cpfk_partsupp_lineitem_2#4091, cfpk_lineitem_orders#4047 AS cfpk_lineitem_orders_2#4092, cval_lineitem_l_quantity#4048 AS cval_lineitem_l_quantity_2#4093, cval_lineitem_l_extendedprice#4049 AS cval_lineitem_l_extendedprice_2#4094, cval_lineitem_l_discount#4050 AS cval_lineitem_l_discount_2#4095, cval_lineitem_l_tax#4051 AS cval_lineitem_l_tax_2#4096, cval_lineitem_l_returnflag#4052 AS cval_lineitem_l_returnflag_2#4097, cval_lineitem_l_linestatus#4053 AS cval_lineitem_l_linestatus_2#4098, cval_lineitem_l_commitdate#4054 AS cval_lineitem_l_commitdate_2#4099, cval_lineitem_l_receiptdate#4055 AS cval_lineitem_l_receiptdate_2#4100, cval_lineitem_l_shipinstruct#4056 AS cval_lineitem_l_shipinstruct_2#4101, cval_lineitem_l_shipmode#4057 AS cval_lineitem_l_shipmode_2#4102, cval_lineitem_l_comment#4058 AS cval_lineitem_l_comment_2#4103, cval_lineitem_l_shipdate#4059 AS cval_lineitem_l_shipdate_2#4104, cdepval_lineitem_l_quantity#4060 AS cdepval_lineitem_l_quantity_2#4105, cdepval_lineitem_l_extendedprice#4061 AS cdepval_lineitem_l_extendedprice_2#4106, cdepval_lineitem_l_discount#4062 AS cdepval_lineitem_l_discount_2#4107, ... 21 more fields]
         :  +- Relation[rid#4039,cpfk_orders_lineitem#4040,cpfk_supplier_lineitem#4041,cfpk_lineitem_supplier#4042,cfpk_lineitem_partsupp#4043,cpfk_part_lineitem#4044,cfpk_lineitem_part#4045,cpfk_partsupp_lineitem#4046,cfpk_lineitem_orders#4047,cval_lineitem_l_quantity#4048,cval_lineitem_l_extendedprice#4049,cval_lineitem_l_discount#4050,cval_lineitem_l_tax#4051,cval_lineitem_l_returnflag#4052,cval_lineitem_l_linestatus#4053,cval_lineitem_l_commitdate#4054,cval_lineitem_l_receiptdate#4055,cval_lineitem_l_shipinstruct#4056,cval_lineitem_l_shipmode#4057,cval_lineitem_l_comment#4058,cval_lineitem_l_shipdate#4059,cdepval_lineitem_l_quantity#4060,cdepval_lineitem_l_extendedprice#4061,cdepval_lineitem_l_discount#4062,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin customer~orders, 'cpfk_customer_orders_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#3838, cpfk_nation_customer_0#3839, cfpk_customer_nation_0#3840, cval_customer_c_name_0#3841, cval_customer_c_address_0#3842, cval_customer_c_phone_0#3843, cval_customer_c_acctbal_0#3844, cval_customer_c_comment_0#3845, cval_customer_c_mktsegment_0#3846, cdepval_customer_c_name_0#3847, cdepval_customer_c_address_0#3848, cdepval_customer_c_phone_0#3849, cdepval_customer_c_acctbal_0#3850, cdepval_customer_c_comment_0#3851, cdepval_customer_c_mktsegment_0#3852, cc_name_0#3853, cc_address_0#3854, cc_phone_0#3855, cc_acctbal_0#3856, cc_comment_0#3857, cc_mktsegment_0#3858, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
            :  :  +- Project [rid#3817 AS rid_0#3838, cpfk_nation_customer#3818 AS cpfk_nation_customer_0#3839, cfpk_customer_nation#3819 AS cfpk_customer_nation_0#3840, cval_customer_c_name#3820 AS cval_customer_c_name_0#3841, cval_customer_c_address#3821 AS cval_customer_c_address_0#3842, cval_customer_c_phone#3822 AS cval_customer_c_phone_0#3843, cval_customer_c_acctbal#3823 AS cval_customer_c_acctbal_0#3844, cval_customer_c_comment#3824 AS cval_customer_c_comment_0#3845, cval_customer_c_mktsegment#3825 AS cval_customer_c_mktsegment_0#3846, cdepval_customer_c_name#3826 AS cdepval_customer_c_name_0#3847, cdepval_customer_c_address#3827 AS cdepval_customer_c_address_0#3848, cdepval_customer_c_phone#3828 AS cdepval_customer_c_phone_0#3849, cdepval_customer_c_acctbal#3829 AS cdepval_customer_c_acctbal_0#3850, cdepval_customer_c_comment#3830 AS cdepval_customer_c_comment_0#3851, cdepval_customer_c_mktsegment#3831 AS cdepval_customer_c_mktsegment_0#3852, cc_name#3832 AS cc_name_0#3853, cc_address#3833 AS cc_address_0#3854, cc_phone#3834 AS cc_phone_0#3855, cc_acctbal#3835 AS cc_acctbal_0#3856, cc_comment#3836 AS cc_comment_0#3857, cc_mktsegment#3837 AS cc_mktsegment_0#3858]
            :  :     +- Relation[rid#3817,cpfk_nation_customer#3818,cfpk_customer_nation#3819,cval_customer_c_name#3820,cval_customer_c_address#3821,cval_customer_c_phone#3822,cval_customer_c_acctbal#3823,cval_customer_c_comment#3824,cval_customer_c_mktsegment#3825,cdepval_customer_c_name#3826,cdepval_customer_c_address#3827,cdepval_customer_c_phone#3828,cdepval_customer_c_acctbal#3829,cdepval_customer_c_comment#3830,cdepval_customer_c_mktsegment#3831,cc_name#3832,cc_address#3833,cc_phone#3834,cc_acctbal#3835,cc_comment#3836,cc_mktsegment#3837] JDBCRelation(tcustomer) [numPartitions=1]
            :  +- 'Project ['cpfk_customer_orders_1, 'rid_1]
            :     +- Project [rid#3991 AS rid_1#4015, cpfk_customer_orders#3992 AS cpfk_customer_orders_1#4016, cfpk_orders_customer#3993 AS cfpk_orders_customer_1#4017, cval_orders_o_orderstatus#3994 AS cval_orders_o_orderstatus_1#4018, cval_orders_o_totalprice#3995 AS cval_orders_o_totalprice_1#4019, cval_orders_o_orderpriority#3996 AS cval_orders_o_orderpriority_1#4020, cval_orders_o_clerk#3997 AS cval_orders_o_clerk_1#4021, cval_orders_o_shippriority#3998 AS cval_orders_o_shippriority_1#4022, cval_orders_o_comment#3999 AS cval_orders_o_comment_1#4023, cval_orders_o_orderdate#4000 AS cval_orders_o_orderdate_1#4024, cdepval_orders_o_orderstatus#4001 AS cdepval_orders_o_orderstatus_1#4025, cdepval_orders_o_totalprice#4002 AS cdepval_orders_o_totalprice_1#4026, cdepval_orders_o_orderpriority#4003 AS cdepval_orders_o_orderpriority_1#4027, cdepval_orders_o_clerk#4004 AS cdepval_orders_o_clerk_1#4028, cdepval_orders_o_shippriority#4005 AS cdepval_orders_o_shippriority_1#4029, cdepval_orders_o_comment#4006 AS cdepval_orders_o_comment_1#4030, cdepval_orders_o_orderdate#4007 AS cdepval_orders_o_orderdate_1#4031, co_orderstatus#4008 AS co_orderstatus_1#4032, co_totalprice#4009 AS co_totalprice_1#4033, co_orderpriority#4010 AS co_orderpriority_1#4034, co_clerk#4011 AS co_clerk_1#4035, co_shippriority#4012 AS co_shippriority_1#4036, co_comment#4013 AS co_comment_1#4037, co_orderdate#4014 AS co_orderdate_1#4038]
            :        +- Relation[rid#3991,cpfk_customer_orders#3992,cfpk_orders_customer#3993,cval_orders_o_orderstatus#3994,cval_orders_o_totalprice#3995,cval_orders_o_orderpriority#3996,cval_orders_o_clerk#3997,cval_orders_o_shippriority#3998,cval_orders_o_comment#3999,cval_orders_o_orderdate#4000,cdepval_orders_o_orderstatus#4001,cdepval_orders_o_totalprice#4002,cdepval_orders_o_orderpriority#4003,cdepval_orders_o_clerk#4004,cdepval_orders_o_shippriority#4005,cdepval_orders_o_comment#4006,cdepval_orders_o_orderdate#4007,co_orderstatus#4008,co_totalprice#4009,co_orderpriority#4010,co_clerk#4011,co_shippriority#4012,co_comment#4013,co_orderdate#4014] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#3901 AS rid_1#3925, cpfk_customer_orders#3902 AS cpfk_customer_orders_1#3926, cfpk_orders_customer#3903 AS cfpk_orders_customer_1#3927, cval_orders_o_orderstatus#3904 AS cval_orders_o_orderstatus_1#3928, cval_orders_o_totalprice#3905 AS cval_orders_o_totalprice_1#3929, cval_orders_o_orderpriority#3906 AS cval_orders_o_orderpriority_1#3930, cval_orders_o_clerk#3907 AS cval_orders_o_clerk_1#3931, cval_orders_o_shippriority#3908 AS cval_orders_o_shippriority_1#3932, cval_orders_o_comment#3909 AS cval_orders_o_comment_1#3933, cval_orders_o_orderdate#3910 AS cval_orders_o_orderdate_1#3934, cdepval_orders_o_orderstatus#3911 AS cdepval_orders_o_orderstatus_1#3935, cdepval_orders_o_totalprice#3912 AS cdepval_orders_o_totalprice_1#3936, cdepval_orders_o_orderpriority#3913 AS cdepval_orders_o_orderpriority_1#3937, cdepval_orders_o_clerk#3914 AS cdepval_orders_o_clerk_1#3938, cdepval_orders_o_shippriority#3915 AS cdepval_orders_o_shippriority_1#3939, cdepval_orders_o_comment#3916 AS cdepval_orders_o_comment_1#3940, cdepval_orders_o_orderdate#3917 AS cdepval_orders_o_orderdate_1#3941, co_orderstatus#3918 AS co_orderstatus_1#3942, co_totalprice#3919 AS co_totalprice_1#3943, co_orderpriority#3920 AS co_orderpriority_1#3944, co_clerk#3921 AS co_clerk_1#3945, co_shippriority#3922 AS co_shippriority_1#3946, co_comment#3923 AS co_comment_1#3947, co_orderdate#3924 AS co_orderdate_1#3948]
               +- Relation[rid#3901,cpfk_customer_orders#3902,cfpk_orders_customer#3903,cval_orders_o_orderstatus#3904,cval_orders_o_totalprice#3905,cval_orders_o_orderpriority#3906,cval_orders_o_clerk#3907,cval_orders_o_shippriority#3908,cval_orders_o_comment#3909,cval_orders_o_orderdate#3910,cdepval_orders_o_orderstatus#3911,cdepval_orders_o_totalprice#3912,cdepval_orders_o_orderpriority#3913,cdepval_orders_o_clerk#3914,cdepval_orders_o_shippriority#3915,cdepval_orders_o_comment#3916,cdepval_orders_o_orderdate#3917,co_orderstatus#3918,co_totalprice#3919,co_orderpriority#3920,co_clerk#3921,co_shippriority#3922,co_comment#3923,co_orderdate#3924] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 23962ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/26 21:52:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:52:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4225L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 21:52:09 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:52:09 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:52:09 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:52:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:52:10 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:52:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:52:10 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:52:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:52:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:52:10 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:52:10 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:52:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:52:10 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:52:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4225L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#4395 AS rid_4#4440, cpfk_orders_lineitem#4396 AS cpfk_orders_lineitem_4#4441, cpfk_supplier_lineitem#4397 AS cpfk_supplier_lineitem_4#4442, cfpk_lineitem_supplier#4398 AS cfpk_lineitem_supplier_4#4443, cfpk_lineitem_partsupp#4399 AS cfpk_lineitem_partsupp_4#4444, cpfk_part_lineitem#4400 AS cpfk_part_lineitem_4#4445, cfpk_lineitem_part#4401 AS cfpk_lineitem_part_4#4446, cpfk_partsupp_lineitem#4402 AS cpfk_partsupp_lineitem_4#4447, cfpk_lineitem_orders#4403 AS cfpk_lineitem_orders_4#4448, cval_lineitem_l_quantity#4404 AS cval_lineitem_l_quantity_4#4449, cval_lineitem_l_extendedprice#4405 AS cval_lineitem_l_extendedprice_4#4450, cval_lineitem_l_discount#4406 AS cval_lineitem_l_discount_4#4451, cval_lineitem_l_tax#4407 AS cval_lineitem_l_tax_4#4452, cval_lineitem_l_returnflag#4408 AS cval_lineitem_l_returnflag_4#4453, cval_lineitem_l_linestatus#4409 AS cval_lineitem_l_linestatus_4#4454, cval_lineitem_l_commitdate#4410 AS cval_lineitem_l_commitdate_4#4455, cval_lineitem_l_receiptdate#4411 AS cval_lineitem_l_receiptdate_4#4456, cval_lineitem_l_shipinstruct#4412 AS cval_lineitem_l_shipinstruct_4#4457, cval_lineitem_l_shipmode#4413 AS cval_lineitem_l_shipmode_4#4458, cval_lineitem_l_comment#4414 AS cval_lineitem_l_comment_4#4459, cval_lineitem_l_shipdate#4415 AS cval_lineitem_l_shipdate_4#4460, cdepval_lineitem_l_quantity#4416 AS cdepval_lineitem_l_quantity_4#4461, cdepval_lineitem_l_extendedprice#4417 AS cdepval_lineitem_l_extendedprice_4#4462, cdepval_lineitem_l_discount#4418 AS cdepval_lineitem_l_discount_4#4463, ... 21 more fields]
            :  :  +- Relation[rid#4395,cpfk_orders_lineitem#4396,cpfk_supplier_lineitem#4397,cfpk_lineitem_supplier#4398,cfpk_lineitem_partsupp#4399,cpfk_part_lineitem#4400,cfpk_lineitem_part#4401,cpfk_partsupp_lineitem#4402,cfpk_lineitem_orders#4403,cval_lineitem_l_quantity#4404,cval_lineitem_l_extendedprice#4405,cval_lineitem_l_discount#4406,cval_lineitem_l_tax#4407,cval_lineitem_l_returnflag#4408,cval_lineitem_l_linestatus#4409,cval_lineitem_l_commitdate#4410,cval_lineitem_l_receiptdate#4411,cval_lineitem_l_shipinstruct#4412,cval_lineitem_l_shipmode#4413,cval_lineitem_l_comment#4414,cval_lineitem_l_shipdate#4415,cdepval_lineitem_l_quantity#4416,cdepval_lineitem_l_extendedprice#4417,cdepval_lineitem_l_discount#4418,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#4347 AS rid_3#4371, cpfk_customer_orders#4348 AS cpfk_customer_orders_3#4372, cfpk_orders_customer#4349 AS cfpk_orders_customer_3#4373, cval_orders_o_orderstatus#4350 AS cval_orders_o_orderstatus_3#4374, cval_orders_o_totalprice#4351 AS cval_orders_o_totalprice_3#4375, cval_orders_o_orderpriority#4352 AS cval_orders_o_orderpriority_3#4376, cval_orders_o_clerk#4353 AS cval_orders_o_clerk_3#4377, cval_orders_o_shippriority#4354 AS cval_orders_o_shippriority_3#4378, cval_orders_o_comment#4355 AS cval_orders_o_comment_3#4379, cval_orders_o_orderdate#4356 AS cval_orders_o_orderdate_3#4380, cdepval_orders_o_orderstatus#4357 AS cdepval_orders_o_orderstatus_3#4381, cdepval_orders_o_totalprice#4358 AS cdepval_orders_o_totalprice_3#4382, cdepval_orders_o_orderpriority#4359 AS cdepval_orders_o_orderpriority_3#4383, cdepval_orders_o_clerk#4360 AS cdepval_orders_o_clerk_3#4384, cdepval_orders_o_shippriority#4361 AS cdepval_orders_o_shippriority_3#4385, cdepval_orders_o_comment#4362 AS cdepval_orders_o_comment_3#4386, cdepval_orders_o_orderdate#4363 AS cdepval_orders_o_orderdate_3#4387, co_orderstatus#4364 AS co_orderstatus_3#4388, co_totalprice#4365 AS co_totalprice_3#4389, co_orderpriority#4366 AS co_orderpriority_3#4390, co_clerk#4367 AS co_clerk_3#4391, co_shippriority#4368 AS co_shippriority_3#4392, co_comment#4369 AS co_comment_3#4393, co_orderdate#4370 AS co_orderdate_3#4394]
            :     :  +- Relation[rid#4347,cpfk_customer_orders#4348,cfpk_orders_customer#4349,cval_orders_o_orderstatus#4350,cval_orders_o_totalprice#4351,cval_orders_o_orderpriority#4352,cval_orders_o_clerk#4353,cval_orders_o_shippriority#4354,cval_orders_o_comment#4355,cval_orders_o_orderdate#4356,cdepval_orders_o_orderstatus#4357,cdepval_orders_o_totalprice#4358,cdepval_orders_o_orderpriority#4359,cdepval_orders_o_clerk#4360,cdepval_orders_o_shippriority#4361,cdepval_orders_o_comment#4362,cdepval_orders_o_orderdate#4363,co_orderstatus#4364,co_totalprice#4365,co_orderpriority#4366,co_clerk#4367,co_shippriority#4368,co_comment#4369,co_orderdate#4370] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#4305 AS rid_2#4326, cpfk_nation_customer#4306 AS cpfk_nation_customer_2#4327, cfpk_customer_nation#4307 AS cfpk_customer_nation_2#4328, cval_customer_c_name#4308 AS cval_customer_c_name_2#4329, cval_customer_c_address#4309 AS cval_customer_c_address_2#4330, cval_customer_c_phone#4310 AS cval_customer_c_phone_2#4331, cval_customer_c_acctbal#4311 AS cval_customer_c_acctbal_2#4332, cval_customer_c_comment#4312 AS cval_customer_c_comment_2#4333, cval_customer_c_mktsegment#4313 AS cval_customer_c_mktsegment_2#4334, cdepval_customer_c_name#4314 AS cdepval_customer_c_name_2#4335, cdepval_customer_c_address#4315 AS cdepval_customer_c_address_2#4336, cdepval_customer_c_phone#4316 AS cdepval_customer_c_phone_2#4337, cdepval_customer_c_acctbal#4317 AS cdepval_customer_c_acctbal_2#4338, cdepval_customer_c_comment#4318 AS cdepval_customer_c_comment_2#4339, cdepval_customer_c_mktsegment#4319 AS cdepval_customer_c_mktsegment_2#4340, cc_name#4320 AS cc_name_2#4341, cc_address#4321 AS cc_address_2#4342, cc_phone#4322 AS cc_phone_2#4343, cc_acctbal#4323 AS cc_acctbal_2#4344, cc_comment#4324 AS cc_comment_2#4345, cc_mktsegment#4325 AS cc_mktsegment_2#4346]
            :        :  +- Relation[rid#4305,cpfk_nation_customer#4306,cfpk_customer_nation#4307,cval_customer_c_name#4308,cval_customer_c_address#4309,cval_customer_c_phone#4310,cval_customer_c_acctbal#4311,cval_customer_c_comment#4312,cval_customer_c_mktsegment#4313,cdepval_customer_c_name#4314,cdepval_customer_c_address#4315,cdepval_customer_c_phone#4316,cdepval_customer_c_acctbal#4317,cdepval_customer_c_comment#4318,cdepval_customer_c_mktsegment#4319,cc_name#4320,cc_address#4321,cc_phone#4322,cc_acctbal#4323,cc_comment#4324,cc_mktsegment#4325] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join UsingJoin(Inner,List(rid_1))
            :           :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#4234, cval_region_r_name_0#4235, cval_region_r_comment_0#4236, cdepval_region_r_name_0#4237, cdepval_region_r_comment_0#4238, cr_name_0#4239, cr_comment_0#4240, 'rid_1]
            :           :  :- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :           :  :  +- Project [rid#4227 AS rid_0#4234, cval_region_r_name#4228 AS cval_region_r_name_0#4235, cval_region_r_comment#4229 AS cval_region_r_comment_0#4236, cdepval_region_r_name#4230 AS cdepval_region_r_name_0#4237, cdepval_region_r_comment#4231 AS cdepval_region_r_comment_0#4238, cr_name#4232 AS cr_name_0#4239, cr_comment#4233 AS cr_comment_0#4240]
            :           :  :     +- Relation[rid#4227,cval_region_r_name#4228,cval_region_r_comment#4229,cdepval_region_r_name#4230,cdepval_region_r_comment#4231,cr_name#4232,cr_comment#4233] JDBCRelation(tregion) [numPartitions=1]
            :           :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
            :           :     +- Project [rid#4287 AS rid_1#4296, cpfk_region_nation#4288 AS cpfk_region_nation_1#4297, cfpk_nation_region#4289 AS cfpk_nation_region_1#4298, cval_nation_n_name#4290 AS cval_nation_n_name_1#4299, cval_nation_n_comment#4291 AS cval_nation_n_comment_1#4300, cdepval_nation_n_name#4292 AS cdepval_nation_n_name_1#4301, cdepval_nation_n_comment#4293 AS cdepval_nation_n_comment_1#4302, cn_name#4294 AS cn_name_1#4303, cn_comment#4295 AS cn_comment_1#4304]
            :           :        +- Relation[rid#4287,cpfk_region_nation#4288,cfpk_nation_region#4289,cval_nation_n_name#4290,cval_nation_n_comment#4291,cdepval_nation_n_name#4292,cdepval_nation_n_comment#4293,cn_name#4294,cn_comment#4295] JDBCRelation(tnation) [numPartitions=1]
            :           +- Project [rid#4255 AS rid_1#4264, cpfk_region_nation#4256 AS cpfk_region_nation_1#4265, cfpk_nation_region#4257 AS cfpk_nation_region_1#4266, cval_nation_n_name#4258 AS cval_nation_n_name_1#4267, cval_nation_n_comment#4259 AS cval_nation_n_comment_1#4268, cdepval_nation_n_name#4260 AS cdepval_nation_n_name_1#4269, cdepval_nation_n_comment#4261 AS cdepval_nation_n_comment_1#4270, cn_name#4262 AS cn_name_1#4271, cn_comment#4263 AS cn_comment_1#4272]
            :              +- Relation[rid#4255,cpfk_region_nation#4256,cfpk_nation_region#4257,cval_nation_n_name#4258,cval_nation_n_comment#4259,cdepval_nation_n_name#4260,cdepval_nation_n_comment#4261,cn_name#4262,cn_comment#4263] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#4485 AS rid_5#4503, cpfk_nation_supplier#4486 AS cpfk_nation_supplier_5#4504, cfpk_supplier_nation#4487 AS cfpk_supplier_nation_5#4505, cval_supplier_s_name#4488 AS cval_supplier_s_name_5#4506, cval_supplier_s_address#4489 AS cval_supplier_s_address_5#4507, cval_supplier_s_phone#4490 AS cval_supplier_s_phone_5#4508, cval_supplier_s_acctbal#4491 AS cval_supplier_s_acctbal_5#4509, cval_supplier_s_comment#4492 AS cval_supplier_s_comment_5#4510, cdepval_supplier_s_name#4493 AS cdepval_supplier_s_name_5#4511, cdepval_supplier_s_address#4494 AS cdepval_supplier_s_address_5#4512, cdepval_supplier_s_phone#4495 AS cdepval_supplier_s_phone_5#4513, cdepval_supplier_s_acctbal#4496 AS cdepval_supplier_s_acctbal_5#4514, cdepval_supplier_s_comment#4497 AS cdepval_supplier_s_comment_5#4515, cs_name#4498 AS cs_name_5#4516, cs_address#4499 AS cs_address_5#4517, cs_phone#4500 AS cs_phone_5#4518, cs_acctbal#4501 AS cs_acctbal_5#4519, cs_comment#4502 AS cs_comment_5#4520]
               +- Relation[rid#4485,cpfk_nation_supplier#4486,cfpk_supplier_nation#4487,cval_supplier_s_name#4488,cval_supplier_s_address#4489,cval_supplier_s_phone#4490,cval_supplier_s_acctbal#4491,cval_supplier_s_comment#4492,cdepval_supplier_s_name#4493,cdepval_supplier_s_address#4494,cdepval_supplier_s_phone#4495,cdepval_supplier_s_acctbal#4496,cdepval_supplier_s_comment#4497,cs_name#4498,cs_address#4499,cs_phone#4500,cs_acctbal#4501,cs_comment#4502] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 29595ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/26 21:52:39 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:52:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4649L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 21:52:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4649L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#4651 AS rid_0#4675, cpfk_customer_orders#4652 AS cpfk_customer_orders_0#4676, cfpk_orders_customer#4653 AS cfpk_orders_customer_0#4677, cval_orders_o_orderstatus#4654 AS cval_orders_o_orderstatus_0#4678, cval_orders_o_totalprice#4655 AS cval_orders_o_totalprice_0#4679, cval_orders_o_orderpriority#4656 AS cval_orders_o_orderpriority_0#4680, cval_orders_o_clerk#4657 AS cval_orders_o_clerk_0#4681, cval_orders_o_shippriority#4658 AS cval_orders_o_shippriority_0#4682, cval_orders_o_comment#4659 AS cval_orders_o_comment_0#4683, cval_orders_o_orderdate#4660 AS cval_orders_o_orderdate_0#4684, cdepval_orders_o_orderstatus#4661 AS cdepval_orders_o_orderstatus_0#4685, cdepval_orders_o_totalprice#4662 AS cdepval_orders_o_totalprice_0#4686, cdepval_orders_o_orderpriority#4663 AS cdepval_orders_o_orderpriority_0#4687, cdepval_orders_o_clerk#4664 AS cdepval_orders_o_clerk_0#4688, cdepval_orders_o_shippriority#4665 AS cdepval_orders_o_shippriority_0#4689, cdepval_orders_o_comment#4666 AS cdepval_orders_o_comment_0#4690, cdepval_orders_o_orderdate#4667 AS cdepval_orders_o_orderdate_0#4691, co_orderstatus#4668 AS co_orderstatus_0#4692, co_totalprice#4669 AS co_totalprice_0#4693, co_orderpriority#4670 AS co_orderpriority_0#4694, co_clerk#4671 AS co_clerk_0#4695, co_shippriority#4672 AS co_shippriority_0#4696, co_comment#4673 AS co_comment_0#4697, co_orderdate#4674 AS co_orderdate_0#4698]
         :  +- Relation[rid#4651,cpfk_customer_orders#4652,cfpk_orders_customer#4653,cval_orders_o_orderstatus#4654,cval_orders_o_totalprice#4655,cval_orders_o_orderpriority#4656,cval_orders_o_clerk#4657,cval_orders_o_shippriority#4658,cval_orders_o_comment#4659,cval_orders_o_orderdate#4660,cdepval_orders_o_orderstatus#4661,cdepval_orders_o_totalprice#4662,cdepval_orders_o_orderpriority#4663,cdepval_orders_o_clerk#4664,cdepval_orders_o_shippriority#4665,cdepval_orders_o_comment#4666,cdepval_orders_o_orderdate#4667,co_orderstatus#4668,co_totalprice#4669,co_orderpriority#4670,co_clerk#4671,co_shippriority#4672,co_comment#4673,co_orderdate#4674] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#4699 AS rid_1#4720, cpfk_nation_customer#4700 AS cpfk_nation_customer_1#4721, cfpk_customer_nation#4701 AS cfpk_customer_nation_1#4722, cval_customer_c_name#4702 AS cval_customer_c_name_1#4723, cval_customer_c_address#4703 AS cval_customer_c_address_1#4724, cval_customer_c_phone#4704 AS cval_customer_c_phone_1#4725, cval_customer_c_acctbal#4705 AS cval_customer_c_acctbal_1#4726, cval_customer_c_comment#4706 AS cval_customer_c_comment_1#4727, cval_customer_c_mktsegment#4707 AS cval_customer_c_mktsegment_1#4728, cdepval_customer_c_name#4708 AS cdepval_customer_c_name_1#4729, cdepval_customer_c_address#4709 AS cdepval_customer_c_address_1#4730, cdepval_customer_c_phone#4710 AS cdepval_customer_c_phone_1#4731, cdepval_customer_c_acctbal#4711 AS cdepval_customer_c_acctbal_1#4732, cdepval_customer_c_comment#4712 AS cdepval_customer_c_comment_1#4733, cdepval_customer_c_mktsegment#4713 AS cdepval_customer_c_mktsegment_1#4734, cc_name#4714 AS cc_name_1#4735, cc_address#4715 AS cc_address_1#4736, cc_phone#4716 AS cc_phone_1#4737, cc_acctbal#4717 AS cc_acctbal_1#4738, cc_comment#4718 AS cc_comment_1#4739, cc_mktsegment#4719 AS cc_mktsegment_1#4740]
            +- Relation[rid#4699,cpfk_nation_customer#4700,cfpk_customer_nation#4701,cval_customer_c_name#4702,cval_customer_c_address#4703,cval_customer_c_phone#4704,cval_customer_c_acctbal#4705,cval_customer_c_comment#4706,cval_customer_c_mktsegment#4707,cdepval_customer_c_name#4708,cdepval_customer_c_address#4709,cdepval_customer_c_phone#4710,cdepval_customer_c_acctbal#4711,cdepval_customer_c_comment#4712,cdepval_customer_c_mktsegment#4713,cc_name#4714,cc_address#4715,cc_phone#4716,cc_acctbal#4717,cc_comment#4718,cc_mktsegment#4719] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4402ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/26 21:52:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:52:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4795L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:52:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4795L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#4887 AS rid_2#4932, cpfk_orders_lineitem#4888 AS cpfk_orders_lineitem_2#4933, cpfk_supplier_lineitem#4889 AS cpfk_supplier_lineitem_2#4934, cfpk_lineitem_supplier#4890 AS cfpk_lineitem_supplier_2#4935, cfpk_lineitem_partsupp#4891 AS cfpk_lineitem_partsupp_2#4936, cpfk_part_lineitem#4892 AS cpfk_part_lineitem_2#4937, cfpk_lineitem_part#4893 AS cfpk_lineitem_part_2#4938, cpfk_partsupp_lineitem#4894 AS cpfk_partsupp_lineitem_2#4939, cfpk_lineitem_orders#4895 AS cfpk_lineitem_orders_2#4940, cval_lineitem_l_quantity#4896 AS cval_lineitem_l_quantity_2#4941, cval_lineitem_l_extendedprice#4897 AS cval_lineitem_l_extendedprice_2#4942, cval_lineitem_l_discount#4898 AS cval_lineitem_l_discount_2#4943, cval_lineitem_l_tax#4899 AS cval_lineitem_l_tax_2#4944, cval_lineitem_l_returnflag#4900 AS cval_lineitem_l_returnflag_2#4945, cval_lineitem_l_linestatus#4901 AS cval_lineitem_l_linestatus_2#4946, cval_lineitem_l_commitdate#4902 AS cval_lineitem_l_commitdate_2#4947, cval_lineitem_l_receiptdate#4903 AS cval_lineitem_l_receiptdate_2#4948, cval_lineitem_l_shipinstruct#4904 AS cval_lineitem_l_shipinstruct_2#4949, cval_lineitem_l_shipmode#4905 AS cval_lineitem_l_shipmode_2#4950, cval_lineitem_l_comment#4906 AS cval_lineitem_l_comment_2#4951, cval_lineitem_l_shipdate#4907 AS cval_lineitem_l_shipdate_2#4952, cdepval_lineitem_l_quantity#4908 AS cdepval_lineitem_l_quantity_2#4953, cdepval_lineitem_l_extendedprice#4909 AS cdepval_lineitem_l_extendedprice_2#4954, cdepval_lineitem_l_discount#4910 AS cdepval_lineitem_l_discount_2#4955, ... 21 more fields]
         :  +- Relation[rid#4887,cpfk_orders_lineitem#4888,cpfk_supplier_lineitem#4889,cfpk_lineitem_supplier#4890,cfpk_lineitem_partsupp#4891,cpfk_part_lineitem#4892,cfpk_lineitem_part#4893,cpfk_partsupp_lineitem#4894,cfpk_lineitem_orders#4895,cval_lineitem_l_quantity#4896,cval_lineitem_l_extendedprice#4897,cval_lineitem_l_discount#4898,cval_lineitem_l_tax#4899,cval_lineitem_l_returnflag#4900,cval_lineitem_l_linestatus#4901,cval_lineitem_l_commitdate#4902,cval_lineitem_l_receiptdate#4903,cval_lineitem_l_shipinstruct#4904,cval_lineitem_l_shipmode#4905,cval_lineitem_l_comment#4906,cval_lineitem_l_shipdate#4907,cdepval_lineitem_l_quantity#4908,cdepval_lineitem_l_extendedprice#4909,cdepval_lineitem_l_discount#4910,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#4839 AS rid_1#4863, cpfk_customer_orders#4840 AS cpfk_customer_orders_1#4864, cfpk_orders_customer#4841 AS cfpk_orders_customer_1#4865, cval_orders_o_orderstatus#4842 AS cval_orders_o_orderstatus_1#4866, cval_orders_o_totalprice#4843 AS cval_orders_o_totalprice_1#4867, cval_orders_o_orderpriority#4844 AS cval_orders_o_orderpriority_1#4868, cval_orders_o_clerk#4845 AS cval_orders_o_clerk_1#4869, cval_orders_o_shippriority#4846 AS cval_orders_o_shippriority_1#4870, cval_orders_o_comment#4847 AS cval_orders_o_comment_1#4871, cval_orders_o_orderdate#4848 AS cval_orders_o_orderdate_1#4872, cdepval_orders_o_orderstatus#4849 AS cdepval_orders_o_orderstatus_1#4873, cdepval_orders_o_totalprice#4850 AS cdepval_orders_o_totalprice_1#4874, cdepval_orders_o_orderpriority#4851 AS cdepval_orders_o_orderpriority_1#4875, cdepval_orders_o_clerk#4852 AS cdepval_orders_o_clerk_1#4876, cdepval_orders_o_shippriority#4853 AS cdepval_orders_o_shippriority_1#4877, cdepval_orders_o_comment#4854 AS cdepval_orders_o_comment_1#4878, cdepval_orders_o_orderdate#4855 AS cdepval_orders_o_orderdate_1#4879, co_orderstatus#4856 AS co_orderstatus_1#4880, co_totalprice#4857 AS co_totalprice_1#4881, co_orderpriority#4858 AS co_orderpriority_1#4882, co_clerk#4859 AS co_clerk_1#4883, co_shippriority#4860 AS co_shippriority_1#4884, co_comment#4861 AS co_comment_1#4885, co_orderdate#4862 AS co_orderdate_1#4886]
            :  +- Relation[rid#4839,cpfk_customer_orders#4840,cfpk_orders_customer#4841,cval_orders_o_orderstatus#4842,cval_orders_o_totalprice#4843,cval_orders_o_orderpriority#4844,cval_orders_o_clerk#4845,cval_orders_o_shippriority#4846,cval_orders_o_comment#4847,cval_orders_o_orderdate#4848,cdepval_orders_o_orderstatus#4849,cdepval_orders_o_totalprice#4850,cdepval_orders_o_orderpriority#4851,cdepval_orders_o_clerk#4852,cdepval_orders_o_shippriority#4853,cdepval_orders_o_comment#4854,cdepval_orders_o_orderdate#4855,co_orderstatus#4856,co_totalprice#4857,co_orderpriority#4858,co_clerk#4859,co_shippriority#4860,co_comment#4861,co_orderdate#4862] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#4797 AS rid_0#4818, cpfk_nation_customer#4798 AS cpfk_nation_customer_0#4819, cfpk_customer_nation#4799 AS cfpk_customer_nation_0#4820, cval_customer_c_name#4800 AS cval_customer_c_name_0#4821, cval_customer_c_address#4801 AS cval_customer_c_address_0#4822, cval_customer_c_phone#4802 AS cval_customer_c_phone_0#4823, cval_customer_c_acctbal#4803 AS cval_customer_c_acctbal_0#4824, cval_customer_c_comment#4804 AS cval_customer_c_comment_0#4825, cval_customer_c_mktsegment#4805 AS cval_customer_c_mktsegment_0#4826, cdepval_customer_c_name#4806 AS cdepval_customer_c_name_0#4827, cdepval_customer_c_address#4807 AS cdepval_customer_c_address_0#4828, cdepval_customer_c_phone#4808 AS cdepval_customer_c_phone_0#4829, cdepval_customer_c_acctbal#4809 AS cdepval_customer_c_acctbal_0#4830, cdepval_customer_c_comment#4810 AS cdepval_customer_c_comment_0#4831, cdepval_customer_c_mktsegment#4811 AS cdepval_customer_c_mktsegment_0#4832, cc_name#4812 AS cc_name_0#4833, cc_address#4813 AS cc_address_0#4834, cc_phone#4814 AS cc_phone_0#4835, cc_acctbal#4815 AS cc_acctbal_0#4836, cc_comment#4816 AS cc_comment_0#4837, cc_mktsegment#4817 AS cc_mktsegment_0#4838]
               +- Relation[rid#4797,cpfk_nation_customer#4798,cfpk_customer_nation#4799,cval_customer_c_name#4800,cval_customer_c_address#4801,cval_customer_c_phone#4802,cval_customer_c_acctbal#4803,cval_customer_c_comment#4804,cval_customer_c_mktsegment#4805,cdepval_customer_c_name#4806,cdepval_customer_c_address#4807,cdepval_customer_c_phone#4808,cdepval_customer_c_acctbal#4809,cdepval_customer_c_comment#4810,cdepval_customer_c_mktsegment#4811,cc_name#4812,cc_address#4813,cc_phone#4814,cc_acctbal#4815,cc_comment#4816,cc_mktsegment#4817] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 22167ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/26 21:53:06 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:53:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5074L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:53:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:53:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:53:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5074L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#5112 AS rid_1#5157, cpfk_orders_lineitem#5113 AS cpfk_orders_lineitem_1#5158, cpfk_supplier_lineitem#5114 AS cpfk_supplier_lineitem_1#5159, cfpk_lineitem_supplier#5115 AS cfpk_lineitem_supplier_1#5160, cfpk_lineitem_partsupp#5116 AS cfpk_lineitem_partsupp_1#5161, cpfk_part_lineitem#5117 AS cpfk_part_lineitem_1#5162, cfpk_lineitem_part#5118 AS cfpk_lineitem_part_1#5163, cpfk_partsupp_lineitem#5119 AS cpfk_partsupp_lineitem_1#5164, cfpk_lineitem_orders#5120 AS cfpk_lineitem_orders_1#5165, cval_lineitem_l_quantity#5121 AS cval_lineitem_l_quantity_1#5166, cval_lineitem_l_extendedprice#5122 AS cval_lineitem_l_extendedprice_1#5167, cval_lineitem_l_discount#5123 AS cval_lineitem_l_discount_1#5168, cval_lineitem_l_tax#5124 AS cval_lineitem_l_tax_1#5169, cval_lineitem_l_returnflag#5125 AS cval_lineitem_l_returnflag_1#5170, cval_lineitem_l_linestatus#5126 AS cval_lineitem_l_linestatus_1#5171, cval_lineitem_l_commitdate#5127 AS cval_lineitem_l_commitdate_1#5172, cval_lineitem_l_receiptdate#5128 AS cval_lineitem_l_receiptdate_1#5173, cval_lineitem_l_shipinstruct#5129 AS cval_lineitem_l_shipinstruct_1#5174, cval_lineitem_l_shipmode#5130 AS cval_lineitem_l_shipmode_1#5175, cval_lineitem_l_comment#5131 AS cval_lineitem_l_comment_1#5176, cval_lineitem_l_shipdate#5132 AS cval_lineitem_l_shipdate_1#5177, cdepval_lineitem_l_quantity#5133 AS cdepval_lineitem_l_quantity_1#5178, cdepval_lineitem_l_extendedprice#5134 AS cdepval_lineitem_l_extendedprice_1#5179, cdepval_lineitem_l_discount#5135 AS cdepval_lineitem_l_discount_1#5180, ... 21 more fields]
         :  +- Relation[rid#5112,cpfk_orders_lineitem#5113,cpfk_supplier_lineitem#5114,cfpk_lineitem_supplier#5115,cfpk_lineitem_partsupp#5116,cpfk_part_lineitem#5117,cfpk_lineitem_part#5118,cpfk_partsupp_lineitem#5119,cfpk_lineitem_orders#5120,cval_lineitem_l_quantity#5121,cval_lineitem_l_extendedprice#5122,cval_lineitem_l_discount#5123,cval_lineitem_l_tax#5124,cval_lineitem_l_returnflag#5125,cval_lineitem_l_linestatus#5126,cval_lineitem_l_commitdate#5127,cval_lineitem_l_receiptdate#5128,cval_lineitem_l_shipinstruct#5129,cval_lineitem_l_shipmode#5130,cval_lineitem_l_comment#5131,cval_lineitem_l_shipdate#5132,cdepval_lineitem_l_quantity#5133,cdepval_lineitem_l_extendedprice#5134,cdepval_lineitem_l_discount#5135,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5076 AS rid_0#5094, cpfk_nation_supplier#5077 AS cpfk_nation_supplier_0#5095, cfpk_supplier_nation#5078 AS cfpk_supplier_nation_0#5096, cval_supplier_s_name#5079 AS cval_supplier_s_name_0#5097, cval_supplier_s_address#5080 AS cval_supplier_s_address_0#5098, cval_supplier_s_phone#5081 AS cval_supplier_s_phone_0#5099, cval_supplier_s_acctbal#5082 AS cval_supplier_s_acctbal_0#5100, cval_supplier_s_comment#5083 AS cval_supplier_s_comment_0#5101, cdepval_supplier_s_name#5084 AS cdepval_supplier_s_name_0#5102, cdepval_supplier_s_address#5085 AS cdepval_supplier_s_address_0#5103, cdepval_supplier_s_phone#5086 AS cdepval_supplier_s_phone_0#5104, cdepval_supplier_s_acctbal#5087 AS cdepval_supplier_s_acctbal_0#5105, cdepval_supplier_s_comment#5088 AS cdepval_supplier_s_comment_0#5106, cs_name#5089 AS cs_name_0#5107, cs_address#5090 AS cs_address_0#5108, cs_phone#5091 AS cs_phone_0#5109, cs_acctbal#5092 AS cs_acctbal_0#5110, cs_comment#5093 AS cs_comment_0#5111]
            +- Relation[rid#5076,cpfk_nation_supplier#5077,cfpk_supplier_nation#5078,cval_supplier_s_name#5079,cval_supplier_s_address#5080,cval_supplier_s_phone#5081,cval_supplier_s_acctbal#5082,cval_supplier_s_comment#5083,cdepval_supplier_s_name#5084,cdepval_supplier_s_address#5085,cdepval_supplier_s_phone#5086,cdepval_supplier_s_acctbal#5087,cdepval_supplier_s_comment#5088,cs_name#5089,cs_address#5090,cs_phone#5091,cs_acctbal#5092,cs_comment#5093] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17178ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/26 21:53:23 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:53:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5269L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:53:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5269L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#5271 AS rid_0#5316, cpfk_orders_lineitem#5272 AS cpfk_orders_lineitem_0#5317, cpfk_supplier_lineitem#5273 AS cpfk_supplier_lineitem_0#5318, cfpk_lineitem_supplier#5274 AS cfpk_lineitem_supplier_0#5319, cfpk_lineitem_partsupp#5275 AS cfpk_lineitem_partsupp_0#5320, cpfk_part_lineitem#5276 AS cpfk_part_lineitem_0#5321, cfpk_lineitem_part#5277 AS cfpk_lineitem_part_0#5322, cpfk_partsupp_lineitem#5278 AS cpfk_partsupp_lineitem_0#5323, cfpk_lineitem_orders#5279 AS cfpk_lineitem_orders_0#5324, cval_lineitem_l_quantity#5280 AS cval_lineitem_l_quantity_0#5325, cval_lineitem_l_extendedprice#5281 AS cval_lineitem_l_extendedprice_0#5326, cval_lineitem_l_discount#5282 AS cval_lineitem_l_discount_0#5327, cval_lineitem_l_tax#5283 AS cval_lineitem_l_tax_0#5328, cval_lineitem_l_returnflag#5284 AS cval_lineitem_l_returnflag_0#5329, cval_lineitem_l_linestatus#5285 AS cval_lineitem_l_linestatus_0#5330, cval_lineitem_l_commitdate#5286 AS cval_lineitem_l_commitdate_0#5331, cval_lineitem_l_receiptdate#5287 AS cval_lineitem_l_receiptdate_0#5332, cval_lineitem_l_shipinstruct#5288 AS cval_lineitem_l_shipinstruct_0#5333, cval_lineitem_l_shipmode#5289 AS cval_lineitem_l_shipmode_0#5334, cval_lineitem_l_comment#5290 AS cval_lineitem_l_comment_0#5335, cval_lineitem_l_shipdate#5291 AS cval_lineitem_l_shipdate_0#5336, cdepval_lineitem_l_quantity#5292 AS cdepval_lineitem_l_quantity_0#5337, cdepval_lineitem_l_extendedprice#5293 AS cdepval_lineitem_l_extendedprice_0#5338, cdepval_lineitem_l_discount#5294 AS cdepval_lineitem_l_discount_0#5339, ... 21 more fields]
         :     +- Relation[rid#5271,cpfk_orders_lineitem#5272,cpfk_supplier_lineitem#5273,cfpk_lineitem_supplier#5274,cfpk_lineitem_partsupp#5275,cpfk_part_lineitem#5276,cfpk_lineitem_part#5277,cpfk_partsupp_lineitem#5278,cfpk_lineitem_orders#5279,cval_lineitem_l_quantity#5280,cval_lineitem_l_extendedprice#5281,cval_lineitem_l_discount#5282,cval_lineitem_l_tax#5283,cval_lineitem_l_returnflag#5284,cval_lineitem_l_linestatus#5285,cval_lineitem_l_commitdate#5286,cval_lineitem_l_receiptdate#5287,cval_lineitem_l_shipinstruct#5288,cval_lineitem_l_shipmode#5289,cval_lineitem_l_comment#5290,cval_lineitem_l_shipdate#5291,cdepval_lineitem_l_quantity#5292,cdepval_lineitem_l_extendedprice#5293,cdepval_lineitem_l_discount#5294,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5451 AS rid_1#5475, cpfk_customer_orders#5452 AS cpfk_customer_orders_1#5476, cfpk_orders_customer#5453 AS cfpk_orders_customer_1#5477, cval_orders_o_orderstatus#5454 AS cval_orders_o_orderstatus_1#5478, cval_orders_o_totalprice#5455 AS cval_orders_o_totalprice_1#5479, cval_orders_o_orderpriority#5456 AS cval_orders_o_orderpriority_1#5480, cval_orders_o_clerk#5457 AS cval_orders_o_clerk_1#5481, cval_orders_o_shippriority#5458 AS cval_orders_o_shippriority_1#5482, cval_orders_o_comment#5459 AS cval_orders_o_comment_1#5483, cval_orders_o_orderdate#5460 AS cval_orders_o_orderdate_1#5484, cdepval_orders_o_orderstatus#5461 AS cdepval_orders_o_orderstatus_1#5485, cdepval_orders_o_totalprice#5462 AS cdepval_orders_o_totalprice_1#5486, cdepval_orders_o_orderpriority#5463 AS cdepval_orders_o_orderpriority_1#5487, cdepval_orders_o_clerk#5464 AS cdepval_orders_o_clerk_1#5488, cdepval_orders_o_shippriority#5465 AS cdepval_orders_o_shippriority_1#5489, cdepval_orders_o_comment#5466 AS cdepval_orders_o_comment_1#5490, cdepval_orders_o_orderdate#5467 AS cdepval_orders_o_orderdate_1#5491, co_orderstatus#5468 AS co_orderstatus_1#5492, co_totalprice#5469 AS co_totalprice_1#5493, co_orderpriority#5470 AS co_orderpriority_1#5494, co_clerk#5471 AS co_clerk_1#5495, co_shippriority#5472 AS co_shippriority_1#5496, co_comment#5473 AS co_comment_1#5497, co_orderdate#5474 AS co_orderdate_1#5498]
            +- Relation[rid#5451,cpfk_customer_orders#5452,cfpk_orders_customer#5453,cval_orders_o_orderstatus#5454,cval_orders_o_totalprice#5455,cval_orders_o_orderpriority#5456,cval_orders_o_clerk#5457,cval_orders_o_shippriority#5458,cval_orders_o_comment#5459,cval_orders_o_orderdate#5460,cdepval_orders_o_orderstatus#5461,cdepval_orders_o_totalprice#5462,cdepval_orders_o_orderpriority#5463,cdepval_orders_o_clerk#5464,cdepval_orders_o_shippriority#5465,cdepval_orders_o_comment#5466,cdepval_orders_o_orderdate#5467,co_orderstatus#5468,co_totalprice#5469,co_orderpriority#5470,co_clerk#5471,co_shippriority#5472,co_comment#5473,co_orderdate#5474] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 21699ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 21:53:45 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:53:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5577L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:53:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:53:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:53:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:53:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:53:45 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:53:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:53:45 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:53:45 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:53:45 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:53:45 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:53:45 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:53:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5577L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#5711 AS rid_4#5756, cpfk_orders_lineitem#5712 AS cpfk_orders_lineitem_4#5757, cpfk_supplier_lineitem#5713 AS cpfk_supplier_lineitem_4#5758, cfpk_lineitem_supplier#5714 AS cfpk_lineitem_supplier_4#5759, cfpk_lineitem_partsupp#5715 AS cfpk_lineitem_partsupp_4#5760, cpfk_part_lineitem#5716 AS cpfk_part_lineitem_4#5761, cfpk_lineitem_part#5717 AS cfpk_lineitem_part_4#5762, cpfk_partsupp_lineitem#5718 AS cpfk_partsupp_lineitem_4#5763, cfpk_lineitem_orders#5719 AS cfpk_lineitem_orders_4#5764, cval_lineitem_l_quantity#5720 AS cval_lineitem_l_quantity_4#5765, cval_lineitem_l_extendedprice#5721 AS cval_lineitem_l_extendedprice_4#5766, cval_lineitem_l_discount#5722 AS cval_lineitem_l_discount_4#5767, cval_lineitem_l_tax#5723 AS cval_lineitem_l_tax_4#5768, cval_lineitem_l_returnflag#5724 AS cval_lineitem_l_returnflag_4#5769, cval_lineitem_l_linestatus#5725 AS cval_lineitem_l_linestatus_4#5770, cval_lineitem_l_commitdate#5726 AS cval_lineitem_l_commitdate_4#5771, cval_lineitem_l_receiptdate#5727 AS cval_lineitem_l_receiptdate_4#5772, cval_lineitem_l_shipinstruct#5728 AS cval_lineitem_l_shipinstruct_4#5773, cval_lineitem_l_shipmode#5729 AS cval_lineitem_l_shipmode_4#5774, cval_lineitem_l_comment#5730 AS cval_lineitem_l_comment_4#5775, cval_lineitem_l_shipdate#5731 AS cval_lineitem_l_shipdate_4#5776, cdepval_lineitem_l_quantity#5732 AS cdepval_lineitem_l_quantity_4#5777, cdepval_lineitem_l_extendedprice#5733 AS cdepval_lineitem_l_extendedprice_4#5778, cdepval_lineitem_l_discount#5734 AS cdepval_lineitem_l_discount_4#5779, ... 21 more fields]
         :  :  +- Relation[rid#5711,cpfk_orders_lineitem#5712,cpfk_supplier_lineitem#5713,cfpk_lineitem_supplier#5714,cfpk_lineitem_partsupp#5715,cpfk_part_lineitem#5716,cfpk_lineitem_part#5717,cpfk_partsupp_lineitem#5718,cfpk_lineitem_orders#5719,cval_lineitem_l_quantity#5720,cval_lineitem_l_extendedprice#5721,cval_lineitem_l_discount#5722,cval_lineitem_l_tax#5723,cval_lineitem_l_returnflag#5724,cval_lineitem_l_linestatus#5725,cval_lineitem_l_commitdate#5726,cval_lineitem_l_receiptdate#5727,cval_lineitem_l_shipinstruct#5728,cval_lineitem_l_shipmode#5729,cval_lineitem_l_comment#5730,cval_lineitem_l_shipdate#5731,cdepval_lineitem_l_quantity#5732,cdepval_lineitem_l_extendedprice#5733,cdepval_lineitem_l_discount#5734,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#5633 AS rid_2#5647, cpfk_part_partsupp#5634 AS cpfk_part_partsupp_2#5648, cfpk_partsupp_part#5635 AS cfpk_partsupp_part_2#5649, cpfk_supplier_partsupp#5636 AS cpfk_supplier_partsupp_2#5650, cfpk_partsupp_supplier#5637 AS cfpk_partsupp_supplier_2#5651, cval_partsupp_ps_availqty#5638 AS cval_partsupp_ps_availqty_2#5652, cval_partsupp_ps_supplycost#5639 AS cval_partsupp_ps_supplycost_2#5653, cval_partsupp_ps_comment#5640 AS cval_partsupp_ps_comment_2#5654, cdepval_partsupp_ps_availqty#5641 AS cdepval_partsupp_ps_availqty_2#5655, cdepval_partsupp_ps_supplycost#5642 AS cdepval_partsupp_ps_supplycost_2#5656, cdepval_partsupp_ps_comment#5643 AS cdepval_partsupp_ps_comment_2#5657, cps_availqty#5644 AS cps_availqty_2#5658, cps_supplycost#5645 AS cps_supplycost_2#5659, cps_comment#5646 AS cps_comment_2#5660]
         :     :  :  +- Relation[rid#5633,cpfk_part_partsupp#5634,cfpk_partsupp_part#5635,cpfk_supplier_partsupp#5636,cfpk_partsupp_supplier#5637,cval_partsupp_ps_availqty#5638,cval_partsupp_ps_supplycost#5639,cval_partsupp_ps_comment#5640,cdepval_partsupp_ps_availqty#5641,cdepval_partsupp_ps_supplycost#5642,cdepval_partsupp_ps_comment#5643,cps_availqty#5644,cps_supplycost#5645,cps_comment#5646] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#5597 AS rid_1#5615, cpfk_nation_supplier#5598 AS cpfk_nation_supplier_1#5616, cfpk_supplier_nation#5599 AS cfpk_supplier_nation_1#5617, cval_supplier_s_name#5600 AS cval_supplier_s_name_1#5618, cval_supplier_s_address#5601 AS cval_supplier_s_address_1#5619, cval_supplier_s_phone#5602 AS cval_supplier_s_phone_1#5620, cval_supplier_s_acctbal#5603 AS cval_supplier_s_acctbal_1#5621, cval_supplier_s_comment#5604 AS cval_supplier_s_comment_1#5622, cdepval_supplier_s_name#5605 AS cdepval_supplier_s_name_1#5623, cdepval_supplier_s_address#5606 AS cdepval_supplier_s_address_1#5624, cdepval_supplier_s_phone#5607 AS cdepval_supplier_s_phone_1#5625, cdepval_supplier_s_acctbal#5608 AS cdepval_supplier_s_acctbal_1#5626, cdepval_supplier_s_comment#5609 AS cdepval_supplier_s_comment_1#5627, cs_name#5610 AS cs_name_1#5628, cs_address#5611 AS cs_address_1#5629, cs_phone#5612 AS cs_phone_1#5630, cs_acctbal#5613 AS cs_acctbal_1#5631, cs_comment#5614 AS cs_comment_1#5632]
         :     :     :  +- Relation[rid#5597,cpfk_nation_supplier#5598,cfpk_supplier_nation#5599,cval_supplier_s_name#5600,cval_supplier_s_address#5601,cval_supplier_s_phone#5602,cval_supplier_s_acctbal#5603,cval_supplier_s_comment#5604,cdepval_supplier_s_name#5605,cdepval_supplier_s_address#5606,cdepval_supplier_s_phone#5607,cdepval_supplier_s_acctbal#5608,cdepval_supplier_s_comment#5609,cs_name#5610,cs_address#5611,cs_phone#5612,cs_acctbal#5613,cs_comment#5614] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#5579 AS rid_0#5588, cpfk_region_nation#5580 AS cpfk_region_nation_0#5589, cfpk_nation_region#5581 AS cfpk_nation_region_0#5590, cval_nation_n_name#5582 AS cval_nation_n_name_0#5591, cval_nation_n_comment#5583 AS cval_nation_n_comment_0#5592, cdepval_nation_n_name#5584 AS cdepval_nation_n_name_0#5593, cdepval_nation_n_comment#5585 AS cdepval_nation_n_comment_0#5594, cn_name#5586 AS cn_name_0#5595, cn_comment#5587 AS cn_comment_0#5596]
         :     :        +- Relation[rid#5579,cpfk_region_nation#5580,cfpk_nation_region#5581,cval_nation_n_name#5582,cval_nation_n_comment#5583,cdepval_nation_n_name#5584,cdepval_nation_n_comment#5585,cn_name#5586,cn_comment#5587] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#5661 AS rid_3#5686, cval_part_p_name#5662 AS cval_part_p_name_3#5687, cval_part_p_mfgr#5663 AS cval_part_p_mfgr_3#5688, cval_part_p_type#5664 AS cval_part_p_type_3#5689, cval_part_p_size#5665 AS cval_part_p_size_3#5690, cval_part_p_container#5666 AS cval_part_p_container_3#5691, cval_part_p_retailprice#5667 AS cval_part_p_retailprice_3#5692, cval_part_p_comment#5668 AS cval_part_p_comment_3#5693, cval_part_p_brand#5669 AS cval_part_p_brand_3#5694, cdepval_part_p_name#5670 AS cdepval_part_p_name_3#5695, cdepval_part_p_mfgr#5671 AS cdepval_part_p_mfgr_3#5696, cdepval_part_p_type#5672 AS cdepval_part_p_type_3#5697, cdepval_part_p_size#5673 AS cdepval_part_p_size_3#5698, cdepval_part_p_container#5674 AS cdepval_part_p_container_3#5699, cdepval_part_p_retailprice#5675 AS cdepval_part_p_retailprice_3#5700, cdepval_part_p_comment#5676 AS cdepval_part_p_comment_3#5701, cdepval_part_p_brand#5677 AS cdepval_part_p_brand_3#5702, cp_name#5678 AS cp_name_3#5703, cp_mfgr#5679 AS cp_mfgr_3#5704, cp_type#5680 AS cp_type_3#5705, cp_size#5681 AS cp_size_3#5706, cp_container#5682 AS cp_container_3#5707, cp_retailprice#5683 AS cp_retailprice_3#5708, cp_comment#5684 AS cp_comment_3#5709, cp_brand#5685 AS cp_brand_3#5710]
         :        +- Relation[rid#5661,cval_part_p_name#5662,cval_part_p_mfgr#5663,cval_part_p_type#5664,cval_part_p_size#5665,cval_part_p_container#5666,cval_part_p_retailprice#5667,cval_part_p_comment#5668,cval_part_p_brand#5669,cdepval_part_p_name#5670,cdepval_part_p_mfgr#5671,cdepval_part_p_type#5672,cdepval_part_p_size#5673,cdepval_part_p_container#5674,cdepval_part_p_retailprice#5675,cdepval_part_p_comment#5676,cdepval_part_p_brand#5677,cp_name#5678,cp_mfgr#5679,cp_type#5680,cp_size#5681,cp_container#5682,cp_retailprice#5683,cp_comment#5684,cp_brand#5685] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#5801 AS rid_5#5825, cpfk_customer_orders#5802 AS cpfk_customer_orders_5#5826, cfpk_orders_customer#5803 AS cfpk_orders_customer_5#5827, cval_orders_o_orderstatus#5804 AS cval_orders_o_orderstatus_5#5828, cval_orders_o_totalprice#5805 AS cval_orders_o_totalprice_5#5829, cval_orders_o_orderpriority#5806 AS cval_orders_o_orderpriority_5#5830, cval_orders_o_clerk#5807 AS cval_orders_o_clerk_5#5831, cval_orders_o_shippriority#5808 AS cval_orders_o_shippriority_5#5832, cval_orders_o_comment#5809 AS cval_orders_o_comment_5#5833, cval_orders_o_orderdate#5810 AS cval_orders_o_orderdate_5#5834, cdepval_orders_o_orderstatus#5811 AS cdepval_orders_o_orderstatus_5#5835, cdepval_orders_o_totalprice#5812 AS cdepval_orders_o_totalprice_5#5836, cdepval_orders_o_orderpriority#5813 AS cdepval_orders_o_orderpriority_5#5837, cdepval_orders_o_clerk#5814 AS cdepval_orders_o_clerk_5#5838, cdepval_orders_o_shippriority#5815 AS cdepval_orders_o_shippriority_5#5839, cdepval_orders_o_comment#5816 AS cdepval_orders_o_comment_5#5840, cdepval_orders_o_orderdate#5817 AS cdepval_orders_o_orderdate_5#5841, co_orderstatus#5818 AS co_orderstatus_5#5842, co_totalprice#5819 AS co_totalprice_5#5843, co_orderpriority#5820 AS co_orderpriority_5#5844, co_clerk#5821 AS co_clerk_5#5845, co_shippriority#5822 AS co_shippriority_5#5846, co_comment#5823 AS co_comment_5#5847, co_orderdate#5824 AS co_orderdate_5#5848]
            +- Relation[rid#5801,cpfk_customer_orders#5802,cfpk_orders_customer#5803,cval_orders_o_orderstatus#5804,cval_orders_o_totalprice#5805,cval_orders_o_orderpriority#5806,cval_orders_o_clerk#5807,cval_orders_o_shippriority#5808,cval_orders_o_comment#5809,cval_orders_o_orderdate#5810,cdepval_orders_o_orderstatus#5811,cdepval_orders_o_totalprice#5812,cdepval_orders_o_orderpriority#5813,cdepval_orders_o_clerk#5814,cdepval_orders_o_shippriority#5815,cdepval_orders_o_comment#5816,cdepval_orders_o_orderdate#5817,co_orderstatus#5818,co_totalprice#5819,co_orderpriority#5820,co_clerk#5821,co_shippriority#5822,co_comment#5823,co_orderdate#5824] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 37594ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/26 21:54:22 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:54:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5991L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 21:54:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:54:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:54:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:54:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5991L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6018, cval_part_p_name_0#6019, cval_part_p_mfgr_0#6020, cval_part_p_type_0#6021, cval_part_p_size_0#6022, cval_part_p_container_0#6023, cval_part_p_retailprice_0#6024, cval_part_p_comment_0#6025, cval_part_p_brand_0#6026, cdepval_part_p_name_0#6027, cdepval_part_p_mfgr_0#6028, cdepval_part_p_type_0#6029, cdepval_part_p_size_0#6030, cdepval_part_p_container_0#6031, cdepval_part_p_retailprice_0#6032, cdepval_part_p_comment_0#6033, cdepval_part_p_brand_0#6034, cp_name_0#6035, cp_mfgr_0#6036, cp_type_0#6037, cp_size_0#6038, cp_container_0#6039, cp_retailprice_0#6040, cp_comment_0#6041, ... 2 more fields]
         :  :- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  +- Project [rid#5993 AS rid_0#6018, cval_part_p_name#5994 AS cval_part_p_name_0#6019, cval_part_p_mfgr#5995 AS cval_part_p_mfgr_0#6020, cval_part_p_type#5996 AS cval_part_p_type_0#6021, cval_part_p_size#5997 AS cval_part_p_size_0#6022, cval_part_p_container#5998 AS cval_part_p_container_0#6023, cval_part_p_retailprice#5999 AS cval_part_p_retailprice_0#6024, cval_part_p_comment#6000 AS cval_part_p_comment_0#6025, cval_part_p_brand#6001 AS cval_part_p_brand_0#6026, cdepval_part_p_name#6002 AS cdepval_part_p_name_0#6027, cdepval_part_p_mfgr#6003 AS cdepval_part_p_mfgr_0#6028, cdepval_part_p_type#6004 AS cdepval_part_p_type_0#6029, cdepval_part_p_size#6005 AS cdepval_part_p_size_0#6030, cdepval_part_p_container#6006 AS cdepval_part_p_container_0#6031, cdepval_part_p_retailprice#6007 AS cdepval_part_p_retailprice_0#6032, cdepval_part_p_comment#6008 AS cdepval_part_p_comment_0#6033, cdepval_part_p_brand#6009 AS cdepval_part_p_brand_0#6034, cp_name#6010 AS cp_name_0#6035, cp_mfgr#6011 AS cp_mfgr_0#6036, cp_type#6012 AS cp_type_0#6037, cp_size#6013 AS cp_size_0#6038, cp_container#6014 AS cp_container_0#6039, cp_retailprice#6015 AS cp_retailprice_0#6040, cp_comment#6016 AS cp_comment_0#6041, cp_brand#6017 AS cp_brand_0#6042]
         :  :     +- Relation[rid#5993,cval_part_p_name#5994,cval_part_p_mfgr#5995,cval_part_p_type#5996,cval_part_p_size#5997,cval_part_p_container#5998,cval_part_p_retailprice#5999,cval_part_p_comment#6000,cval_part_p_brand#6001,cdepval_part_p_name#6002,cdepval_part_p_mfgr#6003,cdepval_part_p_type#6004,cdepval_part_p_size#6005,cdepval_part_p_container#6006,cdepval_part_p_retailprice#6007,cdepval_part_p_comment#6008,cdepval_part_p_brand#6009,cp_name#6010,cp_mfgr#6011,cp_type#6012,cp_size#6013,cp_container#6014,cp_retailprice#6015,cp_comment#6016,cp_brand#6017] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :     +- Project [rid#6171 AS rid_1#6185, cpfk_part_partsupp#6172 AS cpfk_part_partsupp_1#6186, cfpk_partsupp_part#6173 AS cfpk_partsupp_part_1#6187, cpfk_supplier_partsupp#6174 AS cpfk_supplier_partsupp_1#6188, cfpk_partsupp_supplier#6175 AS cfpk_partsupp_supplier_1#6189, cval_partsupp_ps_availqty#6176 AS cval_partsupp_ps_availqty_1#6190, cval_partsupp_ps_supplycost#6177 AS cval_partsupp_ps_supplycost_1#6191, cval_partsupp_ps_comment#6178 AS cval_partsupp_ps_comment_1#6192, cdepval_partsupp_ps_availqty#6179 AS cdepval_partsupp_ps_availqty_1#6193, cdepval_partsupp_ps_supplycost#6180 AS cdepval_partsupp_ps_supplycost_1#6194, cdepval_partsupp_ps_comment#6181 AS cdepval_partsupp_ps_comment_1#6195, cps_availqty#6182 AS cps_availqty_1#6196, cps_supplycost#6183 AS cps_supplycost_1#6197, cps_comment#6184 AS cps_comment_1#6198]
         :        +- Relation[rid#6171,cpfk_part_partsupp#6172,cfpk_partsupp_part#6173,cpfk_supplier_partsupp#6174,cfpk_partsupp_supplier#6175,cval_partsupp_ps_availqty#6176,cval_partsupp_ps_supplycost#6177,cval_partsupp_ps_comment#6178,cdepval_partsupp_ps_availqty#6179,cdepval_partsupp_ps_supplycost#6180,cdepval_partsupp_ps_comment#6181,cps_availqty#6182,cps_supplycost#6183,cps_comment#6184] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#6093 AS rid_1#6107, cpfk_part_partsupp#6094 AS cpfk_part_partsupp_1#6108, cfpk_partsupp_part#6095 AS cfpk_partsupp_part_1#6109, cpfk_supplier_partsupp#6096 AS cpfk_supplier_partsupp_1#6110, cfpk_partsupp_supplier#6097 AS cfpk_partsupp_supplier_1#6111, cval_partsupp_ps_availqty#6098 AS cval_partsupp_ps_availqty_1#6112, cval_partsupp_ps_supplycost#6099 AS cval_partsupp_ps_supplycost_1#6113, cval_partsupp_ps_comment#6100 AS cval_partsupp_ps_comment_1#6114, cdepval_partsupp_ps_availqty#6101 AS cdepval_partsupp_ps_availqty_1#6115, cdepval_partsupp_ps_supplycost#6102 AS cdepval_partsupp_ps_supplycost_1#6116, cdepval_partsupp_ps_comment#6103 AS cdepval_partsupp_ps_comment_1#6117, cps_availqty#6104 AS cps_availqty_1#6118, cps_supplycost#6105 AS cps_supplycost_1#6119, cps_comment#6106 AS cps_comment_1#6120]
            +- Relation[rid#6093,cpfk_part_partsupp#6094,cfpk_partsupp_part#6095,cpfk_supplier_partsupp#6096,cfpk_partsupp_supplier#6097,cval_partsupp_ps_availqty#6098,cval_partsupp_ps_supplycost#6099,cval_partsupp_ps_comment#6100,cdepval_partsupp_ps_availqty#6101,cdepval_partsupp_ps_supplycost#6102,cdepval_partsupp_ps_comment#6103,cps_availqty#6104,cps_supplycost#6105,cps_comment#6106] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 632ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/26 21:54:23 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:54:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6243L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 21:54:23 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:54:23 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:54:23 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:54:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:54:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:54:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:54:23 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:54:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:54:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6243L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6270, cval_part_p_name_0#6271, cval_part_p_mfgr_0#6272, cval_part_p_type_0#6273, cval_part_p_size_0#6274, cval_part_p_container_0#6275, cval_part_p_retailprice_0#6276, cval_part_p_comment_0#6277, cval_part_p_brand_0#6278, cdepval_part_p_name_0#6279, cdepval_part_p_mfgr_0#6280, cdepval_part_p_type_0#6281, cdepval_part_p_size_0#6282, cdepval_part_p_container_0#6283, cdepval_part_p_retailprice_0#6284, cdepval_part_p_comment_0#6285, cdepval_part_p_brand_0#6286, cp_name_0#6287, cp_mfgr_0#6288, cp_type_0#6289, cp_size_0#6290, cp_container_0#6291, cp_retailprice_0#6292, cp_comment_0#6293, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  :  +- Project [rid#6245 AS rid_0#6270, cval_part_p_name#6246 AS cval_part_p_name_0#6271, cval_part_p_mfgr#6247 AS cval_part_p_mfgr_0#6272, cval_part_p_type#6248 AS cval_part_p_type_0#6273, cval_part_p_size#6249 AS cval_part_p_size_0#6274, cval_part_p_container#6250 AS cval_part_p_container_0#6275, cval_part_p_retailprice#6251 AS cval_part_p_retailprice_0#6276, cval_part_p_comment#6252 AS cval_part_p_comment_0#6277, cval_part_p_brand#6253 AS cval_part_p_brand_0#6278, cdepval_part_p_name#6254 AS cdepval_part_p_name_0#6279, cdepval_part_p_mfgr#6255 AS cdepval_part_p_mfgr_0#6280, cdepval_part_p_type#6256 AS cdepval_part_p_type_0#6281, cdepval_part_p_size#6257 AS cdepval_part_p_size_0#6282, cdepval_part_p_container#6258 AS cdepval_part_p_container_0#6283, cdepval_part_p_retailprice#6259 AS cdepval_part_p_retailprice_0#6284, cdepval_part_p_comment#6260 AS cdepval_part_p_comment_0#6285, cdepval_part_p_brand#6261 AS cdepval_part_p_brand_0#6286, cp_name#6262 AS cp_name_0#6287, cp_mfgr#6263 AS cp_mfgr_0#6288, cp_type#6264 AS cp_type_0#6289, cp_size#6265 AS cp_size_0#6290, cp_container#6266 AS cp_container_0#6291, cp_retailprice#6267 AS cp_retailprice_0#6292, cp_comment#6268 AS cp_comment_0#6293, cp_brand#6269 AS cp_brand_0#6294]
         :  :  :     +- Relation[rid#6245,cval_part_p_name#6246,cval_part_p_mfgr#6247,cval_part_p_type#6248,cval_part_p_size#6249,cval_part_p_container#6250,cval_part_p_retailprice#6251,cval_part_p_comment#6252,cval_part_p_brand#6253,cdepval_part_p_name#6254,cdepval_part_p_mfgr#6255,cdepval_part_p_type#6256,cdepval_part_p_size#6257,cdepval_part_p_container#6258,cdepval_part_p_retailprice#6259,cdepval_part_p_comment#6260,cdepval_part_p_brand#6261,cp_name#6262,cp_mfgr#6263,cp_type#6264,cp_size#6265,cp_container#6266,cp_retailprice#6267,cp_comment#6268,cp_brand#6269] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :  :     +- Project [rid#6423 AS rid_1#6437, cpfk_part_partsupp#6424 AS cpfk_part_partsupp_1#6438, cfpk_partsupp_part#6425 AS cfpk_partsupp_part_1#6439, cpfk_supplier_partsupp#6426 AS cpfk_supplier_partsupp_1#6440, cfpk_partsupp_supplier#6427 AS cfpk_partsupp_supplier_1#6441, cval_partsupp_ps_availqty#6428 AS cval_partsupp_ps_availqty_1#6442, cval_partsupp_ps_supplycost#6429 AS cval_partsupp_ps_supplycost_1#6443, cval_partsupp_ps_comment#6430 AS cval_partsupp_ps_comment_1#6444, cdepval_partsupp_ps_availqty#6431 AS cdepval_partsupp_ps_availqty_1#6445, cdepval_partsupp_ps_supplycost#6432 AS cdepval_partsupp_ps_supplycost_1#6446, cdepval_partsupp_ps_comment#6433 AS cdepval_partsupp_ps_comment_1#6447, cps_availqty#6434 AS cps_availqty_1#6448, cps_supplycost#6435 AS cps_supplycost_1#6449, cps_comment#6436 AS cps_comment_1#6450]
         :  :        +- Relation[rid#6423,cpfk_part_partsupp#6424,cfpk_partsupp_part#6425,cpfk_supplier_partsupp#6426,cfpk_partsupp_supplier#6427,cval_partsupp_ps_availqty#6428,cval_partsupp_ps_supplycost#6429,cval_partsupp_ps_comment#6430,cdepval_partsupp_ps_availqty#6431,cdepval_partsupp_ps_supplycost#6432,cdepval_partsupp_ps_comment#6433,cps_availqty#6434,cps_supplycost#6435,cps_comment#6436] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#6345 AS rid_1#6359, cpfk_part_partsupp#6346 AS cpfk_part_partsupp_1#6360, cfpk_partsupp_part#6347 AS cfpk_partsupp_part_1#6361, cpfk_supplier_partsupp#6348 AS cpfk_supplier_partsupp_1#6362, cfpk_partsupp_supplier#6349 AS cfpk_partsupp_supplier_1#6363, cval_partsupp_ps_availqty#6350 AS cval_partsupp_ps_availqty_1#6364, cval_partsupp_ps_supplycost#6351 AS cval_partsupp_ps_supplycost_1#6365, cval_partsupp_ps_comment#6352 AS cval_partsupp_ps_comment_1#6366, cdepval_partsupp_ps_availqty#6353 AS cdepval_partsupp_ps_availqty_1#6367, cdepval_partsupp_ps_supplycost#6354 AS cdepval_partsupp_ps_supplycost_1#6368, cdepval_partsupp_ps_comment#6355 AS cdepval_partsupp_ps_comment_1#6369, cps_availqty#6356 AS cps_availqty_1#6370, cps_supplycost#6357 AS cps_supplycost_1#6371, cps_comment#6358 AS cps_comment_1#6372]
         :     +- Relation[rid#6345,cpfk_part_partsupp#6346,cfpk_partsupp_part#6347,cpfk_supplier_partsupp#6348,cfpk_partsupp_supplier#6349,cval_partsupp_ps_availqty#6350,cval_partsupp_ps_supplycost#6351,cval_partsupp_ps_comment#6352,cdepval_partsupp_ps_availqty#6353,cdepval_partsupp_ps_supplycost#6354,cdepval_partsupp_ps_comment#6355,cps_availqty#6356,cps_supplycost#6357,cps_comment#6358] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_2, NotMaterialized, NotMaterialized, [rid_2#6460, cpfk_region_nation_2#6461, cfpk_nation_region_2#6462, cval_nation_n_name_2#6463, cval_nation_n_comment_2#6464, cdepval_nation_n_name_2#6465, cdepval_nation_n_comment_2#6466, cn_name_2#6467, cn_comment_2#6468, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
            :  :  +- Project [rid#6451 AS rid_2#6460, cpfk_region_nation#6452 AS cpfk_region_nation_2#6461, cfpk_nation_region#6453 AS cfpk_nation_region_2#6462, cval_nation_n_name#6454 AS cval_nation_n_name_2#6463, cval_nation_n_comment#6455 AS cval_nation_n_comment_2#6464, cdepval_nation_n_name#6456 AS cdepval_nation_n_name_2#6465, cdepval_nation_n_comment#6457 AS cdepval_nation_n_comment_2#6466, cn_name#6458 AS cn_name_2#6467, cn_comment#6459 AS cn_comment_2#6468]
            :  :     +- Relation[rid#6451,cpfk_region_nation#6452,cfpk_nation_region#6453,cval_nation_n_name#6454,cval_nation_n_comment#6455,cdepval_nation_n_name#6456,cdepval_nation_n_comment#6457,cn_name#6458,cn_comment#6459] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#6541 AS rid_3#6559, cpfk_nation_supplier#6542 AS cpfk_nation_supplier_3#6560, cfpk_supplier_nation#6543 AS cfpk_supplier_nation_3#6561, cval_supplier_s_name#6544 AS cval_supplier_s_name_3#6562, cval_supplier_s_address#6545 AS cval_supplier_s_address_3#6563, cval_supplier_s_phone#6546 AS cval_supplier_s_phone_3#6564, cval_supplier_s_acctbal#6547 AS cval_supplier_s_acctbal_3#6565, cval_supplier_s_comment#6548 AS cval_supplier_s_comment_3#6566, cdepval_supplier_s_name#6549 AS cdepval_supplier_s_name_3#6567, cdepval_supplier_s_address#6550 AS cdepval_supplier_s_address_3#6568, cdepval_supplier_s_phone#6551 AS cdepval_supplier_s_phone_3#6569, cdepval_supplier_s_acctbal#6552 AS cdepval_supplier_s_acctbal_3#6570, cdepval_supplier_s_comment#6553 AS cdepval_supplier_s_comment_3#6571, cs_name#6554 AS cs_name_3#6572, cs_address#6555 AS cs_address_3#6573, cs_phone#6556 AS cs_phone_3#6574, cs_acctbal#6557 AS cs_acctbal_3#6575, cs_comment#6558 AS cs_comment_3#6576]
            :        +- Relation[rid#6541,cpfk_nation_supplier#6542,cfpk_supplier_nation#6543,cval_supplier_s_name#6544,cval_supplier_s_address#6545,cval_supplier_s_phone#6546,cval_supplier_s_acctbal#6547,cval_supplier_s_comment#6548,cdepval_supplier_s_name#6549,cdepval_supplier_s_address#6550,cdepval_supplier_s_phone#6551,cdepval_supplier_s_acctbal#6552,cdepval_supplier_s_comment#6553,cs_name#6554,cs_address#6555,cs_phone#6556,cs_acctbal#6557,cs_comment#6558] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#6487 AS rid_3#6505, cpfk_nation_supplier#6488 AS cpfk_nation_supplier_3#6506, cfpk_supplier_nation#6489 AS cfpk_supplier_nation_3#6507, cval_supplier_s_name#6490 AS cval_supplier_s_name_3#6508, cval_supplier_s_address#6491 AS cval_supplier_s_address_3#6509, cval_supplier_s_phone#6492 AS cval_supplier_s_phone_3#6510, cval_supplier_s_acctbal#6493 AS cval_supplier_s_acctbal_3#6511, cval_supplier_s_comment#6494 AS cval_supplier_s_comment_3#6512, cdepval_supplier_s_name#6495 AS cdepval_supplier_s_name_3#6513, cdepval_supplier_s_address#6496 AS cdepval_supplier_s_address_3#6514, cdepval_supplier_s_phone#6497 AS cdepval_supplier_s_phone_3#6515, cdepval_supplier_s_acctbal#6498 AS cdepval_supplier_s_acctbal_3#6516, cdepval_supplier_s_comment#6499 AS cdepval_supplier_s_comment_3#6517, cs_name#6500 AS cs_name_3#6518, cs_address#6501 AS cs_address_3#6519, cs_phone#6502 AS cs_phone_3#6520, cs_acctbal#6503 AS cs_acctbal_3#6521, cs_comment#6504 AS cs_comment_3#6522]
               +- Relation[rid#6487,cpfk_nation_supplier#6488,cfpk_supplier_nation#6489,cval_supplier_s_name#6490,cval_supplier_s_address#6491,cval_supplier_s_phone#6492,cval_supplier_s_acctbal#6493,cval_supplier_s_comment#6494,cdepval_supplier_s_name#6495,cdepval_supplier_s_address#6496,cdepval_supplier_s_phone#6497,cdepval_supplier_s_acctbal#6498,cdepval_supplier_s_comment#6499,cs_name#6500,cs_address#6501,cs_phone#6502,cs_acctbal#6503,cs_comment#6504] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 821ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/26 21:54:24 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:54:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6649L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 21:54:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:54:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:54:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:54:24 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:54:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:54:24 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:54:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6649L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#6777 AS rid_2#6791, cpfk_part_partsupp#6778 AS cpfk_part_partsupp_2#6792, cfpk_partsupp_part#6779 AS cfpk_partsupp_part_2#6793, cpfk_supplier_partsupp#6780 AS cpfk_supplier_partsupp_2#6794, cfpk_partsupp_supplier#6781 AS cfpk_partsupp_supplier_2#6795, cval_partsupp_ps_availqty#6782 AS cval_partsupp_ps_availqty_2#6796, cval_partsupp_ps_supplycost#6783 AS cval_partsupp_ps_supplycost_2#6797, cval_partsupp_ps_comment#6784 AS cval_partsupp_ps_comment_2#6798, cdepval_partsupp_ps_availqty#6785 AS cdepval_partsupp_ps_availqty_2#6799, cdepval_partsupp_ps_supplycost#6786 AS cdepval_partsupp_ps_supplycost_2#6800, cdepval_partsupp_ps_comment#6787 AS cdepval_partsupp_ps_comment_2#6801, cps_availqty#6788 AS cps_availqty_2#6802, cps_supplycost#6789 AS cps_supplycost_2#6803, cps_comment#6790 AS cps_comment_2#6804]
         :  +- Relation[rid#6777,cpfk_part_partsupp#6778,cfpk_partsupp_part#6779,cpfk_supplier_partsupp#6780,cfpk_partsupp_supplier#6781,cval_partsupp_ps_availqty#6782,cval_partsupp_ps_supplycost#6783,cval_partsupp_ps_comment#6784,cdepval_partsupp_ps_availqty#6785,cdepval_partsupp_ps_supplycost#6786,cdepval_partsupp_ps_comment#6787,cps_availqty#6788,cps_supplycost#6789,cps_comment#6790] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6660, cpfk_region_nation_0#6661, cfpk_nation_region_0#6662, cval_nation_n_name_0#6663, cval_nation_n_comment_0#6664, cdepval_nation_n_name_0#6665, cdepval_nation_n_comment_0#6666, cn_name_0#6667, cn_comment_0#6668, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
            :  :  +- Project [rid#6651 AS rid_0#6660, cpfk_region_nation#6652 AS cpfk_region_nation_0#6661, cfpk_nation_region#6653 AS cfpk_nation_region_0#6662, cval_nation_n_name#6654 AS cval_nation_n_name_0#6663, cval_nation_n_comment#6655 AS cval_nation_n_comment_0#6664, cdepval_nation_n_name#6656 AS cdepval_nation_n_name_0#6665, cdepval_nation_n_comment#6657 AS cdepval_nation_n_comment_0#6666, cn_name#6658 AS cn_name_0#6667, cn_comment#6659 AS cn_comment_0#6668]
            :  :     +- Relation[rid#6651,cpfk_region_nation#6652,cfpk_nation_region#6653,cval_nation_n_name#6654,cval_nation_n_comment#6655,cdepval_nation_n_name#6656,cdepval_nation_n_comment#6657,cn_name#6658,cn_comment#6659] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
            :     +- Project [rid#6741 AS rid_1#6759, cpfk_nation_supplier#6742 AS cpfk_nation_supplier_1#6760, cfpk_supplier_nation#6743 AS cfpk_supplier_nation_1#6761, cval_supplier_s_name#6744 AS cval_supplier_s_name_1#6762, cval_supplier_s_address#6745 AS cval_supplier_s_address_1#6763, cval_supplier_s_phone#6746 AS cval_supplier_s_phone_1#6764, cval_supplier_s_acctbal#6747 AS cval_supplier_s_acctbal_1#6765, cval_supplier_s_comment#6748 AS cval_supplier_s_comment_1#6766, cdepval_supplier_s_name#6749 AS cdepval_supplier_s_name_1#6767, cdepval_supplier_s_address#6750 AS cdepval_supplier_s_address_1#6768, cdepval_supplier_s_phone#6751 AS cdepval_supplier_s_phone_1#6769, cdepval_supplier_s_acctbal#6752 AS cdepval_supplier_s_acctbal_1#6770, cdepval_supplier_s_comment#6753 AS cdepval_supplier_s_comment_1#6771, cs_name#6754 AS cs_name_1#6772, cs_address#6755 AS cs_address_1#6773, cs_phone#6756 AS cs_phone_1#6774, cs_acctbal#6757 AS cs_acctbal_1#6775, cs_comment#6758 AS cs_comment_1#6776]
            :        +- Relation[rid#6741,cpfk_nation_supplier#6742,cfpk_supplier_nation#6743,cval_supplier_s_name#6744,cval_supplier_s_address#6745,cval_supplier_s_phone#6746,cval_supplier_s_acctbal#6747,cval_supplier_s_comment#6748,cdepval_supplier_s_name#6749,cdepval_supplier_s_address#6750,cdepval_supplier_s_phone#6751,cdepval_supplier_s_acctbal#6752,cdepval_supplier_s_comment#6753,cs_name#6754,cs_address#6755,cs_phone#6756,cs_acctbal#6757,cs_comment#6758] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#6687 AS rid_1#6705, cpfk_nation_supplier#6688 AS cpfk_nation_supplier_1#6706, cfpk_supplier_nation#6689 AS cfpk_supplier_nation_1#6707, cval_supplier_s_name#6690 AS cval_supplier_s_name_1#6708, cval_supplier_s_address#6691 AS cval_supplier_s_address_1#6709, cval_supplier_s_phone#6692 AS cval_supplier_s_phone_1#6710, cval_supplier_s_acctbal#6693 AS cval_supplier_s_acctbal_1#6711, cval_supplier_s_comment#6694 AS cval_supplier_s_comment_1#6712, cdepval_supplier_s_name#6695 AS cdepval_supplier_s_name_1#6713, cdepval_supplier_s_address#6696 AS cdepval_supplier_s_address_1#6714, cdepval_supplier_s_phone#6697 AS cdepval_supplier_s_phone_1#6715, cdepval_supplier_s_acctbal#6698 AS cdepval_supplier_s_acctbal_1#6716, cdepval_supplier_s_comment#6699 AS cdepval_supplier_s_comment_1#6717, cs_name#6700 AS cs_name_1#6718, cs_address#6701 AS cs_address_1#6719, cs_phone#6702 AS cs_phone_1#6720, cs_acctbal#6703 AS cs_acctbal_1#6721, cs_comment#6704 AS cs_comment_1#6722]
               +- Relation[rid#6687,cpfk_nation_supplier#6688,cfpk_supplier_nation#6689,cval_supplier_s_name#6690,cval_supplier_s_address#6691,cval_supplier_s_phone#6692,cval_supplier_s_acctbal#6693,cval_supplier_s_comment#6694,cdepval_supplier_s_name#6695,cdepval_supplier_s_address#6696,cdepval_supplier_s_phone#6697,cdepval_supplier_s_acctbal#6698,cdepval_supplier_s_comment#6699,cs_name#6700,cs_address#6701,cs_phone#6702,cs_acctbal#6703,cs_comment#6704] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 2420ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/26 21:54:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:54:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6853L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:54:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:54:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:54:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:54:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:54:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:54:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:54:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:54:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:54:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6853L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6880, cval_part_p_name_0#6881, cval_part_p_mfgr_0#6882, cval_part_p_type_0#6883, cval_part_p_size_0#6884, cval_part_p_container_0#6885, cval_part_p_retailprice_0#6886, cval_part_p_comment_0#6887, cval_part_p_brand_0#6888, cdepval_part_p_name_0#6889, cdepval_part_p_mfgr_0#6890, cdepval_part_p_type_0#6891, cdepval_part_p_size_0#6892, cdepval_part_p_container_0#6893, cdepval_part_p_retailprice_0#6894, cdepval_part_p_comment_0#6895, cdepval_part_p_brand_0#6896, cp_name_0#6897, cp_mfgr_0#6898, cp_type_0#6899, cp_size_0#6900, cp_container_0#6901, cp_retailprice_0#6902, cp_comment_0#6903, ... 2 more fields]
         :  :  :  :  :- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :  :  :  +- Project [rid#6855 AS rid_0#6880, cval_part_p_name#6856 AS cval_part_p_name_0#6881, cval_part_p_mfgr#6857 AS cval_part_p_mfgr_0#6882, cval_part_p_type#6858 AS cval_part_p_type_0#6883, cval_part_p_size#6859 AS cval_part_p_size_0#6884, cval_part_p_container#6860 AS cval_part_p_container_0#6885, cval_part_p_retailprice#6861 AS cval_part_p_retailprice_0#6886, cval_part_p_comment#6862 AS cval_part_p_comment_0#6887, cval_part_p_brand#6863 AS cval_part_p_brand_0#6888, cdepval_part_p_name#6864 AS cdepval_part_p_name_0#6889, cdepval_part_p_mfgr#6865 AS cdepval_part_p_mfgr_0#6890, cdepval_part_p_type#6866 AS cdepval_part_p_type_0#6891, cdepval_part_p_size#6867 AS cdepval_part_p_size_0#6892, cdepval_part_p_container#6868 AS cdepval_part_p_container_0#6893, cdepval_part_p_retailprice#6869 AS cdepval_part_p_retailprice_0#6894, cdepval_part_p_comment#6870 AS cdepval_part_p_comment_0#6895, cdepval_part_p_brand#6871 AS cdepval_part_p_brand_0#6896, cp_name#6872 AS cp_name_0#6897, cp_mfgr#6873 AS cp_mfgr_0#6898, cp_type#6874 AS cp_type_0#6899, cp_size#6875 AS cp_size_0#6900, cp_container#6876 AS cp_container_0#6901, cp_retailprice#6877 AS cp_retailprice_0#6902, cp_comment#6878 AS cp_comment_0#6903, cp_brand#6879 AS cp_brand_0#6904]
         :  :  :  :  :     +- Relation[rid#6855,cval_part_p_name#6856,cval_part_p_mfgr#6857,cval_part_p_type#6858,cval_part_p_size#6859,cval_part_p_container#6860,cval_part_p_retailprice#6861,cval_part_p_comment#6862,cval_part_p_brand#6863,cdepval_part_p_name#6864,cdepval_part_p_mfgr#6865,cdepval_part_p_type#6866,cdepval_part_p_size#6867,cdepval_part_p_container#6868,cdepval_part_p_retailprice#6869,cdepval_part_p_comment#6870,cdepval_part_p_brand#6871,cp_name#6872,cp_mfgr#6873,cp_type#6874,cp_size#6875,cp_container#6876,cp_retailprice#6877,cp_comment#6878,cp_brand#6879] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :  :  :  :     +- Project [rid#7095 AS rid_1#7140, cpfk_orders_lineitem#7096 AS cpfk_orders_lineitem_1#7141, cpfk_supplier_lineitem#7097 AS cpfk_supplier_lineitem_1#7142, cfpk_lineitem_supplier#7098 AS cfpk_lineitem_supplier_1#7143, cfpk_lineitem_partsupp#7099 AS cfpk_lineitem_partsupp_1#7144, cpfk_part_lineitem#7100 AS cpfk_part_lineitem_1#7145, cfpk_lineitem_part#7101 AS cfpk_lineitem_part_1#7146, cpfk_partsupp_lineitem#7102 AS cpfk_partsupp_lineitem_1#7147, cfpk_lineitem_orders#7103 AS cfpk_lineitem_orders_1#7148, cval_lineitem_l_quantity#7104 AS cval_lineitem_l_quantity_1#7149, cval_lineitem_l_extendedprice#7105 AS cval_lineitem_l_extendedprice_1#7150, cval_lineitem_l_discount#7106 AS cval_lineitem_l_discount_1#7151, cval_lineitem_l_tax#7107 AS cval_lineitem_l_tax_1#7152, cval_lineitem_l_returnflag#7108 AS cval_lineitem_l_returnflag_1#7153, cval_lineitem_l_linestatus#7109 AS cval_lineitem_l_linestatus_1#7154, cval_lineitem_l_commitdate#7110 AS cval_lineitem_l_commitdate_1#7155, cval_lineitem_l_receiptdate#7111 AS cval_lineitem_l_receiptdate_1#7156, cval_lineitem_l_shipinstruct#7112 AS cval_lineitem_l_shipinstruct_1#7157, cval_lineitem_l_shipmode#7113 AS cval_lineitem_l_shipmode_1#7158, cval_lineitem_l_comment#7114 AS cval_lineitem_l_comment_1#7159, cval_lineitem_l_shipdate#7115 AS cval_lineitem_l_shipdate_1#7160, cdepval_lineitem_l_quantity#7116 AS cdepval_lineitem_l_quantity_1#7161, cdepval_lineitem_l_extendedprice#7117 AS cdepval_lineitem_l_extendedprice_1#7162, cdepval_lineitem_l_discount#7118 AS cdepval_lineitem_l_discount_1#7163, ... 21 more fields]
         :  :  :  :        +- Relation[rid#7095,cpfk_orders_lineitem#7096,cpfk_supplier_lineitem#7097,cfpk_lineitem_supplier#7098,cfpk_lineitem_partsupp#7099,cpfk_part_lineitem#7100,cfpk_lineitem_part#7101,cpfk_partsupp_lineitem#7102,cfpk_lineitem_orders#7103,cval_lineitem_l_quantity#7104,cval_lineitem_l_extendedprice#7105,cval_lineitem_l_discount#7106,cval_lineitem_l_tax#7107,cval_lineitem_l_returnflag#7108,cval_lineitem_l_linestatus#7109,cval_lineitem_l_commitdate#7110,cval_lineitem_l_receiptdate#7111,cval_lineitem_l_shipinstruct#7112,cval_lineitem_l_shipmode#7113,cval_lineitem_l_comment#7114,cval_lineitem_l_shipdate#7115,cdepval_lineitem_l_quantity#7116,cdepval_lineitem_l_extendedprice#7117,cdepval_lineitem_l_discount#7118,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- Project [rid#6955 AS rid_1#7000, cpfk_orders_lineitem#6956 AS cpfk_orders_lineitem_1#7001, cpfk_supplier_lineitem#6957 AS cpfk_supplier_lineitem_1#7002, cfpk_lineitem_supplier#6958 AS cfpk_lineitem_supplier_1#7003, cfpk_lineitem_partsupp#6959 AS cfpk_lineitem_partsupp_1#7004, cpfk_part_lineitem#6960 AS cpfk_part_lineitem_1#7005, cfpk_lineitem_part#6961 AS cfpk_lineitem_part_1#7006, cpfk_partsupp_lineitem#6962 AS cpfk_partsupp_lineitem_1#7007, cfpk_lineitem_orders#6963 AS cfpk_lineitem_orders_1#7008, cval_lineitem_l_quantity#6964 AS cval_lineitem_l_quantity_1#7009, cval_lineitem_l_extendedprice#6965 AS cval_lineitem_l_extendedprice_1#7010, cval_lineitem_l_discount#6966 AS cval_lineitem_l_discount_1#7011, cval_lineitem_l_tax#6967 AS cval_lineitem_l_tax_1#7012, cval_lineitem_l_returnflag#6968 AS cval_lineitem_l_returnflag_1#7013, cval_lineitem_l_linestatus#6969 AS cval_lineitem_l_linestatus_1#7014, cval_lineitem_l_commitdate#6970 AS cval_lineitem_l_commitdate_1#7015, cval_lineitem_l_receiptdate#6971 AS cval_lineitem_l_receiptdate_1#7016, cval_lineitem_l_shipinstruct#6972 AS cval_lineitem_l_shipinstruct_1#7017, cval_lineitem_l_shipmode#6973 AS cval_lineitem_l_shipmode_1#7018, cval_lineitem_l_comment#6974 AS cval_lineitem_l_comment_1#7019, cval_lineitem_l_shipdate#6975 AS cval_lineitem_l_shipdate_1#7020, cdepval_lineitem_l_quantity#6976 AS cdepval_lineitem_l_quantity_1#7021, cdepval_lineitem_l_extendedprice#6977 AS cdepval_lineitem_l_extendedprice_1#7022, cdepval_lineitem_l_discount#6978 AS cdepval_lineitem_l_discount_1#7023, ... 21 more fields]
         :  :  :     +- Relation[rid#6955,cpfk_orders_lineitem#6956,cpfk_supplier_lineitem#6957,cfpk_lineitem_supplier#6958,cfpk_lineitem_partsupp#6959,cpfk_part_lineitem#6960,cfpk_lineitem_part#6961,cpfk_partsupp_lineitem#6962,cfpk_lineitem_orders#6963,cval_lineitem_l_quantity#6964,cval_lineitem_l_extendedprice#6965,cval_lineitem_l_discount#6966,cval_lineitem_l_tax#6967,cval_lineitem_l_returnflag#6968,cval_lineitem_l_linestatus#6969,cval_lineitem_l_commitdate#6970,cval_lineitem_l_receiptdate#6971,cval_lineitem_l_shipinstruct#6972,cval_lineitem_l_shipmode#6973,cval_lineitem_l_comment#6974,cval_lineitem_l_shipdate#6975,cdepval_lineitem_l_quantity#6976,cdepval_lineitem_l_extendedprice#6977,cdepval_lineitem_l_discount#6978,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#7185 AS rid_2#7203, cpfk_nation_supplier#7186 AS cpfk_nation_supplier_2#7204, cfpk_supplier_nation#7187 AS cfpk_supplier_nation_2#7205, cval_supplier_s_name#7188 AS cval_supplier_s_name_2#7206, cval_supplier_s_address#7189 AS cval_supplier_s_address_2#7207, cval_supplier_s_phone#7190 AS cval_supplier_s_phone_2#7208, cval_supplier_s_acctbal#7191 AS cval_supplier_s_acctbal_2#7209, cval_supplier_s_comment#7192 AS cval_supplier_s_comment_2#7210, cdepval_supplier_s_name#7193 AS cdepval_supplier_s_name_2#7211, cdepval_supplier_s_address#7194 AS cdepval_supplier_s_address_2#7212, cdepval_supplier_s_phone#7195 AS cdepval_supplier_s_phone_2#7213, cdepval_supplier_s_acctbal#7196 AS cdepval_supplier_s_acctbal_2#7214, cdepval_supplier_s_comment#7197 AS cdepval_supplier_s_comment_2#7215, cs_name#7198 AS cs_name_2#7216, cs_address#7199 AS cs_address_2#7217, cs_phone#7200 AS cs_phone_2#7218, cs_acctbal#7201 AS cs_acctbal_2#7219, cs_comment#7202 AS cs_comment_2#7220]
         :  :     +- Relation[rid#7185,cpfk_nation_supplier#7186,cfpk_supplier_nation#7187,cval_supplier_s_name#7188,cval_supplier_s_address#7189,cval_supplier_s_phone#7190,cval_supplier_s_acctbal#7191,cval_supplier_s_comment#7192,cdepval_supplier_s_name#7193,cdepval_supplier_s_address#7194,cdepval_supplier_s_phone#7195,cdepval_supplier_s_acctbal#7196,cdepval_supplier_s_comment#7197,cs_name#7198,cs_address#7199,cs_phone#7200,cs_acctbal#7201,cs_comment#7202] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#7221 AS rid_3#7230, cpfk_region_nation#7222 AS cpfk_region_nation_3#7231, cfpk_nation_region#7223 AS cfpk_nation_region_3#7232, cval_nation_n_name#7224 AS cval_nation_n_name_3#7233, cval_nation_n_comment#7225 AS cval_nation_n_comment_3#7234, cdepval_nation_n_name#7226 AS cdepval_nation_n_name_3#7235, cdepval_nation_n_comment#7227 AS cdepval_nation_n_comment_3#7236, cn_name#7228 AS cn_name_3#7237, cn_comment#7229 AS cn_comment_3#7238]
         :     +- Relation[rid#7221,cpfk_region_nation#7222,cfpk_nation_region#7223,cval_nation_n_name#7224,cval_nation_n_comment#7225,cdepval_nation_n_name#7226,cdepval_nation_n_comment#7227,cn_name#7228,cn_comment#7229] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#7359 AS rid_7#7383, cpfk_customer_orders#7360 AS cpfk_customer_orders_7#7384, cfpk_orders_customer#7361 AS cfpk_orders_customer_7#7385, cval_orders_o_orderstatus#7362 AS cval_orders_o_orderstatus_7#7386, cval_orders_o_totalprice#7363 AS cval_orders_o_totalprice_7#7387, cval_orders_o_orderpriority#7364 AS cval_orders_o_orderpriority_7#7388, cval_orders_o_clerk#7365 AS cval_orders_o_clerk_7#7389, cval_orders_o_shippriority#7366 AS cval_orders_o_shippriority_7#7390, cval_orders_o_comment#7367 AS cval_orders_o_comment_7#7391, cval_orders_o_orderdate#7368 AS cval_orders_o_orderdate_7#7392, cdepval_orders_o_orderstatus#7369 AS cdepval_orders_o_orderstatus_7#7393, cdepval_orders_o_totalprice#7370 AS cdepval_orders_o_totalprice_7#7394, cdepval_orders_o_orderpriority#7371 AS cdepval_orders_o_orderpriority_7#7395, cdepval_orders_o_clerk#7372 AS cdepval_orders_o_clerk_7#7396, cdepval_orders_o_shippriority#7373 AS cdepval_orders_o_shippriority_7#7397, cdepval_orders_o_comment#7374 AS cdepval_orders_o_comment_7#7398, cdepval_orders_o_orderdate#7375 AS cdepval_orders_o_orderdate_7#7399, co_orderstatus#7376 AS co_orderstatus_7#7400, co_totalprice#7377 AS co_totalprice_7#7401, co_orderpriority#7378 AS co_orderpriority_7#7402, co_clerk#7379 AS co_clerk_7#7403, co_shippriority#7380 AS co_shippriority_7#7404, co_comment#7381 AS co_comment_7#7405, co_orderdate#7382 AS co_orderdate_7#7406]
            :  +- Relation[rid#7359,cpfk_customer_orders#7360,cfpk_orders_customer#7361,cval_orders_o_orderstatus#7362,cval_orders_o_totalprice#7363,cval_orders_o_orderpriority#7364,cval_orders_o_clerk#7365,cval_orders_o_shippriority#7366,cval_orders_o_comment#7367,cval_orders_o_orderdate#7368,cdepval_orders_o_orderstatus#7369,cdepval_orders_o_totalprice#7370,cdepval_orders_o_orderpriority#7371,cdepval_orders_o_clerk#7372,cdepval_orders_o_shippriority#7373,cdepval_orders_o_comment#7374,cdepval_orders_o_orderdate#7375,co_orderstatus#7376,co_totalprice#7377,co_orderpriority#7378,co_clerk#7379,co_shippriority#7380,co_comment#7381,co_orderdate#7382] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#7317 AS rid_6#7338, cpfk_nation_customer#7318 AS cpfk_nation_customer_6#7339, cfpk_customer_nation#7319 AS cfpk_customer_nation_6#7340, cval_customer_c_name#7320 AS cval_customer_c_name_6#7341, cval_customer_c_address#7321 AS cval_customer_c_address_6#7342, cval_customer_c_phone#7322 AS cval_customer_c_phone_6#7343, cval_customer_c_acctbal#7323 AS cval_customer_c_acctbal_6#7344, cval_customer_c_comment#7324 AS cval_customer_c_comment_6#7345, cval_customer_c_mktsegment#7325 AS cval_customer_c_mktsegment_6#7346, cdepval_customer_c_name#7326 AS cdepval_customer_c_name_6#7347, cdepval_customer_c_address#7327 AS cdepval_customer_c_address_6#7348, cdepval_customer_c_phone#7328 AS cdepval_customer_c_phone_6#7349, cdepval_customer_c_acctbal#7329 AS cdepval_customer_c_acctbal_6#7350, cdepval_customer_c_comment#7330 AS cdepval_customer_c_comment_6#7351, cdepval_customer_c_mktsegment#7331 AS cdepval_customer_c_mktsegment_6#7352, cc_name#7332 AS cc_name_6#7353, cc_address#7333 AS cc_address_6#7354, cc_phone#7334 AS cc_phone_6#7355, cc_acctbal#7335 AS cc_acctbal_6#7356, cc_comment#7336 AS cc_comment_6#7357, cc_mktsegment#7337 AS cc_mktsegment_6#7358]
               :  +- Relation[rid#7317,cpfk_nation_customer#7318,cfpk_customer_nation#7319,cval_customer_c_name#7320,cval_customer_c_address#7321,cval_customer_c_phone#7322,cval_customer_c_acctbal#7323,cval_customer_c_comment#7324,cval_customer_c_mktsegment#7325,cdepval_customer_c_name#7326,cdepval_customer_c_address#7327,cdepval_customer_c_phone#7328,cdepval_customer_c_acctbal#7329,cdepval_customer_c_comment#7330,cdepval_customer_c_mktsegment#7331,cc_name#7332,cc_address#7333,cc_phone#7334,cc_acctbal#7335,cc_comment#7336,cc_mktsegment#7337] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join UsingJoin(Inner,List(rid_5))
                  :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_5, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#7246, cval_region_r_name_4#7247, cval_region_r_comment_4#7248, cdepval_region_r_name_4#7249, cdepval_region_r_comment_4#7250, cr_name_4#7251, cr_comment_4#7252, 'rid_5]
                  :  :- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                  :  :  +- Project [rid#7239 AS rid_4#7246, cval_region_r_name#7240 AS cval_region_r_name_4#7247, cval_region_r_comment#7241 AS cval_region_r_comment_4#7248, cdepval_region_r_name#7242 AS cdepval_region_r_name_4#7249, cdepval_region_r_comment#7243 AS cdepval_region_r_comment_4#7250, cr_name#7244 AS cr_name_4#7251, cr_comment#7245 AS cr_comment_4#7252]
                  :  :     +- Relation[rid#7239,cval_region_r_name#7240,cval_region_r_comment#7241,cdepval_region_r_name#7242,cdepval_region_r_comment#7243,cr_name#7244,cr_comment#7245] JDBCRelation(tregion) [numPartitions=1]
                  :  +- 'Project ['cpfk_region_nation_5, 'rid_5]
                  :     +- Project [rid#7299 AS rid_5#7308, cpfk_region_nation#7300 AS cpfk_region_nation_5#7309, cfpk_nation_region#7301 AS cfpk_nation_region_5#7310, cval_nation_n_name#7302 AS cval_nation_n_name_5#7311, cval_nation_n_comment#7303 AS cval_nation_n_comment_5#7312, cdepval_nation_n_name#7304 AS cdepval_nation_n_name_5#7313, cdepval_nation_n_comment#7305 AS cdepval_nation_n_comment_5#7314, cn_name#7306 AS cn_name_5#7315, cn_comment#7307 AS cn_comment_5#7316]
                  :        +- Relation[rid#7299,cpfk_region_nation#7300,cfpk_nation_region#7301,cval_nation_n_name#7302,cval_nation_n_comment#7303,cdepval_nation_n_name#7304,cdepval_nation_n_comment#7305,cn_name#7306,cn_comment#7307] JDBCRelation(tnation) [numPartitions=1]
                  +- Project [rid#7267 AS rid_5#7276, cpfk_region_nation#7268 AS cpfk_region_nation_5#7277, cfpk_nation_region#7269 AS cfpk_nation_region_5#7278, cval_nation_n_name#7270 AS cval_nation_n_name_5#7279, cval_nation_n_comment#7271 AS cval_nation_n_comment_5#7280, cdepval_nation_n_name#7272 AS cdepval_nation_n_name_5#7281, cdepval_nation_n_comment#7273 AS cdepval_nation_n_comment_5#7282, cn_name#7274 AS cn_name_5#7283, cn_comment#7275 AS cn_comment_5#7284]
                     +- Relation[rid#7267,cpfk_region_nation#7268,cfpk_nation_region#7269,cval_nation_n_name#7270,cval_nation_n_comment#7271,cdepval_nation_n_name#7272,cdepval_nation_n_comment#7273,cn_name#7274,cn_comment#7275] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 3330ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/26 21:54:29 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:54:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7570L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:54:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#7570L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#7572 AS rid_0#7617, cpfk_orders_lineitem#7573 AS cpfk_orders_lineitem_0#7618, cpfk_supplier_lineitem#7574 AS cpfk_supplier_lineitem_0#7619, cfpk_lineitem_supplier#7575 AS cfpk_lineitem_supplier_0#7620, cfpk_lineitem_partsupp#7576 AS cfpk_lineitem_partsupp_0#7621, cpfk_part_lineitem#7577 AS cpfk_part_lineitem_0#7622, cfpk_lineitem_part#7578 AS cfpk_lineitem_part_0#7623, cpfk_partsupp_lineitem#7579 AS cpfk_partsupp_lineitem_0#7624, cfpk_lineitem_orders#7580 AS cfpk_lineitem_orders_0#7625, cval_lineitem_l_quantity#7581 AS cval_lineitem_l_quantity_0#7626, cval_lineitem_l_extendedprice#7582 AS cval_lineitem_l_extendedprice_0#7627, cval_lineitem_l_discount#7583 AS cval_lineitem_l_discount_0#7628, cval_lineitem_l_tax#7584 AS cval_lineitem_l_tax_0#7629, cval_lineitem_l_returnflag#7585 AS cval_lineitem_l_returnflag_0#7630, cval_lineitem_l_linestatus#7586 AS cval_lineitem_l_linestatus_0#7631, cval_lineitem_l_commitdate#7587 AS cval_lineitem_l_commitdate_0#7632, cval_lineitem_l_receiptdate#7588 AS cval_lineitem_l_receiptdate_0#7633, cval_lineitem_l_shipinstruct#7589 AS cval_lineitem_l_shipinstruct_0#7634, cval_lineitem_l_shipmode#7590 AS cval_lineitem_l_shipmode_0#7635, cval_lineitem_l_comment#7591 AS cval_lineitem_l_comment_0#7636, cval_lineitem_l_shipdate#7592 AS cval_lineitem_l_shipdate_0#7637, cdepval_lineitem_l_quantity#7593 AS cdepval_lineitem_l_quantity_0#7638, cdepval_lineitem_l_extendedprice#7594 AS cdepval_lineitem_l_extendedprice_0#7639, cdepval_lineitem_l_discount#7595 AS cdepval_lineitem_l_discount_0#7640, ... 21 more fields]
         +- Relation[rid#7572,cpfk_orders_lineitem#7573,cpfk_supplier_lineitem#7574,cfpk_lineitem_supplier#7575,cfpk_lineitem_partsupp#7576,cpfk_part_lineitem#7577,cfpk_lineitem_part#7578,cpfk_partsupp_lineitem#7579,cfpk_lineitem_orders#7580,cval_lineitem_l_quantity#7581,cval_lineitem_l_extendedprice#7582,cval_lineitem_l_discount#7583,cval_lineitem_l_tax#7584,cval_lineitem_l_returnflag#7585,cval_lineitem_l_linestatus#7586,cval_lineitem_l_commitdate#7587,cval_lineitem_l_receiptdate#7588,cval_lineitem_l_shipinstruct#7589,cval_lineitem_l_shipmode#7590,cval_lineitem_l_comment#7591,cval_lineitem_l_shipdate#7592,cdepval_lineitem_l_quantity#7593,cdepval_lineitem_l_extendedprice#7594,cdepval_lineitem_l_discount#7595,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2358ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/26 21:54:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:54:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7711L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 21:54:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:54:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:54:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:54:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:54:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:54:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7711L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#7713 AS rid_0#7758, cpfk_orders_lineitem#7714 AS cpfk_orders_lineitem_0#7759, cpfk_supplier_lineitem#7715 AS cpfk_supplier_lineitem_0#7760, cfpk_lineitem_supplier#7716 AS cfpk_lineitem_supplier_0#7761, cfpk_lineitem_partsupp#7717 AS cfpk_lineitem_partsupp_0#7762, cpfk_part_lineitem#7718 AS cpfk_part_lineitem_0#7763, cfpk_lineitem_part#7719 AS cfpk_lineitem_part_0#7764, cpfk_partsupp_lineitem#7720 AS cpfk_partsupp_lineitem_0#7765, cfpk_lineitem_orders#7721 AS cfpk_lineitem_orders_0#7766, cval_lineitem_l_quantity#7722 AS cval_lineitem_l_quantity_0#7767, cval_lineitem_l_extendedprice#7723 AS cval_lineitem_l_extendedprice_0#7768, cval_lineitem_l_discount#7724 AS cval_lineitem_l_discount_0#7769, cval_lineitem_l_tax#7725 AS cval_lineitem_l_tax_0#7770, cval_lineitem_l_returnflag#7726 AS cval_lineitem_l_returnflag_0#7771, cval_lineitem_l_linestatus#7727 AS cval_lineitem_l_linestatus_0#7772, cval_lineitem_l_commitdate#7728 AS cval_lineitem_l_commitdate_0#7773, cval_lineitem_l_receiptdate#7729 AS cval_lineitem_l_receiptdate_0#7774, cval_lineitem_l_shipinstruct#7730 AS cval_lineitem_l_shipinstruct_0#7775, cval_lineitem_l_shipmode#7731 AS cval_lineitem_l_shipmode_0#7776, cval_lineitem_l_comment#7732 AS cval_lineitem_l_comment_0#7777, cval_lineitem_l_shipdate#7733 AS cval_lineitem_l_shipdate_0#7778, cdepval_lineitem_l_quantity#7734 AS cdepval_lineitem_l_quantity_0#7779, cdepval_lineitem_l_extendedprice#7735 AS cdepval_lineitem_l_extendedprice_0#7780, cdepval_lineitem_l_discount#7736 AS cdepval_lineitem_l_discount_0#7781, ... 21 more fields]
         :  +- Relation[rid#7713,cpfk_orders_lineitem#7714,cpfk_supplier_lineitem#7715,cfpk_lineitem_supplier#7716,cfpk_lineitem_partsupp#7717,cpfk_part_lineitem#7718,cfpk_lineitem_part#7719,cpfk_partsupp_lineitem#7720,cfpk_lineitem_orders#7721,cval_lineitem_l_quantity#7722,cval_lineitem_l_extendedprice#7723,cval_lineitem_l_discount#7724,cval_lineitem_l_tax#7725,cval_lineitem_l_returnflag#7726,cval_lineitem_l_linestatus#7727,cval_lineitem_l_commitdate#7728,cval_lineitem_l_receiptdate#7729,cval_lineitem_l_shipinstruct#7730,cval_lineitem_l_shipmode#7731,cval_lineitem_l_comment#7732,cval_lineitem_l_shipdate#7733,cdepval_lineitem_l_quantity#7734,cdepval_lineitem_l_extendedprice#7735,cdepval_lineitem_l_discount#7736,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#8172, cpfk_region_nation_4#8173, cfpk_nation_region_4#8174, cval_nation_n_name_4#8175, cval_nation_n_comment_4#8176, cdepval_nation_n_name_4#8177, cdepval_nation_n_comment_4#8178, cn_name_4#8179, cn_comment_4#8180, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
            :  :  +- Project [rid#8163 AS rid_4#8172, cpfk_region_nation#8164 AS cpfk_region_nation_4#8173, cfpk_nation_region#8165 AS cfpk_nation_region_4#8174, cval_nation_n_name#8166 AS cval_nation_n_name_4#8175, cval_nation_n_comment#8167 AS cval_nation_n_comment_4#8176, cdepval_nation_n_name#8168 AS cdepval_nation_n_name_4#8177, cdepval_nation_n_comment#8169 AS cdepval_nation_n_comment_4#8178, cn_name#8170 AS cn_name_4#8179, cn_comment#8171 AS cn_comment_4#8180]
            :  :     +- Relation[rid#8163,cpfk_region_nation#8164,cfpk_nation_region#8165,cval_nation_n_name#8166,cval_nation_n_comment#8167,cdepval_nation_n_name#8168,cdepval_nation_n_comment#8169,cn_name#8170,cn_comment#8171] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#8217 AS rid_3#8235, cpfk_nation_supplier#8218 AS cpfk_nation_supplier_3#8236, cfpk_supplier_nation#8219 AS cfpk_supplier_nation_3#8237, cval_supplier_s_name#8220 AS cval_supplier_s_name_3#8238, cval_supplier_s_address#8221 AS cval_supplier_s_address_3#8239, cval_supplier_s_phone#8222 AS cval_supplier_s_phone_3#8240, cval_supplier_s_acctbal#8223 AS cval_supplier_s_acctbal_3#8241, cval_supplier_s_comment#8224 AS cval_supplier_s_comment_3#8242, cdepval_supplier_s_name#8225 AS cdepval_supplier_s_name_3#8243, cdepval_supplier_s_address#8226 AS cdepval_supplier_s_address_3#8244, cdepval_supplier_s_phone#8227 AS cdepval_supplier_s_phone_3#8245, cdepval_supplier_s_acctbal#8228 AS cdepval_supplier_s_acctbal_3#8246, cdepval_supplier_s_comment#8229 AS cdepval_supplier_s_comment_3#8247, cs_name#8230 AS cs_name_3#8248, cs_address#8231 AS cs_address_3#8249, cs_phone#8232 AS cs_phone_3#8250, cs_acctbal#8233 AS cs_acctbal_3#8251, cs_comment#8234 AS cs_comment_3#8252]
            :        +- Relation[rid#8217,cpfk_nation_supplier#8218,cfpk_supplier_nation#8219,cval_supplier_s_name#8220,cval_supplier_s_address#8221,cval_supplier_s_phone#8222,cval_supplier_s_acctbal#8223,cval_supplier_s_comment#8224,cdepval_supplier_s_name#8225,cdepval_supplier_s_address#8226,cdepval_supplier_s_phone#8227,cdepval_supplier_s_acctbal#8228,cdepval_supplier_s_comment#8229,cs_name#8230,cs_address#8231,cs_phone#8232,cs_acctbal#8233,cs_comment#8234] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'DexPkfkMaterializationAwareJoin orders~lineitem, 'cpfk_orders_lineitem_2, 'rid_1, NotMaterialized, NotMaterialized, [rid_1#7827, cpfk_customer_orders_1#7828, cfpk_orders_customer_1#7829, cval_orders_o_orderstatus_1#7830, cval_orders_o_totalprice_1#7831, cval_orders_o_orderpriority_1#7832, cval_orders_o_clerk_1#7833, cval_orders_o_shippriority_1#7834, cval_orders_o_comment_1#7835, cval_orders_o_orderdate_1#7836, cdepval_orders_o_orderstatus_1#7837, cdepval_orders_o_totalprice_1#7838, cdepval_orders_o_orderpriority_1#7839, cdepval_orders_o_clerk_1#7840, cdepval_orders_o_shippriority_1#7841, cdepval_orders_o_comment_1#7842, cdepval_orders_o_orderdate_1#7843, co_orderstatus_1#7844, co_totalprice_1#7845, co_orderpriority_1#7846, co_clerk_1#7847, co_shippriority_1#7848, co_comment_1#7849, co_orderdate_1#7850, 'rid_2]
               :  :  :- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
               :  :  :  +- Project [rid#7803 AS rid_1#7827, cpfk_customer_orders#7804 AS cpfk_customer_orders_1#7828, cfpk_orders_customer#7805 AS cfpk_orders_customer_1#7829, cval_orders_o_orderstatus#7806 AS cval_orders_o_orderstatus_1#7830, cval_orders_o_totalprice#7807 AS cval_orders_o_totalprice_1#7831, cval_orders_o_orderpriority#7808 AS cval_orders_o_orderpriority_1#7832, cval_orders_o_clerk#7809 AS cval_orders_o_clerk_1#7833, cval_orders_o_shippriority#7810 AS cval_orders_o_shippriority_1#7834, cval_orders_o_comment#7811 AS cval_orders_o_comment_1#7835, cval_orders_o_orderdate#7812 AS cval_orders_o_orderdate_1#7836, cdepval_orders_o_orderstatus#7813 AS cdepval_orders_o_orderstatus_1#7837, cdepval_orders_o_totalprice#7814 AS cdepval_orders_o_totalprice_1#7838, cdepval_orders_o_orderpriority#7815 AS cdepval_orders_o_orderpriority_1#7839, cdepval_orders_o_clerk#7816 AS cdepval_orders_o_clerk_1#7840, cdepval_orders_o_shippriority#7817 AS cdepval_orders_o_shippriority_1#7841, cdepval_orders_o_comment#7818 AS cdepval_orders_o_comment_1#7842, cdepval_orders_o_orderdate#7819 AS cdepval_orders_o_orderdate_1#7843, co_orderstatus#7820 AS co_orderstatus_1#7844, co_totalprice#7821 AS co_totalprice_1#7845, co_orderpriority#7822 AS co_orderpriority_1#7846, co_clerk#7823 AS co_clerk_1#7847, co_shippriority#7824 AS co_shippriority_1#7848, co_comment#7825 AS co_comment_1#7849, co_orderdate#7826 AS co_orderdate_1#7850]
               :  :  :     +- Relation[rid#7803,cpfk_customer_orders#7804,cfpk_orders_customer#7805,cval_orders_o_orderstatus#7806,cval_orders_o_totalprice#7807,cval_orders_o_orderpriority#7808,cval_orders_o_clerk#7809,cval_orders_o_shippriority#7810,cval_orders_o_comment#7811,cval_orders_o_orderdate#7812,cdepval_orders_o_orderstatus#7813,cdepval_orders_o_totalprice#7814,cdepval_orders_o_orderpriority#7815,cdepval_orders_o_clerk#7816,cdepval_orders_o_shippriority#7817,cdepval_orders_o_comment#7818,cdepval_orders_o_orderdate#7819,co_orderstatus#7820,co_totalprice#7821,co_orderpriority#7822,co_clerk#7823,co_shippriority#7824,co_comment#7825,co_orderdate#7826] JDBCRelation(torders) [numPartitions=1]
               :  :  +- 'Project ['cpfk_orders_lineitem_2, 'rid_2]
               :  :     +- Project [rid#8037 AS rid_2#8082, cpfk_orders_lineitem#8038 AS cpfk_orders_lineitem_2#8083, cpfk_supplier_lineitem#8039 AS cpfk_supplier_lineitem_2#8084, cfpk_lineitem_supplier#8040 AS cfpk_lineitem_supplier_2#8085, cfpk_lineitem_partsupp#8041 AS cfpk_lineitem_partsupp_2#8086, cpfk_part_lineitem#8042 AS cpfk_part_lineitem_2#8087, cfpk_lineitem_part#8043 AS cfpk_lineitem_part_2#8088, cpfk_partsupp_lineitem#8044 AS cpfk_partsupp_lineitem_2#8089, cfpk_lineitem_orders#8045 AS cfpk_lineitem_orders_2#8090, cval_lineitem_l_quantity#8046 AS cval_lineitem_l_quantity_2#8091, cval_lineitem_l_extendedprice#8047 AS cval_lineitem_l_extendedprice_2#8092, cval_lineitem_l_discount#8048 AS cval_lineitem_l_discount_2#8093, cval_lineitem_l_tax#8049 AS cval_lineitem_l_tax_2#8094, cval_lineitem_l_returnflag#8050 AS cval_lineitem_l_returnflag_2#8095, cval_lineitem_l_linestatus#8051 AS cval_lineitem_l_linestatus_2#8096, cval_lineitem_l_commitdate#8052 AS cval_lineitem_l_commitdate_2#8097, cval_lineitem_l_receiptdate#8053 AS cval_lineitem_l_receiptdate_2#8098, cval_lineitem_l_shipinstruct#8054 AS cval_lineitem_l_shipinstruct_2#8099, cval_lineitem_l_shipmode#8055 AS cval_lineitem_l_shipmode_2#8100, cval_lineitem_l_comment#8056 AS cval_lineitem_l_comment_2#8101, cval_lineitem_l_shipdate#8057 AS cval_lineitem_l_shipdate_2#8102, cdepval_lineitem_l_quantity#8058 AS cdepval_lineitem_l_quantity_2#8103, cdepval_lineitem_l_extendedprice#8059 AS cdepval_lineitem_l_extendedprice_2#8104, cdepval_lineitem_l_discount#8060 AS cdepval_lineitem_l_discount_2#8105, ... 21 more fields]
               :  :        +- Relation[rid#8037,cpfk_orders_lineitem#8038,cpfk_supplier_lineitem#8039,cfpk_lineitem_supplier#8040,cfpk_lineitem_partsupp#8041,cpfk_part_lineitem#8042,cfpk_lineitem_part#8043,cpfk_partsupp_lineitem#8044,cfpk_lineitem_orders#8045,cval_lineitem_l_quantity#8046,cval_lineitem_l_extendedprice#8047,cval_lineitem_l_discount#8048,cval_lineitem_l_tax#8049,cval_lineitem_l_returnflag#8050,cval_lineitem_l_linestatus#8051,cval_lineitem_l_commitdate#8052,cval_lineitem_l_receiptdate#8053,cval_lineitem_l_shipinstruct#8054,cval_lineitem_l_shipmode#8055,cval_lineitem_l_comment#8056,cval_lineitem_l_shipdate#8057,cdepval_lineitem_l_quantity#8058,cdepval_lineitem_l_extendedprice#8059,cdepval_lineitem_l_discount#8060,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               :  +- Project [rid#7899 AS rid_2#7944, cpfk_orders_lineitem#7900 AS cpfk_orders_lineitem_2#7945, cpfk_supplier_lineitem#7901 AS cpfk_supplier_lineitem_2#7946, cfpk_lineitem_supplier#7902 AS cfpk_lineitem_supplier_2#7947, cfpk_lineitem_partsupp#7903 AS cfpk_lineitem_partsupp_2#7948, cpfk_part_lineitem#7904 AS cpfk_part_lineitem_2#7949, cfpk_lineitem_part#7905 AS cfpk_lineitem_part_2#7950, cpfk_partsupp_lineitem#7906 AS cpfk_partsupp_lineitem_2#7951, cfpk_lineitem_orders#7907 AS cfpk_lineitem_orders_2#7952, cval_lineitem_l_quantity#7908 AS cval_lineitem_l_quantity_2#7953, cval_lineitem_l_extendedprice#7909 AS cval_lineitem_l_extendedprice_2#7954, cval_lineitem_l_discount#7910 AS cval_lineitem_l_discount_2#7955, cval_lineitem_l_tax#7911 AS cval_lineitem_l_tax_2#7956, cval_lineitem_l_returnflag#7912 AS cval_lineitem_l_returnflag_2#7957, cval_lineitem_l_linestatus#7913 AS cval_lineitem_l_linestatus_2#7958, cval_lineitem_l_commitdate#7914 AS cval_lineitem_l_commitdate_2#7959, cval_lineitem_l_receiptdate#7915 AS cval_lineitem_l_receiptdate_2#7960, cval_lineitem_l_shipinstruct#7916 AS cval_lineitem_l_shipinstruct_2#7961, cval_lineitem_l_shipmode#7917 AS cval_lineitem_l_shipmode_2#7962, cval_lineitem_l_comment#7918 AS cval_lineitem_l_comment_2#7963, cval_lineitem_l_shipdate#7919 AS cval_lineitem_l_shipdate_2#7964, cdepval_lineitem_l_quantity#7920 AS cdepval_lineitem_l_quantity_2#7965, cdepval_lineitem_l_extendedprice#7921 AS cdepval_lineitem_l_extendedprice_2#7966, cdepval_lineitem_l_discount#7922 AS cdepval_lineitem_l_discount_2#7967, ... 21 more fields]
               :     +- Relation[rid#7899,cpfk_orders_lineitem#7900,cpfk_supplier_lineitem#7901,cfpk_lineitem_supplier#7902,cfpk_lineitem_partsupp#7903,cpfk_part_lineitem#7904,cfpk_lineitem_part#7905,cpfk_partsupp_lineitem#7906,cfpk_lineitem_orders#7907,cval_lineitem_l_quantity#7908,cval_lineitem_l_extendedprice#7909,cval_lineitem_l_discount#7910,cval_lineitem_l_tax#7911,cval_lineitem_l_returnflag#7912,cval_lineitem_l_linestatus#7913,cval_lineitem_l_commitdate#7914,cval_lineitem_l_receiptdate#7915,cval_lineitem_l_shipinstruct#7916,cval_lineitem_l_shipmode#7917,cval_lineitem_l_comment#7918,cval_lineitem_l_shipdate#7919,cdepval_lineitem_l_quantity#7920,cdepval_lineitem_l_extendedprice#7921,cdepval_lineitem_l_discount#7922,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               +- Project [rid#8127 AS rid_3#8145, cpfk_nation_supplier#8128 AS cpfk_nation_supplier_3#8146, cfpk_supplier_nation#8129 AS cfpk_supplier_nation_3#8147, cval_supplier_s_name#8130 AS cval_supplier_s_name_3#8148, cval_supplier_s_address#8131 AS cval_supplier_s_address_3#8149, cval_supplier_s_phone#8132 AS cval_supplier_s_phone_3#8150, cval_supplier_s_acctbal#8133 AS cval_supplier_s_acctbal_3#8151, cval_supplier_s_comment#8134 AS cval_supplier_s_comment_3#8152, cdepval_supplier_s_name#8135 AS cdepval_supplier_s_name_3#8153, cdepval_supplier_s_address#8136 AS cdepval_supplier_s_address_3#8154, cdepval_supplier_s_phone#8137 AS cdepval_supplier_s_phone_3#8155, cdepval_supplier_s_acctbal#8138 AS cdepval_supplier_s_acctbal_3#8156, cdepval_supplier_s_comment#8139 AS cdepval_supplier_s_comment_3#8157, cs_name#8140 AS cs_name_3#8158, cs_address#8141 AS cs_address_3#8159, cs_phone#8142 AS cs_phone_3#8160, cs_acctbal#8143 AS cs_acctbal_3#8161, cs_comment#8144 AS cs_comment_3#8162]
                  +- Relation[rid#8127,cpfk_nation_supplier#8128,cfpk_supplier_nation#8129,cval_supplier_s_name#8130,cval_supplier_s_address#8131,cval_supplier_s_phone#8132,cval_supplier_s_acctbal#8133,cval_supplier_s_comment#8134,cdepval_supplier_s_name#8135,cdepval_supplier_s_address#8136,cdepval_supplier_s_phone#8137,cdepval_supplier_s_acctbal#8138,cdepval_supplier_s_comment#8139,cs_name#8140,cs_address#8141,cs_phone#8142,cs_acctbal#8143,cs_comment#8144] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 160145ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/26 21:57:12 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:57:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8422L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:57:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8422L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#8424 AS rid_0#8469, cpfk_orders_lineitem#8425 AS cpfk_orders_lineitem_0#8470, cpfk_supplier_lineitem#8426 AS cpfk_supplier_lineitem_0#8471, cfpk_lineitem_supplier#8427 AS cfpk_lineitem_supplier_0#8472, cfpk_lineitem_partsupp#8428 AS cfpk_lineitem_partsupp_0#8473, cpfk_part_lineitem#8429 AS cpfk_part_lineitem_0#8474, cfpk_lineitem_part#8430 AS cfpk_lineitem_part_0#8475, cpfk_partsupp_lineitem#8431 AS cpfk_partsupp_lineitem_0#8476, cfpk_lineitem_orders#8432 AS cfpk_lineitem_orders_0#8477, cval_lineitem_l_quantity#8433 AS cval_lineitem_l_quantity_0#8478, cval_lineitem_l_extendedprice#8434 AS cval_lineitem_l_extendedprice_0#8479, cval_lineitem_l_discount#8435 AS cval_lineitem_l_discount_0#8480, cval_lineitem_l_tax#8436 AS cval_lineitem_l_tax_0#8481, cval_lineitem_l_returnflag#8437 AS cval_lineitem_l_returnflag_0#8482, cval_lineitem_l_linestatus#8438 AS cval_lineitem_l_linestatus_0#8483, cval_lineitem_l_commitdate#8439 AS cval_lineitem_l_commitdate_0#8484, cval_lineitem_l_receiptdate#8440 AS cval_lineitem_l_receiptdate_0#8485, cval_lineitem_l_shipinstruct#8441 AS cval_lineitem_l_shipinstruct_0#8486, cval_lineitem_l_shipmode#8442 AS cval_lineitem_l_shipmode_0#8487, cval_lineitem_l_comment#8443 AS cval_lineitem_l_comment_0#8488, cval_lineitem_l_shipdate#8444 AS cval_lineitem_l_shipdate_0#8489, cdepval_lineitem_l_quantity#8445 AS cdepval_lineitem_l_quantity_0#8490, cdepval_lineitem_l_extendedprice#8446 AS cdepval_lineitem_l_extendedprice_0#8491, cdepval_lineitem_l_discount#8447 AS cdepval_lineitem_l_discount_0#8492, ... 21 more fields]
         :  +- Relation[rid#8424,cpfk_orders_lineitem#8425,cpfk_supplier_lineitem#8426,cfpk_lineitem_supplier#8427,cfpk_lineitem_partsupp#8428,cpfk_part_lineitem#8429,cfpk_lineitem_part#8430,cpfk_partsupp_lineitem#8431,cfpk_lineitem_orders#8432,cval_lineitem_l_quantity#8433,cval_lineitem_l_extendedprice#8434,cval_lineitem_l_discount#8435,cval_lineitem_l_tax#8436,cval_lineitem_l_returnflag#8437,cval_lineitem_l_linestatus#8438,cval_lineitem_l_commitdate#8439,cval_lineitem_l_receiptdate#8440,cval_lineitem_l_shipinstruct#8441,cval_lineitem_l_shipmode#8442,cval_lineitem_l_comment#8443,cval_lineitem_l_shipdate#8444,cdepval_lineitem_l_quantity#8445,cdepval_lineitem_l_extendedprice#8446,cdepval_lineitem_l_discount#8447,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8514 AS rid_1#8538, cpfk_customer_orders#8515 AS cpfk_customer_orders_1#8539, cfpk_orders_customer#8516 AS cfpk_orders_customer_1#8540, cval_orders_o_orderstatus#8517 AS cval_orders_o_orderstatus_1#8541, cval_orders_o_totalprice#8518 AS cval_orders_o_totalprice_1#8542, cval_orders_o_orderpriority#8519 AS cval_orders_o_orderpriority_1#8543, cval_orders_o_clerk#8520 AS cval_orders_o_clerk_1#8544, cval_orders_o_shippriority#8521 AS cval_orders_o_shippriority_1#8545, cval_orders_o_comment#8522 AS cval_orders_o_comment_1#8546, cval_orders_o_orderdate#8523 AS cval_orders_o_orderdate_1#8547, cdepval_orders_o_orderstatus#8524 AS cdepval_orders_o_orderstatus_1#8548, cdepval_orders_o_totalprice#8525 AS cdepval_orders_o_totalprice_1#8549, cdepval_orders_o_orderpriority#8526 AS cdepval_orders_o_orderpriority_1#8550, cdepval_orders_o_clerk#8527 AS cdepval_orders_o_clerk_1#8551, cdepval_orders_o_shippriority#8528 AS cdepval_orders_o_shippriority_1#8552, cdepval_orders_o_comment#8529 AS cdepval_orders_o_comment_1#8553, cdepval_orders_o_orderdate#8530 AS cdepval_orders_o_orderdate_1#8554, co_orderstatus#8531 AS co_orderstatus_1#8555, co_totalprice#8532 AS co_totalprice_1#8556, co_orderpriority#8533 AS co_orderpriority_1#8557, co_clerk#8534 AS co_clerk_1#8558, co_shippriority#8535 AS co_shippriority_1#8559, co_comment#8536 AS co_comment_1#8560, co_orderdate#8537 AS co_orderdate_1#8561]
            +- Relation[rid#8514,cpfk_customer_orders#8515,cfpk_orders_customer#8516,cval_orders_o_orderstatus#8517,cval_orders_o_totalprice#8518,cval_orders_o_orderpriority#8519,cval_orders_o_clerk#8520,cval_orders_o_shippriority#8521,cval_orders_o_comment#8522,cval_orders_o_orderdate#8523,cdepval_orders_o_orderstatus#8524,cdepval_orders_o_totalprice#8525,cdepval_orders_o_orderpriority#8526,cdepval_orders_o_clerk#8527,cdepval_orders_o_shippriority#8528,cdepval_orders_o_comment#8529,cdepval_orders_o_orderdate#8530,co_orderstatus#8531,co_totalprice#8532,co_orderpriority#8533,co_clerk#8534,co_shippriority#8535,co_comment#8536,co_orderdate#8537] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 19033ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/26 21:57:31 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:57:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8635L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:57:31 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:57:31 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:57:31 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:57:31 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:57:31 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:57:31 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:57:31 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:57:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8635L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#8662, cval_part_p_name_0#8663, cval_part_p_mfgr_0#8664, cval_part_p_type_0#8665, cval_part_p_size_0#8666, cval_part_p_container_0#8667, cval_part_p_retailprice_0#8668, cval_part_p_comment_0#8669, cval_part_p_brand_0#8670, cdepval_part_p_name_0#8671, cdepval_part_p_mfgr_0#8672, cdepval_part_p_type_0#8673, cdepval_part_p_size_0#8674, cdepval_part_p_container_0#8675, cdepval_part_p_retailprice_0#8676, cdepval_part_p_comment_0#8677, cdepval_part_p_brand_0#8678, cp_name_0#8679, cp_mfgr_0#8680, cp_type_0#8681, cp_size_0#8682, cp_container_0#8683, cp_retailprice_0#8684, cp_comment_0#8685, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#8637 AS rid_0#8662, cval_part_p_name#8638 AS cval_part_p_name_0#8663, cval_part_p_mfgr#8639 AS cval_part_p_mfgr_0#8664, cval_part_p_type#8640 AS cval_part_p_type_0#8665, cval_part_p_size#8641 AS cval_part_p_size_0#8666, cval_part_p_container#8642 AS cval_part_p_container_0#8667, cval_part_p_retailprice#8643 AS cval_part_p_retailprice_0#8668, cval_part_p_comment#8644 AS cval_part_p_comment_0#8669, cval_part_p_brand#8645 AS cval_part_p_brand_0#8670, cdepval_part_p_name#8646 AS cdepval_part_p_name_0#8671, cdepval_part_p_mfgr#8647 AS cdepval_part_p_mfgr_0#8672, cdepval_part_p_type#8648 AS cdepval_part_p_type_0#8673, cdepval_part_p_size#8649 AS cdepval_part_p_size_0#8674, cdepval_part_p_container#8650 AS cdepval_part_p_container_0#8675, cdepval_part_p_retailprice#8651 AS cdepval_part_p_retailprice_0#8676, cdepval_part_p_comment#8652 AS cdepval_part_p_comment_0#8677, cdepval_part_p_brand#8653 AS cdepval_part_p_brand_0#8678, cp_name#8654 AS cp_name_0#8679, cp_mfgr#8655 AS cp_mfgr_0#8680, cp_type#8656 AS cp_type_0#8681, cp_size#8657 AS cp_size_0#8682, cp_container#8658 AS cp_container_0#8683, cp_retailprice#8659 AS cp_retailprice_0#8684, cp_comment#8660 AS cp_comment_0#8685, cp_brand#8661 AS cp_brand_0#8686]
         :  :        +- Relation[rid#8637,cval_part_p_name#8638,cval_part_p_mfgr#8639,cval_part_p_type#8640,cval_part_p_size#8641,cval_part_p_container#8642,cval_part_p_retailprice#8643,cval_part_p_comment#8644,cval_part_p_brand#8645,cdepval_part_p_name#8646,cdepval_part_p_mfgr#8647,cdepval_part_p_type#8648,cdepval_part_p_size#8649,cdepval_part_p_container#8650,cdepval_part_p_retailprice#8651,cdepval_part_p_comment#8652,cdepval_part_p_brand#8653,cp_name#8654,cp_mfgr#8655,cp_type#8656,cp_size#8657,cp_container#8658,cp_retailprice#8659,cp_comment#8660,cp_brand#8661] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#8927 AS rid_1#8972, cpfk_orders_lineitem#8928 AS cpfk_orders_lineitem_1#8973, cpfk_supplier_lineitem#8929 AS cpfk_supplier_lineitem_1#8974, cfpk_lineitem_supplier#8930 AS cfpk_lineitem_supplier_1#8975, cfpk_lineitem_partsupp#8931 AS cfpk_lineitem_partsupp_1#8976, cpfk_part_lineitem#8932 AS cpfk_part_lineitem_1#8977, cfpk_lineitem_part#8933 AS cfpk_lineitem_part_1#8978, cpfk_partsupp_lineitem#8934 AS cpfk_partsupp_lineitem_1#8979, cfpk_lineitem_orders#8935 AS cfpk_lineitem_orders_1#8980, cval_lineitem_l_quantity#8936 AS cval_lineitem_l_quantity_1#8981, cval_lineitem_l_extendedprice#8937 AS cval_lineitem_l_extendedprice_1#8982, cval_lineitem_l_discount#8938 AS cval_lineitem_l_discount_1#8983, cval_lineitem_l_tax#8939 AS cval_lineitem_l_tax_1#8984, cval_lineitem_l_returnflag#8940 AS cval_lineitem_l_returnflag_1#8985, cval_lineitem_l_linestatus#8941 AS cval_lineitem_l_linestatus_1#8986, cval_lineitem_l_commitdate#8942 AS cval_lineitem_l_commitdate_1#8987, cval_lineitem_l_receiptdate#8943 AS cval_lineitem_l_receiptdate_1#8988, cval_lineitem_l_shipinstruct#8944 AS cval_lineitem_l_shipinstruct_1#8989, cval_lineitem_l_shipmode#8945 AS cval_lineitem_l_shipmode_1#8990, cval_lineitem_l_comment#8946 AS cval_lineitem_l_comment_1#8991, cval_lineitem_l_shipdate#8947 AS cval_lineitem_l_shipdate_1#8992, cdepval_lineitem_l_quantity#8948 AS cdepval_lineitem_l_quantity_1#8993, cdepval_lineitem_l_extendedprice#8949 AS cdepval_lineitem_l_extendedprice_1#8994, cdepval_lineitem_l_discount#8950 AS cdepval_lineitem_l_discount_1#8995, ... 21 more fields]
         :        +- Relation[rid#8927,cpfk_orders_lineitem#8928,cpfk_supplier_lineitem#8929,cfpk_lineitem_supplier#8930,cfpk_lineitem_partsupp#8931,cpfk_part_lineitem#8932,cfpk_lineitem_part#8933,cpfk_partsupp_lineitem#8934,cfpk_lineitem_orders#8935,cval_lineitem_l_quantity#8936,cval_lineitem_l_extendedprice#8937,cval_lineitem_l_discount#8938,cval_lineitem_l_tax#8939,cval_lineitem_l_returnflag#8940,cval_lineitem_l_linestatus#8941,cval_lineitem_l_commitdate#8942,cval_lineitem_l_receiptdate#8943,cval_lineitem_l_shipinstruct#8944,cval_lineitem_l_shipmode#8945,cval_lineitem_l_comment#8946,cval_lineitem_l_shipdate#8947,cdepval_lineitem_l_quantity#8948,cdepval_lineitem_l_extendedprice#8949,cdepval_lineitem_l_discount#8950,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8787 AS rid_1#8832, cpfk_orders_lineitem#8788 AS cpfk_orders_lineitem_1#8833, cpfk_supplier_lineitem#8789 AS cpfk_supplier_lineitem_1#8834, cfpk_lineitem_supplier#8790 AS cfpk_lineitem_supplier_1#8835, cfpk_lineitem_partsupp#8791 AS cfpk_lineitem_partsupp_1#8836, cpfk_part_lineitem#8792 AS cpfk_part_lineitem_1#8837, cfpk_lineitem_part#8793 AS cfpk_lineitem_part_1#8838, cpfk_partsupp_lineitem#8794 AS cpfk_partsupp_lineitem_1#8839, cfpk_lineitem_orders#8795 AS cfpk_lineitem_orders_1#8840, cval_lineitem_l_quantity#8796 AS cval_lineitem_l_quantity_1#8841, cval_lineitem_l_extendedprice#8797 AS cval_lineitem_l_extendedprice_1#8842, cval_lineitem_l_discount#8798 AS cval_lineitem_l_discount_1#8843, cval_lineitem_l_tax#8799 AS cval_lineitem_l_tax_1#8844, cval_lineitem_l_returnflag#8800 AS cval_lineitem_l_returnflag_1#8845, cval_lineitem_l_linestatus#8801 AS cval_lineitem_l_linestatus_1#8846, cval_lineitem_l_commitdate#8802 AS cval_lineitem_l_commitdate_1#8847, cval_lineitem_l_receiptdate#8803 AS cval_lineitem_l_receiptdate_1#8848, cval_lineitem_l_shipinstruct#8804 AS cval_lineitem_l_shipinstruct_1#8849, cval_lineitem_l_shipmode#8805 AS cval_lineitem_l_shipmode_1#8850, cval_lineitem_l_comment#8806 AS cval_lineitem_l_comment_1#8851, cval_lineitem_l_shipdate#8807 AS cval_lineitem_l_shipdate_1#8852, cdepval_lineitem_l_quantity#8808 AS cdepval_lineitem_l_quantity_1#8853, cdepval_lineitem_l_extendedprice#8809 AS cdepval_lineitem_l_extendedprice_1#8854, cdepval_lineitem_l_discount#8810 AS cdepval_lineitem_l_discount_1#8855, ... 21 more fields]
            +- Relation[rid#8787,cpfk_orders_lineitem#8788,cpfk_supplier_lineitem#8789,cfpk_lineitem_supplier#8790,cfpk_lineitem_partsupp#8791,cpfk_part_lineitem#8792,cfpk_lineitem_part#8793,cpfk_partsupp_lineitem#8794,cfpk_lineitem_orders#8795,cval_lineitem_l_quantity#8796,cval_lineitem_l_extendedprice#8797,cval_lineitem_l_discount#8798,cval_lineitem_l_tax#8799,cval_lineitem_l_returnflag#8800,cval_lineitem_l_linestatus#8801,cval_lineitem_l_commitdate#8802,cval_lineitem_l_receiptdate#8803,cval_lineitem_l_shipinstruct#8804,cval_lineitem_l_shipmode#8805,cval_lineitem_l_comment#8806,cval_lineitem_l_shipdate#8807,cdepval_lineitem_l_quantity#8808,cdepval_lineitem_l_extendedprice#8809,cdepval_lineitem_l_discount#8810,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 501ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/26 21:57:31 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:57:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9099L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 21:57:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:57:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:57:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9099L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#9101 AS rid_0#9146, cpfk_orders_lineitem#9102 AS cpfk_orders_lineitem_0#9147, cpfk_supplier_lineitem#9103 AS cpfk_supplier_lineitem_0#9148, cfpk_lineitem_supplier#9104 AS cfpk_lineitem_supplier_0#9149, cfpk_lineitem_partsupp#9105 AS cfpk_lineitem_partsupp_0#9150, cpfk_part_lineitem#9106 AS cpfk_part_lineitem_0#9151, cfpk_lineitem_part#9107 AS cfpk_lineitem_part_0#9152, cpfk_partsupp_lineitem#9108 AS cpfk_partsupp_lineitem_0#9153, cfpk_lineitem_orders#9109 AS cfpk_lineitem_orders_0#9154, cval_lineitem_l_quantity#9110 AS cval_lineitem_l_quantity_0#9155, cval_lineitem_l_extendedprice#9111 AS cval_lineitem_l_extendedprice_0#9156, cval_lineitem_l_discount#9112 AS cval_lineitem_l_discount_0#9157, cval_lineitem_l_tax#9113 AS cval_lineitem_l_tax_0#9158, cval_lineitem_l_returnflag#9114 AS cval_lineitem_l_returnflag_0#9159, cval_lineitem_l_linestatus#9115 AS cval_lineitem_l_linestatus_0#9160, cval_lineitem_l_commitdate#9116 AS cval_lineitem_l_commitdate_0#9161, cval_lineitem_l_receiptdate#9117 AS cval_lineitem_l_receiptdate_0#9162, cval_lineitem_l_shipinstruct#9118 AS cval_lineitem_l_shipinstruct_0#9163, cval_lineitem_l_shipmode#9119 AS cval_lineitem_l_shipmode_0#9164, cval_lineitem_l_comment#9120 AS cval_lineitem_l_comment_0#9165, cval_lineitem_l_shipdate#9121 AS cval_lineitem_l_shipdate_0#9166, cdepval_lineitem_l_quantity#9122 AS cdepval_lineitem_l_quantity_0#9167, cdepval_lineitem_l_extendedprice#9123 AS cdepval_lineitem_l_extendedprice_0#9168, cdepval_lineitem_l_discount#9124 AS cdepval_lineitem_l_discount_0#9169, ... 21 more fields]
         :  :  :     +- Relation[rid#9101,cpfk_orders_lineitem#9102,cpfk_supplier_lineitem#9103,cfpk_lineitem_supplier#9104,cfpk_lineitem_partsupp#9105,cpfk_part_lineitem#9106,cfpk_lineitem_part#9107,cpfk_partsupp_lineitem#9108,cfpk_lineitem_orders#9109,cval_lineitem_l_quantity#9110,cval_lineitem_l_extendedprice#9111,cval_lineitem_l_discount#9112,cval_lineitem_l_tax#9113,cval_lineitem_l_returnflag#9114,cval_lineitem_l_linestatus#9115,cval_lineitem_l_commitdate#9116,cval_lineitem_l_receiptdate#9117,cval_lineitem_l_shipinstruct#9118,cval_lineitem_l_shipmode#9119,cval_lineitem_l_comment#9120,cval_lineitem_l_shipdate#9121,cdepval_lineitem_l_quantity#9122,cdepval_lineitem_l_extendedprice#9123,cdepval_lineitem_l_discount#9124,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#9281 AS rid_1#9305, cpfk_customer_orders#9282 AS cpfk_customer_orders_1#9306, cfpk_orders_customer#9283 AS cfpk_orders_customer_1#9307, cval_orders_o_orderstatus#9284 AS cval_orders_o_orderstatus_1#9308, cval_orders_o_totalprice#9285 AS cval_orders_o_totalprice_1#9309, cval_orders_o_orderpriority#9286 AS cval_orders_o_orderpriority_1#9310, cval_orders_o_clerk#9287 AS cval_orders_o_clerk_1#9311, cval_orders_o_shippriority#9288 AS cval_orders_o_shippriority_1#9312, cval_orders_o_comment#9289 AS cval_orders_o_comment_1#9313, cval_orders_o_orderdate#9290 AS cval_orders_o_orderdate_1#9314, cdepval_orders_o_orderstatus#9291 AS cdepval_orders_o_orderstatus_1#9315, cdepval_orders_o_totalprice#9292 AS cdepval_orders_o_totalprice_1#9316, cdepval_orders_o_orderpriority#9293 AS cdepval_orders_o_orderpriority_1#9317, cdepval_orders_o_clerk#9294 AS cdepval_orders_o_clerk_1#9318, cdepval_orders_o_shippriority#9295 AS cdepval_orders_o_shippriority_1#9319, cdepval_orders_o_comment#9296 AS cdepval_orders_o_comment_1#9320, cdepval_orders_o_orderdate#9297 AS cdepval_orders_o_orderdate_1#9321, co_orderstatus#9298 AS co_orderstatus_1#9322, co_totalprice#9299 AS co_totalprice_1#9323, co_orderpriority#9300 AS co_orderpriority_1#9324, co_clerk#9301 AS co_clerk_1#9325, co_shippriority#9302 AS co_shippriority_1#9326, co_comment#9303 AS co_comment_1#9327, co_orderdate#9304 AS co_orderdate_1#9328]
         :  :     +- Relation[rid#9281,cpfk_customer_orders#9282,cfpk_orders_customer#9283,cval_orders_o_orderstatus#9284,cval_orders_o_totalprice#9285,cval_orders_o_orderpriority#9286,cval_orders_o_clerk#9287,cval_orders_o_shippriority#9288,cval_orders_o_comment#9289,cval_orders_o_orderdate#9290,cdepval_orders_o_orderstatus#9291,cdepval_orders_o_totalprice#9292,cdepval_orders_o_orderpriority#9293,cdepval_orders_o_clerk#9294,cdepval_orders_o_shippriority#9295,cdepval_orders_o_comment#9296,cdepval_orders_o_orderdate#9297,co_orderstatus#9298,co_totalprice#9299,co_orderpriority#9300,co_clerk#9301,co_shippriority#9302,co_comment#9303,co_orderdate#9304] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#9329 AS rid_2#9350, cpfk_nation_customer#9330 AS cpfk_nation_customer_2#9351, cfpk_customer_nation#9331 AS cfpk_customer_nation_2#9352, cval_customer_c_name#9332 AS cval_customer_c_name_2#9353, cval_customer_c_address#9333 AS cval_customer_c_address_2#9354, cval_customer_c_phone#9334 AS cval_customer_c_phone_2#9355, cval_customer_c_acctbal#9335 AS cval_customer_c_acctbal_2#9356, cval_customer_c_comment#9336 AS cval_customer_c_comment_2#9357, cval_customer_c_mktsegment#9337 AS cval_customer_c_mktsegment_2#9358, cdepval_customer_c_name#9338 AS cdepval_customer_c_name_2#9359, cdepval_customer_c_address#9339 AS cdepval_customer_c_address_2#9360, cdepval_customer_c_phone#9340 AS cdepval_customer_c_phone_2#9361, cdepval_customer_c_acctbal#9341 AS cdepval_customer_c_acctbal_2#9362, cdepval_customer_c_comment#9342 AS cdepval_customer_c_comment_2#9363, cdepval_customer_c_mktsegment#9343 AS cdepval_customer_c_mktsegment_2#9364, cc_name#9344 AS cc_name_2#9365, cc_address#9345 AS cc_address_2#9366, cc_phone#9346 AS cc_phone_2#9367, cc_acctbal#9347 AS cc_acctbal_2#9368, cc_comment#9348 AS cc_comment_2#9369, cc_mktsegment#9349 AS cc_mktsegment_2#9370]
         :     +- Relation[rid#9329,cpfk_nation_customer#9330,cfpk_customer_nation#9331,cval_customer_c_name#9332,cval_customer_c_address#9333,cval_customer_c_phone#9334,cval_customer_c_acctbal#9335,cval_customer_c_comment#9336,cval_customer_c_mktsegment#9337,cdepval_customer_c_name#9338,cdepval_customer_c_address#9339,cdepval_customer_c_phone#9340,cdepval_customer_c_acctbal#9341,cdepval_customer_c_comment#9342,cdepval_customer_c_mktsegment#9343,cc_name#9344,cc_address#9345,cc_phone#9346,cc_acctbal#9347,cc_comment#9348,cc_mktsegment#9349] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#9371 AS rid_3#9380, cpfk_region_nation#9372 AS cpfk_region_nation_3#9381, cfpk_nation_region#9373 AS cfpk_nation_region_3#9382, cval_nation_n_name#9374 AS cval_nation_n_name_3#9383, cval_nation_n_comment#9375 AS cval_nation_n_comment_3#9384, cdepval_nation_n_name#9376 AS cdepval_nation_n_name_3#9385, cdepval_nation_n_comment#9377 AS cdepval_nation_n_comment_3#9386, cn_name#9378 AS cn_name_3#9387, cn_comment#9379 AS cn_comment_3#9388]
            +- Relation[rid#9371,cpfk_region_nation#9372,cfpk_nation_region#9373,cval_nation_n_name#9374,cval_nation_n_comment#9375,cdepval_nation_n_name#9376,cdepval_nation_n_comment#9377,cn_name#9378,cn_comment#9379] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 58617ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/26 21:58:30 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:58:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9493L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 21:58:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9493L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#9495 AS rid_0#9519, cpfk_customer_orders#9496 AS cpfk_customer_orders_0#9520, cfpk_orders_customer#9497 AS cfpk_orders_customer_0#9521, cval_orders_o_orderstatus#9498 AS cval_orders_o_orderstatus_0#9522, cval_orders_o_totalprice#9499 AS cval_orders_o_totalprice_0#9523, cval_orders_o_orderpriority#9500 AS cval_orders_o_orderpriority_0#9524, cval_orders_o_clerk#9501 AS cval_orders_o_clerk_0#9525, cval_orders_o_shippriority#9502 AS cval_orders_o_shippriority_0#9526, cval_orders_o_comment#9503 AS cval_orders_o_comment_0#9527, cval_orders_o_orderdate#9504 AS cval_orders_o_orderdate_0#9528, cdepval_orders_o_orderstatus#9505 AS cdepval_orders_o_orderstatus_0#9529, cdepval_orders_o_totalprice#9506 AS cdepval_orders_o_totalprice_0#9530, cdepval_orders_o_orderpriority#9507 AS cdepval_orders_o_orderpriority_0#9531, cdepval_orders_o_clerk#9508 AS cdepval_orders_o_clerk_0#9532, cdepval_orders_o_shippriority#9509 AS cdepval_orders_o_shippriority_0#9533, cdepval_orders_o_comment#9510 AS cdepval_orders_o_comment_0#9534, cdepval_orders_o_orderdate#9511 AS cdepval_orders_o_orderdate_0#9535, co_orderstatus#9512 AS co_orderstatus_0#9536, co_totalprice#9513 AS co_totalprice_0#9537, co_orderpriority#9514 AS co_orderpriority_0#9538, co_clerk#9515 AS co_clerk_0#9539, co_shippriority#9516 AS co_shippriority_0#9540, co_comment#9517 AS co_comment_0#9541, co_orderdate#9518 AS co_orderdate_0#9542]
         :  +- Relation[rid#9495,cpfk_customer_orders#9496,cfpk_orders_customer#9497,cval_orders_o_orderstatus#9498,cval_orders_o_totalprice#9499,cval_orders_o_orderpriority#9500,cval_orders_o_clerk#9501,cval_orders_o_shippriority#9502,cval_orders_o_comment#9503,cval_orders_o_orderdate#9504,cdepval_orders_o_orderstatus#9505,cdepval_orders_o_totalprice#9506,cdepval_orders_o_orderpriority#9507,cdepval_orders_o_clerk#9508,cdepval_orders_o_shippriority#9509,cdepval_orders_o_comment#9510,cdepval_orders_o_orderdate#9511,co_orderstatus#9512,co_totalprice#9513,co_orderpriority#9514,co_clerk#9515,co_shippriority#9516,co_comment#9517,co_orderdate#9518] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#9543 AS rid_1#9564, cpfk_nation_customer#9544 AS cpfk_nation_customer_1#9565, cfpk_customer_nation#9545 AS cfpk_customer_nation_1#9566, cval_customer_c_name#9546 AS cval_customer_c_name_1#9567, cval_customer_c_address#9547 AS cval_customer_c_address_1#9568, cval_customer_c_phone#9548 AS cval_customer_c_phone_1#9569, cval_customer_c_acctbal#9549 AS cval_customer_c_acctbal_1#9570, cval_customer_c_comment#9550 AS cval_customer_c_comment_1#9571, cval_customer_c_mktsegment#9551 AS cval_customer_c_mktsegment_1#9572, cdepval_customer_c_name#9552 AS cdepval_customer_c_name_1#9573, cdepval_customer_c_address#9553 AS cdepval_customer_c_address_1#9574, cdepval_customer_c_phone#9554 AS cdepval_customer_c_phone_1#9575, cdepval_customer_c_acctbal#9555 AS cdepval_customer_c_acctbal_1#9576, cdepval_customer_c_comment#9556 AS cdepval_customer_c_comment_1#9577, cdepval_customer_c_mktsegment#9557 AS cdepval_customer_c_mktsegment_1#9578, cc_name#9558 AS cc_name_1#9579, cc_address#9559 AS cc_address_1#9580, cc_phone#9560 AS cc_phone_1#9581, cc_acctbal#9561 AS cc_acctbal_1#9582, cc_comment#9562 AS cc_comment_1#9583, cc_mktsegment#9563 AS cc_mktsegment_1#9584]
            +- Relation[rid#9543,cpfk_nation_customer#9544,cfpk_customer_nation#9545,cval_customer_c_name#9546,cval_customer_c_address#9547,cval_customer_c_phone#9548,cval_customer_c_acctbal#9549,cval_customer_c_comment#9550,cval_customer_c_mktsegment#9551,cdepval_customer_c_name#9552,cdepval_customer_c_address#9553,cdepval_customer_c_phone#9554,cdepval_customer_c_acctbal#9555,cdepval_customer_c_comment#9556,cdepval_customer_c_mktsegment#9557,cc_name#9558,cc_address#9559,cc_phone#9560,cc_acctbal#9561,cc_comment#9562,cc_mktsegment#9563] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4513ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/26 21:58:34 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:58:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9636L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:58:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9636L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#9688 AS rid_1#9733, cpfk_orders_lineitem#9689 AS cpfk_orders_lineitem_1#9734, cpfk_supplier_lineitem#9690 AS cpfk_supplier_lineitem_1#9735, cfpk_lineitem_supplier#9691 AS cfpk_lineitem_supplier_1#9736, cfpk_lineitem_partsupp#9692 AS cfpk_lineitem_partsupp_1#9737, cpfk_part_lineitem#9693 AS cpfk_part_lineitem_1#9738, cfpk_lineitem_part#9694 AS cfpk_lineitem_part_1#9739, cpfk_partsupp_lineitem#9695 AS cpfk_partsupp_lineitem_1#9740, cfpk_lineitem_orders#9696 AS cfpk_lineitem_orders_1#9741, cval_lineitem_l_quantity#9697 AS cval_lineitem_l_quantity_1#9742, cval_lineitem_l_extendedprice#9698 AS cval_lineitem_l_extendedprice_1#9743, cval_lineitem_l_discount#9699 AS cval_lineitem_l_discount_1#9744, cval_lineitem_l_tax#9700 AS cval_lineitem_l_tax_1#9745, cval_lineitem_l_returnflag#9701 AS cval_lineitem_l_returnflag_1#9746, cval_lineitem_l_linestatus#9702 AS cval_lineitem_l_linestatus_1#9747, cval_lineitem_l_commitdate#9703 AS cval_lineitem_l_commitdate_1#9748, cval_lineitem_l_receiptdate#9704 AS cval_lineitem_l_receiptdate_1#9749, cval_lineitem_l_shipinstruct#9705 AS cval_lineitem_l_shipinstruct_1#9750, cval_lineitem_l_shipmode#9706 AS cval_lineitem_l_shipmode_1#9751, cval_lineitem_l_comment#9707 AS cval_lineitem_l_comment_1#9752, cval_lineitem_l_shipdate#9708 AS cval_lineitem_l_shipdate_1#9753, cdepval_lineitem_l_quantity#9709 AS cdepval_lineitem_l_quantity_1#9754, cdepval_lineitem_l_extendedprice#9710 AS cdepval_lineitem_l_extendedprice_1#9755, cdepval_lineitem_l_discount#9711 AS cdepval_lineitem_l_discount_1#9756, ... 21 more fields]
         :  +- Relation[rid#9688,cpfk_orders_lineitem#9689,cpfk_supplier_lineitem#9690,cfpk_lineitem_supplier#9691,cfpk_lineitem_partsupp#9692,cpfk_part_lineitem#9693,cfpk_lineitem_part#9694,cpfk_partsupp_lineitem#9695,cfpk_lineitem_orders#9696,cval_lineitem_l_quantity#9697,cval_lineitem_l_extendedprice#9698,cval_lineitem_l_discount#9699,cval_lineitem_l_tax#9700,cval_lineitem_l_returnflag#9701,cval_lineitem_l_linestatus#9702,cval_lineitem_l_commitdate#9703,cval_lineitem_l_receiptdate#9704,cval_lineitem_l_shipinstruct#9705,cval_lineitem_l_shipmode#9706,cval_lineitem_l_comment#9707,cval_lineitem_l_shipdate#9708,cdepval_lineitem_l_quantity#9709,cdepval_lineitem_l_extendedprice#9710,cdepval_lineitem_l_discount#9711,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#9638 AS rid_0#9663, cval_part_p_name#9639 AS cval_part_p_name_0#9664, cval_part_p_mfgr#9640 AS cval_part_p_mfgr_0#9665, cval_part_p_type#9641 AS cval_part_p_type_0#9666, cval_part_p_size#9642 AS cval_part_p_size_0#9667, cval_part_p_container#9643 AS cval_part_p_container_0#9668, cval_part_p_retailprice#9644 AS cval_part_p_retailprice_0#9669, cval_part_p_comment#9645 AS cval_part_p_comment_0#9670, cval_part_p_brand#9646 AS cval_part_p_brand_0#9671, cdepval_part_p_name#9647 AS cdepval_part_p_name_0#9672, cdepval_part_p_mfgr#9648 AS cdepval_part_p_mfgr_0#9673, cdepval_part_p_type#9649 AS cdepval_part_p_type_0#9674, cdepval_part_p_size#9650 AS cdepval_part_p_size_0#9675, cdepval_part_p_container#9651 AS cdepval_part_p_container_0#9676, cdepval_part_p_retailprice#9652 AS cdepval_part_p_retailprice_0#9677, cdepval_part_p_comment#9653 AS cdepval_part_p_comment_0#9678, cdepval_part_p_brand#9654 AS cdepval_part_p_brand_0#9679, cp_name#9655 AS cp_name_0#9680, cp_mfgr#9656 AS cp_mfgr_0#9681, cp_type#9657 AS cp_type_0#9682, cp_size#9658 AS cp_size_0#9683, cp_container#9659 AS cp_container_0#9684, cp_retailprice#9660 AS cp_retailprice_0#9685, cp_comment#9661 AS cp_comment_0#9686, cp_brand#9662 AS cp_brand_0#9687]
            +- Relation[rid#9638,cval_part_p_name#9639,cval_part_p_mfgr#9640,cval_part_p_type#9641,cval_part_p_size#9642,cval_part_p_container#9643,cval_part_p_retailprice#9644,cval_part_p_comment#9645,cval_part_p_brand#9646,cdepval_part_p_name#9647,cdepval_part_p_mfgr#9648,cdepval_part_p_type#9649,cdepval_part_p_size#9650,cdepval_part_p_container#9651,cdepval_part_p_retailprice#9652,cdepval_part_p_comment#9653,cdepval_part_p_brand#9654,cp_name#9655,cp_mfgr#9656,cp_type#9657,cp_size#9658,cp_container#9659,cp_retailprice#9660,cp_comment#9661,cp_brand#9662] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17907ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/26 21:58:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:58:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9852L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 21:58:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:58:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:58:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:58:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:58:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:58:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:58:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:58:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:58:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:58:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:58:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:58:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:58:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:58:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:58:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:58:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:58:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9852L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#9993, cval_part_p_name_3#9994, cval_part_p_mfgr_3#9995, cval_part_p_type_3#9996, cval_part_p_size_3#9997, cval_part_p_container_3#9998, cval_part_p_retailprice_3#9999, cval_part_p_comment_3#10000, cval_part_p_brand_3#10001, cdepval_part_p_name_3#10002, cdepval_part_p_mfgr_3#10003, cdepval_part_p_type_3#10004, cdepval_part_p_size_3#10005, cdepval_part_p_container_3#10006, cdepval_part_p_retailprice_3#10007, cdepval_part_p_comment_3#10008, cdepval_part_p_brand_3#10009, cp_name_3#10010, cp_mfgr_3#10011, cp_type_3#10012, cp_size_3#10013, cp_container_3#10014, cp_retailprice_3#10015, cp_comment_3#10016, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :  :  :  +- Project [rid#9968 AS rid_3#9993, cval_part_p_name#9969 AS cval_part_p_name_3#9994, cval_part_p_mfgr#9970 AS cval_part_p_mfgr_3#9995, cval_part_p_type#9971 AS cval_part_p_type_3#9996, cval_part_p_size#9972 AS cval_part_p_size_3#9997, cval_part_p_container#9973 AS cval_part_p_container_3#9998, cval_part_p_retailprice#9974 AS cval_part_p_retailprice_3#9999, cval_part_p_comment#9975 AS cval_part_p_comment_3#10000, cval_part_p_brand#9976 AS cval_part_p_brand_3#10001, cdepval_part_p_name#9977 AS cdepval_part_p_name_3#10002, cdepval_part_p_mfgr#9978 AS cdepval_part_p_mfgr_3#10003, cdepval_part_p_type#9979 AS cdepval_part_p_type_3#10004, cdepval_part_p_size#9980 AS cdepval_part_p_size_3#10005, cdepval_part_p_container#9981 AS cdepval_part_p_container_3#10006, cdepval_part_p_retailprice#9982 AS cdepval_part_p_retailprice_3#10007, cdepval_part_p_comment#9983 AS cdepval_part_p_comment_3#10008, cdepval_part_p_brand#9984 AS cdepval_part_p_brand_3#10009, cp_name#9985 AS cp_name_3#10010, cp_mfgr#9986 AS cp_mfgr_3#10011, cp_type#9987 AS cp_type_3#10012, cp_size#9988 AS cp_size_3#10013, cp_container#9989 AS cp_container_3#10014, cp_retailprice#9990 AS cp_retailprice_3#10015, cp_comment#9991 AS cp_comment_3#10016, cp_brand#9992 AS cp_brand_3#10017]
         :  :  :     +- Relation[rid#9968,cval_part_p_name#9969,cval_part_p_mfgr#9970,cval_part_p_type#9971,cval_part_p_size#9972,cval_part_p_container#9973,cval_part_p_retailprice#9974,cval_part_p_comment#9975,cval_part_p_brand#9976,cdepval_part_p_name#9977,cdepval_part_p_mfgr#9978,cdepval_part_p_type#9979,cdepval_part_p_size#9980,cdepval_part_p_container#9981,cdepval_part_p_retailprice#9982,cdepval_part_p_comment#9983,cdepval_part_p_brand#9984,cp_name#9985,cp_mfgr#9986,cp_type#9987,cp_size#9988,cp_container#9989,cp_retailprice#9990,cp_comment#9991,cp_brand#9992] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_4, 'rid_4]
         :  :     +- Project [rid#10146 AS rid_4#10160, cpfk_part_partsupp#10147 AS cpfk_part_partsupp_4#10161, cfpk_partsupp_part#10148 AS cfpk_partsupp_part_4#10162, cpfk_supplier_partsupp#10149 AS cpfk_supplier_partsupp_4#10163, cfpk_partsupp_supplier#10150 AS cfpk_partsupp_supplier_4#10164, cval_partsupp_ps_availqty#10151 AS cval_partsupp_ps_availqty_4#10165, cval_partsupp_ps_supplycost#10152 AS cval_partsupp_ps_supplycost_4#10166, cval_partsupp_ps_comment#10153 AS cval_partsupp_ps_comment_4#10167, cdepval_partsupp_ps_availqty#10154 AS cdepval_partsupp_ps_availqty_4#10168, cdepval_partsupp_ps_supplycost#10155 AS cdepval_partsupp_ps_supplycost_4#10169, cdepval_partsupp_ps_comment#10156 AS cdepval_partsupp_ps_comment_4#10170, cps_availqty#10157 AS cps_availqty_4#10171, cps_supplycost#10158 AS cps_supplycost_4#10172, cps_comment#10159 AS cps_comment_4#10173]
         :  :        +- Relation[rid#10146,cpfk_part_partsupp#10147,cfpk_partsupp_part#10148,cpfk_supplier_partsupp#10149,cfpk_partsupp_supplier#10150,cval_partsupp_ps_availqty#10151,cval_partsupp_ps_supplycost#10152,cval_partsupp_ps_comment#10153,cdepval_partsupp_ps_availqty#10154,cdepval_partsupp_ps_supplycost#10155,cdepval_partsupp_ps_comment#10156,cps_availqty#10157,cps_supplycost#10158,cps_comment#10159] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#10068 AS rid_4#10082, cpfk_part_partsupp#10069 AS cpfk_part_partsupp_4#10083, cfpk_partsupp_part#10070 AS cfpk_partsupp_part_4#10084, cpfk_supplier_partsupp#10071 AS cpfk_supplier_partsupp_4#10085, cfpk_partsupp_supplier#10072 AS cfpk_partsupp_supplier_4#10086, cval_partsupp_ps_availqty#10073 AS cval_partsupp_ps_availqty_4#10087, cval_partsupp_ps_supplycost#10074 AS cval_partsupp_ps_supplycost_4#10088, cval_partsupp_ps_comment#10075 AS cval_partsupp_ps_comment_4#10089, cdepval_partsupp_ps_availqty#10076 AS cdepval_partsupp_ps_availqty_4#10090, cdepval_partsupp_ps_supplycost#10077 AS cdepval_partsupp_ps_supplycost_4#10091, cdepval_partsupp_ps_comment#10078 AS cdepval_partsupp_ps_comment_4#10092, cps_availqty#10079 AS cps_availqty_4#10093, cps_supplycost#10080 AS cps_supplycost_4#10094, cps_comment#10081 AS cps_comment_4#10095]
         :     +- Relation[rid#10068,cpfk_part_partsupp#10069,cfpk_partsupp_part#10070,cpfk_supplier_partsupp#10071,cfpk_partsupp_supplier#10072,cval_partsupp_ps_availqty#10073,cval_partsupp_ps_supplycost#10074,cval_partsupp_ps_comment#10075,cdepval_partsupp_ps_availqty#10076,cdepval_partsupp_ps_supplycost#10077,cdepval_partsupp_ps_comment#10078,cps_availqty#10079,cps_supplycost#10080,cps_comment#10081] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#9932 AS rid_2#9950, cpfk_nation_supplier#9933 AS cpfk_nation_supplier_2#9951, cfpk_supplier_nation#9934 AS cfpk_supplier_nation_2#9952, cval_supplier_s_name#9935 AS cval_supplier_s_name_2#9953, cval_supplier_s_address#9936 AS cval_supplier_s_address_2#9954, cval_supplier_s_phone#9937 AS cval_supplier_s_phone_2#9955, cval_supplier_s_acctbal#9938 AS cval_supplier_s_acctbal_2#9956, cval_supplier_s_comment#9939 AS cval_supplier_s_comment_2#9957, cdepval_supplier_s_name#9940 AS cdepval_supplier_s_name_2#9958, cdepval_supplier_s_address#9941 AS cdepval_supplier_s_address_2#9959, cdepval_supplier_s_phone#9942 AS cdepval_supplier_s_phone_2#9960, cdepval_supplier_s_acctbal#9943 AS cdepval_supplier_s_acctbal_2#9961, cdepval_supplier_s_comment#9944 AS cdepval_supplier_s_comment_2#9962, cs_name#9945 AS cs_name_2#9963, cs_address#9946 AS cs_address_2#9964, cs_phone#9947 AS cs_phone_2#9965, cs_acctbal#9948 AS cs_acctbal_2#9966, cs_comment#9949 AS cs_comment_2#9967]
            :  +- Relation[rid#9932,cpfk_nation_supplier#9933,cfpk_supplier_nation#9934,cval_supplier_s_name#9935,cval_supplier_s_address#9936,cval_supplier_s_phone#9937,cval_supplier_s_acctbal#9938,cval_supplier_s_comment#9939,cdepval_supplier_s_name#9940,cdepval_supplier_s_address#9941,cdepval_supplier_s_phone#9942,cdepval_supplier_s_acctbal#9943,cdepval_supplier_s_comment#9944,cs_name#9945,cs_address#9946,cs_phone#9947,cs_acctbal#9948,cs_comment#9949] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_1))
               :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#9861, cval_region_r_name_0#9862, cval_region_r_comment_0#9863, cdepval_region_r_name_0#9864, cdepval_region_r_comment_0#9865, cr_name_0#9866, cr_comment_0#9867, 'rid_1]
               :  :- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
               :  :  +- Project [rid#9854 AS rid_0#9861, cval_region_r_name#9855 AS cval_region_r_name_0#9862, cval_region_r_comment#9856 AS cval_region_r_comment_0#9863, cdepval_region_r_name#9857 AS cdepval_region_r_name_0#9864, cdepval_region_r_comment#9858 AS cdepval_region_r_comment_0#9865, cr_name#9859 AS cr_name_0#9866, cr_comment#9860 AS cr_comment_0#9867]
               :  :     +- Relation[rid#9854,cval_region_r_name#9855,cval_region_r_comment#9856,cdepval_region_r_name#9857,cdepval_region_r_comment#9858,cr_name#9859,cr_comment#9860] JDBCRelation(tregion) [numPartitions=1]
               :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
               :     +- Project [rid#9914 AS rid_1#9923, cpfk_region_nation#9915 AS cpfk_region_nation_1#9924, cfpk_nation_region#9916 AS cfpk_nation_region_1#9925, cval_nation_n_name#9917 AS cval_nation_n_name_1#9926, cval_nation_n_comment#9918 AS cval_nation_n_comment_1#9927, cdepval_nation_n_name#9919 AS cdepval_nation_n_name_1#9928, cdepval_nation_n_comment#9920 AS cdepval_nation_n_comment_1#9929, cn_name#9921 AS cn_name_1#9930, cn_comment#9922 AS cn_comment_1#9931]
               :        +- Relation[rid#9914,cpfk_region_nation#9915,cfpk_nation_region#9916,cval_nation_n_name#9917,cval_nation_n_comment#9918,cdepval_nation_n_name#9919,cdepval_nation_n_comment#9920,cn_name#9921,cn_comment#9922] JDBCRelation(tnation) [numPartitions=1]
               +- Project [rid#9882 AS rid_1#9891, cpfk_region_nation#9883 AS cpfk_region_nation_1#9892, cfpk_nation_region#9884 AS cfpk_nation_region_1#9893, cval_nation_n_name#9885 AS cval_nation_n_name_1#9894, cval_nation_n_comment#9886 AS cval_nation_n_comment_1#9895, cdepval_nation_n_name#9887 AS cdepval_nation_n_name_1#9896, cdepval_nation_n_comment#9888 AS cdepval_nation_n_comment_1#9897, cn_name#9889 AS cn_name_1#9898, cn_comment#9890 AS cn_comment_1#9899]
                  +- Relation[rid#9882,cpfk_region_nation#9883,cfpk_nation_region#9884,cval_nation_n_name#9885,cval_nation_n_comment#9886,cdepval_nation_n_name#9887,cdepval_nation_n_comment#9888,cn_name#9889,cn_comment#9890] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 914ms
query=q1, count=6001215, duration=2394
query=q10, count=1478870, duration=58617
query=q11, count=31680, duration=2420
query=q12, count=857401, duration=21699
query=q13, count=1500000, duration=4402
query=q14, count=6001215, duration=17907
query=q15, count=6001215, duration=17178
query=q16, count=15780, duration=632
query=q17, count=6088, duration=501
query=q18, count=6001215, duration=22167
query=q19, count=205, duration=16583
query=q2, count=3162, duration=914
query=q20, count=632, duration=821
query=q21a, count=597422, duration=160145
query=q22, count=1500000, duration=4513
query=q3, count=1214743, duration=23962
query=q4, count=6001215, duration=19033
query=q5, count=48089, duration=29595
query=q6, count=6001215, duration=2358
query=q7, count=9735, duration=40814
query=q8, count=8716, duration=3330
query=q9a, count=6001215, duration=62942
query=q9b, count=6001215, duration=37594
