20/04/26 22:37:25 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 11710ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sun Apr 26 22:37:29 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sun Apr 26 22:37:30 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sun Apr 26 22:37:30 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sun Apr 26 22:37:30 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sun Apr 26 22:37:30 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sun Apr 26 22:37:35 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sun Apr 26 22:37:39 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sun Apr 26 22:37:39 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/26 22:37:40 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:37:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2082L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:37:40 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:37:41 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:37:41 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:37:41 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:37:41 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:37:41 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/26 22:37:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2082L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#2306 AS rid_2#2351, cpfk_orders_lineitem#2307 AS cpfk_orders_lineitem_2#2352, cpfk_supplier_lineitem#2308 AS cpfk_supplier_lineitem_2#2353, cfpk_lineitem_supplier#2309 AS cfpk_lineitem_supplier_2#2354, cfpk_lineitem_partsupp#2310 AS cfpk_lineitem_partsupp_2#2355, cpfk_part_lineitem#2311 AS cpfk_part_lineitem_2#2356, cfpk_lineitem_part#2312 AS cfpk_lineitem_part_2#2357, cpfk_partsupp_lineitem#2313 AS cpfk_partsupp_lineitem_2#2358, cfpk_lineitem_orders#2314 AS cfpk_lineitem_orders_2#2359, cval_lineitem_l_quantity#2315 AS cval_lineitem_l_quantity_2#2360, cval_lineitem_l_extendedprice#2316 AS cval_lineitem_l_extendedprice_2#2361, cval_lineitem_l_discount#2317 AS cval_lineitem_l_discount_2#2362, cval_lineitem_l_tax#2318 AS cval_lineitem_l_tax_2#2363, cval_lineitem_l_returnflag#2319 AS cval_lineitem_l_returnflag_2#2364, cval_lineitem_l_linestatus#2320 AS cval_lineitem_l_linestatus_2#2365, cval_lineitem_l_commitdate#2321 AS cval_lineitem_l_commitdate_2#2366, cval_lineitem_l_receiptdate#2322 AS cval_lineitem_l_receiptdate_2#2367, cval_lineitem_l_shipinstruct#2323 AS cval_lineitem_l_shipinstruct_2#2368, cval_lineitem_l_shipmode#2324 AS cval_lineitem_l_shipmode_2#2369, cval_lineitem_l_comment#2325 AS cval_lineitem_l_comment_2#2370, cval_lineitem_l_shipdate#2326 AS cval_lineitem_l_shipdate_2#2371, cdepval_lineitem_l_quantity#2327 AS cdepval_lineitem_l_quantity_2#2372, cdepval_lineitem_l_extendedprice#2328 AS cdepval_lineitem_l_extendedprice_2#2373, cdepval_lineitem_l_discount#2329 AS cdepval_lineitem_l_discount_2#2374, ... 21 more fields]
         :  +- Relation[rid#2306,cpfk_orders_lineitem#2307,cpfk_supplier_lineitem#2308,cfpk_lineitem_supplier#2309,cfpk_lineitem_partsupp#2310,cpfk_part_lineitem#2311,cfpk_lineitem_part#2312,cpfk_partsupp_lineitem#2313,cfpk_lineitem_orders#2314,cval_lineitem_l_quantity#2315,cval_lineitem_l_extendedprice#2316,cval_lineitem_l_discount#2317,cval_lineitem_l_tax#2318,cval_lineitem_l_returnflag#2319,cval_lineitem_l_linestatus#2320,cval_lineitem_l_commitdate#2321,cval_lineitem_l_receiptdate#2322,cval_lineitem_l_shipinstruct#2323,cval_lineitem_l_shipmode#2324,cval_lineitem_l_comment#2325,cval_lineitem_l_shipdate#2326,cdepval_lineitem_l_quantity#2327,cdepval_lineitem_l_extendedprice#2328,cdepval_lineitem_l_discount#2329,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin customer~orders, 'cpfk_customer_orders_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#2105, cpfk_nation_customer_0#2106, cfpk_customer_nation_0#2107, cval_customer_c_name_0#2108, cval_customer_c_address_0#2109, cval_customer_c_phone_0#2110, cval_customer_c_acctbal_0#2111, cval_customer_c_comment_0#2112, cval_customer_c_mktsegment_0#2113, cdepval_customer_c_name_0#2114, cdepval_customer_c_address_0#2115, cdepval_customer_c_phone_0#2116, cdepval_customer_c_acctbal_0#2117, cdepval_customer_c_comment_0#2118, cdepval_customer_c_mktsegment_0#2119, cc_name_0#2120, cc_address_0#2121, cc_phone_0#2122, cc_acctbal_0#2123, cc_comment_0#2124, cc_mktsegment_0#2125, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
            :  :  +- Project [rid#2084 AS rid_0#2105, cpfk_nation_customer#2085 AS cpfk_nation_customer_0#2106, cfpk_customer_nation#2086 AS cfpk_customer_nation_0#2107, cval_customer_c_name#2087 AS cval_customer_c_name_0#2108, cval_customer_c_address#2088 AS cval_customer_c_address_0#2109, cval_customer_c_phone#2089 AS cval_customer_c_phone_0#2110, cval_customer_c_acctbal#2090 AS cval_customer_c_acctbal_0#2111, cval_customer_c_comment#2091 AS cval_customer_c_comment_0#2112, cval_customer_c_mktsegment#2092 AS cval_customer_c_mktsegment_0#2113, cdepval_customer_c_name#2093 AS cdepval_customer_c_name_0#2114, cdepval_customer_c_address#2094 AS cdepval_customer_c_address_0#2115, cdepval_customer_c_phone#2095 AS cdepval_customer_c_phone_0#2116, cdepval_customer_c_acctbal#2096 AS cdepval_customer_c_acctbal_0#2117, cdepval_customer_c_comment#2097 AS cdepval_customer_c_comment_0#2118, cdepval_customer_c_mktsegment#2098 AS cdepval_customer_c_mktsegment_0#2119, cc_name#2099 AS cc_name_0#2120, cc_address#2100 AS cc_address_0#2121, cc_phone#2101 AS cc_phone_0#2122, cc_acctbal#2102 AS cc_acctbal_0#2123, cc_comment#2103 AS cc_comment_0#2124, cc_mktsegment#2104 AS cc_mktsegment_0#2125]
            :  :     +- Relation[rid#2084,cpfk_nation_customer#2085,cfpk_customer_nation#2086,cval_customer_c_name#2087,cval_customer_c_address#2088,cval_customer_c_phone#2089,cval_customer_c_acctbal#2090,cval_customer_c_comment#2091,cval_customer_c_mktsegment#2092,cdepval_customer_c_name#2093,cdepval_customer_c_address#2094,cdepval_customer_c_phone#2095,cdepval_customer_c_acctbal#2096,cdepval_customer_c_comment#2097,cdepval_customer_c_mktsegment#2098,cc_name#2099,cc_address#2100,cc_phone#2101,cc_acctbal#2102,cc_comment#2103,cc_mktsegment#2104] JDBCRelation(tcustomer) [numPartitions=1]
            :  +- 'Project ['cpfk_customer_orders_1, 'rid_1]
            :     +- Project [rid#2258 AS rid_1#2282, cpfk_customer_orders#2259 AS cpfk_customer_orders_1#2283, cfpk_orders_customer#2260 AS cfpk_orders_customer_1#2284, cval_orders_o_orderstatus#2261 AS cval_orders_o_orderstatus_1#2285, cval_orders_o_totalprice#2262 AS cval_orders_o_totalprice_1#2286, cval_orders_o_orderpriority#2263 AS cval_orders_o_orderpriority_1#2287, cval_orders_o_clerk#2264 AS cval_orders_o_clerk_1#2288, cval_orders_o_shippriority#2265 AS cval_orders_o_shippriority_1#2289, cval_orders_o_comment#2266 AS cval_orders_o_comment_1#2290, cval_orders_o_orderdate#2267 AS cval_orders_o_orderdate_1#2291, cdepval_orders_o_orderstatus#2268 AS cdepval_orders_o_orderstatus_1#2292, cdepval_orders_o_totalprice#2269 AS cdepval_orders_o_totalprice_1#2293, cdepval_orders_o_orderpriority#2270 AS cdepval_orders_o_orderpriority_1#2294, cdepval_orders_o_clerk#2271 AS cdepval_orders_o_clerk_1#2295, cdepval_orders_o_shippriority#2272 AS cdepval_orders_o_shippriority_1#2296, cdepval_orders_o_comment#2273 AS cdepval_orders_o_comment_1#2297, cdepval_orders_o_orderdate#2274 AS cdepval_orders_o_orderdate_1#2298, co_orderstatus#2275 AS co_orderstatus_1#2299, co_totalprice#2276 AS co_totalprice_1#2300, co_orderpriority#2277 AS co_orderpriority_1#2301, co_clerk#2278 AS co_clerk_1#2302, co_shippriority#2279 AS co_shippriority_1#2303, co_comment#2280 AS co_comment_1#2304, co_orderdate#2281 AS co_orderdate_1#2305]
            :        +- Relation[rid#2258,cpfk_customer_orders#2259,cfpk_orders_customer#2260,cval_orders_o_orderstatus#2261,cval_orders_o_totalprice#2262,cval_orders_o_orderpriority#2263,cval_orders_o_clerk#2264,cval_orders_o_shippriority#2265,cval_orders_o_comment#2266,cval_orders_o_orderdate#2267,cdepval_orders_o_orderstatus#2268,cdepval_orders_o_totalprice#2269,cdepval_orders_o_orderpriority#2270,cdepval_orders_o_clerk#2271,cdepval_orders_o_shippriority#2272,cdepval_orders_o_comment#2273,cdepval_orders_o_orderdate#2274,co_orderstatus#2275,co_totalprice#2276,co_orderpriority#2277,co_clerk#2278,co_shippriority#2279,co_comment#2280,co_orderdate#2281] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#2168 AS rid_1#2192, cpfk_customer_orders#2169 AS cpfk_customer_orders_1#2193, cfpk_orders_customer#2170 AS cfpk_orders_customer_1#2194, cval_orders_o_orderstatus#2171 AS cval_orders_o_orderstatus_1#2195, cval_orders_o_totalprice#2172 AS cval_orders_o_totalprice_1#2196, cval_orders_o_orderpriority#2173 AS cval_orders_o_orderpriority_1#2197, cval_orders_o_clerk#2174 AS cval_orders_o_clerk_1#2198, cval_orders_o_shippriority#2175 AS cval_orders_o_shippriority_1#2199, cval_orders_o_comment#2176 AS cval_orders_o_comment_1#2200, cval_orders_o_orderdate#2177 AS cval_orders_o_orderdate_1#2201, cdepval_orders_o_orderstatus#2178 AS cdepval_orders_o_orderstatus_1#2202, cdepval_orders_o_totalprice#2179 AS cdepval_orders_o_totalprice_1#2203, cdepval_orders_o_orderpriority#2180 AS cdepval_orders_o_orderpriority_1#2204, cdepval_orders_o_clerk#2181 AS cdepval_orders_o_clerk_1#2205, cdepval_orders_o_shippriority#2182 AS cdepval_orders_o_shippriority_1#2206, cdepval_orders_o_comment#2183 AS cdepval_orders_o_comment_1#2207, cdepval_orders_o_orderdate#2184 AS cdepval_orders_o_orderdate_1#2208, co_orderstatus#2185 AS co_orderstatus_1#2209, co_totalprice#2186 AS co_totalprice_1#2210, co_orderpriority#2187 AS co_orderpriority_1#2211, co_clerk#2188 AS co_clerk_1#2212, co_shippriority#2189 AS co_shippriority_1#2213, co_comment#2190 AS co_comment_1#2214, co_orderdate#2191 AS co_orderdate_1#2215]
               +- Relation[rid#2168,cpfk_customer_orders#2169,cfpk_orders_customer#2170,cval_orders_o_orderstatus#2171,cval_orders_o_totalprice#2172,cval_orders_o_orderpriority#2173,cval_orders_o_clerk#2174,cval_orders_o_shippriority#2175,cval_orders_o_comment#2176,cval_orders_o_orderdate#2177,cdepval_orders_o_orderstatus#2178,cdepval_orders_o_totalprice#2179,cdepval_orders_o_orderpriority#2180,cdepval_orders_o_clerk#2181,cdepval_orders_o_shippriority#2182,cdepval_orders_o_comment#2183,cdepval_orders_o_orderdate#2184,co_orderstatus#2185,co_totalprice#2186,co_orderpriority#2187,co_clerk#2188,co_shippriority#2189,co_comment#2190,co_orderdate#2191] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 26356ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/26 22:38:07 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:38:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2492L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 22:38:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:38:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:38:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:38:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:38:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:38:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:38:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:38:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:38:07 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:38:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:38:07 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:38:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2492L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#2620 AS rid_2#2634, cpfk_part_partsupp#2621 AS cpfk_part_partsupp_2#2635, cfpk_partsupp_part#2622 AS cfpk_partsupp_part_2#2636, cpfk_supplier_partsupp#2623 AS cpfk_supplier_partsupp_2#2637, cfpk_partsupp_supplier#2624 AS cfpk_partsupp_supplier_2#2638, cval_partsupp_ps_availqty#2625 AS cval_partsupp_ps_availqty_2#2639, cval_partsupp_ps_supplycost#2626 AS cval_partsupp_ps_supplycost_2#2640, cval_partsupp_ps_comment#2627 AS cval_partsupp_ps_comment_2#2641, cdepval_partsupp_ps_availqty#2628 AS cdepval_partsupp_ps_availqty_2#2642, cdepval_partsupp_ps_supplycost#2629 AS cdepval_partsupp_ps_supplycost_2#2643, cdepval_partsupp_ps_comment#2630 AS cdepval_partsupp_ps_comment_2#2644, cps_availqty#2631 AS cps_availqty_2#2645, cps_supplycost#2632 AS cps_supplycost_2#2646, cps_comment#2633 AS cps_comment_2#2647]
         :  +- Relation[rid#2620,cpfk_part_partsupp#2621,cfpk_partsupp_part#2622,cpfk_supplier_partsupp#2623,cfpk_partsupp_supplier#2624,cval_partsupp_ps_availqty#2625,cval_partsupp_ps_supplycost#2626,cval_partsupp_ps_comment#2627,cdepval_partsupp_ps_availqty#2628,cdepval_partsupp_ps_supplycost#2629,cdepval_partsupp_ps_comment#2630,cps_availqty#2631,cps_supplycost#2632,cps_comment#2633] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#2503, cpfk_region_nation_0#2504, cfpk_nation_region_0#2505, cval_nation_n_name_0#2506, cval_nation_n_comment_0#2507, cdepval_nation_n_name_0#2508, cdepval_nation_n_comment_0#2509, cn_name_0#2510, cn_comment_0#2511, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
            :  :  +- Project [rid#2494 AS rid_0#2503, cpfk_region_nation#2495 AS cpfk_region_nation_0#2504, cfpk_nation_region#2496 AS cfpk_nation_region_0#2505, cval_nation_n_name#2497 AS cval_nation_n_name_0#2506, cval_nation_n_comment#2498 AS cval_nation_n_comment_0#2507, cdepval_nation_n_name#2499 AS cdepval_nation_n_name_0#2508, cdepval_nation_n_comment#2500 AS cdepval_nation_n_comment_0#2509, cn_name#2501 AS cn_name_0#2510, cn_comment#2502 AS cn_comment_0#2511]
            :  :     +- Relation[rid#2494,cpfk_region_nation#2495,cfpk_nation_region#2496,cval_nation_n_name#2497,cval_nation_n_comment#2498,cdepval_nation_n_name#2499,cdepval_nation_n_comment#2500,cn_name#2501,cn_comment#2502] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
            :     +- Project [rid#2584 AS rid_1#2602, cpfk_nation_supplier#2585 AS cpfk_nation_supplier_1#2603, cfpk_supplier_nation#2586 AS cfpk_supplier_nation_1#2604, cval_supplier_s_name#2587 AS cval_supplier_s_name_1#2605, cval_supplier_s_address#2588 AS cval_supplier_s_address_1#2606, cval_supplier_s_phone#2589 AS cval_supplier_s_phone_1#2607, cval_supplier_s_acctbal#2590 AS cval_supplier_s_acctbal_1#2608, cval_supplier_s_comment#2591 AS cval_supplier_s_comment_1#2609, cdepval_supplier_s_name#2592 AS cdepval_supplier_s_name_1#2610, cdepval_supplier_s_address#2593 AS cdepval_supplier_s_address_1#2611, cdepval_supplier_s_phone#2594 AS cdepval_supplier_s_phone_1#2612, cdepval_supplier_s_acctbal#2595 AS cdepval_supplier_s_acctbal_1#2613, cdepval_supplier_s_comment#2596 AS cdepval_supplier_s_comment_1#2614, cs_name#2597 AS cs_name_1#2615, cs_address#2598 AS cs_address_1#2616, cs_phone#2599 AS cs_phone_1#2617, cs_acctbal#2600 AS cs_acctbal_1#2618, cs_comment#2601 AS cs_comment_1#2619]
            :        +- Relation[rid#2584,cpfk_nation_supplier#2585,cfpk_supplier_nation#2586,cval_supplier_s_name#2587,cval_supplier_s_address#2588,cval_supplier_s_phone#2589,cval_supplier_s_acctbal#2590,cval_supplier_s_comment#2591,cdepval_supplier_s_name#2592,cdepval_supplier_s_address#2593,cdepval_supplier_s_phone#2594,cdepval_supplier_s_acctbal#2595,cdepval_supplier_s_comment#2596,cs_name#2597,cs_address#2598,cs_phone#2599,cs_acctbal#2600,cs_comment#2601] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#2530 AS rid_1#2548, cpfk_nation_supplier#2531 AS cpfk_nation_supplier_1#2549, cfpk_supplier_nation#2532 AS cfpk_supplier_nation_1#2550, cval_supplier_s_name#2533 AS cval_supplier_s_name_1#2551, cval_supplier_s_address#2534 AS cval_supplier_s_address_1#2552, cval_supplier_s_phone#2535 AS cval_supplier_s_phone_1#2553, cval_supplier_s_acctbal#2536 AS cval_supplier_s_acctbal_1#2554, cval_supplier_s_comment#2537 AS cval_supplier_s_comment_1#2555, cdepval_supplier_s_name#2538 AS cdepval_supplier_s_name_1#2556, cdepval_supplier_s_address#2539 AS cdepval_supplier_s_address_1#2557, cdepval_supplier_s_phone#2540 AS cdepval_supplier_s_phone_1#2558, cdepval_supplier_s_acctbal#2541 AS cdepval_supplier_s_acctbal_1#2559, cdepval_supplier_s_comment#2542 AS cdepval_supplier_s_comment_1#2560, cs_name#2543 AS cs_name_1#2561, cs_address#2544 AS cs_address_1#2562, cs_phone#2545 AS cs_phone_1#2563, cs_acctbal#2546 AS cs_acctbal_1#2564, cs_comment#2547 AS cs_comment_1#2565]
               +- Relation[rid#2530,cpfk_nation_supplier#2531,cfpk_supplier_nation#2532,cval_supplier_s_name#2533,cval_supplier_s_address#2534,cval_supplier_s_phone#2535,cval_supplier_s_acctbal#2536,cval_supplier_s_comment#2537,cdepval_supplier_s_name#2538,cdepval_supplier_s_address#2539,cdepval_supplier_s_phone#2540,cdepval_supplier_s_acctbal#2541,cdepval_supplier_s_comment#2542,cs_name#2543,cs_address#2544,cs_phone#2545,cs_acctbal#2546,cs_comment#2547] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 2583ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/26 22:38:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:38:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2701L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 22:38:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:38:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:38:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2701L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#2703 AS rid_0#2748, cpfk_orders_lineitem#2704 AS cpfk_orders_lineitem_0#2749, cpfk_supplier_lineitem#2705 AS cpfk_supplier_lineitem_0#2750, cfpk_lineitem_supplier#2706 AS cfpk_lineitem_supplier_0#2751, cfpk_lineitem_partsupp#2707 AS cfpk_lineitem_partsupp_0#2752, cpfk_part_lineitem#2708 AS cpfk_part_lineitem_0#2753, cfpk_lineitem_part#2709 AS cfpk_lineitem_part_0#2754, cpfk_partsupp_lineitem#2710 AS cpfk_partsupp_lineitem_0#2755, cfpk_lineitem_orders#2711 AS cfpk_lineitem_orders_0#2756, cval_lineitem_l_quantity#2712 AS cval_lineitem_l_quantity_0#2757, cval_lineitem_l_extendedprice#2713 AS cval_lineitem_l_extendedprice_0#2758, cval_lineitem_l_discount#2714 AS cval_lineitem_l_discount_0#2759, cval_lineitem_l_tax#2715 AS cval_lineitem_l_tax_0#2760, cval_lineitem_l_returnflag#2716 AS cval_lineitem_l_returnflag_0#2761, cval_lineitem_l_linestatus#2717 AS cval_lineitem_l_linestatus_0#2762, cval_lineitem_l_commitdate#2718 AS cval_lineitem_l_commitdate_0#2763, cval_lineitem_l_receiptdate#2719 AS cval_lineitem_l_receiptdate_0#2764, cval_lineitem_l_shipinstruct#2720 AS cval_lineitem_l_shipinstruct_0#2765, cval_lineitem_l_shipmode#2721 AS cval_lineitem_l_shipmode_0#2766, cval_lineitem_l_comment#2722 AS cval_lineitem_l_comment_0#2767, cval_lineitem_l_shipdate#2723 AS cval_lineitem_l_shipdate_0#2768, cdepval_lineitem_l_quantity#2724 AS cdepval_lineitem_l_quantity_0#2769, cdepval_lineitem_l_extendedprice#2725 AS cdepval_lineitem_l_extendedprice_0#2770, cdepval_lineitem_l_discount#2726 AS cdepval_lineitem_l_discount_0#2771, ... 21 more fields]
         :  :  :     +- Relation[rid#2703,cpfk_orders_lineitem#2704,cpfk_supplier_lineitem#2705,cfpk_lineitem_supplier#2706,cfpk_lineitem_partsupp#2707,cpfk_part_lineitem#2708,cfpk_lineitem_part#2709,cpfk_partsupp_lineitem#2710,cfpk_lineitem_orders#2711,cval_lineitem_l_quantity#2712,cval_lineitem_l_extendedprice#2713,cval_lineitem_l_discount#2714,cval_lineitem_l_tax#2715,cval_lineitem_l_returnflag#2716,cval_lineitem_l_linestatus#2717,cval_lineitem_l_commitdate#2718,cval_lineitem_l_receiptdate#2719,cval_lineitem_l_shipinstruct#2720,cval_lineitem_l_shipmode#2721,cval_lineitem_l_comment#2722,cval_lineitem_l_shipdate#2723,cdepval_lineitem_l_quantity#2724,cdepval_lineitem_l_extendedprice#2725,cdepval_lineitem_l_discount#2726,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#2883 AS rid_1#2907, cpfk_customer_orders#2884 AS cpfk_customer_orders_1#2908, cfpk_orders_customer#2885 AS cfpk_orders_customer_1#2909, cval_orders_o_orderstatus#2886 AS cval_orders_o_orderstatus_1#2910, cval_orders_o_totalprice#2887 AS cval_orders_o_totalprice_1#2911, cval_orders_o_orderpriority#2888 AS cval_orders_o_orderpriority_1#2912, cval_orders_o_clerk#2889 AS cval_orders_o_clerk_1#2913, cval_orders_o_shippriority#2890 AS cval_orders_o_shippriority_1#2914, cval_orders_o_comment#2891 AS cval_orders_o_comment_1#2915, cval_orders_o_orderdate#2892 AS cval_orders_o_orderdate_1#2916, cdepval_orders_o_orderstatus#2893 AS cdepval_orders_o_orderstatus_1#2917, cdepval_orders_o_totalprice#2894 AS cdepval_orders_o_totalprice_1#2918, cdepval_orders_o_orderpriority#2895 AS cdepval_orders_o_orderpriority_1#2919, cdepval_orders_o_clerk#2896 AS cdepval_orders_o_clerk_1#2920, cdepval_orders_o_shippriority#2897 AS cdepval_orders_o_shippriority_1#2921, cdepval_orders_o_comment#2898 AS cdepval_orders_o_comment_1#2922, cdepval_orders_o_orderdate#2899 AS cdepval_orders_o_orderdate_1#2923, co_orderstatus#2900 AS co_orderstatus_1#2924, co_totalprice#2901 AS co_totalprice_1#2925, co_orderpriority#2902 AS co_orderpriority_1#2926, co_clerk#2903 AS co_clerk_1#2927, co_shippriority#2904 AS co_shippriority_1#2928, co_comment#2905 AS co_comment_1#2929, co_orderdate#2906 AS co_orderdate_1#2930]
         :  :     +- Relation[rid#2883,cpfk_customer_orders#2884,cfpk_orders_customer#2885,cval_orders_o_orderstatus#2886,cval_orders_o_totalprice#2887,cval_orders_o_orderpriority#2888,cval_orders_o_clerk#2889,cval_orders_o_shippriority#2890,cval_orders_o_comment#2891,cval_orders_o_orderdate#2892,cdepval_orders_o_orderstatus#2893,cdepval_orders_o_totalprice#2894,cdepval_orders_o_orderpriority#2895,cdepval_orders_o_clerk#2896,cdepval_orders_o_shippriority#2897,cdepval_orders_o_comment#2898,cdepval_orders_o_orderdate#2899,co_orderstatus#2900,co_totalprice#2901,co_orderpriority#2902,co_clerk#2903,co_shippriority#2904,co_comment#2905,co_orderdate#2906] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#2931 AS rid_2#2952, cpfk_nation_customer#2932 AS cpfk_nation_customer_2#2953, cfpk_customer_nation#2933 AS cfpk_customer_nation_2#2954, cval_customer_c_name#2934 AS cval_customer_c_name_2#2955, cval_customer_c_address#2935 AS cval_customer_c_address_2#2956, cval_customer_c_phone#2936 AS cval_customer_c_phone_2#2957, cval_customer_c_acctbal#2937 AS cval_customer_c_acctbal_2#2958, cval_customer_c_comment#2938 AS cval_customer_c_comment_2#2959, cval_customer_c_mktsegment#2939 AS cval_customer_c_mktsegment_2#2960, cdepval_customer_c_name#2940 AS cdepval_customer_c_name_2#2961, cdepval_customer_c_address#2941 AS cdepval_customer_c_address_2#2962, cdepval_customer_c_phone#2942 AS cdepval_customer_c_phone_2#2963, cdepval_customer_c_acctbal#2943 AS cdepval_customer_c_acctbal_2#2964, cdepval_customer_c_comment#2944 AS cdepval_customer_c_comment_2#2965, cdepval_customer_c_mktsegment#2945 AS cdepval_customer_c_mktsegment_2#2966, cc_name#2946 AS cc_name_2#2967, cc_address#2947 AS cc_address_2#2968, cc_phone#2948 AS cc_phone_2#2969, cc_acctbal#2949 AS cc_acctbal_2#2970, cc_comment#2950 AS cc_comment_2#2971, cc_mktsegment#2951 AS cc_mktsegment_2#2972]
         :     +- Relation[rid#2931,cpfk_nation_customer#2932,cfpk_customer_nation#2933,cval_customer_c_name#2934,cval_customer_c_address#2935,cval_customer_c_phone#2936,cval_customer_c_acctbal#2937,cval_customer_c_comment#2938,cval_customer_c_mktsegment#2939,cdepval_customer_c_name#2940,cdepval_customer_c_address#2941,cdepval_customer_c_phone#2942,cdepval_customer_c_acctbal#2943,cdepval_customer_c_comment#2944,cdepval_customer_c_mktsegment#2945,cc_name#2946,cc_address#2947,cc_phone#2948,cc_acctbal#2949,cc_comment#2950,cc_mktsegment#2951] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#2973 AS rid_3#2982, cpfk_region_nation#2974 AS cpfk_region_nation_3#2983, cfpk_nation_region#2975 AS cfpk_nation_region_3#2984, cval_nation_n_name#2976 AS cval_nation_n_name_3#2985, cval_nation_n_comment#2977 AS cval_nation_n_comment_3#2986, cdepval_nation_n_name#2978 AS cdepval_nation_n_name_3#2987, cdepval_nation_n_comment#2979 AS cdepval_nation_n_comment_3#2988, cn_name#2980 AS cn_name_3#2989, cn_comment#2981 AS cn_comment_3#2990]
            +- Relation[rid#2973,cpfk_region_nation#2974,cfpk_nation_region#2975,cval_nation_n_name#2976,cval_nation_n_comment#2977,cdepval_nation_n_name#2978,cdepval_nation_n_comment#2979,cn_name#2980,cn_comment#2981] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 67154ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/26 22:39:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:39:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3097L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:39:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:39:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:39:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:39:17 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:39:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:39:17 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:39:17 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:39:17 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:39:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:39:17 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:39:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:39:17 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:39:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:39:17 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:39:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3097L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#3124, cval_part_p_name_0#3125, cval_part_p_mfgr_0#3126, cval_part_p_type_0#3127, cval_part_p_size_0#3128, cval_part_p_container_0#3129, cval_part_p_retailprice_0#3130, cval_part_p_comment_0#3131, cval_part_p_brand_0#3132, cdepval_part_p_name_0#3133, cdepval_part_p_mfgr_0#3134, cdepval_part_p_type_0#3135, cdepval_part_p_size_0#3136, cdepval_part_p_container_0#3137, cdepval_part_p_retailprice_0#3138, cdepval_part_p_comment_0#3139, cdepval_part_p_brand_0#3140, cp_name_0#3141, cp_mfgr_0#3142, cp_type_0#3143, cp_size_0#3144, cp_container_0#3145, cp_retailprice_0#3146, cp_comment_0#3147, ... 2 more fields]
         :  :  :  :  :- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :  :  :  +- Project [rid#3099 AS rid_0#3124, cval_part_p_name#3100 AS cval_part_p_name_0#3125, cval_part_p_mfgr#3101 AS cval_part_p_mfgr_0#3126, cval_part_p_type#3102 AS cval_part_p_type_0#3127, cval_part_p_size#3103 AS cval_part_p_size_0#3128, cval_part_p_container#3104 AS cval_part_p_container_0#3129, cval_part_p_retailprice#3105 AS cval_part_p_retailprice_0#3130, cval_part_p_comment#3106 AS cval_part_p_comment_0#3131, cval_part_p_brand#3107 AS cval_part_p_brand_0#3132, cdepval_part_p_name#3108 AS cdepval_part_p_name_0#3133, cdepval_part_p_mfgr#3109 AS cdepval_part_p_mfgr_0#3134, cdepval_part_p_type#3110 AS cdepval_part_p_type_0#3135, cdepval_part_p_size#3111 AS cdepval_part_p_size_0#3136, cdepval_part_p_container#3112 AS cdepval_part_p_container_0#3137, cdepval_part_p_retailprice#3113 AS cdepval_part_p_retailprice_0#3138, cdepval_part_p_comment#3114 AS cdepval_part_p_comment_0#3139, cdepval_part_p_brand#3115 AS cdepval_part_p_brand_0#3140, cp_name#3116 AS cp_name_0#3141, cp_mfgr#3117 AS cp_mfgr_0#3142, cp_type#3118 AS cp_type_0#3143, cp_size#3119 AS cp_size_0#3144, cp_container#3120 AS cp_container_0#3145, cp_retailprice#3121 AS cp_retailprice_0#3146, cp_comment#3122 AS cp_comment_0#3147, cp_brand#3123 AS cp_brand_0#3148]
         :  :  :  :  :     +- Relation[rid#3099,cval_part_p_name#3100,cval_part_p_mfgr#3101,cval_part_p_type#3102,cval_part_p_size#3103,cval_part_p_container#3104,cval_part_p_retailprice#3105,cval_part_p_comment#3106,cval_part_p_brand#3107,cdepval_part_p_name#3108,cdepval_part_p_mfgr#3109,cdepval_part_p_type#3110,cdepval_part_p_size#3111,cdepval_part_p_container#3112,cdepval_part_p_retailprice#3113,cdepval_part_p_comment#3114,cdepval_part_p_brand#3115,cp_name#3116,cp_mfgr#3117,cp_type#3118,cp_size#3119,cp_container#3120,cp_retailprice#3121,cp_comment#3122,cp_brand#3123] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :  :  :  :     +- Project [rid#3339 AS rid_1#3384, cpfk_orders_lineitem#3340 AS cpfk_orders_lineitem_1#3385, cpfk_supplier_lineitem#3341 AS cpfk_supplier_lineitem_1#3386, cfpk_lineitem_supplier#3342 AS cfpk_lineitem_supplier_1#3387, cfpk_lineitem_partsupp#3343 AS cfpk_lineitem_partsupp_1#3388, cpfk_part_lineitem#3344 AS cpfk_part_lineitem_1#3389, cfpk_lineitem_part#3345 AS cfpk_lineitem_part_1#3390, cpfk_partsupp_lineitem#3346 AS cpfk_partsupp_lineitem_1#3391, cfpk_lineitem_orders#3347 AS cfpk_lineitem_orders_1#3392, cval_lineitem_l_quantity#3348 AS cval_lineitem_l_quantity_1#3393, cval_lineitem_l_extendedprice#3349 AS cval_lineitem_l_extendedprice_1#3394, cval_lineitem_l_discount#3350 AS cval_lineitem_l_discount_1#3395, cval_lineitem_l_tax#3351 AS cval_lineitem_l_tax_1#3396, cval_lineitem_l_returnflag#3352 AS cval_lineitem_l_returnflag_1#3397, cval_lineitem_l_linestatus#3353 AS cval_lineitem_l_linestatus_1#3398, cval_lineitem_l_commitdate#3354 AS cval_lineitem_l_commitdate_1#3399, cval_lineitem_l_receiptdate#3355 AS cval_lineitem_l_receiptdate_1#3400, cval_lineitem_l_shipinstruct#3356 AS cval_lineitem_l_shipinstruct_1#3401, cval_lineitem_l_shipmode#3357 AS cval_lineitem_l_shipmode_1#3402, cval_lineitem_l_comment#3358 AS cval_lineitem_l_comment_1#3403, cval_lineitem_l_shipdate#3359 AS cval_lineitem_l_shipdate_1#3404, cdepval_lineitem_l_quantity#3360 AS cdepval_lineitem_l_quantity_1#3405, cdepval_lineitem_l_extendedprice#3361 AS cdepval_lineitem_l_extendedprice_1#3406, cdepval_lineitem_l_discount#3362 AS cdepval_lineitem_l_discount_1#3407, ... 21 more fields]
         :  :  :  :        +- Relation[rid#3339,cpfk_orders_lineitem#3340,cpfk_supplier_lineitem#3341,cfpk_lineitem_supplier#3342,cfpk_lineitem_partsupp#3343,cpfk_part_lineitem#3344,cfpk_lineitem_part#3345,cpfk_partsupp_lineitem#3346,cfpk_lineitem_orders#3347,cval_lineitem_l_quantity#3348,cval_lineitem_l_extendedprice#3349,cval_lineitem_l_discount#3350,cval_lineitem_l_tax#3351,cval_lineitem_l_returnflag#3352,cval_lineitem_l_linestatus#3353,cval_lineitem_l_commitdate#3354,cval_lineitem_l_receiptdate#3355,cval_lineitem_l_shipinstruct#3356,cval_lineitem_l_shipmode#3357,cval_lineitem_l_comment#3358,cval_lineitem_l_shipdate#3359,cdepval_lineitem_l_quantity#3360,cdepval_lineitem_l_extendedprice#3361,cdepval_lineitem_l_discount#3362,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- Project [rid#3199 AS rid_1#3244, cpfk_orders_lineitem#3200 AS cpfk_orders_lineitem_1#3245, cpfk_supplier_lineitem#3201 AS cpfk_supplier_lineitem_1#3246, cfpk_lineitem_supplier#3202 AS cfpk_lineitem_supplier_1#3247, cfpk_lineitem_partsupp#3203 AS cfpk_lineitem_partsupp_1#3248, cpfk_part_lineitem#3204 AS cpfk_part_lineitem_1#3249, cfpk_lineitem_part#3205 AS cfpk_lineitem_part_1#3250, cpfk_partsupp_lineitem#3206 AS cpfk_partsupp_lineitem_1#3251, cfpk_lineitem_orders#3207 AS cfpk_lineitem_orders_1#3252, cval_lineitem_l_quantity#3208 AS cval_lineitem_l_quantity_1#3253, cval_lineitem_l_extendedprice#3209 AS cval_lineitem_l_extendedprice_1#3254, cval_lineitem_l_discount#3210 AS cval_lineitem_l_discount_1#3255, cval_lineitem_l_tax#3211 AS cval_lineitem_l_tax_1#3256, cval_lineitem_l_returnflag#3212 AS cval_lineitem_l_returnflag_1#3257, cval_lineitem_l_linestatus#3213 AS cval_lineitem_l_linestatus_1#3258, cval_lineitem_l_commitdate#3214 AS cval_lineitem_l_commitdate_1#3259, cval_lineitem_l_receiptdate#3215 AS cval_lineitem_l_receiptdate_1#3260, cval_lineitem_l_shipinstruct#3216 AS cval_lineitem_l_shipinstruct_1#3261, cval_lineitem_l_shipmode#3217 AS cval_lineitem_l_shipmode_1#3262, cval_lineitem_l_comment#3218 AS cval_lineitem_l_comment_1#3263, cval_lineitem_l_shipdate#3219 AS cval_lineitem_l_shipdate_1#3264, cdepval_lineitem_l_quantity#3220 AS cdepval_lineitem_l_quantity_1#3265, cdepval_lineitem_l_extendedprice#3221 AS cdepval_lineitem_l_extendedprice_1#3266, cdepval_lineitem_l_discount#3222 AS cdepval_lineitem_l_discount_1#3267, ... 21 more fields]
         :  :  :     +- Relation[rid#3199,cpfk_orders_lineitem#3200,cpfk_supplier_lineitem#3201,cfpk_lineitem_supplier#3202,cfpk_lineitem_partsupp#3203,cpfk_part_lineitem#3204,cfpk_lineitem_part#3205,cpfk_partsupp_lineitem#3206,cfpk_lineitem_orders#3207,cval_lineitem_l_quantity#3208,cval_lineitem_l_extendedprice#3209,cval_lineitem_l_discount#3210,cval_lineitem_l_tax#3211,cval_lineitem_l_returnflag#3212,cval_lineitem_l_linestatus#3213,cval_lineitem_l_commitdate#3214,cval_lineitem_l_receiptdate#3215,cval_lineitem_l_shipinstruct#3216,cval_lineitem_l_shipmode#3217,cval_lineitem_l_comment#3218,cval_lineitem_l_shipdate#3219,cdepval_lineitem_l_quantity#3220,cdepval_lineitem_l_extendedprice#3221,cdepval_lineitem_l_discount#3222,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#3429 AS rid_2#3447, cpfk_nation_supplier#3430 AS cpfk_nation_supplier_2#3448, cfpk_supplier_nation#3431 AS cfpk_supplier_nation_2#3449, cval_supplier_s_name#3432 AS cval_supplier_s_name_2#3450, cval_supplier_s_address#3433 AS cval_supplier_s_address_2#3451, cval_supplier_s_phone#3434 AS cval_supplier_s_phone_2#3452, cval_supplier_s_acctbal#3435 AS cval_supplier_s_acctbal_2#3453, cval_supplier_s_comment#3436 AS cval_supplier_s_comment_2#3454, cdepval_supplier_s_name#3437 AS cdepval_supplier_s_name_2#3455, cdepval_supplier_s_address#3438 AS cdepval_supplier_s_address_2#3456, cdepval_supplier_s_phone#3439 AS cdepval_supplier_s_phone_2#3457, cdepval_supplier_s_acctbal#3440 AS cdepval_supplier_s_acctbal_2#3458, cdepval_supplier_s_comment#3441 AS cdepval_supplier_s_comment_2#3459, cs_name#3442 AS cs_name_2#3460, cs_address#3443 AS cs_address_2#3461, cs_phone#3444 AS cs_phone_2#3462, cs_acctbal#3445 AS cs_acctbal_2#3463, cs_comment#3446 AS cs_comment_2#3464]
         :  :     +- Relation[rid#3429,cpfk_nation_supplier#3430,cfpk_supplier_nation#3431,cval_supplier_s_name#3432,cval_supplier_s_address#3433,cval_supplier_s_phone#3434,cval_supplier_s_acctbal#3435,cval_supplier_s_comment#3436,cdepval_supplier_s_name#3437,cdepval_supplier_s_address#3438,cdepval_supplier_s_phone#3439,cdepval_supplier_s_acctbal#3440,cdepval_supplier_s_comment#3441,cs_name#3442,cs_address#3443,cs_phone#3444,cs_acctbal#3445,cs_comment#3446] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#3465 AS rid_3#3474, cpfk_region_nation#3466 AS cpfk_region_nation_3#3475, cfpk_nation_region#3467 AS cfpk_nation_region_3#3476, cval_nation_n_name#3468 AS cval_nation_n_name_3#3477, cval_nation_n_comment#3469 AS cval_nation_n_comment_3#3478, cdepval_nation_n_name#3470 AS cdepval_nation_n_name_3#3479, cdepval_nation_n_comment#3471 AS cdepval_nation_n_comment_3#3480, cn_name#3472 AS cn_name_3#3481, cn_comment#3473 AS cn_comment_3#3482]
         :     +- Relation[rid#3465,cpfk_region_nation#3466,cfpk_nation_region#3467,cval_nation_n_name#3468,cval_nation_n_comment#3469,cdepval_nation_n_name#3470,cdepval_nation_n_comment#3471,cn_name#3472,cn_comment#3473] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#3603 AS rid_7#3627, cpfk_customer_orders#3604 AS cpfk_customer_orders_7#3628, cfpk_orders_customer#3605 AS cfpk_orders_customer_7#3629, cval_orders_o_orderstatus#3606 AS cval_orders_o_orderstatus_7#3630, cval_orders_o_totalprice#3607 AS cval_orders_o_totalprice_7#3631, cval_orders_o_orderpriority#3608 AS cval_orders_o_orderpriority_7#3632, cval_orders_o_clerk#3609 AS cval_orders_o_clerk_7#3633, cval_orders_o_shippriority#3610 AS cval_orders_o_shippriority_7#3634, cval_orders_o_comment#3611 AS cval_orders_o_comment_7#3635, cval_orders_o_orderdate#3612 AS cval_orders_o_orderdate_7#3636, cdepval_orders_o_orderstatus#3613 AS cdepval_orders_o_orderstatus_7#3637, cdepval_orders_o_totalprice#3614 AS cdepval_orders_o_totalprice_7#3638, cdepval_orders_o_orderpriority#3615 AS cdepval_orders_o_orderpriority_7#3639, cdepval_orders_o_clerk#3616 AS cdepval_orders_o_clerk_7#3640, cdepval_orders_o_shippriority#3617 AS cdepval_orders_o_shippriority_7#3641, cdepval_orders_o_comment#3618 AS cdepval_orders_o_comment_7#3642, cdepval_orders_o_orderdate#3619 AS cdepval_orders_o_orderdate_7#3643, co_orderstatus#3620 AS co_orderstatus_7#3644, co_totalprice#3621 AS co_totalprice_7#3645, co_orderpriority#3622 AS co_orderpriority_7#3646, co_clerk#3623 AS co_clerk_7#3647, co_shippriority#3624 AS co_shippriority_7#3648, co_comment#3625 AS co_comment_7#3649, co_orderdate#3626 AS co_orderdate_7#3650]
            :  +- Relation[rid#3603,cpfk_customer_orders#3604,cfpk_orders_customer#3605,cval_orders_o_orderstatus#3606,cval_orders_o_totalprice#3607,cval_orders_o_orderpriority#3608,cval_orders_o_clerk#3609,cval_orders_o_shippriority#3610,cval_orders_o_comment#3611,cval_orders_o_orderdate#3612,cdepval_orders_o_orderstatus#3613,cdepval_orders_o_totalprice#3614,cdepval_orders_o_orderpriority#3615,cdepval_orders_o_clerk#3616,cdepval_orders_o_shippriority#3617,cdepval_orders_o_comment#3618,cdepval_orders_o_orderdate#3619,co_orderstatus#3620,co_totalprice#3621,co_orderpriority#3622,co_clerk#3623,co_shippriority#3624,co_comment#3625,co_orderdate#3626] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#3561 AS rid_6#3582, cpfk_nation_customer#3562 AS cpfk_nation_customer_6#3583, cfpk_customer_nation#3563 AS cfpk_customer_nation_6#3584, cval_customer_c_name#3564 AS cval_customer_c_name_6#3585, cval_customer_c_address#3565 AS cval_customer_c_address_6#3586, cval_customer_c_phone#3566 AS cval_customer_c_phone_6#3587, cval_customer_c_acctbal#3567 AS cval_customer_c_acctbal_6#3588, cval_customer_c_comment#3568 AS cval_customer_c_comment_6#3589, cval_customer_c_mktsegment#3569 AS cval_customer_c_mktsegment_6#3590, cdepval_customer_c_name#3570 AS cdepval_customer_c_name_6#3591, cdepval_customer_c_address#3571 AS cdepval_customer_c_address_6#3592, cdepval_customer_c_phone#3572 AS cdepval_customer_c_phone_6#3593, cdepval_customer_c_acctbal#3573 AS cdepval_customer_c_acctbal_6#3594, cdepval_customer_c_comment#3574 AS cdepval_customer_c_comment_6#3595, cdepval_customer_c_mktsegment#3575 AS cdepval_customer_c_mktsegment_6#3596, cc_name#3576 AS cc_name_6#3597, cc_address#3577 AS cc_address_6#3598, cc_phone#3578 AS cc_phone_6#3599, cc_acctbal#3579 AS cc_acctbal_6#3600, cc_comment#3580 AS cc_comment_6#3601, cc_mktsegment#3581 AS cc_mktsegment_6#3602]
               :  +- Relation[rid#3561,cpfk_nation_customer#3562,cfpk_customer_nation#3563,cval_customer_c_name#3564,cval_customer_c_address#3565,cval_customer_c_phone#3566,cval_customer_c_acctbal#3567,cval_customer_c_comment#3568,cval_customer_c_mktsegment#3569,cdepval_customer_c_name#3570,cdepval_customer_c_address#3571,cdepval_customer_c_phone#3572,cdepval_customer_c_acctbal#3573,cdepval_customer_c_comment#3574,cdepval_customer_c_mktsegment#3575,cc_name#3576,cc_address#3577,cc_phone#3578,cc_acctbal#3579,cc_comment#3580,cc_mktsegment#3581] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join UsingJoin(Inner,List(rid_5))
                  :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_5, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#3490, cval_region_r_name_4#3491, cval_region_r_comment_4#3492, cdepval_region_r_name_4#3493, cdepval_region_r_comment_4#3494, cr_name_4#3495, cr_comment_4#3496, 'rid_5]
                  :  :- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                  :  :  +- Project [rid#3483 AS rid_4#3490, cval_region_r_name#3484 AS cval_region_r_name_4#3491, cval_region_r_comment#3485 AS cval_region_r_comment_4#3492, cdepval_region_r_name#3486 AS cdepval_region_r_name_4#3493, cdepval_region_r_comment#3487 AS cdepval_region_r_comment_4#3494, cr_name#3488 AS cr_name_4#3495, cr_comment#3489 AS cr_comment_4#3496]
                  :  :     +- Relation[rid#3483,cval_region_r_name#3484,cval_region_r_comment#3485,cdepval_region_r_name#3486,cdepval_region_r_comment#3487,cr_name#3488,cr_comment#3489] JDBCRelation(tregion) [numPartitions=1]
                  :  +- 'Project ['cpfk_region_nation_5, 'rid_5]
                  :     +- Project [rid#3543 AS rid_5#3552, cpfk_region_nation#3544 AS cpfk_region_nation_5#3553, cfpk_nation_region#3545 AS cfpk_nation_region_5#3554, cval_nation_n_name#3546 AS cval_nation_n_name_5#3555, cval_nation_n_comment#3547 AS cval_nation_n_comment_5#3556, cdepval_nation_n_name#3548 AS cdepval_nation_n_name_5#3557, cdepval_nation_n_comment#3549 AS cdepval_nation_n_comment_5#3558, cn_name#3550 AS cn_name_5#3559, cn_comment#3551 AS cn_comment_5#3560]
                  :        +- Relation[rid#3543,cpfk_region_nation#3544,cfpk_nation_region#3545,cval_nation_n_name#3546,cval_nation_n_comment#3547,cdepval_nation_n_name#3548,cdepval_nation_n_comment#3549,cn_name#3550,cn_comment#3551] JDBCRelation(tnation) [numPartitions=1]
                  +- Project [rid#3511 AS rid_5#3520, cpfk_region_nation#3512 AS cpfk_region_nation_5#3521, cfpk_nation_region#3513 AS cfpk_nation_region_5#3522, cval_nation_n_name#3514 AS cval_nation_n_name_5#3523, cval_nation_n_comment#3515 AS cval_nation_n_comment_5#3524, cdepval_nation_n_name#3516 AS cdepval_nation_n_name_5#3525, cdepval_nation_n_comment#3517 AS cdepval_nation_n_comment_5#3526, cn_name#3518 AS cn_name_5#3527, cn_comment#3519 AS cn_comment_5#3528]
                     +- Relation[rid#3511,cpfk_region_nation#3512,cfpk_nation_region#3513,cval_nation_n_name#3514,cval_nation_n_comment#3515,cdepval_nation_n_name#3516,cdepval_nation_n_comment#3517,cn_name#3518,cn_comment#3519] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 3817ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/26 22:39:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:39:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3813L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 22:39:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3813L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#3815 AS rid_0#3839, cpfk_customer_orders#3816 AS cpfk_customer_orders_0#3840, cfpk_orders_customer#3817 AS cfpk_orders_customer_0#3841, cval_orders_o_orderstatus#3818 AS cval_orders_o_orderstatus_0#3842, cval_orders_o_totalprice#3819 AS cval_orders_o_totalprice_0#3843, cval_orders_o_orderpriority#3820 AS cval_orders_o_orderpriority_0#3844, cval_orders_o_clerk#3821 AS cval_orders_o_clerk_0#3845, cval_orders_o_shippriority#3822 AS cval_orders_o_shippriority_0#3846, cval_orders_o_comment#3823 AS cval_orders_o_comment_0#3847, cval_orders_o_orderdate#3824 AS cval_orders_o_orderdate_0#3848, cdepval_orders_o_orderstatus#3825 AS cdepval_orders_o_orderstatus_0#3849, cdepval_orders_o_totalprice#3826 AS cdepval_orders_o_totalprice_0#3850, cdepval_orders_o_orderpriority#3827 AS cdepval_orders_o_orderpriority_0#3851, cdepval_orders_o_clerk#3828 AS cdepval_orders_o_clerk_0#3852, cdepval_orders_o_shippriority#3829 AS cdepval_orders_o_shippriority_0#3853, cdepval_orders_o_comment#3830 AS cdepval_orders_o_comment_0#3854, cdepval_orders_o_orderdate#3831 AS cdepval_orders_o_orderdate_0#3855, co_orderstatus#3832 AS co_orderstatus_0#3856, co_totalprice#3833 AS co_totalprice_0#3857, co_orderpriority#3834 AS co_orderpriority_0#3858, co_clerk#3835 AS co_clerk_0#3859, co_shippriority#3836 AS co_shippriority_0#3860, co_comment#3837 AS co_comment_0#3861, co_orderdate#3838 AS co_orderdate_0#3862]
         :  +- Relation[rid#3815,cpfk_customer_orders#3816,cfpk_orders_customer#3817,cval_orders_o_orderstatus#3818,cval_orders_o_totalprice#3819,cval_orders_o_orderpriority#3820,cval_orders_o_clerk#3821,cval_orders_o_shippriority#3822,cval_orders_o_comment#3823,cval_orders_o_orderdate#3824,cdepval_orders_o_orderstatus#3825,cdepval_orders_o_totalprice#3826,cdepval_orders_o_orderpriority#3827,cdepval_orders_o_clerk#3828,cdepval_orders_o_shippriority#3829,cdepval_orders_o_comment#3830,cdepval_orders_o_orderdate#3831,co_orderstatus#3832,co_totalprice#3833,co_orderpriority#3834,co_clerk#3835,co_shippriority#3836,co_comment#3837,co_orderdate#3838] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#3863 AS rid_1#3884, cpfk_nation_customer#3864 AS cpfk_nation_customer_1#3885, cfpk_customer_nation#3865 AS cfpk_customer_nation_1#3886, cval_customer_c_name#3866 AS cval_customer_c_name_1#3887, cval_customer_c_address#3867 AS cval_customer_c_address_1#3888, cval_customer_c_phone#3868 AS cval_customer_c_phone_1#3889, cval_customer_c_acctbal#3869 AS cval_customer_c_acctbal_1#3890, cval_customer_c_comment#3870 AS cval_customer_c_comment_1#3891, cval_customer_c_mktsegment#3871 AS cval_customer_c_mktsegment_1#3892, cdepval_customer_c_name#3872 AS cdepval_customer_c_name_1#3893, cdepval_customer_c_address#3873 AS cdepval_customer_c_address_1#3894, cdepval_customer_c_phone#3874 AS cdepval_customer_c_phone_1#3895, cdepval_customer_c_acctbal#3875 AS cdepval_customer_c_acctbal_1#3896, cdepval_customer_c_comment#3876 AS cdepval_customer_c_comment_1#3897, cdepval_customer_c_mktsegment#3877 AS cdepval_customer_c_mktsegment_1#3898, cc_name#3878 AS cc_name_1#3899, cc_address#3879 AS cc_address_1#3900, cc_phone#3880 AS cc_phone_1#3901, cc_acctbal#3881 AS cc_acctbal_1#3902, cc_comment#3882 AS cc_comment_1#3903, cc_mktsegment#3883 AS cc_mktsegment_1#3904]
            +- Relation[rid#3863,cpfk_nation_customer#3864,cfpk_customer_nation#3865,cval_customer_c_name#3866,cval_customer_c_address#3867,cval_customer_c_phone#3868,cval_customer_c_acctbal#3869,cval_customer_c_comment#3870,cval_customer_c_mktsegment#3871,cdepval_customer_c_name#3872,cdepval_customer_c_address#3873,cdepval_customer_c_phone#3874,cdepval_customer_c_acctbal#3875,cdepval_customer_c_comment#3876,cdepval_customer_c_mktsegment#3877,cc_name#3878,cc_address#3879,cc_phone#3880,cc_acctbal#3881,cc_comment#3882,cc_mktsegment#3883] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4535ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/26 22:39:25 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:39:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3958L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:39:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:39:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:39:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:39:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:39:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:39:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:39:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:39:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:39:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:39:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:39:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:39:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:39:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:39:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:39:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3958L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#4086 AS rid_2#4131, cpfk_orders_lineitem#4087 AS cpfk_orders_lineitem_2#4132, cpfk_supplier_lineitem#4088 AS cpfk_supplier_lineitem_2#4133, cfpk_lineitem_supplier#4089 AS cfpk_lineitem_supplier_2#4134, cfpk_lineitem_partsupp#4090 AS cfpk_lineitem_partsupp_2#4135, cpfk_part_lineitem#4091 AS cpfk_part_lineitem_2#4136, cfpk_lineitem_part#4092 AS cfpk_lineitem_part_2#4137, cpfk_partsupp_lineitem#4093 AS cpfk_partsupp_lineitem_2#4138, cfpk_lineitem_orders#4094 AS cfpk_lineitem_orders_2#4139, cval_lineitem_l_quantity#4095 AS cval_lineitem_l_quantity_2#4140, cval_lineitem_l_extendedprice#4096 AS cval_lineitem_l_extendedprice_2#4141, cval_lineitem_l_discount#4097 AS cval_lineitem_l_discount_2#4142, cval_lineitem_l_tax#4098 AS cval_lineitem_l_tax_2#4143, cval_lineitem_l_returnflag#4099 AS cval_lineitem_l_returnflag_2#4144, cval_lineitem_l_linestatus#4100 AS cval_lineitem_l_linestatus_2#4145, cval_lineitem_l_commitdate#4101 AS cval_lineitem_l_commitdate_2#4146, cval_lineitem_l_receiptdate#4102 AS cval_lineitem_l_receiptdate_2#4147, cval_lineitem_l_shipinstruct#4103 AS cval_lineitem_l_shipinstruct_2#4148, cval_lineitem_l_shipmode#4104 AS cval_lineitem_l_shipmode_2#4149, cval_lineitem_l_comment#4105 AS cval_lineitem_l_comment_2#4150, cval_lineitem_l_shipdate#4106 AS cval_lineitem_l_shipdate_2#4151, cdepval_lineitem_l_quantity#4107 AS cdepval_lineitem_l_quantity_2#4152, cdepval_lineitem_l_extendedprice#4108 AS cdepval_lineitem_l_extendedprice_2#4153, cdepval_lineitem_l_discount#4109 AS cdepval_lineitem_l_discount_2#4154, ... 21 more fields]
         :  :  +- Relation[rid#4086,cpfk_orders_lineitem#4087,cpfk_supplier_lineitem#4088,cfpk_lineitem_supplier#4089,cfpk_lineitem_partsupp#4090,cpfk_part_lineitem#4091,cfpk_lineitem_part#4092,cpfk_partsupp_lineitem#4093,cfpk_lineitem_orders#4094,cval_lineitem_l_quantity#4095,cval_lineitem_l_extendedprice#4096,cval_lineitem_l_discount#4097,cval_lineitem_l_tax#4098,cval_lineitem_l_returnflag#4099,cval_lineitem_l_linestatus#4100,cval_lineitem_l_commitdate#4101,cval_lineitem_l_receiptdate#4102,cval_lineitem_l_shipinstruct#4103,cval_lineitem_l_shipmode#4104,cval_lineitem_l_comment#4105,cval_lineitem_l_shipdate#4106,cdepval_lineitem_l_quantity#4107,cdepval_lineitem_l_extendedprice#4108,cdepval_lineitem_l_discount#4109,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join UsingJoin(Inner,List(rid_1))
         :     :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#3969, cpfk_region_nation_0#3970, cfpk_nation_region_0#3971, cval_nation_n_name_0#3972, cval_nation_n_comment_0#3973, cdepval_nation_n_name_0#3974, cdepval_nation_n_comment_0#3975, cn_name_0#3976, cn_comment_0#3977, 'rid_1]
         :     :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :     :  :  +- Project [rid#3960 AS rid_0#3969, cpfk_region_nation#3961 AS cpfk_region_nation_0#3970, cfpk_nation_region#3962 AS cfpk_nation_region_0#3971, cval_nation_n_name#3963 AS cval_nation_n_name_0#3972, cval_nation_n_comment#3964 AS cval_nation_n_comment_0#3973, cdepval_nation_n_name#3965 AS cdepval_nation_n_name_0#3974, cdepval_nation_n_comment#3966 AS cdepval_nation_n_comment_0#3975, cn_name#3967 AS cn_name_0#3976, cn_comment#3968 AS cn_comment_0#3977]
         :     :  :     +- Relation[rid#3960,cpfk_region_nation#3961,cfpk_nation_region#3962,cval_nation_n_name#3963,cval_nation_n_comment#3964,cdepval_nation_n_name#3965,cdepval_nation_n_comment#3966,cn_name#3967,cn_comment#3968] JDBCRelation(tnation) [numPartitions=1]
         :     :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
         :     :     +- Project [rid#4050 AS rid_1#4068, cpfk_nation_supplier#4051 AS cpfk_nation_supplier_1#4069, cfpk_supplier_nation#4052 AS cfpk_supplier_nation_1#4070, cval_supplier_s_name#4053 AS cval_supplier_s_name_1#4071, cval_supplier_s_address#4054 AS cval_supplier_s_address_1#4072, cval_supplier_s_phone#4055 AS cval_supplier_s_phone_1#4073, cval_supplier_s_acctbal#4056 AS cval_supplier_s_acctbal_1#4074, cval_supplier_s_comment#4057 AS cval_supplier_s_comment_1#4075, cdepval_supplier_s_name#4058 AS cdepval_supplier_s_name_1#4076, cdepval_supplier_s_address#4059 AS cdepval_supplier_s_address_1#4077, cdepval_supplier_s_phone#4060 AS cdepval_supplier_s_phone_1#4078, cdepval_supplier_s_acctbal#4061 AS cdepval_supplier_s_acctbal_1#4079, cdepval_supplier_s_comment#4062 AS cdepval_supplier_s_comment_1#4080, cs_name#4063 AS cs_name_1#4081, cs_address#4064 AS cs_address_1#4082, cs_phone#4065 AS cs_phone_1#4083, cs_acctbal#4066 AS cs_acctbal_1#4084, cs_comment#4067 AS cs_comment_1#4085]
         :     :        +- Relation[rid#4050,cpfk_nation_supplier#4051,cfpk_supplier_nation#4052,cval_supplier_s_name#4053,cval_supplier_s_address#4054,cval_supplier_s_phone#4055,cval_supplier_s_acctbal#4056,cval_supplier_s_comment#4057,cdepval_supplier_s_name#4058,cdepval_supplier_s_address#4059,cdepval_supplier_s_phone#4060,cdepval_supplier_s_acctbal#4061,cdepval_supplier_s_comment#4062,cs_name#4063,cs_address#4064,cs_phone#4065,cs_acctbal#4066,cs_comment#4067] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#3996 AS rid_1#4014, cpfk_nation_supplier#3997 AS cpfk_nation_supplier_1#4015, cfpk_supplier_nation#3998 AS cfpk_supplier_nation_1#4016, cval_supplier_s_name#3999 AS cval_supplier_s_name_1#4017, cval_supplier_s_address#4000 AS cval_supplier_s_address_1#4018, cval_supplier_s_phone#4001 AS cval_supplier_s_phone_1#4019, cval_supplier_s_acctbal#4002 AS cval_supplier_s_acctbal_1#4020, cval_supplier_s_comment#4003 AS cval_supplier_s_comment_1#4021, cdepval_supplier_s_name#4004 AS cdepval_supplier_s_name_1#4022, cdepval_supplier_s_address#4005 AS cdepval_supplier_s_address_1#4023, cdepval_supplier_s_phone#4006 AS cdepval_supplier_s_phone_1#4024, cdepval_supplier_s_acctbal#4007 AS cdepval_supplier_s_acctbal_1#4025, cdepval_supplier_s_comment#4008 AS cdepval_supplier_s_comment_1#4026, cs_name#4009 AS cs_name_1#4027, cs_address#4010 AS cs_address_1#4028, cs_phone#4011 AS cs_phone_1#4029, cs_acctbal#4012 AS cs_acctbal_1#4030, cs_comment#4013 AS cs_comment_1#4031]
         :        +- Relation[rid#3996,cpfk_nation_supplier#3997,cfpk_supplier_nation#3998,cval_supplier_s_name#3999,cval_supplier_s_address#4000,cval_supplier_s_phone#4001,cval_supplier_s_acctbal#4002,cval_supplier_s_comment#4003,cdepval_supplier_s_name#4004,cdepval_supplier_s_address#4005,cdepval_supplier_s_phone#4006,cdepval_supplier_s_acctbal#4007,cdepval_supplier_s_comment#4008,cs_name#4009,cs_address#4010,cs_phone#4011,cs_acctbal#4012,cs_comment#4013] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#4314 AS rid_5#4338, cpfk_customer_orders#4315 AS cpfk_customer_orders_5#4339, cfpk_orders_customer#4316 AS cfpk_orders_customer_5#4340, cval_orders_o_orderstatus#4317 AS cval_orders_o_orderstatus_5#4341, cval_orders_o_totalprice#4318 AS cval_orders_o_totalprice_5#4342, cval_orders_o_orderpriority#4319 AS cval_orders_o_orderpriority_5#4343, cval_orders_o_clerk#4320 AS cval_orders_o_clerk_5#4344, cval_orders_o_shippriority#4321 AS cval_orders_o_shippriority_5#4345, cval_orders_o_comment#4322 AS cval_orders_o_comment_5#4346, cval_orders_o_orderdate#4323 AS cval_orders_o_orderdate_5#4347, cdepval_orders_o_orderstatus#4324 AS cdepval_orders_o_orderstatus_5#4348, cdepval_orders_o_totalprice#4325 AS cdepval_orders_o_totalprice_5#4349, cdepval_orders_o_orderpriority#4326 AS cdepval_orders_o_orderpriority_5#4350, cdepval_orders_o_clerk#4327 AS cdepval_orders_o_clerk_5#4351, cdepval_orders_o_shippriority#4328 AS cdepval_orders_o_shippriority_5#4352, cdepval_orders_o_comment#4329 AS cdepval_orders_o_comment_5#4353, cdepval_orders_o_orderdate#4330 AS cdepval_orders_o_orderdate_5#4354, co_orderstatus#4331 AS co_orderstatus_5#4355, co_totalprice#4332 AS co_totalprice_5#4356, co_orderpriority#4333 AS co_orderpriority_5#4357, co_clerk#4334 AS co_clerk_5#4358, co_shippriority#4335 AS co_shippriority_5#4359, co_comment#4336 AS co_comment_5#4360, co_orderdate#4337 AS co_orderdate_5#4361]
            :  +- Relation[rid#4314,cpfk_customer_orders#4315,cfpk_orders_customer#4316,cval_orders_o_orderstatus#4317,cval_orders_o_totalprice#4318,cval_orders_o_orderpriority#4319,cval_orders_o_clerk#4320,cval_orders_o_shippriority#4321,cval_orders_o_comment#4322,cval_orders_o_orderdate#4323,cdepval_orders_o_orderstatus#4324,cdepval_orders_o_totalprice#4325,cdepval_orders_o_orderpriority#4326,cdepval_orders_o_clerk#4327,cdepval_orders_o_shippriority#4328,cdepval_orders_o_comment#4329,cdepval_orders_o_orderdate#4330,co_orderstatus#4331,co_totalprice#4332,co_orderpriority#4333,co_clerk#4334,co_shippriority#4335,co_comment#4336,co_orderdate#4337] JDBCRelation(torders) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_4))
               :- 'DexPkfkMaterializationAwareJoin nation~customer, 'cpfk_nation_customer_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#4185, cpfk_region_nation_3#4186, cfpk_nation_region_3#4187, cval_nation_n_name_3#4188, cval_nation_n_comment_3#4189, cdepval_nation_n_name_3#4190, cdepval_nation_n_comment_3#4191, cn_name_3#4192, cn_comment_3#4193, 'rid_4]
               :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
               :  :  +- Project [rid#4176 AS rid_3#4185, cpfk_region_nation#4177 AS cpfk_region_nation_3#4186, cfpk_nation_region#4178 AS cfpk_nation_region_3#4187, cval_nation_n_name#4179 AS cval_nation_n_name_3#4188, cval_nation_n_comment#4180 AS cval_nation_n_comment_3#4189, cdepval_nation_n_name#4181 AS cdepval_nation_n_name_3#4190, cdepval_nation_n_comment#4182 AS cdepval_nation_n_comment_3#4191, cn_name#4183 AS cn_name_3#4192, cn_comment#4184 AS cn_comment_3#4193]
               :  :     +- Relation[rid#4176,cpfk_region_nation#4177,cfpk_nation_region#4178,cval_nation_n_name#4179,cval_nation_n_comment#4180,cdepval_nation_n_name#4181,cdepval_nation_n_comment#4182,cn_name#4183,cn_comment#4184] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'Project ['cpfk_nation_customer_4, 'rid_4]
               :     +- Project [rid#4272 AS rid_4#4293, cpfk_nation_customer#4273 AS cpfk_nation_customer_4#4294, cfpk_customer_nation#4274 AS cfpk_customer_nation_4#4295, cval_customer_c_name#4275 AS cval_customer_c_name_4#4296, cval_customer_c_address#4276 AS cval_customer_c_address_4#4297, cval_customer_c_phone#4277 AS cval_customer_c_phone_4#4298, cval_customer_c_acctbal#4278 AS cval_customer_c_acctbal_4#4299, cval_customer_c_comment#4279 AS cval_customer_c_comment_4#4300, cval_customer_c_mktsegment#4280 AS cval_customer_c_mktsegment_4#4301, cdepval_customer_c_name#4281 AS cdepval_customer_c_name_4#4302, cdepval_customer_c_address#4282 AS cdepval_customer_c_address_4#4303, cdepval_customer_c_phone#4283 AS cdepval_customer_c_phone_4#4304, cdepval_customer_c_acctbal#4284 AS cdepval_customer_c_acctbal_4#4305, cdepval_customer_c_comment#4285 AS cdepval_customer_c_comment_4#4306, cdepval_customer_c_mktsegment#4286 AS cdepval_customer_c_mktsegment_4#4307, cc_name#4287 AS cc_name_4#4308, cc_address#4288 AS cc_address_4#4309, cc_phone#4289 AS cc_phone_4#4310, cc_acctbal#4290 AS cc_acctbal_4#4311, cc_comment#4291 AS cc_comment_4#4312, cc_mktsegment#4292 AS cc_mktsegment_4#4313]
               :        +- Relation[rid#4272,cpfk_nation_customer#4273,cfpk_customer_nation#4274,cval_customer_c_name#4275,cval_customer_c_address#4276,cval_customer_c_phone#4277,cval_customer_c_acctbal#4278,cval_customer_c_comment#4279,cval_customer_c_mktsegment#4280,cdepval_customer_c_name#4281,cdepval_customer_c_address#4282,cdepval_customer_c_phone#4283,cdepval_customer_c_acctbal#4284,cdepval_customer_c_comment#4285,cdepval_customer_c_mktsegment#4286,cc_name#4287,cc_address#4288,cc_phone#4289,cc_acctbal#4290,cc_comment#4291,cc_mktsegment#4292] JDBCRelation(tcustomer) [numPartitions=1]
               +- Project [rid#4212 AS rid_4#4233, cpfk_nation_customer#4213 AS cpfk_nation_customer_4#4234, cfpk_customer_nation#4214 AS cfpk_customer_nation_4#4235, cval_customer_c_name#4215 AS cval_customer_c_name_4#4236, cval_customer_c_address#4216 AS cval_customer_c_address_4#4237, cval_customer_c_phone#4217 AS cval_customer_c_phone_4#4238, cval_customer_c_acctbal#4218 AS cval_customer_c_acctbal_4#4239, cval_customer_c_comment#4219 AS cval_customer_c_comment_4#4240, cval_customer_c_mktsegment#4220 AS cval_customer_c_mktsegment_4#4241, cdepval_customer_c_name#4221 AS cdepval_customer_c_name_4#4242, cdepval_customer_c_address#4222 AS cdepval_customer_c_address_4#4243, cdepval_customer_c_phone#4223 AS cdepval_customer_c_phone_4#4244, cdepval_customer_c_acctbal#4224 AS cdepval_customer_c_acctbal_4#4245, cdepval_customer_c_comment#4225 AS cdepval_customer_c_comment_4#4246, cdepval_customer_c_mktsegment#4226 AS cdepval_customer_c_mktsegment_4#4247, cc_name#4227 AS cc_name_4#4248, cc_address#4228 AS cc_address_4#4249, cc_phone#4229 AS cc_phone_4#4250, cc_acctbal#4230 AS cc_acctbal_4#4251, cc_comment#4231 AS cc_comment_4#4252, cc_mktsegment#4232 AS cc_mktsegment_4#4253]
                  +- Relation[rid#4212,cpfk_nation_customer#4213,cfpk_customer_nation#4214,cval_customer_c_name#4215,cval_customer_c_address#4216,cval_customer_c_phone#4217,cval_customer_c_acctbal#4218,cval_customer_c_comment#4219,cval_customer_c_mktsegment#4220,cdepval_customer_c_name#4221,cdepval_customer_c_address#4222,cdepval_customer_c_phone#4223,cdepval_customer_c_acctbal#4224,cdepval_customer_c_comment#4225,cdepval_customer_c_mktsegment#4226,cc_name#4227,cc_address#4228,cc_phone#4229,cc_acctbal#4230,cc_comment#4231,cc_mktsegment#4232] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 41171ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/26 22:40:06 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:40:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4492L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 22:40:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:40:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:40:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:40:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:40:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:40:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:40:06 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:40:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:40:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:40:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:40:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:40:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:40:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:40:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:40:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:40:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:40:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4492L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#4633, cval_part_p_name_3#4634, cval_part_p_mfgr_3#4635, cval_part_p_type_3#4636, cval_part_p_size_3#4637, cval_part_p_container_3#4638, cval_part_p_retailprice_3#4639, cval_part_p_comment_3#4640, cval_part_p_brand_3#4641, cdepval_part_p_name_3#4642, cdepval_part_p_mfgr_3#4643, cdepval_part_p_type_3#4644, cdepval_part_p_size_3#4645, cdepval_part_p_container_3#4646, cdepval_part_p_retailprice_3#4647, cdepval_part_p_comment_3#4648, cdepval_part_p_brand_3#4649, cp_name_3#4650, cp_mfgr_3#4651, cp_type_3#4652, cp_size_3#4653, cp_container_3#4654, cp_retailprice_3#4655, cp_comment_3#4656, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :  :  :  +- Project [rid#4608 AS rid_3#4633, cval_part_p_name#4609 AS cval_part_p_name_3#4634, cval_part_p_mfgr#4610 AS cval_part_p_mfgr_3#4635, cval_part_p_type#4611 AS cval_part_p_type_3#4636, cval_part_p_size#4612 AS cval_part_p_size_3#4637, cval_part_p_container#4613 AS cval_part_p_container_3#4638, cval_part_p_retailprice#4614 AS cval_part_p_retailprice_3#4639, cval_part_p_comment#4615 AS cval_part_p_comment_3#4640, cval_part_p_brand#4616 AS cval_part_p_brand_3#4641, cdepval_part_p_name#4617 AS cdepval_part_p_name_3#4642, cdepval_part_p_mfgr#4618 AS cdepval_part_p_mfgr_3#4643, cdepval_part_p_type#4619 AS cdepval_part_p_type_3#4644, cdepval_part_p_size#4620 AS cdepval_part_p_size_3#4645, cdepval_part_p_container#4621 AS cdepval_part_p_container_3#4646, cdepval_part_p_retailprice#4622 AS cdepval_part_p_retailprice_3#4647, cdepval_part_p_comment#4623 AS cdepval_part_p_comment_3#4648, cdepval_part_p_brand#4624 AS cdepval_part_p_brand_3#4649, cp_name#4625 AS cp_name_3#4650, cp_mfgr#4626 AS cp_mfgr_3#4651, cp_type#4627 AS cp_type_3#4652, cp_size#4628 AS cp_size_3#4653, cp_container#4629 AS cp_container_3#4654, cp_retailprice#4630 AS cp_retailprice_3#4655, cp_comment#4631 AS cp_comment_3#4656, cp_brand#4632 AS cp_brand_3#4657]
         :  :  :     +- Relation[rid#4608,cval_part_p_name#4609,cval_part_p_mfgr#4610,cval_part_p_type#4611,cval_part_p_size#4612,cval_part_p_container#4613,cval_part_p_retailprice#4614,cval_part_p_comment#4615,cval_part_p_brand#4616,cdepval_part_p_name#4617,cdepval_part_p_mfgr#4618,cdepval_part_p_type#4619,cdepval_part_p_size#4620,cdepval_part_p_container#4621,cdepval_part_p_retailprice#4622,cdepval_part_p_comment#4623,cdepval_part_p_brand#4624,cp_name#4625,cp_mfgr#4626,cp_type#4627,cp_size#4628,cp_container#4629,cp_retailprice#4630,cp_comment#4631,cp_brand#4632] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_4, 'rid_4]
         :  :     +- Project [rid#4786 AS rid_4#4800, cpfk_part_partsupp#4787 AS cpfk_part_partsupp_4#4801, cfpk_partsupp_part#4788 AS cfpk_partsupp_part_4#4802, cpfk_supplier_partsupp#4789 AS cpfk_supplier_partsupp_4#4803, cfpk_partsupp_supplier#4790 AS cfpk_partsupp_supplier_4#4804, cval_partsupp_ps_availqty#4791 AS cval_partsupp_ps_availqty_4#4805, cval_partsupp_ps_supplycost#4792 AS cval_partsupp_ps_supplycost_4#4806, cval_partsupp_ps_comment#4793 AS cval_partsupp_ps_comment_4#4807, cdepval_partsupp_ps_availqty#4794 AS cdepval_partsupp_ps_availqty_4#4808, cdepval_partsupp_ps_supplycost#4795 AS cdepval_partsupp_ps_supplycost_4#4809, cdepval_partsupp_ps_comment#4796 AS cdepval_partsupp_ps_comment_4#4810, cps_availqty#4797 AS cps_availqty_4#4811, cps_supplycost#4798 AS cps_supplycost_4#4812, cps_comment#4799 AS cps_comment_4#4813]
         :  :        +- Relation[rid#4786,cpfk_part_partsupp#4787,cfpk_partsupp_part#4788,cpfk_supplier_partsupp#4789,cfpk_partsupp_supplier#4790,cval_partsupp_ps_availqty#4791,cval_partsupp_ps_supplycost#4792,cval_partsupp_ps_comment#4793,cdepval_partsupp_ps_availqty#4794,cdepval_partsupp_ps_supplycost#4795,cdepval_partsupp_ps_comment#4796,cps_availqty#4797,cps_supplycost#4798,cps_comment#4799] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#4708 AS rid_4#4722, cpfk_part_partsupp#4709 AS cpfk_part_partsupp_4#4723, cfpk_partsupp_part#4710 AS cfpk_partsupp_part_4#4724, cpfk_supplier_partsupp#4711 AS cpfk_supplier_partsupp_4#4725, cfpk_partsupp_supplier#4712 AS cfpk_partsupp_supplier_4#4726, cval_partsupp_ps_availqty#4713 AS cval_partsupp_ps_availqty_4#4727, cval_partsupp_ps_supplycost#4714 AS cval_partsupp_ps_supplycost_4#4728, cval_partsupp_ps_comment#4715 AS cval_partsupp_ps_comment_4#4729, cdepval_partsupp_ps_availqty#4716 AS cdepval_partsupp_ps_availqty_4#4730, cdepval_partsupp_ps_supplycost#4717 AS cdepval_partsupp_ps_supplycost_4#4731, cdepval_partsupp_ps_comment#4718 AS cdepval_partsupp_ps_comment_4#4732, cps_availqty#4719 AS cps_availqty_4#4733, cps_supplycost#4720 AS cps_supplycost_4#4734, cps_comment#4721 AS cps_comment_4#4735]
         :     +- Relation[rid#4708,cpfk_part_partsupp#4709,cfpk_partsupp_part#4710,cpfk_supplier_partsupp#4711,cfpk_partsupp_supplier#4712,cval_partsupp_ps_availqty#4713,cval_partsupp_ps_supplycost#4714,cval_partsupp_ps_comment#4715,cdepval_partsupp_ps_availqty#4716,cdepval_partsupp_ps_supplycost#4717,cdepval_partsupp_ps_comment#4718,cps_availqty#4719,cps_supplycost#4720,cps_comment#4721] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#4572 AS rid_2#4590, cpfk_nation_supplier#4573 AS cpfk_nation_supplier_2#4591, cfpk_supplier_nation#4574 AS cfpk_supplier_nation_2#4592, cval_supplier_s_name#4575 AS cval_supplier_s_name_2#4593, cval_supplier_s_address#4576 AS cval_supplier_s_address_2#4594, cval_supplier_s_phone#4577 AS cval_supplier_s_phone_2#4595, cval_supplier_s_acctbal#4578 AS cval_supplier_s_acctbal_2#4596, cval_supplier_s_comment#4579 AS cval_supplier_s_comment_2#4597, cdepval_supplier_s_name#4580 AS cdepval_supplier_s_name_2#4598, cdepval_supplier_s_address#4581 AS cdepval_supplier_s_address_2#4599, cdepval_supplier_s_phone#4582 AS cdepval_supplier_s_phone_2#4600, cdepval_supplier_s_acctbal#4583 AS cdepval_supplier_s_acctbal_2#4601, cdepval_supplier_s_comment#4584 AS cdepval_supplier_s_comment_2#4602, cs_name#4585 AS cs_name_2#4603, cs_address#4586 AS cs_address_2#4604, cs_phone#4587 AS cs_phone_2#4605, cs_acctbal#4588 AS cs_acctbal_2#4606, cs_comment#4589 AS cs_comment_2#4607]
            :  +- Relation[rid#4572,cpfk_nation_supplier#4573,cfpk_supplier_nation#4574,cval_supplier_s_name#4575,cval_supplier_s_address#4576,cval_supplier_s_phone#4577,cval_supplier_s_acctbal#4578,cval_supplier_s_comment#4579,cdepval_supplier_s_name#4580,cdepval_supplier_s_address#4581,cdepval_supplier_s_phone#4582,cdepval_supplier_s_acctbal#4583,cdepval_supplier_s_comment#4584,cs_name#4585,cs_address#4586,cs_phone#4587,cs_acctbal#4588,cs_comment#4589] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_1))
               :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#4501, cval_region_r_name_0#4502, cval_region_r_comment_0#4503, cdepval_region_r_name_0#4504, cdepval_region_r_comment_0#4505, cr_name_0#4506, cr_comment_0#4507, 'rid_1]
               :  :- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
               :  :  +- Project [rid#4494 AS rid_0#4501, cval_region_r_name#4495 AS cval_region_r_name_0#4502, cval_region_r_comment#4496 AS cval_region_r_comment_0#4503, cdepval_region_r_name#4497 AS cdepval_region_r_name_0#4504, cdepval_region_r_comment#4498 AS cdepval_region_r_comment_0#4505, cr_name#4499 AS cr_name_0#4506, cr_comment#4500 AS cr_comment_0#4507]
               :  :     +- Relation[rid#4494,cval_region_r_name#4495,cval_region_r_comment#4496,cdepval_region_r_name#4497,cdepval_region_r_comment#4498,cr_name#4499,cr_comment#4500] JDBCRelation(tregion) [numPartitions=1]
               :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
               :     +- Project [rid#4554 AS rid_1#4563, cpfk_region_nation#4555 AS cpfk_region_nation_1#4564, cfpk_nation_region#4556 AS cfpk_nation_region_1#4565, cval_nation_n_name#4557 AS cval_nation_n_name_1#4566, cval_nation_n_comment#4558 AS cval_nation_n_comment_1#4567, cdepval_nation_n_name#4559 AS cdepval_nation_n_name_1#4568, cdepval_nation_n_comment#4560 AS cdepval_nation_n_comment_1#4569, cn_name#4561 AS cn_name_1#4570, cn_comment#4562 AS cn_comment_1#4571]
               :        +- Relation[rid#4554,cpfk_region_nation#4555,cfpk_nation_region#4556,cval_nation_n_name#4557,cval_nation_n_comment#4558,cdepval_nation_n_name#4559,cdepval_nation_n_comment#4560,cn_name#4561,cn_comment#4562] JDBCRelation(tnation) [numPartitions=1]
               +- Project [rid#4522 AS rid_1#4531, cpfk_region_nation#4523 AS cpfk_region_nation_1#4532, cfpk_nation_region#4524 AS cfpk_nation_region_1#4533, cval_nation_n_name#4525 AS cval_nation_n_name_1#4534, cval_nation_n_comment#4526 AS cval_nation_n_comment_1#4535, cdepval_nation_n_name#4527 AS cdepval_nation_n_name_1#4536, cdepval_nation_n_comment#4528 AS cdepval_nation_n_comment_1#4537, cn_name#4529 AS cn_name_1#4538, cn_comment#4530 AS cn_comment_1#4539]
                  +- Relation[rid#4522,cpfk_region_nation#4523,cfpk_nation_region#4524,cval_nation_n_name#4525,cval_nation_n_comment#4526,cdepval_nation_n_name#4527,cdepval_nation_n_comment#4528,cn_name#4529,cn_comment#4530] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 973ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/26 22:40:07 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:40:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4891L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:40:07 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:40:07 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:40:07 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:40:07 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:40:07 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:40:07 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:40:07 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:40:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4891L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#4918, cval_part_p_name_0#4919, cval_part_p_mfgr_0#4920, cval_part_p_type_0#4921, cval_part_p_size_0#4922, cval_part_p_container_0#4923, cval_part_p_retailprice_0#4924, cval_part_p_comment_0#4925, cval_part_p_brand_0#4926, cdepval_part_p_name_0#4927, cdepval_part_p_mfgr_0#4928, cdepval_part_p_type_0#4929, cdepval_part_p_size_0#4930, cdepval_part_p_container_0#4931, cdepval_part_p_retailprice_0#4932, cdepval_part_p_comment_0#4933, cdepval_part_p_brand_0#4934, cp_name_0#4935, cp_mfgr_0#4936, cp_type_0#4937, cp_size_0#4938, cp_container_0#4939, cp_retailprice_0#4940, cp_comment_0#4941, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#4893 AS rid_0#4918, cval_part_p_name#4894 AS cval_part_p_name_0#4919, cval_part_p_mfgr#4895 AS cval_part_p_mfgr_0#4920, cval_part_p_type#4896 AS cval_part_p_type_0#4921, cval_part_p_size#4897 AS cval_part_p_size_0#4922, cval_part_p_container#4898 AS cval_part_p_container_0#4923, cval_part_p_retailprice#4899 AS cval_part_p_retailprice_0#4924, cval_part_p_comment#4900 AS cval_part_p_comment_0#4925, cval_part_p_brand#4901 AS cval_part_p_brand_0#4926, cdepval_part_p_name#4902 AS cdepval_part_p_name_0#4927, cdepval_part_p_mfgr#4903 AS cdepval_part_p_mfgr_0#4928, cdepval_part_p_type#4904 AS cdepval_part_p_type_0#4929, cdepval_part_p_size#4905 AS cdepval_part_p_size_0#4930, cdepval_part_p_container#4906 AS cdepval_part_p_container_0#4931, cdepval_part_p_retailprice#4907 AS cdepval_part_p_retailprice_0#4932, cdepval_part_p_comment#4908 AS cdepval_part_p_comment_0#4933, cdepval_part_p_brand#4909 AS cdepval_part_p_brand_0#4934, cp_name#4910 AS cp_name_0#4935, cp_mfgr#4911 AS cp_mfgr_0#4936, cp_type#4912 AS cp_type_0#4937, cp_size#4913 AS cp_size_0#4938, cp_container#4914 AS cp_container_0#4939, cp_retailprice#4915 AS cp_retailprice_0#4940, cp_comment#4916 AS cp_comment_0#4941, cp_brand#4917 AS cp_brand_0#4942]
         :  :        +- Relation[rid#4893,cval_part_p_name#4894,cval_part_p_mfgr#4895,cval_part_p_type#4896,cval_part_p_size#4897,cval_part_p_container#4898,cval_part_p_retailprice#4899,cval_part_p_comment#4900,cval_part_p_brand#4901,cdepval_part_p_name#4902,cdepval_part_p_mfgr#4903,cdepval_part_p_type#4904,cdepval_part_p_size#4905,cdepval_part_p_container#4906,cdepval_part_p_retailprice#4907,cdepval_part_p_comment#4908,cdepval_part_p_brand#4909,cp_name#4910,cp_mfgr#4911,cp_type#4912,cp_size#4913,cp_container#4914,cp_retailprice#4915,cp_comment#4916,cp_brand#4917] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#5183 AS rid_1#5228, cpfk_orders_lineitem#5184 AS cpfk_orders_lineitem_1#5229, cpfk_supplier_lineitem#5185 AS cpfk_supplier_lineitem_1#5230, cfpk_lineitem_supplier#5186 AS cfpk_lineitem_supplier_1#5231, cfpk_lineitem_partsupp#5187 AS cfpk_lineitem_partsupp_1#5232, cpfk_part_lineitem#5188 AS cpfk_part_lineitem_1#5233, cfpk_lineitem_part#5189 AS cfpk_lineitem_part_1#5234, cpfk_partsupp_lineitem#5190 AS cpfk_partsupp_lineitem_1#5235, cfpk_lineitem_orders#5191 AS cfpk_lineitem_orders_1#5236, cval_lineitem_l_quantity#5192 AS cval_lineitem_l_quantity_1#5237, cval_lineitem_l_extendedprice#5193 AS cval_lineitem_l_extendedprice_1#5238, cval_lineitem_l_discount#5194 AS cval_lineitem_l_discount_1#5239, cval_lineitem_l_tax#5195 AS cval_lineitem_l_tax_1#5240, cval_lineitem_l_returnflag#5196 AS cval_lineitem_l_returnflag_1#5241, cval_lineitem_l_linestatus#5197 AS cval_lineitem_l_linestatus_1#5242, cval_lineitem_l_commitdate#5198 AS cval_lineitem_l_commitdate_1#5243, cval_lineitem_l_receiptdate#5199 AS cval_lineitem_l_receiptdate_1#5244, cval_lineitem_l_shipinstruct#5200 AS cval_lineitem_l_shipinstruct_1#5245, cval_lineitem_l_shipmode#5201 AS cval_lineitem_l_shipmode_1#5246, cval_lineitem_l_comment#5202 AS cval_lineitem_l_comment_1#5247, cval_lineitem_l_shipdate#5203 AS cval_lineitem_l_shipdate_1#5248, cdepval_lineitem_l_quantity#5204 AS cdepval_lineitem_l_quantity_1#5249, cdepval_lineitem_l_extendedprice#5205 AS cdepval_lineitem_l_extendedprice_1#5250, cdepval_lineitem_l_discount#5206 AS cdepval_lineitem_l_discount_1#5251, ... 21 more fields]
         :        +- Relation[rid#5183,cpfk_orders_lineitem#5184,cpfk_supplier_lineitem#5185,cfpk_lineitem_supplier#5186,cfpk_lineitem_partsupp#5187,cpfk_part_lineitem#5188,cfpk_lineitem_part#5189,cpfk_partsupp_lineitem#5190,cfpk_lineitem_orders#5191,cval_lineitem_l_quantity#5192,cval_lineitem_l_extendedprice#5193,cval_lineitem_l_discount#5194,cval_lineitem_l_tax#5195,cval_lineitem_l_returnflag#5196,cval_lineitem_l_linestatus#5197,cval_lineitem_l_commitdate#5198,cval_lineitem_l_receiptdate#5199,cval_lineitem_l_shipinstruct#5200,cval_lineitem_l_shipmode#5201,cval_lineitem_l_comment#5202,cval_lineitem_l_shipdate#5203,cdepval_lineitem_l_quantity#5204,cdepval_lineitem_l_extendedprice#5205,cdepval_lineitem_l_discount#5206,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5043 AS rid_1#5088, cpfk_orders_lineitem#5044 AS cpfk_orders_lineitem_1#5089, cpfk_supplier_lineitem#5045 AS cpfk_supplier_lineitem_1#5090, cfpk_lineitem_supplier#5046 AS cfpk_lineitem_supplier_1#5091, cfpk_lineitem_partsupp#5047 AS cfpk_lineitem_partsupp_1#5092, cpfk_part_lineitem#5048 AS cpfk_part_lineitem_1#5093, cfpk_lineitem_part#5049 AS cfpk_lineitem_part_1#5094, cpfk_partsupp_lineitem#5050 AS cpfk_partsupp_lineitem_1#5095, cfpk_lineitem_orders#5051 AS cfpk_lineitem_orders_1#5096, cval_lineitem_l_quantity#5052 AS cval_lineitem_l_quantity_1#5097, cval_lineitem_l_extendedprice#5053 AS cval_lineitem_l_extendedprice_1#5098, cval_lineitem_l_discount#5054 AS cval_lineitem_l_discount_1#5099, cval_lineitem_l_tax#5055 AS cval_lineitem_l_tax_1#5100, cval_lineitem_l_returnflag#5056 AS cval_lineitem_l_returnflag_1#5101, cval_lineitem_l_linestatus#5057 AS cval_lineitem_l_linestatus_1#5102, cval_lineitem_l_commitdate#5058 AS cval_lineitem_l_commitdate_1#5103, cval_lineitem_l_receiptdate#5059 AS cval_lineitem_l_receiptdate_1#5104, cval_lineitem_l_shipinstruct#5060 AS cval_lineitem_l_shipinstruct_1#5105, cval_lineitem_l_shipmode#5061 AS cval_lineitem_l_shipmode_1#5106, cval_lineitem_l_comment#5062 AS cval_lineitem_l_comment_1#5107, cval_lineitem_l_shipdate#5063 AS cval_lineitem_l_shipdate_1#5108, cdepval_lineitem_l_quantity#5064 AS cdepval_lineitem_l_quantity_1#5109, cdepval_lineitem_l_extendedprice#5065 AS cdepval_lineitem_l_extendedprice_1#5110, cdepval_lineitem_l_discount#5066 AS cdepval_lineitem_l_discount_1#5111, ... 21 more fields]
            +- Relation[rid#5043,cpfk_orders_lineitem#5044,cpfk_supplier_lineitem#5045,cfpk_lineitem_supplier#5046,cfpk_lineitem_partsupp#5047,cpfk_part_lineitem#5048,cfpk_lineitem_part#5049,cpfk_partsupp_lineitem#5050,cfpk_lineitem_orders#5051,cval_lineitem_l_quantity#5052,cval_lineitem_l_extendedprice#5053,cval_lineitem_l_discount#5054,cval_lineitem_l_tax#5055,cval_lineitem_l_returnflag#5056,cval_lineitem_l_linestatus#5057,cval_lineitem_l_commitdate#5058,cval_lineitem_l_receiptdate#5059,cval_lineitem_l_shipinstruct#5060,cval_lineitem_l_shipmode#5061,cval_lineitem_l_comment#5062,cval_lineitem_l_shipdate#5063,cdepval_lineitem_l_quantity#5064,cdepval_lineitem_l_extendedprice#5065,cdepval_lineitem_l_discount#5066,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 552ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/26 22:40:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:40:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5349L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:40:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5349L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#5401 AS rid_1#5446, cpfk_orders_lineitem#5402 AS cpfk_orders_lineitem_1#5447, cpfk_supplier_lineitem#5403 AS cpfk_supplier_lineitem_1#5448, cfpk_lineitem_supplier#5404 AS cfpk_lineitem_supplier_1#5449, cfpk_lineitem_partsupp#5405 AS cfpk_lineitem_partsupp_1#5450, cpfk_part_lineitem#5406 AS cpfk_part_lineitem_1#5451, cfpk_lineitem_part#5407 AS cfpk_lineitem_part_1#5452, cpfk_partsupp_lineitem#5408 AS cpfk_partsupp_lineitem_1#5453, cfpk_lineitem_orders#5409 AS cfpk_lineitem_orders_1#5454, cval_lineitem_l_quantity#5410 AS cval_lineitem_l_quantity_1#5455, cval_lineitem_l_extendedprice#5411 AS cval_lineitem_l_extendedprice_1#5456, cval_lineitem_l_discount#5412 AS cval_lineitem_l_discount_1#5457, cval_lineitem_l_tax#5413 AS cval_lineitem_l_tax_1#5458, cval_lineitem_l_returnflag#5414 AS cval_lineitem_l_returnflag_1#5459, cval_lineitem_l_linestatus#5415 AS cval_lineitem_l_linestatus_1#5460, cval_lineitem_l_commitdate#5416 AS cval_lineitem_l_commitdate_1#5461, cval_lineitem_l_receiptdate#5417 AS cval_lineitem_l_receiptdate_1#5462, cval_lineitem_l_shipinstruct#5418 AS cval_lineitem_l_shipinstruct_1#5463, cval_lineitem_l_shipmode#5419 AS cval_lineitem_l_shipmode_1#5464, cval_lineitem_l_comment#5420 AS cval_lineitem_l_comment_1#5465, cval_lineitem_l_shipdate#5421 AS cval_lineitem_l_shipdate_1#5466, cdepval_lineitem_l_quantity#5422 AS cdepval_lineitem_l_quantity_1#5467, cdepval_lineitem_l_extendedprice#5423 AS cdepval_lineitem_l_extendedprice_1#5468, cdepval_lineitem_l_discount#5424 AS cdepval_lineitem_l_discount_1#5469, ... 21 more fields]
         :  +- Relation[rid#5401,cpfk_orders_lineitem#5402,cpfk_supplier_lineitem#5403,cfpk_lineitem_supplier#5404,cfpk_lineitem_partsupp#5405,cpfk_part_lineitem#5406,cfpk_lineitem_part#5407,cpfk_partsupp_lineitem#5408,cfpk_lineitem_orders#5409,cval_lineitem_l_quantity#5410,cval_lineitem_l_extendedprice#5411,cval_lineitem_l_discount#5412,cval_lineitem_l_tax#5413,cval_lineitem_l_returnflag#5414,cval_lineitem_l_linestatus#5415,cval_lineitem_l_commitdate#5416,cval_lineitem_l_receiptdate#5417,cval_lineitem_l_shipinstruct#5418,cval_lineitem_l_shipmode#5419,cval_lineitem_l_comment#5420,cval_lineitem_l_shipdate#5421,cdepval_lineitem_l_quantity#5422,cdepval_lineitem_l_extendedprice#5423,cdepval_lineitem_l_discount#5424,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5351 AS rid_0#5376, cval_part_p_name#5352 AS cval_part_p_name_0#5377, cval_part_p_mfgr#5353 AS cval_part_p_mfgr_0#5378, cval_part_p_type#5354 AS cval_part_p_type_0#5379, cval_part_p_size#5355 AS cval_part_p_size_0#5380, cval_part_p_container#5356 AS cval_part_p_container_0#5381, cval_part_p_retailprice#5357 AS cval_part_p_retailprice_0#5382, cval_part_p_comment#5358 AS cval_part_p_comment_0#5383, cval_part_p_brand#5359 AS cval_part_p_brand_0#5384, cdepval_part_p_name#5360 AS cdepval_part_p_name_0#5385, cdepval_part_p_mfgr#5361 AS cdepval_part_p_mfgr_0#5386, cdepval_part_p_type#5362 AS cdepval_part_p_type_0#5387, cdepval_part_p_size#5363 AS cdepval_part_p_size_0#5388, cdepval_part_p_container#5364 AS cdepval_part_p_container_0#5389, cdepval_part_p_retailprice#5365 AS cdepval_part_p_retailprice_0#5390, cdepval_part_p_comment#5366 AS cdepval_part_p_comment_0#5391, cdepval_part_p_brand#5367 AS cdepval_part_p_brand_0#5392, cp_name#5368 AS cp_name_0#5393, cp_mfgr#5369 AS cp_mfgr_0#5394, cp_type#5370 AS cp_type_0#5395, cp_size#5371 AS cp_size_0#5396, cp_container#5372 AS cp_container_0#5397, cp_retailprice#5373 AS cp_retailprice_0#5398, cp_comment#5374 AS cp_comment_0#5399, cp_brand#5375 AS cp_brand_0#5400]
            +- Relation[rid#5351,cval_part_p_name#5352,cval_part_p_mfgr#5353,cval_part_p_type#5354,cval_part_p_size#5355,cval_part_p_container#5356,cval_part_p_retailprice#5357,cval_part_p_comment#5358,cval_part_p_brand#5359,cdepval_part_p_name#5360,cdepval_part_p_mfgr#5361,cdepval_part_p_type#5362,cdepval_part_p_size#5363,cdepval_part_p_container#5364,cdepval_part_p_retailprice#5365,cdepval_part_p_comment#5366,cdepval_part_p_brand#5367,cp_name#5368,cp_mfgr#5369,cp_type#5370,cp_size#5371,cp_container#5372,cp_retailprice#5373,cp_comment#5374,cp_brand#5375] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18431ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/26 22:40:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:40:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5567L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 22:40:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:40:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:40:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:40:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:40:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:40:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:40:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:40:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:40:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:40:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:40:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:40:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:40:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:40:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5567L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#5737 AS rid_4#5782, cpfk_orders_lineitem#5738 AS cpfk_orders_lineitem_4#5783, cpfk_supplier_lineitem#5739 AS cpfk_supplier_lineitem_4#5784, cfpk_lineitem_supplier#5740 AS cfpk_lineitem_supplier_4#5785, cfpk_lineitem_partsupp#5741 AS cfpk_lineitem_partsupp_4#5786, cpfk_part_lineitem#5742 AS cpfk_part_lineitem_4#5787, cfpk_lineitem_part#5743 AS cfpk_lineitem_part_4#5788, cpfk_partsupp_lineitem#5744 AS cpfk_partsupp_lineitem_4#5789, cfpk_lineitem_orders#5745 AS cfpk_lineitem_orders_4#5790, cval_lineitem_l_quantity#5746 AS cval_lineitem_l_quantity_4#5791, cval_lineitem_l_extendedprice#5747 AS cval_lineitem_l_extendedprice_4#5792, cval_lineitem_l_discount#5748 AS cval_lineitem_l_discount_4#5793, cval_lineitem_l_tax#5749 AS cval_lineitem_l_tax_4#5794, cval_lineitem_l_returnflag#5750 AS cval_lineitem_l_returnflag_4#5795, cval_lineitem_l_linestatus#5751 AS cval_lineitem_l_linestatus_4#5796, cval_lineitem_l_commitdate#5752 AS cval_lineitem_l_commitdate_4#5797, cval_lineitem_l_receiptdate#5753 AS cval_lineitem_l_receiptdate_4#5798, cval_lineitem_l_shipinstruct#5754 AS cval_lineitem_l_shipinstruct_4#5799, cval_lineitem_l_shipmode#5755 AS cval_lineitem_l_shipmode_4#5800, cval_lineitem_l_comment#5756 AS cval_lineitem_l_comment_4#5801, cval_lineitem_l_shipdate#5757 AS cval_lineitem_l_shipdate_4#5802, cdepval_lineitem_l_quantity#5758 AS cdepval_lineitem_l_quantity_4#5803, cdepval_lineitem_l_extendedprice#5759 AS cdepval_lineitem_l_extendedprice_4#5804, cdepval_lineitem_l_discount#5760 AS cdepval_lineitem_l_discount_4#5805, ... 21 more fields]
            :  :  +- Relation[rid#5737,cpfk_orders_lineitem#5738,cpfk_supplier_lineitem#5739,cfpk_lineitem_supplier#5740,cfpk_lineitem_partsupp#5741,cpfk_part_lineitem#5742,cfpk_lineitem_part#5743,cpfk_partsupp_lineitem#5744,cfpk_lineitem_orders#5745,cval_lineitem_l_quantity#5746,cval_lineitem_l_extendedprice#5747,cval_lineitem_l_discount#5748,cval_lineitem_l_tax#5749,cval_lineitem_l_returnflag#5750,cval_lineitem_l_linestatus#5751,cval_lineitem_l_commitdate#5752,cval_lineitem_l_receiptdate#5753,cval_lineitem_l_shipinstruct#5754,cval_lineitem_l_shipmode#5755,cval_lineitem_l_comment#5756,cval_lineitem_l_shipdate#5757,cdepval_lineitem_l_quantity#5758,cdepval_lineitem_l_extendedprice#5759,cdepval_lineitem_l_discount#5760,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#5689 AS rid_3#5713, cpfk_customer_orders#5690 AS cpfk_customer_orders_3#5714, cfpk_orders_customer#5691 AS cfpk_orders_customer_3#5715, cval_orders_o_orderstatus#5692 AS cval_orders_o_orderstatus_3#5716, cval_orders_o_totalprice#5693 AS cval_orders_o_totalprice_3#5717, cval_orders_o_orderpriority#5694 AS cval_orders_o_orderpriority_3#5718, cval_orders_o_clerk#5695 AS cval_orders_o_clerk_3#5719, cval_orders_o_shippriority#5696 AS cval_orders_o_shippriority_3#5720, cval_orders_o_comment#5697 AS cval_orders_o_comment_3#5721, cval_orders_o_orderdate#5698 AS cval_orders_o_orderdate_3#5722, cdepval_orders_o_orderstatus#5699 AS cdepval_orders_o_orderstatus_3#5723, cdepval_orders_o_totalprice#5700 AS cdepval_orders_o_totalprice_3#5724, cdepval_orders_o_orderpriority#5701 AS cdepval_orders_o_orderpriority_3#5725, cdepval_orders_o_clerk#5702 AS cdepval_orders_o_clerk_3#5726, cdepval_orders_o_shippriority#5703 AS cdepval_orders_o_shippriority_3#5727, cdepval_orders_o_comment#5704 AS cdepval_orders_o_comment_3#5728, cdepval_orders_o_orderdate#5705 AS cdepval_orders_o_orderdate_3#5729, co_orderstatus#5706 AS co_orderstatus_3#5730, co_totalprice#5707 AS co_totalprice_3#5731, co_orderpriority#5708 AS co_orderpriority_3#5732, co_clerk#5709 AS co_clerk_3#5733, co_shippriority#5710 AS co_shippriority_3#5734, co_comment#5711 AS co_comment_3#5735, co_orderdate#5712 AS co_orderdate_3#5736]
            :     :  +- Relation[rid#5689,cpfk_customer_orders#5690,cfpk_orders_customer#5691,cval_orders_o_orderstatus#5692,cval_orders_o_totalprice#5693,cval_orders_o_orderpriority#5694,cval_orders_o_clerk#5695,cval_orders_o_shippriority#5696,cval_orders_o_comment#5697,cval_orders_o_orderdate#5698,cdepval_orders_o_orderstatus#5699,cdepval_orders_o_totalprice#5700,cdepval_orders_o_orderpriority#5701,cdepval_orders_o_clerk#5702,cdepval_orders_o_shippriority#5703,cdepval_orders_o_comment#5704,cdepval_orders_o_orderdate#5705,co_orderstatus#5706,co_totalprice#5707,co_orderpriority#5708,co_clerk#5709,co_shippriority#5710,co_comment#5711,co_orderdate#5712] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#5647 AS rid_2#5668, cpfk_nation_customer#5648 AS cpfk_nation_customer_2#5669, cfpk_customer_nation#5649 AS cfpk_customer_nation_2#5670, cval_customer_c_name#5650 AS cval_customer_c_name_2#5671, cval_customer_c_address#5651 AS cval_customer_c_address_2#5672, cval_customer_c_phone#5652 AS cval_customer_c_phone_2#5673, cval_customer_c_acctbal#5653 AS cval_customer_c_acctbal_2#5674, cval_customer_c_comment#5654 AS cval_customer_c_comment_2#5675, cval_customer_c_mktsegment#5655 AS cval_customer_c_mktsegment_2#5676, cdepval_customer_c_name#5656 AS cdepval_customer_c_name_2#5677, cdepval_customer_c_address#5657 AS cdepval_customer_c_address_2#5678, cdepval_customer_c_phone#5658 AS cdepval_customer_c_phone_2#5679, cdepval_customer_c_acctbal#5659 AS cdepval_customer_c_acctbal_2#5680, cdepval_customer_c_comment#5660 AS cdepval_customer_c_comment_2#5681, cdepval_customer_c_mktsegment#5661 AS cdepval_customer_c_mktsegment_2#5682, cc_name#5662 AS cc_name_2#5683, cc_address#5663 AS cc_address_2#5684, cc_phone#5664 AS cc_phone_2#5685, cc_acctbal#5665 AS cc_acctbal_2#5686, cc_comment#5666 AS cc_comment_2#5687, cc_mktsegment#5667 AS cc_mktsegment_2#5688]
            :        :  +- Relation[rid#5647,cpfk_nation_customer#5648,cfpk_customer_nation#5649,cval_customer_c_name#5650,cval_customer_c_address#5651,cval_customer_c_phone#5652,cval_customer_c_acctbal#5653,cval_customer_c_comment#5654,cval_customer_c_mktsegment#5655,cdepval_customer_c_name#5656,cdepval_customer_c_address#5657,cdepval_customer_c_phone#5658,cdepval_customer_c_acctbal#5659,cdepval_customer_c_comment#5660,cdepval_customer_c_mktsegment#5661,cc_name#5662,cc_address#5663,cc_phone#5664,cc_acctbal#5665,cc_comment#5666,cc_mktsegment#5667] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join UsingJoin(Inner,List(rid_1))
            :           :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#5576, cval_region_r_name_0#5577, cval_region_r_comment_0#5578, cdepval_region_r_name_0#5579, cdepval_region_r_comment_0#5580, cr_name_0#5581, cr_comment_0#5582, 'rid_1]
            :           :  :- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :           :  :  +- Project [rid#5569 AS rid_0#5576, cval_region_r_name#5570 AS cval_region_r_name_0#5577, cval_region_r_comment#5571 AS cval_region_r_comment_0#5578, cdepval_region_r_name#5572 AS cdepval_region_r_name_0#5579, cdepval_region_r_comment#5573 AS cdepval_region_r_comment_0#5580, cr_name#5574 AS cr_name_0#5581, cr_comment#5575 AS cr_comment_0#5582]
            :           :  :     +- Relation[rid#5569,cval_region_r_name#5570,cval_region_r_comment#5571,cdepval_region_r_name#5572,cdepval_region_r_comment#5573,cr_name#5574,cr_comment#5575] JDBCRelation(tregion) [numPartitions=1]
            :           :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
            :           :     +- Project [rid#5629 AS rid_1#5638, cpfk_region_nation#5630 AS cpfk_region_nation_1#5639, cfpk_nation_region#5631 AS cfpk_nation_region_1#5640, cval_nation_n_name#5632 AS cval_nation_n_name_1#5641, cval_nation_n_comment#5633 AS cval_nation_n_comment_1#5642, cdepval_nation_n_name#5634 AS cdepval_nation_n_name_1#5643, cdepval_nation_n_comment#5635 AS cdepval_nation_n_comment_1#5644, cn_name#5636 AS cn_name_1#5645, cn_comment#5637 AS cn_comment_1#5646]
            :           :        +- Relation[rid#5629,cpfk_region_nation#5630,cfpk_nation_region#5631,cval_nation_n_name#5632,cval_nation_n_comment#5633,cdepval_nation_n_name#5634,cdepval_nation_n_comment#5635,cn_name#5636,cn_comment#5637] JDBCRelation(tnation) [numPartitions=1]
            :           +- Project [rid#5597 AS rid_1#5606, cpfk_region_nation#5598 AS cpfk_region_nation_1#5607, cfpk_nation_region#5599 AS cfpk_nation_region_1#5608, cval_nation_n_name#5600 AS cval_nation_n_name_1#5609, cval_nation_n_comment#5601 AS cval_nation_n_comment_1#5610, cdepval_nation_n_name#5602 AS cdepval_nation_n_name_1#5611, cdepval_nation_n_comment#5603 AS cdepval_nation_n_comment_1#5612, cn_name#5604 AS cn_name_1#5613, cn_comment#5605 AS cn_comment_1#5614]
            :              +- Relation[rid#5597,cpfk_region_nation#5598,cfpk_nation_region#5599,cval_nation_n_name#5600,cval_nation_n_comment#5601,cdepval_nation_n_name#5602,cdepval_nation_n_comment#5603,cn_name#5604,cn_comment#5605] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#5827 AS rid_5#5845, cpfk_nation_supplier#5828 AS cpfk_nation_supplier_5#5846, cfpk_supplier_nation#5829 AS cfpk_supplier_nation_5#5847, cval_supplier_s_name#5830 AS cval_supplier_s_name_5#5848, cval_supplier_s_address#5831 AS cval_supplier_s_address_5#5849, cval_supplier_s_phone#5832 AS cval_supplier_s_phone_5#5850, cval_supplier_s_acctbal#5833 AS cval_supplier_s_acctbal_5#5851, cval_supplier_s_comment#5834 AS cval_supplier_s_comment_5#5852, cdepval_supplier_s_name#5835 AS cdepval_supplier_s_name_5#5853, cdepval_supplier_s_address#5836 AS cdepval_supplier_s_address_5#5854, cdepval_supplier_s_phone#5837 AS cdepval_supplier_s_phone_5#5855, cdepval_supplier_s_acctbal#5838 AS cdepval_supplier_s_acctbal_5#5856, cdepval_supplier_s_comment#5839 AS cdepval_supplier_s_comment_5#5857, cs_name#5840 AS cs_name_5#5858, cs_address#5841 AS cs_address_5#5859, cs_phone#5842 AS cs_phone_5#5860, cs_acctbal#5843 AS cs_acctbal_5#5861, cs_comment#5844 AS cs_comment_5#5862]
               +- Relation[rid#5827,cpfk_nation_supplier#5828,cfpk_supplier_nation#5829,cval_supplier_s_name#5830,cval_supplier_s_address#5831,cval_supplier_s_phone#5832,cval_supplier_s_acctbal#5833,cval_supplier_s_comment#5834,cdepval_supplier_s_name#5835,cdepval_supplier_s_address#5836,cdepval_supplier_s_phone#5837,cdepval_supplier_s_acctbal#5838,cdepval_supplier_s_comment#5839,cs_name#5840,cs_address#5841,cs_phone#5842,cs_acctbal#5843,cs_comment#5844] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 30493ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/26 22:40:56 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:40:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5992L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:40:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#5992L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#5994 AS rid_0#6039, cpfk_orders_lineitem#5995 AS cpfk_orders_lineitem_0#6040, cpfk_supplier_lineitem#5996 AS cpfk_supplier_lineitem_0#6041, cfpk_lineitem_supplier#5997 AS cfpk_lineitem_supplier_0#6042, cfpk_lineitem_partsupp#5998 AS cfpk_lineitem_partsupp_0#6043, cpfk_part_lineitem#5999 AS cpfk_part_lineitem_0#6044, cfpk_lineitem_part#6000 AS cfpk_lineitem_part_0#6045, cpfk_partsupp_lineitem#6001 AS cpfk_partsupp_lineitem_0#6046, cfpk_lineitem_orders#6002 AS cfpk_lineitem_orders_0#6047, cval_lineitem_l_quantity#6003 AS cval_lineitem_l_quantity_0#6048, cval_lineitem_l_extendedprice#6004 AS cval_lineitem_l_extendedprice_0#6049, cval_lineitem_l_discount#6005 AS cval_lineitem_l_discount_0#6050, cval_lineitem_l_tax#6006 AS cval_lineitem_l_tax_0#6051, cval_lineitem_l_returnflag#6007 AS cval_lineitem_l_returnflag_0#6052, cval_lineitem_l_linestatus#6008 AS cval_lineitem_l_linestatus_0#6053, cval_lineitem_l_commitdate#6009 AS cval_lineitem_l_commitdate_0#6054, cval_lineitem_l_receiptdate#6010 AS cval_lineitem_l_receiptdate_0#6055, cval_lineitem_l_shipinstruct#6011 AS cval_lineitem_l_shipinstruct_0#6056, cval_lineitem_l_shipmode#6012 AS cval_lineitem_l_shipmode_0#6057, cval_lineitem_l_comment#6013 AS cval_lineitem_l_comment_0#6058, cval_lineitem_l_shipdate#6014 AS cval_lineitem_l_shipdate_0#6059, cdepval_lineitem_l_quantity#6015 AS cdepval_lineitem_l_quantity_0#6060, cdepval_lineitem_l_extendedprice#6016 AS cdepval_lineitem_l_extendedprice_0#6061, cdepval_lineitem_l_discount#6017 AS cdepval_lineitem_l_discount_0#6062, ... 21 more fields]
         +- Relation[rid#5994,cpfk_orders_lineitem#5995,cpfk_supplier_lineitem#5996,cfpk_lineitem_supplier#5997,cfpk_lineitem_partsupp#5998,cpfk_part_lineitem#5999,cfpk_lineitem_part#6000,cpfk_partsupp_lineitem#6001,cfpk_lineitem_orders#6002,cval_lineitem_l_quantity#6003,cval_lineitem_l_extendedprice#6004,cval_lineitem_l_discount#6005,cval_lineitem_l_tax#6006,cval_lineitem_l_returnflag#6007,cval_lineitem_l_linestatus#6008,cval_lineitem_l_commitdate#6009,cval_lineitem_l_receiptdate#6010,cval_lineitem_l_shipinstruct#6011,cval_lineitem_l_shipmode#6012,cval_lineitem_l_comment#6013,cval_lineitem_l_shipdate#6014,cdepval_lineitem_l_quantity#6015,cdepval_lineitem_l_extendedprice#6016,cdepval_lineitem_l_discount#6017,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2444ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/26 22:40:59 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:40:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6134L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:40:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:40:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:40:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:40:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:40:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:40:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:40:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:40:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6134L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6161, cval_part_p_name_0#6162, cval_part_p_mfgr_0#6163, cval_part_p_type_0#6164, cval_part_p_size_0#6165, cval_part_p_container_0#6166, cval_part_p_retailprice_0#6167, cval_part_p_comment_0#6168, cval_part_p_brand_0#6169, cdepval_part_p_name_0#6170, cdepval_part_p_mfgr_0#6171, cdepval_part_p_type_0#6172, cdepval_part_p_size_0#6173, cdepval_part_p_container_0#6174, cdepval_part_p_retailprice_0#6175, cdepval_part_p_comment_0#6176, cdepval_part_p_brand_0#6177, cp_name_0#6178, cp_mfgr_0#6179, cp_type_0#6180, cp_size_0#6181, cp_container_0#6182, cp_retailprice_0#6183, cp_comment_0#6184, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#6136 AS rid_0#6161, cval_part_p_name#6137 AS cval_part_p_name_0#6162, cval_part_p_mfgr#6138 AS cval_part_p_mfgr_0#6163, cval_part_p_type#6139 AS cval_part_p_type_0#6164, cval_part_p_size#6140 AS cval_part_p_size_0#6165, cval_part_p_container#6141 AS cval_part_p_container_0#6166, cval_part_p_retailprice#6142 AS cval_part_p_retailprice_0#6167, cval_part_p_comment#6143 AS cval_part_p_comment_0#6168, cval_part_p_brand#6144 AS cval_part_p_brand_0#6169, cdepval_part_p_name#6145 AS cdepval_part_p_name_0#6170, cdepval_part_p_mfgr#6146 AS cdepval_part_p_mfgr_0#6171, cdepval_part_p_type#6147 AS cdepval_part_p_type_0#6172, cdepval_part_p_size#6148 AS cdepval_part_p_size_0#6173, cdepval_part_p_container#6149 AS cdepval_part_p_container_0#6174, cdepval_part_p_retailprice#6150 AS cdepval_part_p_retailprice_0#6175, cdepval_part_p_comment#6151 AS cdepval_part_p_comment_0#6176, cdepval_part_p_brand#6152 AS cdepval_part_p_brand_0#6177, cp_name#6153 AS cp_name_0#6178, cp_mfgr#6154 AS cp_mfgr_0#6179, cp_type#6155 AS cp_type_0#6180, cp_size#6156 AS cp_size_0#6181, cp_container#6157 AS cp_container_0#6182, cp_retailprice#6158 AS cp_retailprice_0#6183, cp_comment#6159 AS cp_comment_0#6184, cp_brand#6160 AS cp_brand_0#6185]
         :  :        +- Relation[rid#6136,cval_part_p_name#6137,cval_part_p_mfgr#6138,cval_part_p_type#6139,cval_part_p_size#6140,cval_part_p_container#6141,cval_part_p_retailprice#6142,cval_part_p_comment#6143,cval_part_p_brand#6144,cdepval_part_p_name#6145,cdepval_part_p_mfgr#6146,cdepval_part_p_type#6147,cdepval_part_p_size#6148,cdepval_part_p_container#6149,cdepval_part_p_retailprice#6150,cdepval_part_p_comment#6151,cdepval_part_p_brand#6152,cp_name#6153,cp_mfgr#6154,cp_type#6155,cp_size#6156,cp_container#6157,cp_retailprice#6158,cp_comment#6159,cp_brand#6160] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#6606 AS rid_1#6651, cpfk_orders_lineitem#6607 AS cpfk_orders_lineitem_1#6652, cpfk_supplier_lineitem#6608 AS cpfk_supplier_lineitem_1#6653, cfpk_lineitem_supplier#6609 AS cfpk_lineitem_supplier_1#6654, cfpk_lineitem_partsupp#6610 AS cfpk_lineitem_partsupp_1#6655, cpfk_part_lineitem#6611 AS cpfk_part_lineitem_1#6656, cfpk_lineitem_part#6612 AS cfpk_lineitem_part_1#6657, cpfk_partsupp_lineitem#6613 AS cpfk_partsupp_lineitem_1#6658, cfpk_lineitem_orders#6614 AS cfpk_lineitem_orders_1#6659, cval_lineitem_l_quantity#6615 AS cval_lineitem_l_quantity_1#6660, cval_lineitem_l_extendedprice#6616 AS cval_lineitem_l_extendedprice_1#6661, cval_lineitem_l_discount#6617 AS cval_lineitem_l_discount_1#6662, cval_lineitem_l_tax#6618 AS cval_lineitem_l_tax_1#6663, cval_lineitem_l_returnflag#6619 AS cval_lineitem_l_returnflag_1#6664, cval_lineitem_l_linestatus#6620 AS cval_lineitem_l_linestatus_1#6665, cval_lineitem_l_commitdate#6621 AS cval_lineitem_l_commitdate_1#6666, cval_lineitem_l_receiptdate#6622 AS cval_lineitem_l_receiptdate_1#6667, cval_lineitem_l_shipinstruct#6623 AS cval_lineitem_l_shipinstruct_1#6668, cval_lineitem_l_shipmode#6624 AS cval_lineitem_l_shipmode_1#6669, cval_lineitem_l_comment#6625 AS cval_lineitem_l_comment_1#6670, cval_lineitem_l_shipdate#6626 AS cval_lineitem_l_shipdate_1#6671, cdepval_lineitem_l_quantity#6627 AS cdepval_lineitem_l_quantity_1#6672, cdepval_lineitem_l_extendedprice#6628 AS cdepval_lineitem_l_extendedprice_1#6673, cdepval_lineitem_l_discount#6629 AS cdepval_lineitem_l_discount_1#6674, ... 21 more fields]
         :        +- Relation[rid#6606,cpfk_orders_lineitem#6607,cpfk_supplier_lineitem#6608,cfpk_lineitem_supplier#6609,cfpk_lineitem_partsupp#6610,cpfk_part_lineitem#6611,cfpk_lineitem_part#6612,cpfk_partsupp_lineitem#6613,cfpk_lineitem_orders#6614,cval_lineitem_l_quantity#6615,cval_lineitem_l_extendedprice#6616,cval_lineitem_l_discount#6617,cval_lineitem_l_tax#6618,cval_lineitem_l_returnflag#6619,cval_lineitem_l_linestatus#6620,cval_lineitem_l_commitdate#6621,cval_lineitem_l_receiptdate#6622,cval_lineitem_l_shipinstruct#6623,cval_lineitem_l_shipmode#6624,cval_lineitem_l_comment#6625,cval_lineitem_l_shipdate#6626,cdepval_lineitem_l_quantity#6627,cdepval_lineitem_l_extendedprice#6628,cdepval_lineitem_l_discount#6629,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#6286 AS rid_1#6331, cpfk_orders_lineitem#6287 AS cpfk_orders_lineitem_1#6332, cpfk_supplier_lineitem#6288 AS cpfk_supplier_lineitem_1#6333, cfpk_lineitem_supplier#6289 AS cfpk_lineitem_supplier_1#6334, cfpk_lineitem_partsupp#6290 AS cfpk_lineitem_partsupp_1#6335, cpfk_part_lineitem#6291 AS cpfk_part_lineitem_1#6336, cfpk_lineitem_part#6292 AS cfpk_lineitem_part_1#6337, cpfk_partsupp_lineitem#6293 AS cpfk_partsupp_lineitem_1#6338, cfpk_lineitem_orders#6294 AS cfpk_lineitem_orders_1#6339, cval_lineitem_l_quantity#6295 AS cval_lineitem_l_quantity_1#6340, cval_lineitem_l_extendedprice#6296 AS cval_lineitem_l_extendedprice_1#6341, cval_lineitem_l_discount#6297 AS cval_lineitem_l_discount_1#6342, cval_lineitem_l_tax#6298 AS cval_lineitem_l_tax_1#6343, cval_lineitem_l_returnflag#6299 AS cval_lineitem_l_returnflag_1#6344, cval_lineitem_l_linestatus#6300 AS cval_lineitem_l_linestatus_1#6345, cval_lineitem_l_commitdate#6301 AS cval_lineitem_l_commitdate_1#6346, cval_lineitem_l_receiptdate#6302 AS cval_lineitem_l_receiptdate_1#6347, cval_lineitem_l_shipinstruct#6303 AS cval_lineitem_l_shipinstruct_1#6348, cval_lineitem_l_shipmode#6304 AS cval_lineitem_l_shipmode_1#6349, cval_lineitem_l_comment#6305 AS cval_lineitem_l_comment_1#6350, cval_lineitem_l_shipdate#6306 AS cval_lineitem_l_shipdate_1#6351, cdepval_lineitem_l_quantity#6307 AS cdepval_lineitem_l_quantity_1#6352, cdepval_lineitem_l_extendedprice#6308 AS cdepval_lineitem_l_extendedprice_1#6353, cdepval_lineitem_l_discount#6309 AS cdepval_lineitem_l_discount_1#6354, ... 21 more fields]
                  +- Relation[rid#6286,cpfk_orders_lineitem#6287,cpfk_supplier_lineitem#6288,cfpk_lineitem_supplier#6289,cfpk_lineitem_partsupp#6290,cpfk_part_lineitem#6291,cfpk_lineitem_part#6292,cpfk_partsupp_lineitem#6293,cfpk_lineitem_orders#6294,cval_lineitem_l_quantity#6295,cval_lineitem_l_extendedprice#6296,cval_lineitem_l_discount#6297,cval_lineitem_l_tax#6298,cval_lineitem_l_returnflag#6299,cval_lineitem_l_linestatus#6300,cval_lineitem_l_commitdate#6301,cval_lineitem_l_receiptdate#6302,cval_lineitem_l_shipinstruct#6303,cval_lineitem_l_shipmode#6304,cval_lineitem_l_comment#6305,cval_lineitem_l_shipdate#6306,cdepval_lineitem_l_quantity#6307,cdepval_lineitem_l_extendedprice#6308,cdepval_lineitem_l_discount#6309,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 18523ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/26 22:41:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:41:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6771L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 22:41:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:41:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:41:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:41:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:41:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:41:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:41:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:41:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:41:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:41:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:41:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:41:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:41:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:41:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6771L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6798, cval_part_p_name_0#6799, cval_part_p_mfgr_0#6800, cval_part_p_type_0#6801, cval_part_p_size_0#6802, cval_part_p_container_0#6803, cval_part_p_retailprice_0#6804, cval_part_p_comment_0#6805, cval_part_p_brand_0#6806, cdepval_part_p_name_0#6807, cdepval_part_p_mfgr_0#6808, cdepval_part_p_type_0#6809, cdepval_part_p_size_0#6810, cdepval_part_p_container_0#6811, cdepval_part_p_retailprice_0#6812, cdepval_part_p_comment_0#6813, cdepval_part_p_brand_0#6814, cp_name_0#6815, cp_mfgr_0#6816, cp_type_0#6817, cp_size_0#6818, cp_container_0#6819, cp_retailprice_0#6820, cp_comment_0#6821, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  :  +- Project [rid#6773 AS rid_0#6798, cval_part_p_name#6774 AS cval_part_p_name_0#6799, cval_part_p_mfgr#6775 AS cval_part_p_mfgr_0#6800, cval_part_p_type#6776 AS cval_part_p_type_0#6801, cval_part_p_size#6777 AS cval_part_p_size_0#6802, cval_part_p_container#6778 AS cval_part_p_container_0#6803, cval_part_p_retailprice#6779 AS cval_part_p_retailprice_0#6804, cval_part_p_comment#6780 AS cval_part_p_comment_0#6805, cval_part_p_brand#6781 AS cval_part_p_brand_0#6806, cdepval_part_p_name#6782 AS cdepval_part_p_name_0#6807, cdepval_part_p_mfgr#6783 AS cdepval_part_p_mfgr_0#6808, cdepval_part_p_type#6784 AS cdepval_part_p_type_0#6809, cdepval_part_p_size#6785 AS cdepval_part_p_size_0#6810, cdepval_part_p_container#6786 AS cdepval_part_p_container_0#6811, cdepval_part_p_retailprice#6787 AS cdepval_part_p_retailprice_0#6812, cdepval_part_p_comment#6788 AS cdepval_part_p_comment_0#6813, cdepval_part_p_brand#6789 AS cdepval_part_p_brand_0#6814, cp_name#6790 AS cp_name_0#6815, cp_mfgr#6791 AS cp_mfgr_0#6816, cp_type#6792 AS cp_type_0#6817, cp_size#6793 AS cp_size_0#6818, cp_container#6794 AS cp_container_0#6819, cp_retailprice#6795 AS cp_retailprice_0#6820, cp_comment#6796 AS cp_comment_0#6821, cp_brand#6797 AS cp_brand_0#6822]
         :  :  :     +- Relation[rid#6773,cval_part_p_name#6774,cval_part_p_mfgr#6775,cval_part_p_type#6776,cval_part_p_size#6777,cval_part_p_container#6778,cval_part_p_retailprice#6779,cval_part_p_comment#6780,cval_part_p_brand#6781,cdepval_part_p_name#6782,cdepval_part_p_mfgr#6783,cdepval_part_p_type#6784,cdepval_part_p_size#6785,cdepval_part_p_container#6786,cdepval_part_p_retailprice#6787,cdepval_part_p_comment#6788,cdepval_part_p_brand#6789,cp_name#6790,cp_mfgr#6791,cp_type#6792,cp_size#6793,cp_container#6794,cp_retailprice#6795,cp_comment#6796,cp_brand#6797] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :  :     +- Project [rid#6951 AS rid_1#6965, cpfk_part_partsupp#6952 AS cpfk_part_partsupp_1#6966, cfpk_partsupp_part#6953 AS cfpk_partsupp_part_1#6967, cpfk_supplier_partsupp#6954 AS cpfk_supplier_partsupp_1#6968, cfpk_partsupp_supplier#6955 AS cfpk_partsupp_supplier_1#6969, cval_partsupp_ps_availqty#6956 AS cval_partsupp_ps_availqty_1#6970, cval_partsupp_ps_supplycost#6957 AS cval_partsupp_ps_supplycost_1#6971, cval_partsupp_ps_comment#6958 AS cval_partsupp_ps_comment_1#6972, cdepval_partsupp_ps_availqty#6959 AS cdepval_partsupp_ps_availqty_1#6973, cdepval_partsupp_ps_supplycost#6960 AS cdepval_partsupp_ps_supplycost_1#6974, cdepval_partsupp_ps_comment#6961 AS cdepval_partsupp_ps_comment_1#6975, cps_availqty#6962 AS cps_availqty_1#6976, cps_supplycost#6963 AS cps_supplycost_1#6977, cps_comment#6964 AS cps_comment_1#6978]
         :  :        +- Relation[rid#6951,cpfk_part_partsupp#6952,cfpk_partsupp_part#6953,cpfk_supplier_partsupp#6954,cfpk_partsupp_supplier#6955,cval_partsupp_ps_availqty#6956,cval_partsupp_ps_supplycost#6957,cval_partsupp_ps_comment#6958,cdepval_partsupp_ps_availqty#6959,cdepval_partsupp_ps_supplycost#6960,cdepval_partsupp_ps_comment#6961,cps_availqty#6962,cps_supplycost#6963,cps_comment#6964] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#6873 AS rid_1#6887, cpfk_part_partsupp#6874 AS cpfk_part_partsupp_1#6888, cfpk_partsupp_part#6875 AS cfpk_partsupp_part_1#6889, cpfk_supplier_partsupp#6876 AS cpfk_supplier_partsupp_1#6890, cfpk_partsupp_supplier#6877 AS cfpk_partsupp_supplier_1#6891, cval_partsupp_ps_availqty#6878 AS cval_partsupp_ps_availqty_1#6892, cval_partsupp_ps_supplycost#6879 AS cval_partsupp_ps_supplycost_1#6893, cval_partsupp_ps_comment#6880 AS cval_partsupp_ps_comment_1#6894, cdepval_partsupp_ps_availqty#6881 AS cdepval_partsupp_ps_availqty_1#6895, cdepval_partsupp_ps_supplycost#6882 AS cdepval_partsupp_ps_supplycost_1#6896, cdepval_partsupp_ps_comment#6883 AS cdepval_partsupp_ps_comment_1#6897, cps_availqty#6884 AS cps_availqty_1#6898, cps_supplycost#6885 AS cps_supplycost_1#6899, cps_comment#6886 AS cps_comment_1#6900]
         :     +- Relation[rid#6873,cpfk_part_partsupp#6874,cfpk_partsupp_part#6875,cpfk_supplier_partsupp#6876,cfpk_partsupp_supplier#6877,cval_partsupp_ps_availqty#6878,cval_partsupp_ps_supplycost#6879,cval_partsupp_ps_comment#6880,cdepval_partsupp_ps_availqty#6881,cdepval_partsupp_ps_supplycost#6882,cdepval_partsupp_ps_comment#6883,cps_availqty#6884,cps_supplycost#6885,cps_comment#6886] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_2, NotMaterialized, NotMaterialized, [rid_2#6988, cpfk_region_nation_2#6989, cfpk_nation_region_2#6990, cval_nation_n_name_2#6991, cval_nation_n_comment_2#6992, cdepval_nation_n_name_2#6993, cdepval_nation_n_comment_2#6994, cn_name_2#6995, cn_comment_2#6996, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
            :  :  +- Project [rid#6979 AS rid_2#6988, cpfk_region_nation#6980 AS cpfk_region_nation_2#6989, cfpk_nation_region#6981 AS cfpk_nation_region_2#6990, cval_nation_n_name#6982 AS cval_nation_n_name_2#6991, cval_nation_n_comment#6983 AS cval_nation_n_comment_2#6992, cdepval_nation_n_name#6984 AS cdepval_nation_n_name_2#6993, cdepval_nation_n_comment#6985 AS cdepval_nation_n_comment_2#6994, cn_name#6986 AS cn_name_2#6995, cn_comment#6987 AS cn_comment_2#6996]
            :  :     +- Relation[rid#6979,cpfk_region_nation#6980,cfpk_nation_region#6981,cval_nation_n_name#6982,cval_nation_n_comment#6983,cdepval_nation_n_name#6984,cdepval_nation_n_comment#6985,cn_name#6986,cn_comment#6987] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#7069 AS rid_3#7087, cpfk_nation_supplier#7070 AS cpfk_nation_supplier_3#7088, cfpk_supplier_nation#7071 AS cfpk_supplier_nation_3#7089, cval_supplier_s_name#7072 AS cval_supplier_s_name_3#7090, cval_supplier_s_address#7073 AS cval_supplier_s_address_3#7091, cval_supplier_s_phone#7074 AS cval_supplier_s_phone_3#7092, cval_supplier_s_acctbal#7075 AS cval_supplier_s_acctbal_3#7093, cval_supplier_s_comment#7076 AS cval_supplier_s_comment_3#7094, cdepval_supplier_s_name#7077 AS cdepval_supplier_s_name_3#7095, cdepval_supplier_s_address#7078 AS cdepval_supplier_s_address_3#7096, cdepval_supplier_s_phone#7079 AS cdepval_supplier_s_phone_3#7097, cdepval_supplier_s_acctbal#7080 AS cdepval_supplier_s_acctbal_3#7098, cdepval_supplier_s_comment#7081 AS cdepval_supplier_s_comment_3#7099, cs_name#7082 AS cs_name_3#7100, cs_address#7083 AS cs_address_3#7101, cs_phone#7084 AS cs_phone_3#7102, cs_acctbal#7085 AS cs_acctbal_3#7103, cs_comment#7086 AS cs_comment_3#7104]
            :        +- Relation[rid#7069,cpfk_nation_supplier#7070,cfpk_supplier_nation#7071,cval_supplier_s_name#7072,cval_supplier_s_address#7073,cval_supplier_s_phone#7074,cval_supplier_s_acctbal#7075,cval_supplier_s_comment#7076,cdepval_supplier_s_name#7077,cdepval_supplier_s_address#7078,cdepval_supplier_s_phone#7079,cdepval_supplier_s_acctbal#7080,cdepval_supplier_s_comment#7081,cs_name#7082,cs_address#7083,cs_phone#7084,cs_acctbal#7085,cs_comment#7086] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#7015 AS rid_3#7033, cpfk_nation_supplier#7016 AS cpfk_nation_supplier_3#7034, cfpk_supplier_nation#7017 AS cfpk_supplier_nation_3#7035, cval_supplier_s_name#7018 AS cval_supplier_s_name_3#7036, cval_supplier_s_address#7019 AS cval_supplier_s_address_3#7037, cval_supplier_s_phone#7020 AS cval_supplier_s_phone_3#7038, cval_supplier_s_acctbal#7021 AS cval_supplier_s_acctbal_3#7039, cval_supplier_s_comment#7022 AS cval_supplier_s_comment_3#7040, cdepval_supplier_s_name#7023 AS cdepval_supplier_s_name_3#7041, cdepval_supplier_s_address#7024 AS cdepval_supplier_s_address_3#7042, cdepval_supplier_s_phone#7025 AS cdepval_supplier_s_phone_3#7043, cdepval_supplier_s_acctbal#7026 AS cdepval_supplier_s_acctbal_3#7044, cdepval_supplier_s_comment#7027 AS cdepval_supplier_s_comment_3#7045, cs_name#7028 AS cs_name_3#7046, cs_address#7029 AS cs_address_3#7047, cs_phone#7030 AS cs_phone_3#7048, cs_acctbal#7031 AS cs_acctbal_3#7049, cs_comment#7032 AS cs_comment_3#7050]
               +- Relation[rid#7015,cpfk_nation_supplier#7016,cfpk_supplier_nation#7017,cval_supplier_s_name#7018,cval_supplier_s_address#7019,cval_supplier_s_phone#7020,cval_supplier_s_acctbal#7021,cval_supplier_s_comment#7022,cdepval_supplier_s_name#7023,cdepval_supplier_s_address#7024,cdepval_supplier_s_phone#7025,cdepval_supplier_s_acctbal#7026,cdepval_supplier_s_comment#7027,cs_name#7028,cs_address#7029,cs_phone#7030,cs_acctbal#7031,cs_comment#7032] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 908ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/26 22:41:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:41:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7175L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 22:41:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:41:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:41:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:41:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:41:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:41:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:41:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:41:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:41:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:41:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7175L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#7177 AS rid_0#7222, cpfk_orders_lineitem#7178 AS cpfk_orders_lineitem_0#7223, cpfk_supplier_lineitem#7179 AS cpfk_supplier_lineitem_0#7224, cfpk_lineitem_supplier#7180 AS cfpk_lineitem_supplier_0#7225, cfpk_lineitem_partsupp#7181 AS cfpk_lineitem_partsupp_0#7226, cpfk_part_lineitem#7182 AS cpfk_part_lineitem_0#7227, cfpk_lineitem_part#7183 AS cfpk_lineitem_part_0#7228, cpfk_partsupp_lineitem#7184 AS cpfk_partsupp_lineitem_0#7229, cfpk_lineitem_orders#7185 AS cfpk_lineitem_orders_0#7230, cval_lineitem_l_quantity#7186 AS cval_lineitem_l_quantity_0#7231, cval_lineitem_l_extendedprice#7187 AS cval_lineitem_l_extendedprice_0#7232, cval_lineitem_l_discount#7188 AS cval_lineitem_l_discount_0#7233, cval_lineitem_l_tax#7189 AS cval_lineitem_l_tax_0#7234, cval_lineitem_l_returnflag#7190 AS cval_lineitem_l_returnflag_0#7235, cval_lineitem_l_linestatus#7191 AS cval_lineitem_l_linestatus_0#7236, cval_lineitem_l_commitdate#7192 AS cval_lineitem_l_commitdate_0#7237, cval_lineitem_l_receiptdate#7193 AS cval_lineitem_l_receiptdate_0#7238, cval_lineitem_l_shipinstruct#7194 AS cval_lineitem_l_shipinstruct_0#7239, cval_lineitem_l_shipmode#7195 AS cval_lineitem_l_shipmode_0#7240, cval_lineitem_l_comment#7196 AS cval_lineitem_l_comment_0#7241, cval_lineitem_l_shipdate#7197 AS cval_lineitem_l_shipdate_0#7242, cdepval_lineitem_l_quantity#7198 AS cdepval_lineitem_l_quantity_0#7243, cdepval_lineitem_l_extendedprice#7199 AS cdepval_lineitem_l_extendedprice_0#7244, cdepval_lineitem_l_discount#7200 AS cdepval_lineitem_l_discount_0#7245, ... 21 more fields]
         :  +- Relation[rid#7177,cpfk_orders_lineitem#7178,cpfk_supplier_lineitem#7179,cfpk_lineitem_supplier#7180,cfpk_lineitem_partsupp#7181,cpfk_part_lineitem#7182,cfpk_lineitem_part#7183,cpfk_partsupp_lineitem#7184,cfpk_lineitem_orders#7185,cval_lineitem_l_quantity#7186,cval_lineitem_l_extendedprice#7187,cval_lineitem_l_discount#7188,cval_lineitem_l_tax#7189,cval_lineitem_l_returnflag#7190,cval_lineitem_l_linestatus#7191,cval_lineitem_l_commitdate#7192,cval_lineitem_l_receiptdate#7193,cval_lineitem_l_shipinstruct#7194,cval_lineitem_l_shipmode#7195,cval_lineitem_l_comment#7196,cval_lineitem_l_shipdate#7197,cdepval_lineitem_l_quantity#7198,cdepval_lineitem_l_extendedprice#7199,cdepval_lineitem_l_discount#7200,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#7636, cpfk_region_nation_4#7637, cfpk_nation_region_4#7638, cval_nation_n_name_4#7639, cval_nation_n_comment_4#7640, cdepval_nation_n_name_4#7641, cdepval_nation_n_comment_4#7642, cn_name_4#7643, cn_comment_4#7644, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
            :  :  +- Project [rid#7627 AS rid_4#7636, cpfk_region_nation#7628 AS cpfk_region_nation_4#7637, cfpk_nation_region#7629 AS cfpk_nation_region_4#7638, cval_nation_n_name#7630 AS cval_nation_n_name_4#7639, cval_nation_n_comment#7631 AS cval_nation_n_comment_4#7640, cdepval_nation_n_name#7632 AS cdepval_nation_n_name_4#7641, cdepval_nation_n_comment#7633 AS cdepval_nation_n_comment_4#7642, cn_name#7634 AS cn_name_4#7643, cn_comment#7635 AS cn_comment_4#7644]
            :  :     +- Relation[rid#7627,cpfk_region_nation#7628,cfpk_nation_region#7629,cval_nation_n_name#7630,cval_nation_n_comment#7631,cdepval_nation_n_name#7632,cdepval_nation_n_comment#7633,cn_name#7634,cn_comment#7635] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#7681 AS rid_3#7699, cpfk_nation_supplier#7682 AS cpfk_nation_supplier_3#7700, cfpk_supplier_nation#7683 AS cfpk_supplier_nation_3#7701, cval_supplier_s_name#7684 AS cval_supplier_s_name_3#7702, cval_supplier_s_address#7685 AS cval_supplier_s_address_3#7703, cval_supplier_s_phone#7686 AS cval_supplier_s_phone_3#7704, cval_supplier_s_acctbal#7687 AS cval_supplier_s_acctbal_3#7705, cval_supplier_s_comment#7688 AS cval_supplier_s_comment_3#7706, cdepval_supplier_s_name#7689 AS cdepval_supplier_s_name_3#7707, cdepval_supplier_s_address#7690 AS cdepval_supplier_s_address_3#7708, cdepval_supplier_s_phone#7691 AS cdepval_supplier_s_phone_3#7709, cdepval_supplier_s_acctbal#7692 AS cdepval_supplier_s_acctbal_3#7710, cdepval_supplier_s_comment#7693 AS cdepval_supplier_s_comment_3#7711, cs_name#7694 AS cs_name_3#7712, cs_address#7695 AS cs_address_3#7713, cs_phone#7696 AS cs_phone_3#7714, cs_acctbal#7697 AS cs_acctbal_3#7715, cs_comment#7698 AS cs_comment_3#7716]
            :        +- Relation[rid#7681,cpfk_nation_supplier#7682,cfpk_supplier_nation#7683,cval_supplier_s_name#7684,cval_supplier_s_address#7685,cval_supplier_s_phone#7686,cval_supplier_s_acctbal#7687,cval_supplier_s_comment#7688,cdepval_supplier_s_name#7689,cdepval_supplier_s_address#7690,cdepval_supplier_s_phone#7691,cdepval_supplier_s_acctbal#7692,cdepval_supplier_s_comment#7693,cs_name#7694,cs_address#7695,cs_phone#7696,cs_acctbal#7697,cs_comment#7698] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'DexPkfkMaterializationAwareJoin orders~lineitem, 'cpfk_orders_lineitem_2, 'rid_1, NotMaterialized, NotMaterialized, [rid_1#7291, cpfk_customer_orders_1#7292, cfpk_orders_customer_1#7293, cval_orders_o_orderstatus_1#7294, cval_orders_o_totalprice_1#7295, cval_orders_o_orderpriority_1#7296, cval_orders_o_clerk_1#7297, cval_orders_o_shippriority_1#7298, cval_orders_o_comment_1#7299, cval_orders_o_orderdate_1#7300, cdepval_orders_o_orderstatus_1#7301, cdepval_orders_o_totalprice_1#7302, cdepval_orders_o_orderpriority_1#7303, cdepval_orders_o_clerk_1#7304, cdepval_orders_o_shippriority_1#7305, cdepval_orders_o_comment_1#7306, cdepval_orders_o_orderdate_1#7307, co_orderstatus_1#7308, co_totalprice_1#7309, co_orderpriority_1#7310, co_clerk_1#7311, co_shippriority_1#7312, co_comment_1#7313, co_orderdate_1#7314, 'rid_2]
               :  :  :- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
               :  :  :  +- Project [rid#7267 AS rid_1#7291, cpfk_customer_orders#7268 AS cpfk_customer_orders_1#7292, cfpk_orders_customer#7269 AS cfpk_orders_customer_1#7293, cval_orders_o_orderstatus#7270 AS cval_orders_o_orderstatus_1#7294, cval_orders_o_totalprice#7271 AS cval_orders_o_totalprice_1#7295, cval_orders_o_orderpriority#7272 AS cval_orders_o_orderpriority_1#7296, cval_orders_o_clerk#7273 AS cval_orders_o_clerk_1#7297, cval_orders_o_shippriority#7274 AS cval_orders_o_shippriority_1#7298, cval_orders_o_comment#7275 AS cval_orders_o_comment_1#7299, cval_orders_o_orderdate#7276 AS cval_orders_o_orderdate_1#7300, cdepval_orders_o_orderstatus#7277 AS cdepval_orders_o_orderstatus_1#7301, cdepval_orders_o_totalprice#7278 AS cdepval_orders_o_totalprice_1#7302, cdepval_orders_o_orderpriority#7279 AS cdepval_orders_o_orderpriority_1#7303, cdepval_orders_o_clerk#7280 AS cdepval_orders_o_clerk_1#7304, cdepval_orders_o_shippriority#7281 AS cdepval_orders_o_shippriority_1#7305, cdepval_orders_o_comment#7282 AS cdepval_orders_o_comment_1#7306, cdepval_orders_o_orderdate#7283 AS cdepval_orders_o_orderdate_1#7307, co_orderstatus#7284 AS co_orderstatus_1#7308, co_totalprice#7285 AS co_totalprice_1#7309, co_orderpriority#7286 AS co_orderpriority_1#7310, co_clerk#7287 AS co_clerk_1#7311, co_shippriority#7288 AS co_shippriority_1#7312, co_comment#7289 AS co_comment_1#7313, co_orderdate#7290 AS co_orderdate_1#7314]
               :  :  :     +- Relation[rid#7267,cpfk_customer_orders#7268,cfpk_orders_customer#7269,cval_orders_o_orderstatus#7270,cval_orders_o_totalprice#7271,cval_orders_o_orderpriority#7272,cval_orders_o_clerk#7273,cval_orders_o_shippriority#7274,cval_orders_o_comment#7275,cval_orders_o_orderdate#7276,cdepval_orders_o_orderstatus#7277,cdepval_orders_o_totalprice#7278,cdepval_orders_o_orderpriority#7279,cdepval_orders_o_clerk#7280,cdepval_orders_o_shippriority#7281,cdepval_orders_o_comment#7282,cdepval_orders_o_orderdate#7283,co_orderstatus#7284,co_totalprice#7285,co_orderpriority#7286,co_clerk#7287,co_shippriority#7288,co_comment#7289,co_orderdate#7290] JDBCRelation(torders) [numPartitions=1]
               :  :  +- 'Project ['cpfk_orders_lineitem_2, 'rid_2]
               :  :     +- Project [rid#7501 AS rid_2#7546, cpfk_orders_lineitem#7502 AS cpfk_orders_lineitem_2#7547, cpfk_supplier_lineitem#7503 AS cpfk_supplier_lineitem_2#7548, cfpk_lineitem_supplier#7504 AS cfpk_lineitem_supplier_2#7549, cfpk_lineitem_partsupp#7505 AS cfpk_lineitem_partsupp_2#7550, cpfk_part_lineitem#7506 AS cpfk_part_lineitem_2#7551, cfpk_lineitem_part#7507 AS cfpk_lineitem_part_2#7552, cpfk_partsupp_lineitem#7508 AS cpfk_partsupp_lineitem_2#7553, cfpk_lineitem_orders#7509 AS cfpk_lineitem_orders_2#7554, cval_lineitem_l_quantity#7510 AS cval_lineitem_l_quantity_2#7555, cval_lineitem_l_extendedprice#7511 AS cval_lineitem_l_extendedprice_2#7556, cval_lineitem_l_discount#7512 AS cval_lineitem_l_discount_2#7557, cval_lineitem_l_tax#7513 AS cval_lineitem_l_tax_2#7558, cval_lineitem_l_returnflag#7514 AS cval_lineitem_l_returnflag_2#7559, cval_lineitem_l_linestatus#7515 AS cval_lineitem_l_linestatus_2#7560, cval_lineitem_l_commitdate#7516 AS cval_lineitem_l_commitdate_2#7561, cval_lineitem_l_receiptdate#7517 AS cval_lineitem_l_receiptdate_2#7562, cval_lineitem_l_shipinstruct#7518 AS cval_lineitem_l_shipinstruct_2#7563, cval_lineitem_l_shipmode#7519 AS cval_lineitem_l_shipmode_2#7564, cval_lineitem_l_comment#7520 AS cval_lineitem_l_comment_2#7565, cval_lineitem_l_shipdate#7521 AS cval_lineitem_l_shipdate_2#7566, cdepval_lineitem_l_quantity#7522 AS cdepval_lineitem_l_quantity_2#7567, cdepval_lineitem_l_extendedprice#7523 AS cdepval_lineitem_l_extendedprice_2#7568, cdepval_lineitem_l_discount#7524 AS cdepval_lineitem_l_discount_2#7569, ... 21 more fields]
               :  :        +- Relation[rid#7501,cpfk_orders_lineitem#7502,cpfk_supplier_lineitem#7503,cfpk_lineitem_supplier#7504,cfpk_lineitem_partsupp#7505,cpfk_part_lineitem#7506,cfpk_lineitem_part#7507,cpfk_partsupp_lineitem#7508,cfpk_lineitem_orders#7509,cval_lineitem_l_quantity#7510,cval_lineitem_l_extendedprice#7511,cval_lineitem_l_discount#7512,cval_lineitem_l_tax#7513,cval_lineitem_l_returnflag#7514,cval_lineitem_l_linestatus#7515,cval_lineitem_l_commitdate#7516,cval_lineitem_l_receiptdate#7517,cval_lineitem_l_shipinstruct#7518,cval_lineitem_l_shipmode#7519,cval_lineitem_l_comment#7520,cval_lineitem_l_shipdate#7521,cdepval_lineitem_l_quantity#7522,cdepval_lineitem_l_extendedprice#7523,cdepval_lineitem_l_discount#7524,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               :  +- Project [rid#7363 AS rid_2#7408, cpfk_orders_lineitem#7364 AS cpfk_orders_lineitem_2#7409, cpfk_supplier_lineitem#7365 AS cpfk_supplier_lineitem_2#7410, cfpk_lineitem_supplier#7366 AS cfpk_lineitem_supplier_2#7411, cfpk_lineitem_partsupp#7367 AS cfpk_lineitem_partsupp_2#7412, cpfk_part_lineitem#7368 AS cpfk_part_lineitem_2#7413, cfpk_lineitem_part#7369 AS cfpk_lineitem_part_2#7414, cpfk_partsupp_lineitem#7370 AS cpfk_partsupp_lineitem_2#7415, cfpk_lineitem_orders#7371 AS cfpk_lineitem_orders_2#7416, cval_lineitem_l_quantity#7372 AS cval_lineitem_l_quantity_2#7417, cval_lineitem_l_extendedprice#7373 AS cval_lineitem_l_extendedprice_2#7418, cval_lineitem_l_discount#7374 AS cval_lineitem_l_discount_2#7419, cval_lineitem_l_tax#7375 AS cval_lineitem_l_tax_2#7420, cval_lineitem_l_returnflag#7376 AS cval_lineitem_l_returnflag_2#7421, cval_lineitem_l_linestatus#7377 AS cval_lineitem_l_linestatus_2#7422, cval_lineitem_l_commitdate#7378 AS cval_lineitem_l_commitdate_2#7423, cval_lineitem_l_receiptdate#7379 AS cval_lineitem_l_receiptdate_2#7424, cval_lineitem_l_shipinstruct#7380 AS cval_lineitem_l_shipinstruct_2#7425, cval_lineitem_l_shipmode#7381 AS cval_lineitem_l_shipmode_2#7426, cval_lineitem_l_comment#7382 AS cval_lineitem_l_comment_2#7427, cval_lineitem_l_shipdate#7383 AS cval_lineitem_l_shipdate_2#7428, cdepval_lineitem_l_quantity#7384 AS cdepval_lineitem_l_quantity_2#7429, cdepval_lineitem_l_extendedprice#7385 AS cdepval_lineitem_l_extendedprice_2#7430, cdepval_lineitem_l_discount#7386 AS cdepval_lineitem_l_discount_2#7431, ... 21 more fields]
               :     +- Relation[rid#7363,cpfk_orders_lineitem#7364,cpfk_supplier_lineitem#7365,cfpk_lineitem_supplier#7366,cfpk_lineitem_partsupp#7367,cpfk_part_lineitem#7368,cfpk_lineitem_part#7369,cpfk_partsupp_lineitem#7370,cfpk_lineitem_orders#7371,cval_lineitem_l_quantity#7372,cval_lineitem_l_extendedprice#7373,cval_lineitem_l_discount#7374,cval_lineitem_l_tax#7375,cval_lineitem_l_returnflag#7376,cval_lineitem_l_linestatus#7377,cval_lineitem_l_commitdate#7378,cval_lineitem_l_receiptdate#7379,cval_lineitem_l_shipinstruct#7380,cval_lineitem_l_shipmode#7381,cval_lineitem_l_comment#7382,cval_lineitem_l_shipdate#7383,cdepval_lineitem_l_quantity#7384,cdepval_lineitem_l_extendedprice#7385,cdepval_lineitem_l_discount#7386,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               +- Project [rid#7591 AS rid_3#7609, cpfk_nation_supplier#7592 AS cpfk_nation_supplier_3#7610, cfpk_supplier_nation#7593 AS cfpk_supplier_nation_3#7611, cval_supplier_s_name#7594 AS cval_supplier_s_name_3#7612, cval_supplier_s_address#7595 AS cval_supplier_s_address_3#7613, cval_supplier_s_phone#7596 AS cval_supplier_s_phone_3#7614, cval_supplier_s_acctbal#7597 AS cval_supplier_s_acctbal_3#7615, cval_supplier_s_comment#7598 AS cval_supplier_s_comment_3#7616, cdepval_supplier_s_name#7599 AS cdepval_supplier_s_name_3#7617, cdepval_supplier_s_address#7600 AS cdepval_supplier_s_address_3#7618, cdepval_supplier_s_phone#7601 AS cdepval_supplier_s_phone_3#7619, cdepval_supplier_s_acctbal#7602 AS cdepval_supplier_s_acctbal_3#7620, cdepval_supplier_s_comment#7603 AS cdepval_supplier_s_comment_3#7621, cs_name#7604 AS cs_name_3#7622, cs_address#7605 AS cs_address_3#7623, cs_phone#7606 AS cs_phone_3#7624, cs_acctbal#7607 AS cs_acctbal_3#7625, cs_comment#7608 AS cs_comment_3#7626]
                  +- Relation[rid#7591,cpfk_nation_supplier#7592,cfpk_supplier_nation#7593,cval_supplier_s_name#7594,cval_supplier_s_address#7595,cval_supplier_s_phone#7596,cval_supplier_s_acctbal#7597,cval_supplier_s_comment#7598,cdepval_supplier_s_name#7599,cdepval_supplier_s_address#7600,cdepval_supplier_s_phone#7601,cdepval_supplier_s_acctbal#7602,cdepval_supplier_s_comment#7603,cs_name#7604,cs_address#7605,cs_phone#7606,cs_acctbal#7607,cs_comment#7608] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 171914ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/26 22:44:10 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:44:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7865L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 22:44:10 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:44:10 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:44:10 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:44:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7865L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#7892, cval_part_p_name_0#7893, cval_part_p_mfgr_0#7894, cval_part_p_type_0#7895, cval_part_p_size_0#7896, cval_part_p_container_0#7897, cval_part_p_retailprice_0#7898, cval_part_p_comment_0#7899, cval_part_p_brand_0#7900, cdepval_part_p_name_0#7901, cdepval_part_p_mfgr_0#7902, cdepval_part_p_type_0#7903, cdepval_part_p_size_0#7904, cdepval_part_p_container_0#7905, cdepval_part_p_retailprice_0#7906, cdepval_part_p_comment_0#7907, cdepval_part_p_brand_0#7908, cp_name_0#7909, cp_mfgr_0#7910, cp_type_0#7911, cp_size_0#7912, cp_container_0#7913, cp_retailprice_0#7914, cp_comment_0#7915, ... 2 more fields]
         :  :- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  +- Project [rid#7867 AS rid_0#7892, cval_part_p_name#7868 AS cval_part_p_name_0#7893, cval_part_p_mfgr#7869 AS cval_part_p_mfgr_0#7894, cval_part_p_type#7870 AS cval_part_p_type_0#7895, cval_part_p_size#7871 AS cval_part_p_size_0#7896, cval_part_p_container#7872 AS cval_part_p_container_0#7897, cval_part_p_retailprice#7873 AS cval_part_p_retailprice_0#7898, cval_part_p_comment#7874 AS cval_part_p_comment_0#7899, cval_part_p_brand#7875 AS cval_part_p_brand_0#7900, cdepval_part_p_name#7876 AS cdepval_part_p_name_0#7901, cdepval_part_p_mfgr#7877 AS cdepval_part_p_mfgr_0#7902, cdepval_part_p_type#7878 AS cdepval_part_p_type_0#7903, cdepval_part_p_size#7879 AS cdepval_part_p_size_0#7904, cdepval_part_p_container#7880 AS cdepval_part_p_container_0#7905, cdepval_part_p_retailprice#7881 AS cdepval_part_p_retailprice_0#7906, cdepval_part_p_comment#7882 AS cdepval_part_p_comment_0#7907, cdepval_part_p_brand#7883 AS cdepval_part_p_brand_0#7908, cp_name#7884 AS cp_name_0#7909, cp_mfgr#7885 AS cp_mfgr_0#7910, cp_type#7886 AS cp_type_0#7911, cp_size#7887 AS cp_size_0#7912, cp_container#7888 AS cp_container_0#7913, cp_retailprice#7889 AS cp_retailprice_0#7914, cp_comment#7890 AS cp_comment_0#7915, cp_brand#7891 AS cp_brand_0#7916]
         :  :     +- Relation[rid#7867,cval_part_p_name#7868,cval_part_p_mfgr#7869,cval_part_p_type#7870,cval_part_p_size#7871,cval_part_p_container#7872,cval_part_p_retailprice#7873,cval_part_p_comment#7874,cval_part_p_brand#7875,cdepval_part_p_name#7876,cdepval_part_p_mfgr#7877,cdepval_part_p_type#7878,cdepval_part_p_size#7879,cdepval_part_p_container#7880,cdepval_part_p_retailprice#7881,cdepval_part_p_comment#7882,cdepval_part_p_brand#7883,cp_name#7884,cp_mfgr#7885,cp_type#7886,cp_size#7887,cp_container#7888,cp_retailprice#7889,cp_comment#7890,cp_brand#7891] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :     +- Project [rid#8045 AS rid_1#8059, cpfk_part_partsupp#8046 AS cpfk_part_partsupp_1#8060, cfpk_partsupp_part#8047 AS cfpk_partsupp_part_1#8061, cpfk_supplier_partsupp#8048 AS cpfk_supplier_partsupp_1#8062, cfpk_partsupp_supplier#8049 AS cfpk_partsupp_supplier_1#8063, cval_partsupp_ps_availqty#8050 AS cval_partsupp_ps_availqty_1#8064, cval_partsupp_ps_supplycost#8051 AS cval_partsupp_ps_supplycost_1#8065, cval_partsupp_ps_comment#8052 AS cval_partsupp_ps_comment_1#8066, cdepval_partsupp_ps_availqty#8053 AS cdepval_partsupp_ps_availqty_1#8067, cdepval_partsupp_ps_supplycost#8054 AS cdepval_partsupp_ps_supplycost_1#8068, cdepval_partsupp_ps_comment#8055 AS cdepval_partsupp_ps_comment_1#8069, cps_availqty#8056 AS cps_availqty_1#8070, cps_supplycost#8057 AS cps_supplycost_1#8071, cps_comment#8058 AS cps_comment_1#8072]
         :        +- Relation[rid#8045,cpfk_part_partsupp#8046,cfpk_partsupp_part#8047,cpfk_supplier_partsupp#8048,cfpk_partsupp_supplier#8049,cval_partsupp_ps_availqty#8050,cval_partsupp_ps_supplycost#8051,cval_partsupp_ps_comment#8052,cdepval_partsupp_ps_availqty#8053,cdepval_partsupp_ps_supplycost#8054,cdepval_partsupp_ps_comment#8055,cps_availqty#8056,cps_supplycost#8057,cps_comment#8058] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#7967 AS rid_1#7981, cpfk_part_partsupp#7968 AS cpfk_part_partsupp_1#7982, cfpk_partsupp_part#7969 AS cfpk_partsupp_part_1#7983, cpfk_supplier_partsupp#7970 AS cpfk_supplier_partsupp_1#7984, cfpk_partsupp_supplier#7971 AS cfpk_partsupp_supplier_1#7985, cval_partsupp_ps_availqty#7972 AS cval_partsupp_ps_availqty_1#7986, cval_partsupp_ps_supplycost#7973 AS cval_partsupp_ps_supplycost_1#7987, cval_partsupp_ps_comment#7974 AS cval_partsupp_ps_comment_1#7988, cdepval_partsupp_ps_availqty#7975 AS cdepval_partsupp_ps_availqty_1#7989, cdepval_partsupp_ps_supplycost#7976 AS cdepval_partsupp_ps_supplycost_1#7990, cdepval_partsupp_ps_comment#7977 AS cdepval_partsupp_ps_comment_1#7991, cps_availqty#7978 AS cps_availqty_1#7992, cps_supplycost#7979 AS cps_supplycost_1#7993, cps_comment#7980 AS cps_comment_1#7994]
            +- Relation[rid#7967,cpfk_part_partsupp#7968,cfpk_partsupp_part#7969,cpfk_supplier_partsupp#7970,cfpk_partsupp_supplier#7971,cval_partsupp_ps_availqty#7972,cval_partsupp_ps_supplycost#7973,cval_partsupp_ps_comment#7974,cdepval_partsupp_ps_availqty#7975,cdepval_partsupp_ps_supplycost#7976,cdepval_partsupp_ps_comment#7977,cps_availqty#7978,cps_supplycost#7979,cps_comment#7980] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 774ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/26 22:44:11 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:44:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8140L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:44:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8140L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#8142 AS rid_0#8187, cpfk_orders_lineitem#8143 AS cpfk_orders_lineitem_0#8188, cpfk_supplier_lineitem#8144 AS cpfk_supplier_lineitem_0#8189, cfpk_lineitem_supplier#8145 AS cfpk_lineitem_supplier_0#8190, cfpk_lineitem_partsupp#8146 AS cfpk_lineitem_partsupp_0#8191, cpfk_part_lineitem#8147 AS cpfk_part_lineitem_0#8192, cfpk_lineitem_part#8148 AS cfpk_lineitem_part_0#8193, cpfk_partsupp_lineitem#8149 AS cpfk_partsupp_lineitem_0#8194, cfpk_lineitem_orders#8150 AS cfpk_lineitem_orders_0#8195, cval_lineitem_l_quantity#8151 AS cval_lineitem_l_quantity_0#8196, cval_lineitem_l_extendedprice#8152 AS cval_lineitem_l_extendedprice_0#8197, cval_lineitem_l_discount#8153 AS cval_lineitem_l_discount_0#8198, cval_lineitem_l_tax#8154 AS cval_lineitem_l_tax_0#8199, cval_lineitem_l_returnflag#8155 AS cval_lineitem_l_returnflag_0#8200, cval_lineitem_l_linestatus#8156 AS cval_lineitem_l_linestatus_0#8201, cval_lineitem_l_commitdate#8157 AS cval_lineitem_l_commitdate_0#8202, cval_lineitem_l_receiptdate#8158 AS cval_lineitem_l_receiptdate_0#8203, cval_lineitem_l_shipinstruct#8159 AS cval_lineitem_l_shipinstruct_0#8204, cval_lineitem_l_shipmode#8160 AS cval_lineitem_l_shipmode_0#8205, cval_lineitem_l_comment#8161 AS cval_lineitem_l_comment_0#8206, cval_lineitem_l_shipdate#8162 AS cval_lineitem_l_shipdate_0#8207, cdepval_lineitem_l_quantity#8163 AS cdepval_lineitem_l_quantity_0#8208, cdepval_lineitem_l_extendedprice#8164 AS cdepval_lineitem_l_extendedprice_0#8209, cdepval_lineitem_l_discount#8165 AS cdepval_lineitem_l_discount_0#8210, ... 21 more fields]
         :  +- Relation[rid#8142,cpfk_orders_lineitem#8143,cpfk_supplier_lineitem#8144,cfpk_lineitem_supplier#8145,cfpk_lineitem_partsupp#8146,cpfk_part_lineitem#8147,cfpk_lineitem_part#8148,cpfk_partsupp_lineitem#8149,cfpk_lineitem_orders#8150,cval_lineitem_l_quantity#8151,cval_lineitem_l_extendedprice#8152,cval_lineitem_l_discount#8153,cval_lineitem_l_tax#8154,cval_lineitem_l_returnflag#8155,cval_lineitem_l_linestatus#8156,cval_lineitem_l_commitdate#8157,cval_lineitem_l_receiptdate#8158,cval_lineitem_l_shipinstruct#8159,cval_lineitem_l_shipmode#8160,cval_lineitem_l_comment#8161,cval_lineitem_l_shipdate#8162,cdepval_lineitem_l_quantity#8163,cdepval_lineitem_l_extendedprice#8164,cdepval_lineitem_l_discount#8165,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8232 AS rid_1#8256, cpfk_customer_orders#8233 AS cpfk_customer_orders_1#8257, cfpk_orders_customer#8234 AS cfpk_orders_customer_1#8258, cval_orders_o_orderstatus#8235 AS cval_orders_o_orderstatus_1#8259, cval_orders_o_totalprice#8236 AS cval_orders_o_totalprice_1#8260, cval_orders_o_orderpriority#8237 AS cval_orders_o_orderpriority_1#8261, cval_orders_o_clerk#8238 AS cval_orders_o_clerk_1#8262, cval_orders_o_shippriority#8239 AS cval_orders_o_shippriority_1#8263, cval_orders_o_comment#8240 AS cval_orders_o_comment_1#8264, cval_orders_o_orderdate#8241 AS cval_orders_o_orderdate_1#8265, cdepval_orders_o_orderstatus#8242 AS cdepval_orders_o_orderstatus_1#8266, cdepval_orders_o_totalprice#8243 AS cdepval_orders_o_totalprice_1#8267, cdepval_orders_o_orderpriority#8244 AS cdepval_orders_o_orderpriority_1#8268, cdepval_orders_o_clerk#8245 AS cdepval_orders_o_clerk_1#8269, cdepval_orders_o_shippriority#8246 AS cdepval_orders_o_shippriority_1#8270, cdepval_orders_o_comment#8247 AS cdepval_orders_o_comment_1#8271, cdepval_orders_o_orderdate#8248 AS cdepval_orders_o_orderdate_1#8272, co_orderstatus#8249 AS co_orderstatus_1#8273, co_totalprice#8250 AS co_totalprice_1#8274, co_orderpriority#8251 AS co_orderpriority_1#8275, co_clerk#8252 AS co_clerk_1#8276, co_shippriority#8253 AS co_shippriority_1#8277, co_comment#8254 AS co_comment_1#8278, co_orderdate#8255 AS co_orderdate_1#8279]
            +- Relation[rid#8232,cpfk_customer_orders#8233,cfpk_orders_customer#8234,cval_orders_o_orderstatus#8235,cval_orders_o_totalprice#8236,cval_orders_o_orderpriority#8237,cval_orders_o_clerk#8238,cval_orders_o_shippriority#8239,cval_orders_o_comment#8240,cval_orders_o_orderdate#8241,cdepval_orders_o_orderstatus#8242,cdepval_orders_o_totalprice#8243,cdepval_orders_o_orderpriority#8244,cdepval_orders_o_clerk#8245,cdepval_orders_o_shippriority#8246,cdepval_orders_o_comment#8247,cdepval_orders_o_orderdate#8248,co_orderstatus#8249,co_totalprice#8250,co_orderpriority#8251,co_clerk#8252,co_shippriority#8253,co_comment#8254,co_orderdate#8255] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 22552ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 22:44:34 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:44:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8358L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:44:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:44:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:44:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:44:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:44:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:44:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:44:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:44:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:44:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:44:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:44:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:44:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8358L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#8492 AS rid_4#8537, cpfk_orders_lineitem#8493 AS cpfk_orders_lineitem_4#8538, cpfk_supplier_lineitem#8494 AS cpfk_supplier_lineitem_4#8539, cfpk_lineitem_supplier#8495 AS cfpk_lineitem_supplier_4#8540, cfpk_lineitem_partsupp#8496 AS cfpk_lineitem_partsupp_4#8541, cpfk_part_lineitem#8497 AS cpfk_part_lineitem_4#8542, cfpk_lineitem_part#8498 AS cfpk_lineitem_part_4#8543, cpfk_partsupp_lineitem#8499 AS cpfk_partsupp_lineitem_4#8544, cfpk_lineitem_orders#8500 AS cfpk_lineitem_orders_4#8545, cval_lineitem_l_quantity#8501 AS cval_lineitem_l_quantity_4#8546, cval_lineitem_l_extendedprice#8502 AS cval_lineitem_l_extendedprice_4#8547, cval_lineitem_l_discount#8503 AS cval_lineitem_l_discount_4#8548, cval_lineitem_l_tax#8504 AS cval_lineitem_l_tax_4#8549, cval_lineitem_l_returnflag#8505 AS cval_lineitem_l_returnflag_4#8550, cval_lineitem_l_linestatus#8506 AS cval_lineitem_l_linestatus_4#8551, cval_lineitem_l_commitdate#8507 AS cval_lineitem_l_commitdate_4#8552, cval_lineitem_l_receiptdate#8508 AS cval_lineitem_l_receiptdate_4#8553, cval_lineitem_l_shipinstruct#8509 AS cval_lineitem_l_shipinstruct_4#8554, cval_lineitem_l_shipmode#8510 AS cval_lineitem_l_shipmode_4#8555, cval_lineitem_l_comment#8511 AS cval_lineitem_l_comment_4#8556, cval_lineitem_l_shipdate#8512 AS cval_lineitem_l_shipdate_4#8557, cdepval_lineitem_l_quantity#8513 AS cdepval_lineitem_l_quantity_4#8558, cdepval_lineitem_l_extendedprice#8514 AS cdepval_lineitem_l_extendedprice_4#8559, cdepval_lineitem_l_discount#8515 AS cdepval_lineitem_l_discount_4#8560, ... 21 more fields]
         :  :  +- Relation[rid#8492,cpfk_orders_lineitem#8493,cpfk_supplier_lineitem#8494,cfpk_lineitem_supplier#8495,cfpk_lineitem_partsupp#8496,cpfk_part_lineitem#8497,cfpk_lineitem_part#8498,cpfk_partsupp_lineitem#8499,cfpk_lineitem_orders#8500,cval_lineitem_l_quantity#8501,cval_lineitem_l_extendedprice#8502,cval_lineitem_l_discount#8503,cval_lineitem_l_tax#8504,cval_lineitem_l_returnflag#8505,cval_lineitem_l_linestatus#8506,cval_lineitem_l_commitdate#8507,cval_lineitem_l_receiptdate#8508,cval_lineitem_l_shipinstruct#8509,cval_lineitem_l_shipmode#8510,cval_lineitem_l_comment#8511,cval_lineitem_l_shipdate#8512,cdepval_lineitem_l_quantity#8513,cdepval_lineitem_l_extendedprice#8514,cdepval_lineitem_l_discount#8515,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#8414 AS rid_2#8428, cpfk_part_partsupp#8415 AS cpfk_part_partsupp_2#8429, cfpk_partsupp_part#8416 AS cfpk_partsupp_part_2#8430, cpfk_supplier_partsupp#8417 AS cpfk_supplier_partsupp_2#8431, cfpk_partsupp_supplier#8418 AS cfpk_partsupp_supplier_2#8432, cval_partsupp_ps_availqty#8419 AS cval_partsupp_ps_availqty_2#8433, cval_partsupp_ps_supplycost#8420 AS cval_partsupp_ps_supplycost_2#8434, cval_partsupp_ps_comment#8421 AS cval_partsupp_ps_comment_2#8435, cdepval_partsupp_ps_availqty#8422 AS cdepval_partsupp_ps_availqty_2#8436, cdepval_partsupp_ps_supplycost#8423 AS cdepval_partsupp_ps_supplycost_2#8437, cdepval_partsupp_ps_comment#8424 AS cdepval_partsupp_ps_comment_2#8438, cps_availqty#8425 AS cps_availqty_2#8439, cps_supplycost#8426 AS cps_supplycost_2#8440, cps_comment#8427 AS cps_comment_2#8441]
         :     :  :  +- Relation[rid#8414,cpfk_part_partsupp#8415,cfpk_partsupp_part#8416,cpfk_supplier_partsupp#8417,cfpk_partsupp_supplier#8418,cval_partsupp_ps_availqty#8419,cval_partsupp_ps_supplycost#8420,cval_partsupp_ps_comment#8421,cdepval_partsupp_ps_availqty#8422,cdepval_partsupp_ps_supplycost#8423,cdepval_partsupp_ps_comment#8424,cps_availqty#8425,cps_supplycost#8426,cps_comment#8427] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#8378 AS rid_1#8396, cpfk_nation_supplier#8379 AS cpfk_nation_supplier_1#8397, cfpk_supplier_nation#8380 AS cfpk_supplier_nation_1#8398, cval_supplier_s_name#8381 AS cval_supplier_s_name_1#8399, cval_supplier_s_address#8382 AS cval_supplier_s_address_1#8400, cval_supplier_s_phone#8383 AS cval_supplier_s_phone_1#8401, cval_supplier_s_acctbal#8384 AS cval_supplier_s_acctbal_1#8402, cval_supplier_s_comment#8385 AS cval_supplier_s_comment_1#8403, cdepval_supplier_s_name#8386 AS cdepval_supplier_s_name_1#8404, cdepval_supplier_s_address#8387 AS cdepval_supplier_s_address_1#8405, cdepval_supplier_s_phone#8388 AS cdepval_supplier_s_phone_1#8406, cdepval_supplier_s_acctbal#8389 AS cdepval_supplier_s_acctbal_1#8407, cdepval_supplier_s_comment#8390 AS cdepval_supplier_s_comment_1#8408, cs_name#8391 AS cs_name_1#8409, cs_address#8392 AS cs_address_1#8410, cs_phone#8393 AS cs_phone_1#8411, cs_acctbal#8394 AS cs_acctbal_1#8412, cs_comment#8395 AS cs_comment_1#8413]
         :     :     :  +- Relation[rid#8378,cpfk_nation_supplier#8379,cfpk_supplier_nation#8380,cval_supplier_s_name#8381,cval_supplier_s_address#8382,cval_supplier_s_phone#8383,cval_supplier_s_acctbal#8384,cval_supplier_s_comment#8385,cdepval_supplier_s_name#8386,cdepval_supplier_s_address#8387,cdepval_supplier_s_phone#8388,cdepval_supplier_s_acctbal#8389,cdepval_supplier_s_comment#8390,cs_name#8391,cs_address#8392,cs_phone#8393,cs_acctbal#8394,cs_comment#8395] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#8360 AS rid_0#8369, cpfk_region_nation#8361 AS cpfk_region_nation_0#8370, cfpk_nation_region#8362 AS cfpk_nation_region_0#8371, cval_nation_n_name#8363 AS cval_nation_n_name_0#8372, cval_nation_n_comment#8364 AS cval_nation_n_comment_0#8373, cdepval_nation_n_name#8365 AS cdepval_nation_n_name_0#8374, cdepval_nation_n_comment#8366 AS cdepval_nation_n_comment_0#8375, cn_name#8367 AS cn_name_0#8376, cn_comment#8368 AS cn_comment_0#8377]
         :     :        +- Relation[rid#8360,cpfk_region_nation#8361,cfpk_nation_region#8362,cval_nation_n_name#8363,cval_nation_n_comment#8364,cdepval_nation_n_name#8365,cdepval_nation_n_comment#8366,cn_name#8367,cn_comment#8368] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#8442 AS rid_3#8467, cval_part_p_name#8443 AS cval_part_p_name_3#8468, cval_part_p_mfgr#8444 AS cval_part_p_mfgr_3#8469, cval_part_p_type#8445 AS cval_part_p_type_3#8470, cval_part_p_size#8446 AS cval_part_p_size_3#8471, cval_part_p_container#8447 AS cval_part_p_container_3#8472, cval_part_p_retailprice#8448 AS cval_part_p_retailprice_3#8473, cval_part_p_comment#8449 AS cval_part_p_comment_3#8474, cval_part_p_brand#8450 AS cval_part_p_brand_3#8475, cdepval_part_p_name#8451 AS cdepval_part_p_name_3#8476, cdepval_part_p_mfgr#8452 AS cdepval_part_p_mfgr_3#8477, cdepval_part_p_type#8453 AS cdepval_part_p_type_3#8478, cdepval_part_p_size#8454 AS cdepval_part_p_size_3#8479, cdepval_part_p_container#8455 AS cdepval_part_p_container_3#8480, cdepval_part_p_retailprice#8456 AS cdepval_part_p_retailprice_3#8481, cdepval_part_p_comment#8457 AS cdepval_part_p_comment_3#8482, cdepval_part_p_brand#8458 AS cdepval_part_p_brand_3#8483, cp_name#8459 AS cp_name_3#8484, cp_mfgr#8460 AS cp_mfgr_3#8485, cp_type#8461 AS cp_type_3#8486, cp_size#8462 AS cp_size_3#8487, cp_container#8463 AS cp_container_3#8488, cp_retailprice#8464 AS cp_retailprice_3#8489, cp_comment#8465 AS cp_comment_3#8490, cp_brand#8466 AS cp_brand_3#8491]
         :        +- Relation[rid#8442,cval_part_p_name#8443,cval_part_p_mfgr#8444,cval_part_p_type#8445,cval_part_p_size#8446,cval_part_p_container#8447,cval_part_p_retailprice#8448,cval_part_p_comment#8449,cval_part_p_brand#8450,cdepval_part_p_name#8451,cdepval_part_p_mfgr#8452,cdepval_part_p_type#8453,cdepval_part_p_size#8454,cdepval_part_p_container#8455,cdepval_part_p_retailprice#8456,cdepval_part_p_comment#8457,cdepval_part_p_brand#8458,cp_name#8459,cp_mfgr#8460,cp_type#8461,cp_size#8462,cp_container#8463,cp_retailprice#8464,cp_comment#8465,cp_brand#8466] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#8582 AS rid_5#8606, cpfk_customer_orders#8583 AS cpfk_customer_orders_5#8607, cfpk_orders_customer#8584 AS cfpk_orders_customer_5#8608, cval_orders_o_orderstatus#8585 AS cval_orders_o_orderstatus_5#8609, cval_orders_o_totalprice#8586 AS cval_orders_o_totalprice_5#8610, cval_orders_o_orderpriority#8587 AS cval_orders_o_orderpriority_5#8611, cval_orders_o_clerk#8588 AS cval_orders_o_clerk_5#8612, cval_orders_o_shippriority#8589 AS cval_orders_o_shippriority_5#8613, cval_orders_o_comment#8590 AS cval_orders_o_comment_5#8614, cval_orders_o_orderdate#8591 AS cval_orders_o_orderdate_5#8615, cdepval_orders_o_orderstatus#8592 AS cdepval_orders_o_orderstatus_5#8616, cdepval_orders_o_totalprice#8593 AS cdepval_orders_o_totalprice_5#8617, cdepval_orders_o_orderpriority#8594 AS cdepval_orders_o_orderpriority_5#8618, cdepval_orders_o_clerk#8595 AS cdepval_orders_o_clerk_5#8619, cdepval_orders_o_shippriority#8596 AS cdepval_orders_o_shippriority_5#8620, cdepval_orders_o_comment#8597 AS cdepval_orders_o_comment_5#8621, cdepval_orders_o_orderdate#8598 AS cdepval_orders_o_orderdate_5#8622, co_orderstatus#8599 AS co_orderstatus_5#8623, co_totalprice#8600 AS co_totalprice_5#8624, co_orderpriority#8601 AS co_orderpriority_5#8625, co_clerk#8602 AS co_clerk_5#8626, co_shippriority#8603 AS co_shippriority_5#8627, co_comment#8604 AS co_comment_5#8628, co_orderdate#8605 AS co_orderdate_5#8629]
            +- Relation[rid#8582,cpfk_customer_orders#8583,cfpk_orders_customer#8584,cval_orders_o_orderstatus#8585,cval_orders_o_totalprice#8586,cval_orders_o_orderpriority#8587,cval_orders_o_clerk#8588,cval_orders_o_shippriority#8589,cval_orders_o_comment#8590,cval_orders_o_orderdate#8591,cdepval_orders_o_orderstatus#8592,cdepval_orders_o_totalprice#8593,cdepval_orders_o_orderpriority#8594,cdepval_orders_o_clerk#8595,cdepval_orders_o_shippriority#8596,cdepval_orders_o_comment#8597,cdepval_orders_o_orderdate#8598,co_orderstatus#8599,co_totalprice#8600,co_orderpriority#8601,co_clerk#8602,co_shippriority#8603,co_comment#8604,co_orderdate#8605] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 38850ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/26 22:45:12 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:45:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8770L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 22:45:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8770L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#8772 AS rid_0#8796, cpfk_customer_orders#8773 AS cpfk_customer_orders_0#8797, cfpk_orders_customer#8774 AS cfpk_orders_customer_0#8798, cval_orders_o_orderstatus#8775 AS cval_orders_o_orderstatus_0#8799, cval_orders_o_totalprice#8776 AS cval_orders_o_totalprice_0#8800, cval_orders_o_orderpriority#8777 AS cval_orders_o_orderpriority_0#8801, cval_orders_o_clerk#8778 AS cval_orders_o_clerk_0#8802, cval_orders_o_shippriority#8779 AS cval_orders_o_shippriority_0#8803, cval_orders_o_comment#8780 AS cval_orders_o_comment_0#8804, cval_orders_o_orderdate#8781 AS cval_orders_o_orderdate_0#8805, cdepval_orders_o_orderstatus#8782 AS cdepval_orders_o_orderstatus_0#8806, cdepval_orders_o_totalprice#8783 AS cdepval_orders_o_totalprice_0#8807, cdepval_orders_o_orderpriority#8784 AS cdepval_orders_o_orderpriority_0#8808, cdepval_orders_o_clerk#8785 AS cdepval_orders_o_clerk_0#8809, cdepval_orders_o_shippriority#8786 AS cdepval_orders_o_shippriority_0#8810, cdepval_orders_o_comment#8787 AS cdepval_orders_o_comment_0#8811, cdepval_orders_o_orderdate#8788 AS cdepval_orders_o_orderdate_0#8812, co_orderstatus#8789 AS co_orderstatus_0#8813, co_totalprice#8790 AS co_totalprice_0#8814, co_orderpriority#8791 AS co_orderpriority_0#8815, co_clerk#8792 AS co_clerk_0#8816, co_shippriority#8793 AS co_shippriority_0#8817, co_comment#8794 AS co_comment_0#8818, co_orderdate#8795 AS co_orderdate_0#8819]
         :  +- Relation[rid#8772,cpfk_customer_orders#8773,cfpk_orders_customer#8774,cval_orders_o_orderstatus#8775,cval_orders_o_totalprice#8776,cval_orders_o_orderpriority#8777,cval_orders_o_clerk#8778,cval_orders_o_shippriority#8779,cval_orders_o_comment#8780,cval_orders_o_orderdate#8781,cdepval_orders_o_orderstatus#8782,cdepval_orders_o_totalprice#8783,cdepval_orders_o_orderpriority#8784,cdepval_orders_o_clerk#8785,cdepval_orders_o_shippriority#8786,cdepval_orders_o_comment#8787,cdepval_orders_o_orderdate#8788,co_orderstatus#8789,co_totalprice#8790,co_orderpriority#8791,co_clerk#8792,co_shippriority#8793,co_comment#8794,co_orderdate#8795] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#8820 AS rid_1#8841, cpfk_nation_customer#8821 AS cpfk_nation_customer_1#8842, cfpk_customer_nation#8822 AS cfpk_customer_nation_1#8843, cval_customer_c_name#8823 AS cval_customer_c_name_1#8844, cval_customer_c_address#8824 AS cval_customer_c_address_1#8845, cval_customer_c_phone#8825 AS cval_customer_c_phone_1#8846, cval_customer_c_acctbal#8826 AS cval_customer_c_acctbal_1#8847, cval_customer_c_comment#8827 AS cval_customer_c_comment_1#8848, cval_customer_c_mktsegment#8828 AS cval_customer_c_mktsegment_1#8849, cdepval_customer_c_name#8829 AS cdepval_customer_c_name_1#8850, cdepval_customer_c_address#8830 AS cdepval_customer_c_address_1#8851, cdepval_customer_c_phone#8831 AS cdepval_customer_c_phone_1#8852, cdepval_customer_c_acctbal#8832 AS cdepval_customer_c_acctbal_1#8853, cdepval_customer_c_comment#8833 AS cdepval_customer_c_comment_1#8854, cdepval_customer_c_mktsegment#8834 AS cdepval_customer_c_mktsegment_1#8855, cc_name#8835 AS cc_name_1#8856, cc_address#8836 AS cc_address_1#8857, cc_phone#8837 AS cc_phone_1#8858, cc_acctbal#8838 AS cc_acctbal_1#8859, cc_comment#8839 AS cc_comment_1#8860, cc_mktsegment#8840 AS cc_mktsegment_1#8861]
            +- Relation[rid#8820,cpfk_nation_customer#8821,cfpk_customer_nation#8822,cval_customer_c_name#8823,cval_customer_c_address#8824,cval_customer_c_phone#8825,cval_customer_c_acctbal#8826,cval_customer_c_comment#8827,cval_customer_c_mktsegment#8828,cdepval_customer_c_name#8829,cdepval_customer_c_address#8830,cdepval_customer_c_phone#8831,cdepval_customer_c_acctbal#8832,cdepval_customer_c_comment#8833,cdepval_customer_c_mktsegment#8834,cc_name#8835,cc_address#8836,cc_phone#8837,cc_acctbal#8838,cc_comment#8839,cc_mktsegment#8840] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4701ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/26 22:45:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:45:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8912L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:45:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#8912L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#8914 AS rid_0#8959, cpfk_orders_lineitem#8915 AS cpfk_orders_lineitem_0#8960, cpfk_supplier_lineitem#8916 AS cpfk_supplier_lineitem_0#8961, cfpk_lineitem_supplier#8917 AS cfpk_lineitem_supplier_0#8962, cfpk_lineitem_partsupp#8918 AS cfpk_lineitem_partsupp_0#8963, cpfk_part_lineitem#8919 AS cpfk_part_lineitem_0#8964, cfpk_lineitem_part#8920 AS cfpk_lineitem_part_0#8965, cpfk_partsupp_lineitem#8921 AS cpfk_partsupp_lineitem_0#8966, cfpk_lineitem_orders#8922 AS cfpk_lineitem_orders_0#8967, cval_lineitem_l_quantity#8923 AS cval_lineitem_l_quantity_0#8968, cval_lineitem_l_extendedprice#8924 AS cval_lineitem_l_extendedprice_0#8969, cval_lineitem_l_discount#8925 AS cval_lineitem_l_discount_0#8970, cval_lineitem_l_tax#8926 AS cval_lineitem_l_tax_0#8971, cval_lineitem_l_returnflag#8927 AS cval_lineitem_l_returnflag_0#8972, cval_lineitem_l_linestatus#8928 AS cval_lineitem_l_linestatus_0#8973, cval_lineitem_l_commitdate#8929 AS cval_lineitem_l_commitdate_0#8974, cval_lineitem_l_receiptdate#8930 AS cval_lineitem_l_receiptdate_0#8975, cval_lineitem_l_shipinstruct#8931 AS cval_lineitem_l_shipinstruct_0#8976, cval_lineitem_l_shipmode#8932 AS cval_lineitem_l_shipmode_0#8977, cval_lineitem_l_comment#8933 AS cval_lineitem_l_comment_0#8978, cval_lineitem_l_shipdate#8934 AS cval_lineitem_l_shipdate_0#8979, cdepval_lineitem_l_quantity#8935 AS cdepval_lineitem_l_quantity_0#8980, cdepval_lineitem_l_extendedprice#8936 AS cdepval_lineitem_l_extendedprice_0#8981, cdepval_lineitem_l_discount#8937 AS cdepval_lineitem_l_discount_0#8982, ... 21 more fields]
         +- Relation[rid#8914,cpfk_orders_lineitem#8915,cpfk_supplier_lineitem#8916,cfpk_lineitem_supplier#8917,cfpk_lineitem_partsupp#8918,cpfk_part_lineitem#8919,cfpk_lineitem_part#8920,cpfk_partsupp_lineitem#8921,cfpk_lineitem_orders#8922,cval_lineitem_l_quantity#8923,cval_lineitem_l_extendedprice#8924,cval_lineitem_l_discount#8925,cval_lineitem_l_tax#8926,cval_lineitem_l_returnflag#8927,cval_lineitem_l_linestatus#8928,cval_lineitem_l_commitdate#8929,cval_lineitem_l_receiptdate#8930,cval_lineitem_l_shipinstruct#8931,cval_lineitem_l_shipmode#8932,cval_lineitem_l_comment#8933,cval_lineitem_l_shipdate#8934,cdepval_lineitem_l_quantity#8935,cdepval_lineitem_l_extendedprice#8936,cdepval_lineitem_l_discount#8937,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2425ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/26 22:45:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:45:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9053L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:45:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9053L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#9055 AS rid_0#9100, cpfk_orders_lineitem#9056 AS cpfk_orders_lineitem_0#9101, cpfk_supplier_lineitem#9057 AS cpfk_supplier_lineitem_0#9102, cfpk_lineitem_supplier#9058 AS cfpk_lineitem_supplier_0#9103, cfpk_lineitem_partsupp#9059 AS cfpk_lineitem_partsupp_0#9104, cpfk_part_lineitem#9060 AS cpfk_part_lineitem_0#9105, cfpk_lineitem_part#9061 AS cfpk_lineitem_part_0#9106, cpfk_partsupp_lineitem#9062 AS cpfk_partsupp_lineitem_0#9107, cfpk_lineitem_orders#9063 AS cfpk_lineitem_orders_0#9108, cval_lineitem_l_quantity#9064 AS cval_lineitem_l_quantity_0#9109, cval_lineitem_l_extendedprice#9065 AS cval_lineitem_l_extendedprice_0#9110, cval_lineitem_l_discount#9066 AS cval_lineitem_l_discount_0#9111, cval_lineitem_l_tax#9067 AS cval_lineitem_l_tax_0#9112, cval_lineitem_l_returnflag#9068 AS cval_lineitem_l_returnflag_0#9113, cval_lineitem_l_linestatus#9069 AS cval_lineitem_l_linestatus_0#9114, cval_lineitem_l_commitdate#9070 AS cval_lineitem_l_commitdate_0#9115, cval_lineitem_l_receiptdate#9071 AS cval_lineitem_l_receiptdate_0#9116, cval_lineitem_l_shipinstruct#9072 AS cval_lineitem_l_shipinstruct_0#9117, cval_lineitem_l_shipmode#9073 AS cval_lineitem_l_shipmode_0#9118, cval_lineitem_l_comment#9074 AS cval_lineitem_l_comment_0#9119, cval_lineitem_l_shipdate#9075 AS cval_lineitem_l_shipdate_0#9120, cdepval_lineitem_l_quantity#9076 AS cdepval_lineitem_l_quantity_0#9121, cdepval_lineitem_l_extendedprice#9077 AS cdepval_lineitem_l_extendedprice_0#9122, cdepval_lineitem_l_discount#9078 AS cdepval_lineitem_l_discount_0#9123, ... 21 more fields]
         :     +- Relation[rid#9055,cpfk_orders_lineitem#9056,cpfk_supplier_lineitem#9057,cfpk_lineitem_supplier#9058,cfpk_lineitem_partsupp#9059,cpfk_part_lineitem#9060,cfpk_lineitem_part#9061,cpfk_partsupp_lineitem#9062,cfpk_lineitem_orders#9063,cval_lineitem_l_quantity#9064,cval_lineitem_l_extendedprice#9065,cval_lineitem_l_discount#9066,cval_lineitem_l_tax#9067,cval_lineitem_l_returnflag#9068,cval_lineitem_l_linestatus#9069,cval_lineitem_l_commitdate#9070,cval_lineitem_l_receiptdate#9071,cval_lineitem_l_shipinstruct#9072,cval_lineitem_l_shipmode#9073,cval_lineitem_l_comment#9074,cval_lineitem_l_shipdate#9075,cdepval_lineitem_l_quantity#9076,cdepval_lineitem_l_extendedprice#9077,cdepval_lineitem_l_discount#9078,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#9235 AS rid_1#9259, cpfk_customer_orders#9236 AS cpfk_customer_orders_1#9260, cfpk_orders_customer#9237 AS cfpk_orders_customer_1#9261, cval_orders_o_orderstatus#9238 AS cval_orders_o_orderstatus_1#9262, cval_orders_o_totalprice#9239 AS cval_orders_o_totalprice_1#9263, cval_orders_o_orderpriority#9240 AS cval_orders_o_orderpriority_1#9264, cval_orders_o_clerk#9241 AS cval_orders_o_clerk_1#9265, cval_orders_o_shippriority#9242 AS cval_orders_o_shippriority_1#9266, cval_orders_o_comment#9243 AS cval_orders_o_comment_1#9267, cval_orders_o_orderdate#9244 AS cval_orders_o_orderdate_1#9268, cdepval_orders_o_orderstatus#9245 AS cdepval_orders_o_orderstatus_1#9269, cdepval_orders_o_totalprice#9246 AS cdepval_orders_o_totalprice_1#9270, cdepval_orders_o_orderpriority#9247 AS cdepval_orders_o_orderpriority_1#9271, cdepval_orders_o_clerk#9248 AS cdepval_orders_o_clerk_1#9272, cdepval_orders_o_shippriority#9249 AS cdepval_orders_o_shippriority_1#9273, cdepval_orders_o_comment#9250 AS cdepval_orders_o_comment_1#9274, cdepval_orders_o_orderdate#9251 AS cdepval_orders_o_orderdate_1#9275, co_orderstatus#9252 AS co_orderstatus_1#9276, co_totalprice#9253 AS co_totalprice_1#9277, co_orderpriority#9254 AS co_orderpriority_1#9278, co_clerk#9255 AS co_clerk_1#9279, co_shippriority#9256 AS co_shippriority_1#9280, co_comment#9257 AS co_comment_1#9281, co_orderdate#9258 AS co_orderdate_1#9282]
            +- Relation[rid#9235,cpfk_customer_orders#9236,cfpk_orders_customer#9237,cval_orders_o_orderstatus#9238,cval_orders_o_totalprice#9239,cval_orders_o_orderpriority#9240,cval_orders_o_clerk#9241,cval_orders_o_shippriority#9242,cval_orders_o_comment#9243,cval_orders_o_orderdate#9244,cdepval_orders_o_orderstatus#9245,cdepval_orders_o_totalprice#9246,cdepval_orders_o_orderpriority#9247,cdepval_orders_o_clerk#9248,cdepval_orders_o_shippriority#9249,cdepval_orders_o_comment#9250,cdepval_orders_o_orderdate#9251,co_orderstatus#9252,co_totalprice#9253,co_orderpriority#9254,co_clerk#9255,co_shippriority#9256,co_comment#9257,co_orderdate#9258] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 24467ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 22:45:44 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:45:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9361L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:45:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:45:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:45:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:45:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:45:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:45:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:45:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:45:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9361L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#9417 AS rid_2#9462, cpfk_orders_lineitem#9418 AS cpfk_orders_lineitem_2#9463, cpfk_supplier_lineitem#9419 AS cpfk_supplier_lineitem_2#9464, cfpk_lineitem_supplier#9420 AS cfpk_lineitem_supplier_2#9465, cfpk_lineitem_partsupp#9421 AS cfpk_lineitem_partsupp_2#9466, cpfk_part_lineitem#9422 AS cpfk_part_lineitem_2#9467, cfpk_lineitem_part#9423 AS cfpk_lineitem_part_2#9468, cpfk_partsupp_lineitem#9424 AS cpfk_partsupp_lineitem_2#9469, cfpk_lineitem_orders#9425 AS cfpk_lineitem_orders_2#9470, cval_lineitem_l_quantity#9426 AS cval_lineitem_l_quantity_2#9471, cval_lineitem_l_extendedprice#9427 AS cval_lineitem_l_extendedprice_2#9472, cval_lineitem_l_discount#9428 AS cval_lineitem_l_discount_2#9473, cval_lineitem_l_tax#9429 AS cval_lineitem_l_tax_2#9474, cval_lineitem_l_returnflag#9430 AS cval_lineitem_l_returnflag_2#9475, cval_lineitem_l_linestatus#9431 AS cval_lineitem_l_linestatus_2#9476, cval_lineitem_l_commitdate#9432 AS cval_lineitem_l_commitdate_2#9477, cval_lineitem_l_receiptdate#9433 AS cval_lineitem_l_receiptdate_2#9478, cval_lineitem_l_shipinstruct#9434 AS cval_lineitem_l_shipinstruct_2#9479, cval_lineitem_l_shipmode#9435 AS cval_lineitem_l_shipmode_2#9480, cval_lineitem_l_comment#9436 AS cval_lineitem_l_comment_2#9481, cval_lineitem_l_shipdate#9437 AS cval_lineitem_l_shipdate_2#9482, cdepval_lineitem_l_quantity#9438 AS cdepval_lineitem_l_quantity_2#9483, cdepval_lineitem_l_extendedprice#9439 AS cdepval_lineitem_l_extendedprice_2#9484, cdepval_lineitem_l_discount#9440 AS cdepval_lineitem_l_discount_2#9485, ... 21 more fields]
         :  :  :  :  +- Relation[rid#9417,cpfk_orders_lineitem#9418,cpfk_supplier_lineitem#9419,cfpk_lineitem_supplier#9420,cfpk_lineitem_partsupp#9421,cpfk_part_lineitem#9422,cfpk_lineitem_part#9423,cpfk_partsupp_lineitem#9424,cfpk_lineitem_orders#9425,cval_lineitem_l_quantity#9426,cval_lineitem_l_extendedprice#9427,cval_lineitem_l_discount#9428,cval_lineitem_l_tax#9429,cval_lineitem_l_returnflag#9430,cval_lineitem_l_linestatus#9431,cval_lineitem_l_commitdate#9432,cval_lineitem_l_receiptdate#9433,cval_lineitem_l_shipinstruct#9434,cval_lineitem_l_shipmode#9435,cval_lineitem_l_comment#9436,cval_lineitem_l_shipdate#9437,cdepval_lineitem_l_quantity#9438,cdepval_lineitem_l_extendedprice#9439,cdepval_lineitem_l_discount#9440,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#9381 AS rid_1#9399, cpfk_nation_supplier#9382 AS cpfk_nation_supplier_1#9400, cfpk_supplier_nation#9383 AS cfpk_supplier_nation_1#9401, cval_supplier_s_name#9384 AS cval_supplier_s_name_1#9402, cval_supplier_s_address#9385 AS cval_supplier_s_address_1#9403, cval_supplier_s_phone#9386 AS cval_supplier_s_phone_1#9404, cval_supplier_s_acctbal#9387 AS cval_supplier_s_acctbal_1#9405, cval_supplier_s_comment#9388 AS cval_supplier_s_comment_1#9406, cdepval_supplier_s_name#9389 AS cdepval_supplier_s_name_1#9407, cdepval_supplier_s_address#9390 AS cdepval_supplier_s_address_1#9408, cdepval_supplier_s_phone#9391 AS cdepval_supplier_s_phone_1#9409, cdepval_supplier_s_acctbal#9392 AS cdepval_supplier_s_acctbal_1#9410, cdepval_supplier_s_comment#9393 AS cdepval_supplier_s_comment_1#9411, cs_name#9394 AS cs_name_1#9412, cs_address#9395 AS cs_address_1#9413, cs_phone#9396 AS cs_phone_1#9414, cs_acctbal#9397 AS cs_acctbal_1#9415, cs_comment#9398 AS cs_comment_1#9416]
         :  :  :     :  +- Relation[rid#9381,cpfk_nation_supplier#9382,cfpk_supplier_nation#9383,cval_supplier_s_name#9384,cval_supplier_s_address#9385,cval_supplier_s_phone#9386,cval_supplier_s_acctbal#9387,cval_supplier_s_comment#9388,cdepval_supplier_s_name#9389,cdepval_supplier_s_address#9390,cdepval_supplier_s_phone#9391,cdepval_supplier_s_acctbal#9392,cdepval_supplier_s_comment#9393,cs_name#9394,cs_address#9395,cs_phone#9396,cs_acctbal#9397,cs_comment#9398] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#9363 AS rid_0#9372, cpfk_region_nation#9364 AS cpfk_region_nation_0#9373, cfpk_nation_region#9365 AS cfpk_nation_region_0#9374, cval_nation_n_name#9366 AS cval_nation_n_name_0#9375, cval_nation_n_comment#9367 AS cval_nation_n_comment_0#9376, cdepval_nation_n_name#9368 AS cdepval_nation_n_name_0#9377, cdepval_nation_n_comment#9369 AS cdepval_nation_n_comment_0#9378, cn_name#9370 AS cn_name_0#9379, cn_comment#9371 AS cn_comment_0#9380]
         :  :  :        +- Relation[rid#9363,cpfk_region_nation#9364,cfpk_nation_region#9365,cval_nation_n_name#9366,cval_nation_n_comment#9367,cdepval_nation_n_name#9368,cdepval_nation_n_comment#9369,cn_name#9370,cn_comment#9371] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#9507 AS rid_3#9532, cval_part_p_name#9508 AS cval_part_p_name_3#9533, cval_part_p_mfgr#9509 AS cval_part_p_mfgr_3#9534, cval_part_p_type#9510 AS cval_part_p_type_3#9535, cval_part_p_size#9511 AS cval_part_p_size_3#9536, cval_part_p_container#9512 AS cval_part_p_container_3#9537, cval_part_p_retailprice#9513 AS cval_part_p_retailprice_3#9538, cval_part_p_comment#9514 AS cval_part_p_comment_3#9539, cval_part_p_brand#9515 AS cval_part_p_brand_3#9540, cdepval_part_p_name#9516 AS cdepval_part_p_name_3#9541, cdepval_part_p_mfgr#9517 AS cdepval_part_p_mfgr_3#9542, cdepval_part_p_type#9518 AS cdepval_part_p_type_3#9543, cdepval_part_p_size#9519 AS cdepval_part_p_size_3#9544, cdepval_part_p_container#9520 AS cdepval_part_p_container_3#9545, cdepval_part_p_retailprice#9521 AS cdepval_part_p_retailprice_3#9546, cdepval_part_p_comment#9522 AS cdepval_part_p_comment_3#9547, cdepval_part_p_brand#9523 AS cdepval_part_p_brand_3#9548, cp_name#9524 AS cp_name_3#9549, cp_mfgr#9525 AS cp_mfgr_3#9550, cp_type#9526 AS cp_type_3#9551, cp_size#9527 AS cp_size_3#9552, cp_container#9528 AS cp_container_3#9553, cp_retailprice#9529 AS cp_retailprice_3#9554, cp_comment#9530 AS cp_comment_3#9555, cp_brand#9531 AS cp_brand_3#9556]
         :  :     +- Relation[rid#9507,cval_part_p_name#9508,cval_part_p_mfgr#9509,cval_part_p_type#9510,cval_part_p_size#9511,cval_part_p_container#9512,cval_part_p_retailprice#9513,cval_part_p_comment#9514,cval_part_p_brand#9515,cdepval_part_p_name#9516,cdepval_part_p_mfgr#9517,cdepval_part_p_type#9518,cdepval_part_p_size#9519,cdepval_part_p_container#9520,cdepval_part_p_retailprice#9521,cdepval_part_p_comment#9522,cdepval_part_p_brand#9523,cp_name#9524,cp_mfgr#9525,cp_type#9526,cp_size#9527,cp_container#9528,cp_retailprice#9529,cp_comment#9530,cp_brand#9531] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#9557 AS rid_4#9571, cpfk_part_partsupp#9558 AS cpfk_part_partsupp_4#9572, cfpk_partsupp_part#9559 AS cfpk_partsupp_part_4#9573, cpfk_supplier_partsupp#9560 AS cpfk_supplier_partsupp_4#9574, cfpk_partsupp_supplier#9561 AS cfpk_partsupp_supplier_4#9575, cval_partsupp_ps_availqty#9562 AS cval_partsupp_ps_availqty_4#9576, cval_partsupp_ps_supplycost#9563 AS cval_partsupp_ps_supplycost_4#9577, cval_partsupp_ps_comment#9564 AS cval_partsupp_ps_comment_4#9578, cdepval_partsupp_ps_availqty#9565 AS cdepval_partsupp_ps_availqty_4#9579, cdepval_partsupp_ps_supplycost#9566 AS cdepval_partsupp_ps_supplycost_4#9580, cdepval_partsupp_ps_comment#9567 AS cdepval_partsupp_ps_comment_4#9581, cps_availqty#9568 AS cps_availqty_4#9582, cps_supplycost#9569 AS cps_supplycost_4#9583, cps_comment#9570 AS cps_comment_4#9584]
         :     +- Relation[rid#9557,cpfk_part_partsupp#9558,cfpk_partsupp_part#9559,cpfk_supplier_partsupp#9560,cfpk_partsupp_supplier#9561,cval_partsupp_ps_availqty#9562,cval_partsupp_ps_supplycost#9563,cval_partsupp_ps_comment#9564,cdepval_partsupp_ps_availqty#9565,cdepval_partsupp_ps_supplycost#9566,cdepval_partsupp_ps_comment#9567,cps_availqty#9568,cps_supplycost#9569,cps_comment#9570] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#9585 AS rid_5#9609, cpfk_customer_orders#9586 AS cpfk_customer_orders_5#9610, cfpk_orders_customer#9587 AS cfpk_orders_customer_5#9611, cval_orders_o_orderstatus#9588 AS cval_orders_o_orderstatus_5#9612, cval_orders_o_totalprice#9589 AS cval_orders_o_totalprice_5#9613, cval_orders_o_orderpriority#9590 AS cval_orders_o_orderpriority_5#9614, cval_orders_o_clerk#9591 AS cval_orders_o_clerk_5#9615, cval_orders_o_shippriority#9592 AS cval_orders_o_shippriority_5#9616, cval_orders_o_comment#9593 AS cval_orders_o_comment_5#9617, cval_orders_o_orderdate#9594 AS cval_orders_o_orderdate_5#9618, cdepval_orders_o_orderstatus#9595 AS cdepval_orders_o_orderstatus_5#9619, cdepval_orders_o_totalprice#9596 AS cdepval_orders_o_totalprice_5#9620, cdepval_orders_o_orderpriority#9597 AS cdepval_orders_o_orderpriority_5#9621, cdepval_orders_o_clerk#9598 AS cdepval_orders_o_clerk_5#9622, cdepval_orders_o_shippriority#9599 AS cdepval_orders_o_shippriority_5#9623, cdepval_orders_o_comment#9600 AS cdepval_orders_o_comment_5#9624, cdepval_orders_o_orderdate#9601 AS cdepval_orders_o_orderdate_5#9625, co_orderstatus#9602 AS co_orderstatus_5#9626, co_totalprice#9603 AS co_totalprice_5#9627, co_orderpriority#9604 AS co_orderpriority_5#9628, co_clerk#9605 AS co_clerk_5#9629, co_shippriority#9606 AS co_shippriority_5#9630, co_comment#9607 AS co_comment_5#9631, co_orderdate#9608 AS co_orderdate_5#9632]
            +- Relation[rid#9585,cpfk_customer_orders#9586,cfpk_orders_customer#9587,cval_orders_o_orderstatus#9588,cval_orders_o_totalprice#9589,cval_orders_o_orderpriority#9590,cval_orders_o_clerk#9591,cval_orders_o_shippriority#9592,cval_orders_o_comment#9593,cval_orders_o_orderdate#9594,cdepval_orders_o_orderstatus#9595,cdepval_orders_o_totalprice#9596,cdepval_orders_o_orderpriority#9597,cdepval_orders_o_clerk#9598,cdepval_orders_o_shippriority#9599,cdepval_orders_o_comment#9600,cdepval_orders_o_orderdate#9601,co_orderstatus#9602,co_totalprice#9603,co_orderpriority#9604,co_clerk#9605,co_shippriority#9606,co_comment#9607,co_orderdate#9608] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 65131ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/26 22:46:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:46:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9777L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:46:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9777L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#9869 AS rid_2#9914, cpfk_orders_lineitem#9870 AS cpfk_orders_lineitem_2#9915, cpfk_supplier_lineitem#9871 AS cpfk_supplier_lineitem_2#9916, cfpk_lineitem_supplier#9872 AS cfpk_lineitem_supplier_2#9917, cfpk_lineitem_partsupp#9873 AS cfpk_lineitem_partsupp_2#9918, cpfk_part_lineitem#9874 AS cpfk_part_lineitem_2#9919, cfpk_lineitem_part#9875 AS cfpk_lineitem_part_2#9920, cpfk_partsupp_lineitem#9876 AS cpfk_partsupp_lineitem_2#9921, cfpk_lineitem_orders#9877 AS cfpk_lineitem_orders_2#9922, cval_lineitem_l_quantity#9878 AS cval_lineitem_l_quantity_2#9923, cval_lineitem_l_extendedprice#9879 AS cval_lineitem_l_extendedprice_2#9924, cval_lineitem_l_discount#9880 AS cval_lineitem_l_discount_2#9925, cval_lineitem_l_tax#9881 AS cval_lineitem_l_tax_2#9926, cval_lineitem_l_returnflag#9882 AS cval_lineitem_l_returnflag_2#9927, cval_lineitem_l_linestatus#9883 AS cval_lineitem_l_linestatus_2#9928, cval_lineitem_l_commitdate#9884 AS cval_lineitem_l_commitdate_2#9929, cval_lineitem_l_receiptdate#9885 AS cval_lineitem_l_receiptdate_2#9930, cval_lineitem_l_shipinstruct#9886 AS cval_lineitem_l_shipinstruct_2#9931, cval_lineitem_l_shipmode#9887 AS cval_lineitem_l_shipmode_2#9932, cval_lineitem_l_comment#9888 AS cval_lineitem_l_comment_2#9933, cval_lineitem_l_shipdate#9889 AS cval_lineitem_l_shipdate_2#9934, cdepval_lineitem_l_quantity#9890 AS cdepval_lineitem_l_quantity_2#9935, cdepval_lineitem_l_extendedprice#9891 AS cdepval_lineitem_l_extendedprice_2#9936, cdepval_lineitem_l_discount#9892 AS cdepval_lineitem_l_discount_2#9937, ... 21 more fields]
         :  +- Relation[rid#9869,cpfk_orders_lineitem#9870,cpfk_supplier_lineitem#9871,cfpk_lineitem_supplier#9872,cfpk_lineitem_partsupp#9873,cpfk_part_lineitem#9874,cfpk_lineitem_part#9875,cpfk_partsupp_lineitem#9876,cfpk_lineitem_orders#9877,cval_lineitem_l_quantity#9878,cval_lineitem_l_extendedprice#9879,cval_lineitem_l_discount#9880,cval_lineitem_l_tax#9881,cval_lineitem_l_returnflag#9882,cval_lineitem_l_linestatus#9883,cval_lineitem_l_commitdate#9884,cval_lineitem_l_receiptdate#9885,cval_lineitem_l_shipinstruct#9886,cval_lineitem_l_shipmode#9887,cval_lineitem_l_comment#9888,cval_lineitem_l_shipdate#9889,cdepval_lineitem_l_quantity#9890,cdepval_lineitem_l_extendedprice#9891,cdepval_lineitem_l_discount#9892,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#9821 AS rid_1#9845, cpfk_customer_orders#9822 AS cpfk_customer_orders_1#9846, cfpk_orders_customer#9823 AS cfpk_orders_customer_1#9847, cval_orders_o_orderstatus#9824 AS cval_orders_o_orderstatus_1#9848, cval_orders_o_totalprice#9825 AS cval_orders_o_totalprice_1#9849, cval_orders_o_orderpriority#9826 AS cval_orders_o_orderpriority_1#9850, cval_orders_o_clerk#9827 AS cval_orders_o_clerk_1#9851, cval_orders_o_shippriority#9828 AS cval_orders_o_shippriority_1#9852, cval_orders_o_comment#9829 AS cval_orders_o_comment_1#9853, cval_orders_o_orderdate#9830 AS cval_orders_o_orderdate_1#9854, cdepval_orders_o_orderstatus#9831 AS cdepval_orders_o_orderstatus_1#9855, cdepval_orders_o_totalprice#9832 AS cdepval_orders_o_totalprice_1#9856, cdepval_orders_o_orderpriority#9833 AS cdepval_orders_o_orderpriority_1#9857, cdepval_orders_o_clerk#9834 AS cdepval_orders_o_clerk_1#9858, cdepval_orders_o_shippriority#9835 AS cdepval_orders_o_shippriority_1#9859, cdepval_orders_o_comment#9836 AS cdepval_orders_o_comment_1#9860, cdepval_orders_o_orderdate#9837 AS cdepval_orders_o_orderdate_1#9861, co_orderstatus#9838 AS co_orderstatus_1#9862, co_totalprice#9839 AS co_totalprice_1#9863, co_orderpriority#9840 AS co_orderpriority_1#9864, co_clerk#9841 AS co_clerk_1#9865, co_shippriority#9842 AS co_shippriority_1#9866, co_comment#9843 AS co_comment_1#9867, co_orderdate#9844 AS co_orderdate_1#9868]
            :  +- Relation[rid#9821,cpfk_customer_orders#9822,cfpk_orders_customer#9823,cval_orders_o_orderstatus#9824,cval_orders_o_totalprice#9825,cval_orders_o_orderpriority#9826,cval_orders_o_clerk#9827,cval_orders_o_shippriority#9828,cval_orders_o_comment#9829,cval_orders_o_orderdate#9830,cdepval_orders_o_orderstatus#9831,cdepval_orders_o_totalprice#9832,cdepval_orders_o_orderpriority#9833,cdepval_orders_o_clerk#9834,cdepval_orders_o_shippriority#9835,cdepval_orders_o_comment#9836,cdepval_orders_o_orderdate#9837,co_orderstatus#9838,co_totalprice#9839,co_orderpriority#9840,co_clerk#9841,co_shippriority#9842,co_comment#9843,co_orderdate#9844] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#9779 AS rid_0#9800, cpfk_nation_customer#9780 AS cpfk_nation_customer_0#9801, cfpk_customer_nation#9781 AS cfpk_customer_nation_0#9802, cval_customer_c_name#9782 AS cval_customer_c_name_0#9803, cval_customer_c_address#9783 AS cval_customer_c_address_0#9804, cval_customer_c_phone#9784 AS cval_customer_c_phone_0#9805, cval_customer_c_acctbal#9785 AS cval_customer_c_acctbal_0#9806, cval_customer_c_comment#9786 AS cval_customer_c_comment_0#9807, cval_customer_c_mktsegment#9787 AS cval_customer_c_mktsegment_0#9808, cdepval_customer_c_name#9788 AS cdepval_customer_c_name_0#9809, cdepval_customer_c_address#9789 AS cdepval_customer_c_address_0#9810, cdepval_customer_c_phone#9790 AS cdepval_customer_c_phone_0#9811, cdepval_customer_c_acctbal#9791 AS cdepval_customer_c_acctbal_0#9812, cdepval_customer_c_comment#9792 AS cdepval_customer_c_comment_0#9813, cdepval_customer_c_mktsegment#9793 AS cdepval_customer_c_mktsegment_0#9814, cc_name#9794 AS cc_name_0#9815, cc_address#9795 AS cc_address_0#9816, cc_phone#9796 AS cc_phone_0#9817, cc_acctbal#9797 AS cc_acctbal_0#9818, cc_comment#9798 AS cc_comment_0#9819, cc_mktsegment#9799 AS cc_mktsegment_0#9820]
               +- Relation[rid#9779,cpfk_nation_customer#9780,cfpk_customer_nation#9781,cval_customer_c_name#9782,cval_customer_c_address#9783,cval_customer_c_phone#9784,cval_customer_c_acctbal#9785,cval_customer_c_comment#9786,cval_customer_c_mktsegment#9787,cdepval_customer_c_name#9788,cdepval_customer_c_address#9789,cdepval_customer_c_phone#9790,cdepval_customer_c_acctbal#9791,cdepval_customer_c_comment#9792,cdepval_customer_c_mktsegment#9793,cc_name#9794,cc_address#9795,cc_phone#9796,cc_acctbal#9797,cc_comment#9798,cc_mktsegment#9799] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 23269ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/26 22:47:12 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:47:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#10056L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:47:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:47:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:47:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#10056L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#10094 AS rid_1#10139, cpfk_orders_lineitem#10095 AS cpfk_orders_lineitem_1#10140, cpfk_supplier_lineitem#10096 AS cpfk_supplier_lineitem_1#10141, cfpk_lineitem_supplier#10097 AS cfpk_lineitem_supplier_1#10142, cfpk_lineitem_partsupp#10098 AS cfpk_lineitem_partsupp_1#10143, cpfk_part_lineitem#10099 AS cpfk_part_lineitem_1#10144, cfpk_lineitem_part#10100 AS cfpk_lineitem_part_1#10145, cpfk_partsupp_lineitem#10101 AS cpfk_partsupp_lineitem_1#10146, cfpk_lineitem_orders#10102 AS cfpk_lineitem_orders_1#10147, cval_lineitem_l_quantity#10103 AS cval_lineitem_l_quantity_1#10148, cval_lineitem_l_extendedprice#10104 AS cval_lineitem_l_extendedprice_1#10149, cval_lineitem_l_discount#10105 AS cval_lineitem_l_discount_1#10150, cval_lineitem_l_tax#10106 AS cval_lineitem_l_tax_1#10151, cval_lineitem_l_returnflag#10107 AS cval_lineitem_l_returnflag_1#10152, cval_lineitem_l_linestatus#10108 AS cval_lineitem_l_linestatus_1#10153, cval_lineitem_l_commitdate#10109 AS cval_lineitem_l_commitdate_1#10154, cval_lineitem_l_receiptdate#10110 AS cval_lineitem_l_receiptdate_1#10155, cval_lineitem_l_shipinstruct#10111 AS cval_lineitem_l_shipinstruct_1#10156, cval_lineitem_l_shipmode#10112 AS cval_lineitem_l_shipmode_1#10157, cval_lineitem_l_comment#10113 AS cval_lineitem_l_comment_1#10158, cval_lineitem_l_shipdate#10114 AS cval_lineitem_l_shipdate_1#10159, cdepval_lineitem_l_quantity#10115 AS cdepval_lineitem_l_quantity_1#10160, cdepval_lineitem_l_extendedprice#10116 AS cdepval_lineitem_l_extendedprice_1#10161, cdepval_lineitem_l_discount#10117 AS cdepval_lineitem_l_discount_1#10162, ... 21 more fields]
         :  +- Relation[rid#10094,cpfk_orders_lineitem#10095,cpfk_supplier_lineitem#10096,cfpk_lineitem_supplier#10097,cfpk_lineitem_partsupp#10098,cpfk_part_lineitem#10099,cfpk_lineitem_part#10100,cpfk_partsupp_lineitem#10101,cfpk_lineitem_orders#10102,cval_lineitem_l_quantity#10103,cval_lineitem_l_extendedprice#10104,cval_lineitem_l_discount#10105,cval_lineitem_l_tax#10106,cval_lineitem_l_returnflag#10107,cval_lineitem_l_linestatus#10108,cval_lineitem_l_commitdate#10109,cval_lineitem_l_receiptdate#10110,cval_lineitem_l_shipinstruct#10111,cval_lineitem_l_shipmode#10112,cval_lineitem_l_comment#10113,cval_lineitem_l_shipdate#10114,cdepval_lineitem_l_quantity#10115,cdepval_lineitem_l_extendedprice#10116,cdepval_lineitem_l_discount#10117,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#10058 AS rid_0#10076, cpfk_nation_supplier#10059 AS cpfk_nation_supplier_0#10077, cfpk_supplier_nation#10060 AS cfpk_supplier_nation_0#10078, cval_supplier_s_name#10061 AS cval_supplier_s_name_0#10079, cval_supplier_s_address#10062 AS cval_supplier_s_address_0#10080, cval_supplier_s_phone#10063 AS cval_supplier_s_phone_0#10081, cval_supplier_s_acctbal#10064 AS cval_supplier_s_acctbal_0#10082, cval_supplier_s_comment#10065 AS cval_supplier_s_comment_0#10083, cdepval_supplier_s_name#10066 AS cdepval_supplier_s_name_0#10084, cdepval_supplier_s_address#10067 AS cdepval_supplier_s_address_0#10085, cdepval_supplier_s_phone#10068 AS cdepval_supplier_s_phone_0#10086, cdepval_supplier_s_acctbal#10069 AS cdepval_supplier_s_acctbal_0#10087, cdepval_supplier_s_comment#10070 AS cdepval_supplier_s_comment_0#10088, cs_name#10071 AS cs_name_0#10089, cs_address#10072 AS cs_address_0#10090, cs_phone#10073 AS cs_phone_0#10091, cs_acctbal#10074 AS cs_acctbal_0#10092, cs_comment#10075 AS cs_comment_0#10093]
            +- Relation[rid#10058,cpfk_nation_supplier#10059,cfpk_supplier_nation#10060,cval_supplier_s_name#10061,cval_supplier_s_address#10062,cval_supplier_s_phone#10063,cval_supplier_s_acctbal#10064,cval_supplier_s_comment#10065,cdepval_supplier_s_name#10066,cdepval_supplier_s_address#10067,cdepval_supplier_s_phone#10068,cdepval_supplier_s_acctbal#10069,cdepval_supplier_s_comment#10070,cs_name#10071,cs_address#10072,cs_phone#10073,cs_acctbal#10074,cs_comment#10075] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17778ms
query=q1, count=6001215, duration=2444
query=q10, count=1478870, duration=67154
query=q11, count=31680, duration=2583
query=q12, count=857401, duration=24467
query=q13, count=1500000, duration=4535
query=q14, count=6001215, duration=18431
query=q15, count=6001215, duration=17778
query=q16, count=15780, duration=774
query=q17, count=6088, duration=552
query=q18, count=6001215, duration=23269
query=q19, count=205, duration=18523
query=q2, count=3162, duration=973
query=q20, count=632, duration=908
query=q21a, count=597422, duration=171914
query=q22, count=1500000, duration=4701
query=q3, count=1214743, duration=26356
query=q4, count=6001215, duration=22552
query=q5, count=48089, duration=30493
query=q6, count=6001215, duration=2425
query=q7, count=9735, duration=41171
query=q8, count=8716, duration=3817
query=q9a, count=6001215, duration=65131
query=q9b, count=6001215, duration=38850
