20/04/25 21:52:01 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10893ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 25 21:52:04 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 25 21:52:05 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 25 21:52:05 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 25 21:52:05 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 25 21:52:05 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 25 21:52:09 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 25 21:52:13 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 25 21:52:13 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/25 21:52:15 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:52:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2102L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 21:52:15 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/25 21:52:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2102L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#2104 AS rid_0#2149, cpfk_orders_lineitem#2105 AS cpfk_orders_lineitem_0#2150, cpfk_supplier_lineitem#2106 AS cpfk_supplier_lineitem_0#2151, cfpk_lineitem_supplier#2107 AS cfpk_lineitem_supplier_0#2152, cfpk_lineitem_partsupp#2108 AS cfpk_lineitem_partsupp_0#2153, cpfk_part_lineitem#2109 AS cpfk_part_lineitem_0#2154, cfpk_lineitem_part#2110 AS cfpk_lineitem_part_0#2155, cpfk_partsupp_lineitem#2111 AS cpfk_partsupp_lineitem_0#2156, cfpk_lineitem_orders#2112 AS cfpk_lineitem_orders_0#2157, cval_lineitem_l_quantity#2113 AS cval_lineitem_l_quantity_0#2158, cval_lineitem_l_extendedprice#2114 AS cval_lineitem_l_extendedprice_0#2159, cval_lineitem_l_discount#2115 AS cval_lineitem_l_discount_0#2160, cval_lineitem_l_tax#2116 AS cval_lineitem_l_tax_0#2161, cval_lineitem_l_returnflag#2117 AS cval_lineitem_l_returnflag_0#2162, cval_lineitem_l_linestatus#2118 AS cval_lineitem_l_linestatus_0#2163, cval_lineitem_l_commitdate#2119 AS cval_lineitem_l_commitdate_0#2164, cval_lineitem_l_receiptdate#2120 AS cval_lineitem_l_receiptdate_0#2165, cval_lineitem_l_shipinstruct#2121 AS cval_lineitem_l_shipinstruct_0#2166, cval_lineitem_l_shipmode#2122 AS cval_lineitem_l_shipmode_0#2167, cval_lineitem_l_comment#2123 AS cval_lineitem_l_comment_0#2168, cval_lineitem_l_shipdate#2124 AS cval_lineitem_l_shipdate_0#2169, cdepval_lineitem_l_quantity#2125 AS cdepval_lineitem_l_quantity_0#2170, cdepval_lineitem_l_extendedprice#2126 AS cdepval_lineitem_l_extendedprice_0#2171, cdepval_lineitem_l_discount#2127 AS cdepval_lineitem_l_discount_0#2172, ... 21 more fields]
         :  +- Relation[rid#2104,cpfk_orders_lineitem#2105,cpfk_supplier_lineitem#2106,cfpk_lineitem_supplier#2107,cfpk_lineitem_partsupp#2108,cpfk_part_lineitem#2109,cfpk_lineitem_part#2110,cpfk_partsupp_lineitem#2111,cfpk_lineitem_orders#2112,cval_lineitem_l_quantity#2113,cval_lineitem_l_extendedprice#2114,cval_lineitem_l_discount#2115,cval_lineitem_l_tax#2116,cval_lineitem_l_returnflag#2117,cval_lineitem_l_linestatus#2118,cval_lineitem_l_commitdate#2119,cval_lineitem_l_receiptdate#2120,cval_lineitem_l_shipinstruct#2121,cval_lineitem_l_shipmode#2122,cval_lineitem_l_comment#2123,cval_lineitem_l_shipdate#2124,cdepval_lineitem_l_quantity#2125,cdepval_lineitem_l_extendedprice#2126,cdepval_lineitem_l_discount#2127,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2194 AS rid_1#2218, cpfk_customer_orders#2195 AS cpfk_customer_orders_1#2219, cfpk_orders_customer#2196 AS cfpk_orders_customer_1#2220, cval_orders_o_orderstatus#2197 AS cval_orders_o_orderstatus_1#2221, cval_orders_o_totalprice#2198 AS cval_orders_o_totalprice_1#2222, cval_orders_o_orderpriority#2199 AS cval_orders_o_orderpriority_1#2223, cval_orders_o_clerk#2200 AS cval_orders_o_clerk_1#2224, cval_orders_o_shippriority#2201 AS cval_orders_o_shippriority_1#2225, cval_orders_o_comment#2202 AS cval_orders_o_comment_1#2226, cval_orders_o_orderdate#2203 AS cval_orders_o_orderdate_1#2227, cdepval_orders_o_orderstatus#2204 AS cdepval_orders_o_orderstatus_1#2228, cdepval_orders_o_totalprice#2205 AS cdepval_orders_o_totalprice_1#2229, cdepval_orders_o_orderpriority#2206 AS cdepval_orders_o_orderpriority_1#2230, cdepval_orders_o_clerk#2207 AS cdepval_orders_o_clerk_1#2231, cdepval_orders_o_shippriority#2208 AS cdepval_orders_o_shippriority_1#2232, cdepval_orders_o_comment#2209 AS cdepval_orders_o_comment_1#2233, cdepval_orders_o_orderdate#2210 AS cdepval_orders_o_orderdate_1#2234, co_orderstatus#2211 AS co_orderstatus_1#2235, co_totalprice#2212 AS co_totalprice_1#2236, co_orderpriority#2213 AS co_orderpriority_1#2237, co_clerk#2214 AS co_clerk_1#2238, co_shippriority#2215 AS co_shippriority_1#2239, co_comment#2216 AS co_comment_1#2240, co_orderdate#2217 AS co_orderdate_1#2241]
            +- Relation[rid#2194,cpfk_customer_orders#2195,cfpk_orders_customer#2196,cval_orders_o_orderstatus#2197,cval_orders_o_totalprice#2198,cval_orders_o_orderpriority#2199,cval_orders_o_clerk#2200,cval_orders_o_shippriority#2201,cval_orders_o_comment#2202,cval_orders_o_orderdate#2203,cdepval_orders_o_orderstatus#2204,cdepval_orders_o_totalprice#2205,cdepval_orders_o_orderpriority#2206,cdepval_orders_o_clerk#2207,cdepval_orders_o_shippriority#2208,cdepval_orders_o_comment#2209,cdepval_orders_o_orderdate#2210,co_orderstatus#2211,co_totalprice#2212,co_orderpriority#2213,co_clerk#2214,co_shippriority#2215,co_comment#2216,co_orderdate#2217] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18737ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/25 21:52:34 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:52:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2316L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 21:52:34 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 21:52:34 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 21:52:34 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 21:52:34 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 21:52:34 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 21:52:34 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 21:52:34 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 21:52:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2316L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#2343, cval_part_p_name_0#2344, cval_part_p_mfgr_0#2345, cval_part_p_type_0#2346, cval_part_p_size_0#2347, cval_part_p_container_0#2348, cval_part_p_retailprice_0#2349, cval_part_p_comment_0#2350, cval_part_p_brand_0#2351, cdepval_part_p_name_0#2352, cdepval_part_p_mfgr_0#2353, cdepval_part_p_type_0#2354, cdepval_part_p_size_0#2355, cdepval_part_p_container_0#2356, cdepval_part_p_retailprice_0#2357, cdepval_part_p_comment_0#2358, cdepval_part_p_brand_0#2359, cp_name_0#2360, cp_mfgr_0#2361, cp_type_0#2362, cp_size_0#2363, cp_container_0#2364, cp_retailprice_0#2365, cp_comment_0#2366, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#2318 AS rid_0#2343, cval_part_p_name#2319 AS cval_part_p_name_0#2344, cval_part_p_mfgr#2320 AS cval_part_p_mfgr_0#2345, cval_part_p_type#2321 AS cval_part_p_type_0#2346, cval_part_p_size#2322 AS cval_part_p_size_0#2347, cval_part_p_container#2323 AS cval_part_p_container_0#2348, cval_part_p_retailprice#2324 AS cval_part_p_retailprice_0#2349, cval_part_p_comment#2325 AS cval_part_p_comment_0#2350, cval_part_p_brand#2326 AS cval_part_p_brand_0#2351, cdepval_part_p_name#2327 AS cdepval_part_p_name_0#2352, cdepval_part_p_mfgr#2328 AS cdepval_part_p_mfgr_0#2353, cdepval_part_p_type#2329 AS cdepval_part_p_type_0#2354, cdepval_part_p_size#2330 AS cdepval_part_p_size_0#2355, cdepval_part_p_container#2331 AS cdepval_part_p_container_0#2356, cdepval_part_p_retailprice#2332 AS cdepval_part_p_retailprice_0#2357, cdepval_part_p_comment#2333 AS cdepval_part_p_comment_0#2358, cdepval_part_p_brand#2334 AS cdepval_part_p_brand_0#2359, cp_name#2335 AS cp_name_0#2360, cp_mfgr#2336 AS cp_mfgr_0#2361, cp_type#2337 AS cp_type_0#2362, cp_size#2338 AS cp_size_0#2363, cp_container#2339 AS cp_container_0#2364, cp_retailprice#2340 AS cp_retailprice_0#2365, cp_comment#2341 AS cp_comment_0#2366, cp_brand#2342 AS cp_brand_0#2367]
         :  :        +- Relation[rid#2318,cval_part_p_name#2319,cval_part_p_mfgr#2320,cval_part_p_type#2321,cval_part_p_size#2322,cval_part_p_container#2323,cval_part_p_retailprice#2324,cval_part_p_comment#2325,cval_part_p_brand#2326,cdepval_part_p_name#2327,cdepval_part_p_mfgr#2328,cdepval_part_p_type#2329,cdepval_part_p_size#2330,cdepval_part_p_container#2331,cdepval_part_p_retailprice#2332,cdepval_part_p_comment#2333,cdepval_part_p_brand#2334,cp_name#2335,cp_mfgr#2336,cp_type#2337,cp_size#2338,cp_container#2339,cp_retailprice#2340,cp_comment#2341,cp_brand#2342] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#2788 AS rid_1#2833, cpfk_orders_lineitem#2789 AS cpfk_orders_lineitem_1#2834, cpfk_supplier_lineitem#2790 AS cpfk_supplier_lineitem_1#2835, cfpk_lineitem_supplier#2791 AS cfpk_lineitem_supplier_1#2836, cfpk_lineitem_partsupp#2792 AS cfpk_lineitem_partsupp_1#2837, cpfk_part_lineitem#2793 AS cpfk_part_lineitem_1#2838, cfpk_lineitem_part#2794 AS cfpk_lineitem_part_1#2839, cpfk_partsupp_lineitem#2795 AS cpfk_partsupp_lineitem_1#2840, cfpk_lineitem_orders#2796 AS cfpk_lineitem_orders_1#2841, cval_lineitem_l_quantity#2797 AS cval_lineitem_l_quantity_1#2842, cval_lineitem_l_extendedprice#2798 AS cval_lineitem_l_extendedprice_1#2843, cval_lineitem_l_discount#2799 AS cval_lineitem_l_discount_1#2844, cval_lineitem_l_tax#2800 AS cval_lineitem_l_tax_1#2845, cval_lineitem_l_returnflag#2801 AS cval_lineitem_l_returnflag_1#2846, cval_lineitem_l_linestatus#2802 AS cval_lineitem_l_linestatus_1#2847, cval_lineitem_l_commitdate#2803 AS cval_lineitem_l_commitdate_1#2848, cval_lineitem_l_receiptdate#2804 AS cval_lineitem_l_receiptdate_1#2849, cval_lineitem_l_shipinstruct#2805 AS cval_lineitem_l_shipinstruct_1#2850, cval_lineitem_l_shipmode#2806 AS cval_lineitem_l_shipmode_1#2851, cval_lineitem_l_comment#2807 AS cval_lineitem_l_comment_1#2852, cval_lineitem_l_shipdate#2808 AS cval_lineitem_l_shipdate_1#2853, cdepval_lineitem_l_quantity#2809 AS cdepval_lineitem_l_quantity_1#2854, cdepval_lineitem_l_extendedprice#2810 AS cdepval_lineitem_l_extendedprice_1#2855, cdepval_lineitem_l_discount#2811 AS cdepval_lineitem_l_discount_1#2856, ... 21 more fields]
         :        +- Relation[rid#2788,cpfk_orders_lineitem#2789,cpfk_supplier_lineitem#2790,cfpk_lineitem_supplier#2791,cfpk_lineitem_partsupp#2792,cpfk_part_lineitem#2793,cfpk_lineitem_part#2794,cpfk_partsupp_lineitem#2795,cfpk_lineitem_orders#2796,cval_lineitem_l_quantity#2797,cval_lineitem_l_extendedprice#2798,cval_lineitem_l_discount#2799,cval_lineitem_l_tax#2800,cval_lineitem_l_returnflag#2801,cval_lineitem_l_linestatus#2802,cval_lineitem_l_commitdate#2803,cval_lineitem_l_receiptdate#2804,cval_lineitem_l_shipinstruct#2805,cval_lineitem_l_shipmode#2806,cval_lineitem_l_comment#2807,cval_lineitem_l_shipdate#2808,cdepval_lineitem_l_quantity#2809,cdepval_lineitem_l_extendedprice#2810,cdepval_lineitem_l_discount#2811,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#2468 AS rid_1#2513, cpfk_orders_lineitem#2469 AS cpfk_orders_lineitem_1#2514, cpfk_supplier_lineitem#2470 AS cpfk_supplier_lineitem_1#2515, cfpk_lineitem_supplier#2471 AS cfpk_lineitem_supplier_1#2516, cfpk_lineitem_partsupp#2472 AS cfpk_lineitem_partsupp_1#2517, cpfk_part_lineitem#2473 AS cpfk_part_lineitem_1#2518, cfpk_lineitem_part#2474 AS cfpk_lineitem_part_1#2519, cpfk_partsupp_lineitem#2475 AS cpfk_partsupp_lineitem_1#2520, cfpk_lineitem_orders#2476 AS cfpk_lineitem_orders_1#2521, cval_lineitem_l_quantity#2477 AS cval_lineitem_l_quantity_1#2522, cval_lineitem_l_extendedprice#2478 AS cval_lineitem_l_extendedprice_1#2523, cval_lineitem_l_discount#2479 AS cval_lineitem_l_discount_1#2524, cval_lineitem_l_tax#2480 AS cval_lineitem_l_tax_1#2525, cval_lineitem_l_returnflag#2481 AS cval_lineitem_l_returnflag_1#2526, cval_lineitem_l_linestatus#2482 AS cval_lineitem_l_linestatus_1#2527, cval_lineitem_l_commitdate#2483 AS cval_lineitem_l_commitdate_1#2528, cval_lineitem_l_receiptdate#2484 AS cval_lineitem_l_receiptdate_1#2529, cval_lineitem_l_shipinstruct#2485 AS cval_lineitem_l_shipinstruct_1#2530, cval_lineitem_l_shipmode#2486 AS cval_lineitem_l_shipmode_1#2531, cval_lineitem_l_comment#2487 AS cval_lineitem_l_comment_1#2532, cval_lineitem_l_shipdate#2488 AS cval_lineitem_l_shipdate_1#2533, cdepval_lineitem_l_quantity#2489 AS cdepval_lineitem_l_quantity_1#2534, cdepval_lineitem_l_extendedprice#2490 AS cdepval_lineitem_l_extendedprice_1#2535, cdepval_lineitem_l_discount#2491 AS cdepval_lineitem_l_discount_1#2536, ... 21 more fields]
                  +- Relation[rid#2468,cpfk_orders_lineitem#2469,cpfk_supplier_lineitem#2470,cfpk_lineitem_supplier#2471,cfpk_lineitem_partsupp#2472,cpfk_part_lineitem#2473,cfpk_lineitem_part#2474,cpfk_partsupp_lineitem#2475,cfpk_lineitem_orders#2476,cval_lineitem_l_quantity#2477,cval_lineitem_l_extendedprice#2478,cval_lineitem_l_discount#2479,cval_lineitem_l_tax#2480,cval_lineitem_l_returnflag#2481,cval_lineitem_l_linestatus#2482,cval_lineitem_l_commitdate#2483,cval_lineitem_l_receiptdate#2484,cval_lineitem_l_shipinstruct#2485,cval_lineitem_l_shipmode#2486,cval_lineitem_l_comment#2487,cval_lineitem_l_shipdate#2488,cdepval_lineitem_l_quantity#2489,cdepval_lineitem_l_extendedprice#2490,cdepval_lineitem_l_discount#2491,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 18506ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/25 21:52:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:52:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2954L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 21:52:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 21:52:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 21:52:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 21:52:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:52:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 21:52:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:52:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:52:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:52:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:52:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:52:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:52:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2954L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#3092 AS rid_4#3137, cpfk_orders_lineitem#3093 AS cpfk_orders_lineitem_4#3138, cpfk_supplier_lineitem#3094 AS cpfk_supplier_lineitem_4#3139, cfpk_lineitem_supplier#3095 AS cfpk_lineitem_supplier_4#3140, cfpk_lineitem_partsupp#3096 AS cfpk_lineitem_partsupp_4#3141, cpfk_part_lineitem#3097 AS cpfk_part_lineitem_4#3142, cfpk_lineitem_part#3098 AS cfpk_lineitem_part_4#3143, cpfk_partsupp_lineitem#3099 AS cpfk_partsupp_lineitem_4#3144, cfpk_lineitem_orders#3100 AS cfpk_lineitem_orders_4#3145, cval_lineitem_l_quantity#3101 AS cval_lineitem_l_quantity_4#3146, cval_lineitem_l_extendedprice#3102 AS cval_lineitem_l_extendedprice_4#3147, cval_lineitem_l_discount#3103 AS cval_lineitem_l_discount_4#3148, cval_lineitem_l_tax#3104 AS cval_lineitem_l_tax_4#3149, cval_lineitem_l_returnflag#3105 AS cval_lineitem_l_returnflag_4#3150, cval_lineitem_l_linestatus#3106 AS cval_lineitem_l_linestatus_4#3151, cval_lineitem_l_commitdate#3107 AS cval_lineitem_l_commitdate_4#3152, cval_lineitem_l_receiptdate#3108 AS cval_lineitem_l_receiptdate_4#3153, cval_lineitem_l_shipinstruct#3109 AS cval_lineitem_l_shipinstruct_4#3154, cval_lineitem_l_shipmode#3110 AS cval_lineitem_l_shipmode_4#3155, cval_lineitem_l_comment#3111 AS cval_lineitem_l_comment_4#3156, cval_lineitem_l_shipdate#3112 AS cval_lineitem_l_shipdate_4#3157, cdepval_lineitem_l_quantity#3113 AS cdepval_lineitem_l_quantity_4#3158, cdepval_lineitem_l_extendedprice#3114 AS cdepval_lineitem_l_extendedprice_4#3159, cdepval_lineitem_l_discount#3115 AS cdepval_lineitem_l_discount_4#3160, ... 21 more fields]
            :  :  +- Relation[rid#3092,cpfk_orders_lineitem#3093,cpfk_supplier_lineitem#3094,cfpk_lineitem_supplier#3095,cfpk_lineitem_partsupp#3096,cpfk_part_lineitem#3097,cfpk_lineitem_part#3098,cpfk_partsupp_lineitem#3099,cfpk_lineitem_orders#3100,cval_lineitem_l_quantity#3101,cval_lineitem_l_extendedprice#3102,cval_lineitem_l_discount#3103,cval_lineitem_l_tax#3104,cval_lineitem_l_returnflag#3105,cval_lineitem_l_linestatus#3106,cval_lineitem_l_commitdate#3107,cval_lineitem_l_receiptdate#3108,cval_lineitem_l_shipinstruct#3109,cval_lineitem_l_shipmode#3110,cval_lineitem_l_comment#3111,cval_lineitem_l_shipdate#3112,cdepval_lineitem_l_quantity#3113,cdepval_lineitem_l_extendedprice#3114,cdepval_lineitem_l_discount#3115,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#3044 AS rid_3#3068, cpfk_customer_orders#3045 AS cpfk_customer_orders_3#3069, cfpk_orders_customer#3046 AS cfpk_orders_customer_3#3070, cval_orders_o_orderstatus#3047 AS cval_orders_o_orderstatus_3#3071, cval_orders_o_totalprice#3048 AS cval_orders_o_totalprice_3#3072, cval_orders_o_orderpriority#3049 AS cval_orders_o_orderpriority_3#3073, cval_orders_o_clerk#3050 AS cval_orders_o_clerk_3#3074, cval_orders_o_shippriority#3051 AS cval_orders_o_shippriority_3#3075, cval_orders_o_comment#3052 AS cval_orders_o_comment_3#3076, cval_orders_o_orderdate#3053 AS cval_orders_o_orderdate_3#3077, cdepval_orders_o_orderstatus#3054 AS cdepval_orders_o_orderstatus_3#3078, cdepval_orders_o_totalprice#3055 AS cdepval_orders_o_totalprice_3#3079, cdepval_orders_o_orderpriority#3056 AS cdepval_orders_o_orderpriority_3#3080, cdepval_orders_o_clerk#3057 AS cdepval_orders_o_clerk_3#3081, cdepval_orders_o_shippriority#3058 AS cdepval_orders_o_shippriority_3#3082, cdepval_orders_o_comment#3059 AS cdepval_orders_o_comment_3#3083, cdepval_orders_o_orderdate#3060 AS cdepval_orders_o_orderdate_3#3084, co_orderstatus#3061 AS co_orderstatus_3#3085, co_totalprice#3062 AS co_totalprice_3#3086, co_orderpriority#3063 AS co_orderpriority_3#3087, co_clerk#3064 AS co_clerk_3#3088, co_shippriority#3065 AS co_shippriority_3#3089, co_comment#3066 AS co_comment_3#3090, co_orderdate#3067 AS co_orderdate_3#3091]
            :     :  +- Relation[rid#3044,cpfk_customer_orders#3045,cfpk_orders_customer#3046,cval_orders_o_orderstatus#3047,cval_orders_o_totalprice#3048,cval_orders_o_orderpriority#3049,cval_orders_o_clerk#3050,cval_orders_o_shippriority#3051,cval_orders_o_comment#3052,cval_orders_o_orderdate#3053,cdepval_orders_o_orderstatus#3054,cdepval_orders_o_totalprice#3055,cdepval_orders_o_orderpriority#3056,cdepval_orders_o_clerk#3057,cdepval_orders_o_shippriority#3058,cdepval_orders_o_comment#3059,cdepval_orders_o_orderdate#3060,co_orderstatus#3061,co_totalprice#3062,co_orderpriority#3063,co_clerk#3064,co_shippriority#3065,co_comment#3066,co_orderdate#3067] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#3002 AS rid_2#3023, cpfk_nation_customer#3003 AS cpfk_nation_customer_2#3024, cfpk_customer_nation#3004 AS cfpk_customer_nation_2#3025, cval_customer_c_name#3005 AS cval_customer_c_name_2#3026, cval_customer_c_address#3006 AS cval_customer_c_address_2#3027, cval_customer_c_phone#3007 AS cval_customer_c_phone_2#3028, cval_customer_c_acctbal#3008 AS cval_customer_c_acctbal_2#3029, cval_customer_c_comment#3009 AS cval_customer_c_comment_2#3030, cval_customer_c_mktsegment#3010 AS cval_customer_c_mktsegment_2#3031, cdepval_customer_c_name#3011 AS cdepval_customer_c_name_2#3032, cdepval_customer_c_address#3012 AS cdepval_customer_c_address_2#3033, cdepval_customer_c_phone#3013 AS cdepval_customer_c_phone_2#3034, cdepval_customer_c_acctbal#3014 AS cdepval_customer_c_acctbal_2#3035, cdepval_customer_c_comment#3015 AS cdepval_customer_c_comment_2#3036, cdepval_customer_c_mktsegment#3016 AS cdepval_customer_c_mktsegment_2#3037, cc_name#3017 AS cc_name_2#3038, cc_address#3018 AS cc_address_2#3039, cc_phone#3019 AS cc_phone_2#3040, cc_acctbal#3020 AS cc_acctbal_2#3041, cc_comment#3021 AS cc_comment_2#3042, cc_mktsegment#3022 AS cc_mktsegment_2#3043]
            :        :  +- Relation[rid#3002,cpfk_nation_customer#3003,cfpk_customer_nation#3004,cval_customer_c_name#3005,cval_customer_c_address#3006,cval_customer_c_phone#3007,cval_customer_c_acctbal#3008,cval_customer_c_comment#3009,cval_customer_c_mktsegment#3010,cdepval_customer_c_name#3011,cdepval_customer_c_address#3012,cdepval_customer_c_phone#3013,cdepval_customer_c_acctbal#3014,cdepval_customer_c_comment#3015,cdepval_customer_c_mktsegment#3016,cc_name#3017,cc_address#3018,cc_phone#3019,cc_acctbal#3020,cc_comment#3021,cc_mktsegment#3022] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
            :           :- Project [rid#2984 AS rid_1#2993, cpfk_region_nation#2985 AS cpfk_region_nation_1#2994, cfpk_nation_region#2986 AS cfpk_nation_region_1#2995, cval_nation_n_name#2987 AS cval_nation_n_name_1#2996, cval_nation_n_comment#2988 AS cval_nation_n_comment_1#2997, cdepval_nation_n_name#2989 AS cdepval_nation_n_name_1#2998, cdepval_nation_n_comment#2990 AS cdepval_nation_n_comment_1#2999, cn_name#2991 AS cn_name_1#3000, cn_comment#2992 AS cn_comment_1#3001]
            :           :  +- Relation[rid#2984,cpfk_region_nation#2985,cfpk_nation_region#2986,cval_nation_n_name#2987,cval_nation_n_comment#2988,cdepval_nation_n_name#2989,cdepval_nation_n_comment#2990,cn_name#2991,cn_comment#2992] JDBCRelation(tnation) [numPartitions=1]
            :           +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :              +- Project [rid#2956 AS rid_0#2963, cval_region_r_name#2957 AS cval_region_r_name_0#2964, cval_region_r_comment#2958 AS cval_region_r_comment_0#2965, cdepval_region_r_name#2959 AS cdepval_region_r_name_0#2966, cdepval_region_r_comment#2960 AS cdepval_region_r_comment_0#2967, cr_name#2961 AS cr_name_0#2968, cr_comment#2962 AS cr_comment_0#2969]
            :                 +- Relation[rid#2956,cval_region_r_name#2957,cval_region_r_comment#2958,cdepval_region_r_name#2959,cdepval_region_r_comment#2960,cr_name#2961,cr_comment#2962] JDBCRelation(tregion) [numPartitions=1]
            +- Project [rid#3182 AS rid_5#3200, cpfk_nation_supplier#3183 AS cpfk_nation_supplier_5#3201, cfpk_supplier_nation#3184 AS cfpk_supplier_nation_5#3202, cval_supplier_s_name#3185 AS cval_supplier_s_name_5#3203, cval_supplier_s_address#3186 AS cval_supplier_s_address_5#3204, cval_supplier_s_phone#3187 AS cval_supplier_s_phone_5#3205, cval_supplier_s_acctbal#3188 AS cval_supplier_s_acctbal_5#3206, cval_supplier_s_comment#3189 AS cval_supplier_s_comment_5#3207, cdepval_supplier_s_name#3190 AS cdepval_supplier_s_name_5#3208, cdepval_supplier_s_address#3191 AS cdepval_supplier_s_address_5#3209, cdepval_supplier_s_phone#3192 AS cdepval_supplier_s_phone_5#3210, cdepval_supplier_s_acctbal#3193 AS cdepval_supplier_s_acctbal_5#3211, cdepval_supplier_s_comment#3194 AS cdepval_supplier_s_comment_5#3212, cs_name#3195 AS cs_name_5#3213, cs_address#3196 AS cs_address_5#3214, cs_phone#3197 AS cs_phone_5#3215, cs_acctbal#3198 AS cs_acctbal_5#3216, cs_comment#3199 AS cs_comment_5#3217]
               +- Relation[rid#3182,cpfk_nation_supplier#3183,cfpk_supplier_nation#3184,cval_supplier_s_name#3185,cval_supplier_s_address#3186,cval_supplier_s_phone#3187,cval_supplier_s_acctbal#3188,cval_supplier_s_comment#3189,cdepval_supplier_s_name#3190,cdepval_supplier_s_address#3191,cdepval_supplier_s_phone#3192,cdepval_supplier_s_acctbal#3193,cdepval_supplier_s_comment#3194,cs_name#3195,cs_address#3196,cs_phone#3197,cs_acctbal#3198,cs_comment#3199] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 31278ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/25 21:53:23 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:53:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3349L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 21:53:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:53:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:53:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3349L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#3387 AS rid_1#3432, cpfk_orders_lineitem#3388 AS cpfk_orders_lineitem_1#3433, cpfk_supplier_lineitem#3389 AS cpfk_supplier_lineitem_1#3434, cfpk_lineitem_supplier#3390 AS cfpk_lineitem_supplier_1#3435, cfpk_lineitem_partsupp#3391 AS cfpk_lineitem_partsupp_1#3436, cpfk_part_lineitem#3392 AS cpfk_part_lineitem_1#3437, cfpk_lineitem_part#3393 AS cfpk_lineitem_part_1#3438, cpfk_partsupp_lineitem#3394 AS cpfk_partsupp_lineitem_1#3439, cfpk_lineitem_orders#3395 AS cfpk_lineitem_orders_1#3440, cval_lineitem_l_quantity#3396 AS cval_lineitem_l_quantity_1#3441, cval_lineitem_l_extendedprice#3397 AS cval_lineitem_l_extendedprice_1#3442, cval_lineitem_l_discount#3398 AS cval_lineitem_l_discount_1#3443, cval_lineitem_l_tax#3399 AS cval_lineitem_l_tax_1#3444, cval_lineitem_l_returnflag#3400 AS cval_lineitem_l_returnflag_1#3445, cval_lineitem_l_linestatus#3401 AS cval_lineitem_l_linestatus_1#3446, cval_lineitem_l_commitdate#3402 AS cval_lineitem_l_commitdate_1#3447, cval_lineitem_l_receiptdate#3403 AS cval_lineitem_l_receiptdate_1#3448, cval_lineitem_l_shipinstruct#3404 AS cval_lineitem_l_shipinstruct_1#3449, cval_lineitem_l_shipmode#3405 AS cval_lineitem_l_shipmode_1#3450, cval_lineitem_l_comment#3406 AS cval_lineitem_l_comment_1#3451, cval_lineitem_l_shipdate#3407 AS cval_lineitem_l_shipdate_1#3452, cdepval_lineitem_l_quantity#3408 AS cdepval_lineitem_l_quantity_1#3453, cdepval_lineitem_l_extendedprice#3409 AS cdepval_lineitem_l_extendedprice_1#3454, cdepval_lineitem_l_discount#3410 AS cdepval_lineitem_l_discount_1#3455, ... 21 more fields]
         :  +- Relation[rid#3387,cpfk_orders_lineitem#3388,cpfk_supplier_lineitem#3389,cfpk_lineitem_supplier#3390,cfpk_lineitem_partsupp#3391,cpfk_part_lineitem#3392,cfpk_lineitem_part#3393,cpfk_partsupp_lineitem#3394,cfpk_lineitem_orders#3395,cval_lineitem_l_quantity#3396,cval_lineitem_l_extendedprice#3397,cval_lineitem_l_discount#3398,cval_lineitem_l_tax#3399,cval_lineitem_l_returnflag#3400,cval_lineitem_l_linestatus#3401,cval_lineitem_l_commitdate#3402,cval_lineitem_l_receiptdate#3403,cval_lineitem_l_shipinstruct#3404,cval_lineitem_l_shipmode#3405,cval_lineitem_l_comment#3406,cval_lineitem_l_shipdate#3407,cdepval_lineitem_l_quantity#3408,cdepval_lineitem_l_extendedprice#3409,cdepval_lineitem_l_discount#3410,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#3351 AS rid_0#3369, cpfk_nation_supplier#3352 AS cpfk_nation_supplier_0#3370, cfpk_supplier_nation#3353 AS cfpk_supplier_nation_0#3371, cval_supplier_s_name#3354 AS cval_supplier_s_name_0#3372, cval_supplier_s_address#3355 AS cval_supplier_s_address_0#3373, cval_supplier_s_phone#3356 AS cval_supplier_s_phone_0#3374, cval_supplier_s_acctbal#3357 AS cval_supplier_s_acctbal_0#3375, cval_supplier_s_comment#3358 AS cval_supplier_s_comment_0#3376, cdepval_supplier_s_name#3359 AS cdepval_supplier_s_name_0#3377, cdepval_supplier_s_address#3360 AS cdepval_supplier_s_address_0#3378, cdepval_supplier_s_phone#3361 AS cdepval_supplier_s_phone_0#3379, cdepval_supplier_s_acctbal#3362 AS cdepval_supplier_s_acctbal_0#3380, cdepval_supplier_s_comment#3363 AS cdepval_supplier_s_comment_0#3381, cs_name#3364 AS cs_name_0#3382, cs_address#3365 AS cs_address_0#3383, cs_phone#3366 AS cs_phone_0#3384, cs_acctbal#3367 AS cs_acctbal_0#3385, cs_comment#3368 AS cs_comment_0#3386]
            +- Relation[rid#3351,cpfk_nation_supplier#3352,cfpk_supplier_nation#3353,cval_supplier_s_name#3354,cval_supplier_s_address#3355,cval_supplier_s_phone#3356,cval_supplier_s_acctbal#3357,cval_supplier_s_comment#3358,cdepval_supplier_s_name#3359,cdepval_supplier_s_address#3360,cdepval_supplier_s_phone#3361,cdepval_supplier_s_acctbal#3362,cdepval_supplier_s_comment#3363,cs_name#3364,cs_address#3365,cs_phone#3366,cs_acctbal#3367,cs_comment#3368] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17036ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/25 21:53:40 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:53:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3544L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 21:53:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:53:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:53:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:53:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:53:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:53:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:53:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:53:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3544L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#3546 AS rid_0#3591, cpfk_orders_lineitem#3547 AS cpfk_orders_lineitem_0#3592, cpfk_supplier_lineitem#3548 AS cpfk_supplier_lineitem_0#3593, cfpk_lineitem_supplier#3549 AS cfpk_lineitem_supplier_0#3594, cfpk_lineitem_partsupp#3550 AS cfpk_lineitem_partsupp_0#3595, cpfk_part_lineitem#3551 AS cpfk_part_lineitem_0#3596, cfpk_lineitem_part#3552 AS cfpk_lineitem_part_0#3597, cpfk_partsupp_lineitem#3553 AS cpfk_partsupp_lineitem_0#3598, cfpk_lineitem_orders#3554 AS cfpk_lineitem_orders_0#3599, cval_lineitem_l_quantity#3555 AS cval_lineitem_l_quantity_0#3600, cval_lineitem_l_extendedprice#3556 AS cval_lineitem_l_extendedprice_0#3601, cval_lineitem_l_discount#3557 AS cval_lineitem_l_discount_0#3602, cval_lineitem_l_tax#3558 AS cval_lineitem_l_tax_0#3603, cval_lineitem_l_returnflag#3559 AS cval_lineitem_l_returnflag_0#3604, cval_lineitem_l_linestatus#3560 AS cval_lineitem_l_linestatus_0#3605, cval_lineitem_l_commitdate#3561 AS cval_lineitem_l_commitdate_0#3606, cval_lineitem_l_receiptdate#3562 AS cval_lineitem_l_receiptdate_0#3607, cval_lineitem_l_shipinstruct#3563 AS cval_lineitem_l_shipinstruct_0#3608, cval_lineitem_l_shipmode#3564 AS cval_lineitem_l_shipmode_0#3609, cval_lineitem_l_comment#3565 AS cval_lineitem_l_comment_0#3610, cval_lineitem_l_shipdate#3566 AS cval_lineitem_l_shipdate_0#3611, cdepval_lineitem_l_quantity#3567 AS cdepval_lineitem_l_quantity_0#3612, cdepval_lineitem_l_extendedprice#3568 AS cdepval_lineitem_l_extendedprice_0#3613, cdepval_lineitem_l_discount#3569 AS cdepval_lineitem_l_discount_0#3614, ... 21 more fields]
         :  +- Relation[rid#3546,cpfk_orders_lineitem#3547,cpfk_supplier_lineitem#3548,cfpk_lineitem_supplier#3549,cfpk_lineitem_partsupp#3550,cpfk_part_lineitem#3551,cfpk_lineitem_part#3552,cpfk_partsupp_lineitem#3553,cfpk_lineitem_orders#3554,cval_lineitem_l_quantity#3555,cval_lineitem_l_extendedprice#3556,cval_lineitem_l_discount#3557,cval_lineitem_l_tax#3558,cval_lineitem_l_returnflag#3559,cval_lineitem_l_linestatus#3560,cval_lineitem_l_commitdate#3561,cval_lineitem_l_receiptdate#3562,cval_lineitem_l_shipinstruct#3563,cval_lineitem_l_shipmode#3564,cval_lineitem_l_comment#3565,cval_lineitem_l_shipdate#3566,cdepval_lineitem_l_quantity#3567,cdepval_lineitem_l_extendedprice#3568,cdepval_lineitem_l_discount#3569,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
            :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
            :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
            :  :  :- Project [rid#3732 AS rid_2#3777, cpfk_orders_lineitem#3733 AS cpfk_orders_lineitem_2#3778, cpfk_supplier_lineitem#3734 AS cpfk_supplier_lineitem_2#3779, cfpk_lineitem_supplier#3735 AS cfpk_lineitem_supplier_2#3780, cfpk_lineitem_partsupp#3736 AS cfpk_lineitem_partsupp_2#3781, cpfk_part_lineitem#3737 AS cpfk_part_lineitem_2#3782, cfpk_lineitem_part#3738 AS cfpk_lineitem_part_2#3783, cpfk_partsupp_lineitem#3739 AS cpfk_partsupp_lineitem_2#3784, cfpk_lineitem_orders#3740 AS cfpk_lineitem_orders_2#3785, cval_lineitem_l_quantity#3741 AS cval_lineitem_l_quantity_2#3786, cval_lineitem_l_extendedprice#3742 AS cval_lineitem_l_extendedprice_2#3787, cval_lineitem_l_discount#3743 AS cval_lineitem_l_discount_2#3788, cval_lineitem_l_tax#3744 AS cval_lineitem_l_tax_2#3789, cval_lineitem_l_returnflag#3745 AS cval_lineitem_l_returnflag_2#3790, cval_lineitem_l_linestatus#3746 AS cval_lineitem_l_linestatus_2#3791, cval_lineitem_l_commitdate#3747 AS cval_lineitem_l_commitdate_2#3792, cval_lineitem_l_receiptdate#3748 AS cval_lineitem_l_receiptdate_2#3793, cval_lineitem_l_shipinstruct#3749 AS cval_lineitem_l_shipinstruct_2#3794, cval_lineitem_l_shipmode#3750 AS cval_lineitem_l_shipmode_2#3795, cval_lineitem_l_comment#3751 AS cval_lineitem_l_comment_2#3796, cval_lineitem_l_shipdate#3752 AS cval_lineitem_l_shipdate_2#3797, cdepval_lineitem_l_quantity#3753 AS cdepval_lineitem_l_quantity_2#3798, cdepval_lineitem_l_extendedprice#3754 AS cdepval_lineitem_l_extendedprice_2#3799, cdepval_lineitem_l_discount#3755 AS cdepval_lineitem_l_discount_2#3800, ... 21 more fields]
            :  :  :  +- Relation[rid#3732,cpfk_orders_lineitem#3733,cpfk_supplier_lineitem#3734,cfpk_lineitem_supplier#3735,cfpk_lineitem_partsupp#3736,cpfk_part_lineitem#3737,cfpk_lineitem_part#3738,cpfk_partsupp_lineitem#3739,cfpk_lineitem_orders#3740,cval_lineitem_l_quantity#3741,cval_lineitem_l_extendedprice#3742,cval_lineitem_l_discount#3743,cval_lineitem_l_tax#3744,cval_lineitem_l_returnflag#3745,cval_lineitem_l_linestatus#3746,cval_lineitem_l_commitdate#3747,cval_lineitem_l_receiptdate#3748,cval_lineitem_l_shipinstruct#3749,cval_lineitem_l_shipmode#3750,cval_lineitem_l_comment#3751,cval_lineitem_l_shipdate#3752,cdepval_lineitem_l_quantity#3753,cdepval_lineitem_l_extendedprice#3754,cdepval_lineitem_l_discount#3755,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
            :  :     +- Project [rid#3636 AS rid_1#3660, cpfk_customer_orders#3637 AS cpfk_customer_orders_1#3661, cfpk_orders_customer#3638 AS cfpk_orders_customer_1#3662, cval_orders_o_orderstatus#3639 AS cval_orders_o_orderstatus_1#3663, cval_orders_o_totalprice#3640 AS cval_orders_o_totalprice_1#3664, cval_orders_o_orderpriority#3641 AS cval_orders_o_orderpriority_1#3665, cval_orders_o_clerk#3642 AS cval_orders_o_clerk_1#3666, cval_orders_o_shippriority#3643 AS cval_orders_o_shippriority_1#3667, cval_orders_o_comment#3644 AS cval_orders_o_comment_1#3668, cval_orders_o_orderdate#3645 AS cval_orders_o_orderdate_1#3669, cdepval_orders_o_orderstatus#3646 AS cdepval_orders_o_orderstatus_1#3670, cdepval_orders_o_totalprice#3647 AS cdepval_orders_o_totalprice_1#3671, cdepval_orders_o_orderpriority#3648 AS cdepval_orders_o_orderpriority_1#3672, cdepval_orders_o_clerk#3649 AS cdepval_orders_o_clerk_1#3673, cdepval_orders_o_shippriority#3650 AS cdepval_orders_o_shippriority_1#3674, cdepval_orders_o_comment#3651 AS cdepval_orders_o_comment_1#3675, cdepval_orders_o_orderdate#3652 AS cdepval_orders_o_orderdate_1#3676, co_orderstatus#3653 AS co_orderstatus_1#3677, co_totalprice#3654 AS co_totalprice_1#3678, co_orderpriority#3655 AS co_orderpriority_1#3679, co_clerk#3656 AS co_clerk_1#3680, co_shippriority#3657 AS co_shippriority_1#3681, co_comment#3658 AS co_comment_1#3682, co_orderdate#3659 AS co_orderdate_1#3683]
            :  :        +- Relation[rid#3636,cpfk_customer_orders#3637,cfpk_orders_customer#3638,cval_orders_o_orderstatus#3639,cval_orders_o_totalprice#3640,cval_orders_o_orderpriority#3641,cval_orders_o_clerk#3642,cval_orders_o_shippriority#3643,cval_orders_o_comment#3644,cval_orders_o_orderdate#3645,cdepval_orders_o_orderstatus#3646,cdepval_orders_o_totalprice#3647,cdepval_orders_o_orderpriority#3648,cdepval_orders_o_clerk#3649,cdepval_orders_o_shippriority#3650,cdepval_orders_o_comment#3651,cdepval_orders_o_orderdate#3652,co_orderstatus#3653,co_totalprice#3654,co_orderpriority#3655,co_clerk#3656,co_shippriority#3657,co_comment#3658,co_orderdate#3659] JDBCRelation(torders) [numPartitions=1]
            :  +- Project [rid#3822 AS rid_3#3840, cpfk_nation_supplier#3823 AS cpfk_nation_supplier_3#3841, cfpk_supplier_nation#3824 AS cfpk_supplier_nation_3#3842, cval_supplier_s_name#3825 AS cval_supplier_s_name_3#3843, cval_supplier_s_address#3826 AS cval_supplier_s_address_3#3844, cval_supplier_s_phone#3827 AS cval_supplier_s_phone_3#3845, cval_supplier_s_acctbal#3828 AS cval_supplier_s_acctbal_3#3846, cval_supplier_s_comment#3829 AS cval_supplier_s_comment_3#3847, cdepval_supplier_s_name#3830 AS cdepval_supplier_s_name_3#3848, cdepval_supplier_s_address#3831 AS cdepval_supplier_s_address_3#3849, cdepval_supplier_s_phone#3832 AS cdepval_supplier_s_phone_3#3850, cdepval_supplier_s_acctbal#3833 AS cdepval_supplier_s_acctbal_3#3851, cdepval_supplier_s_comment#3834 AS cdepval_supplier_s_comment_3#3852, cs_name#3835 AS cs_name_3#3853, cs_address#3836 AS cs_address_3#3854, cs_phone#3837 AS cs_phone_3#3855, cs_acctbal#3838 AS cs_acctbal_3#3856, cs_comment#3839 AS cs_comment_3#3857]
            :     +- Relation[rid#3822,cpfk_nation_supplier#3823,cfpk_supplier_nation#3824,cval_supplier_s_name#3825,cval_supplier_s_address#3826,cval_supplier_s_phone#3827,cval_supplier_s_acctbal#3828,cval_supplier_s_comment#3829,cdepval_supplier_s_name#3830,cdepval_supplier_s_address#3831,cdepval_supplier_s_phone#3832,cdepval_supplier_s_acctbal#3833,cdepval_supplier_s_comment#3834,cs_name#3835,cs_address#3836,cs_phone#3837,cs_acctbal#3838,cs_comment#3839] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
               +- Project [rid#3858 AS rid_4#3867, cpfk_region_nation#3859 AS cpfk_region_nation_4#3868, cfpk_nation_region#3860 AS cfpk_nation_region_4#3869, cval_nation_n_name#3861 AS cval_nation_n_name_4#3870, cval_nation_n_comment#3862 AS cval_nation_n_comment_4#3871, cdepval_nation_n_name#3863 AS cdepval_nation_n_name_4#3872, cdepval_nation_n_comment#3864 AS cdepval_nation_n_comment_4#3873, cn_name#3865 AS cn_name_4#3874, cn_comment#3866 AS cn_comment_4#3875]
                  +- Relation[rid#3858,cpfk_region_nation#3859,cfpk_nation_region#3860,cval_nation_n_name#3861,cval_nation_n_comment#3862,cdepval_nation_n_name#3863,cdepval_nation_n_comment#3864,cn_name#3865,cn_comment#3866] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 80707ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/25 21:55:01 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:55:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4040L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 21:55:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#4040L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#4042 AS rid_0#4087, cpfk_orders_lineitem#4043 AS cpfk_orders_lineitem_0#4088, cpfk_supplier_lineitem#4044 AS cpfk_supplier_lineitem_0#4089, cfpk_lineitem_supplier#4045 AS cfpk_lineitem_supplier_0#4090, cfpk_lineitem_partsupp#4046 AS cfpk_lineitem_partsupp_0#4091, cpfk_part_lineitem#4047 AS cpfk_part_lineitem_0#4092, cfpk_lineitem_part#4048 AS cfpk_lineitem_part_0#4093, cpfk_partsupp_lineitem#4049 AS cpfk_partsupp_lineitem_0#4094, cfpk_lineitem_orders#4050 AS cfpk_lineitem_orders_0#4095, cval_lineitem_l_quantity#4051 AS cval_lineitem_l_quantity_0#4096, cval_lineitem_l_extendedprice#4052 AS cval_lineitem_l_extendedprice_0#4097, cval_lineitem_l_discount#4053 AS cval_lineitem_l_discount_0#4098, cval_lineitem_l_tax#4054 AS cval_lineitem_l_tax_0#4099, cval_lineitem_l_returnflag#4055 AS cval_lineitem_l_returnflag_0#4100, cval_lineitem_l_linestatus#4056 AS cval_lineitem_l_linestatus_0#4101, cval_lineitem_l_commitdate#4057 AS cval_lineitem_l_commitdate_0#4102, cval_lineitem_l_receiptdate#4058 AS cval_lineitem_l_receiptdate_0#4103, cval_lineitem_l_shipinstruct#4059 AS cval_lineitem_l_shipinstruct_0#4104, cval_lineitem_l_shipmode#4060 AS cval_lineitem_l_shipmode_0#4105, cval_lineitem_l_comment#4061 AS cval_lineitem_l_comment_0#4106, cval_lineitem_l_shipdate#4062 AS cval_lineitem_l_shipdate_0#4107, cdepval_lineitem_l_quantity#4063 AS cdepval_lineitem_l_quantity_0#4108, cdepval_lineitem_l_extendedprice#4064 AS cdepval_lineitem_l_extendedprice_0#4109, cdepval_lineitem_l_discount#4065 AS cdepval_lineitem_l_discount_0#4110, ... 21 more fields]
         +- Relation[rid#4042,cpfk_orders_lineitem#4043,cpfk_supplier_lineitem#4044,cfpk_lineitem_supplier#4045,cfpk_lineitem_partsupp#4046,cpfk_part_lineitem#4047,cfpk_lineitem_part#4048,cpfk_partsupp_lineitem#4049,cfpk_lineitem_orders#4050,cval_lineitem_l_quantity#4051,cval_lineitem_l_extendedprice#4052,cval_lineitem_l_discount#4053,cval_lineitem_l_tax#4054,cval_lineitem_l_returnflag#4055,cval_lineitem_l_linestatus#4056,cval_lineitem_l_commitdate#4057,cval_lineitem_l_receiptdate#4058,cval_lineitem_l_shipinstruct#4059,cval_lineitem_l_shipmode#4060,cval_lineitem_l_comment#4061,cval_lineitem_l_shipdate#4062,cdepval_lineitem_l_quantity#4063,cdepval_lineitem_l_extendedprice#4064,cdepval_lineitem_l_discount#4065,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2497ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/25 21:55:04 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:55:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4183L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 21:55:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:55:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:55:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:55:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:55:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:55:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:55:04 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:55:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:55:04 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:55:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4183L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#4257 AS rid_2#4271, cpfk_part_partsupp#4258 AS cpfk_part_partsupp_2#4272, cfpk_partsupp_part#4259 AS cfpk_partsupp_part_2#4273, cpfk_supplier_partsupp#4260 AS cpfk_supplier_partsupp_2#4274, cfpk_partsupp_supplier#4261 AS cfpk_partsupp_supplier_2#4275, cval_partsupp_ps_availqty#4262 AS cval_partsupp_ps_availqty_2#4276, cval_partsupp_ps_supplycost#4263 AS cval_partsupp_ps_supplycost_2#4277, cval_partsupp_ps_comment#4264 AS cval_partsupp_ps_comment_2#4278, cdepval_partsupp_ps_availqty#4265 AS cdepval_partsupp_ps_availqty_2#4279, cdepval_partsupp_ps_supplycost#4266 AS cdepval_partsupp_ps_supplycost_2#4280, cdepval_partsupp_ps_comment#4267 AS cdepval_partsupp_ps_comment_2#4281, cps_availqty#4268 AS cps_availqty_2#4282, cps_supplycost#4269 AS cps_supplycost_2#4283, cps_comment#4270 AS cps_comment_2#4284]
         :  +- Relation[rid#4257,cpfk_part_partsupp#4258,cfpk_partsupp_part#4259,cpfk_supplier_partsupp#4260,cfpk_partsupp_supplier#4261,cval_partsupp_ps_availqty#4262,cval_partsupp_ps_supplycost#4263,cval_partsupp_ps_comment#4264,cdepval_partsupp_ps_availqty#4265,cdepval_partsupp_ps_supplycost#4266,cdepval_partsupp_ps_comment#4267,cps_availqty#4268,cps_supplycost#4269,cps_comment#4270] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
            :- Project [rid#4221 AS rid_1#4239, cpfk_nation_supplier#4222 AS cpfk_nation_supplier_1#4240, cfpk_supplier_nation#4223 AS cfpk_supplier_nation_1#4241, cval_supplier_s_name#4224 AS cval_supplier_s_name_1#4242, cval_supplier_s_address#4225 AS cval_supplier_s_address_1#4243, cval_supplier_s_phone#4226 AS cval_supplier_s_phone_1#4244, cval_supplier_s_acctbal#4227 AS cval_supplier_s_acctbal_1#4245, cval_supplier_s_comment#4228 AS cval_supplier_s_comment_1#4246, cdepval_supplier_s_name#4229 AS cdepval_supplier_s_name_1#4247, cdepval_supplier_s_address#4230 AS cdepval_supplier_s_address_1#4248, cdepval_supplier_s_phone#4231 AS cdepval_supplier_s_phone_1#4249, cdepval_supplier_s_acctbal#4232 AS cdepval_supplier_s_acctbal_1#4250, cdepval_supplier_s_comment#4233 AS cdepval_supplier_s_comment_1#4251, cs_name#4234 AS cs_name_1#4252, cs_address#4235 AS cs_address_1#4253, cs_phone#4236 AS cs_phone_1#4254, cs_acctbal#4237 AS cs_acctbal_1#4255, cs_comment#4238 AS cs_comment_1#4256]
            :  +- Relation[rid#4221,cpfk_nation_supplier#4222,cfpk_supplier_nation#4223,cval_supplier_s_name#4224,cval_supplier_s_address#4225,cval_supplier_s_phone#4226,cval_supplier_s_acctbal#4227,cval_supplier_s_comment#4228,cdepval_supplier_s_name#4229,cdepval_supplier_s_address#4230,cdepval_supplier_s_phone#4231,cdepval_supplier_s_acctbal#4232,cdepval_supplier_s_comment#4233,cs_name#4234,cs_address#4235,cs_phone#4236,cs_acctbal#4237,cs_comment#4238] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
               +- Project [rid#4185 AS rid_0#4194, cpfk_region_nation#4186 AS cpfk_region_nation_0#4195, cfpk_nation_region#4187 AS cfpk_nation_region_0#4196, cval_nation_n_name#4188 AS cval_nation_n_name_0#4197, cval_nation_n_comment#4189 AS cval_nation_n_comment_0#4198, cdepval_nation_n_name#4190 AS cdepval_nation_n_name_0#4199, cdepval_nation_n_comment#4191 AS cdepval_nation_n_comment_0#4200, cn_name#4192 AS cn_name_0#4201, cn_comment#4193 AS cn_comment_0#4202]
                  +- Relation[rid#4185,cpfk_region_nation#4186,cfpk_nation_region#4187,cval_nation_n_name#4188,cval_nation_n_comment#4189,cdepval_nation_n_name#4190,cdepval_nation_n_comment#4191,cn_name#4192,cn_comment#4193] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 3678ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/25 21:55:07 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:55:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4332L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 21:55:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4332L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#4384 AS rid_1#4429, cpfk_orders_lineitem#4385 AS cpfk_orders_lineitem_1#4430, cpfk_supplier_lineitem#4386 AS cpfk_supplier_lineitem_1#4431, cfpk_lineitem_supplier#4387 AS cfpk_lineitem_supplier_1#4432, cfpk_lineitem_partsupp#4388 AS cfpk_lineitem_partsupp_1#4433, cpfk_part_lineitem#4389 AS cpfk_part_lineitem_1#4434, cfpk_lineitem_part#4390 AS cfpk_lineitem_part_1#4435, cpfk_partsupp_lineitem#4391 AS cpfk_partsupp_lineitem_1#4436, cfpk_lineitem_orders#4392 AS cfpk_lineitem_orders_1#4437, cval_lineitem_l_quantity#4393 AS cval_lineitem_l_quantity_1#4438, cval_lineitem_l_extendedprice#4394 AS cval_lineitem_l_extendedprice_1#4439, cval_lineitem_l_discount#4395 AS cval_lineitem_l_discount_1#4440, cval_lineitem_l_tax#4396 AS cval_lineitem_l_tax_1#4441, cval_lineitem_l_returnflag#4397 AS cval_lineitem_l_returnflag_1#4442, cval_lineitem_l_linestatus#4398 AS cval_lineitem_l_linestatus_1#4443, cval_lineitem_l_commitdate#4399 AS cval_lineitem_l_commitdate_1#4444, cval_lineitem_l_receiptdate#4400 AS cval_lineitem_l_receiptdate_1#4445, cval_lineitem_l_shipinstruct#4401 AS cval_lineitem_l_shipinstruct_1#4446, cval_lineitem_l_shipmode#4402 AS cval_lineitem_l_shipmode_1#4447, cval_lineitem_l_comment#4403 AS cval_lineitem_l_comment_1#4448, cval_lineitem_l_shipdate#4404 AS cval_lineitem_l_shipdate_1#4449, cdepval_lineitem_l_quantity#4405 AS cdepval_lineitem_l_quantity_1#4450, cdepval_lineitem_l_extendedprice#4406 AS cdepval_lineitem_l_extendedprice_1#4451, cdepval_lineitem_l_discount#4407 AS cdepval_lineitem_l_discount_1#4452, ... 21 more fields]
         :  +- Relation[rid#4384,cpfk_orders_lineitem#4385,cpfk_supplier_lineitem#4386,cfpk_lineitem_supplier#4387,cfpk_lineitem_partsupp#4388,cpfk_part_lineitem#4389,cfpk_lineitem_part#4390,cpfk_partsupp_lineitem#4391,cfpk_lineitem_orders#4392,cval_lineitem_l_quantity#4393,cval_lineitem_l_extendedprice#4394,cval_lineitem_l_discount#4395,cval_lineitem_l_tax#4396,cval_lineitem_l_returnflag#4397,cval_lineitem_l_linestatus#4398,cval_lineitem_l_commitdate#4399,cval_lineitem_l_receiptdate#4400,cval_lineitem_l_shipinstruct#4401,cval_lineitem_l_shipmode#4402,cval_lineitem_l_comment#4403,cval_lineitem_l_shipdate#4404,cdepval_lineitem_l_quantity#4405,cdepval_lineitem_l_extendedprice#4406,cdepval_lineitem_l_discount#4407,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4334 AS rid_0#4359, cval_part_p_name#4335 AS cval_part_p_name_0#4360, cval_part_p_mfgr#4336 AS cval_part_p_mfgr_0#4361, cval_part_p_type#4337 AS cval_part_p_type_0#4362, cval_part_p_size#4338 AS cval_part_p_size_0#4363, cval_part_p_container#4339 AS cval_part_p_container_0#4364, cval_part_p_retailprice#4340 AS cval_part_p_retailprice_0#4365, cval_part_p_comment#4341 AS cval_part_p_comment_0#4366, cval_part_p_brand#4342 AS cval_part_p_brand_0#4367, cdepval_part_p_name#4343 AS cdepval_part_p_name_0#4368, cdepval_part_p_mfgr#4344 AS cdepval_part_p_mfgr_0#4369, cdepval_part_p_type#4345 AS cdepval_part_p_type_0#4370, cdepval_part_p_size#4346 AS cdepval_part_p_size_0#4371, cdepval_part_p_container#4347 AS cdepval_part_p_container_0#4372, cdepval_part_p_retailprice#4348 AS cdepval_part_p_retailprice_0#4373, cdepval_part_p_comment#4349 AS cdepval_part_p_comment_0#4374, cdepval_part_p_brand#4350 AS cdepval_part_p_brand_0#4375, cp_name#4351 AS cp_name_0#4376, cp_mfgr#4352 AS cp_mfgr_0#4377, cp_type#4353 AS cp_type_0#4378, cp_size#4354 AS cp_size_0#4379, cp_container#4355 AS cp_container_0#4380, cp_retailprice#4356 AS cp_retailprice_0#4381, cp_comment#4357 AS cp_comment_0#4382, cp_brand#4358 AS cp_brand_0#4383]
            +- Relation[rid#4334,cval_part_p_name#4335,cval_part_p_mfgr#4336,cval_part_p_type#4337,cval_part_p_size#4338,cval_part_p_container#4339,cval_part_p_retailprice#4340,cval_part_p_comment#4341,cval_part_p_brand#4342,cdepval_part_p_name#4343,cdepval_part_p_mfgr#4344,cdepval_part_p_type#4345,cdepval_part_p_size#4346,cdepval_part_p_container#4347,cdepval_part_p_retailprice#4348,cdepval_part_p_comment#4349,cdepval_part_p_brand#4350,cp_name#4351,cp_mfgr#4352,cp_type#4353,cp_size#4354,cp_container#4355,cp_retailprice#4356,cp_comment#4357,cp_brand#4358] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 20155ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 21:55:27 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:55:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4553L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 21:55:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:55:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:55:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:55:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:55:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:55:27 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:55:27 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:55:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4553L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#4609 AS rid_2#4654, cpfk_orders_lineitem#4610 AS cpfk_orders_lineitem_2#4655, cpfk_supplier_lineitem#4611 AS cpfk_supplier_lineitem_2#4656, cfpk_lineitem_supplier#4612 AS cfpk_lineitem_supplier_2#4657, cfpk_lineitem_partsupp#4613 AS cfpk_lineitem_partsupp_2#4658, cpfk_part_lineitem#4614 AS cpfk_part_lineitem_2#4659, cfpk_lineitem_part#4615 AS cfpk_lineitem_part_2#4660, cpfk_partsupp_lineitem#4616 AS cpfk_partsupp_lineitem_2#4661, cfpk_lineitem_orders#4617 AS cfpk_lineitem_orders_2#4662, cval_lineitem_l_quantity#4618 AS cval_lineitem_l_quantity_2#4663, cval_lineitem_l_extendedprice#4619 AS cval_lineitem_l_extendedprice_2#4664, cval_lineitem_l_discount#4620 AS cval_lineitem_l_discount_2#4665, cval_lineitem_l_tax#4621 AS cval_lineitem_l_tax_2#4666, cval_lineitem_l_returnflag#4622 AS cval_lineitem_l_returnflag_2#4667, cval_lineitem_l_linestatus#4623 AS cval_lineitem_l_linestatus_2#4668, cval_lineitem_l_commitdate#4624 AS cval_lineitem_l_commitdate_2#4669, cval_lineitem_l_receiptdate#4625 AS cval_lineitem_l_receiptdate_2#4670, cval_lineitem_l_shipinstruct#4626 AS cval_lineitem_l_shipinstruct_2#4671, cval_lineitem_l_shipmode#4627 AS cval_lineitem_l_shipmode_2#4672, cval_lineitem_l_comment#4628 AS cval_lineitem_l_comment_2#4673, cval_lineitem_l_shipdate#4629 AS cval_lineitem_l_shipdate_2#4674, cdepval_lineitem_l_quantity#4630 AS cdepval_lineitem_l_quantity_2#4675, cdepval_lineitem_l_extendedprice#4631 AS cdepval_lineitem_l_extendedprice_2#4676, cdepval_lineitem_l_discount#4632 AS cdepval_lineitem_l_discount_2#4677, ... 21 more fields]
         :  :  :  :  +- Relation[rid#4609,cpfk_orders_lineitem#4610,cpfk_supplier_lineitem#4611,cfpk_lineitem_supplier#4612,cfpk_lineitem_partsupp#4613,cpfk_part_lineitem#4614,cfpk_lineitem_part#4615,cpfk_partsupp_lineitem#4616,cfpk_lineitem_orders#4617,cval_lineitem_l_quantity#4618,cval_lineitem_l_extendedprice#4619,cval_lineitem_l_discount#4620,cval_lineitem_l_tax#4621,cval_lineitem_l_returnflag#4622,cval_lineitem_l_linestatus#4623,cval_lineitem_l_commitdate#4624,cval_lineitem_l_receiptdate#4625,cval_lineitem_l_shipinstruct#4626,cval_lineitem_l_shipmode#4627,cval_lineitem_l_comment#4628,cval_lineitem_l_shipdate#4629,cdepval_lineitem_l_quantity#4630,cdepval_lineitem_l_extendedprice#4631,cdepval_lineitem_l_discount#4632,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#4573 AS rid_1#4591, cpfk_nation_supplier#4574 AS cpfk_nation_supplier_1#4592, cfpk_supplier_nation#4575 AS cfpk_supplier_nation_1#4593, cval_supplier_s_name#4576 AS cval_supplier_s_name_1#4594, cval_supplier_s_address#4577 AS cval_supplier_s_address_1#4595, cval_supplier_s_phone#4578 AS cval_supplier_s_phone_1#4596, cval_supplier_s_acctbal#4579 AS cval_supplier_s_acctbal_1#4597, cval_supplier_s_comment#4580 AS cval_supplier_s_comment_1#4598, cdepval_supplier_s_name#4581 AS cdepval_supplier_s_name_1#4599, cdepval_supplier_s_address#4582 AS cdepval_supplier_s_address_1#4600, cdepval_supplier_s_phone#4583 AS cdepval_supplier_s_phone_1#4601, cdepval_supplier_s_acctbal#4584 AS cdepval_supplier_s_acctbal_1#4602, cdepval_supplier_s_comment#4585 AS cdepval_supplier_s_comment_1#4603, cs_name#4586 AS cs_name_1#4604, cs_address#4587 AS cs_address_1#4605, cs_phone#4588 AS cs_phone_1#4606, cs_acctbal#4589 AS cs_acctbal_1#4607, cs_comment#4590 AS cs_comment_1#4608]
         :  :  :     :  +- Relation[rid#4573,cpfk_nation_supplier#4574,cfpk_supplier_nation#4575,cval_supplier_s_name#4576,cval_supplier_s_address#4577,cval_supplier_s_phone#4578,cval_supplier_s_acctbal#4579,cval_supplier_s_comment#4580,cdepval_supplier_s_name#4581,cdepval_supplier_s_address#4582,cdepval_supplier_s_phone#4583,cdepval_supplier_s_acctbal#4584,cdepval_supplier_s_comment#4585,cs_name#4586,cs_address#4587,cs_phone#4588,cs_acctbal#4589,cs_comment#4590] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#4555 AS rid_0#4564, cpfk_region_nation#4556 AS cpfk_region_nation_0#4565, cfpk_nation_region#4557 AS cfpk_nation_region_0#4566, cval_nation_n_name#4558 AS cval_nation_n_name_0#4567, cval_nation_n_comment#4559 AS cval_nation_n_comment_0#4568, cdepval_nation_n_name#4560 AS cdepval_nation_n_name_0#4569, cdepval_nation_n_comment#4561 AS cdepval_nation_n_comment_0#4570, cn_name#4562 AS cn_name_0#4571, cn_comment#4563 AS cn_comment_0#4572]
         :  :  :        +- Relation[rid#4555,cpfk_region_nation#4556,cfpk_nation_region#4557,cval_nation_n_name#4558,cval_nation_n_comment#4559,cdepval_nation_n_name#4560,cdepval_nation_n_comment#4561,cn_name#4562,cn_comment#4563] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#4699 AS rid_3#4724, cval_part_p_name#4700 AS cval_part_p_name_3#4725, cval_part_p_mfgr#4701 AS cval_part_p_mfgr_3#4726, cval_part_p_type#4702 AS cval_part_p_type_3#4727, cval_part_p_size#4703 AS cval_part_p_size_3#4728, cval_part_p_container#4704 AS cval_part_p_container_3#4729, cval_part_p_retailprice#4705 AS cval_part_p_retailprice_3#4730, cval_part_p_comment#4706 AS cval_part_p_comment_3#4731, cval_part_p_brand#4707 AS cval_part_p_brand_3#4732, cdepval_part_p_name#4708 AS cdepval_part_p_name_3#4733, cdepval_part_p_mfgr#4709 AS cdepval_part_p_mfgr_3#4734, cdepval_part_p_type#4710 AS cdepval_part_p_type_3#4735, cdepval_part_p_size#4711 AS cdepval_part_p_size_3#4736, cdepval_part_p_container#4712 AS cdepval_part_p_container_3#4737, cdepval_part_p_retailprice#4713 AS cdepval_part_p_retailprice_3#4738, cdepval_part_p_comment#4714 AS cdepval_part_p_comment_3#4739, cdepval_part_p_brand#4715 AS cdepval_part_p_brand_3#4740, cp_name#4716 AS cp_name_3#4741, cp_mfgr#4717 AS cp_mfgr_3#4742, cp_type#4718 AS cp_type_3#4743, cp_size#4719 AS cp_size_3#4744, cp_container#4720 AS cp_container_3#4745, cp_retailprice#4721 AS cp_retailprice_3#4746, cp_comment#4722 AS cp_comment_3#4747, cp_brand#4723 AS cp_brand_3#4748]
         :  :     +- Relation[rid#4699,cval_part_p_name#4700,cval_part_p_mfgr#4701,cval_part_p_type#4702,cval_part_p_size#4703,cval_part_p_container#4704,cval_part_p_retailprice#4705,cval_part_p_comment#4706,cval_part_p_brand#4707,cdepval_part_p_name#4708,cdepval_part_p_mfgr#4709,cdepval_part_p_type#4710,cdepval_part_p_size#4711,cdepval_part_p_container#4712,cdepval_part_p_retailprice#4713,cdepval_part_p_comment#4714,cdepval_part_p_brand#4715,cp_name#4716,cp_mfgr#4717,cp_type#4718,cp_size#4719,cp_container#4720,cp_retailprice#4721,cp_comment#4722,cp_brand#4723] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#4749 AS rid_4#4763, cpfk_part_partsupp#4750 AS cpfk_part_partsupp_4#4764, cfpk_partsupp_part#4751 AS cfpk_partsupp_part_4#4765, cpfk_supplier_partsupp#4752 AS cpfk_supplier_partsupp_4#4766, cfpk_partsupp_supplier#4753 AS cfpk_partsupp_supplier_4#4767, cval_partsupp_ps_availqty#4754 AS cval_partsupp_ps_availqty_4#4768, cval_partsupp_ps_supplycost#4755 AS cval_partsupp_ps_supplycost_4#4769, cval_partsupp_ps_comment#4756 AS cval_partsupp_ps_comment_4#4770, cdepval_partsupp_ps_availqty#4757 AS cdepval_partsupp_ps_availqty_4#4771, cdepval_partsupp_ps_supplycost#4758 AS cdepval_partsupp_ps_supplycost_4#4772, cdepval_partsupp_ps_comment#4759 AS cdepval_partsupp_ps_comment_4#4773, cps_availqty#4760 AS cps_availqty_4#4774, cps_supplycost#4761 AS cps_supplycost_4#4775, cps_comment#4762 AS cps_comment_4#4776]
         :     +- Relation[rid#4749,cpfk_part_partsupp#4750,cfpk_partsupp_part#4751,cpfk_supplier_partsupp#4752,cfpk_partsupp_supplier#4753,cval_partsupp_ps_availqty#4754,cval_partsupp_ps_supplycost#4755,cval_partsupp_ps_comment#4756,cdepval_partsupp_ps_availqty#4757,cdepval_partsupp_ps_supplycost#4758,cdepval_partsupp_ps_comment#4759,cps_availqty#4760,cps_supplycost#4761,cps_comment#4762] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#4777 AS rid_5#4801, cpfk_customer_orders#4778 AS cpfk_customer_orders_5#4802, cfpk_orders_customer#4779 AS cfpk_orders_customer_5#4803, cval_orders_o_orderstatus#4780 AS cval_orders_o_orderstatus_5#4804, cval_orders_o_totalprice#4781 AS cval_orders_o_totalprice_5#4805, cval_orders_o_orderpriority#4782 AS cval_orders_o_orderpriority_5#4806, cval_orders_o_clerk#4783 AS cval_orders_o_clerk_5#4807, cval_orders_o_shippriority#4784 AS cval_orders_o_shippriority_5#4808, cval_orders_o_comment#4785 AS cval_orders_o_comment_5#4809, cval_orders_o_orderdate#4786 AS cval_orders_o_orderdate_5#4810, cdepval_orders_o_orderstatus#4787 AS cdepval_orders_o_orderstatus_5#4811, cdepval_orders_o_totalprice#4788 AS cdepval_orders_o_totalprice_5#4812, cdepval_orders_o_orderpriority#4789 AS cdepval_orders_o_orderpriority_5#4813, cdepval_orders_o_clerk#4790 AS cdepval_orders_o_clerk_5#4814, cdepval_orders_o_shippriority#4791 AS cdepval_orders_o_shippriority_5#4815, cdepval_orders_o_comment#4792 AS cdepval_orders_o_comment_5#4816, cdepval_orders_o_orderdate#4793 AS cdepval_orders_o_orderdate_5#4817, co_orderstatus#4794 AS co_orderstatus_5#4818, co_totalprice#4795 AS co_totalprice_5#4819, co_orderpriority#4796 AS co_orderpriority_5#4820, co_clerk#4797 AS co_clerk_5#4821, co_shippriority#4798 AS co_shippriority_5#4822, co_comment#4799 AS co_comment_5#4823, co_orderdate#4800 AS co_orderdate_5#4824]
            +- Relation[rid#4777,cpfk_customer_orders#4778,cfpk_orders_customer#4779,cval_orders_o_orderstatus#4780,cval_orders_o_totalprice#4781,cval_orders_o_orderpriority#4782,cval_orders_o_clerk#4783,cval_orders_o_shippriority#4784,cval_orders_o_comment#4785,cval_orders_o_orderdate#4786,cdepval_orders_o_orderstatus#4787,cdepval_orders_o_totalprice#4788,cdepval_orders_o_orderpriority#4789,cdepval_orders_o_clerk#4790,cdepval_orders_o_shippriority#4791,cdepval_orders_o_comment#4792,cdepval_orders_o_orderdate#4793,co_orderstatus#4794,co_totalprice#4795,co_orderpriority#4796,co_clerk#4797,co_shippriority#4798,co_comment#4799,co_orderdate#4800] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 64125ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/25 21:56:31 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:56:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4965L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 21:56:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4965L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#4967 AS rid_0#4991, cpfk_customer_orders#4968 AS cpfk_customer_orders_0#4992, cfpk_orders_customer#4969 AS cfpk_orders_customer_0#4993, cval_orders_o_orderstatus#4970 AS cval_orders_o_orderstatus_0#4994, cval_orders_o_totalprice#4971 AS cval_orders_o_totalprice_0#4995, cval_orders_o_orderpriority#4972 AS cval_orders_o_orderpriority_0#4996, cval_orders_o_clerk#4973 AS cval_orders_o_clerk_0#4997, cval_orders_o_shippriority#4974 AS cval_orders_o_shippriority_0#4998, cval_orders_o_comment#4975 AS cval_orders_o_comment_0#4999, cval_orders_o_orderdate#4976 AS cval_orders_o_orderdate_0#5000, cdepval_orders_o_orderstatus#4977 AS cdepval_orders_o_orderstatus_0#5001, cdepval_orders_o_totalprice#4978 AS cdepval_orders_o_totalprice_0#5002, cdepval_orders_o_orderpriority#4979 AS cdepval_orders_o_orderpriority_0#5003, cdepval_orders_o_clerk#4980 AS cdepval_orders_o_clerk_0#5004, cdepval_orders_o_shippriority#4981 AS cdepval_orders_o_shippriority_0#5005, cdepval_orders_o_comment#4982 AS cdepval_orders_o_comment_0#5006, cdepval_orders_o_orderdate#4983 AS cdepval_orders_o_orderdate_0#5007, co_orderstatus#4984 AS co_orderstatus_0#5008, co_totalprice#4985 AS co_totalprice_0#5009, co_orderpriority#4986 AS co_orderpriority_0#5010, co_clerk#4987 AS co_clerk_0#5011, co_shippriority#4988 AS co_shippriority_0#5012, co_comment#4989 AS co_comment_0#5013, co_orderdate#4990 AS co_orderdate_0#5014]
         :  +- Relation[rid#4967,cpfk_customer_orders#4968,cfpk_orders_customer#4969,cval_orders_o_orderstatus#4970,cval_orders_o_totalprice#4971,cval_orders_o_orderpriority#4972,cval_orders_o_clerk#4973,cval_orders_o_shippriority#4974,cval_orders_o_comment#4975,cval_orders_o_orderdate#4976,cdepval_orders_o_orderstatus#4977,cdepval_orders_o_totalprice#4978,cdepval_orders_o_orderpriority#4979,cdepval_orders_o_clerk#4980,cdepval_orders_o_shippriority#4981,cdepval_orders_o_comment#4982,cdepval_orders_o_orderdate#4983,co_orderstatus#4984,co_totalprice#4985,co_orderpriority#4986,co_clerk#4987,co_shippriority#4988,co_comment#4989,co_orderdate#4990] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#5015 AS rid_1#5036, cpfk_nation_customer#5016 AS cpfk_nation_customer_1#5037, cfpk_customer_nation#5017 AS cfpk_customer_nation_1#5038, cval_customer_c_name#5018 AS cval_customer_c_name_1#5039, cval_customer_c_address#5019 AS cval_customer_c_address_1#5040, cval_customer_c_phone#5020 AS cval_customer_c_phone_1#5041, cval_customer_c_acctbal#5021 AS cval_customer_c_acctbal_1#5042, cval_customer_c_comment#5022 AS cval_customer_c_comment_1#5043, cval_customer_c_mktsegment#5023 AS cval_customer_c_mktsegment_1#5044, cdepval_customer_c_name#5024 AS cdepval_customer_c_name_1#5045, cdepval_customer_c_address#5025 AS cdepval_customer_c_address_1#5046, cdepval_customer_c_phone#5026 AS cdepval_customer_c_phone_1#5047, cdepval_customer_c_acctbal#5027 AS cdepval_customer_c_acctbal_1#5048, cdepval_customer_c_comment#5028 AS cdepval_customer_c_comment_1#5049, cdepval_customer_c_mktsegment#5029 AS cdepval_customer_c_mktsegment_1#5050, cc_name#5030 AS cc_name_1#5051, cc_address#5031 AS cc_address_1#5052, cc_phone#5032 AS cc_phone_1#5053, cc_acctbal#5033 AS cc_acctbal_1#5054, cc_comment#5034 AS cc_comment_1#5055, cc_mktsegment#5035 AS cc_mktsegment_1#5056]
            +- Relation[rid#5015,cpfk_nation_customer#5016,cfpk_customer_nation#5017,cval_customer_c_name#5018,cval_customer_c_address#5019,cval_customer_c_phone#5020,cval_customer_c_acctbal#5021,cval_customer_c_comment#5022,cval_customer_c_mktsegment#5023,cdepval_customer_c_name#5024,cdepval_customer_c_address#5025,cdepval_customer_c_phone#5026,cdepval_customer_c_acctbal#5027,cdepval_customer_c_comment#5028,cdepval_customer_c_mktsegment#5029,cc_name#5030,cc_address#5031,cc_phone#5032,cc_acctbal#5033,cc_comment#5034,cc_mktsegment#5035] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4299ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/25 21:56:36 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:56:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5109L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 21:56:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:56:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:56:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:56:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:56:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:56:36 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 21:56:36 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 21:56:36 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 21:56:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:56:36 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 21:56:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:56:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:56:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5109L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :  :  :  :- Project [rid#5211 AS rid_1#5256, cpfk_orders_lineitem#5212 AS cpfk_orders_lineitem_1#5257, cpfk_supplier_lineitem#5213 AS cpfk_supplier_lineitem_1#5258, cfpk_lineitem_supplier#5214 AS cfpk_lineitem_supplier_1#5259, cfpk_lineitem_partsupp#5215 AS cfpk_lineitem_partsupp_1#5260, cpfk_part_lineitem#5216 AS cpfk_part_lineitem_1#5261, cfpk_lineitem_part#5217 AS cfpk_lineitem_part_1#5262, cpfk_partsupp_lineitem#5218 AS cpfk_partsupp_lineitem_1#5263, cfpk_lineitem_orders#5219 AS cfpk_lineitem_orders_1#5264, cval_lineitem_l_quantity#5220 AS cval_lineitem_l_quantity_1#5265, cval_lineitem_l_extendedprice#5221 AS cval_lineitem_l_extendedprice_1#5266, cval_lineitem_l_discount#5222 AS cval_lineitem_l_discount_1#5267, cval_lineitem_l_tax#5223 AS cval_lineitem_l_tax_1#5268, cval_lineitem_l_returnflag#5224 AS cval_lineitem_l_returnflag_1#5269, cval_lineitem_l_linestatus#5225 AS cval_lineitem_l_linestatus_1#5270, cval_lineitem_l_commitdate#5226 AS cval_lineitem_l_commitdate_1#5271, cval_lineitem_l_receiptdate#5227 AS cval_lineitem_l_receiptdate_1#5272, cval_lineitem_l_shipinstruct#5228 AS cval_lineitem_l_shipinstruct_1#5273, cval_lineitem_l_shipmode#5229 AS cval_lineitem_l_shipmode_1#5274, cval_lineitem_l_comment#5230 AS cval_lineitem_l_comment_1#5275, cval_lineitem_l_shipdate#5231 AS cval_lineitem_l_shipdate_1#5276, cdepval_lineitem_l_quantity#5232 AS cdepval_lineitem_l_quantity_1#5277, cdepval_lineitem_l_extendedprice#5233 AS cdepval_lineitem_l_extendedprice_1#5278, cdepval_lineitem_l_discount#5234 AS cdepval_lineitem_l_discount_1#5279, ... 21 more fields]
         :  :  :  :  +- Relation[rid#5211,cpfk_orders_lineitem#5212,cpfk_supplier_lineitem#5213,cfpk_lineitem_supplier#5214,cfpk_lineitem_partsupp#5215,cpfk_part_lineitem#5216,cfpk_lineitem_part#5217,cpfk_partsupp_lineitem#5218,cfpk_lineitem_orders#5219,cval_lineitem_l_quantity#5220,cval_lineitem_l_extendedprice#5221,cval_lineitem_l_discount#5222,cval_lineitem_l_tax#5223,cval_lineitem_l_returnflag#5224,cval_lineitem_l_linestatus#5225,cval_lineitem_l_commitdate#5226,cval_lineitem_l_receiptdate#5227,cval_lineitem_l_shipinstruct#5228,cval_lineitem_l_shipmode#5229,cval_lineitem_l_comment#5230,cval_lineitem_l_shipdate#5231,cdepval_lineitem_l_quantity#5232,cdepval_lineitem_l_extendedprice#5233,cdepval_lineitem_l_discount#5234,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :     +- Project [rid#5111 AS rid_0#5136, cval_part_p_name#5112 AS cval_part_p_name_0#5137, cval_part_p_mfgr#5113 AS cval_part_p_mfgr_0#5138, cval_part_p_type#5114 AS cval_part_p_type_0#5139, cval_part_p_size#5115 AS cval_part_p_size_0#5140, cval_part_p_container#5116 AS cval_part_p_container_0#5141, cval_part_p_retailprice#5117 AS cval_part_p_retailprice_0#5142, cval_part_p_comment#5118 AS cval_part_p_comment_0#5143, cval_part_p_brand#5119 AS cval_part_p_brand_0#5144, cdepval_part_p_name#5120 AS cdepval_part_p_name_0#5145, cdepval_part_p_mfgr#5121 AS cdepval_part_p_mfgr_0#5146, cdepval_part_p_type#5122 AS cdepval_part_p_type_0#5147, cdepval_part_p_size#5123 AS cdepval_part_p_size_0#5148, cdepval_part_p_container#5124 AS cdepval_part_p_container_0#5149, cdepval_part_p_retailprice#5125 AS cdepval_part_p_retailprice_0#5150, cdepval_part_p_comment#5126 AS cdepval_part_p_comment_0#5151, cdepval_part_p_brand#5127 AS cdepval_part_p_brand_0#5152, cp_name#5128 AS cp_name_0#5153, cp_mfgr#5129 AS cp_mfgr_0#5154, cp_type#5130 AS cp_type_0#5155, cp_size#5131 AS cp_size_0#5156, cp_container#5132 AS cp_container_0#5157, cp_retailprice#5133 AS cp_retailprice_0#5158, cp_comment#5134 AS cp_comment_0#5159, cp_brand#5135 AS cp_brand_0#5160]
         :  :  :        +- Relation[rid#5111,cval_part_p_name#5112,cval_part_p_mfgr#5113,cval_part_p_type#5114,cval_part_p_size#5115,cval_part_p_container#5116,cval_part_p_retailprice#5117,cval_part_p_comment#5118,cval_part_p_brand#5119,cdepval_part_p_name#5120,cdepval_part_p_mfgr#5121,cdepval_part_p_type#5122,cdepval_part_p_size#5123,cdepval_part_p_container#5124,cdepval_part_p_retailprice#5125,cdepval_part_p_comment#5126,cdepval_part_p_brand#5127,cp_name#5128,cp_mfgr#5129,cp_type#5130,cp_size#5131,cp_container#5132,cp_retailprice#5133,cp_comment#5134,cp_brand#5135] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- Project [rid#5301 AS rid_2#5319, cpfk_nation_supplier#5302 AS cpfk_nation_supplier_2#5320, cfpk_supplier_nation#5303 AS cfpk_supplier_nation_2#5321, cval_supplier_s_name#5304 AS cval_supplier_s_name_2#5322, cval_supplier_s_address#5305 AS cval_supplier_s_address_2#5323, cval_supplier_s_phone#5306 AS cval_supplier_s_phone_2#5324, cval_supplier_s_acctbal#5307 AS cval_supplier_s_acctbal_2#5325, cval_supplier_s_comment#5308 AS cval_supplier_s_comment_2#5326, cdepval_supplier_s_name#5309 AS cdepval_supplier_s_name_2#5327, cdepval_supplier_s_address#5310 AS cdepval_supplier_s_address_2#5328, cdepval_supplier_s_phone#5311 AS cdepval_supplier_s_phone_2#5329, cdepval_supplier_s_acctbal#5312 AS cdepval_supplier_s_acctbal_2#5330, cdepval_supplier_s_comment#5313 AS cdepval_supplier_s_comment_2#5331, cs_name#5314 AS cs_name_2#5332, cs_address#5315 AS cs_address_2#5333, cs_phone#5316 AS cs_phone_2#5334, cs_acctbal#5317 AS cs_acctbal_2#5335, cs_comment#5318 AS cs_comment_2#5336]
         :  :     +- Relation[rid#5301,cpfk_nation_supplier#5302,cfpk_supplier_nation#5303,cval_supplier_s_name#5304,cval_supplier_s_address#5305,cval_supplier_s_phone#5306,cval_supplier_s_acctbal#5307,cval_supplier_s_comment#5308,cdepval_supplier_s_name#5309,cdepval_supplier_s_address#5310,cdepval_supplier_s_phone#5311,cdepval_supplier_s_acctbal#5312,cdepval_supplier_s_comment#5313,cs_name#5314,cs_address#5315,cs_phone#5316,cs_acctbal#5317,cs_comment#5318] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#5337 AS rid_3#5346, cpfk_region_nation#5338 AS cpfk_region_nation_3#5347, cfpk_nation_region#5339 AS cfpk_nation_region_3#5348, cval_nation_n_name#5340 AS cval_nation_n_name_3#5349, cval_nation_n_comment#5341 AS cval_nation_n_comment_3#5350, cdepval_nation_n_name#5342 AS cdepval_nation_n_name_3#5351, cdepval_nation_n_comment#5343 AS cdepval_nation_n_comment_3#5352, cn_name#5344 AS cn_name_3#5353, cn_comment#5345 AS cn_comment_3#5354]
         :     +- Relation[rid#5337,cpfk_region_nation#5338,cfpk_nation_region#5339,cval_nation_n_name#5340,cval_nation_n_comment#5341,cdepval_nation_n_name#5342,cdepval_nation_n_comment#5343,cn_name#5344,cn_comment#5345] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#5443 AS rid_7#5467, cpfk_customer_orders#5444 AS cpfk_customer_orders_7#5468, cfpk_orders_customer#5445 AS cfpk_orders_customer_7#5469, cval_orders_o_orderstatus#5446 AS cval_orders_o_orderstatus_7#5470, cval_orders_o_totalprice#5447 AS cval_orders_o_totalprice_7#5471, cval_orders_o_orderpriority#5448 AS cval_orders_o_orderpriority_7#5472, cval_orders_o_clerk#5449 AS cval_orders_o_clerk_7#5473, cval_orders_o_shippriority#5450 AS cval_orders_o_shippriority_7#5474, cval_orders_o_comment#5451 AS cval_orders_o_comment_7#5475, cval_orders_o_orderdate#5452 AS cval_orders_o_orderdate_7#5476, cdepval_orders_o_orderstatus#5453 AS cdepval_orders_o_orderstatus_7#5477, cdepval_orders_o_totalprice#5454 AS cdepval_orders_o_totalprice_7#5478, cdepval_orders_o_orderpriority#5455 AS cdepval_orders_o_orderpriority_7#5479, cdepval_orders_o_clerk#5456 AS cdepval_orders_o_clerk_7#5480, cdepval_orders_o_shippriority#5457 AS cdepval_orders_o_shippriority_7#5481, cdepval_orders_o_comment#5458 AS cdepval_orders_o_comment_7#5482, cdepval_orders_o_orderdate#5459 AS cdepval_orders_o_orderdate_7#5483, co_orderstatus#5460 AS co_orderstatus_7#5484, co_totalprice#5461 AS co_totalprice_7#5485, co_orderpriority#5462 AS co_orderpriority_7#5486, co_clerk#5463 AS co_clerk_7#5487, co_shippriority#5464 AS co_shippriority_7#5488, co_comment#5465 AS co_comment_7#5489, co_orderdate#5466 AS co_orderdate_7#5490]
            :  +- Relation[rid#5443,cpfk_customer_orders#5444,cfpk_orders_customer#5445,cval_orders_o_orderstatus#5446,cval_orders_o_totalprice#5447,cval_orders_o_orderpriority#5448,cval_orders_o_clerk#5449,cval_orders_o_shippriority#5450,cval_orders_o_comment#5451,cval_orders_o_orderdate#5452,cdepval_orders_o_orderstatus#5453,cdepval_orders_o_totalprice#5454,cdepval_orders_o_orderpriority#5455,cdepval_orders_o_clerk#5456,cdepval_orders_o_shippriority#5457,cdepval_orders_o_comment#5458,cdepval_orders_o_orderdate#5459,co_orderstatus#5460,co_totalprice#5461,co_orderpriority#5462,co_clerk#5463,co_shippriority#5464,co_comment#5465,co_orderdate#5466] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#5401 AS rid_6#5422, cpfk_nation_customer#5402 AS cpfk_nation_customer_6#5423, cfpk_customer_nation#5403 AS cfpk_customer_nation_6#5424, cval_customer_c_name#5404 AS cval_customer_c_name_6#5425, cval_customer_c_address#5405 AS cval_customer_c_address_6#5426, cval_customer_c_phone#5406 AS cval_customer_c_phone_6#5427, cval_customer_c_acctbal#5407 AS cval_customer_c_acctbal_6#5428, cval_customer_c_comment#5408 AS cval_customer_c_comment_6#5429, cval_customer_c_mktsegment#5409 AS cval_customer_c_mktsegment_6#5430, cdepval_customer_c_name#5410 AS cdepval_customer_c_name_6#5431, cdepval_customer_c_address#5411 AS cdepval_customer_c_address_6#5432, cdepval_customer_c_phone#5412 AS cdepval_customer_c_phone_6#5433, cdepval_customer_c_acctbal#5413 AS cdepval_customer_c_acctbal_6#5434, cdepval_customer_c_comment#5414 AS cdepval_customer_c_comment_6#5435, cdepval_customer_c_mktsegment#5415 AS cdepval_customer_c_mktsegment_6#5436, cc_name#5416 AS cc_name_6#5437, cc_address#5417 AS cc_address_6#5438, cc_phone#5418 AS cc_phone_6#5439, cc_acctbal#5419 AS cc_acctbal_6#5440, cc_comment#5420 AS cc_comment_6#5441, cc_mktsegment#5421 AS cc_mktsegment_6#5442]
               :  +- Relation[rid#5401,cpfk_nation_customer#5402,cfpk_customer_nation#5403,cval_customer_c_name#5404,cval_customer_c_address#5405,cval_customer_c_phone#5406,cval_customer_c_acctbal#5407,cval_customer_c_comment#5408,cval_customer_c_mktsegment#5409,cdepval_customer_c_name#5410,cdepval_customer_c_address#5411,cdepval_customer_c_phone#5412,cdepval_customer_c_acctbal#5413,cdepval_customer_c_comment#5414,cdepval_customer_c_mktsegment#5415,cc_name#5416,cc_address#5417,cc_phone#5418,cc_acctbal#5419,cc_comment#5420,cc_mktsegment#5421] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_5, BinaryType)), 'cfpk_nation_region_5) = 'rid_4)
                  :- Project [rid#5383 AS rid_5#5392, cpfk_region_nation#5384 AS cpfk_region_nation_5#5393, cfpk_nation_region#5385 AS cfpk_nation_region_5#5394, cval_nation_n_name#5386 AS cval_nation_n_name_5#5395, cval_nation_n_comment#5387 AS cval_nation_n_comment_5#5396, cdepval_nation_n_name#5388 AS cdepval_nation_n_name_5#5397, cdepval_nation_n_comment#5389 AS cdepval_nation_n_comment_5#5398, cn_name#5390 AS cn_name_5#5399, cn_comment#5391 AS cn_comment_5#5400]
                  :  +- Relation[rid#5383,cpfk_region_nation#5384,cfpk_nation_region#5385,cval_nation_n_name#5386,cval_nation_n_comment#5387,cdepval_nation_n_name#5388,cdepval_nation_n_comment#5389,cn_name#5390,cn_comment#5391] JDBCRelation(tnation) [numPartitions=1]
                  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                     +- Project [rid#5355 AS rid_4#5362, cval_region_r_name#5356 AS cval_region_r_name_4#5363, cval_region_r_comment#5357 AS cval_region_r_comment_4#5364, cdepval_region_r_name#5358 AS cdepval_region_r_name_4#5365, cdepval_region_r_comment#5359 AS cdepval_region_r_comment_4#5366, cr_name#5360 AS cr_name_4#5367, cr_comment#5361 AS cr_comment_4#5368]
                        +- Relation[rid#5355,cval_region_r_name#5356,cval_region_r_comment#5357,cdepval_region_r_name#5358,cdepval_region_r_comment#5359,cr_name#5360,cr_comment#5361] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 45064ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/25 21:57:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:57:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5653L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 21:57:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 21:57:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 21:57:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 21:57:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 21:57:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 21:57:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 21:57:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5653L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#5805 AS rid_1#5850, cpfk_orders_lineitem#5806 AS cpfk_orders_lineitem_1#5851, cpfk_supplier_lineitem#5807 AS cpfk_supplier_lineitem_1#5852, cfpk_lineitem_supplier#5808 AS cfpk_lineitem_supplier_1#5853, cfpk_lineitem_partsupp#5809 AS cfpk_lineitem_partsupp_1#5854, cpfk_part_lineitem#5810 AS cpfk_part_lineitem_1#5855, cfpk_lineitem_part#5811 AS cfpk_lineitem_part_1#5856, cpfk_partsupp_lineitem#5812 AS cpfk_partsupp_lineitem_1#5857, cfpk_lineitem_orders#5813 AS cfpk_lineitem_orders_1#5858, cval_lineitem_l_quantity#5814 AS cval_lineitem_l_quantity_1#5859, cval_lineitem_l_extendedprice#5815 AS cval_lineitem_l_extendedprice_1#5860, cval_lineitem_l_discount#5816 AS cval_lineitem_l_discount_1#5861, cval_lineitem_l_tax#5817 AS cval_lineitem_l_tax_1#5862, cval_lineitem_l_returnflag#5818 AS cval_lineitem_l_returnflag_1#5863, cval_lineitem_l_linestatus#5819 AS cval_lineitem_l_linestatus_1#5864, cval_lineitem_l_commitdate#5820 AS cval_lineitem_l_commitdate_1#5865, cval_lineitem_l_receiptdate#5821 AS cval_lineitem_l_receiptdate_1#5866, cval_lineitem_l_shipinstruct#5822 AS cval_lineitem_l_shipinstruct_1#5867, cval_lineitem_l_shipmode#5823 AS cval_lineitem_l_shipmode_1#5868, cval_lineitem_l_comment#5824 AS cval_lineitem_l_comment_1#5869, cval_lineitem_l_shipdate#5825 AS cval_lineitem_l_shipdate_1#5870, cdepval_lineitem_l_quantity#5826 AS cdepval_lineitem_l_quantity_1#5871, cdepval_lineitem_l_extendedprice#5827 AS cdepval_lineitem_l_extendedprice_1#5872, cdepval_lineitem_l_discount#5828 AS cdepval_lineitem_l_discount_1#5873, ... 21 more fields]
         :  +- Relation[rid#5805,cpfk_orders_lineitem#5806,cpfk_supplier_lineitem#5807,cfpk_lineitem_supplier#5808,cfpk_lineitem_partsupp#5809,cpfk_part_lineitem#5810,cfpk_lineitem_part#5811,cpfk_partsupp_lineitem#5812,cfpk_lineitem_orders#5813,cval_lineitem_l_quantity#5814,cval_lineitem_l_extendedprice#5815,cval_lineitem_l_discount#5816,cval_lineitem_l_tax#5817,cval_lineitem_l_returnflag#5818,cval_lineitem_l_linestatus#5819,cval_lineitem_l_commitdate#5820,cval_lineitem_l_receiptdate#5821,cval_lineitem_l_shipinstruct#5822,cval_lineitem_l_shipmode#5823,cval_lineitem_l_comment#5824,cval_lineitem_l_shipdate#5825,cdepval_lineitem_l_quantity#5826,cdepval_lineitem_l_extendedprice#5827,cdepval_lineitem_l_discount#5828,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
               +- Project [rid#5655 AS rid_0#5680, cval_part_p_name#5656 AS cval_part_p_name_0#5681, cval_part_p_mfgr#5657 AS cval_part_p_mfgr_0#5682, cval_part_p_type#5658 AS cval_part_p_type_0#5683, cval_part_p_size#5659 AS cval_part_p_size_0#5684, cval_part_p_container#5660 AS cval_part_p_container_0#5685, cval_part_p_retailprice#5661 AS cval_part_p_retailprice_0#5686, cval_part_p_comment#5662 AS cval_part_p_comment_0#5687, cval_part_p_brand#5663 AS cval_part_p_brand_0#5688, cdepval_part_p_name#5664 AS cdepval_part_p_name_0#5689, cdepval_part_p_mfgr#5665 AS cdepval_part_p_mfgr_0#5690, cdepval_part_p_type#5666 AS cdepval_part_p_type_0#5691, cdepval_part_p_size#5667 AS cdepval_part_p_size_0#5692, cdepval_part_p_container#5668 AS cdepval_part_p_container_0#5693, cdepval_part_p_retailprice#5669 AS cdepval_part_p_retailprice_0#5694, cdepval_part_p_comment#5670 AS cdepval_part_p_comment_0#5695, cdepval_part_p_brand#5671 AS cdepval_part_p_brand_0#5696, cp_name#5672 AS cp_name_0#5697, cp_mfgr#5673 AS cp_mfgr_0#5698, cp_type#5674 AS cp_type_0#5699, cp_size#5675 AS cp_size_0#5700, cp_container#5676 AS cp_container_0#5701, cp_retailprice#5677 AS cp_retailprice_0#5702, cp_comment#5678 AS cp_comment_0#5703, cp_brand#5679 AS cp_brand_0#5704]
                  +- Relation[rid#5655,cval_part_p_name#5656,cval_part_p_mfgr#5657,cval_part_p_type#5658,cval_part_p_size#5659,cval_part_p_container#5660,cval_part_p_retailprice#5661,cval_part_p_comment#5662,cval_part_p_brand#5663,cdepval_part_p_name#5664,cdepval_part_p_mfgr#5665,cdepval_part_p_type#5666,cdepval_part_p_size#5667,cdepval_part_p_container#5668,cdepval_part_p_retailprice#5669,cdepval_part_p_comment#5670,cdepval_part_p_brand#5671,cp_name#5672,cp_mfgr#5673,cp_type#5674,cp_size#5675,cp_container#5676,cp_retailprice#5677,cp_comment#5678,cp_brand#5679] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 25809ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/25 21:57:47 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:57:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5969L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 21:57:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5969L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#5971 AS rid_0#6016, cpfk_orders_lineitem#5972 AS cpfk_orders_lineitem_0#6017, cpfk_supplier_lineitem#5973 AS cpfk_supplier_lineitem_0#6018, cfpk_lineitem_supplier#5974 AS cfpk_lineitem_supplier_0#6019, cfpk_lineitem_partsupp#5975 AS cfpk_lineitem_partsupp_0#6020, cpfk_part_lineitem#5976 AS cpfk_part_lineitem_0#6021, cfpk_lineitem_part#5977 AS cfpk_lineitem_part_0#6022, cpfk_partsupp_lineitem#5978 AS cpfk_partsupp_lineitem_0#6023, cfpk_lineitem_orders#5979 AS cfpk_lineitem_orders_0#6024, cval_lineitem_l_quantity#5980 AS cval_lineitem_l_quantity_0#6025, cval_lineitem_l_extendedprice#5981 AS cval_lineitem_l_extendedprice_0#6026, cval_lineitem_l_discount#5982 AS cval_lineitem_l_discount_0#6027, cval_lineitem_l_tax#5983 AS cval_lineitem_l_tax_0#6028, cval_lineitem_l_returnflag#5984 AS cval_lineitem_l_returnflag_0#6029, cval_lineitem_l_linestatus#5985 AS cval_lineitem_l_linestatus_0#6030, cval_lineitem_l_commitdate#5986 AS cval_lineitem_l_commitdate_0#6031, cval_lineitem_l_receiptdate#5987 AS cval_lineitem_l_receiptdate_0#6032, cval_lineitem_l_shipinstruct#5988 AS cval_lineitem_l_shipinstruct_0#6033, cval_lineitem_l_shipmode#5989 AS cval_lineitem_l_shipmode_0#6034, cval_lineitem_l_comment#5990 AS cval_lineitem_l_comment_0#6035, cval_lineitem_l_shipdate#5991 AS cval_lineitem_l_shipdate_0#6036, cdepval_lineitem_l_quantity#5992 AS cdepval_lineitem_l_quantity_0#6037, cdepval_lineitem_l_extendedprice#5993 AS cdepval_lineitem_l_extendedprice_0#6038, cdepval_lineitem_l_discount#5994 AS cdepval_lineitem_l_discount_0#6039, ... 21 more fields]
         :     +- Relation[rid#5971,cpfk_orders_lineitem#5972,cpfk_supplier_lineitem#5973,cfpk_lineitem_supplier#5974,cfpk_lineitem_partsupp#5975,cpfk_part_lineitem#5976,cfpk_lineitem_part#5977,cpfk_partsupp_lineitem#5978,cfpk_lineitem_orders#5979,cval_lineitem_l_quantity#5980,cval_lineitem_l_extendedprice#5981,cval_lineitem_l_discount#5982,cval_lineitem_l_tax#5983,cval_lineitem_l_returnflag#5984,cval_lineitem_l_linestatus#5985,cval_lineitem_l_commitdate#5986,cval_lineitem_l_receiptdate#5987,cval_lineitem_l_shipinstruct#5988,cval_lineitem_l_shipmode#5989,cval_lineitem_l_comment#5990,cval_lineitem_l_shipdate#5991,cdepval_lineitem_l_quantity#5992,cdepval_lineitem_l_extendedprice#5993,cdepval_lineitem_l_discount#5994,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6151 AS rid_1#6175, cpfk_customer_orders#6152 AS cpfk_customer_orders_1#6176, cfpk_orders_customer#6153 AS cfpk_orders_customer_1#6177, cval_orders_o_orderstatus#6154 AS cval_orders_o_orderstatus_1#6178, cval_orders_o_totalprice#6155 AS cval_orders_o_totalprice_1#6179, cval_orders_o_orderpriority#6156 AS cval_orders_o_orderpriority_1#6180, cval_orders_o_clerk#6157 AS cval_orders_o_clerk_1#6181, cval_orders_o_shippriority#6158 AS cval_orders_o_shippriority_1#6182, cval_orders_o_comment#6159 AS cval_orders_o_comment_1#6183, cval_orders_o_orderdate#6160 AS cval_orders_o_orderdate_1#6184, cdepval_orders_o_orderstatus#6161 AS cdepval_orders_o_orderstatus_1#6185, cdepval_orders_o_totalprice#6162 AS cdepval_orders_o_totalprice_1#6186, cdepval_orders_o_orderpriority#6163 AS cdepval_orders_o_orderpriority_1#6187, cdepval_orders_o_clerk#6164 AS cdepval_orders_o_clerk_1#6188, cdepval_orders_o_shippriority#6165 AS cdepval_orders_o_shippriority_1#6189, cdepval_orders_o_comment#6166 AS cdepval_orders_o_comment_1#6190, cdepval_orders_o_orderdate#6167 AS cdepval_orders_o_orderdate_1#6191, co_orderstatus#6168 AS co_orderstatus_1#6192, co_totalprice#6169 AS co_totalprice_1#6193, co_orderpriority#6170 AS co_orderpriority_1#6194, co_clerk#6171 AS co_clerk_1#6195, co_shippriority#6172 AS co_shippriority_1#6196, co_comment#6173 AS co_comment_1#6197, co_orderdate#6174 AS co_orderdate_1#6198]
            +- Relation[rid#6151,cpfk_customer_orders#6152,cfpk_orders_customer#6153,cval_orders_o_orderstatus#6154,cval_orders_o_totalprice#6155,cval_orders_o_orderpriority#6156,cval_orders_o_clerk#6157,cval_orders_o_shippriority#6158,cval_orders_o_comment#6159,cval_orders_o_orderdate#6160,cdepval_orders_o_orderstatus#6161,cdepval_orders_o_totalprice#6162,cdepval_orders_o_orderpriority#6163,cdepval_orders_o_clerk#6164,cdepval_orders_o_shippriority#6165,cdepval_orders_o_comment#6166,cdepval_orders_o_orderdate#6167,co_orderstatus#6168,co_totalprice#6169,co_orderpriority#6170,co_clerk#6171,co_shippriority#6172,co_comment#6173,co_orderdate#6174] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 21971ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/25 21:58:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:58:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6272L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 21:58:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6272L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#6274 AS rid_0#6298, cpfk_customer_orders#6275 AS cpfk_customer_orders_0#6299, cfpk_orders_customer#6276 AS cfpk_orders_customer_0#6300, cval_orders_o_orderstatus#6277 AS cval_orders_o_orderstatus_0#6301, cval_orders_o_totalprice#6278 AS cval_orders_o_totalprice_0#6302, cval_orders_o_orderpriority#6279 AS cval_orders_o_orderpriority_0#6303, cval_orders_o_clerk#6280 AS cval_orders_o_clerk_0#6304, cval_orders_o_shippriority#6281 AS cval_orders_o_shippriority_0#6305, cval_orders_o_comment#6282 AS cval_orders_o_comment_0#6306, cval_orders_o_orderdate#6283 AS cval_orders_o_orderdate_0#6307, cdepval_orders_o_orderstatus#6284 AS cdepval_orders_o_orderstatus_0#6308, cdepval_orders_o_totalprice#6285 AS cdepval_orders_o_totalprice_0#6309, cdepval_orders_o_orderpriority#6286 AS cdepval_orders_o_orderpriority_0#6310, cdepval_orders_o_clerk#6287 AS cdepval_orders_o_clerk_0#6311, cdepval_orders_o_shippriority#6288 AS cdepval_orders_o_shippriority_0#6312, cdepval_orders_o_comment#6289 AS cdepval_orders_o_comment_0#6313, cdepval_orders_o_orderdate#6290 AS cdepval_orders_o_orderdate_0#6314, co_orderstatus#6291 AS co_orderstatus_0#6315, co_totalprice#6292 AS co_totalprice_0#6316, co_orderpriority#6293 AS co_orderpriority_0#6317, co_clerk#6294 AS co_clerk_0#6318, co_shippriority#6295 AS co_shippriority_0#6319, co_comment#6296 AS co_comment_0#6320, co_orderdate#6297 AS co_orderdate_0#6321]
         :  +- Relation[rid#6274,cpfk_customer_orders#6275,cfpk_orders_customer#6276,cval_orders_o_orderstatus#6277,cval_orders_o_totalprice#6278,cval_orders_o_orderpriority#6279,cval_orders_o_clerk#6280,cval_orders_o_shippriority#6281,cval_orders_o_comment#6282,cval_orders_o_orderdate#6283,cdepval_orders_o_orderstatus#6284,cdepval_orders_o_totalprice#6285,cdepval_orders_o_orderpriority#6286,cdepval_orders_o_clerk#6287,cdepval_orders_o_shippriority#6288,cdepval_orders_o_comment#6289,cdepval_orders_o_orderdate#6290,co_orderstatus#6291,co_totalprice#6292,co_orderpriority#6293,co_clerk#6294,co_shippriority#6295,co_comment#6296,co_orderdate#6297] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#6322 AS rid_1#6343, cpfk_nation_customer#6323 AS cpfk_nation_customer_1#6344, cfpk_customer_nation#6324 AS cfpk_customer_nation_1#6345, cval_customer_c_name#6325 AS cval_customer_c_name_1#6346, cval_customer_c_address#6326 AS cval_customer_c_address_1#6347, cval_customer_c_phone#6327 AS cval_customer_c_phone_1#6348, cval_customer_c_acctbal#6328 AS cval_customer_c_acctbal_1#6349, cval_customer_c_comment#6329 AS cval_customer_c_comment_1#6350, cval_customer_c_mktsegment#6330 AS cval_customer_c_mktsegment_1#6351, cdepval_customer_c_name#6331 AS cdepval_customer_c_name_1#6352, cdepval_customer_c_address#6332 AS cdepval_customer_c_address_1#6353, cdepval_customer_c_phone#6333 AS cdepval_customer_c_phone_1#6354, cdepval_customer_c_acctbal#6334 AS cdepval_customer_c_acctbal_1#6355, cdepval_customer_c_comment#6335 AS cdepval_customer_c_comment_1#6356, cdepval_customer_c_mktsegment#6336 AS cdepval_customer_c_mktsegment_1#6357, cc_name#6337 AS cc_name_1#6358, cc_address#6338 AS cc_address_1#6359, cc_phone#6339 AS cc_phone_1#6360, cc_acctbal#6340 AS cc_acctbal_1#6361, cc_comment#6341 AS cc_comment_1#6362, cc_mktsegment#6342 AS cc_mktsegment_1#6363]
            +- Relation[rid#6322,cpfk_nation_customer#6323,cfpk_customer_nation#6324,cval_customer_c_name#6325,cval_customer_c_address#6326,cval_customer_c_phone#6327,cval_customer_c_acctbal#6328,cval_customer_c_comment#6329,cval_customer_c_mktsegment#6330,cdepval_customer_c_name#6331,cdepval_customer_c_address#6332,cdepval_customer_c_phone#6333,cdepval_customer_c_acctbal#6334,cdepval_customer_c_comment#6335,cdepval_customer_c_mktsegment#6336,cc_name#6337,cc_address#6338,cc_phone#6339,cc_acctbal#6340,cc_comment#6341,cc_mktsegment#6342] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4294ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/25 21:58:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:58:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6413L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 21:58:13 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 21:58:13 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 21:58:13 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 21:58:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:58:13 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 21:58:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:58:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:58:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:58:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:58:13 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:58:13 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:58:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:58:13 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:58:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6413L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_part_4) = 'rid_3)
         :  :- Project [rid#6597 AS rid_4#6611, cpfk_part_partsupp#6598 AS cpfk_part_partsupp_4#6612, cfpk_partsupp_part#6599 AS cfpk_partsupp_part_4#6613, cpfk_supplier_partsupp#6600 AS cpfk_supplier_partsupp_4#6614, cfpk_partsupp_supplier#6601 AS cfpk_partsupp_supplier_4#6615, cval_partsupp_ps_availqty#6602 AS cval_partsupp_ps_availqty_4#6616, cval_partsupp_ps_supplycost#6603 AS cval_partsupp_ps_supplycost_4#6617, cval_partsupp_ps_comment#6604 AS cval_partsupp_ps_comment_4#6618, cdepval_partsupp_ps_availqty#6605 AS cdepval_partsupp_ps_availqty_4#6619, cdepval_partsupp_ps_supplycost#6606 AS cdepval_partsupp_ps_supplycost_4#6620, cdepval_partsupp_ps_comment#6607 AS cdepval_partsupp_ps_comment_4#6621, cps_availqty#6608 AS cps_availqty_4#6622, cps_supplycost#6609 AS cps_supplycost_4#6623, cps_comment#6610 AS cps_comment_4#6624]
         :  :  +- Relation[rid#6597,cpfk_part_partsupp#6598,cfpk_partsupp_part#6599,cpfk_supplier_partsupp#6600,cfpk_partsupp_supplier#6601,cval_partsupp_ps_availqty#6602,cval_partsupp_ps_supplycost#6603,cval_partsupp_ps_comment#6604,cdepval_partsupp_ps_availqty#6605,cdepval_partsupp_ps_supplycost#6606,cdepval_partsupp_ps_comment#6607,cps_availqty#6608,cps_supplycost#6609,cps_comment#6610] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :     +- Project [rid#6497 AS rid_3#6522, cval_part_p_name#6498 AS cval_part_p_name_3#6523, cval_part_p_mfgr#6499 AS cval_part_p_mfgr_3#6524, cval_part_p_type#6500 AS cval_part_p_type_3#6525, cval_part_p_size#6501 AS cval_part_p_size_3#6526, cval_part_p_container#6502 AS cval_part_p_container_3#6527, cval_part_p_retailprice#6503 AS cval_part_p_retailprice_3#6528, cval_part_p_comment#6504 AS cval_part_p_comment_3#6529, cval_part_p_brand#6505 AS cval_part_p_brand_3#6530, cdepval_part_p_name#6506 AS cdepval_part_p_name_3#6531, cdepval_part_p_mfgr#6507 AS cdepval_part_p_mfgr_3#6532, cdepval_part_p_type#6508 AS cdepval_part_p_type_3#6533, cdepval_part_p_size#6509 AS cdepval_part_p_size_3#6534, cdepval_part_p_container#6510 AS cdepval_part_p_container_3#6535, cdepval_part_p_retailprice#6511 AS cdepval_part_p_retailprice_3#6536, cdepval_part_p_comment#6512 AS cdepval_part_p_comment_3#6537, cdepval_part_p_brand#6513 AS cdepval_part_p_brand_3#6538, cp_name#6514 AS cp_name_3#6539, cp_mfgr#6515 AS cp_mfgr_3#6540, cp_type#6516 AS cp_type_3#6541, cp_size#6517 AS cp_size_3#6542, cp_container#6518 AS cp_container_3#6543, cp_retailprice#6519 AS cp_retailprice_3#6544, cp_comment#6520 AS cp_comment_3#6545, cp_brand#6521 AS cp_brand_3#6546]
         :        +- Relation[rid#6497,cval_part_p_name#6498,cval_part_p_mfgr#6499,cval_part_p_type#6500,cval_part_p_size#6501,cval_part_p_container#6502,cval_part_p_retailprice#6503,cval_part_p_comment#6504,cval_part_p_brand#6505,cdepval_part_p_name#6506,cdepval_part_p_mfgr#6507,cdepval_part_p_type#6508,cdepval_part_p_size#6509,cdepval_part_p_container#6510,cdepval_part_p_retailprice#6511,cdepval_part_p_comment#6512,cdepval_part_p_brand#6513,cp_name#6514,cp_mfgr#6515,cp_type#6516,cp_size#6517,cp_container#6518,cp_retailprice#6519,cp_comment#6520,cp_brand#6521] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#6461 AS rid_2#6479, cpfk_nation_supplier#6462 AS cpfk_nation_supplier_2#6480, cfpk_supplier_nation#6463 AS cfpk_supplier_nation_2#6481, cval_supplier_s_name#6464 AS cval_supplier_s_name_2#6482, cval_supplier_s_address#6465 AS cval_supplier_s_address_2#6483, cval_supplier_s_phone#6466 AS cval_supplier_s_phone_2#6484, cval_supplier_s_acctbal#6467 AS cval_supplier_s_acctbal_2#6485, cval_supplier_s_comment#6468 AS cval_supplier_s_comment_2#6486, cdepval_supplier_s_name#6469 AS cdepval_supplier_s_name_2#6487, cdepval_supplier_s_address#6470 AS cdepval_supplier_s_address_2#6488, cdepval_supplier_s_phone#6471 AS cdepval_supplier_s_phone_2#6489, cdepval_supplier_s_acctbal#6472 AS cdepval_supplier_s_acctbal_2#6490, cdepval_supplier_s_comment#6473 AS cdepval_supplier_s_comment_2#6491, cs_name#6474 AS cs_name_2#6492, cs_address#6475 AS cs_address_2#6493, cs_phone#6476 AS cs_phone_2#6494, cs_acctbal#6477 AS cs_acctbal_2#6495, cs_comment#6478 AS cs_comment_2#6496]
            :  +- Relation[rid#6461,cpfk_nation_supplier#6462,cfpk_supplier_nation#6463,cval_supplier_s_name#6464,cval_supplier_s_address#6465,cval_supplier_s_phone#6466,cval_supplier_s_acctbal#6467,cval_supplier_s_comment#6468,cdepval_supplier_s_name#6469,cdepval_supplier_s_address#6470,cdepval_supplier_s_phone#6471,cdepval_supplier_s_acctbal#6472,cdepval_supplier_s_comment#6473,cs_name#6474,cs_address#6475,cs_phone#6476,cs_acctbal#6477,cs_comment#6478] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
               :- Project [rid#6443 AS rid_1#6452, cpfk_region_nation#6444 AS cpfk_region_nation_1#6453, cfpk_nation_region#6445 AS cfpk_nation_region_1#6454, cval_nation_n_name#6446 AS cval_nation_n_name_1#6455, cval_nation_n_comment#6447 AS cval_nation_n_comment_1#6456, cdepval_nation_n_name#6448 AS cdepval_nation_n_name_1#6457, cdepval_nation_n_comment#6449 AS cdepval_nation_n_comment_1#6458, cn_name#6450 AS cn_name_1#6459, cn_comment#6451 AS cn_comment_1#6460]
               :  +- Relation[rid#6443,cpfk_region_nation#6444,cfpk_nation_region#6445,cval_nation_n_name#6446,cval_nation_n_comment#6447,cdepval_nation_n_name#6448,cdepval_nation_n_comment#6449,cn_name#6450,cn_comment#6451] JDBCRelation(tnation) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
                  +- Project [rid#6415 AS rid_0#6422, cval_region_r_name#6416 AS cval_region_r_name_0#6423, cval_region_r_comment#6417 AS cval_region_r_comment_0#6424, cdepval_region_r_name#6418 AS cdepval_region_r_name_0#6425, cdepval_region_r_comment#6419 AS cdepval_region_r_comment_0#6426, cr_name#6420 AS cr_name_0#6427, cr_comment#6421 AS cr_comment_0#6428]
                     +- Relation[rid#6415,cval_region_r_name#6416,cval_region_r_comment#6417,cdepval_region_r_name#6418,cdepval_region_r_comment#6419,cr_name#6420,cr_comment#6421] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 3672ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/25 21:58:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:58:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6705L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 21:58:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:58:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:58:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6705L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :- Project [rid#6807 AS rid_1#6821, cpfk_part_partsupp#6808 AS cpfk_part_partsupp_1#6822, cfpk_partsupp_part#6809 AS cfpk_partsupp_part_1#6823, cpfk_supplier_partsupp#6810 AS cpfk_supplier_partsupp_1#6824, cfpk_partsupp_supplier#6811 AS cfpk_partsupp_supplier_1#6825, cval_partsupp_ps_availqty#6812 AS cval_partsupp_ps_availqty_1#6826, cval_partsupp_ps_supplycost#6813 AS cval_partsupp_ps_supplycost_1#6827, cval_partsupp_ps_comment#6814 AS cval_partsupp_ps_comment_1#6828, cdepval_partsupp_ps_availqty#6815 AS cdepval_partsupp_ps_availqty_1#6829, cdepval_partsupp_ps_supplycost#6816 AS cdepval_partsupp_ps_supplycost_1#6830, cdepval_partsupp_ps_comment#6817 AS cdepval_partsupp_ps_comment_1#6831, cps_availqty#6818 AS cps_availqty_1#6832, cps_supplycost#6819 AS cps_supplycost_1#6833, cps_comment#6820 AS cps_comment_1#6834]
         :  +- Relation[rid#6807,cpfk_part_partsupp#6808,cfpk_partsupp_part#6809,cpfk_supplier_partsupp#6810,cfpk_partsupp_supplier#6811,cval_partsupp_ps_availqty#6812,cval_partsupp_ps_supplycost#6813,cval_partsupp_ps_comment#6814,cdepval_partsupp_ps_availqty#6815,cdepval_partsupp_ps_supplycost#6816,cdepval_partsupp_ps_comment#6817,cps_availqty#6818,cps_supplycost#6819,cps_comment#6820] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
            +- Project [rid#6707 AS rid_0#6732, cval_part_p_name#6708 AS cval_part_p_name_0#6733, cval_part_p_mfgr#6709 AS cval_part_p_mfgr_0#6734, cval_part_p_type#6710 AS cval_part_p_type_0#6735, cval_part_p_size#6711 AS cval_part_p_size_0#6736, cval_part_p_container#6712 AS cval_part_p_container_0#6737, cval_part_p_retailprice#6713 AS cval_part_p_retailprice_0#6738, cval_part_p_comment#6714 AS cval_part_p_comment_0#6739, cval_part_p_brand#6715 AS cval_part_p_brand_0#6740, cdepval_part_p_name#6716 AS cdepval_part_p_name_0#6741, cdepval_part_p_mfgr#6717 AS cdepval_part_p_mfgr_0#6742, cdepval_part_p_type#6718 AS cdepval_part_p_type_0#6743, cdepval_part_p_size#6719 AS cdepval_part_p_size_0#6744, cdepval_part_p_container#6720 AS cdepval_part_p_container_0#6745, cdepval_part_p_retailprice#6721 AS cdepval_part_p_retailprice_0#6746, cdepval_part_p_comment#6722 AS cdepval_part_p_comment_0#6747, cdepval_part_p_brand#6723 AS cdepval_part_p_brand_0#6748, cp_name#6724 AS cp_name_0#6749, cp_mfgr#6725 AS cp_mfgr_0#6750, cp_type#6726 AS cp_type_0#6751, cp_size#6727 AS cp_size_0#6752, cp_container#6728 AS cp_container_0#6753, cp_retailprice#6729 AS cp_retailprice_0#6754, cp_comment#6730 AS cp_comment_0#6755, cp_brand#6731 AS cp_brand_0#6756]
               +- Relation[rid#6707,cval_part_p_name#6708,cval_part_p_mfgr#6709,cval_part_p_type#6710,cval_part_p_size#6711,cval_part_p_container#6712,cval_part_p_retailprice#6713,cval_part_p_comment#6714,cval_part_p_brand#6715,cdepval_part_p_name#6716,cdepval_part_p_mfgr#6717,cdepval_part_p_type#6718,cdepval_part_p_size#6719,cdepval_part_p_container#6720,cdepval_part_p_retailprice#6721,cdepval_part_p_comment#6722,cdepval_part_p_brand#6723,cp_name#6724,cp_mfgr#6725,cp_type#6726,cp_size#6727,cp_container#6728,cp_retailprice#6729,cp_comment#6730,cp_brand#6731] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 3317ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/25 21:58:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:58:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6882L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 21:58:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:58:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:58:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:58:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:58:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:58:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:58:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:58:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:58:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:58:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:58:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:58:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6882L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#6956 AS rid_2#7001, cpfk_orders_lineitem#6957 AS cpfk_orders_lineitem_2#7002, cpfk_supplier_lineitem#6958 AS cpfk_supplier_lineitem_2#7003, cfpk_lineitem_supplier#6959 AS cfpk_lineitem_supplier_2#7004, cfpk_lineitem_partsupp#6960 AS cfpk_lineitem_partsupp_2#7005, cpfk_part_lineitem#6961 AS cpfk_part_lineitem_2#7006, cfpk_lineitem_part#6962 AS cfpk_lineitem_part_2#7007, cpfk_partsupp_lineitem#6963 AS cpfk_partsupp_lineitem_2#7008, cfpk_lineitem_orders#6964 AS cfpk_lineitem_orders_2#7009, cval_lineitem_l_quantity#6965 AS cval_lineitem_l_quantity_2#7010, cval_lineitem_l_extendedprice#6966 AS cval_lineitem_l_extendedprice_2#7011, cval_lineitem_l_discount#6967 AS cval_lineitem_l_discount_2#7012, cval_lineitem_l_tax#6968 AS cval_lineitem_l_tax_2#7013, cval_lineitem_l_returnflag#6969 AS cval_lineitem_l_returnflag_2#7014, cval_lineitem_l_linestatus#6970 AS cval_lineitem_l_linestatus_2#7015, cval_lineitem_l_commitdate#6971 AS cval_lineitem_l_commitdate_2#7016, cval_lineitem_l_receiptdate#6972 AS cval_lineitem_l_receiptdate_2#7017, cval_lineitem_l_shipinstruct#6973 AS cval_lineitem_l_shipinstruct_2#7018, cval_lineitem_l_shipmode#6974 AS cval_lineitem_l_shipmode_2#7019, cval_lineitem_l_comment#6975 AS cval_lineitem_l_comment_2#7020, cval_lineitem_l_shipdate#6976 AS cval_lineitem_l_shipdate_2#7021, cdepval_lineitem_l_quantity#6977 AS cdepval_lineitem_l_quantity_2#7022, cdepval_lineitem_l_extendedprice#6978 AS cdepval_lineitem_l_extendedprice_2#7023, cdepval_lineitem_l_discount#6979 AS cdepval_lineitem_l_discount_2#7024, ... 21 more fields]
         :  :  +- Relation[rid#6956,cpfk_orders_lineitem#6957,cpfk_supplier_lineitem#6958,cfpk_lineitem_supplier#6959,cfpk_lineitem_partsupp#6960,cpfk_part_lineitem#6961,cfpk_lineitem_part#6962,cpfk_partsupp_lineitem#6963,cfpk_lineitem_orders#6964,cval_lineitem_l_quantity#6965,cval_lineitem_l_extendedprice#6966,cval_lineitem_l_discount#6967,cval_lineitem_l_tax#6968,cval_lineitem_l_returnflag#6969,cval_lineitem_l_linestatus#6970,cval_lineitem_l_commitdate#6971,cval_lineitem_l_receiptdate#6972,cval_lineitem_l_shipinstruct#6973,cval_lineitem_l_shipmode#6974,cval_lineitem_l_comment#6975,cval_lineitem_l_shipdate#6976,cdepval_lineitem_l_quantity#6977,cdepval_lineitem_l_extendedprice#6978,cdepval_lineitem_l_discount#6979,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :- Project [rid#6920 AS rid_1#6938, cpfk_nation_supplier#6921 AS cpfk_nation_supplier_1#6939, cfpk_supplier_nation#6922 AS cfpk_supplier_nation_1#6940, cval_supplier_s_name#6923 AS cval_supplier_s_name_1#6941, cval_supplier_s_address#6924 AS cval_supplier_s_address_1#6942, cval_supplier_s_phone#6925 AS cval_supplier_s_phone_1#6943, cval_supplier_s_acctbal#6926 AS cval_supplier_s_acctbal_1#6944, cval_supplier_s_comment#6927 AS cval_supplier_s_comment_1#6945, cdepval_supplier_s_name#6928 AS cdepval_supplier_s_name_1#6946, cdepval_supplier_s_address#6929 AS cdepval_supplier_s_address_1#6947, cdepval_supplier_s_phone#6930 AS cdepval_supplier_s_phone_1#6948, cdepval_supplier_s_acctbal#6931 AS cdepval_supplier_s_acctbal_1#6949, cdepval_supplier_s_comment#6932 AS cdepval_supplier_s_comment_1#6950, cs_name#6933 AS cs_name_1#6951, cs_address#6934 AS cs_address_1#6952, cs_phone#6935 AS cs_phone_1#6953, cs_acctbal#6936 AS cs_acctbal_1#6954, cs_comment#6937 AS cs_comment_1#6955]
         :     :  +- Relation[rid#6920,cpfk_nation_supplier#6921,cfpk_supplier_nation#6922,cval_supplier_s_name#6923,cval_supplier_s_address#6924,cval_supplier_s_phone#6925,cval_supplier_s_acctbal#6926,cval_supplier_s_comment#6927,cdepval_supplier_s_name#6928,cdepval_supplier_s_address#6929,cdepval_supplier_s_phone#6930,cdepval_supplier_s_acctbal#6931,cdepval_supplier_s_comment#6932,cs_name#6933,cs_address#6934,cs_phone#6935,cs_acctbal#6936,cs_comment#6937] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :        +- Project [rid#6884 AS rid_0#6893, cpfk_region_nation#6885 AS cpfk_region_nation_0#6894, cfpk_nation_region#6886 AS cfpk_nation_region_0#6895, cval_nation_n_name#6887 AS cval_nation_n_name_0#6896, cval_nation_n_comment#6888 AS cval_nation_n_comment_0#6897, cdepval_nation_n_name#6889 AS cdepval_nation_n_name_0#6898, cdepval_nation_n_comment#6890 AS cdepval_nation_n_comment_0#6899, cn_name#6891 AS cn_name_0#6900, cn_comment#6892 AS cn_comment_0#6901]
         :           +- Relation[rid#6884,cpfk_region_nation#6885,cfpk_nation_region#6886,cval_nation_n_name#6887,cval_nation_n_comment#6888,cdepval_nation_n_name#6889,cdepval_nation_n_comment#6890,cn_name#6891,cn_comment#6892] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#7124 AS rid_5#7148, cpfk_customer_orders#7125 AS cpfk_customer_orders_5#7149, cfpk_orders_customer#7126 AS cfpk_orders_customer_5#7150, cval_orders_o_orderstatus#7127 AS cval_orders_o_orderstatus_5#7151, cval_orders_o_totalprice#7128 AS cval_orders_o_totalprice_5#7152, cval_orders_o_orderpriority#7129 AS cval_orders_o_orderpriority_5#7153, cval_orders_o_clerk#7130 AS cval_orders_o_clerk_5#7154, cval_orders_o_shippriority#7131 AS cval_orders_o_shippriority_5#7155, cval_orders_o_comment#7132 AS cval_orders_o_comment_5#7156, cval_orders_o_orderdate#7133 AS cval_orders_o_orderdate_5#7157, cdepval_orders_o_orderstatus#7134 AS cdepval_orders_o_orderstatus_5#7158, cdepval_orders_o_totalprice#7135 AS cdepval_orders_o_totalprice_5#7159, cdepval_orders_o_orderpriority#7136 AS cdepval_orders_o_orderpriority_5#7160, cdepval_orders_o_clerk#7137 AS cdepval_orders_o_clerk_5#7161, cdepval_orders_o_shippriority#7138 AS cdepval_orders_o_shippriority_5#7162, cdepval_orders_o_comment#7139 AS cdepval_orders_o_comment_5#7163, cdepval_orders_o_orderdate#7140 AS cdepval_orders_o_orderdate_5#7164, co_orderstatus#7141 AS co_orderstatus_5#7165, co_totalprice#7142 AS co_totalprice_5#7166, co_orderpriority#7143 AS co_orderpriority_5#7167, co_clerk#7144 AS co_clerk_5#7168, co_shippriority#7145 AS co_shippriority_5#7169, co_comment#7146 AS co_comment_5#7170, co_orderdate#7147 AS co_orderdate_5#7171]
            :  +- Relation[rid#7124,cpfk_customer_orders#7125,cfpk_orders_customer#7126,cval_orders_o_orderstatus#7127,cval_orders_o_totalprice#7128,cval_orders_o_orderpriority#7129,cval_orders_o_clerk#7130,cval_orders_o_shippriority#7131,cval_orders_o_comment#7132,cval_orders_o_orderdate#7133,cdepval_orders_o_orderstatus#7134,cdepval_orders_o_totalprice#7135,cdepval_orders_o_orderpriority#7136,cdepval_orders_o_clerk#7137,cdepval_orders_o_shippriority#7138,cdepval_orders_o_comment#7139,cdepval_orders_o_orderdate#7140,co_orderstatus#7141,co_totalprice#7142,co_orderpriority#7143,co_clerk#7144,co_shippriority#7145,co_comment#7146,co_orderdate#7147] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_4, BinaryType)), 'cfpk_customer_nation_4) = 'rid_3)
               :- Project [rid#7082 AS rid_4#7103, cpfk_nation_customer#7083 AS cpfk_nation_customer_4#7104, cfpk_customer_nation#7084 AS cfpk_customer_nation_4#7105, cval_customer_c_name#7085 AS cval_customer_c_name_4#7106, cval_customer_c_address#7086 AS cval_customer_c_address_4#7107, cval_customer_c_phone#7087 AS cval_customer_c_phone_4#7108, cval_customer_c_acctbal#7088 AS cval_customer_c_acctbal_4#7109, cval_customer_c_comment#7089 AS cval_customer_c_comment_4#7110, cval_customer_c_mktsegment#7090 AS cval_customer_c_mktsegment_4#7111, cdepval_customer_c_name#7091 AS cdepval_customer_c_name_4#7112, cdepval_customer_c_address#7092 AS cdepval_customer_c_address_4#7113, cdepval_customer_c_phone#7093 AS cdepval_customer_c_phone_4#7114, cdepval_customer_c_acctbal#7094 AS cdepval_customer_c_acctbal_4#7115, cdepval_customer_c_comment#7095 AS cdepval_customer_c_comment_4#7116, cdepval_customer_c_mktsegment#7096 AS cdepval_customer_c_mktsegment_4#7117, cc_name#7097 AS cc_name_4#7118, cc_address#7098 AS cc_address_4#7119, cc_phone#7099 AS cc_phone_4#7120, cc_acctbal#7100 AS cc_acctbal_4#7121, cc_comment#7101 AS cc_comment_4#7122, cc_mktsegment#7102 AS cc_mktsegment_4#7123]
               :  +- Relation[rid#7082,cpfk_nation_customer#7083,cfpk_customer_nation#7084,cval_customer_c_name#7085,cval_customer_c_address#7086,cval_customer_c_phone#7087,cval_customer_c_acctbal#7088,cval_customer_c_comment#7089,cval_customer_c_mktsegment#7090,cdepval_customer_c_name#7091,cdepval_customer_c_address#7092,cdepval_customer_c_phone#7093,cdepval_customer_c_acctbal#7094,cdepval_customer_c_comment#7095,cdepval_customer_c_mktsegment#7096,cc_name#7097,cc_address#7098,cc_phone#7099,cc_acctbal#7100,cc_comment#7101,cc_mktsegment#7102] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
                  +- Project [rid#7046 AS rid_3#7055, cpfk_region_nation#7047 AS cpfk_region_nation_3#7056, cfpk_nation_region#7048 AS cfpk_nation_region_3#7057, cval_nation_n_name#7049 AS cval_nation_n_name_3#7058, cval_nation_n_comment#7050 AS cval_nation_n_comment_3#7059, cdepval_nation_n_name#7051 AS cdepval_nation_n_name_3#7060, cdepval_nation_n_comment#7052 AS cdepval_nation_n_comment_3#7061, cn_name#7053 AS cn_name_3#7062, cn_comment#7054 AS cn_comment_3#7063]
                     +- Relation[rid#7046,cpfk_region_nation#7047,cfpk_nation_region#7048,cval_nation_n_name#7049,cval_nation_n_comment#7050,cdepval_nation_n_name#7051,cdepval_nation_n_comment#7052,cn_name#7053,cn_comment#7054] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 34780ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 21:58:55 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:58:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7307L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 21:58:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:58:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:58:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:58:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:58:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:58:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:58:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:58:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:58:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:58:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:58:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:58:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7307L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#7441 AS rid_4#7486, cpfk_orders_lineitem#7442 AS cpfk_orders_lineitem_4#7487, cpfk_supplier_lineitem#7443 AS cpfk_supplier_lineitem_4#7488, cfpk_lineitem_supplier#7444 AS cfpk_lineitem_supplier_4#7489, cfpk_lineitem_partsupp#7445 AS cfpk_lineitem_partsupp_4#7490, cpfk_part_lineitem#7446 AS cpfk_part_lineitem_4#7491, cfpk_lineitem_part#7447 AS cfpk_lineitem_part_4#7492, cpfk_partsupp_lineitem#7448 AS cpfk_partsupp_lineitem_4#7493, cfpk_lineitem_orders#7449 AS cfpk_lineitem_orders_4#7494, cval_lineitem_l_quantity#7450 AS cval_lineitem_l_quantity_4#7495, cval_lineitem_l_extendedprice#7451 AS cval_lineitem_l_extendedprice_4#7496, cval_lineitem_l_discount#7452 AS cval_lineitem_l_discount_4#7497, cval_lineitem_l_tax#7453 AS cval_lineitem_l_tax_4#7498, cval_lineitem_l_returnflag#7454 AS cval_lineitem_l_returnflag_4#7499, cval_lineitem_l_linestatus#7455 AS cval_lineitem_l_linestatus_4#7500, cval_lineitem_l_commitdate#7456 AS cval_lineitem_l_commitdate_4#7501, cval_lineitem_l_receiptdate#7457 AS cval_lineitem_l_receiptdate_4#7502, cval_lineitem_l_shipinstruct#7458 AS cval_lineitem_l_shipinstruct_4#7503, cval_lineitem_l_shipmode#7459 AS cval_lineitem_l_shipmode_4#7504, cval_lineitem_l_comment#7460 AS cval_lineitem_l_comment_4#7505, cval_lineitem_l_shipdate#7461 AS cval_lineitem_l_shipdate_4#7506, cdepval_lineitem_l_quantity#7462 AS cdepval_lineitem_l_quantity_4#7507, cdepval_lineitem_l_extendedprice#7463 AS cdepval_lineitem_l_extendedprice_4#7508, cdepval_lineitem_l_discount#7464 AS cdepval_lineitem_l_discount_4#7509, ... 21 more fields]
         :  :  +- Relation[rid#7441,cpfk_orders_lineitem#7442,cpfk_supplier_lineitem#7443,cfpk_lineitem_supplier#7444,cfpk_lineitem_partsupp#7445,cpfk_part_lineitem#7446,cfpk_lineitem_part#7447,cpfk_partsupp_lineitem#7448,cfpk_lineitem_orders#7449,cval_lineitem_l_quantity#7450,cval_lineitem_l_extendedprice#7451,cval_lineitem_l_discount#7452,cval_lineitem_l_tax#7453,cval_lineitem_l_returnflag#7454,cval_lineitem_l_linestatus#7455,cval_lineitem_l_commitdate#7456,cval_lineitem_l_receiptdate#7457,cval_lineitem_l_shipinstruct#7458,cval_lineitem_l_shipmode#7459,cval_lineitem_l_comment#7460,cval_lineitem_l_shipdate#7461,cdepval_lineitem_l_quantity#7462,cdepval_lineitem_l_extendedprice#7463,cdepval_lineitem_l_discount#7464,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#7363 AS rid_2#7377, cpfk_part_partsupp#7364 AS cpfk_part_partsupp_2#7378, cfpk_partsupp_part#7365 AS cfpk_partsupp_part_2#7379, cpfk_supplier_partsupp#7366 AS cpfk_supplier_partsupp_2#7380, cfpk_partsupp_supplier#7367 AS cfpk_partsupp_supplier_2#7381, cval_partsupp_ps_availqty#7368 AS cval_partsupp_ps_availqty_2#7382, cval_partsupp_ps_supplycost#7369 AS cval_partsupp_ps_supplycost_2#7383, cval_partsupp_ps_comment#7370 AS cval_partsupp_ps_comment_2#7384, cdepval_partsupp_ps_availqty#7371 AS cdepval_partsupp_ps_availqty_2#7385, cdepval_partsupp_ps_supplycost#7372 AS cdepval_partsupp_ps_supplycost_2#7386, cdepval_partsupp_ps_comment#7373 AS cdepval_partsupp_ps_comment_2#7387, cps_availqty#7374 AS cps_availqty_2#7388, cps_supplycost#7375 AS cps_supplycost_2#7389, cps_comment#7376 AS cps_comment_2#7390]
         :     :  :  +- Relation[rid#7363,cpfk_part_partsupp#7364,cfpk_partsupp_part#7365,cpfk_supplier_partsupp#7366,cfpk_partsupp_supplier#7367,cval_partsupp_ps_availqty#7368,cval_partsupp_ps_supplycost#7369,cval_partsupp_ps_comment#7370,cdepval_partsupp_ps_availqty#7371,cdepval_partsupp_ps_supplycost#7372,cdepval_partsupp_ps_comment#7373,cps_availqty#7374,cps_supplycost#7375,cps_comment#7376] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#7327 AS rid_1#7345, cpfk_nation_supplier#7328 AS cpfk_nation_supplier_1#7346, cfpk_supplier_nation#7329 AS cfpk_supplier_nation_1#7347, cval_supplier_s_name#7330 AS cval_supplier_s_name_1#7348, cval_supplier_s_address#7331 AS cval_supplier_s_address_1#7349, cval_supplier_s_phone#7332 AS cval_supplier_s_phone_1#7350, cval_supplier_s_acctbal#7333 AS cval_supplier_s_acctbal_1#7351, cval_supplier_s_comment#7334 AS cval_supplier_s_comment_1#7352, cdepval_supplier_s_name#7335 AS cdepval_supplier_s_name_1#7353, cdepval_supplier_s_address#7336 AS cdepval_supplier_s_address_1#7354, cdepval_supplier_s_phone#7337 AS cdepval_supplier_s_phone_1#7355, cdepval_supplier_s_acctbal#7338 AS cdepval_supplier_s_acctbal_1#7356, cdepval_supplier_s_comment#7339 AS cdepval_supplier_s_comment_1#7357, cs_name#7340 AS cs_name_1#7358, cs_address#7341 AS cs_address_1#7359, cs_phone#7342 AS cs_phone_1#7360, cs_acctbal#7343 AS cs_acctbal_1#7361, cs_comment#7344 AS cs_comment_1#7362]
         :     :     :  +- Relation[rid#7327,cpfk_nation_supplier#7328,cfpk_supplier_nation#7329,cval_supplier_s_name#7330,cval_supplier_s_address#7331,cval_supplier_s_phone#7332,cval_supplier_s_acctbal#7333,cval_supplier_s_comment#7334,cdepval_supplier_s_name#7335,cdepval_supplier_s_address#7336,cdepval_supplier_s_phone#7337,cdepval_supplier_s_acctbal#7338,cdepval_supplier_s_comment#7339,cs_name#7340,cs_address#7341,cs_phone#7342,cs_acctbal#7343,cs_comment#7344] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#7309 AS rid_0#7318, cpfk_region_nation#7310 AS cpfk_region_nation_0#7319, cfpk_nation_region#7311 AS cfpk_nation_region_0#7320, cval_nation_n_name#7312 AS cval_nation_n_name_0#7321, cval_nation_n_comment#7313 AS cval_nation_n_comment_0#7322, cdepval_nation_n_name#7314 AS cdepval_nation_n_name_0#7323, cdepval_nation_n_comment#7315 AS cdepval_nation_n_comment_0#7324, cn_name#7316 AS cn_name_0#7325, cn_comment#7317 AS cn_comment_0#7326]
         :     :        +- Relation[rid#7309,cpfk_region_nation#7310,cfpk_nation_region#7311,cval_nation_n_name#7312,cval_nation_n_comment#7313,cdepval_nation_n_name#7314,cdepval_nation_n_comment#7315,cn_name#7316,cn_comment#7317] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#7391 AS rid_3#7416, cval_part_p_name#7392 AS cval_part_p_name_3#7417, cval_part_p_mfgr#7393 AS cval_part_p_mfgr_3#7418, cval_part_p_type#7394 AS cval_part_p_type_3#7419, cval_part_p_size#7395 AS cval_part_p_size_3#7420, cval_part_p_container#7396 AS cval_part_p_container_3#7421, cval_part_p_retailprice#7397 AS cval_part_p_retailprice_3#7422, cval_part_p_comment#7398 AS cval_part_p_comment_3#7423, cval_part_p_brand#7399 AS cval_part_p_brand_3#7424, cdepval_part_p_name#7400 AS cdepval_part_p_name_3#7425, cdepval_part_p_mfgr#7401 AS cdepval_part_p_mfgr_3#7426, cdepval_part_p_type#7402 AS cdepval_part_p_type_3#7427, cdepval_part_p_size#7403 AS cdepval_part_p_size_3#7428, cdepval_part_p_container#7404 AS cdepval_part_p_container_3#7429, cdepval_part_p_retailprice#7405 AS cdepval_part_p_retailprice_3#7430, cdepval_part_p_comment#7406 AS cdepval_part_p_comment_3#7431, cdepval_part_p_brand#7407 AS cdepval_part_p_brand_3#7432, cp_name#7408 AS cp_name_3#7433, cp_mfgr#7409 AS cp_mfgr_3#7434, cp_type#7410 AS cp_type_3#7435, cp_size#7411 AS cp_size_3#7436, cp_container#7412 AS cp_container_3#7437, cp_retailprice#7413 AS cp_retailprice_3#7438, cp_comment#7414 AS cp_comment_3#7439, cp_brand#7415 AS cp_brand_3#7440]
         :        +- Relation[rid#7391,cval_part_p_name#7392,cval_part_p_mfgr#7393,cval_part_p_type#7394,cval_part_p_size#7395,cval_part_p_container#7396,cval_part_p_retailprice#7397,cval_part_p_comment#7398,cval_part_p_brand#7399,cdepval_part_p_name#7400,cdepval_part_p_mfgr#7401,cdepval_part_p_type#7402,cdepval_part_p_size#7403,cdepval_part_p_container#7404,cdepval_part_p_retailprice#7405,cdepval_part_p_comment#7406,cdepval_part_p_brand#7407,cp_name#7408,cp_mfgr#7409,cp_type#7410,cp_size#7411,cp_container#7412,cp_retailprice#7413,cp_comment#7414,cp_brand#7415] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#7531 AS rid_5#7555, cpfk_customer_orders#7532 AS cpfk_customer_orders_5#7556, cfpk_orders_customer#7533 AS cfpk_orders_customer_5#7557, cval_orders_o_orderstatus#7534 AS cval_orders_o_orderstatus_5#7558, cval_orders_o_totalprice#7535 AS cval_orders_o_totalprice_5#7559, cval_orders_o_orderpriority#7536 AS cval_orders_o_orderpriority_5#7560, cval_orders_o_clerk#7537 AS cval_orders_o_clerk_5#7561, cval_orders_o_shippriority#7538 AS cval_orders_o_shippriority_5#7562, cval_orders_o_comment#7539 AS cval_orders_o_comment_5#7563, cval_orders_o_orderdate#7540 AS cval_orders_o_orderdate_5#7564, cdepval_orders_o_orderstatus#7541 AS cdepval_orders_o_orderstatus_5#7565, cdepval_orders_o_totalprice#7542 AS cdepval_orders_o_totalprice_5#7566, cdepval_orders_o_orderpriority#7543 AS cdepval_orders_o_orderpriority_5#7567, cdepval_orders_o_clerk#7544 AS cdepval_orders_o_clerk_5#7568, cdepval_orders_o_shippriority#7545 AS cdepval_orders_o_shippriority_5#7569, cdepval_orders_o_comment#7546 AS cdepval_orders_o_comment_5#7570, cdepval_orders_o_orderdate#7547 AS cdepval_orders_o_orderdate_5#7571, co_orderstatus#7548 AS co_orderstatus_5#7572, co_totalprice#7549 AS co_totalprice_5#7573, co_orderpriority#7550 AS co_orderpriority_5#7574, co_clerk#7551 AS co_clerk_5#7575, co_shippriority#7552 AS co_shippriority_5#7576, co_comment#7553 AS co_comment_5#7577, co_orderdate#7554 AS co_orderdate_5#7578]
            +- Relation[rid#7531,cpfk_customer_orders#7532,cfpk_orders_customer#7533,cval_orders_o_orderstatus#7534,cval_orders_o_totalprice#7535,cval_orders_o_orderpriority#7536,cval_orders_o_clerk#7537,cval_orders_o_shippriority#7538,cval_orders_o_comment#7539,cval_orders_o_orderdate#7540,cdepval_orders_o_orderstatus#7541,cdepval_orders_o_totalprice#7542,cdepval_orders_o_orderpriority#7543,cdepval_orders_o_clerk#7544,cdepval_orders_o_shippriority#7545,cdepval_orders_o_comment#7546,cdepval_orders_o_orderdate#7547,co_orderstatus#7548,co_totalprice#7549,co_orderpriority#7550,co_clerk#7551,co_shippriority#7552,co_comment#7553,co_orderdate#7554] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 37940ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/25 21:59:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:59:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7719L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 21:59:33 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:59:33 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:59:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:59:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:59:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:59:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:59:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:59:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:59:33 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 21:59:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 21:59:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7719L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :  :- Project [rid#7821 AS rid_1#7835, cpfk_part_partsupp#7822 AS cpfk_part_partsupp_1#7836, cfpk_partsupp_part#7823 AS cfpk_partsupp_part_1#7837, cpfk_supplier_partsupp#7824 AS cpfk_supplier_partsupp_1#7838, cfpk_partsupp_supplier#7825 AS cfpk_partsupp_supplier_1#7839, cval_partsupp_ps_availqty#7826 AS cval_partsupp_ps_availqty_1#7840, cval_partsupp_ps_supplycost#7827 AS cval_partsupp_ps_supplycost_1#7841, cval_partsupp_ps_comment#7828 AS cval_partsupp_ps_comment_1#7842, cdepval_partsupp_ps_availqty#7829 AS cdepval_partsupp_ps_availqty_1#7843, cdepval_partsupp_ps_supplycost#7830 AS cdepval_partsupp_ps_supplycost_1#7844, cdepval_partsupp_ps_comment#7831 AS cdepval_partsupp_ps_comment_1#7845, cps_availqty#7832 AS cps_availqty_1#7846, cps_supplycost#7833 AS cps_supplycost_1#7847, cps_comment#7834 AS cps_comment_1#7848]
         :  :  +- Relation[rid#7821,cpfk_part_partsupp#7822,cfpk_partsupp_part#7823,cpfk_supplier_partsupp#7824,cfpk_partsupp_supplier#7825,cval_partsupp_ps_availqty#7826,cval_partsupp_ps_supplycost#7827,cval_partsupp_ps_comment#7828,cdepval_partsupp_ps_availqty#7829,cdepval_partsupp_ps_supplycost#7830,cdepval_partsupp_ps_comment#7831,cps_availqty#7832,cps_supplycost#7833,cps_comment#7834] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :     +- Project [rid#7721 AS rid_0#7746, cval_part_p_name#7722 AS cval_part_p_name_0#7747, cval_part_p_mfgr#7723 AS cval_part_p_mfgr_0#7748, cval_part_p_type#7724 AS cval_part_p_type_0#7749, cval_part_p_size#7725 AS cval_part_p_size_0#7750, cval_part_p_container#7726 AS cval_part_p_container_0#7751, cval_part_p_retailprice#7727 AS cval_part_p_retailprice_0#7752, cval_part_p_comment#7728 AS cval_part_p_comment_0#7753, cval_part_p_brand#7729 AS cval_part_p_brand_0#7754, cdepval_part_p_name#7730 AS cdepval_part_p_name_0#7755, cdepval_part_p_mfgr#7731 AS cdepval_part_p_mfgr_0#7756, cdepval_part_p_type#7732 AS cdepval_part_p_type_0#7757, cdepval_part_p_size#7733 AS cdepval_part_p_size_0#7758, cdepval_part_p_container#7734 AS cdepval_part_p_container_0#7759, cdepval_part_p_retailprice#7735 AS cdepval_part_p_retailprice_0#7760, cdepval_part_p_comment#7736 AS cdepval_part_p_comment_0#7761, cdepval_part_p_brand#7737 AS cdepval_part_p_brand_0#7762, cp_name#7738 AS cp_name_0#7763, cp_mfgr#7739 AS cp_mfgr_0#7764, cp_type#7740 AS cp_type_0#7765, cp_size#7741 AS cp_size_0#7766, cp_container#7742 AS cp_container_0#7767, cp_retailprice#7743 AS cp_retailprice_0#7768, cp_comment#7744 AS cp_comment_0#7769, cp_brand#7745 AS cp_brand_0#7770]
         :        +- Relation[rid#7721,cval_part_p_name#7722,cval_part_p_mfgr#7723,cval_part_p_type#7724,cval_part_p_size#7725,cval_part_p_container#7726,cval_part_p_retailprice#7727,cval_part_p_comment#7728,cval_part_p_brand#7729,cdepval_part_p_name#7730,cdepval_part_p_mfgr#7731,cdepval_part_p_type#7732,cdepval_part_p_size#7733,cdepval_part_p_container#7734,cdepval_part_p_retailprice#7735,cdepval_part_p_comment#7736,cdepval_part_p_brand#7737,cp_name#7738,cp_mfgr#7739,cp_type#7740,cp_size#7741,cp_container#7742,cp_retailprice#7743,cp_comment#7744,cp_brand#7745] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_2)
            :- Project [rid#7885 AS rid_3#7903, cpfk_nation_supplier#7886 AS cpfk_nation_supplier_3#7904, cfpk_supplier_nation#7887 AS cfpk_supplier_nation_3#7905, cval_supplier_s_name#7888 AS cval_supplier_s_name_3#7906, cval_supplier_s_address#7889 AS cval_supplier_s_address_3#7907, cval_supplier_s_phone#7890 AS cval_supplier_s_phone_3#7908, cval_supplier_s_acctbal#7891 AS cval_supplier_s_acctbal_3#7909, cval_supplier_s_comment#7892 AS cval_supplier_s_comment_3#7910, cdepval_supplier_s_name#7893 AS cdepval_supplier_s_name_3#7911, cdepval_supplier_s_address#7894 AS cdepval_supplier_s_address_3#7912, cdepval_supplier_s_phone#7895 AS cdepval_supplier_s_phone_3#7913, cdepval_supplier_s_acctbal#7896 AS cdepval_supplier_s_acctbal_3#7914, cdepval_supplier_s_comment#7897 AS cdepval_supplier_s_comment_3#7915, cs_name#7898 AS cs_name_3#7916, cs_address#7899 AS cs_address_3#7917, cs_phone#7900 AS cs_phone_3#7918, cs_acctbal#7901 AS cs_acctbal_3#7919, cs_comment#7902 AS cs_comment_3#7920]
            :  +- Relation[rid#7885,cpfk_nation_supplier#7886,cfpk_supplier_nation#7887,cval_supplier_s_name#7888,cval_supplier_s_address#7889,cval_supplier_s_phone#7890,cval_supplier_s_acctbal#7891,cval_supplier_s_comment#7892,cdepval_supplier_s_name#7893,cdepval_supplier_s_address#7894,cdepval_supplier_s_phone#7895,cdepval_supplier_s_acctbal#7896,cdepval_supplier_s_comment#7897,cs_name#7898,cs_address#7899,cs_phone#7900,cs_acctbal#7901,cs_comment#7902] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
               +- Project [rid#7849 AS rid_2#7858, cpfk_region_nation#7850 AS cpfk_region_nation_2#7859, cfpk_nation_region#7851 AS cfpk_nation_region_2#7860, cval_nation_n_name#7852 AS cval_nation_n_name_2#7861, cval_nation_n_comment#7853 AS cval_nation_n_comment_2#7862, cdepval_nation_n_name#7854 AS cdepval_nation_n_name_2#7863, cdepval_nation_n_comment#7855 AS cdepval_nation_n_comment_2#7864, cn_name#7856 AS cn_name_2#7865, cn_comment#7857 AS cn_comment_2#7866]
                  +- Relation[rid#7849,cpfk_region_nation#7850,cfpk_nation_region#7851,cval_nation_n_name#7852,cval_nation_n_comment#7853,cdepval_nation_n_name#7854,cdepval_nation_n_comment#7855,cn_name#7856,cn_comment#7857] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 3521ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/25 21:59:36 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 21:59:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7999L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 21:59:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:59:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 21:59:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7999L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#8001 AS rid_0#8046, cpfk_orders_lineitem#8002 AS cpfk_orders_lineitem_0#8047, cpfk_supplier_lineitem#8003 AS cpfk_supplier_lineitem_0#8048, cfpk_lineitem_supplier#8004 AS cfpk_lineitem_supplier_0#8049, cfpk_lineitem_partsupp#8005 AS cfpk_lineitem_partsupp_0#8050, cpfk_part_lineitem#8006 AS cpfk_part_lineitem_0#8051, cfpk_lineitem_part#8007 AS cfpk_lineitem_part_0#8052, cpfk_partsupp_lineitem#8008 AS cpfk_partsupp_lineitem_0#8053, cfpk_lineitem_orders#8009 AS cfpk_lineitem_orders_0#8054, cval_lineitem_l_quantity#8010 AS cval_lineitem_l_quantity_0#8055, cval_lineitem_l_extendedprice#8011 AS cval_lineitem_l_extendedprice_0#8056, cval_lineitem_l_discount#8012 AS cval_lineitem_l_discount_0#8057, cval_lineitem_l_tax#8013 AS cval_lineitem_l_tax_0#8058, cval_lineitem_l_returnflag#8014 AS cval_lineitem_l_returnflag_0#8059, cval_lineitem_l_linestatus#8015 AS cval_lineitem_l_linestatus_0#8060, cval_lineitem_l_commitdate#8016 AS cval_lineitem_l_commitdate_0#8061, cval_lineitem_l_receiptdate#8017 AS cval_lineitem_l_receiptdate_0#8062, cval_lineitem_l_shipinstruct#8018 AS cval_lineitem_l_shipinstruct_0#8063, cval_lineitem_l_shipmode#8019 AS cval_lineitem_l_shipmode_0#8064, cval_lineitem_l_comment#8020 AS cval_lineitem_l_comment_0#8065, cval_lineitem_l_shipdate#8021 AS cval_lineitem_l_shipdate_0#8066, cdepval_lineitem_l_quantity#8022 AS cdepval_lineitem_l_quantity_0#8067, cdepval_lineitem_l_extendedprice#8023 AS cdepval_lineitem_l_extendedprice_0#8068, cdepval_lineitem_l_discount#8024 AS cdepval_lineitem_l_discount_0#8069, ... 21 more fields]
         :  :  :     +- Relation[rid#8001,cpfk_orders_lineitem#8002,cpfk_supplier_lineitem#8003,cfpk_lineitem_supplier#8004,cfpk_lineitem_partsupp#8005,cpfk_part_lineitem#8006,cfpk_lineitem_part#8007,cpfk_partsupp_lineitem#8008,cfpk_lineitem_orders#8009,cval_lineitem_l_quantity#8010,cval_lineitem_l_extendedprice#8011,cval_lineitem_l_discount#8012,cval_lineitem_l_tax#8013,cval_lineitem_l_returnflag#8014,cval_lineitem_l_linestatus#8015,cval_lineitem_l_commitdate#8016,cval_lineitem_l_receiptdate#8017,cval_lineitem_l_shipinstruct#8018,cval_lineitem_l_shipmode#8019,cval_lineitem_l_comment#8020,cval_lineitem_l_shipdate#8021,cdepval_lineitem_l_quantity#8022,cdepval_lineitem_l_extendedprice#8023,cdepval_lineitem_l_discount#8024,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#8181 AS rid_1#8205, cpfk_customer_orders#8182 AS cpfk_customer_orders_1#8206, cfpk_orders_customer#8183 AS cfpk_orders_customer_1#8207, cval_orders_o_orderstatus#8184 AS cval_orders_o_orderstatus_1#8208, cval_orders_o_totalprice#8185 AS cval_orders_o_totalprice_1#8209, cval_orders_o_orderpriority#8186 AS cval_orders_o_orderpriority_1#8210, cval_orders_o_clerk#8187 AS cval_orders_o_clerk_1#8211, cval_orders_o_shippriority#8188 AS cval_orders_o_shippriority_1#8212, cval_orders_o_comment#8189 AS cval_orders_o_comment_1#8213, cval_orders_o_orderdate#8190 AS cval_orders_o_orderdate_1#8214, cdepval_orders_o_orderstatus#8191 AS cdepval_orders_o_orderstatus_1#8215, cdepval_orders_o_totalprice#8192 AS cdepval_orders_o_totalprice_1#8216, cdepval_orders_o_orderpriority#8193 AS cdepval_orders_o_orderpriority_1#8217, cdepval_orders_o_clerk#8194 AS cdepval_orders_o_clerk_1#8218, cdepval_orders_o_shippriority#8195 AS cdepval_orders_o_shippriority_1#8219, cdepval_orders_o_comment#8196 AS cdepval_orders_o_comment_1#8220, cdepval_orders_o_orderdate#8197 AS cdepval_orders_o_orderdate_1#8221, co_orderstatus#8198 AS co_orderstatus_1#8222, co_totalprice#8199 AS co_totalprice_1#8223, co_orderpriority#8200 AS co_orderpriority_1#8224, co_clerk#8201 AS co_clerk_1#8225, co_shippriority#8202 AS co_shippriority_1#8226, co_comment#8203 AS co_comment_1#8227, co_orderdate#8204 AS co_orderdate_1#8228]
         :  :     +- Relation[rid#8181,cpfk_customer_orders#8182,cfpk_orders_customer#8183,cval_orders_o_orderstatus#8184,cval_orders_o_totalprice#8185,cval_orders_o_orderpriority#8186,cval_orders_o_clerk#8187,cval_orders_o_shippriority#8188,cval_orders_o_comment#8189,cval_orders_o_orderdate#8190,cdepval_orders_o_orderstatus#8191,cdepval_orders_o_totalprice#8192,cdepval_orders_o_orderpriority#8193,cdepval_orders_o_clerk#8194,cdepval_orders_o_shippriority#8195,cdepval_orders_o_comment#8196,cdepval_orders_o_orderdate#8197,co_orderstatus#8198,co_totalprice#8199,co_orderpriority#8200,co_clerk#8201,co_shippriority#8202,co_comment#8203,co_orderdate#8204] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#8229 AS rid_2#8250, cpfk_nation_customer#8230 AS cpfk_nation_customer_2#8251, cfpk_customer_nation#8231 AS cfpk_customer_nation_2#8252, cval_customer_c_name#8232 AS cval_customer_c_name_2#8253, cval_customer_c_address#8233 AS cval_customer_c_address_2#8254, cval_customer_c_phone#8234 AS cval_customer_c_phone_2#8255, cval_customer_c_acctbal#8235 AS cval_customer_c_acctbal_2#8256, cval_customer_c_comment#8236 AS cval_customer_c_comment_2#8257, cval_customer_c_mktsegment#8237 AS cval_customer_c_mktsegment_2#8258, cdepval_customer_c_name#8238 AS cdepval_customer_c_name_2#8259, cdepval_customer_c_address#8239 AS cdepval_customer_c_address_2#8260, cdepval_customer_c_phone#8240 AS cdepval_customer_c_phone_2#8261, cdepval_customer_c_acctbal#8241 AS cdepval_customer_c_acctbal_2#8262, cdepval_customer_c_comment#8242 AS cdepval_customer_c_comment_2#8263, cdepval_customer_c_mktsegment#8243 AS cdepval_customer_c_mktsegment_2#8264, cc_name#8244 AS cc_name_2#8265, cc_address#8245 AS cc_address_2#8266, cc_phone#8246 AS cc_phone_2#8267, cc_acctbal#8247 AS cc_acctbal_2#8268, cc_comment#8248 AS cc_comment_2#8269, cc_mktsegment#8249 AS cc_mktsegment_2#8270]
         :     +- Relation[rid#8229,cpfk_nation_customer#8230,cfpk_customer_nation#8231,cval_customer_c_name#8232,cval_customer_c_address#8233,cval_customer_c_phone#8234,cval_customer_c_acctbal#8235,cval_customer_c_comment#8236,cval_customer_c_mktsegment#8237,cdepval_customer_c_name#8238,cdepval_customer_c_address#8239,cdepval_customer_c_phone#8240,cdepval_customer_c_acctbal#8241,cdepval_customer_c_comment#8242,cdepval_customer_c_mktsegment#8243,cc_name#8244,cc_address#8245,cc_phone#8246,cc_acctbal#8247,cc_comment#8248,cc_mktsegment#8249] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#8271 AS rid_3#8280, cpfk_region_nation#8272 AS cpfk_region_nation_3#8281, cfpk_nation_region#8273 AS cfpk_nation_region_3#8282, cval_nation_n_name#8274 AS cval_nation_n_name_3#8283, cval_nation_n_comment#8275 AS cval_nation_n_comment_3#8284, cdepval_nation_n_name#8276 AS cdepval_nation_n_name_3#8285, cdepval_nation_n_comment#8277 AS cdepval_nation_n_comment_3#8286, cn_name#8278 AS cn_name_3#8287, cn_comment#8279 AS cn_comment_3#8288]
            +- Relation[rid#8271,cpfk_region_nation#8272,cfpk_nation_region#8273,cval_nation_n_name#8274,cval_nation_n_comment#8275,cdepval_nation_n_name#8276,cdepval_nation_n_comment#8277,cn_name#8278,cn_comment#8279] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 78055ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/25 22:00:54 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:00:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8396L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:00:54 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:00:54 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:00:54 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:00:54 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:00:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8396L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#8530 AS rid_2#8575, cpfk_orders_lineitem#8531 AS cpfk_orders_lineitem_2#8576, cpfk_supplier_lineitem#8532 AS cpfk_supplier_lineitem_2#8577, cfpk_lineitem_supplier#8533 AS cfpk_lineitem_supplier_2#8578, cfpk_lineitem_partsupp#8534 AS cfpk_lineitem_partsupp_2#8579, cpfk_part_lineitem#8535 AS cpfk_part_lineitem_2#8580, cfpk_lineitem_part#8536 AS cfpk_lineitem_part_2#8581, cpfk_partsupp_lineitem#8537 AS cpfk_partsupp_lineitem_2#8582, cfpk_lineitem_orders#8538 AS cfpk_lineitem_orders_2#8583, cval_lineitem_l_quantity#8539 AS cval_lineitem_l_quantity_2#8584, cval_lineitem_l_extendedprice#8540 AS cval_lineitem_l_extendedprice_2#8585, cval_lineitem_l_discount#8541 AS cval_lineitem_l_discount_2#8586, cval_lineitem_l_tax#8542 AS cval_lineitem_l_tax_2#8587, cval_lineitem_l_returnflag#8543 AS cval_lineitem_l_returnflag_2#8588, cval_lineitem_l_linestatus#8544 AS cval_lineitem_l_linestatus_2#8589, cval_lineitem_l_commitdate#8545 AS cval_lineitem_l_commitdate_2#8590, cval_lineitem_l_receiptdate#8546 AS cval_lineitem_l_receiptdate_2#8591, cval_lineitem_l_shipinstruct#8547 AS cval_lineitem_l_shipinstruct_2#8592, cval_lineitem_l_shipmode#8548 AS cval_lineitem_l_shipmode_2#8593, cval_lineitem_l_comment#8549 AS cval_lineitem_l_comment_2#8594, cval_lineitem_l_shipdate#8550 AS cval_lineitem_l_shipdate_2#8595, cdepval_lineitem_l_quantity#8551 AS cdepval_lineitem_l_quantity_2#8596, cdepval_lineitem_l_extendedprice#8552 AS cdepval_lineitem_l_extendedprice_2#8597, cdepval_lineitem_l_discount#8553 AS cdepval_lineitem_l_discount_2#8598, ... 21 more fields]
         :  +- Relation[rid#8530,cpfk_orders_lineitem#8531,cpfk_supplier_lineitem#8532,cfpk_lineitem_supplier#8533,cfpk_lineitem_partsupp#8534,cpfk_part_lineitem#8535,cfpk_lineitem_part#8536,cpfk_partsupp_lineitem#8537,cfpk_lineitem_orders#8538,cval_lineitem_l_quantity#8539,cval_lineitem_l_extendedprice#8540,cval_lineitem_l_discount#8541,cval_lineitem_l_tax#8542,cval_lineitem_l_returnflag#8543,cval_lineitem_l_linestatus#8544,cval_lineitem_l_commitdate#8545,cval_lineitem_l_receiptdate#8546,cval_lineitem_l_shipinstruct#8547,cval_lineitem_l_shipmode#8548,cval_lineitem_l_comment#8549,cval_lineitem_l_shipdate#8550,cdepval_lineitem_l_quantity#8551,cdepval_lineitem_l_extendedprice#8552,cdepval_lineitem_l_discount#8553,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#8482 AS rid_1#8506, cpfk_customer_orders#8483 AS cpfk_customer_orders_1#8507, cfpk_orders_customer#8484 AS cfpk_orders_customer_1#8508, cval_orders_o_orderstatus#8485 AS cval_orders_o_orderstatus_1#8509, cval_orders_o_totalprice#8486 AS cval_orders_o_totalprice_1#8510, cval_orders_o_orderpriority#8487 AS cval_orders_o_orderpriority_1#8511, cval_orders_o_clerk#8488 AS cval_orders_o_clerk_1#8512, cval_orders_o_shippriority#8489 AS cval_orders_o_shippriority_1#8513, cval_orders_o_comment#8490 AS cval_orders_o_comment_1#8514, cval_orders_o_orderdate#8491 AS cval_orders_o_orderdate_1#8515, cdepval_orders_o_orderstatus#8492 AS cdepval_orders_o_orderstatus_1#8516, cdepval_orders_o_totalprice#8493 AS cdepval_orders_o_totalprice_1#8517, cdepval_orders_o_orderpriority#8494 AS cdepval_orders_o_orderpriority_1#8518, cdepval_orders_o_clerk#8495 AS cdepval_orders_o_clerk_1#8519, cdepval_orders_o_shippriority#8496 AS cdepval_orders_o_shippriority_1#8520, cdepval_orders_o_comment#8497 AS cdepval_orders_o_comment_1#8521, cdepval_orders_o_orderdate#8498 AS cdepval_orders_o_orderdate_1#8522, co_orderstatus#8499 AS co_orderstatus_1#8523, co_totalprice#8500 AS co_totalprice_1#8524, co_orderpriority#8501 AS co_orderpriority_1#8525, co_clerk#8502 AS co_clerk_1#8526, co_shippriority#8503 AS co_shippriority_1#8527, co_comment#8504 AS co_comment_1#8528, co_orderdate#8505 AS co_orderdate_1#8529]
            :  +- Relation[rid#8482,cpfk_customer_orders#8483,cfpk_orders_customer#8484,cval_orders_o_orderstatus#8485,cval_orders_o_totalprice#8486,cval_orders_o_orderpriority#8487,cval_orders_o_clerk#8488,cval_orders_o_shippriority#8489,cval_orders_o_comment#8490,cval_orders_o_orderdate#8491,cdepval_orders_o_orderstatus#8492,cdepval_orders_o_totalprice#8493,cdepval_orders_o_orderpriority#8494,cdepval_orders_o_clerk#8495,cdepval_orders_o_shippriority#8496,cdepval_orders_o_comment#8497,cdepval_orders_o_orderdate#8498,co_orderstatus#8499,co_totalprice#8500,co_orderpriority#8501,co_clerk#8502,co_shippriority#8503,co_comment#8504,co_orderdate#8505] JDBCRelation(torders) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
               +- Project [rid#8398 AS rid_0#8419, cpfk_nation_customer#8399 AS cpfk_nation_customer_0#8420, cfpk_customer_nation#8400 AS cfpk_customer_nation_0#8421, cval_customer_c_name#8401 AS cval_customer_c_name_0#8422, cval_customer_c_address#8402 AS cval_customer_c_address_0#8423, cval_customer_c_phone#8403 AS cval_customer_c_phone_0#8424, cval_customer_c_acctbal#8404 AS cval_customer_c_acctbal_0#8425, cval_customer_c_comment#8405 AS cval_customer_c_comment_0#8426, cval_customer_c_mktsegment#8406 AS cval_customer_c_mktsegment_0#8427, cdepval_customer_c_name#8407 AS cdepval_customer_c_name_0#8428, cdepval_customer_c_address#8408 AS cdepval_customer_c_address_0#8429, cdepval_customer_c_phone#8409 AS cdepval_customer_c_phone_0#8430, cdepval_customer_c_acctbal#8410 AS cdepval_customer_c_acctbal_0#8431, cdepval_customer_c_comment#8411 AS cdepval_customer_c_comment_0#8432, cdepval_customer_c_mktsegment#8412 AS cdepval_customer_c_mktsegment_0#8433, cc_name#8413 AS cc_name_0#8434, cc_address#8414 AS cc_address_0#8435, cc_phone#8415 AS cc_phone_0#8436, cc_acctbal#8416 AS cc_acctbal_0#8437, cc_comment#8417 AS cc_comment_0#8438, cc_mktsegment#8418 AS cc_mktsegment_0#8439]
                  +- Relation[rid#8398,cpfk_nation_customer#8399,cfpk_customer_nation#8400,cval_customer_c_name#8401,cval_customer_c_address#8402,cval_customer_c_phone#8403,cval_customer_c_acctbal#8404,cval_customer_c_comment#8405,cval_customer_c_mktsegment#8406,cdepval_customer_c_name#8407,cdepval_customer_c_address#8408,cdepval_customer_c_phone#8409,cdepval_customer_c_acctbal#8410,cdepval_customer_c_comment#8411,cdepval_customer_c_mktsegment#8412,cc_name#8413,cc_address#8414,cc_phone#8415,cc_acctbal#8416,cc_comment#8417,cc_mktsegment#8418] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 39201ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/25 22:01:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:01:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8719L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:01:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8719L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#8811 AS rid_2#8856, cpfk_orders_lineitem#8812 AS cpfk_orders_lineitem_2#8857, cpfk_supplier_lineitem#8813 AS cpfk_supplier_lineitem_2#8858, cfpk_lineitem_supplier#8814 AS cfpk_lineitem_supplier_2#8859, cfpk_lineitem_partsupp#8815 AS cfpk_lineitem_partsupp_2#8860, cpfk_part_lineitem#8816 AS cpfk_part_lineitem_2#8861, cfpk_lineitem_part#8817 AS cfpk_lineitem_part_2#8862, cpfk_partsupp_lineitem#8818 AS cpfk_partsupp_lineitem_2#8863, cfpk_lineitem_orders#8819 AS cfpk_lineitem_orders_2#8864, cval_lineitem_l_quantity#8820 AS cval_lineitem_l_quantity_2#8865, cval_lineitem_l_extendedprice#8821 AS cval_lineitem_l_extendedprice_2#8866, cval_lineitem_l_discount#8822 AS cval_lineitem_l_discount_2#8867, cval_lineitem_l_tax#8823 AS cval_lineitem_l_tax_2#8868, cval_lineitem_l_returnflag#8824 AS cval_lineitem_l_returnflag_2#8869, cval_lineitem_l_linestatus#8825 AS cval_lineitem_l_linestatus_2#8870, cval_lineitem_l_commitdate#8826 AS cval_lineitem_l_commitdate_2#8871, cval_lineitem_l_receiptdate#8827 AS cval_lineitem_l_receiptdate_2#8872, cval_lineitem_l_shipinstruct#8828 AS cval_lineitem_l_shipinstruct_2#8873, cval_lineitem_l_shipmode#8829 AS cval_lineitem_l_shipmode_2#8874, cval_lineitem_l_comment#8830 AS cval_lineitem_l_comment_2#8875, cval_lineitem_l_shipdate#8831 AS cval_lineitem_l_shipdate_2#8876, cdepval_lineitem_l_quantity#8832 AS cdepval_lineitem_l_quantity_2#8877, cdepval_lineitem_l_extendedprice#8833 AS cdepval_lineitem_l_extendedprice_2#8878, cdepval_lineitem_l_discount#8834 AS cdepval_lineitem_l_discount_2#8879, ... 21 more fields]
         :  +- Relation[rid#8811,cpfk_orders_lineitem#8812,cpfk_supplier_lineitem#8813,cfpk_lineitem_supplier#8814,cfpk_lineitem_partsupp#8815,cpfk_part_lineitem#8816,cfpk_lineitem_part#8817,cpfk_partsupp_lineitem#8818,cfpk_lineitem_orders#8819,cval_lineitem_l_quantity#8820,cval_lineitem_l_extendedprice#8821,cval_lineitem_l_discount#8822,cval_lineitem_l_tax#8823,cval_lineitem_l_returnflag#8824,cval_lineitem_l_linestatus#8825,cval_lineitem_l_commitdate#8826,cval_lineitem_l_receiptdate#8827,cval_lineitem_l_shipinstruct#8828,cval_lineitem_l_shipmode#8829,cval_lineitem_l_comment#8830,cval_lineitem_l_shipdate#8831,cdepval_lineitem_l_quantity#8832,cdepval_lineitem_l_extendedprice#8833,cdepval_lineitem_l_discount#8834,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#8763 AS rid_1#8787, cpfk_customer_orders#8764 AS cpfk_customer_orders_1#8788, cfpk_orders_customer#8765 AS cfpk_orders_customer_1#8789, cval_orders_o_orderstatus#8766 AS cval_orders_o_orderstatus_1#8790, cval_orders_o_totalprice#8767 AS cval_orders_o_totalprice_1#8791, cval_orders_o_orderpriority#8768 AS cval_orders_o_orderpriority_1#8792, cval_orders_o_clerk#8769 AS cval_orders_o_clerk_1#8793, cval_orders_o_shippriority#8770 AS cval_orders_o_shippriority_1#8794, cval_orders_o_comment#8771 AS cval_orders_o_comment_1#8795, cval_orders_o_orderdate#8772 AS cval_orders_o_orderdate_1#8796, cdepval_orders_o_orderstatus#8773 AS cdepval_orders_o_orderstatus_1#8797, cdepval_orders_o_totalprice#8774 AS cdepval_orders_o_totalprice_1#8798, cdepval_orders_o_orderpriority#8775 AS cdepval_orders_o_orderpriority_1#8799, cdepval_orders_o_clerk#8776 AS cdepval_orders_o_clerk_1#8800, cdepval_orders_o_shippriority#8777 AS cdepval_orders_o_shippriority_1#8801, cdepval_orders_o_comment#8778 AS cdepval_orders_o_comment_1#8802, cdepval_orders_o_orderdate#8779 AS cdepval_orders_o_orderdate_1#8803, co_orderstatus#8780 AS co_orderstatus_1#8804, co_totalprice#8781 AS co_totalprice_1#8805, co_orderpriority#8782 AS co_orderpriority_1#8806, co_clerk#8783 AS co_clerk_1#8807, co_shippriority#8784 AS co_shippriority_1#8808, co_comment#8785 AS co_comment_1#8809, co_orderdate#8786 AS co_orderdate_1#8810]
            :  +- Relation[rid#8763,cpfk_customer_orders#8764,cfpk_orders_customer#8765,cval_orders_o_orderstatus#8766,cval_orders_o_totalprice#8767,cval_orders_o_orderpriority#8768,cval_orders_o_clerk#8769,cval_orders_o_shippriority#8770,cval_orders_o_comment#8771,cval_orders_o_orderdate#8772,cdepval_orders_o_orderstatus#8773,cdepval_orders_o_totalprice#8774,cdepval_orders_o_orderpriority#8775,cdepval_orders_o_clerk#8776,cdepval_orders_o_shippriority#8777,cdepval_orders_o_comment#8778,cdepval_orders_o_orderdate#8779,co_orderstatus#8780,co_totalprice#8781,co_orderpriority#8782,co_clerk#8783,co_shippriority#8784,co_comment#8785,co_orderdate#8786] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#8721 AS rid_0#8742, cpfk_nation_customer#8722 AS cpfk_nation_customer_0#8743, cfpk_customer_nation#8723 AS cfpk_customer_nation_0#8744, cval_customer_c_name#8724 AS cval_customer_c_name_0#8745, cval_customer_c_address#8725 AS cval_customer_c_address_0#8746, cval_customer_c_phone#8726 AS cval_customer_c_phone_0#8747, cval_customer_c_acctbal#8727 AS cval_customer_c_acctbal_0#8748, cval_customer_c_comment#8728 AS cval_customer_c_comment_0#8749, cval_customer_c_mktsegment#8729 AS cval_customer_c_mktsegment_0#8750, cdepval_customer_c_name#8730 AS cdepval_customer_c_name_0#8751, cdepval_customer_c_address#8731 AS cdepval_customer_c_address_0#8752, cdepval_customer_c_phone#8732 AS cdepval_customer_c_phone_0#8753, cdepval_customer_c_acctbal#8733 AS cdepval_customer_c_acctbal_0#8754, cdepval_customer_c_comment#8734 AS cdepval_customer_c_comment_0#8755, cdepval_customer_c_mktsegment#8735 AS cdepval_customer_c_mktsegment_0#8756, cc_name#8736 AS cc_name_0#8757, cc_address#8737 AS cc_address_0#8758, cc_phone#8738 AS cc_phone_0#8759, cc_acctbal#8739 AS cc_acctbal_0#8760, cc_comment#8740 AS cc_comment_0#8761, cc_mktsegment#8741 AS cc_mktsegment_0#8762]
               +- Relation[rid#8721,cpfk_nation_customer#8722,cfpk_customer_nation#8723,cval_customer_c_name#8724,cval_customer_c_address#8725,cval_customer_c_phone#8726,cval_customer_c_acctbal#8727,cval_customer_c_comment#8728,cval_customer_c_mktsegment#8729,cdepval_customer_c_name#8730,cdepval_customer_c_address#8731,cdepval_customer_c_phone#8732,cdepval_customer_c_acctbal#8733,cdepval_customer_c_comment#8734,cdepval_customer_c_mktsegment#8735,cc_name#8736,cc_address#8737,cc_phone#8738,cc_acctbal#8739,cc_comment#8740,cc_mktsegment#8741] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 21987ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/25 22:01:55 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:01:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8996L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:01:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#8996L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#8998 AS rid_0#9043, cpfk_orders_lineitem#8999 AS cpfk_orders_lineitem_0#9044, cpfk_supplier_lineitem#9000 AS cpfk_supplier_lineitem_0#9045, cfpk_lineitem_supplier#9001 AS cfpk_lineitem_supplier_0#9046, cfpk_lineitem_partsupp#9002 AS cfpk_lineitem_partsupp_0#9047, cpfk_part_lineitem#9003 AS cpfk_part_lineitem_0#9048, cfpk_lineitem_part#9004 AS cfpk_lineitem_part_0#9049, cpfk_partsupp_lineitem#9005 AS cpfk_partsupp_lineitem_0#9050, cfpk_lineitem_orders#9006 AS cfpk_lineitem_orders_0#9051, cval_lineitem_l_quantity#9007 AS cval_lineitem_l_quantity_0#9052, cval_lineitem_l_extendedprice#9008 AS cval_lineitem_l_extendedprice_0#9053, cval_lineitem_l_discount#9009 AS cval_lineitem_l_discount_0#9054, cval_lineitem_l_tax#9010 AS cval_lineitem_l_tax_0#9055, cval_lineitem_l_returnflag#9011 AS cval_lineitem_l_returnflag_0#9056, cval_lineitem_l_linestatus#9012 AS cval_lineitem_l_linestatus_0#9057, cval_lineitem_l_commitdate#9013 AS cval_lineitem_l_commitdate_0#9058, cval_lineitem_l_receiptdate#9014 AS cval_lineitem_l_receiptdate_0#9059, cval_lineitem_l_shipinstruct#9015 AS cval_lineitem_l_shipinstruct_0#9060, cval_lineitem_l_shipmode#9016 AS cval_lineitem_l_shipmode_0#9061, cval_lineitem_l_comment#9017 AS cval_lineitem_l_comment_0#9062, cval_lineitem_l_shipdate#9018 AS cval_lineitem_l_shipdate_0#9063, cdepval_lineitem_l_quantity#9019 AS cdepval_lineitem_l_quantity_0#9064, cdepval_lineitem_l_extendedprice#9020 AS cdepval_lineitem_l_extendedprice_0#9065, cdepval_lineitem_l_discount#9021 AS cdepval_lineitem_l_discount_0#9066, ... 21 more fields]
         +- Relation[rid#8998,cpfk_orders_lineitem#8999,cpfk_supplier_lineitem#9000,cfpk_lineitem_supplier#9001,cfpk_lineitem_partsupp#9002,cpfk_part_lineitem#9003,cfpk_lineitem_part#9004,cpfk_partsupp_lineitem#9005,cfpk_lineitem_orders#9006,cval_lineitem_l_quantity#9007,cval_lineitem_l_extendedprice#9008,cval_lineitem_l_discount#9009,cval_lineitem_l_tax#9010,cval_lineitem_l_returnflag#9011,cval_lineitem_l_linestatus#9012,cval_lineitem_l_commitdate#9013,cval_lineitem_l_receiptdate#9014,cval_lineitem_l_shipinstruct#9015,cval_lineitem_l_shipmode#9016,cval_lineitem_l_comment#9017,cval_lineitem_l_shipdate#9018,cdepval_lineitem_l_quantity#9019,cdepval_lineitem_l_extendedprice#9020,cdepval_lineitem_l_discount#9021,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2439ms
query=q1, count=6001215, duration=2439
query=q10, count=1478870, duration=78055
query=q11, count=31680, duration=3678
query=q12, count=857401, duration=21971
query=q13, count=1500000, duration=4294
query=q14, count=6001215, duration=20155
query=q15, count=6001215, duration=17036
query=q16, count=15780, duration=3317
query=q17, count=6088, duration=25809
query=q18, count=6001215, duration=21987
query=q19, count=205, duration=18506
query=q2, count=3162, duration=3672
query=q20, count=632, duration=3521
query=q21a, count=597422, duration=80707
query=q22, count=1500000, duration=4299
query=q3, count=1214743, duration=39201
query=q4, count=6001215, duration=18737
query=q5, count=48089, duration=31278
query=q6, count=6001215, duration=2497
query=q7, count=9735, duration=34780
query=q8, count=8716, duration=45064
query=q9a, count=6001215, duration=64125
query=q9b, count=6001215, duration=37940
