20/04/26 21:09:56 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10604ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sun Apr 26 21:09:59 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sun Apr 26 21:10:01 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sun Apr 26 21:10:01 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sun Apr 26 21:10:01 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sun Apr 26 21:10:01 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sun Apr 26 21:10:05 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sun Apr 26 21:10:08 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sun Apr 26 21:10:08 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 21:10:10 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:10:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2083L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:10:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:10:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:10:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:10:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:10:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:10:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:10:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:10:11 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/26 21:10:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2083L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#2139 AS rid_2#2184, cpfk_orders_lineitem#2140 AS cpfk_orders_lineitem_2#2185, cpfk_supplier_lineitem#2141 AS cpfk_supplier_lineitem_2#2186, cfpk_lineitem_supplier#2142 AS cfpk_lineitem_supplier_2#2187, cfpk_lineitem_partsupp#2143 AS cfpk_lineitem_partsupp_2#2188, cpfk_part_lineitem#2144 AS cpfk_part_lineitem_2#2189, cfpk_lineitem_part#2145 AS cfpk_lineitem_part_2#2190, cpfk_partsupp_lineitem#2146 AS cpfk_partsupp_lineitem_2#2191, cfpk_lineitem_orders#2147 AS cfpk_lineitem_orders_2#2192, cval_lineitem_l_quantity#2148 AS cval_lineitem_l_quantity_2#2193, cval_lineitem_l_extendedprice#2149 AS cval_lineitem_l_extendedprice_2#2194, cval_lineitem_l_discount#2150 AS cval_lineitem_l_discount_2#2195, cval_lineitem_l_tax#2151 AS cval_lineitem_l_tax_2#2196, cval_lineitem_l_returnflag#2152 AS cval_lineitem_l_returnflag_2#2197, cval_lineitem_l_linestatus#2153 AS cval_lineitem_l_linestatus_2#2198, cval_lineitem_l_commitdate#2154 AS cval_lineitem_l_commitdate_2#2199, cval_lineitem_l_receiptdate#2155 AS cval_lineitem_l_receiptdate_2#2200, cval_lineitem_l_shipinstruct#2156 AS cval_lineitem_l_shipinstruct_2#2201, cval_lineitem_l_shipmode#2157 AS cval_lineitem_l_shipmode_2#2202, cval_lineitem_l_comment#2158 AS cval_lineitem_l_comment_2#2203, cval_lineitem_l_shipdate#2159 AS cval_lineitem_l_shipdate_2#2204, cdepval_lineitem_l_quantity#2160 AS cdepval_lineitem_l_quantity_2#2205, cdepval_lineitem_l_extendedprice#2161 AS cdepval_lineitem_l_extendedprice_2#2206, cdepval_lineitem_l_discount#2162 AS cdepval_lineitem_l_discount_2#2207, ... 21 more fields]
         :  :  :  :  +- Relation[rid#2139,cpfk_orders_lineitem#2140,cpfk_supplier_lineitem#2141,cfpk_lineitem_supplier#2142,cfpk_lineitem_partsupp#2143,cpfk_part_lineitem#2144,cfpk_lineitem_part#2145,cpfk_partsupp_lineitem#2146,cfpk_lineitem_orders#2147,cval_lineitem_l_quantity#2148,cval_lineitem_l_extendedprice#2149,cval_lineitem_l_discount#2150,cval_lineitem_l_tax#2151,cval_lineitem_l_returnflag#2152,cval_lineitem_l_linestatus#2153,cval_lineitem_l_commitdate#2154,cval_lineitem_l_receiptdate#2155,cval_lineitem_l_shipinstruct#2156,cval_lineitem_l_shipmode#2157,cval_lineitem_l_comment#2158,cval_lineitem_l_shipdate#2159,cdepval_lineitem_l_quantity#2160,cdepval_lineitem_l_extendedprice#2161,cdepval_lineitem_l_discount#2162,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#2103 AS rid_1#2121, cpfk_nation_supplier#2104 AS cpfk_nation_supplier_1#2122, cfpk_supplier_nation#2105 AS cfpk_supplier_nation_1#2123, cval_supplier_s_name#2106 AS cval_supplier_s_name_1#2124, cval_supplier_s_address#2107 AS cval_supplier_s_address_1#2125, cval_supplier_s_phone#2108 AS cval_supplier_s_phone_1#2126, cval_supplier_s_acctbal#2109 AS cval_supplier_s_acctbal_1#2127, cval_supplier_s_comment#2110 AS cval_supplier_s_comment_1#2128, cdepval_supplier_s_name#2111 AS cdepval_supplier_s_name_1#2129, cdepval_supplier_s_address#2112 AS cdepval_supplier_s_address_1#2130, cdepval_supplier_s_phone#2113 AS cdepval_supplier_s_phone_1#2131, cdepval_supplier_s_acctbal#2114 AS cdepval_supplier_s_acctbal_1#2132, cdepval_supplier_s_comment#2115 AS cdepval_supplier_s_comment_1#2133, cs_name#2116 AS cs_name_1#2134, cs_address#2117 AS cs_address_1#2135, cs_phone#2118 AS cs_phone_1#2136, cs_acctbal#2119 AS cs_acctbal_1#2137, cs_comment#2120 AS cs_comment_1#2138]
         :  :  :     :  +- Relation[rid#2103,cpfk_nation_supplier#2104,cfpk_supplier_nation#2105,cval_supplier_s_name#2106,cval_supplier_s_address#2107,cval_supplier_s_phone#2108,cval_supplier_s_acctbal#2109,cval_supplier_s_comment#2110,cdepval_supplier_s_name#2111,cdepval_supplier_s_address#2112,cdepval_supplier_s_phone#2113,cdepval_supplier_s_acctbal#2114,cdepval_supplier_s_comment#2115,cs_name#2116,cs_address#2117,cs_phone#2118,cs_acctbal#2119,cs_comment#2120] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#2085 AS rid_0#2094, cpfk_region_nation#2086 AS cpfk_region_nation_0#2095, cfpk_nation_region#2087 AS cfpk_nation_region_0#2096, cval_nation_n_name#2088 AS cval_nation_n_name_0#2097, cval_nation_n_comment#2089 AS cval_nation_n_comment_0#2098, cdepval_nation_n_name#2090 AS cdepval_nation_n_name_0#2099, cdepval_nation_n_comment#2091 AS cdepval_nation_n_comment_0#2100, cn_name#2092 AS cn_name_0#2101, cn_comment#2093 AS cn_comment_0#2102]
         :  :  :        +- Relation[rid#2085,cpfk_region_nation#2086,cfpk_nation_region#2087,cval_nation_n_name#2088,cval_nation_n_comment#2089,cdepval_nation_n_name#2090,cdepval_nation_n_comment#2091,cn_name#2092,cn_comment#2093] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#2229 AS rid_3#2254, cval_part_p_name#2230 AS cval_part_p_name_3#2255, cval_part_p_mfgr#2231 AS cval_part_p_mfgr_3#2256, cval_part_p_type#2232 AS cval_part_p_type_3#2257, cval_part_p_size#2233 AS cval_part_p_size_3#2258, cval_part_p_container#2234 AS cval_part_p_container_3#2259, cval_part_p_retailprice#2235 AS cval_part_p_retailprice_3#2260, cval_part_p_comment#2236 AS cval_part_p_comment_3#2261, cval_part_p_brand#2237 AS cval_part_p_brand_3#2262, cdepval_part_p_name#2238 AS cdepval_part_p_name_3#2263, cdepval_part_p_mfgr#2239 AS cdepval_part_p_mfgr_3#2264, cdepval_part_p_type#2240 AS cdepval_part_p_type_3#2265, cdepval_part_p_size#2241 AS cdepval_part_p_size_3#2266, cdepval_part_p_container#2242 AS cdepval_part_p_container_3#2267, cdepval_part_p_retailprice#2243 AS cdepval_part_p_retailprice_3#2268, cdepval_part_p_comment#2244 AS cdepval_part_p_comment_3#2269, cdepval_part_p_brand#2245 AS cdepval_part_p_brand_3#2270, cp_name#2246 AS cp_name_3#2271, cp_mfgr#2247 AS cp_mfgr_3#2272, cp_type#2248 AS cp_type_3#2273, cp_size#2249 AS cp_size_3#2274, cp_container#2250 AS cp_container_3#2275, cp_retailprice#2251 AS cp_retailprice_3#2276, cp_comment#2252 AS cp_comment_3#2277, cp_brand#2253 AS cp_brand_3#2278]
         :  :     +- Relation[rid#2229,cval_part_p_name#2230,cval_part_p_mfgr#2231,cval_part_p_type#2232,cval_part_p_size#2233,cval_part_p_container#2234,cval_part_p_retailprice#2235,cval_part_p_comment#2236,cval_part_p_brand#2237,cdepval_part_p_name#2238,cdepval_part_p_mfgr#2239,cdepval_part_p_type#2240,cdepval_part_p_size#2241,cdepval_part_p_container#2242,cdepval_part_p_retailprice#2243,cdepval_part_p_comment#2244,cdepval_part_p_brand#2245,cp_name#2246,cp_mfgr#2247,cp_type#2248,cp_size#2249,cp_container#2250,cp_retailprice#2251,cp_comment#2252,cp_brand#2253] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#2279 AS rid_4#2293, cpfk_part_partsupp#2280 AS cpfk_part_partsupp_4#2294, cfpk_partsupp_part#2281 AS cfpk_partsupp_part_4#2295, cpfk_supplier_partsupp#2282 AS cpfk_supplier_partsupp_4#2296, cfpk_partsupp_supplier#2283 AS cfpk_partsupp_supplier_4#2297, cval_partsupp_ps_availqty#2284 AS cval_partsupp_ps_availqty_4#2298, cval_partsupp_ps_supplycost#2285 AS cval_partsupp_ps_supplycost_4#2299, cval_partsupp_ps_comment#2286 AS cval_partsupp_ps_comment_4#2300, cdepval_partsupp_ps_availqty#2287 AS cdepval_partsupp_ps_availqty_4#2301, cdepval_partsupp_ps_supplycost#2288 AS cdepval_partsupp_ps_supplycost_4#2302, cdepval_partsupp_ps_comment#2289 AS cdepval_partsupp_ps_comment_4#2303, cps_availqty#2290 AS cps_availqty_4#2304, cps_supplycost#2291 AS cps_supplycost_4#2305, cps_comment#2292 AS cps_comment_4#2306]
         :     +- Relation[rid#2279,cpfk_part_partsupp#2280,cfpk_partsupp_part#2281,cpfk_supplier_partsupp#2282,cfpk_partsupp_supplier#2283,cval_partsupp_ps_availqty#2284,cval_partsupp_ps_supplycost#2285,cval_partsupp_ps_comment#2286,cdepval_partsupp_ps_availqty#2287,cdepval_partsupp_ps_supplycost#2288,cdepval_partsupp_ps_comment#2289,cps_availqty#2290,cps_supplycost#2291,cps_comment#2292] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#2307 AS rid_5#2331, cpfk_customer_orders#2308 AS cpfk_customer_orders_5#2332, cfpk_orders_customer#2309 AS cfpk_orders_customer_5#2333, cval_orders_o_orderstatus#2310 AS cval_orders_o_orderstatus_5#2334, cval_orders_o_totalprice#2311 AS cval_orders_o_totalprice_5#2335, cval_orders_o_orderpriority#2312 AS cval_orders_o_orderpriority_5#2336, cval_orders_o_clerk#2313 AS cval_orders_o_clerk_5#2337, cval_orders_o_shippriority#2314 AS cval_orders_o_shippriority_5#2338, cval_orders_o_comment#2315 AS cval_orders_o_comment_5#2339, cval_orders_o_orderdate#2316 AS cval_orders_o_orderdate_5#2340, cdepval_orders_o_orderstatus#2317 AS cdepval_orders_o_orderstatus_5#2341, cdepval_orders_o_totalprice#2318 AS cdepval_orders_o_totalprice_5#2342, cdepval_orders_o_orderpriority#2319 AS cdepval_orders_o_orderpriority_5#2343, cdepval_orders_o_clerk#2320 AS cdepval_orders_o_clerk_5#2344, cdepval_orders_o_shippriority#2321 AS cdepval_orders_o_shippriority_5#2345, cdepval_orders_o_comment#2322 AS cdepval_orders_o_comment_5#2346, cdepval_orders_o_orderdate#2323 AS cdepval_orders_o_orderdate_5#2347, co_orderstatus#2324 AS co_orderstatus_5#2348, co_totalprice#2325 AS co_totalprice_5#2349, co_orderpriority#2326 AS co_orderpriority_5#2350, co_clerk#2327 AS co_clerk_5#2351, co_shippriority#2328 AS co_shippriority_5#2352, co_comment#2329 AS co_comment_5#2353, co_orderdate#2330 AS co_orderdate_5#2354]
            +- Relation[rid#2307,cpfk_customer_orders#2308,cfpk_orders_customer#2309,cval_orders_o_orderstatus#2310,cval_orders_o_totalprice#2311,cval_orders_o_orderpriority#2312,cval_orders_o_clerk#2313,cval_orders_o_shippriority#2314,cval_orders_o_comment#2315,cval_orders_o_orderdate#2316,cdepval_orders_o_orderstatus#2317,cdepval_orders_o_totalprice#2318,cdepval_orders_o_orderpriority#2319,cdepval_orders_o_clerk#2320,cdepval_orders_o_shippriority#2321,cdepval_orders_o_comment#2322,cdepval_orders_o_orderdate#2323,co_orderstatus#2324,co_totalprice#2325,co_orderpriority#2326,co_clerk#2327,co_shippriority#2328,co_comment#2329,co_orderdate#2330] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 90276ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/26 21:11:40 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:11:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2495L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 21:11:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2495L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#2497 AS rid_0#2521, cpfk_customer_orders#2498 AS cpfk_customer_orders_0#2522, cfpk_orders_customer#2499 AS cfpk_orders_customer_0#2523, cval_orders_o_orderstatus#2500 AS cval_orders_o_orderstatus_0#2524, cval_orders_o_totalprice#2501 AS cval_orders_o_totalprice_0#2525, cval_orders_o_orderpriority#2502 AS cval_orders_o_orderpriority_0#2526, cval_orders_o_clerk#2503 AS cval_orders_o_clerk_0#2527, cval_orders_o_shippriority#2504 AS cval_orders_o_shippriority_0#2528, cval_orders_o_comment#2505 AS cval_orders_o_comment_0#2529, cval_orders_o_orderdate#2506 AS cval_orders_o_orderdate_0#2530, cdepval_orders_o_orderstatus#2507 AS cdepval_orders_o_orderstatus_0#2531, cdepval_orders_o_totalprice#2508 AS cdepval_orders_o_totalprice_0#2532, cdepval_orders_o_orderpriority#2509 AS cdepval_orders_o_orderpriority_0#2533, cdepval_orders_o_clerk#2510 AS cdepval_orders_o_clerk_0#2534, cdepval_orders_o_shippriority#2511 AS cdepval_orders_o_shippriority_0#2535, cdepval_orders_o_comment#2512 AS cdepval_orders_o_comment_0#2536, cdepval_orders_o_orderdate#2513 AS cdepval_orders_o_orderdate_0#2537, co_orderstatus#2514 AS co_orderstatus_0#2538, co_totalprice#2515 AS co_totalprice_0#2539, co_orderpriority#2516 AS co_orderpriority_0#2540, co_clerk#2517 AS co_clerk_0#2541, co_shippriority#2518 AS co_shippriority_0#2542, co_comment#2519 AS co_comment_0#2543, co_orderdate#2520 AS co_orderdate_0#2544]
         :  +- Relation[rid#2497,cpfk_customer_orders#2498,cfpk_orders_customer#2499,cval_orders_o_orderstatus#2500,cval_orders_o_totalprice#2501,cval_orders_o_orderpriority#2502,cval_orders_o_clerk#2503,cval_orders_o_shippriority#2504,cval_orders_o_comment#2505,cval_orders_o_orderdate#2506,cdepval_orders_o_orderstatus#2507,cdepval_orders_o_totalprice#2508,cdepval_orders_o_orderpriority#2509,cdepval_orders_o_clerk#2510,cdepval_orders_o_shippriority#2511,cdepval_orders_o_comment#2512,cdepval_orders_o_orderdate#2513,co_orderstatus#2514,co_totalprice#2515,co_orderpriority#2516,co_clerk#2517,co_shippriority#2518,co_comment#2519,co_orderdate#2520] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#2545 AS rid_1#2566, cpfk_nation_customer#2546 AS cpfk_nation_customer_1#2567, cfpk_customer_nation#2547 AS cfpk_customer_nation_1#2568, cval_customer_c_name#2548 AS cval_customer_c_name_1#2569, cval_customer_c_address#2549 AS cval_customer_c_address_1#2570, cval_customer_c_phone#2550 AS cval_customer_c_phone_1#2571, cval_customer_c_acctbal#2551 AS cval_customer_c_acctbal_1#2572, cval_customer_c_comment#2552 AS cval_customer_c_comment_1#2573, cval_customer_c_mktsegment#2553 AS cval_customer_c_mktsegment_1#2574, cdepval_customer_c_name#2554 AS cdepval_customer_c_name_1#2575, cdepval_customer_c_address#2555 AS cdepval_customer_c_address_1#2576, cdepval_customer_c_phone#2556 AS cdepval_customer_c_phone_1#2577, cdepval_customer_c_acctbal#2557 AS cdepval_customer_c_acctbal_1#2578, cdepval_customer_c_comment#2558 AS cdepval_customer_c_comment_1#2579, cdepval_customer_c_mktsegment#2559 AS cdepval_customer_c_mktsegment_1#2580, cc_name#2560 AS cc_name_1#2581, cc_address#2561 AS cc_address_1#2582, cc_phone#2562 AS cc_phone_1#2583, cc_acctbal#2563 AS cc_acctbal_1#2584, cc_comment#2564 AS cc_comment_1#2585, cc_mktsegment#2565 AS cc_mktsegment_1#2586]
            +- Relation[rid#2545,cpfk_nation_customer#2546,cfpk_customer_nation#2547,cval_customer_c_name#2548,cval_customer_c_address#2549,cval_customer_c_phone#2550,cval_customer_c_acctbal#2551,cval_customer_c_comment#2552,cval_customer_c_mktsegment#2553,cdepval_customer_c_name#2554,cdepval_customer_c_address#2555,cdepval_customer_c_phone#2556,cdepval_customer_c_acctbal#2557,cdepval_customer_c_comment#2558,cdepval_customer_c_mktsegment#2559,cc_name#2560,cc_address#2561,cc_phone#2562,cc_acctbal#2563,cc_comment#2564,cc_mktsegment#2565] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 10100ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/26 21:11:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:11:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2638L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 21:11:51 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:11:51 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:11:51 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:11:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:11:51 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:11:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:11:51 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:11:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:11:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:11:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:11:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:11:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:11:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:11:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2638L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#2808 AS rid_4#2853, cpfk_orders_lineitem#2809 AS cpfk_orders_lineitem_4#2854, cpfk_supplier_lineitem#2810 AS cpfk_supplier_lineitem_4#2855, cfpk_lineitem_supplier#2811 AS cfpk_lineitem_supplier_4#2856, cfpk_lineitem_partsupp#2812 AS cfpk_lineitem_partsupp_4#2857, cpfk_part_lineitem#2813 AS cpfk_part_lineitem_4#2858, cfpk_lineitem_part#2814 AS cfpk_lineitem_part_4#2859, cpfk_partsupp_lineitem#2815 AS cpfk_partsupp_lineitem_4#2860, cfpk_lineitem_orders#2816 AS cfpk_lineitem_orders_4#2861, cval_lineitem_l_quantity#2817 AS cval_lineitem_l_quantity_4#2862, cval_lineitem_l_extendedprice#2818 AS cval_lineitem_l_extendedprice_4#2863, cval_lineitem_l_discount#2819 AS cval_lineitem_l_discount_4#2864, cval_lineitem_l_tax#2820 AS cval_lineitem_l_tax_4#2865, cval_lineitem_l_returnflag#2821 AS cval_lineitem_l_returnflag_4#2866, cval_lineitem_l_linestatus#2822 AS cval_lineitem_l_linestatus_4#2867, cval_lineitem_l_commitdate#2823 AS cval_lineitem_l_commitdate_4#2868, cval_lineitem_l_receiptdate#2824 AS cval_lineitem_l_receiptdate_4#2869, cval_lineitem_l_shipinstruct#2825 AS cval_lineitem_l_shipinstruct_4#2870, cval_lineitem_l_shipmode#2826 AS cval_lineitem_l_shipmode_4#2871, cval_lineitem_l_comment#2827 AS cval_lineitem_l_comment_4#2872, cval_lineitem_l_shipdate#2828 AS cval_lineitem_l_shipdate_4#2873, cdepval_lineitem_l_quantity#2829 AS cdepval_lineitem_l_quantity_4#2874, cdepval_lineitem_l_extendedprice#2830 AS cdepval_lineitem_l_extendedprice_4#2875, cdepval_lineitem_l_discount#2831 AS cdepval_lineitem_l_discount_4#2876, ... 21 more fields]
            :  :  +- Relation[rid#2808,cpfk_orders_lineitem#2809,cpfk_supplier_lineitem#2810,cfpk_lineitem_supplier#2811,cfpk_lineitem_partsupp#2812,cpfk_part_lineitem#2813,cfpk_lineitem_part#2814,cpfk_partsupp_lineitem#2815,cfpk_lineitem_orders#2816,cval_lineitem_l_quantity#2817,cval_lineitem_l_extendedprice#2818,cval_lineitem_l_discount#2819,cval_lineitem_l_tax#2820,cval_lineitem_l_returnflag#2821,cval_lineitem_l_linestatus#2822,cval_lineitem_l_commitdate#2823,cval_lineitem_l_receiptdate#2824,cval_lineitem_l_shipinstruct#2825,cval_lineitem_l_shipmode#2826,cval_lineitem_l_comment#2827,cval_lineitem_l_shipdate#2828,cdepval_lineitem_l_quantity#2829,cdepval_lineitem_l_extendedprice#2830,cdepval_lineitem_l_discount#2831,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#2760 AS rid_3#2784, cpfk_customer_orders#2761 AS cpfk_customer_orders_3#2785, cfpk_orders_customer#2762 AS cfpk_orders_customer_3#2786, cval_orders_o_orderstatus#2763 AS cval_orders_o_orderstatus_3#2787, cval_orders_o_totalprice#2764 AS cval_orders_o_totalprice_3#2788, cval_orders_o_orderpriority#2765 AS cval_orders_o_orderpriority_3#2789, cval_orders_o_clerk#2766 AS cval_orders_o_clerk_3#2790, cval_orders_o_shippriority#2767 AS cval_orders_o_shippriority_3#2791, cval_orders_o_comment#2768 AS cval_orders_o_comment_3#2792, cval_orders_o_orderdate#2769 AS cval_orders_o_orderdate_3#2793, cdepval_orders_o_orderstatus#2770 AS cdepval_orders_o_orderstatus_3#2794, cdepval_orders_o_totalprice#2771 AS cdepval_orders_o_totalprice_3#2795, cdepval_orders_o_orderpriority#2772 AS cdepval_orders_o_orderpriority_3#2796, cdepval_orders_o_clerk#2773 AS cdepval_orders_o_clerk_3#2797, cdepval_orders_o_shippriority#2774 AS cdepval_orders_o_shippriority_3#2798, cdepval_orders_o_comment#2775 AS cdepval_orders_o_comment_3#2799, cdepval_orders_o_orderdate#2776 AS cdepval_orders_o_orderdate_3#2800, co_orderstatus#2777 AS co_orderstatus_3#2801, co_totalprice#2778 AS co_totalprice_3#2802, co_orderpriority#2779 AS co_orderpriority_3#2803, co_clerk#2780 AS co_clerk_3#2804, co_shippriority#2781 AS co_shippriority_3#2805, co_comment#2782 AS co_comment_3#2806, co_orderdate#2783 AS co_orderdate_3#2807]
            :     :  +- Relation[rid#2760,cpfk_customer_orders#2761,cfpk_orders_customer#2762,cval_orders_o_orderstatus#2763,cval_orders_o_totalprice#2764,cval_orders_o_orderpriority#2765,cval_orders_o_clerk#2766,cval_orders_o_shippriority#2767,cval_orders_o_comment#2768,cval_orders_o_orderdate#2769,cdepval_orders_o_orderstatus#2770,cdepval_orders_o_totalprice#2771,cdepval_orders_o_orderpriority#2772,cdepval_orders_o_clerk#2773,cdepval_orders_o_shippriority#2774,cdepval_orders_o_comment#2775,cdepval_orders_o_orderdate#2776,co_orderstatus#2777,co_totalprice#2778,co_orderpriority#2779,co_clerk#2780,co_shippriority#2781,co_comment#2782,co_orderdate#2783] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#2718 AS rid_2#2739, cpfk_nation_customer#2719 AS cpfk_nation_customer_2#2740, cfpk_customer_nation#2720 AS cfpk_customer_nation_2#2741, cval_customer_c_name#2721 AS cval_customer_c_name_2#2742, cval_customer_c_address#2722 AS cval_customer_c_address_2#2743, cval_customer_c_phone#2723 AS cval_customer_c_phone_2#2744, cval_customer_c_acctbal#2724 AS cval_customer_c_acctbal_2#2745, cval_customer_c_comment#2725 AS cval_customer_c_comment_2#2746, cval_customer_c_mktsegment#2726 AS cval_customer_c_mktsegment_2#2747, cdepval_customer_c_name#2727 AS cdepval_customer_c_name_2#2748, cdepval_customer_c_address#2728 AS cdepval_customer_c_address_2#2749, cdepval_customer_c_phone#2729 AS cdepval_customer_c_phone_2#2750, cdepval_customer_c_acctbal#2730 AS cdepval_customer_c_acctbal_2#2751, cdepval_customer_c_comment#2731 AS cdepval_customer_c_comment_2#2752, cdepval_customer_c_mktsegment#2732 AS cdepval_customer_c_mktsegment_2#2753, cc_name#2733 AS cc_name_2#2754, cc_address#2734 AS cc_address_2#2755, cc_phone#2735 AS cc_phone_2#2756, cc_acctbal#2736 AS cc_acctbal_2#2757, cc_comment#2737 AS cc_comment_2#2758, cc_mktsegment#2738 AS cc_mktsegment_2#2759]
            :        :  +- Relation[rid#2718,cpfk_nation_customer#2719,cfpk_customer_nation#2720,cval_customer_c_name#2721,cval_customer_c_address#2722,cval_customer_c_phone#2723,cval_customer_c_acctbal#2724,cval_customer_c_comment#2725,cval_customer_c_mktsegment#2726,cdepval_customer_c_name#2727,cdepval_customer_c_address#2728,cdepval_customer_c_phone#2729,cdepval_customer_c_acctbal#2730,cdepval_customer_c_comment#2731,cdepval_customer_c_mktsegment#2732,cc_name#2733,cc_address#2734,cc_phone#2735,cc_acctbal#2736,cc_comment#2737,cc_mktsegment#2738] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join UsingJoin(Inner,List(rid_1))
            :           :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#2647, cval_region_r_name_0#2648, cval_region_r_comment_0#2649, cdepval_region_r_name_0#2650, cdepval_region_r_comment_0#2651, cr_name_0#2652, cr_comment_0#2653, 'rid_1]
            :           :  :- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :           :  :  +- Project [rid#2640 AS rid_0#2647, cval_region_r_name#2641 AS cval_region_r_name_0#2648, cval_region_r_comment#2642 AS cval_region_r_comment_0#2649, cdepval_region_r_name#2643 AS cdepval_region_r_name_0#2650, cdepval_region_r_comment#2644 AS cdepval_region_r_comment_0#2651, cr_name#2645 AS cr_name_0#2652, cr_comment#2646 AS cr_comment_0#2653]
            :           :  :     +- Relation[rid#2640,cval_region_r_name#2641,cval_region_r_comment#2642,cdepval_region_r_name#2643,cdepval_region_r_comment#2644,cr_name#2645,cr_comment#2646] JDBCRelation(tregion) [numPartitions=1]
            :           :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
            :           :     +- Project [rid#2700 AS rid_1#2709, cpfk_region_nation#2701 AS cpfk_region_nation_1#2710, cfpk_nation_region#2702 AS cfpk_nation_region_1#2711, cval_nation_n_name#2703 AS cval_nation_n_name_1#2712, cval_nation_n_comment#2704 AS cval_nation_n_comment_1#2713, cdepval_nation_n_name#2705 AS cdepval_nation_n_name_1#2714, cdepval_nation_n_comment#2706 AS cdepval_nation_n_comment_1#2715, cn_name#2707 AS cn_name_1#2716, cn_comment#2708 AS cn_comment_1#2717]
            :           :        +- Relation[rid#2700,cpfk_region_nation#2701,cfpk_nation_region#2702,cval_nation_n_name#2703,cval_nation_n_comment#2704,cdepval_nation_n_name#2705,cdepval_nation_n_comment#2706,cn_name#2707,cn_comment#2708] JDBCRelation(tnation) [numPartitions=1]
            :           +- Project [rid#2668 AS rid_1#2677, cpfk_region_nation#2669 AS cpfk_region_nation_1#2678, cfpk_nation_region#2670 AS cfpk_nation_region_1#2679, cval_nation_n_name#2671 AS cval_nation_n_name_1#2680, cval_nation_n_comment#2672 AS cval_nation_n_comment_1#2681, cdepval_nation_n_name#2673 AS cdepval_nation_n_name_1#2682, cdepval_nation_n_comment#2674 AS cdepval_nation_n_comment_1#2683, cn_name#2675 AS cn_name_1#2684, cn_comment#2676 AS cn_comment_1#2685]
            :              +- Relation[rid#2668,cpfk_region_nation#2669,cfpk_nation_region#2670,cval_nation_n_name#2671,cval_nation_n_comment#2672,cdepval_nation_n_name#2673,cdepval_nation_n_comment#2674,cn_name#2675,cn_comment#2676] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#2898 AS rid_5#2916, cpfk_nation_supplier#2899 AS cpfk_nation_supplier_5#2917, cfpk_supplier_nation#2900 AS cfpk_supplier_nation_5#2918, cval_supplier_s_name#2901 AS cval_supplier_s_name_5#2919, cval_supplier_s_address#2902 AS cval_supplier_s_address_5#2920, cval_supplier_s_phone#2903 AS cval_supplier_s_phone_5#2921, cval_supplier_s_acctbal#2904 AS cval_supplier_s_acctbal_5#2922, cval_supplier_s_comment#2905 AS cval_supplier_s_comment_5#2923, cdepval_supplier_s_name#2906 AS cdepval_supplier_s_name_5#2924, cdepval_supplier_s_address#2907 AS cdepval_supplier_s_address_5#2925, cdepval_supplier_s_phone#2908 AS cdepval_supplier_s_phone_5#2926, cdepval_supplier_s_acctbal#2909 AS cdepval_supplier_s_acctbal_5#2927, cdepval_supplier_s_comment#2910 AS cdepval_supplier_s_comment_5#2928, cs_name#2911 AS cs_name_5#2929, cs_address#2912 AS cs_address_5#2930, cs_phone#2913 AS cs_phone_5#2931, cs_acctbal#2914 AS cs_acctbal_5#2932, cs_comment#2915 AS cs_comment_5#2933]
               +- Relation[rid#2898,cpfk_nation_supplier#2899,cfpk_supplier_nation#2900,cval_supplier_s_name#2901,cval_supplier_s_address#2902,cval_supplier_s_phone#2903,cval_supplier_s_acctbal#2904,cval_supplier_s_comment#2905,cdepval_supplier_s_name#2906,cdepval_supplier_s_address#2907,cdepval_supplier_s_phone#2908,cdepval_supplier_s_acctbal#2909,cdepval_supplier_s_comment#2910,cs_name#2911,cs_address#2912,cs_phone#2913,cs_acctbal#2914,cs_comment#2915] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 30157ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/26 21:12:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:12:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3062L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 21:12:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3062L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#3064 AS rid_0#3088, cpfk_customer_orders#3065 AS cpfk_customer_orders_0#3089, cfpk_orders_customer#3066 AS cfpk_orders_customer_0#3090, cval_orders_o_orderstatus#3067 AS cval_orders_o_orderstatus_0#3091, cval_orders_o_totalprice#3068 AS cval_orders_o_totalprice_0#3092, cval_orders_o_orderpriority#3069 AS cval_orders_o_orderpriority_0#3093, cval_orders_o_clerk#3070 AS cval_orders_o_clerk_0#3094, cval_orders_o_shippriority#3071 AS cval_orders_o_shippriority_0#3095, cval_orders_o_comment#3072 AS cval_orders_o_comment_0#3096, cval_orders_o_orderdate#3073 AS cval_orders_o_orderdate_0#3097, cdepval_orders_o_orderstatus#3074 AS cdepval_orders_o_orderstatus_0#3098, cdepval_orders_o_totalprice#3075 AS cdepval_orders_o_totalprice_0#3099, cdepval_orders_o_orderpriority#3076 AS cdepval_orders_o_orderpriority_0#3100, cdepval_orders_o_clerk#3077 AS cdepval_orders_o_clerk_0#3101, cdepval_orders_o_shippriority#3078 AS cdepval_orders_o_shippriority_0#3102, cdepval_orders_o_comment#3079 AS cdepval_orders_o_comment_0#3103, cdepval_orders_o_orderdate#3080 AS cdepval_orders_o_orderdate_0#3104, co_orderstatus#3081 AS co_orderstatus_0#3105, co_totalprice#3082 AS co_totalprice_0#3106, co_orderpriority#3083 AS co_orderpriority_0#3107, co_clerk#3084 AS co_clerk_0#3108, co_shippriority#3085 AS co_shippriority_0#3109, co_comment#3086 AS co_comment_0#3110, co_orderdate#3087 AS co_orderdate_0#3111]
         :  +- Relation[rid#3064,cpfk_customer_orders#3065,cfpk_orders_customer#3066,cval_orders_o_orderstatus#3067,cval_orders_o_totalprice#3068,cval_orders_o_orderpriority#3069,cval_orders_o_clerk#3070,cval_orders_o_shippriority#3071,cval_orders_o_comment#3072,cval_orders_o_orderdate#3073,cdepval_orders_o_orderstatus#3074,cdepval_orders_o_totalprice#3075,cdepval_orders_o_orderpriority#3076,cdepval_orders_o_clerk#3077,cdepval_orders_o_shippriority#3078,cdepval_orders_o_comment#3079,cdepval_orders_o_orderdate#3080,co_orderstatus#3081,co_totalprice#3082,co_orderpriority#3083,co_clerk#3084,co_shippriority#3085,co_comment#3086,co_orderdate#3087] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#3112 AS rid_1#3133, cpfk_nation_customer#3113 AS cpfk_nation_customer_1#3134, cfpk_customer_nation#3114 AS cfpk_customer_nation_1#3135, cval_customer_c_name#3115 AS cval_customer_c_name_1#3136, cval_customer_c_address#3116 AS cval_customer_c_address_1#3137, cval_customer_c_phone#3117 AS cval_customer_c_phone_1#3138, cval_customer_c_acctbal#3118 AS cval_customer_c_acctbal_1#3139, cval_customer_c_comment#3119 AS cval_customer_c_comment_1#3140, cval_customer_c_mktsegment#3120 AS cval_customer_c_mktsegment_1#3141, cdepval_customer_c_name#3121 AS cdepval_customer_c_name_1#3142, cdepval_customer_c_address#3122 AS cdepval_customer_c_address_1#3143, cdepval_customer_c_phone#3123 AS cdepval_customer_c_phone_1#3144, cdepval_customer_c_acctbal#3124 AS cdepval_customer_c_acctbal_1#3145, cdepval_customer_c_comment#3125 AS cdepval_customer_c_comment_1#3146, cdepval_customer_c_mktsegment#3126 AS cdepval_customer_c_mktsegment_1#3147, cc_name#3127 AS cc_name_1#3148, cc_address#3128 AS cc_address_1#3149, cc_phone#3129 AS cc_phone_1#3150, cc_acctbal#3130 AS cc_acctbal_1#3151, cc_comment#3131 AS cc_comment_1#3152, cc_mktsegment#3132 AS cc_mktsegment_1#3153]
            +- Relation[rid#3112,cpfk_nation_customer#3113,cfpk_customer_nation#3114,cval_customer_c_name#3115,cval_customer_c_address#3116,cval_customer_c_phone#3117,cval_customer_c_acctbal#3118,cval_customer_c_comment#3119,cval_customer_c_mktsegment#3120,cdepval_customer_c_name#3121,cdepval_customer_c_address#3122,cdepval_customer_c_phone#3123,cdepval_customer_c_acctbal#3124,cdepval_customer_c_comment#3125,cdepval_customer_c_mktsegment#3126,cc_name#3127,cc_address#3128,cc_phone#3129,cc_acctbal#3130,cc_comment#3131,cc_mktsegment#3132] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4320ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/26 21:12:25 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:12:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3205L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 21:12:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:12:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:12:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:12:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:12:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:12:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:12:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:12:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:12:25 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:12:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:12:25 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:12:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3205L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#3333 AS rid_2#3347, cpfk_part_partsupp#3334 AS cpfk_part_partsupp_2#3348, cfpk_partsupp_part#3335 AS cfpk_partsupp_part_2#3349, cpfk_supplier_partsupp#3336 AS cpfk_supplier_partsupp_2#3350, cfpk_partsupp_supplier#3337 AS cfpk_partsupp_supplier_2#3351, cval_partsupp_ps_availqty#3338 AS cval_partsupp_ps_availqty_2#3352, cval_partsupp_ps_supplycost#3339 AS cval_partsupp_ps_supplycost_2#3353, cval_partsupp_ps_comment#3340 AS cval_partsupp_ps_comment_2#3354, cdepval_partsupp_ps_availqty#3341 AS cdepval_partsupp_ps_availqty_2#3355, cdepval_partsupp_ps_supplycost#3342 AS cdepval_partsupp_ps_supplycost_2#3356, cdepval_partsupp_ps_comment#3343 AS cdepval_partsupp_ps_comment_2#3357, cps_availqty#3344 AS cps_availqty_2#3358, cps_supplycost#3345 AS cps_supplycost_2#3359, cps_comment#3346 AS cps_comment_2#3360]
         :  +- Relation[rid#3333,cpfk_part_partsupp#3334,cfpk_partsupp_part#3335,cpfk_supplier_partsupp#3336,cfpk_partsupp_supplier#3337,cval_partsupp_ps_availqty#3338,cval_partsupp_ps_supplycost#3339,cval_partsupp_ps_comment#3340,cdepval_partsupp_ps_availqty#3341,cdepval_partsupp_ps_supplycost#3342,cdepval_partsupp_ps_comment#3343,cps_availqty#3344,cps_supplycost#3345,cps_comment#3346] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#3216, cpfk_region_nation_0#3217, cfpk_nation_region_0#3218, cval_nation_n_name_0#3219, cval_nation_n_comment_0#3220, cdepval_nation_n_name_0#3221, cdepval_nation_n_comment_0#3222, cn_name_0#3223, cn_comment_0#3224, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
            :  :  +- Project [rid#3207 AS rid_0#3216, cpfk_region_nation#3208 AS cpfk_region_nation_0#3217, cfpk_nation_region#3209 AS cfpk_nation_region_0#3218, cval_nation_n_name#3210 AS cval_nation_n_name_0#3219, cval_nation_n_comment#3211 AS cval_nation_n_comment_0#3220, cdepval_nation_n_name#3212 AS cdepval_nation_n_name_0#3221, cdepval_nation_n_comment#3213 AS cdepval_nation_n_comment_0#3222, cn_name#3214 AS cn_name_0#3223, cn_comment#3215 AS cn_comment_0#3224]
            :  :     +- Relation[rid#3207,cpfk_region_nation#3208,cfpk_nation_region#3209,cval_nation_n_name#3210,cval_nation_n_comment#3211,cdepval_nation_n_name#3212,cdepval_nation_n_comment#3213,cn_name#3214,cn_comment#3215] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
            :     +- Project [rid#3297 AS rid_1#3315, cpfk_nation_supplier#3298 AS cpfk_nation_supplier_1#3316, cfpk_supplier_nation#3299 AS cfpk_supplier_nation_1#3317, cval_supplier_s_name#3300 AS cval_supplier_s_name_1#3318, cval_supplier_s_address#3301 AS cval_supplier_s_address_1#3319, cval_supplier_s_phone#3302 AS cval_supplier_s_phone_1#3320, cval_supplier_s_acctbal#3303 AS cval_supplier_s_acctbal_1#3321, cval_supplier_s_comment#3304 AS cval_supplier_s_comment_1#3322, cdepval_supplier_s_name#3305 AS cdepval_supplier_s_name_1#3323, cdepval_supplier_s_address#3306 AS cdepval_supplier_s_address_1#3324, cdepval_supplier_s_phone#3307 AS cdepval_supplier_s_phone_1#3325, cdepval_supplier_s_acctbal#3308 AS cdepval_supplier_s_acctbal_1#3326, cdepval_supplier_s_comment#3309 AS cdepval_supplier_s_comment_1#3327, cs_name#3310 AS cs_name_1#3328, cs_address#3311 AS cs_address_1#3329, cs_phone#3312 AS cs_phone_1#3330, cs_acctbal#3313 AS cs_acctbal_1#3331, cs_comment#3314 AS cs_comment_1#3332]
            :        +- Relation[rid#3297,cpfk_nation_supplier#3298,cfpk_supplier_nation#3299,cval_supplier_s_name#3300,cval_supplier_s_address#3301,cval_supplier_s_phone#3302,cval_supplier_s_acctbal#3303,cval_supplier_s_comment#3304,cdepval_supplier_s_name#3305,cdepval_supplier_s_address#3306,cdepval_supplier_s_phone#3307,cdepval_supplier_s_acctbal#3308,cdepval_supplier_s_comment#3309,cs_name#3310,cs_address#3311,cs_phone#3312,cs_acctbal#3313,cs_comment#3314] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#3243 AS rid_1#3261, cpfk_nation_supplier#3244 AS cpfk_nation_supplier_1#3262, cfpk_supplier_nation#3245 AS cfpk_supplier_nation_1#3263, cval_supplier_s_name#3246 AS cval_supplier_s_name_1#3264, cval_supplier_s_address#3247 AS cval_supplier_s_address_1#3265, cval_supplier_s_phone#3248 AS cval_supplier_s_phone_1#3266, cval_supplier_s_acctbal#3249 AS cval_supplier_s_acctbal_1#3267, cval_supplier_s_comment#3250 AS cval_supplier_s_comment_1#3268, cdepval_supplier_s_name#3251 AS cdepval_supplier_s_name_1#3269, cdepval_supplier_s_address#3252 AS cdepval_supplier_s_address_1#3270, cdepval_supplier_s_phone#3253 AS cdepval_supplier_s_phone_1#3271, cdepval_supplier_s_acctbal#3254 AS cdepval_supplier_s_acctbal_1#3272, cdepval_supplier_s_comment#3255 AS cdepval_supplier_s_comment_1#3273, cs_name#3256 AS cs_name_1#3274, cs_address#3257 AS cs_address_1#3275, cs_phone#3258 AS cs_phone_1#3276, cs_acctbal#3259 AS cs_acctbal_1#3277, cs_comment#3260 AS cs_comment_1#3278]
               +- Relation[rid#3243,cpfk_nation_supplier#3244,cfpk_supplier_nation#3245,cval_supplier_s_name#3246,cval_supplier_s_address#3247,cval_supplier_s_phone#3248,cval_supplier_s_acctbal#3249,cval_supplier_s_comment#3250,cdepval_supplier_s_name#3251,cdepval_supplier_s_address#3252,cdepval_supplier_s_phone#3253,cdepval_supplier_s_acctbal#3254,cdepval_supplier_s_comment#3255,cs_name#3256,cs_address#3257,cs_phone#3258,cs_acctbal#3259,cs_comment#3260] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 4138ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/26 21:12:29 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:12:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3407L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:12:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#3407L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#3409 AS rid_0#3454, cpfk_orders_lineitem#3410 AS cpfk_orders_lineitem_0#3455, cpfk_supplier_lineitem#3411 AS cpfk_supplier_lineitem_0#3456, cfpk_lineitem_supplier#3412 AS cfpk_lineitem_supplier_0#3457, cfpk_lineitem_partsupp#3413 AS cfpk_lineitem_partsupp_0#3458, cpfk_part_lineitem#3414 AS cpfk_part_lineitem_0#3459, cfpk_lineitem_part#3415 AS cfpk_lineitem_part_0#3460, cpfk_partsupp_lineitem#3416 AS cpfk_partsupp_lineitem_0#3461, cfpk_lineitem_orders#3417 AS cfpk_lineitem_orders_0#3462, cval_lineitem_l_quantity#3418 AS cval_lineitem_l_quantity_0#3463, cval_lineitem_l_extendedprice#3419 AS cval_lineitem_l_extendedprice_0#3464, cval_lineitem_l_discount#3420 AS cval_lineitem_l_discount_0#3465, cval_lineitem_l_tax#3421 AS cval_lineitem_l_tax_0#3466, cval_lineitem_l_returnflag#3422 AS cval_lineitem_l_returnflag_0#3467, cval_lineitem_l_linestatus#3423 AS cval_lineitem_l_linestatus_0#3468, cval_lineitem_l_commitdate#3424 AS cval_lineitem_l_commitdate_0#3469, cval_lineitem_l_receiptdate#3425 AS cval_lineitem_l_receiptdate_0#3470, cval_lineitem_l_shipinstruct#3426 AS cval_lineitem_l_shipinstruct_0#3471, cval_lineitem_l_shipmode#3427 AS cval_lineitem_l_shipmode_0#3472, cval_lineitem_l_comment#3428 AS cval_lineitem_l_comment_0#3473, cval_lineitem_l_shipdate#3429 AS cval_lineitem_l_shipdate_0#3474, cdepval_lineitem_l_quantity#3430 AS cdepval_lineitem_l_quantity_0#3475, cdepval_lineitem_l_extendedprice#3431 AS cdepval_lineitem_l_extendedprice_0#3476, cdepval_lineitem_l_discount#3432 AS cdepval_lineitem_l_discount_0#3477, ... 21 more fields]
         +- Relation[rid#3409,cpfk_orders_lineitem#3410,cpfk_supplier_lineitem#3411,cfpk_lineitem_supplier#3412,cfpk_lineitem_partsupp#3413,cpfk_part_lineitem#3414,cfpk_lineitem_part#3415,cpfk_partsupp_lineitem#3416,cfpk_lineitem_orders#3417,cval_lineitem_l_quantity#3418,cval_lineitem_l_extendedprice#3419,cval_lineitem_l_discount#3420,cval_lineitem_l_tax#3421,cval_lineitem_l_returnflag#3422,cval_lineitem_l_linestatus#3423,cval_lineitem_l_commitdate#3424,cval_lineitem_l_receiptdate#3425,cval_lineitem_l_shipinstruct#3426,cval_lineitem_l_shipmode#3427,cval_lineitem_l_comment#3428,cval_lineitem_l_shipdate#3429,cdepval_lineitem_l_quantity#3430,cdepval_lineitem_l_extendedprice#3431,cdepval_lineitem_l_discount#3432,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2783ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 21:12:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:12:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3553L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:12:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:12:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:12:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:12:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:12:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:12:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:12:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:12:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:12:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:12:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:12:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:12:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3553L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#3687 AS rid_4#3732, cpfk_orders_lineitem#3688 AS cpfk_orders_lineitem_4#3733, cpfk_supplier_lineitem#3689 AS cpfk_supplier_lineitem_4#3734, cfpk_lineitem_supplier#3690 AS cfpk_lineitem_supplier_4#3735, cfpk_lineitem_partsupp#3691 AS cfpk_lineitem_partsupp_4#3736, cpfk_part_lineitem#3692 AS cpfk_part_lineitem_4#3737, cfpk_lineitem_part#3693 AS cfpk_lineitem_part_4#3738, cpfk_partsupp_lineitem#3694 AS cpfk_partsupp_lineitem_4#3739, cfpk_lineitem_orders#3695 AS cfpk_lineitem_orders_4#3740, cval_lineitem_l_quantity#3696 AS cval_lineitem_l_quantity_4#3741, cval_lineitem_l_extendedprice#3697 AS cval_lineitem_l_extendedprice_4#3742, cval_lineitem_l_discount#3698 AS cval_lineitem_l_discount_4#3743, cval_lineitem_l_tax#3699 AS cval_lineitem_l_tax_4#3744, cval_lineitem_l_returnflag#3700 AS cval_lineitem_l_returnflag_4#3745, cval_lineitem_l_linestatus#3701 AS cval_lineitem_l_linestatus_4#3746, cval_lineitem_l_commitdate#3702 AS cval_lineitem_l_commitdate_4#3747, cval_lineitem_l_receiptdate#3703 AS cval_lineitem_l_receiptdate_4#3748, cval_lineitem_l_shipinstruct#3704 AS cval_lineitem_l_shipinstruct_4#3749, cval_lineitem_l_shipmode#3705 AS cval_lineitem_l_shipmode_4#3750, cval_lineitem_l_comment#3706 AS cval_lineitem_l_comment_4#3751, cval_lineitem_l_shipdate#3707 AS cval_lineitem_l_shipdate_4#3752, cdepval_lineitem_l_quantity#3708 AS cdepval_lineitem_l_quantity_4#3753, cdepval_lineitem_l_extendedprice#3709 AS cdepval_lineitem_l_extendedprice_4#3754, cdepval_lineitem_l_discount#3710 AS cdepval_lineitem_l_discount_4#3755, ... 21 more fields]
         :  :  +- Relation[rid#3687,cpfk_orders_lineitem#3688,cpfk_supplier_lineitem#3689,cfpk_lineitem_supplier#3690,cfpk_lineitem_partsupp#3691,cpfk_part_lineitem#3692,cfpk_lineitem_part#3693,cpfk_partsupp_lineitem#3694,cfpk_lineitem_orders#3695,cval_lineitem_l_quantity#3696,cval_lineitem_l_extendedprice#3697,cval_lineitem_l_discount#3698,cval_lineitem_l_tax#3699,cval_lineitem_l_returnflag#3700,cval_lineitem_l_linestatus#3701,cval_lineitem_l_commitdate#3702,cval_lineitem_l_receiptdate#3703,cval_lineitem_l_shipinstruct#3704,cval_lineitem_l_shipmode#3705,cval_lineitem_l_comment#3706,cval_lineitem_l_shipdate#3707,cdepval_lineitem_l_quantity#3708,cdepval_lineitem_l_extendedprice#3709,cdepval_lineitem_l_discount#3710,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#3609 AS rid_2#3623, cpfk_part_partsupp#3610 AS cpfk_part_partsupp_2#3624, cfpk_partsupp_part#3611 AS cfpk_partsupp_part_2#3625, cpfk_supplier_partsupp#3612 AS cpfk_supplier_partsupp_2#3626, cfpk_partsupp_supplier#3613 AS cfpk_partsupp_supplier_2#3627, cval_partsupp_ps_availqty#3614 AS cval_partsupp_ps_availqty_2#3628, cval_partsupp_ps_supplycost#3615 AS cval_partsupp_ps_supplycost_2#3629, cval_partsupp_ps_comment#3616 AS cval_partsupp_ps_comment_2#3630, cdepval_partsupp_ps_availqty#3617 AS cdepval_partsupp_ps_availqty_2#3631, cdepval_partsupp_ps_supplycost#3618 AS cdepval_partsupp_ps_supplycost_2#3632, cdepval_partsupp_ps_comment#3619 AS cdepval_partsupp_ps_comment_2#3633, cps_availqty#3620 AS cps_availqty_2#3634, cps_supplycost#3621 AS cps_supplycost_2#3635, cps_comment#3622 AS cps_comment_2#3636]
         :     :  :  +- Relation[rid#3609,cpfk_part_partsupp#3610,cfpk_partsupp_part#3611,cpfk_supplier_partsupp#3612,cfpk_partsupp_supplier#3613,cval_partsupp_ps_availqty#3614,cval_partsupp_ps_supplycost#3615,cval_partsupp_ps_comment#3616,cdepval_partsupp_ps_availqty#3617,cdepval_partsupp_ps_supplycost#3618,cdepval_partsupp_ps_comment#3619,cps_availqty#3620,cps_supplycost#3621,cps_comment#3622] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#3573 AS rid_1#3591, cpfk_nation_supplier#3574 AS cpfk_nation_supplier_1#3592, cfpk_supplier_nation#3575 AS cfpk_supplier_nation_1#3593, cval_supplier_s_name#3576 AS cval_supplier_s_name_1#3594, cval_supplier_s_address#3577 AS cval_supplier_s_address_1#3595, cval_supplier_s_phone#3578 AS cval_supplier_s_phone_1#3596, cval_supplier_s_acctbal#3579 AS cval_supplier_s_acctbal_1#3597, cval_supplier_s_comment#3580 AS cval_supplier_s_comment_1#3598, cdepval_supplier_s_name#3581 AS cdepval_supplier_s_name_1#3599, cdepval_supplier_s_address#3582 AS cdepval_supplier_s_address_1#3600, cdepval_supplier_s_phone#3583 AS cdepval_supplier_s_phone_1#3601, cdepval_supplier_s_acctbal#3584 AS cdepval_supplier_s_acctbal_1#3602, cdepval_supplier_s_comment#3585 AS cdepval_supplier_s_comment_1#3603, cs_name#3586 AS cs_name_1#3604, cs_address#3587 AS cs_address_1#3605, cs_phone#3588 AS cs_phone_1#3606, cs_acctbal#3589 AS cs_acctbal_1#3607, cs_comment#3590 AS cs_comment_1#3608]
         :     :     :  +- Relation[rid#3573,cpfk_nation_supplier#3574,cfpk_supplier_nation#3575,cval_supplier_s_name#3576,cval_supplier_s_address#3577,cval_supplier_s_phone#3578,cval_supplier_s_acctbal#3579,cval_supplier_s_comment#3580,cdepval_supplier_s_name#3581,cdepval_supplier_s_address#3582,cdepval_supplier_s_phone#3583,cdepval_supplier_s_acctbal#3584,cdepval_supplier_s_comment#3585,cs_name#3586,cs_address#3587,cs_phone#3588,cs_acctbal#3589,cs_comment#3590] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#3555 AS rid_0#3564, cpfk_region_nation#3556 AS cpfk_region_nation_0#3565, cfpk_nation_region#3557 AS cfpk_nation_region_0#3566, cval_nation_n_name#3558 AS cval_nation_n_name_0#3567, cval_nation_n_comment#3559 AS cval_nation_n_comment_0#3568, cdepval_nation_n_name#3560 AS cdepval_nation_n_name_0#3569, cdepval_nation_n_comment#3561 AS cdepval_nation_n_comment_0#3570, cn_name#3562 AS cn_name_0#3571, cn_comment#3563 AS cn_comment_0#3572]
         :     :        +- Relation[rid#3555,cpfk_region_nation#3556,cfpk_nation_region#3557,cval_nation_n_name#3558,cval_nation_n_comment#3559,cdepval_nation_n_name#3560,cdepval_nation_n_comment#3561,cn_name#3562,cn_comment#3563] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#3637 AS rid_3#3662, cval_part_p_name#3638 AS cval_part_p_name_3#3663, cval_part_p_mfgr#3639 AS cval_part_p_mfgr_3#3664, cval_part_p_type#3640 AS cval_part_p_type_3#3665, cval_part_p_size#3641 AS cval_part_p_size_3#3666, cval_part_p_container#3642 AS cval_part_p_container_3#3667, cval_part_p_retailprice#3643 AS cval_part_p_retailprice_3#3668, cval_part_p_comment#3644 AS cval_part_p_comment_3#3669, cval_part_p_brand#3645 AS cval_part_p_brand_3#3670, cdepval_part_p_name#3646 AS cdepval_part_p_name_3#3671, cdepval_part_p_mfgr#3647 AS cdepval_part_p_mfgr_3#3672, cdepval_part_p_type#3648 AS cdepval_part_p_type_3#3673, cdepval_part_p_size#3649 AS cdepval_part_p_size_3#3674, cdepval_part_p_container#3650 AS cdepval_part_p_container_3#3675, cdepval_part_p_retailprice#3651 AS cdepval_part_p_retailprice_3#3676, cdepval_part_p_comment#3652 AS cdepval_part_p_comment_3#3677, cdepval_part_p_brand#3653 AS cdepval_part_p_brand_3#3678, cp_name#3654 AS cp_name_3#3679, cp_mfgr#3655 AS cp_mfgr_3#3680, cp_type#3656 AS cp_type_3#3681, cp_size#3657 AS cp_size_3#3682, cp_container#3658 AS cp_container_3#3683, cp_retailprice#3659 AS cp_retailprice_3#3684, cp_comment#3660 AS cp_comment_3#3685, cp_brand#3661 AS cp_brand_3#3686]
         :        +- Relation[rid#3637,cval_part_p_name#3638,cval_part_p_mfgr#3639,cval_part_p_type#3640,cval_part_p_size#3641,cval_part_p_container#3642,cval_part_p_retailprice#3643,cval_part_p_comment#3644,cval_part_p_brand#3645,cdepval_part_p_name#3646,cdepval_part_p_mfgr#3647,cdepval_part_p_type#3648,cdepval_part_p_size#3649,cdepval_part_p_container#3650,cdepval_part_p_retailprice#3651,cdepval_part_p_comment#3652,cdepval_part_p_brand#3653,cp_name#3654,cp_mfgr#3655,cp_type#3656,cp_size#3657,cp_container#3658,cp_retailprice#3659,cp_comment#3660,cp_brand#3661] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#3777 AS rid_5#3801, cpfk_customer_orders#3778 AS cpfk_customer_orders_5#3802, cfpk_orders_customer#3779 AS cfpk_orders_customer_5#3803, cval_orders_o_orderstatus#3780 AS cval_orders_o_orderstatus_5#3804, cval_orders_o_totalprice#3781 AS cval_orders_o_totalprice_5#3805, cval_orders_o_orderpriority#3782 AS cval_orders_o_orderpriority_5#3806, cval_orders_o_clerk#3783 AS cval_orders_o_clerk_5#3807, cval_orders_o_shippriority#3784 AS cval_orders_o_shippriority_5#3808, cval_orders_o_comment#3785 AS cval_orders_o_comment_5#3809, cval_orders_o_orderdate#3786 AS cval_orders_o_orderdate_5#3810, cdepval_orders_o_orderstatus#3787 AS cdepval_orders_o_orderstatus_5#3811, cdepval_orders_o_totalprice#3788 AS cdepval_orders_o_totalprice_5#3812, cdepval_orders_o_orderpriority#3789 AS cdepval_orders_o_orderpriority_5#3813, cdepval_orders_o_clerk#3790 AS cdepval_orders_o_clerk_5#3814, cdepval_orders_o_shippriority#3791 AS cdepval_orders_o_shippriority_5#3815, cdepval_orders_o_comment#3792 AS cdepval_orders_o_comment_5#3816, cdepval_orders_o_orderdate#3793 AS cdepval_orders_o_orderdate_5#3817, co_orderstatus#3794 AS co_orderstatus_5#3818, co_totalprice#3795 AS co_totalprice_5#3819, co_orderpriority#3796 AS co_orderpriority_5#3820, co_clerk#3797 AS co_clerk_5#3821, co_shippriority#3798 AS co_shippriority_5#3822, co_comment#3799 AS co_comment_5#3823, co_orderdate#3800 AS co_orderdate_5#3824]
            +- Relation[rid#3777,cpfk_customer_orders#3778,cfpk_orders_customer#3779,cval_orders_o_orderstatus#3780,cval_orders_o_totalprice#3781,cval_orders_o_orderpriority#3782,cval_orders_o_clerk#3783,cval_orders_o_shippriority#3784,cval_orders_o_comment#3785,cval_orders_o_orderdate#3786,cdepval_orders_o_orderstatus#3787,cdepval_orders_o_totalprice#3788,cdepval_orders_o_orderpriority#3789,cdepval_orders_o_clerk#3790,cdepval_orders_o_shippriority#3791,cdepval_orders_o_comment#3792,cdepval_orders_o_orderdate#3793,co_orderstatus#3794,co_totalprice#3795,co_orderpriority#3796,co_clerk#3797,co_shippriority#3798,co_comment#3799,co_orderdate#3800] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 37865ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/26 21:13:10 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:13:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3964L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:13:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3964L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#3991, cval_part_p_name_0#3992, cval_part_p_mfgr_0#3993, cval_part_p_type_0#3994, cval_part_p_size_0#3995, cval_part_p_container_0#3996, cval_part_p_retailprice_0#3997, cval_part_p_comment_0#3998, cval_part_p_brand_0#3999, cdepval_part_p_name_0#4000, cdepval_part_p_mfgr_0#4001, cdepval_part_p_type_0#4002, cdepval_part_p_size_0#4003, cdepval_part_p_container_0#4004, cdepval_part_p_retailprice_0#4005, cdepval_part_p_comment_0#4006, cdepval_part_p_brand_0#4007, cp_name_0#4008, cp_mfgr_0#4009, cp_type_0#4010, cp_size_0#4011, cp_container_0#4012, cp_retailprice_0#4013, cp_comment_0#4014, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#3966 AS rid_0#3991, cval_part_p_name#3967 AS cval_part_p_name_0#3992, cval_part_p_mfgr#3968 AS cval_part_p_mfgr_0#3993, cval_part_p_type#3969 AS cval_part_p_type_0#3994, cval_part_p_size#3970 AS cval_part_p_size_0#3995, cval_part_p_container#3971 AS cval_part_p_container_0#3996, cval_part_p_retailprice#3972 AS cval_part_p_retailprice_0#3997, cval_part_p_comment#3973 AS cval_part_p_comment_0#3998, cval_part_p_brand#3974 AS cval_part_p_brand_0#3999, cdepval_part_p_name#3975 AS cdepval_part_p_name_0#4000, cdepval_part_p_mfgr#3976 AS cdepval_part_p_mfgr_0#4001, cdepval_part_p_type#3977 AS cdepval_part_p_type_0#4002, cdepval_part_p_size#3978 AS cdepval_part_p_size_0#4003, cdepval_part_p_container#3979 AS cdepval_part_p_container_0#4004, cdepval_part_p_retailprice#3980 AS cdepval_part_p_retailprice_0#4005, cdepval_part_p_comment#3981 AS cdepval_part_p_comment_0#4006, cdepval_part_p_brand#3982 AS cdepval_part_p_brand_0#4007, cp_name#3983 AS cp_name_0#4008, cp_mfgr#3984 AS cp_mfgr_0#4009, cp_type#3985 AS cp_type_0#4010, cp_size#3986 AS cp_size_0#4011, cp_container#3987 AS cp_container_0#4012, cp_retailprice#3988 AS cp_retailprice_0#4013, cp_comment#3989 AS cp_comment_0#4014, cp_brand#3990 AS cp_brand_0#4015]
         :  :        +- Relation[rid#3966,cval_part_p_name#3967,cval_part_p_mfgr#3968,cval_part_p_type#3969,cval_part_p_size#3970,cval_part_p_container#3971,cval_part_p_retailprice#3972,cval_part_p_comment#3973,cval_part_p_brand#3974,cdepval_part_p_name#3975,cdepval_part_p_mfgr#3976,cdepval_part_p_type#3977,cdepval_part_p_size#3978,cdepval_part_p_container#3979,cdepval_part_p_retailprice#3980,cdepval_part_p_comment#3981,cdepval_part_p_brand#3982,cp_name#3983,cp_mfgr#3984,cp_type#3985,cp_size#3986,cp_container#3987,cp_retailprice#3988,cp_comment#3989,cp_brand#3990] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#4256 AS rid_1#4301, cpfk_orders_lineitem#4257 AS cpfk_orders_lineitem_1#4302, cpfk_supplier_lineitem#4258 AS cpfk_supplier_lineitem_1#4303, cfpk_lineitem_supplier#4259 AS cfpk_lineitem_supplier_1#4304, cfpk_lineitem_partsupp#4260 AS cfpk_lineitem_partsupp_1#4305, cpfk_part_lineitem#4261 AS cpfk_part_lineitem_1#4306, cfpk_lineitem_part#4262 AS cfpk_lineitem_part_1#4307, cpfk_partsupp_lineitem#4263 AS cpfk_partsupp_lineitem_1#4308, cfpk_lineitem_orders#4264 AS cfpk_lineitem_orders_1#4309, cval_lineitem_l_quantity#4265 AS cval_lineitem_l_quantity_1#4310, cval_lineitem_l_extendedprice#4266 AS cval_lineitem_l_extendedprice_1#4311, cval_lineitem_l_discount#4267 AS cval_lineitem_l_discount_1#4312, cval_lineitem_l_tax#4268 AS cval_lineitem_l_tax_1#4313, cval_lineitem_l_returnflag#4269 AS cval_lineitem_l_returnflag_1#4314, cval_lineitem_l_linestatus#4270 AS cval_lineitem_l_linestatus_1#4315, cval_lineitem_l_commitdate#4271 AS cval_lineitem_l_commitdate_1#4316, cval_lineitem_l_receiptdate#4272 AS cval_lineitem_l_receiptdate_1#4317, cval_lineitem_l_shipinstruct#4273 AS cval_lineitem_l_shipinstruct_1#4318, cval_lineitem_l_shipmode#4274 AS cval_lineitem_l_shipmode_1#4319, cval_lineitem_l_comment#4275 AS cval_lineitem_l_comment_1#4320, cval_lineitem_l_shipdate#4276 AS cval_lineitem_l_shipdate_1#4321, cdepval_lineitem_l_quantity#4277 AS cdepval_lineitem_l_quantity_1#4322, cdepval_lineitem_l_extendedprice#4278 AS cdepval_lineitem_l_extendedprice_1#4323, cdepval_lineitem_l_discount#4279 AS cdepval_lineitem_l_discount_1#4324, ... 21 more fields]
         :        +- Relation[rid#4256,cpfk_orders_lineitem#4257,cpfk_supplier_lineitem#4258,cfpk_lineitem_supplier#4259,cfpk_lineitem_partsupp#4260,cpfk_part_lineitem#4261,cfpk_lineitem_part#4262,cpfk_partsupp_lineitem#4263,cfpk_lineitem_orders#4264,cval_lineitem_l_quantity#4265,cval_lineitem_l_extendedprice#4266,cval_lineitem_l_discount#4267,cval_lineitem_l_tax#4268,cval_lineitem_l_returnflag#4269,cval_lineitem_l_linestatus#4270,cval_lineitem_l_commitdate#4271,cval_lineitem_l_receiptdate#4272,cval_lineitem_l_shipinstruct#4273,cval_lineitem_l_shipmode#4274,cval_lineitem_l_comment#4275,cval_lineitem_l_shipdate#4276,cdepval_lineitem_l_quantity#4277,cdepval_lineitem_l_extendedprice#4278,cdepval_lineitem_l_discount#4279,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4116 AS rid_1#4161, cpfk_orders_lineitem#4117 AS cpfk_orders_lineitem_1#4162, cpfk_supplier_lineitem#4118 AS cpfk_supplier_lineitem_1#4163, cfpk_lineitem_supplier#4119 AS cfpk_lineitem_supplier_1#4164, cfpk_lineitem_partsupp#4120 AS cfpk_lineitem_partsupp_1#4165, cpfk_part_lineitem#4121 AS cpfk_part_lineitem_1#4166, cfpk_lineitem_part#4122 AS cfpk_lineitem_part_1#4167, cpfk_partsupp_lineitem#4123 AS cpfk_partsupp_lineitem_1#4168, cfpk_lineitem_orders#4124 AS cfpk_lineitem_orders_1#4169, cval_lineitem_l_quantity#4125 AS cval_lineitem_l_quantity_1#4170, cval_lineitem_l_extendedprice#4126 AS cval_lineitem_l_extendedprice_1#4171, cval_lineitem_l_discount#4127 AS cval_lineitem_l_discount_1#4172, cval_lineitem_l_tax#4128 AS cval_lineitem_l_tax_1#4173, cval_lineitem_l_returnflag#4129 AS cval_lineitem_l_returnflag_1#4174, cval_lineitem_l_linestatus#4130 AS cval_lineitem_l_linestatus_1#4175, cval_lineitem_l_commitdate#4131 AS cval_lineitem_l_commitdate_1#4176, cval_lineitem_l_receiptdate#4132 AS cval_lineitem_l_receiptdate_1#4177, cval_lineitem_l_shipinstruct#4133 AS cval_lineitem_l_shipinstruct_1#4178, cval_lineitem_l_shipmode#4134 AS cval_lineitem_l_shipmode_1#4179, cval_lineitem_l_comment#4135 AS cval_lineitem_l_comment_1#4180, cval_lineitem_l_shipdate#4136 AS cval_lineitem_l_shipdate_1#4181, cdepval_lineitem_l_quantity#4137 AS cdepval_lineitem_l_quantity_1#4182, cdepval_lineitem_l_extendedprice#4138 AS cdepval_lineitem_l_extendedprice_1#4183, cdepval_lineitem_l_discount#4139 AS cdepval_lineitem_l_discount_1#4184, ... 21 more fields]
            +- Relation[rid#4116,cpfk_orders_lineitem#4117,cpfk_supplier_lineitem#4118,cfpk_lineitem_supplier#4119,cfpk_lineitem_partsupp#4120,cpfk_part_lineitem#4121,cfpk_lineitem_part#4122,cpfk_partsupp_lineitem#4123,cfpk_lineitem_orders#4124,cval_lineitem_l_quantity#4125,cval_lineitem_l_extendedprice#4126,cval_lineitem_l_discount#4127,cval_lineitem_l_tax#4128,cval_lineitem_l_returnflag#4129,cval_lineitem_l_linestatus#4130,cval_lineitem_l_commitdate#4131,cval_lineitem_l_receiptdate#4132,cval_lineitem_l_shipinstruct#4133,cval_lineitem_l_shipmode#4134,cval_lineitem_l_comment#4135,cval_lineitem_l_shipdate#4136,cdepval_lineitem_l_quantity#4137,cdepval_lineitem_l_extendedprice#4138,cdepval_lineitem_l_discount#4139,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 520ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/26 21:13:10 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:13:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4421L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:13:10 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:13:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4421L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#4448, cval_part_p_name_0#4449, cval_part_p_mfgr_0#4450, cval_part_p_type_0#4451, cval_part_p_size_0#4452, cval_part_p_container_0#4453, cval_part_p_retailprice_0#4454, cval_part_p_comment_0#4455, cval_part_p_brand_0#4456, cdepval_part_p_name_0#4457, cdepval_part_p_mfgr_0#4458, cdepval_part_p_type_0#4459, cdepval_part_p_size_0#4460, cdepval_part_p_container_0#4461, cdepval_part_p_retailprice_0#4462, cdepval_part_p_comment_0#4463, cdepval_part_p_brand_0#4464, cp_name_0#4465, cp_mfgr_0#4466, cp_type_0#4467, cp_size_0#4468, cp_container_0#4469, cp_retailprice_0#4470, cp_comment_0#4471, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  :  +- Project [rid#4423 AS rid_0#4448, cval_part_p_name#4424 AS cval_part_p_name_0#4449, cval_part_p_mfgr#4425 AS cval_part_p_mfgr_0#4450, cval_part_p_type#4426 AS cval_part_p_type_0#4451, cval_part_p_size#4427 AS cval_part_p_size_0#4452, cval_part_p_container#4428 AS cval_part_p_container_0#4453, cval_part_p_retailprice#4429 AS cval_part_p_retailprice_0#4454, cval_part_p_comment#4430 AS cval_part_p_comment_0#4455, cval_part_p_brand#4431 AS cval_part_p_brand_0#4456, cdepval_part_p_name#4432 AS cdepval_part_p_name_0#4457, cdepval_part_p_mfgr#4433 AS cdepval_part_p_mfgr_0#4458, cdepval_part_p_type#4434 AS cdepval_part_p_type_0#4459, cdepval_part_p_size#4435 AS cdepval_part_p_size_0#4460, cdepval_part_p_container#4436 AS cdepval_part_p_container_0#4461, cdepval_part_p_retailprice#4437 AS cdepval_part_p_retailprice_0#4462, cdepval_part_p_comment#4438 AS cdepval_part_p_comment_0#4463, cdepval_part_p_brand#4439 AS cdepval_part_p_brand_0#4464, cp_name#4440 AS cp_name_0#4465, cp_mfgr#4441 AS cp_mfgr_0#4466, cp_type#4442 AS cp_type_0#4467, cp_size#4443 AS cp_size_0#4468, cp_container#4444 AS cp_container_0#4469, cp_retailprice#4445 AS cp_retailprice_0#4470, cp_comment#4446 AS cp_comment_0#4471, cp_brand#4447 AS cp_brand_0#4472]
         :  :  :     +- Relation[rid#4423,cval_part_p_name#4424,cval_part_p_mfgr#4425,cval_part_p_type#4426,cval_part_p_size#4427,cval_part_p_container#4428,cval_part_p_retailprice#4429,cval_part_p_comment#4430,cval_part_p_brand#4431,cdepval_part_p_name#4432,cdepval_part_p_mfgr#4433,cdepval_part_p_type#4434,cdepval_part_p_size#4435,cdepval_part_p_container#4436,cdepval_part_p_retailprice#4437,cdepval_part_p_comment#4438,cdepval_part_p_brand#4439,cp_name#4440,cp_mfgr#4441,cp_type#4442,cp_size#4443,cp_container#4444,cp_retailprice#4445,cp_comment#4446,cp_brand#4447] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :  :     +- Project [rid#4601 AS rid_1#4615, cpfk_part_partsupp#4602 AS cpfk_part_partsupp_1#4616, cfpk_partsupp_part#4603 AS cfpk_partsupp_part_1#4617, cpfk_supplier_partsupp#4604 AS cpfk_supplier_partsupp_1#4618, cfpk_partsupp_supplier#4605 AS cfpk_partsupp_supplier_1#4619, cval_partsupp_ps_availqty#4606 AS cval_partsupp_ps_availqty_1#4620, cval_partsupp_ps_supplycost#4607 AS cval_partsupp_ps_supplycost_1#4621, cval_partsupp_ps_comment#4608 AS cval_partsupp_ps_comment_1#4622, cdepval_partsupp_ps_availqty#4609 AS cdepval_partsupp_ps_availqty_1#4623, cdepval_partsupp_ps_supplycost#4610 AS cdepval_partsupp_ps_supplycost_1#4624, cdepval_partsupp_ps_comment#4611 AS cdepval_partsupp_ps_comment_1#4625, cps_availqty#4612 AS cps_availqty_1#4626, cps_supplycost#4613 AS cps_supplycost_1#4627, cps_comment#4614 AS cps_comment_1#4628]
         :  :        +- Relation[rid#4601,cpfk_part_partsupp#4602,cfpk_partsupp_part#4603,cpfk_supplier_partsupp#4604,cfpk_partsupp_supplier#4605,cval_partsupp_ps_availqty#4606,cval_partsupp_ps_supplycost#4607,cval_partsupp_ps_comment#4608,cdepval_partsupp_ps_availqty#4609,cdepval_partsupp_ps_supplycost#4610,cdepval_partsupp_ps_comment#4611,cps_availqty#4612,cps_supplycost#4613,cps_comment#4614] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#4523 AS rid_1#4537, cpfk_part_partsupp#4524 AS cpfk_part_partsupp_1#4538, cfpk_partsupp_part#4525 AS cfpk_partsupp_part_1#4539, cpfk_supplier_partsupp#4526 AS cpfk_supplier_partsupp_1#4540, cfpk_partsupp_supplier#4527 AS cfpk_partsupp_supplier_1#4541, cval_partsupp_ps_availqty#4528 AS cval_partsupp_ps_availqty_1#4542, cval_partsupp_ps_supplycost#4529 AS cval_partsupp_ps_supplycost_1#4543, cval_partsupp_ps_comment#4530 AS cval_partsupp_ps_comment_1#4544, cdepval_partsupp_ps_availqty#4531 AS cdepval_partsupp_ps_availqty_1#4545, cdepval_partsupp_ps_supplycost#4532 AS cdepval_partsupp_ps_supplycost_1#4546, cdepval_partsupp_ps_comment#4533 AS cdepval_partsupp_ps_comment_1#4547, cps_availqty#4534 AS cps_availqty_1#4548, cps_supplycost#4535 AS cps_supplycost_1#4549, cps_comment#4536 AS cps_comment_1#4550]
         :     +- Relation[rid#4523,cpfk_part_partsupp#4524,cfpk_partsupp_part#4525,cpfk_supplier_partsupp#4526,cfpk_partsupp_supplier#4527,cval_partsupp_ps_availqty#4528,cval_partsupp_ps_supplycost#4529,cval_partsupp_ps_comment#4530,cdepval_partsupp_ps_availqty#4531,cdepval_partsupp_ps_supplycost#4532,cdepval_partsupp_ps_comment#4533,cps_availqty#4534,cps_supplycost#4535,cps_comment#4536] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_2, NotMaterialized, NotMaterialized, [rid_2#4638, cpfk_region_nation_2#4639, cfpk_nation_region_2#4640, cval_nation_n_name_2#4641, cval_nation_n_comment_2#4642, cdepval_nation_n_name_2#4643, cdepval_nation_n_comment_2#4644, cn_name_2#4645, cn_comment_2#4646, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
            :  :  +- Project [rid#4629 AS rid_2#4638, cpfk_region_nation#4630 AS cpfk_region_nation_2#4639, cfpk_nation_region#4631 AS cfpk_nation_region_2#4640, cval_nation_n_name#4632 AS cval_nation_n_name_2#4641, cval_nation_n_comment#4633 AS cval_nation_n_comment_2#4642, cdepval_nation_n_name#4634 AS cdepval_nation_n_name_2#4643, cdepval_nation_n_comment#4635 AS cdepval_nation_n_comment_2#4644, cn_name#4636 AS cn_name_2#4645, cn_comment#4637 AS cn_comment_2#4646]
            :  :     +- Relation[rid#4629,cpfk_region_nation#4630,cfpk_nation_region#4631,cval_nation_n_name#4632,cval_nation_n_comment#4633,cdepval_nation_n_name#4634,cdepval_nation_n_comment#4635,cn_name#4636,cn_comment#4637] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#4719 AS rid_3#4737, cpfk_nation_supplier#4720 AS cpfk_nation_supplier_3#4738, cfpk_supplier_nation#4721 AS cfpk_supplier_nation_3#4739, cval_supplier_s_name#4722 AS cval_supplier_s_name_3#4740, cval_supplier_s_address#4723 AS cval_supplier_s_address_3#4741, cval_supplier_s_phone#4724 AS cval_supplier_s_phone_3#4742, cval_supplier_s_acctbal#4725 AS cval_supplier_s_acctbal_3#4743, cval_supplier_s_comment#4726 AS cval_supplier_s_comment_3#4744, cdepval_supplier_s_name#4727 AS cdepval_supplier_s_name_3#4745, cdepval_supplier_s_address#4728 AS cdepval_supplier_s_address_3#4746, cdepval_supplier_s_phone#4729 AS cdepval_supplier_s_phone_3#4747, cdepval_supplier_s_acctbal#4730 AS cdepval_supplier_s_acctbal_3#4748, cdepval_supplier_s_comment#4731 AS cdepval_supplier_s_comment_3#4749, cs_name#4732 AS cs_name_3#4750, cs_address#4733 AS cs_address_3#4751, cs_phone#4734 AS cs_phone_3#4752, cs_acctbal#4735 AS cs_acctbal_3#4753, cs_comment#4736 AS cs_comment_3#4754]
            :        +- Relation[rid#4719,cpfk_nation_supplier#4720,cfpk_supplier_nation#4721,cval_supplier_s_name#4722,cval_supplier_s_address#4723,cval_supplier_s_phone#4724,cval_supplier_s_acctbal#4725,cval_supplier_s_comment#4726,cdepval_supplier_s_name#4727,cdepval_supplier_s_address#4728,cdepval_supplier_s_phone#4729,cdepval_supplier_s_acctbal#4730,cdepval_supplier_s_comment#4731,cs_name#4732,cs_address#4733,cs_phone#4734,cs_acctbal#4735,cs_comment#4736] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#4665 AS rid_3#4683, cpfk_nation_supplier#4666 AS cpfk_nation_supplier_3#4684, cfpk_supplier_nation#4667 AS cfpk_supplier_nation_3#4685, cval_supplier_s_name#4668 AS cval_supplier_s_name_3#4686, cval_supplier_s_address#4669 AS cval_supplier_s_address_3#4687, cval_supplier_s_phone#4670 AS cval_supplier_s_phone_3#4688, cval_supplier_s_acctbal#4671 AS cval_supplier_s_acctbal_3#4689, cval_supplier_s_comment#4672 AS cval_supplier_s_comment_3#4690, cdepval_supplier_s_name#4673 AS cdepval_supplier_s_name_3#4691, cdepval_supplier_s_address#4674 AS cdepval_supplier_s_address_3#4692, cdepval_supplier_s_phone#4675 AS cdepval_supplier_s_phone_3#4693, cdepval_supplier_s_acctbal#4676 AS cdepval_supplier_s_acctbal_3#4694, cdepval_supplier_s_comment#4677 AS cdepval_supplier_s_comment_3#4695, cs_name#4678 AS cs_name_3#4696, cs_address#4679 AS cs_address_3#4697, cs_phone#4680 AS cs_phone_3#4698, cs_acctbal#4681 AS cs_acctbal_3#4699, cs_comment#4682 AS cs_comment_3#4700]
               +- Relation[rid#4665,cpfk_nation_supplier#4666,cfpk_supplier_nation#4667,cval_supplier_s_name#4668,cval_supplier_s_address#4669,cval_supplier_s_phone#4670,cval_supplier_s_acctbal#4671,cval_supplier_s_comment#4672,cdepval_supplier_s_name#4673,cdepval_supplier_s_address#4674,cdepval_supplier_s_phone#4675,cdepval_supplier_s_acctbal#4676,cdepval_supplier_s_comment#4677,cs_name#4678,cs_address#4679,cs_phone#4680,cs_acctbal#4681,cs_comment#4682] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 5523ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/26 21:13:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:13:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4828L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:13:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:13:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:13:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:13:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:13:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:13:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:13:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:13:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:13:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:13:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:13:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:13:16 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:13:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:13:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:13:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4828L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#4855, cval_part_p_name_0#4856, cval_part_p_mfgr_0#4857, cval_part_p_type_0#4858, cval_part_p_size_0#4859, cval_part_p_container_0#4860, cval_part_p_retailprice_0#4861, cval_part_p_comment_0#4862, cval_part_p_brand_0#4863, cdepval_part_p_name_0#4864, cdepval_part_p_mfgr_0#4865, cdepval_part_p_type_0#4866, cdepval_part_p_size_0#4867, cdepval_part_p_container_0#4868, cdepval_part_p_retailprice_0#4869, cdepval_part_p_comment_0#4870, cdepval_part_p_brand_0#4871, cp_name_0#4872, cp_mfgr_0#4873, cp_type_0#4874, cp_size_0#4875, cp_container_0#4876, cp_retailprice_0#4877, cp_comment_0#4878, ... 2 more fields]
         :  :  :  :  :- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :  :  :  +- Project [rid#4830 AS rid_0#4855, cval_part_p_name#4831 AS cval_part_p_name_0#4856, cval_part_p_mfgr#4832 AS cval_part_p_mfgr_0#4857, cval_part_p_type#4833 AS cval_part_p_type_0#4858, cval_part_p_size#4834 AS cval_part_p_size_0#4859, cval_part_p_container#4835 AS cval_part_p_container_0#4860, cval_part_p_retailprice#4836 AS cval_part_p_retailprice_0#4861, cval_part_p_comment#4837 AS cval_part_p_comment_0#4862, cval_part_p_brand#4838 AS cval_part_p_brand_0#4863, cdepval_part_p_name#4839 AS cdepval_part_p_name_0#4864, cdepval_part_p_mfgr#4840 AS cdepval_part_p_mfgr_0#4865, cdepval_part_p_type#4841 AS cdepval_part_p_type_0#4866, cdepval_part_p_size#4842 AS cdepval_part_p_size_0#4867, cdepval_part_p_container#4843 AS cdepval_part_p_container_0#4868, cdepval_part_p_retailprice#4844 AS cdepval_part_p_retailprice_0#4869, cdepval_part_p_comment#4845 AS cdepval_part_p_comment_0#4870, cdepval_part_p_brand#4846 AS cdepval_part_p_brand_0#4871, cp_name#4847 AS cp_name_0#4872, cp_mfgr#4848 AS cp_mfgr_0#4873, cp_type#4849 AS cp_type_0#4874, cp_size#4850 AS cp_size_0#4875, cp_container#4851 AS cp_container_0#4876, cp_retailprice#4852 AS cp_retailprice_0#4877, cp_comment#4853 AS cp_comment_0#4878, cp_brand#4854 AS cp_brand_0#4879]
         :  :  :  :  :     +- Relation[rid#4830,cval_part_p_name#4831,cval_part_p_mfgr#4832,cval_part_p_type#4833,cval_part_p_size#4834,cval_part_p_container#4835,cval_part_p_retailprice#4836,cval_part_p_comment#4837,cval_part_p_brand#4838,cdepval_part_p_name#4839,cdepval_part_p_mfgr#4840,cdepval_part_p_type#4841,cdepval_part_p_size#4842,cdepval_part_p_container#4843,cdepval_part_p_retailprice#4844,cdepval_part_p_comment#4845,cdepval_part_p_brand#4846,cp_name#4847,cp_mfgr#4848,cp_type#4849,cp_size#4850,cp_container#4851,cp_retailprice#4852,cp_comment#4853,cp_brand#4854] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :  :  :  :     +- Project [rid#5070 AS rid_1#5115, cpfk_orders_lineitem#5071 AS cpfk_orders_lineitem_1#5116, cpfk_supplier_lineitem#5072 AS cpfk_supplier_lineitem_1#5117, cfpk_lineitem_supplier#5073 AS cfpk_lineitem_supplier_1#5118, cfpk_lineitem_partsupp#5074 AS cfpk_lineitem_partsupp_1#5119, cpfk_part_lineitem#5075 AS cpfk_part_lineitem_1#5120, cfpk_lineitem_part#5076 AS cfpk_lineitem_part_1#5121, cpfk_partsupp_lineitem#5077 AS cpfk_partsupp_lineitem_1#5122, cfpk_lineitem_orders#5078 AS cfpk_lineitem_orders_1#5123, cval_lineitem_l_quantity#5079 AS cval_lineitem_l_quantity_1#5124, cval_lineitem_l_extendedprice#5080 AS cval_lineitem_l_extendedprice_1#5125, cval_lineitem_l_discount#5081 AS cval_lineitem_l_discount_1#5126, cval_lineitem_l_tax#5082 AS cval_lineitem_l_tax_1#5127, cval_lineitem_l_returnflag#5083 AS cval_lineitem_l_returnflag_1#5128, cval_lineitem_l_linestatus#5084 AS cval_lineitem_l_linestatus_1#5129, cval_lineitem_l_commitdate#5085 AS cval_lineitem_l_commitdate_1#5130, cval_lineitem_l_receiptdate#5086 AS cval_lineitem_l_receiptdate_1#5131, cval_lineitem_l_shipinstruct#5087 AS cval_lineitem_l_shipinstruct_1#5132, cval_lineitem_l_shipmode#5088 AS cval_lineitem_l_shipmode_1#5133, cval_lineitem_l_comment#5089 AS cval_lineitem_l_comment_1#5134, cval_lineitem_l_shipdate#5090 AS cval_lineitem_l_shipdate_1#5135, cdepval_lineitem_l_quantity#5091 AS cdepval_lineitem_l_quantity_1#5136, cdepval_lineitem_l_extendedprice#5092 AS cdepval_lineitem_l_extendedprice_1#5137, cdepval_lineitem_l_discount#5093 AS cdepval_lineitem_l_discount_1#5138, ... 21 more fields]
         :  :  :  :        +- Relation[rid#5070,cpfk_orders_lineitem#5071,cpfk_supplier_lineitem#5072,cfpk_lineitem_supplier#5073,cfpk_lineitem_partsupp#5074,cpfk_part_lineitem#5075,cfpk_lineitem_part#5076,cpfk_partsupp_lineitem#5077,cfpk_lineitem_orders#5078,cval_lineitem_l_quantity#5079,cval_lineitem_l_extendedprice#5080,cval_lineitem_l_discount#5081,cval_lineitem_l_tax#5082,cval_lineitem_l_returnflag#5083,cval_lineitem_l_linestatus#5084,cval_lineitem_l_commitdate#5085,cval_lineitem_l_receiptdate#5086,cval_lineitem_l_shipinstruct#5087,cval_lineitem_l_shipmode#5088,cval_lineitem_l_comment#5089,cval_lineitem_l_shipdate#5090,cdepval_lineitem_l_quantity#5091,cdepval_lineitem_l_extendedprice#5092,cdepval_lineitem_l_discount#5093,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- Project [rid#4930 AS rid_1#4975, cpfk_orders_lineitem#4931 AS cpfk_orders_lineitem_1#4976, cpfk_supplier_lineitem#4932 AS cpfk_supplier_lineitem_1#4977, cfpk_lineitem_supplier#4933 AS cfpk_lineitem_supplier_1#4978, cfpk_lineitem_partsupp#4934 AS cfpk_lineitem_partsupp_1#4979, cpfk_part_lineitem#4935 AS cpfk_part_lineitem_1#4980, cfpk_lineitem_part#4936 AS cfpk_lineitem_part_1#4981, cpfk_partsupp_lineitem#4937 AS cpfk_partsupp_lineitem_1#4982, cfpk_lineitem_orders#4938 AS cfpk_lineitem_orders_1#4983, cval_lineitem_l_quantity#4939 AS cval_lineitem_l_quantity_1#4984, cval_lineitem_l_extendedprice#4940 AS cval_lineitem_l_extendedprice_1#4985, cval_lineitem_l_discount#4941 AS cval_lineitem_l_discount_1#4986, cval_lineitem_l_tax#4942 AS cval_lineitem_l_tax_1#4987, cval_lineitem_l_returnflag#4943 AS cval_lineitem_l_returnflag_1#4988, cval_lineitem_l_linestatus#4944 AS cval_lineitem_l_linestatus_1#4989, cval_lineitem_l_commitdate#4945 AS cval_lineitem_l_commitdate_1#4990, cval_lineitem_l_receiptdate#4946 AS cval_lineitem_l_receiptdate_1#4991, cval_lineitem_l_shipinstruct#4947 AS cval_lineitem_l_shipinstruct_1#4992, cval_lineitem_l_shipmode#4948 AS cval_lineitem_l_shipmode_1#4993, cval_lineitem_l_comment#4949 AS cval_lineitem_l_comment_1#4994, cval_lineitem_l_shipdate#4950 AS cval_lineitem_l_shipdate_1#4995, cdepval_lineitem_l_quantity#4951 AS cdepval_lineitem_l_quantity_1#4996, cdepval_lineitem_l_extendedprice#4952 AS cdepval_lineitem_l_extendedprice_1#4997, cdepval_lineitem_l_discount#4953 AS cdepval_lineitem_l_discount_1#4998, ... 21 more fields]
         :  :  :     +- Relation[rid#4930,cpfk_orders_lineitem#4931,cpfk_supplier_lineitem#4932,cfpk_lineitem_supplier#4933,cfpk_lineitem_partsupp#4934,cpfk_part_lineitem#4935,cfpk_lineitem_part#4936,cpfk_partsupp_lineitem#4937,cfpk_lineitem_orders#4938,cval_lineitem_l_quantity#4939,cval_lineitem_l_extendedprice#4940,cval_lineitem_l_discount#4941,cval_lineitem_l_tax#4942,cval_lineitem_l_returnflag#4943,cval_lineitem_l_linestatus#4944,cval_lineitem_l_commitdate#4945,cval_lineitem_l_receiptdate#4946,cval_lineitem_l_shipinstruct#4947,cval_lineitem_l_shipmode#4948,cval_lineitem_l_comment#4949,cval_lineitem_l_shipdate#4950,cdepval_lineitem_l_quantity#4951,cdepval_lineitem_l_extendedprice#4952,cdepval_lineitem_l_discount#4953,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#5160 AS rid_2#5178, cpfk_nation_supplier#5161 AS cpfk_nation_supplier_2#5179, cfpk_supplier_nation#5162 AS cfpk_supplier_nation_2#5180, cval_supplier_s_name#5163 AS cval_supplier_s_name_2#5181, cval_supplier_s_address#5164 AS cval_supplier_s_address_2#5182, cval_supplier_s_phone#5165 AS cval_supplier_s_phone_2#5183, cval_supplier_s_acctbal#5166 AS cval_supplier_s_acctbal_2#5184, cval_supplier_s_comment#5167 AS cval_supplier_s_comment_2#5185, cdepval_supplier_s_name#5168 AS cdepval_supplier_s_name_2#5186, cdepval_supplier_s_address#5169 AS cdepval_supplier_s_address_2#5187, cdepval_supplier_s_phone#5170 AS cdepval_supplier_s_phone_2#5188, cdepval_supplier_s_acctbal#5171 AS cdepval_supplier_s_acctbal_2#5189, cdepval_supplier_s_comment#5172 AS cdepval_supplier_s_comment_2#5190, cs_name#5173 AS cs_name_2#5191, cs_address#5174 AS cs_address_2#5192, cs_phone#5175 AS cs_phone_2#5193, cs_acctbal#5176 AS cs_acctbal_2#5194, cs_comment#5177 AS cs_comment_2#5195]
         :  :     +- Relation[rid#5160,cpfk_nation_supplier#5161,cfpk_supplier_nation#5162,cval_supplier_s_name#5163,cval_supplier_s_address#5164,cval_supplier_s_phone#5165,cval_supplier_s_acctbal#5166,cval_supplier_s_comment#5167,cdepval_supplier_s_name#5168,cdepval_supplier_s_address#5169,cdepval_supplier_s_phone#5170,cdepval_supplier_s_acctbal#5171,cdepval_supplier_s_comment#5172,cs_name#5173,cs_address#5174,cs_phone#5175,cs_acctbal#5176,cs_comment#5177] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#5196 AS rid_3#5205, cpfk_region_nation#5197 AS cpfk_region_nation_3#5206, cfpk_nation_region#5198 AS cfpk_nation_region_3#5207, cval_nation_n_name#5199 AS cval_nation_n_name_3#5208, cval_nation_n_comment#5200 AS cval_nation_n_comment_3#5209, cdepval_nation_n_name#5201 AS cdepval_nation_n_name_3#5210, cdepval_nation_n_comment#5202 AS cdepval_nation_n_comment_3#5211, cn_name#5203 AS cn_name_3#5212, cn_comment#5204 AS cn_comment_3#5213]
         :     +- Relation[rid#5196,cpfk_region_nation#5197,cfpk_nation_region#5198,cval_nation_n_name#5199,cval_nation_n_comment#5200,cdepval_nation_n_name#5201,cdepval_nation_n_comment#5202,cn_name#5203,cn_comment#5204] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#5334 AS rid_7#5358, cpfk_customer_orders#5335 AS cpfk_customer_orders_7#5359, cfpk_orders_customer#5336 AS cfpk_orders_customer_7#5360, cval_orders_o_orderstatus#5337 AS cval_orders_o_orderstatus_7#5361, cval_orders_o_totalprice#5338 AS cval_orders_o_totalprice_7#5362, cval_orders_o_orderpriority#5339 AS cval_orders_o_orderpriority_7#5363, cval_orders_o_clerk#5340 AS cval_orders_o_clerk_7#5364, cval_orders_o_shippriority#5341 AS cval_orders_o_shippriority_7#5365, cval_orders_o_comment#5342 AS cval_orders_o_comment_7#5366, cval_orders_o_orderdate#5343 AS cval_orders_o_orderdate_7#5367, cdepval_orders_o_orderstatus#5344 AS cdepval_orders_o_orderstatus_7#5368, cdepval_orders_o_totalprice#5345 AS cdepval_orders_o_totalprice_7#5369, cdepval_orders_o_orderpriority#5346 AS cdepval_orders_o_orderpriority_7#5370, cdepval_orders_o_clerk#5347 AS cdepval_orders_o_clerk_7#5371, cdepval_orders_o_shippriority#5348 AS cdepval_orders_o_shippriority_7#5372, cdepval_orders_o_comment#5349 AS cdepval_orders_o_comment_7#5373, cdepval_orders_o_orderdate#5350 AS cdepval_orders_o_orderdate_7#5374, co_orderstatus#5351 AS co_orderstatus_7#5375, co_totalprice#5352 AS co_totalprice_7#5376, co_orderpriority#5353 AS co_orderpriority_7#5377, co_clerk#5354 AS co_clerk_7#5378, co_shippriority#5355 AS co_shippriority_7#5379, co_comment#5356 AS co_comment_7#5380, co_orderdate#5357 AS co_orderdate_7#5381]
            :  +- Relation[rid#5334,cpfk_customer_orders#5335,cfpk_orders_customer#5336,cval_orders_o_orderstatus#5337,cval_orders_o_totalprice#5338,cval_orders_o_orderpriority#5339,cval_orders_o_clerk#5340,cval_orders_o_shippriority#5341,cval_orders_o_comment#5342,cval_orders_o_orderdate#5343,cdepval_orders_o_orderstatus#5344,cdepval_orders_o_totalprice#5345,cdepval_orders_o_orderpriority#5346,cdepval_orders_o_clerk#5347,cdepval_orders_o_shippriority#5348,cdepval_orders_o_comment#5349,cdepval_orders_o_orderdate#5350,co_orderstatus#5351,co_totalprice#5352,co_orderpriority#5353,co_clerk#5354,co_shippriority#5355,co_comment#5356,co_orderdate#5357] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#5292 AS rid_6#5313, cpfk_nation_customer#5293 AS cpfk_nation_customer_6#5314, cfpk_customer_nation#5294 AS cfpk_customer_nation_6#5315, cval_customer_c_name#5295 AS cval_customer_c_name_6#5316, cval_customer_c_address#5296 AS cval_customer_c_address_6#5317, cval_customer_c_phone#5297 AS cval_customer_c_phone_6#5318, cval_customer_c_acctbal#5298 AS cval_customer_c_acctbal_6#5319, cval_customer_c_comment#5299 AS cval_customer_c_comment_6#5320, cval_customer_c_mktsegment#5300 AS cval_customer_c_mktsegment_6#5321, cdepval_customer_c_name#5301 AS cdepval_customer_c_name_6#5322, cdepval_customer_c_address#5302 AS cdepval_customer_c_address_6#5323, cdepval_customer_c_phone#5303 AS cdepval_customer_c_phone_6#5324, cdepval_customer_c_acctbal#5304 AS cdepval_customer_c_acctbal_6#5325, cdepval_customer_c_comment#5305 AS cdepval_customer_c_comment_6#5326, cdepval_customer_c_mktsegment#5306 AS cdepval_customer_c_mktsegment_6#5327, cc_name#5307 AS cc_name_6#5328, cc_address#5308 AS cc_address_6#5329, cc_phone#5309 AS cc_phone_6#5330, cc_acctbal#5310 AS cc_acctbal_6#5331, cc_comment#5311 AS cc_comment_6#5332, cc_mktsegment#5312 AS cc_mktsegment_6#5333]
               :  +- Relation[rid#5292,cpfk_nation_customer#5293,cfpk_customer_nation#5294,cval_customer_c_name#5295,cval_customer_c_address#5296,cval_customer_c_phone#5297,cval_customer_c_acctbal#5298,cval_customer_c_comment#5299,cval_customer_c_mktsegment#5300,cdepval_customer_c_name#5301,cdepval_customer_c_address#5302,cdepval_customer_c_phone#5303,cdepval_customer_c_acctbal#5304,cdepval_customer_c_comment#5305,cdepval_customer_c_mktsegment#5306,cc_name#5307,cc_address#5308,cc_phone#5309,cc_acctbal#5310,cc_comment#5311,cc_mktsegment#5312] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join UsingJoin(Inner,List(rid_5))
                  :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_5, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#5221, cval_region_r_name_4#5222, cval_region_r_comment_4#5223, cdepval_region_r_name_4#5224, cdepval_region_r_comment_4#5225, cr_name_4#5226, cr_comment_4#5227, 'rid_5]
                  :  :- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                  :  :  +- Project [rid#5214 AS rid_4#5221, cval_region_r_name#5215 AS cval_region_r_name_4#5222, cval_region_r_comment#5216 AS cval_region_r_comment_4#5223, cdepval_region_r_name#5217 AS cdepval_region_r_name_4#5224, cdepval_region_r_comment#5218 AS cdepval_region_r_comment_4#5225, cr_name#5219 AS cr_name_4#5226, cr_comment#5220 AS cr_comment_4#5227]
                  :  :     +- Relation[rid#5214,cval_region_r_name#5215,cval_region_r_comment#5216,cdepval_region_r_name#5217,cdepval_region_r_comment#5218,cr_name#5219,cr_comment#5220] JDBCRelation(tregion) [numPartitions=1]
                  :  +- 'Project ['cpfk_region_nation_5, 'rid_5]
                  :     +- Project [rid#5274 AS rid_5#5283, cpfk_region_nation#5275 AS cpfk_region_nation_5#5284, cfpk_nation_region#5276 AS cfpk_nation_region_5#5285, cval_nation_n_name#5277 AS cval_nation_n_name_5#5286, cval_nation_n_comment#5278 AS cval_nation_n_comment_5#5287, cdepval_nation_n_name#5279 AS cdepval_nation_n_name_5#5288, cdepval_nation_n_comment#5280 AS cdepval_nation_n_comment_5#5289, cn_name#5281 AS cn_name_5#5290, cn_comment#5282 AS cn_comment_5#5291]
                  :        +- Relation[rid#5274,cpfk_region_nation#5275,cfpk_nation_region#5276,cval_nation_n_name#5277,cval_nation_n_comment#5278,cdepval_nation_n_name#5279,cdepval_nation_n_comment#5280,cn_name#5281,cn_comment#5282] JDBCRelation(tnation) [numPartitions=1]
                  +- Project [rid#5242 AS rid_5#5251, cpfk_region_nation#5243 AS cpfk_region_nation_5#5252, cfpk_nation_region#5244 AS cfpk_nation_region_5#5253, cval_nation_n_name#5245 AS cval_nation_n_name_5#5254, cval_nation_n_comment#5246 AS cval_nation_n_comment_5#5255, cdepval_nation_n_name#5247 AS cdepval_nation_n_name_5#5256, cdepval_nation_n_comment#5248 AS cdepval_nation_n_comment_5#5257, cn_name#5249 AS cn_name_5#5258, cn_comment#5250 AS cn_comment_5#5259]
                     +- Relation[rid#5242,cpfk_region_nation#5243,cfpk_nation_region#5244,cval_nation_n_name#5245,cval_nation_n_comment#5246,cdepval_nation_n_name#5247,cdepval_nation_n_comment#5248,cn_name#5249,cn_comment#5250] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 16973ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/26 21:13:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:13:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5546L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:13:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5546L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#5598 AS rid_1#5643, cpfk_orders_lineitem#5599 AS cpfk_orders_lineitem_1#5644, cpfk_supplier_lineitem#5600 AS cpfk_supplier_lineitem_1#5645, cfpk_lineitem_supplier#5601 AS cfpk_lineitem_supplier_1#5646, cfpk_lineitem_partsupp#5602 AS cfpk_lineitem_partsupp_1#5647, cpfk_part_lineitem#5603 AS cpfk_part_lineitem_1#5648, cfpk_lineitem_part#5604 AS cfpk_lineitem_part_1#5649, cpfk_partsupp_lineitem#5605 AS cpfk_partsupp_lineitem_1#5650, cfpk_lineitem_orders#5606 AS cfpk_lineitem_orders_1#5651, cval_lineitem_l_quantity#5607 AS cval_lineitem_l_quantity_1#5652, cval_lineitem_l_extendedprice#5608 AS cval_lineitem_l_extendedprice_1#5653, cval_lineitem_l_discount#5609 AS cval_lineitem_l_discount_1#5654, cval_lineitem_l_tax#5610 AS cval_lineitem_l_tax_1#5655, cval_lineitem_l_returnflag#5611 AS cval_lineitem_l_returnflag_1#5656, cval_lineitem_l_linestatus#5612 AS cval_lineitem_l_linestatus_1#5657, cval_lineitem_l_commitdate#5613 AS cval_lineitem_l_commitdate_1#5658, cval_lineitem_l_receiptdate#5614 AS cval_lineitem_l_receiptdate_1#5659, cval_lineitem_l_shipinstruct#5615 AS cval_lineitem_l_shipinstruct_1#5660, cval_lineitem_l_shipmode#5616 AS cval_lineitem_l_shipmode_1#5661, cval_lineitem_l_comment#5617 AS cval_lineitem_l_comment_1#5662, cval_lineitem_l_shipdate#5618 AS cval_lineitem_l_shipdate_1#5663, cdepval_lineitem_l_quantity#5619 AS cdepval_lineitem_l_quantity_1#5664, cdepval_lineitem_l_extendedprice#5620 AS cdepval_lineitem_l_extendedprice_1#5665, cdepval_lineitem_l_discount#5621 AS cdepval_lineitem_l_discount_1#5666, ... 21 more fields]
         :  +- Relation[rid#5598,cpfk_orders_lineitem#5599,cpfk_supplier_lineitem#5600,cfpk_lineitem_supplier#5601,cfpk_lineitem_partsupp#5602,cpfk_part_lineitem#5603,cfpk_lineitem_part#5604,cpfk_partsupp_lineitem#5605,cfpk_lineitem_orders#5606,cval_lineitem_l_quantity#5607,cval_lineitem_l_extendedprice#5608,cval_lineitem_l_discount#5609,cval_lineitem_l_tax#5610,cval_lineitem_l_returnflag#5611,cval_lineitem_l_linestatus#5612,cval_lineitem_l_commitdate#5613,cval_lineitem_l_receiptdate#5614,cval_lineitem_l_shipinstruct#5615,cval_lineitem_l_shipmode#5616,cval_lineitem_l_comment#5617,cval_lineitem_l_shipdate#5618,cdepval_lineitem_l_quantity#5619,cdepval_lineitem_l_extendedprice#5620,cdepval_lineitem_l_discount#5621,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5548 AS rid_0#5573, cval_part_p_name#5549 AS cval_part_p_name_0#5574, cval_part_p_mfgr#5550 AS cval_part_p_mfgr_0#5575, cval_part_p_type#5551 AS cval_part_p_type_0#5576, cval_part_p_size#5552 AS cval_part_p_size_0#5577, cval_part_p_container#5553 AS cval_part_p_container_0#5578, cval_part_p_retailprice#5554 AS cval_part_p_retailprice_0#5579, cval_part_p_comment#5555 AS cval_part_p_comment_0#5580, cval_part_p_brand#5556 AS cval_part_p_brand_0#5581, cdepval_part_p_name#5557 AS cdepval_part_p_name_0#5582, cdepval_part_p_mfgr#5558 AS cdepval_part_p_mfgr_0#5583, cdepval_part_p_type#5559 AS cdepval_part_p_type_0#5584, cdepval_part_p_size#5560 AS cdepval_part_p_size_0#5585, cdepval_part_p_container#5561 AS cdepval_part_p_container_0#5586, cdepval_part_p_retailprice#5562 AS cdepval_part_p_retailprice_0#5587, cdepval_part_p_comment#5563 AS cdepval_part_p_comment_0#5588, cdepval_part_p_brand#5564 AS cdepval_part_p_brand_0#5589, cp_name#5565 AS cp_name_0#5590, cp_mfgr#5566 AS cp_mfgr_0#5591, cp_type#5567 AS cp_type_0#5592, cp_size#5568 AS cp_size_0#5593, cp_container#5569 AS cp_container_0#5594, cp_retailprice#5570 AS cp_retailprice_0#5595, cp_comment#5571 AS cp_comment_0#5596, cp_brand#5572 AS cp_brand_0#5597]
            +- Relation[rid#5548,cval_part_p_name#5549,cval_part_p_mfgr#5550,cval_part_p_type#5551,cval_part_p_size#5552,cval_part_p_container#5553,cval_part_p_retailprice#5554,cval_part_p_comment#5555,cval_part_p_brand#5556,cdepval_part_p_name#5557,cdepval_part_p_mfgr#5558,cdepval_part_p_type#5559,cdepval_part_p_size#5560,cdepval_part_p_container#5561,cdepval_part_p_retailprice#5562,cdepval_part_p_comment#5563,cdepval_part_p_brand#5564,cp_name#5565,cp_mfgr#5566,cp_type#5567,cp_size#5568,cp_container#5569,cp_retailprice#5570,cp_comment#5571,cp_brand#5572] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17675ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/26 21:13:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:13:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5767L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:13:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5767L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#5859 AS rid_2#5904, cpfk_orders_lineitem#5860 AS cpfk_orders_lineitem_2#5905, cpfk_supplier_lineitem#5861 AS cpfk_supplier_lineitem_2#5906, cfpk_lineitem_supplier#5862 AS cfpk_lineitem_supplier_2#5907, cfpk_lineitem_partsupp#5863 AS cfpk_lineitem_partsupp_2#5908, cpfk_part_lineitem#5864 AS cpfk_part_lineitem_2#5909, cfpk_lineitem_part#5865 AS cfpk_lineitem_part_2#5910, cpfk_partsupp_lineitem#5866 AS cpfk_partsupp_lineitem_2#5911, cfpk_lineitem_orders#5867 AS cfpk_lineitem_orders_2#5912, cval_lineitem_l_quantity#5868 AS cval_lineitem_l_quantity_2#5913, cval_lineitem_l_extendedprice#5869 AS cval_lineitem_l_extendedprice_2#5914, cval_lineitem_l_discount#5870 AS cval_lineitem_l_discount_2#5915, cval_lineitem_l_tax#5871 AS cval_lineitem_l_tax_2#5916, cval_lineitem_l_returnflag#5872 AS cval_lineitem_l_returnflag_2#5917, cval_lineitem_l_linestatus#5873 AS cval_lineitem_l_linestatus_2#5918, cval_lineitem_l_commitdate#5874 AS cval_lineitem_l_commitdate_2#5919, cval_lineitem_l_receiptdate#5875 AS cval_lineitem_l_receiptdate_2#5920, cval_lineitem_l_shipinstruct#5876 AS cval_lineitem_l_shipinstruct_2#5921, cval_lineitem_l_shipmode#5877 AS cval_lineitem_l_shipmode_2#5922, cval_lineitem_l_comment#5878 AS cval_lineitem_l_comment_2#5923, cval_lineitem_l_shipdate#5879 AS cval_lineitem_l_shipdate_2#5924, cdepval_lineitem_l_quantity#5880 AS cdepval_lineitem_l_quantity_2#5925, cdepval_lineitem_l_extendedprice#5881 AS cdepval_lineitem_l_extendedprice_2#5926, cdepval_lineitem_l_discount#5882 AS cdepval_lineitem_l_discount_2#5927, ... 21 more fields]
         :  +- Relation[rid#5859,cpfk_orders_lineitem#5860,cpfk_supplier_lineitem#5861,cfpk_lineitem_supplier#5862,cfpk_lineitem_partsupp#5863,cpfk_part_lineitem#5864,cfpk_lineitem_part#5865,cpfk_partsupp_lineitem#5866,cfpk_lineitem_orders#5867,cval_lineitem_l_quantity#5868,cval_lineitem_l_extendedprice#5869,cval_lineitem_l_discount#5870,cval_lineitem_l_tax#5871,cval_lineitem_l_returnflag#5872,cval_lineitem_l_linestatus#5873,cval_lineitem_l_commitdate#5874,cval_lineitem_l_receiptdate#5875,cval_lineitem_l_shipinstruct#5876,cval_lineitem_l_shipmode#5877,cval_lineitem_l_comment#5878,cval_lineitem_l_shipdate#5879,cdepval_lineitem_l_quantity#5880,cdepval_lineitem_l_extendedprice#5881,cdepval_lineitem_l_discount#5882,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#5811 AS rid_1#5835, cpfk_customer_orders#5812 AS cpfk_customer_orders_1#5836, cfpk_orders_customer#5813 AS cfpk_orders_customer_1#5837, cval_orders_o_orderstatus#5814 AS cval_orders_o_orderstatus_1#5838, cval_orders_o_totalprice#5815 AS cval_orders_o_totalprice_1#5839, cval_orders_o_orderpriority#5816 AS cval_orders_o_orderpriority_1#5840, cval_orders_o_clerk#5817 AS cval_orders_o_clerk_1#5841, cval_orders_o_shippriority#5818 AS cval_orders_o_shippriority_1#5842, cval_orders_o_comment#5819 AS cval_orders_o_comment_1#5843, cval_orders_o_orderdate#5820 AS cval_orders_o_orderdate_1#5844, cdepval_orders_o_orderstatus#5821 AS cdepval_orders_o_orderstatus_1#5845, cdepval_orders_o_totalprice#5822 AS cdepval_orders_o_totalprice_1#5846, cdepval_orders_o_orderpriority#5823 AS cdepval_orders_o_orderpriority_1#5847, cdepval_orders_o_clerk#5824 AS cdepval_orders_o_clerk_1#5848, cdepval_orders_o_shippriority#5825 AS cdepval_orders_o_shippriority_1#5849, cdepval_orders_o_comment#5826 AS cdepval_orders_o_comment_1#5850, cdepval_orders_o_orderdate#5827 AS cdepval_orders_o_orderdate_1#5851, co_orderstatus#5828 AS co_orderstatus_1#5852, co_totalprice#5829 AS co_totalprice_1#5853, co_orderpriority#5830 AS co_orderpriority_1#5854, co_clerk#5831 AS co_clerk_1#5855, co_shippriority#5832 AS co_shippriority_1#5856, co_comment#5833 AS co_comment_1#5857, co_orderdate#5834 AS co_orderdate_1#5858]
            :  +- Relation[rid#5811,cpfk_customer_orders#5812,cfpk_orders_customer#5813,cval_orders_o_orderstatus#5814,cval_orders_o_totalprice#5815,cval_orders_o_orderpriority#5816,cval_orders_o_clerk#5817,cval_orders_o_shippriority#5818,cval_orders_o_comment#5819,cval_orders_o_orderdate#5820,cdepval_orders_o_orderstatus#5821,cdepval_orders_o_totalprice#5822,cdepval_orders_o_orderpriority#5823,cdepval_orders_o_clerk#5824,cdepval_orders_o_shippriority#5825,cdepval_orders_o_comment#5826,cdepval_orders_o_orderdate#5827,co_orderstatus#5828,co_totalprice#5829,co_orderpriority#5830,co_clerk#5831,co_shippriority#5832,co_comment#5833,co_orderdate#5834] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#5769 AS rid_0#5790, cpfk_nation_customer#5770 AS cpfk_nation_customer_0#5791, cfpk_customer_nation#5771 AS cfpk_customer_nation_0#5792, cval_customer_c_name#5772 AS cval_customer_c_name_0#5793, cval_customer_c_address#5773 AS cval_customer_c_address_0#5794, cval_customer_c_phone#5774 AS cval_customer_c_phone_0#5795, cval_customer_c_acctbal#5775 AS cval_customer_c_acctbal_0#5796, cval_customer_c_comment#5776 AS cval_customer_c_comment_0#5797, cval_customer_c_mktsegment#5777 AS cval_customer_c_mktsegment_0#5798, cdepval_customer_c_name#5778 AS cdepval_customer_c_name_0#5799, cdepval_customer_c_address#5779 AS cdepval_customer_c_address_0#5800, cdepval_customer_c_phone#5780 AS cdepval_customer_c_phone_0#5801, cdepval_customer_c_acctbal#5781 AS cdepval_customer_c_acctbal_0#5802, cdepval_customer_c_comment#5782 AS cdepval_customer_c_comment_0#5803, cdepval_customer_c_mktsegment#5783 AS cdepval_customer_c_mktsegment_0#5804, cc_name#5784 AS cc_name_0#5805, cc_address#5785 AS cc_address_0#5806, cc_phone#5786 AS cc_phone_0#5807, cc_acctbal#5787 AS cc_acctbal_0#5808, cc_comment#5788 AS cc_comment_0#5809, cc_mktsegment#5789 AS cc_mktsegment_0#5810]
               +- Relation[rid#5769,cpfk_nation_customer#5770,cfpk_customer_nation#5771,cval_customer_c_name#5772,cval_customer_c_address#5773,cval_customer_c_phone#5774,cval_customer_c_acctbal#5775,cval_customer_c_comment#5776,cval_customer_c_mktsegment#5777,cdepval_customer_c_name#5778,cdepval_customer_c_address#5779,cdepval_customer_c_phone#5780,cdepval_customer_c_acctbal#5781,cdepval_customer_c_comment#5782,cdepval_customer_c_mktsegment#5783,cc_name#5784,cc_address#5785,cc_phone#5786,cc_acctbal#5787,cc_comment#5788,cc_mktsegment#5789] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 22086ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/26 21:14:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:14:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6047L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:14:13 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:14:13 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:14:13 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:14:13 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:14:13 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:14:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6047L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#6271 AS rid_2#6316, cpfk_orders_lineitem#6272 AS cpfk_orders_lineitem_2#6317, cpfk_supplier_lineitem#6273 AS cpfk_supplier_lineitem_2#6318, cfpk_lineitem_supplier#6274 AS cfpk_lineitem_supplier_2#6319, cfpk_lineitem_partsupp#6275 AS cfpk_lineitem_partsupp_2#6320, cpfk_part_lineitem#6276 AS cpfk_part_lineitem_2#6321, cfpk_lineitem_part#6277 AS cfpk_lineitem_part_2#6322, cpfk_partsupp_lineitem#6278 AS cpfk_partsupp_lineitem_2#6323, cfpk_lineitem_orders#6279 AS cfpk_lineitem_orders_2#6324, cval_lineitem_l_quantity#6280 AS cval_lineitem_l_quantity_2#6325, cval_lineitem_l_extendedprice#6281 AS cval_lineitem_l_extendedprice_2#6326, cval_lineitem_l_discount#6282 AS cval_lineitem_l_discount_2#6327, cval_lineitem_l_tax#6283 AS cval_lineitem_l_tax_2#6328, cval_lineitem_l_returnflag#6284 AS cval_lineitem_l_returnflag_2#6329, cval_lineitem_l_linestatus#6285 AS cval_lineitem_l_linestatus_2#6330, cval_lineitem_l_commitdate#6286 AS cval_lineitem_l_commitdate_2#6331, cval_lineitem_l_receiptdate#6287 AS cval_lineitem_l_receiptdate_2#6332, cval_lineitem_l_shipinstruct#6288 AS cval_lineitem_l_shipinstruct_2#6333, cval_lineitem_l_shipmode#6289 AS cval_lineitem_l_shipmode_2#6334, cval_lineitem_l_comment#6290 AS cval_lineitem_l_comment_2#6335, cval_lineitem_l_shipdate#6291 AS cval_lineitem_l_shipdate_2#6336, cdepval_lineitem_l_quantity#6292 AS cdepval_lineitem_l_quantity_2#6337, cdepval_lineitem_l_extendedprice#6293 AS cdepval_lineitem_l_extendedprice_2#6338, cdepval_lineitem_l_discount#6294 AS cdepval_lineitem_l_discount_2#6339, ... 21 more fields]
         :  +- Relation[rid#6271,cpfk_orders_lineitem#6272,cpfk_supplier_lineitem#6273,cfpk_lineitem_supplier#6274,cfpk_lineitem_partsupp#6275,cpfk_part_lineitem#6276,cfpk_lineitem_part#6277,cpfk_partsupp_lineitem#6278,cfpk_lineitem_orders#6279,cval_lineitem_l_quantity#6280,cval_lineitem_l_extendedprice#6281,cval_lineitem_l_discount#6282,cval_lineitem_l_tax#6283,cval_lineitem_l_returnflag#6284,cval_lineitem_l_linestatus#6285,cval_lineitem_l_commitdate#6286,cval_lineitem_l_receiptdate#6287,cval_lineitem_l_shipinstruct#6288,cval_lineitem_l_shipmode#6289,cval_lineitem_l_comment#6290,cval_lineitem_l_shipdate#6291,cdepval_lineitem_l_quantity#6292,cdepval_lineitem_l_extendedprice#6293,cdepval_lineitem_l_discount#6294,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin customer~orders, 'cpfk_customer_orders_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6070, cpfk_nation_customer_0#6071, cfpk_customer_nation_0#6072, cval_customer_c_name_0#6073, cval_customer_c_address_0#6074, cval_customer_c_phone_0#6075, cval_customer_c_acctbal_0#6076, cval_customer_c_comment_0#6077, cval_customer_c_mktsegment_0#6078, cdepval_customer_c_name_0#6079, cdepval_customer_c_address_0#6080, cdepval_customer_c_phone_0#6081, cdepval_customer_c_acctbal_0#6082, cdepval_customer_c_comment_0#6083, cdepval_customer_c_mktsegment_0#6084, cc_name_0#6085, cc_address_0#6086, cc_phone_0#6087, cc_acctbal_0#6088, cc_comment_0#6089, cc_mktsegment_0#6090, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
            :  :  +- Project [rid#6049 AS rid_0#6070, cpfk_nation_customer#6050 AS cpfk_nation_customer_0#6071, cfpk_customer_nation#6051 AS cfpk_customer_nation_0#6072, cval_customer_c_name#6052 AS cval_customer_c_name_0#6073, cval_customer_c_address#6053 AS cval_customer_c_address_0#6074, cval_customer_c_phone#6054 AS cval_customer_c_phone_0#6075, cval_customer_c_acctbal#6055 AS cval_customer_c_acctbal_0#6076, cval_customer_c_comment#6056 AS cval_customer_c_comment_0#6077, cval_customer_c_mktsegment#6057 AS cval_customer_c_mktsegment_0#6078, cdepval_customer_c_name#6058 AS cdepval_customer_c_name_0#6079, cdepval_customer_c_address#6059 AS cdepval_customer_c_address_0#6080, cdepval_customer_c_phone#6060 AS cdepval_customer_c_phone_0#6081, cdepval_customer_c_acctbal#6061 AS cdepval_customer_c_acctbal_0#6082, cdepval_customer_c_comment#6062 AS cdepval_customer_c_comment_0#6083, cdepval_customer_c_mktsegment#6063 AS cdepval_customer_c_mktsegment_0#6084, cc_name#6064 AS cc_name_0#6085, cc_address#6065 AS cc_address_0#6086, cc_phone#6066 AS cc_phone_0#6087, cc_acctbal#6067 AS cc_acctbal_0#6088, cc_comment#6068 AS cc_comment_0#6089, cc_mktsegment#6069 AS cc_mktsegment_0#6090]
            :  :     +- Relation[rid#6049,cpfk_nation_customer#6050,cfpk_customer_nation#6051,cval_customer_c_name#6052,cval_customer_c_address#6053,cval_customer_c_phone#6054,cval_customer_c_acctbal#6055,cval_customer_c_comment#6056,cval_customer_c_mktsegment#6057,cdepval_customer_c_name#6058,cdepval_customer_c_address#6059,cdepval_customer_c_phone#6060,cdepval_customer_c_acctbal#6061,cdepval_customer_c_comment#6062,cdepval_customer_c_mktsegment#6063,cc_name#6064,cc_address#6065,cc_phone#6066,cc_acctbal#6067,cc_comment#6068,cc_mktsegment#6069] JDBCRelation(tcustomer) [numPartitions=1]
            :  +- 'Project ['cpfk_customer_orders_1, 'rid_1]
            :     +- Project [rid#6223 AS rid_1#6247, cpfk_customer_orders#6224 AS cpfk_customer_orders_1#6248, cfpk_orders_customer#6225 AS cfpk_orders_customer_1#6249, cval_orders_o_orderstatus#6226 AS cval_orders_o_orderstatus_1#6250, cval_orders_o_totalprice#6227 AS cval_orders_o_totalprice_1#6251, cval_orders_o_orderpriority#6228 AS cval_orders_o_orderpriority_1#6252, cval_orders_o_clerk#6229 AS cval_orders_o_clerk_1#6253, cval_orders_o_shippriority#6230 AS cval_orders_o_shippriority_1#6254, cval_orders_o_comment#6231 AS cval_orders_o_comment_1#6255, cval_orders_o_orderdate#6232 AS cval_orders_o_orderdate_1#6256, cdepval_orders_o_orderstatus#6233 AS cdepval_orders_o_orderstatus_1#6257, cdepval_orders_o_totalprice#6234 AS cdepval_orders_o_totalprice_1#6258, cdepval_orders_o_orderpriority#6235 AS cdepval_orders_o_orderpriority_1#6259, cdepval_orders_o_clerk#6236 AS cdepval_orders_o_clerk_1#6260, cdepval_orders_o_shippriority#6237 AS cdepval_orders_o_shippriority_1#6261, cdepval_orders_o_comment#6238 AS cdepval_orders_o_comment_1#6262, cdepval_orders_o_orderdate#6239 AS cdepval_orders_o_orderdate_1#6263, co_orderstatus#6240 AS co_orderstatus_1#6264, co_totalprice#6241 AS co_totalprice_1#6265, co_orderpriority#6242 AS co_orderpriority_1#6266, co_clerk#6243 AS co_clerk_1#6267, co_shippriority#6244 AS co_shippriority_1#6268, co_comment#6245 AS co_comment_1#6269, co_orderdate#6246 AS co_orderdate_1#6270]
            :        +- Relation[rid#6223,cpfk_customer_orders#6224,cfpk_orders_customer#6225,cval_orders_o_orderstatus#6226,cval_orders_o_totalprice#6227,cval_orders_o_orderpriority#6228,cval_orders_o_clerk#6229,cval_orders_o_shippriority#6230,cval_orders_o_comment#6231,cval_orders_o_orderdate#6232,cdepval_orders_o_orderstatus#6233,cdepval_orders_o_totalprice#6234,cdepval_orders_o_orderpriority#6235,cdepval_orders_o_clerk#6236,cdepval_orders_o_shippriority#6237,cdepval_orders_o_comment#6238,cdepval_orders_o_orderdate#6239,co_orderstatus#6240,co_totalprice#6241,co_orderpriority#6242,co_clerk#6243,co_shippriority#6244,co_comment#6245,co_orderdate#6246] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#6133 AS rid_1#6157, cpfk_customer_orders#6134 AS cpfk_customer_orders_1#6158, cfpk_orders_customer#6135 AS cfpk_orders_customer_1#6159, cval_orders_o_orderstatus#6136 AS cval_orders_o_orderstatus_1#6160, cval_orders_o_totalprice#6137 AS cval_orders_o_totalprice_1#6161, cval_orders_o_orderpriority#6138 AS cval_orders_o_orderpriority_1#6162, cval_orders_o_clerk#6139 AS cval_orders_o_clerk_1#6163, cval_orders_o_shippriority#6140 AS cval_orders_o_shippriority_1#6164, cval_orders_o_comment#6141 AS cval_orders_o_comment_1#6165, cval_orders_o_orderdate#6142 AS cval_orders_o_orderdate_1#6166, cdepval_orders_o_orderstatus#6143 AS cdepval_orders_o_orderstatus_1#6167, cdepval_orders_o_totalprice#6144 AS cdepval_orders_o_totalprice_1#6168, cdepval_orders_o_orderpriority#6145 AS cdepval_orders_o_orderpriority_1#6169, cdepval_orders_o_clerk#6146 AS cdepval_orders_o_clerk_1#6170, cdepval_orders_o_shippriority#6147 AS cdepval_orders_o_shippriority_1#6171, cdepval_orders_o_comment#6148 AS cdepval_orders_o_comment_1#6172, cdepval_orders_o_orderdate#6149 AS cdepval_orders_o_orderdate_1#6173, co_orderstatus#6150 AS co_orderstatus_1#6174, co_totalprice#6151 AS co_totalprice_1#6175, co_orderpriority#6152 AS co_orderpriority_1#6176, co_clerk#6153 AS co_clerk_1#6177, co_shippriority#6154 AS co_shippriority_1#6178, co_comment#6155 AS co_comment_1#6179, co_orderdate#6156 AS co_orderdate_1#6180]
               +- Relation[rid#6133,cpfk_customer_orders#6134,cfpk_orders_customer#6135,cval_orders_o_orderstatus#6136,cval_orders_o_totalprice#6137,cval_orders_o_orderpriority#6138,cval_orders_o_clerk#6139,cval_orders_o_shippriority#6140,cval_orders_o_comment#6141,cval_orders_o_orderdate#6142,cdepval_orders_o_orderstatus#6143,cdepval_orders_o_totalprice#6144,cdepval_orders_o_orderpriority#6145,cdepval_orders_o_clerk#6146,cdepval_orders_o_shippriority#6147,cdepval_orders_o_comment#6148,cdepval_orders_o_orderdate#6149,co_orderstatus#6150,co_totalprice#6151,co_orderpriority#6152,co_clerk#6153,co_shippriority#6154,co_comment#6155,co_orderdate#6156] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 28004ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/26 21:14:41 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:14:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6456L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:14:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#6456L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#6458 AS rid_0#6503, cpfk_orders_lineitem#6459 AS cpfk_orders_lineitem_0#6504, cpfk_supplier_lineitem#6460 AS cpfk_supplier_lineitem_0#6505, cfpk_lineitem_supplier#6461 AS cfpk_lineitem_supplier_0#6506, cfpk_lineitem_partsupp#6462 AS cfpk_lineitem_partsupp_0#6507, cpfk_part_lineitem#6463 AS cpfk_part_lineitem_0#6508, cfpk_lineitem_part#6464 AS cfpk_lineitem_part_0#6509, cpfk_partsupp_lineitem#6465 AS cpfk_partsupp_lineitem_0#6510, cfpk_lineitem_orders#6466 AS cfpk_lineitem_orders_0#6511, cval_lineitem_l_quantity#6467 AS cval_lineitem_l_quantity_0#6512, cval_lineitem_l_extendedprice#6468 AS cval_lineitem_l_extendedprice_0#6513, cval_lineitem_l_discount#6469 AS cval_lineitem_l_discount_0#6514, cval_lineitem_l_tax#6470 AS cval_lineitem_l_tax_0#6515, cval_lineitem_l_returnflag#6471 AS cval_lineitem_l_returnflag_0#6516, cval_lineitem_l_linestatus#6472 AS cval_lineitem_l_linestatus_0#6517, cval_lineitem_l_commitdate#6473 AS cval_lineitem_l_commitdate_0#6518, cval_lineitem_l_receiptdate#6474 AS cval_lineitem_l_receiptdate_0#6519, cval_lineitem_l_shipinstruct#6475 AS cval_lineitem_l_shipinstruct_0#6520, cval_lineitem_l_shipmode#6476 AS cval_lineitem_l_shipmode_0#6521, cval_lineitem_l_comment#6477 AS cval_lineitem_l_comment_0#6522, cval_lineitem_l_shipdate#6478 AS cval_lineitem_l_shipdate_0#6523, cdepval_lineitem_l_quantity#6479 AS cdepval_lineitem_l_quantity_0#6524, cdepval_lineitem_l_extendedprice#6480 AS cdepval_lineitem_l_extendedprice_0#6525, cdepval_lineitem_l_discount#6481 AS cdepval_lineitem_l_discount_0#6526, ... 21 more fields]
         +- Relation[rid#6458,cpfk_orders_lineitem#6459,cpfk_supplier_lineitem#6460,cfpk_lineitem_supplier#6461,cfpk_lineitem_partsupp#6462,cpfk_part_lineitem#6463,cfpk_lineitem_part#6464,cpfk_partsupp_lineitem#6465,cfpk_lineitem_orders#6466,cval_lineitem_l_quantity#6467,cval_lineitem_l_extendedprice#6468,cval_lineitem_l_discount#6469,cval_lineitem_l_tax#6470,cval_lineitem_l_returnflag#6471,cval_lineitem_l_linestatus#6472,cval_lineitem_l_commitdate#6473,cval_lineitem_l_receiptdate#6474,cval_lineitem_l_shipinstruct#6475,cval_lineitem_l_shipmode#6476,cval_lineitem_l_comment#6477,cval_lineitem_l_shipdate#6478,cdepval_lineitem_l_quantity#6479,cdepval_lineitem_l_extendedprice#6480,cdepval_lineitem_l_discount#6481,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2266ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/26 21:14:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:14:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6598L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:14:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:14:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:14:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:14:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:14:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:14:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:14:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:14:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6598L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6625, cval_part_p_name_0#6626, cval_part_p_mfgr_0#6627, cval_part_p_type_0#6628, cval_part_p_size_0#6629, cval_part_p_container_0#6630, cval_part_p_retailprice_0#6631, cval_part_p_comment_0#6632, cval_part_p_brand_0#6633, cdepval_part_p_name_0#6634, cdepval_part_p_mfgr_0#6635, cdepval_part_p_type_0#6636, cdepval_part_p_size_0#6637, cdepval_part_p_container_0#6638, cdepval_part_p_retailprice_0#6639, cdepval_part_p_comment_0#6640, cdepval_part_p_brand_0#6641, cp_name_0#6642, cp_mfgr_0#6643, cp_type_0#6644, cp_size_0#6645, cp_container_0#6646, cp_retailprice_0#6647, cp_comment_0#6648, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#6600 AS rid_0#6625, cval_part_p_name#6601 AS cval_part_p_name_0#6626, cval_part_p_mfgr#6602 AS cval_part_p_mfgr_0#6627, cval_part_p_type#6603 AS cval_part_p_type_0#6628, cval_part_p_size#6604 AS cval_part_p_size_0#6629, cval_part_p_container#6605 AS cval_part_p_container_0#6630, cval_part_p_retailprice#6606 AS cval_part_p_retailprice_0#6631, cval_part_p_comment#6607 AS cval_part_p_comment_0#6632, cval_part_p_brand#6608 AS cval_part_p_brand_0#6633, cdepval_part_p_name#6609 AS cdepval_part_p_name_0#6634, cdepval_part_p_mfgr#6610 AS cdepval_part_p_mfgr_0#6635, cdepval_part_p_type#6611 AS cdepval_part_p_type_0#6636, cdepval_part_p_size#6612 AS cdepval_part_p_size_0#6637, cdepval_part_p_container#6613 AS cdepval_part_p_container_0#6638, cdepval_part_p_retailprice#6614 AS cdepval_part_p_retailprice_0#6639, cdepval_part_p_comment#6615 AS cdepval_part_p_comment_0#6640, cdepval_part_p_brand#6616 AS cdepval_part_p_brand_0#6641, cp_name#6617 AS cp_name_0#6642, cp_mfgr#6618 AS cp_mfgr_0#6643, cp_type#6619 AS cp_type_0#6644, cp_size#6620 AS cp_size_0#6645, cp_container#6621 AS cp_container_0#6646, cp_retailprice#6622 AS cp_retailprice_0#6647, cp_comment#6623 AS cp_comment_0#6648, cp_brand#6624 AS cp_brand_0#6649]
         :  :        +- Relation[rid#6600,cval_part_p_name#6601,cval_part_p_mfgr#6602,cval_part_p_type#6603,cval_part_p_size#6604,cval_part_p_container#6605,cval_part_p_retailprice#6606,cval_part_p_comment#6607,cval_part_p_brand#6608,cdepval_part_p_name#6609,cdepval_part_p_mfgr#6610,cdepval_part_p_type#6611,cdepval_part_p_size#6612,cdepval_part_p_container#6613,cdepval_part_p_retailprice#6614,cdepval_part_p_comment#6615,cdepval_part_p_brand#6616,cp_name#6617,cp_mfgr#6618,cp_type#6619,cp_size#6620,cp_container#6621,cp_retailprice#6622,cp_comment#6623,cp_brand#6624] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#7070 AS rid_1#7115, cpfk_orders_lineitem#7071 AS cpfk_orders_lineitem_1#7116, cpfk_supplier_lineitem#7072 AS cpfk_supplier_lineitem_1#7117, cfpk_lineitem_supplier#7073 AS cfpk_lineitem_supplier_1#7118, cfpk_lineitem_partsupp#7074 AS cfpk_lineitem_partsupp_1#7119, cpfk_part_lineitem#7075 AS cpfk_part_lineitem_1#7120, cfpk_lineitem_part#7076 AS cfpk_lineitem_part_1#7121, cpfk_partsupp_lineitem#7077 AS cpfk_partsupp_lineitem_1#7122, cfpk_lineitem_orders#7078 AS cfpk_lineitem_orders_1#7123, cval_lineitem_l_quantity#7079 AS cval_lineitem_l_quantity_1#7124, cval_lineitem_l_extendedprice#7080 AS cval_lineitem_l_extendedprice_1#7125, cval_lineitem_l_discount#7081 AS cval_lineitem_l_discount_1#7126, cval_lineitem_l_tax#7082 AS cval_lineitem_l_tax_1#7127, cval_lineitem_l_returnflag#7083 AS cval_lineitem_l_returnflag_1#7128, cval_lineitem_l_linestatus#7084 AS cval_lineitem_l_linestatus_1#7129, cval_lineitem_l_commitdate#7085 AS cval_lineitem_l_commitdate_1#7130, cval_lineitem_l_receiptdate#7086 AS cval_lineitem_l_receiptdate_1#7131, cval_lineitem_l_shipinstruct#7087 AS cval_lineitem_l_shipinstruct_1#7132, cval_lineitem_l_shipmode#7088 AS cval_lineitem_l_shipmode_1#7133, cval_lineitem_l_comment#7089 AS cval_lineitem_l_comment_1#7134, cval_lineitem_l_shipdate#7090 AS cval_lineitem_l_shipdate_1#7135, cdepval_lineitem_l_quantity#7091 AS cdepval_lineitem_l_quantity_1#7136, cdepval_lineitem_l_extendedprice#7092 AS cdepval_lineitem_l_extendedprice_1#7137, cdepval_lineitem_l_discount#7093 AS cdepval_lineitem_l_discount_1#7138, ... 21 more fields]
         :        +- Relation[rid#7070,cpfk_orders_lineitem#7071,cpfk_supplier_lineitem#7072,cfpk_lineitem_supplier#7073,cfpk_lineitem_partsupp#7074,cpfk_part_lineitem#7075,cfpk_lineitem_part#7076,cpfk_partsupp_lineitem#7077,cfpk_lineitem_orders#7078,cval_lineitem_l_quantity#7079,cval_lineitem_l_extendedprice#7080,cval_lineitem_l_discount#7081,cval_lineitem_l_tax#7082,cval_lineitem_l_returnflag#7083,cval_lineitem_l_linestatus#7084,cval_lineitem_l_commitdate#7085,cval_lineitem_l_receiptdate#7086,cval_lineitem_l_shipinstruct#7087,cval_lineitem_l_shipmode#7088,cval_lineitem_l_comment#7089,cval_lineitem_l_shipdate#7090,cdepval_lineitem_l_quantity#7091,cdepval_lineitem_l_extendedprice#7092,cdepval_lineitem_l_discount#7093,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#6750 AS rid_1#6795, cpfk_orders_lineitem#6751 AS cpfk_orders_lineitem_1#6796, cpfk_supplier_lineitem#6752 AS cpfk_supplier_lineitem_1#6797, cfpk_lineitem_supplier#6753 AS cfpk_lineitem_supplier_1#6798, cfpk_lineitem_partsupp#6754 AS cfpk_lineitem_partsupp_1#6799, cpfk_part_lineitem#6755 AS cpfk_part_lineitem_1#6800, cfpk_lineitem_part#6756 AS cfpk_lineitem_part_1#6801, cpfk_partsupp_lineitem#6757 AS cpfk_partsupp_lineitem_1#6802, cfpk_lineitem_orders#6758 AS cfpk_lineitem_orders_1#6803, cval_lineitem_l_quantity#6759 AS cval_lineitem_l_quantity_1#6804, cval_lineitem_l_extendedprice#6760 AS cval_lineitem_l_extendedprice_1#6805, cval_lineitem_l_discount#6761 AS cval_lineitem_l_discount_1#6806, cval_lineitem_l_tax#6762 AS cval_lineitem_l_tax_1#6807, cval_lineitem_l_returnflag#6763 AS cval_lineitem_l_returnflag_1#6808, cval_lineitem_l_linestatus#6764 AS cval_lineitem_l_linestatus_1#6809, cval_lineitem_l_commitdate#6765 AS cval_lineitem_l_commitdate_1#6810, cval_lineitem_l_receiptdate#6766 AS cval_lineitem_l_receiptdate_1#6811, cval_lineitem_l_shipinstruct#6767 AS cval_lineitem_l_shipinstruct_1#6812, cval_lineitem_l_shipmode#6768 AS cval_lineitem_l_shipmode_1#6813, cval_lineitem_l_comment#6769 AS cval_lineitem_l_comment_1#6814, cval_lineitem_l_shipdate#6770 AS cval_lineitem_l_shipdate_1#6815, cdepval_lineitem_l_quantity#6771 AS cdepval_lineitem_l_quantity_1#6816, cdepval_lineitem_l_extendedprice#6772 AS cdepval_lineitem_l_extendedprice_1#6817, cdepval_lineitem_l_discount#6773 AS cdepval_lineitem_l_discount_1#6818, ... 21 more fields]
                  +- Relation[rid#6750,cpfk_orders_lineitem#6751,cpfk_supplier_lineitem#6752,cfpk_lineitem_supplier#6753,cfpk_lineitem_partsupp#6754,cpfk_part_lineitem#6755,cfpk_lineitem_part#6756,cpfk_partsupp_lineitem#6757,cfpk_lineitem_orders#6758,cval_lineitem_l_quantity#6759,cval_lineitem_l_extendedprice#6760,cval_lineitem_l_discount#6761,cval_lineitem_l_tax#6762,cval_lineitem_l_returnflag#6763,cval_lineitem_l_linestatus#6764,cval_lineitem_l_commitdate#6765,cval_lineitem_l_receiptdate#6766,cval_lineitem_l_shipinstruct#6767,cval_lineitem_l_shipmode#6768,cval_lineitem_l_comment#6769,cval_lineitem_l_shipdate#6770,cdepval_lineitem_l_quantity#6771,cdepval_lineitem_l_extendedprice#6772,cdepval_lineitem_l_discount#6773,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 34526ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/26 21:15:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:15:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7234L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:15:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7234L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#7236 AS rid_0#7281, cpfk_orders_lineitem#7237 AS cpfk_orders_lineitem_0#7282, cpfk_supplier_lineitem#7238 AS cpfk_supplier_lineitem_0#7283, cfpk_lineitem_supplier#7239 AS cfpk_lineitem_supplier_0#7284, cfpk_lineitem_partsupp#7240 AS cfpk_lineitem_partsupp_0#7285, cpfk_part_lineitem#7241 AS cpfk_part_lineitem_0#7286, cfpk_lineitem_part#7242 AS cfpk_lineitem_part_0#7287, cpfk_partsupp_lineitem#7243 AS cpfk_partsupp_lineitem_0#7288, cfpk_lineitem_orders#7244 AS cfpk_lineitem_orders_0#7289, cval_lineitem_l_quantity#7245 AS cval_lineitem_l_quantity_0#7290, cval_lineitem_l_extendedprice#7246 AS cval_lineitem_l_extendedprice_0#7291, cval_lineitem_l_discount#7247 AS cval_lineitem_l_discount_0#7292, cval_lineitem_l_tax#7248 AS cval_lineitem_l_tax_0#7293, cval_lineitem_l_returnflag#7249 AS cval_lineitem_l_returnflag_0#7294, cval_lineitem_l_linestatus#7250 AS cval_lineitem_l_linestatus_0#7295, cval_lineitem_l_commitdate#7251 AS cval_lineitem_l_commitdate_0#7296, cval_lineitem_l_receiptdate#7252 AS cval_lineitem_l_receiptdate_0#7297, cval_lineitem_l_shipinstruct#7253 AS cval_lineitem_l_shipinstruct_0#7298, cval_lineitem_l_shipmode#7254 AS cval_lineitem_l_shipmode_0#7299, cval_lineitem_l_comment#7255 AS cval_lineitem_l_comment_0#7300, cval_lineitem_l_shipdate#7256 AS cval_lineitem_l_shipdate_0#7301, cdepval_lineitem_l_quantity#7257 AS cdepval_lineitem_l_quantity_0#7302, cdepval_lineitem_l_extendedprice#7258 AS cdepval_lineitem_l_extendedprice_0#7303, cdepval_lineitem_l_discount#7259 AS cdepval_lineitem_l_discount_0#7304, ... 21 more fields]
         :     +- Relation[rid#7236,cpfk_orders_lineitem#7237,cpfk_supplier_lineitem#7238,cfpk_lineitem_supplier#7239,cfpk_lineitem_partsupp#7240,cpfk_part_lineitem#7241,cfpk_lineitem_part#7242,cpfk_partsupp_lineitem#7243,cfpk_lineitem_orders#7244,cval_lineitem_l_quantity#7245,cval_lineitem_l_extendedprice#7246,cval_lineitem_l_discount#7247,cval_lineitem_l_tax#7248,cval_lineitem_l_returnflag#7249,cval_lineitem_l_linestatus#7250,cval_lineitem_l_commitdate#7251,cval_lineitem_l_receiptdate#7252,cval_lineitem_l_shipinstruct#7253,cval_lineitem_l_shipmode#7254,cval_lineitem_l_comment#7255,cval_lineitem_l_shipdate#7256,cdepval_lineitem_l_quantity#7257,cdepval_lineitem_l_extendedprice#7258,cdepval_lineitem_l_discount#7259,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7416 AS rid_1#7440, cpfk_customer_orders#7417 AS cpfk_customer_orders_1#7441, cfpk_orders_customer#7418 AS cfpk_orders_customer_1#7442, cval_orders_o_orderstatus#7419 AS cval_orders_o_orderstatus_1#7443, cval_orders_o_totalprice#7420 AS cval_orders_o_totalprice_1#7444, cval_orders_o_orderpriority#7421 AS cval_orders_o_orderpriority_1#7445, cval_orders_o_clerk#7422 AS cval_orders_o_clerk_1#7446, cval_orders_o_shippriority#7423 AS cval_orders_o_shippriority_1#7447, cval_orders_o_comment#7424 AS cval_orders_o_comment_1#7448, cval_orders_o_orderdate#7425 AS cval_orders_o_orderdate_1#7449, cdepval_orders_o_orderstatus#7426 AS cdepval_orders_o_orderstatus_1#7450, cdepval_orders_o_totalprice#7427 AS cdepval_orders_o_totalprice_1#7451, cdepval_orders_o_orderpriority#7428 AS cdepval_orders_o_orderpriority_1#7452, cdepval_orders_o_clerk#7429 AS cdepval_orders_o_clerk_1#7453, cdepval_orders_o_shippriority#7430 AS cdepval_orders_o_shippriority_1#7454, cdepval_orders_o_comment#7431 AS cdepval_orders_o_comment_1#7455, cdepval_orders_o_orderdate#7432 AS cdepval_orders_o_orderdate_1#7456, co_orderstatus#7433 AS co_orderstatus_1#7457, co_totalprice#7434 AS co_totalprice_1#7458, co_orderpriority#7435 AS co_orderpriority_1#7459, co_clerk#7436 AS co_clerk_1#7460, co_shippriority#7437 AS co_shippriority_1#7461, co_comment#7438 AS co_comment_1#7462, co_orderdate#7439 AS co_orderdate_1#7463]
            +- Relation[rid#7416,cpfk_customer_orders#7417,cfpk_orders_customer#7418,cval_orders_o_orderstatus#7419,cval_orders_o_totalprice#7420,cval_orders_o_orderpriority#7421,cval_orders_o_clerk#7422,cval_orders_o_shippriority#7423,cval_orders_o_comment#7424,cval_orders_o_orderdate#7425,cdepval_orders_o_orderstatus#7426,cdepval_orders_o_totalprice#7427,cdepval_orders_o_orderpriority#7428,cdepval_orders_o_clerk#7429,cdepval_orders_o_shippriority#7430,cdepval_orders_o_comment#7431,cdepval_orders_o_orderdate#7432,co_orderstatus#7433,co_totalprice#7434,co_orderpriority#7435,co_clerk#7436,co_shippriority#7437,co_comment#7438,co_orderdate#7439] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 22044ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/26 21:15:39 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:15:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7537L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 21:15:39 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:15:39 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:15:39 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:15:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:15:39 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:15:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:15:39 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:15:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:15:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:15:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:15:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:15:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:15:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:15:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:15:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:15:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:15:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7537L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#7678, cval_part_p_name_3#7679, cval_part_p_mfgr_3#7680, cval_part_p_type_3#7681, cval_part_p_size_3#7682, cval_part_p_container_3#7683, cval_part_p_retailprice_3#7684, cval_part_p_comment_3#7685, cval_part_p_brand_3#7686, cdepval_part_p_name_3#7687, cdepval_part_p_mfgr_3#7688, cdepval_part_p_type_3#7689, cdepval_part_p_size_3#7690, cdepval_part_p_container_3#7691, cdepval_part_p_retailprice_3#7692, cdepval_part_p_comment_3#7693, cdepval_part_p_brand_3#7694, cp_name_3#7695, cp_mfgr_3#7696, cp_type_3#7697, cp_size_3#7698, cp_container_3#7699, cp_retailprice_3#7700, cp_comment_3#7701, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :  :  :  +- Project [rid#7653 AS rid_3#7678, cval_part_p_name#7654 AS cval_part_p_name_3#7679, cval_part_p_mfgr#7655 AS cval_part_p_mfgr_3#7680, cval_part_p_type#7656 AS cval_part_p_type_3#7681, cval_part_p_size#7657 AS cval_part_p_size_3#7682, cval_part_p_container#7658 AS cval_part_p_container_3#7683, cval_part_p_retailprice#7659 AS cval_part_p_retailprice_3#7684, cval_part_p_comment#7660 AS cval_part_p_comment_3#7685, cval_part_p_brand#7661 AS cval_part_p_brand_3#7686, cdepval_part_p_name#7662 AS cdepval_part_p_name_3#7687, cdepval_part_p_mfgr#7663 AS cdepval_part_p_mfgr_3#7688, cdepval_part_p_type#7664 AS cdepval_part_p_type_3#7689, cdepval_part_p_size#7665 AS cdepval_part_p_size_3#7690, cdepval_part_p_container#7666 AS cdepval_part_p_container_3#7691, cdepval_part_p_retailprice#7667 AS cdepval_part_p_retailprice_3#7692, cdepval_part_p_comment#7668 AS cdepval_part_p_comment_3#7693, cdepval_part_p_brand#7669 AS cdepval_part_p_brand_3#7694, cp_name#7670 AS cp_name_3#7695, cp_mfgr#7671 AS cp_mfgr_3#7696, cp_type#7672 AS cp_type_3#7697, cp_size#7673 AS cp_size_3#7698, cp_container#7674 AS cp_container_3#7699, cp_retailprice#7675 AS cp_retailprice_3#7700, cp_comment#7676 AS cp_comment_3#7701, cp_brand#7677 AS cp_brand_3#7702]
         :  :  :     +- Relation[rid#7653,cval_part_p_name#7654,cval_part_p_mfgr#7655,cval_part_p_type#7656,cval_part_p_size#7657,cval_part_p_container#7658,cval_part_p_retailprice#7659,cval_part_p_comment#7660,cval_part_p_brand#7661,cdepval_part_p_name#7662,cdepval_part_p_mfgr#7663,cdepval_part_p_type#7664,cdepval_part_p_size#7665,cdepval_part_p_container#7666,cdepval_part_p_retailprice#7667,cdepval_part_p_comment#7668,cdepval_part_p_brand#7669,cp_name#7670,cp_mfgr#7671,cp_type#7672,cp_size#7673,cp_container#7674,cp_retailprice#7675,cp_comment#7676,cp_brand#7677] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_4, 'rid_4]
         :  :     +- Project [rid#7831 AS rid_4#7845, cpfk_part_partsupp#7832 AS cpfk_part_partsupp_4#7846, cfpk_partsupp_part#7833 AS cfpk_partsupp_part_4#7847, cpfk_supplier_partsupp#7834 AS cpfk_supplier_partsupp_4#7848, cfpk_partsupp_supplier#7835 AS cfpk_partsupp_supplier_4#7849, cval_partsupp_ps_availqty#7836 AS cval_partsupp_ps_availqty_4#7850, cval_partsupp_ps_supplycost#7837 AS cval_partsupp_ps_supplycost_4#7851, cval_partsupp_ps_comment#7838 AS cval_partsupp_ps_comment_4#7852, cdepval_partsupp_ps_availqty#7839 AS cdepval_partsupp_ps_availqty_4#7853, cdepval_partsupp_ps_supplycost#7840 AS cdepval_partsupp_ps_supplycost_4#7854, cdepval_partsupp_ps_comment#7841 AS cdepval_partsupp_ps_comment_4#7855, cps_availqty#7842 AS cps_availqty_4#7856, cps_supplycost#7843 AS cps_supplycost_4#7857, cps_comment#7844 AS cps_comment_4#7858]
         :  :        +- Relation[rid#7831,cpfk_part_partsupp#7832,cfpk_partsupp_part#7833,cpfk_supplier_partsupp#7834,cfpk_partsupp_supplier#7835,cval_partsupp_ps_availqty#7836,cval_partsupp_ps_supplycost#7837,cval_partsupp_ps_comment#7838,cdepval_partsupp_ps_availqty#7839,cdepval_partsupp_ps_supplycost#7840,cdepval_partsupp_ps_comment#7841,cps_availqty#7842,cps_supplycost#7843,cps_comment#7844] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#7753 AS rid_4#7767, cpfk_part_partsupp#7754 AS cpfk_part_partsupp_4#7768, cfpk_partsupp_part#7755 AS cfpk_partsupp_part_4#7769, cpfk_supplier_partsupp#7756 AS cpfk_supplier_partsupp_4#7770, cfpk_partsupp_supplier#7757 AS cfpk_partsupp_supplier_4#7771, cval_partsupp_ps_availqty#7758 AS cval_partsupp_ps_availqty_4#7772, cval_partsupp_ps_supplycost#7759 AS cval_partsupp_ps_supplycost_4#7773, cval_partsupp_ps_comment#7760 AS cval_partsupp_ps_comment_4#7774, cdepval_partsupp_ps_availqty#7761 AS cdepval_partsupp_ps_availqty_4#7775, cdepval_partsupp_ps_supplycost#7762 AS cdepval_partsupp_ps_supplycost_4#7776, cdepval_partsupp_ps_comment#7763 AS cdepval_partsupp_ps_comment_4#7777, cps_availqty#7764 AS cps_availqty_4#7778, cps_supplycost#7765 AS cps_supplycost_4#7779, cps_comment#7766 AS cps_comment_4#7780]
         :     +- Relation[rid#7753,cpfk_part_partsupp#7754,cfpk_partsupp_part#7755,cpfk_supplier_partsupp#7756,cfpk_partsupp_supplier#7757,cval_partsupp_ps_availqty#7758,cval_partsupp_ps_supplycost#7759,cval_partsupp_ps_comment#7760,cdepval_partsupp_ps_availqty#7761,cdepval_partsupp_ps_supplycost#7762,cdepval_partsupp_ps_comment#7763,cps_availqty#7764,cps_supplycost#7765,cps_comment#7766] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#7617 AS rid_2#7635, cpfk_nation_supplier#7618 AS cpfk_nation_supplier_2#7636, cfpk_supplier_nation#7619 AS cfpk_supplier_nation_2#7637, cval_supplier_s_name#7620 AS cval_supplier_s_name_2#7638, cval_supplier_s_address#7621 AS cval_supplier_s_address_2#7639, cval_supplier_s_phone#7622 AS cval_supplier_s_phone_2#7640, cval_supplier_s_acctbal#7623 AS cval_supplier_s_acctbal_2#7641, cval_supplier_s_comment#7624 AS cval_supplier_s_comment_2#7642, cdepval_supplier_s_name#7625 AS cdepval_supplier_s_name_2#7643, cdepval_supplier_s_address#7626 AS cdepval_supplier_s_address_2#7644, cdepval_supplier_s_phone#7627 AS cdepval_supplier_s_phone_2#7645, cdepval_supplier_s_acctbal#7628 AS cdepval_supplier_s_acctbal_2#7646, cdepval_supplier_s_comment#7629 AS cdepval_supplier_s_comment_2#7647, cs_name#7630 AS cs_name_2#7648, cs_address#7631 AS cs_address_2#7649, cs_phone#7632 AS cs_phone_2#7650, cs_acctbal#7633 AS cs_acctbal_2#7651, cs_comment#7634 AS cs_comment_2#7652]
            :  +- Relation[rid#7617,cpfk_nation_supplier#7618,cfpk_supplier_nation#7619,cval_supplier_s_name#7620,cval_supplier_s_address#7621,cval_supplier_s_phone#7622,cval_supplier_s_acctbal#7623,cval_supplier_s_comment#7624,cdepval_supplier_s_name#7625,cdepval_supplier_s_address#7626,cdepval_supplier_s_phone#7627,cdepval_supplier_s_acctbal#7628,cdepval_supplier_s_comment#7629,cs_name#7630,cs_address#7631,cs_phone#7632,cs_acctbal#7633,cs_comment#7634] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_1))
               :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#7546, cval_region_r_name_0#7547, cval_region_r_comment_0#7548, cdepval_region_r_name_0#7549, cdepval_region_r_comment_0#7550, cr_name_0#7551, cr_comment_0#7552, 'rid_1]
               :  :- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
               :  :  +- Project [rid#7539 AS rid_0#7546, cval_region_r_name#7540 AS cval_region_r_name_0#7547, cval_region_r_comment#7541 AS cval_region_r_comment_0#7548, cdepval_region_r_name#7542 AS cdepval_region_r_name_0#7549, cdepval_region_r_comment#7543 AS cdepval_region_r_comment_0#7550, cr_name#7544 AS cr_name_0#7551, cr_comment#7545 AS cr_comment_0#7552]
               :  :     +- Relation[rid#7539,cval_region_r_name#7540,cval_region_r_comment#7541,cdepval_region_r_name#7542,cdepval_region_r_comment#7543,cr_name#7544,cr_comment#7545] JDBCRelation(tregion) [numPartitions=1]
               :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
               :     +- Project [rid#7599 AS rid_1#7608, cpfk_region_nation#7600 AS cpfk_region_nation_1#7609, cfpk_nation_region#7601 AS cfpk_nation_region_1#7610, cval_nation_n_name#7602 AS cval_nation_n_name_1#7611, cval_nation_n_comment#7603 AS cval_nation_n_comment_1#7612, cdepval_nation_n_name#7604 AS cdepval_nation_n_name_1#7613, cdepval_nation_n_comment#7605 AS cdepval_nation_n_comment_1#7614, cn_name#7606 AS cn_name_1#7615, cn_comment#7607 AS cn_comment_1#7616]
               :        +- Relation[rid#7599,cpfk_region_nation#7600,cfpk_nation_region#7601,cval_nation_n_name#7602,cval_nation_n_comment#7603,cdepval_nation_n_name#7604,cdepval_nation_n_comment#7605,cn_name#7606,cn_comment#7607] JDBCRelation(tnation) [numPartitions=1]
               +- Project [rid#7567 AS rid_1#7576, cpfk_region_nation#7568 AS cpfk_region_nation_1#7577, cfpk_nation_region#7569 AS cfpk_nation_region_1#7578, cval_nation_n_name#7570 AS cval_nation_n_name_1#7579, cval_nation_n_comment#7571 AS cval_nation_n_comment_1#7580, cdepval_nation_n_name#7572 AS cdepval_nation_n_name_1#7581, cdepval_nation_n_comment#7573 AS cdepval_nation_n_comment_1#7582, cn_name#7574 AS cn_name_1#7583, cn_comment#7575 AS cn_comment_1#7584]
                  +- Relation[rid#7567,cpfk_region_nation#7568,cfpk_nation_region#7569,cval_nation_n_name#7570,cval_nation_n_comment#7571,cdepval_nation_n_name#7572,cdepval_nation_n_comment#7573,cn_name#7574,cn_comment#7575] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 850ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/26 21:15:40 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:15:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7939L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 21:15:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:15:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:15:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:15:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7939L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#7966, cval_part_p_name_0#7967, cval_part_p_mfgr_0#7968, cval_part_p_type_0#7969, cval_part_p_size_0#7970, cval_part_p_container_0#7971, cval_part_p_retailprice_0#7972, cval_part_p_comment_0#7973, cval_part_p_brand_0#7974, cdepval_part_p_name_0#7975, cdepval_part_p_mfgr_0#7976, cdepval_part_p_type_0#7977, cdepval_part_p_size_0#7978, cdepval_part_p_container_0#7979, cdepval_part_p_retailprice_0#7980, cdepval_part_p_comment_0#7981, cdepval_part_p_brand_0#7982, cp_name_0#7983, cp_mfgr_0#7984, cp_type_0#7985, cp_size_0#7986, cp_container_0#7987, cp_retailprice_0#7988, cp_comment_0#7989, ... 2 more fields]
         :  :- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  +- Project [rid#7941 AS rid_0#7966, cval_part_p_name#7942 AS cval_part_p_name_0#7967, cval_part_p_mfgr#7943 AS cval_part_p_mfgr_0#7968, cval_part_p_type#7944 AS cval_part_p_type_0#7969, cval_part_p_size#7945 AS cval_part_p_size_0#7970, cval_part_p_container#7946 AS cval_part_p_container_0#7971, cval_part_p_retailprice#7947 AS cval_part_p_retailprice_0#7972, cval_part_p_comment#7948 AS cval_part_p_comment_0#7973, cval_part_p_brand#7949 AS cval_part_p_brand_0#7974, cdepval_part_p_name#7950 AS cdepval_part_p_name_0#7975, cdepval_part_p_mfgr#7951 AS cdepval_part_p_mfgr_0#7976, cdepval_part_p_type#7952 AS cdepval_part_p_type_0#7977, cdepval_part_p_size#7953 AS cdepval_part_p_size_0#7978, cdepval_part_p_container#7954 AS cdepval_part_p_container_0#7979, cdepval_part_p_retailprice#7955 AS cdepval_part_p_retailprice_0#7980, cdepval_part_p_comment#7956 AS cdepval_part_p_comment_0#7981, cdepval_part_p_brand#7957 AS cdepval_part_p_brand_0#7982, cp_name#7958 AS cp_name_0#7983, cp_mfgr#7959 AS cp_mfgr_0#7984, cp_type#7960 AS cp_type_0#7985, cp_size#7961 AS cp_size_0#7986, cp_container#7962 AS cp_container_0#7987, cp_retailprice#7963 AS cp_retailprice_0#7988, cp_comment#7964 AS cp_comment_0#7989, cp_brand#7965 AS cp_brand_0#7990]
         :  :     +- Relation[rid#7941,cval_part_p_name#7942,cval_part_p_mfgr#7943,cval_part_p_type#7944,cval_part_p_size#7945,cval_part_p_container#7946,cval_part_p_retailprice#7947,cval_part_p_comment#7948,cval_part_p_brand#7949,cdepval_part_p_name#7950,cdepval_part_p_mfgr#7951,cdepval_part_p_type#7952,cdepval_part_p_size#7953,cdepval_part_p_container#7954,cdepval_part_p_retailprice#7955,cdepval_part_p_comment#7956,cdepval_part_p_brand#7957,cp_name#7958,cp_mfgr#7959,cp_type#7960,cp_size#7961,cp_container#7962,cp_retailprice#7963,cp_comment#7964,cp_brand#7965] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :     +- Project [rid#8119 AS rid_1#8133, cpfk_part_partsupp#8120 AS cpfk_part_partsupp_1#8134, cfpk_partsupp_part#8121 AS cfpk_partsupp_part_1#8135, cpfk_supplier_partsupp#8122 AS cpfk_supplier_partsupp_1#8136, cfpk_partsupp_supplier#8123 AS cfpk_partsupp_supplier_1#8137, cval_partsupp_ps_availqty#8124 AS cval_partsupp_ps_availqty_1#8138, cval_partsupp_ps_supplycost#8125 AS cval_partsupp_ps_supplycost_1#8139, cval_partsupp_ps_comment#8126 AS cval_partsupp_ps_comment_1#8140, cdepval_partsupp_ps_availqty#8127 AS cdepval_partsupp_ps_availqty_1#8141, cdepval_partsupp_ps_supplycost#8128 AS cdepval_partsupp_ps_supplycost_1#8142, cdepval_partsupp_ps_comment#8129 AS cdepval_partsupp_ps_comment_1#8143, cps_availqty#8130 AS cps_availqty_1#8144, cps_supplycost#8131 AS cps_supplycost_1#8145, cps_comment#8132 AS cps_comment_1#8146]
         :        +- Relation[rid#8119,cpfk_part_partsupp#8120,cfpk_partsupp_part#8121,cpfk_supplier_partsupp#8122,cfpk_partsupp_supplier#8123,cval_partsupp_ps_availqty#8124,cval_partsupp_ps_supplycost#8125,cval_partsupp_ps_comment#8126,cdepval_partsupp_ps_availqty#8127,cdepval_partsupp_ps_supplycost#8128,cdepval_partsupp_ps_comment#8129,cps_availqty#8130,cps_supplycost#8131,cps_comment#8132] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#8041 AS rid_1#8055, cpfk_part_partsupp#8042 AS cpfk_part_partsupp_1#8056, cfpk_partsupp_part#8043 AS cfpk_partsupp_part_1#8057, cpfk_supplier_partsupp#8044 AS cpfk_supplier_partsupp_1#8058, cfpk_partsupp_supplier#8045 AS cfpk_partsupp_supplier_1#8059, cval_partsupp_ps_availqty#8046 AS cval_partsupp_ps_availqty_1#8060, cval_partsupp_ps_supplycost#8047 AS cval_partsupp_ps_supplycost_1#8061, cval_partsupp_ps_comment#8048 AS cval_partsupp_ps_comment_1#8062, cdepval_partsupp_ps_availqty#8049 AS cdepval_partsupp_ps_availqty_1#8063, cdepval_partsupp_ps_supplycost#8050 AS cdepval_partsupp_ps_supplycost_1#8064, cdepval_partsupp_ps_comment#8051 AS cdepval_partsupp_ps_comment_1#8065, cps_availqty#8052 AS cps_availqty_1#8066, cps_supplycost#8053 AS cps_supplycost_1#8067, cps_comment#8054 AS cps_comment_1#8068]
            +- Relation[rid#8041,cpfk_part_partsupp#8042,cfpk_partsupp_part#8043,cpfk_supplier_partsupp#8044,cfpk_partsupp_supplier#8045,cval_partsupp_ps_availqty#8046,cval_partsupp_ps_supplycost#8047,cval_partsupp_ps_comment#8048,cdepval_partsupp_ps_availqty#8049,cdepval_partsupp_ps_supplycost#8050,cdepval_partsupp_ps_comment#8051,cps_availqty#8052,cps_supplycost#8053,cps_comment#8054] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 1853ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/26 21:15:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:15:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8214L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:15:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8214L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#8216 AS rid_0#8261, cpfk_orders_lineitem#8217 AS cpfk_orders_lineitem_0#8262, cpfk_supplier_lineitem#8218 AS cpfk_supplier_lineitem_0#8263, cfpk_lineitem_supplier#8219 AS cfpk_lineitem_supplier_0#8264, cfpk_lineitem_partsupp#8220 AS cfpk_lineitem_partsupp_0#8265, cpfk_part_lineitem#8221 AS cpfk_part_lineitem_0#8266, cfpk_lineitem_part#8222 AS cfpk_lineitem_part_0#8267, cpfk_partsupp_lineitem#8223 AS cpfk_partsupp_lineitem_0#8268, cfpk_lineitem_orders#8224 AS cfpk_lineitem_orders_0#8269, cval_lineitem_l_quantity#8225 AS cval_lineitem_l_quantity_0#8270, cval_lineitem_l_extendedprice#8226 AS cval_lineitem_l_extendedprice_0#8271, cval_lineitem_l_discount#8227 AS cval_lineitem_l_discount_0#8272, cval_lineitem_l_tax#8228 AS cval_lineitem_l_tax_0#8273, cval_lineitem_l_returnflag#8229 AS cval_lineitem_l_returnflag_0#8274, cval_lineitem_l_linestatus#8230 AS cval_lineitem_l_linestatus_0#8275, cval_lineitem_l_commitdate#8231 AS cval_lineitem_l_commitdate_0#8276, cval_lineitem_l_receiptdate#8232 AS cval_lineitem_l_receiptdate_0#8277, cval_lineitem_l_shipinstruct#8233 AS cval_lineitem_l_shipinstruct_0#8278, cval_lineitem_l_shipmode#8234 AS cval_lineitem_l_shipmode_0#8279, cval_lineitem_l_comment#8235 AS cval_lineitem_l_comment_0#8280, cval_lineitem_l_shipdate#8236 AS cval_lineitem_l_shipdate_0#8281, cdepval_lineitem_l_quantity#8237 AS cdepval_lineitem_l_quantity_0#8282, cdepval_lineitem_l_extendedprice#8238 AS cdepval_lineitem_l_extendedprice_0#8283, cdepval_lineitem_l_discount#8239 AS cdepval_lineitem_l_discount_0#8284, ... 21 more fields]
         :  +- Relation[rid#8216,cpfk_orders_lineitem#8217,cpfk_supplier_lineitem#8218,cfpk_lineitem_supplier#8219,cfpk_lineitem_partsupp#8220,cpfk_part_lineitem#8221,cfpk_lineitem_part#8222,cpfk_partsupp_lineitem#8223,cfpk_lineitem_orders#8224,cval_lineitem_l_quantity#8225,cval_lineitem_l_extendedprice#8226,cval_lineitem_l_discount#8227,cval_lineitem_l_tax#8228,cval_lineitem_l_returnflag#8229,cval_lineitem_l_linestatus#8230,cval_lineitem_l_commitdate#8231,cval_lineitem_l_receiptdate#8232,cval_lineitem_l_shipinstruct#8233,cval_lineitem_l_shipmode#8234,cval_lineitem_l_comment#8235,cval_lineitem_l_shipdate#8236,cdepval_lineitem_l_quantity#8237,cdepval_lineitem_l_extendedprice#8238,cdepval_lineitem_l_discount#8239,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8306 AS rid_1#8330, cpfk_customer_orders#8307 AS cpfk_customer_orders_1#8331, cfpk_orders_customer#8308 AS cfpk_orders_customer_1#8332, cval_orders_o_orderstatus#8309 AS cval_orders_o_orderstatus_1#8333, cval_orders_o_totalprice#8310 AS cval_orders_o_totalprice_1#8334, cval_orders_o_orderpriority#8311 AS cval_orders_o_orderpriority_1#8335, cval_orders_o_clerk#8312 AS cval_orders_o_clerk_1#8336, cval_orders_o_shippriority#8313 AS cval_orders_o_shippriority_1#8337, cval_orders_o_comment#8314 AS cval_orders_o_comment_1#8338, cval_orders_o_orderdate#8315 AS cval_orders_o_orderdate_1#8339, cdepval_orders_o_orderstatus#8316 AS cdepval_orders_o_orderstatus_1#8340, cdepval_orders_o_totalprice#8317 AS cdepval_orders_o_totalprice_1#8341, cdepval_orders_o_orderpriority#8318 AS cdepval_orders_o_orderpriority_1#8342, cdepval_orders_o_clerk#8319 AS cdepval_orders_o_clerk_1#8343, cdepval_orders_o_shippriority#8320 AS cdepval_orders_o_shippriority_1#8344, cdepval_orders_o_comment#8321 AS cdepval_orders_o_comment_1#8345, cdepval_orders_o_orderdate#8322 AS cdepval_orders_o_orderdate_1#8346, co_orderstatus#8323 AS co_orderstatus_1#8347, co_totalprice#8324 AS co_totalprice_1#8348, co_orderpriority#8325 AS co_orderpriority_1#8349, co_clerk#8326 AS co_clerk_1#8350, co_shippriority#8327 AS co_shippriority_1#8351, co_comment#8328 AS co_comment_1#8352, co_orderdate#8329 AS co_orderdate_1#8353]
            +- Relation[rid#8306,cpfk_customer_orders#8307,cfpk_orders_customer#8308,cval_orders_o_orderstatus#8309,cval_orders_o_totalprice#8310,cval_orders_o_orderpriority#8311,cval_orders_o_clerk#8312,cval_orders_o_shippriority#8313,cval_orders_o_comment#8314,cval_orders_o_orderdate#8315,cdepval_orders_o_orderstatus#8316,cdepval_orders_o_totalprice#8317,cdepval_orders_o_orderpriority#8318,cdepval_orders_o_clerk#8319,cdepval_orders_o_shippriority#8320,cdepval_orders_o_comment#8321,cdepval_orders_o_orderdate#8322,co_orderstatus#8323,co_totalprice#8324,co_orderpriority#8325,co_clerk#8326,co_shippriority#8327,co_comment#8328,co_orderdate#8329] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18287ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/26 21:16:00 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:16:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8431L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:16:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:16:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:16:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:16:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:16:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:16:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:16:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:16:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:16:01 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:16:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:16:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:16:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:16:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:16:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:16:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8431L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#8559 AS rid_2#8604, cpfk_orders_lineitem#8560 AS cpfk_orders_lineitem_2#8605, cpfk_supplier_lineitem#8561 AS cpfk_supplier_lineitem_2#8606, cfpk_lineitem_supplier#8562 AS cfpk_lineitem_supplier_2#8607, cfpk_lineitem_partsupp#8563 AS cfpk_lineitem_partsupp_2#8608, cpfk_part_lineitem#8564 AS cpfk_part_lineitem_2#8609, cfpk_lineitem_part#8565 AS cfpk_lineitem_part_2#8610, cpfk_partsupp_lineitem#8566 AS cpfk_partsupp_lineitem_2#8611, cfpk_lineitem_orders#8567 AS cfpk_lineitem_orders_2#8612, cval_lineitem_l_quantity#8568 AS cval_lineitem_l_quantity_2#8613, cval_lineitem_l_extendedprice#8569 AS cval_lineitem_l_extendedprice_2#8614, cval_lineitem_l_discount#8570 AS cval_lineitem_l_discount_2#8615, cval_lineitem_l_tax#8571 AS cval_lineitem_l_tax_2#8616, cval_lineitem_l_returnflag#8572 AS cval_lineitem_l_returnflag_2#8617, cval_lineitem_l_linestatus#8573 AS cval_lineitem_l_linestatus_2#8618, cval_lineitem_l_commitdate#8574 AS cval_lineitem_l_commitdate_2#8619, cval_lineitem_l_receiptdate#8575 AS cval_lineitem_l_receiptdate_2#8620, cval_lineitem_l_shipinstruct#8576 AS cval_lineitem_l_shipinstruct_2#8621, cval_lineitem_l_shipmode#8577 AS cval_lineitem_l_shipmode_2#8622, cval_lineitem_l_comment#8578 AS cval_lineitem_l_comment_2#8623, cval_lineitem_l_shipdate#8579 AS cval_lineitem_l_shipdate_2#8624, cdepval_lineitem_l_quantity#8580 AS cdepval_lineitem_l_quantity_2#8625, cdepval_lineitem_l_extendedprice#8581 AS cdepval_lineitem_l_extendedprice_2#8626, cdepval_lineitem_l_discount#8582 AS cdepval_lineitem_l_discount_2#8627, ... 21 more fields]
         :  :  +- Relation[rid#8559,cpfk_orders_lineitem#8560,cpfk_supplier_lineitem#8561,cfpk_lineitem_supplier#8562,cfpk_lineitem_partsupp#8563,cpfk_part_lineitem#8564,cfpk_lineitem_part#8565,cpfk_partsupp_lineitem#8566,cfpk_lineitem_orders#8567,cval_lineitem_l_quantity#8568,cval_lineitem_l_extendedprice#8569,cval_lineitem_l_discount#8570,cval_lineitem_l_tax#8571,cval_lineitem_l_returnflag#8572,cval_lineitem_l_linestatus#8573,cval_lineitem_l_commitdate#8574,cval_lineitem_l_receiptdate#8575,cval_lineitem_l_shipinstruct#8576,cval_lineitem_l_shipmode#8577,cval_lineitem_l_comment#8578,cval_lineitem_l_shipdate#8579,cdepval_lineitem_l_quantity#8580,cdepval_lineitem_l_extendedprice#8581,cdepval_lineitem_l_discount#8582,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join UsingJoin(Inner,List(rid_1))
         :     :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#8442, cpfk_region_nation_0#8443, cfpk_nation_region_0#8444, cval_nation_n_name_0#8445, cval_nation_n_comment_0#8446, cdepval_nation_n_name_0#8447, cdepval_nation_n_comment_0#8448, cn_name_0#8449, cn_comment_0#8450, 'rid_1]
         :     :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :     :  :  +- Project [rid#8433 AS rid_0#8442, cpfk_region_nation#8434 AS cpfk_region_nation_0#8443, cfpk_nation_region#8435 AS cfpk_nation_region_0#8444, cval_nation_n_name#8436 AS cval_nation_n_name_0#8445, cval_nation_n_comment#8437 AS cval_nation_n_comment_0#8446, cdepval_nation_n_name#8438 AS cdepval_nation_n_name_0#8447, cdepval_nation_n_comment#8439 AS cdepval_nation_n_comment_0#8448, cn_name#8440 AS cn_name_0#8449, cn_comment#8441 AS cn_comment_0#8450]
         :     :  :     +- Relation[rid#8433,cpfk_region_nation#8434,cfpk_nation_region#8435,cval_nation_n_name#8436,cval_nation_n_comment#8437,cdepval_nation_n_name#8438,cdepval_nation_n_comment#8439,cn_name#8440,cn_comment#8441] JDBCRelation(tnation) [numPartitions=1]
         :     :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
         :     :     +- Project [rid#8523 AS rid_1#8541, cpfk_nation_supplier#8524 AS cpfk_nation_supplier_1#8542, cfpk_supplier_nation#8525 AS cfpk_supplier_nation_1#8543, cval_supplier_s_name#8526 AS cval_supplier_s_name_1#8544, cval_supplier_s_address#8527 AS cval_supplier_s_address_1#8545, cval_supplier_s_phone#8528 AS cval_supplier_s_phone_1#8546, cval_supplier_s_acctbal#8529 AS cval_supplier_s_acctbal_1#8547, cval_supplier_s_comment#8530 AS cval_supplier_s_comment_1#8548, cdepval_supplier_s_name#8531 AS cdepval_supplier_s_name_1#8549, cdepval_supplier_s_address#8532 AS cdepval_supplier_s_address_1#8550, cdepval_supplier_s_phone#8533 AS cdepval_supplier_s_phone_1#8551, cdepval_supplier_s_acctbal#8534 AS cdepval_supplier_s_acctbal_1#8552, cdepval_supplier_s_comment#8535 AS cdepval_supplier_s_comment_1#8553, cs_name#8536 AS cs_name_1#8554, cs_address#8537 AS cs_address_1#8555, cs_phone#8538 AS cs_phone_1#8556, cs_acctbal#8539 AS cs_acctbal_1#8557, cs_comment#8540 AS cs_comment_1#8558]
         :     :        +- Relation[rid#8523,cpfk_nation_supplier#8524,cfpk_supplier_nation#8525,cval_supplier_s_name#8526,cval_supplier_s_address#8527,cval_supplier_s_phone#8528,cval_supplier_s_acctbal#8529,cval_supplier_s_comment#8530,cdepval_supplier_s_name#8531,cdepval_supplier_s_address#8532,cdepval_supplier_s_phone#8533,cdepval_supplier_s_acctbal#8534,cdepval_supplier_s_comment#8535,cs_name#8536,cs_address#8537,cs_phone#8538,cs_acctbal#8539,cs_comment#8540] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#8469 AS rid_1#8487, cpfk_nation_supplier#8470 AS cpfk_nation_supplier_1#8488, cfpk_supplier_nation#8471 AS cfpk_supplier_nation_1#8489, cval_supplier_s_name#8472 AS cval_supplier_s_name_1#8490, cval_supplier_s_address#8473 AS cval_supplier_s_address_1#8491, cval_supplier_s_phone#8474 AS cval_supplier_s_phone_1#8492, cval_supplier_s_acctbal#8475 AS cval_supplier_s_acctbal_1#8493, cval_supplier_s_comment#8476 AS cval_supplier_s_comment_1#8494, cdepval_supplier_s_name#8477 AS cdepval_supplier_s_name_1#8495, cdepval_supplier_s_address#8478 AS cdepval_supplier_s_address_1#8496, cdepval_supplier_s_phone#8479 AS cdepval_supplier_s_phone_1#8497, cdepval_supplier_s_acctbal#8480 AS cdepval_supplier_s_acctbal_1#8498, cdepval_supplier_s_comment#8481 AS cdepval_supplier_s_comment_1#8499, cs_name#8482 AS cs_name_1#8500, cs_address#8483 AS cs_address_1#8501, cs_phone#8484 AS cs_phone_1#8502, cs_acctbal#8485 AS cs_acctbal_1#8503, cs_comment#8486 AS cs_comment_1#8504]
         :        +- Relation[rid#8469,cpfk_nation_supplier#8470,cfpk_supplier_nation#8471,cval_supplier_s_name#8472,cval_supplier_s_address#8473,cval_supplier_s_phone#8474,cval_supplier_s_acctbal#8475,cval_supplier_s_comment#8476,cdepval_supplier_s_name#8477,cdepval_supplier_s_address#8478,cdepval_supplier_s_phone#8479,cdepval_supplier_s_acctbal#8480,cdepval_supplier_s_comment#8481,cs_name#8482,cs_address#8483,cs_phone#8484,cs_acctbal#8485,cs_comment#8486] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#8787 AS rid_5#8811, cpfk_customer_orders#8788 AS cpfk_customer_orders_5#8812, cfpk_orders_customer#8789 AS cfpk_orders_customer_5#8813, cval_orders_o_orderstatus#8790 AS cval_orders_o_orderstatus_5#8814, cval_orders_o_totalprice#8791 AS cval_orders_o_totalprice_5#8815, cval_orders_o_orderpriority#8792 AS cval_orders_o_orderpriority_5#8816, cval_orders_o_clerk#8793 AS cval_orders_o_clerk_5#8817, cval_orders_o_shippriority#8794 AS cval_orders_o_shippriority_5#8818, cval_orders_o_comment#8795 AS cval_orders_o_comment_5#8819, cval_orders_o_orderdate#8796 AS cval_orders_o_orderdate_5#8820, cdepval_orders_o_orderstatus#8797 AS cdepval_orders_o_orderstatus_5#8821, cdepval_orders_o_totalprice#8798 AS cdepval_orders_o_totalprice_5#8822, cdepval_orders_o_orderpriority#8799 AS cdepval_orders_o_orderpriority_5#8823, cdepval_orders_o_clerk#8800 AS cdepval_orders_o_clerk_5#8824, cdepval_orders_o_shippriority#8801 AS cdepval_orders_o_shippriority_5#8825, cdepval_orders_o_comment#8802 AS cdepval_orders_o_comment_5#8826, cdepval_orders_o_orderdate#8803 AS cdepval_orders_o_orderdate_5#8827, co_orderstatus#8804 AS co_orderstatus_5#8828, co_totalprice#8805 AS co_totalprice_5#8829, co_orderpriority#8806 AS co_orderpriority_5#8830, co_clerk#8807 AS co_clerk_5#8831, co_shippriority#8808 AS co_shippriority_5#8832, co_comment#8809 AS co_comment_5#8833, co_orderdate#8810 AS co_orderdate_5#8834]
            :  +- Relation[rid#8787,cpfk_customer_orders#8788,cfpk_orders_customer#8789,cval_orders_o_orderstatus#8790,cval_orders_o_totalprice#8791,cval_orders_o_orderpriority#8792,cval_orders_o_clerk#8793,cval_orders_o_shippriority#8794,cval_orders_o_comment#8795,cval_orders_o_orderdate#8796,cdepval_orders_o_orderstatus#8797,cdepval_orders_o_totalprice#8798,cdepval_orders_o_orderpriority#8799,cdepval_orders_o_clerk#8800,cdepval_orders_o_shippriority#8801,cdepval_orders_o_comment#8802,cdepval_orders_o_orderdate#8803,co_orderstatus#8804,co_totalprice#8805,co_orderpriority#8806,co_clerk#8807,co_shippriority#8808,co_comment#8809,co_orderdate#8810] JDBCRelation(torders) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_4))
               :- 'DexPkfkMaterializationAwareJoin nation~customer, 'cpfk_nation_customer_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#8658, cpfk_region_nation_3#8659, cfpk_nation_region_3#8660, cval_nation_n_name_3#8661, cval_nation_n_comment_3#8662, cdepval_nation_n_name_3#8663, cdepval_nation_n_comment_3#8664, cn_name_3#8665, cn_comment_3#8666, 'rid_4]
               :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
               :  :  +- Project [rid#8649 AS rid_3#8658, cpfk_region_nation#8650 AS cpfk_region_nation_3#8659, cfpk_nation_region#8651 AS cfpk_nation_region_3#8660, cval_nation_n_name#8652 AS cval_nation_n_name_3#8661, cval_nation_n_comment#8653 AS cval_nation_n_comment_3#8662, cdepval_nation_n_name#8654 AS cdepval_nation_n_name_3#8663, cdepval_nation_n_comment#8655 AS cdepval_nation_n_comment_3#8664, cn_name#8656 AS cn_name_3#8665, cn_comment#8657 AS cn_comment_3#8666]
               :  :     +- Relation[rid#8649,cpfk_region_nation#8650,cfpk_nation_region#8651,cval_nation_n_name#8652,cval_nation_n_comment#8653,cdepval_nation_n_name#8654,cdepval_nation_n_comment#8655,cn_name#8656,cn_comment#8657] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'Project ['cpfk_nation_customer_4, 'rid_4]
               :     +- Project [rid#8745 AS rid_4#8766, cpfk_nation_customer#8746 AS cpfk_nation_customer_4#8767, cfpk_customer_nation#8747 AS cfpk_customer_nation_4#8768, cval_customer_c_name#8748 AS cval_customer_c_name_4#8769, cval_customer_c_address#8749 AS cval_customer_c_address_4#8770, cval_customer_c_phone#8750 AS cval_customer_c_phone_4#8771, cval_customer_c_acctbal#8751 AS cval_customer_c_acctbal_4#8772, cval_customer_c_comment#8752 AS cval_customer_c_comment_4#8773, cval_customer_c_mktsegment#8753 AS cval_customer_c_mktsegment_4#8774, cdepval_customer_c_name#8754 AS cdepval_customer_c_name_4#8775, cdepval_customer_c_address#8755 AS cdepval_customer_c_address_4#8776, cdepval_customer_c_phone#8756 AS cdepval_customer_c_phone_4#8777, cdepval_customer_c_acctbal#8757 AS cdepval_customer_c_acctbal_4#8778, cdepval_customer_c_comment#8758 AS cdepval_customer_c_comment_4#8779, cdepval_customer_c_mktsegment#8759 AS cdepval_customer_c_mktsegment_4#8780, cc_name#8760 AS cc_name_4#8781, cc_address#8761 AS cc_address_4#8782, cc_phone#8762 AS cc_phone_4#8783, cc_acctbal#8763 AS cc_acctbal_4#8784, cc_comment#8764 AS cc_comment_4#8785, cc_mktsegment#8765 AS cc_mktsegment_4#8786]
               :        +- Relation[rid#8745,cpfk_nation_customer#8746,cfpk_customer_nation#8747,cval_customer_c_name#8748,cval_customer_c_address#8749,cval_customer_c_phone#8750,cval_customer_c_acctbal#8751,cval_customer_c_comment#8752,cval_customer_c_mktsegment#8753,cdepval_customer_c_name#8754,cdepval_customer_c_address#8755,cdepval_customer_c_phone#8756,cdepval_customer_c_acctbal#8757,cdepval_customer_c_comment#8758,cdepval_customer_c_mktsegment#8759,cc_name#8760,cc_address#8761,cc_phone#8762,cc_acctbal#8763,cc_comment#8764,cc_mktsegment#8765] JDBCRelation(tcustomer) [numPartitions=1]
               +- Project [rid#8685 AS rid_4#8706, cpfk_nation_customer#8686 AS cpfk_nation_customer_4#8707, cfpk_customer_nation#8687 AS cfpk_customer_nation_4#8708, cval_customer_c_name#8688 AS cval_customer_c_name_4#8709, cval_customer_c_address#8689 AS cval_customer_c_address_4#8710, cval_customer_c_phone#8690 AS cval_customer_c_phone_4#8711, cval_customer_c_acctbal#8691 AS cval_customer_c_acctbal_4#8712, cval_customer_c_comment#8692 AS cval_customer_c_comment_4#8713, cval_customer_c_mktsegment#8693 AS cval_customer_c_mktsegment_4#8714, cdepval_customer_c_name#8694 AS cdepval_customer_c_name_4#8715, cdepval_customer_c_address#8695 AS cdepval_customer_c_address_4#8716, cdepval_customer_c_phone#8696 AS cdepval_customer_c_phone_4#8717, cdepval_customer_c_acctbal#8697 AS cdepval_customer_c_acctbal_4#8718, cdepval_customer_c_comment#8698 AS cdepval_customer_c_comment_4#8719, cdepval_customer_c_mktsegment#8699 AS cdepval_customer_c_mktsegment_4#8720, cc_name#8700 AS cc_name_4#8721, cc_address#8701 AS cc_address_4#8722, cc_phone#8702 AS cc_phone_4#8723, cc_acctbal#8703 AS cc_acctbal_4#8724, cc_comment#8704 AS cc_comment_4#8725, cc_mktsegment#8705 AS cc_mktsegment_4#8726]
                  +- Relation[rid#8685,cpfk_nation_customer#8686,cfpk_customer_nation#8687,cval_customer_c_name#8688,cval_customer_c_address#8689,cval_customer_c_phone#8690,cval_customer_c_acctbal#8691,cval_customer_c_comment#8692,cval_customer_c_mktsegment#8693,cdepval_customer_c_name#8694,cdepval_customer_c_address#8695,cdepval_customer_c_phone#8696,cdepval_customer_c_acctbal#8697,cdepval_customer_c_comment#8698,cdepval_customer_c_mktsegment#8699,cc_name#8700,cc_address#8701,cc_phone#8702,cc_acctbal#8703,cc_comment#8704,cc_mktsegment#8705] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 40807ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/26 21:16:41 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:16:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8965L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 21:16:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:16:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:16:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:16:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:16:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:16:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:16:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:16:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:16:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:16:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8965L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#8967 AS rid_0#9012, cpfk_orders_lineitem#8968 AS cpfk_orders_lineitem_0#9013, cpfk_supplier_lineitem#8969 AS cpfk_supplier_lineitem_0#9014, cfpk_lineitem_supplier#8970 AS cfpk_lineitem_supplier_0#9015, cfpk_lineitem_partsupp#8971 AS cfpk_lineitem_partsupp_0#9016, cpfk_part_lineitem#8972 AS cpfk_part_lineitem_0#9017, cfpk_lineitem_part#8973 AS cfpk_lineitem_part_0#9018, cpfk_partsupp_lineitem#8974 AS cpfk_partsupp_lineitem_0#9019, cfpk_lineitem_orders#8975 AS cfpk_lineitem_orders_0#9020, cval_lineitem_l_quantity#8976 AS cval_lineitem_l_quantity_0#9021, cval_lineitem_l_extendedprice#8977 AS cval_lineitem_l_extendedprice_0#9022, cval_lineitem_l_discount#8978 AS cval_lineitem_l_discount_0#9023, cval_lineitem_l_tax#8979 AS cval_lineitem_l_tax_0#9024, cval_lineitem_l_returnflag#8980 AS cval_lineitem_l_returnflag_0#9025, cval_lineitem_l_linestatus#8981 AS cval_lineitem_l_linestatus_0#9026, cval_lineitem_l_commitdate#8982 AS cval_lineitem_l_commitdate_0#9027, cval_lineitem_l_receiptdate#8983 AS cval_lineitem_l_receiptdate_0#9028, cval_lineitem_l_shipinstruct#8984 AS cval_lineitem_l_shipinstruct_0#9029, cval_lineitem_l_shipmode#8985 AS cval_lineitem_l_shipmode_0#9030, cval_lineitem_l_comment#8986 AS cval_lineitem_l_comment_0#9031, cval_lineitem_l_shipdate#8987 AS cval_lineitem_l_shipdate_0#9032, cdepval_lineitem_l_quantity#8988 AS cdepval_lineitem_l_quantity_0#9033, cdepval_lineitem_l_extendedprice#8989 AS cdepval_lineitem_l_extendedprice_0#9034, cdepval_lineitem_l_discount#8990 AS cdepval_lineitem_l_discount_0#9035, ... 21 more fields]
         :  +- Relation[rid#8967,cpfk_orders_lineitem#8968,cpfk_supplier_lineitem#8969,cfpk_lineitem_supplier#8970,cfpk_lineitem_partsupp#8971,cpfk_part_lineitem#8972,cfpk_lineitem_part#8973,cpfk_partsupp_lineitem#8974,cfpk_lineitem_orders#8975,cval_lineitem_l_quantity#8976,cval_lineitem_l_extendedprice#8977,cval_lineitem_l_discount#8978,cval_lineitem_l_tax#8979,cval_lineitem_l_returnflag#8980,cval_lineitem_l_linestatus#8981,cval_lineitem_l_commitdate#8982,cval_lineitem_l_receiptdate#8983,cval_lineitem_l_shipinstruct#8984,cval_lineitem_l_shipmode#8985,cval_lineitem_l_comment#8986,cval_lineitem_l_shipdate#8987,cdepval_lineitem_l_quantity#8988,cdepval_lineitem_l_extendedprice#8989,cdepval_lineitem_l_discount#8990,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#9426, cpfk_region_nation_4#9427, cfpk_nation_region_4#9428, cval_nation_n_name_4#9429, cval_nation_n_comment_4#9430, cdepval_nation_n_name_4#9431, cdepval_nation_n_comment_4#9432, cn_name_4#9433, cn_comment_4#9434, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
            :  :  +- Project [rid#9417 AS rid_4#9426, cpfk_region_nation#9418 AS cpfk_region_nation_4#9427, cfpk_nation_region#9419 AS cfpk_nation_region_4#9428, cval_nation_n_name#9420 AS cval_nation_n_name_4#9429, cval_nation_n_comment#9421 AS cval_nation_n_comment_4#9430, cdepval_nation_n_name#9422 AS cdepval_nation_n_name_4#9431, cdepval_nation_n_comment#9423 AS cdepval_nation_n_comment_4#9432, cn_name#9424 AS cn_name_4#9433, cn_comment#9425 AS cn_comment_4#9434]
            :  :     +- Relation[rid#9417,cpfk_region_nation#9418,cfpk_nation_region#9419,cval_nation_n_name#9420,cval_nation_n_comment#9421,cdepval_nation_n_name#9422,cdepval_nation_n_comment#9423,cn_name#9424,cn_comment#9425] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#9471 AS rid_3#9489, cpfk_nation_supplier#9472 AS cpfk_nation_supplier_3#9490, cfpk_supplier_nation#9473 AS cfpk_supplier_nation_3#9491, cval_supplier_s_name#9474 AS cval_supplier_s_name_3#9492, cval_supplier_s_address#9475 AS cval_supplier_s_address_3#9493, cval_supplier_s_phone#9476 AS cval_supplier_s_phone_3#9494, cval_supplier_s_acctbal#9477 AS cval_supplier_s_acctbal_3#9495, cval_supplier_s_comment#9478 AS cval_supplier_s_comment_3#9496, cdepval_supplier_s_name#9479 AS cdepval_supplier_s_name_3#9497, cdepval_supplier_s_address#9480 AS cdepval_supplier_s_address_3#9498, cdepval_supplier_s_phone#9481 AS cdepval_supplier_s_phone_3#9499, cdepval_supplier_s_acctbal#9482 AS cdepval_supplier_s_acctbal_3#9500, cdepval_supplier_s_comment#9483 AS cdepval_supplier_s_comment_3#9501, cs_name#9484 AS cs_name_3#9502, cs_address#9485 AS cs_address_3#9503, cs_phone#9486 AS cs_phone_3#9504, cs_acctbal#9487 AS cs_acctbal_3#9505, cs_comment#9488 AS cs_comment_3#9506]
            :        +- Relation[rid#9471,cpfk_nation_supplier#9472,cfpk_supplier_nation#9473,cval_supplier_s_name#9474,cval_supplier_s_address#9475,cval_supplier_s_phone#9476,cval_supplier_s_acctbal#9477,cval_supplier_s_comment#9478,cdepval_supplier_s_name#9479,cdepval_supplier_s_address#9480,cdepval_supplier_s_phone#9481,cdepval_supplier_s_acctbal#9482,cdepval_supplier_s_comment#9483,cs_name#9484,cs_address#9485,cs_phone#9486,cs_acctbal#9487,cs_comment#9488] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'DexPkfkMaterializationAwareJoin orders~lineitem, 'cpfk_orders_lineitem_2, 'rid_1, NotMaterialized, NotMaterialized, [rid_1#9081, cpfk_customer_orders_1#9082, cfpk_orders_customer_1#9083, cval_orders_o_orderstatus_1#9084, cval_orders_o_totalprice_1#9085, cval_orders_o_orderpriority_1#9086, cval_orders_o_clerk_1#9087, cval_orders_o_shippriority_1#9088, cval_orders_o_comment_1#9089, cval_orders_o_orderdate_1#9090, cdepval_orders_o_orderstatus_1#9091, cdepval_orders_o_totalprice_1#9092, cdepval_orders_o_orderpriority_1#9093, cdepval_orders_o_clerk_1#9094, cdepval_orders_o_shippriority_1#9095, cdepval_orders_o_comment_1#9096, cdepval_orders_o_orderdate_1#9097, co_orderstatus_1#9098, co_totalprice_1#9099, co_orderpriority_1#9100, co_clerk_1#9101, co_shippriority_1#9102, co_comment_1#9103, co_orderdate_1#9104, 'rid_2]
               :  :  :- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
               :  :  :  +- Project [rid#9057 AS rid_1#9081, cpfk_customer_orders#9058 AS cpfk_customer_orders_1#9082, cfpk_orders_customer#9059 AS cfpk_orders_customer_1#9083, cval_orders_o_orderstatus#9060 AS cval_orders_o_orderstatus_1#9084, cval_orders_o_totalprice#9061 AS cval_orders_o_totalprice_1#9085, cval_orders_o_orderpriority#9062 AS cval_orders_o_orderpriority_1#9086, cval_orders_o_clerk#9063 AS cval_orders_o_clerk_1#9087, cval_orders_o_shippriority#9064 AS cval_orders_o_shippriority_1#9088, cval_orders_o_comment#9065 AS cval_orders_o_comment_1#9089, cval_orders_o_orderdate#9066 AS cval_orders_o_orderdate_1#9090, cdepval_orders_o_orderstatus#9067 AS cdepval_orders_o_orderstatus_1#9091, cdepval_orders_o_totalprice#9068 AS cdepval_orders_o_totalprice_1#9092, cdepval_orders_o_orderpriority#9069 AS cdepval_orders_o_orderpriority_1#9093, cdepval_orders_o_clerk#9070 AS cdepval_orders_o_clerk_1#9094, cdepval_orders_o_shippriority#9071 AS cdepval_orders_o_shippriority_1#9095, cdepval_orders_o_comment#9072 AS cdepval_orders_o_comment_1#9096, cdepval_orders_o_orderdate#9073 AS cdepval_orders_o_orderdate_1#9097, co_orderstatus#9074 AS co_orderstatus_1#9098, co_totalprice#9075 AS co_totalprice_1#9099, co_orderpriority#9076 AS co_orderpriority_1#9100, co_clerk#9077 AS co_clerk_1#9101, co_shippriority#9078 AS co_shippriority_1#9102, co_comment#9079 AS co_comment_1#9103, co_orderdate#9080 AS co_orderdate_1#9104]
               :  :  :     +- Relation[rid#9057,cpfk_customer_orders#9058,cfpk_orders_customer#9059,cval_orders_o_orderstatus#9060,cval_orders_o_totalprice#9061,cval_orders_o_orderpriority#9062,cval_orders_o_clerk#9063,cval_orders_o_shippriority#9064,cval_orders_o_comment#9065,cval_orders_o_orderdate#9066,cdepval_orders_o_orderstatus#9067,cdepval_orders_o_totalprice#9068,cdepval_orders_o_orderpriority#9069,cdepval_orders_o_clerk#9070,cdepval_orders_o_shippriority#9071,cdepval_orders_o_comment#9072,cdepval_orders_o_orderdate#9073,co_orderstatus#9074,co_totalprice#9075,co_orderpriority#9076,co_clerk#9077,co_shippriority#9078,co_comment#9079,co_orderdate#9080] JDBCRelation(torders) [numPartitions=1]
               :  :  +- 'Project ['cpfk_orders_lineitem_2, 'rid_2]
               :  :     +- Project [rid#9291 AS rid_2#9336, cpfk_orders_lineitem#9292 AS cpfk_orders_lineitem_2#9337, cpfk_supplier_lineitem#9293 AS cpfk_supplier_lineitem_2#9338, cfpk_lineitem_supplier#9294 AS cfpk_lineitem_supplier_2#9339, cfpk_lineitem_partsupp#9295 AS cfpk_lineitem_partsupp_2#9340, cpfk_part_lineitem#9296 AS cpfk_part_lineitem_2#9341, cfpk_lineitem_part#9297 AS cfpk_lineitem_part_2#9342, cpfk_partsupp_lineitem#9298 AS cpfk_partsupp_lineitem_2#9343, cfpk_lineitem_orders#9299 AS cfpk_lineitem_orders_2#9344, cval_lineitem_l_quantity#9300 AS cval_lineitem_l_quantity_2#9345, cval_lineitem_l_extendedprice#9301 AS cval_lineitem_l_extendedprice_2#9346, cval_lineitem_l_discount#9302 AS cval_lineitem_l_discount_2#9347, cval_lineitem_l_tax#9303 AS cval_lineitem_l_tax_2#9348, cval_lineitem_l_returnflag#9304 AS cval_lineitem_l_returnflag_2#9349, cval_lineitem_l_linestatus#9305 AS cval_lineitem_l_linestatus_2#9350, cval_lineitem_l_commitdate#9306 AS cval_lineitem_l_commitdate_2#9351, cval_lineitem_l_receiptdate#9307 AS cval_lineitem_l_receiptdate_2#9352, cval_lineitem_l_shipinstruct#9308 AS cval_lineitem_l_shipinstruct_2#9353, cval_lineitem_l_shipmode#9309 AS cval_lineitem_l_shipmode_2#9354, cval_lineitem_l_comment#9310 AS cval_lineitem_l_comment_2#9355, cval_lineitem_l_shipdate#9311 AS cval_lineitem_l_shipdate_2#9356, cdepval_lineitem_l_quantity#9312 AS cdepval_lineitem_l_quantity_2#9357, cdepval_lineitem_l_extendedprice#9313 AS cdepval_lineitem_l_extendedprice_2#9358, cdepval_lineitem_l_discount#9314 AS cdepval_lineitem_l_discount_2#9359, ... 21 more fields]
               :  :        +- Relation[rid#9291,cpfk_orders_lineitem#9292,cpfk_supplier_lineitem#9293,cfpk_lineitem_supplier#9294,cfpk_lineitem_partsupp#9295,cpfk_part_lineitem#9296,cfpk_lineitem_part#9297,cpfk_partsupp_lineitem#9298,cfpk_lineitem_orders#9299,cval_lineitem_l_quantity#9300,cval_lineitem_l_extendedprice#9301,cval_lineitem_l_discount#9302,cval_lineitem_l_tax#9303,cval_lineitem_l_returnflag#9304,cval_lineitem_l_linestatus#9305,cval_lineitem_l_commitdate#9306,cval_lineitem_l_receiptdate#9307,cval_lineitem_l_shipinstruct#9308,cval_lineitem_l_shipmode#9309,cval_lineitem_l_comment#9310,cval_lineitem_l_shipdate#9311,cdepval_lineitem_l_quantity#9312,cdepval_lineitem_l_extendedprice#9313,cdepval_lineitem_l_discount#9314,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               :  +- Project [rid#9153 AS rid_2#9198, cpfk_orders_lineitem#9154 AS cpfk_orders_lineitem_2#9199, cpfk_supplier_lineitem#9155 AS cpfk_supplier_lineitem_2#9200, cfpk_lineitem_supplier#9156 AS cfpk_lineitem_supplier_2#9201, cfpk_lineitem_partsupp#9157 AS cfpk_lineitem_partsupp_2#9202, cpfk_part_lineitem#9158 AS cpfk_part_lineitem_2#9203, cfpk_lineitem_part#9159 AS cfpk_lineitem_part_2#9204, cpfk_partsupp_lineitem#9160 AS cpfk_partsupp_lineitem_2#9205, cfpk_lineitem_orders#9161 AS cfpk_lineitem_orders_2#9206, cval_lineitem_l_quantity#9162 AS cval_lineitem_l_quantity_2#9207, cval_lineitem_l_extendedprice#9163 AS cval_lineitem_l_extendedprice_2#9208, cval_lineitem_l_discount#9164 AS cval_lineitem_l_discount_2#9209, cval_lineitem_l_tax#9165 AS cval_lineitem_l_tax_2#9210, cval_lineitem_l_returnflag#9166 AS cval_lineitem_l_returnflag_2#9211, cval_lineitem_l_linestatus#9167 AS cval_lineitem_l_linestatus_2#9212, cval_lineitem_l_commitdate#9168 AS cval_lineitem_l_commitdate_2#9213, cval_lineitem_l_receiptdate#9169 AS cval_lineitem_l_receiptdate_2#9214, cval_lineitem_l_shipinstruct#9170 AS cval_lineitem_l_shipinstruct_2#9215, cval_lineitem_l_shipmode#9171 AS cval_lineitem_l_shipmode_2#9216, cval_lineitem_l_comment#9172 AS cval_lineitem_l_comment_2#9217, cval_lineitem_l_shipdate#9173 AS cval_lineitem_l_shipdate_2#9218, cdepval_lineitem_l_quantity#9174 AS cdepval_lineitem_l_quantity_2#9219, cdepval_lineitem_l_extendedprice#9175 AS cdepval_lineitem_l_extendedprice_2#9220, cdepval_lineitem_l_discount#9176 AS cdepval_lineitem_l_discount_2#9221, ... 21 more fields]
               :     +- Relation[rid#9153,cpfk_orders_lineitem#9154,cpfk_supplier_lineitem#9155,cfpk_lineitem_supplier#9156,cfpk_lineitem_partsupp#9157,cpfk_part_lineitem#9158,cfpk_lineitem_part#9159,cpfk_partsupp_lineitem#9160,cfpk_lineitem_orders#9161,cval_lineitem_l_quantity#9162,cval_lineitem_l_extendedprice#9163,cval_lineitem_l_discount#9164,cval_lineitem_l_tax#9165,cval_lineitem_l_returnflag#9166,cval_lineitem_l_linestatus#9167,cval_lineitem_l_commitdate#9168,cval_lineitem_l_receiptdate#9169,cval_lineitem_l_shipinstruct#9170,cval_lineitem_l_shipmode#9171,cval_lineitem_l_comment#9172,cval_lineitem_l_shipdate#9173,cdepval_lineitem_l_quantity#9174,cdepval_lineitem_l_extendedprice#9175,cdepval_lineitem_l_discount#9176,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               +- Project [rid#9381 AS rid_3#9399, cpfk_nation_supplier#9382 AS cpfk_nation_supplier_3#9400, cfpk_supplier_nation#9383 AS cfpk_supplier_nation_3#9401, cval_supplier_s_name#9384 AS cval_supplier_s_name_3#9402, cval_supplier_s_address#9385 AS cval_supplier_s_address_3#9403, cval_supplier_s_phone#9386 AS cval_supplier_s_phone_3#9404, cval_supplier_s_acctbal#9387 AS cval_supplier_s_acctbal_3#9405, cval_supplier_s_comment#9388 AS cval_supplier_s_comment_3#9406, cdepval_supplier_s_name#9389 AS cdepval_supplier_s_name_3#9407, cdepval_supplier_s_address#9390 AS cdepval_supplier_s_address_3#9408, cdepval_supplier_s_phone#9391 AS cdepval_supplier_s_phone_3#9409, cdepval_supplier_s_acctbal#9392 AS cdepval_supplier_s_acctbal_3#9410, cdepval_supplier_s_comment#9393 AS cdepval_supplier_s_comment_3#9411, cs_name#9394 AS cs_name_3#9412, cs_address#9395 AS cs_address_3#9413, cs_phone#9396 AS cs_phone_3#9414, cs_acctbal#9397 AS cs_acctbal_3#9415, cs_comment#9398 AS cs_comment_3#9416]
                  +- Relation[rid#9381,cpfk_nation_supplier#9382,cfpk_supplier_nation#9383,cval_supplier_s_name#9384,cval_supplier_s_address#9385,cval_supplier_s_phone#9386,cval_supplier_s_acctbal#9387,cval_supplier_s_comment#9388,cdepval_supplier_s_name#9389,cdepval_supplier_s_address#9390,cdepval_supplier_s_phone#9391,cdepval_supplier_s_acctbal#9392,cdepval_supplier_s_comment#9393,cs_name#9394,cs_address#9395,cs_phone#9396,cs_acctbal#9397,cs_comment#9398] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 179941ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/26 21:19:41 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:19:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9655L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:19:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:19:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:19:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9655L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#9693 AS rid_1#9738, cpfk_orders_lineitem#9694 AS cpfk_orders_lineitem_1#9739, cpfk_supplier_lineitem#9695 AS cpfk_supplier_lineitem_1#9740, cfpk_lineitem_supplier#9696 AS cfpk_lineitem_supplier_1#9741, cfpk_lineitem_partsupp#9697 AS cfpk_lineitem_partsupp_1#9742, cpfk_part_lineitem#9698 AS cpfk_part_lineitem_1#9743, cfpk_lineitem_part#9699 AS cfpk_lineitem_part_1#9744, cpfk_partsupp_lineitem#9700 AS cpfk_partsupp_lineitem_1#9745, cfpk_lineitem_orders#9701 AS cfpk_lineitem_orders_1#9746, cval_lineitem_l_quantity#9702 AS cval_lineitem_l_quantity_1#9747, cval_lineitem_l_extendedprice#9703 AS cval_lineitem_l_extendedprice_1#9748, cval_lineitem_l_discount#9704 AS cval_lineitem_l_discount_1#9749, cval_lineitem_l_tax#9705 AS cval_lineitem_l_tax_1#9750, cval_lineitem_l_returnflag#9706 AS cval_lineitem_l_returnflag_1#9751, cval_lineitem_l_linestatus#9707 AS cval_lineitem_l_linestatus_1#9752, cval_lineitem_l_commitdate#9708 AS cval_lineitem_l_commitdate_1#9753, cval_lineitem_l_receiptdate#9709 AS cval_lineitem_l_receiptdate_1#9754, cval_lineitem_l_shipinstruct#9710 AS cval_lineitem_l_shipinstruct_1#9755, cval_lineitem_l_shipmode#9711 AS cval_lineitem_l_shipmode_1#9756, cval_lineitem_l_comment#9712 AS cval_lineitem_l_comment_1#9757, cval_lineitem_l_shipdate#9713 AS cval_lineitem_l_shipdate_1#9758, cdepval_lineitem_l_quantity#9714 AS cdepval_lineitem_l_quantity_1#9759, cdepval_lineitem_l_extendedprice#9715 AS cdepval_lineitem_l_extendedprice_1#9760, cdepval_lineitem_l_discount#9716 AS cdepval_lineitem_l_discount_1#9761, ... 21 more fields]
         :  +- Relation[rid#9693,cpfk_orders_lineitem#9694,cpfk_supplier_lineitem#9695,cfpk_lineitem_supplier#9696,cfpk_lineitem_partsupp#9697,cpfk_part_lineitem#9698,cfpk_lineitem_part#9699,cpfk_partsupp_lineitem#9700,cfpk_lineitem_orders#9701,cval_lineitem_l_quantity#9702,cval_lineitem_l_extendedprice#9703,cval_lineitem_l_discount#9704,cval_lineitem_l_tax#9705,cval_lineitem_l_returnflag#9706,cval_lineitem_l_linestatus#9707,cval_lineitem_l_commitdate#9708,cval_lineitem_l_receiptdate#9709,cval_lineitem_l_shipinstruct#9710,cval_lineitem_l_shipmode#9711,cval_lineitem_l_comment#9712,cval_lineitem_l_shipdate#9713,cdepval_lineitem_l_quantity#9714,cdepval_lineitem_l_extendedprice#9715,cdepval_lineitem_l_discount#9716,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#9657 AS rid_0#9675, cpfk_nation_supplier#9658 AS cpfk_nation_supplier_0#9676, cfpk_supplier_nation#9659 AS cfpk_supplier_nation_0#9677, cval_supplier_s_name#9660 AS cval_supplier_s_name_0#9678, cval_supplier_s_address#9661 AS cval_supplier_s_address_0#9679, cval_supplier_s_phone#9662 AS cval_supplier_s_phone_0#9680, cval_supplier_s_acctbal#9663 AS cval_supplier_s_acctbal_0#9681, cval_supplier_s_comment#9664 AS cval_supplier_s_comment_0#9682, cdepval_supplier_s_name#9665 AS cdepval_supplier_s_name_0#9683, cdepval_supplier_s_address#9666 AS cdepval_supplier_s_address_0#9684, cdepval_supplier_s_phone#9667 AS cdepval_supplier_s_phone_0#9685, cdepval_supplier_s_acctbal#9668 AS cdepval_supplier_s_acctbal_0#9686, cdepval_supplier_s_comment#9669 AS cdepval_supplier_s_comment_0#9687, cs_name#9670 AS cs_name_0#9688, cs_address#9671 AS cs_address_0#9689, cs_phone#9672 AS cs_phone_0#9690, cs_acctbal#9673 AS cs_acctbal_0#9691, cs_comment#9674 AS cs_comment_0#9692]
            +- Relation[rid#9657,cpfk_nation_supplier#9658,cfpk_supplier_nation#9659,cval_supplier_s_name#9660,cval_supplier_s_address#9661,cval_supplier_s_phone#9662,cval_supplier_s_acctbal#9663,cval_supplier_s_comment#9664,cdepval_supplier_s_name#9665,cdepval_supplier_s_address#9666,cdepval_supplier_s_phone#9667,cdepval_supplier_s_acctbal#9668,cdepval_supplier_s_comment#9669,cs_name#9670,cs_address#9671,cs_phone#9672,cs_acctbal#9673,cs_comment#9674] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17220ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/26 21:19:58 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:19:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9858L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 21:19:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:19:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:19:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9858L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#9860 AS rid_0#9905, cpfk_orders_lineitem#9861 AS cpfk_orders_lineitem_0#9906, cpfk_supplier_lineitem#9862 AS cpfk_supplier_lineitem_0#9907, cfpk_lineitem_supplier#9863 AS cfpk_lineitem_supplier_0#9908, cfpk_lineitem_partsupp#9864 AS cfpk_lineitem_partsupp_0#9909, cpfk_part_lineitem#9865 AS cpfk_part_lineitem_0#9910, cfpk_lineitem_part#9866 AS cfpk_lineitem_part_0#9911, cpfk_partsupp_lineitem#9867 AS cpfk_partsupp_lineitem_0#9912, cfpk_lineitem_orders#9868 AS cfpk_lineitem_orders_0#9913, cval_lineitem_l_quantity#9869 AS cval_lineitem_l_quantity_0#9914, cval_lineitem_l_extendedprice#9870 AS cval_lineitem_l_extendedprice_0#9915, cval_lineitem_l_discount#9871 AS cval_lineitem_l_discount_0#9916, cval_lineitem_l_tax#9872 AS cval_lineitem_l_tax_0#9917, cval_lineitem_l_returnflag#9873 AS cval_lineitem_l_returnflag_0#9918, cval_lineitem_l_linestatus#9874 AS cval_lineitem_l_linestatus_0#9919, cval_lineitem_l_commitdate#9875 AS cval_lineitem_l_commitdate_0#9920, cval_lineitem_l_receiptdate#9876 AS cval_lineitem_l_receiptdate_0#9921, cval_lineitem_l_shipinstruct#9877 AS cval_lineitem_l_shipinstruct_0#9922, cval_lineitem_l_shipmode#9878 AS cval_lineitem_l_shipmode_0#9923, cval_lineitem_l_comment#9879 AS cval_lineitem_l_comment_0#9924, cval_lineitem_l_shipdate#9880 AS cval_lineitem_l_shipdate_0#9925, cdepval_lineitem_l_quantity#9881 AS cdepval_lineitem_l_quantity_0#9926, cdepval_lineitem_l_extendedprice#9882 AS cdepval_lineitem_l_extendedprice_0#9927, cdepval_lineitem_l_discount#9883 AS cdepval_lineitem_l_discount_0#9928, ... 21 more fields]
         :  :  :     +- Relation[rid#9860,cpfk_orders_lineitem#9861,cpfk_supplier_lineitem#9862,cfpk_lineitem_supplier#9863,cfpk_lineitem_partsupp#9864,cpfk_part_lineitem#9865,cfpk_lineitem_part#9866,cpfk_partsupp_lineitem#9867,cfpk_lineitem_orders#9868,cval_lineitem_l_quantity#9869,cval_lineitem_l_extendedprice#9870,cval_lineitem_l_discount#9871,cval_lineitem_l_tax#9872,cval_lineitem_l_returnflag#9873,cval_lineitem_l_linestatus#9874,cval_lineitem_l_commitdate#9875,cval_lineitem_l_receiptdate#9876,cval_lineitem_l_shipinstruct#9877,cval_lineitem_l_shipmode#9878,cval_lineitem_l_comment#9879,cval_lineitem_l_shipdate#9880,cdepval_lineitem_l_quantity#9881,cdepval_lineitem_l_extendedprice#9882,cdepval_lineitem_l_discount#9883,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#10040 AS rid_1#10064, cpfk_customer_orders#10041 AS cpfk_customer_orders_1#10065, cfpk_orders_customer#10042 AS cfpk_orders_customer_1#10066, cval_orders_o_orderstatus#10043 AS cval_orders_o_orderstatus_1#10067, cval_orders_o_totalprice#10044 AS cval_orders_o_totalprice_1#10068, cval_orders_o_orderpriority#10045 AS cval_orders_o_orderpriority_1#10069, cval_orders_o_clerk#10046 AS cval_orders_o_clerk_1#10070, cval_orders_o_shippriority#10047 AS cval_orders_o_shippriority_1#10071, cval_orders_o_comment#10048 AS cval_orders_o_comment_1#10072, cval_orders_o_orderdate#10049 AS cval_orders_o_orderdate_1#10073, cdepval_orders_o_orderstatus#10050 AS cdepval_orders_o_orderstatus_1#10074, cdepval_orders_o_totalprice#10051 AS cdepval_orders_o_totalprice_1#10075, cdepval_orders_o_orderpriority#10052 AS cdepval_orders_o_orderpriority_1#10076, cdepval_orders_o_clerk#10053 AS cdepval_orders_o_clerk_1#10077, cdepval_orders_o_shippriority#10054 AS cdepval_orders_o_shippriority_1#10078, cdepval_orders_o_comment#10055 AS cdepval_orders_o_comment_1#10079, cdepval_orders_o_orderdate#10056 AS cdepval_orders_o_orderdate_1#10080, co_orderstatus#10057 AS co_orderstatus_1#10081, co_totalprice#10058 AS co_totalprice_1#10082, co_orderpriority#10059 AS co_orderpriority_1#10083, co_clerk#10060 AS co_clerk_1#10084, co_shippriority#10061 AS co_shippriority_1#10085, co_comment#10062 AS co_comment_1#10086, co_orderdate#10063 AS co_orderdate_1#10087]
         :  :     +- Relation[rid#10040,cpfk_customer_orders#10041,cfpk_orders_customer#10042,cval_orders_o_orderstatus#10043,cval_orders_o_totalprice#10044,cval_orders_o_orderpriority#10045,cval_orders_o_clerk#10046,cval_orders_o_shippriority#10047,cval_orders_o_comment#10048,cval_orders_o_orderdate#10049,cdepval_orders_o_orderstatus#10050,cdepval_orders_o_totalprice#10051,cdepval_orders_o_orderpriority#10052,cdepval_orders_o_clerk#10053,cdepval_orders_o_shippriority#10054,cdepval_orders_o_comment#10055,cdepval_orders_o_orderdate#10056,co_orderstatus#10057,co_totalprice#10058,co_orderpriority#10059,co_clerk#10060,co_shippriority#10061,co_comment#10062,co_orderdate#10063] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#10088 AS rid_2#10109, cpfk_nation_customer#10089 AS cpfk_nation_customer_2#10110, cfpk_customer_nation#10090 AS cfpk_customer_nation_2#10111, cval_customer_c_name#10091 AS cval_customer_c_name_2#10112, cval_customer_c_address#10092 AS cval_customer_c_address_2#10113, cval_customer_c_phone#10093 AS cval_customer_c_phone_2#10114, cval_customer_c_acctbal#10094 AS cval_customer_c_acctbal_2#10115, cval_customer_c_comment#10095 AS cval_customer_c_comment_2#10116, cval_customer_c_mktsegment#10096 AS cval_customer_c_mktsegment_2#10117, cdepval_customer_c_name#10097 AS cdepval_customer_c_name_2#10118, cdepval_customer_c_address#10098 AS cdepval_customer_c_address_2#10119, cdepval_customer_c_phone#10099 AS cdepval_customer_c_phone_2#10120, cdepval_customer_c_acctbal#10100 AS cdepval_customer_c_acctbal_2#10121, cdepval_customer_c_comment#10101 AS cdepval_customer_c_comment_2#10122, cdepval_customer_c_mktsegment#10102 AS cdepval_customer_c_mktsegment_2#10123, cc_name#10103 AS cc_name_2#10124, cc_address#10104 AS cc_address_2#10125, cc_phone#10105 AS cc_phone_2#10126, cc_acctbal#10106 AS cc_acctbal_2#10127, cc_comment#10107 AS cc_comment_2#10128, cc_mktsegment#10108 AS cc_mktsegment_2#10129]
         :     +- Relation[rid#10088,cpfk_nation_customer#10089,cfpk_customer_nation#10090,cval_customer_c_name#10091,cval_customer_c_address#10092,cval_customer_c_phone#10093,cval_customer_c_acctbal#10094,cval_customer_c_comment#10095,cval_customer_c_mktsegment#10096,cdepval_customer_c_name#10097,cdepval_customer_c_address#10098,cdepval_customer_c_phone#10099,cdepval_customer_c_acctbal#10100,cdepval_customer_c_comment#10101,cdepval_customer_c_mktsegment#10102,cc_name#10103,cc_address#10104,cc_phone#10105,cc_acctbal#10106,cc_comment#10107,cc_mktsegment#10108] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#10130 AS rid_3#10139, cpfk_region_nation#10131 AS cpfk_region_nation_3#10140, cfpk_nation_region#10132 AS cfpk_nation_region_3#10141, cval_nation_n_name#10133 AS cval_nation_n_name_3#10142, cval_nation_n_comment#10134 AS cval_nation_n_comment_3#10143, cdepval_nation_n_name#10135 AS cdepval_nation_n_name_3#10144, cdepval_nation_n_comment#10136 AS cdepval_nation_n_comment_3#10145, cn_name#10137 AS cn_name_3#10146, cn_comment#10138 AS cn_comment_3#10147]
            +- Relation[rid#10130,cpfk_region_nation#10131,cfpk_nation_region#10132,cval_nation_n_name#10133,cval_nation_n_comment#10134,cdepval_nation_n_name#10135,cdepval_nation_n_comment#10136,cn_name#10137,cn_comment#10138] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 76488ms
query=q1, count=6001215, duration=2783
query=q10, count=1478870, duration=76488
query=q11, count=31680, duration=4138
query=q12, count=857401, duration=22044
query=q13, count=1500000, duration=4320
query=q14, count=6001215, duration=17675
query=q15, count=6001215, duration=17220
query=q16, count=15780, duration=1853
query=q17, count=6088, duration=520
query=q18, count=6001215, duration=22086
query=q19, count=205, duration=34526
query=q2, count=3162, duration=850
query=q20, count=632, duration=5523
query=q21a, count=597422, duration=179941
query=q22, count=1500000, duration=10100
query=q3, count=1214743, duration=28004
query=q4, count=6001215, duration=18287
query=q5, count=48089, duration=30157
query=q6, count=6001215, duration=2266
query=q7, count=9735, duration=40807
query=q8, count=8716, duration=16973
query=q9a, count=6001215, duration=90276
query=q9b, count=6001215, duration=37865
