20/04/11 04:31:40 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 11401ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 11 04:31:43 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 11 04:31:44 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 11 04:31:45 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 11 04:31:45 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 11 04:31:45 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 11 04:31:49 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 11 04:31:53 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 11 04:31:53 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/11 04:31:55 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:31:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2078L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:31:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:31:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2078L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#2080 AS rid_0#2085, cval_region_r_name#2081 AS cval_region_r_name_0#2086, cval_region_r_comment#2082 AS cval_region_r_comment_0#2087, cr_name#2083 AS cr_name_0#2088, cr_comment#2084 AS cr_comment_0#2089]
         :  :  :  :  :  :  :  +- Relation[rid#2080,cval_region_r_name#2081,cval_region_r_comment#2082,cr_name#2083,cr_comment#2084] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#2090 AS rid_0#2095, cval_region_r_name#2091 AS cval_region_r_name_0#2096, cval_region_r_comment#2092 AS cval_region_r_comment_0#2097, cr_name#2093 AS cr_name_0#2098, cr_comment#2094 AS cr_comment_0#2099]
         :  :  :  :  :  :        +- Relation[rid#2090,cval_region_r_name#2091,cval_region_r_comment#2092,cr_name#2093,cr_comment#2094] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :     :- Project [rid#2114 AS rid_0#2119, cval_region_r_name#2115 AS cval_region_r_name_0#2120, cval_region_r_comment#2116 AS cval_region_r_comment_0#2121, cr_name#2117 AS cr_name_0#2122, cr_comment#2118 AS cr_comment_0#2123]
         :  :  :  :  :     :  +- Relation[rid#2114,cval_region_r_name#2115,cval_region_r_comment#2116,cr_name#2117,cr_comment#2118] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :     +- Project [rid#2124 AS rid_1#2131, cpfk_region_nation#2125 AS cpfk_region_nation_1#2132, cfpk_nation_region#2126 AS cfpk_nation_region_1#2133, cval_nation_n_name#2127 AS cval_nation_n_name_1#2134, cval_nation_n_comment#2128 AS cval_nation_n_comment_1#2135, cn_name#2129 AS cn_name_1#2136, cn_comment#2130 AS cn_comment_1#2137]
         :  :  :  :  :        +- Relation[rid#2124,cpfk_region_nation#2125,cfpk_nation_region#2126,cval_nation_n_name#2127,cval_nation_n_comment#2128,cn_name#2129,cn_comment#2130] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#2100 AS rid_1#2107, cpfk_region_nation#2101 AS cpfk_region_nation_1#2108, cfpk_nation_region#2102 AS cfpk_nation_region_1#2109, cval_nation_n_name#2103 AS cval_nation_n_name_1#2110, cval_nation_n_comment#2104 AS cval_nation_n_comment_1#2111, cn_name#2105 AS cn_name_1#2112, cn_comment#2106 AS cn_comment_1#2113]
         :  :  :  :     +- Relation[rid#2100,cpfk_region_nation#2101,cfpk_nation_region#2102,cval_nation_n_name#2103,cval_nation_n_comment#2104,cn_name#2105,cn_comment#2106] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :     :- Project [rid#2164 AS rid_1#2171, cpfk_region_nation#2165 AS cpfk_region_nation_1#2172, cfpk_nation_region#2166 AS cfpk_nation_region_1#2173, cval_nation_n_name#2167 AS cval_nation_n_name_1#2174, cval_nation_n_comment#2168 AS cval_nation_n_comment_1#2175, cn_name#2169 AS cn_name_1#2176, cn_comment#2170 AS cn_comment_1#2177]
         :  :  :     :  +- Relation[rid#2164,cpfk_region_nation#2165,cfpk_nation_region#2166,cval_nation_n_name#2167,cval_nation_n_comment#2168,cn_name#2169,cn_comment#2170] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#2178 AS rid_2#2191, cpfk_nation_supplier#2179 AS cpfk_nation_supplier_2#2192, cfpk_supplier_nation#2180 AS cfpk_supplier_nation_2#2193, cval_supplier_s_name#2181 AS cval_supplier_s_name_2#2194, cval_supplier_s_address#2182 AS cval_supplier_s_address_2#2195, cval_supplier_s_phone#2183 AS cval_supplier_s_phone_2#2196, cval_supplier_s_acctbal#2184 AS cval_supplier_s_acctbal_2#2197, cval_supplier_s_comment#2185 AS cval_supplier_s_comment_2#2198, cs_name#2186 AS cs_name_2#2199, cs_address#2187 AS cs_address_2#2200, cs_phone#2188 AS cs_phone_2#2201, cs_acctbal#2189 AS cs_acctbal_2#2202, cs_comment#2190 AS cs_comment_2#2203]
         :  :  :        +- Relation[rid#2178,cpfk_nation_supplier#2179,cfpk_supplier_nation#2180,cval_supplier_s_name#2181,cval_supplier_s_address#2182,cval_supplier_s_phone#2183,cval_supplier_s_acctbal#2184,cval_supplier_s_comment#2185,cs_name#2186,cs_address#2187,cs_phone#2188,cs_acctbal#2189,cs_comment#2190] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#2138 AS rid_2#2151, cpfk_nation_supplier#2139 AS cpfk_nation_supplier_2#2152, cfpk_supplier_nation#2140 AS cfpk_supplier_nation_2#2153, cval_supplier_s_name#2141 AS cval_supplier_s_name_2#2154, cval_supplier_s_address#2142 AS cval_supplier_s_address_2#2155, cval_supplier_s_phone#2143 AS cval_supplier_s_phone_2#2156, cval_supplier_s_acctbal#2144 AS cval_supplier_s_acctbal_2#2157, cval_supplier_s_comment#2145 AS cval_supplier_s_comment_2#2158, cs_name#2146 AS cs_name_2#2159, cs_address#2147 AS cs_address_2#2160, cs_phone#2148 AS cs_phone_2#2161, cs_acctbal#2149 AS cs_acctbal_2#2162, cs_comment#2150 AS cs_comment_2#2163]
         :  :     +- Relation[rid#2138,cpfk_nation_supplier#2139,cfpk_supplier_nation#2140,cval_supplier_s_name#2141,cval_supplier_s_address#2142,cval_supplier_s_phone#2143,cval_supplier_s_acctbal#2144,cval_supplier_s_comment#2145,cs_name#2146,cs_address#2147,cs_phone#2148,cs_acctbal#2149,cs_comment#2150] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :     :- Project [rid#2350 AS rid_2#2363, cpfk_nation_supplier#2351 AS cpfk_nation_supplier_2#2364, cfpk_supplier_nation#2352 AS cfpk_supplier_nation_2#2365, cval_supplier_s_name#2353 AS cval_supplier_s_name_2#2366, cval_supplier_s_address#2354 AS cval_supplier_s_address_2#2367, cval_supplier_s_phone#2355 AS cval_supplier_s_phone_2#2368, cval_supplier_s_acctbal#2356 AS cval_supplier_s_acctbal_2#2369, cval_supplier_s_comment#2357 AS cval_supplier_s_comment_2#2370, cs_name#2358 AS cs_name_2#2371, cs_address#2359 AS cs_address_2#2372, cs_phone#2360 AS cs_phone_2#2373, cs_acctbal#2361 AS cs_acctbal_2#2374, cs_comment#2362 AS cs_comment_2#2375]
         :     :  +- Relation[rid#2350,cpfk_nation_supplier#2351,cfpk_supplier_nation#2352,cval_supplier_s_name#2353,cval_supplier_s_address#2354,cval_supplier_s_phone#2355,cval_supplier_s_acctbal#2356,cval_supplier_s_comment#2357,cs_name#2358,cs_address#2359,cs_phone#2360,cs_acctbal#2361,cs_comment#2362] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#2376 AS rid_4#2387, cpfk_part_partsupp#2377 AS cpfk_part_partsupp_4#2388, cfpk_partsupp_part#2378 AS cfpk_partsupp_part_4#2389, cpfk_supplier_partsupp#2379 AS cpfk_supplier_partsupp_4#2390, cfpk_partsupp_supplier#2380 AS cfpk_partsupp_supplier_4#2391, cval_partsupp_ps_availqty#2381 AS cval_partsupp_ps_availqty_4#2392, cval_partsupp_ps_supplycost#2382 AS cval_partsupp_ps_supplycost_4#2393, cval_partsupp_ps_comment#2383 AS cval_partsupp_ps_comment_4#2394, cps_availqty#2384 AS cps_availqty_4#2395, cps_supplycost#2385 AS cps_supplycost_4#2396, cps_comment#2386 AS cps_comment_4#2397]
         :        +- Relation[rid#2376,cpfk_part_partsupp#2377,cfpk_partsupp_part#2378,cpfk_supplier_partsupp#2379,cfpk_partsupp_supplier#2380,cval_partsupp_ps_availqty#2381,cval_partsupp_ps_supplycost#2382,cval_partsupp_ps_comment#2383,cps_availqty#2384,cps_supplycost#2385,cps_comment#2386] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'Join UsingJoin(Inner,List(rid_3))
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#2204 AS rid_3#2221, cval_part_p_name#2205 AS cval_part_p_name_3#2222, cval_part_p_mfgr#2206 AS cval_part_p_mfgr_3#2223, cval_part_p_type#2207 AS cval_part_p_type_3#2224, cval_part_p_size#2208 AS cval_part_p_size_3#2225, cval_part_p_container#2209 AS cval_part_p_container_3#2226, cval_part_p_retailprice#2210 AS cval_part_p_retailprice_3#2227, cval_part_p_comment#2211 AS cval_part_p_comment_3#2228, cval_part_p_brand#2212 AS cval_part_p_brand_3#2229, cp_name#2213 AS cp_name_3#2230, cp_mfgr#2214 AS cp_mfgr_3#2231, cp_type#2215 AS cp_type_3#2232, cp_size#2216 AS cp_size_3#2233, cp_container#2217 AS cp_container_3#2234, cp_retailprice#2218 AS cp_retailprice_3#2235, cp_comment#2219 AS cp_comment_3#2236, cp_brand#2220 AS cp_brand_3#2237]
            :  :  :  +- Relation[rid#2204,cval_part_p_name#2205,cval_part_p_mfgr#2206,cval_part_p_type#2207,cval_part_p_size#2208,cval_part_p_container#2209,cval_part_p_retailprice#2210,cval_part_p_comment#2211,cval_part_p_brand#2212,cp_name#2213,cp_mfgr#2214,cp_type#2215,cp_size#2216,cp_container#2217,cp_retailprice#2218,cp_comment#2219,cp_brand#2220] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#2238 AS rid_3#2255, cval_part_p_name#2239 AS cval_part_p_name_3#2256, cval_part_p_mfgr#2240 AS cval_part_p_mfgr_3#2257, cval_part_p_type#2241 AS cval_part_p_type_3#2258, cval_part_p_size#2242 AS cval_part_p_size_3#2259, cval_part_p_container#2243 AS cval_part_p_container_3#2260, cval_part_p_retailprice#2244 AS cval_part_p_retailprice_3#2261, cval_part_p_comment#2245 AS cval_part_p_comment_3#2262, cval_part_p_brand#2246 AS cval_part_p_brand_3#2263, cp_name#2247 AS cp_name_3#2264, cp_mfgr#2248 AS cp_mfgr_3#2265, cp_type#2249 AS cp_type_3#2266, cp_size#2250 AS cp_size_3#2267, cp_container#2251 AS cp_container_3#2268, cp_retailprice#2252 AS cp_retailprice_3#2269, cp_comment#2253 AS cp_comment_3#2270, cp_brand#2254 AS cp_brand_3#2271]
            :  :        +- Relation[rid#2238,cval_part_p_name#2239,cval_part_p_mfgr#2240,cval_part_p_type#2241,cval_part_p_size#2242,cval_part_p_container#2243,cval_part_p_retailprice#2244,cval_part_p_comment#2245,cval_part_p_brand#2246,cp_name#2247,cp_mfgr#2248,cp_type#2249,cp_size#2250,cp_container#2251,cp_retailprice#2252,cp_comment#2253,cp_brand#2254] JDBCRelation(tpart) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :     :- Project [rid#2294 AS rid_3#2311, cval_part_p_name#2295 AS cval_part_p_name_3#2312, cval_part_p_mfgr#2296 AS cval_part_p_mfgr_3#2313, cval_part_p_type#2297 AS cval_part_p_type_3#2314, cval_part_p_size#2298 AS cval_part_p_size_3#2315, cval_part_p_container#2299 AS cval_part_p_container_3#2316, cval_part_p_retailprice#2300 AS cval_part_p_retailprice_3#2317, cval_part_p_comment#2301 AS cval_part_p_comment_3#2318, cval_part_p_brand#2302 AS cval_part_p_brand_3#2319, cp_name#2303 AS cp_name_3#2320, cp_mfgr#2304 AS cp_mfgr_3#2321, cp_type#2305 AS cp_type_3#2322, cp_size#2306 AS cp_size_3#2323, cp_container#2307 AS cp_container_3#2324, cp_retailprice#2308 AS cp_retailprice_3#2325, cp_comment#2309 AS cp_comment_3#2326, cp_brand#2310 AS cp_brand_3#2327]
            :     :  +- Relation[rid#2294,cval_part_p_name#2295,cval_part_p_mfgr#2296,cval_part_p_type#2297,cval_part_p_size#2298,cval_part_p_container#2299,cval_part_p_retailprice#2300,cval_part_p_comment#2301,cval_part_p_brand#2302,cp_name#2303,cp_mfgr#2304,cp_type#2305,cp_size#2306,cp_container#2307,cp_retailprice#2308,cp_comment#2309,cp_brand#2310] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#2328 AS rid_4#2339, cpfk_part_partsupp#2329 AS cpfk_part_partsupp_4#2340, cfpk_partsupp_part#2330 AS cfpk_partsupp_part_4#2341, cpfk_supplier_partsupp#2331 AS cpfk_supplier_partsupp_4#2342, cfpk_partsupp_supplier#2332 AS cfpk_partsupp_supplier_4#2343, cval_partsupp_ps_availqty#2333 AS cval_partsupp_ps_availqty_4#2344, cval_partsupp_ps_supplycost#2334 AS cval_partsupp_ps_supplycost_4#2345, cval_partsupp_ps_comment#2335 AS cval_partsupp_ps_comment_4#2346, cps_availqty#2336 AS cps_availqty_4#2347, cps_supplycost#2337 AS cps_supplycost_4#2348, cps_comment#2338 AS cps_comment_4#2349]
            :        +- Relation[rid#2328,cpfk_part_partsupp#2329,cfpk_partsupp_part#2330,cpfk_supplier_partsupp#2331,cfpk_partsupp_supplier#2332,cval_partsupp_ps_availqty#2333,cval_partsupp_ps_supplycost#2334,cval_partsupp_ps_comment#2335,cps_availqty#2336,cps_supplycost#2337,cps_comment#2338] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#2272 AS rid_4#2283, cpfk_part_partsupp#2273 AS cpfk_part_partsupp_4#2284, cfpk_partsupp_part#2274 AS cfpk_partsupp_part_4#2285, cpfk_supplier_partsupp#2275 AS cpfk_supplier_partsupp_4#2286, cfpk_partsupp_supplier#2276 AS cfpk_partsupp_supplier_4#2287, cval_partsupp_ps_availqty#2277 AS cval_partsupp_ps_availqty_4#2288, cval_partsupp_ps_supplycost#2278 AS cval_partsupp_ps_supplycost_4#2289, cval_partsupp_ps_comment#2279 AS cval_partsupp_ps_comment_4#2290, cps_availqty#2280 AS cps_availqty_4#2291, cps_supplycost#2281 AS cps_supplycost_4#2292, cps_comment#2282 AS cps_comment_4#2293]
               +- Relation[rid#2272,cpfk_part_partsupp#2273,cfpk_partsupp_part#2274,cpfk_supplier_partsupp#2275,cfpk_partsupp_supplier#2276,cval_partsupp_ps_availqty#2277,cval_partsupp_ps_supplycost#2278,cval_partsupp_ps_comment#2279,cps_availqty#2280,cps_supplycost#2281,cps_comment#2282] JDBCRelation(tpartsupp) [numPartitions=1]

20/04/11 04:31:55 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexPkFk$ result size=3162
Elapsed time: 21318ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/11 04:32:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:32:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2459L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 04:32:16 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 04:32:16 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 04:32:16 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 04:32:16 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 04:32:16 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 04:32:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2459L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#2461 AS rid_0#2476, cpfk_nation_customer#2462 AS cpfk_nation_customer_0#2477, cfpk_customer_nation#2463 AS cfpk_customer_nation_0#2478, cval_customer_c_name#2464 AS cval_customer_c_name_0#2479, cval_customer_c_address#2465 AS cval_customer_c_address_0#2480, cval_customer_c_phone#2466 AS cval_customer_c_phone_0#2481, cval_customer_c_acctbal#2467 AS cval_customer_c_acctbal_0#2482, cval_customer_c_comment#2468 AS cval_customer_c_comment_0#2483, cval_customer_c_mktsegment#2469 AS cval_customer_c_mktsegment_0#2484, cc_name#2470 AS cc_name_0#2485, cc_address#2471 AS cc_address_0#2486, cc_phone#2472 AS cc_phone_0#2487, cc_acctbal#2473 AS cc_acctbal_0#2488, cc_comment#2474 AS cc_comment_0#2489, cc_mktsegment#2475 AS cc_mktsegment_0#2490]
         :  :  :  :  :  +- Relation[rid#2461,cpfk_nation_customer#2462,cfpk_customer_nation#2463,cval_customer_c_name#2464,cval_customer_c_address#2465,cval_customer_c_phone#2466,cval_customer_c_acctbal#2467,cval_customer_c_comment#2468,cval_customer_c_mktsegment#2469,cc_name#2470,cc_address#2471,cc_phone#2472,cc_acctbal#2473,cc_comment#2474,cc_mktsegment#2475] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#2491 AS rid_0#2506, cpfk_nation_customer#2492 AS cpfk_nation_customer_0#2507, cfpk_customer_nation#2493 AS cfpk_customer_nation_0#2508, cval_customer_c_name#2494 AS cval_customer_c_name_0#2509, cval_customer_c_address#2495 AS cval_customer_c_address_0#2510, cval_customer_c_phone#2496 AS cval_customer_c_phone_0#2511, cval_customer_c_acctbal#2497 AS cval_customer_c_acctbal_0#2512, cval_customer_c_comment#2498 AS cval_customer_c_comment_0#2513, cval_customer_c_mktsegment#2499 AS cval_customer_c_mktsegment_0#2514, cc_name#2500 AS cc_name_0#2515, cc_address#2501 AS cc_address_0#2516, cc_phone#2502 AS cc_phone_0#2517, cc_acctbal#2503 AS cc_acctbal_0#2518, cc_comment#2504 AS cc_comment_0#2519, cc_mktsegment#2505 AS cc_mktsegment_0#2520]
         :  :  :  :        +- Relation[rid#2491,cpfk_nation_customer#2492,cfpk_customer_nation#2493,cval_customer_c_name#2494,cval_customer_c_address#2495,cval_customer_c_phone#2496,cval_customer_c_acctbal#2497,cval_customer_c_comment#2498,cval_customer_c_mktsegment#2499,cc_name#2500,cc_address#2501,cc_phone#2502,cc_acctbal#2503,cc_comment#2504,cc_mktsegment#2505] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#2555 AS rid_0#2570, cpfk_nation_customer#2556 AS cpfk_nation_customer_0#2571, cfpk_customer_nation#2557 AS cfpk_customer_nation_0#2572, cval_customer_c_name#2558 AS cval_customer_c_name_0#2573, cval_customer_c_address#2559 AS cval_customer_c_address_0#2574, cval_customer_c_phone#2560 AS cval_customer_c_phone_0#2575, cval_customer_c_acctbal#2561 AS cval_customer_c_acctbal_0#2576, cval_customer_c_comment#2562 AS cval_customer_c_comment_0#2577, cval_customer_c_mktsegment#2563 AS cval_customer_c_mktsegment_0#2578, cc_name#2564 AS cc_name_0#2579, cc_address#2565 AS cc_address_0#2580, cc_phone#2566 AS cc_phone_0#2581, cc_acctbal#2567 AS cc_acctbal_0#2582, cc_comment#2568 AS cc_comment_0#2583, cc_mktsegment#2569 AS cc_mktsegment_0#2584]
         :  :  :     :  +- Relation[rid#2555,cpfk_nation_customer#2556,cfpk_customer_nation#2557,cval_customer_c_name#2558,cval_customer_c_address#2559,cval_customer_c_phone#2560,cval_customer_c_acctbal#2561,cval_customer_c_comment#2562,cval_customer_c_mktsegment#2563,cc_name#2564,cc_address#2565,cc_phone#2566,cc_acctbal#2567,cc_comment#2568,cc_mktsegment#2569] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#2585 AS rid_1#2602, cpfk_customer_orders#2586 AS cpfk_customer_orders_1#2603, cfpk_orders_customer#2587 AS cfpk_orders_customer_1#2604, cval_orders_o_orderstatus#2588 AS cval_orders_o_orderstatus_1#2605, cval_orders_o_totalprice#2589 AS cval_orders_o_totalprice_1#2606, cval_orders_o_orderpriority#2590 AS cval_orders_o_orderpriority_1#2607, cval_orders_o_clerk#2591 AS cval_orders_o_clerk_1#2608, cval_orders_o_shippriority#2592 AS cval_orders_o_shippriority_1#2609, cval_orders_o_comment#2593 AS cval_orders_o_comment_1#2610, cval_orders_o_orderdate#2594 AS cval_orders_o_orderdate_1#2611, co_orderstatus#2595 AS co_orderstatus_1#2612, co_totalprice#2596 AS co_totalprice_1#2613, co_orderpriority#2597 AS co_orderpriority_1#2614, co_clerk#2598 AS co_clerk_1#2615, co_shippriority#2599 AS co_shippriority_1#2616, co_comment#2600 AS co_comment_1#2617, co_orderdate#2601 AS co_orderdate_1#2618]
         :  :  :        +- Relation[rid#2585,cpfk_customer_orders#2586,cfpk_orders_customer#2587,cval_orders_o_orderstatus#2588,cval_orders_o_totalprice#2589,cval_orders_o_orderpriority#2590,cval_orders_o_clerk#2591,cval_orders_o_shippriority#2592,cval_orders_o_comment#2593,cval_orders_o_orderdate#2594,co_orderstatus#2595,co_totalprice#2596,co_orderpriority#2597,co_clerk#2598,co_shippriority#2599,co_comment#2600,co_orderdate#2601] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#2521 AS rid_1#2538, cpfk_customer_orders#2522 AS cpfk_customer_orders_1#2539, cfpk_orders_customer#2523 AS cfpk_orders_customer_1#2540, cval_orders_o_orderstatus#2524 AS cval_orders_o_orderstatus_1#2541, cval_orders_o_totalprice#2525 AS cval_orders_o_totalprice_1#2542, cval_orders_o_orderpriority#2526 AS cval_orders_o_orderpriority_1#2543, cval_orders_o_clerk#2527 AS cval_orders_o_clerk_1#2544, cval_orders_o_shippriority#2528 AS cval_orders_o_shippriority_1#2545, cval_orders_o_comment#2529 AS cval_orders_o_comment_1#2546, cval_orders_o_orderdate#2530 AS cval_orders_o_orderdate_1#2547, co_orderstatus#2531 AS co_orderstatus_1#2548, co_totalprice#2532 AS co_totalprice_1#2549, co_orderpriority#2533 AS co_orderpriority_1#2550, co_clerk#2534 AS co_clerk_1#2551, co_shippriority#2535 AS co_shippriority_1#2552, co_comment#2536 AS co_comment_1#2553, co_orderdate#2537 AS co_orderdate_1#2554]
         :  :     +- Relation[rid#2521,cpfk_customer_orders#2522,cfpk_orders_customer#2523,cval_orders_o_orderstatus#2524,cval_orders_o_totalprice#2525,cval_orders_o_orderpriority#2526,cval_orders_o_clerk#2527,cval_orders_o_shippriority#2528,cval_orders_o_comment#2529,cval_orders_o_orderdate#2530,co_orderstatus#2531,co_totalprice#2532,co_orderpriority#2533,co_clerk#2534,co_shippriority#2535,co_comment#2536,co_orderdate#2537] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#2685 AS rid_1#2702, cpfk_customer_orders#2686 AS cpfk_customer_orders_1#2703, cfpk_orders_customer#2687 AS cfpk_orders_customer_1#2704, cval_orders_o_orderstatus#2688 AS cval_orders_o_orderstatus_1#2705, cval_orders_o_totalprice#2689 AS cval_orders_o_totalprice_1#2706, cval_orders_o_orderpriority#2690 AS cval_orders_o_orderpriority_1#2707, cval_orders_o_clerk#2691 AS cval_orders_o_clerk_1#2708, cval_orders_o_shippriority#2692 AS cval_orders_o_shippriority_1#2709, cval_orders_o_comment#2693 AS cval_orders_o_comment_1#2710, cval_orders_o_orderdate#2694 AS cval_orders_o_orderdate_1#2711, co_orderstatus#2695 AS co_orderstatus_1#2712, co_totalprice#2696 AS co_totalprice_1#2713, co_orderpriority#2697 AS co_orderpriority_1#2714, co_clerk#2698 AS co_clerk_1#2715, co_shippriority#2699 AS co_shippriority_1#2716, co_comment#2700 AS co_comment_1#2717, co_orderdate#2701 AS co_orderdate_1#2718]
         :     :  +- Relation[rid#2685,cpfk_customer_orders#2686,cfpk_orders_customer#2687,cval_orders_o_orderstatus#2688,cval_orders_o_totalprice#2689,cval_orders_o_orderpriority#2690,cval_orders_o_clerk#2691,cval_orders_o_shippriority#2692,cval_orders_o_comment#2693,cval_orders_o_orderdate#2694,co_orderstatus#2695,co_totalprice#2696,co_orderpriority#2697,co_clerk#2698,co_shippriority#2699,co_comment#2700,co_orderdate#2701] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#2719 AS rid_2#2752, cpfk_orders_lineitem#2720 AS cpfk_orders_lineitem_2#2753, cpfk_supplier_lineitem#2721 AS cpfk_supplier_lineitem_2#2754, cfpk_lineitem_supplier#2722 AS cfpk_lineitem_supplier_2#2755, cfpk_lineitem_partsupp#2723 AS cfpk_lineitem_partsupp_2#2756, cpfk_part_lineitem#2724 AS cpfk_part_lineitem_2#2757, cfpk_lineitem_part#2725 AS cfpk_lineitem_part_2#2758, cpfk_partsupp_lineitem#2726 AS cpfk_partsupp_lineitem_2#2759, cfpk_lineitem_orders#2727 AS cfpk_lineitem_orders_2#2760, cval_lineitem_l_quantity#2728 AS cval_lineitem_l_quantity_2#2761, cval_lineitem_l_extendedprice#2729 AS cval_lineitem_l_extendedprice_2#2762, cval_lineitem_l_discount#2730 AS cval_lineitem_l_discount_2#2763, cval_lineitem_l_tax#2731 AS cval_lineitem_l_tax_2#2764, cval_lineitem_l_returnflag#2732 AS cval_lineitem_l_returnflag_2#2765, cval_lineitem_l_linestatus#2733 AS cval_lineitem_l_linestatus_2#2766, cval_lineitem_l_commitdate#2734 AS cval_lineitem_l_commitdate_2#2767, cval_lineitem_l_receiptdate#2735 AS cval_lineitem_l_receiptdate_2#2768, cval_lineitem_l_shipinstruct#2736 AS cval_lineitem_l_shipinstruct_2#2769, cval_lineitem_l_shipmode#2737 AS cval_lineitem_l_shipmode_2#2770, cval_lineitem_l_comment#2738 AS cval_lineitem_l_comment_2#2771, cval_lineitem_l_shipdate#2739 AS cval_lineitem_l_shipdate_2#2772, cl_quantity#2740 AS cl_quantity_2#2773, cl_extendedprice#2741 AS cl_extendedprice_2#2774, cl_discount#2742 AS cl_discount_2#2775, ... 9 more fields]
         :        +- Relation[rid#2719,cpfk_orders_lineitem#2720,cpfk_supplier_lineitem#2721,cfpk_lineitem_supplier#2722,cfpk_lineitem_partsupp#2723,cpfk_part_lineitem#2724,cfpk_lineitem_part#2725,cpfk_partsupp_lineitem#2726,cfpk_lineitem_orders#2727,cval_lineitem_l_quantity#2728,cval_lineitem_l_extendedprice#2729,cval_lineitem_l_discount#2730,cval_lineitem_l_tax#2731,cval_lineitem_l_returnflag#2732,cval_lineitem_l_linestatus#2733,cval_lineitem_l_commitdate#2734,cval_lineitem_l_receiptdate#2735,cval_lineitem_l_shipinstruct#2736,cval_lineitem_l_shipmode#2737,cval_lineitem_l_comment#2738,cval_lineitem_l_shipdate#2739,cl_quantity#2740,cl_extendedprice#2741,cl_discount#2742,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2619 AS rid_2#2652, cpfk_orders_lineitem#2620 AS cpfk_orders_lineitem_2#2653, cpfk_supplier_lineitem#2621 AS cpfk_supplier_lineitem_2#2654, cfpk_lineitem_supplier#2622 AS cfpk_lineitem_supplier_2#2655, cfpk_lineitem_partsupp#2623 AS cfpk_lineitem_partsupp_2#2656, cpfk_part_lineitem#2624 AS cpfk_part_lineitem_2#2657, cfpk_lineitem_part#2625 AS cfpk_lineitem_part_2#2658, cpfk_partsupp_lineitem#2626 AS cpfk_partsupp_lineitem_2#2659, cfpk_lineitem_orders#2627 AS cfpk_lineitem_orders_2#2660, cval_lineitem_l_quantity#2628 AS cval_lineitem_l_quantity_2#2661, cval_lineitem_l_extendedprice#2629 AS cval_lineitem_l_extendedprice_2#2662, cval_lineitem_l_discount#2630 AS cval_lineitem_l_discount_2#2663, cval_lineitem_l_tax#2631 AS cval_lineitem_l_tax_2#2664, cval_lineitem_l_returnflag#2632 AS cval_lineitem_l_returnflag_2#2665, cval_lineitem_l_linestatus#2633 AS cval_lineitem_l_linestatus_2#2666, cval_lineitem_l_commitdate#2634 AS cval_lineitem_l_commitdate_2#2667, cval_lineitem_l_receiptdate#2635 AS cval_lineitem_l_receiptdate_2#2668, cval_lineitem_l_shipinstruct#2636 AS cval_lineitem_l_shipinstruct_2#2669, cval_lineitem_l_shipmode#2637 AS cval_lineitem_l_shipmode_2#2670, cval_lineitem_l_comment#2638 AS cval_lineitem_l_comment_2#2671, cval_lineitem_l_shipdate#2639 AS cval_lineitem_l_shipdate_2#2672, cl_quantity#2640 AS cl_quantity_2#2673, cl_extendedprice#2641 AS cl_extendedprice_2#2674, cl_discount#2642 AS cl_discount_2#2675, ... 9 more fields]
            +- Relation[rid#2619,cpfk_orders_lineitem#2620,cpfk_supplier_lineitem#2621,cfpk_lineitem_supplier#2622,cfpk_lineitem_partsupp#2623,cpfk_part_lineitem#2624,cfpk_lineitem_part#2625,cpfk_partsupp_lineitem#2626,cfpk_lineitem_orders#2627,cval_lineitem_l_quantity#2628,cval_lineitem_l_extendedprice#2629,cval_lineitem_l_discount#2630,cval_lineitem_l_tax#2631,cval_lineitem_l_returnflag#2632,cval_lineitem_l_linestatus#2633,cval_lineitem_l_commitdate#2634,cval_lineitem_l_receiptdate#2635,cval_lineitem_l_shipinstruct#2636,cval_lineitem_l_shipmode#2637,cval_lineitem_l_comment#2638,cval_lineitem_l_shipdate#2639,cl_quantity#2640,cl_extendedprice#2641,cl_discount#2642,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 114602ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 04:34:11 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:34:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2859L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 04:34:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:34:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:34:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:34:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:34:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:34:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:34:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:34:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:34:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:34:11 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:34:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:34:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:34:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:34:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:34:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:34:11 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:34:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2859L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#2861 AS rid_0#2868, cpfk_region_nation#2862 AS cpfk_region_nation_0#2869, cfpk_nation_region#2863 AS cfpk_nation_region_0#2870, cval_nation_n_name#2864 AS cval_nation_n_name_0#2871, cval_nation_n_comment#2865 AS cval_nation_n_comment_0#2872, cn_name#2866 AS cn_name_0#2873, cn_comment#2867 AS cn_comment_0#2874]
            :  :  :     :  :  :  :  :  +- Relation[rid#2861,cpfk_region_nation#2862,cfpk_nation_region#2863,cval_nation_n_name#2864,cval_nation_n_comment#2865,cn_name#2866,cn_comment#2867] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#2901 AS rid_0#2908, cpfk_region_nation#2902 AS cpfk_region_nation_0#2909, cfpk_nation_region#2903 AS cfpk_nation_region_0#2910, cval_nation_n_name#2904 AS cval_nation_n_name_0#2911, cval_nation_n_comment#2905 AS cval_nation_n_comment_0#2912, cn_name#2906 AS cn_name_0#2913, cn_comment#2907 AS cn_comment_0#2914]
            :  :  :     :  :  :  :     :  +- Relation[rid#2901,cpfk_region_nation#2902,cfpk_nation_region#2903,cval_nation_n_name#2904,cval_nation_n_comment#2905,cn_name#2906,cn_comment#2907] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#2915 AS rid_1#2928, cpfk_nation_supplier#2916 AS cpfk_nation_supplier_1#2929, cfpk_supplier_nation#2917 AS cfpk_supplier_nation_1#2930, cval_supplier_s_name#2918 AS cval_supplier_s_name_1#2931, cval_supplier_s_address#2919 AS cval_supplier_s_address_1#2932, cval_supplier_s_phone#2920 AS cval_supplier_s_phone_1#2933, cval_supplier_s_acctbal#2921 AS cval_supplier_s_acctbal_1#2934, cval_supplier_s_comment#2922 AS cval_supplier_s_comment_1#2935, cs_name#2923 AS cs_name_1#2936, cs_address#2924 AS cs_address_1#2937, cs_phone#2925 AS cs_phone_1#2938, cs_acctbal#2926 AS cs_acctbal_1#2939, cs_comment#2927 AS cs_comment_1#2940]
            :  :  :     :  :  :  :        +- Relation[rid#2915,cpfk_nation_supplier#2916,cfpk_supplier_nation#2917,cval_supplier_s_name#2918,cval_supplier_s_address#2919,cval_supplier_s_phone#2920,cval_supplier_s_acctbal#2921,cval_supplier_s_comment#2922,cs_name#2923,cs_address#2924,cs_phone#2925,cs_acctbal#2926,cs_comment#2927] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#2875 AS rid_1#2888, cpfk_nation_supplier#2876 AS cpfk_nation_supplier_1#2889, cfpk_supplier_nation#2877 AS cfpk_supplier_nation_1#2890, cval_supplier_s_name#2878 AS cval_supplier_s_name_1#2891, cval_supplier_s_address#2879 AS cval_supplier_s_address_1#2892, cval_supplier_s_phone#2880 AS cval_supplier_s_phone_1#2893, cval_supplier_s_acctbal#2881 AS cval_supplier_s_acctbal_1#2894, cval_supplier_s_comment#2882 AS cval_supplier_s_comment_1#2895, cs_name#2883 AS cs_name_1#2896, cs_address#2884 AS cs_address_1#2897, cs_phone#2885 AS cs_phone_1#2898, cs_acctbal#2886 AS cs_acctbal_1#2899, cs_comment#2887 AS cs_comment_1#2900]
            :  :  :     :  :  :     +- Relation[rid#2875,cpfk_nation_supplier#2876,cfpk_supplier_nation#2877,cval_supplier_s_name#2878,cval_supplier_s_address#2879,cval_supplier_s_phone#2880,cval_supplier_s_acctbal#2881,cval_supplier_s_comment#2882,cs_name#2883,cs_address#2884,cs_phone#2885,cs_acctbal#2886,cs_comment#2887] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#2963 AS rid_1#2976, cpfk_nation_supplier#2964 AS cpfk_nation_supplier_1#2977, cfpk_supplier_nation#2965 AS cfpk_supplier_nation_1#2978, cval_supplier_s_name#2966 AS cval_supplier_s_name_1#2979, cval_supplier_s_address#2967 AS cval_supplier_s_address_1#2980, cval_supplier_s_phone#2968 AS cval_supplier_s_phone_1#2981, cval_supplier_s_acctbal#2969 AS cval_supplier_s_acctbal_1#2982, cval_supplier_s_comment#2970 AS cval_supplier_s_comment_1#2983, cs_name#2971 AS cs_name_1#2984, cs_address#2972 AS cs_address_1#2985, cs_phone#2973 AS cs_phone_1#2986, cs_acctbal#2974 AS cs_acctbal_1#2987, cs_comment#2975 AS cs_comment_1#2988]
            :  :  :     :  :     :  +- Relation[rid#2963,cpfk_nation_supplier#2964,cfpk_supplier_nation#2965,cval_supplier_s_name#2966,cval_supplier_s_address#2967,cval_supplier_s_phone#2968,cval_supplier_s_acctbal#2969,cval_supplier_s_comment#2970,cs_name#2971,cs_address#2972,cs_phone#2973,cs_acctbal#2974,cs_comment#2975] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#2989 AS rid_2#3000, cpfk_part_partsupp#2990 AS cpfk_part_partsupp_2#3001, cfpk_partsupp_part#2991 AS cfpk_partsupp_part_2#3002, cpfk_supplier_partsupp#2992 AS cpfk_supplier_partsupp_2#3003, cfpk_partsupp_supplier#2993 AS cfpk_partsupp_supplier_2#3004, cval_partsupp_ps_availqty#2994 AS cval_partsupp_ps_availqty_2#3005, cval_partsupp_ps_supplycost#2995 AS cval_partsupp_ps_supplycost_2#3006, cval_partsupp_ps_comment#2996 AS cval_partsupp_ps_comment_2#3007, cps_availqty#2997 AS cps_availqty_2#3008, cps_supplycost#2998 AS cps_supplycost_2#3009, cps_comment#2999 AS cps_comment_2#3010]
            :  :  :     :  :        +- Relation[rid#2989,cpfk_part_partsupp#2990,cfpk_partsupp_part#2991,cpfk_supplier_partsupp#2992,cfpk_partsupp_supplier#2993,cval_partsupp_ps_availqty#2994,cval_partsupp_ps_supplycost#2995,cval_partsupp_ps_comment#2996,cps_availqty#2997,cps_supplycost#2998,cps_comment#2999] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#2941 AS rid_2#2952, cpfk_part_partsupp#2942 AS cpfk_part_partsupp_2#2953, cfpk_partsupp_part#2943 AS cfpk_partsupp_part_2#2954, cpfk_supplier_partsupp#2944 AS cpfk_supplier_partsupp_2#2955, cfpk_partsupp_supplier#2945 AS cfpk_partsupp_supplier_2#2956, cval_partsupp_ps_availqty#2946 AS cval_partsupp_ps_availqty_2#2957, cval_partsupp_ps_supplycost#2947 AS cval_partsupp_ps_supplycost_2#2958, cval_partsupp_ps_comment#2948 AS cval_partsupp_ps_comment_2#2959, cps_availqty#2949 AS cps_availqty_2#2960, cps_supplycost#2950 AS cps_supplycost_2#2961, cps_comment#2951 AS cps_comment_2#2962]
            :  :  :     :     +- Relation[rid#2941,cpfk_part_partsupp#2942,cfpk_partsupp_part#2943,cpfk_supplier_partsupp#2944,cfpk_partsupp_supplier#2945,cval_partsupp_ps_availqty#2946,cval_partsupp_ps_supplycost#2947,cval_partsupp_ps_comment#2948,cps_availqty#2949,cps_supplycost#2950,cps_comment#2951] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#3011 AS rid_3#3028, cval_part_p_name#3012 AS cval_part_p_name_3#3029, cval_part_p_mfgr#3013 AS cval_part_p_mfgr_3#3030, cval_part_p_type#3014 AS cval_part_p_type_3#3031, cval_part_p_size#3015 AS cval_part_p_size_3#3032, cval_part_p_container#3016 AS cval_part_p_container_3#3033, cval_part_p_retailprice#3017 AS cval_part_p_retailprice_3#3034, cval_part_p_comment#3018 AS cval_part_p_comment_3#3035, cval_part_p_brand#3019 AS cval_part_p_brand_3#3036, cp_name#3020 AS cp_name_3#3037, cp_mfgr#3021 AS cp_mfgr_3#3038, cp_type#3022 AS cp_type_3#3039, cp_size#3023 AS cp_size_3#3040, cp_container#3024 AS cp_container_3#3041, cp_retailprice#3025 AS cp_retailprice_3#3042, cp_comment#3026 AS cp_comment_3#3043, cp_brand#3027 AS cp_brand_3#3044]
            :  :  :        +- Relation[rid#3011,cval_part_p_name#3012,cval_part_p_mfgr#3013,cval_part_p_type#3014,cval_part_p_size#3015,cval_part_p_container#3016,cval_part_p_retailprice#3017,cval_part_p_comment#3018,cval_part_p_brand#3019,cp_name#3020,cp_mfgr#3021,cp_type#3022,cp_size#3023,cp_container#3024,cp_retailprice#3025,cp_comment#3026,cp_brand#3027] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#3111 AS rid_2#3122, cpfk_part_partsupp#3112 AS cpfk_part_partsupp_2#3123, cfpk_partsupp_part#3113 AS cfpk_partsupp_part_2#3124, cpfk_supplier_partsupp#3114 AS cpfk_supplier_partsupp_2#3125, cfpk_partsupp_supplier#3115 AS cfpk_partsupp_supplier_2#3126, cval_partsupp_ps_availqty#3116 AS cval_partsupp_ps_availqty_2#3127, cval_partsupp_ps_supplycost#3117 AS cval_partsupp_ps_supplycost_2#3128, cval_partsupp_ps_comment#3118 AS cval_partsupp_ps_comment_2#3129, cps_availqty#3119 AS cps_availqty_2#3130, cps_supplycost#3120 AS cps_supplycost_2#3131, cps_comment#3121 AS cps_comment_2#3132]
            :  :     :  +- Relation[rid#3111,cpfk_part_partsupp#3112,cfpk_partsupp_part#3113,cpfk_supplier_partsupp#3114,cfpk_partsupp_supplier#3115,cval_partsupp_ps_availqty#3116,cval_partsupp_ps_supplycost#3117,cval_partsupp_ps_comment#3118,cps_availqty#3119,cps_supplycost#3120,cps_comment#3121] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#3133 AS rid_4#3166, cpfk_orders_lineitem#3134 AS cpfk_orders_lineitem_4#3167, cpfk_supplier_lineitem#3135 AS cpfk_supplier_lineitem_4#3168, cfpk_lineitem_supplier#3136 AS cfpk_lineitem_supplier_4#3169, cfpk_lineitem_partsupp#3137 AS cfpk_lineitem_partsupp_4#3170, cpfk_part_lineitem#3138 AS cpfk_part_lineitem_4#3171, cfpk_lineitem_part#3139 AS cfpk_lineitem_part_4#3172, cpfk_partsupp_lineitem#3140 AS cpfk_partsupp_lineitem_4#3173, cfpk_lineitem_orders#3141 AS cfpk_lineitem_orders_4#3174, cval_lineitem_l_quantity#3142 AS cval_lineitem_l_quantity_4#3175, cval_lineitem_l_extendedprice#3143 AS cval_lineitem_l_extendedprice_4#3176, cval_lineitem_l_discount#3144 AS cval_lineitem_l_discount_4#3177, cval_lineitem_l_tax#3145 AS cval_lineitem_l_tax_4#3178, cval_lineitem_l_returnflag#3146 AS cval_lineitem_l_returnflag_4#3179, cval_lineitem_l_linestatus#3147 AS cval_lineitem_l_linestatus_4#3180, cval_lineitem_l_commitdate#3148 AS cval_lineitem_l_commitdate_4#3181, cval_lineitem_l_receiptdate#3149 AS cval_lineitem_l_receiptdate_4#3182, cval_lineitem_l_shipinstruct#3150 AS cval_lineitem_l_shipinstruct_4#3183, cval_lineitem_l_shipmode#3151 AS cval_lineitem_l_shipmode_4#3184, cval_lineitem_l_comment#3152 AS cval_lineitem_l_comment_4#3185, cval_lineitem_l_shipdate#3153 AS cval_lineitem_l_shipdate_4#3186, cl_quantity#3154 AS cl_quantity_4#3187, cl_extendedprice#3155 AS cl_extendedprice_4#3188, cl_discount#3156 AS cl_discount_4#3189, ... 9 more fields]
            :  :        +- Relation[rid#3133,cpfk_orders_lineitem#3134,cpfk_supplier_lineitem#3135,cfpk_lineitem_supplier#3136,cfpk_lineitem_partsupp#3137,cpfk_part_lineitem#3138,cfpk_lineitem_part#3139,cpfk_partsupp_lineitem#3140,cfpk_lineitem_orders#3141,cval_lineitem_l_quantity#3142,cval_lineitem_l_extendedprice#3143,cval_lineitem_l_discount#3144,cval_lineitem_l_tax#3145,cval_lineitem_l_returnflag#3146,cval_lineitem_l_linestatus#3147,cval_lineitem_l_commitdate#3148,cval_lineitem_l_receiptdate#3149,cval_lineitem_l_shipinstruct#3150,cval_lineitem_l_shipmode#3151,cval_lineitem_l_comment#3152,cval_lineitem_l_shipdate#3153,cl_quantity#3154,cl_extendedprice#3155,cl_discount#3156,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#3045 AS rid_4#3078, cpfk_orders_lineitem#3046 AS cpfk_orders_lineitem_4#3079, cpfk_supplier_lineitem#3047 AS cpfk_supplier_lineitem_4#3080, cfpk_lineitem_supplier#3048 AS cfpk_lineitem_supplier_4#3081, cfpk_lineitem_partsupp#3049 AS cfpk_lineitem_partsupp_4#3082, cpfk_part_lineitem#3050 AS cpfk_part_lineitem_4#3083, cfpk_lineitem_part#3051 AS cfpk_lineitem_part_4#3084, cpfk_partsupp_lineitem#3052 AS cpfk_partsupp_lineitem_4#3085, cfpk_lineitem_orders#3053 AS cfpk_lineitem_orders_4#3086, cval_lineitem_l_quantity#3054 AS cval_lineitem_l_quantity_4#3087, cval_lineitem_l_extendedprice#3055 AS cval_lineitem_l_extendedprice_4#3088, cval_lineitem_l_discount#3056 AS cval_lineitem_l_discount_4#3089, cval_lineitem_l_tax#3057 AS cval_lineitem_l_tax_4#3090, cval_lineitem_l_returnflag#3058 AS cval_lineitem_l_returnflag_4#3091, cval_lineitem_l_linestatus#3059 AS cval_lineitem_l_linestatus_4#3092, cval_lineitem_l_commitdate#3060 AS cval_lineitem_l_commitdate_4#3093, cval_lineitem_l_receiptdate#3061 AS cval_lineitem_l_receiptdate_4#3094, cval_lineitem_l_shipinstruct#3062 AS cval_lineitem_l_shipinstruct_4#3095, cval_lineitem_l_shipmode#3063 AS cval_lineitem_l_shipmode_4#3096, cval_lineitem_l_comment#3064 AS cval_lineitem_l_comment_4#3097, cval_lineitem_l_shipdate#3065 AS cval_lineitem_l_shipdate_4#3098, cl_quantity#3066 AS cl_quantity_4#3099, cl_extendedprice#3067 AS cl_extendedprice_4#3100, cl_discount#3068 AS cl_discount_4#3101, ... 9 more fields]
            :     +- Relation[rid#3045,cpfk_orders_lineitem#3046,cpfk_supplier_lineitem#3047,cfpk_lineitem_supplier#3048,cfpk_lineitem_partsupp#3049,cpfk_part_lineitem#3050,cfpk_lineitem_part#3051,cpfk_partsupp_lineitem#3052,cfpk_lineitem_orders#3053,cval_lineitem_l_quantity#3054,cval_lineitem_l_extendedprice#3055,cval_lineitem_l_discount#3056,cval_lineitem_l_tax#3057,cval_lineitem_l_returnflag#3058,cval_lineitem_l_linestatus#3059,cval_lineitem_l_commitdate#3060,cval_lineitem_l_receiptdate#3061,cval_lineitem_l_shipinstruct#3062,cval_lineitem_l_shipmode#3063,cval_lineitem_l_comment#3064,cval_lineitem_l_shipdate#3065,cl_quantity#3066,cl_extendedprice#3067,cl_discount#3068,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#3199 AS rid_5#3216, cpfk_customer_orders#3200 AS cpfk_customer_orders_5#3217, cfpk_orders_customer#3201 AS cfpk_orders_customer_5#3218, cval_orders_o_orderstatus#3202 AS cval_orders_o_orderstatus_5#3219, cval_orders_o_totalprice#3203 AS cval_orders_o_totalprice_5#3220, cval_orders_o_orderpriority#3204 AS cval_orders_o_orderpriority_5#3221, cval_orders_o_clerk#3205 AS cval_orders_o_clerk_5#3222, cval_orders_o_shippriority#3206 AS cval_orders_o_shippriority_5#3223, cval_orders_o_comment#3207 AS cval_orders_o_comment_5#3224, cval_orders_o_orderdate#3208 AS cval_orders_o_orderdate_5#3225, co_orderstatus#3209 AS co_orderstatus_5#3226, co_totalprice#3210 AS co_totalprice_5#3227, co_orderpriority#3211 AS co_orderpriority_5#3228, co_clerk#3212 AS co_clerk_5#3229, co_shippriority#3213 AS co_shippriority_5#3230, co_comment#3214 AS co_comment_5#3231, co_orderdate#3215 AS co_orderdate_5#3232]
               +- Relation[rid#3199,cpfk_customer_orders#3200,cfpk_orders_customer#3201,cval_orders_o_orderstatus#3202,cval_orders_o_totalprice#3203,cval_orders_o_orderpriority#3204,cval_orders_o_clerk#3205,cval_orders_o_shippriority#3206,cval_orders_o_comment#3207,cval_orders_o_orderdate#3208,co_orderstatus#3209,co_totalprice#3210,co_orderpriority#3211,co_clerk#3212,co_shippriority#3213,co_comment#3214,co_orderdate#3215] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 161642ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/11 04:36:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:36:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3335L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 04:36:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3335L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#3337 AS rid_0#3354, cpfk_customer_orders#3338 AS cpfk_customer_orders_0#3355, cfpk_orders_customer#3339 AS cfpk_orders_customer_0#3356, cval_orders_o_orderstatus#3340 AS cval_orders_o_orderstatus_0#3357, cval_orders_o_totalprice#3341 AS cval_orders_o_totalprice_0#3358, cval_orders_o_orderpriority#3342 AS cval_orders_o_orderpriority_0#3359, cval_orders_o_clerk#3343 AS cval_orders_o_clerk_0#3360, cval_orders_o_shippriority#3344 AS cval_orders_o_shippriority_0#3361, cval_orders_o_comment#3345 AS cval_orders_o_comment_0#3362, cval_orders_o_orderdate#3346 AS cval_orders_o_orderdate_0#3363, co_orderstatus#3347 AS co_orderstatus_0#3364, co_totalprice#3348 AS co_totalprice_0#3365, co_orderpriority#3349 AS co_orderpriority_0#3366, co_clerk#3350 AS co_clerk_0#3367, co_shippriority#3351 AS co_shippriority_0#3368, co_comment#3352 AS co_comment_0#3369, co_orderdate#3353 AS co_orderdate_0#3370]
            :  +- Relation[rid#3337,cpfk_customer_orders#3338,cfpk_orders_customer#3339,cval_orders_o_orderstatus#3340,cval_orders_o_totalprice#3341,cval_orders_o_orderpriority#3342,cval_orders_o_clerk#3343,cval_orders_o_shippriority#3344,cval_orders_o_comment#3345,cval_orders_o_orderdate#3346,co_orderstatus#3347,co_totalprice#3348,co_orderpriority#3349,co_clerk#3350,co_shippriority#3351,co_comment#3352,co_orderdate#3353] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#3371 AS rid_1#3386, cpfk_nation_customer#3372 AS cpfk_nation_customer_1#3387, cfpk_customer_nation#3373 AS cfpk_customer_nation_1#3388, cval_customer_c_name#3374 AS cval_customer_c_name_1#3389, cval_customer_c_address#3375 AS cval_customer_c_address_1#3390, cval_customer_c_phone#3376 AS cval_customer_c_phone_1#3391, cval_customer_c_acctbal#3377 AS cval_customer_c_acctbal_1#3392, cval_customer_c_comment#3378 AS cval_customer_c_comment_1#3393, cval_customer_c_mktsegment#3379 AS cval_customer_c_mktsegment_1#3394, cc_name#3380 AS cc_name_1#3395, cc_address#3381 AS cc_address_1#3396, cc_phone#3382 AS cc_phone_1#3397, cc_acctbal#3383 AS cc_acctbal_1#3398, cc_comment#3384 AS cc_comment_1#3399, cc_mktsegment#3385 AS cc_mktsegment_1#3400]
               +- Relation[rid#3371,cpfk_nation_customer#3372,cfpk_customer_nation#3373,cval_customer_c_name#3374,cval_customer_c_address#3375,cval_customer_c_phone#3376,cval_customer_c_acctbal#3377,cval_customer_c_comment#3378,cval_customer_c_mktsegment#3379,cc_name#3380,cc_address#3381,cc_phone#3382,cc_acctbal#3383,cc_comment#3384,cc_mktsegment#3385] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 12640ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/11 04:37:05 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:37:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3461L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 04:37:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3461L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#3463 AS rid_0#3496, cpfk_orders_lineitem#3464 AS cpfk_orders_lineitem_0#3497, cpfk_supplier_lineitem#3465 AS cpfk_supplier_lineitem_0#3498, cfpk_lineitem_supplier#3466 AS cfpk_lineitem_supplier_0#3499, cfpk_lineitem_partsupp#3467 AS cfpk_lineitem_partsupp_0#3500, cpfk_part_lineitem#3468 AS cpfk_part_lineitem_0#3501, cfpk_lineitem_part#3469 AS cfpk_lineitem_part_0#3502, cpfk_partsupp_lineitem#3470 AS cpfk_partsupp_lineitem_0#3503, cfpk_lineitem_orders#3471 AS cfpk_lineitem_orders_0#3504, cval_lineitem_l_quantity#3472 AS cval_lineitem_l_quantity_0#3505, cval_lineitem_l_extendedprice#3473 AS cval_lineitem_l_extendedprice_0#3506, cval_lineitem_l_discount#3474 AS cval_lineitem_l_discount_0#3507, cval_lineitem_l_tax#3475 AS cval_lineitem_l_tax_0#3508, cval_lineitem_l_returnflag#3476 AS cval_lineitem_l_returnflag_0#3509, cval_lineitem_l_linestatus#3477 AS cval_lineitem_l_linestatus_0#3510, cval_lineitem_l_commitdate#3478 AS cval_lineitem_l_commitdate_0#3511, cval_lineitem_l_receiptdate#3479 AS cval_lineitem_l_receiptdate_0#3512, cval_lineitem_l_shipinstruct#3480 AS cval_lineitem_l_shipinstruct_0#3513, cval_lineitem_l_shipmode#3481 AS cval_lineitem_l_shipmode_0#3514, cval_lineitem_l_comment#3482 AS cval_lineitem_l_comment_0#3515, cval_lineitem_l_shipdate#3483 AS cval_lineitem_l_shipdate_0#3516, cl_quantity#3484 AS cl_quantity_0#3517, cl_extendedprice#3485 AS cl_extendedprice_0#3518, cl_discount#3486 AS cl_discount_0#3519, ... 9 more fields]
            :  +- Relation[rid#3463,cpfk_orders_lineitem#3464,cpfk_supplier_lineitem#3465,cfpk_lineitem_supplier#3466,cfpk_lineitem_partsupp#3467,cpfk_part_lineitem#3468,cfpk_lineitem_part#3469,cpfk_partsupp_lineitem#3470,cfpk_lineitem_orders#3471,cval_lineitem_l_quantity#3472,cval_lineitem_l_extendedprice#3473,cval_lineitem_l_discount#3474,cval_lineitem_l_tax#3475,cval_lineitem_l_returnflag#3476,cval_lineitem_l_linestatus#3477,cval_lineitem_l_commitdate#3478,cval_lineitem_l_receiptdate#3479,cval_lineitem_l_shipinstruct#3480,cval_lineitem_l_shipmode#3481,cval_lineitem_l_comment#3482,cval_lineitem_l_shipdate#3483,cl_quantity#3484,cl_extendedprice#3485,cl_discount#3486,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#3529 AS rid_1#3546, cpfk_customer_orders#3530 AS cpfk_customer_orders_1#3547, cfpk_orders_customer#3531 AS cfpk_orders_customer_1#3548, cval_orders_o_orderstatus#3532 AS cval_orders_o_orderstatus_1#3549, cval_orders_o_totalprice#3533 AS cval_orders_o_totalprice_1#3550, cval_orders_o_orderpriority#3534 AS cval_orders_o_orderpriority_1#3551, cval_orders_o_clerk#3535 AS cval_orders_o_clerk_1#3552, cval_orders_o_shippriority#3536 AS cval_orders_o_shippriority_1#3553, cval_orders_o_comment#3537 AS cval_orders_o_comment_1#3554, cval_orders_o_orderdate#3538 AS cval_orders_o_orderdate_1#3555, co_orderstatus#3539 AS co_orderstatus_1#3556, co_totalprice#3540 AS co_totalprice_1#3557, co_orderpriority#3541 AS co_orderpriority_1#3558, co_clerk#3542 AS co_clerk_1#3559, co_shippriority#3543 AS co_shippriority_1#3560, co_comment#3544 AS co_comment_1#3561, co_orderdate#3545 AS co_orderdate_1#3562]
               +- Relation[rid#3529,cpfk_customer_orders#3530,cfpk_orders_customer#3531,cval_orders_o_orderstatus#3532,cval_orders_o_totalprice#3533,cval_orders_o_orderpriority#3534,cval_orders_o_clerk#3535,cval_orders_o_shippriority#3536,cval_orders_o_comment#3537,cval_orders_o_orderdate#3538,co_orderstatus#3539,co_totalprice#3540,co_orderpriority#3541,co_clerk#3542,co_shippriority#3543,co_comment#3544,co_orderdate#3545] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 52462ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/11 04:37:57 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:37:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3619L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 04:37:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:37:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:37:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:37:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:37:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:37:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:37:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:37:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:37:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:37:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:37:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:37:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:37:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:37:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:37:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:37:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:37:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3619L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#3621 AS rid_0#3626, cval_region_r_name#3622 AS cval_region_r_name_0#3627, cval_region_r_comment#3623 AS cval_region_r_comment_0#3628, cr_name#3624 AS cr_name_0#3629, cr_comment#3625 AS cr_comment_0#3630]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#3621,cval_region_r_name#3622,cval_region_r_comment#3623,cr_name#3624,cr_comment#3625] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#3631 AS rid_0#3636, cval_region_r_name#3632 AS cval_region_r_name_0#3637, cval_region_r_comment#3633 AS cval_region_r_comment_0#3638, cr_name#3634 AS cr_name_0#3639, cr_comment#3635 AS cr_comment_0#3640]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#3631,cval_region_r_name#3632,cval_region_r_comment#3633,cr_name#3634,cr_comment#3635] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :     :- Project [rid#3655 AS rid_0#3660, cval_region_r_name#3656 AS cval_region_r_name_0#3661, cval_region_r_comment#3657 AS cval_region_r_comment_0#3662, cr_name#3658 AS cr_name_0#3663, cr_comment#3659 AS cr_comment_0#3664]
         :     :  :  :  :  :  :  :  :     :  +- Relation[rid#3655,cval_region_r_name#3656,cval_region_r_comment#3657,cr_name#3658,cr_comment#3659] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :     +- Project [rid#3665 AS rid_1#3672, cpfk_region_nation#3666 AS cpfk_region_nation_1#3673, cfpk_nation_region#3667 AS cfpk_nation_region_1#3674, cval_nation_n_name#3668 AS cval_nation_n_name_1#3675, cval_nation_n_comment#3669 AS cval_nation_n_comment_1#3676, cn_name#3670 AS cn_name_1#3677, cn_comment#3671 AS cn_comment_1#3678]
         :     :  :  :  :  :  :  :  :        +- Relation[rid#3665,cpfk_region_nation#3666,cfpk_nation_region#3667,cval_nation_n_name#3668,cval_nation_n_comment#3669,cn_name#3670,cn_comment#3671] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#3641 AS rid_1#3648, cpfk_region_nation#3642 AS cpfk_region_nation_1#3649, cfpk_nation_region#3643 AS cfpk_nation_region_1#3650, cval_nation_n_name#3644 AS cval_nation_n_name_1#3651, cval_nation_n_comment#3645 AS cval_nation_n_comment_1#3652, cn_name#3646 AS cn_name_1#3653, cn_comment#3647 AS cn_comment_1#3654]
         :     :  :  :  :  :  :  :     +- Relation[rid#3641,cpfk_region_nation#3642,cfpk_nation_region#3643,cval_nation_n_name#3644,cval_nation_n_comment#3645,cn_name#3646,cn_comment#3647] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :     :- Project [rid#3709 AS rid_1#3716, cpfk_region_nation#3710 AS cpfk_region_nation_1#3717, cfpk_nation_region#3711 AS cfpk_nation_region_1#3718, cval_nation_n_name#3712 AS cval_nation_n_name_1#3719, cval_nation_n_comment#3713 AS cval_nation_n_comment_1#3720, cn_name#3714 AS cn_name_1#3721, cn_comment#3715 AS cn_comment_1#3722]
         :     :  :  :  :  :  :     :  +- Relation[rid#3709,cpfk_region_nation#3710,cfpk_nation_region#3711,cval_nation_n_name#3712,cval_nation_n_comment#3713,cn_name#3714,cn_comment#3715] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :     +- Project [rid#3723 AS rid_2#3738, cpfk_nation_customer#3724 AS cpfk_nation_customer_2#3739, cfpk_customer_nation#3725 AS cfpk_customer_nation_2#3740, cval_customer_c_name#3726 AS cval_customer_c_name_2#3741, cval_customer_c_address#3727 AS cval_customer_c_address_2#3742, cval_customer_c_phone#3728 AS cval_customer_c_phone_2#3743, cval_customer_c_acctbal#3729 AS cval_customer_c_acctbal_2#3744, cval_customer_c_comment#3730 AS cval_customer_c_comment_2#3745, cval_customer_c_mktsegment#3731 AS cval_customer_c_mktsegment_2#3746, cc_name#3732 AS cc_name_2#3747, cc_address#3733 AS cc_address_2#3748, cc_phone#3734 AS cc_phone_2#3749, cc_acctbal#3735 AS cc_acctbal_2#3750, cc_comment#3736 AS cc_comment_2#3751, cc_mktsegment#3737 AS cc_mktsegment_2#3752]
         :     :  :  :  :  :  :        +- Relation[rid#3723,cpfk_nation_customer#3724,cfpk_customer_nation#3725,cval_customer_c_name#3726,cval_customer_c_address#3727,cval_customer_c_phone#3728,cval_customer_c_acctbal#3729,cval_customer_c_comment#3730,cval_customer_c_mktsegment#3731,cc_name#3732,cc_address#3733,cc_phone#3734,cc_acctbal#3735,cc_comment#3736,cc_mktsegment#3737] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#3679 AS rid_2#3694, cpfk_nation_customer#3680 AS cpfk_nation_customer_2#3695, cfpk_customer_nation#3681 AS cfpk_customer_nation_2#3696, cval_customer_c_name#3682 AS cval_customer_c_name_2#3697, cval_customer_c_address#3683 AS cval_customer_c_address_2#3698, cval_customer_c_phone#3684 AS cval_customer_c_phone_2#3699, cval_customer_c_acctbal#3685 AS cval_customer_c_acctbal_2#3700, cval_customer_c_comment#3686 AS cval_customer_c_comment_2#3701, cval_customer_c_mktsegment#3687 AS cval_customer_c_mktsegment_2#3702, cc_name#3688 AS cc_name_2#3703, cc_address#3689 AS cc_address_2#3704, cc_phone#3690 AS cc_phone_2#3705, cc_acctbal#3691 AS cc_acctbal_2#3706, cc_comment#3692 AS cc_comment_2#3707, cc_mktsegment#3693 AS cc_mktsegment_2#3708]
         :     :  :  :  :  :     +- Relation[rid#3679,cpfk_nation_customer#3680,cfpk_customer_nation#3681,cval_customer_c_name#3682,cval_customer_c_address#3683,cval_customer_c_phone#3684,cval_customer_c_acctbal#3685,cval_customer_c_comment#3686,cval_customer_c_mktsegment#3687,cc_name#3688,cc_address#3689,cc_phone#3690,cc_acctbal#3691,cc_comment#3692,cc_mktsegment#3693] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :     :- Project [rid#3787 AS rid_2#3802, cpfk_nation_customer#3788 AS cpfk_nation_customer_2#3803, cfpk_customer_nation#3789 AS cfpk_customer_nation_2#3804, cval_customer_c_name#3790 AS cval_customer_c_name_2#3805, cval_customer_c_address#3791 AS cval_customer_c_address_2#3806, cval_customer_c_phone#3792 AS cval_customer_c_phone_2#3807, cval_customer_c_acctbal#3793 AS cval_customer_c_acctbal_2#3808, cval_customer_c_comment#3794 AS cval_customer_c_comment_2#3809, cval_customer_c_mktsegment#3795 AS cval_customer_c_mktsegment_2#3810, cc_name#3796 AS cc_name_2#3811, cc_address#3797 AS cc_address_2#3812, cc_phone#3798 AS cc_phone_2#3813, cc_acctbal#3799 AS cc_acctbal_2#3814, cc_comment#3800 AS cc_comment_2#3815, cc_mktsegment#3801 AS cc_mktsegment_2#3816]
         :     :  :  :  :     :  +- Relation[rid#3787,cpfk_nation_customer#3788,cfpk_customer_nation#3789,cval_customer_c_name#3790,cval_customer_c_address#3791,cval_customer_c_phone#3792,cval_customer_c_acctbal#3793,cval_customer_c_comment#3794,cval_customer_c_mktsegment#3795,cc_name#3796,cc_address#3797,cc_phone#3798,cc_acctbal#3799,cc_comment#3800,cc_mktsegment#3801] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :     +- Project [rid#3817 AS rid_3#3834, cpfk_customer_orders#3818 AS cpfk_customer_orders_3#3835, cfpk_orders_customer#3819 AS cfpk_orders_customer_3#3836, cval_orders_o_orderstatus#3820 AS cval_orders_o_orderstatus_3#3837, cval_orders_o_totalprice#3821 AS cval_orders_o_totalprice_3#3838, cval_orders_o_orderpriority#3822 AS cval_orders_o_orderpriority_3#3839, cval_orders_o_clerk#3823 AS cval_orders_o_clerk_3#3840, cval_orders_o_shippriority#3824 AS cval_orders_o_shippriority_3#3841, cval_orders_o_comment#3825 AS cval_orders_o_comment_3#3842, cval_orders_o_orderdate#3826 AS cval_orders_o_orderdate_3#3843, co_orderstatus#3827 AS co_orderstatus_3#3844, co_totalprice#3828 AS co_totalprice_3#3845, co_orderpriority#3829 AS co_orderpriority_3#3846, co_clerk#3830 AS co_clerk_3#3847, co_shippriority#3831 AS co_shippriority_3#3848, co_comment#3832 AS co_comment_3#3849, co_orderdate#3833 AS co_orderdate_3#3850]
         :     :  :  :  :        +- Relation[rid#3817,cpfk_customer_orders#3818,cfpk_orders_customer#3819,cval_orders_o_orderstatus#3820,cval_orders_o_totalprice#3821,cval_orders_o_orderpriority#3822,cval_orders_o_clerk#3823,cval_orders_o_shippriority#3824,cval_orders_o_comment#3825,cval_orders_o_orderdate#3826,co_orderstatus#3827,co_totalprice#3828,co_orderpriority#3829,co_clerk#3830,co_shippriority#3831,co_comment#3832,co_orderdate#3833] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#3753 AS rid_3#3770, cpfk_customer_orders#3754 AS cpfk_customer_orders_3#3771, cfpk_orders_customer#3755 AS cfpk_orders_customer_3#3772, cval_orders_o_orderstatus#3756 AS cval_orders_o_orderstatus_3#3773, cval_orders_o_totalprice#3757 AS cval_orders_o_totalprice_3#3774, cval_orders_o_orderpriority#3758 AS cval_orders_o_orderpriority_3#3775, cval_orders_o_clerk#3759 AS cval_orders_o_clerk_3#3776, cval_orders_o_shippriority#3760 AS cval_orders_o_shippriority_3#3777, cval_orders_o_comment#3761 AS cval_orders_o_comment_3#3778, cval_orders_o_orderdate#3762 AS cval_orders_o_orderdate_3#3779, co_orderstatus#3763 AS co_orderstatus_3#3780, co_totalprice#3764 AS co_totalprice_3#3781, co_orderpriority#3765 AS co_orderpriority_3#3782, co_clerk#3766 AS co_clerk_3#3783, co_shippriority#3767 AS co_shippriority_3#3784, co_comment#3768 AS co_comment_3#3785, co_orderdate#3769 AS co_orderdate_3#3786]
         :     :  :  :     +- Relation[rid#3753,cpfk_customer_orders#3754,cfpk_orders_customer#3755,cval_orders_o_orderstatus#3756,cval_orders_o_totalprice#3757,cval_orders_o_orderpriority#3758,cval_orders_o_clerk#3759,cval_orders_o_shippriority#3760,cval_orders_o_comment#3761,cval_orders_o_orderdate#3762,co_orderstatus#3763,co_totalprice#3764,co_orderpriority#3765,co_clerk#3766,co_shippriority#3767,co_comment#3768,co_orderdate#3769] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :     :- Project [rid#3917 AS rid_3#3934, cpfk_customer_orders#3918 AS cpfk_customer_orders_3#3935, cfpk_orders_customer#3919 AS cfpk_orders_customer_3#3936, cval_orders_o_orderstatus#3920 AS cval_orders_o_orderstatus_3#3937, cval_orders_o_totalprice#3921 AS cval_orders_o_totalprice_3#3938, cval_orders_o_orderpriority#3922 AS cval_orders_o_orderpriority_3#3939, cval_orders_o_clerk#3923 AS cval_orders_o_clerk_3#3940, cval_orders_o_shippriority#3924 AS cval_orders_o_shippriority_3#3941, cval_orders_o_comment#3925 AS cval_orders_o_comment_3#3942, cval_orders_o_orderdate#3926 AS cval_orders_o_orderdate_3#3943, co_orderstatus#3927 AS co_orderstatus_3#3944, co_totalprice#3928 AS co_totalprice_3#3945, co_orderpriority#3929 AS co_orderpriority_3#3946, co_clerk#3930 AS co_clerk_3#3947, co_shippriority#3931 AS co_shippriority_3#3948, co_comment#3932 AS co_comment_3#3949, co_orderdate#3933 AS co_orderdate_3#3950]
         :     :  :     :  +- Relation[rid#3917,cpfk_customer_orders#3918,cfpk_orders_customer#3919,cval_orders_o_orderstatus#3920,cval_orders_o_totalprice#3921,cval_orders_o_orderpriority#3922,cval_orders_o_clerk#3923,cval_orders_o_shippriority#3924,cval_orders_o_comment#3925,cval_orders_o_orderdate#3926,co_orderstatus#3927,co_totalprice#3928,co_orderpriority#3929,co_clerk#3930,co_shippriority#3931,co_comment#3932,co_orderdate#3933] JDBCRelation(torders) [numPartitions=1]
         :     :  :     +- Project [rid#3951 AS rid_4#3984, cpfk_orders_lineitem#3952 AS cpfk_orders_lineitem_4#3985, cpfk_supplier_lineitem#3953 AS cpfk_supplier_lineitem_4#3986, cfpk_lineitem_supplier#3954 AS cfpk_lineitem_supplier_4#3987, cfpk_lineitem_partsupp#3955 AS cfpk_lineitem_partsupp_4#3988, cpfk_part_lineitem#3956 AS cpfk_part_lineitem_4#3989, cfpk_lineitem_part#3957 AS cfpk_lineitem_part_4#3990, cpfk_partsupp_lineitem#3958 AS cpfk_partsupp_lineitem_4#3991, cfpk_lineitem_orders#3959 AS cfpk_lineitem_orders_4#3992, cval_lineitem_l_quantity#3960 AS cval_lineitem_l_quantity_4#3993, cval_lineitem_l_extendedprice#3961 AS cval_lineitem_l_extendedprice_4#3994, cval_lineitem_l_discount#3962 AS cval_lineitem_l_discount_4#3995, cval_lineitem_l_tax#3963 AS cval_lineitem_l_tax_4#3996, cval_lineitem_l_returnflag#3964 AS cval_lineitem_l_returnflag_4#3997, cval_lineitem_l_linestatus#3965 AS cval_lineitem_l_linestatus_4#3998, cval_lineitem_l_commitdate#3966 AS cval_lineitem_l_commitdate_4#3999, cval_lineitem_l_receiptdate#3967 AS cval_lineitem_l_receiptdate_4#4000, cval_lineitem_l_shipinstruct#3968 AS cval_lineitem_l_shipinstruct_4#4001, cval_lineitem_l_shipmode#3969 AS cval_lineitem_l_shipmode_4#4002, cval_lineitem_l_comment#3970 AS cval_lineitem_l_comment_4#4003, cval_lineitem_l_shipdate#3971 AS cval_lineitem_l_shipdate_4#4004, cl_quantity#3972 AS cl_quantity_4#4005, cl_extendedprice#3973 AS cl_extendedprice_4#4006, cl_discount#3974 AS cl_discount_4#4007, ... 9 more fields]
         :     :  :        +- Relation[rid#3951,cpfk_orders_lineitem#3952,cpfk_supplier_lineitem#3953,cfpk_lineitem_supplier#3954,cfpk_lineitem_partsupp#3955,cpfk_part_lineitem#3956,cfpk_lineitem_part#3957,cpfk_partsupp_lineitem#3958,cfpk_lineitem_orders#3959,cval_lineitem_l_quantity#3960,cval_lineitem_l_extendedprice#3961,cval_lineitem_l_discount#3962,cval_lineitem_l_tax#3963,cval_lineitem_l_returnflag#3964,cval_lineitem_l_linestatus#3965,cval_lineitem_l_commitdate#3966,cval_lineitem_l_receiptdate#3967,cval_lineitem_l_shipinstruct#3968,cval_lineitem_l_shipmode#3969,cval_lineitem_l_comment#3970,cval_lineitem_l_shipdate#3971,cl_quantity#3972,cl_extendedprice#3973,cl_discount#3974,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#3851 AS rid_4#3884, cpfk_orders_lineitem#3852 AS cpfk_orders_lineitem_4#3885, cpfk_supplier_lineitem#3853 AS cpfk_supplier_lineitem_4#3886, cfpk_lineitem_supplier#3854 AS cfpk_lineitem_supplier_4#3887, cfpk_lineitem_partsupp#3855 AS cfpk_lineitem_partsupp_4#3888, cpfk_part_lineitem#3856 AS cpfk_part_lineitem_4#3889, cfpk_lineitem_part#3857 AS cfpk_lineitem_part_4#3890, cpfk_partsupp_lineitem#3858 AS cpfk_partsupp_lineitem_4#3891, cfpk_lineitem_orders#3859 AS cfpk_lineitem_orders_4#3892, cval_lineitem_l_quantity#3860 AS cval_lineitem_l_quantity_4#3893, cval_lineitem_l_extendedprice#3861 AS cval_lineitem_l_extendedprice_4#3894, cval_lineitem_l_discount#3862 AS cval_lineitem_l_discount_4#3895, cval_lineitem_l_tax#3863 AS cval_lineitem_l_tax_4#3896, cval_lineitem_l_returnflag#3864 AS cval_lineitem_l_returnflag_4#3897, cval_lineitem_l_linestatus#3865 AS cval_lineitem_l_linestatus_4#3898, cval_lineitem_l_commitdate#3866 AS cval_lineitem_l_commitdate_4#3899, cval_lineitem_l_receiptdate#3867 AS cval_lineitem_l_receiptdate_4#3900, cval_lineitem_l_shipinstruct#3868 AS cval_lineitem_l_shipinstruct_4#3901, cval_lineitem_l_shipmode#3869 AS cval_lineitem_l_shipmode_4#3902, cval_lineitem_l_comment#3870 AS cval_lineitem_l_comment_4#3903, cval_lineitem_l_shipdate#3871 AS cval_lineitem_l_shipdate_4#3904, cl_quantity#3872 AS cl_quantity_4#3905, cl_extendedprice#3873 AS cl_extendedprice_4#3906, cl_discount#3874 AS cl_discount_4#3907, ... 9 more fields]
         :     :     +- Relation[rid#3851,cpfk_orders_lineitem#3852,cpfk_supplier_lineitem#3853,cfpk_lineitem_supplier#3854,cfpk_lineitem_partsupp#3855,cpfk_part_lineitem#3856,cfpk_lineitem_part#3857,cpfk_partsupp_lineitem#3858,cfpk_lineitem_orders#3859,cval_lineitem_l_quantity#3860,cval_lineitem_l_extendedprice#3861,cval_lineitem_l_discount#3862,cval_lineitem_l_tax#3863,cval_lineitem_l_returnflag#3864,cval_lineitem_l_linestatus#3865,cval_lineitem_l_commitdate#3866,cval_lineitem_l_receiptdate#3867,cval_lineitem_l_shipinstruct#3868,cval_lineitem_l_shipmode#3869,cval_lineitem_l_comment#3870,cval_lineitem_l_shipdate#3871,cl_quantity#3872,cl_extendedprice#3873,cl_discount#3874,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#4017 AS rid_5#4030, cpfk_nation_supplier#4018 AS cpfk_nation_supplier_5#4031, cfpk_supplier_nation#4019 AS cfpk_supplier_nation_5#4032, cval_supplier_s_name#4020 AS cval_supplier_s_name_5#4033, cval_supplier_s_address#4021 AS cval_supplier_s_address_5#4034, cval_supplier_s_phone#4022 AS cval_supplier_s_phone_5#4035, cval_supplier_s_acctbal#4023 AS cval_supplier_s_acctbal_5#4036, cval_supplier_s_comment#4024 AS cval_supplier_s_comment_5#4037, cs_name#4025 AS cs_name_5#4038, cs_address#4026 AS cs_address_5#4039, cs_phone#4027 AS cs_phone_5#4040, cs_acctbal#4028 AS cs_acctbal_5#4041, cs_comment#4029 AS cs_comment_5#4042]
         :        +- Relation[rid#4017,cpfk_nation_supplier#4018,cfpk_supplier_nation#4019,cval_supplier_s_name#4020,cval_supplier_s_address#4021,cval_supplier_s_phone#4022,cval_supplier_s_acctbal#4023,cval_supplier_s_comment#4024,cs_name#4025,cs_address#4026,cs_phone#4027,cs_acctbal#4028,cs_comment#4029] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#4043 AS rid_1#4050, cpfk_region_nation#4044 AS cpfk_region_nation_1#4051, cfpk_nation_region#4045 AS cfpk_nation_region_1#4052, cval_nation_n_name#4046 AS cval_nation_n_name_1#4053, cval_nation_n_comment#4047 AS cval_nation_n_comment_1#4054, cn_name#4048 AS cn_name_1#4055, cn_comment#4049 AS cn_comment_1#4056]
            :  +- Relation[rid#4043,cpfk_region_nation#4044,cfpk_nation_region#4045,cval_nation_n_name#4046,cval_nation_n_comment#4047,cn_name#4048,cn_comment#4049] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#4057 AS rid_5#4070, cpfk_nation_supplier#4058 AS cpfk_nation_supplier_5#4071, cfpk_supplier_nation#4059 AS cfpk_supplier_nation_5#4072, cval_supplier_s_name#4060 AS cval_supplier_s_name_5#4073, cval_supplier_s_address#4061 AS cval_supplier_s_address_5#4074, cval_supplier_s_phone#4062 AS cval_supplier_s_phone_5#4075, cval_supplier_s_acctbal#4063 AS cval_supplier_s_acctbal_5#4076, cval_supplier_s_comment#4064 AS cval_supplier_s_comment_5#4077, cs_name#4065 AS cs_name_5#4078, cs_address#4066 AS cs_address_5#4079, cs_phone#4067 AS cs_phone_5#4080, cs_acctbal#4068 AS cs_acctbal_5#4081, cs_comment#4069 AS cs_comment_5#4082]
               +- Relation[rid#4057,cpfk_nation_supplier#4058,cfpk_supplier_nation#4059,cval_supplier_s_name#4060,cval_supplier_s_address#4061,cval_supplier_s_phone#4062,cval_supplier_s_acctbal#4063,cval_supplier_s_comment#4064,cs_name#4065,cs_address#4066,cs_phone#4067,cs_acctbal#4068,cs_comment#4069] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1206514
Elapsed time: 163007ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/11 04:40:40 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:40:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4177L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 04:40:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4177L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#4179 AS rid_0#4212, cpfk_orders_lineitem#4180 AS cpfk_orders_lineitem_0#4213, cpfk_supplier_lineitem#4181 AS cpfk_supplier_lineitem_0#4214, cfpk_lineitem_supplier#4182 AS cfpk_lineitem_supplier_0#4215, cfpk_lineitem_partsupp#4183 AS cfpk_lineitem_partsupp_0#4216, cpfk_part_lineitem#4184 AS cpfk_part_lineitem_0#4217, cfpk_lineitem_part#4185 AS cfpk_lineitem_part_0#4218, cpfk_partsupp_lineitem#4186 AS cpfk_partsupp_lineitem_0#4219, cfpk_lineitem_orders#4187 AS cfpk_lineitem_orders_0#4220, cval_lineitem_l_quantity#4188 AS cval_lineitem_l_quantity_0#4221, cval_lineitem_l_extendedprice#4189 AS cval_lineitem_l_extendedprice_0#4222, cval_lineitem_l_discount#4190 AS cval_lineitem_l_discount_0#4223, cval_lineitem_l_tax#4191 AS cval_lineitem_l_tax_0#4224, cval_lineitem_l_returnflag#4192 AS cval_lineitem_l_returnflag_0#4225, cval_lineitem_l_linestatus#4193 AS cval_lineitem_l_linestatus_0#4226, cval_lineitem_l_commitdate#4194 AS cval_lineitem_l_commitdate_0#4227, cval_lineitem_l_receiptdate#4195 AS cval_lineitem_l_receiptdate_0#4228, cval_lineitem_l_shipinstruct#4196 AS cval_lineitem_l_shipinstruct_0#4229, cval_lineitem_l_shipmode#4197 AS cval_lineitem_l_shipmode_0#4230, cval_lineitem_l_comment#4198 AS cval_lineitem_l_comment_0#4231, cval_lineitem_l_shipdate#4199 AS cval_lineitem_l_shipdate_0#4232, cl_quantity#4200 AS cl_quantity_0#4233, cl_extendedprice#4201 AS cl_extendedprice_0#4234, cl_discount#4202 AS cl_discount_0#4235, ... 9 more fields]
            :  :  +- Relation[rid#4179,cpfk_orders_lineitem#4180,cpfk_supplier_lineitem#4181,cfpk_lineitem_supplier#4182,cfpk_lineitem_partsupp#4183,cpfk_part_lineitem#4184,cfpk_lineitem_part#4185,cpfk_partsupp_lineitem#4186,cfpk_lineitem_orders#4187,cval_lineitem_l_quantity#4188,cval_lineitem_l_extendedprice#4189,cval_lineitem_l_discount#4190,cval_lineitem_l_tax#4191,cval_lineitem_l_returnflag#4192,cval_lineitem_l_linestatus#4193,cval_lineitem_l_commitdate#4194,cval_lineitem_l_receiptdate#4195,cval_lineitem_l_shipinstruct#4196,cval_lineitem_l_shipmode#4197,cval_lineitem_l_comment#4198,cval_lineitem_l_shipdate#4199,cl_quantity#4200,cl_extendedprice#4201,cl_discount#4202,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#4245 AS rid_0#4278, cpfk_orders_lineitem#4246 AS cpfk_orders_lineitem_0#4279, cpfk_supplier_lineitem#4247 AS cpfk_supplier_lineitem_0#4280, cfpk_lineitem_supplier#4248 AS cfpk_lineitem_supplier_0#4281, cfpk_lineitem_partsupp#4249 AS cfpk_lineitem_partsupp_0#4282, cpfk_part_lineitem#4250 AS cpfk_part_lineitem_0#4283, cfpk_lineitem_part#4251 AS cfpk_lineitem_part_0#4284, cpfk_partsupp_lineitem#4252 AS cpfk_partsupp_lineitem_0#4285, cfpk_lineitem_orders#4253 AS cfpk_lineitem_orders_0#4286, cval_lineitem_l_quantity#4254 AS cval_lineitem_l_quantity_0#4287, cval_lineitem_l_extendedprice#4255 AS cval_lineitem_l_extendedprice_0#4288, cval_lineitem_l_discount#4256 AS cval_lineitem_l_discount_0#4289, cval_lineitem_l_tax#4257 AS cval_lineitem_l_tax_0#4290, cval_lineitem_l_returnflag#4258 AS cval_lineitem_l_returnflag_0#4291, cval_lineitem_l_linestatus#4259 AS cval_lineitem_l_linestatus_0#4292, cval_lineitem_l_commitdate#4260 AS cval_lineitem_l_commitdate_0#4293, cval_lineitem_l_receiptdate#4261 AS cval_lineitem_l_receiptdate_0#4294, cval_lineitem_l_shipinstruct#4262 AS cval_lineitem_l_shipinstruct_0#4295, cval_lineitem_l_shipmode#4263 AS cval_lineitem_l_shipmode_0#4296, cval_lineitem_l_comment#4264 AS cval_lineitem_l_comment_0#4297, cval_lineitem_l_shipdate#4265 AS cval_lineitem_l_shipdate_0#4298, cl_quantity#4266 AS cl_quantity_0#4299, cl_extendedprice#4267 AS cl_extendedprice_0#4300, cl_discount#4268 AS cl_discount_0#4301, ... 9 more fields]
            :        +- Relation[rid#4245,cpfk_orders_lineitem#4246,cpfk_supplier_lineitem#4247,cfpk_lineitem_supplier#4248,cfpk_lineitem_partsupp#4249,cpfk_part_lineitem#4250,cfpk_lineitem_part#4251,cpfk_partsupp_lineitem#4252,cfpk_lineitem_orders#4253,cval_lineitem_l_quantity#4254,cval_lineitem_l_extendedprice#4255,cval_lineitem_l_discount#4256,cval_lineitem_l_tax#4257,cval_lineitem_l_returnflag#4258,cval_lineitem_l_linestatus#4259,cval_lineitem_l_commitdate#4260,cval_lineitem_l_receiptdate#4261,cval_lineitem_l_shipinstruct#4262,cval_lineitem_l_shipmode#4263,cval_lineitem_l_comment#4264,cval_lineitem_l_shipdate#4265,cl_quantity#4266,cl_extendedprice#4267,cl_discount#4268,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#4311 AS rid_1#4328, cpfk_customer_orders#4312 AS cpfk_customer_orders_1#4329, cfpk_orders_customer#4313 AS cfpk_orders_customer_1#4330, cval_orders_o_orderstatus#4314 AS cval_orders_o_orderstatus_1#4331, cval_orders_o_totalprice#4315 AS cval_orders_o_totalprice_1#4332, cval_orders_o_orderpriority#4316 AS cval_orders_o_orderpriority_1#4333, cval_orders_o_clerk#4317 AS cval_orders_o_clerk_1#4334, cval_orders_o_shippriority#4318 AS cval_orders_o_shippriority_1#4335, cval_orders_o_comment#4319 AS cval_orders_o_comment_1#4336, cval_orders_o_orderdate#4320 AS cval_orders_o_orderdate_1#4337, co_orderstatus#4321 AS co_orderstatus_1#4338, co_totalprice#4322 AS co_totalprice_1#4339, co_orderpriority#4323 AS co_orderpriority_1#4340, co_clerk#4324 AS co_clerk_1#4341, co_shippriority#4325 AS co_shippriority_1#4342, co_comment#4326 AS co_comment_1#4343, co_orderdate#4327 AS co_orderdate_1#4344]
               +- Relation[rid#4311,cpfk_customer_orders#4312,cfpk_orders_customer#4313,cval_orders_o_orderstatus#4314,cval_orders_o_totalprice#4315,cval_orders_o_orderpriority#4316,cval_orders_o_clerk#4317,cval_orders_o_shippriority#4318,cval_orders_o_comment#4319,cval_orders_o_orderdate#4320,co_orderstatus#4321,co_totalprice#4322,co_orderpriority#4323,co_clerk#4324,co_shippriority#4325,co_comment#4326,co_orderdate#4327] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 21269ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/11 04:41:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:41:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4401L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 04:41:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:41:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:41:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:41:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:41:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:41:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:41:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:41:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:41:02 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:41:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:41:02 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:41:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:41:02 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:41:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4401L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#4403 AS rid_0#4410, cpfk_region_nation#4404 AS cpfk_region_nation_0#4411, cfpk_nation_region#4405 AS cfpk_nation_region_0#4412, cval_nation_n_name#4406 AS cval_nation_n_name_0#4413, cval_nation_n_comment#4407 AS cval_nation_n_comment_0#4414, cn_name#4408 AS cn_name_0#4415, cn_comment#4409 AS cn_comment_0#4416]
         :  :  :  :  :  +- Relation[rid#4403,cpfk_region_nation#4404,cfpk_nation_region#4405,cval_nation_n_name#4406,cval_nation_n_comment#4407,cn_name#4408,cn_comment#4409] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#4417 AS rid_0#4424, cpfk_region_nation#4418 AS cpfk_region_nation_0#4425, cfpk_nation_region#4419 AS cfpk_nation_region_0#4426, cval_nation_n_name#4420 AS cval_nation_n_name_0#4427, cval_nation_n_comment#4421 AS cval_nation_n_comment_0#4428, cn_name#4422 AS cn_name_0#4429, cn_comment#4423 AS cn_comment_0#4430]
         :  :  :  :        +- Relation[rid#4417,cpfk_region_nation#4418,cfpk_nation_region#4419,cval_nation_n_name#4420,cval_nation_n_comment#4421,cn_name#4422,cn_comment#4423] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :     :- Project [rid#4457 AS rid_0#4464, cpfk_region_nation#4458 AS cpfk_region_nation_0#4465, cfpk_nation_region#4459 AS cfpk_nation_region_0#4466, cval_nation_n_name#4460 AS cval_nation_n_name_0#4467, cval_nation_n_comment#4461 AS cval_nation_n_comment_0#4468, cn_name#4462 AS cn_name_0#4469, cn_comment#4463 AS cn_comment_0#4470]
         :  :  :     :  +- Relation[rid#4457,cpfk_region_nation#4458,cfpk_nation_region#4459,cval_nation_n_name#4460,cval_nation_n_comment#4461,cn_name#4462,cn_comment#4463] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#4471 AS rid_1#4484, cpfk_nation_supplier#4472 AS cpfk_nation_supplier_1#4485, cfpk_supplier_nation#4473 AS cfpk_supplier_nation_1#4486, cval_supplier_s_name#4474 AS cval_supplier_s_name_1#4487, cval_supplier_s_address#4475 AS cval_supplier_s_address_1#4488, cval_supplier_s_phone#4476 AS cval_supplier_s_phone_1#4489, cval_supplier_s_acctbal#4477 AS cval_supplier_s_acctbal_1#4490, cval_supplier_s_comment#4478 AS cval_supplier_s_comment_1#4491, cs_name#4479 AS cs_name_1#4492, cs_address#4480 AS cs_address_1#4493, cs_phone#4481 AS cs_phone_1#4494, cs_acctbal#4482 AS cs_acctbal_1#4495, cs_comment#4483 AS cs_comment_1#4496]
         :  :  :        +- Relation[rid#4471,cpfk_nation_supplier#4472,cfpk_supplier_nation#4473,cval_supplier_s_name#4474,cval_supplier_s_address#4475,cval_supplier_s_phone#4476,cval_supplier_s_acctbal#4477,cval_supplier_s_comment#4478,cs_name#4479,cs_address#4480,cs_phone#4481,cs_acctbal#4482,cs_comment#4483] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#4431 AS rid_1#4444, cpfk_nation_supplier#4432 AS cpfk_nation_supplier_1#4445, cfpk_supplier_nation#4433 AS cfpk_supplier_nation_1#4446, cval_supplier_s_name#4434 AS cval_supplier_s_name_1#4447, cval_supplier_s_address#4435 AS cval_supplier_s_address_1#4448, cval_supplier_s_phone#4436 AS cval_supplier_s_phone_1#4449, cval_supplier_s_acctbal#4437 AS cval_supplier_s_acctbal_1#4450, cval_supplier_s_comment#4438 AS cval_supplier_s_comment_1#4451, cs_name#4439 AS cs_name_1#4452, cs_address#4440 AS cs_address_1#4453, cs_phone#4441 AS cs_phone_1#4454, cs_acctbal#4442 AS cs_acctbal_1#4455, cs_comment#4443 AS cs_comment_1#4456]
         :  :     +- Relation[rid#4431,cpfk_nation_supplier#4432,cfpk_supplier_nation#4433,cval_supplier_s_name#4434,cval_supplier_s_address#4435,cval_supplier_s_phone#4436,cval_supplier_s_acctbal#4437,cval_supplier_s_comment#4438,cs_name#4439,cs_address#4440,cs_phone#4441,cs_acctbal#4442,cs_comment#4443] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :     :- Project [rid#4519 AS rid_1#4532, cpfk_nation_supplier#4520 AS cpfk_nation_supplier_1#4533, cfpk_supplier_nation#4521 AS cfpk_supplier_nation_1#4534, cval_supplier_s_name#4522 AS cval_supplier_s_name_1#4535, cval_supplier_s_address#4523 AS cval_supplier_s_address_1#4536, cval_supplier_s_phone#4524 AS cval_supplier_s_phone_1#4537, cval_supplier_s_acctbal#4525 AS cval_supplier_s_acctbal_1#4538, cval_supplier_s_comment#4526 AS cval_supplier_s_comment_1#4539, cs_name#4527 AS cs_name_1#4540, cs_address#4528 AS cs_address_1#4541, cs_phone#4529 AS cs_phone_1#4542, cs_acctbal#4530 AS cs_acctbal_1#4543, cs_comment#4531 AS cs_comment_1#4544]
         :     :  +- Relation[rid#4519,cpfk_nation_supplier#4520,cfpk_supplier_nation#4521,cval_supplier_s_name#4522,cval_supplier_s_address#4523,cval_supplier_s_phone#4524,cval_supplier_s_acctbal#4525,cval_supplier_s_comment#4526,cs_name#4527,cs_address#4528,cs_phone#4529,cs_acctbal#4530,cs_comment#4531] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#4545 AS rid_2#4556, cpfk_part_partsupp#4546 AS cpfk_part_partsupp_2#4557, cfpk_partsupp_part#4547 AS cfpk_partsupp_part_2#4558, cpfk_supplier_partsupp#4548 AS cpfk_supplier_partsupp_2#4559, cfpk_partsupp_supplier#4549 AS cfpk_partsupp_supplier_2#4560, cval_partsupp_ps_availqty#4550 AS cval_partsupp_ps_availqty_2#4561, cval_partsupp_ps_supplycost#4551 AS cval_partsupp_ps_supplycost_2#4562, cval_partsupp_ps_comment#4552 AS cval_partsupp_ps_comment_2#4563, cps_availqty#4553 AS cps_availqty_2#4564, cps_supplycost#4554 AS cps_supplycost_2#4565, cps_comment#4555 AS cps_comment_2#4566]
         :        +- Relation[rid#4545,cpfk_part_partsupp#4546,cfpk_partsupp_part#4547,cpfk_supplier_partsupp#4548,cfpk_partsupp_supplier#4549,cval_partsupp_ps_availqty#4550,cval_partsupp_ps_supplycost#4551,cval_partsupp_ps_comment#4552,cps_availqty#4553,cps_supplycost#4554,cps_comment#4555] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#4497 AS rid_2#4508, cpfk_part_partsupp#4498 AS cpfk_part_partsupp_2#4509, cfpk_partsupp_part#4499 AS cfpk_partsupp_part_2#4510, cpfk_supplier_partsupp#4500 AS cpfk_supplier_partsupp_2#4511, cfpk_partsupp_supplier#4501 AS cfpk_partsupp_supplier_2#4512, cval_partsupp_ps_availqty#4502 AS cval_partsupp_ps_availqty_2#4513, cval_partsupp_ps_supplycost#4503 AS cval_partsupp_ps_supplycost_2#4514, cval_partsupp_ps_comment#4504 AS cval_partsupp_ps_comment_2#4515, cps_availqty#4505 AS cps_availqty_2#4516, cps_supplycost#4506 AS cps_supplycost_2#4517, cps_comment#4507 AS cps_comment_2#4518]
            +- Relation[rid#4497,cpfk_part_partsupp#4498,cfpk_partsupp_part#4499,cpfk_supplier_partsupp#4500,cfpk_partsupp_supplier#4501,cval_partsupp_ps_availqty#4502,cval_partsupp_ps_supplycost#4503,cval_partsupp_ps_comment#4504,cps_availqty#4505,cps_supplycost#4506,cps_comment#4507] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 10387ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/11 04:41:12 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:41:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4602L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 04:41:12 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:41:12 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:41:12 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:41:12 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:41:12 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:41:12 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:41:12 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:41:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4602L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#4604 AS rid_0#4621, cval_part_p_name#4605 AS cval_part_p_name_0#4622, cval_part_p_mfgr#4606 AS cval_part_p_mfgr_0#4623, cval_part_p_type#4607 AS cval_part_p_type_0#4624, cval_part_p_size#4608 AS cval_part_p_size_0#4625, cval_part_p_container#4609 AS cval_part_p_container_0#4626, cval_part_p_retailprice#4610 AS cval_part_p_retailprice_0#4627, cval_part_p_comment#4611 AS cval_part_p_comment_0#4628, cval_part_p_brand#4612 AS cval_part_p_brand_0#4629, cp_name#4613 AS cp_name_0#4630, cp_mfgr#4614 AS cp_mfgr_0#4631, cp_type#4615 AS cp_type_0#4632, cp_size#4616 AS cp_size_0#4633, cp_container#4617 AS cp_container_0#4634, cp_retailprice#4618 AS cp_retailprice_0#4635, cp_comment#4619 AS cp_comment_0#4636, cp_brand#4620 AS cp_brand_0#4637]
         :  :  :  :  +- Relation[rid#4604,cval_part_p_name#4605,cval_part_p_mfgr#4606,cval_part_p_type#4607,cval_part_p_size#4608,cval_part_p_container#4609,cval_part_p_retailprice#4610,cval_part_p_comment#4611,cval_part_p_brand#4612,cp_name#4613,cp_mfgr#4614,cp_type#4615,cp_size#4616,cp_container#4617,cp_retailprice#4618,cp_comment#4619,cp_brand#4620] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#4638 AS rid_0#4655, cval_part_p_name#4639 AS cval_part_p_name_0#4656, cval_part_p_mfgr#4640 AS cval_part_p_mfgr_0#4657, cval_part_p_type#4641 AS cval_part_p_type_0#4658, cval_part_p_size#4642 AS cval_part_p_size_0#4659, cval_part_p_container#4643 AS cval_part_p_container_0#4660, cval_part_p_retailprice#4644 AS cval_part_p_retailprice_0#4661, cval_part_p_comment#4645 AS cval_part_p_comment_0#4662, cval_part_p_brand#4646 AS cval_part_p_brand_0#4663, cp_name#4647 AS cp_name_0#4664, cp_mfgr#4648 AS cp_mfgr_0#4665, cp_type#4649 AS cp_type_0#4666, cp_size#4650 AS cp_size_0#4667, cp_container#4651 AS cp_container_0#4668, cp_retailprice#4652 AS cp_retailprice_0#4669, cp_comment#4653 AS cp_comment_0#4670, cp_brand#4654 AS cp_brand_0#4671]
         :  :  :        +- Relation[rid#4638,cval_part_p_name#4639,cval_part_p_mfgr#4640,cval_part_p_type#4641,cval_part_p_size#4642,cval_part_p_container#4643,cval_part_p_retailprice#4644,cval_part_p_comment#4645,cval_part_p_brand#4646,cp_name#4647,cp_mfgr#4648,cp_type#4649,cp_size#4650,cp_container#4651,cp_retailprice#4652,cp_comment#4653,cp_brand#4654] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#4672 AS rid_0#4689, cval_part_p_name#4673 AS cval_part_p_name_0#4690, cval_part_p_mfgr#4674 AS cval_part_p_mfgr_0#4691, cval_part_p_type#4675 AS cval_part_p_type_0#4692, cval_part_p_size#4676 AS cval_part_p_size_0#4693, cval_part_p_container#4677 AS cval_part_p_container_0#4694, cval_part_p_retailprice#4678 AS cval_part_p_retailprice_0#4695, cval_part_p_comment#4679 AS cval_part_p_comment_0#4696, cval_part_p_brand#4680 AS cval_part_p_brand_0#4697, cp_name#4681 AS cp_name_0#4698, cp_mfgr#4682 AS cp_mfgr_0#4699, cp_type#4683 AS cp_type_0#4700, cp_size#4684 AS cp_size_0#4701, cp_container#4685 AS cp_container_0#4702, cp_retailprice#4686 AS cp_retailprice_0#4703, cp_comment#4687 AS cp_comment_0#4704, cp_brand#4688 AS cp_brand_0#4705]
         :  :        +- Relation[rid#4672,cval_part_p_name#4673,cval_part_p_mfgr#4674,cval_part_p_type#4675,cval_part_p_size#4676,cval_part_p_container#4677,cval_part_p_retailprice#4678,cval_part_p_comment#4679,cval_part_p_brand#4680,cp_name#4681,cp_mfgr#4682,cp_type#4683,cp_size#4684,cp_container#4685,cp_retailprice#4686,cp_comment#4687,cp_brand#4688] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#4772 AS rid_0#4789, cval_part_p_name#4773 AS cval_part_p_name_0#4790, cval_part_p_mfgr#4774 AS cval_part_p_mfgr_0#4791, cval_part_p_type#4775 AS cval_part_p_type_0#4792, cval_part_p_size#4776 AS cval_part_p_size_0#4793, cval_part_p_container#4777 AS cval_part_p_container_0#4794, cval_part_p_retailprice#4778 AS cval_part_p_retailprice_0#4795, cval_part_p_comment#4779 AS cval_part_p_comment_0#4796, cval_part_p_brand#4780 AS cval_part_p_brand_0#4797, cp_name#4781 AS cp_name_0#4798, cp_mfgr#4782 AS cp_mfgr_0#4799, cp_type#4783 AS cp_type_0#4800, cp_size#4784 AS cp_size_0#4801, cp_container#4785 AS cp_container_0#4802, cp_retailprice#4786 AS cp_retailprice_0#4803, cp_comment#4787 AS cp_comment_0#4804, cp_brand#4788 AS cp_brand_0#4805]
         :     :  +- Relation[rid#4772,cval_part_p_name#4773,cval_part_p_mfgr#4774,cval_part_p_type#4775,cval_part_p_size#4776,cval_part_p_container#4777,cval_part_p_retailprice#4778,cval_part_p_comment#4779,cval_part_p_brand#4780,cp_name#4781,cp_mfgr#4782,cp_type#4783,cp_size#4784,cp_container#4785,cp_retailprice#4786,cp_comment#4787,cp_brand#4788] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#4806 AS rid_1#4839, cpfk_orders_lineitem#4807 AS cpfk_orders_lineitem_1#4840, cpfk_supplier_lineitem#4808 AS cpfk_supplier_lineitem_1#4841, cfpk_lineitem_supplier#4809 AS cfpk_lineitem_supplier_1#4842, cfpk_lineitem_partsupp#4810 AS cfpk_lineitem_partsupp_1#4843, cpfk_part_lineitem#4811 AS cpfk_part_lineitem_1#4844, cfpk_lineitem_part#4812 AS cfpk_lineitem_part_1#4845, cpfk_partsupp_lineitem#4813 AS cpfk_partsupp_lineitem_1#4846, cfpk_lineitem_orders#4814 AS cfpk_lineitem_orders_1#4847, cval_lineitem_l_quantity#4815 AS cval_lineitem_l_quantity_1#4848, cval_lineitem_l_extendedprice#4816 AS cval_lineitem_l_extendedprice_1#4849, cval_lineitem_l_discount#4817 AS cval_lineitem_l_discount_1#4850, cval_lineitem_l_tax#4818 AS cval_lineitem_l_tax_1#4851, cval_lineitem_l_returnflag#4819 AS cval_lineitem_l_returnflag_1#4852, cval_lineitem_l_linestatus#4820 AS cval_lineitem_l_linestatus_1#4853, cval_lineitem_l_commitdate#4821 AS cval_lineitem_l_commitdate_1#4854, cval_lineitem_l_receiptdate#4822 AS cval_lineitem_l_receiptdate_1#4855, cval_lineitem_l_shipinstruct#4823 AS cval_lineitem_l_shipinstruct_1#4856, cval_lineitem_l_shipmode#4824 AS cval_lineitem_l_shipmode_1#4857, cval_lineitem_l_comment#4825 AS cval_lineitem_l_comment_1#4858, cval_lineitem_l_shipdate#4826 AS cval_lineitem_l_shipdate_1#4859, cl_quantity#4827 AS cl_quantity_1#4860, cl_extendedprice#4828 AS cl_extendedprice_1#4861, cl_discount#4829 AS cl_discount_1#4862, ... 9 more fields]
         :        +- Relation[rid#4806,cpfk_orders_lineitem#4807,cpfk_supplier_lineitem#4808,cfpk_lineitem_supplier#4809,cfpk_lineitem_partsupp#4810,cpfk_part_lineitem#4811,cfpk_lineitem_part#4812,cpfk_partsupp_lineitem#4813,cfpk_lineitem_orders#4814,cval_lineitem_l_quantity#4815,cval_lineitem_l_extendedprice#4816,cval_lineitem_l_discount#4817,cval_lineitem_l_tax#4818,cval_lineitem_l_returnflag#4819,cval_lineitem_l_linestatus#4820,cval_lineitem_l_commitdate#4821,cval_lineitem_l_receiptdate#4822,cval_lineitem_l_shipinstruct#4823,cval_lineitem_l_shipmode#4824,cval_lineitem_l_comment#4825,cval_lineitem_l_shipdate#4826,cl_quantity#4827,cl_extendedprice#4828,cl_discount#4829,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4706 AS rid_1#4739, cpfk_orders_lineitem#4707 AS cpfk_orders_lineitem_1#4740, cpfk_supplier_lineitem#4708 AS cpfk_supplier_lineitem_1#4741, cfpk_lineitem_supplier#4709 AS cfpk_lineitem_supplier_1#4742, cfpk_lineitem_partsupp#4710 AS cfpk_lineitem_partsupp_1#4743, cpfk_part_lineitem#4711 AS cpfk_part_lineitem_1#4744, cfpk_lineitem_part#4712 AS cfpk_lineitem_part_1#4745, cpfk_partsupp_lineitem#4713 AS cpfk_partsupp_lineitem_1#4746, cfpk_lineitem_orders#4714 AS cfpk_lineitem_orders_1#4747, cval_lineitem_l_quantity#4715 AS cval_lineitem_l_quantity_1#4748, cval_lineitem_l_extendedprice#4716 AS cval_lineitem_l_extendedprice_1#4749, cval_lineitem_l_discount#4717 AS cval_lineitem_l_discount_1#4750, cval_lineitem_l_tax#4718 AS cval_lineitem_l_tax_1#4751, cval_lineitem_l_returnflag#4719 AS cval_lineitem_l_returnflag_1#4752, cval_lineitem_l_linestatus#4720 AS cval_lineitem_l_linestatus_1#4753, cval_lineitem_l_commitdate#4721 AS cval_lineitem_l_commitdate_1#4754, cval_lineitem_l_receiptdate#4722 AS cval_lineitem_l_receiptdate_1#4755, cval_lineitem_l_shipinstruct#4723 AS cval_lineitem_l_shipinstruct_1#4756, cval_lineitem_l_shipmode#4724 AS cval_lineitem_l_shipmode_1#4757, cval_lineitem_l_comment#4725 AS cval_lineitem_l_comment_1#4758, cval_lineitem_l_shipdate#4726 AS cval_lineitem_l_shipdate_1#4759, cl_quantity#4727 AS cl_quantity_1#4760, cl_extendedprice#4728 AS cl_extendedprice_1#4761, cl_discount#4729 AS cl_discount_1#4762, ... 9 more fields]
            +- Relation[rid#4706,cpfk_orders_lineitem#4707,cpfk_supplier_lineitem#4708,cfpk_lineitem_supplier#4709,cfpk_lineitem_partsupp#4710,cpfk_part_lineitem#4711,cfpk_lineitem_part#4712,cpfk_partsupp_lineitem#4713,cfpk_lineitem_orders#4714,cval_lineitem_l_quantity#4715,cval_lineitem_l_extendedprice#4716,cval_lineitem_l_discount#4717,cval_lineitem_l_tax#4718,cval_lineitem_l_returnflag#4719,cval_lineitem_l_linestatus#4720,cval_lineitem_l_commitdate#4721,cval_lineitem_l_receiptdate#4722,cval_lineitem_l_shipinstruct#4723,cval_lineitem_l_shipmode#4724,cval_lineitem_l_comment#4725,cval_lineitem_l_shipdate#4726,cl_quantity#4727,cl_extendedprice#4728,cl_discount#4729,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 71845ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/11 04:42:24 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:42:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4927L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 04:42:24 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:42:24 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:42:24 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:42:24 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:42:24 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:42:24 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:42:24 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 04:42:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4927L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#4929 AS rid_0#4946, cval_part_p_name#4930 AS cval_part_p_name_0#4947, cval_part_p_mfgr#4931 AS cval_part_p_mfgr_0#4948, cval_part_p_type#4932 AS cval_part_p_type_0#4949, cval_part_p_size#4933 AS cval_part_p_size_0#4950, cval_part_p_container#4934 AS cval_part_p_container_0#4951, cval_part_p_retailprice#4935 AS cval_part_p_retailprice_0#4952, cval_part_p_comment#4936 AS cval_part_p_comment_0#4953, cval_part_p_brand#4937 AS cval_part_p_brand_0#4954, cp_name#4938 AS cp_name_0#4955, cp_mfgr#4939 AS cp_mfgr_0#4956, cp_type#4940 AS cp_type_0#4957, cp_size#4941 AS cp_size_0#4958, cp_container#4942 AS cp_container_0#4959, cp_retailprice#4943 AS cp_retailprice_0#4960, cp_comment#4944 AS cp_comment_0#4961, cp_brand#4945 AS cp_brand_0#4962]
         :  :  :  :  +- Relation[rid#4929,cval_part_p_name#4930,cval_part_p_mfgr#4931,cval_part_p_type#4932,cval_part_p_size#4933,cval_part_p_container#4934,cval_part_p_retailprice#4935,cval_part_p_comment#4936,cval_part_p_brand#4937,cp_name#4938,cp_mfgr#4939,cp_type#4940,cp_size#4941,cp_container#4942,cp_retailprice#4943,cp_comment#4944,cp_brand#4945] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#4963 AS rid_0#4980, cval_part_p_name#4964 AS cval_part_p_name_0#4981, cval_part_p_mfgr#4965 AS cval_part_p_mfgr_0#4982, cval_part_p_type#4966 AS cval_part_p_type_0#4983, cval_part_p_size#4967 AS cval_part_p_size_0#4984, cval_part_p_container#4968 AS cval_part_p_container_0#4985, cval_part_p_retailprice#4969 AS cval_part_p_retailprice_0#4986, cval_part_p_comment#4970 AS cval_part_p_comment_0#4987, cval_part_p_brand#4971 AS cval_part_p_brand_0#4988, cp_name#4972 AS cp_name_0#4989, cp_mfgr#4973 AS cp_mfgr_0#4990, cp_type#4974 AS cp_type_0#4991, cp_size#4975 AS cp_size_0#4992, cp_container#4976 AS cp_container_0#4993, cp_retailprice#4977 AS cp_retailprice_0#4994, cp_comment#4978 AS cp_comment_0#4995, cp_brand#4979 AS cp_brand_0#4996]
         :  :  :        +- Relation[rid#4963,cval_part_p_name#4964,cval_part_p_mfgr#4965,cval_part_p_type#4966,cval_part_p_size#4967,cval_part_p_container#4968,cval_part_p_retailprice#4969,cval_part_p_comment#4970,cval_part_p_brand#4971,cp_name#4972,cp_mfgr#4973,cp_type#4974,cp_size#4975,cp_container#4976,cp_retailprice#4977,cp_comment#4978,cp_brand#4979] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#4997 AS rid_0#5014, cval_part_p_name#4998 AS cval_part_p_name_0#5015, cval_part_p_mfgr#4999 AS cval_part_p_mfgr_0#5016, cval_part_p_type#5000 AS cval_part_p_type_0#5017, cval_part_p_size#5001 AS cval_part_p_size_0#5018, cval_part_p_container#5002 AS cval_part_p_container_0#5019, cval_part_p_retailprice#5003 AS cval_part_p_retailprice_0#5020, cval_part_p_comment#5004 AS cval_part_p_comment_0#5021, cval_part_p_brand#5005 AS cval_part_p_brand_0#5022, cp_name#5006 AS cp_name_0#5023, cp_mfgr#5007 AS cp_mfgr_0#5024, cp_type#5008 AS cp_type_0#5025, cp_size#5009 AS cp_size_0#5026, cp_container#5010 AS cp_container_0#5027, cp_retailprice#5011 AS cp_retailprice_0#5028, cp_comment#5012 AS cp_comment_0#5029, cp_brand#5013 AS cp_brand_0#5030]
         :  :        +- Relation[rid#4997,cval_part_p_name#4998,cval_part_p_mfgr#4999,cval_part_p_type#5000,cval_part_p_size#5001,cval_part_p_container#5002,cval_part_p_retailprice#5003,cval_part_p_comment#5004,cval_part_p_brand#5005,cp_name#5006,cp_mfgr#5007,cp_type#5008,cp_size#5009,cp_container#5010,cp_retailprice#5011,cp_comment#5012,cp_brand#5013] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#5229 AS rid_0#5246, cval_part_p_name#5230 AS cval_part_p_name_0#5247, cval_part_p_mfgr#5231 AS cval_part_p_mfgr_0#5248, cval_part_p_type#5232 AS cval_part_p_type_0#5249, cval_part_p_size#5233 AS cval_part_p_size_0#5250, cval_part_p_container#5234 AS cval_part_p_container_0#5251, cval_part_p_retailprice#5235 AS cval_part_p_retailprice_0#5252, cval_part_p_comment#5236 AS cval_part_p_comment_0#5253, cval_part_p_brand#5237 AS cval_part_p_brand_0#5254, cp_name#5238 AS cp_name_0#5255, cp_mfgr#5239 AS cp_mfgr_0#5256, cp_type#5240 AS cp_type_0#5257, cp_size#5241 AS cp_size_0#5258, cp_container#5242 AS cp_container_0#5259, cp_retailprice#5243 AS cp_retailprice_0#5260, cp_comment#5244 AS cp_comment_0#5261, cp_brand#5245 AS cp_brand_0#5262]
         :     :  +- Relation[rid#5229,cval_part_p_name#5230,cval_part_p_mfgr#5231,cval_part_p_type#5232,cval_part_p_size#5233,cval_part_p_container#5234,cval_part_p_retailprice#5235,cval_part_p_comment#5236,cval_part_p_brand#5237,cp_name#5238,cp_mfgr#5239,cp_type#5240,cp_size#5241,cp_container#5242,cp_retailprice#5243,cp_comment#5244,cp_brand#5245] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#5263 AS rid_1#5296, cpfk_orders_lineitem#5264 AS cpfk_orders_lineitem_1#5297, cpfk_supplier_lineitem#5265 AS cpfk_supplier_lineitem_1#5298, cfpk_lineitem_supplier#5266 AS cfpk_lineitem_supplier_1#5299, cfpk_lineitem_partsupp#5267 AS cfpk_lineitem_partsupp_1#5300, cpfk_part_lineitem#5268 AS cpfk_part_lineitem_1#5301, cfpk_lineitem_part#5269 AS cfpk_lineitem_part_1#5302, cpfk_partsupp_lineitem#5270 AS cpfk_partsupp_lineitem_1#5303, cfpk_lineitem_orders#5271 AS cfpk_lineitem_orders_1#5304, cval_lineitem_l_quantity#5272 AS cval_lineitem_l_quantity_1#5305, cval_lineitem_l_extendedprice#5273 AS cval_lineitem_l_extendedprice_1#5306, cval_lineitem_l_discount#5274 AS cval_lineitem_l_discount_1#5307, cval_lineitem_l_tax#5275 AS cval_lineitem_l_tax_1#5308, cval_lineitem_l_returnflag#5276 AS cval_lineitem_l_returnflag_1#5309, cval_lineitem_l_linestatus#5277 AS cval_lineitem_l_linestatus_1#5310, cval_lineitem_l_commitdate#5278 AS cval_lineitem_l_commitdate_1#5311, cval_lineitem_l_receiptdate#5279 AS cval_lineitem_l_receiptdate_1#5312, cval_lineitem_l_shipinstruct#5280 AS cval_lineitem_l_shipinstruct_1#5313, cval_lineitem_l_shipmode#5281 AS cval_lineitem_l_shipmode_1#5314, cval_lineitem_l_comment#5282 AS cval_lineitem_l_comment_1#5315, cval_lineitem_l_shipdate#5283 AS cval_lineitem_l_shipdate_1#5316, cl_quantity#5284 AS cl_quantity_1#5317, cl_extendedprice#5285 AS cl_extendedprice_1#5318, cl_discount#5286 AS cl_discount_1#5319, ... 9 more fields]
         :        +- Relation[rid#5263,cpfk_orders_lineitem#5264,cpfk_supplier_lineitem#5265,cfpk_lineitem_supplier#5266,cfpk_lineitem_partsupp#5267,cpfk_part_lineitem#5268,cfpk_lineitem_part#5269,cpfk_partsupp_lineitem#5270,cfpk_lineitem_orders#5271,cval_lineitem_l_quantity#5272,cval_lineitem_l_extendedprice#5273,cval_lineitem_l_discount#5274,cval_lineitem_l_tax#5275,cval_lineitem_l_returnflag#5276,cval_lineitem_l_linestatus#5277,cval_lineitem_l_commitdate#5278,cval_lineitem_l_receiptdate#5279,cval_lineitem_l_shipinstruct#5280,cval_lineitem_l_shipmode#5281,cval_lineitem_l_comment#5282,cval_lineitem_l_shipdate#5283,cl_quantity#5284,cl_extendedprice#5285,cl_discount#5286,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#5031 AS rid_1#5064, cpfk_orders_lineitem#5032 AS cpfk_orders_lineitem_1#5065, cpfk_supplier_lineitem#5033 AS cpfk_supplier_lineitem_1#5066, cfpk_lineitem_supplier#5034 AS cfpk_lineitem_supplier_1#5067, cfpk_lineitem_partsupp#5035 AS cfpk_lineitem_partsupp_1#5068, cpfk_part_lineitem#5036 AS cpfk_part_lineitem_1#5069, cfpk_lineitem_part#5037 AS cfpk_lineitem_part_1#5070, cpfk_partsupp_lineitem#5038 AS cpfk_partsupp_lineitem_1#5071, cfpk_lineitem_orders#5039 AS cfpk_lineitem_orders_1#5072, cval_lineitem_l_quantity#5040 AS cval_lineitem_l_quantity_1#5073, cval_lineitem_l_extendedprice#5041 AS cval_lineitem_l_extendedprice_1#5074, cval_lineitem_l_discount#5042 AS cval_lineitem_l_discount_1#5075, cval_lineitem_l_tax#5043 AS cval_lineitem_l_tax_1#5076, cval_lineitem_l_returnflag#5044 AS cval_lineitem_l_returnflag_1#5077, cval_lineitem_l_linestatus#5045 AS cval_lineitem_l_linestatus_1#5078, cval_lineitem_l_commitdate#5046 AS cval_lineitem_l_commitdate_1#5079, cval_lineitem_l_receiptdate#5047 AS cval_lineitem_l_receiptdate_1#5080, cval_lineitem_l_shipinstruct#5048 AS cval_lineitem_l_shipinstruct_1#5081, cval_lineitem_l_shipmode#5049 AS cval_lineitem_l_shipmode_1#5082, cval_lineitem_l_comment#5050 AS cval_lineitem_l_comment_1#5083, cval_lineitem_l_shipdate#5051 AS cval_lineitem_l_shipdate_1#5084, cl_quantity#5052 AS cl_quantity_1#5085, cl_extendedprice#5053 AS cl_extendedprice_1#5086, cl_discount#5054 AS cl_discount_1#5087, ... 9 more fields]
            :  :  +- Relation[rid#5031,cpfk_orders_lineitem#5032,cpfk_supplier_lineitem#5033,cfpk_lineitem_supplier#5034,cfpk_lineitem_partsupp#5035,cpfk_part_lineitem#5036,cfpk_lineitem_part#5037,cpfk_partsupp_lineitem#5038,cfpk_lineitem_orders#5039,cval_lineitem_l_quantity#5040,cval_lineitem_l_extendedprice#5041,cval_lineitem_l_discount#5042,cval_lineitem_l_tax#5043,cval_lineitem_l_returnflag#5044,cval_lineitem_l_linestatus#5045,cval_lineitem_l_commitdate#5046,cval_lineitem_l_receiptdate#5047,cval_lineitem_l_shipinstruct#5048,cval_lineitem_l_shipmode#5049,cval_lineitem_l_comment#5050,cval_lineitem_l_shipdate#5051,cl_quantity#5052,cl_extendedprice#5053,cl_discount#5054,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#5097 AS rid_1#5130, cpfk_orders_lineitem#5098 AS cpfk_orders_lineitem_1#5131, cpfk_supplier_lineitem#5099 AS cpfk_supplier_lineitem_1#5132, cfpk_lineitem_supplier#5100 AS cfpk_lineitem_supplier_1#5133, cfpk_lineitem_partsupp#5101 AS cfpk_lineitem_partsupp_1#5134, cpfk_part_lineitem#5102 AS cpfk_part_lineitem_1#5135, cfpk_lineitem_part#5103 AS cfpk_lineitem_part_1#5136, cpfk_partsupp_lineitem#5104 AS cpfk_partsupp_lineitem_1#5137, cfpk_lineitem_orders#5105 AS cfpk_lineitem_orders_1#5138, cval_lineitem_l_quantity#5106 AS cval_lineitem_l_quantity_1#5139, cval_lineitem_l_extendedprice#5107 AS cval_lineitem_l_extendedprice_1#5140, cval_lineitem_l_discount#5108 AS cval_lineitem_l_discount_1#5141, cval_lineitem_l_tax#5109 AS cval_lineitem_l_tax_1#5142, cval_lineitem_l_returnflag#5110 AS cval_lineitem_l_returnflag_1#5143, cval_lineitem_l_linestatus#5111 AS cval_lineitem_l_linestatus_1#5144, cval_lineitem_l_commitdate#5112 AS cval_lineitem_l_commitdate_1#5145, cval_lineitem_l_receiptdate#5113 AS cval_lineitem_l_receiptdate_1#5146, cval_lineitem_l_shipinstruct#5114 AS cval_lineitem_l_shipinstruct_1#5147, cval_lineitem_l_shipmode#5115 AS cval_lineitem_l_shipmode_1#5148, cval_lineitem_l_comment#5116 AS cval_lineitem_l_comment_1#5149, cval_lineitem_l_shipdate#5117 AS cval_lineitem_l_shipdate_1#5150, cl_quantity#5118 AS cl_quantity_1#5151, cl_extendedprice#5119 AS cl_extendedprice_1#5152, cl_discount#5120 AS cl_discount_1#5153, ... 9 more fields]
            :        +- Relation[rid#5097,cpfk_orders_lineitem#5098,cpfk_supplier_lineitem#5099,cfpk_lineitem_supplier#5100,cfpk_lineitem_partsupp#5101,cpfk_part_lineitem#5102,cfpk_lineitem_part#5103,cpfk_partsupp_lineitem#5104,cfpk_lineitem_orders#5105,cval_lineitem_l_quantity#5106,cval_lineitem_l_extendedprice#5107,cval_lineitem_l_discount#5108,cval_lineitem_l_tax#5109,cval_lineitem_l_returnflag#5110,cval_lineitem_l_linestatus#5111,cval_lineitem_l_commitdate#5112,cval_lineitem_l_receiptdate#5113,cval_lineitem_l_shipinstruct#5114,cval_lineitem_l_shipmode#5115,cval_lineitem_l_comment#5116,cval_lineitem_l_shipdate#5117,cl_quantity#5118,cl_extendedprice#5119,cl_discount#5120,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#5163 AS rid_1#5196, cpfk_orders_lineitem#5164 AS cpfk_orders_lineitem_1#5197, cpfk_supplier_lineitem#5165 AS cpfk_supplier_lineitem_1#5198, cfpk_lineitem_supplier#5166 AS cfpk_lineitem_supplier_1#5199, cfpk_lineitem_partsupp#5167 AS cfpk_lineitem_partsupp_1#5200, cpfk_part_lineitem#5168 AS cpfk_part_lineitem_1#5201, cfpk_lineitem_part#5169 AS cfpk_lineitem_part_1#5202, cpfk_partsupp_lineitem#5170 AS cpfk_partsupp_lineitem_1#5203, cfpk_lineitem_orders#5171 AS cfpk_lineitem_orders_1#5204, cval_lineitem_l_quantity#5172 AS cval_lineitem_l_quantity_1#5205, cval_lineitem_l_extendedprice#5173 AS cval_lineitem_l_extendedprice_1#5206, cval_lineitem_l_discount#5174 AS cval_lineitem_l_discount_1#5207, cval_lineitem_l_tax#5175 AS cval_lineitem_l_tax_1#5208, cval_lineitem_l_returnflag#5176 AS cval_lineitem_l_returnflag_1#5209, cval_lineitem_l_linestatus#5177 AS cval_lineitem_l_linestatus_1#5210, cval_lineitem_l_commitdate#5178 AS cval_lineitem_l_commitdate_1#5211, cval_lineitem_l_receiptdate#5179 AS cval_lineitem_l_receiptdate_1#5212, cval_lineitem_l_shipinstruct#5180 AS cval_lineitem_l_shipinstruct_1#5213, cval_lineitem_l_shipmode#5181 AS cval_lineitem_l_shipmode_1#5214, cval_lineitem_l_comment#5182 AS cval_lineitem_l_comment_1#5215, cval_lineitem_l_shipdate#5183 AS cval_lineitem_l_shipdate_1#5216, cl_quantity#5184 AS cl_quantity_1#5217, cl_extendedprice#5185 AS cl_extendedprice_1#5218, cl_discount#5186 AS cl_discount_1#5219, ... 9 more fields]
                  +- Relation[rid#5163,cpfk_orders_lineitem#5164,cpfk_supplier_lineitem#5165,cfpk_lineitem_supplier#5166,cfpk_lineitem_partsupp#5167,cpfk_part_lineitem#5168,cfpk_lineitem_part#5169,cpfk_partsupp_lineitem#5170,cfpk_lineitem_orders#5171,cval_lineitem_l_quantity#5172,cval_lineitem_l_extendedprice#5173,cval_lineitem_l_discount#5174,cval_lineitem_l_tax#5175,cval_lineitem_l_returnflag#5176,cval_lineitem_l_linestatus#5177,cval_lineitem_l_commitdate#5178,cval_lineitem_l_receiptdate#5179,cval_lineitem_l_shipinstruct#5180,cval_lineitem_l_shipmode#5181,cval_lineitem_l_comment#5182,cval_lineitem_l_shipdate#5183,cl_quantity#5184,cl_extendedprice#5185,cl_discount#5186,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 362698ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/11 04:48:27 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:48:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5386L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 04:48:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:48:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:48:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:48:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5386L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#5388 AS rid_0#5401, cpfk_nation_supplier#5389 AS cpfk_nation_supplier_0#5402, cfpk_supplier_nation#5390 AS cfpk_supplier_nation_0#5403, cval_supplier_s_name#5391 AS cval_supplier_s_name_0#5404, cval_supplier_s_address#5392 AS cval_supplier_s_address_0#5405, cval_supplier_s_phone#5393 AS cval_supplier_s_phone_0#5406, cval_supplier_s_acctbal#5394 AS cval_supplier_s_acctbal_0#5407, cval_supplier_s_comment#5395 AS cval_supplier_s_comment_0#5408, cs_name#5396 AS cs_name_0#5409, cs_address#5397 AS cs_address_0#5410, cs_phone#5398 AS cs_phone_0#5411, cs_acctbal#5399 AS cs_acctbal_0#5412, cs_comment#5400 AS cs_comment_0#5413]
         :  :  +- Relation[rid#5388,cpfk_nation_supplier#5389,cfpk_supplier_nation#5390,cval_supplier_s_name#5391,cval_supplier_s_address#5392,cval_supplier_s_phone#5393,cval_supplier_s_acctbal#5394,cval_supplier_s_comment#5395,cs_name#5396,cs_address#5397,cs_phone#5398,cs_acctbal#5399,cs_comment#5400] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#5480 AS rid_0#5493, cpfk_nation_supplier#5481 AS cpfk_nation_supplier_0#5494, cfpk_supplier_nation#5482 AS cfpk_supplier_nation_0#5495, cval_supplier_s_name#5483 AS cval_supplier_s_name_0#5496, cval_supplier_s_address#5484 AS cval_supplier_s_address_0#5497, cval_supplier_s_phone#5485 AS cval_supplier_s_phone_0#5498, cval_supplier_s_acctbal#5486 AS cval_supplier_s_acctbal_0#5499, cval_supplier_s_comment#5487 AS cval_supplier_s_comment_0#5500, cs_name#5488 AS cs_name_0#5501, cs_address#5489 AS cs_address_0#5502, cs_phone#5490 AS cs_phone_0#5503, cs_acctbal#5491 AS cs_acctbal_0#5504, cs_comment#5492 AS cs_comment_0#5505]
         :     :  +- Relation[rid#5480,cpfk_nation_supplier#5481,cfpk_supplier_nation#5482,cval_supplier_s_name#5483,cval_supplier_s_address#5484,cval_supplier_s_phone#5485,cval_supplier_s_acctbal#5486,cval_supplier_s_comment#5487,cs_name#5488,cs_address#5489,cs_phone#5490,cs_acctbal#5491,cs_comment#5492] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#5506 AS rid_1#5539, cpfk_orders_lineitem#5507 AS cpfk_orders_lineitem_1#5540, cpfk_supplier_lineitem#5508 AS cpfk_supplier_lineitem_1#5541, cfpk_lineitem_supplier#5509 AS cfpk_lineitem_supplier_1#5542, cfpk_lineitem_partsupp#5510 AS cfpk_lineitem_partsupp_1#5543, cpfk_part_lineitem#5511 AS cpfk_part_lineitem_1#5544, cfpk_lineitem_part#5512 AS cfpk_lineitem_part_1#5545, cpfk_partsupp_lineitem#5513 AS cpfk_partsupp_lineitem_1#5546, cfpk_lineitem_orders#5514 AS cfpk_lineitem_orders_1#5547, cval_lineitem_l_quantity#5515 AS cval_lineitem_l_quantity_1#5548, cval_lineitem_l_extendedprice#5516 AS cval_lineitem_l_extendedprice_1#5549, cval_lineitem_l_discount#5517 AS cval_lineitem_l_discount_1#5550, cval_lineitem_l_tax#5518 AS cval_lineitem_l_tax_1#5551, cval_lineitem_l_returnflag#5519 AS cval_lineitem_l_returnflag_1#5552, cval_lineitem_l_linestatus#5520 AS cval_lineitem_l_linestatus_1#5553, cval_lineitem_l_commitdate#5521 AS cval_lineitem_l_commitdate_1#5554, cval_lineitem_l_receiptdate#5522 AS cval_lineitem_l_receiptdate_1#5555, cval_lineitem_l_shipinstruct#5523 AS cval_lineitem_l_shipinstruct_1#5556, cval_lineitem_l_shipmode#5524 AS cval_lineitem_l_shipmode_1#5557, cval_lineitem_l_comment#5525 AS cval_lineitem_l_comment_1#5558, cval_lineitem_l_shipdate#5526 AS cval_lineitem_l_shipdate_1#5559, cl_quantity#5527 AS cl_quantity_1#5560, cl_extendedprice#5528 AS cl_extendedprice_1#5561, cl_discount#5529 AS cl_discount_1#5562, ... 9 more fields]
         :        +- Relation[rid#5506,cpfk_orders_lineitem#5507,cpfk_supplier_lineitem#5508,cfpk_lineitem_supplier#5509,cfpk_lineitem_partsupp#5510,cpfk_part_lineitem#5511,cfpk_lineitem_part#5512,cpfk_partsupp_lineitem#5513,cfpk_lineitem_orders#5514,cval_lineitem_l_quantity#5515,cval_lineitem_l_extendedprice#5516,cval_lineitem_l_discount#5517,cval_lineitem_l_tax#5518,cval_lineitem_l_returnflag#5519,cval_lineitem_l_linestatus#5520,cval_lineitem_l_commitdate#5521,cval_lineitem_l_receiptdate#5522,cval_lineitem_l_shipinstruct#5523,cval_lineitem_l_shipmode#5524,cval_lineitem_l_comment#5525,cval_lineitem_l_shipdate#5526,cl_quantity#5527,cl_extendedprice#5528,cl_discount#5529,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5414 AS rid_1#5447, cpfk_orders_lineitem#5415 AS cpfk_orders_lineitem_1#5448, cpfk_supplier_lineitem#5416 AS cpfk_supplier_lineitem_1#5449, cfpk_lineitem_supplier#5417 AS cfpk_lineitem_supplier_1#5450, cfpk_lineitem_partsupp#5418 AS cfpk_lineitem_partsupp_1#5451, cpfk_part_lineitem#5419 AS cpfk_part_lineitem_1#5452, cfpk_lineitem_part#5420 AS cfpk_lineitem_part_1#5453, cpfk_partsupp_lineitem#5421 AS cpfk_partsupp_lineitem_1#5454, cfpk_lineitem_orders#5422 AS cfpk_lineitem_orders_1#5455, cval_lineitem_l_quantity#5423 AS cval_lineitem_l_quantity_1#5456, cval_lineitem_l_extendedprice#5424 AS cval_lineitem_l_extendedprice_1#5457, cval_lineitem_l_discount#5425 AS cval_lineitem_l_discount_1#5458, cval_lineitem_l_tax#5426 AS cval_lineitem_l_tax_1#5459, cval_lineitem_l_returnflag#5427 AS cval_lineitem_l_returnflag_1#5460, cval_lineitem_l_linestatus#5428 AS cval_lineitem_l_linestatus_1#5461, cval_lineitem_l_commitdate#5429 AS cval_lineitem_l_commitdate_1#5462, cval_lineitem_l_receiptdate#5430 AS cval_lineitem_l_receiptdate_1#5463, cval_lineitem_l_shipinstruct#5431 AS cval_lineitem_l_shipinstruct_1#5464, cval_lineitem_l_shipmode#5432 AS cval_lineitem_l_shipmode_1#5465, cval_lineitem_l_comment#5433 AS cval_lineitem_l_comment_1#5466, cval_lineitem_l_shipdate#5434 AS cval_lineitem_l_shipdate_1#5467, cl_quantity#5435 AS cl_quantity_1#5468, cl_extendedprice#5436 AS cl_extendedprice_1#5469, cl_discount#5437 AS cl_discount_1#5470, ... 9 more fields]
            +- Relation[rid#5414,cpfk_orders_lineitem#5415,cpfk_supplier_lineitem#5416,cfpk_lineitem_supplier#5417,cfpk_lineitem_partsupp#5418,cpfk_part_lineitem#5419,cfpk_lineitem_part#5420,cpfk_partsupp_lineitem#5421,cfpk_lineitem_orders#5422,cval_lineitem_l_quantity#5423,cval_lineitem_l_extendedprice#5424,cval_lineitem_l_discount#5425,cval_lineitem_l_tax#5426,cval_lineitem_l_returnflag#5427,cval_lineitem_l_linestatus#5428,cval_lineitem_l_commitdate#5429,cval_lineitem_l_receiptdate#5430,cval_lineitem_l_shipinstruct#5431,cval_lineitem_l_shipmode#5432,cval_lineitem_l_comment#5433,cval_lineitem_l_shipdate#5434,cl_quantity#5435,cl_extendedprice#5436,cl_discount#5437,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 76846ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/11 04:49:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:49:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5625L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 04:49:43 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:49:43 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:49:43 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:49:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5625L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#5627 AS rid_0#5644, cval_part_p_name#5628 AS cval_part_p_name_0#5645, cval_part_p_mfgr#5629 AS cval_part_p_mfgr_0#5646, cval_part_p_type#5630 AS cval_part_p_type_0#5647, cval_part_p_size#5631 AS cval_part_p_size_0#5648, cval_part_p_container#5632 AS cval_part_p_container_0#5649, cval_part_p_retailprice#5633 AS cval_part_p_retailprice_0#5650, cval_part_p_comment#5634 AS cval_part_p_comment_0#5651, cval_part_p_brand#5635 AS cval_part_p_brand_0#5652, cp_name#5636 AS cp_name_0#5653, cp_mfgr#5637 AS cp_mfgr_0#5654, cp_type#5638 AS cp_type_0#5655, cp_size#5639 AS cp_size_0#5656, cp_container#5640 AS cp_container_0#5657, cp_retailprice#5641 AS cp_retailprice_0#5658, cp_comment#5642 AS cp_comment_0#5659, cp_brand#5643 AS cp_brand_0#5660]
         :  :  :  +- Relation[rid#5627,cval_part_p_name#5628,cval_part_p_mfgr#5629,cval_part_p_type#5630,cval_part_p_size#5631,cval_part_p_container#5632,cval_part_p_retailprice#5633,cval_part_p_comment#5634,cval_part_p_brand#5635,cp_name#5636,cp_mfgr#5637,cp_type#5638,cp_size#5639,cp_container#5640,cp_retailprice#5641,cp_comment#5642,cp_brand#5643] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#5661 AS rid_0#5678, cval_part_p_name#5662 AS cval_part_p_name_0#5679, cval_part_p_mfgr#5663 AS cval_part_p_mfgr_0#5680, cval_part_p_type#5664 AS cval_part_p_type_0#5681, cval_part_p_size#5665 AS cval_part_p_size_0#5682, cval_part_p_container#5666 AS cval_part_p_container_0#5683, cval_part_p_retailprice#5667 AS cval_part_p_retailprice_0#5684, cval_part_p_comment#5668 AS cval_part_p_comment_0#5685, cval_part_p_brand#5669 AS cval_part_p_brand_0#5686, cp_name#5670 AS cp_name_0#5687, cp_mfgr#5671 AS cp_mfgr_0#5688, cp_type#5672 AS cp_type_0#5689, cp_size#5673 AS cp_size_0#5690, cp_container#5674 AS cp_container_0#5691, cp_retailprice#5675 AS cp_retailprice_0#5692, cp_comment#5676 AS cp_comment_0#5693, cp_brand#5677 AS cp_brand_0#5694]
         :  :        +- Relation[rid#5661,cval_part_p_name#5662,cval_part_p_mfgr#5663,cval_part_p_type#5664,cval_part_p_size#5665,cval_part_p_container#5666,cval_part_p_retailprice#5667,cval_part_p_comment#5668,cval_part_p_brand#5669,cp_name#5670,cp_mfgr#5671,cp_type#5672,cp_size#5673,cp_container#5674,cp_retailprice#5675,cp_comment#5676,cp_brand#5677] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :     :- Project [rid#5717 AS rid_0#5734, cval_part_p_name#5718 AS cval_part_p_name_0#5735, cval_part_p_mfgr#5719 AS cval_part_p_mfgr_0#5736, cval_part_p_type#5720 AS cval_part_p_type_0#5737, cval_part_p_size#5721 AS cval_part_p_size_0#5738, cval_part_p_container#5722 AS cval_part_p_container_0#5739, cval_part_p_retailprice#5723 AS cval_part_p_retailprice_0#5740, cval_part_p_comment#5724 AS cval_part_p_comment_0#5741, cval_part_p_brand#5725 AS cval_part_p_brand_0#5742, cp_name#5726 AS cp_name_0#5743, cp_mfgr#5727 AS cp_mfgr_0#5744, cp_type#5728 AS cp_type_0#5745, cp_size#5729 AS cp_size_0#5746, cp_container#5730 AS cp_container_0#5747, cp_retailprice#5731 AS cp_retailprice_0#5748, cp_comment#5732 AS cp_comment_0#5749, cp_brand#5733 AS cp_brand_0#5750]
         :     :  +- Relation[rid#5717,cval_part_p_name#5718,cval_part_p_mfgr#5719,cval_part_p_type#5720,cval_part_p_size#5721,cval_part_p_container#5722,cval_part_p_retailprice#5723,cval_part_p_comment#5724,cval_part_p_brand#5725,cp_name#5726,cp_mfgr#5727,cp_type#5728,cp_size#5729,cp_container#5730,cp_retailprice#5731,cp_comment#5732,cp_brand#5733] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#5751 AS rid_1#5762, cpfk_part_partsupp#5752 AS cpfk_part_partsupp_1#5763, cfpk_partsupp_part#5753 AS cfpk_partsupp_part_1#5764, cpfk_supplier_partsupp#5754 AS cpfk_supplier_partsupp_1#5765, cfpk_partsupp_supplier#5755 AS cfpk_partsupp_supplier_1#5766, cval_partsupp_ps_availqty#5756 AS cval_partsupp_ps_availqty_1#5767, cval_partsupp_ps_supplycost#5757 AS cval_partsupp_ps_supplycost_1#5768, cval_partsupp_ps_comment#5758 AS cval_partsupp_ps_comment_1#5769, cps_availqty#5759 AS cps_availqty_1#5770, cps_supplycost#5760 AS cps_supplycost_1#5771, cps_comment#5761 AS cps_comment_1#5772]
         :        +- Relation[rid#5751,cpfk_part_partsupp#5752,cfpk_partsupp_part#5753,cpfk_supplier_partsupp#5754,cfpk_partsupp_supplier#5755,cval_partsupp_ps_availqty#5756,cval_partsupp_ps_supplycost#5757,cval_partsupp_ps_comment#5758,cps_availqty#5759,cps_supplycost#5760,cps_comment#5761] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#5695 AS rid_1#5706, cpfk_part_partsupp#5696 AS cpfk_part_partsupp_1#5707, cfpk_partsupp_part#5697 AS cfpk_partsupp_part_1#5708, cpfk_supplier_partsupp#5698 AS cpfk_supplier_partsupp_1#5709, cfpk_partsupp_supplier#5699 AS cfpk_partsupp_supplier_1#5710, cval_partsupp_ps_availqty#5700 AS cval_partsupp_ps_availqty_1#5711, cval_partsupp_ps_supplycost#5701 AS cval_partsupp_ps_supplycost_1#5712, cval_partsupp_ps_comment#5702 AS cval_partsupp_ps_comment_1#5713, cps_availqty#5703 AS cps_availqty_1#5714, cps_supplycost#5704 AS cps_supplycost_1#5715, cps_comment#5705 AS cps_comment_1#5716]
            +- Relation[rid#5695,cpfk_part_partsupp#5696,cfpk_partsupp_part#5697,cpfk_supplier_partsupp#5698,cfpk_partsupp_supplier#5699,cval_partsupp_ps_availqty#5700,cval_partsupp_ps_supplycost#5701,cval_partsupp_ps_comment#5702,cps_availqty#5703,cps_supplycost#5704,cps_comment#5705] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 11070ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/11 04:49:54 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:49:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5806L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 04:49:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#5806L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#5808 AS rid_0#5841, cpfk_orders_lineitem#5809 AS cpfk_orders_lineitem_0#5842, cpfk_supplier_lineitem#5810 AS cpfk_supplier_lineitem_0#5843, cfpk_lineitem_supplier#5811 AS cfpk_lineitem_supplier_0#5844, cfpk_lineitem_partsupp#5812 AS cfpk_lineitem_partsupp_0#5845, cpfk_part_lineitem#5813 AS cpfk_part_lineitem_0#5846, cfpk_lineitem_part#5814 AS cfpk_lineitem_part_0#5847, cpfk_partsupp_lineitem#5815 AS cpfk_partsupp_lineitem_0#5848, cfpk_lineitem_orders#5816 AS cfpk_lineitem_orders_0#5849, cval_lineitem_l_quantity#5817 AS cval_lineitem_l_quantity_0#5850, cval_lineitem_l_extendedprice#5818 AS cval_lineitem_l_extendedprice_0#5851, cval_lineitem_l_discount#5819 AS cval_lineitem_l_discount_0#5852, cval_lineitem_l_tax#5820 AS cval_lineitem_l_tax_0#5853, cval_lineitem_l_returnflag#5821 AS cval_lineitem_l_returnflag_0#5854, cval_lineitem_l_linestatus#5822 AS cval_lineitem_l_linestatus_0#5855, cval_lineitem_l_commitdate#5823 AS cval_lineitem_l_commitdate_0#5856, cval_lineitem_l_receiptdate#5824 AS cval_lineitem_l_receiptdate_0#5857, cval_lineitem_l_shipinstruct#5825 AS cval_lineitem_l_shipinstruct_0#5858, cval_lineitem_l_shipmode#5826 AS cval_lineitem_l_shipmode_0#5859, cval_lineitem_l_comment#5827 AS cval_lineitem_l_comment_0#5860, cval_lineitem_l_shipdate#5828 AS cval_lineitem_l_shipdate_0#5861, cl_quantity#5829 AS cl_quantity_0#5862, cl_extendedprice#5830 AS cl_extendedprice_0#5863, cl_discount#5831 AS cl_discount_0#5864, ... 9 more fields]
         +- Relation[rid#5808,cpfk_orders_lineitem#5809,cpfk_supplier_lineitem#5810,cfpk_lineitem_supplier#5811,cfpk_lineitem_partsupp#5812,cpfk_part_lineitem#5813,cfpk_lineitem_part#5814,cpfk_partsupp_lineitem#5815,cfpk_lineitem_orders#5816,cval_lineitem_l_quantity#5817,cval_lineitem_l_extendedprice#5818,cval_lineitem_l_discount#5819,cval_lineitem_l_tax#5820,cval_lineitem_l_returnflag#5821,cval_lineitem_l_linestatus#5822,cval_lineitem_l_commitdate#5823,cval_lineitem_l_receiptdate#5824,cval_lineitem_l_shipinstruct#5825,cval_lineitem_l_shipmode#5826,cval_lineitem_l_comment#5827,cval_lineitem_l_shipdate#5828,cl_quantity#5829,cl_extendedprice#5830,cl_discount#5831,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2924ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/11 04:49:57 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:49:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5913L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 04:49:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5913L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#5915 AS rid_0#5932, cval_part_p_name#5916 AS cval_part_p_name_0#5933, cval_part_p_mfgr#5917 AS cval_part_p_mfgr_0#5934, cval_part_p_type#5918 AS cval_part_p_type_0#5935, cval_part_p_size#5919 AS cval_part_p_size_0#5936, cval_part_p_container#5920 AS cval_part_p_container_0#5937, cval_part_p_retailprice#5921 AS cval_part_p_retailprice_0#5938, cval_part_p_comment#5922 AS cval_part_p_comment_0#5939, cval_part_p_brand#5923 AS cval_part_p_brand_0#5940, cp_name#5924 AS cp_name_0#5941, cp_mfgr#5925 AS cp_mfgr_0#5942, cp_type#5926 AS cp_type_0#5943, cp_size#5927 AS cp_size_0#5944, cp_container#5928 AS cp_container_0#5945, cp_retailprice#5929 AS cp_retailprice_0#5946, cp_comment#5930 AS cp_comment_0#5947, cp_brand#5931 AS cp_brand_0#5948]
         :  :  +- Relation[rid#5915,cval_part_p_name#5916,cval_part_p_mfgr#5917,cval_part_p_type#5918,cval_part_p_size#5919,cval_part_p_container#5920,cval_part_p_retailprice#5921,cval_part_p_comment#5922,cval_part_p_brand#5923,cp_name#5924,cp_mfgr#5925,cp_type#5926,cp_size#5927,cp_container#5928,cp_retailprice#5929,cp_comment#5930,cp_brand#5931] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#6015 AS rid_0#6032, cval_part_p_name#6016 AS cval_part_p_name_0#6033, cval_part_p_mfgr#6017 AS cval_part_p_mfgr_0#6034, cval_part_p_type#6018 AS cval_part_p_type_0#6035, cval_part_p_size#6019 AS cval_part_p_size_0#6036, cval_part_p_container#6020 AS cval_part_p_container_0#6037, cval_part_p_retailprice#6021 AS cval_part_p_retailprice_0#6038, cval_part_p_comment#6022 AS cval_part_p_comment_0#6039, cval_part_p_brand#6023 AS cval_part_p_brand_0#6040, cp_name#6024 AS cp_name_0#6041, cp_mfgr#6025 AS cp_mfgr_0#6042, cp_type#6026 AS cp_type_0#6043, cp_size#6027 AS cp_size_0#6044, cp_container#6028 AS cp_container_0#6045, cp_retailprice#6029 AS cp_retailprice_0#6046, cp_comment#6030 AS cp_comment_0#6047, cp_brand#6031 AS cp_brand_0#6048]
         :     :  +- Relation[rid#6015,cval_part_p_name#6016,cval_part_p_mfgr#6017,cval_part_p_type#6018,cval_part_p_size#6019,cval_part_p_container#6020,cval_part_p_retailprice#6021,cval_part_p_comment#6022,cval_part_p_brand#6023,cp_name#6024,cp_mfgr#6025,cp_type#6026,cp_size#6027,cp_container#6028,cp_retailprice#6029,cp_comment#6030,cp_brand#6031] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#6049 AS rid_1#6082, cpfk_orders_lineitem#6050 AS cpfk_orders_lineitem_1#6083, cpfk_supplier_lineitem#6051 AS cpfk_supplier_lineitem_1#6084, cfpk_lineitem_supplier#6052 AS cfpk_lineitem_supplier_1#6085, cfpk_lineitem_partsupp#6053 AS cfpk_lineitem_partsupp_1#6086, cpfk_part_lineitem#6054 AS cpfk_part_lineitem_1#6087, cfpk_lineitem_part#6055 AS cfpk_lineitem_part_1#6088, cpfk_partsupp_lineitem#6056 AS cpfk_partsupp_lineitem_1#6089, cfpk_lineitem_orders#6057 AS cfpk_lineitem_orders_1#6090, cval_lineitem_l_quantity#6058 AS cval_lineitem_l_quantity_1#6091, cval_lineitem_l_extendedprice#6059 AS cval_lineitem_l_extendedprice_1#6092, cval_lineitem_l_discount#6060 AS cval_lineitem_l_discount_1#6093, cval_lineitem_l_tax#6061 AS cval_lineitem_l_tax_1#6094, cval_lineitem_l_returnflag#6062 AS cval_lineitem_l_returnflag_1#6095, cval_lineitem_l_linestatus#6063 AS cval_lineitem_l_linestatus_1#6096, cval_lineitem_l_commitdate#6064 AS cval_lineitem_l_commitdate_1#6097, cval_lineitem_l_receiptdate#6065 AS cval_lineitem_l_receiptdate_1#6098, cval_lineitem_l_shipinstruct#6066 AS cval_lineitem_l_shipinstruct_1#6099, cval_lineitem_l_shipmode#6067 AS cval_lineitem_l_shipmode_1#6100, cval_lineitem_l_comment#6068 AS cval_lineitem_l_comment_1#6101, cval_lineitem_l_shipdate#6069 AS cval_lineitem_l_shipdate_1#6102, cl_quantity#6070 AS cl_quantity_1#6103, cl_extendedprice#6071 AS cl_extendedprice_1#6104, cl_discount#6072 AS cl_discount_1#6105, ... 9 more fields]
         :        +- Relation[rid#6049,cpfk_orders_lineitem#6050,cpfk_supplier_lineitem#6051,cfpk_lineitem_supplier#6052,cfpk_lineitem_partsupp#6053,cpfk_part_lineitem#6054,cfpk_lineitem_part#6055,cpfk_partsupp_lineitem#6056,cfpk_lineitem_orders#6057,cval_lineitem_l_quantity#6058,cval_lineitem_l_extendedprice#6059,cval_lineitem_l_discount#6060,cval_lineitem_l_tax#6061,cval_lineitem_l_returnflag#6062,cval_lineitem_l_linestatus#6063,cval_lineitem_l_commitdate#6064,cval_lineitem_l_receiptdate#6065,cval_lineitem_l_shipinstruct#6066,cval_lineitem_l_shipmode#6067,cval_lineitem_l_comment#6068,cval_lineitem_l_shipdate#6069,cl_quantity#6070,cl_extendedprice#6071,cl_discount#6072,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5949 AS rid_1#5982, cpfk_orders_lineitem#5950 AS cpfk_orders_lineitem_1#5983, cpfk_supplier_lineitem#5951 AS cpfk_supplier_lineitem_1#5984, cfpk_lineitem_supplier#5952 AS cfpk_lineitem_supplier_1#5985, cfpk_lineitem_partsupp#5953 AS cfpk_lineitem_partsupp_1#5986, cpfk_part_lineitem#5954 AS cpfk_part_lineitem_1#5987, cfpk_lineitem_part#5955 AS cfpk_lineitem_part_1#5988, cpfk_partsupp_lineitem#5956 AS cpfk_partsupp_lineitem_1#5989, cfpk_lineitem_orders#5957 AS cfpk_lineitem_orders_1#5990, cval_lineitem_l_quantity#5958 AS cval_lineitem_l_quantity_1#5991, cval_lineitem_l_extendedprice#5959 AS cval_lineitem_l_extendedprice_1#5992, cval_lineitem_l_discount#5960 AS cval_lineitem_l_discount_1#5993, cval_lineitem_l_tax#5961 AS cval_lineitem_l_tax_1#5994, cval_lineitem_l_returnflag#5962 AS cval_lineitem_l_returnflag_1#5995, cval_lineitem_l_linestatus#5963 AS cval_lineitem_l_linestatus_1#5996, cval_lineitem_l_commitdate#5964 AS cval_lineitem_l_commitdate_1#5997, cval_lineitem_l_receiptdate#5965 AS cval_lineitem_l_receiptdate_1#5998, cval_lineitem_l_shipinstruct#5966 AS cval_lineitem_l_shipinstruct_1#5999, cval_lineitem_l_shipmode#5967 AS cval_lineitem_l_shipmode_1#6000, cval_lineitem_l_comment#5968 AS cval_lineitem_l_comment_1#6001, cval_lineitem_l_shipdate#5969 AS cval_lineitem_l_shipdate_1#6002, cl_quantity#5970 AS cl_quantity_1#6003, cl_extendedprice#5971 AS cl_extendedprice_1#6004, cl_discount#5972 AS cl_discount_1#6005, ... 9 more fields]
            +- Relation[rid#5949,cpfk_orders_lineitem#5950,cpfk_supplier_lineitem#5951,cfpk_lineitem_supplier#5952,cfpk_lineitem_partsupp#5953,cpfk_part_lineitem#5954,cfpk_lineitem_part#5955,cpfk_partsupp_lineitem#5956,cfpk_lineitem_orders#5957,cval_lineitem_l_quantity#5958,cval_lineitem_l_extendedprice#5959,cval_lineitem_l_discount#5960,cval_lineitem_l_tax#5961,cval_lineitem_l_returnflag#5962,cval_lineitem_l_linestatus#5963,cval_lineitem_l_commitdate#5964,cval_lineitem_l_receiptdate#5965,cval_lineitem_l_shipinstruct#5966,cval_lineitem_l_shipmode#5967,cval_lineitem_l_comment#5968,cval_lineitem_l_shipdate#5969,cl_quantity#5970,cl_extendedprice#5971,cl_discount#5972,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 82355ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/11 04:51:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:51:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6172L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 04:51:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:51:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:51:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:51:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:51:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:51:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:51:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:51:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:51:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:51:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:51:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:51:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 04:51:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:51:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:51:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:51:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6172L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#6174 AS rid_0#6191, cval_part_p_name#6175 AS cval_part_p_name_0#6192, cval_part_p_mfgr#6176 AS cval_part_p_mfgr_0#6193, cval_part_p_type#6177 AS cval_part_p_type_0#6194, cval_part_p_size#6178 AS cval_part_p_size_0#6195, cval_part_p_container#6179 AS cval_part_p_container_0#6196, cval_part_p_retailprice#6180 AS cval_part_p_retailprice_0#6197, cval_part_p_comment#6181 AS cval_part_p_comment_0#6198, cval_part_p_brand#6182 AS cval_part_p_brand_0#6199, cp_name#6183 AS cp_name_0#6200, cp_mfgr#6184 AS cp_mfgr_0#6201, cp_type#6185 AS cp_type_0#6202, cp_size#6186 AS cp_size_0#6203, cp_container#6187 AS cp_container_0#6204, cp_retailprice#6188 AS cp_retailprice_0#6205, cp_comment#6189 AS cp_comment_0#6206, cp_brand#6190 AS cp_brand_0#6207]
            :     :     :  :  :  :  +- Relation[rid#6174,cval_part_p_name#6175,cval_part_p_mfgr#6176,cval_part_p_type#6177,cval_part_p_size#6178,cval_part_p_container#6179,cval_part_p_retailprice#6180,cval_part_p_comment#6181,cval_part_p_brand#6182,cp_name#6183,cp_mfgr#6184,cp_type#6185,cp_size#6186,cp_container#6187,cp_retailprice#6188,cp_comment#6189,cp_brand#6190] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#6208 AS rid_0#6225, cval_part_p_name#6209 AS cval_part_p_name_0#6226, cval_part_p_mfgr#6210 AS cval_part_p_mfgr_0#6227, cval_part_p_type#6211 AS cval_part_p_type_0#6228, cval_part_p_size#6212 AS cval_part_p_size_0#6229, cval_part_p_container#6213 AS cval_part_p_container_0#6230, cval_part_p_retailprice#6214 AS cval_part_p_retailprice_0#6231, cval_part_p_comment#6215 AS cval_part_p_comment_0#6232, cval_part_p_brand#6216 AS cval_part_p_brand_0#6233, cp_name#6217 AS cp_name_0#6234, cp_mfgr#6218 AS cp_mfgr_0#6235, cp_type#6219 AS cp_type_0#6236, cp_size#6220 AS cp_size_0#6237, cp_container#6221 AS cp_container_0#6238, cp_retailprice#6222 AS cp_retailprice_0#6239, cp_comment#6223 AS cp_comment_0#6240, cp_brand#6224 AS cp_brand_0#6241]
            :     :     :  :  :        +- Relation[rid#6208,cval_part_p_name#6209,cval_part_p_mfgr#6210,cval_part_p_type#6211,cval_part_p_size#6212,cval_part_p_container#6213,cval_part_p_retailprice#6214,cval_part_p_comment#6215,cval_part_p_brand#6216,cp_name#6217,cp_mfgr#6218,cp_type#6219,cp_size#6220,cp_container#6221,cp_retailprice#6222,cp_comment#6223,cp_brand#6224] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :     :- Project [rid#6308 AS rid_0#6325, cval_part_p_name#6309 AS cval_part_p_name_0#6326, cval_part_p_mfgr#6310 AS cval_part_p_mfgr_0#6327, cval_part_p_type#6311 AS cval_part_p_type_0#6328, cval_part_p_size#6312 AS cval_part_p_size_0#6329, cval_part_p_container#6313 AS cval_part_p_container_0#6330, cval_part_p_retailprice#6314 AS cval_part_p_retailprice_0#6331, cval_part_p_comment#6315 AS cval_part_p_comment_0#6332, cval_part_p_brand#6316 AS cval_part_p_brand_0#6333, cp_name#6317 AS cp_name_0#6334, cp_mfgr#6318 AS cp_mfgr_0#6335, cp_type#6319 AS cp_type_0#6336, cp_size#6320 AS cp_size_0#6337, cp_container#6321 AS cp_container_0#6338, cp_retailprice#6322 AS cp_retailprice_0#6339, cp_comment#6323 AS cp_comment_0#6340, cp_brand#6324 AS cp_brand_0#6341]
            :     :     :  :     :  +- Relation[rid#6308,cval_part_p_name#6309,cval_part_p_mfgr#6310,cval_part_p_type#6311,cval_part_p_size#6312,cval_part_p_container#6313,cval_part_p_retailprice#6314,cval_part_p_comment#6315,cval_part_p_brand#6316,cp_name#6317,cp_mfgr#6318,cp_type#6319,cp_size#6320,cp_container#6321,cp_retailprice#6322,cp_comment#6323,cp_brand#6324] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :     +- Project [rid#6342 AS rid_1#6375, cpfk_orders_lineitem#6343 AS cpfk_orders_lineitem_1#6376, cpfk_supplier_lineitem#6344 AS cpfk_supplier_lineitem_1#6377, cfpk_lineitem_supplier#6345 AS cfpk_lineitem_supplier_1#6378, cfpk_lineitem_partsupp#6346 AS cfpk_lineitem_partsupp_1#6379, cpfk_part_lineitem#6347 AS cpfk_part_lineitem_1#6380, cfpk_lineitem_part#6348 AS cfpk_lineitem_part_1#6381, cpfk_partsupp_lineitem#6349 AS cpfk_partsupp_lineitem_1#6382, cfpk_lineitem_orders#6350 AS cfpk_lineitem_orders_1#6383, cval_lineitem_l_quantity#6351 AS cval_lineitem_l_quantity_1#6384, cval_lineitem_l_extendedprice#6352 AS cval_lineitem_l_extendedprice_1#6385, cval_lineitem_l_discount#6353 AS cval_lineitem_l_discount_1#6386, cval_lineitem_l_tax#6354 AS cval_lineitem_l_tax_1#6387, cval_lineitem_l_returnflag#6355 AS cval_lineitem_l_returnflag_1#6388, cval_lineitem_l_linestatus#6356 AS cval_lineitem_l_linestatus_1#6389, cval_lineitem_l_commitdate#6357 AS cval_lineitem_l_commitdate_1#6390, cval_lineitem_l_receiptdate#6358 AS cval_lineitem_l_receiptdate_1#6391, cval_lineitem_l_shipinstruct#6359 AS cval_lineitem_l_shipinstruct_1#6392, cval_lineitem_l_shipmode#6360 AS cval_lineitem_l_shipmode_1#6393, cval_lineitem_l_comment#6361 AS cval_lineitem_l_comment_1#6394, cval_lineitem_l_shipdate#6362 AS cval_lineitem_l_shipdate_1#6395, cl_quantity#6363 AS cl_quantity_1#6396, cl_extendedprice#6364 AS cl_extendedprice_1#6397, cl_discount#6365 AS cl_discount_1#6398, ... 9 more fields]
            :     :     :  :        +- Relation[rid#6342,cpfk_orders_lineitem#6343,cpfk_supplier_lineitem#6344,cfpk_lineitem_supplier#6345,cfpk_lineitem_partsupp#6346,cpfk_part_lineitem#6347,cfpk_lineitem_part#6348,cpfk_partsupp_lineitem#6349,cfpk_lineitem_orders#6350,cval_lineitem_l_quantity#6351,cval_lineitem_l_extendedprice#6352,cval_lineitem_l_discount#6353,cval_lineitem_l_tax#6354,cval_lineitem_l_returnflag#6355,cval_lineitem_l_linestatus#6356,cval_lineitem_l_commitdate#6357,cval_lineitem_l_receiptdate#6358,cval_lineitem_l_shipinstruct#6359,cval_lineitem_l_shipmode#6360,cval_lineitem_l_comment#6361,cval_lineitem_l_shipdate#6362,cl_quantity#6363,cl_extendedprice#6364,cl_discount#6365,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#6242 AS rid_1#6275, cpfk_orders_lineitem#6243 AS cpfk_orders_lineitem_1#6276, cpfk_supplier_lineitem#6244 AS cpfk_supplier_lineitem_1#6277, cfpk_lineitem_supplier#6245 AS cfpk_lineitem_supplier_1#6278, cfpk_lineitem_partsupp#6246 AS cfpk_lineitem_partsupp_1#6279, cpfk_part_lineitem#6247 AS cpfk_part_lineitem_1#6280, cfpk_lineitem_part#6248 AS cfpk_lineitem_part_1#6281, cpfk_partsupp_lineitem#6249 AS cpfk_partsupp_lineitem_1#6282, cfpk_lineitem_orders#6250 AS cfpk_lineitem_orders_1#6283, cval_lineitem_l_quantity#6251 AS cval_lineitem_l_quantity_1#6284, cval_lineitem_l_extendedprice#6252 AS cval_lineitem_l_extendedprice_1#6285, cval_lineitem_l_discount#6253 AS cval_lineitem_l_discount_1#6286, cval_lineitem_l_tax#6254 AS cval_lineitem_l_tax_1#6287, cval_lineitem_l_returnflag#6255 AS cval_lineitem_l_returnflag_1#6288, cval_lineitem_l_linestatus#6256 AS cval_lineitem_l_linestatus_1#6289, cval_lineitem_l_commitdate#6257 AS cval_lineitem_l_commitdate_1#6290, cval_lineitem_l_receiptdate#6258 AS cval_lineitem_l_receiptdate_1#6291, cval_lineitem_l_shipinstruct#6259 AS cval_lineitem_l_shipinstruct_1#6292, cval_lineitem_l_shipmode#6260 AS cval_lineitem_l_shipmode_1#6293, cval_lineitem_l_comment#6261 AS cval_lineitem_l_comment_1#6294, cval_lineitem_l_shipdate#6262 AS cval_lineitem_l_shipdate_1#6295, cl_quantity#6263 AS cl_quantity_1#6296, cl_extendedprice#6264 AS cl_extendedprice_1#6297, cl_discount#6265 AS cl_discount_1#6298, ... 9 more fields]
            :     :     :     +- Relation[rid#6242,cpfk_orders_lineitem#6243,cpfk_supplier_lineitem#6244,cfpk_lineitem_supplier#6245,cfpk_lineitem_partsupp#6246,cpfk_part_lineitem#6247,cfpk_lineitem_part#6248,cpfk_partsupp_lineitem#6249,cfpk_lineitem_orders#6250,cval_lineitem_l_quantity#6251,cval_lineitem_l_extendedprice#6252,cval_lineitem_l_discount#6253,cval_lineitem_l_tax#6254,cval_lineitem_l_returnflag#6255,cval_lineitem_l_linestatus#6256,cval_lineitem_l_commitdate#6257,cval_lineitem_l_receiptdate#6258,cval_lineitem_l_shipinstruct#6259,cval_lineitem_l_shipmode#6260,cval_lineitem_l_comment#6261,cval_lineitem_l_shipdate#6262,cl_quantity#6263,cl_extendedprice#6264,cl_discount#6265,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#6408 AS rid_2#6421, cpfk_nation_supplier#6409 AS cpfk_nation_supplier_2#6422, cfpk_supplier_nation#6410 AS cfpk_supplier_nation_2#6423, cval_supplier_s_name#6411 AS cval_supplier_s_name_2#6424, cval_supplier_s_address#6412 AS cval_supplier_s_address_2#6425, cval_supplier_s_phone#6413 AS cval_supplier_s_phone_2#6426, cval_supplier_s_acctbal#6414 AS cval_supplier_s_acctbal_2#6427, cval_supplier_s_comment#6415 AS cval_supplier_s_comment_2#6428, cs_name#6416 AS cs_name_2#6429, cs_address#6417 AS cs_address_2#6430, cs_phone#6418 AS cs_phone_2#6431, cs_acctbal#6419 AS cs_acctbal_2#6432, cs_comment#6420 AS cs_comment_2#6433]
            :     :        +- Relation[rid#6408,cpfk_nation_supplier#6409,cfpk_supplier_nation#6410,cval_supplier_s_name#6411,cval_supplier_s_address#6412,cval_supplier_s_phone#6413,cval_supplier_s_acctbal#6414,cval_supplier_s_comment#6415,cs_name#6416,cs_address#6417,cs_phone#6418,cs_acctbal#6419,cs_comment#6420] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#6434 AS rid_3#6441, cpfk_region_nation#6435 AS cpfk_region_nation_3#6442, cfpk_nation_region#6436 AS cfpk_nation_region_3#6443, cval_nation_n_name#6437 AS cval_nation_n_name_3#6444, cval_nation_n_comment#6438 AS cval_nation_n_comment_3#6445, cn_name#6439 AS cn_name_3#6446, cn_comment#6440 AS cn_comment_3#6447]
            :        +- Relation[rid#6434,cpfk_region_nation#6435,cfpk_nation_region#6436,cval_nation_n_name#6437,cval_nation_n_comment#6438,cn_name#6439,cn_comment#6440] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'Join UsingJoin(Inner,List(rid_6))
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#6448 AS rid_4#6453, cval_region_r_name#6449 AS cval_region_r_name_4#6454, cval_region_r_comment#6450 AS cval_region_r_comment_4#6455, cr_name#6451 AS cr_name_4#6456, cr_comment#6452 AS cr_comment_4#6457]
               :  :  :  :  :  :  :  +- Relation[rid#6448,cval_region_r_name#6449,cval_region_r_comment#6450,cr_name#6451,cr_comment#6452] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#6458 AS rid_4#6463, cval_region_r_name#6459 AS cval_region_r_name_4#6464, cval_region_r_comment#6460 AS cval_region_r_comment_4#6465, cr_name#6461 AS cr_name_4#6466, cr_comment#6462 AS cr_comment_4#6467]
               :  :  :  :  :  :        +- Relation[rid#6458,cval_region_r_name#6459,cval_region_r_comment#6460,cr_name#6461,cr_comment#6462] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :     :- Project [rid#6482 AS rid_4#6487, cval_region_r_name#6483 AS cval_region_r_name_4#6488, cval_region_r_comment#6484 AS cval_region_r_comment_4#6489, cr_name#6485 AS cr_name_4#6490, cr_comment#6486 AS cr_comment_4#6491]
               :  :  :  :  :     :  +- Relation[rid#6482,cval_region_r_name#6483,cval_region_r_comment#6484,cr_name#6485,cr_comment#6486] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :     +- Project [rid#6492 AS rid_5#6499, cpfk_region_nation#6493 AS cpfk_region_nation_5#6500, cfpk_nation_region#6494 AS cfpk_nation_region_5#6501, cval_nation_n_name#6495 AS cval_nation_n_name_5#6502, cval_nation_n_comment#6496 AS cval_nation_n_comment_5#6503, cn_name#6497 AS cn_name_5#6504, cn_comment#6498 AS cn_comment_5#6505]
               :  :  :  :  :        +- Relation[rid#6492,cpfk_region_nation#6493,cfpk_nation_region#6494,cval_nation_n_name#6495,cval_nation_n_comment#6496,cn_name#6497,cn_comment#6498] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#6468 AS rid_5#6475, cpfk_region_nation#6469 AS cpfk_region_nation_5#6476, cfpk_nation_region#6470 AS cfpk_nation_region_5#6477, cval_nation_n_name#6471 AS cval_nation_n_name_5#6478, cval_nation_n_comment#6472 AS cval_nation_n_comment_5#6479, cn_name#6473 AS cn_name_5#6480, cn_comment#6474 AS cn_comment_5#6481]
               :  :  :  :     +- Relation[rid#6468,cpfk_region_nation#6469,cfpk_nation_region#6470,cval_nation_n_name#6471,cval_nation_n_comment#6472,cn_name#6473,cn_comment#6474] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :     :- Project [rid#6536 AS rid_5#6543, cpfk_region_nation#6537 AS cpfk_region_nation_5#6544, cfpk_nation_region#6538 AS cfpk_nation_region_5#6545, cval_nation_n_name#6539 AS cval_nation_n_name_5#6546, cval_nation_n_comment#6540 AS cval_nation_n_comment_5#6547, cn_name#6541 AS cn_name_5#6548, cn_comment#6542 AS cn_comment_5#6549]
               :  :  :     :  +- Relation[rid#6536,cpfk_region_nation#6537,cfpk_nation_region#6538,cval_nation_n_name#6539,cval_nation_n_comment#6540,cn_name#6541,cn_comment#6542] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#6550 AS rid_6#6565, cpfk_nation_customer#6551 AS cpfk_nation_customer_6#6566, cfpk_customer_nation#6552 AS cfpk_customer_nation_6#6567, cval_customer_c_name#6553 AS cval_customer_c_name_6#6568, cval_customer_c_address#6554 AS cval_customer_c_address_6#6569, cval_customer_c_phone#6555 AS cval_customer_c_phone_6#6570, cval_customer_c_acctbal#6556 AS cval_customer_c_acctbal_6#6571, cval_customer_c_comment#6557 AS cval_customer_c_comment_6#6572, cval_customer_c_mktsegment#6558 AS cval_customer_c_mktsegment_6#6573, cc_name#6559 AS cc_name_6#6574, cc_address#6560 AS cc_address_6#6575, cc_phone#6561 AS cc_phone_6#6576, cc_acctbal#6562 AS cc_acctbal_6#6577, cc_comment#6563 AS cc_comment_6#6578, cc_mktsegment#6564 AS cc_mktsegment_6#6579]
               :  :  :        +- Relation[rid#6550,cpfk_nation_customer#6551,cfpk_customer_nation#6552,cval_customer_c_name#6553,cval_customer_c_address#6554,cval_customer_c_phone#6555,cval_customer_c_acctbal#6556,cval_customer_c_comment#6557,cval_customer_c_mktsegment#6558,cc_name#6559,cc_address#6560,cc_phone#6561,cc_acctbal#6562,cc_comment#6563,cc_mktsegment#6564] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#6506 AS rid_6#6521, cpfk_nation_customer#6507 AS cpfk_nation_customer_6#6522, cfpk_customer_nation#6508 AS cfpk_customer_nation_6#6523, cval_customer_c_name#6509 AS cval_customer_c_name_6#6524, cval_customer_c_address#6510 AS cval_customer_c_address_6#6525, cval_customer_c_phone#6511 AS cval_customer_c_phone_6#6526, cval_customer_c_acctbal#6512 AS cval_customer_c_acctbal_6#6527, cval_customer_c_comment#6513 AS cval_customer_c_comment_6#6528, cval_customer_c_mktsegment#6514 AS cval_customer_c_mktsegment_6#6529, cc_name#6515 AS cc_name_6#6530, cc_address#6516 AS cc_address_6#6531, cc_phone#6517 AS cc_phone_6#6532, cc_acctbal#6518 AS cc_acctbal_6#6533, cc_comment#6519 AS cc_comment_6#6534, cc_mktsegment#6520 AS cc_mktsegment_6#6535]
               :  :     +- Relation[rid#6506,cpfk_nation_customer#6507,cfpk_customer_nation#6508,cval_customer_c_name#6509,cval_customer_c_address#6510,cval_customer_c_phone#6511,cval_customer_c_acctbal#6512,cval_customer_c_comment#6513,cval_customer_c_mktsegment#6514,cc_name#6515,cc_address#6516,cc_phone#6517,cc_acctbal#6518,cc_comment#6519,cc_mktsegment#6520] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :     :- Project [rid#6614 AS rid_6#6629, cpfk_nation_customer#6615 AS cpfk_nation_customer_6#6630, cfpk_customer_nation#6616 AS cfpk_customer_nation_6#6631, cval_customer_c_name#6617 AS cval_customer_c_name_6#6632, cval_customer_c_address#6618 AS cval_customer_c_address_6#6633, cval_customer_c_phone#6619 AS cval_customer_c_phone_6#6634, cval_customer_c_acctbal#6620 AS cval_customer_c_acctbal_6#6635, cval_customer_c_comment#6621 AS cval_customer_c_comment_6#6636, cval_customer_c_mktsegment#6622 AS cval_customer_c_mktsegment_6#6637, cc_name#6623 AS cc_name_6#6638, cc_address#6624 AS cc_address_6#6639, cc_phone#6625 AS cc_phone_6#6640, cc_acctbal#6626 AS cc_acctbal_6#6641, cc_comment#6627 AS cc_comment_6#6642, cc_mktsegment#6628 AS cc_mktsegment_6#6643]
               :     :  +- Relation[rid#6614,cpfk_nation_customer#6615,cfpk_customer_nation#6616,cval_customer_c_name#6617,cval_customer_c_address#6618,cval_customer_c_phone#6619,cval_customer_c_acctbal#6620,cval_customer_c_comment#6621,cval_customer_c_mktsegment#6622,cc_name#6623,cc_address#6624,cc_phone#6625,cc_acctbal#6626,cc_comment#6627,cc_mktsegment#6628] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#6644 AS rid_7#6661, cpfk_customer_orders#6645 AS cpfk_customer_orders_7#6662, cfpk_orders_customer#6646 AS cfpk_orders_customer_7#6663, cval_orders_o_orderstatus#6647 AS cval_orders_o_orderstatus_7#6664, cval_orders_o_totalprice#6648 AS cval_orders_o_totalprice_7#6665, cval_orders_o_orderpriority#6649 AS cval_orders_o_orderpriority_7#6666, cval_orders_o_clerk#6650 AS cval_orders_o_clerk_7#6667, cval_orders_o_shippriority#6651 AS cval_orders_o_shippriority_7#6668, cval_orders_o_comment#6652 AS cval_orders_o_comment_7#6669, cval_orders_o_orderdate#6653 AS cval_orders_o_orderdate_7#6670, co_orderstatus#6654 AS co_orderstatus_7#6671, co_totalprice#6655 AS co_totalprice_7#6672, co_orderpriority#6656 AS co_orderpriority_7#6673, co_clerk#6657 AS co_clerk_7#6674, co_shippriority#6658 AS co_shippriority_7#6675, co_comment#6659 AS co_comment_7#6676, co_orderdate#6660 AS co_orderdate_7#6677]
               :        +- Relation[rid#6644,cpfk_customer_orders#6645,cfpk_orders_customer#6646,cval_orders_o_orderstatus#6647,cval_orders_o_totalprice#6648,cval_orders_o_orderpriority#6649,cval_orders_o_clerk#6650,cval_orders_o_shippriority#6651,cval_orders_o_comment#6652,cval_orders_o_orderdate#6653,co_orderstatus#6654,co_totalprice#6655,co_orderpriority#6656,co_clerk#6657,co_shippriority#6658,co_comment#6659,co_orderdate#6660] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#6580 AS rid_7#6597, cpfk_customer_orders#6581 AS cpfk_customer_orders_7#6598, cfpk_orders_customer#6582 AS cfpk_orders_customer_7#6599, cval_orders_o_orderstatus#6583 AS cval_orders_o_orderstatus_7#6600, cval_orders_o_totalprice#6584 AS cval_orders_o_totalprice_7#6601, cval_orders_o_orderpriority#6585 AS cval_orders_o_orderpriority_7#6602, cval_orders_o_clerk#6586 AS cval_orders_o_clerk_7#6603, cval_orders_o_shippriority#6587 AS cval_orders_o_shippriority_7#6604, cval_orders_o_comment#6588 AS cval_orders_o_comment_7#6605, cval_orders_o_orderdate#6589 AS cval_orders_o_orderdate_7#6606, co_orderstatus#6590 AS co_orderstatus_7#6607, co_totalprice#6591 AS co_totalprice_7#6608, co_orderpriority#6592 AS co_orderpriority_7#6609, co_clerk#6593 AS co_clerk_7#6610, co_shippriority#6594 AS co_shippriority_7#6611, co_comment#6595 AS co_comment_7#6612, co_orderdate#6596 AS co_orderdate_7#6613]
                  +- Relation[rid#6580,cpfk_customer_orders#6581,cfpk_orders_customer#6582,cval_orders_o_orderstatus#6583,cval_orders_o_totalprice#6584,cval_orders_o_orderpriority#6585,cval_orders_o_clerk#6586,cval_orders_o_shippriority#6587,cval_orders_o_comment#6588,cval_orders_o_orderdate#6589,co_orderstatus#6590,co_totalprice#6591,co_orderpriority#6592,co_clerk#6593,co_shippriority#6594,co_comment#6595,co_orderdate#6596] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 94768ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/11 04:52:54 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:52:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6797L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 04:52:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#6797L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#6799 AS rid_0#6832, cpfk_orders_lineitem#6800 AS cpfk_orders_lineitem_0#6833, cpfk_supplier_lineitem#6801 AS cpfk_supplier_lineitem_0#6834, cfpk_lineitem_supplier#6802 AS cfpk_lineitem_supplier_0#6835, cfpk_lineitem_partsupp#6803 AS cfpk_lineitem_partsupp_0#6836, cpfk_part_lineitem#6804 AS cpfk_part_lineitem_0#6837, cfpk_lineitem_part#6805 AS cfpk_lineitem_part_0#6838, cpfk_partsupp_lineitem#6806 AS cpfk_partsupp_lineitem_0#6839, cfpk_lineitem_orders#6807 AS cfpk_lineitem_orders_0#6840, cval_lineitem_l_quantity#6808 AS cval_lineitem_l_quantity_0#6841, cval_lineitem_l_extendedprice#6809 AS cval_lineitem_l_extendedprice_0#6842, cval_lineitem_l_discount#6810 AS cval_lineitem_l_discount_0#6843, cval_lineitem_l_tax#6811 AS cval_lineitem_l_tax_0#6844, cval_lineitem_l_returnflag#6812 AS cval_lineitem_l_returnflag_0#6845, cval_lineitem_l_linestatus#6813 AS cval_lineitem_l_linestatus_0#6846, cval_lineitem_l_commitdate#6814 AS cval_lineitem_l_commitdate_0#6847, cval_lineitem_l_receiptdate#6815 AS cval_lineitem_l_receiptdate_0#6848, cval_lineitem_l_shipinstruct#6816 AS cval_lineitem_l_shipinstruct_0#6849, cval_lineitem_l_shipmode#6817 AS cval_lineitem_l_shipmode_0#6850, cval_lineitem_l_comment#6818 AS cval_lineitem_l_comment_0#6851, cval_lineitem_l_shipdate#6819 AS cval_lineitem_l_shipdate_0#6852, cl_quantity#6820 AS cl_quantity_0#6853, cl_extendedprice#6821 AS cl_extendedprice_0#6854, cl_discount#6822 AS cl_discount_0#6855, ... 9 more fields]
         +- Relation[rid#6799,cpfk_orders_lineitem#6800,cpfk_supplier_lineitem#6801,cfpk_lineitem_supplier#6802,cfpk_lineitem_partsupp#6803,cpfk_part_lineitem#6804,cfpk_lineitem_part#6805,cpfk_partsupp_lineitem#6806,cfpk_lineitem_orders#6807,cval_lineitem_l_quantity#6808,cval_lineitem_l_extendedprice#6809,cval_lineitem_l_discount#6810,cval_lineitem_l_tax#6811,cval_lineitem_l_returnflag#6812,cval_lineitem_l_linestatus#6813,cval_lineitem_l_commitdate#6814,cval_lineitem_l_receiptdate#6815,cval_lineitem_l_shipinstruct#6816,cval_lineitem_l_shipmode#6817,cval_lineitem_l_comment#6818,cval_lineitem_l_shipdate#6819,cl_quantity#6820,cl_extendedprice#6821,cl_discount#6822,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2940ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/11 04:52:57 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:52:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6907L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 04:52:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6907L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#6909 AS rid_0#6924, cpfk_nation_customer#6910 AS cpfk_nation_customer_0#6925, cfpk_customer_nation#6911 AS cfpk_customer_nation_0#6926, cval_customer_c_name#6912 AS cval_customer_c_name_0#6927, cval_customer_c_address#6913 AS cval_customer_c_address_0#6928, cval_customer_c_phone#6914 AS cval_customer_c_phone_0#6929, cval_customer_c_acctbal#6915 AS cval_customer_c_acctbal_0#6930, cval_customer_c_comment#6916 AS cval_customer_c_comment_0#6931, cval_customer_c_mktsegment#6917 AS cval_customer_c_mktsegment_0#6932, cc_name#6918 AS cc_name_0#6933, cc_address#6919 AS cc_address_0#6934, cc_phone#6920 AS cc_phone_0#6935, cc_acctbal#6921 AS cc_acctbal_0#6936, cc_comment#6922 AS cc_comment_0#6937, cc_mktsegment#6923 AS cc_mktsegment_0#6938]
         :  :  :  :  +- Relation[rid#6909,cpfk_nation_customer#6910,cfpk_customer_nation#6911,cval_customer_c_name#6912,cval_customer_c_address#6913,cval_customer_c_phone#6914,cval_customer_c_acctbal#6915,cval_customer_c_comment#6916,cval_customer_c_mktsegment#6917,cc_name#6918,cc_address#6919,cc_phone#6920,cc_acctbal#6921,cc_comment#6922,cc_mktsegment#6923] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#6973 AS rid_0#6988, cpfk_nation_customer#6974 AS cpfk_nation_customer_0#6989, cfpk_customer_nation#6975 AS cfpk_customer_nation_0#6990, cval_customer_c_name#6976 AS cval_customer_c_name_0#6991, cval_customer_c_address#6977 AS cval_customer_c_address_0#6992, cval_customer_c_phone#6978 AS cval_customer_c_phone_0#6993, cval_customer_c_acctbal#6979 AS cval_customer_c_acctbal_0#6994, cval_customer_c_comment#6980 AS cval_customer_c_comment_0#6995, cval_customer_c_mktsegment#6981 AS cval_customer_c_mktsegment_0#6996, cc_name#6982 AS cc_name_0#6997, cc_address#6983 AS cc_address_0#6998, cc_phone#6984 AS cc_phone_0#6999, cc_acctbal#6985 AS cc_acctbal_0#7000, cc_comment#6986 AS cc_comment_0#7001, cc_mktsegment#6987 AS cc_mktsegment_0#7002]
         :  :  :     :  +- Relation[rid#6973,cpfk_nation_customer#6974,cfpk_customer_nation#6975,cval_customer_c_name#6976,cval_customer_c_address#6977,cval_customer_c_phone#6978,cval_customer_c_acctbal#6979,cval_customer_c_comment#6980,cval_customer_c_mktsegment#6981,cc_name#6982,cc_address#6983,cc_phone#6984,cc_acctbal#6985,cc_comment#6986,cc_mktsegment#6987] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#7003 AS rid_1#7020, cpfk_customer_orders#7004 AS cpfk_customer_orders_1#7021, cfpk_orders_customer#7005 AS cfpk_orders_customer_1#7022, cval_orders_o_orderstatus#7006 AS cval_orders_o_orderstatus_1#7023, cval_orders_o_totalprice#7007 AS cval_orders_o_totalprice_1#7024, cval_orders_o_orderpriority#7008 AS cval_orders_o_orderpriority_1#7025, cval_orders_o_clerk#7009 AS cval_orders_o_clerk_1#7026, cval_orders_o_shippriority#7010 AS cval_orders_o_shippriority_1#7027, cval_orders_o_comment#7011 AS cval_orders_o_comment_1#7028, cval_orders_o_orderdate#7012 AS cval_orders_o_orderdate_1#7029, co_orderstatus#7013 AS co_orderstatus_1#7030, co_totalprice#7014 AS co_totalprice_1#7031, co_orderpriority#7015 AS co_orderpriority_1#7032, co_clerk#7016 AS co_clerk_1#7033, co_shippriority#7017 AS co_shippriority_1#7034, co_comment#7018 AS co_comment_1#7035, co_orderdate#7019 AS co_orderdate_1#7036]
         :  :  :        +- Relation[rid#7003,cpfk_customer_orders#7004,cfpk_orders_customer#7005,cval_orders_o_orderstatus#7006,cval_orders_o_totalprice#7007,cval_orders_o_orderpriority#7008,cval_orders_o_clerk#7009,cval_orders_o_shippriority#7010,cval_orders_o_comment#7011,cval_orders_o_orderdate#7012,co_orderstatus#7013,co_totalprice#7014,co_orderpriority#7015,co_clerk#7016,co_shippriority#7017,co_comment#7018,co_orderdate#7019] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#6939 AS rid_1#6956, cpfk_customer_orders#6940 AS cpfk_customer_orders_1#6957, cfpk_orders_customer#6941 AS cfpk_orders_customer_1#6958, cval_orders_o_orderstatus#6942 AS cval_orders_o_orderstatus_1#6959, cval_orders_o_totalprice#6943 AS cval_orders_o_totalprice_1#6960, cval_orders_o_orderpriority#6944 AS cval_orders_o_orderpriority_1#6961, cval_orders_o_clerk#6945 AS cval_orders_o_clerk_1#6962, cval_orders_o_shippriority#6946 AS cval_orders_o_shippriority_1#6963, cval_orders_o_comment#6947 AS cval_orders_o_comment_1#6964, cval_orders_o_orderdate#6948 AS cval_orders_o_orderdate_1#6965, co_orderstatus#6949 AS co_orderstatus_1#6966, co_totalprice#6950 AS co_totalprice_1#6967, co_orderpriority#6951 AS co_orderpriority_1#6968, co_clerk#6952 AS co_clerk_1#6969, co_shippriority#6953 AS co_shippriority_1#6970, co_comment#6954 AS co_comment_1#6971, co_orderdate#6955 AS co_orderdate_1#6972]
         :  :     +- Relation[rid#6939,cpfk_customer_orders#6940,cfpk_orders_customer#6941,cval_orders_o_orderstatus#6942,cval_orders_o_totalprice#6943,cval_orders_o_orderpriority#6944,cval_orders_o_clerk#6945,cval_orders_o_shippriority#6946,cval_orders_o_comment#6947,cval_orders_o_orderdate#6948,co_orderstatus#6949,co_totalprice#6950,co_orderpriority#6951,co_clerk#6952,co_shippriority#6953,co_comment#6954,co_orderdate#6955] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#7103 AS rid_1#7120, cpfk_customer_orders#7104 AS cpfk_customer_orders_1#7121, cfpk_orders_customer#7105 AS cfpk_orders_customer_1#7122, cval_orders_o_orderstatus#7106 AS cval_orders_o_orderstatus_1#7123, cval_orders_o_totalprice#7107 AS cval_orders_o_totalprice_1#7124, cval_orders_o_orderpriority#7108 AS cval_orders_o_orderpriority_1#7125, cval_orders_o_clerk#7109 AS cval_orders_o_clerk_1#7126, cval_orders_o_shippriority#7110 AS cval_orders_o_shippriority_1#7127, cval_orders_o_comment#7111 AS cval_orders_o_comment_1#7128, cval_orders_o_orderdate#7112 AS cval_orders_o_orderdate_1#7129, co_orderstatus#7113 AS co_orderstatus_1#7130, co_totalprice#7114 AS co_totalprice_1#7131, co_orderpriority#7115 AS co_orderpriority_1#7132, co_clerk#7116 AS co_clerk_1#7133, co_shippriority#7117 AS co_shippriority_1#7134, co_comment#7118 AS co_comment_1#7135, co_orderdate#7119 AS co_orderdate_1#7136]
         :     :  +- Relation[rid#7103,cpfk_customer_orders#7104,cfpk_orders_customer#7105,cval_orders_o_orderstatus#7106,cval_orders_o_totalprice#7107,cval_orders_o_orderpriority#7108,cval_orders_o_clerk#7109,cval_orders_o_shippriority#7110,cval_orders_o_comment#7111,cval_orders_o_orderdate#7112,co_orderstatus#7113,co_totalprice#7114,co_orderpriority#7115,co_clerk#7116,co_shippriority#7117,co_comment#7118,co_orderdate#7119] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#7137 AS rid_2#7170, cpfk_orders_lineitem#7138 AS cpfk_orders_lineitem_2#7171, cpfk_supplier_lineitem#7139 AS cpfk_supplier_lineitem_2#7172, cfpk_lineitem_supplier#7140 AS cfpk_lineitem_supplier_2#7173, cfpk_lineitem_partsupp#7141 AS cfpk_lineitem_partsupp_2#7174, cpfk_part_lineitem#7142 AS cpfk_part_lineitem_2#7175, cfpk_lineitem_part#7143 AS cfpk_lineitem_part_2#7176, cpfk_partsupp_lineitem#7144 AS cpfk_partsupp_lineitem_2#7177, cfpk_lineitem_orders#7145 AS cfpk_lineitem_orders_2#7178, cval_lineitem_l_quantity#7146 AS cval_lineitem_l_quantity_2#7179, cval_lineitem_l_extendedprice#7147 AS cval_lineitem_l_extendedprice_2#7180, cval_lineitem_l_discount#7148 AS cval_lineitem_l_discount_2#7181, cval_lineitem_l_tax#7149 AS cval_lineitem_l_tax_2#7182, cval_lineitem_l_returnflag#7150 AS cval_lineitem_l_returnflag_2#7183, cval_lineitem_l_linestatus#7151 AS cval_lineitem_l_linestatus_2#7184, cval_lineitem_l_commitdate#7152 AS cval_lineitem_l_commitdate_2#7185, cval_lineitem_l_receiptdate#7153 AS cval_lineitem_l_receiptdate_2#7186, cval_lineitem_l_shipinstruct#7154 AS cval_lineitem_l_shipinstruct_2#7187, cval_lineitem_l_shipmode#7155 AS cval_lineitem_l_shipmode_2#7188, cval_lineitem_l_comment#7156 AS cval_lineitem_l_comment_2#7189, cval_lineitem_l_shipdate#7157 AS cval_lineitem_l_shipdate_2#7190, cl_quantity#7158 AS cl_quantity_2#7191, cl_extendedprice#7159 AS cl_extendedprice_2#7192, cl_discount#7160 AS cl_discount_2#7193, ... 9 more fields]
         :        +- Relation[rid#7137,cpfk_orders_lineitem#7138,cpfk_supplier_lineitem#7139,cfpk_lineitem_supplier#7140,cfpk_lineitem_partsupp#7141,cpfk_part_lineitem#7142,cfpk_lineitem_part#7143,cpfk_partsupp_lineitem#7144,cfpk_lineitem_orders#7145,cval_lineitem_l_quantity#7146,cval_lineitem_l_extendedprice#7147,cval_lineitem_l_discount#7148,cval_lineitem_l_tax#7149,cval_lineitem_l_returnflag#7150,cval_lineitem_l_linestatus#7151,cval_lineitem_l_commitdate#7152,cval_lineitem_l_receiptdate#7153,cval_lineitem_l_shipinstruct#7154,cval_lineitem_l_shipmode#7155,cval_lineitem_l_comment#7156,cval_lineitem_l_shipdate#7157,cl_quantity#7158,cl_extendedprice#7159,cl_discount#7160,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7037 AS rid_2#7070, cpfk_orders_lineitem#7038 AS cpfk_orders_lineitem_2#7071, cpfk_supplier_lineitem#7039 AS cpfk_supplier_lineitem_2#7072, cfpk_lineitem_supplier#7040 AS cfpk_lineitem_supplier_2#7073, cfpk_lineitem_partsupp#7041 AS cfpk_lineitem_partsupp_2#7074, cpfk_part_lineitem#7042 AS cpfk_part_lineitem_2#7075, cfpk_lineitem_part#7043 AS cfpk_lineitem_part_2#7076, cpfk_partsupp_lineitem#7044 AS cpfk_partsupp_lineitem_2#7077, cfpk_lineitem_orders#7045 AS cfpk_lineitem_orders_2#7078, cval_lineitem_l_quantity#7046 AS cval_lineitem_l_quantity_2#7079, cval_lineitem_l_extendedprice#7047 AS cval_lineitem_l_extendedprice_2#7080, cval_lineitem_l_discount#7048 AS cval_lineitem_l_discount_2#7081, cval_lineitem_l_tax#7049 AS cval_lineitem_l_tax_2#7082, cval_lineitem_l_returnflag#7050 AS cval_lineitem_l_returnflag_2#7083, cval_lineitem_l_linestatus#7051 AS cval_lineitem_l_linestatus_2#7084, cval_lineitem_l_commitdate#7052 AS cval_lineitem_l_commitdate_2#7085, cval_lineitem_l_receiptdate#7053 AS cval_lineitem_l_receiptdate_2#7086, cval_lineitem_l_shipinstruct#7054 AS cval_lineitem_l_shipinstruct_2#7087, cval_lineitem_l_shipmode#7055 AS cval_lineitem_l_shipmode_2#7088, cval_lineitem_l_comment#7056 AS cval_lineitem_l_comment_2#7089, cval_lineitem_l_shipdate#7057 AS cval_lineitem_l_shipdate_2#7090, cl_quantity#7058 AS cl_quantity_2#7091, cl_extendedprice#7059 AS cl_extendedprice_2#7092, cl_discount#7060 AS cl_discount_2#7093, ... 9 more fields]
            +- Relation[rid#7037,cpfk_orders_lineitem#7038,cpfk_supplier_lineitem#7039,cfpk_lineitem_supplier#7040,cfpk_lineitem_partsupp#7041,cpfk_part_lineitem#7042,cfpk_lineitem_part#7043,cpfk_partsupp_lineitem#7044,cfpk_lineitem_orders#7045,cval_lineitem_l_quantity#7046,cval_lineitem_l_extendedprice#7047,cval_lineitem_l_discount#7048,cval_lineitem_l_tax#7049,cval_lineitem_l_returnflag#7050,cval_lineitem_l_linestatus#7051,cval_lineitem_l_commitdate#7052,cval_lineitem_l_receiptdate#7053,cval_lineitem_l_shipinstruct#7054,cval_lineitem_l_shipmode#7055,cval_lineitem_l_comment#7056,cval_lineitem_l_shipdate#7057,cl_quantity#7058,cl_extendedprice#7059,cl_discount#7060,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 118128ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/11 04:54:56 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:54:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7273L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 04:54:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7273L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#7275 AS rid_0#7292, cpfk_customer_orders#7276 AS cpfk_customer_orders_0#7293, cfpk_orders_customer#7277 AS cfpk_orders_customer_0#7294, cval_orders_o_orderstatus#7278 AS cval_orders_o_orderstatus_0#7295, cval_orders_o_totalprice#7279 AS cval_orders_o_totalprice_0#7296, cval_orders_o_orderpriority#7280 AS cval_orders_o_orderpriority_0#7297, cval_orders_o_clerk#7281 AS cval_orders_o_clerk_0#7298, cval_orders_o_shippriority#7282 AS cval_orders_o_shippriority_0#7299, cval_orders_o_comment#7283 AS cval_orders_o_comment_0#7300, cval_orders_o_orderdate#7284 AS cval_orders_o_orderdate_0#7301, co_orderstatus#7285 AS co_orderstatus_0#7302, co_totalprice#7286 AS co_totalprice_0#7303, co_orderpriority#7287 AS co_orderpriority_0#7304, co_clerk#7288 AS co_clerk_0#7305, co_shippriority#7289 AS co_shippriority_0#7306, co_comment#7290 AS co_comment_0#7307, co_orderdate#7291 AS co_orderdate_0#7308]
            :  +- Relation[rid#7275,cpfk_customer_orders#7276,cfpk_orders_customer#7277,cval_orders_o_orderstatus#7278,cval_orders_o_totalprice#7279,cval_orders_o_orderpriority#7280,cval_orders_o_clerk#7281,cval_orders_o_shippriority#7282,cval_orders_o_comment#7283,cval_orders_o_orderdate#7284,co_orderstatus#7285,co_totalprice#7286,co_orderpriority#7287,co_clerk#7288,co_shippriority#7289,co_comment#7290,co_orderdate#7291] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#7309 AS rid_1#7324, cpfk_nation_customer#7310 AS cpfk_nation_customer_1#7325, cfpk_customer_nation#7311 AS cfpk_customer_nation_1#7326, cval_customer_c_name#7312 AS cval_customer_c_name_1#7327, cval_customer_c_address#7313 AS cval_customer_c_address_1#7328, cval_customer_c_phone#7314 AS cval_customer_c_phone_1#7329, cval_customer_c_acctbal#7315 AS cval_customer_c_acctbal_1#7330, cval_customer_c_comment#7316 AS cval_customer_c_comment_1#7331, cval_customer_c_mktsegment#7317 AS cval_customer_c_mktsegment_1#7332, cc_name#7318 AS cc_name_1#7333, cc_address#7319 AS cc_address_1#7334, cc_phone#7320 AS cc_phone_1#7335, cc_acctbal#7321 AS cc_acctbal_1#7336, cc_comment#7322 AS cc_comment_1#7337, cc_mktsegment#7323 AS cc_mktsegment_1#7338]
               +- Relation[rid#7309,cpfk_nation_customer#7310,cfpk_customer_nation#7311,cval_customer_c_name#7312,cval_customer_c_address#7313,cval_customer_c_phone#7314,cval_customer_c_acctbal#7315,cval_customer_c_comment#7316,cval_customer_c_mktsegment#7317,cc_name#7318,cc_address#7319,cc_phone#7320,cc_acctbal#7321,cc_comment#7322,cc_mktsegment#7323] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 12711ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 04:55:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:55:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7380L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 04:55:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:55:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:55:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:55:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:55:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:55:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:55:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:55:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 04:55:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:55:08 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 04:55:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7380L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#7382 AS rid_0#7389, cpfk_region_nation#7383 AS cpfk_region_nation_0#7390, cfpk_nation_region#7384 AS cfpk_nation_region_0#7391, cval_nation_n_name#7385 AS cval_nation_n_name_0#7392, cval_nation_n_comment#7386 AS cval_nation_n_comment_0#7393, cn_name#7387 AS cn_name_0#7394, cn_comment#7388 AS cn_comment_0#7395]
            :     :     :  :  :  :  :  +- Relation[rid#7382,cpfk_region_nation#7383,cfpk_nation_region#7384,cval_nation_n_name#7385,cval_nation_n_comment#7386,cn_name#7387,cn_comment#7388] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#7422 AS rid_0#7429, cpfk_region_nation#7423 AS cpfk_region_nation_0#7430, cfpk_nation_region#7424 AS cfpk_nation_region_0#7431, cval_nation_n_name#7425 AS cval_nation_n_name_0#7432, cval_nation_n_comment#7426 AS cval_nation_n_comment_0#7433, cn_name#7427 AS cn_name_0#7434, cn_comment#7428 AS cn_comment_0#7435]
            :     :     :  :  :  :     :  +- Relation[rid#7422,cpfk_region_nation#7423,cfpk_nation_region#7424,cval_nation_n_name#7425,cval_nation_n_comment#7426,cn_name#7427,cn_comment#7428] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#7436 AS rid_1#7449, cpfk_nation_supplier#7437 AS cpfk_nation_supplier_1#7450, cfpk_supplier_nation#7438 AS cfpk_supplier_nation_1#7451, cval_supplier_s_name#7439 AS cval_supplier_s_name_1#7452, cval_supplier_s_address#7440 AS cval_supplier_s_address_1#7453, cval_supplier_s_phone#7441 AS cval_supplier_s_phone_1#7454, cval_supplier_s_acctbal#7442 AS cval_supplier_s_acctbal_1#7455, cval_supplier_s_comment#7443 AS cval_supplier_s_comment_1#7456, cs_name#7444 AS cs_name_1#7457, cs_address#7445 AS cs_address_1#7458, cs_phone#7446 AS cs_phone_1#7459, cs_acctbal#7447 AS cs_acctbal_1#7460, cs_comment#7448 AS cs_comment_1#7461]
            :     :     :  :  :  :        +- Relation[rid#7436,cpfk_nation_supplier#7437,cfpk_supplier_nation#7438,cval_supplier_s_name#7439,cval_supplier_s_address#7440,cval_supplier_s_phone#7441,cval_supplier_s_acctbal#7442,cval_supplier_s_comment#7443,cs_name#7444,cs_address#7445,cs_phone#7446,cs_acctbal#7447,cs_comment#7448] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#7396 AS rid_1#7409, cpfk_nation_supplier#7397 AS cpfk_nation_supplier_1#7410, cfpk_supplier_nation#7398 AS cfpk_supplier_nation_1#7411, cval_supplier_s_name#7399 AS cval_supplier_s_name_1#7412, cval_supplier_s_address#7400 AS cval_supplier_s_address_1#7413, cval_supplier_s_phone#7401 AS cval_supplier_s_phone_1#7414, cval_supplier_s_acctbal#7402 AS cval_supplier_s_acctbal_1#7415, cval_supplier_s_comment#7403 AS cval_supplier_s_comment_1#7416, cs_name#7404 AS cs_name_1#7417, cs_address#7405 AS cs_address_1#7418, cs_phone#7406 AS cs_phone_1#7419, cs_acctbal#7407 AS cs_acctbal_1#7420, cs_comment#7408 AS cs_comment_1#7421]
            :     :     :  :  :     +- Relation[rid#7396,cpfk_nation_supplier#7397,cfpk_supplier_nation#7398,cval_supplier_s_name#7399,cval_supplier_s_address#7400,cval_supplier_s_phone#7401,cval_supplier_s_acctbal#7402,cval_supplier_s_comment#7403,cs_name#7404,cs_address#7405,cs_phone#7406,cs_acctbal#7407,cs_comment#7408] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#7528 AS rid_1#7541, cpfk_nation_supplier#7529 AS cpfk_nation_supplier_1#7542, cfpk_supplier_nation#7530 AS cfpk_supplier_nation_1#7543, cval_supplier_s_name#7531 AS cval_supplier_s_name_1#7544, cval_supplier_s_address#7532 AS cval_supplier_s_address_1#7545, cval_supplier_s_phone#7533 AS cval_supplier_s_phone_1#7546, cval_supplier_s_acctbal#7534 AS cval_supplier_s_acctbal_1#7547, cval_supplier_s_comment#7535 AS cval_supplier_s_comment_1#7548, cs_name#7536 AS cs_name_1#7549, cs_address#7537 AS cs_address_1#7550, cs_phone#7538 AS cs_phone_1#7551, cs_acctbal#7539 AS cs_acctbal_1#7552, cs_comment#7540 AS cs_comment_1#7553]
            :     :     :  :     :  +- Relation[rid#7528,cpfk_nation_supplier#7529,cfpk_supplier_nation#7530,cval_supplier_s_name#7531,cval_supplier_s_address#7532,cval_supplier_s_phone#7533,cval_supplier_s_acctbal#7534,cval_supplier_s_comment#7535,cs_name#7536,cs_address#7537,cs_phone#7538,cs_acctbal#7539,cs_comment#7540] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#7554 AS rid_2#7587, cpfk_orders_lineitem#7555 AS cpfk_orders_lineitem_2#7588, cpfk_supplier_lineitem#7556 AS cpfk_supplier_lineitem_2#7589, cfpk_lineitem_supplier#7557 AS cfpk_lineitem_supplier_2#7590, cfpk_lineitem_partsupp#7558 AS cfpk_lineitem_partsupp_2#7591, cpfk_part_lineitem#7559 AS cpfk_part_lineitem_2#7592, cfpk_lineitem_part#7560 AS cfpk_lineitem_part_2#7593, cpfk_partsupp_lineitem#7561 AS cpfk_partsupp_lineitem_2#7594, cfpk_lineitem_orders#7562 AS cfpk_lineitem_orders_2#7595, cval_lineitem_l_quantity#7563 AS cval_lineitem_l_quantity_2#7596, cval_lineitem_l_extendedprice#7564 AS cval_lineitem_l_extendedprice_2#7597, cval_lineitem_l_discount#7565 AS cval_lineitem_l_discount_2#7598, cval_lineitem_l_tax#7566 AS cval_lineitem_l_tax_2#7599, cval_lineitem_l_returnflag#7567 AS cval_lineitem_l_returnflag_2#7600, cval_lineitem_l_linestatus#7568 AS cval_lineitem_l_linestatus_2#7601, cval_lineitem_l_commitdate#7569 AS cval_lineitem_l_commitdate_2#7602, cval_lineitem_l_receiptdate#7570 AS cval_lineitem_l_receiptdate_2#7603, cval_lineitem_l_shipinstruct#7571 AS cval_lineitem_l_shipinstruct_2#7604, cval_lineitem_l_shipmode#7572 AS cval_lineitem_l_shipmode_2#7605, cval_lineitem_l_comment#7573 AS cval_lineitem_l_comment_2#7606, cval_lineitem_l_shipdate#7574 AS cval_lineitem_l_shipdate_2#7607, cl_quantity#7575 AS cl_quantity_2#7608, cl_extendedprice#7576 AS cl_extendedprice_2#7609, cl_discount#7577 AS cl_discount_2#7610, ... 9 more fields]
            :     :     :  :        +- Relation[rid#7554,cpfk_orders_lineitem#7555,cpfk_supplier_lineitem#7556,cfpk_lineitem_supplier#7557,cfpk_lineitem_partsupp#7558,cpfk_part_lineitem#7559,cfpk_lineitem_part#7560,cpfk_partsupp_lineitem#7561,cfpk_lineitem_orders#7562,cval_lineitem_l_quantity#7563,cval_lineitem_l_extendedprice#7564,cval_lineitem_l_discount#7565,cval_lineitem_l_tax#7566,cval_lineitem_l_returnflag#7567,cval_lineitem_l_linestatus#7568,cval_lineitem_l_commitdate#7569,cval_lineitem_l_receiptdate#7570,cval_lineitem_l_shipinstruct#7571,cval_lineitem_l_shipmode#7572,cval_lineitem_l_comment#7573,cval_lineitem_l_shipdate#7574,cl_quantity#7575,cl_extendedprice#7576,cl_discount#7577,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#7462 AS rid_2#7495, cpfk_orders_lineitem#7463 AS cpfk_orders_lineitem_2#7496, cpfk_supplier_lineitem#7464 AS cpfk_supplier_lineitem_2#7497, cfpk_lineitem_supplier#7465 AS cfpk_lineitem_supplier_2#7498, cfpk_lineitem_partsupp#7466 AS cfpk_lineitem_partsupp_2#7499, cpfk_part_lineitem#7467 AS cpfk_part_lineitem_2#7500, cfpk_lineitem_part#7468 AS cfpk_lineitem_part_2#7501, cpfk_partsupp_lineitem#7469 AS cpfk_partsupp_lineitem_2#7502, cfpk_lineitem_orders#7470 AS cfpk_lineitem_orders_2#7503, cval_lineitem_l_quantity#7471 AS cval_lineitem_l_quantity_2#7504, cval_lineitem_l_extendedprice#7472 AS cval_lineitem_l_extendedprice_2#7505, cval_lineitem_l_discount#7473 AS cval_lineitem_l_discount_2#7506, cval_lineitem_l_tax#7474 AS cval_lineitem_l_tax_2#7507, cval_lineitem_l_returnflag#7475 AS cval_lineitem_l_returnflag_2#7508, cval_lineitem_l_linestatus#7476 AS cval_lineitem_l_linestatus_2#7509, cval_lineitem_l_commitdate#7477 AS cval_lineitem_l_commitdate_2#7510, cval_lineitem_l_receiptdate#7478 AS cval_lineitem_l_receiptdate_2#7511, cval_lineitem_l_shipinstruct#7479 AS cval_lineitem_l_shipinstruct_2#7512, cval_lineitem_l_shipmode#7480 AS cval_lineitem_l_shipmode_2#7513, cval_lineitem_l_comment#7481 AS cval_lineitem_l_comment_2#7514, cval_lineitem_l_shipdate#7482 AS cval_lineitem_l_shipdate_2#7515, cl_quantity#7483 AS cl_quantity_2#7516, cl_extendedprice#7484 AS cl_extendedprice_2#7517, cl_discount#7485 AS cl_discount_2#7518, ... 9 more fields]
            :     :     :     +- Relation[rid#7462,cpfk_orders_lineitem#7463,cpfk_supplier_lineitem#7464,cfpk_lineitem_supplier#7465,cfpk_lineitem_partsupp#7466,cpfk_part_lineitem#7467,cfpk_lineitem_part#7468,cpfk_partsupp_lineitem#7469,cfpk_lineitem_orders#7470,cval_lineitem_l_quantity#7471,cval_lineitem_l_extendedprice#7472,cval_lineitem_l_discount#7473,cval_lineitem_l_tax#7474,cval_lineitem_l_returnflag#7475,cval_lineitem_l_linestatus#7476,cval_lineitem_l_commitdate#7477,cval_lineitem_l_receiptdate#7478,cval_lineitem_l_shipinstruct#7479,cval_lineitem_l_shipmode#7480,cval_lineitem_l_comment#7481,cval_lineitem_l_shipdate#7482,cl_quantity#7483,cl_extendedprice#7484,cl_discount#7485,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#7620 AS rid_3#7637, cval_part_p_name#7621 AS cval_part_p_name_3#7638, cval_part_p_mfgr#7622 AS cval_part_p_mfgr_3#7639, cval_part_p_type#7623 AS cval_part_p_type_3#7640, cval_part_p_size#7624 AS cval_part_p_size_3#7641, cval_part_p_container#7625 AS cval_part_p_container_3#7642, cval_part_p_retailprice#7626 AS cval_part_p_retailprice_3#7643, cval_part_p_comment#7627 AS cval_part_p_comment_3#7644, cval_part_p_brand#7628 AS cval_part_p_brand_3#7645, cp_name#7629 AS cp_name_3#7646, cp_mfgr#7630 AS cp_mfgr_3#7647, cp_type#7631 AS cp_type_3#7648, cp_size#7632 AS cp_size_3#7649, cp_container#7633 AS cp_container_3#7650, cp_retailprice#7634 AS cp_retailprice_3#7651, cp_comment#7635 AS cp_comment_3#7652, cp_brand#7636 AS cp_brand_3#7653]
            :     :        +- Relation[rid#7620,cval_part_p_name#7621,cval_part_p_mfgr#7622,cval_part_p_type#7623,cval_part_p_size#7624,cval_part_p_container#7625,cval_part_p_retailprice#7626,cval_part_p_comment#7627,cval_part_p_brand#7628,cp_name#7629,cp_mfgr#7630,cp_type#7631,cp_size#7632,cp_container#7633,cp_retailprice#7634,cp_comment#7635,cp_brand#7636] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#7654 AS rid_4#7665, cpfk_part_partsupp#7655 AS cpfk_part_partsupp_4#7666, cfpk_partsupp_part#7656 AS cfpk_partsupp_part_4#7667, cpfk_supplier_partsupp#7657 AS cpfk_supplier_partsupp_4#7668, cfpk_partsupp_supplier#7658 AS cfpk_partsupp_supplier_4#7669, cval_partsupp_ps_availqty#7659 AS cval_partsupp_ps_availqty_4#7670, cval_partsupp_ps_supplycost#7660 AS cval_partsupp_ps_supplycost_4#7671, cval_partsupp_ps_comment#7661 AS cval_partsupp_ps_comment_4#7672, cps_availqty#7662 AS cps_availqty_4#7673, cps_supplycost#7663 AS cps_supplycost_4#7674, cps_comment#7664 AS cps_comment_4#7675]
            :        +- Relation[rid#7654,cpfk_part_partsupp#7655,cfpk_partsupp_part#7656,cpfk_supplier_partsupp#7657,cfpk_partsupp_supplier#7658,cval_partsupp_ps_availqty#7659,cval_partsupp_ps_supplycost#7660,cval_partsupp_ps_comment#7661,cps_availqty#7662,cps_supplycost#7663,cps_comment#7664] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#7676 AS rid_5#7693, cpfk_customer_orders#7677 AS cpfk_customer_orders_5#7694, cfpk_orders_customer#7678 AS cfpk_orders_customer_5#7695, cval_orders_o_orderstatus#7679 AS cval_orders_o_orderstatus_5#7696, cval_orders_o_totalprice#7680 AS cval_orders_o_totalprice_5#7697, cval_orders_o_orderpriority#7681 AS cval_orders_o_orderpriority_5#7698, cval_orders_o_clerk#7682 AS cval_orders_o_clerk_5#7699, cval_orders_o_shippriority#7683 AS cval_orders_o_shippriority_5#7700, cval_orders_o_comment#7684 AS cval_orders_o_comment_5#7701, cval_orders_o_orderdate#7685 AS cval_orders_o_orderdate_5#7702, co_orderstatus#7686 AS co_orderstatus_5#7703, co_totalprice#7687 AS co_totalprice_5#7704, co_orderpriority#7688 AS co_orderpriority_5#7705, co_clerk#7689 AS co_clerk_5#7706, co_shippriority#7690 AS co_shippriority_5#7707, co_comment#7691 AS co_comment_5#7708, co_orderdate#7692 AS co_orderdate_5#7709]
               +- Relation[rid#7676,cpfk_customer_orders#7677,cfpk_orders_customer#7678,cval_orders_o_orderstatus#7679,cval_orders_o_totalprice#7680,cval_orders_o_orderpriority#7681,cval_orders_o_clerk#7682,cval_orders_o_shippriority#7683,cval_orders_o_comment#7684,cval_orders_o_orderdate#7685,co_orderstatus#7686,co_totalprice#7687,co_orderpriority#7688,co_clerk#7689,co_shippriority#7690,co_comment#7691,co_orderdate#7692] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 244310ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/11 04:59:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 04:59:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7820L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 04:59:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:59:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 04:59:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7820L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#7822 AS rid_0#7855, cpfk_orders_lineitem#7823 AS cpfk_orders_lineitem_0#7856, cpfk_supplier_lineitem#7824 AS cpfk_supplier_lineitem_0#7857, cfpk_lineitem_supplier#7825 AS cfpk_lineitem_supplier_0#7858, cfpk_lineitem_partsupp#7826 AS cfpk_lineitem_partsupp_0#7859, cpfk_part_lineitem#7827 AS cpfk_part_lineitem_0#7860, cfpk_lineitem_part#7828 AS cfpk_lineitem_part_0#7861, cpfk_partsupp_lineitem#7829 AS cpfk_partsupp_lineitem_0#7862, cfpk_lineitem_orders#7830 AS cfpk_lineitem_orders_0#7863, cval_lineitem_l_quantity#7831 AS cval_lineitem_l_quantity_0#7864, cval_lineitem_l_extendedprice#7832 AS cval_lineitem_l_extendedprice_0#7865, cval_lineitem_l_discount#7833 AS cval_lineitem_l_discount_0#7866, cval_lineitem_l_tax#7834 AS cval_lineitem_l_tax_0#7867, cval_lineitem_l_returnflag#7835 AS cval_lineitem_l_returnflag_0#7868, cval_lineitem_l_linestatus#7836 AS cval_lineitem_l_linestatus_0#7869, cval_lineitem_l_commitdate#7837 AS cval_lineitem_l_commitdate_0#7870, cval_lineitem_l_receiptdate#7838 AS cval_lineitem_l_receiptdate_0#7871, cval_lineitem_l_shipinstruct#7839 AS cval_lineitem_l_shipinstruct_0#7872, cval_lineitem_l_shipmode#7840 AS cval_lineitem_l_shipmode_0#7873, cval_lineitem_l_comment#7841 AS cval_lineitem_l_comment_0#7874, cval_lineitem_l_shipdate#7842 AS cval_lineitem_l_shipdate_0#7875, cl_quantity#7843 AS cl_quantity_0#7876, cl_extendedprice#7844 AS cl_extendedprice_0#7877, cl_discount#7845 AS cl_discount_0#7878, ... 9 more fields]
            :     :     :  :  +- Relation[rid#7822,cpfk_orders_lineitem#7823,cpfk_supplier_lineitem#7824,cfpk_lineitem_supplier#7825,cfpk_lineitem_partsupp#7826,cpfk_part_lineitem#7827,cfpk_lineitem_part#7828,cpfk_partsupp_lineitem#7829,cfpk_lineitem_orders#7830,cval_lineitem_l_quantity#7831,cval_lineitem_l_extendedprice#7832,cval_lineitem_l_discount#7833,cval_lineitem_l_tax#7834,cval_lineitem_l_returnflag#7835,cval_lineitem_l_linestatus#7836,cval_lineitem_l_commitdate#7837,cval_lineitem_l_receiptdate#7838,cval_lineitem_l_shipinstruct#7839,cval_lineitem_l_shipmode#7840,cval_lineitem_l_comment#7841,cval_lineitem_l_shipdate#7842,cl_quantity#7843,cl_extendedprice#7844,cl_discount#7845,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#7888 AS rid_0#7921, cpfk_orders_lineitem#7889 AS cpfk_orders_lineitem_0#7922, cpfk_supplier_lineitem#7890 AS cpfk_supplier_lineitem_0#7923, cfpk_lineitem_supplier#7891 AS cfpk_lineitem_supplier_0#7924, cfpk_lineitem_partsupp#7892 AS cfpk_lineitem_partsupp_0#7925, cpfk_part_lineitem#7893 AS cpfk_part_lineitem_0#7926, cfpk_lineitem_part#7894 AS cfpk_lineitem_part_0#7927, cpfk_partsupp_lineitem#7895 AS cpfk_partsupp_lineitem_0#7928, cfpk_lineitem_orders#7896 AS cfpk_lineitem_orders_0#7929, cval_lineitem_l_quantity#7897 AS cval_lineitem_l_quantity_0#7930, cval_lineitem_l_extendedprice#7898 AS cval_lineitem_l_extendedprice_0#7931, cval_lineitem_l_discount#7899 AS cval_lineitem_l_discount_0#7932, cval_lineitem_l_tax#7900 AS cval_lineitem_l_tax_0#7933, cval_lineitem_l_returnflag#7901 AS cval_lineitem_l_returnflag_0#7934, cval_lineitem_l_linestatus#7902 AS cval_lineitem_l_linestatus_0#7935, cval_lineitem_l_commitdate#7903 AS cval_lineitem_l_commitdate_0#7936, cval_lineitem_l_receiptdate#7904 AS cval_lineitem_l_receiptdate_0#7937, cval_lineitem_l_shipinstruct#7905 AS cval_lineitem_l_shipinstruct_0#7938, cval_lineitem_l_shipmode#7906 AS cval_lineitem_l_shipmode_0#7939, cval_lineitem_l_comment#7907 AS cval_lineitem_l_comment_0#7940, cval_lineitem_l_shipdate#7908 AS cval_lineitem_l_shipdate_0#7941, cl_quantity#7909 AS cl_quantity_0#7942, cl_extendedprice#7910 AS cl_extendedprice_0#7943, cl_discount#7911 AS cl_discount_0#7944, ... 9 more fields]
            :     :     :        +- Relation[rid#7888,cpfk_orders_lineitem#7889,cpfk_supplier_lineitem#7890,cfpk_lineitem_supplier#7891,cfpk_lineitem_partsupp#7892,cpfk_part_lineitem#7893,cfpk_lineitem_part#7894,cpfk_partsupp_lineitem#7895,cfpk_lineitem_orders#7896,cval_lineitem_l_quantity#7897,cval_lineitem_l_extendedprice#7898,cval_lineitem_l_discount#7899,cval_lineitem_l_tax#7900,cval_lineitem_l_returnflag#7901,cval_lineitem_l_linestatus#7902,cval_lineitem_l_commitdate#7903,cval_lineitem_l_receiptdate#7904,cval_lineitem_l_shipinstruct#7905,cval_lineitem_l_shipmode#7906,cval_lineitem_l_comment#7907,cval_lineitem_l_shipdate#7908,cl_quantity#7909,cl_extendedprice#7910,cl_discount#7911,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#7954 AS rid_1#7971, cpfk_customer_orders#7955 AS cpfk_customer_orders_1#7972, cfpk_orders_customer#7956 AS cfpk_orders_customer_1#7973, cval_orders_o_orderstatus#7957 AS cval_orders_o_orderstatus_1#7974, cval_orders_o_totalprice#7958 AS cval_orders_o_totalprice_1#7975, cval_orders_o_orderpriority#7959 AS cval_orders_o_orderpriority_1#7976, cval_orders_o_clerk#7960 AS cval_orders_o_clerk_1#7977, cval_orders_o_shippriority#7961 AS cval_orders_o_shippriority_1#7978, cval_orders_o_comment#7962 AS cval_orders_o_comment_1#7979, cval_orders_o_orderdate#7963 AS cval_orders_o_orderdate_1#7980, co_orderstatus#7964 AS co_orderstatus_1#7981, co_totalprice#7965 AS co_totalprice_1#7982, co_orderpriority#7966 AS co_orderpriority_1#7983, co_clerk#7967 AS co_clerk_1#7984, co_shippriority#7968 AS co_shippriority_1#7985, co_comment#7969 AS co_comment_1#7986, co_orderdate#7970 AS co_orderdate_1#7987]
            :     :        +- Relation[rid#7954,cpfk_customer_orders#7955,cfpk_orders_customer#7956,cval_orders_o_orderstatus#7957,cval_orders_o_totalprice#7958,cval_orders_o_orderpriority#7959,cval_orders_o_clerk#7960,cval_orders_o_shippriority#7961,cval_orders_o_comment#7962,cval_orders_o_orderdate#7963,co_orderstatus#7964,co_totalprice#7965,co_orderpriority#7966,co_clerk#7967,co_shippriority#7968,co_comment#7969,co_orderdate#7970] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#7988 AS rid_2#8003, cpfk_nation_customer#7989 AS cpfk_nation_customer_2#8004, cfpk_customer_nation#7990 AS cfpk_customer_nation_2#8005, cval_customer_c_name#7991 AS cval_customer_c_name_2#8006, cval_customer_c_address#7992 AS cval_customer_c_address_2#8007, cval_customer_c_phone#7993 AS cval_customer_c_phone_2#8008, cval_customer_c_acctbal#7994 AS cval_customer_c_acctbal_2#8009, cval_customer_c_comment#7995 AS cval_customer_c_comment_2#8010, cval_customer_c_mktsegment#7996 AS cval_customer_c_mktsegment_2#8011, cc_name#7997 AS cc_name_2#8012, cc_address#7998 AS cc_address_2#8013, cc_phone#7999 AS cc_phone_2#8014, cc_acctbal#8000 AS cc_acctbal_2#8015, cc_comment#8001 AS cc_comment_2#8016, cc_mktsegment#8002 AS cc_mktsegment_2#8017]
            :        +- Relation[rid#7988,cpfk_nation_customer#7989,cfpk_customer_nation#7990,cval_customer_c_name#7991,cval_customer_c_address#7992,cval_customer_c_phone#7993,cval_customer_c_acctbal#7994,cval_customer_c_comment#7995,cval_customer_c_mktsegment#7996,cc_name#7997,cc_address#7998,cc_phone#7999,cc_acctbal#8000,cc_comment#8001,cc_mktsegment#8002] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#8018 AS rid_3#8025, cpfk_region_nation#8019 AS cpfk_region_nation_3#8026, cfpk_nation_region#8020 AS cfpk_nation_region_3#8027, cval_nation_n_name#8021 AS cval_nation_n_name_3#8028, cval_nation_n_comment#8022 AS cval_nation_n_comment_3#8029, cn_name#8023 AS cn_name_3#8030, cn_comment#8024 AS cn_comment_3#8031]
               +- Relation[rid#8018,cpfk_region_nation#8019,cfpk_nation_region#8020,cval_nation_n_name#8021,cval_nation_n_comment#8022,cn_name#8023,cn_comment#8024] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 61495ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/11 05:00:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:00:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8108L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 05:00:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:00:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:00:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:00:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:00:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:00:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:00:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:00:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8108L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#8110 AS rid_0#8143, cpfk_orders_lineitem#8111 AS cpfk_orders_lineitem_0#8144, cpfk_supplier_lineitem#8112 AS cpfk_supplier_lineitem_0#8145, cfpk_lineitem_supplier#8113 AS cfpk_lineitem_supplier_0#8146, cfpk_lineitem_partsupp#8114 AS cfpk_lineitem_partsupp_0#8147, cpfk_part_lineitem#8115 AS cpfk_part_lineitem_0#8148, cfpk_lineitem_part#8116 AS cfpk_lineitem_part_0#8149, cpfk_partsupp_lineitem#8117 AS cpfk_partsupp_lineitem_0#8150, cfpk_lineitem_orders#8118 AS cfpk_lineitem_orders_0#8151, cval_lineitem_l_quantity#8119 AS cval_lineitem_l_quantity_0#8152, cval_lineitem_l_extendedprice#8120 AS cval_lineitem_l_extendedprice_0#8153, cval_lineitem_l_discount#8121 AS cval_lineitem_l_discount_0#8154, cval_lineitem_l_tax#8122 AS cval_lineitem_l_tax_0#8155, cval_lineitem_l_returnflag#8123 AS cval_lineitem_l_returnflag_0#8156, cval_lineitem_l_linestatus#8124 AS cval_lineitem_l_linestatus_0#8157, cval_lineitem_l_commitdate#8125 AS cval_lineitem_l_commitdate_0#8158, cval_lineitem_l_receiptdate#8126 AS cval_lineitem_l_receiptdate_0#8159, cval_lineitem_l_shipinstruct#8127 AS cval_lineitem_l_shipinstruct_0#8160, cval_lineitem_l_shipmode#8128 AS cval_lineitem_l_shipmode_0#8161, cval_lineitem_l_comment#8129 AS cval_lineitem_l_comment_0#8162, cval_lineitem_l_shipdate#8130 AS cval_lineitem_l_shipdate_0#8163, cl_quantity#8131 AS cl_quantity_0#8164, cl_extendedprice#8132 AS cl_extendedprice_0#8165, cl_discount#8133 AS cl_discount_0#8166, ... 9 more fields]
            :  +- Relation[rid#8110,cpfk_orders_lineitem#8111,cpfk_supplier_lineitem#8112,cfpk_lineitem_supplier#8113,cfpk_lineitem_partsupp#8114,cpfk_part_lineitem#8115,cfpk_lineitem_part#8116,cpfk_partsupp_lineitem#8117,cfpk_lineitem_orders#8118,cval_lineitem_l_quantity#8119,cval_lineitem_l_extendedprice#8120,cval_lineitem_l_discount#8121,cval_lineitem_l_tax#8122,cval_lineitem_l_returnflag#8123,cval_lineitem_l_linestatus#8124,cval_lineitem_l_commitdate#8125,cval_lineitem_l_receiptdate#8126,cval_lineitem_l_shipinstruct#8127,cval_lineitem_l_shipmode#8128,cval_lineitem_l_comment#8129,cval_lineitem_l_shipdate#8130,cl_quantity#8131,cl_extendedprice#8132,cl_discount#8133,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#8176 AS rid_1#8193, cpfk_customer_orders#8177 AS cpfk_customer_orders_1#8194, cfpk_orders_customer#8178 AS cfpk_orders_customer_1#8195, cval_orders_o_orderstatus#8179 AS cval_orders_o_orderstatus_1#8196, cval_orders_o_totalprice#8180 AS cval_orders_o_totalprice_1#8197, cval_orders_o_orderpriority#8181 AS cval_orders_o_orderpriority_1#8198, cval_orders_o_clerk#8182 AS cval_orders_o_clerk_1#8199, cval_orders_o_shippriority#8183 AS cval_orders_o_shippriority_1#8200, cval_orders_o_comment#8184 AS cval_orders_o_comment_1#8201, cval_orders_o_orderdate#8185 AS cval_orders_o_orderdate_1#8202, co_orderstatus#8186 AS co_orderstatus_1#8203, co_totalprice#8187 AS co_totalprice_1#8204, co_orderpriority#8188 AS co_orderpriority_1#8205, co_clerk#8189 AS co_clerk_1#8206, co_shippriority#8190 AS co_shippriority_1#8207, co_comment#8191 AS co_comment_1#8208, co_orderdate#8192 AS co_orderdate_1#8209]
                  :     :  :  :  :  +- Relation[rid#8176,cpfk_customer_orders#8177,cfpk_orders_customer#8178,cval_orders_o_orderstatus#8179,cval_orders_o_totalprice#8180,cval_orders_o_orderpriority#8181,cval_orders_o_clerk#8182,cval_orders_o_shippriority#8183,cval_orders_o_comment#8184,cval_orders_o_orderdate#8185,co_orderstatus#8186,co_totalprice#8187,co_orderpriority#8188,co_clerk#8189,co_shippriority#8190,co_comment#8191,co_orderdate#8192] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#8210 AS rid_1#8227, cpfk_customer_orders#8211 AS cpfk_customer_orders_1#8228, cfpk_orders_customer#8212 AS cfpk_orders_customer_1#8229, cval_orders_o_orderstatus#8213 AS cval_orders_o_orderstatus_1#8230, cval_orders_o_totalprice#8214 AS cval_orders_o_totalprice_1#8231, cval_orders_o_orderpriority#8215 AS cval_orders_o_orderpriority_1#8232, cval_orders_o_clerk#8216 AS cval_orders_o_clerk_1#8233, cval_orders_o_shippriority#8217 AS cval_orders_o_shippriority_1#8234, cval_orders_o_comment#8218 AS cval_orders_o_comment_1#8235, cval_orders_o_orderdate#8219 AS cval_orders_o_orderdate_1#8236, co_orderstatus#8220 AS co_orderstatus_1#8237, co_totalprice#8221 AS co_totalprice_1#8238, co_orderpriority#8222 AS co_orderpriority_1#8239, co_clerk#8223 AS co_clerk_1#8240, co_shippriority#8224 AS co_shippriority_1#8241, co_comment#8225 AS co_comment_1#8242, co_orderdate#8226 AS co_orderdate_1#8243]
                  :     :  :  :        +- Relation[rid#8210,cpfk_customer_orders#8211,cfpk_orders_customer#8212,cval_orders_o_orderstatus#8213,cval_orders_o_totalprice#8214,cval_orders_o_orderpriority#8215,cval_orders_o_clerk#8216,cval_orders_o_shippriority#8217,cval_orders_o_comment#8218,cval_orders_o_orderdate#8219,co_orderstatus#8220,co_totalprice#8221,co_orderpriority#8222,co_clerk#8223,co_shippriority#8224,co_comment#8225,co_orderdate#8226] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :     :- Project [rid#8310 AS rid_1#8327, cpfk_customer_orders#8311 AS cpfk_customer_orders_1#8328, cfpk_orders_customer#8312 AS cfpk_orders_customer_1#8329, cval_orders_o_orderstatus#8313 AS cval_orders_o_orderstatus_1#8330, cval_orders_o_totalprice#8314 AS cval_orders_o_totalprice_1#8331, cval_orders_o_orderpriority#8315 AS cval_orders_o_orderpriority_1#8332, cval_orders_o_clerk#8316 AS cval_orders_o_clerk_1#8333, cval_orders_o_shippriority#8317 AS cval_orders_o_shippriority_1#8334, cval_orders_o_comment#8318 AS cval_orders_o_comment_1#8335, cval_orders_o_orderdate#8319 AS cval_orders_o_orderdate_1#8336, co_orderstatus#8320 AS co_orderstatus_1#8337, co_totalprice#8321 AS co_totalprice_1#8338, co_orderpriority#8322 AS co_orderpriority_1#8339, co_clerk#8323 AS co_clerk_1#8340, co_shippriority#8324 AS co_shippriority_1#8341, co_comment#8325 AS co_comment_1#8342, co_orderdate#8326 AS co_orderdate_1#8343]
                  :     :  :     :  +- Relation[rid#8310,cpfk_customer_orders#8311,cfpk_orders_customer#8312,cval_orders_o_orderstatus#8313,cval_orders_o_totalprice#8314,cval_orders_o_orderpriority#8315,cval_orders_o_clerk#8316,cval_orders_o_shippriority#8317,cval_orders_o_comment#8318,cval_orders_o_orderdate#8319,co_orderstatus#8320,co_totalprice#8321,co_orderpriority#8322,co_clerk#8323,co_shippriority#8324,co_comment#8325,co_orderdate#8326] JDBCRelation(torders) [numPartitions=1]
                  :     :  :     +- Project [rid#8344 AS rid_2#8377, cpfk_orders_lineitem#8345 AS cpfk_orders_lineitem_2#8378, cpfk_supplier_lineitem#8346 AS cpfk_supplier_lineitem_2#8379, cfpk_lineitem_supplier#8347 AS cfpk_lineitem_supplier_2#8380, cfpk_lineitem_partsupp#8348 AS cfpk_lineitem_partsupp_2#8381, cpfk_part_lineitem#8349 AS cpfk_part_lineitem_2#8382, cfpk_lineitem_part#8350 AS cfpk_lineitem_part_2#8383, cpfk_partsupp_lineitem#8351 AS cpfk_partsupp_lineitem_2#8384, cfpk_lineitem_orders#8352 AS cfpk_lineitem_orders_2#8385, cval_lineitem_l_quantity#8353 AS cval_lineitem_l_quantity_2#8386, cval_lineitem_l_extendedprice#8354 AS cval_lineitem_l_extendedprice_2#8387, cval_lineitem_l_discount#8355 AS cval_lineitem_l_discount_2#8388, cval_lineitem_l_tax#8356 AS cval_lineitem_l_tax_2#8389, cval_lineitem_l_returnflag#8357 AS cval_lineitem_l_returnflag_2#8390, cval_lineitem_l_linestatus#8358 AS cval_lineitem_l_linestatus_2#8391, cval_lineitem_l_commitdate#8359 AS cval_lineitem_l_commitdate_2#8392, cval_lineitem_l_receiptdate#8360 AS cval_lineitem_l_receiptdate_2#8393, cval_lineitem_l_shipinstruct#8361 AS cval_lineitem_l_shipinstruct_2#8394, cval_lineitem_l_shipmode#8362 AS cval_lineitem_l_shipmode_2#8395, cval_lineitem_l_comment#8363 AS cval_lineitem_l_comment_2#8396, cval_lineitem_l_shipdate#8364 AS cval_lineitem_l_shipdate_2#8397, cl_quantity#8365 AS cl_quantity_2#8398, cl_extendedprice#8366 AS cl_extendedprice_2#8399, cl_discount#8367 AS cl_discount_2#8400, ... 9 more fields]
                  :     :  :        +- Relation[rid#8344,cpfk_orders_lineitem#8345,cpfk_supplier_lineitem#8346,cfpk_lineitem_supplier#8347,cfpk_lineitem_partsupp#8348,cpfk_part_lineitem#8349,cfpk_lineitem_part#8350,cpfk_partsupp_lineitem#8351,cfpk_lineitem_orders#8352,cval_lineitem_l_quantity#8353,cval_lineitem_l_extendedprice#8354,cval_lineitem_l_discount#8355,cval_lineitem_l_tax#8356,cval_lineitem_l_returnflag#8357,cval_lineitem_l_linestatus#8358,cval_lineitem_l_commitdate#8359,cval_lineitem_l_receiptdate#8360,cval_lineitem_l_shipinstruct#8361,cval_lineitem_l_shipmode#8362,cval_lineitem_l_comment#8363,cval_lineitem_l_shipdate#8364,cl_quantity#8365,cl_extendedprice#8366,cl_discount#8367,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#8244 AS rid_2#8277, cpfk_orders_lineitem#8245 AS cpfk_orders_lineitem_2#8278, cpfk_supplier_lineitem#8246 AS cpfk_supplier_lineitem_2#8279, cfpk_lineitem_supplier#8247 AS cfpk_lineitem_supplier_2#8280, cfpk_lineitem_partsupp#8248 AS cfpk_lineitem_partsupp_2#8281, cpfk_part_lineitem#8249 AS cpfk_part_lineitem_2#8282, cfpk_lineitem_part#8250 AS cfpk_lineitem_part_2#8283, cpfk_partsupp_lineitem#8251 AS cpfk_partsupp_lineitem_2#8284, cfpk_lineitem_orders#8252 AS cfpk_lineitem_orders_2#8285, cval_lineitem_l_quantity#8253 AS cval_lineitem_l_quantity_2#8286, cval_lineitem_l_extendedprice#8254 AS cval_lineitem_l_extendedprice_2#8287, cval_lineitem_l_discount#8255 AS cval_lineitem_l_discount_2#8288, cval_lineitem_l_tax#8256 AS cval_lineitem_l_tax_2#8289, cval_lineitem_l_returnflag#8257 AS cval_lineitem_l_returnflag_2#8290, cval_lineitem_l_linestatus#8258 AS cval_lineitem_l_linestatus_2#8291, cval_lineitem_l_commitdate#8259 AS cval_lineitem_l_commitdate_2#8292, cval_lineitem_l_receiptdate#8260 AS cval_lineitem_l_receiptdate_2#8293, cval_lineitem_l_shipinstruct#8261 AS cval_lineitem_l_shipinstruct_2#8294, cval_lineitem_l_shipmode#8262 AS cval_lineitem_l_shipmode_2#8295, cval_lineitem_l_comment#8263 AS cval_lineitem_l_comment_2#8296, cval_lineitem_l_shipdate#8264 AS cval_lineitem_l_shipdate_2#8297, cl_quantity#8265 AS cl_quantity_2#8298, cl_extendedprice#8266 AS cl_extendedprice_2#8299, cl_discount#8267 AS cl_discount_2#8300, ... 9 more fields]
                  :     :     +- Relation[rid#8244,cpfk_orders_lineitem#8245,cpfk_supplier_lineitem#8246,cfpk_lineitem_supplier#8247,cfpk_lineitem_partsupp#8248,cpfk_part_lineitem#8249,cfpk_lineitem_part#8250,cpfk_partsupp_lineitem#8251,cfpk_lineitem_orders#8252,cval_lineitem_l_quantity#8253,cval_lineitem_l_extendedprice#8254,cval_lineitem_l_discount#8255,cval_lineitem_l_tax#8256,cval_lineitem_l_returnflag#8257,cval_lineitem_l_linestatus#8258,cval_lineitem_l_commitdate#8259,cval_lineitem_l_receiptdate#8260,cval_lineitem_l_shipinstruct#8261,cval_lineitem_l_shipmode#8262,cval_lineitem_l_comment#8263,cval_lineitem_l_shipdate#8264,cl_quantity#8265,cl_extendedprice#8266,cl_discount#8267,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#8410 AS rid_3#8423, cpfk_nation_supplier#8411 AS cpfk_nation_supplier_3#8424, cfpk_supplier_nation#8412 AS cfpk_supplier_nation_3#8425, cval_supplier_s_name#8413 AS cval_supplier_s_name_3#8426, cval_supplier_s_address#8414 AS cval_supplier_s_address_3#8427, cval_supplier_s_phone#8415 AS cval_supplier_s_phone_3#8428, cval_supplier_s_acctbal#8416 AS cval_supplier_s_acctbal_3#8429, cval_supplier_s_comment#8417 AS cval_supplier_s_comment_3#8430, cs_name#8418 AS cs_name_3#8431, cs_address#8419 AS cs_address_3#8432, cs_phone#8420 AS cs_phone_3#8433, cs_acctbal#8421 AS cs_acctbal_3#8434, cs_comment#8422 AS cs_comment_3#8435]
                  :        +- Relation[rid#8410,cpfk_nation_supplier#8411,cfpk_supplier_nation#8412,cval_supplier_s_name#8413,cval_supplier_s_address#8414,cval_supplier_s_phone#8415,cval_supplier_s_acctbal#8416,cval_supplier_s_comment#8417,cs_name#8418,cs_address#8419,cs_phone#8420,cs_acctbal#8421,cs_comment#8422] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#8436 AS rid_4#8443, cpfk_region_nation#8437 AS cpfk_region_nation_4#8444, cfpk_nation_region#8438 AS cfpk_nation_region_4#8445, cval_nation_n_name#8439 AS cval_nation_n_name_4#8446, cval_nation_n_comment#8440 AS cval_nation_n_comment_4#8447, cn_name#8441 AS cn_name_4#8448, cn_comment#8442 AS cn_comment_4#8449]
                     :  +- Relation[rid#8436,cpfk_region_nation#8437,cfpk_nation_region#8438,cval_nation_n_name#8439,cval_nation_n_comment#8440,cn_name#8441,cn_comment#8442] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#8450 AS rid_4#8457, cpfk_region_nation#8451 AS cpfk_region_nation_4#8458, cfpk_nation_region#8452 AS cfpk_nation_region_4#8459, cval_nation_n_name#8453 AS cval_nation_n_name_4#8460, cval_nation_n_comment#8454 AS cval_nation_n_comment_4#8461, cn_name#8455 AS cn_name_4#8462, cn_comment#8456 AS cn_comment_4#8463]
                           +- Relation[rid#8450,cpfk_region_nation#8451,cfpk_nation_region#8452,cval_nation_n_name#8453,cval_nation_n_comment#8454,cn_name#8455,cn_comment#8456] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 248040ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/11 05:04:22 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:04:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8572L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 05:04:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:04:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:04:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:04:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:04:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:04:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:04:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:04:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:04:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:04:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:04:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:04:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 05:04:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:04:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8572L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#8574 AS rid_0#8591, cval_part_p_name#8575 AS cval_part_p_name_0#8592, cval_part_p_mfgr#8576 AS cval_part_p_mfgr_0#8593, cval_part_p_type#8577 AS cval_part_p_type_0#8594, cval_part_p_size#8578 AS cval_part_p_size_0#8595, cval_part_p_container#8579 AS cval_part_p_container_0#8596, cval_part_p_retailprice#8580 AS cval_part_p_retailprice_0#8597, cval_part_p_comment#8581 AS cval_part_p_comment_0#8598, cval_part_p_brand#8582 AS cval_part_p_brand_0#8599, cp_name#8583 AS cp_name_0#8600, cp_mfgr#8584 AS cp_mfgr_0#8601, cp_type#8585 AS cp_type_0#8602, cp_size#8586 AS cp_size_0#8603, cp_container#8587 AS cp_container_0#8604, cp_retailprice#8588 AS cp_retailprice_0#8605, cp_comment#8589 AS cp_comment_0#8606, cp_brand#8590 AS cp_brand_0#8607]
            :  :  :  :  +- Relation[rid#8574,cval_part_p_name#8575,cval_part_p_mfgr#8576,cval_part_p_type#8577,cval_part_p_size#8578,cval_part_p_container#8579,cval_part_p_retailprice#8580,cval_part_p_comment#8581,cval_part_p_brand#8582,cp_name#8583,cp_mfgr#8584,cp_type#8585,cp_size#8586,cp_container#8587,cp_retailprice#8588,cp_comment#8589,cp_brand#8590] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#8608 AS rid_0#8625, cval_part_p_name#8609 AS cval_part_p_name_0#8626, cval_part_p_mfgr#8610 AS cval_part_p_mfgr_0#8627, cval_part_p_type#8611 AS cval_part_p_type_0#8628, cval_part_p_size#8612 AS cval_part_p_size_0#8629, cval_part_p_container#8613 AS cval_part_p_container_0#8630, cval_part_p_retailprice#8614 AS cval_part_p_retailprice_0#8631, cval_part_p_comment#8615 AS cval_part_p_comment_0#8632, cval_part_p_brand#8616 AS cval_part_p_brand_0#8633, cp_name#8617 AS cp_name_0#8634, cp_mfgr#8618 AS cp_mfgr_0#8635, cp_type#8619 AS cp_type_0#8636, cp_size#8620 AS cp_size_0#8637, cp_container#8621 AS cp_container_0#8638, cp_retailprice#8622 AS cp_retailprice_0#8639, cp_comment#8623 AS cp_comment_0#8640, cp_brand#8624 AS cp_brand_0#8641]
            :  :  :        +- Relation[rid#8608,cval_part_p_name#8609,cval_part_p_mfgr#8610,cval_part_p_type#8611,cval_part_p_size#8612,cval_part_p_container#8613,cval_part_p_retailprice#8614,cval_part_p_comment#8615,cval_part_p_brand#8616,cp_name#8617,cp_mfgr#8618,cp_type#8619,cp_size#8620,cp_container#8621,cp_retailprice#8622,cp_comment#8623,cp_brand#8624] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :     :- Project [rid#8664 AS rid_0#8681, cval_part_p_name#8665 AS cval_part_p_name_0#8682, cval_part_p_mfgr#8666 AS cval_part_p_mfgr_0#8683, cval_part_p_type#8667 AS cval_part_p_type_0#8684, cval_part_p_size#8668 AS cval_part_p_size_0#8685, cval_part_p_container#8669 AS cval_part_p_container_0#8686, cval_part_p_retailprice#8670 AS cval_part_p_retailprice_0#8687, cval_part_p_comment#8671 AS cval_part_p_comment_0#8688, cval_part_p_brand#8672 AS cval_part_p_brand_0#8689, cp_name#8673 AS cp_name_0#8690, cp_mfgr#8674 AS cp_mfgr_0#8691, cp_type#8675 AS cp_type_0#8692, cp_size#8676 AS cp_size_0#8693, cp_container#8677 AS cp_container_0#8694, cp_retailprice#8678 AS cp_retailprice_0#8695, cp_comment#8679 AS cp_comment_0#8696, cp_brand#8680 AS cp_brand_0#8697]
            :  :     :  +- Relation[rid#8664,cval_part_p_name#8665,cval_part_p_mfgr#8666,cval_part_p_type#8667,cval_part_p_size#8668,cval_part_p_container#8669,cval_part_p_retailprice#8670,cval_part_p_comment#8671,cval_part_p_brand#8672,cp_name#8673,cp_mfgr#8674,cp_type#8675,cp_size#8676,cp_container#8677,cp_retailprice#8678,cp_comment#8679,cp_brand#8680] JDBCRelation(tpart) [numPartitions=1]
            :  :     +- Project [rid#8698 AS rid_1#8709, cpfk_part_partsupp#8699 AS cpfk_part_partsupp_1#8710, cfpk_partsupp_part#8700 AS cfpk_partsupp_part_1#8711, cpfk_supplier_partsupp#8701 AS cpfk_supplier_partsupp_1#8712, cfpk_partsupp_supplier#8702 AS cfpk_partsupp_supplier_1#8713, cval_partsupp_ps_availqty#8703 AS cval_partsupp_ps_availqty_1#8714, cval_partsupp_ps_supplycost#8704 AS cval_partsupp_ps_supplycost_1#8715, cval_partsupp_ps_comment#8705 AS cval_partsupp_ps_comment_1#8716, cps_availqty#8706 AS cps_availqty_1#8717, cps_supplycost#8707 AS cps_supplycost_1#8718, cps_comment#8708 AS cps_comment_1#8719]
            :  :        +- Relation[rid#8698,cpfk_part_partsupp#8699,cfpk_partsupp_part#8700,cpfk_supplier_partsupp#8701,cfpk_partsupp_supplier#8702,cval_partsupp_ps_availqty#8703,cval_partsupp_ps_supplycost#8704,cval_partsupp_ps_comment#8705,cps_availqty#8706,cps_supplycost#8707,cps_comment#8708] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#8642 AS rid_1#8653, cpfk_part_partsupp#8643 AS cpfk_part_partsupp_1#8654, cfpk_partsupp_part#8644 AS cfpk_partsupp_part_1#8655, cpfk_supplier_partsupp#8645 AS cpfk_supplier_partsupp_1#8656, cfpk_partsupp_supplier#8646 AS cfpk_partsupp_supplier_1#8657, cval_partsupp_ps_availqty#8647 AS cval_partsupp_ps_availqty_1#8658, cval_partsupp_ps_supplycost#8648 AS cval_partsupp_ps_supplycost_1#8659, cval_partsupp_ps_comment#8649 AS cval_partsupp_ps_comment_1#8660, cps_availqty#8650 AS cps_availqty_1#8661, cps_supplycost#8651 AS cps_supplycost_1#8662, cps_comment#8652 AS cps_comment_1#8663]
            :     +- Relation[rid#8642,cpfk_part_partsupp#8643,cfpk_partsupp_part#8644,cpfk_supplier_partsupp#8645,cfpk_partsupp_supplier#8646,cval_partsupp_ps_availqty#8647,cval_partsupp_ps_supplycost#8648,cval_partsupp_ps_comment#8649,cps_availqty#8650,cps_supplycost#8651,cps_comment#8652] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#8720 AS rid_2#8727, cpfk_region_nation#8721 AS cpfk_region_nation_2#8728, cfpk_nation_region#8722 AS cfpk_nation_region_2#8729, cval_nation_n_name#8723 AS cval_nation_n_name_2#8730, cval_nation_n_comment#8724 AS cval_nation_n_comment_2#8731, cn_name#8725 AS cn_name_2#8732, cn_comment#8726 AS cn_comment_2#8733]
               :  :  :  +- Relation[rid#8720,cpfk_region_nation#8721,cfpk_nation_region#8722,cval_nation_n_name#8723,cval_nation_n_comment#8724,cn_name#8725,cn_comment#8726] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#8734 AS rid_2#8741, cpfk_region_nation#8735 AS cpfk_region_nation_2#8742, cfpk_nation_region#8736 AS cfpk_nation_region_2#8743, cval_nation_n_name#8737 AS cval_nation_n_name_2#8744, cval_nation_n_comment#8738 AS cval_nation_n_comment_2#8745, cn_name#8739 AS cn_name_2#8746, cn_comment#8740 AS cn_comment_2#8747]
               :  :        +- Relation[rid#8734,cpfk_region_nation#8735,cfpk_nation_region#8736,cval_nation_n_name#8737,cval_nation_n_comment#8738,cn_name#8739,cn_comment#8740] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :     :- Project [rid#8774 AS rid_2#8781, cpfk_region_nation#8775 AS cpfk_region_nation_2#8782, cfpk_nation_region#8776 AS cfpk_nation_region_2#8783, cval_nation_n_name#8777 AS cval_nation_n_name_2#8784, cval_nation_n_comment#8778 AS cval_nation_n_comment_2#8785, cn_name#8779 AS cn_name_2#8786, cn_comment#8780 AS cn_comment_2#8787]
               :     :  +- Relation[rid#8774,cpfk_region_nation#8775,cfpk_nation_region#8776,cval_nation_n_name#8777,cval_nation_n_comment#8778,cn_name#8779,cn_comment#8780] JDBCRelation(tnation) [numPartitions=1]
               :     +- Project [rid#8788 AS rid_3#8801, cpfk_nation_supplier#8789 AS cpfk_nation_supplier_3#8802, cfpk_supplier_nation#8790 AS cfpk_supplier_nation_3#8803, cval_supplier_s_name#8791 AS cval_supplier_s_name_3#8804, cval_supplier_s_address#8792 AS cval_supplier_s_address_3#8805, cval_supplier_s_phone#8793 AS cval_supplier_s_phone_3#8806, cval_supplier_s_acctbal#8794 AS cval_supplier_s_acctbal_3#8807, cval_supplier_s_comment#8795 AS cval_supplier_s_comment_3#8808, cs_name#8796 AS cs_name_3#8809, cs_address#8797 AS cs_address_3#8810, cs_phone#8798 AS cs_phone_3#8811, cs_acctbal#8799 AS cs_acctbal_3#8812, cs_comment#8800 AS cs_comment_3#8813]
               :        +- Relation[rid#8788,cpfk_nation_supplier#8789,cfpk_supplier_nation#8790,cval_supplier_s_name#8791,cval_supplier_s_address#8792,cval_supplier_s_phone#8793,cval_supplier_s_acctbal#8794,cval_supplier_s_comment#8795,cs_name#8796,cs_address#8797,cs_phone#8798,cs_acctbal#8799,cs_comment#8800] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#8748 AS rid_3#8761, cpfk_nation_supplier#8749 AS cpfk_nation_supplier_3#8762, cfpk_supplier_nation#8750 AS cfpk_supplier_nation_3#8763, cval_supplier_s_name#8751 AS cval_supplier_s_name_3#8764, cval_supplier_s_address#8752 AS cval_supplier_s_address_3#8765, cval_supplier_s_phone#8753 AS cval_supplier_s_phone_3#8766, cval_supplier_s_acctbal#8754 AS cval_supplier_s_acctbal_3#8767, cval_supplier_s_comment#8755 AS cval_supplier_s_comment_3#8768, cs_name#8756 AS cs_name_3#8769, cs_address#8757 AS cs_address_3#8770, cs_phone#8758 AS cs_phone_3#8771, cs_acctbal#8759 AS cs_acctbal_3#8772, cs_comment#8760 AS cs_comment_3#8773]
                  +- Relation[rid#8748,cpfk_nation_supplier#8749,cfpk_supplier_nation#8750,cval_supplier_s_name#8751,cval_supplier_s_address#8752,cval_supplier_s_phone#8753,cval_supplier_s_acctbal#8754,cval_supplier_s_comment#8755,cs_name#8756,cs_address#8757,cs_phone#8758,cs_acctbal#8759,cs_comment#8760] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 11520ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/11 05:04:34 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 05:04:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8870L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 05:04:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:04:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:04:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:04:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:04:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:04:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:04:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:04:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:04:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:04:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 05:04:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:04:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:04:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:04:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:04:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 05:04:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8870L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#8872 AS rid_0#8879, cpfk_region_nation#8873 AS cpfk_region_nation_0#8880, cfpk_nation_region#8874 AS cfpk_nation_region_0#8881, cval_nation_n_name#8875 AS cval_nation_n_name_0#8882, cval_nation_n_comment#8876 AS cval_nation_n_comment_0#8883, cn_name#8877 AS cn_name_0#8884, cn_comment#8878 AS cn_comment_0#8885]
            :  :  :  :  :  :  +- Relation[rid#8872,cpfk_region_nation#8873,cfpk_nation_region#8874,cval_nation_n_name#8875,cval_nation_n_comment#8876,cn_name#8877,cn_comment#8878] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#8886 AS rid_0#8893, cpfk_region_nation#8887 AS cpfk_region_nation_0#8894, cfpk_nation_region#8888 AS cfpk_nation_region_0#8895, cval_nation_n_name#8889 AS cval_nation_n_name_0#8896, cval_nation_n_comment#8890 AS cval_nation_n_comment_0#8897, cn_name#8891 AS cn_name_0#8898, cn_comment#8892 AS cn_comment_0#8899]
            :  :  :  :  :        +- Relation[rid#8886,cpfk_region_nation#8887,cfpk_nation_region#8888,cval_nation_n_name#8889,cval_nation_n_comment#8890,cn_name#8891,cn_comment#8892] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :     :- Project [rid#8926 AS rid_0#8933, cpfk_region_nation#8927 AS cpfk_region_nation_0#8934, cfpk_nation_region#8928 AS cfpk_nation_region_0#8935, cval_nation_n_name#8929 AS cval_nation_n_name_0#8936, cval_nation_n_comment#8930 AS cval_nation_n_comment_0#8937, cn_name#8931 AS cn_name_0#8938, cn_comment#8932 AS cn_comment_0#8939]
            :  :  :  :     :  +- Relation[rid#8926,cpfk_region_nation#8927,cfpk_nation_region#8928,cval_nation_n_name#8929,cval_nation_n_comment#8930,cn_name#8931,cn_comment#8932] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :     +- Project [rid#8940 AS rid_1#8953, cpfk_nation_supplier#8941 AS cpfk_nation_supplier_1#8954, cfpk_supplier_nation#8942 AS cfpk_supplier_nation_1#8955, cval_supplier_s_name#8943 AS cval_supplier_s_name_1#8956, cval_supplier_s_address#8944 AS cval_supplier_s_address_1#8957, cval_supplier_s_phone#8945 AS cval_supplier_s_phone_1#8958, cval_supplier_s_acctbal#8946 AS cval_supplier_s_acctbal_1#8959, cval_supplier_s_comment#8947 AS cval_supplier_s_comment_1#8960, cs_name#8948 AS cs_name_1#8961, cs_address#8949 AS cs_address_1#8962, cs_phone#8950 AS cs_phone_1#8963, cs_acctbal#8951 AS cs_acctbal_1#8964, cs_comment#8952 AS cs_comment_1#8965]
            :  :  :  :        +- Relation[rid#8940,cpfk_nation_supplier#8941,cfpk_supplier_nation#8942,cval_supplier_s_name#8943,cval_supplier_s_address#8944,cval_supplier_s_phone#8945,cval_supplier_s_acctbal#8946,cval_supplier_s_comment#8947,cs_name#8948,cs_address#8949,cs_phone#8950,cs_acctbal#8951,cs_comment#8952] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#8900 AS rid_1#8913, cpfk_nation_supplier#8901 AS cpfk_nation_supplier_1#8914, cfpk_supplier_nation#8902 AS cfpk_supplier_nation_1#8915, cval_supplier_s_name#8903 AS cval_supplier_s_name_1#8916, cval_supplier_s_address#8904 AS cval_supplier_s_address_1#8917, cval_supplier_s_phone#8905 AS cval_supplier_s_phone_1#8918, cval_supplier_s_acctbal#8906 AS cval_supplier_s_acctbal_1#8919, cval_supplier_s_comment#8907 AS cval_supplier_s_comment_1#8920, cs_name#8908 AS cs_name_1#8921, cs_address#8909 AS cs_address_1#8922, cs_phone#8910 AS cs_phone_1#8923, cs_acctbal#8911 AS cs_acctbal_1#8924, cs_comment#8912 AS cs_comment_1#8925]
            :  :  :     +- Relation[rid#8900,cpfk_nation_supplier#8901,cfpk_supplier_nation#8902,cval_supplier_s_name#8903,cval_supplier_s_address#8904,cval_supplier_s_phone#8905,cval_supplier_s_acctbal#8906,cval_supplier_s_comment#8907,cs_name#8908,cs_address#8909,cs_phone#8910,cs_acctbal#8911,cs_comment#8912] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :     :- Project [rid#9032 AS rid_1#9045, cpfk_nation_supplier#9033 AS cpfk_nation_supplier_1#9046, cfpk_supplier_nation#9034 AS cfpk_supplier_nation_1#9047, cval_supplier_s_name#9035 AS cval_supplier_s_name_1#9048, cval_supplier_s_address#9036 AS cval_supplier_s_address_1#9049, cval_supplier_s_phone#9037 AS cval_supplier_s_phone_1#9050, cval_supplier_s_acctbal#9038 AS cval_supplier_s_acctbal_1#9051, cval_supplier_s_comment#9039 AS cval_supplier_s_comment_1#9052, cs_name#9040 AS cs_name_1#9053, cs_address#9041 AS cs_address_1#9054, cs_phone#9042 AS cs_phone_1#9055, cs_acctbal#9043 AS cs_acctbal_1#9056, cs_comment#9044 AS cs_comment_1#9057]
            :  :     :  +- Relation[rid#9032,cpfk_nation_supplier#9033,cfpk_supplier_nation#9034,cval_supplier_s_name#9035,cval_supplier_s_address#9036,cval_supplier_s_phone#9037,cval_supplier_s_acctbal#9038,cval_supplier_s_comment#9039,cs_name#9040,cs_address#9041,cs_phone#9042,cs_acctbal#9043,cs_comment#9044] JDBCRelation(tsupplier) [numPartitions=1]
            :  :     +- Project [rid#9058 AS rid_2#9091, cpfk_orders_lineitem#9059 AS cpfk_orders_lineitem_2#9092, cpfk_supplier_lineitem#9060 AS cpfk_supplier_lineitem_2#9093, cfpk_lineitem_supplier#9061 AS cfpk_lineitem_supplier_2#9094, cfpk_lineitem_partsupp#9062 AS cfpk_lineitem_partsupp_2#9095, cpfk_part_lineitem#9063 AS cpfk_part_lineitem_2#9096, cfpk_lineitem_part#9064 AS cfpk_lineitem_part_2#9097, cpfk_partsupp_lineitem#9065 AS cpfk_partsupp_lineitem_2#9098, cfpk_lineitem_orders#9066 AS cfpk_lineitem_orders_2#9099, cval_lineitem_l_quantity#9067 AS cval_lineitem_l_quantity_2#9100, cval_lineitem_l_extendedprice#9068 AS cval_lineitem_l_extendedprice_2#9101, cval_lineitem_l_discount#9069 AS cval_lineitem_l_discount_2#9102, cval_lineitem_l_tax#9070 AS cval_lineitem_l_tax_2#9103, cval_lineitem_l_returnflag#9071 AS cval_lineitem_l_returnflag_2#9104, cval_lineitem_l_linestatus#9072 AS cval_lineitem_l_linestatus_2#9105, cval_lineitem_l_commitdate#9073 AS cval_lineitem_l_commitdate_2#9106, cval_lineitem_l_receiptdate#9074 AS cval_lineitem_l_receiptdate_2#9107, cval_lineitem_l_shipinstruct#9075 AS cval_lineitem_l_shipinstruct_2#9108, cval_lineitem_l_shipmode#9076 AS cval_lineitem_l_shipmode_2#9109, cval_lineitem_l_comment#9077 AS cval_lineitem_l_comment_2#9110, cval_lineitem_l_shipdate#9078 AS cval_lineitem_l_shipdate_2#9111, cl_quantity#9079 AS cl_quantity_2#9112, cl_extendedprice#9080 AS cl_extendedprice_2#9113, cl_discount#9081 AS cl_discount_2#9114, ... 9 more fields]
            :  :        +- Relation[rid#9058,cpfk_orders_lineitem#9059,cpfk_supplier_lineitem#9060,cfpk_lineitem_supplier#9061,cfpk_lineitem_partsupp#9062,cpfk_part_lineitem#9063,cfpk_lineitem_part#9064,cpfk_partsupp_lineitem#9065,cfpk_lineitem_orders#9066,cval_lineitem_l_quantity#9067,cval_lineitem_l_extendedprice#9068,cval_lineitem_l_discount#9069,cval_lineitem_l_tax#9070,cval_lineitem_l_returnflag#9071,cval_lineitem_l_linestatus#9072,cval_lineitem_l_commitdate#9073,cval_lineitem_l_receiptdate#9074,cval_lineitem_l_shipinstruct#9075,cval_lineitem_l_shipmode#9076,cval_lineitem_l_comment#9077,cval_lineitem_l_shipdate#9078,cl_quantity#9079,cl_extendedprice#9080,cl_discount#9081,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#8966 AS rid_2#8999, cpfk_orders_lineitem#8967 AS cpfk_orders_lineitem_2#9000, cpfk_supplier_lineitem#8968 AS cpfk_supplier_lineitem_2#9001, cfpk_lineitem_supplier#8969 AS cfpk_lineitem_supplier_2#9002, cfpk_lineitem_partsupp#8970 AS cfpk_lineitem_partsupp_2#9003, cpfk_part_lineitem#8971 AS cpfk_part_lineitem_2#9004, cfpk_lineitem_part#8972 AS cfpk_lineitem_part_2#9005, cpfk_partsupp_lineitem#8973 AS cpfk_partsupp_lineitem_2#9006, cfpk_lineitem_orders#8974 AS cfpk_lineitem_orders_2#9007, cval_lineitem_l_quantity#8975 AS cval_lineitem_l_quantity_2#9008, cval_lineitem_l_extendedprice#8976 AS cval_lineitem_l_extendedprice_2#9009, cval_lineitem_l_discount#8977 AS cval_lineitem_l_discount_2#9010, cval_lineitem_l_tax#8978 AS cval_lineitem_l_tax_2#9011, cval_lineitem_l_returnflag#8979 AS cval_lineitem_l_returnflag_2#9012, cval_lineitem_l_linestatus#8980 AS cval_lineitem_l_linestatus_2#9013, cval_lineitem_l_commitdate#8981 AS cval_lineitem_l_commitdate_2#9014, cval_lineitem_l_receiptdate#8982 AS cval_lineitem_l_receiptdate_2#9015, cval_lineitem_l_shipinstruct#8983 AS cval_lineitem_l_shipinstruct_2#9016, cval_lineitem_l_shipmode#8984 AS cval_lineitem_l_shipmode_2#9017, cval_lineitem_l_comment#8985 AS cval_lineitem_l_comment_2#9018, cval_lineitem_l_shipdate#8986 AS cval_lineitem_l_shipdate_2#9019, cl_quantity#8987 AS cl_quantity_2#9020, cl_extendedprice#8988 AS cl_extendedprice_2#9021, cl_discount#8989 AS cl_discount_2#9022, ... 9 more fields]
            :     +- Relation[rid#8966,cpfk_orders_lineitem#8967,cpfk_supplier_lineitem#8968,cfpk_lineitem_supplier#8969,cfpk_lineitem_partsupp#8970,cpfk_part_lineitem#8971,cfpk_lineitem_part#8972,cpfk_partsupp_lineitem#8973,cfpk_lineitem_orders#8974,cval_lineitem_l_quantity#8975,cval_lineitem_l_extendedprice#8976,cval_lineitem_l_discount#8977,cval_lineitem_l_tax#8978,cval_lineitem_l_returnflag#8979,cval_lineitem_l_linestatus#8980,cval_lineitem_l_commitdate#8981,cval_lineitem_l_receiptdate#8982,cval_lineitem_l_shipinstruct#8983,cval_lineitem_l_shipmode#8984,cval_lineitem_l_comment#8985,cval_lineitem_l_shipdate#8986,cl_quantity#8987,cl_extendedprice#8988,cl_discount#8989,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'Join UsingJoin(Inner,List(rid_4))
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'Join UsingJoin(Inner,List(rid_3))
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#9124 AS rid_3#9131, cpfk_region_nation#9125 AS cpfk_region_nation_3#9132, cfpk_nation_region#9126 AS cfpk_nation_region_3#9133, cval_nation_n_name#9127 AS cval_nation_n_name_3#9134, cval_nation_n_comment#9128 AS cval_nation_n_comment_3#9135, cn_name#9129 AS cn_name_3#9136, cn_comment#9130 AS cn_comment_3#9137]
               :  :  :  :  :  +- Relation[rid#9124,cpfk_region_nation#9125,cfpk_nation_region#9126,cval_nation_n_name#9127,cval_nation_n_comment#9128,cn_name#9129,cn_comment#9130] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#9138 AS rid_3#9145, cpfk_region_nation#9139 AS cpfk_region_nation_3#9146, cfpk_nation_region#9140 AS cfpk_nation_region_3#9147, cval_nation_n_name#9141 AS cval_nation_n_name_3#9148, cval_nation_n_comment#9142 AS cval_nation_n_comment_3#9149, cn_name#9143 AS cn_name_3#9150, cn_comment#9144 AS cn_comment_3#9151]
               :  :  :  :        +- Relation[rid#9138,cpfk_region_nation#9139,cfpk_nation_region#9140,cval_nation_n_name#9141,cval_nation_n_comment#9142,cn_name#9143,cn_comment#9144] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :     :- Project [rid#9182 AS rid_3#9189, cpfk_region_nation#9183 AS cpfk_region_nation_3#9190, cfpk_nation_region#9184 AS cfpk_nation_region_3#9191, cval_nation_n_name#9185 AS cval_nation_n_name_3#9192, cval_nation_n_comment#9186 AS cval_nation_n_comment_3#9193, cn_name#9187 AS cn_name_3#9194, cn_comment#9188 AS cn_comment_3#9195]
               :  :  :     :  +- Relation[rid#9182,cpfk_region_nation#9183,cfpk_nation_region#9184,cval_nation_n_name#9185,cval_nation_n_comment#9186,cn_name#9187,cn_comment#9188] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#9196 AS rid_4#9211, cpfk_nation_customer#9197 AS cpfk_nation_customer_4#9212, cfpk_customer_nation#9198 AS cfpk_customer_nation_4#9213, cval_customer_c_name#9199 AS cval_customer_c_name_4#9214, cval_customer_c_address#9200 AS cval_customer_c_address_4#9215, cval_customer_c_phone#9201 AS cval_customer_c_phone_4#9216, cval_customer_c_acctbal#9202 AS cval_customer_c_acctbal_4#9217, cval_customer_c_comment#9203 AS cval_customer_c_comment_4#9218, cval_customer_c_mktsegment#9204 AS cval_customer_c_mktsegment_4#9219, cc_name#9205 AS cc_name_4#9220, cc_address#9206 AS cc_address_4#9221, cc_phone#9207 AS cc_phone_4#9222, cc_acctbal#9208 AS cc_acctbal_4#9223, cc_comment#9209 AS cc_comment_4#9224, cc_mktsegment#9210 AS cc_mktsegment_4#9225]
               :  :  :        +- Relation[rid#9196,cpfk_nation_customer#9197,cfpk_customer_nation#9198,cval_customer_c_name#9199,cval_customer_c_address#9200,cval_customer_c_phone#9201,cval_customer_c_acctbal#9202,cval_customer_c_comment#9203,cval_customer_c_mktsegment#9204,cc_name#9205,cc_address#9206,cc_phone#9207,cc_acctbal#9208,cc_comment#9209,cc_mktsegment#9210] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#9152 AS rid_4#9167, cpfk_nation_customer#9153 AS cpfk_nation_customer_4#9168, cfpk_customer_nation#9154 AS cfpk_customer_nation_4#9169, cval_customer_c_name#9155 AS cval_customer_c_name_4#9170, cval_customer_c_address#9156 AS cval_customer_c_address_4#9171, cval_customer_c_phone#9157 AS cval_customer_c_phone_4#9172, cval_customer_c_acctbal#9158 AS cval_customer_c_acctbal_4#9173, cval_customer_c_comment#9159 AS cval_customer_c_comment_4#9174, cval_customer_c_mktsegment#9160 AS cval_customer_c_mktsegment_4#9175, cc_name#9161 AS cc_name_4#9176, cc_address#9162 AS cc_address_4#9177, cc_phone#9163 AS cc_phone_4#9178, cc_acctbal#9164 AS cc_acctbal_4#9179, cc_comment#9165 AS cc_comment_4#9180, cc_mktsegment#9166 AS cc_mktsegment_4#9181]
               :  :     +- Relation[rid#9152,cpfk_nation_customer#9153,cfpk_customer_nation#9154,cval_customer_c_name#9155,cval_customer_c_address#9156,cval_customer_c_phone#9157,cval_customer_c_acctbal#9158,cval_customer_c_comment#9159,cval_customer_c_mktsegment#9160,cc_name#9161,cc_address#9162,cc_phone#9163,cc_acctbal#9164,cc_comment#9165,cc_mktsegment#9166] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :     :- Project [rid#9260 AS rid_4#9275, cpfk_nation_customer#9261 AS cpfk_nation_customer_4#9276, cfpk_customer_nation#9262 AS cfpk_customer_nation_4#9277, cval_customer_c_name#9263 AS cval_customer_c_name_4#9278, cval_customer_c_address#9264 AS cval_customer_c_address_4#9279, cval_customer_c_phone#9265 AS cval_customer_c_phone_4#9280, cval_customer_c_acctbal#9266 AS cval_customer_c_acctbal_4#9281, cval_customer_c_comment#9267 AS cval_customer_c_comment_4#9282, cval_customer_c_mktsegment#9268 AS cval_customer_c_mktsegment_4#9283, cc_name#9269 AS cc_name_4#9284, cc_address#9270 AS cc_address_4#9285, cc_phone#9271 AS cc_phone_4#9286, cc_acctbal#9272 AS cc_acctbal_4#9287, cc_comment#9273 AS cc_comment_4#9288, cc_mktsegment#9274 AS cc_mktsegment_4#9289]
               :     :  +- Relation[rid#9260,cpfk_nation_customer#9261,cfpk_customer_nation#9262,cval_customer_c_name#9263,cval_customer_c_address#9264,cval_customer_c_phone#9265,cval_customer_c_acctbal#9266,cval_customer_c_comment#9267,cval_customer_c_mktsegment#9268,cc_name#9269,cc_address#9270,cc_phone#9271,cc_acctbal#9272,cc_comment#9273,cc_mktsegment#9274] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#9290 AS rid_5#9307, cpfk_customer_orders#9291 AS cpfk_customer_orders_5#9308, cfpk_orders_customer#9292 AS cfpk_orders_customer_5#9309, cval_orders_o_orderstatus#9293 AS cval_orders_o_orderstatus_5#9310, cval_orders_o_totalprice#9294 AS cval_orders_o_totalprice_5#9311, cval_orders_o_orderpriority#9295 AS cval_orders_o_orderpriority_5#9312, cval_orders_o_clerk#9296 AS cval_orders_o_clerk_5#9313, cval_orders_o_shippriority#9297 AS cval_orders_o_shippriority_5#9314, cval_orders_o_comment#9298 AS cval_orders_o_comment_5#9315, cval_orders_o_orderdate#9299 AS cval_orders_o_orderdate_5#9316, co_orderstatus#9300 AS co_orderstatus_5#9317, co_totalprice#9301 AS co_totalprice_5#9318, co_orderpriority#9302 AS co_orderpriority_5#9319, co_clerk#9303 AS co_clerk_5#9320, co_shippriority#9304 AS co_shippriority_5#9321, co_comment#9305 AS co_comment_5#9322, co_orderdate#9306 AS co_orderdate_5#9323]
               :        +- Relation[rid#9290,cpfk_customer_orders#9291,cfpk_orders_customer#9292,cval_orders_o_orderstatus#9293,cval_orders_o_totalprice#9294,cval_orders_o_orderpriority#9295,cval_orders_o_clerk#9296,cval_orders_o_shippriority#9297,cval_orders_o_comment#9298,cval_orders_o_orderdate#9299,co_orderstatus#9300,co_totalprice#9301,co_orderpriority#9302,co_clerk#9303,co_shippriority#9304,co_comment#9305,co_orderdate#9306] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#9226 AS rid_5#9243, cpfk_customer_orders#9227 AS cpfk_customer_orders_5#9244, cfpk_orders_customer#9228 AS cfpk_orders_customer_5#9245, cval_orders_o_orderstatus#9229 AS cval_orders_o_orderstatus_5#9246, cval_orders_o_totalprice#9230 AS cval_orders_o_totalprice_5#9247, cval_orders_o_orderpriority#9231 AS cval_orders_o_orderpriority_5#9248, cval_orders_o_clerk#9232 AS cval_orders_o_clerk_5#9249, cval_orders_o_shippriority#9233 AS cval_orders_o_shippriority_5#9250, cval_orders_o_comment#9234 AS cval_orders_o_comment_5#9251, cval_orders_o_orderdate#9235 AS cval_orders_o_orderdate_5#9252, co_orderstatus#9236 AS co_orderstatus_5#9253, co_totalprice#9237 AS co_totalprice_5#9254, co_orderpriority#9238 AS co_orderpriority_5#9255, co_clerk#9239 AS co_clerk_5#9256, co_shippriority#9240 AS co_shippriority_5#9257, co_comment#9241 AS co_comment_5#9258, co_orderdate#9242 AS co_orderdate_5#9259]
                  +- Relation[rid#9226,cpfk_customer_orders#9227,cfpk_orders_customer#9228,cval_orders_o_orderstatus#9229,cval_orders_o_totalprice#9230,cval_orders_o_orderpriority#9231,cval_orders_o_clerk#9232,cval_orders_o_shippriority#9233,cval_orders_o_comment#9234,cval_orders_o_orderdate#9235,co_orderstatus#9236,co_totalprice#9237,co_orderpriority#9238,co_clerk#9239,co_shippriority#9240,co_comment#9241,co_orderdate#9242] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 105191ms
query=q1, count=6001215, duration=2924
query=q10, count=1478870, duration=61495
query=q11, count=31680, duration=10387
query=q12, count=857401, duration=21269
query=q13, count=1500000, duration=12640
query=q14, count=6001215, duration=82355
query=q15, count=6001215, duration=76846
query=q16, count=15780, duration=11070
query=q17, count=6088, duration=71845
query=q18, count=6001215, duration=118128
query=q19, count=205, duration=362698
query=q2, count=3162, duration=21318
query=q20, count=632, duration=11520
query=q21a, count=597422, duration=248040
query=q22, count=1500000, duration=12711
query=q3, count=1214743, duration=114602
query=q4, count=6001215, duration=52462
query=q5, count=1206514, duration=163007
query=q6, count=6001215, duration=2940
query=q7, count=9735, duration=105191
query=q8, count=8716, duration=94768
query=q9a, count=6001215, duration=244310
query=q9b, count=6001215, duration=161642
