20/04/26 21:40:05 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10758ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sun Apr 26 21:40:09 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sun Apr 26 21:40:10 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sun Apr 26 21:40:10 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sun Apr 26 21:40:10 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sun Apr 26 21:40:10 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sun Apr 26 21:40:14 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sun Apr 26 21:40:18 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sun Apr 26 21:40:18 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/26 21:40:19 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:40:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2081L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:40:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:40:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:40:20 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/26 21:40:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2081L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#2119 AS rid_1#2164, cpfk_orders_lineitem#2120 AS cpfk_orders_lineitem_1#2165, cpfk_supplier_lineitem#2121 AS cpfk_supplier_lineitem_1#2166, cfpk_lineitem_supplier#2122 AS cfpk_lineitem_supplier_1#2167, cfpk_lineitem_partsupp#2123 AS cfpk_lineitem_partsupp_1#2168, cpfk_part_lineitem#2124 AS cpfk_part_lineitem_1#2169, cfpk_lineitem_part#2125 AS cfpk_lineitem_part_1#2170, cpfk_partsupp_lineitem#2126 AS cpfk_partsupp_lineitem_1#2171, cfpk_lineitem_orders#2127 AS cfpk_lineitem_orders_1#2172, cval_lineitem_l_quantity#2128 AS cval_lineitem_l_quantity_1#2173, cval_lineitem_l_extendedprice#2129 AS cval_lineitem_l_extendedprice_1#2174, cval_lineitem_l_discount#2130 AS cval_lineitem_l_discount_1#2175, cval_lineitem_l_tax#2131 AS cval_lineitem_l_tax_1#2176, cval_lineitem_l_returnflag#2132 AS cval_lineitem_l_returnflag_1#2177, cval_lineitem_l_linestatus#2133 AS cval_lineitem_l_linestatus_1#2178, cval_lineitem_l_commitdate#2134 AS cval_lineitem_l_commitdate_1#2179, cval_lineitem_l_receiptdate#2135 AS cval_lineitem_l_receiptdate_1#2180, cval_lineitem_l_shipinstruct#2136 AS cval_lineitem_l_shipinstruct_1#2181, cval_lineitem_l_shipmode#2137 AS cval_lineitem_l_shipmode_1#2182, cval_lineitem_l_comment#2138 AS cval_lineitem_l_comment_1#2183, cval_lineitem_l_shipdate#2139 AS cval_lineitem_l_shipdate_1#2184, cdepval_lineitem_l_quantity#2140 AS cdepval_lineitem_l_quantity_1#2185, cdepval_lineitem_l_extendedprice#2141 AS cdepval_lineitem_l_extendedprice_1#2186, cdepval_lineitem_l_discount#2142 AS cdepval_lineitem_l_discount_1#2187, ... 21 more fields]
         :  +- Relation[rid#2119,cpfk_orders_lineitem#2120,cpfk_supplier_lineitem#2121,cfpk_lineitem_supplier#2122,cfpk_lineitem_partsupp#2123,cpfk_part_lineitem#2124,cfpk_lineitem_part#2125,cpfk_partsupp_lineitem#2126,cfpk_lineitem_orders#2127,cval_lineitem_l_quantity#2128,cval_lineitem_l_extendedprice#2129,cval_lineitem_l_discount#2130,cval_lineitem_l_tax#2131,cval_lineitem_l_returnflag#2132,cval_lineitem_l_linestatus#2133,cval_lineitem_l_commitdate#2134,cval_lineitem_l_receiptdate#2135,cval_lineitem_l_shipinstruct#2136,cval_lineitem_l_shipmode#2137,cval_lineitem_l_comment#2138,cval_lineitem_l_shipdate#2139,cdepval_lineitem_l_quantity#2140,cdepval_lineitem_l_extendedprice#2141,cdepval_lineitem_l_discount#2142,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2083 AS rid_0#2101, cpfk_nation_supplier#2084 AS cpfk_nation_supplier_0#2102, cfpk_supplier_nation#2085 AS cfpk_supplier_nation_0#2103, cval_supplier_s_name#2086 AS cval_supplier_s_name_0#2104, cval_supplier_s_address#2087 AS cval_supplier_s_address_0#2105, cval_supplier_s_phone#2088 AS cval_supplier_s_phone_0#2106, cval_supplier_s_acctbal#2089 AS cval_supplier_s_acctbal_0#2107, cval_supplier_s_comment#2090 AS cval_supplier_s_comment_0#2108, cdepval_supplier_s_name#2091 AS cdepval_supplier_s_name_0#2109, cdepval_supplier_s_address#2092 AS cdepval_supplier_s_address_0#2110, cdepval_supplier_s_phone#2093 AS cdepval_supplier_s_phone_0#2111, cdepval_supplier_s_acctbal#2094 AS cdepval_supplier_s_acctbal_0#2112, cdepval_supplier_s_comment#2095 AS cdepval_supplier_s_comment_0#2113, cs_name#2096 AS cs_name_0#2114, cs_address#2097 AS cs_address_0#2115, cs_phone#2098 AS cs_phone_0#2116, cs_acctbal#2099 AS cs_acctbal_0#2117, cs_comment#2100 AS cs_comment_0#2118]
            +- Relation[rid#2083,cpfk_nation_supplier#2084,cfpk_supplier_nation#2085,cval_supplier_s_name#2086,cval_supplier_s_address#2087,cval_supplier_s_phone#2088,cval_supplier_s_acctbal#2089,cval_supplier_s_comment#2090,cdepval_supplier_s_name#2091,cdepval_supplier_s_address#2092,cdepval_supplier_s_phone#2093,cdepval_supplier_s_acctbal#2094,cdepval_supplier_s_comment#2095,cs_name#2096,cs_address#2097,cs_phone#2098,cs_acctbal#2099,cs_comment#2100] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17757ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/26 21:40:37 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:40:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2276L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 21:40:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:40:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:40:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:40:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:40:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:40:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:40:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:40:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:40:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:40:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2276L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#2278 AS rid_0#2323, cpfk_orders_lineitem#2279 AS cpfk_orders_lineitem_0#2324, cpfk_supplier_lineitem#2280 AS cpfk_supplier_lineitem_0#2325, cfpk_lineitem_supplier#2281 AS cfpk_lineitem_supplier_0#2326, cfpk_lineitem_partsupp#2282 AS cfpk_lineitem_partsupp_0#2327, cpfk_part_lineitem#2283 AS cpfk_part_lineitem_0#2328, cfpk_lineitem_part#2284 AS cfpk_lineitem_part_0#2329, cpfk_partsupp_lineitem#2285 AS cpfk_partsupp_lineitem_0#2330, cfpk_lineitem_orders#2286 AS cfpk_lineitem_orders_0#2331, cval_lineitem_l_quantity#2287 AS cval_lineitem_l_quantity_0#2332, cval_lineitem_l_extendedprice#2288 AS cval_lineitem_l_extendedprice_0#2333, cval_lineitem_l_discount#2289 AS cval_lineitem_l_discount_0#2334, cval_lineitem_l_tax#2290 AS cval_lineitem_l_tax_0#2335, cval_lineitem_l_returnflag#2291 AS cval_lineitem_l_returnflag_0#2336, cval_lineitem_l_linestatus#2292 AS cval_lineitem_l_linestatus_0#2337, cval_lineitem_l_commitdate#2293 AS cval_lineitem_l_commitdate_0#2338, cval_lineitem_l_receiptdate#2294 AS cval_lineitem_l_receiptdate_0#2339, cval_lineitem_l_shipinstruct#2295 AS cval_lineitem_l_shipinstruct_0#2340, cval_lineitem_l_shipmode#2296 AS cval_lineitem_l_shipmode_0#2341, cval_lineitem_l_comment#2297 AS cval_lineitem_l_comment_0#2342, cval_lineitem_l_shipdate#2298 AS cval_lineitem_l_shipdate_0#2343, cdepval_lineitem_l_quantity#2299 AS cdepval_lineitem_l_quantity_0#2344, cdepval_lineitem_l_extendedprice#2300 AS cdepval_lineitem_l_extendedprice_0#2345, cdepval_lineitem_l_discount#2301 AS cdepval_lineitem_l_discount_0#2346, ... 21 more fields]
         :  +- Relation[rid#2278,cpfk_orders_lineitem#2279,cpfk_supplier_lineitem#2280,cfpk_lineitem_supplier#2281,cfpk_lineitem_partsupp#2282,cpfk_part_lineitem#2283,cfpk_lineitem_part#2284,cpfk_partsupp_lineitem#2285,cfpk_lineitem_orders#2286,cval_lineitem_l_quantity#2287,cval_lineitem_l_extendedprice#2288,cval_lineitem_l_discount#2289,cval_lineitem_l_tax#2290,cval_lineitem_l_returnflag#2291,cval_lineitem_l_linestatus#2292,cval_lineitem_l_commitdate#2293,cval_lineitem_l_receiptdate#2294,cval_lineitem_l_shipinstruct#2295,cval_lineitem_l_shipmode#2296,cval_lineitem_l_comment#2297,cval_lineitem_l_shipdate#2298,cdepval_lineitem_l_quantity#2299,cdepval_lineitem_l_extendedprice#2300,cdepval_lineitem_l_discount#2301,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#2737, cpfk_region_nation_4#2738, cfpk_nation_region_4#2739, cval_nation_n_name_4#2740, cval_nation_n_comment_4#2741, cdepval_nation_n_name_4#2742, cdepval_nation_n_comment_4#2743, cn_name_4#2744, cn_comment_4#2745, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
            :  :  +- Project [rid#2728 AS rid_4#2737, cpfk_region_nation#2729 AS cpfk_region_nation_4#2738, cfpk_nation_region#2730 AS cfpk_nation_region_4#2739, cval_nation_n_name#2731 AS cval_nation_n_name_4#2740, cval_nation_n_comment#2732 AS cval_nation_n_comment_4#2741, cdepval_nation_n_name#2733 AS cdepval_nation_n_name_4#2742, cdepval_nation_n_comment#2734 AS cdepval_nation_n_comment_4#2743, cn_name#2735 AS cn_name_4#2744, cn_comment#2736 AS cn_comment_4#2745]
            :  :     +- Relation[rid#2728,cpfk_region_nation#2729,cfpk_nation_region#2730,cval_nation_n_name#2731,cval_nation_n_comment#2732,cdepval_nation_n_name#2733,cdepval_nation_n_comment#2734,cn_name#2735,cn_comment#2736] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#2782 AS rid_3#2800, cpfk_nation_supplier#2783 AS cpfk_nation_supplier_3#2801, cfpk_supplier_nation#2784 AS cfpk_supplier_nation_3#2802, cval_supplier_s_name#2785 AS cval_supplier_s_name_3#2803, cval_supplier_s_address#2786 AS cval_supplier_s_address_3#2804, cval_supplier_s_phone#2787 AS cval_supplier_s_phone_3#2805, cval_supplier_s_acctbal#2788 AS cval_supplier_s_acctbal_3#2806, cval_supplier_s_comment#2789 AS cval_supplier_s_comment_3#2807, cdepval_supplier_s_name#2790 AS cdepval_supplier_s_name_3#2808, cdepval_supplier_s_address#2791 AS cdepval_supplier_s_address_3#2809, cdepval_supplier_s_phone#2792 AS cdepval_supplier_s_phone_3#2810, cdepval_supplier_s_acctbal#2793 AS cdepval_supplier_s_acctbal_3#2811, cdepval_supplier_s_comment#2794 AS cdepval_supplier_s_comment_3#2812, cs_name#2795 AS cs_name_3#2813, cs_address#2796 AS cs_address_3#2814, cs_phone#2797 AS cs_phone_3#2815, cs_acctbal#2798 AS cs_acctbal_3#2816, cs_comment#2799 AS cs_comment_3#2817]
            :        +- Relation[rid#2782,cpfk_nation_supplier#2783,cfpk_supplier_nation#2784,cval_supplier_s_name#2785,cval_supplier_s_address#2786,cval_supplier_s_phone#2787,cval_supplier_s_acctbal#2788,cval_supplier_s_comment#2789,cdepval_supplier_s_name#2790,cdepval_supplier_s_address#2791,cdepval_supplier_s_phone#2792,cdepval_supplier_s_acctbal#2793,cdepval_supplier_s_comment#2794,cs_name#2795,cs_address#2796,cs_phone#2797,cs_acctbal#2798,cs_comment#2799] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'DexPkfkMaterializationAwareJoin orders~lineitem, 'cpfk_orders_lineitem_2, 'rid_1, NotMaterialized, NotMaterialized, [rid_1#2392, cpfk_customer_orders_1#2393, cfpk_orders_customer_1#2394, cval_orders_o_orderstatus_1#2395, cval_orders_o_totalprice_1#2396, cval_orders_o_orderpriority_1#2397, cval_orders_o_clerk_1#2398, cval_orders_o_shippriority_1#2399, cval_orders_o_comment_1#2400, cval_orders_o_orderdate_1#2401, cdepval_orders_o_orderstatus_1#2402, cdepval_orders_o_totalprice_1#2403, cdepval_orders_o_orderpriority_1#2404, cdepval_orders_o_clerk_1#2405, cdepval_orders_o_shippriority_1#2406, cdepval_orders_o_comment_1#2407, cdepval_orders_o_orderdate_1#2408, co_orderstatus_1#2409, co_totalprice_1#2410, co_orderpriority_1#2411, co_clerk_1#2412, co_shippriority_1#2413, co_comment_1#2414, co_orderdate_1#2415, 'rid_2]
               :  :  :- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
               :  :  :  +- Project [rid#2368 AS rid_1#2392, cpfk_customer_orders#2369 AS cpfk_customer_orders_1#2393, cfpk_orders_customer#2370 AS cfpk_orders_customer_1#2394, cval_orders_o_orderstatus#2371 AS cval_orders_o_orderstatus_1#2395, cval_orders_o_totalprice#2372 AS cval_orders_o_totalprice_1#2396, cval_orders_o_orderpriority#2373 AS cval_orders_o_orderpriority_1#2397, cval_orders_o_clerk#2374 AS cval_orders_o_clerk_1#2398, cval_orders_o_shippriority#2375 AS cval_orders_o_shippriority_1#2399, cval_orders_o_comment#2376 AS cval_orders_o_comment_1#2400, cval_orders_o_orderdate#2377 AS cval_orders_o_orderdate_1#2401, cdepval_orders_o_orderstatus#2378 AS cdepval_orders_o_orderstatus_1#2402, cdepval_orders_o_totalprice#2379 AS cdepval_orders_o_totalprice_1#2403, cdepval_orders_o_orderpriority#2380 AS cdepval_orders_o_orderpriority_1#2404, cdepval_orders_o_clerk#2381 AS cdepval_orders_o_clerk_1#2405, cdepval_orders_o_shippriority#2382 AS cdepval_orders_o_shippriority_1#2406, cdepval_orders_o_comment#2383 AS cdepval_orders_o_comment_1#2407, cdepval_orders_o_orderdate#2384 AS cdepval_orders_o_orderdate_1#2408, co_orderstatus#2385 AS co_orderstatus_1#2409, co_totalprice#2386 AS co_totalprice_1#2410, co_orderpriority#2387 AS co_orderpriority_1#2411, co_clerk#2388 AS co_clerk_1#2412, co_shippriority#2389 AS co_shippriority_1#2413, co_comment#2390 AS co_comment_1#2414, co_orderdate#2391 AS co_orderdate_1#2415]
               :  :  :     +- Relation[rid#2368,cpfk_customer_orders#2369,cfpk_orders_customer#2370,cval_orders_o_orderstatus#2371,cval_orders_o_totalprice#2372,cval_orders_o_orderpriority#2373,cval_orders_o_clerk#2374,cval_orders_o_shippriority#2375,cval_orders_o_comment#2376,cval_orders_o_orderdate#2377,cdepval_orders_o_orderstatus#2378,cdepval_orders_o_totalprice#2379,cdepval_orders_o_orderpriority#2380,cdepval_orders_o_clerk#2381,cdepval_orders_o_shippriority#2382,cdepval_orders_o_comment#2383,cdepval_orders_o_orderdate#2384,co_orderstatus#2385,co_totalprice#2386,co_orderpriority#2387,co_clerk#2388,co_shippriority#2389,co_comment#2390,co_orderdate#2391] JDBCRelation(torders) [numPartitions=1]
               :  :  +- 'Project ['cpfk_orders_lineitem_2, 'rid_2]
               :  :     +- Project [rid#2602 AS rid_2#2647, cpfk_orders_lineitem#2603 AS cpfk_orders_lineitem_2#2648, cpfk_supplier_lineitem#2604 AS cpfk_supplier_lineitem_2#2649, cfpk_lineitem_supplier#2605 AS cfpk_lineitem_supplier_2#2650, cfpk_lineitem_partsupp#2606 AS cfpk_lineitem_partsupp_2#2651, cpfk_part_lineitem#2607 AS cpfk_part_lineitem_2#2652, cfpk_lineitem_part#2608 AS cfpk_lineitem_part_2#2653, cpfk_partsupp_lineitem#2609 AS cpfk_partsupp_lineitem_2#2654, cfpk_lineitem_orders#2610 AS cfpk_lineitem_orders_2#2655, cval_lineitem_l_quantity#2611 AS cval_lineitem_l_quantity_2#2656, cval_lineitem_l_extendedprice#2612 AS cval_lineitem_l_extendedprice_2#2657, cval_lineitem_l_discount#2613 AS cval_lineitem_l_discount_2#2658, cval_lineitem_l_tax#2614 AS cval_lineitem_l_tax_2#2659, cval_lineitem_l_returnflag#2615 AS cval_lineitem_l_returnflag_2#2660, cval_lineitem_l_linestatus#2616 AS cval_lineitem_l_linestatus_2#2661, cval_lineitem_l_commitdate#2617 AS cval_lineitem_l_commitdate_2#2662, cval_lineitem_l_receiptdate#2618 AS cval_lineitem_l_receiptdate_2#2663, cval_lineitem_l_shipinstruct#2619 AS cval_lineitem_l_shipinstruct_2#2664, cval_lineitem_l_shipmode#2620 AS cval_lineitem_l_shipmode_2#2665, cval_lineitem_l_comment#2621 AS cval_lineitem_l_comment_2#2666, cval_lineitem_l_shipdate#2622 AS cval_lineitem_l_shipdate_2#2667, cdepval_lineitem_l_quantity#2623 AS cdepval_lineitem_l_quantity_2#2668, cdepval_lineitem_l_extendedprice#2624 AS cdepval_lineitem_l_extendedprice_2#2669, cdepval_lineitem_l_discount#2625 AS cdepval_lineitem_l_discount_2#2670, ... 21 more fields]
               :  :        +- Relation[rid#2602,cpfk_orders_lineitem#2603,cpfk_supplier_lineitem#2604,cfpk_lineitem_supplier#2605,cfpk_lineitem_partsupp#2606,cpfk_part_lineitem#2607,cfpk_lineitem_part#2608,cpfk_partsupp_lineitem#2609,cfpk_lineitem_orders#2610,cval_lineitem_l_quantity#2611,cval_lineitem_l_extendedprice#2612,cval_lineitem_l_discount#2613,cval_lineitem_l_tax#2614,cval_lineitem_l_returnflag#2615,cval_lineitem_l_linestatus#2616,cval_lineitem_l_commitdate#2617,cval_lineitem_l_receiptdate#2618,cval_lineitem_l_shipinstruct#2619,cval_lineitem_l_shipmode#2620,cval_lineitem_l_comment#2621,cval_lineitem_l_shipdate#2622,cdepval_lineitem_l_quantity#2623,cdepval_lineitem_l_extendedprice#2624,cdepval_lineitem_l_discount#2625,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               :  +- Project [rid#2464 AS rid_2#2509, cpfk_orders_lineitem#2465 AS cpfk_orders_lineitem_2#2510, cpfk_supplier_lineitem#2466 AS cpfk_supplier_lineitem_2#2511, cfpk_lineitem_supplier#2467 AS cfpk_lineitem_supplier_2#2512, cfpk_lineitem_partsupp#2468 AS cfpk_lineitem_partsupp_2#2513, cpfk_part_lineitem#2469 AS cpfk_part_lineitem_2#2514, cfpk_lineitem_part#2470 AS cfpk_lineitem_part_2#2515, cpfk_partsupp_lineitem#2471 AS cpfk_partsupp_lineitem_2#2516, cfpk_lineitem_orders#2472 AS cfpk_lineitem_orders_2#2517, cval_lineitem_l_quantity#2473 AS cval_lineitem_l_quantity_2#2518, cval_lineitem_l_extendedprice#2474 AS cval_lineitem_l_extendedprice_2#2519, cval_lineitem_l_discount#2475 AS cval_lineitem_l_discount_2#2520, cval_lineitem_l_tax#2476 AS cval_lineitem_l_tax_2#2521, cval_lineitem_l_returnflag#2477 AS cval_lineitem_l_returnflag_2#2522, cval_lineitem_l_linestatus#2478 AS cval_lineitem_l_linestatus_2#2523, cval_lineitem_l_commitdate#2479 AS cval_lineitem_l_commitdate_2#2524, cval_lineitem_l_receiptdate#2480 AS cval_lineitem_l_receiptdate_2#2525, cval_lineitem_l_shipinstruct#2481 AS cval_lineitem_l_shipinstruct_2#2526, cval_lineitem_l_shipmode#2482 AS cval_lineitem_l_shipmode_2#2527, cval_lineitem_l_comment#2483 AS cval_lineitem_l_comment_2#2528, cval_lineitem_l_shipdate#2484 AS cval_lineitem_l_shipdate_2#2529, cdepval_lineitem_l_quantity#2485 AS cdepval_lineitem_l_quantity_2#2530, cdepval_lineitem_l_extendedprice#2486 AS cdepval_lineitem_l_extendedprice_2#2531, cdepval_lineitem_l_discount#2487 AS cdepval_lineitem_l_discount_2#2532, ... 21 more fields]
               :     +- Relation[rid#2464,cpfk_orders_lineitem#2465,cpfk_supplier_lineitem#2466,cfpk_lineitem_supplier#2467,cfpk_lineitem_partsupp#2468,cpfk_part_lineitem#2469,cfpk_lineitem_part#2470,cpfk_partsupp_lineitem#2471,cfpk_lineitem_orders#2472,cval_lineitem_l_quantity#2473,cval_lineitem_l_extendedprice#2474,cval_lineitem_l_discount#2475,cval_lineitem_l_tax#2476,cval_lineitem_l_returnflag#2477,cval_lineitem_l_linestatus#2478,cval_lineitem_l_commitdate#2479,cval_lineitem_l_receiptdate#2480,cval_lineitem_l_shipinstruct#2481,cval_lineitem_l_shipmode#2482,cval_lineitem_l_comment#2483,cval_lineitem_l_shipdate#2484,cdepval_lineitem_l_quantity#2485,cdepval_lineitem_l_extendedprice#2486,cdepval_lineitem_l_discount#2487,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               +- Project [rid#2692 AS rid_3#2710, cpfk_nation_supplier#2693 AS cpfk_nation_supplier_3#2711, cfpk_supplier_nation#2694 AS cfpk_supplier_nation_3#2712, cval_supplier_s_name#2695 AS cval_supplier_s_name_3#2713, cval_supplier_s_address#2696 AS cval_supplier_s_address_3#2714, cval_supplier_s_phone#2697 AS cval_supplier_s_phone_3#2715, cval_supplier_s_acctbal#2698 AS cval_supplier_s_acctbal_3#2716, cval_supplier_s_comment#2699 AS cval_supplier_s_comment_3#2717, cdepval_supplier_s_name#2700 AS cdepval_supplier_s_name_3#2718, cdepval_supplier_s_address#2701 AS cdepval_supplier_s_address_3#2719, cdepval_supplier_s_phone#2702 AS cdepval_supplier_s_phone_3#2720, cdepval_supplier_s_acctbal#2703 AS cdepval_supplier_s_acctbal_3#2721, cdepval_supplier_s_comment#2704 AS cdepval_supplier_s_comment_3#2722, cs_name#2705 AS cs_name_3#2723, cs_address#2706 AS cs_address_3#2724, cs_phone#2707 AS cs_phone_3#2725, cs_acctbal#2708 AS cs_acctbal_3#2726, cs_comment#2709 AS cs_comment_3#2727]
                  +- Relation[rid#2692,cpfk_nation_supplier#2693,cfpk_supplier_nation#2694,cval_supplier_s_name#2695,cval_supplier_s_address#2696,cval_supplier_s_phone#2697,cval_supplier_s_acctbal#2698,cval_supplier_s_comment#2699,cdepval_supplier_s_name#2700,cdepval_supplier_s_address#2701,cdepval_supplier_s_phone#2702,cdepval_supplier_s_acctbal#2703,cdepval_supplier_s_comment#2704,cs_name#2705,cs_address#2706,cs_phone#2707,cs_acctbal#2708,cs_comment#2709] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 158746ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/26 21:43:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:43:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2964L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:43:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#2964L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#2966 AS rid_0#3011, cpfk_orders_lineitem#2967 AS cpfk_orders_lineitem_0#3012, cpfk_supplier_lineitem#2968 AS cpfk_supplier_lineitem_0#3013, cfpk_lineitem_supplier#2969 AS cfpk_lineitem_supplier_0#3014, cfpk_lineitem_partsupp#2970 AS cfpk_lineitem_partsupp_0#3015, cpfk_part_lineitem#2971 AS cpfk_part_lineitem_0#3016, cfpk_lineitem_part#2972 AS cfpk_lineitem_part_0#3017, cpfk_partsupp_lineitem#2973 AS cpfk_partsupp_lineitem_0#3018, cfpk_lineitem_orders#2974 AS cfpk_lineitem_orders_0#3019, cval_lineitem_l_quantity#2975 AS cval_lineitem_l_quantity_0#3020, cval_lineitem_l_extendedprice#2976 AS cval_lineitem_l_extendedprice_0#3021, cval_lineitem_l_discount#2977 AS cval_lineitem_l_discount_0#3022, cval_lineitem_l_tax#2978 AS cval_lineitem_l_tax_0#3023, cval_lineitem_l_returnflag#2979 AS cval_lineitem_l_returnflag_0#3024, cval_lineitem_l_linestatus#2980 AS cval_lineitem_l_linestatus_0#3025, cval_lineitem_l_commitdate#2981 AS cval_lineitem_l_commitdate_0#3026, cval_lineitem_l_receiptdate#2982 AS cval_lineitem_l_receiptdate_0#3027, cval_lineitem_l_shipinstruct#2983 AS cval_lineitem_l_shipinstruct_0#3028, cval_lineitem_l_shipmode#2984 AS cval_lineitem_l_shipmode_0#3029, cval_lineitem_l_comment#2985 AS cval_lineitem_l_comment_0#3030, cval_lineitem_l_shipdate#2986 AS cval_lineitem_l_shipdate_0#3031, cdepval_lineitem_l_quantity#2987 AS cdepval_lineitem_l_quantity_0#3032, cdepval_lineitem_l_extendedprice#2988 AS cdepval_lineitem_l_extendedprice_0#3033, cdepval_lineitem_l_discount#2989 AS cdepval_lineitem_l_discount_0#3034, ... 21 more fields]
         +- Relation[rid#2966,cpfk_orders_lineitem#2967,cpfk_supplier_lineitem#2968,cfpk_lineitem_supplier#2969,cfpk_lineitem_partsupp#2970,cpfk_part_lineitem#2971,cfpk_lineitem_part#2972,cpfk_partsupp_lineitem#2973,cfpk_lineitem_orders#2974,cval_lineitem_l_quantity#2975,cval_lineitem_l_extendedprice#2976,cval_lineitem_l_discount#2977,cval_lineitem_l_tax#2978,cval_lineitem_l_returnflag#2979,cval_lineitem_l_linestatus#2980,cval_lineitem_l_commitdate#2981,cval_lineitem_l_receiptdate#2982,cval_lineitem_l_shipinstruct#2983,cval_lineitem_l_shipmode#2984,cval_lineitem_l_comment#2985,cval_lineitem_l_shipdate#2986,cdepval_lineitem_l_quantity#2987,cdepval_lineitem_l_extendedprice#2988,cdepval_lineitem_l_discount#2989,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2369ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 21:43:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:43:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3110L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:43:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:43:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:43:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:43:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:43:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:43:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:43:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:43:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:43:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:43:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:43:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:43:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3110L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#3244 AS rid_4#3289, cpfk_orders_lineitem#3245 AS cpfk_orders_lineitem_4#3290, cpfk_supplier_lineitem#3246 AS cpfk_supplier_lineitem_4#3291, cfpk_lineitem_supplier#3247 AS cfpk_lineitem_supplier_4#3292, cfpk_lineitem_partsupp#3248 AS cfpk_lineitem_partsupp_4#3293, cpfk_part_lineitem#3249 AS cpfk_part_lineitem_4#3294, cfpk_lineitem_part#3250 AS cfpk_lineitem_part_4#3295, cpfk_partsupp_lineitem#3251 AS cpfk_partsupp_lineitem_4#3296, cfpk_lineitem_orders#3252 AS cfpk_lineitem_orders_4#3297, cval_lineitem_l_quantity#3253 AS cval_lineitem_l_quantity_4#3298, cval_lineitem_l_extendedprice#3254 AS cval_lineitem_l_extendedprice_4#3299, cval_lineitem_l_discount#3255 AS cval_lineitem_l_discount_4#3300, cval_lineitem_l_tax#3256 AS cval_lineitem_l_tax_4#3301, cval_lineitem_l_returnflag#3257 AS cval_lineitem_l_returnflag_4#3302, cval_lineitem_l_linestatus#3258 AS cval_lineitem_l_linestatus_4#3303, cval_lineitem_l_commitdate#3259 AS cval_lineitem_l_commitdate_4#3304, cval_lineitem_l_receiptdate#3260 AS cval_lineitem_l_receiptdate_4#3305, cval_lineitem_l_shipinstruct#3261 AS cval_lineitem_l_shipinstruct_4#3306, cval_lineitem_l_shipmode#3262 AS cval_lineitem_l_shipmode_4#3307, cval_lineitem_l_comment#3263 AS cval_lineitem_l_comment_4#3308, cval_lineitem_l_shipdate#3264 AS cval_lineitem_l_shipdate_4#3309, cdepval_lineitem_l_quantity#3265 AS cdepval_lineitem_l_quantity_4#3310, cdepval_lineitem_l_extendedprice#3266 AS cdepval_lineitem_l_extendedprice_4#3311, cdepval_lineitem_l_discount#3267 AS cdepval_lineitem_l_discount_4#3312, ... 21 more fields]
         :  :  +- Relation[rid#3244,cpfk_orders_lineitem#3245,cpfk_supplier_lineitem#3246,cfpk_lineitem_supplier#3247,cfpk_lineitem_partsupp#3248,cpfk_part_lineitem#3249,cfpk_lineitem_part#3250,cpfk_partsupp_lineitem#3251,cfpk_lineitem_orders#3252,cval_lineitem_l_quantity#3253,cval_lineitem_l_extendedprice#3254,cval_lineitem_l_discount#3255,cval_lineitem_l_tax#3256,cval_lineitem_l_returnflag#3257,cval_lineitem_l_linestatus#3258,cval_lineitem_l_commitdate#3259,cval_lineitem_l_receiptdate#3260,cval_lineitem_l_shipinstruct#3261,cval_lineitem_l_shipmode#3262,cval_lineitem_l_comment#3263,cval_lineitem_l_shipdate#3264,cdepval_lineitem_l_quantity#3265,cdepval_lineitem_l_extendedprice#3266,cdepval_lineitem_l_discount#3267,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#3166 AS rid_2#3180, cpfk_part_partsupp#3167 AS cpfk_part_partsupp_2#3181, cfpk_partsupp_part#3168 AS cfpk_partsupp_part_2#3182, cpfk_supplier_partsupp#3169 AS cpfk_supplier_partsupp_2#3183, cfpk_partsupp_supplier#3170 AS cfpk_partsupp_supplier_2#3184, cval_partsupp_ps_availqty#3171 AS cval_partsupp_ps_availqty_2#3185, cval_partsupp_ps_supplycost#3172 AS cval_partsupp_ps_supplycost_2#3186, cval_partsupp_ps_comment#3173 AS cval_partsupp_ps_comment_2#3187, cdepval_partsupp_ps_availqty#3174 AS cdepval_partsupp_ps_availqty_2#3188, cdepval_partsupp_ps_supplycost#3175 AS cdepval_partsupp_ps_supplycost_2#3189, cdepval_partsupp_ps_comment#3176 AS cdepval_partsupp_ps_comment_2#3190, cps_availqty#3177 AS cps_availqty_2#3191, cps_supplycost#3178 AS cps_supplycost_2#3192, cps_comment#3179 AS cps_comment_2#3193]
         :     :  :  +- Relation[rid#3166,cpfk_part_partsupp#3167,cfpk_partsupp_part#3168,cpfk_supplier_partsupp#3169,cfpk_partsupp_supplier#3170,cval_partsupp_ps_availqty#3171,cval_partsupp_ps_supplycost#3172,cval_partsupp_ps_comment#3173,cdepval_partsupp_ps_availqty#3174,cdepval_partsupp_ps_supplycost#3175,cdepval_partsupp_ps_comment#3176,cps_availqty#3177,cps_supplycost#3178,cps_comment#3179] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#3130 AS rid_1#3148, cpfk_nation_supplier#3131 AS cpfk_nation_supplier_1#3149, cfpk_supplier_nation#3132 AS cfpk_supplier_nation_1#3150, cval_supplier_s_name#3133 AS cval_supplier_s_name_1#3151, cval_supplier_s_address#3134 AS cval_supplier_s_address_1#3152, cval_supplier_s_phone#3135 AS cval_supplier_s_phone_1#3153, cval_supplier_s_acctbal#3136 AS cval_supplier_s_acctbal_1#3154, cval_supplier_s_comment#3137 AS cval_supplier_s_comment_1#3155, cdepval_supplier_s_name#3138 AS cdepval_supplier_s_name_1#3156, cdepval_supplier_s_address#3139 AS cdepval_supplier_s_address_1#3157, cdepval_supplier_s_phone#3140 AS cdepval_supplier_s_phone_1#3158, cdepval_supplier_s_acctbal#3141 AS cdepval_supplier_s_acctbal_1#3159, cdepval_supplier_s_comment#3142 AS cdepval_supplier_s_comment_1#3160, cs_name#3143 AS cs_name_1#3161, cs_address#3144 AS cs_address_1#3162, cs_phone#3145 AS cs_phone_1#3163, cs_acctbal#3146 AS cs_acctbal_1#3164, cs_comment#3147 AS cs_comment_1#3165]
         :     :     :  +- Relation[rid#3130,cpfk_nation_supplier#3131,cfpk_supplier_nation#3132,cval_supplier_s_name#3133,cval_supplier_s_address#3134,cval_supplier_s_phone#3135,cval_supplier_s_acctbal#3136,cval_supplier_s_comment#3137,cdepval_supplier_s_name#3138,cdepval_supplier_s_address#3139,cdepval_supplier_s_phone#3140,cdepval_supplier_s_acctbal#3141,cdepval_supplier_s_comment#3142,cs_name#3143,cs_address#3144,cs_phone#3145,cs_acctbal#3146,cs_comment#3147] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#3112 AS rid_0#3121, cpfk_region_nation#3113 AS cpfk_region_nation_0#3122, cfpk_nation_region#3114 AS cfpk_nation_region_0#3123, cval_nation_n_name#3115 AS cval_nation_n_name_0#3124, cval_nation_n_comment#3116 AS cval_nation_n_comment_0#3125, cdepval_nation_n_name#3117 AS cdepval_nation_n_name_0#3126, cdepval_nation_n_comment#3118 AS cdepval_nation_n_comment_0#3127, cn_name#3119 AS cn_name_0#3128, cn_comment#3120 AS cn_comment_0#3129]
         :     :        +- Relation[rid#3112,cpfk_region_nation#3113,cfpk_nation_region#3114,cval_nation_n_name#3115,cval_nation_n_comment#3116,cdepval_nation_n_name#3117,cdepval_nation_n_comment#3118,cn_name#3119,cn_comment#3120] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#3194 AS rid_3#3219, cval_part_p_name#3195 AS cval_part_p_name_3#3220, cval_part_p_mfgr#3196 AS cval_part_p_mfgr_3#3221, cval_part_p_type#3197 AS cval_part_p_type_3#3222, cval_part_p_size#3198 AS cval_part_p_size_3#3223, cval_part_p_container#3199 AS cval_part_p_container_3#3224, cval_part_p_retailprice#3200 AS cval_part_p_retailprice_3#3225, cval_part_p_comment#3201 AS cval_part_p_comment_3#3226, cval_part_p_brand#3202 AS cval_part_p_brand_3#3227, cdepval_part_p_name#3203 AS cdepval_part_p_name_3#3228, cdepval_part_p_mfgr#3204 AS cdepval_part_p_mfgr_3#3229, cdepval_part_p_type#3205 AS cdepval_part_p_type_3#3230, cdepval_part_p_size#3206 AS cdepval_part_p_size_3#3231, cdepval_part_p_container#3207 AS cdepval_part_p_container_3#3232, cdepval_part_p_retailprice#3208 AS cdepval_part_p_retailprice_3#3233, cdepval_part_p_comment#3209 AS cdepval_part_p_comment_3#3234, cdepval_part_p_brand#3210 AS cdepval_part_p_brand_3#3235, cp_name#3211 AS cp_name_3#3236, cp_mfgr#3212 AS cp_mfgr_3#3237, cp_type#3213 AS cp_type_3#3238, cp_size#3214 AS cp_size_3#3239, cp_container#3215 AS cp_container_3#3240, cp_retailprice#3216 AS cp_retailprice_3#3241, cp_comment#3217 AS cp_comment_3#3242, cp_brand#3218 AS cp_brand_3#3243]
         :        +- Relation[rid#3194,cval_part_p_name#3195,cval_part_p_mfgr#3196,cval_part_p_type#3197,cval_part_p_size#3198,cval_part_p_container#3199,cval_part_p_retailprice#3200,cval_part_p_comment#3201,cval_part_p_brand#3202,cdepval_part_p_name#3203,cdepval_part_p_mfgr#3204,cdepval_part_p_type#3205,cdepval_part_p_size#3206,cdepval_part_p_container#3207,cdepval_part_p_retailprice#3208,cdepval_part_p_comment#3209,cdepval_part_p_brand#3210,cp_name#3211,cp_mfgr#3212,cp_type#3213,cp_size#3214,cp_container#3215,cp_retailprice#3216,cp_comment#3217,cp_brand#3218] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#3334 AS rid_5#3358, cpfk_customer_orders#3335 AS cpfk_customer_orders_5#3359, cfpk_orders_customer#3336 AS cfpk_orders_customer_5#3360, cval_orders_o_orderstatus#3337 AS cval_orders_o_orderstatus_5#3361, cval_orders_o_totalprice#3338 AS cval_orders_o_totalprice_5#3362, cval_orders_o_orderpriority#3339 AS cval_orders_o_orderpriority_5#3363, cval_orders_o_clerk#3340 AS cval_orders_o_clerk_5#3364, cval_orders_o_shippriority#3341 AS cval_orders_o_shippriority_5#3365, cval_orders_o_comment#3342 AS cval_orders_o_comment_5#3366, cval_orders_o_orderdate#3343 AS cval_orders_o_orderdate_5#3367, cdepval_orders_o_orderstatus#3344 AS cdepval_orders_o_orderstatus_5#3368, cdepval_orders_o_totalprice#3345 AS cdepval_orders_o_totalprice_5#3369, cdepval_orders_o_orderpriority#3346 AS cdepval_orders_o_orderpriority_5#3370, cdepval_orders_o_clerk#3347 AS cdepval_orders_o_clerk_5#3371, cdepval_orders_o_shippriority#3348 AS cdepval_orders_o_shippriority_5#3372, cdepval_orders_o_comment#3349 AS cdepval_orders_o_comment_5#3373, cdepval_orders_o_orderdate#3350 AS cdepval_orders_o_orderdate_5#3374, co_orderstatus#3351 AS co_orderstatus_5#3375, co_totalprice#3352 AS co_totalprice_5#3376, co_orderpriority#3353 AS co_orderpriority_5#3377, co_clerk#3354 AS co_clerk_5#3378, co_shippriority#3355 AS co_shippriority_5#3379, co_comment#3356 AS co_comment_5#3380, co_orderdate#3357 AS co_orderdate_5#3381]
            +- Relation[rid#3334,cpfk_customer_orders#3335,cfpk_orders_customer#3336,cval_orders_o_orderstatus#3337,cval_orders_o_totalprice#3338,cval_orders_o_orderpriority#3339,cval_orders_o_clerk#3340,cval_orders_o_shippriority#3341,cval_orders_o_comment#3342,cval_orders_o_orderdate#3343,cdepval_orders_o_orderstatus#3344,cdepval_orders_o_totalprice#3345,cdepval_orders_o_orderpriority#3346,cdepval_orders_o_clerk#3347,cdepval_orders_o_shippriority#3348,cdepval_orders_o_comment#3349,cdepval_orders_o_orderdate#3350,co_orderstatus#3351,co_totalprice#3352,co_orderpriority#3353,co_clerk#3354,co_shippriority#3355,co_comment#3356,co_orderdate#3357] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 37593ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/26 21:43:56 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:43:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3521L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 21:43:56 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:43:56 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:43:56 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:43:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:43:56 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:43:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:43:56 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:43:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:43:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:43:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:43:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:43:56 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:43:56 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:43:56 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:43:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:43:56 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:43:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3521L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#3662, cval_part_p_name_3#3663, cval_part_p_mfgr_3#3664, cval_part_p_type_3#3665, cval_part_p_size_3#3666, cval_part_p_container_3#3667, cval_part_p_retailprice_3#3668, cval_part_p_comment_3#3669, cval_part_p_brand_3#3670, cdepval_part_p_name_3#3671, cdepval_part_p_mfgr_3#3672, cdepval_part_p_type_3#3673, cdepval_part_p_size_3#3674, cdepval_part_p_container_3#3675, cdepval_part_p_retailprice_3#3676, cdepval_part_p_comment_3#3677, cdepval_part_p_brand_3#3678, cp_name_3#3679, cp_mfgr_3#3680, cp_type_3#3681, cp_size_3#3682, cp_container_3#3683, cp_retailprice_3#3684, cp_comment_3#3685, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :  :  :  +- Project [rid#3637 AS rid_3#3662, cval_part_p_name#3638 AS cval_part_p_name_3#3663, cval_part_p_mfgr#3639 AS cval_part_p_mfgr_3#3664, cval_part_p_type#3640 AS cval_part_p_type_3#3665, cval_part_p_size#3641 AS cval_part_p_size_3#3666, cval_part_p_container#3642 AS cval_part_p_container_3#3667, cval_part_p_retailprice#3643 AS cval_part_p_retailprice_3#3668, cval_part_p_comment#3644 AS cval_part_p_comment_3#3669, cval_part_p_brand#3645 AS cval_part_p_brand_3#3670, cdepval_part_p_name#3646 AS cdepval_part_p_name_3#3671, cdepval_part_p_mfgr#3647 AS cdepval_part_p_mfgr_3#3672, cdepval_part_p_type#3648 AS cdepval_part_p_type_3#3673, cdepval_part_p_size#3649 AS cdepval_part_p_size_3#3674, cdepval_part_p_container#3650 AS cdepval_part_p_container_3#3675, cdepval_part_p_retailprice#3651 AS cdepval_part_p_retailprice_3#3676, cdepval_part_p_comment#3652 AS cdepval_part_p_comment_3#3677, cdepval_part_p_brand#3653 AS cdepval_part_p_brand_3#3678, cp_name#3654 AS cp_name_3#3679, cp_mfgr#3655 AS cp_mfgr_3#3680, cp_type#3656 AS cp_type_3#3681, cp_size#3657 AS cp_size_3#3682, cp_container#3658 AS cp_container_3#3683, cp_retailprice#3659 AS cp_retailprice_3#3684, cp_comment#3660 AS cp_comment_3#3685, cp_brand#3661 AS cp_brand_3#3686]
         :  :  :     +- Relation[rid#3637,cval_part_p_name#3638,cval_part_p_mfgr#3639,cval_part_p_type#3640,cval_part_p_size#3641,cval_part_p_container#3642,cval_part_p_retailprice#3643,cval_part_p_comment#3644,cval_part_p_brand#3645,cdepval_part_p_name#3646,cdepval_part_p_mfgr#3647,cdepval_part_p_type#3648,cdepval_part_p_size#3649,cdepval_part_p_container#3650,cdepval_part_p_retailprice#3651,cdepval_part_p_comment#3652,cdepval_part_p_brand#3653,cp_name#3654,cp_mfgr#3655,cp_type#3656,cp_size#3657,cp_container#3658,cp_retailprice#3659,cp_comment#3660,cp_brand#3661] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_4, 'rid_4]
         :  :     +- Project [rid#3815 AS rid_4#3829, cpfk_part_partsupp#3816 AS cpfk_part_partsupp_4#3830, cfpk_partsupp_part#3817 AS cfpk_partsupp_part_4#3831, cpfk_supplier_partsupp#3818 AS cpfk_supplier_partsupp_4#3832, cfpk_partsupp_supplier#3819 AS cfpk_partsupp_supplier_4#3833, cval_partsupp_ps_availqty#3820 AS cval_partsupp_ps_availqty_4#3834, cval_partsupp_ps_supplycost#3821 AS cval_partsupp_ps_supplycost_4#3835, cval_partsupp_ps_comment#3822 AS cval_partsupp_ps_comment_4#3836, cdepval_partsupp_ps_availqty#3823 AS cdepval_partsupp_ps_availqty_4#3837, cdepval_partsupp_ps_supplycost#3824 AS cdepval_partsupp_ps_supplycost_4#3838, cdepval_partsupp_ps_comment#3825 AS cdepval_partsupp_ps_comment_4#3839, cps_availqty#3826 AS cps_availqty_4#3840, cps_supplycost#3827 AS cps_supplycost_4#3841, cps_comment#3828 AS cps_comment_4#3842]
         :  :        +- Relation[rid#3815,cpfk_part_partsupp#3816,cfpk_partsupp_part#3817,cpfk_supplier_partsupp#3818,cfpk_partsupp_supplier#3819,cval_partsupp_ps_availqty#3820,cval_partsupp_ps_supplycost#3821,cval_partsupp_ps_comment#3822,cdepval_partsupp_ps_availqty#3823,cdepval_partsupp_ps_supplycost#3824,cdepval_partsupp_ps_comment#3825,cps_availqty#3826,cps_supplycost#3827,cps_comment#3828] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#3737 AS rid_4#3751, cpfk_part_partsupp#3738 AS cpfk_part_partsupp_4#3752, cfpk_partsupp_part#3739 AS cfpk_partsupp_part_4#3753, cpfk_supplier_partsupp#3740 AS cpfk_supplier_partsupp_4#3754, cfpk_partsupp_supplier#3741 AS cfpk_partsupp_supplier_4#3755, cval_partsupp_ps_availqty#3742 AS cval_partsupp_ps_availqty_4#3756, cval_partsupp_ps_supplycost#3743 AS cval_partsupp_ps_supplycost_4#3757, cval_partsupp_ps_comment#3744 AS cval_partsupp_ps_comment_4#3758, cdepval_partsupp_ps_availqty#3745 AS cdepval_partsupp_ps_availqty_4#3759, cdepval_partsupp_ps_supplycost#3746 AS cdepval_partsupp_ps_supplycost_4#3760, cdepval_partsupp_ps_comment#3747 AS cdepval_partsupp_ps_comment_4#3761, cps_availqty#3748 AS cps_availqty_4#3762, cps_supplycost#3749 AS cps_supplycost_4#3763, cps_comment#3750 AS cps_comment_4#3764]
         :     +- Relation[rid#3737,cpfk_part_partsupp#3738,cfpk_partsupp_part#3739,cpfk_supplier_partsupp#3740,cfpk_partsupp_supplier#3741,cval_partsupp_ps_availqty#3742,cval_partsupp_ps_supplycost#3743,cval_partsupp_ps_comment#3744,cdepval_partsupp_ps_availqty#3745,cdepval_partsupp_ps_supplycost#3746,cdepval_partsupp_ps_comment#3747,cps_availqty#3748,cps_supplycost#3749,cps_comment#3750] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#3601 AS rid_2#3619, cpfk_nation_supplier#3602 AS cpfk_nation_supplier_2#3620, cfpk_supplier_nation#3603 AS cfpk_supplier_nation_2#3621, cval_supplier_s_name#3604 AS cval_supplier_s_name_2#3622, cval_supplier_s_address#3605 AS cval_supplier_s_address_2#3623, cval_supplier_s_phone#3606 AS cval_supplier_s_phone_2#3624, cval_supplier_s_acctbal#3607 AS cval_supplier_s_acctbal_2#3625, cval_supplier_s_comment#3608 AS cval_supplier_s_comment_2#3626, cdepval_supplier_s_name#3609 AS cdepval_supplier_s_name_2#3627, cdepval_supplier_s_address#3610 AS cdepval_supplier_s_address_2#3628, cdepval_supplier_s_phone#3611 AS cdepval_supplier_s_phone_2#3629, cdepval_supplier_s_acctbal#3612 AS cdepval_supplier_s_acctbal_2#3630, cdepval_supplier_s_comment#3613 AS cdepval_supplier_s_comment_2#3631, cs_name#3614 AS cs_name_2#3632, cs_address#3615 AS cs_address_2#3633, cs_phone#3616 AS cs_phone_2#3634, cs_acctbal#3617 AS cs_acctbal_2#3635, cs_comment#3618 AS cs_comment_2#3636]
            :  +- Relation[rid#3601,cpfk_nation_supplier#3602,cfpk_supplier_nation#3603,cval_supplier_s_name#3604,cval_supplier_s_address#3605,cval_supplier_s_phone#3606,cval_supplier_s_acctbal#3607,cval_supplier_s_comment#3608,cdepval_supplier_s_name#3609,cdepval_supplier_s_address#3610,cdepval_supplier_s_phone#3611,cdepval_supplier_s_acctbal#3612,cdepval_supplier_s_comment#3613,cs_name#3614,cs_address#3615,cs_phone#3616,cs_acctbal#3617,cs_comment#3618] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_1))
               :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#3530, cval_region_r_name_0#3531, cval_region_r_comment_0#3532, cdepval_region_r_name_0#3533, cdepval_region_r_comment_0#3534, cr_name_0#3535, cr_comment_0#3536, 'rid_1]
               :  :- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
               :  :  +- Project [rid#3523 AS rid_0#3530, cval_region_r_name#3524 AS cval_region_r_name_0#3531, cval_region_r_comment#3525 AS cval_region_r_comment_0#3532, cdepval_region_r_name#3526 AS cdepval_region_r_name_0#3533, cdepval_region_r_comment#3527 AS cdepval_region_r_comment_0#3534, cr_name#3528 AS cr_name_0#3535, cr_comment#3529 AS cr_comment_0#3536]
               :  :     +- Relation[rid#3523,cval_region_r_name#3524,cval_region_r_comment#3525,cdepval_region_r_name#3526,cdepval_region_r_comment#3527,cr_name#3528,cr_comment#3529] JDBCRelation(tregion) [numPartitions=1]
               :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
               :     +- Project [rid#3583 AS rid_1#3592, cpfk_region_nation#3584 AS cpfk_region_nation_1#3593, cfpk_nation_region#3585 AS cfpk_nation_region_1#3594, cval_nation_n_name#3586 AS cval_nation_n_name_1#3595, cval_nation_n_comment#3587 AS cval_nation_n_comment_1#3596, cdepval_nation_n_name#3588 AS cdepval_nation_n_name_1#3597, cdepval_nation_n_comment#3589 AS cdepval_nation_n_comment_1#3598, cn_name#3590 AS cn_name_1#3599, cn_comment#3591 AS cn_comment_1#3600]
               :        +- Relation[rid#3583,cpfk_region_nation#3584,cfpk_nation_region#3585,cval_nation_n_name#3586,cval_nation_n_comment#3587,cdepval_nation_n_name#3588,cdepval_nation_n_comment#3589,cn_name#3590,cn_comment#3591] JDBCRelation(tnation) [numPartitions=1]
               +- Project [rid#3551 AS rid_1#3560, cpfk_region_nation#3552 AS cpfk_region_nation_1#3561, cfpk_nation_region#3553 AS cfpk_nation_region_1#3562, cval_nation_n_name#3554 AS cval_nation_n_name_1#3563, cval_nation_n_comment#3555 AS cval_nation_n_comment_1#3564, cdepval_nation_n_name#3556 AS cdepval_nation_n_name_1#3565, cdepval_nation_n_comment#3557 AS cdepval_nation_n_comment_1#3566, cn_name#3558 AS cn_name_1#3567, cn_comment#3559 AS cn_comment_1#3568]
                  +- Relation[rid#3551,cpfk_region_nation#3552,cfpk_nation_region#3553,cval_nation_n_name#3554,cval_nation_n_comment#3555,cdepval_nation_n_name#3556,cdepval_nation_n_comment#3557,cn_name#3558,cn_comment#3559] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 935ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/26 21:43:57 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:43:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3923L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 21:43:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:43:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:43:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:43:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3923L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#3950, cval_part_p_name_0#3951, cval_part_p_mfgr_0#3952, cval_part_p_type_0#3953, cval_part_p_size_0#3954, cval_part_p_container_0#3955, cval_part_p_retailprice_0#3956, cval_part_p_comment_0#3957, cval_part_p_brand_0#3958, cdepval_part_p_name_0#3959, cdepval_part_p_mfgr_0#3960, cdepval_part_p_type_0#3961, cdepval_part_p_size_0#3962, cdepval_part_p_container_0#3963, cdepval_part_p_retailprice_0#3964, cdepval_part_p_comment_0#3965, cdepval_part_p_brand_0#3966, cp_name_0#3967, cp_mfgr_0#3968, cp_type_0#3969, cp_size_0#3970, cp_container_0#3971, cp_retailprice_0#3972, cp_comment_0#3973, ... 2 more fields]
         :  :- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  +- Project [rid#3925 AS rid_0#3950, cval_part_p_name#3926 AS cval_part_p_name_0#3951, cval_part_p_mfgr#3927 AS cval_part_p_mfgr_0#3952, cval_part_p_type#3928 AS cval_part_p_type_0#3953, cval_part_p_size#3929 AS cval_part_p_size_0#3954, cval_part_p_container#3930 AS cval_part_p_container_0#3955, cval_part_p_retailprice#3931 AS cval_part_p_retailprice_0#3956, cval_part_p_comment#3932 AS cval_part_p_comment_0#3957, cval_part_p_brand#3933 AS cval_part_p_brand_0#3958, cdepval_part_p_name#3934 AS cdepval_part_p_name_0#3959, cdepval_part_p_mfgr#3935 AS cdepval_part_p_mfgr_0#3960, cdepval_part_p_type#3936 AS cdepval_part_p_type_0#3961, cdepval_part_p_size#3937 AS cdepval_part_p_size_0#3962, cdepval_part_p_container#3938 AS cdepval_part_p_container_0#3963, cdepval_part_p_retailprice#3939 AS cdepval_part_p_retailprice_0#3964, cdepval_part_p_comment#3940 AS cdepval_part_p_comment_0#3965, cdepval_part_p_brand#3941 AS cdepval_part_p_brand_0#3966, cp_name#3942 AS cp_name_0#3967, cp_mfgr#3943 AS cp_mfgr_0#3968, cp_type#3944 AS cp_type_0#3969, cp_size#3945 AS cp_size_0#3970, cp_container#3946 AS cp_container_0#3971, cp_retailprice#3947 AS cp_retailprice_0#3972, cp_comment#3948 AS cp_comment_0#3973, cp_brand#3949 AS cp_brand_0#3974]
         :  :     +- Relation[rid#3925,cval_part_p_name#3926,cval_part_p_mfgr#3927,cval_part_p_type#3928,cval_part_p_size#3929,cval_part_p_container#3930,cval_part_p_retailprice#3931,cval_part_p_comment#3932,cval_part_p_brand#3933,cdepval_part_p_name#3934,cdepval_part_p_mfgr#3935,cdepval_part_p_type#3936,cdepval_part_p_size#3937,cdepval_part_p_container#3938,cdepval_part_p_retailprice#3939,cdepval_part_p_comment#3940,cdepval_part_p_brand#3941,cp_name#3942,cp_mfgr#3943,cp_type#3944,cp_size#3945,cp_container#3946,cp_retailprice#3947,cp_comment#3948,cp_brand#3949] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :     +- Project [rid#4103 AS rid_1#4117, cpfk_part_partsupp#4104 AS cpfk_part_partsupp_1#4118, cfpk_partsupp_part#4105 AS cfpk_partsupp_part_1#4119, cpfk_supplier_partsupp#4106 AS cpfk_supplier_partsupp_1#4120, cfpk_partsupp_supplier#4107 AS cfpk_partsupp_supplier_1#4121, cval_partsupp_ps_availqty#4108 AS cval_partsupp_ps_availqty_1#4122, cval_partsupp_ps_supplycost#4109 AS cval_partsupp_ps_supplycost_1#4123, cval_partsupp_ps_comment#4110 AS cval_partsupp_ps_comment_1#4124, cdepval_partsupp_ps_availqty#4111 AS cdepval_partsupp_ps_availqty_1#4125, cdepval_partsupp_ps_supplycost#4112 AS cdepval_partsupp_ps_supplycost_1#4126, cdepval_partsupp_ps_comment#4113 AS cdepval_partsupp_ps_comment_1#4127, cps_availqty#4114 AS cps_availqty_1#4128, cps_supplycost#4115 AS cps_supplycost_1#4129, cps_comment#4116 AS cps_comment_1#4130]
         :        +- Relation[rid#4103,cpfk_part_partsupp#4104,cfpk_partsupp_part#4105,cpfk_supplier_partsupp#4106,cfpk_partsupp_supplier#4107,cval_partsupp_ps_availqty#4108,cval_partsupp_ps_supplycost#4109,cval_partsupp_ps_comment#4110,cdepval_partsupp_ps_availqty#4111,cdepval_partsupp_ps_supplycost#4112,cdepval_partsupp_ps_comment#4113,cps_availqty#4114,cps_supplycost#4115,cps_comment#4116] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#4025 AS rid_1#4039, cpfk_part_partsupp#4026 AS cpfk_part_partsupp_1#4040, cfpk_partsupp_part#4027 AS cfpk_partsupp_part_1#4041, cpfk_supplier_partsupp#4028 AS cpfk_supplier_partsupp_1#4042, cfpk_partsupp_supplier#4029 AS cfpk_partsupp_supplier_1#4043, cval_partsupp_ps_availqty#4030 AS cval_partsupp_ps_availqty_1#4044, cval_partsupp_ps_supplycost#4031 AS cval_partsupp_ps_supplycost_1#4045, cval_partsupp_ps_comment#4032 AS cval_partsupp_ps_comment_1#4046, cdepval_partsupp_ps_availqty#4033 AS cdepval_partsupp_ps_availqty_1#4047, cdepval_partsupp_ps_supplycost#4034 AS cdepval_partsupp_ps_supplycost_1#4048, cdepval_partsupp_ps_comment#4035 AS cdepval_partsupp_ps_comment_1#4049, cps_availqty#4036 AS cps_availqty_1#4050, cps_supplycost#4037 AS cps_supplycost_1#4051, cps_comment#4038 AS cps_comment_1#4052]
            +- Relation[rid#4025,cpfk_part_partsupp#4026,cfpk_partsupp_part#4027,cpfk_supplier_partsupp#4028,cfpk_partsupp_supplier#4029,cval_partsupp_ps_availqty#4030,cval_partsupp_ps_supplycost#4031,cval_partsupp_ps_comment#4032,cdepval_partsupp_ps_availqty#4033,cdepval_partsupp_ps_supplycost#4034,cdepval_partsupp_ps_comment#4035,cps_availqty#4036,cps_supplycost#4037,cps_comment#4038] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 611ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/26 21:43:57 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:43:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4179L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:43:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4179L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#4271 AS rid_2#4316, cpfk_orders_lineitem#4272 AS cpfk_orders_lineitem_2#4317, cpfk_supplier_lineitem#4273 AS cpfk_supplier_lineitem_2#4318, cfpk_lineitem_supplier#4274 AS cfpk_lineitem_supplier_2#4319, cfpk_lineitem_partsupp#4275 AS cfpk_lineitem_partsupp_2#4320, cpfk_part_lineitem#4276 AS cpfk_part_lineitem_2#4321, cfpk_lineitem_part#4277 AS cfpk_lineitem_part_2#4322, cpfk_partsupp_lineitem#4278 AS cpfk_partsupp_lineitem_2#4323, cfpk_lineitem_orders#4279 AS cfpk_lineitem_orders_2#4324, cval_lineitem_l_quantity#4280 AS cval_lineitem_l_quantity_2#4325, cval_lineitem_l_extendedprice#4281 AS cval_lineitem_l_extendedprice_2#4326, cval_lineitem_l_discount#4282 AS cval_lineitem_l_discount_2#4327, cval_lineitem_l_tax#4283 AS cval_lineitem_l_tax_2#4328, cval_lineitem_l_returnflag#4284 AS cval_lineitem_l_returnflag_2#4329, cval_lineitem_l_linestatus#4285 AS cval_lineitem_l_linestatus_2#4330, cval_lineitem_l_commitdate#4286 AS cval_lineitem_l_commitdate_2#4331, cval_lineitem_l_receiptdate#4287 AS cval_lineitem_l_receiptdate_2#4332, cval_lineitem_l_shipinstruct#4288 AS cval_lineitem_l_shipinstruct_2#4333, cval_lineitem_l_shipmode#4289 AS cval_lineitem_l_shipmode_2#4334, cval_lineitem_l_comment#4290 AS cval_lineitem_l_comment_2#4335, cval_lineitem_l_shipdate#4291 AS cval_lineitem_l_shipdate_2#4336, cdepval_lineitem_l_quantity#4292 AS cdepval_lineitem_l_quantity_2#4337, cdepval_lineitem_l_extendedprice#4293 AS cdepval_lineitem_l_extendedprice_2#4338, cdepval_lineitem_l_discount#4294 AS cdepval_lineitem_l_discount_2#4339, ... 21 more fields]
         :  +- Relation[rid#4271,cpfk_orders_lineitem#4272,cpfk_supplier_lineitem#4273,cfpk_lineitem_supplier#4274,cfpk_lineitem_partsupp#4275,cpfk_part_lineitem#4276,cfpk_lineitem_part#4277,cpfk_partsupp_lineitem#4278,cfpk_lineitem_orders#4279,cval_lineitem_l_quantity#4280,cval_lineitem_l_extendedprice#4281,cval_lineitem_l_discount#4282,cval_lineitem_l_tax#4283,cval_lineitem_l_returnflag#4284,cval_lineitem_l_linestatus#4285,cval_lineitem_l_commitdate#4286,cval_lineitem_l_receiptdate#4287,cval_lineitem_l_shipinstruct#4288,cval_lineitem_l_shipmode#4289,cval_lineitem_l_comment#4290,cval_lineitem_l_shipdate#4291,cdepval_lineitem_l_quantity#4292,cdepval_lineitem_l_extendedprice#4293,cdepval_lineitem_l_discount#4294,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#4223 AS rid_1#4247, cpfk_customer_orders#4224 AS cpfk_customer_orders_1#4248, cfpk_orders_customer#4225 AS cfpk_orders_customer_1#4249, cval_orders_o_orderstatus#4226 AS cval_orders_o_orderstatus_1#4250, cval_orders_o_totalprice#4227 AS cval_orders_o_totalprice_1#4251, cval_orders_o_orderpriority#4228 AS cval_orders_o_orderpriority_1#4252, cval_orders_o_clerk#4229 AS cval_orders_o_clerk_1#4253, cval_orders_o_shippriority#4230 AS cval_orders_o_shippriority_1#4254, cval_orders_o_comment#4231 AS cval_orders_o_comment_1#4255, cval_orders_o_orderdate#4232 AS cval_orders_o_orderdate_1#4256, cdepval_orders_o_orderstatus#4233 AS cdepval_orders_o_orderstatus_1#4257, cdepval_orders_o_totalprice#4234 AS cdepval_orders_o_totalprice_1#4258, cdepval_orders_o_orderpriority#4235 AS cdepval_orders_o_orderpriority_1#4259, cdepval_orders_o_clerk#4236 AS cdepval_orders_o_clerk_1#4260, cdepval_orders_o_shippriority#4237 AS cdepval_orders_o_shippriority_1#4261, cdepval_orders_o_comment#4238 AS cdepval_orders_o_comment_1#4262, cdepval_orders_o_orderdate#4239 AS cdepval_orders_o_orderdate_1#4263, co_orderstatus#4240 AS co_orderstatus_1#4264, co_totalprice#4241 AS co_totalprice_1#4265, co_orderpriority#4242 AS co_orderpriority_1#4266, co_clerk#4243 AS co_clerk_1#4267, co_shippriority#4244 AS co_shippriority_1#4268, co_comment#4245 AS co_comment_1#4269, co_orderdate#4246 AS co_orderdate_1#4270]
            :  +- Relation[rid#4223,cpfk_customer_orders#4224,cfpk_orders_customer#4225,cval_orders_o_orderstatus#4226,cval_orders_o_totalprice#4227,cval_orders_o_orderpriority#4228,cval_orders_o_clerk#4229,cval_orders_o_shippriority#4230,cval_orders_o_comment#4231,cval_orders_o_orderdate#4232,cdepval_orders_o_orderstatus#4233,cdepval_orders_o_totalprice#4234,cdepval_orders_o_orderpriority#4235,cdepval_orders_o_clerk#4236,cdepval_orders_o_shippriority#4237,cdepval_orders_o_comment#4238,cdepval_orders_o_orderdate#4239,co_orderstatus#4240,co_totalprice#4241,co_orderpriority#4242,co_clerk#4243,co_shippriority#4244,co_comment#4245,co_orderdate#4246] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#4181 AS rid_0#4202, cpfk_nation_customer#4182 AS cpfk_nation_customer_0#4203, cfpk_customer_nation#4183 AS cfpk_customer_nation_0#4204, cval_customer_c_name#4184 AS cval_customer_c_name_0#4205, cval_customer_c_address#4185 AS cval_customer_c_address_0#4206, cval_customer_c_phone#4186 AS cval_customer_c_phone_0#4207, cval_customer_c_acctbal#4187 AS cval_customer_c_acctbal_0#4208, cval_customer_c_comment#4188 AS cval_customer_c_comment_0#4209, cval_customer_c_mktsegment#4189 AS cval_customer_c_mktsegment_0#4210, cdepval_customer_c_name#4190 AS cdepval_customer_c_name_0#4211, cdepval_customer_c_address#4191 AS cdepval_customer_c_address_0#4212, cdepval_customer_c_phone#4192 AS cdepval_customer_c_phone_0#4213, cdepval_customer_c_acctbal#4193 AS cdepval_customer_c_acctbal_0#4214, cdepval_customer_c_comment#4194 AS cdepval_customer_c_comment_0#4215, cdepval_customer_c_mktsegment#4195 AS cdepval_customer_c_mktsegment_0#4216, cc_name#4196 AS cc_name_0#4217, cc_address#4197 AS cc_address_0#4218, cc_phone#4198 AS cc_phone_0#4219, cc_acctbal#4199 AS cc_acctbal_0#4220, cc_comment#4200 AS cc_comment_0#4221, cc_mktsegment#4201 AS cc_mktsegment_0#4222]
               +- Relation[rid#4181,cpfk_nation_customer#4182,cfpk_customer_nation#4183,cval_customer_c_name#4184,cval_customer_c_address#4185,cval_customer_c_phone#4186,cval_customer_c_acctbal#4187,cval_customer_c_comment#4188,cval_customer_c_mktsegment#4189,cdepval_customer_c_name#4190,cdepval_customer_c_address#4191,cdepval_customer_c_phone#4192,cdepval_customer_c_acctbal#4193,cdepval_customer_c_comment#4194,cdepval_customer_c_mktsegment#4195,cc_name#4196,cc_address#4197,cc_phone#4198,cc_acctbal#4199,cc_comment#4200,cc_mktsegment#4201] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 22407ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/26 21:44:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:44:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4457L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 21:44:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:44:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:44:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:44:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:44:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:44:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:44:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:44:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:44:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:44:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:44:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:44:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:44:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:44:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4457L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#4627 AS rid_4#4672, cpfk_orders_lineitem#4628 AS cpfk_orders_lineitem_4#4673, cpfk_supplier_lineitem#4629 AS cpfk_supplier_lineitem_4#4674, cfpk_lineitem_supplier#4630 AS cfpk_lineitem_supplier_4#4675, cfpk_lineitem_partsupp#4631 AS cfpk_lineitem_partsupp_4#4676, cpfk_part_lineitem#4632 AS cpfk_part_lineitem_4#4677, cfpk_lineitem_part#4633 AS cfpk_lineitem_part_4#4678, cpfk_partsupp_lineitem#4634 AS cpfk_partsupp_lineitem_4#4679, cfpk_lineitem_orders#4635 AS cfpk_lineitem_orders_4#4680, cval_lineitem_l_quantity#4636 AS cval_lineitem_l_quantity_4#4681, cval_lineitem_l_extendedprice#4637 AS cval_lineitem_l_extendedprice_4#4682, cval_lineitem_l_discount#4638 AS cval_lineitem_l_discount_4#4683, cval_lineitem_l_tax#4639 AS cval_lineitem_l_tax_4#4684, cval_lineitem_l_returnflag#4640 AS cval_lineitem_l_returnflag_4#4685, cval_lineitem_l_linestatus#4641 AS cval_lineitem_l_linestatus_4#4686, cval_lineitem_l_commitdate#4642 AS cval_lineitem_l_commitdate_4#4687, cval_lineitem_l_receiptdate#4643 AS cval_lineitem_l_receiptdate_4#4688, cval_lineitem_l_shipinstruct#4644 AS cval_lineitem_l_shipinstruct_4#4689, cval_lineitem_l_shipmode#4645 AS cval_lineitem_l_shipmode_4#4690, cval_lineitem_l_comment#4646 AS cval_lineitem_l_comment_4#4691, cval_lineitem_l_shipdate#4647 AS cval_lineitem_l_shipdate_4#4692, cdepval_lineitem_l_quantity#4648 AS cdepval_lineitem_l_quantity_4#4693, cdepval_lineitem_l_extendedprice#4649 AS cdepval_lineitem_l_extendedprice_4#4694, cdepval_lineitem_l_discount#4650 AS cdepval_lineitem_l_discount_4#4695, ... 21 more fields]
            :  :  +- Relation[rid#4627,cpfk_orders_lineitem#4628,cpfk_supplier_lineitem#4629,cfpk_lineitem_supplier#4630,cfpk_lineitem_partsupp#4631,cpfk_part_lineitem#4632,cfpk_lineitem_part#4633,cpfk_partsupp_lineitem#4634,cfpk_lineitem_orders#4635,cval_lineitem_l_quantity#4636,cval_lineitem_l_extendedprice#4637,cval_lineitem_l_discount#4638,cval_lineitem_l_tax#4639,cval_lineitem_l_returnflag#4640,cval_lineitem_l_linestatus#4641,cval_lineitem_l_commitdate#4642,cval_lineitem_l_receiptdate#4643,cval_lineitem_l_shipinstruct#4644,cval_lineitem_l_shipmode#4645,cval_lineitem_l_comment#4646,cval_lineitem_l_shipdate#4647,cdepval_lineitem_l_quantity#4648,cdepval_lineitem_l_extendedprice#4649,cdepval_lineitem_l_discount#4650,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#4579 AS rid_3#4603, cpfk_customer_orders#4580 AS cpfk_customer_orders_3#4604, cfpk_orders_customer#4581 AS cfpk_orders_customer_3#4605, cval_orders_o_orderstatus#4582 AS cval_orders_o_orderstatus_3#4606, cval_orders_o_totalprice#4583 AS cval_orders_o_totalprice_3#4607, cval_orders_o_orderpriority#4584 AS cval_orders_o_orderpriority_3#4608, cval_orders_o_clerk#4585 AS cval_orders_o_clerk_3#4609, cval_orders_o_shippriority#4586 AS cval_orders_o_shippriority_3#4610, cval_orders_o_comment#4587 AS cval_orders_o_comment_3#4611, cval_orders_o_orderdate#4588 AS cval_orders_o_orderdate_3#4612, cdepval_orders_o_orderstatus#4589 AS cdepval_orders_o_orderstatus_3#4613, cdepval_orders_o_totalprice#4590 AS cdepval_orders_o_totalprice_3#4614, cdepval_orders_o_orderpriority#4591 AS cdepval_orders_o_orderpriority_3#4615, cdepval_orders_o_clerk#4592 AS cdepval_orders_o_clerk_3#4616, cdepval_orders_o_shippriority#4593 AS cdepval_orders_o_shippriority_3#4617, cdepval_orders_o_comment#4594 AS cdepval_orders_o_comment_3#4618, cdepval_orders_o_orderdate#4595 AS cdepval_orders_o_orderdate_3#4619, co_orderstatus#4596 AS co_orderstatus_3#4620, co_totalprice#4597 AS co_totalprice_3#4621, co_orderpriority#4598 AS co_orderpriority_3#4622, co_clerk#4599 AS co_clerk_3#4623, co_shippriority#4600 AS co_shippriority_3#4624, co_comment#4601 AS co_comment_3#4625, co_orderdate#4602 AS co_orderdate_3#4626]
            :     :  +- Relation[rid#4579,cpfk_customer_orders#4580,cfpk_orders_customer#4581,cval_orders_o_orderstatus#4582,cval_orders_o_totalprice#4583,cval_orders_o_orderpriority#4584,cval_orders_o_clerk#4585,cval_orders_o_shippriority#4586,cval_orders_o_comment#4587,cval_orders_o_orderdate#4588,cdepval_orders_o_orderstatus#4589,cdepval_orders_o_totalprice#4590,cdepval_orders_o_orderpriority#4591,cdepval_orders_o_clerk#4592,cdepval_orders_o_shippriority#4593,cdepval_orders_o_comment#4594,cdepval_orders_o_orderdate#4595,co_orderstatus#4596,co_totalprice#4597,co_orderpriority#4598,co_clerk#4599,co_shippriority#4600,co_comment#4601,co_orderdate#4602] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#4537 AS rid_2#4558, cpfk_nation_customer#4538 AS cpfk_nation_customer_2#4559, cfpk_customer_nation#4539 AS cfpk_customer_nation_2#4560, cval_customer_c_name#4540 AS cval_customer_c_name_2#4561, cval_customer_c_address#4541 AS cval_customer_c_address_2#4562, cval_customer_c_phone#4542 AS cval_customer_c_phone_2#4563, cval_customer_c_acctbal#4543 AS cval_customer_c_acctbal_2#4564, cval_customer_c_comment#4544 AS cval_customer_c_comment_2#4565, cval_customer_c_mktsegment#4545 AS cval_customer_c_mktsegment_2#4566, cdepval_customer_c_name#4546 AS cdepval_customer_c_name_2#4567, cdepval_customer_c_address#4547 AS cdepval_customer_c_address_2#4568, cdepval_customer_c_phone#4548 AS cdepval_customer_c_phone_2#4569, cdepval_customer_c_acctbal#4549 AS cdepval_customer_c_acctbal_2#4570, cdepval_customer_c_comment#4550 AS cdepval_customer_c_comment_2#4571, cdepval_customer_c_mktsegment#4551 AS cdepval_customer_c_mktsegment_2#4572, cc_name#4552 AS cc_name_2#4573, cc_address#4553 AS cc_address_2#4574, cc_phone#4554 AS cc_phone_2#4575, cc_acctbal#4555 AS cc_acctbal_2#4576, cc_comment#4556 AS cc_comment_2#4577, cc_mktsegment#4557 AS cc_mktsegment_2#4578]
            :        :  +- Relation[rid#4537,cpfk_nation_customer#4538,cfpk_customer_nation#4539,cval_customer_c_name#4540,cval_customer_c_address#4541,cval_customer_c_phone#4542,cval_customer_c_acctbal#4543,cval_customer_c_comment#4544,cval_customer_c_mktsegment#4545,cdepval_customer_c_name#4546,cdepval_customer_c_address#4547,cdepval_customer_c_phone#4548,cdepval_customer_c_acctbal#4549,cdepval_customer_c_comment#4550,cdepval_customer_c_mktsegment#4551,cc_name#4552,cc_address#4553,cc_phone#4554,cc_acctbal#4555,cc_comment#4556,cc_mktsegment#4557] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join UsingJoin(Inner,List(rid_1))
            :           :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#4466, cval_region_r_name_0#4467, cval_region_r_comment_0#4468, cdepval_region_r_name_0#4469, cdepval_region_r_comment_0#4470, cr_name_0#4471, cr_comment_0#4472, 'rid_1]
            :           :  :- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :           :  :  +- Project [rid#4459 AS rid_0#4466, cval_region_r_name#4460 AS cval_region_r_name_0#4467, cval_region_r_comment#4461 AS cval_region_r_comment_0#4468, cdepval_region_r_name#4462 AS cdepval_region_r_name_0#4469, cdepval_region_r_comment#4463 AS cdepval_region_r_comment_0#4470, cr_name#4464 AS cr_name_0#4471, cr_comment#4465 AS cr_comment_0#4472]
            :           :  :     +- Relation[rid#4459,cval_region_r_name#4460,cval_region_r_comment#4461,cdepval_region_r_name#4462,cdepval_region_r_comment#4463,cr_name#4464,cr_comment#4465] JDBCRelation(tregion) [numPartitions=1]
            :           :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
            :           :     +- Project [rid#4519 AS rid_1#4528, cpfk_region_nation#4520 AS cpfk_region_nation_1#4529, cfpk_nation_region#4521 AS cfpk_nation_region_1#4530, cval_nation_n_name#4522 AS cval_nation_n_name_1#4531, cval_nation_n_comment#4523 AS cval_nation_n_comment_1#4532, cdepval_nation_n_name#4524 AS cdepval_nation_n_name_1#4533, cdepval_nation_n_comment#4525 AS cdepval_nation_n_comment_1#4534, cn_name#4526 AS cn_name_1#4535, cn_comment#4527 AS cn_comment_1#4536]
            :           :        +- Relation[rid#4519,cpfk_region_nation#4520,cfpk_nation_region#4521,cval_nation_n_name#4522,cval_nation_n_comment#4523,cdepval_nation_n_name#4524,cdepval_nation_n_comment#4525,cn_name#4526,cn_comment#4527] JDBCRelation(tnation) [numPartitions=1]
            :           +- Project [rid#4487 AS rid_1#4496, cpfk_region_nation#4488 AS cpfk_region_nation_1#4497, cfpk_nation_region#4489 AS cfpk_nation_region_1#4498, cval_nation_n_name#4490 AS cval_nation_n_name_1#4499, cval_nation_n_comment#4491 AS cval_nation_n_comment_1#4500, cdepval_nation_n_name#4492 AS cdepval_nation_n_name_1#4501, cdepval_nation_n_comment#4493 AS cdepval_nation_n_comment_1#4502, cn_name#4494 AS cn_name_1#4503, cn_comment#4495 AS cn_comment_1#4504]
            :              +- Relation[rid#4487,cpfk_region_nation#4488,cfpk_nation_region#4489,cval_nation_n_name#4490,cval_nation_n_comment#4491,cdepval_nation_n_name#4492,cdepval_nation_n_comment#4493,cn_name#4494,cn_comment#4495] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#4717 AS rid_5#4735, cpfk_nation_supplier#4718 AS cpfk_nation_supplier_5#4736, cfpk_supplier_nation#4719 AS cfpk_supplier_nation_5#4737, cval_supplier_s_name#4720 AS cval_supplier_s_name_5#4738, cval_supplier_s_address#4721 AS cval_supplier_s_address_5#4739, cval_supplier_s_phone#4722 AS cval_supplier_s_phone_5#4740, cval_supplier_s_acctbal#4723 AS cval_supplier_s_acctbal_5#4741, cval_supplier_s_comment#4724 AS cval_supplier_s_comment_5#4742, cdepval_supplier_s_name#4725 AS cdepval_supplier_s_name_5#4743, cdepval_supplier_s_address#4726 AS cdepval_supplier_s_address_5#4744, cdepval_supplier_s_phone#4727 AS cdepval_supplier_s_phone_5#4745, cdepval_supplier_s_acctbal#4728 AS cdepval_supplier_s_acctbal_5#4746, cdepval_supplier_s_comment#4729 AS cdepval_supplier_s_comment_5#4747, cs_name#4730 AS cs_name_5#4748, cs_address#4731 AS cs_address_5#4749, cs_phone#4732 AS cs_phone_5#4750, cs_acctbal#4733 AS cs_acctbal_5#4751, cs_comment#4734 AS cs_comment_5#4752]
               +- Relation[rid#4717,cpfk_nation_supplier#4718,cfpk_supplier_nation#4719,cval_supplier_s_name#4720,cval_supplier_s_address#4721,cval_supplier_s_phone#4722,cval_supplier_s_acctbal#4723,cval_supplier_s_comment#4724,cdepval_supplier_s_name#4725,cdepval_supplier_s_address#4726,cdepval_supplier_s_phone#4727,cdepval_supplier_s_acctbal#4728,cdepval_supplier_s_comment#4729,cs_name#4730,cs_address#4731,cs_phone#4732,cs_acctbal#4733,cs_comment#4734] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 29537ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 21:44:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:44:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4886L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:44:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:44:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:44:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:44:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:44:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:44:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:44:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:44:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4886L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#4942 AS rid_2#4987, cpfk_orders_lineitem#4943 AS cpfk_orders_lineitem_2#4988, cpfk_supplier_lineitem#4944 AS cpfk_supplier_lineitem_2#4989, cfpk_lineitem_supplier#4945 AS cfpk_lineitem_supplier_2#4990, cfpk_lineitem_partsupp#4946 AS cfpk_lineitem_partsupp_2#4991, cpfk_part_lineitem#4947 AS cpfk_part_lineitem_2#4992, cfpk_lineitem_part#4948 AS cfpk_lineitem_part_2#4993, cpfk_partsupp_lineitem#4949 AS cpfk_partsupp_lineitem_2#4994, cfpk_lineitem_orders#4950 AS cfpk_lineitem_orders_2#4995, cval_lineitem_l_quantity#4951 AS cval_lineitem_l_quantity_2#4996, cval_lineitem_l_extendedprice#4952 AS cval_lineitem_l_extendedprice_2#4997, cval_lineitem_l_discount#4953 AS cval_lineitem_l_discount_2#4998, cval_lineitem_l_tax#4954 AS cval_lineitem_l_tax_2#4999, cval_lineitem_l_returnflag#4955 AS cval_lineitem_l_returnflag_2#5000, cval_lineitem_l_linestatus#4956 AS cval_lineitem_l_linestatus_2#5001, cval_lineitem_l_commitdate#4957 AS cval_lineitem_l_commitdate_2#5002, cval_lineitem_l_receiptdate#4958 AS cval_lineitem_l_receiptdate_2#5003, cval_lineitem_l_shipinstruct#4959 AS cval_lineitem_l_shipinstruct_2#5004, cval_lineitem_l_shipmode#4960 AS cval_lineitem_l_shipmode_2#5005, cval_lineitem_l_comment#4961 AS cval_lineitem_l_comment_2#5006, cval_lineitem_l_shipdate#4962 AS cval_lineitem_l_shipdate_2#5007, cdepval_lineitem_l_quantity#4963 AS cdepval_lineitem_l_quantity_2#5008, cdepval_lineitem_l_extendedprice#4964 AS cdepval_lineitem_l_extendedprice_2#5009, cdepval_lineitem_l_discount#4965 AS cdepval_lineitem_l_discount_2#5010, ... 21 more fields]
         :  :  :  :  +- Relation[rid#4942,cpfk_orders_lineitem#4943,cpfk_supplier_lineitem#4944,cfpk_lineitem_supplier#4945,cfpk_lineitem_partsupp#4946,cpfk_part_lineitem#4947,cfpk_lineitem_part#4948,cpfk_partsupp_lineitem#4949,cfpk_lineitem_orders#4950,cval_lineitem_l_quantity#4951,cval_lineitem_l_extendedprice#4952,cval_lineitem_l_discount#4953,cval_lineitem_l_tax#4954,cval_lineitem_l_returnflag#4955,cval_lineitem_l_linestatus#4956,cval_lineitem_l_commitdate#4957,cval_lineitem_l_receiptdate#4958,cval_lineitem_l_shipinstruct#4959,cval_lineitem_l_shipmode#4960,cval_lineitem_l_comment#4961,cval_lineitem_l_shipdate#4962,cdepval_lineitem_l_quantity#4963,cdepval_lineitem_l_extendedprice#4964,cdepval_lineitem_l_discount#4965,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#4906 AS rid_1#4924, cpfk_nation_supplier#4907 AS cpfk_nation_supplier_1#4925, cfpk_supplier_nation#4908 AS cfpk_supplier_nation_1#4926, cval_supplier_s_name#4909 AS cval_supplier_s_name_1#4927, cval_supplier_s_address#4910 AS cval_supplier_s_address_1#4928, cval_supplier_s_phone#4911 AS cval_supplier_s_phone_1#4929, cval_supplier_s_acctbal#4912 AS cval_supplier_s_acctbal_1#4930, cval_supplier_s_comment#4913 AS cval_supplier_s_comment_1#4931, cdepval_supplier_s_name#4914 AS cdepval_supplier_s_name_1#4932, cdepval_supplier_s_address#4915 AS cdepval_supplier_s_address_1#4933, cdepval_supplier_s_phone#4916 AS cdepval_supplier_s_phone_1#4934, cdepval_supplier_s_acctbal#4917 AS cdepval_supplier_s_acctbal_1#4935, cdepval_supplier_s_comment#4918 AS cdepval_supplier_s_comment_1#4936, cs_name#4919 AS cs_name_1#4937, cs_address#4920 AS cs_address_1#4938, cs_phone#4921 AS cs_phone_1#4939, cs_acctbal#4922 AS cs_acctbal_1#4940, cs_comment#4923 AS cs_comment_1#4941]
         :  :  :     :  +- Relation[rid#4906,cpfk_nation_supplier#4907,cfpk_supplier_nation#4908,cval_supplier_s_name#4909,cval_supplier_s_address#4910,cval_supplier_s_phone#4911,cval_supplier_s_acctbal#4912,cval_supplier_s_comment#4913,cdepval_supplier_s_name#4914,cdepval_supplier_s_address#4915,cdepval_supplier_s_phone#4916,cdepval_supplier_s_acctbal#4917,cdepval_supplier_s_comment#4918,cs_name#4919,cs_address#4920,cs_phone#4921,cs_acctbal#4922,cs_comment#4923] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#4888 AS rid_0#4897, cpfk_region_nation#4889 AS cpfk_region_nation_0#4898, cfpk_nation_region#4890 AS cfpk_nation_region_0#4899, cval_nation_n_name#4891 AS cval_nation_n_name_0#4900, cval_nation_n_comment#4892 AS cval_nation_n_comment_0#4901, cdepval_nation_n_name#4893 AS cdepval_nation_n_name_0#4902, cdepval_nation_n_comment#4894 AS cdepval_nation_n_comment_0#4903, cn_name#4895 AS cn_name_0#4904, cn_comment#4896 AS cn_comment_0#4905]
         :  :  :        +- Relation[rid#4888,cpfk_region_nation#4889,cfpk_nation_region#4890,cval_nation_n_name#4891,cval_nation_n_comment#4892,cdepval_nation_n_name#4893,cdepval_nation_n_comment#4894,cn_name#4895,cn_comment#4896] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#5032 AS rid_3#5057, cval_part_p_name#5033 AS cval_part_p_name_3#5058, cval_part_p_mfgr#5034 AS cval_part_p_mfgr_3#5059, cval_part_p_type#5035 AS cval_part_p_type_3#5060, cval_part_p_size#5036 AS cval_part_p_size_3#5061, cval_part_p_container#5037 AS cval_part_p_container_3#5062, cval_part_p_retailprice#5038 AS cval_part_p_retailprice_3#5063, cval_part_p_comment#5039 AS cval_part_p_comment_3#5064, cval_part_p_brand#5040 AS cval_part_p_brand_3#5065, cdepval_part_p_name#5041 AS cdepval_part_p_name_3#5066, cdepval_part_p_mfgr#5042 AS cdepval_part_p_mfgr_3#5067, cdepval_part_p_type#5043 AS cdepval_part_p_type_3#5068, cdepval_part_p_size#5044 AS cdepval_part_p_size_3#5069, cdepval_part_p_container#5045 AS cdepval_part_p_container_3#5070, cdepval_part_p_retailprice#5046 AS cdepval_part_p_retailprice_3#5071, cdepval_part_p_comment#5047 AS cdepval_part_p_comment_3#5072, cdepval_part_p_brand#5048 AS cdepval_part_p_brand_3#5073, cp_name#5049 AS cp_name_3#5074, cp_mfgr#5050 AS cp_mfgr_3#5075, cp_type#5051 AS cp_type_3#5076, cp_size#5052 AS cp_size_3#5077, cp_container#5053 AS cp_container_3#5078, cp_retailprice#5054 AS cp_retailprice_3#5079, cp_comment#5055 AS cp_comment_3#5080, cp_brand#5056 AS cp_brand_3#5081]
         :  :     +- Relation[rid#5032,cval_part_p_name#5033,cval_part_p_mfgr#5034,cval_part_p_type#5035,cval_part_p_size#5036,cval_part_p_container#5037,cval_part_p_retailprice#5038,cval_part_p_comment#5039,cval_part_p_brand#5040,cdepval_part_p_name#5041,cdepval_part_p_mfgr#5042,cdepval_part_p_type#5043,cdepval_part_p_size#5044,cdepval_part_p_container#5045,cdepval_part_p_retailprice#5046,cdepval_part_p_comment#5047,cdepval_part_p_brand#5048,cp_name#5049,cp_mfgr#5050,cp_type#5051,cp_size#5052,cp_container#5053,cp_retailprice#5054,cp_comment#5055,cp_brand#5056] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#5082 AS rid_4#5096, cpfk_part_partsupp#5083 AS cpfk_part_partsupp_4#5097, cfpk_partsupp_part#5084 AS cfpk_partsupp_part_4#5098, cpfk_supplier_partsupp#5085 AS cpfk_supplier_partsupp_4#5099, cfpk_partsupp_supplier#5086 AS cfpk_partsupp_supplier_4#5100, cval_partsupp_ps_availqty#5087 AS cval_partsupp_ps_availqty_4#5101, cval_partsupp_ps_supplycost#5088 AS cval_partsupp_ps_supplycost_4#5102, cval_partsupp_ps_comment#5089 AS cval_partsupp_ps_comment_4#5103, cdepval_partsupp_ps_availqty#5090 AS cdepval_partsupp_ps_availqty_4#5104, cdepval_partsupp_ps_supplycost#5091 AS cdepval_partsupp_ps_supplycost_4#5105, cdepval_partsupp_ps_comment#5092 AS cdepval_partsupp_ps_comment_4#5106, cps_availqty#5093 AS cps_availqty_4#5107, cps_supplycost#5094 AS cps_supplycost_4#5108, cps_comment#5095 AS cps_comment_4#5109]
         :     +- Relation[rid#5082,cpfk_part_partsupp#5083,cfpk_partsupp_part#5084,cpfk_supplier_partsupp#5085,cfpk_partsupp_supplier#5086,cval_partsupp_ps_availqty#5087,cval_partsupp_ps_supplycost#5088,cval_partsupp_ps_comment#5089,cdepval_partsupp_ps_availqty#5090,cdepval_partsupp_ps_supplycost#5091,cdepval_partsupp_ps_comment#5092,cps_availqty#5093,cps_supplycost#5094,cps_comment#5095] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#5110 AS rid_5#5134, cpfk_customer_orders#5111 AS cpfk_customer_orders_5#5135, cfpk_orders_customer#5112 AS cfpk_orders_customer_5#5136, cval_orders_o_orderstatus#5113 AS cval_orders_o_orderstatus_5#5137, cval_orders_o_totalprice#5114 AS cval_orders_o_totalprice_5#5138, cval_orders_o_orderpriority#5115 AS cval_orders_o_orderpriority_5#5139, cval_orders_o_clerk#5116 AS cval_orders_o_clerk_5#5140, cval_orders_o_shippriority#5117 AS cval_orders_o_shippriority_5#5141, cval_orders_o_comment#5118 AS cval_orders_o_comment_5#5142, cval_orders_o_orderdate#5119 AS cval_orders_o_orderdate_5#5143, cdepval_orders_o_orderstatus#5120 AS cdepval_orders_o_orderstatus_5#5144, cdepval_orders_o_totalprice#5121 AS cdepval_orders_o_totalprice_5#5145, cdepval_orders_o_orderpriority#5122 AS cdepval_orders_o_orderpriority_5#5146, cdepval_orders_o_clerk#5123 AS cdepval_orders_o_clerk_5#5147, cdepval_orders_o_shippriority#5124 AS cdepval_orders_o_shippriority_5#5148, cdepval_orders_o_comment#5125 AS cdepval_orders_o_comment_5#5149, cdepval_orders_o_orderdate#5126 AS cdepval_orders_o_orderdate_5#5150, co_orderstatus#5127 AS co_orderstatus_5#5151, co_totalprice#5128 AS co_totalprice_5#5152, co_orderpriority#5129 AS co_orderpriority_5#5153, co_clerk#5130 AS co_clerk_5#5154, co_shippriority#5131 AS co_shippriority_5#5155, co_comment#5132 AS co_comment_5#5156, co_orderdate#5133 AS co_orderdate_5#5157]
            +- Relation[rid#5110,cpfk_customer_orders#5111,cfpk_orders_customer#5112,cval_orders_o_orderstatus#5113,cval_orders_o_totalprice#5114,cval_orders_o_orderpriority#5115,cval_orders_o_clerk#5116,cval_orders_o_shippriority#5117,cval_orders_o_comment#5118,cval_orders_o_orderdate#5119,cdepval_orders_o_orderstatus#5120,cdepval_orders_o_totalprice#5121,cdepval_orders_o_orderpriority#5122,cdepval_orders_o_clerk#5123,cdepval_orders_o_shippriority#5124,cdepval_orders_o_comment#5125,cdepval_orders_o_orderdate#5126,co_orderstatus#5127,co_totalprice#5128,co_orderpriority#5129,co_clerk#5130,co_shippriority#5131,co_comment#5132,co_orderdate#5133] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 62641ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/26 21:45:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:45:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5301L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:45:52 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:45:52 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:45:52 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:45:52 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:45:52 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:45:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5301L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#5525 AS rid_2#5570, cpfk_orders_lineitem#5526 AS cpfk_orders_lineitem_2#5571, cpfk_supplier_lineitem#5527 AS cpfk_supplier_lineitem_2#5572, cfpk_lineitem_supplier#5528 AS cfpk_lineitem_supplier_2#5573, cfpk_lineitem_partsupp#5529 AS cfpk_lineitem_partsupp_2#5574, cpfk_part_lineitem#5530 AS cpfk_part_lineitem_2#5575, cfpk_lineitem_part#5531 AS cfpk_lineitem_part_2#5576, cpfk_partsupp_lineitem#5532 AS cpfk_partsupp_lineitem_2#5577, cfpk_lineitem_orders#5533 AS cfpk_lineitem_orders_2#5578, cval_lineitem_l_quantity#5534 AS cval_lineitem_l_quantity_2#5579, cval_lineitem_l_extendedprice#5535 AS cval_lineitem_l_extendedprice_2#5580, cval_lineitem_l_discount#5536 AS cval_lineitem_l_discount_2#5581, cval_lineitem_l_tax#5537 AS cval_lineitem_l_tax_2#5582, cval_lineitem_l_returnflag#5538 AS cval_lineitem_l_returnflag_2#5583, cval_lineitem_l_linestatus#5539 AS cval_lineitem_l_linestatus_2#5584, cval_lineitem_l_commitdate#5540 AS cval_lineitem_l_commitdate_2#5585, cval_lineitem_l_receiptdate#5541 AS cval_lineitem_l_receiptdate_2#5586, cval_lineitem_l_shipinstruct#5542 AS cval_lineitem_l_shipinstruct_2#5587, cval_lineitem_l_shipmode#5543 AS cval_lineitem_l_shipmode_2#5588, cval_lineitem_l_comment#5544 AS cval_lineitem_l_comment_2#5589, cval_lineitem_l_shipdate#5545 AS cval_lineitem_l_shipdate_2#5590, cdepval_lineitem_l_quantity#5546 AS cdepval_lineitem_l_quantity_2#5591, cdepval_lineitem_l_extendedprice#5547 AS cdepval_lineitem_l_extendedprice_2#5592, cdepval_lineitem_l_discount#5548 AS cdepval_lineitem_l_discount_2#5593, ... 21 more fields]
         :  +- Relation[rid#5525,cpfk_orders_lineitem#5526,cpfk_supplier_lineitem#5527,cfpk_lineitem_supplier#5528,cfpk_lineitem_partsupp#5529,cpfk_part_lineitem#5530,cfpk_lineitem_part#5531,cpfk_partsupp_lineitem#5532,cfpk_lineitem_orders#5533,cval_lineitem_l_quantity#5534,cval_lineitem_l_extendedprice#5535,cval_lineitem_l_discount#5536,cval_lineitem_l_tax#5537,cval_lineitem_l_returnflag#5538,cval_lineitem_l_linestatus#5539,cval_lineitem_l_commitdate#5540,cval_lineitem_l_receiptdate#5541,cval_lineitem_l_shipinstruct#5542,cval_lineitem_l_shipmode#5543,cval_lineitem_l_comment#5544,cval_lineitem_l_shipdate#5545,cdepval_lineitem_l_quantity#5546,cdepval_lineitem_l_extendedprice#5547,cdepval_lineitem_l_discount#5548,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin customer~orders, 'cpfk_customer_orders_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#5324, cpfk_nation_customer_0#5325, cfpk_customer_nation_0#5326, cval_customer_c_name_0#5327, cval_customer_c_address_0#5328, cval_customer_c_phone_0#5329, cval_customer_c_acctbal_0#5330, cval_customer_c_comment_0#5331, cval_customer_c_mktsegment_0#5332, cdepval_customer_c_name_0#5333, cdepval_customer_c_address_0#5334, cdepval_customer_c_phone_0#5335, cdepval_customer_c_acctbal_0#5336, cdepval_customer_c_comment_0#5337, cdepval_customer_c_mktsegment_0#5338, cc_name_0#5339, cc_address_0#5340, cc_phone_0#5341, cc_acctbal_0#5342, cc_comment_0#5343, cc_mktsegment_0#5344, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
            :  :  +- Project [rid#5303 AS rid_0#5324, cpfk_nation_customer#5304 AS cpfk_nation_customer_0#5325, cfpk_customer_nation#5305 AS cfpk_customer_nation_0#5326, cval_customer_c_name#5306 AS cval_customer_c_name_0#5327, cval_customer_c_address#5307 AS cval_customer_c_address_0#5328, cval_customer_c_phone#5308 AS cval_customer_c_phone_0#5329, cval_customer_c_acctbal#5309 AS cval_customer_c_acctbal_0#5330, cval_customer_c_comment#5310 AS cval_customer_c_comment_0#5331, cval_customer_c_mktsegment#5311 AS cval_customer_c_mktsegment_0#5332, cdepval_customer_c_name#5312 AS cdepval_customer_c_name_0#5333, cdepval_customer_c_address#5313 AS cdepval_customer_c_address_0#5334, cdepval_customer_c_phone#5314 AS cdepval_customer_c_phone_0#5335, cdepval_customer_c_acctbal#5315 AS cdepval_customer_c_acctbal_0#5336, cdepval_customer_c_comment#5316 AS cdepval_customer_c_comment_0#5337, cdepval_customer_c_mktsegment#5317 AS cdepval_customer_c_mktsegment_0#5338, cc_name#5318 AS cc_name_0#5339, cc_address#5319 AS cc_address_0#5340, cc_phone#5320 AS cc_phone_0#5341, cc_acctbal#5321 AS cc_acctbal_0#5342, cc_comment#5322 AS cc_comment_0#5343, cc_mktsegment#5323 AS cc_mktsegment_0#5344]
            :  :     +- Relation[rid#5303,cpfk_nation_customer#5304,cfpk_customer_nation#5305,cval_customer_c_name#5306,cval_customer_c_address#5307,cval_customer_c_phone#5308,cval_customer_c_acctbal#5309,cval_customer_c_comment#5310,cval_customer_c_mktsegment#5311,cdepval_customer_c_name#5312,cdepval_customer_c_address#5313,cdepval_customer_c_phone#5314,cdepval_customer_c_acctbal#5315,cdepval_customer_c_comment#5316,cdepval_customer_c_mktsegment#5317,cc_name#5318,cc_address#5319,cc_phone#5320,cc_acctbal#5321,cc_comment#5322,cc_mktsegment#5323] JDBCRelation(tcustomer) [numPartitions=1]
            :  +- 'Project ['cpfk_customer_orders_1, 'rid_1]
            :     +- Project [rid#5477 AS rid_1#5501, cpfk_customer_orders#5478 AS cpfk_customer_orders_1#5502, cfpk_orders_customer#5479 AS cfpk_orders_customer_1#5503, cval_orders_o_orderstatus#5480 AS cval_orders_o_orderstatus_1#5504, cval_orders_o_totalprice#5481 AS cval_orders_o_totalprice_1#5505, cval_orders_o_orderpriority#5482 AS cval_orders_o_orderpriority_1#5506, cval_orders_o_clerk#5483 AS cval_orders_o_clerk_1#5507, cval_orders_o_shippriority#5484 AS cval_orders_o_shippriority_1#5508, cval_orders_o_comment#5485 AS cval_orders_o_comment_1#5509, cval_orders_o_orderdate#5486 AS cval_orders_o_orderdate_1#5510, cdepval_orders_o_orderstatus#5487 AS cdepval_orders_o_orderstatus_1#5511, cdepval_orders_o_totalprice#5488 AS cdepval_orders_o_totalprice_1#5512, cdepval_orders_o_orderpriority#5489 AS cdepval_orders_o_orderpriority_1#5513, cdepval_orders_o_clerk#5490 AS cdepval_orders_o_clerk_1#5514, cdepval_orders_o_shippriority#5491 AS cdepval_orders_o_shippriority_1#5515, cdepval_orders_o_comment#5492 AS cdepval_orders_o_comment_1#5516, cdepval_orders_o_orderdate#5493 AS cdepval_orders_o_orderdate_1#5517, co_orderstatus#5494 AS co_orderstatus_1#5518, co_totalprice#5495 AS co_totalprice_1#5519, co_orderpriority#5496 AS co_orderpriority_1#5520, co_clerk#5497 AS co_clerk_1#5521, co_shippriority#5498 AS co_shippriority_1#5522, co_comment#5499 AS co_comment_1#5523, co_orderdate#5500 AS co_orderdate_1#5524]
            :        +- Relation[rid#5477,cpfk_customer_orders#5478,cfpk_orders_customer#5479,cval_orders_o_orderstatus#5480,cval_orders_o_totalprice#5481,cval_orders_o_orderpriority#5482,cval_orders_o_clerk#5483,cval_orders_o_shippriority#5484,cval_orders_o_comment#5485,cval_orders_o_orderdate#5486,cdepval_orders_o_orderstatus#5487,cdepval_orders_o_totalprice#5488,cdepval_orders_o_orderpriority#5489,cdepval_orders_o_clerk#5490,cdepval_orders_o_shippriority#5491,cdepval_orders_o_comment#5492,cdepval_orders_o_orderdate#5493,co_orderstatus#5494,co_totalprice#5495,co_orderpriority#5496,co_clerk#5497,co_shippriority#5498,co_comment#5499,co_orderdate#5500] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#5387 AS rid_1#5411, cpfk_customer_orders#5388 AS cpfk_customer_orders_1#5412, cfpk_orders_customer#5389 AS cfpk_orders_customer_1#5413, cval_orders_o_orderstatus#5390 AS cval_orders_o_orderstatus_1#5414, cval_orders_o_totalprice#5391 AS cval_orders_o_totalprice_1#5415, cval_orders_o_orderpriority#5392 AS cval_orders_o_orderpriority_1#5416, cval_orders_o_clerk#5393 AS cval_orders_o_clerk_1#5417, cval_orders_o_shippriority#5394 AS cval_orders_o_shippriority_1#5418, cval_orders_o_comment#5395 AS cval_orders_o_comment_1#5419, cval_orders_o_orderdate#5396 AS cval_orders_o_orderdate_1#5420, cdepval_orders_o_orderstatus#5397 AS cdepval_orders_o_orderstatus_1#5421, cdepval_orders_o_totalprice#5398 AS cdepval_orders_o_totalprice_1#5422, cdepval_orders_o_orderpriority#5399 AS cdepval_orders_o_orderpriority_1#5423, cdepval_orders_o_clerk#5400 AS cdepval_orders_o_clerk_1#5424, cdepval_orders_o_shippriority#5401 AS cdepval_orders_o_shippriority_1#5425, cdepval_orders_o_comment#5402 AS cdepval_orders_o_comment_1#5426, cdepval_orders_o_orderdate#5403 AS cdepval_orders_o_orderdate_1#5427, co_orderstatus#5404 AS co_orderstatus_1#5428, co_totalprice#5405 AS co_totalprice_1#5429, co_orderpriority#5406 AS co_orderpriority_1#5430, co_clerk#5407 AS co_clerk_1#5431, co_shippriority#5408 AS co_shippriority_1#5432, co_comment#5409 AS co_comment_1#5433, co_orderdate#5410 AS co_orderdate_1#5434]
               +- Relation[rid#5387,cpfk_customer_orders#5388,cfpk_orders_customer#5389,cval_orders_o_orderstatus#5390,cval_orders_o_totalprice#5391,cval_orders_o_orderpriority#5392,cval_orders_o_clerk#5393,cval_orders_o_shippriority#5394,cval_orders_o_comment#5395,cval_orders_o_orderdate#5396,cdepval_orders_o_orderstatus#5397,cdepval_orders_o_totalprice#5398,cdepval_orders_o_orderpriority#5399,cdepval_orders_o_clerk#5400,cdepval_orders_o_shippriority#5401,cdepval_orders_o_comment#5402,cdepval_orders_o_orderdate#5403,co_orderstatus#5404,co_totalprice#5405,co_orderpriority#5406,co_clerk#5407,co_shippriority#5408,co_comment#5409,co_orderdate#5410] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 23948ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/26 21:46:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:46:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5717L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 21:46:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:46:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:46:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5717L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#5719 AS rid_0#5764, cpfk_orders_lineitem#5720 AS cpfk_orders_lineitem_0#5765, cpfk_supplier_lineitem#5721 AS cpfk_supplier_lineitem_0#5766, cfpk_lineitem_supplier#5722 AS cfpk_lineitem_supplier_0#5767, cfpk_lineitem_partsupp#5723 AS cfpk_lineitem_partsupp_0#5768, cpfk_part_lineitem#5724 AS cpfk_part_lineitem_0#5769, cfpk_lineitem_part#5725 AS cfpk_lineitem_part_0#5770, cpfk_partsupp_lineitem#5726 AS cpfk_partsupp_lineitem_0#5771, cfpk_lineitem_orders#5727 AS cfpk_lineitem_orders_0#5772, cval_lineitem_l_quantity#5728 AS cval_lineitem_l_quantity_0#5773, cval_lineitem_l_extendedprice#5729 AS cval_lineitem_l_extendedprice_0#5774, cval_lineitem_l_discount#5730 AS cval_lineitem_l_discount_0#5775, cval_lineitem_l_tax#5731 AS cval_lineitem_l_tax_0#5776, cval_lineitem_l_returnflag#5732 AS cval_lineitem_l_returnflag_0#5777, cval_lineitem_l_linestatus#5733 AS cval_lineitem_l_linestatus_0#5778, cval_lineitem_l_commitdate#5734 AS cval_lineitem_l_commitdate_0#5779, cval_lineitem_l_receiptdate#5735 AS cval_lineitem_l_receiptdate_0#5780, cval_lineitem_l_shipinstruct#5736 AS cval_lineitem_l_shipinstruct_0#5781, cval_lineitem_l_shipmode#5737 AS cval_lineitem_l_shipmode_0#5782, cval_lineitem_l_comment#5738 AS cval_lineitem_l_comment_0#5783, cval_lineitem_l_shipdate#5739 AS cval_lineitem_l_shipdate_0#5784, cdepval_lineitem_l_quantity#5740 AS cdepval_lineitem_l_quantity_0#5785, cdepval_lineitem_l_extendedprice#5741 AS cdepval_lineitem_l_extendedprice_0#5786, cdepval_lineitem_l_discount#5742 AS cdepval_lineitem_l_discount_0#5787, ... 21 more fields]
         :  :  :     +- Relation[rid#5719,cpfk_orders_lineitem#5720,cpfk_supplier_lineitem#5721,cfpk_lineitem_supplier#5722,cfpk_lineitem_partsupp#5723,cpfk_part_lineitem#5724,cfpk_lineitem_part#5725,cpfk_partsupp_lineitem#5726,cfpk_lineitem_orders#5727,cval_lineitem_l_quantity#5728,cval_lineitem_l_extendedprice#5729,cval_lineitem_l_discount#5730,cval_lineitem_l_tax#5731,cval_lineitem_l_returnflag#5732,cval_lineitem_l_linestatus#5733,cval_lineitem_l_commitdate#5734,cval_lineitem_l_receiptdate#5735,cval_lineitem_l_shipinstruct#5736,cval_lineitem_l_shipmode#5737,cval_lineitem_l_comment#5738,cval_lineitem_l_shipdate#5739,cdepval_lineitem_l_quantity#5740,cdepval_lineitem_l_extendedprice#5741,cdepval_lineitem_l_discount#5742,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#5899 AS rid_1#5923, cpfk_customer_orders#5900 AS cpfk_customer_orders_1#5924, cfpk_orders_customer#5901 AS cfpk_orders_customer_1#5925, cval_orders_o_orderstatus#5902 AS cval_orders_o_orderstatus_1#5926, cval_orders_o_totalprice#5903 AS cval_orders_o_totalprice_1#5927, cval_orders_o_orderpriority#5904 AS cval_orders_o_orderpriority_1#5928, cval_orders_o_clerk#5905 AS cval_orders_o_clerk_1#5929, cval_orders_o_shippriority#5906 AS cval_orders_o_shippriority_1#5930, cval_orders_o_comment#5907 AS cval_orders_o_comment_1#5931, cval_orders_o_orderdate#5908 AS cval_orders_o_orderdate_1#5932, cdepval_orders_o_orderstatus#5909 AS cdepval_orders_o_orderstatus_1#5933, cdepval_orders_o_totalprice#5910 AS cdepval_orders_o_totalprice_1#5934, cdepval_orders_o_orderpriority#5911 AS cdepval_orders_o_orderpriority_1#5935, cdepval_orders_o_clerk#5912 AS cdepval_orders_o_clerk_1#5936, cdepval_orders_o_shippriority#5913 AS cdepval_orders_o_shippriority_1#5937, cdepval_orders_o_comment#5914 AS cdepval_orders_o_comment_1#5938, cdepval_orders_o_orderdate#5915 AS cdepval_orders_o_orderdate_1#5939, co_orderstatus#5916 AS co_orderstatus_1#5940, co_totalprice#5917 AS co_totalprice_1#5941, co_orderpriority#5918 AS co_orderpriority_1#5942, co_clerk#5919 AS co_clerk_1#5943, co_shippriority#5920 AS co_shippriority_1#5944, co_comment#5921 AS co_comment_1#5945, co_orderdate#5922 AS co_orderdate_1#5946]
         :  :     +- Relation[rid#5899,cpfk_customer_orders#5900,cfpk_orders_customer#5901,cval_orders_o_orderstatus#5902,cval_orders_o_totalprice#5903,cval_orders_o_orderpriority#5904,cval_orders_o_clerk#5905,cval_orders_o_shippriority#5906,cval_orders_o_comment#5907,cval_orders_o_orderdate#5908,cdepval_orders_o_orderstatus#5909,cdepval_orders_o_totalprice#5910,cdepval_orders_o_orderpriority#5911,cdepval_orders_o_clerk#5912,cdepval_orders_o_shippriority#5913,cdepval_orders_o_comment#5914,cdepval_orders_o_orderdate#5915,co_orderstatus#5916,co_totalprice#5917,co_orderpriority#5918,co_clerk#5919,co_shippriority#5920,co_comment#5921,co_orderdate#5922] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#5947 AS rid_2#5968, cpfk_nation_customer#5948 AS cpfk_nation_customer_2#5969, cfpk_customer_nation#5949 AS cfpk_customer_nation_2#5970, cval_customer_c_name#5950 AS cval_customer_c_name_2#5971, cval_customer_c_address#5951 AS cval_customer_c_address_2#5972, cval_customer_c_phone#5952 AS cval_customer_c_phone_2#5973, cval_customer_c_acctbal#5953 AS cval_customer_c_acctbal_2#5974, cval_customer_c_comment#5954 AS cval_customer_c_comment_2#5975, cval_customer_c_mktsegment#5955 AS cval_customer_c_mktsegment_2#5976, cdepval_customer_c_name#5956 AS cdepval_customer_c_name_2#5977, cdepval_customer_c_address#5957 AS cdepval_customer_c_address_2#5978, cdepval_customer_c_phone#5958 AS cdepval_customer_c_phone_2#5979, cdepval_customer_c_acctbal#5959 AS cdepval_customer_c_acctbal_2#5980, cdepval_customer_c_comment#5960 AS cdepval_customer_c_comment_2#5981, cdepval_customer_c_mktsegment#5961 AS cdepval_customer_c_mktsegment_2#5982, cc_name#5962 AS cc_name_2#5983, cc_address#5963 AS cc_address_2#5984, cc_phone#5964 AS cc_phone_2#5985, cc_acctbal#5965 AS cc_acctbal_2#5986, cc_comment#5966 AS cc_comment_2#5987, cc_mktsegment#5967 AS cc_mktsegment_2#5988]
         :     +- Relation[rid#5947,cpfk_nation_customer#5948,cfpk_customer_nation#5949,cval_customer_c_name#5950,cval_customer_c_address#5951,cval_customer_c_phone#5952,cval_customer_c_acctbal#5953,cval_customer_c_comment#5954,cval_customer_c_mktsegment#5955,cdepval_customer_c_name#5956,cdepval_customer_c_address#5957,cdepval_customer_c_phone#5958,cdepval_customer_c_acctbal#5959,cdepval_customer_c_comment#5960,cdepval_customer_c_mktsegment#5961,cc_name#5962,cc_address#5963,cc_phone#5964,cc_acctbal#5965,cc_comment#5966,cc_mktsegment#5967] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#5989 AS rid_3#5998, cpfk_region_nation#5990 AS cpfk_region_nation_3#5999, cfpk_nation_region#5991 AS cfpk_nation_region_3#6000, cval_nation_n_name#5992 AS cval_nation_n_name_3#6001, cval_nation_n_comment#5993 AS cval_nation_n_comment_3#6002, cdepval_nation_n_name#5994 AS cdepval_nation_n_name_3#6003, cdepval_nation_n_comment#5995 AS cdepval_nation_n_comment_3#6004, cn_name#5996 AS cn_name_3#6005, cn_comment#5997 AS cn_comment_3#6006]
            +- Relation[rid#5989,cpfk_region_nation#5990,cfpk_nation_region#5991,cval_nation_n_name#5992,cval_nation_n_comment#5993,cdepval_nation_n_name#5994,cdepval_nation_n_comment#5995,cn_name#5996,cn_comment#5997] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 57246ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/26 21:47:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:47:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6111L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 21:47:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6111L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#6113 AS rid_0#6137, cpfk_customer_orders#6114 AS cpfk_customer_orders_0#6138, cfpk_orders_customer#6115 AS cfpk_orders_customer_0#6139, cval_orders_o_orderstatus#6116 AS cval_orders_o_orderstatus_0#6140, cval_orders_o_totalprice#6117 AS cval_orders_o_totalprice_0#6141, cval_orders_o_orderpriority#6118 AS cval_orders_o_orderpriority_0#6142, cval_orders_o_clerk#6119 AS cval_orders_o_clerk_0#6143, cval_orders_o_shippriority#6120 AS cval_orders_o_shippriority_0#6144, cval_orders_o_comment#6121 AS cval_orders_o_comment_0#6145, cval_orders_o_orderdate#6122 AS cval_orders_o_orderdate_0#6146, cdepval_orders_o_orderstatus#6123 AS cdepval_orders_o_orderstatus_0#6147, cdepval_orders_o_totalprice#6124 AS cdepval_orders_o_totalprice_0#6148, cdepval_orders_o_orderpriority#6125 AS cdepval_orders_o_orderpriority_0#6149, cdepval_orders_o_clerk#6126 AS cdepval_orders_o_clerk_0#6150, cdepval_orders_o_shippriority#6127 AS cdepval_orders_o_shippriority_0#6151, cdepval_orders_o_comment#6128 AS cdepval_orders_o_comment_0#6152, cdepval_orders_o_orderdate#6129 AS cdepval_orders_o_orderdate_0#6153, co_orderstatus#6130 AS co_orderstatus_0#6154, co_totalprice#6131 AS co_totalprice_0#6155, co_orderpriority#6132 AS co_orderpriority_0#6156, co_clerk#6133 AS co_clerk_0#6157, co_shippriority#6134 AS co_shippriority_0#6158, co_comment#6135 AS co_comment_0#6159, co_orderdate#6136 AS co_orderdate_0#6160]
         :  +- Relation[rid#6113,cpfk_customer_orders#6114,cfpk_orders_customer#6115,cval_orders_o_orderstatus#6116,cval_orders_o_totalprice#6117,cval_orders_o_orderpriority#6118,cval_orders_o_clerk#6119,cval_orders_o_shippriority#6120,cval_orders_o_comment#6121,cval_orders_o_orderdate#6122,cdepval_orders_o_orderstatus#6123,cdepval_orders_o_totalprice#6124,cdepval_orders_o_orderpriority#6125,cdepval_orders_o_clerk#6126,cdepval_orders_o_shippriority#6127,cdepval_orders_o_comment#6128,cdepval_orders_o_orderdate#6129,co_orderstatus#6130,co_totalprice#6131,co_orderpriority#6132,co_clerk#6133,co_shippriority#6134,co_comment#6135,co_orderdate#6136] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#6161 AS rid_1#6182, cpfk_nation_customer#6162 AS cpfk_nation_customer_1#6183, cfpk_customer_nation#6163 AS cfpk_customer_nation_1#6184, cval_customer_c_name#6164 AS cval_customer_c_name_1#6185, cval_customer_c_address#6165 AS cval_customer_c_address_1#6186, cval_customer_c_phone#6166 AS cval_customer_c_phone_1#6187, cval_customer_c_acctbal#6167 AS cval_customer_c_acctbal_1#6188, cval_customer_c_comment#6168 AS cval_customer_c_comment_1#6189, cval_customer_c_mktsegment#6169 AS cval_customer_c_mktsegment_1#6190, cdepval_customer_c_name#6170 AS cdepval_customer_c_name_1#6191, cdepval_customer_c_address#6171 AS cdepval_customer_c_address_1#6192, cdepval_customer_c_phone#6172 AS cdepval_customer_c_phone_1#6193, cdepval_customer_c_acctbal#6173 AS cdepval_customer_c_acctbal_1#6194, cdepval_customer_c_comment#6174 AS cdepval_customer_c_comment_1#6195, cdepval_customer_c_mktsegment#6175 AS cdepval_customer_c_mktsegment_1#6196, cc_name#6176 AS cc_name_1#6197, cc_address#6177 AS cc_address_1#6198, cc_phone#6178 AS cc_phone_1#6199, cc_acctbal#6179 AS cc_acctbal_1#6200, cc_comment#6180 AS cc_comment_1#6201, cc_mktsegment#6181 AS cc_mktsegment_1#6202]
            +- Relation[rid#6161,cpfk_nation_customer#6162,cfpk_customer_nation#6163,cval_customer_c_name#6164,cval_customer_c_address#6165,cval_customer_c_phone#6166,cval_customer_c_acctbal#6167,cval_customer_c_comment#6168,cval_customer_c_mktsegment#6169,cdepval_customer_c_name#6170,cdepval_customer_c_address#6171,cdepval_customer_c_phone#6172,cdepval_customer_c_acctbal#6173,cdepval_customer_c_comment#6174,cdepval_customer_c_mktsegment#6175,cc_name#6176,cc_address#6177,cc_phone#6178,cc_acctbal#6179,cc_comment#6180,cc_mktsegment#6181] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4388ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/26 21:47:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:47:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6254L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 21:47:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:47:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:47:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:47:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:47:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:47:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:47:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:47:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:47:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:47:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:47:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:47:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6254L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#6382 AS rid_2#6396, cpfk_part_partsupp#6383 AS cpfk_part_partsupp_2#6397, cfpk_partsupp_part#6384 AS cfpk_partsupp_part_2#6398, cpfk_supplier_partsupp#6385 AS cpfk_supplier_partsupp_2#6399, cfpk_partsupp_supplier#6386 AS cfpk_partsupp_supplier_2#6400, cval_partsupp_ps_availqty#6387 AS cval_partsupp_ps_availqty_2#6401, cval_partsupp_ps_supplycost#6388 AS cval_partsupp_ps_supplycost_2#6402, cval_partsupp_ps_comment#6389 AS cval_partsupp_ps_comment_2#6403, cdepval_partsupp_ps_availqty#6390 AS cdepval_partsupp_ps_availqty_2#6404, cdepval_partsupp_ps_supplycost#6391 AS cdepval_partsupp_ps_supplycost_2#6405, cdepval_partsupp_ps_comment#6392 AS cdepval_partsupp_ps_comment_2#6406, cps_availqty#6393 AS cps_availqty_2#6407, cps_supplycost#6394 AS cps_supplycost_2#6408, cps_comment#6395 AS cps_comment_2#6409]
         :  +- Relation[rid#6382,cpfk_part_partsupp#6383,cfpk_partsupp_part#6384,cpfk_supplier_partsupp#6385,cfpk_partsupp_supplier#6386,cval_partsupp_ps_availqty#6387,cval_partsupp_ps_supplycost#6388,cval_partsupp_ps_comment#6389,cdepval_partsupp_ps_availqty#6390,cdepval_partsupp_ps_supplycost#6391,cdepval_partsupp_ps_comment#6392,cps_availqty#6393,cps_supplycost#6394,cps_comment#6395] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6265, cpfk_region_nation_0#6266, cfpk_nation_region_0#6267, cval_nation_n_name_0#6268, cval_nation_n_comment_0#6269, cdepval_nation_n_name_0#6270, cdepval_nation_n_comment_0#6271, cn_name_0#6272, cn_comment_0#6273, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
            :  :  +- Project [rid#6256 AS rid_0#6265, cpfk_region_nation#6257 AS cpfk_region_nation_0#6266, cfpk_nation_region#6258 AS cfpk_nation_region_0#6267, cval_nation_n_name#6259 AS cval_nation_n_name_0#6268, cval_nation_n_comment#6260 AS cval_nation_n_comment_0#6269, cdepval_nation_n_name#6261 AS cdepval_nation_n_name_0#6270, cdepval_nation_n_comment#6262 AS cdepval_nation_n_comment_0#6271, cn_name#6263 AS cn_name_0#6272, cn_comment#6264 AS cn_comment_0#6273]
            :  :     +- Relation[rid#6256,cpfk_region_nation#6257,cfpk_nation_region#6258,cval_nation_n_name#6259,cval_nation_n_comment#6260,cdepval_nation_n_name#6261,cdepval_nation_n_comment#6262,cn_name#6263,cn_comment#6264] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
            :     +- Project [rid#6346 AS rid_1#6364, cpfk_nation_supplier#6347 AS cpfk_nation_supplier_1#6365, cfpk_supplier_nation#6348 AS cfpk_supplier_nation_1#6366, cval_supplier_s_name#6349 AS cval_supplier_s_name_1#6367, cval_supplier_s_address#6350 AS cval_supplier_s_address_1#6368, cval_supplier_s_phone#6351 AS cval_supplier_s_phone_1#6369, cval_supplier_s_acctbal#6352 AS cval_supplier_s_acctbal_1#6370, cval_supplier_s_comment#6353 AS cval_supplier_s_comment_1#6371, cdepval_supplier_s_name#6354 AS cdepval_supplier_s_name_1#6372, cdepval_supplier_s_address#6355 AS cdepval_supplier_s_address_1#6373, cdepval_supplier_s_phone#6356 AS cdepval_supplier_s_phone_1#6374, cdepval_supplier_s_acctbal#6357 AS cdepval_supplier_s_acctbal_1#6375, cdepval_supplier_s_comment#6358 AS cdepval_supplier_s_comment_1#6376, cs_name#6359 AS cs_name_1#6377, cs_address#6360 AS cs_address_1#6378, cs_phone#6361 AS cs_phone_1#6379, cs_acctbal#6362 AS cs_acctbal_1#6380, cs_comment#6363 AS cs_comment_1#6381]
            :        +- Relation[rid#6346,cpfk_nation_supplier#6347,cfpk_supplier_nation#6348,cval_supplier_s_name#6349,cval_supplier_s_address#6350,cval_supplier_s_phone#6351,cval_supplier_s_acctbal#6352,cval_supplier_s_comment#6353,cdepval_supplier_s_name#6354,cdepval_supplier_s_address#6355,cdepval_supplier_s_phone#6356,cdepval_supplier_s_acctbal#6357,cdepval_supplier_s_comment#6358,cs_name#6359,cs_address#6360,cs_phone#6361,cs_acctbal#6362,cs_comment#6363] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#6292 AS rid_1#6310, cpfk_nation_supplier#6293 AS cpfk_nation_supplier_1#6311, cfpk_supplier_nation#6294 AS cfpk_supplier_nation_1#6312, cval_supplier_s_name#6295 AS cval_supplier_s_name_1#6313, cval_supplier_s_address#6296 AS cval_supplier_s_address_1#6314, cval_supplier_s_phone#6297 AS cval_supplier_s_phone_1#6315, cval_supplier_s_acctbal#6298 AS cval_supplier_s_acctbal_1#6316, cval_supplier_s_comment#6299 AS cval_supplier_s_comment_1#6317, cdepval_supplier_s_name#6300 AS cdepval_supplier_s_name_1#6318, cdepval_supplier_s_address#6301 AS cdepval_supplier_s_address_1#6319, cdepval_supplier_s_phone#6302 AS cdepval_supplier_s_phone_1#6320, cdepval_supplier_s_acctbal#6303 AS cdepval_supplier_s_acctbal_1#6321, cdepval_supplier_s_comment#6304 AS cdepval_supplier_s_comment_1#6322, cs_name#6305 AS cs_name_1#6323, cs_address#6306 AS cs_address_1#6324, cs_phone#6307 AS cs_phone_1#6325, cs_acctbal#6308 AS cs_acctbal_1#6326, cs_comment#6309 AS cs_comment_1#6327]
               +- Relation[rid#6292,cpfk_nation_supplier#6293,cfpk_supplier_nation#6294,cval_supplier_s_name#6295,cval_supplier_s_address#6296,cval_supplier_s_phone#6297,cval_supplier_s_acctbal#6298,cval_supplier_s_comment#6299,cdepval_supplier_s_name#6300,cdepval_supplier_s_address#6301,cdepval_supplier_s_phone#6302,cdepval_supplier_s_acctbal#6303,cdepval_supplier_s_comment#6304,cs_name#6305,cs_address#6306,cs_phone#6307,cs_acctbal#6308,cs_comment#6309] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 2502ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/26 21:47:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:47:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6456L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:47:20 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:47:20 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:47:20 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:47:20 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:47:20 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:47:20 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:47:20 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:47:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6456L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6483, cval_part_p_name_0#6484, cval_part_p_mfgr_0#6485, cval_part_p_type_0#6486, cval_part_p_size_0#6487, cval_part_p_container_0#6488, cval_part_p_retailprice_0#6489, cval_part_p_comment_0#6490, cval_part_p_brand_0#6491, cdepval_part_p_name_0#6492, cdepval_part_p_mfgr_0#6493, cdepval_part_p_type_0#6494, cdepval_part_p_size_0#6495, cdepval_part_p_container_0#6496, cdepval_part_p_retailprice_0#6497, cdepval_part_p_comment_0#6498, cdepval_part_p_brand_0#6499, cp_name_0#6500, cp_mfgr_0#6501, cp_type_0#6502, cp_size_0#6503, cp_container_0#6504, cp_retailprice_0#6505, cp_comment_0#6506, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#6458 AS rid_0#6483, cval_part_p_name#6459 AS cval_part_p_name_0#6484, cval_part_p_mfgr#6460 AS cval_part_p_mfgr_0#6485, cval_part_p_type#6461 AS cval_part_p_type_0#6486, cval_part_p_size#6462 AS cval_part_p_size_0#6487, cval_part_p_container#6463 AS cval_part_p_container_0#6488, cval_part_p_retailprice#6464 AS cval_part_p_retailprice_0#6489, cval_part_p_comment#6465 AS cval_part_p_comment_0#6490, cval_part_p_brand#6466 AS cval_part_p_brand_0#6491, cdepval_part_p_name#6467 AS cdepval_part_p_name_0#6492, cdepval_part_p_mfgr#6468 AS cdepval_part_p_mfgr_0#6493, cdepval_part_p_type#6469 AS cdepval_part_p_type_0#6494, cdepval_part_p_size#6470 AS cdepval_part_p_size_0#6495, cdepval_part_p_container#6471 AS cdepval_part_p_container_0#6496, cdepval_part_p_retailprice#6472 AS cdepval_part_p_retailprice_0#6497, cdepval_part_p_comment#6473 AS cdepval_part_p_comment_0#6498, cdepval_part_p_brand#6474 AS cdepval_part_p_brand_0#6499, cp_name#6475 AS cp_name_0#6500, cp_mfgr#6476 AS cp_mfgr_0#6501, cp_type#6477 AS cp_type_0#6502, cp_size#6478 AS cp_size_0#6503, cp_container#6479 AS cp_container_0#6504, cp_retailprice#6480 AS cp_retailprice_0#6505, cp_comment#6481 AS cp_comment_0#6506, cp_brand#6482 AS cp_brand_0#6507]
         :  :        +- Relation[rid#6458,cval_part_p_name#6459,cval_part_p_mfgr#6460,cval_part_p_type#6461,cval_part_p_size#6462,cval_part_p_container#6463,cval_part_p_retailprice#6464,cval_part_p_comment#6465,cval_part_p_brand#6466,cdepval_part_p_name#6467,cdepval_part_p_mfgr#6468,cdepval_part_p_type#6469,cdepval_part_p_size#6470,cdepval_part_p_container#6471,cdepval_part_p_retailprice#6472,cdepval_part_p_comment#6473,cdepval_part_p_brand#6474,cp_name#6475,cp_mfgr#6476,cp_type#6477,cp_size#6478,cp_container#6479,cp_retailprice#6480,cp_comment#6481,cp_brand#6482] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#6928 AS rid_1#6973, cpfk_orders_lineitem#6929 AS cpfk_orders_lineitem_1#6974, cpfk_supplier_lineitem#6930 AS cpfk_supplier_lineitem_1#6975, cfpk_lineitem_supplier#6931 AS cfpk_lineitem_supplier_1#6976, cfpk_lineitem_partsupp#6932 AS cfpk_lineitem_partsupp_1#6977, cpfk_part_lineitem#6933 AS cpfk_part_lineitem_1#6978, cfpk_lineitem_part#6934 AS cfpk_lineitem_part_1#6979, cpfk_partsupp_lineitem#6935 AS cpfk_partsupp_lineitem_1#6980, cfpk_lineitem_orders#6936 AS cfpk_lineitem_orders_1#6981, cval_lineitem_l_quantity#6937 AS cval_lineitem_l_quantity_1#6982, cval_lineitem_l_extendedprice#6938 AS cval_lineitem_l_extendedprice_1#6983, cval_lineitem_l_discount#6939 AS cval_lineitem_l_discount_1#6984, cval_lineitem_l_tax#6940 AS cval_lineitem_l_tax_1#6985, cval_lineitem_l_returnflag#6941 AS cval_lineitem_l_returnflag_1#6986, cval_lineitem_l_linestatus#6942 AS cval_lineitem_l_linestatus_1#6987, cval_lineitem_l_commitdate#6943 AS cval_lineitem_l_commitdate_1#6988, cval_lineitem_l_receiptdate#6944 AS cval_lineitem_l_receiptdate_1#6989, cval_lineitem_l_shipinstruct#6945 AS cval_lineitem_l_shipinstruct_1#6990, cval_lineitem_l_shipmode#6946 AS cval_lineitem_l_shipmode_1#6991, cval_lineitem_l_comment#6947 AS cval_lineitem_l_comment_1#6992, cval_lineitem_l_shipdate#6948 AS cval_lineitem_l_shipdate_1#6993, cdepval_lineitem_l_quantity#6949 AS cdepval_lineitem_l_quantity_1#6994, cdepval_lineitem_l_extendedprice#6950 AS cdepval_lineitem_l_extendedprice_1#6995, cdepval_lineitem_l_discount#6951 AS cdepval_lineitem_l_discount_1#6996, ... 21 more fields]
         :        +- Relation[rid#6928,cpfk_orders_lineitem#6929,cpfk_supplier_lineitem#6930,cfpk_lineitem_supplier#6931,cfpk_lineitem_partsupp#6932,cpfk_part_lineitem#6933,cfpk_lineitem_part#6934,cpfk_partsupp_lineitem#6935,cfpk_lineitem_orders#6936,cval_lineitem_l_quantity#6937,cval_lineitem_l_extendedprice#6938,cval_lineitem_l_discount#6939,cval_lineitem_l_tax#6940,cval_lineitem_l_returnflag#6941,cval_lineitem_l_linestatus#6942,cval_lineitem_l_commitdate#6943,cval_lineitem_l_receiptdate#6944,cval_lineitem_l_shipinstruct#6945,cval_lineitem_l_shipmode#6946,cval_lineitem_l_comment#6947,cval_lineitem_l_shipdate#6948,cdepval_lineitem_l_quantity#6949,cdepval_lineitem_l_extendedprice#6950,cdepval_lineitem_l_discount#6951,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#6608 AS rid_1#6653, cpfk_orders_lineitem#6609 AS cpfk_orders_lineitem_1#6654, cpfk_supplier_lineitem#6610 AS cpfk_supplier_lineitem_1#6655, cfpk_lineitem_supplier#6611 AS cfpk_lineitem_supplier_1#6656, cfpk_lineitem_partsupp#6612 AS cfpk_lineitem_partsupp_1#6657, cpfk_part_lineitem#6613 AS cpfk_part_lineitem_1#6658, cfpk_lineitem_part#6614 AS cfpk_lineitem_part_1#6659, cpfk_partsupp_lineitem#6615 AS cpfk_partsupp_lineitem_1#6660, cfpk_lineitem_orders#6616 AS cfpk_lineitem_orders_1#6661, cval_lineitem_l_quantity#6617 AS cval_lineitem_l_quantity_1#6662, cval_lineitem_l_extendedprice#6618 AS cval_lineitem_l_extendedprice_1#6663, cval_lineitem_l_discount#6619 AS cval_lineitem_l_discount_1#6664, cval_lineitem_l_tax#6620 AS cval_lineitem_l_tax_1#6665, cval_lineitem_l_returnflag#6621 AS cval_lineitem_l_returnflag_1#6666, cval_lineitem_l_linestatus#6622 AS cval_lineitem_l_linestatus_1#6667, cval_lineitem_l_commitdate#6623 AS cval_lineitem_l_commitdate_1#6668, cval_lineitem_l_receiptdate#6624 AS cval_lineitem_l_receiptdate_1#6669, cval_lineitem_l_shipinstruct#6625 AS cval_lineitem_l_shipinstruct_1#6670, cval_lineitem_l_shipmode#6626 AS cval_lineitem_l_shipmode_1#6671, cval_lineitem_l_comment#6627 AS cval_lineitem_l_comment_1#6672, cval_lineitem_l_shipdate#6628 AS cval_lineitem_l_shipdate_1#6673, cdepval_lineitem_l_quantity#6629 AS cdepval_lineitem_l_quantity_1#6674, cdepval_lineitem_l_extendedprice#6630 AS cdepval_lineitem_l_extendedprice_1#6675, cdepval_lineitem_l_discount#6631 AS cdepval_lineitem_l_discount_1#6676, ... 21 more fields]
                  +- Relation[rid#6608,cpfk_orders_lineitem#6609,cpfk_supplier_lineitem#6610,cfpk_lineitem_supplier#6611,cfpk_lineitem_partsupp#6612,cpfk_part_lineitem#6613,cfpk_lineitem_part#6614,cpfk_partsupp_lineitem#6615,cfpk_lineitem_orders#6616,cval_lineitem_l_quantity#6617,cval_lineitem_l_extendedprice#6618,cval_lineitem_l_discount#6619,cval_lineitem_l_tax#6620,cval_lineitem_l_returnflag#6621,cval_lineitem_l_linestatus#6622,cval_lineitem_l_commitdate#6623,cval_lineitem_l_receiptdate#6624,cval_lineitem_l_shipinstruct#6625,cval_lineitem_l_shipmode#6626,cval_lineitem_l_comment#6627,cval_lineitem_l_shipdate#6628,cdepval_lineitem_l_quantity#6629,cdepval_lineitem_l_extendedprice#6630,cdepval_lineitem_l_discount#6631,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 16721ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/26 21:47:37 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:47:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7094L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:47:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7094L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#7146 AS rid_1#7191, cpfk_orders_lineitem#7147 AS cpfk_orders_lineitem_1#7192, cpfk_supplier_lineitem#7148 AS cpfk_supplier_lineitem_1#7193, cfpk_lineitem_supplier#7149 AS cfpk_lineitem_supplier_1#7194, cfpk_lineitem_partsupp#7150 AS cfpk_lineitem_partsupp_1#7195, cpfk_part_lineitem#7151 AS cpfk_part_lineitem_1#7196, cfpk_lineitem_part#7152 AS cfpk_lineitem_part_1#7197, cpfk_partsupp_lineitem#7153 AS cpfk_partsupp_lineitem_1#7198, cfpk_lineitem_orders#7154 AS cfpk_lineitem_orders_1#7199, cval_lineitem_l_quantity#7155 AS cval_lineitem_l_quantity_1#7200, cval_lineitem_l_extendedprice#7156 AS cval_lineitem_l_extendedprice_1#7201, cval_lineitem_l_discount#7157 AS cval_lineitem_l_discount_1#7202, cval_lineitem_l_tax#7158 AS cval_lineitem_l_tax_1#7203, cval_lineitem_l_returnflag#7159 AS cval_lineitem_l_returnflag_1#7204, cval_lineitem_l_linestatus#7160 AS cval_lineitem_l_linestatus_1#7205, cval_lineitem_l_commitdate#7161 AS cval_lineitem_l_commitdate_1#7206, cval_lineitem_l_receiptdate#7162 AS cval_lineitem_l_receiptdate_1#7207, cval_lineitem_l_shipinstruct#7163 AS cval_lineitem_l_shipinstruct_1#7208, cval_lineitem_l_shipmode#7164 AS cval_lineitem_l_shipmode_1#7209, cval_lineitem_l_comment#7165 AS cval_lineitem_l_comment_1#7210, cval_lineitem_l_shipdate#7166 AS cval_lineitem_l_shipdate_1#7211, cdepval_lineitem_l_quantity#7167 AS cdepval_lineitem_l_quantity_1#7212, cdepval_lineitem_l_extendedprice#7168 AS cdepval_lineitem_l_extendedprice_1#7213, cdepval_lineitem_l_discount#7169 AS cdepval_lineitem_l_discount_1#7214, ... 21 more fields]
         :  +- Relation[rid#7146,cpfk_orders_lineitem#7147,cpfk_supplier_lineitem#7148,cfpk_lineitem_supplier#7149,cfpk_lineitem_partsupp#7150,cpfk_part_lineitem#7151,cfpk_lineitem_part#7152,cpfk_partsupp_lineitem#7153,cfpk_lineitem_orders#7154,cval_lineitem_l_quantity#7155,cval_lineitem_l_extendedprice#7156,cval_lineitem_l_discount#7157,cval_lineitem_l_tax#7158,cval_lineitem_l_returnflag#7159,cval_lineitem_l_linestatus#7160,cval_lineitem_l_commitdate#7161,cval_lineitem_l_receiptdate#7162,cval_lineitem_l_shipinstruct#7163,cval_lineitem_l_shipmode#7164,cval_lineitem_l_comment#7165,cval_lineitem_l_shipdate#7166,cdepval_lineitem_l_quantity#7167,cdepval_lineitem_l_extendedprice#7168,cdepval_lineitem_l_discount#7169,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7096 AS rid_0#7121, cval_part_p_name#7097 AS cval_part_p_name_0#7122, cval_part_p_mfgr#7098 AS cval_part_p_mfgr_0#7123, cval_part_p_type#7099 AS cval_part_p_type_0#7124, cval_part_p_size#7100 AS cval_part_p_size_0#7125, cval_part_p_container#7101 AS cval_part_p_container_0#7126, cval_part_p_retailprice#7102 AS cval_part_p_retailprice_0#7127, cval_part_p_comment#7103 AS cval_part_p_comment_0#7128, cval_part_p_brand#7104 AS cval_part_p_brand_0#7129, cdepval_part_p_name#7105 AS cdepval_part_p_name_0#7130, cdepval_part_p_mfgr#7106 AS cdepval_part_p_mfgr_0#7131, cdepval_part_p_type#7107 AS cdepval_part_p_type_0#7132, cdepval_part_p_size#7108 AS cdepval_part_p_size_0#7133, cdepval_part_p_container#7109 AS cdepval_part_p_container_0#7134, cdepval_part_p_retailprice#7110 AS cdepval_part_p_retailprice_0#7135, cdepval_part_p_comment#7111 AS cdepval_part_p_comment_0#7136, cdepval_part_p_brand#7112 AS cdepval_part_p_brand_0#7137, cp_name#7113 AS cp_name_0#7138, cp_mfgr#7114 AS cp_mfgr_0#7139, cp_type#7115 AS cp_type_0#7140, cp_size#7116 AS cp_size_0#7141, cp_container#7117 AS cp_container_0#7142, cp_retailprice#7118 AS cp_retailprice_0#7143, cp_comment#7119 AS cp_comment_0#7144, cp_brand#7120 AS cp_brand_0#7145]
            +- Relation[rid#7096,cval_part_p_name#7097,cval_part_p_mfgr#7098,cval_part_p_type#7099,cval_part_p_size#7100,cval_part_p_container#7101,cval_part_p_retailprice#7102,cval_part_p_comment#7103,cval_part_p_brand#7104,cdepval_part_p_name#7105,cdepval_part_p_mfgr#7106,cdepval_part_p_type#7107,cdepval_part_p_size#7108,cdepval_part_p_container#7109,cdepval_part_p_retailprice#7110,cdepval_part_p_comment#7111,cdepval_part_p_brand#7112,cp_name#7113,cp_mfgr#7114,cp_type#7115,cp_size#7116,cp_container#7117,cp_retailprice#7118,cp_comment#7119,cp_brand#7120] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17881ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/26 21:47:55 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:47:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7310L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 21:47:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7310L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#7312 AS rid_0#7336, cpfk_customer_orders#7313 AS cpfk_customer_orders_0#7337, cfpk_orders_customer#7314 AS cfpk_orders_customer_0#7338, cval_orders_o_orderstatus#7315 AS cval_orders_o_orderstatus_0#7339, cval_orders_o_totalprice#7316 AS cval_orders_o_totalprice_0#7340, cval_orders_o_orderpriority#7317 AS cval_orders_o_orderpriority_0#7341, cval_orders_o_clerk#7318 AS cval_orders_o_clerk_0#7342, cval_orders_o_shippriority#7319 AS cval_orders_o_shippriority_0#7343, cval_orders_o_comment#7320 AS cval_orders_o_comment_0#7344, cval_orders_o_orderdate#7321 AS cval_orders_o_orderdate_0#7345, cdepval_orders_o_orderstatus#7322 AS cdepval_orders_o_orderstatus_0#7346, cdepval_orders_o_totalprice#7323 AS cdepval_orders_o_totalprice_0#7347, cdepval_orders_o_orderpriority#7324 AS cdepval_orders_o_orderpriority_0#7348, cdepval_orders_o_clerk#7325 AS cdepval_orders_o_clerk_0#7349, cdepval_orders_o_shippriority#7326 AS cdepval_orders_o_shippriority_0#7350, cdepval_orders_o_comment#7327 AS cdepval_orders_o_comment_0#7351, cdepval_orders_o_orderdate#7328 AS cdepval_orders_o_orderdate_0#7352, co_orderstatus#7329 AS co_orderstatus_0#7353, co_totalprice#7330 AS co_totalprice_0#7354, co_orderpriority#7331 AS co_orderpriority_0#7355, co_clerk#7332 AS co_clerk_0#7356, co_shippriority#7333 AS co_shippriority_0#7357, co_comment#7334 AS co_comment_0#7358, co_orderdate#7335 AS co_orderdate_0#7359]
         :  +- Relation[rid#7312,cpfk_customer_orders#7313,cfpk_orders_customer#7314,cval_orders_o_orderstatus#7315,cval_orders_o_totalprice#7316,cval_orders_o_orderpriority#7317,cval_orders_o_clerk#7318,cval_orders_o_shippriority#7319,cval_orders_o_comment#7320,cval_orders_o_orderdate#7321,cdepval_orders_o_orderstatus#7322,cdepval_orders_o_totalprice#7323,cdepval_orders_o_orderpriority#7324,cdepval_orders_o_clerk#7325,cdepval_orders_o_shippriority#7326,cdepval_orders_o_comment#7327,cdepval_orders_o_orderdate#7328,co_orderstatus#7329,co_totalprice#7330,co_orderpriority#7331,co_clerk#7332,co_shippriority#7333,co_comment#7334,co_orderdate#7335] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#7360 AS rid_1#7381, cpfk_nation_customer#7361 AS cpfk_nation_customer_1#7382, cfpk_customer_nation#7362 AS cfpk_customer_nation_1#7383, cval_customer_c_name#7363 AS cval_customer_c_name_1#7384, cval_customer_c_address#7364 AS cval_customer_c_address_1#7385, cval_customer_c_phone#7365 AS cval_customer_c_phone_1#7386, cval_customer_c_acctbal#7366 AS cval_customer_c_acctbal_1#7387, cval_customer_c_comment#7367 AS cval_customer_c_comment_1#7388, cval_customer_c_mktsegment#7368 AS cval_customer_c_mktsegment_1#7389, cdepval_customer_c_name#7369 AS cdepval_customer_c_name_1#7390, cdepval_customer_c_address#7370 AS cdepval_customer_c_address_1#7391, cdepval_customer_c_phone#7371 AS cdepval_customer_c_phone_1#7392, cdepval_customer_c_acctbal#7372 AS cdepval_customer_c_acctbal_1#7393, cdepval_customer_c_comment#7373 AS cdepval_customer_c_comment_1#7394, cdepval_customer_c_mktsegment#7374 AS cdepval_customer_c_mktsegment_1#7395, cc_name#7375 AS cc_name_1#7396, cc_address#7376 AS cc_address_1#7397, cc_phone#7377 AS cc_phone_1#7398, cc_acctbal#7378 AS cc_acctbal_1#7399, cc_comment#7379 AS cc_comment_1#7400, cc_mktsegment#7380 AS cc_mktsegment_1#7401]
            +- Relation[rid#7360,cpfk_nation_customer#7361,cfpk_customer_nation#7362,cval_customer_c_name#7363,cval_customer_c_address#7364,cval_customer_c_phone#7365,cval_customer_c_acctbal#7366,cval_customer_c_comment#7367,cval_customer_c_mktsegment#7368,cdepval_customer_c_name#7369,cdepval_customer_c_address#7370,cdepval_customer_c_phone#7371,cdepval_customer_c_acctbal#7372,cdepval_customer_c_comment#7373,cdepval_customer_c_mktsegment#7374,cc_name#7375,cc_address#7376,cc_phone#7377,cc_acctbal#7378,cc_comment#7379,cc_mktsegment#7380] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4508ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/26 21:47:59 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:47:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7451L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:47:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7451L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#7453 AS rid_0#7498, cpfk_orders_lineitem#7454 AS cpfk_orders_lineitem_0#7499, cpfk_supplier_lineitem#7455 AS cpfk_supplier_lineitem_0#7500, cfpk_lineitem_supplier#7456 AS cfpk_lineitem_supplier_0#7501, cfpk_lineitem_partsupp#7457 AS cfpk_lineitem_partsupp_0#7502, cpfk_part_lineitem#7458 AS cpfk_part_lineitem_0#7503, cfpk_lineitem_part#7459 AS cfpk_lineitem_part_0#7504, cpfk_partsupp_lineitem#7460 AS cpfk_partsupp_lineitem_0#7505, cfpk_lineitem_orders#7461 AS cfpk_lineitem_orders_0#7506, cval_lineitem_l_quantity#7462 AS cval_lineitem_l_quantity_0#7507, cval_lineitem_l_extendedprice#7463 AS cval_lineitem_l_extendedprice_0#7508, cval_lineitem_l_discount#7464 AS cval_lineitem_l_discount_0#7509, cval_lineitem_l_tax#7465 AS cval_lineitem_l_tax_0#7510, cval_lineitem_l_returnflag#7466 AS cval_lineitem_l_returnflag_0#7511, cval_lineitem_l_linestatus#7467 AS cval_lineitem_l_linestatus_0#7512, cval_lineitem_l_commitdate#7468 AS cval_lineitem_l_commitdate_0#7513, cval_lineitem_l_receiptdate#7469 AS cval_lineitem_l_receiptdate_0#7514, cval_lineitem_l_shipinstruct#7470 AS cval_lineitem_l_shipinstruct_0#7515, cval_lineitem_l_shipmode#7471 AS cval_lineitem_l_shipmode_0#7516, cval_lineitem_l_comment#7472 AS cval_lineitem_l_comment_0#7517, cval_lineitem_l_shipdate#7473 AS cval_lineitem_l_shipdate_0#7518, cdepval_lineitem_l_quantity#7474 AS cdepval_lineitem_l_quantity_0#7519, cdepval_lineitem_l_extendedprice#7475 AS cdepval_lineitem_l_extendedprice_0#7520, cdepval_lineitem_l_discount#7476 AS cdepval_lineitem_l_discount_0#7521, ... 21 more fields]
         :     +- Relation[rid#7453,cpfk_orders_lineitem#7454,cpfk_supplier_lineitem#7455,cfpk_lineitem_supplier#7456,cfpk_lineitem_partsupp#7457,cpfk_part_lineitem#7458,cfpk_lineitem_part#7459,cpfk_partsupp_lineitem#7460,cfpk_lineitem_orders#7461,cval_lineitem_l_quantity#7462,cval_lineitem_l_extendedprice#7463,cval_lineitem_l_discount#7464,cval_lineitem_l_tax#7465,cval_lineitem_l_returnflag#7466,cval_lineitem_l_linestatus#7467,cval_lineitem_l_commitdate#7468,cval_lineitem_l_receiptdate#7469,cval_lineitem_l_shipinstruct#7470,cval_lineitem_l_shipmode#7471,cval_lineitem_l_comment#7472,cval_lineitem_l_shipdate#7473,cdepval_lineitem_l_quantity#7474,cdepval_lineitem_l_extendedprice#7475,cdepval_lineitem_l_discount#7476,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7633 AS rid_1#7657, cpfk_customer_orders#7634 AS cpfk_customer_orders_1#7658, cfpk_orders_customer#7635 AS cfpk_orders_customer_1#7659, cval_orders_o_orderstatus#7636 AS cval_orders_o_orderstatus_1#7660, cval_orders_o_totalprice#7637 AS cval_orders_o_totalprice_1#7661, cval_orders_o_orderpriority#7638 AS cval_orders_o_orderpriority_1#7662, cval_orders_o_clerk#7639 AS cval_orders_o_clerk_1#7663, cval_orders_o_shippriority#7640 AS cval_orders_o_shippriority_1#7664, cval_orders_o_comment#7641 AS cval_orders_o_comment_1#7665, cval_orders_o_orderdate#7642 AS cval_orders_o_orderdate_1#7666, cdepval_orders_o_orderstatus#7643 AS cdepval_orders_o_orderstatus_1#7667, cdepval_orders_o_totalprice#7644 AS cdepval_orders_o_totalprice_1#7668, cdepval_orders_o_orderpriority#7645 AS cdepval_orders_o_orderpriority_1#7669, cdepval_orders_o_clerk#7646 AS cdepval_orders_o_clerk_1#7670, cdepval_orders_o_shippriority#7647 AS cdepval_orders_o_shippriority_1#7671, cdepval_orders_o_comment#7648 AS cdepval_orders_o_comment_1#7672, cdepval_orders_o_orderdate#7649 AS cdepval_orders_o_orderdate_1#7673, co_orderstatus#7650 AS co_orderstatus_1#7674, co_totalprice#7651 AS co_totalprice_1#7675, co_orderpriority#7652 AS co_orderpriority_1#7676, co_clerk#7653 AS co_clerk_1#7677, co_shippriority#7654 AS co_shippriority_1#7678, co_comment#7655 AS co_comment_1#7679, co_orderdate#7656 AS co_orderdate_1#7680]
            +- Relation[rid#7633,cpfk_customer_orders#7634,cfpk_orders_customer#7635,cval_orders_o_orderstatus#7636,cval_orders_o_totalprice#7637,cval_orders_o_orderpriority#7638,cval_orders_o_clerk#7639,cval_orders_o_shippriority#7640,cval_orders_o_comment#7641,cval_orders_o_orderdate#7642,cdepval_orders_o_orderstatus#7643,cdepval_orders_o_totalprice#7644,cdepval_orders_o_orderpriority#7645,cdepval_orders_o_clerk#7646,cdepval_orders_o_shippriority#7647,cdepval_orders_o_comment#7648,cdepval_orders_o_orderdate#7649,co_orderstatus#7650,co_totalprice#7651,co_orderpriority#7652,co_clerk#7653,co_shippriority#7654,co_comment#7655,co_orderdate#7656] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 21581ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/26 21:48:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:48:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7757L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:48:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:48:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:48:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:48:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:48:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:48:21 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:48:21 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:48:21 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:48:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:48:21 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:48:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:48:21 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:48:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:48:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:48:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7757L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#7784, cval_part_p_name_0#7785, cval_part_p_mfgr_0#7786, cval_part_p_type_0#7787, cval_part_p_size_0#7788, cval_part_p_container_0#7789, cval_part_p_retailprice_0#7790, cval_part_p_comment_0#7791, cval_part_p_brand_0#7792, cdepval_part_p_name_0#7793, cdepval_part_p_mfgr_0#7794, cdepval_part_p_type_0#7795, cdepval_part_p_size_0#7796, cdepval_part_p_container_0#7797, cdepval_part_p_retailprice_0#7798, cdepval_part_p_comment_0#7799, cdepval_part_p_brand_0#7800, cp_name_0#7801, cp_mfgr_0#7802, cp_type_0#7803, cp_size_0#7804, cp_container_0#7805, cp_retailprice_0#7806, cp_comment_0#7807, ... 2 more fields]
         :  :  :  :  :- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :  :  :  +- Project [rid#7759 AS rid_0#7784, cval_part_p_name#7760 AS cval_part_p_name_0#7785, cval_part_p_mfgr#7761 AS cval_part_p_mfgr_0#7786, cval_part_p_type#7762 AS cval_part_p_type_0#7787, cval_part_p_size#7763 AS cval_part_p_size_0#7788, cval_part_p_container#7764 AS cval_part_p_container_0#7789, cval_part_p_retailprice#7765 AS cval_part_p_retailprice_0#7790, cval_part_p_comment#7766 AS cval_part_p_comment_0#7791, cval_part_p_brand#7767 AS cval_part_p_brand_0#7792, cdepval_part_p_name#7768 AS cdepval_part_p_name_0#7793, cdepval_part_p_mfgr#7769 AS cdepval_part_p_mfgr_0#7794, cdepval_part_p_type#7770 AS cdepval_part_p_type_0#7795, cdepval_part_p_size#7771 AS cdepval_part_p_size_0#7796, cdepval_part_p_container#7772 AS cdepval_part_p_container_0#7797, cdepval_part_p_retailprice#7773 AS cdepval_part_p_retailprice_0#7798, cdepval_part_p_comment#7774 AS cdepval_part_p_comment_0#7799, cdepval_part_p_brand#7775 AS cdepval_part_p_brand_0#7800, cp_name#7776 AS cp_name_0#7801, cp_mfgr#7777 AS cp_mfgr_0#7802, cp_type#7778 AS cp_type_0#7803, cp_size#7779 AS cp_size_0#7804, cp_container#7780 AS cp_container_0#7805, cp_retailprice#7781 AS cp_retailprice_0#7806, cp_comment#7782 AS cp_comment_0#7807, cp_brand#7783 AS cp_brand_0#7808]
         :  :  :  :  :     +- Relation[rid#7759,cval_part_p_name#7760,cval_part_p_mfgr#7761,cval_part_p_type#7762,cval_part_p_size#7763,cval_part_p_container#7764,cval_part_p_retailprice#7765,cval_part_p_comment#7766,cval_part_p_brand#7767,cdepval_part_p_name#7768,cdepval_part_p_mfgr#7769,cdepval_part_p_type#7770,cdepval_part_p_size#7771,cdepval_part_p_container#7772,cdepval_part_p_retailprice#7773,cdepval_part_p_comment#7774,cdepval_part_p_brand#7775,cp_name#7776,cp_mfgr#7777,cp_type#7778,cp_size#7779,cp_container#7780,cp_retailprice#7781,cp_comment#7782,cp_brand#7783] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :  :  :  :     +- Project [rid#7999 AS rid_1#8044, cpfk_orders_lineitem#8000 AS cpfk_orders_lineitem_1#8045, cpfk_supplier_lineitem#8001 AS cpfk_supplier_lineitem_1#8046, cfpk_lineitem_supplier#8002 AS cfpk_lineitem_supplier_1#8047, cfpk_lineitem_partsupp#8003 AS cfpk_lineitem_partsupp_1#8048, cpfk_part_lineitem#8004 AS cpfk_part_lineitem_1#8049, cfpk_lineitem_part#8005 AS cfpk_lineitem_part_1#8050, cpfk_partsupp_lineitem#8006 AS cpfk_partsupp_lineitem_1#8051, cfpk_lineitem_orders#8007 AS cfpk_lineitem_orders_1#8052, cval_lineitem_l_quantity#8008 AS cval_lineitem_l_quantity_1#8053, cval_lineitem_l_extendedprice#8009 AS cval_lineitem_l_extendedprice_1#8054, cval_lineitem_l_discount#8010 AS cval_lineitem_l_discount_1#8055, cval_lineitem_l_tax#8011 AS cval_lineitem_l_tax_1#8056, cval_lineitem_l_returnflag#8012 AS cval_lineitem_l_returnflag_1#8057, cval_lineitem_l_linestatus#8013 AS cval_lineitem_l_linestatus_1#8058, cval_lineitem_l_commitdate#8014 AS cval_lineitem_l_commitdate_1#8059, cval_lineitem_l_receiptdate#8015 AS cval_lineitem_l_receiptdate_1#8060, cval_lineitem_l_shipinstruct#8016 AS cval_lineitem_l_shipinstruct_1#8061, cval_lineitem_l_shipmode#8017 AS cval_lineitem_l_shipmode_1#8062, cval_lineitem_l_comment#8018 AS cval_lineitem_l_comment_1#8063, cval_lineitem_l_shipdate#8019 AS cval_lineitem_l_shipdate_1#8064, cdepval_lineitem_l_quantity#8020 AS cdepval_lineitem_l_quantity_1#8065, cdepval_lineitem_l_extendedprice#8021 AS cdepval_lineitem_l_extendedprice_1#8066, cdepval_lineitem_l_discount#8022 AS cdepval_lineitem_l_discount_1#8067, ... 21 more fields]
         :  :  :  :        +- Relation[rid#7999,cpfk_orders_lineitem#8000,cpfk_supplier_lineitem#8001,cfpk_lineitem_supplier#8002,cfpk_lineitem_partsupp#8003,cpfk_part_lineitem#8004,cfpk_lineitem_part#8005,cpfk_partsupp_lineitem#8006,cfpk_lineitem_orders#8007,cval_lineitem_l_quantity#8008,cval_lineitem_l_extendedprice#8009,cval_lineitem_l_discount#8010,cval_lineitem_l_tax#8011,cval_lineitem_l_returnflag#8012,cval_lineitem_l_linestatus#8013,cval_lineitem_l_commitdate#8014,cval_lineitem_l_receiptdate#8015,cval_lineitem_l_shipinstruct#8016,cval_lineitem_l_shipmode#8017,cval_lineitem_l_comment#8018,cval_lineitem_l_shipdate#8019,cdepval_lineitem_l_quantity#8020,cdepval_lineitem_l_extendedprice#8021,cdepval_lineitem_l_discount#8022,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- Project [rid#7859 AS rid_1#7904, cpfk_orders_lineitem#7860 AS cpfk_orders_lineitem_1#7905, cpfk_supplier_lineitem#7861 AS cpfk_supplier_lineitem_1#7906, cfpk_lineitem_supplier#7862 AS cfpk_lineitem_supplier_1#7907, cfpk_lineitem_partsupp#7863 AS cfpk_lineitem_partsupp_1#7908, cpfk_part_lineitem#7864 AS cpfk_part_lineitem_1#7909, cfpk_lineitem_part#7865 AS cfpk_lineitem_part_1#7910, cpfk_partsupp_lineitem#7866 AS cpfk_partsupp_lineitem_1#7911, cfpk_lineitem_orders#7867 AS cfpk_lineitem_orders_1#7912, cval_lineitem_l_quantity#7868 AS cval_lineitem_l_quantity_1#7913, cval_lineitem_l_extendedprice#7869 AS cval_lineitem_l_extendedprice_1#7914, cval_lineitem_l_discount#7870 AS cval_lineitem_l_discount_1#7915, cval_lineitem_l_tax#7871 AS cval_lineitem_l_tax_1#7916, cval_lineitem_l_returnflag#7872 AS cval_lineitem_l_returnflag_1#7917, cval_lineitem_l_linestatus#7873 AS cval_lineitem_l_linestatus_1#7918, cval_lineitem_l_commitdate#7874 AS cval_lineitem_l_commitdate_1#7919, cval_lineitem_l_receiptdate#7875 AS cval_lineitem_l_receiptdate_1#7920, cval_lineitem_l_shipinstruct#7876 AS cval_lineitem_l_shipinstruct_1#7921, cval_lineitem_l_shipmode#7877 AS cval_lineitem_l_shipmode_1#7922, cval_lineitem_l_comment#7878 AS cval_lineitem_l_comment_1#7923, cval_lineitem_l_shipdate#7879 AS cval_lineitem_l_shipdate_1#7924, cdepval_lineitem_l_quantity#7880 AS cdepval_lineitem_l_quantity_1#7925, cdepval_lineitem_l_extendedprice#7881 AS cdepval_lineitem_l_extendedprice_1#7926, cdepval_lineitem_l_discount#7882 AS cdepval_lineitem_l_discount_1#7927, ... 21 more fields]
         :  :  :     +- Relation[rid#7859,cpfk_orders_lineitem#7860,cpfk_supplier_lineitem#7861,cfpk_lineitem_supplier#7862,cfpk_lineitem_partsupp#7863,cpfk_part_lineitem#7864,cfpk_lineitem_part#7865,cpfk_partsupp_lineitem#7866,cfpk_lineitem_orders#7867,cval_lineitem_l_quantity#7868,cval_lineitem_l_extendedprice#7869,cval_lineitem_l_discount#7870,cval_lineitem_l_tax#7871,cval_lineitem_l_returnflag#7872,cval_lineitem_l_linestatus#7873,cval_lineitem_l_commitdate#7874,cval_lineitem_l_receiptdate#7875,cval_lineitem_l_shipinstruct#7876,cval_lineitem_l_shipmode#7877,cval_lineitem_l_comment#7878,cval_lineitem_l_shipdate#7879,cdepval_lineitem_l_quantity#7880,cdepval_lineitem_l_extendedprice#7881,cdepval_lineitem_l_discount#7882,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#8089 AS rid_2#8107, cpfk_nation_supplier#8090 AS cpfk_nation_supplier_2#8108, cfpk_supplier_nation#8091 AS cfpk_supplier_nation_2#8109, cval_supplier_s_name#8092 AS cval_supplier_s_name_2#8110, cval_supplier_s_address#8093 AS cval_supplier_s_address_2#8111, cval_supplier_s_phone#8094 AS cval_supplier_s_phone_2#8112, cval_supplier_s_acctbal#8095 AS cval_supplier_s_acctbal_2#8113, cval_supplier_s_comment#8096 AS cval_supplier_s_comment_2#8114, cdepval_supplier_s_name#8097 AS cdepval_supplier_s_name_2#8115, cdepval_supplier_s_address#8098 AS cdepval_supplier_s_address_2#8116, cdepval_supplier_s_phone#8099 AS cdepval_supplier_s_phone_2#8117, cdepval_supplier_s_acctbal#8100 AS cdepval_supplier_s_acctbal_2#8118, cdepval_supplier_s_comment#8101 AS cdepval_supplier_s_comment_2#8119, cs_name#8102 AS cs_name_2#8120, cs_address#8103 AS cs_address_2#8121, cs_phone#8104 AS cs_phone_2#8122, cs_acctbal#8105 AS cs_acctbal_2#8123, cs_comment#8106 AS cs_comment_2#8124]
         :  :     +- Relation[rid#8089,cpfk_nation_supplier#8090,cfpk_supplier_nation#8091,cval_supplier_s_name#8092,cval_supplier_s_address#8093,cval_supplier_s_phone#8094,cval_supplier_s_acctbal#8095,cval_supplier_s_comment#8096,cdepval_supplier_s_name#8097,cdepval_supplier_s_address#8098,cdepval_supplier_s_phone#8099,cdepval_supplier_s_acctbal#8100,cdepval_supplier_s_comment#8101,cs_name#8102,cs_address#8103,cs_phone#8104,cs_acctbal#8105,cs_comment#8106] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#8125 AS rid_3#8134, cpfk_region_nation#8126 AS cpfk_region_nation_3#8135, cfpk_nation_region#8127 AS cfpk_nation_region_3#8136, cval_nation_n_name#8128 AS cval_nation_n_name_3#8137, cval_nation_n_comment#8129 AS cval_nation_n_comment_3#8138, cdepval_nation_n_name#8130 AS cdepval_nation_n_name_3#8139, cdepval_nation_n_comment#8131 AS cdepval_nation_n_comment_3#8140, cn_name#8132 AS cn_name_3#8141, cn_comment#8133 AS cn_comment_3#8142]
         :     +- Relation[rid#8125,cpfk_region_nation#8126,cfpk_nation_region#8127,cval_nation_n_name#8128,cval_nation_n_comment#8129,cdepval_nation_n_name#8130,cdepval_nation_n_comment#8131,cn_name#8132,cn_comment#8133] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#8263 AS rid_7#8287, cpfk_customer_orders#8264 AS cpfk_customer_orders_7#8288, cfpk_orders_customer#8265 AS cfpk_orders_customer_7#8289, cval_orders_o_orderstatus#8266 AS cval_orders_o_orderstatus_7#8290, cval_orders_o_totalprice#8267 AS cval_orders_o_totalprice_7#8291, cval_orders_o_orderpriority#8268 AS cval_orders_o_orderpriority_7#8292, cval_orders_o_clerk#8269 AS cval_orders_o_clerk_7#8293, cval_orders_o_shippriority#8270 AS cval_orders_o_shippriority_7#8294, cval_orders_o_comment#8271 AS cval_orders_o_comment_7#8295, cval_orders_o_orderdate#8272 AS cval_orders_o_orderdate_7#8296, cdepval_orders_o_orderstatus#8273 AS cdepval_orders_o_orderstatus_7#8297, cdepval_orders_o_totalprice#8274 AS cdepval_orders_o_totalprice_7#8298, cdepval_orders_o_orderpriority#8275 AS cdepval_orders_o_orderpriority_7#8299, cdepval_orders_o_clerk#8276 AS cdepval_orders_o_clerk_7#8300, cdepval_orders_o_shippriority#8277 AS cdepval_orders_o_shippriority_7#8301, cdepval_orders_o_comment#8278 AS cdepval_orders_o_comment_7#8302, cdepval_orders_o_orderdate#8279 AS cdepval_orders_o_orderdate_7#8303, co_orderstatus#8280 AS co_orderstatus_7#8304, co_totalprice#8281 AS co_totalprice_7#8305, co_orderpriority#8282 AS co_orderpriority_7#8306, co_clerk#8283 AS co_clerk_7#8307, co_shippriority#8284 AS co_shippriority_7#8308, co_comment#8285 AS co_comment_7#8309, co_orderdate#8286 AS co_orderdate_7#8310]
            :  +- Relation[rid#8263,cpfk_customer_orders#8264,cfpk_orders_customer#8265,cval_orders_o_orderstatus#8266,cval_orders_o_totalprice#8267,cval_orders_o_orderpriority#8268,cval_orders_o_clerk#8269,cval_orders_o_shippriority#8270,cval_orders_o_comment#8271,cval_orders_o_orderdate#8272,cdepval_orders_o_orderstatus#8273,cdepval_orders_o_totalprice#8274,cdepval_orders_o_orderpriority#8275,cdepval_orders_o_clerk#8276,cdepval_orders_o_shippriority#8277,cdepval_orders_o_comment#8278,cdepval_orders_o_orderdate#8279,co_orderstatus#8280,co_totalprice#8281,co_orderpriority#8282,co_clerk#8283,co_shippriority#8284,co_comment#8285,co_orderdate#8286] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#8221 AS rid_6#8242, cpfk_nation_customer#8222 AS cpfk_nation_customer_6#8243, cfpk_customer_nation#8223 AS cfpk_customer_nation_6#8244, cval_customer_c_name#8224 AS cval_customer_c_name_6#8245, cval_customer_c_address#8225 AS cval_customer_c_address_6#8246, cval_customer_c_phone#8226 AS cval_customer_c_phone_6#8247, cval_customer_c_acctbal#8227 AS cval_customer_c_acctbal_6#8248, cval_customer_c_comment#8228 AS cval_customer_c_comment_6#8249, cval_customer_c_mktsegment#8229 AS cval_customer_c_mktsegment_6#8250, cdepval_customer_c_name#8230 AS cdepval_customer_c_name_6#8251, cdepval_customer_c_address#8231 AS cdepval_customer_c_address_6#8252, cdepval_customer_c_phone#8232 AS cdepval_customer_c_phone_6#8253, cdepval_customer_c_acctbal#8233 AS cdepval_customer_c_acctbal_6#8254, cdepval_customer_c_comment#8234 AS cdepval_customer_c_comment_6#8255, cdepval_customer_c_mktsegment#8235 AS cdepval_customer_c_mktsegment_6#8256, cc_name#8236 AS cc_name_6#8257, cc_address#8237 AS cc_address_6#8258, cc_phone#8238 AS cc_phone_6#8259, cc_acctbal#8239 AS cc_acctbal_6#8260, cc_comment#8240 AS cc_comment_6#8261, cc_mktsegment#8241 AS cc_mktsegment_6#8262]
               :  +- Relation[rid#8221,cpfk_nation_customer#8222,cfpk_customer_nation#8223,cval_customer_c_name#8224,cval_customer_c_address#8225,cval_customer_c_phone#8226,cval_customer_c_acctbal#8227,cval_customer_c_comment#8228,cval_customer_c_mktsegment#8229,cdepval_customer_c_name#8230,cdepval_customer_c_address#8231,cdepval_customer_c_phone#8232,cdepval_customer_c_acctbal#8233,cdepval_customer_c_comment#8234,cdepval_customer_c_mktsegment#8235,cc_name#8236,cc_address#8237,cc_phone#8238,cc_acctbal#8239,cc_comment#8240,cc_mktsegment#8241] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join UsingJoin(Inner,List(rid_5))
                  :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_5, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#8150, cval_region_r_name_4#8151, cval_region_r_comment_4#8152, cdepval_region_r_name_4#8153, cdepval_region_r_comment_4#8154, cr_name_4#8155, cr_comment_4#8156, 'rid_5]
                  :  :- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                  :  :  +- Project [rid#8143 AS rid_4#8150, cval_region_r_name#8144 AS cval_region_r_name_4#8151, cval_region_r_comment#8145 AS cval_region_r_comment_4#8152, cdepval_region_r_name#8146 AS cdepval_region_r_name_4#8153, cdepval_region_r_comment#8147 AS cdepval_region_r_comment_4#8154, cr_name#8148 AS cr_name_4#8155, cr_comment#8149 AS cr_comment_4#8156]
                  :  :     +- Relation[rid#8143,cval_region_r_name#8144,cval_region_r_comment#8145,cdepval_region_r_name#8146,cdepval_region_r_comment#8147,cr_name#8148,cr_comment#8149] JDBCRelation(tregion) [numPartitions=1]
                  :  +- 'Project ['cpfk_region_nation_5, 'rid_5]
                  :     +- Project [rid#8203 AS rid_5#8212, cpfk_region_nation#8204 AS cpfk_region_nation_5#8213, cfpk_nation_region#8205 AS cfpk_nation_region_5#8214, cval_nation_n_name#8206 AS cval_nation_n_name_5#8215, cval_nation_n_comment#8207 AS cval_nation_n_comment_5#8216, cdepval_nation_n_name#8208 AS cdepval_nation_n_name_5#8217, cdepval_nation_n_comment#8209 AS cdepval_nation_n_comment_5#8218, cn_name#8210 AS cn_name_5#8219, cn_comment#8211 AS cn_comment_5#8220]
                  :        +- Relation[rid#8203,cpfk_region_nation#8204,cfpk_nation_region#8205,cval_nation_n_name#8206,cval_nation_n_comment#8207,cdepval_nation_n_name#8208,cdepval_nation_n_comment#8209,cn_name#8210,cn_comment#8211] JDBCRelation(tnation) [numPartitions=1]
                  +- Project [rid#8171 AS rid_5#8180, cpfk_region_nation#8172 AS cpfk_region_nation_5#8181, cfpk_nation_region#8173 AS cfpk_nation_region_5#8182, cval_nation_n_name#8174 AS cval_nation_n_name_5#8183, cval_nation_n_comment#8175 AS cval_nation_n_comment_5#8184, cdepval_nation_n_name#8176 AS cdepval_nation_n_name_5#8185, cdepval_nation_n_comment#8177 AS cdepval_nation_n_comment_5#8186, cn_name#8178 AS cn_name_5#8187, cn_comment#8179 AS cn_comment_5#8188]
                     +- Relation[rid#8171,cpfk_region_nation#8172,cfpk_nation_region#8173,cval_nation_n_name#8174,cval_nation_n_comment#8175,cdepval_nation_n_name#8176,cdepval_nation_n_comment#8177,cn_name#8178,cn_comment#8179] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 3377ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/26 21:48:24 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:48:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8477L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:48:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:48:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:48:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:48:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:48:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:48:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:48:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:48:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:48:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:48:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:48:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:48:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:48:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:48:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:48:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8477L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#8605 AS rid_2#8650, cpfk_orders_lineitem#8606 AS cpfk_orders_lineitem_2#8651, cpfk_supplier_lineitem#8607 AS cpfk_supplier_lineitem_2#8652, cfpk_lineitem_supplier#8608 AS cfpk_lineitem_supplier_2#8653, cfpk_lineitem_partsupp#8609 AS cfpk_lineitem_partsupp_2#8654, cpfk_part_lineitem#8610 AS cpfk_part_lineitem_2#8655, cfpk_lineitem_part#8611 AS cfpk_lineitem_part_2#8656, cpfk_partsupp_lineitem#8612 AS cpfk_partsupp_lineitem_2#8657, cfpk_lineitem_orders#8613 AS cfpk_lineitem_orders_2#8658, cval_lineitem_l_quantity#8614 AS cval_lineitem_l_quantity_2#8659, cval_lineitem_l_extendedprice#8615 AS cval_lineitem_l_extendedprice_2#8660, cval_lineitem_l_discount#8616 AS cval_lineitem_l_discount_2#8661, cval_lineitem_l_tax#8617 AS cval_lineitem_l_tax_2#8662, cval_lineitem_l_returnflag#8618 AS cval_lineitem_l_returnflag_2#8663, cval_lineitem_l_linestatus#8619 AS cval_lineitem_l_linestatus_2#8664, cval_lineitem_l_commitdate#8620 AS cval_lineitem_l_commitdate_2#8665, cval_lineitem_l_receiptdate#8621 AS cval_lineitem_l_receiptdate_2#8666, cval_lineitem_l_shipinstruct#8622 AS cval_lineitem_l_shipinstruct_2#8667, cval_lineitem_l_shipmode#8623 AS cval_lineitem_l_shipmode_2#8668, cval_lineitem_l_comment#8624 AS cval_lineitem_l_comment_2#8669, cval_lineitem_l_shipdate#8625 AS cval_lineitem_l_shipdate_2#8670, cdepval_lineitem_l_quantity#8626 AS cdepval_lineitem_l_quantity_2#8671, cdepval_lineitem_l_extendedprice#8627 AS cdepval_lineitem_l_extendedprice_2#8672, cdepval_lineitem_l_discount#8628 AS cdepval_lineitem_l_discount_2#8673, ... 21 more fields]
         :  :  +- Relation[rid#8605,cpfk_orders_lineitem#8606,cpfk_supplier_lineitem#8607,cfpk_lineitem_supplier#8608,cfpk_lineitem_partsupp#8609,cpfk_part_lineitem#8610,cfpk_lineitem_part#8611,cpfk_partsupp_lineitem#8612,cfpk_lineitem_orders#8613,cval_lineitem_l_quantity#8614,cval_lineitem_l_extendedprice#8615,cval_lineitem_l_discount#8616,cval_lineitem_l_tax#8617,cval_lineitem_l_returnflag#8618,cval_lineitem_l_linestatus#8619,cval_lineitem_l_commitdate#8620,cval_lineitem_l_receiptdate#8621,cval_lineitem_l_shipinstruct#8622,cval_lineitem_l_shipmode#8623,cval_lineitem_l_comment#8624,cval_lineitem_l_shipdate#8625,cdepval_lineitem_l_quantity#8626,cdepval_lineitem_l_extendedprice#8627,cdepval_lineitem_l_discount#8628,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join UsingJoin(Inner,List(rid_1))
         :     :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#8488, cpfk_region_nation_0#8489, cfpk_nation_region_0#8490, cval_nation_n_name_0#8491, cval_nation_n_comment_0#8492, cdepval_nation_n_name_0#8493, cdepval_nation_n_comment_0#8494, cn_name_0#8495, cn_comment_0#8496, 'rid_1]
         :     :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :     :  :  +- Project [rid#8479 AS rid_0#8488, cpfk_region_nation#8480 AS cpfk_region_nation_0#8489, cfpk_nation_region#8481 AS cfpk_nation_region_0#8490, cval_nation_n_name#8482 AS cval_nation_n_name_0#8491, cval_nation_n_comment#8483 AS cval_nation_n_comment_0#8492, cdepval_nation_n_name#8484 AS cdepval_nation_n_name_0#8493, cdepval_nation_n_comment#8485 AS cdepval_nation_n_comment_0#8494, cn_name#8486 AS cn_name_0#8495, cn_comment#8487 AS cn_comment_0#8496]
         :     :  :     +- Relation[rid#8479,cpfk_region_nation#8480,cfpk_nation_region#8481,cval_nation_n_name#8482,cval_nation_n_comment#8483,cdepval_nation_n_name#8484,cdepval_nation_n_comment#8485,cn_name#8486,cn_comment#8487] JDBCRelation(tnation) [numPartitions=1]
         :     :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
         :     :     +- Project [rid#8569 AS rid_1#8587, cpfk_nation_supplier#8570 AS cpfk_nation_supplier_1#8588, cfpk_supplier_nation#8571 AS cfpk_supplier_nation_1#8589, cval_supplier_s_name#8572 AS cval_supplier_s_name_1#8590, cval_supplier_s_address#8573 AS cval_supplier_s_address_1#8591, cval_supplier_s_phone#8574 AS cval_supplier_s_phone_1#8592, cval_supplier_s_acctbal#8575 AS cval_supplier_s_acctbal_1#8593, cval_supplier_s_comment#8576 AS cval_supplier_s_comment_1#8594, cdepval_supplier_s_name#8577 AS cdepval_supplier_s_name_1#8595, cdepval_supplier_s_address#8578 AS cdepval_supplier_s_address_1#8596, cdepval_supplier_s_phone#8579 AS cdepval_supplier_s_phone_1#8597, cdepval_supplier_s_acctbal#8580 AS cdepval_supplier_s_acctbal_1#8598, cdepval_supplier_s_comment#8581 AS cdepval_supplier_s_comment_1#8599, cs_name#8582 AS cs_name_1#8600, cs_address#8583 AS cs_address_1#8601, cs_phone#8584 AS cs_phone_1#8602, cs_acctbal#8585 AS cs_acctbal_1#8603, cs_comment#8586 AS cs_comment_1#8604]
         :     :        +- Relation[rid#8569,cpfk_nation_supplier#8570,cfpk_supplier_nation#8571,cval_supplier_s_name#8572,cval_supplier_s_address#8573,cval_supplier_s_phone#8574,cval_supplier_s_acctbal#8575,cval_supplier_s_comment#8576,cdepval_supplier_s_name#8577,cdepval_supplier_s_address#8578,cdepval_supplier_s_phone#8579,cdepval_supplier_s_acctbal#8580,cdepval_supplier_s_comment#8581,cs_name#8582,cs_address#8583,cs_phone#8584,cs_acctbal#8585,cs_comment#8586] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#8515 AS rid_1#8533, cpfk_nation_supplier#8516 AS cpfk_nation_supplier_1#8534, cfpk_supplier_nation#8517 AS cfpk_supplier_nation_1#8535, cval_supplier_s_name#8518 AS cval_supplier_s_name_1#8536, cval_supplier_s_address#8519 AS cval_supplier_s_address_1#8537, cval_supplier_s_phone#8520 AS cval_supplier_s_phone_1#8538, cval_supplier_s_acctbal#8521 AS cval_supplier_s_acctbal_1#8539, cval_supplier_s_comment#8522 AS cval_supplier_s_comment_1#8540, cdepval_supplier_s_name#8523 AS cdepval_supplier_s_name_1#8541, cdepval_supplier_s_address#8524 AS cdepval_supplier_s_address_1#8542, cdepval_supplier_s_phone#8525 AS cdepval_supplier_s_phone_1#8543, cdepval_supplier_s_acctbal#8526 AS cdepval_supplier_s_acctbal_1#8544, cdepval_supplier_s_comment#8527 AS cdepval_supplier_s_comment_1#8545, cs_name#8528 AS cs_name_1#8546, cs_address#8529 AS cs_address_1#8547, cs_phone#8530 AS cs_phone_1#8548, cs_acctbal#8531 AS cs_acctbal_1#8549, cs_comment#8532 AS cs_comment_1#8550]
         :        +- Relation[rid#8515,cpfk_nation_supplier#8516,cfpk_supplier_nation#8517,cval_supplier_s_name#8518,cval_supplier_s_address#8519,cval_supplier_s_phone#8520,cval_supplier_s_acctbal#8521,cval_supplier_s_comment#8522,cdepval_supplier_s_name#8523,cdepval_supplier_s_address#8524,cdepval_supplier_s_phone#8525,cdepval_supplier_s_acctbal#8526,cdepval_supplier_s_comment#8527,cs_name#8528,cs_address#8529,cs_phone#8530,cs_acctbal#8531,cs_comment#8532] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#8833 AS rid_5#8857, cpfk_customer_orders#8834 AS cpfk_customer_orders_5#8858, cfpk_orders_customer#8835 AS cfpk_orders_customer_5#8859, cval_orders_o_orderstatus#8836 AS cval_orders_o_orderstatus_5#8860, cval_orders_o_totalprice#8837 AS cval_orders_o_totalprice_5#8861, cval_orders_o_orderpriority#8838 AS cval_orders_o_orderpriority_5#8862, cval_orders_o_clerk#8839 AS cval_orders_o_clerk_5#8863, cval_orders_o_shippriority#8840 AS cval_orders_o_shippriority_5#8864, cval_orders_o_comment#8841 AS cval_orders_o_comment_5#8865, cval_orders_o_orderdate#8842 AS cval_orders_o_orderdate_5#8866, cdepval_orders_o_orderstatus#8843 AS cdepval_orders_o_orderstatus_5#8867, cdepval_orders_o_totalprice#8844 AS cdepval_orders_o_totalprice_5#8868, cdepval_orders_o_orderpriority#8845 AS cdepval_orders_o_orderpriority_5#8869, cdepval_orders_o_clerk#8846 AS cdepval_orders_o_clerk_5#8870, cdepval_orders_o_shippriority#8847 AS cdepval_orders_o_shippriority_5#8871, cdepval_orders_o_comment#8848 AS cdepval_orders_o_comment_5#8872, cdepval_orders_o_orderdate#8849 AS cdepval_orders_o_orderdate_5#8873, co_orderstatus#8850 AS co_orderstatus_5#8874, co_totalprice#8851 AS co_totalprice_5#8875, co_orderpriority#8852 AS co_orderpriority_5#8876, co_clerk#8853 AS co_clerk_5#8877, co_shippriority#8854 AS co_shippriority_5#8878, co_comment#8855 AS co_comment_5#8879, co_orderdate#8856 AS co_orderdate_5#8880]
            :  +- Relation[rid#8833,cpfk_customer_orders#8834,cfpk_orders_customer#8835,cval_orders_o_orderstatus#8836,cval_orders_o_totalprice#8837,cval_orders_o_orderpriority#8838,cval_orders_o_clerk#8839,cval_orders_o_shippriority#8840,cval_orders_o_comment#8841,cval_orders_o_orderdate#8842,cdepval_orders_o_orderstatus#8843,cdepval_orders_o_totalprice#8844,cdepval_orders_o_orderpriority#8845,cdepval_orders_o_clerk#8846,cdepval_orders_o_shippriority#8847,cdepval_orders_o_comment#8848,cdepval_orders_o_orderdate#8849,co_orderstatus#8850,co_totalprice#8851,co_orderpriority#8852,co_clerk#8853,co_shippriority#8854,co_comment#8855,co_orderdate#8856] JDBCRelation(torders) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_4))
               :- 'DexPkfkMaterializationAwareJoin nation~customer, 'cpfk_nation_customer_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#8704, cpfk_region_nation_3#8705, cfpk_nation_region_3#8706, cval_nation_n_name_3#8707, cval_nation_n_comment_3#8708, cdepval_nation_n_name_3#8709, cdepval_nation_n_comment_3#8710, cn_name_3#8711, cn_comment_3#8712, 'rid_4]
               :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
               :  :  +- Project [rid#8695 AS rid_3#8704, cpfk_region_nation#8696 AS cpfk_region_nation_3#8705, cfpk_nation_region#8697 AS cfpk_nation_region_3#8706, cval_nation_n_name#8698 AS cval_nation_n_name_3#8707, cval_nation_n_comment#8699 AS cval_nation_n_comment_3#8708, cdepval_nation_n_name#8700 AS cdepval_nation_n_name_3#8709, cdepval_nation_n_comment#8701 AS cdepval_nation_n_comment_3#8710, cn_name#8702 AS cn_name_3#8711, cn_comment#8703 AS cn_comment_3#8712]
               :  :     +- Relation[rid#8695,cpfk_region_nation#8696,cfpk_nation_region#8697,cval_nation_n_name#8698,cval_nation_n_comment#8699,cdepval_nation_n_name#8700,cdepval_nation_n_comment#8701,cn_name#8702,cn_comment#8703] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'Project ['cpfk_nation_customer_4, 'rid_4]
               :     +- Project [rid#8791 AS rid_4#8812, cpfk_nation_customer#8792 AS cpfk_nation_customer_4#8813, cfpk_customer_nation#8793 AS cfpk_customer_nation_4#8814, cval_customer_c_name#8794 AS cval_customer_c_name_4#8815, cval_customer_c_address#8795 AS cval_customer_c_address_4#8816, cval_customer_c_phone#8796 AS cval_customer_c_phone_4#8817, cval_customer_c_acctbal#8797 AS cval_customer_c_acctbal_4#8818, cval_customer_c_comment#8798 AS cval_customer_c_comment_4#8819, cval_customer_c_mktsegment#8799 AS cval_customer_c_mktsegment_4#8820, cdepval_customer_c_name#8800 AS cdepval_customer_c_name_4#8821, cdepval_customer_c_address#8801 AS cdepval_customer_c_address_4#8822, cdepval_customer_c_phone#8802 AS cdepval_customer_c_phone_4#8823, cdepval_customer_c_acctbal#8803 AS cdepval_customer_c_acctbal_4#8824, cdepval_customer_c_comment#8804 AS cdepval_customer_c_comment_4#8825, cdepval_customer_c_mktsegment#8805 AS cdepval_customer_c_mktsegment_4#8826, cc_name#8806 AS cc_name_4#8827, cc_address#8807 AS cc_address_4#8828, cc_phone#8808 AS cc_phone_4#8829, cc_acctbal#8809 AS cc_acctbal_4#8830, cc_comment#8810 AS cc_comment_4#8831, cc_mktsegment#8811 AS cc_mktsegment_4#8832]
               :        +- Relation[rid#8791,cpfk_nation_customer#8792,cfpk_customer_nation#8793,cval_customer_c_name#8794,cval_customer_c_address#8795,cval_customer_c_phone#8796,cval_customer_c_acctbal#8797,cval_customer_c_comment#8798,cval_customer_c_mktsegment#8799,cdepval_customer_c_name#8800,cdepval_customer_c_address#8801,cdepval_customer_c_phone#8802,cdepval_customer_c_acctbal#8803,cdepval_customer_c_comment#8804,cdepval_customer_c_mktsegment#8805,cc_name#8806,cc_address#8807,cc_phone#8808,cc_acctbal#8809,cc_comment#8810,cc_mktsegment#8811] JDBCRelation(tcustomer) [numPartitions=1]
               +- Project [rid#8731 AS rid_4#8752, cpfk_nation_customer#8732 AS cpfk_nation_customer_4#8753, cfpk_customer_nation#8733 AS cfpk_customer_nation_4#8754, cval_customer_c_name#8734 AS cval_customer_c_name_4#8755, cval_customer_c_address#8735 AS cval_customer_c_address_4#8756, cval_customer_c_phone#8736 AS cval_customer_c_phone_4#8757, cval_customer_c_acctbal#8737 AS cval_customer_c_acctbal_4#8758, cval_customer_c_comment#8738 AS cval_customer_c_comment_4#8759, cval_customer_c_mktsegment#8739 AS cval_customer_c_mktsegment_4#8760, cdepval_customer_c_name#8740 AS cdepval_customer_c_name_4#8761, cdepval_customer_c_address#8741 AS cdepval_customer_c_address_4#8762, cdepval_customer_c_phone#8742 AS cdepval_customer_c_phone_4#8763, cdepval_customer_c_acctbal#8743 AS cdepval_customer_c_acctbal_4#8764, cdepval_customer_c_comment#8744 AS cdepval_customer_c_comment_4#8765, cdepval_customer_c_mktsegment#8745 AS cdepval_customer_c_mktsegment_4#8766, cc_name#8746 AS cc_name_4#8767, cc_address#8747 AS cc_address_4#8768, cc_phone#8748 AS cc_phone_4#8769, cc_acctbal#8749 AS cc_acctbal_4#8770, cc_comment#8750 AS cc_comment_4#8771, cc_mktsegment#8751 AS cc_mktsegment_4#8772]
                  +- Relation[rid#8731,cpfk_nation_customer#8732,cfpk_customer_nation#8733,cval_customer_c_name#8734,cval_customer_c_address#8735,cval_customer_c_phone#8736,cval_customer_c_acctbal#8737,cval_customer_c_comment#8738,cval_customer_c_mktsegment#8739,cdepval_customer_c_name#8740,cdepval_customer_c_address#8741,cdepval_customer_c_phone#8742,cdepval_customer_c_acctbal#8743,cdepval_customer_c_comment#8744,cdepval_customer_c_mktsegment#8745,cc_name#8746,cc_address#8747,cc_phone#8748,cc_acctbal#8749,cc_comment#8750,cc_mktsegment#8751] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 40531ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/26 21:49:05 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:49:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9012L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:49:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#9012L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#9014 AS rid_0#9059, cpfk_orders_lineitem#9015 AS cpfk_orders_lineitem_0#9060, cpfk_supplier_lineitem#9016 AS cpfk_supplier_lineitem_0#9061, cfpk_lineitem_supplier#9017 AS cfpk_lineitem_supplier_0#9062, cfpk_lineitem_partsupp#9018 AS cfpk_lineitem_partsupp_0#9063, cpfk_part_lineitem#9019 AS cpfk_part_lineitem_0#9064, cfpk_lineitem_part#9020 AS cfpk_lineitem_part_0#9065, cpfk_partsupp_lineitem#9021 AS cpfk_partsupp_lineitem_0#9066, cfpk_lineitem_orders#9022 AS cfpk_lineitem_orders_0#9067, cval_lineitem_l_quantity#9023 AS cval_lineitem_l_quantity_0#9068, cval_lineitem_l_extendedprice#9024 AS cval_lineitem_l_extendedprice_0#9069, cval_lineitem_l_discount#9025 AS cval_lineitem_l_discount_0#9070, cval_lineitem_l_tax#9026 AS cval_lineitem_l_tax_0#9071, cval_lineitem_l_returnflag#9027 AS cval_lineitem_l_returnflag_0#9072, cval_lineitem_l_linestatus#9028 AS cval_lineitem_l_linestatus_0#9073, cval_lineitem_l_commitdate#9029 AS cval_lineitem_l_commitdate_0#9074, cval_lineitem_l_receiptdate#9030 AS cval_lineitem_l_receiptdate_0#9075, cval_lineitem_l_shipinstruct#9031 AS cval_lineitem_l_shipinstruct_0#9076, cval_lineitem_l_shipmode#9032 AS cval_lineitem_l_shipmode_0#9077, cval_lineitem_l_comment#9033 AS cval_lineitem_l_comment_0#9078, cval_lineitem_l_shipdate#9034 AS cval_lineitem_l_shipdate_0#9079, cdepval_lineitem_l_quantity#9035 AS cdepval_lineitem_l_quantity_0#9080, cdepval_lineitem_l_extendedprice#9036 AS cdepval_lineitem_l_extendedprice_0#9081, cdepval_lineitem_l_discount#9037 AS cdepval_lineitem_l_discount_0#9082, ... 21 more fields]
         +- Relation[rid#9014,cpfk_orders_lineitem#9015,cpfk_supplier_lineitem#9016,cfpk_lineitem_supplier#9017,cfpk_lineitem_partsupp#9018,cpfk_part_lineitem#9019,cfpk_lineitem_part#9020,cpfk_partsupp_lineitem#9021,cfpk_lineitem_orders#9022,cval_lineitem_l_quantity#9023,cval_lineitem_l_extendedprice#9024,cval_lineitem_l_discount#9025,cval_lineitem_l_tax#9026,cval_lineitem_l_returnflag#9027,cval_lineitem_l_linestatus#9028,cval_lineitem_l_commitdate#9029,cval_lineitem_l_receiptdate#9030,cval_lineitem_l_shipinstruct#9031,cval_lineitem_l_shipmode#9032,cval_lineitem_l_comment#9033,cval_lineitem_l_shipdate#9034,cdepval_lineitem_l_quantity#9035,cdepval_lineitem_l_extendedprice#9036,cdepval_lineitem_l_discount#9037,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2439ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/26 21:49:07 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:49:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9153L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:49:07 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:49:07 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:49:07 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:49:07 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:49:07 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:49:07 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:49:07 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:49:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9153L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#9180, cval_part_p_name_0#9181, cval_part_p_mfgr_0#9182, cval_part_p_type_0#9183, cval_part_p_size_0#9184, cval_part_p_container_0#9185, cval_part_p_retailprice_0#9186, cval_part_p_comment_0#9187, cval_part_p_brand_0#9188, cdepval_part_p_name_0#9189, cdepval_part_p_mfgr_0#9190, cdepval_part_p_type_0#9191, cdepval_part_p_size_0#9192, cdepval_part_p_container_0#9193, cdepval_part_p_retailprice_0#9194, cdepval_part_p_comment_0#9195, cdepval_part_p_brand_0#9196, cp_name_0#9197, cp_mfgr_0#9198, cp_type_0#9199, cp_size_0#9200, cp_container_0#9201, cp_retailprice_0#9202, cp_comment_0#9203, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#9155 AS rid_0#9180, cval_part_p_name#9156 AS cval_part_p_name_0#9181, cval_part_p_mfgr#9157 AS cval_part_p_mfgr_0#9182, cval_part_p_type#9158 AS cval_part_p_type_0#9183, cval_part_p_size#9159 AS cval_part_p_size_0#9184, cval_part_p_container#9160 AS cval_part_p_container_0#9185, cval_part_p_retailprice#9161 AS cval_part_p_retailprice_0#9186, cval_part_p_comment#9162 AS cval_part_p_comment_0#9187, cval_part_p_brand#9163 AS cval_part_p_brand_0#9188, cdepval_part_p_name#9164 AS cdepval_part_p_name_0#9189, cdepval_part_p_mfgr#9165 AS cdepval_part_p_mfgr_0#9190, cdepval_part_p_type#9166 AS cdepval_part_p_type_0#9191, cdepval_part_p_size#9167 AS cdepval_part_p_size_0#9192, cdepval_part_p_container#9168 AS cdepval_part_p_container_0#9193, cdepval_part_p_retailprice#9169 AS cdepval_part_p_retailprice_0#9194, cdepval_part_p_comment#9170 AS cdepval_part_p_comment_0#9195, cdepval_part_p_brand#9171 AS cdepval_part_p_brand_0#9196, cp_name#9172 AS cp_name_0#9197, cp_mfgr#9173 AS cp_mfgr_0#9198, cp_type#9174 AS cp_type_0#9199, cp_size#9175 AS cp_size_0#9200, cp_container#9176 AS cp_container_0#9201, cp_retailprice#9177 AS cp_retailprice_0#9202, cp_comment#9178 AS cp_comment_0#9203, cp_brand#9179 AS cp_brand_0#9204]
         :  :        +- Relation[rid#9155,cval_part_p_name#9156,cval_part_p_mfgr#9157,cval_part_p_type#9158,cval_part_p_size#9159,cval_part_p_container#9160,cval_part_p_retailprice#9161,cval_part_p_comment#9162,cval_part_p_brand#9163,cdepval_part_p_name#9164,cdepval_part_p_mfgr#9165,cdepval_part_p_type#9166,cdepval_part_p_size#9167,cdepval_part_p_container#9168,cdepval_part_p_retailprice#9169,cdepval_part_p_comment#9170,cdepval_part_p_brand#9171,cp_name#9172,cp_mfgr#9173,cp_type#9174,cp_size#9175,cp_container#9176,cp_retailprice#9177,cp_comment#9178,cp_brand#9179] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#9445 AS rid_1#9490, cpfk_orders_lineitem#9446 AS cpfk_orders_lineitem_1#9491, cpfk_supplier_lineitem#9447 AS cpfk_supplier_lineitem_1#9492, cfpk_lineitem_supplier#9448 AS cfpk_lineitem_supplier_1#9493, cfpk_lineitem_partsupp#9449 AS cfpk_lineitem_partsupp_1#9494, cpfk_part_lineitem#9450 AS cpfk_part_lineitem_1#9495, cfpk_lineitem_part#9451 AS cfpk_lineitem_part_1#9496, cpfk_partsupp_lineitem#9452 AS cpfk_partsupp_lineitem_1#9497, cfpk_lineitem_orders#9453 AS cfpk_lineitem_orders_1#9498, cval_lineitem_l_quantity#9454 AS cval_lineitem_l_quantity_1#9499, cval_lineitem_l_extendedprice#9455 AS cval_lineitem_l_extendedprice_1#9500, cval_lineitem_l_discount#9456 AS cval_lineitem_l_discount_1#9501, cval_lineitem_l_tax#9457 AS cval_lineitem_l_tax_1#9502, cval_lineitem_l_returnflag#9458 AS cval_lineitem_l_returnflag_1#9503, cval_lineitem_l_linestatus#9459 AS cval_lineitem_l_linestatus_1#9504, cval_lineitem_l_commitdate#9460 AS cval_lineitem_l_commitdate_1#9505, cval_lineitem_l_receiptdate#9461 AS cval_lineitem_l_receiptdate_1#9506, cval_lineitem_l_shipinstruct#9462 AS cval_lineitem_l_shipinstruct_1#9507, cval_lineitem_l_shipmode#9463 AS cval_lineitem_l_shipmode_1#9508, cval_lineitem_l_comment#9464 AS cval_lineitem_l_comment_1#9509, cval_lineitem_l_shipdate#9465 AS cval_lineitem_l_shipdate_1#9510, cdepval_lineitem_l_quantity#9466 AS cdepval_lineitem_l_quantity_1#9511, cdepval_lineitem_l_extendedprice#9467 AS cdepval_lineitem_l_extendedprice_1#9512, cdepval_lineitem_l_discount#9468 AS cdepval_lineitem_l_discount_1#9513, ... 21 more fields]
         :        +- Relation[rid#9445,cpfk_orders_lineitem#9446,cpfk_supplier_lineitem#9447,cfpk_lineitem_supplier#9448,cfpk_lineitem_partsupp#9449,cpfk_part_lineitem#9450,cfpk_lineitem_part#9451,cpfk_partsupp_lineitem#9452,cfpk_lineitem_orders#9453,cval_lineitem_l_quantity#9454,cval_lineitem_l_extendedprice#9455,cval_lineitem_l_discount#9456,cval_lineitem_l_tax#9457,cval_lineitem_l_returnflag#9458,cval_lineitem_l_linestatus#9459,cval_lineitem_l_commitdate#9460,cval_lineitem_l_receiptdate#9461,cval_lineitem_l_shipinstruct#9462,cval_lineitem_l_shipmode#9463,cval_lineitem_l_comment#9464,cval_lineitem_l_shipdate#9465,cdepval_lineitem_l_quantity#9466,cdepval_lineitem_l_extendedprice#9467,cdepval_lineitem_l_discount#9468,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#9305 AS rid_1#9350, cpfk_orders_lineitem#9306 AS cpfk_orders_lineitem_1#9351, cpfk_supplier_lineitem#9307 AS cpfk_supplier_lineitem_1#9352, cfpk_lineitem_supplier#9308 AS cfpk_lineitem_supplier_1#9353, cfpk_lineitem_partsupp#9309 AS cfpk_lineitem_partsupp_1#9354, cpfk_part_lineitem#9310 AS cpfk_part_lineitem_1#9355, cfpk_lineitem_part#9311 AS cfpk_lineitem_part_1#9356, cpfk_partsupp_lineitem#9312 AS cpfk_partsupp_lineitem_1#9357, cfpk_lineitem_orders#9313 AS cfpk_lineitem_orders_1#9358, cval_lineitem_l_quantity#9314 AS cval_lineitem_l_quantity_1#9359, cval_lineitem_l_extendedprice#9315 AS cval_lineitem_l_extendedprice_1#9360, cval_lineitem_l_discount#9316 AS cval_lineitem_l_discount_1#9361, cval_lineitem_l_tax#9317 AS cval_lineitem_l_tax_1#9362, cval_lineitem_l_returnflag#9318 AS cval_lineitem_l_returnflag_1#9363, cval_lineitem_l_linestatus#9319 AS cval_lineitem_l_linestatus_1#9364, cval_lineitem_l_commitdate#9320 AS cval_lineitem_l_commitdate_1#9365, cval_lineitem_l_receiptdate#9321 AS cval_lineitem_l_receiptdate_1#9366, cval_lineitem_l_shipinstruct#9322 AS cval_lineitem_l_shipinstruct_1#9367, cval_lineitem_l_shipmode#9323 AS cval_lineitem_l_shipmode_1#9368, cval_lineitem_l_comment#9324 AS cval_lineitem_l_comment_1#9369, cval_lineitem_l_shipdate#9325 AS cval_lineitem_l_shipdate_1#9370, cdepval_lineitem_l_quantity#9326 AS cdepval_lineitem_l_quantity_1#9371, cdepval_lineitem_l_extendedprice#9327 AS cdepval_lineitem_l_extendedprice_1#9372, cdepval_lineitem_l_discount#9328 AS cdepval_lineitem_l_discount_1#9373, ... 21 more fields]
            +- Relation[rid#9305,cpfk_orders_lineitem#9306,cpfk_supplier_lineitem#9307,cfpk_lineitem_supplier#9308,cfpk_lineitem_partsupp#9309,cpfk_part_lineitem#9310,cfpk_lineitem_part#9311,cpfk_partsupp_lineitem#9312,cfpk_lineitem_orders#9313,cval_lineitem_l_quantity#9314,cval_lineitem_l_extendedprice#9315,cval_lineitem_l_discount#9316,cval_lineitem_l_tax#9317,cval_lineitem_l_returnflag#9318,cval_lineitem_l_linestatus#9319,cval_lineitem_l_commitdate#9320,cval_lineitem_l_receiptdate#9321,cval_lineitem_l_shipinstruct#9322,cval_lineitem_l_shipmode#9323,cval_lineitem_l_comment#9324,cval_lineitem_l_shipdate#9325,cdepval_lineitem_l_quantity#9326,cdepval_lineitem_l_extendedprice#9327,cdepval_lineitem_l_discount#9328,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 509ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/26 21:49:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:49:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9633L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:49:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9633L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#9635 AS rid_0#9680, cpfk_orders_lineitem#9636 AS cpfk_orders_lineitem_0#9681, cpfk_supplier_lineitem#9637 AS cpfk_supplier_lineitem_0#9682, cfpk_lineitem_supplier#9638 AS cfpk_lineitem_supplier_0#9683, cfpk_lineitem_partsupp#9639 AS cfpk_lineitem_partsupp_0#9684, cpfk_part_lineitem#9640 AS cpfk_part_lineitem_0#9685, cfpk_lineitem_part#9641 AS cfpk_lineitem_part_0#9686, cpfk_partsupp_lineitem#9642 AS cpfk_partsupp_lineitem_0#9687, cfpk_lineitem_orders#9643 AS cfpk_lineitem_orders_0#9688, cval_lineitem_l_quantity#9644 AS cval_lineitem_l_quantity_0#9689, cval_lineitem_l_extendedprice#9645 AS cval_lineitem_l_extendedprice_0#9690, cval_lineitem_l_discount#9646 AS cval_lineitem_l_discount_0#9691, cval_lineitem_l_tax#9647 AS cval_lineitem_l_tax_0#9692, cval_lineitem_l_returnflag#9648 AS cval_lineitem_l_returnflag_0#9693, cval_lineitem_l_linestatus#9649 AS cval_lineitem_l_linestatus_0#9694, cval_lineitem_l_commitdate#9650 AS cval_lineitem_l_commitdate_0#9695, cval_lineitem_l_receiptdate#9651 AS cval_lineitem_l_receiptdate_0#9696, cval_lineitem_l_shipinstruct#9652 AS cval_lineitem_l_shipinstruct_0#9697, cval_lineitem_l_shipmode#9653 AS cval_lineitem_l_shipmode_0#9698, cval_lineitem_l_comment#9654 AS cval_lineitem_l_comment_0#9699, cval_lineitem_l_shipdate#9655 AS cval_lineitem_l_shipdate_0#9700, cdepval_lineitem_l_quantity#9656 AS cdepval_lineitem_l_quantity_0#9701, cdepval_lineitem_l_extendedprice#9657 AS cdepval_lineitem_l_extendedprice_0#9702, cdepval_lineitem_l_discount#9658 AS cdepval_lineitem_l_discount_0#9703, ... 21 more fields]
         :  +- Relation[rid#9635,cpfk_orders_lineitem#9636,cpfk_supplier_lineitem#9637,cfpk_lineitem_supplier#9638,cfpk_lineitem_partsupp#9639,cpfk_part_lineitem#9640,cfpk_lineitem_part#9641,cpfk_partsupp_lineitem#9642,cfpk_lineitem_orders#9643,cval_lineitem_l_quantity#9644,cval_lineitem_l_extendedprice#9645,cval_lineitem_l_discount#9646,cval_lineitem_l_tax#9647,cval_lineitem_l_returnflag#9648,cval_lineitem_l_linestatus#9649,cval_lineitem_l_commitdate#9650,cval_lineitem_l_receiptdate#9651,cval_lineitem_l_shipinstruct#9652,cval_lineitem_l_shipmode#9653,cval_lineitem_l_comment#9654,cval_lineitem_l_shipdate#9655,cdepval_lineitem_l_quantity#9656,cdepval_lineitem_l_extendedprice#9657,cdepval_lineitem_l_discount#9658,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#9725 AS rid_1#9749, cpfk_customer_orders#9726 AS cpfk_customer_orders_1#9750, cfpk_orders_customer#9727 AS cfpk_orders_customer_1#9751, cval_orders_o_orderstatus#9728 AS cval_orders_o_orderstatus_1#9752, cval_orders_o_totalprice#9729 AS cval_orders_o_totalprice_1#9753, cval_orders_o_orderpriority#9730 AS cval_orders_o_orderpriority_1#9754, cval_orders_o_clerk#9731 AS cval_orders_o_clerk_1#9755, cval_orders_o_shippriority#9732 AS cval_orders_o_shippriority_1#9756, cval_orders_o_comment#9733 AS cval_orders_o_comment_1#9757, cval_orders_o_orderdate#9734 AS cval_orders_o_orderdate_1#9758, cdepval_orders_o_orderstatus#9735 AS cdepval_orders_o_orderstatus_1#9759, cdepval_orders_o_totalprice#9736 AS cdepval_orders_o_totalprice_1#9760, cdepval_orders_o_orderpriority#9737 AS cdepval_orders_o_orderpriority_1#9761, cdepval_orders_o_clerk#9738 AS cdepval_orders_o_clerk_1#9762, cdepval_orders_o_shippriority#9739 AS cdepval_orders_o_shippriority_1#9763, cdepval_orders_o_comment#9740 AS cdepval_orders_o_comment_1#9764, cdepval_orders_o_orderdate#9741 AS cdepval_orders_o_orderdate_1#9765, co_orderstatus#9742 AS co_orderstatus_1#9766, co_totalprice#9743 AS co_totalprice_1#9767, co_orderpriority#9744 AS co_orderpriority_1#9768, co_clerk#9745 AS co_clerk_1#9769, co_shippriority#9746 AS co_shippriority_1#9770, co_comment#9747 AS co_comment_1#9771, co_orderdate#9748 AS co_orderdate_1#9772]
            +- Relation[rid#9725,cpfk_customer_orders#9726,cfpk_orders_customer#9727,cval_orders_o_orderstatus#9728,cval_orders_o_totalprice#9729,cval_orders_o_orderpriority#9730,cval_orders_o_clerk#9731,cval_orders_o_shippriority#9732,cval_orders_o_comment#9733,cval_orders_o_orderdate#9734,cdepval_orders_o_orderstatus#9735,cdepval_orders_o_totalprice#9736,cdepval_orders_o_orderpriority#9737,cdepval_orders_o_clerk#9738,cdepval_orders_o_shippriority#9739,cdepval_orders_o_comment#9740,cdepval_orders_o_orderdate#9741,co_orderstatus#9742,co_totalprice#9743,co_orderpriority#9744,co_clerk#9745,co_shippriority#9746,co_comment#9747,co_orderdate#9748] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18592ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/26 21:49:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:49:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9847L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 21:49:26 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:49:26 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:49:26 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:49:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:49:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:49:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:49:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:49:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:49:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:49:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:49:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:49:26 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:49:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:49:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9847L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#9874, cval_part_p_name_0#9875, cval_part_p_mfgr_0#9876, cval_part_p_type_0#9877, cval_part_p_size_0#9878, cval_part_p_container_0#9879, cval_part_p_retailprice_0#9880, cval_part_p_comment_0#9881, cval_part_p_brand_0#9882, cdepval_part_p_name_0#9883, cdepval_part_p_mfgr_0#9884, cdepval_part_p_type_0#9885, cdepval_part_p_size_0#9886, cdepval_part_p_container_0#9887, cdepval_part_p_retailprice_0#9888, cdepval_part_p_comment_0#9889, cdepval_part_p_brand_0#9890, cp_name_0#9891, cp_mfgr_0#9892, cp_type_0#9893, cp_size_0#9894, cp_container_0#9895, cp_retailprice_0#9896, cp_comment_0#9897, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  :  +- Project [rid#9849 AS rid_0#9874, cval_part_p_name#9850 AS cval_part_p_name_0#9875, cval_part_p_mfgr#9851 AS cval_part_p_mfgr_0#9876, cval_part_p_type#9852 AS cval_part_p_type_0#9877, cval_part_p_size#9853 AS cval_part_p_size_0#9878, cval_part_p_container#9854 AS cval_part_p_container_0#9879, cval_part_p_retailprice#9855 AS cval_part_p_retailprice_0#9880, cval_part_p_comment#9856 AS cval_part_p_comment_0#9881, cval_part_p_brand#9857 AS cval_part_p_brand_0#9882, cdepval_part_p_name#9858 AS cdepval_part_p_name_0#9883, cdepval_part_p_mfgr#9859 AS cdepval_part_p_mfgr_0#9884, cdepval_part_p_type#9860 AS cdepval_part_p_type_0#9885, cdepval_part_p_size#9861 AS cdepval_part_p_size_0#9886, cdepval_part_p_container#9862 AS cdepval_part_p_container_0#9887, cdepval_part_p_retailprice#9863 AS cdepval_part_p_retailprice_0#9888, cdepval_part_p_comment#9864 AS cdepval_part_p_comment_0#9889, cdepval_part_p_brand#9865 AS cdepval_part_p_brand_0#9890, cp_name#9866 AS cp_name_0#9891, cp_mfgr#9867 AS cp_mfgr_0#9892, cp_type#9868 AS cp_type_0#9893, cp_size#9869 AS cp_size_0#9894, cp_container#9870 AS cp_container_0#9895, cp_retailprice#9871 AS cp_retailprice_0#9896, cp_comment#9872 AS cp_comment_0#9897, cp_brand#9873 AS cp_brand_0#9898]
         :  :  :     +- Relation[rid#9849,cval_part_p_name#9850,cval_part_p_mfgr#9851,cval_part_p_type#9852,cval_part_p_size#9853,cval_part_p_container#9854,cval_part_p_retailprice#9855,cval_part_p_comment#9856,cval_part_p_brand#9857,cdepval_part_p_name#9858,cdepval_part_p_mfgr#9859,cdepval_part_p_type#9860,cdepval_part_p_size#9861,cdepval_part_p_container#9862,cdepval_part_p_retailprice#9863,cdepval_part_p_comment#9864,cdepval_part_p_brand#9865,cp_name#9866,cp_mfgr#9867,cp_type#9868,cp_size#9869,cp_container#9870,cp_retailprice#9871,cp_comment#9872,cp_brand#9873] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :  :     +- Project [rid#10027 AS rid_1#10041, cpfk_part_partsupp#10028 AS cpfk_part_partsupp_1#10042, cfpk_partsupp_part#10029 AS cfpk_partsupp_part_1#10043, cpfk_supplier_partsupp#10030 AS cpfk_supplier_partsupp_1#10044, cfpk_partsupp_supplier#10031 AS cfpk_partsupp_supplier_1#10045, cval_partsupp_ps_availqty#10032 AS cval_partsupp_ps_availqty_1#10046, cval_partsupp_ps_supplycost#10033 AS cval_partsupp_ps_supplycost_1#10047, cval_partsupp_ps_comment#10034 AS cval_partsupp_ps_comment_1#10048, cdepval_partsupp_ps_availqty#10035 AS cdepval_partsupp_ps_availqty_1#10049, cdepval_partsupp_ps_supplycost#10036 AS cdepval_partsupp_ps_supplycost_1#10050, cdepval_partsupp_ps_comment#10037 AS cdepval_partsupp_ps_comment_1#10051, cps_availqty#10038 AS cps_availqty_1#10052, cps_supplycost#10039 AS cps_supplycost_1#10053, cps_comment#10040 AS cps_comment_1#10054]
         :  :        +- Relation[rid#10027,cpfk_part_partsupp#10028,cfpk_partsupp_part#10029,cpfk_supplier_partsupp#10030,cfpk_partsupp_supplier#10031,cval_partsupp_ps_availqty#10032,cval_partsupp_ps_supplycost#10033,cval_partsupp_ps_comment#10034,cdepval_partsupp_ps_availqty#10035,cdepval_partsupp_ps_supplycost#10036,cdepval_partsupp_ps_comment#10037,cps_availqty#10038,cps_supplycost#10039,cps_comment#10040] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#9949 AS rid_1#9963, cpfk_part_partsupp#9950 AS cpfk_part_partsupp_1#9964, cfpk_partsupp_part#9951 AS cfpk_partsupp_part_1#9965, cpfk_supplier_partsupp#9952 AS cpfk_supplier_partsupp_1#9966, cfpk_partsupp_supplier#9953 AS cfpk_partsupp_supplier_1#9967, cval_partsupp_ps_availqty#9954 AS cval_partsupp_ps_availqty_1#9968, cval_partsupp_ps_supplycost#9955 AS cval_partsupp_ps_supplycost_1#9969, cval_partsupp_ps_comment#9956 AS cval_partsupp_ps_comment_1#9970, cdepval_partsupp_ps_availqty#9957 AS cdepval_partsupp_ps_availqty_1#9971, cdepval_partsupp_ps_supplycost#9958 AS cdepval_partsupp_ps_supplycost_1#9972, cdepval_partsupp_ps_comment#9959 AS cdepval_partsupp_ps_comment_1#9973, cps_availqty#9960 AS cps_availqty_1#9974, cps_supplycost#9961 AS cps_supplycost_1#9975, cps_comment#9962 AS cps_comment_1#9976]
         :     +- Relation[rid#9949,cpfk_part_partsupp#9950,cfpk_partsupp_part#9951,cpfk_supplier_partsupp#9952,cfpk_partsupp_supplier#9953,cval_partsupp_ps_availqty#9954,cval_partsupp_ps_supplycost#9955,cval_partsupp_ps_comment#9956,cdepval_partsupp_ps_availqty#9957,cdepval_partsupp_ps_supplycost#9958,cdepval_partsupp_ps_comment#9959,cps_availqty#9960,cps_supplycost#9961,cps_comment#9962] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_2, NotMaterialized, NotMaterialized, [rid_2#10064, cpfk_region_nation_2#10065, cfpk_nation_region_2#10066, cval_nation_n_name_2#10067, cval_nation_n_comment_2#10068, cdepval_nation_n_name_2#10069, cdepval_nation_n_comment_2#10070, cn_name_2#10071, cn_comment_2#10072, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
            :  :  +- Project [rid#10055 AS rid_2#10064, cpfk_region_nation#10056 AS cpfk_region_nation_2#10065, cfpk_nation_region#10057 AS cfpk_nation_region_2#10066, cval_nation_n_name#10058 AS cval_nation_n_name_2#10067, cval_nation_n_comment#10059 AS cval_nation_n_comment_2#10068, cdepval_nation_n_name#10060 AS cdepval_nation_n_name_2#10069, cdepval_nation_n_comment#10061 AS cdepval_nation_n_comment_2#10070, cn_name#10062 AS cn_name_2#10071, cn_comment#10063 AS cn_comment_2#10072]
            :  :     +- Relation[rid#10055,cpfk_region_nation#10056,cfpk_nation_region#10057,cval_nation_n_name#10058,cval_nation_n_comment#10059,cdepval_nation_n_name#10060,cdepval_nation_n_comment#10061,cn_name#10062,cn_comment#10063] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#10145 AS rid_3#10163, cpfk_nation_supplier#10146 AS cpfk_nation_supplier_3#10164, cfpk_supplier_nation#10147 AS cfpk_supplier_nation_3#10165, cval_supplier_s_name#10148 AS cval_supplier_s_name_3#10166, cval_supplier_s_address#10149 AS cval_supplier_s_address_3#10167, cval_supplier_s_phone#10150 AS cval_supplier_s_phone_3#10168, cval_supplier_s_acctbal#10151 AS cval_supplier_s_acctbal_3#10169, cval_supplier_s_comment#10152 AS cval_supplier_s_comment_3#10170, cdepval_supplier_s_name#10153 AS cdepval_supplier_s_name_3#10171, cdepval_supplier_s_address#10154 AS cdepval_supplier_s_address_3#10172, cdepval_supplier_s_phone#10155 AS cdepval_supplier_s_phone_3#10173, cdepval_supplier_s_acctbal#10156 AS cdepval_supplier_s_acctbal_3#10174, cdepval_supplier_s_comment#10157 AS cdepval_supplier_s_comment_3#10175, cs_name#10158 AS cs_name_3#10176, cs_address#10159 AS cs_address_3#10177, cs_phone#10160 AS cs_phone_3#10178, cs_acctbal#10161 AS cs_acctbal_3#10179, cs_comment#10162 AS cs_comment_3#10180]
            :        +- Relation[rid#10145,cpfk_nation_supplier#10146,cfpk_supplier_nation#10147,cval_supplier_s_name#10148,cval_supplier_s_address#10149,cval_supplier_s_phone#10150,cval_supplier_s_acctbal#10151,cval_supplier_s_comment#10152,cdepval_supplier_s_name#10153,cdepval_supplier_s_address#10154,cdepval_supplier_s_phone#10155,cdepval_supplier_s_acctbal#10156,cdepval_supplier_s_comment#10157,cs_name#10158,cs_address#10159,cs_phone#10160,cs_acctbal#10161,cs_comment#10162] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#10091 AS rid_3#10109, cpfk_nation_supplier#10092 AS cpfk_nation_supplier_3#10110, cfpk_supplier_nation#10093 AS cfpk_supplier_nation_3#10111, cval_supplier_s_name#10094 AS cval_supplier_s_name_3#10112, cval_supplier_s_address#10095 AS cval_supplier_s_address_3#10113, cval_supplier_s_phone#10096 AS cval_supplier_s_phone_3#10114, cval_supplier_s_acctbal#10097 AS cval_supplier_s_acctbal_3#10115, cval_supplier_s_comment#10098 AS cval_supplier_s_comment_3#10116, cdepval_supplier_s_name#10099 AS cdepval_supplier_s_name_3#10117, cdepval_supplier_s_address#10100 AS cdepval_supplier_s_address_3#10118, cdepval_supplier_s_phone#10101 AS cdepval_supplier_s_phone_3#10119, cdepval_supplier_s_acctbal#10102 AS cdepval_supplier_s_acctbal_3#10120, cdepval_supplier_s_comment#10103 AS cdepval_supplier_s_comment_3#10121, cs_name#10104 AS cs_name_3#10122, cs_address#10105 AS cs_address_3#10123, cs_phone#10106 AS cs_phone_3#10124, cs_acctbal#10107 AS cs_acctbal_3#10125, cs_comment#10108 AS cs_comment_3#10126]
               +- Relation[rid#10091,cpfk_nation_supplier#10092,cfpk_supplier_nation#10093,cval_supplier_s_name#10094,cval_supplier_s_address#10095,cval_supplier_s_phone#10096,cval_supplier_s_acctbal#10097,cval_supplier_s_comment#10098,cdepval_supplier_s_name#10099,cdepval_supplier_s_address#10100,cdepval_supplier_s_phone#10101,cdepval_supplier_s_acctbal#10102,cdepval_supplier_s_comment#10103,cs_name#10104,cs_address#10105,cs_phone#10106,cs_acctbal#10107,cs_comment#10108] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 956ms
query=q1, count=6001215, duration=2439
query=q10, count=1478870, duration=57246
query=q11, count=31680, duration=2502
query=q12, count=857401, duration=21581
query=q13, count=1500000, duration=4508
query=q14, count=6001215, duration=17881
query=q15, count=6001215, duration=17757
query=q16, count=15780, duration=611
query=q17, count=6088, duration=509
query=q18, count=6001215, duration=22407
query=q19, count=205, duration=16721
query=q2, count=3162, duration=935
query=q20, count=632, duration=956
query=q21a, count=597422, duration=158746
query=q22, count=1500000, duration=4388
query=q3, count=1214743, duration=23948
query=q4, count=6001215, duration=18592
query=q5, count=48089, duration=29537
query=q6, count=6001215, duration=2369
query=q7, count=9735, duration=40531
query=q8, count=8716, duration=3377
query=q9a, count=6001215, duration=62641
query=q9b, count=6001215, duration=37593
