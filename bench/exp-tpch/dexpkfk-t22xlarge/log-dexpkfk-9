20/04/26 22:27:12 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10742ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sun Apr 26 22:27:15 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sun Apr 26 22:27:17 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sun Apr 26 22:27:17 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sun Apr 26 22:27:17 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sun Apr 26 22:27:17 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sun Apr 26 22:27:21 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sun Apr 26 22:27:25 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sun Apr 26 22:27:25 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/26 22:27:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:27:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2078L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 22:27:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2078L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#2080 AS rid_0#2104, cpfk_customer_orders#2081 AS cpfk_customer_orders_0#2105, cfpk_orders_customer#2082 AS cfpk_orders_customer_0#2106, cval_orders_o_orderstatus#2083 AS cval_orders_o_orderstatus_0#2107, cval_orders_o_totalprice#2084 AS cval_orders_o_totalprice_0#2108, cval_orders_o_orderpriority#2085 AS cval_orders_o_orderpriority_0#2109, cval_orders_o_clerk#2086 AS cval_orders_o_clerk_0#2110, cval_orders_o_shippriority#2087 AS cval_orders_o_shippriority_0#2111, cval_orders_o_comment#2088 AS cval_orders_o_comment_0#2112, cval_orders_o_orderdate#2089 AS cval_orders_o_orderdate_0#2113, cdepval_orders_o_orderstatus#2090 AS cdepval_orders_o_orderstatus_0#2114, cdepval_orders_o_totalprice#2091 AS cdepval_orders_o_totalprice_0#2115, cdepval_orders_o_orderpriority#2092 AS cdepval_orders_o_orderpriority_0#2116, cdepval_orders_o_clerk#2093 AS cdepval_orders_o_clerk_0#2117, cdepval_orders_o_shippriority#2094 AS cdepval_orders_o_shippriority_0#2118, cdepval_orders_o_comment#2095 AS cdepval_orders_o_comment_0#2119, cdepval_orders_o_orderdate#2096 AS cdepval_orders_o_orderdate_0#2120, co_orderstatus#2097 AS co_orderstatus_0#2121, co_totalprice#2098 AS co_totalprice_0#2122, co_orderpriority#2099 AS co_orderpriority_0#2123, co_clerk#2100 AS co_clerk_0#2124, co_shippriority#2101 AS co_shippriority_0#2125, co_comment#2102 AS co_comment_0#2126, co_orderdate#2103 AS co_orderdate_0#2127]
         :  +- Relation[rid#2080,cpfk_customer_orders#2081,cfpk_orders_customer#2082,cval_orders_o_orderstatus#2083,cval_orders_o_totalprice#2084,cval_orders_o_orderpriority#2085,cval_orders_o_clerk#2086,cval_orders_o_shippriority#2087,cval_orders_o_comment#2088,cval_orders_o_orderdate#2089,cdepval_orders_o_orderstatus#2090,cdepval_orders_o_totalprice#2091,cdepval_orders_o_orderpriority#2092,cdepval_orders_o_clerk#2093,cdepval_orders_o_shippriority#2094,cdepval_orders_o_comment#2095,cdepval_orders_o_orderdate#2096,co_orderstatus#2097,co_totalprice#2098,co_orderpriority#2099,co_clerk#2100,co_shippriority#2101,co_comment#2102,co_orderdate#2103] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#2128 AS rid_1#2149, cpfk_nation_customer#2129 AS cpfk_nation_customer_1#2150, cfpk_customer_nation#2130 AS cfpk_customer_nation_1#2151, cval_customer_c_name#2131 AS cval_customer_c_name_1#2152, cval_customer_c_address#2132 AS cval_customer_c_address_1#2153, cval_customer_c_phone#2133 AS cval_customer_c_phone_1#2154, cval_customer_c_acctbal#2134 AS cval_customer_c_acctbal_1#2155, cval_customer_c_comment#2135 AS cval_customer_c_comment_1#2156, cval_customer_c_mktsegment#2136 AS cval_customer_c_mktsegment_1#2157, cdepval_customer_c_name#2137 AS cdepval_customer_c_name_1#2158, cdepval_customer_c_address#2138 AS cdepval_customer_c_address_1#2159, cdepval_customer_c_phone#2139 AS cdepval_customer_c_phone_1#2160, cdepval_customer_c_acctbal#2140 AS cdepval_customer_c_acctbal_1#2161, cdepval_customer_c_comment#2141 AS cdepval_customer_c_comment_1#2162, cdepval_customer_c_mktsegment#2142 AS cdepval_customer_c_mktsegment_1#2163, cc_name#2143 AS cc_name_1#2164, cc_address#2144 AS cc_address_1#2165, cc_phone#2145 AS cc_phone_1#2166, cc_acctbal#2146 AS cc_acctbal_1#2167, cc_comment#2147 AS cc_comment_1#2168, cc_mktsegment#2148 AS cc_mktsegment_1#2169]
            +- Relation[rid#2128,cpfk_nation_customer#2129,cfpk_customer_nation#2130,cval_customer_c_name#2131,cval_customer_c_address#2132,cval_customer_c_phone#2133,cval_customer_c_acctbal#2134,cval_customer_c_comment#2135,cval_customer_c_mktsegment#2136,cdepval_customer_c_name#2137,cdepval_customer_c_address#2138,cdepval_customer_c_phone#2139,cdepval_customer_c_acctbal#2140,cdepval_customer_c_comment#2141,cdepval_customer_c_mktsegment#2142,cc_name#2143,cc_address#2144,cc_phone#2145,cc_acctbal#2146,cc_comment#2147,cc_mktsegment#2148] JDBCRelation(tcustomer) [numPartitions=1]

20/04/26 22:27:27 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexPkFk$ result size=1500000
Elapsed time: 4850ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/26 22:27:31 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:27:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2220L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:27:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#2220L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#2222 AS rid_0#2267, cpfk_orders_lineitem#2223 AS cpfk_orders_lineitem_0#2268, cpfk_supplier_lineitem#2224 AS cpfk_supplier_lineitem_0#2269, cfpk_lineitem_supplier#2225 AS cfpk_lineitem_supplier_0#2270, cfpk_lineitem_partsupp#2226 AS cfpk_lineitem_partsupp_0#2271, cpfk_part_lineitem#2227 AS cpfk_part_lineitem_0#2272, cfpk_lineitem_part#2228 AS cfpk_lineitem_part_0#2273, cpfk_partsupp_lineitem#2229 AS cpfk_partsupp_lineitem_0#2274, cfpk_lineitem_orders#2230 AS cfpk_lineitem_orders_0#2275, cval_lineitem_l_quantity#2231 AS cval_lineitem_l_quantity_0#2276, cval_lineitem_l_extendedprice#2232 AS cval_lineitem_l_extendedprice_0#2277, cval_lineitem_l_discount#2233 AS cval_lineitem_l_discount_0#2278, cval_lineitem_l_tax#2234 AS cval_lineitem_l_tax_0#2279, cval_lineitem_l_returnflag#2235 AS cval_lineitem_l_returnflag_0#2280, cval_lineitem_l_linestatus#2236 AS cval_lineitem_l_linestatus_0#2281, cval_lineitem_l_commitdate#2237 AS cval_lineitem_l_commitdate_0#2282, cval_lineitem_l_receiptdate#2238 AS cval_lineitem_l_receiptdate_0#2283, cval_lineitem_l_shipinstruct#2239 AS cval_lineitem_l_shipinstruct_0#2284, cval_lineitem_l_shipmode#2240 AS cval_lineitem_l_shipmode_0#2285, cval_lineitem_l_comment#2241 AS cval_lineitem_l_comment_0#2286, cval_lineitem_l_shipdate#2242 AS cval_lineitem_l_shipdate_0#2287, cdepval_lineitem_l_quantity#2243 AS cdepval_lineitem_l_quantity_0#2288, cdepval_lineitem_l_extendedprice#2244 AS cdepval_lineitem_l_extendedprice_0#2289, cdepval_lineitem_l_discount#2245 AS cdepval_lineitem_l_discount_0#2290, ... 21 more fields]
         +- Relation[rid#2222,cpfk_orders_lineitem#2223,cpfk_supplier_lineitem#2224,cfpk_lineitem_supplier#2225,cfpk_lineitem_partsupp#2226,cpfk_part_lineitem#2227,cfpk_lineitem_part#2228,cpfk_partsupp_lineitem#2229,cfpk_lineitem_orders#2230,cval_lineitem_l_quantity#2231,cval_lineitem_l_extendedprice#2232,cval_lineitem_l_discount#2233,cval_lineitem_l_tax#2234,cval_lineitem_l_returnflag#2235,cval_lineitem_l_linestatus#2236,cval_lineitem_l_commitdate#2237,cval_lineitem_l_receiptdate#2238,cval_lineitem_l_shipinstruct#2239,cval_lineitem_l_shipmode#2240,cval_lineitem_l_comment#2241,cval_lineitem_l_shipdate#2242,cdepval_lineitem_l_quantity#2243,cdepval_lineitem_l_extendedprice#2244,cdepval_lineitem_l_discount#2245,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2448ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/26 22:27:34 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:27:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2365L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:27:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:27:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:27:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:27:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:27:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:27:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:27:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:27:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:27:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:27:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:27:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:27:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:27:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:27:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:27:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2365L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#2493 AS rid_2#2538, cpfk_orders_lineitem#2494 AS cpfk_orders_lineitem_2#2539, cpfk_supplier_lineitem#2495 AS cpfk_supplier_lineitem_2#2540, cfpk_lineitem_supplier#2496 AS cfpk_lineitem_supplier_2#2541, cfpk_lineitem_partsupp#2497 AS cfpk_lineitem_partsupp_2#2542, cpfk_part_lineitem#2498 AS cpfk_part_lineitem_2#2543, cfpk_lineitem_part#2499 AS cfpk_lineitem_part_2#2544, cpfk_partsupp_lineitem#2500 AS cpfk_partsupp_lineitem_2#2545, cfpk_lineitem_orders#2501 AS cfpk_lineitem_orders_2#2546, cval_lineitem_l_quantity#2502 AS cval_lineitem_l_quantity_2#2547, cval_lineitem_l_extendedprice#2503 AS cval_lineitem_l_extendedprice_2#2548, cval_lineitem_l_discount#2504 AS cval_lineitem_l_discount_2#2549, cval_lineitem_l_tax#2505 AS cval_lineitem_l_tax_2#2550, cval_lineitem_l_returnflag#2506 AS cval_lineitem_l_returnflag_2#2551, cval_lineitem_l_linestatus#2507 AS cval_lineitem_l_linestatus_2#2552, cval_lineitem_l_commitdate#2508 AS cval_lineitem_l_commitdate_2#2553, cval_lineitem_l_receiptdate#2509 AS cval_lineitem_l_receiptdate_2#2554, cval_lineitem_l_shipinstruct#2510 AS cval_lineitem_l_shipinstruct_2#2555, cval_lineitem_l_shipmode#2511 AS cval_lineitem_l_shipmode_2#2556, cval_lineitem_l_comment#2512 AS cval_lineitem_l_comment_2#2557, cval_lineitem_l_shipdate#2513 AS cval_lineitem_l_shipdate_2#2558, cdepval_lineitem_l_quantity#2514 AS cdepval_lineitem_l_quantity_2#2559, cdepval_lineitem_l_extendedprice#2515 AS cdepval_lineitem_l_extendedprice_2#2560, cdepval_lineitem_l_discount#2516 AS cdepval_lineitem_l_discount_2#2561, ... 21 more fields]
         :  :  +- Relation[rid#2493,cpfk_orders_lineitem#2494,cpfk_supplier_lineitem#2495,cfpk_lineitem_supplier#2496,cfpk_lineitem_partsupp#2497,cpfk_part_lineitem#2498,cfpk_lineitem_part#2499,cpfk_partsupp_lineitem#2500,cfpk_lineitem_orders#2501,cval_lineitem_l_quantity#2502,cval_lineitem_l_extendedprice#2503,cval_lineitem_l_discount#2504,cval_lineitem_l_tax#2505,cval_lineitem_l_returnflag#2506,cval_lineitem_l_linestatus#2507,cval_lineitem_l_commitdate#2508,cval_lineitem_l_receiptdate#2509,cval_lineitem_l_shipinstruct#2510,cval_lineitem_l_shipmode#2511,cval_lineitem_l_comment#2512,cval_lineitem_l_shipdate#2513,cdepval_lineitem_l_quantity#2514,cdepval_lineitem_l_extendedprice#2515,cdepval_lineitem_l_discount#2516,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join UsingJoin(Inner,List(rid_1))
         :     :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#2376, cpfk_region_nation_0#2377, cfpk_nation_region_0#2378, cval_nation_n_name_0#2379, cval_nation_n_comment_0#2380, cdepval_nation_n_name_0#2381, cdepval_nation_n_comment_0#2382, cn_name_0#2383, cn_comment_0#2384, 'rid_1]
         :     :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :     :  :  +- Project [rid#2367 AS rid_0#2376, cpfk_region_nation#2368 AS cpfk_region_nation_0#2377, cfpk_nation_region#2369 AS cfpk_nation_region_0#2378, cval_nation_n_name#2370 AS cval_nation_n_name_0#2379, cval_nation_n_comment#2371 AS cval_nation_n_comment_0#2380, cdepval_nation_n_name#2372 AS cdepval_nation_n_name_0#2381, cdepval_nation_n_comment#2373 AS cdepval_nation_n_comment_0#2382, cn_name#2374 AS cn_name_0#2383, cn_comment#2375 AS cn_comment_0#2384]
         :     :  :     +- Relation[rid#2367,cpfk_region_nation#2368,cfpk_nation_region#2369,cval_nation_n_name#2370,cval_nation_n_comment#2371,cdepval_nation_n_name#2372,cdepval_nation_n_comment#2373,cn_name#2374,cn_comment#2375] JDBCRelation(tnation) [numPartitions=1]
         :     :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
         :     :     +- Project [rid#2457 AS rid_1#2475, cpfk_nation_supplier#2458 AS cpfk_nation_supplier_1#2476, cfpk_supplier_nation#2459 AS cfpk_supplier_nation_1#2477, cval_supplier_s_name#2460 AS cval_supplier_s_name_1#2478, cval_supplier_s_address#2461 AS cval_supplier_s_address_1#2479, cval_supplier_s_phone#2462 AS cval_supplier_s_phone_1#2480, cval_supplier_s_acctbal#2463 AS cval_supplier_s_acctbal_1#2481, cval_supplier_s_comment#2464 AS cval_supplier_s_comment_1#2482, cdepval_supplier_s_name#2465 AS cdepval_supplier_s_name_1#2483, cdepval_supplier_s_address#2466 AS cdepval_supplier_s_address_1#2484, cdepval_supplier_s_phone#2467 AS cdepval_supplier_s_phone_1#2485, cdepval_supplier_s_acctbal#2468 AS cdepval_supplier_s_acctbal_1#2486, cdepval_supplier_s_comment#2469 AS cdepval_supplier_s_comment_1#2487, cs_name#2470 AS cs_name_1#2488, cs_address#2471 AS cs_address_1#2489, cs_phone#2472 AS cs_phone_1#2490, cs_acctbal#2473 AS cs_acctbal_1#2491, cs_comment#2474 AS cs_comment_1#2492]
         :     :        +- Relation[rid#2457,cpfk_nation_supplier#2458,cfpk_supplier_nation#2459,cval_supplier_s_name#2460,cval_supplier_s_address#2461,cval_supplier_s_phone#2462,cval_supplier_s_acctbal#2463,cval_supplier_s_comment#2464,cdepval_supplier_s_name#2465,cdepval_supplier_s_address#2466,cdepval_supplier_s_phone#2467,cdepval_supplier_s_acctbal#2468,cdepval_supplier_s_comment#2469,cs_name#2470,cs_address#2471,cs_phone#2472,cs_acctbal#2473,cs_comment#2474] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#2403 AS rid_1#2421, cpfk_nation_supplier#2404 AS cpfk_nation_supplier_1#2422, cfpk_supplier_nation#2405 AS cfpk_supplier_nation_1#2423, cval_supplier_s_name#2406 AS cval_supplier_s_name_1#2424, cval_supplier_s_address#2407 AS cval_supplier_s_address_1#2425, cval_supplier_s_phone#2408 AS cval_supplier_s_phone_1#2426, cval_supplier_s_acctbal#2409 AS cval_supplier_s_acctbal_1#2427, cval_supplier_s_comment#2410 AS cval_supplier_s_comment_1#2428, cdepval_supplier_s_name#2411 AS cdepval_supplier_s_name_1#2429, cdepval_supplier_s_address#2412 AS cdepval_supplier_s_address_1#2430, cdepval_supplier_s_phone#2413 AS cdepval_supplier_s_phone_1#2431, cdepval_supplier_s_acctbal#2414 AS cdepval_supplier_s_acctbal_1#2432, cdepval_supplier_s_comment#2415 AS cdepval_supplier_s_comment_1#2433, cs_name#2416 AS cs_name_1#2434, cs_address#2417 AS cs_address_1#2435, cs_phone#2418 AS cs_phone_1#2436, cs_acctbal#2419 AS cs_acctbal_1#2437, cs_comment#2420 AS cs_comment_1#2438]
         :        +- Relation[rid#2403,cpfk_nation_supplier#2404,cfpk_supplier_nation#2405,cval_supplier_s_name#2406,cval_supplier_s_address#2407,cval_supplier_s_phone#2408,cval_supplier_s_acctbal#2409,cval_supplier_s_comment#2410,cdepval_supplier_s_name#2411,cdepval_supplier_s_address#2412,cdepval_supplier_s_phone#2413,cdepval_supplier_s_acctbal#2414,cdepval_supplier_s_comment#2415,cs_name#2416,cs_address#2417,cs_phone#2418,cs_acctbal#2419,cs_comment#2420] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#2721 AS rid_5#2745, cpfk_customer_orders#2722 AS cpfk_customer_orders_5#2746, cfpk_orders_customer#2723 AS cfpk_orders_customer_5#2747, cval_orders_o_orderstatus#2724 AS cval_orders_o_orderstatus_5#2748, cval_orders_o_totalprice#2725 AS cval_orders_o_totalprice_5#2749, cval_orders_o_orderpriority#2726 AS cval_orders_o_orderpriority_5#2750, cval_orders_o_clerk#2727 AS cval_orders_o_clerk_5#2751, cval_orders_o_shippriority#2728 AS cval_orders_o_shippriority_5#2752, cval_orders_o_comment#2729 AS cval_orders_o_comment_5#2753, cval_orders_o_orderdate#2730 AS cval_orders_o_orderdate_5#2754, cdepval_orders_o_orderstatus#2731 AS cdepval_orders_o_orderstatus_5#2755, cdepval_orders_o_totalprice#2732 AS cdepval_orders_o_totalprice_5#2756, cdepval_orders_o_orderpriority#2733 AS cdepval_orders_o_orderpriority_5#2757, cdepval_orders_o_clerk#2734 AS cdepval_orders_o_clerk_5#2758, cdepval_orders_o_shippriority#2735 AS cdepval_orders_o_shippriority_5#2759, cdepval_orders_o_comment#2736 AS cdepval_orders_o_comment_5#2760, cdepval_orders_o_orderdate#2737 AS cdepval_orders_o_orderdate_5#2761, co_orderstatus#2738 AS co_orderstatus_5#2762, co_totalprice#2739 AS co_totalprice_5#2763, co_orderpriority#2740 AS co_orderpriority_5#2764, co_clerk#2741 AS co_clerk_5#2765, co_shippriority#2742 AS co_shippriority_5#2766, co_comment#2743 AS co_comment_5#2767, co_orderdate#2744 AS co_orderdate_5#2768]
            :  +- Relation[rid#2721,cpfk_customer_orders#2722,cfpk_orders_customer#2723,cval_orders_o_orderstatus#2724,cval_orders_o_totalprice#2725,cval_orders_o_orderpriority#2726,cval_orders_o_clerk#2727,cval_orders_o_shippriority#2728,cval_orders_o_comment#2729,cval_orders_o_orderdate#2730,cdepval_orders_o_orderstatus#2731,cdepval_orders_o_totalprice#2732,cdepval_orders_o_orderpriority#2733,cdepval_orders_o_clerk#2734,cdepval_orders_o_shippriority#2735,cdepval_orders_o_comment#2736,cdepval_orders_o_orderdate#2737,co_orderstatus#2738,co_totalprice#2739,co_orderpriority#2740,co_clerk#2741,co_shippriority#2742,co_comment#2743,co_orderdate#2744] JDBCRelation(torders) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_4))
               :- 'DexPkfkMaterializationAwareJoin nation~customer, 'cpfk_nation_customer_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#2592, cpfk_region_nation_3#2593, cfpk_nation_region_3#2594, cval_nation_n_name_3#2595, cval_nation_n_comment_3#2596, cdepval_nation_n_name_3#2597, cdepval_nation_n_comment_3#2598, cn_name_3#2599, cn_comment_3#2600, 'rid_4]
               :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
               :  :  +- Project [rid#2583 AS rid_3#2592, cpfk_region_nation#2584 AS cpfk_region_nation_3#2593, cfpk_nation_region#2585 AS cfpk_nation_region_3#2594, cval_nation_n_name#2586 AS cval_nation_n_name_3#2595, cval_nation_n_comment#2587 AS cval_nation_n_comment_3#2596, cdepval_nation_n_name#2588 AS cdepval_nation_n_name_3#2597, cdepval_nation_n_comment#2589 AS cdepval_nation_n_comment_3#2598, cn_name#2590 AS cn_name_3#2599, cn_comment#2591 AS cn_comment_3#2600]
               :  :     +- Relation[rid#2583,cpfk_region_nation#2584,cfpk_nation_region#2585,cval_nation_n_name#2586,cval_nation_n_comment#2587,cdepval_nation_n_name#2588,cdepval_nation_n_comment#2589,cn_name#2590,cn_comment#2591] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'Project ['cpfk_nation_customer_4, 'rid_4]
               :     +- Project [rid#2679 AS rid_4#2700, cpfk_nation_customer#2680 AS cpfk_nation_customer_4#2701, cfpk_customer_nation#2681 AS cfpk_customer_nation_4#2702, cval_customer_c_name#2682 AS cval_customer_c_name_4#2703, cval_customer_c_address#2683 AS cval_customer_c_address_4#2704, cval_customer_c_phone#2684 AS cval_customer_c_phone_4#2705, cval_customer_c_acctbal#2685 AS cval_customer_c_acctbal_4#2706, cval_customer_c_comment#2686 AS cval_customer_c_comment_4#2707, cval_customer_c_mktsegment#2687 AS cval_customer_c_mktsegment_4#2708, cdepval_customer_c_name#2688 AS cdepval_customer_c_name_4#2709, cdepval_customer_c_address#2689 AS cdepval_customer_c_address_4#2710, cdepval_customer_c_phone#2690 AS cdepval_customer_c_phone_4#2711, cdepval_customer_c_acctbal#2691 AS cdepval_customer_c_acctbal_4#2712, cdepval_customer_c_comment#2692 AS cdepval_customer_c_comment_4#2713, cdepval_customer_c_mktsegment#2693 AS cdepval_customer_c_mktsegment_4#2714, cc_name#2694 AS cc_name_4#2715, cc_address#2695 AS cc_address_4#2716, cc_phone#2696 AS cc_phone_4#2717, cc_acctbal#2697 AS cc_acctbal_4#2718, cc_comment#2698 AS cc_comment_4#2719, cc_mktsegment#2699 AS cc_mktsegment_4#2720]
               :        +- Relation[rid#2679,cpfk_nation_customer#2680,cfpk_customer_nation#2681,cval_customer_c_name#2682,cval_customer_c_address#2683,cval_customer_c_phone#2684,cval_customer_c_acctbal#2685,cval_customer_c_comment#2686,cval_customer_c_mktsegment#2687,cdepval_customer_c_name#2688,cdepval_customer_c_address#2689,cdepval_customer_c_phone#2690,cdepval_customer_c_acctbal#2691,cdepval_customer_c_comment#2692,cdepval_customer_c_mktsegment#2693,cc_name#2694,cc_address#2695,cc_phone#2696,cc_acctbal#2697,cc_comment#2698,cc_mktsegment#2699] JDBCRelation(tcustomer) [numPartitions=1]
               +- Project [rid#2619 AS rid_4#2640, cpfk_nation_customer#2620 AS cpfk_nation_customer_4#2641, cfpk_customer_nation#2621 AS cfpk_customer_nation_4#2642, cval_customer_c_name#2622 AS cval_customer_c_name_4#2643, cval_customer_c_address#2623 AS cval_customer_c_address_4#2644, cval_customer_c_phone#2624 AS cval_customer_c_phone_4#2645, cval_customer_c_acctbal#2625 AS cval_customer_c_acctbal_4#2646, cval_customer_c_comment#2626 AS cval_customer_c_comment_4#2647, cval_customer_c_mktsegment#2627 AS cval_customer_c_mktsegment_4#2648, cdepval_customer_c_name#2628 AS cdepval_customer_c_name_4#2649, cdepval_customer_c_address#2629 AS cdepval_customer_c_address_4#2650, cdepval_customer_c_phone#2630 AS cdepval_customer_c_phone_4#2651, cdepval_customer_c_acctbal#2631 AS cdepval_customer_c_acctbal_4#2652, cdepval_customer_c_comment#2632 AS cdepval_customer_c_comment_4#2653, cdepval_customer_c_mktsegment#2633 AS cdepval_customer_c_mktsegment_4#2654, cc_name#2634 AS cc_name_4#2655, cc_address#2635 AS cc_address_4#2656, cc_phone#2636 AS cc_phone_4#2657, cc_acctbal#2637 AS cc_acctbal_4#2658, cc_comment#2638 AS cc_comment_4#2659, cc_mktsegment#2639 AS cc_mktsegment_4#2660]
                  +- Relation[rid#2619,cpfk_nation_customer#2620,cfpk_customer_nation#2621,cval_customer_c_name#2622,cval_customer_c_address#2623,cval_customer_c_phone#2624,cval_customer_c_acctbal#2625,cval_customer_c_comment#2626,cval_customer_c_mktsegment#2627,cdepval_customer_c_name#2628,cdepval_customer_c_address#2629,cdepval_customer_c_phone#2630,cdepval_customer_c_acctbal#2631,cdepval_customer_c_comment#2632,cdepval_customer_c_mktsegment#2633,cc_name#2634,cc_address#2635,cc_phone#2636,cc_acctbal#2637,cc_comment#2638,cc_mktsegment#2639] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 40415ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/26 22:28:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:28:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2901L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:28:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2901L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#2953 AS rid_1#2998, cpfk_orders_lineitem#2954 AS cpfk_orders_lineitem_1#2999, cpfk_supplier_lineitem#2955 AS cpfk_supplier_lineitem_1#3000, cfpk_lineitem_supplier#2956 AS cfpk_lineitem_supplier_1#3001, cfpk_lineitem_partsupp#2957 AS cfpk_lineitem_partsupp_1#3002, cpfk_part_lineitem#2958 AS cpfk_part_lineitem_1#3003, cfpk_lineitem_part#2959 AS cfpk_lineitem_part_1#3004, cpfk_partsupp_lineitem#2960 AS cpfk_partsupp_lineitem_1#3005, cfpk_lineitem_orders#2961 AS cfpk_lineitem_orders_1#3006, cval_lineitem_l_quantity#2962 AS cval_lineitem_l_quantity_1#3007, cval_lineitem_l_extendedprice#2963 AS cval_lineitem_l_extendedprice_1#3008, cval_lineitem_l_discount#2964 AS cval_lineitem_l_discount_1#3009, cval_lineitem_l_tax#2965 AS cval_lineitem_l_tax_1#3010, cval_lineitem_l_returnflag#2966 AS cval_lineitem_l_returnflag_1#3011, cval_lineitem_l_linestatus#2967 AS cval_lineitem_l_linestatus_1#3012, cval_lineitem_l_commitdate#2968 AS cval_lineitem_l_commitdate_1#3013, cval_lineitem_l_receiptdate#2969 AS cval_lineitem_l_receiptdate_1#3014, cval_lineitem_l_shipinstruct#2970 AS cval_lineitem_l_shipinstruct_1#3015, cval_lineitem_l_shipmode#2971 AS cval_lineitem_l_shipmode_1#3016, cval_lineitem_l_comment#2972 AS cval_lineitem_l_comment_1#3017, cval_lineitem_l_shipdate#2973 AS cval_lineitem_l_shipdate_1#3018, cdepval_lineitem_l_quantity#2974 AS cdepval_lineitem_l_quantity_1#3019, cdepval_lineitem_l_extendedprice#2975 AS cdepval_lineitem_l_extendedprice_1#3020, cdepval_lineitem_l_discount#2976 AS cdepval_lineitem_l_discount_1#3021, ... 21 more fields]
         :  +- Relation[rid#2953,cpfk_orders_lineitem#2954,cpfk_supplier_lineitem#2955,cfpk_lineitem_supplier#2956,cfpk_lineitem_partsupp#2957,cpfk_part_lineitem#2958,cfpk_lineitem_part#2959,cpfk_partsupp_lineitem#2960,cfpk_lineitem_orders#2961,cval_lineitem_l_quantity#2962,cval_lineitem_l_extendedprice#2963,cval_lineitem_l_discount#2964,cval_lineitem_l_tax#2965,cval_lineitem_l_returnflag#2966,cval_lineitem_l_linestatus#2967,cval_lineitem_l_commitdate#2968,cval_lineitem_l_receiptdate#2969,cval_lineitem_l_shipinstruct#2970,cval_lineitem_l_shipmode#2971,cval_lineitem_l_comment#2972,cval_lineitem_l_shipdate#2973,cdepval_lineitem_l_quantity#2974,cdepval_lineitem_l_extendedprice#2975,cdepval_lineitem_l_discount#2976,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2903 AS rid_0#2928, cval_part_p_name#2904 AS cval_part_p_name_0#2929, cval_part_p_mfgr#2905 AS cval_part_p_mfgr_0#2930, cval_part_p_type#2906 AS cval_part_p_type_0#2931, cval_part_p_size#2907 AS cval_part_p_size_0#2932, cval_part_p_container#2908 AS cval_part_p_container_0#2933, cval_part_p_retailprice#2909 AS cval_part_p_retailprice_0#2934, cval_part_p_comment#2910 AS cval_part_p_comment_0#2935, cval_part_p_brand#2911 AS cval_part_p_brand_0#2936, cdepval_part_p_name#2912 AS cdepval_part_p_name_0#2937, cdepval_part_p_mfgr#2913 AS cdepval_part_p_mfgr_0#2938, cdepval_part_p_type#2914 AS cdepval_part_p_type_0#2939, cdepval_part_p_size#2915 AS cdepval_part_p_size_0#2940, cdepval_part_p_container#2916 AS cdepval_part_p_container_0#2941, cdepval_part_p_retailprice#2917 AS cdepval_part_p_retailprice_0#2942, cdepval_part_p_comment#2918 AS cdepval_part_p_comment_0#2943, cdepval_part_p_brand#2919 AS cdepval_part_p_brand_0#2944, cp_name#2920 AS cp_name_0#2945, cp_mfgr#2921 AS cp_mfgr_0#2946, cp_type#2922 AS cp_type_0#2947, cp_size#2923 AS cp_size_0#2948, cp_container#2924 AS cp_container_0#2949, cp_retailprice#2925 AS cp_retailprice_0#2950, cp_comment#2926 AS cp_comment_0#2951, cp_brand#2927 AS cp_brand_0#2952]
            +- Relation[rid#2903,cval_part_p_name#2904,cval_part_p_mfgr#2905,cval_part_p_type#2906,cval_part_p_size#2907,cval_part_p_container#2908,cval_part_p_retailprice#2909,cval_part_p_comment#2910,cval_part_p_brand#2911,cdepval_part_p_name#2912,cdepval_part_p_mfgr#2913,cdepval_part_p_type#2914,cdepval_part_p_size#2915,cdepval_part_p_container#2916,cdepval_part_p_retailprice#2917,cdepval_part_p_comment#2918,cdepval_part_p_brand#2919,cp_name#2920,cp_mfgr#2921,cp_type#2922,cp_size#2923,cp_container#2924,cp_retailprice#2925,cp_comment#2926,cp_brand#2927] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18092ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/26 22:28:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:28:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3118L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:28:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#3118L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#3120 AS rid_0#3165, cpfk_orders_lineitem#3121 AS cpfk_orders_lineitem_0#3166, cpfk_supplier_lineitem#3122 AS cpfk_supplier_lineitem_0#3167, cfpk_lineitem_supplier#3123 AS cfpk_lineitem_supplier_0#3168, cfpk_lineitem_partsupp#3124 AS cfpk_lineitem_partsupp_0#3169, cpfk_part_lineitem#3125 AS cpfk_part_lineitem_0#3170, cfpk_lineitem_part#3126 AS cfpk_lineitem_part_0#3171, cpfk_partsupp_lineitem#3127 AS cpfk_partsupp_lineitem_0#3172, cfpk_lineitem_orders#3128 AS cfpk_lineitem_orders_0#3173, cval_lineitem_l_quantity#3129 AS cval_lineitem_l_quantity_0#3174, cval_lineitem_l_extendedprice#3130 AS cval_lineitem_l_extendedprice_0#3175, cval_lineitem_l_discount#3131 AS cval_lineitem_l_discount_0#3176, cval_lineitem_l_tax#3132 AS cval_lineitem_l_tax_0#3177, cval_lineitem_l_returnflag#3133 AS cval_lineitem_l_returnflag_0#3178, cval_lineitem_l_linestatus#3134 AS cval_lineitem_l_linestatus_0#3179, cval_lineitem_l_commitdate#3135 AS cval_lineitem_l_commitdate_0#3180, cval_lineitem_l_receiptdate#3136 AS cval_lineitem_l_receiptdate_0#3181, cval_lineitem_l_shipinstruct#3137 AS cval_lineitem_l_shipinstruct_0#3182, cval_lineitem_l_shipmode#3138 AS cval_lineitem_l_shipmode_0#3183, cval_lineitem_l_comment#3139 AS cval_lineitem_l_comment_0#3184, cval_lineitem_l_shipdate#3140 AS cval_lineitem_l_shipdate_0#3185, cdepval_lineitem_l_quantity#3141 AS cdepval_lineitem_l_quantity_0#3186, cdepval_lineitem_l_extendedprice#3142 AS cdepval_lineitem_l_extendedprice_0#3187, cdepval_lineitem_l_discount#3143 AS cdepval_lineitem_l_discount_0#3188, ... 21 more fields]
         +- Relation[rid#3120,cpfk_orders_lineitem#3121,cpfk_supplier_lineitem#3122,cfpk_lineitem_supplier#3123,cfpk_lineitem_partsupp#3124,cpfk_part_lineitem#3125,cfpk_lineitem_part#3126,cpfk_partsupp_lineitem#3127,cfpk_lineitem_orders#3128,cval_lineitem_l_quantity#3129,cval_lineitem_l_extendedprice#3130,cval_lineitem_l_discount#3131,cval_lineitem_l_tax#3132,cval_lineitem_l_returnflag#3133,cval_lineitem_l_linestatus#3134,cval_lineitem_l_commitdate#3135,cval_lineitem_l_receiptdate#3136,cval_lineitem_l_shipinstruct#3137,cval_lineitem_l_shipmode#3138,cval_lineitem_l_comment#3139,cval_lineitem_l_shipdate#3140,cdepval_lineitem_l_quantity#3141,cdepval_lineitem_l_extendedprice#3142,cdepval_lineitem_l_discount#3143,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2392ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/26 22:28:35 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:28:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3259L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 22:28:35 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:28:35 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:28:35 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:28:35 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:28:35 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:28:35 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:28:35 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:28:35 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:28:35 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:28:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3259L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#3261 AS rid_0#3306, cpfk_orders_lineitem#3262 AS cpfk_orders_lineitem_0#3307, cpfk_supplier_lineitem#3263 AS cpfk_supplier_lineitem_0#3308, cfpk_lineitem_supplier#3264 AS cfpk_lineitem_supplier_0#3309, cfpk_lineitem_partsupp#3265 AS cfpk_lineitem_partsupp_0#3310, cpfk_part_lineitem#3266 AS cpfk_part_lineitem_0#3311, cfpk_lineitem_part#3267 AS cfpk_lineitem_part_0#3312, cpfk_partsupp_lineitem#3268 AS cpfk_partsupp_lineitem_0#3313, cfpk_lineitem_orders#3269 AS cfpk_lineitem_orders_0#3314, cval_lineitem_l_quantity#3270 AS cval_lineitem_l_quantity_0#3315, cval_lineitem_l_extendedprice#3271 AS cval_lineitem_l_extendedprice_0#3316, cval_lineitem_l_discount#3272 AS cval_lineitem_l_discount_0#3317, cval_lineitem_l_tax#3273 AS cval_lineitem_l_tax_0#3318, cval_lineitem_l_returnflag#3274 AS cval_lineitem_l_returnflag_0#3319, cval_lineitem_l_linestatus#3275 AS cval_lineitem_l_linestatus_0#3320, cval_lineitem_l_commitdate#3276 AS cval_lineitem_l_commitdate_0#3321, cval_lineitem_l_receiptdate#3277 AS cval_lineitem_l_receiptdate_0#3322, cval_lineitem_l_shipinstruct#3278 AS cval_lineitem_l_shipinstruct_0#3323, cval_lineitem_l_shipmode#3279 AS cval_lineitem_l_shipmode_0#3324, cval_lineitem_l_comment#3280 AS cval_lineitem_l_comment_0#3325, cval_lineitem_l_shipdate#3281 AS cval_lineitem_l_shipdate_0#3326, cdepval_lineitem_l_quantity#3282 AS cdepval_lineitem_l_quantity_0#3327, cdepval_lineitem_l_extendedprice#3283 AS cdepval_lineitem_l_extendedprice_0#3328, cdepval_lineitem_l_discount#3284 AS cdepval_lineitem_l_discount_0#3329, ... 21 more fields]
         :  +- Relation[rid#3261,cpfk_orders_lineitem#3262,cpfk_supplier_lineitem#3263,cfpk_lineitem_supplier#3264,cfpk_lineitem_partsupp#3265,cpfk_part_lineitem#3266,cfpk_lineitem_part#3267,cpfk_partsupp_lineitem#3268,cfpk_lineitem_orders#3269,cval_lineitem_l_quantity#3270,cval_lineitem_l_extendedprice#3271,cval_lineitem_l_discount#3272,cval_lineitem_l_tax#3273,cval_lineitem_l_returnflag#3274,cval_lineitem_l_linestatus#3275,cval_lineitem_l_commitdate#3276,cval_lineitem_l_receiptdate#3277,cval_lineitem_l_shipinstruct#3278,cval_lineitem_l_shipmode#3279,cval_lineitem_l_comment#3280,cval_lineitem_l_shipdate#3281,cdepval_lineitem_l_quantity#3282,cdepval_lineitem_l_extendedprice#3283,cdepval_lineitem_l_discount#3284,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#3720, cpfk_region_nation_4#3721, cfpk_nation_region_4#3722, cval_nation_n_name_4#3723, cval_nation_n_comment_4#3724, cdepval_nation_n_name_4#3725, cdepval_nation_n_comment_4#3726, cn_name_4#3727, cn_comment_4#3728, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
            :  :  +- Project [rid#3711 AS rid_4#3720, cpfk_region_nation#3712 AS cpfk_region_nation_4#3721, cfpk_nation_region#3713 AS cfpk_nation_region_4#3722, cval_nation_n_name#3714 AS cval_nation_n_name_4#3723, cval_nation_n_comment#3715 AS cval_nation_n_comment_4#3724, cdepval_nation_n_name#3716 AS cdepval_nation_n_name_4#3725, cdepval_nation_n_comment#3717 AS cdepval_nation_n_comment_4#3726, cn_name#3718 AS cn_name_4#3727, cn_comment#3719 AS cn_comment_4#3728]
            :  :     +- Relation[rid#3711,cpfk_region_nation#3712,cfpk_nation_region#3713,cval_nation_n_name#3714,cval_nation_n_comment#3715,cdepval_nation_n_name#3716,cdepval_nation_n_comment#3717,cn_name#3718,cn_comment#3719] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#3765 AS rid_3#3783, cpfk_nation_supplier#3766 AS cpfk_nation_supplier_3#3784, cfpk_supplier_nation#3767 AS cfpk_supplier_nation_3#3785, cval_supplier_s_name#3768 AS cval_supplier_s_name_3#3786, cval_supplier_s_address#3769 AS cval_supplier_s_address_3#3787, cval_supplier_s_phone#3770 AS cval_supplier_s_phone_3#3788, cval_supplier_s_acctbal#3771 AS cval_supplier_s_acctbal_3#3789, cval_supplier_s_comment#3772 AS cval_supplier_s_comment_3#3790, cdepval_supplier_s_name#3773 AS cdepval_supplier_s_name_3#3791, cdepval_supplier_s_address#3774 AS cdepval_supplier_s_address_3#3792, cdepval_supplier_s_phone#3775 AS cdepval_supplier_s_phone_3#3793, cdepval_supplier_s_acctbal#3776 AS cdepval_supplier_s_acctbal_3#3794, cdepval_supplier_s_comment#3777 AS cdepval_supplier_s_comment_3#3795, cs_name#3778 AS cs_name_3#3796, cs_address#3779 AS cs_address_3#3797, cs_phone#3780 AS cs_phone_3#3798, cs_acctbal#3781 AS cs_acctbal_3#3799, cs_comment#3782 AS cs_comment_3#3800]
            :        +- Relation[rid#3765,cpfk_nation_supplier#3766,cfpk_supplier_nation#3767,cval_supplier_s_name#3768,cval_supplier_s_address#3769,cval_supplier_s_phone#3770,cval_supplier_s_acctbal#3771,cval_supplier_s_comment#3772,cdepval_supplier_s_name#3773,cdepval_supplier_s_address#3774,cdepval_supplier_s_phone#3775,cdepval_supplier_s_acctbal#3776,cdepval_supplier_s_comment#3777,cs_name#3778,cs_address#3779,cs_phone#3780,cs_acctbal#3781,cs_comment#3782] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'DexPkfkMaterializationAwareJoin orders~lineitem, 'cpfk_orders_lineitem_2, 'rid_1, NotMaterialized, NotMaterialized, [rid_1#3375, cpfk_customer_orders_1#3376, cfpk_orders_customer_1#3377, cval_orders_o_orderstatus_1#3378, cval_orders_o_totalprice_1#3379, cval_orders_o_orderpriority_1#3380, cval_orders_o_clerk_1#3381, cval_orders_o_shippriority_1#3382, cval_orders_o_comment_1#3383, cval_orders_o_orderdate_1#3384, cdepval_orders_o_orderstatus_1#3385, cdepval_orders_o_totalprice_1#3386, cdepval_orders_o_orderpriority_1#3387, cdepval_orders_o_clerk_1#3388, cdepval_orders_o_shippriority_1#3389, cdepval_orders_o_comment_1#3390, cdepval_orders_o_orderdate_1#3391, co_orderstatus_1#3392, co_totalprice_1#3393, co_orderpriority_1#3394, co_clerk_1#3395, co_shippriority_1#3396, co_comment_1#3397, co_orderdate_1#3398, 'rid_2]
               :  :  :- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
               :  :  :  +- Project [rid#3351 AS rid_1#3375, cpfk_customer_orders#3352 AS cpfk_customer_orders_1#3376, cfpk_orders_customer#3353 AS cfpk_orders_customer_1#3377, cval_orders_o_orderstatus#3354 AS cval_orders_o_orderstatus_1#3378, cval_orders_o_totalprice#3355 AS cval_orders_o_totalprice_1#3379, cval_orders_o_orderpriority#3356 AS cval_orders_o_orderpriority_1#3380, cval_orders_o_clerk#3357 AS cval_orders_o_clerk_1#3381, cval_orders_o_shippriority#3358 AS cval_orders_o_shippriority_1#3382, cval_orders_o_comment#3359 AS cval_orders_o_comment_1#3383, cval_orders_o_orderdate#3360 AS cval_orders_o_orderdate_1#3384, cdepval_orders_o_orderstatus#3361 AS cdepval_orders_o_orderstatus_1#3385, cdepval_orders_o_totalprice#3362 AS cdepval_orders_o_totalprice_1#3386, cdepval_orders_o_orderpriority#3363 AS cdepval_orders_o_orderpriority_1#3387, cdepval_orders_o_clerk#3364 AS cdepval_orders_o_clerk_1#3388, cdepval_orders_o_shippriority#3365 AS cdepval_orders_o_shippriority_1#3389, cdepval_orders_o_comment#3366 AS cdepval_orders_o_comment_1#3390, cdepval_orders_o_orderdate#3367 AS cdepval_orders_o_orderdate_1#3391, co_orderstatus#3368 AS co_orderstatus_1#3392, co_totalprice#3369 AS co_totalprice_1#3393, co_orderpriority#3370 AS co_orderpriority_1#3394, co_clerk#3371 AS co_clerk_1#3395, co_shippriority#3372 AS co_shippriority_1#3396, co_comment#3373 AS co_comment_1#3397, co_orderdate#3374 AS co_orderdate_1#3398]
               :  :  :     +- Relation[rid#3351,cpfk_customer_orders#3352,cfpk_orders_customer#3353,cval_orders_o_orderstatus#3354,cval_orders_o_totalprice#3355,cval_orders_o_orderpriority#3356,cval_orders_o_clerk#3357,cval_orders_o_shippriority#3358,cval_orders_o_comment#3359,cval_orders_o_orderdate#3360,cdepval_orders_o_orderstatus#3361,cdepval_orders_o_totalprice#3362,cdepval_orders_o_orderpriority#3363,cdepval_orders_o_clerk#3364,cdepval_orders_o_shippriority#3365,cdepval_orders_o_comment#3366,cdepval_orders_o_orderdate#3367,co_orderstatus#3368,co_totalprice#3369,co_orderpriority#3370,co_clerk#3371,co_shippriority#3372,co_comment#3373,co_orderdate#3374] JDBCRelation(torders) [numPartitions=1]
               :  :  +- 'Project ['cpfk_orders_lineitem_2, 'rid_2]
               :  :     +- Project [rid#3585 AS rid_2#3630, cpfk_orders_lineitem#3586 AS cpfk_orders_lineitem_2#3631, cpfk_supplier_lineitem#3587 AS cpfk_supplier_lineitem_2#3632, cfpk_lineitem_supplier#3588 AS cfpk_lineitem_supplier_2#3633, cfpk_lineitem_partsupp#3589 AS cfpk_lineitem_partsupp_2#3634, cpfk_part_lineitem#3590 AS cpfk_part_lineitem_2#3635, cfpk_lineitem_part#3591 AS cfpk_lineitem_part_2#3636, cpfk_partsupp_lineitem#3592 AS cpfk_partsupp_lineitem_2#3637, cfpk_lineitem_orders#3593 AS cfpk_lineitem_orders_2#3638, cval_lineitem_l_quantity#3594 AS cval_lineitem_l_quantity_2#3639, cval_lineitem_l_extendedprice#3595 AS cval_lineitem_l_extendedprice_2#3640, cval_lineitem_l_discount#3596 AS cval_lineitem_l_discount_2#3641, cval_lineitem_l_tax#3597 AS cval_lineitem_l_tax_2#3642, cval_lineitem_l_returnflag#3598 AS cval_lineitem_l_returnflag_2#3643, cval_lineitem_l_linestatus#3599 AS cval_lineitem_l_linestatus_2#3644, cval_lineitem_l_commitdate#3600 AS cval_lineitem_l_commitdate_2#3645, cval_lineitem_l_receiptdate#3601 AS cval_lineitem_l_receiptdate_2#3646, cval_lineitem_l_shipinstruct#3602 AS cval_lineitem_l_shipinstruct_2#3647, cval_lineitem_l_shipmode#3603 AS cval_lineitem_l_shipmode_2#3648, cval_lineitem_l_comment#3604 AS cval_lineitem_l_comment_2#3649, cval_lineitem_l_shipdate#3605 AS cval_lineitem_l_shipdate_2#3650, cdepval_lineitem_l_quantity#3606 AS cdepval_lineitem_l_quantity_2#3651, cdepval_lineitem_l_extendedprice#3607 AS cdepval_lineitem_l_extendedprice_2#3652, cdepval_lineitem_l_discount#3608 AS cdepval_lineitem_l_discount_2#3653, ... 21 more fields]
               :  :        +- Relation[rid#3585,cpfk_orders_lineitem#3586,cpfk_supplier_lineitem#3587,cfpk_lineitem_supplier#3588,cfpk_lineitem_partsupp#3589,cpfk_part_lineitem#3590,cfpk_lineitem_part#3591,cpfk_partsupp_lineitem#3592,cfpk_lineitem_orders#3593,cval_lineitem_l_quantity#3594,cval_lineitem_l_extendedprice#3595,cval_lineitem_l_discount#3596,cval_lineitem_l_tax#3597,cval_lineitem_l_returnflag#3598,cval_lineitem_l_linestatus#3599,cval_lineitem_l_commitdate#3600,cval_lineitem_l_receiptdate#3601,cval_lineitem_l_shipinstruct#3602,cval_lineitem_l_shipmode#3603,cval_lineitem_l_comment#3604,cval_lineitem_l_shipdate#3605,cdepval_lineitem_l_quantity#3606,cdepval_lineitem_l_extendedprice#3607,cdepval_lineitem_l_discount#3608,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               :  +- Project [rid#3447 AS rid_2#3492, cpfk_orders_lineitem#3448 AS cpfk_orders_lineitem_2#3493, cpfk_supplier_lineitem#3449 AS cpfk_supplier_lineitem_2#3494, cfpk_lineitem_supplier#3450 AS cfpk_lineitem_supplier_2#3495, cfpk_lineitem_partsupp#3451 AS cfpk_lineitem_partsupp_2#3496, cpfk_part_lineitem#3452 AS cpfk_part_lineitem_2#3497, cfpk_lineitem_part#3453 AS cfpk_lineitem_part_2#3498, cpfk_partsupp_lineitem#3454 AS cpfk_partsupp_lineitem_2#3499, cfpk_lineitem_orders#3455 AS cfpk_lineitem_orders_2#3500, cval_lineitem_l_quantity#3456 AS cval_lineitem_l_quantity_2#3501, cval_lineitem_l_extendedprice#3457 AS cval_lineitem_l_extendedprice_2#3502, cval_lineitem_l_discount#3458 AS cval_lineitem_l_discount_2#3503, cval_lineitem_l_tax#3459 AS cval_lineitem_l_tax_2#3504, cval_lineitem_l_returnflag#3460 AS cval_lineitem_l_returnflag_2#3505, cval_lineitem_l_linestatus#3461 AS cval_lineitem_l_linestatus_2#3506, cval_lineitem_l_commitdate#3462 AS cval_lineitem_l_commitdate_2#3507, cval_lineitem_l_receiptdate#3463 AS cval_lineitem_l_receiptdate_2#3508, cval_lineitem_l_shipinstruct#3464 AS cval_lineitem_l_shipinstruct_2#3509, cval_lineitem_l_shipmode#3465 AS cval_lineitem_l_shipmode_2#3510, cval_lineitem_l_comment#3466 AS cval_lineitem_l_comment_2#3511, cval_lineitem_l_shipdate#3467 AS cval_lineitem_l_shipdate_2#3512, cdepval_lineitem_l_quantity#3468 AS cdepval_lineitem_l_quantity_2#3513, cdepval_lineitem_l_extendedprice#3469 AS cdepval_lineitem_l_extendedprice_2#3514, cdepval_lineitem_l_discount#3470 AS cdepval_lineitem_l_discount_2#3515, ... 21 more fields]
               :     +- Relation[rid#3447,cpfk_orders_lineitem#3448,cpfk_supplier_lineitem#3449,cfpk_lineitem_supplier#3450,cfpk_lineitem_partsupp#3451,cpfk_part_lineitem#3452,cfpk_lineitem_part#3453,cpfk_partsupp_lineitem#3454,cfpk_lineitem_orders#3455,cval_lineitem_l_quantity#3456,cval_lineitem_l_extendedprice#3457,cval_lineitem_l_discount#3458,cval_lineitem_l_tax#3459,cval_lineitem_l_returnflag#3460,cval_lineitem_l_linestatus#3461,cval_lineitem_l_commitdate#3462,cval_lineitem_l_receiptdate#3463,cval_lineitem_l_shipinstruct#3464,cval_lineitem_l_shipmode#3465,cval_lineitem_l_comment#3466,cval_lineitem_l_shipdate#3467,cdepval_lineitem_l_quantity#3468,cdepval_lineitem_l_extendedprice#3469,cdepval_lineitem_l_discount#3470,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               +- Project [rid#3675 AS rid_3#3693, cpfk_nation_supplier#3676 AS cpfk_nation_supplier_3#3694, cfpk_supplier_nation#3677 AS cfpk_supplier_nation_3#3695, cval_supplier_s_name#3678 AS cval_supplier_s_name_3#3696, cval_supplier_s_address#3679 AS cval_supplier_s_address_3#3697, cval_supplier_s_phone#3680 AS cval_supplier_s_phone_3#3698, cval_supplier_s_acctbal#3681 AS cval_supplier_s_acctbal_3#3699, cval_supplier_s_comment#3682 AS cval_supplier_s_comment_3#3700, cdepval_supplier_s_name#3683 AS cdepval_supplier_s_name_3#3701, cdepval_supplier_s_address#3684 AS cdepval_supplier_s_address_3#3702, cdepval_supplier_s_phone#3685 AS cdepval_supplier_s_phone_3#3703, cdepval_supplier_s_acctbal#3686 AS cdepval_supplier_s_acctbal_3#3704, cdepval_supplier_s_comment#3687 AS cdepval_supplier_s_comment_3#3705, cs_name#3688 AS cs_name_3#3706, cs_address#3689 AS cs_address_3#3707, cs_phone#3690 AS cs_phone_3#3708, cs_acctbal#3691 AS cs_acctbal_3#3709, cs_comment#3692 AS cs_comment_3#3710]
                  +- Relation[rid#3675,cpfk_nation_supplier#3676,cfpk_supplier_nation#3677,cval_supplier_s_name#3678,cval_supplier_s_address#3679,cval_supplier_s_phone#3680,cval_supplier_s_acctbal#3681,cval_supplier_s_comment#3682,cdepval_supplier_s_name#3683,cdepval_supplier_s_address#3684,cdepval_supplier_s_phone#3685,cdepval_supplier_s_acctbal#3686,cdepval_supplier_s_comment#3687,cs_name#3688,cs_address#3689,cs_phone#3690,cs_acctbal#3691,cs_comment#3692] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 162191ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/26 22:31:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:31:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3970L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:31:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3970L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#3972 AS rid_0#4017, cpfk_orders_lineitem#3973 AS cpfk_orders_lineitem_0#4018, cpfk_supplier_lineitem#3974 AS cpfk_supplier_lineitem_0#4019, cfpk_lineitem_supplier#3975 AS cfpk_lineitem_supplier_0#4020, cfpk_lineitem_partsupp#3976 AS cfpk_lineitem_partsupp_0#4021, cpfk_part_lineitem#3977 AS cpfk_part_lineitem_0#4022, cfpk_lineitem_part#3978 AS cfpk_lineitem_part_0#4023, cpfk_partsupp_lineitem#3979 AS cpfk_partsupp_lineitem_0#4024, cfpk_lineitem_orders#3980 AS cfpk_lineitem_orders_0#4025, cval_lineitem_l_quantity#3981 AS cval_lineitem_l_quantity_0#4026, cval_lineitem_l_extendedprice#3982 AS cval_lineitem_l_extendedprice_0#4027, cval_lineitem_l_discount#3983 AS cval_lineitem_l_discount_0#4028, cval_lineitem_l_tax#3984 AS cval_lineitem_l_tax_0#4029, cval_lineitem_l_returnflag#3985 AS cval_lineitem_l_returnflag_0#4030, cval_lineitem_l_linestatus#3986 AS cval_lineitem_l_linestatus_0#4031, cval_lineitem_l_commitdate#3987 AS cval_lineitem_l_commitdate_0#4032, cval_lineitem_l_receiptdate#3988 AS cval_lineitem_l_receiptdate_0#4033, cval_lineitem_l_shipinstruct#3989 AS cval_lineitem_l_shipinstruct_0#4034, cval_lineitem_l_shipmode#3990 AS cval_lineitem_l_shipmode_0#4035, cval_lineitem_l_comment#3991 AS cval_lineitem_l_comment_0#4036, cval_lineitem_l_shipdate#3992 AS cval_lineitem_l_shipdate_0#4037, cdepval_lineitem_l_quantity#3993 AS cdepval_lineitem_l_quantity_0#4038, cdepval_lineitem_l_extendedprice#3994 AS cdepval_lineitem_l_extendedprice_0#4039, cdepval_lineitem_l_discount#3995 AS cdepval_lineitem_l_discount_0#4040, ... 21 more fields]
         :  +- Relation[rid#3972,cpfk_orders_lineitem#3973,cpfk_supplier_lineitem#3974,cfpk_lineitem_supplier#3975,cfpk_lineitem_partsupp#3976,cpfk_part_lineitem#3977,cfpk_lineitem_part#3978,cpfk_partsupp_lineitem#3979,cfpk_lineitem_orders#3980,cval_lineitem_l_quantity#3981,cval_lineitem_l_extendedprice#3982,cval_lineitem_l_discount#3983,cval_lineitem_l_tax#3984,cval_lineitem_l_returnflag#3985,cval_lineitem_l_linestatus#3986,cval_lineitem_l_commitdate#3987,cval_lineitem_l_receiptdate#3988,cval_lineitem_l_shipinstruct#3989,cval_lineitem_l_shipmode#3990,cval_lineitem_l_comment#3991,cval_lineitem_l_shipdate#3992,cdepval_lineitem_l_quantity#3993,cdepval_lineitem_l_extendedprice#3994,cdepval_lineitem_l_discount#3995,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4062 AS rid_1#4086, cpfk_customer_orders#4063 AS cpfk_customer_orders_1#4087, cfpk_orders_customer#4064 AS cfpk_orders_customer_1#4088, cval_orders_o_orderstatus#4065 AS cval_orders_o_orderstatus_1#4089, cval_orders_o_totalprice#4066 AS cval_orders_o_totalprice_1#4090, cval_orders_o_orderpriority#4067 AS cval_orders_o_orderpriority_1#4091, cval_orders_o_clerk#4068 AS cval_orders_o_clerk_1#4092, cval_orders_o_shippriority#4069 AS cval_orders_o_shippriority_1#4093, cval_orders_o_comment#4070 AS cval_orders_o_comment_1#4094, cval_orders_o_orderdate#4071 AS cval_orders_o_orderdate_1#4095, cdepval_orders_o_orderstatus#4072 AS cdepval_orders_o_orderstatus_1#4096, cdepval_orders_o_totalprice#4073 AS cdepval_orders_o_totalprice_1#4097, cdepval_orders_o_orderpriority#4074 AS cdepval_orders_o_orderpriority_1#4098, cdepval_orders_o_clerk#4075 AS cdepval_orders_o_clerk_1#4099, cdepval_orders_o_shippriority#4076 AS cdepval_orders_o_shippriority_1#4100, cdepval_orders_o_comment#4077 AS cdepval_orders_o_comment_1#4101, cdepval_orders_o_orderdate#4078 AS cdepval_orders_o_orderdate_1#4102, co_orderstatus#4079 AS co_orderstatus_1#4103, co_totalprice#4080 AS co_totalprice_1#4104, co_orderpriority#4081 AS co_orderpriority_1#4105, co_clerk#4082 AS co_clerk_1#4106, co_shippriority#4083 AS co_shippriority_1#4107, co_comment#4084 AS co_comment_1#4108, co_orderdate#4085 AS co_orderdate_1#4109]
            +- Relation[rid#4062,cpfk_customer_orders#4063,cfpk_orders_customer#4064,cval_orders_o_orderstatus#4065,cval_orders_o_totalprice#4066,cval_orders_o_orderpriority#4067,cval_orders_o_clerk#4068,cval_orders_o_shippriority#4069,cval_orders_o_comment#4070,cval_orders_o_orderdate#4071,cdepval_orders_o_orderstatus#4072,cdepval_orders_o_totalprice#4073,cdepval_orders_o_orderpriority#4074,cdepval_orders_o_clerk#4075,cdepval_orders_o_shippriority#4076,cdepval_orders_o_comment#4077,cdepval_orders_o_orderdate#4078,co_orderstatus#4079,co_totalprice#4080,co_orderpriority#4081,co_clerk#4082,co_shippriority#4083,co_comment#4084,co_orderdate#4085] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 23470ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/26 22:31:40 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:31:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4184L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 22:31:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:31:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:31:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:31:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:31:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:31:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:31:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:31:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:31:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:31:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:31:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:31:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:31:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:31:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4184L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#4211, cval_part_p_name_0#4212, cval_part_p_mfgr_0#4213, cval_part_p_type_0#4214, cval_part_p_size_0#4215, cval_part_p_container_0#4216, cval_part_p_retailprice_0#4217, cval_part_p_comment_0#4218, cval_part_p_brand_0#4219, cdepval_part_p_name_0#4220, cdepval_part_p_mfgr_0#4221, cdepval_part_p_type_0#4222, cdepval_part_p_size_0#4223, cdepval_part_p_container_0#4224, cdepval_part_p_retailprice_0#4225, cdepval_part_p_comment_0#4226, cdepval_part_p_brand_0#4227, cp_name_0#4228, cp_mfgr_0#4229, cp_type_0#4230, cp_size_0#4231, cp_container_0#4232, cp_retailprice_0#4233, cp_comment_0#4234, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  :  +- Project [rid#4186 AS rid_0#4211, cval_part_p_name#4187 AS cval_part_p_name_0#4212, cval_part_p_mfgr#4188 AS cval_part_p_mfgr_0#4213, cval_part_p_type#4189 AS cval_part_p_type_0#4214, cval_part_p_size#4190 AS cval_part_p_size_0#4215, cval_part_p_container#4191 AS cval_part_p_container_0#4216, cval_part_p_retailprice#4192 AS cval_part_p_retailprice_0#4217, cval_part_p_comment#4193 AS cval_part_p_comment_0#4218, cval_part_p_brand#4194 AS cval_part_p_brand_0#4219, cdepval_part_p_name#4195 AS cdepval_part_p_name_0#4220, cdepval_part_p_mfgr#4196 AS cdepval_part_p_mfgr_0#4221, cdepval_part_p_type#4197 AS cdepval_part_p_type_0#4222, cdepval_part_p_size#4198 AS cdepval_part_p_size_0#4223, cdepval_part_p_container#4199 AS cdepval_part_p_container_0#4224, cdepval_part_p_retailprice#4200 AS cdepval_part_p_retailprice_0#4225, cdepval_part_p_comment#4201 AS cdepval_part_p_comment_0#4226, cdepval_part_p_brand#4202 AS cdepval_part_p_brand_0#4227, cp_name#4203 AS cp_name_0#4228, cp_mfgr#4204 AS cp_mfgr_0#4229, cp_type#4205 AS cp_type_0#4230, cp_size#4206 AS cp_size_0#4231, cp_container#4207 AS cp_container_0#4232, cp_retailprice#4208 AS cp_retailprice_0#4233, cp_comment#4209 AS cp_comment_0#4234, cp_brand#4210 AS cp_brand_0#4235]
         :  :  :     +- Relation[rid#4186,cval_part_p_name#4187,cval_part_p_mfgr#4188,cval_part_p_type#4189,cval_part_p_size#4190,cval_part_p_container#4191,cval_part_p_retailprice#4192,cval_part_p_comment#4193,cval_part_p_brand#4194,cdepval_part_p_name#4195,cdepval_part_p_mfgr#4196,cdepval_part_p_type#4197,cdepval_part_p_size#4198,cdepval_part_p_container#4199,cdepval_part_p_retailprice#4200,cdepval_part_p_comment#4201,cdepval_part_p_brand#4202,cp_name#4203,cp_mfgr#4204,cp_type#4205,cp_size#4206,cp_container#4207,cp_retailprice#4208,cp_comment#4209,cp_brand#4210] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :  :     +- Project [rid#4364 AS rid_1#4378, cpfk_part_partsupp#4365 AS cpfk_part_partsupp_1#4379, cfpk_partsupp_part#4366 AS cfpk_partsupp_part_1#4380, cpfk_supplier_partsupp#4367 AS cpfk_supplier_partsupp_1#4381, cfpk_partsupp_supplier#4368 AS cfpk_partsupp_supplier_1#4382, cval_partsupp_ps_availqty#4369 AS cval_partsupp_ps_availqty_1#4383, cval_partsupp_ps_supplycost#4370 AS cval_partsupp_ps_supplycost_1#4384, cval_partsupp_ps_comment#4371 AS cval_partsupp_ps_comment_1#4385, cdepval_partsupp_ps_availqty#4372 AS cdepval_partsupp_ps_availqty_1#4386, cdepval_partsupp_ps_supplycost#4373 AS cdepval_partsupp_ps_supplycost_1#4387, cdepval_partsupp_ps_comment#4374 AS cdepval_partsupp_ps_comment_1#4388, cps_availqty#4375 AS cps_availqty_1#4389, cps_supplycost#4376 AS cps_supplycost_1#4390, cps_comment#4377 AS cps_comment_1#4391]
         :  :        +- Relation[rid#4364,cpfk_part_partsupp#4365,cfpk_partsupp_part#4366,cpfk_supplier_partsupp#4367,cfpk_partsupp_supplier#4368,cval_partsupp_ps_availqty#4369,cval_partsupp_ps_supplycost#4370,cval_partsupp_ps_comment#4371,cdepval_partsupp_ps_availqty#4372,cdepval_partsupp_ps_supplycost#4373,cdepval_partsupp_ps_comment#4374,cps_availqty#4375,cps_supplycost#4376,cps_comment#4377] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#4286 AS rid_1#4300, cpfk_part_partsupp#4287 AS cpfk_part_partsupp_1#4301, cfpk_partsupp_part#4288 AS cfpk_partsupp_part_1#4302, cpfk_supplier_partsupp#4289 AS cpfk_supplier_partsupp_1#4303, cfpk_partsupp_supplier#4290 AS cfpk_partsupp_supplier_1#4304, cval_partsupp_ps_availqty#4291 AS cval_partsupp_ps_availqty_1#4305, cval_partsupp_ps_supplycost#4292 AS cval_partsupp_ps_supplycost_1#4306, cval_partsupp_ps_comment#4293 AS cval_partsupp_ps_comment_1#4307, cdepval_partsupp_ps_availqty#4294 AS cdepval_partsupp_ps_availqty_1#4308, cdepval_partsupp_ps_supplycost#4295 AS cdepval_partsupp_ps_supplycost_1#4309, cdepval_partsupp_ps_comment#4296 AS cdepval_partsupp_ps_comment_1#4310, cps_availqty#4297 AS cps_availqty_1#4311, cps_supplycost#4298 AS cps_supplycost_1#4312, cps_comment#4299 AS cps_comment_1#4313]
         :     +- Relation[rid#4286,cpfk_part_partsupp#4287,cfpk_partsupp_part#4288,cpfk_supplier_partsupp#4289,cfpk_partsupp_supplier#4290,cval_partsupp_ps_availqty#4291,cval_partsupp_ps_supplycost#4292,cval_partsupp_ps_comment#4293,cdepval_partsupp_ps_availqty#4294,cdepval_partsupp_ps_supplycost#4295,cdepval_partsupp_ps_comment#4296,cps_availqty#4297,cps_supplycost#4298,cps_comment#4299] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_2, NotMaterialized, NotMaterialized, [rid_2#4401, cpfk_region_nation_2#4402, cfpk_nation_region_2#4403, cval_nation_n_name_2#4404, cval_nation_n_comment_2#4405, cdepval_nation_n_name_2#4406, cdepval_nation_n_comment_2#4407, cn_name_2#4408, cn_comment_2#4409, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
            :  :  +- Project [rid#4392 AS rid_2#4401, cpfk_region_nation#4393 AS cpfk_region_nation_2#4402, cfpk_nation_region#4394 AS cfpk_nation_region_2#4403, cval_nation_n_name#4395 AS cval_nation_n_name_2#4404, cval_nation_n_comment#4396 AS cval_nation_n_comment_2#4405, cdepval_nation_n_name#4397 AS cdepval_nation_n_name_2#4406, cdepval_nation_n_comment#4398 AS cdepval_nation_n_comment_2#4407, cn_name#4399 AS cn_name_2#4408, cn_comment#4400 AS cn_comment_2#4409]
            :  :     +- Relation[rid#4392,cpfk_region_nation#4393,cfpk_nation_region#4394,cval_nation_n_name#4395,cval_nation_n_comment#4396,cdepval_nation_n_name#4397,cdepval_nation_n_comment#4398,cn_name#4399,cn_comment#4400] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#4482 AS rid_3#4500, cpfk_nation_supplier#4483 AS cpfk_nation_supplier_3#4501, cfpk_supplier_nation#4484 AS cfpk_supplier_nation_3#4502, cval_supplier_s_name#4485 AS cval_supplier_s_name_3#4503, cval_supplier_s_address#4486 AS cval_supplier_s_address_3#4504, cval_supplier_s_phone#4487 AS cval_supplier_s_phone_3#4505, cval_supplier_s_acctbal#4488 AS cval_supplier_s_acctbal_3#4506, cval_supplier_s_comment#4489 AS cval_supplier_s_comment_3#4507, cdepval_supplier_s_name#4490 AS cdepval_supplier_s_name_3#4508, cdepval_supplier_s_address#4491 AS cdepval_supplier_s_address_3#4509, cdepval_supplier_s_phone#4492 AS cdepval_supplier_s_phone_3#4510, cdepval_supplier_s_acctbal#4493 AS cdepval_supplier_s_acctbal_3#4511, cdepval_supplier_s_comment#4494 AS cdepval_supplier_s_comment_3#4512, cs_name#4495 AS cs_name_3#4513, cs_address#4496 AS cs_address_3#4514, cs_phone#4497 AS cs_phone_3#4515, cs_acctbal#4498 AS cs_acctbal_3#4516, cs_comment#4499 AS cs_comment_3#4517]
            :        +- Relation[rid#4482,cpfk_nation_supplier#4483,cfpk_supplier_nation#4484,cval_supplier_s_name#4485,cval_supplier_s_address#4486,cval_supplier_s_phone#4487,cval_supplier_s_acctbal#4488,cval_supplier_s_comment#4489,cdepval_supplier_s_name#4490,cdepval_supplier_s_address#4491,cdepval_supplier_s_phone#4492,cdepval_supplier_s_acctbal#4493,cdepval_supplier_s_comment#4494,cs_name#4495,cs_address#4496,cs_phone#4497,cs_acctbal#4498,cs_comment#4499] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#4428 AS rid_3#4446, cpfk_nation_supplier#4429 AS cpfk_nation_supplier_3#4447, cfpk_supplier_nation#4430 AS cfpk_supplier_nation_3#4448, cval_supplier_s_name#4431 AS cval_supplier_s_name_3#4449, cval_supplier_s_address#4432 AS cval_supplier_s_address_3#4450, cval_supplier_s_phone#4433 AS cval_supplier_s_phone_3#4451, cval_supplier_s_acctbal#4434 AS cval_supplier_s_acctbal_3#4452, cval_supplier_s_comment#4435 AS cval_supplier_s_comment_3#4453, cdepval_supplier_s_name#4436 AS cdepval_supplier_s_name_3#4454, cdepval_supplier_s_address#4437 AS cdepval_supplier_s_address_3#4455, cdepval_supplier_s_phone#4438 AS cdepval_supplier_s_phone_3#4456, cdepval_supplier_s_acctbal#4439 AS cdepval_supplier_s_acctbal_3#4457, cdepval_supplier_s_comment#4440 AS cdepval_supplier_s_comment_3#4458, cs_name#4441 AS cs_name_3#4459, cs_address#4442 AS cs_address_3#4460, cs_phone#4443 AS cs_phone_3#4461, cs_acctbal#4444 AS cs_acctbal_3#4462, cs_comment#4445 AS cs_comment_3#4463]
               +- Relation[rid#4428,cpfk_nation_supplier#4429,cfpk_supplier_nation#4430,cval_supplier_s_name#4431,cval_supplier_s_address#4432,cval_supplier_s_phone#4433,cval_supplier_s_acctbal#4434,cval_supplier_s_comment#4435,cdepval_supplier_s_name#4436,cdepval_supplier_s_address#4437,cdepval_supplier_s_phone#4438,cdepval_supplier_s_acctbal#4439,cdepval_supplier_s_comment#4440,cs_name#4441,cs_address#4442,cs_phone#4443,cs_acctbal#4444,cs_comment#4445] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 1652ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/26 22:31:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:31:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4591L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:31:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:31:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:31:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4591L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#4629 AS rid_1#4674, cpfk_orders_lineitem#4630 AS cpfk_orders_lineitem_1#4675, cpfk_supplier_lineitem#4631 AS cpfk_supplier_lineitem_1#4676, cfpk_lineitem_supplier#4632 AS cfpk_lineitem_supplier_1#4677, cfpk_lineitem_partsupp#4633 AS cfpk_lineitem_partsupp_1#4678, cpfk_part_lineitem#4634 AS cpfk_part_lineitem_1#4679, cfpk_lineitem_part#4635 AS cfpk_lineitem_part_1#4680, cpfk_partsupp_lineitem#4636 AS cpfk_partsupp_lineitem_1#4681, cfpk_lineitem_orders#4637 AS cfpk_lineitem_orders_1#4682, cval_lineitem_l_quantity#4638 AS cval_lineitem_l_quantity_1#4683, cval_lineitem_l_extendedprice#4639 AS cval_lineitem_l_extendedprice_1#4684, cval_lineitem_l_discount#4640 AS cval_lineitem_l_discount_1#4685, cval_lineitem_l_tax#4641 AS cval_lineitem_l_tax_1#4686, cval_lineitem_l_returnflag#4642 AS cval_lineitem_l_returnflag_1#4687, cval_lineitem_l_linestatus#4643 AS cval_lineitem_l_linestatus_1#4688, cval_lineitem_l_commitdate#4644 AS cval_lineitem_l_commitdate_1#4689, cval_lineitem_l_receiptdate#4645 AS cval_lineitem_l_receiptdate_1#4690, cval_lineitem_l_shipinstruct#4646 AS cval_lineitem_l_shipinstruct_1#4691, cval_lineitem_l_shipmode#4647 AS cval_lineitem_l_shipmode_1#4692, cval_lineitem_l_comment#4648 AS cval_lineitem_l_comment_1#4693, cval_lineitem_l_shipdate#4649 AS cval_lineitem_l_shipdate_1#4694, cdepval_lineitem_l_quantity#4650 AS cdepval_lineitem_l_quantity_1#4695, cdepval_lineitem_l_extendedprice#4651 AS cdepval_lineitem_l_extendedprice_1#4696, cdepval_lineitem_l_discount#4652 AS cdepval_lineitem_l_discount_1#4697, ... 21 more fields]
         :  +- Relation[rid#4629,cpfk_orders_lineitem#4630,cpfk_supplier_lineitem#4631,cfpk_lineitem_supplier#4632,cfpk_lineitem_partsupp#4633,cpfk_part_lineitem#4634,cfpk_lineitem_part#4635,cpfk_partsupp_lineitem#4636,cfpk_lineitem_orders#4637,cval_lineitem_l_quantity#4638,cval_lineitem_l_extendedprice#4639,cval_lineitem_l_discount#4640,cval_lineitem_l_tax#4641,cval_lineitem_l_returnflag#4642,cval_lineitem_l_linestatus#4643,cval_lineitem_l_commitdate#4644,cval_lineitem_l_receiptdate#4645,cval_lineitem_l_shipinstruct#4646,cval_lineitem_l_shipmode#4647,cval_lineitem_l_comment#4648,cval_lineitem_l_shipdate#4649,cdepval_lineitem_l_quantity#4650,cdepval_lineitem_l_extendedprice#4651,cdepval_lineitem_l_discount#4652,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4593 AS rid_0#4611, cpfk_nation_supplier#4594 AS cpfk_nation_supplier_0#4612, cfpk_supplier_nation#4595 AS cfpk_supplier_nation_0#4613, cval_supplier_s_name#4596 AS cval_supplier_s_name_0#4614, cval_supplier_s_address#4597 AS cval_supplier_s_address_0#4615, cval_supplier_s_phone#4598 AS cval_supplier_s_phone_0#4616, cval_supplier_s_acctbal#4599 AS cval_supplier_s_acctbal_0#4617, cval_supplier_s_comment#4600 AS cval_supplier_s_comment_0#4618, cdepval_supplier_s_name#4601 AS cdepval_supplier_s_name_0#4619, cdepval_supplier_s_address#4602 AS cdepval_supplier_s_address_0#4620, cdepval_supplier_s_phone#4603 AS cdepval_supplier_s_phone_0#4621, cdepval_supplier_s_acctbal#4604 AS cdepval_supplier_s_acctbal_0#4622, cdepval_supplier_s_comment#4605 AS cdepval_supplier_s_comment_0#4623, cs_name#4606 AS cs_name_0#4624, cs_address#4607 AS cs_address_0#4625, cs_phone#4608 AS cs_phone_0#4626, cs_acctbal#4609 AS cs_acctbal_0#4627, cs_comment#4610 AS cs_comment_0#4628]
            +- Relation[rid#4593,cpfk_nation_supplier#4594,cfpk_supplier_nation#4595,cval_supplier_s_name#4596,cval_supplier_s_address#4597,cval_supplier_s_phone#4598,cval_supplier_s_acctbal#4599,cval_supplier_s_comment#4600,cdepval_supplier_s_name#4601,cdepval_supplier_s_address#4602,cdepval_supplier_s_phone#4603,cdepval_supplier_s_acctbal#4604,cdepval_supplier_s_comment#4605,cs_name#4606,cs_address#4607,cs_phone#4608,cs_acctbal#4609,cs_comment#4610] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18646ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/26 22:32:01 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:32:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4791L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:32:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4791L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#4883 AS rid_2#4928, cpfk_orders_lineitem#4884 AS cpfk_orders_lineitem_2#4929, cpfk_supplier_lineitem#4885 AS cpfk_supplier_lineitem_2#4930, cfpk_lineitem_supplier#4886 AS cfpk_lineitem_supplier_2#4931, cfpk_lineitem_partsupp#4887 AS cfpk_lineitem_partsupp_2#4932, cpfk_part_lineitem#4888 AS cpfk_part_lineitem_2#4933, cfpk_lineitem_part#4889 AS cfpk_lineitem_part_2#4934, cpfk_partsupp_lineitem#4890 AS cpfk_partsupp_lineitem_2#4935, cfpk_lineitem_orders#4891 AS cfpk_lineitem_orders_2#4936, cval_lineitem_l_quantity#4892 AS cval_lineitem_l_quantity_2#4937, cval_lineitem_l_extendedprice#4893 AS cval_lineitem_l_extendedprice_2#4938, cval_lineitem_l_discount#4894 AS cval_lineitem_l_discount_2#4939, cval_lineitem_l_tax#4895 AS cval_lineitem_l_tax_2#4940, cval_lineitem_l_returnflag#4896 AS cval_lineitem_l_returnflag_2#4941, cval_lineitem_l_linestatus#4897 AS cval_lineitem_l_linestatus_2#4942, cval_lineitem_l_commitdate#4898 AS cval_lineitem_l_commitdate_2#4943, cval_lineitem_l_receiptdate#4899 AS cval_lineitem_l_receiptdate_2#4944, cval_lineitem_l_shipinstruct#4900 AS cval_lineitem_l_shipinstruct_2#4945, cval_lineitem_l_shipmode#4901 AS cval_lineitem_l_shipmode_2#4946, cval_lineitem_l_comment#4902 AS cval_lineitem_l_comment_2#4947, cval_lineitem_l_shipdate#4903 AS cval_lineitem_l_shipdate_2#4948, cdepval_lineitem_l_quantity#4904 AS cdepval_lineitem_l_quantity_2#4949, cdepval_lineitem_l_extendedprice#4905 AS cdepval_lineitem_l_extendedprice_2#4950, cdepval_lineitem_l_discount#4906 AS cdepval_lineitem_l_discount_2#4951, ... 21 more fields]
         :  +- Relation[rid#4883,cpfk_orders_lineitem#4884,cpfk_supplier_lineitem#4885,cfpk_lineitem_supplier#4886,cfpk_lineitem_partsupp#4887,cpfk_part_lineitem#4888,cfpk_lineitem_part#4889,cpfk_partsupp_lineitem#4890,cfpk_lineitem_orders#4891,cval_lineitem_l_quantity#4892,cval_lineitem_l_extendedprice#4893,cval_lineitem_l_discount#4894,cval_lineitem_l_tax#4895,cval_lineitem_l_returnflag#4896,cval_lineitem_l_linestatus#4897,cval_lineitem_l_commitdate#4898,cval_lineitem_l_receiptdate#4899,cval_lineitem_l_shipinstruct#4900,cval_lineitem_l_shipmode#4901,cval_lineitem_l_comment#4902,cval_lineitem_l_shipdate#4903,cdepval_lineitem_l_quantity#4904,cdepval_lineitem_l_extendedprice#4905,cdepval_lineitem_l_discount#4906,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#4835 AS rid_1#4859, cpfk_customer_orders#4836 AS cpfk_customer_orders_1#4860, cfpk_orders_customer#4837 AS cfpk_orders_customer_1#4861, cval_orders_o_orderstatus#4838 AS cval_orders_o_orderstatus_1#4862, cval_orders_o_totalprice#4839 AS cval_orders_o_totalprice_1#4863, cval_orders_o_orderpriority#4840 AS cval_orders_o_orderpriority_1#4864, cval_orders_o_clerk#4841 AS cval_orders_o_clerk_1#4865, cval_orders_o_shippriority#4842 AS cval_orders_o_shippriority_1#4866, cval_orders_o_comment#4843 AS cval_orders_o_comment_1#4867, cval_orders_o_orderdate#4844 AS cval_orders_o_orderdate_1#4868, cdepval_orders_o_orderstatus#4845 AS cdepval_orders_o_orderstatus_1#4869, cdepval_orders_o_totalprice#4846 AS cdepval_orders_o_totalprice_1#4870, cdepval_orders_o_orderpriority#4847 AS cdepval_orders_o_orderpriority_1#4871, cdepval_orders_o_clerk#4848 AS cdepval_orders_o_clerk_1#4872, cdepval_orders_o_shippriority#4849 AS cdepval_orders_o_shippriority_1#4873, cdepval_orders_o_comment#4850 AS cdepval_orders_o_comment_1#4874, cdepval_orders_o_orderdate#4851 AS cdepval_orders_o_orderdate_1#4875, co_orderstatus#4852 AS co_orderstatus_1#4876, co_totalprice#4853 AS co_totalprice_1#4877, co_orderpriority#4854 AS co_orderpriority_1#4878, co_clerk#4855 AS co_clerk_1#4879, co_shippriority#4856 AS co_shippriority_1#4880, co_comment#4857 AS co_comment_1#4881, co_orderdate#4858 AS co_orderdate_1#4882]
            :  +- Relation[rid#4835,cpfk_customer_orders#4836,cfpk_orders_customer#4837,cval_orders_o_orderstatus#4838,cval_orders_o_totalprice#4839,cval_orders_o_orderpriority#4840,cval_orders_o_clerk#4841,cval_orders_o_shippriority#4842,cval_orders_o_comment#4843,cval_orders_o_orderdate#4844,cdepval_orders_o_orderstatus#4845,cdepval_orders_o_totalprice#4846,cdepval_orders_o_orderpriority#4847,cdepval_orders_o_clerk#4848,cdepval_orders_o_shippriority#4849,cdepval_orders_o_comment#4850,cdepval_orders_o_orderdate#4851,co_orderstatus#4852,co_totalprice#4853,co_orderpriority#4854,co_clerk#4855,co_shippriority#4856,co_comment#4857,co_orderdate#4858] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#4793 AS rid_0#4814, cpfk_nation_customer#4794 AS cpfk_nation_customer_0#4815, cfpk_customer_nation#4795 AS cfpk_customer_nation_0#4816, cval_customer_c_name#4796 AS cval_customer_c_name_0#4817, cval_customer_c_address#4797 AS cval_customer_c_address_0#4818, cval_customer_c_phone#4798 AS cval_customer_c_phone_0#4819, cval_customer_c_acctbal#4799 AS cval_customer_c_acctbal_0#4820, cval_customer_c_comment#4800 AS cval_customer_c_comment_0#4821, cval_customer_c_mktsegment#4801 AS cval_customer_c_mktsegment_0#4822, cdepval_customer_c_name#4802 AS cdepval_customer_c_name_0#4823, cdepval_customer_c_address#4803 AS cdepval_customer_c_address_0#4824, cdepval_customer_c_phone#4804 AS cdepval_customer_c_phone_0#4825, cdepval_customer_c_acctbal#4805 AS cdepval_customer_c_acctbal_0#4826, cdepval_customer_c_comment#4806 AS cdepval_customer_c_comment_0#4827, cdepval_customer_c_mktsegment#4807 AS cdepval_customer_c_mktsegment_0#4828, cc_name#4808 AS cc_name_0#4829, cc_address#4809 AS cc_address_0#4830, cc_phone#4810 AS cc_phone_0#4831, cc_acctbal#4811 AS cc_acctbal_0#4832, cc_comment#4812 AS cc_comment_0#4833, cc_mktsegment#4813 AS cc_mktsegment_0#4834]
               +- Relation[rid#4793,cpfk_nation_customer#4794,cfpk_customer_nation#4795,cval_customer_c_name#4796,cval_customer_c_address#4797,cval_customer_c_phone#4798,cval_customer_c_acctbal#4799,cval_customer_c_comment#4800,cval_customer_c_mktsegment#4801,cdepval_customer_c_name#4802,cdepval_customer_c_address#4803,cdepval_customer_c_phone#4804,cdepval_customer_c_acctbal#4805,cdepval_customer_c_comment#4806,cdepval_customer_c_mktsegment#4807,cc_name#4808,cc_address#4809,cc_phone#4810,cc_acctbal#4811,cc_comment#4812,cc_mktsegment#4813] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 24145ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/26 22:32:25 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:32:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5070L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 22:32:25 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:32:25 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:32:25 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:32:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5070L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#5097, cval_part_p_name_0#5098, cval_part_p_mfgr_0#5099, cval_part_p_type_0#5100, cval_part_p_size_0#5101, cval_part_p_container_0#5102, cval_part_p_retailprice_0#5103, cval_part_p_comment_0#5104, cval_part_p_brand_0#5105, cdepval_part_p_name_0#5106, cdepval_part_p_mfgr_0#5107, cdepval_part_p_type_0#5108, cdepval_part_p_size_0#5109, cdepval_part_p_container_0#5110, cdepval_part_p_retailprice_0#5111, cdepval_part_p_comment_0#5112, cdepval_part_p_brand_0#5113, cp_name_0#5114, cp_mfgr_0#5115, cp_type_0#5116, cp_size_0#5117, cp_container_0#5118, cp_retailprice_0#5119, cp_comment_0#5120, ... 2 more fields]
         :  :- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  +- Project [rid#5072 AS rid_0#5097, cval_part_p_name#5073 AS cval_part_p_name_0#5098, cval_part_p_mfgr#5074 AS cval_part_p_mfgr_0#5099, cval_part_p_type#5075 AS cval_part_p_type_0#5100, cval_part_p_size#5076 AS cval_part_p_size_0#5101, cval_part_p_container#5077 AS cval_part_p_container_0#5102, cval_part_p_retailprice#5078 AS cval_part_p_retailprice_0#5103, cval_part_p_comment#5079 AS cval_part_p_comment_0#5104, cval_part_p_brand#5080 AS cval_part_p_brand_0#5105, cdepval_part_p_name#5081 AS cdepval_part_p_name_0#5106, cdepval_part_p_mfgr#5082 AS cdepval_part_p_mfgr_0#5107, cdepval_part_p_type#5083 AS cdepval_part_p_type_0#5108, cdepval_part_p_size#5084 AS cdepval_part_p_size_0#5109, cdepval_part_p_container#5085 AS cdepval_part_p_container_0#5110, cdepval_part_p_retailprice#5086 AS cdepval_part_p_retailprice_0#5111, cdepval_part_p_comment#5087 AS cdepval_part_p_comment_0#5112, cdepval_part_p_brand#5088 AS cdepval_part_p_brand_0#5113, cp_name#5089 AS cp_name_0#5114, cp_mfgr#5090 AS cp_mfgr_0#5115, cp_type#5091 AS cp_type_0#5116, cp_size#5092 AS cp_size_0#5117, cp_container#5093 AS cp_container_0#5118, cp_retailprice#5094 AS cp_retailprice_0#5119, cp_comment#5095 AS cp_comment_0#5120, cp_brand#5096 AS cp_brand_0#5121]
         :  :     +- Relation[rid#5072,cval_part_p_name#5073,cval_part_p_mfgr#5074,cval_part_p_type#5075,cval_part_p_size#5076,cval_part_p_container#5077,cval_part_p_retailprice#5078,cval_part_p_comment#5079,cval_part_p_brand#5080,cdepval_part_p_name#5081,cdepval_part_p_mfgr#5082,cdepval_part_p_type#5083,cdepval_part_p_size#5084,cdepval_part_p_container#5085,cdepval_part_p_retailprice#5086,cdepval_part_p_comment#5087,cdepval_part_p_brand#5088,cp_name#5089,cp_mfgr#5090,cp_type#5091,cp_size#5092,cp_container#5093,cp_retailprice#5094,cp_comment#5095,cp_brand#5096] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :     +- Project [rid#5250 AS rid_1#5264, cpfk_part_partsupp#5251 AS cpfk_part_partsupp_1#5265, cfpk_partsupp_part#5252 AS cfpk_partsupp_part_1#5266, cpfk_supplier_partsupp#5253 AS cpfk_supplier_partsupp_1#5267, cfpk_partsupp_supplier#5254 AS cfpk_partsupp_supplier_1#5268, cval_partsupp_ps_availqty#5255 AS cval_partsupp_ps_availqty_1#5269, cval_partsupp_ps_supplycost#5256 AS cval_partsupp_ps_supplycost_1#5270, cval_partsupp_ps_comment#5257 AS cval_partsupp_ps_comment_1#5271, cdepval_partsupp_ps_availqty#5258 AS cdepval_partsupp_ps_availqty_1#5272, cdepval_partsupp_ps_supplycost#5259 AS cdepval_partsupp_ps_supplycost_1#5273, cdepval_partsupp_ps_comment#5260 AS cdepval_partsupp_ps_comment_1#5274, cps_availqty#5261 AS cps_availqty_1#5275, cps_supplycost#5262 AS cps_supplycost_1#5276, cps_comment#5263 AS cps_comment_1#5277]
         :        +- Relation[rid#5250,cpfk_part_partsupp#5251,cfpk_partsupp_part#5252,cpfk_supplier_partsupp#5253,cfpk_partsupp_supplier#5254,cval_partsupp_ps_availqty#5255,cval_partsupp_ps_supplycost#5256,cval_partsupp_ps_comment#5257,cdepval_partsupp_ps_availqty#5258,cdepval_partsupp_ps_supplycost#5259,cdepval_partsupp_ps_comment#5260,cps_availqty#5261,cps_supplycost#5262,cps_comment#5263] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#5172 AS rid_1#5186, cpfk_part_partsupp#5173 AS cpfk_part_partsupp_1#5187, cfpk_partsupp_part#5174 AS cfpk_partsupp_part_1#5188, cpfk_supplier_partsupp#5175 AS cpfk_supplier_partsupp_1#5189, cfpk_partsupp_supplier#5176 AS cfpk_partsupp_supplier_1#5190, cval_partsupp_ps_availqty#5177 AS cval_partsupp_ps_availqty_1#5191, cval_partsupp_ps_supplycost#5178 AS cval_partsupp_ps_supplycost_1#5192, cval_partsupp_ps_comment#5179 AS cval_partsupp_ps_comment_1#5193, cdepval_partsupp_ps_availqty#5180 AS cdepval_partsupp_ps_availqty_1#5194, cdepval_partsupp_ps_supplycost#5181 AS cdepval_partsupp_ps_supplycost_1#5195, cdepval_partsupp_ps_comment#5182 AS cdepval_partsupp_ps_comment_1#5196, cps_availqty#5183 AS cps_availqty_1#5197, cps_supplycost#5184 AS cps_supplycost_1#5198, cps_comment#5185 AS cps_comment_1#5199]
            +- Relation[rid#5172,cpfk_part_partsupp#5173,cfpk_partsupp_part#5174,cpfk_supplier_partsupp#5175,cfpk_partsupp_supplier#5176,cval_partsupp_ps_availqty#5177,cval_partsupp_ps_supplycost#5178,cval_partsupp_ps_comment#5179,cdepval_partsupp_ps_availqty#5180,cdepval_partsupp_ps_supplycost#5181,cdepval_partsupp_ps_comment#5182,cps_availqty#5183,cps_supplycost#5184,cps_comment#5185] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 1046ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/26 22:32:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:32:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5321L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:32:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5321L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#5323 AS rid_0#5368, cpfk_orders_lineitem#5324 AS cpfk_orders_lineitem_0#5369, cpfk_supplier_lineitem#5325 AS cpfk_supplier_lineitem_0#5370, cfpk_lineitem_supplier#5326 AS cfpk_lineitem_supplier_0#5371, cfpk_lineitem_partsupp#5327 AS cfpk_lineitem_partsupp_0#5372, cpfk_part_lineitem#5328 AS cpfk_part_lineitem_0#5373, cfpk_lineitem_part#5329 AS cfpk_lineitem_part_0#5374, cpfk_partsupp_lineitem#5330 AS cpfk_partsupp_lineitem_0#5375, cfpk_lineitem_orders#5331 AS cfpk_lineitem_orders_0#5376, cval_lineitem_l_quantity#5332 AS cval_lineitem_l_quantity_0#5377, cval_lineitem_l_extendedprice#5333 AS cval_lineitem_l_extendedprice_0#5378, cval_lineitem_l_discount#5334 AS cval_lineitem_l_discount_0#5379, cval_lineitem_l_tax#5335 AS cval_lineitem_l_tax_0#5380, cval_lineitem_l_returnflag#5336 AS cval_lineitem_l_returnflag_0#5381, cval_lineitem_l_linestatus#5337 AS cval_lineitem_l_linestatus_0#5382, cval_lineitem_l_commitdate#5338 AS cval_lineitem_l_commitdate_0#5383, cval_lineitem_l_receiptdate#5339 AS cval_lineitem_l_receiptdate_0#5384, cval_lineitem_l_shipinstruct#5340 AS cval_lineitem_l_shipinstruct_0#5385, cval_lineitem_l_shipmode#5341 AS cval_lineitem_l_shipmode_0#5386, cval_lineitem_l_comment#5342 AS cval_lineitem_l_comment_0#5387, cval_lineitem_l_shipdate#5343 AS cval_lineitem_l_shipdate_0#5388, cdepval_lineitem_l_quantity#5344 AS cdepval_lineitem_l_quantity_0#5389, cdepval_lineitem_l_extendedprice#5345 AS cdepval_lineitem_l_extendedprice_0#5390, cdepval_lineitem_l_discount#5346 AS cdepval_lineitem_l_discount_0#5391, ... 21 more fields]
         :     +- Relation[rid#5323,cpfk_orders_lineitem#5324,cpfk_supplier_lineitem#5325,cfpk_lineitem_supplier#5326,cfpk_lineitem_partsupp#5327,cpfk_part_lineitem#5328,cfpk_lineitem_part#5329,cpfk_partsupp_lineitem#5330,cfpk_lineitem_orders#5331,cval_lineitem_l_quantity#5332,cval_lineitem_l_extendedprice#5333,cval_lineitem_l_discount#5334,cval_lineitem_l_tax#5335,cval_lineitem_l_returnflag#5336,cval_lineitem_l_linestatus#5337,cval_lineitem_l_commitdate#5338,cval_lineitem_l_receiptdate#5339,cval_lineitem_l_shipinstruct#5340,cval_lineitem_l_shipmode#5341,cval_lineitem_l_comment#5342,cval_lineitem_l_shipdate#5343,cdepval_lineitem_l_quantity#5344,cdepval_lineitem_l_extendedprice#5345,cdepval_lineitem_l_discount#5346,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5503 AS rid_1#5527, cpfk_customer_orders#5504 AS cpfk_customer_orders_1#5528, cfpk_orders_customer#5505 AS cfpk_orders_customer_1#5529, cval_orders_o_orderstatus#5506 AS cval_orders_o_orderstatus_1#5530, cval_orders_o_totalprice#5507 AS cval_orders_o_totalprice_1#5531, cval_orders_o_orderpriority#5508 AS cval_orders_o_orderpriority_1#5532, cval_orders_o_clerk#5509 AS cval_orders_o_clerk_1#5533, cval_orders_o_shippriority#5510 AS cval_orders_o_shippriority_1#5534, cval_orders_o_comment#5511 AS cval_orders_o_comment_1#5535, cval_orders_o_orderdate#5512 AS cval_orders_o_orderdate_1#5536, cdepval_orders_o_orderstatus#5513 AS cdepval_orders_o_orderstatus_1#5537, cdepval_orders_o_totalprice#5514 AS cdepval_orders_o_totalprice_1#5538, cdepval_orders_o_orderpriority#5515 AS cdepval_orders_o_orderpriority_1#5539, cdepval_orders_o_clerk#5516 AS cdepval_orders_o_clerk_1#5540, cdepval_orders_o_shippriority#5517 AS cdepval_orders_o_shippriority_1#5541, cdepval_orders_o_comment#5518 AS cdepval_orders_o_comment_1#5542, cdepval_orders_o_orderdate#5519 AS cdepval_orders_o_orderdate_1#5543, co_orderstatus#5520 AS co_orderstatus_1#5544, co_totalprice#5521 AS co_totalprice_1#5545, co_orderpriority#5522 AS co_orderpriority_1#5546, co_clerk#5523 AS co_clerk_1#5547, co_shippriority#5524 AS co_shippriority_1#5548, co_comment#5525 AS co_comment_1#5549, co_orderdate#5526 AS co_orderdate_1#5550]
            +- Relation[rid#5503,cpfk_customer_orders#5504,cfpk_orders_customer#5505,cval_orders_o_orderstatus#5506,cval_orders_o_totalprice#5507,cval_orders_o_orderpriority#5508,cval_orders_o_clerk#5509,cval_orders_o_shippriority#5510,cval_orders_o_comment#5511,cval_orders_o_orderdate#5512,cdepval_orders_o_orderstatus#5513,cdepval_orders_o_totalprice#5514,cdepval_orders_o_orderpriority#5515,cdepval_orders_o_clerk#5516,cdepval_orders_o_shippriority#5517,cdepval_orders_o_comment#5518,cdepval_orders_o_orderdate#5519,co_orderstatus#5520,co_totalprice#5521,co_orderpriority#5522,co_clerk#5523,co_shippriority#5524,co_comment#5525,co_orderdate#5526] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 35693ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/26 22:33:01 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:33:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5626L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 22:33:01 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:33:01 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:33:01 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:33:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:33:01 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:33:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:33:01 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:33:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:33:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:33:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:33:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:33:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:33:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:33:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5626L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#5796 AS rid_4#5841, cpfk_orders_lineitem#5797 AS cpfk_orders_lineitem_4#5842, cpfk_supplier_lineitem#5798 AS cpfk_supplier_lineitem_4#5843, cfpk_lineitem_supplier#5799 AS cfpk_lineitem_supplier_4#5844, cfpk_lineitem_partsupp#5800 AS cfpk_lineitem_partsupp_4#5845, cpfk_part_lineitem#5801 AS cpfk_part_lineitem_4#5846, cfpk_lineitem_part#5802 AS cfpk_lineitem_part_4#5847, cpfk_partsupp_lineitem#5803 AS cpfk_partsupp_lineitem_4#5848, cfpk_lineitem_orders#5804 AS cfpk_lineitem_orders_4#5849, cval_lineitem_l_quantity#5805 AS cval_lineitem_l_quantity_4#5850, cval_lineitem_l_extendedprice#5806 AS cval_lineitem_l_extendedprice_4#5851, cval_lineitem_l_discount#5807 AS cval_lineitem_l_discount_4#5852, cval_lineitem_l_tax#5808 AS cval_lineitem_l_tax_4#5853, cval_lineitem_l_returnflag#5809 AS cval_lineitem_l_returnflag_4#5854, cval_lineitem_l_linestatus#5810 AS cval_lineitem_l_linestatus_4#5855, cval_lineitem_l_commitdate#5811 AS cval_lineitem_l_commitdate_4#5856, cval_lineitem_l_receiptdate#5812 AS cval_lineitem_l_receiptdate_4#5857, cval_lineitem_l_shipinstruct#5813 AS cval_lineitem_l_shipinstruct_4#5858, cval_lineitem_l_shipmode#5814 AS cval_lineitem_l_shipmode_4#5859, cval_lineitem_l_comment#5815 AS cval_lineitem_l_comment_4#5860, cval_lineitem_l_shipdate#5816 AS cval_lineitem_l_shipdate_4#5861, cdepval_lineitem_l_quantity#5817 AS cdepval_lineitem_l_quantity_4#5862, cdepval_lineitem_l_extendedprice#5818 AS cdepval_lineitem_l_extendedprice_4#5863, cdepval_lineitem_l_discount#5819 AS cdepval_lineitem_l_discount_4#5864, ... 21 more fields]
            :  :  +- Relation[rid#5796,cpfk_orders_lineitem#5797,cpfk_supplier_lineitem#5798,cfpk_lineitem_supplier#5799,cfpk_lineitem_partsupp#5800,cpfk_part_lineitem#5801,cfpk_lineitem_part#5802,cpfk_partsupp_lineitem#5803,cfpk_lineitem_orders#5804,cval_lineitem_l_quantity#5805,cval_lineitem_l_extendedprice#5806,cval_lineitem_l_discount#5807,cval_lineitem_l_tax#5808,cval_lineitem_l_returnflag#5809,cval_lineitem_l_linestatus#5810,cval_lineitem_l_commitdate#5811,cval_lineitem_l_receiptdate#5812,cval_lineitem_l_shipinstruct#5813,cval_lineitem_l_shipmode#5814,cval_lineitem_l_comment#5815,cval_lineitem_l_shipdate#5816,cdepval_lineitem_l_quantity#5817,cdepval_lineitem_l_extendedprice#5818,cdepval_lineitem_l_discount#5819,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#5748 AS rid_3#5772, cpfk_customer_orders#5749 AS cpfk_customer_orders_3#5773, cfpk_orders_customer#5750 AS cfpk_orders_customer_3#5774, cval_orders_o_orderstatus#5751 AS cval_orders_o_orderstatus_3#5775, cval_orders_o_totalprice#5752 AS cval_orders_o_totalprice_3#5776, cval_orders_o_orderpriority#5753 AS cval_orders_o_orderpriority_3#5777, cval_orders_o_clerk#5754 AS cval_orders_o_clerk_3#5778, cval_orders_o_shippriority#5755 AS cval_orders_o_shippriority_3#5779, cval_orders_o_comment#5756 AS cval_orders_o_comment_3#5780, cval_orders_o_orderdate#5757 AS cval_orders_o_orderdate_3#5781, cdepval_orders_o_orderstatus#5758 AS cdepval_orders_o_orderstatus_3#5782, cdepval_orders_o_totalprice#5759 AS cdepval_orders_o_totalprice_3#5783, cdepval_orders_o_orderpriority#5760 AS cdepval_orders_o_orderpriority_3#5784, cdepval_orders_o_clerk#5761 AS cdepval_orders_o_clerk_3#5785, cdepval_orders_o_shippriority#5762 AS cdepval_orders_o_shippriority_3#5786, cdepval_orders_o_comment#5763 AS cdepval_orders_o_comment_3#5787, cdepval_orders_o_orderdate#5764 AS cdepval_orders_o_orderdate_3#5788, co_orderstatus#5765 AS co_orderstatus_3#5789, co_totalprice#5766 AS co_totalprice_3#5790, co_orderpriority#5767 AS co_orderpriority_3#5791, co_clerk#5768 AS co_clerk_3#5792, co_shippriority#5769 AS co_shippriority_3#5793, co_comment#5770 AS co_comment_3#5794, co_orderdate#5771 AS co_orderdate_3#5795]
            :     :  +- Relation[rid#5748,cpfk_customer_orders#5749,cfpk_orders_customer#5750,cval_orders_o_orderstatus#5751,cval_orders_o_totalprice#5752,cval_orders_o_orderpriority#5753,cval_orders_o_clerk#5754,cval_orders_o_shippriority#5755,cval_orders_o_comment#5756,cval_orders_o_orderdate#5757,cdepval_orders_o_orderstatus#5758,cdepval_orders_o_totalprice#5759,cdepval_orders_o_orderpriority#5760,cdepval_orders_o_clerk#5761,cdepval_orders_o_shippriority#5762,cdepval_orders_o_comment#5763,cdepval_orders_o_orderdate#5764,co_orderstatus#5765,co_totalprice#5766,co_orderpriority#5767,co_clerk#5768,co_shippriority#5769,co_comment#5770,co_orderdate#5771] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#5706 AS rid_2#5727, cpfk_nation_customer#5707 AS cpfk_nation_customer_2#5728, cfpk_customer_nation#5708 AS cfpk_customer_nation_2#5729, cval_customer_c_name#5709 AS cval_customer_c_name_2#5730, cval_customer_c_address#5710 AS cval_customer_c_address_2#5731, cval_customer_c_phone#5711 AS cval_customer_c_phone_2#5732, cval_customer_c_acctbal#5712 AS cval_customer_c_acctbal_2#5733, cval_customer_c_comment#5713 AS cval_customer_c_comment_2#5734, cval_customer_c_mktsegment#5714 AS cval_customer_c_mktsegment_2#5735, cdepval_customer_c_name#5715 AS cdepval_customer_c_name_2#5736, cdepval_customer_c_address#5716 AS cdepval_customer_c_address_2#5737, cdepval_customer_c_phone#5717 AS cdepval_customer_c_phone_2#5738, cdepval_customer_c_acctbal#5718 AS cdepval_customer_c_acctbal_2#5739, cdepval_customer_c_comment#5719 AS cdepval_customer_c_comment_2#5740, cdepval_customer_c_mktsegment#5720 AS cdepval_customer_c_mktsegment_2#5741, cc_name#5721 AS cc_name_2#5742, cc_address#5722 AS cc_address_2#5743, cc_phone#5723 AS cc_phone_2#5744, cc_acctbal#5724 AS cc_acctbal_2#5745, cc_comment#5725 AS cc_comment_2#5746, cc_mktsegment#5726 AS cc_mktsegment_2#5747]
            :        :  +- Relation[rid#5706,cpfk_nation_customer#5707,cfpk_customer_nation#5708,cval_customer_c_name#5709,cval_customer_c_address#5710,cval_customer_c_phone#5711,cval_customer_c_acctbal#5712,cval_customer_c_comment#5713,cval_customer_c_mktsegment#5714,cdepval_customer_c_name#5715,cdepval_customer_c_address#5716,cdepval_customer_c_phone#5717,cdepval_customer_c_acctbal#5718,cdepval_customer_c_comment#5719,cdepval_customer_c_mktsegment#5720,cc_name#5721,cc_address#5722,cc_phone#5723,cc_acctbal#5724,cc_comment#5725,cc_mktsegment#5726] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join UsingJoin(Inner,List(rid_1))
            :           :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#5635, cval_region_r_name_0#5636, cval_region_r_comment_0#5637, cdepval_region_r_name_0#5638, cdepval_region_r_comment_0#5639, cr_name_0#5640, cr_comment_0#5641, 'rid_1]
            :           :  :- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :           :  :  +- Project [rid#5628 AS rid_0#5635, cval_region_r_name#5629 AS cval_region_r_name_0#5636, cval_region_r_comment#5630 AS cval_region_r_comment_0#5637, cdepval_region_r_name#5631 AS cdepval_region_r_name_0#5638, cdepval_region_r_comment#5632 AS cdepval_region_r_comment_0#5639, cr_name#5633 AS cr_name_0#5640, cr_comment#5634 AS cr_comment_0#5641]
            :           :  :     +- Relation[rid#5628,cval_region_r_name#5629,cval_region_r_comment#5630,cdepval_region_r_name#5631,cdepval_region_r_comment#5632,cr_name#5633,cr_comment#5634] JDBCRelation(tregion) [numPartitions=1]
            :           :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
            :           :     +- Project [rid#5688 AS rid_1#5697, cpfk_region_nation#5689 AS cpfk_region_nation_1#5698, cfpk_nation_region#5690 AS cfpk_nation_region_1#5699, cval_nation_n_name#5691 AS cval_nation_n_name_1#5700, cval_nation_n_comment#5692 AS cval_nation_n_comment_1#5701, cdepval_nation_n_name#5693 AS cdepval_nation_n_name_1#5702, cdepval_nation_n_comment#5694 AS cdepval_nation_n_comment_1#5703, cn_name#5695 AS cn_name_1#5704, cn_comment#5696 AS cn_comment_1#5705]
            :           :        +- Relation[rid#5688,cpfk_region_nation#5689,cfpk_nation_region#5690,cval_nation_n_name#5691,cval_nation_n_comment#5692,cdepval_nation_n_name#5693,cdepval_nation_n_comment#5694,cn_name#5695,cn_comment#5696] JDBCRelation(tnation) [numPartitions=1]
            :           +- Project [rid#5656 AS rid_1#5665, cpfk_region_nation#5657 AS cpfk_region_nation_1#5666, cfpk_nation_region#5658 AS cfpk_nation_region_1#5667, cval_nation_n_name#5659 AS cval_nation_n_name_1#5668, cval_nation_n_comment#5660 AS cval_nation_n_comment_1#5669, cdepval_nation_n_name#5661 AS cdepval_nation_n_name_1#5670, cdepval_nation_n_comment#5662 AS cdepval_nation_n_comment_1#5671, cn_name#5663 AS cn_name_1#5672, cn_comment#5664 AS cn_comment_1#5673]
            :              +- Relation[rid#5656,cpfk_region_nation#5657,cfpk_nation_region#5658,cval_nation_n_name#5659,cval_nation_n_comment#5660,cdepval_nation_n_name#5661,cdepval_nation_n_comment#5662,cn_name#5663,cn_comment#5664] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#5886 AS rid_5#5904, cpfk_nation_supplier#5887 AS cpfk_nation_supplier_5#5905, cfpk_supplier_nation#5888 AS cfpk_supplier_nation_5#5906, cval_supplier_s_name#5889 AS cval_supplier_s_name_5#5907, cval_supplier_s_address#5890 AS cval_supplier_s_address_5#5908, cval_supplier_s_phone#5891 AS cval_supplier_s_phone_5#5909, cval_supplier_s_acctbal#5892 AS cval_supplier_s_acctbal_5#5910, cval_supplier_s_comment#5893 AS cval_supplier_s_comment_5#5911, cdepval_supplier_s_name#5894 AS cdepval_supplier_s_name_5#5912, cdepval_supplier_s_address#5895 AS cdepval_supplier_s_address_5#5913, cdepval_supplier_s_phone#5896 AS cdepval_supplier_s_phone_5#5914, cdepval_supplier_s_acctbal#5897 AS cdepval_supplier_s_acctbal_5#5915, cdepval_supplier_s_comment#5898 AS cdepval_supplier_s_comment_5#5916, cs_name#5899 AS cs_name_5#5917, cs_address#5900 AS cs_address_5#5918, cs_phone#5901 AS cs_phone_5#5919, cs_acctbal#5902 AS cs_acctbal_5#5920, cs_comment#5903 AS cs_comment_5#5921]
               +- Relation[rid#5886,cpfk_nation_supplier#5887,cfpk_supplier_nation#5888,cval_supplier_s_name#5889,cval_supplier_s_address#5890,cval_supplier_s_phone#5891,cval_supplier_s_acctbal#5892,cval_supplier_s_comment#5893,cdepval_supplier_s_name#5894,cdepval_supplier_s_address#5895,cdepval_supplier_s_phone#5896,cdepval_supplier_s_acctbal#5897,cdepval_supplier_s_comment#5898,cs_name#5899,cs_address#5900,cs_phone#5901,cs_acctbal#5902,cs_comment#5903] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 31746ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/26 22:33:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:33:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6053L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:33:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:33:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:33:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:33:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:33:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:33:33 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:33:33 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:33:33 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:33:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:33:33 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:33:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:33:33 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:33:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:33:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:33:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6053L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6080, cval_part_p_name_0#6081, cval_part_p_mfgr_0#6082, cval_part_p_type_0#6083, cval_part_p_size_0#6084, cval_part_p_container_0#6085, cval_part_p_retailprice_0#6086, cval_part_p_comment_0#6087, cval_part_p_brand_0#6088, cdepval_part_p_name_0#6089, cdepval_part_p_mfgr_0#6090, cdepval_part_p_type_0#6091, cdepval_part_p_size_0#6092, cdepval_part_p_container_0#6093, cdepval_part_p_retailprice_0#6094, cdepval_part_p_comment_0#6095, cdepval_part_p_brand_0#6096, cp_name_0#6097, cp_mfgr_0#6098, cp_type_0#6099, cp_size_0#6100, cp_container_0#6101, cp_retailprice_0#6102, cp_comment_0#6103, ... 2 more fields]
         :  :  :  :  :- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :  :  :  +- Project [rid#6055 AS rid_0#6080, cval_part_p_name#6056 AS cval_part_p_name_0#6081, cval_part_p_mfgr#6057 AS cval_part_p_mfgr_0#6082, cval_part_p_type#6058 AS cval_part_p_type_0#6083, cval_part_p_size#6059 AS cval_part_p_size_0#6084, cval_part_p_container#6060 AS cval_part_p_container_0#6085, cval_part_p_retailprice#6061 AS cval_part_p_retailprice_0#6086, cval_part_p_comment#6062 AS cval_part_p_comment_0#6087, cval_part_p_brand#6063 AS cval_part_p_brand_0#6088, cdepval_part_p_name#6064 AS cdepval_part_p_name_0#6089, cdepval_part_p_mfgr#6065 AS cdepval_part_p_mfgr_0#6090, cdepval_part_p_type#6066 AS cdepval_part_p_type_0#6091, cdepval_part_p_size#6067 AS cdepval_part_p_size_0#6092, cdepval_part_p_container#6068 AS cdepval_part_p_container_0#6093, cdepval_part_p_retailprice#6069 AS cdepval_part_p_retailprice_0#6094, cdepval_part_p_comment#6070 AS cdepval_part_p_comment_0#6095, cdepval_part_p_brand#6071 AS cdepval_part_p_brand_0#6096, cp_name#6072 AS cp_name_0#6097, cp_mfgr#6073 AS cp_mfgr_0#6098, cp_type#6074 AS cp_type_0#6099, cp_size#6075 AS cp_size_0#6100, cp_container#6076 AS cp_container_0#6101, cp_retailprice#6077 AS cp_retailprice_0#6102, cp_comment#6078 AS cp_comment_0#6103, cp_brand#6079 AS cp_brand_0#6104]
         :  :  :  :  :     +- Relation[rid#6055,cval_part_p_name#6056,cval_part_p_mfgr#6057,cval_part_p_type#6058,cval_part_p_size#6059,cval_part_p_container#6060,cval_part_p_retailprice#6061,cval_part_p_comment#6062,cval_part_p_brand#6063,cdepval_part_p_name#6064,cdepval_part_p_mfgr#6065,cdepval_part_p_type#6066,cdepval_part_p_size#6067,cdepval_part_p_container#6068,cdepval_part_p_retailprice#6069,cdepval_part_p_comment#6070,cdepval_part_p_brand#6071,cp_name#6072,cp_mfgr#6073,cp_type#6074,cp_size#6075,cp_container#6076,cp_retailprice#6077,cp_comment#6078,cp_brand#6079] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :  :  :  :     +- Project [rid#6295 AS rid_1#6340, cpfk_orders_lineitem#6296 AS cpfk_orders_lineitem_1#6341, cpfk_supplier_lineitem#6297 AS cpfk_supplier_lineitem_1#6342, cfpk_lineitem_supplier#6298 AS cfpk_lineitem_supplier_1#6343, cfpk_lineitem_partsupp#6299 AS cfpk_lineitem_partsupp_1#6344, cpfk_part_lineitem#6300 AS cpfk_part_lineitem_1#6345, cfpk_lineitem_part#6301 AS cfpk_lineitem_part_1#6346, cpfk_partsupp_lineitem#6302 AS cpfk_partsupp_lineitem_1#6347, cfpk_lineitem_orders#6303 AS cfpk_lineitem_orders_1#6348, cval_lineitem_l_quantity#6304 AS cval_lineitem_l_quantity_1#6349, cval_lineitem_l_extendedprice#6305 AS cval_lineitem_l_extendedprice_1#6350, cval_lineitem_l_discount#6306 AS cval_lineitem_l_discount_1#6351, cval_lineitem_l_tax#6307 AS cval_lineitem_l_tax_1#6352, cval_lineitem_l_returnflag#6308 AS cval_lineitem_l_returnflag_1#6353, cval_lineitem_l_linestatus#6309 AS cval_lineitem_l_linestatus_1#6354, cval_lineitem_l_commitdate#6310 AS cval_lineitem_l_commitdate_1#6355, cval_lineitem_l_receiptdate#6311 AS cval_lineitem_l_receiptdate_1#6356, cval_lineitem_l_shipinstruct#6312 AS cval_lineitem_l_shipinstruct_1#6357, cval_lineitem_l_shipmode#6313 AS cval_lineitem_l_shipmode_1#6358, cval_lineitem_l_comment#6314 AS cval_lineitem_l_comment_1#6359, cval_lineitem_l_shipdate#6315 AS cval_lineitem_l_shipdate_1#6360, cdepval_lineitem_l_quantity#6316 AS cdepval_lineitem_l_quantity_1#6361, cdepval_lineitem_l_extendedprice#6317 AS cdepval_lineitem_l_extendedprice_1#6362, cdepval_lineitem_l_discount#6318 AS cdepval_lineitem_l_discount_1#6363, ... 21 more fields]
         :  :  :  :        +- Relation[rid#6295,cpfk_orders_lineitem#6296,cpfk_supplier_lineitem#6297,cfpk_lineitem_supplier#6298,cfpk_lineitem_partsupp#6299,cpfk_part_lineitem#6300,cfpk_lineitem_part#6301,cpfk_partsupp_lineitem#6302,cfpk_lineitem_orders#6303,cval_lineitem_l_quantity#6304,cval_lineitem_l_extendedprice#6305,cval_lineitem_l_discount#6306,cval_lineitem_l_tax#6307,cval_lineitem_l_returnflag#6308,cval_lineitem_l_linestatus#6309,cval_lineitem_l_commitdate#6310,cval_lineitem_l_receiptdate#6311,cval_lineitem_l_shipinstruct#6312,cval_lineitem_l_shipmode#6313,cval_lineitem_l_comment#6314,cval_lineitem_l_shipdate#6315,cdepval_lineitem_l_quantity#6316,cdepval_lineitem_l_extendedprice#6317,cdepval_lineitem_l_discount#6318,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- Project [rid#6155 AS rid_1#6200, cpfk_orders_lineitem#6156 AS cpfk_orders_lineitem_1#6201, cpfk_supplier_lineitem#6157 AS cpfk_supplier_lineitem_1#6202, cfpk_lineitem_supplier#6158 AS cfpk_lineitem_supplier_1#6203, cfpk_lineitem_partsupp#6159 AS cfpk_lineitem_partsupp_1#6204, cpfk_part_lineitem#6160 AS cpfk_part_lineitem_1#6205, cfpk_lineitem_part#6161 AS cfpk_lineitem_part_1#6206, cpfk_partsupp_lineitem#6162 AS cpfk_partsupp_lineitem_1#6207, cfpk_lineitem_orders#6163 AS cfpk_lineitem_orders_1#6208, cval_lineitem_l_quantity#6164 AS cval_lineitem_l_quantity_1#6209, cval_lineitem_l_extendedprice#6165 AS cval_lineitem_l_extendedprice_1#6210, cval_lineitem_l_discount#6166 AS cval_lineitem_l_discount_1#6211, cval_lineitem_l_tax#6167 AS cval_lineitem_l_tax_1#6212, cval_lineitem_l_returnflag#6168 AS cval_lineitem_l_returnflag_1#6213, cval_lineitem_l_linestatus#6169 AS cval_lineitem_l_linestatus_1#6214, cval_lineitem_l_commitdate#6170 AS cval_lineitem_l_commitdate_1#6215, cval_lineitem_l_receiptdate#6171 AS cval_lineitem_l_receiptdate_1#6216, cval_lineitem_l_shipinstruct#6172 AS cval_lineitem_l_shipinstruct_1#6217, cval_lineitem_l_shipmode#6173 AS cval_lineitem_l_shipmode_1#6218, cval_lineitem_l_comment#6174 AS cval_lineitem_l_comment_1#6219, cval_lineitem_l_shipdate#6175 AS cval_lineitem_l_shipdate_1#6220, cdepval_lineitem_l_quantity#6176 AS cdepval_lineitem_l_quantity_1#6221, cdepval_lineitem_l_extendedprice#6177 AS cdepval_lineitem_l_extendedprice_1#6222, cdepval_lineitem_l_discount#6178 AS cdepval_lineitem_l_discount_1#6223, ... 21 more fields]
         :  :  :     +- Relation[rid#6155,cpfk_orders_lineitem#6156,cpfk_supplier_lineitem#6157,cfpk_lineitem_supplier#6158,cfpk_lineitem_partsupp#6159,cpfk_part_lineitem#6160,cfpk_lineitem_part#6161,cpfk_partsupp_lineitem#6162,cfpk_lineitem_orders#6163,cval_lineitem_l_quantity#6164,cval_lineitem_l_extendedprice#6165,cval_lineitem_l_discount#6166,cval_lineitem_l_tax#6167,cval_lineitem_l_returnflag#6168,cval_lineitem_l_linestatus#6169,cval_lineitem_l_commitdate#6170,cval_lineitem_l_receiptdate#6171,cval_lineitem_l_shipinstruct#6172,cval_lineitem_l_shipmode#6173,cval_lineitem_l_comment#6174,cval_lineitem_l_shipdate#6175,cdepval_lineitem_l_quantity#6176,cdepval_lineitem_l_extendedprice#6177,cdepval_lineitem_l_discount#6178,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#6385 AS rid_2#6403, cpfk_nation_supplier#6386 AS cpfk_nation_supplier_2#6404, cfpk_supplier_nation#6387 AS cfpk_supplier_nation_2#6405, cval_supplier_s_name#6388 AS cval_supplier_s_name_2#6406, cval_supplier_s_address#6389 AS cval_supplier_s_address_2#6407, cval_supplier_s_phone#6390 AS cval_supplier_s_phone_2#6408, cval_supplier_s_acctbal#6391 AS cval_supplier_s_acctbal_2#6409, cval_supplier_s_comment#6392 AS cval_supplier_s_comment_2#6410, cdepval_supplier_s_name#6393 AS cdepval_supplier_s_name_2#6411, cdepval_supplier_s_address#6394 AS cdepval_supplier_s_address_2#6412, cdepval_supplier_s_phone#6395 AS cdepval_supplier_s_phone_2#6413, cdepval_supplier_s_acctbal#6396 AS cdepval_supplier_s_acctbal_2#6414, cdepval_supplier_s_comment#6397 AS cdepval_supplier_s_comment_2#6415, cs_name#6398 AS cs_name_2#6416, cs_address#6399 AS cs_address_2#6417, cs_phone#6400 AS cs_phone_2#6418, cs_acctbal#6401 AS cs_acctbal_2#6419, cs_comment#6402 AS cs_comment_2#6420]
         :  :     +- Relation[rid#6385,cpfk_nation_supplier#6386,cfpk_supplier_nation#6387,cval_supplier_s_name#6388,cval_supplier_s_address#6389,cval_supplier_s_phone#6390,cval_supplier_s_acctbal#6391,cval_supplier_s_comment#6392,cdepval_supplier_s_name#6393,cdepval_supplier_s_address#6394,cdepval_supplier_s_phone#6395,cdepval_supplier_s_acctbal#6396,cdepval_supplier_s_comment#6397,cs_name#6398,cs_address#6399,cs_phone#6400,cs_acctbal#6401,cs_comment#6402] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#6421 AS rid_3#6430, cpfk_region_nation#6422 AS cpfk_region_nation_3#6431, cfpk_nation_region#6423 AS cfpk_nation_region_3#6432, cval_nation_n_name#6424 AS cval_nation_n_name_3#6433, cval_nation_n_comment#6425 AS cval_nation_n_comment_3#6434, cdepval_nation_n_name#6426 AS cdepval_nation_n_name_3#6435, cdepval_nation_n_comment#6427 AS cdepval_nation_n_comment_3#6436, cn_name#6428 AS cn_name_3#6437, cn_comment#6429 AS cn_comment_3#6438]
         :     +- Relation[rid#6421,cpfk_region_nation#6422,cfpk_nation_region#6423,cval_nation_n_name#6424,cval_nation_n_comment#6425,cdepval_nation_n_name#6426,cdepval_nation_n_comment#6427,cn_name#6428,cn_comment#6429] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#6559 AS rid_7#6583, cpfk_customer_orders#6560 AS cpfk_customer_orders_7#6584, cfpk_orders_customer#6561 AS cfpk_orders_customer_7#6585, cval_orders_o_orderstatus#6562 AS cval_orders_o_orderstatus_7#6586, cval_orders_o_totalprice#6563 AS cval_orders_o_totalprice_7#6587, cval_orders_o_orderpriority#6564 AS cval_orders_o_orderpriority_7#6588, cval_orders_o_clerk#6565 AS cval_orders_o_clerk_7#6589, cval_orders_o_shippriority#6566 AS cval_orders_o_shippriority_7#6590, cval_orders_o_comment#6567 AS cval_orders_o_comment_7#6591, cval_orders_o_orderdate#6568 AS cval_orders_o_orderdate_7#6592, cdepval_orders_o_orderstatus#6569 AS cdepval_orders_o_orderstatus_7#6593, cdepval_orders_o_totalprice#6570 AS cdepval_orders_o_totalprice_7#6594, cdepval_orders_o_orderpriority#6571 AS cdepval_orders_o_orderpriority_7#6595, cdepval_orders_o_clerk#6572 AS cdepval_orders_o_clerk_7#6596, cdepval_orders_o_shippriority#6573 AS cdepval_orders_o_shippriority_7#6597, cdepval_orders_o_comment#6574 AS cdepval_orders_o_comment_7#6598, cdepval_orders_o_orderdate#6575 AS cdepval_orders_o_orderdate_7#6599, co_orderstatus#6576 AS co_orderstatus_7#6600, co_totalprice#6577 AS co_totalprice_7#6601, co_orderpriority#6578 AS co_orderpriority_7#6602, co_clerk#6579 AS co_clerk_7#6603, co_shippriority#6580 AS co_shippriority_7#6604, co_comment#6581 AS co_comment_7#6605, co_orderdate#6582 AS co_orderdate_7#6606]
            :  +- Relation[rid#6559,cpfk_customer_orders#6560,cfpk_orders_customer#6561,cval_orders_o_orderstatus#6562,cval_orders_o_totalprice#6563,cval_orders_o_orderpriority#6564,cval_orders_o_clerk#6565,cval_orders_o_shippriority#6566,cval_orders_o_comment#6567,cval_orders_o_orderdate#6568,cdepval_orders_o_orderstatus#6569,cdepval_orders_o_totalprice#6570,cdepval_orders_o_orderpriority#6571,cdepval_orders_o_clerk#6572,cdepval_orders_o_shippriority#6573,cdepval_orders_o_comment#6574,cdepval_orders_o_orderdate#6575,co_orderstatus#6576,co_totalprice#6577,co_orderpriority#6578,co_clerk#6579,co_shippriority#6580,co_comment#6581,co_orderdate#6582] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#6517 AS rid_6#6538, cpfk_nation_customer#6518 AS cpfk_nation_customer_6#6539, cfpk_customer_nation#6519 AS cfpk_customer_nation_6#6540, cval_customer_c_name#6520 AS cval_customer_c_name_6#6541, cval_customer_c_address#6521 AS cval_customer_c_address_6#6542, cval_customer_c_phone#6522 AS cval_customer_c_phone_6#6543, cval_customer_c_acctbal#6523 AS cval_customer_c_acctbal_6#6544, cval_customer_c_comment#6524 AS cval_customer_c_comment_6#6545, cval_customer_c_mktsegment#6525 AS cval_customer_c_mktsegment_6#6546, cdepval_customer_c_name#6526 AS cdepval_customer_c_name_6#6547, cdepval_customer_c_address#6527 AS cdepval_customer_c_address_6#6548, cdepval_customer_c_phone#6528 AS cdepval_customer_c_phone_6#6549, cdepval_customer_c_acctbal#6529 AS cdepval_customer_c_acctbal_6#6550, cdepval_customer_c_comment#6530 AS cdepval_customer_c_comment_6#6551, cdepval_customer_c_mktsegment#6531 AS cdepval_customer_c_mktsegment_6#6552, cc_name#6532 AS cc_name_6#6553, cc_address#6533 AS cc_address_6#6554, cc_phone#6534 AS cc_phone_6#6555, cc_acctbal#6535 AS cc_acctbal_6#6556, cc_comment#6536 AS cc_comment_6#6557, cc_mktsegment#6537 AS cc_mktsegment_6#6558]
               :  +- Relation[rid#6517,cpfk_nation_customer#6518,cfpk_customer_nation#6519,cval_customer_c_name#6520,cval_customer_c_address#6521,cval_customer_c_phone#6522,cval_customer_c_acctbal#6523,cval_customer_c_comment#6524,cval_customer_c_mktsegment#6525,cdepval_customer_c_name#6526,cdepval_customer_c_address#6527,cdepval_customer_c_phone#6528,cdepval_customer_c_acctbal#6529,cdepval_customer_c_comment#6530,cdepval_customer_c_mktsegment#6531,cc_name#6532,cc_address#6533,cc_phone#6534,cc_acctbal#6535,cc_comment#6536,cc_mktsegment#6537] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join UsingJoin(Inner,List(rid_5))
                  :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_5, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#6446, cval_region_r_name_4#6447, cval_region_r_comment_4#6448, cdepval_region_r_name_4#6449, cdepval_region_r_comment_4#6450, cr_name_4#6451, cr_comment_4#6452, 'rid_5]
                  :  :- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                  :  :  +- Project [rid#6439 AS rid_4#6446, cval_region_r_name#6440 AS cval_region_r_name_4#6447, cval_region_r_comment#6441 AS cval_region_r_comment_4#6448, cdepval_region_r_name#6442 AS cdepval_region_r_name_4#6449, cdepval_region_r_comment#6443 AS cdepval_region_r_comment_4#6450, cr_name#6444 AS cr_name_4#6451, cr_comment#6445 AS cr_comment_4#6452]
                  :  :     +- Relation[rid#6439,cval_region_r_name#6440,cval_region_r_comment#6441,cdepval_region_r_name#6442,cdepval_region_r_comment#6443,cr_name#6444,cr_comment#6445] JDBCRelation(tregion) [numPartitions=1]
                  :  +- 'Project ['cpfk_region_nation_5, 'rid_5]
                  :     +- Project [rid#6499 AS rid_5#6508, cpfk_region_nation#6500 AS cpfk_region_nation_5#6509, cfpk_nation_region#6501 AS cfpk_nation_region_5#6510, cval_nation_n_name#6502 AS cval_nation_n_name_5#6511, cval_nation_n_comment#6503 AS cval_nation_n_comment_5#6512, cdepval_nation_n_name#6504 AS cdepval_nation_n_name_5#6513, cdepval_nation_n_comment#6505 AS cdepval_nation_n_comment_5#6514, cn_name#6506 AS cn_name_5#6515, cn_comment#6507 AS cn_comment_5#6516]
                  :        +- Relation[rid#6499,cpfk_region_nation#6500,cfpk_nation_region#6501,cval_nation_n_name#6502,cval_nation_n_comment#6503,cdepval_nation_n_name#6504,cdepval_nation_n_comment#6505,cn_name#6506,cn_comment#6507] JDBCRelation(tnation) [numPartitions=1]
                  +- Project [rid#6467 AS rid_5#6476, cpfk_region_nation#6468 AS cpfk_region_nation_5#6477, cfpk_nation_region#6469 AS cfpk_nation_region_5#6478, cval_nation_n_name#6470 AS cval_nation_n_name_5#6479, cval_nation_n_comment#6471 AS cval_nation_n_comment_5#6480, cdepval_nation_n_name#6472 AS cdepval_nation_n_name_5#6481, cdepval_nation_n_comment#6473 AS cdepval_nation_n_comment_5#6482, cn_name#6474 AS cn_name_5#6483, cn_comment#6475 AS cn_comment_5#6484]
                     +- Relation[rid#6467,cpfk_region_nation#6468,cfpk_nation_region#6469,cval_nation_n_name#6470,cval_nation_n_comment#6471,cdepval_nation_n_name#6472,cdepval_nation_n_comment#6473,cn_name#6474,cn_comment#6475] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 5011ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 22:33:38 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:33:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6774L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:33:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:33:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:33:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:33:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:33:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:33:38 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:33:38 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:33:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6774L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#6830 AS rid_2#6875, cpfk_orders_lineitem#6831 AS cpfk_orders_lineitem_2#6876, cpfk_supplier_lineitem#6832 AS cpfk_supplier_lineitem_2#6877, cfpk_lineitem_supplier#6833 AS cfpk_lineitem_supplier_2#6878, cfpk_lineitem_partsupp#6834 AS cfpk_lineitem_partsupp_2#6879, cpfk_part_lineitem#6835 AS cpfk_part_lineitem_2#6880, cfpk_lineitem_part#6836 AS cfpk_lineitem_part_2#6881, cpfk_partsupp_lineitem#6837 AS cpfk_partsupp_lineitem_2#6882, cfpk_lineitem_orders#6838 AS cfpk_lineitem_orders_2#6883, cval_lineitem_l_quantity#6839 AS cval_lineitem_l_quantity_2#6884, cval_lineitem_l_extendedprice#6840 AS cval_lineitem_l_extendedprice_2#6885, cval_lineitem_l_discount#6841 AS cval_lineitem_l_discount_2#6886, cval_lineitem_l_tax#6842 AS cval_lineitem_l_tax_2#6887, cval_lineitem_l_returnflag#6843 AS cval_lineitem_l_returnflag_2#6888, cval_lineitem_l_linestatus#6844 AS cval_lineitem_l_linestatus_2#6889, cval_lineitem_l_commitdate#6845 AS cval_lineitem_l_commitdate_2#6890, cval_lineitem_l_receiptdate#6846 AS cval_lineitem_l_receiptdate_2#6891, cval_lineitem_l_shipinstruct#6847 AS cval_lineitem_l_shipinstruct_2#6892, cval_lineitem_l_shipmode#6848 AS cval_lineitem_l_shipmode_2#6893, cval_lineitem_l_comment#6849 AS cval_lineitem_l_comment_2#6894, cval_lineitem_l_shipdate#6850 AS cval_lineitem_l_shipdate_2#6895, cdepval_lineitem_l_quantity#6851 AS cdepval_lineitem_l_quantity_2#6896, cdepval_lineitem_l_extendedprice#6852 AS cdepval_lineitem_l_extendedprice_2#6897, cdepval_lineitem_l_discount#6853 AS cdepval_lineitem_l_discount_2#6898, ... 21 more fields]
         :  :  :  :  +- Relation[rid#6830,cpfk_orders_lineitem#6831,cpfk_supplier_lineitem#6832,cfpk_lineitem_supplier#6833,cfpk_lineitem_partsupp#6834,cpfk_part_lineitem#6835,cfpk_lineitem_part#6836,cpfk_partsupp_lineitem#6837,cfpk_lineitem_orders#6838,cval_lineitem_l_quantity#6839,cval_lineitem_l_extendedprice#6840,cval_lineitem_l_discount#6841,cval_lineitem_l_tax#6842,cval_lineitem_l_returnflag#6843,cval_lineitem_l_linestatus#6844,cval_lineitem_l_commitdate#6845,cval_lineitem_l_receiptdate#6846,cval_lineitem_l_shipinstruct#6847,cval_lineitem_l_shipmode#6848,cval_lineitem_l_comment#6849,cval_lineitem_l_shipdate#6850,cdepval_lineitem_l_quantity#6851,cdepval_lineitem_l_extendedprice#6852,cdepval_lineitem_l_discount#6853,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#6794 AS rid_1#6812, cpfk_nation_supplier#6795 AS cpfk_nation_supplier_1#6813, cfpk_supplier_nation#6796 AS cfpk_supplier_nation_1#6814, cval_supplier_s_name#6797 AS cval_supplier_s_name_1#6815, cval_supplier_s_address#6798 AS cval_supplier_s_address_1#6816, cval_supplier_s_phone#6799 AS cval_supplier_s_phone_1#6817, cval_supplier_s_acctbal#6800 AS cval_supplier_s_acctbal_1#6818, cval_supplier_s_comment#6801 AS cval_supplier_s_comment_1#6819, cdepval_supplier_s_name#6802 AS cdepval_supplier_s_name_1#6820, cdepval_supplier_s_address#6803 AS cdepval_supplier_s_address_1#6821, cdepval_supplier_s_phone#6804 AS cdepval_supplier_s_phone_1#6822, cdepval_supplier_s_acctbal#6805 AS cdepval_supplier_s_acctbal_1#6823, cdepval_supplier_s_comment#6806 AS cdepval_supplier_s_comment_1#6824, cs_name#6807 AS cs_name_1#6825, cs_address#6808 AS cs_address_1#6826, cs_phone#6809 AS cs_phone_1#6827, cs_acctbal#6810 AS cs_acctbal_1#6828, cs_comment#6811 AS cs_comment_1#6829]
         :  :  :     :  +- Relation[rid#6794,cpfk_nation_supplier#6795,cfpk_supplier_nation#6796,cval_supplier_s_name#6797,cval_supplier_s_address#6798,cval_supplier_s_phone#6799,cval_supplier_s_acctbal#6800,cval_supplier_s_comment#6801,cdepval_supplier_s_name#6802,cdepval_supplier_s_address#6803,cdepval_supplier_s_phone#6804,cdepval_supplier_s_acctbal#6805,cdepval_supplier_s_comment#6806,cs_name#6807,cs_address#6808,cs_phone#6809,cs_acctbal#6810,cs_comment#6811] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#6776 AS rid_0#6785, cpfk_region_nation#6777 AS cpfk_region_nation_0#6786, cfpk_nation_region#6778 AS cfpk_nation_region_0#6787, cval_nation_n_name#6779 AS cval_nation_n_name_0#6788, cval_nation_n_comment#6780 AS cval_nation_n_comment_0#6789, cdepval_nation_n_name#6781 AS cdepval_nation_n_name_0#6790, cdepval_nation_n_comment#6782 AS cdepval_nation_n_comment_0#6791, cn_name#6783 AS cn_name_0#6792, cn_comment#6784 AS cn_comment_0#6793]
         :  :  :        +- Relation[rid#6776,cpfk_region_nation#6777,cfpk_nation_region#6778,cval_nation_n_name#6779,cval_nation_n_comment#6780,cdepval_nation_n_name#6781,cdepval_nation_n_comment#6782,cn_name#6783,cn_comment#6784] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#6920 AS rid_3#6945, cval_part_p_name#6921 AS cval_part_p_name_3#6946, cval_part_p_mfgr#6922 AS cval_part_p_mfgr_3#6947, cval_part_p_type#6923 AS cval_part_p_type_3#6948, cval_part_p_size#6924 AS cval_part_p_size_3#6949, cval_part_p_container#6925 AS cval_part_p_container_3#6950, cval_part_p_retailprice#6926 AS cval_part_p_retailprice_3#6951, cval_part_p_comment#6927 AS cval_part_p_comment_3#6952, cval_part_p_brand#6928 AS cval_part_p_brand_3#6953, cdepval_part_p_name#6929 AS cdepval_part_p_name_3#6954, cdepval_part_p_mfgr#6930 AS cdepval_part_p_mfgr_3#6955, cdepval_part_p_type#6931 AS cdepval_part_p_type_3#6956, cdepval_part_p_size#6932 AS cdepval_part_p_size_3#6957, cdepval_part_p_container#6933 AS cdepval_part_p_container_3#6958, cdepval_part_p_retailprice#6934 AS cdepval_part_p_retailprice_3#6959, cdepval_part_p_comment#6935 AS cdepval_part_p_comment_3#6960, cdepval_part_p_brand#6936 AS cdepval_part_p_brand_3#6961, cp_name#6937 AS cp_name_3#6962, cp_mfgr#6938 AS cp_mfgr_3#6963, cp_type#6939 AS cp_type_3#6964, cp_size#6940 AS cp_size_3#6965, cp_container#6941 AS cp_container_3#6966, cp_retailprice#6942 AS cp_retailprice_3#6967, cp_comment#6943 AS cp_comment_3#6968, cp_brand#6944 AS cp_brand_3#6969]
         :  :     +- Relation[rid#6920,cval_part_p_name#6921,cval_part_p_mfgr#6922,cval_part_p_type#6923,cval_part_p_size#6924,cval_part_p_container#6925,cval_part_p_retailprice#6926,cval_part_p_comment#6927,cval_part_p_brand#6928,cdepval_part_p_name#6929,cdepval_part_p_mfgr#6930,cdepval_part_p_type#6931,cdepval_part_p_size#6932,cdepval_part_p_container#6933,cdepval_part_p_retailprice#6934,cdepval_part_p_comment#6935,cdepval_part_p_brand#6936,cp_name#6937,cp_mfgr#6938,cp_type#6939,cp_size#6940,cp_container#6941,cp_retailprice#6942,cp_comment#6943,cp_brand#6944] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#6970 AS rid_4#6984, cpfk_part_partsupp#6971 AS cpfk_part_partsupp_4#6985, cfpk_partsupp_part#6972 AS cfpk_partsupp_part_4#6986, cpfk_supplier_partsupp#6973 AS cpfk_supplier_partsupp_4#6987, cfpk_partsupp_supplier#6974 AS cfpk_partsupp_supplier_4#6988, cval_partsupp_ps_availqty#6975 AS cval_partsupp_ps_availqty_4#6989, cval_partsupp_ps_supplycost#6976 AS cval_partsupp_ps_supplycost_4#6990, cval_partsupp_ps_comment#6977 AS cval_partsupp_ps_comment_4#6991, cdepval_partsupp_ps_availqty#6978 AS cdepval_partsupp_ps_availqty_4#6992, cdepval_partsupp_ps_supplycost#6979 AS cdepval_partsupp_ps_supplycost_4#6993, cdepval_partsupp_ps_comment#6980 AS cdepval_partsupp_ps_comment_4#6994, cps_availqty#6981 AS cps_availqty_4#6995, cps_supplycost#6982 AS cps_supplycost_4#6996, cps_comment#6983 AS cps_comment_4#6997]
         :     +- Relation[rid#6970,cpfk_part_partsupp#6971,cfpk_partsupp_part#6972,cpfk_supplier_partsupp#6973,cfpk_partsupp_supplier#6974,cval_partsupp_ps_availqty#6975,cval_partsupp_ps_supplycost#6976,cval_partsupp_ps_comment#6977,cdepval_partsupp_ps_availqty#6978,cdepval_partsupp_ps_supplycost#6979,cdepval_partsupp_ps_comment#6980,cps_availqty#6981,cps_supplycost#6982,cps_comment#6983] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#6998 AS rid_5#7022, cpfk_customer_orders#6999 AS cpfk_customer_orders_5#7023, cfpk_orders_customer#7000 AS cfpk_orders_customer_5#7024, cval_orders_o_orderstatus#7001 AS cval_orders_o_orderstatus_5#7025, cval_orders_o_totalprice#7002 AS cval_orders_o_totalprice_5#7026, cval_orders_o_orderpriority#7003 AS cval_orders_o_orderpriority_5#7027, cval_orders_o_clerk#7004 AS cval_orders_o_clerk_5#7028, cval_orders_o_shippriority#7005 AS cval_orders_o_shippriority_5#7029, cval_orders_o_comment#7006 AS cval_orders_o_comment_5#7030, cval_orders_o_orderdate#7007 AS cval_orders_o_orderdate_5#7031, cdepval_orders_o_orderstatus#7008 AS cdepval_orders_o_orderstatus_5#7032, cdepval_orders_o_totalprice#7009 AS cdepval_orders_o_totalprice_5#7033, cdepval_orders_o_orderpriority#7010 AS cdepval_orders_o_orderpriority_5#7034, cdepval_orders_o_clerk#7011 AS cdepval_orders_o_clerk_5#7035, cdepval_orders_o_shippriority#7012 AS cdepval_orders_o_shippriority_5#7036, cdepval_orders_o_comment#7013 AS cdepval_orders_o_comment_5#7037, cdepval_orders_o_orderdate#7014 AS cdepval_orders_o_orderdate_5#7038, co_orderstatus#7015 AS co_orderstatus_5#7039, co_totalprice#7016 AS co_totalprice_5#7040, co_orderpriority#7017 AS co_orderpriority_5#7041, co_clerk#7018 AS co_clerk_5#7042, co_shippriority#7019 AS co_shippriority_5#7043, co_comment#7020 AS co_comment_5#7044, co_orderdate#7021 AS co_orderdate_5#7045]
            +- Relation[rid#6998,cpfk_customer_orders#6999,cfpk_orders_customer#7000,cval_orders_o_orderstatus#7001,cval_orders_o_totalprice#7002,cval_orders_o_orderpriority#7003,cval_orders_o_clerk#7004,cval_orders_o_shippriority#7005,cval_orders_o_comment#7006,cval_orders_o_orderdate#7007,cdepval_orders_o_orderstatus#7008,cdepval_orders_o_totalprice#7009,cdepval_orders_o_orderpriority#7010,cdepval_orders_o_clerk#7011,cdepval_orders_o_shippriority#7012,cdepval_orders_o_comment#7013,cdepval_orders_o_orderdate#7014,co_orderstatus#7015,co_totalprice#7016,co_orderpriority#7017,co_clerk#7018,co_shippriority#7019,co_comment#7020,co_orderdate#7021] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 67147ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/26 22:34:45 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:34:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7189L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:34:45 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:34:45 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:34:45 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:34:45 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:34:45 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:34:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7189L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#7413 AS rid_2#7458, cpfk_orders_lineitem#7414 AS cpfk_orders_lineitem_2#7459, cpfk_supplier_lineitem#7415 AS cpfk_supplier_lineitem_2#7460, cfpk_lineitem_supplier#7416 AS cfpk_lineitem_supplier_2#7461, cfpk_lineitem_partsupp#7417 AS cfpk_lineitem_partsupp_2#7462, cpfk_part_lineitem#7418 AS cpfk_part_lineitem_2#7463, cfpk_lineitem_part#7419 AS cfpk_lineitem_part_2#7464, cpfk_partsupp_lineitem#7420 AS cpfk_partsupp_lineitem_2#7465, cfpk_lineitem_orders#7421 AS cfpk_lineitem_orders_2#7466, cval_lineitem_l_quantity#7422 AS cval_lineitem_l_quantity_2#7467, cval_lineitem_l_extendedprice#7423 AS cval_lineitem_l_extendedprice_2#7468, cval_lineitem_l_discount#7424 AS cval_lineitem_l_discount_2#7469, cval_lineitem_l_tax#7425 AS cval_lineitem_l_tax_2#7470, cval_lineitem_l_returnflag#7426 AS cval_lineitem_l_returnflag_2#7471, cval_lineitem_l_linestatus#7427 AS cval_lineitem_l_linestatus_2#7472, cval_lineitem_l_commitdate#7428 AS cval_lineitem_l_commitdate_2#7473, cval_lineitem_l_receiptdate#7429 AS cval_lineitem_l_receiptdate_2#7474, cval_lineitem_l_shipinstruct#7430 AS cval_lineitem_l_shipinstruct_2#7475, cval_lineitem_l_shipmode#7431 AS cval_lineitem_l_shipmode_2#7476, cval_lineitem_l_comment#7432 AS cval_lineitem_l_comment_2#7477, cval_lineitem_l_shipdate#7433 AS cval_lineitem_l_shipdate_2#7478, cdepval_lineitem_l_quantity#7434 AS cdepval_lineitem_l_quantity_2#7479, cdepval_lineitem_l_extendedprice#7435 AS cdepval_lineitem_l_extendedprice_2#7480, cdepval_lineitem_l_discount#7436 AS cdepval_lineitem_l_discount_2#7481, ... 21 more fields]
         :  +- Relation[rid#7413,cpfk_orders_lineitem#7414,cpfk_supplier_lineitem#7415,cfpk_lineitem_supplier#7416,cfpk_lineitem_partsupp#7417,cpfk_part_lineitem#7418,cfpk_lineitem_part#7419,cpfk_partsupp_lineitem#7420,cfpk_lineitem_orders#7421,cval_lineitem_l_quantity#7422,cval_lineitem_l_extendedprice#7423,cval_lineitem_l_discount#7424,cval_lineitem_l_tax#7425,cval_lineitem_l_returnflag#7426,cval_lineitem_l_linestatus#7427,cval_lineitem_l_commitdate#7428,cval_lineitem_l_receiptdate#7429,cval_lineitem_l_shipinstruct#7430,cval_lineitem_l_shipmode#7431,cval_lineitem_l_comment#7432,cval_lineitem_l_shipdate#7433,cdepval_lineitem_l_quantity#7434,cdepval_lineitem_l_extendedprice#7435,cdepval_lineitem_l_discount#7436,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin customer~orders, 'cpfk_customer_orders_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#7212, cpfk_nation_customer_0#7213, cfpk_customer_nation_0#7214, cval_customer_c_name_0#7215, cval_customer_c_address_0#7216, cval_customer_c_phone_0#7217, cval_customer_c_acctbal_0#7218, cval_customer_c_comment_0#7219, cval_customer_c_mktsegment_0#7220, cdepval_customer_c_name_0#7221, cdepval_customer_c_address_0#7222, cdepval_customer_c_phone_0#7223, cdepval_customer_c_acctbal_0#7224, cdepval_customer_c_comment_0#7225, cdepval_customer_c_mktsegment_0#7226, cc_name_0#7227, cc_address_0#7228, cc_phone_0#7229, cc_acctbal_0#7230, cc_comment_0#7231, cc_mktsegment_0#7232, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
            :  :  +- Project [rid#7191 AS rid_0#7212, cpfk_nation_customer#7192 AS cpfk_nation_customer_0#7213, cfpk_customer_nation#7193 AS cfpk_customer_nation_0#7214, cval_customer_c_name#7194 AS cval_customer_c_name_0#7215, cval_customer_c_address#7195 AS cval_customer_c_address_0#7216, cval_customer_c_phone#7196 AS cval_customer_c_phone_0#7217, cval_customer_c_acctbal#7197 AS cval_customer_c_acctbal_0#7218, cval_customer_c_comment#7198 AS cval_customer_c_comment_0#7219, cval_customer_c_mktsegment#7199 AS cval_customer_c_mktsegment_0#7220, cdepval_customer_c_name#7200 AS cdepval_customer_c_name_0#7221, cdepval_customer_c_address#7201 AS cdepval_customer_c_address_0#7222, cdepval_customer_c_phone#7202 AS cdepval_customer_c_phone_0#7223, cdepval_customer_c_acctbal#7203 AS cdepval_customer_c_acctbal_0#7224, cdepval_customer_c_comment#7204 AS cdepval_customer_c_comment_0#7225, cdepval_customer_c_mktsegment#7205 AS cdepval_customer_c_mktsegment_0#7226, cc_name#7206 AS cc_name_0#7227, cc_address#7207 AS cc_address_0#7228, cc_phone#7208 AS cc_phone_0#7229, cc_acctbal#7209 AS cc_acctbal_0#7230, cc_comment#7210 AS cc_comment_0#7231, cc_mktsegment#7211 AS cc_mktsegment_0#7232]
            :  :     +- Relation[rid#7191,cpfk_nation_customer#7192,cfpk_customer_nation#7193,cval_customer_c_name#7194,cval_customer_c_address#7195,cval_customer_c_phone#7196,cval_customer_c_acctbal#7197,cval_customer_c_comment#7198,cval_customer_c_mktsegment#7199,cdepval_customer_c_name#7200,cdepval_customer_c_address#7201,cdepval_customer_c_phone#7202,cdepval_customer_c_acctbal#7203,cdepval_customer_c_comment#7204,cdepval_customer_c_mktsegment#7205,cc_name#7206,cc_address#7207,cc_phone#7208,cc_acctbal#7209,cc_comment#7210,cc_mktsegment#7211] JDBCRelation(tcustomer) [numPartitions=1]
            :  +- 'Project ['cpfk_customer_orders_1, 'rid_1]
            :     +- Project [rid#7365 AS rid_1#7389, cpfk_customer_orders#7366 AS cpfk_customer_orders_1#7390, cfpk_orders_customer#7367 AS cfpk_orders_customer_1#7391, cval_orders_o_orderstatus#7368 AS cval_orders_o_orderstatus_1#7392, cval_orders_o_totalprice#7369 AS cval_orders_o_totalprice_1#7393, cval_orders_o_orderpriority#7370 AS cval_orders_o_orderpriority_1#7394, cval_orders_o_clerk#7371 AS cval_orders_o_clerk_1#7395, cval_orders_o_shippriority#7372 AS cval_orders_o_shippriority_1#7396, cval_orders_o_comment#7373 AS cval_orders_o_comment_1#7397, cval_orders_o_orderdate#7374 AS cval_orders_o_orderdate_1#7398, cdepval_orders_o_orderstatus#7375 AS cdepval_orders_o_orderstatus_1#7399, cdepval_orders_o_totalprice#7376 AS cdepval_orders_o_totalprice_1#7400, cdepval_orders_o_orderpriority#7377 AS cdepval_orders_o_orderpriority_1#7401, cdepval_orders_o_clerk#7378 AS cdepval_orders_o_clerk_1#7402, cdepval_orders_o_shippriority#7379 AS cdepval_orders_o_shippriority_1#7403, cdepval_orders_o_comment#7380 AS cdepval_orders_o_comment_1#7404, cdepval_orders_o_orderdate#7381 AS cdepval_orders_o_orderdate_1#7405, co_orderstatus#7382 AS co_orderstatus_1#7406, co_totalprice#7383 AS co_totalprice_1#7407, co_orderpriority#7384 AS co_orderpriority_1#7408, co_clerk#7385 AS co_clerk_1#7409, co_shippriority#7386 AS co_shippriority_1#7410, co_comment#7387 AS co_comment_1#7411, co_orderdate#7388 AS co_orderdate_1#7412]
            :        +- Relation[rid#7365,cpfk_customer_orders#7366,cfpk_orders_customer#7367,cval_orders_o_orderstatus#7368,cval_orders_o_totalprice#7369,cval_orders_o_orderpriority#7370,cval_orders_o_clerk#7371,cval_orders_o_shippriority#7372,cval_orders_o_comment#7373,cval_orders_o_orderdate#7374,cdepval_orders_o_orderstatus#7375,cdepval_orders_o_totalprice#7376,cdepval_orders_o_orderpriority#7377,cdepval_orders_o_clerk#7378,cdepval_orders_o_shippriority#7379,cdepval_orders_o_comment#7380,cdepval_orders_o_orderdate#7381,co_orderstatus#7382,co_totalprice#7383,co_orderpriority#7384,co_clerk#7385,co_shippriority#7386,co_comment#7387,co_orderdate#7388] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#7275 AS rid_1#7299, cpfk_customer_orders#7276 AS cpfk_customer_orders_1#7300, cfpk_orders_customer#7277 AS cfpk_orders_customer_1#7301, cval_orders_o_orderstatus#7278 AS cval_orders_o_orderstatus_1#7302, cval_orders_o_totalprice#7279 AS cval_orders_o_totalprice_1#7303, cval_orders_o_orderpriority#7280 AS cval_orders_o_orderpriority_1#7304, cval_orders_o_clerk#7281 AS cval_orders_o_clerk_1#7305, cval_orders_o_shippriority#7282 AS cval_orders_o_shippriority_1#7306, cval_orders_o_comment#7283 AS cval_orders_o_comment_1#7307, cval_orders_o_orderdate#7284 AS cval_orders_o_orderdate_1#7308, cdepval_orders_o_orderstatus#7285 AS cdepval_orders_o_orderstatus_1#7309, cdepval_orders_o_totalprice#7286 AS cdepval_orders_o_totalprice_1#7310, cdepval_orders_o_orderpriority#7287 AS cdepval_orders_o_orderpriority_1#7311, cdepval_orders_o_clerk#7288 AS cdepval_orders_o_clerk_1#7312, cdepval_orders_o_shippriority#7289 AS cdepval_orders_o_shippriority_1#7313, cdepval_orders_o_comment#7290 AS cdepval_orders_o_comment_1#7314, cdepval_orders_o_orderdate#7291 AS cdepval_orders_o_orderdate_1#7315, co_orderstatus#7292 AS co_orderstatus_1#7316, co_totalprice#7293 AS co_totalprice_1#7317, co_orderpriority#7294 AS co_orderpriority_1#7318, co_clerk#7295 AS co_clerk_1#7319, co_shippriority#7296 AS co_shippriority_1#7320, co_comment#7297 AS co_comment_1#7321, co_orderdate#7298 AS co_orderdate_1#7322]
               +- Relation[rid#7275,cpfk_customer_orders#7276,cfpk_orders_customer#7277,cval_orders_o_orderstatus#7278,cval_orders_o_totalprice#7279,cval_orders_o_orderpriority#7280,cval_orders_o_clerk#7281,cval_orders_o_shippriority#7282,cval_orders_o_comment#7283,cval_orders_o_orderdate#7284,cdepval_orders_o_orderstatus#7285,cdepval_orders_o_totalprice#7286,cdepval_orders_o_orderpriority#7287,cdepval_orders_o_clerk#7288,cdepval_orders_o_shippriority#7289,cdepval_orders_o_comment#7290,cdepval_orders_o_orderdate#7291,co_orderstatus#7292,co_totalprice#7293,co_orderpriority#7294,co_clerk#7295,co_shippriority#7296,co_comment#7297,co_orderdate#7298] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 25719ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/26 22:35:11 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:35:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7605L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 22:35:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:35:11 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:35:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7605L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#7607 AS rid_0#7652, cpfk_orders_lineitem#7608 AS cpfk_orders_lineitem_0#7653, cpfk_supplier_lineitem#7609 AS cpfk_supplier_lineitem_0#7654, cfpk_lineitem_supplier#7610 AS cfpk_lineitem_supplier_0#7655, cfpk_lineitem_partsupp#7611 AS cfpk_lineitem_partsupp_0#7656, cpfk_part_lineitem#7612 AS cpfk_part_lineitem_0#7657, cfpk_lineitem_part#7613 AS cfpk_lineitem_part_0#7658, cpfk_partsupp_lineitem#7614 AS cpfk_partsupp_lineitem_0#7659, cfpk_lineitem_orders#7615 AS cfpk_lineitem_orders_0#7660, cval_lineitem_l_quantity#7616 AS cval_lineitem_l_quantity_0#7661, cval_lineitem_l_extendedprice#7617 AS cval_lineitem_l_extendedprice_0#7662, cval_lineitem_l_discount#7618 AS cval_lineitem_l_discount_0#7663, cval_lineitem_l_tax#7619 AS cval_lineitem_l_tax_0#7664, cval_lineitem_l_returnflag#7620 AS cval_lineitem_l_returnflag_0#7665, cval_lineitem_l_linestatus#7621 AS cval_lineitem_l_linestatus_0#7666, cval_lineitem_l_commitdate#7622 AS cval_lineitem_l_commitdate_0#7667, cval_lineitem_l_receiptdate#7623 AS cval_lineitem_l_receiptdate_0#7668, cval_lineitem_l_shipinstruct#7624 AS cval_lineitem_l_shipinstruct_0#7669, cval_lineitem_l_shipmode#7625 AS cval_lineitem_l_shipmode_0#7670, cval_lineitem_l_comment#7626 AS cval_lineitem_l_comment_0#7671, cval_lineitem_l_shipdate#7627 AS cval_lineitem_l_shipdate_0#7672, cdepval_lineitem_l_quantity#7628 AS cdepval_lineitem_l_quantity_0#7673, cdepval_lineitem_l_extendedprice#7629 AS cdepval_lineitem_l_extendedprice_0#7674, cdepval_lineitem_l_discount#7630 AS cdepval_lineitem_l_discount_0#7675, ... 21 more fields]
         :  :  :     +- Relation[rid#7607,cpfk_orders_lineitem#7608,cpfk_supplier_lineitem#7609,cfpk_lineitem_supplier#7610,cfpk_lineitem_partsupp#7611,cpfk_part_lineitem#7612,cfpk_lineitem_part#7613,cpfk_partsupp_lineitem#7614,cfpk_lineitem_orders#7615,cval_lineitem_l_quantity#7616,cval_lineitem_l_extendedprice#7617,cval_lineitem_l_discount#7618,cval_lineitem_l_tax#7619,cval_lineitem_l_returnflag#7620,cval_lineitem_l_linestatus#7621,cval_lineitem_l_commitdate#7622,cval_lineitem_l_receiptdate#7623,cval_lineitem_l_shipinstruct#7624,cval_lineitem_l_shipmode#7625,cval_lineitem_l_comment#7626,cval_lineitem_l_shipdate#7627,cdepval_lineitem_l_quantity#7628,cdepval_lineitem_l_extendedprice#7629,cdepval_lineitem_l_discount#7630,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#7787 AS rid_1#7811, cpfk_customer_orders#7788 AS cpfk_customer_orders_1#7812, cfpk_orders_customer#7789 AS cfpk_orders_customer_1#7813, cval_orders_o_orderstatus#7790 AS cval_orders_o_orderstatus_1#7814, cval_orders_o_totalprice#7791 AS cval_orders_o_totalprice_1#7815, cval_orders_o_orderpriority#7792 AS cval_orders_o_orderpriority_1#7816, cval_orders_o_clerk#7793 AS cval_orders_o_clerk_1#7817, cval_orders_o_shippriority#7794 AS cval_orders_o_shippriority_1#7818, cval_orders_o_comment#7795 AS cval_orders_o_comment_1#7819, cval_orders_o_orderdate#7796 AS cval_orders_o_orderdate_1#7820, cdepval_orders_o_orderstatus#7797 AS cdepval_orders_o_orderstatus_1#7821, cdepval_orders_o_totalprice#7798 AS cdepval_orders_o_totalprice_1#7822, cdepval_orders_o_orderpriority#7799 AS cdepval_orders_o_orderpriority_1#7823, cdepval_orders_o_clerk#7800 AS cdepval_orders_o_clerk_1#7824, cdepval_orders_o_shippriority#7801 AS cdepval_orders_o_shippriority_1#7825, cdepval_orders_o_comment#7802 AS cdepval_orders_o_comment_1#7826, cdepval_orders_o_orderdate#7803 AS cdepval_orders_o_orderdate_1#7827, co_orderstatus#7804 AS co_orderstatus_1#7828, co_totalprice#7805 AS co_totalprice_1#7829, co_orderpriority#7806 AS co_orderpriority_1#7830, co_clerk#7807 AS co_clerk_1#7831, co_shippriority#7808 AS co_shippriority_1#7832, co_comment#7809 AS co_comment_1#7833, co_orderdate#7810 AS co_orderdate_1#7834]
         :  :     +- Relation[rid#7787,cpfk_customer_orders#7788,cfpk_orders_customer#7789,cval_orders_o_orderstatus#7790,cval_orders_o_totalprice#7791,cval_orders_o_orderpriority#7792,cval_orders_o_clerk#7793,cval_orders_o_shippriority#7794,cval_orders_o_comment#7795,cval_orders_o_orderdate#7796,cdepval_orders_o_orderstatus#7797,cdepval_orders_o_totalprice#7798,cdepval_orders_o_orderpriority#7799,cdepval_orders_o_clerk#7800,cdepval_orders_o_shippriority#7801,cdepval_orders_o_comment#7802,cdepval_orders_o_orderdate#7803,co_orderstatus#7804,co_totalprice#7805,co_orderpriority#7806,co_clerk#7807,co_shippriority#7808,co_comment#7809,co_orderdate#7810] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#7835 AS rid_2#7856, cpfk_nation_customer#7836 AS cpfk_nation_customer_2#7857, cfpk_customer_nation#7837 AS cfpk_customer_nation_2#7858, cval_customer_c_name#7838 AS cval_customer_c_name_2#7859, cval_customer_c_address#7839 AS cval_customer_c_address_2#7860, cval_customer_c_phone#7840 AS cval_customer_c_phone_2#7861, cval_customer_c_acctbal#7841 AS cval_customer_c_acctbal_2#7862, cval_customer_c_comment#7842 AS cval_customer_c_comment_2#7863, cval_customer_c_mktsegment#7843 AS cval_customer_c_mktsegment_2#7864, cdepval_customer_c_name#7844 AS cdepval_customer_c_name_2#7865, cdepval_customer_c_address#7845 AS cdepval_customer_c_address_2#7866, cdepval_customer_c_phone#7846 AS cdepval_customer_c_phone_2#7867, cdepval_customer_c_acctbal#7847 AS cdepval_customer_c_acctbal_2#7868, cdepval_customer_c_comment#7848 AS cdepval_customer_c_comment_2#7869, cdepval_customer_c_mktsegment#7849 AS cdepval_customer_c_mktsegment_2#7870, cc_name#7850 AS cc_name_2#7871, cc_address#7851 AS cc_address_2#7872, cc_phone#7852 AS cc_phone_2#7873, cc_acctbal#7853 AS cc_acctbal_2#7874, cc_comment#7854 AS cc_comment_2#7875, cc_mktsegment#7855 AS cc_mktsegment_2#7876]
         :     +- Relation[rid#7835,cpfk_nation_customer#7836,cfpk_customer_nation#7837,cval_customer_c_name#7838,cval_customer_c_address#7839,cval_customer_c_phone#7840,cval_customer_c_acctbal#7841,cval_customer_c_comment#7842,cval_customer_c_mktsegment#7843,cdepval_customer_c_name#7844,cdepval_customer_c_address#7845,cdepval_customer_c_phone#7846,cdepval_customer_c_acctbal#7847,cdepval_customer_c_comment#7848,cdepval_customer_c_mktsegment#7849,cc_name#7850,cc_address#7851,cc_phone#7852,cc_acctbal#7853,cc_comment#7854,cc_mktsegment#7855] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#7877 AS rid_3#7886, cpfk_region_nation#7878 AS cpfk_region_nation_3#7887, cfpk_nation_region#7879 AS cfpk_nation_region_3#7888, cval_nation_n_name#7880 AS cval_nation_n_name_3#7889, cval_nation_n_comment#7881 AS cval_nation_n_comment_3#7890, cdepval_nation_n_name#7882 AS cdepval_nation_n_name_3#7891, cdepval_nation_n_comment#7883 AS cdepval_nation_n_comment_3#7892, cn_name#7884 AS cn_name_3#7893, cn_comment#7885 AS cn_comment_3#7894]
            +- Relation[rid#7877,cpfk_region_nation#7878,cfpk_nation_region#7879,cval_nation_n_name#7880,cval_nation_n_comment#7881,cdepval_nation_n_name#7882,cdepval_nation_n_comment#7883,cn_name#7884,cn_comment#7885] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 66926ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/26 22:36:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:36:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7999L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:36:18 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:36:18 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:36:18 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:36:18 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:36:18 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:36:18 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:36:18 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:36:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7999L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#8026, cval_part_p_name_0#8027, cval_part_p_mfgr_0#8028, cval_part_p_type_0#8029, cval_part_p_size_0#8030, cval_part_p_container_0#8031, cval_part_p_retailprice_0#8032, cval_part_p_comment_0#8033, cval_part_p_brand_0#8034, cdepval_part_p_name_0#8035, cdepval_part_p_mfgr_0#8036, cdepval_part_p_type_0#8037, cdepval_part_p_size_0#8038, cdepval_part_p_container_0#8039, cdepval_part_p_retailprice_0#8040, cdepval_part_p_comment_0#8041, cdepval_part_p_brand_0#8042, cp_name_0#8043, cp_mfgr_0#8044, cp_type_0#8045, cp_size_0#8046, cp_container_0#8047, cp_retailprice_0#8048, cp_comment_0#8049, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#8001 AS rid_0#8026, cval_part_p_name#8002 AS cval_part_p_name_0#8027, cval_part_p_mfgr#8003 AS cval_part_p_mfgr_0#8028, cval_part_p_type#8004 AS cval_part_p_type_0#8029, cval_part_p_size#8005 AS cval_part_p_size_0#8030, cval_part_p_container#8006 AS cval_part_p_container_0#8031, cval_part_p_retailprice#8007 AS cval_part_p_retailprice_0#8032, cval_part_p_comment#8008 AS cval_part_p_comment_0#8033, cval_part_p_brand#8009 AS cval_part_p_brand_0#8034, cdepval_part_p_name#8010 AS cdepval_part_p_name_0#8035, cdepval_part_p_mfgr#8011 AS cdepval_part_p_mfgr_0#8036, cdepval_part_p_type#8012 AS cdepval_part_p_type_0#8037, cdepval_part_p_size#8013 AS cdepval_part_p_size_0#8038, cdepval_part_p_container#8014 AS cdepval_part_p_container_0#8039, cdepval_part_p_retailprice#8015 AS cdepval_part_p_retailprice_0#8040, cdepval_part_p_comment#8016 AS cdepval_part_p_comment_0#8041, cdepval_part_p_brand#8017 AS cdepval_part_p_brand_0#8042, cp_name#8018 AS cp_name_0#8043, cp_mfgr#8019 AS cp_mfgr_0#8044, cp_type#8020 AS cp_type_0#8045, cp_size#8021 AS cp_size_0#8046, cp_container#8022 AS cp_container_0#8047, cp_retailprice#8023 AS cp_retailprice_0#8048, cp_comment#8024 AS cp_comment_0#8049, cp_brand#8025 AS cp_brand_0#8050]
         :  :        +- Relation[rid#8001,cval_part_p_name#8002,cval_part_p_mfgr#8003,cval_part_p_type#8004,cval_part_p_size#8005,cval_part_p_container#8006,cval_part_p_retailprice#8007,cval_part_p_comment#8008,cval_part_p_brand#8009,cdepval_part_p_name#8010,cdepval_part_p_mfgr#8011,cdepval_part_p_type#8012,cdepval_part_p_size#8013,cdepval_part_p_container#8014,cdepval_part_p_retailprice#8015,cdepval_part_p_comment#8016,cdepval_part_p_brand#8017,cp_name#8018,cp_mfgr#8019,cp_type#8020,cp_size#8021,cp_container#8022,cp_retailprice#8023,cp_comment#8024,cp_brand#8025] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#8471 AS rid_1#8516, cpfk_orders_lineitem#8472 AS cpfk_orders_lineitem_1#8517, cpfk_supplier_lineitem#8473 AS cpfk_supplier_lineitem_1#8518, cfpk_lineitem_supplier#8474 AS cfpk_lineitem_supplier_1#8519, cfpk_lineitem_partsupp#8475 AS cfpk_lineitem_partsupp_1#8520, cpfk_part_lineitem#8476 AS cpfk_part_lineitem_1#8521, cfpk_lineitem_part#8477 AS cfpk_lineitem_part_1#8522, cpfk_partsupp_lineitem#8478 AS cpfk_partsupp_lineitem_1#8523, cfpk_lineitem_orders#8479 AS cfpk_lineitem_orders_1#8524, cval_lineitem_l_quantity#8480 AS cval_lineitem_l_quantity_1#8525, cval_lineitem_l_extendedprice#8481 AS cval_lineitem_l_extendedprice_1#8526, cval_lineitem_l_discount#8482 AS cval_lineitem_l_discount_1#8527, cval_lineitem_l_tax#8483 AS cval_lineitem_l_tax_1#8528, cval_lineitem_l_returnflag#8484 AS cval_lineitem_l_returnflag_1#8529, cval_lineitem_l_linestatus#8485 AS cval_lineitem_l_linestatus_1#8530, cval_lineitem_l_commitdate#8486 AS cval_lineitem_l_commitdate_1#8531, cval_lineitem_l_receiptdate#8487 AS cval_lineitem_l_receiptdate_1#8532, cval_lineitem_l_shipinstruct#8488 AS cval_lineitem_l_shipinstruct_1#8533, cval_lineitem_l_shipmode#8489 AS cval_lineitem_l_shipmode_1#8534, cval_lineitem_l_comment#8490 AS cval_lineitem_l_comment_1#8535, cval_lineitem_l_shipdate#8491 AS cval_lineitem_l_shipdate_1#8536, cdepval_lineitem_l_quantity#8492 AS cdepval_lineitem_l_quantity_1#8537, cdepval_lineitem_l_extendedprice#8493 AS cdepval_lineitem_l_extendedprice_1#8538, cdepval_lineitem_l_discount#8494 AS cdepval_lineitem_l_discount_1#8539, ... 21 more fields]
         :        +- Relation[rid#8471,cpfk_orders_lineitem#8472,cpfk_supplier_lineitem#8473,cfpk_lineitem_supplier#8474,cfpk_lineitem_partsupp#8475,cpfk_part_lineitem#8476,cfpk_lineitem_part#8477,cpfk_partsupp_lineitem#8478,cfpk_lineitem_orders#8479,cval_lineitem_l_quantity#8480,cval_lineitem_l_extendedprice#8481,cval_lineitem_l_discount#8482,cval_lineitem_l_tax#8483,cval_lineitem_l_returnflag#8484,cval_lineitem_l_linestatus#8485,cval_lineitem_l_commitdate#8486,cval_lineitem_l_receiptdate#8487,cval_lineitem_l_shipinstruct#8488,cval_lineitem_l_shipmode#8489,cval_lineitem_l_comment#8490,cval_lineitem_l_shipdate#8491,cdepval_lineitem_l_quantity#8492,cdepval_lineitem_l_extendedprice#8493,cdepval_lineitem_l_discount#8494,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#8151 AS rid_1#8196, cpfk_orders_lineitem#8152 AS cpfk_orders_lineitem_1#8197, cpfk_supplier_lineitem#8153 AS cpfk_supplier_lineitem_1#8198, cfpk_lineitem_supplier#8154 AS cfpk_lineitem_supplier_1#8199, cfpk_lineitem_partsupp#8155 AS cfpk_lineitem_partsupp_1#8200, cpfk_part_lineitem#8156 AS cpfk_part_lineitem_1#8201, cfpk_lineitem_part#8157 AS cfpk_lineitem_part_1#8202, cpfk_partsupp_lineitem#8158 AS cpfk_partsupp_lineitem_1#8203, cfpk_lineitem_orders#8159 AS cfpk_lineitem_orders_1#8204, cval_lineitem_l_quantity#8160 AS cval_lineitem_l_quantity_1#8205, cval_lineitem_l_extendedprice#8161 AS cval_lineitem_l_extendedprice_1#8206, cval_lineitem_l_discount#8162 AS cval_lineitem_l_discount_1#8207, cval_lineitem_l_tax#8163 AS cval_lineitem_l_tax_1#8208, cval_lineitem_l_returnflag#8164 AS cval_lineitem_l_returnflag_1#8209, cval_lineitem_l_linestatus#8165 AS cval_lineitem_l_linestatus_1#8210, cval_lineitem_l_commitdate#8166 AS cval_lineitem_l_commitdate_1#8211, cval_lineitem_l_receiptdate#8167 AS cval_lineitem_l_receiptdate_1#8212, cval_lineitem_l_shipinstruct#8168 AS cval_lineitem_l_shipinstruct_1#8213, cval_lineitem_l_shipmode#8169 AS cval_lineitem_l_shipmode_1#8214, cval_lineitem_l_comment#8170 AS cval_lineitem_l_comment_1#8215, cval_lineitem_l_shipdate#8171 AS cval_lineitem_l_shipdate_1#8216, cdepval_lineitem_l_quantity#8172 AS cdepval_lineitem_l_quantity_1#8217, cdepval_lineitem_l_extendedprice#8173 AS cdepval_lineitem_l_extendedprice_1#8218, cdepval_lineitem_l_discount#8174 AS cdepval_lineitem_l_discount_1#8219, ... 21 more fields]
                  +- Relation[rid#8151,cpfk_orders_lineitem#8152,cpfk_supplier_lineitem#8153,cfpk_lineitem_supplier#8154,cfpk_lineitem_partsupp#8155,cpfk_part_lineitem#8156,cfpk_lineitem_part#8157,cpfk_partsupp_lineitem#8158,cfpk_lineitem_orders#8159,cval_lineitem_l_quantity#8160,cval_lineitem_l_extendedprice#8161,cval_lineitem_l_discount#8162,cval_lineitem_l_tax#8163,cval_lineitem_l_returnflag#8164,cval_lineitem_l_linestatus#8165,cval_lineitem_l_commitdate#8166,cval_lineitem_l_receiptdate#8167,cval_lineitem_l_shipinstruct#8168,cval_lineitem_l_shipmode#8169,cval_lineitem_l_comment#8170,cval_lineitem_l_shipdate#8171,cdepval_lineitem_l_quantity#8172,cdepval_lineitem_l_extendedprice#8173,cdepval_lineitem_l_discount#8174,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 17928ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/26 22:36:36 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:36:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8635L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 22:36:36 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:36:36 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:36:36 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:36:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:36:36 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:36:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:36:36 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:36:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:36:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:36:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:36:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:36:36 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:36:36 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:36:36 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:36:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:36:36 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:36:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8635L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#8776, cval_part_p_name_3#8777, cval_part_p_mfgr_3#8778, cval_part_p_type_3#8779, cval_part_p_size_3#8780, cval_part_p_container_3#8781, cval_part_p_retailprice_3#8782, cval_part_p_comment_3#8783, cval_part_p_brand_3#8784, cdepval_part_p_name_3#8785, cdepval_part_p_mfgr_3#8786, cdepval_part_p_type_3#8787, cdepval_part_p_size_3#8788, cdepval_part_p_container_3#8789, cdepval_part_p_retailprice_3#8790, cdepval_part_p_comment_3#8791, cdepval_part_p_brand_3#8792, cp_name_3#8793, cp_mfgr_3#8794, cp_type_3#8795, cp_size_3#8796, cp_container_3#8797, cp_retailprice_3#8798, cp_comment_3#8799, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :  :  :  +- Project [rid#8751 AS rid_3#8776, cval_part_p_name#8752 AS cval_part_p_name_3#8777, cval_part_p_mfgr#8753 AS cval_part_p_mfgr_3#8778, cval_part_p_type#8754 AS cval_part_p_type_3#8779, cval_part_p_size#8755 AS cval_part_p_size_3#8780, cval_part_p_container#8756 AS cval_part_p_container_3#8781, cval_part_p_retailprice#8757 AS cval_part_p_retailprice_3#8782, cval_part_p_comment#8758 AS cval_part_p_comment_3#8783, cval_part_p_brand#8759 AS cval_part_p_brand_3#8784, cdepval_part_p_name#8760 AS cdepval_part_p_name_3#8785, cdepval_part_p_mfgr#8761 AS cdepval_part_p_mfgr_3#8786, cdepval_part_p_type#8762 AS cdepval_part_p_type_3#8787, cdepval_part_p_size#8763 AS cdepval_part_p_size_3#8788, cdepval_part_p_container#8764 AS cdepval_part_p_container_3#8789, cdepval_part_p_retailprice#8765 AS cdepval_part_p_retailprice_3#8790, cdepval_part_p_comment#8766 AS cdepval_part_p_comment_3#8791, cdepval_part_p_brand#8767 AS cdepval_part_p_brand_3#8792, cp_name#8768 AS cp_name_3#8793, cp_mfgr#8769 AS cp_mfgr_3#8794, cp_type#8770 AS cp_type_3#8795, cp_size#8771 AS cp_size_3#8796, cp_container#8772 AS cp_container_3#8797, cp_retailprice#8773 AS cp_retailprice_3#8798, cp_comment#8774 AS cp_comment_3#8799, cp_brand#8775 AS cp_brand_3#8800]
         :  :  :     +- Relation[rid#8751,cval_part_p_name#8752,cval_part_p_mfgr#8753,cval_part_p_type#8754,cval_part_p_size#8755,cval_part_p_container#8756,cval_part_p_retailprice#8757,cval_part_p_comment#8758,cval_part_p_brand#8759,cdepval_part_p_name#8760,cdepval_part_p_mfgr#8761,cdepval_part_p_type#8762,cdepval_part_p_size#8763,cdepval_part_p_container#8764,cdepval_part_p_retailprice#8765,cdepval_part_p_comment#8766,cdepval_part_p_brand#8767,cp_name#8768,cp_mfgr#8769,cp_type#8770,cp_size#8771,cp_container#8772,cp_retailprice#8773,cp_comment#8774,cp_brand#8775] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_4, 'rid_4]
         :  :     +- Project [rid#8929 AS rid_4#8943, cpfk_part_partsupp#8930 AS cpfk_part_partsupp_4#8944, cfpk_partsupp_part#8931 AS cfpk_partsupp_part_4#8945, cpfk_supplier_partsupp#8932 AS cpfk_supplier_partsupp_4#8946, cfpk_partsupp_supplier#8933 AS cfpk_partsupp_supplier_4#8947, cval_partsupp_ps_availqty#8934 AS cval_partsupp_ps_availqty_4#8948, cval_partsupp_ps_supplycost#8935 AS cval_partsupp_ps_supplycost_4#8949, cval_partsupp_ps_comment#8936 AS cval_partsupp_ps_comment_4#8950, cdepval_partsupp_ps_availqty#8937 AS cdepval_partsupp_ps_availqty_4#8951, cdepval_partsupp_ps_supplycost#8938 AS cdepval_partsupp_ps_supplycost_4#8952, cdepval_partsupp_ps_comment#8939 AS cdepval_partsupp_ps_comment_4#8953, cps_availqty#8940 AS cps_availqty_4#8954, cps_supplycost#8941 AS cps_supplycost_4#8955, cps_comment#8942 AS cps_comment_4#8956]
         :  :        +- Relation[rid#8929,cpfk_part_partsupp#8930,cfpk_partsupp_part#8931,cpfk_supplier_partsupp#8932,cfpk_partsupp_supplier#8933,cval_partsupp_ps_availqty#8934,cval_partsupp_ps_supplycost#8935,cval_partsupp_ps_comment#8936,cdepval_partsupp_ps_availqty#8937,cdepval_partsupp_ps_supplycost#8938,cdepval_partsupp_ps_comment#8939,cps_availqty#8940,cps_supplycost#8941,cps_comment#8942] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#8851 AS rid_4#8865, cpfk_part_partsupp#8852 AS cpfk_part_partsupp_4#8866, cfpk_partsupp_part#8853 AS cfpk_partsupp_part_4#8867, cpfk_supplier_partsupp#8854 AS cpfk_supplier_partsupp_4#8868, cfpk_partsupp_supplier#8855 AS cfpk_partsupp_supplier_4#8869, cval_partsupp_ps_availqty#8856 AS cval_partsupp_ps_availqty_4#8870, cval_partsupp_ps_supplycost#8857 AS cval_partsupp_ps_supplycost_4#8871, cval_partsupp_ps_comment#8858 AS cval_partsupp_ps_comment_4#8872, cdepval_partsupp_ps_availqty#8859 AS cdepval_partsupp_ps_availqty_4#8873, cdepval_partsupp_ps_supplycost#8860 AS cdepval_partsupp_ps_supplycost_4#8874, cdepval_partsupp_ps_comment#8861 AS cdepval_partsupp_ps_comment_4#8875, cps_availqty#8862 AS cps_availqty_4#8876, cps_supplycost#8863 AS cps_supplycost_4#8877, cps_comment#8864 AS cps_comment_4#8878]
         :     +- Relation[rid#8851,cpfk_part_partsupp#8852,cfpk_partsupp_part#8853,cpfk_supplier_partsupp#8854,cfpk_partsupp_supplier#8855,cval_partsupp_ps_availqty#8856,cval_partsupp_ps_supplycost#8857,cval_partsupp_ps_comment#8858,cdepval_partsupp_ps_availqty#8859,cdepval_partsupp_ps_supplycost#8860,cdepval_partsupp_ps_comment#8861,cps_availqty#8862,cps_supplycost#8863,cps_comment#8864] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#8715 AS rid_2#8733, cpfk_nation_supplier#8716 AS cpfk_nation_supplier_2#8734, cfpk_supplier_nation#8717 AS cfpk_supplier_nation_2#8735, cval_supplier_s_name#8718 AS cval_supplier_s_name_2#8736, cval_supplier_s_address#8719 AS cval_supplier_s_address_2#8737, cval_supplier_s_phone#8720 AS cval_supplier_s_phone_2#8738, cval_supplier_s_acctbal#8721 AS cval_supplier_s_acctbal_2#8739, cval_supplier_s_comment#8722 AS cval_supplier_s_comment_2#8740, cdepval_supplier_s_name#8723 AS cdepval_supplier_s_name_2#8741, cdepval_supplier_s_address#8724 AS cdepval_supplier_s_address_2#8742, cdepval_supplier_s_phone#8725 AS cdepval_supplier_s_phone_2#8743, cdepval_supplier_s_acctbal#8726 AS cdepval_supplier_s_acctbal_2#8744, cdepval_supplier_s_comment#8727 AS cdepval_supplier_s_comment_2#8745, cs_name#8728 AS cs_name_2#8746, cs_address#8729 AS cs_address_2#8747, cs_phone#8730 AS cs_phone_2#8748, cs_acctbal#8731 AS cs_acctbal_2#8749, cs_comment#8732 AS cs_comment_2#8750]
            :  +- Relation[rid#8715,cpfk_nation_supplier#8716,cfpk_supplier_nation#8717,cval_supplier_s_name#8718,cval_supplier_s_address#8719,cval_supplier_s_phone#8720,cval_supplier_s_acctbal#8721,cval_supplier_s_comment#8722,cdepval_supplier_s_name#8723,cdepval_supplier_s_address#8724,cdepval_supplier_s_phone#8725,cdepval_supplier_s_acctbal#8726,cdepval_supplier_s_comment#8727,cs_name#8728,cs_address#8729,cs_phone#8730,cs_acctbal#8731,cs_comment#8732] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_1))
               :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#8644, cval_region_r_name_0#8645, cval_region_r_comment_0#8646, cdepval_region_r_name_0#8647, cdepval_region_r_comment_0#8648, cr_name_0#8649, cr_comment_0#8650, 'rid_1]
               :  :- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
               :  :  +- Project [rid#8637 AS rid_0#8644, cval_region_r_name#8638 AS cval_region_r_name_0#8645, cval_region_r_comment#8639 AS cval_region_r_comment_0#8646, cdepval_region_r_name#8640 AS cdepval_region_r_name_0#8647, cdepval_region_r_comment#8641 AS cdepval_region_r_comment_0#8648, cr_name#8642 AS cr_name_0#8649, cr_comment#8643 AS cr_comment_0#8650]
               :  :     +- Relation[rid#8637,cval_region_r_name#8638,cval_region_r_comment#8639,cdepval_region_r_name#8640,cdepval_region_r_comment#8641,cr_name#8642,cr_comment#8643] JDBCRelation(tregion) [numPartitions=1]
               :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
               :     +- Project [rid#8697 AS rid_1#8706, cpfk_region_nation#8698 AS cpfk_region_nation_1#8707, cfpk_nation_region#8699 AS cfpk_nation_region_1#8708, cval_nation_n_name#8700 AS cval_nation_n_name_1#8709, cval_nation_n_comment#8701 AS cval_nation_n_comment_1#8710, cdepval_nation_n_name#8702 AS cdepval_nation_n_name_1#8711, cdepval_nation_n_comment#8703 AS cdepval_nation_n_comment_1#8712, cn_name#8704 AS cn_name_1#8713, cn_comment#8705 AS cn_comment_1#8714]
               :        +- Relation[rid#8697,cpfk_region_nation#8698,cfpk_nation_region#8699,cval_nation_n_name#8700,cval_nation_n_comment#8701,cdepval_nation_n_name#8702,cdepval_nation_n_comment#8703,cn_name#8704,cn_comment#8705] JDBCRelation(tnation) [numPartitions=1]
               +- Project [rid#8665 AS rid_1#8674, cpfk_region_nation#8666 AS cpfk_region_nation_1#8675, cfpk_nation_region#8667 AS cfpk_nation_region_1#8676, cval_nation_n_name#8668 AS cval_nation_n_name_1#8677, cval_nation_n_comment#8669 AS cval_nation_n_comment_1#8678, cdepval_nation_n_name#8670 AS cdepval_nation_n_name_1#8679, cdepval_nation_n_comment#8671 AS cdepval_nation_n_comment_1#8680, cn_name#8672 AS cn_name_1#8681, cn_comment#8673 AS cn_comment_1#8682]
                  +- Relation[rid#8665,cpfk_region_nation#8666,cfpk_nation_region#8667,cval_nation_n_name#8668,cval_nation_n_comment#8669,cdepval_nation_n_name#8670,cdepval_nation_n_comment#8671,cn_name#8672,cn_comment#8673] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 1051ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/26 22:36:37 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:36:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9034L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:36:37 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:36:37 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:36:37 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:36:37 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:36:37 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:36:37 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:36:37 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:36:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9034L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#9061, cval_part_p_name_0#9062, cval_part_p_mfgr_0#9063, cval_part_p_type_0#9064, cval_part_p_size_0#9065, cval_part_p_container_0#9066, cval_part_p_retailprice_0#9067, cval_part_p_comment_0#9068, cval_part_p_brand_0#9069, cdepval_part_p_name_0#9070, cdepval_part_p_mfgr_0#9071, cdepval_part_p_type_0#9072, cdepval_part_p_size_0#9073, cdepval_part_p_container_0#9074, cdepval_part_p_retailprice_0#9075, cdepval_part_p_comment_0#9076, cdepval_part_p_brand_0#9077, cp_name_0#9078, cp_mfgr_0#9079, cp_type_0#9080, cp_size_0#9081, cp_container_0#9082, cp_retailprice_0#9083, cp_comment_0#9084, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#9036 AS rid_0#9061, cval_part_p_name#9037 AS cval_part_p_name_0#9062, cval_part_p_mfgr#9038 AS cval_part_p_mfgr_0#9063, cval_part_p_type#9039 AS cval_part_p_type_0#9064, cval_part_p_size#9040 AS cval_part_p_size_0#9065, cval_part_p_container#9041 AS cval_part_p_container_0#9066, cval_part_p_retailprice#9042 AS cval_part_p_retailprice_0#9067, cval_part_p_comment#9043 AS cval_part_p_comment_0#9068, cval_part_p_brand#9044 AS cval_part_p_brand_0#9069, cdepval_part_p_name#9045 AS cdepval_part_p_name_0#9070, cdepval_part_p_mfgr#9046 AS cdepval_part_p_mfgr_0#9071, cdepval_part_p_type#9047 AS cdepval_part_p_type_0#9072, cdepval_part_p_size#9048 AS cdepval_part_p_size_0#9073, cdepval_part_p_container#9049 AS cdepval_part_p_container_0#9074, cdepval_part_p_retailprice#9050 AS cdepval_part_p_retailprice_0#9075, cdepval_part_p_comment#9051 AS cdepval_part_p_comment_0#9076, cdepval_part_p_brand#9052 AS cdepval_part_p_brand_0#9077, cp_name#9053 AS cp_name_0#9078, cp_mfgr#9054 AS cp_mfgr_0#9079, cp_type#9055 AS cp_type_0#9080, cp_size#9056 AS cp_size_0#9081, cp_container#9057 AS cp_container_0#9082, cp_retailprice#9058 AS cp_retailprice_0#9083, cp_comment#9059 AS cp_comment_0#9084, cp_brand#9060 AS cp_brand_0#9085]
         :  :        +- Relation[rid#9036,cval_part_p_name#9037,cval_part_p_mfgr#9038,cval_part_p_type#9039,cval_part_p_size#9040,cval_part_p_container#9041,cval_part_p_retailprice#9042,cval_part_p_comment#9043,cval_part_p_brand#9044,cdepval_part_p_name#9045,cdepval_part_p_mfgr#9046,cdepval_part_p_type#9047,cdepval_part_p_size#9048,cdepval_part_p_container#9049,cdepval_part_p_retailprice#9050,cdepval_part_p_comment#9051,cdepval_part_p_brand#9052,cp_name#9053,cp_mfgr#9054,cp_type#9055,cp_size#9056,cp_container#9057,cp_retailprice#9058,cp_comment#9059,cp_brand#9060] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#9326 AS rid_1#9371, cpfk_orders_lineitem#9327 AS cpfk_orders_lineitem_1#9372, cpfk_supplier_lineitem#9328 AS cpfk_supplier_lineitem_1#9373, cfpk_lineitem_supplier#9329 AS cfpk_lineitem_supplier_1#9374, cfpk_lineitem_partsupp#9330 AS cfpk_lineitem_partsupp_1#9375, cpfk_part_lineitem#9331 AS cpfk_part_lineitem_1#9376, cfpk_lineitem_part#9332 AS cfpk_lineitem_part_1#9377, cpfk_partsupp_lineitem#9333 AS cpfk_partsupp_lineitem_1#9378, cfpk_lineitem_orders#9334 AS cfpk_lineitem_orders_1#9379, cval_lineitem_l_quantity#9335 AS cval_lineitem_l_quantity_1#9380, cval_lineitem_l_extendedprice#9336 AS cval_lineitem_l_extendedprice_1#9381, cval_lineitem_l_discount#9337 AS cval_lineitem_l_discount_1#9382, cval_lineitem_l_tax#9338 AS cval_lineitem_l_tax_1#9383, cval_lineitem_l_returnflag#9339 AS cval_lineitem_l_returnflag_1#9384, cval_lineitem_l_linestatus#9340 AS cval_lineitem_l_linestatus_1#9385, cval_lineitem_l_commitdate#9341 AS cval_lineitem_l_commitdate_1#9386, cval_lineitem_l_receiptdate#9342 AS cval_lineitem_l_receiptdate_1#9387, cval_lineitem_l_shipinstruct#9343 AS cval_lineitem_l_shipinstruct_1#9388, cval_lineitem_l_shipmode#9344 AS cval_lineitem_l_shipmode_1#9389, cval_lineitem_l_comment#9345 AS cval_lineitem_l_comment_1#9390, cval_lineitem_l_shipdate#9346 AS cval_lineitem_l_shipdate_1#9391, cdepval_lineitem_l_quantity#9347 AS cdepval_lineitem_l_quantity_1#9392, cdepval_lineitem_l_extendedprice#9348 AS cdepval_lineitem_l_extendedprice_1#9393, cdepval_lineitem_l_discount#9349 AS cdepval_lineitem_l_discount_1#9394, ... 21 more fields]
         :        +- Relation[rid#9326,cpfk_orders_lineitem#9327,cpfk_supplier_lineitem#9328,cfpk_lineitem_supplier#9329,cfpk_lineitem_partsupp#9330,cpfk_part_lineitem#9331,cfpk_lineitem_part#9332,cpfk_partsupp_lineitem#9333,cfpk_lineitem_orders#9334,cval_lineitem_l_quantity#9335,cval_lineitem_l_extendedprice#9336,cval_lineitem_l_discount#9337,cval_lineitem_l_tax#9338,cval_lineitem_l_returnflag#9339,cval_lineitem_l_linestatus#9340,cval_lineitem_l_commitdate#9341,cval_lineitem_l_receiptdate#9342,cval_lineitem_l_shipinstruct#9343,cval_lineitem_l_shipmode#9344,cval_lineitem_l_comment#9345,cval_lineitem_l_shipdate#9346,cdepval_lineitem_l_quantity#9347,cdepval_lineitem_l_extendedprice#9348,cdepval_lineitem_l_discount#9349,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#9186 AS rid_1#9231, cpfk_orders_lineitem#9187 AS cpfk_orders_lineitem_1#9232, cpfk_supplier_lineitem#9188 AS cpfk_supplier_lineitem_1#9233, cfpk_lineitem_supplier#9189 AS cfpk_lineitem_supplier_1#9234, cfpk_lineitem_partsupp#9190 AS cfpk_lineitem_partsupp_1#9235, cpfk_part_lineitem#9191 AS cpfk_part_lineitem_1#9236, cfpk_lineitem_part#9192 AS cfpk_lineitem_part_1#9237, cpfk_partsupp_lineitem#9193 AS cpfk_partsupp_lineitem_1#9238, cfpk_lineitem_orders#9194 AS cfpk_lineitem_orders_1#9239, cval_lineitem_l_quantity#9195 AS cval_lineitem_l_quantity_1#9240, cval_lineitem_l_extendedprice#9196 AS cval_lineitem_l_extendedprice_1#9241, cval_lineitem_l_discount#9197 AS cval_lineitem_l_discount_1#9242, cval_lineitem_l_tax#9198 AS cval_lineitem_l_tax_1#9243, cval_lineitem_l_returnflag#9199 AS cval_lineitem_l_returnflag_1#9244, cval_lineitem_l_linestatus#9200 AS cval_lineitem_l_linestatus_1#9245, cval_lineitem_l_commitdate#9201 AS cval_lineitem_l_commitdate_1#9246, cval_lineitem_l_receiptdate#9202 AS cval_lineitem_l_receiptdate_1#9247, cval_lineitem_l_shipinstruct#9203 AS cval_lineitem_l_shipinstruct_1#9248, cval_lineitem_l_shipmode#9204 AS cval_lineitem_l_shipmode_1#9249, cval_lineitem_l_comment#9205 AS cval_lineitem_l_comment_1#9250, cval_lineitem_l_shipdate#9206 AS cval_lineitem_l_shipdate_1#9251, cdepval_lineitem_l_quantity#9207 AS cdepval_lineitem_l_quantity_1#9252, cdepval_lineitem_l_extendedprice#9208 AS cdepval_lineitem_l_extendedprice_1#9253, cdepval_lineitem_l_discount#9209 AS cdepval_lineitem_l_discount_1#9254, ... 21 more fields]
            +- Relation[rid#9186,cpfk_orders_lineitem#9187,cpfk_supplier_lineitem#9188,cfpk_lineitem_supplier#9189,cfpk_lineitem_partsupp#9190,cpfk_part_lineitem#9191,cfpk_lineitem_part#9192,cpfk_partsupp_lineitem#9193,cfpk_lineitem_orders#9194,cval_lineitem_l_quantity#9195,cval_lineitem_l_extendedprice#9196,cval_lineitem_l_discount#9197,cval_lineitem_l_tax#9198,cval_lineitem_l_returnflag#9199,cval_lineitem_l_linestatus#9200,cval_lineitem_l_commitdate#9201,cval_lineitem_l_receiptdate#9202,cval_lineitem_l_shipinstruct#9203,cval_lineitem_l_shipmode#9204,cval_lineitem_l_comment#9205,cval_lineitem_l_shipdate#9206,cdepval_lineitem_l_quantity#9207,cdepval_lineitem_l_extendedprice#9208,cdepval_lineitem_l_discount#9209,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 556ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/26 22:36:37 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:36:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9491L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 22:36:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9491L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#9493 AS rid_0#9517, cpfk_customer_orders#9494 AS cpfk_customer_orders_0#9518, cfpk_orders_customer#9495 AS cfpk_orders_customer_0#9519, cval_orders_o_orderstatus#9496 AS cval_orders_o_orderstatus_0#9520, cval_orders_o_totalprice#9497 AS cval_orders_o_totalprice_0#9521, cval_orders_o_orderpriority#9498 AS cval_orders_o_orderpriority_0#9522, cval_orders_o_clerk#9499 AS cval_orders_o_clerk_0#9523, cval_orders_o_shippriority#9500 AS cval_orders_o_shippriority_0#9524, cval_orders_o_comment#9501 AS cval_orders_o_comment_0#9525, cval_orders_o_orderdate#9502 AS cval_orders_o_orderdate_0#9526, cdepval_orders_o_orderstatus#9503 AS cdepval_orders_o_orderstatus_0#9527, cdepval_orders_o_totalprice#9504 AS cdepval_orders_o_totalprice_0#9528, cdepval_orders_o_orderpriority#9505 AS cdepval_orders_o_orderpriority_0#9529, cdepval_orders_o_clerk#9506 AS cdepval_orders_o_clerk_0#9530, cdepval_orders_o_shippriority#9507 AS cdepval_orders_o_shippriority_0#9531, cdepval_orders_o_comment#9508 AS cdepval_orders_o_comment_0#9532, cdepval_orders_o_orderdate#9509 AS cdepval_orders_o_orderdate_0#9533, co_orderstatus#9510 AS co_orderstatus_0#9534, co_totalprice#9511 AS co_totalprice_0#9535, co_orderpriority#9512 AS co_orderpriority_0#9536, co_clerk#9513 AS co_clerk_0#9537, co_shippriority#9514 AS co_shippriority_0#9538, co_comment#9515 AS co_comment_0#9539, co_orderdate#9516 AS co_orderdate_0#9540]
         :  +- Relation[rid#9493,cpfk_customer_orders#9494,cfpk_orders_customer#9495,cval_orders_o_orderstatus#9496,cval_orders_o_totalprice#9497,cval_orders_o_orderpriority#9498,cval_orders_o_clerk#9499,cval_orders_o_shippriority#9500,cval_orders_o_comment#9501,cval_orders_o_orderdate#9502,cdepval_orders_o_orderstatus#9503,cdepval_orders_o_totalprice#9504,cdepval_orders_o_orderpriority#9505,cdepval_orders_o_clerk#9506,cdepval_orders_o_shippriority#9507,cdepval_orders_o_comment#9508,cdepval_orders_o_orderdate#9509,co_orderstatus#9510,co_totalprice#9511,co_orderpriority#9512,co_clerk#9513,co_shippriority#9514,co_comment#9515,co_orderdate#9516] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#9541 AS rid_1#9562, cpfk_nation_customer#9542 AS cpfk_nation_customer_1#9563, cfpk_customer_nation#9543 AS cfpk_customer_nation_1#9564, cval_customer_c_name#9544 AS cval_customer_c_name_1#9565, cval_customer_c_address#9545 AS cval_customer_c_address_1#9566, cval_customer_c_phone#9546 AS cval_customer_c_phone_1#9567, cval_customer_c_acctbal#9547 AS cval_customer_c_acctbal_1#9568, cval_customer_c_comment#9548 AS cval_customer_c_comment_1#9569, cval_customer_c_mktsegment#9549 AS cval_customer_c_mktsegment_1#9570, cdepval_customer_c_name#9550 AS cdepval_customer_c_name_1#9571, cdepval_customer_c_address#9551 AS cdepval_customer_c_address_1#9572, cdepval_customer_c_phone#9552 AS cdepval_customer_c_phone_1#9573, cdepval_customer_c_acctbal#9553 AS cdepval_customer_c_acctbal_1#9574, cdepval_customer_c_comment#9554 AS cdepval_customer_c_comment_1#9575, cdepval_customer_c_mktsegment#9555 AS cdepval_customer_c_mktsegment_1#9576, cc_name#9556 AS cc_name_1#9577, cc_address#9557 AS cc_address_1#9578, cc_phone#9558 AS cc_phone_1#9579, cc_acctbal#9559 AS cc_acctbal_1#9580, cc_comment#9560 AS cc_comment_1#9581, cc_mktsegment#9561 AS cc_mktsegment_1#9582]
            +- Relation[rid#9541,cpfk_nation_customer#9542,cfpk_customer_nation#9543,cval_customer_c_name#9544,cval_customer_c_address#9545,cval_customer_c_phone#9546,cval_customer_c_acctbal#9547,cval_customer_c_comment#9548,cval_customer_c_mktsegment#9549,cdepval_customer_c_name#9550,cdepval_customer_c_address#9551,cdepval_customer_c_phone#9552,cdepval_customer_c_acctbal#9553,cdepval_customer_c_comment#9554,cdepval_customer_c_mktsegment#9555,cc_name#9556,cc_address#9557,cc_phone#9558,cc_acctbal#9559,cc_comment#9560,cc_mktsegment#9561] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4653ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 22:36:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:36:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9637L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:36:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:36:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:36:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:36:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:36:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:36:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:36:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:36:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:36:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:36:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:36:42 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:36:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9637L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#9771 AS rid_4#9816, cpfk_orders_lineitem#9772 AS cpfk_orders_lineitem_4#9817, cpfk_supplier_lineitem#9773 AS cpfk_supplier_lineitem_4#9818, cfpk_lineitem_supplier#9774 AS cfpk_lineitem_supplier_4#9819, cfpk_lineitem_partsupp#9775 AS cfpk_lineitem_partsupp_4#9820, cpfk_part_lineitem#9776 AS cpfk_part_lineitem_4#9821, cfpk_lineitem_part#9777 AS cfpk_lineitem_part_4#9822, cpfk_partsupp_lineitem#9778 AS cpfk_partsupp_lineitem_4#9823, cfpk_lineitem_orders#9779 AS cfpk_lineitem_orders_4#9824, cval_lineitem_l_quantity#9780 AS cval_lineitem_l_quantity_4#9825, cval_lineitem_l_extendedprice#9781 AS cval_lineitem_l_extendedprice_4#9826, cval_lineitem_l_discount#9782 AS cval_lineitem_l_discount_4#9827, cval_lineitem_l_tax#9783 AS cval_lineitem_l_tax_4#9828, cval_lineitem_l_returnflag#9784 AS cval_lineitem_l_returnflag_4#9829, cval_lineitem_l_linestatus#9785 AS cval_lineitem_l_linestatus_4#9830, cval_lineitem_l_commitdate#9786 AS cval_lineitem_l_commitdate_4#9831, cval_lineitem_l_receiptdate#9787 AS cval_lineitem_l_receiptdate_4#9832, cval_lineitem_l_shipinstruct#9788 AS cval_lineitem_l_shipinstruct_4#9833, cval_lineitem_l_shipmode#9789 AS cval_lineitem_l_shipmode_4#9834, cval_lineitem_l_comment#9790 AS cval_lineitem_l_comment_4#9835, cval_lineitem_l_shipdate#9791 AS cval_lineitem_l_shipdate_4#9836, cdepval_lineitem_l_quantity#9792 AS cdepval_lineitem_l_quantity_4#9837, cdepval_lineitem_l_extendedprice#9793 AS cdepval_lineitem_l_extendedprice_4#9838, cdepval_lineitem_l_discount#9794 AS cdepval_lineitem_l_discount_4#9839, ... 21 more fields]
         :  :  +- Relation[rid#9771,cpfk_orders_lineitem#9772,cpfk_supplier_lineitem#9773,cfpk_lineitem_supplier#9774,cfpk_lineitem_partsupp#9775,cpfk_part_lineitem#9776,cfpk_lineitem_part#9777,cpfk_partsupp_lineitem#9778,cfpk_lineitem_orders#9779,cval_lineitem_l_quantity#9780,cval_lineitem_l_extendedprice#9781,cval_lineitem_l_discount#9782,cval_lineitem_l_tax#9783,cval_lineitem_l_returnflag#9784,cval_lineitem_l_linestatus#9785,cval_lineitem_l_commitdate#9786,cval_lineitem_l_receiptdate#9787,cval_lineitem_l_shipinstruct#9788,cval_lineitem_l_shipmode#9789,cval_lineitem_l_comment#9790,cval_lineitem_l_shipdate#9791,cdepval_lineitem_l_quantity#9792,cdepval_lineitem_l_extendedprice#9793,cdepval_lineitem_l_discount#9794,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#9693 AS rid_2#9707, cpfk_part_partsupp#9694 AS cpfk_part_partsupp_2#9708, cfpk_partsupp_part#9695 AS cfpk_partsupp_part_2#9709, cpfk_supplier_partsupp#9696 AS cpfk_supplier_partsupp_2#9710, cfpk_partsupp_supplier#9697 AS cfpk_partsupp_supplier_2#9711, cval_partsupp_ps_availqty#9698 AS cval_partsupp_ps_availqty_2#9712, cval_partsupp_ps_supplycost#9699 AS cval_partsupp_ps_supplycost_2#9713, cval_partsupp_ps_comment#9700 AS cval_partsupp_ps_comment_2#9714, cdepval_partsupp_ps_availqty#9701 AS cdepval_partsupp_ps_availqty_2#9715, cdepval_partsupp_ps_supplycost#9702 AS cdepval_partsupp_ps_supplycost_2#9716, cdepval_partsupp_ps_comment#9703 AS cdepval_partsupp_ps_comment_2#9717, cps_availqty#9704 AS cps_availqty_2#9718, cps_supplycost#9705 AS cps_supplycost_2#9719, cps_comment#9706 AS cps_comment_2#9720]
         :     :  :  +- Relation[rid#9693,cpfk_part_partsupp#9694,cfpk_partsupp_part#9695,cpfk_supplier_partsupp#9696,cfpk_partsupp_supplier#9697,cval_partsupp_ps_availqty#9698,cval_partsupp_ps_supplycost#9699,cval_partsupp_ps_comment#9700,cdepval_partsupp_ps_availqty#9701,cdepval_partsupp_ps_supplycost#9702,cdepval_partsupp_ps_comment#9703,cps_availqty#9704,cps_supplycost#9705,cps_comment#9706] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#9657 AS rid_1#9675, cpfk_nation_supplier#9658 AS cpfk_nation_supplier_1#9676, cfpk_supplier_nation#9659 AS cfpk_supplier_nation_1#9677, cval_supplier_s_name#9660 AS cval_supplier_s_name_1#9678, cval_supplier_s_address#9661 AS cval_supplier_s_address_1#9679, cval_supplier_s_phone#9662 AS cval_supplier_s_phone_1#9680, cval_supplier_s_acctbal#9663 AS cval_supplier_s_acctbal_1#9681, cval_supplier_s_comment#9664 AS cval_supplier_s_comment_1#9682, cdepval_supplier_s_name#9665 AS cdepval_supplier_s_name_1#9683, cdepval_supplier_s_address#9666 AS cdepval_supplier_s_address_1#9684, cdepval_supplier_s_phone#9667 AS cdepval_supplier_s_phone_1#9685, cdepval_supplier_s_acctbal#9668 AS cdepval_supplier_s_acctbal_1#9686, cdepval_supplier_s_comment#9669 AS cdepval_supplier_s_comment_1#9687, cs_name#9670 AS cs_name_1#9688, cs_address#9671 AS cs_address_1#9689, cs_phone#9672 AS cs_phone_1#9690, cs_acctbal#9673 AS cs_acctbal_1#9691, cs_comment#9674 AS cs_comment_1#9692]
         :     :     :  +- Relation[rid#9657,cpfk_nation_supplier#9658,cfpk_supplier_nation#9659,cval_supplier_s_name#9660,cval_supplier_s_address#9661,cval_supplier_s_phone#9662,cval_supplier_s_acctbal#9663,cval_supplier_s_comment#9664,cdepval_supplier_s_name#9665,cdepval_supplier_s_address#9666,cdepval_supplier_s_phone#9667,cdepval_supplier_s_acctbal#9668,cdepval_supplier_s_comment#9669,cs_name#9670,cs_address#9671,cs_phone#9672,cs_acctbal#9673,cs_comment#9674] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#9639 AS rid_0#9648, cpfk_region_nation#9640 AS cpfk_region_nation_0#9649, cfpk_nation_region#9641 AS cfpk_nation_region_0#9650, cval_nation_n_name#9642 AS cval_nation_n_name_0#9651, cval_nation_n_comment#9643 AS cval_nation_n_comment_0#9652, cdepval_nation_n_name#9644 AS cdepval_nation_n_name_0#9653, cdepval_nation_n_comment#9645 AS cdepval_nation_n_comment_0#9654, cn_name#9646 AS cn_name_0#9655, cn_comment#9647 AS cn_comment_0#9656]
         :     :        +- Relation[rid#9639,cpfk_region_nation#9640,cfpk_nation_region#9641,cval_nation_n_name#9642,cval_nation_n_comment#9643,cdepval_nation_n_name#9644,cdepval_nation_n_comment#9645,cn_name#9646,cn_comment#9647] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#9721 AS rid_3#9746, cval_part_p_name#9722 AS cval_part_p_name_3#9747, cval_part_p_mfgr#9723 AS cval_part_p_mfgr_3#9748, cval_part_p_type#9724 AS cval_part_p_type_3#9749, cval_part_p_size#9725 AS cval_part_p_size_3#9750, cval_part_p_container#9726 AS cval_part_p_container_3#9751, cval_part_p_retailprice#9727 AS cval_part_p_retailprice_3#9752, cval_part_p_comment#9728 AS cval_part_p_comment_3#9753, cval_part_p_brand#9729 AS cval_part_p_brand_3#9754, cdepval_part_p_name#9730 AS cdepval_part_p_name_3#9755, cdepval_part_p_mfgr#9731 AS cdepval_part_p_mfgr_3#9756, cdepval_part_p_type#9732 AS cdepval_part_p_type_3#9757, cdepval_part_p_size#9733 AS cdepval_part_p_size_3#9758, cdepval_part_p_container#9734 AS cdepval_part_p_container_3#9759, cdepval_part_p_retailprice#9735 AS cdepval_part_p_retailprice_3#9760, cdepval_part_p_comment#9736 AS cdepval_part_p_comment_3#9761, cdepval_part_p_brand#9737 AS cdepval_part_p_brand_3#9762, cp_name#9738 AS cp_name_3#9763, cp_mfgr#9739 AS cp_mfgr_3#9764, cp_type#9740 AS cp_type_3#9765, cp_size#9741 AS cp_size_3#9766, cp_container#9742 AS cp_container_3#9767, cp_retailprice#9743 AS cp_retailprice_3#9768, cp_comment#9744 AS cp_comment_3#9769, cp_brand#9745 AS cp_brand_3#9770]
         :        +- Relation[rid#9721,cval_part_p_name#9722,cval_part_p_mfgr#9723,cval_part_p_type#9724,cval_part_p_size#9725,cval_part_p_container#9726,cval_part_p_retailprice#9727,cval_part_p_comment#9728,cval_part_p_brand#9729,cdepval_part_p_name#9730,cdepval_part_p_mfgr#9731,cdepval_part_p_type#9732,cdepval_part_p_size#9733,cdepval_part_p_container#9734,cdepval_part_p_retailprice#9735,cdepval_part_p_comment#9736,cdepval_part_p_brand#9737,cp_name#9738,cp_mfgr#9739,cp_type#9740,cp_size#9741,cp_container#9742,cp_retailprice#9743,cp_comment#9744,cp_brand#9745] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#9861 AS rid_5#9885, cpfk_customer_orders#9862 AS cpfk_customer_orders_5#9886, cfpk_orders_customer#9863 AS cfpk_orders_customer_5#9887, cval_orders_o_orderstatus#9864 AS cval_orders_o_orderstatus_5#9888, cval_orders_o_totalprice#9865 AS cval_orders_o_totalprice_5#9889, cval_orders_o_orderpriority#9866 AS cval_orders_o_orderpriority_5#9890, cval_orders_o_clerk#9867 AS cval_orders_o_clerk_5#9891, cval_orders_o_shippriority#9868 AS cval_orders_o_shippriority_5#9892, cval_orders_o_comment#9869 AS cval_orders_o_comment_5#9893, cval_orders_o_orderdate#9870 AS cval_orders_o_orderdate_5#9894, cdepval_orders_o_orderstatus#9871 AS cdepval_orders_o_orderstatus_5#9895, cdepval_orders_o_totalprice#9872 AS cdepval_orders_o_totalprice_5#9896, cdepval_orders_o_orderpriority#9873 AS cdepval_orders_o_orderpriority_5#9897, cdepval_orders_o_clerk#9874 AS cdepval_orders_o_clerk_5#9898, cdepval_orders_o_shippriority#9875 AS cdepval_orders_o_shippriority_5#9899, cdepval_orders_o_comment#9876 AS cdepval_orders_o_comment_5#9900, cdepval_orders_o_orderdate#9877 AS cdepval_orders_o_orderdate_5#9901, co_orderstatus#9878 AS co_orderstatus_5#9902, co_totalprice#9879 AS co_totalprice_5#9903, co_orderpriority#9880 AS co_orderpriority_5#9904, co_clerk#9881 AS co_clerk_5#9905, co_shippriority#9882 AS co_shippriority_5#9906, co_comment#9883 AS co_comment_5#9907, co_orderdate#9884 AS co_orderdate_5#9908]
            +- Relation[rid#9861,cpfk_customer_orders#9862,cfpk_orders_customer#9863,cval_orders_o_orderstatus#9864,cval_orders_o_totalprice#9865,cval_orders_o_orderpriority#9866,cval_orders_o_clerk#9867,cval_orders_o_shippriority#9868,cval_orders_o_comment#9869,cval_orders_o_orderdate#9870,cdepval_orders_o_orderstatus#9871,cdepval_orders_o_totalprice#9872,cdepval_orders_o_orderpriority#9873,cdepval_orders_o_clerk#9874,cdepval_orders_o_shippriority#9875,cdepval_orders_o_comment#9876,cdepval_orders_o_orderdate#9877,co_orderstatus#9878,co_totalprice#9879,co_orderpriority#9880,co_clerk#9881,co_shippriority#9882,co_comment#9883,co_orderdate#9884] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 39223ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/26 22:37:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:37:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#10050L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 22:37:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:37:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:37:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:37:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:37:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:37:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:37:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:37:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:37:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:37:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:37:21 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:37:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#10050L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#10178 AS rid_2#10192, cpfk_part_partsupp#10179 AS cpfk_part_partsupp_2#10193, cfpk_partsupp_part#10180 AS cfpk_partsupp_part_2#10194, cpfk_supplier_partsupp#10181 AS cpfk_supplier_partsupp_2#10195, cfpk_partsupp_supplier#10182 AS cfpk_partsupp_supplier_2#10196, cval_partsupp_ps_availqty#10183 AS cval_partsupp_ps_availqty_2#10197, cval_partsupp_ps_supplycost#10184 AS cval_partsupp_ps_supplycost_2#10198, cval_partsupp_ps_comment#10185 AS cval_partsupp_ps_comment_2#10199, cdepval_partsupp_ps_availqty#10186 AS cdepval_partsupp_ps_availqty_2#10200, cdepval_partsupp_ps_supplycost#10187 AS cdepval_partsupp_ps_supplycost_2#10201, cdepval_partsupp_ps_comment#10188 AS cdepval_partsupp_ps_comment_2#10202, cps_availqty#10189 AS cps_availqty_2#10203, cps_supplycost#10190 AS cps_supplycost_2#10204, cps_comment#10191 AS cps_comment_2#10205]
         :  +- Relation[rid#10178,cpfk_part_partsupp#10179,cfpk_partsupp_part#10180,cpfk_supplier_partsupp#10181,cfpk_partsupp_supplier#10182,cval_partsupp_ps_availqty#10183,cval_partsupp_ps_supplycost#10184,cval_partsupp_ps_comment#10185,cdepval_partsupp_ps_availqty#10186,cdepval_partsupp_ps_supplycost#10187,cdepval_partsupp_ps_comment#10188,cps_availqty#10189,cps_supplycost#10190,cps_comment#10191] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#10061, cpfk_region_nation_0#10062, cfpk_nation_region_0#10063, cval_nation_n_name_0#10064, cval_nation_n_comment_0#10065, cdepval_nation_n_name_0#10066, cdepval_nation_n_comment_0#10067, cn_name_0#10068, cn_comment_0#10069, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
            :  :  +- Project [rid#10052 AS rid_0#10061, cpfk_region_nation#10053 AS cpfk_region_nation_0#10062, cfpk_nation_region#10054 AS cfpk_nation_region_0#10063, cval_nation_n_name#10055 AS cval_nation_n_name_0#10064, cval_nation_n_comment#10056 AS cval_nation_n_comment_0#10065, cdepval_nation_n_name#10057 AS cdepval_nation_n_name_0#10066, cdepval_nation_n_comment#10058 AS cdepval_nation_n_comment_0#10067, cn_name#10059 AS cn_name_0#10068, cn_comment#10060 AS cn_comment_0#10069]
            :  :     +- Relation[rid#10052,cpfk_region_nation#10053,cfpk_nation_region#10054,cval_nation_n_name#10055,cval_nation_n_comment#10056,cdepval_nation_n_name#10057,cdepval_nation_n_comment#10058,cn_name#10059,cn_comment#10060] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
            :     +- Project [rid#10142 AS rid_1#10160, cpfk_nation_supplier#10143 AS cpfk_nation_supplier_1#10161, cfpk_supplier_nation#10144 AS cfpk_supplier_nation_1#10162, cval_supplier_s_name#10145 AS cval_supplier_s_name_1#10163, cval_supplier_s_address#10146 AS cval_supplier_s_address_1#10164, cval_supplier_s_phone#10147 AS cval_supplier_s_phone_1#10165, cval_supplier_s_acctbal#10148 AS cval_supplier_s_acctbal_1#10166, cval_supplier_s_comment#10149 AS cval_supplier_s_comment_1#10167, cdepval_supplier_s_name#10150 AS cdepval_supplier_s_name_1#10168, cdepval_supplier_s_address#10151 AS cdepval_supplier_s_address_1#10169, cdepval_supplier_s_phone#10152 AS cdepval_supplier_s_phone_1#10170, cdepval_supplier_s_acctbal#10153 AS cdepval_supplier_s_acctbal_1#10171, cdepval_supplier_s_comment#10154 AS cdepval_supplier_s_comment_1#10172, cs_name#10155 AS cs_name_1#10173, cs_address#10156 AS cs_address_1#10174, cs_phone#10157 AS cs_phone_1#10175, cs_acctbal#10158 AS cs_acctbal_1#10176, cs_comment#10159 AS cs_comment_1#10177]
            :        +- Relation[rid#10142,cpfk_nation_supplier#10143,cfpk_supplier_nation#10144,cval_supplier_s_name#10145,cval_supplier_s_address#10146,cval_supplier_s_phone#10147,cval_supplier_s_acctbal#10148,cval_supplier_s_comment#10149,cdepval_supplier_s_name#10150,cdepval_supplier_s_address#10151,cdepval_supplier_s_phone#10152,cdepval_supplier_s_acctbal#10153,cdepval_supplier_s_comment#10154,cs_name#10155,cs_address#10156,cs_phone#10157,cs_acctbal#10158,cs_comment#10159] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#10088 AS rid_1#10106, cpfk_nation_supplier#10089 AS cpfk_nation_supplier_1#10107, cfpk_supplier_nation#10090 AS cfpk_supplier_nation_1#10108, cval_supplier_s_name#10091 AS cval_supplier_s_name_1#10109, cval_supplier_s_address#10092 AS cval_supplier_s_address_1#10110, cval_supplier_s_phone#10093 AS cval_supplier_s_phone_1#10111, cval_supplier_s_acctbal#10094 AS cval_supplier_s_acctbal_1#10112, cval_supplier_s_comment#10095 AS cval_supplier_s_comment_1#10113, cdepval_supplier_s_name#10096 AS cdepval_supplier_s_name_1#10114, cdepval_supplier_s_address#10097 AS cdepval_supplier_s_address_1#10115, cdepval_supplier_s_phone#10098 AS cdepval_supplier_s_phone_1#10116, cdepval_supplier_s_acctbal#10099 AS cdepval_supplier_s_acctbal_1#10117, cdepval_supplier_s_comment#10100 AS cdepval_supplier_s_comment_1#10118, cs_name#10101 AS cs_name_1#10119, cs_address#10102 AS cs_address_1#10120, cs_phone#10103 AS cs_phone_1#10121, cs_acctbal#10104 AS cs_acctbal_1#10122, cs_comment#10105 AS cs_comment_1#10123]
               +- Relation[rid#10088,cpfk_nation_supplier#10089,cfpk_supplier_nation#10090,cval_supplier_s_name#10091,cval_supplier_s_address#10092,cval_supplier_s_phone#10093,cval_supplier_s_acctbal#10094,cval_supplier_s_comment#10095,cdepval_supplier_s_name#10096,cdepval_supplier_s_address#10097,cdepval_supplier_s_phone#10098,cdepval_supplier_s_acctbal#10099,cdepval_supplier_s_comment#10100,cs_name#10101,cs_address#10102,cs_phone#10103,cs_acctbal#10104,cs_comment#10105] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 2474ms
query=q1, count=6001215, duration=2392
query=q10, count=1478870, duration=66926
query=q11, count=31680, duration=2474
query=q12, count=857401, duration=35693
query=q13, count=1500000, duration=4850
query=q14, count=6001215, duration=18092
query=q15, count=6001215, duration=18646
query=q16, count=15780, duration=1046
query=q17, count=6088, duration=556
query=q18, count=6001215, duration=24145
query=q19, count=205, duration=17928
query=q2, count=3162, duration=1051
query=q20, count=632, duration=1652
query=q21a, count=597422, duration=162191
query=q22, count=1500000, duration=4653
query=q3, count=1214743, duration=25719
query=q4, count=6001215, duration=23470
query=q5, count=48089, duration=31746
query=q6, count=6001215, duration=2448
query=q7, count=9735, duration=40415
query=q8, count=8716, duration=5011
query=q9a, count=6001215, duration=67147
query=q9b, count=6001215, duration=39223
