20/04/25 23:08:48 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 11028ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 25 23:08:51 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 25 23:08:53 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 25 23:08:53 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 25 23:08:53 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 25 23:08:53 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 25 23:08:57 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 25 23:09:01 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 25 23:09:01 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/25 23:09:03 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:09:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2079L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:09:03 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/25 23:09:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#2079L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#2081 AS rid_0#2126, cpfk_orders_lineitem#2082 AS cpfk_orders_lineitem_0#2127, cpfk_supplier_lineitem#2083 AS cpfk_supplier_lineitem_0#2128, cfpk_lineitem_supplier#2084 AS cfpk_lineitem_supplier_0#2129, cfpk_lineitem_partsupp#2085 AS cfpk_lineitem_partsupp_0#2130, cpfk_part_lineitem#2086 AS cpfk_part_lineitem_0#2131, cfpk_lineitem_part#2087 AS cfpk_lineitem_part_0#2132, cpfk_partsupp_lineitem#2088 AS cpfk_partsupp_lineitem_0#2133, cfpk_lineitem_orders#2089 AS cfpk_lineitem_orders_0#2134, cval_lineitem_l_quantity#2090 AS cval_lineitem_l_quantity_0#2135, cval_lineitem_l_extendedprice#2091 AS cval_lineitem_l_extendedprice_0#2136, cval_lineitem_l_discount#2092 AS cval_lineitem_l_discount_0#2137, cval_lineitem_l_tax#2093 AS cval_lineitem_l_tax_0#2138, cval_lineitem_l_returnflag#2094 AS cval_lineitem_l_returnflag_0#2139, cval_lineitem_l_linestatus#2095 AS cval_lineitem_l_linestatus_0#2140, cval_lineitem_l_commitdate#2096 AS cval_lineitem_l_commitdate_0#2141, cval_lineitem_l_receiptdate#2097 AS cval_lineitem_l_receiptdate_0#2142, cval_lineitem_l_shipinstruct#2098 AS cval_lineitem_l_shipinstruct_0#2143, cval_lineitem_l_shipmode#2099 AS cval_lineitem_l_shipmode_0#2144, cval_lineitem_l_comment#2100 AS cval_lineitem_l_comment_0#2145, cval_lineitem_l_shipdate#2101 AS cval_lineitem_l_shipdate_0#2146, cdepval_lineitem_l_quantity#2102 AS cdepval_lineitem_l_quantity_0#2147, cdepval_lineitem_l_extendedprice#2103 AS cdepval_lineitem_l_extendedprice_0#2148, cdepval_lineitem_l_discount#2104 AS cdepval_lineitem_l_discount_0#2149, ... 21 more fields]
         +- Relation[rid#2081,cpfk_orders_lineitem#2082,cpfk_supplier_lineitem#2083,cfpk_lineitem_supplier#2084,cfpk_lineitem_partsupp#2085,cpfk_part_lineitem#2086,cfpk_lineitem_part#2087,cpfk_partsupp_lineitem#2088,cfpk_lineitem_orders#2089,cval_lineitem_l_quantity#2090,cval_lineitem_l_extendedprice#2091,cval_lineitem_l_discount#2092,cval_lineitem_l_tax#2093,cval_lineitem_l_returnflag#2094,cval_lineitem_l_linestatus#2095,cval_lineitem_l_commitdate#2096,cval_lineitem_l_receiptdate#2097,cval_lineitem_l_shipinstruct#2098,cval_lineitem_l_shipmode#2099,cval_lineitem_l_comment#2100,cval_lineitem_l_shipdate#2101,cdepval_lineitem_l_quantity#2102,cdepval_lineitem_l_extendedprice#2103,cdepval_lineitem_l_discount#2104,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2777ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/25 23:09:05 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:09:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2223L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:09:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:09:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:09:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2223L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#2261 AS rid_1#2306, cpfk_orders_lineitem#2262 AS cpfk_orders_lineitem_1#2307, cpfk_supplier_lineitem#2263 AS cpfk_supplier_lineitem_1#2308, cfpk_lineitem_supplier#2264 AS cfpk_lineitem_supplier_1#2309, cfpk_lineitem_partsupp#2265 AS cfpk_lineitem_partsupp_1#2310, cpfk_part_lineitem#2266 AS cpfk_part_lineitem_1#2311, cfpk_lineitem_part#2267 AS cfpk_lineitem_part_1#2312, cpfk_partsupp_lineitem#2268 AS cpfk_partsupp_lineitem_1#2313, cfpk_lineitem_orders#2269 AS cfpk_lineitem_orders_1#2314, cval_lineitem_l_quantity#2270 AS cval_lineitem_l_quantity_1#2315, cval_lineitem_l_extendedprice#2271 AS cval_lineitem_l_extendedprice_1#2316, cval_lineitem_l_discount#2272 AS cval_lineitem_l_discount_1#2317, cval_lineitem_l_tax#2273 AS cval_lineitem_l_tax_1#2318, cval_lineitem_l_returnflag#2274 AS cval_lineitem_l_returnflag_1#2319, cval_lineitem_l_linestatus#2275 AS cval_lineitem_l_linestatus_1#2320, cval_lineitem_l_commitdate#2276 AS cval_lineitem_l_commitdate_1#2321, cval_lineitem_l_receiptdate#2277 AS cval_lineitem_l_receiptdate_1#2322, cval_lineitem_l_shipinstruct#2278 AS cval_lineitem_l_shipinstruct_1#2323, cval_lineitem_l_shipmode#2279 AS cval_lineitem_l_shipmode_1#2324, cval_lineitem_l_comment#2280 AS cval_lineitem_l_comment_1#2325, cval_lineitem_l_shipdate#2281 AS cval_lineitem_l_shipdate_1#2326, cdepval_lineitem_l_quantity#2282 AS cdepval_lineitem_l_quantity_1#2327, cdepval_lineitem_l_extendedprice#2283 AS cdepval_lineitem_l_extendedprice_1#2328, cdepval_lineitem_l_discount#2284 AS cdepval_lineitem_l_discount_1#2329, ... 21 more fields]
         :  +- Relation[rid#2261,cpfk_orders_lineitem#2262,cpfk_supplier_lineitem#2263,cfpk_lineitem_supplier#2264,cfpk_lineitem_partsupp#2265,cpfk_part_lineitem#2266,cfpk_lineitem_part#2267,cpfk_partsupp_lineitem#2268,cfpk_lineitem_orders#2269,cval_lineitem_l_quantity#2270,cval_lineitem_l_extendedprice#2271,cval_lineitem_l_discount#2272,cval_lineitem_l_tax#2273,cval_lineitem_l_returnflag#2274,cval_lineitem_l_linestatus#2275,cval_lineitem_l_commitdate#2276,cval_lineitem_l_receiptdate#2277,cval_lineitem_l_shipinstruct#2278,cval_lineitem_l_shipmode#2279,cval_lineitem_l_comment#2280,cval_lineitem_l_shipdate#2281,cdepval_lineitem_l_quantity#2282,cdepval_lineitem_l_extendedprice#2283,cdepval_lineitem_l_discount#2284,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2225 AS rid_0#2243, cpfk_nation_supplier#2226 AS cpfk_nation_supplier_0#2244, cfpk_supplier_nation#2227 AS cfpk_supplier_nation_0#2245, cval_supplier_s_name#2228 AS cval_supplier_s_name_0#2246, cval_supplier_s_address#2229 AS cval_supplier_s_address_0#2247, cval_supplier_s_phone#2230 AS cval_supplier_s_phone_0#2248, cval_supplier_s_acctbal#2231 AS cval_supplier_s_acctbal_0#2249, cval_supplier_s_comment#2232 AS cval_supplier_s_comment_0#2250, cdepval_supplier_s_name#2233 AS cdepval_supplier_s_name_0#2251, cdepval_supplier_s_address#2234 AS cdepval_supplier_s_address_0#2252, cdepval_supplier_s_phone#2235 AS cdepval_supplier_s_phone_0#2253, cdepval_supplier_s_acctbal#2236 AS cdepval_supplier_s_acctbal_0#2254, cdepval_supplier_s_comment#2237 AS cdepval_supplier_s_comment_0#2255, cs_name#2238 AS cs_name_0#2256, cs_address#2239 AS cs_address_0#2257, cs_phone#2240 AS cs_phone_0#2258, cs_acctbal#2241 AS cs_acctbal_0#2259, cs_comment#2242 AS cs_comment_0#2260]
            +- Relation[rid#2225,cpfk_nation_supplier#2226,cfpk_supplier_nation#2227,cval_supplier_s_name#2228,cval_supplier_s_address#2229,cval_supplier_s_phone#2230,cval_supplier_s_acctbal#2231,cval_supplier_s_comment#2232,cdepval_supplier_s_name#2233,cdepval_supplier_s_address#2234,cdepval_supplier_s_phone#2235,cdepval_supplier_s_acctbal#2236,cdepval_supplier_s_comment#2237,cs_name#2238,cs_address#2239,cs_phone#2240,cs_acctbal#2241,cs_comment#2242] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17327ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/25 23:09:23 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:09:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2418L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:09:23 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:09:23 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:09:23 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:09:23 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:09:23 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:09:23 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:09:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2418L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#2570 AS rid_1#2615, cpfk_orders_lineitem#2571 AS cpfk_orders_lineitem_1#2616, cpfk_supplier_lineitem#2572 AS cpfk_supplier_lineitem_1#2617, cfpk_lineitem_supplier#2573 AS cfpk_lineitem_supplier_1#2618, cfpk_lineitem_partsupp#2574 AS cfpk_lineitem_partsupp_1#2619, cpfk_part_lineitem#2575 AS cpfk_part_lineitem_1#2620, cfpk_lineitem_part#2576 AS cfpk_lineitem_part_1#2621, cpfk_partsupp_lineitem#2577 AS cpfk_partsupp_lineitem_1#2622, cfpk_lineitem_orders#2578 AS cfpk_lineitem_orders_1#2623, cval_lineitem_l_quantity#2579 AS cval_lineitem_l_quantity_1#2624, cval_lineitem_l_extendedprice#2580 AS cval_lineitem_l_extendedprice_1#2625, cval_lineitem_l_discount#2581 AS cval_lineitem_l_discount_1#2626, cval_lineitem_l_tax#2582 AS cval_lineitem_l_tax_1#2627, cval_lineitem_l_returnflag#2583 AS cval_lineitem_l_returnflag_1#2628, cval_lineitem_l_linestatus#2584 AS cval_lineitem_l_linestatus_1#2629, cval_lineitem_l_commitdate#2585 AS cval_lineitem_l_commitdate_1#2630, cval_lineitem_l_receiptdate#2586 AS cval_lineitem_l_receiptdate_1#2631, cval_lineitem_l_shipinstruct#2587 AS cval_lineitem_l_shipinstruct_1#2632, cval_lineitem_l_shipmode#2588 AS cval_lineitem_l_shipmode_1#2633, cval_lineitem_l_comment#2589 AS cval_lineitem_l_comment_1#2634, cval_lineitem_l_shipdate#2590 AS cval_lineitem_l_shipdate_1#2635, cdepval_lineitem_l_quantity#2591 AS cdepval_lineitem_l_quantity_1#2636, cdepval_lineitem_l_extendedprice#2592 AS cdepval_lineitem_l_extendedprice_1#2637, cdepval_lineitem_l_discount#2593 AS cdepval_lineitem_l_discount_1#2638, ... 21 more fields]
         :  +- Relation[rid#2570,cpfk_orders_lineitem#2571,cpfk_supplier_lineitem#2572,cfpk_lineitem_supplier#2573,cfpk_lineitem_partsupp#2574,cpfk_part_lineitem#2575,cfpk_lineitem_part#2576,cpfk_partsupp_lineitem#2577,cfpk_lineitem_orders#2578,cval_lineitem_l_quantity#2579,cval_lineitem_l_extendedprice#2580,cval_lineitem_l_discount#2581,cval_lineitem_l_tax#2582,cval_lineitem_l_returnflag#2583,cval_lineitem_l_linestatus#2584,cval_lineitem_l_commitdate#2585,cval_lineitem_l_receiptdate#2586,cval_lineitem_l_shipinstruct#2587,cval_lineitem_l_shipmode#2588,cval_lineitem_l_comment#2589,cval_lineitem_l_shipdate#2590,cdepval_lineitem_l_quantity#2591,cdepval_lineitem_l_extendedprice#2592,cdepval_lineitem_l_discount#2593,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
               +- Project [rid#2420 AS rid_0#2445, cval_part_p_name#2421 AS cval_part_p_name_0#2446, cval_part_p_mfgr#2422 AS cval_part_p_mfgr_0#2447, cval_part_p_type#2423 AS cval_part_p_type_0#2448, cval_part_p_size#2424 AS cval_part_p_size_0#2449, cval_part_p_container#2425 AS cval_part_p_container_0#2450, cval_part_p_retailprice#2426 AS cval_part_p_retailprice_0#2451, cval_part_p_comment#2427 AS cval_part_p_comment_0#2452, cval_part_p_brand#2428 AS cval_part_p_brand_0#2453, cdepval_part_p_name#2429 AS cdepval_part_p_name_0#2454, cdepval_part_p_mfgr#2430 AS cdepval_part_p_mfgr_0#2455, cdepval_part_p_type#2431 AS cdepval_part_p_type_0#2456, cdepval_part_p_size#2432 AS cdepval_part_p_size_0#2457, cdepval_part_p_container#2433 AS cdepval_part_p_container_0#2458, cdepval_part_p_retailprice#2434 AS cdepval_part_p_retailprice_0#2459, cdepval_part_p_comment#2435 AS cdepval_part_p_comment_0#2460, cdepval_part_p_brand#2436 AS cdepval_part_p_brand_0#2461, cp_name#2437 AS cp_name_0#2462, cp_mfgr#2438 AS cp_mfgr_0#2463, cp_type#2439 AS cp_type_0#2464, cp_size#2440 AS cp_size_0#2465, cp_container#2441 AS cp_container_0#2466, cp_retailprice#2442 AS cp_retailprice_0#2467, cp_comment#2443 AS cp_comment_0#2468, cp_brand#2444 AS cp_brand_0#2469]
                  +- Relation[rid#2420,cval_part_p_name#2421,cval_part_p_mfgr#2422,cval_part_p_type#2423,cval_part_p_size#2424,cval_part_p_container#2425,cval_part_p_retailprice#2426,cval_part_p_comment#2427,cval_part_p_brand#2428,cdepval_part_p_name#2429,cdepval_part_p_mfgr#2430,cdepval_part_p_type#2431,cdepval_part_p_size#2432,cdepval_part_p_container#2433,cdepval_part_p_retailprice#2434,cdepval_part_p_comment#2435,cdepval_part_p_brand#2436,cp_name#2437,cp_mfgr#2438,cp_type#2439,cp_size#2440,cp_container#2441,cp_retailprice#2442,cp_comment#2443,cp_brand#2444] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 26009ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/25 23:09:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:09:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2738L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:09:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:09:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:09:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:09:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:09:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:09:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:09:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:09:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:09:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:09:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:09:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:09:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2738L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#2812 AS rid_2#2857, cpfk_orders_lineitem#2813 AS cpfk_orders_lineitem_2#2858, cpfk_supplier_lineitem#2814 AS cpfk_supplier_lineitem_2#2859, cfpk_lineitem_supplier#2815 AS cfpk_lineitem_supplier_2#2860, cfpk_lineitem_partsupp#2816 AS cfpk_lineitem_partsupp_2#2861, cpfk_part_lineitem#2817 AS cpfk_part_lineitem_2#2862, cfpk_lineitem_part#2818 AS cfpk_lineitem_part_2#2863, cpfk_partsupp_lineitem#2819 AS cpfk_partsupp_lineitem_2#2864, cfpk_lineitem_orders#2820 AS cfpk_lineitem_orders_2#2865, cval_lineitem_l_quantity#2821 AS cval_lineitem_l_quantity_2#2866, cval_lineitem_l_extendedprice#2822 AS cval_lineitem_l_extendedprice_2#2867, cval_lineitem_l_discount#2823 AS cval_lineitem_l_discount_2#2868, cval_lineitem_l_tax#2824 AS cval_lineitem_l_tax_2#2869, cval_lineitem_l_returnflag#2825 AS cval_lineitem_l_returnflag_2#2870, cval_lineitem_l_linestatus#2826 AS cval_lineitem_l_linestatus_2#2871, cval_lineitem_l_commitdate#2827 AS cval_lineitem_l_commitdate_2#2872, cval_lineitem_l_receiptdate#2828 AS cval_lineitem_l_receiptdate_2#2873, cval_lineitem_l_shipinstruct#2829 AS cval_lineitem_l_shipinstruct_2#2874, cval_lineitem_l_shipmode#2830 AS cval_lineitem_l_shipmode_2#2875, cval_lineitem_l_comment#2831 AS cval_lineitem_l_comment_2#2876, cval_lineitem_l_shipdate#2832 AS cval_lineitem_l_shipdate_2#2877, cdepval_lineitem_l_quantity#2833 AS cdepval_lineitem_l_quantity_2#2878, cdepval_lineitem_l_extendedprice#2834 AS cdepval_lineitem_l_extendedprice_2#2879, cdepval_lineitem_l_discount#2835 AS cdepval_lineitem_l_discount_2#2880, ... 21 more fields]
         :  :  +- Relation[rid#2812,cpfk_orders_lineitem#2813,cpfk_supplier_lineitem#2814,cfpk_lineitem_supplier#2815,cfpk_lineitem_partsupp#2816,cpfk_part_lineitem#2817,cfpk_lineitem_part#2818,cpfk_partsupp_lineitem#2819,cfpk_lineitem_orders#2820,cval_lineitem_l_quantity#2821,cval_lineitem_l_extendedprice#2822,cval_lineitem_l_discount#2823,cval_lineitem_l_tax#2824,cval_lineitem_l_returnflag#2825,cval_lineitem_l_linestatus#2826,cval_lineitem_l_commitdate#2827,cval_lineitem_l_receiptdate#2828,cval_lineitem_l_shipinstruct#2829,cval_lineitem_l_shipmode#2830,cval_lineitem_l_comment#2831,cval_lineitem_l_shipdate#2832,cdepval_lineitem_l_quantity#2833,cdepval_lineitem_l_extendedprice#2834,cdepval_lineitem_l_discount#2835,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :- Project [rid#2776 AS rid_1#2794, cpfk_nation_supplier#2777 AS cpfk_nation_supplier_1#2795, cfpk_supplier_nation#2778 AS cfpk_supplier_nation_1#2796, cval_supplier_s_name#2779 AS cval_supplier_s_name_1#2797, cval_supplier_s_address#2780 AS cval_supplier_s_address_1#2798, cval_supplier_s_phone#2781 AS cval_supplier_s_phone_1#2799, cval_supplier_s_acctbal#2782 AS cval_supplier_s_acctbal_1#2800, cval_supplier_s_comment#2783 AS cval_supplier_s_comment_1#2801, cdepval_supplier_s_name#2784 AS cdepval_supplier_s_name_1#2802, cdepval_supplier_s_address#2785 AS cdepval_supplier_s_address_1#2803, cdepval_supplier_s_phone#2786 AS cdepval_supplier_s_phone_1#2804, cdepval_supplier_s_acctbal#2787 AS cdepval_supplier_s_acctbal_1#2805, cdepval_supplier_s_comment#2788 AS cdepval_supplier_s_comment_1#2806, cs_name#2789 AS cs_name_1#2807, cs_address#2790 AS cs_address_1#2808, cs_phone#2791 AS cs_phone_1#2809, cs_acctbal#2792 AS cs_acctbal_1#2810, cs_comment#2793 AS cs_comment_1#2811]
         :     :  +- Relation[rid#2776,cpfk_nation_supplier#2777,cfpk_supplier_nation#2778,cval_supplier_s_name#2779,cval_supplier_s_address#2780,cval_supplier_s_phone#2781,cval_supplier_s_acctbal#2782,cval_supplier_s_comment#2783,cdepval_supplier_s_name#2784,cdepval_supplier_s_address#2785,cdepval_supplier_s_phone#2786,cdepval_supplier_s_acctbal#2787,cdepval_supplier_s_comment#2788,cs_name#2789,cs_address#2790,cs_phone#2791,cs_acctbal#2792,cs_comment#2793] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :        +- Project [rid#2740 AS rid_0#2749, cpfk_region_nation#2741 AS cpfk_region_nation_0#2750, cfpk_nation_region#2742 AS cfpk_nation_region_0#2751, cval_nation_n_name#2743 AS cval_nation_n_name_0#2752, cval_nation_n_comment#2744 AS cval_nation_n_comment_0#2753, cdepval_nation_n_name#2745 AS cdepval_nation_n_name_0#2754, cdepval_nation_n_comment#2746 AS cdepval_nation_n_comment_0#2755, cn_name#2747 AS cn_name_0#2756, cn_comment#2748 AS cn_comment_0#2757]
         :           +- Relation[rid#2740,cpfk_region_nation#2741,cfpk_nation_region#2742,cval_nation_n_name#2743,cval_nation_n_comment#2744,cdepval_nation_n_name#2745,cdepval_nation_n_comment#2746,cn_name#2747,cn_comment#2748] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#2980 AS rid_5#3004, cpfk_customer_orders#2981 AS cpfk_customer_orders_5#3005, cfpk_orders_customer#2982 AS cfpk_orders_customer_5#3006, cval_orders_o_orderstatus#2983 AS cval_orders_o_orderstatus_5#3007, cval_orders_o_totalprice#2984 AS cval_orders_o_totalprice_5#3008, cval_orders_o_orderpriority#2985 AS cval_orders_o_orderpriority_5#3009, cval_orders_o_clerk#2986 AS cval_orders_o_clerk_5#3010, cval_orders_o_shippriority#2987 AS cval_orders_o_shippriority_5#3011, cval_orders_o_comment#2988 AS cval_orders_o_comment_5#3012, cval_orders_o_orderdate#2989 AS cval_orders_o_orderdate_5#3013, cdepval_orders_o_orderstatus#2990 AS cdepval_orders_o_orderstatus_5#3014, cdepval_orders_o_totalprice#2991 AS cdepval_orders_o_totalprice_5#3015, cdepval_orders_o_orderpriority#2992 AS cdepval_orders_o_orderpriority_5#3016, cdepval_orders_o_clerk#2993 AS cdepval_orders_o_clerk_5#3017, cdepval_orders_o_shippriority#2994 AS cdepval_orders_o_shippriority_5#3018, cdepval_orders_o_comment#2995 AS cdepval_orders_o_comment_5#3019, cdepval_orders_o_orderdate#2996 AS cdepval_orders_o_orderdate_5#3020, co_orderstatus#2997 AS co_orderstatus_5#3021, co_totalprice#2998 AS co_totalprice_5#3022, co_orderpriority#2999 AS co_orderpriority_5#3023, co_clerk#3000 AS co_clerk_5#3024, co_shippriority#3001 AS co_shippriority_5#3025, co_comment#3002 AS co_comment_5#3026, co_orderdate#3003 AS co_orderdate_5#3027]
            :  +- Relation[rid#2980,cpfk_customer_orders#2981,cfpk_orders_customer#2982,cval_orders_o_orderstatus#2983,cval_orders_o_totalprice#2984,cval_orders_o_orderpriority#2985,cval_orders_o_clerk#2986,cval_orders_o_shippriority#2987,cval_orders_o_comment#2988,cval_orders_o_orderdate#2989,cdepval_orders_o_orderstatus#2990,cdepval_orders_o_totalprice#2991,cdepval_orders_o_orderpriority#2992,cdepval_orders_o_clerk#2993,cdepval_orders_o_shippriority#2994,cdepval_orders_o_comment#2995,cdepval_orders_o_orderdate#2996,co_orderstatus#2997,co_totalprice#2998,co_orderpriority#2999,co_clerk#3000,co_shippriority#3001,co_comment#3002,co_orderdate#3003] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_4, BinaryType)), 'cfpk_customer_nation_4) = 'rid_3)
               :- Project [rid#2938 AS rid_4#2959, cpfk_nation_customer#2939 AS cpfk_nation_customer_4#2960, cfpk_customer_nation#2940 AS cfpk_customer_nation_4#2961, cval_customer_c_name#2941 AS cval_customer_c_name_4#2962, cval_customer_c_address#2942 AS cval_customer_c_address_4#2963, cval_customer_c_phone#2943 AS cval_customer_c_phone_4#2964, cval_customer_c_acctbal#2944 AS cval_customer_c_acctbal_4#2965, cval_customer_c_comment#2945 AS cval_customer_c_comment_4#2966, cval_customer_c_mktsegment#2946 AS cval_customer_c_mktsegment_4#2967, cdepval_customer_c_name#2947 AS cdepval_customer_c_name_4#2968, cdepval_customer_c_address#2948 AS cdepval_customer_c_address_4#2969, cdepval_customer_c_phone#2949 AS cdepval_customer_c_phone_4#2970, cdepval_customer_c_acctbal#2950 AS cdepval_customer_c_acctbal_4#2971, cdepval_customer_c_comment#2951 AS cdepval_customer_c_comment_4#2972, cdepval_customer_c_mktsegment#2952 AS cdepval_customer_c_mktsegment_4#2973, cc_name#2953 AS cc_name_4#2974, cc_address#2954 AS cc_address_4#2975, cc_phone#2955 AS cc_phone_4#2976, cc_acctbal#2956 AS cc_acctbal_4#2977, cc_comment#2957 AS cc_comment_4#2978, cc_mktsegment#2958 AS cc_mktsegment_4#2979]
               :  +- Relation[rid#2938,cpfk_nation_customer#2939,cfpk_customer_nation#2940,cval_customer_c_name#2941,cval_customer_c_address#2942,cval_customer_c_phone#2943,cval_customer_c_acctbal#2944,cval_customer_c_comment#2945,cval_customer_c_mktsegment#2946,cdepval_customer_c_name#2947,cdepval_customer_c_address#2948,cdepval_customer_c_phone#2949,cdepval_customer_c_acctbal#2950,cdepval_customer_c_comment#2951,cdepval_customer_c_mktsegment#2952,cc_name#2953,cc_address#2954,cc_phone#2955,cc_acctbal#2956,cc_comment#2957,cc_mktsegment#2958] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
                  +- Project [rid#2902 AS rid_3#2911, cpfk_region_nation#2903 AS cpfk_region_nation_3#2912, cfpk_nation_region#2904 AS cfpk_nation_region_3#2913, cval_nation_n_name#2905 AS cval_nation_n_name_3#2914, cval_nation_n_comment#2906 AS cval_nation_n_comment_3#2915, cdepval_nation_n_name#2907 AS cdepval_nation_n_name_3#2916, cdepval_nation_n_comment#2908 AS cdepval_nation_n_comment_3#2917, cn_name#2909 AS cn_name_3#2918, cn_comment#2910 AS cn_comment_3#2919]
                     +- Relation[rid#2902,cpfk_region_nation#2903,cfpk_nation_region#2904,cval_nation_n_name#2905,cval_nation_n_comment#2906,cdepval_nation_n_name#2907,cdepval_nation_n_comment#2908,cn_name#2909,cn_comment#2910] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 34713ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 23:10:23 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:10:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3163L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:10:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:10:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:10:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:10:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:10:24 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:10:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:10:24 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:10:24 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:10:24 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:10:24 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:10:24 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:10:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3163L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#3297 AS rid_4#3342, cpfk_orders_lineitem#3298 AS cpfk_orders_lineitem_4#3343, cpfk_supplier_lineitem#3299 AS cpfk_supplier_lineitem_4#3344, cfpk_lineitem_supplier#3300 AS cfpk_lineitem_supplier_4#3345, cfpk_lineitem_partsupp#3301 AS cfpk_lineitem_partsupp_4#3346, cpfk_part_lineitem#3302 AS cpfk_part_lineitem_4#3347, cfpk_lineitem_part#3303 AS cfpk_lineitem_part_4#3348, cpfk_partsupp_lineitem#3304 AS cpfk_partsupp_lineitem_4#3349, cfpk_lineitem_orders#3305 AS cfpk_lineitem_orders_4#3350, cval_lineitem_l_quantity#3306 AS cval_lineitem_l_quantity_4#3351, cval_lineitem_l_extendedprice#3307 AS cval_lineitem_l_extendedprice_4#3352, cval_lineitem_l_discount#3308 AS cval_lineitem_l_discount_4#3353, cval_lineitem_l_tax#3309 AS cval_lineitem_l_tax_4#3354, cval_lineitem_l_returnflag#3310 AS cval_lineitem_l_returnflag_4#3355, cval_lineitem_l_linestatus#3311 AS cval_lineitem_l_linestatus_4#3356, cval_lineitem_l_commitdate#3312 AS cval_lineitem_l_commitdate_4#3357, cval_lineitem_l_receiptdate#3313 AS cval_lineitem_l_receiptdate_4#3358, cval_lineitem_l_shipinstruct#3314 AS cval_lineitem_l_shipinstruct_4#3359, cval_lineitem_l_shipmode#3315 AS cval_lineitem_l_shipmode_4#3360, cval_lineitem_l_comment#3316 AS cval_lineitem_l_comment_4#3361, cval_lineitem_l_shipdate#3317 AS cval_lineitem_l_shipdate_4#3362, cdepval_lineitem_l_quantity#3318 AS cdepval_lineitem_l_quantity_4#3363, cdepval_lineitem_l_extendedprice#3319 AS cdepval_lineitem_l_extendedprice_4#3364, cdepval_lineitem_l_discount#3320 AS cdepval_lineitem_l_discount_4#3365, ... 21 more fields]
         :  :  +- Relation[rid#3297,cpfk_orders_lineitem#3298,cpfk_supplier_lineitem#3299,cfpk_lineitem_supplier#3300,cfpk_lineitem_partsupp#3301,cpfk_part_lineitem#3302,cfpk_lineitem_part#3303,cpfk_partsupp_lineitem#3304,cfpk_lineitem_orders#3305,cval_lineitem_l_quantity#3306,cval_lineitem_l_extendedprice#3307,cval_lineitem_l_discount#3308,cval_lineitem_l_tax#3309,cval_lineitem_l_returnflag#3310,cval_lineitem_l_linestatus#3311,cval_lineitem_l_commitdate#3312,cval_lineitem_l_receiptdate#3313,cval_lineitem_l_shipinstruct#3314,cval_lineitem_l_shipmode#3315,cval_lineitem_l_comment#3316,cval_lineitem_l_shipdate#3317,cdepval_lineitem_l_quantity#3318,cdepval_lineitem_l_extendedprice#3319,cdepval_lineitem_l_discount#3320,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#3219 AS rid_2#3233, cpfk_part_partsupp#3220 AS cpfk_part_partsupp_2#3234, cfpk_partsupp_part#3221 AS cfpk_partsupp_part_2#3235, cpfk_supplier_partsupp#3222 AS cpfk_supplier_partsupp_2#3236, cfpk_partsupp_supplier#3223 AS cfpk_partsupp_supplier_2#3237, cval_partsupp_ps_availqty#3224 AS cval_partsupp_ps_availqty_2#3238, cval_partsupp_ps_supplycost#3225 AS cval_partsupp_ps_supplycost_2#3239, cval_partsupp_ps_comment#3226 AS cval_partsupp_ps_comment_2#3240, cdepval_partsupp_ps_availqty#3227 AS cdepval_partsupp_ps_availqty_2#3241, cdepval_partsupp_ps_supplycost#3228 AS cdepval_partsupp_ps_supplycost_2#3242, cdepval_partsupp_ps_comment#3229 AS cdepval_partsupp_ps_comment_2#3243, cps_availqty#3230 AS cps_availqty_2#3244, cps_supplycost#3231 AS cps_supplycost_2#3245, cps_comment#3232 AS cps_comment_2#3246]
         :     :  :  +- Relation[rid#3219,cpfk_part_partsupp#3220,cfpk_partsupp_part#3221,cpfk_supplier_partsupp#3222,cfpk_partsupp_supplier#3223,cval_partsupp_ps_availqty#3224,cval_partsupp_ps_supplycost#3225,cval_partsupp_ps_comment#3226,cdepval_partsupp_ps_availqty#3227,cdepval_partsupp_ps_supplycost#3228,cdepval_partsupp_ps_comment#3229,cps_availqty#3230,cps_supplycost#3231,cps_comment#3232] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#3183 AS rid_1#3201, cpfk_nation_supplier#3184 AS cpfk_nation_supplier_1#3202, cfpk_supplier_nation#3185 AS cfpk_supplier_nation_1#3203, cval_supplier_s_name#3186 AS cval_supplier_s_name_1#3204, cval_supplier_s_address#3187 AS cval_supplier_s_address_1#3205, cval_supplier_s_phone#3188 AS cval_supplier_s_phone_1#3206, cval_supplier_s_acctbal#3189 AS cval_supplier_s_acctbal_1#3207, cval_supplier_s_comment#3190 AS cval_supplier_s_comment_1#3208, cdepval_supplier_s_name#3191 AS cdepval_supplier_s_name_1#3209, cdepval_supplier_s_address#3192 AS cdepval_supplier_s_address_1#3210, cdepval_supplier_s_phone#3193 AS cdepval_supplier_s_phone_1#3211, cdepval_supplier_s_acctbal#3194 AS cdepval_supplier_s_acctbal_1#3212, cdepval_supplier_s_comment#3195 AS cdepval_supplier_s_comment_1#3213, cs_name#3196 AS cs_name_1#3214, cs_address#3197 AS cs_address_1#3215, cs_phone#3198 AS cs_phone_1#3216, cs_acctbal#3199 AS cs_acctbal_1#3217, cs_comment#3200 AS cs_comment_1#3218]
         :     :     :  +- Relation[rid#3183,cpfk_nation_supplier#3184,cfpk_supplier_nation#3185,cval_supplier_s_name#3186,cval_supplier_s_address#3187,cval_supplier_s_phone#3188,cval_supplier_s_acctbal#3189,cval_supplier_s_comment#3190,cdepval_supplier_s_name#3191,cdepval_supplier_s_address#3192,cdepval_supplier_s_phone#3193,cdepval_supplier_s_acctbal#3194,cdepval_supplier_s_comment#3195,cs_name#3196,cs_address#3197,cs_phone#3198,cs_acctbal#3199,cs_comment#3200] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#3165 AS rid_0#3174, cpfk_region_nation#3166 AS cpfk_region_nation_0#3175, cfpk_nation_region#3167 AS cfpk_nation_region_0#3176, cval_nation_n_name#3168 AS cval_nation_n_name_0#3177, cval_nation_n_comment#3169 AS cval_nation_n_comment_0#3178, cdepval_nation_n_name#3170 AS cdepval_nation_n_name_0#3179, cdepval_nation_n_comment#3171 AS cdepval_nation_n_comment_0#3180, cn_name#3172 AS cn_name_0#3181, cn_comment#3173 AS cn_comment_0#3182]
         :     :        +- Relation[rid#3165,cpfk_region_nation#3166,cfpk_nation_region#3167,cval_nation_n_name#3168,cval_nation_n_comment#3169,cdepval_nation_n_name#3170,cdepval_nation_n_comment#3171,cn_name#3172,cn_comment#3173] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#3247 AS rid_3#3272, cval_part_p_name#3248 AS cval_part_p_name_3#3273, cval_part_p_mfgr#3249 AS cval_part_p_mfgr_3#3274, cval_part_p_type#3250 AS cval_part_p_type_3#3275, cval_part_p_size#3251 AS cval_part_p_size_3#3276, cval_part_p_container#3252 AS cval_part_p_container_3#3277, cval_part_p_retailprice#3253 AS cval_part_p_retailprice_3#3278, cval_part_p_comment#3254 AS cval_part_p_comment_3#3279, cval_part_p_brand#3255 AS cval_part_p_brand_3#3280, cdepval_part_p_name#3256 AS cdepval_part_p_name_3#3281, cdepval_part_p_mfgr#3257 AS cdepval_part_p_mfgr_3#3282, cdepval_part_p_type#3258 AS cdepval_part_p_type_3#3283, cdepval_part_p_size#3259 AS cdepval_part_p_size_3#3284, cdepval_part_p_container#3260 AS cdepval_part_p_container_3#3285, cdepval_part_p_retailprice#3261 AS cdepval_part_p_retailprice_3#3286, cdepval_part_p_comment#3262 AS cdepval_part_p_comment_3#3287, cdepval_part_p_brand#3263 AS cdepval_part_p_brand_3#3288, cp_name#3264 AS cp_name_3#3289, cp_mfgr#3265 AS cp_mfgr_3#3290, cp_type#3266 AS cp_type_3#3291, cp_size#3267 AS cp_size_3#3292, cp_container#3268 AS cp_container_3#3293, cp_retailprice#3269 AS cp_retailprice_3#3294, cp_comment#3270 AS cp_comment_3#3295, cp_brand#3271 AS cp_brand_3#3296]
         :        +- Relation[rid#3247,cval_part_p_name#3248,cval_part_p_mfgr#3249,cval_part_p_type#3250,cval_part_p_size#3251,cval_part_p_container#3252,cval_part_p_retailprice#3253,cval_part_p_comment#3254,cval_part_p_brand#3255,cdepval_part_p_name#3256,cdepval_part_p_mfgr#3257,cdepval_part_p_type#3258,cdepval_part_p_size#3259,cdepval_part_p_container#3260,cdepval_part_p_retailprice#3261,cdepval_part_p_comment#3262,cdepval_part_p_brand#3263,cp_name#3264,cp_mfgr#3265,cp_type#3266,cp_size#3267,cp_container#3268,cp_retailprice#3269,cp_comment#3270,cp_brand#3271] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#3387 AS rid_5#3411, cpfk_customer_orders#3388 AS cpfk_customer_orders_5#3412, cfpk_orders_customer#3389 AS cfpk_orders_customer_5#3413, cval_orders_o_orderstatus#3390 AS cval_orders_o_orderstatus_5#3414, cval_orders_o_totalprice#3391 AS cval_orders_o_totalprice_5#3415, cval_orders_o_orderpriority#3392 AS cval_orders_o_orderpriority_5#3416, cval_orders_o_clerk#3393 AS cval_orders_o_clerk_5#3417, cval_orders_o_shippriority#3394 AS cval_orders_o_shippriority_5#3418, cval_orders_o_comment#3395 AS cval_orders_o_comment_5#3419, cval_orders_o_orderdate#3396 AS cval_orders_o_orderdate_5#3420, cdepval_orders_o_orderstatus#3397 AS cdepval_orders_o_orderstatus_5#3421, cdepval_orders_o_totalprice#3398 AS cdepval_orders_o_totalprice_5#3422, cdepval_orders_o_orderpriority#3399 AS cdepval_orders_o_orderpriority_5#3423, cdepval_orders_o_clerk#3400 AS cdepval_orders_o_clerk_5#3424, cdepval_orders_o_shippriority#3401 AS cdepval_orders_o_shippriority_5#3425, cdepval_orders_o_comment#3402 AS cdepval_orders_o_comment_5#3426, cdepval_orders_o_orderdate#3403 AS cdepval_orders_o_orderdate_5#3427, co_orderstatus#3404 AS co_orderstatus_5#3428, co_totalprice#3405 AS co_totalprice_5#3429, co_orderpriority#3406 AS co_orderpriority_5#3430, co_clerk#3407 AS co_clerk_5#3431, co_shippriority#3408 AS co_shippriority_5#3432, co_comment#3409 AS co_comment_5#3433, co_orderdate#3410 AS co_orderdate_5#3434]
            +- Relation[rid#3387,cpfk_customer_orders#3388,cfpk_orders_customer#3389,cval_orders_o_orderstatus#3390,cval_orders_o_totalprice#3391,cval_orders_o_orderpriority#3392,cval_orders_o_clerk#3393,cval_orders_o_shippriority#3394,cval_orders_o_comment#3395,cval_orders_o_orderdate#3396,cdepval_orders_o_orderstatus#3397,cdepval_orders_o_totalprice#3398,cdepval_orders_o_orderpriority#3399,cdepval_orders_o_clerk#3400,cdepval_orders_o_shippriority#3401,cdepval_orders_o_comment#3402,cdepval_orders_o_orderdate#3403,co_orderstatus#3404,co_totalprice#3405,co_orderpriority#3406,co_clerk#3407,co_shippriority#3408,co_comment#3409,co_orderdate#3410] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 38164ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/25 23:11:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:11:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3575L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:11:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:11:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:11:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:11:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:11:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:11:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:11:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:11:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3575L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#3602, cval_part_p_name_0#3603, cval_part_p_mfgr_0#3604, cval_part_p_type_0#3605, cval_part_p_size_0#3606, cval_part_p_container_0#3607, cval_part_p_retailprice_0#3608, cval_part_p_comment_0#3609, cval_part_p_brand_0#3610, cdepval_part_p_name_0#3611, cdepval_part_p_mfgr_0#3612, cdepval_part_p_type_0#3613, cdepval_part_p_size_0#3614, cdepval_part_p_container_0#3615, cdepval_part_p_retailprice_0#3616, cdepval_part_p_comment_0#3617, cdepval_part_p_brand_0#3618, cp_name_0#3619, cp_mfgr_0#3620, cp_type_0#3621, cp_size_0#3622, cp_container_0#3623, cp_retailprice_0#3624, cp_comment_0#3625, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#3577 AS rid_0#3602, cval_part_p_name#3578 AS cval_part_p_name_0#3603, cval_part_p_mfgr#3579 AS cval_part_p_mfgr_0#3604, cval_part_p_type#3580 AS cval_part_p_type_0#3605, cval_part_p_size#3581 AS cval_part_p_size_0#3606, cval_part_p_container#3582 AS cval_part_p_container_0#3607, cval_part_p_retailprice#3583 AS cval_part_p_retailprice_0#3608, cval_part_p_comment#3584 AS cval_part_p_comment_0#3609, cval_part_p_brand#3585 AS cval_part_p_brand_0#3610, cdepval_part_p_name#3586 AS cdepval_part_p_name_0#3611, cdepval_part_p_mfgr#3587 AS cdepval_part_p_mfgr_0#3612, cdepval_part_p_type#3588 AS cdepval_part_p_type_0#3613, cdepval_part_p_size#3589 AS cdepval_part_p_size_0#3614, cdepval_part_p_container#3590 AS cdepval_part_p_container_0#3615, cdepval_part_p_retailprice#3591 AS cdepval_part_p_retailprice_0#3616, cdepval_part_p_comment#3592 AS cdepval_part_p_comment_0#3617, cdepval_part_p_brand#3593 AS cdepval_part_p_brand_0#3618, cp_name#3594 AS cp_name_0#3619, cp_mfgr#3595 AS cp_mfgr_0#3620, cp_type#3596 AS cp_type_0#3621, cp_size#3597 AS cp_size_0#3622, cp_container#3598 AS cp_container_0#3623, cp_retailprice#3599 AS cp_retailprice_0#3624, cp_comment#3600 AS cp_comment_0#3625, cp_brand#3601 AS cp_brand_0#3626]
         :  :        +- Relation[rid#3577,cval_part_p_name#3578,cval_part_p_mfgr#3579,cval_part_p_type#3580,cval_part_p_size#3581,cval_part_p_container#3582,cval_part_p_retailprice#3583,cval_part_p_comment#3584,cval_part_p_brand#3585,cdepval_part_p_name#3586,cdepval_part_p_mfgr#3587,cdepval_part_p_type#3588,cdepval_part_p_size#3589,cdepval_part_p_container#3590,cdepval_part_p_retailprice#3591,cdepval_part_p_comment#3592,cdepval_part_p_brand#3593,cp_name#3594,cp_mfgr#3595,cp_type#3596,cp_size#3597,cp_container#3598,cp_retailprice#3599,cp_comment#3600,cp_brand#3601] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#4047 AS rid_1#4092, cpfk_orders_lineitem#4048 AS cpfk_orders_lineitem_1#4093, cpfk_supplier_lineitem#4049 AS cpfk_supplier_lineitem_1#4094, cfpk_lineitem_supplier#4050 AS cfpk_lineitem_supplier_1#4095, cfpk_lineitem_partsupp#4051 AS cfpk_lineitem_partsupp_1#4096, cpfk_part_lineitem#4052 AS cpfk_part_lineitem_1#4097, cfpk_lineitem_part#4053 AS cfpk_lineitem_part_1#4098, cpfk_partsupp_lineitem#4054 AS cpfk_partsupp_lineitem_1#4099, cfpk_lineitem_orders#4055 AS cfpk_lineitem_orders_1#4100, cval_lineitem_l_quantity#4056 AS cval_lineitem_l_quantity_1#4101, cval_lineitem_l_extendedprice#4057 AS cval_lineitem_l_extendedprice_1#4102, cval_lineitem_l_discount#4058 AS cval_lineitem_l_discount_1#4103, cval_lineitem_l_tax#4059 AS cval_lineitem_l_tax_1#4104, cval_lineitem_l_returnflag#4060 AS cval_lineitem_l_returnflag_1#4105, cval_lineitem_l_linestatus#4061 AS cval_lineitem_l_linestatus_1#4106, cval_lineitem_l_commitdate#4062 AS cval_lineitem_l_commitdate_1#4107, cval_lineitem_l_receiptdate#4063 AS cval_lineitem_l_receiptdate_1#4108, cval_lineitem_l_shipinstruct#4064 AS cval_lineitem_l_shipinstruct_1#4109, cval_lineitem_l_shipmode#4065 AS cval_lineitem_l_shipmode_1#4110, cval_lineitem_l_comment#4066 AS cval_lineitem_l_comment_1#4111, cval_lineitem_l_shipdate#4067 AS cval_lineitem_l_shipdate_1#4112, cdepval_lineitem_l_quantity#4068 AS cdepval_lineitem_l_quantity_1#4113, cdepval_lineitem_l_extendedprice#4069 AS cdepval_lineitem_l_extendedprice_1#4114, cdepval_lineitem_l_discount#4070 AS cdepval_lineitem_l_discount_1#4115, ... 21 more fields]
         :        +- Relation[rid#4047,cpfk_orders_lineitem#4048,cpfk_supplier_lineitem#4049,cfpk_lineitem_supplier#4050,cfpk_lineitem_partsupp#4051,cpfk_part_lineitem#4052,cfpk_lineitem_part#4053,cpfk_partsupp_lineitem#4054,cfpk_lineitem_orders#4055,cval_lineitem_l_quantity#4056,cval_lineitem_l_extendedprice#4057,cval_lineitem_l_discount#4058,cval_lineitem_l_tax#4059,cval_lineitem_l_returnflag#4060,cval_lineitem_l_linestatus#4061,cval_lineitem_l_commitdate#4062,cval_lineitem_l_receiptdate#4063,cval_lineitem_l_shipinstruct#4064,cval_lineitem_l_shipmode#4065,cval_lineitem_l_comment#4066,cval_lineitem_l_shipdate#4067,cdepval_lineitem_l_quantity#4068,cdepval_lineitem_l_extendedprice#4069,cdepval_lineitem_l_discount#4070,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#3727 AS rid_1#3772, cpfk_orders_lineitem#3728 AS cpfk_orders_lineitem_1#3773, cpfk_supplier_lineitem#3729 AS cpfk_supplier_lineitem_1#3774, cfpk_lineitem_supplier#3730 AS cfpk_lineitem_supplier_1#3775, cfpk_lineitem_partsupp#3731 AS cfpk_lineitem_partsupp_1#3776, cpfk_part_lineitem#3732 AS cpfk_part_lineitem_1#3777, cfpk_lineitem_part#3733 AS cfpk_lineitem_part_1#3778, cpfk_partsupp_lineitem#3734 AS cpfk_partsupp_lineitem_1#3779, cfpk_lineitem_orders#3735 AS cfpk_lineitem_orders_1#3780, cval_lineitem_l_quantity#3736 AS cval_lineitem_l_quantity_1#3781, cval_lineitem_l_extendedprice#3737 AS cval_lineitem_l_extendedprice_1#3782, cval_lineitem_l_discount#3738 AS cval_lineitem_l_discount_1#3783, cval_lineitem_l_tax#3739 AS cval_lineitem_l_tax_1#3784, cval_lineitem_l_returnflag#3740 AS cval_lineitem_l_returnflag_1#3785, cval_lineitem_l_linestatus#3741 AS cval_lineitem_l_linestatus_1#3786, cval_lineitem_l_commitdate#3742 AS cval_lineitem_l_commitdate_1#3787, cval_lineitem_l_receiptdate#3743 AS cval_lineitem_l_receiptdate_1#3788, cval_lineitem_l_shipinstruct#3744 AS cval_lineitem_l_shipinstruct_1#3789, cval_lineitem_l_shipmode#3745 AS cval_lineitem_l_shipmode_1#3790, cval_lineitem_l_comment#3746 AS cval_lineitem_l_comment_1#3791, cval_lineitem_l_shipdate#3747 AS cval_lineitem_l_shipdate_1#3792, cdepval_lineitem_l_quantity#3748 AS cdepval_lineitem_l_quantity_1#3793, cdepval_lineitem_l_extendedprice#3749 AS cdepval_lineitem_l_extendedprice_1#3794, cdepval_lineitem_l_discount#3750 AS cdepval_lineitem_l_discount_1#3795, ... 21 more fields]
                  +- Relation[rid#3727,cpfk_orders_lineitem#3728,cpfk_supplier_lineitem#3729,cfpk_lineitem_supplier#3730,cfpk_lineitem_partsupp#3731,cpfk_part_lineitem#3732,cfpk_lineitem_part#3733,cpfk_partsupp_lineitem#3734,cfpk_lineitem_orders#3735,cval_lineitem_l_quantity#3736,cval_lineitem_l_extendedprice#3737,cval_lineitem_l_discount#3738,cval_lineitem_l_tax#3739,cval_lineitem_l_returnflag#3740,cval_lineitem_l_linestatus#3741,cval_lineitem_l_commitdate#3742,cval_lineitem_l_receiptdate#3743,cval_lineitem_l_shipinstruct#3744,cval_lineitem_l_shipmode#3745,cval_lineitem_l_comment#3746,cval_lineitem_l_shipdate#3747,cdepval_lineitem_l_quantity#3748,cdepval_lineitem_l_extendedprice#3749,cdepval_lineitem_l_discount#3750,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 14995ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/25 23:11:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:11:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4235L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:11:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4235L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#4237 AS rid_0#4282, cpfk_orders_lineitem#4238 AS cpfk_orders_lineitem_0#4283, cpfk_supplier_lineitem#4239 AS cpfk_supplier_lineitem_0#4284, cfpk_lineitem_supplier#4240 AS cfpk_lineitem_supplier_0#4285, cfpk_lineitem_partsupp#4241 AS cfpk_lineitem_partsupp_0#4286, cpfk_part_lineitem#4242 AS cpfk_part_lineitem_0#4287, cfpk_lineitem_part#4243 AS cfpk_lineitem_part_0#4288, cpfk_partsupp_lineitem#4244 AS cpfk_partsupp_lineitem_0#4289, cfpk_lineitem_orders#4245 AS cfpk_lineitem_orders_0#4290, cval_lineitem_l_quantity#4246 AS cval_lineitem_l_quantity_0#4291, cval_lineitem_l_extendedprice#4247 AS cval_lineitem_l_extendedprice_0#4292, cval_lineitem_l_discount#4248 AS cval_lineitem_l_discount_0#4293, cval_lineitem_l_tax#4249 AS cval_lineitem_l_tax_0#4294, cval_lineitem_l_returnflag#4250 AS cval_lineitem_l_returnflag_0#4295, cval_lineitem_l_linestatus#4251 AS cval_lineitem_l_linestatus_0#4296, cval_lineitem_l_commitdate#4252 AS cval_lineitem_l_commitdate_0#4297, cval_lineitem_l_receiptdate#4253 AS cval_lineitem_l_receiptdate_0#4298, cval_lineitem_l_shipinstruct#4254 AS cval_lineitem_l_shipinstruct_0#4299, cval_lineitem_l_shipmode#4255 AS cval_lineitem_l_shipmode_0#4300, cval_lineitem_l_comment#4256 AS cval_lineitem_l_comment_0#4301, cval_lineitem_l_shipdate#4257 AS cval_lineitem_l_shipdate_0#4302, cdepval_lineitem_l_quantity#4258 AS cdepval_lineitem_l_quantity_0#4303, cdepval_lineitem_l_extendedprice#4259 AS cdepval_lineitem_l_extendedprice_0#4304, cdepval_lineitem_l_discount#4260 AS cdepval_lineitem_l_discount_0#4305, ... 21 more fields]
         :  +- Relation[rid#4237,cpfk_orders_lineitem#4238,cpfk_supplier_lineitem#4239,cfpk_lineitem_supplier#4240,cfpk_lineitem_partsupp#4241,cpfk_part_lineitem#4242,cfpk_lineitem_part#4243,cpfk_partsupp_lineitem#4244,cfpk_lineitem_orders#4245,cval_lineitem_l_quantity#4246,cval_lineitem_l_extendedprice#4247,cval_lineitem_l_discount#4248,cval_lineitem_l_tax#4249,cval_lineitem_l_returnflag#4250,cval_lineitem_l_linestatus#4251,cval_lineitem_l_commitdate#4252,cval_lineitem_l_receiptdate#4253,cval_lineitem_l_shipinstruct#4254,cval_lineitem_l_shipmode#4255,cval_lineitem_l_comment#4256,cval_lineitem_l_shipdate#4257,cdepval_lineitem_l_quantity#4258,cdepval_lineitem_l_extendedprice#4259,cdepval_lineitem_l_discount#4260,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4327 AS rid_1#4351, cpfk_customer_orders#4328 AS cpfk_customer_orders_1#4352, cfpk_orders_customer#4329 AS cfpk_orders_customer_1#4353, cval_orders_o_orderstatus#4330 AS cval_orders_o_orderstatus_1#4354, cval_orders_o_totalprice#4331 AS cval_orders_o_totalprice_1#4355, cval_orders_o_orderpriority#4332 AS cval_orders_o_orderpriority_1#4356, cval_orders_o_clerk#4333 AS cval_orders_o_clerk_1#4357, cval_orders_o_shippriority#4334 AS cval_orders_o_shippriority_1#4358, cval_orders_o_comment#4335 AS cval_orders_o_comment_1#4359, cval_orders_o_orderdate#4336 AS cval_orders_o_orderdate_1#4360, cdepval_orders_o_orderstatus#4337 AS cdepval_orders_o_orderstatus_1#4361, cdepval_orders_o_totalprice#4338 AS cdepval_orders_o_totalprice_1#4362, cdepval_orders_o_orderpriority#4339 AS cdepval_orders_o_orderpriority_1#4363, cdepval_orders_o_clerk#4340 AS cdepval_orders_o_clerk_1#4364, cdepval_orders_o_shippriority#4341 AS cdepval_orders_o_shippriority_1#4365, cdepval_orders_o_comment#4342 AS cdepval_orders_o_comment_1#4366, cdepval_orders_o_orderdate#4343 AS cdepval_orders_o_orderdate_1#4367, co_orderstatus#4344 AS co_orderstatus_1#4368, co_totalprice#4345 AS co_totalprice_1#4369, co_orderpriority#4346 AS co_orderpriority_1#4370, co_clerk#4347 AS co_clerk_1#4371, co_shippriority#4348 AS co_shippriority_1#4372, co_comment#4349 AS co_comment_1#4373, co_orderdate#4350 AS co_orderdate_1#4374]
            +- Relation[rid#4327,cpfk_customer_orders#4328,cfpk_orders_customer#4329,cval_orders_o_orderstatus#4330,cval_orders_o_totalprice#4331,cval_orders_o_orderpriority#4332,cval_orders_o_clerk#4333,cval_orders_o_shippriority#4334,cval_orders_o_comment#4335,cval_orders_o_orderdate#4336,cdepval_orders_o_orderstatus#4337,cdepval_orders_o_totalprice#4338,cdepval_orders_o_orderpriority#4339,cdepval_orders_o_clerk#4340,cdepval_orders_o_shippriority#4341,cdepval_orders_o_comment#4342,cdepval_orders_o_orderdate#4343,co_orderstatus#4344,co_totalprice#4345,co_orderpriority#4346,co_clerk#4347,co_shippriority#4348,co_comment#4349,co_orderdate#4350] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18331ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/25 23:11:35 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:11:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4456L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 23:11:35 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:11:35 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:11:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4456L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#4458 AS rid_0#4503, cpfk_orders_lineitem#4459 AS cpfk_orders_lineitem_0#4504, cpfk_supplier_lineitem#4460 AS cpfk_supplier_lineitem_0#4505, cfpk_lineitem_supplier#4461 AS cfpk_lineitem_supplier_0#4506, cfpk_lineitem_partsupp#4462 AS cfpk_lineitem_partsupp_0#4507, cpfk_part_lineitem#4463 AS cpfk_part_lineitem_0#4508, cfpk_lineitem_part#4464 AS cfpk_lineitem_part_0#4509, cpfk_partsupp_lineitem#4465 AS cpfk_partsupp_lineitem_0#4510, cfpk_lineitem_orders#4466 AS cfpk_lineitem_orders_0#4511, cval_lineitem_l_quantity#4467 AS cval_lineitem_l_quantity_0#4512, cval_lineitem_l_extendedprice#4468 AS cval_lineitem_l_extendedprice_0#4513, cval_lineitem_l_discount#4469 AS cval_lineitem_l_discount_0#4514, cval_lineitem_l_tax#4470 AS cval_lineitem_l_tax_0#4515, cval_lineitem_l_returnflag#4471 AS cval_lineitem_l_returnflag_0#4516, cval_lineitem_l_linestatus#4472 AS cval_lineitem_l_linestatus_0#4517, cval_lineitem_l_commitdate#4473 AS cval_lineitem_l_commitdate_0#4518, cval_lineitem_l_receiptdate#4474 AS cval_lineitem_l_receiptdate_0#4519, cval_lineitem_l_shipinstruct#4475 AS cval_lineitem_l_shipinstruct_0#4520, cval_lineitem_l_shipmode#4476 AS cval_lineitem_l_shipmode_0#4521, cval_lineitem_l_comment#4477 AS cval_lineitem_l_comment_0#4522, cval_lineitem_l_shipdate#4478 AS cval_lineitem_l_shipdate_0#4523, cdepval_lineitem_l_quantity#4479 AS cdepval_lineitem_l_quantity_0#4524, cdepval_lineitem_l_extendedprice#4480 AS cdepval_lineitem_l_extendedprice_0#4525, cdepval_lineitem_l_discount#4481 AS cdepval_lineitem_l_discount_0#4526, ... 21 more fields]
         :  :  :     +- Relation[rid#4458,cpfk_orders_lineitem#4459,cpfk_supplier_lineitem#4460,cfpk_lineitem_supplier#4461,cfpk_lineitem_partsupp#4462,cpfk_part_lineitem#4463,cfpk_lineitem_part#4464,cpfk_partsupp_lineitem#4465,cfpk_lineitem_orders#4466,cval_lineitem_l_quantity#4467,cval_lineitem_l_extendedprice#4468,cval_lineitem_l_discount#4469,cval_lineitem_l_tax#4470,cval_lineitem_l_returnflag#4471,cval_lineitem_l_linestatus#4472,cval_lineitem_l_commitdate#4473,cval_lineitem_l_receiptdate#4474,cval_lineitem_l_shipinstruct#4475,cval_lineitem_l_shipmode#4476,cval_lineitem_l_comment#4477,cval_lineitem_l_shipdate#4478,cdepval_lineitem_l_quantity#4479,cdepval_lineitem_l_extendedprice#4480,cdepval_lineitem_l_discount#4481,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#4638 AS rid_1#4662, cpfk_customer_orders#4639 AS cpfk_customer_orders_1#4663, cfpk_orders_customer#4640 AS cfpk_orders_customer_1#4664, cval_orders_o_orderstatus#4641 AS cval_orders_o_orderstatus_1#4665, cval_orders_o_totalprice#4642 AS cval_orders_o_totalprice_1#4666, cval_orders_o_orderpriority#4643 AS cval_orders_o_orderpriority_1#4667, cval_orders_o_clerk#4644 AS cval_orders_o_clerk_1#4668, cval_orders_o_shippriority#4645 AS cval_orders_o_shippriority_1#4669, cval_orders_o_comment#4646 AS cval_orders_o_comment_1#4670, cval_orders_o_orderdate#4647 AS cval_orders_o_orderdate_1#4671, cdepval_orders_o_orderstatus#4648 AS cdepval_orders_o_orderstatus_1#4672, cdepval_orders_o_totalprice#4649 AS cdepval_orders_o_totalprice_1#4673, cdepval_orders_o_orderpriority#4650 AS cdepval_orders_o_orderpriority_1#4674, cdepval_orders_o_clerk#4651 AS cdepval_orders_o_clerk_1#4675, cdepval_orders_o_shippriority#4652 AS cdepval_orders_o_shippriority_1#4676, cdepval_orders_o_comment#4653 AS cdepval_orders_o_comment_1#4677, cdepval_orders_o_orderdate#4654 AS cdepval_orders_o_orderdate_1#4678, co_orderstatus#4655 AS co_orderstatus_1#4679, co_totalprice#4656 AS co_totalprice_1#4680, co_orderpriority#4657 AS co_orderpriority_1#4681, co_clerk#4658 AS co_clerk_1#4682, co_shippriority#4659 AS co_shippriority_1#4683, co_comment#4660 AS co_comment_1#4684, co_orderdate#4661 AS co_orderdate_1#4685]
         :  :     +- Relation[rid#4638,cpfk_customer_orders#4639,cfpk_orders_customer#4640,cval_orders_o_orderstatus#4641,cval_orders_o_totalprice#4642,cval_orders_o_orderpriority#4643,cval_orders_o_clerk#4644,cval_orders_o_shippriority#4645,cval_orders_o_comment#4646,cval_orders_o_orderdate#4647,cdepval_orders_o_orderstatus#4648,cdepval_orders_o_totalprice#4649,cdepval_orders_o_orderpriority#4650,cdepval_orders_o_clerk#4651,cdepval_orders_o_shippriority#4652,cdepval_orders_o_comment#4653,cdepval_orders_o_orderdate#4654,co_orderstatus#4655,co_totalprice#4656,co_orderpriority#4657,co_clerk#4658,co_shippriority#4659,co_comment#4660,co_orderdate#4661] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#4686 AS rid_2#4707, cpfk_nation_customer#4687 AS cpfk_nation_customer_2#4708, cfpk_customer_nation#4688 AS cfpk_customer_nation_2#4709, cval_customer_c_name#4689 AS cval_customer_c_name_2#4710, cval_customer_c_address#4690 AS cval_customer_c_address_2#4711, cval_customer_c_phone#4691 AS cval_customer_c_phone_2#4712, cval_customer_c_acctbal#4692 AS cval_customer_c_acctbal_2#4713, cval_customer_c_comment#4693 AS cval_customer_c_comment_2#4714, cval_customer_c_mktsegment#4694 AS cval_customer_c_mktsegment_2#4715, cdepval_customer_c_name#4695 AS cdepval_customer_c_name_2#4716, cdepval_customer_c_address#4696 AS cdepval_customer_c_address_2#4717, cdepval_customer_c_phone#4697 AS cdepval_customer_c_phone_2#4718, cdepval_customer_c_acctbal#4698 AS cdepval_customer_c_acctbal_2#4719, cdepval_customer_c_comment#4699 AS cdepval_customer_c_comment_2#4720, cdepval_customer_c_mktsegment#4700 AS cdepval_customer_c_mktsegment_2#4721, cc_name#4701 AS cc_name_2#4722, cc_address#4702 AS cc_address_2#4723, cc_phone#4703 AS cc_phone_2#4724, cc_acctbal#4704 AS cc_acctbal_2#4725, cc_comment#4705 AS cc_comment_2#4726, cc_mktsegment#4706 AS cc_mktsegment_2#4727]
         :     +- Relation[rid#4686,cpfk_nation_customer#4687,cfpk_customer_nation#4688,cval_customer_c_name#4689,cval_customer_c_address#4690,cval_customer_c_phone#4691,cval_customer_c_acctbal#4692,cval_customer_c_comment#4693,cval_customer_c_mktsegment#4694,cdepval_customer_c_name#4695,cdepval_customer_c_address#4696,cdepval_customer_c_phone#4697,cdepval_customer_c_acctbal#4698,cdepval_customer_c_comment#4699,cdepval_customer_c_mktsegment#4700,cc_name#4701,cc_address#4702,cc_phone#4703,cc_acctbal#4704,cc_comment#4705,cc_mktsegment#4706] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#4728 AS rid_3#4737, cpfk_region_nation#4729 AS cpfk_region_nation_3#4738, cfpk_nation_region#4730 AS cfpk_nation_region_3#4739, cval_nation_n_name#4731 AS cval_nation_n_name_3#4740, cval_nation_n_comment#4732 AS cval_nation_n_comment_3#4741, cdepval_nation_n_name#4733 AS cdepval_nation_n_name_3#4742, cdepval_nation_n_comment#4734 AS cdepval_nation_n_comment_3#4743, cn_name#4735 AS cn_name_3#4744, cn_comment#4736 AS cn_comment_3#4745]
            +- Relation[rid#4728,cpfk_region_nation#4729,cfpk_nation_region#4730,cval_nation_n_name#4731,cval_nation_n_comment#4732,cdepval_nation_n_name#4733,cdepval_nation_n_comment#4734,cn_name#4735,cn_comment#4736] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 60178ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/25 23:12:35 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:12:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4852L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 23:12:35 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:12:35 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:12:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4852L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :- Project [rid#4954 AS rid_1#4968, cpfk_part_partsupp#4955 AS cpfk_part_partsupp_1#4969, cfpk_partsupp_part#4956 AS cfpk_partsupp_part_1#4970, cpfk_supplier_partsupp#4957 AS cpfk_supplier_partsupp_1#4971, cfpk_partsupp_supplier#4958 AS cfpk_partsupp_supplier_1#4972, cval_partsupp_ps_availqty#4959 AS cval_partsupp_ps_availqty_1#4973, cval_partsupp_ps_supplycost#4960 AS cval_partsupp_ps_supplycost_1#4974, cval_partsupp_ps_comment#4961 AS cval_partsupp_ps_comment_1#4975, cdepval_partsupp_ps_availqty#4962 AS cdepval_partsupp_ps_availqty_1#4976, cdepval_partsupp_ps_supplycost#4963 AS cdepval_partsupp_ps_supplycost_1#4977, cdepval_partsupp_ps_comment#4964 AS cdepval_partsupp_ps_comment_1#4978, cps_availqty#4965 AS cps_availqty_1#4979, cps_supplycost#4966 AS cps_supplycost_1#4980, cps_comment#4967 AS cps_comment_1#4981]
         :  +- Relation[rid#4954,cpfk_part_partsupp#4955,cfpk_partsupp_part#4956,cpfk_supplier_partsupp#4957,cfpk_partsupp_supplier#4958,cval_partsupp_ps_availqty#4959,cval_partsupp_ps_supplycost#4960,cval_partsupp_ps_comment#4961,cdepval_partsupp_ps_availqty#4962,cdepval_partsupp_ps_supplycost#4963,cdepval_partsupp_ps_comment#4964,cps_availqty#4965,cps_supplycost#4966,cps_comment#4967] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
            +- Project [rid#4854 AS rid_0#4879, cval_part_p_name#4855 AS cval_part_p_name_0#4880, cval_part_p_mfgr#4856 AS cval_part_p_mfgr_0#4881, cval_part_p_type#4857 AS cval_part_p_type_0#4882, cval_part_p_size#4858 AS cval_part_p_size_0#4883, cval_part_p_container#4859 AS cval_part_p_container_0#4884, cval_part_p_retailprice#4860 AS cval_part_p_retailprice_0#4885, cval_part_p_comment#4861 AS cval_part_p_comment_0#4886, cval_part_p_brand#4862 AS cval_part_p_brand_0#4887, cdepval_part_p_name#4863 AS cdepval_part_p_name_0#4888, cdepval_part_p_mfgr#4864 AS cdepval_part_p_mfgr_0#4889, cdepval_part_p_type#4865 AS cdepval_part_p_type_0#4890, cdepval_part_p_size#4866 AS cdepval_part_p_size_0#4891, cdepval_part_p_container#4867 AS cdepval_part_p_container_0#4892, cdepval_part_p_retailprice#4868 AS cdepval_part_p_retailprice_0#4893, cdepval_part_p_comment#4869 AS cdepval_part_p_comment_0#4894, cdepval_part_p_brand#4870 AS cdepval_part_p_brand_0#4895, cp_name#4871 AS cp_name_0#4896, cp_mfgr#4872 AS cp_mfgr_0#4897, cp_type#4873 AS cp_type_0#4898, cp_size#4874 AS cp_size_0#4899, cp_container#4875 AS cp_container_0#4900, cp_retailprice#4876 AS cp_retailprice_0#4901, cp_comment#4877 AS cp_comment_0#4902, cp_brand#4878 AS cp_brand_0#4903]
               +- Relation[rid#4854,cval_part_p_name#4855,cval_part_p_mfgr#4856,cval_part_p_type#4857,cval_part_p_size#4858,cval_part_p_container#4859,cval_part_p_retailprice#4860,cval_part_p_comment#4861,cval_part_p_brand#4862,cdepval_part_p_name#4863,cdepval_part_p_mfgr#4864,cdepval_part_p_type#4865,cdepval_part_p_size#4866,cdepval_part_p_container#4867,cdepval_part_p_retailprice#4868,cdepval_part_p_comment#4869,cdepval_part_p_brand#4870,cp_name#4871,cp_mfgr#4872,cp_type#4873,cp_size#4874,cp_container#4875,cp_retailprice#4876,cp_comment#4877,cp_brand#4878] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 3617ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/25 23:12:39 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:12:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5025L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 23:12:39 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:12:39 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:12:39 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:12:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:12:39 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:12:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:12:39 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:12:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:12:39 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:12:39 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:12:39 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:12:39 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:12:39 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:12:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5025L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_part_4) = 'rid_3)
         :  :- Project [rid#5209 AS rid_4#5223, cpfk_part_partsupp#5210 AS cpfk_part_partsupp_4#5224, cfpk_partsupp_part#5211 AS cfpk_partsupp_part_4#5225, cpfk_supplier_partsupp#5212 AS cpfk_supplier_partsupp_4#5226, cfpk_partsupp_supplier#5213 AS cfpk_partsupp_supplier_4#5227, cval_partsupp_ps_availqty#5214 AS cval_partsupp_ps_availqty_4#5228, cval_partsupp_ps_supplycost#5215 AS cval_partsupp_ps_supplycost_4#5229, cval_partsupp_ps_comment#5216 AS cval_partsupp_ps_comment_4#5230, cdepval_partsupp_ps_availqty#5217 AS cdepval_partsupp_ps_availqty_4#5231, cdepval_partsupp_ps_supplycost#5218 AS cdepval_partsupp_ps_supplycost_4#5232, cdepval_partsupp_ps_comment#5219 AS cdepval_partsupp_ps_comment_4#5233, cps_availqty#5220 AS cps_availqty_4#5234, cps_supplycost#5221 AS cps_supplycost_4#5235, cps_comment#5222 AS cps_comment_4#5236]
         :  :  +- Relation[rid#5209,cpfk_part_partsupp#5210,cfpk_partsupp_part#5211,cpfk_supplier_partsupp#5212,cfpk_partsupp_supplier#5213,cval_partsupp_ps_availqty#5214,cval_partsupp_ps_supplycost#5215,cval_partsupp_ps_comment#5216,cdepval_partsupp_ps_availqty#5217,cdepval_partsupp_ps_supplycost#5218,cdepval_partsupp_ps_comment#5219,cps_availqty#5220,cps_supplycost#5221,cps_comment#5222] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :     +- Project [rid#5109 AS rid_3#5134, cval_part_p_name#5110 AS cval_part_p_name_3#5135, cval_part_p_mfgr#5111 AS cval_part_p_mfgr_3#5136, cval_part_p_type#5112 AS cval_part_p_type_3#5137, cval_part_p_size#5113 AS cval_part_p_size_3#5138, cval_part_p_container#5114 AS cval_part_p_container_3#5139, cval_part_p_retailprice#5115 AS cval_part_p_retailprice_3#5140, cval_part_p_comment#5116 AS cval_part_p_comment_3#5141, cval_part_p_brand#5117 AS cval_part_p_brand_3#5142, cdepval_part_p_name#5118 AS cdepval_part_p_name_3#5143, cdepval_part_p_mfgr#5119 AS cdepval_part_p_mfgr_3#5144, cdepval_part_p_type#5120 AS cdepval_part_p_type_3#5145, cdepval_part_p_size#5121 AS cdepval_part_p_size_3#5146, cdepval_part_p_container#5122 AS cdepval_part_p_container_3#5147, cdepval_part_p_retailprice#5123 AS cdepval_part_p_retailprice_3#5148, cdepval_part_p_comment#5124 AS cdepval_part_p_comment_3#5149, cdepval_part_p_brand#5125 AS cdepval_part_p_brand_3#5150, cp_name#5126 AS cp_name_3#5151, cp_mfgr#5127 AS cp_mfgr_3#5152, cp_type#5128 AS cp_type_3#5153, cp_size#5129 AS cp_size_3#5154, cp_container#5130 AS cp_container_3#5155, cp_retailprice#5131 AS cp_retailprice_3#5156, cp_comment#5132 AS cp_comment_3#5157, cp_brand#5133 AS cp_brand_3#5158]
         :        +- Relation[rid#5109,cval_part_p_name#5110,cval_part_p_mfgr#5111,cval_part_p_type#5112,cval_part_p_size#5113,cval_part_p_container#5114,cval_part_p_retailprice#5115,cval_part_p_comment#5116,cval_part_p_brand#5117,cdepval_part_p_name#5118,cdepval_part_p_mfgr#5119,cdepval_part_p_type#5120,cdepval_part_p_size#5121,cdepval_part_p_container#5122,cdepval_part_p_retailprice#5123,cdepval_part_p_comment#5124,cdepval_part_p_brand#5125,cp_name#5126,cp_mfgr#5127,cp_type#5128,cp_size#5129,cp_container#5130,cp_retailprice#5131,cp_comment#5132,cp_brand#5133] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#5073 AS rid_2#5091, cpfk_nation_supplier#5074 AS cpfk_nation_supplier_2#5092, cfpk_supplier_nation#5075 AS cfpk_supplier_nation_2#5093, cval_supplier_s_name#5076 AS cval_supplier_s_name_2#5094, cval_supplier_s_address#5077 AS cval_supplier_s_address_2#5095, cval_supplier_s_phone#5078 AS cval_supplier_s_phone_2#5096, cval_supplier_s_acctbal#5079 AS cval_supplier_s_acctbal_2#5097, cval_supplier_s_comment#5080 AS cval_supplier_s_comment_2#5098, cdepval_supplier_s_name#5081 AS cdepval_supplier_s_name_2#5099, cdepval_supplier_s_address#5082 AS cdepval_supplier_s_address_2#5100, cdepval_supplier_s_phone#5083 AS cdepval_supplier_s_phone_2#5101, cdepval_supplier_s_acctbal#5084 AS cdepval_supplier_s_acctbal_2#5102, cdepval_supplier_s_comment#5085 AS cdepval_supplier_s_comment_2#5103, cs_name#5086 AS cs_name_2#5104, cs_address#5087 AS cs_address_2#5105, cs_phone#5088 AS cs_phone_2#5106, cs_acctbal#5089 AS cs_acctbal_2#5107, cs_comment#5090 AS cs_comment_2#5108]
            :  +- Relation[rid#5073,cpfk_nation_supplier#5074,cfpk_supplier_nation#5075,cval_supplier_s_name#5076,cval_supplier_s_address#5077,cval_supplier_s_phone#5078,cval_supplier_s_acctbal#5079,cval_supplier_s_comment#5080,cdepval_supplier_s_name#5081,cdepval_supplier_s_address#5082,cdepval_supplier_s_phone#5083,cdepval_supplier_s_acctbal#5084,cdepval_supplier_s_comment#5085,cs_name#5086,cs_address#5087,cs_phone#5088,cs_acctbal#5089,cs_comment#5090] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
               :- Project [rid#5055 AS rid_1#5064, cpfk_region_nation#5056 AS cpfk_region_nation_1#5065, cfpk_nation_region#5057 AS cfpk_nation_region_1#5066, cval_nation_n_name#5058 AS cval_nation_n_name_1#5067, cval_nation_n_comment#5059 AS cval_nation_n_comment_1#5068, cdepval_nation_n_name#5060 AS cdepval_nation_n_name_1#5069, cdepval_nation_n_comment#5061 AS cdepval_nation_n_comment_1#5070, cn_name#5062 AS cn_name_1#5071, cn_comment#5063 AS cn_comment_1#5072]
               :  +- Relation[rid#5055,cpfk_region_nation#5056,cfpk_nation_region#5057,cval_nation_n_name#5058,cval_nation_n_comment#5059,cdepval_nation_n_name#5060,cdepval_nation_n_comment#5061,cn_name#5062,cn_comment#5063] JDBCRelation(tnation) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
                  +- Project [rid#5027 AS rid_0#5034, cval_region_r_name#5028 AS cval_region_r_name_0#5035, cval_region_r_comment#5029 AS cval_region_r_comment_0#5036, cdepval_region_r_name#5030 AS cdepval_region_r_name_0#5037, cdepval_region_r_comment#5031 AS cdepval_region_r_comment_0#5038, cr_name#5032 AS cr_name_0#5039, cr_comment#5033 AS cr_comment_0#5040]
                     +- Relation[rid#5027,cval_region_r_name#5028,cval_region_r_comment#5029,cdepval_region_r_name#5030,cdepval_region_r_comment#5031,cr_name#5032,cr_comment#5033] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 3582ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/25 23:12:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:12:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5314L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 23:12:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5314L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#5316 AS rid_0#5340, cpfk_customer_orders#5317 AS cpfk_customer_orders_0#5341, cfpk_orders_customer#5318 AS cfpk_orders_customer_0#5342, cval_orders_o_orderstatus#5319 AS cval_orders_o_orderstatus_0#5343, cval_orders_o_totalprice#5320 AS cval_orders_o_totalprice_0#5344, cval_orders_o_orderpriority#5321 AS cval_orders_o_orderpriority_0#5345, cval_orders_o_clerk#5322 AS cval_orders_o_clerk_0#5346, cval_orders_o_shippriority#5323 AS cval_orders_o_shippriority_0#5347, cval_orders_o_comment#5324 AS cval_orders_o_comment_0#5348, cval_orders_o_orderdate#5325 AS cval_orders_o_orderdate_0#5349, cdepval_orders_o_orderstatus#5326 AS cdepval_orders_o_orderstatus_0#5350, cdepval_orders_o_totalprice#5327 AS cdepval_orders_o_totalprice_0#5351, cdepval_orders_o_orderpriority#5328 AS cdepval_orders_o_orderpriority_0#5352, cdepval_orders_o_clerk#5329 AS cdepval_orders_o_clerk_0#5353, cdepval_orders_o_shippriority#5330 AS cdepval_orders_o_shippriority_0#5354, cdepval_orders_o_comment#5331 AS cdepval_orders_o_comment_0#5355, cdepval_orders_o_orderdate#5332 AS cdepval_orders_o_orderdate_0#5356, co_orderstatus#5333 AS co_orderstatus_0#5357, co_totalprice#5334 AS co_totalprice_0#5358, co_orderpriority#5335 AS co_orderpriority_0#5359, co_clerk#5336 AS co_clerk_0#5360, co_shippriority#5337 AS co_shippriority_0#5361, co_comment#5338 AS co_comment_0#5362, co_orderdate#5339 AS co_orderdate_0#5363]
         :  +- Relation[rid#5316,cpfk_customer_orders#5317,cfpk_orders_customer#5318,cval_orders_o_orderstatus#5319,cval_orders_o_totalprice#5320,cval_orders_o_orderpriority#5321,cval_orders_o_clerk#5322,cval_orders_o_shippriority#5323,cval_orders_o_comment#5324,cval_orders_o_orderdate#5325,cdepval_orders_o_orderstatus#5326,cdepval_orders_o_totalprice#5327,cdepval_orders_o_orderpriority#5328,cdepval_orders_o_clerk#5329,cdepval_orders_o_shippriority#5330,cdepval_orders_o_comment#5331,cdepval_orders_o_orderdate#5332,co_orderstatus#5333,co_totalprice#5334,co_orderpriority#5335,co_clerk#5336,co_shippriority#5337,co_comment#5338,co_orderdate#5339] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#5364 AS rid_1#5385, cpfk_nation_customer#5365 AS cpfk_nation_customer_1#5386, cfpk_customer_nation#5366 AS cfpk_customer_nation_1#5387, cval_customer_c_name#5367 AS cval_customer_c_name_1#5388, cval_customer_c_address#5368 AS cval_customer_c_address_1#5389, cval_customer_c_phone#5369 AS cval_customer_c_phone_1#5390, cval_customer_c_acctbal#5370 AS cval_customer_c_acctbal_1#5391, cval_customer_c_comment#5371 AS cval_customer_c_comment_1#5392, cval_customer_c_mktsegment#5372 AS cval_customer_c_mktsegment_1#5393, cdepval_customer_c_name#5373 AS cdepval_customer_c_name_1#5394, cdepval_customer_c_address#5374 AS cdepval_customer_c_address_1#5395, cdepval_customer_c_phone#5375 AS cdepval_customer_c_phone_1#5396, cdepval_customer_c_acctbal#5376 AS cdepval_customer_c_acctbal_1#5397, cdepval_customer_c_comment#5377 AS cdepval_customer_c_comment_1#5398, cdepval_customer_c_mktsegment#5378 AS cdepval_customer_c_mktsegment_1#5399, cc_name#5379 AS cc_name_1#5400, cc_address#5380 AS cc_address_1#5401, cc_phone#5381 AS cc_phone_1#5402, cc_acctbal#5382 AS cc_acctbal_1#5403, cc_comment#5383 AS cc_comment_1#5404, cc_mktsegment#5384 AS cc_mktsegment_1#5405]
            +- Relation[rid#5364,cpfk_nation_customer#5365,cfpk_customer_nation#5366,cval_customer_c_name#5367,cval_customer_c_address#5368,cval_customer_c_phone#5369,cval_customer_c_acctbal#5370,cval_customer_c_comment#5371,cval_customer_c_mktsegment#5372,cdepval_customer_c_name#5373,cdepval_customer_c_address#5374,cdepval_customer_c_phone#5375,cdepval_customer_c_acctbal#5376,cdepval_customer_c_comment#5377,cdepval_customer_c_mktsegment#5378,cc_name#5379,cc_address#5380,cc_phone#5381,cc_acctbal#5382,cc_comment#5383,cc_mktsegment#5384] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4517ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/25 23:12:47 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:12:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5455L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:12:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5455L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#5457 AS rid_0#5502, cpfk_orders_lineitem#5458 AS cpfk_orders_lineitem_0#5503, cpfk_supplier_lineitem#5459 AS cpfk_supplier_lineitem_0#5504, cfpk_lineitem_supplier#5460 AS cfpk_lineitem_supplier_0#5505, cfpk_lineitem_partsupp#5461 AS cfpk_lineitem_partsupp_0#5506, cpfk_part_lineitem#5462 AS cpfk_part_lineitem_0#5507, cfpk_lineitem_part#5463 AS cfpk_lineitem_part_0#5508, cpfk_partsupp_lineitem#5464 AS cpfk_partsupp_lineitem_0#5509, cfpk_lineitem_orders#5465 AS cfpk_lineitem_orders_0#5510, cval_lineitem_l_quantity#5466 AS cval_lineitem_l_quantity_0#5511, cval_lineitem_l_extendedprice#5467 AS cval_lineitem_l_extendedprice_0#5512, cval_lineitem_l_discount#5468 AS cval_lineitem_l_discount_0#5513, cval_lineitem_l_tax#5469 AS cval_lineitem_l_tax_0#5514, cval_lineitem_l_returnflag#5470 AS cval_lineitem_l_returnflag_0#5515, cval_lineitem_l_linestatus#5471 AS cval_lineitem_l_linestatus_0#5516, cval_lineitem_l_commitdate#5472 AS cval_lineitem_l_commitdate_0#5517, cval_lineitem_l_receiptdate#5473 AS cval_lineitem_l_receiptdate_0#5518, cval_lineitem_l_shipinstruct#5474 AS cval_lineitem_l_shipinstruct_0#5519, cval_lineitem_l_shipmode#5475 AS cval_lineitem_l_shipmode_0#5520, cval_lineitem_l_comment#5476 AS cval_lineitem_l_comment_0#5521, cval_lineitem_l_shipdate#5477 AS cval_lineitem_l_shipdate_0#5522, cdepval_lineitem_l_quantity#5478 AS cdepval_lineitem_l_quantity_0#5523, cdepval_lineitem_l_extendedprice#5479 AS cdepval_lineitem_l_extendedprice_0#5524, cdepval_lineitem_l_discount#5480 AS cdepval_lineitem_l_discount_0#5525, ... 21 more fields]
         :     +- Relation[rid#5457,cpfk_orders_lineitem#5458,cpfk_supplier_lineitem#5459,cfpk_lineitem_supplier#5460,cfpk_lineitem_partsupp#5461,cpfk_part_lineitem#5462,cfpk_lineitem_part#5463,cpfk_partsupp_lineitem#5464,cfpk_lineitem_orders#5465,cval_lineitem_l_quantity#5466,cval_lineitem_l_extendedprice#5467,cval_lineitem_l_discount#5468,cval_lineitem_l_tax#5469,cval_lineitem_l_returnflag#5470,cval_lineitem_l_linestatus#5471,cval_lineitem_l_commitdate#5472,cval_lineitem_l_receiptdate#5473,cval_lineitem_l_shipinstruct#5474,cval_lineitem_l_shipmode#5475,cval_lineitem_l_comment#5476,cval_lineitem_l_shipdate#5477,cdepval_lineitem_l_quantity#5478,cdepval_lineitem_l_extendedprice#5479,cdepval_lineitem_l_discount#5480,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5637 AS rid_1#5661, cpfk_customer_orders#5638 AS cpfk_customer_orders_1#5662, cfpk_orders_customer#5639 AS cfpk_orders_customer_1#5663, cval_orders_o_orderstatus#5640 AS cval_orders_o_orderstatus_1#5664, cval_orders_o_totalprice#5641 AS cval_orders_o_totalprice_1#5665, cval_orders_o_orderpriority#5642 AS cval_orders_o_orderpriority_1#5666, cval_orders_o_clerk#5643 AS cval_orders_o_clerk_1#5667, cval_orders_o_shippriority#5644 AS cval_orders_o_shippriority_1#5668, cval_orders_o_comment#5645 AS cval_orders_o_comment_1#5669, cval_orders_o_orderdate#5646 AS cval_orders_o_orderdate_1#5670, cdepval_orders_o_orderstatus#5647 AS cdepval_orders_o_orderstatus_1#5671, cdepval_orders_o_totalprice#5648 AS cdepval_orders_o_totalprice_1#5672, cdepval_orders_o_orderpriority#5649 AS cdepval_orders_o_orderpriority_1#5673, cdepval_orders_o_clerk#5650 AS cdepval_orders_o_clerk_1#5674, cdepval_orders_o_shippriority#5651 AS cdepval_orders_o_shippriority_1#5675, cdepval_orders_o_comment#5652 AS cdepval_orders_o_comment_1#5676, cdepval_orders_o_orderdate#5653 AS cdepval_orders_o_orderdate_1#5677, co_orderstatus#5654 AS co_orderstatus_1#5678, co_totalprice#5655 AS co_totalprice_1#5679, co_orderpriority#5656 AS co_orderpriority_1#5680, co_clerk#5657 AS co_clerk_1#5681, co_shippriority#5658 AS co_shippriority_1#5682, co_comment#5659 AS co_comment_1#5683, co_orderdate#5660 AS co_orderdate_1#5684]
            +- Relation[rid#5637,cpfk_customer_orders#5638,cfpk_orders_customer#5639,cval_orders_o_orderstatus#5640,cval_orders_o_totalprice#5641,cval_orders_o_orderpriority#5642,cval_orders_o_clerk#5643,cval_orders_o_shippriority#5644,cval_orders_o_comment#5645,cval_orders_o_orderdate#5646,cdepval_orders_o_orderstatus#5647,cdepval_orders_o_totalprice#5648,cdepval_orders_o_orderpriority#5649,cdepval_orders_o_clerk#5650,cdepval_orders_o_shippriority#5651,cdepval_orders_o_comment#5652,cdepval_orders_o_orderdate#5653,co_orderstatus#5654,co_totalprice#5655,co_orderpriority#5656,co_clerk#5657,co_shippriority#5658,co_comment#5659,co_orderdate#5660] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 21900ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/25 23:13:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:13:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5760L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 23:13:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:13:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:13:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:13:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:13:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:13:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:13:09 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:13:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:13:09 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:13:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5760L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#5834 AS rid_2#5848, cpfk_part_partsupp#5835 AS cpfk_part_partsupp_2#5849, cfpk_partsupp_part#5836 AS cfpk_partsupp_part_2#5850, cpfk_supplier_partsupp#5837 AS cpfk_supplier_partsupp_2#5851, cfpk_partsupp_supplier#5838 AS cfpk_partsupp_supplier_2#5852, cval_partsupp_ps_availqty#5839 AS cval_partsupp_ps_availqty_2#5853, cval_partsupp_ps_supplycost#5840 AS cval_partsupp_ps_supplycost_2#5854, cval_partsupp_ps_comment#5841 AS cval_partsupp_ps_comment_2#5855, cdepval_partsupp_ps_availqty#5842 AS cdepval_partsupp_ps_availqty_2#5856, cdepval_partsupp_ps_supplycost#5843 AS cdepval_partsupp_ps_supplycost_2#5857, cdepval_partsupp_ps_comment#5844 AS cdepval_partsupp_ps_comment_2#5858, cps_availqty#5845 AS cps_availqty_2#5859, cps_supplycost#5846 AS cps_supplycost_2#5860, cps_comment#5847 AS cps_comment_2#5861]
         :  +- Relation[rid#5834,cpfk_part_partsupp#5835,cfpk_partsupp_part#5836,cpfk_supplier_partsupp#5837,cfpk_partsupp_supplier#5838,cval_partsupp_ps_availqty#5839,cval_partsupp_ps_supplycost#5840,cval_partsupp_ps_comment#5841,cdepval_partsupp_ps_availqty#5842,cdepval_partsupp_ps_supplycost#5843,cdepval_partsupp_ps_comment#5844,cps_availqty#5845,cps_supplycost#5846,cps_comment#5847] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
            :- Project [rid#5798 AS rid_1#5816, cpfk_nation_supplier#5799 AS cpfk_nation_supplier_1#5817, cfpk_supplier_nation#5800 AS cfpk_supplier_nation_1#5818, cval_supplier_s_name#5801 AS cval_supplier_s_name_1#5819, cval_supplier_s_address#5802 AS cval_supplier_s_address_1#5820, cval_supplier_s_phone#5803 AS cval_supplier_s_phone_1#5821, cval_supplier_s_acctbal#5804 AS cval_supplier_s_acctbal_1#5822, cval_supplier_s_comment#5805 AS cval_supplier_s_comment_1#5823, cdepval_supplier_s_name#5806 AS cdepval_supplier_s_name_1#5824, cdepval_supplier_s_address#5807 AS cdepval_supplier_s_address_1#5825, cdepval_supplier_s_phone#5808 AS cdepval_supplier_s_phone_1#5826, cdepval_supplier_s_acctbal#5809 AS cdepval_supplier_s_acctbal_1#5827, cdepval_supplier_s_comment#5810 AS cdepval_supplier_s_comment_1#5828, cs_name#5811 AS cs_name_1#5829, cs_address#5812 AS cs_address_1#5830, cs_phone#5813 AS cs_phone_1#5831, cs_acctbal#5814 AS cs_acctbal_1#5832, cs_comment#5815 AS cs_comment_1#5833]
            :  +- Relation[rid#5798,cpfk_nation_supplier#5799,cfpk_supplier_nation#5800,cval_supplier_s_name#5801,cval_supplier_s_address#5802,cval_supplier_s_phone#5803,cval_supplier_s_acctbal#5804,cval_supplier_s_comment#5805,cdepval_supplier_s_name#5806,cdepval_supplier_s_address#5807,cdepval_supplier_s_phone#5808,cdepval_supplier_s_acctbal#5809,cdepval_supplier_s_comment#5810,cs_name#5811,cs_address#5812,cs_phone#5813,cs_acctbal#5814,cs_comment#5815] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
               +- Project [rid#5762 AS rid_0#5771, cpfk_region_nation#5763 AS cpfk_region_nation_0#5772, cfpk_nation_region#5764 AS cfpk_nation_region_0#5773, cval_nation_n_name#5765 AS cval_nation_n_name_0#5774, cval_nation_n_comment#5766 AS cval_nation_n_comment_0#5775, cdepval_nation_n_name#5767 AS cdepval_nation_n_name_0#5776, cdepval_nation_n_comment#5768 AS cdepval_nation_n_comment_0#5777, cn_name#5769 AS cn_name_0#5778, cn_comment#5770 AS cn_comment_0#5779]
                  +- Relation[rid#5762,cpfk_region_nation#5763,cfpk_nation_region#5764,cval_nation_n_name#5765,cval_nation_n_comment#5766,cdepval_nation_n_name#5767,cdepval_nation_n_comment#5768,cn_name#5769,cn_comment#5770] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 3454ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/25 23:13:12 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:13:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5908L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:13:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#5908L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#5910 AS rid_0#5955, cpfk_orders_lineitem#5911 AS cpfk_orders_lineitem_0#5956, cpfk_supplier_lineitem#5912 AS cpfk_supplier_lineitem_0#5957, cfpk_lineitem_supplier#5913 AS cfpk_lineitem_supplier_0#5958, cfpk_lineitem_partsupp#5914 AS cfpk_lineitem_partsupp_0#5959, cpfk_part_lineitem#5915 AS cpfk_part_lineitem_0#5960, cfpk_lineitem_part#5916 AS cfpk_lineitem_part_0#5961, cpfk_partsupp_lineitem#5917 AS cpfk_partsupp_lineitem_0#5962, cfpk_lineitem_orders#5918 AS cfpk_lineitem_orders_0#5963, cval_lineitem_l_quantity#5919 AS cval_lineitem_l_quantity_0#5964, cval_lineitem_l_extendedprice#5920 AS cval_lineitem_l_extendedprice_0#5965, cval_lineitem_l_discount#5921 AS cval_lineitem_l_discount_0#5966, cval_lineitem_l_tax#5922 AS cval_lineitem_l_tax_0#5967, cval_lineitem_l_returnflag#5923 AS cval_lineitem_l_returnflag_0#5968, cval_lineitem_l_linestatus#5924 AS cval_lineitem_l_linestatus_0#5969, cval_lineitem_l_commitdate#5925 AS cval_lineitem_l_commitdate_0#5970, cval_lineitem_l_receiptdate#5926 AS cval_lineitem_l_receiptdate_0#5971, cval_lineitem_l_shipinstruct#5927 AS cval_lineitem_l_shipinstruct_0#5972, cval_lineitem_l_shipmode#5928 AS cval_lineitem_l_shipmode_0#5973, cval_lineitem_l_comment#5929 AS cval_lineitem_l_comment_0#5974, cval_lineitem_l_shipdate#5930 AS cval_lineitem_l_shipdate_0#5975, cdepval_lineitem_l_quantity#5931 AS cdepval_lineitem_l_quantity_0#5976, cdepval_lineitem_l_extendedprice#5932 AS cdepval_lineitem_l_extendedprice_0#5977, cdepval_lineitem_l_discount#5933 AS cdepval_lineitem_l_discount_0#5978, ... 21 more fields]
         +- Relation[rid#5910,cpfk_orders_lineitem#5911,cpfk_supplier_lineitem#5912,cfpk_lineitem_supplier#5913,cfpk_lineitem_partsupp#5914,cpfk_part_lineitem#5915,cfpk_lineitem_part#5916,cpfk_partsupp_lineitem#5917,cfpk_lineitem_orders#5918,cval_lineitem_l_quantity#5919,cval_lineitem_l_extendedprice#5920,cval_lineitem_l_discount#5921,cval_lineitem_l_tax#5922,cval_lineitem_l_returnflag#5923,cval_lineitem_l_linestatus#5924,cval_lineitem_l_commitdate#5925,cval_lineitem_l_receiptdate#5926,cval_lineitem_l_shipinstruct#5927,cval_lineitem_l_shipmode#5928,cval_lineitem_l_comment#5929,cval_lineitem_l_shipdate#5930,cdepval_lineitem_l_quantity#5931,cdepval_lineitem_l_extendedprice#5932,cdepval_lineitem_l_discount#5933,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2476ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/25 23:13:15 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:13:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6050L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 23:13:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:13:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:13:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:13:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:13:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:13:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:13:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:13:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:13:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:13:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:13:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6050L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :  :- Project [rid#6152 AS rid_1#6166, cpfk_part_partsupp#6153 AS cpfk_part_partsupp_1#6167, cfpk_partsupp_part#6154 AS cfpk_partsupp_part_1#6168, cpfk_supplier_partsupp#6155 AS cpfk_supplier_partsupp_1#6169, cfpk_partsupp_supplier#6156 AS cfpk_partsupp_supplier_1#6170, cval_partsupp_ps_availqty#6157 AS cval_partsupp_ps_availqty_1#6171, cval_partsupp_ps_supplycost#6158 AS cval_partsupp_ps_supplycost_1#6172, cval_partsupp_ps_comment#6159 AS cval_partsupp_ps_comment_1#6173, cdepval_partsupp_ps_availqty#6160 AS cdepval_partsupp_ps_availqty_1#6174, cdepval_partsupp_ps_supplycost#6161 AS cdepval_partsupp_ps_supplycost_1#6175, cdepval_partsupp_ps_comment#6162 AS cdepval_partsupp_ps_comment_1#6176, cps_availqty#6163 AS cps_availqty_1#6177, cps_supplycost#6164 AS cps_supplycost_1#6178, cps_comment#6165 AS cps_comment_1#6179]
         :  :  +- Relation[rid#6152,cpfk_part_partsupp#6153,cfpk_partsupp_part#6154,cpfk_supplier_partsupp#6155,cfpk_partsupp_supplier#6156,cval_partsupp_ps_availqty#6157,cval_partsupp_ps_supplycost#6158,cval_partsupp_ps_comment#6159,cdepval_partsupp_ps_availqty#6160,cdepval_partsupp_ps_supplycost#6161,cdepval_partsupp_ps_comment#6162,cps_availqty#6163,cps_supplycost#6164,cps_comment#6165] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :     +- Project [rid#6052 AS rid_0#6077, cval_part_p_name#6053 AS cval_part_p_name_0#6078, cval_part_p_mfgr#6054 AS cval_part_p_mfgr_0#6079, cval_part_p_type#6055 AS cval_part_p_type_0#6080, cval_part_p_size#6056 AS cval_part_p_size_0#6081, cval_part_p_container#6057 AS cval_part_p_container_0#6082, cval_part_p_retailprice#6058 AS cval_part_p_retailprice_0#6083, cval_part_p_comment#6059 AS cval_part_p_comment_0#6084, cval_part_p_brand#6060 AS cval_part_p_brand_0#6085, cdepval_part_p_name#6061 AS cdepval_part_p_name_0#6086, cdepval_part_p_mfgr#6062 AS cdepval_part_p_mfgr_0#6087, cdepval_part_p_type#6063 AS cdepval_part_p_type_0#6088, cdepval_part_p_size#6064 AS cdepval_part_p_size_0#6089, cdepval_part_p_container#6065 AS cdepval_part_p_container_0#6090, cdepval_part_p_retailprice#6066 AS cdepval_part_p_retailprice_0#6091, cdepval_part_p_comment#6067 AS cdepval_part_p_comment_0#6092, cdepval_part_p_brand#6068 AS cdepval_part_p_brand_0#6093, cp_name#6069 AS cp_name_0#6094, cp_mfgr#6070 AS cp_mfgr_0#6095, cp_type#6071 AS cp_type_0#6096, cp_size#6072 AS cp_size_0#6097, cp_container#6073 AS cp_container_0#6098, cp_retailprice#6074 AS cp_retailprice_0#6099, cp_comment#6075 AS cp_comment_0#6100, cp_brand#6076 AS cp_brand_0#6101]
         :        +- Relation[rid#6052,cval_part_p_name#6053,cval_part_p_mfgr#6054,cval_part_p_type#6055,cval_part_p_size#6056,cval_part_p_container#6057,cval_part_p_retailprice#6058,cval_part_p_comment#6059,cval_part_p_brand#6060,cdepval_part_p_name#6061,cdepval_part_p_mfgr#6062,cdepval_part_p_type#6063,cdepval_part_p_size#6064,cdepval_part_p_container#6065,cdepval_part_p_retailprice#6066,cdepval_part_p_comment#6067,cdepval_part_p_brand#6068,cp_name#6069,cp_mfgr#6070,cp_type#6071,cp_size#6072,cp_container#6073,cp_retailprice#6074,cp_comment#6075,cp_brand#6076] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_2)
            :- Project [rid#6216 AS rid_3#6234, cpfk_nation_supplier#6217 AS cpfk_nation_supplier_3#6235, cfpk_supplier_nation#6218 AS cfpk_supplier_nation_3#6236, cval_supplier_s_name#6219 AS cval_supplier_s_name_3#6237, cval_supplier_s_address#6220 AS cval_supplier_s_address_3#6238, cval_supplier_s_phone#6221 AS cval_supplier_s_phone_3#6239, cval_supplier_s_acctbal#6222 AS cval_supplier_s_acctbal_3#6240, cval_supplier_s_comment#6223 AS cval_supplier_s_comment_3#6241, cdepval_supplier_s_name#6224 AS cdepval_supplier_s_name_3#6242, cdepval_supplier_s_address#6225 AS cdepval_supplier_s_address_3#6243, cdepval_supplier_s_phone#6226 AS cdepval_supplier_s_phone_3#6244, cdepval_supplier_s_acctbal#6227 AS cdepval_supplier_s_acctbal_3#6245, cdepval_supplier_s_comment#6228 AS cdepval_supplier_s_comment_3#6246, cs_name#6229 AS cs_name_3#6247, cs_address#6230 AS cs_address_3#6248, cs_phone#6231 AS cs_phone_3#6249, cs_acctbal#6232 AS cs_acctbal_3#6250, cs_comment#6233 AS cs_comment_3#6251]
            :  +- Relation[rid#6216,cpfk_nation_supplier#6217,cfpk_supplier_nation#6218,cval_supplier_s_name#6219,cval_supplier_s_address#6220,cval_supplier_s_phone#6221,cval_supplier_s_acctbal#6222,cval_supplier_s_comment#6223,cdepval_supplier_s_name#6224,cdepval_supplier_s_address#6225,cdepval_supplier_s_phone#6226,cdepval_supplier_s_acctbal#6227,cdepval_supplier_s_comment#6228,cs_name#6229,cs_address#6230,cs_phone#6231,cs_acctbal#6232,cs_comment#6233] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
               +- Project [rid#6180 AS rid_2#6189, cpfk_region_nation#6181 AS cpfk_region_nation_2#6190, cfpk_nation_region#6182 AS cfpk_nation_region_2#6191, cval_nation_n_name#6183 AS cval_nation_n_name_2#6192, cval_nation_n_comment#6184 AS cval_nation_n_comment_2#6193, cdepval_nation_n_name#6185 AS cdepval_nation_n_name_2#6194, cdepval_nation_n_comment#6186 AS cdepval_nation_n_comment_2#6195, cn_name#6187 AS cn_name_2#6196, cn_comment#6188 AS cn_comment_2#6197]
                  +- Relation[rid#6180,cpfk_region_nation#6181,cfpk_nation_region#6182,cval_nation_n_name#6183,cval_nation_n_comment#6184,cdepval_nation_n_name#6185,cdepval_nation_n_comment#6186,cn_name#6187,cn_comment#6188] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 3563ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/25 23:13:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:13:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6325L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:13:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:13:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:13:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:13:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:13:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:13:18 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:13:18 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:13:18 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:13:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:13:18 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:13:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:13:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:13:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6325L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :  :  :  :- Project [rid#6427 AS rid_1#6472, cpfk_orders_lineitem#6428 AS cpfk_orders_lineitem_1#6473, cpfk_supplier_lineitem#6429 AS cpfk_supplier_lineitem_1#6474, cfpk_lineitem_supplier#6430 AS cfpk_lineitem_supplier_1#6475, cfpk_lineitem_partsupp#6431 AS cfpk_lineitem_partsupp_1#6476, cpfk_part_lineitem#6432 AS cpfk_part_lineitem_1#6477, cfpk_lineitem_part#6433 AS cfpk_lineitem_part_1#6478, cpfk_partsupp_lineitem#6434 AS cpfk_partsupp_lineitem_1#6479, cfpk_lineitem_orders#6435 AS cfpk_lineitem_orders_1#6480, cval_lineitem_l_quantity#6436 AS cval_lineitem_l_quantity_1#6481, cval_lineitem_l_extendedprice#6437 AS cval_lineitem_l_extendedprice_1#6482, cval_lineitem_l_discount#6438 AS cval_lineitem_l_discount_1#6483, cval_lineitem_l_tax#6439 AS cval_lineitem_l_tax_1#6484, cval_lineitem_l_returnflag#6440 AS cval_lineitem_l_returnflag_1#6485, cval_lineitem_l_linestatus#6441 AS cval_lineitem_l_linestatus_1#6486, cval_lineitem_l_commitdate#6442 AS cval_lineitem_l_commitdate_1#6487, cval_lineitem_l_receiptdate#6443 AS cval_lineitem_l_receiptdate_1#6488, cval_lineitem_l_shipinstruct#6444 AS cval_lineitem_l_shipinstruct_1#6489, cval_lineitem_l_shipmode#6445 AS cval_lineitem_l_shipmode_1#6490, cval_lineitem_l_comment#6446 AS cval_lineitem_l_comment_1#6491, cval_lineitem_l_shipdate#6447 AS cval_lineitem_l_shipdate_1#6492, cdepval_lineitem_l_quantity#6448 AS cdepval_lineitem_l_quantity_1#6493, cdepval_lineitem_l_extendedprice#6449 AS cdepval_lineitem_l_extendedprice_1#6494, cdepval_lineitem_l_discount#6450 AS cdepval_lineitem_l_discount_1#6495, ... 21 more fields]
         :  :  :  :  +- Relation[rid#6427,cpfk_orders_lineitem#6428,cpfk_supplier_lineitem#6429,cfpk_lineitem_supplier#6430,cfpk_lineitem_partsupp#6431,cpfk_part_lineitem#6432,cfpk_lineitem_part#6433,cpfk_partsupp_lineitem#6434,cfpk_lineitem_orders#6435,cval_lineitem_l_quantity#6436,cval_lineitem_l_extendedprice#6437,cval_lineitem_l_discount#6438,cval_lineitem_l_tax#6439,cval_lineitem_l_returnflag#6440,cval_lineitem_l_linestatus#6441,cval_lineitem_l_commitdate#6442,cval_lineitem_l_receiptdate#6443,cval_lineitem_l_shipinstruct#6444,cval_lineitem_l_shipmode#6445,cval_lineitem_l_comment#6446,cval_lineitem_l_shipdate#6447,cdepval_lineitem_l_quantity#6448,cdepval_lineitem_l_extendedprice#6449,cdepval_lineitem_l_discount#6450,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :     +- Project [rid#6327 AS rid_0#6352, cval_part_p_name#6328 AS cval_part_p_name_0#6353, cval_part_p_mfgr#6329 AS cval_part_p_mfgr_0#6354, cval_part_p_type#6330 AS cval_part_p_type_0#6355, cval_part_p_size#6331 AS cval_part_p_size_0#6356, cval_part_p_container#6332 AS cval_part_p_container_0#6357, cval_part_p_retailprice#6333 AS cval_part_p_retailprice_0#6358, cval_part_p_comment#6334 AS cval_part_p_comment_0#6359, cval_part_p_brand#6335 AS cval_part_p_brand_0#6360, cdepval_part_p_name#6336 AS cdepval_part_p_name_0#6361, cdepval_part_p_mfgr#6337 AS cdepval_part_p_mfgr_0#6362, cdepval_part_p_type#6338 AS cdepval_part_p_type_0#6363, cdepval_part_p_size#6339 AS cdepval_part_p_size_0#6364, cdepval_part_p_container#6340 AS cdepval_part_p_container_0#6365, cdepval_part_p_retailprice#6341 AS cdepval_part_p_retailprice_0#6366, cdepval_part_p_comment#6342 AS cdepval_part_p_comment_0#6367, cdepval_part_p_brand#6343 AS cdepval_part_p_brand_0#6368, cp_name#6344 AS cp_name_0#6369, cp_mfgr#6345 AS cp_mfgr_0#6370, cp_type#6346 AS cp_type_0#6371, cp_size#6347 AS cp_size_0#6372, cp_container#6348 AS cp_container_0#6373, cp_retailprice#6349 AS cp_retailprice_0#6374, cp_comment#6350 AS cp_comment_0#6375, cp_brand#6351 AS cp_brand_0#6376]
         :  :  :        +- Relation[rid#6327,cval_part_p_name#6328,cval_part_p_mfgr#6329,cval_part_p_type#6330,cval_part_p_size#6331,cval_part_p_container#6332,cval_part_p_retailprice#6333,cval_part_p_comment#6334,cval_part_p_brand#6335,cdepval_part_p_name#6336,cdepval_part_p_mfgr#6337,cdepval_part_p_type#6338,cdepval_part_p_size#6339,cdepval_part_p_container#6340,cdepval_part_p_retailprice#6341,cdepval_part_p_comment#6342,cdepval_part_p_brand#6343,cp_name#6344,cp_mfgr#6345,cp_type#6346,cp_size#6347,cp_container#6348,cp_retailprice#6349,cp_comment#6350,cp_brand#6351] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- Project [rid#6517 AS rid_2#6535, cpfk_nation_supplier#6518 AS cpfk_nation_supplier_2#6536, cfpk_supplier_nation#6519 AS cfpk_supplier_nation_2#6537, cval_supplier_s_name#6520 AS cval_supplier_s_name_2#6538, cval_supplier_s_address#6521 AS cval_supplier_s_address_2#6539, cval_supplier_s_phone#6522 AS cval_supplier_s_phone_2#6540, cval_supplier_s_acctbal#6523 AS cval_supplier_s_acctbal_2#6541, cval_supplier_s_comment#6524 AS cval_supplier_s_comment_2#6542, cdepval_supplier_s_name#6525 AS cdepval_supplier_s_name_2#6543, cdepval_supplier_s_address#6526 AS cdepval_supplier_s_address_2#6544, cdepval_supplier_s_phone#6527 AS cdepval_supplier_s_phone_2#6545, cdepval_supplier_s_acctbal#6528 AS cdepval_supplier_s_acctbal_2#6546, cdepval_supplier_s_comment#6529 AS cdepval_supplier_s_comment_2#6547, cs_name#6530 AS cs_name_2#6548, cs_address#6531 AS cs_address_2#6549, cs_phone#6532 AS cs_phone_2#6550, cs_acctbal#6533 AS cs_acctbal_2#6551, cs_comment#6534 AS cs_comment_2#6552]
         :  :     +- Relation[rid#6517,cpfk_nation_supplier#6518,cfpk_supplier_nation#6519,cval_supplier_s_name#6520,cval_supplier_s_address#6521,cval_supplier_s_phone#6522,cval_supplier_s_acctbal#6523,cval_supplier_s_comment#6524,cdepval_supplier_s_name#6525,cdepval_supplier_s_address#6526,cdepval_supplier_s_phone#6527,cdepval_supplier_s_acctbal#6528,cdepval_supplier_s_comment#6529,cs_name#6530,cs_address#6531,cs_phone#6532,cs_acctbal#6533,cs_comment#6534] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#6553 AS rid_3#6562, cpfk_region_nation#6554 AS cpfk_region_nation_3#6563, cfpk_nation_region#6555 AS cfpk_nation_region_3#6564, cval_nation_n_name#6556 AS cval_nation_n_name_3#6565, cval_nation_n_comment#6557 AS cval_nation_n_comment_3#6566, cdepval_nation_n_name#6558 AS cdepval_nation_n_name_3#6567, cdepval_nation_n_comment#6559 AS cdepval_nation_n_comment_3#6568, cn_name#6560 AS cn_name_3#6569, cn_comment#6561 AS cn_comment_3#6570]
         :     +- Relation[rid#6553,cpfk_region_nation#6554,cfpk_nation_region#6555,cval_nation_n_name#6556,cval_nation_n_comment#6557,cdepval_nation_n_name#6558,cdepval_nation_n_comment#6559,cn_name#6560,cn_comment#6561] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#6659 AS rid_7#6683, cpfk_customer_orders#6660 AS cpfk_customer_orders_7#6684, cfpk_orders_customer#6661 AS cfpk_orders_customer_7#6685, cval_orders_o_orderstatus#6662 AS cval_orders_o_orderstatus_7#6686, cval_orders_o_totalprice#6663 AS cval_orders_o_totalprice_7#6687, cval_orders_o_orderpriority#6664 AS cval_orders_o_orderpriority_7#6688, cval_orders_o_clerk#6665 AS cval_orders_o_clerk_7#6689, cval_orders_o_shippriority#6666 AS cval_orders_o_shippriority_7#6690, cval_orders_o_comment#6667 AS cval_orders_o_comment_7#6691, cval_orders_o_orderdate#6668 AS cval_orders_o_orderdate_7#6692, cdepval_orders_o_orderstatus#6669 AS cdepval_orders_o_orderstatus_7#6693, cdepval_orders_o_totalprice#6670 AS cdepval_orders_o_totalprice_7#6694, cdepval_orders_o_orderpriority#6671 AS cdepval_orders_o_orderpriority_7#6695, cdepval_orders_o_clerk#6672 AS cdepval_orders_o_clerk_7#6696, cdepval_orders_o_shippriority#6673 AS cdepval_orders_o_shippriority_7#6697, cdepval_orders_o_comment#6674 AS cdepval_orders_o_comment_7#6698, cdepval_orders_o_orderdate#6675 AS cdepval_orders_o_orderdate_7#6699, co_orderstatus#6676 AS co_orderstatus_7#6700, co_totalprice#6677 AS co_totalprice_7#6701, co_orderpriority#6678 AS co_orderpriority_7#6702, co_clerk#6679 AS co_clerk_7#6703, co_shippriority#6680 AS co_shippriority_7#6704, co_comment#6681 AS co_comment_7#6705, co_orderdate#6682 AS co_orderdate_7#6706]
            :  +- Relation[rid#6659,cpfk_customer_orders#6660,cfpk_orders_customer#6661,cval_orders_o_orderstatus#6662,cval_orders_o_totalprice#6663,cval_orders_o_orderpriority#6664,cval_orders_o_clerk#6665,cval_orders_o_shippriority#6666,cval_orders_o_comment#6667,cval_orders_o_orderdate#6668,cdepval_orders_o_orderstatus#6669,cdepval_orders_o_totalprice#6670,cdepval_orders_o_orderpriority#6671,cdepval_orders_o_clerk#6672,cdepval_orders_o_shippriority#6673,cdepval_orders_o_comment#6674,cdepval_orders_o_orderdate#6675,co_orderstatus#6676,co_totalprice#6677,co_orderpriority#6678,co_clerk#6679,co_shippriority#6680,co_comment#6681,co_orderdate#6682] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#6617 AS rid_6#6638, cpfk_nation_customer#6618 AS cpfk_nation_customer_6#6639, cfpk_customer_nation#6619 AS cfpk_customer_nation_6#6640, cval_customer_c_name#6620 AS cval_customer_c_name_6#6641, cval_customer_c_address#6621 AS cval_customer_c_address_6#6642, cval_customer_c_phone#6622 AS cval_customer_c_phone_6#6643, cval_customer_c_acctbal#6623 AS cval_customer_c_acctbal_6#6644, cval_customer_c_comment#6624 AS cval_customer_c_comment_6#6645, cval_customer_c_mktsegment#6625 AS cval_customer_c_mktsegment_6#6646, cdepval_customer_c_name#6626 AS cdepval_customer_c_name_6#6647, cdepval_customer_c_address#6627 AS cdepval_customer_c_address_6#6648, cdepval_customer_c_phone#6628 AS cdepval_customer_c_phone_6#6649, cdepval_customer_c_acctbal#6629 AS cdepval_customer_c_acctbal_6#6650, cdepval_customer_c_comment#6630 AS cdepval_customer_c_comment_6#6651, cdepval_customer_c_mktsegment#6631 AS cdepval_customer_c_mktsegment_6#6652, cc_name#6632 AS cc_name_6#6653, cc_address#6633 AS cc_address_6#6654, cc_phone#6634 AS cc_phone_6#6655, cc_acctbal#6635 AS cc_acctbal_6#6656, cc_comment#6636 AS cc_comment_6#6657, cc_mktsegment#6637 AS cc_mktsegment_6#6658]
               :  +- Relation[rid#6617,cpfk_nation_customer#6618,cfpk_customer_nation#6619,cval_customer_c_name#6620,cval_customer_c_address#6621,cval_customer_c_phone#6622,cval_customer_c_acctbal#6623,cval_customer_c_comment#6624,cval_customer_c_mktsegment#6625,cdepval_customer_c_name#6626,cdepval_customer_c_address#6627,cdepval_customer_c_phone#6628,cdepval_customer_c_acctbal#6629,cdepval_customer_c_comment#6630,cdepval_customer_c_mktsegment#6631,cc_name#6632,cc_address#6633,cc_phone#6634,cc_acctbal#6635,cc_comment#6636,cc_mktsegment#6637] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_5, BinaryType)), 'cfpk_nation_region_5) = 'rid_4)
                  :- Project [rid#6599 AS rid_5#6608, cpfk_region_nation#6600 AS cpfk_region_nation_5#6609, cfpk_nation_region#6601 AS cfpk_nation_region_5#6610, cval_nation_n_name#6602 AS cval_nation_n_name_5#6611, cval_nation_n_comment#6603 AS cval_nation_n_comment_5#6612, cdepval_nation_n_name#6604 AS cdepval_nation_n_name_5#6613, cdepval_nation_n_comment#6605 AS cdepval_nation_n_comment_5#6614, cn_name#6606 AS cn_name_5#6615, cn_comment#6607 AS cn_comment_5#6616]
                  :  +- Relation[rid#6599,cpfk_region_nation#6600,cfpk_nation_region#6601,cval_nation_n_name#6602,cval_nation_n_comment#6603,cdepval_nation_n_name#6604,cdepval_nation_n_comment#6605,cn_name#6606,cn_comment#6607] JDBCRelation(tnation) [numPartitions=1]
                  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                     +- Project [rid#6571 AS rid_4#6578, cval_region_r_name#6572 AS cval_region_r_name_4#6579, cval_region_r_comment#6573 AS cval_region_r_comment_4#6580, cdepval_region_r_name#6574 AS cdepval_region_r_name_4#6581, cdepval_region_r_comment#6575 AS cdepval_region_r_comment_4#6582, cr_name#6576 AS cr_name_4#6583, cr_comment#6577 AS cr_comment_4#6584]
                        +- Relation[rid#6571,cval_region_r_name#6572,cval_region_r_comment#6573,cdepval_region_r_name#6574,cdepval_region_r_comment#6575,cr_name#6576,cr_comment#6577] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 44825ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/25 23:14:03 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:14:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6874L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:14:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6874L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#6966 AS rid_2#7011, cpfk_orders_lineitem#6967 AS cpfk_orders_lineitem_2#7012, cpfk_supplier_lineitem#6968 AS cpfk_supplier_lineitem_2#7013, cfpk_lineitem_supplier#6969 AS cfpk_lineitem_supplier_2#7014, cfpk_lineitem_partsupp#6970 AS cfpk_lineitem_partsupp_2#7015, cpfk_part_lineitem#6971 AS cpfk_part_lineitem_2#7016, cfpk_lineitem_part#6972 AS cfpk_lineitem_part_2#7017, cpfk_partsupp_lineitem#6973 AS cpfk_partsupp_lineitem_2#7018, cfpk_lineitem_orders#6974 AS cfpk_lineitem_orders_2#7019, cval_lineitem_l_quantity#6975 AS cval_lineitem_l_quantity_2#7020, cval_lineitem_l_extendedprice#6976 AS cval_lineitem_l_extendedprice_2#7021, cval_lineitem_l_discount#6977 AS cval_lineitem_l_discount_2#7022, cval_lineitem_l_tax#6978 AS cval_lineitem_l_tax_2#7023, cval_lineitem_l_returnflag#6979 AS cval_lineitem_l_returnflag_2#7024, cval_lineitem_l_linestatus#6980 AS cval_lineitem_l_linestatus_2#7025, cval_lineitem_l_commitdate#6981 AS cval_lineitem_l_commitdate_2#7026, cval_lineitem_l_receiptdate#6982 AS cval_lineitem_l_receiptdate_2#7027, cval_lineitem_l_shipinstruct#6983 AS cval_lineitem_l_shipinstruct_2#7028, cval_lineitem_l_shipmode#6984 AS cval_lineitem_l_shipmode_2#7029, cval_lineitem_l_comment#6985 AS cval_lineitem_l_comment_2#7030, cval_lineitem_l_shipdate#6986 AS cval_lineitem_l_shipdate_2#7031, cdepval_lineitem_l_quantity#6987 AS cdepval_lineitem_l_quantity_2#7032, cdepval_lineitem_l_extendedprice#6988 AS cdepval_lineitem_l_extendedprice_2#7033, cdepval_lineitem_l_discount#6989 AS cdepval_lineitem_l_discount_2#7034, ... 21 more fields]
         :  +- Relation[rid#6966,cpfk_orders_lineitem#6967,cpfk_supplier_lineitem#6968,cfpk_lineitem_supplier#6969,cfpk_lineitem_partsupp#6970,cpfk_part_lineitem#6971,cfpk_lineitem_part#6972,cpfk_partsupp_lineitem#6973,cfpk_lineitem_orders#6974,cval_lineitem_l_quantity#6975,cval_lineitem_l_extendedprice#6976,cval_lineitem_l_discount#6977,cval_lineitem_l_tax#6978,cval_lineitem_l_returnflag#6979,cval_lineitem_l_linestatus#6980,cval_lineitem_l_commitdate#6981,cval_lineitem_l_receiptdate#6982,cval_lineitem_l_shipinstruct#6983,cval_lineitem_l_shipmode#6984,cval_lineitem_l_comment#6985,cval_lineitem_l_shipdate#6986,cdepval_lineitem_l_quantity#6987,cdepval_lineitem_l_extendedprice#6988,cdepval_lineitem_l_discount#6989,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#6918 AS rid_1#6942, cpfk_customer_orders#6919 AS cpfk_customer_orders_1#6943, cfpk_orders_customer#6920 AS cfpk_orders_customer_1#6944, cval_orders_o_orderstatus#6921 AS cval_orders_o_orderstatus_1#6945, cval_orders_o_totalprice#6922 AS cval_orders_o_totalprice_1#6946, cval_orders_o_orderpriority#6923 AS cval_orders_o_orderpriority_1#6947, cval_orders_o_clerk#6924 AS cval_orders_o_clerk_1#6948, cval_orders_o_shippriority#6925 AS cval_orders_o_shippriority_1#6949, cval_orders_o_comment#6926 AS cval_orders_o_comment_1#6950, cval_orders_o_orderdate#6927 AS cval_orders_o_orderdate_1#6951, cdepval_orders_o_orderstatus#6928 AS cdepval_orders_o_orderstatus_1#6952, cdepval_orders_o_totalprice#6929 AS cdepval_orders_o_totalprice_1#6953, cdepval_orders_o_orderpriority#6930 AS cdepval_orders_o_orderpriority_1#6954, cdepval_orders_o_clerk#6931 AS cdepval_orders_o_clerk_1#6955, cdepval_orders_o_shippriority#6932 AS cdepval_orders_o_shippriority_1#6956, cdepval_orders_o_comment#6933 AS cdepval_orders_o_comment_1#6957, cdepval_orders_o_orderdate#6934 AS cdepval_orders_o_orderdate_1#6958, co_orderstatus#6935 AS co_orderstatus_1#6959, co_totalprice#6936 AS co_totalprice_1#6960, co_orderpriority#6937 AS co_orderpriority_1#6961, co_clerk#6938 AS co_clerk_1#6962, co_shippriority#6939 AS co_shippriority_1#6963, co_comment#6940 AS co_comment_1#6964, co_orderdate#6941 AS co_orderdate_1#6965]
            :  +- Relation[rid#6918,cpfk_customer_orders#6919,cfpk_orders_customer#6920,cval_orders_o_orderstatus#6921,cval_orders_o_totalprice#6922,cval_orders_o_orderpriority#6923,cval_orders_o_clerk#6924,cval_orders_o_shippriority#6925,cval_orders_o_comment#6926,cval_orders_o_orderdate#6927,cdepval_orders_o_orderstatus#6928,cdepval_orders_o_totalprice#6929,cdepval_orders_o_orderpriority#6930,cdepval_orders_o_clerk#6931,cdepval_orders_o_shippriority#6932,cdepval_orders_o_comment#6933,cdepval_orders_o_orderdate#6934,co_orderstatus#6935,co_totalprice#6936,co_orderpriority#6937,co_clerk#6938,co_shippriority#6939,co_comment#6940,co_orderdate#6941] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#6876 AS rid_0#6897, cpfk_nation_customer#6877 AS cpfk_nation_customer_0#6898, cfpk_customer_nation#6878 AS cfpk_customer_nation_0#6899, cval_customer_c_name#6879 AS cval_customer_c_name_0#6900, cval_customer_c_address#6880 AS cval_customer_c_address_0#6901, cval_customer_c_phone#6881 AS cval_customer_c_phone_0#6902, cval_customer_c_acctbal#6882 AS cval_customer_c_acctbal_0#6903, cval_customer_c_comment#6883 AS cval_customer_c_comment_0#6904, cval_customer_c_mktsegment#6884 AS cval_customer_c_mktsegment_0#6905, cdepval_customer_c_name#6885 AS cdepval_customer_c_name_0#6906, cdepval_customer_c_address#6886 AS cdepval_customer_c_address_0#6907, cdepval_customer_c_phone#6887 AS cdepval_customer_c_phone_0#6908, cdepval_customer_c_acctbal#6888 AS cdepval_customer_c_acctbal_0#6909, cdepval_customer_c_comment#6889 AS cdepval_customer_c_comment_0#6910, cdepval_customer_c_mktsegment#6890 AS cdepval_customer_c_mktsegment_0#6911, cc_name#6891 AS cc_name_0#6912, cc_address#6892 AS cc_address_0#6913, cc_phone#6893 AS cc_phone_0#6914, cc_acctbal#6894 AS cc_acctbal_0#6915, cc_comment#6895 AS cc_comment_0#6916, cc_mktsegment#6896 AS cc_mktsegment_0#6917]
               +- Relation[rid#6876,cpfk_nation_customer#6877,cfpk_customer_nation#6878,cval_customer_c_name#6879,cval_customer_c_address#6880,cval_customer_c_phone#6881,cval_customer_c_acctbal#6882,cval_customer_c_comment#6883,cval_customer_c_mktsegment#6884,cdepval_customer_c_name#6885,cdepval_customer_c_address#6886,cdepval_customer_c_phone#6887,cdepval_customer_c_acctbal#6888,cdepval_customer_c_comment#6889,cdepval_customer_c_mktsegment#6890,cc_name#6891,cc_address#6892,cc_phone#6893,cc_acctbal#6894,cc_comment#6895,cc_mktsegment#6896] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 22029ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/25 23:14:25 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:14:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7150L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 23:14:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:14:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:14:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:14:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:14:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:14:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:14:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:14:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7150L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#7152 AS rid_0#7197, cpfk_orders_lineitem#7153 AS cpfk_orders_lineitem_0#7198, cpfk_supplier_lineitem#7154 AS cpfk_supplier_lineitem_0#7199, cfpk_lineitem_supplier#7155 AS cfpk_lineitem_supplier_0#7200, cfpk_lineitem_partsupp#7156 AS cfpk_lineitem_partsupp_0#7201, cpfk_part_lineitem#7157 AS cpfk_part_lineitem_0#7202, cfpk_lineitem_part#7158 AS cfpk_lineitem_part_0#7203, cpfk_partsupp_lineitem#7159 AS cpfk_partsupp_lineitem_0#7204, cfpk_lineitem_orders#7160 AS cfpk_lineitem_orders_0#7205, cval_lineitem_l_quantity#7161 AS cval_lineitem_l_quantity_0#7206, cval_lineitem_l_extendedprice#7162 AS cval_lineitem_l_extendedprice_0#7207, cval_lineitem_l_discount#7163 AS cval_lineitem_l_discount_0#7208, cval_lineitem_l_tax#7164 AS cval_lineitem_l_tax_0#7209, cval_lineitem_l_returnflag#7165 AS cval_lineitem_l_returnflag_0#7210, cval_lineitem_l_linestatus#7166 AS cval_lineitem_l_linestatus_0#7211, cval_lineitem_l_commitdate#7167 AS cval_lineitem_l_commitdate_0#7212, cval_lineitem_l_receiptdate#7168 AS cval_lineitem_l_receiptdate_0#7213, cval_lineitem_l_shipinstruct#7169 AS cval_lineitem_l_shipinstruct_0#7214, cval_lineitem_l_shipmode#7170 AS cval_lineitem_l_shipmode_0#7215, cval_lineitem_l_comment#7171 AS cval_lineitem_l_comment_0#7216, cval_lineitem_l_shipdate#7172 AS cval_lineitem_l_shipdate_0#7217, cdepval_lineitem_l_quantity#7173 AS cdepval_lineitem_l_quantity_0#7218, cdepval_lineitem_l_extendedprice#7174 AS cdepval_lineitem_l_extendedprice_0#7219, cdepval_lineitem_l_discount#7175 AS cdepval_lineitem_l_discount_0#7220, ... 21 more fields]
         :  +- Relation[rid#7152,cpfk_orders_lineitem#7153,cpfk_supplier_lineitem#7154,cfpk_lineitem_supplier#7155,cfpk_lineitem_partsupp#7156,cpfk_part_lineitem#7157,cfpk_lineitem_part#7158,cpfk_partsupp_lineitem#7159,cfpk_lineitem_orders#7160,cval_lineitem_l_quantity#7161,cval_lineitem_l_extendedprice#7162,cval_lineitem_l_discount#7163,cval_lineitem_l_tax#7164,cval_lineitem_l_returnflag#7165,cval_lineitem_l_linestatus#7166,cval_lineitem_l_commitdate#7167,cval_lineitem_l_receiptdate#7168,cval_lineitem_l_shipinstruct#7169,cval_lineitem_l_shipmode#7170,cval_lineitem_l_comment#7171,cval_lineitem_l_shipdate#7172,cdepval_lineitem_l_quantity#7173,cdepval_lineitem_l_extendedprice#7174,cdepval_lineitem_l_discount#7175,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
            :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
            :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
            :  :  :- Project [rid#7338 AS rid_2#7383, cpfk_orders_lineitem#7339 AS cpfk_orders_lineitem_2#7384, cpfk_supplier_lineitem#7340 AS cpfk_supplier_lineitem_2#7385, cfpk_lineitem_supplier#7341 AS cfpk_lineitem_supplier_2#7386, cfpk_lineitem_partsupp#7342 AS cfpk_lineitem_partsupp_2#7387, cpfk_part_lineitem#7343 AS cpfk_part_lineitem_2#7388, cfpk_lineitem_part#7344 AS cfpk_lineitem_part_2#7389, cpfk_partsupp_lineitem#7345 AS cpfk_partsupp_lineitem_2#7390, cfpk_lineitem_orders#7346 AS cfpk_lineitem_orders_2#7391, cval_lineitem_l_quantity#7347 AS cval_lineitem_l_quantity_2#7392, cval_lineitem_l_extendedprice#7348 AS cval_lineitem_l_extendedprice_2#7393, cval_lineitem_l_discount#7349 AS cval_lineitem_l_discount_2#7394, cval_lineitem_l_tax#7350 AS cval_lineitem_l_tax_2#7395, cval_lineitem_l_returnflag#7351 AS cval_lineitem_l_returnflag_2#7396, cval_lineitem_l_linestatus#7352 AS cval_lineitem_l_linestatus_2#7397, cval_lineitem_l_commitdate#7353 AS cval_lineitem_l_commitdate_2#7398, cval_lineitem_l_receiptdate#7354 AS cval_lineitem_l_receiptdate_2#7399, cval_lineitem_l_shipinstruct#7355 AS cval_lineitem_l_shipinstruct_2#7400, cval_lineitem_l_shipmode#7356 AS cval_lineitem_l_shipmode_2#7401, cval_lineitem_l_comment#7357 AS cval_lineitem_l_comment_2#7402, cval_lineitem_l_shipdate#7358 AS cval_lineitem_l_shipdate_2#7403, cdepval_lineitem_l_quantity#7359 AS cdepval_lineitem_l_quantity_2#7404, cdepval_lineitem_l_extendedprice#7360 AS cdepval_lineitem_l_extendedprice_2#7405, cdepval_lineitem_l_discount#7361 AS cdepval_lineitem_l_discount_2#7406, ... 21 more fields]
            :  :  :  +- Relation[rid#7338,cpfk_orders_lineitem#7339,cpfk_supplier_lineitem#7340,cfpk_lineitem_supplier#7341,cfpk_lineitem_partsupp#7342,cpfk_part_lineitem#7343,cfpk_lineitem_part#7344,cpfk_partsupp_lineitem#7345,cfpk_lineitem_orders#7346,cval_lineitem_l_quantity#7347,cval_lineitem_l_extendedprice#7348,cval_lineitem_l_discount#7349,cval_lineitem_l_tax#7350,cval_lineitem_l_returnflag#7351,cval_lineitem_l_linestatus#7352,cval_lineitem_l_commitdate#7353,cval_lineitem_l_receiptdate#7354,cval_lineitem_l_shipinstruct#7355,cval_lineitem_l_shipmode#7356,cval_lineitem_l_comment#7357,cval_lineitem_l_shipdate#7358,cdepval_lineitem_l_quantity#7359,cdepval_lineitem_l_extendedprice#7360,cdepval_lineitem_l_discount#7361,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
            :  :     +- Project [rid#7242 AS rid_1#7266, cpfk_customer_orders#7243 AS cpfk_customer_orders_1#7267, cfpk_orders_customer#7244 AS cfpk_orders_customer_1#7268, cval_orders_o_orderstatus#7245 AS cval_orders_o_orderstatus_1#7269, cval_orders_o_totalprice#7246 AS cval_orders_o_totalprice_1#7270, cval_orders_o_orderpriority#7247 AS cval_orders_o_orderpriority_1#7271, cval_orders_o_clerk#7248 AS cval_orders_o_clerk_1#7272, cval_orders_o_shippriority#7249 AS cval_orders_o_shippriority_1#7273, cval_orders_o_comment#7250 AS cval_orders_o_comment_1#7274, cval_orders_o_orderdate#7251 AS cval_orders_o_orderdate_1#7275, cdepval_orders_o_orderstatus#7252 AS cdepval_orders_o_orderstatus_1#7276, cdepval_orders_o_totalprice#7253 AS cdepval_orders_o_totalprice_1#7277, cdepval_orders_o_orderpriority#7254 AS cdepval_orders_o_orderpriority_1#7278, cdepval_orders_o_clerk#7255 AS cdepval_orders_o_clerk_1#7279, cdepval_orders_o_shippriority#7256 AS cdepval_orders_o_shippriority_1#7280, cdepval_orders_o_comment#7257 AS cdepval_orders_o_comment_1#7281, cdepval_orders_o_orderdate#7258 AS cdepval_orders_o_orderdate_1#7282, co_orderstatus#7259 AS co_orderstatus_1#7283, co_totalprice#7260 AS co_totalprice_1#7284, co_orderpriority#7261 AS co_orderpriority_1#7285, co_clerk#7262 AS co_clerk_1#7286, co_shippriority#7263 AS co_shippriority_1#7287, co_comment#7264 AS co_comment_1#7288, co_orderdate#7265 AS co_orderdate_1#7289]
            :  :        +- Relation[rid#7242,cpfk_customer_orders#7243,cfpk_orders_customer#7244,cval_orders_o_orderstatus#7245,cval_orders_o_totalprice#7246,cval_orders_o_orderpriority#7247,cval_orders_o_clerk#7248,cval_orders_o_shippriority#7249,cval_orders_o_comment#7250,cval_orders_o_orderdate#7251,cdepval_orders_o_orderstatus#7252,cdepval_orders_o_totalprice#7253,cdepval_orders_o_orderpriority#7254,cdepval_orders_o_clerk#7255,cdepval_orders_o_shippriority#7256,cdepval_orders_o_comment#7257,cdepval_orders_o_orderdate#7258,co_orderstatus#7259,co_totalprice#7260,co_orderpriority#7261,co_clerk#7262,co_shippriority#7263,co_comment#7264,co_orderdate#7265] JDBCRelation(torders) [numPartitions=1]
            :  +- Project [rid#7428 AS rid_3#7446, cpfk_nation_supplier#7429 AS cpfk_nation_supplier_3#7447, cfpk_supplier_nation#7430 AS cfpk_supplier_nation_3#7448, cval_supplier_s_name#7431 AS cval_supplier_s_name_3#7449, cval_supplier_s_address#7432 AS cval_supplier_s_address_3#7450, cval_supplier_s_phone#7433 AS cval_supplier_s_phone_3#7451, cval_supplier_s_acctbal#7434 AS cval_supplier_s_acctbal_3#7452, cval_supplier_s_comment#7435 AS cval_supplier_s_comment_3#7453, cdepval_supplier_s_name#7436 AS cdepval_supplier_s_name_3#7454, cdepval_supplier_s_address#7437 AS cdepval_supplier_s_address_3#7455, cdepval_supplier_s_phone#7438 AS cdepval_supplier_s_phone_3#7456, cdepval_supplier_s_acctbal#7439 AS cdepval_supplier_s_acctbal_3#7457, cdepval_supplier_s_comment#7440 AS cdepval_supplier_s_comment_3#7458, cs_name#7441 AS cs_name_3#7459, cs_address#7442 AS cs_address_3#7460, cs_phone#7443 AS cs_phone_3#7461, cs_acctbal#7444 AS cs_acctbal_3#7462, cs_comment#7445 AS cs_comment_3#7463]
            :     +- Relation[rid#7428,cpfk_nation_supplier#7429,cfpk_supplier_nation#7430,cval_supplier_s_name#7431,cval_supplier_s_address#7432,cval_supplier_s_phone#7433,cval_supplier_s_acctbal#7434,cval_supplier_s_comment#7435,cdepval_supplier_s_name#7436,cdepval_supplier_s_address#7437,cdepval_supplier_s_phone#7438,cdepval_supplier_s_acctbal#7439,cdepval_supplier_s_comment#7440,cs_name#7441,cs_address#7442,cs_phone#7443,cs_acctbal#7444,cs_comment#7445] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
               +- Project [rid#7464 AS rid_4#7473, cpfk_region_nation#7465 AS cpfk_region_nation_4#7474, cfpk_nation_region#7466 AS cfpk_nation_region_4#7475, cval_nation_n_name#7467 AS cval_nation_n_name_4#7476, cval_nation_n_comment#7468 AS cval_nation_n_comment_4#7477, cdepval_nation_n_name#7469 AS cdepval_nation_n_name_4#7478, cdepval_nation_n_comment#7470 AS cdepval_nation_n_comment_4#7479, cn_name#7471 AS cn_name_4#7480, cn_comment#7472 AS cn_comment_4#7481]
                  +- Relation[rid#7464,cpfk_region_nation#7465,cfpk_nation_region#7466,cval_nation_n_name#7467,cval_nation_n_comment#7468,cdepval_nation_n_name#7469,cdepval_nation_n_comment#7470,cn_name#7471,cn_comment#7472] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 76728ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/25 23:15:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:15:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7647L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:15:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7647L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#7699 AS rid_1#7744, cpfk_orders_lineitem#7700 AS cpfk_orders_lineitem_1#7745, cpfk_supplier_lineitem#7701 AS cpfk_supplier_lineitem_1#7746, cfpk_lineitem_supplier#7702 AS cfpk_lineitem_supplier_1#7747, cfpk_lineitem_partsupp#7703 AS cfpk_lineitem_partsupp_1#7748, cpfk_part_lineitem#7704 AS cpfk_part_lineitem_1#7749, cfpk_lineitem_part#7705 AS cfpk_lineitem_part_1#7750, cpfk_partsupp_lineitem#7706 AS cpfk_partsupp_lineitem_1#7751, cfpk_lineitem_orders#7707 AS cfpk_lineitem_orders_1#7752, cval_lineitem_l_quantity#7708 AS cval_lineitem_l_quantity_1#7753, cval_lineitem_l_extendedprice#7709 AS cval_lineitem_l_extendedprice_1#7754, cval_lineitem_l_discount#7710 AS cval_lineitem_l_discount_1#7755, cval_lineitem_l_tax#7711 AS cval_lineitem_l_tax_1#7756, cval_lineitem_l_returnflag#7712 AS cval_lineitem_l_returnflag_1#7757, cval_lineitem_l_linestatus#7713 AS cval_lineitem_l_linestatus_1#7758, cval_lineitem_l_commitdate#7714 AS cval_lineitem_l_commitdate_1#7759, cval_lineitem_l_receiptdate#7715 AS cval_lineitem_l_receiptdate_1#7760, cval_lineitem_l_shipinstruct#7716 AS cval_lineitem_l_shipinstruct_1#7761, cval_lineitem_l_shipmode#7717 AS cval_lineitem_l_shipmode_1#7762, cval_lineitem_l_comment#7718 AS cval_lineitem_l_comment_1#7763, cval_lineitem_l_shipdate#7719 AS cval_lineitem_l_shipdate_1#7764, cdepval_lineitem_l_quantity#7720 AS cdepval_lineitem_l_quantity_1#7765, cdepval_lineitem_l_extendedprice#7721 AS cdepval_lineitem_l_extendedprice_1#7766, cdepval_lineitem_l_discount#7722 AS cdepval_lineitem_l_discount_1#7767, ... 21 more fields]
         :  +- Relation[rid#7699,cpfk_orders_lineitem#7700,cpfk_supplier_lineitem#7701,cfpk_lineitem_supplier#7702,cfpk_lineitem_partsupp#7703,cpfk_part_lineitem#7704,cfpk_lineitem_part#7705,cpfk_partsupp_lineitem#7706,cfpk_lineitem_orders#7707,cval_lineitem_l_quantity#7708,cval_lineitem_l_extendedprice#7709,cval_lineitem_l_discount#7710,cval_lineitem_l_tax#7711,cval_lineitem_l_returnflag#7712,cval_lineitem_l_linestatus#7713,cval_lineitem_l_commitdate#7714,cval_lineitem_l_receiptdate#7715,cval_lineitem_l_shipinstruct#7716,cval_lineitem_l_shipmode#7717,cval_lineitem_l_comment#7718,cval_lineitem_l_shipdate#7719,cdepval_lineitem_l_quantity#7720,cdepval_lineitem_l_extendedprice#7721,cdepval_lineitem_l_discount#7722,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7649 AS rid_0#7674, cval_part_p_name#7650 AS cval_part_p_name_0#7675, cval_part_p_mfgr#7651 AS cval_part_p_mfgr_0#7676, cval_part_p_type#7652 AS cval_part_p_type_0#7677, cval_part_p_size#7653 AS cval_part_p_size_0#7678, cval_part_p_container#7654 AS cval_part_p_container_0#7679, cval_part_p_retailprice#7655 AS cval_part_p_retailprice_0#7680, cval_part_p_comment#7656 AS cval_part_p_comment_0#7681, cval_part_p_brand#7657 AS cval_part_p_brand_0#7682, cdepval_part_p_name#7658 AS cdepval_part_p_name_0#7683, cdepval_part_p_mfgr#7659 AS cdepval_part_p_mfgr_0#7684, cdepval_part_p_type#7660 AS cdepval_part_p_type_0#7685, cdepval_part_p_size#7661 AS cdepval_part_p_size_0#7686, cdepval_part_p_container#7662 AS cdepval_part_p_container_0#7687, cdepval_part_p_retailprice#7663 AS cdepval_part_p_retailprice_0#7688, cdepval_part_p_comment#7664 AS cdepval_part_p_comment_0#7689, cdepval_part_p_brand#7665 AS cdepval_part_p_brand_0#7690, cp_name#7666 AS cp_name_0#7691, cp_mfgr#7667 AS cp_mfgr_0#7692, cp_type#7668 AS cp_type_0#7693, cp_size#7669 AS cp_size_0#7694, cp_container#7670 AS cp_container_0#7695, cp_retailprice#7671 AS cp_retailprice_0#7696, cp_comment#7672 AS cp_comment_0#7697, cp_brand#7673 AS cp_brand_0#7698]
            +- Relation[rid#7649,cval_part_p_name#7650,cval_part_p_mfgr#7651,cval_part_p_type#7652,cval_part_p_size#7653,cval_part_p_container#7654,cval_part_p_retailprice#7655,cval_part_p_comment#7656,cval_part_p_brand#7657,cdepval_part_p_name#7658,cdepval_part_p_mfgr#7659,cdepval_part_p_type#7660,cdepval_part_p_size#7661,cdepval_part_p_container#7662,cdepval_part_p_retailprice#7663,cdepval_part_p_comment#7664,cdepval_part_p_brand#7665,cp_name#7666,cp_mfgr#7667,cp_type#7668,cp_size#7669,cp_container#7670,cp_retailprice#7671,cp_comment#7672,cp_brand#7673] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17837ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/25 23:16:00 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:16:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7867L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:16:00 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 23:16:00 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 23:16:00 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 23:16:00 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 23:16:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7867L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#8001 AS rid_2#8046, cpfk_orders_lineitem#8002 AS cpfk_orders_lineitem_2#8047, cpfk_supplier_lineitem#8003 AS cpfk_supplier_lineitem_2#8048, cfpk_lineitem_supplier#8004 AS cfpk_lineitem_supplier_2#8049, cfpk_lineitem_partsupp#8005 AS cfpk_lineitem_partsupp_2#8050, cpfk_part_lineitem#8006 AS cpfk_part_lineitem_2#8051, cfpk_lineitem_part#8007 AS cfpk_lineitem_part_2#8052, cpfk_partsupp_lineitem#8008 AS cpfk_partsupp_lineitem_2#8053, cfpk_lineitem_orders#8009 AS cfpk_lineitem_orders_2#8054, cval_lineitem_l_quantity#8010 AS cval_lineitem_l_quantity_2#8055, cval_lineitem_l_extendedprice#8011 AS cval_lineitem_l_extendedprice_2#8056, cval_lineitem_l_discount#8012 AS cval_lineitem_l_discount_2#8057, cval_lineitem_l_tax#8013 AS cval_lineitem_l_tax_2#8058, cval_lineitem_l_returnflag#8014 AS cval_lineitem_l_returnflag_2#8059, cval_lineitem_l_linestatus#8015 AS cval_lineitem_l_linestatus_2#8060, cval_lineitem_l_commitdate#8016 AS cval_lineitem_l_commitdate_2#8061, cval_lineitem_l_receiptdate#8017 AS cval_lineitem_l_receiptdate_2#8062, cval_lineitem_l_shipinstruct#8018 AS cval_lineitem_l_shipinstruct_2#8063, cval_lineitem_l_shipmode#8019 AS cval_lineitem_l_shipmode_2#8064, cval_lineitem_l_comment#8020 AS cval_lineitem_l_comment_2#8065, cval_lineitem_l_shipdate#8021 AS cval_lineitem_l_shipdate_2#8066, cdepval_lineitem_l_quantity#8022 AS cdepval_lineitem_l_quantity_2#8067, cdepval_lineitem_l_extendedprice#8023 AS cdepval_lineitem_l_extendedprice_2#8068, cdepval_lineitem_l_discount#8024 AS cdepval_lineitem_l_discount_2#8069, ... 21 more fields]
         :  +- Relation[rid#8001,cpfk_orders_lineitem#8002,cpfk_supplier_lineitem#8003,cfpk_lineitem_supplier#8004,cfpk_lineitem_partsupp#8005,cpfk_part_lineitem#8006,cfpk_lineitem_part#8007,cpfk_partsupp_lineitem#8008,cfpk_lineitem_orders#8009,cval_lineitem_l_quantity#8010,cval_lineitem_l_extendedprice#8011,cval_lineitem_l_discount#8012,cval_lineitem_l_tax#8013,cval_lineitem_l_returnflag#8014,cval_lineitem_l_linestatus#8015,cval_lineitem_l_commitdate#8016,cval_lineitem_l_receiptdate#8017,cval_lineitem_l_shipinstruct#8018,cval_lineitem_l_shipmode#8019,cval_lineitem_l_comment#8020,cval_lineitem_l_shipdate#8021,cdepval_lineitem_l_quantity#8022,cdepval_lineitem_l_extendedprice#8023,cdepval_lineitem_l_discount#8024,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#7953 AS rid_1#7977, cpfk_customer_orders#7954 AS cpfk_customer_orders_1#7978, cfpk_orders_customer#7955 AS cfpk_orders_customer_1#7979, cval_orders_o_orderstatus#7956 AS cval_orders_o_orderstatus_1#7980, cval_orders_o_totalprice#7957 AS cval_orders_o_totalprice_1#7981, cval_orders_o_orderpriority#7958 AS cval_orders_o_orderpriority_1#7982, cval_orders_o_clerk#7959 AS cval_orders_o_clerk_1#7983, cval_orders_o_shippriority#7960 AS cval_orders_o_shippriority_1#7984, cval_orders_o_comment#7961 AS cval_orders_o_comment_1#7985, cval_orders_o_orderdate#7962 AS cval_orders_o_orderdate_1#7986, cdepval_orders_o_orderstatus#7963 AS cdepval_orders_o_orderstatus_1#7987, cdepval_orders_o_totalprice#7964 AS cdepval_orders_o_totalprice_1#7988, cdepval_orders_o_orderpriority#7965 AS cdepval_orders_o_orderpriority_1#7989, cdepval_orders_o_clerk#7966 AS cdepval_orders_o_clerk_1#7990, cdepval_orders_o_shippriority#7967 AS cdepval_orders_o_shippriority_1#7991, cdepval_orders_o_comment#7968 AS cdepval_orders_o_comment_1#7992, cdepval_orders_o_orderdate#7969 AS cdepval_orders_o_orderdate_1#7993, co_orderstatus#7970 AS co_orderstatus_1#7994, co_totalprice#7971 AS co_totalprice_1#7995, co_orderpriority#7972 AS co_orderpriority_1#7996, co_clerk#7973 AS co_clerk_1#7997, co_shippriority#7974 AS co_shippriority_1#7998, co_comment#7975 AS co_comment_1#7999, co_orderdate#7976 AS co_orderdate_1#8000]
            :  +- Relation[rid#7953,cpfk_customer_orders#7954,cfpk_orders_customer#7955,cval_orders_o_orderstatus#7956,cval_orders_o_totalprice#7957,cval_orders_o_orderpriority#7958,cval_orders_o_clerk#7959,cval_orders_o_shippriority#7960,cval_orders_o_comment#7961,cval_orders_o_orderdate#7962,cdepval_orders_o_orderstatus#7963,cdepval_orders_o_totalprice#7964,cdepval_orders_o_orderpriority#7965,cdepval_orders_o_clerk#7966,cdepval_orders_o_shippriority#7967,cdepval_orders_o_comment#7968,cdepval_orders_o_orderdate#7969,co_orderstatus#7970,co_totalprice#7971,co_orderpriority#7972,co_clerk#7973,co_shippriority#7974,co_comment#7975,co_orderdate#7976] JDBCRelation(torders) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
               +- Project [rid#7869 AS rid_0#7890, cpfk_nation_customer#7870 AS cpfk_nation_customer_0#7891, cfpk_customer_nation#7871 AS cfpk_customer_nation_0#7892, cval_customer_c_name#7872 AS cval_customer_c_name_0#7893, cval_customer_c_address#7873 AS cval_customer_c_address_0#7894, cval_customer_c_phone#7874 AS cval_customer_c_phone_0#7895, cval_customer_c_acctbal#7875 AS cval_customer_c_acctbal_0#7896, cval_customer_c_comment#7876 AS cval_customer_c_comment_0#7897, cval_customer_c_mktsegment#7877 AS cval_customer_c_mktsegment_0#7898, cdepval_customer_c_name#7878 AS cdepval_customer_c_name_0#7899, cdepval_customer_c_address#7879 AS cdepval_customer_c_address_0#7900, cdepval_customer_c_phone#7880 AS cdepval_customer_c_phone_0#7901, cdepval_customer_c_acctbal#7881 AS cdepval_customer_c_acctbal_0#7902, cdepval_customer_c_comment#7882 AS cdepval_customer_c_comment_0#7903, cdepval_customer_c_mktsegment#7883 AS cdepval_customer_c_mktsegment_0#7904, cc_name#7884 AS cc_name_0#7905, cc_address#7885 AS cc_address_0#7906, cc_phone#7886 AS cc_phone_0#7907, cc_acctbal#7887 AS cc_acctbal_0#7908, cc_comment#7888 AS cc_comment_0#7909, cc_mktsegment#7889 AS cc_mktsegment_0#7910]
                  +- Relation[rid#7869,cpfk_nation_customer#7870,cfpk_customer_nation#7871,cval_customer_c_name#7872,cval_customer_c_address#7873,cval_customer_c_phone#7874,cval_customer_c_acctbal#7875,cval_customer_c_comment#7876,cval_customer_c_mktsegment#7877,cdepval_customer_c_name#7878,cdepval_customer_c_address#7879,cdepval_customer_c_phone#7880,cdepval_customer_c_acctbal#7881,cdepval_customer_c_comment#7882,cdepval_customer_c_mktsegment#7883,cc_name#7884,cc_address#7885,cc_phone#7886,cc_acctbal#7887,cc_comment#7888,cc_mktsegment#7889] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 39602ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 23:16:39 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:16:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8190L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:16:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:16:39 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:16:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:16:39 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:16:39 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:16:39 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:16:39 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:16:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8190L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#8246 AS rid_2#8291, cpfk_orders_lineitem#8247 AS cpfk_orders_lineitem_2#8292, cpfk_supplier_lineitem#8248 AS cpfk_supplier_lineitem_2#8293, cfpk_lineitem_supplier#8249 AS cfpk_lineitem_supplier_2#8294, cfpk_lineitem_partsupp#8250 AS cfpk_lineitem_partsupp_2#8295, cpfk_part_lineitem#8251 AS cpfk_part_lineitem_2#8296, cfpk_lineitem_part#8252 AS cfpk_lineitem_part_2#8297, cpfk_partsupp_lineitem#8253 AS cpfk_partsupp_lineitem_2#8298, cfpk_lineitem_orders#8254 AS cfpk_lineitem_orders_2#8299, cval_lineitem_l_quantity#8255 AS cval_lineitem_l_quantity_2#8300, cval_lineitem_l_extendedprice#8256 AS cval_lineitem_l_extendedprice_2#8301, cval_lineitem_l_discount#8257 AS cval_lineitem_l_discount_2#8302, cval_lineitem_l_tax#8258 AS cval_lineitem_l_tax_2#8303, cval_lineitem_l_returnflag#8259 AS cval_lineitem_l_returnflag_2#8304, cval_lineitem_l_linestatus#8260 AS cval_lineitem_l_linestatus_2#8305, cval_lineitem_l_commitdate#8261 AS cval_lineitem_l_commitdate_2#8306, cval_lineitem_l_receiptdate#8262 AS cval_lineitem_l_receiptdate_2#8307, cval_lineitem_l_shipinstruct#8263 AS cval_lineitem_l_shipinstruct_2#8308, cval_lineitem_l_shipmode#8264 AS cval_lineitem_l_shipmode_2#8309, cval_lineitem_l_comment#8265 AS cval_lineitem_l_comment_2#8310, cval_lineitem_l_shipdate#8266 AS cval_lineitem_l_shipdate_2#8311, cdepval_lineitem_l_quantity#8267 AS cdepval_lineitem_l_quantity_2#8312, cdepval_lineitem_l_extendedprice#8268 AS cdepval_lineitem_l_extendedprice_2#8313, cdepval_lineitem_l_discount#8269 AS cdepval_lineitem_l_discount_2#8314, ... 21 more fields]
         :  :  :  :  +- Relation[rid#8246,cpfk_orders_lineitem#8247,cpfk_supplier_lineitem#8248,cfpk_lineitem_supplier#8249,cfpk_lineitem_partsupp#8250,cpfk_part_lineitem#8251,cfpk_lineitem_part#8252,cpfk_partsupp_lineitem#8253,cfpk_lineitem_orders#8254,cval_lineitem_l_quantity#8255,cval_lineitem_l_extendedprice#8256,cval_lineitem_l_discount#8257,cval_lineitem_l_tax#8258,cval_lineitem_l_returnflag#8259,cval_lineitem_l_linestatus#8260,cval_lineitem_l_commitdate#8261,cval_lineitem_l_receiptdate#8262,cval_lineitem_l_shipinstruct#8263,cval_lineitem_l_shipmode#8264,cval_lineitem_l_comment#8265,cval_lineitem_l_shipdate#8266,cdepval_lineitem_l_quantity#8267,cdepval_lineitem_l_extendedprice#8268,cdepval_lineitem_l_discount#8269,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#8210 AS rid_1#8228, cpfk_nation_supplier#8211 AS cpfk_nation_supplier_1#8229, cfpk_supplier_nation#8212 AS cfpk_supplier_nation_1#8230, cval_supplier_s_name#8213 AS cval_supplier_s_name_1#8231, cval_supplier_s_address#8214 AS cval_supplier_s_address_1#8232, cval_supplier_s_phone#8215 AS cval_supplier_s_phone_1#8233, cval_supplier_s_acctbal#8216 AS cval_supplier_s_acctbal_1#8234, cval_supplier_s_comment#8217 AS cval_supplier_s_comment_1#8235, cdepval_supplier_s_name#8218 AS cdepval_supplier_s_name_1#8236, cdepval_supplier_s_address#8219 AS cdepval_supplier_s_address_1#8237, cdepval_supplier_s_phone#8220 AS cdepval_supplier_s_phone_1#8238, cdepval_supplier_s_acctbal#8221 AS cdepval_supplier_s_acctbal_1#8239, cdepval_supplier_s_comment#8222 AS cdepval_supplier_s_comment_1#8240, cs_name#8223 AS cs_name_1#8241, cs_address#8224 AS cs_address_1#8242, cs_phone#8225 AS cs_phone_1#8243, cs_acctbal#8226 AS cs_acctbal_1#8244, cs_comment#8227 AS cs_comment_1#8245]
         :  :  :     :  +- Relation[rid#8210,cpfk_nation_supplier#8211,cfpk_supplier_nation#8212,cval_supplier_s_name#8213,cval_supplier_s_address#8214,cval_supplier_s_phone#8215,cval_supplier_s_acctbal#8216,cval_supplier_s_comment#8217,cdepval_supplier_s_name#8218,cdepval_supplier_s_address#8219,cdepval_supplier_s_phone#8220,cdepval_supplier_s_acctbal#8221,cdepval_supplier_s_comment#8222,cs_name#8223,cs_address#8224,cs_phone#8225,cs_acctbal#8226,cs_comment#8227] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#8192 AS rid_0#8201, cpfk_region_nation#8193 AS cpfk_region_nation_0#8202, cfpk_nation_region#8194 AS cfpk_nation_region_0#8203, cval_nation_n_name#8195 AS cval_nation_n_name_0#8204, cval_nation_n_comment#8196 AS cval_nation_n_comment_0#8205, cdepval_nation_n_name#8197 AS cdepval_nation_n_name_0#8206, cdepval_nation_n_comment#8198 AS cdepval_nation_n_comment_0#8207, cn_name#8199 AS cn_name_0#8208, cn_comment#8200 AS cn_comment_0#8209]
         :  :  :        +- Relation[rid#8192,cpfk_region_nation#8193,cfpk_nation_region#8194,cval_nation_n_name#8195,cval_nation_n_comment#8196,cdepval_nation_n_name#8197,cdepval_nation_n_comment#8198,cn_name#8199,cn_comment#8200] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#8336 AS rid_3#8361, cval_part_p_name#8337 AS cval_part_p_name_3#8362, cval_part_p_mfgr#8338 AS cval_part_p_mfgr_3#8363, cval_part_p_type#8339 AS cval_part_p_type_3#8364, cval_part_p_size#8340 AS cval_part_p_size_3#8365, cval_part_p_container#8341 AS cval_part_p_container_3#8366, cval_part_p_retailprice#8342 AS cval_part_p_retailprice_3#8367, cval_part_p_comment#8343 AS cval_part_p_comment_3#8368, cval_part_p_brand#8344 AS cval_part_p_brand_3#8369, cdepval_part_p_name#8345 AS cdepval_part_p_name_3#8370, cdepval_part_p_mfgr#8346 AS cdepval_part_p_mfgr_3#8371, cdepval_part_p_type#8347 AS cdepval_part_p_type_3#8372, cdepval_part_p_size#8348 AS cdepval_part_p_size_3#8373, cdepval_part_p_container#8349 AS cdepval_part_p_container_3#8374, cdepval_part_p_retailprice#8350 AS cdepval_part_p_retailprice_3#8375, cdepval_part_p_comment#8351 AS cdepval_part_p_comment_3#8376, cdepval_part_p_brand#8352 AS cdepval_part_p_brand_3#8377, cp_name#8353 AS cp_name_3#8378, cp_mfgr#8354 AS cp_mfgr_3#8379, cp_type#8355 AS cp_type_3#8380, cp_size#8356 AS cp_size_3#8381, cp_container#8357 AS cp_container_3#8382, cp_retailprice#8358 AS cp_retailprice_3#8383, cp_comment#8359 AS cp_comment_3#8384, cp_brand#8360 AS cp_brand_3#8385]
         :  :     +- Relation[rid#8336,cval_part_p_name#8337,cval_part_p_mfgr#8338,cval_part_p_type#8339,cval_part_p_size#8340,cval_part_p_container#8341,cval_part_p_retailprice#8342,cval_part_p_comment#8343,cval_part_p_brand#8344,cdepval_part_p_name#8345,cdepval_part_p_mfgr#8346,cdepval_part_p_type#8347,cdepval_part_p_size#8348,cdepval_part_p_container#8349,cdepval_part_p_retailprice#8350,cdepval_part_p_comment#8351,cdepval_part_p_brand#8352,cp_name#8353,cp_mfgr#8354,cp_type#8355,cp_size#8356,cp_container#8357,cp_retailprice#8358,cp_comment#8359,cp_brand#8360] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#8386 AS rid_4#8400, cpfk_part_partsupp#8387 AS cpfk_part_partsupp_4#8401, cfpk_partsupp_part#8388 AS cfpk_partsupp_part_4#8402, cpfk_supplier_partsupp#8389 AS cpfk_supplier_partsupp_4#8403, cfpk_partsupp_supplier#8390 AS cfpk_partsupp_supplier_4#8404, cval_partsupp_ps_availqty#8391 AS cval_partsupp_ps_availqty_4#8405, cval_partsupp_ps_supplycost#8392 AS cval_partsupp_ps_supplycost_4#8406, cval_partsupp_ps_comment#8393 AS cval_partsupp_ps_comment_4#8407, cdepval_partsupp_ps_availqty#8394 AS cdepval_partsupp_ps_availqty_4#8408, cdepval_partsupp_ps_supplycost#8395 AS cdepval_partsupp_ps_supplycost_4#8409, cdepval_partsupp_ps_comment#8396 AS cdepval_partsupp_ps_comment_4#8410, cps_availqty#8397 AS cps_availqty_4#8411, cps_supplycost#8398 AS cps_supplycost_4#8412, cps_comment#8399 AS cps_comment_4#8413]
         :     +- Relation[rid#8386,cpfk_part_partsupp#8387,cfpk_partsupp_part#8388,cpfk_supplier_partsupp#8389,cfpk_partsupp_supplier#8390,cval_partsupp_ps_availqty#8391,cval_partsupp_ps_supplycost#8392,cval_partsupp_ps_comment#8393,cdepval_partsupp_ps_availqty#8394,cdepval_partsupp_ps_supplycost#8395,cdepval_partsupp_ps_comment#8396,cps_availqty#8397,cps_supplycost#8398,cps_comment#8399] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#8414 AS rid_5#8438, cpfk_customer_orders#8415 AS cpfk_customer_orders_5#8439, cfpk_orders_customer#8416 AS cfpk_orders_customer_5#8440, cval_orders_o_orderstatus#8417 AS cval_orders_o_orderstatus_5#8441, cval_orders_o_totalprice#8418 AS cval_orders_o_totalprice_5#8442, cval_orders_o_orderpriority#8419 AS cval_orders_o_orderpriority_5#8443, cval_orders_o_clerk#8420 AS cval_orders_o_clerk_5#8444, cval_orders_o_shippriority#8421 AS cval_orders_o_shippriority_5#8445, cval_orders_o_comment#8422 AS cval_orders_o_comment_5#8446, cval_orders_o_orderdate#8423 AS cval_orders_o_orderdate_5#8447, cdepval_orders_o_orderstatus#8424 AS cdepval_orders_o_orderstatus_5#8448, cdepval_orders_o_totalprice#8425 AS cdepval_orders_o_totalprice_5#8449, cdepval_orders_o_orderpriority#8426 AS cdepval_orders_o_orderpriority_5#8450, cdepval_orders_o_clerk#8427 AS cdepval_orders_o_clerk_5#8451, cdepval_orders_o_shippriority#8428 AS cdepval_orders_o_shippriority_5#8452, cdepval_orders_o_comment#8429 AS cdepval_orders_o_comment_5#8453, cdepval_orders_o_orderdate#8430 AS cdepval_orders_o_orderdate_5#8454, co_orderstatus#8431 AS co_orderstatus_5#8455, co_totalprice#8432 AS co_totalprice_5#8456, co_orderpriority#8433 AS co_orderpriority_5#8457, co_clerk#8434 AS co_clerk_5#8458, co_shippriority#8435 AS co_shippriority_5#8459, co_comment#8436 AS co_comment_5#8460, co_orderdate#8437 AS co_orderdate_5#8461]
            +- Relation[rid#8414,cpfk_customer_orders#8415,cfpk_orders_customer#8416,cval_orders_o_orderstatus#8417,cval_orders_o_totalprice#8418,cval_orders_o_orderpriority#8419,cval_orders_o_clerk#8420,cval_orders_o_shippriority#8421,cval_orders_o_comment#8422,cval_orders_o_orderdate#8423,cdepval_orders_o_orderstatus#8424,cdepval_orders_o_totalprice#8425,cdepval_orders_o_orderpriority#8426,cdepval_orders_o_clerk#8427,cdepval_orders_o_shippriority#8428,cdepval_orders_o_comment#8429,cdepval_orders_o_orderdate#8430,co_orderstatus#8431,co_totalprice#8432,co_orderpriority#8433,co_clerk#8434,co_shippriority#8435,co_comment#8436,co_orderdate#8437] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 63593ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/25 23:17:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:17:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8603L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 23:17:43 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:17:43 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:17:43 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:17:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:17:43 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:17:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:17:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:17:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:17:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:17:43 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:17:43 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:17:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8603L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#8741 AS rid_4#8786, cpfk_orders_lineitem#8742 AS cpfk_orders_lineitem_4#8787, cpfk_supplier_lineitem#8743 AS cpfk_supplier_lineitem_4#8788, cfpk_lineitem_supplier#8744 AS cfpk_lineitem_supplier_4#8789, cfpk_lineitem_partsupp#8745 AS cfpk_lineitem_partsupp_4#8790, cpfk_part_lineitem#8746 AS cpfk_part_lineitem_4#8791, cfpk_lineitem_part#8747 AS cfpk_lineitem_part_4#8792, cpfk_partsupp_lineitem#8748 AS cpfk_partsupp_lineitem_4#8793, cfpk_lineitem_orders#8749 AS cfpk_lineitem_orders_4#8794, cval_lineitem_l_quantity#8750 AS cval_lineitem_l_quantity_4#8795, cval_lineitem_l_extendedprice#8751 AS cval_lineitem_l_extendedprice_4#8796, cval_lineitem_l_discount#8752 AS cval_lineitem_l_discount_4#8797, cval_lineitem_l_tax#8753 AS cval_lineitem_l_tax_4#8798, cval_lineitem_l_returnflag#8754 AS cval_lineitem_l_returnflag_4#8799, cval_lineitem_l_linestatus#8755 AS cval_lineitem_l_linestatus_4#8800, cval_lineitem_l_commitdate#8756 AS cval_lineitem_l_commitdate_4#8801, cval_lineitem_l_receiptdate#8757 AS cval_lineitem_l_receiptdate_4#8802, cval_lineitem_l_shipinstruct#8758 AS cval_lineitem_l_shipinstruct_4#8803, cval_lineitem_l_shipmode#8759 AS cval_lineitem_l_shipmode_4#8804, cval_lineitem_l_comment#8760 AS cval_lineitem_l_comment_4#8805, cval_lineitem_l_shipdate#8761 AS cval_lineitem_l_shipdate_4#8806, cdepval_lineitem_l_quantity#8762 AS cdepval_lineitem_l_quantity_4#8807, cdepval_lineitem_l_extendedprice#8763 AS cdepval_lineitem_l_extendedprice_4#8808, cdepval_lineitem_l_discount#8764 AS cdepval_lineitem_l_discount_4#8809, ... 21 more fields]
            :  :  +- Relation[rid#8741,cpfk_orders_lineitem#8742,cpfk_supplier_lineitem#8743,cfpk_lineitem_supplier#8744,cfpk_lineitem_partsupp#8745,cpfk_part_lineitem#8746,cfpk_lineitem_part#8747,cpfk_partsupp_lineitem#8748,cfpk_lineitem_orders#8749,cval_lineitem_l_quantity#8750,cval_lineitem_l_extendedprice#8751,cval_lineitem_l_discount#8752,cval_lineitem_l_tax#8753,cval_lineitem_l_returnflag#8754,cval_lineitem_l_linestatus#8755,cval_lineitem_l_commitdate#8756,cval_lineitem_l_receiptdate#8757,cval_lineitem_l_shipinstruct#8758,cval_lineitem_l_shipmode#8759,cval_lineitem_l_comment#8760,cval_lineitem_l_shipdate#8761,cdepval_lineitem_l_quantity#8762,cdepval_lineitem_l_extendedprice#8763,cdepval_lineitem_l_discount#8764,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#8693 AS rid_3#8717, cpfk_customer_orders#8694 AS cpfk_customer_orders_3#8718, cfpk_orders_customer#8695 AS cfpk_orders_customer_3#8719, cval_orders_o_orderstatus#8696 AS cval_orders_o_orderstatus_3#8720, cval_orders_o_totalprice#8697 AS cval_orders_o_totalprice_3#8721, cval_orders_o_orderpriority#8698 AS cval_orders_o_orderpriority_3#8722, cval_orders_o_clerk#8699 AS cval_orders_o_clerk_3#8723, cval_orders_o_shippriority#8700 AS cval_orders_o_shippriority_3#8724, cval_orders_o_comment#8701 AS cval_orders_o_comment_3#8725, cval_orders_o_orderdate#8702 AS cval_orders_o_orderdate_3#8726, cdepval_orders_o_orderstatus#8703 AS cdepval_orders_o_orderstatus_3#8727, cdepval_orders_o_totalprice#8704 AS cdepval_orders_o_totalprice_3#8728, cdepval_orders_o_orderpriority#8705 AS cdepval_orders_o_orderpriority_3#8729, cdepval_orders_o_clerk#8706 AS cdepval_orders_o_clerk_3#8730, cdepval_orders_o_shippriority#8707 AS cdepval_orders_o_shippriority_3#8731, cdepval_orders_o_comment#8708 AS cdepval_orders_o_comment_3#8732, cdepval_orders_o_orderdate#8709 AS cdepval_orders_o_orderdate_3#8733, co_orderstatus#8710 AS co_orderstatus_3#8734, co_totalprice#8711 AS co_totalprice_3#8735, co_orderpriority#8712 AS co_orderpriority_3#8736, co_clerk#8713 AS co_clerk_3#8737, co_shippriority#8714 AS co_shippriority_3#8738, co_comment#8715 AS co_comment_3#8739, co_orderdate#8716 AS co_orderdate_3#8740]
            :     :  +- Relation[rid#8693,cpfk_customer_orders#8694,cfpk_orders_customer#8695,cval_orders_o_orderstatus#8696,cval_orders_o_totalprice#8697,cval_orders_o_orderpriority#8698,cval_orders_o_clerk#8699,cval_orders_o_shippriority#8700,cval_orders_o_comment#8701,cval_orders_o_orderdate#8702,cdepval_orders_o_orderstatus#8703,cdepval_orders_o_totalprice#8704,cdepval_orders_o_orderpriority#8705,cdepval_orders_o_clerk#8706,cdepval_orders_o_shippriority#8707,cdepval_orders_o_comment#8708,cdepval_orders_o_orderdate#8709,co_orderstatus#8710,co_totalprice#8711,co_orderpriority#8712,co_clerk#8713,co_shippriority#8714,co_comment#8715,co_orderdate#8716] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#8651 AS rid_2#8672, cpfk_nation_customer#8652 AS cpfk_nation_customer_2#8673, cfpk_customer_nation#8653 AS cfpk_customer_nation_2#8674, cval_customer_c_name#8654 AS cval_customer_c_name_2#8675, cval_customer_c_address#8655 AS cval_customer_c_address_2#8676, cval_customer_c_phone#8656 AS cval_customer_c_phone_2#8677, cval_customer_c_acctbal#8657 AS cval_customer_c_acctbal_2#8678, cval_customer_c_comment#8658 AS cval_customer_c_comment_2#8679, cval_customer_c_mktsegment#8659 AS cval_customer_c_mktsegment_2#8680, cdepval_customer_c_name#8660 AS cdepval_customer_c_name_2#8681, cdepval_customer_c_address#8661 AS cdepval_customer_c_address_2#8682, cdepval_customer_c_phone#8662 AS cdepval_customer_c_phone_2#8683, cdepval_customer_c_acctbal#8663 AS cdepval_customer_c_acctbal_2#8684, cdepval_customer_c_comment#8664 AS cdepval_customer_c_comment_2#8685, cdepval_customer_c_mktsegment#8665 AS cdepval_customer_c_mktsegment_2#8686, cc_name#8666 AS cc_name_2#8687, cc_address#8667 AS cc_address_2#8688, cc_phone#8668 AS cc_phone_2#8689, cc_acctbal#8669 AS cc_acctbal_2#8690, cc_comment#8670 AS cc_comment_2#8691, cc_mktsegment#8671 AS cc_mktsegment_2#8692]
            :        :  +- Relation[rid#8651,cpfk_nation_customer#8652,cfpk_customer_nation#8653,cval_customer_c_name#8654,cval_customer_c_address#8655,cval_customer_c_phone#8656,cval_customer_c_acctbal#8657,cval_customer_c_comment#8658,cval_customer_c_mktsegment#8659,cdepval_customer_c_name#8660,cdepval_customer_c_address#8661,cdepval_customer_c_phone#8662,cdepval_customer_c_acctbal#8663,cdepval_customer_c_comment#8664,cdepval_customer_c_mktsegment#8665,cc_name#8666,cc_address#8667,cc_phone#8668,cc_acctbal#8669,cc_comment#8670,cc_mktsegment#8671] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
            :           :- Project [rid#8633 AS rid_1#8642, cpfk_region_nation#8634 AS cpfk_region_nation_1#8643, cfpk_nation_region#8635 AS cfpk_nation_region_1#8644, cval_nation_n_name#8636 AS cval_nation_n_name_1#8645, cval_nation_n_comment#8637 AS cval_nation_n_comment_1#8646, cdepval_nation_n_name#8638 AS cdepval_nation_n_name_1#8647, cdepval_nation_n_comment#8639 AS cdepval_nation_n_comment_1#8648, cn_name#8640 AS cn_name_1#8649, cn_comment#8641 AS cn_comment_1#8650]
            :           :  +- Relation[rid#8633,cpfk_region_nation#8634,cfpk_nation_region#8635,cval_nation_n_name#8636,cval_nation_n_comment#8637,cdepval_nation_n_name#8638,cdepval_nation_n_comment#8639,cn_name#8640,cn_comment#8641] JDBCRelation(tnation) [numPartitions=1]
            :           +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :              +- Project [rid#8605 AS rid_0#8612, cval_region_r_name#8606 AS cval_region_r_name_0#8613, cval_region_r_comment#8607 AS cval_region_r_comment_0#8614, cdepval_region_r_name#8608 AS cdepval_region_r_name_0#8615, cdepval_region_r_comment#8609 AS cdepval_region_r_comment_0#8616, cr_name#8610 AS cr_name_0#8617, cr_comment#8611 AS cr_comment_0#8618]
            :                 +- Relation[rid#8605,cval_region_r_name#8606,cval_region_r_comment#8607,cdepval_region_r_name#8608,cdepval_region_r_comment#8609,cr_name#8610,cr_comment#8611] JDBCRelation(tregion) [numPartitions=1]
            +- Project [rid#8831 AS rid_5#8849, cpfk_nation_supplier#8832 AS cpfk_nation_supplier_5#8850, cfpk_supplier_nation#8833 AS cfpk_supplier_nation_5#8851, cval_supplier_s_name#8834 AS cval_supplier_s_name_5#8852, cval_supplier_s_address#8835 AS cval_supplier_s_address_5#8853, cval_supplier_s_phone#8836 AS cval_supplier_s_phone_5#8854, cval_supplier_s_acctbal#8837 AS cval_supplier_s_acctbal_5#8855, cval_supplier_s_comment#8838 AS cval_supplier_s_comment_5#8856, cdepval_supplier_s_name#8839 AS cdepval_supplier_s_name_5#8857, cdepval_supplier_s_address#8840 AS cdepval_supplier_s_address_5#8858, cdepval_supplier_s_phone#8841 AS cdepval_supplier_s_phone_5#8859, cdepval_supplier_s_acctbal#8842 AS cdepval_supplier_s_acctbal_5#8860, cdepval_supplier_s_comment#8843 AS cdepval_supplier_s_comment_5#8861, cs_name#8844 AS cs_name_5#8862, cs_address#8845 AS cs_address_5#8863, cs_phone#8846 AS cs_phone_5#8864, cs_acctbal#8847 AS cs_acctbal_5#8865, cs_comment#8848 AS cs_comment_5#8866]
               +- Relation[rid#8831,cpfk_nation_supplier#8832,cfpk_supplier_nation#8833,cval_supplier_s_name#8834,cval_supplier_s_address#8835,cval_supplier_s_phone#8836,cval_supplier_s_acctbal#8837,cval_supplier_s_comment#8838,cdepval_supplier_s_name#8839,cdepval_supplier_s_address#8840,cdepval_supplier_s_phone#8841,cdepval_supplier_s_acctbal#8842,cdepval_supplier_s_comment#8843,cs_name#8844,cs_address#8845,cs_phone#8846,cs_acctbal#8847,cs_comment#8848] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 30625ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/25 23:18:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:18:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8996L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 23:18:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8996L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#8998 AS rid_0#9022, cpfk_customer_orders#8999 AS cpfk_customer_orders_0#9023, cfpk_orders_customer#9000 AS cfpk_orders_customer_0#9024, cval_orders_o_orderstatus#9001 AS cval_orders_o_orderstatus_0#9025, cval_orders_o_totalprice#9002 AS cval_orders_o_totalprice_0#9026, cval_orders_o_orderpriority#9003 AS cval_orders_o_orderpriority_0#9027, cval_orders_o_clerk#9004 AS cval_orders_o_clerk_0#9028, cval_orders_o_shippriority#9005 AS cval_orders_o_shippriority_0#9029, cval_orders_o_comment#9006 AS cval_orders_o_comment_0#9030, cval_orders_o_orderdate#9007 AS cval_orders_o_orderdate_0#9031, cdepval_orders_o_orderstatus#9008 AS cdepval_orders_o_orderstatus_0#9032, cdepval_orders_o_totalprice#9009 AS cdepval_orders_o_totalprice_0#9033, cdepval_orders_o_orderpriority#9010 AS cdepval_orders_o_orderpriority_0#9034, cdepval_orders_o_clerk#9011 AS cdepval_orders_o_clerk_0#9035, cdepval_orders_o_shippriority#9012 AS cdepval_orders_o_shippriority_0#9036, cdepval_orders_o_comment#9013 AS cdepval_orders_o_comment_0#9037, cdepval_orders_o_orderdate#9014 AS cdepval_orders_o_orderdate_0#9038, co_orderstatus#9015 AS co_orderstatus_0#9039, co_totalprice#9016 AS co_totalprice_0#9040, co_orderpriority#9017 AS co_orderpriority_0#9041, co_clerk#9018 AS co_clerk_0#9042, co_shippriority#9019 AS co_shippriority_0#9043, co_comment#9020 AS co_comment_0#9044, co_orderdate#9021 AS co_orderdate_0#9045]
         :  +- Relation[rid#8998,cpfk_customer_orders#8999,cfpk_orders_customer#9000,cval_orders_o_orderstatus#9001,cval_orders_o_totalprice#9002,cval_orders_o_orderpriority#9003,cval_orders_o_clerk#9004,cval_orders_o_shippriority#9005,cval_orders_o_comment#9006,cval_orders_o_orderdate#9007,cdepval_orders_o_orderstatus#9008,cdepval_orders_o_totalprice#9009,cdepval_orders_o_orderpriority#9010,cdepval_orders_o_clerk#9011,cdepval_orders_o_shippriority#9012,cdepval_orders_o_comment#9013,cdepval_orders_o_orderdate#9014,co_orderstatus#9015,co_totalprice#9016,co_orderpriority#9017,co_clerk#9018,co_shippriority#9019,co_comment#9020,co_orderdate#9021] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#9046 AS rid_1#9067, cpfk_nation_customer#9047 AS cpfk_nation_customer_1#9068, cfpk_customer_nation#9048 AS cfpk_customer_nation_1#9069, cval_customer_c_name#9049 AS cval_customer_c_name_1#9070, cval_customer_c_address#9050 AS cval_customer_c_address_1#9071, cval_customer_c_phone#9051 AS cval_customer_c_phone_1#9072, cval_customer_c_acctbal#9052 AS cval_customer_c_acctbal_1#9073, cval_customer_c_comment#9053 AS cval_customer_c_comment_1#9074, cval_customer_c_mktsegment#9054 AS cval_customer_c_mktsegment_1#9075, cdepval_customer_c_name#9055 AS cdepval_customer_c_name_1#9076, cdepval_customer_c_address#9056 AS cdepval_customer_c_address_1#9077, cdepval_customer_c_phone#9057 AS cdepval_customer_c_phone_1#9078, cdepval_customer_c_acctbal#9058 AS cdepval_customer_c_acctbal_1#9079, cdepval_customer_c_comment#9059 AS cdepval_customer_c_comment_1#9080, cdepval_customer_c_mktsegment#9060 AS cdepval_customer_c_mktsegment_1#9081, cc_name#9061 AS cc_name_1#9082, cc_address#9062 AS cc_address_1#9083, cc_phone#9063 AS cc_phone_1#9084, cc_acctbal#9064 AS cc_acctbal_1#9085, cc_comment#9065 AS cc_comment_1#9086, cc_mktsegment#9066 AS cc_mktsegment_1#9087]
            +- Relation[rid#9046,cpfk_nation_customer#9047,cfpk_customer_nation#9048,cval_customer_c_name#9049,cval_customer_c_address#9050,cval_customer_c_phone#9051,cval_customer_c_acctbal#9052,cval_customer_c_comment#9053,cval_customer_c_mktsegment#9054,cdepval_customer_c_name#9055,cdepval_customer_c_address#9056,cdepval_customer_c_phone#9057,cdepval_customer_c_acctbal#9058,cdepval_customer_c_comment#9059,cdepval_customer_c_mktsegment#9060,cc_name#9061,cc_address#9062,cc_phone#9063,cc_acctbal#9064,cc_comment#9065,cc_mktsegment#9066] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4459ms
query=q1, count=6001215, duration=2777
query=q10, count=1478870, duration=60178
query=q11, count=31680, duration=3454
query=q12, count=857401, duration=21900
query=q13, count=1500000, duration=4517
query=q14, count=6001215, duration=17837
query=q15, count=6001215, duration=17327
query=q16, count=15780, duration=3617
query=q17, count=6088, duration=26009
query=q18, count=6001215, duration=22029
query=q19, count=205, duration=14995
query=q2, count=3162, duration=3582
query=q20, count=632, duration=3563
query=q21a, count=597422, duration=76728
query=q22, count=1500000, duration=4459
query=q3, count=1214743, duration=39602
query=q4, count=6001215, duration=18331
query=q5, count=48089, duration=30625
query=q6, count=6001215, duration=2476
query=q7, count=9735, duration=34713
query=q8, count=8716, duration=44825
query=q9a, count=6001215, duration=63593
query=q9b, count=6001215, duration=38164
