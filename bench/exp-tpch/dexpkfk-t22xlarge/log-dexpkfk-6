20/04/26 21:58:55 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10573ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sun Apr 26 21:58:58 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sun Apr 26 21:58:59 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sun Apr 26 21:58:59 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sun Apr 26 21:58:59 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sun Apr 26 21:58:59 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sun Apr 26 21:59:03 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sun Apr 26 21:59:07 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sun Apr 26 21:59:07 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/26 21:59:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:59:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2081L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:59:08 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:59:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:59:09 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/26 21:59:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2081L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#2119 AS rid_1#2164, cpfk_orders_lineitem#2120 AS cpfk_orders_lineitem_1#2165, cpfk_supplier_lineitem#2121 AS cpfk_supplier_lineitem_1#2166, cfpk_lineitem_supplier#2122 AS cfpk_lineitem_supplier_1#2167, cfpk_lineitem_partsupp#2123 AS cfpk_lineitem_partsupp_1#2168, cpfk_part_lineitem#2124 AS cpfk_part_lineitem_1#2169, cfpk_lineitem_part#2125 AS cfpk_lineitem_part_1#2170, cpfk_partsupp_lineitem#2126 AS cpfk_partsupp_lineitem_1#2171, cfpk_lineitem_orders#2127 AS cfpk_lineitem_orders_1#2172, cval_lineitem_l_quantity#2128 AS cval_lineitem_l_quantity_1#2173, cval_lineitem_l_extendedprice#2129 AS cval_lineitem_l_extendedprice_1#2174, cval_lineitem_l_discount#2130 AS cval_lineitem_l_discount_1#2175, cval_lineitem_l_tax#2131 AS cval_lineitem_l_tax_1#2176, cval_lineitem_l_returnflag#2132 AS cval_lineitem_l_returnflag_1#2177, cval_lineitem_l_linestatus#2133 AS cval_lineitem_l_linestatus_1#2178, cval_lineitem_l_commitdate#2134 AS cval_lineitem_l_commitdate_1#2179, cval_lineitem_l_receiptdate#2135 AS cval_lineitem_l_receiptdate_1#2180, cval_lineitem_l_shipinstruct#2136 AS cval_lineitem_l_shipinstruct_1#2181, cval_lineitem_l_shipmode#2137 AS cval_lineitem_l_shipmode_1#2182, cval_lineitem_l_comment#2138 AS cval_lineitem_l_comment_1#2183, cval_lineitem_l_shipdate#2139 AS cval_lineitem_l_shipdate_1#2184, cdepval_lineitem_l_quantity#2140 AS cdepval_lineitem_l_quantity_1#2185, cdepval_lineitem_l_extendedprice#2141 AS cdepval_lineitem_l_extendedprice_1#2186, cdepval_lineitem_l_discount#2142 AS cdepval_lineitem_l_discount_1#2187, ... 21 more fields]
         :  +- Relation[rid#2119,cpfk_orders_lineitem#2120,cpfk_supplier_lineitem#2121,cfpk_lineitem_supplier#2122,cfpk_lineitem_partsupp#2123,cpfk_part_lineitem#2124,cfpk_lineitem_part#2125,cpfk_partsupp_lineitem#2126,cfpk_lineitem_orders#2127,cval_lineitem_l_quantity#2128,cval_lineitem_l_extendedprice#2129,cval_lineitem_l_discount#2130,cval_lineitem_l_tax#2131,cval_lineitem_l_returnflag#2132,cval_lineitem_l_linestatus#2133,cval_lineitem_l_commitdate#2134,cval_lineitem_l_receiptdate#2135,cval_lineitem_l_shipinstruct#2136,cval_lineitem_l_shipmode#2137,cval_lineitem_l_comment#2138,cval_lineitem_l_shipdate#2139,cdepval_lineitem_l_quantity#2140,cdepval_lineitem_l_extendedprice#2141,cdepval_lineitem_l_discount#2142,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2083 AS rid_0#2101, cpfk_nation_supplier#2084 AS cpfk_nation_supplier_0#2102, cfpk_supplier_nation#2085 AS cfpk_supplier_nation_0#2103, cval_supplier_s_name#2086 AS cval_supplier_s_name_0#2104, cval_supplier_s_address#2087 AS cval_supplier_s_address_0#2105, cval_supplier_s_phone#2088 AS cval_supplier_s_phone_0#2106, cval_supplier_s_acctbal#2089 AS cval_supplier_s_acctbal_0#2107, cval_supplier_s_comment#2090 AS cval_supplier_s_comment_0#2108, cdepval_supplier_s_name#2091 AS cdepval_supplier_s_name_0#2109, cdepval_supplier_s_address#2092 AS cdepval_supplier_s_address_0#2110, cdepval_supplier_s_phone#2093 AS cdepval_supplier_s_phone_0#2111, cdepval_supplier_s_acctbal#2094 AS cdepval_supplier_s_acctbal_0#2112, cdepval_supplier_s_comment#2095 AS cdepval_supplier_s_comment_0#2113, cs_name#2096 AS cs_name_0#2114, cs_address#2097 AS cs_address_0#2115, cs_phone#2098 AS cs_phone_0#2116, cs_acctbal#2099 AS cs_acctbal_0#2117, cs_comment#2100 AS cs_comment_0#2118]
            +- Relation[rid#2083,cpfk_nation_supplier#2084,cfpk_supplier_nation#2085,cval_supplier_s_name#2086,cval_supplier_s_address#2087,cval_supplier_s_phone#2088,cval_supplier_s_acctbal#2089,cval_supplier_s_comment#2090,cdepval_supplier_s_name#2091,cdepval_supplier_s_address#2092,cdepval_supplier_s_phone#2093,cdepval_supplier_s_acctbal#2094,cdepval_supplier_s_comment#2095,cs_name#2096,cs_address#2097,cs_phone#2098,cs_acctbal#2099,cs_comment#2100] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17632ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/26 21:59:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:59:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2276L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 21:59:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:59:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:59:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:59:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:59:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:59:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:59:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:59:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:59:26 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:59:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2276L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#2278 AS rid_0#2323, cpfk_orders_lineitem#2279 AS cpfk_orders_lineitem_0#2324, cpfk_supplier_lineitem#2280 AS cpfk_supplier_lineitem_0#2325, cfpk_lineitem_supplier#2281 AS cfpk_lineitem_supplier_0#2326, cfpk_lineitem_partsupp#2282 AS cfpk_lineitem_partsupp_0#2327, cpfk_part_lineitem#2283 AS cpfk_part_lineitem_0#2328, cfpk_lineitem_part#2284 AS cfpk_lineitem_part_0#2329, cpfk_partsupp_lineitem#2285 AS cpfk_partsupp_lineitem_0#2330, cfpk_lineitem_orders#2286 AS cfpk_lineitem_orders_0#2331, cval_lineitem_l_quantity#2287 AS cval_lineitem_l_quantity_0#2332, cval_lineitem_l_extendedprice#2288 AS cval_lineitem_l_extendedprice_0#2333, cval_lineitem_l_discount#2289 AS cval_lineitem_l_discount_0#2334, cval_lineitem_l_tax#2290 AS cval_lineitem_l_tax_0#2335, cval_lineitem_l_returnflag#2291 AS cval_lineitem_l_returnflag_0#2336, cval_lineitem_l_linestatus#2292 AS cval_lineitem_l_linestatus_0#2337, cval_lineitem_l_commitdate#2293 AS cval_lineitem_l_commitdate_0#2338, cval_lineitem_l_receiptdate#2294 AS cval_lineitem_l_receiptdate_0#2339, cval_lineitem_l_shipinstruct#2295 AS cval_lineitem_l_shipinstruct_0#2340, cval_lineitem_l_shipmode#2296 AS cval_lineitem_l_shipmode_0#2341, cval_lineitem_l_comment#2297 AS cval_lineitem_l_comment_0#2342, cval_lineitem_l_shipdate#2298 AS cval_lineitem_l_shipdate_0#2343, cdepval_lineitem_l_quantity#2299 AS cdepval_lineitem_l_quantity_0#2344, cdepval_lineitem_l_extendedprice#2300 AS cdepval_lineitem_l_extendedprice_0#2345, cdepval_lineitem_l_discount#2301 AS cdepval_lineitem_l_discount_0#2346, ... 21 more fields]
         :  +- Relation[rid#2278,cpfk_orders_lineitem#2279,cpfk_supplier_lineitem#2280,cfpk_lineitem_supplier#2281,cfpk_lineitem_partsupp#2282,cpfk_part_lineitem#2283,cfpk_lineitem_part#2284,cpfk_partsupp_lineitem#2285,cfpk_lineitem_orders#2286,cval_lineitem_l_quantity#2287,cval_lineitem_l_extendedprice#2288,cval_lineitem_l_discount#2289,cval_lineitem_l_tax#2290,cval_lineitem_l_returnflag#2291,cval_lineitem_l_linestatus#2292,cval_lineitem_l_commitdate#2293,cval_lineitem_l_receiptdate#2294,cval_lineitem_l_shipinstruct#2295,cval_lineitem_l_shipmode#2296,cval_lineitem_l_comment#2297,cval_lineitem_l_shipdate#2298,cdepval_lineitem_l_quantity#2299,cdepval_lineitem_l_extendedprice#2300,cdepval_lineitem_l_discount#2301,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#2737, cpfk_region_nation_4#2738, cfpk_nation_region_4#2739, cval_nation_n_name_4#2740, cval_nation_n_comment_4#2741, cdepval_nation_n_name_4#2742, cdepval_nation_n_comment_4#2743, cn_name_4#2744, cn_comment_4#2745, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
            :  :  +- Project [rid#2728 AS rid_4#2737, cpfk_region_nation#2729 AS cpfk_region_nation_4#2738, cfpk_nation_region#2730 AS cfpk_nation_region_4#2739, cval_nation_n_name#2731 AS cval_nation_n_name_4#2740, cval_nation_n_comment#2732 AS cval_nation_n_comment_4#2741, cdepval_nation_n_name#2733 AS cdepval_nation_n_name_4#2742, cdepval_nation_n_comment#2734 AS cdepval_nation_n_comment_4#2743, cn_name#2735 AS cn_name_4#2744, cn_comment#2736 AS cn_comment_4#2745]
            :  :     +- Relation[rid#2728,cpfk_region_nation#2729,cfpk_nation_region#2730,cval_nation_n_name#2731,cval_nation_n_comment#2732,cdepval_nation_n_name#2733,cdepval_nation_n_comment#2734,cn_name#2735,cn_comment#2736] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#2782 AS rid_3#2800, cpfk_nation_supplier#2783 AS cpfk_nation_supplier_3#2801, cfpk_supplier_nation#2784 AS cfpk_supplier_nation_3#2802, cval_supplier_s_name#2785 AS cval_supplier_s_name_3#2803, cval_supplier_s_address#2786 AS cval_supplier_s_address_3#2804, cval_supplier_s_phone#2787 AS cval_supplier_s_phone_3#2805, cval_supplier_s_acctbal#2788 AS cval_supplier_s_acctbal_3#2806, cval_supplier_s_comment#2789 AS cval_supplier_s_comment_3#2807, cdepval_supplier_s_name#2790 AS cdepval_supplier_s_name_3#2808, cdepval_supplier_s_address#2791 AS cdepval_supplier_s_address_3#2809, cdepval_supplier_s_phone#2792 AS cdepval_supplier_s_phone_3#2810, cdepval_supplier_s_acctbal#2793 AS cdepval_supplier_s_acctbal_3#2811, cdepval_supplier_s_comment#2794 AS cdepval_supplier_s_comment_3#2812, cs_name#2795 AS cs_name_3#2813, cs_address#2796 AS cs_address_3#2814, cs_phone#2797 AS cs_phone_3#2815, cs_acctbal#2798 AS cs_acctbal_3#2816, cs_comment#2799 AS cs_comment_3#2817]
            :        +- Relation[rid#2782,cpfk_nation_supplier#2783,cfpk_supplier_nation#2784,cval_supplier_s_name#2785,cval_supplier_s_address#2786,cval_supplier_s_phone#2787,cval_supplier_s_acctbal#2788,cval_supplier_s_comment#2789,cdepval_supplier_s_name#2790,cdepval_supplier_s_address#2791,cdepval_supplier_s_phone#2792,cdepval_supplier_s_acctbal#2793,cdepval_supplier_s_comment#2794,cs_name#2795,cs_address#2796,cs_phone#2797,cs_acctbal#2798,cs_comment#2799] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'DexPkfkMaterializationAwareJoin orders~lineitem, 'cpfk_orders_lineitem_2, 'rid_1, NotMaterialized, NotMaterialized, [rid_1#2392, cpfk_customer_orders_1#2393, cfpk_orders_customer_1#2394, cval_orders_o_orderstatus_1#2395, cval_orders_o_totalprice_1#2396, cval_orders_o_orderpriority_1#2397, cval_orders_o_clerk_1#2398, cval_orders_o_shippriority_1#2399, cval_orders_o_comment_1#2400, cval_orders_o_orderdate_1#2401, cdepval_orders_o_orderstatus_1#2402, cdepval_orders_o_totalprice_1#2403, cdepval_orders_o_orderpriority_1#2404, cdepval_orders_o_clerk_1#2405, cdepval_orders_o_shippriority_1#2406, cdepval_orders_o_comment_1#2407, cdepval_orders_o_orderdate_1#2408, co_orderstatus_1#2409, co_totalprice_1#2410, co_orderpriority_1#2411, co_clerk_1#2412, co_shippriority_1#2413, co_comment_1#2414, co_orderdate_1#2415, 'rid_2]
               :  :  :- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
               :  :  :  +- Project [rid#2368 AS rid_1#2392, cpfk_customer_orders#2369 AS cpfk_customer_orders_1#2393, cfpk_orders_customer#2370 AS cfpk_orders_customer_1#2394, cval_orders_o_orderstatus#2371 AS cval_orders_o_orderstatus_1#2395, cval_orders_o_totalprice#2372 AS cval_orders_o_totalprice_1#2396, cval_orders_o_orderpriority#2373 AS cval_orders_o_orderpriority_1#2397, cval_orders_o_clerk#2374 AS cval_orders_o_clerk_1#2398, cval_orders_o_shippriority#2375 AS cval_orders_o_shippriority_1#2399, cval_orders_o_comment#2376 AS cval_orders_o_comment_1#2400, cval_orders_o_orderdate#2377 AS cval_orders_o_orderdate_1#2401, cdepval_orders_o_orderstatus#2378 AS cdepval_orders_o_orderstatus_1#2402, cdepval_orders_o_totalprice#2379 AS cdepval_orders_o_totalprice_1#2403, cdepval_orders_o_orderpriority#2380 AS cdepval_orders_o_orderpriority_1#2404, cdepval_orders_o_clerk#2381 AS cdepval_orders_o_clerk_1#2405, cdepval_orders_o_shippriority#2382 AS cdepval_orders_o_shippriority_1#2406, cdepval_orders_o_comment#2383 AS cdepval_orders_o_comment_1#2407, cdepval_orders_o_orderdate#2384 AS cdepval_orders_o_orderdate_1#2408, co_orderstatus#2385 AS co_orderstatus_1#2409, co_totalprice#2386 AS co_totalprice_1#2410, co_orderpriority#2387 AS co_orderpriority_1#2411, co_clerk#2388 AS co_clerk_1#2412, co_shippriority#2389 AS co_shippriority_1#2413, co_comment#2390 AS co_comment_1#2414, co_orderdate#2391 AS co_orderdate_1#2415]
               :  :  :     +- Relation[rid#2368,cpfk_customer_orders#2369,cfpk_orders_customer#2370,cval_orders_o_orderstatus#2371,cval_orders_o_totalprice#2372,cval_orders_o_orderpriority#2373,cval_orders_o_clerk#2374,cval_orders_o_shippriority#2375,cval_orders_o_comment#2376,cval_orders_o_orderdate#2377,cdepval_orders_o_orderstatus#2378,cdepval_orders_o_totalprice#2379,cdepval_orders_o_orderpriority#2380,cdepval_orders_o_clerk#2381,cdepval_orders_o_shippriority#2382,cdepval_orders_o_comment#2383,cdepval_orders_o_orderdate#2384,co_orderstatus#2385,co_totalprice#2386,co_orderpriority#2387,co_clerk#2388,co_shippriority#2389,co_comment#2390,co_orderdate#2391] JDBCRelation(torders) [numPartitions=1]
               :  :  +- 'Project ['cpfk_orders_lineitem_2, 'rid_2]
               :  :     +- Project [rid#2602 AS rid_2#2647, cpfk_orders_lineitem#2603 AS cpfk_orders_lineitem_2#2648, cpfk_supplier_lineitem#2604 AS cpfk_supplier_lineitem_2#2649, cfpk_lineitem_supplier#2605 AS cfpk_lineitem_supplier_2#2650, cfpk_lineitem_partsupp#2606 AS cfpk_lineitem_partsupp_2#2651, cpfk_part_lineitem#2607 AS cpfk_part_lineitem_2#2652, cfpk_lineitem_part#2608 AS cfpk_lineitem_part_2#2653, cpfk_partsupp_lineitem#2609 AS cpfk_partsupp_lineitem_2#2654, cfpk_lineitem_orders#2610 AS cfpk_lineitem_orders_2#2655, cval_lineitem_l_quantity#2611 AS cval_lineitem_l_quantity_2#2656, cval_lineitem_l_extendedprice#2612 AS cval_lineitem_l_extendedprice_2#2657, cval_lineitem_l_discount#2613 AS cval_lineitem_l_discount_2#2658, cval_lineitem_l_tax#2614 AS cval_lineitem_l_tax_2#2659, cval_lineitem_l_returnflag#2615 AS cval_lineitem_l_returnflag_2#2660, cval_lineitem_l_linestatus#2616 AS cval_lineitem_l_linestatus_2#2661, cval_lineitem_l_commitdate#2617 AS cval_lineitem_l_commitdate_2#2662, cval_lineitem_l_receiptdate#2618 AS cval_lineitem_l_receiptdate_2#2663, cval_lineitem_l_shipinstruct#2619 AS cval_lineitem_l_shipinstruct_2#2664, cval_lineitem_l_shipmode#2620 AS cval_lineitem_l_shipmode_2#2665, cval_lineitem_l_comment#2621 AS cval_lineitem_l_comment_2#2666, cval_lineitem_l_shipdate#2622 AS cval_lineitem_l_shipdate_2#2667, cdepval_lineitem_l_quantity#2623 AS cdepval_lineitem_l_quantity_2#2668, cdepval_lineitem_l_extendedprice#2624 AS cdepval_lineitem_l_extendedprice_2#2669, cdepval_lineitem_l_discount#2625 AS cdepval_lineitem_l_discount_2#2670, ... 21 more fields]
               :  :        +- Relation[rid#2602,cpfk_orders_lineitem#2603,cpfk_supplier_lineitem#2604,cfpk_lineitem_supplier#2605,cfpk_lineitem_partsupp#2606,cpfk_part_lineitem#2607,cfpk_lineitem_part#2608,cpfk_partsupp_lineitem#2609,cfpk_lineitem_orders#2610,cval_lineitem_l_quantity#2611,cval_lineitem_l_extendedprice#2612,cval_lineitem_l_discount#2613,cval_lineitem_l_tax#2614,cval_lineitem_l_returnflag#2615,cval_lineitem_l_linestatus#2616,cval_lineitem_l_commitdate#2617,cval_lineitem_l_receiptdate#2618,cval_lineitem_l_shipinstruct#2619,cval_lineitem_l_shipmode#2620,cval_lineitem_l_comment#2621,cval_lineitem_l_shipdate#2622,cdepval_lineitem_l_quantity#2623,cdepval_lineitem_l_extendedprice#2624,cdepval_lineitem_l_discount#2625,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               :  +- Project [rid#2464 AS rid_2#2509, cpfk_orders_lineitem#2465 AS cpfk_orders_lineitem_2#2510, cpfk_supplier_lineitem#2466 AS cpfk_supplier_lineitem_2#2511, cfpk_lineitem_supplier#2467 AS cfpk_lineitem_supplier_2#2512, cfpk_lineitem_partsupp#2468 AS cfpk_lineitem_partsupp_2#2513, cpfk_part_lineitem#2469 AS cpfk_part_lineitem_2#2514, cfpk_lineitem_part#2470 AS cfpk_lineitem_part_2#2515, cpfk_partsupp_lineitem#2471 AS cpfk_partsupp_lineitem_2#2516, cfpk_lineitem_orders#2472 AS cfpk_lineitem_orders_2#2517, cval_lineitem_l_quantity#2473 AS cval_lineitem_l_quantity_2#2518, cval_lineitem_l_extendedprice#2474 AS cval_lineitem_l_extendedprice_2#2519, cval_lineitem_l_discount#2475 AS cval_lineitem_l_discount_2#2520, cval_lineitem_l_tax#2476 AS cval_lineitem_l_tax_2#2521, cval_lineitem_l_returnflag#2477 AS cval_lineitem_l_returnflag_2#2522, cval_lineitem_l_linestatus#2478 AS cval_lineitem_l_linestatus_2#2523, cval_lineitem_l_commitdate#2479 AS cval_lineitem_l_commitdate_2#2524, cval_lineitem_l_receiptdate#2480 AS cval_lineitem_l_receiptdate_2#2525, cval_lineitem_l_shipinstruct#2481 AS cval_lineitem_l_shipinstruct_2#2526, cval_lineitem_l_shipmode#2482 AS cval_lineitem_l_shipmode_2#2527, cval_lineitem_l_comment#2483 AS cval_lineitem_l_comment_2#2528, cval_lineitem_l_shipdate#2484 AS cval_lineitem_l_shipdate_2#2529, cdepval_lineitem_l_quantity#2485 AS cdepval_lineitem_l_quantity_2#2530, cdepval_lineitem_l_extendedprice#2486 AS cdepval_lineitem_l_extendedprice_2#2531, cdepval_lineitem_l_discount#2487 AS cdepval_lineitem_l_discount_2#2532, ... 21 more fields]
               :     +- Relation[rid#2464,cpfk_orders_lineitem#2465,cpfk_supplier_lineitem#2466,cfpk_lineitem_supplier#2467,cfpk_lineitem_partsupp#2468,cpfk_part_lineitem#2469,cfpk_lineitem_part#2470,cpfk_partsupp_lineitem#2471,cfpk_lineitem_orders#2472,cval_lineitem_l_quantity#2473,cval_lineitem_l_extendedprice#2474,cval_lineitem_l_discount#2475,cval_lineitem_l_tax#2476,cval_lineitem_l_returnflag#2477,cval_lineitem_l_linestatus#2478,cval_lineitem_l_commitdate#2479,cval_lineitem_l_receiptdate#2480,cval_lineitem_l_shipinstruct#2481,cval_lineitem_l_shipmode#2482,cval_lineitem_l_comment#2483,cval_lineitem_l_shipdate#2484,cdepval_lineitem_l_quantity#2485,cdepval_lineitem_l_extendedprice#2486,cdepval_lineitem_l_discount#2487,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               +- Project [rid#2692 AS rid_3#2710, cpfk_nation_supplier#2693 AS cpfk_nation_supplier_3#2711, cfpk_supplier_nation#2694 AS cfpk_supplier_nation_3#2712, cval_supplier_s_name#2695 AS cval_supplier_s_name_3#2713, cval_supplier_s_address#2696 AS cval_supplier_s_address_3#2714, cval_supplier_s_phone#2697 AS cval_supplier_s_phone_3#2715, cval_supplier_s_acctbal#2698 AS cval_supplier_s_acctbal_3#2716, cval_supplier_s_comment#2699 AS cval_supplier_s_comment_3#2717, cdepval_supplier_s_name#2700 AS cdepval_supplier_s_name_3#2718, cdepval_supplier_s_address#2701 AS cdepval_supplier_s_address_3#2719, cdepval_supplier_s_phone#2702 AS cdepval_supplier_s_phone_3#2720, cdepval_supplier_s_acctbal#2703 AS cdepval_supplier_s_acctbal_3#2721, cdepval_supplier_s_comment#2704 AS cdepval_supplier_s_comment_3#2722, cs_name#2705 AS cs_name_3#2723, cs_address#2706 AS cs_address_3#2724, cs_phone#2707 AS cs_phone_3#2725, cs_acctbal#2708 AS cs_acctbal_3#2726, cs_comment#2709 AS cs_comment_3#2727]
                  +- Relation[rid#2692,cpfk_nation_supplier#2693,cfpk_supplier_nation#2694,cval_supplier_s_name#2695,cval_supplier_s_address#2696,cval_supplier_s_phone#2697,cval_supplier_s_acctbal#2698,cval_supplier_s_comment#2699,cdepval_supplier_s_name#2700,cdepval_supplier_s_address#2701,cdepval_supplier_s_phone#2702,cdepval_supplier_s_acctbal#2703,cdepval_supplier_s_comment#2704,cs_name#2705,cs_address#2706,cs_phone#2707,cs_acctbal#2708,cs_comment#2709] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 156219ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/26 22:02:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:02:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2964L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:02:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:02:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:02:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:02:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:02:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:02:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:02:02 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:02:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2964L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#2991, cval_part_p_name_0#2992, cval_part_p_mfgr_0#2993, cval_part_p_type_0#2994, cval_part_p_size_0#2995, cval_part_p_container_0#2996, cval_part_p_retailprice_0#2997, cval_part_p_comment_0#2998, cval_part_p_brand_0#2999, cdepval_part_p_name_0#3000, cdepval_part_p_mfgr_0#3001, cdepval_part_p_type_0#3002, cdepval_part_p_size_0#3003, cdepval_part_p_container_0#3004, cdepval_part_p_retailprice_0#3005, cdepval_part_p_comment_0#3006, cdepval_part_p_brand_0#3007, cp_name_0#3008, cp_mfgr_0#3009, cp_type_0#3010, cp_size_0#3011, cp_container_0#3012, cp_retailprice_0#3013, cp_comment_0#3014, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#2966 AS rid_0#2991, cval_part_p_name#2967 AS cval_part_p_name_0#2992, cval_part_p_mfgr#2968 AS cval_part_p_mfgr_0#2993, cval_part_p_type#2969 AS cval_part_p_type_0#2994, cval_part_p_size#2970 AS cval_part_p_size_0#2995, cval_part_p_container#2971 AS cval_part_p_container_0#2996, cval_part_p_retailprice#2972 AS cval_part_p_retailprice_0#2997, cval_part_p_comment#2973 AS cval_part_p_comment_0#2998, cval_part_p_brand#2974 AS cval_part_p_brand_0#2999, cdepval_part_p_name#2975 AS cdepval_part_p_name_0#3000, cdepval_part_p_mfgr#2976 AS cdepval_part_p_mfgr_0#3001, cdepval_part_p_type#2977 AS cdepval_part_p_type_0#3002, cdepval_part_p_size#2978 AS cdepval_part_p_size_0#3003, cdepval_part_p_container#2979 AS cdepval_part_p_container_0#3004, cdepval_part_p_retailprice#2980 AS cdepval_part_p_retailprice_0#3005, cdepval_part_p_comment#2981 AS cdepval_part_p_comment_0#3006, cdepval_part_p_brand#2982 AS cdepval_part_p_brand_0#3007, cp_name#2983 AS cp_name_0#3008, cp_mfgr#2984 AS cp_mfgr_0#3009, cp_type#2985 AS cp_type_0#3010, cp_size#2986 AS cp_size_0#3011, cp_container#2987 AS cp_container_0#3012, cp_retailprice#2988 AS cp_retailprice_0#3013, cp_comment#2989 AS cp_comment_0#3014, cp_brand#2990 AS cp_brand_0#3015]
         :  :        +- Relation[rid#2966,cval_part_p_name#2967,cval_part_p_mfgr#2968,cval_part_p_type#2969,cval_part_p_size#2970,cval_part_p_container#2971,cval_part_p_retailprice#2972,cval_part_p_comment#2973,cval_part_p_brand#2974,cdepval_part_p_name#2975,cdepval_part_p_mfgr#2976,cdepval_part_p_type#2977,cdepval_part_p_size#2978,cdepval_part_p_container#2979,cdepval_part_p_retailprice#2980,cdepval_part_p_comment#2981,cdepval_part_p_brand#2982,cp_name#2983,cp_mfgr#2984,cp_type#2985,cp_size#2986,cp_container#2987,cp_retailprice#2988,cp_comment#2989,cp_brand#2990] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#3436 AS rid_1#3481, cpfk_orders_lineitem#3437 AS cpfk_orders_lineitem_1#3482, cpfk_supplier_lineitem#3438 AS cpfk_supplier_lineitem_1#3483, cfpk_lineitem_supplier#3439 AS cfpk_lineitem_supplier_1#3484, cfpk_lineitem_partsupp#3440 AS cfpk_lineitem_partsupp_1#3485, cpfk_part_lineitem#3441 AS cpfk_part_lineitem_1#3486, cfpk_lineitem_part#3442 AS cfpk_lineitem_part_1#3487, cpfk_partsupp_lineitem#3443 AS cpfk_partsupp_lineitem_1#3488, cfpk_lineitem_orders#3444 AS cfpk_lineitem_orders_1#3489, cval_lineitem_l_quantity#3445 AS cval_lineitem_l_quantity_1#3490, cval_lineitem_l_extendedprice#3446 AS cval_lineitem_l_extendedprice_1#3491, cval_lineitem_l_discount#3447 AS cval_lineitem_l_discount_1#3492, cval_lineitem_l_tax#3448 AS cval_lineitem_l_tax_1#3493, cval_lineitem_l_returnflag#3449 AS cval_lineitem_l_returnflag_1#3494, cval_lineitem_l_linestatus#3450 AS cval_lineitem_l_linestatus_1#3495, cval_lineitem_l_commitdate#3451 AS cval_lineitem_l_commitdate_1#3496, cval_lineitem_l_receiptdate#3452 AS cval_lineitem_l_receiptdate_1#3497, cval_lineitem_l_shipinstruct#3453 AS cval_lineitem_l_shipinstruct_1#3498, cval_lineitem_l_shipmode#3454 AS cval_lineitem_l_shipmode_1#3499, cval_lineitem_l_comment#3455 AS cval_lineitem_l_comment_1#3500, cval_lineitem_l_shipdate#3456 AS cval_lineitem_l_shipdate_1#3501, cdepval_lineitem_l_quantity#3457 AS cdepval_lineitem_l_quantity_1#3502, cdepval_lineitem_l_extendedprice#3458 AS cdepval_lineitem_l_extendedprice_1#3503, cdepval_lineitem_l_discount#3459 AS cdepval_lineitem_l_discount_1#3504, ... 21 more fields]
         :        +- Relation[rid#3436,cpfk_orders_lineitem#3437,cpfk_supplier_lineitem#3438,cfpk_lineitem_supplier#3439,cfpk_lineitem_partsupp#3440,cpfk_part_lineitem#3441,cfpk_lineitem_part#3442,cpfk_partsupp_lineitem#3443,cfpk_lineitem_orders#3444,cval_lineitem_l_quantity#3445,cval_lineitem_l_extendedprice#3446,cval_lineitem_l_discount#3447,cval_lineitem_l_tax#3448,cval_lineitem_l_returnflag#3449,cval_lineitem_l_linestatus#3450,cval_lineitem_l_commitdate#3451,cval_lineitem_l_receiptdate#3452,cval_lineitem_l_shipinstruct#3453,cval_lineitem_l_shipmode#3454,cval_lineitem_l_comment#3455,cval_lineitem_l_shipdate#3456,cdepval_lineitem_l_quantity#3457,cdepval_lineitem_l_extendedprice#3458,cdepval_lineitem_l_discount#3459,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#3116 AS rid_1#3161, cpfk_orders_lineitem#3117 AS cpfk_orders_lineitem_1#3162, cpfk_supplier_lineitem#3118 AS cpfk_supplier_lineitem_1#3163, cfpk_lineitem_supplier#3119 AS cfpk_lineitem_supplier_1#3164, cfpk_lineitem_partsupp#3120 AS cfpk_lineitem_partsupp_1#3165, cpfk_part_lineitem#3121 AS cpfk_part_lineitem_1#3166, cfpk_lineitem_part#3122 AS cfpk_lineitem_part_1#3167, cpfk_partsupp_lineitem#3123 AS cpfk_partsupp_lineitem_1#3168, cfpk_lineitem_orders#3124 AS cfpk_lineitem_orders_1#3169, cval_lineitem_l_quantity#3125 AS cval_lineitem_l_quantity_1#3170, cval_lineitem_l_extendedprice#3126 AS cval_lineitem_l_extendedprice_1#3171, cval_lineitem_l_discount#3127 AS cval_lineitem_l_discount_1#3172, cval_lineitem_l_tax#3128 AS cval_lineitem_l_tax_1#3173, cval_lineitem_l_returnflag#3129 AS cval_lineitem_l_returnflag_1#3174, cval_lineitem_l_linestatus#3130 AS cval_lineitem_l_linestatus_1#3175, cval_lineitem_l_commitdate#3131 AS cval_lineitem_l_commitdate_1#3176, cval_lineitem_l_receiptdate#3132 AS cval_lineitem_l_receiptdate_1#3177, cval_lineitem_l_shipinstruct#3133 AS cval_lineitem_l_shipinstruct_1#3178, cval_lineitem_l_shipmode#3134 AS cval_lineitem_l_shipmode_1#3179, cval_lineitem_l_comment#3135 AS cval_lineitem_l_comment_1#3180, cval_lineitem_l_shipdate#3136 AS cval_lineitem_l_shipdate_1#3181, cdepval_lineitem_l_quantity#3137 AS cdepval_lineitem_l_quantity_1#3182, cdepval_lineitem_l_extendedprice#3138 AS cdepval_lineitem_l_extendedprice_1#3183, cdepval_lineitem_l_discount#3139 AS cdepval_lineitem_l_discount_1#3184, ... 21 more fields]
                  +- Relation[rid#3116,cpfk_orders_lineitem#3117,cpfk_supplier_lineitem#3118,cfpk_lineitem_supplier#3119,cfpk_lineitem_partsupp#3120,cpfk_part_lineitem#3121,cfpk_lineitem_part#3122,cpfk_partsupp_lineitem#3123,cfpk_lineitem_orders#3124,cval_lineitem_l_quantity#3125,cval_lineitem_l_extendedprice#3126,cval_lineitem_l_discount#3127,cval_lineitem_l_tax#3128,cval_lineitem_l_returnflag#3129,cval_lineitem_l_linestatus#3130,cval_lineitem_l_commitdate#3131,cval_lineitem_l_receiptdate#3132,cval_lineitem_l_shipinstruct#3133,cval_lineitem_l_shipmode#3134,cval_lineitem_l_comment#3135,cval_lineitem_l_shipdate#3136,cdepval_lineitem_l_quantity#3137,cdepval_lineitem_l_extendedprice#3138,cdepval_lineitem_l_discount#3139,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 16432ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/26 22:02:19 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:02:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3600L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:02:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3600L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#3602 AS rid_0#3647, cpfk_orders_lineitem#3603 AS cpfk_orders_lineitem_0#3648, cpfk_supplier_lineitem#3604 AS cpfk_supplier_lineitem_0#3649, cfpk_lineitem_supplier#3605 AS cfpk_lineitem_supplier_0#3650, cfpk_lineitem_partsupp#3606 AS cfpk_lineitem_partsupp_0#3651, cpfk_part_lineitem#3607 AS cpfk_part_lineitem_0#3652, cfpk_lineitem_part#3608 AS cfpk_lineitem_part_0#3653, cpfk_partsupp_lineitem#3609 AS cpfk_partsupp_lineitem_0#3654, cfpk_lineitem_orders#3610 AS cfpk_lineitem_orders_0#3655, cval_lineitem_l_quantity#3611 AS cval_lineitem_l_quantity_0#3656, cval_lineitem_l_extendedprice#3612 AS cval_lineitem_l_extendedprice_0#3657, cval_lineitem_l_discount#3613 AS cval_lineitem_l_discount_0#3658, cval_lineitem_l_tax#3614 AS cval_lineitem_l_tax_0#3659, cval_lineitem_l_returnflag#3615 AS cval_lineitem_l_returnflag_0#3660, cval_lineitem_l_linestatus#3616 AS cval_lineitem_l_linestatus_0#3661, cval_lineitem_l_commitdate#3617 AS cval_lineitem_l_commitdate_0#3662, cval_lineitem_l_receiptdate#3618 AS cval_lineitem_l_receiptdate_0#3663, cval_lineitem_l_shipinstruct#3619 AS cval_lineitem_l_shipinstruct_0#3664, cval_lineitem_l_shipmode#3620 AS cval_lineitem_l_shipmode_0#3665, cval_lineitem_l_comment#3621 AS cval_lineitem_l_comment_0#3666, cval_lineitem_l_shipdate#3622 AS cval_lineitem_l_shipdate_0#3667, cdepval_lineitem_l_quantity#3623 AS cdepval_lineitem_l_quantity_0#3668, cdepval_lineitem_l_extendedprice#3624 AS cdepval_lineitem_l_extendedprice_0#3669, cdepval_lineitem_l_discount#3625 AS cdepval_lineitem_l_discount_0#3670, ... 21 more fields]
         :     +- Relation[rid#3602,cpfk_orders_lineitem#3603,cpfk_supplier_lineitem#3604,cfpk_lineitem_supplier#3605,cfpk_lineitem_partsupp#3606,cpfk_part_lineitem#3607,cfpk_lineitem_part#3608,cpfk_partsupp_lineitem#3609,cfpk_lineitem_orders#3610,cval_lineitem_l_quantity#3611,cval_lineitem_l_extendedprice#3612,cval_lineitem_l_discount#3613,cval_lineitem_l_tax#3614,cval_lineitem_l_returnflag#3615,cval_lineitem_l_linestatus#3616,cval_lineitem_l_commitdate#3617,cval_lineitem_l_receiptdate#3618,cval_lineitem_l_shipinstruct#3619,cval_lineitem_l_shipmode#3620,cval_lineitem_l_comment#3621,cval_lineitem_l_shipdate#3622,cdepval_lineitem_l_quantity#3623,cdepval_lineitem_l_extendedprice#3624,cdepval_lineitem_l_discount#3625,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#3782 AS rid_1#3806, cpfk_customer_orders#3783 AS cpfk_customer_orders_1#3807, cfpk_orders_customer#3784 AS cfpk_orders_customer_1#3808, cval_orders_o_orderstatus#3785 AS cval_orders_o_orderstatus_1#3809, cval_orders_o_totalprice#3786 AS cval_orders_o_totalprice_1#3810, cval_orders_o_orderpriority#3787 AS cval_orders_o_orderpriority_1#3811, cval_orders_o_clerk#3788 AS cval_orders_o_clerk_1#3812, cval_orders_o_shippriority#3789 AS cval_orders_o_shippriority_1#3813, cval_orders_o_comment#3790 AS cval_orders_o_comment_1#3814, cval_orders_o_orderdate#3791 AS cval_orders_o_orderdate_1#3815, cdepval_orders_o_orderstatus#3792 AS cdepval_orders_o_orderstatus_1#3816, cdepval_orders_o_totalprice#3793 AS cdepval_orders_o_totalprice_1#3817, cdepval_orders_o_orderpriority#3794 AS cdepval_orders_o_orderpriority_1#3818, cdepval_orders_o_clerk#3795 AS cdepval_orders_o_clerk_1#3819, cdepval_orders_o_shippriority#3796 AS cdepval_orders_o_shippriority_1#3820, cdepval_orders_o_comment#3797 AS cdepval_orders_o_comment_1#3821, cdepval_orders_o_orderdate#3798 AS cdepval_orders_o_orderdate_1#3822, co_orderstatus#3799 AS co_orderstatus_1#3823, co_totalprice#3800 AS co_totalprice_1#3824, co_orderpriority#3801 AS co_orderpriority_1#3825, co_clerk#3802 AS co_clerk_1#3826, co_shippriority#3803 AS co_shippriority_1#3827, co_comment#3804 AS co_comment_1#3828, co_orderdate#3805 AS co_orderdate_1#3829]
            +- Relation[rid#3782,cpfk_customer_orders#3783,cfpk_orders_customer#3784,cval_orders_o_orderstatus#3785,cval_orders_o_totalprice#3786,cval_orders_o_orderpriority#3787,cval_orders_o_clerk#3788,cval_orders_o_shippriority#3789,cval_orders_o_comment#3790,cval_orders_o_orderdate#3791,cdepval_orders_o_orderstatus#3792,cdepval_orders_o_totalprice#3793,cdepval_orders_o_orderpriority#3794,cdepval_orders_o_clerk#3795,cdepval_orders_o_shippriority#3796,cdepval_orders_o_comment#3797,cdepval_orders_o_orderdate#3798,co_orderstatus#3799,co_totalprice#3800,co_orderpriority#3801,co_clerk#3802,co_shippriority#3803,co_comment#3804,co_orderdate#3805] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 21580ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/26 22:02:40 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:02:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3906L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 22:02:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:02:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:02:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:02:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3906L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#3933, cval_part_p_name_0#3934, cval_part_p_mfgr_0#3935, cval_part_p_type_0#3936, cval_part_p_size_0#3937, cval_part_p_container_0#3938, cval_part_p_retailprice_0#3939, cval_part_p_comment_0#3940, cval_part_p_brand_0#3941, cdepval_part_p_name_0#3942, cdepval_part_p_mfgr_0#3943, cdepval_part_p_type_0#3944, cdepval_part_p_size_0#3945, cdepval_part_p_container_0#3946, cdepval_part_p_retailprice_0#3947, cdepval_part_p_comment_0#3948, cdepval_part_p_brand_0#3949, cp_name_0#3950, cp_mfgr_0#3951, cp_type_0#3952, cp_size_0#3953, cp_container_0#3954, cp_retailprice_0#3955, cp_comment_0#3956, ... 2 more fields]
         :  :- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  +- Project [rid#3908 AS rid_0#3933, cval_part_p_name#3909 AS cval_part_p_name_0#3934, cval_part_p_mfgr#3910 AS cval_part_p_mfgr_0#3935, cval_part_p_type#3911 AS cval_part_p_type_0#3936, cval_part_p_size#3912 AS cval_part_p_size_0#3937, cval_part_p_container#3913 AS cval_part_p_container_0#3938, cval_part_p_retailprice#3914 AS cval_part_p_retailprice_0#3939, cval_part_p_comment#3915 AS cval_part_p_comment_0#3940, cval_part_p_brand#3916 AS cval_part_p_brand_0#3941, cdepval_part_p_name#3917 AS cdepval_part_p_name_0#3942, cdepval_part_p_mfgr#3918 AS cdepval_part_p_mfgr_0#3943, cdepval_part_p_type#3919 AS cdepval_part_p_type_0#3944, cdepval_part_p_size#3920 AS cdepval_part_p_size_0#3945, cdepval_part_p_container#3921 AS cdepval_part_p_container_0#3946, cdepval_part_p_retailprice#3922 AS cdepval_part_p_retailprice_0#3947, cdepval_part_p_comment#3923 AS cdepval_part_p_comment_0#3948, cdepval_part_p_brand#3924 AS cdepval_part_p_brand_0#3949, cp_name#3925 AS cp_name_0#3950, cp_mfgr#3926 AS cp_mfgr_0#3951, cp_type#3927 AS cp_type_0#3952, cp_size#3928 AS cp_size_0#3953, cp_container#3929 AS cp_container_0#3954, cp_retailprice#3930 AS cp_retailprice_0#3955, cp_comment#3931 AS cp_comment_0#3956, cp_brand#3932 AS cp_brand_0#3957]
         :  :     +- Relation[rid#3908,cval_part_p_name#3909,cval_part_p_mfgr#3910,cval_part_p_type#3911,cval_part_p_size#3912,cval_part_p_container#3913,cval_part_p_retailprice#3914,cval_part_p_comment#3915,cval_part_p_brand#3916,cdepval_part_p_name#3917,cdepval_part_p_mfgr#3918,cdepval_part_p_type#3919,cdepval_part_p_size#3920,cdepval_part_p_container#3921,cdepval_part_p_retailprice#3922,cdepval_part_p_comment#3923,cdepval_part_p_brand#3924,cp_name#3925,cp_mfgr#3926,cp_type#3927,cp_size#3928,cp_container#3929,cp_retailprice#3930,cp_comment#3931,cp_brand#3932] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :     +- Project [rid#4086 AS rid_1#4100, cpfk_part_partsupp#4087 AS cpfk_part_partsupp_1#4101, cfpk_partsupp_part#4088 AS cfpk_partsupp_part_1#4102, cpfk_supplier_partsupp#4089 AS cpfk_supplier_partsupp_1#4103, cfpk_partsupp_supplier#4090 AS cfpk_partsupp_supplier_1#4104, cval_partsupp_ps_availqty#4091 AS cval_partsupp_ps_availqty_1#4105, cval_partsupp_ps_supplycost#4092 AS cval_partsupp_ps_supplycost_1#4106, cval_partsupp_ps_comment#4093 AS cval_partsupp_ps_comment_1#4107, cdepval_partsupp_ps_availqty#4094 AS cdepval_partsupp_ps_availqty_1#4108, cdepval_partsupp_ps_supplycost#4095 AS cdepval_partsupp_ps_supplycost_1#4109, cdepval_partsupp_ps_comment#4096 AS cdepval_partsupp_ps_comment_1#4110, cps_availqty#4097 AS cps_availqty_1#4111, cps_supplycost#4098 AS cps_supplycost_1#4112, cps_comment#4099 AS cps_comment_1#4113]
         :        +- Relation[rid#4086,cpfk_part_partsupp#4087,cfpk_partsupp_part#4088,cpfk_supplier_partsupp#4089,cfpk_partsupp_supplier#4090,cval_partsupp_ps_availqty#4091,cval_partsupp_ps_supplycost#4092,cval_partsupp_ps_comment#4093,cdepval_partsupp_ps_availqty#4094,cdepval_partsupp_ps_supplycost#4095,cdepval_partsupp_ps_comment#4096,cps_availqty#4097,cps_supplycost#4098,cps_comment#4099] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#4008 AS rid_1#4022, cpfk_part_partsupp#4009 AS cpfk_part_partsupp_1#4023, cfpk_partsupp_part#4010 AS cfpk_partsupp_part_1#4024, cpfk_supplier_partsupp#4011 AS cpfk_supplier_partsupp_1#4025, cfpk_partsupp_supplier#4012 AS cfpk_partsupp_supplier_1#4026, cval_partsupp_ps_availqty#4013 AS cval_partsupp_ps_availqty_1#4027, cval_partsupp_ps_supplycost#4014 AS cval_partsupp_ps_supplycost_1#4028, cval_partsupp_ps_comment#4015 AS cval_partsupp_ps_comment_1#4029, cdepval_partsupp_ps_availqty#4016 AS cdepval_partsupp_ps_availqty_1#4030, cdepval_partsupp_ps_supplycost#4017 AS cdepval_partsupp_ps_supplycost_1#4031, cdepval_partsupp_ps_comment#4018 AS cdepval_partsupp_ps_comment_1#4032, cps_availqty#4019 AS cps_availqty_1#4033, cps_supplycost#4020 AS cps_supplycost_1#4034, cps_comment#4021 AS cps_comment_1#4035]
            +- Relation[rid#4008,cpfk_part_partsupp#4009,cfpk_partsupp_part#4010,cpfk_supplier_partsupp#4011,cfpk_partsupp_supplier#4012,cval_partsupp_ps_availqty#4013,cval_partsupp_ps_supplycost#4014,cval_partsupp_ps_comment#4015,cdepval_partsupp_ps_availqty#4016,cdepval_partsupp_ps_supplycost#4017,cdepval_partsupp_ps_comment#4018,cps_availqty#4019,cps_supplycost#4020,cps_comment#4021] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 700ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 22:02:41 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:02:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4162L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:02:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:02:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:02:41 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:02:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:02:41 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:02:41 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:02:41 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:02:41 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:02:41 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:02:41 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:02:41 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:02:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4162L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#4296 AS rid_4#4341, cpfk_orders_lineitem#4297 AS cpfk_orders_lineitem_4#4342, cpfk_supplier_lineitem#4298 AS cpfk_supplier_lineitem_4#4343, cfpk_lineitem_supplier#4299 AS cfpk_lineitem_supplier_4#4344, cfpk_lineitem_partsupp#4300 AS cfpk_lineitem_partsupp_4#4345, cpfk_part_lineitem#4301 AS cpfk_part_lineitem_4#4346, cfpk_lineitem_part#4302 AS cfpk_lineitem_part_4#4347, cpfk_partsupp_lineitem#4303 AS cpfk_partsupp_lineitem_4#4348, cfpk_lineitem_orders#4304 AS cfpk_lineitem_orders_4#4349, cval_lineitem_l_quantity#4305 AS cval_lineitem_l_quantity_4#4350, cval_lineitem_l_extendedprice#4306 AS cval_lineitem_l_extendedprice_4#4351, cval_lineitem_l_discount#4307 AS cval_lineitem_l_discount_4#4352, cval_lineitem_l_tax#4308 AS cval_lineitem_l_tax_4#4353, cval_lineitem_l_returnflag#4309 AS cval_lineitem_l_returnflag_4#4354, cval_lineitem_l_linestatus#4310 AS cval_lineitem_l_linestatus_4#4355, cval_lineitem_l_commitdate#4311 AS cval_lineitem_l_commitdate_4#4356, cval_lineitem_l_receiptdate#4312 AS cval_lineitem_l_receiptdate_4#4357, cval_lineitem_l_shipinstruct#4313 AS cval_lineitem_l_shipinstruct_4#4358, cval_lineitem_l_shipmode#4314 AS cval_lineitem_l_shipmode_4#4359, cval_lineitem_l_comment#4315 AS cval_lineitem_l_comment_4#4360, cval_lineitem_l_shipdate#4316 AS cval_lineitem_l_shipdate_4#4361, cdepval_lineitem_l_quantity#4317 AS cdepval_lineitem_l_quantity_4#4362, cdepval_lineitem_l_extendedprice#4318 AS cdepval_lineitem_l_extendedprice_4#4363, cdepval_lineitem_l_discount#4319 AS cdepval_lineitem_l_discount_4#4364, ... 21 more fields]
         :  :  +- Relation[rid#4296,cpfk_orders_lineitem#4297,cpfk_supplier_lineitem#4298,cfpk_lineitem_supplier#4299,cfpk_lineitem_partsupp#4300,cpfk_part_lineitem#4301,cfpk_lineitem_part#4302,cpfk_partsupp_lineitem#4303,cfpk_lineitem_orders#4304,cval_lineitem_l_quantity#4305,cval_lineitem_l_extendedprice#4306,cval_lineitem_l_discount#4307,cval_lineitem_l_tax#4308,cval_lineitem_l_returnflag#4309,cval_lineitem_l_linestatus#4310,cval_lineitem_l_commitdate#4311,cval_lineitem_l_receiptdate#4312,cval_lineitem_l_shipinstruct#4313,cval_lineitem_l_shipmode#4314,cval_lineitem_l_comment#4315,cval_lineitem_l_shipdate#4316,cdepval_lineitem_l_quantity#4317,cdepval_lineitem_l_extendedprice#4318,cdepval_lineitem_l_discount#4319,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#4218 AS rid_2#4232, cpfk_part_partsupp#4219 AS cpfk_part_partsupp_2#4233, cfpk_partsupp_part#4220 AS cfpk_partsupp_part_2#4234, cpfk_supplier_partsupp#4221 AS cpfk_supplier_partsupp_2#4235, cfpk_partsupp_supplier#4222 AS cfpk_partsupp_supplier_2#4236, cval_partsupp_ps_availqty#4223 AS cval_partsupp_ps_availqty_2#4237, cval_partsupp_ps_supplycost#4224 AS cval_partsupp_ps_supplycost_2#4238, cval_partsupp_ps_comment#4225 AS cval_partsupp_ps_comment_2#4239, cdepval_partsupp_ps_availqty#4226 AS cdepval_partsupp_ps_availqty_2#4240, cdepval_partsupp_ps_supplycost#4227 AS cdepval_partsupp_ps_supplycost_2#4241, cdepval_partsupp_ps_comment#4228 AS cdepval_partsupp_ps_comment_2#4242, cps_availqty#4229 AS cps_availqty_2#4243, cps_supplycost#4230 AS cps_supplycost_2#4244, cps_comment#4231 AS cps_comment_2#4245]
         :     :  :  +- Relation[rid#4218,cpfk_part_partsupp#4219,cfpk_partsupp_part#4220,cpfk_supplier_partsupp#4221,cfpk_partsupp_supplier#4222,cval_partsupp_ps_availqty#4223,cval_partsupp_ps_supplycost#4224,cval_partsupp_ps_comment#4225,cdepval_partsupp_ps_availqty#4226,cdepval_partsupp_ps_supplycost#4227,cdepval_partsupp_ps_comment#4228,cps_availqty#4229,cps_supplycost#4230,cps_comment#4231] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#4182 AS rid_1#4200, cpfk_nation_supplier#4183 AS cpfk_nation_supplier_1#4201, cfpk_supplier_nation#4184 AS cfpk_supplier_nation_1#4202, cval_supplier_s_name#4185 AS cval_supplier_s_name_1#4203, cval_supplier_s_address#4186 AS cval_supplier_s_address_1#4204, cval_supplier_s_phone#4187 AS cval_supplier_s_phone_1#4205, cval_supplier_s_acctbal#4188 AS cval_supplier_s_acctbal_1#4206, cval_supplier_s_comment#4189 AS cval_supplier_s_comment_1#4207, cdepval_supplier_s_name#4190 AS cdepval_supplier_s_name_1#4208, cdepval_supplier_s_address#4191 AS cdepval_supplier_s_address_1#4209, cdepval_supplier_s_phone#4192 AS cdepval_supplier_s_phone_1#4210, cdepval_supplier_s_acctbal#4193 AS cdepval_supplier_s_acctbal_1#4211, cdepval_supplier_s_comment#4194 AS cdepval_supplier_s_comment_1#4212, cs_name#4195 AS cs_name_1#4213, cs_address#4196 AS cs_address_1#4214, cs_phone#4197 AS cs_phone_1#4215, cs_acctbal#4198 AS cs_acctbal_1#4216, cs_comment#4199 AS cs_comment_1#4217]
         :     :     :  +- Relation[rid#4182,cpfk_nation_supplier#4183,cfpk_supplier_nation#4184,cval_supplier_s_name#4185,cval_supplier_s_address#4186,cval_supplier_s_phone#4187,cval_supplier_s_acctbal#4188,cval_supplier_s_comment#4189,cdepval_supplier_s_name#4190,cdepval_supplier_s_address#4191,cdepval_supplier_s_phone#4192,cdepval_supplier_s_acctbal#4193,cdepval_supplier_s_comment#4194,cs_name#4195,cs_address#4196,cs_phone#4197,cs_acctbal#4198,cs_comment#4199] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#4164 AS rid_0#4173, cpfk_region_nation#4165 AS cpfk_region_nation_0#4174, cfpk_nation_region#4166 AS cfpk_nation_region_0#4175, cval_nation_n_name#4167 AS cval_nation_n_name_0#4176, cval_nation_n_comment#4168 AS cval_nation_n_comment_0#4177, cdepval_nation_n_name#4169 AS cdepval_nation_n_name_0#4178, cdepval_nation_n_comment#4170 AS cdepval_nation_n_comment_0#4179, cn_name#4171 AS cn_name_0#4180, cn_comment#4172 AS cn_comment_0#4181]
         :     :        +- Relation[rid#4164,cpfk_region_nation#4165,cfpk_nation_region#4166,cval_nation_n_name#4167,cval_nation_n_comment#4168,cdepval_nation_n_name#4169,cdepval_nation_n_comment#4170,cn_name#4171,cn_comment#4172] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#4246 AS rid_3#4271, cval_part_p_name#4247 AS cval_part_p_name_3#4272, cval_part_p_mfgr#4248 AS cval_part_p_mfgr_3#4273, cval_part_p_type#4249 AS cval_part_p_type_3#4274, cval_part_p_size#4250 AS cval_part_p_size_3#4275, cval_part_p_container#4251 AS cval_part_p_container_3#4276, cval_part_p_retailprice#4252 AS cval_part_p_retailprice_3#4277, cval_part_p_comment#4253 AS cval_part_p_comment_3#4278, cval_part_p_brand#4254 AS cval_part_p_brand_3#4279, cdepval_part_p_name#4255 AS cdepval_part_p_name_3#4280, cdepval_part_p_mfgr#4256 AS cdepval_part_p_mfgr_3#4281, cdepval_part_p_type#4257 AS cdepval_part_p_type_3#4282, cdepval_part_p_size#4258 AS cdepval_part_p_size_3#4283, cdepval_part_p_container#4259 AS cdepval_part_p_container_3#4284, cdepval_part_p_retailprice#4260 AS cdepval_part_p_retailprice_3#4285, cdepval_part_p_comment#4261 AS cdepval_part_p_comment_3#4286, cdepval_part_p_brand#4262 AS cdepval_part_p_brand_3#4287, cp_name#4263 AS cp_name_3#4288, cp_mfgr#4264 AS cp_mfgr_3#4289, cp_type#4265 AS cp_type_3#4290, cp_size#4266 AS cp_size_3#4291, cp_container#4267 AS cp_container_3#4292, cp_retailprice#4268 AS cp_retailprice_3#4293, cp_comment#4269 AS cp_comment_3#4294, cp_brand#4270 AS cp_brand_3#4295]
         :        +- Relation[rid#4246,cval_part_p_name#4247,cval_part_p_mfgr#4248,cval_part_p_type#4249,cval_part_p_size#4250,cval_part_p_container#4251,cval_part_p_retailprice#4252,cval_part_p_comment#4253,cval_part_p_brand#4254,cdepval_part_p_name#4255,cdepval_part_p_mfgr#4256,cdepval_part_p_type#4257,cdepval_part_p_size#4258,cdepval_part_p_container#4259,cdepval_part_p_retailprice#4260,cdepval_part_p_comment#4261,cdepval_part_p_brand#4262,cp_name#4263,cp_mfgr#4264,cp_type#4265,cp_size#4266,cp_container#4267,cp_retailprice#4268,cp_comment#4269,cp_brand#4270] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#4386 AS rid_5#4410, cpfk_customer_orders#4387 AS cpfk_customer_orders_5#4411, cfpk_orders_customer#4388 AS cfpk_orders_customer_5#4412, cval_orders_o_orderstatus#4389 AS cval_orders_o_orderstatus_5#4413, cval_orders_o_totalprice#4390 AS cval_orders_o_totalprice_5#4414, cval_orders_o_orderpriority#4391 AS cval_orders_o_orderpriority_5#4415, cval_orders_o_clerk#4392 AS cval_orders_o_clerk_5#4416, cval_orders_o_shippriority#4393 AS cval_orders_o_shippriority_5#4417, cval_orders_o_comment#4394 AS cval_orders_o_comment_5#4418, cval_orders_o_orderdate#4395 AS cval_orders_o_orderdate_5#4419, cdepval_orders_o_orderstatus#4396 AS cdepval_orders_o_orderstatus_5#4420, cdepval_orders_o_totalprice#4397 AS cdepval_orders_o_totalprice_5#4421, cdepval_orders_o_orderpriority#4398 AS cdepval_orders_o_orderpriority_5#4422, cdepval_orders_o_clerk#4399 AS cdepval_orders_o_clerk_5#4423, cdepval_orders_o_shippriority#4400 AS cdepval_orders_o_shippriority_5#4424, cdepval_orders_o_comment#4401 AS cdepval_orders_o_comment_5#4425, cdepval_orders_o_orderdate#4402 AS cdepval_orders_o_orderdate_5#4426, co_orderstatus#4403 AS co_orderstatus_5#4427, co_totalprice#4404 AS co_totalprice_5#4428, co_orderpriority#4405 AS co_orderpriority_5#4429, co_clerk#4406 AS co_clerk_5#4430, co_shippriority#4407 AS co_shippriority_5#4431, co_comment#4408 AS co_comment_5#4432, co_orderdate#4409 AS co_orderdate_5#4433]
            +- Relation[rid#4386,cpfk_customer_orders#4387,cfpk_orders_customer#4388,cval_orders_o_orderstatus#4389,cval_orders_o_totalprice#4390,cval_orders_o_orderpriority#4391,cval_orders_o_clerk#4392,cval_orders_o_shippriority#4393,cval_orders_o_comment#4394,cval_orders_o_orderdate#4395,cdepval_orders_o_orderstatus#4396,cdepval_orders_o_totalprice#4397,cdepval_orders_o_orderpriority#4398,cdepval_orders_o_clerk#4399,cdepval_orders_o_shippriority#4400,cdepval_orders_o_comment#4401,cdepval_orders_o_orderdate#4402,co_orderstatus#4403,co_totalprice#4404,co_orderpriority#4405,co_clerk#4406,co_shippriority#4407,co_comment#4408,co_orderdate#4409] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 37396ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/26 22:03:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:03:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4597L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:03:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4597L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#4599 AS rid_0#4644, cpfk_orders_lineitem#4600 AS cpfk_orders_lineitem_0#4645, cpfk_supplier_lineitem#4601 AS cpfk_supplier_lineitem_0#4646, cfpk_lineitem_supplier#4602 AS cfpk_lineitem_supplier_0#4647, cfpk_lineitem_partsupp#4603 AS cfpk_lineitem_partsupp_0#4648, cpfk_part_lineitem#4604 AS cpfk_part_lineitem_0#4649, cfpk_lineitem_part#4605 AS cfpk_lineitem_part_0#4650, cpfk_partsupp_lineitem#4606 AS cpfk_partsupp_lineitem_0#4651, cfpk_lineitem_orders#4607 AS cfpk_lineitem_orders_0#4652, cval_lineitem_l_quantity#4608 AS cval_lineitem_l_quantity_0#4653, cval_lineitem_l_extendedprice#4609 AS cval_lineitem_l_extendedprice_0#4654, cval_lineitem_l_discount#4610 AS cval_lineitem_l_discount_0#4655, cval_lineitem_l_tax#4611 AS cval_lineitem_l_tax_0#4656, cval_lineitem_l_returnflag#4612 AS cval_lineitem_l_returnflag_0#4657, cval_lineitem_l_linestatus#4613 AS cval_lineitem_l_linestatus_0#4658, cval_lineitem_l_commitdate#4614 AS cval_lineitem_l_commitdate_0#4659, cval_lineitem_l_receiptdate#4615 AS cval_lineitem_l_receiptdate_0#4660, cval_lineitem_l_shipinstruct#4616 AS cval_lineitem_l_shipinstruct_0#4661, cval_lineitem_l_shipmode#4617 AS cval_lineitem_l_shipmode_0#4662, cval_lineitem_l_comment#4618 AS cval_lineitem_l_comment_0#4663, cval_lineitem_l_shipdate#4619 AS cval_lineitem_l_shipdate_0#4664, cdepval_lineitem_l_quantity#4620 AS cdepval_lineitem_l_quantity_0#4665, cdepval_lineitem_l_extendedprice#4621 AS cdepval_lineitem_l_extendedprice_0#4666, cdepval_lineitem_l_discount#4622 AS cdepval_lineitem_l_discount_0#4667, ... 21 more fields]
         :  +- Relation[rid#4599,cpfk_orders_lineitem#4600,cpfk_supplier_lineitem#4601,cfpk_lineitem_supplier#4602,cfpk_lineitem_partsupp#4603,cpfk_part_lineitem#4604,cfpk_lineitem_part#4605,cpfk_partsupp_lineitem#4606,cfpk_lineitem_orders#4607,cval_lineitem_l_quantity#4608,cval_lineitem_l_extendedprice#4609,cval_lineitem_l_discount#4610,cval_lineitem_l_tax#4611,cval_lineitem_l_returnflag#4612,cval_lineitem_l_linestatus#4613,cval_lineitem_l_commitdate#4614,cval_lineitem_l_receiptdate#4615,cval_lineitem_l_shipinstruct#4616,cval_lineitem_l_shipmode#4617,cval_lineitem_l_comment#4618,cval_lineitem_l_shipdate#4619,cdepval_lineitem_l_quantity#4620,cdepval_lineitem_l_extendedprice#4621,cdepval_lineitem_l_discount#4622,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4689 AS rid_1#4713, cpfk_customer_orders#4690 AS cpfk_customer_orders_1#4714, cfpk_orders_customer#4691 AS cfpk_orders_customer_1#4715, cval_orders_o_orderstatus#4692 AS cval_orders_o_orderstatus_1#4716, cval_orders_o_totalprice#4693 AS cval_orders_o_totalprice_1#4717, cval_orders_o_orderpriority#4694 AS cval_orders_o_orderpriority_1#4718, cval_orders_o_clerk#4695 AS cval_orders_o_clerk_1#4719, cval_orders_o_shippriority#4696 AS cval_orders_o_shippriority_1#4720, cval_orders_o_comment#4697 AS cval_orders_o_comment_1#4721, cval_orders_o_orderdate#4698 AS cval_orders_o_orderdate_1#4722, cdepval_orders_o_orderstatus#4699 AS cdepval_orders_o_orderstatus_1#4723, cdepval_orders_o_totalprice#4700 AS cdepval_orders_o_totalprice_1#4724, cdepval_orders_o_orderpriority#4701 AS cdepval_orders_o_orderpriority_1#4725, cdepval_orders_o_clerk#4702 AS cdepval_orders_o_clerk_1#4726, cdepval_orders_o_shippriority#4703 AS cdepval_orders_o_shippriority_1#4727, cdepval_orders_o_comment#4704 AS cdepval_orders_o_comment_1#4728, cdepval_orders_o_orderdate#4705 AS cdepval_orders_o_orderdate_1#4729, co_orderstatus#4706 AS co_orderstatus_1#4730, co_totalprice#4707 AS co_totalprice_1#4731, co_orderpriority#4708 AS co_orderpriority_1#4732, co_clerk#4709 AS co_clerk_1#4733, co_shippriority#4710 AS co_shippriority_1#4734, co_comment#4711 AS co_comment_1#4735, co_orderdate#4712 AS co_orderdate_1#4736]
            +- Relation[rid#4689,cpfk_customer_orders#4690,cfpk_orders_customer#4691,cval_orders_o_orderstatus#4692,cval_orders_o_totalprice#4693,cval_orders_o_orderpriority#4694,cval_orders_o_clerk#4695,cval_orders_o_shippriority#4696,cval_orders_o_comment#4697,cval_orders_o_orderdate#4698,cdepval_orders_o_orderstatus#4699,cdepval_orders_o_totalprice#4700,cdepval_orders_o_orderpriority#4701,cdepval_orders_o_clerk#4702,cdepval_orders_o_shippriority#4703,cdepval_orders_o_comment#4704,cdepval_orders_o_orderdate#4705,co_orderstatus#4706,co_totalprice#4707,co_orderpriority#4708,co_clerk#4709,co_shippriority#4710,co_comment#4711,co_orderdate#4712] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18350ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/26 22:03:37 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:03:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4814L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:03:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:03:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:03:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:03:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:03:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:03:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:03:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:03:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:03:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:03:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:03:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:03:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:03:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:03:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:03:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4814L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#4942 AS rid_2#4987, cpfk_orders_lineitem#4943 AS cpfk_orders_lineitem_2#4988, cpfk_supplier_lineitem#4944 AS cpfk_supplier_lineitem_2#4989, cfpk_lineitem_supplier#4945 AS cfpk_lineitem_supplier_2#4990, cfpk_lineitem_partsupp#4946 AS cfpk_lineitem_partsupp_2#4991, cpfk_part_lineitem#4947 AS cpfk_part_lineitem_2#4992, cfpk_lineitem_part#4948 AS cfpk_lineitem_part_2#4993, cpfk_partsupp_lineitem#4949 AS cpfk_partsupp_lineitem_2#4994, cfpk_lineitem_orders#4950 AS cfpk_lineitem_orders_2#4995, cval_lineitem_l_quantity#4951 AS cval_lineitem_l_quantity_2#4996, cval_lineitem_l_extendedprice#4952 AS cval_lineitem_l_extendedprice_2#4997, cval_lineitem_l_discount#4953 AS cval_lineitem_l_discount_2#4998, cval_lineitem_l_tax#4954 AS cval_lineitem_l_tax_2#4999, cval_lineitem_l_returnflag#4955 AS cval_lineitem_l_returnflag_2#5000, cval_lineitem_l_linestatus#4956 AS cval_lineitem_l_linestatus_2#5001, cval_lineitem_l_commitdate#4957 AS cval_lineitem_l_commitdate_2#5002, cval_lineitem_l_receiptdate#4958 AS cval_lineitem_l_receiptdate_2#5003, cval_lineitem_l_shipinstruct#4959 AS cval_lineitem_l_shipinstruct_2#5004, cval_lineitem_l_shipmode#4960 AS cval_lineitem_l_shipmode_2#5005, cval_lineitem_l_comment#4961 AS cval_lineitem_l_comment_2#5006, cval_lineitem_l_shipdate#4962 AS cval_lineitem_l_shipdate_2#5007, cdepval_lineitem_l_quantity#4963 AS cdepval_lineitem_l_quantity_2#5008, cdepval_lineitem_l_extendedprice#4964 AS cdepval_lineitem_l_extendedprice_2#5009, cdepval_lineitem_l_discount#4965 AS cdepval_lineitem_l_discount_2#5010, ... 21 more fields]
         :  :  +- Relation[rid#4942,cpfk_orders_lineitem#4943,cpfk_supplier_lineitem#4944,cfpk_lineitem_supplier#4945,cfpk_lineitem_partsupp#4946,cpfk_part_lineitem#4947,cfpk_lineitem_part#4948,cpfk_partsupp_lineitem#4949,cfpk_lineitem_orders#4950,cval_lineitem_l_quantity#4951,cval_lineitem_l_extendedprice#4952,cval_lineitem_l_discount#4953,cval_lineitem_l_tax#4954,cval_lineitem_l_returnflag#4955,cval_lineitem_l_linestatus#4956,cval_lineitem_l_commitdate#4957,cval_lineitem_l_receiptdate#4958,cval_lineitem_l_shipinstruct#4959,cval_lineitem_l_shipmode#4960,cval_lineitem_l_comment#4961,cval_lineitem_l_shipdate#4962,cdepval_lineitem_l_quantity#4963,cdepval_lineitem_l_extendedprice#4964,cdepval_lineitem_l_discount#4965,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join UsingJoin(Inner,List(rid_1))
         :     :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#4825, cpfk_region_nation_0#4826, cfpk_nation_region_0#4827, cval_nation_n_name_0#4828, cval_nation_n_comment_0#4829, cdepval_nation_n_name_0#4830, cdepval_nation_n_comment_0#4831, cn_name_0#4832, cn_comment_0#4833, 'rid_1]
         :     :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :     :  :  +- Project [rid#4816 AS rid_0#4825, cpfk_region_nation#4817 AS cpfk_region_nation_0#4826, cfpk_nation_region#4818 AS cfpk_nation_region_0#4827, cval_nation_n_name#4819 AS cval_nation_n_name_0#4828, cval_nation_n_comment#4820 AS cval_nation_n_comment_0#4829, cdepval_nation_n_name#4821 AS cdepval_nation_n_name_0#4830, cdepval_nation_n_comment#4822 AS cdepval_nation_n_comment_0#4831, cn_name#4823 AS cn_name_0#4832, cn_comment#4824 AS cn_comment_0#4833]
         :     :  :     +- Relation[rid#4816,cpfk_region_nation#4817,cfpk_nation_region#4818,cval_nation_n_name#4819,cval_nation_n_comment#4820,cdepval_nation_n_name#4821,cdepval_nation_n_comment#4822,cn_name#4823,cn_comment#4824] JDBCRelation(tnation) [numPartitions=1]
         :     :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
         :     :     +- Project [rid#4906 AS rid_1#4924, cpfk_nation_supplier#4907 AS cpfk_nation_supplier_1#4925, cfpk_supplier_nation#4908 AS cfpk_supplier_nation_1#4926, cval_supplier_s_name#4909 AS cval_supplier_s_name_1#4927, cval_supplier_s_address#4910 AS cval_supplier_s_address_1#4928, cval_supplier_s_phone#4911 AS cval_supplier_s_phone_1#4929, cval_supplier_s_acctbal#4912 AS cval_supplier_s_acctbal_1#4930, cval_supplier_s_comment#4913 AS cval_supplier_s_comment_1#4931, cdepval_supplier_s_name#4914 AS cdepval_supplier_s_name_1#4932, cdepval_supplier_s_address#4915 AS cdepval_supplier_s_address_1#4933, cdepval_supplier_s_phone#4916 AS cdepval_supplier_s_phone_1#4934, cdepval_supplier_s_acctbal#4917 AS cdepval_supplier_s_acctbal_1#4935, cdepval_supplier_s_comment#4918 AS cdepval_supplier_s_comment_1#4936, cs_name#4919 AS cs_name_1#4937, cs_address#4920 AS cs_address_1#4938, cs_phone#4921 AS cs_phone_1#4939, cs_acctbal#4922 AS cs_acctbal_1#4940, cs_comment#4923 AS cs_comment_1#4941]
         :     :        +- Relation[rid#4906,cpfk_nation_supplier#4907,cfpk_supplier_nation#4908,cval_supplier_s_name#4909,cval_supplier_s_address#4910,cval_supplier_s_phone#4911,cval_supplier_s_acctbal#4912,cval_supplier_s_comment#4913,cdepval_supplier_s_name#4914,cdepval_supplier_s_address#4915,cdepval_supplier_s_phone#4916,cdepval_supplier_s_acctbal#4917,cdepval_supplier_s_comment#4918,cs_name#4919,cs_address#4920,cs_phone#4921,cs_acctbal#4922,cs_comment#4923] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#4852 AS rid_1#4870, cpfk_nation_supplier#4853 AS cpfk_nation_supplier_1#4871, cfpk_supplier_nation#4854 AS cfpk_supplier_nation_1#4872, cval_supplier_s_name#4855 AS cval_supplier_s_name_1#4873, cval_supplier_s_address#4856 AS cval_supplier_s_address_1#4874, cval_supplier_s_phone#4857 AS cval_supplier_s_phone_1#4875, cval_supplier_s_acctbal#4858 AS cval_supplier_s_acctbal_1#4876, cval_supplier_s_comment#4859 AS cval_supplier_s_comment_1#4877, cdepval_supplier_s_name#4860 AS cdepval_supplier_s_name_1#4878, cdepval_supplier_s_address#4861 AS cdepval_supplier_s_address_1#4879, cdepval_supplier_s_phone#4862 AS cdepval_supplier_s_phone_1#4880, cdepval_supplier_s_acctbal#4863 AS cdepval_supplier_s_acctbal_1#4881, cdepval_supplier_s_comment#4864 AS cdepval_supplier_s_comment_1#4882, cs_name#4865 AS cs_name_1#4883, cs_address#4866 AS cs_address_1#4884, cs_phone#4867 AS cs_phone_1#4885, cs_acctbal#4868 AS cs_acctbal_1#4886, cs_comment#4869 AS cs_comment_1#4887]
         :        +- Relation[rid#4852,cpfk_nation_supplier#4853,cfpk_supplier_nation#4854,cval_supplier_s_name#4855,cval_supplier_s_address#4856,cval_supplier_s_phone#4857,cval_supplier_s_acctbal#4858,cval_supplier_s_comment#4859,cdepval_supplier_s_name#4860,cdepval_supplier_s_address#4861,cdepval_supplier_s_phone#4862,cdepval_supplier_s_acctbal#4863,cdepval_supplier_s_comment#4864,cs_name#4865,cs_address#4866,cs_phone#4867,cs_acctbal#4868,cs_comment#4869] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#5170 AS rid_5#5194, cpfk_customer_orders#5171 AS cpfk_customer_orders_5#5195, cfpk_orders_customer#5172 AS cfpk_orders_customer_5#5196, cval_orders_o_orderstatus#5173 AS cval_orders_o_orderstatus_5#5197, cval_orders_o_totalprice#5174 AS cval_orders_o_totalprice_5#5198, cval_orders_o_orderpriority#5175 AS cval_orders_o_orderpriority_5#5199, cval_orders_o_clerk#5176 AS cval_orders_o_clerk_5#5200, cval_orders_o_shippriority#5177 AS cval_orders_o_shippriority_5#5201, cval_orders_o_comment#5178 AS cval_orders_o_comment_5#5202, cval_orders_o_orderdate#5179 AS cval_orders_o_orderdate_5#5203, cdepval_orders_o_orderstatus#5180 AS cdepval_orders_o_orderstatus_5#5204, cdepval_orders_o_totalprice#5181 AS cdepval_orders_o_totalprice_5#5205, cdepval_orders_o_orderpriority#5182 AS cdepval_orders_o_orderpriority_5#5206, cdepval_orders_o_clerk#5183 AS cdepval_orders_o_clerk_5#5207, cdepval_orders_o_shippriority#5184 AS cdepval_orders_o_shippriority_5#5208, cdepval_orders_o_comment#5185 AS cdepval_orders_o_comment_5#5209, cdepval_orders_o_orderdate#5186 AS cdepval_orders_o_orderdate_5#5210, co_orderstatus#5187 AS co_orderstatus_5#5211, co_totalprice#5188 AS co_totalprice_5#5212, co_orderpriority#5189 AS co_orderpriority_5#5213, co_clerk#5190 AS co_clerk_5#5214, co_shippriority#5191 AS co_shippriority_5#5215, co_comment#5192 AS co_comment_5#5216, co_orderdate#5193 AS co_orderdate_5#5217]
            :  +- Relation[rid#5170,cpfk_customer_orders#5171,cfpk_orders_customer#5172,cval_orders_o_orderstatus#5173,cval_orders_o_totalprice#5174,cval_orders_o_orderpriority#5175,cval_orders_o_clerk#5176,cval_orders_o_shippriority#5177,cval_orders_o_comment#5178,cval_orders_o_orderdate#5179,cdepval_orders_o_orderstatus#5180,cdepval_orders_o_totalprice#5181,cdepval_orders_o_orderpriority#5182,cdepval_orders_o_clerk#5183,cdepval_orders_o_shippriority#5184,cdepval_orders_o_comment#5185,cdepval_orders_o_orderdate#5186,co_orderstatus#5187,co_totalprice#5188,co_orderpriority#5189,co_clerk#5190,co_shippriority#5191,co_comment#5192,co_orderdate#5193] JDBCRelation(torders) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_4))
               :- 'DexPkfkMaterializationAwareJoin nation~customer, 'cpfk_nation_customer_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#5041, cpfk_region_nation_3#5042, cfpk_nation_region_3#5043, cval_nation_n_name_3#5044, cval_nation_n_comment_3#5045, cdepval_nation_n_name_3#5046, cdepval_nation_n_comment_3#5047, cn_name_3#5048, cn_comment_3#5049, 'rid_4]
               :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
               :  :  +- Project [rid#5032 AS rid_3#5041, cpfk_region_nation#5033 AS cpfk_region_nation_3#5042, cfpk_nation_region#5034 AS cfpk_nation_region_3#5043, cval_nation_n_name#5035 AS cval_nation_n_name_3#5044, cval_nation_n_comment#5036 AS cval_nation_n_comment_3#5045, cdepval_nation_n_name#5037 AS cdepval_nation_n_name_3#5046, cdepval_nation_n_comment#5038 AS cdepval_nation_n_comment_3#5047, cn_name#5039 AS cn_name_3#5048, cn_comment#5040 AS cn_comment_3#5049]
               :  :     +- Relation[rid#5032,cpfk_region_nation#5033,cfpk_nation_region#5034,cval_nation_n_name#5035,cval_nation_n_comment#5036,cdepval_nation_n_name#5037,cdepval_nation_n_comment#5038,cn_name#5039,cn_comment#5040] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'Project ['cpfk_nation_customer_4, 'rid_4]
               :     +- Project [rid#5128 AS rid_4#5149, cpfk_nation_customer#5129 AS cpfk_nation_customer_4#5150, cfpk_customer_nation#5130 AS cfpk_customer_nation_4#5151, cval_customer_c_name#5131 AS cval_customer_c_name_4#5152, cval_customer_c_address#5132 AS cval_customer_c_address_4#5153, cval_customer_c_phone#5133 AS cval_customer_c_phone_4#5154, cval_customer_c_acctbal#5134 AS cval_customer_c_acctbal_4#5155, cval_customer_c_comment#5135 AS cval_customer_c_comment_4#5156, cval_customer_c_mktsegment#5136 AS cval_customer_c_mktsegment_4#5157, cdepval_customer_c_name#5137 AS cdepval_customer_c_name_4#5158, cdepval_customer_c_address#5138 AS cdepval_customer_c_address_4#5159, cdepval_customer_c_phone#5139 AS cdepval_customer_c_phone_4#5160, cdepval_customer_c_acctbal#5140 AS cdepval_customer_c_acctbal_4#5161, cdepval_customer_c_comment#5141 AS cdepval_customer_c_comment_4#5162, cdepval_customer_c_mktsegment#5142 AS cdepval_customer_c_mktsegment_4#5163, cc_name#5143 AS cc_name_4#5164, cc_address#5144 AS cc_address_4#5165, cc_phone#5145 AS cc_phone_4#5166, cc_acctbal#5146 AS cc_acctbal_4#5167, cc_comment#5147 AS cc_comment_4#5168, cc_mktsegment#5148 AS cc_mktsegment_4#5169]
               :        +- Relation[rid#5128,cpfk_nation_customer#5129,cfpk_customer_nation#5130,cval_customer_c_name#5131,cval_customer_c_address#5132,cval_customer_c_phone#5133,cval_customer_c_acctbal#5134,cval_customer_c_comment#5135,cval_customer_c_mktsegment#5136,cdepval_customer_c_name#5137,cdepval_customer_c_address#5138,cdepval_customer_c_phone#5139,cdepval_customer_c_acctbal#5140,cdepval_customer_c_comment#5141,cdepval_customer_c_mktsegment#5142,cc_name#5143,cc_address#5144,cc_phone#5145,cc_acctbal#5146,cc_comment#5147,cc_mktsegment#5148] JDBCRelation(tcustomer) [numPartitions=1]
               +- Project [rid#5068 AS rid_4#5089, cpfk_nation_customer#5069 AS cpfk_nation_customer_4#5090, cfpk_customer_nation#5070 AS cfpk_customer_nation_4#5091, cval_customer_c_name#5071 AS cval_customer_c_name_4#5092, cval_customer_c_address#5072 AS cval_customer_c_address_4#5093, cval_customer_c_phone#5073 AS cval_customer_c_phone_4#5094, cval_customer_c_acctbal#5074 AS cval_customer_c_acctbal_4#5095, cval_customer_c_comment#5075 AS cval_customer_c_comment_4#5096, cval_customer_c_mktsegment#5076 AS cval_customer_c_mktsegment_4#5097, cdepval_customer_c_name#5077 AS cdepval_customer_c_name_4#5098, cdepval_customer_c_address#5078 AS cdepval_customer_c_address_4#5099, cdepval_customer_c_phone#5079 AS cdepval_customer_c_phone_4#5100, cdepval_customer_c_acctbal#5080 AS cdepval_customer_c_acctbal_4#5101, cdepval_customer_c_comment#5081 AS cdepval_customer_c_comment_4#5102, cdepval_customer_c_mktsegment#5082 AS cdepval_customer_c_mktsegment_4#5103, cc_name#5083 AS cc_name_4#5104, cc_address#5084 AS cc_address_4#5105, cc_phone#5085 AS cc_phone_4#5106, cc_acctbal#5086 AS cc_acctbal_4#5107, cc_comment#5087 AS cc_comment_4#5108, cc_mktsegment#5088 AS cc_mktsegment_4#5109]
                  +- Relation[rid#5068,cpfk_nation_customer#5069,cfpk_customer_nation#5070,cval_customer_c_name#5071,cval_customer_c_address#5072,cval_customer_c_phone#5073,cval_customer_c_acctbal#5074,cval_customer_c_comment#5075,cval_customer_c_mktsegment#5076,cdepval_customer_c_name#5077,cdepval_customer_c_address#5078,cdepval_customer_c_phone#5079,cdepval_customer_c_acctbal#5080,cdepval_customer_c_comment#5081,cdepval_customer_c_mktsegment#5082,cc_name#5083,cc_address#5084,cc_phone#5085,cc_acctbal#5086,cc_comment#5087,cc_mktsegment#5088] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 40436ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/26 22:04:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:04:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5348L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:04:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:04:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:04:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:04:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:04:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:04:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:04:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:04:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5348L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#5375, cval_part_p_name_0#5376, cval_part_p_mfgr_0#5377, cval_part_p_type_0#5378, cval_part_p_size_0#5379, cval_part_p_container_0#5380, cval_part_p_retailprice_0#5381, cval_part_p_comment_0#5382, cval_part_p_brand_0#5383, cdepval_part_p_name_0#5384, cdepval_part_p_mfgr_0#5385, cdepval_part_p_type_0#5386, cdepval_part_p_size_0#5387, cdepval_part_p_container_0#5388, cdepval_part_p_retailprice_0#5389, cdepval_part_p_comment_0#5390, cdepval_part_p_brand_0#5391, cp_name_0#5392, cp_mfgr_0#5393, cp_type_0#5394, cp_size_0#5395, cp_container_0#5396, cp_retailprice_0#5397, cp_comment_0#5398, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#5350 AS rid_0#5375, cval_part_p_name#5351 AS cval_part_p_name_0#5376, cval_part_p_mfgr#5352 AS cval_part_p_mfgr_0#5377, cval_part_p_type#5353 AS cval_part_p_type_0#5378, cval_part_p_size#5354 AS cval_part_p_size_0#5379, cval_part_p_container#5355 AS cval_part_p_container_0#5380, cval_part_p_retailprice#5356 AS cval_part_p_retailprice_0#5381, cval_part_p_comment#5357 AS cval_part_p_comment_0#5382, cval_part_p_brand#5358 AS cval_part_p_brand_0#5383, cdepval_part_p_name#5359 AS cdepval_part_p_name_0#5384, cdepval_part_p_mfgr#5360 AS cdepval_part_p_mfgr_0#5385, cdepval_part_p_type#5361 AS cdepval_part_p_type_0#5386, cdepval_part_p_size#5362 AS cdepval_part_p_size_0#5387, cdepval_part_p_container#5363 AS cdepval_part_p_container_0#5388, cdepval_part_p_retailprice#5364 AS cdepval_part_p_retailprice_0#5389, cdepval_part_p_comment#5365 AS cdepval_part_p_comment_0#5390, cdepval_part_p_brand#5366 AS cdepval_part_p_brand_0#5391, cp_name#5367 AS cp_name_0#5392, cp_mfgr#5368 AS cp_mfgr_0#5393, cp_type#5369 AS cp_type_0#5394, cp_size#5370 AS cp_size_0#5395, cp_container#5371 AS cp_container_0#5396, cp_retailprice#5372 AS cp_retailprice_0#5397, cp_comment#5373 AS cp_comment_0#5398, cp_brand#5374 AS cp_brand_0#5399]
         :  :        +- Relation[rid#5350,cval_part_p_name#5351,cval_part_p_mfgr#5352,cval_part_p_type#5353,cval_part_p_size#5354,cval_part_p_container#5355,cval_part_p_retailprice#5356,cval_part_p_comment#5357,cval_part_p_brand#5358,cdepval_part_p_name#5359,cdepval_part_p_mfgr#5360,cdepval_part_p_type#5361,cdepval_part_p_size#5362,cdepval_part_p_container#5363,cdepval_part_p_retailprice#5364,cdepval_part_p_comment#5365,cdepval_part_p_brand#5366,cp_name#5367,cp_mfgr#5368,cp_type#5369,cp_size#5370,cp_container#5371,cp_retailprice#5372,cp_comment#5373,cp_brand#5374] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#5640 AS rid_1#5685, cpfk_orders_lineitem#5641 AS cpfk_orders_lineitem_1#5686, cpfk_supplier_lineitem#5642 AS cpfk_supplier_lineitem_1#5687, cfpk_lineitem_supplier#5643 AS cfpk_lineitem_supplier_1#5688, cfpk_lineitem_partsupp#5644 AS cfpk_lineitem_partsupp_1#5689, cpfk_part_lineitem#5645 AS cpfk_part_lineitem_1#5690, cfpk_lineitem_part#5646 AS cfpk_lineitem_part_1#5691, cpfk_partsupp_lineitem#5647 AS cpfk_partsupp_lineitem_1#5692, cfpk_lineitem_orders#5648 AS cfpk_lineitem_orders_1#5693, cval_lineitem_l_quantity#5649 AS cval_lineitem_l_quantity_1#5694, cval_lineitem_l_extendedprice#5650 AS cval_lineitem_l_extendedprice_1#5695, cval_lineitem_l_discount#5651 AS cval_lineitem_l_discount_1#5696, cval_lineitem_l_tax#5652 AS cval_lineitem_l_tax_1#5697, cval_lineitem_l_returnflag#5653 AS cval_lineitem_l_returnflag_1#5698, cval_lineitem_l_linestatus#5654 AS cval_lineitem_l_linestatus_1#5699, cval_lineitem_l_commitdate#5655 AS cval_lineitem_l_commitdate_1#5700, cval_lineitem_l_receiptdate#5656 AS cval_lineitem_l_receiptdate_1#5701, cval_lineitem_l_shipinstruct#5657 AS cval_lineitem_l_shipinstruct_1#5702, cval_lineitem_l_shipmode#5658 AS cval_lineitem_l_shipmode_1#5703, cval_lineitem_l_comment#5659 AS cval_lineitem_l_comment_1#5704, cval_lineitem_l_shipdate#5660 AS cval_lineitem_l_shipdate_1#5705, cdepval_lineitem_l_quantity#5661 AS cdepval_lineitem_l_quantity_1#5706, cdepval_lineitem_l_extendedprice#5662 AS cdepval_lineitem_l_extendedprice_1#5707, cdepval_lineitem_l_discount#5663 AS cdepval_lineitem_l_discount_1#5708, ... 21 more fields]
         :        +- Relation[rid#5640,cpfk_orders_lineitem#5641,cpfk_supplier_lineitem#5642,cfpk_lineitem_supplier#5643,cfpk_lineitem_partsupp#5644,cpfk_part_lineitem#5645,cfpk_lineitem_part#5646,cpfk_partsupp_lineitem#5647,cfpk_lineitem_orders#5648,cval_lineitem_l_quantity#5649,cval_lineitem_l_extendedprice#5650,cval_lineitem_l_discount#5651,cval_lineitem_l_tax#5652,cval_lineitem_l_returnflag#5653,cval_lineitem_l_linestatus#5654,cval_lineitem_l_commitdate#5655,cval_lineitem_l_receiptdate#5656,cval_lineitem_l_shipinstruct#5657,cval_lineitem_l_shipmode#5658,cval_lineitem_l_comment#5659,cval_lineitem_l_shipdate#5660,cdepval_lineitem_l_quantity#5661,cdepval_lineitem_l_extendedprice#5662,cdepval_lineitem_l_discount#5663,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5500 AS rid_1#5545, cpfk_orders_lineitem#5501 AS cpfk_orders_lineitem_1#5546, cpfk_supplier_lineitem#5502 AS cpfk_supplier_lineitem_1#5547, cfpk_lineitem_supplier#5503 AS cfpk_lineitem_supplier_1#5548, cfpk_lineitem_partsupp#5504 AS cfpk_lineitem_partsupp_1#5549, cpfk_part_lineitem#5505 AS cpfk_part_lineitem_1#5550, cfpk_lineitem_part#5506 AS cfpk_lineitem_part_1#5551, cpfk_partsupp_lineitem#5507 AS cpfk_partsupp_lineitem_1#5552, cfpk_lineitem_orders#5508 AS cfpk_lineitem_orders_1#5553, cval_lineitem_l_quantity#5509 AS cval_lineitem_l_quantity_1#5554, cval_lineitem_l_extendedprice#5510 AS cval_lineitem_l_extendedprice_1#5555, cval_lineitem_l_discount#5511 AS cval_lineitem_l_discount_1#5556, cval_lineitem_l_tax#5512 AS cval_lineitem_l_tax_1#5557, cval_lineitem_l_returnflag#5513 AS cval_lineitem_l_returnflag_1#5558, cval_lineitem_l_linestatus#5514 AS cval_lineitem_l_linestatus_1#5559, cval_lineitem_l_commitdate#5515 AS cval_lineitem_l_commitdate_1#5560, cval_lineitem_l_receiptdate#5516 AS cval_lineitem_l_receiptdate_1#5561, cval_lineitem_l_shipinstruct#5517 AS cval_lineitem_l_shipinstruct_1#5562, cval_lineitem_l_shipmode#5518 AS cval_lineitem_l_shipmode_1#5563, cval_lineitem_l_comment#5519 AS cval_lineitem_l_comment_1#5564, cval_lineitem_l_shipdate#5520 AS cval_lineitem_l_shipdate_1#5565, cdepval_lineitem_l_quantity#5521 AS cdepval_lineitem_l_quantity_1#5566, cdepval_lineitem_l_extendedprice#5522 AS cdepval_lineitem_l_extendedprice_1#5567, cdepval_lineitem_l_discount#5523 AS cdepval_lineitem_l_discount_1#5568, ... 21 more fields]
            +- Relation[rid#5500,cpfk_orders_lineitem#5501,cpfk_supplier_lineitem#5502,cfpk_lineitem_supplier#5503,cfpk_lineitem_partsupp#5504,cpfk_part_lineitem#5505,cfpk_lineitem_part#5506,cpfk_partsupp_lineitem#5507,cfpk_lineitem_orders#5508,cval_lineitem_l_quantity#5509,cval_lineitem_l_extendedprice#5510,cval_lineitem_l_discount#5511,cval_lineitem_l_tax#5512,cval_lineitem_l_returnflag#5513,cval_lineitem_l_linestatus#5514,cval_lineitem_l_commitdate#5515,cval_lineitem_l_receiptdate#5516,cval_lineitem_l_shipinstruct#5517,cval_lineitem_l_shipmode#5518,cval_lineitem_l_comment#5519,cval_lineitem_l_shipdate#5520,cdepval_lineitem_l_quantity#5521,cdepval_lineitem_l_extendedprice#5522,cdepval_lineitem_l_discount#5523,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 516ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/26 22:04:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:04:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5804L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 22:04:18 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:04:18 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:04:18 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:04:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:04:18 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:04:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:04:18 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:04:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:04:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:04:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:04:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:04:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:04:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:04:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:04:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:04:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:04:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5804L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#5945, cval_part_p_name_3#5946, cval_part_p_mfgr_3#5947, cval_part_p_type_3#5948, cval_part_p_size_3#5949, cval_part_p_container_3#5950, cval_part_p_retailprice_3#5951, cval_part_p_comment_3#5952, cval_part_p_brand_3#5953, cdepval_part_p_name_3#5954, cdepval_part_p_mfgr_3#5955, cdepval_part_p_type_3#5956, cdepval_part_p_size_3#5957, cdepval_part_p_container_3#5958, cdepval_part_p_retailprice_3#5959, cdepval_part_p_comment_3#5960, cdepval_part_p_brand_3#5961, cp_name_3#5962, cp_mfgr_3#5963, cp_type_3#5964, cp_size_3#5965, cp_container_3#5966, cp_retailprice_3#5967, cp_comment_3#5968, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :  :  :  +- Project [rid#5920 AS rid_3#5945, cval_part_p_name#5921 AS cval_part_p_name_3#5946, cval_part_p_mfgr#5922 AS cval_part_p_mfgr_3#5947, cval_part_p_type#5923 AS cval_part_p_type_3#5948, cval_part_p_size#5924 AS cval_part_p_size_3#5949, cval_part_p_container#5925 AS cval_part_p_container_3#5950, cval_part_p_retailprice#5926 AS cval_part_p_retailprice_3#5951, cval_part_p_comment#5927 AS cval_part_p_comment_3#5952, cval_part_p_brand#5928 AS cval_part_p_brand_3#5953, cdepval_part_p_name#5929 AS cdepval_part_p_name_3#5954, cdepval_part_p_mfgr#5930 AS cdepval_part_p_mfgr_3#5955, cdepval_part_p_type#5931 AS cdepval_part_p_type_3#5956, cdepval_part_p_size#5932 AS cdepval_part_p_size_3#5957, cdepval_part_p_container#5933 AS cdepval_part_p_container_3#5958, cdepval_part_p_retailprice#5934 AS cdepval_part_p_retailprice_3#5959, cdepval_part_p_comment#5935 AS cdepval_part_p_comment_3#5960, cdepval_part_p_brand#5936 AS cdepval_part_p_brand_3#5961, cp_name#5937 AS cp_name_3#5962, cp_mfgr#5938 AS cp_mfgr_3#5963, cp_type#5939 AS cp_type_3#5964, cp_size#5940 AS cp_size_3#5965, cp_container#5941 AS cp_container_3#5966, cp_retailprice#5942 AS cp_retailprice_3#5967, cp_comment#5943 AS cp_comment_3#5968, cp_brand#5944 AS cp_brand_3#5969]
         :  :  :     +- Relation[rid#5920,cval_part_p_name#5921,cval_part_p_mfgr#5922,cval_part_p_type#5923,cval_part_p_size#5924,cval_part_p_container#5925,cval_part_p_retailprice#5926,cval_part_p_comment#5927,cval_part_p_brand#5928,cdepval_part_p_name#5929,cdepval_part_p_mfgr#5930,cdepval_part_p_type#5931,cdepval_part_p_size#5932,cdepval_part_p_container#5933,cdepval_part_p_retailprice#5934,cdepval_part_p_comment#5935,cdepval_part_p_brand#5936,cp_name#5937,cp_mfgr#5938,cp_type#5939,cp_size#5940,cp_container#5941,cp_retailprice#5942,cp_comment#5943,cp_brand#5944] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_4, 'rid_4]
         :  :     +- Project [rid#6098 AS rid_4#6112, cpfk_part_partsupp#6099 AS cpfk_part_partsupp_4#6113, cfpk_partsupp_part#6100 AS cfpk_partsupp_part_4#6114, cpfk_supplier_partsupp#6101 AS cpfk_supplier_partsupp_4#6115, cfpk_partsupp_supplier#6102 AS cfpk_partsupp_supplier_4#6116, cval_partsupp_ps_availqty#6103 AS cval_partsupp_ps_availqty_4#6117, cval_partsupp_ps_supplycost#6104 AS cval_partsupp_ps_supplycost_4#6118, cval_partsupp_ps_comment#6105 AS cval_partsupp_ps_comment_4#6119, cdepval_partsupp_ps_availqty#6106 AS cdepval_partsupp_ps_availqty_4#6120, cdepval_partsupp_ps_supplycost#6107 AS cdepval_partsupp_ps_supplycost_4#6121, cdepval_partsupp_ps_comment#6108 AS cdepval_partsupp_ps_comment_4#6122, cps_availqty#6109 AS cps_availqty_4#6123, cps_supplycost#6110 AS cps_supplycost_4#6124, cps_comment#6111 AS cps_comment_4#6125]
         :  :        +- Relation[rid#6098,cpfk_part_partsupp#6099,cfpk_partsupp_part#6100,cpfk_supplier_partsupp#6101,cfpk_partsupp_supplier#6102,cval_partsupp_ps_availqty#6103,cval_partsupp_ps_supplycost#6104,cval_partsupp_ps_comment#6105,cdepval_partsupp_ps_availqty#6106,cdepval_partsupp_ps_supplycost#6107,cdepval_partsupp_ps_comment#6108,cps_availqty#6109,cps_supplycost#6110,cps_comment#6111] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#6020 AS rid_4#6034, cpfk_part_partsupp#6021 AS cpfk_part_partsupp_4#6035, cfpk_partsupp_part#6022 AS cfpk_partsupp_part_4#6036, cpfk_supplier_partsupp#6023 AS cpfk_supplier_partsupp_4#6037, cfpk_partsupp_supplier#6024 AS cfpk_partsupp_supplier_4#6038, cval_partsupp_ps_availqty#6025 AS cval_partsupp_ps_availqty_4#6039, cval_partsupp_ps_supplycost#6026 AS cval_partsupp_ps_supplycost_4#6040, cval_partsupp_ps_comment#6027 AS cval_partsupp_ps_comment_4#6041, cdepval_partsupp_ps_availqty#6028 AS cdepval_partsupp_ps_availqty_4#6042, cdepval_partsupp_ps_supplycost#6029 AS cdepval_partsupp_ps_supplycost_4#6043, cdepval_partsupp_ps_comment#6030 AS cdepval_partsupp_ps_comment_4#6044, cps_availqty#6031 AS cps_availqty_4#6045, cps_supplycost#6032 AS cps_supplycost_4#6046, cps_comment#6033 AS cps_comment_4#6047]
         :     +- Relation[rid#6020,cpfk_part_partsupp#6021,cfpk_partsupp_part#6022,cpfk_supplier_partsupp#6023,cfpk_partsupp_supplier#6024,cval_partsupp_ps_availqty#6025,cval_partsupp_ps_supplycost#6026,cval_partsupp_ps_comment#6027,cdepval_partsupp_ps_availqty#6028,cdepval_partsupp_ps_supplycost#6029,cdepval_partsupp_ps_comment#6030,cps_availqty#6031,cps_supplycost#6032,cps_comment#6033] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#5884 AS rid_2#5902, cpfk_nation_supplier#5885 AS cpfk_nation_supplier_2#5903, cfpk_supplier_nation#5886 AS cfpk_supplier_nation_2#5904, cval_supplier_s_name#5887 AS cval_supplier_s_name_2#5905, cval_supplier_s_address#5888 AS cval_supplier_s_address_2#5906, cval_supplier_s_phone#5889 AS cval_supplier_s_phone_2#5907, cval_supplier_s_acctbal#5890 AS cval_supplier_s_acctbal_2#5908, cval_supplier_s_comment#5891 AS cval_supplier_s_comment_2#5909, cdepval_supplier_s_name#5892 AS cdepval_supplier_s_name_2#5910, cdepval_supplier_s_address#5893 AS cdepval_supplier_s_address_2#5911, cdepval_supplier_s_phone#5894 AS cdepval_supplier_s_phone_2#5912, cdepval_supplier_s_acctbal#5895 AS cdepval_supplier_s_acctbal_2#5913, cdepval_supplier_s_comment#5896 AS cdepval_supplier_s_comment_2#5914, cs_name#5897 AS cs_name_2#5915, cs_address#5898 AS cs_address_2#5916, cs_phone#5899 AS cs_phone_2#5917, cs_acctbal#5900 AS cs_acctbal_2#5918, cs_comment#5901 AS cs_comment_2#5919]
            :  +- Relation[rid#5884,cpfk_nation_supplier#5885,cfpk_supplier_nation#5886,cval_supplier_s_name#5887,cval_supplier_s_address#5888,cval_supplier_s_phone#5889,cval_supplier_s_acctbal#5890,cval_supplier_s_comment#5891,cdepval_supplier_s_name#5892,cdepval_supplier_s_address#5893,cdepval_supplier_s_phone#5894,cdepval_supplier_s_acctbal#5895,cdepval_supplier_s_comment#5896,cs_name#5897,cs_address#5898,cs_phone#5899,cs_acctbal#5900,cs_comment#5901] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_1))
               :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#5813, cval_region_r_name_0#5814, cval_region_r_comment_0#5815, cdepval_region_r_name_0#5816, cdepval_region_r_comment_0#5817, cr_name_0#5818, cr_comment_0#5819, 'rid_1]
               :  :- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
               :  :  +- Project [rid#5806 AS rid_0#5813, cval_region_r_name#5807 AS cval_region_r_name_0#5814, cval_region_r_comment#5808 AS cval_region_r_comment_0#5815, cdepval_region_r_name#5809 AS cdepval_region_r_name_0#5816, cdepval_region_r_comment#5810 AS cdepval_region_r_comment_0#5817, cr_name#5811 AS cr_name_0#5818, cr_comment#5812 AS cr_comment_0#5819]
               :  :     +- Relation[rid#5806,cval_region_r_name#5807,cval_region_r_comment#5808,cdepval_region_r_name#5809,cdepval_region_r_comment#5810,cr_name#5811,cr_comment#5812] JDBCRelation(tregion) [numPartitions=1]
               :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
               :     +- Project [rid#5866 AS rid_1#5875, cpfk_region_nation#5867 AS cpfk_region_nation_1#5876, cfpk_nation_region#5868 AS cfpk_nation_region_1#5877, cval_nation_n_name#5869 AS cval_nation_n_name_1#5878, cval_nation_n_comment#5870 AS cval_nation_n_comment_1#5879, cdepval_nation_n_name#5871 AS cdepval_nation_n_name_1#5880, cdepval_nation_n_comment#5872 AS cdepval_nation_n_comment_1#5881, cn_name#5873 AS cn_name_1#5882, cn_comment#5874 AS cn_comment_1#5883]
               :        +- Relation[rid#5866,cpfk_region_nation#5867,cfpk_nation_region#5868,cval_nation_n_name#5869,cval_nation_n_comment#5870,cdepval_nation_n_name#5871,cdepval_nation_n_comment#5872,cn_name#5873,cn_comment#5874] JDBCRelation(tnation) [numPartitions=1]
               +- Project [rid#5834 AS rid_1#5843, cpfk_region_nation#5835 AS cpfk_region_nation_1#5844, cfpk_nation_region#5836 AS cfpk_nation_region_1#5845, cval_nation_n_name#5837 AS cval_nation_n_name_1#5846, cval_nation_n_comment#5838 AS cval_nation_n_comment_1#5847, cdepval_nation_n_name#5839 AS cdepval_nation_n_name_1#5848, cdepval_nation_n_comment#5840 AS cdepval_nation_n_comment_1#5849, cn_name#5841 AS cn_name_1#5850, cn_comment#5842 AS cn_comment_1#5851]
                  +- Relation[rid#5834,cpfk_region_nation#5835,cfpk_nation_region#5836,cval_nation_n_name#5837,cval_nation_n_comment#5838,cdepval_nation_n_name#5839,cdepval_nation_n_comment#5840,cn_name#5841,cn_comment#5842] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 917ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/26 22:04:19 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:04:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6206L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:04:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:04:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:04:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:04:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:04:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:04:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:04:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:04:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:04:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:04:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:04:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:04:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:04:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:04:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:04:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6206L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6233, cval_part_p_name_0#6234, cval_part_p_mfgr_0#6235, cval_part_p_type_0#6236, cval_part_p_size_0#6237, cval_part_p_container_0#6238, cval_part_p_retailprice_0#6239, cval_part_p_comment_0#6240, cval_part_p_brand_0#6241, cdepval_part_p_name_0#6242, cdepval_part_p_mfgr_0#6243, cdepval_part_p_type_0#6244, cdepval_part_p_size_0#6245, cdepval_part_p_container_0#6246, cdepval_part_p_retailprice_0#6247, cdepval_part_p_comment_0#6248, cdepval_part_p_brand_0#6249, cp_name_0#6250, cp_mfgr_0#6251, cp_type_0#6252, cp_size_0#6253, cp_container_0#6254, cp_retailprice_0#6255, cp_comment_0#6256, ... 2 more fields]
         :  :  :  :  :- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :  :  :  +- Project [rid#6208 AS rid_0#6233, cval_part_p_name#6209 AS cval_part_p_name_0#6234, cval_part_p_mfgr#6210 AS cval_part_p_mfgr_0#6235, cval_part_p_type#6211 AS cval_part_p_type_0#6236, cval_part_p_size#6212 AS cval_part_p_size_0#6237, cval_part_p_container#6213 AS cval_part_p_container_0#6238, cval_part_p_retailprice#6214 AS cval_part_p_retailprice_0#6239, cval_part_p_comment#6215 AS cval_part_p_comment_0#6240, cval_part_p_brand#6216 AS cval_part_p_brand_0#6241, cdepval_part_p_name#6217 AS cdepval_part_p_name_0#6242, cdepval_part_p_mfgr#6218 AS cdepval_part_p_mfgr_0#6243, cdepval_part_p_type#6219 AS cdepval_part_p_type_0#6244, cdepval_part_p_size#6220 AS cdepval_part_p_size_0#6245, cdepval_part_p_container#6221 AS cdepval_part_p_container_0#6246, cdepval_part_p_retailprice#6222 AS cdepval_part_p_retailprice_0#6247, cdepval_part_p_comment#6223 AS cdepval_part_p_comment_0#6248, cdepval_part_p_brand#6224 AS cdepval_part_p_brand_0#6249, cp_name#6225 AS cp_name_0#6250, cp_mfgr#6226 AS cp_mfgr_0#6251, cp_type#6227 AS cp_type_0#6252, cp_size#6228 AS cp_size_0#6253, cp_container#6229 AS cp_container_0#6254, cp_retailprice#6230 AS cp_retailprice_0#6255, cp_comment#6231 AS cp_comment_0#6256, cp_brand#6232 AS cp_brand_0#6257]
         :  :  :  :  :     +- Relation[rid#6208,cval_part_p_name#6209,cval_part_p_mfgr#6210,cval_part_p_type#6211,cval_part_p_size#6212,cval_part_p_container#6213,cval_part_p_retailprice#6214,cval_part_p_comment#6215,cval_part_p_brand#6216,cdepval_part_p_name#6217,cdepval_part_p_mfgr#6218,cdepval_part_p_type#6219,cdepval_part_p_size#6220,cdepval_part_p_container#6221,cdepval_part_p_retailprice#6222,cdepval_part_p_comment#6223,cdepval_part_p_brand#6224,cp_name#6225,cp_mfgr#6226,cp_type#6227,cp_size#6228,cp_container#6229,cp_retailprice#6230,cp_comment#6231,cp_brand#6232] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :  :  :  :     +- Project [rid#6448 AS rid_1#6493, cpfk_orders_lineitem#6449 AS cpfk_orders_lineitem_1#6494, cpfk_supplier_lineitem#6450 AS cpfk_supplier_lineitem_1#6495, cfpk_lineitem_supplier#6451 AS cfpk_lineitem_supplier_1#6496, cfpk_lineitem_partsupp#6452 AS cfpk_lineitem_partsupp_1#6497, cpfk_part_lineitem#6453 AS cpfk_part_lineitem_1#6498, cfpk_lineitem_part#6454 AS cfpk_lineitem_part_1#6499, cpfk_partsupp_lineitem#6455 AS cpfk_partsupp_lineitem_1#6500, cfpk_lineitem_orders#6456 AS cfpk_lineitem_orders_1#6501, cval_lineitem_l_quantity#6457 AS cval_lineitem_l_quantity_1#6502, cval_lineitem_l_extendedprice#6458 AS cval_lineitem_l_extendedprice_1#6503, cval_lineitem_l_discount#6459 AS cval_lineitem_l_discount_1#6504, cval_lineitem_l_tax#6460 AS cval_lineitem_l_tax_1#6505, cval_lineitem_l_returnflag#6461 AS cval_lineitem_l_returnflag_1#6506, cval_lineitem_l_linestatus#6462 AS cval_lineitem_l_linestatus_1#6507, cval_lineitem_l_commitdate#6463 AS cval_lineitem_l_commitdate_1#6508, cval_lineitem_l_receiptdate#6464 AS cval_lineitem_l_receiptdate_1#6509, cval_lineitem_l_shipinstruct#6465 AS cval_lineitem_l_shipinstruct_1#6510, cval_lineitem_l_shipmode#6466 AS cval_lineitem_l_shipmode_1#6511, cval_lineitem_l_comment#6467 AS cval_lineitem_l_comment_1#6512, cval_lineitem_l_shipdate#6468 AS cval_lineitem_l_shipdate_1#6513, cdepval_lineitem_l_quantity#6469 AS cdepval_lineitem_l_quantity_1#6514, cdepval_lineitem_l_extendedprice#6470 AS cdepval_lineitem_l_extendedprice_1#6515, cdepval_lineitem_l_discount#6471 AS cdepval_lineitem_l_discount_1#6516, ... 21 more fields]
         :  :  :  :        +- Relation[rid#6448,cpfk_orders_lineitem#6449,cpfk_supplier_lineitem#6450,cfpk_lineitem_supplier#6451,cfpk_lineitem_partsupp#6452,cpfk_part_lineitem#6453,cfpk_lineitem_part#6454,cpfk_partsupp_lineitem#6455,cfpk_lineitem_orders#6456,cval_lineitem_l_quantity#6457,cval_lineitem_l_extendedprice#6458,cval_lineitem_l_discount#6459,cval_lineitem_l_tax#6460,cval_lineitem_l_returnflag#6461,cval_lineitem_l_linestatus#6462,cval_lineitem_l_commitdate#6463,cval_lineitem_l_receiptdate#6464,cval_lineitem_l_shipinstruct#6465,cval_lineitem_l_shipmode#6466,cval_lineitem_l_comment#6467,cval_lineitem_l_shipdate#6468,cdepval_lineitem_l_quantity#6469,cdepval_lineitem_l_extendedprice#6470,cdepval_lineitem_l_discount#6471,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- Project [rid#6308 AS rid_1#6353, cpfk_orders_lineitem#6309 AS cpfk_orders_lineitem_1#6354, cpfk_supplier_lineitem#6310 AS cpfk_supplier_lineitem_1#6355, cfpk_lineitem_supplier#6311 AS cfpk_lineitem_supplier_1#6356, cfpk_lineitem_partsupp#6312 AS cfpk_lineitem_partsupp_1#6357, cpfk_part_lineitem#6313 AS cpfk_part_lineitem_1#6358, cfpk_lineitem_part#6314 AS cfpk_lineitem_part_1#6359, cpfk_partsupp_lineitem#6315 AS cpfk_partsupp_lineitem_1#6360, cfpk_lineitem_orders#6316 AS cfpk_lineitem_orders_1#6361, cval_lineitem_l_quantity#6317 AS cval_lineitem_l_quantity_1#6362, cval_lineitem_l_extendedprice#6318 AS cval_lineitem_l_extendedprice_1#6363, cval_lineitem_l_discount#6319 AS cval_lineitem_l_discount_1#6364, cval_lineitem_l_tax#6320 AS cval_lineitem_l_tax_1#6365, cval_lineitem_l_returnflag#6321 AS cval_lineitem_l_returnflag_1#6366, cval_lineitem_l_linestatus#6322 AS cval_lineitem_l_linestatus_1#6367, cval_lineitem_l_commitdate#6323 AS cval_lineitem_l_commitdate_1#6368, cval_lineitem_l_receiptdate#6324 AS cval_lineitem_l_receiptdate_1#6369, cval_lineitem_l_shipinstruct#6325 AS cval_lineitem_l_shipinstruct_1#6370, cval_lineitem_l_shipmode#6326 AS cval_lineitem_l_shipmode_1#6371, cval_lineitem_l_comment#6327 AS cval_lineitem_l_comment_1#6372, cval_lineitem_l_shipdate#6328 AS cval_lineitem_l_shipdate_1#6373, cdepval_lineitem_l_quantity#6329 AS cdepval_lineitem_l_quantity_1#6374, cdepval_lineitem_l_extendedprice#6330 AS cdepval_lineitem_l_extendedprice_1#6375, cdepval_lineitem_l_discount#6331 AS cdepval_lineitem_l_discount_1#6376, ... 21 more fields]
         :  :  :     +- Relation[rid#6308,cpfk_orders_lineitem#6309,cpfk_supplier_lineitem#6310,cfpk_lineitem_supplier#6311,cfpk_lineitem_partsupp#6312,cpfk_part_lineitem#6313,cfpk_lineitem_part#6314,cpfk_partsupp_lineitem#6315,cfpk_lineitem_orders#6316,cval_lineitem_l_quantity#6317,cval_lineitem_l_extendedprice#6318,cval_lineitem_l_discount#6319,cval_lineitem_l_tax#6320,cval_lineitem_l_returnflag#6321,cval_lineitem_l_linestatus#6322,cval_lineitem_l_commitdate#6323,cval_lineitem_l_receiptdate#6324,cval_lineitem_l_shipinstruct#6325,cval_lineitem_l_shipmode#6326,cval_lineitem_l_comment#6327,cval_lineitem_l_shipdate#6328,cdepval_lineitem_l_quantity#6329,cdepval_lineitem_l_extendedprice#6330,cdepval_lineitem_l_discount#6331,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#6538 AS rid_2#6556, cpfk_nation_supplier#6539 AS cpfk_nation_supplier_2#6557, cfpk_supplier_nation#6540 AS cfpk_supplier_nation_2#6558, cval_supplier_s_name#6541 AS cval_supplier_s_name_2#6559, cval_supplier_s_address#6542 AS cval_supplier_s_address_2#6560, cval_supplier_s_phone#6543 AS cval_supplier_s_phone_2#6561, cval_supplier_s_acctbal#6544 AS cval_supplier_s_acctbal_2#6562, cval_supplier_s_comment#6545 AS cval_supplier_s_comment_2#6563, cdepval_supplier_s_name#6546 AS cdepval_supplier_s_name_2#6564, cdepval_supplier_s_address#6547 AS cdepval_supplier_s_address_2#6565, cdepval_supplier_s_phone#6548 AS cdepval_supplier_s_phone_2#6566, cdepval_supplier_s_acctbal#6549 AS cdepval_supplier_s_acctbal_2#6567, cdepval_supplier_s_comment#6550 AS cdepval_supplier_s_comment_2#6568, cs_name#6551 AS cs_name_2#6569, cs_address#6552 AS cs_address_2#6570, cs_phone#6553 AS cs_phone_2#6571, cs_acctbal#6554 AS cs_acctbal_2#6572, cs_comment#6555 AS cs_comment_2#6573]
         :  :     +- Relation[rid#6538,cpfk_nation_supplier#6539,cfpk_supplier_nation#6540,cval_supplier_s_name#6541,cval_supplier_s_address#6542,cval_supplier_s_phone#6543,cval_supplier_s_acctbal#6544,cval_supplier_s_comment#6545,cdepval_supplier_s_name#6546,cdepval_supplier_s_address#6547,cdepval_supplier_s_phone#6548,cdepval_supplier_s_acctbal#6549,cdepval_supplier_s_comment#6550,cs_name#6551,cs_address#6552,cs_phone#6553,cs_acctbal#6554,cs_comment#6555] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#6574 AS rid_3#6583, cpfk_region_nation#6575 AS cpfk_region_nation_3#6584, cfpk_nation_region#6576 AS cfpk_nation_region_3#6585, cval_nation_n_name#6577 AS cval_nation_n_name_3#6586, cval_nation_n_comment#6578 AS cval_nation_n_comment_3#6587, cdepval_nation_n_name#6579 AS cdepval_nation_n_name_3#6588, cdepval_nation_n_comment#6580 AS cdepval_nation_n_comment_3#6589, cn_name#6581 AS cn_name_3#6590, cn_comment#6582 AS cn_comment_3#6591]
         :     +- Relation[rid#6574,cpfk_region_nation#6575,cfpk_nation_region#6576,cval_nation_n_name#6577,cval_nation_n_comment#6578,cdepval_nation_n_name#6579,cdepval_nation_n_comment#6580,cn_name#6581,cn_comment#6582] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#6712 AS rid_7#6736, cpfk_customer_orders#6713 AS cpfk_customer_orders_7#6737, cfpk_orders_customer#6714 AS cfpk_orders_customer_7#6738, cval_orders_o_orderstatus#6715 AS cval_orders_o_orderstatus_7#6739, cval_orders_o_totalprice#6716 AS cval_orders_o_totalprice_7#6740, cval_orders_o_orderpriority#6717 AS cval_orders_o_orderpriority_7#6741, cval_orders_o_clerk#6718 AS cval_orders_o_clerk_7#6742, cval_orders_o_shippriority#6719 AS cval_orders_o_shippriority_7#6743, cval_orders_o_comment#6720 AS cval_orders_o_comment_7#6744, cval_orders_o_orderdate#6721 AS cval_orders_o_orderdate_7#6745, cdepval_orders_o_orderstatus#6722 AS cdepval_orders_o_orderstatus_7#6746, cdepval_orders_o_totalprice#6723 AS cdepval_orders_o_totalprice_7#6747, cdepval_orders_o_orderpriority#6724 AS cdepval_orders_o_orderpriority_7#6748, cdepval_orders_o_clerk#6725 AS cdepval_orders_o_clerk_7#6749, cdepval_orders_o_shippriority#6726 AS cdepval_orders_o_shippriority_7#6750, cdepval_orders_o_comment#6727 AS cdepval_orders_o_comment_7#6751, cdepval_orders_o_orderdate#6728 AS cdepval_orders_o_orderdate_7#6752, co_orderstatus#6729 AS co_orderstatus_7#6753, co_totalprice#6730 AS co_totalprice_7#6754, co_orderpriority#6731 AS co_orderpriority_7#6755, co_clerk#6732 AS co_clerk_7#6756, co_shippriority#6733 AS co_shippriority_7#6757, co_comment#6734 AS co_comment_7#6758, co_orderdate#6735 AS co_orderdate_7#6759]
            :  +- Relation[rid#6712,cpfk_customer_orders#6713,cfpk_orders_customer#6714,cval_orders_o_orderstatus#6715,cval_orders_o_totalprice#6716,cval_orders_o_orderpriority#6717,cval_orders_o_clerk#6718,cval_orders_o_shippriority#6719,cval_orders_o_comment#6720,cval_orders_o_orderdate#6721,cdepval_orders_o_orderstatus#6722,cdepval_orders_o_totalprice#6723,cdepval_orders_o_orderpriority#6724,cdepval_orders_o_clerk#6725,cdepval_orders_o_shippriority#6726,cdepval_orders_o_comment#6727,cdepval_orders_o_orderdate#6728,co_orderstatus#6729,co_totalprice#6730,co_orderpriority#6731,co_clerk#6732,co_shippriority#6733,co_comment#6734,co_orderdate#6735] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#6670 AS rid_6#6691, cpfk_nation_customer#6671 AS cpfk_nation_customer_6#6692, cfpk_customer_nation#6672 AS cfpk_customer_nation_6#6693, cval_customer_c_name#6673 AS cval_customer_c_name_6#6694, cval_customer_c_address#6674 AS cval_customer_c_address_6#6695, cval_customer_c_phone#6675 AS cval_customer_c_phone_6#6696, cval_customer_c_acctbal#6676 AS cval_customer_c_acctbal_6#6697, cval_customer_c_comment#6677 AS cval_customer_c_comment_6#6698, cval_customer_c_mktsegment#6678 AS cval_customer_c_mktsegment_6#6699, cdepval_customer_c_name#6679 AS cdepval_customer_c_name_6#6700, cdepval_customer_c_address#6680 AS cdepval_customer_c_address_6#6701, cdepval_customer_c_phone#6681 AS cdepval_customer_c_phone_6#6702, cdepval_customer_c_acctbal#6682 AS cdepval_customer_c_acctbal_6#6703, cdepval_customer_c_comment#6683 AS cdepval_customer_c_comment_6#6704, cdepval_customer_c_mktsegment#6684 AS cdepval_customer_c_mktsegment_6#6705, cc_name#6685 AS cc_name_6#6706, cc_address#6686 AS cc_address_6#6707, cc_phone#6687 AS cc_phone_6#6708, cc_acctbal#6688 AS cc_acctbal_6#6709, cc_comment#6689 AS cc_comment_6#6710, cc_mktsegment#6690 AS cc_mktsegment_6#6711]
               :  +- Relation[rid#6670,cpfk_nation_customer#6671,cfpk_customer_nation#6672,cval_customer_c_name#6673,cval_customer_c_address#6674,cval_customer_c_phone#6675,cval_customer_c_acctbal#6676,cval_customer_c_comment#6677,cval_customer_c_mktsegment#6678,cdepval_customer_c_name#6679,cdepval_customer_c_address#6680,cdepval_customer_c_phone#6681,cdepval_customer_c_acctbal#6682,cdepval_customer_c_comment#6683,cdepval_customer_c_mktsegment#6684,cc_name#6685,cc_address#6686,cc_phone#6687,cc_acctbal#6688,cc_comment#6689,cc_mktsegment#6690] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join UsingJoin(Inner,List(rid_5))
                  :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_5, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#6599, cval_region_r_name_4#6600, cval_region_r_comment_4#6601, cdepval_region_r_name_4#6602, cdepval_region_r_comment_4#6603, cr_name_4#6604, cr_comment_4#6605, 'rid_5]
                  :  :- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                  :  :  +- Project [rid#6592 AS rid_4#6599, cval_region_r_name#6593 AS cval_region_r_name_4#6600, cval_region_r_comment#6594 AS cval_region_r_comment_4#6601, cdepval_region_r_name#6595 AS cdepval_region_r_name_4#6602, cdepval_region_r_comment#6596 AS cdepval_region_r_comment_4#6603, cr_name#6597 AS cr_name_4#6604, cr_comment#6598 AS cr_comment_4#6605]
                  :  :     +- Relation[rid#6592,cval_region_r_name#6593,cval_region_r_comment#6594,cdepval_region_r_name#6595,cdepval_region_r_comment#6596,cr_name#6597,cr_comment#6598] JDBCRelation(tregion) [numPartitions=1]
                  :  +- 'Project ['cpfk_region_nation_5, 'rid_5]
                  :     +- Project [rid#6652 AS rid_5#6661, cpfk_region_nation#6653 AS cpfk_region_nation_5#6662, cfpk_nation_region#6654 AS cfpk_nation_region_5#6663, cval_nation_n_name#6655 AS cval_nation_n_name_5#6664, cval_nation_n_comment#6656 AS cval_nation_n_comment_5#6665, cdepval_nation_n_name#6657 AS cdepval_nation_n_name_5#6666, cdepval_nation_n_comment#6658 AS cdepval_nation_n_comment_5#6667, cn_name#6659 AS cn_name_5#6668, cn_comment#6660 AS cn_comment_5#6669]
                  :        +- Relation[rid#6652,cpfk_region_nation#6653,cfpk_nation_region#6654,cval_nation_n_name#6655,cval_nation_n_comment#6656,cdepval_nation_n_name#6657,cdepval_nation_n_comment#6658,cn_name#6659,cn_comment#6660] JDBCRelation(tnation) [numPartitions=1]
                  +- Project [rid#6620 AS rid_5#6629, cpfk_region_nation#6621 AS cpfk_region_nation_5#6630, cfpk_nation_region#6622 AS cfpk_nation_region_5#6631, cval_nation_n_name#6623 AS cval_nation_n_name_5#6632, cval_nation_n_comment#6624 AS cval_nation_n_comment_5#6633, cdepval_nation_n_name#6625 AS cdepval_nation_n_name_5#6634, cdepval_nation_n_comment#6626 AS cdepval_nation_n_comment_5#6635, cn_name#6627 AS cn_name_5#6636, cn_comment#6628 AS cn_comment_5#6637]
                     +- Relation[rid#6620,cpfk_region_nation#6621,cfpk_nation_region#6622,cval_nation_n_name#6623,cval_nation_n_comment#6624,cdepval_nation_n_name#6625,cdepval_nation_n_comment#6626,cn_name#6627,cn_comment#6628] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 3406ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/26 22:04:22 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:04:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6922L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 22:04:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6922L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#6924 AS rid_0#6948, cpfk_customer_orders#6925 AS cpfk_customer_orders_0#6949, cfpk_orders_customer#6926 AS cfpk_orders_customer_0#6950, cval_orders_o_orderstatus#6927 AS cval_orders_o_orderstatus_0#6951, cval_orders_o_totalprice#6928 AS cval_orders_o_totalprice_0#6952, cval_orders_o_orderpriority#6929 AS cval_orders_o_orderpriority_0#6953, cval_orders_o_clerk#6930 AS cval_orders_o_clerk_0#6954, cval_orders_o_shippriority#6931 AS cval_orders_o_shippriority_0#6955, cval_orders_o_comment#6932 AS cval_orders_o_comment_0#6956, cval_orders_o_orderdate#6933 AS cval_orders_o_orderdate_0#6957, cdepval_orders_o_orderstatus#6934 AS cdepval_orders_o_orderstatus_0#6958, cdepval_orders_o_totalprice#6935 AS cdepval_orders_o_totalprice_0#6959, cdepval_orders_o_orderpriority#6936 AS cdepval_orders_o_orderpriority_0#6960, cdepval_orders_o_clerk#6937 AS cdepval_orders_o_clerk_0#6961, cdepval_orders_o_shippriority#6938 AS cdepval_orders_o_shippriority_0#6962, cdepval_orders_o_comment#6939 AS cdepval_orders_o_comment_0#6963, cdepval_orders_o_orderdate#6940 AS cdepval_orders_o_orderdate_0#6964, co_orderstatus#6941 AS co_orderstatus_0#6965, co_totalprice#6942 AS co_totalprice_0#6966, co_orderpriority#6943 AS co_orderpriority_0#6967, co_clerk#6944 AS co_clerk_0#6968, co_shippriority#6945 AS co_shippriority_0#6969, co_comment#6946 AS co_comment_0#6970, co_orderdate#6947 AS co_orderdate_0#6971]
         :  +- Relation[rid#6924,cpfk_customer_orders#6925,cfpk_orders_customer#6926,cval_orders_o_orderstatus#6927,cval_orders_o_totalprice#6928,cval_orders_o_orderpriority#6929,cval_orders_o_clerk#6930,cval_orders_o_shippriority#6931,cval_orders_o_comment#6932,cval_orders_o_orderdate#6933,cdepval_orders_o_orderstatus#6934,cdepval_orders_o_totalprice#6935,cdepval_orders_o_orderpriority#6936,cdepval_orders_o_clerk#6937,cdepval_orders_o_shippriority#6938,cdepval_orders_o_comment#6939,cdepval_orders_o_orderdate#6940,co_orderstatus#6941,co_totalprice#6942,co_orderpriority#6943,co_clerk#6944,co_shippriority#6945,co_comment#6946,co_orderdate#6947] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#6972 AS rid_1#6993, cpfk_nation_customer#6973 AS cpfk_nation_customer_1#6994, cfpk_customer_nation#6974 AS cfpk_customer_nation_1#6995, cval_customer_c_name#6975 AS cval_customer_c_name_1#6996, cval_customer_c_address#6976 AS cval_customer_c_address_1#6997, cval_customer_c_phone#6977 AS cval_customer_c_phone_1#6998, cval_customer_c_acctbal#6978 AS cval_customer_c_acctbal_1#6999, cval_customer_c_comment#6979 AS cval_customer_c_comment_1#7000, cval_customer_c_mktsegment#6980 AS cval_customer_c_mktsegment_1#7001, cdepval_customer_c_name#6981 AS cdepval_customer_c_name_1#7002, cdepval_customer_c_address#6982 AS cdepval_customer_c_address_1#7003, cdepval_customer_c_phone#6983 AS cdepval_customer_c_phone_1#7004, cdepval_customer_c_acctbal#6984 AS cdepval_customer_c_acctbal_1#7005, cdepval_customer_c_comment#6985 AS cdepval_customer_c_comment_1#7006, cdepval_customer_c_mktsegment#6986 AS cdepval_customer_c_mktsegment_1#7007, cc_name#6987 AS cc_name_1#7008, cc_address#6988 AS cc_address_1#7009, cc_phone#6989 AS cc_phone_1#7010, cc_acctbal#6990 AS cc_acctbal_1#7011, cc_comment#6991 AS cc_comment_1#7012, cc_mktsegment#6992 AS cc_mktsegment_1#7013]
            +- Relation[rid#6972,cpfk_nation_customer#6973,cfpk_customer_nation#6974,cval_customer_c_name#6975,cval_customer_c_address#6976,cval_customer_c_phone#6977,cval_customer_c_acctbal#6978,cval_customer_c_comment#6979,cval_customer_c_mktsegment#6980,cdepval_customer_c_name#6981,cdepval_customer_c_address#6982,cdepval_customer_c_phone#6983,cdepval_customer_c_acctbal#6984,cdepval_customer_c_comment#6985,cdepval_customer_c_mktsegment#6986,cc_name#6987,cc_address#6988,cc_phone#6989,cc_acctbal#6990,cc_comment#6991,cc_mktsegment#6992] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4439ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/26 22:04:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:04:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7065L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:04:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7065L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#7117 AS rid_1#7162, cpfk_orders_lineitem#7118 AS cpfk_orders_lineitem_1#7163, cpfk_supplier_lineitem#7119 AS cpfk_supplier_lineitem_1#7164, cfpk_lineitem_supplier#7120 AS cfpk_lineitem_supplier_1#7165, cfpk_lineitem_partsupp#7121 AS cfpk_lineitem_partsupp_1#7166, cpfk_part_lineitem#7122 AS cpfk_part_lineitem_1#7167, cfpk_lineitem_part#7123 AS cfpk_lineitem_part_1#7168, cpfk_partsupp_lineitem#7124 AS cpfk_partsupp_lineitem_1#7169, cfpk_lineitem_orders#7125 AS cfpk_lineitem_orders_1#7170, cval_lineitem_l_quantity#7126 AS cval_lineitem_l_quantity_1#7171, cval_lineitem_l_extendedprice#7127 AS cval_lineitem_l_extendedprice_1#7172, cval_lineitem_l_discount#7128 AS cval_lineitem_l_discount_1#7173, cval_lineitem_l_tax#7129 AS cval_lineitem_l_tax_1#7174, cval_lineitem_l_returnflag#7130 AS cval_lineitem_l_returnflag_1#7175, cval_lineitem_l_linestatus#7131 AS cval_lineitem_l_linestatus_1#7176, cval_lineitem_l_commitdate#7132 AS cval_lineitem_l_commitdate_1#7177, cval_lineitem_l_receiptdate#7133 AS cval_lineitem_l_receiptdate_1#7178, cval_lineitem_l_shipinstruct#7134 AS cval_lineitem_l_shipinstruct_1#7179, cval_lineitem_l_shipmode#7135 AS cval_lineitem_l_shipmode_1#7180, cval_lineitem_l_comment#7136 AS cval_lineitem_l_comment_1#7181, cval_lineitem_l_shipdate#7137 AS cval_lineitem_l_shipdate_1#7182, cdepval_lineitem_l_quantity#7138 AS cdepval_lineitem_l_quantity_1#7183, cdepval_lineitem_l_extendedprice#7139 AS cdepval_lineitem_l_extendedprice_1#7184, cdepval_lineitem_l_discount#7140 AS cdepval_lineitem_l_discount_1#7185, ... 21 more fields]
         :  +- Relation[rid#7117,cpfk_orders_lineitem#7118,cpfk_supplier_lineitem#7119,cfpk_lineitem_supplier#7120,cfpk_lineitem_partsupp#7121,cpfk_part_lineitem#7122,cfpk_lineitem_part#7123,cpfk_partsupp_lineitem#7124,cfpk_lineitem_orders#7125,cval_lineitem_l_quantity#7126,cval_lineitem_l_extendedprice#7127,cval_lineitem_l_discount#7128,cval_lineitem_l_tax#7129,cval_lineitem_l_returnflag#7130,cval_lineitem_l_linestatus#7131,cval_lineitem_l_commitdate#7132,cval_lineitem_l_receiptdate#7133,cval_lineitem_l_shipinstruct#7134,cval_lineitem_l_shipmode#7135,cval_lineitem_l_comment#7136,cval_lineitem_l_shipdate#7137,cdepval_lineitem_l_quantity#7138,cdepval_lineitem_l_extendedprice#7139,cdepval_lineitem_l_discount#7140,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7067 AS rid_0#7092, cval_part_p_name#7068 AS cval_part_p_name_0#7093, cval_part_p_mfgr#7069 AS cval_part_p_mfgr_0#7094, cval_part_p_type#7070 AS cval_part_p_type_0#7095, cval_part_p_size#7071 AS cval_part_p_size_0#7096, cval_part_p_container#7072 AS cval_part_p_container_0#7097, cval_part_p_retailprice#7073 AS cval_part_p_retailprice_0#7098, cval_part_p_comment#7074 AS cval_part_p_comment_0#7099, cval_part_p_brand#7075 AS cval_part_p_brand_0#7100, cdepval_part_p_name#7076 AS cdepval_part_p_name_0#7101, cdepval_part_p_mfgr#7077 AS cdepval_part_p_mfgr_0#7102, cdepval_part_p_type#7078 AS cdepval_part_p_type_0#7103, cdepval_part_p_size#7079 AS cdepval_part_p_size_0#7104, cdepval_part_p_container#7080 AS cdepval_part_p_container_0#7105, cdepval_part_p_retailprice#7081 AS cdepval_part_p_retailprice_0#7106, cdepval_part_p_comment#7082 AS cdepval_part_p_comment_0#7107, cdepval_part_p_brand#7083 AS cdepval_part_p_brand_0#7108, cp_name#7084 AS cp_name_0#7109, cp_mfgr#7085 AS cp_mfgr_0#7110, cp_type#7086 AS cp_type_0#7111, cp_size#7087 AS cp_size_0#7112, cp_container#7088 AS cp_container_0#7113, cp_retailprice#7089 AS cp_retailprice_0#7114, cp_comment#7090 AS cp_comment_0#7115, cp_brand#7091 AS cp_brand_0#7116]
            +- Relation[rid#7067,cval_part_p_name#7068,cval_part_p_mfgr#7069,cval_part_p_type#7070,cval_part_p_size#7071,cval_part_p_container#7072,cval_part_p_retailprice#7073,cval_part_p_comment#7074,cval_part_p_brand#7075,cdepval_part_p_name#7076,cdepval_part_p_mfgr#7077,cdepval_part_p_type#7078,cdepval_part_p_size#7079,cdepval_part_p_container#7080,cdepval_part_p_retailprice#7081,cdepval_part_p_comment#7082,cdepval_part_p_brand#7083,cp_name#7084,cp_mfgr#7085,cp_type#7086,cp_size#7087,cp_container#7088,cp_retailprice#7089,cp_comment#7090,cp_brand#7091] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17915ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/26 22:04:44 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:04:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7283L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 22:04:44 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:04:44 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:04:44 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:04:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:04:44 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:04:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:04:44 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:04:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:04:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:04:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:04:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:04:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:04:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:04:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7283L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#7453 AS rid_4#7498, cpfk_orders_lineitem#7454 AS cpfk_orders_lineitem_4#7499, cpfk_supplier_lineitem#7455 AS cpfk_supplier_lineitem_4#7500, cfpk_lineitem_supplier#7456 AS cfpk_lineitem_supplier_4#7501, cfpk_lineitem_partsupp#7457 AS cfpk_lineitem_partsupp_4#7502, cpfk_part_lineitem#7458 AS cpfk_part_lineitem_4#7503, cfpk_lineitem_part#7459 AS cfpk_lineitem_part_4#7504, cpfk_partsupp_lineitem#7460 AS cpfk_partsupp_lineitem_4#7505, cfpk_lineitem_orders#7461 AS cfpk_lineitem_orders_4#7506, cval_lineitem_l_quantity#7462 AS cval_lineitem_l_quantity_4#7507, cval_lineitem_l_extendedprice#7463 AS cval_lineitem_l_extendedprice_4#7508, cval_lineitem_l_discount#7464 AS cval_lineitem_l_discount_4#7509, cval_lineitem_l_tax#7465 AS cval_lineitem_l_tax_4#7510, cval_lineitem_l_returnflag#7466 AS cval_lineitem_l_returnflag_4#7511, cval_lineitem_l_linestatus#7467 AS cval_lineitem_l_linestatus_4#7512, cval_lineitem_l_commitdate#7468 AS cval_lineitem_l_commitdate_4#7513, cval_lineitem_l_receiptdate#7469 AS cval_lineitem_l_receiptdate_4#7514, cval_lineitem_l_shipinstruct#7470 AS cval_lineitem_l_shipinstruct_4#7515, cval_lineitem_l_shipmode#7471 AS cval_lineitem_l_shipmode_4#7516, cval_lineitem_l_comment#7472 AS cval_lineitem_l_comment_4#7517, cval_lineitem_l_shipdate#7473 AS cval_lineitem_l_shipdate_4#7518, cdepval_lineitem_l_quantity#7474 AS cdepval_lineitem_l_quantity_4#7519, cdepval_lineitem_l_extendedprice#7475 AS cdepval_lineitem_l_extendedprice_4#7520, cdepval_lineitem_l_discount#7476 AS cdepval_lineitem_l_discount_4#7521, ... 21 more fields]
            :  :  +- Relation[rid#7453,cpfk_orders_lineitem#7454,cpfk_supplier_lineitem#7455,cfpk_lineitem_supplier#7456,cfpk_lineitem_partsupp#7457,cpfk_part_lineitem#7458,cfpk_lineitem_part#7459,cpfk_partsupp_lineitem#7460,cfpk_lineitem_orders#7461,cval_lineitem_l_quantity#7462,cval_lineitem_l_extendedprice#7463,cval_lineitem_l_discount#7464,cval_lineitem_l_tax#7465,cval_lineitem_l_returnflag#7466,cval_lineitem_l_linestatus#7467,cval_lineitem_l_commitdate#7468,cval_lineitem_l_receiptdate#7469,cval_lineitem_l_shipinstruct#7470,cval_lineitem_l_shipmode#7471,cval_lineitem_l_comment#7472,cval_lineitem_l_shipdate#7473,cdepval_lineitem_l_quantity#7474,cdepval_lineitem_l_extendedprice#7475,cdepval_lineitem_l_discount#7476,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#7405 AS rid_3#7429, cpfk_customer_orders#7406 AS cpfk_customer_orders_3#7430, cfpk_orders_customer#7407 AS cfpk_orders_customer_3#7431, cval_orders_o_orderstatus#7408 AS cval_orders_o_orderstatus_3#7432, cval_orders_o_totalprice#7409 AS cval_orders_o_totalprice_3#7433, cval_orders_o_orderpriority#7410 AS cval_orders_o_orderpriority_3#7434, cval_orders_o_clerk#7411 AS cval_orders_o_clerk_3#7435, cval_orders_o_shippriority#7412 AS cval_orders_o_shippriority_3#7436, cval_orders_o_comment#7413 AS cval_orders_o_comment_3#7437, cval_orders_o_orderdate#7414 AS cval_orders_o_orderdate_3#7438, cdepval_orders_o_orderstatus#7415 AS cdepval_orders_o_orderstatus_3#7439, cdepval_orders_o_totalprice#7416 AS cdepval_orders_o_totalprice_3#7440, cdepval_orders_o_orderpriority#7417 AS cdepval_orders_o_orderpriority_3#7441, cdepval_orders_o_clerk#7418 AS cdepval_orders_o_clerk_3#7442, cdepval_orders_o_shippriority#7419 AS cdepval_orders_o_shippriority_3#7443, cdepval_orders_o_comment#7420 AS cdepval_orders_o_comment_3#7444, cdepval_orders_o_orderdate#7421 AS cdepval_orders_o_orderdate_3#7445, co_orderstatus#7422 AS co_orderstatus_3#7446, co_totalprice#7423 AS co_totalprice_3#7447, co_orderpriority#7424 AS co_orderpriority_3#7448, co_clerk#7425 AS co_clerk_3#7449, co_shippriority#7426 AS co_shippriority_3#7450, co_comment#7427 AS co_comment_3#7451, co_orderdate#7428 AS co_orderdate_3#7452]
            :     :  +- Relation[rid#7405,cpfk_customer_orders#7406,cfpk_orders_customer#7407,cval_orders_o_orderstatus#7408,cval_orders_o_totalprice#7409,cval_orders_o_orderpriority#7410,cval_orders_o_clerk#7411,cval_orders_o_shippriority#7412,cval_orders_o_comment#7413,cval_orders_o_orderdate#7414,cdepval_orders_o_orderstatus#7415,cdepval_orders_o_totalprice#7416,cdepval_orders_o_orderpriority#7417,cdepval_orders_o_clerk#7418,cdepval_orders_o_shippriority#7419,cdepval_orders_o_comment#7420,cdepval_orders_o_orderdate#7421,co_orderstatus#7422,co_totalprice#7423,co_orderpriority#7424,co_clerk#7425,co_shippriority#7426,co_comment#7427,co_orderdate#7428] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#7363 AS rid_2#7384, cpfk_nation_customer#7364 AS cpfk_nation_customer_2#7385, cfpk_customer_nation#7365 AS cfpk_customer_nation_2#7386, cval_customer_c_name#7366 AS cval_customer_c_name_2#7387, cval_customer_c_address#7367 AS cval_customer_c_address_2#7388, cval_customer_c_phone#7368 AS cval_customer_c_phone_2#7389, cval_customer_c_acctbal#7369 AS cval_customer_c_acctbal_2#7390, cval_customer_c_comment#7370 AS cval_customer_c_comment_2#7391, cval_customer_c_mktsegment#7371 AS cval_customer_c_mktsegment_2#7392, cdepval_customer_c_name#7372 AS cdepval_customer_c_name_2#7393, cdepval_customer_c_address#7373 AS cdepval_customer_c_address_2#7394, cdepval_customer_c_phone#7374 AS cdepval_customer_c_phone_2#7395, cdepval_customer_c_acctbal#7375 AS cdepval_customer_c_acctbal_2#7396, cdepval_customer_c_comment#7376 AS cdepval_customer_c_comment_2#7397, cdepval_customer_c_mktsegment#7377 AS cdepval_customer_c_mktsegment_2#7398, cc_name#7378 AS cc_name_2#7399, cc_address#7379 AS cc_address_2#7400, cc_phone#7380 AS cc_phone_2#7401, cc_acctbal#7381 AS cc_acctbal_2#7402, cc_comment#7382 AS cc_comment_2#7403, cc_mktsegment#7383 AS cc_mktsegment_2#7404]
            :        :  +- Relation[rid#7363,cpfk_nation_customer#7364,cfpk_customer_nation#7365,cval_customer_c_name#7366,cval_customer_c_address#7367,cval_customer_c_phone#7368,cval_customer_c_acctbal#7369,cval_customer_c_comment#7370,cval_customer_c_mktsegment#7371,cdepval_customer_c_name#7372,cdepval_customer_c_address#7373,cdepval_customer_c_phone#7374,cdepval_customer_c_acctbal#7375,cdepval_customer_c_comment#7376,cdepval_customer_c_mktsegment#7377,cc_name#7378,cc_address#7379,cc_phone#7380,cc_acctbal#7381,cc_comment#7382,cc_mktsegment#7383] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join UsingJoin(Inner,List(rid_1))
            :           :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#7292, cval_region_r_name_0#7293, cval_region_r_comment_0#7294, cdepval_region_r_name_0#7295, cdepval_region_r_comment_0#7296, cr_name_0#7297, cr_comment_0#7298, 'rid_1]
            :           :  :- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :           :  :  +- Project [rid#7285 AS rid_0#7292, cval_region_r_name#7286 AS cval_region_r_name_0#7293, cval_region_r_comment#7287 AS cval_region_r_comment_0#7294, cdepval_region_r_name#7288 AS cdepval_region_r_name_0#7295, cdepval_region_r_comment#7289 AS cdepval_region_r_comment_0#7296, cr_name#7290 AS cr_name_0#7297, cr_comment#7291 AS cr_comment_0#7298]
            :           :  :     +- Relation[rid#7285,cval_region_r_name#7286,cval_region_r_comment#7287,cdepval_region_r_name#7288,cdepval_region_r_comment#7289,cr_name#7290,cr_comment#7291] JDBCRelation(tregion) [numPartitions=1]
            :           :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
            :           :     +- Project [rid#7345 AS rid_1#7354, cpfk_region_nation#7346 AS cpfk_region_nation_1#7355, cfpk_nation_region#7347 AS cfpk_nation_region_1#7356, cval_nation_n_name#7348 AS cval_nation_n_name_1#7357, cval_nation_n_comment#7349 AS cval_nation_n_comment_1#7358, cdepval_nation_n_name#7350 AS cdepval_nation_n_name_1#7359, cdepval_nation_n_comment#7351 AS cdepval_nation_n_comment_1#7360, cn_name#7352 AS cn_name_1#7361, cn_comment#7353 AS cn_comment_1#7362]
            :           :        +- Relation[rid#7345,cpfk_region_nation#7346,cfpk_nation_region#7347,cval_nation_n_name#7348,cval_nation_n_comment#7349,cdepval_nation_n_name#7350,cdepval_nation_n_comment#7351,cn_name#7352,cn_comment#7353] JDBCRelation(tnation) [numPartitions=1]
            :           +- Project [rid#7313 AS rid_1#7322, cpfk_region_nation#7314 AS cpfk_region_nation_1#7323, cfpk_nation_region#7315 AS cfpk_nation_region_1#7324, cval_nation_n_name#7316 AS cval_nation_n_name_1#7325, cval_nation_n_comment#7317 AS cval_nation_n_comment_1#7326, cdepval_nation_n_name#7318 AS cdepval_nation_n_name_1#7327, cdepval_nation_n_comment#7319 AS cdepval_nation_n_comment_1#7328, cn_name#7320 AS cn_name_1#7329, cn_comment#7321 AS cn_comment_1#7330]
            :              +- Relation[rid#7313,cpfk_region_nation#7314,cfpk_nation_region#7315,cval_nation_n_name#7316,cval_nation_n_comment#7317,cdepval_nation_n_name#7318,cdepval_nation_n_comment#7319,cn_name#7320,cn_comment#7321] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#7543 AS rid_5#7561, cpfk_nation_supplier#7544 AS cpfk_nation_supplier_5#7562, cfpk_supplier_nation#7545 AS cfpk_supplier_nation_5#7563, cval_supplier_s_name#7546 AS cval_supplier_s_name_5#7564, cval_supplier_s_address#7547 AS cval_supplier_s_address_5#7565, cval_supplier_s_phone#7548 AS cval_supplier_s_phone_5#7566, cval_supplier_s_acctbal#7549 AS cval_supplier_s_acctbal_5#7567, cval_supplier_s_comment#7550 AS cval_supplier_s_comment_5#7568, cdepval_supplier_s_name#7551 AS cdepval_supplier_s_name_5#7569, cdepval_supplier_s_address#7552 AS cdepval_supplier_s_address_5#7570, cdepval_supplier_s_phone#7553 AS cdepval_supplier_s_phone_5#7571, cdepval_supplier_s_acctbal#7554 AS cdepval_supplier_s_acctbal_5#7572, cdepval_supplier_s_comment#7555 AS cdepval_supplier_s_comment_5#7573, cs_name#7556 AS cs_name_5#7574, cs_address#7557 AS cs_address_5#7575, cs_phone#7558 AS cs_phone_5#7576, cs_acctbal#7559 AS cs_acctbal_5#7577, cs_comment#7560 AS cs_comment_5#7578]
               +- Relation[rid#7543,cpfk_nation_supplier#7544,cfpk_supplier_nation#7545,cval_supplier_s_name#7546,cval_supplier_s_address#7547,cval_supplier_s_phone#7548,cval_supplier_s_acctbal#7549,cval_supplier_s_comment#7550,cdepval_supplier_s_name#7551,cdepval_supplier_s_address#7552,cdepval_supplier_s_phone#7553,cdepval_supplier_s_acctbal#7554,cdepval_supplier_s_comment#7555,cs_name#7556,cs_address#7557,cs_phone#7558,cs_acctbal#7559,cs_comment#7560] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 29652ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/26 22:05:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:05:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7712L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:05:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7712L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#7804 AS rid_2#7849, cpfk_orders_lineitem#7805 AS cpfk_orders_lineitem_2#7850, cpfk_supplier_lineitem#7806 AS cpfk_supplier_lineitem_2#7851, cfpk_lineitem_supplier#7807 AS cfpk_lineitem_supplier_2#7852, cfpk_lineitem_partsupp#7808 AS cfpk_lineitem_partsupp_2#7853, cpfk_part_lineitem#7809 AS cpfk_part_lineitem_2#7854, cfpk_lineitem_part#7810 AS cfpk_lineitem_part_2#7855, cpfk_partsupp_lineitem#7811 AS cpfk_partsupp_lineitem_2#7856, cfpk_lineitem_orders#7812 AS cfpk_lineitem_orders_2#7857, cval_lineitem_l_quantity#7813 AS cval_lineitem_l_quantity_2#7858, cval_lineitem_l_extendedprice#7814 AS cval_lineitem_l_extendedprice_2#7859, cval_lineitem_l_discount#7815 AS cval_lineitem_l_discount_2#7860, cval_lineitem_l_tax#7816 AS cval_lineitem_l_tax_2#7861, cval_lineitem_l_returnflag#7817 AS cval_lineitem_l_returnflag_2#7862, cval_lineitem_l_linestatus#7818 AS cval_lineitem_l_linestatus_2#7863, cval_lineitem_l_commitdate#7819 AS cval_lineitem_l_commitdate_2#7864, cval_lineitem_l_receiptdate#7820 AS cval_lineitem_l_receiptdate_2#7865, cval_lineitem_l_shipinstruct#7821 AS cval_lineitem_l_shipinstruct_2#7866, cval_lineitem_l_shipmode#7822 AS cval_lineitem_l_shipmode_2#7867, cval_lineitem_l_comment#7823 AS cval_lineitem_l_comment_2#7868, cval_lineitem_l_shipdate#7824 AS cval_lineitem_l_shipdate_2#7869, cdepval_lineitem_l_quantity#7825 AS cdepval_lineitem_l_quantity_2#7870, cdepval_lineitem_l_extendedprice#7826 AS cdepval_lineitem_l_extendedprice_2#7871, cdepval_lineitem_l_discount#7827 AS cdepval_lineitem_l_discount_2#7872, ... 21 more fields]
         :  +- Relation[rid#7804,cpfk_orders_lineitem#7805,cpfk_supplier_lineitem#7806,cfpk_lineitem_supplier#7807,cfpk_lineitem_partsupp#7808,cpfk_part_lineitem#7809,cfpk_lineitem_part#7810,cpfk_partsupp_lineitem#7811,cfpk_lineitem_orders#7812,cval_lineitem_l_quantity#7813,cval_lineitem_l_extendedprice#7814,cval_lineitem_l_discount#7815,cval_lineitem_l_tax#7816,cval_lineitem_l_returnflag#7817,cval_lineitem_l_linestatus#7818,cval_lineitem_l_commitdate#7819,cval_lineitem_l_receiptdate#7820,cval_lineitem_l_shipinstruct#7821,cval_lineitem_l_shipmode#7822,cval_lineitem_l_comment#7823,cval_lineitem_l_shipdate#7824,cdepval_lineitem_l_quantity#7825,cdepval_lineitem_l_extendedprice#7826,cdepval_lineitem_l_discount#7827,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#7756 AS rid_1#7780, cpfk_customer_orders#7757 AS cpfk_customer_orders_1#7781, cfpk_orders_customer#7758 AS cfpk_orders_customer_1#7782, cval_orders_o_orderstatus#7759 AS cval_orders_o_orderstatus_1#7783, cval_orders_o_totalprice#7760 AS cval_orders_o_totalprice_1#7784, cval_orders_o_orderpriority#7761 AS cval_orders_o_orderpriority_1#7785, cval_orders_o_clerk#7762 AS cval_orders_o_clerk_1#7786, cval_orders_o_shippriority#7763 AS cval_orders_o_shippriority_1#7787, cval_orders_o_comment#7764 AS cval_orders_o_comment_1#7788, cval_orders_o_orderdate#7765 AS cval_orders_o_orderdate_1#7789, cdepval_orders_o_orderstatus#7766 AS cdepval_orders_o_orderstatus_1#7790, cdepval_orders_o_totalprice#7767 AS cdepval_orders_o_totalprice_1#7791, cdepval_orders_o_orderpriority#7768 AS cdepval_orders_o_orderpriority_1#7792, cdepval_orders_o_clerk#7769 AS cdepval_orders_o_clerk_1#7793, cdepval_orders_o_shippriority#7770 AS cdepval_orders_o_shippriority_1#7794, cdepval_orders_o_comment#7771 AS cdepval_orders_o_comment_1#7795, cdepval_orders_o_orderdate#7772 AS cdepval_orders_o_orderdate_1#7796, co_orderstatus#7773 AS co_orderstatus_1#7797, co_totalprice#7774 AS co_totalprice_1#7798, co_orderpriority#7775 AS co_orderpriority_1#7799, co_clerk#7776 AS co_clerk_1#7800, co_shippriority#7777 AS co_shippriority_1#7801, co_comment#7778 AS co_comment_1#7802, co_orderdate#7779 AS co_orderdate_1#7803]
            :  +- Relation[rid#7756,cpfk_customer_orders#7757,cfpk_orders_customer#7758,cval_orders_o_orderstatus#7759,cval_orders_o_totalprice#7760,cval_orders_o_orderpriority#7761,cval_orders_o_clerk#7762,cval_orders_o_shippriority#7763,cval_orders_o_comment#7764,cval_orders_o_orderdate#7765,cdepval_orders_o_orderstatus#7766,cdepval_orders_o_totalprice#7767,cdepval_orders_o_orderpriority#7768,cdepval_orders_o_clerk#7769,cdepval_orders_o_shippriority#7770,cdepval_orders_o_comment#7771,cdepval_orders_o_orderdate#7772,co_orderstatus#7773,co_totalprice#7774,co_orderpriority#7775,co_clerk#7776,co_shippriority#7777,co_comment#7778,co_orderdate#7779] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#7714 AS rid_0#7735, cpfk_nation_customer#7715 AS cpfk_nation_customer_0#7736, cfpk_customer_nation#7716 AS cfpk_customer_nation_0#7737, cval_customer_c_name#7717 AS cval_customer_c_name_0#7738, cval_customer_c_address#7718 AS cval_customer_c_address_0#7739, cval_customer_c_phone#7719 AS cval_customer_c_phone_0#7740, cval_customer_c_acctbal#7720 AS cval_customer_c_acctbal_0#7741, cval_customer_c_comment#7721 AS cval_customer_c_comment_0#7742, cval_customer_c_mktsegment#7722 AS cval_customer_c_mktsegment_0#7743, cdepval_customer_c_name#7723 AS cdepval_customer_c_name_0#7744, cdepval_customer_c_address#7724 AS cdepval_customer_c_address_0#7745, cdepval_customer_c_phone#7725 AS cdepval_customer_c_phone_0#7746, cdepval_customer_c_acctbal#7726 AS cdepval_customer_c_acctbal_0#7747, cdepval_customer_c_comment#7727 AS cdepval_customer_c_comment_0#7748, cdepval_customer_c_mktsegment#7728 AS cdepval_customer_c_mktsegment_0#7749, cc_name#7729 AS cc_name_0#7750, cc_address#7730 AS cc_address_0#7751, cc_phone#7731 AS cc_phone_0#7752, cc_acctbal#7732 AS cc_acctbal_0#7753, cc_comment#7733 AS cc_comment_0#7754, cc_mktsegment#7734 AS cc_mktsegment_0#7755]
               +- Relation[rid#7714,cpfk_nation_customer#7715,cfpk_customer_nation#7716,cval_customer_c_name#7717,cval_customer_c_address#7718,cval_customer_c_phone#7719,cval_customer_c_acctbal#7720,cval_customer_c_comment#7721,cval_customer_c_mktsegment#7722,cdepval_customer_c_name#7723,cdepval_customer_c_address#7724,cdepval_customer_c_phone#7725,cdepval_customer_c_acctbal#7726,cdepval_customer_c_comment#7727,cdepval_customer_c_mktsegment#7728,cc_name#7729,cc_address#7730,cc_phone#7731,cc_acctbal#7732,cc_comment#7733,cc_mktsegment#7734] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 22409ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 22:05:36 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:05:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7993L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:05:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:05:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:05:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:05:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:05:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:05:36 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:05:36 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:05:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7993L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#8049 AS rid_2#8094, cpfk_orders_lineitem#8050 AS cpfk_orders_lineitem_2#8095, cpfk_supplier_lineitem#8051 AS cpfk_supplier_lineitem_2#8096, cfpk_lineitem_supplier#8052 AS cfpk_lineitem_supplier_2#8097, cfpk_lineitem_partsupp#8053 AS cfpk_lineitem_partsupp_2#8098, cpfk_part_lineitem#8054 AS cpfk_part_lineitem_2#8099, cfpk_lineitem_part#8055 AS cfpk_lineitem_part_2#8100, cpfk_partsupp_lineitem#8056 AS cpfk_partsupp_lineitem_2#8101, cfpk_lineitem_orders#8057 AS cfpk_lineitem_orders_2#8102, cval_lineitem_l_quantity#8058 AS cval_lineitem_l_quantity_2#8103, cval_lineitem_l_extendedprice#8059 AS cval_lineitem_l_extendedprice_2#8104, cval_lineitem_l_discount#8060 AS cval_lineitem_l_discount_2#8105, cval_lineitem_l_tax#8061 AS cval_lineitem_l_tax_2#8106, cval_lineitem_l_returnflag#8062 AS cval_lineitem_l_returnflag_2#8107, cval_lineitem_l_linestatus#8063 AS cval_lineitem_l_linestatus_2#8108, cval_lineitem_l_commitdate#8064 AS cval_lineitem_l_commitdate_2#8109, cval_lineitem_l_receiptdate#8065 AS cval_lineitem_l_receiptdate_2#8110, cval_lineitem_l_shipinstruct#8066 AS cval_lineitem_l_shipinstruct_2#8111, cval_lineitem_l_shipmode#8067 AS cval_lineitem_l_shipmode_2#8112, cval_lineitem_l_comment#8068 AS cval_lineitem_l_comment_2#8113, cval_lineitem_l_shipdate#8069 AS cval_lineitem_l_shipdate_2#8114, cdepval_lineitem_l_quantity#8070 AS cdepval_lineitem_l_quantity_2#8115, cdepval_lineitem_l_extendedprice#8071 AS cdepval_lineitem_l_extendedprice_2#8116, cdepval_lineitem_l_discount#8072 AS cdepval_lineitem_l_discount_2#8117, ... 21 more fields]
         :  :  :  :  +- Relation[rid#8049,cpfk_orders_lineitem#8050,cpfk_supplier_lineitem#8051,cfpk_lineitem_supplier#8052,cfpk_lineitem_partsupp#8053,cpfk_part_lineitem#8054,cfpk_lineitem_part#8055,cpfk_partsupp_lineitem#8056,cfpk_lineitem_orders#8057,cval_lineitem_l_quantity#8058,cval_lineitem_l_extendedprice#8059,cval_lineitem_l_discount#8060,cval_lineitem_l_tax#8061,cval_lineitem_l_returnflag#8062,cval_lineitem_l_linestatus#8063,cval_lineitem_l_commitdate#8064,cval_lineitem_l_receiptdate#8065,cval_lineitem_l_shipinstruct#8066,cval_lineitem_l_shipmode#8067,cval_lineitem_l_comment#8068,cval_lineitem_l_shipdate#8069,cdepval_lineitem_l_quantity#8070,cdepval_lineitem_l_extendedprice#8071,cdepval_lineitem_l_discount#8072,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#8013 AS rid_1#8031, cpfk_nation_supplier#8014 AS cpfk_nation_supplier_1#8032, cfpk_supplier_nation#8015 AS cfpk_supplier_nation_1#8033, cval_supplier_s_name#8016 AS cval_supplier_s_name_1#8034, cval_supplier_s_address#8017 AS cval_supplier_s_address_1#8035, cval_supplier_s_phone#8018 AS cval_supplier_s_phone_1#8036, cval_supplier_s_acctbal#8019 AS cval_supplier_s_acctbal_1#8037, cval_supplier_s_comment#8020 AS cval_supplier_s_comment_1#8038, cdepval_supplier_s_name#8021 AS cdepval_supplier_s_name_1#8039, cdepval_supplier_s_address#8022 AS cdepval_supplier_s_address_1#8040, cdepval_supplier_s_phone#8023 AS cdepval_supplier_s_phone_1#8041, cdepval_supplier_s_acctbal#8024 AS cdepval_supplier_s_acctbal_1#8042, cdepval_supplier_s_comment#8025 AS cdepval_supplier_s_comment_1#8043, cs_name#8026 AS cs_name_1#8044, cs_address#8027 AS cs_address_1#8045, cs_phone#8028 AS cs_phone_1#8046, cs_acctbal#8029 AS cs_acctbal_1#8047, cs_comment#8030 AS cs_comment_1#8048]
         :  :  :     :  +- Relation[rid#8013,cpfk_nation_supplier#8014,cfpk_supplier_nation#8015,cval_supplier_s_name#8016,cval_supplier_s_address#8017,cval_supplier_s_phone#8018,cval_supplier_s_acctbal#8019,cval_supplier_s_comment#8020,cdepval_supplier_s_name#8021,cdepval_supplier_s_address#8022,cdepval_supplier_s_phone#8023,cdepval_supplier_s_acctbal#8024,cdepval_supplier_s_comment#8025,cs_name#8026,cs_address#8027,cs_phone#8028,cs_acctbal#8029,cs_comment#8030] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#7995 AS rid_0#8004, cpfk_region_nation#7996 AS cpfk_region_nation_0#8005, cfpk_nation_region#7997 AS cfpk_nation_region_0#8006, cval_nation_n_name#7998 AS cval_nation_n_name_0#8007, cval_nation_n_comment#7999 AS cval_nation_n_comment_0#8008, cdepval_nation_n_name#8000 AS cdepval_nation_n_name_0#8009, cdepval_nation_n_comment#8001 AS cdepval_nation_n_comment_0#8010, cn_name#8002 AS cn_name_0#8011, cn_comment#8003 AS cn_comment_0#8012]
         :  :  :        +- Relation[rid#7995,cpfk_region_nation#7996,cfpk_nation_region#7997,cval_nation_n_name#7998,cval_nation_n_comment#7999,cdepval_nation_n_name#8000,cdepval_nation_n_comment#8001,cn_name#8002,cn_comment#8003] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#8139 AS rid_3#8164, cval_part_p_name#8140 AS cval_part_p_name_3#8165, cval_part_p_mfgr#8141 AS cval_part_p_mfgr_3#8166, cval_part_p_type#8142 AS cval_part_p_type_3#8167, cval_part_p_size#8143 AS cval_part_p_size_3#8168, cval_part_p_container#8144 AS cval_part_p_container_3#8169, cval_part_p_retailprice#8145 AS cval_part_p_retailprice_3#8170, cval_part_p_comment#8146 AS cval_part_p_comment_3#8171, cval_part_p_brand#8147 AS cval_part_p_brand_3#8172, cdepval_part_p_name#8148 AS cdepval_part_p_name_3#8173, cdepval_part_p_mfgr#8149 AS cdepval_part_p_mfgr_3#8174, cdepval_part_p_type#8150 AS cdepval_part_p_type_3#8175, cdepval_part_p_size#8151 AS cdepval_part_p_size_3#8176, cdepval_part_p_container#8152 AS cdepval_part_p_container_3#8177, cdepval_part_p_retailprice#8153 AS cdepval_part_p_retailprice_3#8178, cdepval_part_p_comment#8154 AS cdepval_part_p_comment_3#8179, cdepval_part_p_brand#8155 AS cdepval_part_p_brand_3#8180, cp_name#8156 AS cp_name_3#8181, cp_mfgr#8157 AS cp_mfgr_3#8182, cp_type#8158 AS cp_type_3#8183, cp_size#8159 AS cp_size_3#8184, cp_container#8160 AS cp_container_3#8185, cp_retailprice#8161 AS cp_retailprice_3#8186, cp_comment#8162 AS cp_comment_3#8187, cp_brand#8163 AS cp_brand_3#8188]
         :  :     +- Relation[rid#8139,cval_part_p_name#8140,cval_part_p_mfgr#8141,cval_part_p_type#8142,cval_part_p_size#8143,cval_part_p_container#8144,cval_part_p_retailprice#8145,cval_part_p_comment#8146,cval_part_p_brand#8147,cdepval_part_p_name#8148,cdepval_part_p_mfgr#8149,cdepval_part_p_type#8150,cdepval_part_p_size#8151,cdepval_part_p_container#8152,cdepval_part_p_retailprice#8153,cdepval_part_p_comment#8154,cdepval_part_p_brand#8155,cp_name#8156,cp_mfgr#8157,cp_type#8158,cp_size#8159,cp_container#8160,cp_retailprice#8161,cp_comment#8162,cp_brand#8163] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#8189 AS rid_4#8203, cpfk_part_partsupp#8190 AS cpfk_part_partsupp_4#8204, cfpk_partsupp_part#8191 AS cfpk_partsupp_part_4#8205, cpfk_supplier_partsupp#8192 AS cpfk_supplier_partsupp_4#8206, cfpk_partsupp_supplier#8193 AS cfpk_partsupp_supplier_4#8207, cval_partsupp_ps_availqty#8194 AS cval_partsupp_ps_availqty_4#8208, cval_partsupp_ps_supplycost#8195 AS cval_partsupp_ps_supplycost_4#8209, cval_partsupp_ps_comment#8196 AS cval_partsupp_ps_comment_4#8210, cdepval_partsupp_ps_availqty#8197 AS cdepval_partsupp_ps_availqty_4#8211, cdepval_partsupp_ps_supplycost#8198 AS cdepval_partsupp_ps_supplycost_4#8212, cdepval_partsupp_ps_comment#8199 AS cdepval_partsupp_ps_comment_4#8213, cps_availqty#8200 AS cps_availqty_4#8214, cps_supplycost#8201 AS cps_supplycost_4#8215, cps_comment#8202 AS cps_comment_4#8216]
         :     +- Relation[rid#8189,cpfk_part_partsupp#8190,cfpk_partsupp_part#8191,cpfk_supplier_partsupp#8192,cfpk_partsupp_supplier#8193,cval_partsupp_ps_availqty#8194,cval_partsupp_ps_supplycost#8195,cval_partsupp_ps_comment#8196,cdepval_partsupp_ps_availqty#8197,cdepval_partsupp_ps_supplycost#8198,cdepval_partsupp_ps_comment#8199,cps_availqty#8200,cps_supplycost#8201,cps_comment#8202] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#8217 AS rid_5#8241, cpfk_customer_orders#8218 AS cpfk_customer_orders_5#8242, cfpk_orders_customer#8219 AS cfpk_orders_customer_5#8243, cval_orders_o_orderstatus#8220 AS cval_orders_o_orderstatus_5#8244, cval_orders_o_totalprice#8221 AS cval_orders_o_totalprice_5#8245, cval_orders_o_orderpriority#8222 AS cval_orders_o_orderpriority_5#8246, cval_orders_o_clerk#8223 AS cval_orders_o_clerk_5#8247, cval_orders_o_shippriority#8224 AS cval_orders_o_shippriority_5#8248, cval_orders_o_comment#8225 AS cval_orders_o_comment_5#8249, cval_orders_o_orderdate#8226 AS cval_orders_o_orderdate_5#8250, cdepval_orders_o_orderstatus#8227 AS cdepval_orders_o_orderstatus_5#8251, cdepval_orders_o_totalprice#8228 AS cdepval_orders_o_totalprice_5#8252, cdepval_orders_o_orderpriority#8229 AS cdepval_orders_o_orderpriority_5#8253, cdepval_orders_o_clerk#8230 AS cdepval_orders_o_clerk_5#8254, cdepval_orders_o_shippriority#8231 AS cdepval_orders_o_shippriority_5#8255, cdepval_orders_o_comment#8232 AS cdepval_orders_o_comment_5#8256, cdepval_orders_o_orderdate#8233 AS cdepval_orders_o_orderdate_5#8257, co_orderstatus#8234 AS co_orderstatus_5#8258, co_totalprice#8235 AS co_totalprice_5#8259, co_orderpriority#8236 AS co_orderpriority_5#8260, co_clerk#8237 AS co_clerk_5#8261, co_shippriority#8238 AS co_shippriority_5#8262, co_comment#8239 AS co_comment_5#8263, co_orderdate#8240 AS co_orderdate_5#8264]
            +- Relation[rid#8217,cpfk_customer_orders#8218,cfpk_orders_customer#8219,cval_orders_o_orderstatus#8220,cval_orders_o_totalprice#8221,cval_orders_o_orderpriority#8222,cval_orders_o_clerk#8223,cval_orders_o_shippriority#8224,cval_orders_o_comment#8225,cval_orders_o_orderdate#8226,cdepval_orders_o_orderstatus#8227,cdepval_orders_o_totalprice#8228,cdepval_orders_o_orderpriority#8229,cdepval_orders_o_clerk#8230,cdepval_orders_o_shippriority#8231,cdepval_orders_o_comment#8232,cdepval_orders_o_orderdate#8233,co_orderstatus#8234,co_totalprice#8235,co_orderpriority#8236,co_clerk#8237,co_shippriority#8238,co_comment#8239,co_orderdate#8240] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 63264ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/26 22:06:40 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:06:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8405L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 22:06:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8405L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#8407 AS rid_0#8431, cpfk_customer_orders#8408 AS cpfk_customer_orders_0#8432, cfpk_orders_customer#8409 AS cfpk_orders_customer_0#8433, cval_orders_o_orderstatus#8410 AS cval_orders_o_orderstatus_0#8434, cval_orders_o_totalprice#8411 AS cval_orders_o_totalprice_0#8435, cval_orders_o_orderpriority#8412 AS cval_orders_o_orderpriority_0#8436, cval_orders_o_clerk#8413 AS cval_orders_o_clerk_0#8437, cval_orders_o_shippriority#8414 AS cval_orders_o_shippriority_0#8438, cval_orders_o_comment#8415 AS cval_orders_o_comment_0#8439, cval_orders_o_orderdate#8416 AS cval_orders_o_orderdate_0#8440, cdepval_orders_o_orderstatus#8417 AS cdepval_orders_o_orderstatus_0#8441, cdepval_orders_o_totalprice#8418 AS cdepval_orders_o_totalprice_0#8442, cdepval_orders_o_orderpriority#8419 AS cdepval_orders_o_orderpriority_0#8443, cdepval_orders_o_clerk#8420 AS cdepval_orders_o_clerk_0#8444, cdepval_orders_o_shippriority#8421 AS cdepval_orders_o_shippriority_0#8445, cdepval_orders_o_comment#8422 AS cdepval_orders_o_comment_0#8446, cdepval_orders_o_orderdate#8423 AS cdepval_orders_o_orderdate_0#8447, co_orderstatus#8424 AS co_orderstatus_0#8448, co_totalprice#8425 AS co_totalprice_0#8449, co_orderpriority#8426 AS co_orderpriority_0#8450, co_clerk#8427 AS co_clerk_0#8451, co_shippriority#8428 AS co_shippriority_0#8452, co_comment#8429 AS co_comment_0#8453, co_orderdate#8430 AS co_orderdate_0#8454]
         :  +- Relation[rid#8407,cpfk_customer_orders#8408,cfpk_orders_customer#8409,cval_orders_o_orderstatus#8410,cval_orders_o_totalprice#8411,cval_orders_o_orderpriority#8412,cval_orders_o_clerk#8413,cval_orders_o_shippriority#8414,cval_orders_o_comment#8415,cval_orders_o_orderdate#8416,cdepval_orders_o_orderstatus#8417,cdepval_orders_o_totalprice#8418,cdepval_orders_o_orderpriority#8419,cdepval_orders_o_clerk#8420,cdepval_orders_o_shippriority#8421,cdepval_orders_o_comment#8422,cdepval_orders_o_orderdate#8423,co_orderstatus#8424,co_totalprice#8425,co_orderpriority#8426,co_clerk#8427,co_shippriority#8428,co_comment#8429,co_orderdate#8430] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#8455 AS rid_1#8476, cpfk_nation_customer#8456 AS cpfk_nation_customer_1#8477, cfpk_customer_nation#8457 AS cfpk_customer_nation_1#8478, cval_customer_c_name#8458 AS cval_customer_c_name_1#8479, cval_customer_c_address#8459 AS cval_customer_c_address_1#8480, cval_customer_c_phone#8460 AS cval_customer_c_phone_1#8481, cval_customer_c_acctbal#8461 AS cval_customer_c_acctbal_1#8482, cval_customer_c_comment#8462 AS cval_customer_c_comment_1#8483, cval_customer_c_mktsegment#8463 AS cval_customer_c_mktsegment_1#8484, cdepval_customer_c_name#8464 AS cdepval_customer_c_name_1#8485, cdepval_customer_c_address#8465 AS cdepval_customer_c_address_1#8486, cdepval_customer_c_phone#8466 AS cdepval_customer_c_phone_1#8487, cdepval_customer_c_acctbal#8467 AS cdepval_customer_c_acctbal_1#8488, cdepval_customer_c_comment#8468 AS cdepval_customer_c_comment_1#8489, cdepval_customer_c_mktsegment#8469 AS cdepval_customer_c_mktsegment_1#8490, cc_name#8470 AS cc_name_1#8491, cc_address#8471 AS cc_address_1#8492, cc_phone#8472 AS cc_phone_1#8493, cc_acctbal#8473 AS cc_acctbal_1#8494, cc_comment#8474 AS cc_comment_1#8495, cc_mktsegment#8475 AS cc_mktsegment_1#8496]
            +- Relation[rid#8455,cpfk_nation_customer#8456,cfpk_customer_nation#8457,cval_customer_c_name#8458,cval_customer_c_address#8459,cval_customer_c_phone#8460,cval_customer_c_acctbal#8461,cval_customer_c_comment#8462,cval_customer_c_mktsegment#8463,cdepval_customer_c_name#8464,cdepval_customer_c_address#8465,cdepval_customer_c_phone#8466,cdepval_customer_c_acctbal#8467,cdepval_customer_c_comment#8468,cdepval_customer_c_mktsegment#8469,cc_name#8470,cc_address#8471,cc_phone#8472,cc_acctbal#8473,cc_comment#8474,cc_mktsegment#8475] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4388ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/26 22:06:44 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:06:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8554L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 22:06:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:06:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:06:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8554L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#8556 AS rid_0#8601, cpfk_orders_lineitem#8557 AS cpfk_orders_lineitem_0#8602, cpfk_supplier_lineitem#8558 AS cpfk_supplier_lineitem_0#8603, cfpk_lineitem_supplier#8559 AS cfpk_lineitem_supplier_0#8604, cfpk_lineitem_partsupp#8560 AS cfpk_lineitem_partsupp_0#8605, cpfk_part_lineitem#8561 AS cpfk_part_lineitem_0#8606, cfpk_lineitem_part#8562 AS cfpk_lineitem_part_0#8607, cpfk_partsupp_lineitem#8563 AS cpfk_partsupp_lineitem_0#8608, cfpk_lineitem_orders#8564 AS cfpk_lineitem_orders_0#8609, cval_lineitem_l_quantity#8565 AS cval_lineitem_l_quantity_0#8610, cval_lineitem_l_extendedprice#8566 AS cval_lineitem_l_extendedprice_0#8611, cval_lineitem_l_discount#8567 AS cval_lineitem_l_discount_0#8612, cval_lineitem_l_tax#8568 AS cval_lineitem_l_tax_0#8613, cval_lineitem_l_returnflag#8569 AS cval_lineitem_l_returnflag_0#8614, cval_lineitem_l_linestatus#8570 AS cval_lineitem_l_linestatus_0#8615, cval_lineitem_l_commitdate#8571 AS cval_lineitem_l_commitdate_0#8616, cval_lineitem_l_receiptdate#8572 AS cval_lineitem_l_receiptdate_0#8617, cval_lineitem_l_shipinstruct#8573 AS cval_lineitem_l_shipinstruct_0#8618, cval_lineitem_l_shipmode#8574 AS cval_lineitem_l_shipmode_0#8619, cval_lineitem_l_comment#8575 AS cval_lineitem_l_comment_0#8620, cval_lineitem_l_shipdate#8576 AS cval_lineitem_l_shipdate_0#8621, cdepval_lineitem_l_quantity#8577 AS cdepval_lineitem_l_quantity_0#8622, cdepval_lineitem_l_extendedprice#8578 AS cdepval_lineitem_l_extendedprice_0#8623, cdepval_lineitem_l_discount#8579 AS cdepval_lineitem_l_discount_0#8624, ... 21 more fields]
         :  :  :     +- Relation[rid#8556,cpfk_orders_lineitem#8557,cpfk_supplier_lineitem#8558,cfpk_lineitem_supplier#8559,cfpk_lineitem_partsupp#8560,cpfk_part_lineitem#8561,cfpk_lineitem_part#8562,cpfk_partsupp_lineitem#8563,cfpk_lineitem_orders#8564,cval_lineitem_l_quantity#8565,cval_lineitem_l_extendedprice#8566,cval_lineitem_l_discount#8567,cval_lineitem_l_tax#8568,cval_lineitem_l_returnflag#8569,cval_lineitem_l_linestatus#8570,cval_lineitem_l_commitdate#8571,cval_lineitem_l_receiptdate#8572,cval_lineitem_l_shipinstruct#8573,cval_lineitem_l_shipmode#8574,cval_lineitem_l_comment#8575,cval_lineitem_l_shipdate#8576,cdepval_lineitem_l_quantity#8577,cdepval_lineitem_l_extendedprice#8578,cdepval_lineitem_l_discount#8579,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#8736 AS rid_1#8760, cpfk_customer_orders#8737 AS cpfk_customer_orders_1#8761, cfpk_orders_customer#8738 AS cfpk_orders_customer_1#8762, cval_orders_o_orderstatus#8739 AS cval_orders_o_orderstatus_1#8763, cval_orders_o_totalprice#8740 AS cval_orders_o_totalprice_1#8764, cval_orders_o_orderpriority#8741 AS cval_orders_o_orderpriority_1#8765, cval_orders_o_clerk#8742 AS cval_orders_o_clerk_1#8766, cval_orders_o_shippriority#8743 AS cval_orders_o_shippriority_1#8767, cval_orders_o_comment#8744 AS cval_orders_o_comment_1#8768, cval_orders_o_orderdate#8745 AS cval_orders_o_orderdate_1#8769, cdepval_orders_o_orderstatus#8746 AS cdepval_orders_o_orderstatus_1#8770, cdepval_orders_o_totalprice#8747 AS cdepval_orders_o_totalprice_1#8771, cdepval_orders_o_orderpriority#8748 AS cdepval_orders_o_orderpriority_1#8772, cdepval_orders_o_clerk#8749 AS cdepval_orders_o_clerk_1#8773, cdepval_orders_o_shippriority#8750 AS cdepval_orders_o_shippriority_1#8774, cdepval_orders_o_comment#8751 AS cdepval_orders_o_comment_1#8775, cdepval_orders_o_orderdate#8752 AS cdepval_orders_o_orderdate_1#8776, co_orderstatus#8753 AS co_orderstatus_1#8777, co_totalprice#8754 AS co_totalprice_1#8778, co_orderpriority#8755 AS co_orderpriority_1#8779, co_clerk#8756 AS co_clerk_1#8780, co_shippriority#8757 AS co_shippriority_1#8781, co_comment#8758 AS co_comment_1#8782, co_orderdate#8759 AS co_orderdate_1#8783]
         :  :     +- Relation[rid#8736,cpfk_customer_orders#8737,cfpk_orders_customer#8738,cval_orders_o_orderstatus#8739,cval_orders_o_totalprice#8740,cval_orders_o_orderpriority#8741,cval_orders_o_clerk#8742,cval_orders_o_shippriority#8743,cval_orders_o_comment#8744,cval_orders_o_orderdate#8745,cdepval_orders_o_orderstatus#8746,cdepval_orders_o_totalprice#8747,cdepval_orders_o_orderpriority#8748,cdepval_orders_o_clerk#8749,cdepval_orders_o_shippriority#8750,cdepval_orders_o_comment#8751,cdepval_orders_o_orderdate#8752,co_orderstatus#8753,co_totalprice#8754,co_orderpriority#8755,co_clerk#8756,co_shippriority#8757,co_comment#8758,co_orderdate#8759] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#8784 AS rid_2#8805, cpfk_nation_customer#8785 AS cpfk_nation_customer_2#8806, cfpk_customer_nation#8786 AS cfpk_customer_nation_2#8807, cval_customer_c_name#8787 AS cval_customer_c_name_2#8808, cval_customer_c_address#8788 AS cval_customer_c_address_2#8809, cval_customer_c_phone#8789 AS cval_customer_c_phone_2#8810, cval_customer_c_acctbal#8790 AS cval_customer_c_acctbal_2#8811, cval_customer_c_comment#8791 AS cval_customer_c_comment_2#8812, cval_customer_c_mktsegment#8792 AS cval_customer_c_mktsegment_2#8813, cdepval_customer_c_name#8793 AS cdepval_customer_c_name_2#8814, cdepval_customer_c_address#8794 AS cdepval_customer_c_address_2#8815, cdepval_customer_c_phone#8795 AS cdepval_customer_c_phone_2#8816, cdepval_customer_c_acctbal#8796 AS cdepval_customer_c_acctbal_2#8817, cdepval_customer_c_comment#8797 AS cdepval_customer_c_comment_2#8818, cdepval_customer_c_mktsegment#8798 AS cdepval_customer_c_mktsegment_2#8819, cc_name#8799 AS cc_name_2#8820, cc_address#8800 AS cc_address_2#8821, cc_phone#8801 AS cc_phone_2#8822, cc_acctbal#8802 AS cc_acctbal_2#8823, cc_comment#8803 AS cc_comment_2#8824, cc_mktsegment#8804 AS cc_mktsegment_2#8825]
         :     +- Relation[rid#8784,cpfk_nation_customer#8785,cfpk_customer_nation#8786,cval_customer_c_name#8787,cval_customer_c_address#8788,cval_customer_c_phone#8789,cval_customer_c_acctbal#8790,cval_customer_c_comment#8791,cval_customer_c_mktsegment#8792,cdepval_customer_c_name#8793,cdepval_customer_c_address#8794,cdepval_customer_c_phone#8795,cdepval_customer_c_acctbal#8796,cdepval_customer_c_comment#8797,cdepval_customer_c_mktsegment#8798,cc_name#8799,cc_address#8800,cc_phone#8801,cc_acctbal#8802,cc_comment#8803,cc_mktsegment#8804] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#8826 AS rid_3#8835, cpfk_region_nation#8827 AS cpfk_region_nation_3#8836, cfpk_nation_region#8828 AS cfpk_nation_region_3#8837, cval_nation_n_name#8829 AS cval_nation_n_name_3#8838, cval_nation_n_comment#8830 AS cval_nation_n_comment_3#8839, cdepval_nation_n_name#8831 AS cdepval_nation_n_name_3#8840, cdepval_nation_n_comment#8832 AS cdepval_nation_n_comment_3#8841, cn_name#8833 AS cn_name_3#8842, cn_comment#8834 AS cn_comment_3#8843]
            +- Relation[rid#8826,cpfk_region_nation#8827,cfpk_nation_region#8828,cval_nation_n_name#8829,cval_nation_n_comment#8830,cdepval_nation_n_name#8831,cdepval_nation_n_comment#8832,cn_name#8833,cn_comment#8834] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 60954ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/26 22:07:45 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:07:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8949L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 22:07:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:07:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:07:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:07:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:07:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:07:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:07:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:07:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:07:45 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:07:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:07:45 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:07:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8949L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#9077 AS rid_2#9091, cpfk_part_partsupp#9078 AS cpfk_part_partsupp_2#9092, cfpk_partsupp_part#9079 AS cfpk_partsupp_part_2#9093, cpfk_supplier_partsupp#9080 AS cpfk_supplier_partsupp_2#9094, cfpk_partsupp_supplier#9081 AS cfpk_partsupp_supplier_2#9095, cval_partsupp_ps_availqty#9082 AS cval_partsupp_ps_availqty_2#9096, cval_partsupp_ps_supplycost#9083 AS cval_partsupp_ps_supplycost_2#9097, cval_partsupp_ps_comment#9084 AS cval_partsupp_ps_comment_2#9098, cdepval_partsupp_ps_availqty#9085 AS cdepval_partsupp_ps_availqty_2#9099, cdepval_partsupp_ps_supplycost#9086 AS cdepval_partsupp_ps_supplycost_2#9100, cdepval_partsupp_ps_comment#9087 AS cdepval_partsupp_ps_comment_2#9101, cps_availqty#9088 AS cps_availqty_2#9102, cps_supplycost#9089 AS cps_supplycost_2#9103, cps_comment#9090 AS cps_comment_2#9104]
         :  +- Relation[rid#9077,cpfk_part_partsupp#9078,cfpk_partsupp_part#9079,cpfk_supplier_partsupp#9080,cfpk_partsupp_supplier#9081,cval_partsupp_ps_availqty#9082,cval_partsupp_ps_supplycost#9083,cval_partsupp_ps_comment#9084,cdepval_partsupp_ps_availqty#9085,cdepval_partsupp_ps_supplycost#9086,cdepval_partsupp_ps_comment#9087,cps_availqty#9088,cps_supplycost#9089,cps_comment#9090] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#8960, cpfk_region_nation_0#8961, cfpk_nation_region_0#8962, cval_nation_n_name_0#8963, cval_nation_n_comment_0#8964, cdepval_nation_n_name_0#8965, cdepval_nation_n_comment_0#8966, cn_name_0#8967, cn_comment_0#8968, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
            :  :  +- Project [rid#8951 AS rid_0#8960, cpfk_region_nation#8952 AS cpfk_region_nation_0#8961, cfpk_nation_region#8953 AS cfpk_nation_region_0#8962, cval_nation_n_name#8954 AS cval_nation_n_name_0#8963, cval_nation_n_comment#8955 AS cval_nation_n_comment_0#8964, cdepval_nation_n_name#8956 AS cdepval_nation_n_name_0#8965, cdepval_nation_n_comment#8957 AS cdepval_nation_n_comment_0#8966, cn_name#8958 AS cn_name_0#8967, cn_comment#8959 AS cn_comment_0#8968]
            :  :     +- Relation[rid#8951,cpfk_region_nation#8952,cfpk_nation_region#8953,cval_nation_n_name#8954,cval_nation_n_comment#8955,cdepval_nation_n_name#8956,cdepval_nation_n_comment#8957,cn_name#8958,cn_comment#8959] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
            :     +- Project [rid#9041 AS rid_1#9059, cpfk_nation_supplier#9042 AS cpfk_nation_supplier_1#9060, cfpk_supplier_nation#9043 AS cfpk_supplier_nation_1#9061, cval_supplier_s_name#9044 AS cval_supplier_s_name_1#9062, cval_supplier_s_address#9045 AS cval_supplier_s_address_1#9063, cval_supplier_s_phone#9046 AS cval_supplier_s_phone_1#9064, cval_supplier_s_acctbal#9047 AS cval_supplier_s_acctbal_1#9065, cval_supplier_s_comment#9048 AS cval_supplier_s_comment_1#9066, cdepval_supplier_s_name#9049 AS cdepval_supplier_s_name_1#9067, cdepval_supplier_s_address#9050 AS cdepval_supplier_s_address_1#9068, cdepval_supplier_s_phone#9051 AS cdepval_supplier_s_phone_1#9069, cdepval_supplier_s_acctbal#9052 AS cdepval_supplier_s_acctbal_1#9070, cdepval_supplier_s_comment#9053 AS cdepval_supplier_s_comment_1#9071, cs_name#9054 AS cs_name_1#9072, cs_address#9055 AS cs_address_1#9073, cs_phone#9056 AS cs_phone_1#9074, cs_acctbal#9057 AS cs_acctbal_1#9075, cs_comment#9058 AS cs_comment_1#9076]
            :        +- Relation[rid#9041,cpfk_nation_supplier#9042,cfpk_supplier_nation#9043,cval_supplier_s_name#9044,cval_supplier_s_address#9045,cval_supplier_s_phone#9046,cval_supplier_s_acctbal#9047,cval_supplier_s_comment#9048,cdepval_supplier_s_name#9049,cdepval_supplier_s_address#9050,cdepval_supplier_s_phone#9051,cdepval_supplier_s_acctbal#9052,cdepval_supplier_s_comment#9053,cs_name#9054,cs_address#9055,cs_phone#9056,cs_acctbal#9057,cs_comment#9058] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#8987 AS rid_1#9005, cpfk_nation_supplier#8988 AS cpfk_nation_supplier_1#9006, cfpk_supplier_nation#8989 AS cfpk_supplier_nation_1#9007, cval_supplier_s_name#8990 AS cval_supplier_s_name_1#9008, cval_supplier_s_address#8991 AS cval_supplier_s_address_1#9009, cval_supplier_s_phone#8992 AS cval_supplier_s_phone_1#9010, cval_supplier_s_acctbal#8993 AS cval_supplier_s_acctbal_1#9011, cval_supplier_s_comment#8994 AS cval_supplier_s_comment_1#9012, cdepval_supplier_s_name#8995 AS cdepval_supplier_s_name_1#9013, cdepval_supplier_s_address#8996 AS cdepval_supplier_s_address_1#9014, cdepval_supplier_s_phone#8997 AS cdepval_supplier_s_phone_1#9015, cdepval_supplier_s_acctbal#8998 AS cdepval_supplier_s_acctbal_1#9016, cdepval_supplier_s_comment#8999 AS cdepval_supplier_s_comment_1#9017, cs_name#9000 AS cs_name_1#9018, cs_address#9001 AS cs_address_1#9019, cs_phone#9002 AS cs_phone_1#9020, cs_acctbal#9003 AS cs_acctbal_1#9021, cs_comment#9004 AS cs_comment_1#9022]
               +- Relation[rid#8987,cpfk_nation_supplier#8988,cfpk_supplier_nation#8989,cval_supplier_s_name#8990,cval_supplier_s_address#8991,cval_supplier_s_phone#8992,cval_supplier_s_acctbal#8993,cval_supplier_s_comment#8994,cdepval_supplier_s_name#8995,cdepval_supplier_s_address#8996,cdepval_supplier_s_phone#8997,cdepval_supplier_s_acctbal#8998,cdepval_supplier_s_comment#8999,cs_name#9000,cs_address#9001,cs_phone#9002,cs_acctbal#9003,cs_comment#9004] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 2473ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/26 22:07:47 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:07:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9151L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:07:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#9151L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#9153 AS rid_0#9198, cpfk_orders_lineitem#9154 AS cpfk_orders_lineitem_0#9199, cpfk_supplier_lineitem#9155 AS cpfk_supplier_lineitem_0#9200, cfpk_lineitem_supplier#9156 AS cfpk_lineitem_supplier_0#9201, cfpk_lineitem_partsupp#9157 AS cfpk_lineitem_partsupp_0#9202, cpfk_part_lineitem#9158 AS cpfk_part_lineitem_0#9203, cfpk_lineitem_part#9159 AS cfpk_lineitem_part_0#9204, cpfk_partsupp_lineitem#9160 AS cpfk_partsupp_lineitem_0#9205, cfpk_lineitem_orders#9161 AS cfpk_lineitem_orders_0#9206, cval_lineitem_l_quantity#9162 AS cval_lineitem_l_quantity_0#9207, cval_lineitem_l_extendedprice#9163 AS cval_lineitem_l_extendedprice_0#9208, cval_lineitem_l_discount#9164 AS cval_lineitem_l_discount_0#9209, cval_lineitem_l_tax#9165 AS cval_lineitem_l_tax_0#9210, cval_lineitem_l_returnflag#9166 AS cval_lineitem_l_returnflag_0#9211, cval_lineitem_l_linestatus#9167 AS cval_lineitem_l_linestatus_0#9212, cval_lineitem_l_commitdate#9168 AS cval_lineitem_l_commitdate_0#9213, cval_lineitem_l_receiptdate#9169 AS cval_lineitem_l_receiptdate_0#9214, cval_lineitem_l_shipinstruct#9170 AS cval_lineitem_l_shipinstruct_0#9215, cval_lineitem_l_shipmode#9171 AS cval_lineitem_l_shipmode_0#9216, cval_lineitem_l_comment#9172 AS cval_lineitem_l_comment_0#9217, cval_lineitem_l_shipdate#9173 AS cval_lineitem_l_shipdate_0#9218, cdepval_lineitem_l_quantity#9174 AS cdepval_lineitem_l_quantity_0#9219, cdepval_lineitem_l_extendedprice#9175 AS cdepval_lineitem_l_extendedprice_0#9220, cdepval_lineitem_l_discount#9176 AS cdepval_lineitem_l_discount_0#9221, ... 21 more fields]
         +- Relation[rid#9153,cpfk_orders_lineitem#9154,cpfk_supplier_lineitem#9155,cfpk_lineitem_supplier#9156,cfpk_lineitem_partsupp#9157,cpfk_part_lineitem#9158,cfpk_lineitem_part#9159,cpfk_partsupp_lineitem#9160,cfpk_lineitem_orders#9161,cval_lineitem_l_quantity#9162,cval_lineitem_l_extendedprice#9163,cval_lineitem_l_discount#9164,cval_lineitem_l_tax#9165,cval_lineitem_l_returnflag#9166,cval_lineitem_l_linestatus#9167,cval_lineitem_l_commitdate#9168,cval_lineitem_l_receiptdate#9169,cval_lineitem_l_shipinstruct#9170,cval_lineitem_l_shipmode#9171,cval_lineitem_l_comment#9172,cval_lineitem_l_shipdate#9173,cdepval_lineitem_l_quantity#9174,cdepval_lineitem_l_extendedprice#9175,cdepval_lineitem_l_discount#9176,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2373ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/26 22:07:50 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:07:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9293L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 22:07:50 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:07:50 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:07:50 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:07:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:07:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:07:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:07:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:07:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:07:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:07:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:07:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:07:50 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:07:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:07:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9293L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#9320, cval_part_p_name_0#9321, cval_part_p_mfgr_0#9322, cval_part_p_type_0#9323, cval_part_p_size_0#9324, cval_part_p_container_0#9325, cval_part_p_retailprice_0#9326, cval_part_p_comment_0#9327, cval_part_p_brand_0#9328, cdepval_part_p_name_0#9329, cdepval_part_p_mfgr_0#9330, cdepval_part_p_type_0#9331, cdepval_part_p_size_0#9332, cdepval_part_p_container_0#9333, cdepval_part_p_retailprice_0#9334, cdepval_part_p_comment_0#9335, cdepval_part_p_brand_0#9336, cp_name_0#9337, cp_mfgr_0#9338, cp_type_0#9339, cp_size_0#9340, cp_container_0#9341, cp_retailprice_0#9342, cp_comment_0#9343, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  :  +- Project [rid#9295 AS rid_0#9320, cval_part_p_name#9296 AS cval_part_p_name_0#9321, cval_part_p_mfgr#9297 AS cval_part_p_mfgr_0#9322, cval_part_p_type#9298 AS cval_part_p_type_0#9323, cval_part_p_size#9299 AS cval_part_p_size_0#9324, cval_part_p_container#9300 AS cval_part_p_container_0#9325, cval_part_p_retailprice#9301 AS cval_part_p_retailprice_0#9326, cval_part_p_comment#9302 AS cval_part_p_comment_0#9327, cval_part_p_brand#9303 AS cval_part_p_brand_0#9328, cdepval_part_p_name#9304 AS cdepval_part_p_name_0#9329, cdepval_part_p_mfgr#9305 AS cdepval_part_p_mfgr_0#9330, cdepval_part_p_type#9306 AS cdepval_part_p_type_0#9331, cdepval_part_p_size#9307 AS cdepval_part_p_size_0#9332, cdepval_part_p_container#9308 AS cdepval_part_p_container_0#9333, cdepval_part_p_retailprice#9309 AS cdepval_part_p_retailprice_0#9334, cdepval_part_p_comment#9310 AS cdepval_part_p_comment_0#9335, cdepval_part_p_brand#9311 AS cdepval_part_p_brand_0#9336, cp_name#9312 AS cp_name_0#9337, cp_mfgr#9313 AS cp_mfgr_0#9338, cp_type#9314 AS cp_type_0#9339, cp_size#9315 AS cp_size_0#9340, cp_container#9316 AS cp_container_0#9341, cp_retailprice#9317 AS cp_retailprice_0#9342, cp_comment#9318 AS cp_comment_0#9343, cp_brand#9319 AS cp_brand_0#9344]
         :  :  :     +- Relation[rid#9295,cval_part_p_name#9296,cval_part_p_mfgr#9297,cval_part_p_type#9298,cval_part_p_size#9299,cval_part_p_container#9300,cval_part_p_retailprice#9301,cval_part_p_comment#9302,cval_part_p_brand#9303,cdepval_part_p_name#9304,cdepval_part_p_mfgr#9305,cdepval_part_p_type#9306,cdepval_part_p_size#9307,cdepval_part_p_container#9308,cdepval_part_p_retailprice#9309,cdepval_part_p_comment#9310,cdepval_part_p_brand#9311,cp_name#9312,cp_mfgr#9313,cp_type#9314,cp_size#9315,cp_container#9316,cp_retailprice#9317,cp_comment#9318,cp_brand#9319] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :  :     +- Project [rid#9473 AS rid_1#9487, cpfk_part_partsupp#9474 AS cpfk_part_partsupp_1#9488, cfpk_partsupp_part#9475 AS cfpk_partsupp_part_1#9489, cpfk_supplier_partsupp#9476 AS cpfk_supplier_partsupp_1#9490, cfpk_partsupp_supplier#9477 AS cfpk_partsupp_supplier_1#9491, cval_partsupp_ps_availqty#9478 AS cval_partsupp_ps_availqty_1#9492, cval_partsupp_ps_supplycost#9479 AS cval_partsupp_ps_supplycost_1#9493, cval_partsupp_ps_comment#9480 AS cval_partsupp_ps_comment_1#9494, cdepval_partsupp_ps_availqty#9481 AS cdepval_partsupp_ps_availqty_1#9495, cdepval_partsupp_ps_supplycost#9482 AS cdepval_partsupp_ps_supplycost_1#9496, cdepval_partsupp_ps_comment#9483 AS cdepval_partsupp_ps_comment_1#9497, cps_availqty#9484 AS cps_availqty_1#9498, cps_supplycost#9485 AS cps_supplycost_1#9499, cps_comment#9486 AS cps_comment_1#9500]
         :  :        +- Relation[rid#9473,cpfk_part_partsupp#9474,cfpk_partsupp_part#9475,cpfk_supplier_partsupp#9476,cfpk_partsupp_supplier#9477,cval_partsupp_ps_availqty#9478,cval_partsupp_ps_supplycost#9479,cval_partsupp_ps_comment#9480,cdepval_partsupp_ps_availqty#9481,cdepval_partsupp_ps_supplycost#9482,cdepval_partsupp_ps_comment#9483,cps_availqty#9484,cps_supplycost#9485,cps_comment#9486] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#9395 AS rid_1#9409, cpfk_part_partsupp#9396 AS cpfk_part_partsupp_1#9410, cfpk_partsupp_part#9397 AS cfpk_partsupp_part_1#9411, cpfk_supplier_partsupp#9398 AS cpfk_supplier_partsupp_1#9412, cfpk_partsupp_supplier#9399 AS cfpk_partsupp_supplier_1#9413, cval_partsupp_ps_availqty#9400 AS cval_partsupp_ps_availqty_1#9414, cval_partsupp_ps_supplycost#9401 AS cval_partsupp_ps_supplycost_1#9415, cval_partsupp_ps_comment#9402 AS cval_partsupp_ps_comment_1#9416, cdepval_partsupp_ps_availqty#9403 AS cdepval_partsupp_ps_availqty_1#9417, cdepval_partsupp_ps_supplycost#9404 AS cdepval_partsupp_ps_supplycost_1#9418, cdepval_partsupp_ps_comment#9405 AS cdepval_partsupp_ps_comment_1#9419, cps_availqty#9406 AS cps_availqty_1#9420, cps_supplycost#9407 AS cps_supplycost_1#9421, cps_comment#9408 AS cps_comment_1#9422]
         :     +- Relation[rid#9395,cpfk_part_partsupp#9396,cfpk_partsupp_part#9397,cpfk_supplier_partsupp#9398,cfpk_partsupp_supplier#9399,cval_partsupp_ps_availqty#9400,cval_partsupp_ps_supplycost#9401,cval_partsupp_ps_comment#9402,cdepval_partsupp_ps_availqty#9403,cdepval_partsupp_ps_supplycost#9404,cdepval_partsupp_ps_comment#9405,cps_availqty#9406,cps_supplycost#9407,cps_comment#9408] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_2, NotMaterialized, NotMaterialized, [rid_2#9510, cpfk_region_nation_2#9511, cfpk_nation_region_2#9512, cval_nation_n_name_2#9513, cval_nation_n_comment_2#9514, cdepval_nation_n_name_2#9515, cdepval_nation_n_comment_2#9516, cn_name_2#9517, cn_comment_2#9518, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
            :  :  +- Project [rid#9501 AS rid_2#9510, cpfk_region_nation#9502 AS cpfk_region_nation_2#9511, cfpk_nation_region#9503 AS cfpk_nation_region_2#9512, cval_nation_n_name#9504 AS cval_nation_n_name_2#9513, cval_nation_n_comment#9505 AS cval_nation_n_comment_2#9514, cdepval_nation_n_name#9506 AS cdepval_nation_n_name_2#9515, cdepval_nation_n_comment#9507 AS cdepval_nation_n_comment_2#9516, cn_name#9508 AS cn_name_2#9517, cn_comment#9509 AS cn_comment_2#9518]
            :  :     +- Relation[rid#9501,cpfk_region_nation#9502,cfpk_nation_region#9503,cval_nation_n_name#9504,cval_nation_n_comment#9505,cdepval_nation_n_name#9506,cdepval_nation_n_comment#9507,cn_name#9508,cn_comment#9509] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#9591 AS rid_3#9609, cpfk_nation_supplier#9592 AS cpfk_nation_supplier_3#9610, cfpk_supplier_nation#9593 AS cfpk_supplier_nation_3#9611, cval_supplier_s_name#9594 AS cval_supplier_s_name_3#9612, cval_supplier_s_address#9595 AS cval_supplier_s_address_3#9613, cval_supplier_s_phone#9596 AS cval_supplier_s_phone_3#9614, cval_supplier_s_acctbal#9597 AS cval_supplier_s_acctbal_3#9615, cval_supplier_s_comment#9598 AS cval_supplier_s_comment_3#9616, cdepval_supplier_s_name#9599 AS cdepval_supplier_s_name_3#9617, cdepval_supplier_s_address#9600 AS cdepval_supplier_s_address_3#9618, cdepval_supplier_s_phone#9601 AS cdepval_supplier_s_phone_3#9619, cdepval_supplier_s_acctbal#9602 AS cdepval_supplier_s_acctbal_3#9620, cdepval_supplier_s_comment#9603 AS cdepval_supplier_s_comment_3#9621, cs_name#9604 AS cs_name_3#9622, cs_address#9605 AS cs_address_3#9623, cs_phone#9606 AS cs_phone_3#9624, cs_acctbal#9607 AS cs_acctbal_3#9625, cs_comment#9608 AS cs_comment_3#9626]
            :        +- Relation[rid#9591,cpfk_nation_supplier#9592,cfpk_supplier_nation#9593,cval_supplier_s_name#9594,cval_supplier_s_address#9595,cval_supplier_s_phone#9596,cval_supplier_s_acctbal#9597,cval_supplier_s_comment#9598,cdepval_supplier_s_name#9599,cdepval_supplier_s_address#9600,cdepval_supplier_s_phone#9601,cdepval_supplier_s_acctbal#9602,cdepval_supplier_s_comment#9603,cs_name#9604,cs_address#9605,cs_phone#9606,cs_acctbal#9607,cs_comment#9608] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#9537 AS rid_3#9555, cpfk_nation_supplier#9538 AS cpfk_nation_supplier_3#9556, cfpk_supplier_nation#9539 AS cfpk_supplier_nation_3#9557, cval_supplier_s_name#9540 AS cval_supplier_s_name_3#9558, cval_supplier_s_address#9541 AS cval_supplier_s_address_3#9559, cval_supplier_s_phone#9542 AS cval_supplier_s_phone_3#9560, cval_supplier_s_acctbal#9543 AS cval_supplier_s_acctbal_3#9561, cval_supplier_s_comment#9544 AS cval_supplier_s_comment_3#9562, cdepval_supplier_s_name#9545 AS cdepval_supplier_s_name_3#9563, cdepval_supplier_s_address#9546 AS cdepval_supplier_s_address_3#9564, cdepval_supplier_s_phone#9547 AS cdepval_supplier_s_phone_3#9565, cdepval_supplier_s_acctbal#9548 AS cdepval_supplier_s_acctbal_3#9566, cdepval_supplier_s_comment#9549 AS cdepval_supplier_s_comment_3#9567, cs_name#9550 AS cs_name_3#9568, cs_address#9551 AS cs_address_3#9569, cs_phone#9552 AS cs_phone_3#9570, cs_acctbal#9553 AS cs_acctbal_3#9571, cs_comment#9554 AS cs_comment_3#9572]
               +- Relation[rid#9537,cpfk_nation_supplier#9538,cfpk_supplier_nation#9539,cval_supplier_s_name#9540,cval_supplier_s_address#9541,cval_supplier_s_phone#9542,cval_supplier_s_acctbal#9543,cval_supplier_s_comment#9544,cdepval_supplier_s_name#9545,cdepval_supplier_s_address#9546,cdepval_supplier_s_phone#9547,cdepval_supplier_s_acctbal#9548,cdepval_supplier_s_comment#9549,cs_name#9550,cs_address#9551,cs_phone#9552,cs_acctbal#9553,cs_comment#9554] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 826ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/26 22:07:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:07:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9698L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:07:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#9698L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#9700 AS rid_0#9745, cpfk_orders_lineitem#9701 AS cpfk_orders_lineitem_0#9746, cpfk_supplier_lineitem#9702 AS cpfk_supplier_lineitem_0#9747, cfpk_lineitem_supplier#9703 AS cfpk_lineitem_supplier_0#9748, cfpk_lineitem_partsupp#9704 AS cfpk_lineitem_partsupp_0#9749, cpfk_part_lineitem#9705 AS cpfk_part_lineitem_0#9750, cfpk_lineitem_part#9706 AS cfpk_lineitem_part_0#9751, cpfk_partsupp_lineitem#9707 AS cpfk_partsupp_lineitem_0#9752, cfpk_lineitem_orders#9708 AS cfpk_lineitem_orders_0#9753, cval_lineitem_l_quantity#9709 AS cval_lineitem_l_quantity_0#9754, cval_lineitem_l_extendedprice#9710 AS cval_lineitem_l_extendedprice_0#9755, cval_lineitem_l_discount#9711 AS cval_lineitem_l_discount_0#9756, cval_lineitem_l_tax#9712 AS cval_lineitem_l_tax_0#9757, cval_lineitem_l_returnflag#9713 AS cval_lineitem_l_returnflag_0#9758, cval_lineitem_l_linestatus#9714 AS cval_lineitem_l_linestatus_0#9759, cval_lineitem_l_commitdate#9715 AS cval_lineitem_l_commitdate_0#9760, cval_lineitem_l_receiptdate#9716 AS cval_lineitem_l_receiptdate_0#9761, cval_lineitem_l_shipinstruct#9717 AS cval_lineitem_l_shipinstruct_0#9762, cval_lineitem_l_shipmode#9718 AS cval_lineitem_l_shipmode_0#9763, cval_lineitem_l_comment#9719 AS cval_lineitem_l_comment_0#9764, cval_lineitem_l_shipdate#9720 AS cval_lineitem_l_shipdate_0#9765, cdepval_lineitem_l_quantity#9721 AS cdepval_lineitem_l_quantity_0#9766, cdepval_lineitem_l_extendedprice#9722 AS cdepval_lineitem_l_extendedprice_0#9767, cdepval_lineitem_l_discount#9723 AS cdepval_lineitem_l_discount_0#9768, ... 21 more fields]
         +- Relation[rid#9700,cpfk_orders_lineitem#9701,cpfk_supplier_lineitem#9702,cfpk_lineitem_supplier#9703,cfpk_lineitem_partsupp#9704,cpfk_part_lineitem#9705,cfpk_lineitem_part#9706,cpfk_partsupp_lineitem#9707,cfpk_lineitem_orders#9708,cval_lineitem_l_quantity#9709,cval_lineitem_l_extendedprice#9710,cval_lineitem_l_discount#9711,cval_lineitem_l_tax#9712,cval_lineitem_l_returnflag#9713,cval_lineitem_l_linestatus#9714,cval_lineitem_l_commitdate#9715,cval_lineitem_l_receiptdate#9716,cval_lineitem_l_shipinstruct#9717,cval_lineitem_l_shipmode#9718,cval_lineitem_l_comment#9719,cval_lineitem_l_shipdate#9720,cdepval_lineitem_l_quantity#9721,cdepval_lineitem_l_extendedprice#9722,cdepval_lineitem_l_discount#9723,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2339ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/26 22:07:53 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:07:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9843L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:07:53 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:07:53 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:07:53 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:07:53 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:07:53 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:07:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9843L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#10067 AS rid_2#10112, cpfk_orders_lineitem#10068 AS cpfk_orders_lineitem_2#10113, cpfk_supplier_lineitem#10069 AS cpfk_supplier_lineitem_2#10114, cfpk_lineitem_supplier#10070 AS cfpk_lineitem_supplier_2#10115, cfpk_lineitem_partsupp#10071 AS cfpk_lineitem_partsupp_2#10116, cpfk_part_lineitem#10072 AS cpfk_part_lineitem_2#10117, cfpk_lineitem_part#10073 AS cfpk_lineitem_part_2#10118, cpfk_partsupp_lineitem#10074 AS cpfk_partsupp_lineitem_2#10119, cfpk_lineitem_orders#10075 AS cfpk_lineitem_orders_2#10120, cval_lineitem_l_quantity#10076 AS cval_lineitem_l_quantity_2#10121, cval_lineitem_l_extendedprice#10077 AS cval_lineitem_l_extendedprice_2#10122, cval_lineitem_l_discount#10078 AS cval_lineitem_l_discount_2#10123, cval_lineitem_l_tax#10079 AS cval_lineitem_l_tax_2#10124, cval_lineitem_l_returnflag#10080 AS cval_lineitem_l_returnflag_2#10125, cval_lineitem_l_linestatus#10081 AS cval_lineitem_l_linestatus_2#10126, cval_lineitem_l_commitdate#10082 AS cval_lineitem_l_commitdate_2#10127, cval_lineitem_l_receiptdate#10083 AS cval_lineitem_l_receiptdate_2#10128, cval_lineitem_l_shipinstruct#10084 AS cval_lineitem_l_shipinstruct_2#10129, cval_lineitem_l_shipmode#10085 AS cval_lineitem_l_shipmode_2#10130, cval_lineitem_l_comment#10086 AS cval_lineitem_l_comment_2#10131, cval_lineitem_l_shipdate#10087 AS cval_lineitem_l_shipdate_2#10132, cdepval_lineitem_l_quantity#10088 AS cdepval_lineitem_l_quantity_2#10133, cdepval_lineitem_l_extendedprice#10089 AS cdepval_lineitem_l_extendedprice_2#10134, cdepval_lineitem_l_discount#10090 AS cdepval_lineitem_l_discount_2#10135, ... 21 more fields]
         :  +- Relation[rid#10067,cpfk_orders_lineitem#10068,cpfk_supplier_lineitem#10069,cfpk_lineitem_supplier#10070,cfpk_lineitem_partsupp#10071,cpfk_part_lineitem#10072,cfpk_lineitem_part#10073,cpfk_partsupp_lineitem#10074,cfpk_lineitem_orders#10075,cval_lineitem_l_quantity#10076,cval_lineitem_l_extendedprice#10077,cval_lineitem_l_discount#10078,cval_lineitem_l_tax#10079,cval_lineitem_l_returnflag#10080,cval_lineitem_l_linestatus#10081,cval_lineitem_l_commitdate#10082,cval_lineitem_l_receiptdate#10083,cval_lineitem_l_shipinstruct#10084,cval_lineitem_l_shipmode#10085,cval_lineitem_l_comment#10086,cval_lineitem_l_shipdate#10087,cdepval_lineitem_l_quantity#10088,cdepval_lineitem_l_extendedprice#10089,cdepval_lineitem_l_discount#10090,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin customer~orders, 'cpfk_customer_orders_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#9866, cpfk_nation_customer_0#9867, cfpk_customer_nation_0#9868, cval_customer_c_name_0#9869, cval_customer_c_address_0#9870, cval_customer_c_phone_0#9871, cval_customer_c_acctbal_0#9872, cval_customer_c_comment_0#9873, cval_customer_c_mktsegment_0#9874, cdepval_customer_c_name_0#9875, cdepval_customer_c_address_0#9876, cdepval_customer_c_phone_0#9877, cdepval_customer_c_acctbal_0#9878, cdepval_customer_c_comment_0#9879, cdepval_customer_c_mktsegment_0#9880, cc_name_0#9881, cc_address_0#9882, cc_phone_0#9883, cc_acctbal_0#9884, cc_comment_0#9885, cc_mktsegment_0#9886, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
            :  :  +- Project [rid#9845 AS rid_0#9866, cpfk_nation_customer#9846 AS cpfk_nation_customer_0#9867, cfpk_customer_nation#9847 AS cfpk_customer_nation_0#9868, cval_customer_c_name#9848 AS cval_customer_c_name_0#9869, cval_customer_c_address#9849 AS cval_customer_c_address_0#9870, cval_customer_c_phone#9850 AS cval_customer_c_phone_0#9871, cval_customer_c_acctbal#9851 AS cval_customer_c_acctbal_0#9872, cval_customer_c_comment#9852 AS cval_customer_c_comment_0#9873, cval_customer_c_mktsegment#9853 AS cval_customer_c_mktsegment_0#9874, cdepval_customer_c_name#9854 AS cdepval_customer_c_name_0#9875, cdepval_customer_c_address#9855 AS cdepval_customer_c_address_0#9876, cdepval_customer_c_phone#9856 AS cdepval_customer_c_phone_0#9877, cdepval_customer_c_acctbal#9857 AS cdepval_customer_c_acctbal_0#9878, cdepval_customer_c_comment#9858 AS cdepval_customer_c_comment_0#9879, cdepval_customer_c_mktsegment#9859 AS cdepval_customer_c_mktsegment_0#9880, cc_name#9860 AS cc_name_0#9881, cc_address#9861 AS cc_address_0#9882, cc_phone#9862 AS cc_phone_0#9883, cc_acctbal#9863 AS cc_acctbal_0#9884, cc_comment#9864 AS cc_comment_0#9885, cc_mktsegment#9865 AS cc_mktsegment_0#9886]
            :  :     +- Relation[rid#9845,cpfk_nation_customer#9846,cfpk_customer_nation#9847,cval_customer_c_name#9848,cval_customer_c_address#9849,cval_customer_c_phone#9850,cval_customer_c_acctbal#9851,cval_customer_c_comment#9852,cval_customer_c_mktsegment#9853,cdepval_customer_c_name#9854,cdepval_customer_c_address#9855,cdepval_customer_c_phone#9856,cdepval_customer_c_acctbal#9857,cdepval_customer_c_comment#9858,cdepval_customer_c_mktsegment#9859,cc_name#9860,cc_address#9861,cc_phone#9862,cc_acctbal#9863,cc_comment#9864,cc_mktsegment#9865] JDBCRelation(tcustomer) [numPartitions=1]
            :  +- 'Project ['cpfk_customer_orders_1, 'rid_1]
            :     +- Project [rid#10019 AS rid_1#10043, cpfk_customer_orders#10020 AS cpfk_customer_orders_1#10044, cfpk_orders_customer#10021 AS cfpk_orders_customer_1#10045, cval_orders_o_orderstatus#10022 AS cval_orders_o_orderstatus_1#10046, cval_orders_o_totalprice#10023 AS cval_orders_o_totalprice_1#10047, cval_orders_o_orderpriority#10024 AS cval_orders_o_orderpriority_1#10048, cval_orders_o_clerk#10025 AS cval_orders_o_clerk_1#10049, cval_orders_o_shippriority#10026 AS cval_orders_o_shippriority_1#10050, cval_orders_o_comment#10027 AS cval_orders_o_comment_1#10051, cval_orders_o_orderdate#10028 AS cval_orders_o_orderdate_1#10052, cdepval_orders_o_orderstatus#10029 AS cdepval_orders_o_orderstatus_1#10053, cdepval_orders_o_totalprice#10030 AS cdepval_orders_o_totalprice_1#10054, cdepval_orders_o_orderpriority#10031 AS cdepval_orders_o_orderpriority_1#10055, cdepval_orders_o_clerk#10032 AS cdepval_orders_o_clerk_1#10056, cdepval_orders_o_shippriority#10033 AS cdepval_orders_o_shippriority_1#10057, cdepval_orders_o_comment#10034 AS cdepval_orders_o_comment_1#10058, cdepval_orders_o_orderdate#10035 AS cdepval_orders_o_orderdate_1#10059, co_orderstatus#10036 AS co_orderstatus_1#10060, co_totalprice#10037 AS co_totalprice_1#10061, co_orderpriority#10038 AS co_orderpriority_1#10062, co_clerk#10039 AS co_clerk_1#10063, co_shippriority#10040 AS co_shippriority_1#10064, co_comment#10041 AS co_comment_1#10065, co_orderdate#10042 AS co_orderdate_1#10066]
            :        +- Relation[rid#10019,cpfk_customer_orders#10020,cfpk_orders_customer#10021,cval_orders_o_orderstatus#10022,cval_orders_o_totalprice#10023,cval_orders_o_orderpriority#10024,cval_orders_o_clerk#10025,cval_orders_o_shippriority#10026,cval_orders_o_comment#10027,cval_orders_o_orderdate#10028,cdepval_orders_o_orderstatus#10029,cdepval_orders_o_totalprice#10030,cdepval_orders_o_orderpriority#10031,cdepval_orders_o_clerk#10032,cdepval_orders_o_shippriority#10033,cdepval_orders_o_comment#10034,cdepval_orders_o_orderdate#10035,co_orderstatus#10036,co_totalprice#10037,co_orderpriority#10038,co_clerk#10039,co_shippriority#10040,co_comment#10041,co_orderdate#10042] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#9929 AS rid_1#9953, cpfk_customer_orders#9930 AS cpfk_customer_orders_1#9954, cfpk_orders_customer#9931 AS cfpk_orders_customer_1#9955, cval_orders_o_orderstatus#9932 AS cval_orders_o_orderstatus_1#9956, cval_orders_o_totalprice#9933 AS cval_orders_o_totalprice_1#9957, cval_orders_o_orderpriority#9934 AS cval_orders_o_orderpriority_1#9958, cval_orders_o_clerk#9935 AS cval_orders_o_clerk_1#9959, cval_orders_o_shippriority#9936 AS cval_orders_o_shippriority_1#9960, cval_orders_o_comment#9937 AS cval_orders_o_comment_1#9961, cval_orders_o_orderdate#9938 AS cval_orders_o_orderdate_1#9962, cdepval_orders_o_orderstatus#9939 AS cdepval_orders_o_orderstatus_1#9963, cdepval_orders_o_totalprice#9940 AS cdepval_orders_o_totalprice_1#9964, cdepval_orders_o_orderpriority#9941 AS cdepval_orders_o_orderpriority_1#9965, cdepval_orders_o_clerk#9942 AS cdepval_orders_o_clerk_1#9966, cdepval_orders_o_shippriority#9943 AS cdepval_orders_o_shippriority_1#9967, cdepval_orders_o_comment#9944 AS cdepval_orders_o_comment_1#9968, cdepval_orders_o_orderdate#9945 AS cdepval_orders_o_orderdate_1#9969, co_orderstatus#9946 AS co_orderstatus_1#9970, co_totalprice#9947 AS co_totalprice_1#9971, co_orderpriority#9948 AS co_orderpriority_1#9972, co_clerk#9949 AS co_clerk_1#9973, co_shippriority#9950 AS co_shippriority_1#9974, co_comment#9951 AS co_comment_1#9975, co_orderdate#9952 AS co_orderdate_1#9976]
               +- Relation[rid#9929,cpfk_customer_orders#9930,cfpk_orders_customer#9931,cval_orders_o_orderstatus#9932,cval_orders_o_totalprice#9933,cval_orders_o_orderpriority#9934,cval_orders_o_clerk#9935,cval_orders_o_shippriority#9936,cval_orders_o_comment#9937,cval_orders_o_orderdate#9938,cdepval_orders_o_orderstatus#9939,cdepval_orders_o_totalprice#9940,cdepval_orders_o_orderpriority#9941,cdepval_orders_o_clerk#9942,cdepval_orders_o_shippriority#9943,cdepval_orders_o_comment#9944,cdepval_orders_o_orderdate#9945,co_orderstatus#9946,co_totalprice#9947,co_orderpriority#9948,co_clerk#9949,co_shippriority#9950,co_comment#9951,co_orderdate#9952] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 24025ms
query=q1, count=6001215, duration=2339
query=q10, count=1478870, duration=60954
query=q11, count=31680, duration=2473
query=q12, count=857401, duration=21580
query=q13, count=1500000, duration=4439
query=q14, count=6001215, duration=17915
query=q15, count=6001215, duration=17632
query=q16, count=15780, duration=700
query=q17, count=6088, duration=516
query=q18, count=6001215, duration=22409
query=q19, count=205, duration=16432
query=q2, count=3162, duration=917
query=q20, count=632, duration=826
query=q21a, count=597422, duration=156219
query=q22, count=1500000, duration=4388
query=q3, count=1214743, duration=24025
query=q4, count=6001215, duration=18350
query=q5, count=48089, duration=29652
query=q6, count=6001215, duration=2373
query=q7, count=9735, duration=40436
query=q8, count=8716, duration=3406
query=q9a, count=6001215, duration=63264
query=q9b, count=6001215, duration=37396
