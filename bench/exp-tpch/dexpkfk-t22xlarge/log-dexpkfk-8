20/04/25 22:59:13 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10906ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 25 22:59:16 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 25 22:59:17 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 25 22:59:18 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 25 22:59:18 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 25 22:59:18 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 25 22:59:22 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 25 22:59:26 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 25 22:59:26 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/25 22:59:27 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:59:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2078L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:59:27 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:59:28 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:59:28 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:59:28 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:59:28 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:59:28 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:59:28 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/25 22:59:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2078L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#2230 AS rid_1#2275, cpfk_orders_lineitem#2231 AS cpfk_orders_lineitem_1#2276, cpfk_supplier_lineitem#2232 AS cpfk_supplier_lineitem_1#2277, cfpk_lineitem_supplier#2233 AS cfpk_lineitem_supplier_1#2278, cfpk_lineitem_partsupp#2234 AS cfpk_lineitem_partsupp_1#2279, cpfk_part_lineitem#2235 AS cpfk_part_lineitem_1#2280, cfpk_lineitem_part#2236 AS cfpk_lineitem_part_1#2281, cpfk_partsupp_lineitem#2237 AS cpfk_partsupp_lineitem_1#2282, cfpk_lineitem_orders#2238 AS cfpk_lineitem_orders_1#2283, cval_lineitem_l_quantity#2239 AS cval_lineitem_l_quantity_1#2284, cval_lineitem_l_extendedprice#2240 AS cval_lineitem_l_extendedprice_1#2285, cval_lineitem_l_discount#2241 AS cval_lineitem_l_discount_1#2286, cval_lineitem_l_tax#2242 AS cval_lineitem_l_tax_1#2287, cval_lineitem_l_returnflag#2243 AS cval_lineitem_l_returnflag_1#2288, cval_lineitem_l_linestatus#2244 AS cval_lineitem_l_linestatus_1#2289, cval_lineitem_l_commitdate#2245 AS cval_lineitem_l_commitdate_1#2290, cval_lineitem_l_receiptdate#2246 AS cval_lineitem_l_receiptdate_1#2291, cval_lineitem_l_shipinstruct#2247 AS cval_lineitem_l_shipinstruct_1#2292, cval_lineitem_l_shipmode#2248 AS cval_lineitem_l_shipmode_1#2293, cval_lineitem_l_comment#2249 AS cval_lineitem_l_comment_1#2294, cval_lineitem_l_shipdate#2250 AS cval_lineitem_l_shipdate_1#2295, cdepval_lineitem_l_quantity#2251 AS cdepval_lineitem_l_quantity_1#2296, cdepval_lineitem_l_extendedprice#2252 AS cdepval_lineitem_l_extendedprice_1#2297, cdepval_lineitem_l_discount#2253 AS cdepval_lineitem_l_discount_1#2298, ... 21 more fields]
         :  +- Relation[rid#2230,cpfk_orders_lineitem#2231,cpfk_supplier_lineitem#2232,cfpk_lineitem_supplier#2233,cfpk_lineitem_partsupp#2234,cpfk_part_lineitem#2235,cfpk_lineitem_part#2236,cpfk_partsupp_lineitem#2237,cfpk_lineitem_orders#2238,cval_lineitem_l_quantity#2239,cval_lineitem_l_extendedprice#2240,cval_lineitem_l_discount#2241,cval_lineitem_l_tax#2242,cval_lineitem_l_returnflag#2243,cval_lineitem_l_linestatus#2244,cval_lineitem_l_commitdate#2245,cval_lineitem_l_receiptdate#2246,cval_lineitem_l_shipinstruct#2247,cval_lineitem_l_shipmode#2248,cval_lineitem_l_comment#2249,cval_lineitem_l_shipdate#2250,cdepval_lineitem_l_quantity#2251,cdepval_lineitem_l_extendedprice#2252,cdepval_lineitem_l_discount#2253,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
               +- Project [rid#2080 AS rid_0#2105, cval_part_p_name#2081 AS cval_part_p_name_0#2106, cval_part_p_mfgr#2082 AS cval_part_p_mfgr_0#2107, cval_part_p_type#2083 AS cval_part_p_type_0#2108, cval_part_p_size#2084 AS cval_part_p_size_0#2109, cval_part_p_container#2085 AS cval_part_p_container_0#2110, cval_part_p_retailprice#2086 AS cval_part_p_retailprice_0#2111, cval_part_p_comment#2087 AS cval_part_p_comment_0#2112, cval_part_p_brand#2088 AS cval_part_p_brand_0#2113, cdepval_part_p_name#2089 AS cdepval_part_p_name_0#2114, cdepval_part_p_mfgr#2090 AS cdepval_part_p_mfgr_0#2115, cdepval_part_p_type#2091 AS cdepval_part_p_type_0#2116, cdepval_part_p_size#2092 AS cdepval_part_p_size_0#2117, cdepval_part_p_container#2093 AS cdepval_part_p_container_0#2118, cdepval_part_p_retailprice#2094 AS cdepval_part_p_retailprice_0#2119, cdepval_part_p_comment#2095 AS cdepval_part_p_comment_0#2120, cdepval_part_p_brand#2096 AS cdepval_part_p_brand_0#2121, cp_name#2097 AS cp_name_0#2122, cp_mfgr#2098 AS cp_mfgr_0#2123, cp_type#2099 AS cp_type_0#2124, cp_size#2100 AS cp_size_0#2125, cp_container#2101 AS cp_container_0#2126, cp_retailprice#2102 AS cp_retailprice_0#2127, cp_comment#2103 AS cp_comment_0#2128, cp_brand#2104 AS cp_brand_0#2129]
                  +- Relation[rid#2080,cval_part_p_name#2081,cval_part_p_mfgr#2082,cval_part_p_type#2083,cval_part_p_size#2084,cval_part_p_container#2085,cval_part_p_retailprice#2086,cval_part_p_comment#2087,cval_part_p_brand#2088,cdepval_part_p_name#2089,cdepval_part_p_mfgr#2090,cdepval_part_p_type#2091,cdepval_part_p_size#2092,cdepval_part_p_container#2093,cdepval_part_p_retailprice#2094,cdepval_part_p_comment#2095,cdepval_part_p_brand#2096,cp_name#2097,cp_mfgr#2098,cp_type#2099,cp_size#2100,cp_container#2101,cp_retailprice#2102,cp_comment#2103,cp_brand#2104] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 26184ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/25 22:59:53 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:59:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2396L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 22:59:53 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:59:53 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:59:53 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:59:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:59:54 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:59:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:59:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:59:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:59:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:59:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:59:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:59:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2396L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#2534 AS rid_4#2579, cpfk_orders_lineitem#2535 AS cpfk_orders_lineitem_4#2580, cpfk_supplier_lineitem#2536 AS cpfk_supplier_lineitem_4#2581, cfpk_lineitem_supplier#2537 AS cfpk_lineitem_supplier_4#2582, cfpk_lineitem_partsupp#2538 AS cfpk_lineitem_partsupp_4#2583, cpfk_part_lineitem#2539 AS cpfk_part_lineitem_4#2584, cfpk_lineitem_part#2540 AS cfpk_lineitem_part_4#2585, cpfk_partsupp_lineitem#2541 AS cpfk_partsupp_lineitem_4#2586, cfpk_lineitem_orders#2542 AS cfpk_lineitem_orders_4#2587, cval_lineitem_l_quantity#2543 AS cval_lineitem_l_quantity_4#2588, cval_lineitem_l_extendedprice#2544 AS cval_lineitem_l_extendedprice_4#2589, cval_lineitem_l_discount#2545 AS cval_lineitem_l_discount_4#2590, cval_lineitem_l_tax#2546 AS cval_lineitem_l_tax_4#2591, cval_lineitem_l_returnflag#2547 AS cval_lineitem_l_returnflag_4#2592, cval_lineitem_l_linestatus#2548 AS cval_lineitem_l_linestatus_4#2593, cval_lineitem_l_commitdate#2549 AS cval_lineitem_l_commitdate_4#2594, cval_lineitem_l_receiptdate#2550 AS cval_lineitem_l_receiptdate_4#2595, cval_lineitem_l_shipinstruct#2551 AS cval_lineitem_l_shipinstruct_4#2596, cval_lineitem_l_shipmode#2552 AS cval_lineitem_l_shipmode_4#2597, cval_lineitem_l_comment#2553 AS cval_lineitem_l_comment_4#2598, cval_lineitem_l_shipdate#2554 AS cval_lineitem_l_shipdate_4#2599, cdepval_lineitem_l_quantity#2555 AS cdepval_lineitem_l_quantity_4#2600, cdepval_lineitem_l_extendedprice#2556 AS cdepval_lineitem_l_extendedprice_4#2601, cdepval_lineitem_l_discount#2557 AS cdepval_lineitem_l_discount_4#2602, ... 21 more fields]
            :  :  +- Relation[rid#2534,cpfk_orders_lineitem#2535,cpfk_supplier_lineitem#2536,cfpk_lineitem_supplier#2537,cfpk_lineitem_partsupp#2538,cpfk_part_lineitem#2539,cfpk_lineitem_part#2540,cpfk_partsupp_lineitem#2541,cfpk_lineitem_orders#2542,cval_lineitem_l_quantity#2543,cval_lineitem_l_extendedprice#2544,cval_lineitem_l_discount#2545,cval_lineitem_l_tax#2546,cval_lineitem_l_returnflag#2547,cval_lineitem_l_linestatus#2548,cval_lineitem_l_commitdate#2549,cval_lineitem_l_receiptdate#2550,cval_lineitem_l_shipinstruct#2551,cval_lineitem_l_shipmode#2552,cval_lineitem_l_comment#2553,cval_lineitem_l_shipdate#2554,cdepval_lineitem_l_quantity#2555,cdepval_lineitem_l_extendedprice#2556,cdepval_lineitem_l_discount#2557,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#2486 AS rid_3#2510, cpfk_customer_orders#2487 AS cpfk_customer_orders_3#2511, cfpk_orders_customer#2488 AS cfpk_orders_customer_3#2512, cval_orders_o_orderstatus#2489 AS cval_orders_o_orderstatus_3#2513, cval_orders_o_totalprice#2490 AS cval_orders_o_totalprice_3#2514, cval_orders_o_orderpriority#2491 AS cval_orders_o_orderpriority_3#2515, cval_orders_o_clerk#2492 AS cval_orders_o_clerk_3#2516, cval_orders_o_shippriority#2493 AS cval_orders_o_shippriority_3#2517, cval_orders_o_comment#2494 AS cval_orders_o_comment_3#2518, cval_orders_o_orderdate#2495 AS cval_orders_o_orderdate_3#2519, cdepval_orders_o_orderstatus#2496 AS cdepval_orders_o_orderstatus_3#2520, cdepval_orders_o_totalprice#2497 AS cdepval_orders_o_totalprice_3#2521, cdepval_orders_o_orderpriority#2498 AS cdepval_orders_o_orderpriority_3#2522, cdepval_orders_o_clerk#2499 AS cdepval_orders_o_clerk_3#2523, cdepval_orders_o_shippriority#2500 AS cdepval_orders_o_shippriority_3#2524, cdepval_orders_o_comment#2501 AS cdepval_orders_o_comment_3#2525, cdepval_orders_o_orderdate#2502 AS cdepval_orders_o_orderdate_3#2526, co_orderstatus#2503 AS co_orderstatus_3#2527, co_totalprice#2504 AS co_totalprice_3#2528, co_orderpriority#2505 AS co_orderpriority_3#2529, co_clerk#2506 AS co_clerk_3#2530, co_shippriority#2507 AS co_shippriority_3#2531, co_comment#2508 AS co_comment_3#2532, co_orderdate#2509 AS co_orderdate_3#2533]
            :     :  +- Relation[rid#2486,cpfk_customer_orders#2487,cfpk_orders_customer#2488,cval_orders_o_orderstatus#2489,cval_orders_o_totalprice#2490,cval_orders_o_orderpriority#2491,cval_orders_o_clerk#2492,cval_orders_o_shippriority#2493,cval_orders_o_comment#2494,cval_orders_o_orderdate#2495,cdepval_orders_o_orderstatus#2496,cdepval_orders_o_totalprice#2497,cdepval_orders_o_orderpriority#2498,cdepval_orders_o_clerk#2499,cdepval_orders_o_shippriority#2500,cdepval_orders_o_comment#2501,cdepval_orders_o_orderdate#2502,co_orderstatus#2503,co_totalprice#2504,co_orderpriority#2505,co_clerk#2506,co_shippriority#2507,co_comment#2508,co_orderdate#2509] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#2444 AS rid_2#2465, cpfk_nation_customer#2445 AS cpfk_nation_customer_2#2466, cfpk_customer_nation#2446 AS cfpk_customer_nation_2#2467, cval_customer_c_name#2447 AS cval_customer_c_name_2#2468, cval_customer_c_address#2448 AS cval_customer_c_address_2#2469, cval_customer_c_phone#2449 AS cval_customer_c_phone_2#2470, cval_customer_c_acctbal#2450 AS cval_customer_c_acctbal_2#2471, cval_customer_c_comment#2451 AS cval_customer_c_comment_2#2472, cval_customer_c_mktsegment#2452 AS cval_customer_c_mktsegment_2#2473, cdepval_customer_c_name#2453 AS cdepval_customer_c_name_2#2474, cdepval_customer_c_address#2454 AS cdepval_customer_c_address_2#2475, cdepval_customer_c_phone#2455 AS cdepval_customer_c_phone_2#2476, cdepval_customer_c_acctbal#2456 AS cdepval_customer_c_acctbal_2#2477, cdepval_customer_c_comment#2457 AS cdepval_customer_c_comment_2#2478, cdepval_customer_c_mktsegment#2458 AS cdepval_customer_c_mktsegment_2#2479, cc_name#2459 AS cc_name_2#2480, cc_address#2460 AS cc_address_2#2481, cc_phone#2461 AS cc_phone_2#2482, cc_acctbal#2462 AS cc_acctbal_2#2483, cc_comment#2463 AS cc_comment_2#2484, cc_mktsegment#2464 AS cc_mktsegment_2#2485]
            :        :  +- Relation[rid#2444,cpfk_nation_customer#2445,cfpk_customer_nation#2446,cval_customer_c_name#2447,cval_customer_c_address#2448,cval_customer_c_phone#2449,cval_customer_c_acctbal#2450,cval_customer_c_comment#2451,cval_customer_c_mktsegment#2452,cdepval_customer_c_name#2453,cdepval_customer_c_address#2454,cdepval_customer_c_phone#2455,cdepval_customer_c_acctbal#2456,cdepval_customer_c_comment#2457,cdepval_customer_c_mktsegment#2458,cc_name#2459,cc_address#2460,cc_phone#2461,cc_acctbal#2462,cc_comment#2463,cc_mktsegment#2464] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
            :           :- Project [rid#2426 AS rid_1#2435, cpfk_region_nation#2427 AS cpfk_region_nation_1#2436, cfpk_nation_region#2428 AS cfpk_nation_region_1#2437, cval_nation_n_name#2429 AS cval_nation_n_name_1#2438, cval_nation_n_comment#2430 AS cval_nation_n_comment_1#2439, cdepval_nation_n_name#2431 AS cdepval_nation_n_name_1#2440, cdepval_nation_n_comment#2432 AS cdepval_nation_n_comment_1#2441, cn_name#2433 AS cn_name_1#2442, cn_comment#2434 AS cn_comment_1#2443]
            :           :  +- Relation[rid#2426,cpfk_region_nation#2427,cfpk_nation_region#2428,cval_nation_n_name#2429,cval_nation_n_comment#2430,cdepval_nation_n_name#2431,cdepval_nation_n_comment#2432,cn_name#2433,cn_comment#2434] JDBCRelation(tnation) [numPartitions=1]
            :           +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :              +- Project [rid#2398 AS rid_0#2405, cval_region_r_name#2399 AS cval_region_r_name_0#2406, cval_region_r_comment#2400 AS cval_region_r_comment_0#2407, cdepval_region_r_name#2401 AS cdepval_region_r_name_0#2408, cdepval_region_r_comment#2402 AS cdepval_region_r_comment_0#2409, cr_name#2403 AS cr_name_0#2410, cr_comment#2404 AS cr_comment_0#2411]
            :                 +- Relation[rid#2398,cval_region_r_name#2399,cval_region_r_comment#2400,cdepval_region_r_name#2401,cdepval_region_r_comment#2402,cr_name#2403,cr_comment#2404] JDBCRelation(tregion) [numPartitions=1]
            +- Project [rid#2624 AS rid_5#2642, cpfk_nation_supplier#2625 AS cpfk_nation_supplier_5#2643, cfpk_supplier_nation#2626 AS cfpk_supplier_nation_5#2644, cval_supplier_s_name#2627 AS cval_supplier_s_name_5#2645, cval_supplier_s_address#2628 AS cval_supplier_s_address_5#2646, cval_supplier_s_phone#2629 AS cval_supplier_s_phone_5#2647, cval_supplier_s_acctbal#2630 AS cval_supplier_s_acctbal_5#2648, cval_supplier_s_comment#2631 AS cval_supplier_s_comment_5#2649, cdepval_supplier_s_name#2632 AS cdepval_supplier_s_name_5#2650, cdepval_supplier_s_address#2633 AS cdepval_supplier_s_address_5#2651, cdepval_supplier_s_phone#2634 AS cdepval_supplier_s_phone_5#2652, cdepval_supplier_s_acctbal#2635 AS cdepval_supplier_s_acctbal_5#2653, cdepval_supplier_s_comment#2636 AS cdepval_supplier_s_comment_5#2654, cs_name#2637 AS cs_name_5#2655, cs_address#2638 AS cs_address_5#2656, cs_phone#2639 AS cs_phone_5#2657, cs_acctbal#2640 AS cs_acctbal_5#2658, cs_comment#2641 AS cs_comment_5#2659]
               +- Relation[rid#2624,cpfk_nation_supplier#2625,cfpk_supplier_nation#2626,cval_supplier_s_name#2627,cval_supplier_s_address#2628,cval_supplier_s_phone#2629,cval_supplier_s_acctbal#2630,cval_supplier_s_comment#2631,cdepval_supplier_s_name#2632,cdepval_supplier_s_address#2633,cdepval_supplier_s_phone#2634,cdepval_supplier_s_acctbal#2635,cdepval_supplier_s_comment#2636,cs_name#2637,cs_address#2638,cs_phone#2639,cs_acctbal#2640,cs_comment#2641] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 30797ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/25 23:00:24 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:00:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2788L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 23:00:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:00:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:00:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:00:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:00:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:00:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:00:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:00:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2788L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#2790 AS rid_0#2835, cpfk_orders_lineitem#2791 AS cpfk_orders_lineitem_0#2836, cpfk_supplier_lineitem#2792 AS cpfk_supplier_lineitem_0#2837, cfpk_lineitem_supplier#2793 AS cfpk_lineitem_supplier_0#2838, cfpk_lineitem_partsupp#2794 AS cfpk_lineitem_partsupp_0#2839, cpfk_part_lineitem#2795 AS cpfk_part_lineitem_0#2840, cfpk_lineitem_part#2796 AS cfpk_lineitem_part_0#2841, cpfk_partsupp_lineitem#2797 AS cpfk_partsupp_lineitem_0#2842, cfpk_lineitem_orders#2798 AS cfpk_lineitem_orders_0#2843, cval_lineitem_l_quantity#2799 AS cval_lineitem_l_quantity_0#2844, cval_lineitem_l_extendedprice#2800 AS cval_lineitem_l_extendedprice_0#2845, cval_lineitem_l_discount#2801 AS cval_lineitem_l_discount_0#2846, cval_lineitem_l_tax#2802 AS cval_lineitem_l_tax_0#2847, cval_lineitem_l_returnflag#2803 AS cval_lineitem_l_returnflag_0#2848, cval_lineitem_l_linestatus#2804 AS cval_lineitem_l_linestatus_0#2849, cval_lineitem_l_commitdate#2805 AS cval_lineitem_l_commitdate_0#2850, cval_lineitem_l_receiptdate#2806 AS cval_lineitem_l_receiptdate_0#2851, cval_lineitem_l_shipinstruct#2807 AS cval_lineitem_l_shipinstruct_0#2852, cval_lineitem_l_shipmode#2808 AS cval_lineitem_l_shipmode_0#2853, cval_lineitem_l_comment#2809 AS cval_lineitem_l_comment_0#2854, cval_lineitem_l_shipdate#2810 AS cval_lineitem_l_shipdate_0#2855, cdepval_lineitem_l_quantity#2811 AS cdepval_lineitem_l_quantity_0#2856, cdepval_lineitem_l_extendedprice#2812 AS cdepval_lineitem_l_extendedprice_0#2857, cdepval_lineitem_l_discount#2813 AS cdepval_lineitem_l_discount_0#2858, ... 21 more fields]
         :  +- Relation[rid#2790,cpfk_orders_lineitem#2791,cpfk_supplier_lineitem#2792,cfpk_lineitem_supplier#2793,cfpk_lineitem_partsupp#2794,cpfk_part_lineitem#2795,cfpk_lineitem_part#2796,cpfk_partsupp_lineitem#2797,cfpk_lineitem_orders#2798,cval_lineitem_l_quantity#2799,cval_lineitem_l_extendedprice#2800,cval_lineitem_l_discount#2801,cval_lineitem_l_tax#2802,cval_lineitem_l_returnflag#2803,cval_lineitem_l_linestatus#2804,cval_lineitem_l_commitdate#2805,cval_lineitem_l_receiptdate#2806,cval_lineitem_l_shipinstruct#2807,cval_lineitem_l_shipmode#2808,cval_lineitem_l_comment#2809,cval_lineitem_l_shipdate#2810,cdepval_lineitem_l_quantity#2811,cdepval_lineitem_l_extendedprice#2812,cdepval_lineitem_l_discount#2813,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
            :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
            :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
            :  :  :- Project [rid#2976 AS rid_2#3021, cpfk_orders_lineitem#2977 AS cpfk_orders_lineitem_2#3022, cpfk_supplier_lineitem#2978 AS cpfk_supplier_lineitem_2#3023, cfpk_lineitem_supplier#2979 AS cfpk_lineitem_supplier_2#3024, cfpk_lineitem_partsupp#2980 AS cfpk_lineitem_partsupp_2#3025, cpfk_part_lineitem#2981 AS cpfk_part_lineitem_2#3026, cfpk_lineitem_part#2982 AS cfpk_lineitem_part_2#3027, cpfk_partsupp_lineitem#2983 AS cpfk_partsupp_lineitem_2#3028, cfpk_lineitem_orders#2984 AS cfpk_lineitem_orders_2#3029, cval_lineitem_l_quantity#2985 AS cval_lineitem_l_quantity_2#3030, cval_lineitem_l_extendedprice#2986 AS cval_lineitem_l_extendedprice_2#3031, cval_lineitem_l_discount#2987 AS cval_lineitem_l_discount_2#3032, cval_lineitem_l_tax#2988 AS cval_lineitem_l_tax_2#3033, cval_lineitem_l_returnflag#2989 AS cval_lineitem_l_returnflag_2#3034, cval_lineitem_l_linestatus#2990 AS cval_lineitem_l_linestatus_2#3035, cval_lineitem_l_commitdate#2991 AS cval_lineitem_l_commitdate_2#3036, cval_lineitem_l_receiptdate#2992 AS cval_lineitem_l_receiptdate_2#3037, cval_lineitem_l_shipinstruct#2993 AS cval_lineitem_l_shipinstruct_2#3038, cval_lineitem_l_shipmode#2994 AS cval_lineitem_l_shipmode_2#3039, cval_lineitem_l_comment#2995 AS cval_lineitem_l_comment_2#3040, cval_lineitem_l_shipdate#2996 AS cval_lineitem_l_shipdate_2#3041, cdepval_lineitem_l_quantity#2997 AS cdepval_lineitem_l_quantity_2#3042, cdepval_lineitem_l_extendedprice#2998 AS cdepval_lineitem_l_extendedprice_2#3043, cdepval_lineitem_l_discount#2999 AS cdepval_lineitem_l_discount_2#3044, ... 21 more fields]
            :  :  :  +- Relation[rid#2976,cpfk_orders_lineitem#2977,cpfk_supplier_lineitem#2978,cfpk_lineitem_supplier#2979,cfpk_lineitem_partsupp#2980,cpfk_part_lineitem#2981,cfpk_lineitem_part#2982,cpfk_partsupp_lineitem#2983,cfpk_lineitem_orders#2984,cval_lineitem_l_quantity#2985,cval_lineitem_l_extendedprice#2986,cval_lineitem_l_discount#2987,cval_lineitem_l_tax#2988,cval_lineitem_l_returnflag#2989,cval_lineitem_l_linestatus#2990,cval_lineitem_l_commitdate#2991,cval_lineitem_l_receiptdate#2992,cval_lineitem_l_shipinstruct#2993,cval_lineitem_l_shipmode#2994,cval_lineitem_l_comment#2995,cval_lineitem_l_shipdate#2996,cdepval_lineitem_l_quantity#2997,cdepval_lineitem_l_extendedprice#2998,cdepval_lineitem_l_discount#2999,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
            :  :     +- Project [rid#2880 AS rid_1#2904, cpfk_customer_orders#2881 AS cpfk_customer_orders_1#2905, cfpk_orders_customer#2882 AS cfpk_orders_customer_1#2906, cval_orders_o_orderstatus#2883 AS cval_orders_o_orderstatus_1#2907, cval_orders_o_totalprice#2884 AS cval_orders_o_totalprice_1#2908, cval_orders_o_orderpriority#2885 AS cval_orders_o_orderpriority_1#2909, cval_orders_o_clerk#2886 AS cval_orders_o_clerk_1#2910, cval_orders_o_shippriority#2887 AS cval_orders_o_shippriority_1#2911, cval_orders_o_comment#2888 AS cval_orders_o_comment_1#2912, cval_orders_o_orderdate#2889 AS cval_orders_o_orderdate_1#2913, cdepval_orders_o_orderstatus#2890 AS cdepval_orders_o_orderstatus_1#2914, cdepval_orders_o_totalprice#2891 AS cdepval_orders_o_totalprice_1#2915, cdepval_orders_o_orderpriority#2892 AS cdepval_orders_o_orderpriority_1#2916, cdepval_orders_o_clerk#2893 AS cdepval_orders_o_clerk_1#2917, cdepval_orders_o_shippriority#2894 AS cdepval_orders_o_shippriority_1#2918, cdepval_orders_o_comment#2895 AS cdepval_orders_o_comment_1#2919, cdepval_orders_o_orderdate#2896 AS cdepval_orders_o_orderdate_1#2920, co_orderstatus#2897 AS co_orderstatus_1#2921, co_totalprice#2898 AS co_totalprice_1#2922, co_orderpriority#2899 AS co_orderpriority_1#2923, co_clerk#2900 AS co_clerk_1#2924, co_shippriority#2901 AS co_shippriority_1#2925, co_comment#2902 AS co_comment_1#2926, co_orderdate#2903 AS co_orderdate_1#2927]
            :  :        +- Relation[rid#2880,cpfk_customer_orders#2881,cfpk_orders_customer#2882,cval_orders_o_orderstatus#2883,cval_orders_o_totalprice#2884,cval_orders_o_orderpriority#2885,cval_orders_o_clerk#2886,cval_orders_o_shippriority#2887,cval_orders_o_comment#2888,cval_orders_o_orderdate#2889,cdepval_orders_o_orderstatus#2890,cdepval_orders_o_totalprice#2891,cdepval_orders_o_orderpriority#2892,cdepval_orders_o_clerk#2893,cdepval_orders_o_shippriority#2894,cdepval_orders_o_comment#2895,cdepval_orders_o_orderdate#2896,co_orderstatus#2897,co_totalprice#2898,co_orderpriority#2899,co_clerk#2900,co_shippriority#2901,co_comment#2902,co_orderdate#2903] JDBCRelation(torders) [numPartitions=1]
            :  +- Project [rid#3066 AS rid_3#3084, cpfk_nation_supplier#3067 AS cpfk_nation_supplier_3#3085, cfpk_supplier_nation#3068 AS cfpk_supplier_nation_3#3086, cval_supplier_s_name#3069 AS cval_supplier_s_name_3#3087, cval_supplier_s_address#3070 AS cval_supplier_s_address_3#3088, cval_supplier_s_phone#3071 AS cval_supplier_s_phone_3#3089, cval_supplier_s_acctbal#3072 AS cval_supplier_s_acctbal_3#3090, cval_supplier_s_comment#3073 AS cval_supplier_s_comment_3#3091, cdepval_supplier_s_name#3074 AS cdepval_supplier_s_name_3#3092, cdepval_supplier_s_address#3075 AS cdepval_supplier_s_address_3#3093, cdepval_supplier_s_phone#3076 AS cdepval_supplier_s_phone_3#3094, cdepval_supplier_s_acctbal#3077 AS cdepval_supplier_s_acctbal_3#3095, cdepval_supplier_s_comment#3078 AS cdepval_supplier_s_comment_3#3096, cs_name#3079 AS cs_name_3#3097, cs_address#3080 AS cs_address_3#3098, cs_phone#3081 AS cs_phone_3#3099, cs_acctbal#3082 AS cs_acctbal_3#3100, cs_comment#3083 AS cs_comment_3#3101]
            :     +- Relation[rid#3066,cpfk_nation_supplier#3067,cfpk_supplier_nation#3068,cval_supplier_s_name#3069,cval_supplier_s_address#3070,cval_supplier_s_phone#3071,cval_supplier_s_acctbal#3072,cval_supplier_s_comment#3073,cdepval_supplier_s_name#3074,cdepval_supplier_s_address#3075,cdepval_supplier_s_phone#3076,cdepval_supplier_s_acctbal#3077,cdepval_supplier_s_comment#3078,cs_name#3079,cs_address#3080,cs_phone#3081,cs_acctbal#3082,cs_comment#3083] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
               +- Project [rid#3102 AS rid_4#3111, cpfk_region_nation#3103 AS cpfk_region_nation_4#3112, cfpk_nation_region#3104 AS cfpk_nation_region_4#3113, cval_nation_n_name#3105 AS cval_nation_n_name_4#3114, cval_nation_n_comment#3106 AS cval_nation_n_comment_4#3115, cdepval_nation_n_name#3107 AS cdepval_nation_n_name_4#3116, cdepval_nation_n_comment#3108 AS cdepval_nation_n_comment_4#3117, cn_name#3109 AS cn_name_4#3118, cn_comment#3110 AS cn_comment_4#3119]
                  +- Relation[rid#3102,cpfk_region_nation#3103,cfpk_nation_region#3104,cval_nation_n_name#3105,cval_nation_n_comment#3106,cdepval_nation_n_name#3107,cdepval_nation_n_comment#3108,cn_name#3109,cn_comment#3110] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 76200ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/25 23:01:40 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:01:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3285L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:01:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3285L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#3337 AS rid_1#3382, cpfk_orders_lineitem#3338 AS cpfk_orders_lineitem_1#3383, cpfk_supplier_lineitem#3339 AS cpfk_supplier_lineitem_1#3384, cfpk_lineitem_supplier#3340 AS cfpk_lineitem_supplier_1#3385, cfpk_lineitem_partsupp#3341 AS cfpk_lineitem_partsupp_1#3386, cpfk_part_lineitem#3342 AS cpfk_part_lineitem_1#3387, cfpk_lineitem_part#3343 AS cfpk_lineitem_part_1#3388, cpfk_partsupp_lineitem#3344 AS cpfk_partsupp_lineitem_1#3389, cfpk_lineitem_orders#3345 AS cfpk_lineitem_orders_1#3390, cval_lineitem_l_quantity#3346 AS cval_lineitem_l_quantity_1#3391, cval_lineitem_l_extendedprice#3347 AS cval_lineitem_l_extendedprice_1#3392, cval_lineitem_l_discount#3348 AS cval_lineitem_l_discount_1#3393, cval_lineitem_l_tax#3349 AS cval_lineitem_l_tax_1#3394, cval_lineitem_l_returnflag#3350 AS cval_lineitem_l_returnflag_1#3395, cval_lineitem_l_linestatus#3351 AS cval_lineitem_l_linestatus_1#3396, cval_lineitem_l_commitdate#3352 AS cval_lineitem_l_commitdate_1#3397, cval_lineitem_l_receiptdate#3353 AS cval_lineitem_l_receiptdate_1#3398, cval_lineitem_l_shipinstruct#3354 AS cval_lineitem_l_shipinstruct_1#3399, cval_lineitem_l_shipmode#3355 AS cval_lineitem_l_shipmode_1#3400, cval_lineitem_l_comment#3356 AS cval_lineitem_l_comment_1#3401, cval_lineitem_l_shipdate#3357 AS cval_lineitem_l_shipdate_1#3402, cdepval_lineitem_l_quantity#3358 AS cdepval_lineitem_l_quantity_1#3403, cdepval_lineitem_l_extendedprice#3359 AS cdepval_lineitem_l_extendedprice_1#3404, cdepval_lineitem_l_discount#3360 AS cdepval_lineitem_l_discount_1#3405, ... 21 more fields]
         :  +- Relation[rid#3337,cpfk_orders_lineitem#3338,cpfk_supplier_lineitem#3339,cfpk_lineitem_supplier#3340,cfpk_lineitem_partsupp#3341,cpfk_part_lineitem#3342,cfpk_lineitem_part#3343,cpfk_partsupp_lineitem#3344,cfpk_lineitem_orders#3345,cval_lineitem_l_quantity#3346,cval_lineitem_l_extendedprice#3347,cval_lineitem_l_discount#3348,cval_lineitem_l_tax#3349,cval_lineitem_l_returnflag#3350,cval_lineitem_l_linestatus#3351,cval_lineitem_l_commitdate#3352,cval_lineitem_l_receiptdate#3353,cval_lineitem_l_shipinstruct#3354,cval_lineitem_l_shipmode#3355,cval_lineitem_l_comment#3356,cval_lineitem_l_shipdate#3357,cdepval_lineitem_l_quantity#3358,cdepval_lineitem_l_extendedprice#3359,cdepval_lineitem_l_discount#3360,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#3287 AS rid_0#3312, cval_part_p_name#3288 AS cval_part_p_name_0#3313, cval_part_p_mfgr#3289 AS cval_part_p_mfgr_0#3314, cval_part_p_type#3290 AS cval_part_p_type_0#3315, cval_part_p_size#3291 AS cval_part_p_size_0#3316, cval_part_p_container#3292 AS cval_part_p_container_0#3317, cval_part_p_retailprice#3293 AS cval_part_p_retailprice_0#3318, cval_part_p_comment#3294 AS cval_part_p_comment_0#3319, cval_part_p_brand#3295 AS cval_part_p_brand_0#3320, cdepval_part_p_name#3296 AS cdepval_part_p_name_0#3321, cdepval_part_p_mfgr#3297 AS cdepval_part_p_mfgr_0#3322, cdepval_part_p_type#3298 AS cdepval_part_p_type_0#3323, cdepval_part_p_size#3299 AS cdepval_part_p_size_0#3324, cdepval_part_p_container#3300 AS cdepval_part_p_container_0#3325, cdepval_part_p_retailprice#3301 AS cdepval_part_p_retailprice_0#3326, cdepval_part_p_comment#3302 AS cdepval_part_p_comment_0#3327, cdepval_part_p_brand#3303 AS cdepval_part_p_brand_0#3328, cp_name#3304 AS cp_name_0#3329, cp_mfgr#3305 AS cp_mfgr_0#3330, cp_type#3306 AS cp_type_0#3331, cp_size#3307 AS cp_size_0#3332, cp_container#3308 AS cp_container_0#3333, cp_retailprice#3309 AS cp_retailprice_0#3334, cp_comment#3310 AS cp_comment_0#3335, cp_brand#3311 AS cp_brand_0#3336]
            +- Relation[rid#3287,cval_part_p_name#3288,cval_part_p_mfgr#3289,cval_part_p_type#3290,cval_part_p_size#3291,cval_part_p_container#3292,cval_part_p_retailprice#3293,cval_part_p_comment#3294,cval_part_p_brand#3295,cdepval_part_p_name#3296,cdepval_part_p_mfgr#3297,cdepval_part_p_type#3298,cdepval_part_p_size#3299,cdepval_part_p_container#3300,cdepval_part_p_retailprice#3301,cdepval_part_p_comment#3302,cdepval_part_p_brand#3303,cp_name#3304,cp_mfgr#3305,cp_type#3306,cp_size#3307,cp_container#3308,cp_retailprice#3309,cp_comment#3310,cp_brand#3311] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17895ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/25 23:01:58 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:01:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3503L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 23:01:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:01:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:01:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:01:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:01:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:01:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:01:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:01:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:01:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:01:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3503L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#3577 AS rid_2#3591, cpfk_part_partsupp#3578 AS cpfk_part_partsupp_2#3592, cfpk_partsupp_part#3579 AS cfpk_partsupp_part_2#3593, cpfk_supplier_partsupp#3580 AS cpfk_supplier_partsupp_2#3594, cfpk_partsupp_supplier#3581 AS cfpk_partsupp_supplier_2#3595, cval_partsupp_ps_availqty#3582 AS cval_partsupp_ps_availqty_2#3596, cval_partsupp_ps_supplycost#3583 AS cval_partsupp_ps_supplycost_2#3597, cval_partsupp_ps_comment#3584 AS cval_partsupp_ps_comment_2#3598, cdepval_partsupp_ps_availqty#3585 AS cdepval_partsupp_ps_availqty_2#3599, cdepval_partsupp_ps_supplycost#3586 AS cdepval_partsupp_ps_supplycost_2#3600, cdepval_partsupp_ps_comment#3587 AS cdepval_partsupp_ps_comment_2#3601, cps_availqty#3588 AS cps_availqty_2#3602, cps_supplycost#3589 AS cps_supplycost_2#3603, cps_comment#3590 AS cps_comment_2#3604]
         :  +- Relation[rid#3577,cpfk_part_partsupp#3578,cfpk_partsupp_part#3579,cpfk_supplier_partsupp#3580,cfpk_partsupp_supplier#3581,cval_partsupp_ps_availqty#3582,cval_partsupp_ps_supplycost#3583,cval_partsupp_ps_comment#3584,cdepval_partsupp_ps_availqty#3585,cdepval_partsupp_ps_supplycost#3586,cdepval_partsupp_ps_comment#3587,cps_availqty#3588,cps_supplycost#3589,cps_comment#3590] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
            :- Project [rid#3541 AS rid_1#3559, cpfk_nation_supplier#3542 AS cpfk_nation_supplier_1#3560, cfpk_supplier_nation#3543 AS cfpk_supplier_nation_1#3561, cval_supplier_s_name#3544 AS cval_supplier_s_name_1#3562, cval_supplier_s_address#3545 AS cval_supplier_s_address_1#3563, cval_supplier_s_phone#3546 AS cval_supplier_s_phone_1#3564, cval_supplier_s_acctbal#3547 AS cval_supplier_s_acctbal_1#3565, cval_supplier_s_comment#3548 AS cval_supplier_s_comment_1#3566, cdepval_supplier_s_name#3549 AS cdepval_supplier_s_name_1#3567, cdepval_supplier_s_address#3550 AS cdepval_supplier_s_address_1#3568, cdepval_supplier_s_phone#3551 AS cdepval_supplier_s_phone_1#3569, cdepval_supplier_s_acctbal#3552 AS cdepval_supplier_s_acctbal_1#3570, cdepval_supplier_s_comment#3553 AS cdepval_supplier_s_comment_1#3571, cs_name#3554 AS cs_name_1#3572, cs_address#3555 AS cs_address_1#3573, cs_phone#3556 AS cs_phone_1#3574, cs_acctbal#3557 AS cs_acctbal_1#3575, cs_comment#3558 AS cs_comment_1#3576]
            :  +- Relation[rid#3541,cpfk_nation_supplier#3542,cfpk_supplier_nation#3543,cval_supplier_s_name#3544,cval_supplier_s_address#3545,cval_supplier_s_phone#3546,cval_supplier_s_acctbal#3547,cval_supplier_s_comment#3548,cdepval_supplier_s_name#3549,cdepval_supplier_s_address#3550,cdepval_supplier_s_phone#3551,cdepval_supplier_s_acctbal#3552,cdepval_supplier_s_comment#3553,cs_name#3554,cs_address#3555,cs_phone#3556,cs_acctbal#3557,cs_comment#3558] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
               +- Project [rid#3505 AS rid_0#3514, cpfk_region_nation#3506 AS cpfk_region_nation_0#3515, cfpk_nation_region#3507 AS cfpk_nation_region_0#3516, cval_nation_n_name#3508 AS cval_nation_n_name_0#3517, cval_nation_n_comment#3509 AS cval_nation_n_comment_0#3518, cdepval_nation_n_name#3510 AS cdepval_nation_n_name_0#3519, cdepval_nation_n_comment#3511 AS cdepval_nation_n_comment_0#3520, cn_name#3512 AS cn_name_0#3521, cn_comment#3513 AS cn_comment_0#3522]
                  +- Relation[rid#3505,cpfk_region_nation#3506,cfpk_nation_region#3507,cval_nation_n_name#3508,cval_nation_n_comment#3509,cdepval_nation_n_name#3510,cdepval_nation_n_comment#3511,cn_name#3512,cn_comment#3513] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 3441ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/25 23:02:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:02:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3655L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:02:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3655L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#3747 AS rid_2#3792, cpfk_orders_lineitem#3748 AS cpfk_orders_lineitem_2#3793, cpfk_supplier_lineitem#3749 AS cpfk_supplier_lineitem_2#3794, cfpk_lineitem_supplier#3750 AS cfpk_lineitem_supplier_2#3795, cfpk_lineitem_partsupp#3751 AS cfpk_lineitem_partsupp_2#3796, cpfk_part_lineitem#3752 AS cpfk_part_lineitem_2#3797, cfpk_lineitem_part#3753 AS cfpk_lineitem_part_2#3798, cpfk_partsupp_lineitem#3754 AS cpfk_partsupp_lineitem_2#3799, cfpk_lineitem_orders#3755 AS cfpk_lineitem_orders_2#3800, cval_lineitem_l_quantity#3756 AS cval_lineitem_l_quantity_2#3801, cval_lineitem_l_extendedprice#3757 AS cval_lineitem_l_extendedprice_2#3802, cval_lineitem_l_discount#3758 AS cval_lineitem_l_discount_2#3803, cval_lineitem_l_tax#3759 AS cval_lineitem_l_tax_2#3804, cval_lineitem_l_returnflag#3760 AS cval_lineitem_l_returnflag_2#3805, cval_lineitem_l_linestatus#3761 AS cval_lineitem_l_linestatus_2#3806, cval_lineitem_l_commitdate#3762 AS cval_lineitem_l_commitdate_2#3807, cval_lineitem_l_receiptdate#3763 AS cval_lineitem_l_receiptdate_2#3808, cval_lineitem_l_shipinstruct#3764 AS cval_lineitem_l_shipinstruct_2#3809, cval_lineitem_l_shipmode#3765 AS cval_lineitem_l_shipmode_2#3810, cval_lineitem_l_comment#3766 AS cval_lineitem_l_comment_2#3811, cval_lineitem_l_shipdate#3767 AS cval_lineitem_l_shipdate_2#3812, cdepval_lineitem_l_quantity#3768 AS cdepval_lineitem_l_quantity_2#3813, cdepval_lineitem_l_extendedprice#3769 AS cdepval_lineitem_l_extendedprice_2#3814, cdepval_lineitem_l_discount#3770 AS cdepval_lineitem_l_discount_2#3815, ... 21 more fields]
         :  +- Relation[rid#3747,cpfk_orders_lineitem#3748,cpfk_supplier_lineitem#3749,cfpk_lineitem_supplier#3750,cfpk_lineitem_partsupp#3751,cpfk_part_lineitem#3752,cfpk_lineitem_part#3753,cpfk_partsupp_lineitem#3754,cfpk_lineitem_orders#3755,cval_lineitem_l_quantity#3756,cval_lineitem_l_extendedprice#3757,cval_lineitem_l_discount#3758,cval_lineitem_l_tax#3759,cval_lineitem_l_returnflag#3760,cval_lineitem_l_linestatus#3761,cval_lineitem_l_commitdate#3762,cval_lineitem_l_receiptdate#3763,cval_lineitem_l_shipinstruct#3764,cval_lineitem_l_shipmode#3765,cval_lineitem_l_comment#3766,cval_lineitem_l_shipdate#3767,cdepval_lineitem_l_quantity#3768,cdepval_lineitem_l_extendedprice#3769,cdepval_lineitem_l_discount#3770,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#3699 AS rid_1#3723, cpfk_customer_orders#3700 AS cpfk_customer_orders_1#3724, cfpk_orders_customer#3701 AS cfpk_orders_customer_1#3725, cval_orders_o_orderstatus#3702 AS cval_orders_o_orderstatus_1#3726, cval_orders_o_totalprice#3703 AS cval_orders_o_totalprice_1#3727, cval_orders_o_orderpriority#3704 AS cval_orders_o_orderpriority_1#3728, cval_orders_o_clerk#3705 AS cval_orders_o_clerk_1#3729, cval_orders_o_shippriority#3706 AS cval_orders_o_shippriority_1#3730, cval_orders_o_comment#3707 AS cval_orders_o_comment_1#3731, cval_orders_o_orderdate#3708 AS cval_orders_o_orderdate_1#3732, cdepval_orders_o_orderstatus#3709 AS cdepval_orders_o_orderstatus_1#3733, cdepval_orders_o_totalprice#3710 AS cdepval_orders_o_totalprice_1#3734, cdepval_orders_o_orderpriority#3711 AS cdepval_orders_o_orderpriority_1#3735, cdepval_orders_o_clerk#3712 AS cdepval_orders_o_clerk_1#3736, cdepval_orders_o_shippriority#3713 AS cdepval_orders_o_shippriority_1#3737, cdepval_orders_o_comment#3714 AS cdepval_orders_o_comment_1#3738, cdepval_orders_o_orderdate#3715 AS cdepval_orders_o_orderdate_1#3739, co_orderstatus#3716 AS co_orderstatus_1#3740, co_totalprice#3717 AS co_totalprice_1#3741, co_orderpriority#3718 AS co_orderpriority_1#3742, co_clerk#3719 AS co_clerk_1#3743, co_shippriority#3720 AS co_shippriority_1#3744, co_comment#3721 AS co_comment_1#3745, co_orderdate#3722 AS co_orderdate_1#3746]
            :  +- Relation[rid#3699,cpfk_customer_orders#3700,cfpk_orders_customer#3701,cval_orders_o_orderstatus#3702,cval_orders_o_totalprice#3703,cval_orders_o_orderpriority#3704,cval_orders_o_clerk#3705,cval_orders_o_shippriority#3706,cval_orders_o_comment#3707,cval_orders_o_orderdate#3708,cdepval_orders_o_orderstatus#3709,cdepval_orders_o_totalprice#3710,cdepval_orders_o_orderpriority#3711,cdepval_orders_o_clerk#3712,cdepval_orders_o_shippriority#3713,cdepval_orders_o_comment#3714,cdepval_orders_o_orderdate#3715,co_orderstatus#3716,co_totalprice#3717,co_orderpriority#3718,co_clerk#3719,co_shippriority#3720,co_comment#3721,co_orderdate#3722] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#3657 AS rid_0#3678, cpfk_nation_customer#3658 AS cpfk_nation_customer_0#3679, cfpk_customer_nation#3659 AS cfpk_customer_nation_0#3680, cval_customer_c_name#3660 AS cval_customer_c_name_0#3681, cval_customer_c_address#3661 AS cval_customer_c_address_0#3682, cval_customer_c_phone#3662 AS cval_customer_c_phone_0#3683, cval_customer_c_acctbal#3663 AS cval_customer_c_acctbal_0#3684, cval_customer_c_comment#3664 AS cval_customer_c_comment_0#3685, cval_customer_c_mktsegment#3665 AS cval_customer_c_mktsegment_0#3686, cdepval_customer_c_name#3666 AS cdepval_customer_c_name_0#3687, cdepval_customer_c_address#3667 AS cdepval_customer_c_address_0#3688, cdepval_customer_c_phone#3668 AS cdepval_customer_c_phone_0#3689, cdepval_customer_c_acctbal#3669 AS cdepval_customer_c_acctbal_0#3690, cdepval_customer_c_comment#3670 AS cdepval_customer_c_comment_0#3691, cdepval_customer_c_mktsegment#3671 AS cdepval_customer_c_mktsegment_0#3692, cc_name#3672 AS cc_name_0#3693, cc_address#3673 AS cc_address_0#3694, cc_phone#3674 AS cc_phone_0#3695, cc_acctbal#3675 AS cc_acctbal_0#3696, cc_comment#3676 AS cc_comment_0#3697, cc_mktsegment#3677 AS cc_mktsegment_0#3698]
               +- Relation[rid#3657,cpfk_nation_customer#3658,cfpk_customer_nation#3659,cval_customer_c_name#3660,cval_customer_c_address#3661,cval_customer_c_phone#3662,cval_customer_c_acctbal#3663,cval_customer_c_comment#3664,cval_customer_c_mktsegment#3665,cdepval_customer_c_name#3666,cdepval_customer_c_address#3667,cdepval_customer_c_phone#3668,cdepval_customer_c_acctbal#3669,cdepval_customer_c_comment#3670,cdepval_customer_c_mktsegment#3671,cc_name#3672,cc_address#3673,cc_phone#3674,cc_acctbal#3675,cc_comment#3676,cc_mktsegment#3677] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 22567ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 23:02:24 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:02:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3936L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:02:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:02:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:02:24 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:02:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:02:24 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:02:24 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:02:24 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:02:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3936L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#3992 AS rid_2#4037, cpfk_orders_lineitem#3993 AS cpfk_orders_lineitem_2#4038, cpfk_supplier_lineitem#3994 AS cpfk_supplier_lineitem_2#4039, cfpk_lineitem_supplier#3995 AS cfpk_lineitem_supplier_2#4040, cfpk_lineitem_partsupp#3996 AS cfpk_lineitem_partsupp_2#4041, cpfk_part_lineitem#3997 AS cpfk_part_lineitem_2#4042, cfpk_lineitem_part#3998 AS cfpk_lineitem_part_2#4043, cpfk_partsupp_lineitem#3999 AS cpfk_partsupp_lineitem_2#4044, cfpk_lineitem_orders#4000 AS cfpk_lineitem_orders_2#4045, cval_lineitem_l_quantity#4001 AS cval_lineitem_l_quantity_2#4046, cval_lineitem_l_extendedprice#4002 AS cval_lineitem_l_extendedprice_2#4047, cval_lineitem_l_discount#4003 AS cval_lineitem_l_discount_2#4048, cval_lineitem_l_tax#4004 AS cval_lineitem_l_tax_2#4049, cval_lineitem_l_returnflag#4005 AS cval_lineitem_l_returnflag_2#4050, cval_lineitem_l_linestatus#4006 AS cval_lineitem_l_linestatus_2#4051, cval_lineitem_l_commitdate#4007 AS cval_lineitem_l_commitdate_2#4052, cval_lineitem_l_receiptdate#4008 AS cval_lineitem_l_receiptdate_2#4053, cval_lineitem_l_shipinstruct#4009 AS cval_lineitem_l_shipinstruct_2#4054, cval_lineitem_l_shipmode#4010 AS cval_lineitem_l_shipmode_2#4055, cval_lineitem_l_comment#4011 AS cval_lineitem_l_comment_2#4056, cval_lineitem_l_shipdate#4012 AS cval_lineitem_l_shipdate_2#4057, cdepval_lineitem_l_quantity#4013 AS cdepval_lineitem_l_quantity_2#4058, cdepval_lineitem_l_extendedprice#4014 AS cdepval_lineitem_l_extendedprice_2#4059, cdepval_lineitem_l_discount#4015 AS cdepval_lineitem_l_discount_2#4060, ... 21 more fields]
         :  :  :  :  +- Relation[rid#3992,cpfk_orders_lineitem#3993,cpfk_supplier_lineitem#3994,cfpk_lineitem_supplier#3995,cfpk_lineitem_partsupp#3996,cpfk_part_lineitem#3997,cfpk_lineitem_part#3998,cpfk_partsupp_lineitem#3999,cfpk_lineitem_orders#4000,cval_lineitem_l_quantity#4001,cval_lineitem_l_extendedprice#4002,cval_lineitem_l_discount#4003,cval_lineitem_l_tax#4004,cval_lineitem_l_returnflag#4005,cval_lineitem_l_linestatus#4006,cval_lineitem_l_commitdate#4007,cval_lineitem_l_receiptdate#4008,cval_lineitem_l_shipinstruct#4009,cval_lineitem_l_shipmode#4010,cval_lineitem_l_comment#4011,cval_lineitem_l_shipdate#4012,cdepval_lineitem_l_quantity#4013,cdepval_lineitem_l_extendedprice#4014,cdepval_lineitem_l_discount#4015,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#3956 AS rid_1#3974, cpfk_nation_supplier#3957 AS cpfk_nation_supplier_1#3975, cfpk_supplier_nation#3958 AS cfpk_supplier_nation_1#3976, cval_supplier_s_name#3959 AS cval_supplier_s_name_1#3977, cval_supplier_s_address#3960 AS cval_supplier_s_address_1#3978, cval_supplier_s_phone#3961 AS cval_supplier_s_phone_1#3979, cval_supplier_s_acctbal#3962 AS cval_supplier_s_acctbal_1#3980, cval_supplier_s_comment#3963 AS cval_supplier_s_comment_1#3981, cdepval_supplier_s_name#3964 AS cdepval_supplier_s_name_1#3982, cdepval_supplier_s_address#3965 AS cdepval_supplier_s_address_1#3983, cdepval_supplier_s_phone#3966 AS cdepval_supplier_s_phone_1#3984, cdepval_supplier_s_acctbal#3967 AS cdepval_supplier_s_acctbal_1#3985, cdepval_supplier_s_comment#3968 AS cdepval_supplier_s_comment_1#3986, cs_name#3969 AS cs_name_1#3987, cs_address#3970 AS cs_address_1#3988, cs_phone#3971 AS cs_phone_1#3989, cs_acctbal#3972 AS cs_acctbal_1#3990, cs_comment#3973 AS cs_comment_1#3991]
         :  :  :     :  +- Relation[rid#3956,cpfk_nation_supplier#3957,cfpk_supplier_nation#3958,cval_supplier_s_name#3959,cval_supplier_s_address#3960,cval_supplier_s_phone#3961,cval_supplier_s_acctbal#3962,cval_supplier_s_comment#3963,cdepval_supplier_s_name#3964,cdepval_supplier_s_address#3965,cdepval_supplier_s_phone#3966,cdepval_supplier_s_acctbal#3967,cdepval_supplier_s_comment#3968,cs_name#3969,cs_address#3970,cs_phone#3971,cs_acctbal#3972,cs_comment#3973] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#3938 AS rid_0#3947, cpfk_region_nation#3939 AS cpfk_region_nation_0#3948, cfpk_nation_region#3940 AS cfpk_nation_region_0#3949, cval_nation_n_name#3941 AS cval_nation_n_name_0#3950, cval_nation_n_comment#3942 AS cval_nation_n_comment_0#3951, cdepval_nation_n_name#3943 AS cdepval_nation_n_name_0#3952, cdepval_nation_n_comment#3944 AS cdepval_nation_n_comment_0#3953, cn_name#3945 AS cn_name_0#3954, cn_comment#3946 AS cn_comment_0#3955]
         :  :  :        +- Relation[rid#3938,cpfk_region_nation#3939,cfpk_nation_region#3940,cval_nation_n_name#3941,cval_nation_n_comment#3942,cdepval_nation_n_name#3943,cdepval_nation_n_comment#3944,cn_name#3945,cn_comment#3946] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#4082 AS rid_3#4107, cval_part_p_name#4083 AS cval_part_p_name_3#4108, cval_part_p_mfgr#4084 AS cval_part_p_mfgr_3#4109, cval_part_p_type#4085 AS cval_part_p_type_3#4110, cval_part_p_size#4086 AS cval_part_p_size_3#4111, cval_part_p_container#4087 AS cval_part_p_container_3#4112, cval_part_p_retailprice#4088 AS cval_part_p_retailprice_3#4113, cval_part_p_comment#4089 AS cval_part_p_comment_3#4114, cval_part_p_brand#4090 AS cval_part_p_brand_3#4115, cdepval_part_p_name#4091 AS cdepval_part_p_name_3#4116, cdepval_part_p_mfgr#4092 AS cdepval_part_p_mfgr_3#4117, cdepval_part_p_type#4093 AS cdepval_part_p_type_3#4118, cdepval_part_p_size#4094 AS cdepval_part_p_size_3#4119, cdepval_part_p_container#4095 AS cdepval_part_p_container_3#4120, cdepval_part_p_retailprice#4096 AS cdepval_part_p_retailprice_3#4121, cdepval_part_p_comment#4097 AS cdepval_part_p_comment_3#4122, cdepval_part_p_brand#4098 AS cdepval_part_p_brand_3#4123, cp_name#4099 AS cp_name_3#4124, cp_mfgr#4100 AS cp_mfgr_3#4125, cp_type#4101 AS cp_type_3#4126, cp_size#4102 AS cp_size_3#4127, cp_container#4103 AS cp_container_3#4128, cp_retailprice#4104 AS cp_retailprice_3#4129, cp_comment#4105 AS cp_comment_3#4130, cp_brand#4106 AS cp_brand_3#4131]
         :  :     +- Relation[rid#4082,cval_part_p_name#4083,cval_part_p_mfgr#4084,cval_part_p_type#4085,cval_part_p_size#4086,cval_part_p_container#4087,cval_part_p_retailprice#4088,cval_part_p_comment#4089,cval_part_p_brand#4090,cdepval_part_p_name#4091,cdepval_part_p_mfgr#4092,cdepval_part_p_type#4093,cdepval_part_p_size#4094,cdepval_part_p_container#4095,cdepval_part_p_retailprice#4096,cdepval_part_p_comment#4097,cdepval_part_p_brand#4098,cp_name#4099,cp_mfgr#4100,cp_type#4101,cp_size#4102,cp_container#4103,cp_retailprice#4104,cp_comment#4105,cp_brand#4106] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#4132 AS rid_4#4146, cpfk_part_partsupp#4133 AS cpfk_part_partsupp_4#4147, cfpk_partsupp_part#4134 AS cfpk_partsupp_part_4#4148, cpfk_supplier_partsupp#4135 AS cpfk_supplier_partsupp_4#4149, cfpk_partsupp_supplier#4136 AS cfpk_partsupp_supplier_4#4150, cval_partsupp_ps_availqty#4137 AS cval_partsupp_ps_availqty_4#4151, cval_partsupp_ps_supplycost#4138 AS cval_partsupp_ps_supplycost_4#4152, cval_partsupp_ps_comment#4139 AS cval_partsupp_ps_comment_4#4153, cdepval_partsupp_ps_availqty#4140 AS cdepval_partsupp_ps_availqty_4#4154, cdepval_partsupp_ps_supplycost#4141 AS cdepval_partsupp_ps_supplycost_4#4155, cdepval_partsupp_ps_comment#4142 AS cdepval_partsupp_ps_comment_4#4156, cps_availqty#4143 AS cps_availqty_4#4157, cps_supplycost#4144 AS cps_supplycost_4#4158, cps_comment#4145 AS cps_comment_4#4159]
         :     +- Relation[rid#4132,cpfk_part_partsupp#4133,cfpk_partsupp_part#4134,cpfk_supplier_partsupp#4135,cfpk_partsupp_supplier#4136,cval_partsupp_ps_availqty#4137,cval_partsupp_ps_supplycost#4138,cval_partsupp_ps_comment#4139,cdepval_partsupp_ps_availqty#4140,cdepval_partsupp_ps_supplycost#4141,cdepval_partsupp_ps_comment#4142,cps_availqty#4143,cps_supplycost#4144,cps_comment#4145] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#4160 AS rid_5#4184, cpfk_customer_orders#4161 AS cpfk_customer_orders_5#4185, cfpk_orders_customer#4162 AS cfpk_orders_customer_5#4186, cval_orders_o_orderstatus#4163 AS cval_orders_o_orderstatus_5#4187, cval_orders_o_totalprice#4164 AS cval_orders_o_totalprice_5#4188, cval_orders_o_orderpriority#4165 AS cval_orders_o_orderpriority_5#4189, cval_orders_o_clerk#4166 AS cval_orders_o_clerk_5#4190, cval_orders_o_shippriority#4167 AS cval_orders_o_shippriority_5#4191, cval_orders_o_comment#4168 AS cval_orders_o_comment_5#4192, cval_orders_o_orderdate#4169 AS cval_orders_o_orderdate_5#4193, cdepval_orders_o_orderstatus#4170 AS cdepval_orders_o_orderstatus_5#4194, cdepval_orders_o_totalprice#4171 AS cdepval_orders_o_totalprice_5#4195, cdepval_orders_o_orderpriority#4172 AS cdepval_orders_o_orderpriority_5#4196, cdepval_orders_o_clerk#4173 AS cdepval_orders_o_clerk_5#4197, cdepval_orders_o_shippriority#4174 AS cdepval_orders_o_shippriority_5#4198, cdepval_orders_o_comment#4175 AS cdepval_orders_o_comment_5#4199, cdepval_orders_o_orderdate#4176 AS cdepval_orders_o_orderdate_5#4200, co_orderstatus#4177 AS co_orderstatus_5#4201, co_totalprice#4178 AS co_totalprice_5#4202, co_orderpriority#4179 AS co_orderpriority_5#4203, co_clerk#4180 AS co_clerk_5#4204, co_shippriority#4181 AS co_shippriority_5#4205, co_comment#4182 AS co_comment_5#4206, co_orderdate#4183 AS co_orderdate_5#4207]
            +- Relation[rid#4160,cpfk_customer_orders#4161,cfpk_orders_customer#4162,cval_orders_o_orderstatus#4163,cval_orders_o_totalprice#4164,cval_orders_o_orderpriority#4165,cval_orders_o_clerk#4166,cval_orders_o_shippriority#4167,cval_orders_o_comment#4168,cval_orders_o_orderdate#4169,cdepval_orders_o_orderstatus#4170,cdepval_orders_o_totalprice#4171,cdepval_orders_o_orderpriority#4172,cdepval_orders_o_clerk#4173,cdepval_orders_o_shippriority#4174,cdepval_orders_o_comment#4175,cdepval_orders_o_orderdate#4176,co_orderstatus#4177,co_totalprice#4178,co_orderpriority#4179,co_clerk#4180,co_shippriority#4181,co_comment#4182,co_orderdate#4183] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 63567ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/25 23:03:28 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:03:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4347L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 23:03:28 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:03:28 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:03:28 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:03:28 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:03:28 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:03:28 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:03:28 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:03:28 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:03:28 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:03:28 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:03:28 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:03:28 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:03:28 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:03:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4347L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_part_4) = 'rid_3)
         :  :- Project [rid#4531 AS rid_4#4545, cpfk_part_partsupp#4532 AS cpfk_part_partsupp_4#4546, cfpk_partsupp_part#4533 AS cfpk_partsupp_part_4#4547, cpfk_supplier_partsupp#4534 AS cpfk_supplier_partsupp_4#4548, cfpk_partsupp_supplier#4535 AS cfpk_partsupp_supplier_4#4549, cval_partsupp_ps_availqty#4536 AS cval_partsupp_ps_availqty_4#4550, cval_partsupp_ps_supplycost#4537 AS cval_partsupp_ps_supplycost_4#4551, cval_partsupp_ps_comment#4538 AS cval_partsupp_ps_comment_4#4552, cdepval_partsupp_ps_availqty#4539 AS cdepval_partsupp_ps_availqty_4#4553, cdepval_partsupp_ps_supplycost#4540 AS cdepval_partsupp_ps_supplycost_4#4554, cdepval_partsupp_ps_comment#4541 AS cdepval_partsupp_ps_comment_4#4555, cps_availqty#4542 AS cps_availqty_4#4556, cps_supplycost#4543 AS cps_supplycost_4#4557, cps_comment#4544 AS cps_comment_4#4558]
         :  :  +- Relation[rid#4531,cpfk_part_partsupp#4532,cfpk_partsupp_part#4533,cpfk_supplier_partsupp#4534,cfpk_partsupp_supplier#4535,cval_partsupp_ps_availqty#4536,cval_partsupp_ps_supplycost#4537,cval_partsupp_ps_comment#4538,cdepval_partsupp_ps_availqty#4539,cdepval_partsupp_ps_supplycost#4540,cdepval_partsupp_ps_comment#4541,cps_availqty#4542,cps_supplycost#4543,cps_comment#4544] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :     +- Project [rid#4431 AS rid_3#4456, cval_part_p_name#4432 AS cval_part_p_name_3#4457, cval_part_p_mfgr#4433 AS cval_part_p_mfgr_3#4458, cval_part_p_type#4434 AS cval_part_p_type_3#4459, cval_part_p_size#4435 AS cval_part_p_size_3#4460, cval_part_p_container#4436 AS cval_part_p_container_3#4461, cval_part_p_retailprice#4437 AS cval_part_p_retailprice_3#4462, cval_part_p_comment#4438 AS cval_part_p_comment_3#4463, cval_part_p_brand#4439 AS cval_part_p_brand_3#4464, cdepval_part_p_name#4440 AS cdepval_part_p_name_3#4465, cdepval_part_p_mfgr#4441 AS cdepval_part_p_mfgr_3#4466, cdepval_part_p_type#4442 AS cdepval_part_p_type_3#4467, cdepval_part_p_size#4443 AS cdepval_part_p_size_3#4468, cdepval_part_p_container#4444 AS cdepval_part_p_container_3#4469, cdepval_part_p_retailprice#4445 AS cdepval_part_p_retailprice_3#4470, cdepval_part_p_comment#4446 AS cdepval_part_p_comment_3#4471, cdepval_part_p_brand#4447 AS cdepval_part_p_brand_3#4472, cp_name#4448 AS cp_name_3#4473, cp_mfgr#4449 AS cp_mfgr_3#4474, cp_type#4450 AS cp_type_3#4475, cp_size#4451 AS cp_size_3#4476, cp_container#4452 AS cp_container_3#4477, cp_retailprice#4453 AS cp_retailprice_3#4478, cp_comment#4454 AS cp_comment_3#4479, cp_brand#4455 AS cp_brand_3#4480]
         :        +- Relation[rid#4431,cval_part_p_name#4432,cval_part_p_mfgr#4433,cval_part_p_type#4434,cval_part_p_size#4435,cval_part_p_container#4436,cval_part_p_retailprice#4437,cval_part_p_comment#4438,cval_part_p_brand#4439,cdepval_part_p_name#4440,cdepval_part_p_mfgr#4441,cdepval_part_p_type#4442,cdepval_part_p_size#4443,cdepval_part_p_container#4444,cdepval_part_p_retailprice#4445,cdepval_part_p_comment#4446,cdepval_part_p_brand#4447,cp_name#4448,cp_mfgr#4449,cp_type#4450,cp_size#4451,cp_container#4452,cp_retailprice#4453,cp_comment#4454,cp_brand#4455] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#4395 AS rid_2#4413, cpfk_nation_supplier#4396 AS cpfk_nation_supplier_2#4414, cfpk_supplier_nation#4397 AS cfpk_supplier_nation_2#4415, cval_supplier_s_name#4398 AS cval_supplier_s_name_2#4416, cval_supplier_s_address#4399 AS cval_supplier_s_address_2#4417, cval_supplier_s_phone#4400 AS cval_supplier_s_phone_2#4418, cval_supplier_s_acctbal#4401 AS cval_supplier_s_acctbal_2#4419, cval_supplier_s_comment#4402 AS cval_supplier_s_comment_2#4420, cdepval_supplier_s_name#4403 AS cdepval_supplier_s_name_2#4421, cdepval_supplier_s_address#4404 AS cdepval_supplier_s_address_2#4422, cdepval_supplier_s_phone#4405 AS cdepval_supplier_s_phone_2#4423, cdepval_supplier_s_acctbal#4406 AS cdepval_supplier_s_acctbal_2#4424, cdepval_supplier_s_comment#4407 AS cdepval_supplier_s_comment_2#4425, cs_name#4408 AS cs_name_2#4426, cs_address#4409 AS cs_address_2#4427, cs_phone#4410 AS cs_phone_2#4428, cs_acctbal#4411 AS cs_acctbal_2#4429, cs_comment#4412 AS cs_comment_2#4430]
            :  +- Relation[rid#4395,cpfk_nation_supplier#4396,cfpk_supplier_nation#4397,cval_supplier_s_name#4398,cval_supplier_s_address#4399,cval_supplier_s_phone#4400,cval_supplier_s_acctbal#4401,cval_supplier_s_comment#4402,cdepval_supplier_s_name#4403,cdepval_supplier_s_address#4404,cdepval_supplier_s_phone#4405,cdepval_supplier_s_acctbal#4406,cdepval_supplier_s_comment#4407,cs_name#4408,cs_address#4409,cs_phone#4410,cs_acctbal#4411,cs_comment#4412] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
               :- Project [rid#4377 AS rid_1#4386, cpfk_region_nation#4378 AS cpfk_region_nation_1#4387, cfpk_nation_region#4379 AS cfpk_nation_region_1#4388, cval_nation_n_name#4380 AS cval_nation_n_name_1#4389, cval_nation_n_comment#4381 AS cval_nation_n_comment_1#4390, cdepval_nation_n_name#4382 AS cdepval_nation_n_name_1#4391, cdepval_nation_n_comment#4383 AS cdepval_nation_n_comment_1#4392, cn_name#4384 AS cn_name_1#4393, cn_comment#4385 AS cn_comment_1#4394]
               :  +- Relation[rid#4377,cpfk_region_nation#4378,cfpk_nation_region#4379,cval_nation_n_name#4380,cval_nation_n_comment#4381,cdepval_nation_n_name#4382,cdepval_nation_n_comment#4383,cn_name#4384,cn_comment#4385] JDBCRelation(tnation) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
                  +- Project [rid#4349 AS rid_0#4356, cval_region_r_name#4350 AS cval_region_r_name_0#4357, cval_region_r_comment#4351 AS cval_region_r_comment_0#4358, cdepval_region_r_name#4352 AS cdepval_region_r_name_0#4359, cdepval_region_r_comment#4353 AS cdepval_region_r_comment_0#4360, cr_name#4354 AS cr_name_0#4361, cr_comment#4355 AS cr_comment_0#4362]
                     +- Relation[rid#4349,cval_region_r_name#4350,cval_region_r_comment#4351,cdepval_region_r_name#4352,cdepval_region_r_comment#4353,cr_name#4354,cr_comment#4355] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 3564ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/25 23:03:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:03:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4639L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:03:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:03:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:03:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:03:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:03:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:03:32 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:03:32 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:03:32 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:03:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:03:32 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 23:03:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:03:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:03:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4639L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :  :  :  :- Project [rid#4741 AS rid_1#4786, cpfk_orders_lineitem#4742 AS cpfk_orders_lineitem_1#4787, cpfk_supplier_lineitem#4743 AS cpfk_supplier_lineitem_1#4788, cfpk_lineitem_supplier#4744 AS cfpk_lineitem_supplier_1#4789, cfpk_lineitem_partsupp#4745 AS cfpk_lineitem_partsupp_1#4790, cpfk_part_lineitem#4746 AS cpfk_part_lineitem_1#4791, cfpk_lineitem_part#4747 AS cfpk_lineitem_part_1#4792, cpfk_partsupp_lineitem#4748 AS cpfk_partsupp_lineitem_1#4793, cfpk_lineitem_orders#4749 AS cfpk_lineitem_orders_1#4794, cval_lineitem_l_quantity#4750 AS cval_lineitem_l_quantity_1#4795, cval_lineitem_l_extendedprice#4751 AS cval_lineitem_l_extendedprice_1#4796, cval_lineitem_l_discount#4752 AS cval_lineitem_l_discount_1#4797, cval_lineitem_l_tax#4753 AS cval_lineitem_l_tax_1#4798, cval_lineitem_l_returnflag#4754 AS cval_lineitem_l_returnflag_1#4799, cval_lineitem_l_linestatus#4755 AS cval_lineitem_l_linestatus_1#4800, cval_lineitem_l_commitdate#4756 AS cval_lineitem_l_commitdate_1#4801, cval_lineitem_l_receiptdate#4757 AS cval_lineitem_l_receiptdate_1#4802, cval_lineitem_l_shipinstruct#4758 AS cval_lineitem_l_shipinstruct_1#4803, cval_lineitem_l_shipmode#4759 AS cval_lineitem_l_shipmode_1#4804, cval_lineitem_l_comment#4760 AS cval_lineitem_l_comment_1#4805, cval_lineitem_l_shipdate#4761 AS cval_lineitem_l_shipdate_1#4806, cdepval_lineitem_l_quantity#4762 AS cdepval_lineitem_l_quantity_1#4807, cdepval_lineitem_l_extendedprice#4763 AS cdepval_lineitem_l_extendedprice_1#4808, cdepval_lineitem_l_discount#4764 AS cdepval_lineitem_l_discount_1#4809, ... 21 more fields]
         :  :  :  :  +- Relation[rid#4741,cpfk_orders_lineitem#4742,cpfk_supplier_lineitem#4743,cfpk_lineitem_supplier#4744,cfpk_lineitem_partsupp#4745,cpfk_part_lineitem#4746,cfpk_lineitem_part#4747,cpfk_partsupp_lineitem#4748,cfpk_lineitem_orders#4749,cval_lineitem_l_quantity#4750,cval_lineitem_l_extendedprice#4751,cval_lineitem_l_discount#4752,cval_lineitem_l_tax#4753,cval_lineitem_l_returnflag#4754,cval_lineitem_l_linestatus#4755,cval_lineitem_l_commitdate#4756,cval_lineitem_l_receiptdate#4757,cval_lineitem_l_shipinstruct#4758,cval_lineitem_l_shipmode#4759,cval_lineitem_l_comment#4760,cval_lineitem_l_shipdate#4761,cdepval_lineitem_l_quantity#4762,cdepval_lineitem_l_extendedprice#4763,cdepval_lineitem_l_discount#4764,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :     +- Project [rid#4641 AS rid_0#4666, cval_part_p_name#4642 AS cval_part_p_name_0#4667, cval_part_p_mfgr#4643 AS cval_part_p_mfgr_0#4668, cval_part_p_type#4644 AS cval_part_p_type_0#4669, cval_part_p_size#4645 AS cval_part_p_size_0#4670, cval_part_p_container#4646 AS cval_part_p_container_0#4671, cval_part_p_retailprice#4647 AS cval_part_p_retailprice_0#4672, cval_part_p_comment#4648 AS cval_part_p_comment_0#4673, cval_part_p_brand#4649 AS cval_part_p_brand_0#4674, cdepval_part_p_name#4650 AS cdepval_part_p_name_0#4675, cdepval_part_p_mfgr#4651 AS cdepval_part_p_mfgr_0#4676, cdepval_part_p_type#4652 AS cdepval_part_p_type_0#4677, cdepval_part_p_size#4653 AS cdepval_part_p_size_0#4678, cdepval_part_p_container#4654 AS cdepval_part_p_container_0#4679, cdepval_part_p_retailprice#4655 AS cdepval_part_p_retailprice_0#4680, cdepval_part_p_comment#4656 AS cdepval_part_p_comment_0#4681, cdepval_part_p_brand#4657 AS cdepval_part_p_brand_0#4682, cp_name#4658 AS cp_name_0#4683, cp_mfgr#4659 AS cp_mfgr_0#4684, cp_type#4660 AS cp_type_0#4685, cp_size#4661 AS cp_size_0#4686, cp_container#4662 AS cp_container_0#4687, cp_retailprice#4663 AS cp_retailprice_0#4688, cp_comment#4664 AS cp_comment_0#4689, cp_brand#4665 AS cp_brand_0#4690]
         :  :  :        +- Relation[rid#4641,cval_part_p_name#4642,cval_part_p_mfgr#4643,cval_part_p_type#4644,cval_part_p_size#4645,cval_part_p_container#4646,cval_part_p_retailprice#4647,cval_part_p_comment#4648,cval_part_p_brand#4649,cdepval_part_p_name#4650,cdepval_part_p_mfgr#4651,cdepval_part_p_type#4652,cdepval_part_p_size#4653,cdepval_part_p_container#4654,cdepval_part_p_retailprice#4655,cdepval_part_p_comment#4656,cdepval_part_p_brand#4657,cp_name#4658,cp_mfgr#4659,cp_type#4660,cp_size#4661,cp_container#4662,cp_retailprice#4663,cp_comment#4664,cp_brand#4665] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- Project [rid#4831 AS rid_2#4849, cpfk_nation_supplier#4832 AS cpfk_nation_supplier_2#4850, cfpk_supplier_nation#4833 AS cfpk_supplier_nation_2#4851, cval_supplier_s_name#4834 AS cval_supplier_s_name_2#4852, cval_supplier_s_address#4835 AS cval_supplier_s_address_2#4853, cval_supplier_s_phone#4836 AS cval_supplier_s_phone_2#4854, cval_supplier_s_acctbal#4837 AS cval_supplier_s_acctbal_2#4855, cval_supplier_s_comment#4838 AS cval_supplier_s_comment_2#4856, cdepval_supplier_s_name#4839 AS cdepval_supplier_s_name_2#4857, cdepval_supplier_s_address#4840 AS cdepval_supplier_s_address_2#4858, cdepval_supplier_s_phone#4841 AS cdepval_supplier_s_phone_2#4859, cdepval_supplier_s_acctbal#4842 AS cdepval_supplier_s_acctbal_2#4860, cdepval_supplier_s_comment#4843 AS cdepval_supplier_s_comment_2#4861, cs_name#4844 AS cs_name_2#4862, cs_address#4845 AS cs_address_2#4863, cs_phone#4846 AS cs_phone_2#4864, cs_acctbal#4847 AS cs_acctbal_2#4865, cs_comment#4848 AS cs_comment_2#4866]
         :  :     +- Relation[rid#4831,cpfk_nation_supplier#4832,cfpk_supplier_nation#4833,cval_supplier_s_name#4834,cval_supplier_s_address#4835,cval_supplier_s_phone#4836,cval_supplier_s_acctbal#4837,cval_supplier_s_comment#4838,cdepval_supplier_s_name#4839,cdepval_supplier_s_address#4840,cdepval_supplier_s_phone#4841,cdepval_supplier_s_acctbal#4842,cdepval_supplier_s_comment#4843,cs_name#4844,cs_address#4845,cs_phone#4846,cs_acctbal#4847,cs_comment#4848] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#4867 AS rid_3#4876, cpfk_region_nation#4868 AS cpfk_region_nation_3#4877, cfpk_nation_region#4869 AS cfpk_nation_region_3#4878, cval_nation_n_name#4870 AS cval_nation_n_name_3#4879, cval_nation_n_comment#4871 AS cval_nation_n_comment_3#4880, cdepval_nation_n_name#4872 AS cdepval_nation_n_name_3#4881, cdepval_nation_n_comment#4873 AS cdepval_nation_n_comment_3#4882, cn_name#4874 AS cn_name_3#4883, cn_comment#4875 AS cn_comment_3#4884]
         :     +- Relation[rid#4867,cpfk_region_nation#4868,cfpk_nation_region#4869,cval_nation_n_name#4870,cval_nation_n_comment#4871,cdepval_nation_n_name#4872,cdepval_nation_n_comment#4873,cn_name#4874,cn_comment#4875] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#4973 AS rid_7#4997, cpfk_customer_orders#4974 AS cpfk_customer_orders_7#4998, cfpk_orders_customer#4975 AS cfpk_orders_customer_7#4999, cval_orders_o_orderstatus#4976 AS cval_orders_o_orderstatus_7#5000, cval_orders_o_totalprice#4977 AS cval_orders_o_totalprice_7#5001, cval_orders_o_orderpriority#4978 AS cval_orders_o_orderpriority_7#5002, cval_orders_o_clerk#4979 AS cval_orders_o_clerk_7#5003, cval_orders_o_shippriority#4980 AS cval_orders_o_shippriority_7#5004, cval_orders_o_comment#4981 AS cval_orders_o_comment_7#5005, cval_orders_o_orderdate#4982 AS cval_orders_o_orderdate_7#5006, cdepval_orders_o_orderstatus#4983 AS cdepval_orders_o_orderstatus_7#5007, cdepval_orders_o_totalprice#4984 AS cdepval_orders_o_totalprice_7#5008, cdepval_orders_o_orderpriority#4985 AS cdepval_orders_o_orderpriority_7#5009, cdepval_orders_o_clerk#4986 AS cdepval_orders_o_clerk_7#5010, cdepval_orders_o_shippriority#4987 AS cdepval_orders_o_shippriority_7#5011, cdepval_orders_o_comment#4988 AS cdepval_orders_o_comment_7#5012, cdepval_orders_o_orderdate#4989 AS cdepval_orders_o_orderdate_7#5013, co_orderstatus#4990 AS co_orderstatus_7#5014, co_totalprice#4991 AS co_totalprice_7#5015, co_orderpriority#4992 AS co_orderpriority_7#5016, co_clerk#4993 AS co_clerk_7#5017, co_shippriority#4994 AS co_shippriority_7#5018, co_comment#4995 AS co_comment_7#5019, co_orderdate#4996 AS co_orderdate_7#5020]
            :  +- Relation[rid#4973,cpfk_customer_orders#4974,cfpk_orders_customer#4975,cval_orders_o_orderstatus#4976,cval_orders_o_totalprice#4977,cval_orders_o_orderpriority#4978,cval_orders_o_clerk#4979,cval_orders_o_shippriority#4980,cval_orders_o_comment#4981,cval_orders_o_orderdate#4982,cdepval_orders_o_orderstatus#4983,cdepval_orders_o_totalprice#4984,cdepval_orders_o_orderpriority#4985,cdepval_orders_o_clerk#4986,cdepval_orders_o_shippriority#4987,cdepval_orders_o_comment#4988,cdepval_orders_o_orderdate#4989,co_orderstatus#4990,co_totalprice#4991,co_orderpriority#4992,co_clerk#4993,co_shippriority#4994,co_comment#4995,co_orderdate#4996] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#4931 AS rid_6#4952, cpfk_nation_customer#4932 AS cpfk_nation_customer_6#4953, cfpk_customer_nation#4933 AS cfpk_customer_nation_6#4954, cval_customer_c_name#4934 AS cval_customer_c_name_6#4955, cval_customer_c_address#4935 AS cval_customer_c_address_6#4956, cval_customer_c_phone#4936 AS cval_customer_c_phone_6#4957, cval_customer_c_acctbal#4937 AS cval_customer_c_acctbal_6#4958, cval_customer_c_comment#4938 AS cval_customer_c_comment_6#4959, cval_customer_c_mktsegment#4939 AS cval_customer_c_mktsegment_6#4960, cdepval_customer_c_name#4940 AS cdepval_customer_c_name_6#4961, cdepval_customer_c_address#4941 AS cdepval_customer_c_address_6#4962, cdepval_customer_c_phone#4942 AS cdepval_customer_c_phone_6#4963, cdepval_customer_c_acctbal#4943 AS cdepval_customer_c_acctbal_6#4964, cdepval_customer_c_comment#4944 AS cdepval_customer_c_comment_6#4965, cdepval_customer_c_mktsegment#4945 AS cdepval_customer_c_mktsegment_6#4966, cc_name#4946 AS cc_name_6#4967, cc_address#4947 AS cc_address_6#4968, cc_phone#4948 AS cc_phone_6#4969, cc_acctbal#4949 AS cc_acctbal_6#4970, cc_comment#4950 AS cc_comment_6#4971, cc_mktsegment#4951 AS cc_mktsegment_6#4972]
               :  +- Relation[rid#4931,cpfk_nation_customer#4932,cfpk_customer_nation#4933,cval_customer_c_name#4934,cval_customer_c_address#4935,cval_customer_c_phone#4936,cval_customer_c_acctbal#4937,cval_customer_c_comment#4938,cval_customer_c_mktsegment#4939,cdepval_customer_c_name#4940,cdepval_customer_c_address#4941,cdepval_customer_c_phone#4942,cdepval_customer_c_acctbal#4943,cdepval_customer_c_comment#4944,cdepval_customer_c_mktsegment#4945,cc_name#4946,cc_address#4947,cc_phone#4948,cc_acctbal#4949,cc_comment#4950,cc_mktsegment#4951] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_5, BinaryType)), 'cfpk_nation_region_5) = 'rid_4)
                  :- Project [rid#4913 AS rid_5#4922, cpfk_region_nation#4914 AS cpfk_region_nation_5#4923, cfpk_nation_region#4915 AS cfpk_nation_region_5#4924, cval_nation_n_name#4916 AS cval_nation_n_name_5#4925, cval_nation_n_comment#4917 AS cval_nation_n_comment_5#4926, cdepval_nation_n_name#4918 AS cdepval_nation_n_name_5#4927, cdepval_nation_n_comment#4919 AS cdepval_nation_n_comment_5#4928, cn_name#4920 AS cn_name_5#4929, cn_comment#4921 AS cn_comment_5#4930]
                  :  +- Relation[rid#4913,cpfk_region_nation#4914,cfpk_nation_region#4915,cval_nation_n_name#4916,cval_nation_n_comment#4917,cdepval_nation_n_name#4918,cdepval_nation_n_comment#4919,cn_name#4920,cn_comment#4921] JDBCRelation(tnation) [numPartitions=1]
                  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                     +- Project [rid#4885 AS rid_4#4892, cval_region_r_name#4886 AS cval_region_r_name_4#4893, cval_region_r_comment#4887 AS cval_region_r_comment_4#4894, cdepval_region_r_name#4888 AS cdepval_region_r_name_4#4895, cdepval_region_r_comment#4889 AS cdepval_region_r_comment_4#4896, cr_name#4890 AS cr_name_4#4897, cr_comment#4891 AS cr_comment_4#4898]
                        +- Relation[rid#4885,cval_region_r_name#4886,cval_region_r_comment#4887,cdepval_region_r_name#4888,cdepval_region_r_comment#4889,cr_name#4890,cr_comment#4891] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 44679ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/25 23:04:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:04:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5184L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:04:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#5184L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#5186 AS rid_0#5231, cpfk_orders_lineitem#5187 AS cpfk_orders_lineitem_0#5232, cpfk_supplier_lineitem#5188 AS cpfk_supplier_lineitem_0#5233, cfpk_lineitem_supplier#5189 AS cfpk_lineitem_supplier_0#5234, cfpk_lineitem_partsupp#5190 AS cfpk_lineitem_partsupp_0#5235, cpfk_part_lineitem#5191 AS cpfk_part_lineitem_0#5236, cfpk_lineitem_part#5192 AS cfpk_lineitem_part_0#5237, cpfk_partsupp_lineitem#5193 AS cpfk_partsupp_lineitem_0#5238, cfpk_lineitem_orders#5194 AS cfpk_lineitem_orders_0#5239, cval_lineitem_l_quantity#5195 AS cval_lineitem_l_quantity_0#5240, cval_lineitem_l_extendedprice#5196 AS cval_lineitem_l_extendedprice_0#5241, cval_lineitem_l_discount#5197 AS cval_lineitem_l_discount_0#5242, cval_lineitem_l_tax#5198 AS cval_lineitem_l_tax_0#5243, cval_lineitem_l_returnflag#5199 AS cval_lineitem_l_returnflag_0#5244, cval_lineitem_l_linestatus#5200 AS cval_lineitem_l_linestatus_0#5245, cval_lineitem_l_commitdate#5201 AS cval_lineitem_l_commitdate_0#5246, cval_lineitem_l_receiptdate#5202 AS cval_lineitem_l_receiptdate_0#5247, cval_lineitem_l_shipinstruct#5203 AS cval_lineitem_l_shipinstruct_0#5248, cval_lineitem_l_shipmode#5204 AS cval_lineitem_l_shipmode_0#5249, cval_lineitem_l_comment#5205 AS cval_lineitem_l_comment_0#5250, cval_lineitem_l_shipdate#5206 AS cval_lineitem_l_shipdate_0#5251, cdepval_lineitem_l_quantity#5207 AS cdepval_lineitem_l_quantity_0#5252, cdepval_lineitem_l_extendedprice#5208 AS cdepval_lineitem_l_extendedprice_0#5253, cdepval_lineitem_l_discount#5209 AS cdepval_lineitem_l_discount_0#5254, ... 21 more fields]
         +- Relation[rid#5186,cpfk_orders_lineitem#5187,cpfk_supplier_lineitem#5188,cfpk_lineitem_supplier#5189,cfpk_lineitem_partsupp#5190,cpfk_part_lineitem#5191,cfpk_lineitem_part#5192,cpfk_partsupp_lineitem#5193,cfpk_lineitem_orders#5194,cval_lineitem_l_quantity#5195,cval_lineitem_l_extendedprice#5196,cval_lineitem_l_discount#5197,cval_lineitem_l_tax#5198,cval_lineitem_l_returnflag#5199,cval_lineitem_l_linestatus#5200,cval_lineitem_l_commitdate#5201,cval_lineitem_l_receiptdate#5202,cval_lineitem_l_shipinstruct#5203,cval_lineitem_l_shipmode#5204,cval_lineitem_l_comment#5205,cval_lineitem_l_shipdate#5206,cdepval_lineitem_l_quantity#5207,cdepval_lineitem_l_extendedprice#5208,cdepval_lineitem_l_discount#5209,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2352ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/25 23:04:19 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:04:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5325L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 23:04:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5325L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#5327 AS rid_0#5351, cpfk_customer_orders#5328 AS cpfk_customer_orders_0#5352, cfpk_orders_customer#5329 AS cfpk_orders_customer_0#5353, cval_orders_o_orderstatus#5330 AS cval_orders_o_orderstatus_0#5354, cval_orders_o_totalprice#5331 AS cval_orders_o_totalprice_0#5355, cval_orders_o_orderpriority#5332 AS cval_orders_o_orderpriority_0#5356, cval_orders_o_clerk#5333 AS cval_orders_o_clerk_0#5357, cval_orders_o_shippriority#5334 AS cval_orders_o_shippriority_0#5358, cval_orders_o_comment#5335 AS cval_orders_o_comment_0#5359, cval_orders_o_orderdate#5336 AS cval_orders_o_orderdate_0#5360, cdepval_orders_o_orderstatus#5337 AS cdepval_orders_o_orderstatus_0#5361, cdepval_orders_o_totalprice#5338 AS cdepval_orders_o_totalprice_0#5362, cdepval_orders_o_orderpriority#5339 AS cdepval_orders_o_orderpriority_0#5363, cdepval_orders_o_clerk#5340 AS cdepval_orders_o_clerk_0#5364, cdepval_orders_o_shippriority#5341 AS cdepval_orders_o_shippriority_0#5365, cdepval_orders_o_comment#5342 AS cdepval_orders_o_comment_0#5366, cdepval_orders_o_orderdate#5343 AS cdepval_orders_o_orderdate_0#5367, co_orderstatus#5344 AS co_orderstatus_0#5368, co_totalprice#5345 AS co_totalprice_0#5369, co_orderpriority#5346 AS co_orderpriority_0#5370, co_clerk#5347 AS co_clerk_0#5371, co_shippriority#5348 AS co_shippriority_0#5372, co_comment#5349 AS co_comment_0#5373, co_orderdate#5350 AS co_orderdate_0#5374]
         :  +- Relation[rid#5327,cpfk_customer_orders#5328,cfpk_orders_customer#5329,cval_orders_o_orderstatus#5330,cval_orders_o_totalprice#5331,cval_orders_o_orderpriority#5332,cval_orders_o_clerk#5333,cval_orders_o_shippriority#5334,cval_orders_o_comment#5335,cval_orders_o_orderdate#5336,cdepval_orders_o_orderstatus#5337,cdepval_orders_o_totalprice#5338,cdepval_orders_o_orderpriority#5339,cdepval_orders_o_clerk#5340,cdepval_orders_o_shippriority#5341,cdepval_orders_o_comment#5342,cdepval_orders_o_orderdate#5343,co_orderstatus#5344,co_totalprice#5345,co_orderpriority#5346,co_clerk#5347,co_shippriority#5348,co_comment#5349,co_orderdate#5350] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#5375 AS rid_1#5396, cpfk_nation_customer#5376 AS cpfk_nation_customer_1#5397, cfpk_customer_nation#5377 AS cfpk_customer_nation_1#5398, cval_customer_c_name#5378 AS cval_customer_c_name_1#5399, cval_customer_c_address#5379 AS cval_customer_c_address_1#5400, cval_customer_c_phone#5380 AS cval_customer_c_phone_1#5401, cval_customer_c_acctbal#5381 AS cval_customer_c_acctbal_1#5402, cval_customer_c_comment#5382 AS cval_customer_c_comment_1#5403, cval_customer_c_mktsegment#5383 AS cval_customer_c_mktsegment_1#5404, cdepval_customer_c_name#5384 AS cdepval_customer_c_name_1#5405, cdepval_customer_c_address#5385 AS cdepval_customer_c_address_1#5406, cdepval_customer_c_phone#5386 AS cdepval_customer_c_phone_1#5407, cdepval_customer_c_acctbal#5387 AS cdepval_customer_c_acctbal_1#5408, cdepval_customer_c_comment#5388 AS cdepval_customer_c_comment_1#5409, cdepval_customer_c_mktsegment#5389 AS cdepval_customer_c_mktsegment_1#5410, cc_name#5390 AS cc_name_1#5411, cc_address#5391 AS cc_address_1#5412, cc_phone#5392 AS cc_phone_1#5413, cc_acctbal#5393 AS cc_acctbal_1#5414, cc_comment#5394 AS cc_comment_1#5415, cc_mktsegment#5395 AS cc_mktsegment_1#5416]
            +- Relation[rid#5375,cpfk_nation_customer#5376,cfpk_customer_nation#5377,cval_customer_c_name#5378,cval_customer_c_address#5379,cval_customer_c_phone#5380,cval_customer_c_acctbal#5381,cval_customer_c_comment#5382,cval_customer_c_mktsegment#5383,cdepval_customer_c_name#5384,cdepval_customer_c_address#5385,cdepval_customer_c_phone#5386,cdepval_customer_c_acctbal#5387,cdepval_customer_c_comment#5388,cdepval_customer_c_mktsegment#5389,cc_name#5390,cc_address#5391,cc_phone#5392,cc_acctbal#5393,cc_comment#5394,cc_mktsegment#5395] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4394ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/25 23:04:23 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:04:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5470L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:04:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:04:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:04:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:04:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:04:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:04:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:04:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:04:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:04:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:04:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:04:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:04:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5470L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#5544 AS rid_2#5589, cpfk_orders_lineitem#5545 AS cpfk_orders_lineitem_2#5590, cpfk_supplier_lineitem#5546 AS cpfk_supplier_lineitem_2#5591, cfpk_lineitem_supplier#5547 AS cfpk_lineitem_supplier_2#5592, cfpk_lineitem_partsupp#5548 AS cfpk_lineitem_partsupp_2#5593, cpfk_part_lineitem#5549 AS cpfk_part_lineitem_2#5594, cfpk_lineitem_part#5550 AS cfpk_lineitem_part_2#5595, cpfk_partsupp_lineitem#5551 AS cpfk_partsupp_lineitem_2#5596, cfpk_lineitem_orders#5552 AS cfpk_lineitem_orders_2#5597, cval_lineitem_l_quantity#5553 AS cval_lineitem_l_quantity_2#5598, cval_lineitem_l_extendedprice#5554 AS cval_lineitem_l_extendedprice_2#5599, cval_lineitem_l_discount#5555 AS cval_lineitem_l_discount_2#5600, cval_lineitem_l_tax#5556 AS cval_lineitem_l_tax_2#5601, cval_lineitem_l_returnflag#5557 AS cval_lineitem_l_returnflag_2#5602, cval_lineitem_l_linestatus#5558 AS cval_lineitem_l_linestatus_2#5603, cval_lineitem_l_commitdate#5559 AS cval_lineitem_l_commitdate_2#5604, cval_lineitem_l_receiptdate#5560 AS cval_lineitem_l_receiptdate_2#5605, cval_lineitem_l_shipinstruct#5561 AS cval_lineitem_l_shipinstruct_2#5606, cval_lineitem_l_shipmode#5562 AS cval_lineitem_l_shipmode_2#5607, cval_lineitem_l_comment#5563 AS cval_lineitem_l_comment_2#5608, cval_lineitem_l_shipdate#5564 AS cval_lineitem_l_shipdate_2#5609, cdepval_lineitem_l_quantity#5565 AS cdepval_lineitem_l_quantity_2#5610, cdepval_lineitem_l_extendedprice#5566 AS cdepval_lineitem_l_extendedprice_2#5611, cdepval_lineitem_l_discount#5567 AS cdepval_lineitem_l_discount_2#5612, ... 21 more fields]
         :  :  +- Relation[rid#5544,cpfk_orders_lineitem#5545,cpfk_supplier_lineitem#5546,cfpk_lineitem_supplier#5547,cfpk_lineitem_partsupp#5548,cpfk_part_lineitem#5549,cfpk_lineitem_part#5550,cpfk_partsupp_lineitem#5551,cfpk_lineitem_orders#5552,cval_lineitem_l_quantity#5553,cval_lineitem_l_extendedprice#5554,cval_lineitem_l_discount#5555,cval_lineitem_l_tax#5556,cval_lineitem_l_returnflag#5557,cval_lineitem_l_linestatus#5558,cval_lineitem_l_commitdate#5559,cval_lineitem_l_receiptdate#5560,cval_lineitem_l_shipinstruct#5561,cval_lineitem_l_shipmode#5562,cval_lineitem_l_comment#5563,cval_lineitem_l_shipdate#5564,cdepval_lineitem_l_quantity#5565,cdepval_lineitem_l_extendedprice#5566,cdepval_lineitem_l_discount#5567,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :- Project [rid#5508 AS rid_1#5526, cpfk_nation_supplier#5509 AS cpfk_nation_supplier_1#5527, cfpk_supplier_nation#5510 AS cfpk_supplier_nation_1#5528, cval_supplier_s_name#5511 AS cval_supplier_s_name_1#5529, cval_supplier_s_address#5512 AS cval_supplier_s_address_1#5530, cval_supplier_s_phone#5513 AS cval_supplier_s_phone_1#5531, cval_supplier_s_acctbal#5514 AS cval_supplier_s_acctbal_1#5532, cval_supplier_s_comment#5515 AS cval_supplier_s_comment_1#5533, cdepval_supplier_s_name#5516 AS cdepval_supplier_s_name_1#5534, cdepval_supplier_s_address#5517 AS cdepval_supplier_s_address_1#5535, cdepval_supplier_s_phone#5518 AS cdepval_supplier_s_phone_1#5536, cdepval_supplier_s_acctbal#5519 AS cdepval_supplier_s_acctbal_1#5537, cdepval_supplier_s_comment#5520 AS cdepval_supplier_s_comment_1#5538, cs_name#5521 AS cs_name_1#5539, cs_address#5522 AS cs_address_1#5540, cs_phone#5523 AS cs_phone_1#5541, cs_acctbal#5524 AS cs_acctbal_1#5542, cs_comment#5525 AS cs_comment_1#5543]
         :     :  +- Relation[rid#5508,cpfk_nation_supplier#5509,cfpk_supplier_nation#5510,cval_supplier_s_name#5511,cval_supplier_s_address#5512,cval_supplier_s_phone#5513,cval_supplier_s_acctbal#5514,cval_supplier_s_comment#5515,cdepval_supplier_s_name#5516,cdepval_supplier_s_address#5517,cdepval_supplier_s_phone#5518,cdepval_supplier_s_acctbal#5519,cdepval_supplier_s_comment#5520,cs_name#5521,cs_address#5522,cs_phone#5523,cs_acctbal#5524,cs_comment#5525] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :        +- Project [rid#5472 AS rid_0#5481, cpfk_region_nation#5473 AS cpfk_region_nation_0#5482, cfpk_nation_region#5474 AS cfpk_nation_region_0#5483, cval_nation_n_name#5475 AS cval_nation_n_name_0#5484, cval_nation_n_comment#5476 AS cval_nation_n_comment_0#5485, cdepval_nation_n_name#5477 AS cdepval_nation_n_name_0#5486, cdepval_nation_n_comment#5478 AS cdepval_nation_n_comment_0#5487, cn_name#5479 AS cn_name_0#5488, cn_comment#5480 AS cn_comment_0#5489]
         :           +- Relation[rid#5472,cpfk_region_nation#5473,cfpk_nation_region#5474,cval_nation_n_name#5475,cval_nation_n_comment#5476,cdepval_nation_n_name#5477,cdepval_nation_n_comment#5478,cn_name#5479,cn_comment#5480] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#5712 AS rid_5#5736, cpfk_customer_orders#5713 AS cpfk_customer_orders_5#5737, cfpk_orders_customer#5714 AS cfpk_orders_customer_5#5738, cval_orders_o_orderstatus#5715 AS cval_orders_o_orderstatus_5#5739, cval_orders_o_totalprice#5716 AS cval_orders_o_totalprice_5#5740, cval_orders_o_orderpriority#5717 AS cval_orders_o_orderpriority_5#5741, cval_orders_o_clerk#5718 AS cval_orders_o_clerk_5#5742, cval_orders_o_shippriority#5719 AS cval_orders_o_shippriority_5#5743, cval_orders_o_comment#5720 AS cval_orders_o_comment_5#5744, cval_orders_o_orderdate#5721 AS cval_orders_o_orderdate_5#5745, cdepval_orders_o_orderstatus#5722 AS cdepval_orders_o_orderstatus_5#5746, cdepval_orders_o_totalprice#5723 AS cdepval_orders_o_totalprice_5#5747, cdepval_orders_o_orderpriority#5724 AS cdepval_orders_o_orderpriority_5#5748, cdepval_orders_o_clerk#5725 AS cdepval_orders_o_clerk_5#5749, cdepval_orders_o_shippriority#5726 AS cdepval_orders_o_shippriority_5#5750, cdepval_orders_o_comment#5727 AS cdepval_orders_o_comment_5#5751, cdepval_orders_o_orderdate#5728 AS cdepval_orders_o_orderdate_5#5752, co_orderstatus#5729 AS co_orderstatus_5#5753, co_totalprice#5730 AS co_totalprice_5#5754, co_orderpriority#5731 AS co_orderpriority_5#5755, co_clerk#5732 AS co_clerk_5#5756, co_shippriority#5733 AS co_shippriority_5#5757, co_comment#5734 AS co_comment_5#5758, co_orderdate#5735 AS co_orderdate_5#5759]
            :  +- Relation[rid#5712,cpfk_customer_orders#5713,cfpk_orders_customer#5714,cval_orders_o_orderstatus#5715,cval_orders_o_totalprice#5716,cval_orders_o_orderpriority#5717,cval_orders_o_clerk#5718,cval_orders_o_shippriority#5719,cval_orders_o_comment#5720,cval_orders_o_orderdate#5721,cdepval_orders_o_orderstatus#5722,cdepval_orders_o_totalprice#5723,cdepval_orders_o_orderpriority#5724,cdepval_orders_o_clerk#5725,cdepval_orders_o_shippriority#5726,cdepval_orders_o_comment#5727,cdepval_orders_o_orderdate#5728,co_orderstatus#5729,co_totalprice#5730,co_orderpriority#5731,co_clerk#5732,co_shippriority#5733,co_comment#5734,co_orderdate#5735] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_4, BinaryType)), 'cfpk_customer_nation_4) = 'rid_3)
               :- Project [rid#5670 AS rid_4#5691, cpfk_nation_customer#5671 AS cpfk_nation_customer_4#5692, cfpk_customer_nation#5672 AS cfpk_customer_nation_4#5693, cval_customer_c_name#5673 AS cval_customer_c_name_4#5694, cval_customer_c_address#5674 AS cval_customer_c_address_4#5695, cval_customer_c_phone#5675 AS cval_customer_c_phone_4#5696, cval_customer_c_acctbal#5676 AS cval_customer_c_acctbal_4#5697, cval_customer_c_comment#5677 AS cval_customer_c_comment_4#5698, cval_customer_c_mktsegment#5678 AS cval_customer_c_mktsegment_4#5699, cdepval_customer_c_name#5679 AS cdepval_customer_c_name_4#5700, cdepval_customer_c_address#5680 AS cdepval_customer_c_address_4#5701, cdepval_customer_c_phone#5681 AS cdepval_customer_c_phone_4#5702, cdepval_customer_c_acctbal#5682 AS cdepval_customer_c_acctbal_4#5703, cdepval_customer_c_comment#5683 AS cdepval_customer_c_comment_4#5704, cdepval_customer_c_mktsegment#5684 AS cdepval_customer_c_mktsegment_4#5705, cc_name#5685 AS cc_name_4#5706, cc_address#5686 AS cc_address_4#5707, cc_phone#5687 AS cc_phone_4#5708, cc_acctbal#5688 AS cc_acctbal_4#5709, cc_comment#5689 AS cc_comment_4#5710, cc_mktsegment#5690 AS cc_mktsegment_4#5711]
               :  +- Relation[rid#5670,cpfk_nation_customer#5671,cfpk_customer_nation#5672,cval_customer_c_name#5673,cval_customer_c_address#5674,cval_customer_c_phone#5675,cval_customer_c_acctbal#5676,cval_customer_c_comment#5677,cval_customer_c_mktsegment#5678,cdepval_customer_c_name#5679,cdepval_customer_c_address#5680,cdepval_customer_c_phone#5681,cdepval_customer_c_acctbal#5682,cdepval_customer_c_comment#5683,cdepval_customer_c_mktsegment#5684,cc_name#5685,cc_address#5686,cc_phone#5687,cc_acctbal#5688,cc_comment#5689,cc_mktsegment#5690] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
                  +- Project [rid#5634 AS rid_3#5643, cpfk_region_nation#5635 AS cpfk_region_nation_3#5644, cfpk_nation_region#5636 AS cfpk_nation_region_3#5645, cval_nation_n_name#5637 AS cval_nation_n_name_3#5646, cval_nation_n_comment#5638 AS cval_nation_n_comment_3#5647, cdepval_nation_n_name#5639 AS cdepval_nation_n_name_3#5648, cdepval_nation_n_comment#5640 AS cdepval_nation_n_comment_3#5649, cn_name#5641 AS cn_name_3#5650, cn_comment#5642 AS cn_comment_3#5651]
                     +- Relation[rid#5634,cpfk_region_nation#5635,cfpk_nation_region#5636,cval_nation_n_name#5637,cval_nation_n_comment#5638,cdepval_nation_n_name#5639,cdepval_nation_n_comment#5640,cn_name#5641,cn_comment#5642] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 35000ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 23:04:58 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:04:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5895L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:04:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:04:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:04:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:04:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:04:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:04:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:04:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:04:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:04:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:04:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:04:58 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:04:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5895L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#6029 AS rid_4#6074, cpfk_orders_lineitem#6030 AS cpfk_orders_lineitem_4#6075, cpfk_supplier_lineitem#6031 AS cpfk_supplier_lineitem_4#6076, cfpk_lineitem_supplier#6032 AS cfpk_lineitem_supplier_4#6077, cfpk_lineitem_partsupp#6033 AS cfpk_lineitem_partsupp_4#6078, cpfk_part_lineitem#6034 AS cpfk_part_lineitem_4#6079, cfpk_lineitem_part#6035 AS cfpk_lineitem_part_4#6080, cpfk_partsupp_lineitem#6036 AS cpfk_partsupp_lineitem_4#6081, cfpk_lineitem_orders#6037 AS cfpk_lineitem_orders_4#6082, cval_lineitem_l_quantity#6038 AS cval_lineitem_l_quantity_4#6083, cval_lineitem_l_extendedprice#6039 AS cval_lineitem_l_extendedprice_4#6084, cval_lineitem_l_discount#6040 AS cval_lineitem_l_discount_4#6085, cval_lineitem_l_tax#6041 AS cval_lineitem_l_tax_4#6086, cval_lineitem_l_returnflag#6042 AS cval_lineitem_l_returnflag_4#6087, cval_lineitem_l_linestatus#6043 AS cval_lineitem_l_linestatus_4#6088, cval_lineitem_l_commitdate#6044 AS cval_lineitem_l_commitdate_4#6089, cval_lineitem_l_receiptdate#6045 AS cval_lineitem_l_receiptdate_4#6090, cval_lineitem_l_shipinstruct#6046 AS cval_lineitem_l_shipinstruct_4#6091, cval_lineitem_l_shipmode#6047 AS cval_lineitem_l_shipmode_4#6092, cval_lineitem_l_comment#6048 AS cval_lineitem_l_comment_4#6093, cval_lineitem_l_shipdate#6049 AS cval_lineitem_l_shipdate_4#6094, cdepval_lineitem_l_quantity#6050 AS cdepval_lineitem_l_quantity_4#6095, cdepval_lineitem_l_extendedprice#6051 AS cdepval_lineitem_l_extendedprice_4#6096, cdepval_lineitem_l_discount#6052 AS cdepval_lineitem_l_discount_4#6097, ... 21 more fields]
         :  :  +- Relation[rid#6029,cpfk_orders_lineitem#6030,cpfk_supplier_lineitem#6031,cfpk_lineitem_supplier#6032,cfpk_lineitem_partsupp#6033,cpfk_part_lineitem#6034,cfpk_lineitem_part#6035,cpfk_partsupp_lineitem#6036,cfpk_lineitem_orders#6037,cval_lineitem_l_quantity#6038,cval_lineitem_l_extendedprice#6039,cval_lineitem_l_discount#6040,cval_lineitem_l_tax#6041,cval_lineitem_l_returnflag#6042,cval_lineitem_l_linestatus#6043,cval_lineitem_l_commitdate#6044,cval_lineitem_l_receiptdate#6045,cval_lineitem_l_shipinstruct#6046,cval_lineitem_l_shipmode#6047,cval_lineitem_l_comment#6048,cval_lineitem_l_shipdate#6049,cdepval_lineitem_l_quantity#6050,cdepval_lineitem_l_extendedprice#6051,cdepval_lineitem_l_discount#6052,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#5951 AS rid_2#5965, cpfk_part_partsupp#5952 AS cpfk_part_partsupp_2#5966, cfpk_partsupp_part#5953 AS cfpk_partsupp_part_2#5967, cpfk_supplier_partsupp#5954 AS cpfk_supplier_partsupp_2#5968, cfpk_partsupp_supplier#5955 AS cfpk_partsupp_supplier_2#5969, cval_partsupp_ps_availqty#5956 AS cval_partsupp_ps_availqty_2#5970, cval_partsupp_ps_supplycost#5957 AS cval_partsupp_ps_supplycost_2#5971, cval_partsupp_ps_comment#5958 AS cval_partsupp_ps_comment_2#5972, cdepval_partsupp_ps_availqty#5959 AS cdepval_partsupp_ps_availqty_2#5973, cdepval_partsupp_ps_supplycost#5960 AS cdepval_partsupp_ps_supplycost_2#5974, cdepval_partsupp_ps_comment#5961 AS cdepval_partsupp_ps_comment_2#5975, cps_availqty#5962 AS cps_availqty_2#5976, cps_supplycost#5963 AS cps_supplycost_2#5977, cps_comment#5964 AS cps_comment_2#5978]
         :     :  :  +- Relation[rid#5951,cpfk_part_partsupp#5952,cfpk_partsupp_part#5953,cpfk_supplier_partsupp#5954,cfpk_partsupp_supplier#5955,cval_partsupp_ps_availqty#5956,cval_partsupp_ps_supplycost#5957,cval_partsupp_ps_comment#5958,cdepval_partsupp_ps_availqty#5959,cdepval_partsupp_ps_supplycost#5960,cdepval_partsupp_ps_comment#5961,cps_availqty#5962,cps_supplycost#5963,cps_comment#5964] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#5915 AS rid_1#5933, cpfk_nation_supplier#5916 AS cpfk_nation_supplier_1#5934, cfpk_supplier_nation#5917 AS cfpk_supplier_nation_1#5935, cval_supplier_s_name#5918 AS cval_supplier_s_name_1#5936, cval_supplier_s_address#5919 AS cval_supplier_s_address_1#5937, cval_supplier_s_phone#5920 AS cval_supplier_s_phone_1#5938, cval_supplier_s_acctbal#5921 AS cval_supplier_s_acctbal_1#5939, cval_supplier_s_comment#5922 AS cval_supplier_s_comment_1#5940, cdepval_supplier_s_name#5923 AS cdepval_supplier_s_name_1#5941, cdepval_supplier_s_address#5924 AS cdepval_supplier_s_address_1#5942, cdepval_supplier_s_phone#5925 AS cdepval_supplier_s_phone_1#5943, cdepval_supplier_s_acctbal#5926 AS cdepval_supplier_s_acctbal_1#5944, cdepval_supplier_s_comment#5927 AS cdepval_supplier_s_comment_1#5945, cs_name#5928 AS cs_name_1#5946, cs_address#5929 AS cs_address_1#5947, cs_phone#5930 AS cs_phone_1#5948, cs_acctbal#5931 AS cs_acctbal_1#5949, cs_comment#5932 AS cs_comment_1#5950]
         :     :     :  +- Relation[rid#5915,cpfk_nation_supplier#5916,cfpk_supplier_nation#5917,cval_supplier_s_name#5918,cval_supplier_s_address#5919,cval_supplier_s_phone#5920,cval_supplier_s_acctbal#5921,cval_supplier_s_comment#5922,cdepval_supplier_s_name#5923,cdepval_supplier_s_address#5924,cdepval_supplier_s_phone#5925,cdepval_supplier_s_acctbal#5926,cdepval_supplier_s_comment#5927,cs_name#5928,cs_address#5929,cs_phone#5930,cs_acctbal#5931,cs_comment#5932] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#5897 AS rid_0#5906, cpfk_region_nation#5898 AS cpfk_region_nation_0#5907, cfpk_nation_region#5899 AS cfpk_nation_region_0#5908, cval_nation_n_name#5900 AS cval_nation_n_name_0#5909, cval_nation_n_comment#5901 AS cval_nation_n_comment_0#5910, cdepval_nation_n_name#5902 AS cdepval_nation_n_name_0#5911, cdepval_nation_n_comment#5903 AS cdepval_nation_n_comment_0#5912, cn_name#5904 AS cn_name_0#5913, cn_comment#5905 AS cn_comment_0#5914]
         :     :        +- Relation[rid#5897,cpfk_region_nation#5898,cfpk_nation_region#5899,cval_nation_n_name#5900,cval_nation_n_comment#5901,cdepval_nation_n_name#5902,cdepval_nation_n_comment#5903,cn_name#5904,cn_comment#5905] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#5979 AS rid_3#6004, cval_part_p_name#5980 AS cval_part_p_name_3#6005, cval_part_p_mfgr#5981 AS cval_part_p_mfgr_3#6006, cval_part_p_type#5982 AS cval_part_p_type_3#6007, cval_part_p_size#5983 AS cval_part_p_size_3#6008, cval_part_p_container#5984 AS cval_part_p_container_3#6009, cval_part_p_retailprice#5985 AS cval_part_p_retailprice_3#6010, cval_part_p_comment#5986 AS cval_part_p_comment_3#6011, cval_part_p_brand#5987 AS cval_part_p_brand_3#6012, cdepval_part_p_name#5988 AS cdepval_part_p_name_3#6013, cdepval_part_p_mfgr#5989 AS cdepval_part_p_mfgr_3#6014, cdepval_part_p_type#5990 AS cdepval_part_p_type_3#6015, cdepval_part_p_size#5991 AS cdepval_part_p_size_3#6016, cdepval_part_p_container#5992 AS cdepval_part_p_container_3#6017, cdepval_part_p_retailprice#5993 AS cdepval_part_p_retailprice_3#6018, cdepval_part_p_comment#5994 AS cdepval_part_p_comment_3#6019, cdepval_part_p_brand#5995 AS cdepval_part_p_brand_3#6020, cp_name#5996 AS cp_name_3#6021, cp_mfgr#5997 AS cp_mfgr_3#6022, cp_type#5998 AS cp_type_3#6023, cp_size#5999 AS cp_size_3#6024, cp_container#6000 AS cp_container_3#6025, cp_retailprice#6001 AS cp_retailprice_3#6026, cp_comment#6002 AS cp_comment_3#6027, cp_brand#6003 AS cp_brand_3#6028]
         :        +- Relation[rid#5979,cval_part_p_name#5980,cval_part_p_mfgr#5981,cval_part_p_type#5982,cval_part_p_size#5983,cval_part_p_container#5984,cval_part_p_retailprice#5985,cval_part_p_comment#5986,cval_part_p_brand#5987,cdepval_part_p_name#5988,cdepval_part_p_mfgr#5989,cdepval_part_p_type#5990,cdepval_part_p_size#5991,cdepval_part_p_container#5992,cdepval_part_p_retailprice#5993,cdepval_part_p_comment#5994,cdepval_part_p_brand#5995,cp_name#5996,cp_mfgr#5997,cp_type#5998,cp_size#5999,cp_container#6000,cp_retailprice#6001,cp_comment#6002,cp_brand#6003] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#6119 AS rid_5#6143, cpfk_customer_orders#6120 AS cpfk_customer_orders_5#6144, cfpk_orders_customer#6121 AS cfpk_orders_customer_5#6145, cval_orders_o_orderstatus#6122 AS cval_orders_o_orderstatus_5#6146, cval_orders_o_totalprice#6123 AS cval_orders_o_totalprice_5#6147, cval_orders_o_orderpriority#6124 AS cval_orders_o_orderpriority_5#6148, cval_orders_o_clerk#6125 AS cval_orders_o_clerk_5#6149, cval_orders_o_shippriority#6126 AS cval_orders_o_shippriority_5#6150, cval_orders_o_comment#6127 AS cval_orders_o_comment_5#6151, cval_orders_o_orderdate#6128 AS cval_orders_o_orderdate_5#6152, cdepval_orders_o_orderstatus#6129 AS cdepval_orders_o_orderstatus_5#6153, cdepval_orders_o_totalprice#6130 AS cdepval_orders_o_totalprice_5#6154, cdepval_orders_o_orderpriority#6131 AS cdepval_orders_o_orderpriority_5#6155, cdepval_orders_o_clerk#6132 AS cdepval_orders_o_clerk_5#6156, cdepval_orders_o_shippriority#6133 AS cdepval_orders_o_shippriority_5#6157, cdepval_orders_o_comment#6134 AS cdepval_orders_o_comment_5#6158, cdepval_orders_o_orderdate#6135 AS cdepval_orders_o_orderdate_5#6159, co_orderstatus#6136 AS co_orderstatus_5#6160, co_totalprice#6137 AS co_totalprice_5#6161, co_orderpriority#6138 AS co_orderpriority_5#6162, co_clerk#6139 AS co_clerk_5#6163, co_shippriority#6140 AS co_shippriority_5#6164, co_comment#6141 AS co_comment_5#6165, co_orderdate#6142 AS co_orderdate_5#6166]
            +- Relation[rid#6119,cpfk_customer_orders#6120,cfpk_orders_customer#6121,cval_orders_o_orderstatus#6122,cval_orders_o_totalprice#6123,cval_orders_o_orderpriority#6124,cval_orders_o_clerk#6125,cval_orders_o_shippriority#6126,cval_orders_o_comment#6127,cval_orders_o_orderdate#6128,cdepval_orders_o_orderstatus#6129,cdepval_orders_o_totalprice#6130,cdepval_orders_o_orderpriority#6131,cdepval_orders_o_clerk#6132,cdepval_orders_o_shippriority#6133,cdepval_orders_o_comment#6134,cdepval_orders_o_orderdate#6135,co_orderstatus#6136,co_totalprice#6137,co_orderpriority#6138,co_clerk#6139,co_shippriority#6140,co_comment#6141,co_orderdate#6142] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 38201ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/25 23:05:36 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:05:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6309L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 23:05:36 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:05:36 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:05:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6309L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :- Project [rid#6411 AS rid_1#6425, cpfk_part_partsupp#6412 AS cpfk_part_partsupp_1#6426, cfpk_partsupp_part#6413 AS cfpk_partsupp_part_1#6427, cpfk_supplier_partsupp#6414 AS cpfk_supplier_partsupp_1#6428, cfpk_partsupp_supplier#6415 AS cfpk_partsupp_supplier_1#6429, cval_partsupp_ps_availqty#6416 AS cval_partsupp_ps_availqty_1#6430, cval_partsupp_ps_supplycost#6417 AS cval_partsupp_ps_supplycost_1#6431, cval_partsupp_ps_comment#6418 AS cval_partsupp_ps_comment_1#6432, cdepval_partsupp_ps_availqty#6419 AS cdepval_partsupp_ps_availqty_1#6433, cdepval_partsupp_ps_supplycost#6420 AS cdepval_partsupp_ps_supplycost_1#6434, cdepval_partsupp_ps_comment#6421 AS cdepval_partsupp_ps_comment_1#6435, cps_availqty#6422 AS cps_availqty_1#6436, cps_supplycost#6423 AS cps_supplycost_1#6437, cps_comment#6424 AS cps_comment_1#6438]
         :  +- Relation[rid#6411,cpfk_part_partsupp#6412,cfpk_partsupp_part#6413,cpfk_supplier_partsupp#6414,cfpk_partsupp_supplier#6415,cval_partsupp_ps_availqty#6416,cval_partsupp_ps_supplycost#6417,cval_partsupp_ps_comment#6418,cdepval_partsupp_ps_availqty#6419,cdepval_partsupp_ps_supplycost#6420,cdepval_partsupp_ps_comment#6421,cps_availqty#6422,cps_supplycost#6423,cps_comment#6424] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
            +- Project [rid#6311 AS rid_0#6336, cval_part_p_name#6312 AS cval_part_p_name_0#6337, cval_part_p_mfgr#6313 AS cval_part_p_mfgr_0#6338, cval_part_p_type#6314 AS cval_part_p_type_0#6339, cval_part_p_size#6315 AS cval_part_p_size_0#6340, cval_part_p_container#6316 AS cval_part_p_container_0#6341, cval_part_p_retailprice#6317 AS cval_part_p_retailprice_0#6342, cval_part_p_comment#6318 AS cval_part_p_comment_0#6343, cval_part_p_brand#6319 AS cval_part_p_brand_0#6344, cdepval_part_p_name#6320 AS cdepval_part_p_name_0#6345, cdepval_part_p_mfgr#6321 AS cdepval_part_p_mfgr_0#6346, cdepval_part_p_type#6322 AS cdepval_part_p_type_0#6347, cdepval_part_p_size#6323 AS cdepval_part_p_size_0#6348, cdepval_part_p_container#6324 AS cdepval_part_p_container_0#6349, cdepval_part_p_retailprice#6325 AS cdepval_part_p_retailprice_0#6350, cdepval_part_p_comment#6326 AS cdepval_part_p_comment_0#6351, cdepval_part_p_brand#6327 AS cdepval_part_p_brand_0#6352, cp_name#6328 AS cp_name_0#6353, cp_mfgr#6329 AS cp_mfgr_0#6354, cp_type#6330 AS cp_type_0#6355, cp_size#6331 AS cp_size_0#6356, cp_container#6332 AS cp_container_0#6357, cp_retailprice#6333 AS cp_retailprice_0#6358, cp_comment#6334 AS cp_comment_0#6359, cp_brand#6335 AS cp_brand_0#6360]
               +- Relation[rid#6311,cval_part_p_name#6312,cval_part_p_mfgr#6313,cval_part_p_type#6314,cval_part_p_size#6315,cval_part_p_container#6316,cval_part_p_retailprice#6317,cval_part_p_comment#6318,cval_part_p_brand#6319,cdepval_part_p_name#6320,cdepval_part_p_mfgr#6321,cdepval_part_p_type#6322,cdepval_part_p_size#6323,cdepval_part_p_container#6324,cdepval_part_p_retailprice#6325,cdepval_part_p_comment#6326,cdepval_part_p_brand#6327,cp_name#6328,cp_mfgr#6329,cp_type#6330,cp_size#6331,cp_container#6332,cp_retailprice#6333,cp_comment#6334,cp_brand#6335] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 3325ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/25 23:05:39 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:05:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6482L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:05:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6482L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#6484 AS rid_0#6529, cpfk_orders_lineitem#6485 AS cpfk_orders_lineitem_0#6530, cpfk_supplier_lineitem#6486 AS cpfk_supplier_lineitem_0#6531, cfpk_lineitem_supplier#6487 AS cfpk_lineitem_supplier_0#6532, cfpk_lineitem_partsupp#6488 AS cfpk_lineitem_partsupp_0#6533, cpfk_part_lineitem#6489 AS cpfk_part_lineitem_0#6534, cfpk_lineitem_part#6490 AS cfpk_lineitem_part_0#6535, cpfk_partsupp_lineitem#6491 AS cpfk_partsupp_lineitem_0#6536, cfpk_lineitem_orders#6492 AS cfpk_lineitem_orders_0#6537, cval_lineitem_l_quantity#6493 AS cval_lineitem_l_quantity_0#6538, cval_lineitem_l_extendedprice#6494 AS cval_lineitem_l_extendedprice_0#6539, cval_lineitem_l_discount#6495 AS cval_lineitem_l_discount_0#6540, cval_lineitem_l_tax#6496 AS cval_lineitem_l_tax_0#6541, cval_lineitem_l_returnflag#6497 AS cval_lineitem_l_returnflag_0#6542, cval_lineitem_l_linestatus#6498 AS cval_lineitem_l_linestatus_0#6543, cval_lineitem_l_commitdate#6499 AS cval_lineitem_l_commitdate_0#6544, cval_lineitem_l_receiptdate#6500 AS cval_lineitem_l_receiptdate_0#6545, cval_lineitem_l_shipinstruct#6501 AS cval_lineitem_l_shipinstruct_0#6546, cval_lineitem_l_shipmode#6502 AS cval_lineitem_l_shipmode_0#6547, cval_lineitem_l_comment#6503 AS cval_lineitem_l_comment_0#6548, cval_lineitem_l_shipdate#6504 AS cval_lineitem_l_shipdate_0#6549, cdepval_lineitem_l_quantity#6505 AS cdepval_lineitem_l_quantity_0#6550, cdepval_lineitem_l_extendedprice#6506 AS cdepval_lineitem_l_extendedprice_0#6551, cdepval_lineitem_l_discount#6507 AS cdepval_lineitem_l_discount_0#6552, ... 21 more fields]
         :     +- Relation[rid#6484,cpfk_orders_lineitem#6485,cpfk_supplier_lineitem#6486,cfpk_lineitem_supplier#6487,cfpk_lineitem_partsupp#6488,cpfk_part_lineitem#6489,cfpk_lineitem_part#6490,cpfk_partsupp_lineitem#6491,cfpk_lineitem_orders#6492,cval_lineitem_l_quantity#6493,cval_lineitem_l_extendedprice#6494,cval_lineitem_l_discount#6495,cval_lineitem_l_tax#6496,cval_lineitem_l_returnflag#6497,cval_lineitem_l_linestatus#6498,cval_lineitem_l_commitdate#6499,cval_lineitem_l_receiptdate#6500,cval_lineitem_l_shipinstruct#6501,cval_lineitem_l_shipmode#6502,cval_lineitem_l_comment#6503,cval_lineitem_l_shipdate#6504,cdepval_lineitem_l_quantity#6505,cdepval_lineitem_l_extendedprice#6506,cdepval_lineitem_l_discount#6507,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6664 AS rid_1#6688, cpfk_customer_orders#6665 AS cpfk_customer_orders_1#6689, cfpk_orders_customer#6666 AS cfpk_orders_customer_1#6690, cval_orders_o_orderstatus#6667 AS cval_orders_o_orderstatus_1#6691, cval_orders_o_totalprice#6668 AS cval_orders_o_totalprice_1#6692, cval_orders_o_orderpriority#6669 AS cval_orders_o_orderpriority_1#6693, cval_orders_o_clerk#6670 AS cval_orders_o_clerk_1#6694, cval_orders_o_shippriority#6671 AS cval_orders_o_shippriority_1#6695, cval_orders_o_comment#6672 AS cval_orders_o_comment_1#6696, cval_orders_o_orderdate#6673 AS cval_orders_o_orderdate_1#6697, cdepval_orders_o_orderstatus#6674 AS cdepval_orders_o_orderstatus_1#6698, cdepval_orders_o_totalprice#6675 AS cdepval_orders_o_totalprice_1#6699, cdepval_orders_o_orderpriority#6676 AS cdepval_orders_o_orderpriority_1#6700, cdepval_orders_o_clerk#6677 AS cdepval_orders_o_clerk_1#6701, cdepval_orders_o_shippriority#6678 AS cdepval_orders_o_shippriority_1#6702, cdepval_orders_o_comment#6679 AS cdepval_orders_o_comment_1#6703, cdepval_orders_o_orderdate#6680 AS cdepval_orders_o_orderdate_1#6704, co_orderstatus#6681 AS co_orderstatus_1#6705, co_totalprice#6682 AS co_totalprice_1#6706, co_orderpriority#6683 AS co_orderpriority_1#6707, co_clerk#6684 AS co_clerk_1#6708, co_shippriority#6685 AS co_shippriority_1#6709, co_comment#6686 AS co_comment_1#6710, co_orderdate#6687 AS co_orderdate_1#6711]
            +- Relation[rid#6664,cpfk_customer_orders#6665,cfpk_orders_customer#6666,cval_orders_o_orderstatus#6667,cval_orders_o_totalprice#6668,cval_orders_o_orderpriority#6669,cval_orders_o_clerk#6670,cval_orders_o_shippriority#6671,cval_orders_o_comment#6672,cval_orders_o_orderdate#6673,cdepval_orders_o_orderstatus#6674,cdepval_orders_o_totalprice#6675,cdepval_orders_o_orderpriority#6676,cdepval_orders_o_clerk#6677,cdepval_orders_o_shippriority#6678,cdepval_orders_o_comment#6679,cdepval_orders_o_orderdate#6680,co_orderstatus#6681,co_totalprice#6682,co_orderpriority#6683,co_clerk#6684,co_shippriority#6685,co_comment#6686,co_orderdate#6687] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 22375ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/25 23:06:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:06:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6786L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 23:06:02 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:06:02 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:06:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:06:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:06:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:06:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:06:02 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:06:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:06:02 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 23:06:02 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:06:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6786L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :  :- Project [rid#6888 AS rid_1#6902, cpfk_part_partsupp#6889 AS cpfk_part_partsupp_1#6903, cfpk_partsupp_part#6890 AS cfpk_partsupp_part_1#6904, cpfk_supplier_partsupp#6891 AS cpfk_supplier_partsupp_1#6905, cfpk_partsupp_supplier#6892 AS cfpk_partsupp_supplier_1#6906, cval_partsupp_ps_availqty#6893 AS cval_partsupp_ps_availqty_1#6907, cval_partsupp_ps_supplycost#6894 AS cval_partsupp_ps_supplycost_1#6908, cval_partsupp_ps_comment#6895 AS cval_partsupp_ps_comment_1#6909, cdepval_partsupp_ps_availqty#6896 AS cdepval_partsupp_ps_availqty_1#6910, cdepval_partsupp_ps_supplycost#6897 AS cdepval_partsupp_ps_supplycost_1#6911, cdepval_partsupp_ps_comment#6898 AS cdepval_partsupp_ps_comment_1#6912, cps_availqty#6899 AS cps_availqty_1#6913, cps_supplycost#6900 AS cps_supplycost_1#6914, cps_comment#6901 AS cps_comment_1#6915]
         :  :  +- Relation[rid#6888,cpfk_part_partsupp#6889,cfpk_partsupp_part#6890,cpfk_supplier_partsupp#6891,cfpk_partsupp_supplier#6892,cval_partsupp_ps_availqty#6893,cval_partsupp_ps_supplycost#6894,cval_partsupp_ps_comment#6895,cdepval_partsupp_ps_availqty#6896,cdepval_partsupp_ps_supplycost#6897,cdepval_partsupp_ps_comment#6898,cps_availqty#6899,cps_supplycost#6900,cps_comment#6901] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :     +- Project [rid#6788 AS rid_0#6813, cval_part_p_name#6789 AS cval_part_p_name_0#6814, cval_part_p_mfgr#6790 AS cval_part_p_mfgr_0#6815, cval_part_p_type#6791 AS cval_part_p_type_0#6816, cval_part_p_size#6792 AS cval_part_p_size_0#6817, cval_part_p_container#6793 AS cval_part_p_container_0#6818, cval_part_p_retailprice#6794 AS cval_part_p_retailprice_0#6819, cval_part_p_comment#6795 AS cval_part_p_comment_0#6820, cval_part_p_brand#6796 AS cval_part_p_brand_0#6821, cdepval_part_p_name#6797 AS cdepval_part_p_name_0#6822, cdepval_part_p_mfgr#6798 AS cdepval_part_p_mfgr_0#6823, cdepval_part_p_type#6799 AS cdepval_part_p_type_0#6824, cdepval_part_p_size#6800 AS cdepval_part_p_size_0#6825, cdepval_part_p_container#6801 AS cdepval_part_p_container_0#6826, cdepval_part_p_retailprice#6802 AS cdepval_part_p_retailprice_0#6827, cdepval_part_p_comment#6803 AS cdepval_part_p_comment_0#6828, cdepval_part_p_brand#6804 AS cdepval_part_p_brand_0#6829, cp_name#6805 AS cp_name_0#6830, cp_mfgr#6806 AS cp_mfgr_0#6831, cp_type#6807 AS cp_type_0#6832, cp_size#6808 AS cp_size_0#6833, cp_container#6809 AS cp_container_0#6834, cp_retailprice#6810 AS cp_retailprice_0#6835, cp_comment#6811 AS cp_comment_0#6836, cp_brand#6812 AS cp_brand_0#6837]
         :        +- Relation[rid#6788,cval_part_p_name#6789,cval_part_p_mfgr#6790,cval_part_p_type#6791,cval_part_p_size#6792,cval_part_p_container#6793,cval_part_p_retailprice#6794,cval_part_p_comment#6795,cval_part_p_brand#6796,cdepval_part_p_name#6797,cdepval_part_p_mfgr#6798,cdepval_part_p_type#6799,cdepval_part_p_size#6800,cdepval_part_p_container#6801,cdepval_part_p_retailprice#6802,cdepval_part_p_comment#6803,cdepval_part_p_brand#6804,cp_name#6805,cp_mfgr#6806,cp_type#6807,cp_size#6808,cp_container#6809,cp_retailprice#6810,cp_comment#6811,cp_brand#6812] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_2)
            :- Project [rid#6952 AS rid_3#6970, cpfk_nation_supplier#6953 AS cpfk_nation_supplier_3#6971, cfpk_supplier_nation#6954 AS cfpk_supplier_nation_3#6972, cval_supplier_s_name#6955 AS cval_supplier_s_name_3#6973, cval_supplier_s_address#6956 AS cval_supplier_s_address_3#6974, cval_supplier_s_phone#6957 AS cval_supplier_s_phone_3#6975, cval_supplier_s_acctbal#6958 AS cval_supplier_s_acctbal_3#6976, cval_supplier_s_comment#6959 AS cval_supplier_s_comment_3#6977, cdepval_supplier_s_name#6960 AS cdepval_supplier_s_name_3#6978, cdepval_supplier_s_address#6961 AS cdepval_supplier_s_address_3#6979, cdepval_supplier_s_phone#6962 AS cdepval_supplier_s_phone_3#6980, cdepval_supplier_s_acctbal#6963 AS cdepval_supplier_s_acctbal_3#6981, cdepval_supplier_s_comment#6964 AS cdepval_supplier_s_comment_3#6982, cs_name#6965 AS cs_name_3#6983, cs_address#6966 AS cs_address_3#6984, cs_phone#6967 AS cs_phone_3#6985, cs_acctbal#6968 AS cs_acctbal_3#6986, cs_comment#6969 AS cs_comment_3#6987]
            :  +- Relation[rid#6952,cpfk_nation_supplier#6953,cfpk_supplier_nation#6954,cval_supplier_s_name#6955,cval_supplier_s_address#6956,cval_supplier_s_phone#6957,cval_supplier_s_acctbal#6958,cval_supplier_s_comment#6959,cdepval_supplier_s_name#6960,cdepval_supplier_s_address#6961,cdepval_supplier_s_phone#6962,cdepval_supplier_s_acctbal#6963,cdepval_supplier_s_comment#6964,cs_name#6965,cs_address#6966,cs_phone#6967,cs_acctbal#6968,cs_comment#6969] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
               +- Project [rid#6916 AS rid_2#6925, cpfk_region_nation#6917 AS cpfk_region_nation_2#6926, cfpk_nation_region#6918 AS cfpk_nation_region_2#6927, cval_nation_n_name#6919 AS cval_nation_n_name_2#6928, cval_nation_n_comment#6920 AS cval_nation_n_comment_2#6929, cdepval_nation_n_name#6921 AS cdepval_nation_n_name_2#6930, cdepval_nation_n_comment#6922 AS cdepval_nation_n_comment_2#6931, cn_name#6923 AS cn_name_2#6932, cn_comment#6924 AS cn_comment_2#6933]
                  +- Relation[rid#6916,cpfk_region_nation#6917,cfpk_nation_region#6918,cval_nation_n_name#6919,cval_nation_n_comment#6920,cdepval_nation_n_name#6921,cdepval_nation_n_comment#6922,cn_name#6923,cn_comment#6924] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 3568ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/25 23:06:05 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:06:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7059L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 23:06:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7059L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#7061 AS rid_0#7085, cpfk_customer_orders#7062 AS cpfk_customer_orders_0#7086, cfpk_orders_customer#7063 AS cfpk_orders_customer_0#7087, cval_orders_o_orderstatus#7064 AS cval_orders_o_orderstatus_0#7088, cval_orders_o_totalprice#7065 AS cval_orders_o_totalprice_0#7089, cval_orders_o_orderpriority#7066 AS cval_orders_o_orderpriority_0#7090, cval_orders_o_clerk#7067 AS cval_orders_o_clerk_0#7091, cval_orders_o_shippriority#7068 AS cval_orders_o_shippriority_0#7092, cval_orders_o_comment#7069 AS cval_orders_o_comment_0#7093, cval_orders_o_orderdate#7070 AS cval_orders_o_orderdate_0#7094, cdepval_orders_o_orderstatus#7071 AS cdepval_orders_o_orderstatus_0#7095, cdepval_orders_o_totalprice#7072 AS cdepval_orders_o_totalprice_0#7096, cdepval_orders_o_orderpriority#7073 AS cdepval_orders_o_orderpriority_0#7097, cdepval_orders_o_clerk#7074 AS cdepval_orders_o_clerk_0#7098, cdepval_orders_o_shippriority#7075 AS cdepval_orders_o_shippriority_0#7099, cdepval_orders_o_comment#7076 AS cdepval_orders_o_comment_0#7100, cdepval_orders_o_orderdate#7077 AS cdepval_orders_o_orderdate_0#7101, co_orderstatus#7078 AS co_orderstatus_0#7102, co_totalprice#7079 AS co_totalprice_0#7103, co_orderpriority#7080 AS co_orderpriority_0#7104, co_clerk#7081 AS co_clerk_0#7105, co_shippriority#7082 AS co_shippriority_0#7106, co_comment#7083 AS co_comment_0#7107, co_orderdate#7084 AS co_orderdate_0#7108]
         :  +- Relation[rid#7061,cpfk_customer_orders#7062,cfpk_orders_customer#7063,cval_orders_o_orderstatus#7064,cval_orders_o_totalprice#7065,cval_orders_o_orderpriority#7066,cval_orders_o_clerk#7067,cval_orders_o_shippriority#7068,cval_orders_o_comment#7069,cval_orders_o_orderdate#7070,cdepval_orders_o_orderstatus#7071,cdepval_orders_o_totalprice#7072,cdepval_orders_o_orderpriority#7073,cdepval_orders_o_clerk#7074,cdepval_orders_o_shippriority#7075,cdepval_orders_o_comment#7076,cdepval_orders_o_orderdate#7077,co_orderstatus#7078,co_totalprice#7079,co_orderpriority#7080,co_clerk#7081,co_shippriority#7082,co_comment#7083,co_orderdate#7084] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#7109 AS rid_1#7130, cpfk_nation_customer#7110 AS cpfk_nation_customer_1#7131, cfpk_customer_nation#7111 AS cfpk_customer_nation_1#7132, cval_customer_c_name#7112 AS cval_customer_c_name_1#7133, cval_customer_c_address#7113 AS cval_customer_c_address_1#7134, cval_customer_c_phone#7114 AS cval_customer_c_phone_1#7135, cval_customer_c_acctbal#7115 AS cval_customer_c_acctbal_1#7136, cval_customer_c_comment#7116 AS cval_customer_c_comment_1#7137, cval_customer_c_mktsegment#7117 AS cval_customer_c_mktsegment_1#7138, cdepval_customer_c_name#7118 AS cdepval_customer_c_name_1#7139, cdepval_customer_c_address#7119 AS cdepval_customer_c_address_1#7140, cdepval_customer_c_phone#7120 AS cdepval_customer_c_phone_1#7141, cdepval_customer_c_acctbal#7121 AS cdepval_customer_c_acctbal_1#7142, cdepval_customer_c_comment#7122 AS cdepval_customer_c_comment_1#7143, cdepval_customer_c_mktsegment#7123 AS cdepval_customer_c_mktsegment_1#7144, cc_name#7124 AS cc_name_1#7145, cc_address#7125 AS cc_address_1#7146, cc_phone#7126 AS cc_phone_1#7147, cc_acctbal#7127 AS cc_acctbal_1#7148, cc_comment#7128 AS cc_comment_1#7149, cc_mktsegment#7129 AS cc_mktsegment_1#7150]
            +- Relation[rid#7109,cpfk_nation_customer#7110,cfpk_customer_nation#7111,cval_customer_c_name#7112,cval_customer_c_address#7113,cval_customer_c_phone#7114,cval_customer_c_acctbal#7115,cval_customer_c_comment#7116,cval_customer_c_mktsegment#7117,cdepval_customer_c_name#7118,cdepval_customer_c_address#7119,cdepval_customer_c_phone#7120,cdepval_customer_c_acctbal#7121,cdepval_customer_c_comment#7122,cdepval_customer_c_mktsegment#7123,cc_name#7124,cc_address#7125,cc_phone#7126,cc_acctbal#7127,cc_comment#7128,cc_mktsegment#7129] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4423ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/25 23:06:10 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:06:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7204L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:06:10 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 23:06:10 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 23:06:10 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 23:06:10 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 23:06:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7204L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#7338 AS rid_2#7383, cpfk_orders_lineitem#7339 AS cpfk_orders_lineitem_2#7384, cpfk_supplier_lineitem#7340 AS cpfk_supplier_lineitem_2#7385, cfpk_lineitem_supplier#7341 AS cfpk_lineitem_supplier_2#7386, cfpk_lineitem_partsupp#7342 AS cfpk_lineitem_partsupp_2#7387, cpfk_part_lineitem#7343 AS cpfk_part_lineitem_2#7388, cfpk_lineitem_part#7344 AS cfpk_lineitem_part_2#7389, cpfk_partsupp_lineitem#7345 AS cpfk_partsupp_lineitem_2#7390, cfpk_lineitem_orders#7346 AS cfpk_lineitem_orders_2#7391, cval_lineitem_l_quantity#7347 AS cval_lineitem_l_quantity_2#7392, cval_lineitem_l_extendedprice#7348 AS cval_lineitem_l_extendedprice_2#7393, cval_lineitem_l_discount#7349 AS cval_lineitem_l_discount_2#7394, cval_lineitem_l_tax#7350 AS cval_lineitem_l_tax_2#7395, cval_lineitem_l_returnflag#7351 AS cval_lineitem_l_returnflag_2#7396, cval_lineitem_l_linestatus#7352 AS cval_lineitem_l_linestatus_2#7397, cval_lineitem_l_commitdate#7353 AS cval_lineitem_l_commitdate_2#7398, cval_lineitem_l_receiptdate#7354 AS cval_lineitem_l_receiptdate_2#7399, cval_lineitem_l_shipinstruct#7355 AS cval_lineitem_l_shipinstruct_2#7400, cval_lineitem_l_shipmode#7356 AS cval_lineitem_l_shipmode_2#7401, cval_lineitem_l_comment#7357 AS cval_lineitem_l_comment_2#7402, cval_lineitem_l_shipdate#7358 AS cval_lineitem_l_shipdate_2#7403, cdepval_lineitem_l_quantity#7359 AS cdepval_lineitem_l_quantity_2#7404, cdepval_lineitem_l_extendedprice#7360 AS cdepval_lineitem_l_extendedprice_2#7405, cdepval_lineitem_l_discount#7361 AS cdepval_lineitem_l_discount_2#7406, ... 21 more fields]
         :  +- Relation[rid#7338,cpfk_orders_lineitem#7339,cpfk_supplier_lineitem#7340,cfpk_lineitem_supplier#7341,cfpk_lineitem_partsupp#7342,cpfk_part_lineitem#7343,cfpk_lineitem_part#7344,cpfk_partsupp_lineitem#7345,cfpk_lineitem_orders#7346,cval_lineitem_l_quantity#7347,cval_lineitem_l_extendedprice#7348,cval_lineitem_l_discount#7349,cval_lineitem_l_tax#7350,cval_lineitem_l_returnflag#7351,cval_lineitem_l_linestatus#7352,cval_lineitem_l_commitdate#7353,cval_lineitem_l_receiptdate#7354,cval_lineitem_l_shipinstruct#7355,cval_lineitem_l_shipmode#7356,cval_lineitem_l_comment#7357,cval_lineitem_l_shipdate#7358,cdepval_lineitem_l_quantity#7359,cdepval_lineitem_l_extendedprice#7360,cdepval_lineitem_l_discount#7361,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#7290 AS rid_1#7314, cpfk_customer_orders#7291 AS cpfk_customer_orders_1#7315, cfpk_orders_customer#7292 AS cfpk_orders_customer_1#7316, cval_orders_o_orderstatus#7293 AS cval_orders_o_orderstatus_1#7317, cval_orders_o_totalprice#7294 AS cval_orders_o_totalprice_1#7318, cval_orders_o_orderpriority#7295 AS cval_orders_o_orderpriority_1#7319, cval_orders_o_clerk#7296 AS cval_orders_o_clerk_1#7320, cval_orders_o_shippriority#7297 AS cval_orders_o_shippriority_1#7321, cval_orders_o_comment#7298 AS cval_orders_o_comment_1#7322, cval_orders_o_orderdate#7299 AS cval_orders_o_orderdate_1#7323, cdepval_orders_o_orderstatus#7300 AS cdepval_orders_o_orderstatus_1#7324, cdepval_orders_o_totalprice#7301 AS cdepval_orders_o_totalprice_1#7325, cdepval_orders_o_orderpriority#7302 AS cdepval_orders_o_orderpriority_1#7326, cdepval_orders_o_clerk#7303 AS cdepval_orders_o_clerk_1#7327, cdepval_orders_o_shippriority#7304 AS cdepval_orders_o_shippriority_1#7328, cdepval_orders_o_comment#7305 AS cdepval_orders_o_comment_1#7329, cdepval_orders_o_orderdate#7306 AS cdepval_orders_o_orderdate_1#7330, co_orderstatus#7307 AS co_orderstatus_1#7331, co_totalprice#7308 AS co_totalprice_1#7332, co_orderpriority#7309 AS co_orderpriority_1#7333, co_clerk#7310 AS co_clerk_1#7334, co_shippriority#7311 AS co_shippriority_1#7335, co_comment#7312 AS co_comment_1#7336, co_orderdate#7313 AS co_orderdate_1#7337]
            :  +- Relation[rid#7290,cpfk_customer_orders#7291,cfpk_orders_customer#7292,cval_orders_o_orderstatus#7293,cval_orders_o_totalprice#7294,cval_orders_o_orderpriority#7295,cval_orders_o_clerk#7296,cval_orders_o_shippriority#7297,cval_orders_o_comment#7298,cval_orders_o_orderdate#7299,cdepval_orders_o_orderstatus#7300,cdepval_orders_o_totalprice#7301,cdepval_orders_o_orderpriority#7302,cdepval_orders_o_clerk#7303,cdepval_orders_o_shippriority#7304,cdepval_orders_o_comment#7305,cdepval_orders_o_orderdate#7306,co_orderstatus#7307,co_totalprice#7308,co_orderpriority#7309,co_clerk#7310,co_shippriority#7311,co_comment#7312,co_orderdate#7313] JDBCRelation(torders) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
               +- Project [rid#7206 AS rid_0#7227, cpfk_nation_customer#7207 AS cpfk_nation_customer_0#7228, cfpk_customer_nation#7208 AS cfpk_customer_nation_0#7229, cval_customer_c_name#7209 AS cval_customer_c_name_0#7230, cval_customer_c_address#7210 AS cval_customer_c_address_0#7231, cval_customer_c_phone#7211 AS cval_customer_c_phone_0#7232, cval_customer_c_acctbal#7212 AS cval_customer_c_acctbal_0#7233, cval_customer_c_comment#7213 AS cval_customer_c_comment_0#7234, cval_customer_c_mktsegment#7214 AS cval_customer_c_mktsegment_0#7235, cdepval_customer_c_name#7215 AS cdepval_customer_c_name_0#7236, cdepval_customer_c_address#7216 AS cdepval_customer_c_address_0#7237, cdepval_customer_c_phone#7217 AS cdepval_customer_c_phone_0#7238, cdepval_customer_c_acctbal#7218 AS cdepval_customer_c_acctbal_0#7239, cdepval_customer_c_comment#7219 AS cdepval_customer_c_comment_0#7240, cdepval_customer_c_mktsegment#7220 AS cdepval_customer_c_mktsegment_0#7241, cc_name#7221 AS cc_name_0#7242, cc_address#7222 AS cc_address_0#7243, cc_phone#7223 AS cc_phone_0#7244, cc_acctbal#7224 AS cc_acctbal_0#7245, cc_comment#7225 AS cc_comment_0#7246, cc_mktsegment#7226 AS cc_mktsegment_0#7247]
                  +- Relation[rid#7206,cpfk_nation_customer#7207,cfpk_customer_nation#7208,cval_customer_c_name#7209,cval_customer_c_address#7210,cval_customer_c_phone#7211,cval_customer_c_acctbal#7212,cval_customer_c_comment#7213,cval_customer_c_mktsegment#7214,cdepval_customer_c_name#7215,cdepval_customer_c_address#7216,cdepval_customer_c_phone#7217,cdepval_customer_c_acctbal#7218,cdepval_customer_c_comment#7219,cdepval_customer_c_mktsegment#7220,cc_name#7221,cc_address#7222,cc_phone#7223,cc_acctbal#7224,cc_comment#7225,cc_mktsegment#7226] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 39131ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/25 23:06:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:06:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7530L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 23:06:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:06:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 23:06:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7530L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#7532 AS rid_0#7577, cpfk_orders_lineitem#7533 AS cpfk_orders_lineitem_0#7578, cpfk_supplier_lineitem#7534 AS cpfk_supplier_lineitem_0#7579, cfpk_lineitem_supplier#7535 AS cfpk_lineitem_supplier_0#7580, cfpk_lineitem_partsupp#7536 AS cfpk_lineitem_partsupp_0#7581, cpfk_part_lineitem#7537 AS cpfk_part_lineitem_0#7582, cfpk_lineitem_part#7538 AS cfpk_lineitem_part_0#7583, cpfk_partsupp_lineitem#7539 AS cpfk_partsupp_lineitem_0#7584, cfpk_lineitem_orders#7540 AS cfpk_lineitem_orders_0#7585, cval_lineitem_l_quantity#7541 AS cval_lineitem_l_quantity_0#7586, cval_lineitem_l_extendedprice#7542 AS cval_lineitem_l_extendedprice_0#7587, cval_lineitem_l_discount#7543 AS cval_lineitem_l_discount_0#7588, cval_lineitem_l_tax#7544 AS cval_lineitem_l_tax_0#7589, cval_lineitem_l_returnflag#7545 AS cval_lineitem_l_returnflag_0#7590, cval_lineitem_l_linestatus#7546 AS cval_lineitem_l_linestatus_0#7591, cval_lineitem_l_commitdate#7547 AS cval_lineitem_l_commitdate_0#7592, cval_lineitem_l_receiptdate#7548 AS cval_lineitem_l_receiptdate_0#7593, cval_lineitem_l_shipinstruct#7549 AS cval_lineitem_l_shipinstruct_0#7594, cval_lineitem_l_shipmode#7550 AS cval_lineitem_l_shipmode_0#7595, cval_lineitem_l_comment#7551 AS cval_lineitem_l_comment_0#7596, cval_lineitem_l_shipdate#7552 AS cval_lineitem_l_shipdate_0#7597, cdepval_lineitem_l_quantity#7553 AS cdepval_lineitem_l_quantity_0#7598, cdepval_lineitem_l_extendedprice#7554 AS cdepval_lineitem_l_extendedprice_0#7599, cdepval_lineitem_l_discount#7555 AS cdepval_lineitem_l_discount_0#7600, ... 21 more fields]
         :  :  :     +- Relation[rid#7532,cpfk_orders_lineitem#7533,cpfk_supplier_lineitem#7534,cfpk_lineitem_supplier#7535,cfpk_lineitem_partsupp#7536,cpfk_part_lineitem#7537,cfpk_lineitem_part#7538,cpfk_partsupp_lineitem#7539,cfpk_lineitem_orders#7540,cval_lineitem_l_quantity#7541,cval_lineitem_l_extendedprice#7542,cval_lineitem_l_discount#7543,cval_lineitem_l_tax#7544,cval_lineitem_l_returnflag#7545,cval_lineitem_l_linestatus#7546,cval_lineitem_l_commitdate#7547,cval_lineitem_l_receiptdate#7548,cval_lineitem_l_shipinstruct#7549,cval_lineitem_l_shipmode#7550,cval_lineitem_l_comment#7551,cval_lineitem_l_shipdate#7552,cdepval_lineitem_l_quantity#7553,cdepval_lineitem_l_extendedprice#7554,cdepval_lineitem_l_discount#7555,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#7712 AS rid_1#7736, cpfk_customer_orders#7713 AS cpfk_customer_orders_1#7737, cfpk_orders_customer#7714 AS cfpk_orders_customer_1#7738, cval_orders_o_orderstatus#7715 AS cval_orders_o_orderstatus_1#7739, cval_orders_o_totalprice#7716 AS cval_orders_o_totalprice_1#7740, cval_orders_o_orderpriority#7717 AS cval_orders_o_orderpriority_1#7741, cval_orders_o_clerk#7718 AS cval_orders_o_clerk_1#7742, cval_orders_o_shippriority#7719 AS cval_orders_o_shippriority_1#7743, cval_orders_o_comment#7720 AS cval_orders_o_comment_1#7744, cval_orders_o_orderdate#7721 AS cval_orders_o_orderdate_1#7745, cdepval_orders_o_orderstatus#7722 AS cdepval_orders_o_orderstatus_1#7746, cdepval_orders_o_totalprice#7723 AS cdepval_orders_o_totalprice_1#7747, cdepval_orders_o_orderpriority#7724 AS cdepval_orders_o_orderpriority_1#7748, cdepval_orders_o_clerk#7725 AS cdepval_orders_o_clerk_1#7749, cdepval_orders_o_shippriority#7726 AS cdepval_orders_o_shippriority_1#7750, cdepval_orders_o_comment#7727 AS cdepval_orders_o_comment_1#7751, cdepval_orders_o_orderdate#7728 AS cdepval_orders_o_orderdate_1#7752, co_orderstatus#7729 AS co_orderstatus_1#7753, co_totalprice#7730 AS co_totalprice_1#7754, co_orderpriority#7731 AS co_orderpriority_1#7755, co_clerk#7732 AS co_clerk_1#7756, co_shippriority#7733 AS co_shippriority_1#7757, co_comment#7734 AS co_comment_1#7758, co_orderdate#7735 AS co_orderdate_1#7759]
         :  :     +- Relation[rid#7712,cpfk_customer_orders#7713,cfpk_orders_customer#7714,cval_orders_o_orderstatus#7715,cval_orders_o_totalprice#7716,cval_orders_o_orderpriority#7717,cval_orders_o_clerk#7718,cval_orders_o_shippriority#7719,cval_orders_o_comment#7720,cval_orders_o_orderdate#7721,cdepval_orders_o_orderstatus#7722,cdepval_orders_o_totalprice#7723,cdepval_orders_o_orderpriority#7724,cdepval_orders_o_clerk#7725,cdepval_orders_o_shippriority#7726,cdepval_orders_o_comment#7727,cdepval_orders_o_orderdate#7728,co_orderstatus#7729,co_totalprice#7730,co_orderpriority#7731,co_clerk#7732,co_shippriority#7733,co_comment#7734,co_orderdate#7735] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#7760 AS rid_2#7781, cpfk_nation_customer#7761 AS cpfk_nation_customer_2#7782, cfpk_customer_nation#7762 AS cfpk_customer_nation_2#7783, cval_customer_c_name#7763 AS cval_customer_c_name_2#7784, cval_customer_c_address#7764 AS cval_customer_c_address_2#7785, cval_customer_c_phone#7765 AS cval_customer_c_phone_2#7786, cval_customer_c_acctbal#7766 AS cval_customer_c_acctbal_2#7787, cval_customer_c_comment#7767 AS cval_customer_c_comment_2#7788, cval_customer_c_mktsegment#7768 AS cval_customer_c_mktsegment_2#7789, cdepval_customer_c_name#7769 AS cdepval_customer_c_name_2#7790, cdepval_customer_c_address#7770 AS cdepval_customer_c_address_2#7791, cdepval_customer_c_phone#7771 AS cdepval_customer_c_phone_2#7792, cdepval_customer_c_acctbal#7772 AS cdepval_customer_c_acctbal_2#7793, cdepval_customer_c_comment#7773 AS cdepval_customer_c_comment_2#7794, cdepval_customer_c_mktsegment#7774 AS cdepval_customer_c_mktsegment_2#7795, cc_name#7775 AS cc_name_2#7796, cc_address#7776 AS cc_address_2#7797, cc_phone#7777 AS cc_phone_2#7798, cc_acctbal#7778 AS cc_acctbal_2#7799, cc_comment#7779 AS cc_comment_2#7800, cc_mktsegment#7780 AS cc_mktsegment_2#7801]
         :     +- Relation[rid#7760,cpfk_nation_customer#7761,cfpk_customer_nation#7762,cval_customer_c_name#7763,cval_customer_c_address#7764,cval_customer_c_phone#7765,cval_customer_c_acctbal#7766,cval_customer_c_comment#7767,cval_customer_c_mktsegment#7768,cdepval_customer_c_name#7769,cdepval_customer_c_address#7770,cdepval_customer_c_phone#7771,cdepval_customer_c_acctbal#7772,cdepval_customer_c_comment#7773,cdepval_customer_c_mktsegment#7774,cc_name#7775,cc_address#7776,cc_phone#7777,cc_acctbal#7778,cc_comment#7779,cc_mktsegment#7780] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#7802 AS rid_3#7811, cpfk_region_nation#7803 AS cpfk_region_nation_3#7812, cfpk_nation_region#7804 AS cfpk_nation_region_3#7813, cval_nation_n_name#7805 AS cval_nation_n_name_3#7814, cval_nation_n_comment#7806 AS cval_nation_n_comment_3#7815, cdepval_nation_n_name#7807 AS cdepval_nation_n_name_3#7816, cdepval_nation_n_comment#7808 AS cdepval_nation_n_comment_3#7817, cn_name#7809 AS cn_name_3#7818, cn_comment#7810 AS cn_comment_3#7819]
            +- Relation[rid#7802,cpfk_region_nation#7803,cfpk_nation_region#7804,cval_nation_n_name#7805,cval_nation_n_comment#7806,cdepval_nation_n_name#7807,cdepval_nation_n_comment#7808,cn_name#7809,cn_comment#7810] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 60473ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/25 23:07:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:07:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7947L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 23:07:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7947L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#7949 AS rid_0#7994, cpfk_orders_lineitem#7950 AS cpfk_orders_lineitem_0#7995, cpfk_supplier_lineitem#7951 AS cpfk_supplier_lineitem_0#7996, cfpk_lineitem_supplier#7952 AS cfpk_lineitem_supplier_0#7997, cfpk_lineitem_partsupp#7953 AS cfpk_lineitem_partsupp_0#7998, cpfk_part_lineitem#7954 AS cpfk_part_lineitem_0#7999, cfpk_lineitem_part#7955 AS cfpk_lineitem_part_0#8000, cpfk_partsupp_lineitem#7956 AS cpfk_partsupp_lineitem_0#8001, cfpk_lineitem_orders#7957 AS cfpk_lineitem_orders_0#8002, cval_lineitem_l_quantity#7958 AS cval_lineitem_l_quantity_0#8003, cval_lineitem_l_extendedprice#7959 AS cval_lineitem_l_extendedprice_0#8004, cval_lineitem_l_discount#7960 AS cval_lineitem_l_discount_0#8005, cval_lineitem_l_tax#7961 AS cval_lineitem_l_tax_0#8006, cval_lineitem_l_returnflag#7962 AS cval_lineitem_l_returnflag_0#8007, cval_lineitem_l_linestatus#7963 AS cval_lineitem_l_linestatus_0#8008, cval_lineitem_l_commitdate#7964 AS cval_lineitem_l_commitdate_0#8009, cval_lineitem_l_receiptdate#7965 AS cval_lineitem_l_receiptdate_0#8010, cval_lineitem_l_shipinstruct#7966 AS cval_lineitem_l_shipinstruct_0#8011, cval_lineitem_l_shipmode#7967 AS cval_lineitem_l_shipmode_0#8012, cval_lineitem_l_comment#7968 AS cval_lineitem_l_comment_0#8013, cval_lineitem_l_shipdate#7969 AS cval_lineitem_l_shipdate_0#8014, cdepval_lineitem_l_quantity#7970 AS cdepval_lineitem_l_quantity_0#8015, cdepval_lineitem_l_extendedprice#7971 AS cdepval_lineitem_l_extendedprice_0#8016, cdepval_lineitem_l_discount#7972 AS cdepval_lineitem_l_discount_0#8017, ... 21 more fields]
         :  +- Relation[rid#7949,cpfk_orders_lineitem#7950,cpfk_supplier_lineitem#7951,cfpk_lineitem_supplier#7952,cfpk_lineitem_partsupp#7953,cpfk_part_lineitem#7954,cfpk_lineitem_part#7955,cpfk_partsupp_lineitem#7956,cfpk_lineitem_orders#7957,cval_lineitem_l_quantity#7958,cval_lineitem_l_extendedprice#7959,cval_lineitem_l_discount#7960,cval_lineitem_l_tax#7961,cval_lineitem_l_returnflag#7962,cval_lineitem_l_linestatus#7963,cval_lineitem_l_commitdate#7964,cval_lineitem_l_receiptdate#7965,cval_lineitem_l_shipinstruct#7966,cval_lineitem_l_shipmode#7967,cval_lineitem_l_comment#7968,cval_lineitem_l_shipdate#7969,cdepval_lineitem_l_quantity#7970,cdepval_lineitem_l_extendedprice#7971,cdepval_lineitem_l_discount#7972,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8039 AS rid_1#8063, cpfk_customer_orders#8040 AS cpfk_customer_orders_1#8064, cfpk_orders_customer#8041 AS cfpk_orders_customer_1#8065, cval_orders_o_orderstatus#8042 AS cval_orders_o_orderstatus_1#8066, cval_orders_o_totalprice#8043 AS cval_orders_o_totalprice_1#8067, cval_orders_o_orderpriority#8044 AS cval_orders_o_orderpriority_1#8068, cval_orders_o_clerk#8045 AS cval_orders_o_clerk_1#8069, cval_orders_o_shippriority#8046 AS cval_orders_o_shippriority_1#8070, cval_orders_o_comment#8047 AS cval_orders_o_comment_1#8071, cval_orders_o_orderdate#8048 AS cval_orders_o_orderdate_1#8072, cdepval_orders_o_orderstatus#8049 AS cdepval_orders_o_orderstatus_1#8073, cdepval_orders_o_totalprice#8050 AS cdepval_orders_o_totalprice_1#8074, cdepval_orders_o_orderpriority#8051 AS cdepval_orders_o_orderpriority_1#8075, cdepval_orders_o_clerk#8052 AS cdepval_orders_o_clerk_1#8076, cdepval_orders_o_shippriority#8053 AS cdepval_orders_o_shippriority_1#8077, cdepval_orders_o_comment#8054 AS cdepval_orders_o_comment_1#8078, cdepval_orders_o_orderdate#8055 AS cdepval_orders_o_orderdate_1#8079, co_orderstatus#8056 AS co_orderstatus_1#8080, co_totalprice#8057 AS co_totalprice_1#8081, co_orderpriority#8058 AS co_orderpriority_1#8082, co_clerk#8059 AS co_clerk_1#8083, co_shippriority#8060 AS co_shippriority_1#8084, co_comment#8061 AS co_comment_1#8085, co_orderdate#8062 AS co_orderdate_1#8086]
            +- Relation[rid#8039,cpfk_customer_orders#8040,cfpk_orders_customer#8041,cval_orders_o_orderstatus#8042,cval_orders_o_totalprice#8043,cval_orders_o_orderpriority#8044,cval_orders_o_clerk#8045,cval_orders_o_shippriority#8046,cval_orders_o_comment#8047,cval_orders_o_orderdate#8048,cdepval_orders_o_orderstatus#8049,cdepval_orders_o_totalprice#8050,cdepval_orders_o_orderpriority#8051,cdepval_orders_o_clerk#8052,cdepval_orders_o_shippriority#8053,cdepval_orders_o_comment#8054,cdepval_orders_o_orderdate#8055,co_orderstatus#8056,co_totalprice#8057,co_orderpriority#8058,co_clerk#8059,co_shippriority#8060,co_comment#8061,co_orderdate#8062] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18398ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/25 23:08:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:08:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8161L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:08:08 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:08:08 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:08:08 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:08:08 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:08:08 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:08:08 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:08:08 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 23:08:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8161L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#8188, cval_part_p_name_0#8189, cval_part_p_mfgr_0#8190, cval_part_p_type_0#8191, cval_part_p_size_0#8192, cval_part_p_container_0#8193, cval_part_p_retailprice_0#8194, cval_part_p_comment_0#8195, cval_part_p_brand_0#8196, cdepval_part_p_name_0#8197, cdepval_part_p_mfgr_0#8198, cdepval_part_p_type_0#8199, cdepval_part_p_size_0#8200, cdepval_part_p_container_0#8201, cdepval_part_p_retailprice_0#8202, cdepval_part_p_comment_0#8203, cdepval_part_p_brand_0#8204, cp_name_0#8205, cp_mfgr_0#8206, cp_type_0#8207, cp_size_0#8208, cp_container_0#8209, cp_retailprice_0#8210, cp_comment_0#8211, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#8163 AS rid_0#8188, cval_part_p_name#8164 AS cval_part_p_name_0#8189, cval_part_p_mfgr#8165 AS cval_part_p_mfgr_0#8190, cval_part_p_type#8166 AS cval_part_p_type_0#8191, cval_part_p_size#8167 AS cval_part_p_size_0#8192, cval_part_p_container#8168 AS cval_part_p_container_0#8193, cval_part_p_retailprice#8169 AS cval_part_p_retailprice_0#8194, cval_part_p_comment#8170 AS cval_part_p_comment_0#8195, cval_part_p_brand#8171 AS cval_part_p_brand_0#8196, cdepval_part_p_name#8172 AS cdepval_part_p_name_0#8197, cdepval_part_p_mfgr#8173 AS cdepval_part_p_mfgr_0#8198, cdepval_part_p_type#8174 AS cdepval_part_p_type_0#8199, cdepval_part_p_size#8175 AS cdepval_part_p_size_0#8200, cdepval_part_p_container#8176 AS cdepval_part_p_container_0#8201, cdepval_part_p_retailprice#8177 AS cdepval_part_p_retailprice_0#8202, cdepval_part_p_comment#8178 AS cdepval_part_p_comment_0#8203, cdepval_part_p_brand#8179 AS cdepval_part_p_brand_0#8204, cp_name#8180 AS cp_name_0#8205, cp_mfgr#8181 AS cp_mfgr_0#8206, cp_type#8182 AS cp_type_0#8207, cp_size#8183 AS cp_size_0#8208, cp_container#8184 AS cp_container_0#8209, cp_retailprice#8185 AS cp_retailprice_0#8210, cp_comment#8186 AS cp_comment_0#8211, cp_brand#8187 AS cp_brand_0#8212]
         :  :        +- Relation[rid#8163,cval_part_p_name#8164,cval_part_p_mfgr#8165,cval_part_p_type#8166,cval_part_p_size#8167,cval_part_p_container#8168,cval_part_p_retailprice#8169,cval_part_p_comment#8170,cval_part_p_brand#8171,cdepval_part_p_name#8172,cdepval_part_p_mfgr#8173,cdepval_part_p_type#8174,cdepval_part_p_size#8175,cdepval_part_p_container#8176,cdepval_part_p_retailprice#8177,cdepval_part_p_comment#8178,cdepval_part_p_brand#8179,cp_name#8180,cp_mfgr#8181,cp_type#8182,cp_size#8183,cp_container#8184,cp_retailprice#8185,cp_comment#8186,cp_brand#8187] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#8633 AS rid_1#8678, cpfk_orders_lineitem#8634 AS cpfk_orders_lineitem_1#8679, cpfk_supplier_lineitem#8635 AS cpfk_supplier_lineitem_1#8680, cfpk_lineitem_supplier#8636 AS cfpk_lineitem_supplier_1#8681, cfpk_lineitem_partsupp#8637 AS cfpk_lineitem_partsupp_1#8682, cpfk_part_lineitem#8638 AS cpfk_part_lineitem_1#8683, cfpk_lineitem_part#8639 AS cfpk_lineitem_part_1#8684, cpfk_partsupp_lineitem#8640 AS cpfk_partsupp_lineitem_1#8685, cfpk_lineitem_orders#8641 AS cfpk_lineitem_orders_1#8686, cval_lineitem_l_quantity#8642 AS cval_lineitem_l_quantity_1#8687, cval_lineitem_l_extendedprice#8643 AS cval_lineitem_l_extendedprice_1#8688, cval_lineitem_l_discount#8644 AS cval_lineitem_l_discount_1#8689, cval_lineitem_l_tax#8645 AS cval_lineitem_l_tax_1#8690, cval_lineitem_l_returnflag#8646 AS cval_lineitem_l_returnflag_1#8691, cval_lineitem_l_linestatus#8647 AS cval_lineitem_l_linestatus_1#8692, cval_lineitem_l_commitdate#8648 AS cval_lineitem_l_commitdate_1#8693, cval_lineitem_l_receiptdate#8649 AS cval_lineitem_l_receiptdate_1#8694, cval_lineitem_l_shipinstruct#8650 AS cval_lineitem_l_shipinstruct_1#8695, cval_lineitem_l_shipmode#8651 AS cval_lineitem_l_shipmode_1#8696, cval_lineitem_l_comment#8652 AS cval_lineitem_l_comment_1#8697, cval_lineitem_l_shipdate#8653 AS cval_lineitem_l_shipdate_1#8698, cdepval_lineitem_l_quantity#8654 AS cdepval_lineitem_l_quantity_1#8699, cdepval_lineitem_l_extendedprice#8655 AS cdepval_lineitem_l_extendedprice_1#8700, cdepval_lineitem_l_discount#8656 AS cdepval_lineitem_l_discount_1#8701, ... 21 more fields]
         :        +- Relation[rid#8633,cpfk_orders_lineitem#8634,cpfk_supplier_lineitem#8635,cfpk_lineitem_supplier#8636,cfpk_lineitem_partsupp#8637,cpfk_part_lineitem#8638,cfpk_lineitem_part#8639,cpfk_partsupp_lineitem#8640,cfpk_lineitem_orders#8641,cval_lineitem_l_quantity#8642,cval_lineitem_l_extendedprice#8643,cval_lineitem_l_discount#8644,cval_lineitem_l_tax#8645,cval_lineitem_l_returnflag#8646,cval_lineitem_l_linestatus#8647,cval_lineitem_l_commitdate#8648,cval_lineitem_l_receiptdate#8649,cval_lineitem_l_shipinstruct#8650,cval_lineitem_l_shipmode#8651,cval_lineitem_l_comment#8652,cval_lineitem_l_shipdate#8653,cdepval_lineitem_l_quantity#8654,cdepval_lineitem_l_extendedprice#8655,cdepval_lineitem_l_discount#8656,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#8313 AS rid_1#8358, cpfk_orders_lineitem#8314 AS cpfk_orders_lineitem_1#8359, cpfk_supplier_lineitem#8315 AS cpfk_supplier_lineitem_1#8360, cfpk_lineitem_supplier#8316 AS cfpk_lineitem_supplier_1#8361, cfpk_lineitem_partsupp#8317 AS cfpk_lineitem_partsupp_1#8362, cpfk_part_lineitem#8318 AS cpfk_part_lineitem_1#8363, cfpk_lineitem_part#8319 AS cfpk_lineitem_part_1#8364, cpfk_partsupp_lineitem#8320 AS cpfk_partsupp_lineitem_1#8365, cfpk_lineitem_orders#8321 AS cfpk_lineitem_orders_1#8366, cval_lineitem_l_quantity#8322 AS cval_lineitem_l_quantity_1#8367, cval_lineitem_l_extendedprice#8323 AS cval_lineitem_l_extendedprice_1#8368, cval_lineitem_l_discount#8324 AS cval_lineitem_l_discount_1#8369, cval_lineitem_l_tax#8325 AS cval_lineitem_l_tax_1#8370, cval_lineitem_l_returnflag#8326 AS cval_lineitem_l_returnflag_1#8371, cval_lineitem_l_linestatus#8327 AS cval_lineitem_l_linestatus_1#8372, cval_lineitem_l_commitdate#8328 AS cval_lineitem_l_commitdate_1#8373, cval_lineitem_l_receiptdate#8329 AS cval_lineitem_l_receiptdate_1#8374, cval_lineitem_l_shipinstruct#8330 AS cval_lineitem_l_shipinstruct_1#8375, cval_lineitem_l_shipmode#8331 AS cval_lineitem_l_shipmode_1#8376, cval_lineitem_l_comment#8332 AS cval_lineitem_l_comment_1#8377, cval_lineitem_l_shipdate#8333 AS cval_lineitem_l_shipdate_1#8378, cdepval_lineitem_l_quantity#8334 AS cdepval_lineitem_l_quantity_1#8379, cdepval_lineitem_l_extendedprice#8335 AS cdepval_lineitem_l_extendedprice_1#8380, cdepval_lineitem_l_discount#8336 AS cdepval_lineitem_l_discount_1#8381, ... 21 more fields]
                  +- Relation[rid#8313,cpfk_orders_lineitem#8314,cpfk_supplier_lineitem#8315,cfpk_lineitem_supplier#8316,cfpk_lineitem_partsupp#8317,cpfk_part_lineitem#8318,cfpk_lineitem_part#8319,cpfk_partsupp_lineitem#8320,cfpk_lineitem_orders#8321,cval_lineitem_l_quantity#8322,cval_lineitem_l_extendedprice#8323,cval_lineitem_l_discount#8324,cval_lineitem_l_tax#8325,cval_lineitem_l_returnflag#8326,cval_lineitem_l_linestatus#8327,cval_lineitem_l_commitdate#8328,cval_lineitem_l_receiptdate#8329,cval_lineitem_l_shipinstruct#8330,cval_lineitem_l_shipmode#8331,cval_lineitem_l_comment#8332,cval_lineitem_l_shipdate#8333,cdepval_lineitem_l_quantity#8334,cdepval_lineitem_l_extendedprice#8335,cdepval_lineitem_l_discount#8336,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 16840ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/25 23:08:25 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:08:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8798L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:08:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#8798L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#8800 AS rid_0#8845, cpfk_orders_lineitem#8801 AS cpfk_orders_lineitem_0#8846, cpfk_supplier_lineitem#8802 AS cpfk_supplier_lineitem_0#8847, cfpk_lineitem_supplier#8803 AS cfpk_lineitem_supplier_0#8848, cfpk_lineitem_partsupp#8804 AS cfpk_lineitem_partsupp_0#8849, cpfk_part_lineitem#8805 AS cpfk_part_lineitem_0#8850, cfpk_lineitem_part#8806 AS cfpk_lineitem_part_0#8851, cpfk_partsupp_lineitem#8807 AS cpfk_partsupp_lineitem_0#8852, cfpk_lineitem_orders#8808 AS cfpk_lineitem_orders_0#8853, cval_lineitem_l_quantity#8809 AS cval_lineitem_l_quantity_0#8854, cval_lineitem_l_extendedprice#8810 AS cval_lineitem_l_extendedprice_0#8855, cval_lineitem_l_discount#8811 AS cval_lineitem_l_discount_0#8856, cval_lineitem_l_tax#8812 AS cval_lineitem_l_tax_0#8857, cval_lineitem_l_returnflag#8813 AS cval_lineitem_l_returnflag_0#8858, cval_lineitem_l_linestatus#8814 AS cval_lineitem_l_linestatus_0#8859, cval_lineitem_l_commitdate#8815 AS cval_lineitem_l_commitdate_0#8860, cval_lineitem_l_receiptdate#8816 AS cval_lineitem_l_receiptdate_0#8861, cval_lineitem_l_shipinstruct#8817 AS cval_lineitem_l_shipinstruct_0#8862, cval_lineitem_l_shipmode#8818 AS cval_lineitem_l_shipmode_0#8863, cval_lineitem_l_comment#8819 AS cval_lineitem_l_comment_0#8864, cval_lineitem_l_shipdate#8820 AS cval_lineitem_l_shipdate_0#8865, cdepval_lineitem_l_quantity#8821 AS cdepval_lineitem_l_quantity_0#8866, cdepval_lineitem_l_extendedprice#8822 AS cdepval_lineitem_l_extendedprice_0#8867, cdepval_lineitem_l_discount#8823 AS cdepval_lineitem_l_discount_0#8868, ... 21 more fields]
         +- Relation[rid#8800,cpfk_orders_lineitem#8801,cpfk_supplier_lineitem#8802,cfpk_lineitem_supplier#8803,cfpk_lineitem_partsupp#8804,cpfk_part_lineitem#8805,cfpk_lineitem_part#8806,cpfk_partsupp_lineitem#8807,cfpk_lineitem_orders#8808,cval_lineitem_l_quantity#8809,cval_lineitem_l_extendedprice#8810,cval_lineitem_l_discount#8811,cval_lineitem_l_tax#8812,cval_lineitem_l_returnflag#8813,cval_lineitem_l_linestatus#8814,cval_lineitem_l_commitdate#8815,cval_lineitem_l_receiptdate#8816,cval_lineitem_l_shipinstruct#8817,cval_lineitem_l_shipmode#8818,cval_lineitem_l_comment#8819,cval_lineitem_l_shipdate#8820,cdepval_lineitem_l_quantity#8821,cdepval_lineitem_l_extendedprice#8822,cdepval_lineitem_l_discount#8823,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 5042ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/25 23:08:30 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 23:08:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8942L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 23:08:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:08:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 23:08:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8942L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#8980 AS rid_1#9025, cpfk_orders_lineitem#8981 AS cpfk_orders_lineitem_1#9026, cpfk_supplier_lineitem#8982 AS cpfk_supplier_lineitem_1#9027, cfpk_lineitem_supplier#8983 AS cfpk_lineitem_supplier_1#9028, cfpk_lineitem_partsupp#8984 AS cfpk_lineitem_partsupp_1#9029, cpfk_part_lineitem#8985 AS cpfk_part_lineitem_1#9030, cfpk_lineitem_part#8986 AS cfpk_lineitem_part_1#9031, cpfk_partsupp_lineitem#8987 AS cpfk_partsupp_lineitem_1#9032, cfpk_lineitem_orders#8988 AS cfpk_lineitem_orders_1#9033, cval_lineitem_l_quantity#8989 AS cval_lineitem_l_quantity_1#9034, cval_lineitem_l_extendedprice#8990 AS cval_lineitem_l_extendedprice_1#9035, cval_lineitem_l_discount#8991 AS cval_lineitem_l_discount_1#9036, cval_lineitem_l_tax#8992 AS cval_lineitem_l_tax_1#9037, cval_lineitem_l_returnflag#8993 AS cval_lineitem_l_returnflag_1#9038, cval_lineitem_l_linestatus#8994 AS cval_lineitem_l_linestatus_1#9039, cval_lineitem_l_commitdate#8995 AS cval_lineitem_l_commitdate_1#9040, cval_lineitem_l_receiptdate#8996 AS cval_lineitem_l_receiptdate_1#9041, cval_lineitem_l_shipinstruct#8997 AS cval_lineitem_l_shipinstruct_1#9042, cval_lineitem_l_shipmode#8998 AS cval_lineitem_l_shipmode_1#9043, cval_lineitem_l_comment#8999 AS cval_lineitem_l_comment_1#9044, cval_lineitem_l_shipdate#9000 AS cval_lineitem_l_shipdate_1#9045, cdepval_lineitem_l_quantity#9001 AS cdepval_lineitem_l_quantity_1#9046, cdepval_lineitem_l_extendedprice#9002 AS cdepval_lineitem_l_extendedprice_1#9047, cdepval_lineitem_l_discount#9003 AS cdepval_lineitem_l_discount_1#9048, ... 21 more fields]
         :  +- Relation[rid#8980,cpfk_orders_lineitem#8981,cpfk_supplier_lineitem#8982,cfpk_lineitem_supplier#8983,cfpk_lineitem_partsupp#8984,cpfk_part_lineitem#8985,cfpk_lineitem_part#8986,cpfk_partsupp_lineitem#8987,cfpk_lineitem_orders#8988,cval_lineitem_l_quantity#8989,cval_lineitem_l_extendedprice#8990,cval_lineitem_l_discount#8991,cval_lineitem_l_tax#8992,cval_lineitem_l_returnflag#8993,cval_lineitem_l_linestatus#8994,cval_lineitem_l_commitdate#8995,cval_lineitem_l_receiptdate#8996,cval_lineitem_l_shipinstruct#8997,cval_lineitem_l_shipmode#8998,cval_lineitem_l_comment#8999,cval_lineitem_l_shipdate#9000,cdepval_lineitem_l_quantity#9001,cdepval_lineitem_l_extendedprice#9002,cdepval_lineitem_l_discount#9003,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8944 AS rid_0#8962, cpfk_nation_supplier#8945 AS cpfk_nation_supplier_0#8963, cfpk_supplier_nation#8946 AS cfpk_supplier_nation_0#8964, cval_supplier_s_name#8947 AS cval_supplier_s_name_0#8965, cval_supplier_s_address#8948 AS cval_supplier_s_address_0#8966, cval_supplier_s_phone#8949 AS cval_supplier_s_phone_0#8967, cval_supplier_s_acctbal#8950 AS cval_supplier_s_acctbal_0#8968, cval_supplier_s_comment#8951 AS cval_supplier_s_comment_0#8969, cdepval_supplier_s_name#8952 AS cdepval_supplier_s_name_0#8970, cdepval_supplier_s_address#8953 AS cdepval_supplier_s_address_0#8971, cdepval_supplier_s_phone#8954 AS cdepval_supplier_s_phone_0#8972, cdepval_supplier_s_acctbal#8955 AS cdepval_supplier_s_acctbal_0#8973, cdepval_supplier_s_comment#8956 AS cdepval_supplier_s_comment_0#8974, cs_name#8957 AS cs_name_0#8975, cs_address#8958 AS cs_address_0#8976, cs_phone#8959 AS cs_phone_0#8977, cs_acctbal#8960 AS cs_acctbal_0#8978, cs_comment#8961 AS cs_comment_0#8979]
            +- Relation[rid#8944,cpfk_nation_supplier#8945,cfpk_supplier_nation#8946,cval_supplier_s_name#8947,cval_supplier_s_address#8948,cval_supplier_s_phone#8949,cval_supplier_s_acctbal#8950,cval_supplier_s_comment#8951,cdepval_supplier_s_name#8952,cdepval_supplier_s_address#8953,cdepval_supplier_s_phone#8954,cdepval_supplier_s_acctbal#8955,cdepval_supplier_s_comment#8956,cs_name#8957,cs_address#8958,cs_phone#8959,cs_acctbal#8960,cs_comment#8961] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17188ms
query=q1, count=6001215, duration=2352
query=q10, count=1478870, duration=60473
query=q11, count=31680, duration=3441
query=q12, count=857401, duration=22375
query=q13, count=1500000, duration=4394
query=q14, count=6001215, duration=17895
query=q15, count=6001215, duration=17188
query=q16, count=15780, duration=3325
query=q17, count=6088, duration=26184
query=q18, count=6001215, duration=22567
query=q19, count=205, duration=16840
query=q2, count=3162, duration=3564
query=q20, count=632, duration=3568
query=q21a, count=597422, duration=76200
query=q22, count=1500000, duration=4423
query=q3, count=1214743, duration=39131
query=q4, count=6001215, duration=18398
query=q5, count=48089, duration=30797
query=q6, count=6001215, duration=5042
query=q7, count=9735, duration=35000
query=q8, count=8716, duration=44679
query=q9a, count=6001215, duration=63567
query=q9b, count=6001215, duration=38201
