20/04/26 22:17:45 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10680ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sun Apr 26 22:17:48 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sun Apr 26 22:17:50 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sun Apr 26 22:17:50 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sun Apr 26 22:17:50 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sun Apr 26 22:17:50 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sun Apr 26 22:17:54 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sun Apr 26 22:17:57 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sun Apr 26 22:17:57 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/26 22:17:59 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:17:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2078L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 22:18:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:18:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:18:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:18:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:18:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:18:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:18:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:18:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:18:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:18:00 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/26 22:18:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2078L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#2080 AS rid_0#2125, cpfk_orders_lineitem#2081 AS cpfk_orders_lineitem_0#2126, cpfk_supplier_lineitem#2082 AS cpfk_supplier_lineitem_0#2127, cfpk_lineitem_supplier#2083 AS cfpk_lineitem_supplier_0#2128, cfpk_lineitem_partsupp#2084 AS cfpk_lineitem_partsupp_0#2129, cpfk_part_lineitem#2085 AS cpfk_part_lineitem_0#2130, cfpk_lineitem_part#2086 AS cfpk_lineitem_part_0#2131, cpfk_partsupp_lineitem#2087 AS cpfk_partsupp_lineitem_0#2132, cfpk_lineitem_orders#2088 AS cfpk_lineitem_orders_0#2133, cval_lineitem_l_quantity#2089 AS cval_lineitem_l_quantity_0#2134, cval_lineitem_l_extendedprice#2090 AS cval_lineitem_l_extendedprice_0#2135, cval_lineitem_l_discount#2091 AS cval_lineitem_l_discount_0#2136, cval_lineitem_l_tax#2092 AS cval_lineitem_l_tax_0#2137, cval_lineitem_l_returnflag#2093 AS cval_lineitem_l_returnflag_0#2138, cval_lineitem_l_linestatus#2094 AS cval_lineitem_l_linestatus_0#2139, cval_lineitem_l_commitdate#2095 AS cval_lineitem_l_commitdate_0#2140, cval_lineitem_l_receiptdate#2096 AS cval_lineitem_l_receiptdate_0#2141, cval_lineitem_l_shipinstruct#2097 AS cval_lineitem_l_shipinstruct_0#2142, cval_lineitem_l_shipmode#2098 AS cval_lineitem_l_shipmode_0#2143, cval_lineitem_l_comment#2099 AS cval_lineitem_l_comment_0#2144, cval_lineitem_l_shipdate#2100 AS cval_lineitem_l_shipdate_0#2145, cdepval_lineitem_l_quantity#2101 AS cdepval_lineitem_l_quantity_0#2146, cdepval_lineitem_l_extendedprice#2102 AS cdepval_lineitem_l_extendedprice_0#2147, cdepval_lineitem_l_discount#2103 AS cdepval_lineitem_l_discount_0#2148, ... 21 more fields]
         :  +- Relation[rid#2080,cpfk_orders_lineitem#2081,cpfk_supplier_lineitem#2082,cfpk_lineitem_supplier#2083,cfpk_lineitem_partsupp#2084,cpfk_part_lineitem#2085,cfpk_lineitem_part#2086,cpfk_partsupp_lineitem#2087,cfpk_lineitem_orders#2088,cval_lineitem_l_quantity#2089,cval_lineitem_l_extendedprice#2090,cval_lineitem_l_discount#2091,cval_lineitem_l_tax#2092,cval_lineitem_l_returnflag#2093,cval_lineitem_l_linestatus#2094,cval_lineitem_l_commitdate#2095,cval_lineitem_l_receiptdate#2096,cval_lineitem_l_shipinstruct#2097,cval_lineitem_l_shipmode#2098,cval_lineitem_l_comment#2099,cval_lineitem_l_shipdate#2100,cdepval_lineitem_l_quantity#2101,cdepval_lineitem_l_extendedprice#2102,cdepval_lineitem_l_discount#2103,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#2539, cpfk_region_nation_4#2540, cfpk_nation_region_4#2541, cval_nation_n_name_4#2542, cval_nation_n_comment_4#2543, cdepval_nation_n_name_4#2544, cdepval_nation_n_comment_4#2545, cn_name_4#2546, cn_comment_4#2547, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
            :  :  +- Project [rid#2530 AS rid_4#2539, cpfk_region_nation#2531 AS cpfk_region_nation_4#2540, cfpk_nation_region#2532 AS cfpk_nation_region_4#2541, cval_nation_n_name#2533 AS cval_nation_n_name_4#2542, cval_nation_n_comment#2534 AS cval_nation_n_comment_4#2543, cdepval_nation_n_name#2535 AS cdepval_nation_n_name_4#2544, cdepval_nation_n_comment#2536 AS cdepval_nation_n_comment_4#2545, cn_name#2537 AS cn_name_4#2546, cn_comment#2538 AS cn_comment_4#2547]
            :  :     +- Relation[rid#2530,cpfk_region_nation#2531,cfpk_nation_region#2532,cval_nation_n_name#2533,cval_nation_n_comment#2534,cdepval_nation_n_name#2535,cdepval_nation_n_comment#2536,cn_name#2537,cn_comment#2538] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#2584 AS rid_3#2602, cpfk_nation_supplier#2585 AS cpfk_nation_supplier_3#2603, cfpk_supplier_nation#2586 AS cfpk_supplier_nation_3#2604, cval_supplier_s_name#2587 AS cval_supplier_s_name_3#2605, cval_supplier_s_address#2588 AS cval_supplier_s_address_3#2606, cval_supplier_s_phone#2589 AS cval_supplier_s_phone_3#2607, cval_supplier_s_acctbal#2590 AS cval_supplier_s_acctbal_3#2608, cval_supplier_s_comment#2591 AS cval_supplier_s_comment_3#2609, cdepval_supplier_s_name#2592 AS cdepval_supplier_s_name_3#2610, cdepval_supplier_s_address#2593 AS cdepval_supplier_s_address_3#2611, cdepval_supplier_s_phone#2594 AS cdepval_supplier_s_phone_3#2612, cdepval_supplier_s_acctbal#2595 AS cdepval_supplier_s_acctbal_3#2613, cdepval_supplier_s_comment#2596 AS cdepval_supplier_s_comment_3#2614, cs_name#2597 AS cs_name_3#2615, cs_address#2598 AS cs_address_3#2616, cs_phone#2599 AS cs_phone_3#2617, cs_acctbal#2600 AS cs_acctbal_3#2618, cs_comment#2601 AS cs_comment_3#2619]
            :        +- Relation[rid#2584,cpfk_nation_supplier#2585,cfpk_supplier_nation#2586,cval_supplier_s_name#2587,cval_supplier_s_address#2588,cval_supplier_s_phone#2589,cval_supplier_s_acctbal#2590,cval_supplier_s_comment#2591,cdepval_supplier_s_name#2592,cdepval_supplier_s_address#2593,cdepval_supplier_s_phone#2594,cdepval_supplier_s_acctbal#2595,cdepval_supplier_s_comment#2596,cs_name#2597,cs_address#2598,cs_phone#2599,cs_acctbal#2600,cs_comment#2601] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'DexPkfkMaterializationAwareJoin orders~lineitem, 'cpfk_orders_lineitem_2, 'rid_1, NotMaterialized, NotMaterialized, [rid_1#2194, cpfk_customer_orders_1#2195, cfpk_orders_customer_1#2196, cval_orders_o_orderstatus_1#2197, cval_orders_o_totalprice_1#2198, cval_orders_o_orderpriority_1#2199, cval_orders_o_clerk_1#2200, cval_orders_o_shippriority_1#2201, cval_orders_o_comment_1#2202, cval_orders_o_orderdate_1#2203, cdepval_orders_o_orderstatus_1#2204, cdepval_orders_o_totalprice_1#2205, cdepval_orders_o_orderpriority_1#2206, cdepval_orders_o_clerk_1#2207, cdepval_orders_o_shippriority_1#2208, cdepval_orders_o_comment_1#2209, cdepval_orders_o_orderdate_1#2210, co_orderstatus_1#2211, co_totalprice_1#2212, co_orderpriority_1#2213, co_clerk_1#2214, co_shippriority_1#2215, co_comment_1#2216, co_orderdate_1#2217, 'rid_2]
               :  :  :- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
               :  :  :  +- Project [rid#2170 AS rid_1#2194, cpfk_customer_orders#2171 AS cpfk_customer_orders_1#2195, cfpk_orders_customer#2172 AS cfpk_orders_customer_1#2196, cval_orders_o_orderstatus#2173 AS cval_orders_o_orderstatus_1#2197, cval_orders_o_totalprice#2174 AS cval_orders_o_totalprice_1#2198, cval_orders_o_orderpriority#2175 AS cval_orders_o_orderpriority_1#2199, cval_orders_o_clerk#2176 AS cval_orders_o_clerk_1#2200, cval_orders_o_shippriority#2177 AS cval_orders_o_shippriority_1#2201, cval_orders_o_comment#2178 AS cval_orders_o_comment_1#2202, cval_orders_o_orderdate#2179 AS cval_orders_o_orderdate_1#2203, cdepval_orders_o_orderstatus#2180 AS cdepval_orders_o_orderstatus_1#2204, cdepval_orders_o_totalprice#2181 AS cdepval_orders_o_totalprice_1#2205, cdepval_orders_o_orderpriority#2182 AS cdepval_orders_o_orderpriority_1#2206, cdepval_orders_o_clerk#2183 AS cdepval_orders_o_clerk_1#2207, cdepval_orders_o_shippriority#2184 AS cdepval_orders_o_shippriority_1#2208, cdepval_orders_o_comment#2185 AS cdepval_orders_o_comment_1#2209, cdepval_orders_o_orderdate#2186 AS cdepval_orders_o_orderdate_1#2210, co_orderstatus#2187 AS co_orderstatus_1#2211, co_totalprice#2188 AS co_totalprice_1#2212, co_orderpriority#2189 AS co_orderpriority_1#2213, co_clerk#2190 AS co_clerk_1#2214, co_shippriority#2191 AS co_shippriority_1#2215, co_comment#2192 AS co_comment_1#2216, co_orderdate#2193 AS co_orderdate_1#2217]
               :  :  :     +- Relation[rid#2170,cpfk_customer_orders#2171,cfpk_orders_customer#2172,cval_orders_o_orderstatus#2173,cval_orders_o_totalprice#2174,cval_orders_o_orderpriority#2175,cval_orders_o_clerk#2176,cval_orders_o_shippriority#2177,cval_orders_o_comment#2178,cval_orders_o_orderdate#2179,cdepval_orders_o_orderstatus#2180,cdepval_orders_o_totalprice#2181,cdepval_orders_o_orderpriority#2182,cdepval_orders_o_clerk#2183,cdepval_orders_o_shippriority#2184,cdepval_orders_o_comment#2185,cdepval_orders_o_orderdate#2186,co_orderstatus#2187,co_totalprice#2188,co_orderpriority#2189,co_clerk#2190,co_shippriority#2191,co_comment#2192,co_orderdate#2193] JDBCRelation(torders) [numPartitions=1]
               :  :  +- 'Project ['cpfk_orders_lineitem_2, 'rid_2]
               :  :     +- Project [rid#2404 AS rid_2#2449, cpfk_orders_lineitem#2405 AS cpfk_orders_lineitem_2#2450, cpfk_supplier_lineitem#2406 AS cpfk_supplier_lineitem_2#2451, cfpk_lineitem_supplier#2407 AS cfpk_lineitem_supplier_2#2452, cfpk_lineitem_partsupp#2408 AS cfpk_lineitem_partsupp_2#2453, cpfk_part_lineitem#2409 AS cpfk_part_lineitem_2#2454, cfpk_lineitem_part#2410 AS cfpk_lineitem_part_2#2455, cpfk_partsupp_lineitem#2411 AS cpfk_partsupp_lineitem_2#2456, cfpk_lineitem_orders#2412 AS cfpk_lineitem_orders_2#2457, cval_lineitem_l_quantity#2413 AS cval_lineitem_l_quantity_2#2458, cval_lineitem_l_extendedprice#2414 AS cval_lineitem_l_extendedprice_2#2459, cval_lineitem_l_discount#2415 AS cval_lineitem_l_discount_2#2460, cval_lineitem_l_tax#2416 AS cval_lineitem_l_tax_2#2461, cval_lineitem_l_returnflag#2417 AS cval_lineitem_l_returnflag_2#2462, cval_lineitem_l_linestatus#2418 AS cval_lineitem_l_linestatus_2#2463, cval_lineitem_l_commitdate#2419 AS cval_lineitem_l_commitdate_2#2464, cval_lineitem_l_receiptdate#2420 AS cval_lineitem_l_receiptdate_2#2465, cval_lineitem_l_shipinstruct#2421 AS cval_lineitem_l_shipinstruct_2#2466, cval_lineitem_l_shipmode#2422 AS cval_lineitem_l_shipmode_2#2467, cval_lineitem_l_comment#2423 AS cval_lineitem_l_comment_2#2468, cval_lineitem_l_shipdate#2424 AS cval_lineitem_l_shipdate_2#2469, cdepval_lineitem_l_quantity#2425 AS cdepval_lineitem_l_quantity_2#2470, cdepval_lineitem_l_extendedprice#2426 AS cdepval_lineitem_l_extendedprice_2#2471, cdepval_lineitem_l_discount#2427 AS cdepval_lineitem_l_discount_2#2472, ... 21 more fields]
               :  :        +- Relation[rid#2404,cpfk_orders_lineitem#2405,cpfk_supplier_lineitem#2406,cfpk_lineitem_supplier#2407,cfpk_lineitem_partsupp#2408,cpfk_part_lineitem#2409,cfpk_lineitem_part#2410,cpfk_partsupp_lineitem#2411,cfpk_lineitem_orders#2412,cval_lineitem_l_quantity#2413,cval_lineitem_l_extendedprice#2414,cval_lineitem_l_discount#2415,cval_lineitem_l_tax#2416,cval_lineitem_l_returnflag#2417,cval_lineitem_l_linestatus#2418,cval_lineitem_l_commitdate#2419,cval_lineitem_l_receiptdate#2420,cval_lineitem_l_shipinstruct#2421,cval_lineitem_l_shipmode#2422,cval_lineitem_l_comment#2423,cval_lineitem_l_shipdate#2424,cdepval_lineitem_l_quantity#2425,cdepval_lineitem_l_extendedprice#2426,cdepval_lineitem_l_discount#2427,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               :  +- Project [rid#2266 AS rid_2#2311, cpfk_orders_lineitem#2267 AS cpfk_orders_lineitem_2#2312, cpfk_supplier_lineitem#2268 AS cpfk_supplier_lineitem_2#2313, cfpk_lineitem_supplier#2269 AS cfpk_lineitem_supplier_2#2314, cfpk_lineitem_partsupp#2270 AS cfpk_lineitem_partsupp_2#2315, cpfk_part_lineitem#2271 AS cpfk_part_lineitem_2#2316, cfpk_lineitem_part#2272 AS cfpk_lineitem_part_2#2317, cpfk_partsupp_lineitem#2273 AS cpfk_partsupp_lineitem_2#2318, cfpk_lineitem_orders#2274 AS cfpk_lineitem_orders_2#2319, cval_lineitem_l_quantity#2275 AS cval_lineitem_l_quantity_2#2320, cval_lineitem_l_extendedprice#2276 AS cval_lineitem_l_extendedprice_2#2321, cval_lineitem_l_discount#2277 AS cval_lineitem_l_discount_2#2322, cval_lineitem_l_tax#2278 AS cval_lineitem_l_tax_2#2323, cval_lineitem_l_returnflag#2279 AS cval_lineitem_l_returnflag_2#2324, cval_lineitem_l_linestatus#2280 AS cval_lineitem_l_linestatus_2#2325, cval_lineitem_l_commitdate#2281 AS cval_lineitem_l_commitdate_2#2326, cval_lineitem_l_receiptdate#2282 AS cval_lineitem_l_receiptdate_2#2327, cval_lineitem_l_shipinstruct#2283 AS cval_lineitem_l_shipinstruct_2#2328, cval_lineitem_l_shipmode#2284 AS cval_lineitem_l_shipmode_2#2329, cval_lineitem_l_comment#2285 AS cval_lineitem_l_comment_2#2330, cval_lineitem_l_shipdate#2286 AS cval_lineitem_l_shipdate_2#2331, cdepval_lineitem_l_quantity#2287 AS cdepval_lineitem_l_quantity_2#2332, cdepval_lineitem_l_extendedprice#2288 AS cdepval_lineitem_l_extendedprice_2#2333, cdepval_lineitem_l_discount#2289 AS cdepval_lineitem_l_discount_2#2334, ... 21 more fields]
               :     +- Relation[rid#2266,cpfk_orders_lineitem#2267,cpfk_supplier_lineitem#2268,cfpk_lineitem_supplier#2269,cfpk_lineitem_partsupp#2270,cpfk_part_lineitem#2271,cfpk_lineitem_part#2272,cpfk_partsupp_lineitem#2273,cfpk_lineitem_orders#2274,cval_lineitem_l_quantity#2275,cval_lineitem_l_extendedprice#2276,cval_lineitem_l_discount#2277,cval_lineitem_l_tax#2278,cval_lineitem_l_returnflag#2279,cval_lineitem_l_linestatus#2280,cval_lineitem_l_commitdate#2281,cval_lineitem_l_receiptdate#2282,cval_lineitem_l_shipinstruct#2283,cval_lineitem_l_shipmode#2284,cval_lineitem_l_comment#2285,cval_lineitem_l_shipdate#2286,cdepval_lineitem_l_quantity#2287,cdepval_lineitem_l_extendedprice#2288,cdepval_lineitem_l_discount#2289,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               +- Project [rid#2494 AS rid_3#2512, cpfk_nation_supplier#2495 AS cpfk_nation_supplier_3#2513, cfpk_supplier_nation#2496 AS cfpk_supplier_nation_3#2514, cval_supplier_s_name#2497 AS cval_supplier_s_name_3#2515, cval_supplier_s_address#2498 AS cval_supplier_s_address_3#2516, cval_supplier_s_phone#2499 AS cval_supplier_s_phone_3#2517, cval_supplier_s_acctbal#2500 AS cval_supplier_s_acctbal_3#2518, cval_supplier_s_comment#2501 AS cval_supplier_s_comment_3#2519, cdepval_supplier_s_name#2502 AS cdepval_supplier_s_name_3#2520, cdepval_supplier_s_address#2503 AS cdepval_supplier_s_address_3#2521, cdepval_supplier_s_phone#2504 AS cdepval_supplier_s_phone_3#2522, cdepval_supplier_s_acctbal#2505 AS cdepval_supplier_s_acctbal_3#2523, cdepval_supplier_s_comment#2506 AS cdepval_supplier_s_comment_3#2524, cs_name#2507 AS cs_name_3#2525, cs_address#2508 AS cs_address_3#2526, cs_phone#2509 AS cs_phone_3#2527, cs_acctbal#2510 AS cs_acctbal_3#2528, cs_comment#2511 AS cs_comment_3#2529]
                  +- Relation[rid#2494,cpfk_nation_supplier#2495,cfpk_supplier_nation#2496,cval_supplier_s_name#2497,cval_supplier_s_address#2498,cval_supplier_s_phone#2499,cval_supplier_s_acctbal#2500,cval_supplier_s_comment#2501,cdepval_supplier_s_name#2502,cdepval_supplier_s_address#2503,cdepval_supplier_s_phone#2504,cdepval_supplier_s_acctbal#2505,cdepval_supplier_s_comment#2506,cs_name#2507,cs_address#2508,cs_phone#2509,cs_acctbal#2510,cs_comment#2511] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 157974ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/26 22:20:37 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:20:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2770L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:20:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2770L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#2862 AS rid_2#2907, cpfk_orders_lineitem#2863 AS cpfk_orders_lineitem_2#2908, cpfk_supplier_lineitem#2864 AS cpfk_supplier_lineitem_2#2909, cfpk_lineitem_supplier#2865 AS cfpk_lineitem_supplier_2#2910, cfpk_lineitem_partsupp#2866 AS cfpk_lineitem_partsupp_2#2911, cpfk_part_lineitem#2867 AS cpfk_part_lineitem_2#2912, cfpk_lineitem_part#2868 AS cfpk_lineitem_part_2#2913, cpfk_partsupp_lineitem#2869 AS cpfk_partsupp_lineitem_2#2914, cfpk_lineitem_orders#2870 AS cfpk_lineitem_orders_2#2915, cval_lineitem_l_quantity#2871 AS cval_lineitem_l_quantity_2#2916, cval_lineitem_l_extendedprice#2872 AS cval_lineitem_l_extendedprice_2#2917, cval_lineitem_l_discount#2873 AS cval_lineitem_l_discount_2#2918, cval_lineitem_l_tax#2874 AS cval_lineitem_l_tax_2#2919, cval_lineitem_l_returnflag#2875 AS cval_lineitem_l_returnflag_2#2920, cval_lineitem_l_linestatus#2876 AS cval_lineitem_l_linestatus_2#2921, cval_lineitem_l_commitdate#2877 AS cval_lineitem_l_commitdate_2#2922, cval_lineitem_l_receiptdate#2878 AS cval_lineitem_l_receiptdate_2#2923, cval_lineitem_l_shipinstruct#2879 AS cval_lineitem_l_shipinstruct_2#2924, cval_lineitem_l_shipmode#2880 AS cval_lineitem_l_shipmode_2#2925, cval_lineitem_l_comment#2881 AS cval_lineitem_l_comment_2#2926, cval_lineitem_l_shipdate#2882 AS cval_lineitem_l_shipdate_2#2927, cdepval_lineitem_l_quantity#2883 AS cdepval_lineitem_l_quantity_2#2928, cdepval_lineitem_l_extendedprice#2884 AS cdepval_lineitem_l_extendedprice_2#2929, cdepval_lineitem_l_discount#2885 AS cdepval_lineitem_l_discount_2#2930, ... 21 more fields]
         :  +- Relation[rid#2862,cpfk_orders_lineitem#2863,cpfk_supplier_lineitem#2864,cfpk_lineitem_supplier#2865,cfpk_lineitem_partsupp#2866,cpfk_part_lineitem#2867,cfpk_lineitem_part#2868,cpfk_partsupp_lineitem#2869,cfpk_lineitem_orders#2870,cval_lineitem_l_quantity#2871,cval_lineitem_l_extendedprice#2872,cval_lineitem_l_discount#2873,cval_lineitem_l_tax#2874,cval_lineitem_l_returnflag#2875,cval_lineitem_l_linestatus#2876,cval_lineitem_l_commitdate#2877,cval_lineitem_l_receiptdate#2878,cval_lineitem_l_shipinstruct#2879,cval_lineitem_l_shipmode#2880,cval_lineitem_l_comment#2881,cval_lineitem_l_shipdate#2882,cdepval_lineitem_l_quantity#2883,cdepval_lineitem_l_extendedprice#2884,cdepval_lineitem_l_discount#2885,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#2814 AS rid_1#2838, cpfk_customer_orders#2815 AS cpfk_customer_orders_1#2839, cfpk_orders_customer#2816 AS cfpk_orders_customer_1#2840, cval_orders_o_orderstatus#2817 AS cval_orders_o_orderstatus_1#2841, cval_orders_o_totalprice#2818 AS cval_orders_o_totalprice_1#2842, cval_orders_o_orderpriority#2819 AS cval_orders_o_orderpriority_1#2843, cval_orders_o_clerk#2820 AS cval_orders_o_clerk_1#2844, cval_orders_o_shippriority#2821 AS cval_orders_o_shippriority_1#2845, cval_orders_o_comment#2822 AS cval_orders_o_comment_1#2846, cval_orders_o_orderdate#2823 AS cval_orders_o_orderdate_1#2847, cdepval_orders_o_orderstatus#2824 AS cdepval_orders_o_orderstatus_1#2848, cdepval_orders_o_totalprice#2825 AS cdepval_orders_o_totalprice_1#2849, cdepval_orders_o_orderpriority#2826 AS cdepval_orders_o_orderpriority_1#2850, cdepval_orders_o_clerk#2827 AS cdepval_orders_o_clerk_1#2851, cdepval_orders_o_shippriority#2828 AS cdepval_orders_o_shippriority_1#2852, cdepval_orders_o_comment#2829 AS cdepval_orders_o_comment_1#2853, cdepval_orders_o_orderdate#2830 AS cdepval_orders_o_orderdate_1#2854, co_orderstatus#2831 AS co_orderstatus_1#2855, co_totalprice#2832 AS co_totalprice_1#2856, co_orderpriority#2833 AS co_orderpriority_1#2857, co_clerk#2834 AS co_clerk_1#2858, co_shippriority#2835 AS co_shippriority_1#2859, co_comment#2836 AS co_comment_1#2860, co_orderdate#2837 AS co_orderdate_1#2861]
            :  +- Relation[rid#2814,cpfk_customer_orders#2815,cfpk_orders_customer#2816,cval_orders_o_orderstatus#2817,cval_orders_o_totalprice#2818,cval_orders_o_orderpriority#2819,cval_orders_o_clerk#2820,cval_orders_o_shippriority#2821,cval_orders_o_comment#2822,cval_orders_o_orderdate#2823,cdepval_orders_o_orderstatus#2824,cdepval_orders_o_totalprice#2825,cdepval_orders_o_orderpriority#2826,cdepval_orders_o_clerk#2827,cdepval_orders_o_shippriority#2828,cdepval_orders_o_comment#2829,cdepval_orders_o_orderdate#2830,co_orderstatus#2831,co_totalprice#2832,co_orderpriority#2833,co_clerk#2834,co_shippriority#2835,co_comment#2836,co_orderdate#2837] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#2772 AS rid_0#2793, cpfk_nation_customer#2773 AS cpfk_nation_customer_0#2794, cfpk_customer_nation#2774 AS cfpk_customer_nation_0#2795, cval_customer_c_name#2775 AS cval_customer_c_name_0#2796, cval_customer_c_address#2776 AS cval_customer_c_address_0#2797, cval_customer_c_phone#2777 AS cval_customer_c_phone_0#2798, cval_customer_c_acctbal#2778 AS cval_customer_c_acctbal_0#2799, cval_customer_c_comment#2779 AS cval_customer_c_comment_0#2800, cval_customer_c_mktsegment#2780 AS cval_customer_c_mktsegment_0#2801, cdepval_customer_c_name#2781 AS cdepval_customer_c_name_0#2802, cdepval_customer_c_address#2782 AS cdepval_customer_c_address_0#2803, cdepval_customer_c_phone#2783 AS cdepval_customer_c_phone_0#2804, cdepval_customer_c_acctbal#2784 AS cdepval_customer_c_acctbal_0#2805, cdepval_customer_c_comment#2785 AS cdepval_customer_c_comment_0#2806, cdepval_customer_c_mktsegment#2786 AS cdepval_customer_c_mktsegment_0#2807, cc_name#2787 AS cc_name_0#2808, cc_address#2788 AS cc_address_0#2809, cc_phone#2789 AS cc_phone_0#2810, cc_acctbal#2790 AS cc_acctbal_0#2811, cc_comment#2791 AS cc_comment_0#2812, cc_mktsegment#2792 AS cc_mktsegment_0#2813]
               +- Relation[rid#2772,cpfk_nation_customer#2773,cfpk_customer_nation#2774,cval_customer_c_name#2775,cval_customer_c_address#2776,cval_customer_c_phone#2777,cval_customer_c_acctbal#2778,cval_customer_c_comment#2779,cval_customer_c_mktsegment#2780,cdepval_customer_c_name#2781,cdepval_customer_c_address#2782,cdepval_customer_c_phone#2783,cdepval_customer_c_acctbal#2784,cdepval_customer_c_comment#2785,cdepval_customer_c_mktsegment#2786,cc_name#2787,cc_address#2788,cc_phone#2789,cc_acctbal#2790,cc_comment#2791,cc_mktsegment#2792] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 22194ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/26 22:20:59 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:20:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3047L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 22:20:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3047L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#3049 AS rid_0#3073, cpfk_customer_orders#3050 AS cpfk_customer_orders_0#3074, cfpk_orders_customer#3051 AS cfpk_orders_customer_0#3075, cval_orders_o_orderstatus#3052 AS cval_orders_o_orderstatus_0#3076, cval_orders_o_totalprice#3053 AS cval_orders_o_totalprice_0#3077, cval_orders_o_orderpriority#3054 AS cval_orders_o_orderpriority_0#3078, cval_orders_o_clerk#3055 AS cval_orders_o_clerk_0#3079, cval_orders_o_shippriority#3056 AS cval_orders_o_shippriority_0#3080, cval_orders_o_comment#3057 AS cval_orders_o_comment_0#3081, cval_orders_o_orderdate#3058 AS cval_orders_o_orderdate_0#3082, cdepval_orders_o_orderstatus#3059 AS cdepval_orders_o_orderstatus_0#3083, cdepval_orders_o_totalprice#3060 AS cdepval_orders_o_totalprice_0#3084, cdepval_orders_o_orderpriority#3061 AS cdepval_orders_o_orderpriority_0#3085, cdepval_orders_o_clerk#3062 AS cdepval_orders_o_clerk_0#3086, cdepval_orders_o_shippriority#3063 AS cdepval_orders_o_shippriority_0#3087, cdepval_orders_o_comment#3064 AS cdepval_orders_o_comment_0#3088, cdepval_orders_o_orderdate#3065 AS cdepval_orders_o_orderdate_0#3089, co_orderstatus#3066 AS co_orderstatus_0#3090, co_totalprice#3067 AS co_totalprice_0#3091, co_orderpriority#3068 AS co_orderpriority_0#3092, co_clerk#3069 AS co_clerk_0#3093, co_shippriority#3070 AS co_shippriority_0#3094, co_comment#3071 AS co_comment_0#3095, co_orderdate#3072 AS co_orderdate_0#3096]
         :  +- Relation[rid#3049,cpfk_customer_orders#3050,cfpk_orders_customer#3051,cval_orders_o_orderstatus#3052,cval_orders_o_totalprice#3053,cval_orders_o_orderpriority#3054,cval_orders_o_clerk#3055,cval_orders_o_shippriority#3056,cval_orders_o_comment#3057,cval_orders_o_orderdate#3058,cdepval_orders_o_orderstatus#3059,cdepval_orders_o_totalprice#3060,cdepval_orders_o_orderpriority#3061,cdepval_orders_o_clerk#3062,cdepval_orders_o_shippriority#3063,cdepval_orders_o_comment#3064,cdepval_orders_o_orderdate#3065,co_orderstatus#3066,co_totalprice#3067,co_orderpriority#3068,co_clerk#3069,co_shippriority#3070,co_comment#3071,co_orderdate#3072] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#3097 AS rid_1#3118, cpfk_nation_customer#3098 AS cpfk_nation_customer_1#3119, cfpk_customer_nation#3099 AS cfpk_customer_nation_1#3120, cval_customer_c_name#3100 AS cval_customer_c_name_1#3121, cval_customer_c_address#3101 AS cval_customer_c_address_1#3122, cval_customer_c_phone#3102 AS cval_customer_c_phone_1#3123, cval_customer_c_acctbal#3103 AS cval_customer_c_acctbal_1#3124, cval_customer_c_comment#3104 AS cval_customer_c_comment_1#3125, cval_customer_c_mktsegment#3105 AS cval_customer_c_mktsegment_1#3126, cdepval_customer_c_name#3106 AS cdepval_customer_c_name_1#3127, cdepval_customer_c_address#3107 AS cdepval_customer_c_address_1#3128, cdepval_customer_c_phone#3108 AS cdepval_customer_c_phone_1#3129, cdepval_customer_c_acctbal#3109 AS cdepval_customer_c_acctbal_1#3130, cdepval_customer_c_comment#3110 AS cdepval_customer_c_comment_1#3131, cdepval_customer_c_mktsegment#3111 AS cdepval_customer_c_mktsegment_1#3132, cc_name#3112 AS cc_name_1#3133, cc_address#3113 AS cc_address_1#3134, cc_phone#3114 AS cc_phone_1#3135, cc_acctbal#3115 AS cc_acctbal_1#3136, cc_comment#3116 AS cc_comment_1#3137, cc_mktsegment#3117 AS cc_mktsegment_1#3138]
            +- Relation[rid#3097,cpfk_nation_customer#3098,cfpk_customer_nation#3099,cval_customer_c_name#3100,cval_customer_c_address#3101,cval_customer_c_phone#3102,cval_customer_c_acctbal#3103,cval_customer_c_comment#3104,cval_customer_c_mktsegment#3105,cdepval_customer_c_name#3106,cdepval_customer_c_address#3107,cdepval_customer_c_phone#3108,cdepval_customer_c_acctbal#3109,cdepval_customer_c_comment#3110,cdepval_customer_c_mktsegment#3111,cc_name#3112,cc_address#3113,cc_phone#3114,cc_acctbal#3115,cc_comment#3116,cc_mktsegment#3117] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4391ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/26 22:21:04 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:21:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3189L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 22:21:04 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:21:04 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:21:04 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:21:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:21:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:21:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:21:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:21:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:21:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:21:04 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:21:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:21:04 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:21:04 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:21:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3189L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#3216, cval_part_p_name_0#3217, cval_part_p_mfgr_0#3218, cval_part_p_type_0#3219, cval_part_p_size_0#3220, cval_part_p_container_0#3221, cval_part_p_retailprice_0#3222, cval_part_p_comment_0#3223, cval_part_p_brand_0#3224, cdepval_part_p_name_0#3225, cdepval_part_p_mfgr_0#3226, cdepval_part_p_type_0#3227, cdepval_part_p_size_0#3228, cdepval_part_p_container_0#3229, cdepval_part_p_retailprice_0#3230, cdepval_part_p_comment_0#3231, cdepval_part_p_brand_0#3232, cp_name_0#3233, cp_mfgr_0#3234, cp_type_0#3235, cp_size_0#3236, cp_container_0#3237, cp_retailprice_0#3238, cp_comment_0#3239, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  :  +- Project [rid#3191 AS rid_0#3216, cval_part_p_name#3192 AS cval_part_p_name_0#3217, cval_part_p_mfgr#3193 AS cval_part_p_mfgr_0#3218, cval_part_p_type#3194 AS cval_part_p_type_0#3219, cval_part_p_size#3195 AS cval_part_p_size_0#3220, cval_part_p_container#3196 AS cval_part_p_container_0#3221, cval_part_p_retailprice#3197 AS cval_part_p_retailprice_0#3222, cval_part_p_comment#3198 AS cval_part_p_comment_0#3223, cval_part_p_brand#3199 AS cval_part_p_brand_0#3224, cdepval_part_p_name#3200 AS cdepval_part_p_name_0#3225, cdepval_part_p_mfgr#3201 AS cdepval_part_p_mfgr_0#3226, cdepval_part_p_type#3202 AS cdepval_part_p_type_0#3227, cdepval_part_p_size#3203 AS cdepval_part_p_size_0#3228, cdepval_part_p_container#3204 AS cdepval_part_p_container_0#3229, cdepval_part_p_retailprice#3205 AS cdepval_part_p_retailprice_0#3230, cdepval_part_p_comment#3206 AS cdepval_part_p_comment_0#3231, cdepval_part_p_brand#3207 AS cdepval_part_p_brand_0#3232, cp_name#3208 AS cp_name_0#3233, cp_mfgr#3209 AS cp_mfgr_0#3234, cp_type#3210 AS cp_type_0#3235, cp_size#3211 AS cp_size_0#3236, cp_container#3212 AS cp_container_0#3237, cp_retailprice#3213 AS cp_retailprice_0#3238, cp_comment#3214 AS cp_comment_0#3239, cp_brand#3215 AS cp_brand_0#3240]
         :  :  :     +- Relation[rid#3191,cval_part_p_name#3192,cval_part_p_mfgr#3193,cval_part_p_type#3194,cval_part_p_size#3195,cval_part_p_container#3196,cval_part_p_retailprice#3197,cval_part_p_comment#3198,cval_part_p_brand#3199,cdepval_part_p_name#3200,cdepval_part_p_mfgr#3201,cdepval_part_p_type#3202,cdepval_part_p_size#3203,cdepval_part_p_container#3204,cdepval_part_p_retailprice#3205,cdepval_part_p_comment#3206,cdepval_part_p_brand#3207,cp_name#3208,cp_mfgr#3209,cp_type#3210,cp_size#3211,cp_container#3212,cp_retailprice#3213,cp_comment#3214,cp_brand#3215] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :  :     +- Project [rid#3369 AS rid_1#3383, cpfk_part_partsupp#3370 AS cpfk_part_partsupp_1#3384, cfpk_partsupp_part#3371 AS cfpk_partsupp_part_1#3385, cpfk_supplier_partsupp#3372 AS cpfk_supplier_partsupp_1#3386, cfpk_partsupp_supplier#3373 AS cfpk_partsupp_supplier_1#3387, cval_partsupp_ps_availqty#3374 AS cval_partsupp_ps_availqty_1#3388, cval_partsupp_ps_supplycost#3375 AS cval_partsupp_ps_supplycost_1#3389, cval_partsupp_ps_comment#3376 AS cval_partsupp_ps_comment_1#3390, cdepval_partsupp_ps_availqty#3377 AS cdepval_partsupp_ps_availqty_1#3391, cdepval_partsupp_ps_supplycost#3378 AS cdepval_partsupp_ps_supplycost_1#3392, cdepval_partsupp_ps_comment#3379 AS cdepval_partsupp_ps_comment_1#3393, cps_availqty#3380 AS cps_availqty_1#3394, cps_supplycost#3381 AS cps_supplycost_1#3395, cps_comment#3382 AS cps_comment_1#3396]
         :  :        +- Relation[rid#3369,cpfk_part_partsupp#3370,cfpk_partsupp_part#3371,cpfk_supplier_partsupp#3372,cfpk_partsupp_supplier#3373,cval_partsupp_ps_availqty#3374,cval_partsupp_ps_supplycost#3375,cval_partsupp_ps_comment#3376,cdepval_partsupp_ps_availqty#3377,cdepval_partsupp_ps_supplycost#3378,cdepval_partsupp_ps_comment#3379,cps_availqty#3380,cps_supplycost#3381,cps_comment#3382] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#3291 AS rid_1#3305, cpfk_part_partsupp#3292 AS cpfk_part_partsupp_1#3306, cfpk_partsupp_part#3293 AS cfpk_partsupp_part_1#3307, cpfk_supplier_partsupp#3294 AS cpfk_supplier_partsupp_1#3308, cfpk_partsupp_supplier#3295 AS cfpk_partsupp_supplier_1#3309, cval_partsupp_ps_availqty#3296 AS cval_partsupp_ps_availqty_1#3310, cval_partsupp_ps_supplycost#3297 AS cval_partsupp_ps_supplycost_1#3311, cval_partsupp_ps_comment#3298 AS cval_partsupp_ps_comment_1#3312, cdepval_partsupp_ps_availqty#3299 AS cdepval_partsupp_ps_availqty_1#3313, cdepval_partsupp_ps_supplycost#3300 AS cdepval_partsupp_ps_supplycost_1#3314, cdepval_partsupp_ps_comment#3301 AS cdepval_partsupp_ps_comment_1#3315, cps_availqty#3302 AS cps_availqty_1#3316, cps_supplycost#3303 AS cps_supplycost_1#3317, cps_comment#3304 AS cps_comment_1#3318]
         :     +- Relation[rid#3291,cpfk_part_partsupp#3292,cfpk_partsupp_part#3293,cpfk_supplier_partsupp#3294,cfpk_partsupp_supplier#3295,cval_partsupp_ps_availqty#3296,cval_partsupp_ps_supplycost#3297,cval_partsupp_ps_comment#3298,cdepval_partsupp_ps_availqty#3299,cdepval_partsupp_ps_supplycost#3300,cdepval_partsupp_ps_comment#3301,cps_availqty#3302,cps_supplycost#3303,cps_comment#3304] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_2, NotMaterialized, NotMaterialized, [rid_2#3406, cpfk_region_nation_2#3407, cfpk_nation_region_2#3408, cval_nation_n_name_2#3409, cval_nation_n_comment_2#3410, cdepval_nation_n_name_2#3411, cdepval_nation_n_comment_2#3412, cn_name_2#3413, cn_comment_2#3414, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
            :  :  +- Project [rid#3397 AS rid_2#3406, cpfk_region_nation#3398 AS cpfk_region_nation_2#3407, cfpk_nation_region#3399 AS cfpk_nation_region_2#3408, cval_nation_n_name#3400 AS cval_nation_n_name_2#3409, cval_nation_n_comment#3401 AS cval_nation_n_comment_2#3410, cdepval_nation_n_name#3402 AS cdepval_nation_n_name_2#3411, cdepval_nation_n_comment#3403 AS cdepval_nation_n_comment_2#3412, cn_name#3404 AS cn_name_2#3413, cn_comment#3405 AS cn_comment_2#3414]
            :  :     +- Relation[rid#3397,cpfk_region_nation#3398,cfpk_nation_region#3399,cval_nation_n_name#3400,cval_nation_n_comment#3401,cdepval_nation_n_name#3402,cdepval_nation_n_comment#3403,cn_name#3404,cn_comment#3405] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#3487 AS rid_3#3505, cpfk_nation_supplier#3488 AS cpfk_nation_supplier_3#3506, cfpk_supplier_nation#3489 AS cfpk_supplier_nation_3#3507, cval_supplier_s_name#3490 AS cval_supplier_s_name_3#3508, cval_supplier_s_address#3491 AS cval_supplier_s_address_3#3509, cval_supplier_s_phone#3492 AS cval_supplier_s_phone_3#3510, cval_supplier_s_acctbal#3493 AS cval_supplier_s_acctbal_3#3511, cval_supplier_s_comment#3494 AS cval_supplier_s_comment_3#3512, cdepval_supplier_s_name#3495 AS cdepval_supplier_s_name_3#3513, cdepval_supplier_s_address#3496 AS cdepval_supplier_s_address_3#3514, cdepval_supplier_s_phone#3497 AS cdepval_supplier_s_phone_3#3515, cdepval_supplier_s_acctbal#3498 AS cdepval_supplier_s_acctbal_3#3516, cdepval_supplier_s_comment#3499 AS cdepval_supplier_s_comment_3#3517, cs_name#3500 AS cs_name_3#3518, cs_address#3501 AS cs_address_3#3519, cs_phone#3502 AS cs_phone_3#3520, cs_acctbal#3503 AS cs_acctbal_3#3521, cs_comment#3504 AS cs_comment_3#3522]
            :        +- Relation[rid#3487,cpfk_nation_supplier#3488,cfpk_supplier_nation#3489,cval_supplier_s_name#3490,cval_supplier_s_address#3491,cval_supplier_s_phone#3492,cval_supplier_s_acctbal#3493,cval_supplier_s_comment#3494,cdepval_supplier_s_name#3495,cdepval_supplier_s_address#3496,cdepval_supplier_s_phone#3497,cdepval_supplier_s_acctbal#3498,cdepval_supplier_s_comment#3499,cs_name#3500,cs_address#3501,cs_phone#3502,cs_acctbal#3503,cs_comment#3504] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#3433 AS rid_3#3451, cpfk_nation_supplier#3434 AS cpfk_nation_supplier_3#3452, cfpk_supplier_nation#3435 AS cfpk_supplier_nation_3#3453, cval_supplier_s_name#3436 AS cval_supplier_s_name_3#3454, cval_supplier_s_address#3437 AS cval_supplier_s_address_3#3455, cval_supplier_s_phone#3438 AS cval_supplier_s_phone_3#3456, cval_supplier_s_acctbal#3439 AS cval_supplier_s_acctbal_3#3457, cval_supplier_s_comment#3440 AS cval_supplier_s_comment_3#3458, cdepval_supplier_s_name#3441 AS cdepval_supplier_s_name_3#3459, cdepval_supplier_s_address#3442 AS cdepval_supplier_s_address_3#3460, cdepval_supplier_s_phone#3443 AS cdepval_supplier_s_phone_3#3461, cdepval_supplier_s_acctbal#3444 AS cdepval_supplier_s_acctbal_3#3462, cdepval_supplier_s_comment#3445 AS cdepval_supplier_s_comment_3#3463, cs_name#3446 AS cs_name_3#3464, cs_address#3447 AS cs_address_3#3465, cs_phone#3448 AS cs_phone_3#3466, cs_acctbal#3449 AS cs_acctbal_3#3467, cs_comment#3450 AS cs_comment_3#3468]
               +- Relation[rid#3433,cpfk_nation_supplier#3434,cfpk_supplier_nation#3435,cval_supplier_s_name#3436,cval_supplier_s_address#3437,cval_supplier_s_phone#3438,cval_supplier_s_acctbal#3439,cval_supplier_s_comment#3440,cdepval_supplier_s_name#3441,cdepval_supplier_s_address#3442,cdepval_supplier_s_phone#3443,cdepval_supplier_s_acctbal#3444,cdepval_supplier_s_comment#3445,cs_name#3446,cs_address#3447,cs_phone#3448,cs_acctbal#3449,cs_comment#3450] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 932ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/26 22:21:05 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:21:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3617L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:21:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3617L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#3619 AS rid_0#3664, cpfk_orders_lineitem#3620 AS cpfk_orders_lineitem_0#3665, cpfk_supplier_lineitem#3621 AS cpfk_supplier_lineitem_0#3666, cfpk_lineitem_supplier#3622 AS cfpk_lineitem_supplier_0#3667, cfpk_lineitem_partsupp#3623 AS cfpk_lineitem_partsupp_0#3668, cpfk_part_lineitem#3624 AS cpfk_part_lineitem_0#3669, cfpk_lineitem_part#3625 AS cfpk_lineitem_part_0#3670, cpfk_partsupp_lineitem#3626 AS cpfk_partsupp_lineitem_0#3671, cfpk_lineitem_orders#3627 AS cfpk_lineitem_orders_0#3672, cval_lineitem_l_quantity#3628 AS cval_lineitem_l_quantity_0#3673, cval_lineitem_l_extendedprice#3629 AS cval_lineitem_l_extendedprice_0#3674, cval_lineitem_l_discount#3630 AS cval_lineitem_l_discount_0#3675, cval_lineitem_l_tax#3631 AS cval_lineitem_l_tax_0#3676, cval_lineitem_l_returnflag#3632 AS cval_lineitem_l_returnflag_0#3677, cval_lineitem_l_linestatus#3633 AS cval_lineitem_l_linestatus_0#3678, cval_lineitem_l_commitdate#3634 AS cval_lineitem_l_commitdate_0#3679, cval_lineitem_l_receiptdate#3635 AS cval_lineitem_l_receiptdate_0#3680, cval_lineitem_l_shipinstruct#3636 AS cval_lineitem_l_shipinstruct_0#3681, cval_lineitem_l_shipmode#3637 AS cval_lineitem_l_shipmode_0#3682, cval_lineitem_l_comment#3638 AS cval_lineitem_l_comment_0#3683, cval_lineitem_l_shipdate#3639 AS cval_lineitem_l_shipdate_0#3684, cdepval_lineitem_l_quantity#3640 AS cdepval_lineitem_l_quantity_0#3685, cdepval_lineitem_l_extendedprice#3641 AS cdepval_lineitem_l_extendedprice_0#3686, cdepval_lineitem_l_discount#3642 AS cdepval_lineitem_l_discount_0#3687, ... 21 more fields]
         :  +- Relation[rid#3619,cpfk_orders_lineitem#3620,cpfk_supplier_lineitem#3621,cfpk_lineitem_supplier#3622,cfpk_lineitem_partsupp#3623,cpfk_part_lineitem#3624,cfpk_lineitem_part#3625,cpfk_partsupp_lineitem#3626,cfpk_lineitem_orders#3627,cval_lineitem_l_quantity#3628,cval_lineitem_l_extendedprice#3629,cval_lineitem_l_discount#3630,cval_lineitem_l_tax#3631,cval_lineitem_l_returnflag#3632,cval_lineitem_l_linestatus#3633,cval_lineitem_l_commitdate#3634,cval_lineitem_l_receiptdate#3635,cval_lineitem_l_shipinstruct#3636,cval_lineitem_l_shipmode#3637,cval_lineitem_l_comment#3638,cval_lineitem_l_shipdate#3639,cdepval_lineitem_l_quantity#3640,cdepval_lineitem_l_extendedprice#3641,cdepval_lineitem_l_discount#3642,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#3709 AS rid_1#3733, cpfk_customer_orders#3710 AS cpfk_customer_orders_1#3734, cfpk_orders_customer#3711 AS cfpk_orders_customer_1#3735, cval_orders_o_orderstatus#3712 AS cval_orders_o_orderstatus_1#3736, cval_orders_o_totalprice#3713 AS cval_orders_o_totalprice_1#3737, cval_orders_o_orderpriority#3714 AS cval_orders_o_orderpriority_1#3738, cval_orders_o_clerk#3715 AS cval_orders_o_clerk_1#3739, cval_orders_o_shippriority#3716 AS cval_orders_o_shippriority_1#3740, cval_orders_o_comment#3717 AS cval_orders_o_comment_1#3741, cval_orders_o_orderdate#3718 AS cval_orders_o_orderdate_1#3742, cdepval_orders_o_orderstatus#3719 AS cdepval_orders_o_orderstatus_1#3743, cdepval_orders_o_totalprice#3720 AS cdepval_orders_o_totalprice_1#3744, cdepval_orders_o_orderpriority#3721 AS cdepval_orders_o_orderpriority_1#3745, cdepval_orders_o_clerk#3722 AS cdepval_orders_o_clerk_1#3746, cdepval_orders_o_shippriority#3723 AS cdepval_orders_o_shippriority_1#3747, cdepval_orders_o_comment#3724 AS cdepval_orders_o_comment_1#3748, cdepval_orders_o_orderdate#3725 AS cdepval_orders_o_orderdate_1#3749, co_orderstatus#3726 AS co_orderstatus_1#3750, co_totalprice#3727 AS co_totalprice_1#3751, co_orderpriority#3728 AS co_orderpriority_1#3752, co_clerk#3729 AS co_clerk_1#3753, co_shippriority#3730 AS co_shippriority_1#3754, co_comment#3731 AS co_comment_1#3755, co_orderdate#3732 AS co_orderdate_1#3756]
            +- Relation[rid#3709,cpfk_customer_orders#3710,cfpk_orders_customer#3711,cval_orders_o_orderstatus#3712,cval_orders_o_totalprice#3713,cval_orders_o_orderpriority#3714,cval_orders_o_clerk#3715,cval_orders_o_shippriority#3716,cval_orders_o_comment#3717,cval_orders_o_orderdate#3718,cdepval_orders_o_orderstatus#3719,cdepval_orders_o_totalprice#3720,cdepval_orders_o_orderpriority#3721,cdepval_orders_o_clerk#3722,cdepval_orders_o_shippriority#3723,cdepval_orders_o_comment#3724,cdepval_orders_o_orderdate#3725,co_orderstatus#3726,co_totalprice#3727,co_orderpriority#3728,co_clerk#3729,co_shippriority#3730,co_comment#3731,co_orderdate#3732] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18341ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/26 22:21:23 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:21:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3832L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:21:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3832L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#3884 AS rid_1#3929, cpfk_orders_lineitem#3885 AS cpfk_orders_lineitem_1#3930, cpfk_supplier_lineitem#3886 AS cpfk_supplier_lineitem_1#3931, cfpk_lineitem_supplier#3887 AS cfpk_lineitem_supplier_1#3932, cfpk_lineitem_partsupp#3888 AS cfpk_lineitem_partsupp_1#3933, cpfk_part_lineitem#3889 AS cpfk_part_lineitem_1#3934, cfpk_lineitem_part#3890 AS cfpk_lineitem_part_1#3935, cpfk_partsupp_lineitem#3891 AS cpfk_partsupp_lineitem_1#3936, cfpk_lineitem_orders#3892 AS cfpk_lineitem_orders_1#3937, cval_lineitem_l_quantity#3893 AS cval_lineitem_l_quantity_1#3938, cval_lineitem_l_extendedprice#3894 AS cval_lineitem_l_extendedprice_1#3939, cval_lineitem_l_discount#3895 AS cval_lineitem_l_discount_1#3940, cval_lineitem_l_tax#3896 AS cval_lineitem_l_tax_1#3941, cval_lineitem_l_returnflag#3897 AS cval_lineitem_l_returnflag_1#3942, cval_lineitem_l_linestatus#3898 AS cval_lineitem_l_linestatus_1#3943, cval_lineitem_l_commitdate#3899 AS cval_lineitem_l_commitdate_1#3944, cval_lineitem_l_receiptdate#3900 AS cval_lineitem_l_receiptdate_1#3945, cval_lineitem_l_shipinstruct#3901 AS cval_lineitem_l_shipinstruct_1#3946, cval_lineitem_l_shipmode#3902 AS cval_lineitem_l_shipmode_1#3947, cval_lineitem_l_comment#3903 AS cval_lineitem_l_comment_1#3948, cval_lineitem_l_shipdate#3904 AS cval_lineitem_l_shipdate_1#3949, cdepval_lineitem_l_quantity#3905 AS cdepval_lineitem_l_quantity_1#3950, cdepval_lineitem_l_extendedprice#3906 AS cdepval_lineitem_l_extendedprice_1#3951, cdepval_lineitem_l_discount#3907 AS cdepval_lineitem_l_discount_1#3952, ... 21 more fields]
         :  +- Relation[rid#3884,cpfk_orders_lineitem#3885,cpfk_supplier_lineitem#3886,cfpk_lineitem_supplier#3887,cfpk_lineitem_partsupp#3888,cpfk_part_lineitem#3889,cfpk_lineitem_part#3890,cpfk_partsupp_lineitem#3891,cfpk_lineitem_orders#3892,cval_lineitem_l_quantity#3893,cval_lineitem_l_extendedprice#3894,cval_lineitem_l_discount#3895,cval_lineitem_l_tax#3896,cval_lineitem_l_returnflag#3897,cval_lineitem_l_linestatus#3898,cval_lineitem_l_commitdate#3899,cval_lineitem_l_receiptdate#3900,cval_lineitem_l_shipinstruct#3901,cval_lineitem_l_shipmode#3902,cval_lineitem_l_comment#3903,cval_lineitem_l_shipdate#3904,cdepval_lineitem_l_quantity#3905,cdepval_lineitem_l_extendedprice#3906,cdepval_lineitem_l_discount#3907,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#3834 AS rid_0#3859, cval_part_p_name#3835 AS cval_part_p_name_0#3860, cval_part_p_mfgr#3836 AS cval_part_p_mfgr_0#3861, cval_part_p_type#3837 AS cval_part_p_type_0#3862, cval_part_p_size#3838 AS cval_part_p_size_0#3863, cval_part_p_container#3839 AS cval_part_p_container_0#3864, cval_part_p_retailprice#3840 AS cval_part_p_retailprice_0#3865, cval_part_p_comment#3841 AS cval_part_p_comment_0#3866, cval_part_p_brand#3842 AS cval_part_p_brand_0#3867, cdepval_part_p_name#3843 AS cdepval_part_p_name_0#3868, cdepval_part_p_mfgr#3844 AS cdepval_part_p_mfgr_0#3869, cdepval_part_p_type#3845 AS cdepval_part_p_type_0#3870, cdepval_part_p_size#3846 AS cdepval_part_p_size_0#3871, cdepval_part_p_container#3847 AS cdepval_part_p_container_0#3872, cdepval_part_p_retailprice#3848 AS cdepval_part_p_retailprice_0#3873, cdepval_part_p_comment#3849 AS cdepval_part_p_comment_0#3874, cdepval_part_p_brand#3850 AS cdepval_part_p_brand_0#3875, cp_name#3851 AS cp_name_0#3876, cp_mfgr#3852 AS cp_mfgr_0#3877, cp_type#3853 AS cp_type_0#3878, cp_size#3854 AS cp_size_0#3879, cp_container#3855 AS cp_container_0#3880, cp_retailprice#3856 AS cp_retailprice_0#3881, cp_comment#3857 AS cp_comment_0#3882, cp_brand#3858 AS cp_brand_0#3883]
            +- Relation[rid#3834,cval_part_p_name#3835,cval_part_p_mfgr#3836,cval_part_p_type#3837,cval_part_p_size#3838,cval_part_p_container#3839,cval_part_p_retailprice#3840,cval_part_p_comment#3841,cval_part_p_brand#3842,cdepval_part_p_name#3843,cdepval_part_p_mfgr#3844,cdepval_part_p_type#3845,cdepval_part_p_size#3846,cdepval_part_p_container#3847,cdepval_part_p_retailprice#3848,cdepval_part_p_comment#3849,cdepval_part_p_brand#3850,cp_name#3851,cp_mfgr#3852,cp_type#3853,cp_size#3854,cp_container#3855,cp_retailprice#3856,cp_comment#3857,cp_brand#3858] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17803ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/26 22:21:41 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:21:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4051L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 22:21:41 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:21:41 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:21:41 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:21:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4051L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#4078, cval_part_p_name_0#4079, cval_part_p_mfgr_0#4080, cval_part_p_type_0#4081, cval_part_p_size_0#4082, cval_part_p_container_0#4083, cval_part_p_retailprice_0#4084, cval_part_p_comment_0#4085, cval_part_p_brand_0#4086, cdepval_part_p_name_0#4087, cdepval_part_p_mfgr_0#4088, cdepval_part_p_type_0#4089, cdepval_part_p_size_0#4090, cdepval_part_p_container_0#4091, cdepval_part_p_retailprice_0#4092, cdepval_part_p_comment_0#4093, cdepval_part_p_brand_0#4094, cp_name_0#4095, cp_mfgr_0#4096, cp_type_0#4097, cp_size_0#4098, cp_container_0#4099, cp_retailprice_0#4100, cp_comment_0#4101, ... 2 more fields]
         :  :- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  +- Project [rid#4053 AS rid_0#4078, cval_part_p_name#4054 AS cval_part_p_name_0#4079, cval_part_p_mfgr#4055 AS cval_part_p_mfgr_0#4080, cval_part_p_type#4056 AS cval_part_p_type_0#4081, cval_part_p_size#4057 AS cval_part_p_size_0#4082, cval_part_p_container#4058 AS cval_part_p_container_0#4083, cval_part_p_retailprice#4059 AS cval_part_p_retailprice_0#4084, cval_part_p_comment#4060 AS cval_part_p_comment_0#4085, cval_part_p_brand#4061 AS cval_part_p_brand_0#4086, cdepval_part_p_name#4062 AS cdepval_part_p_name_0#4087, cdepval_part_p_mfgr#4063 AS cdepval_part_p_mfgr_0#4088, cdepval_part_p_type#4064 AS cdepval_part_p_type_0#4089, cdepval_part_p_size#4065 AS cdepval_part_p_size_0#4090, cdepval_part_p_container#4066 AS cdepval_part_p_container_0#4091, cdepval_part_p_retailprice#4067 AS cdepval_part_p_retailprice_0#4092, cdepval_part_p_comment#4068 AS cdepval_part_p_comment_0#4093, cdepval_part_p_brand#4069 AS cdepval_part_p_brand_0#4094, cp_name#4070 AS cp_name_0#4095, cp_mfgr#4071 AS cp_mfgr_0#4096, cp_type#4072 AS cp_type_0#4097, cp_size#4073 AS cp_size_0#4098, cp_container#4074 AS cp_container_0#4099, cp_retailprice#4075 AS cp_retailprice_0#4100, cp_comment#4076 AS cp_comment_0#4101, cp_brand#4077 AS cp_brand_0#4102]
         :  :     +- Relation[rid#4053,cval_part_p_name#4054,cval_part_p_mfgr#4055,cval_part_p_type#4056,cval_part_p_size#4057,cval_part_p_container#4058,cval_part_p_retailprice#4059,cval_part_p_comment#4060,cval_part_p_brand#4061,cdepval_part_p_name#4062,cdepval_part_p_mfgr#4063,cdepval_part_p_type#4064,cdepval_part_p_size#4065,cdepval_part_p_container#4066,cdepval_part_p_retailprice#4067,cdepval_part_p_comment#4068,cdepval_part_p_brand#4069,cp_name#4070,cp_mfgr#4071,cp_type#4072,cp_size#4073,cp_container#4074,cp_retailprice#4075,cp_comment#4076,cp_brand#4077] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :     +- Project [rid#4231 AS rid_1#4245, cpfk_part_partsupp#4232 AS cpfk_part_partsupp_1#4246, cfpk_partsupp_part#4233 AS cfpk_partsupp_part_1#4247, cpfk_supplier_partsupp#4234 AS cpfk_supplier_partsupp_1#4248, cfpk_partsupp_supplier#4235 AS cfpk_partsupp_supplier_1#4249, cval_partsupp_ps_availqty#4236 AS cval_partsupp_ps_availqty_1#4250, cval_partsupp_ps_supplycost#4237 AS cval_partsupp_ps_supplycost_1#4251, cval_partsupp_ps_comment#4238 AS cval_partsupp_ps_comment_1#4252, cdepval_partsupp_ps_availqty#4239 AS cdepval_partsupp_ps_availqty_1#4253, cdepval_partsupp_ps_supplycost#4240 AS cdepval_partsupp_ps_supplycost_1#4254, cdepval_partsupp_ps_comment#4241 AS cdepval_partsupp_ps_comment_1#4255, cps_availqty#4242 AS cps_availqty_1#4256, cps_supplycost#4243 AS cps_supplycost_1#4257, cps_comment#4244 AS cps_comment_1#4258]
         :        +- Relation[rid#4231,cpfk_part_partsupp#4232,cfpk_partsupp_part#4233,cpfk_supplier_partsupp#4234,cfpk_partsupp_supplier#4235,cval_partsupp_ps_availqty#4236,cval_partsupp_ps_supplycost#4237,cval_partsupp_ps_comment#4238,cdepval_partsupp_ps_availqty#4239,cdepval_partsupp_ps_supplycost#4240,cdepval_partsupp_ps_comment#4241,cps_availqty#4242,cps_supplycost#4243,cps_comment#4244] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#4153 AS rid_1#4167, cpfk_part_partsupp#4154 AS cpfk_part_partsupp_1#4168, cfpk_partsupp_part#4155 AS cfpk_partsupp_part_1#4169, cpfk_supplier_partsupp#4156 AS cpfk_supplier_partsupp_1#4170, cfpk_partsupp_supplier#4157 AS cfpk_partsupp_supplier_1#4171, cval_partsupp_ps_availqty#4158 AS cval_partsupp_ps_availqty_1#4172, cval_partsupp_ps_supplycost#4159 AS cval_partsupp_ps_supplycost_1#4173, cval_partsupp_ps_comment#4160 AS cval_partsupp_ps_comment_1#4174, cdepval_partsupp_ps_availqty#4161 AS cdepval_partsupp_ps_availqty_1#4175, cdepval_partsupp_ps_supplycost#4162 AS cdepval_partsupp_ps_supplycost_1#4176, cdepval_partsupp_ps_comment#4163 AS cdepval_partsupp_ps_comment_1#4177, cps_availqty#4164 AS cps_availqty_1#4178, cps_supplycost#4165 AS cps_supplycost_1#4179, cps_comment#4166 AS cps_comment_1#4180]
            +- Relation[rid#4153,cpfk_part_partsupp#4154,cfpk_partsupp_part#4155,cpfk_supplier_partsupp#4156,cfpk_partsupp_supplier#4157,cval_partsupp_ps_availqty#4158,cval_partsupp_ps_supplycost#4159,cval_partsupp_ps_comment#4160,cdepval_partsupp_ps_availqty#4161,cdepval_partsupp_ps_supplycost#4162,cdepval_partsupp_ps_comment#4163,cps_availqty#4164,cps_supplycost#4165,cps_comment#4166] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 575ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/26 22:21:41 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:21:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4303L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:21:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:21:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:21:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:21:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:21:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:21:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:21:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:21:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4303L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#4330, cval_part_p_name_0#4331, cval_part_p_mfgr_0#4332, cval_part_p_type_0#4333, cval_part_p_size_0#4334, cval_part_p_container_0#4335, cval_part_p_retailprice_0#4336, cval_part_p_comment_0#4337, cval_part_p_brand_0#4338, cdepval_part_p_name_0#4339, cdepval_part_p_mfgr_0#4340, cdepval_part_p_type_0#4341, cdepval_part_p_size_0#4342, cdepval_part_p_container_0#4343, cdepval_part_p_retailprice_0#4344, cdepval_part_p_comment_0#4345, cdepval_part_p_brand_0#4346, cp_name_0#4347, cp_mfgr_0#4348, cp_type_0#4349, cp_size_0#4350, cp_container_0#4351, cp_retailprice_0#4352, cp_comment_0#4353, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#4305 AS rid_0#4330, cval_part_p_name#4306 AS cval_part_p_name_0#4331, cval_part_p_mfgr#4307 AS cval_part_p_mfgr_0#4332, cval_part_p_type#4308 AS cval_part_p_type_0#4333, cval_part_p_size#4309 AS cval_part_p_size_0#4334, cval_part_p_container#4310 AS cval_part_p_container_0#4335, cval_part_p_retailprice#4311 AS cval_part_p_retailprice_0#4336, cval_part_p_comment#4312 AS cval_part_p_comment_0#4337, cval_part_p_brand#4313 AS cval_part_p_brand_0#4338, cdepval_part_p_name#4314 AS cdepval_part_p_name_0#4339, cdepval_part_p_mfgr#4315 AS cdepval_part_p_mfgr_0#4340, cdepval_part_p_type#4316 AS cdepval_part_p_type_0#4341, cdepval_part_p_size#4317 AS cdepval_part_p_size_0#4342, cdepval_part_p_container#4318 AS cdepval_part_p_container_0#4343, cdepval_part_p_retailprice#4319 AS cdepval_part_p_retailprice_0#4344, cdepval_part_p_comment#4320 AS cdepval_part_p_comment_0#4345, cdepval_part_p_brand#4321 AS cdepval_part_p_brand_0#4346, cp_name#4322 AS cp_name_0#4347, cp_mfgr#4323 AS cp_mfgr_0#4348, cp_type#4324 AS cp_type_0#4349, cp_size#4325 AS cp_size_0#4350, cp_container#4326 AS cp_container_0#4351, cp_retailprice#4327 AS cp_retailprice_0#4352, cp_comment#4328 AS cp_comment_0#4353, cp_brand#4329 AS cp_brand_0#4354]
         :  :        +- Relation[rid#4305,cval_part_p_name#4306,cval_part_p_mfgr#4307,cval_part_p_type#4308,cval_part_p_size#4309,cval_part_p_container#4310,cval_part_p_retailprice#4311,cval_part_p_comment#4312,cval_part_p_brand#4313,cdepval_part_p_name#4314,cdepval_part_p_mfgr#4315,cdepval_part_p_type#4316,cdepval_part_p_size#4317,cdepval_part_p_container#4318,cdepval_part_p_retailprice#4319,cdepval_part_p_comment#4320,cdepval_part_p_brand#4321,cp_name#4322,cp_mfgr#4323,cp_type#4324,cp_size#4325,cp_container#4326,cp_retailprice#4327,cp_comment#4328,cp_brand#4329] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#4775 AS rid_1#4820, cpfk_orders_lineitem#4776 AS cpfk_orders_lineitem_1#4821, cpfk_supplier_lineitem#4777 AS cpfk_supplier_lineitem_1#4822, cfpk_lineitem_supplier#4778 AS cfpk_lineitem_supplier_1#4823, cfpk_lineitem_partsupp#4779 AS cfpk_lineitem_partsupp_1#4824, cpfk_part_lineitem#4780 AS cpfk_part_lineitem_1#4825, cfpk_lineitem_part#4781 AS cfpk_lineitem_part_1#4826, cpfk_partsupp_lineitem#4782 AS cpfk_partsupp_lineitem_1#4827, cfpk_lineitem_orders#4783 AS cfpk_lineitem_orders_1#4828, cval_lineitem_l_quantity#4784 AS cval_lineitem_l_quantity_1#4829, cval_lineitem_l_extendedprice#4785 AS cval_lineitem_l_extendedprice_1#4830, cval_lineitem_l_discount#4786 AS cval_lineitem_l_discount_1#4831, cval_lineitem_l_tax#4787 AS cval_lineitem_l_tax_1#4832, cval_lineitem_l_returnflag#4788 AS cval_lineitem_l_returnflag_1#4833, cval_lineitem_l_linestatus#4789 AS cval_lineitem_l_linestatus_1#4834, cval_lineitem_l_commitdate#4790 AS cval_lineitem_l_commitdate_1#4835, cval_lineitem_l_receiptdate#4791 AS cval_lineitem_l_receiptdate_1#4836, cval_lineitem_l_shipinstruct#4792 AS cval_lineitem_l_shipinstruct_1#4837, cval_lineitem_l_shipmode#4793 AS cval_lineitem_l_shipmode_1#4838, cval_lineitem_l_comment#4794 AS cval_lineitem_l_comment_1#4839, cval_lineitem_l_shipdate#4795 AS cval_lineitem_l_shipdate_1#4840, cdepval_lineitem_l_quantity#4796 AS cdepval_lineitem_l_quantity_1#4841, cdepval_lineitem_l_extendedprice#4797 AS cdepval_lineitem_l_extendedprice_1#4842, cdepval_lineitem_l_discount#4798 AS cdepval_lineitem_l_discount_1#4843, ... 21 more fields]
         :        +- Relation[rid#4775,cpfk_orders_lineitem#4776,cpfk_supplier_lineitem#4777,cfpk_lineitem_supplier#4778,cfpk_lineitem_partsupp#4779,cpfk_part_lineitem#4780,cfpk_lineitem_part#4781,cpfk_partsupp_lineitem#4782,cfpk_lineitem_orders#4783,cval_lineitem_l_quantity#4784,cval_lineitem_l_extendedprice#4785,cval_lineitem_l_discount#4786,cval_lineitem_l_tax#4787,cval_lineitem_l_returnflag#4788,cval_lineitem_l_linestatus#4789,cval_lineitem_l_commitdate#4790,cval_lineitem_l_receiptdate#4791,cval_lineitem_l_shipinstruct#4792,cval_lineitem_l_shipmode#4793,cval_lineitem_l_comment#4794,cval_lineitem_l_shipdate#4795,cdepval_lineitem_l_quantity#4796,cdepval_lineitem_l_extendedprice#4797,cdepval_lineitem_l_discount#4798,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#4455 AS rid_1#4500, cpfk_orders_lineitem#4456 AS cpfk_orders_lineitem_1#4501, cpfk_supplier_lineitem#4457 AS cpfk_supplier_lineitem_1#4502, cfpk_lineitem_supplier#4458 AS cfpk_lineitem_supplier_1#4503, cfpk_lineitem_partsupp#4459 AS cfpk_lineitem_partsupp_1#4504, cpfk_part_lineitem#4460 AS cpfk_part_lineitem_1#4505, cfpk_lineitem_part#4461 AS cfpk_lineitem_part_1#4506, cpfk_partsupp_lineitem#4462 AS cpfk_partsupp_lineitem_1#4507, cfpk_lineitem_orders#4463 AS cfpk_lineitem_orders_1#4508, cval_lineitem_l_quantity#4464 AS cval_lineitem_l_quantity_1#4509, cval_lineitem_l_extendedprice#4465 AS cval_lineitem_l_extendedprice_1#4510, cval_lineitem_l_discount#4466 AS cval_lineitem_l_discount_1#4511, cval_lineitem_l_tax#4467 AS cval_lineitem_l_tax_1#4512, cval_lineitem_l_returnflag#4468 AS cval_lineitem_l_returnflag_1#4513, cval_lineitem_l_linestatus#4469 AS cval_lineitem_l_linestatus_1#4514, cval_lineitem_l_commitdate#4470 AS cval_lineitem_l_commitdate_1#4515, cval_lineitem_l_receiptdate#4471 AS cval_lineitem_l_receiptdate_1#4516, cval_lineitem_l_shipinstruct#4472 AS cval_lineitem_l_shipinstruct_1#4517, cval_lineitem_l_shipmode#4473 AS cval_lineitem_l_shipmode_1#4518, cval_lineitem_l_comment#4474 AS cval_lineitem_l_comment_1#4519, cval_lineitem_l_shipdate#4475 AS cval_lineitem_l_shipdate_1#4520, cdepval_lineitem_l_quantity#4476 AS cdepval_lineitem_l_quantity_1#4521, cdepval_lineitem_l_extendedprice#4477 AS cdepval_lineitem_l_extendedprice_1#4522, cdepval_lineitem_l_discount#4478 AS cdepval_lineitem_l_discount_1#4523, ... 21 more fields]
                  +- Relation[rid#4455,cpfk_orders_lineitem#4456,cpfk_supplier_lineitem#4457,cfpk_lineitem_supplier#4458,cfpk_lineitem_partsupp#4459,cpfk_part_lineitem#4460,cfpk_lineitem_part#4461,cpfk_partsupp_lineitem#4462,cfpk_lineitem_orders#4463,cval_lineitem_l_quantity#4464,cval_lineitem_l_extendedprice#4465,cval_lineitem_l_discount#4466,cval_lineitem_l_tax#4467,cval_lineitem_l_returnflag#4468,cval_lineitem_l_linestatus#4469,cval_lineitem_l_commitdate#4470,cval_lineitem_l_receiptdate#4471,cval_lineitem_l_shipinstruct#4472,cval_lineitem_l_shipmode#4473,cval_lineitem_l_comment#4474,cval_lineitem_l_shipdate#4475,cdepval_lineitem_l_quantity#4476,cdepval_lineitem_l_extendedprice#4477,cdepval_lineitem_l_discount#4478,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 16869ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/26 22:21:58 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:21:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4939L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:21:58 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:21:58 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:21:58 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:21:58 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:21:58 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:21:58 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:21:58 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:21:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4939L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#4966, cval_part_p_name_0#4967, cval_part_p_mfgr_0#4968, cval_part_p_type_0#4969, cval_part_p_size_0#4970, cval_part_p_container_0#4971, cval_part_p_retailprice_0#4972, cval_part_p_comment_0#4973, cval_part_p_brand_0#4974, cdepval_part_p_name_0#4975, cdepval_part_p_mfgr_0#4976, cdepval_part_p_type_0#4977, cdepval_part_p_size_0#4978, cdepval_part_p_container_0#4979, cdepval_part_p_retailprice_0#4980, cdepval_part_p_comment_0#4981, cdepval_part_p_brand_0#4982, cp_name_0#4983, cp_mfgr_0#4984, cp_type_0#4985, cp_size_0#4986, cp_container_0#4987, cp_retailprice_0#4988, cp_comment_0#4989, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#4941 AS rid_0#4966, cval_part_p_name#4942 AS cval_part_p_name_0#4967, cval_part_p_mfgr#4943 AS cval_part_p_mfgr_0#4968, cval_part_p_type#4944 AS cval_part_p_type_0#4969, cval_part_p_size#4945 AS cval_part_p_size_0#4970, cval_part_p_container#4946 AS cval_part_p_container_0#4971, cval_part_p_retailprice#4947 AS cval_part_p_retailprice_0#4972, cval_part_p_comment#4948 AS cval_part_p_comment_0#4973, cval_part_p_brand#4949 AS cval_part_p_brand_0#4974, cdepval_part_p_name#4950 AS cdepval_part_p_name_0#4975, cdepval_part_p_mfgr#4951 AS cdepval_part_p_mfgr_0#4976, cdepval_part_p_type#4952 AS cdepval_part_p_type_0#4977, cdepval_part_p_size#4953 AS cdepval_part_p_size_0#4978, cdepval_part_p_container#4954 AS cdepval_part_p_container_0#4979, cdepval_part_p_retailprice#4955 AS cdepval_part_p_retailprice_0#4980, cdepval_part_p_comment#4956 AS cdepval_part_p_comment_0#4981, cdepval_part_p_brand#4957 AS cdepval_part_p_brand_0#4982, cp_name#4958 AS cp_name_0#4983, cp_mfgr#4959 AS cp_mfgr_0#4984, cp_type#4960 AS cp_type_0#4985, cp_size#4961 AS cp_size_0#4986, cp_container#4962 AS cp_container_0#4987, cp_retailprice#4963 AS cp_retailprice_0#4988, cp_comment#4964 AS cp_comment_0#4989, cp_brand#4965 AS cp_brand_0#4990]
         :  :        +- Relation[rid#4941,cval_part_p_name#4942,cval_part_p_mfgr#4943,cval_part_p_type#4944,cval_part_p_size#4945,cval_part_p_container#4946,cval_part_p_retailprice#4947,cval_part_p_comment#4948,cval_part_p_brand#4949,cdepval_part_p_name#4950,cdepval_part_p_mfgr#4951,cdepval_part_p_type#4952,cdepval_part_p_size#4953,cdepval_part_p_container#4954,cdepval_part_p_retailprice#4955,cdepval_part_p_comment#4956,cdepval_part_p_brand#4957,cp_name#4958,cp_mfgr#4959,cp_type#4960,cp_size#4961,cp_container#4962,cp_retailprice#4963,cp_comment#4964,cp_brand#4965] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#5231 AS rid_1#5276, cpfk_orders_lineitem#5232 AS cpfk_orders_lineitem_1#5277, cpfk_supplier_lineitem#5233 AS cpfk_supplier_lineitem_1#5278, cfpk_lineitem_supplier#5234 AS cfpk_lineitem_supplier_1#5279, cfpk_lineitem_partsupp#5235 AS cfpk_lineitem_partsupp_1#5280, cpfk_part_lineitem#5236 AS cpfk_part_lineitem_1#5281, cfpk_lineitem_part#5237 AS cfpk_lineitem_part_1#5282, cpfk_partsupp_lineitem#5238 AS cpfk_partsupp_lineitem_1#5283, cfpk_lineitem_orders#5239 AS cfpk_lineitem_orders_1#5284, cval_lineitem_l_quantity#5240 AS cval_lineitem_l_quantity_1#5285, cval_lineitem_l_extendedprice#5241 AS cval_lineitem_l_extendedprice_1#5286, cval_lineitem_l_discount#5242 AS cval_lineitem_l_discount_1#5287, cval_lineitem_l_tax#5243 AS cval_lineitem_l_tax_1#5288, cval_lineitem_l_returnflag#5244 AS cval_lineitem_l_returnflag_1#5289, cval_lineitem_l_linestatus#5245 AS cval_lineitem_l_linestatus_1#5290, cval_lineitem_l_commitdate#5246 AS cval_lineitem_l_commitdate_1#5291, cval_lineitem_l_receiptdate#5247 AS cval_lineitem_l_receiptdate_1#5292, cval_lineitem_l_shipinstruct#5248 AS cval_lineitem_l_shipinstruct_1#5293, cval_lineitem_l_shipmode#5249 AS cval_lineitem_l_shipmode_1#5294, cval_lineitem_l_comment#5250 AS cval_lineitem_l_comment_1#5295, cval_lineitem_l_shipdate#5251 AS cval_lineitem_l_shipdate_1#5296, cdepval_lineitem_l_quantity#5252 AS cdepval_lineitem_l_quantity_1#5297, cdepval_lineitem_l_extendedprice#5253 AS cdepval_lineitem_l_extendedprice_1#5298, cdepval_lineitem_l_discount#5254 AS cdepval_lineitem_l_discount_1#5299, ... 21 more fields]
         :        +- Relation[rid#5231,cpfk_orders_lineitem#5232,cpfk_supplier_lineitem#5233,cfpk_lineitem_supplier#5234,cfpk_lineitem_partsupp#5235,cpfk_part_lineitem#5236,cfpk_lineitem_part#5237,cpfk_partsupp_lineitem#5238,cfpk_lineitem_orders#5239,cval_lineitem_l_quantity#5240,cval_lineitem_l_extendedprice#5241,cval_lineitem_l_discount#5242,cval_lineitem_l_tax#5243,cval_lineitem_l_returnflag#5244,cval_lineitem_l_linestatus#5245,cval_lineitem_l_commitdate#5246,cval_lineitem_l_receiptdate#5247,cval_lineitem_l_shipinstruct#5248,cval_lineitem_l_shipmode#5249,cval_lineitem_l_comment#5250,cval_lineitem_l_shipdate#5251,cdepval_lineitem_l_quantity#5252,cdepval_lineitem_l_extendedprice#5253,cdepval_lineitem_l_discount#5254,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5091 AS rid_1#5136, cpfk_orders_lineitem#5092 AS cpfk_orders_lineitem_1#5137, cpfk_supplier_lineitem#5093 AS cpfk_supplier_lineitem_1#5138, cfpk_lineitem_supplier#5094 AS cfpk_lineitem_supplier_1#5139, cfpk_lineitem_partsupp#5095 AS cfpk_lineitem_partsupp_1#5140, cpfk_part_lineitem#5096 AS cpfk_part_lineitem_1#5141, cfpk_lineitem_part#5097 AS cfpk_lineitem_part_1#5142, cpfk_partsupp_lineitem#5098 AS cpfk_partsupp_lineitem_1#5143, cfpk_lineitem_orders#5099 AS cfpk_lineitem_orders_1#5144, cval_lineitem_l_quantity#5100 AS cval_lineitem_l_quantity_1#5145, cval_lineitem_l_extendedprice#5101 AS cval_lineitem_l_extendedprice_1#5146, cval_lineitem_l_discount#5102 AS cval_lineitem_l_discount_1#5147, cval_lineitem_l_tax#5103 AS cval_lineitem_l_tax_1#5148, cval_lineitem_l_returnflag#5104 AS cval_lineitem_l_returnflag_1#5149, cval_lineitem_l_linestatus#5105 AS cval_lineitem_l_linestatus_1#5150, cval_lineitem_l_commitdate#5106 AS cval_lineitem_l_commitdate_1#5151, cval_lineitem_l_receiptdate#5107 AS cval_lineitem_l_receiptdate_1#5152, cval_lineitem_l_shipinstruct#5108 AS cval_lineitem_l_shipinstruct_1#5153, cval_lineitem_l_shipmode#5109 AS cval_lineitem_l_shipmode_1#5154, cval_lineitem_l_comment#5110 AS cval_lineitem_l_comment_1#5155, cval_lineitem_l_shipdate#5111 AS cval_lineitem_l_shipdate_1#5156, cdepval_lineitem_l_quantity#5112 AS cdepval_lineitem_l_quantity_1#5157, cdepval_lineitem_l_extendedprice#5113 AS cdepval_lineitem_l_extendedprice_1#5158, cdepval_lineitem_l_discount#5114 AS cdepval_lineitem_l_discount_1#5159, ... 21 more fields]
            +- Relation[rid#5091,cpfk_orders_lineitem#5092,cpfk_supplier_lineitem#5093,cfpk_lineitem_supplier#5094,cfpk_lineitem_partsupp#5095,cpfk_part_lineitem#5096,cfpk_lineitem_part#5097,cpfk_partsupp_lineitem#5098,cfpk_lineitem_orders#5099,cval_lineitem_l_quantity#5100,cval_lineitem_l_extendedprice#5101,cval_lineitem_l_discount#5102,cval_lineitem_l_tax#5103,cval_lineitem_l_returnflag#5104,cval_lineitem_l_linestatus#5105,cval_lineitem_l_commitdate#5106,cval_lineitem_l_receiptdate#5107,cval_lineitem_l_shipinstruct#5108,cval_lineitem_l_shipmode#5109,cval_lineitem_l_comment#5110,cval_lineitem_l_shipdate#5111,cdepval_lineitem_l_quantity#5112,cdepval_lineitem_l_extendedprice#5113,cdepval_lineitem_l_discount#5114,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 504ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/26 22:21:59 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:21:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5395L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 22:21:59 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:21:59 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:21:59 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:21:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:21:59 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:21:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:21:59 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:21:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:21:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:21:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:21:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:21:59 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:21:59 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:21:59 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:21:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:21:59 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:21:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5395L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#5536, cval_part_p_name_3#5537, cval_part_p_mfgr_3#5538, cval_part_p_type_3#5539, cval_part_p_size_3#5540, cval_part_p_container_3#5541, cval_part_p_retailprice_3#5542, cval_part_p_comment_3#5543, cval_part_p_brand_3#5544, cdepval_part_p_name_3#5545, cdepval_part_p_mfgr_3#5546, cdepval_part_p_type_3#5547, cdepval_part_p_size_3#5548, cdepval_part_p_container_3#5549, cdepval_part_p_retailprice_3#5550, cdepval_part_p_comment_3#5551, cdepval_part_p_brand_3#5552, cp_name_3#5553, cp_mfgr_3#5554, cp_type_3#5555, cp_size_3#5556, cp_container_3#5557, cp_retailprice_3#5558, cp_comment_3#5559, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :  :  :  +- Project [rid#5511 AS rid_3#5536, cval_part_p_name#5512 AS cval_part_p_name_3#5537, cval_part_p_mfgr#5513 AS cval_part_p_mfgr_3#5538, cval_part_p_type#5514 AS cval_part_p_type_3#5539, cval_part_p_size#5515 AS cval_part_p_size_3#5540, cval_part_p_container#5516 AS cval_part_p_container_3#5541, cval_part_p_retailprice#5517 AS cval_part_p_retailprice_3#5542, cval_part_p_comment#5518 AS cval_part_p_comment_3#5543, cval_part_p_brand#5519 AS cval_part_p_brand_3#5544, cdepval_part_p_name#5520 AS cdepval_part_p_name_3#5545, cdepval_part_p_mfgr#5521 AS cdepval_part_p_mfgr_3#5546, cdepval_part_p_type#5522 AS cdepval_part_p_type_3#5547, cdepval_part_p_size#5523 AS cdepval_part_p_size_3#5548, cdepval_part_p_container#5524 AS cdepval_part_p_container_3#5549, cdepval_part_p_retailprice#5525 AS cdepval_part_p_retailprice_3#5550, cdepval_part_p_comment#5526 AS cdepval_part_p_comment_3#5551, cdepval_part_p_brand#5527 AS cdepval_part_p_brand_3#5552, cp_name#5528 AS cp_name_3#5553, cp_mfgr#5529 AS cp_mfgr_3#5554, cp_type#5530 AS cp_type_3#5555, cp_size#5531 AS cp_size_3#5556, cp_container#5532 AS cp_container_3#5557, cp_retailprice#5533 AS cp_retailprice_3#5558, cp_comment#5534 AS cp_comment_3#5559, cp_brand#5535 AS cp_brand_3#5560]
         :  :  :     +- Relation[rid#5511,cval_part_p_name#5512,cval_part_p_mfgr#5513,cval_part_p_type#5514,cval_part_p_size#5515,cval_part_p_container#5516,cval_part_p_retailprice#5517,cval_part_p_comment#5518,cval_part_p_brand#5519,cdepval_part_p_name#5520,cdepval_part_p_mfgr#5521,cdepval_part_p_type#5522,cdepval_part_p_size#5523,cdepval_part_p_container#5524,cdepval_part_p_retailprice#5525,cdepval_part_p_comment#5526,cdepval_part_p_brand#5527,cp_name#5528,cp_mfgr#5529,cp_type#5530,cp_size#5531,cp_container#5532,cp_retailprice#5533,cp_comment#5534,cp_brand#5535] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_4, 'rid_4]
         :  :     +- Project [rid#5689 AS rid_4#5703, cpfk_part_partsupp#5690 AS cpfk_part_partsupp_4#5704, cfpk_partsupp_part#5691 AS cfpk_partsupp_part_4#5705, cpfk_supplier_partsupp#5692 AS cpfk_supplier_partsupp_4#5706, cfpk_partsupp_supplier#5693 AS cfpk_partsupp_supplier_4#5707, cval_partsupp_ps_availqty#5694 AS cval_partsupp_ps_availqty_4#5708, cval_partsupp_ps_supplycost#5695 AS cval_partsupp_ps_supplycost_4#5709, cval_partsupp_ps_comment#5696 AS cval_partsupp_ps_comment_4#5710, cdepval_partsupp_ps_availqty#5697 AS cdepval_partsupp_ps_availqty_4#5711, cdepval_partsupp_ps_supplycost#5698 AS cdepval_partsupp_ps_supplycost_4#5712, cdepval_partsupp_ps_comment#5699 AS cdepval_partsupp_ps_comment_4#5713, cps_availqty#5700 AS cps_availqty_4#5714, cps_supplycost#5701 AS cps_supplycost_4#5715, cps_comment#5702 AS cps_comment_4#5716]
         :  :        +- Relation[rid#5689,cpfk_part_partsupp#5690,cfpk_partsupp_part#5691,cpfk_supplier_partsupp#5692,cfpk_partsupp_supplier#5693,cval_partsupp_ps_availqty#5694,cval_partsupp_ps_supplycost#5695,cval_partsupp_ps_comment#5696,cdepval_partsupp_ps_availqty#5697,cdepval_partsupp_ps_supplycost#5698,cdepval_partsupp_ps_comment#5699,cps_availqty#5700,cps_supplycost#5701,cps_comment#5702] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#5611 AS rid_4#5625, cpfk_part_partsupp#5612 AS cpfk_part_partsupp_4#5626, cfpk_partsupp_part#5613 AS cfpk_partsupp_part_4#5627, cpfk_supplier_partsupp#5614 AS cpfk_supplier_partsupp_4#5628, cfpk_partsupp_supplier#5615 AS cfpk_partsupp_supplier_4#5629, cval_partsupp_ps_availqty#5616 AS cval_partsupp_ps_availqty_4#5630, cval_partsupp_ps_supplycost#5617 AS cval_partsupp_ps_supplycost_4#5631, cval_partsupp_ps_comment#5618 AS cval_partsupp_ps_comment_4#5632, cdepval_partsupp_ps_availqty#5619 AS cdepval_partsupp_ps_availqty_4#5633, cdepval_partsupp_ps_supplycost#5620 AS cdepval_partsupp_ps_supplycost_4#5634, cdepval_partsupp_ps_comment#5621 AS cdepval_partsupp_ps_comment_4#5635, cps_availqty#5622 AS cps_availqty_4#5636, cps_supplycost#5623 AS cps_supplycost_4#5637, cps_comment#5624 AS cps_comment_4#5638]
         :     +- Relation[rid#5611,cpfk_part_partsupp#5612,cfpk_partsupp_part#5613,cpfk_supplier_partsupp#5614,cfpk_partsupp_supplier#5615,cval_partsupp_ps_availqty#5616,cval_partsupp_ps_supplycost#5617,cval_partsupp_ps_comment#5618,cdepval_partsupp_ps_availqty#5619,cdepval_partsupp_ps_supplycost#5620,cdepval_partsupp_ps_comment#5621,cps_availqty#5622,cps_supplycost#5623,cps_comment#5624] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#5475 AS rid_2#5493, cpfk_nation_supplier#5476 AS cpfk_nation_supplier_2#5494, cfpk_supplier_nation#5477 AS cfpk_supplier_nation_2#5495, cval_supplier_s_name#5478 AS cval_supplier_s_name_2#5496, cval_supplier_s_address#5479 AS cval_supplier_s_address_2#5497, cval_supplier_s_phone#5480 AS cval_supplier_s_phone_2#5498, cval_supplier_s_acctbal#5481 AS cval_supplier_s_acctbal_2#5499, cval_supplier_s_comment#5482 AS cval_supplier_s_comment_2#5500, cdepval_supplier_s_name#5483 AS cdepval_supplier_s_name_2#5501, cdepval_supplier_s_address#5484 AS cdepval_supplier_s_address_2#5502, cdepval_supplier_s_phone#5485 AS cdepval_supplier_s_phone_2#5503, cdepval_supplier_s_acctbal#5486 AS cdepval_supplier_s_acctbal_2#5504, cdepval_supplier_s_comment#5487 AS cdepval_supplier_s_comment_2#5505, cs_name#5488 AS cs_name_2#5506, cs_address#5489 AS cs_address_2#5507, cs_phone#5490 AS cs_phone_2#5508, cs_acctbal#5491 AS cs_acctbal_2#5509, cs_comment#5492 AS cs_comment_2#5510]
            :  +- Relation[rid#5475,cpfk_nation_supplier#5476,cfpk_supplier_nation#5477,cval_supplier_s_name#5478,cval_supplier_s_address#5479,cval_supplier_s_phone#5480,cval_supplier_s_acctbal#5481,cval_supplier_s_comment#5482,cdepval_supplier_s_name#5483,cdepval_supplier_s_address#5484,cdepval_supplier_s_phone#5485,cdepval_supplier_s_acctbal#5486,cdepval_supplier_s_comment#5487,cs_name#5488,cs_address#5489,cs_phone#5490,cs_acctbal#5491,cs_comment#5492] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_1))
               :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#5404, cval_region_r_name_0#5405, cval_region_r_comment_0#5406, cdepval_region_r_name_0#5407, cdepval_region_r_comment_0#5408, cr_name_0#5409, cr_comment_0#5410, 'rid_1]
               :  :- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
               :  :  +- Project [rid#5397 AS rid_0#5404, cval_region_r_name#5398 AS cval_region_r_name_0#5405, cval_region_r_comment#5399 AS cval_region_r_comment_0#5406, cdepval_region_r_name#5400 AS cdepval_region_r_name_0#5407, cdepval_region_r_comment#5401 AS cdepval_region_r_comment_0#5408, cr_name#5402 AS cr_name_0#5409, cr_comment#5403 AS cr_comment_0#5410]
               :  :     +- Relation[rid#5397,cval_region_r_name#5398,cval_region_r_comment#5399,cdepval_region_r_name#5400,cdepval_region_r_comment#5401,cr_name#5402,cr_comment#5403] JDBCRelation(tregion) [numPartitions=1]
               :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
               :     +- Project [rid#5457 AS rid_1#5466, cpfk_region_nation#5458 AS cpfk_region_nation_1#5467, cfpk_nation_region#5459 AS cfpk_nation_region_1#5468, cval_nation_n_name#5460 AS cval_nation_n_name_1#5469, cval_nation_n_comment#5461 AS cval_nation_n_comment_1#5470, cdepval_nation_n_name#5462 AS cdepval_nation_n_name_1#5471, cdepval_nation_n_comment#5463 AS cdepval_nation_n_comment_1#5472, cn_name#5464 AS cn_name_1#5473, cn_comment#5465 AS cn_comment_1#5474]
               :        +- Relation[rid#5457,cpfk_region_nation#5458,cfpk_nation_region#5459,cval_nation_n_name#5460,cval_nation_n_comment#5461,cdepval_nation_n_name#5462,cdepval_nation_n_comment#5463,cn_name#5464,cn_comment#5465] JDBCRelation(tnation) [numPartitions=1]
               +- Project [rid#5425 AS rid_1#5434, cpfk_region_nation#5426 AS cpfk_region_nation_1#5435, cfpk_nation_region#5427 AS cfpk_nation_region_1#5436, cval_nation_n_name#5428 AS cval_nation_n_name_1#5437, cval_nation_n_comment#5429 AS cval_nation_n_comment_1#5438, cdepval_nation_n_name#5430 AS cdepval_nation_n_name_1#5439, cdepval_nation_n_comment#5431 AS cdepval_nation_n_comment_1#5440, cn_name#5432 AS cn_name_1#5441, cn_comment#5433 AS cn_comment_1#5442]
                  +- Relation[rid#5425,cpfk_region_nation#5426,cfpk_nation_region#5427,cval_nation_n_name#5428,cval_nation_n_comment#5429,cdepval_nation_n_name#5430,cdepval_nation_n_comment#5431,cn_name#5432,cn_comment#5433] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 950ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/26 22:22:00 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:22:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5796L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 22:22:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:22:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:22:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:22:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:22:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:22:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:22:00 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:22:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:22:00 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:22:00 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:22:00 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:22:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5796L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#5924 AS rid_2#5938, cpfk_part_partsupp#5925 AS cpfk_part_partsupp_2#5939, cfpk_partsupp_part#5926 AS cfpk_partsupp_part_2#5940, cpfk_supplier_partsupp#5927 AS cpfk_supplier_partsupp_2#5941, cfpk_partsupp_supplier#5928 AS cfpk_partsupp_supplier_2#5942, cval_partsupp_ps_availqty#5929 AS cval_partsupp_ps_availqty_2#5943, cval_partsupp_ps_supplycost#5930 AS cval_partsupp_ps_supplycost_2#5944, cval_partsupp_ps_comment#5931 AS cval_partsupp_ps_comment_2#5945, cdepval_partsupp_ps_availqty#5932 AS cdepval_partsupp_ps_availqty_2#5946, cdepval_partsupp_ps_supplycost#5933 AS cdepval_partsupp_ps_supplycost_2#5947, cdepval_partsupp_ps_comment#5934 AS cdepval_partsupp_ps_comment_2#5948, cps_availqty#5935 AS cps_availqty_2#5949, cps_supplycost#5936 AS cps_supplycost_2#5950, cps_comment#5937 AS cps_comment_2#5951]
         :  +- Relation[rid#5924,cpfk_part_partsupp#5925,cfpk_partsupp_part#5926,cpfk_supplier_partsupp#5927,cfpk_partsupp_supplier#5928,cval_partsupp_ps_availqty#5929,cval_partsupp_ps_supplycost#5930,cval_partsupp_ps_comment#5931,cdepval_partsupp_ps_availqty#5932,cdepval_partsupp_ps_supplycost#5933,cdepval_partsupp_ps_comment#5934,cps_availqty#5935,cps_supplycost#5936,cps_comment#5937] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#5807, cpfk_region_nation_0#5808, cfpk_nation_region_0#5809, cval_nation_n_name_0#5810, cval_nation_n_comment_0#5811, cdepval_nation_n_name_0#5812, cdepval_nation_n_comment_0#5813, cn_name_0#5814, cn_comment_0#5815, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
            :  :  +- Project [rid#5798 AS rid_0#5807, cpfk_region_nation#5799 AS cpfk_region_nation_0#5808, cfpk_nation_region#5800 AS cfpk_nation_region_0#5809, cval_nation_n_name#5801 AS cval_nation_n_name_0#5810, cval_nation_n_comment#5802 AS cval_nation_n_comment_0#5811, cdepval_nation_n_name#5803 AS cdepval_nation_n_name_0#5812, cdepval_nation_n_comment#5804 AS cdepval_nation_n_comment_0#5813, cn_name#5805 AS cn_name_0#5814, cn_comment#5806 AS cn_comment_0#5815]
            :  :     +- Relation[rid#5798,cpfk_region_nation#5799,cfpk_nation_region#5800,cval_nation_n_name#5801,cval_nation_n_comment#5802,cdepval_nation_n_name#5803,cdepval_nation_n_comment#5804,cn_name#5805,cn_comment#5806] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
            :     +- Project [rid#5888 AS rid_1#5906, cpfk_nation_supplier#5889 AS cpfk_nation_supplier_1#5907, cfpk_supplier_nation#5890 AS cfpk_supplier_nation_1#5908, cval_supplier_s_name#5891 AS cval_supplier_s_name_1#5909, cval_supplier_s_address#5892 AS cval_supplier_s_address_1#5910, cval_supplier_s_phone#5893 AS cval_supplier_s_phone_1#5911, cval_supplier_s_acctbal#5894 AS cval_supplier_s_acctbal_1#5912, cval_supplier_s_comment#5895 AS cval_supplier_s_comment_1#5913, cdepval_supplier_s_name#5896 AS cdepval_supplier_s_name_1#5914, cdepval_supplier_s_address#5897 AS cdepval_supplier_s_address_1#5915, cdepval_supplier_s_phone#5898 AS cdepval_supplier_s_phone_1#5916, cdepval_supplier_s_acctbal#5899 AS cdepval_supplier_s_acctbal_1#5917, cdepval_supplier_s_comment#5900 AS cdepval_supplier_s_comment_1#5918, cs_name#5901 AS cs_name_1#5919, cs_address#5902 AS cs_address_1#5920, cs_phone#5903 AS cs_phone_1#5921, cs_acctbal#5904 AS cs_acctbal_1#5922, cs_comment#5905 AS cs_comment_1#5923]
            :        +- Relation[rid#5888,cpfk_nation_supplier#5889,cfpk_supplier_nation#5890,cval_supplier_s_name#5891,cval_supplier_s_address#5892,cval_supplier_s_phone#5893,cval_supplier_s_acctbal#5894,cval_supplier_s_comment#5895,cdepval_supplier_s_name#5896,cdepval_supplier_s_address#5897,cdepval_supplier_s_phone#5898,cdepval_supplier_s_acctbal#5899,cdepval_supplier_s_comment#5900,cs_name#5901,cs_address#5902,cs_phone#5903,cs_acctbal#5904,cs_comment#5905] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#5834 AS rid_1#5852, cpfk_nation_supplier#5835 AS cpfk_nation_supplier_1#5853, cfpk_supplier_nation#5836 AS cfpk_supplier_nation_1#5854, cval_supplier_s_name#5837 AS cval_supplier_s_name_1#5855, cval_supplier_s_address#5838 AS cval_supplier_s_address_1#5856, cval_supplier_s_phone#5839 AS cval_supplier_s_phone_1#5857, cval_supplier_s_acctbal#5840 AS cval_supplier_s_acctbal_1#5858, cval_supplier_s_comment#5841 AS cval_supplier_s_comment_1#5859, cdepval_supplier_s_name#5842 AS cdepval_supplier_s_name_1#5860, cdepval_supplier_s_address#5843 AS cdepval_supplier_s_address_1#5861, cdepval_supplier_s_phone#5844 AS cdepval_supplier_s_phone_1#5862, cdepval_supplier_s_acctbal#5845 AS cdepval_supplier_s_acctbal_1#5863, cdepval_supplier_s_comment#5846 AS cdepval_supplier_s_comment_1#5864, cs_name#5847 AS cs_name_1#5865, cs_address#5848 AS cs_address_1#5866, cs_phone#5849 AS cs_phone_1#5867, cs_acctbal#5850 AS cs_acctbal_1#5868, cs_comment#5851 AS cs_comment_1#5869]
               +- Relation[rid#5834,cpfk_nation_supplier#5835,cfpk_supplier_nation#5836,cval_supplier_s_name#5837,cval_supplier_s_address#5838,cval_supplier_s_phone#5839,cval_supplier_s_acctbal#5840,cval_supplier_s_comment#5841,cdepval_supplier_s_name#5842,cdepval_supplier_s_address#5843,cdepval_supplier_s_phone#5844,cdepval_supplier_s_acctbal#5845,cdepval_supplier_s_comment#5846,cs_name#5847,cs_address#5848,cs_phone#5849,cs_acctbal#5850,cs_comment#5851] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 2477ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/26 22:22:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:22:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5997L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 22:22:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5997L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#5999 AS rid_0#6023, cpfk_customer_orders#6000 AS cpfk_customer_orders_0#6024, cfpk_orders_customer#6001 AS cfpk_orders_customer_0#6025, cval_orders_o_orderstatus#6002 AS cval_orders_o_orderstatus_0#6026, cval_orders_o_totalprice#6003 AS cval_orders_o_totalprice_0#6027, cval_orders_o_orderpriority#6004 AS cval_orders_o_orderpriority_0#6028, cval_orders_o_clerk#6005 AS cval_orders_o_clerk_0#6029, cval_orders_o_shippriority#6006 AS cval_orders_o_shippriority_0#6030, cval_orders_o_comment#6007 AS cval_orders_o_comment_0#6031, cval_orders_o_orderdate#6008 AS cval_orders_o_orderdate_0#6032, cdepval_orders_o_orderstatus#6009 AS cdepval_orders_o_orderstatus_0#6033, cdepval_orders_o_totalprice#6010 AS cdepval_orders_o_totalprice_0#6034, cdepval_orders_o_orderpriority#6011 AS cdepval_orders_o_orderpriority_0#6035, cdepval_orders_o_clerk#6012 AS cdepval_orders_o_clerk_0#6036, cdepval_orders_o_shippriority#6013 AS cdepval_orders_o_shippriority_0#6037, cdepval_orders_o_comment#6014 AS cdepval_orders_o_comment_0#6038, cdepval_orders_o_orderdate#6015 AS cdepval_orders_o_orderdate_0#6039, co_orderstatus#6016 AS co_orderstatus_0#6040, co_totalprice#6017 AS co_totalprice_0#6041, co_orderpriority#6018 AS co_orderpriority_0#6042, co_clerk#6019 AS co_clerk_0#6043, co_shippriority#6020 AS co_shippriority_0#6044, co_comment#6021 AS co_comment_0#6045, co_orderdate#6022 AS co_orderdate_0#6046]
         :  +- Relation[rid#5999,cpfk_customer_orders#6000,cfpk_orders_customer#6001,cval_orders_o_orderstatus#6002,cval_orders_o_totalprice#6003,cval_orders_o_orderpriority#6004,cval_orders_o_clerk#6005,cval_orders_o_shippriority#6006,cval_orders_o_comment#6007,cval_orders_o_orderdate#6008,cdepval_orders_o_orderstatus#6009,cdepval_orders_o_totalprice#6010,cdepval_orders_o_orderpriority#6011,cdepval_orders_o_clerk#6012,cdepval_orders_o_shippriority#6013,cdepval_orders_o_comment#6014,cdepval_orders_o_orderdate#6015,co_orderstatus#6016,co_totalprice#6017,co_orderpriority#6018,co_clerk#6019,co_shippriority#6020,co_comment#6021,co_orderdate#6022] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#6047 AS rid_1#6068, cpfk_nation_customer#6048 AS cpfk_nation_customer_1#6069, cfpk_customer_nation#6049 AS cfpk_customer_nation_1#6070, cval_customer_c_name#6050 AS cval_customer_c_name_1#6071, cval_customer_c_address#6051 AS cval_customer_c_address_1#6072, cval_customer_c_phone#6052 AS cval_customer_c_phone_1#6073, cval_customer_c_acctbal#6053 AS cval_customer_c_acctbal_1#6074, cval_customer_c_comment#6054 AS cval_customer_c_comment_1#6075, cval_customer_c_mktsegment#6055 AS cval_customer_c_mktsegment_1#6076, cdepval_customer_c_name#6056 AS cdepval_customer_c_name_1#6077, cdepval_customer_c_address#6057 AS cdepval_customer_c_address_1#6078, cdepval_customer_c_phone#6058 AS cdepval_customer_c_phone_1#6079, cdepval_customer_c_acctbal#6059 AS cdepval_customer_c_acctbal_1#6080, cdepval_customer_c_comment#6060 AS cdepval_customer_c_comment_1#6081, cdepval_customer_c_mktsegment#6061 AS cdepval_customer_c_mktsegment_1#6082, cc_name#6062 AS cc_name_1#6083, cc_address#6063 AS cc_address_1#6084, cc_phone#6064 AS cc_phone_1#6085, cc_acctbal#6065 AS cc_acctbal_1#6086, cc_comment#6066 AS cc_comment_1#6087, cc_mktsegment#6067 AS cc_mktsegment_1#6088]
            +- Relation[rid#6047,cpfk_nation_customer#6048,cfpk_customer_nation#6049,cval_customer_c_name#6050,cval_customer_c_address#6051,cval_customer_c_phone#6052,cval_customer_c_acctbal#6053,cval_customer_c_comment#6054,cval_customer_c_mktsegment#6055,cdepval_customer_c_name#6056,cdepval_customer_c_address#6057,cdepval_customer_c_phone#6058,cdepval_customer_c_acctbal#6059,cdepval_customer_c_comment#6060,cdepval_customer_c_mktsegment#6061,cc_name#6062,cc_address#6063,cc_phone#6064,cc_acctbal#6065,cc_comment#6066,cc_mktsegment#6067] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4621ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/26 22:22:07 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:22:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6142L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:22:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:22:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:22:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:22:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:22:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:22:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:22:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:22:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:22:07 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:22:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:22:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:22:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:22:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:22:07 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:22:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6142L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#6270 AS rid_2#6315, cpfk_orders_lineitem#6271 AS cpfk_orders_lineitem_2#6316, cpfk_supplier_lineitem#6272 AS cpfk_supplier_lineitem_2#6317, cfpk_lineitem_supplier#6273 AS cfpk_lineitem_supplier_2#6318, cfpk_lineitem_partsupp#6274 AS cfpk_lineitem_partsupp_2#6319, cpfk_part_lineitem#6275 AS cpfk_part_lineitem_2#6320, cfpk_lineitem_part#6276 AS cfpk_lineitem_part_2#6321, cpfk_partsupp_lineitem#6277 AS cpfk_partsupp_lineitem_2#6322, cfpk_lineitem_orders#6278 AS cfpk_lineitem_orders_2#6323, cval_lineitem_l_quantity#6279 AS cval_lineitem_l_quantity_2#6324, cval_lineitem_l_extendedprice#6280 AS cval_lineitem_l_extendedprice_2#6325, cval_lineitem_l_discount#6281 AS cval_lineitem_l_discount_2#6326, cval_lineitem_l_tax#6282 AS cval_lineitem_l_tax_2#6327, cval_lineitem_l_returnflag#6283 AS cval_lineitem_l_returnflag_2#6328, cval_lineitem_l_linestatus#6284 AS cval_lineitem_l_linestatus_2#6329, cval_lineitem_l_commitdate#6285 AS cval_lineitem_l_commitdate_2#6330, cval_lineitem_l_receiptdate#6286 AS cval_lineitem_l_receiptdate_2#6331, cval_lineitem_l_shipinstruct#6287 AS cval_lineitem_l_shipinstruct_2#6332, cval_lineitem_l_shipmode#6288 AS cval_lineitem_l_shipmode_2#6333, cval_lineitem_l_comment#6289 AS cval_lineitem_l_comment_2#6334, cval_lineitem_l_shipdate#6290 AS cval_lineitem_l_shipdate_2#6335, cdepval_lineitem_l_quantity#6291 AS cdepval_lineitem_l_quantity_2#6336, cdepval_lineitem_l_extendedprice#6292 AS cdepval_lineitem_l_extendedprice_2#6337, cdepval_lineitem_l_discount#6293 AS cdepval_lineitem_l_discount_2#6338, ... 21 more fields]
         :  :  +- Relation[rid#6270,cpfk_orders_lineitem#6271,cpfk_supplier_lineitem#6272,cfpk_lineitem_supplier#6273,cfpk_lineitem_partsupp#6274,cpfk_part_lineitem#6275,cfpk_lineitem_part#6276,cpfk_partsupp_lineitem#6277,cfpk_lineitem_orders#6278,cval_lineitem_l_quantity#6279,cval_lineitem_l_extendedprice#6280,cval_lineitem_l_discount#6281,cval_lineitem_l_tax#6282,cval_lineitem_l_returnflag#6283,cval_lineitem_l_linestatus#6284,cval_lineitem_l_commitdate#6285,cval_lineitem_l_receiptdate#6286,cval_lineitem_l_shipinstruct#6287,cval_lineitem_l_shipmode#6288,cval_lineitem_l_comment#6289,cval_lineitem_l_shipdate#6290,cdepval_lineitem_l_quantity#6291,cdepval_lineitem_l_extendedprice#6292,cdepval_lineitem_l_discount#6293,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join UsingJoin(Inner,List(rid_1))
         :     :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6153, cpfk_region_nation_0#6154, cfpk_nation_region_0#6155, cval_nation_n_name_0#6156, cval_nation_n_comment_0#6157, cdepval_nation_n_name_0#6158, cdepval_nation_n_comment_0#6159, cn_name_0#6160, cn_comment_0#6161, 'rid_1]
         :     :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :     :  :  +- Project [rid#6144 AS rid_0#6153, cpfk_region_nation#6145 AS cpfk_region_nation_0#6154, cfpk_nation_region#6146 AS cfpk_nation_region_0#6155, cval_nation_n_name#6147 AS cval_nation_n_name_0#6156, cval_nation_n_comment#6148 AS cval_nation_n_comment_0#6157, cdepval_nation_n_name#6149 AS cdepval_nation_n_name_0#6158, cdepval_nation_n_comment#6150 AS cdepval_nation_n_comment_0#6159, cn_name#6151 AS cn_name_0#6160, cn_comment#6152 AS cn_comment_0#6161]
         :     :  :     +- Relation[rid#6144,cpfk_region_nation#6145,cfpk_nation_region#6146,cval_nation_n_name#6147,cval_nation_n_comment#6148,cdepval_nation_n_name#6149,cdepval_nation_n_comment#6150,cn_name#6151,cn_comment#6152] JDBCRelation(tnation) [numPartitions=1]
         :     :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
         :     :     +- Project [rid#6234 AS rid_1#6252, cpfk_nation_supplier#6235 AS cpfk_nation_supplier_1#6253, cfpk_supplier_nation#6236 AS cfpk_supplier_nation_1#6254, cval_supplier_s_name#6237 AS cval_supplier_s_name_1#6255, cval_supplier_s_address#6238 AS cval_supplier_s_address_1#6256, cval_supplier_s_phone#6239 AS cval_supplier_s_phone_1#6257, cval_supplier_s_acctbal#6240 AS cval_supplier_s_acctbal_1#6258, cval_supplier_s_comment#6241 AS cval_supplier_s_comment_1#6259, cdepval_supplier_s_name#6242 AS cdepval_supplier_s_name_1#6260, cdepval_supplier_s_address#6243 AS cdepval_supplier_s_address_1#6261, cdepval_supplier_s_phone#6244 AS cdepval_supplier_s_phone_1#6262, cdepval_supplier_s_acctbal#6245 AS cdepval_supplier_s_acctbal_1#6263, cdepval_supplier_s_comment#6246 AS cdepval_supplier_s_comment_1#6264, cs_name#6247 AS cs_name_1#6265, cs_address#6248 AS cs_address_1#6266, cs_phone#6249 AS cs_phone_1#6267, cs_acctbal#6250 AS cs_acctbal_1#6268, cs_comment#6251 AS cs_comment_1#6269]
         :     :        +- Relation[rid#6234,cpfk_nation_supplier#6235,cfpk_supplier_nation#6236,cval_supplier_s_name#6237,cval_supplier_s_address#6238,cval_supplier_s_phone#6239,cval_supplier_s_acctbal#6240,cval_supplier_s_comment#6241,cdepval_supplier_s_name#6242,cdepval_supplier_s_address#6243,cdepval_supplier_s_phone#6244,cdepval_supplier_s_acctbal#6245,cdepval_supplier_s_comment#6246,cs_name#6247,cs_address#6248,cs_phone#6249,cs_acctbal#6250,cs_comment#6251] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#6180 AS rid_1#6198, cpfk_nation_supplier#6181 AS cpfk_nation_supplier_1#6199, cfpk_supplier_nation#6182 AS cfpk_supplier_nation_1#6200, cval_supplier_s_name#6183 AS cval_supplier_s_name_1#6201, cval_supplier_s_address#6184 AS cval_supplier_s_address_1#6202, cval_supplier_s_phone#6185 AS cval_supplier_s_phone_1#6203, cval_supplier_s_acctbal#6186 AS cval_supplier_s_acctbal_1#6204, cval_supplier_s_comment#6187 AS cval_supplier_s_comment_1#6205, cdepval_supplier_s_name#6188 AS cdepval_supplier_s_name_1#6206, cdepval_supplier_s_address#6189 AS cdepval_supplier_s_address_1#6207, cdepval_supplier_s_phone#6190 AS cdepval_supplier_s_phone_1#6208, cdepval_supplier_s_acctbal#6191 AS cdepval_supplier_s_acctbal_1#6209, cdepval_supplier_s_comment#6192 AS cdepval_supplier_s_comment_1#6210, cs_name#6193 AS cs_name_1#6211, cs_address#6194 AS cs_address_1#6212, cs_phone#6195 AS cs_phone_1#6213, cs_acctbal#6196 AS cs_acctbal_1#6214, cs_comment#6197 AS cs_comment_1#6215]
         :        +- Relation[rid#6180,cpfk_nation_supplier#6181,cfpk_supplier_nation#6182,cval_supplier_s_name#6183,cval_supplier_s_address#6184,cval_supplier_s_phone#6185,cval_supplier_s_acctbal#6186,cval_supplier_s_comment#6187,cdepval_supplier_s_name#6188,cdepval_supplier_s_address#6189,cdepval_supplier_s_phone#6190,cdepval_supplier_s_acctbal#6191,cdepval_supplier_s_comment#6192,cs_name#6193,cs_address#6194,cs_phone#6195,cs_acctbal#6196,cs_comment#6197] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#6498 AS rid_5#6522, cpfk_customer_orders#6499 AS cpfk_customer_orders_5#6523, cfpk_orders_customer#6500 AS cfpk_orders_customer_5#6524, cval_orders_o_orderstatus#6501 AS cval_orders_o_orderstatus_5#6525, cval_orders_o_totalprice#6502 AS cval_orders_o_totalprice_5#6526, cval_orders_o_orderpriority#6503 AS cval_orders_o_orderpriority_5#6527, cval_orders_o_clerk#6504 AS cval_orders_o_clerk_5#6528, cval_orders_o_shippriority#6505 AS cval_orders_o_shippriority_5#6529, cval_orders_o_comment#6506 AS cval_orders_o_comment_5#6530, cval_orders_o_orderdate#6507 AS cval_orders_o_orderdate_5#6531, cdepval_orders_o_orderstatus#6508 AS cdepval_orders_o_orderstatus_5#6532, cdepval_orders_o_totalprice#6509 AS cdepval_orders_o_totalprice_5#6533, cdepval_orders_o_orderpriority#6510 AS cdepval_orders_o_orderpriority_5#6534, cdepval_orders_o_clerk#6511 AS cdepval_orders_o_clerk_5#6535, cdepval_orders_o_shippriority#6512 AS cdepval_orders_o_shippriority_5#6536, cdepval_orders_o_comment#6513 AS cdepval_orders_o_comment_5#6537, cdepval_orders_o_orderdate#6514 AS cdepval_orders_o_orderdate_5#6538, co_orderstatus#6515 AS co_orderstatus_5#6539, co_totalprice#6516 AS co_totalprice_5#6540, co_orderpriority#6517 AS co_orderpriority_5#6541, co_clerk#6518 AS co_clerk_5#6542, co_shippriority#6519 AS co_shippriority_5#6543, co_comment#6520 AS co_comment_5#6544, co_orderdate#6521 AS co_orderdate_5#6545]
            :  +- Relation[rid#6498,cpfk_customer_orders#6499,cfpk_orders_customer#6500,cval_orders_o_orderstatus#6501,cval_orders_o_totalprice#6502,cval_orders_o_orderpriority#6503,cval_orders_o_clerk#6504,cval_orders_o_shippriority#6505,cval_orders_o_comment#6506,cval_orders_o_orderdate#6507,cdepval_orders_o_orderstatus#6508,cdepval_orders_o_totalprice#6509,cdepval_orders_o_orderpriority#6510,cdepval_orders_o_clerk#6511,cdepval_orders_o_shippriority#6512,cdepval_orders_o_comment#6513,cdepval_orders_o_orderdate#6514,co_orderstatus#6515,co_totalprice#6516,co_orderpriority#6517,co_clerk#6518,co_shippriority#6519,co_comment#6520,co_orderdate#6521] JDBCRelation(torders) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_4))
               :- 'DexPkfkMaterializationAwareJoin nation~customer, 'cpfk_nation_customer_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#6369, cpfk_region_nation_3#6370, cfpk_nation_region_3#6371, cval_nation_n_name_3#6372, cval_nation_n_comment_3#6373, cdepval_nation_n_name_3#6374, cdepval_nation_n_comment_3#6375, cn_name_3#6376, cn_comment_3#6377, 'rid_4]
               :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
               :  :  +- Project [rid#6360 AS rid_3#6369, cpfk_region_nation#6361 AS cpfk_region_nation_3#6370, cfpk_nation_region#6362 AS cfpk_nation_region_3#6371, cval_nation_n_name#6363 AS cval_nation_n_name_3#6372, cval_nation_n_comment#6364 AS cval_nation_n_comment_3#6373, cdepval_nation_n_name#6365 AS cdepval_nation_n_name_3#6374, cdepval_nation_n_comment#6366 AS cdepval_nation_n_comment_3#6375, cn_name#6367 AS cn_name_3#6376, cn_comment#6368 AS cn_comment_3#6377]
               :  :     +- Relation[rid#6360,cpfk_region_nation#6361,cfpk_nation_region#6362,cval_nation_n_name#6363,cval_nation_n_comment#6364,cdepval_nation_n_name#6365,cdepval_nation_n_comment#6366,cn_name#6367,cn_comment#6368] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'Project ['cpfk_nation_customer_4, 'rid_4]
               :     +- Project [rid#6456 AS rid_4#6477, cpfk_nation_customer#6457 AS cpfk_nation_customer_4#6478, cfpk_customer_nation#6458 AS cfpk_customer_nation_4#6479, cval_customer_c_name#6459 AS cval_customer_c_name_4#6480, cval_customer_c_address#6460 AS cval_customer_c_address_4#6481, cval_customer_c_phone#6461 AS cval_customer_c_phone_4#6482, cval_customer_c_acctbal#6462 AS cval_customer_c_acctbal_4#6483, cval_customer_c_comment#6463 AS cval_customer_c_comment_4#6484, cval_customer_c_mktsegment#6464 AS cval_customer_c_mktsegment_4#6485, cdepval_customer_c_name#6465 AS cdepval_customer_c_name_4#6486, cdepval_customer_c_address#6466 AS cdepval_customer_c_address_4#6487, cdepval_customer_c_phone#6467 AS cdepval_customer_c_phone_4#6488, cdepval_customer_c_acctbal#6468 AS cdepval_customer_c_acctbal_4#6489, cdepval_customer_c_comment#6469 AS cdepval_customer_c_comment_4#6490, cdepval_customer_c_mktsegment#6470 AS cdepval_customer_c_mktsegment_4#6491, cc_name#6471 AS cc_name_4#6492, cc_address#6472 AS cc_address_4#6493, cc_phone#6473 AS cc_phone_4#6494, cc_acctbal#6474 AS cc_acctbal_4#6495, cc_comment#6475 AS cc_comment_4#6496, cc_mktsegment#6476 AS cc_mktsegment_4#6497]
               :        +- Relation[rid#6456,cpfk_nation_customer#6457,cfpk_customer_nation#6458,cval_customer_c_name#6459,cval_customer_c_address#6460,cval_customer_c_phone#6461,cval_customer_c_acctbal#6462,cval_customer_c_comment#6463,cval_customer_c_mktsegment#6464,cdepval_customer_c_name#6465,cdepval_customer_c_address#6466,cdepval_customer_c_phone#6467,cdepval_customer_c_acctbal#6468,cdepval_customer_c_comment#6469,cdepval_customer_c_mktsegment#6470,cc_name#6471,cc_address#6472,cc_phone#6473,cc_acctbal#6474,cc_comment#6475,cc_mktsegment#6476] JDBCRelation(tcustomer) [numPartitions=1]
               +- Project [rid#6396 AS rid_4#6417, cpfk_nation_customer#6397 AS cpfk_nation_customer_4#6418, cfpk_customer_nation#6398 AS cfpk_customer_nation_4#6419, cval_customer_c_name#6399 AS cval_customer_c_name_4#6420, cval_customer_c_address#6400 AS cval_customer_c_address_4#6421, cval_customer_c_phone#6401 AS cval_customer_c_phone_4#6422, cval_customer_c_acctbal#6402 AS cval_customer_c_acctbal_4#6423, cval_customer_c_comment#6403 AS cval_customer_c_comment_4#6424, cval_customer_c_mktsegment#6404 AS cval_customer_c_mktsegment_4#6425, cdepval_customer_c_name#6405 AS cdepval_customer_c_name_4#6426, cdepval_customer_c_address#6406 AS cdepval_customer_c_address_4#6427, cdepval_customer_c_phone#6407 AS cdepval_customer_c_phone_4#6428, cdepval_customer_c_acctbal#6408 AS cdepval_customer_c_acctbal_4#6429, cdepval_customer_c_comment#6409 AS cdepval_customer_c_comment_4#6430, cdepval_customer_c_mktsegment#6410 AS cdepval_customer_c_mktsegment_4#6431, cc_name#6411 AS cc_name_4#6432, cc_address#6412 AS cc_address_4#6433, cc_phone#6413 AS cc_phone_4#6434, cc_acctbal#6414 AS cc_acctbal_4#6435, cc_comment#6415 AS cc_comment_4#6436, cc_mktsegment#6416 AS cc_mktsegment_4#6437]
                  +- Relation[rid#6396,cpfk_nation_customer#6397,cfpk_customer_nation#6398,cval_customer_c_name#6399,cval_customer_c_address#6400,cval_customer_c_phone#6401,cval_customer_c_acctbal#6402,cval_customer_c_comment#6403,cval_customer_c_mktsegment#6404,cdepval_customer_c_name#6405,cdepval_customer_c_address#6406,cdepval_customer_c_phone#6407,cdepval_customer_c_acctbal#6408,cdepval_customer_c_comment#6409,cdepval_customer_c_mktsegment#6410,cc_name#6411,cc_address#6412,cc_phone#6413,cc_acctbal#6414,cc_comment#6415,cc_mktsegment#6416] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 40455ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 22:22:47 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:22:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6681L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:22:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:22:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:22:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:22:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:22:47 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:22:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:22:47 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:22:47 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:22:47 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:22:47 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:22:47 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:22:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6681L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#6815 AS rid_4#6860, cpfk_orders_lineitem#6816 AS cpfk_orders_lineitem_4#6861, cpfk_supplier_lineitem#6817 AS cpfk_supplier_lineitem_4#6862, cfpk_lineitem_supplier#6818 AS cfpk_lineitem_supplier_4#6863, cfpk_lineitem_partsupp#6819 AS cfpk_lineitem_partsupp_4#6864, cpfk_part_lineitem#6820 AS cpfk_part_lineitem_4#6865, cfpk_lineitem_part#6821 AS cfpk_lineitem_part_4#6866, cpfk_partsupp_lineitem#6822 AS cpfk_partsupp_lineitem_4#6867, cfpk_lineitem_orders#6823 AS cfpk_lineitem_orders_4#6868, cval_lineitem_l_quantity#6824 AS cval_lineitem_l_quantity_4#6869, cval_lineitem_l_extendedprice#6825 AS cval_lineitem_l_extendedprice_4#6870, cval_lineitem_l_discount#6826 AS cval_lineitem_l_discount_4#6871, cval_lineitem_l_tax#6827 AS cval_lineitem_l_tax_4#6872, cval_lineitem_l_returnflag#6828 AS cval_lineitem_l_returnflag_4#6873, cval_lineitem_l_linestatus#6829 AS cval_lineitem_l_linestatus_4#6874, cval_lineitem_l_commitdate#6830 AS cval_lineitem_l_commitdate_4#6875, cval_lineitem_l_receiptdate#6831 AS cval_lineitem_l_receiptdate_4#6876, cval_lineitem_l_shipinstruct#6832 AS cval_lineitem_l_shipinstruct_4#6877, cval_lineitem_l_shipmode#6833 AS cval_lineitem_l_shipmode_4#6878, cval_lineitem_l_comment#6834 AS cval_lineitem_l_comment_4#6879, cval_lineitem_l_shipdate#6835 AS cval_lineitem_l_shipdate_4#6880, cdepval_lineitem_l_quantity#6836 AS cdepval_lineitem_l_quantity_4#6881, cdepval_lineitem_l_extendedprice#6837 AS cdepval_lineitem_l_extendedprice_4#6882, cdepval_lineitem_l_discount#6838 AS cdepval_lineitem_l_discount_4#6883, ... 21 more fields]
         :  :  +- Relation[rid#6815,cpfk_orders_lineitem#6816,cpfk_supplier_lineitem#6817,cfpk_lineitem_supplier#6818,cfpk_lineitem_partsupp#6819,cpfk_part_lineitem#6820,cfpk_lineitem_part#6821,cpfk_partsupp_lineitem#6822,cfpk_lineitem_orders#6823,cval_lineitem_l_quantity#6824,cval_lineitem_l_extendedprice#6825,cval_lineitem_l_discount#6826,cval_lineitem_l_tax#6827,cval_lineitem_l_returnflag#6828,cval_lineitem_l_linestatus#6829,cval_lineitem_l_commitdate#6830,cval_lineitem_l_receiptdate#6831,cval_lineitem_l_shipinstruct#6832,cval_lineitem_l_shipmode#6833,cval_lineitem_l_comment#6834,cval_lineitem_l_shipdate#6835,cdepval_lineitem_l_quantity#6836,cdepval_lineitem_l_extendedprice#6837,cdepval_lineitem_l_discount#6838,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#6737 AS rid_2#6751, cpfk_part_partsupp#6738 AS cpfk_part_partsupp_2#6752, cfpk_partsupp_part#6739 AS cfpk_partsupp_part_2#6753, cpfk_supplier_partsupp#6740 AS cpfk_supplier_partsupp_2#6754, cfpk_partsupp_supplier#6741 AS cfpk_partsupp_supplier_2#6755, cval_partsupp_ps_availqty#6742 AS cval_partsupp_ps_availqty_2#6756, cval_partsupp_ps_supplycost#6743 AS cval_partsupp_ps_supplycost_2#6757, cval_partsupp_ps_comment#6744 AS cval_partsupp_ps_comment_2#6758, cdepval_partsupp_ps_availqty#6745 AS cdepval_partsupp_ps_availqty_2#6759, cdepval_partsupp_ps_supplycost#6746 AS cdepval_partsupp_ps_supplycost_2#6760, cdepval_partsupp_ps_comment#6747 AS cdepval_partsupp_ps_comment_2#6761, cps_availqty#6748 AS cps_availqty_2#6762, cps_supplycost#6749 AS cps_supplycost_2#6763, cps_comment#6750 AS cps_comment_2#6764]
         :     :  :  +- Relation[rid#6737,cpfk_part_partsupp#6738,cfpk_partsupp_part#6739,cpfk_supplier_partsupp#6740,cfpk_partsupp_supplier#6741,cval_partsupp_ps_availqty#6742,cval_partsupp_ps_supplycost#6743,cval_partsupp_ps_comment#6744,cdepval_partsupp_ps_availqty#6745,cdepval_partsupp_ps_supplycost#6746,cdepval_partsupp_ps_comment#6747,cps_availqty#6748,cps_supplycost#6749,cps_comment#6750] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#6701 AS rid_1#6719, cpfk_nation_supplier#6702 AS cpfk_nation_supplier_1#6720, cfpk_supplier_nation#6703 AS cfpk_supplier_nation_1#6721, cval_supplier_s_name#6704 AS cval_supplier_s_name_1#6722, cval_supplier_s_address#6705 AS cval_supplier_s_address_1#6723, cval_supplier_s_phone#6706 AS cval_supplier_s_phone_1#6724, cval_supplier_s_acctbal#6707 AS cval_supplier_s_acctbal_1#6725, cval_supplier_s_comment#6708 AS cval_supplier_s_comment_1#6726, cdepval_supplier_s_name#6709 AS cdepval_supplier_s_name_1#6727, cdepval_supplier_s_address#6710 AS cdepval_supplier_s_address_1#6728, cdepval_supplier_s_phone#6711 AS cdepval_supplier_s_phone_1#6729, cdepval_supplier_s_acctbal#6712 AS cdepval_supplier_s_acctbal_1#6730, cdepval_supplier_s_comment#6713 AS cdepval_supplier_s_comment_1#6731, cs_name#6714 AS cs_name_1#6732, cs_address#6715 AS cs_address_1#6733, cs_phone#6716 AS cs_phone_1#6734, cs_acctbal#6717 AS cs_acctbal_1#6735, cs_comment#6718 AS cs_comment_1#6736]
         :     :     :  +- Relation[rid#6701,cpfk_nation_supplier#6702,cfpk_supplier_nation#6703,cval_supplier_s_name#6704,cval_supplier_s_address#6705,cval_supplier_s_phone#6706,cval_supplier_s_acctbal#6707,cval_supplier_s_comment#6708,cdepval_supplier_s_name#6709,cdepval_supplier_s_address#6710,cdepval_supplier_s_phone#6711,cdepval_supplier_s_acctbal#6712,cdepval_supplier_s_comment#6713,cs_name#6714,cs_address#6715,cs_phone#6716,cs_acctbal#6717,cs_comment#6718] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#6683 AS rid_0#6692, cpfk_region_nation#6684 AS cpfk_region_nation_0#6693, cfpk_nation_region#6685 AS cfpk_nation_region_0#6694, cval_nation_n_name#6686 AS cval_nation_n_name_0#6695, cval_nation_n_comment#6687 AS cval_nation_n_comment_0#6696, cdepval_nation_n_name#6688 AS cdepval_nation_n_name_0#6697, cdepval_nation_n_comment#6689 AS cdepval_nation_n_comment_0#6698, cn_name#6690 AS cn_name_0#6699, cn_comment#6691 AS cn_comment_0#6700]
         :     :        +- Relation[rid#6683,cpfk_region_nation#6684,cfpk_nation_region#6685,cval_nation_n_name#6686,cval_nation_n_comment#6687,cdepval_nation_n_name#6688,cdepval_nation_n_comment#6689,cn_name#6690,cn_comment#6691] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#6765 AS rid_3#6790, cval_part_p_name#6766 AS cval_part_p_name_3#6791, cval_part_p_mfgr#6767 AS cval_part_p_mfgr_3#6792, cval_part_p_type#6768 AS cval_part_p_type_3#6793, cval_part_p_size#6769 AS cval_part_p_size_3#6794, cval_part_p_container#6770 AS cval_part_p_container_3#6795, cval_part_p_retailprice#6771 AS cval_part_p_retailprice_3#6796, cval_part_p_comment#6772 AS cval_part_p_comment_3#6797, cval_part_p_brand#6773 AS cval_part_p_brand_3#6798, cdepval_part_p_name#6774 AS cdepval_part_p_name_3#6799, cdepval_part_p_mfgr#6775 AS cdepval_part_p_mfgr_3#6800, cdepval_part_p_type#6776 AS cdepval_part_p_type_3#6801, cdepval_part_p_size#6777 AS cdepval_part_p_size_3#6802, cdepval_part_p_container#6778 AS cdepval_part_p_container_3#6803, cdepval_part_p_retailprice#6779 AS cdepval_part_p_retailprice_3#6804, cdepval_part_p_comment#6780 AS cdepval_part_p_comment_3#6805, cdepval_part_p_brand#6781 AS cdepval_part_p_brand_3#6806, cp_name#6782 AS cp_name_3#6807, cp_mfgr#6783 AS cp_mfgr_3#6808, cp_type#6784 AS cp_type_3#6809, cp_size#6785 AS cp_size_3#6810, cp_container#6786 AS cp_container_3#6811, cp_retailprice#6787 AS cp_retailprice_3#6812, cp_comment#6788 AS cp_comment_3#6813, cp_brand#6789 AS cp_brand_3#6814]
         :        +- Relation[rid#6765,cval_part_p_name#6766,cval_part_p_mfgr#6767,cval_part_p_type#6768,cval_part_p_size#6769,cval_part_p_container#6770,cval_part_p_retailprice#6771,cval_part_p_comment#6772,cval_part_p_brand#6773,cdepval_part_p_name#6774,cdepval_part_p_mfgr#6775,cdepval_part_p_type#6776,cdepval_part_p_size#6777,cdepval_part_p_container#6778,cdepval_part_p_retailprice#6779,cdepval_part_p_comment#6780,cdepval_part_p_brand#6781,cp_name#6782,cp_mfgr#6783,cp_type#6784,cp_size#6785,cp_container#6786,cp_retailprice#6787,cp_comment#6788,cp_brand#6789] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#6905 AS rid_5#6929, cpfk_customer_orders#6906 AS cpfk_customer_orders_5#6930, cfpk_orders_customer#6907 AS cfpk_orders_customer_5#6931, cval_orders_o_orderstatus#6908 AS cval_orders_o_orderstatus_5#6932, cval_orders_o_totalprice#6909 AS cval_orders_o_totalprice_5#6933, cval_orders_o_orderpriority#6910 AS cval_orders_o_orderpriority_5#6934, cval_orders_o_clerk#6911 AS cval_orders_o_clerk_5#6935, cval_orders_o_shippriority#6912 AS cval_orders_o_shippriority_5#6936, cval_orders_o_comment#6913 AS cval_orders_o_comment_5#6937, cval_orders_o_orderdate#6914 AS cval_orders_o_orderdate_5#6938, cdepval_orders_o_orderstatus#6915 AS cdepval_orders_o_orderstatus_5#6939, cdepval_orders_o_totalprice#6916 AS cdepval_orders_o_totalprice_5#6940, cdepval_orders_o_orderpriority#6917 AS cdepval_orders_o_orderpriority_5#6941, cdepval_orders_o_clerk#6918 AS cdepval_orders_o_clerk_5#6942, cdepval_orders_o_shippriority#6919 AS cdepval_orders_o_shippriority_5#6943, cdepval_orders_o_comment#6920 AS cdepval_orders_o_comment_5#6944, cdepval_orders_o_orderdate#6921 AS cdepval_orders_o_orderdate_5#6945, co_orderstatus#6922 AS co_orderstatus_5#6946, co_totalprice#6923 AS co_totalprice_5#6947, co_orderpriority#6924 AS co_orderpriority_5#6948, co_clerk#6925 AS co_clerk_5#6949, co_shippriority#6926 AS co_shippriority_5#6950, co_comment#6927 AS co_comment_5#6951, co_orderdate#6928 AS co_orderdate_5#6952]
            +- Relation[rid#6905,cpfk_customer_orders#6906,cfpk_orders_customer#6907,cval_orders_o_orderstatus#6908,cval_orders_o_totalprice#6909,cval_orders_o_orderpriority#6910,cval_orders_o_clerk#6911,cval_orders_o_shippriority#6912,cval_orders_o_comment#6913,cval_orders_o_orderdate#6914,cdepval_orders_o_orderstatus#6915,cdepval_orders_o_totalprice#6916,cdepval_orders_o_orderpriority#6917,cdepval_orders_o_clerk#6918,cdepval_orders_o_shippriority#6919,cdepval_orders_o_comment#6920,cdepval_orders_o_orderdate#6921,co_orderstatus#6922,co_totalprice#6923,co_orderpriority#6924,co_clerk#6925,co_shippriority#6926,co_comment#6927,co_orderdate#6928] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 37723ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/26 22:23:25 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:23:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7095L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:23:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:23:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:23:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:23:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:23:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:23:25 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:23:25 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:23:25 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:23:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:23:25 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:23:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:23:25 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:23:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:23:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:23:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7095L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#7122, cval_part_p_name_0#7123, cval_part_p_mfgr_0#7124, cval_part_p_type_0#7125, cval_part_p_size_0#7126, cval_part_p_container_0#7127, cval_part_p_retailprice_0#7128, cval_part_p_comment_0#7129, cval_part_p_brand_0#7130, cdepval_part_p_name_0#7131, cdepval_part_p_mfgr_0#7132, cdepval_part_p_type_0#7133, cdepval_part_p_size_0#7134, cdepval_part_p_container_0#7135, cdepval_part_p_retailprice_0#7136, cdepval_part_p_comment_0#7137, cdepval_part_p_brand_0#7138, cp_name_0#7139, cp_mfgr_0#7140, cp_type_0#7141, cp_size_0#7142, cp_container_0#7143, cp_retailprice_0#7144, cp_comment_0#7145, ... 2 more fields]
         :  :  :  :  :- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :  :  :  +- Project [rid#7097 AS rid_0#7122, cval_part_p_name#7098 AS cval_part_p_name_0#7123, cval_part_p_mfgr#7099 AS cval_part_p_mfgr_0#7124, cval_part_p_type#7100 AS cval_part_p_type_0#7125, cval_part_p_size#7101 AS cval_part_p_size_0#7126, cval_part_p_container#7102 AS cval_part_p_container_0#7127, cval_part_p_retailprice#7103 AS cval_part_p_retailprice_0#7128, cval_part_p_comment#7104 AS cval_part_p_comment_0#7129, cval_part_p_brand#7105 AS cval_part_p_brand_0#7130, cdepval_part_p_name#7106 AS cdepval_part_p_name_0#7131, cdepval_part_p_mfgr#7107 AS cdepval_part_p_mfgr_0#7132, cdepval_part_p_type#7108 AS cdepval_part_p_type_0#7133, cdepval_part_p_size#7109 AS cdepval_part_p_size_0#7134, cdepval_part_p_container#7110 AS cdepval_part_p_container_0#7135, cdepval_part_p_retailprice#7111 AS cdepval_part_p_retailprice_0#7136, cdepval_part_p_comment#7112 AS cdepval_part_p_comment_0#7137, cdepval_part_p_brand#7113 AS cdepval_part_p_brand_0#7138, cp_name#7114 AS cp_name_0#7139, cp_mfgr#7115 AS cp_mfgr_0#7140, cp_type#7116 AS cp_type_0#7141, cp_size#7117 AS cp_size_0#7142, cp_container#7118 AS cp_container_0#7143, cp_retailprice#7119 AS cp_retailprice_0#7144, cp_comment#7120 AS cp_comment_0#7145, cp_brand#7121 AS cp_brand_0#7146]
         :  :  :  :  :     +- Relation[rid#7097,cval_part_p_name#7098,cval_part_p_mfgr#7099,cval_part_p_type#7100,cval_part_p_size#7101,cval_part_p_container#7102,cval_part_p_retailprice#7103,cval_part_p_comment#7104,cval_part_p_brand#7105,cdepval_part_p_name#7106,cdepval_part_p_mfgr#7107,cdepval_part_p_type#7108,cdepval_part_p_size#7109,cdepval_part_p_container#7110,cdepval_part_p_retailprice#7111,cdepval_part_p_comment#7112,cdepval_part_p_brand#7113,cp_name#7114,cp_mfgr#7115,cp_type#7116,cp_size#7117,cp_container#7118,cp_retailprice#7119,cp_comment#7120,cp_brand#7121] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :  :  :  :     +- Project [rid#7337 AS rid_1#7382, cpfk_orders_lineitem#7338 AS cpfk_orders_lineitem_1#7383, cpfk_supplier_lineitem#7339 AS cpfk_supplier_lineitem_1#7384, cfpk_lineitem_supplier#7340 AS cfpk_lineitem_supplier_1#7385, cfpk_lineitem_partsupp#7341 AS cfpk_lineitem_partsupp_1#7386, cpfk_part_lineitem#7342 AS cpfk_part_lineitem_1#7387, cfpk_lineitem_part#7343 AS cfpk_lineitem_part_1#7388, cpfk_partsupp_lineitem#7344 AS cpfk_partsupp_lineitem_1#7389, cfpk_lineitem_orders#7345 AS cfpk_lineitem_orders_1#7390, cval_lineitem_l_quantity#7346 AS cval_lineitem_l_quantity_1#7391, cval_lineitem_l_extendedprice#7347 AS cval_lineitem_l_extendedprice_1#7392, cval_lineitem_l_discount#7348 AS cval_lineitem_l_discount_1#7393, cval_lineitem_l_tax#7349 AS cval_lineitem_l_tax_1#7394, cval_lineitem_l_returnflag#7350 AS cval_lineitem_l_returnflag_1#7395, cval_lineitem_l_linestatus#7351 AS cval_lineitem_l_linestatus_1#7396, cval_lineitem_l_commitdate#7352 AS cval_lineitem_l_commitdate_1#7397, cval_lineitem_l_receiptdate#7353 AS cval_lineitem_l_receiptdate_1#7398, cval_lineitem_l_shipinstruct#7354 AS cval_lineitem_l_shipinstruct_1#7399, cval_lineitem_l_shipmode#7355 AS cval_lineitem_l_shipmode_1#7400, cval_lineitem_l_comment#7356 AS cval_lineitem_l_comment_1#7401, cval_lineitem_l_shipdate#7357 AS cval_lineitem_l_shipdate_1#7402, cdepval_lineitem_l_quantity#7358 AS cdepval_lineitem_l_quantity_1#7403, cdepval_lineitem_l_extendedprice#7359 AS cdepval_lineitem_l_extendedprice_1#7404, cdepval_lineitem_l_discount#7360 AS cdepval_lineitem_l_discount_1#7405, ... 21 more fields]
         :  :  :  :        +- Relation[rid#7337,cpfk_orders_lineitem#7338,cpfk_supplier_lineitem#7339,cfpk_lineitem_supplier#7340,cfpk_lineitem_partsupp#7341,cpfk_part_lineitem#7342,cfpk_lineitem_part#7343,cpfk_partsupp_lineitem#7344,cfpk_lineitem_orders#7345,cval_lineitem_l_quantity#7346,cval_lineitem_l_extendedprice#7347,cval_lineitem_l_discount#7348,cval_lineitem_l_tax#7349,cval_lineitem_l_returnflag#7350,cval_lineitem_l_linestatus#7351,cval_lineitem_l_commitdate#7352,cval_lineitem_l_receiptdate#7353,cval_lineitem_l_shipinstruct#7354,cval_lineitem_l_shipmode#7355,cval_lineitem_l_comment#7356,cval_lineitem_l_shipdate#7357,cdepval_lineitem_l_quantity#7358,cdepval_lineitem_l_extendedprice#7359,cdepval_lineitem_l_discount#7360,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- Project [rid#7197 AS rid_1#7242, cpfk_orders_lineitem#7198 AS cpfk_orders_lineitem_1#7243, cpfk_supplier_lineitem#7199 AS cpfk_supplier_lineitem_1#7244, cfpk_lineitem_supplier#7200 AS cfpk_lineitem_supplier_1#7245, cfpk_lineitem_partsupp#7201 AS cfpk_lineitem_partsupp_1#7246, cpfk_part_lineitem#7202 AS cpfk_part_lineitem_1#7247, cfpk_lineitem_part#7203 AS cfpk_lineitem_part_1#7248, cpfk_partsupp_lineitem#7204 AS cpfk_partsupp_lineitem_1#7249, cfpk_lineitem_orders#7205 AS cfpk_lineitem_orders_1#7250, cval_lineitem_l_quantity#7206 AS cval_lineitem_l_quantity_1#7251, cval_lineitem_l_extendedprice#7207 AS cval_lineitem_l_extendedprice_1#7252, cval_lineitem_l_discount#7208 AS cval_lineitem_l_discount_1#7253, cval_lineitem_l_tax#7209 AS cval_lineitem_l_tax_1#7254, cval_lineitem_l_returnflag#7210 AS cval_lineitem_l_returnflag_1#7255, cval_lineitem_l_linestatus#7211 AS cval_lineitem_l_linestatus_1#7256, cval_lineitem_l_commitdate#7212 AS cval_lineitem_l_commitdate_1#7257, cval_lineitem_l_receiptdate#7213 AS cval_lineitem_l_receiptdate_1#7258, cval_lineitem_l_shipinstruct#7214 AS cval_lineitem_l_shipinstruct_1#7259, cval_lineitem_l_shipmode#7215 AS cval_lineitem_l_shipmode_1#7260, cval_lineitem_l_comment#7216 AS cval_lineitem_l_comment_1#7261, cval_lineitem_l_shipdate#7217 AS cval_lineitem_l_shipdate_1#7262, cdepval_lineitem_l_quantity#7218 AS cdepval_lineitem_l_quantity_1#7263, cdepval_lineitem_l_extendedprice#7219 AS cdepval_lineitem_l_extendedprice_1#7264, cdepval_lineitem_l_discount#7220 AS cdepval_lineitem_l_discount_1#7265, ... 21 more fields]
         :  :  :     +- Relation[rid#7197,cpfk_orders_lineitem#7198,cpfk_supplier_lineitem#7199,cfpk_lineitem_supplier#7200,cfpk_lineitem_partsupp#7201,cpfk_part_lineitem#7202,cfpk_lineitem_part#7203,cpfk_partsupp_lineitem#7204,cfpk_lineitem_orders#7205,cval_lineitem_l_quantity#7206,cval_lineitem_l_extendedprice#7207,cval_lineitem_l_discount#7208,cval_lineitem_l_tax#7209,cval_lineitem_l_returnflag#7210,cval_lineitem_l_linestatus#7211,cval_lineitem_l_commitdate#7212,cval_lineitem_l_receiptdate#7213,cval_lineitem_l_shipinstruct#7214,cval_lineitem_l_shipmode#7215,cval_lineitem_l_comment#7216,cval_lineitem_l_shipdate#7217,cdepval_lineitem_l_quantity#7218,cdepval_lineitem_l_extendedprice#7219,cdepval_lineitem_l_discount#7220,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#7427 AS rid_2#7445, cpfk_nation_supplier#7428 AS cpfk_nation_supplier_2#7446, cfpk_supplier_nation#7429 AS cfpk_supplier_nation_2#7447, cval_supplier_s_name#7430 AS cval_supplier_s_name_2#7448, cval_supplier_s_address#7431 AS cval_supplier_s_address_2#7449, cval_supplier_s_phone#7432 AS cval_supplier_s_phone_2#7450, cval_supplier_s_acctbal#7433 AS cval_supplier_s_acctbal_2#7451, cval_supplier_s_comment#7434 AS cval_supplier_s_comment_2#7452, cdepval_supplier_s_name#7435 AS cdepval_supplier_s_name_2#7453, cdepval_supplier_s_address#7436 AS cdepval_supplier_s_address_2#7454, cdepval_supplier_s_phone#7437 AS cdepval_supplier_s_phone_2#7455, cdepval_supplier_s_acctbal#7438 AS cdepval_supplier_s_acctbal_2#7456, cdepval_supplier_s_comment#7439 AS cdepval_supplier_s_comment_2#7457, cs_name#7440 AS cs_name_2#7458, cs_address#7441 AS cs_address_2#7459, cs_phone#7442 AS cs_phone_2#7460, cs_acctbal#7443 AS cs_acctbal_2#7461, cs_comment#7444 AS cs_comment_2#7462]
         :  :     +- Relation[rid#7427,cpfk_nation_supplier#7428,cfpk_supplier_nation#7429,cval_supplier_s_name#7430,cval_supplier_s_address#7431,cval_supplier_s_phone#7432,cval_supplier_s_acctbal#7433,cval_supplier_s_comment#7434,cdepval_supplier_s_name#7435,cdepval_supplier_s_address#7436,cdepval_supplier_s_phone#7437,cdepval_supplier_s_acctbal#7438,cdepval_supplier_s_comment#7439,cs_name#7440,cs_address#7441,cs_phone#7442,cs_acctbal#7443,cs_comment#7444] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#7463 AS rid_3#7472, cpfk_region_nation#7464 AS cpfk_region_nation_3#7473, cfpk_nation_region#7465 AS cfpk_nation_region_3#7474, cval_nation_n_name#7466 AS cval_nation_n_name_3#7475, cval_nation_n_comment#7467 AS cval_nation_n_comment_3#7476, cdepval_nation_n_name#7468 AS cdepval_nation_n_name_3#7477, cdepval_nation_n_comment#7469 AS cdepval_nation_n_comment_3#7478, cn_name#7470 AS cn_name_3#7479, cn_comment#7471 AS cn_comment_3#7480]
         :     +- Relation[rid#7463,cpfk_region_nation#7464,cfpk_nation_region#7465,cval_nation_n_name#7466,cval_nation_n_comment#7467,cdepval_nation_n_name#7468,cdepval_nation_n_comment#7469,cn_name#7470,cn_comment#7471] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#7601 AS rid_7#7625, cpfk_customer_orders#7602 AS cpfk_customer_orders_7#7626, cfpk_orders_customer#7603 AS cfpk_orders_customer_7#7627, cval_orders_o_orderstatus#7604 AS cval_orders_o_orderstatus_7#7628, cval_orders_o_totalprice#7605 AS cval_orders_o_totalprice_7#7629, cval_orders_o_orderpriority#7606 AS cval_orders_o_orderpriority_7#7630, cval_orders_o_clerk#7607 AS cval_orders_o_clerk_7#7631, cval_orders_o_shippriority#7608 AS cval_orders_o_shippriority_7#7632, cval_orders_o_comment#7609 AS cval_orders_o_comment_7#7633, cval_orders_o_orderdate#7610 AS cval_orders_o_orderdate_7#7634, cdepval_orders_o_orderstatus#7611 AS cdepval_orders_o_orderstatus_7#7635, cdepval_orders_o_totalprice#7612 AS cdepval_orders_o_totalprice_7#7636, cdepval_orders_o_orderpriority#7613 AS cdepval_orders_o_orderpriority_7#7637, cdepval_orders_o_clerk#7614 AS cdepval_orders_o_clerk_7#7638, cdepval_orders_o_shippriority#7615 AS cdepval_orders_o_shippriority_7#7639, cdepval_orders_o_comment#7616 AS cdepval_orders_o_comment_7#7640, cdepval_orders_o_orderdate#7617 AS cdepval_orders_o_orderdate_7#7641, co_orderstatus#7618 AS co_orderstatus_7#7642, co_totalprice#7619 AS co_totalprice_7#7643, co_orderpriority#7620 AS co_orderpriority_7#7644, co_clerk#7621 AS co_clerk_7#7645, co_shippriority#7622 AS co_shippriority_7#7646, co_comment#7623 AS co_comment_7#7647, co_orderdate#7624 AS co_orderdate_7#7648]
            :  +- Relation[rid#7601,cpfk_customer_orders#7602,cfpk_orders_customer#7603,cval_orders_o_orderstatus#7604,cval_orders_o_totalprice#7605,cval_orders_o_orderpriority#7606,cval_orders_o_clerk#7607,cval_orders_o_shippriority#7608,cval_orders_o_comment#7609,cval_orders_o_orderdate#7610,cdepval_orders_o_orderstatus#7611,cdepval_orders_o_totalprice#7612,cdepval_orders_o_orderpriority#7613,cdepval_orders_o_clerk#7614,cdepval_orders_o_shippriority#7615,cdepval_orders_o_comment#7616,cdepval_orders_o_orderdate#7617,co_orderstatus#7618,co_totalprice#7619,co_orderpriority#7620,co_clerk#7621,co_shippriority#7622,co_comment#7623,co_orderdate#7624] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#7559 AS rid_6#7580, cpfk_nation_customer#7560 AS cpfk_nation_customer_6#7581, cfpk_customer_nation#7561 AS cfpk_customer_nation_6#7582, cval_customer_c_name#7562 AS cval_customer_c_name_6#7583, cval_customer_c_address#7563 AS cval_customer_c_address_6#7584, cval_customer_c_phone#7564 AS cval_customer_c_phone_6#7585, cval_customer_c_acctbal#7565 AS cval_customer_c_acctbal_6#7586, cval_customer_c_comment#7566 AS cval_customer_c_comment_6#7587, cval_customer_c_mktsegment#7567 AS cval_customer_c_mktsegment_6#7588, cdepval_customer_c_name#7568 AS cdepval_customer_c_name_6#7589, cdepval_customer_c_address#7569 AS cdepval_customer_c_address_6#7590, cdepval_customer_c_phone#7570 AS cdepval_customer_c_phone_6#7591, cdepval_customer_c_acctbal#7571 AS cdepval_customer_c_acctbal_6#7592, cdepval_customer_c_comment#7572 AS cdepval_customer_c_comment_6#7593, cdepval_customer_c_mktsegment#7573 AS cdepval_customer_c_mktsegment_6#7594, cc_name#7574 AS cc_name_6#7595, cc_address#7575 AS cc_address_6#7596, cc_phone#7576 AS cc_phone_6#7597, cc_acctbal#7577 AS cc_acctbal_6#7598, cc_comment#7578 AS cc_comment_6#7599, cc_mktsegment#7579 AS cc_mktsegment_6#7600]
               :  +- Relation[rid#7559,cpfk_nation_customer#7560,cfpk_customer_nation#7561,cval_customer_c_name#7562,cval_customer_c_address#7563,cval_customer_c_phone#7564,cval_customer_c_acctbal#7565,cval_customer_c_comment#7566,cval_customer_c_mktsegment#7567,cdepval_customer_c_name#7568,cdepval_customer_c_address#7569,cdepval_customer_c_phone#7570,cdepval_customer_c_acctbal#7571,cdepval_customer_c_comment#7572,cdepval_customer_c_mktsegment#7573,cc_name#7574,cc_address#7575,cc_phone#7576,cc_acctbal#7577,cc_comment#7578,cc_mktsegment#7579] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join UsingJoin(Inner,List(rid_5))
                  :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_5, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#7488, cval_region_r_name_4#7489, cval_region_r_comment_4#7490, cdepval_region_r_name_4#7491, cdepval_region_r_comment_4#7492, cr_name_4#7493, cr_comment_4#7494, 'rid_5]
                  :  :- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                  :  :  +- Project [rid#7481 AS rid_4#7488, cval_region_r_name#7482 AS cval_region_r_name_4#7489, cval_region_r_comment#7483 AS cval_region_r_comment_4#7490, cdepval_region_r_name#7484 AS cdepval_region_r_name_4#7491, cdepval_region_r_comment#7485 AS cdepval_region_r_comment_4#7492, cr_name#7486 AS cr_name_4#7493, cr_comment#7487 AS cr_comment_4#7494]
                  :  :     +- Relation[rid#7481,cval_region_r_name#7482,cval_region_r_comment#7483,cdepval_region_r_name#7484,cdepval_region_r_comment#7485,cr_name#7486,cr_comment#7487] JDBCRelation(tregion) [numPartitions=1]
                  :  +- 'Project ['cpfk_region_nation_5, 'rid_5]
                  :     +- Project [rid#7541 AS rid_5#7550, cpfk_region_nation#7542 AS cpfk_region_nation_5#7551, cfpk_nation_region#7543 AS cfpk_nation_region_5#7552, cval_nation_n_name#7544 AS cval_nation_n_name_5#7553, cval_nation_n_comment#7545 AS cval_nation_n_comment_5#7554, cdepval_nation_n_name#7546 AS cdepval_nation_n_name_5#7555, cdepval_nation_n_comment#7547 AS cdepval_nation_n_comment_5#7556, cn_name#7548 AS cn_name_5#7557, cn_comment#7549 AS cn_comment_5#7558]
                  :        +- Relation[rid#7541,cpfk_region_nation#7542,cfpk_nation_region#7543,cval_nation_n_name#7544,cval_nation_n_comment#7545,cdepval_nation_n_name#7546,cdepval_nation_n_comment#7547,cn_name#7548,cn_comment#7549] JDBCRelation(tnation) [numPartitions=1]
                  +- Project [rid#7509 AS rid_5#7518, cpfk_region_nation#7510 AS cpfk_region_nation_5#7519, cfpk_nation_region#7511 AS cfpk_nation_region_5#7520, cval_nation_n_name#7512 AS cval_nation_n_name_5#7521, cval_nation_n_comment#7513 AS cval_nation_n_comment_5#7522, cdepval_nation_n_name#7514 AS cdepval_nation_n_name_5#7523, cdepval_nation_n_comment#7515 AS cdepval_nation_n_comment_5#7524, cn_name#7516 AS cn_name_5#7525, cn_comment#7517 AS cn_comment_5#7526]
                     +- Relation[rid#7509,cpfk_region_nation#7510,cfpk_nation_region#7511,cval_nation_n_name#7512,cval_nation_n_comment#7513,cdepval_nation_n_name#7514,cdepval_nation_n_comment#7515,cn_name#7516,cn_comment#7517] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 3436ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/26 22:23:28 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:23:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7812L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:23:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#7812L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#7814 AS rid_0#7859, cpfk_orders_lineitem#7815 AS cpfk_orders_lineitem_0#7860, cpfk_supplier_lineitem#7816 AS cpfk_supplier_lineitem_0#7861, cfpk_lineitem_supplier#7817 AS cfpk_lineitem_supplier_0#7862, cfpk_lineitem_partsupp#7818 AS cfpk_lineitem_partsupp_0#7863, cpfk_part_lineitem#7819 AS cpfk_part_lineitem_0#7864, cfpk_lineitem_part#7820 AS cfpk_lineitem_part_0#7865, cpfk_partsupp_lineitem#7821 AS cpfk_partsupp_lineitem_0#7866, cfpk_lineitem_orders#7822 AS cfpk_lineitem_orders_0#7867, cval_lineitem_l_quantity#7823 AS cval_lineitem_l_quantity_0#7868, cval_lineitem_l_extendedprice#7824 AS cval_lineitem_l_extendedprice_0#7869, cval_lineitem_l_discount#7825 AS cval_lineitem_l_discount_0#7870, cval_lineitem_l_tax#7826 AS cval_lineitem_l_tax_0#7871, cval_lineitem_l_returnflag#7827 AS cval_lineitem_l_returnflag_0#7872, cval_lineitem_l_linestatus#7828 AS cval_lineitem_l_linestatus_0#7873, cval_lineitem_l_commitdate#7829 AS cval_lineitem_l_commitdate_0#7874, cval_lineitem_l_receiptdate#7830 AS cval_lineitem_l_receiptdate_0#7875, cval_lineitem_l_shipinstruct#7831 AS cval_lineitem_l_shipinstruct_0#7876, cval_lineitem_l_shipmode#7832 AS cval_lineitem_l_shipmode_0#7877, cval_lineitem_l_comment#7833 AS cval_lineitem_l_comment_0#7878, cval_lineitem_l_shipdate#7834 AS cval_lineitem_l_shipdate_0#7879, cdepval_lineitem_l_quantity#7835 AS cdepval_lineitem_l_quantity_0#7880, cdepval_lineitem_l_extendedprice#7836 AS cdepval_lineitem_l_extendedprice_0#7881, cdepval_lineitem_l_discount#7837 AS cdepval_lineitem_l_discount_0#7882, ... 21 more fields]
         +- Relation[rid#7814,cpfk_orders_lineitem#7815,cpfk_supplier_lineitem#7816,cfpk_lineitem_supplier#7817,cfpk_lineitem_partsupp#7818,cpfk_part_lineitem#7819,cfpk_lineitem_part#7820,cpfk_partsupp_lineitem#7821,cfpk_lineitem_orders#7822,cval_lineitem_l_quantity#7823,cval_lineitem_l_extendedprice#7824,cval_lineitem_l_discount#7825,cval_lineitem_l_tax#7826,cval_lineitem_l_returnflag#7827,cval_lineitem_l_linestatus#7828,cval_lineitem_l_commitdate#7829,cval_lineitem_l_receiptdate#7830,cval_lineitem_l_shipinstruct#7831,cval_lineitem_l_shipmode#7832,cval_lineitem_l_comment#7833,cval_lineitem_l_shipdate#7834,cdepval_lineitem_l_quantity#7835,cdepval_lineitem_l_extendedprice#7836,cdepval_lineitem_l_discount#7837,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2376ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/26 22:23:31 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:23:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7961L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 22:23:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:23:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:23:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7961L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#7963 AS rid_0#8008, cpfk_orders_lineitem#7964 AS cpfk_orders_lineitem_0#8009, cpfk_supplier_lineitem#7965 AS cpfk_supplier_lineitem_0#8010, cfpk_lineitem_supplier#7966 AS cfpk_lineitem_supplier_0#8011, cfpk_lineitem_partsupp#7967 AS cfpk_lineitem_partsupp_0#8012, cpfk_part_lineitem#7968 AS cpfk_part_lineitem_0#8013, cfpk_lineitem_part#7969 AS cfpk_lineitem_part_0#8014, cpfk_partsupp_lineitem#7970 AS cpfk_partsupp_lineitem_0#8015, cfpk_lineitem_orders#7971 AS cfpk_lineitem_orders_0#8016, cval_lineitem_l_quantity#7972 AS cval_lineitem_l_quantity_0#8017, cval_lineitem_l_extendedprice#7973 AS cval_lineitem_l_extendedprice_0#8018, cval_lineitem_l_discount#7974 AS cval_lineitem_l_discount_0#8019, cval_lineitem_l_tax#7975 AS cval_lineitem_l_tax_0#8020, cval_lineitem_l_returnflag#7976 AS cval_lineitem_l_returnflag_0#8021, cval_lineitem_l_linestatus#7977 AS cval_lineitem_l_linestatus_0#8022, cval_lineitem_l_commitdate#7978 AS cval_lineitem_l_commitdate_0#8023, cval_lineitem_l_receiptdate#7979 AS cval_lineitem_l_receiptdate_0#8024, cval_lineitem_l_shipinstruct#7980 AS cval_lineitem_l_shipinstruct_0#8025, cval_lineitem_l_shipmode#7981 AS cval_lineitem_l_shipmode_0#8026, cval_lineitem_l_comment#7982 AS cval_lineitem_l_comment_0#8027, cval_lineitem_l_shipdate#7983 AS cval_lineitem_l_shipdate_0#8028, cdepval_lineitem_l_quantity#7984 AS cdepval_lineitem_l_quantity_0#8029, cdepval_lineitem_l_extendedprice#7985 AS cdepval_lineitem_l_extendedprice_0#8030, cdepval_lineitem_l_discount#7986 AS cdepval_lineitem_l_discount_0#8031, ... 21 more fields]
         :  :  :     +- Relation[rid#7963,cpfk_orders_lineitem#7964,cpfk_supplier_lineitem#7965,cfpk_lineitem_supplier#7966,cfpk_lineitem_partsupp#7967,cpfk_part_lineitem#7968,cfpk_lineitem_part#7969,cpfk_partsupp_lineitem#7970,cfpk_lineitem_orders#7971,cval_lineitem_l_quantity#7972,cval_lineitem_l_extendedprice#7973,cval_lineitem_l_discount#7974,cval_lineitem_l_tax#7975,cval_lineitem_l_returnflag#7976,cval_lineitem_l_linestatus#7977,cval_lineitem_l_commitdate#7978,cval_lineitem_l_receiptdate#7979,cval_lineitem_l_shipinstruct#7980,cval_lineitem_l_shipmode#7981,cval_lineitem_l_comment#7982,cval_lineitem_l_shipdate#7983,cdepval_lineitem_l_quantity#7984,cdepval_lineitem_l_extendedprice#7985,cdepval_lineitem_l_discount#7986,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#8143 AS rid_1#8167, cpfk_customer_orders#8144 AS cpfk_customer_orders_1#8168, cfpk_orders_customer#8145 AS cfpk_orders_customer_1#8169, cval_orders_o_orderstatus#8146 AS cval_orders_o_orderstatus_1#8170, cval_orders_o_totalprice#8147 AS cval_orders_o_totalprice_1#8171, cval_orders_o_orderpriority#8148 AS cval_orders_o_orderpriority_1#8172, cval_orders_o_clerk#8149 AS cval_orders_o_clerk_1#8173, cval_orders_o_shippriority#8150 AS cval_orders_o_shippriority_1#8174, cval_orders_o_comment#8151 AS cval_orders_o_comment_1#8175, cval_orders_o_orderdate#8152 AS cval_orders_o_orderdate_1#8176, cdepval_orders_o_orderstatus#8153 AS cdepval_orders_o_orderstatus_1#8177, cdepval_orders_o_totalprice#8154 AS cdepval_orders_o_totalprice_1#8178, cdepval_orders_o_orderpriority#8155 AS cdepval_orders_o_orderpriority_1#8179, cdepval_orders_o_clerk#8156 AS cdepval_orders_o_clerk_1#8180, cdepval_orders_o_shippriority#8157 AS cdepval_orders_o_shippriority_1#8181, cdepval_orders_o_comment#8158 AS cdepval_orders_o_comment_1#8182, cdepval_orders_o_orderdate#8159 AS cdepval_orders_o_orderdate_1#8183, co_orderstatus#8160 AS co_orderstatus_1#8184, co_totalprice#8161 AS co_totalprice_1#8185, co_orderpriority#8162 AS co_orderpriority_1#8186, co_clerk#8163 AS co_clerk_1#8187, co_shippriority#8164 AS co_shippriority_1#8188, co_comment#8165 AS co_comment_1#8189, co_orderdate#8166 AS co_orderdate_1#8190]
         :  :     +- Relation[rid#8143,cpfk_customer_orders#8144,cfpk_orders_customer#8145,cval_orders_o_orderstatus#8146,cval_orders_o_totalprice#8147,cval_orders_o_orderpriority#8148,cval_orders_o_clerk#8149,cval_orders_o_shippriority#8150,cval_orders_o_comment#8151,cval_orders_o_orderdate#8152,cdepval_orders_o_orderstatus#8153,cdepval_orders_o_totalprice#8154,cdepval_orders_o_orderpriority#8155,cdepval_orders_o_clerk#8156,cdepval_orders_o_shippriority#8157,cdepval_orders_o_comment#8158,cdepval_orders_o_orderdate#8159,co_orderstatus#8160,co_totalprice#8161,co_orderpriority#8162,co_clerk#8163,co_shippriority#8164,co_comment#8165,co_orderdate#8166] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#8191 AS rid_2#8212, cpfk_nation_customer#8192 AS cpfk_nation_customer_2#8213, cfpk_customer_nation#8193 AS cfpk_customer_nation_2#8214, cval_customer_c_name#8194 AS cval_customer_c_name_2#8215, cval_customer_c_address#8195 AS cval_customer_c_address_2#8216, cval_customer_c_phone#8196 AS cval_customer_c_phone_2#8217, cval_customer_c_acctbal#8197 AS cval_customer_c_acctbal_2#8218, cval_customer_c_comment#8198 AS cval_customer_c_comment_2#8219, cval_customer_c_mktsegment#8199 AS cval_customer_c_mktsegment_2#8220, cdepval_customer_c_name#8200 AS cdepval_customer_c_name_2#8221, cdepval_customer_c_address#8201 AS cdepval_customer_c_address_2#8222, cdepval_customer_c_phone#8202 AS cdepval_customer_c_phone_2#8223, cdepval_customer_c_acctbal#8203 AS cdepval_customer_c_acctbal_2#8224, cdepval_customer_c_comment#8204 AS cdepval_customer_c_comment_2#8225, cdepval_customer_c_mktsegment#8205 AS cdepval_customer_c_mktsegment_2#8226, cc_name#8206 AS cc_name_2#8227, cc_address#8207 AS cc_address_2#8228, cc_phone#8208 AS cc_phone_2#8229, cc_acctbal#8209 AS cc_acctbal_2#8230, cc_comment#8210 AS cc_comment_2#8231, cc_mktsegment#8211 AS cc_mktsegment_2#8232]
         :     +- Relation[rid#8191,cpfk_nation_customer#8192,cfpk_customer_nation#8193,cval_customer_c_name#8194,cval_customer_c_address#8195,cval_customer_c_phone#8196,cval_customer_c_acctbal#8197,cval_customer_c_comment#8198,cval_customer_c_mktsegment#8199,cdepval_customer_c_name#8200,cdepval_customer_c_address#8201,cdepval_customer_c_phone#8202,cdepval_customer_c_acctbal#8203,cdepval_customer_c_comment#8204,cdepval_customer_c_mktsegment#8205,cc_name#8206,cc_address#8207,cc_phone#8208,cc_acctbal#8209,cc_comment#8210,cc_mktsegment#8211] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#8233 AS rid_3#8242, cpfk_region_nation#8234 AS cpfk_region_nation_3#8243, cfpk_nation_region#8235 AS cfpk_nation_region_3#8244, cval_nation_n_name#8236 AS cval_nation_n_name_3#8245, cval_nation_n_comment#8237 AS cval_nation_n_comment_3#8246, cdepval_nation_n_name#8238 AS cdepval_nation_n_name_3#8247, cdepval_nation_n_comment#8239 AS cdepval_nation_n_comment_3#8248, cn_name#8240 AS cn_name_3#8249, cn_comment#8241 AS cn_comment_3#8250]
            +- Relation[rid#8233,cpfk_region_nation#8234,cfpk_nation_region#8235,cval_nation_n_name#8236,cval_nation_n_comment#8237,cdepval_nation_n_name#8238,cdepval_nation_n_comment#8239,cn_name#8240,cn_comment#8241] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 61208ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/26 22:24:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:24:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8355L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:24:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#8355L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#8357 AS rid_0#8402, cpfk_orders_lineitem#8358 AS cpfk_orders_lineitem_0#8403, cpfk_supplier_lineitem#8359 AS cpfk_supplier_lineitem_0#8404, cfpk_lineitem_supplier#8360 AS cfpk_lineitem_supplier_0#8405, cfpk_lineitem_partsupp#8361 AS cfpk_lineitem_partsupp_0#8406, cpfk_part_lineitem#8362 AS cpfk_part_lineitem_0#8407, cfpk_lineitem_part#8363 AS cfpk_lineitem_part_0#8408, cpfk_partsupp_lineitem#8364 AS cpfk_partsupp_lineitem_0#8409, cfpk_lineitem_orders#8365 AS cfpk_lineitem_orders_0#8410, cval_lineitem_l_quantity#8366 AS cval_lineitem_l_quantity_0#8411, cval_lineitem_l_extendedprice#8367 AS cval_lineitem_l_extendedprice_0#8412, cval_lineitem_l_discount#8368 AS cval_lineitem_l_discount_0#8413, cval_lineitem_l_tax#8369 AS cval_lineitem_l_tax_0#8414, cval_lineitem_l_returnflag#8370 AS cval_lineitem_l_returnflag_0#8415, cval_lineitem_l_linestatus#8371 AS cval_lineitem_l_linestatus_0#8416, cval_lineitem_l_commitdate#8372 AS cval_lineitem_l_commitdate_0#8417, cval_lineitem_l_receiptdate#8373 AS cval_lineitem_l_receiptdate_0#8418, cval_lineitem_l_shipinstruct#8374 AS cval_lineitem_l_shipinstruct_0#8419, cval_lineitem_l_shipmode#8375 AS cval_lineitem_l_shipmode_0#8420, cval_lineitem_l_comment#8376 AS cval_lineitem_l_comment_0#8421, cval_lineitem_l_shipdate#8377 AS cval_lineitem_l_shipdate_0#8422, cdepval_lineitem_l_quantity#8378 AS cdepval_lineitem_l_quantity_0#8423, cdepval_lineitem_l_extendedprice#8379 AS cdepval_lineitem_l_extendedprice_0#8424, cdepval_lineitem_l_discount#8380 AS cdepval_lineitem_l_discount_0#8425, ... 21 more fields]
         +- Relation[rid#8357,cpfk_orders_lineitem#8358,cpfk_supplier_lineitem#8359,cfpk_lineitem_supplier#8360,cfpk_lineitem_partsupp#8361,cpfk_part_lineitem#8362,cfpk_lineitem_part#8363,cpfk_partsupp_lineitem#8364,cfpk_lineitem_orders#8365,cval_lineitem_l_quantity#8366,cval_lineitem_l_extendedprice#8367,cval_lineitem_l_discount#8368,cval_lineitem_l_tax#8369,cval_lineitem_l_returnflag#8370,cval_lineitem_l_linestatus#8371,cval_lineitem_l_commitdate#8372,cval_lineitem_l_receiptdate#8373,cval_lineitem_l_shipinstruct#8374,cval_lineitem_l_shipmode#8375,cval_lineitem_l_comment#8376,cval_lineitem_l_shipdate#8377,cdepval_lineitem_l_quantity#8378,cdepval_lineitem_l_extendedprice#8379,cdepval_lineitem_l_discount#8380,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2324ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/26 22:24:34 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:24:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8496L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:24:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8496L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#8498 AS rid_0#8543, cpfk_orders_lineitem#8499 AS cpfk_orders_lineitem_0#8544, cpfk_supplier_lineitem#8500 AS cpfk_supplier_lineitem_0#8545, cfpk_lineitem_supplier#8501 AS cfpk_lineitem_supplier_0#8546, cfpk_lineitem_partsupp#8502 AS cfpk_lineitem_partsupp_0#8547, cpfk_part_lineitem#8503 AS cpfk_part_lineitem_0#8548, cfpk_lineitem_part#8504 AS cfpk_lineitem_part_0#8549, cpfk_partsupp_lineitem#8505 AS cpfk_partsupp_lineitem_0#8550, cfpk_lineitem_orders#8506 AS cfpk_lineitem_orders_0#8551, cval_lineitem_l_quantity#8507 AS cval_lineitem_l_quantity_0#8552, cval_lineitem_l_extendedprice#8508 AS cval_lineitem_l_extendedprice_0#8553, cval_lineitem_l_discount#8509 AS cval_lineitem_l_discount_0#8554, cval_lineitem_l_tax#8510 AS cval_lineitem_l_tax_0#8555, cval_lineitem_l_returnflag#8511 AS cval_lineitem_l_returnflag_0#8556, cval_lineitem_l_linestatus#8512 AS cval_lineitem_l_linestatus_0#8557, cval_lineitem_l_commitdate#8513 AS cval_lineitem_l_commitdate_0#8558, cval_lineitem_l_receiptdate#8514 AS cval_lineitem_l_receiptdate_0#8559, cval_lineitem_l_shipinstruct#8515 AS cval_lineitem_l_shipinstruct_0#8560, cval_lineitem_l_shipmode#8516 AS cval_lineitem_l_shipmode_0#8561, cval_lineitem_l_comment#8517 AS cval_lineitem_l_comment_0#8562, cval_lineitem_l_shipdate#8518 AS cval_lineitem_l_shipdate_0#8563, cdepval_lineitem_l_quantity#8519 AS cdepval_lineitem_l_quantity_0#8564, cdepval_lineitem_l_extendedprice#8520 AS cdepval_lineitem_l_extendedprice_0#8565, cdepval_lineitem_l_discount#8521 AS cdepval_lineitem_l_discount_0#8566, ... 21 more fields]
         :     +- Relation[rid#8498,cpfk_orders_lineitem#8499,cpfk_supplier_lineitem#8500,cfpk_lineitem_supplier#8501,cfpk_lineitem_partsupp#8502,cpfk_part_lineitem#8503,cfpk_lineitem_part#8504,cpfk_partsupp_lineitem#8505,cfpk_lineitem_orders#8506,cval_lineitem_l_quantity#8507,cval_lineitem_l_extendedprice#8508,cval_lineitem_l_discount#8509,cval_lineitem_l_tax#8510,cval_lineitem_l_returnflag#8511,cval_lineitem_l_linestatus#8512,cval_lineitem_l_commitdate#8513,cval_lineitem_l_receiptdate#8514,cval_lineitem_l_shipinstruct#8515,cval_lineitem_l_shipmode#8516,cval_lineitem_l_comment#8517,cval_lineitem_l_shipdate#8518,cdepval_lineitem_l_quantity#8519,cdepval_lineitem_l_extendedprice#8520,cdepval_lineitem_l_discount#8521,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8678 AS rid_1#8702, cpfk_customer_orders#8679 AS cpfk_customer_orders_1#8703, cfpk_orders_customer#8680 AS cfpk_orders_customer_1#8704, cval_orders_o_orderstatus#8681 AS cval_orders_o_orderstatus_1#8705, cval_orders_o_totalprice#8682 AS cval_orders_o_totalprice_1#8706, cval_orders_o_orderpriority#8683 AS cval_orders_o_orderpriority_1#8707, cval_orders_o_clerk#8684 AS cval_orders_o_clerk_1#8708, cval_orders_o_shippriority#8685 AS cval_orders_o_shippriority_1#8709, cval_orders_o_comment#8686 AS cval_orders_o_comment_1#8710, cval_orders_o_orderdate#8687 AS cval_orders_o_orderdate_1#8711, cdepval_orders_o_orderstatus#8688 AS cdepval_orders_o_orderstatus_1#8712, cdepval_orders_o_totalprice#8689 AS cdepval_orders_o_totalprice_1#8713, cdepval_orders_o_orderpriority#8690 AS cdepval_orders_o_orderpriority_1#8714, cdepval_orders_o_clerk#8691 AS cdepval_orders_o_clerk_1#8715, cdepval_orders_o_shippriority#8692 AS cdepval_orders_o_shippriority_1#8716, cdepval_orders_o_comment#8693 AS cdepval_orders_o_comment_1#8717, cdepval_orders_o_orderdate#8694 AS cdepval_orders_o_orderdate_1#8718, co_orderstatus#8695 AS co_orderstatus_1#8719, co_totalprice#8696 AS co_totalprice_1#8720, co_orderpriority#8697 AS co_orderpriority_1#8721, co_clerk#8698 AS co_clerk_1#8722, co_shippriority#8699 AS co_shippriority_1#8723, co_comment#8700 AS co_comment_1#8724, co_orderdate#8701 AS co_orderdate_1#8725]
            +- Relation[rid#8678,cpfk_customer_orders#8679,cfpk_orders_customer#8680,cval_orders_o_orderstatus#8681,cval_orders_o_totalprice#8682,cval_orders_o_orderpriority#8683,cval_orders_o_clerk#8684,cval_orders_o_shippriority#8685,cval_orders_o_comment#8686,cval_orders_o_orderdate#8687,cdepval_orders_o_orderstatus#8688,cdepval_orders_o_totalprice#8689,cdepval_orders_o_orderpriority#8690,cdepval_orders_o_clerk#8691,cdepval_orders_o_shippriority#8692,cdepval_orders_o_comment#8693,cdepval_orders_o_orderdate#8694,co_orderstatus#8695,co_totalprice#8696,co_orderpriority#8697,co_clerk#8698,co_shippriority#8699,co_comment#8700,co_orderdate#8701] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 21791ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/26 22:24:56 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:24:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8803L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:24:56 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:24:56 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:24:56 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:24:56 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:24:56 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:24:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8803L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#9027 AS rid_2#9072, cpfk_orders_lineitem#9028 AS cpfk_orders_lineitem_2#9073, cpfk_supplier_lineitem#9029 AS cpfk_supplier_lineitem_2#9074, cfpk_lineitem_supplier#9030 AS cfpk_lineitem_supplier_2#9075, cfpk_lineitem_partsupp#9031 AS cfpk_lineitem_partsupp_2#9076, cpfk_part_lineitem#9032 AS cpfk_part_lineitem_2#9077, cfpk_lineitem_part#9033 AS cfpk_lineitem_part_2#9078, cpfk_partsupp_lineitem#9034 AS cpfk_partsupp_lineitem_2#9079, cfpk_lineitem_orders#9035 AS cfpk_lineitem_orders_2#9080, cval_lineitem_l_quantity#9036 AS cval_lineitem_l_quantity_2#9081, cval_lineitem_l_extendedprice#9037 AS cval_lineitem_l_extendedprice_2#9082, cval_lineitem_l_discount#9038 AS cval_lineitem_l_discount_2#9083, cval_lineitem_l_tax#9039 AS cval_lineitem_l_tax_2#9084, cval_lineitem_l_returnflag#9040 AS cval_lineitem_l_returnflag_2#9085, cval_lineitem_l_linestatus#9041 AS cval_lineitem_l_linestatus_2#9086, cval_lineitem_l_commitdate#9042 AS cval_lineitem_l_commitdate_2#9087, cval_lineitem_l_receiptdate#9043 AS cval_lineitem_l_receiptdate_2#9088, cval_lineitem_l_shipinstruct#9044 AS cval_lineitem_l_shipinstruct_2#9089, cval_lineitem_l_shipmode#9045 AS cval_lineitem_l_shipmode_2#9090, cval_lineitem_l_comment#9046 AS cval_lineitem_l_comment_2#9091, cval_lineitem_l_shipdate#9047 AS cval_lineitem_l_shipdate_2#9092, cdepval_lineitem_l_quantity#9048 AS cdepval_lineitem_l_quantity_2#9093, cdepval_lineitem_l_extendedprice#9049 AS cdepval_lineitem_l_extendedprice_2#9094, cdepval_lineitem_l_discount#9050 AS cdepval_lineitem_l_discount_2#9095, ... 21 more fields]
         :  +- Relation[rid#9027,cpfk_orders_lineitem#9028,cpfk_supplier_lineitem#9029,cfpk_lineitem_supplier#9030,cfpk_lineitem_partsupp#9031,cpfk_part_lineitem#9032,cfpk_lineitem_part#9033,cpfk_partsupp_lineitem#9034,cfpk_lineitem_orders#9035,cval_lineitem_l_quantity#9036,cval_lineitem_l_extendedprice#9037,cval_lineitem_l_discount#9038,cval_lineitem_l_tax#9039,cval_lineitem_l_returnflag#9040,cval_lineitem_l_linestatus#9041,cval_lineitem_l_commitdate#9042,cval_lineitem_l_receiptdate#9043,cval_lineitem_l_shipinstruct#9044,cval_lineitem_l_shipmode#9045,cval_lineitem_l_comment#9046,cval_lineitem_l_shipdate#9047,cdepval_lineitem_l_quantity#9048,cdepval_lineitem_l_extendedprice#9049,cdepval_lineitem_l_discount#9050,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin customer~orders, 'cpfk_customer_orders_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#8826, cpfk_nation_customer_0#8827, cfpk_customer_nation_0#8828, cval_customer_c_name_0#8829, cval_customer_c_address_0#8830, cval_customer_c_phone_0#8831, cval_customer_c_acctbal_0#8832, cval_customer_c_comment_0#8833, cval_customer_c_mktsegment_0#8834, cdepval_customer_c_name_0#8835, cdepval_customer_c_address_0#8836, cdepval_customer_c_phone_0#8837, cdepval_customer_c_acctbal_0#8838, cdepval_customer_c_comment_0#8839, cdepval_customer_c_mktsegment_0#8840, cc_name_0#8841, cc_address_0#8842, cc_phone_0#8843, cc_acctbal_0#8844, cc_comment_0#8845, cc_mktsegment_0#8846, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
            :  :  +- Project [rid#8805 AS rid_0#8826, cpfk_nation_customer#8806 AS cpfk_nation_customer_0#8827, cfpk_customer_nation#8807 AS cfpk_customer_nation_0#8828, cval_customer_c_name#8808 AS cval_customer_c_name_0#8829, cval_customer_c_address#8809 AS cval_customer_c_address_0#8830, cval_customer_c_phone#8810 AS cval_customer_c_phone_0#8831, cval_customer_c_acctbal#8811 AS cval_customer_c_acctbal_0#8832, cval_customer_c_comment#8812 AS cval_customer_c_comment_0#8833, cval_customer_c_mktsegment#8813 AS cval_customer_c_mktsegment_0#8834, cdepval_customer_c_name#8814 AS cdepval_customer_c_name_0#8835, cdepval_customer_c_address#8815 AS cdepval_customer_c_address_0#8836, cdepval_customer_c_phone#8816 AS cdepval_customer_c_phone_0#8837, cdepval_customer_c_acctbal#8817 AS cdepval_customer_c_acctbal_0#8838, cdepval_customer_c_comment#8818 AS cdepval_customer_c_comment_0#8839, cdepval_customer_c_mktsegment#8819 AS cdepval_customer_c_mktsegment_0#8840, cc_name#8820 AS cc_name_0#8841, cc_address#8821 AS cc_address_0#8842, cc_phone#8822 AS cc_phone_0#8843, cc_acctbal#8823 AS cc_acctbal_0#8844, cc_comment#8824 AS cc_comment_0#8845, cc_mktsegment#8825 AS cc_mktsegment_0#8846]
            :  :     +- Relation[rid#8805,cpfk_nation_customer#8806,cfpk_customer_nation#8807,cval_customer_c_name#8808,cval_customer_c_address#8809,cval_customer_c_phone#8810,cval_customer_c_acctbal#8811,cval_customer_c_comment#8812,cval_customer_c_mktsegment#8813,cdepval_customer_c_name#8814,cdepval_customer_c_address#8815,cdepval_customer_c_phone#8816,cdepval_customer_c_acctbal#8817,cdepval_customer_c_comment#8818,cdepval_customer_c_mktsegment#8819,cc_name#8820,cc_address#8821,cc_phone#8822,cc_acctbal#8823,cc_comment#8824,cc_mktsegment#8825] JDBCRelation(tcustomer) [numPartitions=1]
            :  +- 'Project ['cpfk_customer_orders_1, 'rid_1]
            :     +- Project [rid#8979 AS rid_1#9003, cpfk_customer_orders#8980 AS cpfk_customer_orders_1#9004, cfpk_orders_customer#8981 AS cfpk_orders_customer_1#9005, cval_orders_o_orderstatus#8982 AS cval_orders_o_orderstatus_1#9006, cval_orders_o_totalprice#8983 AS cval_orders_o_totalprice_1#9007, cval_orders_o_orderpriority#8984 AS cval_orders_o_orderpriority_1#9008, cval_orders_o_clerk#8985 AS cval_orders_o_clerk_1#9009, cval_orders_o_shippriority#8986 AS cval_orders_o_shippriority_1#9010, cval_orders_o_comment#8987 AS cval_orders_o_comment_1#9011, cval_orders_o_orderdate#8988 AS cval_orders_o_orderdate_1#9012, cdepval_orders_o_orderstatus#8989 AS cdepval_orders_o_orderstatus_1#9013, cdepval_orders_o_totalprice#8990 AS cdepval_orders_o_totalprice_1#9014, cdepval_orders_o_orderpriority#8991 AS cdepval_orders_o_orderpriority_1#9015, cdepval_orders_o_clerk#8992 AS cdepval_orders_o_clerk_1#9016, cdepval_orders_o_shippriority#8993 AS cdepval_orders_o_shippriority_1#9017, cdepval_orders_o_comment#8994 AS cdepval_orders_o_comment_1#9018, cdepval_orders_o_orderdate#8995 AS cdepval_orders_o_orderdate_1#9019, co_orderstatus#8996 AS co_orderstatus_1#9020, co_totalprice#8997 AS co_totalprice_1#9021, co_orderpriority#8998 AS co_orderpriority_1#9022, co_clerk#8999 AS co_clerk_1#9023, co_shippriority#9000 AS co_shippriority_1#9024, co_comment#9001 AS co_comment_1#9025, co_orderdate#9002 AS co_orderdate_1#9026]
            :        +- Relation[rid#8979,cpfk_customer_orders#8980,cfpk_orders_customer#8981,cval_orders_o_orderstatus#8982,cval_orders_o_totalprice#8983,cval_orders_o_orderpriority#8984,cval_orders_o_clerk#8985,cval_orders_o_shippriority#8986,cval_orders_o_comment#8987,cval_orders_o_orderdate#8988,cdepval_orders_o_orderstatus#8989,cdepval_orders_o_totalprice#8990,cdepval_orders_o_orderpriority#8991,cdepval_orders_o_clerk#8992,cdepval_orders_o_shippriority#8993,cdepval_orders_o_comment#8994,cdepval_orders_o_orderdate#8995,co_orderstatus#8996,co_totalprice#8997,co_orderpriority#8998,co_clerk#8999,co_shippriority#9000,co_comment#9001,co_orderdate#9002] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#8889 AS rid_1#8913, cpfk_customer_orders#8890 AS cpfk_customer_orders_1#8914, cfpk_orders_customer#8891 AS cfpk_orders_customer_1#8915, cval_orders_o_orderstatus#8892 AS cval_orders_o_orderstatus_1#8916, cval_orders_o_totalprice#8893 AS cval_orders_o_totalprice_1#8917, cval_orders_o_orderpriority#8894 AS cval_orders_o_orderpriority_1#8918, cval_orders_o_clerk#8895 AS cval_orders_o_clerk_1#8919, cval_orders_o_shippriority#8896 AS cval_orders_o_shippriority_1#8920, cval_orders_o_comment#8897 AS cval_orders_o_comment_1#8921, cval_orders_o_orderdate#8898 AS cval_orders_o_orderdate_1#8922, cdepval_orders_o_orderstatus#8899 AS cdepval_orders_o_orderstatus_1#8923, cdepval_orders_o_totalprice#8900 AS cdepval_orders_o_totalprice_1#8924, cdepval_orders_o_orderpriority#8901 AS cdepval_orders_o_orderpriority_1#8925, cdepval_orders_o_clerk#8902 AS cdepval_orders_o_clerk_1#8926, cdepval_orders_o_shippriority#8903 AS cdepval_orders_o_shippriority_1#8927, cdepval_orders_o_comment#8904 AS cdepval_orders_o_comment_1#8928, cdepval_orders_o_orderdate#8905 AS cdepval_orders_o_orderdate_1#8929, co_orderstatus#8906 AS co_orderstatus_1#8930, co_totalprice#8907 AS co_totalprice_1#8931, co_orderpriority#8908 AS co_orderpriority_1#8932, co_clerk#8909 AS co_clerk_1#8933, co_shippriority#8910 AS co_shippriority_1#8934, co_comment#8911 AS co_comment_1#8935, co_orderdate#8912 AS co_orderdate_1#8936]
               +- Relation[rid#8889,cpfk_customer_orders#8890,cfpk_orders_customer#8891,cval_orders_o_orderstatus#8892,cval_orders_o_totalprice#8893,cval_orders_o_orderpriority#8894,cval_orders_o_clerk#8895,cval_orders_o_shippriority#8896,cval_orders_o_comment#8897,cval_orders_o_orderdate#8898,cdepval_orders_o_orderstatus#8899,cdepval_orders_o_totalprice#8900,cdepval_orders_o_orderpriority#8901,cdepval_orders_o_clerk#8902,cdepval_orders_o_shippriority#8903,cdepval_orders_o_comment#8904,cdepval_orders_o_orderdate#8905,co_orderstatus#8906,co_totalprice#8907,co_orderpriority#8908,co_clerk#8909,co_shippriority#8910,co_comment#8911,co_orderdate#8912] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 24550ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/26 22:25:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:25:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9213L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 22:25:21 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:25:21 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:25:21 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:25:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:25:21 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:25:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:25:21 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:25:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:25:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:25:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:25:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:25:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:25:21 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:25:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9213L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#9383 AS rid_4#9428, cpfk_orders_lineitem#9384 AS cpfk_orders_lineitem_4#9429, cpfk_supplier_lineitem#9385 AS cpfk_supplier_lineitem_4#9430, cfpk_lineitem_supplier#9386 AS cfpk_lineitem_supplier_4#9431, cfpk_lineitem_partsupp#9387 AS cfpk_lineitem_partsupp_4#9432, cpfk_part_lineitem#9388 AS cpfk_part_lineitem_4#9433, cfpk_lineitem_part#9389 AS cfpk_lineitem_part_4#9434, cpfk_partsupp_lineitem#9390 AS cpfk_partsupp_lineitem_4#9435, cfpk_lineitem_orders#9391 AS cfpk_lineitem_orders_4#9436, cval_lineitem_l_quantity#9392 AS cval_lineitem_l_quantity_4#9437, cval_lineitem_l_extendedprice#9393 AS cval_lineitem_l_extendedprice_4#9438, cval_lineitem_l_discount#9394 AS cval_lineitem_l_discount_4#9439, cval_lineitem_l_tax#9395 AS cval_lineitem_l_tax_4#9440, cval_lineitem_l_returnflag#9396 AS cval_lineitem_l_returnflag_4#9441, cval_lineitem_l_linestatus#9397 AS cval_lineitem_l_linestatus_4#9442, cval_lineitem_l_commitdate#9398 AS cval_lineitem_l_commitdate_4#9443, cval_lineitem_l_receiptdate#9399 AS cval_lineitem_l_receiptdate_4#9444, cval_lineitem_l_shipinstruct#9400 AS cval_lineitem_l_shipinstruct_4#9445, cval_lineitem_l_shipmode#9401 AS cval_lineitem_l_shipmode_4#9446, cval_lineitem_l_comment#9402 AS cval_lineitem_l_comment_4#9447, cval_lineitem_l_shipdate#9403 AS cval_lineitem_l_shipdate_4#9448, cdepval_lineitem_l_quantity#9404 AS cdepval_lineitem_l_quantity_4#9449, cdepval_lineitem_l_extendedprice#9405 AS cdepval_lineitem_l_extendedprice_4#9450, cdepval_lineitem_l_discount#9406 AS cdepval_lineitem_l_discount_4#9451, ... 21 more fields]
            :  :  +- Relation[rid#9383,cpfk_orders_lineitem#9384,cpfk_supplier_lineitem#9385,cfpk_lineitem_supplier#9386,cfpk_lineitem_partsupp#9387,cpfk_part_lineitem#9388,cfpk_lineitem_part#9389,cpfk_partsupp_lineitem#9390,cfpk_lineitem_orders#9391,cval_lineitem_l_quantity#9392,cval_lineitem_l_extendedprice#9393,cval_lineitem_l_discount#9394,cval_lineitem_l_tax#9395,cval_lineitem_l_returnflag#9396,cval_lineitem_l_linestatus#9397,cval_lineitem_l_commitdate#9398,cval_lineitem_l_receiptdate#9399,cval_lineitem_l_shipinstruct#9400,cval_lineitem_l_shipmode#9401,cval_lineitem_l_comment#9402,cval_lineitem_l_shipdate#9403,cdepval_lineitem_l_quantity#9404,cdepval_lineitem_l_extendedprice#9405,cdepval_lineitem_l_discount#9406,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#9335 AS rid_3#9359, cpfk_customer_orders#9336 AS cpfk_customer_orders_3#9360, cfpk_orders_customer#9337 AS cfpk_orders_customer_3#9361, cval_orders_o_orderstatus#9338 AS cval_orders_o_orderstatus_3#9362, cval_orders_o_totalprice#9339 AS cval_orders_o_totalprice_3#9363, cval_orders_o_orderpriority#9340 AS cval_orders_o_orderpriority_3#9364, cval_orders_o_clerk#9341 AS cval_orders_o_clerk_3#9365, cval_orders_o_shippriority#9342 AS cval_orders_o_shippriority_3#9366, cval_orders_o_comment#9343 AS cval_orders_o_comment_3#9367, cval_orders_o_orderdate#9344 AS cval_orders_o_orderdate_3#9368, cdepval_orders_o_orderstatus#9345 AS cdepval_orders_o_orderstatus_3#9369, cdepval_orders_o_totalprice#9346 AS cdepval_orders_o_totalprice_3#9370, cdepval_orders_o_orderpriority#9347 AS cdepval_orders_o_orderpriority_3#9371, cdepval_orders_o_clerk#9348 AS cdepval_orders_o_clerk_3#9372, cdepval_orders_o_shippriority#9349 AS cdepval_orders_o_shippriority_3#9373, cdepval_orders_o_comment#9350 AS cdepval_orders_o_comment_3#9374, cdepval_orders_o_orderdate#9351 AS cdepval_orders_o_orderdate_3#9375, co_orderstatus#9352 AS co_orderstatus_3#9376, co_totalprice#9353 AS co_totalprice_3#9377, co_orderpriority#9354 AS co_orderpriority_3#9378, co_clerk#9355 AS co_clerk_3#9379, co_shippriority#9356 AS co_shippriority_3#9380, co_comment#9357 AS co_comment_3#9381, co_orderdate#9358 AS co_orderdate_3#9382]
            :     :  +- Relation[rid#9335,cpfk_customer_orders#9336,cfpk_orders_customer#9337,cval_orders_o_orderstatus#9338,cval_orders_o_totalprice#9339,cval_orders_o_orderpriority#9340,cval_orders_o_clerk#9341,cval_orders_o_shippriority#9342,cval_orders_o_comment#9343,cval_orders_o_orderdate#9344,cdepval_orders_o_orderstatus#9345,cdepval_orders_o_totalprice#9346,cdepval_orders_o_orderpriority#9347,cdepval_orders_o_clerk#9348,cdepval_orders_o_shippriority#9349,cdepval_orders_o_comment#9350,cdepval_orders_o_orderdate#9351,co_orderstatus#9352,co_totalprice#9353,co_orderpriority#9354,co_clerk#9355,co_shippriority#9356,co_comment#9357,co_orderdate#9358] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#9293 AS rid_2#9314, cpfk_nation_customer#9294 AS cpfk_nation_customer_2#9315, cfpk_customer_nation#9295 AS cfpk_customer_nation_2#9316, cval_customer_c_name#9296 AS cval_customer_c_name_2#9317, cval_customer_c_address#9297 AS cval_customer_c_address_2#9318, cval_customer_c_phone#9298 AS cval_customer_c_phone_2#9319, cval_customer_c_acctbal#9299 AS cval_customer_c_acctbal_2#9320, cval_customer_c_comment#9300 AS cval_customer_c_comment_2#9321, cval_customer_c_mktsegment#9301 AS cval_customer_c_mktsegment_2#9322, cdepval_customer_c_name#9302 AS cdepval_customer_c_name_2#9323, cdepval_customer_c_address#9303 AS cdepval_customer_c_address_2#9324, cdepval_customer_c_phone#9304 AS cdepval_customer_c_phone_2#9325, cdepval_customer_c_acctbal#9305 AS cdepval_customer_c_acctbal_2#9326, cdepval_customer_c_comment#9306 AS cdepval_customer_c_comment_2#9327, cdepval_customer_c_mktsegment#9307 AS cdepval_customer_c_mktsegment_2#9328, cc_name#9308 AS cc_name_2#9329, cc_address#9309 AS cc_address_2#9330, cc_phone#9310 AS cc_phone_2#9331, cc_acctbal#9311 AS cc_acctbal_2#9332, cc_comment#9312 AS cc_comment_2#9333, cc_mktsegment#9313 AS cc_mktsegment_2#9334]
            :        :  +- Relation[rid#9293,cpfk_nation_customer#9294,cfpk_customer_nation#9295,cval_customer_c_name#9296,cval_customer_c_address#9297,cval_customer_c_phone#9298,cval_customer_c_acctbal#9299,cval_customer_c_comment#9300,cval_customer_c_mktsegment#9301,cdepval_customer_c_name#9302,cdepval_customer_c_address#9303,cdepval_customer_c_phone#9304,cdepval_customer_c_acctbal#9305,cdepval_customer_c_comment#9306,cdepval_customer_c_mktsegment#9307,cc_name#9308,cc_address#9309,cc_phone#9310,cc_acctbal#9311,cc_comment#9312,cc_mktsegment#9313] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join UsingJoin(Inner,List(rid_1))
            :           :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#9222, cval_region_r_name_0#9223, cval_region_r_comment_0#9224, cdepval_region_r_name_0#9225, cdepval_region_r_comment_0#9226, cr_name_0#9227, cr_comment_0#9228, 'rid_1]
            :           :  :- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :           :  :  +- Project [rid#9215 AS rid_0#9222, cval_region_r_name#9216 AS cval_region_r_name_0#9223, cval_region_r_comment#9217 AS cval_region_r_comment_0#9224, cdepval_region_r_name#9218 AS cdepval_region_r_name_0#9225, cdepval_region_r_comment#9219 AS cdepval_region_r_comment_0#9226, cr_name#9220 AS cr_name_0#9227, cr_comment#9221 AS cr_comment_0#9228]
            :           :  :     +- Relation[rid#9215,cval_region_r_name#9216,cval_region_r_comment#9217,cdepval_region_r_name#9218,cdepval_region_r_comment#9219,cr_name#9220,cr_comment#9221] JDBCRelation(tregion) [numPartitions=1]
            :           :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
            :           :     +- Project [rid#9275 AS rid_1#9284, cpfk_region_nation#9276 AS cpfk_region_nation_1#9285, cfpk_nation_region#9277 AS cfpk_nation_region_1#9286, cval_nation_n_name#9278 AS cval_nation_n_name_1#9287, cval_nation_n_comment#9279 AS cval_nation_n_comment_1#9288, cdepval_nation_n_name#9280 AS cdepval_nation_n_name_1#9289, cdepval_nation_n_comment#9281 AS cdepval_nation_n_comment_1#9290, cn_name#9282 AS cn_name_1#9291, cn_comment#9283 AS cn_comment_1#9292]
            :           :        +- Relation[rid#9275,cpfk_region_nation#9276,cfpk_nation_region#9277,cval_nation_n_name#9278,cval_nation_n_comment#9279,cdepval_nation_n_name#9280,cdepval_nation_n_comment#9281,cn_name#9282,cn_comment#9283] JDBCRelation(tnation) [numPartitions=1]
            :           +- Project [rid#9243 AS rid_1#9252, cpfk_region_nation#9244 AS cpfk_region_nation_1#9253, cfpk_nation_region#9245 AS cfpk_nation_region_1#9254, cval_nation_n_name#9246 AS cval_nation_n_name_1#9255, cval_nation_n_comment#9247 AS cval_nation_n_comment_1#9256, cdepval_nation_n_name#9248 AS cdepval_nation_n_name_1#9257, cdepval_nation_n_comment#9249 AS cdepval_nation_n_comment_1#9258, cn_name#9250 AS cn_name_1#9259, cn_comment#9251 AS cn_comment_1#9260]
            :              +- Relation[rid#9243,cpfk_region_nation#9244,cfpk_nation_region#9245,cval_nation_n_name#9246,cval_nation_n_comment#9247,cdepval_nation_n_name#9248,cdepval_nation_n_comment#9249,cn_name#9250,cn_comment#9251] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#9473 AS rid_5#9491, cpfk_nation_supplier#9474 AS cpfk_nation_supplier_5#9492, cfpk_supplier_nation#9475 AS cfpk_supplier_nation_5#9493, cval_supplier_s_name#9476 AS cval_supplier_s_name_5#9494, cval_supplier_s_address#9477 AS cval_supplier_s_address_5#9495, cval_supplier_s_phone#9478 AS cval_supplier_s_phone_5#9496, cval_supplier_s_acctbal#9479 AS cval_supplier_s_acctbal_5#9497, cval_supplier_s_comment#9480 AS cval_supplier_s_comment_5#9498, cdepval_supplier_s_name#9481 AS cdepval_supplier_s_name_5#9499, cdepval_supplier_s_address#9482 AS cdepval_supplier_s_address_5#9500, cdepval_supplier_s_phone#9483 AS cdepval_supplier_s_phone_5#9501, cdepval_supplier_s_acctbal#9484 AS cdepval_supplier_s_acctbal_5#9502, cdepval_supplier_s_comment#9485 AS cdepval_supplier_s_comment_5#9503, cs_name#9486 AS cs_name_5#9504, cs_address#9487 AS cs_address_5#9505, cs_phone#9488 AS cs_phone_5#9506, cs_acctbal#9489 AS cs_acctbal_5#9507, cs_comment#9490 AS cs_comment_5#9508]
               +- Relation[rid#9473,cpfk_nation_supplier#9474,cfpk_supplier_nation#9475,cval_supplier_s_name#9476,cval_supplier_s_address#9477,cval_supplier_s_phone#9478,cval_supplier_s_acctbal#9479,cval_supplier_s_comment#9480,cdepval_supplier_s_name#9481,cdepval_supplier_s_address#9482,cdepval_supplier_s_phone#9483,cdepval_supplier_s_acctbal#9484,cdepval_supplier_s_comment#9485,cs_name#9486,cs_address#9487,cs_phone#9488,cs_acctbal#9489,cs_comment#9490] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 29970ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 22:25:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:25:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9642L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:25:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:25:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:25:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:25:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:25:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:25:51 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:25:51 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:25:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9642L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#9698 AS rid_2#9743, cpfk_orders_lineitem#9699 AS cpfk_orders_lineitem_2#9744, cpfk_supplier_lineitem#9700 AS cpfk_supplier_lineitem_2#9745, cfpk_lineitem_supplier#9701 AS cfpk_lineitem_supplier_2#9746, cfpk_lineitem_partsupp#9702 AS cfpk_lineitem_partsupp_2#9747, cpfk_part_lineitem#9703 AS cpfk_part_lineitem_2#9748, cfpk_lineitem_part#9704 AS cfpk_lineitem_part_2#9749, cpfk_partsupp_lineitem#9705 AS cpfk_partsupp_lineitem_2#9750, cfpk_lineitem_orders#9706 AS cfpk_lineitem_orders_2#9751, cval_lineitem_l_quantity#9707 AS cval_lineitem_l_quantity_2#9752, cval_lineitem_l_extendedprice#9708 AS cval_lineitem_l_extendedprice_2#9753, cval_lineitem_l_discount#9709 AS cval_lineitem_l_discount_2#9754, cval_lineitem_l_tax#9710 AS cval_lineitem_l_tax_2#9755, cval_lineitem_l_returnflag#9711 AS cval_lineitem_l_returnflag_2#9756, cval_lineitem_l_linestatus#9712 AS cval_lineitem_l_linestatus_2#9757, cval_lineitem_l_commitdate#9713 AS cval_lineitem_l_commitdate_2#9758, cval_lineitem_l_receiptdate#9714 AS cval_lineitem_l_receiptdate_2#9759, cval_lineitem_l_shipinstruct#9715 AS cval_lineitem_l_shipinstruct_2#9760, cval_lineitem_l_shipmode#9716 AS cval_lineitem_l_shipmode_2#9761, cval_lineitem_l_comment#9717 AS cval_lineitem_l_comment_2#9762, cval_lineitem_l_shipdate#9718 AS cval_lineitem_l_shipdate_2#9763, cdepval_lineitem_l_quantity#9719 AS cdepval_lineitem_l_quantity_2#9764, cdepval_lineitem_l_extendedprice#9720 AS cdepval_lineitem_l_extendedprice_2#9765, cdepval_lineitem_l_discount#9721 AS cdepval_lineitem_l_discount_2#9766, ... 21 more fields]
         :  :  :  :  +- Relation[rid#9698,cpfk_orders_lineitem#9699,cpfk_supplier_lineitem#9700,cfpk_lineitem_supplier#9701,cfpk_lineitem_partsupp#9702,cpfk_part_lineitem#9703,cfpk_lineitem_part#9704,cpfk_partsupp_lineitem#9705,cfpk_lineitem_orders#9706,cval_lineitem_l_quantity#9707,cval_lineitem_l_extendedprice#9708,cval_lineitem_l_discount#9709,cval_lineitem_l_tax#9710,cval_lineitem_l_returnflag#9711,cval_lineitem_l_linestatus#9712,cval_lineitem_l_commitdate#9713,cval_lineitem_l_receiptdate#9714,cval_lineitem_l_shipinstruct#9715,cval_lineitem_l_shipmode#9716,cval_lineitem_l_comment#9717,cval_lineitem_l_shipdate#9718,cdepval_lineitem_l_quantity#9719,cdepval_lineitem_l_extendedprice#9720,cdepval_lineitem_l_discount#9721,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#9662 AS rid_1#9680, cpfk_nation_supplier#9663 AS cpfk_nation_supplier_1#9681, cfpk_supplier_nation#9664 AS cfpk_supplier_nation_1#9682, cval_supplier_s_name#9665 AS cval_supplier_s_name_1#9683, cval_supplier_s_address#9666 AS cval_supplier_s_address_1#9684, cval_supplier_s_phone#9667 AS cval_supplier_s_phone_1#9685, cval_supplier_s_acctbal#9668 AS cval_supplier_s_acctbal_1#9686, cval_supplier_s_comment#9669 AS cval_supplier_s_comment_1#9687, cdepval_supplier_s_name#9670 AS cdepval_supplier_s_name_1#9688, cdepval_supplier_s_address#9671 AS cdepval_supplier_s_address_1#9689, cdepval_supplier_s_phone#9672 AS cdepval_supplier_s_phone_1#9690, cdepval_supplier_s_acctbal#9673 AS cdepval_supplier_s_acctbal_1#9691, cdepval_supplier_s_comment#9674 AS cdepval_supplier_s_comment_1#9692, cs_name#9675 AS cs_name_1#9693, cs_address#9676 AS cs_address_1#9694, cs_phone#9677 AS cs_phone_1#9695, cs_acctbal#9678 AS cs_acctbal_1#9696, cs_comment#9679 AS cs_comment_1#9697]
         :  :  :     :  +- Relation[rid#9662,cpfk_nation_supplier#9663,cfpk_supplier_nation#9664,cval_supplier_s_name#9665,cval_supplier_s_address#9666,cval_supplier_s_phone#9667,cval_supplier_s_acctbal#9668,cval_supplier_s_comment#9669,cdepval_supplier_s_name#9670,cdepval_supplier_s_address#9671,cdepval_supplier_s_phone#9672,cdepval_supplier_s_acctbal#9673,cdepval_supplier_s_comment#9674,cs_name#9675,cs_address#9676,cs_phone#9677,cs_acctbal#9678,cs_comment#9679] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#9644 AS rid_0#9653, cpfk_region_nation#9645 AS cpfk_region_nation_0#9654, cfpk_nation_region#9646 AS cfpk_nation_region_0#9655, cval_nation_n_name#9647 AS cval_nation_n_name_0#9656, cval_nation_n_comment#9648 AS cval_nation_n_comment_0#9657, cdepval_nation_n_name#9649 AS cdepval_nation_n_name_0#9658, cdepval_nation_n_comment#9650 AS cdepval_nation_n_comment_0#9659, cn_name#9651 AS cn_name_0#9660, cn_comment#9652 AS cn_comment_0#9661]
         :  :  :        +- Relation[rid#9644,cpfk_region_nation#9645,cfpk_nation_region#9646,cval_nation_n_name#9647,cval_nation_n_comment#9648,cdepval_nation_n_name#9649,cdepval_nation_n_comment#9650,cn_name#9651,cn_comment#9652] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#9788 AS rid_3#9813, cval_part_p_name#9789 AS cval_part_p_name_3#9814, cval_part_p_mfgr#9790 AS cval_part_p_mfgr_3#9815, cval_part_p_type#9791 AS cval_part_p_type_3#9816, cval_part_p_size#9792 AS cval_part_p_size_3#9817, cval_part_p_container#9793 AS cval_part_p_container_3#9818, cval_part_p_retailprice#9794 AS cval_part_p_retailprice_3#9819, cval_part_p_comment#9795 AS cval_part_p_comment_3#9820, cval_part_p_brand#9796 AS cval_part_p_brand_3#9821, cdepval_part_p_name#9797 AS cdepval_part_p_name_3#9822, cdepval_part_p_mfgr#9798 AS cdepval_part_p_mfgr_3#9823, cdepval_part_p_type#9799 AS cdepval_part_p_type_3#9824, cdepval_part_p_size#9800 AS cdepval_part_p_size_3#9825, cdepval_part_p_container#9801 AS cdepval_part_p_container_3#9826, cdepval_part_p_retailprice#9802 AS cdepval_part_p_retailprice_3#9827, cdepval_part_p_comment#9803 AS cdepval_part_p_comment_3#9828, cdepval_part_p_brand#9804 AS cdepval_part_p_brand_3#9829, cp_name#9805 AS cp_name_3#9830, cp_mfgr#9806 AS cp_mfgr_3#9831, cp_type#9807 AS cp_type_3#9832, cp_size#9808 AS cp_size_3#9833, cp_container#9809 AS cp_container_3#9834, cp_retailprice#9810 AS cp_retailprice_3#9835, cp_comment#9811 AS cp_comment_3#9836, cp_brand#9812 AS cp_brand_3#9837]
         :  :     +- Relation[rid#9788,cval_part_p_name#9789,cval_part_p_mfgr#9790,cval_part_p_type#9791,cval_part_p_size#9792,cval_part_p_container#9793,cval_part_p_retailprice#9794,cval_part_p_comment#9795,cval_part_p_brand#9796,cdepval_part_p_name#9797,cdepval_part_p_mfgr#9798,cdepval_part_p_type#9799,cdepval_part_p_size#9800,cdepval_part_p_container#9801,cdepval_part_p_retailprice#9802,cdepval_part_p_comment#9803,cdepval_part_p_brand#9804,cp_name#9805,cp_mfgr#9806,cp_type#9807,cp_size#9808,cp_container#9809,cp_retailprice#9810,cp_comment#9811,cp_brand#9812] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#9838 AS rid_4#9852, cpfk_part_partsupp#9839 AS cpfk_part_partsupp_4#9853, cfpk_partsupp_part#9840 AS cfpk_partsupp_part_4#9854, cpfk_supplier_partsupp#9841 AS cpfk_supplier_partsupp_4#9855, cfpk_partsupp_supplier#9842 AS cfpk_partsupp_supplier_4#9856, cval_partsupp_ps_availqty#9843 AS cval_partsupp_ps_availqty_4#9857, cval_partsupp_ps_supplycost#9844 AS cval_partsupp_ps_supplycost_4#9858, cval_partsupp_ps_comment#9845 AS cval_partsupp_ps_comment_4#9859, cdepval_partsupp_ps_availqty#9846 AS cdepval_partsupp_ps_availqty_4#9860, cdepval_partsupp_ps_supplycost#9847 AS cdepval_partsupp_ps_supplycost_4#9861, cdepval_partsupp_ps_comment#9848 AS cdepval_partsupp_ps_comment_4#9862, cps_availqty#9849 AS cps_availqty_4#9863, cps_supplycost#9850 AS cps_supplycost_4#9864, cps_comment#9851 AS cps_comment_4#9865]
         :     +- Relation[rid#9838,cpfk_part_partsupp#9839,cfpk_partsupp_part#9840,cpfk_supplier_partsupp#9841,cfpk_partsupp_supplier#9842,cval_partsupp_ps_availqty#9843,cval_partsupp_ps_supplycost#9844,cval_partsupp_ps_comment#9845,cdepval_partsupp_ps_availqty#9846,cdepval_partsupp_ps_supplycost#9847,cdepval_partsupp_ps_comment#9848,cps_availqty#9849,cps_supplycost#9850,cps_comment#9851] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#9866 AS rid_5#9890, cpfk_customer_orders#9867 AS cpfk_customer_orders_5#9891, cfpk_orders_customer#9868 AS cfpk_orders_customer_5#9892, cval_orders_o_orderstatus#9869 AS cval_orders_o_orderstatus_5#9893, cval_orders_o_totalprice#9870 AS cval_orders_o_totalprice_5#9894, cval_orders_o_orderpriority#9871 AS cval_orders_o_orderpriority_5#9895, cval_orders_o_clerk#9872 AS cval_orders_o_clerk_5#9896, cval_orders_o_shippriority#9873 AS cval_orders_o_shippriority_5#9897, cval_orders_o_comment#9874 AS cval_orders_o_comment_5#9898, cval_orders_o_orderdate#9875 AS cval_orders_o_orderdate_5#9899, cdepval_orders_o_orderstatus#9876 AS cdepval_orders_o_orderstatus_5#9900, cdepval_orders_o_totalprice#9877 AS cdepval_orders_o_totalprice_5#9901, cdepval_orders_o_orderpriority#9878 AS cdepval_orders_o_orderpriority_5#9902, cdepval_orders_o_clerk#9879 AS cdepval_orders_o_clerk_5#9903, cdepval_orders_o_shippriority#9880 AS cdepval_orders_o_shippriority_5#9904, cdepval_orders_o_comment#9881 AS cdepval_orders_o_comment_5#9905, cdepval_orders_o_orderdate#9882 AS cdepval_orders_o_orderdate_5#9906, co_orderstatus#9883 AS co_orderstatus_5#9907, co_totalprice#9884 AS co_totalprice_5#9908, co_orderpriority#9885 AS co_orderpriority_5#9909, co_clerk#9886 AS co_clerk_5#9910, co_shippriority#9887 AS co_shippriority_5#9911, co_comment#9888 AS co_comment_5#9912, co_orderdate#9889 AS co_orderdate_5#9913]
            +- Relation[rid#9866,cpfk_customer_orders#9867,cfpk_orders_customer#9868,cval_orders_o_orderstatus#9869,cval_orders_o_totalprice#9870,cval_orders_o_orderpriority#9871,cval_orders_o_clerk#9872,cval_orders_o_shippriority#9873,cval_orders_o_comment#9874,cval_orders_o_orderdate#9875,cdepval_orders_o_orderstatus#9876,cdepval_orders_o_totalprice#9877,cdepval_orders_o_orderpriority#9878,cdepval_orders_o_clerk#9879,cdepval_orders_o_shippriority#9880,cdepval_orders_o_comment#9881,cdepval_orders_o_orderdate#9882,co_orderstatus#9883,co_totalprice#9884,co_orderpriority#9885,co_clerk#9886,co_shippriority#9887,co_comment#9888,co_orderdate#9889] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 63283ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/26 22:26:54 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:26:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#10056L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:26:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:26:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:26:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#10056L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#10094 AS rid_1#10139, cpfk_orders_lineitem#10095 AS cpfk_orders_lineitem_1#10140, cpfk_supplier_lineitem#10096 AS cpfk_supplier_lineitem_1#10141, cfpk_lineitem_supplier#10097 AS cfpk_lineitem_supplier_1#10142, cfpk_lineitem_partsupp#10098 AS cfpk_lineitem_partsupp_1#10143, cpfk_part_lineitem#10099 AS cpfk_part_lineitem_1#10144, cfpk_lineitem_part#10100 AS cfpk_lineitem_part_1#10145, cpfk_partsupp_lineitem#10101 AS cpfk_partsupp_lineitem_1#10146, cfpk_lineitem_orders#10102 AS cfpk_lineitem_orders_1#10147, cval_lineitem_l_quantity#10103 AS cval_lineitem_l_quantity_1#10148, cval_lineitem_l_extendedprice#10104 AS cval_lineitem_l_extendedprice_1#10149, cval_lineitem_l_discount#10105 AS cval_lineitem_l_discount_1#10150, cval_lineitem_l_tax#10106 AS cval_lineitem_l_tax_1#10151, cval_lineitem_l_returnflag#10107 AS cval_lineitem_l_returnflag_1#10152, cval_lineitem_l_linestatus#10108 AS cval_lineitem_l_linestatus_1#10153, cval_lineitem_l_commitdate#10109 AS cval_lineitem_l_commitdate_1#10154, cval_lineitem_l_receiptdate#10110 AS cval_lineitem_l_receiptdate_1#10155, cval_lineitem_l_shipinstruct#10111 AS cval_lineitem_l_shipinstruct_1#10156, cval_lineitem_l_shipmode#10112 AS cval_lineitem_l_shipmode_1#10157, cval_lineitem_l_comment#10113 AS cval_lineitem_l_comment_1#10158, cval_lineitem_l_shipdate#10114 AS cval_lineitem_l_shipdate_1#10159, cdepval_lineitem_l_quantity#10115 AS cdepval_lineitem_l_quantity_1#10160, cdepval_lineitem_l_extendedprice#10116 AS cdepval_lineitem_l_extendedprice_1#10161, cdepval_lineitem_l_discount#10117 AS cdepval_lineitem_l_discount_1#10162, ... 21 more fields]
         :  +- Relation[rid#10094,cpfk_orders_lineitem#10095,cpfk_supplier_lineitem#10096,cfpk_lineitem_supplier#10097,cfpk_lineitem_partsupp#10098,cpfk_part_lineitem#10099,cfpk_lineitem_part#10100,cpfk_partsupp_lineitem#10101,cfpk_lineitem_orders#10102,cval_lineitem_l_quantity#10103,cval_lineitem_l_extendedprice#10104,cval_lineitem_l_discount#10105,cval_lineitem_l_tax#10106,cval_lineitem_l_returnflag#10107,cval_lineitem_l_linestatus#10108,cval_lineitem_l_commitdate#10109,cval_lineitem_l_receiptdate#10110,cval_lineitem_l_shipinstruct#10111,cval_lineitem_l_shipmode#10112,cval_lineitem_l_comment#10113,cval_lineitem_l_shipdate#10114,cdepval_lineitem_l_quantity#10115,cdepval_lineitem_l_extendedprice#10116,cdepval_lineitem_l_discount#10117,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#10058 AS rid_0#10076, cpfk_nation_supplier#10059 AS cpfk_nation_supplier_0#10077, cfpk_supplier_nation#10060 AS cfpk_supplier_nation_0#10078, cval_supplier_s_name#10061 AS cval_supplier_s_name_0#10079, cval_supplier_s_address#10062 AS cval_supplier_s_address_0#10080, cval_supplier_s_phone#10063 AS cval_supplier_s_phone_0#10081, cval_supplier_s_acctbal#10064 AS cval_supplier_s_acctbal_0#10082, cval_supplier_s_comment#10065 AS cval_supplier_s_comment_0#10083, cdepval_supplier_s_name#10066 AS cdepval_supplier_s_name_0#10084, cdepval_supplier_s_address#10067 AS cdepval_supplier_s_address_0#10085, cdepval_supplier_s_phone#10068 AS cdepval_supplier_s_phone_0#10086, cdepval_supplier_s_acctbal#10069 AS cdepval_supplier_s_acctbal_0#10087, cdepval_supplier_s_comment#10070 AS cdepval_supplier_s_comment_0#10088, cs_name#10071 AS cs_name_0#10089, cs_address#10072 AS cs_address_0#10090, cs_phone#10073 AS cs_phone_0#10091, cs_acctbal#10074 AS cs_acctbal_0#10092, cs_comment#10075 AS cs_comment_0#10093]
            +- Relation[rid#10058,cpfk_nation_supplier#10059,cfpk_supplier_nation#10060,cval_supplier_s_name#10061,cval_supplier_s_address#10062,cval_supplier_s_phone#10063,cval_supplier_s_acctbal#10064,cval_supplier_s_comment#10065,cdepval_supplier_s_name#10066,cdepval_supplier_s_address#10067,cdepval_supplier_s_phone#10068,cdepval_supplier_s_acctbal#10069,cdepval_supplier_s_comment#10070,cs_name#10071,cs_address#10072,cs_phone#10073,cs_acctbal#10074,cs_comment#10075] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17282ms
query=q1, count=6001215, duration=2376
query=q10, count=1478870, duration=61208
query=q11, count=31680, duration=2477
query=q12, count=857401, duration=21791
query=q13, count=1500000, duration=4621
query=q14, count=6001215, duration=17803
query=q15, count=6001215, duration=17282
query=q16, count=15780, duration=575
query=q17, count=6088, duration=504
query=q18, count=6001215, duration=22194
query=q19, count=205, duration=16869
query=q2, count=3162, duration=950
query=q20, count=632, duration=932
query=q21a, count=597422, duration=157974
query=q22, count=1500000, duration=4391
query=q3, count=1214743, duration=24550
query=q4, count=6001215, duration=18341
query=q5, count=48089, duration=29970
query=q6, count=6001215, duration=2324
query=q7, count=9735, duration=40455
query=q8, count=8716, duration=3436
query=q9a, count=6001215, duration=63283
query=q9b, count=6001215, duration=37723
