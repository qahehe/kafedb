20/04/11 06:51:04 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 11331ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 11 06:51:08 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 11 06:51:09 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 11 06:51:09 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 11 06:51:09 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 11 06:51:09 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 11 06:51:14 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 11 06:51:17 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 11 06:51:17 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/11 06:51:19 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:51:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2079L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 06:51:19 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:51:20 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:51:20 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:51:20 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:51:20 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:51:20 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:51:20 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 06:51:20 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/11 06:51:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2079L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#2081 AS rid_0#2098, cval_part_p_name#2082 AS cval_part_p_name_0#2099, cval_part_p_mfgr#2083 AS cval_part_p_mfgr_0#2100, cval_part_p_type#2084 AS cval_part_p_type_0#2101, cval_part_p_size#2085 AS cval_part_p_size_0#2102, cval_part_p_container#2086 AS cval_part_p_container_0#2103, cval_part_p_retailprice#2087 AS cval_part_p_retailprice_0#2104, cval_part_p_comment#2088 AS cval_part_p_comment_0#2105, cval_part_p_brand#2089 AS cval_part_p_brand_0#2106, cp_name#2090 AS cp_name_0#2107, cp_mfgr#2091 AS cp_mfgr_0#2108, cp_type#2092 AS cp_type_0#2109, cp_size#2093 AS cp_size_0#2110, cp_container#2094 AS cp_container_0#2111, cp_retailprice#2095 AS cp_retailprice_0#2112, cp_comment#2096 AS cp_comment_0#2113, cp_brand#2097 AS cp_brand_0#2114]
         :  :  :  :  +- Relation[rid#2081,cval_part_p_name#2082,cval_part_p_mfgr#2083,cval_part_p_type#2084,cval_part_p_size#2085,cval_part_p_container#2086,cval_part_p_retailprice#2087,cval_part_p_comment#2088,cval_part_p_brand#2089,cp_name#2090,cp_mfgr#2091,cp_type#2092,cp_size#2093,cp_container#2094,cp_retailprice#2095,cp_comment#2096,cp_brand#2097] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#2115 AS rid_0#2132, cval_part_p_name#2116 AS cval_part_p_name_0#2133, cval_part_p_mfgr#2117 AS cval_part_p_mfgr_0#2134, cval_part_p_type#2118 AS cval_part_p_type_0#2135, cval_part_p_size#2119 AS cval_part_p_size_0#2136, cval_part_p_container#2120 AS cval_part_p_container_0#2137, cval_part_p_retailprice#2121 AS cval_part_p_retailprice_0#2138, cval_part_p_comment#2122 AS cval_part_p_comment_0#2139, cval_part_p_brand#2123 AS cval_part_p_brand_0#2140, cp_name#2124 AS cp_name_0#2141, cp_mfgr#2125 AS cp_mfgr_0#2142, cp_type#2126 AS cp_type_0#2143, cp_size#2127 AS cp_size_0#2144, cp_container#2128 AS cp_container_0#2145, cp_retailprice#2129 AS cp_retailprice_0#2146, cp_comment#2130 AS cp_comment_0#2147, cp_brand#2131 AS cp_brand_0#2148]
         :  :  :        +- Relation[rid#2115,cval_part_p_name#2116,cval_part_p_mfgr#2117,cval_part_p_type#2118,cval_part_p_size#2119,cval_part_p_container#2120,cval_part_p_retailprice#2121,cval_part_p_comment#2122,cval_part_p_brand#2123,cp_name#2124,cp_mfgr#2125,cp_type#2126,cp_size#2127,cp_container#2128,cp_retailprice#2129,cp_comment#2130,cp_brand#2131] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#2149 AS rid_0#2166, cval_part_p_name#2150 AS cval_part_p_name_0#2167, cval_part_p_mfgr#2151 AS cval_part_p_mfgr_0#2168, cval_part_p_type#2152 AS cval_part_p_type_0#2169, cval_part_p_size#2153 AS cval_part_p_size_0#2170, cval_part_p_container#2154 AS cval_part_p_container_0#2171, cval_part_p_retailprice#2155 AS cval_part_p_retailprice_0#2172, cval_part_p_comment#2156 AS cval_part_p_comment_0#2173, cval_part_p_brand#2157 AS cval_part_p_brand_0#2174, cp_name#2158 AS cp_name_0#2175, cp_mfgr#2159 AS cp_mfgr_0#2176, cp_type#2160 AS cp_type_0#2177, cp_size#2161 AS cp_size_0#2178, cp_container#2162 AS cp_container_0#2179, cp_retailprice#2163 AS cp_retailprice_0#2180, cp_comment#2164 AS cp_comment_0#2181, cp_brand#2165 AS cp_brand_0#2182]
         :  :        +- Relation[rid#2149,cval_part_p_name#2150,cval_part_p_mfgr#2151,cval_part_p_type#2152,cval_part_p_size#2153,cval_part_p_container#2154,cval_part_p_retailprice#2155,cval_part_p_comment#2156,cval_part_p_brand#2157,cp_name#2158,cp_mfgr#2159,cp_type#2160,cp_size#2161,cp_container#2162,cp_retailprice#2163,cp_comment#2164,cp_brand#2165] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#2381 AS rid_0#2398, cval_part_p_name#2382 AS cval_part_p_name_0#2399, cval_part_p_mfgr#2383 AS cval_part_p_mfgr_0#2400, cval_part_p_type#2384 AS cval_part_p_type_0#2401, cval_part_p_size#2385 AS cval_part_p_size_0#2402, cval_part_p_container#2386 AS cval_part_p_container_0#2403, cval_part_p_retailprice#2387 AS cval_part_p_retailprice_0#2404, cval_part_p_comment#2388 AS cval_part_p_comment_0#2405, cval_part_p_brand#2389 AS cval_part_p_brand_0#2406, cp_name#2390 AS cp_name_0#2407, cp_mfgr#2391 AS cp_mfgr_0#2408, cp_type#2392 AS cp_type_0#2409, cp_size#2393 AS cp_size_0#2410, cp_container#2394 AS cp_container_0#2411, cp_retailprice#2395 AS cp_retailprice_0#2412, cp_comment#2396 AS cp_comment_0#2413, cp_brand#2397 AS cp_brand_0#2414]
         :     :  +- Relation[rid#2381,cval_part_p_name#2382,cval_part_p_mfgr#2383,cval_part_p_type#2384,cval_part_p_size#2385,cval_part_p_container#2386,cval_part_p_retailprice#2387,cval_part_p_comment#2388,cval_part_p_brand#2389,cp_name#2390,cp_mfgr#2391,cp_type#2392,cp_size#2393,cp_container#2394,cp_retailprice#2395,cp_comment#2396,cp_brand#2397] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#2415 AS rid_1#2448, cpfk_orders_lineitem#2416 AS cpfk_orders_lineitem_1#2449, cpfk_supplier_lineitem#2417 AS cpfk_supplier_lineitem_1#2450, cfpk_lineitem_supplier#2418 AS cfpk_lineitem_supplier_1#2451, cfpk_lineitem_partsupp#2419 AS cfpk_lineitem_partsupp_1#2452, cpfk_part_lineitem#2420 AS cpfk_part_lineitem_1#2453, cfpk_lineitem_part#2421 AS cfpk_lineitem_part_1#2454, cpfk_partsupp_lineitem#2422 AS cpfk_partsupp_lineitem_1#2455, cfpk_lineitem_orders#2423 AS cfpk_lineitem_orders_1#2456, cval_lineitem_l_quantity#2424 AS cval_lineitem_l_quantity_1#2457, cval_lineitem_l_extendedprice#2425 AS cval_lineitem_l_extendedprice_1#2458, cval_lineitem_l_discount#2426 AS cval_lineitem_l_discount_1#2459, cval_lineitem_l_tax#2427 AS cval_lineitem_l_tax_1#2460, cval_lineitem_l_returnflag#2428 AS cval_lineitem_l_returnflag_1#2461, cval_lineitem_l_linestatus#2429 AS cval_lineitem_l_linestatus_1#2462, cval_lineitem_l_commitdate#2430 AS cval_lineitem_l_commitdate_1#2463, cval_lineitem_l_receiptdate#2431 AS cval_lineitem_l_receiptdate_1#2464, cval_lineitem_l_shipinstruct#2432 AS cval_lineitem_l_shipinstruct_1#2465, cval_lineitem_l_shipmode#2433 AS cval_lineitem_l_shipmode_1#2466, cval_lineitem_l_comment#2434 AS cval_lineitem_l_comment_1#2467, cval_lineitem_l_shipdate#2435 AS cval_lineitem_l_shipdate_1#2468, cl_quantity#2436 AS cl_quantity_1#2469, cl_extendedprice#2437 AS cl_extendedprice_1#2470, cl_discount#2438 AS cl_discount_1#2471, ... 9 more fields]
         :        +- Relation[rid#2415,cpfk_orders_lineitem#2416,cpfk_supplier_lineitem#2417,cfpk_lineitem_supplier#2418,cfpk_lineitem_partsupp#2419,cpfk_part_lineitem#2420,cfpk_lineitem_part#2421,cpfk_partsupp_lineitem#2422,cfpk_lineitem_orders#2423,cval_lineitem_l_quantity#2424,cval_lineitem_l_extendedprice#2425,cval_lineitem_l_discount#2426,cval_lineitem_l_tax#2427,cval_lineitem_l_returnflag#2428,cval_lineitem_l_linestatus#2429,cval_lineitem_l_commitdate#2430,cval_lineitem_l_receiptdate#2431,cval_lineitem_l_shipinstruct#2432,cval_lineitem_l_shipmode#2433,cval_lineitem_l_comment#2434,cval_lineitem_l_shipdate#2435,cl_quantity#2436,cl_extendedprice#2437,cl_discount#2438,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#2183 AS rid_1#2216, cpfk_orders_lineitem#2184 AS cpfk_orders_lineitem_1#2217, cpfk_supplier_lineitem#2185 AS cpfk_supplier_lineitem_1#2218, cfpk_lineitem_supplier#2186 AS cfpk_lineitem_supplier_1#2219, cfpk_lineitem_partsupp#2187 AS cfpk_lineitem_partsupp_1#2220, cpfk_part_lineitem#2188 AS cpfk_part_lineitem_1#2221, cfpk_lineitem_part#2189 AS cfpk_lineitem_part_1#2222, cpfk_partsupp_lineitem#2190 AS cpfk_partsupp_lineitem_1#2223, cfpk_lineitem_orders#2191 AS cfpk_lineitem_orders_1#2224, cval_lineitem_l_quantity#2192 AS cval_lineitem_l_quantity_1#2225, cval_lineitem_l_extendedprice#2193 AS cval_lineitem_l_extendedprice_1#2226, cval_lineitem_l_discount#2194 AS cval_lineitem_l_discount_1#2227, cval_lineitem_l_tax#2195 AS cval_lineitem_l_tax_1#2228, cval_lineitem_l_returnflag#2196 AS cval_lineitem_l_returnflag_1#2229, cval_lineitem_l_linestatus#2197 AS cval_lineitem_l_linestatus_1#2230, cval_lineitem_l_commitdate#2198 AS cval_lineitem_l_commitdate_1#2231, cval_lineitem_l_receiptdate#2199 AS cval_lineitem_l_receiptdate_1#2232, cval_lineitem_l_shipinstruct#2200 AS cval_lineitem_l_shipinstruct_1#2233, cval_lineitem_l_shipmode#2201 AS cval_lineitem_l_shipmode_1#2234, cval_lineitem_l_comment#2202 AS cval_lineitem_l_comment_1#2235, cval_lineitem_l_shipdate#2203 AS cval_lineitem_l_shipdate_1#2236, cl_quantity#2204 AS cl_quantity_1#2237, cl_extendedprice#2205 AS cl_extendedprice_1#2238, cl_discount#2206 AS cl_discount_1#2239, ... 9 more fields]
            :  :  +- Relation[rid#2183,cpfk_orders_lineitem#2184,cpfk_supplier_lineitem#2185,cfpk_lineitem_supplier#2186,cfpk_lineitem_partsupp#2187,cpfk_part_lineitem#2188,cfpk_lineitem_part#2189,cpfk_partsupp_lineitem#2190,cfpk_lineitem_orders#2191,cval_lineitem_l_quantity#2192,cval_lineitem_l_extendedprice#2193,cval_lineitem_l_discount#2194,cval_lineitem_l_tax#2195,cval_lineitem_l_returnflag#2196,cval_lineitem_l_linestatus#2197,cval_lineitem_l_commitdate#2198,cval_lineitem_l_receiptdate#2199,cval_lineitem_l_shipinstruct#2200,cval_lineitem_l_shipmode#2201,cval_lineitem_l_comment#2202,cval_lineitem_l_shipdate#2203,cl_quantity#2204,cl_extendedprice#2205,cl_discount#2206,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#2249 AS rid_1#2282, cpfk_orders_lineitem#2250 AS cpfk_orders_lineitem_1#2283, cpfk_supplier_lineitem#2251 AS cpfk_supplier_lineitem_1#2284, cfpk_lineitem_supplier#2252 AS cfpk_lineitem_supplier_1#2285, cfpk_lineitem_partsupp#2253 AS cfpk_lineitem_partsupp_1#2286, cpfk_part_lineitem#2254 AS cpfk_part_lineitem_1#2287, cfpk_lineitem_part#2255 AS cfpk_lineitem_part_1#2288, cpfk_partsupp_lineitem#2256 AS cpfk_partsupp_lineitem_1#2289, cfpk_lineitem_orders#2257 AS cfpk_lineitem_orders_1#2290, cval_lineitem_l_quantity#2258 AS cval_lineitem_l_quantity_1#2291, cval_lineitem_l_extendedprice#2259 AS cval_lineitem_l_extendedprice_1#2292, cval_lineitem_l_discount#2260 AS cval_lineitem_l_discount_1#2293, cval_lineitem_l_tax#2261 AS cval_lineitem_l_tax_1#2294, cval_lineitem_l_returnflag#2262 AS cval_lineitem_l_returnflag_1#2295, cval_lineitem_l_linestatus#2263 AS cval_lineitem_l_linestatus_1#2296, cval_lineitem_l_commitdate#2264 AS cval_lineitem_l_commitdate_1#2297, cval_lineitem_l_receiptdate#2265 AS cval_lineitem_l_receiptdate_1#2298, cval_lineitem_l_shipinstruct#2266 AS cval_lineitem_l_shipinstruct_1#2299, cval_lineitem_l_shipmode#2267 AS cval_lineitem_l_shipmode_1#2300, cval_lineitem_l_comment#2268 AS cval_lineitem_l_comment_1#2301, cval_lineitem_l_shipdate#2269 AS cval_lineitem_l_shipdate_1#2302, cl_quantity#2270 AS cl_quantity_1#2303, cl_extendedprice#2271 AS cl_extendedprice_1#2304, cl_discount#2272 AS cl_discount_1#2305, ... 9 more fields]
            :        +- Relation[rid#2249,cpfk_orders_lineitem#2250,cpfk_supplier_lineitem#2251,cfpk_lineitem_supplier#2252,cfpk_lineitem_partsupp#2253,cpfk_part_lineitem#2254,cfpk_lineitem_part#2255,cpfk_partsupp_lineitem#2256,cfpk_lineitem_orders#2257,cval_lineitem_l_quantity#2258,cval_lineitem_l_extendedprice#2259,cval_lineitem_l_discount#2260,cval_lineitem_l_tax#2261,cval_lineitem_l_returnflag#2262,cval_lineitem_l_linestatus#2263,cval_lineitem_l_commitdate#2264,cval_lineitem_l_receiptdate#2265,cval_lineitem_l_shipinstruct#2266,cval_lineitem_l_shipmode#2267,cval_lineitem_l_comment#2268,cval_lineitem_l_shipdate#2269,cl_quantity#2270,cl_extendedprice#2271,cl_discount#2272,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#2315 AS rid_1#2348, cpfk_orders_lineitem#2316 AS cpfk_orders_lineitem_1#2349, cpfk_supplier_lineitem#2317 AS cpfk_supplier_lineitem_1#2350, cfpk_lineitem_supplier#2318 AS cfpk_lineitem_supplier_1#2351, cfpk_lineitem_partsupp#2319 AS cfpk_lineitem_partsupp_1#2352, cpfk_part_lineitem#2320 AS cpfk_part_lineitem_1#2353, cfpk_lineitem_part#2321 AS cfpk_lineitem_part_1#2354, cpfk_partsupp_lineitem#2322 AS cpfk_partsupp_lineitem_1#2355, cfpk_lineitem_orders#2323 AS cfpk_lineitem_orders_1#2356, cval_lineitem_l_quantity#2324 AS cval_lineitem_l_quantity_1#2357, cval_lineitem_l_extendedprice#2325 AS cval_lineitem_l_extendedprice_1#2358, cval_lineitem_l_discount#2326 AS cval_lineitem_l_discount_1#2359, cval_lineitem_l_tax#2327 AS cval_lineitem_l_tax_1#2360, cval_lineitem_l_returnflag#2328 AS cval_lineitem_l_returnflag_1#2361, cval_lineitem_l_linestatus#2329 AS cval_lineitem_l_linestatus_1#2362, cval_lineitem_l_commitdate#2330 AS cval_lineitem_l_commitdate_1#2363, cval_lineitem_l_receiptdate#2331 AS cval_lineitem_l_receiptdate_1#2364, cval_lineitem_l_shipinstruct#2332 AS cval_lineitem_l_shipinstruct_1#2365, cval_lineitem_l_shipmode#2333 AS cval_lineitem_l_shipmode_1#2366, cval_lineitem_l_comment#2334 AS cval_lineitem_l_comment_1#2367, cval_lineitem_l_shipdate#2335 AS cval_lineitem_l_shipdate_1#2368, cl_quantity#2336 AS cl_quantity_1#2369, cl_extendedprice#2337 AS cl_extendedprice_1#2370, cl_discount#2338 AS cl_discount_1#2371, ... 9 more fields]
                  +- Relation[rid#2315,cpfk_orders_lineitem#2316,cpfk_supplier_lineitem#2317,cfpk_lineitem_supplier#2318,cfpk_lineitem_partsupp#2319,cpfk_part_lineitem#2320,cfpk_lineitem_part#2321,cpfk_partsupp_lineitem#2322,cfpk_lineitem_orders#2323,cval_lineitem_l_quantity#2324,cval_lineitem_l_extendedprice#2325,cval_lineitem_l_discount#2326,cval_lineitem_l_tax#2327,cval_lineitem_l_returnflag#2328,cval_lineitem_l_linestatus#2329,cval_lineitem_l_commitdate#2330,cval_lineitem_l_receiptdate#2331,cval_lineitem_l_shipinstruct#2332,cval_lineitem_l_shipmode#2333,cval_lineitem_l_comment#2334,cval_lineitem_l_shipdate#2335,cl_quantity#2336,cl_extendedprice#2337,cl_discount#2338,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 361769ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/11 06:57:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:57:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2559L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 06:57:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2559L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#2561 AS rid_0#2594, cpfk_orders_lineitem#2562 AS cpfk_orders_lineitem_0#2595, cpfk_supplier_lineitem#2563 AS cpfk_supplier_lineitem_0#2596, cfpk_lineitem_supplier#2564 AS cfpk_lineitem_supplier_0#2597, cfpk_lineitem_partsupp#2565 AS cfpk_lineitem_partsupp_0#2598, cpfk_part_lineitem#2566 AS cpfk_part_lineitem_0#2599, cfpk_lineitem_part#2567 AS cfpk_lineitem_part_0#2600, cpfk_partsupp_lineitem#2568 AS cpfk_partsupp_lineitem_0#2601, cfpk_lineitem_orders#2569 AS cfpk_lineitem_orders_0#2602, cval_lineitem_l_quantity#2570 AS cval_lineitem_l_quantity_0#2603, cval_lineitem_l_extendedprice#2571 AS cval_lineitem_l_extendedprice_0#2604, cval_lineitem_l_discount#2572 AS cval_lineitem_l_discount_0#2605, cval_lineitem_l_tax#2573 AS cval_lineitem_l_tax_0#2606, cval_lineitem_l_returnflag#2574 AS cval_lineitem_l_returnflag_0#2607, cval_lineitem_l_linestatus#2575 AS cval_lineitem_l_linestatus_0#2608, cval_lineitem_l_commitdate#2576 AS cval_lineitem_l_commitdate_0#2609, cval_lineitem_l_receiptdate#2577 AS cval_lineitem_l_receiptdate_0#2610, cval_lineitem_l_shipinstruct#2578 AS cval_lineitem_l_shipinstruct_0#2611, cval_lineitem_l_shipmode#2579 AS cval_lineitem_l_shipmode_0#2612, cval_lineitem_l_comment#2580 AS cval_lineitem_l_comment_0#2613, cval_lineitem_l_shipdate#2581 AS cval_lineitem_l_shipdate_0#2614, cl_quantity#2582 AS cl_quantity_0#2615, cl_extendedprice#2583 AS cl_extendedprice_0#2616, cl_discount#2584 AS cl_discount_0#2617, ... 9 more fields]
            :  +- Relation[rid#2561,cpfk_orders_lineitem#2562,cpfk_supplier_lineitem#2563,cfpk_lineitem_supplier#2564,cfpk_lineitem_partsupp#2565,cpfk_part_lineitem#2566,cfpk_lineitem_part#2567,cpfk_partsupp_lineitem#2568,cfpk_lineitem_orders#2569,cval_lineitem_l_quantity#2570,cval_lineitem_l_extendedprice#2571,cval_lineitem_l_discount#2572,cval_lineitem_l_tax#2573,cval_lineitem_l_returnflag#2574,cval_lineitem_l_linestatus#2575,cval_lineitem_l_commitdate#2576,cval_lineitem_l_receiptdate#2577,cval_lineitem_l_shipinstruct#2578,cval_lineitem_l_shipmode#2579,cval_lineitem_l_comment#2580,cval_lineitem_l_shipdate#2581,cl_quantity#2582,cl_extendedprice#2583,cl_discount#2584,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#2627 AS rid_1#2644, cpfk_customer_orders#2628 AS cpfk_customer_orders_1#2645, cfpk_orders_customer#2629 AS cfpk_orders_customer_1#2646, cval_orders_o_orderstatus#2630 AS cval_orders_o_orderstatus_1#2647, cval_orders_o_totalprice#2631 AS cval_orders_o_totalprice_1#2648, cval_orders_o_orderpriority#2632 AS cval_orders_o_orderpriority_1#2649, cval_orders_o_clerk#2633 AS cval_orders_o_clerk_1#2650, cval_orders_o_shippriority#2634 AS cval_orders_o_shippriority_1#2651, cval_orders_o_comment#2635 AS cval_orders_o_comment_1#2652, cval_orders_o_orderdate#2636 AS cval_orders_o_orderdate_1#2653, co_orderstatus#2637 AS co_orderstatus_1#2654, co_totalprice#2638 AS co_totalprice_1#2655, co_orderpriority#2639 AS co_orderpriority_1#2656, co_clerk#2640 AS co_clerk_1#2657, co_shippriority#2641 AS co_shippriority_1#2658, co_comment#2642 AS co_comment_1#2659, co_orderdate#2643 AS co_orderdate_1#2660]
               +- Relation[rid#2627,cpfk_customer_orders#2628,cfpk_orders_customer#2629,cval_orders_o_orderstatus#2630,cval_orders_o_totalprice#2631,cval_orders_o_orderpriority#2632,cval_orders_o_clerk#2633,cval_orders_o_shippriority#2634,cval_orders_o_comment#2635,cval_orders_o_orderdate#2636,co_orderstatus#2637,co_totalprice#2638,co_orderpriority#2639,co_clerk#2640,co_shippriority#2641,co_comment#2642,co_orderdate#2643] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 53336ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/11 06:58:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:58:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2716L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 06:58:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#2716L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#2718 AS rid_0#2751, cpfk_orders_lineitem#2719 AS cpfk_orders_lineitem_0#2752, cpfk_supplier_lineitem#2720 AS cpfk_supplier_lineitem_0#2753, cfpk_lineitem_supplier#2721 AS cfpk_lineitem_supplier_0#2754, cfpk_lineitem_partsupp#2722 AS cfpk_lineitem_partsupp_0#2755, cpfk_part_lineitem#2723 AS cpfk_part_lineitem_0#2756, cfpk_lineitem_part#2724 AS cfpk_lineitem_part_0#2757, cpfk_partsupp_lineitem#2725 AS cpfk_partsupp_lineitem_0#2758, cfpk_lineitem_orders#2726 AS cfpk_lineitem_orders_0#2759, cval_lineitem_l_quantity#2727 AS cval_lineitem_l_quantity_0#2760, cval_lineitem_l_extendedprice#2728 AS cval_lineitem_l_extendedprice_0#2761, cval_lineitem_l_discount#2729 AS cval_lineitem_l_discount_0#2762, cval_lineitem_l_tax#2730 AS cval_lineitem_l_tax_0#2763, cval_lineitem_l_returnflag#2731 AS cval_lineitem_l_returnflag_0#2764, cval_lineitem_l_linestatus#2732 AS cval_lineitem_l_linestatus_0#2765, cval_lineitem_l_commitdate#2733 AS cval_lineitem_l_commitdate_0#2766, cval_lineitem_l_receiptdate#2734 AS cval_lineitem_l_receiptdate_0#2767, cval_lineitem_l_shipinstruct#2735 AS cval_lineitem_l_shipinstruct_0#2768, cval_lineitem_l_shipmode#2736 AS cval_lineitem_l_shipmode_0#2769, cval_lineitem_l_comment#2737 AS cval_lineitem_l_comment_0#2770, cval_lineitem_l_shipdate#2738 AS cval_lineitem_l_shipdate_0#2771, cl_quantity#2739 AS cl_quantity_0#2772, cl_extendedprice#2740 AS cl_extendedprice_0#2773, cl_discount#2741 AS cl_discount_0#2774, ... 9 more fields]
         +- Relation[rid#2718,cpfk_orders_lineitem#2719,cpfk_supplier_lineitem#2720,cfpk_lineitem_supplier#2721,cfpk_lineitem_partsupp#2722,cpfk_part_lineitem#2723,cfpk_lineitem_part#2724,cpfk_partsupp_lineitem#2725,cfpk_lineitem_orders#2726,cval_lineitem_l_quantity#2727,cval_lineitem_l_extendedprice#2728,cval_lineitem_l_discount#2729,cval_lineitem_l_tax#2730,cval_lineitem_l_returnflag#2731,cval_lineitem_l_linestatus#2732,cval_lineitem_l_commitdate#2733,cval_lineitem_l_receiptdate#2734,cval_lineitem_l_shipinstruct#2735,cval_lineitem_l_shipmode#2736,cval_lineitem_l_comment#2737,cval_lineitem_l_shipdate#2738,cl_quantity#2739,cl_extendedprice#2740,cl_discount#2741,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 3167ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/11 06:58:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:58:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2824L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 06:58:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:58:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:58:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:58:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 06:58:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:58:18 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:58:18 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:58:18 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:58:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:58:18 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:58:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:58:18 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 06:58:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:58:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:58:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 06:58:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2824L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#2826 AS rid_0#2843, cval_part_p_name#2827 AS cval_part_p_name_0#2844, cval_part_p_mfgr#2828 AS cval_part_p_mfgr_0#2845, cval_part_p_type#2829 AS cval_part_p_type_0#2846, cval_part_p_size#2830 AS cval_part_p_size_0#2847, cval_part_p_container#2831 AS cval_part_p_container_0#2848, cval_part_p_retailprice#2832 AS cval_part_p_retailprice_0#2849, cval_part_p_comment#2833 AS cval_part_p_comment_0#2850, cval_part_p_brand#2834 AS cval_part_p_brand_0#2851, cp_name#2835 AS cp_name_0#2852, cp_mfgr#2836 AS cp_mfgr_0#2853, cp_type#2837 AS cp_type_0#2854, cp_size#2838 AS cp_size_0#2855, cp_container#2839 AS cp_container_0#2856, cp_retailprice#2840 AS cp_retailprice_0#2857, cp_comment#2841 AS cp_comment_0#2858, cp_brand#2842 AS cp_brand_0#2859]
            :     :     :  :  :  :  +- Relation[rid#2826,cval_part_p_name#2827,cval_part_p_mfgr#2828,cval_part_p_type#2829,cval_part_p_size#2830,cval_part_p_container#2831,cval_part_p_retailprice#2832,cval_part_p_comment#2833,cval_part_p_brand#2834,cp_name#2835,cp_mfgr#2836,cp_type#2837,cp_size#2838,cp_container#2839,cp_retailprice#2840,cp_comment#2841,cp_brand#2842] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#2860 AS rid_0#2877, cval_part_p_name#2861 AS cval_part_p_name_0#2878, cval_part_p_mfgr#2862 AS cval_part_p_mfgr_0#2879, cval_part_p_type#2863 AS cval_part_p_type_0#2880, cval_part_p_size#2864 AS cval_part_p_size_0#2881, cval_part_p_container#2865 AS cval_part_p_container_0#2882, cval_part_p_retailprice#2866 AS cval_part_p_retailprice_0#2883, cval_part_p_comment#2867 AS cval_part_p_comment_0#2884, cval_part_p_brand#2868 AS cval_part_p_brand_0#2885, cp_name#2869 AS cp_name_0#2886, cp_mfgr#2870 AS cp_mfgr_0#2887, cp_type#2871 AS cp_type_0#2888, cp_size#2872 AS cp_size_0#2889, cp_container#2873 AS cp_container_0#2890, cp_retailprice#2874 AS cp_retailprice_0#2891, cp_comment#2875 AS cp_comment_0#2892, cp_brand#2876 AS cp_brand_0#2893]
            :     :     :  :  :        +- Relation[rid#2860,cval_part_p_name#2861,cval_part_p_mfgr#2862,cval_part_p_type#2863,cval_part_p_size#2864,cval_part_p_container#2865,cval_part_p_retailprice#2866,cval_part_p_comment#2867,cval_part_p_brand#2868,cp_name#2869,cp_mfgr#2870,cp_type#2871,cp_size#2872,cp_container#2873,cp_retailprice#2874,cp_comment#2875,cp_brand#2876] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :     :- Project [rid#2960 AS rid_0#2977, cval_part_p_name#2961 AS cval_part_p_name_0#2978, cval_part_p_mfgr#2962 AS cval_part_p_mfgr_0#2979, cval_part_p_type#2963 AS cval_part_p_type_0#2980, cval_part_p_size#2964 AS cval_part_p_size_0#2981, cval_part_p_container#2965 AS cval_part_p_container_0#2982, cval_part_p_retailprice#2966 AS cval_part_p_retailprice_0#2983, cval_part_p_comment#2967 AS cval_part_p_comment_0#2984, cval_part_p_brand#2968 AS cval_part_p_brand_0#2985, cp_name#2969 AS cp_name_0#2986, cp_mfgr#2970 AS cp_mfgr_0#2987, cp_type#2971 AS cp_type_0#2988, cp_size#2972 AS cp_size_0#2989, cp_container#2973 AS cp_container_0#2990, cp_retailprice#2974 AS cp_retailprice_0#2991, cp_comment#2975 AS cp_comment_0#2992, cp_brand#2976 AS cp_brand_0#2993]
            :     :     :  :     :  +- Relation[rid#2960,cval_part_p_name#2961,cval_part_p_mfgr#2962,cval_part_p_type#2963,cval_part_p_size#2964,cval_part_p_container#2965,cval_part_p_retailprice#2966,cval_part_p_comment#2967,cval_part_p_brand#2968,cp_name#2969,cp_mfgr#2970,cp_type#2971,cp_size#2972,cp_container#2973,cp_retailprice#2974,cp_comment#2975,cp_brand#2976] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :     +- Project [rid#2994 AS rid_1#3027, cpfk_orders_lineitem#2995 AS cpfk_orders_lineitem_1#3028, cpfk_supplier_lineitem#2996 AS cpfk_supplier_lineitem_1#3029, cfpk_lineitem_supplier#2997 AS cfpk_lineitem_supplier_1#3030, cfpk_lineitem_partsupp#2998 AS cfpk_lineitem_partsupp_1#3031, cpfk_part_lineitem#2999 AS cpfk_part_lineitem_1#3032, cfpk_lineitem_part#3000 AS cfpk_lineitem_part_1#3033, cpfk_partsupp_lineitem#3001 AS cpfk_partsupp_lineitem_1#3034, cfpk_lineitem_orders#3002 AS cfpk_lineitem_orders_1#3035, cval_lineitem_l_quantity#3003 AS cval_lineitem_l_quantity_1#3036, cval_lineitem_l_extendedprice#3004 AS cval_lineitem_l_extendedprice_1#3037, cval_lineitem_l_discount#3005 AS cval_lineitem_l_discount_1#3038, cval_lineitem_l_tax#3006 AS cval_lineitem_l_tax_1#3039, cval_lineitem_l_returnflag#3007 AS cval_lineitem_l_returnflag_1#3040, cval_lineitem_l_linestatus#3008 AS cval_lineitem_l_linestatus_1#3041, cval_lineitem_l_commitdate#3009 AS cval_lineitem_l_commitdate_1#3042, cval_lineitem_l_receiptdate#3010 AS cval_lineitem_l_receiptdate_1#3043, cval_lineitem_l_shipinstruct#3011 AS cval_lineitem_l_shipinstruct_1#3044, cval_lineitem_l_shipmode#3012 AS cval_lineitem_l_shipmode_1#3045, cval_lineitem_l_comment#3013 AS cval_lineitem_l_comment_1#3046, cval_lineitem_l_shipdate#3014 AS cval_lineitem_l_shipdate_1#3047, cl_quantity#3015 AS cl_quantity_1#3048, cl_extendedprice#3016 AS cl_extendedprice_1#3049, cl_discount#3017 AS cl_discount_1#3050, ... 9 more fields]
            :     :     :  :        +- Relation[rid#2994,cpfk_orders_lineitem#2995,cpfk_supplier_lineitem#2996,cfpk_lineitem_supplier#2997,cfpk_lineitem_partsupp#2998,cpfk_part_lineitem#2999,cfpk_lineitem_part#3000,cpfk_partsupp_lineitem#3001,cfpk_lineitem_orders#3002,cval_lineitem_l_quantity#3003,cval_lineitem_l_extendedprice#3004,cval_lineitem_l_discount#3005,cval_lineitem_l_tax#3006,cval_lineitem_l_returnflag#3007,cval_lineitem_l_linestatus#3008,cval_lineitem_l_commitdate#3009,cval_lineitem_l_receiptdate#3010,cval_lineitem_l_shipinstruct#3011,cval_lineitem_l_shipmode#3012,cval_lineitem_l_comment#3013,cval_lineitem_l_shipdate#3014,cl_quantity#3015,cl_extendedprice#3016,cl_discount#3017,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#2894 AS rid_1#2927, cpfk_orders_lineitem#2895 AS cpfk_orders_lineitem_1#2928, cpfk_supplier_lineitem#2896 AS cpfk_supplier_lineitem_1#2929, cfpk_lineitem_supplier#2897 AS cfpk_lineitem_supplier_1#2930, cfpk_lineitem_partsupp#2898 AS cfpk_lineitem_partsupp_1#2931, cpfk_part_lineitem#2899 AS cpfk_part_lineitem_1#2932, cfpk_lineitem_part#2900 AS cfpk_lineitem_part_1#2933, cpfk_partsupp_lineitem#2901 AS cpfk_partsupp_lineitem_1#2934, cfpk_lineitem_orders#2902 AS cfpk_lineitem_orders_1#2935, cval_lineitem_l_quantity#2903 AS cval_lineitem_l_quantity_1#2936, cval_lineitem_l_extendedprice#2904 AS cval_lineitem_l_extendedprice_1#2937, cval_lineitem_l_discount#2905 AS cval_lineitem_l_discount_1#2938, cval_lineitem_l_tax#2906 AS cval_lineitem_l_tax_1#2939, cval_lineitem_l_returnflag#2907 AS cval_lineitem_l_returnflag_1#2940, cval_lineitem_l_linestatus#2908 AS cval_lineitem_l_linestatus_1#2941, cval_lineitem_l_commitdate#2909 AS cval_lineitem_l_commitdate_1#2942, cval_lineitem_l_receiptdate#2910 AS cval_lineitem_l_receiptdate_1#2943, cval_lineitem_l_shipinstruct#2911 AS cval_lineitem_l_shipinstruct_1#2944, cval_lineitem_l_shipmode#2912 AS cval_lineitem_l_shipmode_1#2945, cval_lineitem_l_comment#2913 AS cval_lineitem_l_comment_1#2946, cval_lineitem_l_shipdate#2914 AS cval_lineitem_l_shipdate_1#2947, cl_quantity#2915 AS cl_quantity_1#2948, cl_extendedprice#2916 AS cl_extendedprice_1#2949, cl_discount#2917 AS cl_discount_1#2950, ... 9 more fields]
            :     :     :     +- Relation[rid#2894,cpfk_orders_lineitem#2895,cpfk_supplier_lineitem#2896,cfpk_lineitem_supplier#2897,cfpk_lineitem_partsupp#2898,cpfk_part_lineitem#2899,cfpk_lineitem_part#2900,cpfk_partsupp_lineitem#2901,cfpk_lineitem_orders#2902,cval_lineitem_l_quantity#2903,cval_lineitem_l_extendedprice#2904,cval_lineitem_l_discount#2905,cval_lineitem_l_tax#2906,cval_lineitem_l_returnflag#2907,cval_lineitem_l_linestatus#2908,cval_lineitem_l_commitdate#2909,cval_lineitem_l_receiptdate#2910,cval_lineitem_l_shipinstruct#2911,cval_lineitem_l_shipmode#2912,cval_lineitem_l_comment#2913,cval_lineitem_l_shipdate#2914,cl_quantity#2915,cl_extendedprice#2916,cl_discount#2917,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#3060 AS rid_2#3073, cpfk_nation_supplier#3061 AS cpfk_nation_supplier_2#3074, cfpk_supplier_nation#3062 AS cfpk_supplier_nation_2#3075, cval_supplier_s_name#3063 AS cval_supplier_s_name_2#3076, cval_supplier_s_address#3064 AS cval_supplier_s_address_2#3077, cval_supplier_s_phone#3065 AS cval_supplier_s_phone_2#3078, cval_supplier_s_acctbal#3066 AS cval_supplier_s_acctbal_2#3079, cval_supplier_s_comment#3067 AS cval_supplier_s_comment_2#3080, cs_name#3068 AS cs_name_2#3081, cs_address#3069 AS cs_address_2#3082, cs_phone#3070 AS cs_phone_2#3083, cs_acctbal#3071 AS cs_acctbal_2#3084, cs_comment#3072 AS cs_comment_2#3085]
            :     :        +- Relation[rid#3060,cpfk_nation_supplier#3061,cfpk_supplier_nation#3062,cval_supplier_s_name#3063,cval_supplier_s_address#3064,cval_supplier_s_phone#3065,cval_supplier_s_acctbal#3066,cval_supplier_s_comment#3067,cs_name#3068,cs_address#3069,cs_phone#3070,cs_acctbal#3071,cs_comment#3072] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#3086 AS rid_3#3093, cpfk_region_nation#3087 AS cpfk_region_nation_3#3094, cfpk_nation_region#3088 AS cfpk_nation_region_3#3095, cval_nation_n_name#3089 AS cval_nation_n_name_3#3096, cval_nation_n_comment#3090 AS cval_nation_n_comment_3#3097, cn_name#3091 AS cn_name_3#3098, cn_comment#3092 AS cn_comment_3#3099]
            :        +- Relation[rid#3086,cpfk_region_nation#3087,cfpk_nation_region#3088,cval_nation_n_name#3089,cval_nation_n_comment#3090,cn_name#3091,cn_comment#3092] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'Join UsingJoin(Inner,List(rid_6))
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#3100 AS rid_4#3105, cval_region_r_name#3101 AS cval_region_r_name_4#3106, cval_region_r_comment#3102 AS cval_region_r_comment_4#3107, cr_name#3103 AS cr_name_4#3108, cr_comment#3104 AS cr_comment_4#3109]
               :  :  :  :  :  :  :  +- Relation[rid#3100,cval_region_r_name#3101,cval_region_r_comment#3102,cr_name#3103,cr_comment#3104] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#3110 AS rid_4#3115, cval_region_r_name#3111 AS cval_region_r_name_4#3116, cval_region_r_comment#3112 AS cval_region_r_comment_4#3117, cr_name#3113 AS cr_name_4#3118, cr_comment#3114 AS cr_comment_4#3119]
               :  :  :  :  :  :        +- Relation[rid#3110,cval_region_r_name#3111,cval_region_r_comment#3112,cr_name#3113,cr_comment#3114] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :     :- Project [rid#3134 AS rid_4#3139, cval_region_r_name#3135 AS cval_region_r_name_4#3140, cval_region_r_comment#3136 AS cval_region_r_comment_4#3141, cr_name#3137 AS cr_name_4#3142, cr_comment#3138 AS cr_comment_4#3143]
               :  :  :  :  :     :  +- Relation[rid#3134,cval_region_r_name#3135,cval_region_r_comment#3136,cr_name#3137,cr_comment#3138] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :     +- Project [rid#3144 AS rid_5#3151, cpfk_region_nation#3145 AS cpfk_region_nation_5#3152, cfpk_nation_region#3146 AS cfpk_nation_region_5#3153, cval_nation_n_name#3147 AS cval_nation_n_name_5#3154, cval_nation_n_comment#3148 AS cval_nation_n_comment_5#3155, cn_name#3149 AS cn_name_5#3156, cn_comment#3150 AS cn_comment_5#3157]
               :  :  :  :  :        +- Relation[rid#3144,cpfk_region_nation#3145,cfpk_nation_region#3146,cval_nation_n_name#3147,cval_nation_n_comment#3148,cn_name#3149,cn_comment#3150] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#3120 AS rid_5#3127, cpfk_region_nation#3121 AS cpfk_region_nation_5#3128, cfpk_nation_region#3122 AS cfpk_nation_region_5#3129, cval_nation_n_name#3123 AS cval_nation_n_name_5#3130, cval_nation_n_comment#3124 AS cval_nation_n_comment_5#3131, cn_name#3125 AS cn_name_5#3132, cn_comment#3126 AS cn_comment_5#3133]
               :  :  :  :     +- Relation[rid#3120,cpfk_region_nation#3121,cfpk_nation_region#3122,cval_nation_n_name#3123,cval_nation_n_comment#3124,cn_name#3125,cn_comment#3126] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :     :- Project [rid#3188 AS rid_5#3195, cpfk_region_nation#3189 AS cpfk_region_nation_5#3196, cfpk_nation_region#3190 AS cfpk_nation_region_5#3197, cval_nation_n_name#3191 AS cval_nation_n_name_5#3198, cval_nation_n_comment#3192 AS cval_nation_n_comment_5#3199, cn_name#3193 AS cn_name_5#3200, cn_comment#3194 AS cn_comment_5#3201]
               :  :  :     :  +- Relation[rid#3188,cpfk_region_nation#3189,cfpk_nation_region#3190,cval_nation_n_name#3191,cval_nation_n_comment#3192,cn_name#3193,cn_comment#3194] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#3202 AS rid_6#3217, cpfk_nation_customer#3203 AS cpfk_nation_customer_6#3218, cfpk_customer_nation#3204 AS cfpk_customer_nation_6#3219, cval_customer_c_name#3205 AS cval_customer_c_name_6#3220, cval_customer_c_address#3206 AS cval_customer_c_address_6#3221, cval_customer_c_phone#3207 AS cval_customer_c_phone_6#3222, cval_customer_c_acctbal#3208 AS cval_customer_c_acctbal_6#3223, cval_customer_c_comment#3209 AS cval_customer_c_comment_6#3224, cval_customer_c_mktsegment#3210 AS cval_customer_c_mktsegment_6#3225, cc_name#3211 AS cc_name_6#3226, cc_address#3212 AS cc_address_6#3227, cc_phone#3213 AS cc_phone_6#3228, cc_acctbal#3214 AS cc_acctbal_6#3229, cc_comment#3215 AS cc_comment_6#3230, cc_mktsegment#3216 AS cc_mktsegment_6#3231]
               :  :  :        +- Relation[rid#3202,cpfk_nation_customer#3203,cfpk_customer_nation#3204,cval_customer_c_name#3205,cval_customer_c_address#3206,cval_customer_c_phone#3207,cval_customer_c_acctbal#3208,cval_customer_c_comment#3209,cval_customer_c_mktsegment#3210,cc_name#3211,cc_address#3212,cc_phone#3213,cc_acctbal#3214,cc_comment#3215,cc_mktsegment#3216] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#3158 AS rid_6#3173, cpfk_nation_customer#3159 AS cpfk_nation_customer_6#3174, cfpk_customer_nation#3160 AS cfpk_customer_nation_6#3175, cval_customer_c_name#3161 AS cval_customer_c_name_6#3176, cval_customer_c_address#3162 AS cval_customer_c_address_6#3177, cval_customer_c_phone#3163 AS cval_customer_c_phone_6#3178, cval_customer_c_acctbal#3164 AS cval_customer_c_acctbal_6#3179, cval_customer_c_comment#3165 AS cval_customer_c_comment_6#3180, cval_customer_c_mktsegment#3166 AS cval_customer_c_mktsegment_6#3181, cc_name#3167 AS cc_name_6#3182, cc_address#3168 AS cc_address_6#3183, cc_phone#3169 AS cc_phone_6#3184, cc_acctbal#3170 AS cc_acctbal_6#3185, cc_comment#3171 AS cc_comment_6#3186, cc_mktsegment#3172 AS cc_mktsegment_6#3187]
               :  :     +- Relation[rid#3158,cpfk_nation_customer#3159,cfpk_customer_nation#3160,cval_customer_c_name#3161,cval_customer_c_address#3162,cval_customer_c_phone#3163,cval_customer_c_acctbal#3164,cval_customer_c_comment#3165,cval_customer_c_mktsegment#3166,cc_name#3167,cc_address#3168,cc_phone#3169,cc_acctbal#3170,cc_comment#3171,cc_mktsegment#3172] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :     :- Project [rid#3266 AS rid_6#3281, cpfk_nation_customer#3267 AS cpfk_nation_customer_6#3282, cfpk_customer_nation#3268 AS cfpk_customer_nation_6#3283, cval_customer_c_name#3269 AS cval_customer_c_name_6#3284, cval_customer_c_address#3270 AS cval_customer_c_address_6#3285, cval_customer_c_phone#3271 AS cval_customer_c_phone_6#3286, cval_customer_c_acctbal#3272 AS cval_customer_c_acctbal_6#3287, cval_customer_c_comment#3273 AS cval_customer_c_comment_6#3288, cval_customer_c_mktsegment#3274 AS cval_customer_c_mktsegment_6#3289, cc_name#3275 AS cc_name_6#3290, cc_address#3276 AS cc_address_6#3291, cc_phone#3277 AS cc_phone_6#3292, cc_acctbal#3278 AS cc_acctbal_6#3293, cc_comment#3279 AS cc_comment_6#3294, cc_mktsegment#3280 AS cc_mktsegment_6#3295]
               :     :  +- Relation[rid#3266,cpfk_nation_customer#3267,cfpk_customer_nation#3268,cval_customer_c_name#3269,cval_customer_c_address#3270,cval_customer_c_phone#3271,cval_customer_c_acctbal#3272,cval_customer_c_comment#3273,cval_customer_c_mktsegment#3274,cc_name#3275,cc_address#3276,cc_phone#3277,cc_acctbal#3278,cc_comment#3279,cc_mktsegment#3280] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#3296 AS rid_7#3313, cpfk_customer_orders#3297 AS cpfk_customer_orders_7#3314, cfpk_orders_customer#3298 AS cfpk_orders_customer_7#3315, cval_orders_o_orderstatus#3299 AS cval_orders_o_orderstatus_7#3316, cval_orders_o_totalprice#3300 AS cval_orders_o_totalprice_7#3317, cval_orders_o_orderpriority#3301 AS cval_orders_o_orderpriority_7#3318, cval_orders_o_clerk#3302 AS cval_orders_o_clerk_7#3319, cval_orders_o_shippriority#3303 AS cval_orders_o_shippriority_7#3320, cval_orders_o_comment#3304 AS cval_orders_o_comment_7#3321, cval_orders_o_orderdate#3305 AS cval_orders_o_orderdate_7#3322, co_orderstatus#3306 AS co_orderstatus_7#3323, co_totalprice#3307 AS co_totalprice_7#3324, co_orderpriority#3308 AS co_orderpriority_7#3325, co_clerk#3309 AS co_clerk_7#3326, co_shippriority#3310 AS co_shippriority_7#3327, co_comment#3311 AS co_comment_7#3328, co_orderdate#3312 AS co_orderdate_7#3329]
               :        +- Relation[rid#3296,cpfk_customer_orders#3297,cfpk_orders_customer#3298,cval_orders_o_orderstatus#3299,cval_orders_o_totalprice#3300,cval_orders_o_orderpriority#3301,cval_orders_o_clerk#3302,cval_orders_o_shippriority#3303,cval_orders_o_comment#3304,cval_orders_o_orderdate#3305,co_orderstatus#3306,co_totalprice#3307,co_orderpriority#3308,co_clerk#3309,co_shippriority#3310,co_comment#3311,co_orderdate#3312] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#3232 AS rid_7#3249, cpfk_customer_orders#3233 AS cpfk_customer_orders_7#3250, cfpk_orders_customer#3234 AS cfpk_orders_customer_7#3251, cval_orders_o_orderstatus#3235 AS cval_orders_o_orderstatus_7#3252, cval_orders_o_totalprice#3236 AS cval_orders_o_totalprice_7#3253, cval_orders_o_orderpriority#3237 AS cval_orders_o_orderpriority_7#3254, cval_orders_o_clerk#3238 AS cval_orders_o_clerk_7#3255, cval_orders_o_shippriority#3239 AS cval_orders_o_shippriority_7#3256, cval_orders_o_comment#3240 AS cval_orders_o_comment_7#3257, cval_orders_o_orderdate#3241 AS cval_orders_o_orderdate_7#3258, co_orderstatus#3242 AS co_orderstatus_7#3259, co_totalprice#3243 AS co_totalprice_7#3260, co_orderpriority#3244 AS co_orderpriority_7#3261, co_clerk#3245 AS co_clerk_7#3262, co_shippriority#3246 AS co_shippriority_7#3263, co_comment#3247 AS co_comment_7#3264, co_orderdate#3248 AS co_orderdate_7#3265]
                  +- Relation[rid#3232,cpfk_customer_orders#3233,cfpk_orders_customer#3234,cval_orders_o_orderstatus#3235,cval_orders_o_totalprice#3236,cval_orders_o_orderpriority#3237,cval_orders_o_clerk#3238,cval_orders_o_shippriority#3239,cval_orders_o_comment#3240,cval_orders_o_orderdate#3241,co_orderstatus#3242,co_totalprice#3243,co_orderpriority#3244,co_clerk#3245,co_shippriority#3246,co_comment#3247,co_orderdate#3248] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 94797ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/11 06:59:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 06:59:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3449L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 06:59:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3449L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#3451 AS rid_0#3468, cpfk_customer_orders#3452 AS cpfk_customer_orders_0#3469, cfpk_orders_customer#3453 AS cfpk_orders_customer_0#3470, cval_orders_o_orderstatus#3454 AS cval_orders_o_orderstatus_0#3471, cval_orders_o_totalprice#3455 AS cval_orders_o_totalprice_0#3472, cval_orders_o_orderpriority#3456 AS cval_orders_o_orderpriority_0#3473, cval_orders_o_clerk#3457 AS cval_orders_o_clerk_0#3474, cval_orders_o_shippriority#3458 AS cval_orders_o_shippriority_0#3475, cval_orders_o_comment#3459 AS cval_orders_o_comment_0#3476, cval_orders_o_orderdate#3460 AS cval_orders_o_orderdate_0#3477, co_orderstatus#3461 AS co_orderstatus_0#3478, co_totalprice#3462 AS co_totalprice_0#3479, co_orderpriority#3463 AS co_orderpriority_0#3480, co_clerk#3464 AS co_clerk_0#3481, co_shippriority#3465 AS co_shippriority_0#3482, co_comment#3466 AS co_comment_0#3483, co_orderdate#3467 AS co_orderdate_0#3484]
            :  +- Relation[rid#3451,cpfk_customer_orders#3452,cfpk_orders_customer#3453,cval_orders_o_orderstatus#3454,cval_orders_o_totalprice#3455,cval_orders_o_orderpriority#3456,cval_orders_o_clerk#3457,cval_orders_o_shippriority#3458,cval_orders_o_comment#3459,cval_orders_o_orderdate#3460,co_orderstatus#3461,co_totalprice#3462,co_orderpriority#3463,co_clerk#3464,co_shippriority#3465,co_comment#3466,co_orderdate#3467] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#3485 AS rid_1#3500, cpfk_nation_customer#3486 AS cpfk_nation_customer_1#3501, cfpk_customer_nation#3487 AS cfpk_customer_nation_1#3502, cval_customer_c_name#3488 AS cval_customer_c_name_1#3503, cval_customer_c_address#3489 AS cval_customer_c_address_1#3504, cval_customer_c_phone#3490 AS cval_customer_c_phone_1#3505, cval_customer_c_acctbal#3491 AS cval_customer_c_acctbal_1#3506, cval_customer_c_comment#3492 AS cval_customer_c_comment_1#3507, cval_customer_c_mktsegment#3493 AS cval_customer_c_mktsegment_1#3508, cc_name#3494 AS cc_name_1#3509, cc_address#3495 AS cc_address_1#3510, cc_phone#3496 AS cc_phone_1#3511, cc_acctbal#3497 AS cc_acctbal_1#3512, cc_comment#3498 AS cc_comment_1#3513, cc_mktsegment#3499 AS cc_mktsegment_1#3514]
               +- Relation[rid#3485,cpfk_nation_customer#3486,cfpk_customer_nation#3487,cval_customer_c_name#3488,cval_customer_c_address#3489,cval_customer_c_phone#3490,cval_customer_c_acctbal#3491,cval_customer_c_comment#3492,cval_customer_c_mktsegment#3493,cc_name#3494,cc_address#3495,cc_phone#3496,cc_acctbal#3497,cc_comment#3498,cc_mktsegment#3499] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 12768ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 07:00:05 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:00:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3556L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 07:00:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:00:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:00:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:00:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:00:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:00:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:00:05 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:00:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:00:05 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:00:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:00:05 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:00:05 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:00:05 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:00:05 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:00:05 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:00:05 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:00:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3556L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#3558 AS rid_0#3565, cpfk_region_nation#3559 AS cpfk_region_nation_0#3566, cfpk_nation_region#3560 AS cfpk_nation_region_0#3567, cval_nation_n_name#3561 AS cval_nation_n_name_0#3568, cval_nation_n_comment#3562 AS cval_nation_n_comment_0#3569, cn_name#3563 AS cn_name_0#3570, cn_comment#3564 AS cn_comment_0#3571]
            :  :  :     :  :  :  :  :  +- Relation[rid#3558,cpfk_region_nation#3559,cfpk_nation_region#3560,cval_nation_n_name#3561,cval_nation_n_comment#3562,cn_name#3563,cn_comment#3564] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#3598 AS rid_0#3605, cpfk_region_nation#3599 AS cpfk_region_nation_0#3606, cfpk_nation_region#3600 AS cfpk_nation_region_0#3607, cval_nation_n_name#3601 AS cval_nation_n_name_0#3608, cval_nation_n_comment#3602 AS cval_nation_n_comment_0#3609, cn_name#3603 AS cn_name_0#3610, cn_comment#3604 AS cn_comment_0#3611]
            :  :  :     :  :  :  :     :  +- Relation[rid#3598,cpfk_region_nation#3599,cfpk_nation_region#3600,cval_nation_n_name#3601,cval_nation_n_comment#3602,cn_name#3603,cn_comment#3604] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#3612 AS rid_1#3625, cpfk_nation_supplier#3613 AS cpfk_nation_supplier_1#3626, cfpk_supplier_nation#3614 AS cfpk_supplier_nation_1#3627, cval_supplier_s_name#3615 AS cval_supplier_s_name_1#3628, cval_supplier_s_address#3616 AS cval_supplier_s_address_1#3629, cval_supplier_s_phone#3617 AS cval_supplier_s_phone_1#3630, cval_supplier_s_acctbal#3618 AS cval_supplier_s_acctbal_1#3631, cval_supplier_s_comment#3619 AS cval_supplier_s_comment_1#3632, cs_name#3620 AS cs_name_1#3633, cs_address#3621 AS cs_address_1#3634, cs_phone#3622 AS cs_phone_1#3635, cs_acctbal#3623 AS cs_acctbal_1#3636, cs_comment#3624 AS cs_comment_1#3637]
            :  :  :     :  :  :  :        +- Relation[rid#3612,cpfk_nation_supplier#3613,cfpk_supplier_nation#3614,cval_supplier_s_name#3615,cval_supplier_s_address#3616,cval_supplier_s_phone#3617,cval_supplier_s_acctbal#3618,cval_supplier_s_comment#3619,cs_name#3620,cs_address#3621,cs_phone#3622,cs_acctbal#3623,cs_comment#3624] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#3572 AS rid_1#3585, cpfk_nation_supplier#3573 AS cpfk_nation_supplier_1#3586, cfpk_supplier_nation#3574 AS cfpk_supplier_nation_1#3587, cval_supplier_s_name#3575 AS cval_supplier_s_name_1#3588, cval_supplier_s_address#3576 AS cval_supplier_s_address_1#3589, cval_supplier_s_phone#3577 AS cval_supplier_s_phone_1#3590, cval_supplier_s_acctbal#3578 AS cval_supplier_s_acctbal_1#3591, cval_supplier_s_comment#3579 AS cval_supplier_s_comment_1#3592, cs_name#3580 AS cs_name_1#3593, cs_address#3581 AS cs_address_1#3594, cs_phone#3582 AS cs_phone_1#3595, cs_acctbal#3583 AS cs_acctbal_1#3596, cs_comment#3584 AS cs_comment_1#3597]
            :  :  :     :  :  :     +- Relation[rid#3572,cpfk_nation_supplier#3573,cfpk_supplier_nation#3574,cval_supplier_s_name#3575,cval_supplier_s_address#3576,cval_supplier_s_phone#3577,cval_supplier_s_acctbal#3578,cval_supplier_s_comment#3579,cs_name#3580,cs_address#3581,cs_phone#3582,cs_acctbal#3583,cs_comment#3584] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#3660 AS rid_1#3673, cpfk_nation_supplier#3661 AS cpfk_nation_supplier_1#3674, cfpk_supplier_nation#3662 AS cfpk_supplier_nation_1#3675, cval_supplier_s_name#3663 AS cval_supplier_s_name_1#3676, cval_supplier_s_address#3664 AS cval_supplier_s_address_1#3677, cval_supplier_s_phone#3665 AS cval_supplier_s_phone_1#3678, cval_supplier_s_acctbal#3666 AS cval_supplier_s_acctbal_1#3679, cval_supplier_s_comment#3667 AS cval_supplier_s_comment_1#3680, cs_name#3668 AS cs_name_1#3681, cs_address#3669 AS cs_address_1#3682, cs_phone#3670 AS cs_phone_1#3683, cs_acctbal#3671 AS cs_acctbal_1#3684, cs_comment#3672 AS cs_comment_1#3685]
            :  :  :     :  :     :  +- Relation[rid#3660,cpfk_nation_supplier#3661,cfpk_supplier_nation#3662,cval_supplier_s_name#3663,cval_supplier_s_address#3664,cval_supplier_s_phone#3665,cval_supplier_s_acctbal#3666,cval_supplier_s_comment#3667,cs_name#3668,cs_address#3669,cs_phone#3670,cs_acctbal#3671,cs_comment#3672] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#3686 AS rid_2#3697, cpfk_part_partsupp#3687 AS cpfk_part_partsupp_2#3698, cfpk_partsupp_part#3688 AS cfpk_partsupp_part_2#3699, cpfk_supplier_partsupp#3689 AS cpfk_supplier_partsupp_2#3700, cfpk_partsupp_supplier#3690 AS cfpk_partsupp_supplier_2#3701, cval_partsupp_ps_availqty#3691 AS cval_partsupp_ps_availqty_2#3702, cval_partsupp_ps_supplycost#3692 AS cval_partsupp_ps_supplycost_2#3703, cval_partsupp_ps_comment#3693 AS cval_partsupp_ps_comment_2#3704, cps_availqty#3694 AS cps_availqty_2#3705, cps_supplycost#3695 AS cps_supplycost_2#3706, cps_comment#3696 AS cps_comment_2#3707]
            :  :  :     :  :        +- Relation[rid#3686,cpfk_part_partsupp#3687,cfpk_partsupp_part#3688,cpfk_supplier_partsupp#3689,cfpk_partsupp_supplier#3690,cval_partsupp_ps_availqty#3691,cval_partsupp_ps_supplycost#3692,cval_partsupp_ps_comment#3693,cps_availqty#3694,cps_supplycost#3695,cps_comment#3696] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#3638 AS rid_2#3649, cpfk_part_partsupp#3639 AS cpfk_part_partsupp_2#3650, cfpk_partsupp_part#3640 AS cfpk_partsupp_part_2#3651, cpfk_supplier_partsupp#3641 AS cpfk_supplier_partsupp_2#3652, cfpk_partsupp_supplier#3642 AS cfpk_partsupp_supplier_2#3653, cval_partsupp_ps_availqty#3643 AS cval_partsupp_ps_availqty_2#3654, cval_partsupp_ps_supplycost#3644 AS cval_partsupp_ps_supplycost_2#3655, cval_partsupp_ps_comment#3645 AS cval_partsupp_ps_comment_2#3656, cps_availqty#3646 AS cps_availqty_2#3657, cps_supplycost#3647 AS cps_supplycost_2#3658, cps_comment#3648 AS cps_comment_2#3659]
            :  :  :     :     +- Relation[rid#3638,cpfk_part_partsupp#3639,cfpk_partsupp_part#3640,cpfk_supplier_partsupp#3641,cfpk_partsupp_supplier#3642,cval_partsupp_ps_availqty#3643,cval_partsupp_ps_supplycost#3644,cval_partsupp_ps_comment#3645,cps_availqty#3646,cps_supplycost#3647,cps_comment#3648] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#3708 AS rid_3#3725, cval_part_p_name#3709 AS cval_part_p_name_3#3726, cval_part_p_mfgr#3710 AS cval_part_p_mfgr_3#3727, cval_part_p_type#3711 AS cval_part_p_type_3#3728, cval_part_p_size#3712 AS cval_part_p_size_3#3729, cval_part_p_container#3713 AS cval_part_p_container_3#3730, cval_part_p_retailprice#3714 AS cval_part_p_retailprice_3#3731, cval_part_p_comment#3715 AS cval_part_p_comment_3#3732, cval_part_p_brand#3716 AS cval_part_p_brand_3#3733, cp_name#3717 AS cp_name_3#3734, cp_mfgr#3718 AS cp_mfgr_3#3735, cp_type#3719 AS cp_type_3#3736, cp_size#3720 AS cp_size_3#3737, cp_container#3721 AS cp_container_3#3738, cp_retailprice#3722 AS cp_retailprice_3#3739, cp_comment#3723 AS cp_comment_3#3740, cp_brand#3724 AS cp_brand_3#3741]
            :  :  :        +- Relation[rid#3708,cval_part_p_name#3709,cval_part_p_mfgr#3710,cval_part_p_type#3711,cval_part_p_size#3712,cval_part_p_container#3713,cval_part_p_retailprice#3714,cval_part_p_comment#3715,cval_part_p_brand#3716,cp_name#3717,cp_mfgr#3718,cp_type#3719,cp_size#3720,cp_container#3721,cp_retailprice#3722,cp_comment#3723,cp_brand#3724] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#3808 AS rid_2#3819, cpfk_part_partsupp#3809 AS cpfk_part_partsupp_2#3820, cfpk_partsupp_part#3810 AS cfpk_partsupp_part_2#3821, cpfk_supplier_partsupp#3811 AS cpfk_supplier_partsupp_2#3822, cfpk_partsupp_supplier#3812 AS cfpk_partsupp_supplier_2#3823, cval_partsupp_ps_availqty#3813 AS cval_partsupp_ps_availqty_2#3824, cval_partsupp_ps_supplycost#3814 AS cval_partsupp_ps_supplycost_2#3825, cval_partsupp_ps_comment#3815 AS cval_partsupp_ps_comment_2#3826, cps_availqty#3816 AS cps_availqty_2#3827, cps_supplycost#3817 AS cps_supplycost_2#3828, cps_comment#3818 AS cps_comment_2#3829]
            :  :     :  +- Relation[rid#3808,cpfk_part_partsupp#3809,cfpk_partsupp_part#3810,cpfk_supplier_partsupp#3811,cfpk_partsupp_supplier#3812,cval_partsupp_ps_availqty#3813,cval_partsupp_ps_supplycost#3814,cval_partsupp_ps_comment#3815,cps_availqty#3816,cps_supplycost#3817,cps_comment#3818] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#3830 AS rid_4#3863, cpfk_orders_lineitem#3831 AS cpfk_orders_lineitem_4#3864, cpfk_supplier_lineitem#3832 AS cpfk_supplier_lineitem_4#3865, cfpk_lineitem_supplier#3833 AS cfpk_lineitem_supplier_4#3866, cfpk_lineitem_partsupp#3834 AS cfpk_lineitem_partsupp_4#3867, cpfk_part_lineitem#3835 AS cpfk_part_lineitem_4#3868, cfpk_lineitem_part#3836 AS cfpk_lineitem_part_4#3869, cpfk_partsupp_lineitem#3837 AS cpfk_partsupp_lineitem_4#3870, cfpk_lineitem_orders#3838 AS cfpk_lineitem_orders_4#3871, cval_lineitem_l_quantity#3839 AS cval_lineitem_l_quantity_4#3872, cval_lineitem_l_extendedprice#3840 AS cval_lineitem_l_extendedprice_4#3873, cval_lineitem_l_discount#3841 AS cval_lineitem_l_discount_4#3874, cval_lineitem_l_tax#3842 AS cval_lineitem_l_tax_4#3875, cval_lineitem_l_returnflag#3843 AS cval_lineitem_l_returnflag_4#3876, cval_lineitem_l_linestatus#3844 AS cval_lineitem_l_linestatus_4#3877, cval_lineitem_l_commitdate#3845 AS cval_lineitem_l_commitdate_4#3878, cval_lineitem_l_receiptdate#3846 AS cval_lineitem_l_receiptdate_4#3879, cval_lineitem_l_shipinstruct#3847 AS cval_lineitem_l_shipinstruct_4#3880, cval_lineitem_l_shipmode#3848 AS cval_lineitem_l_shipmode_4#3881, cval_lineitem_l_comment#3849 AS cval_lineitem_l_comment_4#3882, cval_lineitem_l_shipdate#3850 AS cval_lineitem_l_shipdate_4#3883, cl_quantity#3851 AS cl_quantity_4#3884, cl_extendedprice#3852 AS cl_extendedprice_4#3885, cl_discount#3853 AS cl_discount_4#3886, ... 9 more fields]
            :  :        +- Relation[rid#3830,cpfk_orders_lineitem#3831,cpfk_supplier_lineitem#3832,cfpk_lineitem_supplier#3833,cfpk_lineitem_partsupp#3834,cpfk_part_lineitem#3835,cfpk_lineitem_part#3836,cpfk_partsupp_lineitem#3837,cfpk_lineitem_orders#3838,cval_lineitem_l_quantity#3839,cval_lineitem_l_extendedprice#3840,cval_lineitem_l_discount#3841,cval_lineitem_l_tax#3842,cval_lineitem_l_returnflag#3843,cval_lineitem_l_linestatus#3844,cval_lineitem_l_commitdate#3845,cval_lineitem_l_receiptdate#3846,cval_lineitem_l_shipinstruct#3847,cval_lineitem_l_shipmode#3848,cval_lineitem_l_comment#3849,cval_lineitem_l_shipdate#3850,cl_quantity#3851,cl_extendedprice#3852,cl_discount#3853,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#3742 AS rid_4#3775, cpfk_orders_lineitem#3743 AS cpfk_orders_lineitem_4#3776, cpfk_supplier_lineitem#3744 AS cpfk_supplier_lineitem_4#3777, cfpk_lineitem_supplier#3745 AS cfpk_lineitem_supplier_4#3778, cfpk_lineitem_partsupp#3746 AS cfpk_lineitem_partsupp_4#3779, cpfk_part_lineitem#3747 AS cpfk_part_lineitem_4#3780, cfpk_lineitem_part#3748 AS cfpk_lineitem_part_4#3781, cpfk_partsupp_lineitem#3749 AS cpfk_partsupp_lineitem_4#3782, cfpk_lineitem_orders#3750 AS cfpk_lineitem_orders_4#3783, cval_lineitem_l_quantity#3751 AS cval_lineitem_l_quantity_4#3784, cval_lineitem_l_extendedprice#3752 AS cval_lineitem_l_extendedprice_4#3785, cval_lineitem_l_discount#3753 AS cval_lineitem_l_discount_4#3786, cval_lineitem_l_tax#3754 AS cval_lineitem_l_tax_4#3787, cval_lineitem_l_returnflag#3755 AS cval_lineitem_l_returnflag_4#3788, cval_lineitem_l_linestatus#3756 AS cval_lineitem_l_linestatus_4#3789, cval_lineitem_l_commitdate#3757 AS cval_lineitem_l_commitdate_4#3790, cval_lineitem_l_receiptdate#3758 AS cval_lineitem_l_receiptdate_4#3791, cval_lineitem_l_shipinstruct#3759 AS cval_lineitem_l_shipinstruct_4#3792, cval_lineitem_l_shipmode#3760 AS cval_lineitem_l_shipmode_4#3793, cval_lineitem_l_comment#3761 AS cval_lineitem_l_comment_4#3794, cval_lineitem_l_shipdate#3762 AS cval_lineitem_l_shipdate_4#3795, cl_quantity#3763 AS cl_quantity_4#3796, cl_extendedprice#3764 AS cl_extendedprice_4#3797, cl_discount#3765 AS cl_discount_4#3798, ... 9 more fields]
            :     +- Relation[rid#3742,cpfk_orders_lineitem#3743,cpfk_supplier_lineitem#3744,cfpk_lineitem_supplier#3745,cfpk_lineitem_partsupp#3746,cpfk_part_lineitem#3747,cfpk_lineitem_part#3748,cpfk_partsupp_lineitem#3749,cfpk_lineitem_orders#3750,cval_lineitem_l_quantity#3751,cval_lineitem_l_extendedprice#3752,cval_lineitem_l_discount#3753,cval_lineitem_l_tax#3754,cval_lineitem_l_returnflag#3755,cval_lineitem_l_linestatus#3756,cval_lineitem_l_commitdate#3757,cval_lineitem_l_receiptdate#3758,cval_lineitem_l_shipinstruct#3759,cval_lineitem_l_shipmode#3760,cval_lineitem_l_comment#3761,cval_lineitem_l_shipdate#3762,cl_quantity#3763,cl_extendedprice#3764,cl_discount#3765,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#3896 AS rid_5#3913, cpfk_customer_orders#3897 AS cpfk_customer_orders_5#3914, cfpk_orders_customer#3898 AS cfpk_orders_customer_5#3915, cval_orders_o_orderstatus#3899 AS cval_orders_o_orderstatus_5#3916, cval_orders_o_totalprice#3900 AS cval_orders_o_totalprice_5#3917, cval_orders_o_orderpriority#3901 AS cval_orders_o_orderpriority_5#3918, cval_orders_o_clerk#3902 AS cval_orders_o_clerk_5#3919, cval_orders_o_shippriority#3903 AS cval_orders_o_shippriority_5#3920, cval_orders_o_comment#3904 AS cval_orders_o_comment_5#3921, cval_orders_o_orderdate#3905 AS cval_orders_o_orderdate_5#3922, co_orderstatus#3906 AS co_orderstatus_5#3923, co_totalprice#3907 AS co_totalprice_5#3924, co_orderpriority#3908 AS co_orderpriority_5#3925, co_clerk#3909 AS co_clerk_5#3926, co_shippriority#3910 AS co_shippriority_5#3927, co_comment#3911 AS co_comment_5#3928, co_orderdate#3912 AS co_orderdate_5#3929]
               +- Relation[rid#3896,cpfk_customer_orders#3897,cfpk_orders_customer#3898,cval_orders_o_orderstatus#3899,cval_orders_o_totalprice#3900,cval_orders_o_orderpriority#3901,cval_orders_o_clerk#3902,cval_orders_o_shippriority#3903,cval_orders_o_comment#3904,cval_orders_o_orderdate#3905,co_orderstatus#3906,co_totalprice#3907,co_orderpriority#3908,co_clerk#3909,co_shippriority#3910,co_comment#3911,co_orderdate#3912] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 162470ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/11 07:02:47 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:02:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4032L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 07:02:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4032L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#4034 AS rid_0#4067, cpfk_orders_lineitem#4035 AS cpfk_orders_lineitem_0#4068, cpfk_supplier_lineitem#4036 AS cpfk_supplier_lineitem_0#4069, cfpk_lineitem_supplier#4037 AS cfpk_lineitem_supplier_0#4070, cfpk_lineitem_partsupp#4038 AS cfpk_lineitem_partsupp_0#4071, cpfk_part_lineitem#4039 AS cpfk_part_lineitem_0#4072, cfpk_lineitem_part#4040 AS cfpk_lineitem_part_0#4073, cpfk_partsupp_lineitem#4041 AS cpfk_partsupp_lineitem_0#4074, cfpk_lineitem_orders#4042 AS cfpk_lineitem_orders_0#4075, cval_lineitem_l_quantity#4043 AS cval_lineitem_l_quantity_0#4076, cval_lineitem_l_extendedprice#4044 AS cval_lineitem_l_extendedprice_0#4077, cval_lineitem_l_discount#4045 AS cval_lineitem_l_discount_0#4078, cval_lineitem_l_tax#4046 AS cval_lineitem_l_tax_0#4079, cval_lineitem_l_returnflag#4047 AS cval_lineitem_l_returnflag_0#4080, cval_lineitem_l_linestatus#4048 AS cval_lineitem_l_linestatus_0#4081, cval_lineitem_l_commitdate#4049 AS cval_lineitem_l_commitdate_0#4082, cval_lineitem_l_receiptdate#4050 AS cval_lineitem_l_receiptdate_0#4083, cval_lineitem_l_shipinstruct#4051 AS cval_lineitem_l_shipinstruct_0#4084, cval_lineitem_l_shipmode#4052 AS cval_lineitem_l_shipmode_0#4085, cval_lineitem_l_comment#4053 AS cval_lineitem_l_comment_0#4086, cval_lineitem_l_shipdate#4054 AS cval_lineitem_l_shipdate_0#4087, cl_quantity#4055 AS cl_quantity_0#4088, cl_extendedprice#4056 AS cl_extendedprice_0#4089, cl_discount#4057 AS cl_discount_0#4090, ... 9 more fields]
            :  :  +- Relation[rid#4034,cpfk_orders_lineitem#4035,cpfk_supplier_lineitem#4036,cfpk_lineitem_supplier#4037,cfpk_lineitem_partsupp#4038,cpfk_part_lineitem#4039,cfpk_lineitem_part#4040,cpfk_partsupp_lineitem#4041,cfpk_lineitem_orders#4042,cval_lineitem_l_quantity#4043,cval_lineitem_l_extendedprice#4044,cval_lineitem_l_discount#4045,cval_lineitem_l_tax#4046,cval_lineitem_l_returnflag#4047,cval_lineitem_l_linestatus#4048,cval_lineitem_l_commitdate#4049,cval_lineitem_l_receiptdate#4050,cval_lineitem_l_shipinstruct#4051,cval_lineitem_l_shipmode#4052,cval_lineitem_l_comment#4053,cval_lineitem_l_shipdate#4054,cl_quantity#4055,cl_extendedprice#4056,cl_discount#4057,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#4100 AS rid_0#4133, cpfk_orders_lineitem#4101 AS cpfk_orders_lineitem_0#4134, cpfk_supplier_lineitem#4102 AS cpfk_supplier_lineitem_0#4135, cfpk_lineitem_supplier#4103 AS cfpk_lineitem_supplier_0#4136, cfpk_lineitem_partsupp#4104 AS cfpk_lineitem_partsupp_0#4137, cpfk_part_lineitem#4105 AS cpfk_part_lineitem_0#4138, cfpk_lineitem_part#4106 AS cfpk_lineitem_part_0#4139, cpfk_partsupp_lineitem#4107 AS cpfk_partsupp_lineitem_0#4140, cfpk_lineitem_orders#4108 AS cfpk_lineitem_orders_0#4141, cval_lineitem_l_quantity#4109 AS cval_lineitem_l_quantity_0#4142, cval_lineitem_l_extendedprice#4110 AS cval_lineitem_l_extendedprice_0#4143, cval_lineitem_l_discount#4111 AS cval_lineitem_l_discount_0#4144, cval_lineitem_l_tax#4112 AS cval_lineitem_l_tax_0#4145, cval_lineitem_l_returnflag#4113 AS cval_lineitem_l_returnflag_0#4146, cval_lineitem_l_linestatus#4114 AS cval_lineitem_l_linestatus_0#4147, cval_lineitem_l_commitdate#4115 AS cval_lineitem_l_commitdate_0#4148, cval_lineitem_l_receiptdate#4116 AS cval_lineitem_l_receiptdate_0#4149, cval_lineitem_l_shipinstruct#4117 AS cval_lineitem_l_shipinstruct_0#4150, cval_lineitem_l_shipmode#4118 AS cval_lineitem_l_shipmode_0#4151, cval_lineitem_l_comment#4119 AS cval_lineitem_l_comment_0#4152, cval_lineitem_l_shipdate#4120 AS cval_lineitem_l_shipdate_0#4153, cl_quantity#4121 AS cl_quantity_0#4154, cl_extendedprice#4122 AS cl_extendedprice_0#4155, cl_discount#4123 AS cl_discount_0#4156, ... 9 more fields]
            :        +- Relation[rid#4100,cpfk_orders_lineitem#4101,cpfk_supplier_lineitem#4102,cfpk_lineitem_supplier#4103,cfpk_lineitem_partsupp#4104,cpfk_part_lineitem#4105,cfpk_lineitem_part#4106,cpfk_partsupp_lineitem#4107,cfpk_lineitem_orders#4108,cval_lineitem_l_quantity#4109,cval_lineitem_l_extendedprice#4110,cval_lineitem_l_discount#4111,cval_lineitem_l_tax#4112,cval_lineitem_l_returnflag#4113,cval_lineitem_l_linestatus#4114,cval_lineitem_l_commitdate#4115,cval_lineitem_l_receiptdate#4116,cval_lineitem_l_shipinstruct#4117,cval_lineitem_l_shipmode#4118,cval_lineitem_l_comment#4119,cval_lineitem_l_shipdate#4120,cl_quantity#4121,cl_extendedprice#4122,cl_discount#4123,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#4166 AS rid_1#4183, cpfk_customer_orders#4167 AS cpfk_customer_orders_1#4184, cfpk_orders_customer#4168 AS cfpk_orders_customer_1#4185, cval_orders_o_orderstatus#4169 AS cval_orders_o_orderstatus_1#4186, cval_orders_o_totalprice#4170 AS cval_orders_o_totalprice_1#4187, cval_orders_o_orderpriority#4171 AS cval_orders_o_orderpriority_1#4188, cval_orders_o_clerk#4172 AS cval_orders_o_clerk_1#4189, cval_orders_o_shippriority#4173 AS cval_orders_o_shippriority_1#4190, cval_orders_o_comment#4174 AS cval_orders_o_comment_1#4191, cval_orders_o_orderdate#4175 AS cval_orders_o_orderdate_1#4192, co_orderstatus#4176 AS co_orderstatus_1#4193, co_totalprice#4177 AS co_totalprice_1#4194, co_orderpriority#4178 AS co_orderpriority_1#4195, co_clerk#4179 AS co_clerk_1#4196, co_shippriority#4180 AS co_shippriority_1#4197, co_comment#4181 AS co_comment_1#4198, co_orderdate#4182 AS co_orderdate_1#4199]
               +- Relation[rid#4166,cpfk_customer_orders#4167,cfpk_orders_customer#4168,cval_orders_o_orderstatus#4169,cval_orders_o_totalprice#4170,cval_orders_o_orderpriority#4171,cval_orders_o_clerk#4172,cval_orders_o_shippriority#4173,cval_orders_o_comment#4174,cval_orders_o_orderdate#4175,co_orderstatus#4176,co_totalprice#4177,co_orderpriority#4178,co_clerk#4179,co_shippriority#4180,co_comment#4181,co_orderdate#4182] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 21421ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/11 07:03:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:03:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4257L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 07:03:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:03:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:03:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:03:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4257L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#4259 AS rid_0#4272, cpfk_nation_supplier#4260 AS cpfk_nation_supplier_0#4273, cfpk_supplier_nation#4261 AS cfpk_supplier_nation_0#4274, cval_supplier_s_name#4262 AS cval_supplier_s_name_0#4275, cval_supplier_s_address#4263 AS cval_supplier_s_address_0#4276, cval_supplier_s_phone#4264 AS cval_supplier_s_phone_0#4277, cval_supplier_s_acctbal#4265 AS cval_supplier_s_acctbal_0#4278, cval_supplier_s_comment#4266 AS cval_supplier_s_comment_0#4279, cs_name#4267 AS cs_name_0#4280, cs_address#4268 AS cs_address_0#4281, cs_phone#4269 AS cs_phone_0#4282, cs_acctbal#4270 AS cs_acctbal_0#4283, cs_comment#4271 AS cs_comment_0#4284]
         :  :  +- Relation[rid#4259,cpfk_nation_supplier#4260,cfpk_supplier_nation#4261,cval_supplier_s_name#4262,cval_supplier_s_address#4263,cval_supplier_s_phone#4264,cval_supplier_s_acctbal#4265,cval_supplier_s_comment#4266,cs_name#4267,cs_address#4268,cs_phone#4269,cs_acctbal#4270,cs_comment#4271] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#4351 AS rid_0#4364, cpfk_nation_supplier#4352 AS cpfk_nation_supplier_0#4365, cfpk_supplier_nation#4353 AS cfpk_supplier_nation_0#4366, cval_supplier_s_name#4354 AS cval_supplier_s_name_0#4367, cval_supplier_s_address#4355 AS cval_supplier_s_address_0#4368, cval_supplier_s_phone#4356 AS cval_supplier_s_phone_0#4369, cval_supplier_s_acctbal#4357 AS cval_supplier_s_acctbal_0#4370, cval_supplier_s_comment#4358 AS cval_supplier_s_comment_0#4371, cs_name#4359 AS cs_name_0#4372, cs_address#4360 AS cs_address_0#4373, cs_phone#4361 AS cs_phone_0#4374, cs_acctbal#4362 AS cs_acctbal_0#4375, cs_comment#4363 AS cs_comment_0#4376]
         :     :  +- Relation[rid#4351,cpfk_nation_supplier#4352,cfpk_supplier_nation#4353,cval_supplier_s_name#4354,cval_supplier_s_address#4355,cval_supplier_s_phone#4356,cval_supplier_s_acctbal#4357,cval_supplier_s_comment#4358,cs_name#4359,cs_address#4360,cs_phone#4361,cs_acctbal#4362,cs_comment#4363] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#4377 AS rid_1#4410, cpfk_orders_lineitem#4378 AS cpfk_orders_lineitem_1#4411, cpfk_supplier_lineitem#4379 AS cpfk_supplier_lineitem_1#4412, cfpk_lineitem_supplier#4380 AS cfpk_lineitem_supplier_1#4413, cfpk_lineitem_partsupp#4381 AS cfpk_lineitem_partsupp_1#4414, cpfk_part_lineitem#4382 AS cpfk_part_lineitem_1#4415, cfpk_lineitem_part#4383 AS cfpk_lineitem_part_1#4416, cpfk_partsupp_lineitem#4384 AS cpfk_partsupp_lineitem_1#4417, cfpk_lineitem_orders#4385 AS cfpk_lineitem_orders_1#4418, cval_lineitem_l_quantity#4386 AS cval_lineitem_l_quantity_1#4419, cval_lineitem_l_extendedprice#4387 AS cval_lineitem_l_extendedprice_1#4420, cval_lineitem_l_discount#4388 AS cval_lineitem_l_discount_1#4421, cval_lineitem_l_tax#4389 AS cval_lineitem_l_tax_1#4422, cval_lineitem_l_returnflag#4390 AS cval_lineitem_l_returnflag_1#4423, cval_lineitem_l_linestatus#4391 AS cval_lineitem_l_linestatus_1#4424, cval_lineitem_l_commitdate#4392 AS cval_lineitem_l_commitdate_1#4425, cval_lineitem_l_receiptdate#4393 AS cval_lineitem_l_receiptdate_1#4426, cval_lineitem_l_shipinstruct#4394 AS cval_lineitem_l_shipinstruct_1#4427, cval_lineitem_l_shipmode#4395 AS cval_lineitem_l_shipmode_1#4428, cval_lineitem_l_comment#4396 AS cval_lineitem_l_comment_1#4429, cval_lineitem_l_shipdate#4397 AS cval_lineitem_l_shipdate_1#4430, cl_quantity#4398 AS cl_quantity_1#4431, cl_extendedprice#4399 AS cl_extendedprice_1#4432, cl_discount#4400 AS cl_discount_1#4433, ... 9 more fields]
         :        +- Relation[rid#4377,cpfk_orders_lineitem#4378,cpfk_supplier_lineitem#4379,cfpk_lineitem_supplier#4380,cfpk_lineitem_partsupp#4381,cpfk_part_lineitem#4382,cfpk_lineitem_part#4383,cpfk_partsupp_lineitem#4384,cfpk_lineitem_orders#4385,cval_lineitem_l_quantity#4386,cval_lineitem_l_extendedprice#4387,cval_lineitem_l_discount#4388,cval_lineitem_l_tax#4389,cval_lineitem_l_returnflag#4390,cval_lineitem_l_linestatus#4391,cval_lineitem_l_commitdate#4392,cval_lineitem_l_receiptdate#4393,cval_lineitem_l_shipinstruct#4394,cval_lineitem_l_shipmode#4395,cval_lineitem_l_comment#4396,cval_lineitem_l_shipdate#4397,cl_quantity#4398,cl_extendedprice#4399,cl_discount#4400,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4285 AS rid_1#4318, cpfk_orders_lineitem#4286 AS cpfk_orders_lineitem_1#4319, cpfk_supplier_lineitem#4287 AS cpfk_supplier_lineitem_1#4320, cfpk_lineitem_supplier#4288 AS cfpk_lineitem_supplier_1#4321, cfpk_lineitem_partsupp#4289 AS cfpk_lineitem_partsupp_1#4322, cpfk_part_lineitem#4290 AS cpfk_part_lineitem_1#4323, cfpk_lineitem_part#4291 AS cfpk_lineitem_part_1#4324, cpfk_partsupp_lineitem#4292 AS cpfk_partsupp_lineitem_1#4325, cfpk_lineitem_orders#4293 AS cfpk_lineitem_orders_1#4326, cval_lineitem_l_quantity#4294 AS cval_lineitem_l_quantity_1#4327, cval_lineitem_l_extendedprice#4295 AS cval_lineitem_l_extendedprice_1#4328, cval_lineitem_l_discount#4296 AS cval_lineitem_l_discount_1#4329, cval_lineitem_l_tax#4297 AS cval_lineitem_l_tax_1#4330, cval_lineitem_l_returnflag#4298 AS cval_lineitem_l_returnflag_1#4331, cval_lineitem_l_linestatus#4299 AS cval_lineitem_l_linestatus_1#4332, cval_lineitem_l_commitdate#4300 AS cval_lineitem_l_commitdate_1#4333, cval_lineitem_l_receiptdate#4301 AS cval_lineitem_l_receiptdate_1#4334, cval_lineitem_l_shipinstruct#4302 AS cval_lineitem_l_shipinstruct_1#4335, cval_lineitem_l_shipmode#4303 AS cval_lineitem_l_shipmode_1#4336, cval_lineitem_l_comment#4304 AS cval_lineitem_l_comment_1#4337, cval_lineitem_l_shipdate#4305 AS cval_lineitem_l_shipdate_1#4338, cl_quantity#4306 AS cl_quantity_1#4339, cl_extendedprice#4307 AS cl_extendedprice_1#4340, cl_discount#4308 AS cl_discount_1#4341, ... 9 more fields]
            +- Relation[rid#4285,cpfk_orders_lineitem#4286,cpfk_supplier_lineitem#4287,cfpk_lineitem_supplier#4288,cfpk_lineitem_partsupp#4289,cpfk_part_lineitem#4290,cfpk_lineitem_part#4291,cpfk_partsupp_lineitem#4292,cfpk_lineitem_orders#4293,cval_lineitem_l_quantity#4294,cval_lineitem_l_extendedprice#4295,cval_lineitem_l_discount#4296,cval_lineitem_l_tax#4297,cval_lineitem_l_returnflag#4298,cval_lineitem_l_linestatus#4299,cval_lineitem_l_commitdate#4300,cval_lineitem_l_receiptdate#4301,cval_lineitem_l_shipinstruct#4302,cval_lineitem_l_shipmode#4303,cval_lineitem_l_comment#4304,cval_lineitem_l_shipdate#4305,cl_quantity#4306,cl_extendedprice#4307,cl_discount#4308,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 78204ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/11 07:04:27 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:04:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4496L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 07:04:27 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:04:27 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:04:27 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:04:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4496L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#4498 AS rid_0#4515, cval_part_p_name#4499 AS cval_part_p_name_0#4516, cval_part_p_mfgr#4500 AS cval_part_p_mfgr_0#4517, cval_part_p_type#4501 AS cval_part_p_type_0#4518, cval_part_p_size#4502 AS cval_part_p_size_0#4519, cval_part_p_container#4503 AS cval_part_p_container_0#4520, cval_part_p_retailprice#4504 AS cval_part_p_retailprice_0#4521, cval_part_p_comment#4505 AS cval_part_p_comment_0#4522, cval_part_p_brand#4506 AS cval_part_p_brand_0#4523, cp_name#4507 AS cp_name_0#4524, cp_mfgr#4508 AS cp_mfgr_0#4525, cp_type#4509 AS cp_type_0#4526, cp_size#4510 AS cp_size_0#4527, cp_container#4511 AS cp_container_0#4528, cp_retailprice#4512 AS cp_retailprice_0#4529, cp_comment#4513 AS cp_comment_0#4530, cp_brand#4514 AS cp_brand_0#4531]
         :  :  :  +- Relation[rid#4498,cval_part_p_name#4499,cval_part_p_mfgr#4500,cval_part_p_type#4501,cval_part_p_size#4502,cval_part_p_container#4503,cval_part_p_retailprice#4504,cval_part_p_comment#4505,cval_part_p_brand#4506,cp_name#4507,cp_mfgr#4508,cp_type#4509,cp_size#4510,cp_container#4511,cp_retailprice#4512,cp_comment#4513,cp_brand#4514] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#4532 AS rid_0#4549, cval_part_p_name#4533 AS cval_part_p_name_0#4550, cval_part_p_mfgr#4534 AS cval_part_p_mfgr_0#4551, cval_part_p_type#4535 AS cval_part_p_type_0#4552, cval_part_p_size#4536 AS cval_part_p_size_0#4553, cval_part_p_container#4537 AS cval_part_p_container_0#4554, cval_part_p_retailprice#4538 AS cval_part_p_retailprice_0#4555, cval_part_p_comment#4539 AS cval_part_p_comment_0#4556, cval_part_p_brand#4540 AS cval_part_p_brand_0#4557, cp_name#4541 AS cp_name_0#4558, cp_mfgr#4542 AS cp_mfgr_0#4559, cp_type#4543 AS cp_type_0#4560, cp_size#4544 AS cp_size_0#4561, cp_container#4545 AS cp_container_0#4562, cp_retailprice#4546 AS cp_retailprice_0#4563, cp_comment#4547 AS cp_comment_0#4564, cp_brand#4548 AS cp_brand_0#4565]
         :  :        +- Relation[rid#4532,cval_part_p_name#4533,cval_part_p_mfgr#4534,cval_part_p_type#4535,cval_part_p_size#4536,cval_part_p_container#4537,cval_part_p_retailprice#4538,cval_part_p_comment#4539,cval_part_p_brand#4540,cp_name#4541,cp_mfgr#4542,cp_type#4543,cp_size#4544,cp_container#4545,cp_retailprice#4546,cp_comment#4547,cp_brand#4548] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :     :- Project [rid#4588 AS rid_0#4605, cval_part_p_name#4589 AS cval_part_p_name_0#4606, cval_part_p_mfgr#4590 AS cval_part_p_mfgr_0#4607, cval_part_p_type#4591 AS cval_part_p_type_0#4608, cval_part_p_size#4592 AS cval_part_p_size_0#4609, cval_part_p_container#4593 AS cval_part_p_container_0#4610, cval_part_p_retailprice#4594 AS cval_part_p_retailprice_0#4611, cval_part_p_comment#4595 AS cval_part_p_comment_0#4612, cval_part_p_brand#4596 AS cval_part_p_brand_0#4613, cp_name#4597 AS cp_name_0#4614, cp_mfgr#4598 AS cp_mfgr_0#4615, cp_type#4599 AS cp_type_0#4616, cp_size#4600 AS cp_size_0#4617, cp_container#4601 AS cp_container_0#4618, cp_retailprice#4602 AS cp_retailprice_0#4619, cp_comment#4603 AS cp_comment_0#4620, cp_brand#4604 AS cp_brand_0#4621]
         :     :  +- Relation[rid#4588,cval_part_p_name#4589,cval_part_p_mfgr#4590,cval_part_p_type#4591,cval_part_p_size#4592,cval_part_p_container#4593,cval_part_p_retailprice#4594,cval_part_p_comment#4595,cval_part_p_brand#4596,cp_name#4597,cp_mfgr#4598,cp_type#4599,cp_size#4600,cp_container#4601,cp_retailprice#4602,cp_comment#4603,cp_brand#4604] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#4622 AS rid_1#4633, cpfk_part_partsupp#4623 AS cpfk_part_partsupp_1#4634, cfpk_partsupp_part#4624 AS cfpk_partsupp_part_1#4635, cpfk_supplier_partsupp#4625 AS cpfk_supplier_partsupp_1#4636, cfpk_partsupp_supplier#4626 AS cfpk_partsupp_supplier_1#4637, cval_partsupp_ps_availqty#4627 AS cval_partsupp_ps_availqty_1#4638, cval_partsupp_ps_supplycost#4628 AS cval_partsupp_ps_supplycost_1#4639, cval_partsupp_ps_comment#4629 AS cval_partsupp_ps_comment_1#4640, cps_availqty#4630 AS cps_availqty_1#4641, cps_supplycost#4631 AS cps_supplycost_1#4642, cps_comment#4632 AS cps_comment_1#4643]
         :        +- Relation[rid#4622,cpfk_part_partsupp#4623,cfpk_partsupp_part#4624,cpfk_supplier_partsupp#4625,cfpk_partsupp_supplier#4626,cval_partsupp_ps_availqty#4627,cval_partsupp_ps_supplycost#4628,cval_partsupp_ps_comment#4629,cps_availqty#4630,cps_supplycost#4631,cps_comment#4632] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#4566 AS rid_1#4577, cpfk_part_partsupp#4567 AS cpfk_part_partsupp_1#4578, cfpk_partsupp_part#4568 AS cfpk_partsupp_part_1#4579, cpfk_supplier_partsupp#4569 AS cpfk_supplier_partsupp_1#4580, cfpk_partsupp_supplier#4570 AS cfpk_partsupp_supplier_1#4581, cval_partsupp_ps_availqty#4571 AS cval_partsupp_ps_availqty_1#4582, cval_partsupp_ps_supplycost#4572 AS cval_partsupp_ps_supplycost_1#4583, cval_partsupp_ps_comment#4573 AS cval_partsupp_ps_comment_1#4584, cps_availqty#4574 AS cps_availqty_1#4585, cps_supplycost#4575 AS cps_supplycost_1#4586, cps_comment#4576 AS cps_comment_1#4587]
            +- Relation[rid#4566,cpfk_part_partsupp#4567,cfpk_partsupp_part#4568,cpfk_supplier_partsupp#4569,cfpk_partsupp_supplier#4570,cval_partsupp_ps_availqty#4571,cval_partsupp_ps_supplycost#4572,cval_partsupp_ps_comment#4573,cps_availqty#4574,cps_supplycost#4575,cps_comment#4576] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 11029ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/11 07:04:38 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:04:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4680L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 07:04:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:04:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:04:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:04:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:04:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:04:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:04:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:04:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:04:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:04:38 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:04:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:04:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:04:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:04:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:04:38 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:04:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4680L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#4682 AS rid_0#4689, cpfk_region_nation#4683 AS cpfk_region_nation_0#4690, cfpk_nation_region#4684 AS cfpk_nation_region_0#4691, cval_nation_n_name#4685 AS cval_nation_n_name_0#4692, cval_nation_n_comment#4686 AS cval_nation_n_comment_0#4693, cn_name#4687 AS cn_name_0#4694, cn_comment#4688 AS cn_comment_0#4695]
            :  :  :  :  :  :  +- Relation[rid#4682,cpfk_region_nation#4683,cfpk_nation_region#4684,cval_nation_n_name#4685,cval_nation_n_comment#4686,cn_name#4687,cn_comment#4688] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#4696 AS rid_0#4703, cpfk_region_nation#4697 AS cpfk_region_nation_0#4704, cfpk_nation_region#4698 AS cfpk_nation_region_0#4705, cval_nation_n_name#4699 AS cval_nation_n_name_0#4706, cval_nation_n_comment#4700 AS cval_nation_n_comment_0#4707, cn_name#4701 AS cn_name_0#4708, cn_comment#4702 AS cn_comment_0#4709]
            :  :  :  :  :        +- Relation[rid#4696,cpfk_region_nation#4697,cfpk_nation_region#4698,cval_nation_n_name#4699,cval_nation_n_comment#4700,cn_name#4701,cn_comment#4702] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :     :- Project [rid#4736 AS rid_0#4743, cpfk_region_nation#4737 AS cpfk_region_nation_0#4744, cfpk_nation_region#4738 AS cfpk_nation_region_0#4745, cval_nation_n_name#4739 AS cval_nation_n_name_0#4746, cval_nation_n_comment#4740 AS cval_nation_n_comment_0#4747, cn_name#4741 AS cn_name_0#4748, cn_comment#4742 AS cn_comment_0#4749]
            :  :  :  :     :  +- Relation[rid#4736,cpfk_region_nation#4737,cfpk_nation_region#4738,cval_nation_n_name#4739,cval_nation_n_comment#4740,cn_name#4741,cn_comment#4742] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :     +- Project [rid#4750 AS rid_1#4763, cpfk_nation_supplier#4751 AS cpfk_nation_supplier_1#4764, cfpk_supplier_nation#4752 AS cfpk_supplier_nation_1#4765, cval_supplier_s_name#4753 AS cval_supplier_s_name_1#4766, cval_supplier_s_address#4754 AS cval_supplier_s_address_1#4767, cval_supplier_s_phone#4755 AS cval_supplier_s_phone_1#4768, cval_supplier_s_acctbal#4756 AS cval_supplier_s_acctbal_1#4769, cval_supplier_s_comment#4757 AS cval_supplier_s_comment_1#4770, cs_name#4758 AS cs_name_1#4771, cs_address#4759 AS cs_address_1#4772, cs_phone#4760 AS cs_phone_1#4773, cs_acctbal#4761 AS cs_acctbal_1#4774, cs_comment#4762 AS cs_comment_1#4775]
            :  :  :  :        +- Relation[rid#4750,cpfk_nation_supplier#4751,cfpk_supplier_nation#4752,cval_supplier_s_name#4753,cval_supplier_s_address#4754,cval_supplier_s_phone#4755,cval_supplier_s_acctbal#4756,cval_supplier_s_comment#4757,cs_name#4758,cs_address#4759,cs_phone#4760,cs_acctbal#4761,cs_comment#4762] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#4710 AS rid_1#4723, cpfk_nation_supplier#4711 AS cpfk_nation_supplier_1#4724, cfpk_supplier_nation#4712 AS cfpk_supplier_nation_1#4725, cval_supplier_s_name#4713 AS cval_supplier_s_name_1#4726, cval_supplier_s_address#4714 AS cval_supplier_s_address_1#4727, cval_supplier_s_phone#4715 AS cval_supplier_s_phone_1#4728, cval_supplier_s_acctbal#4716 AS cval_supplier_s_acctbal_1#4729, cval_supplier_s_comment#4717 AS cval_supplier_s_comment_1#4730, cs_name#4718 AS cs_name_1#4731, cs_address#4719 AS cs_address_1#4732, cs_phone#4720 AS cs_phone_1#4733, cs_acctbal#4721 AS cs_acctbal_1#4734, cs_comment#4722 AS cs_comment_1#4735]
            :  :  :     +- Relation[rid#4710,cpfk_nation_supplier#4711,cfpk_supplier_nation#4712,cval_supplier_s_name#4713,cval_supplier_s_address#4714,cval_supplier_s_phone#4715,cval_supplier_s_acctbal#4716,cval_supplier_s_comment#4717,cs_name#4718,cs_address#4719,cs_phone#4720,cs_acctbal#4721,cs_comment#4722] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :     :- Project [rid#4842 AS rid_1#4855, cpfk_nation_supplier#4843 AS cpfk_nation_supplier_1#4856, cfpk_supplier_nation#4844 AS cfpk_supplier_nation_1#4857, cval_supplier_s_name#4845 AS cval_supplier_s_name_1#4858, cval_supplier_s_address#4846 AS cval_supplier_s_address_1#4859, cval_supplier_s_phone#4847 AS cval_supplier_s_phone_1#4860, cval_supplier_s_acctbal#4848 AS cval_supplier_s_acctbal_1#4861, cval_supplier_s_comment#4849 AS cval_supplier_s_comment_1#4862, cs_name#4850 AS cs_name_1#4863, cs_address#4851 AS cs_address_1#4864, cs_phone#4852 AS cs_phone_1#4865, cs_acctbal#4853 AS cs_acctbal_1#4866, cs_comment#4854 AS cs_comment_1#4867]
            :  :     :  +- Relation[rid#4842,cpfk_nation_supplier#4843,cfpk_supplier_nation#4844,cval_supplier_s_name#4845,cval_supplier_s_address#4846,cval_supplier_s_phone#4847,cval_supplier_s_acctbal#4848,cval_supplier_s_comment#4849,cs_name#4850,cs_address#4851,cs_phone#4852,cs_acctbal#4853,cs_comment#4854] JDBCRelation(tsupplier) [numPartitions=1]
            :  :     +- Project [rid#4868 AS rid_2#4901, cpfk_orders_lineitem#4869 AS cpfk_orders_lineitem_2#4902, cpfk_supplier_lineitem#4870 AS cpfk_supplier_lineitem_2#4903, cfpk_lineitem_supplier#4871 AS cfpk_lineitem_supplier_2#4904, cfpk_lineitem_partsupp#4872 AS cfpk_lineitem_partsupp_2#4905, cpfk_part_lineitem#4873 AS cpfk_part_lineitem_2#4906, cfpk_lineitem_part#4874 AS cfpk_lineitem_part_2#4907, cpfk_partsupp_lineitem#4875 AS cpfk_partsupp_lineitem_2#4908, cfpk_lineitem_orders#4876 AS cfpk_lineitem_orders_2#4909, cval_lineitem_l_quantity#4877 AS cval_lineitem_l_quantity_2#4910, cval_lineitem_l_extendedprice#4878 AS cval_lineitem_l_extendedprice_2#4911, cval_lineitem_l_discount#4879 AS cval_lineitem_l_discount_2#4912, cval_lineitem_l_tax#4880 AS cval_lineitem_l_tax_2#4913, cval_lineitem_l_returnflag#4881 AS cval_lineitem_l_returnflag_2#4914, cval_lineitem_l_linestatus#4882 AS cval_lineitem_l_linestatus_2#4915, cval_lineitem_l_commitdate#4883 AS cval_lineitem_l_commitdate_2#4916, cval_lineitem_l_receiptdate#4884 AS cval_lineitem_l_receiptdate_2#4917, cval_lineitem_l_shipinstruct#4885 AS cval_lineitem_l_shipinstruct_2#4918, cval_lineitem_l_shipmode#4886 AS cval_lineitem_l_shipmode_2#4919, cval_lineitem_l_comment#4887 AS cval_lineitem_l_comment_2#4920, cval_lineitem_l_shipdate#4888 AS cval_lineitem_l_shipdate_2#4921, cl_quantity#4889 AS cl_quantity_2#4922, cl_extendedprice#4890 AS cl_extendedprice_2#4923, cl_discount#4891 AS cl_discount_2#4924, ... 9 more fields]
            :  :        +- Relation[rid#4868,cpfk_orders_lineitem#4869,cpfk_supplier_lineitem#4870,cfpk_lineitem_supplier#4871,cfpk_lineitem_partsupp#4872,cpfk_part_lineitem#4873,cfpk_lineitem_part#4874,cpfk_partsupp_lineitem#4875,cfpk_lineitem_orders#4876,cval_lineitem_l_quantity#4877,cval_lineitem_l_extendedprice#4878,cval_lineitem_l_discount#4879,cval_lineitem_l_tax#4880,cval_lineitem_l_returnflag#4881,cval_lineitem_l_linestatus#4882,cval_lineitem_l_commitdate#4883,cval_lineitem_l_receiptdate#4884,cval_lineitem_l_shipinstruct#4885,cval_lineitem_l_shipmode#4886,cval_lineitem_l_comment#4887,cval_lineitem_l_shipdate#4888,cl_quantity#4889,cl_extendedprice#4890,cl_discount#4891,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#4776 AS rid_2#4809, cpfk_orders_lineitem#4777 AS cpfk_orders_lineitem_2#4810, cpfk_supplier_lineitem#4778 AS cpfk_supplier_lineitem_2#4811, cfpk_lineitem_supplier#4779 AS cfpk_lineitem_supplier_2#4812, cfpk_lineitem_partsupp#4780 AS cfpk_lineitem_partsupp_2#4813, cpfk_part_lineitem#4781 AS cpfk_part_lineitem_2#4814, cfpk_lineitem_part#4782 AS cfpk_lineitem_part_2#4815, cpfk_partsupp_lineitem#4783 AS cpfk_partsupp_lineitem_2#4816, cfpk_lineitem_orders#4784 AS cfpk_lineitem_orders_2#4817, cval_lineitem_l_quantity#4785 AS cval_lineitem_l_quantity_2#4818, cval_lineitem_l_extendedprice#4786 AS cval_lineitem_l_extendedprice_2#4819, cval_lineitem_l_discount#4787 AS cval_lineitem_l_discount_2#4820, cval_lineitem_l_tax#4788 AS cval_lineitem_l_tax_2#4821, cval_lineitem_l_returnflag#4789 AS cval_lineitem_l_returnflag_2#4822, cval_lineitem_l_linestatus#4790 AS cval_lineitem_l_linestatus_2#4823, cval_lineitem_l_commitdate#4791 AS cval_lineitem_l_commitdate_2#4824, cval_lineitem_l_receiptdate#4792 AS cval_lineitem_l_receiptdate_2#4825, cval_lineitem_l_shipinstruct#4793 AS cval_lineitem_l_shipinstruct_2#4826, cval_lineitem_l_shipmode#4794 AS cval_lineitem_l_shipmode_2#4827, cval_lineitem_l_comment#4795 AS cval_lineitem_l_comment_2#4828, cval_lineitem_l_shipdate#4796 AS cval_lineitem_l_shipdate_2#4829, cl_quantity#4797 AS cl_quantity_2#4830, cl_extendedprice#4798 AS cl_extendedprice_2#4831, cl_discount#4799 AS cl_discount_2#4832, ... 9 more fields]
            :     +- Relation[rid#4776,cpfk_orders_lineitem#4777,cpfk_supplier_lineitem#4778,cfpk_lineitem_supplier#4779,cfpk_lineitem_partsupp#4780,cpfk_part_lineitem#4781,cfpk_lineitem_part#4782,cpfk_partsupp_lineitem#4783,cfpk_lineitem_orders#4784,cval_lineitem_l_quantity#4785,cval_lineitem_l_extendedprice#4786,cval_lineitem_l_discount#4787,cval_lineitem_l_tax#4788,cval_lineitem_l_returnflag#4789,cval_lineitem_l_linestatus#4790,cval_lineitem_l_commitdate#4791,cval_lineitem_l_receiptdate#4792,cval_lineitem_l_shipinstruct#4793,cval_lineitem_l_shipmode#4794,cval_lineitem_l_comment#4795,cval_lineitem_l_shipdate#4796,cl_quantity#4797,cl_extendedprice#4798,cl_discount#4799,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'Join UsingJoin(Inner,List(rid_4))
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'Join UsingJoin(Inner,List(rid_3))
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#4934 AS rid_3#4941, cpfk_region_nation#4935 AS cpfk_region_nation_3#4942, cfpk_nation_region#4936 AS cfpk_nation_region_3#4943, cval_nation_n_name#4937 AS cval_nation_n_name_3#4944, cval_nation_n_comment#4938 AS cval_nation_n_comment_3#4945, cn_name#4939 AS cn_name_3#4946, cn_comment#4940 AS cn_comment_3#4947]
               :  :  :  :  :  +- Relation[rid#4934,cpfk_region_nation#4935,cfpk_nation_region#4936,cval_nation_n_name#4937,cval_nation_n_comment#4938,cn_name#4939,cn_comment#4940] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#4948 AS rid_3#4955, cpfk_region_nation#4949 AS cpfk_region_nation_3#4956, cfpk_nation_region#4950 AS cfpk_nation_region_3#4957, cval_nation_n_name#4951 AS cval_nation_n_name_3#4958, cval_nation_n_comment#4952 AS cval_nation_n_comment_3#4959, cn_name#4953 AS cn_name_3#4960, cn_comment#4954 AS cn_comment_3#4961]
               :  :  :  :        +- Relation[rid#4948,cpfk_region_nation#4949,cfpk_nation_region#4950,cval_nation_n_name#4951,cval_nation_n_comment#4952,cn_name#4953,cn_comment#4954] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :     :- Project [rid#4992 AS rid_3#4999, cpfk_region_nation#4993 AS cpfk_region_nation_3#5000, cfpk_nation_region#4994 AS cfpk_nation_region_3#5001, cval_nation_n_name#4995 AS cval_nation_n_name_3#5002, cval_nation_n_comment#4996 AS cval_nation_n_comment_3#5003, cn_name#4997 AS cn_name_3#5004, cn_comment#4998 AS cn_comment_3#5005]
               :  :  :     :  +- Relation[rid#4992,cpfk_region_nation#4993,cfpk_nation_region#4994,cval_nation_n_name#4995,cval_nation_n_comment#4996,cn_name#4997,cn_comment#4998] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#5006 AS rid_4#5021, cpfk_nation_customer#5007 AS cpfk_nation_customer_4#5022, cfpk_customer_nation#5008 AS cfpk_customer_nation_4#5023, cval_customer_c_name#5009 AS cval_customer_c_name_4#5024, cval_customer_c_address#5010 AS cval_customer_c_address_4#5025, cval_customer_c_phone#5011 AS cval_customer_c_phone_4#5026, cval_customer_c_acctbal#5012 AS cval_customer_c_acctbal_4#5027, cval_customer_c_comment#5013 AS cval_customer_c_comment_4#5028, cval_customer_c_mktsegment#5014 AS cval_customer_c_mktsegment_4#5029, cc_name#5015 AS cc_name_4#5030, cc_address#5016 AS cc_address_4#5031, cc_phone#5017 AS cc_phone_4#5032, cc_acctbal#5018 AS cc_acctbal_4#5033, cc_comment#5019 AS cc_comment_4#5034, cc_mktsegment#5020 AS cc_mktsegment_4#5035]
               :  :  :        +- Relation[rid#5006,cpfk_nation_customer#5007,cfpk_customer_nation#5008,cval_customer_c_name#5009,cval_customer_c_address#5010,cval_customer_c_phone#5011,cval_customer_c_acctbal#5012,cval_customer_c_comment#5013,cval_customer_c_mktsegment#5014,cc_name#5015,cc_address#5016,cc_phone#5017,cc_acctbal#5018,cc_comment#5019,cc_mktsegment#5020] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#4962 AS rid_4#4977, cpfk_nation_customer#4963 AS cpfk_nation_customer_4#4978, cfpk_customer_nation#4964 AS cfpk_customer_nation_4#4979, cval_customer_c_name#4965 AS cval_customer_c_name_4#4980, cval_customer_c_address#4966 AS cval_customer_c_address_4#4981, cval_customer_c_phone#4967 AS cval_customer_c_phone_4#4982, cval_customer_c_acctbal#4968 AS cval_customer_c_acctbal_4#4983, cval_customer_c_comment#4969 AS cval_customer_c_comment_4#4984, cval_customer_c_mktsegment#4970 AS cval_customer_c_mktsegment_4#4985, cc_name#4971 AS cc_name_4#4986, cc_address#4972 AS cc_address_4#4987, cc_phone#4973 AS cc_phone_4#4988, cc_acctbal#4974 AS cc_acctbal_4#4989, cc_comment#4975 AS cc_comment_4#4990, cc_mktsegment#4976 AS cc_mktsegment_4#4991]
               :  :     +- Relation[rid#4962,cpfk_nation_customer#4963,cfpk_customer_nation#4964,cval_customer_c_name#4965,cval_customer_c_address#4966,cval_customer_c_phone#4967,cval_customer_c_acctbal#4968,cval_customer_c_comment#4969,cval_customer_c_mktsegment#4970,cc_name#4971,cc_address#4972,cc_phone#4973,cc_acctbal#4974,cc_comment#4975,cc_mktsegment#4976] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :     :- Project [rid#5070 AS rid_4#5085, cpfk_nation_customer#5071 AS cpfk_nation_customer_4#5086, cfpk_customer_nation#5072 AS cfpk_customer_nation_4#5087, cval_customer_c_name#5073 AS cval_customer_c_name_4#5088, cval_customer_c_address#5074 AS cval_customer_c_address_4#5089, cval_customer_c_phone#5075 AS cval_customer_c_phone_4#5090, cval_customer_c_acctbal#5076 AS cval_customer_c_acctbal_4#5091, cval_customer_c_comment#5077 AS cval_customer_c_comment_4#5092, cval_customer_c_mktsegment#5078 AS cval_customer_c_mktsegment_4#5093, cc_name#5079 AS cc_name_4#5094, cc_address#5080 AS cc_address_4#5095, cc_phone#5081 AS cc_phone_4#5096, cc_acctbal#5082 AS cc_acctbal_4#5097, cc_comment#5083 AS cc_comment_4#5098, cc_mktsegment#5084 AS cc_mktsegment_4#5099]
               :     :  +- Relation[rid#5070,cpfk_nation_customer#5071,cfpk_customer_nation#5072,cval_customer_c_name#5073,cval_customer_c_address#5074,cval_customer_c_phone#5075,cval_customer_c_acctbal#5076,cval_customer_c_comment#5077,cval_customer_c_mktsegment#5078,cc_name#5079,cc_address#5080,cc_phone#5081,cc_acctbal#5082,cc_comment#5083,cc_mktsegment#5084] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#5100 AS rid_5#5117, cpfk_customer_orders#5101 AS cpfk_customer_orders_5#5118, cfpk_orders_customer#5102 AS cfpk_orders_customer_5#5119, cval_orders_o_orderstatus#5103 AS cval_orders_o_orderstatus_5#5120, cval_orders_o_totalprice#5104 AS cval_orders_o_totalprice_5#5121, cval_orders_o_orderpriority#5105 AS cval_orders_o_orderpriority_5#5122, cval_orders_o_clerk#5106 AS cval_orders_o_clerk_5#5123, cval_orders_o_shippriority#5107 AS cval_orders_o_shippriority_5#5124, cval_orders_o_comment#5108 AS cval_orders_o_comment_5#5125, cval_orders_o_orderdate#5109 AS cval_orders_o_orderdate_5#5126, co_orderstatus#5110 AS co_orderstatus_5#5127, co_totalprice#5111 AS co_totalprice_5#5128, co_orderpriority#5112 AS co_orderpriority_5#5129, co_clerk#5113 AS co_clerk_5#5130, co_shippriority#5114 AS co_shippriority_5#5131, co_comment#5115 AS co_comment_5#5132, co_orderdate#5116 AS co_orderdate_5#5133]
               :        +- Relation[rid#5100,cpfk_customer_orders#5101,cfpk_orders_customer#5102,cval_orders_o_orderstatus#5103,cval_orders_o_totalprice#5104,cval_orders_o_orderpriority#5105,cval_orders_o_clerk#5106,cval_orders_o_shippriority#5107,cval_orders_o_comment#5108,cval_orders_o_orderdate#5109,co_orderstatus#5110,co_totalprice#5111,co_orderpriority#5112,co_clerk#5113,co_shippriority#5114,co_comment#5115,co_orderdate#5116] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#5036 AS rid_5#5053, cpfk_customer_orders#5037 AS cpfk_customer_orders_5#5054, cfpk_orders_customer#5038 AS cfpk_orders_customer_5#5055, cval_orders_o_orderstatus#5039 AS cval_orders_o_orderstatus_5#5056, cval_orders_o_totalprice#5040 AS cval_orders_o_totalprice_5#5057, cval_orders_o_orderpriority#5041 AS cval_orders_o_orderpriority_5#5058, cval_orders_o_clerk#5042 AS cval_orders_o_clerk_5#5059, cval_orders_o_shippriority#5043 AS cval_orders_o_shippriority_5#5060, cval_orders_o_comment#5044 AS cval_orders_o_comment_5#5061, cval_orders_o_orderdate#5045 AS cval_orders_o_orderdate_5#5062, co_orderstatus#5046 AS co_orderstatus_5#5063, co_totalprice#5047 AS co_totalprice_5#5064, co_orderpriority#5048 AS co_orderpriority_5#5065, co_clerk#5049 AS co_clerk_5#5066, co_shippriority#5050 AS co_shippriority_5#5067, co_comment#5051 AS co_comment_5#5068, co_orderdate#5052 AS co_orderdate_5#5069]
                  +- Relation[rid#5036,cpfk_customer_orders#5037,cfpk_orders_customer#5038,cval_orders_o_orderstatus#5039,cval_orders_o_totalprice#5040,cval_orders_o_orderpriority#5041,cval_orders_o_clerk#5042,cval_orders_o_shippriority#5043,cval_orders_o_comment#5044,cval_orders_o_orderdate#5045,co_orderstatus#5046,co_totalprice#5047,co_orderpriority#5048,co_clerk#5049,co_shippriority#5050,co_comment#5051,co_orderdate#5052] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 102463ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/11 07:06:21 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:06:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5230L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 07:06:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:06:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:06:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:06:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:06:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:06:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:06:21 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:06:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5230L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#5232 AS rid_0#5249, cval_part_p_name#5233 AS cval_part_p_name_0#5250, cval_part_p_mfgr#5234 AS cval_part_p_mfgr_0#5251, cval_part_p_type#5235 AS cval_part_p_type_0#5252, cval_part_p_size#5236 AS cval_part_p_size_0#5253, cval_part_p_container#5237 AS cval_part_p_container_0#5254, cval_part_p_retailprice#5238 AS cval_part_p_retailprice_0#5255, cval_part_p_comment#5239 AS cval_part_p_comment_0#5256, cval_part_p_brand#5240 AS cval_part_p_brand_0#5257, cp_name#5241 AS cp_name_0#5258, cp_mfgr#5242 AS cp_mfgr_0#5259, cp_type#5243 AS cp_type_0#5260, cp_size#5244 AS cp_size_0#5261, cp_container#5245 AS cp_container_0#5262, cp_retailprice#5246 AS cp_retailprice_0#5263, cp_comment#5247 AS cp_comment_0#5264, cp_brand#5248 AS cp_brand_0#5265]
         :  :  :  :  +- Relation[rid#5232,cval_part_p_name#5233,cval_part_p_mfgr#5234,cval_part_p_type#5235,cval_part_p_size#5236,cval_part_p_container#5237,cval_part_p_retailprice#5238,cval_part_p_comment#5239,cval_part_p_brand#5240,cp_name#5241,cp_mfgr#5242,cp_type#5243,cp_size#5244,cp_container#5245,cp_retailprice#5246,cp_comment#5247,cp_brand#5248] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#5266 AS rid_0#5283, cval_part_p_name#5267 AS cval_part_p_name_0#5284, cval_part_p_mfgr#5268 AS cval_part_p_mfgr_0#5285, cval_part_p_type#5269 AS cval_part_p_type_0#5286, cval_part_p_size#5270 AS cval_part_p_size_0#5287, cval_part_p_container#5271 AS cval_part_p_container_0#5288, cval_part_p_retailprice#5272 AS cval_part_p_retailprice_0#5289, cval_part_p_comment#5273 AS cval_part_p_comment_0#5290, cval_part_p_brand#5274 AS cval_part_p_brand_0#5291, cp_name#5275 AS cp_name_0#5292, cp_mfgr#5276 AS cp_mfgr_0#5293, cp_type#5277 AS cp_type_0#5294, cp_size#5278 AS cp_size_0#5295, cp_container#5279 AS cp_container_0#5296, cp_retailprice#5280 AS cp_retailprice_0#5297, cp_comment#5281 AS cp_comment_0#5298, cp_brand#5282 AS cp_brand_0#5299]
         :  :  :        +- Relation[rid#5266,cval_part_p_name#5267,cval_part_p_mfgr#5268,cval_part_p_type#5269,cval_part_p_size#5270,cval_part_p_container#5271,cval_part_p_retailprice#5272,cval_part_p_comment#5273,cval_part_p_brand#5274,cp_name#5275,cp_mfgr#5276,cp_type#5277,cp_size#5278,cp_container#5279,cp_retailprice#5280,cp_comment#5281,cp_brand#5282] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#5300 AS rid_0#5317, cval_part_p_name#5301 AS cval_part_p_name_0#5318, cval_part_p_mfgr#5302 AS cval_part_p_mfgr_0#5319, cval_part_p_type#5303 AS cval_part_p_type_0#5320, cval_part_p_size#5304 AS cval_part_p_size_0#5321, cval_part_p_container#5305 AS cval_part_p_container_0#5322, cval_part_p_retailprice#5306 AS cval_part_p_retailprice_0#5323, cval_part_p_comment#5307 AS cval_part_p_comment_0#5324, cval_part_p_brand#5308 AS cval_part_p_brand_0#5325, cp_name#5309 AS cp_name_0#5326, cp_mfgr#5310 AS cp_mfgr_0#5327, cp_type#5311 AS cp_type_0#5328, cp_size#5312 AS cp_size_0#5329, cp_container#5313 AS cp_container_0#5330, cp_retailprice#5314 AS cp_retailprice_0#5331, cp_comment#5315 AS cp_comment_0#5332, cp_brand#5316 AS cp_brand_0#5333]
         :  :        +- Relation[rid#5300,cval_part_p_name#5301,cval_part_p_mfgr#5302,cval_part_p_type#5303,cval_part_p_size#5304,cval_part_p_container#5305,cval_part_p_retailprice#5306,cval_part_p_comment#5307,cval_part_p_brand#5308,cp_name#5309,cp_mfgr#5310,cp_type#5311,cp_size#5312,cp_container#5313,cp_retailprice#5314,cp_comment#5315,cp_brand#5316] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#5400 AS rid_0#5417, cval_part_p_name#5401 AS cval_part_p_name_0#5418, cval_part_p_mfgr#5402 AS cval_part_p_mfgr_0#5419, cval_part_p_type#5403 AS cval_part_p_type_0#5420, cval_part_p_size#5404 AS cval_part_p_size_0#5421, cval_part_p_container#5405 AS cval_part_p_container_0#5422, cval_part_p_retailprice#5406 AS cval_part_p_retailprice_0#5423, cval_part_p_comment#5407 AS cval_part_p_comment_0#5424, cval_part_p_brand#5408 AS cval_part_p_brand_0#5425, cp_name#5409 AS cp_name_0#5426, cp_mfgr#5410 AS cp_mfgr_0#5427, cp_type#5411 AS cp_type_0#5428, cp_size#5412 AS cp_size_0#5429, cp_container#5413 AS cp_container_0#5430, cp_retailprice#5414 AS cp_retailprice_0#5431, cp_comment#5415 AS cp_comment_0#5432, cp_brand#5416 AS cp_brand_0#5433]
         :     :  +- Relation[rid#5400,cval_part_p_name#5401,cval_part_p_mfgr#5402,cval_part_p_type#5403,cval_part_p_size#5404,cval_part_p_container#5405,cval_part_p_retailprice#5406,cval_part_p_comment#5407,cval_part_p_brand#5408,cp_name#5409,cp_mfgr#5410,cp_type#5411,cp_size#5412,cp_container#5413,cp_retailprice#5414,cp_comment#5415,cp_brand#5416] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#5434 AS rid_1#5467, cpfk_orders_lineitem#5435 AS cpfk_orders_lineitem_1#5468, cpfk_supplier_lineitem#5436 AS cpfk_supplier_lineitem_1#5469, cfpk_lineitem_supplier#5437 AS cfpk_lineitem_supplier_1#5470, cfpk_lineitem_partsupp#5438 AS cfpk_lineitem_partsupp_1#5471, cpfk_part_lineitem#5439 AS cpfk_part_lineitem_1#5472, cfpk_lineitem_part#5440 AS cfpk_lineitem_part_1#5473, cpfk_partsupp_lineitem#5441 AS cpfk_partsupp_lineitem_1#5474, cfpk_lineitem_orders#5442 AS cfpk_lineitem_orders_1#5475, cval_lineitem_l_quantity#5443 AS cval_lineitem_l_quantity_1#5476, cval_lineitem_l_extendedprice#5444 AS cval_lineitem_l_extendedprice_1#5477, cval_lineitem_l_discount#5445 AS cval_lineitem_l_discount_1#5478, cval_lineitem_l_tax#5446 AS cval_lineitem_l_tax_1#5479, cval_lineitem_l_returnflag#5447 AS cval_lineitem_l_returnflag_1#5480, cval_lineitem_l_linestatus#5448 AS cval_lineitem_l_linestatus_1#5481, cval_lineitem_l_commitdate#5449 AS cval_lineitem_l_commitdate_1#5482, cval_lineitem_l_receiptdate#5450 AS cval_lineitem_l_receiptdate_1#5483, cval_lineitem_l_shipinstruct#5451 AS cval_lineitem_l_shipinstruct_1#5484, cval_lineitem_l_shipmode#5452 AS cval_lineitem_l_shipmode_1#5485, cval_lineitem_l_comment#5453 AS cval_lineitem_l_comment_1#5486, cval_lineitem_l_shipdate#5454 AS cval_lineitem_l_shipdate_1#5487, cl_quantity#5455 AS cl_quantity_1#5488, cl_extendedprice#5456 AS cl_extendedprice_1#5489, cl_discount#5457 AS cl_discount_1#5490, ... 9 more fields]
         :        +- Relation[rid#5434,cpfk_orders_lineitem#5435,cpfk_supplier_lineitem#5436,cfpk_lineitem_supplier#5437,cfpk_lineitem_partsupp#5438,cpfk_part_lineitem#5439,cfpk_lineitem_part#5440,cpfk_partsupp_lineitem#5441,cfpk_lineitem_orders#5442,cval_lineitem_l_quantity#5443,cval_lineitem_l_extendedprice#5444,cval_lineitem_l_discount#5445,cval_lineitem_l_tax#5446,cval_lineitem_l_returnflag#5447,cval_lineitem_l_linestatus#5448,cval_lineitem_l_commitdate#5449,cval_lineitem_l_receiptdate#5450,cval_lineitem_l_shipinstruct#5451,cval_lineitem_l_shipmode#5452,cval_lineitem_l_comment#5453,cval_lineitem_l_shipdate#5454,cl_quantity#5455,cl_extendedprice#5456,cl_discount#5457,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5334 AS rid_1#5367, cpfk_orders_lineitem#5335 AS cpfk_orders_lineitem_1#5368, cpfk_supplier_lineitem#5336 AS cpfk_supplier_lineitem_1#5369, cfpk_lineitem_supplier#5337 AS cfpk_lineitem_supplier_1#5370, cfpk_lineitem_partsupp#5338 AS cfpk_lineitem_partsupp_1#5371, cpfk_part_lineitem#5339 AS cpfk_part_lineitem_1#5372, cfpk_lineitem_part#5340 AS cfpk_lineitem_part_1#5373, cpfk_partsupp_lineitem#5341 AS cpfk_partsupp_lineitem_1#5374, cfpk_lineitem_orders#5342 AS cfpk_lineitem_orders_1#5375, cval_lineitem_l_quantity#5343 AS cval_lineitem_l_quantity_1#5376, cval_lineitem_l_extendedprice#5344 AS cval_lineitem_l_extendedprice_1#5377, cval_lineitem_l_discount#5345 AS cval_lineitem_l_discount_1#5378, cval_lineitem_l_tax#5346 AS cval_lineitem_l_tax_1#5379, cval_lineitem_l_returnflag#5347 AS cval_lineitem_l_returnflag_1#5380, cval_lineitem_l_linestatus#5348 AS cval_lineitem_l_linestatus_1#5381, cval_lineitem_l_commitdate#5349 AS cval_lineitem_l_commitdate_1#5382, cval_lineitem_l_receiptdate#5350 AS cval_lineitem_l_receiptdate_1#5383, cval_lineitem_l_shipinstruct#5351 AS cval_lineitem_l_shipinstruct_1#5384, cval_lineitem_l_shipmode#5352 AS cval_lineitem_l_shipmode_1#5385, cval_lineitem_l_comment#5353 AS cval_lineitem_l_comment_1#5386, cval_lineitem_l_shipdate#5354 AS cval_lineitem_l_shipdate_1#5387, cl_quantity#5355 AS cl_quantity_1#5388, cl_extendedprice#5356 AS cl_extendedprice_1#5389, cl_discount#5357 AS cl_discount_1#5390, ... 9 more fields]
            +- Relation[rid#5334,cpfk_orders_lineitem#5335,cpfk_supplier_lineitem#5336,cfpk_lineitem_supplier#5337,cfpk_lineitem_partsupp#5338,cpfk_part_lineitem#5339,cfpk_lineitem_part#5340,cpfk_partsupp_lineitem#5341,cfpk_lineitem_orders#5342,cval_lineitem_l_quantity#5343,cval_lineitem_l_extendedprice#5344,cval_lineitem_l_discount#5345,cval_lineitem_l_tax#5346,cval_lineitem_l_returnflag#5347,cval_lineitem_l_linestatus#5348,cval_lineitem_l_commitdate#5349,cval_lineitem_l_receiptdate#5350,cval_lineitem_l_shipinstruct#5351,cval_lineitem_l_shipmode#5352,cval_lineitem_l_comment#5353,cval_lineitem_l_shipdate#5354,cl_quantity#5355,cl_extendedprice#5356,cl_discount#5357,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 71575ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/11 07:07:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:07:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5554L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 07:07:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5554L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#5556 AS rid_0#5573, cpfk_customer_orders#5557 AS cpfk_customer_orders_0#5574, cfpk_orders_customer#5558 AS cfpk_orders_customer_0#5575, cval_orders_o_orderstatus#5559 AS cval_orders_o_orderstatus_0#5576, cval_orders_o_totalprice#5560 AS cval_orders_o_totalprice_0#5577, cval_orders_o_orderpriority#5561 AS cval_orders_o_orderpriority_0#5578, cval_orders_o_clerk#5562 AS cval_orders_o_clerk_0#5579, cval_orders_o_shippriority#5563 AS cval_orders_o_shippriority_0#5580, cval_orders_o_comment#5564 AS cval_orders_o_comment_0#5581, cval_orders_o_orderdate#5565 AS cval_orders_o_orderdate_0#5582, co_orderstatus#5566 AS co_orderstatus_0#5583, co_totalprice#5567 AS co_totalprice_0#5584, co_orderpriority#5568 AS co_orderpriority_0#5585, co_clerk#5569 AS co_clerk_0#5586, co_shippriority#5570 AS co_shippriority_0#5587, co_comment#5571 AS co_comment_0#5588, co_orderdate#5572 AS co_orderdate_0#5589]
            :  +- Relation[rid#5556,cpfk_customer_orders#5557,cfpk_orders_customer#5558,cval_orders_o_orderstatus#5559,cval_orders_o_totalprice#5560,cval_orders_o_orderpriority#5561,cval_orders_o_clerk#5562,cval_orders_o_shippriority#5563,cval_orders_o_comment#5564,cval_orders_o_orderdate#5565,co_orderstatus#5566,co_totalprice#5567,co_orderpriority#5568,co_clerk#5569,co_shippriority#5570,co_comment#5571,co_orderdate#5572] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#5590 AS rid_1#5605, cpfk_nation_customer#5591 AS cpfk_nation_customer_1#5606, cfpk_customer_nation#5592 AS cfpk_customer_nation_1#5607, cval_customer_c_name#5593 AS cval_customer_c_name_1#5608, cval_customer_c_address#5594 AS cval_customer_c_address_1#5609, cval_customer_c_phone#5595 AS cval_customer_c_phone_1#5610, cval_customer_c_acctbal#5596 AS cval_customer_c_acctbal_1#5611, cval_customer_c_comment#5597 AS cval_customer_c_comment_1#5612, cval_customer_c_mktsegment#5598 AS cval_customer_c_mktsegment_1#5613, cc_name#5599 AS cc_name_1#5614, cc_address#5600 AS cc_address_1#5615, cc_phone#5601 AS cc_phone_1#5616, cc_acctbal#5602 AS cc_acctbal_1#5617, cc_comment#5603 AS cc_comment_1#5618, cc_mktsegment#5604 AS cc_mktsegment_1#5619]
               +- Relation[rid#5590,cpfk_nation_customer#5591,cfpk_customer_nation#5592,cval_customer_c_name#5593,cval_customer_c_address#5594,cval_customer_c_phone#5595,cval_customer_c_acctbal#5596,cval_customer_c_comment#5597,cval_customer_c_mktsegment#5598,cc_name#5599,cc_address#5600,cc_phone#5601,cc_acctbal#5602,cc_comment#5603,cc_mktsegment#5604] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 12754ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/11 07:07:45 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:07:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5658L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 07:07:45 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:07:45 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:07:45 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:07:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:07:45 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:07:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:07:45 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:07:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:07:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:07:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:07:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:07:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:07:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:07:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:07:45 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:07:45 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:07:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5658L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#5660 AS rid_0#5665, cval_region_r_name#5661 AS cval_region_r_name_0#5666, cval_region_r_comment#5662 AS cval_region_r_comment_0#5667, cr_name#5663 AS cr_name_0#5668, cr_comment#5664 AS cr_comment_0#5669]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#5660,cval_region_r_name#5661,cval_region_r_comment#5662,cr_name#5663,cr_comment#5664] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#5670 AS rid_0#5675, cval_region_r_name#5671 AS cval_region_r_name_0#5676, cval_region_r_comment#5672 AS cval_region_r_comment_0#5677, cr_name#5673 AS cr_name_0#5678, cr_comment#5674 AS cr_comment_0#5679]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#5670,cval_region_r_name#5671,cval_region_r_comment#5672,cr_name#5673,cr_comment#5674] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :     :- Project [rid#5694 AS rid_0#5699, cval_region_r_name#5695 AS cval_region_r_name_0#5700, cval_region_r_comment#5696 AS cval_region_r_comment_0#5701, cr_name#5697 AS cr_name_0#5702, cr_comment#5698 AS cr_comment_0#5703]
         :     :  :  :  :  :  :  :  :     :  +- Relation[rid#5694,cval_region_r_name#5695,cval_region_r_comment#5696,cr_name#5697,cr_comment#5698] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :     +- Project [rid#5704 AS rid_1#5711, cpfk_region_nation#5705 AS cpfk_region_nation_1#5712, cfpk_nation_region#5706 AS cfpk_nation_region_1#5713, cval_nation_n_name#5707 AS cval_nation_n_name_1#5714, cval_nation_n_comment#5708 AS cval_nation_n_comment_1#5715, cn_name#5709 AS cn_name_1#5716, cn_comment#5710 AS cn_comment_1#5717]
         :     :  :  :  :  :  :  :  :        +- Relation[rid#5704,cpfk_region_nation#5705,cfpk_nation_region#5706,cval_nation_n_name#5707,cval_nation_n_comment#5708,cn_name#5709,cn_comment#5710] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#5680 AS rid_1#5687, cpfk_region_nation#5681 AS cpfk_region_nation_1#5688, cfpk_nation_region#5682 AS cfpk_nation_region_1#5689, cval_nation_n_name#5683 AS cval_nation_n_name_1#5690, cval_nation_n_comment#5684 AS cval_nation_n_comment_1#5691, cn_name#5685 AS cn_name_1#5692, cn_comment#5686 AS cn_comment_1#5693]
         :     :  :  :  :  :  :  :     +- Relation[rid#5680,cpfk_region_nation#5681,cfpk_nation_region#5682,cval_nation_n_name#5683,cval_nation_n_comment#5684,cn_name#5685,cn_comment#5686] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :     :- Project [rid#5748 AS rid_1#5755, cpfk_region_nation#5749 AS cpfk_region_nation_1#5756, cfpk_nation_region#5750 AS cfpk_nation_region_1#5757, cval_nation_n_name#5751 AS cval_nation_n_name_1#5758, cval_nation_n_comment#5752 AS cval_nation_n_comment_1#5759, cn_name#5753 AS cn_name_1#5760, cn_comment#5754 AS cn_comment_1#5761]
         :     :  :  :  :  :  :     :  +- Relation[rid#5748,cpfk_region_nation#5749,cfpk_nation_region#5750,cval_nation_n_name#5751,cval_nation_n_comment#5752,cn_name#5753,cn_comment#5754] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :     +- Project [rid#5762 AS rid_2#5777, cpfk_nation_customer#5763 AS cpfk_nation_customer_2#5778, cfpk_customer_nation#5764 AS cfpk_customer_nation_2#5779, cval_customer_c_name#5765 AS cval_customer_c_name_2#5780, cval_customer_c_address#5766 AS cval_customer_c_address_2#5781, cval_customer_c_phone#5767 AS cval_customer_c_phone_2#5782, cval_customer_c_acctbal#5768 AS cval_customer_c_acctbal_2#5783, cval_customer_c_comment#5769 AS cval_customer_c_comment_2#5784, cval_customer_c_mktsegment#5770 AS cval_customer_c_mktsegment_2#5785, cc_name#5771 AS cc_name_2#5786, cc_address#5772 AS cc_address_2#5787, cc_phone#5773 AS cc_phone_2#5788, cc_acctbal#5774 AS cc_acctbal_2#5789, cc_comment#5775 AS cc_comment_2#5790, cc_mktsegment#5776 AS cc_mktsegment_2#5791]
         :     :  :  :  :  :  :        +- Relation[rid#5762,cpfk_nation_customer#5763,cfpk_customer_nation#5764,cval_customer_c_name#5765,cval_customer_c_address#5766,cval_customer_c_phone#5767,cval_customer_c_acctbal#5768,cval_customer_c_comment#5769,cval_customer_c_mktsegment#5770,cc_name#5771,cc_address#5772,cc_phone#5773,cc_acctbal#5774,cc_comment#5775,cc_mktsegment#5776] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#5718 AS rid_2#5733, cpfk_nation_customer#5719 AS cpfk_nation_customer_2#5734, cfpk_customer_nation#5720 AS cfpk_customer_nation_2#5735, cval_customer_c_name#5721 AS cval_customer_c_name_2#5736, cval_customer_c_address#5722 AS cval_customer_c_address_2#5737, cval_customer_c_phone#5723 AS cval_customer_c_phone_2#5738, cval_customer_c_acctbal#5724 AS cval_customer_c_acctbal_2#5739, cval_customer_c_comment#5725 AS cval_customer_c_comment_2#5740, cval_customer_c_mktsegment#5726 AS cval_customer_c_mktsegment_2#5741, cc_name#5727 AS cc_name_2#5742, cc_address#5728 AS cc_address_2#5743, cc_phone#5729 AS cc_phone_2#5744, cc_acctbal#5730 AS cc_acctbal_2#5745, cc_comment#5731 AS cc_comment_2#5746, cc_mktsegment#5732 AS cc_mktsegment_2#5747]
         :     :  :  :  :  :     +- Relation[rid#5718,cpfk_nation_customer#5719,cfpk_customer_nation#5720,cval_customer_c_name#5721,cval_customer_c_address#5722,cval_customer_c_phone#5723,cval_customer_c_acctbal#5724,cval_customer_c_comment#5725,cval_customer_c_mktsegment#5726,cc_name#5727,cc_address#5728,cc_phone#5729,cc_acctbal#5730,cc_comment#5731,cc_mktsegment#5732] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :     :- Project [rid#5826 AS rid_2#5841, cpfk_nation_customer#5827 AS cpfk_nation_customer_2#5842, cfpk_customer_nation#5828 AS cfpk_customer_nation_2#5843, cval_customer_c_name#5829 AS cval_customer_c_name_2#5844, cval_customer_c_address#5830 AS cval_customer_c_address_2#5845, cval_customer_c_phone#5831 AS cval_customer_c_phone_2#5846, cval_customer_c_acctbal#5832 AS cval_customer_c_acctbal_2#5847, cval_customer_c_comment#5833 AS cval_customer_c_comment_2#5848, cval_customer_c_mktsegment#5834 AS cval_customer_c_mktsegment_2#5849, cc_name#5835 AS cc_name_2#5850, cc_address#5836 AS cc_address_2#5851, cc_phone#5837 AS cc_phone_2#5852, cc_acctbal#5838 AS cc_acctbal_2#5853, cc_comment#5839 AS cc_comment_2#5854, cc_mktsegment#5840 AS cc_mktsegment_2#5855]
         :     :  :  :  :     :  +- Relation[rid#5826,cpfk_nation_customer#5827,cfpk_customer_nation#5828,cval_customer_c_name#5829,cval_customer_c_address#5830,cval_customer_c_phone#5831,cval_customer_c_acctbal#5832,cval_customer_c_comment#5833,cval_customer_c_mktsegment#5834,cc_name#5835,cc_address#5836,cc_phone#5837,cc_acctbal#5838,cc_comment#5839,cc_mktsegment#5840] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :     +- Project [rid#5856 AS rid_3#5873, cpfk_customer_orders#5857 AS cpfk_customer_orders_3#5874, cfpk_orders_customer#5858 AS cfpk_orders_customer_3#5875, cval_orders_o_orderstatus#5859 AS cval_orders_o_orderstatus_3#5876, cval_orders_o_totalprice#5860 AS cval_orders_o_totalprice_3#5877, cval_orders_o_orderpriority#5861 AS cval_orders_o_orderpriority_3#5878, cval_orders_o_clerk#5862 AS cval_orders_o_clerk_3#5879, cval_orders_o_shippriority#5863 AS cval_orders_o_shippriority_3#5880, cval_orders_o_comment#5864 AS cval_orders_o_comment_3#5881, cval_orders_o_orderdate#5865 AS cval_orders_o_orderdate_3#5882, co_orderstatus#5866 AS co_orderstatus_3#5883, co_totalprice#5867 AS co_totalprice_3#5884, co_orderpriority#5868 AS co_orderpriority_3#5885, co_clerk#5869 AS co_clerk_3#5886, co_shippriority#5870 AS co_shippriority_3#5887, co_comment#5871 AS co_comment_3#5888, co_orderdate#5872 AS co_orderdate_3#5889]
         :     :  :  :  :        +- Relation[rid#5856,cpfk_customer_orders#5857,cfpk_orders_customer#5858,cval_orders_o_orderstatus#5859,cval_orders_o_totalprice#5860,cval_orders_o_orderpriority#5861,cval_orders_o_clerk#5862,cval_orders_o_shippriority#5863,cval_orders_o_comment#5864,cval_orders_o_orderdate#5865,co_orderstatus#5866,co_totalprice#5867,co_orderpriority#5868,co_clerk#5869,co_shippriority#5870,co_comment#5871,co_orderdate#5872] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#5792 AS rid_3#5809, cpfk_customer_orders#5793 AS cpfk_customer_orders_3#5810, cfpk_orders_customer#5794 AS cfpk_orders_customer_3#5811, cval_orders_o_orderstatus#5795 AS cval_orders_o_orderstatus_3#5812, cval_orders_o_totalprice#5796 AS cval_orders_o_totalprice_3#5813, cval_orders_o_orderpriority#5797 AS cval_orders_o_orderpriority_3#5814, cval_orders_o_clerk#5798 AS cval_orders_o_clerk_3#5815, cval_orders_o_shippriority#5799 AS cval_orders_o_shippriority_3#5816, cval_orders_o_comment#5800 AS cval_orders_o_comment_3#5817, cval_orders_o_orderdate#5801 AS cval_orders_o_orderdate_3#5818, co_orderstatus#5802 AS co_orderstatus_3#5819, co_totalprice#5803 AS co_totalprice_3#5820, co_orderpriority#5804 AS co_orderpriority_3#5821, co_clerk#5805 AS co_clerk_3#5822, co_shippriority#5806 AS co_shippriority_3#5823, co_comment#5807 AS co_comment_3#5824, co_orderdate#5808 AS co_orderdate_3#5825]
         :     :  :  :     +- Relation[rid#5792,cpfk_customer_orders#5793,cfpk_orders_customer#5794,cval_orders_o_orderstatus#5795,cval_orders_o_totalprice#5796,cval_orders_o_orderpriority#5797,cval_orders_o_clerk#5798,cval_orders_o_shippriority#5799,cval_orders_o_comment#5800,cval_orders_o_orderdate#5801,co_orderstatus#5802,co_totalprice#5803,co_orderpriority#5804,co_clerk#5805,co_shippriority#5806,co_comment#5807,co_orderdate#5808] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :     :- Project [rid#5956 AS rid_3#5973, cpfk_customer_orders#5957 AS cpfk_customer_orders_3#5974, cfpk_orders_customer#5958 AS cfpk_orders_customer_3#5975, cval_orders_o_orderstatus#5959 AS cval_orders_o_orderstatus_3#5976, cval_orders_o_totalprice#5960 AS cval_orders_o_totalprice_3#5977, cval_orders_o_orderpriority#5961 AS cval_orders_o_orderpriority_3#5978, cval_orders_o_clerk#5962 AS cval_orders_o_clerk_3#5979, cval_orders_o_shippriority#5963 AS cval_orders_o_shippriority_3#5980, cval_orders_o_comment#5964 AS cval_orders_o_comment_3#5981, cval_orders_o_orderdate#5965 AS cval_orders_o_orderdate_3#5982, co_orderstatus#5966 AS co_orderstatus_3#5983, co_totalprice#5967 AS co_totalprice_3#5984, co_orderpriority#5968 AS co_orderpriority_3#5985, co_clerk#5969 AS co_clerk_3#5986, co_shippriority#5970 AS co_shippriority_3#5987, co_comment#5971 AS co_comment_3#5988, co_orderdate#5972 AS co_orderdate_3#5989]
         :     :  :     :  +- Relation[rid#5956,cpfk_customer_orders#5957,cfpk_orders_customer#5958,cval_orders_o_orderstatus#5959,cval_orders_o_totalprice#5960,cval_orders_o_orderpriority#5961,cval_orders_o_clerk#5962,cval_orders_o_shippriority#5963,cval_orders_o_comment#5964,cval_orders_o_orderdate#5965,co_orderstatus#5966,co_totalprice#5967,co_orderpriority#5968,co_clerk#5969,co_shippriority#5970,co_comment#5971,co_orderdate#5972] JDBCRelation(torders) [numPartitions=1]
         :     :  :     +- Project [rid#5990 AS rid_4#6023, cpfk_orders_lineitem#5991 AS cpfk_orders_lineitem_4#6024, cpfk_supplier_lineitem#5992 AS cpfk_supplier_lineitem_4#6025, cfpk_lineitem_supplier#5993 AS cfpk_lineitem_supplier_4#6026, cfpk_lineitem_partsupp#5994 AS cfpk_lineitem_partsupp_4#6027, cpfk_part_lineitem#5995 AS cpfk_part_lineitem_4#6028, cfpk_lineitem_part#5996 AS cfpk_lineitem_part_4#6029, cpfk_partsupp_lineitem#5997 AS cpfk_partsupp_lineitem_4#6030, cfpk_lineitem_orders#5998 AS cfpk_lineitem_orders_4#6031, cval_lineitem_l_quantity#5999 AS cval_lineitem_l_quantity_4#6032, cval_lineitem_l_extendedprice#6000 AS cval_lineitem_l_extendedprice_4#6033, cval_lineitem_l_discount#6001 AS cval_lineitem_l_discount_4#6034, cval_lineitem_l_tax#6002 AS cval_lineitem_l_tax_4#6035, cval_lineitem_l_returnflag#6003 AS cval_lineitem_l_returnflag_4#6036, cval_lineitem_l_linestatus#6004 AS cval_lineitem_l_linestatus_4#6037, cval_lineitem_l_commitdate#6005 AS cval_lineitem_l_commitdate_4#6038, cval_lineitem_l_receiptdate#6006 AS cval_lineitem_l_receiptdate_4#6039, cval_lineitem_l_shipinstruct#6007 AS cval_lineitem_l_shipinstruct_4#6040, cval_lineitem_l_shipmode#6008 AS cval_lineitem_l_shipmode_4#6041, cval_lineitem_l_comment#6009 AS cval_lineitem_l_comment_4#6042, cval_lineitem_l_shipdate#6010 AS cval_lineitem_l_shipdate_4#6043, cl_quantity#6011 AS cl_quantity_4#6044, cl_extendedprice#6012 AS cl_extendedprice_4#6045, cl_discount#6013 AS cl_discount_4#6046, ... 9 more fields]
         :     :  :        +- Relation[rid#5990,cpfk_orders_lineitem#5991,cpfk_supplier_lineitem#5992,cfpk_lineitem_supplier#5993,cfpk_lineitem_partsupp#5994,cpfk_part_lineitem#5995,cfpk_lineitem_part#5996,cpfk_partsupp_lineitem#5997,cfpk_lineitem_orders#5998,cval_lineitem_l_quantity#5999,cval_lineitem_l_extendedprice#6000,cval_lineitem_l_discount#6001,cval_lineitem_l_tax#6002,cval_lineitem_l_returnflag#6003,cval_lineitem_l_linestatus#6004,cval_lineitem_l_commitdate#6005,cval_lineitem_l_receiptdate#6006,cval_lineitem_l_shipinstruct#6007,cval_lineitem_l_shipmode#6008,cval_lineitem_l_comment#6009,cval_lineitem_l_shipdate#6010,cl_quantity#6011,cl_extendedprice#6012,cl_discount#6013,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#5890 AS rid_4#5923, cpfk_orders_lineitem#5891 AS cpfk_orders_lineitem_4#5924, cpfk_supplier_lineitem#5892 AS cpfk_supplier_lineitem_4#5925, cfpk_lineitem_supplier#5893 AS cfpk_lineitem_supplier_4#5926, cfpk_lineitem_partsupp#5894 AS cfpk_lineitem_partsupp_4#5927, cpfk_part_lineitem#5895 AS cpfk_part_lineitem_4#5928, cfpk_lineitem_part#5896 AS cfpk_lineitem_part_4#5929, cpfk_partsupp_lineitem#5897 AS cpfk_partsupp_lineitem_4#5930, cfpk_lineitem_orders#5898 AS cfpk_lineitem_orders_4#5931, cval_lineitem_l_quantity#5899 AS cval_lineitem_l_quantity_4#5932, cval_lineitem_l_extendedprice#5900 AS cval_lineitem_l_extendedprice_4#5933, cval_lineitem_l_discount#5901 AS cval_lineitem_l_discount_4#5934, cval_lineitem_l_tax#5902 AS cval_lineitem_l_tax_4#5935, cval_lineitem_l_returnflag#5903 AS cval_lineitem_l_returnflag_4#5936, cval_lineitem_l_linestatus#5904 AS cval_lineitem_l_linestatus_4#5937, cval_lineitem_l_commitdate#5905 AS cval_lineitem_l_commitdate_4#5938, cval_lineitem_l_receiptdate#5906 AS cval_lineitem_l_receiptdate_4#5939, cval_lineitem_l_shipinstruct#5907 AS cval_lineitem_l_shipinstruct_4#5940, cval_lineitem_l_shipmode#5908 AS cval_lineitem_l_shipmode_4#5941, cval_lineitem_l_comment#5909 AS cval_lineitem_l_comment_4#5942, cval_lineitem_l_shipdate#5910 AS cval_lineitem_l_shipdate_4#5943, cl_quantity#5911 AS cl_quantity_4#5944, cl_extendedprice#5912 AS cl_extendedprice_4#5945, cl_discount#5913 AS cl_discount_4#5946, ... 9 more fields]
         :     :     +- Relation[rid#5890,cpfk_orders_lineitem#5891,cpfk_supplier_lineitem#5892,cfpk_lineitem_supplier#5893,cfpk_lineitem_partsupp#5894,cpfk_part_lineitem#5895,cfpk_lineitem_part#5896,cpfk_partsupp_lineitem#5897,cfpk_lineitem_orders#5898,cval_lineitem_l_quantity#5899,cval_lineitem_l_extendedprice#5900,cval_lineitem_l_discount#5901,cval_lineitem_l_tax#5902,cval_lineitem_l_returnflag#5903,cval_lineitem_l_linestatus#5904,cval_lineitem_l_commitdate#5905,cval_lineitem_l_receiptdate#5906,cval_lineitem_l_shipinstruct#5907,cval_lineitem_l_shipmode#5908,cval_lineitem_l_comment#5909,cval_lineitem_l_shipdate#5910,cl_quantity#5911,cl_extendedprice#5912,cl_discount#5913,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#6056 AS rid_5#6069, cpfk_nation_supplier#6057 AS cpfk_nation_supplier_5#6070, cfpk_supplier_nation#6058 AS cfpk_supplier_nation_5#6071, cval_supplier_s_name#6059 AS cval_supplier_s_name_5#6072, cval_supplier_s_address#6060 AS cval_supplier_s_address_5#6073, cval_supplier_s_phone#6061 AS cval_supplier_s_phone_5#6074, cval_supplier_s_acctbal#6062 AS cval_supplier_s_acctbal_5#6075, cval_supplier_s_comment#6063 AS cval_supplier_s_comment_5#6076, cs_name#6064 AS cs_name_5#6077, cs_address#6065 AS cs_address_5#6078, cs_phone#6066 AS cs_phone_5#6079, cs_acctbal#6067 AS cs_acctbal_5#6080, cs_comment#6068 AS cs_comment_5#6081]
         :        +- Relation[rid#6056,cpfk_nation_supplier#6057,cfpk_supplier_nation#6058,cval_supplier_s_name#6059,cval_supplier_s_address#6060,cval_supplier_s_phone#6061,cval_supplier_s_acctbal#6062,cval_supplier_s_comment#6063,cs_name#6064,cs_address#6065,cs_phone#6066,cs_acctbal#6067,cs_comment#6068] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#6082 AS rid_1#6089, cpfk_region_nation#6083 AS cpfk_region_nation_1#6090, cfpk_nation_region#6084 AS cfpk_nation_region_1#6091, cval_nation_n_name#6085 AS cval_nation_n_name_1#6092, cval_nation_n_comment#6086 AS cval_nation_n_comment_1#6093, cn_name#6087 AS cn_name_1#6094, cn_comment#6088 AS cn_comment_1#6095]
            :  +- Relation[rid#6082,cpfk_region_nation#6083,cfpk_nation_region#6084,cval_nation_n_name#6085,cval_nation_n_comment#6086,cn_name#6087,cn_comment#6088] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#6096 AS rid_5#6109, cpfk_nation_supplier#6097 AS cpfk_nation_supplier_5#6110, cfpk_supplier_nation#6098 AS cfpk_supplier_nation_5#6111, cval_supplier_s_name#6099 AS cval_supplier_s_name_5#6112, cval_supplier_s_address#6100 AS cval_supplier_s_address_5#6113, cval_supplier_s_phone#6101 AS cval_supplier_s_phone_5#6114, cval_supplier_s_acctbal#6102 AS cval_supplier_s_acctbal_5#6115, cval_supplier_s_comment#6103 AS cval_supplier_s_comment_5#6116, cs_name#6104 AS cs_name_5#6117, cs_address#6105 AS cs_address_5#6118, cs_phone#6106 AS cs_phone_5#6119, cs_acctbal#6107 AS cs_acctbal_5#6120, cs_comment#6108 AS cs_comment_5#6121]
               +- Relation[rid#6096,cpfk_nation_supplier#6097,cfpk_supplier_nation#6098,cval_supplier_s_name#6099,cval_supplier_s_address#6100,cval_supplier_s_phone#6101,cval_supplier_s_acctbal#6102,cval_supplier_s_comment#6103,cs_name#6104,cs_address#6105,cs_phone#6106,cs_acctbal#6107,cs_comment#6108] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1206514
Elapsed time: 163521ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/11 07:10:28 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:10:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6218L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 07:10:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6218L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#6220 AS rid_0#6237, cval_part_p_name#6221 AS cval_part_p_name_0#6238, cval_part_p_mfgr#6222 AS cval_part_p_mfgr_0#6239, cval_part_p_type#6223 AS cval_part_p_type_0#6240, cval_part_p_size#6224 AS cval_part_p_size_0#6241, cval_part_p_container#6225 AS cval_part_p_container_0#6242, cval_part_p_retailprice#6226 AS cval_part_p_retailprice_0#6243, cval_part_p_comment#6227 AS cval_part_p_comment_0#6244, cval_part_p_brand#6228 AS cval_part_p_brand_0#6245, cp_name#6229 AS cp_name_0#6246, cp_mfgr#6230 AS cp_mfgr_0#6247, cp_type#6231 AS cp_type_0#6248, cp_size#6232 AS cp_size_0#6249, cp_container#6233 AS cp_container_0#6250, cp_retailprice#6234 AS cp_retailprice_0#6251, cp_comment#6235 AS cp_comment_0#6252, cp_brand#6236 AS cp_brand_0#6253]
         :  :  +- Relation[rid#6220,cval_part_p_name#6221,cval_part_p_mfgr#6222,cval_part_p_type#6223,cval_part_p_size#6224,cval_part_p_container#6225,cval_part_p_retailprice#6226,cval_part_p_comment#6227,cval_part_p_brand#6228,cp_name#6229,cp_mfgr#6230,cp_type#6231,cp_size#6232,cp_container#6233,cp_retailprice#6234,cp_comment#6235,cp_brand#6236] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#6320 AS rid_0#6337, cval_part_p_name#6321 AS cval_part_p_name_0#6338, cval_part_p_mfgr#6322 AS cval_part_p_mfgr_0#6339, cval_part_p_type#6323 AS cval_part_p_type_0#6340, cval_part_p_size#6324 AS cval_part_p_size_0#6341, cval_part_p_container#6325 AS cval_part_p_container_0#6342, cval_part_p_retailprice#6326 AS cval_part_p_retailprice_0#6343, cval_part_p_comment#6327 AS cval_part_p_comment_0#6344, cval_part_p_brand#6328 AS cval_part_p_brand_0#6345, cp_name#6329 AS cp_name_0#6346, cp_mfgr#6330 AS cp_mfgr_0#6347, cp_type#6331 AS cp_type_0#6348, cp_size#6332 AS cp_size_0#6349, cp_container#6333 AS cp_container_0#6350, cp_retailprice#6334 AS cp_retailprice_0#6351, cp_comment#6335 AS cp_comment_0#6352, cp_brand#6336 AS cp_brand_0#6353]
         :     :  +- Relation[rid#6320,cval_part_p_name#6321,cval_part_p_mfgr#6322,cval_part_p_type#6323,cval_part_p_size#6324,cval_part_p_container#6325,cval_part_p_retailprice#6326,cval_part_p_comment#6327,cval_part_p_brand#6328,cp_name#6329,cp_mfgr#6330,cp_type#6331,cp_size#6332,cp_container#6333,cp_retailprice#6334,cp_comment#6335,cp_brand#6336] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#6354 AS rid_1#6387, cpfk_orders_lineitem#6355 AS cpfk_orders_lineitem_1#6388, cpfk_supplier_lineitem#6356 AS cpfk_supplier_lineitem_1#6389, cfpk_lineitem_supplier#6357 AS cfpk_lineitem_supplier_1#6390, cfpk_lineitem_partsupp#6358 AS cfpk_lineitem_partsupp_1#6391, cpfk_part_lineitem#6359 AS cpfk_part_lineitem_1#6392, cfpk_lineitem_part#6360 AS cfpk_lineitem_part_1#6393, cpfk_partsupp_lineitem#6361 AS cpfk_partsupp_lineitem_1#6394, cfpk_lineitem_orders#6362 AS cfpk_lineitem_orders_1#6395, cval_lineitem_l_quantity#6363 AS cval_lineitem_l_quantity_1#6396, cval_lineitem_l_extendedprice#6364 AS cval_lineitem_l_extendedprice_1#6397, cval_lineitem_l_discount#6365 AS cval_lineitem_l_discount_1#6398, cval_lineitem_l_tax#6366 AS cval_lineitem_l_tax_1#6399, cval_lineitem_l_returnflag#6367 AS cval_lineitem_l_returnflag_1#6400, cval_lineitem_l_linestatus#6368 AS cval_lineitem_l_linestatus_1#6401, cval_lineitem_l_commitdate#6369 AS cval_lineitem_l_commitdate_1#6402, cval_lineitem_l_receiptdate#6370 AS cval_lineitem_l_receiptdate_1#6403, cval_lineitem_l_shipinstruct#6371 AS cval_lineitem_l_shipinstruct_1#6404, cval_lineitem_l_shipmode#6372 AS cval_lineitem_l_shipmode_1#6405, cval_lineitem_l_comment#6373 AS cval_lineitem_l_comment_1#6406, cval_lineitem_l_shipdate#6374 AS cval_lineitem_l_shipdate_1#6407, cl_quantity#6375 AS cl_quantity_1#6408, cl_extendedprice#6376 AS cl_extendedprice_1#6409, cl_discount#6377 AS cl_discount_1#6410, ... 9 more fields]
         :        +- Relation[rid#6354,cpfk_orders_lineitem#6355,cpfk_supplier_lineitem#6356,cfpk_lineitem_supplier#6357,cfpk_lineitem_partsupp#6358,cpfk_part_lineitem#6359,cfpk_lineitem_part#6360,cpfk_partsupp_lineitem#6361,cfpk_lineitem_orders#6362,cval_lineitem_l_quantity#6363,cval_lineitem_l_extendedprice#6364,cval_lineitem_l_discount#6365,cval_lineitem_l_tax#6366,cval_lineitem_l_returnflag#6367,cval_lineitem_l_linestatus#6368,cval_lineitem_l_commitdate#6369,cval_lineitem_l_receiptdate#6370,cval_lineitem_l_shipinstruct#6371,cval_lineitem_l_shipmode#6372,cval_lineitem_l_comment#6373,cval_lineitem_l_shipdate#6374,cl_quantity#6375,cl_extendedprice#6376,cl_discount#6377,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6254 AS rid_1#6287, cpfk_orders_lineitem#6255 AS cpfk_orders_lineitem_1#6288, cpfk_supplier_lineitem#6256 AS cpfk_supplier_lineitem_1#6289, cfpk_lineitem_supplier#6257 AS cfpk_lineitem_supplier_1#6290, cfpk_lineitem_partsupp#6258 AS cfpk_lineitem_partsupp_1#6291, cpfk_part_lineitem#6259 AS cpfk_part_lineitem_1#6292, cfpk_lineitem_part#6260 AS cfpk_lineitem_part_1#6293, cpfk_partsupp_lineitem#6261 AS cpfk_partsupp_lineitem_1#6294, cfpk_lineitem_orders#6262 AS cfpk_lineitem_orders_1#6295, cval_lineitem_l_quantity#6263 AS cval_lineitem_l_quantity_1#6296, cval_lineitem_l_extendedprice#6264 AS cval_lineitem_l_extendedprice_1#6297, cval_lineitem_l_discount#6265 AS cval_lineitem_l_discount_1#6298, cval_lineitem_l_tax#6266 AS cval_lineitem_l_tax_1#6299, cval_lineitem_l_returnflag#6267 AS cval_lineitem_l_returnflag_1#6300, cval_lineitem_l_linestatus#6268 AS cval_lineitem_l_linestatus_1#6301, cval_lineitem_l_commitdate#6269 AS cval_lineitem_l_commitdate_1#6302, cval_lineitem_l_receiptdate#6270 AS cval_lineitem_l_receiptdate_1#6303, cval_lineitem_l_shipinstruct#6271 AS cval_lineitem_l_shipinstruct_1#6304, cval_lineitem_l_shipmode#6272 AS cval_lineitem_l_shipmode_1#6305, cval_lineitem_l_comment#6273 AS cval_lineitem_l_comment_1#6306, cval_lineitem_l_shipdate#6274 AS cval_lineitem_l_shipdate_1#6307, cl_quantity#6275 AS cl_quantity_1#6308, cl_extendedprice#6276 AS cl_extendedprice_1#6309, cl_discount#6277 AS cl_discount_1#6310, ... 9 more fields]
            +- Relation[rid#6254,cpfk_orders_lineitem#6255,cpfk_supplier_lineitem#6256,cfpk_lineitem_supplier#6257,cfpk_lineitem_partsupp#6258,cpfk_part_lineitem#6259,cfpk_lineitem_part#6260,cpfk_partsupp_lineitem#6261,cfpk_lineitem_orders#6262,cval_lineitem_l_quantity#6263,cval_lineitem_l_extendedprice#6264,cval_lineitem_l_discount#6265,cval_lineitem_l_tax#6266,cval_lineitem_l_returnflag#6267,cval_lineitem_l_linestatus#6268,cval_lineitem_l_commitdate#6269,cval_lineitem_l_receiptdate#6270,cval_lineitem_l_shipinstruct#6271,cval_lineitem_l_shipmode#6272,cval_lineitem_l_comment#6273,cval_lineitem_l_shipdate#6274,cl_quantity#6275,cl_extendedprice#6276,cl_discount#6277,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 82260ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/11 07:11:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:11:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6474L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 07:11:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:11:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:11:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:11:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:11:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:11:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:11:51 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:11:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6474L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#6476 AS rid_0#6509, cpfk_orders_lineitem#6477 AS cpfk_orders_lineitem_0#6510, cpfk_supplier_lineitem#6478 AS cpfk_supplier_lineitem_0#6511, cfpk_lineitem_supplier#6479 AS cfpk_lineitem_supplier_0#6512, cfpk_lineitem_partsupp#6480 AS cfpk_lineitem_partsupp_0#6513, cpfk_part_lineitem#6481 AS cpfk_part_lineitem_0#6514, cfpk_lineitem_part#6482 AS cfpk_lineitem_part_0#6515, cpfk_partsupp_lineitem#6483 AS cpfk_partsupp_lineitem_0#6516, cfpk_lineitem_orders#6484 AS cfpk_lineitem_orders_0#6517, cval_lineitem_l_quantity#6485 AS cval_lineitem_l_quantity_0#6518, cval_lineitem_l_extendedprice#6486 AS cval_lineitem_l_extendedprice_0#6519, cval_lineitem_l_discount#6487 AS cval_lineitem_l_discount_0#6520, cval_lineitem_l_tax#6488 AS cval_lineitem_l_tax_0#6521, cval_lineitem_l_returnflag#6489 AS cval_lineitem_l_returnflag_0#6522, cval_lineitem_l_linestatus#6490 AS cval_lineitem_l_linestatus_0#6523, cval_lineitem_l_commitdate#6491 AS cval_lineitem_l_commitdate_0#6524, cval_lineitem_l_receiptdate#6492 AS cval_lineitem_l_receiptdate_0#6525, cval_lineitem_l_shipinstruct#6493 AS cval_lineitem_l_shipinstruct_0#6526, cval_lineitem_l_shipmode#6494 AS cval_lineitem_l_shipmode_0#6527, cval_lineitem_l_comment#6495 AS cval_lineitem_l_comment_0#6528, cval_lineitem_l_shipdate#6496 AS cval_lineitem_l_shipdate_0#6529, cl_quantity#6497 AS cl_quantity_0#6530, cl_extendedprice#6498 AS cl_extendedprice_0#6531, cl_discount#6499 AS cl_discount_0#6532, ... 9 more fields]
            :  +- Relation[rid#6476,cpfk_orders_lineitem#6477,cpfk_supplier_lineitem#6478,cfpk_lineitem_supplier#6479,cfpk_lineitem_partsupp#6480,cpfk_part_lineitem#6481,cfpk_lineitem_part#6482,cpfk_partsupp_lineitem#6483,cfpk_lineitem_orders#6484,cval_lineitem_l_quantity#6485,cval_lineitem_l_extendedprice#6486,cval_lineitem_l_discount#6487,cval_lineitem_l_tax#6488,cval_lineitem_l_returnflag#6489,cval_lineitem_l_linestatus#6490,cval_lineitem_l_commitdate#6491,cval_lineitem_l_receiptdate#6492,cval_lineitem_l_shipinstruct#6493,cval_lineitem_l_shipmode#6494,cval_lineitem_l_comment#6495,cval_lineitem_l_shipdate#6496,cl_quantity#6497,cl_extendedprice#6498,cl_discount#6499,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#6542 AS rid_1#6559, cpfk_customer_orders#6543 AS cpfk_customer_orders_1#6560, cfpk_orders_customer#6544 AS cfpk_orders_customer_1#6561, cval_orders_o_orderstatus#6545 AS cval_orders_o_orderstatus_1#6562, cval_orders_o_totalprice#6546 AS cval_orders_o_totalprice_1#6563, cval_orders_o_orderpriority#6547 AS cval_orders_o_orderpriority_1#6564, cval_orders_o_clerk#6548 AS cval_orders_o_clerk_1#6565, cval_orders_o_shippriority#6549 AS cval_orders_o_shippriority_1#6566, cval_orders_o_comment#6550 AS cval_orders_o_comment_1#6567, cval_orders_o_orderdate#6551 AS cval_orders_o_orderdate_1#6568, co_orderstatus#6552 AS co_orderstatus_1#6569, co_totalprice#6553 AS co_totalprice_1#6570, co_orderpriority#6554 AS co_orderpriority_1#6571, co_clerk#6555 AS co_clerk_1#6572, co_shippriority#6556 AS co_shippriority_1#6573, co_comment#6557 AS co_comment_1#6574, co_orderdate#6558 AS co_orderdate_1#6575]
                  :     :  :  :  :  +- Relation[rid#6542,cpfk_customer_orders#6543,cfpk_orders_customer#6544,cval_orders_o_orderstatus#6545,cval_orders_o_totalprice#6546,cval_orders_o_orderpriority#6547,cval_orders_o_clerk#6548,cval_orders_o_shippriority#6549,cval_orders_o_comment#6550,cval_orders_o_orderdate#6551,co_orderstatus#6552,co_totalprice#6553,co_orderpriority#6554,co_clerk#6555,co_shippriority#6556,co_comment#6557,co_orderdate#6558] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#6576 AS rid_1#6593, cpfk_customer_orders#6577 AS cpfk_customer_orders_1#6594, cfpk_orders_customer#6578 AS cfpk_orders_customer_1#6595, cval_orders_o_orderstatus#6579 AS cval_orders_o_orderstatus_1#6596, cval_orders_o_totalprice#6580 AS cval_orders_o_totalprice_1#6597, cval_orders_o_orderpriority#6581 AS cval_orders_o_orderpriority_1#6598, cval_orders_o_clerk#6582 AS cval_orders_o_clerk_1#6599, cval_orders_o_shippriority#6583 AS cval_orders_o_shippriority_1#6600, cval_orders_o_comment#6584 AS cval_orders_o_comment_1#6601, cval_orders_o_orderdate#6585 AS cval_orders_o_orderdate_1#6602, co_orderstatus#6586 AS co_orderstatus_1#6603, co_totalprice#6587 AS co_totalprice_1#6604, co_orderpriority#6588 AS co_orderpriority_1#6605, co_clerk#6589 AS co_clerk_1#6606, co_shippriority#6590 AS co_shippriority_1#6607, co_comment#6591 AS co_comment_1#6608, co_orderdate#6592 AS co_orderdate_1#6609]
                  :     :  :  :        +- Relation[rid#6576,cpfk_customer_orders#6577,cfpk_orders_customer#6578,cval_orders_o_orderstatus#6579,cval_orders_o_totalprice#6580,cval_orders_o_orderpriority#6581,cval_orders_o_clerk#6582,cval_orders_o_shippriority#6583,cval_orders_o_comment#6584,cval_orders_o_orderdate#6585,co_orderstatus#6586,co_totalprice#6587,co_orderpriority#6588,co_clerk#6589,co_shippriority#6590,co_comment#6591,co_orderdate#6592] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :     :- Project [rid#6676 AS rid_1#6693, cpfk_customer_orders#6677 AS cpfk_customer_orders_1#6694, cfpk_orders_customer#6678 AS cfpk_orders_customer_1#6695, cval_orders_o_orderstatus#6679 AS cval_orders_o_orderstatus_1#6696, cval_orders_o_totalprice#6680 AS cval_orders_o_totalprice_1#6697, cval_orders_o_orderpriority#6681 AS cval_orders_o_orderpriority_1#6698, cval_orders_o_clerk#6682 AS cval_orders_o_clerk_1#6699, cval_orders_o_shippriority#6683 AS cval_orders_o_shippriority_1#6700, cval_orders_o_comment#6684 AS cval_orders_o_comment_1#6701, cval_orders_o_orderdate#6685 AS cval_orders_o_orderdate_1#6702, co_orderstatus#6686 AS co_orderstatus_1#6703, co_totalprice#6687 AS co_totalprice_1#6704, co_orderpriority#6688 AS co_orderpriority_1#6705, co_clerk#6689 AS co_clerk_1#6706, co_shippriority#6690 AS co_shippriority_1#6707, co_comment#6691 AS co_comment_1#6708, co_orderdate#6692 AS co_orderdate_1#6709]
                  :     :  :     :  +- Relation[rid#6676,cpfk_customer_orders#6677,cfpk_orders_customer#6678,cval_orders_o_orderstatus#6679,cval_orders_o_totalprice#6680,cval_orders_o_orderpriority#6681,cval_orders_o_clerk#6682,cval_orders_o_shippriority#6683,cval_orders_o_comment#6684,cval_orders_o_orderdate#6685,co_orderstatus#6686,co_totalprice#6687,co_orderpriority#6688,co_clerk#6689,co_shippriority#6690,co_comment#6691,co_orderdate#6692] JDBCRelation(torders) [numPartitions=1]
                  :     :  :     +- Project [rid#6710 AS rid_2#6743, cpfk_orders_lineitem#6711 AS cpfk_orders_lineitem_2#6744, cpfk_supplier_lineitem#6712 AS cpfk_supplier_lineitem_2#6745, cfpk_lineitem_supplier#6713 AS cfpk_lineitem_supplier_2#6746, cfpk_lineitem_partsupp#6714 AS cfpk_lineitem_partsupp_2#6747, cpfk_part_lineitem#6715 AS cpfk_part_lineitem_2#6748, cfpk_lineitem_part#6716 AS cfpk_lineitem_part_2#6749, cpfk_partsupp_lineitem#6717 AS cpfk_partsupp_lineitem_2#6750, cfpk_lineitem_orders#6718 AS cfpk_lineitem_orders_2#6751, cval_lineitem_l_quantity#6719 AS cval_lineitem_l_quantity_2#6752, cval_lineitem_l_extendedprice#6720 AS cval_lineitem_l_extendedprice_2#6753, cval_lineitem_l_discount#6721 AS cval_lineitem_l_discount_2#6754, cval_lineitem_l_tax#6722 AS cval_lineitem_l_tax_2#6755, cval_lineitem_l_returnflag#6723 AS cval_lineitem_l_returnflag_2#6756, cval_lineitem_l_linestatus#6724 AS cval_lineitem_l_linestatus_2#6757, cval_lineitem_l_commitdate#6725 AS cval_lineitem_l_commitdate_2#6758, cval_lineitem_l_receiptdate#6726 AS cval_lineitem_l_receiptdate_2#6759, cval_lineitem_l_shipinstruct#6727 AS cval_lineitem_l_shipinstruct_2#6760, cval_lineitem_l_shipmode#6728 AS cval_lineitem_l_shipmode_2#6761, cval_lineitem_l_comment#6729 AS cval_lineitem_l_comment_2#6762, cval_lineitem_l_shipdate#6730 AS cval_lineitem_l_shipdate_2#6763, cl_quantity#6731 AS cl_quantity_2#6764, cl_extendedprice#6732 AS cl_extendedprice_2#6765, cl_discount#6733 AS cl_discount_2#6766, ... 9 more fields]
                  :     :  :        +- Relation[rid#6710,cpfk_orders_lineitem#6711,cpfk_supplier_lineitem#6712,cfpk_lineitem_supplier#6713,cfpk_lineitem_partsupp#6714,cpfk_part_lineitem#6715,cfpk_lineitem_part#6716,cpfk_partsupp_lineitem#6717,cfpk_lineitem_orders#6718,cval_lineitem_l_quantity#6719,cval_lineitem_l_extendedprice#6720,cval_lineitem_l_discount#6721,cval_lineitem_l_tax#6722,cval_lineitem_l_returnflag#6723,cval_lineitem_l_linestatus#6724,cval_lineitem_l_commitdate#6725,cval_lineitem_l_receiptdate#6726,cval_lineitem_l_shipinstruct#6727,cval_lineitem_l_shipmode#6728,cval_lineitem_l_comment#6729,cval_lineitem_l_shipdate#6730,cl_quantity#6731,cl_extendedprice#6732,cl_discount#6733,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#6610 AS rid_2#6643, cpfk_orders_lineitem#6611 AS cpfk_orders_lineitem_2#6644, cpfk_supplier_lineitem#6612 AS cpfk_supplier_lineitem_2#6645, cfpk_lineitem_supplier#6613 AS cfpk_lineitem_supplier_2#6646, cfpk_lineitem_partsupp#6614 AS cfpk_lineitem_partsupp_2#6647, cpfk_part_lineitem#6615 AS cpfk_part_lineitem_2#6648, cfpk_lineitem_part#6616 AS cfpk_lineitem_part_2#6649, cpfk_partsupp_lineitem#6617 AS cpfk_partsupp_lineitem_2#6650, cfpk_lineitem_orders#6618 AS cfpk_lineitem_orders_2#6651, cval_lineitem_l_quantity#6619 AS cval_lineitem_l_quantity_2#6652, cval_lineitem_l_extendedprice#6620 AS cval_lineitem_l_extendedprice_2#6653, cval_lineitem_l_discount#6621 AS cval_lineitem_l_discount_2#6654, cval_lineitem_l_tax#6622 AS cval_lineitem_l_tax_2#6655, cval_lineitem_l_returnflag#6623 AS cval_lineitem_l_returnflag_2#6656, cval_lineitem_l_linestatus#6624 AS cval_lineitem_l_linestatus_2#6657, cval_lineitem_l_commitdate#6625 AS cval_lineitem_l_commitdate_2#6658, cval_lineitem_l_receiptdate#6626 AS cval_lineitem_l_receiptdate_2#6659, cval_lineitem_l_shipinstruct#6627 AS cval_lineitem_l_shipinstruct_2#6660, cval_lineitem_l_shipmode#6628 AS cval_lineitem_l_shipmode_2#6661, cval_lineitem_l_comment#6629 AS cval_lineitem_l_comment_2#6662, cval_lineitem_l_shipdate#6630 AS cval_lineitem_l_shipdate_2#6663, cl_quantity#6631 AS cl_quantity_2#6664, cl_extendedprice#6632 AS cl_extendedprice_2#6665, cl_discount#6633 AS cl_discount_2#6666, ... 9 more fields]
                  :     :     +- Relation[rid#6610,cpfk_orders_lineitem#6611,cpfk_supplier_lineitem#6612,cfpk_lineitem_supplier#6613,cfpk_lineitem_partsupp#6614,cpfk_part_lineitem#6615,cfpk_lineitem_part#6616,cpfk_partsupp_lineitem#6617,cfpk_lineitem_orders#6618,cval_lineitem_l_quantity#6619,cval_lineitem_l_extendedprice#6620,cval_lineitem_l_discount#6621,cval_lineitem_l_tax#6622,cval_lineitem_l_returnflag#6623,cval_lineitem_l_linestatus#6624,cval_lineitem_l_commitdate#6625,cval_lineitem_l_receiptdate#6626,cval_lineitem_l_shipinstruct#6627,cval_lineitem_l_shipmode#6628,cval_lineitem_l_comment#6629,cval_lineitem_l_shipdate#6630,cl_quantity#6631,cl_extendedprice#6632,cl_discount#6633,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#6776 AS rid_3#6789, cpfk_nation_supplier#6777 AS cpfk_nation_supplier_3#6790, cfpk_supplier_nation#6778 AS cfpk_supplier_nation_3#6791, cval_supplier_s_name#6779 AS cval_supplier_s_name_3#6792, cval_supplier_s_address#6780 AS cval_supplier_s_address_3#6793, cval_supplier_s_phone#6781 AS cval_supplier_s_phone_3#6794, cval_supplier_s_acctbal#6782 AS cval_supplier_s_acctbal_3#6795, cval_supplier_s_comment#6783 AS cval_supplier_s_comment_3#6796, cs_name#6784 AS cs_name_3#6797, cs_address#6785 AS cs_address_3#6798, cs_phone#6786 AS cs_phone_3#6799, cs_acctbal#6787 AS cs_acctbal_3#6800, cs_comment#6788 AS cs_comment_3#6801]
                  :        +- Relation[rid#6776,cpfk_nation_supplier#6777,cfpk_supplier_nation#6778,cval_supplier_s_name#6779,cval_supplier_s_address#6780,cval_supplier_s_phone#6781,cval_supplier_s_acctbal#6782,cval_supplier_s_comment#6783,cs_name#6784,cs_address#6785,cs_phone#6786,cs_acctbal#6787,cs_comment#6788] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#6802 AS rid_4#6809, cpfk_region_nation#6803 AS cpfk_region_nation_4#6810, cfpk_nation_region#6804 AS cfpk_nation_region_4#6811, cval_nation_n_name#6805 AS cval_nation_n_name_4#6812, cval_nation_n_comment#6806 AS cval_nation_n_comment_4#6813, cn_name#6807 AS cn_name_4#6814, cn_comment#6808 AS cn_comment_4#6815]
                     :  +- Relation[rid#6802,cpfk_region_nation#6803,cfpk_nation_region#6804,cval_nation_n_name#6805,cval_nation_n_comment#6806,cn_name#6807,cn_comment#6808] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#6816 AS rid_4#6823, cpfk_region_nation#6817 AS cpfk_region_nation_4#6824, cfpk_nation_region#6818 AS cfpk_nation_region_4#6825, cval_nation_n_name#6819 AS cval_nation_n_name_4#6826, cval_nation_n_comment#6820 AS cval_nation_n_comment_4#6827, cn_name#6821 AS cn_name_4#6828, cn_comment#6822 AS cn_comment_4#6829]
                           +- Relation[rid#6816,cpfk_region_nation#6817,cfpk_nation_region#6818,cval_nation_n_name#6819,cval_nation_n_comment#6820,cn_name#6821,cn_comment#6822] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 246408ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/11 07:15:57 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:15:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6939L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 07:15:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:15:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:15:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:15:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:15:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:15:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:15:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:15:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:15:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:15:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:15:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:15:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:15:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:15:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6939L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#6941 AS rid_0#6948, cpfk_region_nation#6942 AS cpfk_region_nation_0#6949, cfpk_nation_region#6943 AS cfpk_nation_region_0#6950, cval_nation_n_name#6944 AS cval_nation_n_name_0#6951, cval_nation_n_comment#6945 AS cval_nation_n_comment_0#6952, cn_name#6946 AS cn_name_0#6953, cn_comment#6947 AS cn_comment_0#6954]
         :  :  :  :  :  +- Relation[rid#6941,cpfk_region_nation#6942,cfpk_nation_region#6943,cval_nation_n_name#6944,cval_nation_n_comment#6945,cn_name#6946,cn_comment#6947] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#6955 AS rid_0#6962, cpfk_region_nation#6956 AS cpfk_region_nation_0#6963, cfpk_nation_region#6957 AS cfpk_nation_region_0#6964, cval_nation_n_name#6958 AS cval_nation_n_name_0#6965, cval_nation_n_comment#6959 AS cval_nation_n_comment_0#6966, cn_name#6960 AS cn_name_0#6967, cn_comment#6961 AS cn_comment_0#6968]
         :  :  :  :        +- Relation[rid#6955,cpfk_region_nation#6956,cfpk_nation_region#6957,cval_nation_n_name#6958,cval_nation_n_comment#6959,cn_name#6960,cn_comment#6961] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :     :- Project [rid#6995 AS rid_0#7002, cpfk_region_nation#6996 AS cpfk_region_nation_0#7003, cfpk_nation_region#6997 AS cfpk_nation_region_0#7004, cval_nation_n_name#6998 AS cval_nation_n_name_0#7005, cval_nation_n_comment#6999 AS cval_nation_n_comment_0#7006, cn_name#7000 AS cn_name_0#7007, cn_comment#7001 AS cn_comment_0#7008]
         :  :  :     :  +- Relation[rid#6995,cpfk_region_nation#6996,cfpk_nation_region#6997,cval_nation_n_name#6998,cval_nation_n_comment#6999,cn_name#7000,cn_comment#7001] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#7009 AS rid_1#7022, cpfk_nation_supplier#7010 AS cpfk_nation_supplier_1#7023, cfpk_supplier_nation#7011 AS cfpk_supplier_nation_1#7024, cval_supplier_s_name#7012 AS cval_supplier_s_name_1#7025, cval_supplier_s_address#7013 AS cval_supplier_s_address_1#7026, cval_supplier_s_phone#7014 AS cval_supplier_s_phone_1#7027, cval_supplier_s_acctbal#7015 AS cval_supplier_s_acctbal_1#7028, cval_supplier_s_comment#7016 AS cval_supplier_s_comment_1#7029, cs_name#7017 AS cs_name_1#7030, cs_address#7018 AS cs_address_1#7031, cs_phone#7019 AS cs_phone_1#7032, cs_acctbal#7020 AS cs_acctbal_1#7033, cs_comment#7021 AS cs_comment_1#7034]
         :  :  :        +- Relation[rid#7009,cpfk_nation_supplier#7010,cfpk_supplier_nation#7011,cval_supplier_s_name#7012,cval_supplier_s_address#7013,cval_supplier_s_phone#7014,cval_supplier_s_acctbal#7015,cval_supplier_s_comment#7016,cs_name#7017,cs_address#7018,cs_phone#7019,cs_acctbal#7020,cs_comment#7021] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#6969 AS rid_1#6982, cpfk_nation_supplier#6970 AS cpfk_nation_supplier_1#6983, cfpk_supplier_nation#6971 AS cfpk_supplier_nation_1#6984, cval_supplier_s_name#6972 AS cval_supplier_s_name_1#6985, cval_supplier_s_address#6973 AS cval_supplier_s_address_1#6986, cval_supplier_s_phone#6974 AS cval_supplier_s_phone_1#6987, cval_supplier_s_acctbal#6975 AS cval_supplier_s_acctbal_1#6988, cval_supplier_s_comment#6976 AS cval_supplier_s_comment_1#6989, cs_name#6977 AS cs_name_1#6990, cs_address#6978 AS cs_address_1#6991, cs_phone#6979 AS cs_phone_1#6992, cs_acctbal#6980 AS cs_acctbal_1#6993, cs_comment#6981 AS cs_comment_1#6994]
         :  :     +- Relation[rid#6969,cpfk_nation_supplier#6970,cfpk_supplier_nation#6971,cval_supplier_s_name#6972,cval_supplier_s_address#6973,cval_supplier_s_phone#6974,cval_supplier_s_acctbal#6975,cval_supplier_s_comment#6976,cs_name#6977,cs_address#6978,cs_phone#6979,cs_acctbal#6980,cs_comment#6981] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :     :- Project [rid#7057 AS rid_1#7070, cpfk_nation_supplier#7058 AS cpfk_nation_supplier_1#7071, cfpk_supplier_nation#7059 AS cfpk_supplier_nation_1#7072, cval_supplier_s_name#7060 AS cval_supplier_s_name_1#7073, cval_supplier_s_address#7061 AS cval_supplier_s_address_1#7074, cval_supplier_s_phone#7062 AS cval_supplier_s_phone_1#7075, cval_supplier_s_acctbal#7063 AS cval_supplier_s_acctbal_1#7076, cval_supplier_s_comment#7064 AS cval_supplier_s_comment_1#7077, cs_name#7065 AS cs_name_1#7078, cs_address#7066 AS cs_address_1#7079, cs_phone#7067 AS cs_phone_1#7080, cs_acctbal#7068 AS cs_acctbal_1#7081, cs_comment#7069 AS cs_comment_1#7082]
         :     :  +- Relation[rid#7057,cpfk_nation_supplier#7058,cfpk_supplier_nation#7059,cval_supplier_s_name#7060,cval_supplier_s_address#7061,cval_supplier_s_phone#7062,cval_supplier_s_acctbal#7063,cval_supplier_s_comment#7064,cs_name#7065,cs_address#7066,cs_phone#7067,cs_acctbal#7068,cs_comment#7069] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#7083 AS rid_2#7094, cpfk_part_partsupp#7084 AS cpfk_part_partsupp_2#7095, cfpk_partsupp_part#7085 AS cfpk_partsupp_part_2#7096, cpfk_supplier_partsupp#7086 AS cpfk_supplier_partsupp_2#7097, cfpk_partsupp_supplier#7087 AS cfpk_partsupp_supplier_2#7098, cval_partsupp_ps_availqty#7088 AS cval_partsupp_ps_availqty_2#7099, cval_partsupp_ps_supplycost#7089 AS cval_partsupp_ps_supplycost_2#7100, cval_partsupp_ps_comment#7090 AS cval_partsupp_ps_comment_2#7101, cps_availqty#7091 AS cps_availqty_2#7102, cps_supplycost#7092 AS cps_supplycost_2#7103, cps_comment#7093 AS cps_comment_2#7104]
         :        +- Relation[rid#7083,cpfk_part_partsupp#7084,cfpk_partsupp_part#7085,cpfk_supplier_partsupp#7086,cfpk_partsupp_supplier#7087,cval_partsupp_ps_availqty#7088,cval_partsupp_ps_supplycost#7089,cval_partsupp_ps_comment#7090,cps_availqty#7091,cps_supplycost#7092,cps_comment#7093] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#7035 AS rid_2#7046, cpfk_part_partsupp#7036 AS cpfk_part_partsupp_2#7047, cfpk_partsupp_part#7037 AS cfpk_partsupp_part_2#7048, cpfk_supplier_partsupp#7038 AS cpfk_supplier_partsupp_2#7049, cfpk_partsupp_supplier#7039 AS cfpk_partsupp_supplier_2#7050, cval_partsupp_ps_availqty#7040 AS cval_partsupp_ps_availqty_2#7051, cval_partsupp_ps_supplycost#7041 AS cval_partsupp_ps_supplycost_2#7052, cval_partsupp_ps_comment#7042 AS cval_partsupp_ps_comment_2#7053, cps_availqty#7043 AS cps_availqty_2#7054, cps_supplycost#7044 AS cps_supplycost_2#7055, cps_comment#7045 AS cps_comment_2#7056]
            +- Relation[rid#7035,cpfk_part_partsupp#7036,cfpk_partsupp_part#7037,cpfk_supplier_partsupp#7038,cfpk_partsupp_supplier#7039,cval_partsupp_ps_availqty#7040,cval_partsupp_ps_supplycost#7041,cval_partsupp_ps_comment#7042,cps_availqty#7043,cps_supplycost#7044,cps_comment#7045] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 10548ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/11 07:16:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:16:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7148L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 07:16:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:16:08 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:16:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7148L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#7150 AS rid_0#7183, cpfk_orders_lineitem#7151 AS cpfk_orders_lineitem_0#7184, cpfk_supplier_lineitem#7152 AS cpfk_supplier_lineitem_0#7185, cfpk_lineitem_supplier#7153 AS cfpk_lineitem_supplier_0#7186, cfpk_lineitem_partsupp#7154 AS cfpk_lineitem_partsupp_0#7187, cpfk_part_lineitem#7155 AS cpfk_part_lineitem_0#7188, cfpk_lineitem_part#7156 AS cfpk_lineitem_part_0#7189, cpfk_partsupp_lineitem#7157 AS cpfk_partsupp_lineitem_0#7190, cfpk_lineitem_orders#7158 AS cfpk_lineitem_orders_0#7191, cval_lineitem_l_quantity#7159 AS cval_lineitem_l_quantity_0#7192, cval_lineitem_l_extendedprice#7160 AS cval_lineitem_l_extendedprice_0#7193, cval_lineitem_l_discount#7161 AS cval_lineitem_l_discount_0#7194, cval_lineitem_l_tax#7162 AS cval_lineitem_l_tax_0#7195, cval_lineitem_l_returnflag#7163 AS cval_lineitem_l_returnflag_0#7196, cval_lineitem_l_linestatus#7164 AS cval_lineitem_l_linestatus_0#7197, cval_lineitem_l_commitdate#7165 AS cval_lineitem_l_commitdate_0#7198, cval_lineitem_l_receiptdate#7166 AS cval_lineitem_l_receiptdate_0#7199, cval_lineitem_l_shipinstruct#7167 AS cval_lineitem_l_shipinstruct_0#7200, cval_lineitem_l_shipmode#7168 AS cval_lineitem_l_shipmode_0#7201, cval_lineitem_l_comment#7169 AS cval_lineitem_l_comment_0#7202, cval_lineitem_l_shipdate#7170 AS cval_lineitem_l_shipdate_0#7203, cl_quantity#7171 AS cl_quantity_0#7204, cl_extendedprice#7172 AS cl_extendedprice_0#7205, cl_discount#7173 AS cl_discount_0#7206, ... 9 more fields]
            :     :     :  :  +- Relation[rid#7150,cpfk_orders_lineitem#7151,cpfk_supplier_lineitem#7152,cfpk_lineitem_supplier#7153,cfpk_lineitem_partsupp#7154,cpfk_part_lineitem#7155,cfpk_lineitem_part#7156,cpfk_partsupp_lineitem#7157,cfpk_lineitem_orders#7158,cval_lineitem_l_quantity#7159,cval_lineitem_l_extendedprice#7160,cval_lineitem_l_discount#7161,cval_lineitem_l_tax#7162,cval_lineitem_l_returnflag#7163,cval_lineitem_l_linestatus#7164,cval_lineitem_l_commitdate#7165,cval_lineitem_l_receiptdate#7166,cval_lineitem_l_shipinstruct#7167,cval_lineitem_l_shipmode#7168,cval_lineitem_l_comment#7169,cval_lineitem_l_shipdate#7170,cl_quantity#7171,cl_extendedprice#7172,cl_discount#7173,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#7216 AS rid_0#7249, cpfk_orders_lineitem#7217 AS cpfk_orders_lineitem_0#7250, cpfk_supplier_lineitem#7218 AS cpfk_supplier_lineitem_0#7251, cfpk_lineitem_supplier#7219 AS cfpk_lineitem_supplier_0#7252, cfpk_lineitem_partsupp#7220 AS cfpk_lineitem_partsupp_0#7253, cpfk_part_lineitem#7221 AS cpfk_part_lineitem_0#7254, cfpk_lineitem_part#7222 AS cfpk_lineitem_part_0#7255, cpfk_partsupp_lineitem#7223 AS cpfk_partsupp_lineitem_0#7256, cfpk_lineitem_orders#7224 AS cfpk_lineitem_orders_0#7257, cval_lineitem_l_quantity#7225 AS cval_lineitem_l_quantity_0#7258, cval_lineitem_l_extendedprice#7226 AS cval_lineitem_l_extendedprice_0#7259, cval_lineitem_l_discount#7227 AS cval_lineitem_l_discount_0#7260, cval_lineitem_l_tax#7228 AS cval_lineitem_l_tax_0#7261, cval_lineitem_l_returnflag#7229 AS cval_lineitem_l_returnflag_0#7262, cval_lineitem_l_linestatus#7230 AS cval_lineitem_l_linestatus_0#7263, cval_lineitem_l_commitdate#7231 AS cval_lineitem_l_commitdate_0#7264, cval_lineitem_l_receiptdate#7232 AS cval_lineitem_l_receiptdate_0#7265, cval_lineitem_l_shipinstruct#7233 AS cval_lineitem_l_shipinstruct_0#7266, cval_lineitem_l_shipmode#7234 AS cval_lineitem_l_shipmode_0#7267, cval_lineitem_l_comment#7235 AS cval_lineitem_l_comment_0#7268, cval_lineitem_l_shipdate#7236 AS cval_lineitem_l_shipdate_0#7269, cl_quantity#7237 AS cl_quantity_0#7270, cl_extendedprice#7238 AS cl_extendedprice_0#7271, cl_discount#7239 AS cl_discount_0#7272, ... 9 more fields]
            :     :     :        +- Relation[rid#7216,cpfk_orders_lineitem#7217,cpfk_supplier_lineitem#7218,cfpk_lineitem_supplier#7219,cfpk_lineitem_partsupp#7220,cpfk_part_lineitem#7221,cfpk_lineitem_part#7222,cpfk_partsupp_lineitem#7223,cfpk_lineitem_orders#7224,cval_lineitem_l_quantity#7225,cval_lineitem_l_extendedprice#7226,cval_lineitem_l_discount#7227,cval_lineitem_l_tax#7228,cval_lineitem_l_returnflag#7229,cval_lineitem_l_linestatus#7230,cval_lineitem_l_commitdate#7231,cval_lineitem_l_receiptdate#7232,cval_lineitem_l_shipinstruct#7233,cval_lineitem_l_shipmode#7234,cval_lineitem_l_comment#7235,cval_lineitem_l_shipdate#7236,cl_quantity#7237,cl_extendedprice#7238,cl_discount#7239,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#7282 AS rid_1#7299, cpfk_customer_orders#7283 AS cpfk_customer_orders_1#7300, cfpk_orders_customer#7284 AS cfpk_orders_customer_1#7301, cval_orders_o_orderstatus#7285 AS cval_orders_o_orderstatus_1#7302, cval_orders_o_totalprice#7286 AS cval_orders_o_totalprice_1#7303, cval_orders_o_orderpriority#7287 AS cval_orders_o_orderpriority_1#7304, cval_orders_o_clerk#7288 AS cval_orders_o_clerk_1#7305, cval_orders_o_shippriority#7289 AS cval_orders_o_shippriority_1#7306, cval_orders_o_comment#7290 AS cval_orders_o_comment_1#7307, cval_orders_o_orderdate#7291 AS cval_orders_o_orderdate_1#7308, co_orderstatus#7292 AS co_orderstatus_1#7309, co_totalprice#7293 AS co_totalprice_1#7310, co_orderpriority#7294 AS co_orderpriority_1#7311, co_clerk#7295 AS co_clerk_1#7312, co_shippriority#7296 AS co_shippriority_1#7313, co_comment#7297 AS co_comment_1#7314, co_orderdate#7298 AS co_orderdate_1#7315]
            :     :        +- Relation[rid#7282,cpfk_customer_orders#7283,cfpk_orders_customer#7284,cval_orders_o_orderstatus#7285,cval_orders_o_totalprice#7286,cval_orders_o_orderpriority#7287,cval_orders_o_clerk#7288,cval_orders_o_shippriority#7289,cval_orders_o_comment#7290,cval_orders_o_orderdate#7291,co_orderstatus#7292,co_totalprice#7293,co_orderpriority#7294,co_clerk#7295,co_shippriority#7296,co_comment#7297,co_orderdate#7298] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#7316 AS rid_2#7331, cpfk_nation_customer#7317 AS cpfk_nation_customer_2#7332, cfpk_customer_nation#7318 AS cfpk_customer_nation_2#7333, cval_customer_c_name#7319 AS cval_customer_c_name_2#7334, cval_customer_c_address#7320 AS cval_customer_c_address_2#7335, cval_customer_c_phone#7321 AS cval_customer_c_phone_2#7336, cval_customer_c_acctbal#7322 AS cval_customer_c_acctbal_2#7337, cval_customer_c_comment#7323 AS cval_customer_c_comment_2#7338, cval_customer_c_mktsegment#7324 AS cval_customer_c_mktsegment_2#7339, cc_name#7325 AS cc_name_2#7340, cc_address#7326 AS cc_address_2#7341, cc_phone#7327 AS cc_phone_2#7342, cc_acctbal#7328 AS cc_acctbal_2#7343, cc_comment#7329 AS cc_comment_2#7344, cc_mktsegment#7330 AS cc_mktsegment_2#7345]
            :        +- Relation[rid#7316,cpfk_nation_customer#7317,cfpk_customer_nation#7318,cval_customer_c_name#7319,cval_customer_c_address#7320,cval_customer_c_phone#7321,cval_customer_c_acctbal#7322,cval_customer_c_comment#7323,cval_customer_c_mktsegment#7324,cc_name#7325,cc_address#7326,cc_phone#7327,cc_acctbal#7328,cc_comment#7329,cc_mktsegment#7330] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#7346 AS rid_3#7353, cpfk_region_nation#7347 AS cpfk_region_nation_3#7354, cfpk_nation_region#7348 AS cfpk_nation_region_3#7355, cval_nation_n_name#7349 AS cval_nation_n_name_3#7356, cval_nation_n_comment#7350 AS cval_nation_n_comment_3#7357, cn_name#7351 AS cn_name_3#7358, cn_comment#7352 AS cn_comment_3#7359]
               +- Relation[rid#7346,cpfk_region_nation#7347,cfpk_nation_region#7348,cval_nation_n_name#7349,cval_nation_n_comment#7350,cn_name#7351,cn_comment#7352] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 61517ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 07:17:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:17:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7441L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 07:17:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:17:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:17:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:17:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:17:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:17:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:17:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:17:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:17:09 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:17:09 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:17:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7441L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#7443 AS rid_0#7450, cpfk_region_nation#7444 AS cpfk_region_nation_0#7451, cfpk_nation_region#7445 AS cfpk_nation_region_0#7452, cval_nation_n_name#7446 AS cval_nation_n_name_0#7453, cval_nation_n_comment#7447 AS cval_nation_n_comment_0#7454, cn_name#7448 AS cn_name_0#7455, cn_comment#7449 AS cn_comment_0#7456]
            :     :     :  :  :  :  :  +- Relation[rid#7443,cpfk_region_nation#7444,cfpk_nation_region#7445,cval_nation_n_name#7446,cval_nation_n_comment#7447,cn_name#7448,cn_comment#7449] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#7483 AS rid_0#7490, cpfk_region_nation#7484 AS cpfk_region_nation_0#7491, cfpk_nation_region#7485 AS cfpk_nation_region_0#7492, cval_nation_n_name#7486 AS cval_nation_n_name_0#7493, cval_nation_n_comment#7487 AS cval_nation_n_comment_0#7494, cn_name#7488 AS cn_name_0#7495, cn_comment#7489 AS cn_comment_0#7496]
            :     :     :  :  :  :     :  +- Relation[rid#7483,cpfk_region_nation#7484,cfpk_nation_region#7485,cval_nation_n_name#7486,cval_nation_n_comment#7487,cn_name#7488,cn_comment#7489] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#7497 AS rid_1#7510, cpfk_nation_supplier#7498 AS cpfk_nation_supplier_1#7511, cfpk_supplier_nation#7499 AS cfpk_supplier_nation_1#7512, cval_supplier_s_name#7500 AS cval_supplier_s_name_1#7513, cval_supplier_s_address#7501 AS cval_supplier_s_address_1#7514, cval_supplier_s_phone#7502 AS cval_supplier_s_phone_1#7515, cval_supplier_s_acctbal#7503 AS cval_supplier_s_acctbal_1#7516, cval_supplier_s_comment#7504 AS cval_supplier_s_comment_1#7517, cs_name#7505 AS cs_name_1#7518, cs_address#7506 AS cs_address_1#7519, cs_phone#7507 AS cs_phone_1#7520, cs_acctbal#7508 AS cs_acctbal_1#7521, cs_comment#7509 AS cs_comment_1#7522]
            :     :     :  :  :  :        +- Relation[rid#7497,cpfk_nation_supplier#7498,cfpk_supplier_nation#7499,cval_supplier_s_name#7500,cval_supplier_s_address#7501,cval_supplier_s_phone#7502,cval_supplier_s_acctbal#7503,cval_supplier_s_comment#7504,cs_name#7505,cs_address#7506,cs_phone#7507,cs_acctbal#7508,cs_comment#7509] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#7457 AS rid_1#7470, cpfk_nation_supplier#7458 AS cpfk_nation_supplier_1#7471, cfpk_supplier_nation#7459 AS cfpk_supplier_nation_1#7472, cval_supplier_s_name#7460 AS cval_supplier_s_name_1#7473, cval_supplier_s_address#7461 AS cval_supplier_s_address_1#7474, cval_supplier_s_phone#7462 AS cval_supplier_s_phone_1#7475, cval_supplier_s_acctbal#7463 AS cval_supplier_s_acctbal_1#7476, cval_supplier_s_comment#7464 AS cval_supplier_s_comment_1#7477, cs_name#7465 AS cs_name_1#7478, cs_address#7466 AS cs_address_1#7479, cs_phone#7467 AS cs_phone_1#7480, cs_acctbal#7468 AS cs_acctbal_1#7481, cs_comment#7469 AS cs_comment_1#7482]
            :     :     :  :  :     +- Relation[rid#7457,cpfk_nation_supplier#7458,cfpk_supplier_nation#7459,cval_supplier_s_name#7460,cval_supplier_s_address#7461,cval_supplier_s_phone#7462,cval_supplier_s_acctbal#7463,cval_supplier_s_comment#7464,cs_name#7465,cs_address#7466,cs_phone#7467,cs_acctbal#7468,cs_comment#7469] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#7589 AS rid_1#7602, cpfk_nation_supplier#7590 AS cpfk_nation_supplier_1#7603, cfpk_supplier_nation#7591 AS cfpk_supplier_nation_1#7604, cval_supplier_s_name#7592 AS cval_supplier_s_name_1#7605, cval_supplier_s_address#7593 AS cval_supplier_s_address_1#7606, cval_supplier_s_phone#7594 AS cval_supplier_s_phone_1#7607, cval_supplier_s_acctbal#7595 AS cval_supplier_s_acctbal_1#7608, cval_supplier_s_comment#7596 AS cval_supplier_s_comment_1#7609, cs_name#7597 AS cs_name_1#7610, cs_address#7598 AS cs_address_1#7611, cs_phone#7599 AS cs_phone_1#7612, cs_acctbal#7600 AS cs_acctbal_1#7613, cs_comment#7601 AS cs_comment_1#7614]
            :     :     :  :     :  +- Relation[rid#7589,cpfk_nation_supplier#7590,cfpk_supplier_nation#7591,cval_supplier_s_name#7592,cval_supplier_s_address#7593,cval_supplier_s_phone#7594,cval_supplier_s_acctbal#7595,cval_supplier_s_comment#7596,cs_name#7597,cs_address#7598,cs_phone#7599,cs_acctbal#7600,cs_comment#7601] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#7615 AS rid_2#7648, cpfk_orders_lineitem#7616 AS cpfk_orders_lineitem_2#7649, cpfk_supplier_lineitem#7617 AS cpfk_supplier_lineitem_2#7650, cfpk_lineitem_supplier#7618 AS cfpk_lineitem_supplier_2#7651, cfpk_lineitem_partsupp#7619 AS cfpk_lineitem_partsupp_2#7652, cpfk_part_lineitem#7620 AS cpfk_part_lineitem_2#7653, cfpk_lineitem_part#7621 AS cfpk_lineitem_part_2#7654, cpfk_partsupp_lineitem#7622 AS cpfk_partsupp_lineitem_2#7655, cfpk_lineitem_orders#7623 AS cfpk_lineitem_orders_2#7656, cval_lineitem_l_quantity#7624 AS cval_lineitem_l_quantity_2#7657, cval_lineitem_l_extendedprice#7625 AS cval_lineitem_l_extendedprice_2#7658, cval_lineitem_l_discount#7626 AS cval_lineitem_l_discount_2#7659, cval_lineitem_l_tax#7627 AS cval_lineitem_l_tax_2#7660, cval_lineitem_l_returnflag#7628 AS cval_lineitem_l_returnflag_2#7661, cval_lineitem_l_linestatus#7629 AS cval_lineitem_l_linestatus_2#7662, cval_lineitem_l_commitdate#7630 AS cval_lineitem_l_commitdate_2#7663, cval_lineitem_l_receiptdate#7631 AS cval_lineitem_l_receiptdate_2#7664, cval_lineitem_l_shipinstruct#7632 AS cval_lineitem_l_shipinstruct_2#7665, cval_lineitem_l_shipmode#7633 AS cval_lineitem_l_shipmode_2#7666, cval_lineitem_l_comment#7634 AS cval_lineitem_l_comment_2#7667, cval_lineitem_l_shipdate#7635 AS cval_lineitem_l_shipdate_2#7668, cl_quantity#7636 AS cl_quantity_2#7669, cl_extendedprice#7637 AS cl_extendedprice_2#7670, cl_discount#7638 AS cl_discount_2#7671, ... 9 more fields]
            :     :     :  :        +- Relation[rid#7615,cpfk_orders_lineitem#7616,cpfk_supplier_lineitem#7617,cfpk_lineitem_supplier#7618,cfpk_lineitem_partsupp#7619,cpfk_part_lineitem#7620,cfpk_lineitem_part#7621,cpfk_partsupp_lineitem#7622,cfpk_lineitem_orders#7623,cval_lineitem_l_quantity#7624,cval_lineitem_l_extendedprice#7625,cval_lineitem_l_discount#7626,cval_lineitem_l_tax#7627,cval_lineitem_l_returnflag#7628,cval_lineitem_l_linestatus#7629,cval_lineitem_l_commitdate#7630,cval_lineitem_l_receiptdate#7631,cval_lineitem_l_shipinstruct#7632,cval_lineitem_l_shipmode#7633,cval_lineitem_l_comment#7634,cval_lineitem_l_shipdate#7635,cl_quantity#7636,cl_extendedprice#7637,cl_discount#7638,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#7523 AS rid_2#7556, cpfk_orders_lineitem#7524 AS cpfk_orders_lineitem_2#7557, cpfk_supplier_lineitem#7525 AS cpfk_supplier_lineitem_2#7558, cfpk_lineitem_supplier#7526 AS cfpk_lineitem_supplier_2#7559, cfpk_lineitem_partsupp#7527 AS cfpk_lineitem_partsupp_2#7560, cpfk_part_lineitem#7528 AS cpfk_part_lineitem_2#7561, cfpk_lineitem_part#7529 AS cfpk_lineitem_part_2#7562, cpfk_partsupp_lineitem#7530 AS cpfk_partsupp_lineitem_2#7563, cfpk_lineitem_orders#7531 AS cfpk_lineitem_orders_2#7564, cval_lineitem_l_quantity#7532 AS cval_lineitem_l_quantity_2#7565, cval_lineitem_l_extendedprice#7533 AS cval_lineitem_l_extendedprice_2#7566, cval_lineitem_l_discount#7534 AS cval_lineitem_l_discount_2#7567, cval_lineitem_l_tax#7535 AS cval_lineitem_l_tax_2#7568, cval_lineitem_l_returnflag#7536 AS cval_lineitem_l_returnflag_2#7569, cval_lineitem_l_linestatus#7537 AS cval_lineitem_l_linestatus_2#7570, cval_lineitem_l_commitdate#7538 AS cval_lineitem_l_commitdate_2#7571, cval_lineitem_l_receiptdate#7539 AS cval_lineitem_l_receiptdate_2#7572, cval_lineitem_l_shipinstruct#7540 AS cval_lineitem_l_shipinstruct_2#7573, cval_lineitem_l_shipmode#7541 AS cval_lineitem_l_shipmode_2#7574, cval_lineitem_l_comment#7542 AS cval_lineitem_l_comment_2#7575, cval_lineitem_l_shipdate#7543 AS cval_lineitem_l_shipdate_2#7576, cl_quantity#7544 AS cl_quantity_2#7577, cl_extendedprice#7545 AS cl_extendedprice_2#7578, cl_discount#7546 AS cl_discount_2#7579, ... 9 more fields]
            :     :     :     +- Relation[rid#7523,cpfk_orders_lineitem#7524,cpfk_supplier_lineitem#7525,cfpk_lineitem_supplier#7526,cfpk_lineitem_partsupp#7527,cpfk_part_lineitem#7528,cfpk_lineitem_part#7529,cpfk_partsupp_lineitem#7530,cfpk_lineitem_orders#7531,cval_lineitem_l_quantity#7532,cval_lineitem_l_extendedprice#7533,cval_lineitem_l_discount#7534,cval_lineitem_l_tax#7535,cval_lineitem_l_returnflag#7536,cval_lineitem_l_linestatus#7537,cval_lineitem_l_commitdate#7538,cval_lineitem_l_receiptdate#7539,cval_lineitem_l_shipinstruct#7540,cval_lineitem_l_shipmode#7541,cval_lineitem_l_comment#7542,cval_lineitem_l_shipdate#7543,cl_quantity#7544,cl_extendedprice#7545,cl_discount#7546,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#7681 AS rid_3#7698, cval_part_p_name#7682 AS cval_part_p_name_3#7699, cval_part_p_mfgr#7683 AS cval_part_p_mfgr_3#7700, cval_part_p_type#7684 AS cval_part_p_type_3#7701, cval_part_p_size#7685 AS cval_part_p_size_3#7702, cval_part_p_container#7686 AS cval_part_p_container_3#7703, cval_part_p_retailprice#7687 AS cval_part_p_retailprice_3#7704, cval_part_p_comment#7688 AS cval_part_p_comment_3#7705, cval_part_p_brand#7689 AS cval_part_p_brand_3#7706, cp_name#7690 AS cp_name_3#7707, cp_mfgr#7691 AS cp_mfgr_3#7708, cp_type#7692 AS cp_type_3#7709, cp_size#7693 AS cp_size_3#7710, cp_container#7694 AS cp_container_3#7711, cp_retailprice#7695 AS cp_retailprice_3#7712, cp_comment#7696 AS cp_comment_3#7713, cp_brand#7697 AS cp_brand_3#7714]
            :     :        +- Relation[rid#7681,cval_part_p_name#7682,cval_part_p_mfgr#7683,cval_part_p_type#7684,cval_part_p_size#7685,cval_part_p_container#7686,cval_part_p_retailprice#7687,cval_part_p_comment#7688,cval_part_p_brand#7689,cp_name#7690,cp_mfgr#7691,cp_type#7692,cp_size#7693,cp_container#7694,cp_retailprice#7695,cp_comment#7696,cp_brand#7697] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#7715 AS rid_4#7726, cpfk_part_partsupp#7716 AS cpfk_part_partsupp_4#7727, cfpk_partsupp_part#7717 AS cfpk_partsupp_part_4#7728, cpfk_supplier_partsupp#7718 AS cpfk_supplier_partsupp_4#7729, cfpk_partsupp_supplier#7719 AS cfpk_partsupp_supplier_4#7730, cval_partsupp_ps_availqty#7720 AS cval_partsupp_ps_availqty_4#7731, cval_partsupp_ps_supplycost#7721 AS cval_partsupp_ps_supplycost_4#7732, cval_partsupp_ps_comment#7722 AS cval_partsupp_ps_comment_4#7733, cps_availqty#7723 AS cps_availqty_4#7734, cps_supplycost#7724 AS cps_supplycost_4#7735, cps_comment#7725 AS cps_comment_4#7736]
            :        +- Relation[rid#7715,cpfk_part_partsupp#7716,cfpk_partsupp_part#7717,cpfk_supplier_partsupp#7718,cfpk_partsupp_supplier#7719,cval_partsupp_ps_availqty#7720,cval_partsupp_ps_supplycost#7721,cval_partsupp_ps_comment#7722,cps_availqty#7723,cps_supplycost#7724,cps_comment#7725] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#7737 AS rid_5#7754, cpfk_customer_orders#7738 AS cpfk_customer_orders_5#7755, cfpk_orders_customer#7739 AS cfpk_orders_customer_5#7756, cval_orders_o_orderstatus#7740 AS cval_orders_o_orderstatus_5#7757, cval_orders_o_totalprice#7741 AS cval_orders_o_totalprice_5#7758, cval_orders_o_orderpriority#7742 AS cval_orders_o_orderpriority_5#7759, cval_orders_o_clerk#7743 AS cval_orders_o_clerk_5#7760, cval_orders_o_shippriority#7744 AS cval_orders_o_shippriority_5#7761, cval_orders_o_comment#7745 AS cval_orders_o_comment_5#7762, cval_orders_o_orderdate#7746 AS cval_orders_o_orderdate_5#7763, co_orderstatus#7747 AS co_orderstatus_5#7764, co_totalprice#7748 AS co_totalprice_5#7765, co_orderpriority#7749 AS co_orderpriority_5#7766, co_clerk#7750 AS co_clerk_5#7767, co_shippriority#7751 AS co_shippriority_5#7768, co_comment#7752 AS co_comment_5#7769, co_orderdate#7753 AS co_orderdate_5#7770]
               +- Relation[rid#7737,cpfk_customer_orders#7738,cfpk_orders_customer#7739,cval_orders_o_orderstatus#7740,cval_orders_o_totalprice#7741,cval_orders_o_orderpriority#7742,cval_orders_o_clerk#7743,cval_orders_o_shippriority#7744,cval_orders_o_comment#7745,cval_orders_o_orderdate#7746,co_orderstatus#7747,co_totalprice#7748,co_orderpriority#7749,co_clerk#7750,co_shippriority#7751,co_comment#7752,co_orderdate#7753] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 245679ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/11 07:21:15 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:21:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7873L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:21:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:21:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7873L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#7875 AS rid_0#7880, cval_region_r_name#7876 AS cval_region_r_name_0#7881, cval_region_r_comment#7877 AS cval_region_r_comment_0#7882, cr_name#7878 AS cr_name_0#7883, cr_comment#7879 AS cr_comment_0#7884]
         :  :  :  :  :  :  :  +- Relation[rid#7875,cval_region_r_name#7876,cval_region_r_comment#7877,cr_name#7878,cr_comment#7879] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#7885 AS rid_0#7890, cval_region_r_name#7886 AS cval_region_r_name_0#7891, cval_region_r_comment#7887 AS cval_region_r_comment_0#7892, cr_name#7888 AS cr_name_0#7893, cr_comment#7889 AS cr_comment_0#7894]
         :  :  :  :  :  :        +- Relation[rid#7885,cval_region_r_name#7886,cval_region_r_comment#7887,cr_name#7888,cr_comment#7889] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :     :- Project [rid#7909 AS rid_0#7914, cval_region_r_name#7910 AS cval_region_r_name_0#7915, cval_region_r_comment#7911 AS cval_region_r_comment_0#7916, cr_name#7912 AS cr_name_0#7917, cr_comment#7913 AS cr_comment_0#7918]
         :  :  :  :  :     :  +- Relation[rid#7909,cval_region_r_name#7910,cval_region_r_comment#7911,cr_name#7912,cr_comment#7913] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :     +- Project [rid#7919 AS rid_1#7926, cpfk_region_nation#7920 AS cpfk_region_nation_1#7927, cfpk_nation_region#7921 AS cfpk_nation_region_1#7928, cval_nation_n_name#7922 AS cval_nation_n_name_1#7929, cval_nation_n_comment#7923 AS cval_nation_n_comment_1#7930, cn_name#7924 AS cn_name_1#7931, cn_comment#7925 AS cn_comment_1#7932]
         :  :  :  :  :        +- Relation[rid#7919,cpfk_region_nation#7920,cfpk_nation_region#7921,cval_nation_n_name#7922,cval_nation_n_comment#7923,cn_name#7924,cn_comment#7925] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#7895 AS rid_1#7902, cpfk_region_nation#7896 AS cpfk_region_nation_1#7903, cfpk_nation_region#7897 AS cfpk_nation_region_1#7904, cval_nation_n_name#7898 AS cval_nation_n_name_1#7905, cval_nation_n_comment#7899 AS cval_nation_n_comment_1#7906, cn_name#7900 AS cn_name_1#7907, cn_comment#7901 AS cn_comment_1#7908]
         :  :  :  :     +- Relation[rid#7895,cpfk_region_nation#7896,cfpk_nation_region#7897,cval_nation_n_name#7898,cval_nation_n_comment#7899,cn_name#7900,cn_comment#7901] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :     :- Project [rid#7959 AS rid_1#7966, cpfk_region_nation#7960 AS cpfk_region_nation_1#7967, cfpk_nation_region#7961 AS cfpk_nation_region_1#7968, cval_nation_n_name#7962 AS cval_nation_n_name_1#7969, cval_nation_n_comment#7963 AS cval_nation_n_comment_1#7970, cn_name#7964 AS cn_name_1#7971, cn_comment#7965 AS cn_comment_1#7972]
         :  :  :     :  +- Relation[rid#7959,cpfk_region_nation#7960,cfpk_nation_region#7961,cval_nation_n_name#7962,cval_nation_n_comment#7963,cn_name#7964,cn_comment#7965] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#7973 AS rid_2#7986, cpfk_nation_supplier#7974 AS cpfk_nation_supplier_2#7987, cfpk_supplier_nation#7975 AS cfpk_supplier_nation_2#7988, cval_supplier_s_name#7976 AS cval_supplier_s_name_2#7989, cval_supplier_s_address#7977 AS cval_supplier_s_address_2#7990, cval_supplier_s_phone#7978 AS cval_supplier_s_phone_2#7991, cval_supplier_s_acctbal#7979 AS cval_supplier_s_acctbal_2#7992, cval_supplier_s_comment#7980 AS cval_supplier_s_comment_2#7993, cs_name#7981 AS cs_name_2#7994, cs_address#7982 AS cs_address_2#7995, cs_phone#7983 AS cs_phone_2#7996, cs_acctbal#7984 AS cs_acctbal_2#7997, cs_comment#7985 AS cs_comment_2#7998]
         :  :  :        +- Relation[rid#7973,cpfk_nation_supplier#7974,cfpk_supplier_nation#7975,cval_supplier_s_name#7976,cval_supplier_s_address#7977,cval_supplier_s_phone#7978,cval_supplier_s_acctbal#7979,cval_supplier_s_comment#7980,cs_name#7981,cs_address#7982,cs_phone#7983,cs_acctbal#7984,cs_comment#7985] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#7933 AS rid_2#7946, cpfk_nation_supplier#7934 AS cpfk_nation_supplier_2#7947, cfpk_supplier_nation#7935 AS cfpk_supplier_nation_2#7948, cval_supplier_s_name#7936 AS cval_supplier_s_name_2#7949, cval_supplier_s_address#7937 AS cval_supplier_s_address_2#7950, cval_supplier_s_phone#7938 AS cval_supplier_s_phone_2#7951, cval_supplier_s_acctbal#7939 AS cval_supplier_s_acctbal_2#7952, cval_supplier_s_comment#7940 AS cval_supplier_s_comment_2#7953, cs_name#7941 AS cs_name_2#7954, cs_address#7942 AS cs_address_2#7955, cs_phone#7943 AS cs_phone_2#7956, cs_acctbal#7944 AS cs_acctbal_2#7957, cs_comment#7945 AS cs_comment_2#7958]
         :  :     +- Relation[rid#7933,cpfk_nation_supplier#7934,cfpk_supplier_nation#7935,cval_supplier_s_name#7936,cval_supplier_s_address#7937,cval_supplier_s_phone#7938,cval_supplier_s_acctbal#7939,cval_supplier_s_comment#7940,cs_name#7941,cs_address#7942,cs_phone#7943,cs_acctbal#7944,cs_comment#7945] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :     :- Project [rid#8145 AS rid_2#8158, cpfk_nation_supplier#8146 AS cpfk_nation_supplier_2#8159, cfpk_supplier_nation#8147 AS cfpk_supplier_nation_2#8160, cval_supplier_s_name#8148 AS cval_supplier_s_name_2#8161, cval_supplier_s_address#8149 AS cval_supplier_s_address_2#8162, cval_supplier_s_phone#8150 AS cval_supplier_s_phone_2#8163, cval_supplier_s_acctbal#8151 AS cval_supplier_s_acctbal_2#8164, cval_supplier_s_comment#8152 AS cval_supplier_s_comment_2#8165, cs_name#8153 AS cs_name_2#8166, cs_address#8154 AS cs_address_2#8167, cs_phone#8155 AS cs_phone_2#8168, cs_acctbal#8156 AS cs_acctbal_2#8169, cs_comment#8157 AS cs_comment_2#8170]
         :     :  +- Relation[rid#8145,cpfk_nation_supplier#8146,cfpk_supplier_nation#8147,cval_supplier_s_name#8148,cval_supplier_s_address#8149,cval_supplier_s_phone#8150,cval_supplier_s_acctbal#8151,cval_supplier_s_comment#8152,cs_name#8153,cs_address#8154,cs_phone#8155,cs_acctbal#8156,cs_comment#8157] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#8171 AS rid_4#8182, cpfk_part_partsupp#8172 AS cpfk_part_partsupp_4#8183, cfpk_partsupp_part#8173 AS cfpk_partsupp_part_4#8184, cpfk_supplier_partsupp#8174 AS cpfk_supplier_partsupp_4#8185, cfpk_partsupp_supplier#8175 AS cfpk_partsupp_supplier_4#8186, cval_partsupp_ps_availqty#8176 AS cval_partsupp_ps_availqty_4#8187, cval_partsupp_ps_supplycost#8177 AS cval_partsupp_ps_supplycost_4#8188, cval_partsupp_ps_comment#8178 AS cval_partsupp_ps_comment_4#8189, cps_availqty#8179 AS cps_availqty_4#8190, cps_supplycost#8180 AS cps_supplycost_4#8191, cps_comment#8181 AS cps_comment_4#8192]
         :        +- Relation[rid#8171,cpfk_part_partsupp#8172,cfpk_partsupp_part#8173,cpfk_supplier_partsupp#8174,cfpk_partsupp_supplier#8175,cval_partsupp_ps_availqty#8176,cval_partsupp_ps_supplycost#8177,cval_partsupp_ps_comment#8178,cps_availqty#8179,cps_supplycost#8180,cps_comment#8181] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'Join UsingJoin(Inner,List(rid_3))
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#7999 AS rid_3#8016, cval_part_p_name#8000 AS cval_part_p_name_3#8017, cval_part_p_mfgr#8001 AS cval_part_p_mfgr_3#8018, cval_part_p_type#8002 AS cval_part_p_type_3#8019, cval_part_p_size#8003 AS cval_part_p_size_3#8020, cval_part_p_container#8004 AS cval_part_p_container_3#8021, cval_part_p_retailprice#8005 AS cval_part_p_retailprice_3#8022, cval_part_p_comment#8006 AS cval_part_p_comment_3#8023, cval_part_p_brand#8007 AS cval_part_p_brand_3#8024, cp_name#8008 AS cp_name_3#8025, cp_mfgr#8009 AS cp_mfgr_3#8026, cp_type#8010 AS cp_type_3#8027, cp_size#8011 AS cp_size_3#8028, cp_container#8012 AS cp_container_3#8029, cp_retailprice#8013 AS cp_retailprice_3#8030, cp_comment#8014 AS cp_comment_3#8031, cp_brand#8015 AS cp_brand_3#8032]
            :  :  :  +- Relation[rid#7999,cval_part_p_name#8000,cval_part_p_mfgr#8001,cval_part_p_type#8002,cval_part_p_size#8003,cval_part_p_container#8004,cval_part_p_retailprice#8005,cval_part_p_comment#8006,cval_part_p_brand#8007,cp_name#8008,cp_mfgr#8009,cp_type#8010,cp_size#8011,cp_container#8012,cp_retailprice#8013,cp_comment#8014,cp_brand#8015] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#8033 AS rid_3#8050, cval_part_p_name#8034 AS cval_part_p_name_3#8051, cval_part_p_mfgr#8035 AS cval_part_p_mfgr_3#8052, cval_part_p_type#8036 AS cval_part_p_type_3#8053, cval_part_p_size#8037 AS cval_part_p_size_3#8054, cval_part_p_container#8038 AS cval_part_p_container_3#8055, cval_part_p_retailprice#8039 AS cval_part_p_retailprice_3#8056, cval_part_p_comment#8040 AS cval_part_p_comment_3#8057, cval_part_p_brand#8041 AS cval_part_p_brand_3#8058, cp_name#8042 AS cp_name_3#8059, cp_mfgr#8043 AS cp_mfgr_3#8060, cp_type#8044 AS cp_type_3#8061, cp_size#8045 AS cp_size_3#8062, cp_container#8046 AS cp_container_3#8063, cp_retailprice#8047 AS cp_retailprice_3#8064, cp_comment#8048 AS cp_comment_3#8065, cp_brand#8049 AS cp_brand_3#8066]
            :  :        +- Relation[rid#8033,cval_part_p_name#8034,cval_part_p_mfgr#8035,cval_part_p_type#8036,cval_part_p_size#8037,cval_part_p_container#8038,cval_part_p_retailprice#8039,cval_part_p_comment#8040,cval_part_p_brand#8041,cp_name#8042,cp_mfgr#8043,cp_type#8044,cp_size#8045,cp_container#8046,cp_retailprice#8047,cp_comment#8048,cp_brand#8049] JDBCRelation(tpart) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :     :- Project [rid#8089 AS rid_3#8106, cval_part_p_name#8090 AS cval_part_p_name_3#8107, cval_part_p_mfgr#8091 AS cval_part_p_mfgr_3#8108, cval_part_p_type#8092 AS cval_part_p_type_3#8109, cval_part_p_size#8093 AS cval_part_p_size_3#8110, cval_part_p_container#8094 AS cval_part_p_container_3#8111, cval_part_p_retailprice#8095 AS cval_part_p_retailprice_3#8112, cval_part_p_comment#8096 AS cval_part_p_comment_3#8113, cval_part_p_brand#8097 AS cval_part_p_brand_3#8114, cp_name#8098 AS cp_name_3#8115, cp_mfgr#8099 AS cp_mfgr_3#8116, cp_type#8100 AS cp_type_3#8117, cp_size#8101 AS cp_size_3#8118, cp_container#8102 AS cp_container_3#8119, cp_retailprice#8103 AS cp_retailprice_3#8120, cp_comment#8104 AS cp_comment_3#8121, cp_brand#8105 AS cp_brand_3#8122]
            :     :  +- Relation[rid#8089,cval_part_p_name#8090,cval_part_p_mfgr#8091,cval_part_p_type#8092,cval_part_p_size#8093,cval_part_p_container#8094,cval_part_p_retailprice#8095,cval_part_p_comment#8096,cval_part_p_brand#8097,cp_name#8098,cp_mfgr#8099,cp_type#8100,cp_size#8101,cp_container#8102,cp_retailprice#8103,cp_comment#8104,cp_brand#8105] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#8123 AS rid_4#8134, cpfk_part_partsupp#8124 AS cpfk_part_partsupp_4#8135, cfpk_partsupp_part#8125 AS cfpk_partsupp_part_4#8136, cpfk_supplier_partsupp#8126 AS cpfk_supplier_partsupp_4#8137, cfpk_partsupp_supplier#8127 AS cfpk_partsupp_supplier_4#8138, cval_partsupp_ps_availqty#8128 AS cval_partsupp_ps_availqty_4#8139, cval_partsupp_ps_supplycost#8129 AS cval_partsupp_ps_supplycost_4#8140, cval_partsupp_ps_comment#8130 AS cval_partsupp_ps_comment_4#8141, cps_availqty#8131 AS cps_availqty_4#8142, cps_supplycost#8132 AS cps_supplycost_4#8143, cps_comment#8133 AS cps_comment_4#8144]
            :        +- Relation[rid#8123,cpfk_part_partsupp#8124,cfpk_partsupp_part#8125,cpfk_supplier_partsupp#8126,cfpk_partsupp_supplier#8127,cval_partsupp_ps_availqty#8128,cval_partsupp_ps_supplycost#8129,cval_partsupp_ps_comment#8130,cps_availqty#8131,cps_supplycost#8132,cps_comment#8133] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#8067 AS rid_4#8078, cpfk_part_partsupp#8068 AS cpfk_part_partsupp_4#8079, cfpk_partsupp_part#8069 AS cfpk_partsupp_part_4#8080, cpfk_supplier_partsupp#8070 AS cpfk_supplier_partsupp_4#8081, cfpk_partsupp_supplier#8071 AS cfpk_partsupp_supplier_4#8082, cval_partsupp_ps_availqty#8072 AS cval_partsupp_ps_availqty_4#8083, cval_partsupp_ps_supplycost#8073 AS cval_partsupp_ps_supplycost_4#8084, cval_partsupp_ps_comment#8074 AS cval_partsupp_ps_comment_4#8085, cps_availqty#8075 AS cps_availqty_4#8086, cps_supplycost#8076 AS cps_supplycost_4#8087, cps_comment#8077 AS cps_comment_4#8088]
               +- Relation[rid#8067,cpfk_part_partsupp#8068,cfpk_partsupp_part#8069,cpfk_supplier_partsupp#8070,cfpk_partsupp_supplier#8071,cval_partsupp_ps_availqty#8072,cval_partsupp_ps_supplycost#8073,cval_partsupp_ps_comment#8074,cps_availqty#8075,cps_supplycost#8076,cps_comment#8077] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 20601ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/11 07:21:35 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:21:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8254L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 07:21:35 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 07:21:35 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 07:21:35 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 07:21:35 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 07:21:35 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 07:21:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8254L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#8256 AS rid_0#8271, cpfk_nation_customer#8257 AS cpfk_nation_customer_0#8272, cfpk_customer_nation#8258 AS cfpk_customer_nation_0#8273, cval_customer_c_name#8259 AS cval_customer_c_name_0#8274, cval_customer_c_address#8260 AS cval_customer_c_address_0#8275, cval_customer_c_phone#8261 AS cval_customer_c_phone_0#8276, cval_customer_c_acctbal#8262 AS cval_customer_c_acctbal_0#8277, cval_customer_c_comment#8263 AS cval_customer_c_comment_0#8278, cval_customer_c_mktsegment#8264 AS cval_customer_c_mktsegment_0#8279, cc_name#8265 AS cc_name_0#8280, cc_address#8266 AS cc_address_0#8281, cc_phone#8267 AS cc_phone_0#8282, cc_acctbal#8268 AS cc_acctbal_0#8283, cc_comment#8269 AS cc_comment_0#8284, cc_mktsegment#8270 AS cc_mktsegment_0#8285]
         :  :  :  :  :  +- Relation[rid#8256,cpfk_nation_customer#8257,cfpk_customer_nation#8258,cval_customer_c_name#8259,cval_customer_c_address#8260,cval_customer_c_phone#8261,cval_customer_c_acctbal#8262,cval_customer_c_comment#8263,cval_customer_c_mktsegment#8264,cc_name#8265,cc_address#8266,cc_phone#8267,cc_acctbal#8268,cc_comment#8269,cc_mktsegment#8270] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#8286 AS rid_0#8301, cpfk_nation_customer#8287 AS cpfk_nation_customer_0#8302, cfpk_customer_nation#8288 AS cfpk_customer_nation_0#8303, cval_customer_c_name#8289 AS cval_customer_c_name_0#8304, cval_customer_c_address#8290 AS cval_customer_c_address_0#8305, cval_customer_c_phone#8291 AS cval_customer_c_phone_0#8306, cval_customer_c_acctbal#8292 AS cval_customer_c_acctbal_0#8307, cval_customer_c_comment#8293 AS cval_customer_c_comment_0#8308, cval_customer_c_mktsegment#8294 AS cval_customer_c_mktsegment_0#8309, cc_name#8295 AS cc_name_0#8310, cc_address#8296 AS cc_address_0#8311, cc_phone#8297 AS cc_phone_0#8312, cc_acctbal#8298 AS cc_acctbal_0#8313, cc_comment#8299 AS cc_comment_0#8314, cc_mktsegment#8300 AS cc_mktsegment_0#8315]
         :  :  :  :        +- Relation[rid#8286,cpfk_nation_customer#8287,cfpk_customer_nation#8288,cval_customer_c_name#8289,cval_customer_c_address#8290,cval_customer_c_phone#8291,cval_customer_c_acctbal#8292,cval_customer_c_comment#8293,cval_customer_c_mktsegment#8294,cc_name#8295,cc_address#8296,cc_phone#8297,cc_acctbal#8298,cc_comment#8299,cc_mktsegment#8300] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#8350 AS rid_0#8365, cpfk_nation_customer#8351 AS cpfk_nation_customer_0#8366, cfpk_customer_nation#8352 AS cfpk_customer_nation_0#8367, cval_customer_c_name#8353 AS cval_customer_c_name_0#8368, cval_customer_c_address#8354 AS cval_customer_c_address_0#8369, cval_customer_c_phone#8355 AS cval_customer_c_phone_0#8370, cval_customer_c_acctbal#8356 AS cval_customer_c_acctbal_0#8371, cval_customer_c_comment#8357 AS cval_customer_c_comment_0#8372, cval_customer_c_mktsegment#8358 AS cval_customer_c_mktsegment_0#8373, cc_name#8359 AS cc_name_0#8374, cc_address#8360 AS cc_address_0#8375, cc_phone#8361 AS cc_phone_0#8376, cc_acctbal#8362 AS cc_acctbal_0#8377, cc_comment#8363 AS cc_comment_0#8378, cc_mktsegment#8364 AS cc_mktsegment_0#8379]
         :  :  :     :  +- Relation[rid#8350,cpfk_nation_customer#8351,cfpk_customer_nation#8352,cval_customer_c_name#8353,cval_customer_c_address#8354,cval_customer_c_phone#8355,cval_customer_c_acctbal#8356,cval_customer_c_comment#8357,cval_customer_c_mktsegment#8358,cc_name#8359,cc_address#8360,cc_phone#8361,cc_acctbal#8362,cc_comment#8363,cc_mktsegment#8364] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#8380 AS rid_1#8397, cpfk_customer_orders#8381 AS cpfk_customer_orders_1#8398, cfpk_orders_customer#8382 AS cfpk_orders_customer_1#8399, cval_orders_o_orderstatus#8383 AS cval_orders_o_orderstatus_1#8400, cval_orders_o_totalprice#8384 AS cval_orders_o_totalprice_1#8401, cval_orders_o_orderpriority#8385 AS cval_orders_o_orderpriority_1#8402, cval_orders_o_clerk#8386 AS cval_orders_o_clerk_1#8403, cval_orders_o_shippriority#8387 AS cval_orders_o_shippriority_1#8404, cval_orders_o_comment#8388 AS cval_orders_o_comment_1#8405, cval_orders_o_orderdate#8389 AS cval_orders_o_orderdate_1#8406, co_orderstatus#8390 AS co_orderstatus_1#8407, co_totalprice#8391 AS co_totalprice_1#8408, co_orderpriority#8392 AS co_orderpriority_1#8409, co_clerk#8393 AS co_clerk_1#8410, co_shippriority#8394 AS co_shippriority_1#8411, co_comment#8395 AS co_comment_1#8412, co_orderdate#8396 AS co_orderdate_1#8413]
         :  :  :        +- Relation[rid#8380,cpfk_customer_orders#8381,cfpk_orders_customer#8382,cval_orders_o_orderstatus#8383,cval_orders_o_totalprice#8384,cval_orders_o_orderpriority#8385,cval_orders_o_clerk#8386,cval_orders_o_shippriority#8387,cval_orders_o_comment#8388,cval_orders_o_orderdate#8389,co_orderstatus#8390,co_totalprice#8391,co_orderpriority#8392,co_clerk#8393,co_shippriority#8394,co_comment#8395,co_orderdate#8396] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#8316 AS rid_1#8333, cpfk_customer_orders#8317 AS cpfk_customer_orders_1#8334, cfpk_orders_customer#8318 AS cfpk_orders_customer_1#8335, cval_orders_o_orderstatus#8319 AS cval_orders_o_orderstatus_1#8336, cval_orders_o_totalprice#8320 AS cval_orders_o_totalprice_1#8337, cval_orders_o_orderpriority#8321 AS cval_orders_o_orderpriority_1#8338, cval_orders_o_clerk#8322 AS cval_orders_o_clerk_1#8339, cval_orders_o_shippriority#8323 AS cval_orders_o_shippriority_1#8340, cval_orders_o_comment#8324 AS cval_orders_o_comment_1#8341, cval_orders_o_orderdate#8325 AS cval_orders_o_orderdate_1#8342, co_orderstatus#8326 AS co_orderstatus_1#8343, co_totalprice#8327 AS co_totalprice_1#8344, co_orderpriority#8328 AS co_orderpriority_1#8345, co_clerk#8329 AS co_clerk_1#8346, co_shippriority#8330 AS co_shippriority_1#8347, co_comment#8331 AS co_comment_1#8348, co_orderdate#8332 AS co_orderdate_1#8349]
         :  :     +- Relation[rid#8316,cpfk_customer_orders#8317,cfpk_orders_customer#8318,cval_orders_o_orderstatus#8319,cval_orders_o_totalprice#8320,cval_orders_o_orderpriority#8321,cval_orders_o_clerk#8322,cval_orders_o_shippriority#8323,cval_orders_o_comment#8324,cval_orders_o_orderdate#8325,co_orderstatus#8326,co_totalprice#8327,co_orderpriority#8328,co_clerk#8329,co_shippriority#8330,co_comment#8331,co_orderdate#8332] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#8480 AS rid_1#8497, cpfk_customer_orders#8481 AS cpfk_customer_orders_1#8498, cfpk_orders_customer#8482 AS cfpk_orders_customer_1#8499, cval_orders_o_orderstatus#8483 AS cval_orders_o_orderstatus_1#8500, cval_orders_o_totalprice#8484 AS cval_orders_o_totalprice_1#8501, cval_orders_o_orderpriority#8485 AS cval_orders_o_orderpriority_1#8502, cval_orders_o_clerk#8486 AS cval_orders_o_clerk_1#8503, cval_orders_o_shippriority#8487 AS cval_orders_o_shippriority_1#8504, cval_orders_o_comment#8488 AS cval_orders_o_comment_1#8505, cval_orders_o_orderdate#8489 AS cval_orders_o_orderdate_1#8506, co_orderstatus#8490 AS co_orderstatus_1#8507, co_totalprice#8491 AS co_totalprice_1#8508, co_orderpriority#8492 AS co_orderpriority_1#8509, co_clerk#8493 AS co_clerk_1#8510, co_shippriority#8494 AS co_shippriority_1#8511, co_comment#8495 AS co_comment_1#8512, co_orderdate#8496 AS co_orderdate_1#8513]
         :     :  +- Relation[rid#8480,cpfk_customer_orders#8481,cfpk_orders_customer#8482,cval_orders_o_orderstatus#8483,cval_orders_o_totalprice#8484,cval_orders_o_orderpriority#8485,cval_orders_o_clerk#8486,cval_orders_o_shippriority#8487,cval_orders_o_comment#8488,cval_orders_o_orderdate#8489,co_orderstatus#8490,co_totalprice#8491,co_orderpriority#8492,co_clerk#8493,co_shippriority#8494,co_comment#8495,co_orderdate#8496] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#8514 AS rid_2#8547, cpfk_orders_lineitem#8515 AS cpfk_orders_lineitem_2#8548, cpfk_supplier_lineitem#8516 AS cpfk_supplier_lineitem_2#8549, cfpk_lineitem_supplier#8517 AS cfpk_lineitem_supplier_2#8550, cfpk_lineitem_partsupp#8518 AS cfpk_lineitem_partsupp_2#8551, cpfk_part_lineitem#8519 AS cpfk_part_lineitem_2#8552, cfpk_lineitem_part#8520 AS cfpk_lineitem_part_2#8553, cpfk_partsupp_lineitem#8521 AS cpfk_partsupp_lineitem_2#8554, cfpk_lineitem_orders#8522 AS cfpk_lineitem_orders_2#8555, cval_lineitem_l_quantity#8523 AS cval_lineitem_l_quantity_2#8556, cval_lineitem_l_extendedprice#8524 AS cval_lineitem_l_extendedprice_2#8557, cval_lineitem_l_discount#8525 AS cval_lineitem_l_discount_2#8558, cval_lineitem_l_tax#8526 AS cval_lineitem_l_tax_2#8559, cval_lineitem_l_returnflag#8527 AS cval_lineitem_l_returnflag_2#8560, cval_lineitem_l_linestatus#8528 AS cval_lineitem_l_linestatus_2#8561, cval_lineitem_l_commitdate#8529 AS cval_lineitem_l_commitdate_2#8562, cval_lineitem_l_receiptdate#8530 AS cval_lineitem_l_receiptdate_2#8563, cval_lineitem_l_shipinstruct#8531 AS cval_lineitem_l_shipinstruct_2#8564, cval_lineitem_l_shipmode#8532 AS cval_lineitem_l_shipmode_2#8565, cval_lineitem_l_comment#8533 AS cval_lineitem_l_comment_2#8566, cval_lineitem_l_shipdate#8534 AS cval_lineitem_l_shipdate_2#8567, cl_quantity#8535 AS cl_quantity_2#8568, cl_extendedprice#8536 AS cl_extendedprice_2#8569, cl_discount#8537 AS cl_discount_2#8570, ... 9 more fields]
         :        +- Relation[rid#8514,cpfk_orders_lineitem#8515,cpfk_supplier_lineitem#8516,cfpk_lineitem_supplier#8517,cfpk_lineitem_partsupp#8518,cpfk_part_lineitem#8519,cfpk_lineitem_part#8520,cpfk_partsupp_lineitem#8521,cfpk_lineitem_orders#8522,cval_lineitem_l_quantity#8523,cval_lineitem_l_extendedprice#8524,cval_lineitem_l_discount#8525,cval_lineitem_l_tax#8526,cval_lineitem_l_returnflag#8527,cval_lineitem_l_linestatus#8528,cval_lineitem_l_commitdate#8529,cval_lineitem_l_receiptdate#8530,cval_lineitem_l_shipinstruct#8531,cval_lineitem_l_shipmode#8532,cval_lineitem_l_comment#8533,cval_lineitem_l_shipdate#8534,cl_quantity#8535,cl_extendedprice#8536,cl_discount#8537,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8414 AS rid_2#8447, cpfk_orders_lineitem#8415 AS cpfk_orders_lineitem_2#8448, cpfk_supplier_lineitem#8416 AS cpfk_supplier_lineitem_2#8449, cfpk_lineitem_supplier#8417 AS cfpk_lineitem_supplier_2#8450, cfpk_lineitem_partsupp#8418 AS cfpk_lineitem_partsupp_2#8451, cpfk_part_lineitem#8419 AS cpfk_part_lineitem_2#8452, cfpk_lineitem_part#8420 AS cfpk_lineitem_part_2#8453, cpfk_partsupp_lineitem#8421 AS cpfk_partsupp_lineitem_2#8454, cfpk_lineitem_orders#8422 AS cfpk_lineitem_orders_2#8455, cval_lineitem_l_quantity#8423 AS cval_lineitem_l_quantity_2#8456, cval_lineitem_l_extendedprice#8424 AS cval_lineitem_l_extendedprice_2#8457, cval_lineitem_l_discount#8425 AS cval_lineitem_l_discount_2#8458, cval_lineitem_l_tax#8426 AS cval_lineitem_l_tax_2#8459, cval_lineitem_l_returnflag#8427 AS cval_lineitem_l_returnflag_2#8460, cval_lineitem_l_linestatus#8428 AS cval_lineitem_l_linestatus_2#8461, cval_lineitem_l_commitdate#8429 AS cval_lineitem_l_commitdate_2#8462, cval_lineitem_l_receiptdate#8430 AS cval_lineitem_l_receiptdate_2#8463, cval_lineitem_l_shipinstruct#8431 AS cval_lineitem_l_shipinstruct_2#8464, cval_lineitem_l_shipmode#8432 AS cval_lineitem_l_shipmode_2#8465, cval_lineitem_l_comment#8433 AS cval_lineitem_l_comment_2#8466, cval_lineitem_l_shipdate#8434 AS cval_lineitem_l_shipdate_2#8467, cl_quantity#8435 AS cl_quantity_2#8468, cl_extendedprice#8436 AS cl_extendedprice_2#8469, cl_discount#8437 AS cl_discount_2#8470, ... 9 more fields]
            +- Relation[rid#8414,cpfk_orders_lineitem#8415,cpfk_supplier_lineitem#8416,cfpk_lineitem_supplier#8417,cfpk_lineitem_partsupp#8418,cpfk_part_lineitem#8419,cfpk_lineitem_part#8420,cpfk_partsupp_lineitem#8421,cfpk_lineitem_orders#8422,cval_lineitem_l_quantity#8423,cval_lineitem_l_extendedprice#8424,cval_lineitem_l_discount#8425,cval_lineitem_l_tax#8426,cval_lineitem_l_returnflag#8427,cval_lineitem_l_linestatus#8428,cval_lineitem_l_commitdate#8429,cval_lineitem_l_receiptdate#8430,cval_lineitem_l_shipinstruct#8431,cval_lineitem_l_shipmode#8432,cval_lineitem_l_comment#8433,cval_lineitem_l_shipdate#8434,cl_quantity#8435,cl_extendedprice#8436,cl_discount#8437,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 115396ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/11 07:23:31 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:23:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8650L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 07:23:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:23:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:23:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:23:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:23:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:23:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:23:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:23:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:23:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:23:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:23:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:23:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:23:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:23:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8650L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#8652 AS rid_0#8669, cval_part_p_name#8653 AS cval_part_p_name_0#8670, cval_part_p_mfgr#8654 AS cval_part_p_mfgr_0#8671, cval_part_p_type#8655 AS cval_part_p_type_0#8672, cval_part_p_size#8656 AS cval_part_p_size_0#8673, cval_part_p_container#8657 AS cval_part_p_container_0#8674, cval_part_p_retailprice#8658 AS cval_part_p_retailprice_0#8675, cval_part_p_comment#8659 AS cval_part_p_comment_0#8676, cval_part_p_brand#8660 AS cval_part_p_brand_0#8677, cp_name#8661 AS cp_name_0#8678, cp_mfgr#8662 AS cp_mfgr_0#8679, cp_type#8663 AS cp_type_0#8680, cp_size#8664 AS cp_size_0#8681, cp_container#8665 AS cp_container_0#8682, cp_retailprice#8666 AS cp_retailprice_0#8683, cp_comment#8667 AS cp_comment_0#8684, cp_brand#8668 AS cp_brand_0#8685]
            :  :  :  :  +- Relation[rid#8652,cval_part_p_name#8653,cval_part_p_mfgr#8654,cval_part_p_type#8655,cval_part_p_size#8656,cval_part_p_container#8657,cval_part_p_retailprice#8658,cval_part_p_comment#8659,cval_part_p_brand#8660,cp_name#8661,cp_mfgr#8662,cp_type#8663,cp_size#8664,cp_container#8665,cp_retailprice#8666,cp_comment#8667,cp_brand#8668] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#8686 AS rid_0#8703, cval_part_p_name#8687 AS cval_part_p_name_0#8704, cval_part_p_mfgr#8688 AS cval_part_p_mfgr_0#8705, cval_part_p_type#8689 AS cval_part_p_type_0#8706, cval_part_p_size#8690 AS cval_part_p_size_0#8707, cval_part_p_container#8691 AS cval_part_p_container_0#8708, cval_part_p_retailprice#8692 AS cval_part_p_retailprice_0#8709, cval_part_p_comment#8693 AS cval_part_p_comment_0#8710, cval_part_p_brand#8694 AS cval_part_p_brand_0#8711, cp_name#8695 AS cp_name_0#8712, cp_mfgr#8696 AS cp_mfgr_0#8713, cp_type#8697 AS cp_type_0#8714, cp_size#8698 AS cp_size_0#8715, cp_container#8699 AS cp_container_0#8716, cp_retailprice#8700 AS cp_retailprice_0#8717, cp_comment#8701 AS cp_comment_0#8718, cp_brand#8702 AS cp_brand_0#8719]
            :  :  :        +- Relation[rid#8686,cval_part_p_name#8687,cval_part_p_mfgr#8688,cval_part_p_type#8689,cval_part_p_size#8690,cval_part_p_container#8691,cval_part_p_retailprice#8692,cval_part_p_comment#8693,cval_part_p_brand#8694,cp_name#8695,cp_mfgr#8696,cp_type#8697,cp_size#8698,cp_container#8699,cp_retailprice#8700,cp_comment#8701,cp_brand#8702] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :     :- Project [rid#8742 AS rid_0#8759, cval_part_p_name#8743 AS cval_part_p_name_0#8760, cval_part_p_mfgr#8744 AS cval_part_p_mfgr_0#8761, cval_part_p_type#8745 AS cval_part_p_type_0#8762, cval_part_p_size#8746 AS cval_part_p_size_0#8763, cval_part_p_container#8747 AS cval_part_p_container_0#8764, cval_part_p_retailprice#8748 AS cval_part_p_retailprice_0#8765, cval_part_p_comment#8749 AS cval_part_p_comment_0#8766, cval_part_p_brand#8750 AS cval_part_p_brand_0#8767, cp_name#8751 AS cp_name_0#8768, cp_mfgr#8752 AS cp_mfgr_0#8769, cp_type#8753 AS cp_type_0#8770, cp_size#8754 AS cp_size_0#8771, cp_container#8755 AS cp_container_0#8772, cp_retailprice#8756 AS cp_retailprice_0#8773, cp_comment#8757 AS cp_comment_0#8774, cp_brand#8758 AS cp_brand_0#8775]
            :  :     :  +- Relation[rid#8742,cval_part_p_name#8743,cval_part_p_mfgr#8744,cval_part_p_type#8745,cval_part_p_size#8746,cval_part_p_container#8747,cval_part_p_retailprice#8748,cval_part_p_comment#8749,cval_part_p_brand#8750,cp_name#8751,cp_mfgr#8752,cp_type#8753,cp_size#8754,cp_container#8755,cp_retailprice#8756,cp_comment#8757,cp_brand#8758] JDBCRelation(tpart) [numPartitions=1]
            :  :     +- Project [rid#8776 AS rid_1#8787, cpfk_part_partsupp#8777 AS cpfk_part_partsupp_1#8788, cfpk_partsupp_part#8778 AS cfpk_partsupp_part_1#8789, cpfk_supplier_partsupp#8779 AS cpfk_supplier_partsupp_1#8790, cfpk_partsupp_supplier#8780 AS cfpk_partsupp_supplier_1#8791, cval_partsupp_ps_availqty#8781 AS cval_partsupp_ps_availqty_1#8792, cval_partsupp_ps_supplycost#8782 AS cval_partsupp_ps_supplycost_1#8793, cval_partsupp_ps_comment#8783 AS cval_partsupp_ps_comment_1#8794, cps_availqty#8784 AS cps_availqty_1#8795, cps_supplycost#8785 AS cps_supplycost_1#8796, cps_comment#8786 AS cps_comment_1#8797]
            :  :        +- Relation[rid#8776,cpfk_part_partsupp#8777,cfpk_partsupp_part#8778,cpfk_supplier_partsupp#8779,cfpk_partsupp_supplier#8780,cval_partsupp_ps_availqty#8781,cval_partsupp_ps_supplycost#8782,cval_partsupp_ps_comment#8783,cps_availqty#8784,cps_supplycost#8785,cps_comment#8786] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#8720 AS rid_1#8731, cpfk_part_partsupp#8721 AS cpfk_part_partsupp_1#8732, cfpk_partsupp_part#8722 AS cfpk_partsupp_part_1#8733, cpfk_supplier_partsupp#8723 AS cpfk_supplier_partsupp_1#8734, cfpk_partsupp_supplier#8724 AS cfpk_partsupp_supplier_1#8735, cval_partsupp_ps_availqty#8725 AS cval_partsupp_ps_availqty_1#8736, cval_partsupp_ps_supplycost#8726 AS cval_partsupp_ps_supplycost_1#8737, cval_partsupp_ps_comment#8727 AS cval_partsupp_ps_comment_1#8738, cps_availqty#8728 AS cps_availqty_1#8739, cps_supplycost#8729 AS cps_supplycost_1#8740, cps_comment#8730 AS cps_comment_1#8741]
            :     +- Relation[rid#8720,cpfk_part_partsupp#8721,cfpk_partsupp_part#8722,cpfk_supplier_partsupp#8723,cfpk_partsupp_supplier#8724,cval_partsupp_ps_availqty#8725,cval_partsupp_ps_supplycost#8726,cval_partsupp_ps_comment#8727,cps_availqty#8728,cps_supplycost#8729,cps_comment#8730] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#8798 AS rid_2#8805, cpfk_region_nation#8799 AS cpfk_region_nation_2#8806, cfpk_nation_region#8800 AS cfpk_nation_region_2#8807, cval_nation_n_name#8801 AS cval_nation_n_name_2#8808, cval_nation_n_comment#8802 AS cval_nation_n_comment_2#8809, cn_name#8803 AS cn_name_2#8810, cn_comment#8804 AS cn_comment_2#8811]
               :  :  :  +- Relation[rid#8798,cpfk_region_nation#8799,cfpk_nation_region#8800,cval_nation_n_name#8801,cval_nation_n_comment#8802,cn_name#8803,cn_comment#8804] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#8812 AS rid_2#8819, cpfk_region_nation#8813 AS cpfk_region_nation_2#8820, cfpk_nation_region#8814 AS cfpk_nation_region_2#8821, cval_nation_n_name#8815 AS cval_nation_n_name_2#8822, cval_nation_n_comment#8816 AS cval_nation_n_comment_2#8823, cn_name#8817 AS cn_name_2#8824, cn_comment#8818 AS cn_comment_2#8825]
               :  :        +- Relation[rid#8812,cpfk_region_nation#8813,cfpk_nation_region#8814,cval_nation_n_name#8815,cval_nation_n_comment#8816,cn_name#8817,cn_comment#8818] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :     :- Project [rid#8852 AS rid_2#8859, cpfk_region_nation#8853 AS cpfk_region_nation_2#8860, cfpk_nation_region#8854 AS cfpk_nation_region_2#8861, cval_nation_n_name#8855 AS cval_nation_n_name_2#8862, cval_nation_n_comment#8856 AS cval_nation_n_comment_2#8863, cn_name#8857 AS cn_name_2#8864, cn_comment#8858 AS cn_comment_2#8865]
               :     :  +- Relation[rid#8852,cpfk_region_nation#8853,cfpk_nation_region#8854,cval_nation_n_name#8855,cval_nation_n_comment#8856,cn_name#8857,cn_comment#8858] JDBCRelation(tnation) [numPartitions=1]
               :     +- Project [rid#8866 AS rid_3#8879, cpfk_nation_supplier#8867 AS cpfk_nation_supplier_3#8880, cfpk_supplier_nation#8868 AS cfpk_supplier_nation_3#8881, cval_supplier_s_name#8869 AS cval_supplier_s_name_3#8882, cval_supplier_s_address#8870 AS cval_supplier_s_address_3#8883, cval_supplier_s_phone#8871 AS cval_supplier_s_phone_3#8884, cval_supplier_s_acctbal#8872 AS cval_supplier_s_acctbal_3#8885, cval_supplier_s_comment#8873 AS cval_supplier_s_comment_3#8886, cs_name#8874 AS cs_name_3#8887, cs_address#8875 AS cs_address_3#8888, cs_phone#8876 AS cs_phone_3#8889, cs_acctbal#8877 AS cs_acctbal_3#8890, cs_comment#8878 AS cs_comment_3#8891]
               :        +- Relation[rid#8866,cpfk_nation_supplier#8867,cfpk_supplier_nation#8868,cval_supplier_s_name#8869,cval_supplier_s_address#8870,cval_supplier_s_phone#8871,cval_supplier_s_acctbal#8872,cval_supplier_s_comment#8873,cs_name#8874,cs_address#8875,cs_phone#8876,cs_acctbal#8877,cs_comment#8878] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#8826 AS rid_3#8839, cpfk_nation_supplier#8827 AS cpfk_nation_supplier_3#8840, cfpk_supplier_nation#8828 AS cfpk_supplier_nation_3#8841, cval_supplier_s_name#8829 AS cval_supplier_s_name_3#8842, cval_supplier_s_address#8830 AS cval_supplier_s_address_3#8843, cval_supplier_s_phone#8831 AS cval_supplier_s_phone_3#8844, cval_supplier_s_acctbal#8832 AS cval_supplier_s_acctbal_3#8845, cval_supplier_s_comment#8833 AS cval_supplier_s_comment_3#8846, cs_name#8834 AS cs_name_3#8847, cs_address#8835 AS cs_address_3#8848, cs_phone#8836 AS cs_phone_3#8849, cs_acctbal#8837 AS cs_acctbal_3#8850, cs_comment#8838 AS cs_comment_3#8851]
                  +- Relation[rid#8826,cpfk_nation_supplier#8827,cfpk_supplier_nation#8828,cval_supplier_s_name#8829,cval_supplier_s_address#8830,cval_supplier_s_phone#8831,cval_supplier_s_acctbal#8832,cval_supplier_s_comment#8833,cs_name#8834,cs_address#8835,cs_phone#8836,cs_acctbal#8837,cs_comment#8838] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 11330ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/11 07:23:42 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:23:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8945L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 07:23:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#8945L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#8947 AS rid_0#8980, cpfk_orders_lineitem#8948 AS cpfk_orders_lineitem_0#8981, cpfk_supplier_lineitem#8949 AS cpfk_supplier_lineitem_0#8982, cfpk_lineitem_supplier#8950 AS cfpk_lineitem_supplier_0#8983, cfpk_lineitem_partsupp#8951 AS cfpk_lineitem_partsupp_0#8984, cpfk_part_lineitem#8952 AS cpfk_part_lineitem_0#8985, cfpk_lineitem_part#8953 AS cfpk_lineitem_part_0#8986, cpfk_partsupp_lineitem#8954 AS cpfk_partsupp_lineitem_0#8987, cfpk_lineitem_orders#8955 AS cfpk_lineitem_orders_0#8988, cval_lineitem_l_quantity#8956 AS cval_lineitem_l_quantity_0#8989, cval_lineitem_l_extendedprice#8957 AS cval_lineitem_l_extendedprice_0#8990, cval_lineitem_l_discount#8958 AS cval_lineitem_l_discount_0#8991, cval_lineitem_l_tax#8959 AS cval_lineitem_l_tax_0#8992, cval_lineitem_l_returnflag#8960 AS cval_lineitem_l_returnflag_0#8993, cval_lineitem_l_linestatus#8961 AS cval_lineitem_l_linestatus_0#8994, cval_lineitem_l_commitdate#8962 AS cval_lineitem_l_commitdate_0#8995, cval_lineitem_l_receiptdate#8963 AS cval_lineitem_l_receiptdate_0#8996, cval_lineitem_l_shipinstruct#8964 AS cval_lineitem_l_shipinstruct_0#8997, cval_lineitem_l_shipmode#8965 AS cval_lineitem_l_shipmode_0#8998, cval_lineitem_l_comment#8966 AS cval_lineitem_l_comment_0#8999, cval_lineitem_l_shipdate#8967 AS cval_lineitem_l_shipdate_0#9000, cl_quantity#8968 AS cl_quantity_0#9001, cl_extendedprice#8969 AS cl_extendedprice_0#9002, cl_discount#8970 AS cl_discount_0#9003, ... 9 more fields]
         +- Relation[rid#8947,cpfk_orders_lineitem#8948,cpfk_supplier_lineitem#8949,cfpk_lineitem_supplier#8950,cfpk_lineitem_partsupp#8951,cpfk_part_lineitem#8952,cfpk_lineitem_part#8953,cpfk_partsupp_lineitem#8954,cfpk_lineitem_orders#8955,cval_lineitem_l_quantity#8956,cval_lineitem_l_extendedprice#8957,cval_lineitem_l_discount#8958,cval_lineitem_l_tax#8959,cval_lineitem_l_returnflag#8960,cval_lineitem_l_linestatus#8961,cval_lineitem_l_commitdate#8962,cval_lineitem_l_receiptdate#8963,cval_lineitem_l_shipinstruct#8964,cval_lineitem_l_shipmode#8965,cval_lineitem_l_comment#8966,cval_lineitem_l_shipdate#8967,cl_quantity#8968,cl_extendedprice#8969,cl_discount#8970,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2966ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/11 07:23:45 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:23:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9055L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 07:23:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9055L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#9057 AS rid_0#9072, cpfk_nation_customer#9058 AS cpfk_nation_customer_0#9073, cfpk_customer_nation#9059 AS cfpk_customer_nation_0#9074, cval_customer_c_name#9060 AS cval_customer_c_name_0#9075, cval_customer_c_address#9061 AS cval_customer_c_address_0#9076, cval_customer_c_phone#9062 AS cval_customer_c_phone_0#9077, cval_customer_c_acctbal#9063 AS cval_customer_c_acctbal_0#9078, cval_customer_c_comment#9064 AS cval_customer_c_comment_0#9079, cval_customer_c_mktsegment#9065 AS cval_customer_c_mktsegment_0#9080, cc_name#9066 AS cc_name_0#9081, cc_address#9067 AS cc_address_0#9082, cc_phone#9068 AS cc_phone_0#9083, cc_acctbal#9069 AS cc_acctbal_0#9084, cc_comment#9070 AS cc_comment_0#9085, cc_mktsegment#9071 AS cc_mktsegment_0#9086]
         :  :  :  :  +- Relation[rid#9057,cpfk_nation_customer#9058,cfpk_customer_nation#9059,cval_customer_c_name#9060,cval_customer_c_address#9061,cval_customer_c_phone#9062,cval_customer_c_acctbal#9063,cval_customer_c_comment#9064,cval_customer_c_mktsegment#9065,cc_name#9066,cc_address#9067,cc_phone#9068,cc_acctbal#9069,cc_comment#9070,cc_mktsegment#9071] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#9121 AS rid_0#9136, cpfk_nation_customer#9122 AS cpfk_nation_customer_0#9137, cfpk_customer_nation#9123 AS cfpk_customer_nation_0#9138, cval_customer_c_name#9124 AS cval_customer_c_name_0#9139, cval_customer_c_address#9125 AS cval_customer_c_address_0#9140, cval_customer_c_phone#9126 AS cval_customer_c_phone_0#9141, cval_customer_c_acctbal#9127 AS cval_customer_c_acctbal_0#9142, cval_customer_c_comment#9128 AS cval_customer_c_comment_0#9143, cval_customer_c_mktsegment#9129 AS cval_customer_c_mktsegment_0#9144, cc_name#9130 AS cc_name_0#9145, cc_address#9131 AS cc_address_0#9146, cc_phone#9132 AS cc_phone_0#9147, cc_acctbal#9133 AS cc_acctbal_0#9148, cc_comment#9134 AS cc_comment_0#9149, cc_mktsegment#9135 AS cc_mktsegment_0#9150]
         :  :  :     :  +- Relation[rid#9121,cpfk_nation_customer#9122,cfpk_customer_nation#9123,cval_customer_c_name#9124,cval_customer_c_address#9125,cval_customer_c_phone#9126,cval_customer_c_acctbal#9127,cval_customer_c_comment#9128,cval_customer_c_mktsegment#9129,cc_name#9130,cc_address#9131,cc_phone#9132,cc_acctbal#9133,cc_comment#9134,cc_mktsegment#9135] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#9151 AS rid_1#9168, cpfk_customer_orders#9152 AS cpfk_customer_orders_1#9169, cfpk_orders_customer#9153 AS cfpk_orders_customer_1#9170, cval_orders_o_orderstatus#9154 AS cval_orders_o_orderstatus_1#9171, cval_orders_o_totalprice#9155 AS cval_orders_o_totalprice_1#9172, cval_orders_o_orderpriority#9156 AS cval_orders_o_orderpriority_1#9173, cval_orders_o_clerk#9157 AS cval_orders_o_clerk_1#9174, cval_orders_o_shippriority#9158 AS cval_orders_o_shippriority_1#9175, cval_orders_o_comment#9159 AS cval_orders_o_comment_1#9176, cval_orders_o_orderdate#9160 AS cval_orders_o_orderdate_1#9177, co_orderstatus#9161 AS co_orderstatus_1#9178, co_totalprice#9162 AS co_totalprice_1#9179, co_orderpriority#9163 AS co_orderpriority_1#9180, co_clerk#9164 AS co_clerk_1#9181, co_shippriority#9165 AS co_shippriority_1#9182, co_comment#9166 AS co_comment_1#9183, co_orderdate#9167 AS co_orderdate_1#9184]
         :  :  :        +- Relation[rid#9151,cpfk_customer_orders#9152,cfpk_orders_customer#9153,cval_orders_o_orderstatus#9154,cval_orders_o_totalprice#9155,cval_orders_o_orderpriority#9156,cval_orders_o_clerk#9157,cval_orders_o_shippriority#9158,cval_orders_o_comment#9159,cval_orders_o_orderdate#9160,co_orderstatus#9161,co_totalprice#9162,co_orderpriority#9163,co_clerk#9164,co_shippriority#9165,co_comment#9166,co_orderdate#9167] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#9087 AS rid_1#9104, cpfk_customer_orders#9088 AS cpfk_customer_orders_1#9105, cfpk_orders_customer#9089 AS cfpk_orders_customer_1#9106, cval_orders_o_orderstatus#9090 AS cval_orders_o_orderstatus_1#9107, cval_orders_o_totalprice#9091 AS cval_orders_o_totalprice_1#9108, cval_orders_o_orderpriority#9092 AS cval_orders_o_orderpriority_1#9109, cval_orders_o_clerk#9093 AS cval_orders_o_clerk_1#9110, cval_orders_o_shippriority#9094 AS cval_orders_o_shippriority_1#9111, cval_orders_o_comment#9095 AS cval_orders_o_comment_1#9112, cval_orders_o_orderdate#9096 AS cval_orders_o_orderdate_1#9113, co_orderstatus#9097 AS co_orderstatus_1#9114, co_totalprice#9098 AS co_totalprice_1#9115, co_orderpriority#9099 AS co_orderpriority_1#9116, co_clerk#9100 AS co_clerk_1#9117, co_shippriority#9101 AS co_shippriority_1#9118, co_comment#9102 AS co_comment_1#9119, co_orderdate#9103 AS co_orderdate_1#9120]
         :  :     +- Relation[rid#9087,cpfk_customer_orders#9088,cfpk_orders_customer#9089,cval_orders_o_orderstatus#9090,cval_orders_o_totalprice#9091,cval_orders_o_orderpriority#9092,cval_orders_o_clerk#9093,cval_orders_o_shippriority#9094,cval_orders_o_comment#9095,cval_orders_o_orderdate#9096,co_orderstatus#9097,co_totalprice#9098,co_orderpriority#9099,co_clerk#9100,co_shippriority#9101,co_comment#9102,co_orderdate#9103] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#9251 AS rid_1#9268, cpfk_customer_orders#9252 AS cpfk_customer_orders_1#9269, cfpk_orders_customer#9253 AS cfpk_orders_customer_1#9270, cval_orders_o_orderstatus#9254 AS cval_orders_o_orderstatus_1#9271, cval_orders_o_totalprice#9255 AS cval_orders_o_totalprice_1#9272, cval_orders_o_orderpriority#9256 AS cval_orders_o_orderpriority_1#9273, cval_orders_o_clerk#9257 AS cval_orders_o_clerk_1#9274, cval_orders_o_shippriority#9258 AS cval_orders_o_shippriority_1#9275, cval_orders_o_comment#9259 AS cval_orders_o_comment_1#9276, cval_orders_o_orderdate#9260 AS cval_orders_o_orderdate_1#9277, co_orderstatus#9261 AS co_orderstatus_1#9278, co_totalprice#9262 AS co_totalprice_1#9279, co_orderpriority#9263 AS co_orderpriority_1#9280, co_clerk#9264 AS co_clerk_1#9281, co_shippriority#9265 AS co_shippriority_1#9282, co_comment#9266 AS co_comment_1#9283, co_orderdate#9267 AS co_orderdate_1#9284]
         :     :  +- Relation[rid#9251,cpfk_customer_orders#9252,cfpk_orders_customer#9253,cval_orders_o_orderstatus#9254,cval_orders_o_totalprice#9255,cval_orders_o_orderpriority#9256,cval_orders_o_clerk#9257,cval_orders_o_shippriority#9258,cval_orders_o_comment#9259,cval_orders_o_orderdate#9260,co_orderstatus#9261,co_totalprice#9262,co_orderpriority#9263,co_clerk#9264,co_shippriority#9265,co_comment#9266,co_orderdate#9267] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#9285 AS rid_2#9318, cpfk_orders_lineitem#9286 AS cpfk_orders_lineitem_2#9319, cpfk_supplier_lineitem#9287 AS cpfk_supplier_lineitem_2#9320, cfpk_lineitem_supplier#9288 AS cfpk_lineitem_supplier_2#9321, cfpk_lineitem_partsupp#9289 AS cfpk_lineitem_partsupp_2#9322, cpfk_part_lineitem#9290 AS cpfk_part_lineitem_2#9323, cfpk_lineitem_part#9291 AS cfpk_lineitem_part_2#9324, cpfk_partsupp_lineitem#9292 AS cpfk_partsupp_lineitem_2#9325, cfpk_lineitem_orders#9293 AS cfpk_lineitem_orders_2#9326, cval_lineitem_l_quantity#9294 AS cval_lineitem_l_quantity_2#9327, cval_lineitem_l_extendedprice#9295 AS cval_lineitem_l_extendedprice_2#9328, cval_lineitem_l_discount#9296 AS cval_lineitem_l_discount_2#9329, cval_lineitem_l_tax#9297 AS cval_lineitem_l_tax_2#9330, cval_lineitem_l_returnflag#9298 AS cval_lineitem_l_returnflag_2#9331, cval_lineitem_l_linestatus#9299 AS cval_lineitem_l_linestatus_2#9332, cval_lineitem_l_commitdate#9300 AS cval_lineitem_l_commitdate_2#9333, cval_lineitem_l_receiptdate#9301 AS cval_lineitem_l_receiptdate_2#9334, cval_lineitem_l_shipinstruct#9302 AS cval_lineitem_l_shipinstruct_2#9335, cval_lineitem_l_shipmode#9303 AS cval_lineitem_l_shipmode_2#9336, cval_lineitem_l_comment#9304 AS cval_lineitem_l_comment_2#9337, cval_lineitem_l_shipdate#9305 AS cval_lineitem_l_shipdate_2#9338, cl_quantity#9306 AS cl_quantity_2#9339, cl_extendedprice#9307 AS cl_extendedprice_2#9340, cl_discount#9308 AS cl_discount_2#9341, ... 9 more fields]
         :        +- Relation[rid#9285,cpfk_orders_lineitem#9286,cpfk_supplier_lineitem#9287,cfpk_lineitem_supplier#9288,cfpk_lineitem_partsupp#9289,cpfk_part_lineitem#9290,cfpk_lineitem_part#9291,cpfk_partsupp_lineitem#9292,cfpk_lineitem_orders#9293,cval_lineitem_l_quantity#9294,cval_lineitem_l_extendedprice#9295,cval_lineitem_l_discount#9296,cval_lineitem_l_tax#9297,cval_lineitem_l_returnflag#9298,cval_lineitem_l_linestatus#9299,cval_lineitem_l_commitdate#9300,cval_lineitem_l_receiptdate#9301,cval_lineitem_l_shipinstruct#9302,cval_lineitem_l_shipmode#9303,cval_lineitem_l_comment#9304,cval_lineitem_l_shipdate#9305,cl_quantity#9306,cl_extendedprice#9307,cl_discount#9308,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#9185 AS rid_2#9218, cpfk_orders_lineitem#9186 AS cpfk_orders_lineitem_2#9219, cpfk_supplier_lineitem#9187 AS cpfk_supplier_lineitem_2#9220, cfpk_lineitem_supplier#9188 AS cfpk_lineitem_supplier_2#9221, cfpk_lineitem_partsupp#9189 AS cfpk_lineitem_partsupp_2#9222, cpfk_part_lineitem#9190 AS cpfk_part_lineitem_2#9223, cfpk_lineitem_part#9191 AS cfpk_lineitem_part_2#9224, cpfk_partsupp_lineitem#9192 AS cpfk_partsupp_lineitem_2#9225, cfpk_lineitem_orders#9193 AS cfpk_lineitem_orders_2#9226, cval_lineitem_l_quantity#9194 AS cval_lineitem_l_quantity_2#9227, cval_lineitem_l_extendedprice#9195 AS cval_lineitem_l_extendedprice_2#9228, cval_lineitem_l_discount#9196 AS cval_lineitem_l_discount_2#9229, cval_lineitem_l_tax#9197 AS cval_lineitem_l_tax_2#9230, cval_lineitem_l_returnflag#9198 AS cval_lineitem_l_returnflag_2#9231, cval_lineitem_l_linestatus#9199 AS cval_lineitem_l_linestatus_2#9232, cval_lineitem_l_commitdate#9200 AS cval_lineitem_l_commitdate_2#9233, cval_lineitem_l_receiptdate#9201 AS cval_lineitem_l_receiptdate_2#9234, cval_lineitem_l_shipinstruct#9202 AS cval_lineitem_l_shipinstruct_2#9235, cval_lineitem_l_shipmode#9203 AS cval_lineitem_l_shipmode_2#9236, cval_lineitem_l_comment#9204 AS cval_lineitem_l_comment_2#9237, cval_lineitem_l_shipdate#9205 AS cval_lineitem_l_shipdate_2#9238, cl_quantity#9206 AS cl_quantity_2#9239, cl_extendedprice#9207 AS cl_extendedprice_2#9240, cl_discount#9208 AS cl_discount_2#9241, ... 9 more fields]
            +- Relation[rid#9185,cpfk_orders_lineitem#9186,cpfk_supplier_lineitem#9187,cfpk_lineitem_supplier#9188,cfpk_lineitem_partsupp#9189,cpfk_part_lineitem#9190,cfpk_lineitem_part#9191,cpfk_partsupp_lineitem#9192,cfpk_lineitem_orders#9193,cval_lineitem_l_quantity#9194,cval_lineitem_l_extendedprice#9195,cval_lineitem_l_discount#9196,cval_lineitem_l_tax#9197,cval_lineitem_l_returnflag#9198,cval_lineitem_l_linestatus#9199,cval_lineitem_l_commitdate#9200,cval_lineitem_l_receiptdate#9201,cval_lineitem_l_shipinstruct#9202,cval_lineitem_l_shipmode#9203,cval_lineitem_l_comment#9204,cval_lineitem_l_shipdate#9205,cl_quantity#9206,cl_extendedprice#9207,cl_discount#9208,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 117497ms
query=q1, count=6001215, duration=2966
query=q10, count=1478870, duration=61517
query=q11, count=31680, duration=10548
query=q12, count=857401, duration=21421
query=q13, count=1500000, duration=12754
query=q14, count=6001215, duration=82260
query=q15, count=6001215, duration=78204
query=q16, count=15780, duration=11029
query=q17, count=6088, duration=71575
query=q18, count=6001215, duration=117497
query=q19, count=205, duration=361769
query=q2, count=3162, duration=20601
query=q20, count=632, duration=11330
query=q21a, count=597422, duration=246408
query=q22, count=1500000, duration=12768
query=q3, count=1214743, duration=115396
query=q4, count=6001215, duration=53336
query=q5, count=1206514, duration=163521
query=q6, count=6001215, duration=3167
query=q7, count=9735, duration=102463
query=q8, count=8716, duration=94797
query=q9a, count=6001215, duration=245679
query=q9b, count=6001215, duration=162470
