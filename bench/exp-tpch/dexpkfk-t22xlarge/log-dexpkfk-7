20/04/26 22:08:18 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10639ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sun Apr 26 22:08:21 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sun Apr 26 22:08:23 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sun Apr 26 22:08:23 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sun Apr 26 22:08:23 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sun Apr 26 22:08:23 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sun Apr 26 22:08:27 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sun Apr 26 22:08:30 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sun Apr 26 22:08:31 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/26 22:08:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:08:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2079L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:08:32 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:08:32 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:08:32 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:08:32 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:08:32 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:08:33 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:08:33 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:08:33 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/26 22:08:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2079L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#2106, cval_part_p_name_0#2107, cval_part_p_mfgr_0#2108, cval_part_p_type_0#2109, cval_part_p_size_0#2110, cval_part_p_container_0#2111, cval_part_p_retailprice_0#2112, cval_part_p_comment_0#2113, cval_part_p_brand_0#2114, cdepval_part_p_name_0#2115, cdepval_part_p_mfgr_0#2116, cdepval_part_p_type_0#2117, cdepval_part_p_size_0#2118, cdepval_part_p_container_0#2119, cdepval_part_p_retailprice_0#2120, cdepval_part_p_comment_0#2121, cdepval_part_p_brand_0#2122, cp_name_0#2123, cp_mfgr_0#2124, cp_type_0#2125, cp_size_0#2126, cp_container_0#2127, cp_retailprice_0#2128, cp_comment_0#2129, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#2081 AS rid_0#2106, cval_part_p_name#2082 AS cval_part_p_name_0#2107, cval_part_p_mfgr#2083 AS cval_part_p_mfgr_0#2108, cval_part_p_type#2084 AS cval_part_p_type_0#2109, cval_part_p_size#2085 AS cval_part_p_size_0#2110, cval_part_p_container#2086 AS cval_part_p_container_0#2111, cval_part_p_retailprice#2087 AS cval_part_p_retailprice_0#2112, cval_part_p_comment#2088 AS cval_part_p_comment_0#2113, cval_part_p_brand#2089 AS cval_part_p_brand_0#2114, cdepval_part_p_name#2090 AS cdepval_part_p_name_0#2115, cdepval_part_p_mfgr#2091 AS cdepval_part_p_mfgr_0#2116, cdepval_part_p_type#2092 AS cdepval_part_p_type_0#2117, cdepval_part_p_size#2093 AS cdepval_part_p_size_0#2118, cdepval_part_p_container#2094 AS cdepval_part_p_container_0#2119, cdepval_part_p_retailprice#2095 AS cdepval_part_p_retailprice_0#2120, cdepval_part_p_comment#2096 AS cdepval_part_p_comment_0#2121, cdepval_part_p_brand#2097 AS cdepval_part_p_brand_0#2122, cp_name#2098 AS cp_name_0#2123, cp_mfgr#2099 AS cp_mfgr_0#2124, cp_type#2100 AS cp_type_0#2125, cp_size#2101 AS cp_size_0#2126, cp_container#2102 AS cp_container_0#2127, cp_retailprice#2103 AS cp_retailprice_0#2128, cp_comment#2104 AS cp_comment_0#2129, cp_brand#2105 AS cp_brand_0#2130]
         :  :        +- Relation[rid#2081,cval_part_p_name#2082,cval_part_p_mfgr#2083,cval_part_p_type#2084,cval_part_p_size#2085,cval_part_p_container#2086,cval_part_p_retailprice#2087,cval_part_p_comment#2088,cval_part_p_brand#2089,cdepval_part_p_name#2090,cdepval_part_p_mfgr#2091,cdepval_part_p_type#2092,cdepval_part_p_size#2093,cdepval_part_p_container#2094,cdepval_part_p_retailprice#2095,cdepval_part_p_comment#2096,cdepval_part_p_brand#2097,cp_name#2098,cp_mfgr#2099,cp_type#2100,cp_size#2101,cp_container#2102,cp_retailprice#2103,cp_comment#2104,cp_brand#2105] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#2551 AS rid_1#2596, cpfk_orders_lineitem#2552 AS cpfk_orders_lineitem_1#2597, cpfk_supplier_lineitem#2553 AS cpfk_supplier_lineitem_1#2598, cfpk_lineitem_supplier#2554 AS cfpk_lineitem_supplier_1#2599, cfpk_lineitem_partsupp#2555 AS cfpk_lineitem_partsupp_1#2600, cpfk_part_lineitem#2556 AS cpfk_part_lineitem_1#2601, cfpk_lineitem_part#2557 AS cfpk_lineitem_part_1#2602, cpfk_partsupp_lineitem#2558 AS cpfk_partsupp_lineitem_1#2603, cfpk_lineitem_orders#2559 AS cfpk_lineitem_orders_1#2604, cval_lineitem_l_quantity#2560 AS cval_lineitem_l_quantity_1#2605, cval_lineitem_l_extendedprice#2561 AS cval_lineitem_l_extendedprice_1#2606, cval_lineitem_l_discount#2562 AS cval_lineitem_l_discount_1#2607, cval_lineitem_l_tax#2563 AS cval_lineitem_l_tax_1#2608, cval_lineitem_l_returnflag#2564 AS cval_lineitem_l_returnflag_1#2609, cval_lineitem_l_linestatus#2565 AS cval_lineitem_l_linestatus_1#2610, cval_lineitem_l_commitdate#2566 AS cval_lineitem_l_commitdate_1#2611, cval_lineitem_l_receiptdate#2567 AS cval_lineitem_l_receiptdate_1#2612, cval_lineitem_l_shipinstruct#2568 AS cval_lineitem_l_shipinstruct_1#2613, cval_lineitem_l_shipmode#2569 AS cval_lineitem_l_shipmode_1#2614, cval_lineitem_l_comment#2570 AS cval_lineitem_l_comment_1#2615, cval_lineitem_l_shipdate#2571 AS cval_lineitem_l_shipdate_1#2616, cdepval_lineitem_l_quantity#2572 AS cdepval_lineitem_l_quantity_1#2617, cdepval_lineitem_l_extendedprice#2573 AS cdepval_lineitem_l_extendedprice_1#2618, cdepval_lineitem_l_discount#2574 AS cdepval_lineitem_l_discount_1#2619, ... 21 more fields]
         :        +- Relation[rid#2551,cpfk_orders_lineitem#2552,cpfk_supplier_lineitem#2553,cfpk_lineitem_supplier#2554,cfpk_lineitem_partsupp#2555,cpfk_part_lineitem#2556,cfpk_lineitem_part#2557,cpfk_partsupp_lineitem#2558,cfpk_lineitem_orders#2559,cval_lineitem_l_quantity#2560,cval_lineitem_l_extendedprice#2561,cval_lineitem_l_discount#2562,cval_lineitem_l_tax#2563,cval_lineitem_l_returnflag#2564,cval_lineitem_l_linestatus#2565,cval_lineitem_l_commitdate#2566,cval_lineitem_l_receiptdate#2567,cval_lineitem_l_shipinstruct#2568,cval_lineitem_l_shipmode#2569,cval_lineitem_l_comment#2570,cval_lineitem_l_shipdate#2571,cdepval_lineitem_l_quantity#2572,cdepval_lineitem_l_extendedprice#2573,cdepval_lineitem_l_discount#2574,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#2231 AS rid_1#2276, cpfk_orders_lineitem#2232 AS cpfk_orders_lineitem_1#2277, cpfk_supplier_lineitem#2233 AS cpfk_supplier_lineitem_1#2278, cfpk_lineitem_supplier#2234 AS cfpk_lineitem_supplier_1#2279, cfpk_lineitem_partsupp#2235 AS cfpk_lineitem_partsupp_1#2280, cpfk_part_lineitem#2236 AS cpfk_part_lineitem_1#2281, cfpk_lineitem_part#2237 AS cfpk_lineitem_part_1#2282, cpfk_partsupp_lineitem#2238 AS cpfk_partsupp_lineitem_1#2283, cfpk_lineitem_orders#2239 AS cfpk_lineitem_orders_1#2284, cval_lineitem_l_quantity#2240 AS cval_lineitem_l_quantity_1#2285, cval_lineitem_l_extendedprice#2241 AS cval_lineitem_l_extendedprice_1#2286, cval_lineitem_l_discount#2242 AS cval_lineitem_l_discount_1#2287, cval_lineitem_l_tax#2243 AS cval_lineitem_l_tax_1#2288, cval_lineitem_l_returnflag#2244 AS cval_lineitem_l_returnflag_1#2289, cval_lineitem_l_linestatus#2245 AS cval_lineitem_l_linestatus_1#2290, cval_lineitem_l_commitdate#2246 AS cval_lineitem_l_commitdate_1#2291, cval_lineitem_l_receiptdate#2247 AS cval_lineitem_l_receiptdate_1#2292, cval_lineitem_l_shipinstruct#2248 AS cval_lineitem_l_shipinstruct_1#2293, cval_lineitem_l_shipmode#2249 AS cval_lineitem_l_shipmode_1#2294, cval_lineitem_l_comment#2250 AS cval_lineitem_l_comment_1#2295, cval_lineitem_l_shipdate#2251 AS cval_lineitem_l_shipdate_1#2296, cdepval_lineitem_l_quantity#2252 AS cdepval_lineitem_l_quantity_1#2297, cdepval_lineitem_l_extendedprice#2253 AS cdepval_lineitem_l_extendedprice_1#2298, cdepval_lineitem_l_discount#2254 AS cdepval_lineitem_l_discount_1#2299, ... 21 more fields]
                  +- Relation[rid#2231,cpfk_orders_lineitem#2232,cpfk_supplier_lineitem#2233,cfpk_lineitem_supplier#2234,cfpk_lineitem_partsupp#2235,cpfk_part_lineitem#2236,cfpk_lineitem_part#2237,cpfk_partsupp_lineitem#2238,cfpk_lineitem_orders#2239,cval_lineitem_l_quantity#2240,cval_lineitem_l_extendedprice#2241,cval_lineitem_l_discount#2242,cval_lineitem_l_tax#2243,cval_lineitem_l_returnflag#2244,cval_lineitem_l_linestatus#2245,cval_lineitem_l_commitdate#2246,cval_lineitem_l_receiptdate#2247,cval_lineitem_l_shipinstruct#2248,cval_lineitem_l_shipmode#2249,cval_lineitem_l_comment#2250,cval_lineitem_l_shipdate#2251,cdepval_lineitem_l_quantity#2252,cdepval_lineitem_l_extendedprice#2253,cdepval_lineitem_l_discount#2254,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 17234ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/26 22:08:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:08:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2717L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 22:08:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:08:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:08:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:08:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:08:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:08:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:08:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:08:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:08:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:08:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:08:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:08:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2717L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#2845 AS rid_2#2859, cpfk_part_partsupp#2846 AS cpfk_part_partsupp_2#2860, cfpk_partsupp_part#2847 AS cfpk_partsupp_part_2#2861, cpfk_supplier_partsupp#2848 AS cpfk_supplier_partsupp_2#2862, cfpk_partsupp_supplier#2849 AS cfpk_partsupp_supplier_2#2863, cval_partsupp_ps_availqty#2850 AS cval_partsupp_ps_availqty_2#2864, cval_partsupp_ps_supplycost#2851 AS cval_partsupp_ps_supplycost_2#2865, cval_partsupp_ps_comment#2852 AS cval_partsupp_ps_comment_2#2866, cdepval_partsupp_ps_availqty#2853 AS cdepval_partsupp_ps_availqty_2#2867, cdepval_partsupp_ps_supplycost#2854 AS cdepval_partsupp_ps_supplycost_2#2868, cdepval_partsupp_ps_comment#2855 AS cdepval_partsupp_ps_comment_2#2869, cps_availqty#2856 AS cps_availqty_2#2870, cps_supplycost#2857 AS cps_supplycost_2#2871, cps_comment#2858 AS cps_comment_2#2872]
         :  +- Relation[rid#2845,cpfk_part_partsupp#2846,cfpk_partsupp_part#2847,cpfk_supplier_partsupp#2848,cfpk_partsupp_supplier#2849,cval_partsupp_ps_availqty#2850,cval_partsupp_ps_supplycost#2851,cval_partsupp_ps_comment#2852,cdepval_partsupp_ps_availqty#2853,cdepval_partsupp_ps_supplycost#2854,cdepval_partsupp_ps_comment#2855,cps_availqty#2856,cps_supplycost#2857,cps_comment#2858] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#2728, cpfk_region_nation_0#2729, cfpk_nation_region_0#2730, cval_nation_n_name_0#2731, cval_nation_n_comment_0#2732, cdepval_nation_n_name_0#2733, cdepval_nation_n_comment_0#2734, cn_name_0#2735, cn_comment_0#2736, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
            :  :  +- Project [rid#2719 AS rid_0#2728, cpfk_region_nation#2720 AS cpfk_region_nation_0#2729, cfpk_nation_region#2721 AS cfpk_nation_region_0#2730, cval_nation_n_name#2722 AS cval_nation_n_name_0#2731, cval_nation_n_comment#2723 AS cval_nation_n_comment_0#2732, cdepval_nation_n_name#2724 AS cdepval_nation_n_name_0#2733, cdepval_nation_n_comment#2725 AS cdepval_nation_n_comment_0#2734, cn_name#2726 AS cn_name_0#2735, cn_comment#2727 AS cn_comment_0#2736]
            :  :     +- Relation[rid#2719,cpfk_region_nation#2720,cfpk_nation_region#2721,cval_nation_n_name#2722,cval_nation_n_comment#2723,cdepval_nation_n_name#2724,cdepval_nation_n_comment#2725,cn_name#2726,cn_comment#2727] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
            :     +- Project [rid#2809 AS rid_1#2827, cpfk_nation_supplier#2810 AS cpfk_nation_supplier_1#2828, cfpk_supplier_nation#2811 AS cfpk_supplier_nation_1#2829, cval_supplier_s_name#2812 AS cval_supplier_s_name_1#2830, cval_supplier_s_address#2813 AS cval_supplier_s_address_1#2831, cval_supplier_s_phone#2814 AS cval_supplier_s_phone_1#2832, cval_supplier_s_acctbal#2815 AS cval_supplier_s_acctbal_1#2833, cval_supplier_s_comment#2816 AS cval_supplier_s_comment_1#2834, cdepval_supplier_s_name#2817 AS cdepval_supplier_s_name_1#2835, cdepval_supplier_s_address#2818 AS cdepval_supplier_s_address_1#2836, cdepval_supplier_s_phone#2819 AS cdepval_supplier_s_phone_1#2837, cdepval_supplier_s_acctbal#2820 AS cdepval_supplier_s_acctbal_1#2838, cdepval_supplier_s_comment#2821 AS cdepval_supplier_s_comment_1#2839, cs_name#2822 AS cs_name_1#2840, cs_address#2823 AS cs_address_1#2841, cs_phone#2824 AS cs_phone_1#2842, cs_acctbal#2825 AS cs_acctbal_1#2843, cs_comment#2826 AS cs_comment_1#2844]
            :        +- Relation[rid#2809,cpfk_nation_supplier#2810,cfpk_supplier_nation#2811,cval_supplier_s_name#2812,cval_supplier_s_address#2813,cval_supplier_s_phone#2814,cval_supplier_s_acctbal#2815,cval_supplier_s_comment#2816,cdepval_supplier_s_name#2817,cdepval_supplier_s_address#2818,cdepval_supplier_s_phone#2819,cdepval_supplier_s_acctbal#2820,cdepval_supplier_s_comment#2821,cs_name#2822,cs_address#2823,cs_phone#2824,cs_acctbal#2825,cs_comment#2826] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#2755 AS rid_1#2773, cpfk_nation_supplier#2756 AS cpfk_nation_supplier_1#2774, cfpk_supplier_nation#2757 AS cfpk_supplier_nation_1#2775, cval_supplier_s_name#2758 AS cval_supplier_s_name_1#2776, cval_supplier_s_address#2759 AS cval_supplier_s_address_1#2777, cval_supplier_s_phone#2760 AS cval_supplier_s_phone_1#2778, cval_supplier_s_acctbal#2761 AS cval_supplier_s_acctbal_1#2779, cval_supplier_s_comment#2762 AS cval_supplier_s_comment_1#2780, cdepval_supplier_s_name#2763 AS cdepval_supplier_s_name_1#2781, cdepval_supplier_s_address#2764 AS cdepval_supplier_s_address_1#2782, cdepval_supplier_s_phone#2765 AS cdepval_supplier_s_phone_1#2783, cdepval_supplier_s_acctbal#2766 AS cdepval_supplier_s_acctbal_1#2784, cdepval_supplier_s_comment#2767 AS cdepval_supplier_s_comment_1#2785, cs_name#2768 AS cs_name_1#2786, cs_address#2769 AS cs_address_1#2787, cs_phone#2770 AS cs_phone_1#2788, cs_acctbal#2771 AS cs_acctbal_1#2789, cs_comment#2772 AS cs_comment_1#2790]
               +- Relation[rid#2755,cpfk_nation_supplier#2756,cfpk_supplier_nation#2757,cval_supplier_s_name#2758,cval_supplier_s_address#2759,cval_supplier_s_phone#2760,cval_supplier_s_acctbal#2761,cval_supplier_s_comment#2762,cdepval_supplier_s_name#2763,cdepval_supplier_s_address#2764,cdepval_supplier_s_phone#2765,cdepval_supplier_s_acctbal#2766,cdepval_supplier_s_comment#2767,cs_name#2768,cs_address#2769,cs_phone#2770,cs_acctbal#2771,cs_comment#2772] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 2529ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/26 22:08:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:08:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2918L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 22:08:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:08:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:08:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:08:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:08:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:08:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:08:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:08:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:08:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:08:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:08:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:08:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:08:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:08:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:08:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:08:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:08:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2918L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#3059, cval_part_p_name_3#3060, cval_part_p_mfgr_3#3061, cval_part_p_type_3#3062, cval_part_p_size_3#3063, cval_part_p_container_3#3064, cval_part_p_retailprice_3#3065, cval_part_p_comment_3#3066, cval_part_p_brand_3#3067, cdepval_part_p_name_3#3068, cdepval_part_p_mfgr_3#3069, cdepval_part_p_type_3#3070, cdepval_part_p_size_3#3071, cdepval_part_p_container_3#3072, cdepval_part_p_retailprice_3#3073, cdepval_part_p_comment_3#3074, cdepval_part_p_brand_3#3075, cp_name_3#3076, cp_mfgr_3#3077, cp_type_3#3078, cp_size_3#3079, cp_container_3#3080, cp_retailprice_3#3081, cp_comment_3#3082, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :  :  :  +- Project [rid#3034 AS rid_3#3059, cval_part_p_name#3035 AS cval_part_p_name_3#3060, cval_part_p_mfgr#3036 AS cval_part_p_mfgr_3#3061, cval_part_p_type#3037 AS cval_part_p_type_3#3062, cval_part_p_size#3038 AS cval_part_p_size_3#3063, cval_part_p_container#3039 AS cval_part_p_container_3#3064, cval_part_p_retailprice#3040 AS cval_part_p_retailprice_3#3065, cval_part_p_comment#3041 AS cval_part_p_comment_3#3066, cval_part_p_brand#3042 AS cval_part_p_brand_3#3067, cdepval_part_p_name#3043 AS cdepval_part_p_name_3#3068, cdepval_part_p_mfgr#3044 AS cdepval_part_p_mfgr_3#3069, cdepval_part_p_type#3045 AS cdepval_part_p_type_3#3070, cdepval_part_p_size#3046 AS cdepval_part_p_size_3#3071, cdepval_part_p_container#3047 AS cdepval_part_p_container_3#3072, cdepval_part_p_retailprice#3048 AS cdepval_part_p_retailprice_3#3073, cdepval_part_p_comment#3049 AS cdepval_part_p_comment_3#3074, cdepval_part_p_brand#3050 AS cdepval_part_p_brand_3#3075, cp_name#3051 AS cp_name_3#3076, cp_mfgr#3052 AS cp_mfgr_3#3077, cp_type#3053 AS cp_type_3#3078, cp_size#3054 AS cp_size_3#3079, cp_container#3055 AS cp_container_3#3080, cp_retailprice#3056 AS cp_retailprice_3#3081, cp_comment#3057 AS cp_comment_3#3082, cp_brand#3058 AS cp_brand_3#3083]
         :  :  :     +- Relation[rid#3034,cval_part_p_name#3035,cval_part_p_mfgr#3036,cval_part_p_type#3037,cval_part_p_size#3038,cval_part_p_container#3039,cval_part_p_retailprice#3040,cval_part_p_comment#3041,cval_part_p_brand#3042,cdepval_part_p_name#3043,cdepval_part_p_mfgr#3044,cdepval_part_p_type#3045,cdepval_part_p_size#3046,cdepval_part_p_container#3047,cdepval_part_p_retailprice#3048,cdepval_part_p_comment#3049,cdepval_part_p_brand#3050,cp_name#3051,cp_mfgr#3052,cp_type#3053,cp_size#3054,cp_container#3055,cp_retailprice#3056,cp_comment#3057,cp_brand#3058] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_4, 'rid_4]
         :  :     +- Project [rid#3212 AS rid_4#3226, cpfk_part_partsupp#3213 AS cpfk_part_partsupp_4#3227, cfpk_partsupp_part#3214 AS cfpk_partsupp_part_4#3228, cpfk_supplier_partsupp#3215 AS cpfk_supplier_partsupp_4#3229, cfpk_partsupp_supplier#3216 AS cfpk_partsupp_supplier_4#3230, cval_partsupp_ps_availqty#3217 AS cval_partsupp_ps_availqty_4#3231, cval_partsupp_ps_supplycost#3218 AS cval_partsupp_ps_supplycost_4#3232, cval_partsupp_ps_comment#3219 AS cval_partsupp_ps_comment_4#3233, cdepval_partsupp_ps_availqty#3220 AS cdepval_partsupp_ps_availqty_4#3234, cdepval_partsupp_ps_supplycost#3221 AS cdepval_partsupp_ps_supplycost_4#3235, cdepval_partsupp_ps_comment#3222 AS cdepval_partsupp_ps_comment_4#3236, cps_availqty#3223 AS cps_availqty_4#3237, cps_supplycost#3224 AS cps_supplycost_4#3238, cps_comment#3225 AS cps_comment_4#3239]
         :  :        +- Relation[rid#3212,cpfk_part_partsupp#3213,cfpk_partsupp_part#3214,cpfk_supplier_partsupp#3215,cfpk_partsupp_supplier#3216,cval_partsupp_ps_availqty#3217,cval_partsupp_ps_supplycost#3218,cval_partsupp_ps_comment#3219,cdepval_partsupp_ps_availqty#3220,cdepval_partsupp_ps_supplycost#3221,cdepval_partsupp_ps_comment#3222,cps_availqty#3223,cps_supplycost#3224,cps_comment#3225] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#3134 AS rid_4#3148, cpfk_part_partsupp#3135 AS cpfk_part_partsupp_4#3149, cfpk_partsupp_part#3136 AS cfpk_partsupp_part_4#3150, cpfk_supplier_partsupp#3137 AS cpfk_supplier_partsupp_4#3151, cfpk_partsupp_supplier#3138 AS cfpk_partsupp_supplier_4#3152, cval_partsupp_ps_availqty#3139 AS cval_partsupp_ps_availqty_4#3153, cval_partsupp_ps_supplycost#3140 AS cval_partsupp_ps_supplycost_4#3154, cval_partsupp_ps_comment#3141 AS cval_partsupp_ps_comment_4#3155, cdepval_partsupp_ps_availqty#3142 AS cdepval_partsupp_ps_availqty_4#3156, cdepval_partsupp_ps_supplycost#3143 AS cdepval_partsupp_ps_supplycost_4#3157, cdepval_partsupp_ps_comment#3144 AS cdepval_partsupp_ps_comment_4#3158, cps_availqty#3145 AS cps_availqty_4#3159, cps_supplycost#3146 AS cps_supplycost_4#3160, cps_comment#3147 AS cps_comment_4#3161]
         :     +- Relation[rid#3134,cpfk_part_partsupp#3135,cfpk_partsupp_part#3136,cpfk_supplier_partsupp#3137,cfpk_partsupp_supplier#3138,cval_partsupp_ps_availqty#3139,cval_partsupp_ps_supplycost#3140,cval_partsupp_ps_comment#3141,cdepval_partsupp_ps_availqty#3142,cdepval_partsupp_ps_supplycost#3143,cdepval_partsupp_ps_comment#3144,cps_availqty#3145,cps_supplycost#3146,cps_comment#3147] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#2998 AS rid_2#3016, cpfk_nation_supplier#2999 AS cpfk_nation_supplier_2#3017, cfpk_supplier_nation#3000 AS cfpk_supplier_nation_2#3018, cval_supplier_s_name#3001 AS cval_supplier_s_name_2#3019, cval_supplier_s_address#3002 AS cval_supplier_s_address_2#3020, cval_supplier_s_phone#3003 AS cval_supplier_s_phone_2#3021, cval_supplier_s_acctbal#3004 AS cval_supplier_s_acctbal_2#3022, cval_supplier_s_comment#3005 AS cval_supplier_s_comment_2#3023, cdepval_supplier_s_name#3006 AS cdepval_supplier_s_name_2#3024, cdepval_supplier_s_address#3007 AS cdepval_supplier_s_address_2#3025, cdepval_supplier_s_phone#3008 AS cdepval_supplier_s_phone_2#3026, cdepval_supplier_s_acctbal#3009 AS cdepval_supplier_s_acctbal_2#3027, cdepval_supplier_s_comment#3010 AS cdepval_supplier_s_comment_2#3028, cs_name#3011 AS cs_name_2#3029, cs_address#3012 AS cs_address_2#3030, cs_phone#3013 AS cs_phone_2#3031, cs_acctbal#3014 AS cs_acctbal_2#3032, cs_comment#3015 AS cs_comment_2#3033]
            :  +- Relation[rid#2998,cpfk_nation_supplier#2999,cfpk_supplier_nation#3000,cval_supplier_s_name#3001,cval_supplier_s_address#3002,cval_supplier_s_phone#3003,cval_supplier_s_acctbal#3004,cval_supplier_s_comment#3005,cdepval_supplier_s_name#3006,cdepval_supplier_s_address#3007,cdepval_supplier_s_phone#3008,cdepval_supplier_s_acctbal#3009,cdepval_supplier_s_comment#3010,cs_name#3011,cs_address#3012,cs_phone#3013,cs_acctbal#3014,cs_comment#3015] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_1))
               :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#2927, cval_region_r_name_0#2928, cval_region_r_comment_0#2929, cdepval_region_r_name_0#2930, cdepval_region_r_comment_0#2931, cr_name_0#2932, cr_comment_0#2933, 'rid_1]
               :  :- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
               :  :  +- Project [rid#2920 AS rid_0#2927, cval_region_r_name#2921 AS cval_region_r_name_0#2928, cval_region_r_comment#2922 AS cval_region_r_comment_0#2929, cdepval_region_r_name#2923 AS cdepval_region_r_name_0#2930, cdepval_region_r_comment#2924 AS cdepval_region_r_comment_0#2931, cr_name#2925 AS cr_name_0#2932, cr_comment#2926 AS cr_comment_0#2933]
               :  :     +- Relation[rid#2920,cval_region_r_name#2921,cval_region_r_comment#2922,cdepval_region_r_name#2923,cdepval_region_r_comment#2924,cr_name#2925,cr_comment#2926] JDBCRelation(tregion) [numPartitions=1]
               :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
               :     +- Project [rid#2980 AS rid_1#2989, cpfk_region_nation#2981 AS cpfk_region_nation_1#2990, cfpk_nation_region#2982 AS cfpk_nation_region_1#2991, cval_nation_n_name#2983 AS cval_nation_n_name_1#2992, cval_nation_n_comment#2984 AS cval_nation_n_comment_1#2993, cdepval_nation_n_name#2985 AS cdepval_nation_n_name_1#2994, cdepval_nation_n_comment#2986 AS cdepval_nation_n_comment_1#2995, cn_name#2987 AS cn_name_1#2996, cn_comment#2988 AS cn_comment_1#2997]
               :        +- Relation[rid#2980,cpfk_region_nation#2981,cfpk_nation_region#2982,cval_nation_n_name#2983,cval_nation_n_comment#2984,cdepval_nation_n_name#2985,cdepval_nation_n_comment#2986,cn_name#2987,cn_comment#2988] JDBCRelation(tnation) [numPartitions=1]
               +- Project [rid#2948 AS rid_1#2957, cpfk_region_nation#2949 AS cpfk_region_nation_1#2958, cfpk_nation_region#2950 AS cfpk_nation_region_1#2959, cval_nation_n_name#2951 AS cval_nation_n_name_1#2960, cval_nation_n_comment#2952 AS cval_nation_n_comment_1#2961, cdepval_nation_n_name#2953 AS cdepval_nation_n_name_1#2962, cdepval_nation_n_comment#2954 AS cdepval_nation_n_comment_1#2963, cn_name#2955 AS cn_name_1#2964, cn_comment#2956 AS cn_comment_1#2965]
                  +- Relation[rid#2948,cpfk_region_nation#2949,cfpk_nation_region#2950,cval_nation_n_name#2951,cval_nation_n_comment#2952,cdepval_nation_n_name#2953,cdepval_nation_n_comment#2954,cn_name#2955,cn_comment#2956] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 904ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/26 22:08:53 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:08:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3320L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:08:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:08:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:08:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:08:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:08:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:08:53 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:08:53 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:08:53 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:08:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:08:53 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:08:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:08:53 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:08:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:08:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:08:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3320L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#3347, cval_part_p_name_0#3348, cval_part_p_mfgr_0#3349, cval_part_p_type_0#3350, cval_part_p_size_0#3351, cval_part_p_container_0#3352, cval_part_p_retailprice_0#3353, cval_part_p_comment_0#3354, cval_part_p_brand_0#3355, cdepval_part_p_name_0#3356, cdepval_part_p_mfgr_0#3357, cdepval_part_p_type_0#3358, cdepval_part_p_size_0#3359, cdepval_part_p_container_0#3360, cdepval_part_p_retailprice_0#3361, cdepval_part_p_comment_0#3362, cdepval_part_p_brand_0#3363, cp_name_0#3364, cp_mfgr_0#3365, cp_type_0#3366, cp_size_0#3367, cp_container_0#3368, cp_retailprice_0#3369, cp_comment_0#3370, ... 2 more fields]
         :  :  :  :  :- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :  :  :  +- Project [rid#3322 AS rid_0#3347, cval_part_p_name#3323 AS cval_part_p_name_0#3348, cval_part_p_mfgr#3324 AS cval_part_p_mfgr_0#3349, cval_part_p_type#3325 AS cval_part_p_type_0#3350, cval_part_p_size#3326 AS cval_part_p_size_0#3351, cval_part_p_container#3327 AS cval_part_p_container_0#3352, cval_part_p_retailprice#3328 AS cval_part_p_retailprice_0#3353, cval_part_p_comment#3329 AS cval_part_p_comment_0#3354, cval_part_p_brand#3330 AS cval_part_p_brand_0#3355, cdepval_part_p_name#3331 AS cdepval_part_p_name_0#3356, cdepval_part_p_mfgr#3332 AS cdepval_part_p_mfgr_0#3357, cdepval_part_p_type#3333 AS cdepval_part_p_type_0#3358, cdepval_part_p_size#3334 AS cdepval_part_p_size_0#3359, cdepval_part_p_container#3335 AS cdepval_part_p_container_0#3360, cdepval_part_p_retailprice#3336 AS cdepval_part_p_retailprice_0#3361, cdepval_part_p_comment#3337 AS cdepval_part_p_comment_0#3362, cdepval_part_p_brand#3338 AS cdepval_part_p_brand_0#3363, cp_name#3339 AS cp_name_0#3364, cp_mfgr#3340 AS cp_mfgr_0#3365, cp_type#3341 AS cp_type_0#3366, cp_size#3342 AS cp_size_0#3367, cp_container#3343 AS cp_container_0#3368, cp_retailprice#3344 AS cp_retailprice_0#3369, cp_comment#3345 AS cp_comment_0#3370, cp_brand#3346 AS cp_brand_0#3371]
         :  :  :  :  :     +- Relation[rid#3322,cval_part_p_name#3323,cval_part_p_mfgr#3324,cval_part_p_type#3325,cval_part_p_size#3326,cval_part_p_container#3327,cval_part_p_retailprice#3328,cval_part_p_comment#3329,cval_part_p_brand#3330,cdepval_part_p_name#3331,cdepval_part_p_mfgr#3332,cdepval_part_p_type#3333,cdepval_part_p_size#3334,cdepval_part_p_container#3335,cdepval_part_p_retailprice#3336,cdepval_part_p_comment#3337,cdepval_part_p_brand#3338,cp_name#3339,cp_mfgr#3340,cp_type#3341,cp_size#3342,cp_container#3343,cp_retailprice#3344,cp_comment#3345,cp_brand#3346] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :  :  :  :     +- Project [rid#3562 AS rid_1#3607, cpfk_orders_lineitem#3563 AS cpfk_orders_lineitem_1#3608, cpfk_supplier_lineitem#3564 AS cpfk_supplier_lineitem_1#3609, cfpk_lineitem_supplier#3565 AS cfpk_lineitem_supplier_1#3610, cfpk_lineitem_partsupp#3566 AS cfpk_lineitem_partsupp_1#3611, cpfk_part_lineitem#3567 AS cpfk_part_lineitem_1#3612, cfpk_lineitem_part#3568 AS cfpk_lineitem_part_1#3613, cpfk_partsupp_lineitem#3569 AS cpfk_partsupp_lineitem_1#3614, cfpk_lineitem_orders#3570 AS cfpk_lineitem_orders_1#3615, cval_lineitem_l_quantity#3571 AS cval_lineitem_l_quantity_1#3616, cval_lineitem_l_extendedprice#3572 AS cval_lineitem_l_extendedprice_1#3617, cval_lineitem_l_discount#3573 AS cval_lineitem_l_discount_1#3618, cval_lineitem_l_tax#3574 AS cval_lineitem_l_tax_1#3619, cval_lineitem_l_returnflag#3575 AS cval_lineitem_l_returnflag_1#3620, cval_lineitem_l_linestatus#3576 AS cval_lineitem_l_linestatus_1#3621, cval_lineitem_l_commitdate#3577 AS cval_lineitem_l_commitdate_1#3622, cval_lineitem_l_receiptdate#3578 AS cval_lineitem_l_receiptdate_1#3623, cval_lineitem_l_shipinstruct#3579 AS cval_lineitem_l_shipinstruct_1#3624, cval_lineitem_l_shipmode#3580 AS cval_lineitem_l_shipmode_1#3625, cval_lineitem_l_comment#3581 AS cval_lineitem_l_comment_1#3626, cval_lineitem_l_shipdate#3582 AS cval_lineitem_l_shipdate_1#3627, cdepval_lineitem_l_quantity#3583 AS cdepval_lineitem_l_quantity_1#3628, cdepval_lineitem_l_extendedprice#3584 AS cdepval_lineitem_l_extendedprice_1#3629, cdepval_lineitem_l_discount#3585 AS cdepval_lineitem_l_discount_1#3630, ... 21 more fields]
         :  :  :  :        +- Relation[rid#3562,cpfk_orders_lineitem#3563,cpfk_supplier_lineitem#3564,cfpk_lineitem_supplier#3565,cfpk_lineitem_partsupp#3566,cpfk_part_lineitem#3567,cfpk_lineitem_part#3568,cpfk_partsupp_lineitem#3569,cfpk_lineitem_orders#3570,cval_lineitem_l_quantity#3571,cval_lineitem_l_extendedprice#3572,cval_lineitem_l_discount#3573,cval_lineitem_l_tax#3574,cval_lineitem_l_returnflag#3575,cval_lineitem_l_linestatus#3576,cval_lineitem_l_commitdate#3577,cval_lineitem_l_receiptdate#3578,cval_lineitem_l_shipinstruct#3579,cval_lineitem_l_shipmode#3580,cval_lineitem_l_comment#3581,cval_lineitem_l_shipdate#3582,cdepval_lineitem_l_quantity#3583,cdepval_lineitem_l_extendedprice#3584,cdepval_lineitem_l_discount#3585,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- Project [rid#3422 AS rid_1#3467, cpfk_orders_lineitem#3423 AS cpfk_orders_lineitem_1#3468, cpfk_supplier_lineitem#3424 AS cpfk_supplier_lineitem_1#3469, cfpk_lineitem_supplier#3425 AS cfpk_lineitem_supplier_1#3470, cfpk_lineitem_partsupp#3426 AS cfpk_lineitem_partsupp_1#3471, cpfk_part_lineitem#3427 AS cpfk_part_lineitem_1#3472, cfpk_lineitem_part#3428 AS cfpk_lineitem_part_1#3473, cpfk_partsupp_lineitem#3429 AS cpfk_partsupp_lineitem_1#3474, cfpk_lineitem_orders#3430 AS cfpk_lineitem_orders_1#3475, cval_lineitem_l_quantity#3431 AS cval_lineitem_l_quantity_1#3476, cval_lineitem_l_extendedprice#3432 AS cval_lineitem_l_extendedprice_1#3477, cval_lineitem_l_discount#3433 AS cval_lineitem_l_discount_1#3478, cval_lineitem_l_tax#3434 AS cval_lineitem_l_tax_1#3479, cval_lineitem_l_returnflag#3435 AS cval_lineitem_l_returnflag_1#3480, cval_lineitem_l_linestatus#3436 AS cval_lineitem_l_linestatus_1#3481, cval_lineitem_l_commitdate#3437 AS cval_lineitem_l_commitdate_1#3482, cval_lineitem_l_receiptdate#3438 AS cval_lineitem_l_receiptdate_1#3483, cval_lineitem_l_shipinstruct#3439 AS cval_lineitem_l_shipinstruct_1#3484, cval_lineitem_l_shipmode#3440 AS cval_lineitem_l_shipmode_1#3485, cval_lineitem_l_comment#3441 AS cval_lineitem_l_comment_1#3486, cval_lineitem_l_shipdate#3442 AS cval_lineitem_l_shipdate_1#3487, cdepval_lineitem_l_quantity#3443 AS cdepval_lineitem_l_quantity_1#3488, cdepval_lineitem_l_extendedprice#3444 AS cdepval_lineitem_l_extendedprice_1#3489, cdepval_lineitem_l_discount#3445 AS cdepval_lineitem_l_discount_1#3490, ... 21 more fields]
         :  :  :     +- Relation[rid#3422,cpfk_orders_lineitem#3423,cpfk_supplier_lineitem#3424,cfpk_lineitem_supplier#3425,cfpk_lineitem_partsupp#3426,cpfk_part_lineitem#3427,cfpk_lineitem_part#3428,cpfk_partsupp_lineitem#3429,cfpk_lineitem_orders#3430,cval_lineitem_l_quantity#3431,cval_lineitem_l_extendedprice#3432,cval_lineitem_l_discount#3433,cval_lineitem_l_tax#3434,cval_lineitem_l_returnflag#3435,cval_lineitem_l_linestatus#3436,cval_lineitem_l_commitdate#3437,cval_lineitem_l_receiptdate#3438,cval_lineitem_l_shipinstruct#3439,cval_lineitem_l_shipmode#3440,cval_lineitem_l_comment#3441,cval_lineitem_l_shipdate#3442,cdepval_lineitem_l_quantity#3443,cdepval_lineitem_l_extendedprice#3444,cdepval_lineitem_l_discount#3445,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#3652 AS rid_2#3670, cpfk_nation_supplier#3653 AS cpfk_nation_supplier_2#3671, cfpk_supplier_nation#3654 AS cfpk_supplier_nation_2#3672, cval_supplier_s_name#3655 AS cval_supplier_s_name_2#3673, cval_supplier_s_address#3656 AS cval_supplier_s_address_2#3674, cval_supplier_s_phone#3657 AS cval_supplier_s_phone_2#3675, cval_supplier_s_acctbal#3658 AS cval_supplier_s_acctbal_2#3676, cval_supplier_s_comment#3659 AS cval_supplier_s_comment_2#3677, cdepval_supplier_s_name#3660 AS cdepval_supplier_s_name_2#3678, cdepval_supplier_s_address#3661 AS cdepval_supplier_s_address_2#3679, cdepval_supplier_s_phone#3662 AS cdepval_supplier_s_phone_2#3680, cdepval_supplier_s_acctbal#3663 AS cdepval_supplier_s_acctbal_2#3681, cdepval_supplier_s_comment#3664 AS cdepval_supplier_s_comment_2#3682, cs_name#3665 AS cs_name_2#3683, cs_address#3666 AS cs_address_2#3684, cs_phone#3667 AS cs_phone_2#3685, cs_acctbal#3668 AS cs_acctbal_2#3686, cs_comment#3669 AS cs_comment_2#3687]
         :  :     +- Relation[rid#3652,cpfk_nation_supplier#3653,cfpk_supplier_nation#3654,cval_supplier_s_name#3655,cval_supplier_s_address#3656,cval_supplier_s_phone#3657,cval_supplier_s_acctbal#3658,cval_supplier_s_comment#3659,cdepval_supplier_s_name#3660,cdepval_supplier_s_address#3661,cdepval_supplier_s_phone#3662,cdepval_supplier_s_acctbal#3663,cdepval_supplier_s_comment#3664,cs_name#3665,cs_address#3666,cs_phone#3667,cs_acctbal#3668,cs_comment#3669] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#3688 AS rid_3#3697, cpfk_region_nation#3689 AS cpfk_region_nation_3#3698, cfpk_nation_region#3690 AS cfpk_nation_region_3#3699, cval_nation_n_name#3691 AS cval_nation_n_name_3#3700, cval_nation_n_comment#3692 AS cval_nation_n_comment_3#3701, cdepval_nation_n_name#3693 AS cdepval_nation_n_name_3#3702, cdepval_nation_n_comment#3694 AS cdepval_nation_n_comment_3#3703, cn_name#3695 AS cn_name_3#3704, cn_comment#3696 AS cn_comment_3#3705]
         :     +- Relation[rid#3688,cpfk_region_nation#3689,cfpk_nation_region#3690,cval_nation_n_name#3691,cval_nation_n_comment#3692,cdepval_nation_n_name#3693,cdepval_nation_n_comment#3694,cn_name#3695,cn_comment#3696] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#3826 AS rid_7#3850, cpfk_customer_orders#3827 AS cpfk_customer_orders_7#3851, cfpk_orders_customer#3828 AS cfpk_orders_customer_7#3852, cval_orders_o_orderstatus#3829 AS cval_orders_o_orderstatus_7#3853, cval_orders_o_totalprice#3830 AS cval_orders_o_totalprice_7#3854, cval_orders_o_orderpriority#3831 AS cval_orders_o_orderpriority_7#3855, cval_orders_o_clerk#3832 AS cval_orders_o_clerk_7#3856, cval_orders_o_shippriority#3833 AS cval_orders_o_shippriority_7#3857, cval_orders_o_comment#3834 AS cval_orders_o_comment_7#3858, cval_orders_o_orderdate#3835 AS cval_orders_o_orderdate_7#3859, cdepval_orders_o_orderstatus#3836 AS cdepval_orders_o_orderstatus_7#3860, cdepval_orders_o_totalprice#3837 AS cdepval_orders_o_totalprice_7#3861, cdepval_orders_o_orderpriority#3838 AS cdepval_orders_o_orderpriority_7#3862, cdepval_orders_o_clerk#3839 AS cdepval_orders_o_clerk_7#3863, cdepval_orders_o_shippriority#3840 AS cdepval_orders_o_shippriority_7#3864, cdepval_orders_o_comment#3841 AS cdepval_orders_o_comment_7#3865, cdepval_orders_o_orderdate#3842 AS cdepval_orders_o_orderdate_7#3866, co_orderstatus#3843 AS co_orderstatus_7#3867, co_totalprice#3844 AS co_totalprice_7#3868, co_orderpriority#3845 AS co_orderpriority_7#3869, co_clerk#3846 AS co_clerk_7#3870, co_shippriority#3847 AS co_shippriority_7#3871, co_comment#3848 AS co_comment_7#3872, co_orderdate#3849 AS co_orderdate_7#3873]
            :  +- Relation[rid#3826,cpfk_customer_orders#3827,cfpk_orders_customer#3828,cval_orders_o_orderstatus#3829,cval_orders_o_totalprice#3830,cval_orders_o_orderpriority#3831,cval_orders_o_clerk#3832,cval_orders_o_shippriority#3833,cval_orders_o_comment#3834,cval_orders_o_orderdate#3835,cdepval_orders_o_orderstatus#3836,cdepval_orders_o_totalprice#3837,cdepval_orders_o_orderpriority#3838,cdepval_orders_o_clerk#3839,cdepval_orders_o_shippriority#3840,cdepval_orders_o_comment#3841,cdepval_orders_o_orderdate#3842,co_orderstatus#3843,co_totalprice#3844,co_orderpriority#3845,co_clerk#3846,co_shippriority#3847,co_comment#3848,co_orderdate#3849] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#3784 AS rid_6#3805, cpfk_nation_customer#3785 AS cpfk_nation_customer_6#3806, cfpk_customer_nation#3786 AS cfpk_customer_nation_6#3807, cval_customer_c_name#3787 AS cval_customer_c_name_6#3808, cval_customer_c_address#3788 AS cval_customer_c_address_6#3809, cval_customer_c_phone#3789 AS cval_customer_c_phone_6#3810, cval_customer_c_acctbal#3790 AS cval_customer_c_acctbal_6#3811, cval_customer_c_comment#3791 AS cval_customer_c_comment_6#3812, cval_customer_c_mktsegment#3792 AS cval_customer_c_mktsegment_6#3813, cdepval_customer_c_name#3793 AS cdepval_customer_c_name_6#3814, cdepval_customer_c_address#3794 AS cdepval_customer_c_address_6#3815, cdepval_customer_c_phone#3795 AS cdepval_customer_c_phone_6#3816, cdepval_customer_c_acctbal#3796 AS cdepval_customer_c_acctbal_6#3817, cdepval_customer_c_comment#3797 AS cdepval_customer_c_comment_6#3818, cdepval_customer_c_mktsegment#3798 AS cdepval_customer_c_mktsegment_6#3819, cc_name#3799 AS cc_name_6#3820, cc_address#3800 AS cc_address_6#3821, cc_phone#3801 AS cc_phone_6#3822, cc_acctbal#3802 AS cc_acctbal_6#3823, cc_comment#3803 AS cc_comment_6#3824, cc_mktsegment#3804 AS cc_mktsegment_6#3825]
               :  +- Relation[rid#3784,cpfk_nation_customer#3785,cfpk_customer_nation#3786,cval_customer_c_name#3787,cval_customer_c_address#3788,cval_customer_c_phone#3789,cval_customer_c_acctbal#3790,cval_customer_c_comment#3791,cval_customer_c_mktsegment#3792,cdepval_customer_c_name#3793,cdepval_customer_c_address#3794,cdepval_customer_c_phone#3795,cdepval_customer_c_acctbal#3796,cdepval_customer_c_comment#3797,cdepval_customer_c_mktsegment#3798,cc_name#3799,cc_address#3800,cc_phone#3801,cc_acctbal#3802,cc_comment#3803,cc_mktsegment#3804] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join UsingJoin(Inner,List(rid_5))
                  :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_5, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#3713, cval_region_r_name_4#3714, cval_region_r_comment_4#3715, cdepval_region_r_name_4#3716, cdepval_region_r_comment_4#3717, cr_name_4#3718, cr_comment_4#3719, 'rid_5]
                  :  :- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                  :  :  +- Project [rid#3706 AS rid_4#3713, cval_region_r_name#3707 AS cval_region_r_name_4#3714, cval_region_r_comment#3708 AS cval_region_r_comment_4#3715, cdepval_region_r_name#3709 AS cdepval_region_r_name_4#3716, cdepval_region_r_comment#3710 AS cdepval_region_r_comment_4#3717, cr_name#3711 AS cr_name_4#3718, cr_comment#3712 AS cr_comment_4#3719]
                  :  :     +- Relation[rid#3706,cval_region_r_name#3707,cval_region_r_comment#3708,cdepval_region_r_name#3709,cdepval_region_r_comment#3710,cr_name#3711,cr_comment#3712] JDBCRelation(tregion) [numPartitions=1]
                  :  +- 'Project ['cpfk_region_nation_5, 'rid_5]
                  :     +- Project [rid#3766 AS rid_5#3775, cpfk_region_nation#3767 AS cpfk_region_nation_5#3776, cfpk_nation_region#3768 AS cfpk_nation_region_5#3777, cval_nation_n_name#3769 AS cval_nation_n_name_5#3778, cval_nation_n_comment#3770 AS cval_nation_n_comment_5#3779, cdepval_nation_n_name#3771 AS cdepval_nation_n_name_5#3780, cdepval_nation_n_comment#3772 AS cdepval_nation_n_comment_5#3781, cn_name#3773 AS cn_name_5#3782, cn_comment#3774 AS cn_comment_5#3783]
                  :        +- Relation[rid#3766,cpfk_region_nation#3767,cfpk_nation_region#3768,cval_nation_n_name#3769,cval_nation_n_comment#3770,cdepval_nation_n_name#3771,cdepval_nation_n_comment#3772,cn_name#3773,cn_comment#3774] JDBCRelation(tnation) [numPartitions=1]
                  +- Project [rid#3734 AS rid_5#3743, cpfk_region_nation#3735 AS cpfk_region_nation_5#3744, cfpk_nation_region#3736 AS cfpk_nation_region_5#3745, cval_nation_n_name#3737 AS cval_nation_n_name_5#3746, cval_nation_n_comment#3738 AS cval_nation_n_comment_5#3747, cdepval_nation_n_name#3739 AS cdepval_nation_n_name_5#3748, cdepval_nation_n_comment#3740 AS cdepval_nation_n_comment_5#3749, cn_name#3741 AS cn_name_5#3750, cn_comment#3742 AS cn_comment_5#3751]
                     +- Relation[rid#3734,cpfk_region_nation#3735,cfpk_nation_region#3736,cval_nation_n_name#3737,cval_nation_n_comment#3738,cdepval_nation_n_name#3739,cdepval_nation_n_comment#3740,cn_name#3741,cn_comment#3742] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 3262ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 22:08:56 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:08:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4041L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:08:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:08:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:08:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:08:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:08:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:08:56 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:08:56 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:08:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4041L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#4097 AS rid_2#4142, cpfk_orders_lineitem#4098 AS cpfk_orders_lineitem_2#4143, cpfk_supplier_lineitem#4099 AS cpfk_supplier_lineitem_2#4144, cfpk_lineitem_supplier#4100 AS cfpk_lineitem_supplier_2#4145, cfpk_lineitem_partsupp#4101 AS cfpk_lineitem_partsupp_2#4146, cpfk_part_lineitem#4102 AS cpfk_part_lineitem_2#4147, cfpk_lineitem_part#4103 AS cfpk_lineitem_part_2#4148, cpfk_partsupp_lineitem#4104 AS cpfk_partsupp_lineitem_2#4149, cfpk_lineitem_orders#4105 AS cfpk_lineitem_orders_2#4150, cval_lineitem_l_quantity#4106 AS cval_lineitem_l_quantity_2#4151, cval_lineitem_l_extendedprice#4107 AS cval_lineitem_l_extendedprice_2#4152, cval_lineitem_l_discount#4108 AS cval_lineitem_l_discount_2#4153, cval_lineitem_l_tax#4109 AS cval_lineitem_l_tax_2#4154, cval_lineitem_l_returnflag#4110 AS cval_lineitem_l_returnflag_2#4155, cval_lineitem_l_linestatus#4111 AS cval_lineitem_l_linestatus_2#4156, cval_lineitem_l_commitdate#4112 AS cval_lineitem_l_commitdate_2#4157, cval_lineitem_l_receiptdate#4113 AS cval_lineitem_l_receiptdate_2#4158, cval_lineitem_l_shipinstruct#4114 AS cval_lineitem_l_shipinstruct_2#4159, cval_lineitem_l_shipmode#4115 AS cval_lineitem_l_shipmode_2#4160, cval_lineitem_l_comment#4116 AS cval_lineitem_l_comment_2#4161, cval_lineitem_l_shipdate#4117 AS cval_lineitem_l_shipdate_2#4162, cdepval_lineitem_l_quantity#4118 AS cdepval_lineitem_l_quantity_2#4163, cdepval_lineitem_l_extendedprice#4119 AS cdepval_lineitem_l_extendedprice_2#4164, cdepval_lineitem_l_discount#4120 AS cdepval_lineitem_l_discount_2#4165, ... 21 more fields]
         :  :  :  :  +- Relation[rid#4097,cpfk_orders_lineitem#4098,cpfk_supplier_lineitem#4099,cfpk_lineitem_supplier#4100,cfpk_lineitem_partsupp#4101,cpfk_part_lineitem#4102,cfpk_lineitem_part#4103,cpfk_partsupp_lineitem#4104,cfpk_lineitem_orders#4105,cval_lineitem_l_quantity#4106,cval_lineitem_l_extendedprice#4107,cval_lineitem_l_discount#4108,cval_lineitem_l_tax#4109,cval_lineitem_l_returnflag#4110,cval_lineitem_l_linestatus#4111,cval_lineitem_l_commitdate#4112,cval_lineitem_l_receiptdate#4113,cval_lineitem_l_shipinstruct#4114,cval_lineitem_l_shipmode#4115,cval_lineitem_l_comment#4116,cval_lineitem_l_shipdate#4117,cdepval_lineitem_l_quantity#4118,cdepval_lineitem_l_extendedprice#4119,cdepval_lineitem_l_discount#4120,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#4061 AS rid_1#4079, cpfk_nation_supplier#4062 AS cpfk_nation_supplier_1#4080, cfpk_supplier_nation#4063 AS cfpk_supplier_nation_1#4081, cval_supplier_s_name#4064 AS cval_supplier_s_name_1#4082, cval_supplier_s_address#4065 AS cval_supplier_s_address_1#4083, cval_supplier_s_phone#4066 AS cval_supplier_s_phone_1#4084, cval_supplier_s_acctbal#4067 AS cval_supplier_s_acctbal_1#4085, cval_supplier_s_comment#4068 AS cval_supplier_s_comment_1#4086, cdepval_supplier_s_name#4069 AS cdepval_supplier_s_name_1#4087, cdepval_supplier_s_address#4070 AS cdepval_supplier_s_address_1#4088, cdepval_supplier_s_phone#4071 AS cdepval_supplier_s_phone_1#4089, cdepval_supplier_s_acctbal#4072 AS cdepval_supplier_s_acctbal_1#4090, cdepval_supplier_s_comment#4073 AS cdepval_supplier_s_comment_1#4091, cs_name#4074 AS cs_name_1#4092, cs_address#4075 AS cs_address_1#4093, cs_phone#4076 AS cs_phone_1#4094, cs_acctbal#4077 AS cs_acctbal_1#4095, cs_comment#4078 AS cs_comment_1#4096]
         :  :  :     :  +- Relation[rid#4061,cpfk_nation_supplier#4062,cfpk_supplier_nation#4063,cval_supplier_s_name#4064,cval_supplier_s_address#4065,cval_supplier_s_phone#4066,cval_supplier_s_acctbal#4067,cval_supplier_s_comment#4068,cdepval_supplier_s_name#4069,cdepval_supplier_s_address#4070,cdepval_supplier_s_phone#4071,cdepval_supplier_s_acctbal#4072,cdepval_supplier_s_comment#4073,cs_name#4074,cs_address#4075,cs_phone#4076,cs_acctbal#4077,cs_comment#4078] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#4043 AS rid_0#4052, cpfk_region_nation#4044 AS cpfk_region_nation_0#4053, cfpk_nation_region#4045 AS cfpk_nation_region_0#4054, cval_nation_n_name#4046 AS cval_nation_n_name_0#4055, cval_nation_n_comment#4047 AS cval_nation_n_comment_0#4056, cdepval_nation_n_name#4048 AS cdepval_nation_n_name_0#4057, cdepval_nation_n_comment#4049 AS cdepval_nation_n_comment_0#4058, cn_name#4050 AS cn_name_0#4059, cn_comment#4051 AS cn_comment_0#4060]
         :  :  :        +- Relation[rid#4043,cpfk_region_nation#4044,cfpk_nation_region#4045,cval_nation_n_name#4046,cval_nation_n_comment#4047,cdepval_nation_n_name#4048,cdepval_nation_n_comment#4049,cn_name#4050,cn_comment#4051] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#4187 AS rid_3#4212, cval_part_p_name#4188 AS cval_part_p_name_3#4213, cval_part_p_mfgr#4189 AS cval_part_p_mfgr_3#4214, cval_part_p_type#4190 AS cval_part_p_type_3#4215, cval_part_p_size#4191 AS cval_part_p_size_3#4216, cval_part_p_container#4192 AS cval_part_p_container_3#4217, cval_part_p_retailprice#4193 AS cval_part_p_retailprice_3#4218, cval_part_p_comment#4194 AS cval_part_p_comment_3#4219, cval_part_p_brand#4195 AS cval_part_p_brand_3#4220, cdepval_part_p_name#4196 AS cdepval_part_p_name_3#4221, cdepval_part_p_mfgr#4197 AS cdepval_part_p_mfgr_3#4222, cdepval_part_p_type#4198 AS cdepval_part_p_type_3#4223, cdepval_part_p_size#4199 AS cdepval_part_p_size_3#4224, cdepval_part_p_container#4200 AS cdepval_part_p_container_3#4225, cdepval_part_p_retailprice#4201 AS cdepval_part_p_retailprice_3#4226, cdepval_part_p_comment#4202 AS cdepval_part_p_comment_3#4227, cdepval_part_p_brand#4203 AS cdepval_part_p_brand_3#4228, cp_name#4204 AS cp_name_3#4229, cp_mfgr#4205 AS cp_mfgr_3#4230, cp_type#4206 AS cp_type_3#4231, cp_size#4207 AS cp_size_3#4232, cp_container#4208 AS cp_container_3#4233, cp_retailprice#4209 AS cp_retailprice_3#4234, cp_comment#4210 AS cp_comment_3#4235, cp_brand#4211 AS cp_brand_3#4236]
         :  :     +- Relation[rid#4187,cval_part_p_name#4188,cval_part_p_mfgr#4189,cval_part_p_type#4190,cval_part_p_size#4191,cval_part_p_container#4192,cval_part_p_retailprice#4193,cval_part_p_comment#4194,cval_part_p_brand#4195,cdepval_part_p_name#4196,cdepval_part_p_mfgr#4197,cdepval_part_p_type#4198,cdepval_part_p_size#4199,cdepval_part_p_container#4200,cdepval_part_p_retailprice#4201,cdepval_part_p_comment#4202,cdepval_part_p_brand#4203,cp_name#4204,cp_mfgr#4205,cp_type#4206,cp_size#4207,cp_container#4208,cp_retailprice#4209,cp_comment#4210,cp_brand#4211] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#4237 AS rid_4#4251, cpfk_part_partsupp#4238 AS cpfk_part_partsupp_4#4252, cfpk_partsupp_part#4239 AS cfpk_partsupp_part_4#4253, cpfk_supplier_partsupp#4240 AS cpfk_supplier_partsupp_4#4254, cfpk_partsupp_supplier#4241 AS cfpk_partsupp_supplier_4#4255, cval_partsupp_ps_availqty#4242 AS cval_partsupp_ps_availqty_4#4256, cval_partsupp_ps_supplycost#4243 AS cval_partsupp_ps_supplycost_4#4257, cval_partsupp_ps_comment#4244 AS cval_partsupp_ps_comment_4#4258, cdepval_partsupp_ps_availqty#4245 AS cdepval_partsupp_ps_availqty_4#4259, cdepval_partsupp_ps_supplycost#4246 AS cdepval_partsupp_ps_supplycost_4#4260, cdepval_partsupp_ps_comment#4247 AS cdepval_partsupp_ps_comment_4#4261, cps_availqty#4248 AS cps_availqty_4#4262, cps_supplycost#4249 AS cps_supplycost_4#4263, cps_comment#4250 AS cps_comment_4#4264]
         :     +- Relation[rid#4237,cpfk_part_partsupp#4238,cfpk_partsupp_part#4239,cpfk_supplier_partsupp#4240,cfpk_partsupp_supplier#4241,cval_partsupp_ps_availqty#4242,cval_partsupp_ps_supplycost#4243,cval_partsupp_ps_comment#4244,cdepval_partsupp_ps_availqty#4245,cdepval_partsupp_ps_supplycost#4246,cdepval_partsupp_ps_comment#4247,cps_availqty#4248,cps_supplycost#4249,cps_comment#4250] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#4265 AS rid_5#4289, cpfk_customer_orders#4266 AS cpfk_customer_orders_5#4290, cfpk_orders_customer#4267 AS cfpk_orders_customer_5#4291, cval_orders_o_orderstatus#4268 AS cval_orders_o_orderstatus_5#4292, cval_orders_o_totalprice#4269 AS cval_orders_o_totalprice_5#4293, cval_orders_o_orderpriority#4270 AS cval_orders_o_orderpriority_5#4294, cval_orders_o_clerk#4271 AS cval_orders_o_clerk_5#4295, cval_orders_o_shippriority#4272 AS cval_orders_o_shippriority_5#4296, cval_orders_o_comment#4273 AS cval_orders_o_comment_5#4297, cval_orders_o_orderdate#4274 AS cval_orders_o_orderdate_5#4298, cdepval_orders_o_orderstatus#4275 AS cdepval_orders_o_orderstatus_5#4299, cdepval_orders_o_totalprice#4276 AS cdepval_orders_o_totalprice_5#4300, cdepval_orders_o_orderpriority#4277 AS cdepval_orders_o_orderpriority_5#4301, cdepval_orders_o_clerk#4278 AS cdepval_orders_o_clerk_5#4302, cdepval_orders_o_shippriority#4279 AS cdepval_orders_o_shippriority_5#4303, cdepval_orders_o_comment#4280 AS cdepval_orders_o_comment_5#4304, cdepval_orders_o_orderdate#4281 AS cdepval_orders_o_orderdate_5#4305, co_orderstatus#4282 AS co_orderstatus_5#4306, co_totalprice#4283 AS co_totalprice_5#4307, co_orderpriority#4284 AS co_orderpriority_5#4308, co_clerk#4285 AS co_clerk_5#4309, co_shippriority#4286 AS co_shippriority_5#4310, co_comment#4287 AS co_comment_5#4311, co_orderdate#4288 AS co_orderdate_5#4312]
            +- Relation[rid#4265,cpfk_customer_orders#4266,cfpk_orders_customer#4267,cval_orders_o_orderstatus#4268,cval_orders_o_totalprice#4269,cval_orders_o_orderpriority#4270,cval_orders_o_clerk#4271,cval_orders_o_shippriority#4272,cval_orders_o_comment#4273,cval_orders_o_orderdate#4274,cdepval_orders_o_orderstatus#4275,cdepval_orders_o_totalprice#4276,cdepval_orders_o_orderpriority#4277,cdepval_orders_o_clerk#4278,cdepval_orders_o_shippriority#4279,cdepval_orders_o_comment#4280,cdepval_orders_o_orderdate#4281,co_orderstatus#4282,co_totalprice#4283,co_orderpriority#4284,co_clerk#4285,co_shippriority#4286,co_comment#4287,co_orderdate#4288] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 62665ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/26 22:09:59 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:09:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4456L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:09:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:09:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:09:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:09:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:09:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:09:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:09:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:09:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:09:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:09:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:09:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:09:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:09:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:09:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:09:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4456L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#4584 AS rid_2#4629, cpfk_orders_lineitem#4585 AS cpfk_orders_lineitem_2#4630, cpfk_supplier_lineitem#4586 AS cpfk_supplier_lineitem_2#4631, cfpk_lineitem_supplier#4587 AS cfpk_lineitem_supplier_2#4632, cfpk_lineitem_partsupp#4588 AS cfpk_lineitem_partsupp_2#4633, cpfk_part_lineitem#4589 AS cpfk_part_lineitem_2#4634, cfpk_lineitem_part#4590 AS cfpk_lineitem_part_2#4635, cpfk_partsupp_lineitem#4591 AS cpfk_partsupp_lineitem_2#4636, cfpk_lineitem_orders#4592 AS cfpk_lineitem_orders_2#4637, cval_lineitem_l_quantity#4593 AS cval_lineitem_l_quantity_2#4638, cval_lineitem_l_extendedprice#4594 AS cval_lineitem_l_extendedprice_2#4639, cval_lineitem_l_discount#4595 AS cval_lineitem_l_discount_2#4640, cval_lineitem_l_tax#4596 AS cval_lineitem_l_tax_2#4641, cval_lineitem_l_returnflag#4597 AS cval_lineitem_l_returnflag_2#4642, cval_lineitem_l_linestatus#4598 AS cval_lineitem_l_linestatus_2#4643, cval_lineitem_l_commitdate#4599 AS cval_lineitem_l_commitdate_2#4644, cval_lineitem_l_receiptdate#4600 AS cval_lineitem_l_receiptdate_2#4645, cval_lineitem_l_shipinstruct#4601 AS cval_lineitem_l_shipinstruct_2#4646, cval_lineitem_l_shipmode#4602 AS cval_lineitem_l_shipmode_2#4647, cval_lineitem_l_comment#4603 AS cval_lineitem_l_comment_2#4648, cval_lineitem_l_shipdate#4604 AS cval_lineitem_l_shipdate_2#4649, cdepval_lineitem_l_quantity#4605 AS cdepval_lineitem_l_quantity_2#4650, cdepval_lineitem_l_extendedprice#4606 AS cdepval_lineitem_l_extendedprice_2#4651, cdepval_lineitem_l_discount#4607 AS cdepval_lineitem_l_discount_2#4652, ... 21 more fields]
         :  :  +- Relation[rid#4584,cpfk_orders_lineitem#4585,cpfk_supplier_lineitem#4586,cfpk_lineitem_supplier#4587,cfpk_lineitem_partsupp#4588,cpfk_part_lineitem#4589,cfpk_lineitem_part#4590,cpfk_partsupp_lineitem#4591,cfpk_lineitem_orders#4592,cval_lineitem_l_quantity#4593,cval_lineitem_l_extendedprice#4594,cval_lineitem_l_discount#4595,cval_lineitem_l_tax#4596,cval_lineitem_l_returnflag#4597,cval_lineitem_l_linestatus#4598,cval_lineitem_l_commitdate#4599,cval_lineitem_l_receiptdate#4600,cval_lineitem_l_shipinstruct#4601,cval_lineitem_l_shipmode#4602,cval_lineitem_l_comment#4603,cval_lineitem_l_shipdate#4604,cdepval_lineitem_l_quantity#4605,cdepval_lineitem_l_extendedprice#4606,cdepval_lineitem_l_discount#4607,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join UsingJoin(Inner,List(rid_1))
         :     :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#4467, cpfk_region_nation_0#4468, cfpk_nation_region_0#4469, cval_nation_n_name_0#4470, cval_nation_n_comment_0#4471, cdepval_nation_n_name_0#4472, cdepval_nation_n_comment_0#4473, cn_name_0#4474, cn_comment_0#4475, 'rid_1]
         :     :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :     :  :  +- Project [rid#4458 AS rid_0#4467, cpfk_region_nation#4459 AS cpfk_region_nation_0#4468, cfpk_nation_region#4460 AS cfpk_nation_region_0#4469, cval_nation_n_name#4461 AS cval_nation_n_name_0#4470, cval_nation_n_comment#4462 AS cval_nation_n_comment_0#4471, cdepval_nation_n_name#4463 AS cdepval_nation_n_name_0#4472, cdepval_nation_n_comment#4464 AS cdepval_nation_n_comment_0#4473, cn_name#4465 AS cn_name_0#4474, cn_comment#4466 AS cn_comment_0#4475]
         :     :  :     +- Relation[rid#4458,cpfk_region_nation#4459,cfpk_nation_region#4460,cval_nation_n_name#4461,cval_nation_n_comment#4462,cdepval_nation_n_name#4463,cdepval_nation_n_comment#4464,cn_name#4465,cn_comment#4466] JDBCRelation(tnation) [numPartitions=1]
         :     :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
         :     :     +- Project [rid#4548 AS rid_1#4566, cpfk_nation_supplier#4549 AS cpfk_nation_supplier_1#4567, cfpk_supplier_nation#4550 AS cfpk_supplier_nation_1#4568, cval_supplier_s_name#4551 AS cval_supplier_s_name_1#4569, cval_supplier_s_address#4552 AS cval_supplier_s_address_1#4570, cval_supplier_s_phone#4553 AS cval_supplier_s_phone_1#4571, cval_supplier_s_acctbal#4554 AS cval_supplier_s_acctbal_1#4572, cval_supplier_s_comment#4555 AS cval_supplier_s_comment_1#4573, cdepval_supplier_s_name#4556 AS cdepval_supplier_s_name_1#4574, cdepval_supplier_s_address#4557 AS cdepval_supplier_s_address_1#4575, cdepval_supplier_s_phone#4558 AS cdepval_supplier_s_phone_1#4576, cdepval_supplier_s_acctbal#4559 AS cdepval_supplier_s_acctbal_1#4577, cdepval_supplier_s_comment#4560 AS cdepval_supplier_s_comment_1#4578, cs_name#4561 AS cs_name_1#4579, cs_address#4562 AS cs_address_1#4580, cs_phone#4563 AS cs_phone_1#4581, cs_acctbal#4564 AS cs_acctbal_1#4582, cs_comment#4565 AS cs_comment_1#4583]
         :     :        +- Relation[rid#4548,cpfk_nation_supplier#4549,cfpk_supplier_nation#4550,cval_supplier_s_name#4551,cval_supplier_s_address#4552,cval_supplier_s_phone#4553,cval_supplier_s_acctbal#4554,cval_supplier_s_comment#4555,cdepval_supplier_s_name#4556,cdepval_supplier_s_address#4557,cdepval_supplier_s_phone#4558,cdepval_supplier_s_acctbal#4559,cdepval_supplier_s_comment#4560,cs_name#4561,cs_address#4562,cs_phone#4563,cs_acctbal#4564,cs_comment#4565] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#4494 AS rid_1#4512, cpfk_nation_supplier#4495 AS cpfk_nation_supplier_1#4513, cfpk_supplier_nation#4496 AS cfpk_supplier_nation_1#4514, cval_supplier_s_name#4497 AS cval_supplier_s_name_1#4515, cval_supplier_s_address#4498 AS cval_supplier_s_address_1#4516, cval_supplier_s_phone#4499 AS cval_supplier_s_phone_1#4517, cval_supplier_s_acctbal#4500 AS cval_supplier_s_acctbal_1#4518, cval_supplier_s_comment#4501 AS cval_supplier_s_comment_1#4519, cdepval_supplier_s_name#4502 AS cdepval_supplier_s_name_1#4520, cdepval_supplier_s_address#4503 AS cdepval_supplier_s_address_1#4521, cdepval_supplier_s_phone#4504 AS cdepval_supplier_s_phone_1#4522, cdepval_supplier_s_acctbal#4505 AS cdepval_supplier_s_acctbal_1#4523, cdepval_supplier_s_comment#4506 AS cdepval_supplier_s_comment_1#4524, cs_name#4507 AS cs_name_1#4525, cs_address#4508 AS cs_address_1#4526, cs_phone#4509 AS cs_phone_1#4527, cs_acctbal#4510 AS cs_acctbal_1#4528, cs_comment#4511 AS cs_comment_1#4529]
         :        +- Relation[rid#4494,cpfk_nation_supplier#4495,cfpk_supplier_nation#4496,cval_supplier_s_name#4497,cval_supplier_s_address#4498,cval_supplier_s_phone#4499,cval_supplier_s_acctbal#4500,cval_supplier_s_comment#4501,cdepval_supplier_s_name#4502,cdepval_supplier_s_address#4503,cdepval_supplier_s_phone#4504,cdepval_supplier_s_acctbal#4505,cdepval_supplier_s_comment#4506,cs_name#4507,cs_address#4508,cs_phone#4509,cs_acctbal#4510,cs_comment#4511] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#4812 AS rid_5#4836, cpfk_customer_orders#4813 AS cpfk_customer_orders_5#4837, cfpk_orders_customer#4814 AS cfpk_orders_customer_5#4838, cval_orders_o_orderstatus#4815 AS cval_orders_o_orderstatus_5#4839, cval_orders_o_totalprice#4816 AS cval_orders_o_totalprice_5#4840, cval_orders_o_orderpriority#4817 AS cval_orders_o_orderpriority_5#4841, cval_orders_o_clerk#4818 AS cval_orders_o_clerk_5#4842, cval_orders_o_shippriority#4819 AS cval_orders_o_shippriority_5#4843, cval_orders_o_comment#4820 AS cval_orders_o_comment_5#4844, cval_orders_o_orderdate#4821 AS cval_orders_o_orderdate_5#4845, cdepval_orders_o_orderstatus#4822 AS cdepval_orders_o_orderstatus_5#4846, cdepval_orders_o_totalprice#4823 AS cdepval_orders_o_totalprice_5#4847, cdepval_orders_o_orderpriority#4824 AS cdepval_orders_o_orderpriority_5#4848, cdepval_orders_o_clerk#4825 AS cdepval_orders_o_clerk_5#4849, cdepval_orders_o_shippriority#4826 AS cdepval_orders_o_shippriority_5#4850, cdepval_orders_o_comment#4827 AS cdepval_orders_o_comment_5#4851, cdepval_orders_o_orderdate#4828 AS cdepval_orders_o_orderdate_5#4852, co_orderstatus#4829 AS co_orderstatus_5#4853, co_totalprice#4830 AS co_totalprice_5#4854, co_orderpriority#4831 AS co_orderpriority_5#4855, co_clerk#4832 AS co_clerk_5#4856, co_shippriority#4833 AS co_shippriority_5#4857, co_comment#4834 AS co_comment_5#4858, co_orderdate#4835 AS co_orderdate_5#4859]
            :  +- Relation[rid#4812,cpfk_customer_orders#4813,cfpk_orders_customer#4814,cval_orders_o_orderstatus#4815,cval_orders_o_totalprice#4816,cval_orders_o_orderpriority#4817,cval_orders_o_clerk#4818,cval_orders_o_shippriority#4819,cval_orders_o_comment#4820,cval_orders_o_orderdate#4821,cdepval_orders_o_orderstatus#4822,cdepval_orders_o_totalprice#4823,cdepval_orders_o_orderpriority#4824,cdepval_orders_o_clerk#4825,cdepval_orders_o_shippriority#4826,cdepval_orders_o_comment#4827,cdepval_orders_o_orderdate#4828,co_orderstatus#4829,co_totalprice#4830,co_orderpriority#4831,co_clerk#4832,co_shippriority#4833,co_comment#4834,co_orderdate#4835] JDBCRelation(torders) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_4))
               :- 'DexPkfkMaterializationAwareJoin nation~customer, 'cpfk_nation_customer_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#4683, cpfk_region_nation_3#4684, cfpk_nation_region_3#4685, cval_nation_n_name_3#4686, cval_nation_n_comment_3#4687, cdepval_nation_n_name_3#4688, cdepval_nation_n_comment_3#4689, cn_name_3#4690, cn_comment_3#4691, 'rid_4]
               :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
               :  :  +- Project [rid#4674 AS rid_3#4683, cpfk_region_nation#4675 AS cpfk_region_nation_3#4684, cfpk_nation_region#4676 AS cfpk_nation_region_3#4685, cval_nation_n_name#4677 AS cval_nation_n_name_3#4686, cval_nation_n_comment#4678 AS cval_nation_n_comment_3#4687, cdepval_nation_n_name#4679 AS cdepval_nation_n_name_3#4688, cdepval_nation_n_comment#4680 AS cdepval_nation_n_comment_3#4689, cn_name#4681 AS cn_name_3#4690, cn_comment#4682 AS cn_comment_3#4691]
               :  :     +- Relation[rid#4674,cpfk_region_nation#4675,cfpk_nation_region#4676,cval_nation_n_name#4677,cval_nation_n_comment#4678,cdepval_nation_n_name#4679,cdepval_nation_n_comment#4680,cn_name#4681,cn_comment#4682] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'Project ['cpfk_nation_customer_4, 'rid_4]
               :     +- Project [rid#4770 AS rid_4#4791, cpfk_nation_customer#4771 AS cpfk_nation_customer_4#4792, cfpk_customer_nation#4772 AS cfpk_customer_nation_4#4793, cval_customer_c_name#4773 AS cval_customer_c_name_4#4794, cval_customer_c_address#4774 AS cval_customer_c_address_4#4795, cval_customer_c_phone#4775 AS cval_customer_c_phone_4#4796, cval_customer_c_acctbal#4776 AS cval_customer_c_acctbal_4#4797, cval_customer_c_comment#4777 AS cval_customer_c_comment_4#4798, cval_customer_c_mktsegment#4778 AS cval_customer_c_mktsegment_4#4799, cdepval_customer_c_name#4779 AS cdepval_customer_c_name_4#4800, cdepval_customer_c_address#4780 AS cdepval_customer_c_address_4#4801, cdepval_customer_c_phone#4781 AS cdepval_customer_c_phone_4#4802, cdepval_customer_c_acctbal#4782 AS cdepval_customer_c_acctbal_4#4803, cdepval_customer_c_comment#4783 AS cdepval_customer_c_comment_4#4804, cdepval_customer_c_mktsegment#4784 AS cdepval_customer_c_mktsegment_4#4805, cc_name#4785 AS cc_name_4#4806, cc_address#4786 AS cc_address_4#4807, cc_phone#4787 AS cc_phone_4#4808, cc_acctbal#4788 AS cc_acctbal_4#4809, cc_comment#4789 AS cc_comment_4#4810, cc_mktsegment#4790 AS cc_mktsegment_4#4811]
               :        +- Relation[rid#4770,cpfk_nation_customer#4771,cfpk_customer_nation#4772,cval_customer_c_name#4773,cval_customer_c_address#4774,cval_customer_c_phone#4775,cval_customer_c_acctbal#4776,cval_customer_c_comment#4777,cval_customer_c_mktsegment#4778,cdepval_customer_c_name#4779,cdepval_customer_c_address#4780,cdepval_customer_c_phone#4781,cdepval_customer_c_acctbal#4782,cdepval_customer_c_comment#4783,cdepval_customer_c_mktsegment#4784,cc_name#4785,cc_address#4786,cc_phone#4787,cc_acctbal#4788,cc_comment#4789,cc_mktsegment#4790] JDBCRelation(tcustomer) [numPartitions=1]
               +- Project [rid#4710 AS rid_4#4731, cpfk_nation_customer#4711 AS cpfk_nation_customer_4#4732, cfpk_customer_nation#4712 AS cfpk_customer_nation_4#4733, cval_customer_c_name#4713 AS cval_customer_c_name_4#4734, cval_customer_c_address#4714 AS cval_customer_c_address_4#4735, cval_customer_c_phone#4715 AS cval_customer_c_phone_4#4736, cval_customer_c_acctbal#4716 AS cval_customer_c_acctbal_4#4737, cval_customer_c_comment#4717 AS cval_customer_c_comment_4#4738, cval_customer_c_mktsegment#4718 AS cval_customer_c_mktsegment_4#4739, cdepval_customer_c_name#4719 AS cdepval_customer_c_name_4#4740, cdepval_customer_c_address#4720 AS cdepval_customer_c_address_4#4741, cdepval_customer_c_phone#4721 AS cdepval_customer_c_phone_4#4742, cdepval_customer_c_acctbal#4722 AS cdepval_customer_c_acctbal_4#4743, cdepval_customer_c_comment#4723 AS cdepval_customer_c_comment_4#4744, cdepval_customer_c_mktsegment#4724 AS cdepval_customer_c_mktsegment_4#4745, cc_name#4725 AS cc_name_4#4746, cc_address#4726 AS cc_address_4#4747, cc_phone#4727 AS cc_phone_4#4748, cc_acctbal#4728 AS cc_acctbal_4#4749, cc_comment#4729 AS cc_comment_4#4750, cc_mktsegment#4730 AS cc_mktsegment_4#4751]
                  +- Relation[rid#4710,cpfk_nation_customer#4711,cfpk_customer_nation#4712,cval_customer_c_name#4713,cval_customer_c_address#4714,cval_customer_c_phone#4715,cval_customer_c_acctbal#4716,cval_customer_c_comment#4717,cval_customer_c_mktsegment#4718,cdepval_customer_c_name#4719,cdepval_customer_c_address#4720,cdepval_customer_c_phone#4721,cdepval_customer_c_acctbal#4722,cdepval_customer_c_comment#4723,cdepval_customer_c_mktsegment#4724,cc_name#4725,cc_address#4726,cc_phone#4727,cc_acctbal#4728,cc_comment#4729,cc_mktsegment#4730] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 39944ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/26 22:10:39 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:10:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4990L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:10:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4990L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#4992 AS rid_0#5037, cpfk_orders_lineitem#4993 AS cpfk_orders_lineitem_0#5038, cpfk_supplier_lineitem#4994 AS cpfk_supplier_lineitem_0#5039, cfpk_lineitem_supplier#4995 AS cfpk_lineitem_supplier_0#5040, cfpk_lineitem_partsupp#4996 AS cfpk_lineitem_partsupp_0#5041, cpfk_part_lineitem#4997 AS cpfk_part_lineitem_0#5042, cfpk_lineitem_part#4998 AS cfpk_lineitem_part_0#5043, cpfk_partsupp_lineitem#4999 AS cpfk_partsupp_lineitem_0#5044, cfpk_lineitem_orders#5000 AS cfpk_lineitem_orders_0#5045, cval_lineitem_l_quantity#5001 AS cval_lineitem_l_quantity_0#5046, cval_lineitem_l_extendedprice#5002 AS cval_lineitem_l_extendedprice_0#5047, cval_lineitem_l_discount#5003 AS cval_lineitem_l_discount_0#5048, cval_lineitem_l_tax#5004 AS cval_lineitem_l_tax_0#5049, cval_lineitem_l_returnflag#5005 AS cval_lineitem_l_returnflag_0#5050, cval_lineitem_l_linestatus#5006 AS cval_lineitem_l_linestatus_0#5051, cval_lineitem_l_commitdate#5007 AS cval_lineitem_l_commitdate_0#5052, cval_lineitem_l_receiptdate#5008 AS cval_lineitem_l_receiptdate_0#5053, cval_lineitem_l_shipinstruct#5009 AS cval_lineitem_l_shipinstruct_0#5054, cval_lineitem_l_shipmode#5010 AS cval_lineitem_l_shipmode_0#5055, cval_lineitem_l_comment#5011 AS cval_lineitem_l_comment_0#5056, cval_lineitem_l_shipdate#5012 AS cval_lineitem_l_shipdate_0#5057, cdepval_lineitem_l_quantity#5013 AS cdepval_lineitem_l_quantity_0#5058, cdepval_lineitem_l_extendedprice#5014 AS cdepval_lineitem_l_extendedprice_0#5059, cdepval_lineitem_l_discount#5015 AS cdepval_lineitem_l_discount_0#5060, ... 21 more fields]
         :     +- Relation[rid#4992,cpfk_orders_lineitem#4993,cpfk_supplier_lineitem#4994,cfpk_lineitem_supplier#4995,cfpk_lineitem_partsupp#4996,cpfk_part_lineitem#4997,cfpk_lineitem_part#4998,cpfk_partsupp_lineitem#4999,cfpk_lineitem_orders#5000,cval_lineitem_l_quantity#5001,cval_lineitem_l_extendedprice#5002,cval_lineitem_l_discount#5003,cval_lineitem_l_tax#5004,cval_lineitem_l_returnflag#5005,cval_lineitem_l_linestatus#5006,cval_lineitem_l_commitdate#5007,cval_lineitem_l_receiptdate#5008,cval_lineitem_l_shipinstruct#5009,cval_lineitem_l_shipmode#5010,cval_lineitem_l_comment#5011,cval_lineitem_l_shipdate#5012,cdepval_lineitem_l_quantity#5013,cdepval_lineitem_l_extendedprice#5014,cdepval_lineitem_l_discount#5015,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5172 AS rid_1#5196, cpfk_customer_orders#5173 AS cpfk_customer_orders_1#5197, cfpk_orders_customer#5174 AS cfpk_orders_customer_1#5198, cval_orders_o_orderstatus#5175 AS cval_orders_o_orderstatus_1#5199, cval_orders_o_totalprice#5176 AS cval_orders_o_totalprice_1#5200, cval_orders_o_orderpriority#5177 AS cval_orders_o_orderpriority_1#5201, cval_orders_o_clerk#5178 AS cval_orders_o_clerk_1#5202, cval_orders_o_shippriority#5179 AS cval_orders_o_shippriority_1#5203, cval_orders_o_comment#5180 AS cval_orders_o_comment_1#5204, cval_orders_o_orderdate#5181 AS cval_orders_o_orderdate_1#5205, cdepval_orders_o_orderstatus#5182 AS cdepval_orders_o_orderstatus_1#5206, cdepval_orders_o_totalprice#5183 AS cdepval_orders_o_totalprice_1#5207, cdepval_orders_o_orderpriority#5184 AS cdepval_orders_o_orderpriority_1#5208, cdepval_orders_o_clerk#5185 AS cdepval_orders_o_clerk_1#5209, cdepval_orders_o_shippriority#5186 AS cdepval_orders_o_shippriority_1#5210, cdepval_orders_o_comment#5187 AS cdepval_orders_o_comment_1#5211, cdepval_orders_o_orderdate#5188 AS cdepval_orders_o_orderdate_1#5212, co_orderstatus#5189 AS co_orderstatus_1#5213, co_totalprice#5190 AS co_totalprice_1#5214, co_orderpriority#5191 AS co_orderpriority_1#5215, co_clerk#5192 AS co_clerk_1#5216, co_shippriority#5193 AS co_shippriority_1#5217, co_comment#5194 AS co_comment_1#5218, co_orderdate#5195 AS co_orderdate_1#5219]
            +- Relation[rid#5172,cpfk_customer_orders#5173,cfpk_orders_customer#5174,cval_orders_o_orderstatus#5175,cval_orders_o_totalprice#5176,cval_orders_o_orderpriority#5177,cval_orders_o_clerk#5178,cval_orders_o_shippriority#5179,cval_orders_o_comment#5180,cval_orders_o_orderdate#5181,cdepval_orders_o_orderstatus#5182,cdepval_orders_o_totalprice#5183,cdepval_orders_o_orderpriority#5184,cdepval_orders_o_clerk#5185,cdepval_orders_o_shippriority#5186,cdepval_orders_o_comment#5187,cdepval_orders_o_orderdate#5188,co_orderstatus#5189,co_totalprice#5190,co_orderpriority#5191,co_clerk#5192,co_shippriority#5193,co_comment#5194,co_orderdate#5195] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 22337ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/26 22:11:01 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:11:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5317L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:11:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5317L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#5319 AS rid_0#5364, cpfk_orders_lineitem#5320 AS cpfk_orders_lineitem_0#5365, cpfk_supplier_lineitem#5321 AS cpfk_supplier_lineitem_0#5366, cfpk_lineitem_supplier#5322 AS cfpk_lineitem_supplier_0#5367, cfpk_lineitem_partsupp#5323 AS cfpk_lineitem_partsupp_0#5368, cpfk_part_lineitem#5324 AS cpfk_part_lineitem_0#5369, cfpk_lineitem_part#5325 AS cfpk_lineitem_part_0#5370, cpfk_partsupp_lineitem#5326 AS cpfk_partsupp_lineitem_0#5371, cfpk_lineitem_orders#5327 AS cfpk_lineitem_orders_0#5372, cval_lineitem_l_quantity#5328 AS cval_lineitem_l_quantity_0#5373, cval_lineitem_l_extendedprice#5329 AS cval_lineitem_l_extendedprice_0#5374, cval_lineitem_l_discount#5330 AS cval_lineitem_l_discount_0#5375, cval_lineitem_l_tax#5331 AS cval_lineitem_l_tax_0#5376, cval_lineitem_l_returnflag#5332 AS cval_lineitem_l_returnflag_0#5377, cval_lineitem_l_linestatus#5333 AS cval_lineitem_l_linestatus_0#5378, cval_lineitem_l_commitdate#5334 AS cval_lineitem_l_commitdate_0#5379, cval_lineitem_l_receiptdate#5335 AS cval_lineitem_l_receiptdate_0#5380, cval_lineitem_l_shipinstruct#5336 AS cval_lineitem_l_shipinstruct_0#5381, cval_lineitem_l_shipmode#5337 AS cval_lineitem_l_shipmode_0#5382, cval_lineitem_l_comment#5338 AS cval_lineitem_l_comment_0#5383, cval_lineitem_l_shipdate#5339 AS cval_lineitem_l_shipdate_0#5384, cdepval_lineitem_l_quantity#5340 AS cdepval_lineitem_l_quantity_0#5385, cdepval_lineitem_l_extendedprice#5341 AS cdepval_lineitem_l_extendedprice_0#5386, cdepval_lineitem_l_discount#5342 AS cdepval_lineitem_l_discount_0#5387, ... 21 more fields]
         :  +- Relation[rid#5319,cpfk_orders_lineitem#5320,cpfk_supplier_lineitem#5321,cfpk_lineitem_supplier#5322,cfpk_lineitem_partsupp#5323,cpfk_part_lineitem#5324,cfpk_lineitem_part#5325,cpfk_partsupp_lineitem#5326,cfpk_lineitem_orders#5327,cval_lineitem_l_quantity#5328,cval_lineitem_l_extendedprice#5329,cval_lineitem_l_discount#5330,cval_lineitem_l_tax#5331,cval_lineitem_l_returnflag#5332,cval_lineitem_l_linestatus#5333,cval_lineitem_l_commitdate#5334,cval_lineitem_l_receiptdate#5335,cval_lineitem_l_shipinstruct#5336,cval_lineitem_l_shipmode#5337,cval_lineitem_l_comment#5338,cval_lineitem_l_shipdate#5339,cdepval_lineitem_l_quantity#5340,cdepval_lineitem_l_extendedprice#5341,cdepval_lineitem_l_discount#5342,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5409 AS rid_1#5433, cpfk_customer_orders#5410 AS cpfk_customer_orders_1#5434, cfpk_orders_customer#5411 AS cfpk_orders_customer_1#5435, cval_orders_o_orderstatus#5412 AS cval_orders_o_orderstatus_1#5436, cval_orders_o_totalprice#5413 AS cval_orders_o_totalprice_1#5437, cval_orders_o_orderpriority#5414 AS cval_orders_o_orderpriority_1#5438, cval_orders_o_clerk#5415 AS cval_orders_o_clerk_1#5439, cval_orders_o_shippriority#5416 AS cval_orders_o_shippriority_1#5440, cval_orders_o_comment#5417 AS cval_orders_o_comment_1#5441, cval_orders_o_orderdate#5418 AS cval_orders_o_orderdate_1#5442, cdepval_orders_o_orderstatus#5419 AS cdepval_orders_o_orderstatus_1#5443, cdepval_orders_o_totalprice#5420 AS cdepval_orders_o_totalprice_1#5444, cdepval_orders_o_orderpriority#5421 AS cdepval_orders_o_orderpriority_1#5445, cdepval_orders_o_clerk#5422 AS cdepval_orders_o_clerk_1#5446, cdepval_orders_o_shippriority#5423 AS cdepval_orders_o_shippriority_1#5447, cdepval_orders_o_comment#5424 AS cdepval_orders_o_comment_1#5448, cdepval_orders_o_orderdate#5425 AS cdepval_orders_o_orderdate_1#5449, co_orderstatus#5426 AS co_orderstatus_1#5450, co_totalprice#5427 AS co_totalprice_1#5451, co_orderpriority#5428 AS co_orderpriority_1#5452, co_clerk#5429 AS co_clerk_1#5453, co_shippriority#5430 AS co_shippriority_1#5454, co_comment#5431 AS co_comment_1#5455, co_orderdate#5432 AS co_orderdate_1#5456]
            +- Relation[rid#5409,cpfk_customer_orders#5410,cfpk_orders_customer#5411,cval_orders_o_orderstatus#5412,cval_orders_o_totalprice#5413,cval_orders_o_orderpriority#5414,cval_orders_o_clerk#5415,cval_orders_o_shippriority#5416,cval_orders_o_comment#5417,cval_orders_o_orderdate#5418,cdepval_orders_o_orderstatus#5419,cdepval_orders_o_totalprice#5420,cdepval_orders_o_orderpriority#5421,cdepval_orders_o_clerk#5422,cdepval_orders_o_shippriority#5423,cdepval_orders_o_comment#5424,cdepval_orders_o_orderdate#5425,co_orderstatus#5426,co_totalprice#5427,co_orderpriority#5428,co_clerk#5429,co_shippriority#5430,co_comment#5431,co_orderdate#5432] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18274ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/26 22:11:19 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:11:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5531L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 22:11:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:11:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:11:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:11:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:11:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:11:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:11:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:11:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:11:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:11:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:11:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:11:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:11:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:11:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5531L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#5558, cval_part_p_name_0#5559, cval_part_p_mfgr_0#5560, cval_part_p_type_0#5561, cval_part_p_size_0#5562, cval_part_p_container_0#5563, cval_part_p_retailprice_0#5564, cval_part_p_comment_0#5565, cval_part_p_brand_0#5566, cdepval_part_p_name_0#5567, cdepval_part_p_mfgr_0#5568, cdepval_part_p_type_0#5569, cdepval_part_p_size_0#5570, cdepval_part_p_container_0#5571, cdepval_part_p_retailprice_0#5572, cdepval_part_p_comment_0#5573, cdepval_part_p_brand_0#5574, cp_name_0#5575, cp_mfgr_0#5576, cp_type_0#5577, cp_size_0#5578, cp_container_0#5579, cp_retailprice_0#5580, cp_comment_0#5581, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  :  +- Project [rid#5533 AS rid_0#5558, cval_part_p_name#5534 AS cval_part_p_name_0#5559, cval_part_p_mfgr#5535 AS cval_part_p_mfgr_0#5560, cval_part_p_type#5536 AS cval_part_p_type_0#5561, cval_part_p_size#5537 AS cval_part_p_size_0#5562, cval_part_p_container#5538 AS cval_part_p_container_0#5563, cval_part_p_retailprice#5539 AS cval_part_p_retailprice_0#5564, cval_part_p_comment#5540 AS cval_part_p_comment_0#5565, cval_part_p_brand#5541 AS cval_part_p_brand_0#5566, cdepval_part_p_name#5542 AS cdepval_part_p_name_0#5567, cdepval_part_p_mfgr#5543 AS cdepval_part_p_mfgr_0#5568, cdepval_part_p_type#5544 AS cdepval_part_p_type_0#5569, cdepval_part_p_size#5545 AS cdepval_part_p_size_0#5570, cdepval_part_p_container#5546 AS cdepval_part_p_container_0#5571, cdepval_part_p_retailprice#5547 AS cdepval_part_p_retailprice_0#5572, cdepval_part_p_comment#5548 AS cdepval_part_p_comment_0#5573, cdepval_part_p_brand#5549 AS cdepval_part_p_brand_0#5574, cp_name#5550 AS cp_name_0#5575, cp_mfgr#5551 AS cp_mfgr_0#5576, cp_type#5552 AS cp_type_0#5577, cp_size#5553 AS cp_size_0#5578, cp_container#5554 AS cp_container_0#5579, cp_retailprice#5555 AS cp_retailprice_0#5580, cp_comment#5556 AS cp_comment_0#5581, cp_brand#5557 AS cp_brand_0#5582]
         :  :  :     +- Relation[rid#5533,cval_part_p_name#5534,cval_part_p_mfgr#5535,cval_part_p_type#5536,cval_part_p_size#5537,cval_part_p_container#5538,cval_part_p_retailprice#5539,cval_part_p_comment#5540,cval_part_p_brand#5541,cdepval_part_p_name#5542,cdepval_part_p_mfgr#5543,cdepval_part_p_type#5544,cdepval_part_p_size#5545,cdepval_part_p_container#5546,cdepval_part_p_retailprice#5547,cdepval_part_p_comment#5548,cdepval_part_p_brand#5549,cp_name#5550,cp_mfgr#5551,cp_type#5552,cp_size#5553,cp_container#5554,cp_retailprice#5555,cp_comment#5556,cp_brand#5557] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :  :     +- Project [rid#5711 AS rid_1#5725, cpfk_part_partsupp#5712 AS cpfk_part_partsupp_1#5726, cfpk_partsupp_part#5713 AS cfpk_partsupp_part_1#5727, cpfk_supplier_partsupp#5714 AS cpfk_supplier_partsupp_1#5728, cfpk_partsupp_supplier#5715 AS cfpk_partsupp_supplier_1#5729, cval_partsupp_ps_availqty#5716 AS cval_partsupp_ps_availqty_1#5730, cval_partsupp_ps_supplycost#5717 AS cval_partsupp_ps_supplycost_1#5731, cval_partsupp_ps_comment#5718 AS cval_partsupp_ps_comment_1#5732, cdepval_partsupp_ps_availqty#5719 AS cdepval_partsupp_ps_availqty_1#5733, cdepval_partsupp_ps_supplycost#5720 AS cdepval_partsupp_ps_supplycost_1#5734, cdepval_partsupp_ps_comment#5721 AS cdepval_partsupp_ps_comment_1#5735, cps_availqty#5722 AS cps_availqty_1#5736, cps_supplycost#5723 AS cps_supplycost_1#5737, cps_comment#5724 AS cps_comment_1#5738]
         :  :        +- Relation[rid#5711,cpfk_part_partsupp#5712,cfpk_partsupp_part#5713,cpfk_supplier_partsupp#5714,cfpk_partsupp_supplier#5715,cval_partsupp_ps_availqty#5716,cval_partsupp_ps_supplycost#5717,cval_partsupp_ps_comment#5718,cdepval_partsupp_ps_availqty#5719,cdepval_partsupp_ps_supplycost#5720,cdepval_partsupp_ps_comment#5721,cps_availqty#5722,cps_supplycost#5723,cps_comment#5724] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#5633 AS rid_1#5647, cpfk_part_partsupp#5634 AS cpfk_part_partsupp_1#5648, cfpk_partsupp_part#5635 AS cfpk_partsupp_part_1#5649, cpfk_supplier_partsupp#5636 AS cpfk_supplier_partsupp_1#5650, cfpk_partsupp_supplier#5637 AS cfpk_partsupp_supplier_1#5651, cval_partsupp_ps_availqty#5638 AS cval_partsupp_ps_availqty_1#5652, cval_partsupp_ps_supplycost#5639 AS cval_partsupp_ps_supplycost_1#5653, cval_partsupp_ps_comment#5640 AS cval_partsupp_ps_comment_1#5654, cdepval_partsupp_ps_availqty#5641 AS cdepval_partsupp_ps_availqty_1#5655, cdepval_partsupp_ps_supplycost#5642 AS cdepval_partsupp_ps_supplycost_1#5656, cdepval_partsupp_ps_comment#5643 AS cdepval_partsupp_ps_comment_1#5657, cps_availqty#5644 AS cps_availqty_1#5658, cps_supplycost#5645 AS cps_supplycost_1#5659, cps_comment#5646 AS cps_comment_1#5660]
         :     +- Relation[rid#5633,cpfk_part_partsupp#5634,cfpk_partsupp_part#5635,cpfk_supplier_partsupp#5636,cfpk_partsupp_supplier#5637,cval_partsupp_ps_availqty#5638,cval_partsupp_ps_supplycost#5639,cval_partsupp_ps_comment#5640,cdepval_partsupp_ps_availqty#5641,cdepval_partsupp_ps_supplycost#5642,cdepval_partsupp_ps_comment#5643,cps_availqty#5644,cps_supplycost#5645,cps_comment#5646] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_2, NotMaterialized, NotMaterialized, [rid_2#5748, cpfk_region_nation_2#5749, cfpk_nation_region_2#5750, cval_nation_n_name_2#5751, cval_nation_n_comment_2#5752, cdepval_nation_n_name_2#5753, cdepval_nation_n_comment_2#5754, cn_name_2#5755, cn_comment_2#5756, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
            :  :  +- Project [rid#5739 AS rid_2#5748, cpfk_region_nation#5740 AS cpfk_region_nation_2#5749, cfpk_nation_region#5741 AS cfpk_nation_region_2#5750, cval_nation_n_name#5742 AS cval_nation_n_name_2#5751, cval_nation_n_comment#5743 AS cval_nation_n_comment_2#5752, cdepval_nation_n_name#5744 AS cdepval_nation_n_name_2#5753, cdepval_nation_n_comment#5745 AS cdepval_nation_n_comment_2#5754, cn_name#5746 AS cn_name_2#5755, cn_comment#5747 AS cn_comment_2#5756]
            :  :     +- Relation[rid#5739,cpfk_region_nation#5740,cfpk_nation_region#5741,cval_nation_n_name#5742,cval_nation_n_comment#5743,cdepval_nation_n_name#5744,cdepval_nation_n_comment#5745,cn_name#5746,cn_comment#5747] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#5829 AS rid_3#5847, cpfk_nation_supplier#5830 AS cpfk_nation_supplier_3#5848, cfpk_supplier_nation#5831 AS cfpk_supplier_nation_3#5849, cval_supplier_s_name#5832 AS cval_supplier_s_name_3#5850, cval_supplier_s_address#5833 AS cval_supplier_s_address_3#5851, cval_supplier_s_phone#5834 AS cval_supplier_s_phone_3#5852, cval_supplier_s_acctbal#5835 AS cval_supplier_s_acctbal_3#5853, cval_supplier_s_comment#5836 AS cval_supplier_s_comment_3#5854, cdepval_supplier_s_name#5837 AS cdepval_supplier_s_name_3#5855, cdepval_supplier_s_address#5838 AS cdepval_supplier_s_address_3#5856, cdepval_supplier_s_phone#5839 AS cdepval_supplier_s_phone_3#5857, cdepval_supplier_s_acctbal#5840 AS cdepval_supplier_s_acctbal_3#5858, cdepval_supplier_s_comment#5841 AS cdepval_supplier_s_comment_3#5859, cs_name#5842 AS cs_name_3#5860, cs_address#5843 AS cs_address_3#5861, cs_phone#5844 AS cs_phone_3#5862, cs_acctbal#5845 AS cs_acctbal_3#5863, cs_comment#5846 AS cs_comment_3#5864]
            :        +- Relation[rid#5829,cpfk_nation_supplier#5830,cfpk_supplier_nation#5831,cval_supplier_s_name#5832,cval_supplier_s_address#5833,cval_supplier_s_phone#5834,cval_supplier_s_acctbal#5835,cval_supplier_s_comment#5836,cdepval_supplier_s_name#5837,cdepval_supplier_s_address#5838,cdepval_supplier_s_phone#5839,cdepval_supplier_s_acctbal#5840,cdepval_supplier_s_comment#5841,cs_name#5842,cs_address#5843,cs_phone#5844,cs_acctbal#5845,cs_comment#5846] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#5775 AS rid_3#5793, cpfk_nation_supplier#5776 AS cpfk_nation_supplier_3#5794, cfpk_supplier_nation#5777 AS cfpk_supplier_nation_3#5795, cval_supplier_s_name#5778 AS cval_supplier_s_name_3#5796, cval_supplier_s_address#5779 AS cval_supplier_s_address_3#5797, cval_supplier_s_phone#5780 AS cval_supplier_s_phone_3#5798, cval_supplier_s_acctbal#5781 AS cval_supplier_s_acctbal_3#5799, cval_supplier_s_comment#5782 AS cval_supplier_s_comment_3#5800, cdepval_supplier_s_name#5783 AS cdepval_supplier_s_name_3#5801, cdepval_supplier_s_address#5784 AS cdepval_supplier_s_address_3#5802, cdepval_supplier_s_phone#5785 AS cdepval_supplier_s_phone_3#5803, cdepval_supplier_s_acctbal#5786 AS cdepval_supplier_s_acctbal_3#5804, cdepval_supplier_s_comment#5787 AS cdepval_supplier_s_comment_3#5805, cs_name#5788 AS cs_name_3#5806, cs_address#5789 AS cs_address_3#5807, cs_phone#5790 AS cs_phone_3#5808, cs_acctbal#5791 AS cs_acctbal_3#5809, cs_comment#5792 AS cs_comment_3#5810]
               +- Relation[rid#5775,cpfk_nation_supplier#5776,cfpk_supplier_nation#5777,cval_supplier_s_name#5778,cval_supplier_s_address#5779,cval_supplier_s_phone#5780,cval_supplier_s_acctbal#5781,cval_supplier_s_comment#5782,cdepval_supplier_s_name#5783,cdepval_supplier_s_address#5784,cdepval_supplier_s_phone#5785,cdepval_supplier_s_acctbal#5786,cdepval_supplier_s_comment#5787,cs_name#5788,cs_address#5789,cs_phone#5790,cs_acctbal#5791,cs_comment#5792] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 891ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/26 22:11:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:11:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5937L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 22:11:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:11:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:11:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:11:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:11:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:11:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:11:20 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 22:11:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:11:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:11:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:11:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:11:20 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:11:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:11:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5937L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#6107 AS rid_4#6152, cpfk_orders_lineitem#6108 AS cpfk_orders_lineitem_4#6153, cpfk_supplier_lineitem#6109 AS cpfk_supplier_lineitem_4#6154, cfpk_lineitem_supplier#6110 AS cfpk_lineitem_supplier_4#6155, cfpk_lineitem_partsupp#6111 AS cfpk_lineitem_partsupp_4#6156, cpfk_part_lineitem#6112 AS cpfk_part_lineitem_4#6157, cfpk_lineitem_part#6113 AS cfpk_lineitem_part_4#6158, cpfk_partsupp_lineitem#6114 AS cpfk_partsupp_lineitem_4#6159, cfpk_lineitem_orders#6115 AS cfpk_lineitem_orders_4#6160, cval_lineitem_l_quantity#6116 AS cval_lineitem_l_quantity_4#6161, cval_lineitem_l_extendedprice#6117 AS cval_lineitem_l_extendedprice_4#6162, cval_lineitem_l_discount#6118 AS cval_lineitem_l_discount_4#6163, cval_lineitem_l_tax#6119 AS cval_lineitem_l_tax_4#6164, cval_lineitem_l_returnflag#6120 AS cval_lineitem_l_returnflag_4#6165, cval_lineitem_l_linestatus#6121 AS cval_lineitem_l_linestatus_4#6166, cval_lineitem_l_commitdate#6122 AS cval_lineitem_l_commitdate_4#6167, cval_lineitem_l_receiptdate#6123 AS cval_lineitem_l_receiptdate_4#6168, cval_lineitem_l_shipinstruct#6124 AS cval_lineitem_l_shipinstruct_4#6169, cval_lineitem_l_shipmode#6125 AS cval_lineitem_l_shipmode_4#6170, cval_lineitem_l_comment#6126 AS cval_lineitem_l_comment_4#6171, cval_lineitem_l_shipdate#6127 AS cval_lineitem_l_shipdate_4#6172, cdepval_lineitem_l_quantity#6128 AS cdepval_lineitem_l_quantity_4#6173, cdepval_lineitem_l_extendedprice#6129 AS cdepval_lineitem_l_extendedprice_4#6174, cdepval_lineitem_l_discount#6130 AS cdepval_lineitem_l_discount_4#6175, ... 21 more fields]
            :  :  +- Relation[rid#6107,cpfk_orders_lineitem#6108,cpfk_supplier_lineitem#6109,cfpk_lineitem_supplier#6110,cfpk_lineitem_partsupp#6111,cpfk_part_lineitem#6112,cfpk_lineitem_part#6113,cpfk_partsupp_lineitem#6114,cfpk_lineitem_orders#6115,cval_lineitem_l_quantity#6116,cval_lineitem_l_extendedprice#6117,cval_lineitem_l_discount#6118,cval_lineitem_l_tax#6119,cval_lineitem_l_returnflag#6120,cval_lineitem_l_linestatus#6121,cval_lineitem_l_commitdate#6122,cval_lineitem_l_receiptdate#6123,cval_lineitem_l_shipinstruct#6124,cval_lineitem_l_shipmode#6125,cval_lineitem_l_comment#6126,cval_lineitem_l_shipdate#6127,cdepval_lineitem_l_quantity#6128,cdepval_lineitem_l_extendedprice#6129,cdepval_lineitem_l_discount#6130,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#6059 AS rid_3#6083, cpfk_customer_orders#6060 AS cpfk_customer_orders_3#6084, cfpk_orders_customer#6061 AS cfpk_orders_customer_3#6085, cval_orders_o_orderstatus#6062 AS cval_orders_o_orderstatus_3#6086, cval_orders_o_totalprice#6063 AS cval_orders_o_totalprice_3#6087, cval_orders_o_orderpriority#6064 AS cval_orders_o_orderpriority_3#6088, cval_orders_o_clerk#6065 AS cval_orders_o_clerk_3#6089, cval_orders_o_shippriority#6066 AS cval_orders_o_shippriority_3#6090, cval_orders_o_comment#6067 AS cval_orders_o_comment_3#6091, cval_orders_o_orderdate#6068 AS cval_orders_o_orderdate_3#6092, cdepval_orders_o_orderstatus#6069 AS cdepval_orders_o_orderstatus_3#6093, cdepval_orders_o_totalprice#6070 AS cdepval_orders_o_totalprice_3#6094, cdepval_orders_o_orderpriority#6071 AS cdepval_orders_o_orderpriority_3#6095, cdepval_orders_o_clerk#6072 AS cdepval_orders_o_clerk_3#6096, cdepval_orders_o_shippriority#6073 AS cdepval_orders_o_shippriority_3#6097, cdepval_orders_o_comment#6074 AS cdepval_orders_o_comment_3#6098, cdepval_orders_o_orderdate#6075 AS cdepval_orders_o_orderdate_3#6099, co_orderstatus#6076 AS co_orderstatus_3#6100, co_totalprice#6077 AS co_totalprice_3#6101, co_orderpriority#6078 AS co_orderpriority_3#6102, co_clerk#6079 AS co_clerk_3#6103, co_shippriority#6080 AS co_shippriority_3#6104, co_comment#6081 AS co_comment_3#6105, co_orderdate#6082 AS co_orderdate_3#6106]
            :     :  +- Relation[rid#6059,cpfk_customer_orders#6060,cfpk_orders_customer#6061,cval_orders_o_orderstatus#6062,cval_orders_o_totalprice#6063,cval_orders_o_orderpriority#6064,cval_orders_o_clerk#6065,cval_orders_o_shippriority#6066,cval_orders_o_comment#6067,cval_orders_o_orderdate#6068,cdepval_orders_o_orderstatus#6069,cdepval_orders_o_totalprice#6070,cdepval_orders_o_orderpriority#6071,cdepval_orders_o_clerk#6072,cdepval_orders_o_shippriority#6073,cdepval_orders_o_comment#6074,cdepval_orders_o_orderdate#6075,co_orderstatus#6076,co_totalprice#6077,co_orderpriority#6078,co_clerk#6079,co_shippriority#6080,co_comment#6081,co_orderdate#6082] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#6017 AS rid_2#6038, cpfk_nation_customer#6018 AS cpfk_nation_customer_2#6039, cfpk_customer_nation#6019 AS cfpk_customer_nation_2#6040, cval_customer_c_name#6020 AS cval_customer_c_name_2#6041, cval_customer_c_address#6021 AS cval_customer_c_address_2#6042, cval_customer_c_phone#6022 AS cval_customer_c_phone_2#6043, cval_customer_c_acctbal#6023 AS cval_customer_c_acctbal_2#6044, cval_customer_c_comment#6024 AS cval_customer_c_comment_2#6045, cval_customer_c_mktsegment#6025 AS cval_customer_c_mktsegment_2#6046, cdepval_customer_c_name#6026 AS cdepval_customer_c_name_2#6047, cdepval_customer_c_address#6027 AS cdepval_customer_c_address_2#6048, cdepval_customer_c_phone#6028 AS cdepval_customer_c_phone_2#6049, cdepval_customer_c_acctbal#6029 AS cdepval_customer_c_acctbal_2#6050, cdepval_customer_c_comment#6030 AS cdepval_customer_c_comment_2#6051, cdepval_customer_c_mktsegment#6031 AS cdepval_customer_c_mktsegment_2#6052, cc_name#6032 AS cc_name_2#6053, cc_address#6033 AS cc_address_2#6054, cc_phone#6034 AS cc_phone_2#6055, cc_acctbal#6035 AS cc_acctbal_2#6056, cc_comment#6036 AS cc_comment_2#6057, cc_mktsegment#6037 AS cc_mktsegment_2#6058]
            :        :  +- Relation[rid#6017,cpfk_nation_customer#6018,cfpk_customer_nation#6019,cval_customer_c_name#6020,cval_customer_c_address#6021,cval_customer_c_phone#6022,cval_customer_c_acctbal#6023,cval_customer_c_comment#6024,cval_customer_c_mktsegment#6025,cdepval_customer_c_name#6026,cdepval_customer_c_address#6027,cdepval_customer_c_phone#6028,cdepval_customer_c_acctbal#6029,cdepval_customer_c_comment#6030,cdepval_customer_c_mktsegment#6031,cc_name#6032,cc_address#6033,cc_phone#6034,cc_acctbal#6035,cc_comment#6036,cc_mktsegment#6037] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join UsingJoin(Inner,List(rid_1))
            :           :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#5946, cval_region_r_name_0#5947, cval_region_r_comment_0#5948, cdepval_region_r_name_0#5949, cdepval_region_r_comment_0#5950, cr_name_0#5951, cr_comment_0#5952, 'rid_1]
            :           :  :- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :           :  :  +- Project [rid#5939 AS rid_0#5946, cval_region_r_name#5940 AS cval_region_r_name_0#5947, cval_region_r_comment#5941 AS cval_region_r_comment_0#5948, cdepval_region_r_name#5942 AS cdepval_region_r_name_0#5949, cdepval_region_r_comment#5943 AS cdepval_region_r_comment_0#5950, cr_name#5944 AS cr_name_0#5951, cr_comment#5945 AS cr_comment_0#5952]
            :           :  :     +- Relation[rid#5939,cval_region_r_name#5940,cval_region_r_comment#5941,cdepval_region_r_name#5942,cdepval_region_r_comment#5943,cr_name#5944,cr_comment#5945] JDBCRelation(tregion) [numPartitions=1]
            :           :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
            :           :     +- Project [rid#5999 AS rid_1#6008, cpfk_region_nation#6000 AS cpfk_region_nation_1#6009, cfpk_nation_region#6001 AS cfpk_nation_region_1#6010, cval_nation_n_name#6002 AS cval_nation_n_name_1#6011, cval_nation_n_comment#6003 AS cval_nation_n_comment_1#6012, cdepval_nation_n_name#6004 AS cdepval_nation_n_name_1#6013, cdepval_nation_n_comment#6005 AS cdepval_nation_n_comment_1#6014, cn_name#6006 AS cn_name_1#6015, cn_comment#6007 AS cn_comment_1#6016]
            :           :        +- Relation[rid#5999,cpfk_region_nation#6000,cfpk_nation_region#6001,cval_nation_n_name#6002,cval_nation_n_comment#6003,cdepval_nation_n_name#6004,cdepval_nation_n_comment#6005,cn_name#6006,cn_comment#6007] JDBCRelation(tnation) [numPartitions=1]
            :           +- Project [rid#5967 AS rid_1#5976, cpfk_region_nation#5968 AS cpfk_region_nation_1#5977, cfpk_nation_region#5969 AS cfpk_nation_region_1#5978, cval_nation_n_name#5970 AS cval_nation_n_name_1#5979, cval_nation_n_comment#5971 AS cval_nation_n_comment_1#5980, cdepval_nation_n_name#5972 AS cdepval_nation_n_name_1#5981, cdepval_nation_n_comment#5973 AS cdepval_nation_n_comment_1#5982, cn_name#5974 AS cn_name_1#5983, cn_comment#5975 AS cn_comment_1#5984]
            :              +- Relation[rid#5967,cpfk_region_nation#5968,cfpk_nation_region#5969,cval_nation_n_name#5970,cval_nation_n_comment#5971,cdepval_nation_n_name#5972,cdepval_nation_n_comment#5973,cn_name#5974,cn_comment#5975] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#6197 AS rid_5#6215, cpfk_nation_supplier#6198 AS cpfk_nation_supplier_5#6216, cfpk_supplier_nation#6199 AS cfpk_supplier_nation_5#6217, cval_supplier_s_name#6200 AS cval_supplier_s_name_5#6218, cval_supplier_s_address#6201 AS cval_supplier_s_address_5#6219, cval_supplier_s_phone#6202 AS cval_supplier_s_phone_5#6220, cval_supplier_s_acctbal#6203 AS cval_supplier_s_acctbal_5#6221, cval_supplier_s_comment#6204 AS cval_supplier_s_comment_5#6222, cdepval_supplier_s_name#6205 AS cdepval_supplier_s_name_5#6223, cdepval_supplier_s_address#6206 AS cdepval_supplier_s_address_5#6224, cdepval_supplier_s_phone#6207 AS cdepval_supplier_s_phone_5#6225, cdepval_supplier_s_acctbal#6208 AS cdepval_supplier_s_acctbal_5#6226, cdepval_supplier_s_comment#6209 AS cdepval_supplier_s_comment_5#6227, cs_name#6210 AS cs_name_5#6228, cs_address#6211 AS cs_address_5#6229, cs_phone#6212 AS cs_phone_5#6230, cs_acctbal#6213 AS cs_acctbal_5#6231, cs_comment#6214 AS cs_comment_5#6232]
               +- Relation[rid#6197,cpfk_nation_supplier#6198,cfpk_supplier_nation#6199,cval_supplier_s_name#6200,cval_supplier_s_address#6201,cval_supplier_s_phone#6202,cval_supplier_s_acctbal#6203,cval_supplier_s_comment#6204,cdepval_supplier_s_name#6205,cdepval_supplier_s_address#6206,cdepval_supplier_s_phone#6207,cdepval_supplier_s_acctbal#6208,cdepval_supplier_s_comment#6209,cs_name#6210,cs_address#6211,cs_phone#6212,cs_acctbal#6213,cs_comment#6214] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 29636ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/26 22:11:50 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:11:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6361L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 22:11:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:11:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:11:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:11:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:11:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:11:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:11:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:11:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:11:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:11:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6361L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#6363 AS rid_0#6408, cpfk_orders_lineitem#6364 AS cpfk_orders_lineitem_0#6409, cpfk_supplier_lineitem#6365 AS cpfk_supplier_lineitem_0#6410, cfpk_lineitem_supplier#6366 AS cfpk_lineitem_supplier_0#6411, cfpk_lineitem_partsupp#6367 AS cfpk_lineitem_partsupp_0#6412, cpfk_part_lineitem#6368 AS cpfk_part_lineitem_0#6413, cfpk_lineitem_part#6369 AS cfpk_lineitem_part_0#6414, cpfk_partsupp_lineitem#6370 AS cpfk_partsupp_lineitem_0#6415, cfpk_lineitem_orders#6371 AS cfpk_lineitem_orders_0#6416, cval_lineitem_l_quantity#6372 AS cval_lineitem_l_quantity_0#6417, cval_lineitem_l_extendedprice#6373 AS cval_lineitem_l_extendedprice_0#6418, cval_lineitem_l_discount#6374 AS cval_lineitem_l_discount_0#6419, cval_lineitem_l_tax#6375 AS cval_lineitem_l_tax_0#6420, cval_lineitem_l_returnflag#6376 AS cval_lineitem_l_returnflag_0#6421, cval_lineitem_l_linestatus#6377 AS cval_lineitem_l_linestatus_0#6422, cval_lineitem_l_commitdate#6378 AS cval_lineitem_l_commitdate_0#6423, cval_lineitem_l_receiptdate#6379 AS cval_lineitem_l_receiptdate_0#6424, cval_lineitem_l_shipinstruct#6380 AS cval_lineitem_l_shipinstruct_0#6425, cval_lineitem_l_shipmode#6381 AS cval_lineitem_l_shipmode_0#6426, cval_lineitem_l_comment#6382 AS cval_lineitem_l_comment_0#6427, cval_lineitem_l_shipdate#6383 AS cval_lineitem_l_shipdate_0#6428, cdepval_lineitem_l_quantity#6384 AS cdepval_lineitem_l_quantity_0#6429, cdepval_lineitem_l_extendedprice#6385 AS cdepval_lineitem_l_extendedprice_0#6430, cdepval_lineitem_l_discount#6386 AS cdepval_lineitem_l_discount_0#6431, ... 21 more fields]
         :  +- Relation[rid#6363,cpfk_orders_lineitem#6364,cpfk_supplier_lineitem#6365,cfpk_lineitem_supplier#6366,cfpk_lineitem_partsupp#6367,cpfk_part_lineitem#6368,cfpk_lineitem_part#6369,cpfk_partsupp_lineitem#6370,cfpk_lineitem_orders#6371,cval_lineitem_l_quantity#6372,cval_lineitem_l_extendedprice#6373,cval_lineitem_l_discount#6374,cval_lineitem_l_tax#6375,cval_lineitem_l_returnflag#6376,cval_lineitem_l_linestatus#6377,cval_lineitem_l_commitdate#6378,cval_lineitem_l_receiptdate#6379,cval_lineitem_l_shipinstruct#6380,cval_lineitem_l_shipmode#6381,cval_lineitem_l_comment#6382,cval_lineitem_l_shipdate#6383,cdepval_lineitem_l_quantity#6384,cdepval_lineitem_l_extendedprice#6385,cdepval_lineitem_l_discount#6386,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#6822, cpfk_region_nation_4#6823, cfpk_nation_region_4#6824, cval_nation_n_name_4#6825, cval_nation_n_comment_4#6826, cdepval_nation_n_name_4#6827, cdepval_nation_n_comment_4#6828, cn_name_4#6829, cn_comment_4#6830, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
            :  :  +- Project [rid#6813 AS rid_4#6822, cpfk_region_nation#6814 AS cpfk_region_nation_4#6823, cfpk_nation_region#6815 AS cfpk_nation_region_4#6824, cval_nation_n_name#6816 AS cval_nation_n_name_4#6825, cval_nation_n_comment#6817 AS cval_nation_n_comment_4#6826, cdepval_nation_n_name#6818 AS cdepval_nation_n_name_4#6827, cdepval_nation_n_comment#6819 AS cdepval_nation_n_comment_4#6828, cn_name#6820 AS cn_name_4#6829, cn_comment#6821 AS cn_comment_4#6830]
            :  :     +- Relation[rid#6813,cpfk_region_nation#6814,cfpk_nation_region#6815,cval_nation_n_name#6816,cval_nation_n_comment#6817,cdepval_nation_n_name#6818,cdepval_nation_n_comment#6819,cn_name#6820,cn_comment#6821] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#6867 AS rid_3#6885, cpfk_nation_supplier#6868 AS cpfk_nation_supplier_3#6886, cfpk_supplier_nation#6869 AS cfpk_supplier_nation_3#6887, cval_supplier_s_name#6870 AS cval_supplier_s_name_3#6888, cval_supplier_s_address#6871 AS cval_supplier_s_address_3#6889, cval_supplier_s_phone#6872 AS cval_supplier_s_phone_3#6890, cval_supplier_s_acctbal#6873 AS cval_supplier_s_acctbal_3#6891, cval_supplier_s_comment#6874 AS cval_supplier_s_comment_3#6892, cdepval_supplier_s_name#6875 AS cdepval_supplier_s_name_3#6893, cdepval_supplier_s_address#6876 AS cdepval_supplier_s_address_3#6894, cdepval_supplier_s_phone#6877 AS cdepval_supplier_s_phone_3#6895, cdepval_supplier_s_acctbal#6878 AS cdepval_supplier_s_acctbal_3#6896, cdepval_supplier_s_comment#6879 AS cdepval_supplier_s_comment_3#6897, cs_name#6880 AS cs_name_3#6898, cs_address#6881 AS cs_address_3#6899, cs_phone#6882 AS cs_phone_3#6900, cs_acctbal#6883 AS cs_acctbal_3#6901, cs_comment#6884 AS cs_comment_3#6902]
            :        +- Relation[rid#6867,cpfk_nation_supplier#6868,cfpk_supplier_nation#6869,cval_supplier_s_name#6870,cval_supplier_s_address#6871,cval_supplier_s_phone#6872,cval_supplier_s_acctbal#6873,cval_supplier_s_comment#6874,cdepval_supplier_s_name#6875,cdepval_supplier_s_address#6876,cdepval_supplier_s_phone#6877,cdepval_supplier_s_acctbal#6878,cdepval_supplier_s_comment#6879,cs_name#6880,cs_address#6881,cs_phone#6882,cs_acctbal#6883,cs_comment#6884] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'DexPkfkMaterializationAwareJoin orders~lineitem, 'cpfk_orders_lineitem_2, 'rid_1, NotMaterialized, NotMaterialized, [rid_1#6477, cpfk_customer_orders_1#6478, cfpk_orders_customer_1#6479, cval_orders_o_orderstatus_1#6480, cval_orders_o_totalprice_1#6481, cval_orders_o_orderpriority_1#6482, cval_orders_o_clerk_1#6483, cval_orders_o_shippriority_1#6484, cval_orders_o_comment_1#6485, cval_orders_o_orderdate_1#6486, cdepval_orders_o_orderstatus_1#6487, cdepval_orders_o_totalprice_1#6488, cdepval_orders_o_orderpriority_1#6489, cdepval_orders_o_clerk_1#6490, cdepval_orders_o_shippriority_1#6491, cdepval_orders_o_comment_1#6492, cdepval_orders_o_orderdate_1#6493, co_orderstatus_1#6494, co_totalprice_1#6495, co_orderpriority_1#6496, co_clerk_1#6497, co_shippriority_1#6498, co_comment_1#6499, co_orderdate_1#6500, 'rid_2]
               :  :  :- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
               :  :  :  +- Project [rid#6453 AS rid_1#6477, cpfk_customer_orders#6454 AS cpfk_customer_orders_1#6478, cfpk_orders_customer#6455 AS cfpk_orders_customer_1#6479, cval_orders_o_orderstatus#6456 AS cval_orders_o_orderstatus_1#6480, cval_orders_o_totalprice#6457 AS cval_orders_o_totalprice_1#6481, cval_orders_o_orderpriority#6458 AS cval_orders_o_orderpriority_1#6482, cval_orders_o_clerk#6459 AS cval_orders_o_clerk_1#6483, cval_orders_o_shippriority#6460 AS cval_orders_o_shippriority_1#6484, cval_orders_o_comment#6461 AS cval_orders_o_comment_1#6485, cval_orders_o_orderdate#6462 AS cval_orders_o_orderdate_1#6486, cdepval_orders_o_orderstatus#6463 AS cdepval_orders_o_orderstatus_1#6487, cdepval_orders_o_totalprice#6464 AS cdepval_orders_o_totalprice_1#6488, cdepval_orders_o_orderpriority#6465 AS cdepval_orders_o_orderpriority_1#6489, cdepval_orders_o_clerk#6466 AS cdepval_orders_o_clerk_1#6490, cdepval_orders_o_shippriority#6467 AS cdepval_orders_o_shippriority_1#6491, cdepval_orders_o_comment#6468 AS cdepval_orders_o_comment_1#6492, cdepval_orders_o_orderdate#6469 AS cdepval_orders_o_orderdate_1#6493, co_orderstatus#6470 AS co_orderstatus_1#6494, co_totalprice#6471 AS co_totalprice_1#6495, co_orderpriority#6472 AS co_orderpriority_1#6496, co_clerk#6473 AS co_clerk_1#6497, co_shippriority#6474 AS co_shippriority_1#6498, co_comment#6475 AS co_comment_1#6499, co_orderdate#6476 AS co_orderdate_1#6500]
               :  :  :     +- Relation[rid#6453,cpfk_customer_orders#6454,cfpk_orders_customer#6455,cval_orders_o_orderstatus#6456,cval_orders_o_totalprice#6457,cval_orders_o_orderpriority#6458,cval_orders_o_clerk#6459,cval_orders_o_shippriority#6460,cval_orders_o_comment#6461,cval_orders_o_orderdate#6462,cdepval_orders_o_orderstatus#6463,cdepval_orders_o_totalprice#6464,cdepval_orders_o_orderpriority#6465,cdepval_orders_o_clerk#6466,cdepval_orders_o_shippriority#6467,cdepval_orders_o_comment#6468,cdepval_orders_o_orderdate#6469,co_orderstatus#6470,co_totalprice#6471,co_orderpriority#6472,co_clerk#6473,co_shippriority#6474,co_comment#6475,co_orderdate#6476] JDBCRelation(torders) [numPartitions=1]
               :  :  +- 'Project ['cpfk_orders_lineitem_2, 'rid_2]
               :  :     +- Project [rid#6687 AS rid_2#6732, cpfk_orders_lineitem#6688 AS cpfk_orders_lineitem_2#6733, cpfk_supplier_lineitem#6689 AS cpfk_supplier_lineitem_2#6734, cfpk_lineitem_supplier#6690 AS cfpk_lineitem_supplier_2#6735, cfpk_lineitem_partsupp#6691 AS cfpk_lineitem_partsupp_2#6736, cpfk_part_lineitem#6692 AS cpfk_part_lineitem_2#6737, cfpk_lineitem_part#6693 AS cfpk_lineitem_part_2#6738, cpfk_partsupp_lineitem#6694 AS cpfk_partsupp_lineitem_2#6739, cfpk_lineitem_orders#6695 AS cfpk_lineitem_orders_2#6740, cval_lineitem_l_quantity#6696 AS cval_lineitem_l_quantity_2#6741, cval_lineitem_l_extendedprice#6697 AS cval_lineitem_l_extendedprice_2#6742, cval_lineitem_l_discount#6698 AS cval_lineitem_l_discount_2#6743, cval_lineitem_l_tax#6699 AS cval_lineitem_l_tax_2#6744, cval_lineitem_l_returnflag#6700 AS cval_lineitem_l_returnflag_2#6745, cval_lineitem_l_linestatus#6701 AS cval_lineitem_l_linestatus_2#6746, cval_lineitem_l_commitdate#6702 AS cval_lineitem_l_commitdate_2#6747, cval_lineitem_l_receiptdate#6703 AS cval_lineitem_l_receiptdate_2#6748, cval_lineitem_l_shipinstruct#6704 AS cval_lineitem_l_shipinstruct_2#6749, cval_lineitem_l_shipmode#6705 AS cval_lineitem_l_shipmode_2#6750, cval_lineitem_l_comment#6706 AS cval_lineitem_l_comment_2#6751, cval_lineitem_l_shipdate#6707 AS cval_lineitem_l_shipdate_2#6752, cdepval_lineitem_l_quantity#6708 AS cdepval_lineitem_l_quantity_2#6753, cdepval_lineitem_l_extendedprice#6709 AS cdepval_lineitem_l_extendedprice_2#6754, cdepval_lineitem_l_discount#6710 AS cdepval_lineitem_l_discount_2#6755, ... 21 more fields]
               :  :        +- Relation[rid#6687,cpfk_orders_lineitem#6688,cpfk_supplier_lineitem#6689,cfpk_lineitem_supplier#6690,cfpk_lineitem_partsupp#6691,cpfk_part_lineitem#6692,cfpk_lineitem_part#6693,cpfk_partsupp_lineitem#6694,cfpk_lineitem_orders#6695,cval_lineitem_l_quantity#6696,cval_lineitem_l_extendedprice#6697,cval_lineitem_l_discount#6698,cval_lineitem_l_tax#6699,cval_lineitem_l_returnflag#6700,cval_lineitem_l_linestatus#6701,cval_lineitem_l_commitdate#6702,cval_lineitem_l_receiptdate#6703,cval_lineitem_l_shipinstruct#6704,cval_lineitem_l_shipmode#6705,cval_lineitem_l_comment#6706,cval_lineitem_l_shipdate#6707,cdepval_lineitem_l_quantity#6708,cdepval_lineitem_l_extendedprice#6709,cdepval_lineitem_l_discount#6710,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               :  +- Project [rid#6549 AS rid_2#6594, cpfk_orders_lineitem#6550 AS cpfk_orders_lineitem_2#6595, cpfk_supplier_lineitem#6551 AS cpfk_supplier_lineitem_2#6596, cfpk_lineitem_supplier#6552 AS cfpk_lineitem_supplier_2#6597, cfpk_lineitem_partsupp#6553 AS cfpk_lineitem_partsupp_2#6598, cpfk_part_lineitem#6554 AS cpfk_part_lineitem_2#6599, cfpk_lineitem_part#6555 AS cfpk_lineitem_part_2#6600, cpfk_partsupp_lineitem#6556 AS cpfk_partsupp_lineitem_2#6601, cfpk_lineitem_orders#6557 AS cfpk_lineitem_orders_2#6602, cval_lineitem_l_quantity#6558 AS cval_lineitem_l_quantity_2#6603, cval_lineitem_l_extendedprice#6559 AS cval_lineitem_l_extendedprice_2#6604, cval_lineitem_l_discount#6560 AS cval_lineitem_l_discount_2#6605, cval_lineitem_l_tax#6561 AS cval_lineitem_l_tax_2#6606, cval_lineitem_l_returnflag#6562 AS cval_lineitem_l_returnflag_2#6607, cval_lineitem_l_linestatus#6563 AS cval_lineitem_l_linestatus_2#6608, cval_lineitem_l_commitdate#6564 AS cval_lineitem_l_commitdate_2#6609, cval_lineitem_l_receiptdate#6565 AS cval_lineitem_l_receiptdate_2#6610, cval_lineitem_l_shipinstruct#6566 AS cval_lineitem_l_shipinstruct_2#6611, cval_lineitem_l_shipmode#6567 AS cval_lineitem_l_shipmode_2#6612, cval_lineitem_l_comment#6568 AS cval_lineitem_l_comment_2#6613, cval_lineitem_l_shipdate#6569 AS cval_lineitem_l_shipdate_2#6614, cdepval_lineitem_l_quantity#6570 AS cdepval_lineitem_l_quantity_2#6615, cdepval_lineitem_l_extendedprice#6571 AS cdepval_lineitem_l_extendedprice_2#6616, cdepval_lineitem_l_discount#6572 AS cdepval_lineitem_l_discount_2#6617, ... 21 more fields]
               :     +- Relation[rid#6549,cpfk_orders_lineitem#6550,cpfk_supplier_lineitem#6551,cfpk_lineitem_supplier#6552,cfpk_lineitem_partsupp#6553,cpfk_part_lineitem#6554,cfpk_lineitem_part#6555,cpfk_partsupp_lineitem#6556,cfpk_lineitem_orders#6557,cval_lineitem_l_quantity#6558,cval_lineitem_l_extendedprice#6559,cval_lineitem_l_discount#6560,cval_lineitem_l_tax#6561,cval_lineitem_l_returnflag#6562,cval_lineitem_l_linestatus#6563,cval_lineitem_l_commitdate#6564,cval_lineitem_l_receiptdate#6565,cval_lineitem_l_shipinstruct#6566,cval_lineitem_l_shipmode#6567,cval_lineitem_l_comment#6568,cval_lineitem_l_shipdate#6569,cdepval_lineitem_l_quantity#6570,cdepval_lineitem_l_extendedprice#6571,cdepval_lineitem_l_discount#6572,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               +- Project [rid#6777 AS rid_3#6795, cpfk_nation_supplier#6778 AS cpfk_nation_supplier_3#6796, cfpk_supplier_nation#6779 AS cfpk_supplier_nation_3#6797, cval_supplier_s_name#6780 AS cval_supplier_s_name_3#6798, cval_supplier_s_address#6781 AS cval_supplier_s_address_3#6799, cval_supplier_s_phone#6782 AS cval_supplier_s_phone_3#6800, cval_supplier_s_acctbal#6783 AS cval_supplier_s_acctbal_3#6801, cval_supplier_s_comment#6784 AS cval_supplier_s_comment_3#6802, cdepval_supplier_s_name#6785 AS cdepval_supplier_s_name_3#6803, cdepval_supplier_s_address#6786 AS cdepval_supplier_s_address_3#6804, cdepval_supplier_s_phone#6787 AS cdepval_supplier_s_phone_3#6805, cdepval_supplier_s_acctbal#6788 AS cdepval_supplier_s_acctbal_3#6806, cdepval_supplier_s_comment#6789 AS cdepval_supplier_s_comment_3#6807, cs_name#6790 AS cs_name_3#6808, cs_address#6791 AS cs_address_3#6809, cs_phone#6792 AS cs_phone_3#6810, cs_acctbal#6793 AS cs_acctbal_3#6811, cs_comment#6794 AS cs_comment_3#6812]
                  +- Relation[rid#6777,cpfk_nation_supplier#6778,cfpk_supplier_nation#6779,cval_supplier_s_name#6780,cval_supplier_s_address#6781,cval_supplier_s_phone#6782,cval_supplier_s_acctbal#6783,cval_supplier_s_comment#6784,cdepval_supplier_s_name#6785,cdepval_supplier_s_address#6786,cdepval_supplier_s_phone#6787,cdepval_supplier_s_acctbal#6788,cdepval_supplier_s_comment#6789,cs_name#6790,cs_address#6791,cs_phone#6792,cs_acctbal#6793,cs_comment#6794] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 160248ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/26 22:14:30 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:14:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7049L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:14:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#7049L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#7051 AS rid_0#7096, cpfk_orders_lineitem#7052 AS cpfk_orders_lineitem_0#7097, cpfk_supplier_lineitem#7053 AS cpfk_supplier_lineitem_0#7098, cfpk_lineitem_supplier#7054 AS cfpk_lineitem_supplier_0#7099, cfpk_lineitem_partsupp#7055 AS cfpk_lineitem_partsupp_0#7100, cpfk_part_lineitem#7056 AS cpfk_part_lineitem_0#7101, cfpk_lineitem_part#7057 AS cfpk_lineitem_part_0#7102, cpfk_partsupp_lineitem#7058 AS cpfk_partsupp_lineitem_0#7103, cfpk_lineitem_orders#7059 AS cfpk_lineitem_orders_0#7104, cval_lineitem_l_quantity#7060 AS cval_lineitem_l_quantity_0#7105, cval_lineitem_l_extendedprice#7061 AS cval_lineitem_l_extendedprice_0#7106, cval_lineitem_l_discount#7062 AS cval_lineitem_l_discount_0#7107, cval_lineitem_l_tax#7063 AS cval_lineitem_l_tax_0#7108, cval_lineitem_l_returnflag#7064 AS cval_lineitem_l_returnflag_0#7109, cval_lineitem_l_linestatus#7065 AS cval_lineitem_l_linestatus_0#7110, cval_lineitem_l_commitdate#7066 AS cval_lineitem_l_commitdate_0#7111, cval_lineitem_l_receiptdate#7067 AS cval_lineitem_l_receiptdate_0#7112, cval_lineitem_l_shipinstruct#7068 AS cval_lineitem_l_shipinstruct_0#7113, cval_lineitem_l_shipmode#7069 AS cval_lineitem_l_shipmode_0#7114, cval_lineitem_l_comment#7070 AS cval_lineitem_l_comment_0#7115, cval_lineitem_l_shipdate#7071 AS cval_lineitem_l_shipdate_0#7116, cdepval_lineitem_l_quantity#7072 AS cdepval_lineitem_l_quantity_0#7117, cdepval_lineitem_l_extendedprice#7073 AS cdepval_lineitem_l_extendedprice_0#7118, cdepval_lineitem_l_discount#7074 AS cdepval_lineitem_l_discount_0#7119, ... 21 more fields]
         +- Relation[rid#7051,cpfk_orders_lineitem#7052,cpfk_supplier_lineitem#7053,cfpk_lineitem_supplier#7054,cfpk_lineitem_partsupp#7055,cpfk_part_lineitem#7056,cfpk_lineitem_part#7057,cpfk_partsupp_lineitem#7058,cfpk_lineitem_orders#7059,cval_lineitem_l_quantity#7060,cval_lineitem_l_extendedprice#7061,cval_lineitem_l_discount#7062,cval_lineitem_l_tax#7063,cval_lineitem_l_returnflag#7064,cval_lineitem_l_linestatus#7065,cval_lineitem_l_commitdate#7066,cval_lineitem_l_receiptdate#7067,cval_lineitem_l_shipinstruct#7068,cval_lineitem_l_shipmode#7069,cval_lineitem_l_comment#7070,cval_lineitem_l_shipdate#7071,cdepval_lineitem_l_quantity#7072,cdepval_lineitem_l_extendedprice#7073,cdepval_lineitem_l_discount#7074,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2398ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 22:14:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:14:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7195L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 22:14:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:14:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:14:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:14:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:14:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:14:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:14:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:14:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:14:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:14:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:14:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:14:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7195L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#7329 AS rid_4#7374, cpfk_orders_lineitem#7330 AS cpfk_orders_lineitem_4#7375, cpfk_supplier_lineitem#7331 AS cpfk_supplier_lineitem_4#7376, cfpk_lineitem_supplier#7332 AS cfpk_lineitem_supplier_4#7377, cfpk_lineitem_partsupp#7333 AS cfpk_lineitem_partsupp_4#7378, cpfk_part_lineitem#7334 AS cpfk_part_lineitem_4#7379, cfpk_lineitem_part#7335 AS cfpk_lineitem_part_4#7380, cpfk_partsupp_lineitem#7336 AS cpfk_partsupp_lineitem_4#7381, cfpk_lineitem_orders#7337 AS cfpk_lineitem_orders_4#7382, cval_lineitem_l_quantity#7338 AS cval_lineitem_l_quantity_4#7383, cval_lineitem_l_extendedprice#7339 AS cval_lineitem_l_extendedprice_4#7384, cval_lineitem_l_discount#7340 AS cval_lineitem_l_discount_4#7385, cval_lineitem_l_tax#7341 AS cval_lineitem_l_tax_4#7386, cval_lineitem_l_returnflag#7342 AS cval_lineitem_l_returnflag_4#7387, cval_lineitem_l_linestatus#7343 AS cval_lineitem_l_linestatus_4#7388, cval_lineitem_l_commitdate#7344 AS cval_lineitem_l_commitdate_4#7389, cval_lineitem_l_receiptdate#7345 AS cval_lineitem_l_receiptdate_4#7390, cval_lineitem_l_shipinstruct#7346 AS cval_lineitem_l_shipinstruct_4#7391, cval_lineitem_l_shipmode#7347 AS cval_lineitem_l_shipmode_4#7392, cval_lineitem_l_comment#7348 AS cval_lineitem_l_comment_4#7393, cval_lineitem_l_shipdate#7349 AS cval_lineitem_l_shipdate_4#7394, cdepval_lineitem_l_quantity#7350 AS cdepval_lineitem_l_quantity_4#7395, cdepval_lineitem_l_extendedprice#7351 AS cdepval_lineitem_l_extendedprice_4#7396, cdepval_lineitem_l_discount#7352 AS cdepval_lineitem_l_discount_4#7397, ... 21 more fields]
         :  :  +- Relation[rid#7329,cpfk_orders_lineitem#7330,cpfk_supplier_lineitem#7331,cfpk_lineitem_supplier#7332,cfpk_lineitem_partsupp#7333,cpfk_part_lineitem#7334,cfpk_lineitem_part#7335,cpfk_partsupp_lineitem#7336,cfpk_lineitem_orders#7337,cval_lineitem_l_quantity#7338,cval_lineitem_l_extendedprice#7339,cval_lineitem_l_discount#7340,cval_lineitem_l_tax#7341,cval_lineitem_l_returnflag#7342,cval_lineitem_l_linestatus#7343,cval_lineitem_l_commitdate#7344,cval_lineitem_l_receiptdate#7345,cval_lineitem_l_shipinstruct#7346,cval_lineitem_l_shipmode#7347,cval_lineitem_l_comment#7348,cval_lineitem_l_shipdate#7349,cdepval_lineitem_l_quantity#7350,cdepval_lineitem_l_extendedprice#7351,cdepval_lineitem_l_discount#7352,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#7251 AS rid_2#7265, cpfk_part_partsupp#7252 AS cpfk_part_partsupp_2#7266, cfpk_partsupp_part#7253 AS cfpk_partsupp_part_2#7267, cpfk_supplier_partsupp#7254 AS cpfk_supplier_partsupp_2#7268, cfpk_partsupp_supplier#7255 AS cfpk_partsupp_supplier_2#7269, cval_partsupp_ps_availqty#7256 AS cval_partsupp_ps_availqty_2#7270, cval_partsupp_ps_supplycost#7257 AS cval_partsupp_ps_supplycost_2#7271, cval_partsupp_ps_comment#7258 AS cval_partsupp_ps_comment_2#7272, cdepval_partsupp_ps_availqty#7259 AS cdepval_partsupp_ps_availqty_2#7273, cdepval_partsupp_ps_supplycost#7260 AS cdepval_partsupp_ps_supplycost_2#7274, cdepval_partsupp_ps_comment#7261 AS cdepval_partsupp_ps_comment_2#7275, cps_availqty#7262 AS cps_availqty_2#7276, cps_supplycost#7263 AS cps_supplycost_2#7277, cps_comment#7264 AS cps_comment_2#7278]
         :     :  :  +- Relation[rid#7251,cpfk_part_partsupp#7252,cfpk_partsupp_part#7253,cpfk_supplier_partsupp#7254,cfpk_partsupp_supplier#7255,cval_partsupp_ps_availqty#7256,cval_partsupp_ps_supplycost#7257,cval_partsupp_ps_comment#7258,cdepval_partsupp_ps_availqty#7259,cdepval_partsupp_ps_supplycost#7260,cdepval_partsupp_ps_comment#7261,cps_availqty#7262,cps_supplycost#7263,cps_comment#7264] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#7215 AS rid_1#7233, cpfk_nation_supplier#7216 AS cpfk_nation_supplier_1#7234, cfpk_supplier_nation#7217 AS cfpk_supplier_nation_1#7235, cval_supplier_s_name#7218 AS cval_supplier_s_name_1#7236, cval_supplier_s_address#7219 AS cval_supplier_s_address_1#7237, cval_supplier_s_phone#7220 AS cval_supplier_s_phone_1#7238, cval_supplier_s_acctbal#7221 AS cval_supplier_s_acctbal_1#7239, cval_supplier_s_comment#7222 AS cval_supplier_s_comment_1#7240, cdepval_supplier_s_name#7223 AS cdepval_supplier_s_name_1#7241, cdepval_supplier_s_address#7224 AS cdepval_supplier_s_address_1#7242, cdepval_supplier_s_phone#7225 AS cdepval_supplier_s_phone_1#7243, cdepval_supplier_s_acctbal#7226 AS cdepval_supplier_s_acctbal_1#7244, cdepval_supplier_s_comment#7227 AS cdepval_supplier_s_comment_1#7245, cs_name#7228 AS cs_name_1#7246, cs_address#7229 AS cs_address_1#7247, cs_phone#7230 AS cs_phone_1#7248, cs_acctbal#7231 AS cs_acctbal_1#7249, cs_comment#7232 AS cs_comment_1#7250]
         :     :     :  +- Relation[rid#7215,cpfk_nation_supplier#7216,cfpk_supplier_nation#7217,cval_supplier_s_name#7218,cval_supplier_s_address#7219,cval_supplier_s_phone#7220,cval_supplier_s_acctbal#7221,cval_supplier_s_comment#7222,cdepval_supplier_s_name#7223,cdepval_supplier_s_address#7224,cdepval_supplier_s_phone#7225,cdepval_supplier_s_acctbal#7226,cdepval_supplier_s_comment#7227,cs_name#7228,cs_address#7229,cs_phone#7230,cs_acctbal#7231,cs_comment#7232] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#7197 AS rid_0#7206, cpfk_region_nation#7198 AS cpfk_region_nation_0#7207, cfpk_nation_region#7199 AS cfpk_nation_region_0#7208, cval_nation_n_name#7200 AS cval_nation_n_name_0#7209, cval_nation_n_comment#7201 AS cval_nation_n_comment_0#7210, cdepval_nation_n_name#7202 AS cdepval_nation_n_name_0#7211, cdepval_nation_n_comment#7203 AS cdepval_nation_n_comment_0#7212, cn_name#7204 AS cn_name_0#7213, cn_comment#7205 AS cn_comment_0#7214]
         :     :        +- Relation[rid#7197,cpfk_region_nation#7198,cfpk_nation_region#7199,cval_nation_n_name#7200,cval_nation_n_comment#7201,cdepval_nation_n_name#7202,cdepval_nation_n_comment#7203,cn_name#7204,cn_comment#7205] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#7279 AS rid_3#7304, cval_part_p_name#7280 AS cval_part_p_name_3#7305, cval_part_p_mfgr#7281 AS cval_part_p_mfgr_3#7306, cval_part_p_type#7282 AS cval_part_p_type_3#7307, cval_part_p_size#7283 AS cval_part_p_size_3#7308, cval_part_p_container#7284 AS cval_part_p_container_3#7309, cval_part_p_retailprice#7285 AS cval_part_p_retailprice_3#7310, cval_part_p_comment#7286 AS cval_part_p_comment_3#7311, cval_part_p_brand#7287 AS cval_part_p_brand_3#7312, cdepval_part_p_name#7288 AS cdepval_part_p_name_3#7313, cdepval_part_p_mfgr#7289 AS cdepval_part_p_mfgr_3#7314, cdepval_part_p_type#7290 AS cdepval_part_p_type_3#7315, cdepval_part_p_size#7291 AS cdepval_part_p_size_3#7316, cdepval_part_p_container#7292 AS cdepval_part_p_container_3#7317, cdepval_part_p_retailprice#7293 AS cdepval_part_p_retailprice_3#7318, cdepval_part_p_comment#7294 AS cdepval_part_p_comment_3#7319, cdepval_part_p_brand#7295 AS cdepval_part_p_brand_3#7320, cp_name#7296 AS cp_name_3#7321, cp_mfgr#7297 AS cp_mfgr_3#7322, cp_type#7298 AS cp_type_3#7323, cp_size#7299 AS cp_size_3#7324, cp_container#7300 AS cp_container_3#7325, cp_retailprice#7301 AS cp_retailprice_3#7326, cp_comment#7302 AS cp_comment_3#7327, cp_brand#7303 AS cp_brand_3#7328]
         :        +- Relation[rid#7279,cval_part_p_name#7280,cval_part_p_mfgr#7281,cval_part_p_type#7282,cval_part_p_size#7283,cval_part_p_container#7284,cval_part_p_retailprice#7285,cval_part_p_comment#7286,cval_part_p_brand#7287,cdepval_part_p_name#7288,cdepval_part_p_mfgr#7289,cdepval_part_p_type#7290,cdepval_part_p_size#7291,cdepval_part_p_container#7292,cdepval_part_p_retailprice#7293,cdepval_part_p_comment#7294,cdepval_part_p_brand#7295,cp_name#7296,cp_mfgr#7297,cp_type#7298,cp_size#7299,cp_container#7300,cp_retailprice#7301,cp_comment#7302,cp_brand#7303] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#7419 AS rid_5#7443, cpfk_customer_orders#7420 AS cpfk_customer_orders_5#7444, cfpk_orders_customer#7421 AS cfpk_orders_customer_5#7445, cval_orders_o_orderstatus#7422 AS cval_orders_o_orderstatus_5#7446, cval_orders_o_totalprice#7423 AS cval_orders_o_totalprice_5#7447, cval_orders_o_orderpriority#7424 AS cval_orders_o_orderpriority_5#7448, cval_orders_o_clerk#7425 AS cval_orders_o_clerk_5#7449, cval_orders_o_shippriority#7426 AS cval_orders_o_shippriority_5#7450, cval_orders_o_comment#7427 AS cval_orders_o_comment_5#7451, cval_orders_o_orderdate#7428 AS cval_orders_o_orderdate_5#7452, cdepval_orders_o_orderstatus#7429 AS cdepval_orders_o_orderstatus_5#7453, cdepval_orders_o_totalprice#7430 AS cdepval_orders_o_totalprice_5#7454, cdepval_orders_o_orderpriority#7431 AS cdepval_orders_o_orderpriority_5#7455, cdepval_orders_o_clerk#7432 AS cdepval_orders_o_clerk_5#7456, cdepval_orders_o_shippriority#7433 AS cdepval_orders_o_shippriority_5#7457, cdepval_orders_o_comment#7434 AS cdepval_orders_o_comment_5#7458, cdepval_orders_o_orderdate#7435 AS cdepval_orders_o_orderdate_5#7459, co_orderstatus#7436 AS co_orderstatus_5#7460, co_totalprice#7437 AS co_totalprice_5#7461, co_orderpriority#7438 AS co_orderpriority_5#7462, co_clerk#7439 AS co_clerk_5#7463, co_shippriority#7440 AS co_shippriority_5#7464, co_comment#7441 AS co_comment_5#7465, co_orderdate#7442 AS co_orderdate_5#7466]
            +- Relation[rid#7419,cpfk_customer_orders#7420,cfpk_orders_customer#7421,cval_orders_o_orderstatus#7422,cval_orders_o_totalprice#7423,cval_orders_o_orderpriority#7424,cval_orders_o_clerk#7425,cval_orders_o_shippriority#7426,cval_orders_o_comment#7427,cval_orders_o_orderdate#7428,cdepval_orders_o_orderstatus#7429,cdepval_orders_o_totalprice#7430,cdepval_orders_o_orderpriority#7431,cdepval_orders_o_clerk#7432,cdepval_orders_o_shippriority#7433,cdepval_orders_o_comment#7434,cdepval_orders_o_orderdate#7435,co_orderstatus#7436,co_totalprice#7437,co_orderpriority#7438,co_clerk#7439,co_shippriority#7440,co_comment#7441,co_orderdate#7442] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 37866ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/26 22:15:10 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:15:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7609L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:15:10 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:15:10 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 22:15:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7609L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#7647 AS rid_1#7692, cpfk_orders_lineitem#7648 AS cpfk_orders_lineitem_1#7693, cpfk_supplier_lineitem#7649 AS cpfk_supplier_lineitem_1#7694, cfpk_lineitem_supplier#7650 AS cfpk_lineitem_supplier_1#7695, cfpk_lineitem_partsupp#7651 AS cfpk_lineitem_partsupp_1#7696, cpfk_part_lineitem#7652 AS cpfk_part_lineitem_1#7697, cfpk_lineitem_part#7653 AS cfpk_lineitem_part_1#7698, cpfk_partsupp_lineitem#7654 AS cpfk_partsupp_lineitem_1#7699, cfpk_lineitem_orders#7655 AS cfpk_lineitem_orders_1#7700, cval_lineitem_l_quantity#7656 AS cval_lineitem_l_quantity_1#7701, cval_lineitem_l_extendedprice#7657 AS cval_lineitem_l_extendedprice_1#7702, cval_lineitem_l_discount#7658 AS cval_lineitem_l_discount_1#7703, cval_lineitem_l_tax#7659 AS cval_lineitem_l_tax_1#7704, cval_lineitem_l_returnflag#7660 AS cval_lineitem_l_returnflag_1#7705, cval_lineitem_l_linestatus#7661 AS cval_lineitem_l_linestatus_1#7706, cval_lineitem_l_commitdate#7662 AS cval_lineitem_l_commitdate_1#7707, cval_lineitem_l_receiptdate#7663 AS cval_lineitem_l_receiptdate_1#7708, cval_lineitem_l_shipinstruct#7664 AS cval_lineitem_l_shipinstruct_1#7709, cval_lineitem_l_shipmode#7665 AS cval_lineitem_l_shipmode_1#7710, cval_lineitem_l_comment#7666 AS cval_lineitem_l_comment_1#7711, cval_lineitem_l_shipdate#7667 AS cval_lineitem_l_shipdate_1#7712, cdepval_lineitem_l_quantity#7668 AS cdepval_lineitem_l_quantity_1#7713, cdepval_lineitem_l_extendedprice#7669 AS cdepval_lineitem_l_extendedprice_1#7714, cdepval_lineitem_l_discount#7670 AS cdepval_lineitem_l_discount_1#7715, ... 21 more fields]
         :  +- Relation[rid#7647,cpfk_orders_lineitem#7648,cpfk_supplier_lineitem#7649,cfpk_lineitem_supplier#7650,cfpk_lineitem_partsupp#7651,cpfk_part_lineitem#7652,cfpk_lineitem_part#7653,cpfk_partsupp_lineitem#7654,cfpk_lineitem_orders#7655,cval_lineitem_l_quantity#7656,cval_lineitem_l_extendedprice#7657,cval_lineitem_l_discount#7658,cval_lineitem_l_tax#7659,cval_lineitem_l_returnflag#7660,cval_lineitem_l_linestatus#7661,cval_lineitem_l_commitdate#7662,cval_lineitem_l_receiptdate#7663,cval_lineitem_l_shipinstruct#7664,cval_lineitem_l_shipmode#7665,cval_lineitem_l_comment#7666,cval_lineitem_l_shipdate#7667,cdepval_lineitem_l_quantity#7668,cdepval_lineitem_l_extendedprice#7669,cdepval_lineitem_l_discount#7670,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7611 AS rid_0#7629, cpfk_nation_supplier#7612 AS cpfk_nation_supplier_0#7630, cfpk_supplier_nation#7613 AS cfpk_supplier_nation_0#7631, cval_supplier_s_name#7614 AS cval_supplier_s_name_0#7632, cval_supplier_s_address#7615 AS cval_supplier_s_address_0#7633, cval_supplier_s_phone#7616 AS cval_supplier_s_phone_0#7634, cval_supplier_s_acctbal#7617 AS cval_supplier_s_acctbal_0#7635, cval_supplier_s_comment#7618 AS cval_supplier_s_comment_0#7636, cdepval_supplier_s_name#7619 AS cdepval_supplier_s_name_0#7637, cdepval_supplier_s_address#7620 AS cdepval_supplier_s_address_0#7638, cdepval_supplier_s_phone#7621 AS cdepval_supplier_s_phone_0#7639, cdepval_supplier_s_acctbal#7622 AS cdepval_supplier_s_acctbal_0#7640, cdepval_supplier_s_comment#7623 AS cdepval_supplier_s_comment_0#7641, cs_name#7624 AS cs_name_0#7642, cs_address#7625 AS cs_address_0#7643, cs_phone#7626 AS cs_phone_0#7644, cs_acctbal#7627 AS cs_acctbal_0#7645, cs_comment#7628 AS cs_comment_0#7646]
            +- Relation[rid#7611,cpfk_nation_supplier#7612,cfpk_supplier_nation#7613,cval_supplier_s_name#7614,cval_supplier_s_address#7615,cval_supplier_s_phone#7616,cval_supplier_s_acctbal#7617,cval_supplier_s_comment#7618,cdepval_supplier_s_name#7619,cdepval_supplier_s_address#7620,cdepval_supplier_s_phone#7621,cdepval_supplier_s_acctbal#7622,cdepval_supplier_s_comment#7623,cs_name#7624,cs_address#7625,cs_phone#7626,cs_acctbal#7627,cs_comment#7628] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17180ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/26 22:15:27 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:15:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7806L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:15:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7806L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#7858 AS rid_1#7903, cpfk_orders_lineitem#7859 AS cpfk_orders_lineitem_1#7904, cpfk_supplier_lineitem#7860 AS cpfk_supplier_lineitem_1#7905, cfpk_lineitem_supplier#7861 AS cfpk_lineitem_supplier_1#7906, cfpk_lineitem_partsupp#7862 AS cfpk_lineitem_partsupp_1#7907, cpfk_part_lineitem#7863 AS cpfk_part_lineitem_1#7908, cfpk_lineitem_part#7864 AS cfpk_lineitem_part_1#7909, cpfk_partsupp_lineitem#7865 AS cpfk_partsupp_lineitem_1#7910, cfpk_lineitem_orders#7866 AS cfpk_lineitem_orders_1#7911, cval_lineitem_l_quantity#7867 AS cval_lineitem_l_quantity_1#7912, cval_lineitem_l_extendedprice#7868 AS cval_lineitem_l_extendedprice_1#7913, cval_lineitem_l_discount#7869 AS cval_lineitem_l_discount_1#7914, cval_lineitem_l_tax#7870 AS cval_lineitem_l_tax_1#7915, cval_lineitem_l_returnflag#7871 AS cval_lineitem_l_returnflag_1#7916, cval_lineitem_l_linestatus#7872 AS cval_lineitem_l_linestatus_1#7917, cval_lineitem_l_commitdate#7873 AS cval_lineitem_l_commitdate_1#7918, cval_lineitem_l_receiptdate#7874 AS cval_lineitem_l_receiptdate_1#7919, cval_lineitem_l_shipinstruct#7875 AS cval_lineitem_l_shipinstruct_1#7920, cval_lineitem_l_shipmode#7876 AS cval_lineitem_l_shipmode_1#7921, cval_lineitem_l_comment#7877 AS cval_lineitem_l_comment_1#7922, cval_lineitem_l_shipdate#7878 AS cval_lineitem_l_shipdate_1#7923, cdepval_lineitem_l_quantity#7879 AS cdepval_lineitem_l_quantity_1#7924, cdepval_lineitem_l_extendedprice#7880 AS cdepval_lineitem_l_extendedprice_1#7925, cdepval_lineitem_l_discount#7881 AS cdepval_lineitem_l_discount_1#7926, ... 21 more fields]
         :  +- Relation[rid#7858,cpfk_orders_lineitem#7859,cpfk_supplier_lineitem#7860,cfpk_lineitem_supplier#7861,cfpk_lineitem_partsupp#7862,cpfk_part_lineitem#7863,cfpk_lineitem_part#7864,cpfk_partsupp_lineitem#7865,cfpk_lineitem_orders#7866,cval_lineitem_l_quantity#7867,cval_lineitem_l_extendedprice#7868,cval_lineitem_l_discount#7869,cval_lineitem_l_tax#7870,cval_lineitem_l_returnflag#7871,cval_lineitem_l_linestatus#7872,cval_lineitem_l_commitdate#7873,cval_lineitem_l_receiptdate#7874,cval_lineitem_l_shipinstruct#7875,cval_lineitem_l_shipmode#7876,cval_lineitem_l_comment#7877,cval_lineitem_l_shipdate#7878,cdepval_lineitem_l_quantity#7879,cdepval_lineitem_l_extendedprice#7880,cdepval_lineitem_l_discount#7881,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7808 AS rid_0#7833, cval_part_p_name#7809 AS cval_part_p_name_0#7834, cval_part_p_mfgr#7810 AS cval_part_p_mfgr_0#7835, cval_part_p_type#7811 AS cval_part_p_type_0#7836, cval_part_p_size#7812 AS cval_part_p_size_0#7837, cval_part_p_container#7813 AS cval_part_p_container_0#7838, cval_part_p_retailprice#7814 AS cval_part_p_retailprice_0#7839, cval_part_p_comment#7815 AS cval_part_p_comment_0#7840, cval_part_p_brand#7816 AS cval_part_p_brand_0#7841, cdepval_part_p_name#7817 AS cdepval_part_p_name_0#7842, cdepval_part_p_mfgr#7818 AS cdepval_part_p_mfgr_0#7843, cdepval_part_p_type#7819 AS cdepval_part_p_type_0#7844, cdepval_part_p_size#7820 AS cdepval_part_p_size_0#7845, cdepval_part_p_container#7821 AS cdepval_part_p_container_0#7846, cdepval_part_p_retailprice#7822 AS cdepval_part_p_retailprice_0#7847, cdepval_part_p_comment#7823 AS cdepval_part_p_comment_0#7848, cdepval_part_p_brand#7824 AS cdepval_part_p_brand_0#7849, cp_name#7825 AS cp_name_0#7850, cp_mfgr#7826 AS cp_mfgr_0#7851, cp_type#7827 AS cp_type_0#7852, cp_size#7828 AS cp_size_0#7853, cp_container#7829 AS cp_container_0#7854, cp_retailprice#7830 AS cp_retailprice_0#7855, cp_comment#7831 AS cp_comment_0#7856, cp_brand#7832 AS cp_brand_0#7857]
            +- Relation[rid#7808,cval_part_p_name#7809,cval_part_p_mfgr#7810,cval_part_p_type#7811,cval_part_p_size#7812,cval_part_p_container#7813,cval_part_p_retailprice#7814,cval_part_p_comment#7815,cval_part_p_brand#7816,cdepval_part_p_name#7817,cdepval_part_p_mfgr#7818,cdepval_part_p_type#7819,cdepval_part_p_size#7820,cdepval_part_p_container#7821,cdepval_part_p_retailprice#7822,cdepval_part_p_comment#7823,cdepval_part_p_brand#7824,cp_name#7825,cp_mfgr#7826,cp_type#7827,cp_size#7828,cp_container#7829,cp_retailprice#7830,cp_comment#7831,cp_brand#7832] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17728ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/26 22:15:45 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:15:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8023L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:15:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#8023L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#8025 AS rid_0#8070, cpfk_orders_lineitem#8026 AS cpfk_orders_lineitem_0#8071, cpfk_supplier_lineitem#8027 AS cpfk_supplier_lineitem_0#8072, cfpk_lineitem_supplier#8028 AS cfpk_lineitem_supplier_0#8073, cfpk_lineitem_partsupp#8029 AS cfpk_lineitem_partsupp_0#8074, cpfk_part_lineitem#8030 AS cpfk_part_lineitem_0#8075, cfpk_lineitem_part#8031 AS cfpk_lineitem_part_0#8076, cpfk_partsupp_lineitem#8032 AS cpfk_partsupp_lineitem_0#8077, cfpk_lineitem_orders#8033 AS cfpk_lineitem_orders_0#8078, cval_lineitem_l_quantity#8034 AS cval_lineitem_l_quantity_0#8079, cval_lineitem_l_extendedprice#8035 AS cval_lineitem_l_extendedprice_0#8080, cval_lineitem_l_discount#8036 AS cval_lineitem_l_discount_0#8081, cval_lineitem_l_tax#8037 AS cval_lineitem_l_tax_0#8082, cval_lineitem_l_returnflag#8038 AS cval_lineitem_l_returnflag_0#8083, cval_lineitem_l_linestatus#8039 AS cval_lineitem_l_linestatus_0#8084, cval_lineitem_l_commitdate#8040 AS cval_lineitem_l_commitdate_0#8085, cval_lineitem_l_receiptdate#8041 AS cval_lineitem_l_receiptdate_0#8086, cval_lineitem_l_shipinstruct#8042 AS cval_lineitem_l_shipinstruct_0#8087, cval_lineitem_l_shipmode#8043 AS cval_lineitem_l_shipmode_0#8088, cval_lineitem_l_comment#8044 AS cval_lineitem_l_comment_0#8089, cval_lineitem_l_shipdate#8045 AS cval_lineitem_l_shipdate_0#8090, cdepval_lineitem_l_quantity#8046 AS cdepval_lineitem_l_quantity_0#8091, cdepval_lineitem_l_extendedprice#8047 AS cdepval_lineitem_l_extendedprice_0#8092, cdepval_lineitem_l_discount#8048 AS cdepval_lineitem_l_discount_0#8093, ... 21 more fields]
         +- Relation[rid#8025,cpfk_orders_lineitem#8026,cpfk_supplier_lineitem#8027,cfpk_lineitem_supplier#8028,cfpk_lineitem_partsupp#8029,cpfk_part_lineitem#8030,cfpk_lineitem_part#8031,cpfk_partsupp_lineitem#8032,cfpk_lineitem_orders#8033,cval_lineitem_l_quantity#8034,cval_lineitem_l_extendedprice#8035,cval_lineitem_l_discount#8036,cval_lineitem_l_tax#8037,cval_lineitem_l_returnflag#8038,cval_lineitem_l_linestatus#8039,cval_lineitem_l_commitdate#8040,cval_lineitem_l_receiptdate#8041,cval_lineitem_l_shipinstruct#8042,cval_lineitem_l_shipmode#8043,cval_lineitem_l_comment#8044,cval_lineitem_l_shipdate#8045,cdepval_lineitem_l_quantity#8046,cdepval_lineitem_l_extendedprice#8047,cdepval_lineitem_l_discount#8048,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 4350ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/26 22:15:50 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:15:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8164L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:15:50 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:15:50 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:15:50 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:15:50 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:15:50 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:15:50 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:15:50 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 22:15:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8164L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#8191, cval_part_p_name_0#8192, cval_part_p_mfgr_0#8193, cval_part_p_type_0#8194, cval_part_p_size_0#8195, cval_part_p_container_0#8196, cval_part_p_retailprice_0#8197, cval_part_p_comment_0#8198, cval_part_p_brand_0#8199, cdepval_part_p_name_0#8200, cdepval_part_p_mfgr_0#8201, cdepval_part_p_type_0#8202, cdepval_part_p_size_0#8203, cdepval_part_p_container_0#8204, cdepval_part_p_retailprice_0#8205, cdepval_part_p_comment_0#8206, cdepval_part_p_brand_0#8207, cp_name_0#8208, cp_mfgr_0#8209, cp_type_0#8210, cp_size_0#8211, cp_container_0#8212, cp_retailprice_0#8213, cp_comment_0#8214, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#8166 AS rid_0#8191, cval_part_p_name#8167 AS cval_part_p_name_0#8192, cval_part_p_mfgr#8168 AS cval_part_p_mfgr_0#8193, cval_part_p_type#8169 AS cval_part_p_type_0#8194, cval_part_p_size#8170 AS cval_part_p_size_0#8195, cval_part_p_container#8171 AS cval_part_p_container_0#8196, cval_part_p_retailprice#8172 AS cval_part_p_retailprice_0#8197, cval_part_p_comment#8173 AS cval_part_p_comment_0#8198, cval_part_p_brand#8174 AS cval_part_p_brand_0#8199, cdepval_part_p_name#8175 AS cdepval_part_p_name_0#8200, cdepval_part_p_mfgr#8176 AS cdepval_part_p_mfgr_0#8201, cdepval_part_p_type#8177 AS cdepval_part_p_type_0#8202, cdepval_part_p_size#8178 AS cdepval_part_p_size_0#8203, cdepval_part_p_container#8179 AS cdepval_part_p_container_0#8204, cdepval_part_p_retailprice#8180 AS cdepval_part_p_retailprice_0#8205, cdepval_part_p_comment#8181 AS cdepval_part_p_comment_0#8206, cdepval_part_p_brand#8182 AS cdepval_part_p_brand_0#8207, cp_name#8183 AS cp_name_0#8208, cp_mfgr#8184 AS cp_mfgr_0#8209, cp_type#8185 AS cp_type_0#8210, cp_size#8186 AS cp_size_0#8211, cp_container#8187 AS cp_container_0#8212, cp_retailprice#8188 AS cp_retailprice_0#8213, cp_comment#8189 AS cp_comment_0#8214, cp_brand#8190 AS cp_brand_0#8215]
         :  :        +- Relation[rid#8166,cval_part_p_name#8167,cval_part_p_mfgr#8168,cval_part_p_type#8169,cval_part_p_size#8170,cval_part_p_container#8171,cval_part_p_retailprice#8172,cval_part_p_comment#8173,cval_part_p_brand#8174,cdepval_part_p_name#8175,cdepval_part_p_mfgr#8176,cdepval_part_p_type#8177,cdepval_part_p_size#8178,cdepval_part_p_container#8179,cdepval_part_p_retailprice#8180,cdepval_part_p_comment#8181,cdepval_part_p_brand#8182,cp_name#8183,cp_mfgr#8184,cp_type#8185,cp_size#8186,cp_container#8187,cp_retailprice#8188,cp_comment#8189,cp_brand#8190] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#8456 AS rid_1#8501, cpfk_orders_lineitem#8457 AS cpfk_orders_lineitem_1#8502, cpfk_supplier_lineitem#8458 AS cpfk_supplier_lineitem_1#8503, cfpk_lineitem_supplier#8459 AS cfpk_lineitem_supplier_1#8504, cfpk_lineitem_partsupp#8460 AS cfpk_lineitem_partsupp_1#8505, cpfk_part_lineitem#8461 AS cpfk_part_lineitem_1#8506, cfpk_lineitem_part#8462 AS cfpk_lineitem_part_1#8507, cpfk_partsupp_lineitem#8463 AS cpfk_partsupp_lineitem_1#8508, cfpk_lineitem_orders#8464 AS cfpk_lineitem_orders_1#8509, cval_lineitem_l_quantity#8465 AS cval_lineitem_l_quantity_1#8510, cval_lineitem_l_extendedprice#8466 AS cval_lineitem_l_extendedprice_1#8511, cval_lineitem_l_discount#8467 AS cval_lineitem_l_discount_1#8512, cval_lineitem_l_tax#8468 AS cval_lineitem_l_tax_1#8513, cval_lineitem_l_returnflag#8469 AS cval_lineitem_l_returnflag_1#8514, cval_lineitem_l_linestatus#8470 AS cval_lineitem_l_linestatus_1#8515, cval_lineitem_l_commitdate#8471 AS cval_lineitem_l_commitdate_1#8516, cval_lineitem_l_receiptdate#8472 AS cval_lineitem_l_receiptdate_1#8517, cval_lineitem_l_shipinstruct#8473 AS cval_lineitem_l_shipinstruct_1#8518, cval_lineitem_l_shipmode#8474 AS cval_lineitem_l_shipmode_1#8519, cval_lineitem_l_comment#8475 AS cval_lineitem_l_comment_1#8520, cval_lineitem_l_shipdate#8476 AS cval_lineitem_l_shipdate_1#8521, cdepval_lineitem_l_quantity#8477 AS cdepval_lineitem_l_quantity_1#8522, cdepval_lineitem_l_extendedprice#8478 AS cdepval_lineitem_l_extendedprice_1#8523, cdepval_lineitem_l_discount#8479 AS cdepval_lineitem_l_discount_1#8524, ... 21 more fields]
         :        +- Relation[rid#8456,cpfk_orders_lineitem#8457,cpfk_supplier_lineitem#8458,cfpk_lineitem_supplier#8459,cfpk_lineitem_partsupp#8460,cpfk_part_lineitem#8461,cfpk_lineitem_part#8462,cpfk_partsupp_lineitem#8463,cfpk_lineitem_orders#8464,cval_lineitem_l_quantity#8465,cval_lineitem_l_extendedprice#8466,cval_lineitem_l_discount#8467,cval_lineitem_l_tax#8468,cval_lineitem_l_returnflag#8469,cval_lineitem_l_linestatus#8470,cval_lineitem_l_commitdate#8471,cval_lineitem_l_receiptdate#8472,cval_lineitem_l_shipinstruct#8473,cval_lineitem_l_shipmode#8474,cval_lineitem_l_comment#8475,cval_lineitem_l_shipdate#8476,cdepval_lineitem_l_quantity#8477,cdepval_lineitem_l_extendedprice#8478,cdepval_lineitem_l_discount#8479,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8316 AS rid_1#8361, cpfk_orders_lineitem#8317 AS cpfk_orders_lineitem_1#8362, cpfk_supplier_lineitem#8318 AS cpfk_supplier_lineitem_1#8363, cfpk_lineitem_supplier#8319 AS cfpk_lineitem_supplier_1#8364, cfpk_lineitem_partsupp#8320 AS cfpk_lineitem_partsupp_1#8365, cpfk_part_lineitem#8321 AS cpfk_part_lineitem_1#8366, cfpk_lineitem_part#8322 AS cfpk_lineitem_part_1#8367, cpfk_partsupp_lineitem#8323 AS cpfk_partsupp_lineitem_1#8368, cfpk_lineitem_orders#8324 AS cfpk_lineitem_orders_1#8369, cval_lineitem_l_quantity#8325 AS cval_lineitem_l_quantity_1#8370, cval_lineitem_l_extendedprice#8326 AS cval_lineitem_l_extendedprice_1#8371, cval_lineitem_l_discount#8327 AS cval_lineitem_l_discount_1#8372, cval_lineitem_l_tax#8328 AS cval_lineitem_l_tax_1#8373, cval_lineitem_l_returnflag#8329 AS cval_lineitem_l_returnflag_1#8374, cval_lineitem_l_linestatus#8330 AS cval_lineitem_l_linestatus_1#8375, cval_lineitem_l_commitdate#8331 AS cval_lineitem_l_commitdate_1#8376, cval_lineitem_l_receiptdate#8332 AS cval_lineitem_l_receiptdate_1#8377, cval_lineitem_l_shipinstruct#8333 AS cval_lineitem_l_shipinstruct_1#8378, cval_lineitem_l_shipmode#8334 AS cval_lineitem_l_shipmode_1#8379, cval_lineitem_l_comment#8335 AS cval_lineitem_l_comment_1#8380, cval_lineitem_l_shipdate#8336 AS cval_lineitem_l_shipdate_1#8381, cdepval_lineitem_l_quantity#8337 AS cdepval_lineitem_l_quantity_1#8382, cdepval_lineitem_l_extendedprice#8338 AS cdepval_lineitem_l_extendedprice_1#8383, cdepval_lineitem_l_discount#8339 AS cdepval_lineitem_l_discount_1#8384, ... 21 more fields]
            +- Relation[rid#8316,cpfk_orders_lineitem#8317,cpfk_supplier_lineitem#8318,cfpk_lineitem_supplier#8319,cfpk_lineitem_partsupp#8320,cpfk_part_lineitem#8321,cfpk_lineitem_part#8322,cpfk_partsupp_lineitem#8323,cfpk_lineitem_orders#8324,cval_lineitem_l_quantity#8325,cval_lineitem_l_extendedprice#8326,cval_lineitem_l_discount#8327,cval_lineitem_l_tax#8328,cval_lineitem_l_returnflag#8329,cval_lineitem_l_linestatus#8330,cval_lineitem_l_commitdate#8331,cval_lineitem_l_receiptdate#8332,cval_lineitem_l_shipinstruct#8333,cval_lineitem_l_shipmode#8334,cval_lineitem_l_comment#8335,cval_lineitem_l_shipdate#8336,cdepval_lineitem_l_quantity#8337,cdepval_lineitem_l_extendedprice#8338,cdepval_lineitem_l_discount#8339,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 549ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/26 22:15:50 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:15:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8628L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 22:15:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:15:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 22:15:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8628L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#8630 AS rid_0#8675, cpfk_orders_lineitem#8631 AS cpfk_orders_lineitem_0#8676, cpfk_supplier_lineitem#8632 AS cpfk_supplier_lineitem_0#8677, cfpk_lineitem_supplier#8633 AS cfpk_lineitem_supplier_0#8678, cfpk_lineitem_partsupp#8634 AS cfpk_lineitem_partsupp_0#8679, cpfk_part_lineitem#8635 AS cpfk_part_lineitem_0#8680, cfpk_lineitem_part#8636 AS cfpk_lineitem_part_0#8681, cpfk_partsupp_lineitem#8637 AS cpfk_partsupp_lineitem_0#8682, cfpk_lineitem_orders#8638 AS cfpk_lineitem_orders_0#8683, cval_lineitem_l_quantity#8639 AS cval_lineitem_l_quantity_0#8684, cval_lineitem_l_extendedprice#8640 AS cval_lineitem_l_extendedprice_0#8685, cval_lineitem_l_discount#8641 AS cval_lineitem_l_discount_0#8686, cval_lineitem_l_tax#8642 AS cval_lineitem_l_tax_0#8687, cval_lineitem_l_returnflag#8643 AS cval_lineitem_l_returnflag_0#8688, cval_lineitem_l_linestatus#8644 AS cval_lineitem_l_linestatus_0#8689, cval_lineitem_l_commitdate#8645 AS cval_lineitem_l_commitdate_0#8690, cval_lineitem_l_receiptdate#8646 AS cval_lineitem_l_receiptdate_0#8691, cval_lineitem_l_shipinstruct#8647 AS cval_lineitem_l_shipinstruct_0#8692, cval_lineitem_l_shipmode#8648 AS cval_lineitem_l_shipmode_0#8693, cval_lineitem_l_comment#8649 AS cval_lineitem_l_comment_0#8694, cval_lineitem_l_shipdate#8650 AS cval_lineitem_l_shipdate_0#8695, cdepval_lineitem_l_quantity#8651 AS cdepval_lineitem_l_quantity_0#8696, cdepval_lineitem_l_extendedprice#8652 AS cdepval_lineitem_l_extendedprice_0#8697, cdepval_lineitem_l_discount#8653 AS cdepval_lineitem_l_discount_0#8698, ... 21 more fields]
         :  :  :     +- Relation[rid#8630,cpfk_orders_lineitem#8631,cpfk_supplier_lineitem#8632,cfpk_lineitem_supplier#8633,cfpk_lineitem_partsupp#8634,cpfk_part_lineitem#8635,cfpk_lineitem_part#8636,cpfk_partsupp_lineitem#8637,cfpk_lineitem_orders#8638,cval_lineitem_l_quantity#8639,cval_lineitem_l_extendedprice#8640,cval_lineitem_l_discount#8641,cval_lineitem_l_tax#8642,cval_lineitem_l_returnflag#8643,cval_lineitem_l_linestatus#8644,cval_lineitem_l_commitdate#8645,cval_lineitem_l_receiptdate#8646,cval_lineitem_l_shipinstruct#8647,cval_lineitem_l_shipmode#8648,cval_lineitem_l_comment#8649,cval_lineitem_l_shipdate#8650,cdepval_lineitem_l_quantity#8651,cdepval_lineitem_l_extendedprice#8652,cdepval_lineitem_l_discount#8653,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#8810 AS rid_1#8834, cpfk_customer_orders#8811 AS cpfk_customer_orders_1#8835, cfpk_orders_customer#8812 AS cfpk_orders_customer_1#8836, cval_orders_o_orderstatus#8813 AS cval_orders_o_orderstatus_1#8837, cval_orders_o_totalprice#8814 AS cval_orders_o_totalprice_1#8838, cval_orders_o_orderpriority#8815 AS cval_orders_o_orderpriority_1#8839, cval_orders_o_clerk#8816 AS cval_orders_o_clerk_1#8840, cval_orders_o_shippriority#8817 AS cval_orders_o_shippriority_1#8841, cval_orders_o_comment#8818 AS cval_orders_o_comment_1#8842, cval_orders_o_orderdate#8819 AS cval_orders_o_orderdate_1#8843, cdepval_orders_o_orderstatus#8820 AS cdepval_orders_o_orderstatus_1#8844, cdepval_orders_o_totalprice#8821 AS cdepval_orders_o_totalprice_1#8845, cdepval_orders_o_orderpriority#8822 AS cdepval_orders_o_orderpriority_1#8846, cdepval_orders_o_clerk#8823 AS cdepval_orders_o_clerk_1#8847, cdepval_orders_o_shippriority#8824 AS cdepval_orders_o_shippriority_1#8848, cdepval_orders_o_comment#8825 AS cdepval_orders_o_comment_1#8849, cdepval_orders_o_orderdate#8826 AS cdepval_orders_o_orderdate_1#8850, co_orderstatus#8827 AS co_orderstatus_1#8851, co_totalprice#8828 AS co_totalprice_1#8852, co_orderpriority#8829 AS co_orderpriority_1#8853, co_clerk#8830 AS co_clerk_1#8854, co_shippriority#8831 AS co_shippriority_1#8855, co_comment#8832 AS co_comment_1#8856, co_orderdate#8833 AS co_orderdate_1#8857]
         :  :     +- Relation[rid#8810,cpfk_customer_orders#8811,cfpk_orders_customer#8812,cval_orders_o_orderstatus#8813,cval_orders_o_totalprice#8814,cval_orders_o_orderpriority#8815,cval_orders_o_clerk#8816,cval_orders_o_shippriority#8817,cval_orders_o_comment#8818,cval_orders_o_orderdate#8819,cdepval_orders_o_orderstatus#8820,cdepval_orders_o_totalprice#8821,cdepval_orders_o_orderpriority#8822,cdepval_orders_o_clerk#8823,cdepval_orders_o_shippriority#8824,cdepval_orders_o_comment#8825,cdepval_orders_o_orderdate#8826,co_orderstatus#8827,co_totalprice#8828,co_orderpriority#8829,co_clerk#8830,co_shippriority#8831,co_comment#8832,co_orderdate#8833] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#8858 AS rid_2#8879, cpfk_nation_customer#8859 AS cpfk_nation_customer_2#8880, cfpk_customer_nation#8860 AS cfpk_customer_nation_2#8881, cval_customer_c_name#8861 AS cval_customer_c_name_2#8882, cval_customer_c_address#8862 AS cval_customer_c_address_2#8883, cval_customer_c_phone#8863 AS cval_customer_c_phone_2#8884, cval_customer_c_acctbal#8864 AS cval_customer_c_acctbal_2#8885, cval_customer_c_comment#8865 AS cval_customer_c_comment_2#8886, cval_customer_c_mktsegment#8866 AS cval_customer_c_mktsegment_2#8887, cdepval_customer_c_name#8867 AS cdepval_customer_c_name_2#8888, cdepval_customer_c_address#8868 AS cdepval_customer_c_address_2#8889, cdepval_customer_c_phone#8869 AS cdepval_customer_c_phone_2#8890, cdepval_customer_c_acctbal#8870 AS cdepval_customer_c_acctbal_2#8891, cdepval_customer_c_comment#8871 AS cdepval_customer_c_comment_2#8892, cdepval_customer_c_mktsegment#8872 AS cdepval_customer_c_mktsegment_2#8893, cc_name#8873 AS cc_name_2#8894, cc_address#8874 AS cc_address_2#8895, cc_phone#8875 AS cc_phone_2#8896, cc_acctbal#8876 AS cc_acctbal_2#8897, cc_comment#8877 AS cc_comment_2#8898, cc_mktsegment#8878 AS cc_mktsegment_2#8899]
         :     +- Relation[rid#8858,cpfk_nation_customer#8859,cfpk_customer_nation#8860,cval_customer_c_name#8861,cval_customer_c_address#8862,cval_customer_c_phone#8863,cval_customer_c_acctbal#8864,cval_customer_c_comment#8865,cval_customer_c_mktsegment#8866,cdepval_customer_c_name#8867,cdepval_customer_c_address#8868,cdepval_customer_c_phone#8869,cdepval_customer_c_acctbal#8870,cdepval_customer_c_comment#8871,cdepval_customer_c_mktsegment#8872,cc_name#8873,cc_address#8874,cc_phone#8875,cc_acctbal#8876,cc_comment#8877,cc_mktsegment#8878] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#8900 AS rid_3#8909, cpfk_region_nation#8901 AS cpfk_region_nation_3#8910, cfpk_nation_region#8902 AS cfpk_nation_region_3#8911, cval_nation_n_name#8903 AS cval_nation_n_name_3#8912, cval_nation_n_comment#8904 AS cval_nation_n_comment_3#8913, cdepval_nation_n_name#8905 AS cdepval_nation_n_name_3#8914, cdepval_nation_n_comment#8906 AS cdepval_nation_n_comment_3#8915, cn_name#8907 AS cn_name_3#8916, cn_comment#8908 AS cn_comment_3#8917]
            +- Relation[rid#8900,cpfk_region_nation#8901,cfpk_nation_region#8902,cval_nation_n_name#8903,cval_nation_n_comment#8904,cdepval_nation_n_name#8905,cdepval_nation_n_comment#8906,cn_name#8907,cn_comment#8908] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 58007ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/26 22:16:48 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:16:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9021L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 22:16:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9021L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#9023 AS rid_0#9047, cpfk_customer_orders#9024 AS cpfk_customer_orders_0#9048, cfpk_orders_customer#9025 AS cfpk_orders_customer_0#9049, cval_orders_o_orderstatus#9026 AS cval_orders_o_orderstatus_0#9050, cval_orders_o_totalprice#9027 AS cval_orders_o_totalprice_0#9051, cval_orders_o_orderpriority#9028 AS cval_orders_o_orderpriority_0#9052, cval_orders_o_clerk#9029 AS cval_orders_o_clerk_0#9053, cval_orders_o_shippriority#9030 AS cval_orders_o_shippriority_0#9054, cval_orders_o_comment#9031 AS cval_orders_o_comment_0#9055, cval_orders_o_orderdate#9032 AS cval_orders_o_orderdate_0#9056, cdepval_orders_o_orderstatus#9033 AS cdepval_orders_o_orderstatus_0#9057, cdepval_orders_o_totalprice#9034 AS cdepval_orders_o_totalprice_0#9058, cdepval_orders_o_orderpriority#9035 AS cdepval_orders_o_orderpriority_0#9059, cdepval_orders_o_clerk#9036 AS cdepval_orders_o_clerk_0#9060, cdepval_orders_o_shippriority#9037 AS cdepval_orders_o_shippriority_0#9061, cdepval_orders_o_comment#9038 AS cdepval_orders_o_comment_0#9062, cdepval_orders_o_orderdate#9039 AS cdepval_orders_o_orderdate_0#9063, co_orderstatus#9040 AS co_orderstatus_0#9064, co_totalprice#9041 AS co_totalprice_0#9065, co_orderpriority#9042 AS co_orderpriority_0#9066, co_clerk#9043 AS co_clerk_0#9067, co_shippriority#9044 AS co_shippriority_0#9068, co_comment#9045 AS co_comment_0#9069, co_orderdate#9046 AS co_orderdate_0#9070]
         :  +- Relation[rid#9023,cpfk_customer_orders#9024,cfpk_orders_customer#9025,cval_orders_o_orderstatus#9026,cval_orders_o_totalprice#9027,cval_orders_o_orderpriority#9028,cval_orders_o_clerk#9029,cval_orders_o_shippriority#9030,cval_orders_o_comment#9031,cval_orders_o_orderdate#9032,cdepval_orders_o_orderstatus#9033,cdepval_orders_o_totalprice#9034,cdepval_orders_o_orderpriority#9035,cdepval_orders_o_clerk#9036,cdepval_orders_o_shippriority#9037,cdepval_orders_o_comment#9038,cdepval_orders_o_orderdate#9039,co_orderstatus#9040,co_totalprice#9041,co_orderpriority#9042,co_clerk#9043,co_shippriority#9044,co_comment#9045,co_orderdate#9046] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#9071 AS rid_1#9092, cpfk_nation_customer#9072 AS cpfk_nation_customer_1#9093, cfpk_customer_nation#9073 AS cfpk_customer_nation_1#9094, cval_customer_c_name#9074 AS cval_customer_c_name_1#9095, cval_customer_c_address#9075 AS cval_customer_c_address_1#9096, cval_customer_c_phone#9076 AS cval_customer_c_phone_1#9097, cval_customer_c_acctbal#9077 AS cval_customer_c_acctbal_1#9098, cval_customer_c_comment#9078 AS cval_customer_c_comment_1#9099, cval_customer_c_mktsegment#9079 AS cval_customer_c_mktsegment_1#9100, cdepval_customer_c_name#9080 AS cdepval_customer_c_name_1#9101, cdepval_customer_c_address#9081 AS cdepval_customer_c_address_1#9102, cdepval_customer_c_phone#9082 AS cdepval_customer_c_phone_1#9103, cdepval_customer_c_acctbal#9083 AS cdepval_customer_c_acctbal_1#9104, cdepval_customer_c_comment#9084 AS cdepval_customer_c_comment_1#9105, cdepval_customer_c_mktsegment#9085 AS cdepval_customer_c_mktsegment_1#9106, cc_name#9086 AS cc_name_1#9107, cc_address#9087 AS cc_address_1#9108, cc_phone#9088 AS cc_phone_1#9109, cc_acctbal#9089 AS cc_acctbal_1#9110, cc_comment#9090 AS cc_comment_1#9111, cc_mktsegment#9091 AS cc_mktsegment_1#9112]
            +- Relation[rid#9071,cpfk_nation_customer#9072,cfpk_customer_nation#9073,cval_customer_c_name#9074,cval_customer_c_address#9075,cval_customer_c_phone#9076,cval_customer_c_acctbal#9077,cval_customer_c_comment#9078,cval_customer_c_mktsegment#9079,cdepval_customer_c_name#9080,cdepval_customer_c_address#9081,cdepval_customer_c_phone#9082,cdepval_customer_c_acctbal#9083,cdepval_customer_c_comment#9084,cdepval_customer_c_mktsegment#9085,cc_name#9086,cc_address#9087,cc_phone#9088,cc_acctbal#9089,cc_comment#9090,cc_mktsegment#9091] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4545ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/26 22:16:53 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:16:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9166L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:16:53 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:16:53 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:16:53 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:16:53 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:16:53 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 22:16:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9166L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#9390 AS rid_2#9435, cpfk_orders_lineitem#9391 AS cpfk_orders_lineitem_2#9436, cpfk_supplier_lineitem#9392 AS cpfk_supplier_lineitem_2#9437, cfpk_lineitem_supplier#9393 AS cfpk_lineitem_supplier_2#9438, cfpk_lineitem_partsupp#9394 AS cfpk_lineitem_partsupp_2#9439, cpfk_part_lineitem#9395 AS cpfk_part_lineitem_2#9440, cfpk_lineitem_part#9396 AS cfpk_lineitem_part_2#9441, cpfk_partsupp_lineitem#9397 AS cpfk_partsupp_lineitem_2#9442, cfpk_lineitem_orders#9398 AS cfpk_lineitem_orders_2#9443, cval_lineitem_l_quantity#9399 AS cval_lineitem_l_quantity_2#9444, cval_lineitem_l_extendedprice#9400 AS cval_lineitem_l_extendedprice_2#9445, cval_lineitem_l_discount#9401 AS cval_lineitem_l_discount_2#9446, cval_lineitem_l_tax#9402 AS cval_lineitem_l_tax_2#9447, cval_lineitem_l_returnflag#9403 AS cval_lineitem_l_returnflag_2#9448, cval_lineitem_l_linestatus#9404 AS cval_lineitem_l_linestatus_2#9449, cval_lineitem_l_commitdate#9405 AS cval_lineitem_l_commitdate_2#9450, cval_lineitem_l_receiptdate#9406 AS cval_lineitem_l_receiptdate_2#9451, cval_lineitem_l_shipinstruct#9407 AS cval_lineitem_l_shipinstruct_2#9452, cval_lineitem_l_shipmode#9408 AS cval_lineitem_l_shipmode_2#9453, cval_lineitem_l_comment#9409 AS cval_lineitem_l_comment_2#9454, cval_lineitem_l_shipdate#9410 AS cval_lineitem_l_shipdate_2#9455, cdepval_lineitem_l_quantity#9411 AS cdepval_lineitem_l_quantity_2#9456, cdepval_lineitem_l_extendedprice#9412 AS cdepval_lineitem_l_extendedprice_2#9457, cdepval_lineitem_l_discount#9413 AS cdepval_lineitem_l_discount_2#9458, ... 21 more fields]
         :  +- Relation[rid#9390,cpfk_orders_lineitem#9391,cpfk_supplier_lineitem#9392,cfpk_lineitem_supplier#9393,cfpk_lineitem_partsupp#9394,cpfk_part_lineitem#9395,cfpk_lineitem_part#9396,cpfk_partsupp_lineitem#9397,cfpk_lineitem_orders#9398,cval_lineitem_l_quantity#9399,cval_lineitem_l_extendedprice#9400,cval_lineitem_l_discount#9401,cval_lineitem_l_tax#9402,cval_lineitem_l_returnflag#9403,cval_lineitem_l_linestatus#9404,cval_lineitem_l_commitdate#9405,cval_lineitem_l_receiptdate#9406,cval_lineitem_l_shipinstruct#9407,cval_lineitem_l_shipmode#9408,cval_lineitem_l_comment#9409,cval_lineitem_l_shipdate#9410,cdepval_lineitem_l_quantity#9411,cdepval_lineitem_l_extendedprice#9412,cdepval_lineitem_l_discount#9413,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin customer~orders, 'cpfk_customer_orders_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#9189, cpfk_nation_customer_0#9190, cfpk_customer_nation_0#9191, cval_customer_c_name_0#9192, cval_customer_c_address_0#9193, cval_customer_c_phone_0#9194, cval_customer_c_acctbal_0#9195, cval_customer_c_comment_0#9196, cval_customer_c_mktsegment_0#9197, cdepval_customer_c_name_0#9198, cdepval_customer_c_address_0#9199, cdepval_customer_c_phone_0#9200, cdepval_customer_c_acctbal_0#9201, cdepval_customer_c_comment_0#9202, cdepval_customer_c_mktsegment_0#9203, cc_name_0#9204, cc_address_0#9205, cc_phone_0#9206, cc_acctbal_0#9207, cc_comment_0#9208, cc_mktsegment_0#9209, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
            :  :  +- Project [rid#9168 AS rid_0#9189, cpfk_nation_customer#9169 AS cpfk_nation_customer_0#9190, cfpk_customer_nation#9170 AS cfpk_customer_nation_0#9191, cval_customer_c_name#9171 AS cval_customer_c_name_0#9192, cval_customer_c_address#9172 AS cval_customer_c_address_0#9193, cval_customer_c_phone#9173 AS cval_customer_c_phone_0#9194, cval_customer_c_acctbal#9174 AS cval_customer_c_acctbal_0#9195, cval_customer_c_comment#9175 AS cval_customer_c_comment_0#9196, cval_customer_c_mktsegment#9176 AS cval_customer_c_mktsegment_0#9197, cdepval_customer_c_name#9177 AS cdepval_customer_c_name_0#9198, cdepval_customer_c_address#9178 AS cdepval_customer_c_address_0#9199, cdepval_customer_c_phone#9179 AS cdepval_customer_c_phone_0#9200, cdepval_customer_c_acctbal#9180 AS cdepval_customer_c_acctbal_0#9201, cdepval_customer_c_comment#9181 AS cdepval_customer_c_comment_0#9202, cdepval_customer_c_mktsegment#9182 AS cdepval_customer_c_mktsegment_0#9203, cc_name#9183 AS cc_name_0#9204, cc_address#9184 AS cc_address_0#9205, cc_phone#9185 AS cc_phone_0#9206, cc_acctbal#9186 AS cc_acctbal_0#9207, cc_comment#9187 AS cc_comment_0#9208, cc_mktsegment#9188 AS cc_mktsegment_0#9209]
            :  :     +- Relation[rid#9168,cpfk_nation_customer#9169,cfpk_customer_nation#9170,cval_customer_c_name#9171,cval_customer_c_address#9172,cval_customer_c_phone#9173,cval_customer_c_acctbal#9174,cval_customer_c_comment#9175,cval_customer_c_mktsegment#9176,cdepval_customer_c_name#9177,cdepval_customer_c_address#9178,cdepval_customer_c_phone#9179,cdepval_customer_c_acctbal#9180,cdepval_customer_c_comment#9181,cdepval_customer_c_mktsegment#9182,cc_name#9183,cc_address#9184,cc_phone#9185,cc_acctbal#9186,cc_comment#9187,cc_mktsegment#9188] JDBCRelation(tcustomer) [numPartitions=1]
            :  +- 'Project ['cpfk_customer_orders_1, 'rid_1]
            :     +- Project [rid#9342 AS rid_1#9366, cpfk_customer_orders#9343 AS cpfk_customer_orders_1#9367, cfpk_orders_customer#9344 AS cfpk_orders_customer_1#9368, cval_orders_o_orderstatus#9345 AS cval_orders_o_orderstatus_1#9369, cval_orders_o_totalprice#9346 AS cval_orders_o_totalprice_1#9370, cval_orders_o_orderpriority#9347 AS cval_orders_o_orderpriority_1#9371, cval_orders_o_clerk#9348 AS cval_orders_o_clerk_1#9372, cval_orders_o_shippriority#9349 AS cval_orders_o_shippriority_1#9373, cval_orders_o_comment#9350 AS cval_orders_o_comment_1#9374, cval_orders_o_orderdate#9351 AS cval_orders_o_orderdate_1#9375, cdepval_orders_o_orderstatus#9352 AS cdepval_orders_o_orderstatus_1#9376, cdepval_orders_o_totalprice#9353 AS cdepval_orders_o_totalprice_1#9377, cdepval_orders_o_orderpriority#9354 AS cdepval_orders_o_orderpriority_1#9378, cdepval_orders_o_clerk#9355 AS cdepval_orders_o_clerk_1#9379, cdepval_orders_o_shippriority#9356 AS cdepval_orders_o_shippriority_1#9380, cdepval_orders_o_comment#9357 AS cdepval_orders_o_comment_1#9381, cdepval_orders_o_orderdate#9358 AS cdepval_orders_o_orderdate_1#9382, co_orderstatus#9359 AS co_orderstatus_1#9383, co_totalprice#9360 AS co_totalprice_1#9384, co_orderpriority#9361 AS co_orderpriority_1#9385, co_clerk#9362 AS co_clerk_1#9386, co_shippriority#9363 AS co_shippriority_1#9387, co_comment#9364 AS co_comment_1#9388, co_orderdate#9365 AS co_orderdate_1#9389]
            :        +- Relation[rid#9342,cpfk_customer_orders#9343,cfpk_orders_customer#9344,cval_orders_o_orderstatus#9345,cval_orders_o_totalprice#9346,cval_orders_o_orderpriority#9347,cval_orders_o_clerk#9348,cval_orders_o_shippriority#9349,cval_orders_o_comment#9350,cval_orders_o_orderdate#9351,cdepval_orders_o_orderstatus#9352,cdepval_orders_o_totalprice#9353,cdepval_orders_o_orderpriority#9354,cdepval_orders_o_clerk#9355,cdepval_orders_o_shippriority#9356,cdepval_orders_o_comment#9357,cdepval_orders_o_orderdate#9358,co_orderstatus#9359,co_totalprice#9360,co_orderpriority#9361,co_clerk#9362,co_shippriority#9363,co_comment#9364,co_orderdate#9365] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#9252 AS rid_1#9276, cpfk_customer_orders#9253 AS cpfk_customer_orders_1#9277, cfpk_orders_customer#9254 AS cfpk_orders_customer_1#9278, cval_orders_o_orderstatus#9255 AS cval_orders_o_orderstatus_1#9279, cval_orders_o_totalprice#9256 AS cval_orders_o_totalprice_1#9280, cval_orders_o_orderpriority#9257 AS cval_orders_o_orderpriority_1#9281, cval_orders_o_clerk#9258 AS cval_orders_o_clerk_1#9282, cval_orders_o_shippriority#9259 AS cval_orders_o_shippriority_1#9283, cval_orders_o_comment#9260 AS cval_orders_o_comment_1#9284, cval_orders_o_orderdate#9261 AS cval_orders_o_orderdate_1#9285, cdepval_orders_o_orderstatus#9262 AS cdepval_orders_o_orderstatus_1#9286, cdepval_orders_o_totalprice#9263 AS cdepval_orders_o_totalprice_1#9287, cdepval_orders_o_orderpriority#9264 AS cdepval_orders_o_orderpriority_1#9288, cdepval_orders_o_clerk#9265 AS cdepval_orders_o_clerk_1#9289, cdepval_orders_o_shippriority#9266 AS cdepval_orders_o_shippriority_1#9290, cdepval_orders_o_comment#9267 AS cdepval_orders_o_comment_1#9291, cdepval_orders_o_orderdate#9268 AS cdepval_orders_o_orderdate_1#9292, co_orderstatus#9269 AS co_orderstatus_1#9293, co_totalprice#9270 AS co_totalprice_1#9294, co_orderpriority#9271 AS co_orderpriority_1#9295, co_clerk#9272 AS co_clerk_1#9296, co_shippriority#9273 AS co_shippriority_1#9297, co_comment#9274 AS co_comment_1#9298, co_orderdate#9275 AS co_orderdate_1#9299]
               +- Relation[rid#9252,cpfk_customer_orders#9253,cfpk_orders_customer#9254,cval_orders_o_orderstatus#9255,cval_orders_o_totalprice#9256,cval_orders_o_orderpriority#9257,cval_orders_o_clerk#9258,cval_orders_o_shippriority#9259,cval_orders_o_comment#9260,cval_orders_o_orderdate#9261,cdepval_orders_o_orderstatus#9262,cdepval_orders_o_totalprice#9263,cdepval_orders_o_orderpriority#9264,cdepval_orders_o_clerk#9265,cdepval_orders_o_shippriority#9266,cdepval_orders_o_comment#9267,cdepval_orders_o_orderdate#9268,co_orderstatus#9269,co_totalprice#9270,co_orderpriority#9271,co_clerk#9272,co_shippriority#9273,co_comment#9274,co_orderdate#9275] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 23997ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/26 22:17:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:17:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9577L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 22:17:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:17:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:17:17 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 22:17:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9577L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#9604, cval_part_p_name_0#9605, cval_part_p_mfgr_0#9606, cval_part_p_type_0#9607, cval_part_p_size_0#9608, cval_part_p_container_0#9609, cval_part_p_retailprice_0#9610, cval_part_p_comment_0#9611, cval_part_p_brand_0#9612, cdepval_part_p_name_0#9613, cdepval_part_p_mfgr_0#9614, cdepval_part_p_type_0#9615, cdepval_part_p_size_0#9616, cdepval_part_p_container_0#9617, cdepval_part_p_retailprice_0#9618, cdepval_part_p_comment_0#9619, cdepval_part_p_brand_0#9620, cp_name_0#9621, cp_mfgr_0#9622, cp_type_0#9623, cp_size_0#9624, cp_container_0#9625, cp_retailprice_0#9626, cp_comment_0#9627, ... 2 more fields]
         :  :- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  +- Project [rid#9579 AS rid_0#9604, cval_part_p_name#9580 AS cval_part_p_name_0#9605, cval_part_p_mfgr#9581 AS cval_part_p_mfgr_0#9606, cval_part_p_type#9582 AS cval_part_p_type_0#9607, cval_part_p_size#9583 AS cval_part_p_size_0#9608, cval_part_p_container#9584 AS cval_part_p_container_0#9609, cval_part_p_retailprice#9585 AS cval_part_p_retailprice_0#9610, cval_part_p_comment#9586 AS cval_part_p_comment_0#9611, cval_part_p_brand#9587 AS cval_part_p_brand_0#9612, cdepval_part_p_name#9588 AS cdepval_part_p_name_0#9613, cdepval_part_p_mfgr#9589 AS cdepval_part_p_mfgr_0#9614, cdepval_part_p_type#9590 AS cdepval_part_p_type_0#9615, cdepval_part_p_size#9591 AS cdepval_part_p_size_0#9616, cdepval_part_p_container#9592 AS cdepval_part_p_container_0#9617, cdepval_part_p_retailprice#9593 AS cdepval_part_p_retailprice_0#9618, cdepval_part_p_comment#9594 AS cdepval_part_p_comment_0#9619, cdepval_part_p_brand#9595 AS cdepval_part_p_brand_0#9620, cp_name#9596 AS cp_name_0#9621, cp_mfgr#9597 AS cp_mfgr_0#9622, cp_type#9598 AS cp_type_0#9623, cp_size#9599 AS cp_size_0#9624, cp_container#9600 AS cp_container_0#9625, cp_retailprice#9601 AS cp_retailprice_0#9626, cp_comment#9602 AS cp_comment_0#9627, cp_brand#9603 AS cp_brand_0#9628]
         :  :     +- Relation[rid#9579,cval_part_p_name#9580,cval_part_p_mfgr#9581,cval_part_p_type#9582,cval_part_p_size#9583,cval_part_p_container#9584,cval_part_p_retailprice#9585,cval_part_p_comment#9586,cval_part_p_brand#9587,cdepval_part_p_name#9588,cdepval_part_p_mfgr#9589,cdepval_part_p_type#9590,cdepval_part_p_size#9591,cdepval_part_p_container#9592,cdepval_part_p_retailprice#9593,cdepval_part_p_comment#9594,cdepval_part_p_brand#9595,cp_name#9596,cp_mfgr#9597,cp_type#9598,cp_size#9599,cp_container#9600,cp_retailprice#9601,cp_comment#9602,cp_brand#9603] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :     +- Project [rid#9757 AS rid_1#9771, cpfk_part_partsupp#9758 AS cpfk_part_partsupp_1#9772, cfpk_partsupp_part#9759 AS cfpk_partsupp_part_1#9773, cpfk_supplier_partsupp#9760 AS cpfk_supplier_partsupp_1#9774, cfpk_partsupp_supplier#9761 AS cfpk_partsupp_supplier_1#9775, cval_partsupp_ps_availqty#9762 AS cval_partsupp_ps_availqty_1#9776, cval_partsupp_ps_supplycost#9763 AS cval_partsupp_ps_supplycost_1#9777, cval_partsupp_ps_comment#9764 AS cval_partsupp_ps_comment_1#9778, cdepval_partsupp_ps_availqty#9765 AS cdepval_partsupp_ps_availqty_1#9779, cdepval_partsupp_ps_supplycost#9766 AS cdepval_partsupp_ps_supplycost_1#9780, cdepval_partsupp_ps_comment#9767 AS cdepval_partsupp_ps_comment_1#9781, cps_availqty#9768 AS cps_availqty_1#9782, cps_supplycost#9769 AS cps_supplycost_1#9783, cps_comment#9770 AS cps_comment_1#9784]
         :        +- Relation[rid#9757,cpfk_part_partsupp#9758,cfpk_partsupp_part#9759,cpfk_supplier_partsupp#9760,cfpk_partsupp_supplier#9761,cval_partsupp_ps_availqty#9762,cval_partsupp_ps_supplycost#9763,cval_partsupp_ps_comment#9764,cdepval_partsupp_ps_availqty#9765,cdepval_partsupp_ps_supplycost#9766,cdepval_partsupp_ps_comment#9767,cps_availqty#9768,cps_supplycost#9769,cps_comment#9770] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#9679 AS rid_1#9693, cpfk_part_partsupp#9680 AS cpfk_part_partsupp_1#9694, cfpk_partsupp_part#9681 AS cfpk_partsupp_part_1#9695, cpfk_supplier_partsupp#9682 AS cpfk_supplier_partsupp_1#9696, cfpk_partsupp_supplier#9683 AS cfpk_partsupp_supplier_1#9697, cval_partsupp_ps_availqty#9684 AS cval_partsupp_ps_availqty_1#9698, cval_partsupp_ps_supplycost#9685 AS cval_partsupp_ps_supplycost_1#9699, cval_partsupp_ps_comment#9686 AS cval_partsupp_ps_comment_1#9700, cdepval_partsupp_ps_availqty#9687 AS cdepval_partsupp_ps_availqty_1#9701, cdepval_partsupp_ps_supplycost#9688 AS cdepval_partsupp_ps_supplycost_1#9702, cdepval_partsupp_ps_comment#9689 AS cdepval_partsupp_ps_comment_1#9703, cps_availqty#9690 AS cps_availqty_1#9704, cps_supplycost#9691 AS cps_supplycost_1#9705, cps_comment#9692 AS cps_comment_1#9706]
            +- Relation[rid#9679,cpfk_part_partsupp#9680,cfpk_partsupp_part#9681,cpfk_supplier_partsupp#9682,cfpk_partsupp_supplier#9683,cval_partsupp_ps_availqty#9684,cval_partsupp_ps_supplycost#9685,cval_partsupp_ps_comment#9686,cdepval_partsupp_ps_availqty#9687,cdepval_partsupp_ps_supplycost#9688,cdepval_partsupp_ps_comment#9689,cps_availqty#9690,cps_supplycost#9691,cps_comment#9692] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 660ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/26 22:17:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:17:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9829L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 22:17:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9829L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#9831 AS rid_0#9855, cpfk_customer_orders#9832 AS cpfk_customer_orders_0#9856, cfpk_orders_customer#9833 AS cfpk_orders_customer_0#9857, cval_orders_o_orderstatus#9834 AS cval_orders_o_orderstatus_0#9858, cval_orders_o_totalprice#9835 AS cval_orders_o_totalprice_0#9859, cval_orders_o_orderpriority#9836 AS cval_orders_o_orderpriority_0#9860, cval_orders_o_clerk#9837 AS cval_orders_o_clerk_0#9861, cval_orders_o_shippriority#9838 AS cval_orders_o_shippriority_0#9862, cval_orders_o_comment#9839 AS cval_orders_o_comment_0#9863, cval_orders_o_orderdate#9840 AS cval_orders_o_orderdate_0#9864, cdepval_orders_o_orderstatus#9841 AS cdepval_orders_o_orderstatus_0#9865, cdepval_orders_o_totalprice#9842 AS cdepval_orders_o_totalprice_0#9866, cdepval_orders_o_orderpriority#9843 AS cdepval_orders_o_orderpriority_0#9867, cdepval_orders_o_clerk#9844 AS cdepval_orders_o_clerk_0#9868, cdepval_orders_o_shippriority#9845 AS cdepval_orders_o_shippriority_0#9869, cdepval_orders_o_comment#9846 AS cdepval_orders_o_comment_0#9870, cdepval_orders_o_orderdate#9847 AS cdepval_orders_o_orderdate_0#9871, co_orderstatus#9848 AS co_orderstatus_0#9872, co_totalprice#9849 AS co_totalprice_0#9873, co_orderpriority#9850 AS co_orderpriority_0#9874, co_clerk#9851 AS co_clerk_0#9875, co_shippriority#9852 AS co_shippriority_0#9876, co_comment#9853 AS co_comment_0#9877, co_orderdate#9854 AS co_orderdate_0#9878]
         :  +- Relation[rid#9831,cpfk_customer_orders#9832,cfpk_orders_customer#9833,cval_orders_o_orderstatus#9834,cval_orders_o_totalprice#9835,cval_orders_o_orderpriority#9836,cval_orders_o_clerk#9837,cval_orders_o_shippriority#9838,cval_orders_o_comment#9839,cval_orders_o_orderdate#9840,cdepval_orders_o_orderstatus#9841,cdepval_orders_o_totalprice#9842,cdepval_orders_o_orderpriority#9843,cdepval_orders_o_clerk#9844,cdepval_orders_o_shippriority#9845,cdepval_orders_o_comment#9846,cdepval_orders_o_orderdate#9847,co_orderstatus#9848,co_totalprice#9849,co_orderpriority#9850,co_clerk#9851,co_shippriority#9852,co_comment#9853,co_orderdate#9854] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#9879 AS rid_1#9900, cpfk_nation_customer#9880 AS cpfk_nation_customer_1#9901, cfpk_customer_nation#9881 AS cfpk_customer_nation_1#9902, cval_customer_c_name#9882 AS cval_customer_c_name_1#9903, cval_customer_c_address#9883 AS cval_customer_c_address_1#9904, cval_customer_c_phone#9884 AS cval_customer_c_phone_1#9905, cval_customer_c_acctbal#9885 AS cval_customer_c_acctbal_1#9906, cval_customer_c_comment#9886 AS cval_customer_c_comment_1#9907, cval_customer_c_mktsegment#9887 AS cval_customer_c_mktsegment_1#9908, cdepval_customer_c_name#9888 AS cdepval_customer_c_name_1#9909, cdepval_customer_c_address#9889 AS cdepval_customer_c_address_1#9910, cdepval_customer_c_phone#9890 AS cdepval_customer_c_phone_1#9911, cdepval_customer_c_acctbal#9891 AS cdepval_customer_c_acctbal_1#9912, cdepval_customer_c_comment#9892 AS cdepval_customer_c_comment_1#9913, cdepval_customer_c_mktsegment#9893 AS cdepval_customer_c_mktsegment_1#9914, cc_name#9894 AS cc_name_1#9915, cc_address#9895 AS cc_address_1#9916, cc_phone#9896 AS cc_phone_1#9917, cc_acctbal#9897 AS cc_acctbal_1#9918, cc_comment#9898 AS cc_comment_1#9919, cc_mktsegment#9899 AS cc_mktsegment_1#9920]
            +- Relation[rid#9879,cpfk_nation_customer#9880,cfpk_customer_nation#9881,cval_customer_c_name#9882,cval_customer_c_address#9883,cval_customer_c_phone#9884,cval_customer_c_acctbal#9885,cval_customer_c_comment#9886,cval_customer_c_mktsegment#9887,cdepval_customer_c_name#9888,cdepval_customer_c_address#9889,cdepval_customer_c_phone#9890,cdepval_customer_c_acctbal#9891,cdepval_customer_c_comment#9892,cdepval_customer_c_mktsegment#9893,cc_name#9894,cc_address#9895,cc_phone#9896,cc_acctbal#9897,cc_comment#9898,cc_mktsegment#9899] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4400ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/26 22:17:22 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 22:17:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9975L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 22:17:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9975L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#10067 AS rid_2#10112, cpfk_orders_lineitem#10068 AS cpfk_orders_lineitem_2#10113, cpfk_supplier_lineitem#10069 AS cpfk_supplier_lineitem_2#10114, cfpk_lineitem_supplier#10070 AS cfpk_lineitem_supplier_2#10115, cfpk_lineitem_partsupp#10071 AS cfpk_lineitem_partsupp_2#10116, cpfk_part_lineitem#10072 AS cpfk_part_lineitem_2#10117, cfpk_lineitem_part#10073 AS cfpk_lineitem_part_2#10118, cpfk_partsupp_lineitem#10074 AS cpfk_partsupp_lineitem_2#10119, cfpk_lineitem_orders#10075 AS cfpk_lineitem_orders_2#10120, cval_lineitem_l_quantity#10076 AS cval_lineitem_l_quantity_2#10121, cval_lineitem_l_extendedprice#10077 AS cval_lineitem_l_extendedprice_2#10122, cval_lineitem_l_discount#10078 AS cval_lineitem_l_discount_2#10123, cval_lineitem_l_tax#10079 AS cval_lineitem_l_tax_2#10124, cval_lineitem_l_returnflag#10080 AS cval_lineitem_l_returnflag_2#10125, cval_lineitem_l_linestatus#10081 AS cval_lineitem_l_linestatus_2#10126, cval_lineitem_l_commitdate#10082 AS cval_lineitem_l_commitdate_2#10127, cval_lineitem_l_receiptdate#10083 AS cval_lineitem_l_receiptdate_2#10128, cval_lineitem_l_shipinstruct#10084 AS cval_lineitem_l_shipinstruct_2#10129, cval_lineitem_l_shipmode#10085 AS cval_lineitem_l_shipmode_2#10130, cval_lineitem_l_comment#10086 AS cval_lineitem_l_comment_2#10131, cval_lineitem_l_shipdate#10087 AS cval_lineitem_l_shipdate_2#10132, cdepval_lineitem_l_quantity#10088 AS cdepval_lineitem_l_quantity_2#10133, cdepval_lineitem_l_extendedprice#10089 AS cdepval_lineitem_l_extendedprice_2#10134, cdepval_lineitem_l_discount#10090 AS cdepval_lineitem_l_discount_2#10135, ... 21 more fields]
         :  +- Relation[rid#10067,cpfk_orders_lineitem#10068,cpfk_supplier_lineitem#10069,cfpk_lineitem_supplier#10070,cfpk_lineitem_partsupp#10071,cpfk_part_lineitem#10072,cfpk_lineitem_part#10073,cpfk_partsupp_lineitem#10074,cfpk_lineitem_orders#10075,cval_lineitem_l_quantity#10076,cval_lineitem_l_extendedprice#10077,cval_lineitem_l_discount#10078,cval_lineitem_l_tax#10079,cval_lineitem_l_returnflag#10080,cval_lineitem_l_linestatus#10081,cval_lineitem_l_commitdate#10082,cval_lineitem_l_receiptdate#10083,cval_lineitem_l_shipinstruct#10084,cval_lineitem_l_shipmode#10085,cval_lineitem_l_comment#10086,cval_lineitem_l_shipdate#10087,cdepval_lineitem_l_quantity#10088,cdepval_lineitem_l_extendedprice#10089,cdepval_lineitem_l_discount#10090,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#10019 AS rid_1#10043, cpfk_customer_orders#10020 AS cpfk_customer_orders_1#10044, cfpk_orders_customer#10021 AS cfpk_orders_customer_1#10045, cval_orders_o_orderstatus#10022 AS cval_orders_o_orderstatus_1#10046, cval_orders_o_totalprice#10023 AS cval_orders_o_totalprice_1#10047, cval_orders_o_orderpriority#10024 AS cval_orders_o_orderpriority_1#10048, cval_orders_o_clerk#10025 AS cval_orders_o_clerk_1#10049, cval_orders_o_shippriority#10026 AS cval_orders_o_shippriority_1#10050, cval_orders_o_comment#10027 AS cval_orders_o_comment_1#10051, cval_orders_o_orderdate#10028 AS cval_orders_o_orderdate_1#10052, cdepval_orders_o_orderstatus#10029 AS cdepval_orders_o_orderstatus_1#10053, cdepval_orders_o_totalprice#10030 AS cdepval_orders_o_totalprice_1#10054, cdepval_orders_o_orderpriority#10031 AS cdepval_orders_o_orderpriority_1#10055, cdepval_orders_o_clerk#10032 AS cdepval_orders_o_clerk_1#10056, cdepval_orders_o_shippriority#10033 AS cdepval_orders_o_shippriority_1#10057, cdepval_orders_o_comment#10034 AS cdepval_orders_o_comment_1#10058, cdepval_orders_o_orderdate#10035 AS cdepval_orders_o_orderdate_1#10059, co_orderstatus#10036 AS co_orderstatus_1#10060, co_totalprice#10037 AS co_totalprice_1#10061, co_orderpriority#10038 AS co_orderpriority_1#10062, co_clerk#10039 AS co_clerk_1#10063, co_shippriority#10040 AS co_shippriority_1#10064, co_comment#10041 AS co_comment_1#10065, co_orderdate#10042 AS co_orderdate_1#10066]
            :  +- Relation[rid#10019,cpfk_customer_orders#10020,cfpk_orders_customer#10021,cval_orders_o_orderstatus#10022,cval_orders_o_totalprice#10023,cval_orders_o_orderpriority#10024,cval_orders_o_clerk#10025,cval_orders_o_shippriority#10026,cval_orders_o_comment#10027,cval_orders_o_orderdate#10028,cdepval_orders_o_orderstatus#10029,cdepval_orders_o_totalprice#10030,cdepval_orders_o_orderpriority#10031,cdepval_orders_o_clerk#10032,cdepval_orders_o_shippriority#10033,cdepval_orders_o_comment#10034,cdepval_orders_o_orderdate#10035,co_orderstatus#10036,co_totalprice#10037,co_orderpriority#10038,co_clerk#10039,co_shippriority#10040,co_comment#10041,co_orderdate#10042] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#9977 AS rid_0#9998, cpfk_nation_customer#9978 AS cpfk_nation_customer_0#9999, cfpk_customer_nation#9979 AS cfpk_customer_nation_0#10000, cval_customer_c_name#9980 AS cval_customer_c_name_0#10001, cval_customer_c_address#9981 AS cval_customer_c_address_0#10002, cval_customer_c_phone#9982 AS cval_customer_c_phone_0#10003, cval_customer_c_acctbal#9983 AS cval_customer_c_acctbal_0#10004, cval_customer_c_comment#9984 AS cval_customer_c_comment_0#10005, cval_customer_c_mktsegment#9985 AS cval_customer_c_mktsegment_0#10006, cdepval_customer_c_name#9986 AS cdepval_customer_c_name_0#10007, cdepval_customer_c_address#9987 AS cdepval_customer_c_address_0#10008, cdepval_customer_c_phone#9988 AS cdepval_customer_c_phone_0#10009, cdepval_customer_c_acctbal#9989 AS cdepval_customer_c_acctbal_0#10010, cdepval_customer_c_comment#9990 AS cdepval_customer_c_comment_0#10011, cdepval_customer_c_mktsegment#9991 AS cdepval_customer_c_mktsegment_0#10012, cc_name#9992 AS cc_name_0#10013, cc_address#9993 AS cc_address_0#10014, cc_phone#9994 AS cc_phone_0#10015, cc_acctbal#9995 AS cc_acctbal_0#10016, cc_comment#9996 AS cc_comment_0#10017, cc_mktsegment#9997 AS cc_mktsegment_0#10018]
               +- Relation[rid#9977,cpfk_nation_customer#9978,cfpk_customer_nation#9979,cval_customer_c_name#9980,cval_customer_c_address#9981,cval_customer_c_phone#9982,cval_customer_c_acctbal#9983,cval_customer_c_comment#9984,cval_customer_c_mktsegment#9985,cdepval_customer_c_name#9986,cdepval_customer_c_address#9987,cdepval_customer_c_phone#9988,cdepval_customer_c_acctbal#9989,cdepval_customer_c_comment#9990,cdepval_customer_c_mktsegment#9991,cc_name#9992,cc_address#9993,cc_phone#9994,cc_acctbal#9995,cc_comment#9996,cc_mktsegment#9997] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 22280ms
query=q1, count=6001215, duration=2398
query=q10, count=1478870, duration=58007
query=q11, count=31680, duration=2529
query=q12, count=857401, duration=22337
query=q13, count=1500000, duration=4545
query=q14, count=6001215, duration=17728
query=q15, count=6001215, duration=17180
query=q16, count=15780, duration=660
query=q17, count=6088, duration=549
query=q18, count=6001215, duration=22280
query=q19, count=205, duration=17234
query=q2, count=3162, duration=904
query=q20, count=632, duration=891
query=q21a, count=597422, duration=160248
query=q22, count=1500000, duration=4400
query=q3, count=1214743, duration=23997
query=q4, count=6001215, duration=18274
query=q5, count=48089, duration=29636
query=q6, count=6001215, duration=4350
query=q7, count=9735, duration=39944
query=q8, count=8716, duration=3262
query=q9a, count=6001215, duration=62665
query=q9b, count=6001215, duration=37866
